<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>MapIcgc</title>
    <script src="../dist/mapicgc-gl.js"></script>
    <script src="https://unpkg.com/maplibre-gl@1.15.2/dist/maplibre-gl.js"></script>
    <link rel="stylesheet" href=" https://tilemaps.icgc.cat/cdn/mapicgc-gl-js/mapicgc-gl.css" />
    <script src="https://unpkg.com/flatgeobuf@3.26.2/dist/flatgeobuf-geojson.min.js"></script>
    <script src="https://unpkg.com/@turf/turf"></script>



    <style>
    
      
      body {
        margin: 0;
  padding: 0;
      }
   
      #map {
        position: absolute;
  top: 0;
  bottom: 0;
  width: 100%;
  height: 100%;
      }
      #geocoder-container {
      margin: 20px;
      position: absolute;
      top: 50px;
      right: 20px;
    }

    #results {
      margin-top: 10px;
    }
    </style>
  </head>
  <body>
   
    <div id="map"></div>
    <nav id="menu-group" class="filter-group"></nav>
    <!-- <nav id="filter-group" class="filter-group"></nav> -->
    <div id="basemap-group" class="basemap-group"></div>
    <div id="logos"></div>
    <div id="basemapDiv"></div>
    <div id="divInfo"></div>
    <div id="distance" class="distance-containerDiv">
      <div id="distanceTotal" class="distance-container">
       
      </div>
         
    </div>
 
<!-- <div id="geocoder-container">
  <label for="addressInput">Direcció:</label>
  <input type="text" id="addressInput" placeholder="Afegeix una direcció">
  <button onclick="map.geocodeAddress()">Buscar</button>

  <div id="results"></div>
</div> -->

 <!-- <div id="mapCompare" class="map">
  <div id="comparison-container">
    <div id="before" class="map"></div>
    <div id="after" class="map"></div>
  </div> -->
   <script>
    
      // console.info(window);
      //topografic, ortofoto, limits,fosc,ombra,, hipsometria, geologia, protegits
      const map = (window.map = new mapicgcgl.Map({
        container: "map",
              style: mapicgcgl.Styles.ORTO,
              // style: 'http://imtilemapsdev.icgc.local/terrenys/Ciutats/tilesetV1.0.json',
              zoom: 8.4,
      
      }));

      map.on("load", async () => {

        let paintOptions = {
          'line-color': 'red',
          'line-width': 2
        }
        map.addVectorLayerICGC(mapicgcgl.Layers.VectorAdmin.agrupacionsCensals2015, paintOptions)
        // map.addFGBLayerICGC(mapicgcgl.Layers.FGBAdmin.agrupacionsCensalsVigent, "visible")
        // let image = await map.loadImage('https://tilemaps.icgc.cat/cdn/images/tower.png');
        // map.addImage('tower', image.data, { sdf: true });

      // let pointOptions={
      //       "circle-color": "black",
      //       "circle-opacity": 0.8,
      // }
      // let iconColorq=["tower",[ "match",
      //         ["get", "comarca"],
      //         "Garraf", "#eb4034",
      //         "Barcelonès", "#782276",
      //         "Vallès Occidental", "#eeff00",
      //         "Baix Empordà", "#000000",
      //         "rgba(150,50,200,0.8)",]
             
      //       ];      
      //       let iconColor=["tower", "#782276" 
             
      //       ];   
      //       map.fetchDataAndMenu(
      //   'Proposa_DAC_min.geojson',
      //   'Proposa_DAC_min', 
      //   'comarca', pointOptions ) 
setTimeout(() => {
  
         //   // 'all',pointOptions)
      // // map.addFeatureQuery('Proposa_DAC_min')



      console.log(map.getStyle())
}, 3500);
      // console.log(iconColor)




      // map.addTerrainICGC(mapicgcgl.Terrains.ICGC5M, 'bottom-right');


      // let optionsText=['DOMEmarker', 'id', 'Xarxa']
      


      
      // const compareMap = new mapicgcgl.Map({
      //   style: "fosc",
      // });

      // let compar = new mapicgcgl.CompareMaps(map, compareMap, "#comparison-container");
// const comp = new mapicgcgl.Compare()
      //indicate resolution (2 or 5m)
      // map.addTerrainICGC(mapicgcgl.Terrains.WORLD3M, 'bottom-right');
      // console.log(mapicgcgl.Layers)
      // map.addImageLayerICGC(mapicgcgl.Layers.WMS.geologia);   

      // map.addExportControl()

      // map.addImageLayerICGC('geologia');

//       //censals, salut, provincies, aquifers...
// map.addVectorLayerICGC(mapicgcgl.Layers.VectorAdmin.agrupacionsCensalsVigent, "none")

// map.addVectorLayerICGC(mapicgcgl.Layers.VectorAdmin.agrupacionsCensalsVigentText, "visible")
      // map.getConfigImageLayers()
   
//       // map.addFullScreen('bottom-right');

// map.addGeocoderICGC()
// setTimeout(() => {
// let labelIDLayer = "agrupacionsCensalsVigent"+"Text"
// map.setLayoutProperty(labelIDLayer, "visibility", "visible" )
// map.setPaintProperty(labelIDLayer, "text-color", "red")
// }, 2000);


//       map.addExportControl('bottom-right');

//       let optionsAtt = {
//         options: { compact: true },
//         position: "bottom-right",
//       };
//       // map.addAttributionControl(optionsAtt);
// // map.addLimitLayerICGC('censals', '2019')
// 
//       let  coord: [2.0119, 41.489],
//        let text: "<h4>Hello World!</h4>",
//  
//       // map.addPopup(coord, text);

//       let optionsMarker = {
//         coord: [2.119, 41.87],
//         text: "Hola Test",
//         textOffset: 25,
//         options: {},
//       };
//       // map.addMarker(optionsMarker);
//    let optionsScale = {
//       maxWidth: 100,
//       unit: "metric",
//     }
// // map.addScaleControl(optionsScale,"bottom-right")
//       // map.jumpTo(
//       //   { center: [1.3119, 41.489], zoom: 16, essential: true }
//       // )
//       // map.addControl(new maplibregl.GeolocateControl({
//       //     positionOptions: {
//       //         enableHighAccuracy: true
//       //     },
//       //     trackUserLocation: true
//       // }), "bottom-right")
//       map.on("load", function (){
//               map.addMouseCoordControl()
//       })

//       map.getZoom()

//       // map.addGeolocateControl({
//       //     positionOptions: {
//       //         enableHighAccuracy: true
//       //     },
//       //     trackUserLocation: true
//       // },"bottom-right")
//       // map.addNavigationControl({
//       //   visualizePitch: true,
//       //   showZoom: true,
//       //   showCompass: true,
//       // }, "bottom-right");

//       let geojsonLayer = {
//         id: "geojsonTest",
//         data: {
//           type: "Feature",
//           geometry: {
//             type: "Polygon",
//             coordinates: [
//               [
//                 [1.3119, 41.489],
//                 [1.0119, 41.489],
//                 [1.0119, 42.0489],
//                 [1.3119, 42.0489],
//               ],
//             ],
//           },
//         },
//         layerType: "fill",
//         layout: {},
//         paint: {
//           "fill-color": "#088",
//           "fill-opacity": 0.8,
//         },
//       };
//       // map.addLayerGeoJSON(geojsonLayer);
//      console.log('vL',map.getConfigVectorLayers())
     let poointOptions={
            "circle-color": "black",
            "circle-opacity": 0.8,
      }
      // map.fetchDataAndMenu(
      //   'Proposa_DAC_min.geojson',
      //   'Proposa_DAC_min', pointOptions)

    //   let optionsText=['DOMEmarker', 'id', 'Xarxa']
    //   map.addFeatureQuery('Proposa_DAC_min')
   
        // let paintOptions = {
        //   'line-color': 'red',
        //   'line-width': 2,
        //   'line-opacity': 0.5
        // }
        // map.fetchDataAndMenu(
        //   'Proposa_DAC_min.geojson',
        // 'Proposa_DAC_min', "comarca", poointOptions)

      //   let optionsText=['alies', 'comarca']
      //   map.addFeatureQuery('centres', optionsText)
       
      
      //   map.addGeocoderICGC()

        // let optionsGeo= {
      //     // required
      //       forwardGeocode: async (config) => { /* definition here */ },
            
      //       // optional
      //       reverseGeocode: async (config) => { /* definition here */ }, // reverse geocoding API
      //       getSuggestions: async (config) => { /* definition here */ }, // suggestion API
      //       searchByPlaceId: async (config) => { /* definition here */ } // search by Place ID API
      // }
      //   map.fetchDataWithSearchbox(
      //   'https://analisi.transparenciacatalunya.cat/resource/8gmd-gz7i.geojson', 
      //   'point', 
      //   'centres',
      //   optionsGeo)
      


      // let wmsLayer = {
      //   id: "wms-test",
      //   tiles:
      //   "https://geoserveis.icgc.cat/servei/catalunya/espais-interes-geologic/wms/service?&service=WMS&request=GetMap&layers=espais-interes-geologic&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"  
      //   // "https://betaserver.icgc.cat/geoservice/194939610536528507705272100186218457502?service=WMS&request=GetMap&layers=swllH1905&styles=&format=image%2Fpng&transparent=true&version=1.1.1&nom=swellHeight_20210903&tipus=wms&businessId=-1&width=256&height=256&srs=EPSG%3A3857&bbox={bbox-epsg-3857}",
      // };
      // map.addLayerWMS(wmsLayer);

     
//     //  map.add3DBuildingsICGC()


//       let logoOptions = {
//         id: "icgcColorLogo",
//         url: "https://betaserver.icgc.cat/logos/ICGC_color_norma.svg",
//         href: "https://www.icgc.cat",
//       };
//       map.addLogo(logoOptions);
      const urlImages = "https://visors.icgc.cat/contextmaps/imatges_estil/";
    const urlStyles = "https://geoserveis.icgc.cat/contextmaps/";
      let baseLayers = [
        {
          id: 0,
          value: "Mapa estàndard",
          label: "fonscarto_mapa_estandard",
          image: `${urlImages}icgc_mapa_estandard.png`,
          url: `${urlStyles}icgc_mapa_estandard.json`,
        },
        {
          id: 1,
          value: "Ortofotomapa híbrid",
          label: "fonscarto_orto_hibrida",
          image: `${urlImages}icgc_orto_hibrida.png`,
          url: `${urlStyles}icgc_orto_hibrida.json`,
        },
    
      ];
      // map.addBasemaps(baseLayers);
let basemapsicgc = [mapicgcgl.Styles.ORTO, mapicgcgl.Styles.TOPO]

map.addBasemapsICGC(basemapsicgc)
//       let layerTree = {
//         features: {
//           type: "FeatureCollection",
//           features: [
//             {
//               type: "Feature",
//               properties: {
//                 icon: "Rubí",
//               },
//               geometry: {
//                 type: "Point",
//                 coordinates: [2.0119, 41.489],
//               },
//             },

//             {
//               type: "Feature",
//               properties: {
//                 icon: "Moià",
//               },
//               geometry: {
//                 type: "Point",
//                 coordinates: [2.119, 41.87],
//               },
//             },
//             {
//               type: "Feature",
//               properties: {
//                 icon: "Les Borges Blanques",
//               },
//               geometry: {
//                 type: "Point",
//                 coordinates: [0.97319, 41.4589],
//               },
//             },
//             {
//               type: "Feature",
//               properties: {
//                 icon: "Berga",
//               },
//               geometry: {
//                 type: "Point",
//                 coordinates: [1.83, 42.163],
//               },
//             },
//           ],
//         },
//         id: "testLayer",
//         type: "geojson",
//       };
      // map.addLayerTree(layerTree);

    })
    </script>
  </body>
</html>
