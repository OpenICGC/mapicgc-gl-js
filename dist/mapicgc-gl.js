(function(EA,Dp){typeof exports=="object"&&typeof module<"u"?Dp(exports):typeof define=="function"&&define.amd?define(["exports"],Dp):(EA=typeof globalThis<"u"?globalThis:EA||self,Dp(EA.mapicgcgl={}))})(this,function(EA){"use strict";function Dp(r,t){for(var e=0;e<t.length;e++){const n=t[e];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in r)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(r,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}var Kd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Np(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var xS={exports:{}};(function(r,t){(function(e,n){r.exports=n()})(Kd,function(){var e={},n={};function i(a,o,d){if(n[a]=d,a==="index"){var p="var sharedModule = {}; ("+n.shared+")(sharedModule); ("+n.worker+")(sharedModule);",y={};return n.shared(y),n.index(e,y),typeof window<"u"&&e.setWorkerUrl(window.URL.createObjectURL(new Blob([p],{type:"text/javascript"}))),e}}i("shared",["exports"],function(a){function o(u,l,h,m){return new(h||(h=Promise))(function(v,E){function T(Q){try{U(m.next(Q))}catch(G){E(G)}}function F(Q){try{U(m.throw(Q))}catch(G){E(G)}}function U(Q){var G;Q.done?v(Q.value):(G=Q.value,G instanceof h?G:new h(function(q){q(G)})).then(T,F)}U((m=m.apply(u,l||[])).next())})}function d(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}typeof SuppressedError=="function"&&SuppressedError;var p=y;function y(u,l){this.x=u,this.y=l}y.prototype={clone:function(){return new y(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,l){return this.clone()._rotateAround(u,l)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var l=u.x-this.x,h=u.y-this.y;return l*l+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,l){return Math.atan2(this.x*l-this.y*u,this.x*u+this.y*l)},_matMult:function(u){var l=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=l,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var l=Math.cos(u),h=Math.sin(u),m=h*this.x+l*this.y;return this.x=l*this.x-h*this.y,this.y=m,this},_rotateAround:function(u,l){var h=Math.cos(u),m=Math.sin(u),v=l.y+m*(this.x-l.x)+h*(this.y-l.y);return this.x=l.x+h*(this.x-l.x)-m*(this.y-l.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},y.convert=function(u){return u instanceof y?u:Array.isArray(u)?new y(u[0],u[1]):u};var b=d(p),x=C;function C(u,l,h,m){this.cx=3*u,this.bx=3*(h-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(m-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=l,this.p2x=h,this.p2y=m}C.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,l){if(l===void 0&&(l=1e-6),u<0)return 0;if(u>1)return 1;for(var h=u,m=0;m<8;m++){var v=this.sampleCurveX(h)-u;if(Math.abs(v)<l)return h;var E=this.sampleCurveDerivativeX(h);if(Math.abs(E)<1e-6)break;h-=v/E}var T=0,F=1;for(h=u,m=0;m<20&&(v=this.sampleCurveX(h),!(Math.abs(v-u)<l));m++)u>v?T=h:F=h,h=.5*(F-T)+T;return h},solve:function(u,l){return this.sampleCurveY(this.solveCurveX(u,l))}};var P=d(x);let M,k;function z(){return M==null&&(M=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),M}function V(){if(k==null&&(k=!1,z())){const l=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(l){for(let m=0;m<5*5;m++){const v=4*m;l.fillStyle=`rgb(${v},${v+1},${v+2})`,l.fillRect(m%5,Math.floor(m/5),1,1)}const h=l.getImageData(0,0,5,5).data;for(let m=0;m<5*5*4;m++)if(m%4!=3&&h[m]!==m){k=!0;break}}}return k||!1}function $(u,l,h,m){const v=new P(u,l,h,m);return E=>v.solve(E)}const tt=$(.25,.1,.25,1);function pt(u,l,h){return Math.min(h,Math.max(l,u))}function gt(u,l,h){const m=h-l,v=((u-l)%m+m)%m+l;return v===l?h:v}function mt(u){for(var l=arguments.length,h=new Array(l>1?l-1:0),m=1;m<l;m++)h[m-1]=arguments[m];for(const v of h)for(const E in v)u[E]=v[E];return u}let dt=1;function Ft(u,l,h){const m={};for(const v in u)m[v]=l.call(this,u[v],v,u);return m}function Tt(u,l,h){const m={};for(const v in u)l.call(this,u[v],v,u)&&(m[v]=u[v]);return m}function ot(u){return Array.isArray(u)?u.map(ot):typeof u=="object"&&u?Ft(u,ot):u}const ct={};function wt(u){ct[u]||(typeof console<"u"&&console.warn(u),ct[u]=!0)}function vt(u,l,h){return(h.y-u.y)*(l.x-u.x)>(l.y-u.y)*(h.x-u.x)}function $t(u){return typeof WorkerGlobalScope<"u"&&u!==void 0&&u instanceof WorkerGlobalScope}let Wt=null;function Yt(u){return typeof ImageBitmap<"u"&&u instanceof ImageBitmap}const Kt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function ee(u,l,h,m,v){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const E=new VideoFrame(u,{timestamp:0});try{const T=E==null?void 0:E.format;if(!T||!T.startsWith("BGR")&&!T.startsWith("RGB"))throw new Error(`Unrecognized format ${T}`);const F=T.startsWith("BGR"),U=new Uint8ClampedArray(m*v*4);if(yield E.copyTo(U,function(Q,G,q,J,rt){const ut=4*Math.max(-G,0),_t=(Math.max(0,q)-q)*J*4+ut,St=4*J,Rt=Math.max(0,G),Xt=Math.max(0,q);return{rect:{x:Rt,y:Xt,width:Math.min(Q.width,G+J)-Rt,height:Math.min(Q.height,q+rt)-Xt},layout:[{offset:_t,stride:St}]}}(u,l,h,m,v)),F)for(let Q=0;Q<U.length;Q+=4){const G=U[Q];U[Q]=U[Q+2],U[Q+2]=G}return U}finally{E.close()}})}let Zt,we;const it="AbortError";function xt(){return new Error(it)}const It={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Ut(u){return It.REGISTERED_PROTOCOLS[u.substring(0,u.indexOf("://"))]}const jt="global-dispatcher";class Vt extends Error{constructor(l,h,m,v){super(`AJAXError: ${h} (${l}): ${m}`),this.status=l,this.statusText=h,this.url=m,this.body=v}}const re=()=>$t(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,te=function(u,l){if(/:\/\//.test(u.url)&&!/^https?:|^file:/.test(u.url)){const m=Ut(u.url);if(m)return m(u,l);if($t(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:u,targetMapId:jt},l)}if(!(/^file:/.test(h=u.url)||/^file:/.test(re())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(m,v){return o(this,void 0,void 0,function*(){const E=new Request(m.url,{method:m.method||"GET",body:m.body,credentials:m.credentials,headers:m.headers,cache:m.cache,referrer:re(),signal:v.signal});m.type!=="json"||E.headers.has("Accept")||E.headers.set("Accept","application/json");const T=yield fetch(E);if(!T.ok){const Q=yield T.blob();throw new Vt(T.status,T.statusText,m.url,Q)}let F;F=m.type==="arrayBuffer"||m.type==="image"?T.arrayBuffer():m.type==="json"?T.json():T.text();const U=yield F;if(v.signal.aborted)throw xt();return{data:U,cacheControl:T.headers.get("Cache-Control"),expires:T.headers.get("Expires")}})}(u,l);if($t(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:u,mustQueue:!0,targetMapId:jt},l)}var h;return function(m,v){return new Promise((E,T)=>{var F;const U=new XMLHttpRequest;U.open(m.method||"GET",m.url,!0),m.type!=="arrayBuffer"&&m.type!=="image"||(U.responseType="arraybuffer");for(const Q in m.headers)U.setRequestHeader(Q,m.headers[Q]);m.type==="json"&&(U.responseType="text",!((F=m.headers)===null||F===void 0)&&F.Accept||U.setRequestHeader("Accept","application/json")),U.withCredentials=m.credentials==="include",U.onerror=()=>{T(new Error(U.statusText))},U.onload=()=>{if(!v.signal.aborted)if((U.status>=200&&U.status<300||U.status===0)&&U.response!==null){let Q=U.response;if(m.type==="json")try{Q=JSON.parse(U.response)}catch(G){return void T(G)}E({data:Q,cacheControl:U.getResponseHeader("Cache-Control"),expires:U.getResponseHeader("Expires")})}else{const Q=new Blob([U.response],{type:U.getResponseHeader("Content-Type")});T(new Vt(U.status,U.statusText,m.url,Q))}},v.signal.addEventListener("abort",()=>{U.abort(),T(xt())}),U.send(m.body)})}(u,l)};function Ce(u){if(!u||u.indexOf("://")<=0||u.indexOf("data:image/")===0||u.indexOf("blob:")===0)return!0;const l=new URL(u),h=window.location;return l.protocol===h.protocol&&l.host===h.host}function Te(u,l,h){h[u]&&h[u].indexOf(l)!==-1||(h[u]=h[u]||[],h[u].push(l))}function De(u,l,h){if(h&&h[u]){const m=h[u].indexOf(l);m!==-1&&h[u].splice(m,1)}}class Qe{constructor(l){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};mt(this,h),this.type=l}}class Je extends Qe{constructor(l){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super("error",mt({error:l},h))}}class he{on(l,h){return this._listeners=this._listeners||{},Te(l,h,this._listeners),this}off(l,h){return De(l,h,this._listeners),De(l,h,this._oneTimeListeners),this}once(l,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},Te(l,h,this._oneTimeListeners),this):new Promise(m=>this.once(l,m))}fire(l,h){typeof l=="string"&&(l=new Qe(l,h||{}));const m=l.type;if(this.listens(m)){l.target=this;const v=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];for(const F of v)F.call(this,l);const E=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];for(const F of E)De(m,F,this._oneTimeListeners),F.call(this,l);const T=this._eventedParent;T&&(mt(l,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(l))}else l instanceof Je&&console.error(l.error);return this}listens(l){return this._listeners&&this._listeners[l]&&this._listeners[l].length>0||this._oneTimeListeners&&this._oneTimeListeners[l]&&this._oneTimeListeners[l].length>0||this._eventedParent&&this._eventedParent.listens(l)}setEventedParent(l,h){return this._eventedParent=l,this._eventedParentData=h,this}}var st={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const fr=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function er(u,l){const h={};for(const m in u)m!=="ref"&&(h[m]=u[m]);return fr.forEach(m=>{m in l&&(h[m]=l[m])}),h}function de(u,l){if(Array.isArray(u)){if(!Array.isArray(l)||u.length!==l.length)return!1;for(let h=0;h<u.length;h++)if(!de(u[h],l[h]))return!1;return!0}if(typeof u=="object"&&u!==null&&l!==null){if(typeof l!="object"||Object.keys(u).length!==Object.keys(l).length)return!1;for(const h in u)if(!de(u[h],l[h]))return!1;return!0}return u===l}function ve(u,l){u.push(l)}function Le(u,l,h){ve(h,{command:"addSource",args:[u,l[u]]})}function Ue(u,l,h){ve(l,{command:"removeSource",args:[u]}),h[u]=!0}function Ye(u,l,h,m){Ue(u,h,m),Le(u,l,h)}function lr(u,l,h){let m;for(m in u[h])if(Object.prototype.hasOwnProperty.call(u[h],m)&&m!=="data"&&!de(u[h][m],l[h][m]))return!1;for(m in l[h])if(Object.prototype.hasOwnProperty.call(l[h],m)&&m!=="data"&&!de(u[h][m],l[h][m]))return!1;return!0}function yr(u,l,h,m,v,E){u=u||{},l=l||{};for(const T in u)Object.prototype.hasOwnProperty.call(u,T)&&(de(u[T],l[T])||h.push({command:E,args:[m,T,l[T],v]}));for(const T in l)Object.prototype.hasOwnProperty.call(l,T)&&!Object.prototype.hasOwnProperty.call(u,T)&&(de(u[T],l[T])||h.push({command:E,args:[m,T,l[T],v]}))}function Lr(u){return u.id}function Dr(u,l){return u[l.id]=l,u}class pe{constructor(l,h,m,v){this.message=(l?`${l}: `:"")+m,v&&(this.identifier=v),h!=null&&h.__line__&&(this.line=h.__line__)}}function cr(u){for(var l=arguments.length,h=new Array(l>1?l-1:0),m=1;m<l;m++)h[m-1]=arguments[m];for(const v of h)for(const E in v)u[E]=v[E];return u}class _r extends Error{constructor(l,h){super(h),this.message=h,this.key=l}}class Re{constructor(l){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.parent=l,this.bindings={};for(const[m,v]of h)this.bindings[m]=v}concat(l){return new Re(this,l)}get(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(`${l} not found in scope.`)}has(l){return!!this.bindings[l]||!!this.parent&&this.parent.has(l)}}const An={kind:"null"},me={kind:"number"},gr={kind:"string"},Ne={kind:"boolean"},Ur={kind:"color"},_n={kind:"object"},ke={kind:"value"},Qn={kind:"collator"},nn={kind:"formatted"},vn={kind:"padding"},ln={kind:"resolvedImage"},Ct={kind:"variableAnchorOffsetCollection"};function W(u,l){return{kind:"array",itemType:u,N:l}}function X(u){if(u.kind==="array"){const l=X(u.itemType);return typeof u.N=="number"?`array<${l}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${l}>`}return u.kind}const ft=[An,me,gr,Ne,Ur,nn,_n,W(ke),vn,ln,Ct];function Bt(u,l){if(l.kind==="error")return null;if(u.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!Bt(u.itemType,l.itemType))&&(typeof u.N!="number"||u.N===l.N))return null}else{if(u.kind===l.kind)return null;if(u.kind==="value"){for(const h of ft)if(!Bt(h,l))return null}}return`Expected ${X(u)} but found ${X(l)} instead.`}function kt(u,l){return l.some(h=>h.kind===u.kind)}function Gt(u,l){return l.some(h=>h==="null"?u===null:h==="array"?Array.isArray(u):h==="object"?u&&!Array.isArray(u)&&typeof u=="object":h===typeof u)}function Ot(u,l){return u.kind==="array"&&l.kind==="array"?u.itemType.kind===l.itemType.kind&&typeof u.N=="number":u.kind===l.kind}const Pt=.96422,ae=.82521,fe=4/29,Jt=6/29,xe=3*Jt*Jt,Ge=Jt*Jt*Jt,nr=Math.PI/180,Br=180/Math.PI;function Tr(u){return(u%=360)<0&&(u+=360),u}function pr(u){let[l,h,m,v]=u,E,T;const F=Gr((.2225045*(l=Qr(l))+.7168786*(h=Qr(h))+.0606169*(m=Qr(m)))/1);l===h&&h===m?E=T=F:(E=Gr((.4360747*l+.3850649*h+.1430804*m)/Pt),T=Gr((.0139322*l+.0971045*h+.7141733*m)/ae));const U=116*F-16;return[U<0?0:U,500*(E-F),200*(F-T),v]}function Qr(u){return u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function Gr(u){return u>Ge?Math.pow(u,1/3):u/xe+fe}function cn(u){let[l,h,m,v]=u,E=(l+16)/116,T=isNaN(h)?E:E+h/500,F=isNaN(m)?E:E-m/200;return E=1*jr(E),T=Pt*jr(T),F=ae*jr(F),[br(3.1338561*T-1.6168667*E-.4906146*F),br(-.9787684*T+1.9161415*E+.033454*F),br(.0719453*T-.2289914*E+1.4052427*F),v]}function br(u){return(u=u<=.00304?12.92*u:1.055*Math.pow(u,1/2.4)-.055)<0?0:u>1?1:u}function jr(u){return u>Jt?u*u*u:xe*(u-fe)}function sn(u){return parseInt(u.padEnd(2,u),16)/255}function Sn(u,l){return Mt(l?u/100:u,0,1)}function Mt(u,l,h){return Math.min(Math.max(l,u),h)}function Oe(u){return!u.some(Number.isNaN)}const Ee={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class or{constructor(l,h,m){let v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;this.r=l,this.g=h,this.b=m,this.a=v,E||(this.r*=v,this.g*=v,this.b*=v,v||this.overwriteGetter("rgb",[l,h,m,v]))}static parse(l){if(l instanceof or)return l;if(typeof l!="string")return;const h=function(m){if((m=m.toLowerCase().trim())==="transparent")return[0,0,0,0];const v=Ee[m];if(v){const[T,F,U]=v;return[T/255,F/255,U/255,1]}if(m.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(m)){const T=m.length<6?1:2;let F=1;return[sn(m.slice(F,F+=T)),sn(m.slice(F,F+=T)),sn(m.slice(F,F+=T)),sn(m.slice(F,F+T)||"ff")]}if(m.startsWith("rgb")){const T=m.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[F,U,Q,G,q,J,rt,ut,_t,St,Rt,Xt]=T,Qt=[G||" ",rt||" ",St].join("");if(Qt==="  "||Qt==="  /"||Qt===",,"||Qt===",,,"){const qt=[Q,J,_t].join(""),Ae=qt==="%%%"?100:qt===""?255:0;if(Ae){const Be=[Mt(+U/Ae,0,1),Mt(+q/Ae,0,1),Mt(+ut/Ae,0,1),Rt?Sn(+Rt,Xt):1];if(Oe(Be))return Be}}return}}const E=m.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(E){const[T,F,U,Q,G,q,J,rt,ut]=E,_t=[U||" ",G||" ",J].join("");if(_t==="  "||_t==="  /"||_t===",,"||_t===",,,"){const St=[+F,Mt(+Q,0,100),Mt(+q,0,100),rt?Sn(+rt,ut):1];if(Oe(St))return function(Rt){let[Xt,Qt,qt,Ae]=Rt;function Be(qe){const wr=(qe+Xt/30)%12,Ke=Qt*Math.min(qt,1-qt);return qt-Ke*Math.max(-1,Math.min(wr-3,9-wr,1))}return Xt=Tr(Xt),Qt/=100,qt/=100,[Be(0),Be(8),Be(4),Ae]}(St)}}}(l);return h?new or(...h,!1):void 0}get rgb(){const{r:l,g:h,b:m,a:v}=this,E=v||1/0;return this.overwriteGetter("rgb",[l/E,h/E,m/E,v])}get hcl(){return this.overwriteGetter("hcl",function(l){const[h,m,v,E]=pr(l),T=Math.sqrt(m*m+v*v);return[Math.round(1e4*T)?Tr(Math.atan2(v,m)*Br):NaN,T,h,E]}(this.rgb))}get lab(){return this.overwriteGetter("lab",pr(this.rgb))}overwriteGetter(l,h){return Object.defineProperty(this,l,{value:h}),h}toString(){const[l,h,m,v]=this.rgb;return`rgba(${[l,h,m].map(E=>Math.round(255*E)).join(",")},${v})`}}or.black=new or(0,0,0,1),or.white=new or(1,1,1,1),or.transparent=new or(0,0,0,0),or.red=new or(1,0,0,1);class Pr{constructor(l,h,m){this.sensitivity=l?h?"variant":"case":h?"accent":"base",this.locale=m,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(l,h){return this.collator.compare(l,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Mn{constructor(l,h,m,v,E){this.text=l,this.image=h,this.scale=m,this.fontStack=v,this.textColor=E}}class qr{constructor(l){this.sections=l}static fromString(l){return new qr([new Mn(l,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(l=>l.text.length!==0||l.image&&l.image.name.length!==0)}static factory(l){return l instanceof qr?l:qr.fromString(l)}toString(){return this.sections.length===0?"":this.sections.map(l=>l.text).join("")}}class gn{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof gn)return l;if(typeof l=="number")return new gn([l,l,l,l]);if(Array.isArray(l)&&!(l.length<1||l.length>4)){for(const h of l)if(typeof h!="number")return;switch(l.length){case 1:l=[l[0],l[0],l[0],l[0]];break;case 2:l=[l[0],l[1],l[0],l[1]];break;case 3:l=[l[0],l[1],l[2],l[1]]}return new gn(l)}}toString(){return JSON.stringify(this.values)}}const vi=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class mn{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof mn)return l;if(Array.isArray(l)&&!(l.length<1)&&l.length%2==0){for(let h=0;h<l.length;h+=2){const m=l[h],v=l[h+1];if(typeof m!="string"||!vi.has(m)||!Array.isArray(v)||v.length!==2||typeof v[0]!="number"||typeof v[1]!="number")return}return new mn(l)}}toString(){return JSON.stringify(this.values)}}class Wr{constructor(l){this.name=l.name,this.available=l.available}toString(){return this.name}static fromString(l){return l?new Wr({name:l,available:!1}):null}}function Da(u,l,h,m){return typeof u=="number"&&u>=0&&u<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof h=="number"&&h>=0&&h<=255?m===void 0||typeof m=="number"&&m>=0&&m<=1?null:`Invalid rgba value [${[u,l,h,m].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof m=="number"?[u,l,h,m]:[u,l,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Xs(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof or||u instanceof Pr||u instanceof qr||u instanceof gn||u instanceof mn||u instanceof Wr)return!0;if(Array.isArray(u)){for(const l of u)if(!Xs(l))return!1;return!0}if(typeof u=="object"){for(const l in u)if(!Xs(u[l]))return!1;return!0}return!1}function zn(u){if(u===null)return An;if(typeof u=="string")return gr;if(typeof u=="boolean")return Ne;if(typeof u=="number")return me;if(u instanceof or)return Ur;if(u instanceof Pr)return Qn;if(u instanceof qr)return nn;if(u instanceof gn)return vn;if(u instanceof mn)return Ct;if(u instanceof Wr)return ln;if(Array.isArray(u)){const l=u.length;let h;for(const m of u){const v=zn(m);if(h){if(h===v)continue;h=ke;break}h=v}return W(h||ke,l)}return _n}function Jr(u){const l=typeof u;return u===null?"":l==="string"||l==="number"||l==="boolean"?String(u):u instanceof or||u instanceof qr||u instanceof gn||u instanceof mn||u instanceof Wr?u.toString():JSON.stringify(u)}class vs{constructor(l,h){this.type=l,this.value=h}static parse(l,h){if(l.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${l.length-1} instead.`);if(!Xs(l[1]))return h.error("invalid value");const m=l[1];let v=zn(m);const E=h.expectedType;return v.kind!=="array"||v.N!==0||!E||E.kind!=="array"||typeof E.N=="number"&&E.N!==0||(v=E),new vs(v,m)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Nn{constructor(l){this.name="ExpressionEvaluationError",this.message=l}toJSON(){return this.message}}const Qo={string:gr,number:me,boolean:Ne,object:_n};class Ti{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");let m,v=1;const E=l[0];if(E==="array"){let F,U;if(l.length>2){const Q=l[1];if(typeof Q!="string"||!(Q in Qo)||Q==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);F=Qo[Q],v++}else F=ke;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return h.error('The length argument to "array" must be a positive integer literal',2);U=l[2],v++}m=W(F,U)}else{if(!Qo[E])throw new Error(`Types doesn't contain name = ${E}`);m=Qo[E]}const T=[];for(;v<l.length;v++){const F=h.parse(l[v],v,ke);if(!F)return null;T.push(F)}return new Ti(m,T)}evaluate(l){for(let h=0;h<this.args.length;h++){const m=this.args[h].evaluate(l);if(!Bt(this.type,zn(m)))return m;if(h===this.args.length-1)throw new Nn(`Expected value to be of type ${X(this.type)}, but found ${X(zn(m))} instead.`)}throw new Error}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const zo={"to-boolean":Ne,"to-color":Ur,"to-number":me,"to-string":gr};class hi{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");const m=l[0];if(!zo[m])throw new Error(`Can't parse ${m} as it is not part of the known types`);if((m==="to-boolean"||m==="to-string")&&l.length!==2)return h.error("Expected one argument.");const v=zo[m],E=[];for(let T=1;T<l.length;T++){const F=h.parse(l[T],T,ke);if(!F)return null;E.push(F)}return new hi(v,E)}evaluate(l){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(l);case"color":{let h,m;for(const v of this.args){if(h=v.evaluate(l),m=null,h instanceof or)return h;if(typeof h=="string"){const E=l.parseColor(h);if(E)return E}else if(Array.isArray(h)&&(m=h.length<3||h.length>4?`Invalid rbga value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:Da(h[0],h[1],h[2],h[3]),!m))return new or(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new Nn(m||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const m of this.args){h=m.evaluate(l);const v=gn.parse(h);if(v)return v}throw new Nn(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const m of this.args){h=m.evaluate(l);const v=mn.parse(h);if(v)return v}throw new Nn(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const m of this.args){if(h=m.evaluate(l),h===null)return 0;const v=Number(h);if(!isNaN(v))return v}throw new Nn(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return qr.fromString(Jr(this.args[0].evaluate(l)));case"resolvedImage":return Wr.fromString(Jr(this.args[0].evaluate(l)));default:return Jr(this.args[0].evaluate(l))}}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const ts=["Unknown","Point","LineString","Polygon"];class Ii{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ts[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(l){let h=this._parseColorCache[l];return h||(h=this._parseColorCache[l]=or.parse(l)),h}}class bs{constructor(l,h){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=arguments.length>3?arguments[3]:void 0,E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:new Re,T=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[];this.registry=l,this.path=m,this.key=m.map(F=>`[${F}]`).join(""),this.scope=E,this.errors=T,this.expectedType=v,this._isConstant=h}parse(l,h,m,v){let E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};return h?this.concat(h,m,v)._parse(l,E):this._parse(l,E)}_parse(l,h){function m(v,E,T){return T==="assert"?new Ti(E,[v]):T==="coerce"?new hi(E,[v]):v}if(l!==null&&typeof l!="string"&&typeof l!="boolean"&&typeof l!="number"||(l=["literal",l]),Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const v=l[0];if(typeof v!="string")return this.error(`Expression name must be a string, but found ${typeof v} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const E=this.registry[v];if(E){let T=E.parse(l,this);if(!T)return null;if(this.expectedType){const F=this.expectedType,U=T.type;if(F.kind!=="string"&&F.kind!=="number"&&F.kind!=="boolean"&&F.kind!=="object"&&F.kind!=="array"||U.kind!=="value")if(F.kind!=="color"&&F.kind!=="formatted"&&F.kind!=="resolvedImage"||U.kind!=="value"&&U.kind!=="string")if(F.kind!=="padding"||U.kind!=="value"&&U.kind!=="number"&&U.kind!=="array")if(F.kind!=="variableAnchorOffsetCollection"||U.kind!=="value"&&U.kind!=="array"){if(this.checkSubtype(F,U))return null}else T=m(T,F,h.typeAnnotation||"coerce");else T=m(T,F,h.typeAnnotation||"coerce");else T=m(T,F,h.typeAnnotation||"coerce");else T=m(T,F,h.typeAnnotation||"assert")}if(!(T instanceof vs)&&T.type.kind!=="resolvedImage"&&this._isConstant(T)){const F=new Ii;try{T=new vs(T.type,T.evaluate(F))}catch(U){return this.error(U.message),null}}return T}return this.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(l===void 0?"'undefined' value invalid. Use null instead.":typeof l=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof l} instead.`)}concat(l,h,m){const v=typeof l=="number"?this.path.concat(l):this.path,E=m?this.scope.concat(m):this.scope;return new bs(this.registry,this._isConstant,v,h||null,E,this.errors)}error(l){for(var h=arguments.length,m=new Array(h>1?h-1:0),v=1;v<h;v++)m[v-1]=arguments[v];const E=`${this.key}${m.map(T=>`[${T}]`).join("")}`;this.errors.push(new _r(E,l))}checkSubtype(l,h){const m=Bt(l,h);return m&&this.error(m),m}}class tn{constructor(l,h){this.type=h.type,this.bindings=[].concat(l),this.result=h}evaluate(l){return this.result.evaluate(l)}eachChild(l){for(const h of this.bindings)l(h[1]);l(this.result)}static parse(l,h){if(l.length<4)return h.error(`Expected at least 3 arguments, but found ${l.length-1} instead.`);const m=[];for(let E=1;E<l.length-1;E+=2){const T=l[E];if(typeof T!="string")return h.error(`Expected string, but found ${typeof T} instead.`,E);if(/[^a-zA-Z0-9_]/.test(T))return h.error("Variable names must contain only alphanumeric characters or '_'.",E);const F=h.parse(l[E+1],E+1);if(!F)return null;m.push([T,F])}const v=h.parse(l[l.length-1],l.length-1,h.expectedType,m);return v?new tn(m,v):null}outputDefined(){return this.result.outputDefined()}}class Na{constructor(l,h){this.type=h.type,this.name=l,this.boundExpression=h}static parse(l,h){if(l.length!==2||typeof l[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const m=l[1];return h.scope.has(m)?new Na(m,h.scope.get(m)):h.error(`Unknown variable "${m}". Make sure "${m}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(l){return this.boundExpression.evaluate(l)}eachChild(){}outputDefined(){return!1}}class _l{constructor(l,h,m){this.type=l,this.index=h,this.input=m}static parse(l,h){if(l.length!==3)return h.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const m=h.parse(l[1],1,me),v=h.parse(l[2],2,W(h.expectedType||ke));return m&&v?new _l(v.type.itemType,m,v):null}evaluate(l){const h=this.index.evaluate(l),m=this.input.evaluate(l);if(h<0)throw new Nn(`Array index out of bounds: ${h} < 0.`);if(h>=m.length)throw new Nn(`Array index out of bounds: ${h} > ${m.length-1}.`);if(h!==Math.floor(h))throw new Nn(`Array index must be an integer, but found ${h} instead.`);return m[h]}eachChild(l){l(this.index),l(this.input)}outputDefined(){return!1}}class ka{constructor(l,h){this.type=Ne,this.needle=l,this.haystack=h}static parse(l,h){if(l.length!==3)return h.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const m=h.parse(l[1],1,ke),v=h.parse(l[2],2,ke);return m&&v?kt(m.type,[Ne,gr,me,An,ke])?new ka(m,v):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${X(m.type)} instead`):null}evaluate(l){const h=this.needle.evaluate(l),m=this.haystack.evaluate(l);if(!m)return!1;if(!Gt(h,["boolean","string","number","null"]))throw new Nn(`Expected first argument to be of type boolean, string, number or null, but found ${X(zn(h))} instead.`);if(!Gt(m,["string","array"]))throw new Nn(`Expected second argument to be of type array or string, but found ${X(zn(m))} instead.`);return m.indexOf(h)>=0}eachChild(l){l(this.needle),l(this.haystack)}outputDefined(){return!0}}class ht{constructor(l,h,m){this.type=me,this.needle=l,this.haystack=h,this.fromIndex=m}static parse(l,h){if(l.length<=2||l.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const m=h.parse(l[1],1,ke),v=h.parse(l[2],2,ke);if(!m||!v)return null;if(!kt(m.type,[Ne,gr,me,An,ke]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${X(m.type)} instead`);if(l.length===4){const E=h.parse(l[3],3,me);return E?new ht(m,v,E):null}return new ht(m,v)}evaluate(l){const h=this.needle.evaluate(l),m=this.haystack.evaluate(l);if(!Gt(h,["boolean","string","number","null"]))throw new Nn(`Expected first argument to be of type boolean, string, number or null, but found ${X(zn(h))} instead.`);if(!Gt(m,["string","array"]))throw new Nn(`Expected second argument to be of type array or string, but found ${X(zn(m))} instead.`);if(this.fromIndex){const v=this.fromIndex.evaluate(l);return m.indexOf(h,v)}return m.indexOf(h)}eachChild(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)}outputDefined(){return!1}}class bt{constructor(l,h,m,v,E,T){this.inputType=l,this.type=h,this.input=m,this.cases=v,this.outputs=E,this.otherwise=T}static parse(l,h){if(l.length<5)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if(l.length%2!=1)return h.error("Expected an even number of arguments.");let m,v;h.expectedType&&h.expectedType.kind!=="value"&&(v=h.expectedType);const E={},T=[];for(let Q=2;Q<l.length-1;Q+=2){let G=l[Q];const q=l[Q+1];Array.isArray(G)||(G=[G]);const J=h.concat(Q);if(G.length===0)return J.error("Expected at least one branch label.");for(const ut of G){if(typeof ut!="number"&&typeof ut!="string")return J.error("Branch labels must be numbers or strings.");if(typeof ut=="number"&&Math.abs(ut)>Number.MAX_SAFE_INTEGER)return J.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ut=="number"&&Math.floor(ut)!==ut)return J.error("Numeric branch labels must be integer values.");if(m){if(J.checkSubtype(m,zn(ut)))return null}else m=zn(ut);if(E[String(ut)]!==void 0)return J.error("Branch labels must be unique.");E[String(ut)]=T.length}const rt=h.parse(q,Q,v);if(!rt)return null;v=v||rt.type,T.push(rt)}const F=h.parse(l[1],1,ke);if(!F)return null;const U=h.parse(l[l.length-1],l.length-1,v);return U?F.type.kind!=="value"&&h.concat(1).checkSubtype(m,F.type)?null:new bt(m,v,F,E,T,U):null}evaluate(l){const h=this.input.evaluate(l);return(zn(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(l)}eachChild(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)}outputDefined(){return this.outputs.every(l=>l.outputDefined())&&this.otherwise.outputDefined()}}class Nt{constructor(l,h,m){this.type=l,this.branches=h,this.otherwise=m}static parse(l,h){if(l.length<4)return h.error(`Expected at least 3 arguments, but found only ${l.length-1}.`);if(l.length%2!=0)return h.error("Expected an odd number of arguments.");let m;h.expectedType&&h.expectedType.kind!=="value"&&(m=h.expectedType);const v=[];for(let T=1;T<l.length-1;T+=2){const F=h.parse(l[T],T,Ne);if(!F)return null;const U=h.parse(l[T+1],T+1,m);if(!U)return null;v.push([F,U]),m=m||U.type}const E=h.parse(l[l.length-1],l.length-1,m);if(!E)return null;if(!m)throw new Error("Can't infer output type");return new Nt(m,v,E)}evaluate(l){for(const[h,m]of this.branches)if(h.evaluate(l))return m.evaluate(l);return this.otherwise.evaluate(l)}eachChild(l){for(const[h,m]of this.branches)l(h),l(m);l(this.otherwise)}outputDefined(){return this.branches.every(l=>{let[h,m]=l;return m.outputDefined()})&&this.otherwise.outputDefined()}}class le{constructor(l,h,m,v){this.type=l,this.input=h,this.beginIndex=m,this.endIndex=v}static parse(l,h){if(l.length<=2||l.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const m=h.parse(l[1],1,ke),v=h.parse(l[2],2,me);if(!m||!v)return null;if(!kt(m.type,[W(ke),gr,ke]))return h.error(`Expected first argument to be of type array or string, but found ${X(m.type)} instead`);if(l.length===4){const E=h.parse(l[3],3,me);return E?new le(m.type,m,v,E):null}return new le(m.type,m,v)}evaluate(l){const h=this.input.evaluate(l),m=this.beginIndex.evaluate(l);if(!Gt(h,["string","array"]))throw new Nn(`Expected first argument to be of type array or string, but found ${X(zn(h))} instead.`);if(this.endIndex){const v=this.endIndex.evaluate(l);return h.slice(m,v)}return h.slice(m)}eachChild(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)}outputDefined(){return!1}}function Ie(u,l){const h=u.length-1;let m,v,E=0,T=h,F=0;for(;E<=T;)if(F=Math.floor((E+T)/2),m=u[F],v=u[F+1],m<=l){if(F===h||l<v)return F;E=F+1}else{if(!(m>l))throw new Nn("Input is not a number.");T=F-1}return 0}class Ze{constructor(l,h,m){this.type=l,this.input=h,this.labels=[],this.outputs=[];for(const[v,E]of m)this.labels.push(v),this.outputs.push(E)}static parse(l,h){if(l.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return h.error("Expected an even number of arguments.");const m=h.parse(l[1],1,me);if(!m)return null;const v=[];let E=null;h.expectedType&&h.expectedType.kind!=="value"&&(E=h.expectedType);for(let T=1;T<l.length;T+=2){const F=T===1?-1/0:l[T],U=l[T+1],Q=T,G=T+1;if(typeof F!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Q);if(v.length&&v[v.length-1][0]>=F)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Q);const q=h.parse(U,G,E);if(!q)return null;E=E||q.type,v.push([F,q])}return new Ze(E,m,v)}evaluate(l){const h=this.labels,m=this.outputs;if(h.length===1)return m[0].evaluate(l);const v=this.input.evaluate(l);if(v<=h[0])return m[0].evaluate(l);const E=h.length;return v>=h[E-1]?m[E-1].evaluate(l):m[Ie(h,v)].evaluate(l)}eachChild(l){l(this.input);for(const h of this.outputs)l(h)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function zr(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var Zn=ti;function ti(u,l,h,m){this.cx=3*u,this.bx=3*(h-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(m-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=l,this.p2x=h,this.p2y=m}ti.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,l){if(l===void 0&&(l=1e-6),u<0)return 0;if(u>1)return 1;for(var h=u,m=0;m<8;m++){var v=this.sampleCurveX(h)-u;if(Math.abs(v)<l)return h;var E=this.sampleCurveDerivativeX(h);if(Math.abs(E)<1e-6)break;h-=v/E}var T=0,F=1;for(h=u,m=0;m<20&&(v=this.sampleCurveX(h),!(Math.abs(v-u)<l));m++)u>v?T=h:F=h,h=.5*(F-T)+T;return h},solve:function(u,l){return this.sampleCurveY(this.solveCurveX(u,l))}};var Fi=zr(Zn);function yn(u,l,h){return u+h*(l-u)}function yc(u,l,h){return u.map((m,v)=>yn(m,l[v],h))}const As={number:yn,color:function(u,l,h){switch(arguments.length>3&&arguments[3]!==void 0?arguments[3]:"rgb"){case"rgb":{const[v,E,T,F]=yc(u.rgb,l.rgb,h);return new or(v,E,T,F,!1)}case"hcl":{const[v,E,T,F]=u.hcl,[U,Q,G,q]=l.hcl;let J,rt;if(isNaN(v)||isNaN(U))isNaN(v)?isNaN(U)?J=NaN:(J=U,T!==1&&T!==0||(rt=Q)):(J=v,G!==1&&G!==0||(rt=E));else{let Xt=U-v;U>v&&Xt>180?Xt-=360:U<v&&v-U>180&&(Xt+=360),J=v+h*Xt}const[ut,_t,St,Rt]=function(Xt){let[Qt,qt,Ae,Be]=Xt;return Qt=isNaN(Qt)?0:Qt*nr,cn([Ae,Math.cos(Qt)*qt,Math.sin(Qt)*qt,Be])}([J,rt??yn(E,Q,h),yn(T,G,h),yn(F,q,h)]);return new or(ut,_t,St,Rt,!1)}case"lab":{const[v,E,T,F]=cn(yc(u.lab,l.lab,h));return new or(v,E,T,F,!1)}}},array:yc,padding:function(u,l,h){return new gn(yc(u.values,l.values,h))},variableAnchorOffsetCollection:function(u,l,h){const m=u.values,v=l.values;if(m.length!==v.length)throw new Nn(`Cannot interpolate values of different length. from: ${u.toString()}, to: ${l.toString()}`);const E=[];for(let T=0;T<m.length;T+=2){if(m[T]!==v[T])throw new Nn(`Cannot interpolate values containing mismatched anchors. from[${T}]: ${m[T]}, to[${T}]: ${v[T]}`);E.push(m[T]);const[F,U]=m[T+1],[Q,G]=v[T+1];E.push([yn(F,Q,h),yn(U,G,h)])}return new mn(E)}};class Ir{constructor(l,h,m,v,E){this.type=l,this.operator=h,this.interpolation=m,this.input=v,this.labels=[],this.outputs=[];for(const[T,F]of E)this.labels.push(T),this.outputs.push(F)}static interpolationFactor(l,h,m,v){let E=0;if(l.name==="exponential")E=_c(h,l.base,m,v);else if(l.name==="linear")E=_c(h,1,m,v);else if(l.name==="cubic-bezier"){const T=l.controlPoints;E=new Fi(T[0],T[1],T[2],T[3]).solve(_c(h,1,m,v))}return E}static parse(l,h){let[m,v,E,...T]=l;if(!Array.isArray(v)||v.length===0)return h.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){const Q=v[1];if(typeof Q!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:Q}}else{if(v[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(v[0])}`,1,0);{const Q=v.slice(1);if(Q.length!==4||Q.some(G=>typeof G!="number"||G<0||G>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:Q}}}if(l.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(E=h.parse(E,2,me),!E)return null;const F=[];let U=null;m==="interpolate-hcl"||m==="interpolate-lab"?U=Ur:h.expectedType&&h.expectedType.kind!=="value"&&(U=h.expectedType);for(let Q=0;Q<T.length;Q+=2){const G=T[Q],q=T[Q+1],J=Q+3,rt=Q+4;if(typeof G!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',J);if(F.length&&F[F.length-1][0]>=G)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',J);const ut=h.parse(q,rt,U);if(!ut)return null;U=U||ut.type,F.push([G,ut])}return Ot(U,me)||Ot(U,Ur)||Ot(U,vn)||Ot(U,Ct)||Ot(U,W(me))?new Ir(U,m,v,E,F):h.error(`Type ${X(U)} is not interpolatable.`)}evaluate(l){const h=this.labels,m=this.outputs;if(h.length===1)return m[0].evaluate(l);const v=this.input.evaluate(l);if(v<=h[0])return m[0].evaluate(l);const E=h.length;if(v>=h[E-1])return m[E-1].evaluate(l);const T=Ie(h,v),F=Ir.interpolationFactor(this.interpolation,v,h[T],h[T+1]),U=m[T].evaluate(l),Q=m[T+1].evaluate(l);switch(this.operator){case"interpolate":return As[this.type.kind](U,Q,F);case"interpolate-hcl":return As.color(U,Q,F,"hcl");case"interpolate-lab":return As.color(U,Q,F,"lab")}}eachChild(l){l(this.input);for(const h of this.outputs)l(h)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function _c(u,l,h,m){const v=m-h,E=u-h;return v===0?0:l===1?E/v:(Math.pow(l,E)-1)/(Math.pow(l,v)-1)}class iu{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expectected at least one argument.");let m=null;const v=h.expectedType;v&&v.kind!=="value"&&(m=v);const E=[];for(const F of l.slice(1)){const U=h.parse(F,1+E.length,m,void 0,{typeAnnotation:"omit"});if(!U)return null;m=m||U.type,E.push(U)}if(!m)throw new Error("No output type");const T=v&&E.some(F=>Bt(v,F.type));return new iu(T?ke:m,E)}evaluate(l){let h,m=null,v=0;for(const E of this.args)if(v++,m=E.evaluate(l),m&&m instanceof Wr&&!m.available&&(h||(h=m.name),m=null,v===this.args.length&&(m=h)),m!==null)break;return m}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}function Ho(u,l){return u==="=="||u==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function nA(u,l,h,m){return m.compare(l,h)===0}function Aa(u,l,h){const m=u!=="=="&&u!=="!=";return class Gk{constructor(E,T,F){this.type=Ne,this.lhs=E,this.rhs=T,this.collator=F,this.hasUntypedArgument=E.type.kind==="value"||T.type.kind==="value"}static parse(E,T){if(E.length!==3&&E.length!==4)return T.error("Expected two or three arguments.");const F=E[0];let U=T.parse(E[1],1,ke);if(!U)return null;if(!Ho(F,U.type))return T.concat(1).error(`"${F}" comparisons are not supported for type '${X(U.type)}'.`);let Q=T.parse(E[2],2,ke);if(!Q)return null;if(!Ho(F,Q.type))return T.concat(2).error(`"${F}" comparisons are not supported for type '${X(Q.type)}'.`);if(U.type.kind!==Q.type.kind&&U.type.kind!=="value"&&Q.type.kind!=="value")return T.error(`Cannot compare types '${X(U.type)}' and '${X(Q.type)}'.`);m&&(U.type.kind==="value"&&Q.type.kind!=="value"?U=new Ti(Q.type,[U]):U.type.kind!=="value"&&Q.type.kind==="value"&&(Q=new Ti(U.type,[Q])));let G=null;if(E.length===4){if(U.type.kind!=="string"&&Q.type.kind!=="string"&&U.type.kind!=="value"&&Q.type.kind!=="value")return T.error("Cannot use collator to compare non-string types.");if(G=T.parse(E[3],3,Qn),!G)return null}return new Gk(U,Q,G)}evaluate(E){const T=this.lhs.evaluate(E),F=this.rhs.evaluate(E);if(m&&this.hasUntypedArgument){const U=zn(T),Q=zn(F);if(U.kind!==Q.kind||U.kind!=="string"&&U.kind!=="number")throw new Nn(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${U.kind}, ${Q.kind}) instead.`)}if(this.collator&&!m&&this.hasUntypedArgument){const U=zn(T),Q=zn(F);if(U.kind!=="string"||Q.kind!=="string")return l(E,T,F)}return this.collator?h(E,T,F,this.collator.evaluate(E)):l(E,T,F)}eachChild(E){E(this.lhs),E(this.rhs),this.collator&&E(this.collator)}outputDefined(){return!0}}}const vc=Aa("==",function(u,l,h){return l===h},nA),iA=Aa("!=",function(u,l,h){return l!==h},function(u,l,h,m){return!nA(0,l,h,m)}),Ed=Aa("<",function(u,l,h){return l<h},function(u,l,h,m){return m.compare(l,h)<0}),ch=Aa(">",function(u,l,h){return l>h},function(u,l,h,m){return m.compare(l,h)>0}),uh=Aa("<=",function(u,l,h){return l<=h},function(u,l,h,m){return m.compare(l,h)<=0}),sA=Aa(">=",function(u,l,h){return l>=h},function(u,l,h,m){return m.compare(l,h)>=0});class ha{constructor(l,h,m){this.type=Qn,this.locale=m,this.caseSensitive=l,this.diacriticSensitive=h}static parse(l,h){if(l.length!==2)return h.error("Expected one argument.");const m=l[1];if(typeof m!="object"||Array.isArray(m))return h.error("Collator options argument must be an object.");const v=h.parse(m["case-sensitive"]!==void 0&&m["case-sensitive"],1,Ne);if(!v)return null;const E=h.parse(m["diacritic-sensitive"]!==void 0&&m["diacritic-sensitive"],1,Ne);if(!E)return null;let T=null;return m.locale&&(T=h.parse(m.locale,1,gr),!T)?null:new ha(v,E,T)}evaluate(l){return new Pr(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)}eachChild(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)}outputDefined(){return!1}}class da{constructor(l,h,m,v,E){this.type=gr,this.number=l,this.locale=h,this.currency=m,this.minFractionDigits=v,this.maxFractionDigits=E}static parse(l,h){if(l.length!==3)return h.error("Expected two arguments.");const m=h.parse(l[1],1,me);if(!m)return null;const v=l[2];if(typeof v!="object"||Array.isArray(v))return h.error("NumberFormat options argument must be an object.");let E=null;if(v.locale&&(E=h.parse(v.locale,1,gr),!E))return null;let T=null;if(v.currency&&(T=h.parse(v.currency,1,gr),!T))return null;let F=null;if(v["min-fraction-digits"]&&(F=h.parse(v["min-fraction-digits"],1,me),!F))return null;let U=null;return v["max-fraction-digits"]&&(U=h.parse(v["max-fraction-digits"],1,me),!U)?null:new da(m,E,T,F,U)}evaluate(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))}eachChild(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)}outputDefined(){return!1}}class su{constructor(l){this.type=nn,this.sections=l}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");const m=l[1];if(!Array.isArray(m)&&typeof m=="object")return h.error("First argument must be an image or text section.");const v=[];let E=!1;for(let T=1;T<=l.length-1;++T){const F=l[T];if(E&&typeof F=="object"&&!Array.isArray(F)){E=!1;let U=null;if(F["font-scale"]&&(U=h.parse(F["font-scale"],1,me),!U))return null;let Q=null;if(F["text-font"]&&(Q=h.parse(F["text-font"],1,W(gr)),!Q))return null;let G=null;if(F["text-color"]&&(G=h.parse(F["text-color"],1,Ur),!G))return null;const q=v[v.length-1];q.scale=U,q.font=Q,q.textColor=G}else{const U=h.parse(l[T],1,ke);if(!U)return null;const Q=U.type.kind;if(Q!=="string"&&Q!=="value"&&Q!=="null"&&Q!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");E=!0,v.push({content:U,scale:null,font:null,textColor:null})}}return new su(v)}evaluate(l){return new qr(this.sections.map(h=>{const m=h.content.evaluate(l);return zn(m)===ln?new Mn("",m,null,null,null):new Mn(Jr(m),null,h.scale?h.scale.evaluate(l):null,h.font?h.font.evaluate(l).join(","):null,h.textColor?h.textColor.evaluate(l):null)}))}eachChild(l){for(const h of this.sections)l(h.content),h.scale&&l(h.scale),h.font&&l(h.font),h.textColor&&l(h.textColor)}outputDefined(){return!1}}class Qa{constructor(l){this.type=ln,this.input=l}static parse(l,h){if(l.length!==2)return h.error("Expected two arguments.");const m=h.parse(l[1],1,gr);return m?new Qa(m):h.error("No image name provided.")}evaluate(l){const h=this.input.evaluate(l),m=Wr.fromString(h);return m&&l.availableImages&&(m.available=l.availableImages.indexOf(h)>-1),m}eachChild(l){l(this.input)}outputDefined(){return!1}}class bc{constructor(l){this.type=me,this.input=l}static parse(l,h){if(l.length!==2)return h.error(`Expected 1 argument, but found ${l.length-1} instead.`);const m=h.parse(l[1],1);return m?m.type.kind!=="array"&&m.type.kind!=="string"&&m.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${X(m.type)} instead.`):new bc(m):null}evaluate(l){const h=this.input.evaluate(l);if(typeof h=="string"||Array.isArray(h))return h.length;throw new Nn(`Expected value to be of type string or array, but found ${X(zn(h))} instead.`)}eachChild(l){l(this.input)}outputDefined(){return!1}}const ws=8192;function ou(u,l){const h=(180+u[0])/360,m=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,v=Math.pow(2,l.z);return[Math.round(h*v*ws),Math.round(m*v*ws)]}function za(u,l){const h=Math.pow(2,l.z);return[(v=(u[0]/ws+l.x)/h,360*v-180),(m=(u[1]/ws+l.y)/h,360/Math.PI*Math.atan(Math.exp((180-360*m)*Math.PI/180))-90)];var m,v}function on(u,l){u[0]=Math.min(u[0],l[0]),u[1]=Math.min(u[1],l[1]),u[2]=Math.max(u[2],l[0]),u[3]=Math.max(u[3],l[1])}function vl(u,l){return!(u[0]<=l[0]||u[2]>=l[2]||u[1]<=l[1]||u[3]>=l[3])}function Ha(u,l,h){const m=u[0]-l[0],v=u[1]-l[1],E=u[0]-h[0],T=u[1]-h[1];return m*T-E*v==0&&m*E<=0&&v*T<=0}function Vo(u,l,h,m){return(v=[m[0]-h[0],m[1]-h[1]])[0]*(E=[l[0]-u[0],l[1]-u[1]])[1]-v[1]*E[0]!=0&&!(!Ah(u,l,h,m)||!Ah(h,m,u,l));var v,E}function Sd(u,l,h){for(const m of h)for(let v=0;v<m.length-1;++v)if(Vo(u,l,m[v],m[v+1]))return!0;return!1}function Js(u,l){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,m=!1;for(const F of l)for(let U=0;U<F.length-1;U++){if(Ha(u,F[U],F[U+1]))return h;(E=F[U])[1]>(v=u)[1]!=(T=F[U+1])[1]>v[1]&&v[0]<(T[0]-E[0])*(v[1]-E[1])/(T[1]-E[1])+E[0]&&(m=!m)}var v,E,T;return m}function Go(u,l){for(const h of l)if(Js(u,h))return!0;return!1}function au(u,l){for(const h of u)if(!Js(h,l))return!1;for(let h=0;h<u.length-1;++h)if(Sd(u[h],u[h+1],l))return!1;return!0}function wc(u,l){for(const h of l)if(au(u,h))return!0;return!1}function Ah(u,l,h,m){const v=m[0]-h[0],E=m[1]-h[1],T=(u[0]-h[0])*E-v*(u[1]-h[1]),F=(l[0]-h[0])*E-v*(l[1]-h[1]);return T>0&&F<0||T<0&&F>0}function bl(u,l,h){const m=[];for(let v=0;v<u.length;v++){const E=[];for(let T=0;T<u[v].length;T++){const F=ou(u[v][T],h);on(l,F),E.push(F)}m.push(E)}return m}function hh(u,l,h){const m=[];for(let v=0;v<u.length;v++){const E=bl(u[v],l,h);m.push(E)}return m}function lu(u,l,h,m){if(u[0]<h[0]||u[0]>h[2]){const v=.5*m;let E=u[0]-h[0]>v?-m:h[0]-u[0]>v?m:0;E===0&&(E=u[0]-h[2]>v?-m:h[2]-u[0]>v?m:0),u[0]+=E}on(l,u)}function cu(u,l,h,m){const v=Math.pow(2,m.z)*ws,E=[m.x*ws,m.y*ws],T=[];for(const F of u)for(const U of F){const Q=[U.x+E[0],U.y+E[1]];lu(Q,l,h,v),T.push(Q)}return T}function oA(u,l,h,m){const v=Math.pow(2,m.z)*ws,E=[m.x*ws,m.y*ws],T=[];for(const U of u){const Q=[];for(const G of U){const q=[G.x+E[0],G.y+E[1]];on(l,q),Q.push(q)}T.push(Q)}if(l[2]-l[0]<=v/2){(F=l)[0]=F[1]=1/0,F[2]=F[3]=-1/0;for(const U of T)for(const Q of U)lu(Q,l,h,v)}var F;return T}class yo{constructor(l,h){this.type=Ne,this.geojson=l,this.geometries=h}static parse(l,h){if(l.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Xs(l[1])){const m=l[1];if(m.type==="FeatureCollection"){const v=[];for(const E of m.features){const{type:T,coordinates:F}=E.geometry;T==="Polygon"&&v.push(F),T==="MultiPolygon"&&v.push(...F)}if(v.length)return new yo(m,{type:"MultiPolygon",coordinates:v})}else if(m.type==="Feature"){const v=m.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new yo(m,m.geometry)}else if(m.type==="Polygon"||m.type==="MultiPolygon")return new yo(m,m)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return function(h,m){const v=[1/0,1/0,-1/0,-1/0],E=[1/0,1/0,-1/0,-1/0],T=h.canonicalID();if(m.type==="Polygon"){const F=bl(m.coordinates,E,T),U=cu(h.geometry(),v,E,T);if(!vl(v,E))return!1;for(const Q of U)if(!Js(Q,F))return!1}if(m.type==="MultiPolygon"){const F=hh(m.coordinates,E,T),U=cu(h.geometry(),v,E,T);if(!vl(v,E))return!1;for(const Q of U)if(!Go(Q,F))return!1}return!0}(l,this.geometries);if(l.geometryType()==="LineString")return function(h,m){const v=[1/0,1/0,-1/0,-1/0],E=[1/0,1/0,-1/0,-1/0],T=h.canonicalID();if(m.type==="Polygon"){const F=bl(m.coordinates,E,T),U=oA(h.geometry(),v,E,T);if(!vl(v,E))return!1;for(const Q of U)if(!au(Q,F))return!1}if(m.type==="MultiPolygon"){const F=hh(m.coordinates,E,T),U=oA(h.geometry(),v,E,T);if(!vl(v,E))return!1;for(const Q of U)if(!wc(Q,F))return!1}return!0}(l,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let uu=class{constructor(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:aA;if(this.data=u,this.length=this.data.length,this.compare=l,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(u){this.data.push(u),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const u=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:l,compare:h}=this,m=l[u];for(;u>0;){const v=u-1>>1,E=l[v];if(h(m,E)>=0)break;l[u]=E,u=v}l[u]=m}_down(u){const{data:l,compare:h}=this,m=this.length>>1,v=l[u];for(;u<m;){let E=1+(u<<1),T=l[E];const F=E+1;if(F<this.length&&h(l[F],T)<0&&(E=F,T=l[F]),h(T,v)>=0)break;l[u]=T,u=E}l[u]=v}};function aA(u,l){return u<l?-1:u>l?1:0}function dh(u,l,h,m,v){fh(u,l,h,m||u.length-1,v||xc)}function fh(u,l,h,m,v){for(;m>h;){if(m-h>600){var E=m-h+1,T=l-h+1,F=Math.log(E),U=.5*Math.exp(2*F/3),Q=.5*Math.sqrt(F*U*(E-U)/E)*(T-E/2<0?-1:1);fh(u,l,Math.max(h,Math.floor(l-T*U/E+Q)),Math.min(m,Math.floor(l+(E-T)*U/E+Q)),v)}var G=u[l],q=h,J=m;for(fa(u,h,l),v(u[m],G)>0&&fa(u,h,m);q<J;){for(fa(u,q,J),q++,J--;v(u[q],G)<0;)q++;for(;v(u[J],G)>0;)J--}v(u[h],G)===0?fa(u,h,J):fa(u,++J,m),J<=l&&(h=J+1),l<=J&&(m=J-1)}}function fa(u,l,h){var m=u[l];u[l]=u[h],u[h]=m}function xc(u,l){return u<l?-1:u>l?1:0}function wl(u,l){if(u.length<=1)return[u];const h=[];let m,v;for(const E of u){const T=lA(E);T!==0&&(E.area=Math.abs(T),v===void 0&&(v=T<0),v===T<0?(m&&h.push(m),m=[E]):m.push(E))}if(m&&h.push(m),l>1)for(let E=0;E<h.length;E++)h[E].length<=l||(dh(h[E],l,1,h[E].length-1,xl),h[E]=h[E].slice(0,l));return h}function xl(u,l){return l.area-u.area}function lA(u){let l=0;for(let h,m,v=0,E=u.length,T=E-1;v<E;T=v++)h=u[v],m=u[T],l+=(m.x-h.x)*(h.y+m.y);return l}const D=1/298.257223563,nt=D*(2-D),Lt=Math.PI/180;class Ht{constructor(l){const h=6378.137*Lt*1e3,m=Math.cos(l*Lt),v=1/(1-nt*(1-m*m)),E=Math.sqrt(v);this.kx=h*E*m,this.ky=h*E*v*(1-nt)}distance(l,h){const m=this.wrap(l[0]-h[0])*this.kx,v=(l[1]-h[1])*this.ky;return Math.sqrt(m*m+v*v)}pointOnLine(l,h){let m,v,E,T,F=1/0;for(let U=0;U<l.length-1;U++){let Q=l[U][0],G=l[U][1],q=this.wrap(l[U+1][0]-Q)*this.kx,J=(l[U+1][1]-G)*this.ky,rt=0;q===0&&J===0||(rt=(this.wrap(h[0]-Q)*this.kx*q+(h[1]-G)*this.ky*J)/(q*q+J*J),rt>1?(Q=l[U+1][0],G=l[U+1][1]):rt>0&&(Q+=q/this.kx*rt,G+=J/this.ky*rt)),q=this.wrap(h[0]-Q)*this.kx,J=(h[1]-G)*this.ky;const ut=q*q+J*J;ut<F&&(F=ut,m=Q,v=G,E=U,T=rt)}return{point:[m,v],index:E,t:Math.max(0,Math.min(1,T))}}wrap(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}}function ne(u,l){return l[0]-u[0]}function ge(u){return u[1]-u[0]+1}function Fe(u,l){return u[1]>=u[0]&&u[1]<l}function tr(u,l){if(u[0]>u[1])return[null,null];const h=ge(u);if(l){if(h===2)return[u,null];const v=Math.floor(h/2);return[[u[0],u[0]+v],[u[0]+v,u[1]]]}if(h===1)return[u,null];const m=Math.floor(h/2)-1;return[[u[0],u[0]+m],[u[0]+m+1,u[1]]]}function Fr(u,l){if(!Fe(l,u.length))return[1/0,1/0,-1/0,-1/0];const h=[1/0,1/0,-1/0,-1/0];for(let m=l[0];m<=l[1];++m)on(h,u[m]);return h}function Kr(u){const l=[1/0,1/0,-1/0,-1/0];for(const h of u)for(const m of h)on(l,m);return l}function Yr(u){return u[0]!==-1/0&&u[1]!==-1/0&&u[2]!==1/0&&u[3]!==1/0}function hn(u,l,h){if(!Yr(u)||!Yr(l))return NaN;let m=0,v=0;return u[2]<l[0]&&(m=l[0]-u[2]),u[0]>l[2]&&(m=u[0]-l[2]),u[1]>l[3]&&(v=u[1]-l[3]),u[3]<l[1]&&(v=l[1]-u[3]),h.distance([0,0],[m,v])}function kr(u,l,h){const m=h.pointOnLine(l,u);return h.distance(u,m.point)}function di(u,l,h,m,v){const E=Math.min(kr(u,[h,m],v),kr(l,[h,m],v)),T=Math.min(kr(h,[u,l],v),kr(m,[u,l],v));return Math.min(E,T)}function Cr(u,l,h,m,v){if(!Fe(l,u.length)||!Fe(m,h.length))return 1/0;let E=1/0;for(let T=l[0];T<l[1];++T){const F=u[T],U=u[T+1];for(let Q=m[0];Q<m[1];++Q){const G=h[Q],q=h[Q+1];if(Vo(F,U,G,q))return 0;E=Math.min(E,di(F,U,G,q,v))}}return E}function Hi(u,l,h,m,v){if(!Fe(l,u.length)||!Fe(m,h.length))return NaN;let E=1/0;for(let T=l[0];T<=l[1];++T)for(let F=m[0];F<=m[1];++F)if(E=Math.min(E,v.distance(u[T],h[F])),E===0)return E;return E}function Xr(u,l,h){if(Js(u,l,!0))return 0;let m=1/0;for(const v of l){const E=v[0],T=v[v.length-1];if(E!==T&&(m=Math.min(m,kr(u,[T,E],h)),m===0))return m;const F=h.pointOnLine(v,u);if(m=Math.min(m,h.distance(u,F.point)),m===0)return m}return m}function dn(u,l,h,m){if(!Fe(l,u.length))return NaN;for(let E=l[0];E<=l[1];++E)if(Js(u[E],h,!0))return 0;let v=1/0;for(let E=l[0];E<l[1];++E){const T=u[E],F=u[E+1];for(const U of h)for(let Q=0,G=U.length,q=G-1;Q<G;q=Q++){const J=U[q],rt=U[Q];if(Vo(T,F,J,rt))return 0;v=Math.min(v,di(T,F,J,rt,m))}}return v}function hs(u,l){for(const h of u)for(const m of h)if(Js(m,l,!0))return!0;return!1}function pa(u,l,h){let m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1/0;const v=Kr(u),E=Kr(l);if(m!==1/0&&hn(v,E,h)>=m)return m;if(vl(v,E)){if(hs(u,l))return 0}else if(hs(l,u))return 0;let T=1/0;for(const F of u)for(let U=0,Q=F.length,G=Q-1;U<Q;G=U++){const q=F[G],J=F[U];for(const rt of l)for(let ut=0,_t=rt.length,St=_t-1;ut<_t;St=ut++){const Rt=rt[St],Xt=rt[ut];if(Vo(q,J,Rt,Xt))return 0;T=Math.min(T,di(q,J,Rt,Xt,h))}}return T}function Au(u,l,h,m,v,E){if(!E)return;const T=hn(Fr(m,E),v,h);T<l&&u.push([T,E,[0,0]])}function Bl(u,l,h,m,v,E,T){if(!E||!T)return;const F=hn(Fr(m,E),Fr(v,T),h);F<l&&u.push([F,E,T])}function Cl(u,l,h,m){let v=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1/0,E=Math.min(m.distance(u[0],h[0][0]),v);if(E===0)return E;const T=new uu([[0,[0,u.length-1],[0,0]]],ne),F=Kr(h);for(;T.length>0;){const U=T.pop();if(U[0]>=E)continue;const Q=U[1],G=l?50:100;if(ge(Q)<=G){if(!Fe(Q,u.length))return NaN;if(l){const q=dn(u,Q,h,m);if(isNaN(q)||q===0)return q;E=Math.min(E,q)}else for(let q=Q[0];q<=Q[1];++q){const J=Xr(u[q],h,m);if(E=Math.min(E,J),E===0)return 0}}else{const q=tr(Q,l);Au(T,E,m,u,F,q[0]),Au(T,E,m,u,F,q[1])}}return E}function Va(u,l,h,m,v){let E=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1/0,T=Math.min(E,v.distance(u[0],h[0]));if(T===0)return T;const F=new uu([[0,[0,u.length-1],[0,h.length-1]]],ne);for(;F.length>0;){const U=F.pop();if(U[0]>=T)continue;const Q=U[1],G=U[2],q=l?50:100,J=m?50:100;if(ge(Q)<=q&&ge(G)<=J){if(!Fe(Q,u.length)&&Fe(G,h.length))return NaN;let rt;if(l&&m)rt=Cr(u,Q,h,G,v),T=Math.min(T,rt);else if(l&&!m){const ut=u.slice(Q[0],Q[1]+1);for(let _t=G[0];_t<=G[1];++_t)if(rt=kr(h[_t],ut,v),T=Math.min(T,rt),T===0)return T}else if(!l&&m){const ut=h.slice(G[0],G[1]+1);for(let _t=Q[0];_t<=Q[1];++_t)if(rt=kr(u[_t],ut,v),T=Math.min(T,rt),T===0)return T}else rt=Hi(u,Q,h,G,v),T=Math.min(T,rt)}else{const rt=tr(Q,l),ut=tr(G,m);Bl(F,T,v,u,h,rt[0],ut[0]),Bl(F,T,v,u,h,rt[0],ut[1]),Bl(F,T,v,u,h,rt[1],ut[0]),Bl(F,T,v,u,h,rt[1],ut[1])}}return T}function Bc(u){return u.type==="MultiPolygon"?u.coordinates.map(l=>({type:"Polygon",coordinates:l})):u.type==="MultiLineString"?u.coordinates.map(l=>({type:"LineString",coordinates:l})):u.type==="MultiPoint"?u.coordinates.map(l=>({type:"Point",coordinates:l})):[u]}class _o{constructor(l,h){this.type=me,this.geojson=l,this.geometries=h}static parse(l,h){if(l.length!==2)return h.error(`'distance' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Xs(l[1])){const m=l[1];if(m.type==="FeatureCollection")return new _o(m,m.features.map(v=>Bc(v.geometry)).flat());if(m.type==="Feature")return new _o(m,Bc(m.geometry));if("type"in m&&"coordinates"in m)return new _o(m,Bc(m))}return h.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return function(h,m){const v=h.geometry(),E=v.flat().map(U=>za([U.x,U.y],h.canonical));if(v.length===0)return NaN;const T=new Ht(E[0][1]);let F=1/0;for(const U of m){switch(U.type){case"Point":F=Math.min(F,Va(E,!1,[U.coordinates],!1,T,F));break;case"LineString":F=Math.min(F,Va(E,!1,U.coordinates,!0,T,F));break;case"Polygon":F=Math.min(F,Cl(E,!1,U.coordinates,T,F))}if(F===0)return F}return F}(l,this.geometries);if(l.geometryType()==="LineString")return function(h,m){const v=h.geometry(),E=v.flat().map(U=>za([U.x,U.y],h.canonical));if(v.length===0)return NaN;const T=new Ht(E[0][1]);let F=1/0;for(const U of m){switch(U.type){case"Point":F=Math.min(F,Va(E,!0,[U.coordinates],!1,T,F));break;case"LineString":F=Math.min(F,Va(E,!0,U.coordinates,!0,T,F));break;case"Polygon":F=Math.min(F,Cl(E,!0,U.coordinates,T,F))}if(F===0)return F}return F}(l,this.geometries);if(l.geometryType()==="Polygon")return function(h,m){const v=h.geometry();if(v.length===0||v[0].length===0)return NaN;const E=wl(v,0).map(U=>U.map(Q=>Q.map(G=>za([G.x,G.y],h.canonical)))),T=new Ht(E[0][0][0][1]);let F=1/0;for(const U of m)for(const Q of E){switch(U.type){case"Point":F=Math.min(F,Cl([U.coordinates],!1,Q,T,F));break;case"LineString":F=Math.min(F,Cl(U.coordinates,!0,Q,T,F));break;case"Polygon":F=Math.min(F,pa(Q,U.coordinates,T,F))}if(F===0)return F}return F}(l,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const vo={"==":vc,"!=":iA,">":ch,"<":Ed,">=":sA,"<=":uh,array:Ti,at:_l,boolean:Ti,case:Nt,coalesce:iu,collator:ha,format:su,image:Qa,in:ka,"index-of":ht,interpolate:Ir,"interpolate-hcl":Ir,"interpolate-lab":Ir,length:bc,let:tn,literal:vs,match:bt,number:Ti,"number-format":da,object:Ti,slice:le,step:Ze,string:Ti,"to-boolean":hi,"to-color":hi,"to-number":hi,"to-string":hi,var:Na,within:yo,distance:_o};class Wn{constructor(l,h,m,v){this.name=l,this.type=h,this._evaluate=m,this.args=v}evaluate(l){return this._evaluate(l,this.args)}eachChild(l){this.args.forEach(l)}outputDefined(){return!1}static parse(l,h){const m=l[0],v=Wn.definitions[m];if(!v)return h.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0);const E=Array.isArray(v)?v[0]:v.type,T=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,F=T.filter(Q=>{let[G]=Q;return!Array.isArray(G)||G.length===l.length-1});let U=null;for(const[Q,G]of F){U=new bs(h.registry,es,h.path,null,h.scope);const q=[];let J=!1;for(let rt=1;rt<l.length;rt++){const ut=l[rt],_t=Array.isArray(Q)?Q[rt-1]:Q.type,St=U.parse(ut,1+q.length,_t);if(!St){J=!0;break}q.push(St)}if(!J)if(Array.isArray(Q)&&Q.length!==q.length)U.error(`Expected ${Q.length} arguments, but found ${q.length} instead.`);else{for(let rt=0;rt<q.length;rt++){const ut=Array.isArray(Q)?Q[rt]:Q.type,_t=q[rt];U.concat(rt+1).checkSubtype(ut,_t.type)}if(U.errors.length===0)return new Wn(m,E,G,q)}}if(F.length===1)h.errors.push(...U.errors);else{const Q=(F.length?F:T).map(q=>{let[J]=q;return rt=J,Array.isArray(rt)?`(${rt.map(X).join(", ")})`:`(${X(rt.type)}...)`;var rt}).join(" | "),G=[];for(let q=1;q<l.length;q++){const J=h.parse(l[q],1+G.length);if(!J)return null;G.push(X(J.type))}h.error(`Expected arguments of type ${Q}, but found (${G.join(", ")}) instead.`)}return null}static register(l,h){Wn.definitions=h;for(const m in h)l[m]=Wn}}function El(u,l){let[h,m,v,E]=l;h=h.evaluate(u),m=m.evaluate(u),v=v.evaluate(u);const T=E?E.evaluate(u):1,F=Da(h,m,v,T);if(F)throw new Nn(F);return new or(h/255,m/255,v/255,T,!1)}function Ga(u,l){return u in l}function Sl(u,l){const h=l[u];return h===void 0?null:h}function jo(u){return{type:u}}function es(u){if(u instanceof Na)return es(u.boundExpression);if(u instanceof Wn&&u.name==="error"||u instanceof ha||u instanceof yo||u instanceof _o)return!1;const l=u instanceof hi||u instanceof Ti;let h=!0;return u.eachChild(m=>{h=l?h&&es(m):h&&m instanceof vs}),!!h&&hu(u)&&Cc(u,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function hu(u){if(u instanceof Wn&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof yo||u instanceof _o)return!1;let l=!0;return u.eachChild(h=>{l&&!hu(h)&&(l=!1)}),l}function ja(u){if(u instanceof Wn&&u.name==="feature-state")return!1;let l=!0;return u.eachChild(h=>{l&&!ja(h)&&(l=!1)}),l}function Cc(u,l){if(u instanceof Wn&&l.indexOf(u.name)>=0)return!1;let h=!0;return u.eachChild(m=>{h&&!Cc(m,l)&&(h=!1)}),h}function bo(u){return{result:"success",value:u}}function ga(u){return{result:"error",value:u}}function qa(u){return u["property-type"]==="data-driven"||u["property-type"]==="cross-faded-data-driven"}function cA(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function Ys(u){return!!u.expression&&u.expression.interpolated}function $r(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function xs(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function Ka(u){return u}function qo(u,l){const h=l.type==="color",m=u.stops&&typeof u.stops[0][0]=="object",v=m||!(m||u.property!==void 0),E=u.type||(Ys(l)?"exponential":"interval");if(h||l.type==="padding"){const G=h?or.parse:gn.parse;(u=cr({},u)).stops&&(u.stops=u.stops.map(q=>[q[0],G(q[1])])),u.default=G(u.default?u.default:l.default)}if(u.colorSpace&&(T=u.colorSpace)!=="rgb"&&T!=="hcl"&&T!=="lab")throw new Error(`Unknown color space: "${u.colorSpace}"`);var T;let F,U,Q;if(E==="exponential")F=Tl;else if(E==="interval")F=ks;else if(E==="categorical"){F=$a,U=Object.create(null);for(const G of u.stops)U[G[0]]=G[1];Q=typeof u.stops[0][0]}else{if(E!=="identity")throw new Error(`Unknown function type "${E}"`);F=Ec}if(m){const G={},q=[];for(let ut=0;ut<u.stops.length;ut++){const _t=u.stops[ut],St=_t[0].zoom;G[St]===void 0&&(G[St]={zoom:St,type:u.type,property:u.property,default:u.default,stops:[]},q.push(St)),G[St].stops.push([_t[0].value,_t[1]])}const J=[];for(const ut of q)J.push([G[ut].zoom,qo(G[ut],l)]);const rt={name:"linear"};return{kind:"composite",interpolationType:rt,interpolationFactor:Ir.interpolationFactor.bind(void 0,rt),zoomStops:J.map(ut=>ut[0]),evaluate:(ut,_t)=>{let{zoom:St}=ut;return Tl({stops:J,base:u.base},l,St).evaluate(St,_t)}}}if(v){const G=E==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:G,interpolationFactor:Ir.interpolationFactor.bind(void 0,G),zoomStops:u.stops.map(q=>q[0]),evaluate:q=>{let{zoom:J}=q;return F(u,l,J,U,Q)}}}return{kind:"source",evaluate(G,q){const J=q&&q.properties?q.properties[u.property]:void 0;return J===void 0?Bs(u.default,l.default):F(u,l,J,U,Q)}}}function Bs(u,l,h){return u!==void 0?u:l!==void 0?l:h!==void 0?h:void 0}function $a(u,l,h,m,v){return Bs(typeof h===v?m[h]:void 0,u.default,l.default)}function ks(u,l,h){if($r(h)!=="number")return Bs(u.default,l.default);const m=u.stops.length;if(m===1||h<=u.stops[0][0])return u.stops[0][1];if(h>=u.stops[m-1][0])return u.stops[m-1][1];const v=Ie(u.stops.map(E=>E[0]),h);return u.stops[v][1]}function Tl(u,l,h){const m=u.base!==void 0?u.base:1;if($r(h)!=="number")return Bs(u.default,l.default);const v=u.stops.length;if(v===1||h<=u.stops[0][0])return u.stops[0][1];if(h>=u.stops[v-1][0])return u.stops[v-1][1];const E=Ie(u.stops.map(G=>G[0]),h),T=function(G,q,J,rt){const ut=rt-J,_t=G-J;return ut===0?0:q===1?_t/ut:(Math.pow(q,_t)-1)/(Math.pow(q,ut)-1)}(h,m,u.stops[E][0],u.stops[E+1][0]),F=u.stops[E][1],U=u.stops[E+1][1],Q=As[l.type]||Ka;return typeof F.evaluate=="function"?{evaluate(){for(var G=arguments.length,q=new Array(G),J=0;J<G;J++)q[J]=arguments[J];const rt=F.evaluate.apply(void 0,q),ut=U.evaluate.apply(void 0,q);if(rt!==void 0&&ut!==void 0)return Q(rt,ut,T,u.colorSpace)}}:Q(F,U,T,u.colorSpace)}function Ec(u,l,h){switch(l.type){case"color":h=or.parse(h);break;case"formatted":h=qr.fromString(h.toString());break;case"resolvedImage":h=Wr.fromString(h.toString());break;case"padding":h=gn.parse(h);break;default:$r(h)===l.type||l.type==="enum"&&l.values[h]||(h=void 0)}return Bs(h,u.default,l.default)}Wn.register(vo,{error:[{kind:"error"},[gr],(u,l)=>{let[h]=l;throw new Nn(h.evaluate(u))}],typeof:[gr,[ke],(u,l)=>{let[h]=l;return X(zn(h.evaluate(u)))}],"to-rgba":[W(me,4),[Ur],(u,l)=>{let[h]=l;const[m,v,E,T]=h.evaluate(u).rgb;return[255*m,255*v,255*E,T]}],rgb:[Ur,[me,me,me],El],rgba:[Ur,[me,me,me,me],El],has:{type:Ne,overloads:[[[gr],(u,l)=>{let[h]=l;return Ga(h.evaluate(u),u.properties())}],[[gr,_n],(u,l)=>{let[h,m]=l;return Ga(h.evaluate(u),m.evaluate(u))}]]},get:{type:ke,overloads:[[[gr],(u,l)=>{let[h]=l;return Sl(h.evaluate(u),u.properties())}],[[gr,_n],(u,l)=>{let[h,m]=l;return Sl(h.evaluate(u),m.evaluate(u))}]]},"feature-state":[ke,[gr],(u,l)=>{let[h]=l;return Sl(h.evaluate(u),u.featureState||{})}],properties:[_n,[],u=>u.properties()],"geometry-type":[gr,[],u=>u.geometryType()],id:[ke,[],u=>u.id()],zoom:[me,[],u=>u.globals.zoom],"heatmap-density":[me,[],u=>u.globals.heatmapDensity||0],"line-progress":[me,[],u=>u.globals.lineProgress||0],accumulated:[ke,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[me,jo(me),(u,l)=>{let h=0;for(const m of l)h+=m.evaluate(u);return h}],"*":[me,jo(me),(u,l)=>{let h=1;for(const m of l)h*=m.evaluate(u);return h}],"-":{type:me,overloads:[[[me,me],(u,l)=>{let[h,m]=l;return h.evaluate(u)-m.evaluate(u)}],[[me],(u,l)=>{let[h]=l;return-h.evaluate(u)}]]},"/":[me,[me,me],(u,l)=>{let[h,m]=l;return h.evaluate(u)/m.evaluate(u)}],"%":[me,[me,me],(u,l)=>{let[h,m]=l;return h.evaluate(u)%m.evaluate(u)}],ln2:[me,[],()=>Math.LN2],pi:[me,[],()=>Math.PI],e:[me,[],()=>Math.E],"^":[me,[me,me],(u,l)=>{let[h,m]=l;return Math.pow(h.evaluate(u),m.evaluate(u))}],sqrt:[me,[me],(u,l)=>{let[h]=l;return Math.sqrt(h.evaluate(u))}],log10:[me,[me],(u,l)=>{let[h]=l;return Math.log(h.evaluate(u))/Math.LN10}],ln:[me,[me],(u,l)=>{let[h]=l;return Math.log(h.evaluate(u))}],log2:[me,[me],(u,l)=>{let[h]=l;return Math.log(h.evaluate(u))/Math.LN2}],sin:[me,[me],(u,l)=>{let[h]=l;return Math.sin(h.evaluate(u))}],cos:[me,[me],(u,l)=>{let[h]=l;return Math.cos(h.evaluate(u))}],tan:[me,[me],(u,l)=>{let[h]=l;return Math.tan(h.evaluate(u))}],asin:[me,[me],(u,l)=>{let[h]=l;return Math.asin(h.evaluate(u))}],acos:[me,[me],(u,l)=>{let[h]=l;return Math.acos(h.evaluate(u))}],atan:[me,[me],(u,l)=>{let[h]=l;return Math.atan(h.evaluate(u))}],min:[me,jo(me),(u,l)=>Math.min(...l.map(h=>h.evaluate(u)))],max:[me,jo(me),(u,l)=>Math.max(...l.map(h=>h.evaluate(u)))],abs:[me,[me],(u,l)=>{let[h]=l;return Math.abs(h.evaluate(u))}],round:[me,[me],(u,l)=>{let[h]=l;const m=h.evaluate(u);return m<0?-Math.round(-m):Math.round(m)}],floor:[me,[me],(u,l)=>{let[h]=l;return Math.floor(h.evaluate(u))}],ceil:[me,[me],(u,l)=>{let[h]=l;return Math.ceil(h.evaluate(u))}],"filter-==":[Ne,[gr,ke],(u,l)=>{let[h,m]=l;return u.properties()[h.value]===m.value}],"filter-id-==":[Ne,[ke],(u,l)=>{let[h]=l;return u.id()===h.value}],"filter-type-==":[Ne,[gr],(u,l)=>{let[h]=l;return u.geometryType()===h.value}],"filter-<":[Ne,[gr,ke],(u,l)=>{let[h,m]=l;const v=u.properties()[h.value],E=m.value;return typeof v==typeof E&&v<E}],"filter-id-<":[Ne,[ke],(u,l)=>{let[h]=l;const m=u.id(),v=h.value;return typeof m==typeof v&&m<v}],"filter->":[Ne,[gr,ke],(u,l)=>{let[h,m]=l;const v=u.properties()[h.value],E=m.value;return typeof v==typeof E&&v>E}],"filter-id->":[Ne,[ke],(u,l)=>{let[h]=l;const m=u.id(),v=h.value;return typeof m==typeof v&&m>v}],"filter-<=":[Ne,[gr,ke],(u,l)=>{let[h,m]=l;const v=u.properties()[h.value],E=m.value;return typeof v==typeof E&&v<=E}],"filter-id-<=":[Ne,[ke],(u,l)=>{let[h]=l;const m=u.id(),v=h.value;return typeof m==typeof v&&m<=v}],"filter->=":[Ne,[gr,ke],(u,l)=>{let[h,m]=l;const v=u.properties()[h.value],E=m.value;return typeof v==typeof E&&v>=E}],"filter-id->=":[Ne,[ke],(u,l)=>{let[h]=l;const m=u.id(),v=h.value;return typeof m==typeof v&&m>=v}],"filter-has":[Ne,[ke],(u,l)=>{let[h]=l;return h.value in u.properties()}],"filter-has-id":[Ne,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Ne,[W(gr)],(u,l)=>{let[h]=l;return h.value.indexOf(u.geometryType())>=0}],"filter-id-in":[Ne,[W(ke)],(u,l)=>{let[h]=l;return h.value.indexOf(u.id())>=0}],"filter-in-small":[Ne,[gr,W(ke)],(u,l)=>{let[h,m]=l;return m.value.indexOf(u.properties()[h.value])>=0}],"filter-in-large":[Ne,[gr,W(ke)],(u,l)=>{let[h,m]=l;return function(v,E,T,F){for(;T<=F;){const U=T+F>>1;if(E[U]===v)return!0;E[U]>v?F=U-1:T=U+1}return!1}(u.properties()[h.value],m.value,0,m.value.length-1)}],all:{type:Ne,overloads:[[[Ne,Ne],(u,l)=>{let[h,m]=l;return h.evaluate(u)&&m.evaluate(u)}],[jo(Ne),(u,l)=>{for(const h of l)if(!h.evaluate(u))return!1;return!0}]]},any:{type:Ne,overloads:[[[Ne,Ne],(u,l)=>{let[h,m]=l;return h.evaluate(u)||m.evaluate(u)}],[jo(Ne),(u,l)=>{for(const h of l)if(h.evaluate(u))return!0;return!1}]]},"!":[Ne,[Ne],(u,l)=>{let[h]=l;return!h.evaluate(u)}],"is-supported-script":[Ne,[gr],(u,l)=>{let[h]=l;const m=u.globals&&u.globals.isSupportedScript;return!m||m(h.evaluate(u))}],upcase:[gr,[gr],(u,l)=>{let[h]=l;return h.evaluate(u).toUpperCase()}],downcase:[gr,[gr],(u,l)=>{let[h]=l;return h.evaluate(u).toLowerCase()}],concat:[gr,jo(ke),(u,l)=>l.map(h=>Jr(h.evaluate(u))).join("")],"resolved-locale":[gr,[Qn],(u,l)=>{let[h]=l;return h.evaluate(u).resolvedLocale()}]});class Ko{constructor(l,h){var m;this.expression=l,this._warningHistory={},this._evaluator=new Ii,this._defaultValue=h?(m=h).type==="color"&&xs(m.default)?new or(0,0,0,0):m.type==="color"?or.parse(m.default)||null:m.type==="padding"?gn.parse(m.default)||null:m.type==="variableAnchorOffsetCollection"?mn.parse(m.default)||null:m.default===void 0?null:m.default:null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(l,h,m,v,E,T){return this._evaluator.globals=l,this._evaluator.feature=h,this._evaluator.featureState=m,this._evaluator.canonical=v,this._evaluator.availableImages=E||null,this._evaluator.formattedSection=T,this.expression.evaluate(this._evaluator)}evaluate(l,h,m,v,E,T){this._evaluator.globals=l,this._evaluator.feature=h||null,this._evaluator.featureState=m||null,this._evaluator.canonical=v,this._evaluator.availableImages=E||null,this._evaluator.formattedSection=T||null;try{const F=this.expression.evaluate(this._evaluator);if(F==null||typeof F=="number"&&F!=F)return this._defaultValue;if(this._enumValues&&!(F in this._enumValues))throw new Nn(`Expected value to be one of ${Object.keys(this._enumValues).map(U=>JSON.stringify(U)).join(", ")}, but found ${JSON.stringify(F)} instead.`);return F}catch(F){return this._warningHistory[F.message]||(this._warningHistory[F.message]=!0,typeof console<"u"&&console.warn(F.message)),this._defaultValue}}}function Cs(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in vo}function Es(u,l){const h=new bs(vo,es,[],l?function(v){const E={color:Ur,string:gr,number:me,enum:gr,boolean:Ne,formatted:nn,padding:vn,resolvedImage:ln,variableAnchorOffsetCollection:Ct};return v.type==="array"?W(E[v.value]||ke,v.length):E[v.type]}(l):void 0),m=h.parse(u,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?bo(new Ko(m,l)):ga(h.errors)}class Wa{constructor(l,h){this.kind=l,this._styleExpression=h,this.isStateDependent=l!=="constant"&&!ja(h.expression)}evaluateWithoutErrorHandling(l,h,m,v,E,T){return this._styleExpression.evaluateWithoutErrorHandling(l,h,m,v,E,T)}evaluate(l,h,m,v,E,T){return this._styleExpression.evaluate(l,h,m,v,E,T)}}class Il{constructor(l,h,m,v){this.kind=l,this.zoomStops=m,this._styleExpression=h,this.isStateDependent=l!=="camera"&&!ja(h.expression),this.interpolationType=v}evaluateWithoutErrorHandling(l,h,m,v,E,T){return this._styleExpression.evaluateWithoutErrorHandling(l,h,m,v,E,T)}evaluate(l,h,m,v,E,T){return this._styleExpression.evaluate(l,h,m,v,E,T)}interpolationFactor(l,h,m){return this.interpolationType?Ir.interpolationFactor(this.interpolationType,l,h,m):0}}function Fl(u,l){const h=Es(u,l);if(h.result==="error")return h;const m=h.value.expression,v=hu(m);if(!v&&!qa(l))return ga([new _r("","data expressions not supported")]);const E=Cc(m,["zoom"]);if(!E&&!cA(l))return ga([new _r("","zoom expressions not supported")]);const T=Ll(m);return T||E?T instanceof _r?ga([T]):T instanceof Ir&&!Ys(l)?ga([new _r("",'"interpolate" expressions cannot be used with this property')]):bo(T?new Il(v?"camera":"composite",h.value,T.labels,T instanceof Ir?T.interpolation:void 0):new Wa(v?"constant":"source",h.value)):ga([new _r("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class $o{constructor(l,h){this._parameters=l,this._specification=h,cr(this,qo(this._parameters,this._specification))}static deserialize(l){return new $o(l._parameters,l._specification)}static serialize(l){return{_parameters:l._parameters,_specification:l._specification}}}function Ll(u){let l=null;if(u instanceof tn)l=Ll(u.result);else if(u instanceof iu){for(const h of u.args)if(l=Ll(h),l)break}else(u instanceof Ze||u instanceof Ir)&&u.input instanceof Wn&&u.input.name==="zoom"&&(l=u);return l instanceof _r||u.eachChild(h=>{const m=Ll(h);m instanceof _r?l=m:!l&&m?l=new _r("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):l&&m&&l!==m&&(l=new _r("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),l}function rs(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const l of u.slice(1))if(!rs(l)&&typeof l!="boolean")return!1;return!0;default:return!0}}const wo={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function en(u){if(u==null)return{filter:()=>!0,needGeometry:!1};rs(u)||(u=bi(u));const l=Es(u,wo);if(l.result==="error")throw new Error(l.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,m,v)=>l.value.evaluate(h,m,{},v),needGeometry:fi(u)}}function Fn(u,l){return u<l?-1:u>l?1:0}function fi(u){if(!Array.isArray(u))return!1;if(u[0]==="within"||u[0]==="distance")return!0;for(let l=1;l<u.length;l++)if(fi(u[l]))return!0;return!1}function bi(u){if(!u)return!0;const l=u[0];return u.length<=1?l!=="any":l==="=="?Wo(u[1],u[2],"=="):l==="!="?Xa(Wo(u[1],u[2],"==")):l==="<"||l===">"||l==="<="||l===">="?Wo(u[1],u[2],l):l==="any"?(h=u.slice(1),["any"].concat(h.map(bi))):l==="all"?["all"].concat(u.slice(1).map(bi)):l==="none"?["all"].concat(u.slice(1).map(bi).map(Xa)):l==="in"?Zs(u[1],u.slice(2)):l==="!in"?Xa(Zs(u[1],u.slice(2))):l==="has"?Pl(u[1]):l!=="!has"||Xa(Pl(u[1]));var h}function Wo(u,l,h){switch(u){case"$type":return[`filter-type-${h}`,l];case"$id":return[`filter-id-${h}`,l];default:return[`filter-${h}`,u,l]}}function Zs(u,l){if(l.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",l]];case"$id":return["filter-id-in",["literal",l]];default:return l.length>200&&!l.some(h=>typeof h!=typeof l[0])?["filter-in-large",u,["literal",l.sort(Fn)]]:["filter-in-small",u,["literal",l]]}}function Pl(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function Xa(u){return["!",u]}function ph(u){const l=typeof u;if(l==="number"||l==="boolean"||l==="string"||u==null)return JSON.stringify(u);if(Array.isArray(u)){let v="[";for(const E of u)v+=`${ph(E)},`;return`${v}]`}const h=Object.keys(u).sort();let m="{";for(let v=0;v<h.length;v++)m+=`${JSON.stringify(h[v])}:${ph(u[h[v]])},`;return`${m}}`}function gh(u){let l="";for(const h of fr)l+=`/${ph(u[h])}`;return l}function Td(u){const l=u.value;return l?[new pe(u.key,l,"constants have been deprecated as of v8")]:[]}function Hn(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function Ml(u){if(Array.isArray(u))return u.map(Ml);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const l={};for(const h in u)l[h]=Ml(u[h]);return l}return Hn(u)}function Ss(u){const l=u.key,h=u.value,m=u.valueSpec||{},v=u.objectElementValidators||{},E=u.style,T=u.styleSpec,F=u.validateSpec;let U=[];const Q=$r(h);if(Q!=="object")return[new pe(l,h,`object expected, ${Q} found`)];for(const G in h){const q=G.split(".")[0],J=m[q]||m["*"];let rt;if(v[q])rt=v[q];else if(m[q])rt=F;else if(v["*"])rt=v["*"];else{if(!m["*"]){U.push(new pe(l,h[G],`unknown property "${G}"`));continue}rt=F}U=U.concat(rt({key:(l&&`${l}.`)+G,value:h[G],valueSpec:J,style:E,styleSpec:T,object:h,objectKey:G,validateSpec:F},h))}for(const G in m)v[G]||m[G].required&&m[G].default===void 0&&h[G]===void 0&&U.push(new pe(l,h,`missing required property "${G}"`));return U}function du(u){const l=u.value,h=u.valueSpec,m=u.style,v=u.styleSpec,E=u.key,T=u.arrayElementValidator||u.validateSpec;if($r(l)!=="array")return[new pe(E,l,`array expected, ${$r(l)} found`)];if(h.length&&l.length!==h.length)return[new pe(E,l,`array length ${h.length} expected, length ${l.length} found`)];if(h["min-length"]&&l.length<h["min-length"])return[new pe(E,l,`array length at least ${h["min-length"]} expected, length ${l.length} found`)];let F={type:h.value,values:h.values};v.$version<7&&(F.function=h.function),$r(h.value)==="object"&&(F=h.value);let U=[];for(let Q=0;Q<l.length;Q++)U=U.concat(T({array:l,arrayIndex:Q,value:l[Q],valueSpec:F,validateSpec:u.validateSpec,style:m,styleSpec:v,key:`${E}[${Q}]`}));return U}function Ul(u){const l=u.key,h=u.value,m=u.valueSpec;let v=$r(h);return v==="number"&&h!=h&&(v="NaN"),v!=="number"?[new pe(l,h,`number expected, ${v} found`)]:"minimum"in m&&h<m.minimum?[new pe(l,h,`${h} is less than the minimum value ${m.minimum}`)]:"maximum"in m&&h>m.maximum?[new pe(l,h,`${h} is greater than the maximum value ${m.maximum}`)]:[]}function Ts(u){const l=u.valueSpec,h=Hn(u.value.type);let m,v,E,T={};const F=h!=="categorical"&&u.value.property===void 0,U=!F,Q=$r(u.value.stops)==="array"&&$r(u.value.stops[0])==="array"&&$r(u.value.stops[0][0])==="object",G=Ss({key:u.key,value:u.value,valueSpec:u.styleSpec.function,validateSpec:u.validateSpec,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(rt){if(h==="identity")return[new pe(rt.key,rt.value,'identity function may not have a "stops" property')];let ut=[];const _t=rt.value;return ut=ut.concat(du({key:rt.key,value:_t,valueSpec:rt.valueSpec,validateSpec:rt.validateSpec,style:rt.style,styleSpec:rt.styleSpec,arrayElementValidator:q})),$r(_t)==="array"&&_t.length===0&&ut.push(new pe(rt.key,_t,"array must have at least one stop")),ut},default:function(rt){return rt.validateSpec({key:rt.key,value:rt.value,valueSpec:l,validateSpec:rt.validateSpec,style:rt.style,styleSpec:rt.styleSpec})}}});return h==="identity"&&F&&G.push(new pe(u.key,u.value,'missing required property "property"')),h==="identity"||u.value.stops||G.push(new pe(u.key,u.value,'missing required property "stops"')),h==="exponential"&&u.valueSpec.expression&&!Ys(u.valueSpec)&&G.push(new pe(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(U&&!qa(u.valueSpec)?G.push(new pe(u.key,u.value,"property functions not supported")):F&&!cA(u.valueSpec)&&G.push(new pe(u.key,u.value,"zoom functions not supported"))),h!=="categorical"&&!Q||u.value.property!==void 0||G.push(new pe(u.key,u.value,'"property" property is required')),G;function q(rt){let ut=[];const _t=rt.value,St=rt.key;if($r(_t)!=="array")return[new pe(St,_t,`array expected, ${$r(_t)} found`)];if(_t.length!==2)return[new pe(St,_t,`array length 2 expected, length ${_t.length} found`)];if(Q){if($r(_t[0])!=="object")return[new pe(St,_t,`object expected, ${$r(_t[0])} found`)];if(_t[0].zoom===void 0)return[new pe(St,_t,"object stop key must have zoom")];if(_t[0].value===void 0)return[new pe(St,_t,"object stop key must have value")];if(E&&E>Hn(_t[0].zoom))return[new pe(St,_t[0].zoom,"stop zoom values must appear in ascending order")];Hn(_t[0].zoom)!==E&&(E=Hn(_t[0].zoom),v=void 0,T={}),ut=ut.concat(Ss({key:`${St}[0]`,value:_t[0],valueSpec:{zoom:{}},validateSpec:rt.validateSpec,style:rt.style,styleSpec:rt.styleSpec,objectElementValidators:{zoom:Ul,value:J}}))}else ut=ut.concat(J({key:`${St}[0]`,value:_t[0],valueSpec:{},validateSpec:rt.validateSpec,style:rt.style,styleSpec:rt.styleSpec},_t));return Cs(Ml(_t[1]))?ut.concat([new pe(`${St}[1]`,_t[1],"expressions are not allowed in function stops.")]):ut.concat(rt.validateSpec({key:`${St}[1]`,value:_t[1],valueSpec:l,validateSpec:rt.validateSpec,style:rt.style,styleSpec:rt.styleSpec}))}function J(rt,ut){const _t=$r(rt.value),St=Hn(rt.value),Rt=rt.value!==null?rt.value:ut;if(m){if(_t!==m)return[new pe(rt.key,Rt,`${_t} stop domain type must match previous stop domain type ${m}`)]}else m=_t;if(_t!=="number"&&_t!=="string"&&_t!=="boolean")return[new pe(rt.key,Rt,"stop domain value must be a number, string, or boolean")];if(_t!=="number"&&h!=="categorical"){let Xt=`number expected, ${_t} found`;return qa(l)&&h===void 0&&(Xt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new pe(rt.key,Rt,Xt)]}return h!=="categorical"||_t!=="number"||isFinite(St)&&Math.floor(St)===St?h!=="categorical"&&_t==="number"&&v!==void 0&&St<v?[new pe(rt.key,Rt,"stop domain values must appear in ascending order")]:(v=St,h==="categorical"&&St in T?[new pe(rt.key,Rt,"stop domain values must be unique")]:(T[St]=!0,[])):[new pe(rt.key,Rt,`integer expected, found ${St}`)]}}function Vi(u){const l=(u.expressionContext==="property"?Fl:Es)(Ml(u.value),u.valueSpec);if(l.result==="error")return l.value.map(m=>new pe(`${u.key}${m.key}`,u.value,m.message));const h=l.value.expression||l.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!h.outputDefined())return[new pe(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!ja(h))return[new pe(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter"&&!ja(h))return[new pe(u.key,u.value,'"feature-state" data expressions are not supported with filters.')];if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!Cc(h,["zoom","feature-state"]))return[new pe(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!hu(h))return[new pe(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Rl(u){const l=u.key,h=u.value,m=u.valueSpec,v=[];return Array.isArray(m.values)?m.values.indexOf(Hn(h))===-1&&v.push(new pe(l,h,`expected one of [${m.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(m.values).indexOf(Hn(h))===-1&&v.push(new pe(l,h,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(h)} found`)),v}function Ol(u){return rs(Ml(u.value))?Vi(cr({},u,{expressionContext:"filter",valueSpec:{value:"boolean"}})):fu(u)}function fu(u){const l=u.value,h=u.key;if($r(l)!=="array")return[new pe(h,l,`array expected, ${$r(l)} found`)];const m=u.styleSpec;let v,E=[];if(l.length<1)return[new pe(h,l,"filter array must have at least 1 element")];switch(E=E.concat(Rl({key:`${h}[0]`,value:l[0],valueSpec:m.filter_operator,style:u.style,styleSpec:u.styleSpec})),Hn(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Hn(l[1])==="$type"&&E.push(new pe(h,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&E.push(new pe(h,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(v=$r(l[1]),v!=="string"&&E.push(new pe(`${h}[1]`,l[1],`string expected, ${v} found`)));for(let T=2;T<l.length;T++)v=$r(l[T]),Hn(l[1])==="$type"?E=E.concat(Rl({key:`${h}[${T}]`,value:l[T],valueSpec:m.geometry_type,style:u.style,styleSpec:u.styleSpec})):v!=="string"&&v!=="number"&&v!=="boolean"&&E.push(new pe(`${h}[${T}]`,l[T],`string, number, or boolean expected, ${v} found`));break;case"any":case"all":case"none":for(let T=1;T<l.length;T++)E=E.concat(fu({key:`${h}[${T}]`,value:l[T],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":v=$r(l[1]),l.length!==2?E.push(new pe(h,l,`filter array for "${l[0]}" operator must have 2 elements`)):v!=="string"&&E.push(new pe(`${h}[1]`,l[1],`string expected, ${v} found`))}return E}function pu(u,l){const h=u.key,m=u.validateSpec,v=u.style,E=u.styleSpec,T=u.value,F=u.objectKey,U=E[`${l}_${u.layerType}`];if(!U)return[];const Q=F.match(/^(.*)-transition$/);if(l==="paint"&&Q&&U[Q[1]]&&U[Q[1]].transition)return m({key:h,value:T,valueSpec:E.transition,style:v,styleSpec:E});const G=u.valueSpec||U[F];if(!G)return[new pe(h,T,`unknown property "${F}"`)];let q;if($r(T)==="string"&&qa(G)&&!G.tokens&&(q=/^{([^}]+)}$/.exec(T)))return[new pe(h,T,`"${F}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(q[1])} }\`.`)];const J=[];return u.layerType==="symbol"&&(F==="text-field"&&v&&!v.glyphs&&J.push(new pe(h,T,'use of "text-field" requires a style "glyphs" property')),F==="text-font"&&xs(Ml(T))&&Hn(T.type)==="identity"&&J.push(new pe(h,T,'"text-font" does not support identity functions'))),J.concat(m({key:u.key,value:T,valueSpec:G,style:v,styleSpec:E,expressionContext:"property",propertyType:l,propertyKey:F}))}function gu(u){return pu(u,"paint")}function uA(u){return pu(u,"layout")}function mh(u){let l=[];const h=u.value,m=u.key,v=u.style,E=u.styleSpec;h.type||h.ref||l.push(new pe(m,h,'either "type" or "ref" is required'));let T=Hn(h.type);const F=Hn(h.ref);if(h.id){const U=Hn(h.id);for(let Q=0;Q<u.arrayIndex;Q++){const G=v.layers[Q];Hn(G.id)===U&&l.push(new pe(m,h.id,`duplicate layer id "${h.id}", previously used at line ${G.id.__line__}`))}}if("ref"in h){let U;["type","source","source-layer","filter","layout"].forEach(Q=>{Q in h&&l.push(new pe(m,h[Q],`"${Q}" is prohibited for ref layers`))}),v.layers.forEach(Q=>{Hn(Q.id)===F&&(U=Q)}),U?U.ref?l.push(new pe(m,h.ref,"ref cannot reference another ref layer")):T=Hn(U.type):l.push(new pe(m,h.ref,`ref layer "${F}" not found`))}else if(T!=="background")if(h.source){const U=v.sources&&v.sources[h.source],Q=U&&Hn(U.type);U?Q==="vector"&&T==="raster"?l.push(new pe(m,h.source,`layer "${h.id}" requires a raster source`)):Q!=="raster-dem"&&T==="hillshade"?l.push(new pe(m,h.source,`layer "${h.id}" requires a raster-dem source`)):Q==="raster"&&T!=="raster"?l.push(new pe(m,h.source,`layer "${h.id}" requires a vector source`)):Q!=="vector"||h["source-layer"]?Q==="raster-dem"&&T!=="hillshade"?l.push(new pe(m,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):T!=="line"||!h.paint||!h.paint["line-gradient"]||Q==="geojson"&&U.lineMetrics||l.push(new pe(m,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new pe(m,h,`layer "${h.id}" must specify a "source-layer"`)):l.push(new pe(m,h.source,`source "${h.source}" not found`))}else l.push(new pe(m,h,'missing required property "source"'));return l=l.concat(Ss({key:m,value:h,valueSpec:E.layer,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*":()=>[],type:()=>u.validateSpec({key:`${m}.type`,value:h.type,valueSpec:E.layer.type,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,object:h,objectKey:"type"}),filter:Ol,layout:U=>Ss({layer:h,key:U.key,value:U.value,style:U.style,styleSpec:U.styleSpec,validateSpec:U.validateSpec,objectElementValidators:{"*":Q=>uA(cr({layerType:T},Q))}}),paint:U=>Ss({layer:h,key:U.key,value:U.value,style:U.style,styleSpec:U.styleSpec,validateSpec:U.validateSpec,objectElementValidators:{"*":Q=>gu(cr({layerType:T},Q))}})}})),l}function Xo(u){const l=u.value,h=u.key,m=$r(l);return m!=="string"?[new pe(h,l,`string expected, ${m} found`)]:[]}const AA={promoteId:function(u){let{key:l,value:h}=u;if($r(h)==="string")return Xo({key:l,value:h});{const m=[];for(const v in h)m.push(...Xo({key:`${l}.${v}`,value:h[v]}));return m}}};function hA(u){const l=u.value,h=u.key,m=u.styleSpec,v=u.style,E=u.validateSpec;if(!l.type)return[new pe(h,l,'"type" is required')];const T=Hn(l.type);let F;switch(T){case"vector":case"raster":return F=Ss({key:h,value:l,valueSpec:m[`source_${T.replace("-","_")}`],style:u.style,styleSpec:m,objectElementValidators:AA,validateSpec:E}),F;case"raster-dem":return F=function(U){var Q;const G=(Q=U.sourceName)!==null&&Q!==void 0?Q:"",q=U.value,J=U.styleSpec,rt=J.source_raster_dem,ut=U.style;let _t=[];const St=$r(q);if(q===void 0)return _t;if(St!=="object")return _t.push(new pe("source_raster_dem",q,`object expected, ${St} found`)),_t;const Rt=Hn(q.encoding)==="custom",Xt=["redFactor","greenFactor","blueFactor","baseShift"],Qt=U.value.encoding?`"${U.value.encoding}"`:"Default";for(const qt in q)!Rt&&Xt.includes(qt)?_t.push(new pe(qt,q[qt],`In "${G}": "${qt}" is only valid when "encoding" is set to "custom". ${Qt} encoding found`)):rt[qt]?_t=_t.concat(U.validateSpec({key:qt,value:q[qt],valueSpec:rt[qt],validateSpec:U.validateSpec,style:ut,styleSpec:J})):_t.push(new pe(qt,q[qt],`unknown property "${qt}"`));return _t}({sourceName:h,value:l,style:u.style,styleSpec:m,validateSpec:E}),F;case"geojson":if(F=Ss({key:h,value:l,valueSpec:m.source_geojson,style:v,styleSpec:m,validateSpec:E,objectElementValidators:AA}),l.cluster)for(const U in l.clusterProperties){const[Q,G]=l.clusterProperties[U],q=typeof Q=="string"?[Q,["accumulated"],["get",U]]:Q;F.push(...Vi({key:`${h}.${U}.map`,value:G,validateSpec:E,expressionContext:"cluster-map"})),F.push(...Vi({key:`${h}.${U}.reduce`,value:q,validateSpec:E,expressionContext:"cluster-reduce"}))}return F;case"video":return Ss({key:h,value:l,valueSpec:m.source_video,style:v,validateSpec:E,styleSpec:m});case"image":return Ss({key:h,value:l,valueSpec:m.source_image,style:v,validateSpec:E,styleSpec:m});case"canvas":return[new pe(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Rl({key:`${h}.type`,value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:v,validateSpec:E,styleSpec:m})}}function dA(u){const l=u.value,h=u.styleSpec,m=h.light,v=u.style;let E=[];const T=$r(l);if(l===void 0)return E;if(T!=="object")return E=E.concat([new pe("light",l,`object expected, ${T} found`)]),E;for(const F in l){const U=F.match(/^(.*)-transition$/);E=E.concat(U&&m[U[1]]&&m[U[1]].transition?u.validateSpec({key:F,value:l[F],valueSpec:h.transition,validateSpec:u.validateSpec,style:v,styleSpec:h}):m[F]?u.validateSpec({key:F,value:l[F],valueSpec:m[F],validateSpec:u.validateSpec,style:v,styleSpec:h}):[new pe(F,l[F],`unknown property "${F}"`)])}return E}function vp(u){const l=u.value,h=u.styleSpec,m=h.sky,v=u.style,E=$r(l);if(l===void 0)return[];if(E!=="object")return[new pe("sky",l,`object expected, ${E} found`)];let T=[];for(const F in l)T=T.concat(m[F]?u.validateSpec({key:F,value:l[F],valueSpec:m[F],style:v,styleSpec:h}):[new pe(F,l[F],`unknown property "${F}"`)]);return T}function Id(u){const l=u.value,h=u.styleSpec,m=h.terrain,v=u.style;let E=[];const T=$r(l);if(l===void 0)return E;if(T!=="object")return E=E.concat([new pe("terrain",l,`object expected, ${T} found`)]),E;for(const F in l)E=E.concat(m[F]?u.validateSpec({key:F,value:l[F],valueSpec:m[F],validateSpec:u.validateSpec,style:v,styleSpec:h}):[new pe(F,l[F],`unknown property "${F}"`)]);return E}function yh(u){let l=[];const h=u.value,m=u.key;if(Array.isArray(h)){const v=[],E=[];for(const T in h)h[T].id&&v.includes(h[T].id)&&l.push(new pe(m,h,`all the sprites' ids must be unique, but ${h[T].id} is duplicated`)),v.push(h[T].id),h[T].url&&E.includes(h[T].url)&&l.push(new pe(m,h,`all the sprites' URLs must be unique, but ${h[T].url} is duplicated`)),E.push(h[T].url),l=l.concat(Ss({key:`${m}[${T}]`,value:h[T],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:u.validateSpec}));return l}return Xo({key:m,value:h})}const Fd={"*":()=>[],array:du,boolean:function(u){const l=u.value,h=u.key,m=$r(l);return m!=="boolean"?[new pe(h,l,`boolean expected, ${m} found`)]:[]},number:Ul,color:function(u){const l=u.key,h=u.value,m=$r(h);return m!=="string"?[new pe(l,h,`color expected, ${m} found`)]:or.parse(String(h))?[]:[new pe(l,h,`color expected, "${h}" found`)]},constants:Td,enum:Rl,filter:Ol,function:Ts,layer:mh,object:Ss,source:hA,light:dA,sky:vp,terrain:Id,projection:function(u){const l=u.value,h=u.styleSpec,m=h.projection,v=u.style,E=$r(l);if(l===void 0)return[];if(E!=="object")return[new pe("projection",l,`object expected, ${E} found`)];let T=[];for(const F in l)T=T.concat(m[F]?u.validateSpec({key:F,value:l[F],valueSpec:m[F],style:v,styleSpec:h}):[new pe(F,l[F],`unknown property "${F}"`)]);return T},string:Xo,formatted:function(u){return Xo(u).length===0?[]:Vi(u)},resolvedImage:function(u){return Xo(u).length===0?[]:Vi(u)},padding:function(u){const l=u.key,h=u.value;if($r(h)==="array"){if(h.length<1||h.length>4)return[new pe(l,h,`padding requires 1 to 4 values; ${h.length} values found`)];const m={type:"number"};let v=[];for(let E=0;E<h.length;E++)v=v.concat(u.validateSpec({key:`${l}[${E}]`,value:h[E],validateSpec:u.validateSpec,valueSpec:m}));return v}return Ul({key:l,value:h,valueSpec:{}})},variableAnchorOffsetCollection:function(u){const l=u.key,h=u.value,m=$r(h),v=u.styleSpec;if(m!=="array"||h.length<1||h.length%2!=0)return[new pe(l,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let E=[];for(let T=0;T<h.length;T+=2)E=E.concat(Rl({key:`${l}[${T}]`,value:h[T],valueSpec:v.layout_symbol["text-anchor"]})),E=E.concat(du({key:`${l}[${T+1}]`,value:h[T+1],valueSpec:{length:2,value:"number"},validateSpec:u.validateSpec,style:u.style,styleSpec:v}));return E},sprite:yh};function fA(u){const l=u.value,h=u.valueSpec,m=u.styleSpec;return u.validateSpec=fA,h.expression&&xs(Hn(l))?Ts(u):h.expression&&Cs(Ml(l))?Vi(u):h.type&&Fd[h.type]?Fd[h.type](u):Ss(cr({},u,{valueSpec:h.type?m[h.type]:h}))}function bp(u){const l=u.value,h=u.key,m=Xo(u);return m.length||(l.indexOf("{fontstack}")===-1&&m.push(new pe(h,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&m.push(new pe(h,l,'"glyphs" url must include a "{range}" token'))),m}function xo(u){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:st,h=[];return h=h.concat(fA({key:"",value:u,valueSpec:l.$root,styleSpec:l,style:u,validateSpec:fA,objectElementValidators:{glyphs:bp,"*":()=>[]}})),u.constants&&(h=h.concat(Td({key:"constants",value:u.constants,style:u,styleSpec:l,validateSpec:fA}))),pA(h)}function Jo(u){return function(l){return u({...l,validateSpec:fA})}}function pA(u){return[].concat(u).sort((l,h)=>l.line-h.line)}function to(u){return function(){for(var l=arguments.length,h=new Array(l),m=0;m<l;m++)h[m]=arguments[m];return pA(u.apply(this,h))}}xo.source=to(Jo(hA)),xo.sprite=to(Jo(yh)),xo.glyphs=to(Jo(bp)),xo.light=to(Jo(dA)),xo.sky=to(Jo(vp)),xo.terrain=to(Jo(Id)),xo.layer=to(Jo(mh)),xo.filter=to(Jo(Ol)),xo.paintProperty=to(Jo(gu)),xo.layoutProperty=to(Jo(uA));const eo=xo,zm=eo.light,Ld=eo.sky,wp=eo.paintProperty,Hm=eo.layoutProperty;function Pd(u,l){let h=!1;if(l&&l.length)for(const m of l)u.fire(new Je(new Error(m.message))),h=!0;return h}class mu{constructor(l,h,m){const v=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;const T=new Int32Array(this.arrayBuffer);l=T[0],this.d=(h=T[1])+2*(m=T[2]);for(let U=0;U<this.d*this.d;U++){const Q=T[3+U],G=T[3+U+1];v.push(Q===G?null:T.subarray(Q,G))}const F=T[3+v.length+1];this.keys=T.subarray(T[3+v.length],F),this.bboxes=T.subarray(F),this.insert=this._insertReadonly}else{this.d=h+2*m;for(let T=0;T<this.d*this.d;T++)v.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=l,this.padding=m,this.scale=h/l,this.uid=0;const E=m/h*l;this.min=-E,this.max=l+E}insert(l,h,m,v,E){this._forEachCell(h,m,v,E,this._insertCell,this.uid++,void 0,void 0),this.keys.push(l),this.bboxes.push(h),this.bboxes.push(m),this.bboxes.push(v),this.bboxes.push(E)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(l,h,m,v,E,T){this.cells[E].push(T)}query(l,h,m,v,E){const T=this.min,F=this.max;if(l<=T&&h<=T&&F<=m&&F<=v&&!E)return Array.prototype.slice.call(this.keys);{const U=[];return this._forEachCell(l,h,m,v,this._queryCell,U,{},E),U}}_queryCell(l,h,m,v,E,T,F,U){const Q=this.cells[E];if(Q!==null){const G=this.keys,q=this.bboxes;for(let J=0;J<Q.length;J++){const rt=Q[J];if(F[rt]===void 0){const ut=4*rt;(U?U(q[ut+0],q[ut+1],q[ut+2],q[ut+3]):l<=q[ut+2]&&h<=q[ut+3]&&m>=q[ut+0]&&v>=q[ut+1])?(F[rt]=!0,T.push(G[rt])):F[rt]=!1}}}}_forEachCell(l,h,m,v,E,T,F,U){const Q=this._convertToCellCoord(l),G=this._convertToCellCoord(h),q=this._convertToCellCoord(m),J=this._convertToCellCoord(v);for(let rt=Q;rt<=q;rt++)for(let ut=G;ut<=J;ut++){const _t=this.d*ut+rt;if((!U||U(this._convertFromCellCoord(rt),this._convertFromCellCoord(ut),this._convertFromCellCoord(rt+1),this._convertFromCellCoord(ut+1)))&&E.call(this,l,h,m,v,_t,T,F,U))return}}_convertFromCellCoord(l){return(l-this.padding)/this.scale}_convertToCellCoord(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const l=this.cells,h=3+this.cells.length+1+1;let m=0;for(let T=0;T<this.cells.length;T++)m+=this.cells[T].length;const v=new Int32Array(h+m+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;let E=h;for(let T=0;T<l.length;T++){const F=l[T];v[3+T]=E,v.set(F,E),E+=F.length}return v[3+l.length]=E,v.set(this.keys,E),E+=this.keys.length,v[3+l.length+1]=E,v.set(this.bboxes,E),E+=this.bboxes.length,v.buffer}static serialize(l,h){const m=l.toArrayBuffer();return h&&h.push(m),{buffer:m}}static deserialize(l){return new mu(l.buffer)}}const ma={};function je(u,l){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(ma[u])throw new Error(`${u} is already registered.`);Object.defineProperty(l,"_classRegistryKey",{value:u,writeable:!1}),ma[u]={klass:l,omit:h.omit||[],shallow:h.shallow||[]}}je("Object",Object),je("TransferableGridIndex",mu),je("Color",or),je("Error",Error),je("AJAXError",Vt),je("ResolvedImage",Wr),je("StylePropertyFunction",$o),je("StyleExpression",Ko,{omit:["_evaluator"]}),je("ZoomDependentExpression",Il),je("ZoomConstantExpression",Wa),je("CompoundExpression",Wn,{omit:["_evaluate"]});for(const u in vo)vo[u]._classRegistryKey||je(`Expression_${u}`,vo[u]);function Bo(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function Yo(u){return u.$name||u.constructor._classRegistryKey}function xp(u){return!function(l){if(l===null||typeof l!="object")return!1;const h=Yo(l);return!(!h||h==="Object")}(u)&&(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob||u instanceof Error||Bo(u)||Yt(u)||ArrayBuffer.isView(u)||u instanceof ImageData)}function yu(u,l){if(xp(u))return(Bo(u)||Yt(u))&&l&&l.push(u),ArrayBuffer.isView(u)&&l&&l.push(u.buffer),u instanceof ImageData&&l&&l.push(u.data.buffer),u;if(Array.isArray(u)){const E=[];for(const T of u)E.push(yu(T,l));return E}if(typeof u!="object")throw new Error("can't serialize object of type "+typeof u);const h=Yo(u);if(!h)throw new Error(`can't serialize object of unregistered class ${u.constructor.name}`);if(!ma[h])throw new Error(`${h} is not registered.`);const{klass:m}=ma[h],v=m.serialize?m.serialize(u,l):{};if(m.serialize){if(l&&v===l[l.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const E in u){if(!u.hasOwnProperty(E)||ma[h].omit.indexOf(E)>=0)continue;const T=u[E];v[E]=ma[h].shallow.indexOf(E)>=0?T:yu(T,l)}u instanceof Error&&(v.message=u.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(v.$name=h),v}function ns(u){if(xp(u))return u;if(Array.isArray(u))return u.map(ns);if(typeof u!="object")throw new Error("can't deserialize object of type "+typeof u);const l=Yo(u)||"Object";if(!ma[l])throw new Error(`can't deserialize unregistered class ${l}`);const{klass:h}=ma[l];if(!h)throw new Error(`can't deserialize unregistered class ${l}`);if(h.deserialize)return h.deserialize(u);const m=Object.create(h.prototype);for(const v of Object.keys(u)){if(v==="$name")continue;const E=u[v];m[v]=ma[l].shallow.indexOf(v)>=0?E:ns(E)}return m}class ro{constructor(){this.first=!0}update(l,h){const m=Math.floor(l);return this.first?(this.first=!1,this.lastIntegerZoom=m,this.lastIntegerZoomTime=0,this.lastZoom=l,this.lastFloorZoom=m,!0):(this.lastFloorZoom>m?(this.lastIntegerZoom=m+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<m&&(this.lastIntegerZoom=m,this.lastIntegerZoomTime=h),l!==this.lastZoom&&(this.lastZoom=l,this.lastFloorZoom=m,!0))}}const $e={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519};function Md(u){for(const l of u)if(_h(l.charCodeAt(0)))return!0;return!1}function Bp(u){for(const l of u)if(!Ud(l.charCodeAt(0)))return!1;return!0}function Ud(u){return!($e.Arabic(u)||$e["Arabic Supplement"](u)||$e["Arabic Extended-A"](u)||$e["Arabic Presentation Forms-A"](u)||$e["Arabic Presentation Forms-B"](u))}function _h(u){return!(u!==746&&u!==747&&(u<4352||!($e["Bopomofo Extended"](u)||$e.Bopomofo(u)||$e["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||$e["CJK Compatibility Ideographs"](u)||$e["CJK Compatibility"](u)||$e["CJK Radicals Supplement"](u)||$e["CJK Strokes"](u)||!(!$e["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||$e["CJK Unified Ideographs Extension A"](u)||$e["CJK Unified Ideographs"](u)||$e["Enclosed CJK Letters and Months"](u)||$e["Hangul Compatibility Jamo"](u)||$e["Hangul Jamo Extended-A"](u)||$e["Hangul Jamo Extended-B"](u)||$e["Hangul Jamo"](u)||$e["Hangul Syllables"](u)||$e.Hiragana(u)||$e["Ideographic Description Characters"](u)||$e.Kanbun(u)||$e["Kangxi Radicals"](u)||$e["Katakana Phonetic Extensions"](u)||$e.Katakana(u)&&u!==12540||!(!$e["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!$e["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||$e["Unified Canadian Aboriginal Syllabics"](u)||$e["Unified Canadian Aboriginal Syllabics Extended"](u)||$e["Vertical Forms"](u)||$e["Yijing Hexagram Symbols"](u)||$e["Yi Syllables"](u)||$e["Yi Radicals"](u))))}function Rd(u){return!(_h(u)||function(l){return!!($e["Latin-1 Supplement"](l)&&(l===167||l===169||l===174||l===177||l===188||l===189||l===190||l===215||l===247)||$e["General Punctuation"](l)&&(l===8214||l===8224||l===8225||l===8240||l===8241||l===8251||l===8252||l===8258||l===8263||l===8264||l===8265||l===8273)||$e["Letterlike Symbols"](l)||$e["Number Forms"](l)||$e["Miscellaneous Technical"](l)&&(l>=8960&&l<=8967||l>=8972&&l<=8991||l>=8996&&l<=9e3||l===9003||l>=9085&&l<=9114||l>=9150&&l<=9165||l===9167||l>=9169&&l<=9179||l>=9186&&l<=9215)||$e["Control Pictures"](l)&&l!==9251||$e["Optical Character Recognition"](l)||$e["Enclosed Alphanumerics"](l)||$e["Geometric Shapes"](l)||$e["Miscellaneous Symbols"](l)&&!(l>=9754&&l<=9759)||$e["Miscellaneous Symbols and Arrows"](l)&&(l>=11026&&l<=11055||l>=11088&&l<=11097||l>=11192&&l<=11243)||$e["CJK Symbols and Punctuation"](l)||$e.Katakana(l)||$e["Private Use Area"](l)||$e["CJK Compatibility Forms"](l)||$e["Small Form Variants"](l)||$e["Halfwidth and Fullwidth Forms"](l)||l===8734||l===8756||l===8757||l>=9984&&l<=10087||l>=10102&&l<=10131||l===65532||l===65533)}(u))}function Dl(u){return u>=1424&&u<=2303||$e["Arabic Presentation Forms-A"](u)||$e["Arabic Presentation Forms-B"](u)}function gA(u,l){return!(!l&&Dl(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||$e.Khmer(u))}function _u(u){for(const l of u)if(Dl(l.charCodeAt(0)))return!0;return!1}const Co=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(u){this.pluginStatus=u.pluginStatus,this.pluginURL=u.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(u){this.applyArabicShaping=u.applyArabicShaping,this.processBidirectionalText=u.processBidirectionalText,this.processStyledBidirectionalText=u.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Un{constructor(l,h){this.zoom=l,h?(this.now=h.now,this.fadeDuration=h.fadeDuration,this.zoomHistory=h.zoomHistory,this.transition=h.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ro,this.transition={})}isSupportedScript(l){return function(h,m){for(const v of h)if(!gA(v.charCodeAt(0),m))return!1;return!0}(l,Co.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const l=this.zoom,h=l-Math.floor(l),m=this.crossFadingFactor();return l>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*m}:{fromScale:.5,toScale:1,t:1-(1-m)*h}}}class mA{constructor(l,h){this.property=l,this.value=h,this.expression=function(m,v){if(xs(m))return new $o(m,v);if(Cs(m)){const E=Fl(m,v);if(E.result==="error")throw new Error(E.value.map(T=>`${T.key}: ${T.message}`).join(", "));return E.value}{let E=m;return v.type==="color"&&typeof m=="string"?E=or.parse(m):v.type!=="padding"||typeof m!="number"&&!Array.isArray(m)?v.type==="variableAnchorOffsetCollection"&&Array.isArray(m)&&(E=mn.parse(m)):E=gn.parse(m),{kind:"constant",evaluate:()=>E}}}(h===void 0?l.specification.default:h,l.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(l,h,m){return this.property.possiblyEvaluate(this,l,h,m)}}class vu{constructor(l){this.property=l,this.value=new mA(l,void 0)}transitioned(l,h){return new Cp(this.property,this.value,h,mt({},l.transition,this.transition),l.now)}untransitioned(){return new Cp(this.property,this.value,null,{},0)}}class Sc{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitionablePropertyValues)}getValue(l){return ot(this._values[l].value.value)}setValue(l,h){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new vu(this._values[l].property)),this._values[l].value=new mA(this._values[l].property,h===null?void 0:ot(h))}getTransition(l){return ot(this._values[l].transition)}setTransition(l,h){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new vu(this._values[l].property)),this._values[l].transition=ot(h)||void 0}serialize(){const l={};for(const h of Object.keys(this._values)){const m=this.getValue(h);m!==void 0&&(l[h]=m);const v=this.getTransition(h);v!==void 0&&(l[`${h}-transition`]=v)}return l}transitioned(l,h){const m=new Od(this._properties);for(const v of Object.keys(this._values))m._values[v]=this._values[v].transitioned(l,h._values[v]);return m}untransitioned(){const l=new Od(this._properties);for(const h of Object.keys(this._values))l._values[h]=this._values[h].untransitioned();return l}}class Cp{constructor(l,h,m,v,E){this.property=l,this.value=h,this.begin=E+v.delay||0,this.end=this.begin+v.duration||0,l.specification.transition&&(v.delay||v.duration)&&(this.prior=m)}possiblyEvaluate(l,h,m){const v=l.now||0,E=this.value.possiblyEvaluate(l,h,m),T=this.prior;if(T){if(v>this.end)return this.prior=null,E;if(this.value.isDataDriven())return this.prior=null,E;if(v<this.begin)return T.possiblyEvaluate(l,h,m);{const F=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(T.possiblyEvaluate(l,h,m),E,function(U){if(U<=0)return 0;if(U>=1)return 1;const Q=U*U,G=Q*U;return 4*(U<.5?G:3*(U-Q)+G-.75)}(F))}}return E}}class Od{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitioningPropertyValues)}possiblyEvaluate(l,h,m){const v=new vh(this._properties);for(const E of Object.keys(this._values))v._values[E]=this._values[E].possiblyEvaluate(l,h,m);return v}hasTransition(){for(const l of Object.keys(this._values))if(this._values[l].prior)return!0;return!1}}class yA{constructor(l){this._properties=l,this._values=Object.create(l.defaultPropertyValues)}hasValue(l){return this._values[l].value!==void 0}getValue(l){return ot(this._values[l].value)}setValue(l,h){this._values[l]=new mA(this._values[l].property,h===null?void 0:ot(h))}serialize(){const l={};for(const h of Object.keys(this._values)){const m=this.getValue(h);m!==void 0&&(l[h]=m)}return l}possiblyEvaluate(l,h,m){const v=new vh(this._properties);for(const E of Object.keys(this._values))v._values[E]=this._values[E].possiblyEvaluate(l,h,m);return v}}class ya{constructor(l,h,m){this.property=l,this.value=h,this.parameters=m}isConstant(){return this.value.kind==="constant"}constantOr(l){return this.value.kind==="constant"?this.value.value:l}evaluate(l,h,m,v){return this.property.evaluate(this.value,this.parameters,l,h,m,v)}}class vh{constructor(l){this._properties=l,this._values=Object.create(l.defaultPossiblyEvaluatedValues)}get(l){return this._values[l]}}class ur{constructor(l){this.specification=l}possiblyEvaluate(l,h){if(l.isDataDriven())throw new Error("Value should not be data driven");return l.expression.evaluate(h)}interpolate(l,h,m){const v=As[this.specification.type];return v?v(l,h,m):l}}class Er{constructor(l,h){this.specification=l,this.overrides=h}possiblyEvaluate(l,h,m,v){return new ya(this,l.expression.kind==="constant"||l.expression.kind==="camera"?{kind:"constant",value:l.expression.evaluate(h,null,{},m,v)}:l.expression,h)}interpolate(l,h,m){if(l.value.kind!=="constant"||h.value.kind!=="constant")return l;if(l.value.value===void 0||h.value.value===void 0)return new ya(this,{kind:"constant",value:void 0},l.parameters);const v=As[this.specification.type];if(v){const E=v(l.value.value,h.value.value,m);return new ya(this,{kind:"constant",value:E},l.parameters)}return l}evaluate(l,h,m,v,E,T){return l.kind==="constant"?l.value:l.evaluate(h,m,v,E,T)}}class S extends Er{possiblyEvaluate(l,h,m,v){if(l.value===void 0)return new ya(this,{kind:"constant",value:void 0},h);if(l.expression.kind==="constant"){const E=l.expression.evaluate(h,null,{},m,v),T=l.property.specification.type==="resolvedImage"&&typeof E!="string"?E.name:E,F=this._calculate(T,T,T,h);return new ya(this,{kind:"constant",value:F},h)}if(l.expression.kind==="camera"){const E=this._calculate(l.expression.evaluate({zoom:h.zoom-1}),l.expression.evaluate({zoom:h.zoom}),l.expression.evaluate({zoom:h.zoom+1}),h);return new ya(this,{kind:"constant",value:E},h)}return new ya(this,l.expression,h)}evaluate(l,h,m,v,E,T){if(l.kind==="source"){const F=l.evaluate(h,m,v,E,T);return this._calculate(F,F,F,h)}return l.kind==="composite"?this._calculate(l.evaluate({zoom:Math.floor(h.zoom)-1},m,v),l.evaluate({zoom:Math.floor(h.zoom)},m,v),l.evaluate({zoom:Math.floor(h.zoom)+1},m,v),h):l.value}_calculate(l,h,m,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:l,to:h}:{from:m,to:h}}interpolate(l){return l}}class c{constructor(l){this.specification=l}possiblyEvaluate(l,h,m,v){if(l.value!==void 0){if(l.expression.kind==="constant"){const E=l.expression.evaluate(h,null,{},m,v);return this._calculate(E,E,E,h)}return this._calculate(l.expression.evaluate(new Un(Math.floor(h.zoom-1),h)),l.expression.evaluate(new Un(Math.floor(h.zoom),h)),l.expression.evaluate(new Un(Math.floor(h.zoom+1),h)),h)}}_calculate(l,h,m,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:l,to:h}:{from:m,to:h}}interpolate(l){return l}}class f{constructor(l){this.specification=l}possiblyEvaluate(l,h,m,v){return!!l.expression.evaluate(h,null,{},m,v)}interpolate(){return!1}}class _{constructor(l){this.properties=l,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in l){const m=l[h];m.specification.overridable&&this.overridableProperties.push(h);const v=this.defaultPropertyValues[h]=new mA(m,void 0),E=this.defaultTransitionablePropertyValues[h]=new vu(m);this.defaultTransitioningPropertyValues[h]=E.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=v.possiblyEvaluate({})}}}je("DataDrivenProperty",Er),je("DataConstantProperty",ur),je("CrossFadedDataDrivenProperty",S),je("CrossFadedProperty",c),je("ColorRampProperty",f);const A="-transition";class g extends he{constructor(l,h){if(super(),this.id=l.id,this.type=l.type,this._featureFilter={filter:()=>!0,needGeometry:!1},l.type!=="custom"&&(this.metadata=l.metadata,this.minzoom=l.minzoom,this.maxzoom=l.maxzoom,l.type!=="background"&&(this.source=l.source,this.sourceLayer=l["source-layer"],this.filter=l.filter),h.layout&&(this._unevaluatedLayout=new yA(h.layout)),h.paint)){this._transitionablePaint=new Sc(h.paint);for(const m in l.paint)this.setPaintProperty(m,l.paint[m],{validate:!1});for(const m in l.layout)this.setLayoutProperty(m,l.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new vh(h.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(l){return l==="visibility"?this.visibility:this._unevaluatedLayout.getValue(l)}setLayoutProperty(l,h){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};h!=null&&this._validate(Hm,`layers.${this.id}.layout.${l}`,l,h,m)||(l!=="visibility"?this._unevaluatedLayout.setValue(l,h):this.visibility=h)}getPaintProperty(l){return l.endsWith(A)?this._transitionablePaint.getTransition(l.slice(0,-11)):this._transitionablePaint.getValue(l)}setPaintProperty(l,h){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(h!=null&&this._validate(wp,`layers.${this.id}.paint.${l}`,l,h,m))return!1;if(l.endsWith(A))return this._transitionablePaint.setTransition(l.slice(0,-11),h||void 0),!1;{const v=this._transitionablePaint._values[l],E=v.property.specification["property-type"]==="cross-faded-data-driven",T=v.value.isDataDriven(),F=v.value;this._transitionablePaint.setValue(l,h),this._handleSpecialPaintPropertyUpdate(l);const U=this._transitionablePaint._values[l].value;return U.isDataDriven()||T||E||this._handleOverridablePaintPropertyUpdate(l,F,U)}}_handleSpecialPaintPropertyUpdate(l){}_handleOverridablePaintPropertyUpdate(l,h,m){return!1}isHidden(l){return!!(this.minzoom&&l<this.minzoom)||!!(this.maxzoom&&l>=this.maxzoom)||this.visibility==="none"}updateTransitions(l){this._transitioningPaint=this._transitionablePaint.transitioned(l,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(l,h){l.getCrossfadeParameters&&(this._crossfadeParameters=l.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(l,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(l,void 0,h)}serialize(){const l={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(l.layout=l.layout||{},l.layout.visibility=this.visibility),Tt(l,(h,m)=>!(h===void 0||m==="layout"&&!Object.keys(h).length||m==="paint"&&!Object.keys(h).length))}_validate(l,h,m,v){let E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};return(!E||E.validate!==!1)&&Pd(this,l.call(eo,{key:h,layerType:this.type,objectKey:m,value:v,styleSpec:st,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const l in this.paint._values){const h=this.paint.get(l);if(h instanceof ya&&qa(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}const w={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class B{constructor(l,h){this._structArray=l,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class I{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(l,h){return l._trim(),h&&(l.isTransferred=!0,h.push(l.arrayBuffer)),{length:l.length,arrayBuffer:l.arrayBuffer}}static deserialize(l){const h=Object.create(this.prototype);return h.arrayBuffer=l.arrayBuffer,h.length=l.length,h.capacity=l.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(l){this.reserve(l),this.length=l}reserve(l){if(l>this.capacity){this.capacity=Math.max(l,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function L(u){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,h=0,m=0;return{members:u.map(v=>{const E=w[v.type].BYTES_PER_ELEMENT,T=h=R(h,Math.max(l,E)),F=v.components||1;return m=Math.max(m,E),h+=E*F,{name:v.name,type:v.type,components:F,offset:T}}),size:R(h,Math.max(m,l)),alignment:l}}function R(u,l){return Math.ceil(u/l)*l}class O extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h){const m=this.length;return this.resize(m+1),this.emplace(m,l,h)}emplace(l,h,m){const v=2*l;return this.int16[v+0]=h,this.int16[v+1]=m,l}}O.prototype.bytesPerElement=4,je("StructArrayLayout2i4",O);class N extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,m){const v=this.length;return this.resize(v+1),this.emplace(v,l,h,m)}emplace(l,h,m,v){const E=3*l;return this.int16[E+0]=h,this.int16[E+1]=m,this.int16[E+2]=v,l}}N.prototype.bytesPerElement=6,je("StructArrayLayout3i6",N);class H extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,m,v){const E=this.length;return this.resize(E+1),this.emplace(E,l,h,m,v)}emplace(l,h,m,v,E){const T=4*l;return this.int16[T+0]=h,this.int16[T+1]=m,this.int16[T+2]=v,this.int16[T+3]=E,l}}H.prototype.bytesPerElement=8,je("StructArrayLayout4i8",H);class K extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,m,v,E,T){const F=this.length;return this.resize(F+1),this.emplace(F,l,h,m,v,E,T)}emplace(l,h,m,v,E,T,F){const U=6*l;return this.int16[U+0]=h,this.int16[U+1]=m,this.int16[U+2]=v,this.int16[U+3]=E,this.int16[U+4]=T,this.int16[U+5]=F,l}}K.prototype.bytesPerElement=12,je("StructArrayLayout2i4i12",K);class et extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,m,v,E,T){const F=this.length;return this.resize(F+1),this.emplace(F,l,h,m,v,E,T)}emplace(l,h,m,v,E,T,F){const U=4*l,Q=8*l;return this.int16[U+0]=h,this.int16[U+1]=m,this.uint8[Q+4]=v,this.uint8[Q+5]=E,this.uint8[Q+6]=T,this.uint8[Q+7]=F,l}}et.prototype.bytesPerElement=8,je("StructArrayLayout2i4ub8",et);class Y extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h){const m=this.length;return this.resize(m+1),this.emplace(m,l,h)}emplace(l,h,m){const v=2*l;return this.float32[v+0]=h,this.float32[v+1]=m,l}}Y.prototype.bytesPerElement=8,je("StructArrayLayout2f8",Y);class Z extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,m,v,E,T,F,U,Q,G){const q=this.length;return this.resize(q+1),this.emplace(q,l,h,m,v,E,T,F,U,Q,G)}emplace(l,h,m,v,E,T,F,U,Q,G,q){const J=10*l;return this.uint16[J+0]=h,this.uint16[J+1]=m,this.uint16[J+2]=v,this.uint16[J+3]=E,this.uint16[J+4]=T,this.uint16[J+5]=F,this.uint16[J+6]=U,this.uint16[J+7]=Q,this.uint16[J+8]=G,this.uint16[J+9]=q,l}}Z.prototype.bytesPerElement=20,je("StructArrayLayout10ui20",Z);class yt extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,m,v,E,T,F,U,Q,G,q,J){const rt=this.length;return this.resize(rt+1),this.emplace(rt,l,h,m,v,E,T,F,U,Q,G,q,J)}emplace(l,h,m,v,E,T,F,U,Q,G,q,J,rt){const ut=12*l;return this.int16[ut+0]=h,this.int16[ut+1]=m,this.int16[ut+2]=v,this.int16[ut+3]=E,this.uint16[ut+4]=T,this.uint16[ut+5]=F,this.uint16[ut+6]=U,this.uint16[ut+7]=Q,this.int16[ut+8]=G,this.int16[ut+9]=q,this.int16[ut+10]=J,this.int16[ut+11]=rt,l}}yt.prototype.bytesPerElement=24,je("StructArrayLayout4i4ui4i24",yt);class at extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,m){const v=this.length;return this.resize(v+1),this.emplace(v,l,h,m)}emplace(l,h,m,v){const E=3*l;return this.float32[E+0]=h,this.float32[E+1]=m,this.float32[E+2]=v,l}}at.prototype.bytesPerElement=12,je("StructArrayLayout3f12",at);class lt extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.uint32[1*l+0]=h,l}}lt.prototype.bytesPerElement=4,je("StructArrayLayout1ul4",lt);class At extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,m,v,E,T,F,U,Q){const G=this.length;return this.resize(G+1),this.emplace(G,l,h,m,v,E,T,F,U,Q)}emplace(l,h,m,v,E,T,F,U,Q,G){const q=10*l,J=5*l;return this.int16[q+0]=h,this.int16[q+1]=m,this.int16[q+2]=v,this.int16[q+3]=E,this.int16[q+4]=T,this.int16[q+5]=F,this.uint32[J+3]=U,this.uint16[q+8]=Q,this.uint16[q+9]=G,l}}At.prototype.bytesPerElement=20,je("StructArrayLayout6i1ul2ui20",At);class Et extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,m,v,E,T){const F=this.length;return this.resize(F+1),this.emplace(F,l,h,m,v,E,T)}emplace(l,h,m,v,E,T,F){const U=6*l;return this.int16[U+0]=h,this.int16[U+1]=m,this.int16[U+2]=v,this.int16[U+3]=E,this.int16[U+4]=T,this.int16[U+5]=F,l}}Et.prototype.bytesPerElement=12,je("StructArrayLayout2i2i2i12",Et);class Dt extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,m,v,E){const T=this.length;return this.resize(T+1),this.emplace(T,l,h,m,v,E)}emplace(l,h,m,v,E,T){const F=4*l,U=8*l;return this.float32[F+0]=h,this.float32[F+1]=m,this.float32[F+2]=v,this.int16[U+6]=E,this.int16[U+7]=T,l}}Dt.prototype.bytesPerElement=16,je("StructArrayLayout2f1f2i16",Dt);class zt extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,m,v,E,T){const F=this.length;return this.resize(F+1),this.emplace(F,l,h,m,v,E,T)}emplace(l,h,m,v,E,T,F){const U=16*l,Q=4*l,G=8*l;return this.uint8[U+0]=h,this.uint8[U+1]=m,this.float32[Q+1]=v,this.float32[Q+2]=E,this.int16[G+6]=T,this.int16[G+7]=F,l}}zt.prototype.bytesPerElement=16,je("StructArrayLayout2ub2f2i16",zt);class ue extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,m){const v=this.length;return this.resize(v+1),this.emplace(v,l,h,m)}emplace(l,h,m,v){const E=3*l;return this.uint16[E+0]=h,this.uint16[E+1]=m,this.uint16[E+2]=v,l}}ue.prototype.bytesPerElement=6,je("StructArrayLayout3ui6",ue);class oe extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,m,v,E,T,F,U,Q,G,q,J,rt,ut,_t,St,Rt){const Xt=this.length;return this.resize(Xt+1),this.emplace(Xt,l,h,m,v,E,T,F,U,Q,G,q,J,rt,ut,_t,St,Rt)}emplace(l,h,m,v,E,T,F,U,Q,G,q,J,rt,ut,_t,St,Rt,Xt){const Qt=24*l,qt=12*l,Ae=48*l;return this.int16[Qt+0]=h,this.int16[Qt+1]=m,this.uint16[Qt+2]=v,this.uint16[Qt+3]=E,this.uint32[qt+2]=T,this.uint32[qt+3]=F,this.uint32[qt+4]=U,this.uint16[Qt+10]=Q,this.uint16[Qt+11]=G,this.uint16[Qt+12]=q,this.float32[qt+7]=J,this.float32[qt+8]=rt,this.uint8[Ae+36]=ut,this.uint8[Ae+37]=_t,this.uint8[Ae+38]=St,this.uint32[qt+10]=Rt,this.int16[Qt+22]=Xt,l}}oe.prototype.bytesPerElement=48,je("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",oe);class ce extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,m,v,E,T,F,U,Q,G,q,J,rt,ut,_t,St,Rt,Xt,Qt,qt,Ae,Be,qe,wr,Ke,Ve,dr,sr){const rr=this.length;return this.resize(rr+1),this.emplace(rr,l,h,m,v,E,T,F,U,Q,G,q,J,rt,ut,_t,St,Rt,Xt,Qt,qt,Ae,Be,qe,wr,Ke,Ve,dr,sr)}emplace(l,h,m,v,E,T,F,U,Q,G,q,J,rt,ut,_t,St,Rt,Xt,Qt,qt,Ae,Be,qe,wr,Ke,Ve,dr,sr,rr){const ye=32*l,mr=16*l;return this.int16[ye+0]=h,this.int16[ye+1]=m,this.int16[ye+2]=v,this.int16[ye+3]=E,this.int16[ye+4]=T,this.int16[ye+5]=F,this.int16[ye+6]=U,this.int16[ye+7]=Q,this.uint16[ye+8]=G,this.uint16[ye+9]=q,this.uint16[ye+10]=J,this.uint16[ye+11]=rt,this.uint16[ye+12]=ut,this.uint16[ye+13]=_t,this.uint16[ye+14]=St,this.uint16[ye+15]=Rt,this.uint16[ye+16]=Xt,this.uint16[ye+17]=Qt,this.uint16[ye+18]=qt,this.uint16[ye+19]=Ae,this.uint16[ye+20]=Be,this.uint16[ye+21]=qe,this.uint16[ye+22]=wr,this.uint32[mr+12]=Ke,this.float32[mr+13]=Ve,this.float32[mr+14]=dr,this.uint16[ye+30]=sr,this.uint16[ye+31]=rr,l}}ce.prototype.bytesPerElement=64,je("StructArrayLayout8i15ui1ul2f2ui64",ce);class ie extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.float32[1*l+0]=h,l}}ie.prototype.bytesPerElement=4,je("StructArrayLayout1f4",ie);class Pe extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,m){const v=this.length;return this.resize(v+1),this.emplace(v,l,h,m)}emplace(l,h,m,v){const E=3*l;return this.uint16[6*l+0]=h,this.float32[E+1]=m,this.float32[E+2]=v,l}}Pe.prototype.bytesPerElement=12,je("StructArrayLayout1ui2f12",Pe);class We extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,m){const v=this.length;return this.resize(v+1),this.emplace(v,l,h,m)}emplace(l,h,m,v){const E=4*l;return this.uint32[2*l+0]=h,this.uint16[E+2]=m,this.uint16[E+3]=v,l}}We.prototype.bytesPerElement=8,je("StructArrayLayout1ul2ui8",We);class _e extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h){const m=this.length;return this.resize(m+1),this.emplace(m,l,h)}emplace(l,h,m){const v=2*l;return this.uint16[v+0]=h,this.uint16[v+1]=m,l}}_e.prototype.bytesPerElement=4,je("StructArrayLayout2ui4",_e);class be extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.uint16[1*l+0]=h,l}}be.prototype.bytesPerElement=2,je("StructArrayLayout1ui2",be);class Xe extends I{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,m,v){const E=this.length;return this.resize(E+1),this.emplace(E,l,h,m,v)}emplace(l,h,m,v,E){const T=4*l;return this.float32[T+0]=h,this.float32[T+1]=m,this.float32[T+2]=v,this.float32[T+3]=E,l}}Xe.prototype.bytesPerElement=16,je("StructArrayLayout4f16",Xe);class Rr extends B{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new b(this.anchorPointX,this.anchorPointY)}}Rr.prototype.size=20;class He extends At{get(l){return new Rr(this,l)}}je("CollisionBoxArray",He);class Sr extends B{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(l){this._structArray.uint8[this._pos1+37]=l}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(l){this._structArray.uint8[this._pos1+38]=l}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(l){this._structArray.uint32[this._pos4+10]=l}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Sr.prototype.size=48;class an extends oe{get(l){return new Sr(this,l)}}je("PlacedSymbolArray",an);class pn extends B{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(l){this._structArray.uint32[this._pos4+12]=l}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}pn.prototype.size=64;class oi extends ce{get(l){return new pn(this,l)}}je("SymbolInstanceArray",oi);class Mr extends ie{getoffsetX(l){return this.float32[1*l+0]}}je("GlyphOffsetArray",Mr);class Xn extends N{getx(l){return this.int16[3*l+0]}gety(l){return this.int16[3*l+1]}gettileUnitDistanceFromAnchor(l){return this.int16[3*l+2]}}je("SymbolLineVertexArray",Xn);class Vn extends B{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Vn.prototype.size=12;class bn extends Pe{get(l){return new Vn(this,l)}}je("TextAnchorOffsetArray",bn);class xn extends B{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}xn.prototype.size=8;class ei extends We{get(l){return new xn(this,l)}}je("FeatureIndexArray",ei);class Gi extends O{}class no extends O{}class pi extends O{}class Is extends K{}class _a extends et{}class Nl extends Y{}class ai extends Z{}class Bn extends yt{}class va extends at{}class Tc extends lt{}class is extends Et{}class Ui extends zt{}class wi extends ue{}class Gn extends _e{}const ds=L([{name:"a_pos",components:2,type:"Int16"}],4),{members:kl}=ds;class li{constructor(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.segments=l}prepareSegment(l,h,m,v){let E=this.segments[this.segments.length-1];return l>li.MAX_VERTEX_ARRAY_LENGTH&&wt(`Max vertices per segment is ${li.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${l}`),(!E||E.vertexLength+l>li.MAX_VERTEX_ARRAY_LENGTH||E.sortKey!==v)&&(E={vertexOffset:h.length,primitiveOffset:m.length,vertexLength:0,primitiveLength:0},v!==void 0&&(E.sortKey=v),this.segments.push(E)),E}get(){return this.segments}destroy(){for(const l of this.segments)for(const h in l.vaos)l.vaos[h].destroy()}static simpleSegment(l,h,m,v){return new li([{vertexOffset:l,primitiveOffset:h,vertexLength:m,primitiveLength:v,vaos:{},sortKey:0}])}}function Dd(u,l){return 256*(u=pt(Math.floor(u),0,255))+pt(Math.floor(l),0,255)}li.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,je("SegmentVector",li);const Ic=L([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var _A={exports:{}},Zo={exports:{}};Zo.exports=function(u,l){var h,m,v,E,T,F,U,Q;for(m=u.length-(h=3&u.length),v=l,T=3432918353,F=461845907,Q=0;Q<m;)U=255&u.charCodeAt(Q)|(255&u.charCodeAt(++Q))<<8|(255&u.charCodeAt(++Q))<<16|(255&u.charCodeAt(++Q))<<24,++Q,v=27492+(65535&(E=5*(65535&(v=(v^=U=(65535&(U=(U=(65535&U)*T+(((U>>>16)*T&65535)<<16)&4294967295)<<15|U>>>17))*F+(((U>>>16)*F&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(U=0,h){case 3:U^=(255&u.charCodeAt(Q+2))<<16;case 2:U^=(255&u.charCodeAt(Q+1))<<8;case 1:v^=U=(65535&(U=(U=(65535&(U^=255&u.charCodeAt(Q)))*T+(((U>>>16)*T&65535)<<16)&4294967295)<<15|U>>>17))*F+(((U>>>16)*F&65535)<<16)&4294967295}return v^=u.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0};var bh=Zo.exports,bu={exports:{}};bu.exports=function(u,l){for(var h,m=u.length,v=l^m,E=0;m>=4;)h=1540483477*(65535&(h=255&u.charCodeAt(E)|(255&u.charCodeAt(++E))<<8|(255&u.charCodeAt(++E))<<16|(255&u.charCodeAt(++E))<<24))+((1540483477*(h>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),m-=4,++E;switch(m){case 3:v^=(255&u.charCodeAt(E+2))<<16;case 2:v^=(255&u.charCodeAt(E+1))<<8;case 1:v=1540483477*(65535&(v^=255&u.charCodeAt(E)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0};var Fc=bh,Nd=bu.exports;_A.exports=Fc,_A.exports.murmur3=Fc,_A.exports.murmur2=Nd;var wh=d(_A.exports);class Ql{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(l,h,m,v){this.ids.push(Lc(l)),this.positions.push(h,m,v)}getPositions(l){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=Lc(l);let m=0,v=this.ids.length-1;for(;m<v;){const T=m+v>>1;this.ids[T]>=h?v=T:m=T+1}const E=[];for(;this.ids[m]===h;)E.push({index:this.positions[3*m],start:this.positions[3*m+1],end:this.positions[3*m+2]}),m++;return E}static serialize(l,h){const m=new Float64Array(l.ids),v=new Uint32Array(l.positions);return Vm(m,v,0,m.length-1),h&&h.push(m.buffer,v.buffer),{ids:m,positions:v}}static deserialize(l){const h=new Ql;return h.ids=l.ids,h.positions=l.positions,h.indexed=!0,h}}function Lc(u){const l=+u;return!isNaN(l)&&l<=Number.MAX_SAFE_INTEGER?l:wh(String(u))}function Vm(u,l,h,m){for(;h<m;){const v=u[h+m>>1];let E=h-1,T=m+1;for(;;){do E++;while(u[E]<v);do T--;while(u[T]>v);if(E>=T)break;Ep(u,E,T),Ep(l,3*E,3*T),Ep(l,3*E+1,3*T+1),Ep(l,3*E+2,3*T+2)}T-h<m-T?(Vm(u,l,h,T),h=T+1):(Vm(u,l,T+1,m),m=T)}}function Ep(u,l,h){const m=u[l];u[l]=u[h],u[h]=m}je("FeaturePositionMap",Ql);class vA{constructor(l,h){this.gl=l.gl,this.location=h}}class kd extends vA{constructor(l,h){super(l,h),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class Qd extends vA{constructor(l,h){super(l,h),this.current=[0,0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3]))}}class Gm extends vA{constructor(l,h){super(l,h),this.current=or.transparent}set(l){l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a))}}const q_=new Float32Array(16);function xh(u){return[Dd(255*u.r,255*u.g),Dd(255*u.b,255*u.a)]}class bA{constructor(l,h,m){this.value=l,this.uniformNames=h.map(v=>`u_${v}`),this.type=m}setUniform(l,h,m){l.set(m.constantOr(this.value))}getBinding(l,h,m){return this.type==="color"?new Gm(l,h):new kd(l,h)}}class zl{constructor(l,h){this.uniformNames=h.map(m=>`u_${m}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(l,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=l.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=l.tlbr}setUniform(l,h,m,v){const E=v==="u_pattern_to"?this.patternTo:v==="u_pattern_from"?this.patternFrom:v==="u_pixel_ratio_to"?this.pixelRatioTo:v==="u_pixel_ratio_from"?this.pixelRatioFrom:null;E&&l.set(E)}getBinding(l,h,m){return m.substr(0,9)==="u_pattern"?new Qd(l,h):new kd(l,h)}}class Hl{constructor(l,h,m,v){this.expression=l,this.type=m,this.maxValue=0,this.paintVertexAttributes=h.map(E=>({name:`a_${E}`,type:"Float32",components:m==="color"?2:1,offset:0})),this.paintVertexArray=new v}populatePaintArray(l,h,m,v,E){const T=this.paintVertexArray.length,F=this.expression.evaluate(new Un(0),h,{},v,[],E);this.paintVertexArray.resize(l),this._setPaintValue(T,l,F)}updatePaintArray(l,h,m,v){const E=this.expression.evaluate({zoom:0},m,v);this._setPaintValue(l,h,E)}_setPaintValue(l,h,m){if(this.type==="color"){const v=xh(m);for(let E=l;E<h;E++)this.paintVertexArray.emplace(E,v[0],v[1])}else{for(let v=l;v<h;v++)this.paintVertexArray.emplace(v,m);this.maxValue=Math.max(this.maxValue,Math.abs(m))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ja{constructor(l,h,m,v,E,T){this.expression=l,this.uniformNames=h.map(F=>`u_${F}_t`),this.type=m,this.useIntegerZoom=v,this.zoom=E,this.maxValue=0,this.paintVertexAttributes=h.map(F=>({name:`a_${F}`,type:"Float32",components:m==="color"?4:2,offset:0})),this.paintVertexArray=new T}populatePaintArray(l,h,m,v,E){const T=this.expression.evaluate(new Un(this.zoom),h,{},v,[],E),F=this.expression.evaluate(new Un(this.zoom+1),h,{},v,[],E),U=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValue(U,l,T,F)}updatePaintArray(l,h,m,v){const E=this.expression.evaluate({zoom:this.zoom},m,v),T=this.expression.evaluate({zoom:this.zoom+1},m,v);this._setPaintValue(l,h,E,T)}_setPaintValue(l,h,m,v){if(this.type==="color"){const E=xh(m),T=xh(v);for(let F=l;F<h;F++)this.paintVertexArray.emplace(F,E[0],E[1],T[0],T[1])}else{for(let E=l;E<h;E++)this.paintVertexArray.emplace(E,m,v);this.maxValue=Math.max(this.maxValue,Math.abs(m),Math.abs(v))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(l,h){const m=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,v=pt(this.expression.interpolationFactor(m,this.zoom,this.zoom+1),0,1);l.set(v)}getBinding(l,h,m){return new kd(l,h)}}class Ya{constructor(l,h,m,v,E,T){this.expression=l,this.type=h,this.useIntegerZoom=m,this.zoom=v,this.layerId=T,this.zoomInPaintVertexArray=new E,this.zoomOutPaintVertexArray=new E}populatePaintArray(l,h,m){const v=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(l),this.zoomOutPaintVertexArray.resize(l),this._setPaintValues(v,l,h.patterns&&h.patterns[this.layerId],m)}updatePaintArray(l,h,m,v,E){this._setPaintValues(l,h,m.patterns&&m.patterns[this.layerId],E)}_setPaintValues(l,h,m,v){if(!v||!m)return;const{min:E,mid:T,max:F}=m,U=v[E],Q=v[T],G=v[F];if(U&&Q&&G)for(let q=l;q<h;q++)this.zoomInPaintVertexArray.emplace(q,Q.tl[0],Q.tl[1],Q.br[0],Q.br[1],U.tl[0],U.tl[1],U.br[0],U.br[1],Q.pixelRatio,U.pixelRatio),this.zoomOutPaintVertexArray.emplace(q,Q.tl[0],Q.tl[1],Q.br[0],Q.br[1],G.tl[0],G.tl[1],G.br[0],G.br[1],Q.pixelRatio,G.pixelRatio)}upload(l){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=l.createVertexBuffer(this.zoomInPaintVertexArray,Ic.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=l.createVertexBuffer(this.zoomOutPaintVertexArray,Ic.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class jm{constructor(l,h,m){this.binders={},this._buffers=[];const v=[];for(const E in l.paint._values){if(!m(E))continue;const T=l.paint.get(E);if(!(T instanceof ya&&qa(T.property.specification)))continue;const F=wu(E,l.type),U=T.value,Q=T.property.specification.type,G=T.property.useIntegerZoom,q=T.property.specification["property-type"],J=q==="cross-faded"||q==="cross-faded-data-driven";if(U.kind==="constant")this.binders[E]=J?new zl(U.value,F):new bA(U.value,F,Q),v.push(`/u_${E}`);else if(U.kind==="source"||J){const rt=qm(E,Q,"source");this.binders[E]=J?new Ya(U,Q,G,h,rt,l.id):new Hl(U,F,Q,rt),v.push(`/a_${E}`)}else{const rt=qm(E,Q,"composite");this.binders[E]=new Ja(U,F,Q,G,h,rt),v.push(`/z_${E}`)}}this.cacheKey=v.sort().join("")}getMaxValue(l){const h=this.binders[l];return h instanceof Hl||h instanceof Ja?h.maxValue:0}populatePaintArrays(l,h,m,v,E){for(const T in this.binders){const F=this.binders[T];(F instanceof Hl||F instanceof Ja||F instanceof Ya)&&F.populatePaintArray(l,h,m,v,E)}}setConstantPatternPositions(l,h){for(const m in this.binders){const v=this.binders[m];v instanceof zl&&v.setConstantPatternPositions(l,h)}}updatePaintArrays(l,h,m,v,E){let T=!1;for(const F in l){const U=h.getPositions(F);for(const Q of U){const G=m.feature(Q.index);for(const q in this.binders){const J=this.binders[q];if((J instanceof Hl||J instanceof Ja||J instanceof Ya)&&J.expression.isStateDependent===!0){const rt=v.paint.get(q);J.expression=rt.value,J.updatePaintArray(Q.start,Q.end,G,l[F],E),T=!0}}}}return T}defines(){const l=[];for(const h in this.binders){const m=this.binders[h];(m instanceof bA||m instanceof zl)&&l.push(...m.uniformNames.map(v=>`#define HAS_UNIFORM_${v}`))}return l}getBinderAttributes(){const l=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof Hl||m instanceof Ja)for(let v=0;v<m.paintVertexAttributes.length;v++)l.push(m.paintVertexAttributes[v].name);else if(m instanceof Ya)for(let v=0;v<Ic.members.length;v++)l.push(Ic.members[v].name)}return l}getBinderUniforms(){const l=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof bA||m instanceof zl||m instanceof Ja)for(const v of m.uniformNames)l.push(v)}return l}getPaintVertexBuffers(){return this._buffers}getUniforms(l,h){const m=[];for(const v in this.binders){const E=this.binders[v];if(E instanceof bA||E instanceof zl||E instanceof Ja){for(const T of E.uniformNames)if(h[T]){const F=E.getBinding(l,h[T],T);m.push({name:T,property:v,binding:F})}}}return m}setUniforms(l,h,m,v){for(const{name:E,property:T,binding:F}of h)this.binders[T].setUniform(F,v,m.get(T),E)}updatePaintBuffers(l){this._buffers=[];for(const h in this.binders){const m=this.binders[h];if(l&&m instanceof Ya){const v=l.fromScale===2?m.zoomInPaintVertexBuffer:m.zoomOutPaintVertexBuffer;v&&this._buffers.push(v)}else(m instanceof Hl||m instanceof Ja)&&m.paintVertexBuffer&&this._buffers.push(m.paintVertexBuffer)}}upload(l){for(const h in this.binders){const m=this.binders[h];(m instanceof Hl||m instanceof Ja||m instanceof Ya)&&m.upload(l)}this.updatePaintBuffers()}destroy(){for(const l in this.binders){const h=this.binders[l];(h instanceof Hl||h instanceof Ja||h instanceof Ya)&&h.destroy()}}}class Pc{constructor(l,h){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>!0;this.programConfigurations={};for(const v of l)this.programConfigurations[v.id]=new jm(v,h,m);this.needsUpload=!1,this._featureMap=new Ql,this._bufferOffset=0}populatePaintArrays(l,h,m,v,E,T){for(const F in this.programConfigurations)this.programConfigurations[F].populatePaintArrays(l,h,v,E,T);h.id!==void 0&&this._featureMap.add(h.id,m,this._bufferOffset,l),this._bufferOffset=l,this.needsUpload=!0}updatePaintArrays(l,h,m,v){for(const E of m)this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(l,this._featureMap,h,E,v)||this.needsUpload}get(l){return this.programConfigurations[l]}upload(l){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(l);this.needsUpload=!1}}destroy(){for(const l in this.programConfigurations)this.programConfigurations[l].destroy()}}function wu(u,l){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[u]||[u.replace(`${l}-`,"").replace(/-/g,"_")]}function qm(u,l,h){const m={color:{source:Y,composite:Xe},number:{source:ie,composite:Y}},v=function(E){return{"line-pattern":{source:ai,composite:ai},"fill-pattern":{source:ai,composite:ai},"fill-extrusion-pattern":{source:ai,composite:ai}}[E]}(u);return v&&v[h]||m[l][h]}je("ConstantBinder",bA),je("CrossFadedConstantBinder",zl),je("SourceExpressionBinder",Hl),je("CrossFadedCompositeBinder",Ya),je("CompositeExpressionBinder",Ja),je("ProgramConfiguration",jm,{omit:["_buffers"]}),je("ProgramConfigurationSet",Pc);const Ci=8192,Km=Math.pow(2,14)-1,$m=-Km-1;function ba(u){const l=Ci/u.extent,h=u.loadGeometry();for(let m=0;m<h.length;m++){const v=h[m];for(let E=0;E<v.length;E++){const T=v[E],F=Math.round(T.x*l),U=Math.round(T.y*l);T.x=pt(F,$m,Km),T.y=pt(U,$m,Km),(F<T.x||F>T.x+1||U<T.y||U>T.y+1)&&wt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function wA(u,l){return{type:u.type,id:u.id,properties:u.properties,geometry:l?ba(u):[]}}function zd(u,l,h,m,v){u.emplaceBack(2*l+(m+1)/2,2*h+(v+1)/2)}class Wm{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(h=>h.id),this.index=l.index,this.hasPattern=!1,this.layoutVertexArray=new no,this.indexArray=new wi,this.segments=new li,this.programConfigurations=new Pc(l.layers,l.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(l,h,m){const v=this.layers[0],E=[];let T=null,F=!1;v.type==="circle"&&(T=v.layout.get("circle-sort-key"),F=!T.isConstant());for(const{feature:U,id:Q,index:G,sourceLayerIndex:q}of l){const J=this.layers[0]._featureFilter.needGeometry,rt=wA(U,J);if(!this.layers[0]._featureFilter.filter(new Un(this.zoom),rt,m))continue;const ut=F?T.evaluate(rt,{},m):void 0,_t={id:Q,properties:U.properties,type:U.type,sourceLayerIndex:q,index:G,geometry:J?rt.geometry:ba(U),patterns:{},sortKey:ut};E.push(_t)}F&&E.sort((U,Q)=>U.sortKey-Q.sortKey);for(const U of E){const{geometry:Q,index:G,sourceLayerIndex:q}=U,J=l[G].feature;this.addFeature(U,Q,G,m),h.featureIndex.insert(J,Q,G,q,this.index)}}update(l,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,kl),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(l,h,m,v){for(const E of h)for(const T of E){const F=T.x,U=T.y;if(F<0||F>=Ci||U<0||U>=Ci)continue;const Q=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,l.sortKey),G=Q.vertexLength;zd(this.layoutVertexArray,F,U,-1,-1),zd(this.layoutVertexArray,F,U,1,-1),zd(this.layoutVertexArray,F,U,1,1),zd(this.layoutVertexArray,F,U,-1,1),this.indexArray.emplaceBack(G,G+1,G+2),this.indexArray.emplaceBack(G,G+3,G+2),Q.vertexLength+=4,Q.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,m,{},v)}}function Xm(u,l){for(let h=0;h<u.length;h++)if(xu(l,u[h]))return!0;for(let h=0;h<l.length;h++)if(xu(u,l[h]))return!0;return!!Ch(u,l)}function NE(u,l,h){return!!xu(u,l)||!!Vl(l,u,h)}function Bh(u,l){if(u.length===1)return Hd(l,u[0]);for(let h=0;h<l.length;h++){const m=l[h];for(let v=0;v<m.length;v++)if(xu(u,m[v]))return!0}for(let h=0;h<u.length;h++)if(Hd(l,u[h]))return!0;for(let h=0;h<l.length;h++)if(Ch(u,l[h]))return!0;return!1}function Jm(u,l,h){if(u.length>1){if(Ch(u,l))return!0;for(let m=0;m<l.length;m++)if(Vl(l[m],u,h))return!0}for(let m=0;m<u.length;m++)if(Vl(u[m],l,h))return!0;return!1}function Ch(u,l){if(u.length===0||l.length===0)return!1;for(let h=0;h<u.length-1;h++){const m=u[h],v=u[h+1];for(let E=0;E<l.length-1;E++)if(Mc(m,v,l[E],l[E+1]))return!0}return!1}function Mc(u,l,h,m){return vt(u,h,m)!==vt(l,h,m)&&vt(u,l,h)!==vt(u,l,m)}function Vl(u,l,h){const m=h*h;if(l.length===1)return u.distSqr(l[0])<m;for(let v=1;v<l.length;v++)if(Uc(u,l[v-1],l[v])<m)return!0;return!1}function Uc(u,l,h){const m=l.distSqr(h);if(m===0)return u.distSqr(l);const v=((u.x-l.x)*(h.x-l.x)+(u.y-l.y)*(h.y-l.y))/m;return u.distSqr(v<0?l:v>1?h:h.sub(l)._mult(v)._add(l))}function Hd(u,l){let h,m,v,E=!1;for(let T=0;T<u.length;T++){h=u[T];for(let F=0,U=h.length-1;F<h.length;U=F++)m=h[F],v=h[U],m.y>l.y!=v.y>l.y&&l.x<(v.x-m.x)*(l.y-m.y)/(v.y-m.y)+m.x&&(E=!E)}return E}function xu(u,l){let h=!1;for(let m=0,v=u.length-1;m<u.length;v=m++){const E=u[m],T=u[v];E.y>l.y!=T.y>l.y&&l.x<(T.x-E.x)*(l.y-E.y)/(T.y-E.y)+E.x&&(h=!h)}return h}function K_(u,l,h){const m=h[0],v=h[2];if(u.x<m.x&&l.x<m.x||u.x>v.x&&l.x>v.x||u.y<m.y&&l.y<m.y||u.y>v.y&&l.y>v.y)return!1;const E=vt(u,l,h[0]);return E!==vt(u,l,h[1])||E!==vt(u,l,h[2])||E!==vt(u,l,h[3])}function Vd(u,l,h){const m=l.paint.get(u).value;return m.kind==="constant"?m.value:h.programConfigurations.get(l.id).getMaxValue(u)}function Eh(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function Sh(u,l,h,m,v){if(!l[0]&&!l[1])return u;const E=b.convert(l)._mult(v);h==="viewport"&&E._rotate(-m);const T=[];for(let F=0;F<u.length;F++)T.push(u[F].sub(E));return T}let gN,mN;je("CircleBucket",Wm,{omit:["layers"]});var hbt={get paint(){return mN=mN||new _({"circle-radius":new Er(st.paint_circle["circle-radius"]),"circle-color":new Er(st.paint_circle["circle-color"]),"circle-blur":new Er(st.paint_circle["circle-blur"]),"circle-opacity":new Er(st.paint_circle["circle-opacity"]),"circle-translate":new ur(st.paint_circle["circle-translate"]),"circle-translate-anchor":new ur(st.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ur(st.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ur(st.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Er(st.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Er(st.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Er(st.paint_circle["circle-stroke-opacity"])})},get layout(){return gN=gN||new _({"circle-sort-key":new Er(st.layout_circle["circle-sort-key"])})}},Eo=1e-6,Sp=typeof Float32Array<"u"?Float32Array:Array;function kE(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function yN(u,l,h){var m=l[0],v=l[1],E=l[2],T=l[3],F=l[4],U=l[5],Q=l[6],G=l[7],q=l[8],J=l[9],rt=l[10],ut=l[11],_t=l[12],St=l[13],Rt=l[14],Xt=l[15],Qt=h[0],qt=h[1],Ae=h[2],Be=h[3];return u[0]=Qt*m+qt*F+Ae*q+Be*_t,u[1]=Qt*v+qt*U+Ae*J+Be*St,u[2]=Qt*E+qt*Q+Ae*rt+Be*Rt,u[3]=Qt*T+qt*G+Ae*ut+Be*Xt,u[4]=(Qt=h[4])*m+(qt=h[5])*F+(Ae=h[6])*q+(Be=h[7])*_t,u[5]=Qt*v+qt*U+Ae*J+Be*St,u[6]=Qt*E+qt*Q+Ae*rt+Be*Rt,u[7]=Qt*T+qt*G+Ae*ut+Be*Xt,u[8]=(Qt=h[8])*m+(qt=h[9])*F+(Ae=h[10])*q+(Be=h[11])*_t,u[9]=Qt*v+qt*U+Ae*J+Be*St,u[10]=Qt*E+qt*Q+Ae*rt+Be*Rt,u[11]=Qt*T+qt*G+Ae*ut+Be*Xt,u[12]=(Qt=h[12])*m+(qt=h[13])*F+(Ae=h[14])*q+(Be=h[15])*_t,u[13]=Qt*v+qt*U+Ae*J+Be*St,u[14]=Qt*E+qt*Q+Ae*rt+Be*Rt,u[15]=Qt*T+qt*G+Ae*ut+Be*Xt,u}Math.hypot||(Math.hypot=function(){for(var u=0,l=arguments.length;l--;)u+=arguments[l]*arguments[l];return Math.sqrt(u)});var Ym,dbt=yN;function $_(u,l,h){var m=l[0],v=l[1],E=l[2],T=l[3];return u[0]=h[0]*m+h[4]*v+h[8]*E+h[12]*T,u[1]=h[1]*m+h[5]*v+h[9]*E+h[13]*T,u[2]=h[2]*m+h[6]*v+h[10]*E+h[14]*T,u[3]=h[3]*m+h[7]*v+h[11]*E+h[15]*T,u}Ym=new Sp(4),Sp!=Float32Array&&(Ym[0]=0,Ym[1]=0,Ym[2]=0,Ym[3]=0);class fbt extends g{constructor(l){super(l,hbt)}createBucket(l){return new Wm(l)}queryRadius(l){const h=l;return Vd("circle-radius",this,h)+Vd("circle-stroke-width",this,h)+Eh(this.paint.get("circle-translate"))}queryIntersectsFeature(l,h,m,v,E,T,F,U){const Q=Sh(l,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),T.angle,F),G=this.paint.get("circle-radius").evaluate(h,m)+this.paint.get("circle-stroke-width").evaluate(h,m),q=this.paint.get("circle-pitch-alignment")==="map",J=q?Q:function(ut,_t){return ut.map(St=>_N(St,_t))}(Q,U),rt=q?G*F:G;for(const ut of v)for(const _t of ut){const St=q?_t:_N(_t,U);let Rt=rt;const Xt=$_([],[_t.x,_t.y,0,1],U);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Rt*=Xt[3]/T.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Rt*=T.cameraToCenterDistance/Xt[3]),NE(J,St,Rt))return!0}return!1}}function _N(u,l){const h=$_([],[u.x,u.y,0,1],l);return new b(h[0]/h[3],h[1]/h[3])}class vN extends Wm{}let bN;je("HeatmapBucket",vN,{omit:["layers"]});var pbt={get paint(){return bN=bN||new _({"heatmap-radius":new Er(st.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Er(st.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ur(st.paint_heatmap["heatmap-intensity"]),"heatmap-color":new f(st.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ur(st.paint_heatmap["heatmap-opacity"])})}};function QE(u,l,h,m){let{width:v,height:E}=l;if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==v*E*h)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${v*E*h}`)}else m=new Uint8Array(v*E*h);return u.width=v,u.height=E,u.data=m,u}function wN(u,l,h){let{width:m,height:v}=l;if(m===u.width&&v===u.height)return;const E=QE({},{width:m,height:v},h);zE(u,E,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,m),height:Math.min(u.height,v)},h),u.width=m,u.height=v,u.data=E.data}function zE(u,l,h,m,v,E){if(v.width===0||v.height===0)return l;if(v.width>u.width||v.height>u.height||h.x>u.width-v.width||h.y>u.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>l.width||v.height>l.height||m.x>l.width-v.width||m.y>l.height-v.height)throw new RangeError("out of range destination coordinates for image copy");const T=u.data,F=l.data;if(T===F)throw new Error("srcData equals dstData, so image is already copied");for(let U=0;U<v.height;U++){const Q=((h.y+U)*u.width+h.x)*E,G=((m.y+U)*l.width+m.x)*E;for(let q=0;q<v.width*E;q++)F[G+q]=T[Q+q]}return l}class Zm{constructor(l,h){QE(this,l,1,h)}resize(l){wN(this,l,1)}clone(){return new Zm({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,h,m,v,E){zE(l,h,m,v,E,1)}}class Za{constructor(l,h){QE(this,l,4,h)}resize(l){wN(this,l,4)}replace(l,h){h?this.data.set(l):this.data=l instanceof Uint8ClampedArray?new Uint8Array(l.buffer):l}clone(){return new Za({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,h,m,v,E){zE(l,h,m,v,E,4)}}function xN(u){const l={},h=u.resolution||256,m=u.clips?u.clips.length:1,v=u.image||new Za({width:h,height:m});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const E=(T,F,U)=>{l[u.evaluationKey]=U;const Q=u.expression.evaluate(l);v.data[T+F+0]=Math.floor(255*Q.r/Q.a),v.data[T+F+1]=Math.floor(255*Q.g/Q.a),v.data[T+F+2]=Math.floor(255*Q.b/Q.a),v.data[T+F+3]=Math.floor(255*Q.a)};if(u.clips)for(let T=0,F=0;T<m;++T,F+=4*h)for(let U=0,Q=0;U<h;U++,Q+=4){const G=U/(h-1),{start:q,end:J}=u.clips[T];E(F,Q,q*(1-G)+J*G)}else for(let T=0,F=0;T<h;T++,F+=4)E(0,F,T/(h-1));return v}je("AlphaImage",Zm),je("RGBAImage",Za);class gbt extends g{createBucket(l){return new vN(l)}constructor(l){super(l,pbt),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=xN({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let BN;var mbt={get paint(){return BN=BN||new _({"hillshade-illumination-direction":new ur(st.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ur(st.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ur(st.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ur(st.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ur(st.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ur(st.paint_hillshade["hillshade-accent-color"])})}};class ybt extends g{constructor(l){super(l,mbt)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const _bt=L([{name:"a_pos",components:2,type:"Int16"}],4),{members:vbt}=_bt;var HE={exports:{}};function W_(u,l,h){h=h||2;var m,v,E,T,F,U,Q,G=l&&l.length,q=G?l[0]*h:u.length,J=CN(u,0,q,h,!0),rt=[];if(!J||J.next===J.prev)return rt;if(G&&(J=function(_t,St,Rt,Xt){var Qt,qt,Ae,Be=[];for(Qt=0,qt=St.length;Qt<qt;Qt++)(Ae=CN(_t,St[Qt]*Xt,Qt<qt-1?St[Qt+1]*Xt:_t.length,Xt,!1))===Ae.next&&(Ae.steiner=!0),Be.push(Tbt(Ae));for(Be.sort(Cbt),Qt=0;Qt<Be.length;Qt++)Rt=Ebt(Be[Qt],Rt);return Rt}(u,l,J,h)),u.length>80*h){m=E=u[0],v=T=u[1];for(var ut=h;ut<q;ut+=h)(F=u[ut])<m&&(m=F),(U=u[ut+1])<v&&(v=U),F>E&&(E=F),U>T&&(T=U);Q=(Q=Math.max(E-m,T-v))!==0?32767/Q:0}return t0(J,rt,h,m,v,Q,0),rt}function CN(u,l,h,m,v){var E,T;if(v===jE(u,l,h,m)>0)for(E=l;E<h;E+=m)T=TN(E,u[E],u[E+1],T);else for(E=h-m;E>=l;E-=m)T=TN(E,u[E],u[E+1],T);return T&&X_(T,T.next)&&(r0(T),T=T.next),T}function Gd(u,l){if(!u)return u;l||(l=u);var h,m=u;do if(h=!1,m.steiner||!X_(m,m.next)&&Ri(m.prev,m,m.next)!==0)m=m.next;else{if(r0(m),(m=l=m.prev)===m.next)break;h=!0}while(h||m!==l);return l}function t0(u,l,h,m,v,E,T){if(u){!T&&E&&function(G,q,J,rt){var ut=G;do ut.z===0&&(ut.z=VE(ut.x,ut.y,q,J,rt)),ut.prevZ=ut.prev,ut.nextZ=ut.next,ut=ut.next;while(ut!==G);ut.prevZ.nextZ=null,ut.prevZ=null,function(_t){var St,Rt,Xt,Qt,qt,Ae,Be,qe,wr=1;do{for(Rt=_t,_t=null,qt=null,Ae=0;Rt;){for(Ae++,Xt=Rt,Be=0,St=0;St<wr&&(Be++,Xt=Xt.nextZ);St++);for(qe=wr;Be>0||qe>0&&Xt;)Be!==0&&(qe===0||!Xt||Rt.z<=Xt.z)?(Qt=Rt,Rt=Rt.nextZ,Be--):(Qt=Xt,Xt=Xt.nextZ,qe--),qt?qt.nextZ=Qt:_t=Qt,Qt.prevZ=qt,qt=Qt;Rt=Xt}qt.nextZ=null,wr*=2}while(Ae>1)}(ut)}(u,m,v,E);for(var F,U,Q=u;u.prev!==u.next;)if(F=u.prev,U=u.next,E?wbt(u,m,v,E):bbt(u))l.push(F.i/h|0),l.push(u.i/h|0),l.push(U.i/h|0),r0(u),u=U.next,Q=U.next;else if((u=U)===Q){T?T===1?t0(u=xbt(Gd(u),l,h),l,h,m,v,E,2):T===2&&Bbt(u,l,h,m,v,E):t0(Gd(u),l,h,m,v,E,1);break}}}function bbt(u){var l=u.prev,h=u,m=u.next;if(Ri(l,h,m)>=0)return!1;for(var v=l.x,E=h.x,T=m.x,F=l.y,U=h.y,Q=m.y,G=v<E?v<T?v:T:E<T?E:T,q=F<U?F<Q?F:Q:U<Q?U:Q,J=v>E?v>T?v:T:E>T?E:T,rt=F>U?F>Q?F:Q:U>Q?U:Q,ut=m.next;ut!==l;){if(ut.x>=G&&ut.x<=J&&ut.y>=q&&ut.y<=rt&&Tp(v,F,E,U,T,Q,ut.x,ut.y)&&Ri(ut.prev,ut,ut.next)>=0)return!1;ut=ut.next}return!0}function wbt(u,l,h,m){var v=u.prev,E=u,T=u.next;if(Ri(v,E,T)>=0)return!1;for(var F=v.x,U=E.x,Q=T.x,G=v.y,q=E.y,J=T.y,rt=F<U?F<Q?F:Q:U<Q?U:Q,ut=G<q?G<J?G:J:q<J?q:J,_t=F>U?F>Q?F:Q:U>Q?U:Q,St=G>q?G>J?G:J:q>J?q:J,Rt=VE(rt,ut,l,h,m),Xt=VE(_t,St,l,h,m),Qt=u.prevZ,qt=u.nextZ;Qt&&Qt.z>=Rt&&qt&&qt.z<=Xt;){if(Qt.x>=rt&&Qt.x<=_t&&Qt.y>=ut&&Qt.y<=St&&Qt!==v&&Qt!==T&&Tp(F,G,U,q,Q,J,Qt.x,Qt.y)&&Ri(Qt.prev,Qt,Qt.next)>=0||(Qt=Qt.prevZ,qt.x>=rt&&qt.x<=_t&&qt.y>=ut&&qt.y<=St&&qt!==v&&qt!==T&&Tp(F,G,U,q,Q,J,qt.x,qt.y)&&Ri(qt.prev,qt,qt.next)>=0))return!1;qt=qt.nextZ}for(;Qt&&Qt.z>=Rt;){if(Qt.x>=rt&&Qt.x<=_t&&Qt.y>=ut&&Qt.y<=St&&Qt!==v&&Qt!==T&&Tp(F,G,U,q,Q,J,Qt.x,Qt.y)&&Ri(Qt.prev,Qt,Qt.next)>=0)return!1;Qt=Qt.prevZ}for(;qt&&qt.z<=Xt;){if(qt.x>=rt&&qt.x<=_t&&qt.y>=ut&&qt.y<=St&&qt!==v&&qt!==T&&Tp(F,G,U,q,Q,J,qt.x,qt.y)&&Ri(qt.prev,qt,qt.next)>=0)return!1;qt=qt.nextZ}return!0}function xbt(u,l,h){var m=u;do{var v=m.prev,E=m.next.next;!X_(v,E)&&EN(v,m,m.next,E)&&e0(v,E)&&e0(E,v)&&(l.push(v.i/h|0),l.push(m.i/h|0),l.push(E.i/h|0),r0(m),r0(m.next),m=u=E),m=m.next}while(m!==u);return Gd(m)}function Bbt(u,l,h,m,v,E){var T=u;do{for(var F=T.next.next;F!==T.prev;){if(T.i!==F.i&&Ibt(T,F)){var U=SN(T,F);return T=Gd(T,T.next),U=Gd(U,U.next),t0(T,l,h,m,v,E,0),void t0(U,l,h,m,v,E,0)}F=F.next}T=T.next}while(T!==u)}function Cbt(u,l){return u.x-l.x}function Ebt(u,l){var h=function(v,E){var T,F=E,U=v.x,Q=v.y,G=-1/0;do{if(Q<=F.y&&Q>=F.next.y&&F.next.y!==F.y){var q=F.x+(Q-F.y)*(F.next.x-F.x)/(F.next.y-F.y);if(q<=U&&q>G&&(G=q,T=F.x<F.next.x?F:F.next,q===U))return T}F=F.next}while(F!==E);if(!T)return null;var J,rt=T,ut=T.x,_t=T.y,St=1/0;F=T;do U>=F.x&&F.x>=ut&&U!==F.x&&Tp(Q<_t?U:G,Q,ut,_t,Q<_t?G:U,Q,F.x,F.y)&&(J=Math.abs(Q-F.y)/(U-F.x),e0(F,v)&&(J<St||J===St&&(F.x>T.x||F.x===T.x&&Sbt(T,F)))&&(T=F,St=J)),F=F.next;while(F!==rt);return T}(u,l);if(!h)return l;var m=SN(h,u);return Gd(m,m.next),Gd(h,h.next)}function Sbt(u,l){return Ri(u.prev,u,l.prev)<0&&Ri(l.next,u,u.next)<0}function VE(u,l,h,m,v){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-h)*v|0)|u<<8))|u<<4))|u<<2))|u<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-m)*v|0)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function Tbt(u){var l=u,h=u;do(l.x<h.x||l.x===h.x&&l.y<h.y)&&(h=l),l=l.next;while(l!==u);return h}function Tp(u,l,h,m,v,E,T,F){return(v-T)*(l-F)>=(u-T)*(E-F)&&(u-T)*(m-F)>=(h-T)*(l-F)&&(h-T)*(E-F)>=(v-T)*(m-F)}function Ibt(u,l){return u.next.i!==l.i&&u.prev.i!==l.i&&!function(h,m){var v=h;do{if(v.i!==h.i&&v.next.i!==h.i&&v.i!==m.i&&v.next.i!==m.i&&EN(v,v.next,h,m))return!0;v=v.next}while(v!==h);return!1}(u,l)&&(e0(u,l)&&e0(l,u)&&function(h,m){var v=h,E=!1,T=(h.x+m.x)/2,F=(h.y+m.y)/2;do v.y>F!=v.next.y>F&&v.next.y!==v.y&&T<(v.next.x-v.x)*(F-v.y)/(v.next.y-v.y)+v.x&&(E=!E),v=v.next;while(v!==h);return E}(u,l)&&(Ri(u.prev,u,l.prev)||Ri(u,l.prev,l))||X_(u,l)&&Ri(u.prev,u,u.next)>0&&Ri(l.prev,l,l.next)>0)}function Ri(u,l,h){return(l.y-u.y)*(h.x-l.x)-(l.x-u.x)*(h.y-l.y)}function X_(u,l){return u.x===l.x&&u.y===l.y}function EN(u,l,h,m){var v=Y_(Ri(u,l,h)),E=Y_(Ri(u,l,m)),T=Y_(Ri(h,m,u)),F=Y_(Ri(h,m,l));return v!==E&&T!==F||!(v!==0||!J_(u,h,l))||!(E!==0||!J_(u,m,l))||!(T!==0||!J_(h,u,m))||!(F!==0||!J_(h,l,m))}function J_(u,l,h){return l.x<=Math.max(u.x,h.x)&&l.x>=Math.min(u.x,h.x)&&l.y<=Math.max(u.y,h.y)&&l.y>=Math.min(u.y,h.y)}function Y_(u){return u>0?1:u<0?-1:0}function e0(u,l){return Ri(u.prev,u,u.next)<0?Ri(u,l,u.next)>=0&&Ri(u,u.prev,l)>=0:Ri(u,l,u.prev)<0||Ri(u,u.next,l)<0}function SN(u,l){var h=new GE(u.i,u.x,u.y),m=new GE(l.i,l.x,l.y),v=u.next,E=l.prev;return u.next=l,l.prev=u,h.next=v,v.prev=h,m.next=h,h.prev=m,E.next=m,m.prev=E,m}function TN(u,l,h,m){var v=new GE(u,l,h);return m?(v.next=m.next,v.prev=m,m.next.prev=v,m.next=v):(v.prev=v,v.next=v),v}function r0(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function GE(u,l,h){this.i=u,this.x=l,this.y=h,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function jE(u,l,h,m){for(var v=0,E=l,T=h-m;E<h;E+=m)v+=(u[T]-u[E])*(u[E+1]+u[T+1]),T=E;return v}HE.exports=W_,HE.exports.default=W_,W_.deviation=function(u,l,h,m){var v=l&&l.length,E=Math.abs(jE(u,0,v?l[0]*h:u.length,h));if(v)for(var T=0,F=l.length;T<F;T++)E-=Math.abs(jE(u,l[T]*h,T<F-1?l[T+1]*h:u.length,h));var U=0;for(T=0;T<m.length;T+=3){var Q=m[T]*h,G=m[T+1]*h,q=m[T+2]*h;U+=Math.abs((u[Q]-u[q])*(u[G+1]-u[Q+1])-(u[Q]-u[G])*(u[q+1]-u[Q+1]))}return E===0&&U===0?0:Math.abs((U-E)/E)},W_.flatten=function(u){for(var l=u[0][0].length,h={vertices:[],holes:[],dimensions:l},m=0,v=0;v<u.length;v++){for(var E=0;E<u[v].length;E++)for(var T=0;T<l;T++)h.vertices.push(u[v][E][T]);v>0&&h.holes.push(m+=u[v-1].length)}return h};var IN=d(HE.exports);function qE(u,l,h){const m=h.patternDependencies;let v=!1;for(const E of l){const T=E.paint.get(`${u}-pattern`);T.isConstant()||(v=!0);const F=T.constantOr(null);F&&(v=!0,m[F.to]=!0,m[F.from]=!0)}return v}function KE(u,l,h,m,v){const E=v.patternDependencies;for(const T of l){const F=T.paint.get(`${u}-pattern`).value;if(F.kind!=="constant"){let U=F.evaluate({zoom:m-1},h,{},v.availableImages),Q=F.evaluate({zoom:m},h,{},v.availableImages),G=F.evaluate({zoom:m+1},h,{},v.availableImages);U=U&&U.name?U.name:U,Q=Q&&Q.name?Q.name:Q,G=G&&G.name?G.name:G,E[U]=!0,E[Q]=!0,E[G]=!0,h.patterns[T.id]={min:U,mid:Q,max:G}}}return h}class $E{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(h=>h.id),this.index=l.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new pi,this.indexArray=new wi,this.indexArray2=new Gn,this.programConfigurations=new Pc(l.layers,l.zoom),this.segments=new li,this.segments2=new li,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(l,h,m){this.hasPattern=qE("fill",this.layers,h);const v=this.layers[0].layout.get("fill-sort-key"),E=!v.isConstant(),T=[];for(const{feature:F,id:U,index:Q,sourceLayerIndex:G}of l){const q=this.layers[0]._featureFilter.needGeometry,J=wA(F,q);if(!this.layers[0]._featureFilter.filter(new Un(this.zoom),J,m))continue;const rt=E?v.evaluate(J,{},m,h.availableImages):void 0,ut={id:U,properties:F.properties,type:F.type,sourceLayerIndex:G,index:Q,geometry:q?J.geometry:ba(F),patterns:{},sortKey:rt};T.push(ut)}E&&T.sort((F,U)=>F.sortKey-U.sortKey);for(const F of T){const{geometry:U,index:Q,sourceLayerIndex:G}=F;if(this.hasPattern){const q=KE("fill",this.layers,F,this.zoom,h);this.patternFeatures.push(q)}else this.addFeature(F,U,Q,m,{});h.featureIndex.insert(l[Q].feature,U,Q,G,this.index)}}update(l,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,m)}addFeatures(l,h,m){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,h,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,vbt),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.indexBuffer2=l.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(l,h,m,v,E){for(const T of wl(h,500)){let F=0;for(const rt of T)F+=rt.length;const U=this.segments.prepareSegment(F,this.layoutVertexArray,this.indexArray),Q=U.vertexLength,G=[],q=[];for(const rt of T){if(rt.length===0)continue;rt!==T[0]&&q.push(G.length/2);const ut=this.segments2.prepareSegment(rt.length,this.layoutVertexArray,this.indexArray2),_t=ut.vertexLength;this.layoutVertexArray.emplaceBack(rt[0].x,rt[0].y),this.indexArray2.emplaceBack(_t+rt.length-1,_t),G.push(rt[0].x),G.push(rt[0].y);for(let St=1;St<rt.length;St++)this.layoutVertexArray.emplaceBack(rt[St].x,rt[St].y),this.indexArray2.emplaceBack(_t+St-1,_t+St),G.push(rt[St].x),G.push(rt[St].y);ut.vertexLength+=rt.length,ut.primitiveLength+=rt.length}const J=IN(G,q);for(let rt=0;rt<J.length;rt+=3)this.indexArray.emplaceBack(Q+J[rt],Q+J[rt+1],Q+J[rt+2]);U.vertexLength+=F,U.primitiveLength+=J.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,m,E,v)}}let FN,LN;je("FillBucket",$E,{omit:["layers","patternFeatures"]});var Fbt={get paint(){return LN=LN||new _({"fill-antialias":new ur(st.paint_fill["fill-antialias"]),"fill-opacity":new Er(st.paint_fill["fill-opacity"]),"fill-color":new Er(st.paint_fill["fill-color"]),"fill-outline-color":new Er(st.paint_fill["fill-outline-color"]),"fill-translate":new ur(st.paint_fill["fill-translate"]),"fill-translate-anchor":new ur(st.paint_fill["fill-translate-anchor"]),"fill-pattern":new S(st.paint_fill["fill-pattern"])})},get layout(){return FN=FN||new _({"fill-sort-key":new Er(st.layout_fill["fill-sort-key"])})}};class Lbt extends g{constructor(l){super(l,Fbt)}recalculate(l,h){super.recalculate(l,h);const m=this.paint._values["fill-outline-color"];m.value.kind==="constant"&&m.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new $E(l)}queryRadius(){return Eh(this.paint.get("fill-translate"))}queryIntersectsFeature(l,h,m,v,E,T,F){return Bh(Sh(l,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),T.angle,F),v)}isTileClipped(){return!0}}const Pbt=L([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Mbt=L([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Ubt}=Pbt;var Th={},Rbt=p,PN=Ip;function Ip(u,l,h,m,v){this.properties={},this.extent=h,this.type=0,this._pbf=u,this._geometry=-1,this._keys=m,this._values=v,u.readFields(Obt,this,l)}function Obt(u,l,h){u==1?l.id=h.readVarint():u==2?function(m,v){for(var E=m.readVarint()+m.pos;m.pos<E;){var T=v._keys[m.readVarint()],F=v._values[m.readVarint()];v.properties[T]=F}}(h,l):u==3?l.type=h.readVarint():u==4&&(l._geometry=h.pos)}function Dbt(u){for(var l,h,m=0,v=0,E=u.length,T=E-1;v<E;T=v++)m+=((h=u[T]).x-(l=u[v]).x)*(l.y+h.y);return m}Ip.types=["Unknown","Point","LineString","Polygon"],Ip.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var l,h=u.readVarint()+u.pos,m=1,v=0,E=0,T=0,F=[];u.pos<h;){if(v<=0){var U=u.readVarint();m=7&U,v=U>>3}if(v--,m===1||m===2)E+=u.readSVarint(),T+=u.readSVarint(),m===1&&(l&&F.push(l),l=[]),l.push(new Rbt(E,T));else{if(m!==7)throw new Error("unknown command "+m);l&&l.push(l[0].clone())}}return l&&F.push(l),F},Ip.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var l=u.readVarint()+u.pos,h=1,m=0,v=0,E=0,T=1/0,F=-1/0,U=1/0,Q=-1/0;u.pos<l;){if(m<=0){var G=u.readVarint();h=7&G,m=G>>3}if(m--,h===1||h===2)(v+=u.readSVarint())<T&&(T=v),v>F&&(F=v),(E+=u.readSVarint())<U&&(U=E),E>Q&&(Q=E);else if(h!==7)throw new Error("unknown command "+h)}return[T,U,F,Q]},Ip.prototype.toGeoJSON=function(u,l,h){var m,v,E=this.extent*Math.pow(2,h),T=this.extent*u,F=this.extent*l,U=this.loadGeometry(),Q=Ip.types[this.type];function G(rt){for(var ut=0;ut<rt.length;ut++){var _t=rt[ut];rt[ut]=[360*(_t.x+T)/E-180,360/Math.PI*Math.atan(Math.exp((180-360*(_t.y+F)/E)*Math.PI/180))-90]}}switch(this.type){case 1:var q=[];for(m=0;m<U.length;m++)q[m]=U[m][0];G(U=q);break;case 2:for(m=0;m<U.length;m++)G(U[m]);break;case 3:for(U=function(rt){var ut=rt.length;if(ut<=1)return[rt];for(var _t,St,Rt=[],Xt=0;Xt<ut;Xt++){var Qt=Dbt(rt[Xt]);Qt!==0&&(St===void 0&&(St=Qt<0),St===Qt<0?(_t&&Rt.push(_t),_t=[rt[Xt]]):_t.push(rt[Xt]))}return _t&&Rt.push(_t),Rt}(U),m=0;m<U.length;m++)for(v=0;v<U[m].length;v++)G(U[m][v])}U.length===1?U=U[0]:Q="Multi"+Q;var J={type:"Feature",geometry:{type:Q,coordinates:U},properties:this.properties};return"id"in this&&(J.id=this.id),J};var Nbt=PN,MN=UN;function UN(u,l){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(kbt,this,l),this.length=this._features.length}function kbt(u,l,h){u===15?l.version=h.readVarint():u===1?l.name=h.readString():u===5?l.extent=h.readVarint():u===2?l._features.push(h.pos):u===3?l._keys.push(h.readString()):u===4&&l._values.push(function(m){for(var v=null,E=m.readVarint()+m.pos;m.pos<E;){var T=m.readVarint()>>3;v=T===1?m.readString():T===2?m.readFloat():T===3?m.readDouble():T===4?m.readVarint64():T===5?m.readVarint():T===6?m.readSVarint():T===7?m.readBoolean():null}return v}(h))}UN.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var l=this._pbf.readVarint()+this._pbf.pos;return new Nbt(this._pbf,l,this.extent,this._keys,this._values)};var Qbt=MN;function zbt(u,l,h){if(u===3){var m=new Qbt(h,h.readVarint()+h.pos);m.length&&(l[m.name]=m)}}Th.VectorTile=function(u,l){this.layers=u.readFields(zbt,{},l)},Th.VectorTileFeature=PN,Th.VectorTileLayer=MN;const Hbt=Th.VectorTileFeature.types,WE=Math.pow(2,13);function n0(u,l,h,m,v,E,T,F){u.emplaceBack(l,h,2*Math.floor(m*WE)+T,v*WE*2,E*WE*2,Math.round(F))}class XE{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(h=>h.id),this.index=l.index,this.hasPattern=!1,this.layoutVertexArray=new Is,this.centroidVertexArray=new Gi,this.indexArray=new wi,this.programConfigurations=new Pc(l.layers,l.zoom),this.segments=new li,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(l,h,m){this.features=[],this.hasPattern=qE("fill-extrusion",this.layers,h);for(const{feature:v,id:E,index:T,sourceLayerIndex:F}of l){const U=this.layers[0]._featureFilter.needGeometry,Q=wA(v,U);if(!this.layers[0]._featureFilter.filter(new Un(this.zoom),Q,m))continue;const G={id:E,sourceLayerIndex:F,index:T,geometry:U?Q.geometry:ba(v),properties:v.properties,type:v.type,patterns:{}};this.hasPattern?this.features.push(KE("fill-extrusion",this.layers,G,this.zoom,h)):this.addFeature(G,G.geometry,T,m,{}),h.featureIndex.insert(v,G.geometry,T,F,this.index,!0)}}addFeatures(l,h,m){for(const v of this.features){const{geometry:E}=v;this.addFeature(v,E,v.index,h,m)}}update(l,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,m)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Ubt),this.centroidVertexBuffer=l.createVertexBuffer(this.centroidVertexArray,Mbt.members,!0),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(l,h,m,v,E){for(const T of wl(h,500)){const F={x:0,y:0,vertexCount:0};let U=0;for(const ut of T)U+=ut.length;let Q=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const ut of T){if(ut.length===0||Gbt(ut))continue;let _t=0;for(let St=0;St<ut.length;St++){const Rt=ut[St];if(St>=1){const Xt=ut[St-1];if(!Vbt(Rt,Xt)){Q.vertexLength+4>li.MAX_VERTEX_ARRAY_LENGTH&&(Q=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Qt=Rt.sub(Xt)._perp()._unit(),qt=Xt.dist(Rt);_t+qt>32768&&(_t=0),n0(this.layoutVertexArray,Rt.x,Rt.y,Qt.x,Qt.y,0,0,_t),n0(this.layoutVertexArray,Rt.x,Rt.y,Qt.x,Qt.y,0,1,_t),F.x+=2*Rt.x,F.y+=2*Rt.y,F.vertexCount+=2,_t+=qt,n0(this.layoutVertexArray,Xt.x,Xt.y,Qt.x,Qt.y,0,0,_t),n0(this.layoutVertexArray,Xt.x,Xt.y,Qt.x,Qt.y,0,1,_t),F.x+=2*Xt.x,F.y+=2*Xt.y,F.vertexCount+=2;const Ae=Q.vertexLength;this.indexArray.emplaceBack(Ae,Ae+2,Ae+1),this.indexArray.emplaceBack(Ae+1,Ae+2,Ae+3),Q.vertexLength+=4,Q.primitiveLength+=2}}}}if(Q.vertexLength+U>li.MAX_VERTEX_ARRAY_LENGTH&&(Q=this.segments.prepareSegment(U,this.layoutVertexArray,this.indexArray)),Hbt[l.type]!=="Polygon")continue;const G=[],q=[],J=Q.vertexLength;for(const ut of T)if(ut.length!==0){ut!==T[0]&&q.push(G.length/2);for(let _t=0;_t<ut.length;_t++){const St=ut[_t];n0(this.layoutVertexArray,St.x,St.y,0,0,1,1,0),F.x+=St.x,F.y+=St.y,F.vertexCount+=1,G.push(St.x),G.push(St.y)}}const rt=IN(G,q);for(let ut=0;ut<rt.length;ut+=3)this.indexArray.emplaceBack(J+rt[ut],J+rt[ut+2],J+rt[ut+1]);Q.primitiveLength+=rt.length/3,Q.vertexLength+=U;for(let ut=0;ut<F.vertexCount;ut++){const _t=Math.floor(F.x/F.vertexCount),St=Math.floor(F.y/F.vertexCount);this.centroidVertexArray.emplaceBack(_t,St)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,m,E,v)}}function Vbt(u,l){return u.x===l.x&&(u.x<0||u.x>Ci)||u.y===l.y&&(u.y<0||u.y>Ci)}function Gbt(u){return u.every(l=>l.x<0)||u.every(l=>l.x>Ci)||u.every(l=>l.y<0)||u.every(l=>l.y>Ci)}let RN;je("FillExtrusionBucket",XE,{omit:["layers","features"]});var jbt={get paint(){return RN=RN||new _({"fill-extrusion-opacity":new ur(st["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Er(st["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ur(st["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ur(st["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new S(st["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Er(st["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Er(st["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ur(st["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class qbt extends g{constructor(l){super(l,jbt)}createBucket(l){return new XE(l)}queryRadius(){return Eh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(l,h,m,v,E,T,F,U){const Q=Sh(l,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),T.angle,F),G=this.paint.get("fill-extrusion-height").evaluate(h,m),q=this.paint.get("fill-extrusion-base").evaluate(h,m),J=function(ut,_t,St,Rt){const Xt=[];for(const Qt of ut){const qt=[Qt.x,Qt.y,0,1];$_(qt,qt,_t),Xt.push(new b(qt[0]/qt[3],qt[1]/qt[3]))}return Xt}(Q,U),rt=function(ut,_t,St,Rt){const Xt=[],Qt=[],qt=Rt[8]*_t,Ae=Rt[9]*_t,Be=Rt[10]*_t,qe=Rt[11]*_t,wr=Rt[8]*St,Ke=Rt[9]*St,Ve=Rt[10]*St,dr=Rt[11]*St;for(const sr of ut){const rr=[],ye=[];for(const mr of sr){const Ar=mr.x,Nr=mr.y,Jn=Rt[0]*Ar+Rt[4]*Nr+Rt[12],qn=Rt[1]*Ar+Rt[5]*Nr+Rt[13],fs=Rt[2]*Ar+Rt[6]*Nr+Rt[14],Gl=Rt[3]*Ar+Rt[7]*Nr+Rt[15],zs=fs+Be,Li=Gl+qe,So=Jn+wr,To=qn+Ke,Io=fs+Ve,Pi=Gl+dr,ps=new b((Jn+qt)/Li,(qn+Ae)/Li);ps.z=zs/Li,rr.push(ps);const io=new b(So/Pi,To/Pi);io.z=Io/Pi,ye.push(io)}Xt.push(rr),Qt.push(ye)}return[Xt,Qt]}(v,q,G,U);return function(ut,_t,St){let Rt=1/0;Bh(St,_t)&&(Rt=ON(St,_t[0]));for(let Xt=0;Xt<_t.length;Xt++){const Qt=_t[Xt],qt=ut[Xt];for(let Ae=0;Ae<Qt.length-1;Ae++){const Be=Qt[Ae],qe=[Be,Qt[Ae+1],qt[Ae+1],qt[Ae],Be];Xm(St,qe)&&(Rt=Math.min(Rt,ON(St,qe)))}}return Rt!==1/0&&Rt}(rt[0],rt[1],J)}}function i0(u,l){return u.x*l.x+u.y*l.y}function ON(u,l){if(u.length===1){let h=0;const m=l[h++];let v;for(;!v||m.equals(v);)if(v=l[h++],!v)return 1/0;for(;h<l.length;h++){const E=l[h],T=u[0],F=v.sub(m),U=E.sub(m),Q=T.sub(m),G=i0(F,F),q=i0(F,U),J=i0(U,U),rt=i0(Q,F),ut=i0(Q,U),_t=G*J-q*q,St=(J*rt-q*ut)/_t,Rt=(G*ut-q*rt)/_t,Xt=m.z*(1-St-Rt)+v.z*St+E.z*Rt;if(isFinite(Xt))return Xt}return 1/0}{let h=1/0;for(const m of l)h=Math.min(h,m.z);return h}}const Kbt=L([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:$bt}=Kbt,Wbt=L([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Xbt}=Wbt,Jbt=Th.VectorTileFeature.types,Ybt=Math.cos(Math.PI/180*37.5),DN=Math.pow(2,14)/.5;class JE{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(h=>h.id),this.index=l.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new _a,this.layoutVertexArray2=new Nl,this.indexArray=new wi,this.programConfigurations=new Pc(l.layers,l.zoom),this.segments=new li,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(l,h,m){this.hasPattern=qE("line",this.layers,h);const v=this.layers[0].layout.get("line-sort-key"),E=!v.isConstant(),T=[];for(const{feature:F,id:U,index:Q,sourceLayerIndex:G}of l){const q=this.layers[0]._featureFilter.needGeometry,J=wA(F,q);if(!this.layers[0]._featureFilter.filter(new Un(this.zoom),J,m))continue;const rt=E?v.evaluate(J,{},m):void 0,ut={id:U,properties:F.properties,type:F.type,sourceLayerIndex:G,index:Q,geometry:q?J.geometry:ba(F),patterns:{},sortKey:rt};T.push(ut)}E&&T.sort((F,U)=>F.sortKey-U.sortKey);for(const F of T){const{geometry:U,index:Q,sourceLayerIndex:G}=F;if(this.hasPattern){const q=KE("line",this.layers,F,this.zoom,h);this.patternFeatures.push(q)}else this.addFeature(F,U,Q,m,{});h.featureIndex.insert(l[Q].feature,U,Q,G,this.index)}}update(l,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,m)}addFeatures(l,h,m){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,h,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=l.createVertexBuffer(this.layoutVertexArray2,Xbt)),this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,$bt),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(l){if(l.properties&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_end"))return{start:+l.properties.mapbox_clip_start,end:+l.properties.mapbox_clip_end}}addFeature(l,h,m,v,E){const T=this.layers[0].layout,F=T.get("line-join").evaluate(l,{}),U=T.get("line-cap"),Q=T.get("line-miter-limit"),G=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(l);for(const q of h)this.addLine(q,l,F,U,Q,G);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,m,E,v)}addLine(l,h,m,v,E,T){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Rt=0;Rt<l.length-1;Rt++)this.totalDistance+=l[Rt].dist(l[Rt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const F=Jbt[h.type]==="Polygon";let U=l.length;for(;U>=2&&l[U-1].equals(l[U-2]);)U--;let Q=0;for(;Q<U-1&&l[Q].equals(l[Q+1]);)Q++;if(U<(F?3:2))return;m==="bevel"&&(E=1.05);const G=this.overscaling<=16?15*Ci/(512*this.overscaling):0,q=this.segments.prepareSegment(10*U,this.layoutVertexArray,this.indexArray);let J,rt,ut,_t,St;this.e1=this.e2=-1,F&&(J=l[U-2],St=l[Q].sub(J)._unit()._perp());for(let Rt=Q;Rt<U;Rt++){if(ut=Rt===U-1?F?l[Q+1]:void 0:l[Rt+1],ut&&l[Rt].equals(ut))continue;St&&(_t=St),J&&(rt=J),J=l[Rt],St=ut?ut.sub(J)._unit()._perp():_t,_t=_t||St;let Xt=_t.add(St);Xt.x===0&&Xt.y===0||Xt._unit();const Qt=_t.x*St.x+_t.y*St.y,qt=Xt.x*St.x+Xt.y*St.y,Ae=qt!==0?1/qt:1/0,Be=2*Math.sqrt(2-2*qt),qe=qt<Ybt&&rt&&ut,wr=_t.x*St.y-_t.y*St.x>0;if(qe&&Rt>Q){const dr=J.dist(rt);if(dr>2*G){const sr=J.sub(J.sub(rt)._mult(G/dr)._round());this.updateDistance(rt,sr),this.addCurrentVertex(sr,_t,0,0,q),rt=sr}}const Ke=rt&&ut;let Ve=Ke?m:F?"butt":v;if(Ke&&Ve==="round"&&(Ae<T?Ve="miter":Ae<=2&&(Ve="fakeround")),Ve==="miter"&&Ae>E&&(Ve="bevel"),Ve==="bevel"&&(Ae>2&&(Ve="flipbevel"),Ae<E&&(Ve="miter")),rt&&this.updateDistance(rt,J),Ve==="miter")Xt._mult(Ae),this.addCurrentVertex(J,Xt,0,0,q);else if(Ve==="flipbevel"){if(Ae>100)Xt=St.mult(-1);else{const dr=Ae*_t.add(St).mag()/_t.sub(St).mag();Xt._perp()._mult(dr*(wr?-1:1))}this.addCurrentVertex(J,Xt,0,0,q),this.addCurrentVertex(J,Xt.mult(-1),0,0,q)}else if(Ve==="bevel"||Ve==="fakeround"){const dr=-Math.sqrt(Ae*Ae-1),sr=wr?dr:0,rr=wr?0:dr;if(rt&&this.addCurrentVertex(J,_t,sr,rr,q),Ve==="fakeround"){const ye=Math.round(180*Be/Math.PI/20);for(let mr=1;mr<ye;mr++){let Ar=mr/ye;if(Ar!==.5){const Jn=Ar-.5;Ar+=Ar*Jn*(Ar-1)*((1.0904+Qt*(Qt*(3.55645-1.43519*Qt)-3.2452))*Jn*Jn+(.848013+Qt*(.215638*Qt-1.06021)))}const Nr=St.sub(_t)._mult(Ar)._add(_t)._unit()._mult(wr?-1:1);this.addHalfVertex(J,Nr.x,Nr.y,!1,wr,0,q)}}ut&&this.addCurrentVertex(J,St,-sr,-rr,q)}else if(Ve==="butt")this.addCurrentVertex(J,Xt,0,0,q);else if(Ve==="square"){const dr=rt?1:-1;this.addCurrentVertex(J,Xt,dr,dr,q)}else Ve==="round"&&(rt&&(this.addCurrentVertex(J,_t,0,0,q),this.addCurrentVertex(J,_t,1,1,q,!0)),ut&&(this.addCurrentVertex(J,St,-1,-1,q,!0),this.addCurrentVertex(J,St,0,0,q)));if(qe&&Rt<U-1){const dr=J.dist(ut);if(dr>2*G){const sr=J.add(ut.sub(J)._mult(G/dr)._round());this.updateDistance(J,sr),this.addCurrentVertex(sr,St,0,0,q),J=sr}}}}addCurrentVertex(l,h,m,v,E){let T=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;const F=h.y*v-h.x,U=-h.y-h.x*v;this.addHalfVertex(l,h.x+h.y*m,h.y-h.x*m,T,!1,m,E),this.addHalfVertex(l,F,U,T,!0,-v,E),this.distance>DN/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(l,h,m,v,E,T))}addHalfVertex(l,h,m,v,E,T,F){let{x:U,y:Q}=l;const G=.5*(this.lineClips?this.scaledDistance*(DN-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((U<<1)+(v?1:0),(Q<<1)+(E?1:0),Math.round(63*h)+128,Math.round(63*m)+128,1+(T===0?0:T<0?-1:1)|(63&G)<<2,G>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const q=F.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,q),F.primitiveLength++),E?this.e2=q:this.e1=q}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(l,h){this.distance+=l.dist(h),this.updateScaledDistance()}}let NN,kN;je("LineBucket",JE,{omit:["layers","patternFeatures"]});var QN={get paint(){return kN=kN||new _({"line-opacity":new Er(st.paint_line["line-opacity"]),"line-color":new Er(st.paint_line["line-color"]),"line-translate":new ur(st.paint_line["line-translate"]),"line-translate-anchor":new ur(st.paint_line["line-translate-anchor"]),"line-width":new Er(st.paint_line["line-width"]),"line-gap-width":new Er(st.paint_line["line-gap-width"]),"line-offset":new Er(st.paint_line["line-offset"]),"line-blur":new Er(st.paint_line["line-blur"]),"line-dasharray":new c(st.paint_line["line-dasharray"]),"line-pattern":new S(st.paint_line["line-pattern"]),"line-gradient":new f(st.paint_line["line-gradient"])})},get layout(){return NN=NN||new _({"line-cap":new ur(st.layout_line["line-cap"]),"line-join":new Er(st.layout_line["line-join"]),"line-miter-limit":new ur(st.layout_line["line-miter-limit"]),"line-round-limit":new ur(st.layout_line["line-round-limit"]),"line-sort-key":new Er(st.layout_line["line-sort-key"])})}};class Zbt extends Er{possiblyEvaluate(l,h){return h=new Un(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(l,h)}evaluate(l,h,m,v){return h=mt({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(l,h,m,v)}}let Z_;class twt extends g{constructor(l){super(l,QN),this.gradientVersion=0,Z_||(Z_=new Zbt(QN.paint.properties["line-width"].specification),Z_.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const h=this.gradientExpression();this.stepInterpolant=!!function(m){return m._styleExpression!==void 0}(h)&&h._styleExpression.expression instanceof Ze,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(l,h){super.recalculate(l,h),this.paint._values["line-floorwidth"]=Z_.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new JE(l)}queryRadius(l){const h=l,m=zN(Vd("line-width",this,h),Vd("line-gap-width",this,h)),v=Vd("line-offset",this,h);return m/2+Math.abs(v)+Eh(this.paint.get("line-translate"))}queryIntersectsFeature(l,h,m,v,E,T,F){const U=Sh(l,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),T.angle,F),Q=F/2*zN(this.paint.get("line-width").evaluate(h,m),this.paint.get("line-gap-width").evaluate(h,m)),G=this.paint.get("line-offset").evaluate(h,m);return G&&(v=function(q,J){const rt=[];for(let ut=0;ut<q.length;ut++){const _t=q[ut],St=[];for(let Rt=0;Rt<_t.length;Rt++){const Xt=_t[Rt-1],Qt=_t[Rt],qt=_t[Rt+1],Ae=Rt===0?new b(0,0):Qt.sub(Xt)._unit()._perp(),Be=Rt===_t.length-1?new b(0,0):qt.sub(Qt)._unit()._perp(),qe=Ae._add(Be)._unit(),wr=qe.x*Be.x+qe.y*Be.y;wr!==0&&qe._mult(1/wr),St.push(qe._mult(J)._add(Qt))}rt.push(St)}return rt}(v,G*F)),function(q,J,rt){for(let ut=0;ut<J.length;ut++){const _t=J[ut];if(q.length>=3){for(let St=0;St<_t.length;St++)if(xu(q,_t[St]))return!0}if(Jm(q,_t,rt))return!0}return!1}(U,v,Q)}isTileClipped(){return!0}}function zN(u,l){return l>0?l+2*u:u}const ewt=L([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),rwt=L([{name:"a_projected_pos",components:3,type:"Float32"}],4);L([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const nwt=L([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);L([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const HN=L([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),iwt=L([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function swt(u,l,h){return u.sections.forEach(m=>{m.text=function(v,E,T){const F=E.layout.get("text-transform").evaluate(T,{});return F==="uppercase"?v=v.toLocaleUpperCase():F==="lowercase"&&(v=v.toLocaleLowerCase()),Co.applyArabicShaping&&(v=Co.applyArabicShaping(v)),v}(m.text,l,h)}),u}L([{name:"triangle",components:3,type:"Uint16"}]),L([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),L([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),L([{type:"Float32",name:"offsetX"}]),L([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),L([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const s0={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var ss=24,VN=jn,GN=function(u,l,h,m,v){var E,T,F=8*v-m-1,U=(1<<F)-1,Q=U>>1,G=-7,q=v-1,J=-1,rt=u[l+q];for(q+=J,E=rt&(1<<-G)-1,rt>>=-G,G+=F;G>0;E=256*E+u[l+q],q+=J,G-=8);for(T=E&(1<<-G)-1,E>>=-G,G+=m;G>0;T=256*T+u[l+q],q+=J,G-=8);if(E===0)E=1-Q;else{if(E===U)return T?NaN:1/0*(rt?-1:1);T+=Math.pow(2,m),E-=Q}return(rt?-1:1)*T*Math.pow(2,E-m)},jN=function(u,l,h,m,v,E){var T,F,U,Q=8*E-v-1,G=(1<<Q)-1,q=G>>1,J=v===23?Math.pow(2,-24)-Math.pow(2,-77):0,rt=0,ut=1,_t=l<0||l===0&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(F=isNaN(l)?1:0,T=G):(T=Math.floor(Math.log(l)/Math.LN2),l*(U=Math.pow(2,-T))<1&&(T--,U*=2),(l+=T+q>=1?J/U:J*Math.pow(2,1-q))*U>=2&&(T++,U/=2),T+q>=G?(F=0,T=G):T+q>=1?(F=(l*U-1)*Math.pow(2,v),T+=q):(F=l*Math.pow(2,q-1)*Math.pow(2,v),T=0));v>=8;u[h+rt]=255&F,rt+=ut,F/=256,v-=8);for(T=T<<v|F,Q+=v;Q>0;u[h+rt]=255&T,rt+=ut,T/=256,Q-=8);u[h+rt-ut]|=128*_t};function jn(u){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(u)?u:new Uint8Array(u||0),this.pos=0,this.type=0,this.length=this.buf.length}jn.Varint=0,jn.Fixed64=1,jn.Bytes=2,jn.Fixed32=5;var YE=4294967296,qN=1/YE,KN=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function xA(u){return u.type===jn.Bytes?u.readVarint()+u.pos:u.pos+1}function Fp(u,l,h){return h?4294967296*l+(u>>>0):4294967296*(l>>>0)+(u>>>0)}function $N(u,l,h){var m=l<=16383?1:l<=2097151?2:l<=268435455?3:Math.floor(Math.log(l)/(7*Math.LN2));h.realloc(m);for(var v=h.pos-1;v>=u;v--)h.buf[v+m]=h.buf[v]}function owt(u,l){for(var h=0;h<u.length;h++)l.writeVarint(u[h])}function awt(u,l){for(var h=0;h<u.length;h++)l.writeSVarint(u[h])}function lwt(u,l){for(var h=0;h<u.length;h++)l.writeFloat(u[h])}function cwt(u,l){for(var h=0;h<u.length;h++)l.writeDouble(u[h])}function uwt(u,l){for(var h=0;h<u.length;h++)l.writeBoolean(u[h])}function Awt(u,l){for(var h=0;h<u.length;h++)l.writeFixed32(u[h])}function hwt(u,l){for(var h=0;h<u.length;h++)l.writeSFixed32(u[h])}function dwt(u,l){for(var h=0;h<u.length;h++)l.writeFixed64(u[h])}function fwt(u,l){for(var h=0;h<u.length;h++)l.writeSFixed64(u[h])}function tv(u,l){return(u[l]|u[l+1]<<8|u[l+2]<<16)+16777216*u[l+3]}function Lp(u,l,h){u[h]=l,u[h+1]=l>>>8,u[h+2]=l>>>16,u[h+3]=l>>>24}function WN(u,l){return(u[l]|u[l+1]<<8|u[l+2]<<16)+(u[l+3]<<24)}jn.prototype={destroy:function(){this.buf=null},readFields:function(u,l,h){for(h=h||this.length;this.pos<h;){var m=this.readVarint(),v=m>>3,E=this.pos;this.type=7&m,u(v,l,this),this.pos===E&&this.skip(m)}return l},readMessage:function(u,l){return this.readFields(u,l,this.readVarint()+this.pos)},readFixed32:function(){var u=tv(this.buf,this.pos);return this.pos+=4,u},readSFixed32:function(){var u=WN(this.buf,this.pos);return this.pos+=4,u},readFixed64:function(){var u=tv(this.buf,this.pos)+tv(this.buf,this.pos+4)*YE;return this.pos+=8,u},readSFixed64:function(){var u=tv(this.buf,this.pos)+WN(this.buf,this.pos+4)*YE;return this.pos+=8,u},readFloat:function(){var u=GN(this.buf,this.pos,!0,23,4);return this.pos+=4,u},readDouble:function(){var u=GN(this.buf,this.pos,!0,52,8);return this.pos+=8,u},readVarint:function(u){var l,h,m=this.buf;return l=127&(h=m[this.pos++]),h<128?l:(l|=(127&(h=m[this.pos++]))<<7,h<128?l:(l|=(127&(h=m[this.pos++]))<<14,h<128?l:(l|=(127&(h=m[this.pos++]))<<21,h<128?l:function(v,E,T){var F,U,Q=T.buf;if(F=(112&(U=Q[T.pos++]))>>4,U<128||(F|=(127&(U=Q[T.pos++]))<<3,U<128)||(F|=(127&(U=Q[T.pos++]))<<10,U<128)||(F|=(127&(U=Q[T.pos++]))<<17,U<128)||(F|=(127&(U=Q[T.pos++]))<<24,U<128)||(F|=(1&(U=Q[T.pos++]))<<31,U<128))return Fp(v,F,E);throw new Error("Expected varint not more than 10 bytes")}(l|=(15&(h=m[this.pos]))<<28,u,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var u=this.readVarint();return u%2==1?(u+1)/-2:u/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var u=this.readVarint()+this.pos,l=this.pos;return this.pos=u,u-l>=12&&KN?function(h,m,v){return KN.decode(h.subarray(m,v))}(this.buf,l,u):function(h,m,v){for(var E="",T=m;T<v;){var F,U,Q,G=h[T],q=null,J=G>239?4:G>223?3:G>191?2:1;if(T+J>v)break;J===1?G<128&&(q=G):J===2?(192&(F=h[T+1]))==128&&(q=(31&G)<<6|63&F)<=127&&(q=null):J===3?(U=h[T+2],(192&(F=h[T+1]))==128&&(192&U)==128&&((q=(15&G)<<12|(63&F)<<6|63&U)<=2047||q>=55296&&q<=57343)&&(q=null)):J===4&&(U=h[T+2],Q=h[T+3],(192&(F=h[T+1]))==128&&(192&U)==128&&(192&Q)==128&&((q=(15&G)<<18|(63&F)<<12|(63&U)<<6|63&Q)<=65535||q>=1114112)&&(q=null)),q===null?(q=65533,J=1):q>65535&&(q-=65536,E+=String.fromCharCode(q>>>10&1023|55296),q=56320|1023&q),E+=String.fromCharCode(q),T+=J}return E}(this.buf,l,u)},readBytes:function(){var u=this.readVarint()+this.pos,l=this.buf.subarray(this.pos,u);return this.pos=u,l},readPackedVarint:function(u,l){if(this.type!==jn.Bytes)return u.push(this.readVarint(l));var h=xA(this);for(u=u||[];this.pos<h;)u.push(this.readVarint(l));return u},readPackedSVarint:function(u){if(this.type!==jn.Bytes)return u.push(this.readSVarint());var l=xA(this);for(u=u||[];this.pos<l;)u.push(this.readSVarint());return u},readPackedBoolean:function(u){if(this.type!==jn.Bytes)return u.push(this.readBoolean());var l=xA(this);for(u=u||[];this.pos<l;)u.push(this.readBoolean());return u},readPackedFloat:function(u){if(this.type!==jn.Bytes)return u.push(this.readFloat());var l=xA(this);for(u=u||[];this.pos<l;)u.push(this.readFloat());return u},readPackedDouble:function(u){if(this.type!==jn.Bytes)return u.push(this.readDouble());var l=xA(this);for(u=u||[];this.pos<l;)u.push(this.readDouble());return u},readPackedFixed32:function(u){if(this.type!==jn.Bytes)return u.push(this.readFixed32());var l=xA(this);for(u=u||[];this.pos<l;)u.push(this.readFixed32());return u},readPackedSFixed32:function(u){if(this.type!==jn.Bytes)return u.push(this.readSFixed32());var l=xA(this);for(u=u||[];this.pos<l;)u.push(this.readSFixed32());return u},readPackedFixed64:function(u){if(this.type!==jn.Bytes)return u.push(this.readFixed64());var l=xA(this);for(u=u||[];this.pos<l;)u.push(this.readFixed64());return u},readPackedSFixed64:function(u){if(this.type!==jn.Bytes)return u.push(this.readSFixed64());var l=xA(this);for(u=u||[];this.pos<l;)u.push(this.readSFixed64());return u},skip:function(u){var l=7&u;if(l===jn.Varint)for(;this.buf[this.pos++]>127;);else if(l===jn.Bytes)this.pos=this.readVarint()+this.pos;else if(l===jn.Fixed32)this.pos+=4;else{if(l!==jn.Fixed64)throw new Error("Unimplemented type: "+l);this.pos+=8}},writeTag:function(u,l){this.writeVarint(u<<3|l)},realloc:function(u){for(var l=this.length||16;l<this.pos+u;)l*=2;if(l!==this.length){var h=new Uint8Array(l);h.set(this.buf),this.buf=h,this.length=l}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(u){this.realloc(4),Lp(this.buf,u,this.pos),this.pos+=4},writeSFixed32:function(u){this.realloc(4),Lp(this.buf,u,this.pos),this.pos+=4},writeFixed64:function(u){this.realloc(8),Lp(this.buf,-1&u,this.pos),Lp(this.buf,Math.floor(u*qN),this.pos+4),this.pos+=8},writeSFixed64:function(u){this.realloc(8),Lp(this.buf,-1&u,this.pos),Lp(this.buf,Math.floor(u*qN),this.pos+4),this.pos+=8},writeVarint:function(u){(u=+u||0)>268435455||u<0?function(l,h){var m,v;if(l>=0?(m=l%4294967296|0,v=l/4294967296|0):(v=~(-l/4294967296),4294967295^(m=~(-l%4294967296))?m=m+1|0:(m=0,v=v+1|0)),l>=18446744073709552e3||l<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),function(E,T,F){F.buf[F.pos++]=127&E|128,E>>>=7,F.buf[F.pos++]=127&E|128,E>>>=7,F.buf[F.pos++]=127&E|128,E>>>=7,F.buf[F.pos++]=127&E|128,F.buf[F.pos]=127&(E>>>=7)}(m,0,h),function(E,T){var F=(7&E)<<4;T.buf[T.pos++]|=F|((E>>>=3)?128:0),E&&(T.buf[T.pos++]=127&E|((E>>>=7)?128:0),E&&(T.buf[T.pos++]=127&E|((E>>>=7)?128:0),E&&(T.buf[T.pos++]=127&E|((E>>>=7)?128:0),E&&(T.buf[T.pos++]=127&E|((E>>>=7)?128:0),E&&(T.buf[T.pos++]=127&E)))))}(v,h)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(u){this.writeVarint(u<0?2*-u-1:2*u)},writeBoolean:function(u){this.writeVarint(!!u)},writeString:function(u){u=String(u),this.realloc(4*u.length),this.pos++;var l=this.pos;this.pos=function(m,v,E){for(var T,F,U=0;U<v.length;U++){if((T=v.charCodeAt(U))>55295&&T<57344){if(!F){T>56319||U+1===v.length?(m[E++]=239,m[E++]=191,m[E++]=189):F=T;continue}if(T<56320){m[E++]=239,m[E++]=191,m[E++]=189,F=T;continue}T=F-55296<<10|T-56320|65536,F=null}else F&&(m[E++]=239,m[E++]=191,m[E++]=189,F=null);T<128?m[E++]=T:(T<2048?m[E++]=T>>6|192:(T<65536?m[E++]=T>>12|224:(m[E++]=T>>18|240,m[E++]=T>>12&63|128),m[E++]=T>>6&63|128),m[E++]=63&T|128)}return E}(this.buf,u,this.pos);var h=this.pos-l;h>=128&&$N(l,h,this),this.pos=l-1,this.writeVarint(h),this.pos+=h},writeFloat:function(u){this.realloc(4),jN(this.buf,u,this.pos,!0,23,4),this.pos+=4},writeDouble:function(u){this.realloc(8),jN(this.buf,u,this.pos,!0,52,8),this.pos+=8},writeBytes:function(u){var l=u.length;this.writeVarint(l),this.realloc(l);for(var h=0;h<l;h++)this.buf[this.pos++]=u[h]},writeRawMessage:function(u,l){this.pos++;var h=this.pos;u(l,this);var m=this.pos-h;m>=128&&$N(h,m,this),this.pos=h-1,this.writeVarint(m),this.pos+=m},writeMessage:function(u,l,h){this.writeTag(u,jn.Bytes),this.writeRawMessage(l,h)},writePackedVarint:function(u,l){l.length&&this.writeMessage(u,owt,l)},writePackedSVarint:function(u,l){l.length&&this.writeMessage(u,awt,l)},writePackedBoolean:function(u,l){l.length&&this.writeMessage(u,uwt,l)},writePackedFloat:function(u,l){l.length&&this.writeMessage(u,lwt,l)},writePackedDouble:function(u,l){l.length&&this.writeMessage(u,cwt,l)},writePackedFixed32:function(u,l){l.length&&this.writeMessage(u,Awt,l)},writePackedSFixed32:function(u,l){l.length&&this.writeMessage(u,hwt,l)},writePackedFixed64:function(u,l){l.length&&this.writeMessage(u,dwt,l)},writePackedSFixed64:function(u,l){l.length&&this.writeMessage(u,fwt,l)},writeBytesField:function(u,l){this.writeTag(u,jn.Bytes),this.writeBytes(l)},writeFixed32Field:function(u,l){this.writeTag(u,jn.Fixed32),this.writeFixed32(l)},writeSFixed32Field:function(u,l){this.writeTag(u,jn.Fixed32),this.writeSFixed32(l)},writeFixed64Field:function(u,l){this.writeTag(u,jn.Fixed64),this.writeFixed64(l)},writeSFixed64Field:function(u,l){this.writeTag(u,jn.Fixed64),this.writeSFixed64(l)},writeVarintField:function(u,l){this.writeTag(u,jn.Varint),this.writeVarint(l)},writeSVarintField:function(u,l){this.writeTag(u,jn.Varint),this.writeSVarint(l)},writeStringField:function(u,l){this.writeTag(u,jn.Bytes),this.writeString(l)},writeFloatField:function(u,l){this.writeTag(u,jn.Fixed32),this.writeFloat(l)},writeDoubleField:function(u,l){this.writeTag(u,jn.Fixed64),this.writeDouble(l)},writeBooleanField:function(u,l){this.writeVarintField(u,!!l)}};var ZE=d(VN);const tS=3;function pwt(u,l,h){u===1&&h.readMessage(gwt,l)}function gwt(u,l,h){if(u===3){const{id:m,bitmap:v,width:E,height:T,left:F,top:U,advance:Q}=h.readMessage(mwt,{});l.push({id:m,bitmap:new Zm({width:E+2*tS,height:T+2*tS},v),metrics:{width:E,height:T,left:F,top:U,advance:Q}})}}function mwt(u,l,h){u===1?l.id=h.readVarint():u===2?l.bitmap=h.readBytes():u===3?l.width=h.readVarint():u===4?l.height=h.readVarint():u===5?l.left=h.readSVarint():u===6?l.top=h.readSVarint():u===7&&(l.advance=h.readVarint())}const XN=tS;function JN(u){let l=0,h=0;for(const T of u)l+=T.w*T.h,h=Math.max(h,T.w);u.sort((T,F)=>F.h-T.h);const m=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(l/.95)),h),h:1/0}];let v=0,E=0;for(const T of u)for(let F=m.length-1;F>=0;F--){const U=m[F];if(!(T.w>U.w||T.h>U.h)){if(T.x=U.x,T.y=U.y,E=Math.max(E,T.y+T.h),v=Math.max(v,T.x+T.w),T.w===U.w&&T.h===U.h){const Q=m.pop();F<m.length&&(m[F]=Q)}else T.h===U.h?(U.x+=T.w,U.w-=T.w):T.w===U.w?(U.y+=T.h,U.h-=T.h):(m.push({x:U.x+T.w,y:U.y,w:U.w-T.w,h:T.h}),U.y+=T.h,U.h-=T.h);break}}return{w:v,h:E,fill:l/(v*E)||0}}const ta=1;class eS{constructor(l,h){let{pixelRatio:m,version:v,stretchX:E,stretchY:T,content:F,textFitWidth:U,textFitHeight:Q}=h;this.paddedRect=l,this.pixelRatio=m,this.stretchX=E,this.stretchY=T,this.content=F,this.version=v,this.textFitWidth=U,this.textFitHeight=Q}get tl(){return[this.paddedRect.x+ta,this.paddedRect.y+ta]}get br(){return[this.paddedRect.x+this.paddedRect.w-ta,this.paddedRect.y+this.paddedRect.h-ta]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*ta)/this.pixelRatio,(this.paddedRect.h-2*ta)/this.pixelRatio]}}class YN{constructor(l,h){const m={},v={};this.haveRenderCallbacks=[];const E=[];this.addImages(l,m,E),this.addImages(h,v,E);const{w:T,h:F}=JN(E),U=new Za({width:T||1,height:F||1});for(const Q in l){const G=l[Q],q=m[Q].paddedRect;Za.copy(G.data,U,{x:0,y:0},{x:q.x+ta,y:q.y+ta},G.data)}for(const Q in h){const G=h[Q],q=v[Q].paddedRect,J=q.x+ta,rt=q.y+ta,ut=G.data.width,_t=G.data.height;Za.copy(G.data,U,{x:0,y:0},{x:J,y:rt},G.data),Za.copy(G.data,U,{x:0,y:_t-1},{x:J,y:rt-1},{width:ut,height:1}),Za.copy(G.data,U,{x:0,y:0},{x:J,y:rt+_t},{width:ut,height:1}),Za.copy(G.data,U,{x:ut-1,y:0},{x:J-1,y:rt},{width:1,height:_t}),Za.copy(G.data,U,{x:0,y:0},{x:J+ut,y:rt},{width:1,height:_t})}this.image=U,this.iconPositions=m,this.patternPositions=v}addImages(l,h,m){for(const v in l){const E=l[v],T={x:0,y:0,w:E.data.width+2*ta,h:E.data.height+2*ta};m.push(T),h[v]=new eS(T,E),E.hasRenderCallback&&this.haveRenderCallbacks.push(v)}}patchUpdatedImages(l,h){l.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const m in l.updatedImages)this.patchUpdatedImage(this.iconPositions[m],l.getImage(m),h),this.patchUpdatedImage(this.patternPositions[m],l.getImage(m),h)}patchUpdatedImage(l,h,m){if(!l||!h||l.version===h.version)return;l.version=h.version;const[v,E]=l.tl;m.update(h.data,void 0,{x:v,y:E})}}var Ih;je("ImagePosition",eS),je("ImageAtlas",YN),a.ai=void 0,(Ih=a.ai||(a.ai={}))[Ih.none=0]="none",Ih[Ih.horizontal=1]="horizontal",Ih[Ih.vertical=2]="vertical",Ih[Ih.horizontalOnly=3]="horizontalOnly";const o0=-17;class a0{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(l,h){const m=new a0;return m.scale=l||1,m.fontStack=h,m}static forImage(l){const h=new a0;return h.imageName=l,h}}class Pp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(l,h){const m=new Pp;for(let v=0;v<l.sections.length;v++){const E=l.sections[v];E.image?m.addImageSection(E):m.addTextSection(E,h)}return m}length(){return this.text.length}getSection(l){return this.sections[this.sectionIndex[l]]}getSectionIndex(l){return this.sectionIndex[l]}getCharCode(l){return this.text.charCodeAt(l)}verticalizePunctuation(){this.text=function(l){let h="";for(let m=0;m<l.length;m++){const v=l.charCodeAt(m+1)||null,E=l.charCodeAt(m-1)||null;h+=v&&Rd(v)&&!s0[l[m+1]]||E&&Rd(E)&&!s0[l[m-1]]||!s0[l[m]]?l[m]:s0[l[m]]}return h}(this.text)}trim(){let l=0;for(let m=0;m<this.text.length&&rv[this.text.charCodeAt(m)];m++)l++;let h=this.text.length;for(let m=this.text.length-1;m>=0&&m>=l&&rv[this.text.charCodeAt(m)];m--)h--;this.text=this.text.substring(l,h),this.sectionIndex=this.sectionIndex.slice(l,h)}substring(l,h){const m=new Pp;return m.text=this.text.substring(l,h),m.sectionIndex=this.sectionIndex.slice(l,h),m.sections=this.sections,m}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((l,h)=>Math.max(l,this.sections[h].scale),0)}addTextSection(l,h){this.text+=l.text,this.sections.push(a0.forText(l.scale,l.fontStack||h));const m=this.sections.length-1;for(let v=0;v<l.text.length;++v)this.sectionIndex.push(m)}addImageSection(l){const h=l.image?l.image.name:"";if(h.length===0)return void wt("Can't add FormattedSection with an empty image.");const m=this.getNextImageSectionCharCode();m?(this.text+=String.fromCharCode(m),this.sections.push(a0.forImage(h)),this.sectionIndex.push(this.sections.length-1)):wt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ev(u,l,h,m,v,E,T,F,U,Q,G,q,J,rt,ut){const _t=Pp.fromFeature(u,v);let St;q===a.ai.vertical&&_t.verticalizePunctuation();const{processBidirectionalText:Rt,processStyledBidirectionalText:Xt}=Co;if(Rt&&_t.sections.length===1){St=[];const Ae=Rt(_t.toString(),rS(_t,Q,E,l,m,rt));for(const Be of Ae){const qe=new Pp;qe.text=Be,qe.sections=_t.sections;for(let wr=0;wr<Be.length;wr++)qe.sectionIndex.push(0);St.push(qe)}}else if(Xt){St=[];const Ae=Xt(_t.text,_t.sectionIndex,rS(_t,Q,E,l,m,rt));for(const Be of Ae){const qe=new Pp;qe.text=Be[0],qe.sectionIndex=Be[1],qe.sections=_t.sections,St.push(qe)}}else St=function(Ae,Be){const qe=[],wr=Ae.text;let Ke=0;for(const Ve of Be)qe.push(Ae.substring(Ke,Ve)),Ke=Ve;return Ke<wr.length&&qe.push(Ae.substring(Ke,wr.length)),qe}(_t,rS(_t,Q,E,l,m,rt));const Qt=[],qt={positionedLines:Qt,text:_t.toString(),top:G[1],bottom:G[1],left:G[0],right:G[0],writingMode:q,iconsInText:!1,verticalizable:!1};return function(Ae,Be,qe,wr,Ke,Ve,dr,sr,rr,ye,mr,Ar){let Nr=0,Jn=o0,qn=0,fs=0;const Gl=sr==="right"?1:sr==="left"?0:.5;let zs=0;for(const Pi of Ke){Pi.trim();const ps=Pi.getMaxScale(),io=(ps-1)*ss,Hs={positionedGlyphs:[],lineOffset:0};Ae.positionedLines[zs]=Hs;const Fo=Hs.positionedGlyphs;let Vs=0;if(!Pi.length()){Jn+=Ve,++zs;continue}for(let ea=0;ea<Pi.length();ea++){const Cn=Pi.getSection(ea),ri=Pi.getSectionIndex(ea),ci=Pi.getCharCode(ea);let wa=0,Ei=null,Op=null,Cu=null,Eu=ss;const jl=!(rr===a.ai.horizontal||!mr&&!_h(ci)||mr&&(rv[ci]||(Li=ci,$e.Arabic(Li)||$e["Arabic Supplement"](Li)||$e["Arabic Extended-A"](Li)||$e["Arabic Presentation Forms-A"](Li)||$e["Arabic Presentation Forms-B"](Li))));if(Cn.imageName){const rl=wr[Cn.imageName];if(!rl)continue;Cu=Cn.imageName,Ae.iconsInText=Ae.iconsInText||!0,Op=rl.paddedRect;const Fs=rl.displaySize;Cn.scale=Cn.scale*ss/Ar,Ei={width:Fs[0],height:Fs[1],left:ta,top:-XN,advance:jl?Fs[1]:Fs[0]},wa=io+(ss-Fs[1]*Cn.scale),Eu=Ei.advance;const BA=jl?Fs[0]*Cn.scale-ss*ps:Fs[1]*Cn.scale-ss*ps;BA>0&&BA>Vs&&(Vs=BA)}else{const rl=qe[Cn.fontStack],Fs=rl&&rl[ci];if(Fs&&Fs.rect)Op=Fs.rect,Ei=Fs.metrics;else{const BA=Be[Cn.fontStack],h0=BA&&BA[ci];if(!h0)continue;Ei=h0.metrics}wa=(ps-Cn.scale)*ss}jl?(Ae.verticalizable=!0,Fo.push({glyph:ci,imageName:Cu,x:Nr,y:Jn+wa,vertical:jl,scale:Cn.scale,fontStack:Cn.fontStack,sectionIndex:ri,metrics:Ei,rect:Op}),Nr+=Eu*Cn.scale+ye):(Fo.push({glyph:ci,imageName:Cu,x:Nr,y:Jn+wa,vertical:jl,scale:Cn.scale,fontStack:Cn.fontStack,sectionIndex:ri,metrics:Ei,rect:Op}),Nr+=Ei.advance*Cn.scale+ye)}Fo.length!==0&&(qn=Math.max(Nr-ye,qn),bwt(Fo,0,Fo.length-1,Gl,Vs)),Nr=0;const el=Ve*ps+Vs;Hs.lineOffset=Math.max(Vs,io),Jn+=el,fs=Math.max(el,fs),++zs}var Li;const So=Jn-o0,{horizontalAlign:To,verticalAlign:Io}=nS(dr);(function(Pi,ps,io,Hs,Fo,Vs,el,ea,Cn){const ri=(ps-io)*Fo;let ci=0;ci=Vs!==el?-ea*Hs-o0:(-Hs*Cn+.5)*el;for(const wa of Pi)for(const Ei of wa.positionedGlyphs)Ei.x+=ri,Ei.y+=ci})(Ae.positionedLines,Gl,To,Io,qn,fs,Ve,So,Ke.length),Ae.top+=-Io*So,Ae.bottom=Ae.top+So,Ae.left+=-To*qn,Ae.right=Ae.left+qn}(qt,l,h,m,St,T,F,U,q,Q,J,ut),!function(Ae){for(const Be of Ae)if(Be.positionedGlyphs.length!==0)return!1;return!0}(Qt)&&qt}const rv={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ywt={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},_wt={40:!0};function ZN(u,l,h,m,v,E){if(l.imageName){const T=m[l.imageName];return T?T.displaySize[0]*l.scale*ss/E+v:0}{const T=h[l.fontStack],F=T&&T[u];return F?F.metrics.advance*l.scale+v:0}}function tk(u,l,h,m){const v=Math.pow(u-l,2);return m?u<l?v/2:2*v:v+Math.abs(h)*h}function vwt(u,l,h){let m=0;return u===10&&(m-=1e4),h&&(m+=150),u!==40&&u!==65288||(m+=50),l!==41&&l!==65289||(m+=50),m}function ek(u,l,h,m,v,E){let T=null,F=tk(l,h,v,E);for(const U of m){const Q=tk(l-U.x,h,v,E)+U.badness;Q<=F&&(T=U,F=Q)}return{index:u,x:l,priorBreak:T,badness:F}}function rk(u){return u?rk(u.priorBreak).concat(u.index):[]}function rS(u,l,h,m,v,E){if(!u)return[];const T=[],F=function(q,J,rt,ut,_t,St){let Rt=0;for(let Xt=0;Xt<q.length();Xt++){const Qt=q.getSection(Xt);Rt+=ZN(q.getCharCode(Xt),Qt,ut,_t,J,St)}return Rt/Math.max(1,Math.ceil(Rt/rt))}(u,l,h,m,v,E),U=u.text.indexOf("")>=0;let Q=0;for(let q=0;q<u.length();q++){const J=u.getSection(q),rt=u.getCharCode(q);if(rv[rt]||(Q+=ZN(rt,J,m,v,l,E)),q<u.length()-1){const ut=!((G=rt)<11904||!($e["Bopomofo Extended"](G)||$e.Bopomofo(G)||$e["CJK Compatibility Forms"](G)||$e["CJK Compatibility Ideographs"](G)||$e["CJK Compatibility"](G)||$e["CJK Radicals Supplement"](G)||$e["CJK Strokes"](G)||$e["CJK Symbols and Punctuation"](G)||$e["CJK Unified Ideographs Extension A"](G)||$e["CJK Unified Ideographs"](G)||$e["Enclosed CJK Letters and Months"](G)||$e["Halfwidth and Fullwidth Forms"](G)||$e.Hiragana(G)||$e["Ideographic Description Characters"](G)||$e["Kangxi Radicals"](G)||$e["Katakana Phonetic Extensions"](G)||$e.Katakana(G)||$e["Vertical Forms"](G)||$e["Yi Radicals"](G)||$e["Yi Syllables"](G)));(ywt[rt]||ut||J.imageName||q!==u.length()-2&&_wt[u.getCharCode(q+1)])&&T.push(ek(q+1,Q,F,T,vwt(rt,u.getCharCode(q+1),ut&&U),!1))}}var G;return rk(ek(u.length(),Q,F,T,0,!0))}function nS(u){let l=.5,h=.5;switch(u){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:l,verticalAlign:h}}function bwt(u,l,h,m,v){if(!m&&!v)return;const E=u[h],T=(u[h].x+E.metrics.advance*E.scale)*m;for(let F=l;F<=h;F++)u[F].x-=T,u[F].y+=v}function wwt(u,l,h){const{horizontalAlign:m,verticalAlign:v}=nS(h),E=l[0]-u.displaySize[0]*m,T=l[1]-u.displaySize[1]*v;return{image:u,top:T,bottom:T+u.displaySize[1],left:E,right:E+u.displaySize[0]}}function nk(u){var l,h;let m=u.left,v=u.top,E=u.right-m,T=u.bottom-v;const F=(l=u.image.textFitWidth)!==null&&l!==void 0?l:"stretchOrShrink",U=(h=u.image.textFitHeight)!==null&&h!==void 0?h:"stretchOrShrink",Q=(u.image.content[2]-u.image.content[0])/(u.image.content[3]-u.image.content[1]);if(U==="proportional"){if(F==="stretchOnly"&&E/T<Q||F==="proportional"){const G=Math.ceil(T*Q);m*=G/E,E=G}}else if(F==="proportional"&&U==="stretchOnly"&&Q!==0&&E/T>Q){const G=Math.ceil(E/Q);v*=G/T,T=G}return{x1:m,y1:v,x2:m+E,y2:v+T}}function ik(u,l,h,m,v,E){const T=u.image;let F;if(T.content){const St=T.content,Rt=T.pixelRatio||1;F=[St[0]/Rt,St[1]/Rt,T.displaySize[0]-St[2]/Rt,T.displaySize[1]-St[3]/Rt]}const U=l.left*E,Q=l.right*E;let G,q,J,rt;h==="width"||h==="both"?(rt=v[0]+U-m[3],q=v[0]+Q+m[1]):(rt=v[0]+(U+Q-T.displaySize[0])/2,q=rt+T.displaySize[0]);const ut=l.top*E,_t=l.bottom*E;return h==="height"||h==="both"?(G=v[1]+ut-m[0],J=v[1]+_t+m[2]):(G=v[1]+(ut+_t-T.displaySize[1])/2,J=G+T.displaySize[1]),{image:T,top:G,right:q,bottom:J,left:rt,collisionPadding:F}}const l0=255,Bu=128,Fh=l0*Bu;function sk(u,l){const{expression:h}=l;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new Un(u+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:m,interpolationType:v}=h;let E=0;for(;E<m.length&&m[E]<=u;)E++;E=Math.max(0,E-1);let T=E;for(;T<m.length&&m[T]<u+1;)T++;T=Math.min(m.length-1,T);const F=m[E],U=m[T];return h.kind==="composite"?{kind:"composite",minZoom:F,maxZoom:U,interpolationType:v}:{kind:"camera",minZoom:F,maxZoom:U,minSize:h.evaluate(new Un(F)),maxSize:h.evaluate(new Un(U)),interpolationType:v}}}function iS(u,l,h){let m="never";const v=u.get(l);return v?m=v:u.get(h)&&(m="always"),m}const xwt=Th.VectorTileFeature.types,Bwt=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function nv(u,l,h,m,v,E,T,F,U,Q,G,q,J){const rt=F?Math.min(Fh,Math.round(F[0])):0,ut=F?Math.min(Fh,Math.round(F[1])):0;u.emplaceBack(l,h,Math.round(32*m),Math.round(32*v),E,T,(rt<<1)+(U?1:0),ut,16*Q,16*G,256*q,256*J)}function sS(u,l,h){u.emplaceBack(l.x,l.y,h),u.emplaceBack(l.x,l.y,h),u.emplaceBack(l.x,l.y,h),u.emplaceBack(l.x,l.y,h)}function Cwt(u){for(const l of u.sections)if(_u(l.text))return!0;return!1}class oS{constructor(l){this.layoutVertexArray=new Bn,this.indexArray=new wi,this.programConfigurations=l,this.segments=new li,this.dynamicLayoutVertexArray=new va,this.opacityVertexArray=new Tc,this.hasVisibleVertices=!1,this.placedSymbolArray=new an}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(l,h,m,v){this.isEmpty()||(m&&(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,ewt.members),this.indexBuffer=l.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=l.createVertexBuffer(this.dynamicLayoutVertexArray,rwt.members,!0),this.opacityVertexBuffer=l.createVertexBuffer(this.opacityVertexArray,Bwt,!0),this.opacityVertexBuffer.itemSize=1),(m||v)&&this.programConfigurations.upload(l))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}je("SymbolBuffers",oS);class aS{constructor(l,h,m){this.layoutVertexArray=new l,this.layoutAttributes=h,this.indexArray=new m,this.segments=new li,this.collisionVertexArray=new Ui}upload(l){this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=l.createVertexBuffer(this.collisionVertexArray,nwt.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}je("CollisionBuffers",aS);class Mp{constructor(l){this.collisionBoxArray=l.collisionBoxArray,this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(T=>T.id),this.index=l.index,this.pixelRatio=l.pixelRatio,this.sourceLayerIndex=l.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=kE([]),this.placementViewportMatrix=kE([]);const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=sk(this.zoom,h["text-size"]),this.iconSizeData=sk(this.zoom,h["icon-size"]);const m=this.layers[0].layout,v=m.get("symbol-sort-key"),E=m.get("symbol-z-order");this.canOverlap=iS(m,"text-overlap","text-allow-overlap")!=="never"||iS(m,"icon-overlap","icon-allow-overlap")!=="never"||m.get("text-ignore-placement")||m.get("icon-ignore-placement"),this.sortFeaturesByKey=E!=="viewport-y"&&!v.isConstant(),this.sortFeaturesByY=(E==="viewport-y"||E==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,m.get("symbol-placement")==="point"&&(this.writingModes=m.get("text-writing-mode").map(T=>a.ai[T])),this.stateDependentLayerIds=this.layers.filter(T=>T.isStateDependent()).map(T=>T.id),this.sourceID=l.sourceID}createArrays(){this.text=new oS(new Pc(this.layers,this.zoom,l=>/^text/.test(l))),this.icon=new oS(new Pc(this.layers,this.zoom,l=>/^icon/.test(l))),this.glyphOffsetArray=new Mr,this.lineVertexArray=new Xn,this.symbolInstances=new oi,this.textAnchorOffsets=new bn}calculateGlyphDependencies(l,h,m,v,E){for(let T=0;T<l.length;T++)if(h[l.charCodeAt(T)]=!0,(m||v)&&E){const F=s0[l.charAt(T)];F&&(h[F.charCodeAt(0)]=!0)}}populate(l,h,m){const v=this.layers[0],E=v.layout,T=E.get("text-font"),F=E.get("text-field"),U=E.get("icon-image"),Q=(F.value.kind!=="constant"||F.value.value instanceof qr&&!F.value.value.isEmpty()||F.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),G=U.value.kind!=="constant"||!!U.value.value||Object.keys(U.parameters).length>0,q=E.get("symbol-sort-key");if(this.features=[],!Q&&!G)return;const J=h.iconDependencies,rt=h.glyphDependencies,ut=h.availableImages,_t=new Un(this.zoom);for(const{feature:St,id:Rt,index:Xt,sourceLayerIndex:Qt}of l){const qt=v._featureFilter.needGeometry,Ae=wA(St,qt);if(!v._featureFilter.filter(_t,Ae,m))continue;let Be,qe;if(qt||(Ae.geometry=ba(St)),Q){const Ke=v.getValueAndResolveTokens("text-field",Ae,m,ut),Ve=qr.factory(Ke),dr=this.hasRTLText=this.hasRTLText||Cwt(Ve);(!dr||Co.getRTLTextPluginStatus()==="unavailable"||dr&&Co.isParsed())&&(Be=swt(Ve,v,Ae))}if(G){const Ke=v.getValueAndResolveTokens("icon-image",Ae,m,ut);qe=Ke instanceof Wr?Ke:Wr.fromString(Ke)}if(!Be&&!qe)continue;const wr=this.sortFeaturesByKey?q.evaluate(Ae,{},m):void 0;if(this.features.push({id:Rt,text:Be,icon:qe,index:Xt,sourceLayerIndex:Qt,geometry:Ae.geometry,properties:St.properties,type:xwt[St.type],sortKey:wr}),qe&&(J[qe.name]=!0),Be){const Ke=T.evaluate(Ae,{},m).join(","),Ve=E.get("text-rotation-alignment")!=="viewport"&&E.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.ai.vertical)>=0;for(const dr of Be.sections)if(dr.image)J[dr.image.name]=!0;else{const sr=Md(Be.toString()),rr=dr.fontStack||Ke,ye=rt[rr]=rt[rr]||{};this.calculateGlyphDependencies(dr.text,ye,Ve,this.allowVerticalPlacement,sr)}}}E.get("symbol-placement")==="line"&&(this.features=function(St){const Rt={},Xt={},Qt=[];let qt=0;function Ae(Ke){Qt.push(St[Ke]),qt++}function Be(Ke,Ve,dr){const sr=Xt[Ke];return delete Xt[Ke],Xt[Ve]=sr,Qt[sr].geometry[0].pop(),Qt[sr].geometry[0]=Qt[sr].geometry[0].concat(dr[0]),sr}function qe(Ke,Ve,dr){const sr=Rt[Ve];return delete Rt[Ve],Rt[Ke]=sr,Qt[sr].geometry[0].shift(),Qt[sr].geometry[0]=dr[0].concat(Qt[sr].geometry[0]),sr}function wr(Ke,Ve,dr){const sr=dr?Ve[0][Ve[0].length-1]:Ve[0][0];return`${Ke}:${sr.x}:${sr.y}`}for(let Ke=0;Ke<St.length;Ke++){const Ve=St[Ke],dr=Ve.geometry,sr=Ve.text?Ve.text.toString():null;if(!sr){Ae(Ke);continue}const rr=wr(sr,dr),ye=wr(sr,dr,!0);if(rr in Xt&&ye in Rt&&Xt[rr]!==Rt[ye]){const mr=qe(rr,ye,dr),Ar=Be(rr,ye,Qt[mr].geometry);delete Rt[rr],delete Xt[ye],Xt[wr(sr,Qt[Ar].geometry,!0)]=Ar,Qt[mr].geometry=null}else rr in Xt?Be(rr,ye,dr):ye in Rt?qe(rr,ye,dr):(Ae(Ke),Rt[rr]=qt-1,Xt[ye]=qt-1)}return Qt.filter(Ke=>Ke.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((St,Rt)=>St.sortKey-Rt.sortKey)}update(l,h,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(l,h,this.layers,m),this.icon.programConfigurations.updatePaintArrays(l,h,this.layers,m))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(l){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(l),this.iconCollisionBox.upload(l)),this.text.upload(l,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(l,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(l,h){const m=this.lineVertexArray.length;if(l.segment!==void 0){let v=l.dist(h[l.segment+1]),E=l.dist(h[l.segment]);const T={};for(let F=l.segment+1;F<h.length;F++)T[F]={x:h[F].x,y:h[F].y,tileUnitDistanceFromAnchor:v},F<h.length-1&&(v+=h[F+1].dist(h[F]));for(let F=l.segment||0;F>=0;F--)T[F]={x:h[F].x,y:h[F].y,tileUnitDistanceFromAnchor:E},F>0&&(E+=h[F-1].dist(h[F]));for(let F=0;F<h.length;F++){const U=T[F];this.lineVertexArray.emplaceBack(U.x,U.y,U.tileUnitDistanceFromAnchor)}}return{lineStartIndex:m,lineLength:this.lineVertexArray.length-m}}addSymbols(l,h,m,v,E,T,F,U,Q,G,q,J){const rt=l.indexArray,ut=l.layoutVertexArray,_t=l.segments.prepareSegment(4*h.length,ut,rt,this.canOverlap?T.sortKey:void 0),St=this.glyphOffsetArray.length,Rt=_t.vertexLength,Xt=this.allowVerticalPlacement&&F===a.ai.vertical?Math.PI/2:0,Qt=T.text&&T.text.sections;for(let qt=0;qt<h.length;qt++){const{tl:Ae,tr:Be,bl:qe,br:wr,tex:Ke,pixelOffsetTL:Ve,pixelOffsetBR:dr,minFontScaleX:sr,minFontScaleY:rr,glyphOffset:ye,isSDF:mr,sectionIndex:Ar}=h[qt],Nr=_t.vertexLength,Jn=ye[1];nv(ut,U.x,U.y,Ae.x,Jn+Ae.y,Ke.x,Ke.y,m,mr,Ve.x,Ve.y,sr,rr),nv(ut,U.x,U.y,Be.x,Jn+Be.y,Ke.x+Ke.w,Ke.y,m,mr,dr.x,Ve.y,sr,rr),nv(ut,U.x,U.y,qe.x,Jn+qe.y,Ke.x,Ke.y+Ke.h,m,mr,Ve.x,dr.y,sr,rr),nv(ut,U.x,U.y,wr.x,Jn+wr.y,Ke.x+Ke.w,Ke.y+Ke.h,m,mr,dr.x,dr.y,sr,rr),sS(l.dynamicLayoutVertexArray,U,Xt),rt.emplaceBack(Nr,Nr+1,Nr+2),rt.emplaceBack(Nr+1,Nr+2,Nr+3),_t.vertexLength+=4,_t.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ye[0]),qt!==h.length-1&&Ar===h[qt+1].sectionIndex||l.programConfigurations.populatePaintArrays(ut.length,T,T.index,{},J,Qt&&Qt[Ar])}l.placedSymbolArray.emplaceBack(U.x,U.y,St,this.glyphOffsetArray.length-St,Rt,Q,G,U.segment,m?m[0]:0,m?m[1]:0,v[0],v[1],F,0,!1,0,q)}_addCollisionDebugVertex(l,h,m,v,E,T){return h.emplaceBack(0,0),l.emplaceBack(m.x,m.y,v,E,Math.round(T.x),Math.round(T.y))}addCollisionDebugVertices(l,h,m,v,E,T,F){const U=E.segments.prepareSegment(4,E.layoutVertexArray,E.indexArray),Q=U.vertexLength,G=E.layoutVertexArray,q=E.collisionVertexArray,J=F.anchorX,rt=F.anchorY;this._addCollisionDebugVertex(G,q,T,J,rt,new b(l,h)),this._addCollisionDebugVertex(G,q,T,J,rt,new b(m,h)),this._addCollisionDebugVertex(G,q,T,J,rt,new b(m,v)),this._addCollisionDebugVertex(G,q,T,J,rt,new b(l,v)),U.vertexLength+=4;const ut=E.indexArray;ut.emplaceBack(Q,Q+1),ut.emplaceBack(Q+1,Q+2),ut.emplaceBack(Q+2,Q+3),ut.emplaceBack(Q+3,Q),U.primitiveLength+=4}addDebugCollisionBoxes(l,h,m,v){for(let E=l;E<h;E++){const T=this.collisionBoxArray.get(E);this.addCollisionDebugVertices(T.x1,T.y1,T.x2,T.y2,v?this.textCollisionBox:this.iconCollisionBox,T.anchorPoint,m)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new aS(is,HN.members,Gn),this.iconCollisionBox=new aS(is,HN.members,Gn);for(let l=0;l<this.symbolInstances.length;l++){const h=this.symbolInstances.get(l);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(l,h,m,v,E,T,F,U,Q){const G={};for(let q=h;q<m;q++){const J=l.get(q);G.textBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},G.textFeatureIndex=J.featureIndex;break}for(let q=v;q<E;q++){const J=l.get(q);G.verticalTextBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},G.verticalTextFeatureIndex=J.featureIndex;break}for(let q=T;q<F;q++){const J=l.get(q);G.iconBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},G.iconFeatureIndex=J.featureIndex;break}for(let q=U;q<Q;q++){const J=l.get(q);G.verticalIconBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},G.verticalIconFeatureIndex=J.featureIndex;break}return G}deserializeCollisionBoxes(l){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const m=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(l,m.textBoxStartIndex,m.textBoxEndIndex,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m.iconBoxStartIndex,m.iconBoxEndIndex,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(l,h){const m=l.placedSymbolArray.get(h),v=m.vertexStartIndex+4*m.numGlyphs;for(let E=m.vertexStartIndex;E<v;E+=4)l.indexArray.emplaceBack(E,E+1,E+2),l.indexArray.emplaceBack(E+1,E+2,E+3)}getSortedSymbolIndexes(l){if(this.sortedAngle===l&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(l),m=Math.cos(l),v=[],E=[],T=[];for(let F=0;F<this.symbolInstances.length;++F){T.push(F);const U=this.symbolInstances.get(F);v.push(0|Math.round(h*U.anchorX+m*U.anchorY)),E.push(U.featureIndex)}return T.sort((F,U)=>v[F]-v[U]||E[U]-E[F]),T}addToSortKeyRanges(l,h){const m=this.sortKeyRanges[this.sortKeyRanges.length-1];m&&m.sortKey===h?m.symbolInstanceEnd=l+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:l,symbolInstanceEnd:l+1})}sortFeatures(l){if(this.sortFeaturesByY&&this.sortedAngle!==l&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(l),this.sortedAngle=l,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const m=this.symbolInstances.get(h);this.featureSortOrder.push(m.featureIndex),[m.rightJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.leftJustifiedTextSymbolIndex].forEach((v,E,T)=>{v>=0&&T.indexOf(v)===E&&this.addIndicesForPlacedSymbol(this.text,v)}),m.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,m.verticalPlacedTextSymbolIndex),m.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.placedIconSymbolIndex),m.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let ok,ak;je("SymbolBucket",Mp,{omit:["layers","collisionBoxArray","features","compareText"]}),Mp.MAX_GLYPHS=65535,Mp.addDynamicAttributes=sS;var lS={get paint(){return ak=ak||new _({"icon-opacity":new Er(st.paint_symbol["icon-opacity"]),"icon-color":new Er(st.paint_symbol["icon-color"]),"icon-halo-color":new Er(st.paint_symbol["icon-halo-color"]),"icon-halo-width":new Er(st.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Er(st.paint_symbol["icon-halo-blur"]),"icon-translate":new ur(st.paint_symbol["icon-translate"]),"icon-translate-anchor":new ur(st.paint_symbol["icon-translate-anchor"]),"text-opacity":new Er(st.paint_symbol["text-opacity"]),"text-color":new Er(st.paint_symbol["text-color"],{runtimeType:Ur,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new Er(st.paint_symbol["text-halo-color"]),"text-halo-width":new Er(st.paint_symbol["text-halo-width"]),"text-halo-blur":new Er(st.paint_symbol["text-halo-blur"]),"text-translate":new ur(st.paint_symbol["text-translate"]),"text-translate-anchor":new ur(st.paint_symbol["text-translate-anchor"])})},get layout(){return ok=ok||new _({"symbol-placement":new ur(st.layout_symbol["symbol-placement"]),"symbol-spacing":new ur(st.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ur(st.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Er(st.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ur(st.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ur(st.layout_symbol["icon-allow-overlap"]),"icon-overlap":new ur(st.layout_symbol["icon-overlap"]),"icon-ignore-placement":new ur(st.layout_symbol["icon-ignore-placement"]),"icon-optional":new ur(st.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ur(st.layout_symbol["icon-rotation-alignment"]),"icon-size":new Er(st.layout_symbol["icon-size"]),"icon-text-fit":new ur(st.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ur(st.layout_symbol["icon-text-fit-padding"]),"icon-image":new Er(st.layout_symbol["icon-image"]),"icon-rotate":new Er(st.layout_symbol["icon-rotate"]),"icon-padding":new Er(st.layout_symbol["icon-padding"]),"icon-keep-upright":new ur(st.layout_symbol["icon-keep-upright"]),"icon-offset":new Er(st.layout_symbol["icon-offset"]),"icon-anchor":new Er(st.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ur(st.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ur(st.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ur(st.layout_symbol["text-rotation-alignment"]),"text-field":new Er(st.layout_symbol["text-field"]),"text-font":new Er(st.layout_symbol["text-font"]),"text-size":new Er(st.layout_symbol["text-size"]),"text-max-width":new Er(st.layout_symbol["text-max-width"]),"text-line-height":new ur(st.layout_symbol["text-line-height"]),"text-letter-spacing":new Er(st.layout_symbol["text-letter-spacing"]),"text-justify":new Er(st.layout_symbol["text-justify"]),"text-radial-offset":new Er(st.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ur(st.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Er(st.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Er(st.layout_symbol["text-anchor"]),"text-max-angle":new ur(st.layout_symbol["text-max-angle"]),"text-writing-mode":new ur(st.layout_symbol["text-writing-mode"]),"text-rotate":new Er(st.layout_symbol["text-rotate"]),"text-padding":new ur(st.layout_symbol["text-padding"]),"text-keep-upright":new ur(st.layout_symbol["text-keep-upright"]),"text-transform":new Er(st.layout_symbol["text-transform"]),"text-offset":new Er(st.layout_symbol["text-offset"]),"text-allow-overlap":new ur(st.layout_symbol["text-allow-overlap"]),"text-overlap":new ur(st.layout_symbol["text-overlap"]),"text-ignore-placement":new ur(st.layout_symbol["text-ignore-placement"]),"text-optional":new ur(st.layout_symbol["text-optional"])})}};class lk{constructor(l){if(l.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=l.property.overrides?l.property.overrides.runtimeType:An,this.defaultValue=l}evaluate(l){if(l.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(l.formattedSection))return h.getOverride(l.formattedSection)}return l.feature&&l.featureState?this.defaultValue.evaluate(l.feature,l.featureState):this.defaultValue.property.specification.default}eachChild(l){this.defaultValue.isConstant()||l(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}je("FormatSectionOverride",lk,{omit:["defaultValue"]});class iv extends g{constructor(l){super(l,lS)}recalculate(l,h){if(super.recalculate(l,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const m=this.layout.get("text-writing-mode");if(m){const v=[];for(const E of m)v.indexOf(E)<0&&v.push(E);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(l,h,m,v){const E=this.layout.get(l).evaluate(h,{},m,v),T=this._unevaluatedLayout._values[l];return T.isDataDriven()||Cs(T.value)||!E?E:function(F,U){return U.replace(/{([^{}]+)}/g,(Q,G)=>F&&G in F?String(F[G]):"")}(h.properties,E)}createBucket(l){return new Mp(l)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const l of lS.paint.overridableProperties){if(!iv.hasPaintOverride(this.layout,l))continue;const h=this.paint.get(l),m=new lk(h),v=new Ko(m,h.property.specification);let E=null;E=h.value.kind==="constant"||h.value.kind==="source"?new Wa("source",v):new Il("composite",v,h.value.zoomStops),this.paint._values[l]=new ya(h.property,E,h.parameters)}}_handleOverridablePaintPropertyUpdate(l,h,m){return!(!this.layout||h.isDataDriven()||m.isDataDriven())&&iv.hasPaintOverride(this.layout,l)}static hasPaintOverride(l,h){const m=l.get("text-field"),v=lS.paint.properties[h];let E=!1;const T=F=>{for(const U of F)if(v.overrides&&v.overrides.hasOverride(U))return void(E=!0)};if(m.value.kind==="constant"&&m.value.value instanceof qr)T(m.value.value.sections);else if(m.value.kind==="source"){const F=Q=>{E||(Q instanceof vs&&zn(Q.value)===nn?T(Q.value.sections):Q instanceof su?T(Q.sections):Q.eachChild(F))},U=m.value;U._styleExpression&&F(U._styleExpression.expression)}return E}}let ck;var Ewt={get paint(){return ck=ck||new _({"background-color":new ur(st.paint_background["background-color"]),"background-pattern":new c(st.paint_background["background-pattern"]),"background-opacity":new ur(st.paint_background["background-opacity"])})}};class Swt extends g{constructor(l){super(l,Ewt)}}let uk;var Twt={get paint(){return uk=uk||new _({"raster-opacity":new ur(st.paint_raster["raster-opacity"]),"raster-hue-rotate":new ur(st.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ur(st.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ur(st.paint_raster["raster-brightness-max"]),"raster-saturation":new ur(st.paint_raster["raster-saturation"]),"raster-contrast":new ur(st.paint_raster["raster-contrast"]),"raster-resampling":new ur(st.paint_raster["raster-resampling"]),"raster-fade-duration":new ur(st.paint_raster["raster-fade-duration"])})}};class Iwt extends g{constructor(l){super(l,Twt)}}class Fwt extends g{constructor(l){super(l,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=l}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Lwt{constructor(l){this._methodToThrottle=l,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const cS=63710088e-1;class Lh{constructor(l,h){if(isNaN(l)||isNaN(h))throw new Error(`Invalid LngLat object: (${l}, ${h})`);if(this.lng=+l,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Lh(gt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(l){const h=Math.PI/180,m=this.lat*h,v=l.lat*h,E=Math.sin(m)*Math.sin(v)+Math.cos(m)*Math.cos(v)*Math.cos((l.lng-this.lng)*h);return cS*Math.acos(Math.min(E,1))}static convert(l){if(l instanceof Lh)return l;if(Array.isArray(l)&&(l.length===2||l.length===3))return new Lh(Number(l[0]),Number(l[1]));if(!Array.isArray(l)&&typeof l=="object"&&l!==null)return new Lh(Number("lng"in l?l.lng:l.lon),Number(l.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ak=2*Math.PI*cS;function hk(u){return Ak*Math.cos(u*Math.PI/180)}function dk(u){return(180+u)/360}function fk(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function pk(u,l){return u/hk(l)}function uS(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}class sv{constructor(l,h){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;this.x=+l,this.y=+h,this.z=+m}static fromLngLat(l){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const m=Lh.convert(l);return new sv(dk(m.lng),fk(m.lat),pk(h,m.lat))}toLngLat(){return new Lh(360*this.x-180,uS(this.y))}toAltitude(){return this.z*hk(uS(this.y))}meterInMercatorCoordinateUnits(){return 1/Ak*(l=uS(this.y),1/Math.cos(l*Math.PI/180));var l}}function gk(u,l,h){var m=2*Math.PI*6378137/256/Math.pow(2,h);return[u*m-2*Math.PI*6378137/2,l*m-2*Math.PI*6378137/2]}class AS{constructor(l,h,m){if(l<0||l>25||m<0||m>=Math.pow(2,l)||h<0||h>=Math.pow(2,l))throw new Error(`x=${h}, y=${m}, z=${l} outside of bounds. 0<=x<${Math.pow(2,l)}, 0<=y<${Math.pow(2,l)} 0<=z<=25 `);this.z=l,this.x=h,this.y=m,this.key=c0(0,l,l,h,m)}equals(l){return this.z===l.z&&this.x===l.x&&this.y===l.y}url(l,h,m){const v=(T=this.y,F=this.z,U=gk(256*(E=this.x),256*(T=Math.pow(2,F)-T-1),F),Q=gk(256*(E+1),256*(T+1),F),U[0]+","+U[1]+","+Q[0]+","+Q[1]);var E,T,F,U,Q;const G=function(q,J,rt){let ut,_t="";for(let St=q;St>0;St--)ut=1<<St-1,_t+=(J&ut?1:0)+(rt&ut?2:0);return _t}(this.z,this.x,this.y);return l[(this.x+this.y)%l.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(m==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,G).replace(/{bbox-epsg-3857}/g,v)}isChildOf(l){const h=this.z-l.z;return h>0&&l.x===this.x>>h&&l.y===this.y>>h}getTilePoint(l){const h=Math.pow(2,this.z);return new b((l.x*h-this.x)*Ci,(l.y*h-this.y)*Ci)}toString(){return`${this.z}/${this.x}/${this.y}`}}class mk{constructor(l,h){this.wrap=l,this.canonical=h,this.key=c0(l,h.z,h.z,h.x,h.y)}}class tl{constructor(l,h,m,v,E){if(l<m)throw new Error(`overscaledZ should be >= z; overscaledZ = ${l}; z = ${m}`);this.overscaledZ=l,this.wrap=h,this.canonical=new AS(m,+v,+E),this.key=c0(h,l,m,v,E)}clone(){return new tl(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(l){return this.overscaledZ===l.overscaledZ&&this.wrap===l.wrap&&this.canonical.equals(l.canonical)}scaledTo(l){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-l;return l>this.canonical.z?new tl(l,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new tl(l,this.wrap,l,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(l,h){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);const m=this.canonical.z-l;return l>this.canonical.z?c0(this.wrap*+h,l,this.canonical.z,this.canonical.x,this.canonical.y):c0(this.wrap*+h,l,l,this.canonical.x>>m,this.canonical.y>>m)}isChildOf(l){if(l.wrap!==this.wrap)return!1;const h=this.canonical.z-l.canonical.z;return l.overscaledZ===0||l.overscaledZ<this.overscaledZ&&l.canonical.x===this.canonical.x>>h&&l.canonical.y===this.canonical.y>>h}children(l){if(this.overscaledZ>=l)return[new tl(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,m=2*this.canonical.x,v=2*this.canonical.y;return[new tl(h,this.wrap,h,m,v),new tl(h,this.wrap,h,m+1,v),new tl(h,this.wrap,h,m,v+1),new tl(h,this.wrap,h,m+1,v+1)]}isLessThan(l){return this.wrap<l.wrap||!(this.wrap>l.wrap)&&(this.overscaledZ<l.overscaledZ||!(this.overscaledZ>l.overscaledZ)&&(this.canonical.x<l.canonical.x||!(this.canonical.x>l.canonical.x)&&this.canonical.y<l.canonical.y))}wrapped(){return new tl(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(l){return new tl(this.overscaledZ,l,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new mk(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(l){return this.canonical.getTilePoint(new sv(l.x-this.wrap,l.y))}}function c0(u,l,h,m,v){(u*=2)<0&&(u=-1*u-1);const E=1<<h;return(E*E*u+E*v+m).toString(36)+h.toString(36)+l.toString(36)}je("CanonicalTileID",AS),je("OverscaledTileID",tl,{omit:["posMatrix"]});class yk{constructor(l,h,m){let v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,T=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1,F=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0;if(this.uid=l,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(m&&!["mapbox","terrarium","custom"].includes(m))return void wt(`"${m}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;const U=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),m){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=v,this.greenFactor=E,this.blueFactor=T,this.baseShift=F;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let Q=0;Q<U;Q++)this.data[this._idx(-1,Q)]=this.data[this._idx(0,Q)],this.data[this._idx(U,Q)]=this.data[this._idx(U-1,Q)],this.data[this._idx(Q,-1)]=this.data[this._idx(Q,0)],this.data[this._idx(Q,U)]=this.data[this._idx(Q,U-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(U,-1)]=this.data[this._idx(U-1,0)],this.data[this._idx(-1,U)]=this.data[this._idx(0,U-1)],this.data[this._idx(U,U)]=this.data[this._idx(U-1,U-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let Q=0;Q<U;Q++)for(let G=0;G<U;G++){const q=this.get(Q,G);q>this.max&&(this.max=q),q<this.min&&(this.min=q)}}get(l,h){const m=new Uint8Array(this.data.buffer),v=4*this._idx(l,h);return this.unpack(m[v],m[v+1],m[v+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(l,h){if(l<-1||l>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(l+1)}unpack(l,h,m){return l*this.redFactor+h*this.greenFactor+m*this.blueFactor-this.baseShift}getPixels(){return new Za({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(l,h,m){if(this.dim!==l.dim)throw new Error("dem dimension mismatch");let v=h*this.dim,E=h*this.dim+this.dim,T=m*this.dim,F=m*this.dim+this.dim;switch(h){case-1:v=E-1;break;case 1:E=v+1}switch(m){case-1:T=F-1;break;case 1:F=T+1}const U=-h*this.dim,Q=-m*this.dim;for(let G=T;G<F;G++)for(let q=v;q<E;q++)this.data[this._idx(q,G)]=l.data[this._idx(q+U,G+Q)]}}je("DEMData",yk);class _k{constructor(l){this._stringToNumber={},this._numberToString=[];for(let h=0;h<l.length;h++){const m=l[h];this._stringToNumber[m]=h,this._numberToString[h]=m}}encode(l){return this._stringToNumber[l]}decode(l){if(l>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${l} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[l]}}class vk{constructor(l,h,m,v,E){this.type="Feature",this._vectorTileFeature=l,l._z=h,l._x=m,l._y=v,this.properties=l.properties,this.id=E}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(l){this._geometry=l}toJSON(){const l={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(l[h]=this[h]);return l}}class bk{constructor(l,h){this.tileID=l,this.x=l.canonical.x,this.y=l.canonical.y,this.z=l.canonical.z,this.grid=new mu(Ci,16,0),this.grid3D=new mu(Ci,16,0),this.featureIndexArray=new ei,this.promoteId=h}insert(l,h,m,v,E,T){const F=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(m,v,E);const U=T?this.grid3D:this.grid;for(let Q=0;Q<h.length;Q++){const G=h[Q],q=[1/0,1/0,-1/0,-1/0];for(let J=0;J<G.length;J++){const rt=G[J];q[0]=Math.min(q[0],rt.x),q[1]=Math.min(q[1],rt.y),q[2]=Math.max(q[2],rt.x),q[3]=Math.max(q[3],rt.y)}q[0]<Ci&&q[1]<Ci&&q[2]>=0&&q[3]>=0&&U.insert(F,q[0],q[1],q[2],q[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Th.VectorTile(new ZE(this.rawTileData)).layers,this.sourceLayerCoder=new _k(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(l,h,m,v){this.loadVTLayers();const E=l.params||{},T=Ci/l.tileSize/l.scale,F=en(E.filter),U=l.queryGeometry,Q=l.queryPadding*T,G=xk(U),q=this.grid.query(G.minX-Q,G.minY-Q,G.maxX+Q,G.maxY+Q),J=xk(l.cameraQueryGeometry),rt=this.grid3D.query(J.minX-Q,J.minY-Q,J.maxX+Q,J.maxY+Q,(St,Rt,Xt,Qt)=>function(qt,Ae,Be,qe,wr){for(const Ve of qt)if(Ae<=Ve.x&&Be<=Ve.y&&qe>=Ve.x&&wr>=Ve.y)return!0;const Ke=[new b(Ae,Be),new b(Ae,wr),new b(qe,wr),new b(qe,Be)];if(qt.length>2){for(const Ve of Ke)if(xu(qt,Ve))return!0}for(let Ve=0;Ve<qt.length-1;Ve++)if(K_(qt[Ve],qt[Ve+1],Ke))return!0;return!1}(l.cameraQueryGeometry,St-Q,Rt-Q,Xt+Q,Qt+Q));for(const St of rt)q.push(St);q.sort(Pwt);const ut={};let _t;for(let St=0;St<q.length;St++){const Rt=q[St];if(Rt===_t)continue;_t=Rt;const Xt=this.featureIndexArray.get(Rt);let Qt=null;this.loadMatchingFeature(ut,Xt.bucketIndex,Xt.sourceLayerIndex,Xt.featureIndex,F,E.layers,E.availableImages,h,m,v,(qt,Ae,Be)=>(Qt||(Qt=ba(qt)),Ae.queryIntersectsFeature(U,qt,Be,Qt,this.z,l.transform,T,l.pixelPosMatrix)))}return ut}loadMatchingFeature(l,h,m,v,E,T,F,U,Q,G,q){const J=this.bucketLayerIDs[h];if(T&&!function(St,Rt){for(let Xt=0;Xt<St.length;Xt++)if(Rt.indexOf(St[Xt])>=0)return!0;return!1}(T,J))return;const rt=this.sourceLayerCoder.decode(m),ut=this.vtLayers[rt].feature(v);if(E.needGeometry){const St=wA(ut,!0);if(!E.filter(new Un(this.tileID.overscaledZ),St,this.tileID.canonical))return}else if(!E.filter(new Un(this.tileID.overscaledZ),ut))return;const _t=this.getId(ut,rt);for(let St=0;St<J.length;St++){const Rt=J[St];if(T&&T.indexOf(Rt)<0)continue;const Xt=U[Rt];if(!Xt)continue;let Qt={};_t&&G&&(Qt=G.getState(Xt.sourceLayer||"_geojsonTileLayer",_t));const qt=mt({},Q[Rt]);qt.paint=wk(qt.paint,Xt.paint,ut,Qt,F),qt.layout=wk(qt.layout,Xt.layout,ut,Qt,F);const Ae=!q||q(ut,Xt,Qt);if(!Ae)continue;const Be=new vk(ut,this.z,this.x,this.y,_t);Be.layer=qt;let qe=l[Rt];qe===void 0&&(qe=l[Rt]=[]),qe.push({featureIndex:v,feature:Be,intersectionZ:Ae})}}lookupSymbolFeatures(l,h,m,v,E,T,F,U){const Q={};this.loadVTLayers();const G=en(E);for(const q of l)this.loadMatchingFeature(Q,m,v,q,G,T,F,U,h);return Q}hasLayer(l){for(const h of this.bucketLayerIDs)for(const m of h)if(l===m)return!0;return!1}getId(l,h){let m=l.id;return this.promoteId&&(m=l.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof m=="boolean"&&(m=Number(m))),m}}function wk(u,l,h,m,v){return Ft(u,(E,T)=>{const F=l instanceof vh?l.get(T):null;return F&&F.evaluate?F.evaluate(h,m,v):F})}function xk(u){let l=1/0,h=1/0,m=-1/0,v=-1/0;for(const E of u)l=Math.min(l,E.x),h=Math.min(h,E.y),m=Math.max(m,E.x),v=Math.max(v,E.y);return{minX:l,minY:h,maxX:m,maxY:v}}function Pwt(u,l){return l-u}function Bk(u,l,h,m,v){const E=[];for(let T=0;T<u.length;T++){const F=u[T];let U;for(let Q=0;Q<F.length-1;Q++){let G=F[Q],q=F[Q+1];G.x<l&&q.x<l||(G.x<l?G=new b(l,G.y+(l-G.x)/(q.x-G.x)*(q.y-G.y))._round():q.x<l&&(q=new b(l,G.y+(l-G.x)/(q.x-G.x)*(q.y-G.y))._round()),G.y<h&&q.y<h||(G.y<h?G=new b(G.x+(h-G.y)/(q.y-G.y)*(q.x-G.x),h)._round():q.y<h&&(q=new b(G.x+(h-G.y)/(q.y-G.y)*(q.x-G.x),h)._round()),G.x>=m&&q.x>=m||(G.x>=m?G=new b(m,G.y+(m-G.x)/(q.x-G.x)*(q.y-G.y))._round():q.x>=m&&(q=new b(m,G.y+(m-G.x)/(q.x-G.x)*(q.y-G.y))._round()),G.y>=v&&q.y>=v||(G.y>=v?G=new b(G.x+(v-G.y)/(q.y-G.y)*(q.x-G.x),v)._round():q.y>=v&&(q=new b(G.x+(v-G.y)/(q.y-G.y)*(q.x-G.x),v)._round()),U&&G.equals(U[U.length-1])||(U=[G],E.push(U)),U.push(q)))))}}return E}je("FeatureIndex",bk,{omit:["rawTileData","sourceLayerCoder"]});class Ph extends b{constructor(l,h,m,v){super(l,h),this.angle=m,v!==void 0&&(this.segment=v)}clone(){return new Ph(this.x,this.y,this.angle,this.segment)}}function Ck(u,l,h,m,v){if(l.segment===void 0||h===0)return!0;let E=l,T=l.segment+1,F=0;for(;F>-h/2;){if(T--,T<0)return!1;F-=u[T].dist(E),E=u[T]}F+=u[T].dist(u[T+1]),T++;const U=[];let Q=0;for(;F<h/2;){const G=u[T],q=u[T+1];if(!q)return!1;let J=u[T-1].angleTo(G)-G.angleTo(q);for(J=Math.abs((J+3*Math.PI)%(2*Math.PI)-Math.PI),U.push({distance:F,angleDelta:J}),Q+=J;F-U[0].distance>m;)Q-=U.shift().angleDelta;if(Q>v)return!1;T++,F+=G.dist(q)}return!0}function Ek(u){let l=0;for(let h=0;h<u.length-1;h++)l+=u[h].dist(u[h+1]);return l}function Sk(u,l,h){return u?.6*l*h:0}function Tk(u,l){return Math.max(u?u.right-u.left:0,l?l.right-l.left:0)}function Mwt(u,l,h,m,v,E){const T=Sk(h,v,E),F=Tk(h,m)*E;let U=0;const Q=Ek(u)/2;for(let G=0;G<u.length-1;G++){const q=u[G],J=u[G+1],rt=q.dist(J);if(U+rt>Q){const ut=(Q-U)/rt,_t=As.number(q.x,J.x,ut),St=As.number(q.y,J.y,ut),Rt=new Ph(_t,St,J.angleTo(q),G);return Rt._round(),!T||Ck(u,Rt,F,T,l)?Rt:void 0}U+=rt}}function Uwt(u,l,h,m,v,E,T,F,U){const Q=Sk(m,E,T),G=Tk(m,v),q=G*T,J=u[0].x===0||u[0].x===U||u[0].y===0||u[0].y===U;return l-q<l/4&&(l=q+l/4),Ik(u,J?l/2*F%l:(G/2+2*E)*T*F%l,l,Q,h,q,J,!1,U)}function Ik(u,l,h,m,v,E,T,F,U){const Q=E/2,G=Ek(u);let q=0,J=l-h,rt=[];for(let ut=0;ut<u.length-1;ut++){const _t=u[ut],St=u[ut+1],Rt=_t.dist(St),Xt=St.angleTo(_t);for(;J+h<q+Rt;){J+=h;const Qt=(J-q)/Rt,qt=As.number(_t.x,St.x,Qt),Ae=As.number(_t.y,St.y,Qt);if(qt>=0&&qt<U&&Ae>=0&&Ae<U&&J-Q>=0&&J+Q<=G){const Be=new Ph(qt,Ae,Xt,ut);Be._round(),m&&!Ck(u,Be,E,m,v)||rt.push(Be)}}q+=Rt}return F||rt.length||T||(rt=Ik(u,q/2,h,m,v,E,T,!0,U)),rt}je("Anchor",Ph);const Up=ta;function Fk(u,l,h,m){const v=[],E=u.image,T=E.pixelRatio,F=E.paddedRect.w-2*Up,U=E.paddedRect.h-2*Up;let Q={x1:u.left,y1:u.top,x2:u.right,y2:u.bottom};const G=E.stretchX||[[0,F]],q=E.stretchY||[[0,U]],J=(ye,mr)=>ye+mr[1]-mr[0],rt=G.reduce(J,0),ut=q.reduce(J,0),_t=F-rt,St=U-ut;let Rt=0,Xt=rt,Qt=0,qt=ut,Ae=0,Be=_t,qe=0,wr=St;if(E.content&&m){const ye=E.content,mr=ye[2]-ye[0],Ar=ye[3]-ye[1];(E.textFitWidth||E.textFitHeight)&&(Q=nk(u)),Rt=ov(G,0,ye[0]),Qt=ov(q,0,ye[1]),Xt=ov(G,ye[0],ye[2]),qt=ov(q,ye[1],ye[3]),Ae=ye[0]-Rt,qe=ye[1]-Qt,Be=mr-Xt,wr=Ar-qt}const Ke=Q.x1,Ve=Q.y1,dr=Q.x2-Ke,sr=Q.y2-Ve,rr=(ye,mr,Ar,Nr)=>{const Jn=av(ye.stretch-Rt,Xt,dr,Ke),qn=lv(ye.fixed-Ae,Be,ye.stretch,rt),fs=av(mr.stretch-Qt,qt,sr,Ve),Gl=lv(mr.fixed-qe,wr,mr.stretch,ut),zs=av(Ar.stretch-Rt,Xt,dr,Ke),Li=lv(Ar.fixed-Ae,Be,Ar.stretch,rt),So=av(Nr.stretch-Qt,qt,sr,Ve),To=lv(Nr.fixed-qe,wr,Nr.stretch,ut),Io=new b(Jn,fs),Pi=new b(zs,fs),ps=new b(zs,So),io=new b(Jn,So),Hs=new b(qn/T,Gl/T),Fo=new b(Li/T,To/T),Vs=l*Math.PI/180;if(Vs){const Cn=Math.sin(Vs),ri=Math.cos(Vs),ci=[ri,-Cn,Cn,ri];Io._matMult(ci),Pi._matMult(ci),io._matMult(ci),ps._matMult(ci)}const el=ye.stretch+ye.fixed,ea=mr.stretch+mr.fixed;return{tl:Io,tr:Pi,bl:io,br:ps,tex:{x:E.paddedRect.x+Up+el,y:E.paddedRect.y+Up+ea,w:Ar.stretch+Ar.fixed-el,h:Nr.stretch+Nr.fixed-ea},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Hs,pixelOffsetBR:Fo,minFontScaleX:Be/T/dr,minFontScaleY:wr/T/sr,isSDF:h}};if(m&&(E.stretchX||E.stretchY)){const ye=Lk(G,_t,rt),mr=Lk(q,St,ut);for(let Ar=0;Ar<ye.length-1;Ar++){const Nr=ye[Ar],Jn=ye[Ar+1];for(let qn=0;qn<mr.length-1;qn++)v.push(rr(Nr,mr[qn],Jn,mr[qn+1]))}}else v.push(rr({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:F+1},{fixed:0,stretch:U+1}));return v}function ov(u,l,h){let m=0;for(const v of u)m+=Math.max(l,Math.min(h,v[1]))-Math.max(l,Math.min(h,v[0]));return m}function Lk(u,l,h){const m=[{fixed:-Up,stretch:0}];for(const[v,E]of u){const T=m[m.length-1];m.push({fixed:v-T.stretch,stretch:T.stretch}),m.push({fixed:v-T.stretch,stretch:T.stretch+(E-v)})}return m.push({fixed:l+Up,stretch:h}),m}function av(u,l,h,m){return u/l*h+m}function lv(u,l,h,m){return u-l*h/m}class cv{constructor(l,h,m,v,E,T,F,U,Q,G){var q;if(this.boxStartIndex=l.length,Q){let J=T.top,rt=T.bottom;const ut=T.collisionPadding;ut&&(J-=ut[1],rt+=ut[3]);let _t=rt-J;_t>0&&(_t=Math.max(10,_t),this.circleDiameter=_t)}else{const J=!((q=T.image)===null||q===void 0)&&q.content&&(T.image.textFitWidth||T.image.textFitHeight)?nk(T):{x1:T.left,y1:T.top,x2:T.right,y2:T.bottom};J.y1=J.y1*F-U[0],J.y2=J.y2*F+U[2],J.x1=J.x1*F-U[3],J.x2=J.x2*F+U[1];const rt=T.collisionPadding;if(rt&&(J.x1-=rt[0]*F,J.y1-=rt[1]*F,J.x2+=rt[2]*F,J.y2+=rt[3]*F),G){const ut=new b(J.x1,J.y1),_t=new b(J.x2,J.y1),St=new b(J.x1,J.y2),Rt=new b(J.x2,J.y2),Xt=G*Math.PI/180;ut._rotate(Xt),_t._rotate(Xt),St._rotate(Xt),Rt._rotate(Xt),J.x1=Math.min(ut.x,_t.x,St.x,Rt.x),J.x2=Math.max(ut.x,_t.x,St.x,Rt.x),J.y1=Math.min(ut.y,_t.y,St.y,Rt.y),J.y2=Math.max(ut.y,_t.y,St.y,Rt.y)}l.emplaceBack(h.x,h.y,J.x1,J.y1,J.x2,J.y2,m,v,E)}this.boxEndIndex=l.length}}class Rwt{constructor(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Owt;if(this.data=l,this.length=this.data.length,this.compare=h,this.length>0)for(let m=(this.length>>1)-1;m>=0;m--)this._down(m)}push(l){this.data.push(l),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const l=this.data[0],h=this.data.pop();return this.length--,this.length>0&&(this.data[0]=h,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:h,compare:m}=this,v=h[l];for(;l>0;){const E=l-1>>1,T=h[E];if(m(v,T)>=0)break;h[l]=T,l=E}h[l]=v}_down(l){const{data:h,compare:m}=this,v=this.length>>1,E=h[l];for(;l<v;){let T=1+(l<<1),F=h[T];const U=T+1;if(U<this.length&&m(h[U],F)<0&&(T=U,F=h[U]),m(F,E)>=0)break;h[l]=F,l=T}h[l]=E}}function Owt(u,l){return u<l?-1:u>l?1:0}function Dwt(u){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,m=1/0,v=1/0,E=-1/0,T=-1/0;const F=u[0];for(let rt=0;rt<F.length;rt++){const ut=F[rt];(!rt||ut.x<m)&&(m=ut.x),(!rt||ut.y<v)&&(v=ut.y),(!rt||ut.x>E)&&(E=ut.x),(!rt||ut.y>T)&&(T=ut.y)}const U=Math.min(E-m,T-v);let Q=U/2;const G=new Rwt([],Nwt);if(U===0)return new b(m,v);for(let rt=m;rt<E;rt+=U)for(let ut=v;ut<T;ut+=U)G.push(new Rp(rt+Q,ut+Q,Q,u));let q=function(rt){let ut=0,_t=0,St=0;const Rt=rt[0];for(let Xt=0,Qt=Rt.length,qt=Qt-1;Xt<Qt;qt=Xt++){const Ae=Rt[Xt],Be=Rt[qt],qe=Ae.x*Be.y-Be.x*Ae.y;_t+=(Ae.x+Be.x)*qe,St+=(Ae.y+Be.y)*qe,ut+=3*qe}return new Rp(_t/ut,St/ut,0,rt)}(u),J=G.length;for(;G.length;){const rt=G.pop();(rt.d>q.d||!q.d)&&(q=rt,h&&console.log("found best %d after %d probes",Math.round(1e4*rt.d)/1e4,J)),rt.max-q.d<=l||(Q=rt.h/2,G.push(new Rp(rt.p.x-Q,rt.p.y-Q,Q,u)),G.push(new Rp(rt.p.x+Q,rt.p.y-Q,Q,u)),G.push(new Rp(rt.p.x-Q,rt.p.y+Q,Q,u)),G.push(new Rp(rt.p.x+Q,rt.p.y+Q,Q,u)),J+=4)}return h&&(console.log(`num probes: ${J}`),console.log(`best distance: ${q.d}`)),q.p}function Nwt(u,l){return l.max-u.max}function Rp(u,l,h,m){this.p=new b(u,l),this.h=h,this.d=function(v,E){let T=!1,F=1/0;for(let U=0;U<E.length;U++){const Q=E[U];for(let G=0,q=Q.length,J=q-1;G<q;J=G++){const rt=Q[G],ut=Q[J];rt.y>v.y!=ut.y>v.y&&v.x<(ut.x-rt.x)*(v.y-rt.y)/(ut.y-rt.y)+rt.x&&(T=!T),F=Math.min(F,Uc(v,rt,ut))}}return(T?1:-1)*Math.sqrt(F)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}var Qs;a.ar=void 0,(Qs=a.ar||(a.ar={}))[Qs.center=1]="center",Qs[Qs.left=2]="left",Qs[Qs.right=3]="right",Qs[Qs.top=4]="top",Qs[Qs.bottom=5]="bottom",Qs[Qs["top-left"]=6]="top-left",Qs[Qs["top-right"]=7]="top-right",Qs[Qs["bottom-left"]=8]="bottom-left",Qs[Qs["bottom-right"]=9]="bottom-right";const Mh=7,hS=Number.POSITIVE_INFINITY;function Pk(u,l){return l[1]!==hS?function(h,m,v){let E=0,T=0;switch(m=Math.abs(m),v=Math.abs(v),h){case"top-right":case"top-left":case"top":T=v-Mh;break;case"bottom-right":case"bottom-left":case"bottom":T=-v+Mh}switch(h){case"top-right":case"bottom-right":case"right":E=-m;break;case"top-left":case"bottom-left":case"left":E=m}return[E,T]}(u,l[0],l[1]):function(h,m){let v=0,E=0;m<0&&(m=0);const T=m/Math.SQRT2;switch(h){case"top-right":case"top-left":E=T-Mh;break;case"bottom-right":case"bottom-left":E=-T+Mh;break;case"bottom":E=-m+Mh;break;case"top":E=m-Mh}switch(h){case"top-right":case"bottom-right":v=-T;break;case"top-left":case"bottom-left":v=T;break;case"left":v=m;break;case"right":v=-m}return[v,E]}(u,l[0])}function Mk(u,l,h){var m;const v=u.layout,E=(m=v.get("text-variable-anchor-offset"))===null||m===void 0?void 0:m.evaluate(l,{},h);if(E){const F=E.values,U=[];for(let Q=0;Q<F.length;Q+=2){const G=U[Q]=F[Q],q=F[Q+1].map(J=>J*ss);G.startsWith("top")?q[1]-=Mh:G.startsWith("bottom")&&(q[1]+=Mh),U[Q+1]=q}return new mn(U)}const T=v.get("text-variable-anchor");if(T){let F;F=u._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[v.get("text-radial-offset").evaluate(l,{},h)*ss,hS]:v.get("text-offset").evaluate(l,{},h).map(Q=>Q*ss);const U=[];for(const Q of T)U.push(Q,Pk(Q,F));return new mn(U)}return null}function dS(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function kwt(u,l,h,m,v,E,T,F,U,Q,G){let q=E.textMaxSize.evaluate(l,{});q===void 0&&(q=T);const J=u.layers[0].layout,rt=J.get("icon-offset").evaluate(l,{},G),ut=Rk(h.horizontal),_t=T/24,St=u.tilePixelRatio*_t,Rt=u.tilePixelRatio*q/24,Xt=u.tilePixelRatio*F,Qt=u.tilePixelRatio*J.get("symbol-spacing"),qt=J.get("text-padding")*u.tilePixelRatio,Ae=function(ye,mr,Ar){let Nr=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const Jn=ye.get("icon-padding").evaluate(mr,{},Ar),qn=Jn&&Jn.values;return[qn[0]*Nr,qn[1]*Nr,qn[2]*Nr,qn[3]*Nr]}(J,l,G,u.tilePixelRatio),Be=J.get("text-max-angle")/180*Math.PI,qe=J.get("text-rotation-alignment")!=="viewport"&&J.get("symbol-placement")!=="point",wr=J.get("icon-rotation-alignment")==="map"&&J.get("symbol-placement")!=="point",Ke=J.get("symbol-placement"),Ve=Qt/2,dr=J.get("icon-text-fit");let sr;m&&dr!=="none"&&(u.allowVerticalPlacement&&h.vertical&&(sr=ik(m,h.vertical,dr,J.get("icon-text-fit-padding"),rt,_t)),ut&&(m=ik(m,ut,dr,J.get("icon-text-fit-padding"),rt,_t)));const rr=(ye,mr)=>{mr.x<0||mr.x>=Ci||mr.y<0||mr.y>=Ci||function(Ar,Nr,Jn,qn,fs,Gl,zs,Li,So,To,Io,Pi,ps,io,Hs,Fo,Vs,el,ea,Cn,ri,ci,wa,Ei,Op){const Cu=Ar.addToLineVertexArray(Nr,Jn);let Eu,jl,rl,Fs,BA=0,h0=0,kk=0,Qk=0,bS=-1,wS=-1;const CA={};let zk=wh("");if(Ar.allowVerticalPlacement&&qn.vertical){const so=Li.layout.get("text-rotate").evaluate(ri,{},Ei)+90;rl=new cv(So,Nr,To,Io,Pi,qn.vertical,ps,io,Hs,so),zs&&(Fs=new cv(So,Nr,To,Io,Pi,zs,Vs,el,Hs,so))}if(fs){const so=Li.layout.get("icon-rotate").evaluate(ri,{}),nl=Li.layout.get("icon-text-fit")!=="none",jd=Fk(fs,so,wa,nl),Oc=zs?Fk(zs,so,wa,nl):void 0;jl=new cv(So,Nr,To,Io,Pi,fs,Vs,el,!1,so),BA=4*jd.length;const qd=Ar.iconSizeData;let Su=null;qd.kind==="source"?(Su=[Bu*Li.layout.get("icon-size").evaluate(ri,{})],Su[0]>Fh&&wt(`${Ar.layerIds[0]}: Value for "icon-size" is >= ${l0}. Reduce your "icon-size".`)):qd.kind==="composite"&&(Su=[Bu*ci.compositeIconSizes[0].evaluate(ri,{},Ei),Bu*ci.compositeIconSizes[1].evaluate(ri,{},Ei)],(Su[0]>Fh||Su[1]>Fh)&&wt(`${Ar.layerIds[0]}: Value for "icon-size" is >= ${l0}. Reduce your "icon-size".`)),Ar.addSymbols(Ar.icon,jd,Su,Cn,ea,ri,a.ai.none,Nr,Cu.lineStartIndex,Cu.lineLength,-1,Ei),bS=Ar.icon.placedSymbolArray.length-1,Oc&&(h0=4*Oc.length,Ar.addSymbols(Ar.icon,Oc,Su,Cn,ea,ri,a.ai.vertical,Nr,Cu.lineStartIndex,Cu.lineLength,-1,Ei),wS=Ar.icon.placedSymbolArray.length-1)}const Hk=Object.keys(qn.horizontal);for(const so of Hk){const nl=qn.horizontal[so];if(!Eu){zk=wh(nl.text);const Oc=Li.layout.get("text-rotate").evaluate(ri,{},Ei);Eu=new cv(So,Nr,To,Io,Pi,nl,ps,io,Hs,Oc)}const jd=nl.positionedLines.length===1;if(kk+=Uk(Ar,Nr,nl,Gl,Li,Hs,ri,Fo,Cu,qn.vertical?a.ai.horizontal:a.ai.horizontalOnly,jd?Hk:[so],CA,bS,ci,Ei),jd)break}qn.vertical&&(Qk+=Uk(Ar,Nr,qn.vertical,Gl,Li,Hs,ri,Fo,Cu,a.ai.vertical,["vertical"],CA,wS,ci,Ei));const Hwt=Eu?Eu.boxStartIndex:Ar.collisionBoxArray.length,Vwt=Eu?Eu.boxEndIndex:Ar.collisionBoxArray.length,Gwt=rl?rl.boxStartIndex:Ar.collisionBoxArray.length,jwt=rl?rl.boxEndIndex:Ar.collisionBoxArray.length,qwt=jl?jl.boxStartIndex:Ar.collisionBoxArray.length,Kwt=jl?jl.boxEndIndex:Ar.collisionBoxArray.length,$wt=Fs?Fs.boxStartIndex:Ar.collisionBoxArray.length,Wwt=Fs?Fs.boxEndIndex:Ar.collisionBoxArray.length;let Rc=-1;const Av=(so,nl)=>so&&so.circleDiameter?Math.max(so.circleDiameter,nl):nl;Rc=Av(Eu,Rc),Rc=Av(rl,Rc),Rc=Av(jl,Rc),Rc=Av(Fs,Rc);const Vk=Rc>-1?1:0;Vk&&(Rc*=Op/ss),Ar.glyphOffsetArray.length>=Mp.MAX_GLYPHS&&wt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ri.sortKey!==void 0&&Ar.addToSortKeyRanges(Ar.symbolInstances.length,ri.sortKey);const Xwt=Mk(Li,ri,Ei),[Jwt,Ywt]=function(so,nl){const jd=so.length,Oc=nl==null?void 0:nl.values;if((Oc==null?void 0:Oc.length)>0)for(let qd=0;qd<Oc.length;qd+=2){const Su=Oc[qd+1];so.emplaceBack(a.ar[Oc[qd]],Su[0],Su[1])}return[jd,so.length]}(Ar.textAnchorOffsets,Xwt);Ar.symbolInstances.emplaceBack(Nr.x,Nr.y,CA.right>=0?CA.right:-1,CA.center>=0?CA.center:-1,CA.left>=0?CA.left:-1,CA.vertical||-1,bS,wS,zk,Hwt,Vwt,Gwt,jwt,qwt,Kwt,$wt,Wwt,To,kk,Qk,BA,h0,Vk,0,ps,Rc,Jwt,Ywt)}(u,mr,ye,h,m,v,sr,u.layers[0],u.collisionBoxArray,l.index,l.sourceLayerIndex,u.index,St,[qt,qt,qt,qt],qe,U,Xt,Ae,wr,rt,l,E,Q,G,T)};if(Ke==="line")for(const ye of Bk(l.geometry,0,0,Ci,Ci)){const mr=Uwt(ye,Qt,Be,h.vertical||ut,m,24,Rt,u.overscaling,Ci);for(const Ar of mr)ut&&Qwt(u,ut.text,Ve,Ar)||rr(ye,Ar)}else if(Ke==="line-center"){for(const ye of l.geometry)if(ye.length>1){const mr=Mwt(ye,Be,h.vertical||ut,m,24,Rt);mr&&rr(ye,mr)}}else if(l.type==="Polygon")for(const ye of wl(l.geometry,0)){const mr=Dwt(ye,16);rr(ye[0],new Ph(mr.x,mr.y,0))}else if(l.type==="LineString")for(const ye of l.geometry)rr(ye,new Ph(ye[0].x,ye[0].y,0));else if(l.type==="Point")for(const ye of l.geometry)for(const mr of ye)rr([mr],new Ph(mr.x,mr.y,0))}function Uk(u,l,h,m,v,E,T,F,U,Q,G,q,J,rt,ut){const _t=function(Xt,Qt,qt,Ae,Be,qe,wr,Ke){const Ve=Ae.layout.get("text-rotate").evaluate(qe,{})*Math.PI/180,dr=[];for(const sr of Qt.positionedLines)for(const rr of sr.positionedGlyphs){if(!rr.rect)continue;const ye=rr.rect||{};let mr=XN+1,Ar=!0,Nr=1,Jn=0;const qn=(Be||Ke)&&rr.vertical,fs=rr.metrics.advance*rr.scale/2;if(Ke&&Qt.verticalizable&&(Jn=sr.lineOffset/2-(rr.imageName?-(ss-rr.metrics.width*rr.scale)/2:(rr.scale-1)*ss)),rr.imageName){const Cn=wr[rr.imageName];Ar=Cn.sdf,Nr=Cn.pixelRatio,mr=ta/Nr}const Gl=Be?[rr.x+fs,rr.y]:[0,0];let zs=Be?[0,0]:[rr.x+fs+qt[0],rr.y+qt[1]-Jn],Li=[0,0];qn&&(Li=zs,zs=[0,0]);const So=rr.metrics.isDoubleResolution?2:1,To=(rr.metrics.left-mr)*rr.scale-fs+zs[0],Io=(-rr.metrics.top-mr)*rr.scale+zs[1],Pi=To+ye.w/So*rr.scale/Nr,ps=Io+ye.h/So*rr.scale/Nr,io=new b(To,Io),Hs=new b(Pi,Io),Fo=new b(To,ps),Vs=new b(Pi,ps);if(qn){const Cn=new b(-fs,fs-o0),ri=-Math.PI/2,ci=ss/2-fs,wa=new b(5-o0-ci,-(rr.imageName?ci:0)),Ei=new b(...Li);io._rotateAround(ri,Cn)._add(wa)._add(Ei),Hs._rotateAround(ri,Cn)._add(wa)._add(Ei),Fo._rotateAround(ri,Cn)._add(wa)._add(Ei),Vs._rotateAround(ri,Cn)._add(wa)._add(Ei)}if(Ve){const Cn=Math.sin(Ve),ri=Math.cos(Ve),ci=[ri,-Cn,Cn,ri];io._matMult(ci),Hs._matMult(ci),Fo._matMult(ci),Vs._matMult(ci)}const el=new b(0,0),ea=new b(0,0);dr.push({tl:io,tr:Hs,bl:Fo,br:Vs,tex:ye,writingMode:Qt.writingMode,glyphOffset:Gl,sectionIndex:rr.sectionIndex,isSDF:Ar,pixelOffsetTL:el,pixelOffsetBR:ea,minFontScaleX:0,minFontScaleY:0})}return dr}(0,h,F,v,E,T,m,u.allowVerticalPlacement),St=u.textSizeData;let Rt=null;St.kind==="source"?(Rt=[Bu*v.layout.get("text-size").evaluate(T,{})],Rt[0]>Fh&&wt(`${u.layerIds[0]}: Value for "text-size" is >= ${l0}. Reduce your "text-size".`)):St.kind==="composite"&&(Rt=[Bu*rt.compositeTextSizes[0].evaluate(T,{},ut),Bu*rt.compositeTextSizes[1].evaluate(T,{},ut)],(Rt[0]>Fh||Rt[1]>Fh)&&wt(`${u.layerIds[0]}: Value for "text-size" is >= ${l0}. Reduce your "text-size".`)),u.addSymbols(u.text,_t,Rt,F,E,T,Q,l,U.lineStartIndex,U.lineLength,J,ut);for(const Xt of G)q[Xt]=u.text.placedSymbolArray.length-1;return 4*_t.length}function Rk(u){for(const l in u)return u[l];return null}function Qwt(u,l,h,m){const v=u.compareText;if(l in v){const E=v[l];for(let T=E.length-1;T>=0;T--)if(m.dist(E[T])<h)return!0}else v[l]=[];return v[l].push(m),!1}const Ok=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class fS{static from(l){if(!(l instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,m]=new Uint8Array(l,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const v=m>>4;if(v!==1)throw new Error(`Got v${v} data when expected v1.`);const E=Ok[15&m];if(!E)throw new Error("Unrecognized array type.");const[T]=new Uint16Array(l,2,1),[F]=new Uint32Array(l,4,1);return new fS(F,T,E,l)}constructor(l){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,v=arguments.length>3?arguments[3]:void 0;if(isNaN(l)||l<0)throw new Error(`Unpexpected numItems value: ${l}.`);this.numItems=+l,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=m,this.IndexArrayType=l<65536?Uint16Array:Uint32Array;const E=Ok.indexOf(this.ArrayType),T=2*l*this.ArrayType.BYTES_PER_ELEMENT,F=l*this.IndexArrayType.BYTES_PER_ELEMENT,U=(8-F%8)%8;if(E<0)throw new Error(`Unexpected typed array class: ${m}.`);v&&v instanceof ArrayBuffer?(this.data=v,this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+F+U,2*l),this._pos=2*l,this._finished=!0):(this.data=new ArrayBuffer(8+T+F+U),this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+F+U,2*l),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+E]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=l)}add(l,h){const m=this._pos>>1;return this.ids[m]=m,this.coords[this._pos++]=l,this.coords[this._pos++]=h,m}finish(){const l=this._pos>>1;if(l!==this.numItems)throw new Error(`Added ${l} items when expected ${this.numItems}.`);return pS(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(l,h,m,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:E,coords:T,nodeSize:F}=this,U=[0,E.length-1,0],Q=[];for(;U.length;){const G=U.pop()||0,q=U.pop()||0,J=U.pop()||0;if(q-J<=F){for(let St=J;St<=q;St++){const Rt=T[2*St],Xt=T[2*St+1];Rt>=l&&Rt<=m&&Xt>=h&&Xt<=v&&Q.push(E[St])}continue}const rt=J+q>>1,ut=T[2*rt],_t=T[2*rt+1];ut>=l&&ut<=m&&_t>=h&&_t<=v&&Q.push(E[rt]),(G===0?l<=ut:h<=_t)&&(U.push(J),U.push(rt-1),U.push(1-G)),(G===0?m>=ut:v>=_t)&&(U.push(rt+1),U.push(q),U.push(1-G))}return Q}within(l,h,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:E,nodeSize:T}=this,F=[0,v.length-1,0],U=[],Q=m*m;for(;F.length;){const G=F.pop()||0,q=F.pop()||0,J=F.pop()||0;if(q-J<=T){for(let St=J;St<=q;St++)Nk(E[2*St],E[2*St+1],l,h)<=Q&&U.push(v[St]);continue}const rt=J+q>>1,ut=E[2*rt],_t=E[2*rt+1];Nk(ut,_t,l,h)<=Q&&U.push(v[rt]),(G===0?l-m<=ut:h-m<=_t)&&(F.push(J),F.push(rt-1),F.push(1-G)),(G===0?l+m>=ut:h+m>=_t)&&(F.push(rt+1),F.push(q),F.push(1-G))}return U}}function pS(u,l,h,m,v,E){if(v-m<=h)return;const T=m+v>>1;Dk(u,l,T,m,v,E),pS(u,l,h,m,T-1,1-E),pS(u,l,h,T+1,v,1-E)}function Dk(u,l,h,m,v,E){for(;v>m;){if(v-m>600){const Q=v-m+1,G=h-m+1,q=Math.log(Q),J=.5*Math.exp(2*q/3),rt=.5*Math.sqrt(q*J*(Q-J)/Q)*(G-Q/2<0?-1:1);Dk(u,l,h,Math.max(m,Math.floor(h-G*J/Q+rt)),Math.min(v,Math.floor(h+(Q-G)*J/Q+rt)),E)}const T=l[2*h+E];let F=m,U=v;for(u0(u,l,m,h),l[2*v+E]>T&&u0(u,l,m,v);F<U;){for(u0(u,l,F,U),F++,U--;l[2*F+E]<T;)F++;for(;l[2*U+E]>T;)U--}l[2*m+E]===T?u0(u,l,m,U):(U++,u0(u,l,U,v)),U<=h&&(m=U+1),h<=U&&(v=U-1)}}function u0(u,l,h,m){gS(u,h,m),gS(l,2*h,2*m),gS(l,2*h+1,2*m+1)}function gS(u,l,h){const m=u[l];u[l]=u[h],u[h]=m}function Nk(u,l,h,m){const v=u-h,E=l-m;return v*v+E*E}var mS;a.bf=void 0,(mS=a.bf||(a.bf={})).create="create",mS.load="load",mS.fullLoad="fullLoad";let uv=null,A0=[];const yS=1e3/60,_S="loadTime",vS="fullLoadTime",zwt={mark(u){performance.mark(u)},frame(u){const l=u;uv!=null&&A0.push(l-uv),uv=l},clearMetrics(){uv=null,A0=[],performance.clearMeasures(_S),performance.clearMeasures(vS);for(const u in a.bf)performance.clearMarks(a.bf[u])},getPerformanceMetrics(){performance.measure(_S,a.bf.create,a.bf.load),performance.measure(vS,a.bf.create,a.bf.fullLoad);const u=performance.getEntriesByName(_S)[0].duration,l=performance.getEntriesByName(vS)[0].duration,h=A0.length,m=1/(A0.reduce((E,T)=>E+T,0)/h/1e3),v=A0.filter(E=>E>yS).reduce((E,T)=>E+(T-yS)/yS,0);return{loadTime:u,fullLoadTime:l,fps:m,percentDroppedFrames:v/(h+v)*100,totalFrames:h}}};a.$=class extends H{},a.A=Sp,a.B=Ld,a.C=function(u){if(Wt==null){const l=u.navigator?u.navigator.userAgent:null;Wt=!!u.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return Wt},a.D=ur,a.E=he,a.F=class{constructor(u,l){this.target=u,this.mapId=l,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Lwt(()=>this.process()),this.subscription=function(h,m,v,E){return h.addEventListener(m,v,!1),{unsubscribe:()=>{h.removeEventListener(m,v,!1)}}}(this.target,"message",h=>this.receive(h)),this.globalScope=$t(self)?u:window}registerMessageHandler(u,l){this.messageHandlers[u]=l}sendAsync(u,l){return new Promise((h,m)=>{const v=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[v]={resolve:h,reject:m},l&&l.signal.addEventListener("abort",()=>{delete this.resolveRejects[v];const F={id:v,type:"<cancel>",origin:location.origin,targetMapId:u.targetMapId,sourceMapId:this.mapId};this.target.postMessage(F)},{once:!0});const E=[],T=Object.assign(Object.assign({},u),{id:v,sourceMapId:this.mapId,origin:location.origin,data:yu(u.data,E)});this.target.postMessage(T,{transfer:E})})}receive(u){const l=u.data,h=l.id;if(!(l.origin!=="file://"&&location.origin!=="file://"&&l.origin!==location.origin||l.targetMapId&&this.mapId!==l.targetMapId)){if(l.type==="<cancel>"){delete this.tasks[h];const m=this.abortControllers[h];return delete this.abortControllers[h],void(m&&m.abort())}if($t(self)||l.mustQueue)return this.tasks[h]=l,this.taskQueue.push(h),void this.invoker.trigger();this.processTask(h,l)}}process(){if(this.taskQueue.length===0)return;const u=this.taskQueue.shift(),l=this.tasks[u];delete this.tasks[u],this.taskQueue.length>0&&this.invoker.trigger(),l&&this.processTask(u,l)}processTask(u,l){return o(this,void 0,void 0,function*(){if(l.type==="<response>"){const v=this.resolveRejects[u];return delete this.resolveRejects[u],v?void(l.error?v.reject(ns(l.error)):v.resolve(ns(l.data))):void 0}if(!this.messageHandlers[l.type])return void this.completeTask(u,new Error(`Could not find a registered handler for ${l.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const h=ns(l.data),m=new AbortController;this.abortControllers[u]=m;try{const v=yield this.messageHandlers[l.type](l.sourceMapId,h,m);this.completeTask(u,null,v)}catch(v){this.completeTask(u,v)}})}completeTask(u,l,h){const m=[];delete this.abortControllers[u];const v={id:u,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:l?yu(l):null,data:yu(h,m)};this.target.postMessage(v,{transfer:m})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},a.G=jt,a.H=function(){var u=new Sp(16);return Sp!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},a.I=eS,a.J=function(u,l,h){var m,v,E,T,F,U,Q,G,q,J,rt,ut,_t=h[0],St=h[1],Rt=h[2];return l===u?(u[12]=l[0]*_t+l[4]*St+l[8]*Rt+l[12],u[13]=l[1]*_t+l[5]*St+l[9]*Rt+l[13],u[14]=l[2]*_t+l[6]*St+l[10]*Rt+l[14],u[15]=l[3]*_t+l[7]*St+l[11]*Rt+l[15]):(v=l[1],E=l[2],T=l[3],F=l[4],U=l[5],Q=l[6],G=l[7],q=l[8],J=l[9],rt=l[10],ut=l[11],u[0]=m=l[0],u[1]=v,u[2]=E,u[3]=T,u[4]=F,u[5]=U,u[6]=Q,u[7]=G,u[8]=q,u[9]=J,u[10]=rt,u[11]=ut,u[12]=m*_t+F*St+q*Rt+l[12],u[13]=v*_t+U*St+J*Rt+l[13],u[14]=E*_t+Q*St+rt*Rt+l[14],u[15]=T*_t+G*St+ut*Rt+l[15]),u},a.K=function(u,l,h){var m=h[0],v=h[1],E=h[2];return u[0]=l[0]*m,u[1]=l[1]*m,u[2]=l[2]*m,u[3]=l[3]*m,u[4]=l[4]*v,u[5]=l[5]*v,u[6]=l[6]*v,u[7]=l[7]*v,u[8]=l[8]*E,u[9]=l[9]*E,u[10]=l[10]*E,u[11]=l[11]*E,u[12]=l[12],u[13]=l[13],u[14]=l[14],u[15]=l[15],u},a.L=yN,a.M=function(u,l){const h={};for(let m=0;m<l.length;m++){const v=l[m];v in u&&(h[v]=u[v])}return h},a.N=Lh,a.O=dk,a.P=b,a.Q=fk,a.R=Za,a.S=tl,a.T=Sc,a.U=z,a.V=V,a.W=ee,a.X=Ci,a.Y=L,a.Z=sv,a._=o,a.a=It,a.a$=function(u,l){var h=u[0],m=u[1],v=u[2],E=u[3],T=u[4],F=u[5],U=u[6],Q=u[7],G=u[8],q=u[9],J=u[10],rt=u[11],ut=u[12],_t=u[13],St=u[14],Rt=u[15],Xt=l[0],Qt=l[1],qt=l[2],Ae=l[3],Be=l[4],qe=l[5],wr=l[6],Ke=l[7],Ve=l[8],dr=l[9],sr=l[10],rr=l[11],ye=l[12],mr=l[13],Ar=l[14],Nr=l[15];return Math.abs(h-Xt)<=Eo*Math.max(1,Math.abs(h),Math.abs(Xt))&&Math.abs(m-Qt)<=Eo*Math.max(1,Math.abs(m),Math.abs(Qt))&&Math.abs(v-qt)<=Eo*Math.max(1,Math.abs(v),Math.abs(qt))&&Math.abs(E-Ae)<=Eo*Math.max(1,Math.abs(E),Math.abs(Ae))&&Math.abs(T-Be)<=Eo*Math.max(1,Math.abs(T),Math.abs(Be))&&Math.abs(F-qe)<=Eo*Math.max(1,Math.abs(F),Math.abs(qe))&&Math.abs(U-wr)<=Eo*Math.max(1,Math.abs(U),Math.abs(wr))&&Math.abs(Q-Ke)<=Eo*Math.max(1,Math.abs(Q),Math.abs(Ke))&&Math.abs(G-Ve)<=Eo*Math.max(1,Math.abs(G),Math.abs(Ve))&&Math.abs(q-dr)<=Eo*Math.max(1,Math.abs(q),Math.abs(dr))&&Math.abs(J-sr)<=Eo*Math.max(1,Math.abs(J),Math.abs(sr))&&Math.abs(rt-rr)<=Eo*Math.max(1,Math.abs(rt),Math.abs(rr))&&Math.abs(ut-ye)<=Eo*Math.max(1,Math.abs(ut),Math.abs(ye))&&Math.abs(_t-mr)<=Eo*Math.max(1,Math.abs(_t),Math.abs(mr))&&Math.abs(St-Ar)<=Eo*Math.max(1,Math.abs(St),Math.abs(Ar))&&Math.abs(Rt-Nr)<=Eo*Math.max(1,Math.abs(Rt),Math.abs(Nr))},a.a0=li,a.a1=AS,a.a2=pe,a.a3=u=>{const l=window.document.createElement("video");return l.muted=!0,new Promise(h=>{l.onloadstart=()=>{h(l)};for(const m of u){const v=window.document.createElement("source");Ce(m)||(l.crossOrigin="Anonymous"),v.src=m,l.appendChild(v)}})},a.a4=function(){return dt++},a.a5=He,a.a6=Mp,a.a7=en,a.a8=wA,a.a9=Un,a.aA=function(u){u=u.slice();const l=Object.create(null);for(let h=0;h<u.length;h++)l[u[h].id]=u[h];for(let h=0;h<u.length;h++)"ref"in u[h]&&(u[h]=er(u[h],l[u[h].ref]));return u},a.aB=function(u){if(u.type==="custom")return new Fwt(u);switch(u.type){case"background":return new Swt(u);case"circle":return new fbt(u);case"fill":return new Lbt(u);case"fill-extrusion":return new qbt(u);case"heatmap":return new gbt(u);case"hillshade":return new ybt(u);case"line":return new twt(u);case"raster":return new Iwt(u);case"symbol":return new iv(u)}},a.aC=ot,a.aD=function(u,l){if(!u)return[{command:"setStyle",args:[l]}];let h=[];try{if(!de(u.version,l.version))return[{command:"setStyle",args:[l]}];de(u.center,l.center)||h.push({command:"setCenter",args:[l.center]}),de(u.zoom,l.zoom)||h.push({command:"setZoom",args:[l.zoom]}),de(u.bearing,l.bearing)||h.push({command:"setBearing",args:[l.bearing]}),de(u.pitch,l.pitch)||h.push({command:"setPitch",args:[l.pitch]}),de(u.sprite,l.sprite)||h.push({command:"setSprite",args:[l.sprite]}),de(u.glyphs,l.glyphs)||h.push({command:"setGlyphs",args:[l.glyphs]}),de(u.transition,l.transition)||h.push({command:"setTransition",args:[l.transition]}),de(u.light,l.light)||h.push({command:"setLight",args:[l.light]}),de(u.terrain,l.terrain)||h.push({command:"setTerrain",args:[l.terrain]}),de(u.sky,l.sky)||h.push({command:"setSky",args:[l.sky]}),de(u.projection,l.projection)||h.push({command:"setProjection",args:[l.projection]});const m={},v=[];(function(T,F,U,Q){let G;for(G in F=F||{},T=T||{})Object.prototype.hasOwnProperty.call(T,G)&&(Object.prototype.hasOwnProperty.call(F,G)||Ue(G,U,Q));for(G in F)Object.prototype.hasOwnProperty.call(F,G)&&(Object.prototype.hasOwnProperty.call(T,G)?de(T[G],F[G])||(T[G].type==="geojson"&&F[G].type==="geojson"&&lr(T,F,G)?ve(U,{command:"setGeoJSONSourceData",args:[G,F[G].data]}):Ye(G,F,U,Q)):Le(G,F,U))})(u.sources,l.sources,v,m);const E=[];u.layers&&u.layers.forEach(T=>{"source"in T&&m[T.source]?h.push({command:"removeLayer",args:[T.id]}):E.push(T)}),h=h.concat(v),function(T,F,U){F=F||[];const Q=(T=T||[]).map(Lr),G=F.map(Lr),q=T.reduce(Dr,{}),J=F.reduce(Dr,{}),rt=Q.slice(),ut=Object.create(null);let _t,St,Rt,Xt,Qt;for(let qt=0,Ae=0;qt<Q.length;qt++)_t=Q[qt],Object.prototype.hasOwnProperty.call(J,_t)?Ae++:(ve(U,{command:"removeLayer",args:[_t]}),rt.splice(rt.indexOf(_t,Ae),1));for(let qt=0,Ae=0;qt<G.length;qt++)_t=G[G.length-1-qt],rt[rt.length-1-qt]!==_t&&(Object.prototype.hasOwnProperty.call(q,_t)?(ve(U,{command:"removeLayer",args:[_t]}),rt.splice(rt.lastIndexOf(_t,rt.length-Ae),1)):Ae++,Xt=rt[rt.length-qt],ve(U,{command:"addLayer",args:[J[_t],Xt]}),rt.splice(rt.length-qt,0,_t),ut[_t]=!0);for(let qt=0;qt<G.length;qt++)if(_t=G[qt],St=q[_t],Rt=J[_t],!ut[_t]&&!de(St,Rt))if(de(St.source,Rt.source)&&de(St["source-layer"],Rt["source-layer"])&&de(St.type,Rt.type)){for(Qt in yr(St.layout,Rt.layout,U,_t,null,"setLayoutProperty"),yr(St.paint,Rt.paint,U,_t,null,"setPaintProperty"),de(St.filter,Rt.filter)||ve(U,{command:"setFilter",args:[_t,Rt.filter]}),de(St.minzoom,Rt.minzoom)&&de(St.maxzoom,Rt.maxzoom)||ve(U,{command:"setLayerZoomRange",args:[_t,Rt.minzoom,Rt.maxzoom]}),St)Object.prototype.hasOwnProperty.call(St,Qt)&&Qt!=="layout"&&Qt!=="paint"&&Qt!=="filter"&&Qt!=="metadata"&&Qt!=="minzoom"&&Qt!=="maxzoom"&&(Qt.indexOf("paint.")===0?yr(St[Qt],Rt[Qt],U,_t,Qt.slice(6),"setPaintProperty"):de(St[Qt],Rt[Qt])||ve(U,{command:"setLayerProperty",args:[_t,Qt,Rt[Qt]]}));for(Qt in Rt)Object.prototype.hasOwnProperty.call(Rt,Qt)&&!Object.prototype.hasOwnProperty.call(St,Qt)&&Qt!=="layout"&&Qt!=="paint"&&Qt!=="filter"&&Qt!=="metadata"&&Qt!=="minzoom"&&Qt!=="maxzoom"&&(Qt.indexOf("paint.")===0?yr(St[Qt],Rt[Qt],U,_t,Qt.slice(6),"setPaintProperty"):de(St[Qt],Rt[Qt])||ve(U,{command:"setLayerProperty",args:[_t,Qt,Rt[Qt]]}))}else ve(U,{command:"removeLayer",args:[_t]}),Xt=rt[rt.lastIndexOf(_t)+1],ve(U,{command:"addLayer",args:[Rt,Xt]})}(E,l.layers,h)}catch(m){console.warn("Unable to compute style diff:",m),h=[{command:"setStyle",args:[l]}]}return h},a.aE=function(u){const l=[],h=u.id;return h===void 0&&l.push({message:`layers.${h}: missing required property "id"`}),u.render===void 0&&l.push({message:`layers.${h}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&l.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),l},a.aF=function u(l,h){if(Array.isArray(l)){if(!Array.isArray(h)||l.length!==h.length)return!1;for(let m=0;m<l.length;m++)if(!u(l[m],h[m]))return!1;return!0}if(typeof l=="object"&&l!==null&&h!==null){if(typeof h!="object"||Object.keys(l).length!==Object.keys(h).length)return!1;for(const m in l)if(!u(l[m],h[m]))return!1;return!0}return l===h},a.aG=Ft,a.aH=Tt,a.aI=class extends vA{constructor(u,l){super(u,l),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},a.aJ=kd,a.aK=class extends vA{constructor(u,l){super(u,l),this.current=q_}set(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let l=1;l<16;l++)if(u[l]!==this.current[l]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}},a.aL=Qd,a.aM=Gm,a.aN=or,a.aO=class extends vA{constructor(u,l){super(u,l),this.current=[0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))}},a.aP=class extends vA{constructor(u,l){super(u,l),this.current=[0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))}},a.aQ=function(u,l,h,m,v,E,T){var F=1/(l-h),U=1/(m-v),Q=1/(E-T);return u[0]=-2*F,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*U,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*Q,u[11]=0,u[12]=(l+h)*F,u[13]=(v+m)*U,u[14]=(T+E)*Q,u[15]=1,u},a.aR=dbt,a.aS=class extends Dt{},a.aT=iwt,a.aU=class extends ue{},a.aV=function(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))},a.aW=xN,a.aX=Gi,a.aY=wi,a.aZ=class extends be{},a.a_=function(u,l){return u[0]===l[0]&&u[1]===l[1]&&u[2]===l[2]&&u[3]===l[3]&&u[4]===l[4]&&u[5]===l[5]&&u[6]===l[6]&&u[7]===l[7]&&u[8]===l[8]&&u[9]===l[9]&&u[10]===l[10]&&u[11]===l[11]&&u[12]===l[12]&&u[13]===l[13]&&u[14]===l[14]&&u[15]===l[15]},a.aa=vk,a.ab=function(u){const l={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,m,v,E)=>{const T=v||E;return l[m]=!T||T.toLowerCase(),""}),l["max-age"]){const h=parseInt(l["max-age"],10);isNaN(h)?delete l["max-age"]:l["max-age"]=h}return l},a.ac=function(u,l){const h=[];for(const m in u)m in l||h.push(m);return h},a.ad=pt,a.ae=function(u,l,h){var m=Math.sin(h),v=Math.cos(h),E=l[0],T=l[1],F=l[2],U=l[3],Q=l[4],G=l[5],q=l[6],J=l[7];return l!==u&&(u[8]=l[8],u[9]=l[9],u[10]=l[10],u[11]=l[11],u[12]=l[12],u[13]=l[13],u[14]=l[14],u[15]=l[15]),u[0]=E*v+Q*m,u[1]=T*v+G*m,u[2]=F*v+q*m,u[3]=U*v+J*m,u[4]=Q*v-E*m,u[5]=G*v-T*m,u[6]=q*v-F*m,u[7]=J*v-U*m,u},a.af=function(u){var l=new Sp(16);return l[0]=u[0],l[1]=u[1],l[2]=u[2],l[3]=u[3],l[4]=u[4],l[5]=u[5],l[6]=u[6],l[7]=u[7],l[8]=u[8],l[9]=u[9],l[10]=u[10],l[11]=u[11],l[12]=u[12],l[13]=u[13],l[14]=u[14],l[15]=u[15],l},a.ag=$_,a.ah=function(u,l){let h=0,m=0;if(u.kind==="constant")m=u.layoutSize;else if(u.kind!=="source"){const{interpolationType:v,minZoom:E,maxZoom:T}=u,F=v?pt(Ir.interpolationFactor(v,l,E,T),0,1):0;u.kind==="camera"?m=As.number(u.minSize,u.maxSize,F):h=F}return{uSizeT:h,uSize:m}},a.aj=function(u,l,h){let{uSize:m,uSizeT:v}=l,{lowerSize:E,upperSize:T}=h;return u.kind==="source"?E/Bu:u.kind==="composite"?As.number(E/Bu,T/Bu,v):m},a.ak=sS,a.al=function(u,l,h,m){const v=l.y-u.y,E=l.x-u.x,T=m.y-h.y,F=m.x-h.x,U=T*E-F*v;if(U===0)return null;const Q=(F*(u.y-h.y)-T*(u.x-h.x))/U;return new b(u.x+Q*E,u.y+Q*v)},a.am=Bk,a.an=Xm,a.ao=kE,a.ap=function(u){let l=1/0,h=1/0,m=-1/0,v=-1/0;for(const E of u)l=Math.min(l,E.x),h=Math.min(h,E.y),m=Math.max(m,E.x),v=Math.max(v,E.y);return[l,h,m,v]},a.aq=ss,a.as=iS,a.at=function(u,l){var h=l[0],m=l[1],v=l[2],E=l[3],T=l[4],F=l[5],U=l[6],Q=l[7],G=l[8],q=l[9],J=l[10],rt=l[11],ut=l[12],_t=l[13],St=l[14],Rt=l[15],Xt=h*F-m*T,Qt=h*U-v*T,qt=h*Q-E*T,Ae=m*U-v*F,Be=m*Q-E*F,qe=v*Q-E*U,wr=G*_t-q*ut,Ke=G*St-J*ut,Ve=G*Rt-rt*ut,dr=q*St-J*_t,sr=q*Rt-rt*_t,rr=J*Rt-rt*St,ye=Xt*rr-Qt*sr+qt*dr+Ae*Ve-Be*Ke+qe*wr;return ye?(u[0]=(F*rr-U*sr+Q*dr)*(ye=1/ye),u[1]=(v*sr-m*rr-E*dr)*ye,u[2]=(_t*qe-St*Be+Rt*Ae)*ye,u[3]=(J*Be-q*qe-rt*Ae)*ye,u[4]=(U*Ve-T*rr-Q*Ke)*ye,u[5]=(h*rr-v*Ve+E*Ke)*ye,u[6]=(St*qt-ut*qe-Rt*Qt)*ye,u[7]=(G*qe-J*qt+rt*Qt)*ye,u[8]=(T*sr-F*Ve+Q*wr)*ye,u[9]=(m*Ve-h*sr-E*wr)*ye,u[10]=(ut*Be-_t*qt+Rt*Xt)*ye,u[11]=(q*qt-G*Be-rt*Xt)*ye,u[12]=(F*Ke-T*dr-U*wr)*ye,u[13]=(h*dr-m*Ke+v*wr)*ye,u[14]=(_t*Qt-ut*Ae-St*Xt)*ye,u[15]=(G*Ae-q*Qt+J*Xt)*ye,u):null},a.au=dS,a.av=nS,a.aw=fS,a.ax=function(){const u={},l=st.$version;for(const h in st.$root){const m=st.$root[h];if(m.required){let v=null;v=h==="version"?l:m.type==="array"?[]:{},v!=null&&(u[h]=v)}}return u},a.ay=ro,a.az=re,a.b=Yt,a.b0=function(u,l){return u[0]=l[0],u[1]=l[1],u[2]=l[2],u[3]=l[3],u[4]=l[4],u[5]=l[5],u[6]=l[6],u[7]=l[7],u[8]=l[8],u[9]=l[9],u[10]=l[10],u[11]=l[11],u[12]=l[12],u[13]=l[13],u[14]=l[14],u[15]=l[15],u},a.b1=function(u,l,h){return u[0]=l[0]*h[0],u[1]=l[1]*h[1],u[2]=l[2]*h[2],u[3]=l[3]*h[3],u},a.b2=function(u,l){return u[0]*l[0]+u[1]*l[1]+u[2]*l[2]+u[3]*l[3]},a.b3=gt,a.b4=mk,a.b5=pk,a.b6=function(u,l,h,m,v){var E,T=1/Math.tan(l/2);return u[0]=T/h,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=T,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,v!=null&&v!==1/0?(u[10]=(v+m)*(E=1/(m-v)),u[14]=2*v*m*E):(u[10]=-1,u[14]=-2*m),u},a.b7=function(u,l,h){var m=Math.sin(h),v=Math.cos(h),E=l[4],T=l[5],F=l[6],U=l[7],Q=l[8],G=l[9],q=l[10],J=l[11];return l!==u&&(u[0]=l[0],u[1]=l[1],u[2]=l[2],u[3]=l[3],u[12]=l[12],u[13]=l[13],u[14]=l[14],u[15]=l[15]),u[4]=E*v+Q*m,u[5]=T*v+G*m,u[6]=F*v+q*m,u[7]=U*v+J*m,u[8]=Q*v-E*m,u[9]=G*v-T*m,u[10]=q*v-F*m,u[11]=J*v-U*m,u},a.b8=$,a.b9=tt,a.bA=function(u){return u.message===it},a.bB=Es,a.bC=Co,a.ba=function(u){return u*Math.PI/180},a.bb=function(u,l){return u[0]=l[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=l[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=l[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},a.bc=class extends N{},a.bd=cS,a.be=zwt,a.bg=Vt,a.bh=function(u,l){It.REGISTERED_PROTOCOLS[u]=l},a.bi=function(u){delete It.REGISTERED_PROTOCOLS[u]},a.bj=function(u,l){const h={};for(let v=0;v<u.length;v++){const E=l&&l[u[v].id]||gh(u[v]);l&&(l[u[v].id]=E);let T=h[E];T||(T=h[E]=[]),T.push(u[v])}const m=[];for(const v in h)m.push(h[v]);return m},a.bk=je,a.bl=_k,a.bm=bk,a.bn=YN,a.bo=function(u){u.bucket.createArrays(),u.bucket.tilePixelRatio=Ci/(512*u.bucket.overscaling),u.bucket.compareText={},u.bucket.iconsNeedLinear=!1;const l=u.bucket.layers[0],h=l.layout,m=l._unevaluatedLayout._values,v={layoutIconSize:m["icon-size"].possiblyEvaluate(new Un(u.bucket.zoom+1),u.canonical),layoutTextSize:m["text-size"].possiblyEvaluate(new Un(u.bucket.zoom+1),u.canonical),textMaxSize:m["text-size"].possiblyEvaluate(new Un(18))};if(u.bucket.textSizeData.kind==="composite"){const{minZoom:Q,maxZoom:G}=u.bucket.textSizeData;v.compositeTextSizes=[m["text-size"].possiblyEvaluate(new Un(Q),u.canonical),m["text-size"].possiblyEvaluate(new Un(G),u.canonical)]}if(u.bucket.iconSizeData.kind==="composite"){const{minZoom:Q,maxZoom:G}=u.bucket.iconSizeData;v.compositeIconSizes=[m["icon-size"].possiblyEvaluate(new Un(Q),u.canonical),m["icon-size"].possiblyEvaluate(new Un(G),u.canonical)]}const E=h.get("text-line-height")*ss,T=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",F=h.get("text-keep-upright"),U=h.get("text-size");for(const Q of u.bucket.features){const G=h.get("text-font").evaluate(Q,{},u.canonical).join(","),q=U.evaluate(Q,{},u.canonical),J=v.layoutTextSize.evaluate(Q,{},u.canonical),rt=v.layoutIconSize.evaluate(Q,{},u.canonical),ut={horizontal:{},vertical:void 0},_t=Q.text;let St,Rt=[0,0];if(_t){const qt=_t.toString(),Ae=h.get("text-letter-spacing").evaluate(Q,{},u.canonical)*ss,Be=Bp(qt)?Ae:0,qe=h.get("text-anchor").evaluate(Q,{},u.canonical),wr=Mk(l,Q,u.canonical);if(!wr){const sr=h.get("text-radial-offset").evaluate(Q,{},u.canonical);Rt=sr?Pk(qe,[sr*ss,hS]):h.get("text-offset").evaluate(Q,{},u.canonical).map(rr=>rr*ss)}let Ke=T?"center":h.get("text-justify").evaluate(Q,{},u.canonical);const Ve=h.get("symbol-placement")==="point"?h.get("text-max-width").evaluate(Q,{},u.canonical)*ss:1/0,dr=()=>{u.bucket.allowVerticalPlacement&&Md(qt)&&(ut.vertical=ev(_t,u.glyphMap,u.glyphPositions,u.imagePositions,G,Ve,E,qe,"left",Be,Rt,a.ai.vertical,!0,J,q))};if(!T&&wr){const sr=new Set;if(Ke==="auto")for(let ye=0;ye<wr.values.length;ye+=2)sr.add(dS(wr.values[ye]));else sr.add(Ke);let rr=!1;for(const ye of sr)if(!ut.horizontal[ye])if(rr)ut.horizontal[ye]=ut.horizontal[0];else{const mr=ev(_t,u.glyphMap,u.glyphPositions,u.imagePositions,G,Ve,E,"center",ye,Be,Rt,a.ai.horizontal,!1,J,q);mr&&(ut.horizontal[ye]=mr,rr=mr.positionedLines.length===1)}dr()}else{Ke==="auto"&&(Ke=dS(qe));const sr=ev(_t,u.glyphMap,u.glyphPositions,u.imagePositions,G,Ve,E,qe,Ke,Be,Rt,a.ai.horizontal,!1,J,q);sr&&(ut.horizontal[Ke]=sr),dr(),Md(qt)&&T&&F&&(ut.vertical=ev(_t,u.glyphMap,u.glyphPositions,u.imagePositions,G,Ve,E,qe,Ke,Be,Rt,a.ai.vertical,!1,J,q))}}let Xt=!1;if(Q.icon&&Q.icon.name){const qt=u.imageMap[Q.icon.name];qt&&(St=wwt(u.imagePositions[Q.icon.name],h.get("icon-offset").evaluate(Q,{},u.canonical),h.get("icon-anchor").evaluate(Q,{},u.canonical)),Xt=!!qt.sdf,u.bucket.sdfIcons===void 0?u.bucket.sdfIcons=Xt:u.bucket.sdfIcons!==Xt&&wt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(qt.pixelRatio!==u.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(u.bucket.iconsNeedLinear=!0))}const Qt=Rk(ut.horizontal)||ut.vertical;u.bucket.iconsInText=!!Qt&&Qt.iconsInText,(Qt||St)&&kwt(u.bucket,Q,ut,St,u.imageMap,v,J,rt,Rt,Xt,u.canonical)}u.showCollisionBoxes&&u.bucket.generateCollisionDebugBuffers()},a.bp=JE,a.bq=$E,a.br=XE,a.bs=Th,a.bt=ZE,a.bu=class{constructor(u){this._marks={start:[u.url,"start"].join("#"),end:[u.url,"end"].join("#"),measure:u.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let u=performance.getEntriesByName(this._marks.measure);return u.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),u=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),u}},a.bv=function(u,l,h,m,v){return o(this,void 0,void 0,function*(){if(V())try{return yield ee(u,l,h,m,v)}catch{}return function(E,T,F,U,Q){const G=E.width,q=E.height;Zt&&we||(Zt=new OffscreenCanvas(G,q),we=Zt.getContext("2d",{willReadFrequently:!0})),Zt.width=G,Zt.height=q,we.drawImage(E,0,0,G,q);const J=we.getImageData(T,F,U,Q);return we.clearRect(0,0,G,q),J.data}(u,l,h,m,v)})},a.bw=yk,a.bx=d,a.by=p,a.bz=VN,a.c=xt,a.d=u=>o(void 0,void 0,void 0,function*(){if(u.byteLength===0)return createImageBitmap(new ImageData(1,1));const l=new Blob([new Uint8Array(u)],{type:"image/png"});try{return createImageBitmap(l)}catch(h){throw new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),a.e=mt,a.f=u=>new Promise((l,h)=>{const m=new Image;m.onload=()=>{l(m),URL.revokeObjectURL(m.src),m.onload=null,window.requestAnimationFrame(()=>{m.src=Kt})},m.onerror=()=>h(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const v=new Blob([new Uint8Array(u)],{type:"image/png"});m.src=u.byteLength?URL.createObjectURL(v):Kt}),a.g=Ut,a.h=(u,l)=>te(mt(u,{type:"json"}),l),a.i=$t,a.j=Je,a.k=Qe,a.l=(u,l)=>te(mt(u,{type:"arrayBuffer"}),l),a.m=te,a.n=function(u){return new ZE(u).readFields(pwt,[])},a.o=Zm,a.p=JN,a.q=_,a.r=zm,a.s=Ce,a.t=Pd,a.u=$e,a.v=st,a.w=wt,a.x=eo,a.y=function(u){let[l,h,m]=u;return h+=90,h*=Math.PI/180,m*=Math.PI/180,{x:l*Math.cos(h)*Math.sin(m),y:l*Math.sin(h)*Math.sin(m),z:l*Math.cos(m)}},a.z=As}),i("worker",["./shared"],function(a){class o{constructor(W){this.keyCache={},W&&this.replace(W)}replace(W){this._layerConfigs={},this._layers={},this.update(W,[])}update(W,X){for(const Bt of W){this._layerConfigs[Bt.id]=Bt;const kt=this._layers[Bt.id]=a.aB(Bt);kt._featureFilter=a.a7(kt.filter),this.keyCache[Bt.id]&&delete this.keyCache[Bt.id]}for(const Bt of X)delete this.keyCache[Bt],delete this._layerConfigs[Bt],delete this._layers[Bt];this.familiesBySource={};const ft=a.bj(Object.values(this._layerConfigs),this.keyCache);for(const Bt of ft){const kt=Bt.map(Jt=>this._layers[Jt.id]),Gt=kt[0];if(Gt.visibility==="none")continue;const Ot=Gt.source||"";let Pt=this.familiesBySource[Ot];Pt||(Pt=this.familiesBySource[Ot]={});const ae=Gt.sourceLayer||"_geojsonTileLayer";let fe=Pt[ae];fe||(fe=Pt[ae]=[]),fe.push(kt)}}}class d{constructor(W){const X={},ft=[];for(const Ot in W){const Pt=W[Ot],ae=X[Ot]={};for(const fe in Pt){const Jt=Pt[+fe];if(!Jt||Jt.bitmap.width===0||Jt.bitmap.height===0)continue;const xe={x:0,y:0,w:Jt.bitmap.width+2,h:Jt.bitmap.height+2};ft.push(xe),ae[fe]={rect:xe,metrics:Jt.metrics}}}const{w:Bt,h:kt}=a.p(ft),Gt=new a.o({width:Bt||1,height:kt||1});for(const Ot in W){const Pt=W[Ot];for(const ae in Pt){const fe=Pt[+ae];if(!fe||fe.bitmap.width===0||fe.bitmap.height===0)continue;const Jt=X[Ot][ae].rect;a.o.copy(fe.bitmap,Gt,{x:0,y:0},{x:Jt.x+1,y:Jt.y+1},fe.bitmap)}}this.image=Gt,this.positions=X}}a.bk("GlyphAtlas",d);class p{constructor(W){this.tileID=new a.S(W.tileID.overscaledZ,W.tileID.wrap,W.tileID.canonical.z,W.tileID.canonical.x,W.tileID.canonical.y),this.uid=W.uid,this.zoom=W.zoom,this.pixelRatio=W.pixelRatio,this.tileSize=W.tileSize,this.source=W.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=W.showCollisionBoxes,this.collectResourceTiming=!!W.collectResourceTiming,this.returnDependencies=!!W.returnDependencies,this.promoteId=W.promoteId,this.inFlightDependencies=[]}parse(W,X,ft,Bt){return a._(this,void 0,void 0,function*(){this.status="parsing",this.data=W,this.collisionBoxArray=new a.a5;const kt=new a.bl(Object.keys(W.layers).sort()),Gt=new a.bm(this.tileID,this.promoteId);Gt.bucketLayerIDs=[];const Ot={},Pt={featureIndex:Gt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ft},ae=X.familiesBySource[this.source];for(const br in ae){const jr=W.layers[br];if(!jr)continue;jr.version===1&&a.w(`Vector tile source "${this.source}" layer "${br}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const sn=kt.encode(br),Sn=[];for(let Mt=0;Mt<jr.length;Mt++){const Oe=jr.feature(Mt),Ee=Gt.getId(Oe,br);Sn.push({feature:Oe,id:Ee,index:Mt,sourceLayerIndex:sn})}for(const Mt of ae[br]){const Oe=Mt[0];Oe.source!==this.source&&a.w(`layer.source = ${Oe.source} does not equal this.source = ${this.source}`),Oe.minzoom&&this.zoom<Math.floor(Oe.minzoom)||Oe.maxzoom&&this.zoom>=Oe.maxzoom||Oe.visibility!=="none"&&(y(Mt,this.zoom,ft),(Ot[Oe.id]=Oe.createBucket({index:Gt.bucketLayerIDs.length,layers:Mt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:sn,sourceID:this.source})).populate(Sn,Pt,this.tileID.canonical),Gt.bucketLayerIDs.push(Mt.map(Ee=>Ee.id)))}}const fe=a.aG(Pt.glyphDependencies,br=>Object.keys(br).map(Number));this.inFlightDependencies.forEach(br=>br==null?void 0:br.abort()),this.inFlightDependencies=[];let Jt=Promise.resolve({});if(Object.keys(fe).length){const br=new AbortController;this.inFlightDependencies.push(br),Jt=Bt.sendAsync({type:"GG",data:{stacks:fe,source:this.source,tileID:this.tileID,type:"glyphs"}},br)}const xe=Object.keys(Pt.iconDependencies);let Ge=Promise.resolve({});if(xe.length){const br=new AbortController;this.inFlightDependencies.push(br),Ge=Bt.sendAsync({type:"GI",data:{icons:xe,source:this.source,tileID:this.tileID,type:"icons"}},br)}const nr=Object.keys(Pt.patternDependencies);let Br=Promise.resolve({});if(nr.length){const br=new AbortController;this.inFlightDependencies.push(br),Br=Bt.sendAsync({type:"GI",data:{icons:nr,source:this.source,tileID:this.tileID,type:"patterns"}},br)}const[Tr,pr,Qr]=yield Promise.all([Jt,Ge,Br]),Gr=new d(Tr),cn=new a.bn(pr,Qr);for(const br in Ot){const jr=Ot[br];jr instanceof a.a6?(y(jr.layers,this.zoom,ft),a.bo({bucket:jr,glyphMap:Tr,glyphPositions:Gr.positions,imageMap:pr,imagePositions:cn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):jr.hasPattern&&(jr instanceof a.bp||jr instanceof a.bq||jr instanceof a.br)&&(y(jr.layers,this.zoom,ft),jr.addFeatures(Pt,this.tileID.canonical,cn.patternPositions))}return this.status="done",{buckets:Object.values(Ot).filter(br=>!br.isEmpty()),featureIndex:Gt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Gr.image,imageAtlas:cn,glyphMap:this.returnDependencies?Tr:null,iconMap:this.returnDependencies?pr:null,glyphPositions:this.returnDependencies?Gr.positions:null}})}}function y(Ct,W,X){const ft=new a.a9(W);for(const Bt of Ct)Bt.recalculate(ft,X)}class b{constructor(W,X,ft){this.actor=W,this.layerIndex=X,this.availableImages=ft,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(W,X){return a._(this,void 0,void 0,function*(){const ft=yield a.l(W.request,X);try{return{vectorTile:new a.bs.VectorTile(new a.bt(ft.data)),rawData:ft.data,cacheControl:ft.cacheControl,expires:ft.expires}}catch(Bt){const kt=new Uint8Array(ft.data);let Gt=`Unable to parse the tile at ${W.request.url}, `;throw Gt+=kt[0]===31&&kt[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Bt.message}`,new Error(Gt)}})}loadTile(W){return a._(this,void 0,void 0,function*(){const X=W.uid,ft=!!(W&&W.request&&W.request.collectResourceTiming)&&new a.bu(W.request),Bt=new p(W);this.loading[X]=Bt;const kt=new AbortController;Bt.abort=kt;try{const Gt=yield this.loadVectorTile(W,kt);if(delete this.loading[X],!Gt)return null;const Ot=Gt.rawData,Pt={};Gt.expires&&(Pt.expires=Gt.expires),Gt.cacheControl&&(Pt.cacheControl=Gt.cacheControl);const ae={};if(ft){const Jt=ft.finish();Jt&&(ae.resourceTiming=JSON.parse(JSON.stringify(Jt)))}Bt.vectorTile=Gt.vectorTile;const fe=Bt.parse(Gt.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[X]=Bt,this.fetching[X]={rawTileData:Ot,cacheControl:Pt,resourceTiming:ae};try{const Jt=yield fe;return a.e({rawTileData:Ot.slice(0)},Jt,Pt,ae)}finally{delete this.fetching[X]}}catch(Gt){throw delete this.loading[X],Bt.status="done",this.loaded[X]=Bt,Gt}})}reloadTile(W){return a._(this,void 0,void 0,function*(){const X=W.uid;if(!this.loaded||!this.loaded[X])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ft=this.loaded[X];if(ft.showCollisionBoxes=W.showCollisionBoxes,ft.status==="parsing"){const Bt=yield ft.parse(ft.vectorTile,this.layerIndex,this.availableImages,this.actor);let kt;if(this.fetching[X]){const{rawTileData:Gt,cacheControl:Ot,resourceTiming:Pt}=this.fetching[X];delete this.fetching[X],kt=a.e({rawTileData:Gt.slice(0)},Bt,Ot,Pt)}else kt=Bt;return kt}if(ft.status==="done"&&ft.vectorTile)return ft.parse(ft.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(W){return a._(this,void 0,void 0,function*(){const X=this.loading,ft=W.uid;X&&X[ft]&&X[ft].abort&&(X[ft].abort.abort(),delete X[ft])})}removeTile(W){return a._(this,void 0,void 0,function*(){this.loaded&&this.loaded[W.uid]&&delete this.loaded[W.uid]})}}class x{constructor(){this.loaded={}}loadTile(W){return a._(this,void 0,void 0,function*(){const{uid:X,encoding:ft,rawImageData:Bt,redFactor:kt,greenFactor:Gt,blueFactor:Ot,baseShift:Pt}=W,ae=Bt.width+2,fe=Bt.height+2,Jt=a.b(Bt)?new a.R({width:ae,height:fe},yield a.bv(Bt,-1,-1,ae,fe)):Bt,xe=new a.bw(X,Jt,ft,kt,Gt,Ot,Pt);return this.loaded=this.loaded||{},this.loaded[X]=xe,xe})}removeTile(W){const X=this.loaded,ft=W.uid;X&&X[ft]&&delete X[ft]}}function C(Ct,W){if(Ct.length!==0){P(Ct[0],W);for(var X=1;X<Ct.length;X++)P(Ct[X],!W)}}function P(Ct,W){for(var X=0,ft=0,Bt=0,kt=Ct.length,Gt=kt-1;Bt<kt;Gt=Bt++){var Ot=(Ct[Bt][0]-Ct[Gt][0])*(Ct[Gt][1]+Ct[Bt][1]),Pt=X+Ot;ft+=Math.abs(X)>=Math.abs(Ot)?X-Pt+Ot:Ot-Pt+X,X=Pt}X+ft>=0!=!!W&&Ct.reverse()}var M=a.bx(function Ct(W,X){var ft,Bt=W&&W.type;if(Bt==="FeatureCollection")for(ft=0;ft<W.features.length;ft++)Ct(W.features[ft],X);else if(Bt==="GeometryCollection")for(ft=0;ft<W.geometries.length;ft++)Ct(W.geometries[ft],X);else if(Bt==="Feature")Ct(W.geometry,X);else if(Bt==="Polygon")C(W.coordinates,X);else if(Bt==="MultiPolygon")for(ft=0;ft<W.coordinates.length;ft++)C(W.coordinates[ft],X);return W});const k=a.bs.VectorTileFeature.prototype.toGeoJSON;var z={exports:{}},V=a.by,$=a.bs.VectorTileFeature,tt=pt;function pt(Ct,W){this.options=W||{},this.features=Ct,this.length=Ct.length}function gt(Ct,W){this.id=typeof Ct.id=="number"?Ct.id:void 0,this.type=Ct.type,this.rawGeometry=Ct.type===1?[Ct.geometry]:Ct.geometry,this.properties=Ct.tags,this.extent=W||4096}pt.prototype.feature=function(Ct){return new gt(this.features[Ct],this.options.extent)},gt.prototype.loadGeometry=function(){var Ct=this.rawGeometry;this.geometry=[];for(var W=0;W<Ct.length;W++){for(var X=Ct[W],ft=[],Bt=0;Bt<X.length;Bt++)ft.push(new V(X[Bt][0],X[Bt][1]));this.geometry.push(ft)}return this.geometry},gt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ct=this.geometry,W=1/0,X=-1/0,ft=1/0,Bt=-1/0,kt=0;kt<Ct.length;kt++)for(var Gt=Ct[kt],Ot=0;Ot<Gt.length;Ot++){var Pt=Gt[Ot];W=Math.min(W,Pt.x),X=Math.max(X,Pt.x),ft=Math.min(ft,Pt.y),Bt=Math.max(Bt,Pt.y)}return[W,ft,X,Bt]},gt.prototype.toGeoJSON=$.prototype.toGeoJSON;var mt=a.bz,dt=tt;function Ft(Ct){var W=new mt;return function(X,ft){for(var Bt in X.layers)ft.writeMessage(3,Tt,X.layers[Bt])}(Ct,W),W.finish()}function Tt(Ct,W){var X;W.writeVarintField(15,Ct.version||1),W.writeStringField(1,Ct.name||""),W.writeVarintField(5,Ct.extent||4096);var ft={keys:[],values:[],keycache:{},valuecache:{}};for(X=0;X<Ct.length;X++)ft.feature=Ct.feature(X),W.writeMessage(2,ot,ft);var Bt=ft.keys;for(X=0;X<Bt.length;X++)W.writeStringField(3,Bt[X]);var kt=ft.values;for(X=0;X<kt.length;X++)W.writeMessage(4,Wt,kt[X])}function ot(Ct,W){var X=Ct.feature;X.id!==void 0&&W.writeVarintField(1,X.id),W.writeMessage(2,ct,Ct),W.writeVarintField(3,X.type),W.writeMessage(4,$t,X)}function ct(Ct,W){var X=Ct.feature,ft=Ct.keys,Bt=Ct.values,kt=Ct.keycache,Gt=Ct.valuecache;for(var Ot in X.properties){var Pt=X.properties[Ot],ae=kt[Ot];if(Pt!==null){ae===void 0&&(ft.push(Ot),kt[Ot]=ae=ft.length-1),W.writeVarint(ae);var fe=typeof Pt;fe!=="string"&&fe!=="boolean"&&fe!=="number"&&(Pt=JSON.stringify(Pt));var Jt=fe+":"+Pt,xe=Gt[Jt];xe===void 0&&(Bt.push(Pt),Gt[Jt]=xe=Bt.length-1),W.writeVarint(xe)}}}function wt(Ct,W){return(W<<3)+(7&Ct)}function vt(Ct){return Ct<<1^Ct>>31}function $t(Ct,W){for(var X=Ct.loadGeometry(),ft=Ct.type,Bt=0,kt=0,Gt=X.length,Ot=0;Ot<Gt;Ot++){var Pt=X[Ot],ae=1;ft===1&&(ae=Pt.length),W.writeVarint(wt(1,ae));for(var fe=ft===3?Pt.length-1:Pt.length,Jt=0;Jt<fe;Jt++){Jt===1&&ft!==1&&W.writeVarint(wt(2,fe-1));var xe=Pt[Jt].x-Bt,Ge=Pt[Jt].y-kt;W.writeVarint(vt(xe)),W.writeVarint(vt(Ge)),Bt+=xe,kt+=Ge}ft===3&&W.writeVarint(wt(7,1))}}function Wt(Ct,W){var X=typeof Ct;X==="string"?W.writeStringField(1,Ct):X==="boolean"?W.writeBooleanField(7,Ct):X==="number"&&(Ct%1!=0?W.writeDoubleField(3,Ct):Ct<0?W.writeSVarintField(6,Ct):W.writeVarintField(5,Ct))}z.exports=Ft,z.exports.fromVectorTileJs=Ft,z.exports.fromGeojsonVt=function(Ct,W){W=W||{};var X={};for(var ft in Ct)X[ft]=new dt(Ct[ft].features,W),X[ft].name=ft,X[ft].version=W.version,X[ft].extent=W.extent;return Ft({layers:X})},z.exports.GeoJSONWrapper=dt;var Yt=a.bx(z.exports);const Kt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ct=>Ct},ee=Math.fround||(Zt=new Float32Array(1),Ct=>(Zt[0]=+Ct,Zt[0]));var Zt;const we=3,it=5,xt=6;class It{constructor(W){this.options=Object.assign(Object.create(Kt),W),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(W){const{log:X,minZoom:ft,maxZoom:Bt}=this.options;X&&console.time("total time");const kt=`prepare ${W.length} points`;X&&console.time(kt),this.points=W;const Gt=[];for(let Pt=0;Pt<W.length;Pt++){const ae=W[Pt];if(!ae.geometry)continue;const[fe,Jt]=ae.geometry.coordinates,xe=ee(Vt(fe)),Ge=ee(re(Jt));Gt.push(xe,Ge,1/0,Pt,-1,1),this.options.reduce&&Gt.push(0)}let Ot=this.trees[Bt+1]=this._createTree(Gt);X&&console.timeEnd(kt);for(let Pt=Bt;Pt>=ft;Pt--){const ae=+Date.now();Ot=this.trees[Pt]=this._createTree(this._cluster(Ot,Pt)),X&&console.log("z%d: %d clusters in %dms",Pt,Ot.numItems,+Date.now()-ae)}return X&&console.timeEnd("total time"),this}getClusters(W,X){let ft=((W[0]+180)%360+360)%360-180;const Bt=Math.max(-90,Math.min(90,W[1]));let kt=W[2]===180?180:((W[2]+180)%360+360)%360-180;const Gt=Math.max(-90,Math.min(90,W[3]));if(W[2]-W[0]>=360)ft=-180,kt=180;else if(ft>kt){const Jt=this.getClusters([ft,Bt,180,Gt],X),xe=this.getClusters([-180,Bt,kt,Gt],X);return Jt.concat(xe)}const Ot=this.trees[this._limitZoom(X)],Pt=Ot.range(Vt(ft),re(Gt),Vt(kt),re(Bt)),ae=Ot.data,fe=[];for(const Jt of Pt){const xe=this.stride*Jt;fe.push(ae[xe+it]>1?Ut(ae,xe,this.clusterProps):this.points[ae[xe+we]])}return fe}getChildren(W){const X=this._getOriginId(W),ft=this._getOriginZoom(W),Bt="No cluster with the specified id.",kt=this.trees[ft];if(!kt)throw new Error(Bt);const Gt=kt.data;if(X*this.stride>=Gt.length)throw new Error(Bt);const Ot=this.options.radius/(this.options.extent*Math.pow(2,ft-1)),Pt=kt.within(Gt[X*this.stride],Gt[X*this.stride+1],Ot),ae=[];for(const fe of Pt){const Jt=fe*this.stride;Gt[Jt+4]===W&&ae.push(Gt[Jt+it]>1?Ut(Gt,Jt,this.clusterProps):this.points[Gt[Jt+we]])}if(ae.length===0)throw new Error(Bt);return ae}getLeaves(W,X,ft){const Bt=[];return this._appendLeaves(Bt,W,X=X||10,ft=ft||0,0),Bt}getTile(W,X,ft){const Bt=this.trees[this._limitZoom(W)],kt=Math.pow(2,W),{extent:Gt,radius:Ot}=this.options,Pt=Ot/Gt,ae=(ft-Pt)/kt,fe=(ft+1+Pt)/kt,Jt={features:[]};return this._addTileFeatures(Bt.range((X-Pt)/kt,ae,(X+1+Pt)/kt,fe),Bt.data,X,ft,kt,Jt),X===0&&this._addTileFeatures(Bt.range(1-Pt/kt,ae,1,fe),Bt.data,kt,ft,kt,Jt),X===kt-1&&this._addTileFeatures(Bt.range(0,ae,Pt/kt,fe),Bt.data,-1,ft,kt,Jt),Jt.features.length?Jt:null}getClusterExpansionZoom(W){let X=this._getOriginZoom(W)-1;for(;X<=this.options.maxZoom;){const ft=this.getChildren(W);if(X++,ft.length!==1)break;W=ft[0].properties.cluster_id}return X}_appendLeaves(W,X,ft,Bt,kt){const Gt=this.getChildren(X);for(const Ot of Gt){const Pt=Ot.properties;if(Pt&&Pt.cluster?kt+Pt.point_count<=Bt?kt+=Pt.point_count:kt=this._appendLeaves(W,Pt.cluster_id,ft,Bt,kt):kt<Bt?kt++:W.push(Ot),W.length===ft)break}return kt}_createTree(W){const X=new a.aw(W.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ft=0;ft<W.length;ft+=this.stride)X.add(W[ft],W[ft+1]);return X.finish(),X.data=W,X}_addTileFeatures(W,X,ft,Bt,kt,Gt){for(const Ot of W){const Pt=Ot*this.stride,ae=X[Pt+it]>1;let fe,Jt,xe;if(ae)fe=jt(X,Pt,this.clusterProps),Jt=X[Pt],xe=X[Pt+1];else{const Br=this.points[X[Pt+we]];fe=Br.properties;const[Tr,pr]=Br.geometry.coordinates;Jt=Vt(Tr),xe=re(pr)}const Ge={type:1,geometry:[[Math.round(this.options.extent*(Jt*kt-ft)),Math.round(this.options.extent*(xe*kt-Bt))]],tags:fe};let nr;nr=ae||this.options.generateId?X[Pt+we]:this.points[X[Pt+we]].id,nr!==void 0&&(Ge.id=nr),Gt.features.push(Ge)}}_limitZoom(W){return Math.max(this.options.minZoom,Math.min(Math.floor(+W),this.options.maxZoom+1))}_cluster(W,X){const{radius:ft,extent:Bt,reduce:kt,minPoints:Gt}=this.options,Ot=ft/(Bt*Math.pow(2,X)),Pt=W.data,ae=[],fe=this.stride;for(let Jt=0;Jt<Pt.length;Jt+=fe){if(Pt[Jt+2]<=X)continue;Pt[Jt+2]=X;const xe=Pt[Jt],Ge=Pt[Jt+1],nr=W.within(Pt[Jt],Pt[Jt+1],Ot),Br=Pt[Jt+it];let Tr=Br;for(const pr of nr){const Qr=pr*fe;Pt[Qr+2]>X&&(Tr+=Pt[Qr+it])}if(Tr>Br&&Tr>=Gt){let pr,Qr=xe*Br,Gr=Ge*Br,cn=-1;const br=((Jt/fe|0)<<5)+(X+1)+this.points.length;for(const jr of nr){const sn=jr*fe;if(Pt[sn+2]<=X)continue;Pt[sn+2]=X;const Sn=Pt[sn+it];Qr+=Pt[sn]*Sn,Gr+=Pt[sn+1]*Sn,Pt[sn+4]=br,kt&&(pr||(pr=this._map(Pt,Jt,!0),cn=this.clusterProps.length,this.clusterProps.push(pr)),kt(pr,this._map(Pt,sn)))}Pt[Jt+4]=br,ae.push(Qr/Tr,Gr/Tr,1/0,br,-1,Tr),kt&&ae.push(cn)}else{for(let pr=0;pr<fe;pr++)ae.push(Pt[Jt+pr]);if(Tr>1)for(const pr of nr){const Qr=pr*fe;if(!(Pt[Qr+2]<=X)){Pt[Qr+2]=X;for(let Gr=0;Gr<fe;Gr++)ae.push(Pt[Qr+Gr])}}}}return ae}_getOriginId(W){return W-this.points.length>>5}_getOriginZoom(W){return(W-this.points.length)%32}_map(W,X,ft){if(W[X+it]>1){const Gt=this.clusterProps[W[X+xt]];return ft?Object.assign({},Gt):Gt}const Bt=this.points[W[X+we]].properties,kt=this.options.map(Bt);return ft&&kt===Bt?Object.assign({},kt):kt}}function Ut(Ct,W,X){return{type:"Feature",id:Ct[W+we],properties:jt(Ct,W,X),geometry:{type:"Point",coordinates:[(ft=Ct[W],360*(ft-.5)),te(Ct[W+1])]}};var ft}function jt(Ct,W,X){const ft=Ct[W+it],Bt=ft>=1e4?`${Math.round(ft/1e3)}k`:ft>=1e3?Math.round(ft/100)/10+"k":ft,kt=Ct[W+xt],Gt=kt===-1?{}:Object.assign({},X[kt]);return Object.assign(Gt,{cluster:!0,cluster_id:Ct[W+we],point_count:ft,point_count_abbreviated:Bt})}function Vt(Ct){return Ct/360+.5}function re(Ct){const W=Math.sin(Ct*Math.PI/180),X=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return X<0?0:X>1?1:X}function te(Ct){const W=(180-360*Ct)*Math.PI/180;return 360*Math.atan(Math.exp(W))/Math.PI-90}function Ce(Ct,W,X,ft){let Bt=ft;const kt=W+(X-W>>1);let Gt,Ot=X-W;const Pt=Ct[W],ae=Ct[W+1],fe=Ct[X],Jt=Ct[X+1];for(let xe=W+3;xe<X;xe+=3){const Ge=Te(Ct[xe],Ct[xe+1],Pt,ae,fe,Jt);if(Ge>Bt)Gt=xe,Bt=Ge;else if(Ge===Bt){const nr=Math.abs(xe-kt);nr<Ot&&(Gt=xe,Ot=nr)}}Bt>ft&&(Gt-W>3&&Ce(Ct,W,Gt,ft),Ct[Gt+2]=Bt,X-Gt>3&&Ce(Ct,Gt,X,ft))}function Te(Ct,W,X,ft,Bt,kt){let Gt=Bt-X,Ot=kt-ft;if(Gt!==0||Ot!==0){const Pt=((Ct-X)*Gt+(W-ft)*Ot)/(Gt*Gt+Ot*Ot);Pt>1?(X=Bt,ft=kt):Pt>0&&(X+=Gt*Pt,ft+=Ot*Pt)}return Gt=Ct-X,Ot=W-ft,Gt*Gt+Ot*Ot}function De(Ct,W,X,ft){const Bt={id:Ct??null,type:W,geometry:X,tags:ft,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(W==="Point"||W==="MultiPoint"||W==="LineString")Qe(Bt,X);else if(W==="Polygon")Qe(Bt,X[0]);else if(W==="MultiLineString")for(const kt of X)Qe(Bt,kt);else if(W==="MultiPolygon")for(const kt of X)Qe(Bt,kt[0]);return Bt}function Qe(Ct,W){for(let X=0;X<W.length;X+=3)Ct.minX=Math.min(Ct.minX,W[X]),Ct.minY=Math.min(Ct.minY,W[X+1]),Ct.maxX=Math.max(Ct.maxX,W[X]),Ct.maxY=Math.max(Ct.maxY,W[X+1])}function Je(Ct,W,X,ft){if(!W.geometry)return;const Bt=W.geometry.coordinates;if(Bt&&Bt.length===0)return;const kt=W.geometry.type,Gt=Math.pow(X.tolerance/((1<<X.maxZoom)*X.extent),2);let Ot=[],Pt=W.id;if(X.promoteId?Pt=W.properties[X.promoteId]:X.generateId&&(Pt=ft||0),kt==="Point")he(Bt,Ot);else if(kt==="MultiPoint")for(const ae of Bt)he(ae,Ot);else if(kt==="LineString")st(Bt,Ot,Gt,!1);else if(kt==="MultiLineString"){if(X.lineMetrics){for(const ae of Bt)Ot=[],st(ae,Ot,Gt,!1),Ct.push(De(Pt,"LineString",Ot,W.properties));return}fr(Bt,Ot,Gt,!1)}else if(kt==="Polygon")fr(Bt,Ot,Gt,!0);else{if(kt!=="MultiPolygon"){if(kt==="GeometryCollection"){for(const ae of W.geometry.geometries)Je(Ct,{id:Pt,geometry:ae,properties:W.properties},X,ft);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ae of Bt){const fe=[];fr(ae,fe,Gt,!0),Ot.push(fe)}}Ct.push(De(Pt,kt,Ot,W.properties))}function he(Ct,W){W.push(er(Ct[0]),de(Ct[1]),0)}function st(Ct,W,X,ft){let Bt,kt,Gt=0;for(let Pt=0;Pt<Ct.length;Pt++){const ae=er(Ct[Pt][0]),fe=de(Ct[Pt][1]);W.push(ae,fe,0),Pt>0&&(Gt+=ft?(Bt*fe-ae*kt)/2:Math.sqrt(Math.pow(ae-Bt,2)+Math.pow(fe-kt,2))),Bt=ae,kt=fe}const Ot=W.length-3;W[2]=1,Ce(W,0,Ot,X),W[Ot+2]=1,W.size=Math.abs(Gt),W.start=0,W.end=W.size}function fr(Ct,W,X,ft){for(let Bt=0;Bt<Ct.length;Bt++){const kt=[];st(Ct[Bt],kt,X,ft),W.push(kt)}}function er(Ct){return Ct/360+.5}function de(Ct){const W=Math.sin(Ct*Math.PI/180),X=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return X<0?0:X>1?1:X}function ve(Ct,W,X,ft,Bt,kt,Gt,Ot){if(ft/=W,kt>=(X/=W)&&Gt<ft)return Ct;if(Gt<X||kt>=ft)return null;const Pt=[];for(const ae of Ct){const fe=ae.geometry;let Jt=ae.type;const xe=Bt===0?ae.minX:ae.minY,Ge=Bt===0?ae.maxX:ae.maxY;if(xe>=X&&Ge<ft){Pt.push(ae);continue}if(Ge<X||xe>=ft)continue;let nr=[];if(Jt==="Point"||Jt==="MultiPoint")Le(fe,nr,X,ft,Bt);else if(Jt==="LineString")Ue(fe,nr,X,ft,Bt,!1,Ot.lineMetrics);else if(Jt==="MultiLineString")lr(fe,nr,X,ft,Bt,!1);else if(Jt==="Polygon")lr(fe,nr,X,ft,Bt,!0);else if(Jt==="MultiPolygon")for(const Br of fe){const Tr=[];lr(Br,Tr,X,ft,Bt,!0),Tr.length&&nr.push(Tr)}if(nr.length){if(Ot.lineMetrics&&Jt==="LineString"){for(const Br of nr)Pt.push(De(ae.id,Jt,Br,ae.tags));continue}Jt!=="LineString"&&Jt!=="MultiLineString"||(nr.length===1?(Jt="LineString",nr=nr[0]):Jt="MultiLineString"),Jt!=="Point"&&Jt!=="MultiPoint"||(Jt=nr.length===3?"Point":"MultiPoint"),Pt.push(De(ae.id,Jt,nr,ae.tags))}}return Pt.length?Pt:null}function Le(Ct,W,X,ft,Bt){for(let kt=0;kt<Ct.length;kt+=3){const Gt=Ct[kt+Bt];Gt>=X&&Gt<=ft&&yr(W,Ct[kt],Ct[kt+1],Ct[kt+2])}}function Ue(Ct,W,X,ft,Bt,kt,Gt){let Ot=Ye(Ct);const Pt=Bt===0?Lr:Dr;let ae,fe,Jt=Ct.start;for(let Tr=0;Tr<Ct.length-3;Tr+=3){const pr=Ct[Tr],Qr=Ct[Tr+1],Gr=Ct[Tr+2],cn=Ct[Tr+3],br=Ct[Tr+4],jr=Bt===0?pr:Qr,sn=Bt===0?cn:br;let Sn=!1;Gt&&(ae=Math.sqrt(Math.pow(pr-cn,2)+Math.pow(Qr-br,2))),jr<X?sn>X&&(fe=Pt(Ot,pr,Qr,cn,br,X),Gt&&(Ot.start=Jt+ae*fe)):jr>ft?sn<ft&&(fe=Pt(Ot,pr,Qr,cn,br,ft),Gt&&(Ot.start=Jt+ae*fe)):yr(Ot,pr,Qr,Gr),sn<X&&jr>=X&&(fe=Pt(Ot,pr,Qr,cn,br,X),Sn=!0),sn>ft&&jr<=ft&&(fe=Pt(Ot,pr,Qr,cn,br,ft),Sn=!0),!kt&&Sn&&(Gt&&(Ot.end=Jt+ae*fe),W.push(Ot),Ot=Ye(Ct)),Gt&&(Jt+=ae)}let xe=Ct.length-3;const Ge=Ct[xe],nr=Ct[xe+1],Br=Bt===0?Ge:nr;Br>=X&&Br<=ft&&yr(Ot,Ge,nr,Ct[xe+2]),xe=Ot.length-3,kt&&xe>=3&&(Ot[xe]!==Ot[0]||Ot[xe+1]!==Ot[1])&&yr(Ot,Ot[0],Ot[1],Ot[2]),Ot.length&&W.push(Ot)}function Ye(Ct){const W=[];return W.size=Ct.size,W.start=Ct.start,W.end=Ct.end,W}function lr(Ct,W,X,ft,Bt,kt){for(const Gt of Ct)Ue(Gt,W,X,ft,Bt,kt,!1)}function yr(Ct,W,X,ft){Ct.push(W,X,ft)}function Lr(Ct,W,X,ft,Bt,kt){const Gt=(kt-W)/(ft-W);return yr(Ct,kt,X+(Bt-X)*Gt,1),Gt}function Dr(Ct,W,X,ft,Bt,kt){const Gt=(kt-X)/(Bt-X);return yr(Ct,W+(ft-W)*Gt,kt,1),Gt}function pe(Ct,W){const X=[];for(let ft=0;ft<Ct.length;ft++){const Bt=Ct[ft],kt=Bt.type;let Gt;if(kt==="Point"||kt==="MultiPoint"||kt==="LineString")Gt=cr(Bt.geometry,W);else if(kt==="MultiLineString"||kt==="Polygon"){Gt=[];for(const Ot of Bt.geometry)Gt.push(cr(Ot,W))}else if(kt==="MultiPolygon"){Gt=[];for(const Ot of Bt.geometry){const Pt=[];for(const ae of Ot)Pt.push(cr(ae,W));Gt.push(Pt)}}X.push(De(Bt.id,kt,Gt,Bt.tags))}return X}function cr(Ct,W){const X=[];X.size=Ct.size,Ct.start!==void 0&&(X.start=Ct.start,X.end=Ct.end);for(let ft=0;ft<Ct.length;ft+=3)X.push(Ct[ft]+W,Ct[ft+1],Ct[ft+2]);return X}function _r(Ct,W){if(Ct.transformed)return Ct;const X=1<<Ct.z,ft=Ct.x,Bt=Ct.y;for(const kt of Ct.features){const Gt=kt.geometry,Ot=kt.type;if(kt.geometry=[],Ot===1)for(let Pt=0;Pt<Gt.length;Pt+=2)kt.geometry.push(Re(Gt[Pt],Gt[Pt+1],W,X,ft,Bt));else for(let Pt=0;Pt<Gt.length;Pt++){const ae=[];for(let fe=0;fe<Gt[Pt].length;fe+=2)ae.push(Re(Gt[Pt][fe],Gt[Pt][fe+1],W,X,ft,Bt));kt.geometry.push(ae)}}return Ct.transformed=!0,Ct}function Re(Ct,W,X,ft,Bt,kt){return[Math.round(X*(Ct*ft-Bt)),Math.round(X*(W*ft-kt))]}function An(Ct,W,X,ft,Bt){const kt=W===Bt.maxZoom?0:Bt.tolerance/((1<<W)*Bt.extent),Gt={features:[],numPoints:0,numSimplified:0,numFeatures:Ct.length,source:null,x:X,y:ft,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ot of Ct)me(Gt,Ot,kt,Bt);return Gt}function me(Ct,W,X,ft){const Bt=W.geometry,kt=W.type,Gt=[];if(Ct.minX=Math.min(Ct.minX,W.minX),Ct.minY=Math.min(Ct.minY,W.minY),Ct.maxX=Math.max(Ct.maxX,W.maxX),Ct.maxY=Math.max(Ct.maxY,W.maxY),kt==="Point"||kt==="MultiPoint")for(let Ot=0;Ot<Bt.length;Ot+=3)Gt.push(Bt[Ot],Bt[Ot+1]),Ct.numPoints++,Ct.numSimplified++;else if(kt==="LineString")gr(Gt,Bt,Ct,X,!1,!1);else if(kt==="MultiLineString"||kt==="Polygon")for(let Ot=0;Ot<Bt.length;Ot++)gr(Gt,Bt[Ot],Ct,X,kt==="Polygon",Ot===0);else if(kt==="MultiPolygon")for(let Ot=0;Ot<Bt.length;Ot++){const Pt=Bt[Ot];for(let ae=0;ae<Pt.length;ae++)gr(Gt,Pt[ae],Ct,X,!0,ae===0)}if(Gt.length){let Ot=W.tags||null;if(kt==="LineString"&&ft.lineMetrics){Ot={};for(const ae in W.tags)Ot[ae]=W.tags[ae];Ot.mapbox_clip_start=Bt.start/Bt.size,Ot.mapbox_clip_end=Bt.end/Bt.size}const Pt={geometry:Gt,type:kt==="Polygon"||kt==="MultiPolygon"?3:kt==="LineString"||kt==="MultiLineString"?2:1,tags:Ot};W.id!==null&&(Pt.id=W.id),Ct.features.push(Pt)}}function gr(Ct,W,X,ft,Bt,kt){const Gt=ft*ft;if(ft>0&&W.size<(Bt?Gt:ft))return void(X.numPoints+=W.length/3);const Ot=[];for(let Pt=0;Pt<W.length;Pt+=3)(ft===0||W[Pt+2]>Gt)&&(X.numSimplified++,Ot.push(W[Pt],W[Pt+1])),X.numPoints++;Bt&&function(Pt,ae){let fe=0;for(let Jt=0,xe=Pt.length,Ge=xe-2;Jt<xe;Ge=Jt,Jt+=2)fe+=(Pt[Jt]-Pt[Ge])*(Pt[Jt+1]+Pt[Ge+1]);if(fe>0===ae)for(let Jt=0,xe=Pt.length;Jt<xe/2;Jt+=2){const Ge=Pt[Jt],nr=Pt[Jt+1];Pt[Jt]=Pt[xe-2-Jt],Pt[Jt+1]=Pt[xe-1-Jt],Pt[xe-2-Jt]=Ge,Pt[xe-1-Jt]=nr}}(Ot,kt),Ct.push(Ot)}const Ne={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ur{constructor(W,X){const ft=(X=this.options=function(kt,Gt){for(const Ot in Gt)kt[Ot]=Gt[Ot];return kt}(Object.create(Ne),X)).debug;if(ft&&console.time("preprocess data"),X.maxZoom<0||X.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(X.promoteId&&X.generateId)throw new Error("promoteId and generateId cannot be used together.");let Bt=function(kt,Gt){const Ot=[];if(kt.type==="FeatureCollection")for(let Pt=0;Pt<kt.features.length;Pt++)Je(Ot,kt.features[Pt],Gt,Pt);else Je(Ot,kt.type==="Feature"?kt:{geometry:kt},Gt);return Ot}(W,X);this.tiles={},this.tileCoords=[],ft&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",X.indexMaxZoom,X.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Bt=function(kt,Gt){const Ot=Gt.buffer/Gt.extent;let Pt=kt;const ae=ve(kt,1,-1-Ot,Ot,0,-1,2,Gt),fe=ve(kt,1,1-Ot,2+Ot,0,-1,2,Gt);return(ae||fe)&&(Pt=ve(kt,1,-Ot,1+Ot,0,-1,2,Gt)||[],ae&&(Pt=pe(ae,1).concat(Pt)),fe&&(Pt=Pt.concat(pe(fe,-1)))),Pt}(Bt,X),Bt.length&&this.splitTile(Bt,0,0,0),ft&&(Bt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(W,X,ft,Bt,kt,Gt,Ot){const Pt=[W,X,ft,Bt],ae=this.options,fe=ae.debug;for(;Pt.length;){Bt=Pt.pop(),ft=Pt.pop(),X=Pt.pop(),W=Pt.pop();const Jt=1<<X,xe=_n(X,ft,Bt);let Ge=this.tiles[xe];if(!Ge&&(fe>1&&console.time("creation"),Ge=this.tiles[xe]=An(W,X,ft,Bt,ae),this.tileCoords.push({z:X,x:ft,y:Bt}),fe)){fe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",X,ft,Bt,Ge.numFeatures,Ge.numPoints,Ge.numSimplified),console.timeEnd("creation"));const Sn=`z${X}`;this.stats[Sn]=(this.stats[Sn]||0)+1,this.total++}if(Ge.source=W,kt==null){if(X===ae.indexMaxZoom||Ge.numPoints<=ae.indexMaxPoints)continue}else{if(X===ae.maxZoom||X===kt)continue;if(kt!=null){const Sn=kt-X;if(ft!==Gt>>Sn||Bt!==Ot>>Sn)continue}}if(Ge.source=null,W.length===0)continue;fe>1&&console.time("clipping");const nr=.5*ae.buffer/ae.extent,Br=.5-nr,Tr=.5+nr,pr=1+nr;let Qr=null,Gr=null,cn=null,br=null,jr=ve(W,Jt,ft-nr,ft+Tr,0,Ge.minX,Ge.maxX,ae),sn=ve(W,Jt,ft+Br,ft+pr,0,Ge.minX,Ge.maxX,ae);W=null,jr&&(Qr=ve(jr,Jt,Bt-nr,Bt+Tr,1,Ge.minY,Ge.maxY,ae),Gr=ve(jr,Jt,Bt+Br,Bt+pr,1,Ge.minY,Ge.maxY,ae),jr=null),sn&&(cn=ve(sn,Jt,Bt-nr,Bt+Tr,1,Ge.minY,Ge.maxY,ae),br=ve(sn,Jt,Bt+Br,Bt+pr,1,Ge.minY,Ge.maxY,ae),sn=null),fe>1&&console.timeEnd("clipping"),Pt.push(Qr||[],X+1,2*ft,2*Bt),Pt.push(Gr||[],X+1,2*ft,2*Bt+1),Pt.push(cn||[],X+1,2*ft+1,2*Bt),Pt.push(br||[],X+1,2*ft+1,2*Bt+1)}}getTile(W,X,ft){W=+W,X=+X,ft=+ft;const Bt=this.options,{extent:kt,debug:Gt}=Bt;if(W<0||W>24)return null;const Ot=1<<W,Pt=_n(W,X=X+Ot&Ot-1,ft);if(this.tiles[Pt])return _r(this.tiles[Pt],kt);Gt>1&&console.log("drilling down to z%d-%d-%d",W,X,ft);let ae,fe=W,Jt=X,xe=ft;for(;!ae&&fe>0;)fe--,Jt>>=1,xe>>=1,ae=this.tiles[_n(fe,Jt,xe)];return ae&&ae.source?(Gt>1&&(console.log("found parent tile z%d-%d-%d",fe,Jt,xe),console.time("drilling down")),this.splitTile(ae.source,fe,Jt,xe,W,X,ft),Gt>1&&console.timeEnd("drilling down"),this.tiles[Pt]?_r(this.tiles[Pt],kt):null):null}}function _n(Ct,W,X){return 32*((1<<Ct)*X+W)+Ct}function ke(Ct,W){return W?Ct.properties[W]:Ct.id}function Qn(Ct,W){if(Ct==null)return!0;if(Ct.type==="Feature")return ke(Ct,W)!=null;if(Ct.type==="FeatureCollection"){const X=new Set;for(const ft of Ct.features){const Bt=ke(ft,W);if(Bt==null||X.has(Bt))return!1;X.add(Bt)}return!0}return!1}function nn(Ct,W){const X=new Map;if(Ct!=null)if(Ct.type==="Feature")X.set(ke(Ct,W),Ct);else for(const ft of Ct.features)X.set(ke(ft,W),ft);return X}class vn extends b{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(W,X){return a._(this,void 0,void 0,function*(){const ft=W.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Bt=this._geoJSONIndex.getTile(ft.z,ft.x,ft.y);if(!Bt)return null;const kt=new class{constructor(Ot){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.X,this.length=Ot.length,this._features=Ot}feature(Ot){return new class{constructor(Pt){this._feature=Pt,this.extent=a.X,this.type=Pt.type,this.properties=Pt.tags,"id"in Pt&&!isNaN(Pt.id)&&(this.id=parseInt(Pt.id,10))}loadGeometry(){if(this._feature.type===1){const Pt=[];for(const ae of this._feature.geometry)Pt.push([new a.P(ae[0],ae[1])]);return Pt}{const Pt=[];for(const ae of this._feature.geometry){const fe=[];for(const Jt of ae)fe.push(new a.P(Jt[0],Jt[1]));Pt.push(fe)}return Pt}}toGeoJSON(Pt,ae,fe){return k.call(this,Pt,ae,fe)}}(this._features[Ot])}}(Bt.features);let Gt=Yt(kt);return Gt.byteOffset===0&&Gt.byteLength===Gt.buffer.byteLength||(Gt=new Uint8Array(Gt)),{vectorTile:kt,rawData:Gt.buffer}})}loadData(W){return a._(this,void 0,void 0,function*(){var X;(X=this._pendingRequest)===null||X===void 0||X.abort();const ft=!!(W&&W.request&&W.request.collectResourceTiming)&&new a.bu(W.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(W,this._pendingRequest),this._geoJSONIndex=W.cluster?new It(function(Gt){let{superclusterOptions:Ot,clusterProperties:Pt}=Gt;if(!Pt||!Ot)return Ot;const ae={},fe={},Jt={accumulated:null,zoom:0},xe={properties:null},Ge=Object.keys(Pt);for(const nr of Ge){const[Br,Tr]=Pt[nr],pr=a.bB(Tr),Qr=a.bB(typeof Br=="string"?[Br,["accumulated"],["get",nr]]:Br);ae[nr]=pr.value,fe[nr]=Qr.value}return Ot.map=nr=>{xe.properties=nr;const Br={};for(const Tr of Ge)Br[Tr]=ae[Tr].evaluate(Jt,xe);return Br},Ot.reduce=(nr,Br)=>{xe.properties=Br;for(const Tr of Ge)Jt.accumulated=nr[Tr],nr[Tr]=fe[Tr].evaluate(Jt,xe)},Ot}(W)).load((yield this._pendingData).features):(Bt=yield this._pendingData,new Ur(Bt,W.geojsonVtOptions)),this.loaded={};const kt={};if(ft){const Gt=ft.finish();Gt&&(kt.resourceTiming={},kt.resourceTiming[W.source]=JSON.parse(JSON.stringify(Gt)))}return kt}catch(kt){if(delete this._pendingRequest,a.bA(kt))return{abandoned:!0};throw kt}var Bt})}getData(){return a._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(W){const X=this.loaded;return X&&X[W.uid]?super.reloadTile(W):this.loadTile(W)}loadAndProcessGeoJSON(W,X){return a._(this,void 0,void 0,function*(){let ft=yield this.loadGeoJSON(W,X);if(delete this._pendingRequest,typeof ft!="object")throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`);if(M(ft,!0),W.filter){const Bt=a.bB(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Bt.result==="error")throw new Error(Bt.value.map(Gt=>`${Gt.key}: ${Gt.message}`).join(", "));ft={type:"FeatureCollection",features:ft.features.filter(Gt=>Bt.value.evaluate({zoom:0},Gt))}}return ft})}loadGeoJSON(W,X){return a._(this,void 0,void 0,function*(){const{promoteId:ft}=W;if(W.request){const Bt=yield a.h(W.request,X);return this._dataUpdateable=Qn(Bt.data,ft)?nn(Bt.data,ft):void 0,Bt.data}if(typeof W.data=="string")try{const Bt=JSON.parse(W.data);return this._dataUpdateable=Qn(Bt,ft)?nn(Bt,ft):void 0,Bt}catch{throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`)}if(!W.dataDiff)throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${W.source}`);return function(Bt,kt,Gt){var Ot,Pt,ae,fe;if(kt.removeAll&&Bt.clear(),kt.remove)for(const Jt of kt.remove)Bt.delete(Jt);if(kt.add)for(const Jt of kt.add){const xe=ke(Jt,Gt);xe!=null&&Bt.set(xe,Jt)}if(kt.update)for(const Jt of kt.update){let xe=Bt.get(Jt.id);if(xe==null)continue;const Ge=!Jt.removeAllProperties&&(((Ot=Jt.removeProperties)===null||Ot===void 0?void 0:Ot.length)>0||((Pt=Jt.addOrUpdateProperties)===null||Pt===void 0?void 0:Pt.length)>0);if((Jt.newGeometry||Jt.removeAllProperties||Ge)&&(xe=Object.assign({},xe),Bt.set(Jt.id,xe),Ge&&(xe.properties=Object.assign({},xe.properties))),Jt.newGeometry&&(xe.geometry=Jt.newGeometry),Jt.removeAllProperties)xe.properties={};else if(((ae=Jt.removeProperties)===null||ae===void 0?void 0:ae.length)>0)for(const nr of Jt.removeProperties)Object.prototype.hasOwnProperty.call(xe.properties,nr)&&delete xe.properties[nr];if(((fe=Jt.addOrUpdateProperties)===null||fe===void 0?void 0:fe.length)>0)for(const{key:nr,value:Br}of Jt.addOrUpdateProperties)xe.properties[nr]=Br}}(this._dataUpdateable,W.dataDiff,ft),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(W){return a._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(W){return this._geoJSONIndex.getClusterExpansionZoom(W.clusterId)}getClusterChildren(W){return this._geoJSONIndex.getChildren(W.clusterId)}getClusterLeaves(W){return this._geoJSONIndex.getLeaves(W.clusterId,W.limit,W.offset)}}class ln{constructor(W){this.self=W,this.actor=new a.F(W),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(X,ft)=>{if(this.externalWorkerSourceTypes[X])throw new Error(`Worker source with name "${X}" already registered.`);this.externalWorkerSourceTypes[X]=ft},this.self.addProtocol=a.bh,this.self.removeProtocol=a.bi,this.self.registerRTLTextPlugin=X=>{if(a.bC.isParsed())throw new Error("RTL text plugin already registered.");a.bC.setMethods(X)},this.actor.registerMessageHandler("LDT",(X,ft)=>this._getDEMWorkerSource(X,ft.source).loadTile(ft)),this.actor.registerMessageHandler("RDT",(X,ft)=>a._(this,void 0,void 0,function*(){this._getDEMWorkerSource(X,ft.source).removeTile(ft)})),this.actor.registerMessageHandler("GCEZ",(X,ft)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(X,ft.type,ft.source).getClusterExpansionZoom(ft)})),this.actor.registerMessageHandler("GCC",(X,ft)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(X,ft.type,ft.source).getClusterChildren(ft)})),this.actor.registerMessageHandler("GCL",(X,ft)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(X,ft.type,ft.source).getClusterLeaves(ft)})),this.actor.registerMessageHandler("LD",(X,ft)=>this._getWorkerSource(X,ft.type,ft.source).loadData(ft)),this.actor.registerMessageHandler("GD",(X,ft)=>this._getWorkerSource(X,ft.type,ft.source).getData()),this.actor.registerMessageHandler("LT",(X,ft)=>this._getWorkerSource(X,ft.type,ft.source).loadTile(ft)),this.actor.registerMessageHandler("RT",(X,ft)=>this._getWorkerSource(X,ft.type,ft.source).reloadTile(ft)),this.actor.registerMessageHandler("AT",(X,ft)=>this._getWorkerSource(X,ft.type,ft.source).abortTile(ft)),this.actor.registerMessageHandler("RMT",(X,ft)=>this._getWorkerSource(X,ft.type,ft.source).removeTile(ft)),this.actor.registerMessageHandler("RS",(X,ft)=>a._(this,void 0,void 0,function*(){if(!this.workerSources[X]||!this.workerSources[X][ft.type]||!this.workerSources[X][ft.type][ft.source])return;const Bt=this.workerSources[X][ft.type][ft.source];delete this.workerSources[X][ft.type][ft.source],Bt.removeSource!==void 0&&Bt.removeSource(ft)})),this.actor.registerMessageHandler("RM",X=>a._(this,void 0,void 0,function*(){delete this.layerIndexes[X],delete this.availableImages[X],delete this.workerSources[X],delete this.demWorkerSources[X]})),this.actor.registerMessageHandler("SR",(X,ft)=>a._(this,void 0,void 0,function*(){this.referrer=ft})),this.actor.registerMessageHandler("SRPS",(X,ft)=>this._syncRTLPluginState(X,ft)),this.actor.registerMessageHandler("IS",(X,ft)=>a._(this,void 0,void 0,function*(){this.self.importScripts(ft)})),this.actor.registerMessageHandler("SI",(X,ft)=>this._setImages(X,ft)),this.actor.registerMessageHandler("UL",(X,ft)=>a._(this,void 0,void 0,function*(){this._getLayerIndex(X).update(ft.layers,ft.removedIds)})),this.actor.registerMessageHandler("SL",(X,ft)=>a._(this,void 0,void 0,function*(){this._getLayerIndex(X).replace(ft)}))}_setImages(W,X){return a._(this,void 0,void 0,function*(){this.availableImages[W]=X;for(const ft in this.workerSources[W]){const Bt=this.workerSources[W][ft];for(const kt in Bt)Bt[kt].availableImages=X}})}_syncRTLPluginState(W,X){return a._(this,void 0,void 0,function*(){if(a.bC.isParsed())return a.bC.getState();if(X.pluginStatus!=="loading")return a.bC.setState(X),X;const ft=X.pluginURL;if(this.self.importScripts(ft),a.bC.isParsed()){const Bt={pluginStatus:"loaded",pluginURL:ft};return a.bC.setState(Bt),Bt}throw a.bC.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${ft}`)})}_getAvailableImages(W){let X=this.availableImages[W];return X||(X=[]),X}_getLayerIndex(W){let X=this.layerIndexes[W];return X||(X=this.layerIndexes[W]=new o),X}_getWorkerSource(W,X,ft){if(this.workerSources[W]||(this.workerSources[W]={}),this.workerSources[W][X]||(this.workerSources[W][X]={}),!this.workerSources[W][X][ft]){const Bt={sendAsync:(kt,Gt)=>(kt.targetMapId=W,this.actor.sendAsync(kt,Gt))};switch(X){case"vector":this.workerSources[W][X][ft]=new b(Bt,this._getLayerIndex(W),this._getAvailableImages(W));break;case"geojson":this.workerSources[W][X][ft]=new vn(Bt,this._getLayerIndex(W),this._getAvailableImages(W));break;default:this.workerSources[W][X][ft]=new this.externalWorkerSourceTypes[X](Bt,this._getLayerIndex(W),this._getAvailableImages(W))}}return this.workerSources[W][X][ft]}_getDEMWorkerSource(W,X){return this.demWorkerSources[W]||(this.demWorkerSources[W]={}),this.demWorkerSources[W][X]||(this.demWorkerSources[W][X]=new x),this.demWorkerSources[W][X]}}return a.i(self)&&(self.worker=new ln(self)),ln}),i("index",["exports","./shared"],function(a,o){var d="4.5.0";let p,y;const b={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:S=>new Promise((c,f)=>{const _=requestAnimationFrame(c);S.signal.addEventListener("abort",()=>{cancelAnimationFrame(_),f(o.c())})}),getImageData(S){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return this.getImageCanvasContext(S).getImageData(-c,-c,S.width+2*c,S.height+2*c)},getImageCanvasContext(S){const c=window.document.createElement("canvas"),f=c.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return c.width=S.width,c.height=S.height,f.drawImage(S,0,0,S.width,S.height),f},resolveURL:S=>(p||(p=document.createElement("a")),p.href=S,p.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(y==null&&(y=matchMedia("(prefers-reduced-motion: reduce)")),y.matches)}};class x{static testProp(c){if(!x.docStyle)return c[0];for(let f=0;f<c.length;f++)if(c[f]in x.docStyle)return c[f];return c[0]}static create(c,f,_){const A=window.document.createElement(c);return f!==void 0&&(A.className=f),_&&_.appendChild(A),A}static createNS(c,f){return window.document.createElementNS(c,f)}static disableDrag(){x.docStyle&&x.selectProp&&(x.userSelect=x.docStyle[x.selectProp],x.docStyle[x.selectProp]="none")}static enableDrag(){x.docStyle&&x.selectProp&&(x.docStyle[x.selectProp]=x.userSelect)}static setTransform(c,f){c.style[x.transformProp]=f}static addEventListener(c,f,_){let A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};c.addEventListener(f,_,"passive"in A?A:A.capture)}static removeEventListener(c,f,_){let A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};c.removeEventListener(f,_,"passive"in A?A:A.capture)}static suppressClickInternal(c){c.preventDefault(),c.stopPropagation(),window.removeEventListener("click",x.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",x.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",x.suppressClickInternal,!0)},0)}static getScale(c){const f=c.getBoundingClientRect();return{x:f.width/c.offsetWidth||1,y:f.height/c.offsetHeight||1,boundingClientRect:f}}static getPoint(c,f,_){const A=f.boundingClientRect;return new o.P((_.clientX-A.left)/f.x-c.clientLeft,(_.clientY-A.top)/f.y-c.clientTop)}static mousePos(c,f){const _=x.getScale(c);return x.getPoint(c,_,f)}static touchPos(c,f){const _=[],A=x.getScale(c);for(let g=0;g<f.length;g++)_.push(x.getPoint(c,A,f[g]));return _}static mouseButton(c){return c.button}static remove(c){c.parentNode&&c.parentNode.removeChild(c)}}x.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,x.selectProp=x.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),x.transformProp=x.testProp(["transform","WebkitTransform"]);const C={supported:!1,testSupport:function(S){!k&&M&&(z?V(S):P=S)}};let P,M,k=!1,z=!1;function V(S){const c=S.createTexture();S.bindTexture(S.TEXTURE_2D,c);try{if(S.texImage2D(S.TEXTURE_2D,0,S.RGBA,S.RGBA,S.UNSIGNED_BYTE,M),S.isContextLost())return;C.supported=!0}catch{}S.deleteTexture(c),k=!0}var $;typeof document<"u"&&(M=document.createElement("img"),M.onload=()=>{P&&V(P),P=null,z=!0},M.onerror=()=>{k=!0,P=null},M.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(S){let c,f,_,A;S.resetRequestQueue=()=>{c=[],f=0,_=0,A={}},S.addThrottleControl=I=>{const L=_++;return A[L]=I,L},S.removeThrottleControl=I=>{delete A[I],w()},S.getImage=function(I,L){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return new Promise((O,N)=>{C.supported&&(I.headers||(I.headers={}),I.headers.accept="image/webp,*/*"),o.e(I,{type:"image"}),c.push({abortController:L,requestParameters:I,supportImageRefresh:R,state:"queued",onError:H=>{N(H)},onSuccess:H=>{O(H)}}),w()})};const g=I=>o._(this,void 0,void 0,function*(){I.state="running";const{requestParameters:L,supportImageRefresh:R,onError:O,onSuccess:N,abortController:H}=I,K=R===!1&&!o.i(self)&&!o.g(L.url)&&(!L.headers||Object.keys(L.headers).reduce((Z,yt)=>Z&&yt==="accept",!0));f++;const et=K?B(L,H):o.m(L,H);try{const Z=yield et;delete I.abortController,I.state="completed",Z.data instanceof HTMLImageElement||o.b(Z.data)?N(Z):Z.data&&N({data:yield(Y=Z.data,typeof createImageBitmap=="function"?o.d(Y):o.f(Y)),cacheControl:Z.cacheControl,expires:Z.expires})}catch(Z){delete I.abortController,O(Z)}finally{f--,w()}var Y}),w=()=>{const I=(()=>{for(const L of Object.keys(A))if(A[L]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let L=f;L<I&&c.length>0;L++){const R=c.shift();R.abortController.signal.aborted?L--:g(R)}},B=(I,L)=>new Promise((R,O)=>{const N=new Image,H=I.url,K=I.credentials;K&&K==="include"?N.crossOrigin="use-credentials":(K&&K==="same-origin"||!o.s(H))&&(N.crossOrigin="anonymous"),L.signal.addEventListener("abort",()=>{N.src="",O(o.c())}),N.fetchPriority="high",N.onload=()=>{N.onerror=N.onload=null,R({data:N})},N.onerror=()=>{N.onerror=N.onload=null,L.signal.aborted||O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},N.src=H})}($||($={})),$.resetRequestQueue();class tt{constructor(c){this._transformRequestFn=c}transformRequest(c,f){return this._transformRequestFn&&this._transformRequestFn(c,f)||{url:c}}setTransformRequest(c){this._transformRequestFn=c}}function pt(S){var c=new o.A(3);return c[0]=S[0],c[1]=S[1],c[2]=S[2],c}var gt,mt=function(S,c,f){return S[0]=c[0]-f[0],S[1]=c[1]-f[1],S[2]=c[2]-f[2],S};gt=new o.A(3),o.A!=Float32Array&&(gt[0]=0,gt[1]=0,gt[2]=0);var dt=function(S){var c=S[0],f=S[1];return c*c+f*f};function Ft(S){const c=[];if(typeof S=="string")c.push({id:"default",url:S});else if(S&&S.length>0){const f=[];for(const{id:_,url:A}of S){const g=`${_}${A}`;f.indexOf(g)===-1&&(f.push(g),c.push({id:_,url:A}))}}return c}function Tt(S,c,f){const _=S.split("?");return _[0]+=`${c}${f}`,_.join("?")}(function(){var S=new o.A(2);o.A!=Float32Array&&(S[0]=0,S[1]=0)})();class ot{constructor(c,f,_,A){this.context=c,this.format=_,this.texture=c.gl.createTexture(),this.update(f,A)}update(c,f,_){const{width:A,height:g}=c,w=!(this.size&&this.size[0]===A&&this.size[1]===g||_),{context:B}=this,{gl:I}=B;if(this.useMipmap=!!(f&&f.useMipmap),I.bindTexture(I.TEXTURE_2D,this.texture),B.pixelStoreUnpackFlipY.set(!1),B.pixelStoreUnpack.set(1),B.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!f||f.premultiply!==!1)),w)this.size=[A,g],c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||o.b(c)?I.texImage2D(I.TEXTURE_2D,0,this.format,this.format,I.UNSIGNED_BYTE,c):I.texImage2D(I.TEXTURE_2D,0,this.format,A,g,0,this.format,I.UNSIGNED_BYTE,c.data);else{const{x:L,y:R}=_||{x:0,y:0};c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||o.b(c)?I.texSubImage2D(I.TEXTURE_2D,0,L,R,I.RGBA,I.UNSIGNED_BYTE,c):I.texSubImage2D(I.TEXTURE_2D,0,L,R,A,g,I.RGBA,I.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&I.generateMipmap(I.TEXTURE_2D)}bind(c,f,_){const{context:A}=this,{gl:g}=A;g.bindTexture(g.TEXTURE_2D,this.texture),_!==g.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(_=g.LINEAR),c!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,c),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,_||c),this.filter=c),f!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,f),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,f),this.wrap=f)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}function ct(S){const{userImage:c}=S;return!!(c&&c.render&&c.render())&&(S.data.replace(new Uint8Array(c.data.buffer)),!0)}class wt extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:f,promiseResolve:_}of this.requestors)_(this._getImagesForIds(f));this.requestors=[]}}getImage(c){const f=this.images[c];if(f&&!f.data&&f.spriteData){const _=f.spriteData;f.data=new o.R({width:_.width,height:_.height},_.context.getImageData(_.x,_.y,_.width,_.height).data),f.spriteData=null}return f}addImage(c,f){if(this.images[c])throw new Error(`Image id ${c} already exist, use updateImage instead`);this._validate(c,f)&&(this.images[c]=f)}_validate(c,f){let _=!0;const A=f.data||f.spriteData;return this._validateStretch(f.stretchX,A&&A.width)||(this.fire(new o.j(new Error(`Image "${c}" has invalid "stretchX" value`))),_=!1),this._validateStretch(f.stretchY,A&&A.height)||(this.fire(new o.j(new Error(`Image "${c}" has invalid "stretchY" value`))),_=!1),this._validateContent(f.content,f)||(this.fire(new o.j(new Error(`Image "${c}" has invalid "content" value`))),_=!1),_}_validateStretch(c,f){if(!c)return!0;let _=0;for(const A of c){if(A[0]<_||A[1]<A[0]||f<A[1])return!1;_=A[1]}return!0}_validateContent(c,f){if(!c)return!0;if(c.length!==4)return!1;const _=f.spriteData,A=_&&_.width||f.data.width,g=_&&_.height||f.data.height;return!(c[0]<0||A<c[0]||c[1]<0||g<c[1]||c[2]<0||A<c[2]||c[3]<0||g<c[3]||c[2]<c[0]||c[3]<c[1])}updateImage(c,f){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const A=this.getImage(c);if(_&&(A.data.width!==f.data.width||A.data.height!==f.data.height))throw new Error(`size mismatch between old image (${A.data.width}x${A.data.height}) and new image (${f.data.width}x${f.data.height}).`);f.version=A.version+1,this.images[c]=f,this.updatedImages[c]=!0}removeImage(c){const f=this.images[c];delete this.images[c],delete this.patterns[c],f.userImage&&f.userImage.onRemove&&f.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c){return new Promise((f,_)=>{let A=!0;if(!this.isLoaded())for(const g of c)this.images[g]||(A=!1);this.isLoaded()||A?f(this._getImagesForIds(c)):this.requestors.push({ids:c,promiseResolve:f})})}_getImagesForIds(c){const f={};for(const _ of c){let A=this.getImage(_);A||(this.fire(new o.k("styleimagemissing",{id:_})),A=this.getImage(_)),A?f[_]={data:A.data.clone(),pixelRatio:A.pixelRatio,sdf:A.sdf,version:A.version,stretchX:A.stretchX,stretchY:A.stretchY,content:A.content,textFitWidth:A.textFitWidth,textFitHeight:A.textFitHeight,hasRenderCallback:!!(A.userImage&&A.userImage.render)}:o.w(`Image "${_}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return f}getPixelSize(){const{width:c,height:f}=this.atlasImage;return{width:c,height:f}}getPattern(c){const f=this.patterns[c],_=this.getImage(c);if(!_)return null;if(f&&f.position.version===_.version)return f.position;if(f)f.position.version=_.version;else{const A={w:_.data.width+2,h:_.data.height+2,x:0,y:0},g=new o.I(A,_);this.patterns[c]={bin:A,position:g}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const f=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ot(c,this.atlasImage,f.RGBA),this.atlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const g in this.patterns)c.push(this.patterns[g].bin);const{w:f,h:_}=o.p(c),A=this.atlasImage;A.resize({width:f||1,height:_||1});for(const g in this.patterns){const{bin:w}=this.patterns[g],B=w.x+1,I=w.y+1,L=this.getImage(g).data,R=L.width,O=L.height;o.R.copy(L,A,{x:0,y:0},{x:B,y:I},{width:R,height:O}),o.R.copy(L,A,{x:0,y:O-1},{x:B,y:I-1},{width:R,height:1}),o.R.copy(L,A,{x:0,y:0},{x:B,y:I+O},{width:R,height:1}),o.R.copy(L,A,{x:R-1,y:0},{x:B-1,y:I},{width:1,height:O}),o.R.copy(L,A,{x:0,y:0},{x:B+R,y:I},{width:1,height:O})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const f of c){if(this.callbackDispatchedThisFrame[f])continue;this.callbackDispatchedThisFrame[f]=!0;const _=this.getImage(f);_||o.w(`Image with ID: "${f}" was not found`),ct(_)&&this.updateImage(f,_)}}}const vt=1e20;function $t(S,c,f,_,A,g,w,B,I){for(let L=c;L<c+_;L++)Wt(S,f*g+L,g,A,w,B,I);for(let L=f;L<f+A;L++)Wt(S,L*g+c,1,_,w,B,I)}function Wt(S,c,f,_,A,g,w){g[0]=0,w[0]=-vt,w[1]=vt,A[0]=S[c];for(let B=1,I=0,L=0;B<_;B++){A[B]=S[c+B*f];const R=B*B;do{const O=g[I];L=(A[B]-A[O]+R-O*O)/(B-O)/2}while(L<=w[I]&&--I>-1);I++,g[I]=B,w[I]=L,w[I+1]=vt}for(let B=0,I=0;B<_;B++){for(;w[I+1]<B;)I++;const L=g[I],R=B-L;S[c+B*f]=A[L]+R*R}}class Yt{constructor(c,f){this.requestManager=c,this.localIdeographFontFamily=f,this.entries={}}setURL(c){this.url=c}getGlyphs(c){return o._(this,void 0,void 0,function*(){const f=[];for(const g in c)for(const w of c[g])f.push(this._getAndCacheGlyphsPromise(g,w));const _=yield Promise.all(f),A={};for(const{stack:g,id:w,glyph:B}of _)A[g]||(A[g]={}),A[g][w]=B&&{id:B.id,bitmap:B.bitmap.clone(),metrics:B.metrics};return A})}_getAndCacheGlyphsPromise(c,f){return o._(this,void 0,void 0,function*(){let _=this.entries[c];_||(_=this.entries[c]={glyphs:{},requests:{},ranges:{}});let A=_.glyphs[f];if(A!==void 0)return{stack:c,id:f,glyph:A};if(A=this._tinySDF(_,c,f),A)return _.glyphs[f]=A,{stack:c,id:f,glyph:A};const g=Math.floor(f/256);if(256*g>65535)throw new Error("glyphs > 65535 not supported");if(_.ranges[g])return{stack:c,id:f,glyph:A};if(!this.url)throw new Error("glyphsUrl is not set");if(!_.requests[g]){const B=Yt.loadGlyphRange(c,g,this.url,this.requestManager);_.requests[g]=B}const w=yield _.requests[g];for(const B in w)this._doesCharSupportLocalGlyph(+B)||(_.glyphs[+B]=w[+B]);return _.ranges[g]=!0,{stack:c,id:f,glyph:w[f]||null}})}_doesCharSupportLocalGlyph(c){return!!this.localIdeographFontFamily&&(o.u["CJK Unified Ideographs"](c)||o.u["Hangul Syllables"](c)||o.u.Hiragana(c)||o.u.Katakana(c))}_tinySDF(c,f,_){const A=this.localIdeographFontFamily;if(!A||!this._doesCharSupportLocalGlyph(_))return;let g=c.tinySDF;if(!g){let B="400";/bold/i.test(f)?B="900":/medium/i.test(f)?B="500":/light/i.test(f)&&(B="200"),g=c.tinySDF=new Yt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:A,fontWeight:B})}const w=g.draw(String.fromCharCode(_));return{id:_,bitmap:new o.o({width:w.width||60,height:w.height||60},w.data),metrics:{width:w.glyphWidth/2||24,height:w.glyphHeight/2||24,left:w.glyphLeft/2+.5||0,top:w.glyphTop/2-27.5||-8,advance:w.glyphAdvance/2||24,isDoubleResolution:!0}}}}Yt.loadGlyphRange=function(S,c,f,_){return o._(this,void 0,void 0,function*(){const A=256*c,g=A+255,w=_.transformRequest(f.replace("{fontstack}",S).replace("{range}",`${A}-${g}`),"Glyphs"),B=yield o.l(w,new AbortController);if(!B||!B.data)throw new Error(`Could not load glyph range. range: ${c}, ${A}-${g}`);const I={};for(const L of o.n(B.data))I[L.id]=L;return I})},Yt.TinySDF=class{constructor(){let{fontSize:S=24,buffer:c=3,radius:f=8,cutoff:_=.25,fontFamily:A="sans-serif",fontWeight:g="normal",fontStyle:w="normal"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.buffer=c,this.cutoff=_,this.radius=f;const B=this.size=S+4*c,I=this._createCanvas(B),L=this.ctx=I.getContext("2d",{willReadFrequently:!0});L.font=`${w} ${g} ${S}px ${A}`,L.textBaseline="alphabetic",L.textAlign="left",L.fillStyle="black",this.gridOuter=new Float64Array(B*B),this.gridInner=new Float64Array(B*B),this.f=new Float64Array(B),this.z=new Float64Array(B+1),this.v=new Uint16Array(B)}_createCanvas(S){const c=document.createElement("canvas");return c.width=c.height=S,c}draw(S){const{width:c,actualBoundingBoxAscent:f,actualBoundingBoxDescent:_,actualBoundingBoxLeft:A,actualBoundingBoxRight:g}=this.ctx.measureText(S),w=Math.ceil(f),B=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-A))),I=Math.min(this.size-this.buffer,w+Math.ceil(_)),L=B+2*this.buffer,R=I+2*this.buffer,O=Math.max(L*R,0),N=new Uint8ClampedArray(O),H={data:N,width:L,height:R,glyphWidth:B,glyphHeight:I,glyphTop:w,glyphLeft:0,glyphAdvance:c};if(B===0||I===0)return H;const{ctx:K,buffer:et,gridInner:Y,gridOuter:Z}=this;K.clearRect(et,et,B,I),K.fillText(S,et,et+w);const yt=K.getImageData(et,et,B,I);Z.fill(vt,0,O),Y.fill(0,0,O);for(let at=0;at<I;at++)for(let lt=0;lt<B;lt++){const At=yt.data[4*(at*B+lt)+3]/255;if(At===0)continue;const Et=(at+et)*L+lt+et;if(At===1)Z[Et]=0,Y[Et]=vt;else{const Dt=.5-At;Z[Et]=Dt>0?Dt*Dt:0,Y[Et]=Dt<0?Dt*Dt:0}}$t(Z,0,0,L,R,L,this.f,this.v,this.z),$t(Y,et,et,B,I,L,this.f,this.v,this.z);for(let at=0;at<O;at++){const lt=Math.sqrt(Z[at])-Math.sqrt(Y[at]);N[at]=Math.round(255-255*(lt/this.radius+this.cutoff))}return H}};class Kt{constructor(){this.specification=o.v.light.position}possiblyEvaluate(c,f){return o.y(c.expression.evaluate(f))}interpolate(c,f,_){return{x:o.z.number(c.x,f.x,_),y:o.z.number(c.y,f.y,_),z:o.z.number(c.z,f.z,_)}}}let ee;class Zt extends o.E{constructor(c){super(),ee=ee||new o.q({anchor:new o.D(o.v.light.anchor),position:new Kt,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.T(ee),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this._validate(o.r,c,f))for(const _ in c){const A=c[_];_.endsWith("-transition")?this._transitionable.setTransition(_.slice(0,-11),A):this._transitionable.setValue(_,A)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,f,_){return(!_||_.validate!==!1)&&o.t(this,c.call(o.x,{value:f,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}const we=new o.q({"sky-color":new o.D(o.v.sky["sky-color"]),"horizon-color":new o.D(o.v.sky["horizon-color"]),"fog-color":new o.D(o.v.sky["fog-color"]),"fog-ground-blend":new o.D(o.v.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.v.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.v.sky["atmosphere-blend"])});class it extends o.E{constructor(c){super(),this._transitionable=new o.T(we),this.setSky(c),this._transitioning=this._transitionable.untransitioned()}setSky(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this._validate(o.B,c,f))for(const _ in c){const A=c[_];_.endsWith("-transition")?this._transitionable.setTransition(_.slice(0,-11),A):this._transitionable.setValue(_,A)}}getSky(){return this._transitionable.serialize()}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,f){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return(_==null?void 0:_.validate)!==!1&&o.t(this,c.call(o.x,o.e({value:f,style:{glyphs:!0,sprite:!0},styleSpec:o.v})))}calculateFogBlendOpacity(c){return c<60?0:c<70?(c-60)/10:1}}class xt{constructor(c,f){this.width=c,this.height=f,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(c,f){const _=c.join(",")+String(f);return this.dashEntry[_]||(this.dashEntry[_]=this.addDash(c,f)),this.dashEntry[_]}getDashRanges(c,f,_){const A=[];let g=c.length%2==1?-c[c.length-1]*_:0,w=c[0]*_,B=!0;A.push({left:g,right:w,isDash:B,zeroLength:c[0]===0});let I=c[0];for(let L=1;L<c.length;L++){B=!B;const R=c[L];g=I*_,I+=R,w=I*_,A.push({left:g,right:w,isDash:B,zeroLength:R===0})}return A}addRoundDash(c,f,_){const A=f/2;for(let g=-_;g<=_;g++){const w=this.width*(this.nextRow+_+g);let B=0,I=c[B];for(let L=0;L<this.width;L++){L/I.right>1&&(I=c[++B]);const R=Math.abs(L-I.left),O=Math.abs(L-I.right),N=Math.min(R,O);let H;const K=g/_*(A+1);if(I.isDash){const et=A-Math.abs(K);H=Math.sqrt(N*N+et*et)}else H=A-Math.sqrt(N*N+K*K);this.data[w+L]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(c){for(let B=c.length-1;B>=0;--B){const I=c[B],L=c[B+1];I.zeroLength?c.splice(B,1):L&&L.isDash===I.isDash&&(L.left=I.left,c.splice(B,1))}const f=c[0],_=c[c.length-1];f.isDash===_.isDash&&(f.left=_.left-this.width,_.right=f.right+this.width);const A=this.width*this.nextRow;let g=0,w=c[g];for(let B=0;B<this.width;B++){B/w.right>1&&(w=c[++g]);const I=Math.abs(B-w.left),L=Math.abs(B-w.right),R=Math.min(I,L);this.data[A+B]=Math.max(0,Math.min(255,(w.isDash?R:-R)+128))}}addDash(c,f){const _=f?7:0,A=2*_+1;if(this.nextRow+A>this.height)return o.w("LineAtlas out of space"),null;let g=0;for(let B=0;B<c.length;B++)g+=c[B];if(g!==0){const B=this.width/g,I=this.getDashRanges(c,this.width,B);f?this.addRoundDash(I,B,_):this.addRegularDash(I)}const w={y:(this.nextRow+_+.5)/this.height,height:2*_/this.height,width:g};return this.nextRow+=A,this.dirty=!0,w}bind(c){const f=c.gl;this.texture?(f.bindTexture(f.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,f.texSubImage2D(f.TEXTURE_2D,0,0,0,this.width,this.height,f.ALPHA,f.UNSIGNED_BYTE,this.data))):(this.texture=f.createTexture(),f.bindTexture(f.TEXTURE_2D,this.texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texImage2D(f.TEXTURE_2D,0,f.ALPHA,this.width,this.height,0,f.ALPHA,f.UNSIGNED_BYTE,this.data))}}const It="maplibre_preloaded_worker_pool";class Ut{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<Ut.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(f=>{f.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[It]}numActive(){return Object.keys(this.active).length}}const jt=Math.floor(b.hardwareConcurrency/2);let Vt,re;function te(){return Vt||(Vt=new Ut),Vt}Ut.workerCount=o.C(globalThis)?Math.max(Math.min(jt,3),1):1;class Ce{constructor(c,f){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=f;const _=this.workerPool.acquire(f);for(let A=0;A<_.length;A++){const g=new o.F(_[A],f);g.name=`Worker ${A}`,this.actors.push(g)}if(!this.actors.length)throw new Error("No actors found")}broadcast(c,f){const _=[];for(const A of this.actors)_.push(A.sendAsync({type:c,data:f}));return Promise.all(_)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.actors.forEach(f=>{f.remove()}),this.actors=[],c&&this.workerPool.release(this.id)}registerMessageHandler(c,f){for(const _ of this.actors)_.registerMessageHandler(c,f)}}function Te(){return re||(re=new Ce(te(),o.G),re.registerMessageHandler("GR",(S,c,f)=>o.m(c,f))),re}function De(S,c){const f=o.H();return o.J(f,f,[1,1,0]),o.K(f,f,[.5*S.width,.5*S.height,1]),o.L(f,f,S.calculatePosMatrix(c.toUnwrapped()))}function Qe(S,c,f,_,A,g){const w=function(O,N,H){if(O)for(const K of O){const et=N[K];if(et&&et.source===H&&et.type==="fill-extrusion")return!0}else for(const K in N){const et=N[K];if(et.source===H&&et.type==="fill-extrusion")return!0}return!1}(A&&A.layers,c,S.id),B=g.maxPitchScaleFactor(),I=S.tilesIn(_,B,w);I.sort(Je);const L=[];for(const O of I)L.push({wrappedTileID:O.tileID.wrapped().key,queryResults:O.tile.queryRenderedFeatures(c,f,S._state,O.queryGeometry,O.cameraQueryGeometry,O.scale,A,g,B,De(S.transform,O.tileID))});const R=function(O){const N={},H={};for(const K of O){const et=K.queryResults,Y=K.wrappedTileID,Z=H[Y]=H[Y]||{};for(const yt in et){const at=et[yt],lt=Z[yt]=Z[yt]||{},At=N[yt]=N[yt]||[];for(const Et of at)lt[Et.featureIndex]||(lt[Et.featureIndex]=!0,At.push(Et))}}return N}(L);for(const O in R)R[O].forEach(N=>{const H=N.feature,K=S.getFeatureState(H.layer["source-layer"],H.id);H.source=H.layer.source,H.layer["source-layer"]&&(H.sourceLayer=H.layer["source-layer"]),H.state=K});return R}function Je(S,c){const f=S.tileID,_=c.tileID;return f.overscaledZ-_.overscaledZ||f.canonical.y-_.canonical.y||f.wrap-_.wrap||f.canonical.x-_.canonical.x}function he(S,c,f){return o._(this,void 0,void 0,function*(){let _=S;if(S.url?_=(yield o.h(c.transformRequest(S.url,"Source"),f)).data:yield b.frameAsync(f),!_)return null;const A=o.M(o.e(_,S),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in _&&_.vector_layers&&(A.vectorLayerIds=_.vector_layers.map(g=>g.id)),A})}class st{constructor(c,f){c&&(f?this.setSouthWest(c).setNorthEast(f):Array.isArray(c)&&(c.length===4?this.setSouthWest([c[0],c[1]]).setNorthEast([c[2],c[3]]):this.setSouthWest(c[0]).setNorthEast(c[1])))}setNorthEast(c){return this._ne=c instanceof o.N?new o.N(c.lng,c.lat):o.N.convert(c),this}setSouthWest(c){return this._sw=c instanceof o.N?new o.N(c.lng,c.lat):o.N.convert(c),this}extend(c){const f=this._sw,_=this._ne;let A,g;if(c instanceof o.N)A=c,g=c;else{if(!(c instanceof st))return Array.isArray(c)?c.length===4||c.every(Array.isArray)?this.extend(st.convert(c)):this.extend(o.N.convert(c)):c&&("lng"in c||"lon"in c)&&"lat"in c?this.extend(o.N.convert(c)):this;if(A=c._sw,g=c._ne,!A||!g)return this}return f||_?(f.lng=Math.min(A.lng,f.lng),f.lat=Math.min(A.lat,f.lat),_.lng=Math.max(g.lng,_.lng),_.lat=Math.max(g.lat,_.lat)):(this._sw=new o.N(A.lng,A.lat),this._ne=new o.N(g.lng,g.lat)),this}getCenter(){return new o.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.N(this.getWest(),this.getNorth())}getSouthEast(){return new o.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(c){const{lng:f,lat:_}=o.N.convert(c);let A=this._sw.lng<=f&&f<=this._ne.lng;return this._sw.lng>this._ne.lng&&(A=this._sw.lng>=f&&f>=this._ne.lng),this._sw.lat<=_&&_<=this._ne.lat&&A}static convert(c){return c instanceof st?c:c&&new st(c)}static fromLngLat(c){const _=360*(arguments.length>1&&arguments[1]!==void 0?arguments[1]:0)/40075017,A=_/Math.cos(Math.PI/180*c.lat);return new st(new o.N(c.lng-A,c.lat-_),new o.N(c.lng+A,c.lat+_))}}class fr{constructor(c,f,_){this.bounds=st.convert(this.validateBounds(c)),this.minzoom=f||0,this.maxzoom=_||24}validateBounds(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const f=Math.pow(2,c.z),_=Math.floor(o.O(this.bounds.getWest())*f),A=Math.floor(o.Q(this.bounds.getNorth())*f),g=Math.ceil(o.O(this.bounds.getEast())*f),w=Math.ceil(o.Q(this.bounds.getSouth())*f);return c.x>=_&&c.x<g&&c.y>=A&&c.y<w}}class er extends o.E{constructor(c,f,_,A){if(super(),this.id=c,this.dispatcher=_,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.M(f,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},f),this._collectResourceTiming=f.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(A)}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const c=yield he(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),c&&(o.e(this,c),c.bounds&&(this.tileBounds=new fr(c.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(c){this._tileJSONRequest=null,this.fire(new o.j(c))}})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}setSourceProperty(c){this._tileJSONRequest&&this._tileJSONRequest.abort(),c(),this.load()}setTiles(c){return this.setSourceProperty(()=>{this._options.tiles=c}),this}setUrl(c){return this.setSourceProperty(()=>{this.url=c,this._options.url=c}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(c){return o._(this,void 0,void 0,function*(){const f=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),_={request:this.map._requestManager.transformRequest(f,"Tile"),uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};_.request.collectResourceTiming=this._collectResourceTiming;let A="RT";if(c.actor&&c.state!=="expired"){if(c.state==="loading")return new Promise((g,w)=>{c.reloadPromise={resolve:g,reject:w}})}else c.actor=this.dispatcher.getActor(),A="LT";c.abortController=new AbortController;try{const g=yield c.actor.sendAsync({type:A,data:_},c.abortController);if(delete c.abortController,c.aborted)return;this._afterTileLoadWorkerResponse(c,g)}catch(g){if(delete c.abortController,c.aborted)return;if(g&&g.status!==404)throw g;this._afterTileLoadWorkerResponse(c,null)}})}_afterTileLoadWorkerResponse(c,f){if(f&&f.resourceTiming&&(c.resourceTiming=f.resourceTiming),f&&this.map._refreshExpiredTiles&&c.setExpiryData(f),c.loadVectorData(f,this.map.painter),c.reloadPromise){const _=c.reloadPromise;c.reloadPromise=null,this.loadTile(c).then(_.resolve).catch(_.reject)}}abortTile(c){return o._(this,void 0,void 0,function*(){c.abortController&&(c.abortController.abort(),delete c.abortController),c.actor&&(yield c.actor.sendAsync({type:"AT",data:{uid:c.uid,type:this.type,source:this.id}}))})}unloadTile(c){return o._(this,void 0,void 0,function*(){c.unloadVectorData(),c.actor&&(yield c.actor.sendAsync({type:"RMT",data:{uid:c.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class de extends o.E{constructor(c,f,_,A){super(),this.id=c,this.dispatcher=_,this.setEventedParent(A),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},f),o.e(this,o.M(f,["url","scheme","tileSize"]))}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const c=yield he(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,c&&(o.e(this,c),c.bounds&&(this.tileBounds=new fr(c.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(c){this._tileJSONRequest=null,this.fire(new o.j(c))}})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(c){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),c(),this.load()}setTiles(c){return this.setSourceProperty(()=>{this._options.tiles=c}),this}setUrl(c){return this.setSourceProperty(()=>{this.url=c,this._options.url=c}),this}serialize(){return o.e({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c){return o._(this,void 0,void 0,function*(){const f=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);c.abortController=new AbortController;try{const _=yield $.getImage(this.map._requestManager.transformRequest(f,"Tile"),c.abortController,this.map._refreshExpiredTiles);if(delete c.abortController,c.aborted)return void(c.state="unloaded");if(_&&_.data){this.map._refreshExpiredTiles&&_.cacheControl&&_.expires&&c.setExpiryData({cacheControl:_.cacheControl,expires:_.expires});const A=this.map.painter.context,g=A.gl,w=_.data;c.texture=this.map.painter.getTileTexture(w.width),c.texture?c.texture.update(w,{useMipmap:!0}):(c.texture=new ot(A,w,g.RGBA,{useMipmap:!0}),c.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST),A.extTextureFilterAnisotropic&&g.texParameterf(g.TEXTURE_2D,A.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,A.extTextureFilterAnisotropicMax)),c.state="loaded"}}catch(_){if(delete c.abortController,c.aborted)c.state="unloaded";else if(_)throw c.state="errored",_}})}abortTile(c){return o._(this,void 0,void 0,function*(){c.abortController&&(c.abortController.abort(),delete c.abortController)})}unloadTile(c){return o._(this,void 0,void 0,function*(){c.texture&&this.map.painter.saveTileTexture(c.texture)})}hasTransition(){return!1}}class ve extends de{constructor(c,f,_,A){super(c,f,_,A),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},f),this.encoding=f.encoding||"mapbox",this.redFactor=f.redFactor,this.greenFactor=f.greenFactor,this.blueFactor=f.blueFactor,this.baseShift=f.baseShift}loadTile(c){return o._(this,void 0,void 0,function*(){const f=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),_=this.map._requestManager.transformRequest(f,"Tile");c.neighboringTiles=this._getNeighboringTiles(c.tileID),c.abortController=new AbortController;try{const A=yield $.getImage(_,c.abortController,this.map._refreshExpiredTiles);if(delete c.abortController,c.aborted)return void(c.state="unloaded");if(A&&A.data){const g=A.data;this.map._refreshExpiredTiles&&A.cacheControl&&A.expires&&c.setExpiryData({cacheControl:A.cacheControl,expires:A.expires});const w=o.b(g)&&o.U()?g:yield this.readImageNow(g),B={type:this.type,uid:c.uid,source:this.id,rawImageData:w,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!c.actor||c.state==="expired"){c.actor=this.dispatcher.getActor();const I=yield c.actor.sendAsync({type:"LDT",data:B});c.dem=I,c.needsHillshadePrepare=!0,c.needsTerrainPrepare=!0,c.state="loaded"}}}catch(A){if(delete c.abortController,c.aborted)c.state="unloaded";else if(A)throw c.state="errored",A}})}readImageNow(c){return o._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&o.V()){const f=c.width+2,_=c.height+2;try{return new o.R({width:f,height:_},yield o.W(c,-1,-1,f,_))}catch{}}return b.getImageData(c,1)})}_getNeighboringTiles(c){const f=c.canonical,_=Math.pow(2,f.z),A=(f.x-1+_)%_,g=f.x===0?c.wrap-1:c.wrap,w=(f.x+1+_)%_,B=f.x+1===_?c.wrap+1:c.wrap,I={};return I[new o.S(c.overscaledZ,g,f.z,A,f.y).key]={backfilled:!1},I[new o.S(c.overscaledZ,B,f.z,w,f.y).key]={backfilled:!1},f.y>0&&(I[new o.S(c.overscaledZ,g,f.z,A,f.y-1).key]={backfilled:!1},I[new o.S(c.overscaledZ,c.wrap,f.z,f.x,f.y-1).key]={backfilled:!1},I[new o.S(c.overscaledZ,B,f.z,w,f.y-1).key]={backfilled:!1}),f.y+1<_&&(I[new o.S(c.overscaledZ,g,f.z,A,f.y+1).key]={backfilled:!1},I[new o.S(c.overscaledZ,c.wrap,f.z,f.x,f.y+1).key]={backfilled:!1},I[new o.S(c.overscaledZ,B,f.z,w,f.y+1).key]={backfilled:!1}),I}unloadTile(c){return o._(this,void 0,void 0,function*(){c.demTexture&&this.map.painter.saveTileTexture(c.demTexture),c.fbo&&(c.fbo.destroy(),delete c.fbo),c.dem&&delete c.dem,delete c.neighboringTiles,c.state="unloaded",c.actor&&(yield c.actor.sendAsync({type:"RDT",data:{type:this.type,uid:c.uid,source:this.id}}))})}}class Le extends o.E{constructor(c,f,_,A){super(),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=_.getActor(),this.setEventedParent(A),this._data=f.data,this._options=o.e({},f),this._collectResourceTiming=f.collectResourceTiming,f.maxzoom!==void 0&&(this.maxzoom=f.maxzoom),f.type&&(this.type=f.type),f.attribution&&(this.attribution=f.attribution),this.promoteId=f.promoteId;const g=o.X/this.tileSize;this.workerOptions=o.e({source:this.id,cluster:f.cluster||!1,geojsonVtOptions:{buffer:(f.buffer!==void 0?f.buffer:128)*g,tolerance:(f.tolerance!==void 0?f.tolerance:.375)*g,extent:o.X,maxZoom:this.maxzoom,lineMetrics:f.lineMetrics||!1,generateId:f.generateId||!1},superclusterOptions:{maxZoom:f.clusterMaxZoom!==void 0?f.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,f.clusterMinPoints||2),extent:o.X,radius:(f.clusterRadius||50)*g,log:!1,generateId:f.generateId||!1},clusterProperties:f.clusterProperties,filter:f.filter},f.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return o._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(c){this.map=c,this.load()}setData(c){return this._data=c,this._updateWorkerData(),this}updateData(c){return this._updateWorkerData(c),this}getData(){return o._(this,void 0,void 0,function*(){const c=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:c})})}setClusterOptions(c){return this.workerOptions.cluster=c.cluster,c&&(c.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=c.clusterRadius),c.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=c.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(c){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:c,source:this.id}})}getClusterChildren(c){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:c,source:this.id}})}getClusterLeaves(c,f,_){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:c,limit:f,offset:_}})}_updateWorkerData(c){return o._(this,void 0,void 0,function*(){const f=o.e({type:this.type},this.workerOptions);c?f.dataDiff=c:typeof this._data=="string"?(f.request=this.map._requestManager.transformRequest(b.resolveURL(this._data),"Source"),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new o.k("dataloading",{dataType:"source"}));try{const _=yield this.actor.sendAsync({type:"LD",data:f});if(this._pendingLoads--,this._removed||_.abandoned)return void this.fire(new o.k("dataabort",{dataType:"source"}));let A=null;_.resourceTiming&&_.resourceTiming[this.id]&&(A=_.resourceTiming[this.id].slice(0));const g={dataType:"source"};this._collectResourceTiming&&A&&A.length>0&&o.e(g,{resourceTiming:A}),this.fire(new o.k("data",Object.assign(Object.assign({},g),{sourceDataType:"metadata"}))),this.fire(new o.k("data",Object.assign(Object.assign({},g),{sourceDataType:"content"})))}catch(_){if(this._pendingLoads--,this._removed)return void this.fire(new o.k("dataabort",{dataType:"source"}));this.fire(new o.j(_))}})}loaded(){return this._pendingLoads===0}loadTile(c){return o._(this,void 0,void 0,function*(){const f=c.actor?"RT":"LT";c.actor=this.actor;const _={type:this.type,uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};c.abortController=new AbortController;const A=yield this.actor.sendAsync({type:f,data:_},c.abortController);delete c.abortController,c.unloadVectorData(),c.aborted||c.loadVectorData(A,this.map.painter,f==="RT")})}abortTile(c){return o._(this,void 0,void 0,function*(){c.abortController&&(c.abortController.abort(),delete c.abortController),c.aborted=!0})}unloadTile(c){return o._(this,void 0,void 0,function*(){c.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:c.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Ue=o.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Ye extends o.E{constructor(c,f,_,A){super(),this.id=c,this.dispatcher=_,this.coordinates=f.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(A),this.options=f}load(c){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const f=yield $.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,f&&f.data&&(this.image=f.data,c&&(this.coordinates=c),this._finishLoading())}catch(f){this._request=null,this._loaded=!0,this.fire(new o.j(f))}})}loaded(){return this._loaded}updateImage(c){return c.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=c.url,this.load(c.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(c){this.coordinates=c;const f=c.map(o.Z.fromLngLat);this.tileID=function(A){let g=1/0,w=1/0,B=-1/0,I=-1/0;for(const N of A)g=Math.min(g,N.x),w=Math.min(w,N.y),B=Math.max(B,N.x),I=Math.max(I,N.y);const L=Math.max(B-g,I-w),R=Math.max(0,Math.floor(-Math.log(L)/Math.LN2)),O=Math.pow(2,R);return new o.a1(R,Math.floor((g+B)/2*O),Math.floor((w+I)/2*O))}(f),this.minzoom=this.maxzoom=this.tileID.z;const _=f.map(A=>this.tileID.getTilePoint(A)._round());return this._boundsArray=new o.$,this._boundsArray.emplaceBack(_[0].x,_[0].y,0,0),this._boundsArray.emplaceBack(_[1].x,_[1].y,o.X,0),this._boundsArray.emplaceBack(_[3].x,_[3].y,0,o.X),this._boundsArray.emplaceBack(_[2].x,_[2].y,o.X,o.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const c=this.map.painter.context,f=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,Ue.members)),this.boundsSegments||(this.boundsSegments=o.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ot(c,this.image,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE));let _=!1;for(const A in this.tiles){const g=this.tiles[A];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,_=!0)}_&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(c){return o._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={}):c.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class lr extends Ye{constructor(c,f,_,A){super(c,f,_,A),this.roundZoom=!0,this.type="video",this.options=f}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1;const c=this.options;this.urls=[];for(const f of c.urls)this.urls.push(this.map._requestManager.transformRequest(f,"Source").url);try{const f=yield o.a3(this.urls);if(this._loaded=!0,!f)return;this.video=f,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(f){this.fire(new o.j(f))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(c){if(this.video){const f=this.video.seekable;c<f.start(0)||c>f.end(0)?this.fire(new o.j(new o.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${f.start(0)} and ${f.end(0)}-second mark.`))):this.video.currentTime=c}}getVideo(){return this.video}onAdd(c){this.map||(this.map=c,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const c=this.map.painter.context,f=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,Ue.members)),this.boundsSegments||(this.boundsSegments=o.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE),f.texSubImage2D(f.TEXTURE_2D,0,0,0,f.RGBA,f.UNSIGNED_BYTE,this.video)):(this.texture=new ot(c,this.video,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE));let _=!1;for(const A in this.tiles){const g=this.tiles[A];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,_=!0)}_&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class yr extends Ye{constructor(c,f,_,A){super(c,f,_,A),f.coordinates?Array.isArray(f.coordinates)&&f.coordinates.length===4&&!f.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(w=>typeof w!="number"))||this.fire(new o.j(new o.a2(`sources.${c}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.j(new o.a2(`sources.${c}`,null,'missing required property "coordinates"'))),f.animate&&typeof f.animate!="boolean"&&this.fire(new o.j(new o.a2(`sources.${c}`,null,'optional "animate" property must be a boolean value'))),f.canvas?typeof f.canvas=="string"||f.canvas instanceof HTMLCanvasElement||this.fire(new o.j(new o.a2(`sources.${c}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.j(new o.a2(`sources.${c}`,null,'missing required property "canvas"'))),this.options=f,this.animate=f.animate===void 0||f.animate}load(){return o._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(c){this.map=c,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let c=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,c=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,c=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const f=this.map.painter.context,_=f.gl;this.boundsBuffer||(this.boundsBuffer=f.createVertexBuffer(this._boundsArray,Ue.members)),this.boundsSegments||(this.boundsSegments=o.a0.simpleSegment(0,0,4,2)),this.texture?(c||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ot(f,this.canvas,_.RGBA,{premultiply:!0});let A=!1;for(const g in this.tiles){const w=this.tiles[g];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,A=!0)}A&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const c of[this.canvas.width,this.canvas.height])if(isNaN(c)||c<=0)return!0;return!1}}const Lr={},Dr=S=>{switch(S){case"geojson":return Le;case"image":return Ye;case"raster":return de;case"raster-dem":return ve;case"vector":return er;case"video":return lr;case"canvas":return yr}return Lr[S]},pe="RTLPluginLoaded";class cr extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Te()}_syncState(c){return this.status=c,this.dispatcher.broadcast("SRPS",{pluginStatus:c,pluginURL:this.url}).catch(f=>{throw this.status="error",f})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(c){return o._(this,arguments,void 0,function(f){var _=this;let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(_.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(_.url=b.resolveURL(f),!_.url)throw new Error(`requested url ${f} is invalid`);if(_.status==="unavailable"){if(!A)return _._requestImport();_.status="deferred",_._syncState(_.status)}else if(_.status==="requested")return _._requestImport()}()})}_requestImport(){return o._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.k(pe))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let _r=null;function Re(){return _r||(_r=new cr),_r}class An{constructor(c,f){this.timeAdded=0,this.fadeEndTime=0,this.tileID=c,this.uid=o.a4(),this.uses=0,this.tileSize=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(c){const f=c+this.timeAdded;f<this.fadeEndTime||(this.fadeEndTime=f)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(c){this.demTexture&&c.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(c,f,_){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",c){c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=function(A,g){const w={};if(!g)return w;for(const B of A){const I=B.layerIds.map(L=>g.getLayer(L)).filter(Boolean);if(I.length!==0){B.layers=I,B.stateDependentLayerIds&&(B.stateDependentLayers=B.stateDependentLayerIds.map(L=>I.filter(R=>R.id===L)[0]));for(const L of I)w[L.id]=B}}return w}(c.buckets,f.style),this.hasSymbolBuckets=!1;for(const A in this.buckets){const g=this.buckets[A];if(g instanceof o.a6){if(this.hasSymbolBuckets=!0,!_)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const A in this.buckets){const g=this.buckets[A];if(g instanceof o.a6&&g.hasRTLText){this.hasRTLText=!0,Re().lazyLoad();break}}this.queryPadding=0;for(const A in this.buckets){const g=this.buckets[A];this.queryPadding=Math.max(this.queryPadding,f.style.getLayer(A).queryRadius(g))}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage)}else this.collisionBoxArray=new o.a5}unloadVectorData(){for(const c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(c){return this.buckets[c.id]}upload(c){for(const _ in this.buckets){const A=this.buckets[_];A.uploadPending()&&A.upload(c)}const f=c.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ot(c,this.imageAtlas.image,f.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ot(c,this.glyphAtlasImage,f.ALPHA),this.glyphAtlasImage=null)}prepare(c){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture)}queryRenderedFeatures(c,f,_,A,g,w,B,I,L,R){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:A,cameraQueryGeometry:g,scale:w,tileSize:this.tileSize,pixelPosMatrix:R,transform:I,params:B,queryPadding:this.queryPadding*L},c,f,_):{}}querySourceFeatures(c,f){const _=this.latestFeatureIndex;if(!_||!_.rawTileData)return;const A=_.loadVTLayers(),g=f&&f.sourceLayer?f.sourceLayer:"",w=A._geojsonTileLayer||A[g];if(!w)return;const B=o.a7(f&&f.filter),{z:I,x:L,y:R}=this.tileID.canonical,O={z:I,x:L,y:R};for(let N=0;N<w.length;N++){const H=w.feature(N);if(B.needGeometry){const Y=o.a8(H,!0);if(!B.filter(new o.a9(this.tileID.overscaledZ),Y,this.tileID.canonical))continue}else if(!B.filter(new o.a9(this.tileID.overscaledZ),H))continue;const K=_.getId(H,g),et=new o.aa(H,I,L,R,K);et.tile=O,c.push(et)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(c){const f=this.expirationTime;if(c.cacheControl){const _=o.ab(c.cacheControl);_["max-age"]&&(this.expirationTime=Date.now()+1e3*_["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){const _=Date.now();let A=!1;if(this.expirationTime>_)A=!1;else if(f)if(this.expirationTime<f)A=!0;else{const g=this.expirationTime-f;g?this.expirationTime=_+Math.max(g,3e4):A=!0}else A=!0;A?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(c,f){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(c).length===0)return;const _=this.latestFeatureIndex.loadVTLayers();for(const A in this.buckets){if(!f.style.hasLayer(A))continue;const g=this.buckets[A],w=g.layers[0].sourceLayer||"_geojsonTileLayer",B=_[w],I=c[w];if(!B||!I||Object.keys(I).length===0)continue;g.update(I,B,this.imageAtlas&&this.imageAtlas.patternPositions||{});const L=f&&f.style&&f.style.getLayer(A);L&&(this.queryPadding=Math.max(this.queryPadding,L.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<b.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(c){this.symbolFadeHoldUntil=b.now()+c}setDependencies(c,f){const _={};for(const A of f)_[A]=!0;this.dependencies[c]=_}hasDependency(c,f){for(const _ of c){const A=this.dependencies[_];if(A){for(const g of f)if(A[g])return!0}}return!1}}class me{constructor(c,f){this.max=c,this.onRemove=f,this.reset()}reset(){for(const c in this.data)for(const f of this.data[c])f.timeout&&clearTimeout(f.timeout),this.onRemove(f.value);return this.data={},this.order=[],this}add(c,f,_){const A=c.wrapped().key;this.data[A]===void 0&&(this.data[A]=[]);const g={value:f,timeout:void 0};if(_!==void 0&&(g.timeout=setTimeout(()=>{this.remove(c,g)},_)),this.data[A].push(g),this.order.push(A),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(c){return c.wrapped().key in this.data}getAndRemove(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null}_getAndRemoveByKey(c){const f=this.data[c].shift();return f.timeout&&clearTimeout(f.timeout),this.data[c].length===0&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),f.value}getByKey(c){const f=this.data[c];return f?f[0].value:null}get(c){return this.has(c)?this.data[c.wrapped().key][0].value:null}remove(c,f){if(!this.has(c))return this;const _=c.wrapped().key,A=f===void 0?0:this.data[_].indexOf(f),g=this.data[_][A];return this.data[_].splice(A,1),g.timeout&&clearTimeout(g.timeout),this.data[_].length===0&&delete this.data[_],this.onRemove(g.value),this.order.splice(this.order.indexOf(_),1),this}setMaxSize(c){for(this.max=c;this.order.length>this.max;){const f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this}filter(c){const f=[];for(const _ in this.data)for(const A of this.data[_])c(A.value)||f.push(A);for(const _ of f)this.remove(_.value.tileID,_)}}class gr{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(c,f,_){const A=String(f);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][A]=this.stateChanges[c][A]||{},o.e(this.stateChanges[c][A],_),this.deletedStates[c]===null){this.deletedStates[c]={};for(const g in this.state[c])g!==A&&(this.deletedStates[c][g]=null)}else if(this.deletedStates[c]&&this.deletedStates[c][A]===null){this.deletedStates[c][A]={};for(const g in this.state[c][A])_[g]||(this.deletedStates[c][A][g]=null)}else for(const g in _)this.deletedStates[c]&&this.deletedStates[c][A]&&this.deletedStates[c][A][g]===null&&delete this.deletedStates[c][A][g]}removeFeatureState(c,f,_){if(this.deletedStates[c]===null)return;const A=String(f);if(this.deletedStates[c]=this.deletedStates[c]||{},_&&f!==void 0)this.deletedStates[c][A]!==null&&(this.deletedStates[c][A]=this.deletedStates[c][A]||{},this.deletedStates[c][A][_]=null);else if(f!==void 0)if(this.stateChanges[c]&&this.stateChanges[c][A])for(_ in this.deletedStates[c][A]={},this.stateChanges[c][A])this.deletedStates[c][A][_]=null;else this.deletedStates[c][A]=null;else this.deletedStates[c]=null}getState(c,f){const _=String(f),A=o.e({},(this.state[c]||{})[_],(this.stateChanges[c]||{})[_]);if(this.deletedStates[c]===null)return{};if(this.deletedStates[c]){const g=this.deletedStates[c][f];if(g===null)return{};for(const w in g)delete A[w]}return A}initializeTileState(c,f){c.setFeatureState(this.state,f)}coalesceChanges(c,f){const _={};for(const A in this.stateChanges){this.state[A]=this.state[A]||{};const g={};for(const w in this.stateChanges[A])this.state[A][w]||(this.state[A][w]={}),o.e(this.state[A][w],this.stateChanges[A][w]),g[w]=this.state[A][w];_[A]=g}for(const A in this.deletedStates){this.state[A]=this.state[A]||{};const g={};if(this.deletedStates[A]===null)for(const w in this.state[A])g[w]={},this.state[A][w]={};else for(const w in this.deletedStates[A]){if(this.deletedStates[A][w]===null)this.state[A][w]={};else for(const B of Object.keys(this.deletedStates[A][w]))delete this.state[A][w][B];g[w]=this.state[A][w]}_[A]=_[A]||{},o.e(_[A],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(_).length!==0)for(const A in c)c[A].setFeatureState(_,f)}}class Ne extends o.E{constructor(c,f,_){super(),this.id=c,this.dispatcher=_,this.on("data",A=>this._dataHandler(A)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((A,g,w,B)=>{const I=new(Dr(g.type))(A,g,w,B);if(I.id!==A)throw new Error(`Expected Source id to be ${A} instead of ${I.id}`);return I})(c,f,_,this),this._tiles={},this._cache=new me(0,A=>this._unloadTile(A)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new gr,this._didEmitContent=!1,this._updated=!1}onAdd(c){this.map=c,this._maxTileCacheSize=c?c._maxTileCacheSize:null,this._maxTileCacheZoomLevels=c?c._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(c)}onRemove(c){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(c)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const c in this._tiles){const f=this._tiles[c];if(f.state!=="loaded"&&f.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const c=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,c&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(c,f,_){return o._(this,void 0,void 0,function*(){try{yield this._source.loadTile(c),this._tileLoaded(c,f,_)}catch(A){c.state="errored",A.status!==404?this._source.fire(new o.j(A,{tile:c})):this.update(this.transform,this.terrain)}})}_unloadTile(c){this._source.unloadTile&&this._source.unloadTile(c)}_abortTile(c){this._source.abortTile&&this._source.abortTile(c),this._source.fire(new o.k("dataabort",{tile:c,coord:c.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(c){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const f in this._tiles){const _=this._tiles[f];_.upload(c),_.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(c=>c.tileID).sort(Ur).map(c=>c.key)}getRenderableIds(c){const f=[];for(const _ in this._tiles)this._isIdRenderable(_,c)&&f.push(this._tiles[_]);return c?f.sort((_,A)=>{const g=_.tileID,w=A.tileID,B=new o.P(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),I=new o.P(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-w.overscaledZ||I.y-B.y||I.x-B.x}).map(_=>_.tileID.key):f.map(_=>_.tileID).sort(Ur).map(_=>_.key)}hasRenderableParent(c){const f=this.findLoadedParent(c,0);return!!f&&this._isIdRenderable(f.tileID.key)}_isIdRenderable(c,f){return this._tiles[c]&&this._tiles[c].hasData()&&!this._coveredTiles[c]&&(f||!this._tiles[c].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const c in this._tiles)this._tiles[c].state!=="errored"&&this._reloadTile(c,"reloading")}}_reloadTile(c,f){return o._(this,void 0,void 0,function*(){const _=this._tiles[c];_&&(_.state!=="loading"&&(_.state=f),yield this._loadTile(_,c,f))})}_tileLoaded(c,f,_){c.timeAdded=b.now(),_==="expired"&&(c.refreshedUponExpiration=!0),this._setTileReloadTimer(f,c),this.getSource().type==="raster-dem"&&c.dem&&this._backfillDEM(c),this._state.initializeTileState(c,this.map?this.map.painter:null),c.aborted||this._source.fire(new o.k("data",{dataType:"source",tile:c,coord:c.tileID}))}_backfillDEM(c){const f=this.getRenderableIds();for(let A=0;A<f.length;A++){const g=f[A];if(c.neighboringTiles&&c.neighboringTiles[g]){const w=this.getTileByID(g);_(c,w),_(w,c)}}function _(A,g){A.needsHillshadePrepare=!0,A.needsTerrainPrepare=!0;let w=g.tileID.canonical.x-A.tileID.canonical.x;const B=g.tileID.canonical.y-A.tileID.canonical.y,I=Math.pow(2,A.tileID.canonical.z),L=g.tileID.key;w===0&&B===0||Math.abs(B)>1||(Math.abs(w)>1&&(Math.abs(w+I)===1?w+=I:Math.abs(w-I)===1&&(w-=I)),g.dem&&A.dem&&(A.dem.backfillBorder(g.dem,w,B),A.neighboringTiles&&A.neighboringTiles[L]&&(A.neighboringTiles[L].backfilled=!0)))}}getTile(c){return this.getTileByID(c.key)}getTileByID(c){return this._tiles[c]}_retainLoadedChildren(c,f,_,A){for(const g in this._tiles){let w=this._tiles[g];if(A[g]||!w.hasData()||w.tileID.overscaledZ<=f||w.tileID.overscaledZ>_)continue;let B=w.tileID;for(;w&&w.tileID.overscaledZ>f+1;){const L=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[L.key],w&&w.hasData()&&(B=L)}let I=B;for(;I.overscaledZ>f;)if(I=I.scaledTo(I.overscaledZ-1),c[I.key]){A[B.key]=B;break}}}findLoadedParent(c,f){if(c.key in this._loadedParentTiles){const _=this._loadedParentTiles[c.key];return _&&_.tileID.overscaledZ>=f?_:null}for(let _=c.overscaledZ-1;_>=f;_--){const A=c.scaledTo(_),g=this._getLoadedTile(A);if(g)return g}}findLoadedSibling(c){return this._getLoadedTile(c)}_getLoadedTile(c){const f=this._tiles[c.key];return f&&f.hasData()?f:this._cache.getByKey(c.wrapped().key)}updateCacheSize(c){const f=Math.ceil(c.width/this._source.tileSize)+1,_=Math.ceil(c.height/this._source.tileSize)+1,A=Math.floor(f*_*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,A):A;this._cache.setMaxSize(g)}handleWrapJump(c){const f=Math.round((c-(this._prevLng===void 0?c:this._prevLng))/360);if(this._prevLng=c,f){const _={};for(const A in this._tiles){const g=this._tiles[A];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+f),_[g.tileID.key]=g}this._tiles=_;for(const A in this._timers)clearTimeout(this._timers[A]),delete this._timers[A];for(const A in this._tiles)this._setTileReloadTimer(A,this._tiles[A])}}_updateCoveredAndRetainedTiles(c,f,_,A,g,w){const B={},I={},L=Object.keys(c),R=b.now();for(const O of L){const N=c[O],H=this._tiles[O];if(!H||H.fadeEndTime!==0&&H.fadeEndTime<=R)continue;const K=this.findLoadedParent(N,f),et=this.findLoadedSibling(N),Y=K||et||null;Y&&(this._addTile(Y.tileID),B[Y.tileID.key]=Y.tileID),I[O]=N}this._retainLoadedChildren(I,A,_,c);for(const O in B)c[O]||(this._coveredTiles[O]=!0,c[O]=B[O]);if(w){const O={},N={};for(const H of g)this._tiles[H.key].hasData()?O[H.key]=H:N[H.key]=H;for(const H in N){const K=N[H].children(this._source.maxzoom);this._tiles[K[0].key]&&this._tiles[K[1].key]&&this._tiles[K[2].key]&&this._tiles[K[3].key]&&(O[K[0].key]=c[K[0].key]=K[0],O[K[1].key]=c[K[1].key]=K[1],O[K[2].key]=c[K[2].key]=K[2],O[K[3].key]=c[K[3].key]=K[3],delete N[H])}for(const H in N){const K=N[H],et=this.findLoadedParent(K,this._source.minzoom),Y=this.findLoadedSibling(K),Z=et||Y||null;if(Z){O[Z.tileID.key]=c[Z.tileID.key]=Z.tileID;for(const yt in O)O[yt].isChildOf(Z.tileID)&&delete O[yt]}}for(const H in this._tiles)O[H]||(this._coveredTiles[H]=!0)}}update(c,f){if(!this._sourceLoaded||this._paused)return;let _;this.transform=c,this.terrain=f,this.updateCacheSize(c),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?_=c.getVisibleUnwrappedCoordinates(this._source.tileID).map(R=>new o.S(R.canonical.z,R.wrap,R.canonical.z,R.canonical.x,R.canonical.y)):(_=c.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:f}),this._source.hasTile&&(_=_.filter(R=>this._source.hasTile(R)))):_=[];const A=c.coveringZoomLevel(this._source),g=Math.max(A-Ne.maxOverzooming,this._source.minzoom),w=Math.max(A+Ne.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const R={};for(const O of _)if(O.canonical.z>this._source.minzoom){const N=O.scaledTo(O.canonical.z-1);R[N.key]=N;const H=O.scaledTo(Math.max(this._source.minzoom,Math.min(O.canonical.z,5)));R[H.key]=H}_=_.concat(Object.values(R))}const B=_.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,B&&this.fire(new o.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const I=this._updateRetainedTiles(_,A);_n(this._source.type)&&this._updateCoveredAndRetainedTiles(I,g,w,A,_,f);for(const R in I)this._tiles[R].clearFadeHold();const L=o.ac(this._tiles,I);for(const R of L){const O=this._tiles[R];O.hasSymbolBuckets&&!O.holdingForFade()?O.setHoldDuration(this.map._fadeDuration):O.hasSymbolBuckets&&!O.symbolFadeFinished()||this._removeTile(R)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const c in this._tiles)this._tiles[c].holdingForFade()&&this._removeTile(c)}_updateRetainedTiles(c,f){var _;const A={},g={},w=Math.max(f-Ne.maxOverzooming,this._source.minzoom),B=Math.max(f+Ne.maxUnderzooming,this._source.minzoom),I={};for(const L of c){const R=this._addTile(L);A[L.key]=L,R.hasData()||f<this._source.maxzoom&&(I[L.key]=L)}this._retainLoadedChildren(I,f,B,A);for(const L of c){let R=this._tiles[L.key];if(R.hasData())continue;if(f+1>this._source.maxzoom){const N=L.children(this._source.maxzoom)[0],H=this.getTile(N);if(H&&H.hasData()){A[N.key]=N;continue}}else{const N=L.children(this._source.maxzoom);if(A[N[0].key]&&A[N[1].key]&&A[N[2].key]&&A[N[3].key])continue}let O=R.wasRequested();for(let N=L.overscaledZ-1;N>=w;--N){const H=L.scaledTo(N);if(g[H.key])break;if(g[H.key]=!0,R=this.getTile(H),!R&&O&&(R=this._addTile(H)),R){const K=R.hasData();if((K||!(!((_=this.map)===null||_===void 0)&&_.cancelPendingTileRequestsWhileZooming)||O)&&(A[H.key]=H),O=R.wasRequested(),K)break}}}return A}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const c in this._tiles){const f=[];let _,A=this._tiles[c].tileID;for(;A.overscaledZ>0;){if(A.key in this._loadedParentTiles){_=this._loadedParentTiles[A.key];break}f.push(A.key);const g=A.scaledTo(A.overscaledZ-1);if(_=this._getLoadedTile(g),_)break;A=g}for(const g of f)this._loadedParentTiles[g]=_}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const c in this._tiles){const f=this._tiles[c].tileID,_=this._getLoadedTile(f);this._loadedSiblingTiles[f.key]=_}}_addTile(c){let f=this._tiles[c.key];if(f)return f;f=this._cache.getAndRemove(c),f&&(this._setTileReloadTimer(c.key,f),f.tileID=c,this._state.initializeTileState(f,this.map?this.map.painter:null),this._cacheTimers[c.key]&&(clearTimeout(this._cacheTimers[c.key]),delete this._cacheTimers[c.key],this._setTileReloadTimer(c.key,f)));const _=f;return f||(f=new An(c,this._source.tileSize*c.overscaleFactor()),this._loadTile(f,c.key,f.state)),f.uses++,this._tiles[c.key]=f,_||this._source.fire(new o.k("dataloading",{tile:f,coord:f.tileID,dataType:"source"})),f}_setTileReloadTimer(c,f){c in this._timers&&(clearTimeout(this._timers[c]),delete this._timers[c]);const _=f.getExpiryTimeout();_&&(this._timers[c]=setTimeout(()=>{this._reloadTile(c,"expired"),delete this._timers[c]},_))}_removeTile(c){const f=this._tiles[c];f&&(f.uses--,delete this._tiles[c],this._timers[c]&&(clearTimeout(this._timers[c]),delete this._timers[c]),f.uses>0||(f.hasData()&&f.state!=="reloading"?this._cache.add(f.tileID,f,f.getExpiryTimeout()):(f.aborted=!0,this._abortTile(f),this._unloadTile(f))))}_dataHandler(c){const f=c.sourceDataType;c.dataType==="source"&&f==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&c.dataType==="source"&&f==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const c in this._tiles)this._removeTile(c);this._cache.reset()}tilesIn(c,f,_){const A=[],g=this.transform;if(!g)return A;const w=_?g.getCameraQueryGeometry(c):c,B=c.map(K=>g.pointCoordinate(K,this.terrain)),I=w.map(K=>g.pointCoordinate(K,this.terrain)),L=this.getIds();let R=1/0,O=1/0,N=-1/0,H=-1/0;for(const K of I)R=Math.min(R,K.x),O=Math.min(O,K.y),N=Math.max(N,K.x),H=Math.max(H,K.y);for(let K=0;K<L.length;K++){const et=this._tiles[L[K]];if(et.holdingForFade())continue;const Y=et.tileID,Z=Math.pow(2,g.zoom-et.tileID.overscaledZ),yt=f*et.queryPadding*o.X/et.tileSize/Z,at=[Y.getTilePoint(new o.Z(R,O)),Y.getTilePoint(new o.Z(N,H))];if(at[0].x-yt<o.X&&at[0].y-yt<o.X&&at[1].x+yt>=0&&at[1].y+yt>=0){const lt=B.map(Et=>Y.getTilePoint(Et)),At=I.map(Et=>Y.getTilePoint(Et));A.push({tile:et,tileID:Y,queryGeometry:lt,cameraQueryGeometry:At,scale:Z})}}return A}getVisibleCoordinates(c){const f=this.getRenderableIds(c).map(_=>this._tiles[_].tileID);for(const _ of f)_.posMatrix=this.transform.calculatePosMatrix(_.toUnwrapped());return f}hasTransition(){if(this._source.hasTransition())return!0;if(_n(this._source.type)){const c=b.now();for(const f in this._tiles)if(this._tiles[f].fadeEndTime>=c)return!0}return!1}setFeatureState(c,f,_){this._state.updateState(c=c||"_geojsonTileLayer",f,_)}removeFeatureState(c,f,_){this._state.removeFeatureState(c=c||"_geojsonTileLayer",f,_)}getFeatureState(c,f){return this._state.getState(c=c||"_geojsonTileLayer",f)}setDependencies(c,f,_){const A=this._tiles[c];A&&A.setDependencies(f,_)}reloadTilesForDependencies(c,f){for(const _ in this._tiles)this._tiles[_].hasDependency(c,f)&&this._reloadTile(_,"reloading");this._cache.filter(_=>!_.hasDependency(c,f))}}function Ur(S,c){const f=Math.abs(2*S.wrap)-+(S.wrap<0),_=Math.abs(2*c.wrap)-+(c.wrap<0);return S.overscaledZ-c.overscaledZ||_-f||c.canonical.y-S.canonical.y||c.canonical.x-S.canonical.x}function _n(S){return S==="raster"||S==="image"||S==="video"}Ne.maxOverzooming=10,Ne.maxUnderzooming=3;class ke{constructor(c,f){this.reset(c,f)}reset(c,f){this.points=c||[],this._distances=[0];for(let _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(this.points.length===1)return this.points[0];c=o.ad(c,0,1);let f=1,_=this._distances[f];const A=c*this.paddedLength+this.padding;for(;_<A&&f<this._distances.length;)_=this._distances[++f];const g=f-1,w=this._distances[g],B=_-w,I=B>0?(A-w)/B:0;return this.points[g].mult(1-I).add(this.points[f].mult(I))}}function Qn(S,c){let f=!0;return S==="always"||S!=="never"&&c!=="never"||(f=!1),f}class nn{constructor(c,f,_){const A=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(c/_),this.yCellCount=Math.ceil(f/_);for(let w=0;w<this.xCellCount*this.yCellCount;w++)A.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=f,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,f,_,A,g){this._forEachCell(f,_,A,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(f),this.bboxes.push(_),this.bboxes.push(A),this.bboxes.push(g)}insertCircle(c,f,_,A){this._forEachCell(f-A,_-A,f+A,_+A,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(f),this.circles.push(_),this.circles.push(A)}_insertBoxCell(c,f,_,A,g,w){this.boxCells[g].push(w)}_insertCircleCell(c,f,_,A,g,w){this.circleCells[g].push(w)}_query(c,f,_,A,g,w,B){if(_<0||c>this.width||A<0||f>this.height)return[];const I=[];if(c<=0&&f<=0&&this.width<=_&&this.height<=A){if(g)return[{key:null,x1:c,y1:f,x2:_,y2:A}];for(let L=0;L<this.boxKeys.length;L++)I.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(let L=0;L<this.circleKeys.length;L++){const R=this.circles[3*L],O=this.circles[3*L+1],N=this.circles[3*L+2];I.push({key:this.circleKeys[L],x1:R-N,y1:O-N,x2:R+N,y2:O+N})}}else this._forEachCell(c,f,_,A,this._queryCell,I,{hitTest:g,overlapMode:w,seenUids:{box:{},circle:{}}},B);return I}query(c,f,_,A){return this._query(c,f,_,A,!1,null)}hitTest(c,f,_,A,g,w){return this._query(c,f,_,A,!0,g,w).length>0}hitTestCircle(c,f,_,A,g){const w=c-_,B=c+_,I=f-_,L=f+_;if(B<0||w>this.width||L<0||I>this.height)return!1;const R=[];return this._forEachCell(w,I,B,L,this._queryCellCircle,R,{hitTest:!0,overlapMode:A,circle:{x:c,y:f,radius:_},seenUids:{box:{},circle:{}}},g),R.length>0}_queryCell(c,f,_,A,g,w,B,I){const{seenUids:L,hitTest:R,overlapMode:O}=B,N=this.boxCells[g];if(N!==null){const K=this.bboxes;for(const et of N)if(!L.box[et]){L.box[et]=!0;const Y=4*et,Z=this.boxKeys[et];if(c<=K[Y+2]&&f<=K[Y+3]&&_>=K[Y+0]&&A>=K[Y+1]&&(!I||I(Z))&&(!R||!Qn(O,Z.overlapMode))&&(w.push({key:Z,x1:K[Y],y1:K[Y+1],x2:K[Y+2],y2:K[Y+3]}),R))return!0}}const H=this.circleCells[g];if(H!==null){const K=this.circles;for(const et of H)if(!L.circle[et]){L.circle[et]=!0;const Y=3*et,Z=this.circleKeys[et];if(this._circleAndRectCollide(K[Y],K[Y+1],K[Y+2],c,f,_,A)&&(!I||I(Z))&&(!R||!Qn(O,Z.overlapMode))){const yt=K[Y],at=K[Y+1],lt=K[Y+2];if(w.push({key:Z,x1:yt-lt,y1:at-lt,x2:yt+lt,y2:at+lt}),R)return!0}}}return!1}_queryCellCircle(c,f,_,A,g,w,B,I){const{circle:L,seenUids:R,overlapMode:O}=B,N=this.boxCells[g];if(N!==null){const K=this.bboxes;for(const et of N)if(!R.box[et]){R.box[et]=!0;const Y=4*et,Z=this.boxKeys[et];if(this._circleAndRectCollide(L.x,L.y,L.radius,K[Y+0],K[Y+1],K[Y+2],K[Y+3])&&(!I||I(Z))&&!Qn(O,Z.overlapMode))return w.push(!0),!0}}const H=this.circleCells[g];if(H!==null){const K=this.circles;for(const et of H)if(!R.circle[et]){R.circle[et]=!0;const Y=3*et,Z=this.circleKeys[et];if(this._circlesCollide(K[Y],K[Y+1],K[Y+2],L.x,L.y,L.radius)&&(!I||I(Z))&&!Qn(O,Z.overlapMode))return w.push(!0),!0}}}_forEachCell(c,f,_,A,g,w,B,I){const L=this._convertToXCellCoord(c),R=this._convertToYCellCoord(f),O=this._convertToXCellCoord(_),N=this._convertToYCellCoord(A);for(let H=L;H<=O;H++)for(let K=R;K<=N;K++)if(g.call(this,c,f,_,A,this.xCellCount*K+H,w,B,I))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,f,_,A,g,w){const B=A-c,I=g-f,L=_+w;return L*L>B*B+I*I}_circleAndRectCollide(c,f,_,A,g,w,B){const I=(w-A)/2,L=Math.abs(c-(A+I));if(L>I+_)return!1;const R=(B-g)/2,O=Math.abs(f-(g+R));if(O>R+_)return!1;if(L<=I||O<=R)return!0;const N=L-I,H=O-R;return N*N+H*H<=_*_}}function vn(S,c,f,_,A){const g=o.H();return c?(o.K(g,g,[1/A,1/A,1]),f||o.ae(g,g,_.angle)):o.L(g,_.labelPlaneMatrix,S),g}function ln(S,c,f,_,A){if(c){const g=o.af(S);return o.K(g,g,[A,A,1]),f||o.ae(g,g,-_.angle),g}return _.glCoordMatrix}function Ct(S,c,f){let _;f?(_=[S.x,S.y,f(S.x,S.y),1],o.ag(_,_,c)):(_=[S.x,S.y,0,1],function(g,w,B){const I=w[0],L=w[1];g[0]=B[0]*I+B[4]*L+B[12],g[1]=B[1]*I+B[5]*L+B[13],g[3]=B[3]*I+B[7]*L+B[15]}(_,_,c));const A=_[3];return{point:new o.P(_[0]/A,_[1]/A),signedDistanceFromCamera:A,isOccluded:!1}}function W(S,c){return .5+S/c*.5}function X(S,c){return S.x>=-c[0]&&S.x<=c[0]&&S.y>=-c[1]&&S.y<=c[1]}function ft(S,c,f,_,A,g,w,B,I,L,R,O,N,H,K){const et=_?S.textSizeData:S.iconSizeData,Y=o.ah(et,f.transform.zoom),Z=[256/f.width*2+1,256/f.height*2+1],yt=_?S.text.dynamicLayoutVertexArray:S.icon.dynamicLayoutVertexArray;yt.clear();const at=S.lineVertexArray,lt=_?S.text.placedSymbolArray:S.icon.placedSymbolArray,At=f.transform.width/f.transform.height;let Et=!1;for(let Dt=0;Dt<lt.length;Dt++){const zt=lt.get(Dt);if(zt.hidden||zt.writingMode===o.ai.vertical&&!Et){nr(zt.numGlyphs,yt);continue}Et=!1;const ue=Ct(new o.P(zt.anchorX,zt.anchorY),c,K);if(!X(ue.point,Z)){nr(zt.numGlyphs,yt);continue}const oe=W(f.transform.cameraToCenterDistance,ue.signedDistanceFromCamera),ce=o.aj(et,Y,zt),ie=w?ce/oe:ce*oe,Pe={getElevation:K,labelPlaneMatrix:A,lineVertexArray:at,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:L,tileAnchorPoint:new o.P(zt.anchorX,zt.anchorY),unwrappedTileID:R,width:O,height:N,translation:H},We=Gt(Pe,zt,ie,!1,B,c,g,S.glyphOffsetArray,yt,At,I);Et=We.useVertical,(We.notEnoughRoom||Et||We.needsFlipping&&Gt(Pe,zt,ie,!0,B,c,g,S.glyphOffsetArray,yt,At,I).notEnoughRoom)&&nr(zt.numGlyphs,yt)}_?S.text.dynamicLayoutVertexBuffer.updateData(yt):S.icon.dynamicLayoutVertexBuffer.updateData(yt)}function Bt(S,c,f,_,A,g,w,B){const I=g.glyphStartIndex+g.numGlyphs,L=g.lineStartIndex,R=g.lineStartIndex+g.lineLength,O=c.getoffsetX(g.glyphStartIndex),N=c.getoffsetX(I-1),H=xe(S*O,f,_,A,g.segment,L,R,B,w);if(!H)return null;const K=xe(S*N,f,_,A,g.segment,L,R,B,w);return K?B.projectionCache.anyProjectionOccluded?null:{first:H,last:K}:null}function kt(S,c,f,_){return S===o.ai.horizontal&&Math.abs(f.y-c.y)>Math.abs(f.x-c.x)*_?{useVertical:!0}:(S===o.ai.vertical?c.y<f.y:c.x>f.x)?{needsFlipping:!0}:null}function Gt(S,c,f,_,A,g,w,B,I,L,R){const O=f/24,N=c.lineOffsetX*O,H=c.lineOffsetY*O;let K;if(c.numGlyphs>1){const et=c.glyphStartIndex+c.numGlyphs,Y=c.lineStartIndex,Z=c.lineStartIndex+c.lineLength,yt=Bt(O,B,N,H,_,c,R,S);if(!yt)return{notEnoughRoom:!0};const at=Ct(yt.first.point,w,S.getElevation).point,lt=Ct(yt.last.point,w,S.getElevation).point;if(A&&!_){const At=kt(c.writingMode,at,lt,L);if(At)return At}K=[yt.first];for(let At=c.glyphStartIndex+1;At<et-1;At++)K.push(xe(O*B.getoffsetX(At),N,H,_,c.segment,Y,Z,S,R));K.push(yt.last)}else{if(A&&!_){const Y=Ct(S.tileAnchorPoint,g,S.getElevation).point,Z=c.lineStartIndex+c.segment+1,yt=new o.P(S.lineVertexArray.getx(Z),S.lineVertexArray.gety(Z)),at=Ct(yt,g,S.getElevation),lt=at.signedDistanceFromCamera>0?at.point:function(Et,Dt,zt,ue,oe,ce){return Ot(Et,Dt,zt,1,oe,ce)}(S.tileAnchorPoint,yt,Y,0,g,S),At=kt(c.writingMode,Y,lt,L);if(At)return At}const et=xe(O*B.getoffsetX(c.glyphStartIndex),N,H,_,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,S,R);if(!et||S.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};K=[et]}for(const et of K)o.ak(I,et.point,et.angle);return{}}function Ot(S,c,f,_,A,g){const w=S.add(S.sub(c)._unit()),B=A!==void 0?Ct(w,A,g.getElevation).point:ae(w.x,w.y,g).point,I=f.sub(B);return f.add(I._mult(_/I.mag()))}function Pt(S,c,f){const _=c.projectionCache;if(_.projections[S])return _.projections[S];const A=new o.P(c.lineVertexArray.getx(S),c.lineVertexArray.gety(S)),g=ae(A.x,A.y,c);if(g.signedDistanceFromCamera>0)return _.projections[S]=g.point,_.anyProjectionOccluded=_.anyProjectionOccluded||g.isOccluded,g.point;const w=S-f.direction;return function(B,I,L,R,O){return Ot(B,I,L,R,void 0,O)}(f.distanceFromAnchor===0?c.tileAnchorPoint:new o.P(c.lineVertexArray.getx(w),c.lineVertexArray.gety(w)),A,f.previousVertex,f.absOffsetX-f.distanceFromAnchor+1,c)}function ae(S,c,f){const _=S+f.translation[0],A=c+f.translation[1];let g;return!f.pitchWithMap&&f.projection.useSpecialProjectionForSymbols?(g=f.projection.projectTileCoordinates(_,A,f.unwrappedTileID,f.getElevation),g.point.x=(.5*g.point.x+.5)*f.width,g.point.y=(.5*-g.point.y+.5)*f.height):(g=Ct(new o.P(_,A),f.labelPlaneMatrix,f.getElevation),g.isOccluded=!1),g}function fe(S,c,f){return S._unit()._perp()._mult(c*f)}function Jt(S,c,f,_,A,g,w,B,I){if(B.projectionCache.offsets[S])return B.projectionCache.offsets[S];const L=f.add(c);if(S+I.direction<_||S+I.direction>=A)return B.projectionCache.offsets[S]=L,L;const R=Pt(S+I.direction,B,I),O=fe(R.sub(f),w,I.direction),N=f.add(O),H=R.add(O);return B.projectionCache.offsets[S]=o.al(g,L,N,H)||L,B.projectionCache.offsets[S]}function xe(S,c,f,_,A,g,w,B,I){const L=_?S-c:S+c;let R=L>0?1:-1,O=0;_&&(R*=-1,O=Math.PI),R<0&&(O+=Math.PI);let N,H=R>0?g+A:g+A+1;B.projectionCache.cachedAnchorPoint?N=B.projectionCache.cachedAnchorPoint:(N=ae(B.tileAnchorPoint.x,B.tileAnchorPoint.y,B).point,B.projectionCache.cachedAnchorPoint=N);let K,et,Y=N,Z=N,yt=0,at=0;const lt=Math.abs(L),At=[];let Et;for(;yt+at<=lt;){if(H+=R,H<g||H>=w)return null;yt+=at,Z=Y,et=K;const ue={absOffsetX:lt,direction:R,distanceFromAnchor:yt,previousVertex:Z};if(Y=Pt(H,B,ue),f===0)At.push(Z),Et=Y.sub(Z);else{let oe;const ce=Y.sub(Z);oe=ce.mag()===0?fe(Pt(H+R,B,ue).sub(Y),f,R):fe(ce,f,R),et||(et=Z.add(oe)),K=Jt(H,oe,Y,g,w,et,f,B,ue),At.push(et),Et=K.sub(et)}at=Et.mag()}const Dt=Et._mult((lt-yt)/at)._add(et||Z),zt=O+Math.atan2(Y.y-Z.y,Y.x-Z.x);return At.push(Dt),{point:Dt,angle:I?zt:0,path:At}}const Ge=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function nr(S,c){for(let f=0;f<S;f++){const _=c.length;c.resize(_+4),c.float32.set(Ge,3*_)}}const Br=100;class Tr{constructor(c,f){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new nn(c.width+200,c.height+200,25),A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new nn(c.width+200,c.height+200,25);this.transform=c,this.mapProjection=f,this.grid=_,this.ignoredGrid=A,this.pitchFactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+Br,this.screenBottomBoundary=c.height+Br,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(c,f,_,A,g,w,B,I,L,R,O){const N=c.anchorPointX+I[0],H=c.anchorPointY+I[1],K=this.projectAndGetPerspectiveRatio(A,N,H,g,R),et=this._projectCollisionBox(c,_,A,g,w,B,I,K,R,O),[Y,Z,yt,at]=et.box;return this.mapProjection.useSpecialProjectionForSymbols&&(w?et.allPointsOccluded:this.mapProjection.isOccluded(N,H,g))||K.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(Y,Z,yt,at)||f!=="always"&&this.grid.hitTest(Y,Z,yt,at,f,L)?{box:[Y,Z,yt,at],placeable:!1,offscreen:!1}:{box:[Y,Z,yt,at],placeable:!0,offscreen:this.isOffscreen(Y,Z,yt,at)}}placeCollisionCircles(c,f,_,A,g,w,B,I,L,R,O,N,H,K,et,Y){const Z=[],yt=new o.P(f.anchorX,f.anchorY),at=this.getPerspectiveRatio(w,yt.x,yt.y,B,Y),lt=(O?g/at:g*at)/o.aq,At={getElevation:Y,labelPlaneMatrix:I,lineVertexArray:_,pitchWithMap:O,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:yt,unwrappedTileID:B,width:this.transform.width,height:this.transform.height,translation:et},Et=Bt(lt,A,f.lineOffsetX*lt,f.lineOffsetY*lt,!1,f,!1,At);let Dt=!1,zt=!1,ue=!0;if(Et){const oe=.5*H*at+K,ce=new o.P(-100,-100),ie=new o.P(this.screenRightBoundary,this.screenBottomBoundary),Pe=new ke,We=Et.first,_e=Et.last;let be=[];for(let He=We.path.length-1;He>=1;He--)be.push(We.path[He]);for(let He=1;He<_e.path.length;He++)be.push(_e.path[He]);const Xe=2.5*oe;if(L){const He=this.projectPathToScreenSpace(be,At,L);be=He.some(Sr=>Sr.signedDistanceFromCamera<=0)?[]:He.map(Sr=>Sr.point)}let Rr=[];if(be.length>0){const He=be[0].clone(),Sr=be[0].clone();for(let an=1;an<be.length;an++)He.x=Math.min(He.x,be[an].x),He.y=Math.min(He.y,be[an].y),Sr.x=Math.max(Sr.x,be[an].x),Sr.y=Math.max(Sr.y,be[an].y);Rr=He.x>=ce.x&&Sr.x<=ie.x&&He.y>=ce.y&&Sr.y<=ie.y?[be]:Sr.x<ce.x||He.x>ie.x||Sr.y<ce.y||He.y>ie.y?[]:o.am([be],ce.x,ce.y,ie.x,ie.y)}for(const He of Rr){Pe.reset(He,.25*oe);let Sr=0;Sr=Pe.length<=.5*oe?1:Math.ceil(Pe.paddedLength/Xe)+1;for(let an=0;an<Sr;an++){const pn=an/Math.max(Sr-1,1),oi=Pe.lerp(pn),Mr=oi.x+Br,Xn=oi.y+Br;Z.push(Mr,Xn,oe,0);const Vn=Mr-oe,bn=Xn-oe,xn=Mr+oe,ei=Xn+oe;if(ue=ue&&this.isOffscreen(Vn,bn,xn,ei),zt=zt||this.isInsideGrid(Vn,bn,xn,ei),c!=="always"&&this.grid.hitTestCircle(Mr,Xn,oe,c,N)&&(Dt=!0,!R))return{circles:[],offscreen:!1,collisionDetected:Dt}}}}return{circles:!R&&Dt||!zt||at<this.perspectiveRatioCutoff?[]:Z,offscreen:ue,collisionDetected:Dt}}projectPathToScreenSpace(c,f,_){return c.map(A=>Ct(A,_,f.getElevation))}queryRenderedSymbols(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const f=[];let _=1/0,A=1/0,g=-1/0,w=-1/0;for(const R of c){const O=new o.P(R.x+Br,R.y+Br);_=Math.min(_,O.x),A=Math.min(A,O.y),g=Math.max(g,O.x),w=Math.max(w,O.y),f.push(O)}const B=this.grid.query(_,A,g,w).concat(this.ignoredGrid.query(_,A,g,w)),I={},L={};for(const R of B){const O=R.key;if(I[O.bucketInstanceId]===void 0&&(I[O.bucketInstanceId]={}),I[O.bucketInstanceId][O.featureIndex])continue;const N=[new o.P(R.x1,R.y1),new o.P(R.x2,R.y1),new o.P(R.x2,R.y2),new o.P(R.x1,R.y2)];o.an(f,N)&&(I[O.bucketInstanceId][O.featureIndex]=!0,L[O.bucketInstanceId]===void 0&&(L[O.bucketInstanceId]=[]),L[O.bucketInstanceId].push(O.featureIndex))}return L}insertCollisionBox(c,f,_,A,g,w){(_?this.ignoredGrid:this.grid).insert({bucketInstanceId:A,featureIndex:g,collisionGroupID:w,overlapMode:f},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,f,_,A,g,w){const B=_?this.ignoredGrid:this.grid,I={bucketInstanceId:A,featureIndex:g,collisionGroupID:w,overlapMode:f};for(let L=0;L<c.length;L+=4)B.insertCircle(I,c[L],c[L+1],c[L+2])}projectAndGetPerspectiveRatio(c,f,_,A,g){const w=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(f,_,A,g):Ct(new o.P(f,_),c,g);return{point:new o.P((w.point.x+1)/2*this.transform.width+Br,(1-w.point.y)/2*this.transform.height+Br),perspectiveRatio:.5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5,isOccluded:w.isOccluded,signedDistanceFromCamera:w.signedDistanceFromCamera}}getPerspectiveRatio(c,f,_,A,g){const w=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(f,_,A,g):Ct(new o.P(f,_),c,g);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(c,f,_,A){return _<Br||c>=this.screenRightBoundary||A<Br||f>this.screenBottomBoundary}isInsideGrid(c,f,_,A){return _>=0&&c<this.gridRightBoundary&&A>=0&&f<this.gridBottomBoundary}getViewportMatrix(){const c=o.ao([]);return o.J(c,c,[-100,-100,0]),c}_projectCollisionBox(c,f,_,A,g,w,B,I,L,R){const O=f*I.perspectiveRatio;let N=new o.P(1,0),H=new o.P(0,1);const K=new o.P(c.anchorPointX+B[0],c.anchorPointY+B[1]);if(w&&!g){const oe=this.projectAndGetPerspectiveRatio(_,K.x+1,K.y,A,L).point.sub(I.point).unit(),ce=Math.atan(oe.y/oe.x)+(oe.x<0?Math.PI:0),ie=Math.sin(ce),Pe=Math.cos(ce);N=new o.P(Pe,ie),H=new o.P(-ie,Pe)}else if(!w&&g){const oe=-this.transform.angle,ce=Math.sin(oe),ie=Math.cos(oe);N=new o.P(ie,ce),H=new o.P(-ce,ie)}let et=I.point,Y=O;if(g){et=K;const oe=this.transform.zoom-Math.floor(this.transform.zoom);Y=Math.pow(2,-oe),Y*=this.mapProjection.getPitchedTextCorrection(this.transform,K,A),R||(Y*=o.ad(.5+I.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}R&&(et=et.add(N.mult(R.x*Y)).add(H.mult(R.y*Y)));const Z=c.x1*Y,yt=c.x2*Y,at=(Z+yt)/2,lt=c.y1*Y,At=c.y2*Y,Et=(lt+At)/2,Dt=[{offsetX:Z,offsetY:lt},{offsetX:at,offsetY:lt},{offsetX:yt,offsetY:lt},{offsetX:yt,offsetY:Et},{offsetX:yt,offsetY:At},{offsetX:at,offsetY:At},{offsetX:Z,offsetY:At},{offsetX:Z,offsetY:Et}];let zt=[];for(const{offsetX:oe,offsetY:ce}of Dt)zt.push(new o.P(et.x+N.x*oe+H.x*ce,et.y+N.y*oe+H.y*ce));let ue=!1;if(g){const oe=zt.map(ce=>this.projectAndGetPerspectiveRatio(_,ce.x,ce.y,A,L));ue=oe.some(ce=>!ce.isOccluded),zt=oe.map(ce=>ce.point)}else ue=!0;return{box:o.ap(zt),allPointsOccluded:!ue}}}function pr(S,c,f){return c*(o.X/(S.tileSize*Math.pow(2,f-S.tileID.overscaledZ)))}class Qr{constructor(c,f,_,A){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?f:-f))):A&&_?1:0,this.placed=_}isHidden(){return this.opacity===0&&!this.placed}}class Gr{constructor(c,f,_,A,g){this.text=new Qr(c?c.text:null,f,_,g),this.icon=new Qr(c?c.icon:null,f,A,g)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class cn{constructor(c,f,_){this.text=c,this.icon=f,this.skipFade=_}}class br{constructor(){this.invProjMatrix=o.H(),this.viewportMatrix=o.H(),this.circles=[]}}class jr{constructor(c,f,_,A,g){this.bucketInstanceId=c,this.featureIndex=f,this.sourceLayerIndex=_,this.bucketIndex=A,this.tileID=g}}class sn{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const f=++this.maxGroupID;this.collisionGroups[c]={ID:f,predicate:_=>_.collisionGroupID===f}}return this.collisionGroups[c]}}function Sn(S,c,f,_,A){const{horizontalAlign:g,verticalAlign:w}=o.av(S);return new o.P(-(g-.5)*c+_[0]*A,-(w-.5)*f+_[1]*A)}class Mt{constructor(c,f,_,A,g,w){this.transform=c.clone(),this.terrain=_,this.collisionIndex=new Tr(this.transform,f),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=A,this.retainedQueryData={},this.collisionGroups=new sn(g),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(c){const f=this.terrain;return f?(_,A)=>f.getElevation(c,_,A):null}getBucketParts(c,f,_,A){const g=_.getBucket(f),w=_.latestFeatureIndex;if(!g||!w||f.id!==g.layerIds[0])return;const B=_.collisionBoxArray,I=g.layers[0].layout,L=g.layers[0].paint,R=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),O=_.tileSize/o.X,N=_.tileID.toUnwrapped(),H=this.transform.calculatePosMatrix(N),K=I.get("text-pitch-alignment")==="map",et=I.get("text-rotation-alignment")==="map",Y=pr(_,1,this.transform.zoom),Z=this.collisionIndex.mapProjection.translatePosition(this.transform,_,L.get("text-translate"),L.get("text-translate-anchor")),yt=this.collisionIndex.mapProjection.translatePosition(this.transform,_,L.get("icon-translate"),L.get("icon-translate-anchor")),at=vn(H,K,et,this.transform,Y);let lt=null;if(K){const Et=ln(H,K,et,this.transform,Y);lt=o.L([],this.transform.labelPlaneMatrix,Et)}this.retainedQueryData[g.bucketInstanceId]=new jr(g.bucketInstanceId,w,g.sourceLayerIndex,g.index,_.tileID);const At={bucket:g,layout:I,translationText:Z,translationIcon:yt,posMatrix:H,unwrappedTileID:N,textLabelPlaneMatrix:at,labelToScreenMatrix:lt,scale:R,textPixelRatio:O,holdingForFade:_.holdingForFade(),collisionBoxArray:B,partiallyEvaluatedTextSize:o.ah(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(A)for(const Et of g.sortKeyRanges){const{sortKey:Dt,symbolInstanceStart:zt,symbolInstanceEnd:ue}=Et;c.push({sortKey:Dt,symbolInstanceStart:zt,symbolInstanceEnd:ue,parameters:At})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:At})}attemptAnchorPlacement(c,f,_,A,g,w,B,I,L,R,O,N,H,K,et,Y,Z,yt,at){const lt=o.ar[c.textAnchor],At=[c.textOffset0,c.textOffset1],Et=Sn(lt,_,A,At,g),Dt=this.collisionIndex.placeCollisionBox(f,N,I,L,R,B,w,Y,O.predicate,at,Et);if((!yt||this.collisionIndex.placeCollisionBox(yt,N,I,L,R,B,w,Z,O.predicate,at,Et).placeable)&&Dt.placeable){let zt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID].text&&(zt=this.prevPlacement.variableOffsets[H.crossTileID].anchor),H.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[H.crossTileID]={textOffset:At,width:_,height:A,anchor:lt,textBoxScale:g,prevAnchor:zt},this.markUsedJustification(K,lt,H,et),K.allowVerticalPlacement&&(this.markUsedOrientation(K,et,H),this.placedOrientations[H.crossTileID]=et),{shift:Et,placedGlyphBoxes:Dt}}}placeLayerBucketPart(c,f,_){const{bucket:A,layout:g,translationText:w,translationIcon:B,posMatrix:I,unwrappedTileID:L,textLabelPlaneMatrix:R,labelToScreenMatrix:O,textPixelRatio:N,holdingForFade:H,collisionBoxArray:K,partiallyEvaluatedTextSize:et,collisionGroup:Y}=c.parameters,Z=g.get("text-optional"),yt=g.get("icon-optional"),at=o.as(g,"text-overlap","text-allow-overlap"),lt=at==="always",At=o.as(g,"icon-overlap","icon-allow-overlap"),Et=At==="always",Dt=g.get("text-rotation-alignment")==="map",zt=g.get("text-pitch-alignment")==="map",ue=g.get("icon-text-fit")!=="none",oe=g.get("symbol-z-order")==="viewport-y",ce=lt&&(Et||!A.hasIconData()||yt),ie=Et&&(lt||!A.hasTextData()||Z);!A.collisionArrays&&K&&A.deserializeCollisionBoxes(K);const Pe=this._getTerrainElevationFunc(this.retainedQueryData[A.bucketInstanceId].tileID),We=(_e,be,Xe)=>{var Rr,He;if(f[_e.crossTileID])return;if(H)return void(this.placements[_e.crossTileID]=new cn(!1,!1,!1));let Sr=!1,an=!1,pn=!0,oi=null,Mr={box:null,placeable:!1,offscreen:null},Xn={box:null,placeable:!1,offscreen:null},Vn=null,bn=null,xn=null,ei=0,Gi=0,no=0;be.textFeatureIndex?ei=be.textFeatureIndex:_e.useRuntimeCollisionCircles&&(ei=_e.featureIndex),be.verticalTextFeatureIndex&&(Gi=be.verticalTextFeatureIndex);const pi=be.textBox;if(pi){const ai=is=>{let Ui=o.ai.horizontal;if(A.allowVerticalPlacement&&!is&&this.prevPlacement){const wi=this.prevPlacement.placedOrientations[_e.crossTileID];wi&&(this.placedOrientations[_e.crossTileID]=wi,Ui=wi,this.markUsedOrientation(A,Ui,_e))}return Ui},Bn=(is,Ui)=>{if(A.allowVerticalPlacement&&_e.numVerticalGlyphVertices>0&&be.verticalTextBox){for(const wi of A.writingModes)if(wi===o.ai.vertical?(Mr=Ui(),Xn=Mr):Mr=is(),Mr&&Mr.placeable)break}else Mr=is()},va=_e.textAnchorOffsetStartIndex,Tc=_e.textAnchorOffsetEndIndex;if(Tc===va){const is=(Ui,wi)=>{const Gn=this.collisionIndex.placeCollisionBox(Ui,at,N,I,L,zt,Dt,w,Y.predicate,Pe);return Gn&&Gn.placeable&&(this.markUsedOrientation(A,wi,_e),this.placedOrientations[_e.crossTileID]=wi),Gn};Bn(()=>is(pi,o.ai.horizontal),()=>{const Ui=be.verticalTextBox;return A.allowVerticalPlacement&&_e.numVerticalGlyphVertices>0&&Ui?is(Ui,o.ai.vertical):{box:null,offscreen:null}}),ai(Mr&&Mr.placeable)}else{let is=o.ar[(He=(Rr=this.prevPlacement)===null||Rr===void 0?void 0:Rr.variableOffsets[_e.crossTileID])===null||He===void 0?void 0:He.anchor];const Ui=(Gn,ds,kl)=>{const li=Gn.x2-Gn.x1,Dd=Gn.y2-Gn.y1,Ic=_e.textBoxScale,_A=ue&&At==="never"?ds:null;let Zo=null,bh=at==="never"?1:2,bu="never";is&&bh++;for(let Fc=0;Fc<bh;Fc++){for(let Nd=va;Nd<Tc;Nd++){const wh=A.textAnchorOffsets.get(Nd);if(is&&wh.textAnchor!==is)continue;const Ql=this.attemptAnchorPlacement(wh,Gn,li,Dd,Ic,Dt,zt,N,I,L,Y,bu,_e,A,kl,w,B,_A,Pe);if(Ql&&(Zo=Ql.placedGlyphBoxes,Zo&&Zo.placeable))return Sr=!0,oi=Ql.shift,Zo}is?is=null:bu=at}return _&&!Zo&&(Zo={box:this.collisionIndex.placeCollisionBox(pi,"always",N,I,L,zt,Dt,w,Y.predicate,Pe,new o.P(0,0)).box,offscreen:!1,placeable:!1}),Zo};Bn(()=>Ui(pi,be.iconBox,o.ai.horizontal),()=>{const Gn=be.verticalTextBox;return A.allowVerticalPlacement&&(!Mr||!Mr.placeable)&&_e.numVerticalGlyphVertices>0&&Gn?Ui(Gn,be.verticalIconBox,o.ai.vertical):{box:null,occluded:!0,offscreen:null}}),Mr&&(Sr=Mr.placeable,pn=Mr.offscreen);const wi=ai(Mr&&Mr.placeable);if(!Sr&&this.prevPlacement){const Gn=this.prevPlacement.variableOffsets[_e.crossTileID];Gn&&(this.variableOffsets[_e.crossTileID]=Gn,this.markUsedJustification(A,Gn.anchor,_e,wi))}}}if(Vn=Mr,Sr=Vn&&Vn.placeable,pn=Vn&&Vn.offscreen,_e.useRuntimeCollisionCircles){const ai=A.text.placedSymbolArray.get(_e.centerJustifiedTextSymbolIndex),Bn=o.aj(A.textSizeData,et,ai),va=g.get("text-padding");bn=this.collisionIndex.placeCollisionCircles(at,ai,A.lineVertexArray,A.glyphOffsetArray,Bn,I,L,R,O,_,zt,Y.predicate,_e.collisionCircleDiameter,va,w,Pe),bn.circles.length&&bn.collisionDetected&&!_&&o.w("Collisions detected, but collision boxes are not shown"),Sr=lt||bn.circles.length>0&&!bn.collisionDetected,pn=pn&&bn.offscreen}if(be.iconFeatureIndex&&(no=be.iconFeatureIndex),be.iconBox){const ai=Bn=>this.collisionIndex.placeCollisionBox(Bn,At,N,I,L,zt,Dt,B,Y.predicate,Pe,ue&&oi?oi:void 0);Xn&&Xn.placeable&&be.verticalIconBox?(xn=ai(be.verticalIconBox),an=xn.placeable):(xn=ai(be.iconBox),an=xn.placeable),pn=pn&&xn.offscreen}const Is=Z||_e.numHorizontalGlyphVertices===0&&_e.numVerticalGlyphVertices===0,_a=yt||_e.numIconVertices===0;Is||_a?_a?Is||(an=an&&Sr):Sr=an&&Sr:an=Sr=an&&Sr;const Nl=an&&xn.placeable;if(Sr&&Vn.placeable&&this.collisionIndex.insertCollisionBox(Vn.box,at,g.get("text-ignore-placement"),A.bucketInstanceId,Xn&&Xn.placeable&&Gi?Gi:ei,Y.ID),Nl&&this.collisionIndex.insertCollisionBox(xn.box,At,g.get("icon-ignore-placement"),A.bucketInstanceId,no,Y.ID),bn&&Sr&&this.collisionIndex.insertCollisionCircles(bn.circles,at,g.get("text-ignore-placement"),A.bucketInstanceId,ei,Y.ID),_&&this.storeCollisionData(A.bucketInstanceId,Xe,be,Vn,xn,bn),_e.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(A.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[_e.crossTileID]=new cn(Sr||ce,an||ie,pn||A.justReloaded),f[_e.crossTileID]=!0};if(oe){if(c.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const _e=A.getSortedSymbolIndexes(this.transform.angle);for(let be=_e.length-1;be>=0;--be){const Xe=_e[be];We(A.symbolInstances.get(Xe),A.collisionArrays[Xe],Xe)}}else for(let _e=c.symbolInstanceStart;_e<c.symbolInstanceEnd;_e++)We(A.symbolInstances.get(_e),A.collisionArrays[_e],_e);if(_&&A.bucketInstanceId in this.collisionCircleArrays){const _e=this.collisionCircleArrays[A.bucketInstanceId];o.at(_e.invProjMatrix,I),_e.viewportMatrix=this.collisionIndex.getViewportMatrix()}A.justReloaded=!1}storeCollisionData(c,f,_,A,g,w){if(_.textBox||_.iconBox){let B,I;this.collisionBoxArrays.has(c)?B=this.collisionBoxArrays.get(c):(B=new Map,this.collisionBoxArrays.set(c,B)),B.has(f)?I=B.get(f):(I={text:null,icon:null},B.set(f,I)),_.textBox&&(I.text=A.box),_.iconBox&&(I.icon=g.box)}if(w){let B=this.collisionCircleArrays[c];B===void 0&&(B=this.collisionCircleArrays[c]=new br);for(let I=0;I<w.circles.length;I+=4)B.circles.push(w.circles[I+0]),B.circles.push(w.circles[I+1]),B.circles.push(w.circles[I+2]),B.circles.push(w.collisionDetected?1:0)}}markUsedJustification(c,f,_,A){let g;g=A===o.ai.vertical?_.verticalPlacedTextSymbolIndex:{left:_.leftJustifiedTextSymbolIndex,center:_.centerJustifiedTextSymbolIndex,right:_.rightJustifiedTextSymbolIndex}[o.au(f)];const w=[_.leftJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.rightJustifiedTextSymbolIndex,_.verticalPlacedTextSymbolIndex];for(const B of w)B>=0&&(c.text.placedSymbolArray.get(B).crossTileID=g>=0&&B!==g?0:_.crossTileID)}markUsedOrientation(c,f,_){const A=f===o.ai.horizontal||f===o.ai.horizontalOnly?f:0,g=f===o.ai.vertical?f:0,w=[_.leftJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.rightJustifiedTextSymbolIndex];for(const B of w)c.text.placedSymbolArray.get(B).placedOrientation=A;_.verticalPlacedTextSymbolIndex&&(c.text.placedSymbolArray.get(_.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const f=this.prevPlacement;let _=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;const A=f?f.symbolFadeChange(c):1,g=f?f.opacities:{},w=f?f.variableOffsets:{},B=f?f.placedOrientations:{};for(const I in this.placements){const L=this.placements[I],R=g[I];R?(this.opacities[I]=new Gr(R,A,L.text,L.icon),_=_||L.text!==R.text.placed||L.icon!==R.icon.placed):(this.opacities[I]=new Gr(null,A,L.text,L.icon,L.skipFade),_=_||L.text||L.icon)}for(const I in g){const L=g[I];if(!this.opacities[I]){const R=new Gr(L,A,!1,!1);R.isHidden()||(this.opacities[I]=R,_=_||L.text.placed||L.icon.placed)}}for(const I in w)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=w[I]);for(const I in B)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=B[I]);if(f&&f.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");_?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:c)}updateLayerOpacities(c,f){const _={};for(const A of f){const g=A.getBucket(c);g&&A.latestFeatureIndex&&c.id===g.layerIds[0]&&this.updateBucketOpacities(g,A.tileID,_,A.collisionBoxArray)}}updateBucketOpacities(c,f,_,A){c.hasTextData()&&(c.text.opacityVertexArray.clear(),c.text.hasVisibleVertices=!1),c.hasIconData()&&(c.icon.opacityVertexArray.clear(),c.icon.hasVisibleVertices=!1),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const g=c.layers[0],w=g.layout,B=new Gr(null,0,!1,!1,!0),I=w.get("text-allow-overlap"),L=w.get("icon-allow-overlap"),R=g._unevaluatedLayout.hasValue("text-variable-anchor")||g._unevaluatedLayout.hasValue("text-variable-anchor-offset"),O=w.get("text-rotation-alignment")==="map",N=w.get("text-pitch-alignment")==="map",H=w.get("icon-text-fit")!=="none",K=new Gr(null,0,I&&(L||!c.hasIconData()||w.get("icon-optional")),L&&(I||!c.hasTextData()||w.get("text-optional")),!0);!c.collisionArrays&&A&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(A);const et=(Z,yt,at)=>{for(let lt=0;lt<yt/4;lt++)Z.opacityVertexArray.emplaceBack(at);Z.hasVisibleVertices=Z.hasVisibleVertices||at!==Wr},Y=this.collisionBoxArrays.get(c.bucketInstanceId);for(let Z=0;Z<c.symbolInstances.length;Z++){const yt=c.symbolInstances.get(Z),{numHorizontalGlyphVertices:at,numVerticalGlyphVertices:lt,crossTileID:At}=yt;let Et=this.opacities[At];_[At]?Et=B:Et||(Et=K,this.opacities[At]=Et),_[At]=!0;const Dt=yt.numIconVertices>0,zt=this.placedOrientations[yt.crossTileID],ue=zt===o.ai.vertical,oe=zt===o.ai.horizontal||zt===o.ai.horizontalOnly;if(at>0||lt>0){const ie=mn(Et.text);et(c.text,at,ue?Wr:ie),et(c.text,lt,oe?Wr:ie);const Pe=Et.text.isHidden();[yt.rightJustifiedTextSymbolIndex,yt.centerJustifiedTextSymbolIndex,yt.leftJustifiedTextSymbolIndex].forEach(be=>{be>=0&&(c.text.placedSymbolArray.get(be).hidden=Pe||ue?1:0)}),yt.verticalPlacedTextSymbolIndex>=0&&(c.text.placedSymbolArray.get(yt.verticalPlacedTextSymbolIndex).hidden=Pe||oe?1:0);const We=this.variableOffsets[yt.crossTileID];We&&this.markUsedJustification(c,We.anchor,yt,zt);const _e=this.placedOrientations[yt.crossTileID];_e&&(this.markUsedJustification(c,"left",yt,_e),this.markUsedOrientation(c,_e,yt))}if(Dt){const ie=mn(Et.icon),Pe=!(H&&yt.verticalPlacedIconSymbolIndex&&ue);yt.placedIconSymbolIndex>=0&&(et(c.icon,yt.numIconVertices,Pe?ie:Wr),c.icon.placedSymbolArray.get(yt.placedIconSymbolIndex).hidden=Et.icon.isHidden()),yt.verticalPlacedIconSymbolIndex>=0&&(et(c.icon,yt.numVerticalIconVertices,Pe?Wr:ie),c.icon.placedSymbolArray.get(yt.verticalPlacedIconSymbolIndex).hidden=Et.icon.isHidden())}const ce=Y&&Y.has(Z)?Y.get(Z):{text:null,icon:null};if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const ie=c.collisionArrays[Z];if(ie){let Pe=new o.P(0,0);if(ie.textBox||ie.verticalTextBox){let We=!0;if(R){const _e=this.variableOffsets[At];_e?(Pe=Sn(_e.anchor,_e.width,_e.height,_e.textOffset,_e.textBoxScale),O&&Pe._rotate(N?this.transform.angle:-this.transform.angle)):We=!1}if(ie.textBox||ie.verticalTextBox){let _e;ie.textBox&&(_e=ue),ie.verticalTextBox&&(_e=oe),Oe(c.textCollisionBox.collisionVertexArray,Et.text.placed,!We||_e,ce.text,Pe.x,Pe.y)}}if(ie.iconBox||ie.verticalIconBox){const We=!!(!oe&&ie.verticalIconBox);let _e;ie.iconBox&&(_e=We),ie.verticalIconBox&&(_e=!We),Oe(c.iconCollisionBox.collisionVertexArray,Et.icon.placed,_e,ce.icon,H?Pe.x:0,H?Pe.y:0)}}}}if(c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.text.opacityVertexArray.length!==c.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${c.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${c.text.layoutVertexArray.length}) / 4`);if(c.icon.opacityVertexArray.length!==c.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${c.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${c.icon.layoutVertexArray.length}) / 4`);if(c.bucketInstanceId in this.collisionCircleArrays){const Z=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=Z.invProjMatrix,c.placementViewportMatrix=Z.viewportMatrix,c.collisionCircleArray=Z.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,f){const _=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*_>c}setStale(){this.stale=!0}}function Oe(S,c,f,_,A,g){_&&_.length!==0||(_=[0,0,0,0]);const w=_[0]-Br,B=_[1]-Br,I=_[2]-Br,L=_[3]-Br;S.emplaceBack(c?1:0,f?1:0,A||0,g||0,w,B),S.emplaceBack(c?1:0,f?1:0,A||0,g||0,I,B),S.emplaceBack(c?1:0,f?1:0,A||0,g||0,I,L),S.emplaceBack(c?1:0,f?1:0,A||0,g||0,w,L)}const Ee=Math.pow(2,25),or=Math.pow(2,24),Pr=Math.pow(2,17),Mn=Math.pow(2,16),qr=Math.pow(2,9),gn=Math.pow(2,8),vi=Math.pow(2,1);function mn(S){if(S.opacity===0&&!S.placed)return 0;if(S.opacity===1&&S.placed)return 4294967295;const c=S.placed?1:0,f=Math.floor(127*S.opacity);return f*Ee+c*or+f*Pr+c*Mn+f*qr+c*gn+f*vi+c}const Wr=0;function Da(){return{isOccluded:(S,c,f)=>!1,getPitchedTextCorrection:(S,c,f)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(S,c,f,_){throw new Error("Not implemented.")},translatePosition:(S,c,f,_)=>function(A,g,w,B){let I=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(!w[0]&&!w[1])return[0,0];const L=I?B==="map"?A.angle:0:B==="viewport"?-A.angle:0;if(L){const R=Math.sin(L),O=Math.cos(L);w=[w[0]*O-w[1]*R,w[0]*R+w[1]*O]}return[I?w[0]:pr(g,w[0],A.zoom),I?w[1]:pr(g,w[1],A.zoom)]}(S,c,f,_),getCircleRadiusCorrection:S=>1}}class Xs{constructor(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&!c.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(c,f,_,A,g){const w=this._bucketParts;for(;this._currentTileIndex<c.length;)if(f.getBucketParts(w,A,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((B,I)=>B.sortKey-I.sortKey));this._currentPartIndex<w.length;)if(f.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,_),this._currentPartIndex++,g())return!0;return!1}}class zn{constructor(c,f,_,A,g,w,B,I){this.placement=new Mt(c,Da(),f,w,B,I),this._currentPlacementIndex=_.length-1,this._forceFullPlacement=A,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(c,f,_){const A=b.now(),g=()=>!this._forceFullPlacement&&b.now()-A>2;for(;this._currentPlacementIndex>=0;){const w=f[c[this._currentPlacementIndex]],B=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=B)&&(!w.maxzoom||w.maxzoom>B)){if(this._inProgressLayer||(this._inProgressLayer=new Xs(w)),this._inProgressLayer.continuePlacement(_[w.source],this.placement,this._showCollisionBoxes,w,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const Jr=512/o.X/2;class vs{constructor(c,f,_){this.tileID=c,this.bucketInstanceId=_,this._symbolsByKey={};const A=new Map;for(let g=0;g<f.length;g++){const w=f.get(g),B=w.key,I=A.get(B);I?I.push(w):A.set(B,[w])}for(const[g,w]of A){const B={positions:w.map(I=>({x:Math.floor(I.anchorX*Jr),y:Math.floor(I.anchorY*Jr)})),crossTileIDs:w.map(I=>I.crossTileID)};if(B.positions.length>128){const I=new o.aw(B.positions.length,16,Uint16Array);for(const{x:L,y:R}of B.positions)I.add(L,R);I.finish(),delete B.positions,B.index=I}this._symbolsByKey[g]=B}}getScaledCoordinates(c,f){const{x:_,y:A,z:g}=this.tileID.canonical,{x:w,y:B,z:I}=f.canonical,L=Jr/Math.pow(2,I-g),R=(B*o.X+c.anchorY)*L,O=A*o.X*Jr;return{x:Math.floor((w*o.X+c.anchorX)*L-_*o.X*Jr),y:Math.floor(R-O)}}findMatches(c,f,_){const A=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z);for(let g=0;g<c.length;g++){const w=c.get(g);if(w.crossTileID)continue;const B=this._symbolsByKey[w.key];if(!B)continue;const I=this.getScaledCoordinates(w,f);if(B.index){const L=B.index.range(I.x-A,I.y-A,I.x+A,I.y+A).sort();for(const R of L){const O=B.crossTileIDs[R];if(!_[O]){_[O]=!0,w.crossTileID=O;break}}}else if(B.positions)for(let L=0;L<B.positions.length;L++){const R=B.positions[L],O=B.crossTileIDs[L];if(Math.abs(R.x-I.x)<=A&&Math.abs(R.y-I.y)<=A&&!_[O]){_[O]=!0,w.crossTileID=O;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(c=>{let{crossTileIDs:f}=c;return f})}}class Nn{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Qo{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const f=Math.round((c-this.lng)/360);if(f!==0)for(const _ in this.indexes){const A=this.indexes[_],g={};for(const w in A){const B=A[w];B.tileID=B.tileID.unwrapTo(B.tileID.wrap+f),g[B.tileID.key]=B}this.indexes[_]=g}this.lng=c}addBucket(c,f,_){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let g=0;g<f.symbolInstances.length;g++)f.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});const A=this.usedCrossTileIDs[c.overscaledZ];for(const g in this.indexes){const w=this.indexes[g];if(Number(g)>c.overscaledZ)for(const B in w){const I=w[B];I.tileID.isChildOf(c)&&I.findMatches(f.symbolInstances,c,A)}else{const B=w[c.scaledTo(Number(g)).key];B&&B.findMatches(f.symbolInstances,c,A)}}for(let g=0;g<f.symbolInstances.length;g++){const w=f.symbolInstances.get(g);w.crossTileID||(w.crossTileID=_.generate(),A[w.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new vs(c,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(c,f){for(const _ of f.getCrossTileIDsLists())for(const A of _)delete this.usedCrossTileIDs[c][A]}removeStaleBuckets(c){let f=!1;for(const _ in this.indexes){const A=this.indexes[_];for(const g in A)c[A[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,A[g]),delete A[g],f=!0)}return f}}class Ti{constructor(){this.layerIndexes={},this.crossTileIDs=new Nn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,f,_){let A=this.layerIndexes[c.id];A===void 0&&(A=this.layerIndexes[c.id]=new Qo);let g=!1;const w={};A.handleWrapJump(_);for(const B of f){const I=B.getBucket(c);I&&c.id===I.layerIds[0]&&(I.bucketInstanceId||(I.bucketInstanceId=++this.maxBucketInstanceId),A.addBucket(B.tileID,I,this.crossTileIDs)&&(g=!0),w[I.bucketInstanceId]=!0)}return A.removeStaleBuckets(w)&&(g=!0),g}pruneUnusedLayers(c){const f={};c.forEach(_=>{f[_]=!0});for(const _ in this.layerIndexes)f[_]||delete this.layerIndexes[_]}}const zo=(S,c)=>o.t(S,c&&c.filter(f=>f.identifier!=="source.canvas")),hi=o.ax();class ts extends o.E{constructor(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),this._rtlPluginLoaded=()=>{for(const _ in this.sourceCaches){const A=this.sourceCaches[_].getSource().type;A!=="vector"&&A!=="geojson"||this.sourceCaches[_].reload()}},this.map=c,this.dispatcher=new Ce(te(),c._getMapId()),this.dispatcher.registerMessageHandler("GG",(_,A)=>this.getGlyphs(_,A)),this.dispatcher.registerMessageHandler("GI",(_,A)=>this.getImages(_,A)),this.imageManager=new wt,this.imageManager.setEventedParent(this),this.glyphManager=new Yt(c._requestManager,f.localIdeographFontFamily),this.lineAtlas=new xt(256,512),this.crossTileSymbolIndex=new Ti,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",o.az()),Re().on(pe,this._rtlPluginLoaded),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const A=this.sourceCaches[_.sourceId];if(!A)return;const g=A.getSource();if(g&&g.vectorLayerIds)for(const w in this._layers){const B=this._layers[w];B.source===g.id&&this._validateLayer(B)}})}loadURL(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=arguments.length>2?arguments[2]:void 0;this.fire(new o.k("dataloading",{dataType:"style"})),f.validate=typeof f.validate!="boolean"||f.validate;const A=this.map._requestManager.transformRequest(c,"Style");this._loadStyleRequest=new AbortController,o.h(A,this._loadStyleRequest).then(g=>{this._loadStyleRequest=null,this._load(g.data,f,_)}).catch(g=>{this._loadStyleRequest=null,g&&this.fire(new o.j(g))})}loadJSON(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=arguments.length>2?arguments[2]:void 0;this.fire(new o.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,b.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,f.validate=f.validate!==!1,this._load(c,f,_)}).catch(()=>{})}loadEmpty(){this.fire(new o.k("dataloading",{dataType:"style"})),this._load(hi,{validate:!1})}_load(c,f,_){var A;const g=f.transformStyle?f.transformStyle(_,c):c;if(!f.validate||!zo(this,o.x(g))){this._loaded=!0,this.stylesheet=g;for(const w in g.sources)this.addSource(w,g.sources[w],{validate:!1});g.sprite?this._loadSprite(g.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(g.glyphs),this._createLayers(),this.light=new Zt(this.stylesheet.light),this.sky=new it(this.stylesheet.sky),this.map.setTerrain((A=this.stylesheet.terrain)!==null&&A!==void 0?A:null),this.fire(new o.k("data",{dataType:"style"})),this.fire(new o.k("style.load"))}}_createLayers(){const c=o.aA(this.stylesheet.layers);this.dispatcher.broadcast("SL",c),this._order=c.map(f=>f.id),this._layers={},this._serializedLayers=null;for(const f of c){const _=o.aB(f);_.setEventedParent(this,{layer:{id:f.id}}),this._layers[f.id]=_}}_loadSprite(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,A;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(g,w,B,I){return o._(this,void 0,void 0,function*(){const L=Ft(g),R=B>1?"@2x":"",O={},N={};for(const{id:H,url:K}of L){const et=w.transformRequest(Tt(K,R,".json"),"SpriteJSON");O[H]=o.h(et,I);const Y=w.transformRequest(Tt(K,R,".png"),"SpriteImage");N[H]=$.getImage(Y,I)}return yield Promise.all([...Object.values(O),...Object.values(N)]),function(H,K){return o._(this,void 0,void 0,function*(){const et={};for(const Y in H){et[Y]={};const Z=b.getImageCanvasContext((yield K[Y]).data),yt=(yield H[Y]).data;for(const at in yt){const{width:lt,height:At,x:Et,y:Dt,sdf:zt,pixelRatio:ue,stretchX:oe,stretchY:ce,content:ie,textFitWidth:Pe,textFitHeight:We}=yt[at];et[Y][at]={data:null,pixelRatio:ue,sdf:zt,stretchX:oe,stretchY:ce,content:ie,textFitWidth:Pe,textFitHeight:We,spriteData:{width:lt,height:At,x:Et,y:Dt,context:Z}}}}return et})}(O,N)})}(c,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(g=>{if(this._spriteRequest=null,g)for(const w in g){this._spritesImagesIds[w]=[];const B=this._spritesImagesIds[w]?this._spritesImagesIds[w].filter(I=>!(I in g)):[];for(const I of B)this.imageManager.removeImage(I),this._changedImages[I]=!0;for(const I in g[w]){const L=w==="default"?I:`${w}:${I}`;this._spritesImagesIds[w].push(L),L in this.imageManager.images?this.imageManager.updateImage(L,g[w][I],!1):this.imageManager.addImage(L,g[w][I]),f&&(this._changedImages[L]=!0)}}}).catch(g=>{this._spriteRequest=null,A=g,this.fire(new o.j(A))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),f&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"})),_&&_(A)})}_unloadSprite(){for(const c of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(c),this._changedImages[c]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}_validateLayer(c){const f=this.sourceCaches[c.source];if(!f)return;const _=c.sourceLayer;if(!_)return;const A=f.getSource();(A.type==="geojson"||A.vectorLayerIds&&A.vectorLayerIds.indexOf(_)===-1)&&this.fire(new o.j(new Error(`Source layer "${_}" does not exist on source "${A.id}" as specified by style layer "${c.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this.sourceCaches)if(!this.sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(c){const f=this._serializedAllLayers();if(!c||c.length===0)return Object.values(f);const _=[];for(const A of c)f[A]&&_.push(f[A]);return _}_serializedAllLayers(){let c=this._serializedLayers;if(c)return c;c=this._serializedLayers={};const f=Object.keys(this._layers);for(const _ of f){const A=this._layers[_];A.type!=="custom"&&(c[_]=A.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const c in this.sourceCaches)if(this.sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(c){if(!this._loaded)return;const f=this._changed;if(f){const A=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);(A.length||g.length)&&this._updateWorkerLayers(A,g);for(const w in this._updatedSources){const B=this._updatedSources[w];if(B==="reload")this._reloadSource(w);else{if(B!=="clear")throw new Error(`Invalid action ${B}`);this._clearSource(w)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(c);this.light.updateTransitions(c),this.sky.updateTransitions(c),this._resetUpdates()}const _={};for(const A in this.sourceCaches){const g=this.sourceCaches[A];_[A]=g.used,g.used=!1}for(const A of this._order){const g=this._layers[A];g.recalculate(c,this._availableImages),!g.isHidden(c.zoom)&&g.source&&(this.sourceCaches[g.source].used=!0)}for(const A in _){const g=this.sourceCaches[A];!!_[A]!=!!g.used&&g.fire(new o.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:A}))}this.light.recalculate(c),this.sky.recalculate(c),this.z=c.zoom,f&&this.fire(new o.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const f in this.sourceCaches)this.sourceCaches[f].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(c,f){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(c),removedIds:f})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var _;this._checkLoaded();const A=this.serialize();if(c=f.transformStyle?f.transformStyle(A,c):c,((_=f.validate)===null||_===void 0||_)&&zo(this,o.x(c)))return!1;(c=o.aC(c)).layers=o.aA(c.layers);const g=o.aD(A,c),w=this._getOperationsToPerform(g);if(w.unimplemented.length>0)throw new Error(`Unimplemented: ${w.unimplemented.join(", ")}.`);if(w.operations.length===0)return!1;for(const B of w.operations)B();return this.stylesheet=c,this._serializedLayers=null,!0}_getOperationsToPerform(c){const f=[],_=[];for(const A of c)switch(A.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":f.push(()=>this.addLayer.apply(this,A.args));break;case"removeLayer":f.push(()=>this.removeLayer.apply(this,A.args));break;case"setPaintProperty":f.push(()=>this.setPaintProperty.apply(this,A.args));break;case"setLayoutProperty":f.push(()=>this.setLayoutProperty.apply(this,A.args));break;case"setFilter":f.push(()=>this.setFilter.apply(this,A.args));break;case"addSource":f.push(()=>this.addSource.apply(this,A.args));break;case"removeSource":f.push(()=>this.removeSource.apply(this,A.args));break;case"setLayerZoomRange":f.push(()=>this.setLayerZoomRange.apply(this,A.args));break;case"setLight":f.push(()=>this.setLight.apply(this,A.args));break;case"setGeoJSONSourceData":f.push(()=>this.setGeoJSONSourceData.apply(this,A.args));break;case"setGlyphs":f.push(()=>this.setGlyphs.apply(this,A.args));break;case"setSprite":f.push(()=>this.setSprite.apply(this,A.args));break;case"setSky":f.push(()=>this.setSky.apply(this,A.args));break;case"setTerrain":f.push(()=>this.map.setTerrain.apply(this,A.args));break;case"setTransition":f.push(()=>{});break;default:_.push(A.command)}return{operations:f,unimplemented:_}}addImage(c,f){if(this.getImage(c))return this.fire(new o.j(new Error(`An image named "${c}" already exists.`)));this.imageManager.addImage(c,f),this._afterImageUpdated(c)}updateImage(c,f){this.imageManager.updateImage(c,f)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){if(!this.getImage(c))return this.fire(new o.j(new Error(`An image named "${c}" does not exist.`)));this.imageManager.removeImage(c),this._afterImageUpdated(c)}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(c,f){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this._checkLoaded(),this.sourceCaches[c]!==void 0)throw new Error(`Source "${c}" already exists.`);if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(o.x.source,`sources.${c}`,f,null,_))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);const A=this.sourceCaches[c]=new Ne(c,f,this.dispatcher);A.style=this,A.setEventedParent(this,()=>({isSourceLoaded:A.loaded(),source:A.serialize(),sourceId:c})),A.onAdd(this.map),this._changed=!0}removeSource(c){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error("There is no source with this ID");for(const _ in this._layers)if(this._layers[_].source===c)return this.fire(new o.j(new Error(`Source "${c}" cannot be removed while layer "${_}" is using it.`)));const f=this.sourceCaches[c];delete this.sourceCaches[c],delete this._updatedSources[c],f.fire(new o.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:c})),f.setEventedParent(null),f.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(c,f){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error(`There is no source with this ID=${c}`);const _=this.sourceCaches[c].getSource();if(_.type!=="geojson")throw new Error(`geojsonSource.type is ${_.type}, which is !== 'geojson`);_.setData(f),this._changed=!0}getSource(c){return this.sourceCaches[c]&&this.sourceCaches[c].getSource()}addLayer(c,f){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this._checkLoaded();const A=c.id;if(this.getLayer(A))return void this.fire(new o.j(new Error(`Layer "${A}" already exists on this map.`)));let g;if(c.type==="custom"){if(zo(this,o.aE(c)))return;g=o.aB(c)}else{if("source"in c&&typeof c.source=="object"&&(this.addSource(A,c.source),c=o.aC(c),c=o.e(c,{source:A})),this._validate(o.x.layer,`layers.${A}`,c,{arrayIndex:-1},_))return;g=o.aB(c),this._validateLayer(g),g.setEventedParent(this,{layer:{id:A}})}const w=f?this._order.indexOf(f):this._order.length;if(f&&w===-1)this.fire(new o.j(new Error(`Cannot add layer "${A}" before non-existing layer "${f}".`)));else{if(this._order.splice(w,0,A),this._layerOrderChanged=!0,this._layers[A]=g,this._removedLayers[A]&&g.source&&g.type!=="custom"){const B=this._removedLayers[A];delete this._removedLayers[A],B.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}moveLayer(c,f){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new o.j(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===f)return;const _=this._order.indexOf(c);this._order.splice(_,1);const A=f?this._order.indexOf(f):this._order.length;f&&A===-1?this.fire(new o.j(new Error(`Cannot move layer "${c}" before non-existing layer "${f}".`))):(this._order.splice(A,0,c),this._layerOrderChanged=!0)}removeLayer(c){this._checkLoaded();const f=this._layers[c];if(!f)return void this.fire(new o.j(new Error(`Cannot remove non-existing layer "${c}".`)));f.setEventedParent(null);const _=this._order.indexOf(c);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=f,delete this._layers[c],this._serializedLayers&&delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],f.onRemove&&f.onRemove(this.map)}getLayer(c){return this._layers[c]}getLayersOrder(){return[...this._order]}hasLayer(c){return c in this._layers}setLayerZoomRange(c,f,_){this._checkLoaded();const A=this.getLayer(c);A?A.minzoom===f&&A.maxzoom===_||(f!=null&&(A.minzoom=f),_!=null&&(A.maxzoom=_),this._updateLayer(A)):this.fire(new o.j(new Error(`Cannot set the zoom range of non-existing layer "${c}".`)))}setFilter(c,f){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this._checkLoaded();const A=this.getLayer(c);if(A){if(!o.aF(A.filter,f))return f==null?(A.filter=void 0,void this._updateLayer(A)):void(this._validate(o.x.filter,`layers.${A.id}.filter`,f,null,_)||(A.filter=o.aC(f),this._updateLayer(A)))}else this.fire(new o.j(new Error(`Cannot filter non-existing layer "${c}".`)))}getFilter(c){return o.aC(this.getLayer(c).filter)}setLayoutProperty(c,f,_){let A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this._checkLoaded();const g=this.getLayer(c);g?o.aF(g.getLayoutProperty(f),_)||(g.setLayoutProperty(f,_,A),this._updateLayer(g)):this.fire(new o.j(new Error(`Cannot style non-existing layer "${c}".`)))}getLayoutProperty(c,f){const _=this.getLayer(c);if(_)return _.getLayoutProperty(f);this.fire(new o.j(new Error(`Cannot get style of non-existing layer "${c}".`)))}setPaintProperty(c,f,_){let A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this._checkLoaded();const g=this.getLayer(c);g?o.aF(g.getPaintProperty(f),_)||(g.setPaintProperty(f,_,A)&&this._updateLayer(g),this._changed=!0,this._updatedPaintProps[c]=!0,this._serializedLayers=null):this.fire(new o.j(new Error(`Cannot style non-existing layer "${c}".`)))}getPaintProperty(c,f){return this.getLayer(c).getPaintProperty(f)}setFeatureState(c,f){this._checkLoaded();const _=c.source,A=c.sourceLayer,g=this.sourceCaches[_];if(g===void 0)return void this.fire(new o.j(new Error(`The source '${_}' does not exist in the map's style.`)));const w=g.getSource().type;w==="geojson"&&A?this.fire(new o.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||A?(c.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),g.setFeatureState(A,c.id,f)):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(c,f){this._checkLoaded();const _=c.source,A=this.sourceCaches[_];if(A===void 0)return void this.fire(new o.j(new Error(`The source '${_}' does not exist in the map's style.`)));const g=A.getSource().type,w=g==="vector"?c.sourceLayer:void 0;g!=="vector"||w?f&&typeof c.id!="string"&&typeof c.id!="number"?this.fire(new o.j(new Error("A feature id is required to remove its specific state property."))):A.removeFeatureState(w,c.id,f):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(c){this._checkLoaded();const f=c.source,_=c.sourceLayer,A=this.sourceCaches[f];if(A!==void 0)return A.getSource().type!=="vector"||_?(c.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),A.getFeatureState(_,c.id)):void this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.j(new Error(`The source '${f}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const c=o.aG(this.sourceCaches,g=>g.serialize()),f=this._serializeByIds(this._order),_=this.map.getTerrain()||void 0,A=this.stylesheet;return o.aH({version:A.version,name:A.name,metadata:A.metadata,light:A.light,sky:A.sky,center:A.center,zoom:A.zoom,bearing:A.bearing,pitch:A.pitch,sprite:A.sprite,glyphs:A.glyphs,transition:A.transition,sources:c,layers:f,terrain:_},g=>g!==void 0)}_updateLayer(c){this._updatedLayers[c.id]=!0,c.source&&!this._updatedSources[c.source]&&this.sourceCaches[c.source].getSource().type!=="raster"&&(this._updatedSources[c.source]="reload",this.sourceCaches[c.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(c){const f=w=>this._layers[w].type==="fill-extrusion",_={},A=[];for(let w=this._order.length-1;w>=0;w--){const B=this._order[w];if(f(B)){_[B]=w;for(const I of c){const L=I[B];if(L)for(const R of L)A.push(R)}}}A.sort((w,B)=>B.intersectionZ-w.intersectionZ);const g=[];for(let w=this._order.length-1;w>=0;w--){const B=this._order[w];if(f(B))for(let I=A.length-1;I>=0;I--){const L=A[I].feature;if(_[L.layer.id]<w)break;g.push(L),A.pop()}else for(const I of c){const L=I[B];if(L)for(const R of L)g.push(R.feature)}}return g}queryRenderedFeatures(c,f,_){f&&f.filter&&this._validate(o.x.filter,"queryRenderedFeatures.filter",f.filter,null,f);const A={};if(f&&f.layers){if(!Array.isArray(f.layers))return this.fire(new o.j(new Error("parameters.layers must be an Array."))),[];for(const B of f.layers){const I=this._layers[B];if(!I)return this.fire(new o.j(new Error(`The layer '${B}' does not exist in the map's style and cannot be queried for features.`))),[];A[I.source]=!0}}const g=[];f.availableImages=this._availableImages;const w=this._serializedAllLayers();for(const B in this.sourceCaches)f.layers&&!A[B]||g.push(Qe(this.sourceCaches[B],this._layers,w,c,f,_));return this.placement&&g.push(function(B,I,L,R,O,N,H){const K={},et=N.queryRenderedSymbols(R),Y=[];for(const Z of Object.keys(et).map(Number))Y.push(H[Z]);Y.sort(Je);for(const Z of Y){const yt=Z.featureIndex.lookupSymbolFeatures(et[Z.bucketInstanceId],I,Z.bucketIndex,Z.sourceLayerIndex,O.filter,O.layers,O.availableImages,B);for(const at in yt){const lt=K[at]=K[at]||[],At=yt[at];At.sort((Et,Dt)=>{const zt=Z.featureSortOrder;if(zt){const ue=zt.indexOf(Et.featureIndex);return zt.indexOf(Dt.featureIndex)-ue}return Dt.featureIndex-Et.featureIndex});for(const Et of At)lt.push(Et)}}for(const Z in K)K[Z].forEach(yt=>{const at=yt.feature,lt=L[B[Z].source].getFeatureState(at.layer["source-layer"],at.id);at.source=at.layer.source,at.layer["source-layer"]&&(at.sourceLayer=at.layer["source-layer"]),at.state=lt});return K}(this._layers,w,this.sourceCaches,c,f,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(g)}querySourceFeatures(c,f){f&&f.filter&&this._validate(o.x.filter,"querySourceFeatures.filter",f.filter,null,f);const _=this.sourceCaches[c];return _?function(A,g){const w=A.getRenderableIds().map(L=>A.getTileByID(L)),B=[],I={};for(let L=0;L<w.length;L++){const R=w[L],O=R.tileID.canonical.key;I[O]||(I[O]=!0,R.querySourceFeatures(B,g))}return B}(_,f):[]}getLight(){return this.light.getLight()}setLight(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this._checkLoaded();const _=this.light.getLight();let A=!1;for(const w in c)if(!o.aF(c[w],_[w])){A=!0;break}if(!A)return;const g={now:b.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(c,f),this.light.updateTransitions(g)}getSky(){var c;return(c=this.stylesheet)===null||c===void 0?void 0:c.sky}setSky(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const _=this.sky.getSky();let A=!1;c||_&&(A=!0);for(const w in c)if(!o.aF(c[w],_[w])){A=!0;break}if(!A)return;const g={now:b.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=c,this.sky.setSky(c,f),this.sky.updateTransitions(g)}_validate(c,f,_,A){let g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};return(!g||g.validate!==!1)&&zo(this,c.call(o.x,o.e({key:f,style:this.serialize(),value:_,styleSpec:o.v},A)))}_remove(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Re().off(pe,this._rtlPluginLoaded);for(const f in this._layers)this._layers[f].setEventedParent(null);for(const f in this.sourceCaches){const _=this.sourceCaches[f];_.setEventedParent(null),_.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),c&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(c)}_clearSource(c){this.sourceCaches[c].clearTiles()}_reloadSource(c){this.sourceCaches[c].resume(),this.sourceCaches[c].reload()}_updateSources(c){for(const f in this.sourceCaches)this.sourceCaches[f].update(c,this.map.terrain)}_generateCollisionBoxes(){for(const c in this.sourceCaches)this._reloadSource(c)}_updatePlacement(c,f,_,A){let g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,w=!1,B=!1;const I={};for(const L of this._order){const R=this._layers[L];if(R.type!=="symbol")continue;if(!I[R.source]){const N=this.sourceCaches[R.source];I[R.source]=N.getRenderableIds(!0).map(H=>N.getTileByID(H)).sort((H,K)=>K.tileID.overscaledZ-H.tileID.overscaledZ||(H.tileID.isLessThan(K.tileID)?-1:1))}const O=this.crossTileSymbolIndex.addLayer(R,I[R.source],c.center.lng);w=w||O}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||_===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(b.now(),c.zoom))&&(this.pauseablePlacement=new zn(c,this.map.terrain,this._order,g,f,_,A,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(b.now()),B=!0),w&&this.pauseablePlacement.placement.setStale()),B||w)for(const L of this._order){const R=this._layers[L];R.type==="symbol"&&this.placement.updateLayerOpacities(R,I[R.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(b.now())}_releaseSymbolFadeTiles(){for(const c in this.sourceCaches)this.sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,f){return o._(this,void 0,void 0,function*(){const _=yield this.imageManager.getImages(f.icons);this._updateTilesForChangedImages();const A=this.sourceCaches[f.source];return A&&A.setDependencies(f.tileID.key,f.type,f.icons),_})}getGlyphs(c,f){return o._(this,void 0,void 0,function*(){const _=yield this.glyphManager.getGlyphs(f.stacks),A=this.sourceCaches[f.source];return A&&A.setDependencies(f.tileID.key,f.type,[""]),_})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this._checkLoaded(),c&&this._validate(o.x.glyphs,"glyphs",c,null,f)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=c,this.glyphManager.entries={},this.glyphManager.setURL(c))}addSprite(c,f){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},A=arguments.length>3?arguments[3]:void 0;this._checkLoaded();const g=[{id:c,url:f}],w=[...Ft(this.stylesheet.sprite),...g];this._validate(o.x.sprite,"sprite",w,null,_)||(this.stylesheet.sprite=w,this._loadSprite(g,!0,A))}removeSprite(c){this._checkLoaded();const f=Ft(this.stylesheet.sprite);if(f.find(_=>_.id===c)){if(this._spritesImagesIds[c])for(const _ of this._spritesImagesIds[c])this.imageManager.removeImage(_),this._changedImages[_]=!0;f.splice(f.findIndex(_=>_.id===c),1),this.stylesheet.sprite=f.length>0?f:void 0,delete this._spritesImagesIds[c],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}else this.fire(new o.j(new Error(`Sprite "${c}" doesn't exists on this map.`)))}getSprite(){return Ft(this.stylesheet.sprite)}setSprite(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=arguments.length>2?arguments[2]:void 0;this._checkLoaded(),c&&this._validate(o.x.sprite,"sprite",c,null,f)||(this.stylesheet.sprite=c,c?this._loadSprite(c,!0,_):(this._unloadSprite(),_&&_(null)))}}var Ii=o.Y([{name:"a_pos",type:"Int16",components:2}]);const bs={prelude:tn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:tn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:tn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:tn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:tn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:tn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:tn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:tn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:tn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:tn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:tn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:tn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:tn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:tn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:tn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:tn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:tn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:tn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:tn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:tn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:tn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:tn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:tn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:tn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:tn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:tn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:tn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:tn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:tn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:tn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function tn(S,c){const f=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,_=c.match(/attribute ([\w]+) ([\w]+)/g),A=S.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=c.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=g?g.concat(A):A,B={};return{fragmentSource:S=S.replace(f,(I,L,R,O,N)=>(B[N]=!0,L==="define"?`
#ifndef HAS_UNIFORM_u_${N}
varying ${R} ${O} ${N};
#else
uniform ${R} ${O} u_${N};
#endif
`:`
#ifdef HAS_UNIFORM_u_${N}
    ${R} ${O} ${N} = u_${N};
#endif
`)),vertexSource:c=c.replace(f,(I,L,R,O,N)=>{const H=O==="float"?"vec2":"vec4",K=N.match(/color/)?"color":H;return B[N]?L==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
attribute ${R} ${H} a_${N};
varying ${R} ${O} ${N};
#else
uniform ${R} ${O} u_${N};
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = a_${N};
#else
    ${R} ${O} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = unpack_mix_${K}(a_${N}, u_${N}_t);
#else
    ${R} ${O} ${N} = u_${N};
#endif
`:L==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
attribute ${R} ${H} a_${N};
#else
uniform ${R} ${O} u_${N};
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${R} ${O} ${N} = a_${N};
#else
    ${R} ${O} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${R} ${O} ${N} = unpack_mix_${K}(a_${N}, u_${N}_t);
#else
    ${R} ${O} ${N} = u_${N};
#endif
`}),staticAttributes:_,staticUniforms:w}}class Na{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(c,f,_,A,g,w,B,I,L){this.context=c;let R=this.boundPaintVertexBuffers.length!==A.length;for(let O=0;!R&&O<A.length;O++)this.boundPaintVertexBuffers[O]!==A[O]&&(R=!0);!this.vao||this.boundProgram!==f||this.boundLayoutVertexBuffer!==_||R||this.boundIndexBuffer!==g||this.boundVertexOffset!==w||this.boundDynamicVertexBuffer!==B||this.boundDynamicVertexBuffer2!==I||this.boundDynamicVertexBuffer3!==L?this.freshBind(f,_,A,g,w,B,I,L):(c.bindVertexArray.set(this.vao),B&&B.bind(),g&&g.dynamicDraw&&g.bind(),I&&I.bind(),L&&L.bind())}freshBind(c,f,_,A,g,w,B,I){const L=c.numAttributes,R=this.context,O=R.gl;this.vao&&this.destroy(),this.vao=R.createVertexArray(),R.bindVertexArray.set(this.vao),this.boundProgram=c,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=A,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=B,this.boundDynamicVertexBuffer3=I,f.enableAttributes(O,c);for(const N of _)N.enableAttributes(O,c);w&&w.enableAttributes(O,c),B&&B.enableAttributes(O,c),I&&I.enableAttributes(O,c),f.bind(),f.setVertexAttribPointers(O,c,g);for(const N of _)N.bind(),N.setVertexAttribPointers(O,c,g);w&&(w.bind(),w.setVertexAttribPointers(O,c,g)),A&&A.bind(),B&&(B.bind(),B.setVertexAttribPointers(O,c,g)),I&&(I.bind(),I.setVertexAttribPointers(O,c,g)),R.currentNumAttributes=L}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const _l=(S,c,f,_,A)=>({u_matrix:S,u_texture:0,u_ele_delta:c,u_fog_matrix:f,u_fog_color:_?_.properties.get("fog-color"):o.aN.white,u_fog_ground_blend:_?_.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:_?_.calculateFogBlendOpacity(A):0,u_horizon_color:_?_.properties.get("horizon-color"):o.aN.white,u_horizon_fog_blend:_?_.properties.get("horizon-fog-blend"):1});function ka(S){const c=[];for(let f=0;f<S.length;f++){if(S[f]===null)continue;const _=S[f].split(" ");c.push(_.pop())}return c}class ht{constructor(c,f,_,A,g,w){const B=c.gl;this.program=B.createProgram();const I=ka(f.staticAttributes),L=_?_.getBinderAttributes():[],R=I.concat(L),O=bs.prelude.staticUniforms?ka(bs.prelude.staticUniforms):[],N=f.staticUniforms?ka(f.staticUniforms):[],H=_?_.getBinderUniforms():[],K=O.concat(N).concat(H),et=[];for(const Et of K)et.indexOf(Et)<0&&et.push(Et);const Y=_?_.defines():[];g&&Y.push("#define OVERDRAW_INSPECTOR;"),w&&Y.push("#define TERRAIN3D;");const Z=Y.concat(bs.prelude.fragmentSource,f.fragmentSource).join(`
`),yt=Y.concat(bs.prelude.vertexSource,f.vertexSource).join(`
`),at=B.createShader(B.FRAGMENT_SHADER);if(B.isContextLost())return void(this.failedToCreate=!0);if(B.shaderSource(at,Z),B.compileShader(at),!B.getShaderParameter(at,B.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${B.getShaderInfoLog(at)}`);B.attachShader(this.program,at);const lt=B.createShader(B.VERTEX_SHADER);if(B.isContextLost())return void(this.failedToCreate=!0);if(B.shaderSource(lt,yt),B.compileShader(lt),!B.getShaderParameter(lt,B.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${B.getShaderInfoLog(lt)}`);B.attachShader(this.program,lt),this.attributes={};const At={};this.numAttributes=R.length;for(let Et=0;Et<this.numAttributes;Et++)R[Et]&&(B.bindAttribLocation(this.program,Et,R[Et]),this.attributes[R[Et]]=Et);if(B.linkProgram(this.program),!B.getProgramParameter(this.program,B.LINK_STATUS))throw new Error(`Program failed to link: ${B.getProgramInfoLog(this.program)}`);B.deleteShader(lt),B.deleteShader(at);for(let Et=0;Et<et.length;Et++){const Dt=et[Et];if(Dt&&!At[Dt]){const zt=B.getUniformLocation(this.program,Dt);zt&&(At[Dt]=zt)}}this.fixedUniforms=A(c,At),this.terrainUniforms=((Et,Dt)=>({u_depth:new o.aI(Et,Dt.u_depth),u_terrain:new o.aI(Et,Dt.u_terrain),u_terrain_dim:new o.aJ(Et,Dt.u_terrain_dim),u_terrain_matrix:new o.aK(Et,Dt.u_terrain_matrix),u_terrain_unpack:new o.aL(Et,Dt.u_terrain_unpack),u_terrain_exaggeration:new o.aJ(Et,Dt.u_terrain_exaggeration)}))(c,At),this.binderUniforms=_?_.getUniforms(c,At):[]}draw(c,f,_,A,g,w,B,I,L,R,O,N,H,K,et,Y,Z,yt){const at=c.gl;if(this.failedToCreate)return;if(c.program.set(this.program),c.setDepthMode(_),c.setStencilMode(A),c.setColorMode(g),c.setCullFace(w),I){c.activeTexture.set(at.TEXTURE2),at.bindTexture(at.TEXTURE_2D,I.depthTexture),c.activeTexture.set(at.TEXTURE3),at.bindTexture(at.TEXTURE_2D,I.texture);for(const At in this.terrainUniforms)this.terrainUniforms[At].set(I[At])}for(const At in this.fixedUniforms)this.fixedUniforms[At].set(B[At]);et&&et.setUniforms(c,this.binderUniforms,H,{zoom:K});let lt=0;switch(f){case at.LINES:lt=2;break;case at.TRIANGLES:lt=3;break;case at.LINE_STRIP:lt=1}for(const At of N.get()){const Et=At.vaos||(At.vaos={});(Et[L]||(Et[L]=new Na)).bind(c,this,R,et?et.getPaintVertexBuffers():[],O,At.vertexOffset,Y,Z,yt),at.drawElements(f,At.primitiveLength*lt,at.UNSIGNED_SHORT,At.primitiveOffset*lt*2)}}}function bt(S,c,f){const _=1/pr(f,1,c.transform.tileZoom),A=Math.pow(2,f.tileID.overscaledZ),g=f.tileSize*Math.pow(2,c.transform.tileZoom)/A,w=g*(f.tileID.canonical.x+f.tileID.wrap*A),B=g*f.tileID.canonical.y;return{u_image:0,u_texsize:f.imageAtlasTexture.size,u_scale:[_,S.fromScale,S.toScale],u_fade:S.t,u_pixel_coord_upper:[w>>16,B>>16],u_pixel_coord_lower:[65535&w,65535&B]}}const Nt=(S,c,f,_)=>{const A=c.style.light,g=A.properties.get("position"),w=[g.x,g.y,g.z],B=function(){var L=new o.A(9);return o.A!=Float32Array&&(L[1]=0,L[2]=0,L[3]=0,L[5]=0,L[6]=0,L[7]=0),L[0]=1,L[4]=1,L[8]=1,L}();A.properties.get("anchor")==="viewport"&&function(L,R){var O=Math.sin(R),N=Math.cos(R);L[0]=N,L[1]=O,L[2]=0,L[3]=-O,L[4]=N,L[5]=0,L[6]=0,L[7]=0,L[8]=1}(B,-c.transform.angle),function(L,R,O){var N=R[0],H=R[1],K=R[2];L[0]=N*O[0]+H*O[3]+K*O[6],L[1]=N*O[1]+H*O[4]+K*O[7],L[2]=N*O[2]+H*O[5]+K*O[8]}(w,w,B);const I=A.properties.get("color");return{u_matrix:S,u_lightpos:w,u_lightintensity:A.properties.get("intensity"),u_lightcolor:[I.r,I.g,I.b],u_vertical_gradient:+f,u_opacity:_}},le=(S,c,f,_,A,g,w)=>o.e(Nt(S,c,f,_),bt(g,c,w),{u_height_factor:-Math.pow(2,A.overscaledZ)/w.tileSize/8}),Ie=S=>({u_matrix:S}),Ze=(S,c,f,_)=>o.e(Ie(S),bt(f,c,_)),zr=(S,c)=>({u_matrix:S,u_world:c}),Zn=(S,c,f,_,A)=>o.e(Ze(S,c,f,_),{u_world:A}),ti=(S,c,f,_)=>{const A=S.transform;let g,w;if(_.paint.get("circle-pitch-alignment")==="map"){const B=pr(f,1,A.zoom);g=!0,w=[B,B]}else g=!1,w=A.pixelsToGLUnits;return{u_camera_to_center_distance:A.cameraToCenterDistance,u_scale_with_map:+(_.paint.get("circle-pitch-scale")==="map"),u_matrix:S.translatePosMatrix(c.posMatrix,f,_.paint.get("circle-translate"),_.paint.get("circle-translate-anchor")),u_pitch_with_map:+g,u_device_pixel_ratio:S.pixelRatio,u_extrude_scale:w}},Fi=(S,c,f)=>({u_matrix:S,u_inv_matrix:c,u_camera_to_center_distance:f.cameraToCenterDistance,u_viewport_size:[f.width,f.height]}),yn=function(S,c){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return{u_matrix:S,u_color:c,u_overlay:0,u_overlay_scale:f}},yc=S=>({u_matrix:S}),As=(S,c,f,_)=>({u_matrix:S,u_extrude_scale:pr(c,1,f),u_intensity:_});function Ir(S,c){const f=Math.pow(2,c.canonical.z),_=c.canonical.y;return[new o.Z(0,_/f).toLngLat().lat,new o.Z(0,(_+1)/f).toLngLat().lat]}const _c=(S,c,f,_)=>{const A=S.transform;return{u_matrix:vc(S,c,f,_),u_ratio:1/pr(c,1,A.zoom),u_device_pixel_ratio:S.pixelRatio,u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]]}},iu=(S,c,f,_,A)=>o.e(_c(S,c,f,A),{u_image:0,u_image_height:_}),Ho=(S,c,f,_,A)=>{const g=S.transform,w=Aa(c,g);return{u_matrix:vc(S,c,f,A),u_texsize:c.imageAtlasTexture.size,u_ratio:1/pr(c,1,g.zoom),u_device_pixel_ratio:S.pixelRatio,u_image:0,u_scale:[w,_.fromScale,_.toScale],u_fade:_.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},nA=(S,c,f,_,A,g)=>{const w=S.lineAtlas,B=Aa(c,S.transform),I=f.layout.get("line-cap")==="round",L=w.getDash(_.from,I),R=w.getDash(_.to,I),O=L.width*A.fromScale,N=R.width*A.toScale;return o.e(_c(S,c,f,g),{u_patternscale_a:[B/O,-L.height/2],u_patternscale_b:[B/N,-R.height/2],u_sdfgamma:w.width/(256*Math.min(O,N)*S.pixelRatio)/2,u_image:0,u_tex_y_a:L.y,u_tex_y_b:R.y,u_mix:A.t})};function Aa(S,c){return 1/pr(S,1,c.tileZoom)}function vc(S,c,f,_){return S.translatePosMatrix(_?_.posMatrix:c.tileID.posMatrix,c,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}const iA=(S,c,f,_,A)=>{return{u_matrix:S,u_tl_parent:c,u_scale_parent:f,u_buffer_scale:1,u_fade_t:_.mix,u_opacity:_.opacity*A.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:A.paint.get("raster-brightness-min"),u_brightness_high:A.paint.get("raster-brightness-max"),u_saturation_factor:(w=A.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(g=A.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:Ed(A.paint.get("raster-hue-rotate"))};var g,w};function Ed(S){S*=Math.PI/180;const c=Math.sin(S),f=Math.cos(S);return[(2*f+1)/3,(-Math.sqrt(3)*c-f+1)/3,(Math.sqrt(3)*c-f+1)/3]}const ch=(S,c,f,_,A,g,w,B,I,L,R,O,N,H)=>{const K=w.transform;return{u_is_size_zoom_constant:+(S==="constant"||S==="source"),u_is_size_feature_constant:+(S==="constant"||S==="camera"),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:K.cameraToCenterDistance,u_pitch:K.pitch/360*2*Math.PI,u_rotate_symbol:+f,u_aspect_ratio:K.width/K.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:B,u_label_plane_matrix:I,u_coord_matrix:L,u_is_text:+O,u_pitch_with_map:+_,u_is_along_line:A,u_is_variable_anchor:g,u_texsize:N,u_texture:0,u_translation:R,u_pitched_scale:H}},uh=(S,c,f,_,A,g,w,B,I,L,R,O,N,H,K)=>{const et=w.transform;return o.e(ch(S,c,f,_,A,g,w,B,I,L,R,O,N,K),{u_gamma_scale:_?Math.cos(et._pitch)*et.cameraToCenterDistance:1,u_device_pixel_ratio:w.pixelRatio,u_is_halo:+H})},sA=(S,c,f,_,A,g,w,B,I,L,R,O,N,H)=>o.e(uh(S,c,f,_,A,g,w,B,I,L,R,!0,O,!0,H),{u_texsize_icon:N,u_texture_icon:1}),ha=(S,c,f)=>({u_matrix:S,u_opacity:c,u_color:f}),da=(S,c,f,_,A,g)=>o.e(function(w,B,I,L){const R=I.imageManager.getPattern(w.from.toString()),O=I.imageManager.getPattern(w.to.toString()),{width:N,height:H}=I.imageManager.getPixelSize(),K=Math.pow(2,L.tileID.overscaledZ),et=L.tileSize*Math.pow(2,I.transform.tileZoom)/K,Y=et*(L.tileID.canonical.x+L.tileID.wrap*K),Z=et*L.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:R.tl,u_pattern_br_a:R.br,u_pattern_tl_b:O.tl,u_pattern_br_b:O.br,u_texsize:[N,H],u_mix:B.t,u_pattern_size_a:R.displaySize,u_pattern_size_b:O.displaySize,u_scale_a:B.fromScale,u_scale_b:B.toScale,u_tile_units_to_pixels:1/pr(L,1,I.transform.tileZoom),u_pixel_coord_upper:[Y>>16,Z>>16],u_pixel_coord_lower:[65535&Y,65535&Z]}}(_,g,f,A),{u_matrix:S,u_opacity:c}),su={fillExtrusion:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_lightpos:new o.aO(S,c.u_lightpos),u_lightintensity:new o.aJ(S,c.u_lightintensity),u_lightcolor:new o.aO(S,c.u_lightcolor),u_vertical_gradient:new o.aJ(S,c.u_vertical_gradient),u_opacity:new o.aJ(S,c.u_opacity)}),fillExtrusionPattern:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_lightpos:new o.aO(S,c.u_lightpos),u_lightintensity:new o.aJ(S,c.u_lightintensity),u_lightcolor:new o.aO(S,c.u_lightcolor),u_vertical_gradient:new o.aJ(S,c.u_vertical_gradient),u_height_factor:new o.aJ(S,c.u_height_factor),u_image:new o.aI(S,c.u_image),u_texsize:new o.aP(S,c.u_texsize),u_pixel_coord_upper:new o.aP(S,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.aP(S,c.u_pixel_coord_lower),u_scale:new o.aO(S,c.u_scale),u_fade:new o.aJ(S,c.u_fade),u_opacity:new o.aJ(S,c.u_opacity)}),fill:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix)}),fillPattern:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_image:new o.aI(S,c.u_image),u_texsize:new o.aP(S,c.u_texsize),u_pixel_coord_upper:new o.aP(S,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.aP(S,c.u_pixel_coord_lower),u_scale:new o.aO(S,c.u_scale),u_fade:new o.aJ(S,c.u_fade)}),fillOutline:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_world:new o.aP(S,c.u_world)}),fillOutlinePattern:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_world:new o.aP(S,c.u_world),u_image:new o.aI(S,c.u_image),u_texsize:new o.aP(S,c.u_texsize),u_pixel_coord_upper:new o.aP(S,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.aP(S,c.u_pixel_coord_lower),u_scale:new o.aO(S,c.u_scale),u_fade:new o.aJ(S,c.u_fade)}),circle:(S,c)=>({u_camera_to_center_distance:new o.aJ(S,c.u_camera_to_center_distance),u_scale_with_map:new o.aI(S,c.u_scale_with_map),u_pitch_with_map:new o.aI(S,c.u_pitch_with_map),u_extrude_scale:new o.aP(S,c.u_extrude_scale),u_device_pixel_ratio:new o.aJ(S,c.u_device_pixel_ratio),u_matrix:new o.aK(S,c.u_matrix)}),collisionBox:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_pixel_extrude_scale:new o.aP(S,c.u_pixel_extrude_scale)}),collisionCircle:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_inv_matrix:new o.aK(S,c.u_inv_matrix),u_camera_to_center_distance:new o.aJ(S,c.u_camera_to_center_distance),u_viewport_size:new o.aP(S,c.u_viewport_size)}),debug:(S,c)=>({u_color:new o.aM(S,c.u_color),u_matrix:new o.aK(S,c.u_matrix),u_overlay:new o.aI(S,c.u_overlay),u_overlay_scale:new o.aJ(S,c.u_overlay_scale)}),clippingMask:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix)}),heatmap:(S,c)=>({u_extrude_scale:new o.aJ(S,c.u_extrude_scale),u_intensity:new o.aJ(S,c.u_intensity),u_matrix:new o.aK(S,c.u_matrix)}),heatmapTexture:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_world:new o.aP(S,c.u_world),u_image:new o.aI(S,c.u_image),u_color_ramp:new o.aI(S,c.u_color_ramp),u_opacity:new o.aJ(S,c.u_opacity)}),hillshade:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_image:new o.aI(S,c.u_image),u_latrange:new o.aP(S,c.u_latrange),u_light:new o.aP(S,c.u_light),u_shadow:new o.aM(S,c.u_shadow),u_highlight:new o.aM(S,c.u_highlight),u_accent:new o.aM(S,c.u_accent)}),hillshadePrepare:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_image:new o.aI(S,c.u_image),u_dimension:new o.aP(S,c.u_dimension),u_zoom:new o.aJ(S,c.u_zoom),u_unpack:new o.aL(S,c.u_unpack)}),line:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_ratio:new o.aJ(S,c.u_ratio),u_device_pixel_ratio:new o.aJ(S,c.u_device_pixel_ratio),u_units_to_pixels:new o.aP(S,c.u_units_to_pixels)}),lineGradient:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_ratio:new o.aJ(S,c.u_ratio),u_device_pixel_ratio:new o.aJ(S,c.u_device_pixel_ratio),u_units_to_pixels:new o.aP(S,c.u_units_to_pixels),u_image:new o.aI(S,c.u_image),u_image_height:new o.aJ(S,c.u_image_height)}),linePattern:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_texsize:new o.aP(S,c.u_texsize),u_ratio:new o.aJ(S,c.u_ratio),u_device_pixel_ratio:new o.aJ(S,c.u_device_pixel_ratio),u_image:new o.aI(S,c.u_image),u_units_to_pixels:new o.aP(S,c.u_units_to_pixels),u_scale:new o.aO(S,c.u_scale),u_fade:new o.aJ(S,c.u_fade)}),lineSDF:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_ratio:new o.aJ(S,c.u_ratio),u_device_pixel_ratio:new o.aJ(S,c.u_device_pixel_ratio),u_units_to_pixels:new o.aP(S,c.u_units_to_pixels),u_patternscale_a:new o.aP(S,c.u_patternscale_a),u_patternscale_b:new o.aP(S,c.u_patternscale_b),u_sdfgamma:new o.aJ(S,c.u_sdfgamma),u_image:new o.aI(S,c.u_image),u_tex_y_a:new o.aJ(S,c.u_tex_y_a),u_tex_y_b:new o.aJ(S,c.u_tex_y_b),u_mix:new o.aJ(S,c.u_mix)}),raster:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_tl_parent:new o.aP(S,c.u_tl_parent),u_scale_parent:new o.aJ(S,c.u_scale_parent),u_buffer_scale:new o.aJ(S,c.u_buffer_scale),u_fade_t:new o.aJ(S,c.u_fade_t),u_opacity:new o.aJ(S,c.u_opacity),u_image0:new o.aI(S,c.u_image0),u_image1:new o.aI(S,c.u_image1),u_brightness_low:new o.aJ(S,c.u_brightness_low),u_brightness_high:new o.aJ(S,c.u_brightness_high),u_saturation_factor:new o.aJ(S,c.u_saturation_factor),u_contrast_factor:new o.aJ(S,c.u_contrast_factor),u_spin_weights:new o.aO(S,c.u_spin_weights)}),symbolIcon:(S,c)=>({u_is_size_zoom_constant:new o.aI(S,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aI(S,c.u_is_size_feature_constant),u_size_t:new o.aJ(S,c.u_size_t),u_size:new o.aJ(S,c.u_size),u_camera_to_center_distance:new o.aJ(S,c.u_camera_to_center_distance),u_pitch:new o.aJ(S,c.u_pitch),u_rotate_symbol:new o.aI(S,c.u_rotate_symbol),u_aspect_ratio:new o.aJ(S,c.u_aspect_ratio),u_fade_change:new o.aJ(S,c.u_fade_change),u_matrix:new o.aK(S,c.u_matrix),u_label_plane_matrix:new o.aK(S,c.u_label_plane_matrix),u_coord_matrix:new o.aK(S,c.u_coord_matrix),u_is_text:new o.aI(S,c.u_is_text),u_pitch_with_map:new o.aI(S,c.u_pitch_with_map),u_is_along_line:new o.aI(S,c.u_is_along_line),u_is_variable_anchor:new o.aI(S,c.u_is_variable_anchor),u_texsize:new o.aP(S,c.u_texsize),u_texture:new o.aI(S,c.u_texture),u_translation:new o.aP(S,c.u_translation),u_pitched_scale:new o.aJ(S,c.u_pitched_scale)}),symbolSDF:(S,c)=>({u_is_size_zoom_constant:new o.aI(S,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aI(S,c.u_is_size_feature_constant),u_size_t:new o.aJ(S,c.u_size_t),u_size:new o.aJ(S,c.u_size),u_camera_to_center_distance:new o.aJ(S,c.u_camera_to_center_distance),u_pitch:new o.aJ(S,c.u_pitch),u_rotate_symbol:new o.aI(S,c.u_rotate_symbol),u_aspect_ratio:new o.aJ(S,c.u_aspect_ratio),u_fade_change:new o.aJ(S,c.u_fade_change),u_matrix:new o.aK(S,c.u_matrix),u_label_plane_matrix:new o.aK(S,c.u_label_plane_matrix),u_coord_matrix:new o.aK(S,c.u_coord_matrix),u_is_text:new o.aI(S,c.u_is_text),u_pitch_with_map:new o.aI(S,c.u_pitch_with_map),u_is_along_line:new o.aI(S,c.u_is_along_line),u_is_variable_anchor:new o.aI(S,c.u_is_variable_anchor),u_texsize:new o.aP(S,c.u_texsize),u_texture:new o.aI(S,c.u_texture),u_gamma_scale:new o.aJ(S,c.u_gamma_scale),u_device_pixel_ratio:new o.aJ(S,c.u_device_pixel_ratio),u_is_halo:new o.aI(S,c.u_is_halo),u_translation:new o.aP(S,c.u_translation),u_pitched_scale:new o.aJ(S,c.u_pitched_scale)}),symbolTextAndIcon:(S,c)=>({u_is_size_zoom_constant:new o.aI(S,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aI(S,c.u_is_size_feature_constant),u_size_t:new o.aJ(S,c.u_size_t),u_size:new o.aJ(S,c.u_size),u_camera_to_center_distance:new o.aJ(S,c.u_camera_to_center_distance),u_pitch:new o.aJ(S,c.u_pitch),u_rotate_symbol:new o.aI(S,c.u_rotate_symbol),u_aspect_ratio:new o.aJ(S,c.u_aspect_ratio),u_fade_change:new o.aJ(S,c.u_fade_change),u_matrix:new o.aK(S,c.u_matrix),u_label_plane_matrix:new o.aK(S,c.u_label_plane_matrix),u_coord_matrix:new o.aK(S,c.u_coord_matrix),u_is_text:new o.aI(S,c.u_is_text),u_pitch_with_map:new o.aI(S,c.u_pitch_with_map),u_is_along_line:new o.aI(S,c.u_is_along_line),u_is_variable_anchor:new o.aI(S,c.u_is_variable_anchor),u_texsize:new o.aP(S,c.u_texsize),u_texsize_icon:new o.aP(S,c.u_texsize_icon),u_texture:new o.aI(S,c.u_texture),u_texture_icon:new o.aI(S,c.u_texture_icon),u_gamma_scale:new o.aJ(S,c.u_gamma_scale),u_device_pixel_ratio:new o.aJ(S,c.u_device_pixel_ratio),u_is_halo:new o.aI(S,c.u_is_halo),u_translation:new o.aP(S,c.u_translation),u_pitched_scale:new o.aJ(S,c.u_pitched_scale)}),background:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_opacity:new o.aJ(S,c.u_opacity),u_color:new o.aM(S,c.u_color)}),backgroundPattern:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_opacity:new o.aJ(S,c.u_opacity),u_image:new o.aI(S,c.u_image),u_pattern_tl_a:new o.aP(S,c.u_pattern_tl_a),u_pattern_br_a:new o.aP(S,c.u_pattern_br_a),u_pattern_tl_b:new o.aP(S,c.u_pattern_tl_b),u_pattern_br_b:new o.aP(S,c.u_pattern_br_b),u_texsize:new o.aP(S,c.u_texsize),u_mix:new o.aJ(S,c.u_mix),u_pattern_size_a:new o.aP(S,c.u_pattern_size_a),u_pattern_size_b:new o.aP(S,c.u_pattern_size_b),u_scale_a:new o.aJ(S,c.u_scale_a),u_scale_b:new o.aJ(S,c.u_scale_b),u_pixel_coord_upper:new o.aP(S,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.aP(S,c.u_pixel_coord_lower),u_tile_units_to_pixels:new o.aJ(S,c.u_tile_units_to_pixels)}),terrain:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_texture:new o.aI(S,c.u_texture),u_ele_delta:new o.aJ(S,c.u_ele_delta),u_fog_matrix:new o.aK(S,c.u_fog_matrix),u_fog_color:new o.aM(S,c.u_fog_color),u_fog_ground_blend:new o.aJ(S,c.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.aJ(S,c.u_fog_ground_blend_opacity),u_horizon_color:new o.aM(S,c.u_horizon_color),u_horizon_fog_blend:new o.aJ(S,c.u_horizon_fog_blend)}),terrainDepth:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_ele_delta:new o.aJ(S,c.u_ele_delta)}),terrainCoords:(S,c)=>({u_matrix:new o.aK(S,c.u_matrix),u_texture:new o.aI(S,c.u_texture),u_terrain_coords_id:new o.aJ(S,c.u_terrain_coords_id),u_ele_delta:new o.aJ(S,c.u_ele_delta)}),sky:(S,c)=>({u_sky_color:new o.aM(S,c.u_sky_color),u_horizon_color:new o.aM(S,c.u_horizon_color),u_horizon:new o.aJ(S,c.u_horizon),u_sky_horizon_blend:new o.aJ(S,c.u_sky_horizon_blend)})};class Qa{constructor(c,f,_){this.context=c;const A=c.gl;this.buffer=A.createBuffer(),this.dynamicDraw=!!_,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),A.bufferData(A.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const f=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const bc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ws{constructor(c,f,_,A){this.length=f.length,this.attributes=_,this.itemSize=f.bytesPerElement,this.dynamicDraw=A,this.context=c;const g=c.gl;this.buffer=g.createBuffer(),c.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){if(c.length!==this.length)throw new Error(`Length of new data is ${c.length}, which doesn't match current length of ${this.length}`);const f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,f){for(let _=0;_<this.attributes.length;_++){const A=f.attributes[this.attributes[_].name];A!==void 0&&c.enableVertexAttribArray(A)}}setVertexAttribPointers(c,f,_){for(let A=0;A<this.attributes.length;A++){const g=this.attributes[A],w=f.attributes[g.name];w!==void 0&&c.vertexAttribPointer(w,g.components,c[bc[g.type]],!1,this.itemSize,g.offset+this.itemSize*(_||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ou=new WeakMap;function za(S){var c;if(ou.has(S))return ou.get(S);{const f=(c=S.getParameter(S.VERSION))===null||c===void 0?void 0:c.startsWith("WebGL 2.0");return ou.set(S,f),f}}class on{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class vl extends on{getDefault(){return o.aN.transparent}set(c){const f=this.current;(c.r!==f.r||c.g!==f.g||c.b!==f.b||c.a!==f.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class Ha extends on{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class Vo extends on{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class Sd extends on{getDefault(){return[!0,!0,!0,!0]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||c[3]!==f[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Js extends on{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class Go extends on{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class au extends on{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const f=this.current;(c.func!==f.func||c.ref!==f.ref||c.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class wc extends on{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class Ah extends on{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=c,this.dirty=!1}}class bl extends on{getDefault(){return[0,1]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class hh extends on{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=c,this.dirty=!1}}class lu extends on{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class cu extends on{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.BLEND):f.disable(f.BLEND),this.current=c,this.dirty=!1}}class oA extends on{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class yo extends on{getDefault(){return o.aN.transparent}set(c){const f=this.current;(c.r!==f.r||c.g!==f.g||c.b!==f.b||c.a!==f.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class uu extends on{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class aA extends on{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=c,this.dirty=!1}}class dh extends on{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class fh extends on{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}class fa extends on{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}}class xc extends on{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class wl extends on{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||c[3]!==f[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class xl extends on{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class lA extends on{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class D extends on{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindTexture(f.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class nt extends on{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class Lt extends on{getDefault(){return null}set(c){const f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class Ht extends on{getDefault(){return null}set(c){var f;if(c===this.current&&!this.dirty)return;const _=this.gl;za(_)?_.bindVertexArray(c):(f=_.getExtension("OES_vertex_array_object"))===null||f===void 0||f.bindVertexArrayOES(c),this.current=c,this.dirty=!1}}class ne extends on{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class ge extends on{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class Fe extends on{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class tr extends on{constructor(c,f){super(c),this.context=c,this.parent=f}getDefault(){return null}}class Fr extends tr{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class Kr extends tr{set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class Yr extends tr{set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class hn{constructor(c,f,_,A,g){this.context=c,this.width=f,this.height=_;const w=c.gl,B=this.framebuffer=w.createFramebuffer();if(this.colorAttachment=new Fr(c,B),A)this.depthAttachment=g?new Yr(c,B):new Kr(c,B);else if(g)throw new Error("Stencil cannot be set without depth");if(w.checkFramebufferStatus(w.FRAMEBUFFER)!==w.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const c=this.context.gl,f=this.colorAttachment.get();if(f&&c.deleteTexture(f),this.depthAttachment){const _=this.depthAttachment.get();_&&c.deleteRenderbuffer(_)}c.deleteFramebuffer(this.framebuffer)}}class kr{constructor(c,f,_){this.blendFunction=c,this.blendColor=f,this.mask=_}}kr.Replace=[1,0],kr.disabled=new kr(kr.Replace,o.aN.transparent,[!1,!1,!1,!1]),kr.unblended=new kr(kr.Replace,o.aN.transparent,[!0,!0,!0,!0]),kr.alphaBlended=new kr([1,771],o.aN.transparent,[!0,!0,!0,!0]);class di{constructor(c){var f,_;if(this.gl=c,this.clearColor=new vl(this),this.clearDepth=new Ha(this),this.clearStencil=new Vo(this),this.colorMask=new Sd(this),this.depthMask=new Js(this),this.stencilMask=new Go(this),this.stencilFunc=new au(this),this.stencilOp=new wc(this),this.stencilTest=new Ah(this),this.depthRange=new bl(this),this.depthTest=new hh(this),this.depthFunc=new lu(this),this.blend=new cu(this),this.blendFunc=new oA(this),this.blendColor=new yo(this),this.blendEquation=new uu(this),this.cullFace=new aA(this),this.cullFaceSide=new dh(this),this.frontFace=new fh(this),this.program=new fa(this),this.activeTexture=new xc(this),this.viewport=new wl(this),this.bindFramebuffer=new xl(this),this.bindRenderbuffer=new lA(this),this.bindTexture=new D(this),this.bindVertexBuffer=new nt(this),this.bindElementBuffer=new Lt(this),this.bindVertexArray=new Ht(this),this.pixelStoreUnpack=new ne(this),this.pixelStoreUnpackPremultiplyAlpha=new ge(this),this.pixelStoreUnpackFlipY=new Fe(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE),za(c)){this.HALF_FLOAT=c.HALF_FLOAT;const A=c.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(f=c.RGBA16F)!==null&&f!==void 0?f:A==null?void 0:A.RGBA16F_EXT,this.RGB16F=(_=c.RGB16F)!==null&&_!==void 0?_:A==null?void 0:A.RGB16F_EXT,c.getExtension("EXT_color_buffer_float")}else{c.getExtension("EXT_color_buffer_half_float"),c.getExtension("OES_texture_half_float_linear");const A=c.getExtension("OES_texture_half_float");this.HALF_FLOAT=A==null?void 0:A.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,f){return new Qa(this,c,f)}createVertexBuffer(c,f,_){return new ws(this,c,f,_)}createRenderbuffer(c,f,_){const A=this.gl,g=A.createRenderbuffer();return this.bindRenderbuffer.set(g),A.renderbufferStorage(A.RENDERBUFFER,c,f,_),this.bindRenderbuffer.set(null),g}createFramebuffer(c,f,_,A){return new hn(this,c,f,_,A)}clear(c){let{color:f,depth:_,stencil:A}=c;const g=this.gl;let w=0;f&&(w|=g.COLOR_BUFFER_BIT,this.clearColor.set(f),this.colorMask.set([!0,!0,!0,!0])),_!==void 0&&(w|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(_),this.depthMask.set(!0)),A!==void 0&&(w|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(A),this.stencilMask.set(255)),g.clear(w)}setCullFace(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){o.aF(c.blendFunction,kr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}createVertexArray(){var c;return za(this.gl)?this.gl.createVertexArray():(c=this.gl.getExtension("OES_vertex_array_object"))===null||c===void 0?void 0:c.createVertexArrayOES()}deleteVertexArray(c){var f;return za(this.gl)?this.gl.deleteVertexArray(c):(f=this.gl.getExtension("OES_vertex_array_object"))===null||f===void 0?void 0:f.deleteVertexArrayOES(c)}unbindVAO(){this.bindVertexArray.set(null)}}class Cr{constructor(c,f,_){this.func=c,this.mask=f,this.range=_}}Cr.ReadOnly=!1,Cr.ReadWrite=!0,Cr.disabled=new Cr(519,Cr.ReadOnly,[0,1]);const Hi=7680;class Xr{constructor(c,f,_,A,g,w){this.test=c,this.ref=f,this.mask=_,this.fail=A,this.depthFail=g,this.pass=w}}Xr.disabled=new Xr({func:519,mask:0},0,0,Hi,Hi,Hi);class dn{constructor(c,f,_){this.enable=c,this.mode=f,this.frontFace=_}}let hs;function pa(S,c,f,_,A){const g=S.context,w=g.gl,B=S.useProgram("collisionBox"),I=[];let L=0,R=0;for(let Z=0;Z<_.length;Z++){const yt=_[Z],at=c.getTile(yt).getBucket(f);if(!at)continue;const lt=A?at.textCollisionBox:at.iconCollisionBox,At=at.collisionCircleArray;if(At.length>0){const Et=o.H();o.aR(Et,at.placementInvProjMatrix,S.transform.glCoordMatrix),o.aR(Et,Et,at.placementViewportMatrix),I.push({circleArray:At,circleOffset:R,transform:yt.posMatrix,invTransform:Et,coord:yt}),L+=At.length/4,R=L}lt&&B.draw(g,w.LINES,Cr.disabled,Xr.disabled,S.colorModeForRenderPass(),dn.disabled,{u_matrix:yt.posMatrix,u_pixel_extrude_scale:[1/(O=S.transform).width,1/O.height]},S.style.map.terrain&&S.style.map.terrain.getTerrainData(yt),f.id,lt.layoutVertexBuffer,lt.indexBuffer,lt.segments,null,S.transform.zoom,null,null,lt.collisionVertexBuffer)}var O;if(!A||!I.length)return;const N=S.useProgram("collisionCircle"),H=new o.aS;H.resize(4*L),H._trim();let K=0;for(const Z of I)for(let yt=0;yt<Z.circleArray.length/4;yt++){const at=4*yt,lt=Z.circleArray[at+0],At=Z.circleArray[at+1],Et=Z.circleArray[at+2],Dt=Z.circleArray[at+3];H.emplace(K++,lt,At,Et,Dt,0),H.emplace(K++,lt,At,Et,Dt,1),H.emplace(K++,lt,At,Et,Dt,2),H.emplace(K++,lt,At,Et,Dt,3)}(!hs||hs.length<2*L)&&(hs=function(Z){const yt=2*Z,at=new o.aU;at.resize(yt),at._trim();for(let lt=0;lt<yt;lt++){const At=6*lt;at.uint16[At+0]=4*lt+0,at.uint16[At+1]=4*lt+1,at.uint16[At+2]=4*lt+2,at.uint16[At+3]=4*lt+2,at.uint16[At+4]=4*lt+3,at.uint16[At+5]=4*lt+0}return at}(L));const et=g.createIndexBuffer(hs,!0),Y=g.createVertexBuffer(H,o.aT.members,!0);for(const Z of I){const yt=Fi(Z.transform,Z.invTransform,S.transform);N.draw(g,w.TRIANGLES,Cr.disabled,Xr.disabled,S.colorModeForRenderPass(),dn.disabled,yt,S.style.map.terrain&&S.style.map.terrain.getTerrainData(Z.coord),f.id,Y,et,o.a0.simpleSegment(0,2*Z.circleOffset,Z.circleArray.length,Z.circleArray.length/2),null,S.transform.zoom,null,null,null)}Y.destroy(),et.destroy()}dn.disabled=new dn(!1,1029,2305),dn.backCCW=new dn(!0,1029,2305);const Au=o.ao(new Float32Array(16));function Bl(S,c,f,_,A,g){const{horizontalAlign:w,verticalAlign:B}=o.av(S);return new o.P((-(w-.5)*c/A+_[0])*g,(-(B-.5)*f/A+_[1])*g)}function Cl(S,c,f,_,A,g){const w=c.tileAnchorPoint.add(new o.P(c.translation[0],c.translation[1]));if(c.pitchWithMap){let B=_.mult(g);return f||(B=B.rotate(-A)),Ct(w.add(B),c.labelPlaneMatrix,c.getElevation).point}if(f){const B=ae(c.tileAnchorPoint.x+1,c.tileAnchorPoint.y,c).point.sub(S),I=Math.atan(B.y/B.x)+(B.x<0?Math.PI:0);return S.add(_.rotate(I))}return S.add(_)}function Va(S,c,f,_,A,g,w,B,I,L,R,O,N,H){const K=S.text.placedSymbolArray,et=S.text.dynamicLayoutVertexArray,Y=S.icon.dynamicLayoutVertexArray,Z={};et.clear();for(let yt=0;yt<K.length;yt++){const at=K.get(yt),lt=at.hidden||!at.crossTileID||S.allowVerticalPlacement&&!at.placedOrientation?null:_[at.crossTileID];if(lt){const At=new o.P(at.anchorX,at.anchorY),Et={getElevation:H,width:A.width,height:A.height,labelPlaneMatrix:g,lineVertexArray:null,pitchWithMap:f,projection:R,projectionCache:null,tileAnchorPoint:At,translation:O,unwrappedTileID:N},Dt=f?Ct(At,w,H):ae(At.x,At.y,Et),zt=W(A.cameraToCenterDistance,Dt.signedDistanceFromCamera);let ue=o.aj(S.textSizeData,I,at)*zt/o.aq;f&&(ue*=S.tilePixelRatio/B);const{width:oe,height:ce,anchor:ie,textOffset:Pe,textBoxScale:We}=lt,_e=Bl(ie,oe,ce,Pe,We,ue),be=R.getPitchedTextCorrection(A,At.add(new o.P(O[0],O[1])),N),Xe=Cl(Dt.point,Et,c,_e,A.angle,be),Rr=S.allowVerticalPlacement&&at.placedOrientation===o.ai.vertical?Math.PI/2:0;for(let He=0;He<at.numGlyphs;He++)o.ak(et,Xe,Rr);L&&at.associatedIconIndex>=0&&(Z[at.associatedIconIndex]={shiftedAnchor:Xe,angle:Rr})}else nr(at.numGlyphs,et)}if(L){Y.clear();const yt=S.icon.placedSymbolArray;for(let at=0;at<yt.length;at++){const lt=yt.get(at);if(lt.hidden)nr(lt.numGlyphs,Y);else{const At=Z[at];if(At)for(let Et=0;Et<lt.numGlyphs;Et++)o.ak(Y,At.shiftedAnchor,At.angle);else nr(lt.numGlyphs,Y)}}S.icon.dynamicLayoutVertexBuffer.updateData(Y)}S.text.dynamicLayoutVertexBuffer.updateData(et)}function Bc(S,c,f){return f.iconsInText&&c?"symbolTextAndIcon":S?"symbolSDF":"symbolIcon"}function _o(S,c,f,_,A,g,w,B,I,L,R,O){const N=S.context,H=N.gl,K=S.transform,et=Da(),Y=B==="map",Z=I==="map",yt=B!=="viewport"&&f.layout.get("symbol-placement")!=="point",at=Y&&!Z&&!yt,lt=!Z&&yt,At=!f.layout.get("symbol-sort-key").isConstant();let Et=!1;const Dt=S.depthModeForSublayer(0,Cr.ReadOnly),zt=f._unevaluatedLayout.hasValue("text-variable-anchor")||f._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ue=[],oe=et.getCircleRadiusCorrection(K);for(const ce of _){const ie=c.getTile(ce),Pe=ie.getBucket(f);if(!Pe)continue;const We=A?Pe.text:Pe.icon;if(!We||!We.segments.get().length||!We.hasVisibleVertices)continue;const _e=We.programConfigurations.get(f.id),be=A||Pe.sdfIcons,Xe=A?Pe.textSizeData:Pe.iconSizeData,Rr=Z||K.pitch!==0,He=S.useProgram(Bc(be,A,Pe),_e),Sr=o.ah(Xe,K.zoom),an=S.style.map.terrain&&S.style.map.terrain.getTerrainData(ce);let pn,oi,Mr,Xn,Vn=[0,0],bn=null;if(A)oi=ie.glyphAtlasTexture,Mr=H.LINEAR,pn=ie.glyphAtlasTexture.size,Pe.iconsInText&&(Vn=ie.imageAtlasTexture.size,bn=ie.imageAtlasTexture,Xn=Rr||S.options.rotating||S.options.zooming||Xe.kind==="composite"||Xe.kind==="camera"?H.LINEAR:H.NEAREST);else{const Gn=f.layout.get("icon-size").constantOr(0)!==1||Pe.iconsNeedLinear;oi=ie.imageAtlasTexture,Mr=be||S.options.rotating||S.options.zooming||Gn||Rr?H.LINEAR:H.NEAREST,pn=ie.imageAtlasTexture.size}const xn=pr(ie,1,S.transform.zoom),ei=lt?ce.posMatrix:Au,Gi=vn(ei,Z,Y,S.transform,xn),no=ln(ei,Z,Y,S.transform,xn),pi=ln(ce.posMatrix,Z,Y,S.transform,xn),Is=et.translatePosition(S.transform,ie,g,w),_a=zt&&Pe.hasTextData(),Nl=f.layout.get("icon-text-fit")!=="none"&&_a&&Pe.hasIconData();if(yt){const Gn=S.style.map.terrain?(kl,li)=>S.style.map.terrain.getElevation(ce,kl,li):null,ds=f.layout.get("text-rotation-alignment")==="map";ft(Pe,ce.posMatrix,S,A,Gi,pi,Z,L,ds,et,ce.toUnwrapped(),K.width,K.height,Is,Gn)}const ai=ce.posMatrix,Bn=A&&zt||Nl,va=yt||Bn?Au:Gi,Tc=no,is=be&&f.paint.get(A?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ui;Ui=be?Pe.iconsInText?sA(Xe.kind,Sr,at,Z,yt,Bn,S,ai,va,Tc,Is,pn,Vn,oe):uh(Xe.kind,Sr,at,Z,yt,Bn,S,ai,va,Tc,Is,A,pn,!0,oe):ch(Xe.kind,Sr,at,Z,yt,Bn,S,ai,va,Tc,Is,A,pn,oe);const wi={program:He,buffers:We,uniformValues:Ui,atlasTexture:oi,atlasTextureIcon:bn,atlasInterpolation:Mr,atlasInterpolationIcon:Xn,isSDF:be,hasHalo:is};if(At&&Pe.canOverlap){Et=!0;const Gn=We.segments.get();for(const ds of Gn)ue.push({segments:new o.a0([ds]),sortKey:ds.sortKey,state:wi,terrainData:an})}else ue.push({segments:We.segments,sortKey:0,state:wi,terrainData:an})}Et&&ue.sort((ce,ie)=>ce.sortKey-ie.sortKey);for(const ce of ue){const ie=ce.state;if(N.activeTexture.set(H.TEXTURE0),ie.atlasTexture.bind(ie.atlasInterpolation,H.CLAMP_TO_EDGE),ie.atlasTextureIcon&&(N.activeTexture.set(H.TEXTURE1),ie.atlasTextureIcon&&ie.atlasTextureIcon.bind(ie.atlasInterpolationIcon,H.CLAMP_TO_EDGE)),ie.isSDF){const Pe=ie.uniformValues;ie.hasHalo&&(Pe.u_is_halo=1,vo(ie.buffers,ce.segments,f,S,ie.program,Dt,R,O,Pe,ce.terrainData)),Pe.u_is_halo=0}vo(ie.buffers,ce.segments,f,S,ie.program,Dt,R,O,ie.uniformValues,ce.terrainData)}}function vo(S,c,f,_,A,g,w,B,I,L){const R=_.context;A.draw(R,R.gl.TRIANGLES,g,w,B,dn.disabled,I,L,f.id,S.layoutVertexBuffer,S.indexBuffer,c,f.paint,_.transform.zoom,S.programConfigurations.get(f.id),S.dynamicLayoutVertexBuffer,S.opacityVertexBuffer)}function Wn(S,c,f,_,A){if(!f||!_||!_.imageAtlas)return;const g=_.imageAtlas.patternPositions;let w=g[f.to.toString()],B=g[f.from.toString()];if(!w&&B&&(w=B),!B&&w&&(B=w),!w||!B){const I=A.getPaintProperty(c);w=g[I],B=g[I]}w&&B&&S.setConstantPatternPositions(w,B)}function El(S,c,f,_,A,g,w){const B=S.context.gl,I="fill-pattern",L=f.paint.get(I),R=L&&L.constantOr(1),O=f.getCrossfadeParameters();let N,H,K,et,Y;w?(H=R&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=B.LINES):(H=R?"fillPattern":"fill",N=B.TRIANGLES);const Z=L.constantOr(null);for(const yt of _){const at=c.getTile(yt);if(R&&!at.patternsLoaded())continue;const lt=at.getBucket(f);if(!lt)continue;const At=lt.programConfigurations.get(f.id),Et=S.useProgram(H,At),Dt=S.style.map.terrain&&S.style.map.terrain.getTerrainData(yt);R&&(S.context.activeTexture.set(B.TEXTURE0),at.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),At.updatePaintBuffers(O)),Wn(At,I,Z,at,f);const zt=Dt?yt:null,ue=S.translatePosMatrix(zt?zt.posMatrix:yt.posMatrix,at,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor"));if(w){et=lt.indexBuffer2,Y=lt.segments2;const oe=[B.drawingBufferWidth,B.drawingBufferHeight];K=H==="fillOutlinePattern"&&R?Zn(ue,S,O,at,oe):zr(ue,oe)}else et=lt.indexBuffer,Y=lt.segments,K=R?Ze(ue,S,O,at):Ie(ue);Et.draw(S.context,N,A,S.stencilModeForClipping(yt),g,dn.disabled,K,Dt,f.id,lt.layoutVertexBuffer,et,Y,f.paint,S.transform.zoom,At)}}function Ga(S,c,f,_,A,g,w){const B=S.context,I=B.gl,L="fill-extrusion-pattern",R=f.paint.get(L),O=R.constantOr(1),N=f.getCrossfadeParameters(),H=f.paint.get("fill-extrusion-opacity"),K=R.constantOr(null);for(const et of _){const Y=c.getTile(et),Z=Y.getBucket(f);if(!Z)continue;const yt=S.style.map.terrain&&S.style.map.terrain.getTerrainData(et),at=Z.programConfigurations.get(f.id),lt=S.useProgram(O?"fillExtrusionPattern":"fillExtrusion",at);O&&(S.context.activeTexture.set(I.TEXTURE0),Y.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),at.updatePaintBuffers(N)),Wn(at,L,K,Y,f);const At=S.translatePosMatrix(et.posMatrix,Y,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),Et=f.paint.get("fill-extrusion-vertical-gradient"),Dt=O?le(At,S,Et,H,et,N,Y):Nt(At,S,Et,H);lt.draw(B,B.gl.TRIANGLES,A,g,w,dn.backCCW,Dt,yt,f.id,Z.layoutVertexBuffer,Z.indexBuffer,Z.segments,f.paint,S.transform.zoom,at,S.style.map.terrain&&Z.centroidVertexBuffer)}}function Sl(S,c,f,_,A,g,w){const B=S.context,I=B.gl,L=f.fbo;if(!L)return;const R=S.useProgram("hillshade"),O=S.style.map.terrain&&S.style.map.terrain.getTerrainData(c);B.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,L.colorAttachment.get()),R.draw(B,I.TRIANGLES,A,g,w,dn.disabled,((N,H,K,et)=>{const Y=K.paint.get("hillshade-shadow-color"),Z=K.paint.get("hillshade-highlight-color"),yt=K.paint.get("hillshade-accent-color");let at=K.paint.get("hillshade-illumination-direction")*(Math.PI/180);K.paint.get("hillshade-illumination-anchor")==="viewport"&&(at-=N.transform.angle);const lt=!N.options.moving;return{u_matrix:et?et.posMatrix:N.transform.calculatePosMatrix(H.tileID.toUnwrapped(),lt),u_image:0,u_latrange:Ir(0,H.tileID),u_light:[K.paint.get("hillshade-exaggeration"),at],u_shadow:Y,u_highlight:Z,u_accent:yt}})(S,f,_,O?c:null),O,_.id,S.rasterBoundsBuffer,S.quadTriangleIndexBuffer,S.rasterBoundsSegments)}function jo(S,c,f,_,A,g){const w=S.context,B=w.gl,I=c.dem;if(I&&I.data){const L=I.dim,R=I.stride,O=I.getPixels();if(w.activeTexture.set(B.TEXTURE1),w.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||S.getTileTexture(R),c.demTexture){const H=c.demTexture;H.update(O,{premultiply:!1}),H.bind(B.NEAREST,B.CLAMP_TO_EDGE)}else c.demTexture=new ot(w,O,B.RGBA,{premultiply:!1}),c.demTexture.bind(B.NEAREST,B.CLAMP_TO_EDGE);w.activeTexture.set(B.TEXTURE0);let N=c.fbo;if(!N){const H=new ot(w,{width:L,height:L,data:null},B.RGBA);H.bind(B.LINEAR,B.CLAMP_TO_EDGE),N=c.fbo=w.createFramebuffer(L,L,!0,!1),N.colorAttachment.set(H.texture)}w.bindFramebuffer.set(N.framebuffer),w.viewport.set([0,0,L,L]),S.useProgram("hillshadePrepare").draw(w,B.TRIANGLES,_,A,g,dn.disabled,((H,K)=>{const et=K.stride,Y=o.H();return o.aQ(Y,0,o.X,-o.X,0,0,1),o.J(Y,Y,[0,-o.X,0]),{u_matrix:Y,u_image:1,u_dimension:[et,et],u_zoom:H.overscaledZ,u_unpack:K.getUnpackVector()}})(c.tileID,I),null,f.id,S.rasterBoundsBuffer,S.quadTriangleIndexBuffer,S.rasterBoundsSegments),c.needsHillshadePrepare=!1}}function es(S,c,f,_,A,g){const w=_.paint.get("raster-fade-duration");if(!g&&w>0){const B=b.now(),I=(B-S.timeAdded)/w,L=c?(B-c.timeAdded)/w:-1,R=f.getSource(),O=A.coveringZoomLevel({tileSize:R.tileSize,roundZoom:R.roundZoom}),N=!c||Math.abs(c.tileID.overscaledZ-O)>Math.abs(S.tileID.overscaledZ-O),H=N&&S.refreshedUponExpiration?1:o.ad(N?I:1-L,0,1);return S.refreshedUponExpiration&&I>=1&&(S.refreshedUponExpiration=!1),c?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}const hu=new o.aN(1,0,0,1),ja=new o.aN(0,1,0,1),Cc=new o.aN(0,0,1,1),bo=new o.aN(1,0,1,1),ga=new o.aN(0,1,1,1);function qa(S,c,f,_){Ys(S,0,c+f/2,S.transform.width,f,_)}function cA(S,c,f,_){Ys(S,c-f/2,0,f,S.transform.height,_)}function Ys(S,c,f,_,A,g){const w=S.context,B=w.gl;B.enable(B.SCISSOR_TEST),B.scissor(c*S.pixelRatio,f*S.pixelRatio,_*S.pixelRatio,A*S.pixelRatio),w.clear({color:g}),B.disable(B.SCISSOR_TEST)}function $r(S,c,f){const _=S.context,A=_.gl,g=f.posMatrix,w=S.useProgram("debug"),B=Cr.disabled,I=Xr.disabled,L=S.colorModeForRenderPass(),R="$debug",O=S.style.map.terrain&&S.style.map.terrain.getTerrainData(f);_.activeTexture.set(A.TEXTURE0);const N=c.getTileByID(f.key).latestRawTileData,H=Math.floor((N&&N.byteLength||0)/1024),K=c.getTile(f).tileSize,et=512/Math.min(K,512)*(f.overscaledZ/S.transform.zoom)*.5;let Y=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(Y+=` => ${f.overscaledZ}`),function(Z,yt){Z.initDebugOverlayCanvas();const at=Z.debugOverlayCanvas,lt=Z.context.gl,At=Z.debugOverlayCanvas.getContext("2d");At.clearRect(0,0,at.width,at.height),At.shadowColor="white",At.shadowBlur=2,At.lineWidth=1.5,At.strokeStyle="white",At.textBaseline="top",At.font="bold 36px Open Sans, sans-serif",At.fillText(yt,5,5),At.strokeText(yt,5,5),Z.debugOverlayTexture.update(at),Z.debugOverlayTexture.bind(lt.LINEAR,lt.CLAMP_TO_EDGE)}(S,`${Y} ${H}kB`),w.draw(_,A.TRIANGLES,B,I,kr.alphaBlended,dn.disabled,yn(g,o.aN.transparent,et),null,R,S.debugBuffer,S.quadTriangleIndexBuffer,S.debugSegments),w.draw(_,A.LINE_STRIP,B,I,L,dn.disabled,yn(g,o.aN.red),O,R,S.debugBuffer,S.tileBorderIndexBuffer,S.debugSegments)}function xs(S,c,f){const _=S.context,A=_.gl,g=S.colorModeForRenderPass(),w=new Cr(A.LEQUAL,Cr.ReadWrite,S.depthRangeFor3D),B=S.useProgram("terrain"),I=c.getTerrainMesh();_.bindFramebuffer.set(null),_.viewport.set([0,0,S.width,S.height]);for(const L of f){const R=S.renderToTexture.getTexture(L),O=c.getTerrainData(L.tileID);_.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,R.texture);const N=S.transform.calculatePosMatrix(L.tileID.toUnwrapped()),H=c.getMeshFrameDelta(S.transform.zoom),K=S.transform.calculateFogMatrix(L.tileID.toUnwrapped()),et=_l(N,H,K,S.style.sky,S.transform.pitch);B.draw(_,A.TRIANGLES,w,Xr.disabled,g,dn.backCCW,et,O,"terrain",I.vertexBuffer,I.indexBuffer,I.segments)}}class Ka{constructor(c,f,_){this.vertexBuffer=c,this.indexBuffer=f,this.segments=_}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class qo{constructor(c,f){this.context=new di(c),this.transform=f,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.ao(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ne.maxUnderzooming+Ne.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ti}resize(c,f,_){if(this.width=Math.floor(c*_),this.height=Math.floor(f*_),this.pixelRatio=_,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const A of this.style._order)this.style._layers[A].resize()}setup(){const c=this.context,f=new o.aX;f.emplaceBack(0,0),f.emplaceBack(o.X,0),f.emplaceBack(0,o.X),f.emplaceBack(o.X,o.X),this.tileExtentBuffer=c.createVertexBuffer(f,Ii.members),this.tileExtentSegments=o.a0.simpleSegment(0,0,4,2);const _=new o.aX;_.emplaceBack(0,0),_.emplaceBack(o.X,0),_.emplaceBack(0,o.X),_.emplaceBack(o.X,o.X),this.debugBuffer=c.createVertexBuffer(_,Ii.members),this.debugSegments=o.a0.simpleSegment(0,0,4,5);const A=new o.$;A.emplaceBack(0,0,0,0),A.emplaceBack(o.X,0,o.X,0),A.emplaceBack(0,o.X,0,o.X),A.emplaceBack(o.X,o.X,o.X,o.X),this.rasterBoundsBuffer=c.createVertexBuffer(A,Ue.members),this.rasterBoundsSegments=o.a0.simpleSegment(0,0,4,2);const g=new o.aX;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(g,Ii.members),this.viewportSegments=o.a0.simpleSegment(0,0,4,2);const w=new o.aZ;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=c.createIndexBuffer(w);const B=new o.aY;B.emplaceBack(0,1,2),B.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(B);const I=this.context.gl;this.stencilClearMode=new Xr({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO)}clearStencil(){const c=this.context,f=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const _=o.H();o.aQ(_,0,this.width,this.height,0,0,1),o.K(_,_,[f.drawingBufferWidth,f.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(c,f.TRIANGLES,Cr.disabled,this.stencilClearMode,kr.disabled,dn.disabled,yc(_),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(c,f){if(this.currentStencilSource===c.source||!c.isTileClipped()||!f||!f.length)return;this.currentStencilSource=c.source;const _=this.context,A=_.gl;this.nextStencilID+f.length>256&&this.clearStencil(),_.setColorMode(kr.disabled),_.setDepthMode(Cr.disabled);const g=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const w of f){const B=this._tileClippingMaskIDs[w.key]=this.nextStencilID++,I=this.style.map.terrain&&this.style.map.terrain.getTerrainData(w);g.draw(_,A.TRIANGLES,Cr.disabled,new Xr({func:A.ALWAYS,mask:0},B,255,A.KEEP,A.KEEP,A.REPLACE),kr.disabled,dn.disabled,yc(w.posMatrix),I,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,f=this.context.gl;return new Xr({func:f.NOTEQUAL,mask:255},c,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(c){const f=this.context.gl;return new Xr({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,f.KEEP,f.KEEP,f.REPLACE)}stencilConfigForOverlap(c){const f=this.context.gl,_=c.sort((w,B)=>B.overscaledZ-w.overscaledZ),A=_[_.length-1].overscaledZ,g=_[0].overscaledZ-A+1;if(g>1){this.currentStencilSource=void 0,this.nextStencilID+g>256&&this.clearStencil();const w={};for(let B=0;B<g;B++)w[B+A]=new Xr({func:f.GEQUAL,mask:255},B+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=g,[w,_]}return[{[A]:Xr.disabled},_]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new kr([c.CONSTANT_COLOR,c.ONE],new o.aN(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?kr.unblended:kr.alphaBlended}depthModeForSublayer(c,f,_){if(!this.opaquePassEnabledForLayer())return Cr.disabled;const A=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new Cr(_||this.context.gl.LEQUAL,f,[A,A])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,f){this.style=c,this.options=f,this.lineAtlas=c.lineAtlas,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(b.now()),this.imageManager.beginFrame();const _=this.style._order,A=this.style.sourceCaches,g={},w={},B={};for(const I in A){const L=A[I];L.used&&L.prepare(this.context),g[I]=L.getVisibleCoordinates(),w[I]=g[I].slice().reverse(),B[I]=L.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let I=0;I<_.length;I++)if(this.style._layers[_[I]].is3D()){this.opaquePassCutoff=I;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const I of _){const L=this.style._layers[I];if(!L.hasOffscreenPass()||L.isHidden(this.transform.zoom))continue;const R=w[L.source];(L.type==="custom"||R.length)&&this.renderLayer(this,A[L.source],L,R)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:f.showOverdrawInspector?o.aN.black:o.aN.transparent,depth:1}),this.clearStencil(),this.style.stylesheet.sky&&function(I,L){const R=I.context,O=R.gl,N=((Z,yt,at)=>({u_sky_color:Z.properties.get("sky-color"),u_horizon_color:Z.properties.get("horizon-color"),u_horizon:(yt.height/2+yt.getHorizon())*at,u_sky_horizon_blend:Z.properties.get("sky-horizon-blend")*yt.height/2*at}))(L,I.style.map.transform,I.pixelRatio),H=new Cr(O.LEQUAL,Cr.ReadWrite,[0,1]),K=Xr.disabled,et=I.colorModeForRenderPass(),Y=I.useProgram("sky");if(!L.mesh){const Z=new o.aX;Z.emplaceBack(-1,-1),Z.emplaceBack(1,-1),Z.emplaceBack(1,1),Z.emplaceBack(-1,1);const yt=new o.aY;yt.emplaceBack(0,1,2),yt.emplaceBack(0,2,3),L.mesh=new Ka(R.createVertexBuffer(Z,Ii.members),R.createIndexBuffer(yt),o.a0.simpleSegment(0,0,Z.length,yt.length))}Y.draw(R,O.TRIANGLES,H,K,et,dn.disabled,N,void 0,"sky",L.mesh.vertexBuffer,L.mesh.indexBuffer,L.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=f.showOverdrawInspector,this.depthRangeFor3D=[0,1-(c._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const I=this.style._layers[_[this.currentLayer]],L=A[I.source],R=g[I.source];this._renderTileClippingMasks(I,R),this.renderLayer(this,L,I,R)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const I=this.style._layers[_[this.currentLayer]],L=A[I.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(I))continue;const R=(I.type==="symbol"?B:w)[I.source];this._renderTileClippingMasks(I,g[I.source]),this.renderLayer(this,L,I,R)}if(this.options.showTileBoundaries){const I=function(L,R){let O=null;const N=Object.values(L._layers).flatMap(Y=>Y.source&&!Y.isHidden(R)?[L.sourceCaches[Y.source]]:[]),H=N.filter(Y=>Y.getSource().type==="vector"),K=N.filter(Y=>Y.getSource().type!=="vector"),et=Y=>{(!O||O.getSource().maxzoom<Y.getSource().maxzoom)&&(O=Y)};return H.forEach(Y=>et(Y)),O||K.forEach(Y=>et(Y)),O}(this.style,this.transform.zoom);I&&function(L,R,O){for(let N=0;N<O.length;N++)$r(L,R,O[N])}(this,I,I.getVisibleCoordinates())}this.options.showPadding&&function(I){const L=I.transform.padding;qa(I,I.transform.height-(L.top||0),3,hu),qa(I,L.bottom||0,3,ja),cA(I,L.left||0,3,Cc),cA(I,I.transform.width-(L.right||0),3,bo);const R=I.transform.centerPoint;(function(O,N,H,K){Ys(O,N-1,H-10,2,20,K),Ys(O,N-10,H-1,20,2,K)})(I,R.x,I.transform.height-R.y,ga)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(c){if(!this.style||!this.style.map||!this.style.map.terrain)return;const f=this.terrainFacilitator.matrix,_=this.transform.modelViewProjectionMatrix;let A=this.terrainFacilitator.dirty;A||(A=c?!o.a_(f,_):!o.a$(f,_)),A||(A=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),A&&(o.b0(f,_),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(g,w){const B=g.context,I=B.gl,L=kr.unblended,R=new Cr(I.LEQUAL,Cr.ReadWrite,[0,1]),O=w.getTerrainMesh(),N=w.sourceCache.getRenderableTiles(),H=g.useProgram("terrainDepth");B.bindFramebuffer.set(w.getFramebuffer("depth").framebuffer),B.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),B.clear({color:o.aN.transparent,depth:1});for(const K of N){const et=w.getTerrainData(K.tileID),Y={u_matrix:g.transform.calculatePosMatrix(K.tileID.toUnwrapped()),u_ele_delta:w.getMeshFrameDelta(g.transform.zoom)};H.draw(B,I.TRIANGLES,R,Xr.disabled,L,dn.backCCW,Y,et,"terrain",O.vertexBuffer,O.indexBuffer,O.segments)}B.bindFramebuffer.set(null),B.viewport.set([0,0,g.width,g.height])}(this,this.style.map.terrain),function(g,w){const B=g.context,I=B.gl,L=kr.unblended,R=new Cr(I.LEQUAL,Cr.ReadWrite,[0,1]),O=w.getTerrainMesh(),N=w.getCoordsTexture(),H=w.sourceCache.getRenderableTiles(),K=g.useProgram("terrainCoords");B.bindFramebuffer.set(w.getFramebuffer("coords").framebuffer),B.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),B.clear({color:o.aN.transparent,depth:1}),w.coordsIndex=[];for(const et of H){const Y=w.getTerrainData(et.tileID);B.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,N.texture);const Z={u_matrix:g.transform.calculatePosMatrix(et.tileID.toUnwrapped()),u_terrain_coords_id:(255-w.coordsIndex.length)/255,u_texture:0,u_ele_delta:w.getMeshFrameDelta(g.transform.zoom)};K.draw(B,I.TRIANGLES,R,Xr.disabled,L,dn.backCCW,Z,Y,"terrain",O.vertexBuffer,O.indexBuffer,O.segments),w.coordsIndex.push(et.tileID.key)}B.bindFramebuffer.set(null),B.viewport.set([0,0,g.width,g.height])}(this,this.style.map.terrain))}renderLayer(c,f,_,A){if(!_.isHidden(this.transform.zoom)&&(_.type==="background"||_.type==="custom"||(A||[]).length))switch(this.id=_.id,_.type){case"symbol":(function(g,w,B,I,L){if(g.renderPass!=="translucent")return;const R=Xr.disabled,O=g.colorModeForRenderPass();(B._unevaluatedLayout.hasValue("text-variable-anchor")||B._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(N,H,K,et,Y,Z,yt,at,lt){const At=H.transform,Et=Da(),Dt=Y==="map",zt=Z==="map";for(const ue of N){const oe=et.getTile(ue),ce=oe.getBucket(K);if(!ce||!ce.text||!ce.text.segments.get().length)continue;const ie=o.ah(ce.textSizeData,At.zoom),Pe=pr(oe,1,H.transform.zoom),We=vn(ue.posMatrix,zt,Dt,H.transform,Pe),_e=K.layout.get("icon-text-fit")!=="none"&&ce.hasIconData();if(ie){const be=Math.pow(2,At.zoom-oe.tileID.overscaledZ),Xe=H.style.map.terrain?(He,Sr)=>H.style.map.terrain.getElevation(ue,He,Sr):null,Rr=Et.translatePosition(At,oe,yt,at);Va(ce,Dt,zt,lt,At,We,ue.posMatrix,be,ie,_e,Et,Rr,ue.toUnwrapped(),Xe)}}}(I,g,B,w,B.layout.get("text-rotation-alignment"),B.layout.get("text-pitch-alignment"),B.paint.get("text-translate"),B.paint.get("text-translate-anchor"),L),B.paint.get("icon-opacity").constantOr(1)!==0&&_o(g,w,B,I,!1,B.paint.get("icon-translate"),B.paint.get("icon-translate-anchor"),B.layout.get("icon-rotation-alignment"),B.layout.get("icon-pitch-alignment"),B.layout.get("icon-keep-upright"),R,O),B.paint.get("text-opacity").constantOr(1)!==0&&_o(g,w,B,I,!0,B.paint.get("text-translate"),B.paint.get("text-translate-anchor"),B.layout.get("text-rotation-alignment"),B.layout.get("text-pitch-alignment"),B.layout.get("text-keep-upright"),R,O),w.map.showCollisionBoxes&&(pa(g,w,B,I,!0),pa(g,w,B,I,!1))})(c,f,_,A,this.style.placement.variableOffsets);break;case"circle":(function(g,w,B,I){if(g.renderPass!=="translucent")return;const L=B.paint.get("circle-opacity"),R=B.paint.get("circle-stroke-width"),O=B.paint.get("circle-stroke-opacity"),N=!B.layout.get("circle-sort-key").isConstant();if(L.constantOr(1)===0&&(R.constantOr(1)===0||O.constantOr(1)===0))return;const H=g.context,K=H.gl,et=g.depthModeForSublayer(0,Cr.ReadOnly),Y=Xr.disabled,Z=g.colorModeForRenderPass(),yt=[];for(let at=0;at<I.length;at++){const lt=I[at],At=w.getTile(lt),Et=At.getBucket(B);if(!Et)continue;const Dt=Et.programConfigurations.get(B.id),zt=g.useProgram("circle",Dt),ue=Et.layoutVertexBuffer,oe=Et.indexBuffer,ce=g.style.map.terrain&&g.style.map.terrain.getTerrainData(lt),ie={programConfiguration:Dt,program:zt,layoutVertexBuffer:ue,indexBuffer:oe,uniformValues:ti(g,lt,At,B),terrainData:ce};if(N){const Pe=Et.segments.get();for(const We of Pe)yt.push({segments:new o.a0([We]),sortKey:We.sortKey,state:ie})}else yt.push({segments:Et.segments,sortKey:0,state:ie})}N&&yt.sort((at,lt)=>at.sortKey-lt.sortKey);for(const at of yt){const{programConfiguration:lt,program:At,layoutVertexBuffer:Et,indexBuffer:Dt,uniformValues:zt,terrainData:ue}=at.state;At.draw(H,K.TRIANGLES,et,Y,Z,dn.disabled,zt,ue,B.id,Et,Dt,at.segments,B.paint,g.transform.zoom,lt)}})(c,f,_,A);break;case"heatmap":(function(g,w,B,I){if(B.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const L=g.context,R=L.gl,O=Xr.disabled,N=new kr([R.ONE,R.ONE],o.aN.transparent,[!0,!0,!0,!0]);(function(H,K,et){const Y=H.gl;H.activeTexture.set(Y.TEXTURE1),H.viewport.set([0,0,K.width/4,K.height/4]);let Z=et.heatmapFbo;if(Z)Y.bindTexture(Y.TEXTURE_2D,Z.colorAttachment.get()),H.bindFramebuffer.set(Z.framebuffer);else{const yt=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,yt),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),Z=et.heatmapFbo=H.createFramebuffer(K.width/4,K.height/4,!1,!1),function(at,lt,At,Et){var Dt,zt;const ue=at.gl,oe=(Dt=at.HALF_FLOAT)!==null&&Dt!==void 0?Dt:ue.UNSIGNED_BYTE,ce=(zt=at.RGBA16F)!==null&&zt!==void 0?zt:ue.RGBA;ue.texImage2D(ue.TEXTURE_2D,0,ce,lt.width/4,lt.height/4,0,ue.RGBA,oe,null),Et.colorAttachment.set(At)}(H,K,yt,Z)}})(L,g,B),L.clear({color:o.aN.transparent});for(let H=0;H<I.length;H++){const K=I[H];if(w.hasRenderableParent(K))continue;const et=w.getTile(K),Y=et.getBucket(B);if(!Y)continue;const Z=Y.programConfigurations.get(B.id),yt=g.useProgram("heatmap",Z),{zoom:at}=g.transform;yt.draw(L,R.TRIANGLES,Cr.disabled,O,N,dn.disabled,As(K.posMatrix,et,at,B.paint.get("heatmap-intensity")),null,B.id,Y.layoutVertexBuffer,Y.indexBuffer,Y.segments,B.paint,g.transform.zoom,Z)}L.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),function(L,R){const O=L.context,N=O.gl,H=R.heatmapFbo;if(!H)return;O.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,H.colorAttachment.get()),O.activeTexture.set(N.TEXTURE1);let K=R.colorRampTexture;K||(K=R.colorRampTexture=new ot(O,R.colorRamp,N.RGBA)),K.bind(N.LINEAR,N.CLAMP_TO_EDGE),L.useProgram("heatmapTexture").draw(O,N.TRIANGLES,Cr.disabled,Xr.disabled,L.colorModeForRenderPass(),dn.disabled,((et,Y,Z,yt)=>{const at=o.H();o.aQ(at,0,et.width,et.height,0,0,1);const lt=et.context.gl;return{u_matrix:at,u_world:[lt.drawingBufferWidth,lt.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Y.paint.get("heatmap-opacity")}})(L,R),null,R.id,L.viewportBuffer,L.quadTriangleIndexBuffer,L.viewportSegments,R.paint,L.transform.zoom)}(g,B))})(c,f,_,A);break;case"line":(function(g,w,B,I){if(g.renderPass!=="translucent")return;const L=B.paint.get("line-opacity"),R=B.paint.get("line-width");if(L.constantOr(1)===0||R.constantOr(1)===0)return;const O=g.depthModeForSublayer(0,Cr.ReadOnly),N=g.colorModeForRenderPass(),H=B.paint.get("line-dasharray"),K=B.paint.get("line-pattern"),et=K.constantOr(1),Y=B.paint.get("line-gradient"),Z=B.getCrossfadeParameters(),yt=et?"linePattern":H?"lineSDF":Y?"lineGradient":"line",at=g.context,lt=at.gl;let At=!0;for(const Et of I){const Dt=w.getTile(Et);if(et&&!Dt.patternsLoaded())continue;const zt=Dt.getBucket(B);if(!zt)continue;const ue=zt.programConfigurations.get(B.id),oe=g.context.program.get(),ce=g.useProgram(yt,ue),ie=At||ce.program!==oe,Pe=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Et),We=K.constantOr(null);if(We&&Dt.imageAtlas){const Xe=Dt.imageAtlas,Rr=Xe.patternPositions[We.to.toString()],He=Xe.patternPositions[We.from.toString()];Rr&&He&&ue.setConstantPatternPositions(Rr,He)}const _e=Pe?Et:null,be=et?Ho(g,Dt,B,Z,_e):H?nA(g,Dt,B,H,Z,_e):Y?iu(g,Dt,B,zt.lineClipsArray.length,_e):_c(g,Dt,B,_e);if(et)at.activeTexture.set(lt.TEXTURE0),Dt.imageAtlasTexture.bind(lt.LINEAR,lt.CLAMP_TO_EDGE),ue.updatePaintBuffers(Z);else if(H&&(ie||g.lineAtlas.dirty))at.activeTexture.set(lt.TEXTURE0),g.lineAtlas.bind(at);else if(Y){const Xe=zt.gradients[B.id];let Rr=Xe.texture;if(B.gradientVersion!==Xe.version){let He=256;if(B.stepInterpolant){const Sr=w.getSource().maxzoom,an=Et.canonical.z===Sr?Math.ceil(1<<g.transform.maxZoom-Et.canonical.z):1;He=o.ad(o.aV(zt.maxLineLength/o.X*1024*an),256,at.maxTextureSize)}Xe.gradient=o.aW({expression:B.gradientExpression(),evaluationKey:"lineProgress",resolution:He,image:Xe.gradient||void 0,clips:zt.lineClipsArray}),Xe.texture?Xe.texture.update(Xe.gradient):Xe.texture=new ot(at,Xe.gradient,lt.RGBA),Xe.version=B.gradientVersion,Rr=Xe.texture}at.activeTexture.set(lt.TEXTURE0),Rr.bind(B.stepInterpolant?lt.NEAREST:lt.LINEAR,lt.CLAMP_TO_EDGE)}ce.draw(at,lt.TRIANGLES,O,g.stencilModeForClipping(Et),N,dn.disabled,be,Pe,B.id,zt.layoutVertexBuffer,zt.indexBuffer,zt.segments,B.paint,g.transform.zoom,ue,zt.layoutVertexBuffer2),At=!1}})(c,f,_,A);break;case"fill":(function(g,w,B,I){const L=B.paint.get("fill-color"),R=B.paint.get("fill-opacity");if(R.constantOr(1)===0)return;const O=g.colorModeForRenderPass(),N=B.paint.get("fill-pattern"),H=g.opaquePassEnabledForLayer()&&!N.constantOr(1)&&L.constantOr(o.aN.transparent).a===1&&R.constantOr(0)===1?"opaque":"translucent";if(g.renderPass===H){const K=g.depthModeForSublayer(1,g.renderPass==="opaque"?Cr.ReadWrite:Cr.ReadOnly);El(g,w,B,I,K,O,!1)}if(g.renderPass==="translucent"&&B.paint.get("fill-antialias")){const K=g.depthModeForSublayer(B.getPaintProperty("fill-outline-color")?2:0,Cr.ReadOnly);El(g,w,B,I,K,O,!0)}})(c,f,_,A);break;case"fill-extrusion":(function(g,w,B,I){const L=B.paint.get("fill-extrusion-opacity");if(L!==0&&g.renderPass==="translucent"){const R=new Cr(g.context.gl.LEQUAL,Cr.ReadWrite,g.depthRangeFor3D);if(L!==1||B.paint.get("fill-extrusion-pattern").constantOr(1))Ga(g,w,B,I,R,Xr.disabled,kr.disabled),Ga(g,w,B,I,R,g.stencilModeFor3D(),g.colorModeForRenderPass());else{const O=g.colorModeForRenderPass();Ga(g,w,B,I,R,Xr.disabled,O)}}})(c,f,_,A);break;case"hillshade":(function(g,w,B,I){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent")return;const L=g.context,R=g.depthModeForSublayer(0,Cr.ReadOnly),O=g.colorModeForRenderPass(),[N,H]=g.renderPass==="translucent"?g.stencilConfigForOverlap(I):[{},I];for(const K of H){const et=w.getTile(K);et.needsHillshadePrepare!==void 0&&et.needsHillshadePrepare&&g.renderPass==="offscreen"?jo(g,et,B,R,Xr.disabled,O):g.renderPass==="translucent"&&Sl(g,K,et,B,R,N[K.overscaledZ],O)}L.viewport.set([0,0,g.width,g.height])})(c,f,_,A);break;case"raster":(function(g,w,B,I){if(g.renderPass!=="translucent"||B.paint.get("raster-opacity")===0||!I.length)return;const L=g.context,R=L.gl,O=w.getSource(),N=g.useProgram("raster"),H=g.colorModeForRenderPass(),[K,et]=O instanceof Ye?[{},I]:g.stencilConfigForOverlap(I),Y=et[et.length-1].overscaledZ,Z=!g.options.moving;for(const yt of et){const at=g.depthModeForSublayer(yt.overscaledZ-Y,B.paint.get("raster-opacity")===1?Cr.ReadWrite:Cr.ReadOnly,R.LESS),lt=w.getTile(yt);lt.registerFadeDuration(B.paint.get("raster-fade-duration"));const At=w.findLoadedParent(yt,0),Et=w.findLoadedSibling(yt),Dt=es(lt,At||Et||null,w,B,g.transform,g.style.map.terrain);let zt,ue;const oe=B.paint.get("raster-resampling")==="nearest"?R.NEAREST:R.LINEAR;L.activeTexture.set(R.TEXTURE0),lt.texture.bind(oe,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),L.activeTexture.set(R.TEXTURE1),At?(At.texture.bind(oe,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),zt=Math.pow(2,At.tileID.overscaledZ-lt.tileID.overscaledZ),ue=[lt.tileID.canonical.x*zt%1,lt.tileID.canonical.y*zt%1]):lt.texture.bind(oe,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST);const ce=g.style.map.terrain&&g.style.map.terrain.getTerrainData(yt),ie=ce?yt:null,Pe=ie?ie.posMatrix:g.transform.calculatePosMatrix(yt.toUnwrapped(),Z),We=iA(Pe,ue||[0,0],zt||1,Dt,B);O instanceof Ye?N.draw(L,R.TRIANGLES,at,Xr.disabled,H,dn.disabled,We,ce,B.id,O.boundsBuffer,g.quadTriangleIndexBuffer,O.boundsSegments):N.draw(L,R.TRIANGLES,at,K[yt.overscaledZ],H,dn.disabled,We,ce,B.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}})(c,f,_,A);break;case"background":(function(g,w,B,I){const L=B.paint.get("background-color"),R=B.paint.get("background-opacity");if(R===0)return;const O=g.context,N=O.gl,H=g.transform,K=H.tileSize,et=B.paint.get("background-pattern");if(g.isPatternMissing(et))return;const Y=!et&&L.a===1&&R===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==Y)return;const Z=Xr.disabled,yt=g.depthModeForSublayer(0,Y==="opaque"?Cr.ReadWrite:Cr.ReadOnly),at=g.colorModeForRenderPass(),lt=g.useProgram(et?"backgroundPattern":"background"),At=I||H.coveringTiles({tileSize:K,terrain:g.style.map.terrain});et&&(O.activeTexture.set(N.TEXTURE0),g.imageManager.bind(g.context));const Et=B.getCrossfadeParameters();for(const Dt of At){const zt=I?Dt.posMatrix:g.transform.calculatePosMatrix(Dt.toUnwrapped()),ue=et?da(zt,R,g,et,{tileID:Dt,tileSize:K},Et):ha(zt,R,L),oe=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Dt);lt.draw(O,N.TRIANGLES,yt,Z,at,dn.disabled,ue,oe,B.id,g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}})(c,0,_,A);break;case"custom":(function(g,w,B){const I=g.context,L=B.implementation;if(g.renderPass==="offscreen"){const R=L.prerender;R&&(g.setCustomLayerDefaults(),I.setColorMode(g.colorModeForRenderPass()),R.call(L,I.gl,g.transform.customLayerMatrix()),I.setDirty(),g.setBaseState())}else if(g.renderPass==="translucent"){g.setCustomLayerDefaults(),I.setColorMode(g.colorModeForRenderPass()),I.setStencilMode(Xr.disabled);const R=L.renderingMode==="3d"?new Cr(g.context.gl.LEQUAL,Cr.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,Cr.ReadOnly);I.setDepthMode(R),L.render(I.gl,g.transform.customLayerMatrix()),I.setDirty(),g.setBaseState(),I.bindFramebuffer.set(null)}})(c,0,_)}}translatePosMatrix(c,f,_,A,g){if(!_[0]&&!_[1])return c;const w=g?A==="map"?this.transform.angle:0:A==="viewport"?-this.transform.angle:0;if(w){const L=Math.sin(w),R=Math.cos(w);_=[_[0]*R-_[1]*L,_[0]*L+_[1]*R]}const B=[g?_[0]:pr(f,_[0],this.transform.zoom),g?_[1]:pr(f,_[1],this.transform.zoom),0],I=new Float32Array(16);return o.J(I,c,B),I}saveTileTexture(c){const f=this._tileTextures[c.size[0]];f?f.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const f=this._tileTextures[c];return f&&f.length>0?f.pop():null}isPatternMissing(c){if(!c)return!1;if(!c.from||!c.to)return!0;const f=this.imageManager.getPattern(c.from.toString()),_=this.imageManager.getPattern(c.to.toString());return!f||!_}useProgram(c,f){this.cache=this.cache||{};const _=c+(f?f.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[_]||(this.cache[_]=new ht(this.context,bs[c],f,su[c],this._showOverdrawInspector,this.style.map.terrain)),this.cache[_]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ot(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:c,drawingBufferHeight:f}=this.context.gl;return this.width!==c||this.height!==f}}class Bs{constructor(c,f){this.points=c,this.planes=f}static fromInvProjectionMatrix(c,f,_){const A=Math.pow(2,_),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(B=>{const I=1/(B=o.ag([],B,c))[3]/f*A;return o.b1(B,B,[I,I,1/B[3],I])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(B=>{const I=function(N,H){var K=H[0],et=H[1],Y=H[2],Z=K*K+et*et+Y*Y;return Z>0&&(Z=1/Math.sqrt(Z)),N[0]=H[0]*Z,N[1]=H[1]*Z,N[2]=H[2]*Z,N}([],function(N,H,K){var et=H[0],Y=H[1],Z=H[2],yt=K[0],at=K[1],lt=K[2];return N[0]=Y*lt-Z*at,N[1]=Z*yt-et*lt,N[2]=et*at-Y*yt,N}([],mt([],g[B[0]],g[B[1]]),mt([],g[B[2]],g[B[1]]))),L=-((R=I)[0]*(O=g[B[1]])[0]+R[1]*O[1]+R[2]*O[2]);var R,O;return I.concat(L)});return new Bs(g,w)}}class $a{constructor(c,f){this.min=c,this.max=f,this.center=function(_,A,g){return _[0]=.5*A[0],_[1]=.5*A[1],_[2]=.5*A[2],_}([],function(_,A,g){return _[0]=A[0]+g[0],_[1]=A[1]+g[1],_[2]=A[2]+g[2],_}([],this.min,this.max))}quadrant(c){const f=[c%2==0,c<2],_=pt(this.min),A=pt(this.max);for(let g=0;g<f.length;g++)_[g]=f[g]?this.min[g]:this.center[g],A[g]=f[g]?this.center[g]:this.max[g];return A[2]=this.max[2],new $a(_,A)}distanceX(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]}distanceY(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]}intersects(c){const f=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let _=!0;for(let A=0;A<c.planes.length;A++){const g=c.planes[A];let w=0;for(let B=0;B<f.length;B++)o.b2(g,f[B])>=0&&w++;if(w===0)return 0;w!==f.length&&(_=!1)}if(_)return 2;for(let A=0;A<3;A++){let g=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let B=0;B<c.points.length;B++){const I=c.points[B][A]-this.min[A];g=Math.min(g,I),w=Math.max(w,I)}if(w<0||g>this.max[A]-this.min[A])return 0}return 1}}class ks{constructor(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(isNaN(c)||c<0||isNaN(f)||f<0||isNaN(_)||_<0||isNaN(A)||A<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=f,this.left=_,this.right=A}interpolate(c,f,_){return f.top!=null&&c.top!=null&&(this.top=o.z.number(c.top,f.top,_)),f.bottom!=null&&c.bottom!=null&&(this.bottom=o.z.number(c.bottom,f.bottom,_)),f.left!=null&&c.left!=null&&(this.left=o.z.number(c.left,f.left,_)),f.right!=null&&c.right!=null&&(this.right=o.z.number(c.right,f.right,_)),this}getCenter(c,f){const _=o.ad((this.left+c-this.right)/2,0,c),A=o.ad((this.top+f-this.bottom)/2,0,f);return new o.P(_,A)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new ks(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Tl=85.051129;class Ec{constructor(c,f,_,A,g){this.tileSize=512,this._renderWorldCopies=g===void 0||!!g,this._minZoom=c||0,this._maxZoom=f||22,this._minPitch=_??0,this._maxPitch=A??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ks,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const c=new Ec(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return c.apply(this),c}apply(c){this.tileSize=c.tileSize,this.latRange=c.latRange,this.width=c.width,this.height=c.height,this._center=c._center,this._elevation=c._elevation,this.minElevationForCurrentTile=c.minElevationForCurrentTile,this.zoom=c.zoom,this.angle=c.angle,this._fov=c._fov,this._pitch=c._pitch,this._unmodified=c._unmodified,this._edgeInsets=c._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(c){const f=-o.b3(c,-180,180)*Math.PI/180;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=function(){var _=new o.A(4);return o.A!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_}(),function(_,A,g){var w=A[0],B=A[1],I=A[2],L=A[3],R=Math.sin(g),O=Math.cos(g);_[0]=w*O+I*R,_[1]=B*O+L*R,_[2]=w*-R+I*O,_[3]=B*-R+L*O}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const f=o.ad(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=c/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(c){const f=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._zoom=f,this.tileZoom=Math.max(0,Math.floor(f)),this.scale=this.zoomScale(f),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(c){c!==this._elevation&&(this._elevation=c,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,f,_){this._unmodified=!1,this._edgeInsets.interpolate(c,f,_),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const f=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,f)}getVisibleUnwrappedCoordinates(c){const f=[new o.b4(0,c)];if(this._renderWorldCopies){const _=this.pointCoordinate(new o.P(0,0)),A=this.pointCoordinate(new o.P(this.width,0)),g=this.pointCoordinate(new o.P(this.width,this.height)),w=this.pointCoordinate(new o.P(0,this.height)),B=Math.floor(Math.min(_.x,A.x,g.x,w.x)),I=Math.floor(Math.max(_.x,A.x,g.x,w.x)),L=1;for(let R=B-L;R<=I+L;R++)R!==0&&f.push(new o.b4(R,c))}return f}coveringTiles(c){var f,_;let A=this.coveringZoomLevel(c);const g=A;if(c.minzoom!==void 0&&A<c.minzoom)return[];c.maxzoom!==void 0&&A>c.maxzoom&&(A=c.maxzoom);const w=this.pointCoordinate(this.getCameraPoint()),B=o.Z.fromLngLat(this.center),I=Math.pow(2,A),L=[I*w.x,I*w.y,0],R=[I*B.x,I*B.y,0],O=Bs.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,A);let N=c.minzoom||0;!c.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(N=A);const H=c.terrain?2/Math.min(this.tileSize,c.tileSize)*this.tileSize:3,K=at=>({aabb:new $a([at*I,0,0],[(at+1)*I,I,0]),zoom:0,x:0,y:0,wrap:at,fullyVisible:!1}),et=[],Y=[],Z=A,yt=c.reparseOverscaled?g:A;if(this._renderWorldCopies)for(let at=1;at<=3;at++)et.push(K(-at)),et.push(K(at));for(et.push(K(0));et.length>0;){const at=et.pop(),lt=at.x,At=at.y;let Et=at.fullyVisible;if(!Et){const ce=at.aabb.intersects(O);if(ce===0)continue;Et=ce===2}const Dt=c.terrain?L:R,zt=at.aabb.distanceX(Dt),ue=at.aabb.distanceY(Dt),oe=Math.max(Math.abs(zt),Math.abs(ue));if(at.zoom===Z||oe>H+(1<<Z-at.zoom)-2&&at.zoom>=N){const ce=Z-at.zoom,ie=L[0]-.5-(lt<<ce),Pe=L[1]-.5-(At<<ce);Y.push({tileID:new o.S(at.zoom===Z?yt:at.zoom,at.wrap,at.zoom,lt,At),distanceSq:dt([R[0]-.5-lt,R[1]-.5-At]),tileDistanceToCamera:Math.sqrt(ie*ie+Pe*Pe)})}else for(let ce=0;ce<4;ce++){const ie=(lt<<1)+ce%2,Pe=(At<<1)+(ce>>1),We=at.zoom+1;let _e=at.aabb.quadrant(ce);if(c.terrain){const be=new o.S(We,at.wrap,We,ie,Pe),Xe=c.terrain.getMinMaxElevation(be),Rr=(f=Xe.minElevation)!==null&&f!==void 0?f:this.elevation,He=(_=Xe.maxElevation)!==null&&_!==void 0?_:this.elevation;_e=new $a([_e.min[0],_e.min[1],Rr],[_e.max[0],_e.max[1],He])}et.push({aabb:_e,zoom:We,x:ie,y:Pe,wrap:at.wrap,fullyVisible:Et})}}return Y.sort((at,lt)=>at.distanceSq-lt.distanceSq).map(at=>at.tileID)}resize(c,f){this.width=c,this.height=f,this.pixelsToGLUnits=[2/c,-2/f],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const f=o.ad(c.lat,-85.051129,Tl);return new o.P(o.O(c.lng)*this.worldSize,o.Q(f)*this.worldSize)}unproject(c){return new o.Z(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(c){const f=this.elevation,_=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,A=this.pointLocation(this.centerPoint,c),g=c.getElevationForLngLatZoom(A,this.tileZoom);if(!(this.elevation-g))return;const w=_+f-g,B=Math.cos(this._pitch)*this.cameraToCenterDistance/w/o.b5(1,A.lat),I=this.scaleZoom(B/this.tileSize);this._elevation=g,this._center=A,this.zoom=I}setLocationAtPoint(c,f){const _=this.pointCoordinate(f),A=this.pointCoordinate(this.centerPoint),g=this.locationCoordinate(c),w=new o.Z(g.x-(_.x-A.x),g.y-(_.y-A.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(c,f){return f?this.coordinatePoint(this.locationCoordinate(c),f.getElevationForLngLatZoom(c,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(c))}pointLocation(c,f){return this.coordinateLocation(this.pointCoordinate(c,f))}locationCoordinate(c){return o.Z.fromLngLat(c)}coordinateLocation(c){return c&&c.toLngLat()}pointCoordinate(c,f){if(f){const N=f.pointCoordinate(c);if(N!=null)return N}const _=[c.x,c.y,0,1],A=[c.x,c.y,1,1];o.ag(_,_,this.pixelMatrixInverse),o.ag(A,A,this.pixelMatrixInverse);const g=_[3],w=A[3],B=_[1]/g,I=A[1]/w,L=_[2]/g,R=A[2]/w,O=L===R?0:(0-L)/(R-L);return new o.Z(o.z.number(_[0]/g,A[0]/w,O)/this.worldSize,o.z.number(B,I,O)/this.worldSize)}coordinatePoint(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.pixelMatrix;const A=[c.x*this.worldSize,c.y*this.worldSize,f,1];return o.ag(A,A,_),new o.P(A[0]/A[3],A[1]/A[3])}getBounds(){const c=Math.max(0,this.height/2-this.getHorizon());return new st().extend(this.pointLocation(new o.P(0,c))).extend(this.pointLocation(new o.P(this.width,c))).extend(this.pointLocation(new o.P(this.width,this.height))).extend(this.pointLocation(new o.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new st([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Tl])}calculateTileMatrix(c){const f=c.canonical,_=this.worldSize/this.zoomScale(f.z),A=f.x+Math.pow(2,f.z)*c.wrap,g=o.ao(new Float64Array(16));return o.J(g,g,[A*_,f.y*_,0]),o.K(g,g,[_/o.X,_/o.X,1]),g}calculatePosMatrix(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const _=c.key,A=f?this._alignedPosMatrixCache:this._posMatrixCache;if(A[_])return A[_];const g=this.calculateTileMatrix(c);return o.L(g,f?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,g),A[_]=new Float32Array(g),A[_]}calculateFogMatrix(c){const f=c.key,_=this._fogMatrixCache;if(_[f])return _[f];const A=this.calculateTileMatrix(c);return o.L(A,this.fogMatrix,A),_[f]=new Float32Array(A),_[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(c,f){f=o.ad(+f,this.minZoom,this.maxZoom);const _={center:new o.N(c.lng,c.lat),zoom:f};let A=this.lngRange;if(!this._renderWorldCopies&&A===null){const at=179.9999999999;A=[-at,at]}const g=this.tileSize*this.zoomScale(_.zoom);let w=0,B=g,I=0,L=g,R=0,O=0;const{x:N,y:H}=this.size;if(this.latRange){const at=this.latRange;w=o.Q(at[1])*g,B=o.Q(at[0])*g,B-w<H&&(R=H/(B-w))}A&&(I=o.b3(o.O(A[0])*g,0,g),L=o.b3(o.O(A[1])*g,0,g),L<I&&(L+=g),L-I<N&&(O=N/(L-I)));const{x:K,y:et}=this.project.call({worldSize:g},c);let Y,Z;const yt=Math.max(O||0,R||0);if(yt){const at=new o.P(O?(L+I)/2:K,R?(B+w)/2:et);return _.center=this.unproject.call({worldSize:g},at).wrap(),_.zoom+=this.scaleZoom(yt),_}if(this.latRange){const at=H/2;et-at<w&&(Z=w+at),et+at>B&&(Z=B-at)}if(A){const at=(I+L)/2;let lt=K;this._renderWorldCopies&&(lt=o.b3(K,at-g/2,at+g/2));const At=N/2;lt-At<I&&(Y=I+At),lt+At>L&&(Y=L-At)}if(Y!==void 0||Z!==void 0){const at=new o.P(Y??K,Z??et);_.center=this.unproject.call({worldSize:g},at).wrap()}return _}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const c=this._unmodified,{center:f,zoom:_}=this.getConstrained(this.center,this.zoom);this.center=f,this.zoom=_,this._unmodified=c,this._constraining=!1}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,f=this.point.x,_=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=o.b5(1,this.center.lat)*this.worldSize;let A=o.ao(new Float64Array(16));o.K(A,A,[this.width/2,-this.height/2,1]),o.J(A,A,[1,-1,0]),this.labelPlaneMatrix=A,A=o.ao(new Float64Array(16)),o.K(A,A,[1,-1,1]),o.J(A,A,[-1,-1,0]),o.K(A,A,[2/this.width,2/this.height,1]),this.glCoordMatrix=A;const g=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),w=Math.min(this.elevation,this.minElevationForCurrentTile),B=g-w*this._pixelPerMeter/Math.cos(this._pitch),I=w<0?B:g,L=Math.PI/2+this._pitch,R=this._fov*(.5+c.y/this.height),O=Math.sin(R)*I/Math.sin(o.ad(Math.PI-L-R,.01,Math.PI-.01)),N=this.getHorizon(),H=2*Math.atan(N/this.cameraToCenterDistance)*(.5+c.y/(2*N)),K=Math.sin(H)*I/Math.sin(o.ad(Math.PI-L-H,.01,Math.PI-.01)),et=Math.min(O,K),Y=1.01*(Math.cos(Math.PI/2-this._pitch)*et+I),Z=this.height/50;A=new Float64Array(16),o.b6(A,this._fov,this.width/this.height,Z,Y),A[8]=2*-c.x/this.width,A[9]=2*c.y/this.height,o.K(A,A,[1,-1,1]),o.J(A,A,[0,0,-this.cameraToCenterDistance]),o.b7(A,A,this._pitch),o.ae(A,A,this.angle),o.J(A,A,[-f,-_,0]),this.mercatorMatrix=o.K([],A,[this.worldSize,this.worldSize,this.worldSize]),o.K(A,A,[1,1,this._pixelPerMeter]),this.pixelMatrix=o.L(new Float64Array(16),this.labelPlaneMatrix,A),o.J(A,A,[0,0,-this.elevation]),this.modelViewProjectionMatrix=A,this.invModelViewProjectionMatrix=o.at([],A),this.fogMatrix=new Float64Array(16),o.b6(this.fogMatrix,this._fov,this.width/this.height,g,Y),this.fogMatrix[8]=2*-c.x/this.width,this.fogMatrix[9]=2*c.y/this.height,o.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),o.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),o.b7(this.fogMatrix,this.fogMatrix,this._pitch),o.ae(this.fogMatrix,this.fogMatrix,this.angle),o.J(this.fogMatrix,this.fogMatrix,[-f,-_,0]),o.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),o.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=o.L(new Float64Array(16),this.labelPlaneMatrix,A);const yt=this.width%2/2,at=this.height%2/2,lt=Math.cos(this.angle),At=Math.sin(this.angle),Et=f-Math.round(f)+lt*yt+At*at,Dt=_-Math.round(_)+lt*at+At*yt,zt=new Float64Array(A);if(o.J(zt,zt,[Et>.5?Et-1:Et,Dt>.5?Dt-1:Dt,0]),this.alignedModelViewProjectionMatrix=zt,A=o.at(new Float64Array(16),this.pixelMatrix),!A)throw new Error("failed to invert matrix");this.pixelMatrixInverse=A,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const c=this.pointCoordinate(new o.P(0,0)),f=[c.x*this.worldSize,c.y*this.worldSize,0,1];return o.ag(f,f,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,c))}getCameraQueryGeometry(c){const f=this.getCameraPoint();if(c.length===1)return[c[0],f];{let _=f.x,A=f.y,g=f.x,w=f.y;for(const B of c)_=Math.min(_,B.x),A=Math.min(A,B.y),g=Math.max(g,B.x),w=Math.max(w,B.y);return[new o.P(_,A),new o.P(g,A),new o.P(g,w),new o.P(_,w),new o.P(_,A)]}}lngLatToCameraDepth(c,f){const _=this.locationCoordinate(c),A=[_.x*this.worldSize,_.y*this.worldSize,f,1];return o.ag(A,A,this.modelViewProjectionMatrix),A[2]/A[3]}}function Ko(S,c){var f=this;let _,A=!1,g=null,w=null;const B=()=>{g=null,A&&(S.apply(w,_),g=setTimeout(B,c),A=!1)};return function(){for(var I=arguments.length,L=new Array(I),R=0;R<I;R++)L[R]=arguments[R];return A=!0,w=f,_=L,g||B(),g}}class Cs{constructor(c){this._getCurrentHash=()=>{const f=window.location.hash.replace("#","");if(this._hashName){let _;return f.split("&").map(A=>A.split("=")).forEach(A=>{A[0]===this._hashName&&(_=A)}),(_&&_[1]||"").split("/")}return f.split("/")},this._onHashChange=()=>{const f=this._getCurrentHash();if(f.length>=3&&!f.some(_=>isNaN(_))){const _=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(f[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+f[2],+f[1]],zoom:+f[0],bearing:_,pitch:+(f[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const f=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,f)}catch{}},this._updateHash=Ko(this._updateHashUnthrottled,300),this._hashName=c&&encodeURIComponent(c)}addTo(c){return this._map=c,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(c){const f=this._map.getCenter(),_=Math.round(100*this._map.getZoom())/100,A=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,A),w=Math.round(f.lng*g)/g,B=Math.round(f.lat*g)/g,I=this._map.getBearing(),L=this._map.getPitch();let R="";if(R+=c?`/${w}/${B}/${_}`:`${_}/${B}/${w}`,(I||L)&&(R+="/"+Math.round(10*I)/10),L&&(R+=`/${Math.round(L)}`),this._hashName){const O=this._hashName;let N=!1;const H=window.location.hash.slice(1).split("&").map(K=>{const et=K.split("=")[0];return et===O?(N=!0,`${et}=${R}`):K}).filter(K=>K);return N||H.push(`${O}=${R}`),`#${H.join("&")}`}return`#${R}`}}const Es={linearity:.3,easing:o.b8(0,0,.3,1)},Wa=o.e({deceleration:2500,maxSpeed:1400},Es),Il=o.e({deceleration:20,maxSpeed:1400},Es),Fl=o.e({deceleration:1e3,maxSpeed:360},Es),$o=o.e({deceleration:1e3,maxSpeed:90},Es);class Ll{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:b.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,f=b.now();for(;c.length>0&&f-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const f={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:g}of this._inertiaBuffer)f.zoom+=g.zoomDelta||0,f.bearing+=g.bearingDelta||0,f.pitch+=g.pitchDelta||0,g.panDelta&&f.pan._add(g.panDelta),g.around&&(f.around=g.around),g.pinchAround&&(f.pinchAround=g.pinchAround);const _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,A={};if(f.pan.mag()){const g=wo(f.pan.mag(),_,o.e({},Wa,c||{}));A.offset=f.pan.mult(g.amount/f.pan.mag()),A.center=this._map.transform.center,rs(A,g)}if(f.zoom){const g=wo(f.zoom,_,Il);A.zoom=this._map.transform.zoom+g.amount,rs(A,g)}if(f.bearing){const g=wo(f.bearing,_,Fl);A.bearing=this._map.transform.bearing+o.ad(g.amount,-179,179),rs(A,g)}if(f.pitch){const g=wo(f.pitch,_,$o);A.pitch=this._map.transform.pitch+g.amount,rs(A,g)}if(A.zoom||A.bearing){const g=f.pinchAround===void 0?f.around:f.pinchAround;A.around=g?this._map.unproject(g):this._map.getCenter()}return this.clear(),o.e(A,{noMoveStart:!0})}}function rs(S,c){(!S.duration||S.duration<c.duration)&&(S.duration=c.duration,S.easing=c.easing)}function wo(S,c,f){const{maxSpeed:_,linearity:A,deceleration:g}=f,w=o.ad(S*A/(c/1e3),-_,_),B=Math.abs(w)/(g*A);return{easing:f.easing,duration:1e3*B,amount:w*(B/2)}}class en extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,f,_){let A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const g=x.mousePos(f.getCanvas(),_),w=f.unproject(g);super(c,o.e({point:g,lngLat:w,originalEvent:_},A)),this._defaultPrevented=!1,this.target=f}}class Fn extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,f,_){const A=c==="touchend"?_.changedTouches:_.touches,g=x.touchPos(f.getCanvasContainer(),A),w=g.map(I=>f.unproject(I)),B=g.reduce((I,L,R,O)=>I.add(L.div(O.length)),new o.P(0,0));super(c,{points:g,point:B,lngLats:w,lngLat:f.unproject(B),originalEvent:_}),this._defaultPrevented=!1}}class fi extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,f,_){super(c,{originalEvent:_}),this._defaultPrevented=!1}}class bi{constructor(c,f){this._map=c,this._clickTolerance=f.clickTolerance}reset(){delete this._mousedownPos}wheel(c){return this._firePreventable(new fi(c.type,this._map,c))}mousedown(c,f){return this._mousedownPos=f,this._firePreventable(new en(c.type,this._map,c))}mouseup(c){this._map.fire(new en(c.type,this._map,c))}click(c,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||this._map.fire(new en(c.type,this._map,c))}dblclick(c){return this._firePreventable(new en(c.type,this._map,c))}mouseover(c){this._map.fire(new en(c.type,this._map,c))}mouseout(c){this._map.fire(new en(c.type,this._map,c))}touchstart(c){return this._firePreventable(new Fn(c.type,this._map,c))}touchmove(c){this._map.fire(new Fn(c.type,this._map,c))}touchend(c){this._map.fire(new Fn(c.type,this._map,c))}touchcancel(c){this._map.fire(new Fn(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Wo{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(c){this._map.fire(new en(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new en("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._ignoreContextMenu||this._map.fire(new en(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Zs{constructor(c){this._map=c}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(c){return this.transform.pointLocation(o.P.convert(c),this._map.terrain)}}class Pl{constructor(c,f){this._map=c,this._tr=new Zs(c),this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,f){this.isEnabled()&&c.shiftKey&&c.button===0&&(x.disableDrag(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(c,f){if(!this._active)return;const _=f;if(this._lastPos.equals(_)||!this._box&&_.dist(this._startPos)<this._clickTolerance)return;const A=this._startPos;this._lastPos=_,this._box||(this._box=x.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",c));const g=Math.min(A.x,_.x),w=Math.max(A.x,_.x),B=Math.min(A.y,_.y),I=Math.max(A.y,_.y);x.setTransform(this._box,`translate(${g}px,${B}px)`),this._box.style.width=w-g+"px",this._box.style.height=I-B+"px"}mouseupWindow(c,f){if(!this._active||c.button!==0)return;const _=this._startPos,A=f;if(this.reset(),x.suppressClick(),_.x!==A.x||_.y!==A.y)return this._map.fire(new o.k("boxzoomend",{originalEvent:c})),{cameraAnimation:g=>g.fitScreenCoordinates(_,A,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",c)}keydown(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(x.remove(this._box),this._box=null),x.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(c,f){return this._map.fire(new o.k(c,{originalEvent:f}))}}function Xa(S,c){if(S.length!==c.length)throw new Error(`The number of touches and points are not equal - touches ${S.length}, points ${c.length}`);const f={};for(let _=0;_<S.length;_++)f[S[_].identifier]=c[_];return f}class ph{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(c,f,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=c.timeStamp),_.length===this.numTouches&&(this.centroid=function(A){const g=new o.P(0,0);for(const w of A)g._add(w);return g.div(A.length)}(f),this.touches=Xa(_,f)))}touchmove(c,f,_){if(this.aborted||!this.centroid)return;const A=Xa(_,f);for(const g in this.touches){const w=A[g];(!w||w.dist(this.touches[g])>30)&&(this.aborted=!0)}}touchend(c,f,_){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),_.length===0){const A=!this.aborted&&this.centroid;if(this.reset(),A)return A}}}class gh{constructor(c){this.singleTap=new ph(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(c,f,_){this.singleTap.touchstart(c,f,_)}touchmove(c,f,_){this.singleTap.touchmove(c,f,_)}touchend(c,f,_){const A=this.singleTap.touchend(c,f,_);if(A){const g=c.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(A)<30;if(g&&w||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=A,this.count===this.numTaps)return this.reset(),A}}}class Td{constructor(c){this._tr=new Zs(c),this._zoomIn=new gh({numTouches:1,numTaps:2}),this._zoomOut=new gh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,f,_){this._zoomIn.touchstart(c,f,_),this._zoomOut.touchstart(c,f,_)}touchmove(c,f,_){this._zoomIn.touchmove(c,f,_),this._zoomOut.touchmove(c,f,_)}touchend(c,f,_){const A=this._zoomIn.touchend(c,f,_),g=this._zoomOut.touchend(c,f,_),w=this._tr;return A?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:B=>B.easeTo({duration:300,zoom:w.zoom+1,around:w.unproject(A)},{originalEvent:c})}):g?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:B=>B.easeTo({duration:300,zoom:w.zoom-1,around:w.unproject(g)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hn{constructor(c){this._enabled=!!c.enable,this._moveStateManager=c.moveStateManager,this._clickTolerance=c.clickTolerance||1,this._moveFunction=c.move,this._activateOnStart=!!c.activateOnStart,c.assignEvents(this),this.reset()}reset(c){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(c)}_move(){const c=this._moveFunction(...arguments);if(c.bearingDelta||c.pitchDelta||c.around||c.panDelta)return this._active=!0,c}dragStart(c,f){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(c)&&(this._moveStateManager.startMove(c),this._lastPoint=f.length?f[0]:f,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(c,f){if(!this.isEnabled())return;const _=this._lastPoint;if(!_)return;if(c.preventDefault(),!this._moveStateManager.isValidMoveEvent(c))return void this.reset(c);const A=f.length?f[0]:f;return!this._moved&&A.dist(_)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=A,this._move(_,A))}dragEnd(c){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(c)&&(this._moved&&x.suppressClick(),this.reset(c))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ml={0:1,2:2};class Ss{constructor(c){this._correctEvent=c.checkCorrectEvent}startMove(c){const f=x.mouseButton(c);this._eventButton=f}endMove(c){delete this._eventButton}isValidStartEvent(c){return this._correctEvent(c)}isValidMoveEvent(c){return!function(f,_){const A=Ml[_];return f.buttons===void 0||(f.buttons&A)!==A}(c,this._eventButton)}isValidEndEvent(c){return x.mouseButton(c)===this._eventButton}}class du{constructor(){this._firstTouch=void 0}_isOneFingerTouch(c){return c.targetTouches.length===1}_isSameTouchEvent(c){return c.targetTouches[0].identifier===this._firstTouch}startMove(c){this._firstTouch=c.targetTouches[0].identifier}endMove(c){delete this._firstTouch}isValidStartEvent(c){return this._isOneFingerTouch(c)}isValidMoveEvent(c){return this._isOneFingerTouch(c)&&this._isSameTouchEvent(c)}isValidEndEvent(c){return this._isOneFingerTouch(c)&&this._isSameTouchEvent(c)}}const Ul=S=>{S.mousedown=S.dragStart,S.mousemoveWindow=S.dragMove,S.mouseup=S.dragEnd,S.contextmenu=c=>{c.preventDefault()}},Ts=S=>{let{enable:c,clickTolerance:f,bearingDegreesPerPixelMoved:_=.8}=S;const A=new Ss({checkCorrectEvent:g=>x.mouseButton(g)===0&&g.ctrlKey||x.mouseButton(g)===2});return new Hn({clickTolerance:f,move:(g,w)=>({bearingDelta:(w.x-g.x)*_}),moveStateManager:A,enable:c,assignEvents:Ul})},Vi=S=>{let{enable:c,clickTolerance:f,pitchDegreesPerPixelMoved:_=-.5}=S;const A=new Ss({checkCorrectEvent:g=>x.mouseButton(g)===0&&g.ctrlKey||x.mouseButton(g)===2});return new Hn({clickTolerance:f,move:(g,w)=>({pitchDelta:(w.y-g.y)*_}),moveStateManager:A,enable:c,assignEvents:Ul})};class Rl{constructor(c,f){this._clickTolerance=c.clickTolerance||1,this._map=f,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(c,f,_){return this._calculateTransform(c,f,_)}touchmove(c,f,_){if(this._active&&!(_.length<this.minTouchs()))return c.preventDefault(),this._calculateTransform(c,f,_)}touchend(c,f,_){this._calculateTransform(c,f,_),this._active&&_.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,f,_){_.length>0&&(this._active=!0);const A=Xa(_,f),g=new o.P(0,0),w=new o.P(0,0);let B=0;for(const L in A){const R=A[L],O=this._touches[L];O&&(g._add(R),w._add(R.sub(O)),B++,A[L]=R)}if(this._touches=A,B<this.minTouchs()||!w.mag())return;const I=w.div(B);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:g.div(B),panDelta:I}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ol{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(c,f,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([f[0],f[1]]))}touchmove(c,f,_){if(!this._firstTwoTouches)return;c.preventDefault();const[A,g]=this._firstTwoTouches,w=fu(_,f,A),B=fu(_,f,g);if(!w||!B)return;const I=this._aroundCenter?null:w.add(B).div(2);return this._move([w,B],I,c)}touchend(c,f,_){if(!this._firstTwoTouches)return;const[A,g]=this._firstTwoTouches,w=fu(_,f,A),B=fu(_,f,g);w&&B||(this._active&&x.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function fu(S,c,f){for(let _=0;_<S.length;_++)if(S[_].identifier===f)return c[_]}function pu(S,c){return Math.log(S/c)/Math.LN2}class gu extends Ol{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,f){const _=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(pu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:pu(this._distance,_),pinchAround:f}}}function uA(S,c){return 180*S.angleWith(c)/Math.PI}class mh extends Ol{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,f,_){const A=this._vector;if(this._vector=c[0].sub(c[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:uA(this._vector,A),pinchAround:f}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const f=25/(Math.PI*this._minDiameter)*360,_=uA(c,this._startVector);return Math.abs(_)<f}}function Xo(S){return Math.abs(S.y)>Math.abs(S.x)}class AA extends Ol{constructor(c){super(),this._currentTouchCount=0,this._map=c}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(c,f,_){super.touchstart(c,f,_),this._currentTouchCount=_.length}_start(c){this._lastPoints=c,Xo(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,f,_){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const A=c[0].sub(this._lastPoints[0]),g=c[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(A,g,_.timeStamp),this._valid?(this._lastPoints=c,this._active=!0,{pitchDelta:(A.y+g.y)/2*-.5}):void 0}gestureBeginsVertically(c,f,_){if(this._valid!==void 0)return this._valid;const A=c.mag()>=2,g=f.mag()>=2;if(!A&&!g)return;if(!A||!g)return this._firstMove===void 0&&(this._firstMove=_),_-this._firstMove<100&&void 0;const w=c.y>0==f.y>0;return Xo(c)&&Xo(f)&&w}}const hA={panStep:100,bearingStep:15,pitchStep:10};class dA{constructor(c){this._tr=new Zs(c);const f=hA;this._panStep=f.panStep,this._bearingStep=f.bearingStep,this._pitchStep=f.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let f=0,_=0,A=0,g=0,w=0;switch(c.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:c.shiftKey?_=-1:(c.preventDefault(),g=-1);break;case 39:c.shiftKey?_=1:(c.preventDefault(),g=1);break;case 38:c.shiftKey?A=1:(c.preventDefault(),w=-1);break;case 40:c.shiftKey?A=-1:(c.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(_=0,A=0),{cameraAnimation:B=>{const I=this._tr;B.easeTo({duration:300,easeId:"keyboardHandler",easing:vp,zoom:f?Math.round(I.zoom)+f*(c.shiftKey?2:1):I.zoom,bearing:I.bearing+_*this._bearingStep,pitch:I.pitch+A*this._pitchStep,offset:[-g*this._panStep,-w*this._panStep],center:I.center},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function vp(S){return S*(2-S)}const Id=4.000244140625;class yh{constructor(c,f){this._onTimeout=_=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(_)},this._map=c,this._tr=new Zs(c),this._triggerRenderFrame=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!c&&c.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(c){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!c[this._map.cooperativeGestures._bypassKey])return;let f=c.deltaMode===WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const _=b.now(),A=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,f!==0&&f%Id==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":A>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(A*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),c.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=c,this._delta-=f,this._active||this._start(c)),c.preventDefault()}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const f=x.mousePos(this._map.getCanvas(),c),_=this._tr;this._around=f.y>_.transform.height/2-_.transform.getHorizon()?o.N.convert(this._aroundCenter?_.center:_.unproject(f)):o.N.convert(_.center),this._aroundPoint=_.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._tr.transform;if(this._delta!==0){const B=this._type==="wheel"&&Math.abs(this._delta)>Id?this._wheelZoomRate:this._defaultZoomRate;let I=2/(1+Math.exp(-Math.abs(this._delta*B)));this._delta<0&&I!==0&&(I=1/I);const L=typeof this._targetZoom=="number"?c.zoomScale(this._targetZoom):c.scale;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(L*I))),this._type==="wheel"&&(this._startZoom=c.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const f=typeof this._targetZoom=="number"?this._targetZoom:c.zoom,_=this._startZoom,A=this._easing;let g,w=!1;if(this._type==="wheel"&&_&&A){const B=Math.min((b.now()-this._lastWheelEventTime)/200,1),I=A(B);g=o.z.number(_,f,I),B<1?this._frameId||(this._frameId=!0):w=!0}else g=f,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!w,zoomDelta:g-c.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let f=o.b9;if(this._prevEase){const _=this._prevEase,A=(b.now()-_.start)/_.duration,g=_.easing(A+.01)-_.easing(A),w=.27/Math.sqrt(g*g+1e-4)*.01,B=Math.sqrt(.0729-w*w);f=o.b8(w,B,.25,1)}return this._prevEase={start:b.now(),duration:c,easing:f},f}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Fd{constructor(c,f){this._clickZoom=c,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class fA{constructor(c){this._tr=new Zs(c),this.reset()}reset(){this._active=!1}dblclick(c,f){return c.preventDefault(),{cameraAnimation:_=>{_.easeTo({duration:300,zoom:this._tr.zoom+(c.shiftKey?-1:1),around:this._tr.unproject(f)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bp{constructor(){this._tap=new gh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(c,f,_){if(!this._swipePoint)if(this._tapTime){const A=f[0],g=c.timeStamp-this._tapTime<500,w=this._tapPoint.dist(A)<30;g&&w?_.length>0&&(this._swipePoint=A,this._swipeTouch=_[0].identifier):this.reset()}else this._tap.touchstart(c,f,_)}touchmove(c,f,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;const A=f[0],g=A.y-this._swipePoint.y;return this._swipePoint=A,c.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(c,f,_)}touchend(c,f,_){if(this._tapTime)this._swipePoint&&_.length===0&&this.reset();else{const A=this._tap.touchend(c,f,_);A&&(this._tapTime=c.timeStamp,this._tapPoint=A)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xo{constructor(c,f,_){this._el=c,this._mousePan=f,this._touchPan=_}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Jo{constructor(c,f,_){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=f,this._mousePitch=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class pA{constructor(c,f,_,A){this._el=c,this._touchZoom=f,this._touchRotate=_,this._tapDragZoom=A,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class to{constructor(c,f){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=c,this._options=f,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const c=this._map.getCanvasContainer();c.classList.add("maplibregl-cooperative-gestures"),this._container=x.create("div","maplibregl-cooperative-gesture-screen",c);let f=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(f=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const _=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),A=document.createElement("div");A.className="maplibregl-desktop-message",A.textContent=f,this._container.appendChild(A);const g=document.createElement("div");g.className="maplibregl-mobile-message",g.textContent=_,this._container.appendChild(g),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(x.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(c){this._onCooperativeGesture(c.touches.length===1)}wheel(c){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!c[this._bypassKey])}_onCooperativeGesture(c){this._enabled&&c&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const eo=S=>S.zoom||S.drag||S.pitch||S.rotate;class zm extends o.k{}function Ld(S){return S.panDelta&&S.panDelta.mag()||S.zoomDelta||S.bearingDelta||S.pitchDelta}class wp{constructor(c,f){this.handleWindowEvent=A=>{this.handleEvent(A,`${A.type}Window`)},this.handleEvent=(A,g)=>{if(A.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const w=A.type==="renderFrame"?void 0:A,B={needsRenderFrame:!1},I={},L={},R=A.touches,O=R?this._getMapTouches(R):void 0,N=O?x.touchPos(this._map.getCanvas(),O):x.mousePos(this._map.getCanvas(),A);for(const{handlerName:et,handler:Y,allowed:Z}of this._handlers){if(!Y.isEnabled())continue;let yt;this._blockedByActive(L,Z,et)?Y.reset():Y[g||A.type]&&(yt=Y[g||A.type](A,N,O),this.mergeHandlerResult(B,I,yt,et,w),yt&&yt.needsRenderFrame&&this._triggerRenderFrame()),(yt||Y.isActive())&&(L[et]=Y)}const H={};for(const et in this._previousActiveHandlers)L[et]||(H[et]=w);this._previousActiveHandlers=L,(Object.keys(H).length||Ld(B))&&(this._changes.push([B,I,H]),this._triggerRenderFrame()),(Object.keys(L).length||Ld(B))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:K}=B;K&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],K(this._map))},this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ll(c),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(f);const _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[window,"blur",void 0]];for(const[A,g,w]of this._listeners)x.addEventListener(A,g,A===document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[c,f,_]of this._listeners)x.removeEventListener(c,f,c===document?this.handleWindowEvent:this.handleEvent,_)}_addDefaultHandlers(c){const f=this._map,_=f.getCanvasContainer();this._add("mapEvent",new bi(f,c));const A=f.boxZoom=new Pl(f,c);this._add("boxZoom",A),c.interactive&&c.boxZoom&&A.enable();const g=f.cooperativeGestures=new to(f,c.cooperativeGestures);this._add("cooperativeGestures",g),c.cooperativeGestures&&g.enable();const w=new Td(f),B=new fA(f);f.doubleClickZoom=new Fd(B,w),this._add("tapZoom",w),this._add("clickZoom",B),c.interactive&&c.doubleClickZoom&&f.doubleClickZoom.enable();const I=new bp;this._add("tapDragZoom",I);const L=f.touchPitch=new AA(f);this._add("touchPitch",L),c.interactive&&c.touchPitch&&f.touchPitch.enable(c.touchPitch);const R=Ts(c),O=Vi(c);f.dragRotate=new Jo(c,R,O),this._add("mouseRotate",R,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]),c.interactive&&c.dragRotate&&f.dragRotate.enable();const N=(yt=>{let{enable:at,clickTolerance:lt}=yt;const At=new Ss({checkCorrectEvent:Et=>x.mouseButton(Et)===0&&!Et.ctrlKey});return new Hn({clickTolerance:lt,move:(Et,Dt)=>({around:Dt,panDelta:Dt.sub(Et)}),activateOnStart:!0,moveStateManager:At,enable:at,assignEvents:Ul})})(c),H=new Rl(c,f);f.dragPan=new xo(_,N,H),this._add("mousePan",N),this._add("touchPan",H,["touchZoom","touchRotate"]),c.interactive&&c.dragPan&&f.dragPan.enable(c.dragPan);const K=new mh,et=new gu;f.touchZoomRotate=new pA(_,et,K,I),this._add("touchRotate",K,["touchPan","touchZoom"]),this._add("touchZoom",et,["touchPan","touchRotate"]),c.interactive&&c.touchZoomRotate&&f.touchZoomRotate.enable(c.touchZoomRotate);const Y=f.scrollZoom=new yh(f,()=>this._triggerRenderFrame());this._add("scrollZoom",Y,["mousePan"]),c.interactive&&c.scrollZoom&&f.scrollZoom.enable(c.scrollZoom);const Z=f.keyboard=new dA(f);this._add("keyboard",Z),c.interactive&&c.keyboard&&f.keyboard.enable(),this._add("blockableMapEvent",new Wo(f))}_add(c,f,_){this._handlers.push({handlerName:c,handler:f,allowed:_}),this._handlersById[c]=f}stop(c){if(!this._updatingCamera){for(const{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!eo(this._eventsInProgress)||this.isZooming()}_blockedByActive(c,f,_){for(const A in c)if(A!==_&&(!f||f.indexOf(A)<0))return!0;return!1}_getMapTouches(c){const f=[];for(const _ of c)this._el.contains(_.target)&&f.push(_);return f}mergeHandlerResult(c,f,_,A,g){if(!_)return;o.e(c,_);const w={handlerName:A,originalEvent:_.originalEvent||g};_.zoomDelta!==void 0&&(f.zoom=w),_.panDelta!==void 0&&(f.drag=w),_.pitchDelta!==void 0&&(f.pitch=w),_.bearingDelta!==void 0&&(f.rotate=w)}_applyChanges(){const c={},f={},_={};for(const[A,g,w]of this._changes)A.panDelta&&(c.panDelta=(c.panDelta||new o.P(0,0))._add(A.panDelta)),A.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+A.zoomDelta),A.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+A.bearingDelta),A.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+A.pitchDelta),A.around!==void 0&&(c.around=A.around),A.pinchAround!==void 0&&(c.pinchAround=A.pinchAround),A.noInertia&&(c.noInertia=A.noInertia),o.e(f,g),o.e(_,w);this._updateMapTransform(c,f,_),this._changes=[]}_updateMapTransform(c,f,_){const A=this._map,g=A._getTransformForUpdate(),w=A.terrain;if(!(Ld(c)||w&&this._terrainMovement))return this._fireEvents(f,_,!0);let{panDelta:B,zoomDelta:I,bearingDelta:L,pitchDelta:R,around:O,pinchAround:N}=c;N!==void 0&&(O=N),A._stop(!0),O=O||A.transform.centerPoint;const H=g.pointLocation(B?O.sub(B):O);L&&(g.bearing+=L),R&&(g.pitch+=R),I&&(g.zoom+=I),w?this._terrainMovement||!f.drag&&!f.zoom?f.drag&&this._terrainMovement?g.center=g.pointLocation(g.centerPoint.sub(B)):g.setLocationAtPoint(H,O):(this._terrainMovement=!0,this._map._elevationFreeze=!0,g.setLocationAtPoint(H,O)):g.setLocationAtPoint(H,O),A._applyUpdatedTransform(g),this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(f,_,!0)}_fireEvents(c,f,_){const A=eo(this._eventsInProgress),g=eo(c),w={};for(const O in c){const{originalEvent:N}=c[O];this._eventsInProgress[O]||(w[`${O}start`]=N),this._eventsInProgress[O]=c[O]}!A&&g&&this._fireEvent("movestart",g.originalEvent);for(const O in w)this._fireEvent(O,w[O]);g&&this._fireEvent("move",g.originalEvent);for(const O in c){const{originalEvent:N}=c[O];this._fireEvent(O,N)}const B={};let I;for(const O in this._eventsInProgress){const{handlerName:N,originalEvent:H}=this._eventsInProgress[O];this._handlersById[N].isActive()||(delete this._eventsInProgress[O],I=f[N]||H,B[`${O}end`]=I)}for(const O in B)this._fireEvent(O,B[O]);const L=eo(this._eventsInProgress),R=(A||g)&&!L;if(R&&this._terrainMovement&&(this._map._elevationFreeze=!1,this._terrainMovement=!1,this._map.transform.recalculateZoom(this._map.terrain)),_&&R){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),N=H=>H!==0&&-this._bearingSnap<H&&H<this._bearingSnap;!O||!O.essential&&b.prefersReducedMotion?(this._map.fire(new o.k("moveend",{originalEvent:I})),N(this._map.getBearing())&&this._map.resetNorth()):(N(O.bearing||this._map.getBearing())&&(O.bearing=0),O.freezeElevation=!0,this._map.easeTo(O,{originalEvent:I})),this._updatingCamera=!1}}_fireEvent(c,f){this._map.fire(new o.k(c,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{delete this._frameId,this.handleEvent(new zm("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Hm extends o.E{constructor(c,f){super(),this._renderFrameCallback=()=>{const _=Math.min((b.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(_)),_<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=f.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new o.N(this.transform.center.lng,this.transform.center.lat)}setCenter(c,f){return this.jumpTo({center:c},f)}panBy(c,f,_){return c=o.P.convert(c).mult(-1),this.panTo(this.transform.center,o.e({offset:c},f),_)}panTo(c,f,_){return this.easeTo(o.e({center:c},f),_)}getZoom(){return this.transform.zoom}setZoom(c,f){return this.jumpTo({zoom:c},f),this}zoomTo(c,f,_){return this.easeTo(o.e({zoom:c},f),_)}zoomIn(c,f){return this.zoomTo(this.getZoom()+1,c,f),this}zoomOut(c,f){return this.zoomTo(this.getZoom()-1,c,f),this}getBearing(){return this.transform.bearing}setBearing(c,f){return this.jumpTo({bearing:c},f),this}getPadding(){return this.transform.padding}setPadding(c,f){return this.jumpTo({padding:c},f),this}rotateTo(c,f,_){return this.easeTo(o.e({bearing:c},f),_)}resetNorth(c,f){return this.rotateTo(0,o.e({duration:1e3},c),f),this}resetNorthPitch(c,f){return this.easeTo(o.e({bearing:0,pitch:0,duration:1e3},c),f),this}snapToNorth(c,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,f):this}getPitch(){return this.transform.pitch}setPitch(c,f){return this.jumpTo({pitch:c},f),this}cameraForBounds(c,f){c=st.convert(c);const _=f&&f.bearing||0;return this._cameraForBoxAndBearing(c.getNorthWest(),c.getSouthEast(),_,f)}_cameraForBoxAndBearing(c,f,_,A){const g={top:0,bottom:0,right:0,left:0};if(typeof(A=o.e({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},A)).padding=="number"){const ce=A.padding;A.padding={top:ce,bottom:ce,right:ce,left:ce}}A.padding=o.e(g,A.padding);const w=this.transform,B=w.padding,I=new st(c,f),L=w.project(I.getNorthWest()),R=w.project(I.getNorthEast()),O=w.project(I.getSouthEast()),N=w.project(I.getSouthWest()),H=o.ba(-_),K=L.rotate(H),et=R.rotate(H),Y=O.rotate(H),Z=N.rotate(H),yt=new o.P(Math.max(K.x,et.x,Z.x,Y.x),Math.max(K.y,et.y,Z.y,Y.y)),at=new o.P(Math.min(K.x,et.x,Z.x,Y.x),Math.min(K.y,et.y,Z.y,Y.y)),lt=yt.sub(at),At=(w.width-(B.left+B.right+A.padding.left+A.padding.right))/lt.x,Et=(w.height-(B.top+B.bottom+A.padding.top+A.padding.bottom))/lt.y;if(Et<0||At<0)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Dt=Math.min(w.scaleZoom(w.scale*Math.min(At,Et)),A.maxZoom),zt=o.P.convert(A.offset),ue=new o.P((A.padding.left-A.padding.right)/2,(A.padding.top-A.padding.bottom)/2).rotate(o.ba(_)),oe=zt.add(ue).mult(w.scale/w.zoomScale(Dt));return{center:w.unproject(L.add(O).div(2).sub(oe)),zoom:Dt,bearing:_}}fitBounds(c,f,_){return this._fitInternal(this.cameraForBounds(c,f),f,_)}fitScreenCoordinates(c,f,_,A,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.P.convert(c)),this.transform.pointLocation(o.P.convert(f)),_,A),A,g)}_fitInternal(c,f,_){return c?(delete(f=o.e(c,f)).padding,f.linear?this.easeTo(f,_):this.flyTo(f,_)):this}jumpTo(c,f){this.stop();const _=this._getTransformForUpdate();let A=!1,g=!1,w=!1;return"zoom"in c&&_.zoom!==+c.zoom&&(A=!0,_.zoom=+c.zoom),c.center!==void 0&&(_.center=o.N.convert(c.center)),"bearing"in c&&_.bearing!==+c.bearing&&(g=!0,_.bearing=+c.bearing),"pitch"in c&&_.pitch!==+c.pitch&&(w=!0,_.pitch=+c.pitch),c.padding==null||_.isPaddingEqual(c.padding)||(_.padding=c.padding),this._applyUpdatedTransform(_),this.fire(new o.k("movestart",f)).fire(new o.k("move",f)),A&&this.fire(new o.k("zoomstart",f)).fire(new o.k("zoom",f)).fire(new o.k("zoomend",f)),g&&this.fire(new o.k("rotatestart",f)).fire(new o.k("rotate",f)).fire(new o.k("rotateend",f)),w&&this.fire(new o.k("pitchstart",f)).fire(new o.k("pitch",f)).fire(new o.k("pitchend",f)),this.fire(new o.k("moveend",f))}calculateCameraOptionsFromTo(c,f,_){let A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const g=o.Z.fromLngLat(c,f),w=o.Z.fromLngLat(_,A),B=w.x-g.x,I=w.y-g.y,L=w.z-g.z,R=Math.hypot(B,I,L);if(R===0)throw new Error("Can't calculate camera options with same From and To");const O=Math.hypot(B,I),N=this.transform.scaleZoom(this.transform.cameraToCenterDistance/R/this.transform.tileSize),H=180*Math.atan2(B,-I)/Math.PI;let K=180*Math.acos(O/R)/Math.PI;return K=L<0?90-K:90+K,{center:w.toLngLat(),zoom:N,pitch:K,bearing:H}}easeTo(c,f){var _;this._stop(!1,c.easeId),((c=o.e({offset:[0,0],duration:500,easing:o.b9},c)).animate===!1||!c.essential&&b.prefersReducedMotion)&&(c.duration=0);const A=this._getTransformForUpdate(),g=this.getZoom(),w=this.getBearing(),B=this.getPitch(),I=this.getPadding(),L="bearing"in c?this._normalizeBearing(c.bearing,w):w,R="pitch"in c?+c.pitch:B,O="padding"in c?c.padding:A.padding,N=o.P.convert(c.offset);let H=A.centerPoint.add(N);const K=A.pointLocation(H),{center:et,zoom:Y}=A.getConstrained(o.N.convert(c.center||K),(_=c.zoom)!==null&&_!==void 0?_:g);this._normalizeCenter(et);const Z=A.project(K),yt=A.project(et).sub(Z),at=A.zoomScale(Y-g);let lt,At;c.around&&(lt=o.N.convert(c.around),At=A.locationPoint(lt));const Et={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Y!==g,this._rotating=this._rotating||w!==L,this._pitching=this._pitching||R!==B,this._padding=!A.isPaddingEqual(O),this._easeId=c.easeId,this._prepareEase(f,c.noMoveStart,Et),this.terrain&&this._prepareElevation(et),this._ease(Dt=>{if(this._zooming&&(A.zoom=o.z.number(g,Y,Dt)),this._rotating&&(A.bearing=o.z.number(w,L,Dt)),this._pitching&&(A.pitch=o.z.number(B,R,Dt)),this._padding&&(A.interpolatePadding(I,O,Dt),H=A.centerPoint.add(N)),this.terrain&&!c.freezeElevation&&this._updateElevation(Dt),lt)A.setLocationAtPoint(lt,At);else{const zt=A.zoomScale(A.zoom-g),ue=Y>g?Math.min(2,at):Math.max(.5,at),oe=Math.pow(ue,1-Dt),ce=A.unproject(Z.add(yt.mult(Dt*oe)).mult(zt));A.setLocationAtPoint(A.renderWorldCopies?ce.wrap():ce,H)}this._applyUpdatedTransform(A),this._fireMoveEvents(f)},Dt=>{this.terrain&&c.freezeElevation&&this._finalizeElevation(),this._afterEase(f,Dt)},c),this}_prepareEase(c,f){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this._moving=!0,f||_.moving||this.fire(new o.k("movestart",c)),this._zooming&&!_.zooming&&this.fire(new o.k("zoomstart",c)),this._rotating&&!_.rotating&&this.fire(new o.k("rotatestart",c)),this._pitching&&!_.pitching&&this.fire(new o.k("pitchstart",c))}_prepareElevation(c){this._elevationCenter=c,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(c,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(c){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const f=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(c<1&&f!==this._elevationTarget){const _=this._elevationTarget-this._elevationStart;this._elevationStart+=c*(_-(f-(_*c+this._elevationStart))/(1-c)),this._elevationTarget=f}this.transform.elevation=o.z.number(this._elevationStart,this._elevationTarget,c)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(c){if(!this.transformCameraUpdate)return;const f=c.clone(),{center:_,zoom:A,pitch:g,bearing:w,elevation:B}=this.transformCameraUpdate(f);_&&(f.center=_),A!==void 0&&(f.zoom=A),g!==void 0&&(f.pitch=g),w!==void 0&&(f.bearing=w),B!==void 0&&(f.elevation=B),this.transform.apply(f)}_fireMoveEvents(c){this.fire(new o.k("move",c)),this._zooming&&this.fire(new o.k("zoom",c)),this._rotating&&this.fire(new o.k("rotate",c)),this._pitching&&this.fire(new o.k("pitch",c))}_afterEase(c,f){if(this._easeId&&f&&this._easeId===f)return;delete this._easeId;const _=this._zooming,A=this._rotating,g=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new o.k("zoomend",c)),A&&this.fire(new o.k("rotateend",c)),g&&this.fire(new o.k("pitchend",c)),this.fire(new o.k("moveend",c))}flyTo(c,f){var _;if(!c.essential&&b.prefersReducedMotion){const be=o.M(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(be,f)}this.stop(),c=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.b9},c);const A=this._getTransformForUpdate(),g=this.getZoom(),w=this.getBearing(),B=this.getPitch(),I=this.getPadding(),L="bearing"in c?this._normalizeBearing(c.bearing,w):w,R="pitch"in c?+c.pitch:B,O="padding"in c?c.padding:A.padding,N=o.P.convert(c.offset);let H=A.centerPoint.add(N);const K=A.pointLocation(H),{center:et,zoom:Y}=A.getConstrained(o.N.convert(c.center||K),(_=c.zoom)!==null&&_!==void 0?_:g);this._normalizeCenter(et);const Z=A.zoomScale(Y-g),yt=A.project(K),at=A.project(et).sub(yt);let lt=c.curve;const At=Math.max(A.width,A.height),Et=At/Z,Dt=at.mag();if("minZoom"in c){const be=o.ad(Math.min(c.minZoom,g,Y),A.minZoom,A.maxZoom),Xe=At/A.zoomScale(be-g);lt=Math.sqrt(Xe/Dt*2)}const zt=lt*lt;function ue(be){const Xe=(Et*Et-At*At+(be?-1:1)*zt*zt*Dt*Dt)/(2*(be?Et:At)*zt*Dt);return Math.log(Math.sqrt(Xe*Xe+1)-Xe)}function oe(be){return(Math.exp(be)-Math.exp(-be))/2}function ce(be){return(Math.exp(be)+Math.exp(-be))/2}const ie=ue(!1);let Pe=function(be){return ce(ie)/ce(ie+lt*be)},We=function(be){return At*((ce(ie)*(oe(Xe=ie+lt*be)/ce(Xe))-oe(ie))/zt)/Dt;var Xe},_e=(ue(!0)-ie)/lt;if(Math.abs(Dt)<1e-6||!isFinite(_e)){if(Math.abs(At-Et)<1e-6)return this.easeTo(c,f);const be=Et<At?-1:1;_e=Math.abs(Math.log(Et/At))/lt,We=()=>0,Pe=Xe=>Math.exp(be*lt*Xe)}return c.duration="duration"in c?+c.duration:1e3*_e/("screenSpeed"in c?+c.screenSpeed/lt:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0),this._zooming=!0,this._rotating=w!==L,this._pitching=R!==B,this._padding=!A.isPaddingEqual(O),this._prepareEase(f,!1),this.terrain&&this._prepareElevation(et),this._ease(be=>{const Xe=be*_e,Rr=1/Pe(Xe);A.zoom=be===1?Y:g+A.scaleZoom(Rr),this._rotating&&(A.bearing=o.z.number(w,L,be)),this._pitching&&(A.pitch=o.z.number(B,R,be)),this._padding&&(A.interpolatePadding(I,O,be),H=A.centerPoint.add(N)),this.terrain&&!c.freezeElevation&&this._updateElevation(be);const He=be===1?et:A.unproject(yt.add(at.mult(We(Xe))).mult(Rr));A.setLocationAtPoint(A.renderWorldCopies?He.wrap():He,H),this._applyUpdatedTransform(A),this._fireMoveEvents(f)},()=>{this.terrain&&c.freezeElevation&&this._finalizeElevation(),this._afterEase(f)},c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,f){var _;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const A=this._onEaseEnd;delete this._onEaseEnd,A.call(this,f)}return c||(_=this.handlers)===null||_===void 0||_.stop(!1),this}_ease(c,f,_){_.animate===!1||_.duration===0?(c(1),f()):(this._easeStart=b.now(),this._easeOptions=_,this._onEaseFrame=c,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(c,f){c=o.b3(c,-180,180);const _=Math.abs(c-f);return Math.abs(c-360-f)<_&&(c-=360),Math.abs(c+360-f)<_&&(c+=360),c}_normalizeCenter(c){const f=this.transform;if(!f.renderWorldCopies||f.lngRange)return;const _=c.lng-f.center.lng;c.lng+=_>180?-360:_<-180?360:0}queryTerrainElevation(c){return this.terrain?this.terrain.getElevationForLngLatZoom(o.N.convert(c),this.transform.tileZoom)-this.transform.elevation:null}}const Pd={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class mu{constructor(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pd;this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=f=>{!f||f.sourceDataType!=="metadata"&&f.sourceDataType!=="visibility"&&f.dataType!=="style"&&f.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=c}getDefaultPosition(){return"bottom-right"}onAdd(c){return this._map=c,this._compact=this.options.compact,this._container=x.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=x.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=x.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){x.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(c,f){const _=this._map._getUIString(`AttributionControl.${f}`);c.title=_,c.setAttribute("aria-label",_)}_updateAttributions(){if(!this._map.style)return;let c=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=c.concat(this.options.customAttribution.map(A=>typeof A!="string"?"":A)):typeof this.options.customAttribution=="string"&&c.push(this.options.customAttribution)),this._map.style.stylesheet){const A=this._map.style.stylesheet;this.styleOwner=A.owner,this.styleId=A.id}const f=this._map.style.sourceCaches;for(const A in f){const g=f[A];if(g.used||g.usedForTerrain){const w=g.getSource();w.attribution&&c.indexOf(w.attribution)<0&&c.push(w.attribution)}}c=c.filter(A=>String(A).trim()),c.sort((A,g)=>A.length-g.length),c=c.filter((A,g)=>{for(let w=g+1;w<c.length;w++)if(c[w].indexOf(A)>=0)return!1;return!0});const _=c.join(" | ");_!==this._attribHTML&&(this._attribHTML=_,c.length?(this._innerContainer.innerHTML=_,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ma{constructor(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._updateCompact=()=>{const f=this._container.children;if(f.length){const _=f[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&_.classList.add("maplibregl-compact"):_.classList.remove("maplibregl-compact")}},this.options=c}getDefaultPosition(){return"bottom-left"}onAdd(c){this._map=c,this._compact=this.options&&this.options.compact,this._container=x.create("div","maplibregl-ctrl");const f=x.create("a","maplibregl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://maplibre.org/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){x.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class je{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const f=++this._id;return this._queue.push({callback:c,id:f,cancelled:!1}),f}remove(c){const f=this._currentlyRunning,_=f?this._queue.concat(f):this._queue;for(const A of _)if(A.id===c)return void(A.cancelled=!0)}run(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const f=this._currentlyRunning=this._queue;this._queue=[];for(const _ of f)if(!_.cancelled&&(_.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Bo=o.Y([{name:"a_pos3d",type:"Int16",components:3}]);class Yo extends o.E{constructor(c){super(),this.sourceCache=c,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,c.usedForTerrain=!0,c.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(c,f){this.sourceCache.update(c,f),this._renderableTilesKeys=[];const _={};for(const A of c.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:f}))_[A.key]=!0,this._renderableTilesKeys.push(A.key),this._tiles[A.key]||(A.posMatrix=new Float64Array(16),o.aQ(A.posMatrix,0,o.X,0,o.X,0,1),this._tiles[A.key]=new An(A,this.tileSize));for(const A in this._tiles)_[A]||delete this._tiles[A]}freeRtt(c){for(const f in this._tiles){const _=this._tiles[f];(!c||_.tileID.equals(c)||_.tileID.isChildOf(c)||c.isChildOf(_.tileID))&&(_.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(c=>this.getTileByID(c))}getTileByID(c){return this._tiles[c]}getTerrainCoords(c){const f={};for(const _ of this._renderableTilesKeys){const A=this._tiles[_].tileID;if(A.canonical.equals(c.canonical)){const g=c.clone();g.posMatrix=new Float64Array(16),o.aQ(g.posMatrix,0,o.X,0,o.X,0,1),f[_]=g}else if(A.canonical.isChildOf(c.canonical)){const g=c.clone();g.posMatrix=new Float64Array(16);const w=A.canonical.z-c.canonical.z,B=A.canonical.x-(A.canonical.x>>w<<w),I=A.canonical.y-(A.canonical.y>>w<<w),L=o.X>>w;o.aQ(g.posMatrix,0,L,0,L,0,1),o.J(g.posMatrix,g.posMatrix,[-B*L,-I*L,0]),f[_]=g}else if(c.canonical.isChildOf(A.canonical)){const g=c.clone();g.posMatrix=new Float64Array(16);const w=c.canonical.z-A.canonical.z,B=c.canonical.x-(c.canonical.x>>w<<w),I=c.canonical.y-(c.canonical.y>>w<<w),L=o.X>>w;o.aQ(g.posMatrix,0,o.X,0,o.X,0,1),o.J(g.posMatrix,g.posMatrix,[B*L,I*L,0]),o.K(g.posMatrix,g.posMatrix,[1/2**w,1/2**w,0]),f[_]=g}}return f}getSourceTile(c,f){const _=this.sourceCache._source;let A=c.overscaledZ-this.deltaZoom;if(A>_.maxzoom&&(A=_.maxzoom),A<_.minzoom)return null;this._sourceTileCache[c.key]||(this._sourceTileCache[c.key]=c.scaledTo(A).key);let g=this.sourceCache.getTileByID(this._sourceTileCache[c.key]);if((!g||!g.dem)&&f)for(;A>=_.minzoom&&(!g||!g.dem);)g=this.sourceCache.getTileByID(c.scaledTo(A--).key);return g}tilesAfterTime(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Date.now();return Object.values(this._tiles).filter(f=>f.timeAdded>=c)}}class xp{constructor(c,f,_){this.painter=c,this.sourceCache=new Yo(f),this.options=_,this.exaggeration=typeof _.exaggeration=="number"?_.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(c,f,_){let A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:o.X;var g;if(!(f>=0&&f<A&&_>=0&&_<A))return 0;const w=this.getTerrainData(c),B=(g=w.tile)===null||g===void 0?void 0:g.dem;if(!B)return 0;const I=function(K,et,Y){var Z=et[0],yt=et[1];return K[0]=Y[0]*Z+Y[4]*yt+Y[12],K[1]=Y[1]*Z+Y[5]*yt+Y[13],K}([],[f/A*o.X,_/A*o.X],w.u_terrain_matrix),L=[I[0]*B.dim,I[1]*B.dim],R=Math.floor(L[0]),O=Math.floor(L[1]),N=L[0]-R,H=L[1]-O;return B.get(R,O)*(1-N)*(1-H)+B.get(R+1,O)*N*(1-H)+B.get(R,O+1)*(1-N)*H+B.get(R+1,O+1)*N*H}getElevationForLngLatZoom(c,f){const{tileID:_,mercatorX:A,mercatorY:g}=this._getOverscaledTileIDFromLngLatZoom(c,f);return this.getElevation(_,A%o.X,g%o.X,o.X)}getElevation(c,f,_){let A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:o.X;return this.getDEMElevation(c,f,_,A)*this.exaggeration}getTerrainData(c){if(!this._emptyDemTexture){const A=this.painter.context,g=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ot(A,g,A.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ot(A,new o.R({width:1,height:1}),A.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(A.gl.NEAREST,A.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.ao([])}const f=this.sourceCache.getSourceTile(c,!0);if(f&&f.dem&&(!f.demTexture||f.needsTerrainPrepare)){const A=this.painter.context;f.demTexture=this.painter.getTileTexture(f.dem.stride),f.demTexture?f.demTexture.update(f.dem.getPixels(),{premultiply:!1}):f.demTexture=new ot(A,f.dem.getPixels(),A.gl.RGBA,{premultiply:!1}),f.demTexture.bind(A.gl.NEAREST,A.gl.CLAMP_TO_EDGE),f.needsTerrainPrepare=!1}const _=f&&f+f.tileID.key+c.key;if(_&&!this._demMatrixCache[_]){const A=this.sourceCache.sourceCache._source.maxzoom;let g=c.canonical.z-f.tileID.canonical.z;c.overscaledZ>c.canonical.z&&(c.canonical.z>=A?g=c.canonical.z-A:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const w=c.canonical.x-(c.canonical.x>>g<<g),B=c.canonical.y-(c.canonical.y>>g<<g),I=o.bb(new Float64Array(16),[1/(o.X<<g),1/(o.X<<g),0]);o.J(I,I,[w*o.X,B*o.X,0]),this._demMatrixCache[c.key]={matrix:I,coord:c}}return{u_depth:2,u_terrain:3,u_terrain_dim:f&&f.dem&&f.dem.dim||1,u_terrain_matrix:_?this._demMatrixCache[c.key].matrix:this._emptyDemMatrix,u_terrain_unpack:f&&f.dem&&f.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(f&&f.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:f}}getFramebuffer(c){const f=this.painter,_=f.width/devicePixelRatio,A=f.height/devicePixelRatio;return!this._fbo||this._fbo.width===_&&this._fbo.height===A||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ot(f.context,{width:_,height:A,data:null},f.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(f.context.gl.NEAREST,f.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ot(f.context,{width:_,height:A,data:null},f.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(f.context.gl.NEAREST,f.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=f.context.createFramebuffer(_,A,!0,!1),this._fbo.depthAttachment.set(f.context.createRenderbuffer(f.context.gl.DEPTH_COMPONENT16,_,A))),this._fbo.colorAttachment.set(c==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const c=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const f=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let g=0,w=0;g<this._coordsTextureSize;g++)for(let B=0;B<this._coordsTextureSize;B++,w+=4)f[w+0]=255&B,f[w+1]=255&g,f[w+2]=B>>8<<4|g>>8,f[w+3]=0;const _=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(f.buffer)),A=new ot(c,_,c.gl.RGBA,{premultiply:!1});return A.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),this._coordsTexture=A,A}pointCoordinate(c){this.painter.maybeDrawDepthAndCoords(!0);const f=new Uint8Array(4),_=this.painter.context,A=_.gl,g=Math.round(c.x*this.painter.pixelRatio/devicePixelRatio),w=Math.round(c.y*this.painter.pixelRatio/devicePixelRatio),B=Math.round(this.painter.height/devicePixelRatio);_.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),A.readPixels(g,B-w-1,1,1,A.RGBA,A.UNSIGNED_BYTE,f),_.bindFramebuffer.set(null);const I=f[0]+(f[2]>>4<<8),L=f[1]+((15&f[2])<<8),R=this.coordsIndex[255-f[3]],O=R&&this.sourceCache.getTileByID(R);if(!O)return null;const N=this._coordsTextureSize,H=(1<<O.tileID.canonical.z)*N;return new o.Z((O.tileID.canonical.x*N+I)/H+O.tileID.wrap,(O.tileID.canonical.y*N+L)/H,this.getElevation(O.tileID,I,L,N))}depthAtPoint(c){const f=new Uint8Array(4),_=this.painter.context,A=_.gl;return _.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),A.readPixels(c.x,this.painter.height/devicePixelRatio-c.y-1,1,1,A.RGBA,A.UNSIGNED_BYTE,f),_.bindFramebuffer.set(null),(f[0]/16777216+f[1]/65536+f[2]/256+f[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const c=this.painter.context,f=new o.bc,_=new o.aY,A=this.meshSize,g=o.X/A,w=A*A;for(let O=0;O<=A;O++)for(let N=0;N<=A;N++)f.emplaceBack(N*g,O*g,0);for(let O=0;O<w;O+=A+1)for(let N=0;N<A;N++)_.emplaceBack(N+O,A+N+O+1,A+N+O+2),_.emplaceBack(N+O,A+N+O+2,N+O+1);const B=f.length,I=B+2*(A+1);for(const O of[0,1])for(let N=0;N<=A;N++)for(const H of[0,1])f.emplaceBack(N*g,O*o.X,H);for(let O=0;O<2*A;O+=2)_.emplaceBack(I+O,I+O+1,I+O+3),_.emplaceBack(I+O,I+O+3,I+O+2),_.emplaceBack(B+O,B+O+3,B+O+1),_.emplaceBack(B+O,B+O+2,B+O+3);const L=f.length,R=L+2*(A+1);for(const O of[0,1])for(let N=0;N<=A;N++)for(const H of[0,1])f.emplaceBack(O*o.X,N*g,H);for(let O=0;O<2*A;O+=2)_.emplaceBack(L+O,L+O+1,L+O+3),_.emplaceBack(L+O,L+O+3,L+O+2),_.emplaceBack(R+O,R+O+3,R+O+1),_.emplaceBack(R+O,R+O+2,R+O+3);return this._mesh=new Ka(c.createVertexBuffer(f,Bo.members),c.createIndexBuffer(_),o.a0.simpleSegment(0,0,f.length,_.length)),this._mesh}getMeshFrameDelta(c){return 2*Math.PI*o.bd/Math.pow(2,c)/5}getMinTileElevationForLngLatZoom(c,f){var _;const{tileID:A}=this._getOverscaledTileIDFromLngLatZoom(c,f);return(_=this.getMinMaxElevation(A).minElevation)!==null&&_!==void 0?_:0}getMinMaxElevation(c){const f=this.getTerrainData(c).tile,_={minElevation:null,maxElevation:null};return f&&f.dem&&(_.minElevation=f.dem.min*this.exaggeration,_.maxElevation=f.dem.max*this.exaggeration),_}_getOverscaledTileIDFromLngLatZoom(c,f){const _=o.Z.fromLngLat(c.wrap()),A=(1<<f)*o.X,g=_.x*A,w=_.y*A,B=Math.floor(g/o.X),I=Math.floor(w/o.X);return{tileID:new o.S(f,0,f,B,I),mercatorX:g,mercatorY:w}}}class yu{constructor(c,f,_){this._context=c,this._size=f,this._tileSize=_,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const c of this._objects)c.texture.destroy(),c.fbo.destroy()}_createObject(c){const f=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),_=new ot(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return _.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),f.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),f.colorAttachment.set(_.texture),{id:c,fbo:f,texture:_,stamp:-1,inUse:!1}}getObjectForId(c){return this._objects[c]}useObject(c){c.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(f=>c.id!==f),this._recentlyUsed.push(c.id)}stampObject(c){c.stamp=++this._stamp}getOrCreateFreeObject(){for(const f of this._recentlyUsed)if(!this._objects[f].inUse)return this._objects[f];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const c=this._createObject(this._objects.length);return this._objects.push(c),c}freeObject(c){c.inUse=!1}freeAllObjects(){for(const c of this._objects)this.freeObject(c)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(c=>!c.inUse)===!1}}const ns={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class ro{constructor(c,f){this.painter=c,this.terrain=f,this.pool=new yu(c.context,30,f.sourceCache.tileSize*f.qualityFactor)}destruct(){this.pool.destruct()}getTexture(c){return this.pool.getObjectForId(c.rtt[this._stacks.length-1].id).texture}prepareForRender(c,f){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=c._order.filter(_=>!c._layers[_].isHidden(f)),this._coordsDescendingInv={};for(const _ in c.sourceCaches){this._coordsDescendingInv[_]={};const A=c.sourceCaches[_].getVisibleCoordinates();for(const g of A){const w=this.terrain.sourceCache.getTerrainCoords(g);for(const B in w)this._coordsDescendingInv[_][B]||(this._coordsDescendingInv[_][B]=[]),this._coordsDescendingInv[_][B].push(w[B])}}this._coordsDescendingInvStr={};for(const _ of c._order){const A=c._layers[_],g=A.source;if(ns[A.type]&&!this._coordsDescendingInvStr[g]){this._coordsDescendingInvStr[g]={};for(const w in this._coordsDescendingInv[g])this._coordsDescendingInvStr[g][w]=this._coordsDescendingInv[g][w].map(B=>B.key).sort().join()}}for(const _ of this._renderableTiles)for(const A in this._coordsDescendingInvStr){const g=this._coordsDescendingInvStr[A][_.tileID.key];g&&g!==_.rttCoords[A]&&(_.rtt=[])}}renderLayer(c){if(c.isHidden(this.painter.transform.zoom))return!1;const f=c.type,_=this.painter,A=this._renderableLayerIds[this._renderableLayerIds.length-1]===c.id;if(ns[f]&&(this._prevType&&ns[this._prevType]||this._stacks.push([]),this._prevType=f,this._stacks[this._stacks.length-1].push(c.id),!A))return!0;if(ns[this._prevType]||ns[f]&&A){this._prevType=f;const g=this._stacks.length-1,w=this._stacks[g]||[];for(const B of this._renderableTiles){if(this.pool.isFull()&&(xs(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(B),B.rtt[g]){const L=this.pool.getObjectForId(B.rtt[g].id);if(L.stamp===B.rtt[g].stamp){this.pool.useObject(L);continue}}const I=this.pool.getOrCreateFreeObject();this.pool.useObject(I),this.pool.stampObject(I),B.rtt[g]={id:I.id,stamp:I.stamp},_.context.bindFramebuffer.set(I.fbo.framebuffer),_.context.clear({color:o.aN.transparent,stencil:0}),_.currentStencilSource=void 0;for(let L=0;L<w.length;L++){const R=_.style._layers[w[L]],O=R.source?this._coordsDescendingInv[R.source][B.tileID.key]:[B.tileID];_.context.viewport.set([0,0,I.fbo.width,I.fbo.height]),_._renderTileClippingMasks(R,O),_.renderLayer(_,_.style.sourceCaches[R.source],R,O),R.source&&(B.rttCoords[R.source]=this._coordsDescendingInvStr[R.source][B.tileID.key])}}return xs(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),ns[f]}return!1}}const $e={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Md=d,Bp={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Pd,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Ud=S=>{S.touchstart=S.dragStart,S.touchmoveWindow=S.dragMove,S.touchend=S.dragEnd},_h={showCompass:!0,showZoom:!0,visualizePitch:!1};class Rd{constructor(c,f){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.mousedown=w=>{this.startMouse(o.e({},w,{ctrlKey:!0,preventDefault:()=>w.preventDefault()}),x.mousePos(this.element,w)),x.addEventListener(window,"mousemove",this.mousemove),x.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.moveMouse(w,x.mousePos(this.element,w))},this.mouseup=w=>{this.mouseRotate.dragEnd(w),this.mousePitch&&this.mousePitch.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=x.touchPos(this.element,w.targetTouches)[0],this.startTouch(w,this._startPos),x.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),x.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=x.touchPos(this.element,w.targetTouches)[0],this.moveTouch(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const A=c.dragRotate._mouseRotate.getClickTolerance(),g=c.dragRotate._mousePitch.getClickTolerance();this.element=f,this.mouseRotate=Ts({clickTolerance:A,enable:!0}),this.touchRotate=(w=>{let{enable:B,clickTolerance:I,bearingDegreesPerPixelMoved:L=.8}=w;const R=new du;return new Hn({clickTolerance:I,move:(O,N)=>({bearingDelta:(N.x-O.x)*L}),moveStateManager:R,enable:B,assignEvents:Ud})})({clickTolerance:A,enable:!0}),this.map=c,_&&(this.mousePitch=Vi({clickTolerance:g,enable:!0}),this.touchPitch=(w=>{let{enable:B,clickTolerance:I,pitchDegreesPerPixelMoved:L=-.5}=w;const R=new du;return new Hn({clickTolerance:I,move:(O,N)=>({pitchDelta:(N.y-O.y)*L}),moveStateManager:R,enable:B,assignEvents:Ud})})({clickTolerance:g,enable:!0})),x.addEventListener(f,"mousedown",this.mousedown),x.addEventListener(f,"touchstart",this.touchstart,{passive:!1}),x.addEventListener(f,"touchcancel",this.reset)}startMouse(c,f){this.mouseRotate.dragStart(c,f),this.mousePitch&&this.mousePitch.dragStart(c,f),x.disableDrag()}startTouch(c,f){this.touchRotate.dragStart(c,f),this.touchPitch&&this.touchPitch.dragStart(c,f),x.disableDrag()}moveMouse(c,f){const _=this.map,{bearingDelta:A}=this.mouseRotate.dragMove(c,f)||{};if(A&&_.setBearing(_.getBearing()+A),this.mousePitch){const{pitchDelta:g}=this.mousePitch.dragMove(c,f)||{};g&&_.setPitch(_.getPitch()+g)}}moveTouch(c,f){const _=this.map,{bearingDelta:A}=this.touchRotate.dragMove(c,f)||{};if(A&&_.setBearing(_.getBearing()+A),this.touchPitch){const{pitchDelta:g}=this.touchPitch.dragMove(c,f)||{};g&&_.setPitch(_.getPitch()+g)}}off(){const c=this.element;x.removeEventListener(c,"mousedown",this.mousedown),x.removeEventListener(c,"touchstart",this.touchstart,{passive:!1}),x.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),x.removeEventListener(window,"touchend",this.touchend),x.removeEventListener(c,"touchcancel",this.reset),this.offTemp()}offTemp(){x.enableDrag(),x.removeEventListener(window,"mousemove",this.mousemove),x.removeEventListener(window,"mouseup",this.mouseup),x.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),x.removeEventListener(window,"touchend",this.touchend)}}let Dl;function gA(S,c,f){const _=new o.N(S.lng,S.lat);if(S=new o.N(S.lng,S.lat),c){const A=new o.N(S.lng-360,S.lat),g=new o.N(S.lng+360,S.lat),w=f.locationPoint(S).distSqr(c);f.locationPoint(A).distSqr(c)<w?S=A:f.locationPoint(g).distSqr(c)<w&&(S=g)}for(;Math.abs(S.lng-f.center.lng)>180;){const A=f.locationPoint(S);if(A.x>=0&&A.y>=0&&A.x<=f.width&&A.y<=f.height)break;S.lng>f.center.lng?S.lng-=360:S.lng+=360}return S.lng!==_.lng&&f.locationPoint(S).y>f.height/2-f.getHorizon()?S:_}const _u={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Co(S,c,f){const _=S.classList;for(const A in _u)_.remove(`maplibregl-${f}-anchor-${A}`);_.add(`maplibregl-${f}-anchor-${c}`)}class Un extends o.E{constructor(c){if(super(),this._onKeyPress=f=>{const _=f.code,A=f.charCode||f.keyCode;_!=="Space"&&_!=="Enter"&&A!==32&&A!==13||this.togglePopup()},this._onMapClick=f=>{const _=f.originalEvent.target,A=this._element;this._popup&&(_===A||A.contains(_))&&this.togglePopup()},this._update=f=>{var _;if(!this._map)return;const A=this._map.loaded()&&!this._map.isMoving();((f==null?void 0:f.type)==="terrain"||(f==null?void 0:f.type)==="render"&&!A)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?gA(this._lngLat,this._flatPos,this._map.transform):(_=this._lngLat)===null||_===void 0?void 0:_.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let g="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?g=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(g=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),f&&f.type!=="moveend"||(this._pos=this._pos.round()),x.setTransform(this._element,`${_u[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${g}`),b.frameAsync(new AbortController).then(()=>{this._updateOpacity(f&&f.type==="moveend")}).catch(()=>{})},this._onMove=f=>{if(!this._isDragging){const _=this._clickTolerance||this._map._clickTolerance;this._isDragging=f.point.dist(this._pointerdownPos)>=_}this._isDragging&&(this._pos=f.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.k("dragstart"))),this.fire(new o.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.k("dragend")),this._state="inactive"},this._addDragHandler=f=>{this._element.contains(f.originalEvent.target)&&(f.preventDefault(),this._positionDelta=f.point.sub(this._pos).add(this._offset),this._pointerdownPos=f.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment!=="auto"?c.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(c==null?void 0:c.opacity,c==null?void 0:c.opacityWhenCovered),c&&c.element)this._element=c.element,this._offset=o.P.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=x.create("div");const f=x.createNS("http://www.w3.org/2000/svg","svg"),_=41,A=27;f.setAttributeNS(null,"display","block"),f.setAttributeNS(null,"height",`${_}px`),f.setAttributeNS(null,"width",`${A}px`),f.setAttributeNS(null,"viewBox",`0 0 ${A} ${_}`);const g=x.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"stroke","none"),g.setAttributeNS(null,"stroke-width","1"),g.setAttributeNS(null,"fill","none"),g.setAttributeNS(null,"fill-rule","evenodd");const w=x.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill-rule","nonzero");const B=x.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"transform","translate(3.0, 29.0)"),B.setAttributeNS(null,"fill","#000000");const I=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Z of I){const yt=x.createNS("http://www.w3.org/2000/svg","ellipse");yt.setAttributeNS(null,"opacity","0.04"),yt.setAttributeNS(null,"cx","10.5"),yt.setAttributeNS(null,"cy","5.80029008"),yt.setAttributeNS(null,"rx",Z.rx),yt.setAttributeNS(null,"ry",Z.ry),B.appendChild(yt)}const L=x.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill",this._color);const R=x.createNS("http://www.w3.org/2000/svg","path");R.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),L.appendChild(R);const O=x.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"opacity","0.25"),O.setAttributeNS(null,"fill","#000000");const N=x.createNS("http://www.w3.org/2000/svg","path");N.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),O.appendChild(N);const H=x.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(6.0, 7.0)"),H.setAttributeNS(null,"fill","#FFFFFF");const K=x.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"transform","translate(8.0, 8.0)");const et=x.createNS("http://www.w3.org/2000/svg","circle");et.setAttributeNS(null,"fill","#000000"),et.setAttributeNS(null,"opacity","0.25"),et.setAttributeNS(null,"cx","5.5"),et.setAttributeNS(null,"cy","5.5"),et.setAttributeNS(null,"r","5.4999962");const Y=x.createNS("http://www.w3.org/2000/svg","circle");Y.setAttributeNS(null,"fill","#FFFFFF"),Y.setAttributeNS(null,"cx","5.5"),Y.setAttributeNS(null,"cy","5.5"),Y.setAttributeNS(null,"r","5.4999962"),K.appendChild(et),K.appendChild(Y),w.appendChild(B),w.appendChild(L),w.appendChild(O),w.appendChild(H),w.appendChild(K),f.appendChild(w),f.setAttributeNS(null,"height",_*this._scale+"px"),f.setAttributeNS(null,"width",A*this._scale+"px"),this._element.appendChild(f),this._offset=o.P.convert(c&&c.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",f=>{f.preventDefault()}),this._element.addEventListener("mousedown",f=>{f.preventDefault()}),Co(this._element,this._anchor,"marker"),c&&c.className)for(const f of c.className.split(" "))this._element.classList.add(f);this._popup=null}addTo(c){return this.remove(),this._map=c,this._element.setAttribute("aria-label",c._getUIString("Marker.Title")),c.getCanvasContainer().appendChild(this._element),c.on("move",this._update),c.on("moveend",this._update),c.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),x.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=o.N.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const A=Math.abs(13.5)/Math.SQRT2;c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[A,-1*(38.1-13.5+A)],"bottom-right":[-A,-1*(38.1-13.5+A)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=c,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const c=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:c?(c.isOpen()?c.remove():(c.setLngLat(this._lngLat),c.addTo(this._map)),this):this}_updateOpacity(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;var f,_;if(!(!((f=this._map)===null||f===void 0)&&f.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(c)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const A=this._map,g=A.terrain.depthAtPoint(this._pos),w=A.terrain.getElevationForLngLatZoom(this._lngLat,A.transform.tileZoom);if(A.transform.lngLatToCameraDepth(this._lngLat,w)-g<.006)return void(this._element.style.opacity=this._opacity);const B=-this._offset.y/A.transform._pixelPerMeter,I=Math.sin(A.getPitch()*Math.PI/180)*B,L=A.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),R=A.transform.lngLatToCameraDepth(this._lngLat,w+I)-L>.006;!((_=this._popup)===null||_===void 0)&&_.isOpen()&&R&&this._popup.remove(),this._element.style.opacity=R?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(c){return this._offset=o.P.convert(c),this._update(),this}addClassName(c){this._element.classList.add(c)}removeClassName(c){this._element.classList.remove(c)}toggleClassName(c){return this._element.classList.toggle(c)}setDraggable(c){return this._draggable=!!c,this._map&&(c?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c&&c!=="auto"?c:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(c,f){return c===void 0&&f===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),c!==void 0&&(this._opacity=c),f!==void 0&&(this._opacityWhenCovered=f),this._map&&this._updateOpacity(!0),this}}const mA={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let vu=0,Sc=!1;const Cp={maxWidth:100,unit:"metric"};function Od(S,c,f){const _=f&&f.maxWidth||100,A=S._container.clientHeight/2,g=S.unproject([0,A]),w=S.unproject([_,A]),B=g.distanceTo(w);if(f&&f.unit==="imperial"){const I=3.2808*B;I>5280?yA(c,_,I/5280,S._getUIString("ScaleControl.Miles")):yA(c,_,I,S._getUIString("ScaleControl.Feet"))}else f&&f.unit==="nautical"?yA(c,_,B/1852,S._getUIString("ScaleControl.NauticalMiles")):B>=1e3?yA(c,_,B/1e3,S._getUIString("ScaleControl.Kilometers")):yA(c,_,B,S._getUIString("ScaleControl.Meters"))}function yA(S,c,f,_){const A=function(g){const w=Math.pow(10,`${Math.floor(g)}`.length-1);let B=g/w;return B=B>=10?10:B>=5?5:B>=3?3:B>=2?2:B>=1?1:function(I){const L=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*L)/L}(B),w*B}(f);S.style.width=c*(A/f)+"px",S.innerHTML=`${A}&nbsp;${_}`}const ya={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},vh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ur(S){if(S){if(typeof S=="number"){const c=Math.round(Math.abs(S)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,S),"top-left":new o.P(c,c),"top-right":new o.P(-c,c),bottom:new o.P(0,-S),"bottom-left":new o.P(c,-c),"bottom-right":new o.P(-c,-c),left:new o.P(S,0),right:new o.P(-S,0)}}if(S instanceof o.P||Array.isArray(S)){const c=o.P.convert(S);return{center:c,top:c,"top-left":c,"top-right":c,bottom:c,"bottom-left":c,"bottom-right":c,left:c,right:c}}return{center:o.P.convert(S.center||[0,0]),top:o.P.convert(S.top||[0,0]),"top-left":o.P.convert(S["top-left"]||[0,0]),"top-right":o.P.convert(S["top-right"]||[0,0]),bottom:o.P.convert(S.bottom||[0,0]),"bottom-left":o.P.convert(S["bottom-left"]||[0,0]),"bottom-right":o.P.convert(S["bottom-right"]||[0,0]),left:o.P.convert(S.left||[0,0]),right:o.P.convert(S.right||[0,0])}}return ur(new o.P(0,0))}const Er=d;a.AJAXError=o.bg,a.Evented=o.E,a.LngLat=o.N,a.MercatorCoordinate=o.Z,a.Point=o.P,a.addProtocol=o.bh,a.config=o.a,a.removeProtocol=o.bi,a.AttributionControl=mu,a.BoxZoomHandler=Pl,a.CanvasSource=yr,a.CooperativeGesturesHandler=to,a.DoubleClickZoomHandler=Fd,a.DragPanHandler=xo,a.DragRotateHandler=Jo,a.EdgeInsets=ks,a.FullscreenControl=class extends o.E{constructor(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this._onFullscreenChange=()=>{var c;let f=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((c=f==null?void 0:f.shadowRoot)===null||c===void 0)&&c.fullscreenElement;)f=f.shadowRoot.fullscreenElement;f===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,S&&S.container&&(S.container instanceof HTMLElement?this._container=S.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(S){return this._map=S,this._container||(this._container=this._map.getContainer()),this._controlContainer=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){x.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const S=this._fullscreenButton=x.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);x.create("span","maplibregl-ctrl-icon",S).setAttribute("aria-hidden","true"),S.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const S=this._getTitle();this._fullscreenButton.setAttribute("aria-label",S),this._fullscreenButton.title=S}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},a.GeoJSONSource=Le,a.GeolocateControl=class extends o.E{constructor(S){super(),this._onSuccess=c=>{if(this._map){if(this._isOutOfMapMaxBounds(c))return this._setErrorState(),this.fire(new o.k("outofmaxbounds",c)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=c,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(c),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(c),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.k("geolocate",c)),this._finish()}},this._updateCamera=c=>{const f=new o.N(c.coords.longitude,c.coords.latitude),_=c.coords.accuracy,A=this._map.getBearing(),g=o.e({bearing:A},this.options.fitBoundsOptions),w=st.fromLngLat(f,_);this._map.fitBounds(w,g,{geolocateSource:!0})},this._updateMarker=c=>{if(c){const f=new o.N(c.coords.longitude,c.coords.latitude);this._accuracyCircleMarker.setLngLat(f).addTo(this._map),this._userLocationDotMarker.setLngLat(f).addTo(this._map),this._accuracy=c.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=c=>{if(this._map){if(this.options.trackUserLocation)if(c.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const f=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=f,this._geolocateButton.setAttribute("aria-label",f),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(c.code===3&&Sc)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.k("error",c)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=c=>{if(this._map){if(this._container.addEventListener("contextmenu",f=>f.preventDefault()),this._geolocateButton=x.create("button","maplibregl-ctrl-geolocate",this._container),x.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",c===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const f=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=f,this._geolocateButton.setAttribute("aria-label",f)}else{const f=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=f,this._geolocateButton.setAttribute("aria-label",f)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=x.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Un({element:this._dotElement}),this._circleElement=x.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Un({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",f=>{f.geolocateSource||this._watchState!=="ACTIVE_LOCK"||f.originalEvent&&f.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.k("trackuserlocationend")),this.fire(new o.k("userlocationlostfocus")))})}},this.options=o.e({},mA,S)}onAdd(S){return this._map=S,this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(){return o._(this,arguments,void 0,function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return function*(){if(Dl!==void 0&&!c)return Dl;if(window.navigator.permissions===void 0)return Dl=!!window.navigator.geolocation,Dl;try{Dl=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Dl=!!window.navigator.geolocation}return Dl}()})}().then(c=>this._setupUI(c)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),x.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,vu=0,Sc=!1}_isOutOfMapMaxBounds(S){const c=this._map.getMaxBounds(),f=S.coords;return c&&(f.longitude<c.getWest()||f.longitude>c.getEast()||f.latitude<c.getSouth()||f.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const S=this._map.getBounds(),c=S.getSouthEast(),f=S.getNorthEast(),_=c.distanceTo(f),A=Math.ceil(this._accuracy/(_/this._map._container.clientHeight)*2);this._circleElement.style.width=`${A}px`,this._circleElement.style.height=`${A}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":vu--,Sc=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.k("trackuserlocationstart")),this.fire(new o.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let S;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),vu++,vu>1?(S={maximumAge:6e5,timeout:0},Sc=!0):(S=this.options.positionOptions,Sc=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,S)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},a.Hash=Cs,a.ImageSource=Ye,a.KeyboardHandler=dA,a.LngLatBounds=st,a.LogoControl=ma,a.Map=class extends Hm{constructor(S){o.be.mark(o.bf.create);const c=Object.assign(Object.assign({},Bp),S);if(c.minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Ec(c.minZoom,c.maxZoom,c.minPitch,c.maxPitch,c.renderWorldCopies),{bearingSnap:c.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new je,this._controls=[],this._mapId=o.a4(),this._contextLost=f=>{f.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.k("webglcontextlost",{originalEvent:f}))},this._contextRestored=f=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.k("webglcontextrestored",{originalEvent:f}))},this._onMapScroll=f=>{if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._maxTileCacheZoomLevels=c.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=c.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=c.preserveDrawingBuffer===!0,this._antialias=c.antialias===!0,this._trackResize=c.trackResize===!0,this._bearingSnap=c.bearingSnap,this._refreshExpiredTiles=c.refreshExpiredTiles===!0,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions===!0,this._collectResourceTiming=c.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},$e),c.locale),this._clickTolerance=c.clickTolerance,this._overridePixelRatio=c.pixelRatio,this._maxCanvasSize=c.maxCanvasSize,this.transformCameraUpdate=c.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=c.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=$.addThrottleControl(()=>this.isMoving()),this._requestManager=new tt(c.transformRequest),typeof c.container=="string"){if(this._container=document.getElementById(c.container),!this._container)throw new Error(`Container '${c.container}' not found.`)}else{if(!(c.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let f=!1;const _=Ko(A=>{this._trackResize&&!this._removed&&this.resize(A)._update()},50);this._resizeObserver=new ResizeObserver(A=>{f?_(A):f=!0}),this._resizeObserver.observe(this._container)}this.handlers=new wp(this,c),this._hash=c.hash&&new Cs(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,o.e({},c.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=c.localIdeographFontFamily,this._validateStyle=c.validateStyle,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new mu(typeof c.attributionControl=="boolean"?void 0:c.attributionControl)),c.maplibreLogo&&this.addControl(new ma,c.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",f=>{this._update(f.dataType==="style"),this.fire(new o.k(`${f.dataType}data`,f))}),this.on("dataloading",f=>{this.fire(new o.k(`${f.dataType}dataloading`,f))}),this.on("dataabort",f=>{this.fire(new o.k("sourcedataabort",f))})}_getMapId(){return this._mapId}addControl(S,c){if(c===void 0&&(c=S.getDefaultPosition?S.getDefaultPosition():"top-right"),!S||!S.onAdd)return this.fire(new o.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const f=S.onAdd(this);this._controls.push(S);const _=this._controlPositions[c];return c.indexOf("bottom")!==-1?_.insertBefore(f,_.firstChild):_.appendChild(f),this}removeControl(S){if(!S||!S.onRemove)return this.fire(new o.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(S);return c>-1&&this._controls.splice(c,1),S.onRemove(this),this}hasControl(S){return this._controls.indexOf(S)>-1}calculateCameraOptionsFromTo(S,c,f,_){return _==null&&this.terrain&&(_=this.terrain.getElevationForLngLatZoom(f,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(S,c,f,_)}resize(S){var c;const f=this._containerDimensions(),_=f[0],A=f[1],g=this._getClampedPixelRatio(_,A);if(this._resizeCanvas(_,A,g),this.painter.resize(_,A,g),this.painter.overLimit()){const B=this.painter.context.gl;this._maxCanvasSize=[B.drawingBufferWidth,B.drawingBufferHeight];const I=this._getClampedPixelRatio(_,A);this._resizeCanvas(_,A,I),this.painter.resize(_,A,I)}this.transform.resize(_,A),(c=this._requestedCameraState)===null||c===void 0||c.resize(_,A);const w=!this._moving;return w&&(this.stop(),this.fire(new o.k("movestart",S)).fire(new o.k("move",S))),this.fire(new o.k("resize",S)),w&&this.fire(new o.k("moveend",S)),this}_getClampedPixelRatio(S,c){const{0:f,1:_}=this._maxCanvasSize,A=this.getPixelRatio(),g=S*A,w=c*A;return Math.min(g>f?f/g:1,w>_?_/w:1)*A}getPixelRatio(){var S;return(S=this._overridePixelRatio)!==null&&S!==void 0?S:devicePixelRatio}setPixelRatio(S){this._overridePixelRatio=S,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(S){return this.transform.setMaxBounds(st.convert(S)),this._update()}setMinZoom(S){if((S=S??-2)>=-2&&S<=this.transform.maxZoom)return this.transform.minZoom=S,this._update(),this.getZoom()<S&&this.setZoom(S),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(S){if((S=S??22)>=this.transform.minZoom)return this.transform.maxZoom=S,this._update(),this.getZoom()>S&&this.setZoom(S),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(S){if((S=S??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(S>=0&&S<=this.transform.maxPitch)return this.transform.minPitch=S,this._update(),this.getPitch()<S&&this.setPitch(S),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(S){if((S=S??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(S>=this.transform.minPitch)return this.transform.maxPitch=S,this._update(),this.getPitch()>S&&this.setPitch(S),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(S){return this.transform.renderWorldCopies=S,this._update()}project(S){return this.transform.locationPoint(o.N.convert(S),this.style&&this.terrain)}unproject(S){return this.transform.pointLocation(o.P.convert(S),this.terrain)}isMoving(){var S;return this._moving||((S=this.handlers)===null||S===void 0?void 0:S.isMoving())}isZooming(){var S;return this._zooming||((S=this.handlers)===null||S===void 0?void 0:S.isZooming())}isRotating(){var S;return this._rotating||((S=this.handlers)===null||S===void 0?void 0:S.isRotating())}_createDelegatedListener(S,c,f){if(S==="mouseenter"||S==="mouseover"){let _=!1;return{layer:c,listener:f,delegates:{mousemove:g=>{const w=this.getLayer(c)?this.queryRenderedFeatures(g.point,{layers:[c]}):[];w.length?_||(_=!0,f.call(this,new en(S,this,g.originalEvent,{features:w}))):_=!1},mouseout:()=>{_=!1}}}}if(S==="mouseleave"||S==="mouseout"){let _=!1;return{layer:c,listener:f,delegates:{mousemove:w=>{(this.getLayer(c)?this.queryRenderedFeatures(w.point,{layers:[c]}):[]).length?_=!0:_&&(_=!1,f.call(this,new en(S,this,w.originalEvent)))},mouseout:w=>{_&&(_=!1,f.call(this,new en(S,this,w.originalEvent)))}}}}{const _=A=>{const g=this.getLayer(c)?this.queryRenderedFeatures(A.point,{layers:[c]}):[];g.length&&(A.features=g,f.call(this,A),delete A.features)};return{layer:c,listener:f,delegates:{[S]:_}}}}on(S,c,f){if(f===void 0)return super.on(S,c);const _=this._createDelegatedListener(S,c,f);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[S]=this._delegatedListeners[S]||[],this._delegatedListeners[S].push(_);for(const A in _.delegates)this.on(A,_.delegates[A]);return this}once(S,c,f){if(f===void 0)return super.once(S,c);const _=this._createDelegatedListener(S,c,f);for(const A in _.delegates)this.once(A,_.delegates[A]);return this}off(S,c,f){return f===void 0?super.off(S,c):(this._delegatedListeners&&this._delegatedListeners[S]&&(_=>{const A=this._delegatedListeners[S];for(let g=0;g<A.length;g++){const w=A[g];if(w.layer===c&&w.listener===f){for(const B in w.delegates)this.off(B,w.delegates[B]);return A.splice(g,1),this}}})(),this)}queryRenderedFeatures(S,c){if(!this.style)return[];let f;const _=S instanceof o.P||Array.isArray(S),A=_?S:[[0,0],[this.transform.width,this.transform.height]];if(c=c||(_?{}:S)||{},A instanceof o.P||typeof A[0]=="number")f=[o.P.convert(A)];else{const g=o.P.convert(A[0]),w=o.P.convert(A[1]);f=[g,new o.P(w.x,g.y),w,new o.P(g.x,w.y),g]}return this.style.queryRenderedFeatures(f,c,this.transform)}querySourceFeatures(S,c){return this.style.querySourceFeatures(S,c)}setStyle(S,c){return(c=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},c)).diff!==!1&&c.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&S?(this._diffStyle(S,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._updateStyle(S,c))}setTransformRequest(S){return this._requestManager.setTransformRequest(S),this}_getUIString(S){const c=this._locale[S];if(c==null)throw new Error(`Missing UI string '${S}'`);return c}_updateStyle(S,c){if(c.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(S,c));const f=this.style&&c.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!S)),S?(this.style=new ts(this,c||{}),this.style.setEventedParent(this,{style:this.style}),typeof S=="string"?this.style.loadURL(S,c,f):this.style.loadJSON(S,c,f),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ts(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(S,c){if(typeof S=="string"){const f=this._requestManager.transformRequest(S,"Style");o.h(f,new AbortController).then(_=>{this._updateDiff(_.data,c)}).catch(_=>{_&&this.fire(new o.j(_))})}else typeof S=="object"&&this._updateDiff(S,c)}_updateDiff(S,c){try{this.style.setState(S,c)&&this._update(!0)}catch(f){o.w(`Unable to perform style diff: ${f.message||f.error||f}.  Rebuilding the style from scratch.`),this._updateStyle(S,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(S,c){return this._lazyInitEmptyStyle(),this.style.addSource(S,c),this._update(!0)}isSourceLoaded(S){const c=this.style&&this.style.sourceCaches[S];if(c!==void 0)return c.loaded();this.fire(new o.j(new Error(`There is no source with ID '${S}'`)))}setTerrain(S){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),S){const c=this.style.sourceCaches[S.source];if(!c)throw new Error(`cannot load terrain, because there exists no source with ID: ${S.source}`);this.terrain===null&&c.reload();for(const f in this.style._layers){const _=this.style._layers[f];_.type==="hillshade"&&_.source===S.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new xp(this.painter,c,S),this.painter.renderToTexture=new ro(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=f=>{f.dataType==="style"?this.terrain.sourceCache.freeRtt():f.dataType==="source"&&f.tile&&(f.sourceId!==S.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(f.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new o.k("terrain",{terrain:S})),this}getTerrain(){var S,c;return(c=(S=this.terrain)===null||S===void 0?void 0:S.options)!==null&&c!==void 0?c:null}areTilesLoaded(){const S=this.style&&this.style.sourceCaches;for(const c in S){const f=S[c]._tiles;for(const _ in f){const A=f[_];if(A.state!=="loaded"&&A.state!=="errored")return!1}}return!0}removeSource(S){return this.style.removeSource(S),this._update(!0)}getSource(S){return this.style.getSource(S)}addImage(S,c){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{pixelRatio:_=1,sdf:A=!1,stretchX:g,stretchY:w,content:B,textFitWidth:I,textFitHeight:L}=f;if(this._lazyInitEmptyStyle(),!(c instanceof HTMLImageElement||o.b(c))){if(c.width===void 0||c.height===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:R,height:O,data:N}=c,H=c;return this.style.addImage(S,{data:new o.R({width:R,height:O},new Uint8Array(N)),pixelRatio:_,stretchX:g,stretchY:w,content:B,textFitWidth:I,textFitHeight:L,sdf:A,version:0,userImage:H}),H.onAdd&&H.onAdd(this,S),this}}{const{width:R,height:O,data:N}=b.getImageData(c);this.style.addImage(S,{data:new o.R({width:R,height:O},N),pixelRatio:_,stretchX:g,stretchY:w,content:B,textFitWidth:I,textFitHeight:L,sdf:A,version:0})}}updateImage(S,c){const f=this.style.getImage(S);if(!f)return this.fire(new o.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const _=c instanceof HTMLImageElement||o.b(c)?b.getImageData(c):c,{width:A,height:g,data:w}=_;if(A===void 0||g===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(A!==f.data.width||g!==f.data.height)return this.fire(new o.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const B=!(c instanceof HTMLImageElement||o.b(c));return f.data.replace(w,B),this.style.updateImage(S,f),this}getImage(S){return this.style.getImage(S)}hasImage(S){return S?!!this.style.getImage(S):(this.fire(new o.j(new Error("Missing required image id"))),!1)}removeImage(S){this.style.removeImage(S)}loadImage(S){return $.getImage(this._requestManager.transformRequest(S,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(S,c){return this._lazyInitEmptyStyle(),this.style.addLayer(S,c),this._update(!0)}moveLayer(S,c){return this.style.moveLayer(S,c),this._update(!0)}removeLayer(S){return this.style.removeLayer(S),this._update(!0)}getLayer(S){return this.style.getLayer(S)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(S,c,f){return this.style.setLayerZoomRange(S,c,f),this._update(!0)}setFilter(S,c){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.style.setFilter(S,c,f),this._update(!0)}getFilter(S){return this.style.getFilter(S)}setPaintProperty(S,c,f){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.style.setPaintProperty(S,c,f,_),this._update(!0)}getPaintProperty(S,c){return this.style.getPaintProperty(S,c)}setLayoutProperty(S,c,f){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.style.setLayoutProperty(S,c,f,_),this._update(!0)}getLayoutProperty(S,c){return this.style.getLayoutProperty(S,c)}setGlyphs(S){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setGlyphs(S,c),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(S,c){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._lazyInitEmptyStyle(),this.style.addSprite(S,c,f,_=>{_||this._update(!0)}),this}removeSprite(S){return this._lazyInitEmptyStyle(),this.style.removeSprite(S),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(S){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setSprite(S,c,f=>{f||this._update(!0)}),this}setLight(S){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setLight(S,c),this._update(!0)}getLight(){return this.style.getLight()}setSky(S){return this._lazyInitEmptyStyle(),this.style.setSky(S),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(S,c){return this.style.setFeatureState(S,c),this._update()}removeFeatureState(S,c){return this.style.removeFeatureState(S,c),this._update()}getFeatureState(S){return this.style.getFeatureState(S)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let S=0,c=0;return this._container&&(S=this._container.clientWidth||400,c=this._container.clientHeight||300),[S,c]}_setupContainer(){const S=this._container;S.classList.add("maplibregl-map");const c=this._canvasContainer=x.create("div","maplibregl-canvas-container",S);this._interactive&&c.classList.add("maplibregl-interactive"),this._canvas=x.create("canvas","maplibregl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const f=this._containerDimensions(),_=this._getClampedPixelRatio(f[0],f[1]);this._resizeCanvas(f[0],f[1],_);const A=this._controlContainer=x.create("div","maplibregl-control-container",S),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{g[w]=x.create("div",`maplibregl-ctrl-${w} `,A)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(S,c,f){this._canvas.width=Math.floor(f*S),this._canvas.height=Math.floor(f*c),this._canvas.style.width=`${S}px`,this._canvas.style.height=`${c}px`}_setupPainter(){const S={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let c=null;this._canvas.addEventListener("webglcontextcreationerror",_=>{c={requestedAttributes:S},_&&(c.statusMessage=_.statusMessage,c.type=_.type)},{once:!0});const f=this._canvas.getContext("webgl2",S)||this._canvas.getContext("webgl",S);if(!f){const _="Failed to initialize WebGL";throw c?(c.message=_,new Error(JSON.stringify(c))):new Error(_)}this.painter=new qo(f,this.transform),C.testSupport(f)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(S){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||S,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(S){return this._update(),this._renderTaskQueue.add(S)}_cancelRenderFrame(S){this._renderTaskQueue.remove(S)}_render(S){const c=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(S),this._removed)return;let f=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const A=this.transform.zoom,g=b.now();this.style.zoomHistory.update(A,g);const w=new o.a9(A,{now:g,fadeDuration:c,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),B=w.crossFadingFactor();B===1&&B===this._crossFadingFactor||(f=!0,this._crossFadingFactor=B),this.style.update(w)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,c,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:c,showPadding:this.showPadding}),this.fire(new o.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.be.mark(o.bf.load),this.fire(new o.k("load"))),this.style&&(this.style.hasTransitions()||f)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const _=this._sourcesDirty||this._styleDirty||this._placementDirty;return _||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.k("idle")),!this._loaded||this._fullyLoaded||_||(this._fullyLoaded=!0,o.be.mark(o.bf.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var S;this._hash&&this._hash.remove();for(const f of this._controls)f.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),$.removeThrottleControl(this._imageQueueHandle),(S=this._resizeObserver)===null||S===void 0||S.disconnect();const c=this.painter.context.gl.getExtension("WEBGL_lose_context");c!=null&&c.loseContext&&c.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),x.remove(this._canvasContainer),x.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),o.be.clearMetrics(),this._removed=!0,this.fire(new o.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,b.frameAsync(this._frameRequest).then(S=>{o.be.frame(S),this._frameRequest=null,this._render(S)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(S){this._showTileBoundaries!==S&&(this._showTileBoundaries=S,this._update())}get showPadding(){return!!this._showPadding}set showPadding(S){this._showPadding!==S&&(this._showPadding=S,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(S){this._showCollisionBoxes!==S&&(this._showCollisionBoxes=S,S?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(S){this._showOverdrawInspector!==S&&(this._showOverdrawInspector=S,this._update())}get repaint(){return!!this._repaint}set repaint(S){this._repaint!==S&&(this._repaint=S,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(S){this._vertices=S,this._update()}get version(){return Md}getCameraTargetElevation(){return this.transform.elevation}},a.MapMouseEvent=en,a.MapTouchEvent=Fn,a.MapWheelEvent=fi,a.Marker=Un,a.NavigationControl=class{constructor(S){this._updateZoomButtons=()=>{const c=this._map.getZoom(),f=c===this._map.getMaxZoom(),_=c===this._map.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())},this._rotateCompassArrow=()=>{const c=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=c},this._setButtonTitle=(c,f)=>{const _=this._map._getUIString(`NavigationControl.${f}`);c.title=_,c.setAttribute("aria-label",_)},this.options=o.e({},_h,S),this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",c=>this._map.zoomIn({},{originalEvent:c})),x.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",c=>this._map.zoomOut({},{originalEvent:c})),x.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",c=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:c}):this._map.resetNorth({},{originalEvent:c})}),this._compassIcon=x.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(S){return this._map=S,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Rd(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){x.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(S,c){const f=x.create("button",S,this._container);return f.type="button",f.addEventListener("click",c),f}},a.Popup=class extends o.E{constructor(S){super(),this.remove=()=>(this._content&&x.remove(this._content),this._container&&(x.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.k("close"))),this),this._onMouseUp=c=>{this._update(c.point)},this._onMouseMove=c=>{this._update(c.point)},this._onDrag=c=>{this._update(c.point)},this._update=c=>{var f;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=x.create("div","maplibregl-popup",this._map.getContainer()),this._tip=x.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const B of this.options.className.split(" "))this._container.classList.add(B);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?gA(this._lngLat,this._flatPos,this._map.transform):(f=this._lngLat)===null||f===void 0?void 0:f.wrap(),this._trackPointer&&!c)return;const _=this._flatPos=this._pos=this._trackPointer&&c?c:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&c?c:this._map.transform.locationPoint(this._lngLat));let A=this.options.anchor;const g=ur(this.options.offset);if(!A){const B=this._container.offsetWidth,I=this._container.offsetHeight;let L;L=_.y+g.bottom.y<I?["top"]:_.y>this._map.transform.height-I?["bottom"]:[],_.x<B/2?L.push("left"):_.x>this._map.transform.width-B/2&&L.push("right"),A=L.length===0?"bottom":L.join("-")}let w=_.add(g[A]);this.options.subpixelPositioning||(w=w.round()),x.setTransform(this._container,`${_u[A]} translate(${w.x}px,${w.y}px)`),Co(this._container,A,"popup")},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(ya),S)}addTo(S){return this._map&&this.remove(),this._map=S,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(S){return this._lngLat=o.N.convert(S),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(S){return this.setDOMContent(document.createTextNode(S))}setHTML(S){const c=document.createDocumentFragment(),f=document.createElement("body");let _;for(f.innerHTML=S;_=f.firstChild,_;)c.appendChild(_);return this.setDOMContent(c)}getMaxWidth(){var S;return(S=this._container)===null||S===void 0?void 0:S.style.maxWidth}setMaxWidth(S){return this.options.maxWidth=S,this._update(),this}setDOMContent(S){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=x.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(S),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(S){return this._container&&this._container.classList.add(S),this}removeClassName(S){return this._container&&this._container.classList.remove(S),this}setOffset(S){return this.options.offset=S,this._update(),this}toggleClassName(S){if(this._container)return this._container.classList.toggle(S)}setSubpixelPositioning(S){this.options.subpixelPositioning=S}_createCloseButton(){this.options.closeButton&&(this._closeButton=x.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const S=this._container.querySelector(vh);S&&S.focus()}},a.RasterDEMTileSource=ve,a.RasterTileSource=de,a.ScaleControl=class{constructor(S){this._onMove=()=>{Od(this._map,this._container,this.options)},this.setUnit=c=>{this.options.unit=c,Od(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Cp),S)}getDefaultPosition(){return"bottom-left"}onAdd(S){return this._map=S,this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-scale",S.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){x.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},a.ScrollZoomHandler=yh,a.Style=ts,a.TerrainControl=class{constructor(S){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=S}onAdd(S){return this._map=S,this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=x.create("button","maplibregl-ctrl-terrain",this._container),x.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){x.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},a.TwoFingersTouchPitchHandler=AA,a.TwoFingersTouchRotateHandler=mh,a.TwoFingersTouchZoomHandler=gu,a.TwoFingersTouchZoomRotateHandler=pA,a.VectorTileSource=er,a.VideoSource=lr,a.addSourceType=(S,c)=>o._(void 0,void 0,void 0,function*(){if(Dr(S))throw new Error(`A source type called "${S}" already exists.`);((f,_)=>{Lr[f]=_})(S,c)}),a.clearPrewarmedResources=function(){const S=Vt;S&&(S.isPreloaded()&&S.numActive()===1?(S.release(It),Vt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},a.getRTLTextPluginStatus=function(){return Re().getRTLTextPluginStatus()},a.getVersion=function(){return Er},a.getWorkerCount=function(){return Ut.workerCount},a.getWorkerUrl=function(){return o.a.WORKER_URL},a.importScriptInWorkers=function(S){return Te().broadcast("IS",S)},a.prewarm=function(){te().acquire(It)},a.setMaxParallelImageRequests=function(S){o.a.MAX_PARALLEL_IMAGE_REQUESTS=S},a.setRTLTextPlugin=function(S,c){return Re().setRTLTextPlugin(S,c)},a.setWorkerCount=function(S){Ut.workerCount=S},a.setWorkerUrl=function(S){o.a.WORKER_URL=S}});var s=e;return s})})(xS);var BS=xS.exports;const Ls=Np(BS);var Ps;(function(r){r[r.Unknown=0]="Unknown",r[r.Point=1]="Point",r[r.LineString=2]="LineString",r[r.Polygon=3]="Polygon",r[r.MultiPoint=4]="MultiPoint",r[r.MultiLineString=5]="MultiLineString",r[r.MultiPolygon=6]="MultiPolygon",r[r.GeometryCollection=7]="GeometryCollection",r[r.CircularString=8]="CircularString",r[r.CompoundCurve=9]="CompoundCurve",r[r.CurvePolygon=10]="CurvePolygon",r[r.MultiCurve=11]="MultiCurve",r[r.MultiSurface=12]="MultiSurface",r[r.Curve=13]="Curve",r[r.Surface=14]="Surface",r[r.PolyhedralSurface=15]="PolyhedralSurface",r[r.TIN=16]="TIN",r[r.Triangle=17]="Triangle"})(Ps||(Ps={}));const kp=4,Qp=4,zp=4,SA=new Int32Array(2),CS=new Float32Array(SA.buffer),ES=new Float64Array(SA.buffer),d0=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var hv;(function(r){r[r.UTF8_BYTES=1]="UTF8_BYTES",r[r.UTF16_STRING=2]="UTF16_STRING"})(hv||(hv={}));class Tu{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new Tu(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return SA[0]=this.readInt32(t),CS[0]}readFloat64(t){return SA[d0?0:1]=this.readInt32(t),SA[d0?1:0]=this.readInt32(t+4),ES[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,Number(BigInt.asIntN(32,e))),this.writeInt32(t+4,Number(BigInt.asIntN(32,e>>BigInt(32))))}writeUint64(t,e){this.writeUint32(t,Number(BigInt.asUintN(32,e))),this.writeUint32(t+4,Number(BigInt.asUintN(32,e>>BigInt(32))))}writeFloat32(t,e){CS[0]=e,this.writeInt32(t,SA[0])}writeFloat64(t,e){ES[0]=e,this.writeInt32(t,SA[d0?0:1]),this.writeInt32(t+4,SA[d0?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+kp+Qp)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<Qp;e++)t+=String.fromCharCode(this.readInt8(this.position_+kp+e));return t}__offset(t,e){const n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const n=this.readInt32(t);t+=kp;const i=this.bytes_.subarray(t,t+n);return e===hv.UTF8_BYTES?i:this.text_decoder_.decode(i)}__union_with_string(t,e){return typeof t=="string"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+kp}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=Qp)throw new Error("FlatBuffers: file identifier must be length "+Qp);for(let e=0;e<Qp;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+kp+e))return!1;return!0}createScalarList(t,e){const n=[];for(let i=0;i<e;++i){const s=t(i);s!==null&&n.push(s)}return n}createObjList(t,e){const n=[];for(let i=0;i<e;++i){const s=t(i);s!==null&&n.push(s.unpack())}return n}}let jk=class xa{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsGeometry(t,e){return(e||new xa).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsGeometry(t,e){return t.setPosition(t.position()+zp),(e||new xa).__init(t.readInt32(t.position())+t.position(),t)}ends(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}endsLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}endsArray(){const t=this.bb.__offset(this.bb_pos,4);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}xy(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+t*8):0}xyLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}xyArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}z(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+t*8):0}zLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}zArray(){const t=this.bb.__offset(this.bb_pos,8);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}m(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+t*8):0}mLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}mArray(){const t=this.bb.__offset(this.bb_pos,10);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}t(t){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+t*8):0}tLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}tArray(){const t=this.bb.__offset(this.bb_pos,12);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}tm(t){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readUint64(this.bb.__vector(this.bb_pos+e)+t*8):BigInt(0)}tmLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}type(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readUint8(this.bb_pos+t):Ps.Unknown}parts(t,e){const n=this.bb.__offset(this.bb_pos,18);return n?(e||new xa).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}partsLength(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}static startGeometry(t){t.startObject(8)}static addEnds(t,e){t.addFieldOffset(0,e,0)}static createEndsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addInt32(e[n]);return t.endVector()}static startEndsVector(t,e){t.startVector(4,e,4)}static addXy(t,e){t.addFieldOffset(1,e,0)}static createXyVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startXyVector(t,e){t.startVector(8,e,8)}static addZ(t,e){t.addFieldOffset(2,e,0)}static createZVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startZVector(t,e){t.startVector(8,e,8)}static addM(t,e){t.addFieldOffset(3,e,0)}static createMVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startMVector(t,e){t.startVector(8,e,8)}static addT(t,e){t.addFieldOffset(4,e,0)}static createTVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startTVector(t,e){t.startVector(8,e,8)}static addTm(t,e){t.addFieldOffset(5,e,0)}static createTmVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addInt64(e[n]);return t.endVector()}static startTmVector(t,e){t.startVector(8,e,8)}static addType(t,e){t.addFieldInt8(6,e,Ps.Unknown)}static addParts(t,e){t.addFieldOffset(7,e,0)}static createPartsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startPartsVector(t,e){t.startVector(4,e,4)}static endGeometry(t){return t.endObject()}static createGeometry(t,e,n,i,s,a,o,d,p){return xa.startGeometry(t),xa.addEnds(t,e),xa.addXy(t,n),xa.addZ(t,i),xa.addM(t,s),xa.addT(t,a),xa.addTm(t,o),xa.addType(t,d),xa.addParts(t,p),xa.endGeometry(t)}};function dv(r,t){const e=[];for(let n=0;n<r.length;n+=2){const i=[r[n],r[n+1]];t&&i.push(t[n>>1]),e.push(i)}return e}function SS(r,t,e){if(!e||e.length===0)return[dv(r,t)];let n=0;const i=Array.from(e).map(a=>r.slice(n,n=a<<1));let s;return t&&(n=0,s=Array.from(e).map(a=>t.slice(n,n=a))),i.map((a,o)=>dv(a,s?s[o]:void 0))}function qk(r,t){const e=r.xyArray(),n=r.zArray();switch(t){case Ps.Point:{const i=Array.from(e);return n&&i.push(n[0]),i}case Ps.MultiPoint:case Ps.LineString:return dv(e,n);case Ps.MultiLineString:return SS(e,n,r.endsArray());case Ps.Polygon:return SS(e,n,r.endsArray())}}function fv(r,t){let e=t;if(e===Ps.Unknown&&(e=r.type()),e===Ps.GeometryCollection){const i=[];for(let s=0;s<r.partsLength();s++){const a=r.parts(s),o=a.type();i.push(fv(a,o))}return{type:Ps[e],geometries:i}}else if(e===Ps.MultiPolygon){const i=[];for(let s=0;s<r.partsLength();s++)i.push(fv(r.parts(s),Ps.Polygon));return{type:Ps[e],coordinates:i.map(s=>s.coordinates)}}const n=qk(r,e);return{type:Ps[e],coordinates:n}}var Ms;(function(r){r[r.Byte=0]="Byte",r[r.UByte=1]="UByte",r[r.Bool=2]="Bool",r[r.Short=3]="Short",r[r.UShort=4]="UShort",r[r.Int=5]="Int",r[r.UInt=6]="UInt",r[r.Long=7]="Long",r[r.ULong=8]="ULong",r[r.Float=9]="Float",r[r.Double=10]="Double",r[r.String=11]="String",r[r.Json=12]="Json",r[r.DateTime=13]="DateTime",r[r.Binary=14]="Binary"})(Ms||(Ms={}));class Us{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsColumn(t,e){return(e||new Us).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsColumn(t,e){return t.setPosition(t.position()+zp),(e||new Us).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}type(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):Ms.Byte}title(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,t):null}width(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt32(this.bb_pos+t):-1}precision(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt32(this.bb_pos+t):-1}scale(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readInt32(this.bb_pos+t):-1}nullable(){const t=this.bb.__offset(this.bb_pos,18);return t?!!this.bb.readInt8(this.bb_pos+t):!0}unique(){const t=this.bb.__offset(this.bb_pos,20);return t?!!this.bb.readInt8(this.bb_pos+t):!1}primaryKey(){const t=this.bb.__offset(this.bb_pos,22);return t?!!this.bb.readInt8(this.bb_pos+t):!1}metadata(t){const e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__string(this.bb_pos+e,t):null}static startColumn(t){t.startObject(11)}static addName(t,e){t.addFieldOffset(0,e,0)}static addType(t,e){t.addFieldInt8(1,e,Ms.Byte)}static addTitle(t,e){t.addFieldOffset(2,e,0)}static addDescription(t,e){t.addFieldOffset(3,e,0)}static addWidth(t,e){t.addFieldInt32(4,e,-1)}static addPrecision(t,e){t.addFieldInt32(5,e,-1)}static addScale(t,e){t.addFieldInt32(6,e,-1)}static addNullable(t,e){t.addFieldInt8(7,+e,1)}static addUnique(t,e){t.addFieldInt8(8,+e,0)}static addPrimaryKey(t,e){t.addFieldInt8(9,+e,0)}static addMetadata(t,e){t.addFieldOffset(10,e,0)}static endColumn(t){const e=t.endObject();return t.requiredField(e,4),e}static createColumn(t,e,n,i,s,a,o,d,p,y,b,x){return Us.startColumn(t),Us.addName(t,e),Us.addType(t,n),Us.addTitle(t,i),Us.addDescription(t,s),Us.addWidth(t,a),Us.addPrecision(t,o),Us.addScale(t,d),Us.addNullable(t,p),Us.addUnique(t,y),Us.addPrimaryKey(t,b),Us.addMetadata(t,x),Us.endColumn(t)}}class ql{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFeature(t,e){return(e||new ql).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFeature(t,e){return t.setPosition(t.position()+zp),(e||new ql).__init(t.readInt32(t.position())+t.position(),t)}geometry(t){const e=this.bb.__offset(this.bb_pos,4);return e?(t||new jk).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}properties(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}propertiesLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}propertiesArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}columns(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new Us).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}columnsLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFeature(t){t.startObject(3)}static addGeometry(t,e){t.addFieldOffset(0,e,0)}static addProperties(t,e){t.addFieldOffset(1,e,0)}static createPropertiesVector(t,e){t.startVector(1,e.length,1);for(let n=e.length-1;n>=0;n--)t.addInt8(e[n]);return t.endVector()}static startPropertiesVector(t,e){t.startVector(1,e,1)}static addColumns(t,e){t.addFieldOffset(2,e,0)}static createColumnsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startColumnsVector(t,e){t.startVector(4,e,4)}static endFeature(t){return t.endObject()}static finishFeatureBuffer(t,e){t.finish(e)}static finishSizePrefixedFeatureBuffer(t,e){t.finish(e,void 0,!0)}static createFeature(t,e,n,i){return ql.startFeature(t),ql.addGeometry(t,e),ql.addProperties(t,n),ql.addColumns(t,i),ql.endFeature(t)}}new TextEncoder;const TS=new TextDecoder;function Kk(r,t){const e={};if(!t||t.length===0)return e;const n=r.propertiesArray();if(!n)return e;const i=new DataView(n.buffer,n.byteOffset),s=r.propertiesLength();let a=0;for(;a<s;){const o=i.getUint16(a,!0);a+=2;const d=t[o],p=d.name;switch(d.type){case Ms.Bool:{e[p]=!!i.getUint8(a),a+=1;break}case Ms.Byte:{e[p]=i.getInt8(a),a+=1;break}case Ms.UByte:{e[p]=i.getUint8(a),a+=1;break}case Ms.Short:{e[p]=i.getInt16(a,!0),a+=2;break}case Ms.UShort:{e[p]=i.getUint16(a,!0),a+=2;break}case Ms.Int:{e[p]=i.getInt32(a,!0),a+=4;break}case Ms.UInt:{e[p]=i.getUint32(a,!0),a+=4;break}case Ms.Long:{e[p]=Number(i.getBigInt64(a,!0)),a+=8;break}case Ms.ULong:{e[p]=Number(i.getBigUint64(a,!0)),a+=8;break}case Ms.Float:{e[p]=i.getFloat32(a,!0),a+=4;break}case Ms.Double:{e[p]=i.getFloat64(a,!0),a+=8;break}case Ms.DateTime:case Ms.String:{const y=i.getUint32(a,!0);a+=4,e[p]=TS.decode(n.subarray(a,a+y)),a+=y;break}case Ms.Json:{const y=i.getUint32(a,!0);a+=4;const b=TS.decode(n.subarray(a,a+y));e[p]=JSON.parse(b),a+=y;break}default:throw new Error("Unknown type "+d.type)}}return e}function pv(r,t){const e=t.columns;return{type:"Feature",geometry:fv(r.geometry(),t.geometryType),properties:Kk(r,e)}}const gv=new Uint8Array(0);function $k(){return this._source.cancel()}function Wk(r,t){if(!r.length)return t;if(!t.length)return r;var e=new Uint8Array(r.length+t.length);return e.set(r),e.set(t,r.length),e}function Xk(){var r=this,t=r._array.subarray(r._index);return r._source.read().then(function(e){return r._array=gv,r._index=0,e.done?t.length>0?{done:!1,value:t}:{done:!0,value:void 0}:{done:!1,value:Wk(t,e.value)}})}function Jk(r){if((r|=0)<0)throw new Error("invalid length");var t=this,e=this._array.length-this._index;if(this._index+r<=this._array.length)return Promise.resolve(this._array.subarray(this._index,this._index+=r));var n=new Uint8Array(r);return n.set(this._array.subarray(this._index)),function i(){return t._source.read().then(function(s){return s.done?(t._array=gv,t._index=0,e>0?n.subarray(0,e):null):e+s.value.length>=r?(t._array=s.value,t._index=r-e,n.set(s.value.subarray(0,r-e),e),n):(n.set(s.value,e),e+=s.value.length,i())})}()}function Yk(r){return typeof r.slice=="function"?r:new f0(typeof r.read=="function"?r:r.getReader())}function f0(r){this._source=r,this._array=gv,this._index=0}f0.prototype.read=Xk,f0.prototype.slice=Jk,f0.prototype.cancel=$k;class il{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsCrs(t,e){return(e||new il).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsCrs(t,e){return t.setPosition(t.position()+zp),(e||new il).__init(t.readInt32(t.position())+t.position(),t)}org(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}code(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}name(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,t):null}wkt(t){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__string(this.bb_pos+e,t):null}codeString(t){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__string(this.bb_pos+e,t):null}static startCrs(t){t.startObject(6)}static addOrg(t,e){t.addFieldOffset(0,e,0)}static addCode(t,e){t.addFieldInt32(1,e,0)}static addName(t,e){t.addFieldOffset(2,e,0)}static addDescription(t,e){t.addFieldOffset(3,e,0)}static addWkt(t,e){t.addFieldOffset(4,e,0)}static addCodeString(t,e){t.addFieldOffset(5,e,0)}static endCrs(t){return t.endObject()}static createCrs(t,e,n,i,s,a,o){return il.startCrs(t),il.addOrg(t,e),il.addCode(t,n),il.addName(t,i),il.addDescription(t,s),il.addWkt(t,a),il.addCodeString(t,o),il.endCrs(t)}}class p0{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsHeader(t,e){return(e||new p0).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsHeader(t,e){return t.setPosition(t.position()+zp),(e||new p0).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}envelope(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+t*8):0}envelopeLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}envelopeArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}geometryType(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):Ps.Unknown}hasZ(){const t=this.bb.__offset(this.bb_pos,10);return t?!!this.bb.readInt8(this.bb_pos+t):!1}hasM(){const t=this.bb.__offset(this.bb_pos,12);return t?!!this.bb.readInt8(this.bb_pos+t):!1}hasT(){const t=this.bb.__offset(this.bb_pos,14);return t?!!this.bb.readInt8(this.bb_pos+t):!1}hasTm(){const t=this.bb.__offset(this.bb_pos,16);return t?!!this.bb.readInt8(this.bb_pos+t):!1}columns(t,e){const n=this.bb.__offset(this.bb_pos,18);return n?(e||new Us).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}columnsLength(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}featuresCount(){const t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readUint64(this.bb_pos+t):BigInt("0")}indexNodeSize(){const t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readUint16(this.bb_pos+t):16}crs(t){const e=this.bb.__offset(this.bb_pos,24);return e?(t||new il).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}title(t){const e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){const e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__string(this.bb_pos+e,t):null}metadata(t){const e=this.bb.__offset(this.bb_pos,30);return e?this.bb.__string(this.bb_pos+e,t):null}static startHeader(t){t.startObject(14)}static addName(t,e){t.addFieldOffset(0,e,0)}static addEnvelope(t,e){t.addFieldOffset(1,e,0)}static createEnvelopeVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startEnvelopeVector(t,e){t.startVector(8,e,8)}static addGeometryType(t,e){t.addFieldInt8(2,e,Ps.Unknown)}static addHasZ(t,e){t.addFieldInt8(3,+e,0)}static addHasM(t,e){t.addFieldInt8(4,+e,0)}static addHasT(t,e){t.addFieldInt8(5,+e,0)}static addHasTm(t,e){t.addFieldInt8(6,+e,0)}static addColumns(t,e){t.addFieldOffset(7,e,0)}static createColumnsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startColumnsVector(t,e){t.startVector(4,e,4)}static addFeaturesCount(t,e){t.addFieldInt64(8,e,BigInt("0"))}static addIndexNodeSize(t,e){t.addFieldInt16(9,e,16)}static addCrs(t,e){t.addFieldOffset(10,e,0)}static addTitle(t,e){t.addFieldOffset(11,e,0)}static addDescription(t,e){t.addFieldOffset(12,e,0)}static addMetadata(t,e){t.addFieldOffset(13,e,0)}static endHeader(t){return t.endObject()}static finishHeaderBuffer(t,e){t.finish(e)}static finishSizePrefixedHeaderBuffer(t,e){t.finish(e,void 0,!0)}}function mv(r){const t=p0.getRootAsHeader(r),e=t.featuresCount(),n=t.indexNodeSize(),i=[];for(let d=0;d<t.columnsLength();d++){const p=t.columns(d);if(!p)throw new Error("Column unexpectedly missing");if(!p.name())throw new Error("Column name unexpectedly missing");i.push({name:p.name(),type:p.type(),title:p.title(),description:p.description(),width:p.width(),precision:p.precision(),scale:p.scale(),nullable:p.nullable(),unique:p.unique(),primary_key:p.primaryKey()})}const s=t.crs(),a=s?{org:s.org(),code:s.code(),name:s.name(),description:s.description(),wkt:s.wkt(),code_string:s.codeString()}:null;return{geometryType:t.geometryType(),columns:i,envelope:null,featuresCount:Number(e),indexNodeSize:n,crs:a,title:t.title(),description:t.description(),metadata:t.metadata()}}/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var yv=function(r,t){return yv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])},yv(r,t)};function Zk(r,t){yv(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function $d(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(y){try{p(n.next(y))}catch(b){a(b)}}function d(y){try{p(n.throw(y))}catch(b){a(b)}}function p(y){y.done?s(y.value):i(y.value).then(o,d)}p((n=n.apply(r,[])).next())})}function TA(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(p){return function(y){return d([p,y])}}function d(p){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=p[0]&2?i.return:p[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,p[1])).done)return s;switch(i=0,s&&(p=[p[0]&2,s.value]),p[0]){case 0:case 1:s=p;break;case 4:return e.label++,{value:p[1],done:!1};case 5:e.label++,i=p[1],p=[0];continue;case 7:p=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(p[0]===6||p[0]===2)){e=0;continue}if(p[0]===3&&(!s||p[1]>s[0]&&p[1]<s[3])){e.label=p[1];break}if(p[0]===6&&e.label<s[1]){e.label=s[1],s=p;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(p);break}s[2]&&e.ops.pop(),e.trys.pop();continue}p=t.call(r,e)}catch(y){p=[6,y],i=0}finally{n=s=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Wd(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Hp(r){return this instanceof Hp?(this.v=r,this):new Hp(r)}function t8(r,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(r,t||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(x){n[x]&&(i[x]=function(C){return new Promise(function(P,M){s.push([x,C,P,M])>1||o(x,C)})})}function o(x,C){try{d(n[x](C))}catch(P){b(s[0][3],P)}}function d(x){x.value instanceof Hp?Promise.resolve(x.value.v).then(p,y):b(s[0][2],x)}function p(x){o("next",x)}function y(x){o("throw",x)}function b(x,C){x(C),s.shift(),s.length&&o(s[0][0],s[0][1])}}var IS=function(r){Zk(t,r);function t(e){var n=r.call(this,e)||this;return Object.defineProperty(n,"name",{value:"RepeaterOverflowError",enumerable:!1}),typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(n,n.constructor.prototype):n.__proto__=n.constructor.prototype,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(n,n.constructor),n}return t}(Error);(function(){function r(t){if(t<0)throw new RangeError("Capacity may not be less than 0");this._c=t,this._q=[]}return Object.defineProperty(r.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"full",{get:function(){return this._q.length>=this._c},enumerable:!1,configurable:!0}),r.prototype.add=function(t){if(this.full)throw new Error("Buffer full");this._q.push(t)},r.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},r})(),function(){function r(t){if(t<1)throw new RangeError("Capacity may not be less than 1");this._c=t,this._q=[]}return Object.defineProperty(r.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"full",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.add=function(t){for(;this._q.length>=this._c;)this._q.shift();this._q.push(t)},r.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},r}(),function(){function r(t){if(t<1)throw new RangeError("Capacity may not be less than 1");this._c=t,this._q=[]}return Object.defineProperty(r.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"full",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.add=function(t){this._q.length<this._c&&this._q.push(t)},r.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},r}();function _v(r){r!=null&&typeof r.then=="function"&&r.then(y0,y0)}var vv=0,FS=1,Uh=2,g0=3,bv=4,m0=1024,y0=function(){};function Xd(r){var t=r.err,e=Promise.resolve(r.execution).then(function(n){if(t!=null)throw t;return n});return r.err=void 0,r.execution=e.then(function(){},function(){}),r.pending===void 0?e:r.pending.then(function(){return e})}function Rh(r,t){var e=r.state>=g0;return Promise.resolve(t).then(function(n){return!e&&r.state>=bv?Xd(r).then(function(i){return{value:i,done:!0}}):{value:n,done:e}})}function wv(r,t){var e,n;if(!(r.state>=Uh))if(r.state=Uh,r.onnext(),r.onstop(),r.err==null&&(r.err=t),r.pushes.length===0&&(typeof r.buffer>"u"||r.buffer.empty))Vp(r);else try{for(var i=Wd(r.pushes),s=i.next();!s.done;s=i.next()){var a=s.value;a.resolve()}}catch(o){e={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}function Vp(r){var t,e;if(!(r.state>=g0)){r.state<Uh&&wv(r),r.state=g0,r.buffer=void 0;try{for(var n=Wd(r.nexts),i=n.next();!i.done;i=n.next()){var s=i.value,a=r.pending===void 0?Xd(r):r.pending.then(function(){return Xd(r)});s.resolve(Rh(r,a))}}catch(o){t={error:o}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}r.pushes=[],r.nexts=[]}}function LS(r){r.state>=bv||(r.state<g0&&Vp(r),r.state=bv)}function e8(r,t){if(_v(t),r.pushes.length>=m0)throw new IS("No more than "+m0+" pending calls to push are allowed on a single repeater.");if(r.state>=Uh)return Promise.resolve(void 0);var e=r.pending===void 0?Promise.resolve(t):r.pending.then(function(){return t});e=e.catch(function(d){r.state<Uh&&(r.err=d),LS(r)});var n;if(r.nexts.length){var i=r.nexts.shift();i.resolve(Rh(r,e)),r.nexts.length?n=Promise.resolve(r.nexts[0].value):n=new Promise(function(d){return r.onnext=d})}else typeof r.buffer<"u"&&!r.buffer.full?(r.buffer.add(e),n=Promise.resolve(void 0)):n=new Promise(function(d){return r.pushes.push({resolve:d,value:e})});var s=!0,a={},o=n.catch(function(d){if(s)throw d});return a.then=function(d,p){return s=!1,Promise.prototype.then.call(n,d,p)},a.catch=function(d){return s=!1,Promise.prototype.catch.call(n,d)},a.finally=n.finally.bind(n),r.pending=e.then(function(){return o}).catch(function(d){r.err=d,LS(r)}),a}function r8(r){var t=wv.bind(null,r),e=new Promise(function(n){return r.onstop=n});return t.then=e.then.bind(e),t.catch=e.catch.bind(e),t.finally=e.finally.bind(e),t}function n8(r){if(!(r.state>=FS)){r.state=FS;var t=e8.bind(null,r),e=r8(r);r.execution=new Promise(function(n){return n(r.executor(t,e))}),r.execution.catch(function(){return wv(r)})}}var _0=new WeakMap,Gp=function(){function r(t,e){_0.set(this,{executor:t,buffer:e,err:void 0,state:vv,pushes:[],nexts:[],pending:void 0,execution:void 0,onnext:y0,onstop:y0})}return r.prototype.next=function(t){_v(t);var e=_0.get(this);if(e===void 0)throw new Error("WeakMap error");if(e.nexts.length>=m0)throw new IS("No more than "+m0+" pending calls to next are allowed on a single repeater.");if(e.state<=vv&&n8(e),e.onnext(t),typeof e.buffer<"u"&&!e.buffer.empty){var n=Rh(e,e.buffer.remove());if(e.pushes.length){var i=e.pushes.shift();e.buffer.add(i.value),e.onnext=i.resolve}return n}else if(e.pushes.length){var s=e.pushes.shift();return e.onnext=s.resolve,Rh(e,s.value)}else if(e.state>=Uh)return Vp(e),Rh(e,Xd(e));return new Promise(function(a){return e.nexts.push({resolve:a,value:t})})},r.prototype.return=function(t){_v(t);var e=_0.get(this);if(e===void 0)throw new Error("WeakMap error");return Vp(e),e.execution=Promise.resolve(e.execution).then(function(){return t}),Rh(e,Xd(e))},r.prototype.throw=function(t){var e=_0.get(this);if(e===void 0)throw new Error("WeakMap error");return e.state<=vv||e.state>=Uh||typeof e.buffer<"u"&&!e.buffer.empty?(Vp(e),e.err==null&&(e.err=t),Rh(e,Xd(e))):this.next(Promise.reject(t))},r.prototype[Symbol.asyncIterator]=function(){return this},r.race=i8,r.merge=s8,r.zip=o8,r.latest=a8,r}();function v0(r,t){var e,n,i=[],s=function(p){p!=null&&typeof p[Symbol.asyncIterator]=="function"?i.push(p[Symbol.asyncIterator]()):p!=null&&typeof p[Symbol.iterator]=="function"?i.push(p[Symbol.iterator]()):i.push(function(){return t8(this,arguments,function(){return TA(this,function(x){switch(x.label){case 0:return t.yieldValues?[4,Hp(p)]:[3,3];case 1:return[4,x.sent()];case 2:x.sent(),x.label=3;case 3:return t.returnValues?[4,Hp(p)]:[3,5];case 4:return[2,x.sent()];case 5:return[2]}})})}())};try{for(var a=Wd(r),o=a.next();!o.done;o=a.next()){var d=o.value;s(d)}}catch(p){e={error:p}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i}function i8(r){var t=this,e=v0(r,{returnValues:!0});return new Gp(function(n,i){return $d(t,void 0,void 0,function(){var s,a,o,d,p,y;return TA(this,function(b){switch(b.label){case 0:if(!e.length)return i(),[2];a=!1,i.then(function(){s(),a=!0}),b.label=1;case 1:b.trys.push([1,,5,7]),d=void 0,p=0,y=function(){var x,C,P,M,k,z;return TA(this,function(V){switch(V.label){case 0:x=p;try{for(C=(k=void 0,Wd(e)),P=C.next();!P.done;P=C.next())M=P.value,Promise.resolve(M.next()).then(function($){$.done?(i(),o===void 0&&(o=$)):p===x&&(p++,s($))},function($){return i($)})}catch($){k={error:$}}finally{try{P&&!P.done&&(z=C.return)&&z.call(C)}finally{if(k)throw k.error}}return[4,new Promise(function($){return s=$})];case 1:return d=V.sent(),d===void 0?[3,3]:[4,n(d.value)];case 2:V.sent(),V.label=3;case 3:return[2]}})},b.label=2;case 2:return a?[3,4]:[5,y()];case 3:return b.sent(),[3,2];case 4:return[2,o&&o.value];case 5:return i(),[4,Promise.race(e.map(function(x){return x.return&&x.return()}))];case 6:return b.sent(),[7];case 7:return[2]}})})})}function s8(r){var t=this,e=v0(r,{yieldValues:!0});return new Gp(function(n,i){return $d(t,void 0,void 0,function(){var s,a,o,d=this;return TA(this,function(p){switch(p.label){case 0:if(!e.length)return i(),[2];s=[],a=!1,i.then(function(){var y,b;a=!0;try{for(var x=Wd(s),C=x.next();!C.done;C=x.next()){var P=C.value;P()}}catch(M){y={error:M}}finally{try{C&&!C.done&&(b=x.return)&&b.call(x)}finally{if(y)throw y.error}}}),p.label=1;case 1:return p.trys.push([1,,3,4]),[4,Promise.all(e.map(function(y,b){return $d(d,void 0,void 0,function(){var x,C;return TA(this,function(P){switch(P.label){case 0:P.trys.push([0,,6,9]),P.label=1;case 1:return a?[3,5]:(Promise.resolve(y.next()).then(function(M){return s[b](M)},function(M){return i(M)}),[4,new Promise(function(M){s[b]=M})]);case 2:return x=P.sent(),x===void 0?[3,4]:x.done?(o=x,[2]):[4,n(x.value)];case 3:P.sent(),P.label=4;case 4:return[3,1];case 5:return[3,9];case 6:return C=y.return,C?[4,y.return()]:[3,8];case 7:C=P.sent(),P.label=8;case 8:return[7];case 9:return[2]}})})}))];case 2:return p.sent(),[2,o&&o.value];case 3:return i(),[7];case 4:return[2]}})})})}function o8(r){var t=this,e=v0(r,{returnValues:!0});return new Gp(function(n,i){return $d(t,void 0,void 0,function(){var s,a,o,d;return TA(this,function(p){switch(p.label){case 0:if(!e.length)return i(),[2,[]];a=!1,i.then(function(){s(),a=!0}),p.label=1;case 1:p.trys.push([1,,6,8]),p.label=2;case 2:return a?[3,5]:(Promise.all(e.map(function(y){return y.next()})).then(function(y){return s(y)},function(y){return i(y)}),[4,new Promise(function(y){return s=y})]);case 3:return o=p.sent(),o===void 0?[2]:(d=o.map(function(y){return y.value}),o.some(function(y){return y.done})?[2,d]:[4,n(d)]);case 4:return p.sent(),[3,2];case 5:return[3,8];case 6:return i(),[4,Promise.all(e.map(function(y){return y.return&&y.return()}))];case 7:return p.sent(),[7];case 8:return[2]}})})})}function a8(r){var t=this,e=v0(r,{yieldValues:!0,returnValues:!0});return new Gp(function(n,i){return $d(t,void 0,void 0,function(){var s,a,o,d,p,y=this;return TA(this,function(b){switch(b.label){case 0:if(!e.length)return i(),[2,[]];a=[],o=!1,i.then(function(){var x,C;s();try{for(var P=Wd(a),M=P.next();!M.done;M=P.next()){var k=M.value;k()}}catch(z){x={error:z}}finally{try{M&&!M.done&&(C=P.return)&&C.call(P)}finally{if(x)throw x.error}}o=!0}),b.label=1;case 1:return b.trys.push([1,,5,7]),Promise.all(e.map(function(x){return x.next()})).then(function(x){return s(x)},function(x){return i(x)}),[4,new Promise(function(x){return s=x})];case 2:return d=b.sent(),d===void 0?[2]:(p=d.map(function(x){return x.value}),d.every(function(x){return x.done})?[2,p]:[4,n(p.slice())]);case 3:return b.sent(),[4,Promise.all(e.map(function(x,C){return $d(y,void 0,void 0,function(){var P;return TA(this,function(M){switch(M.label){case 0:if(d[C].done)return[2,d[C].value];M.label=1;case 1:return o?[3,4]:(Promise.resolve(x.next()).then(function(k){return a[C](k)},function(k){return i(k)}),[4,new Promise(function(k){return a[C]=k})]);case 2:return P=M.sent(),P===void 0?[2,d[C].value]:P.done?[2,P.value]:(p[C]=P.value,[4,n(p.slice())]);case 3:return M.sent(),[3,1];case 4:return[2]}})})}))];case 4:return[2,b.sent()];case 5:return i(),[4,Promise.all(e.map(function(x){return x.return&&x.return()}))];case 6:return b.sent(),[7];case 7:return[2]}})})})}let b0=class{constructor(){this._extraRequestThreshold=256*1024}extraRequestThreshold(){return this._extraRequestThreshold}setExtraRequestThreshold(t){if(t<0)throw new Error("extraRequestThreshold cannot be negative");this._extraRequestThreshold=t}};b0.global=new b0;var Kl;(function(r){r[r.Debug=0]="Debug",r[r.Info=1]="Info",r[r.Warn=2]="Warn",r[r.Error=3]="Error"})(Kl||(Kl={}));class Rs{static debug(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.log(Kl.Debug,...e)}static info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.log(Kl.Info,...e)}static warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.log(Kl.Warn,...e)}static error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.log(Kl.Error,...e)}static log(t){if(!(this.logLevel>t)){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];switch(t){case Kl.Debug:{console.debug(...n);break}case Kl.Info:{console.info(...n);break}case Kl.Warn:{console.warn(...n);break}case Kl.Error:{console.error(...n);break}}}}}Rs.logLevel=Kl.Warn;const Oh=8*4+8,l8=16;function xv(r,t){t=Math.min(Math.max(+t,2),65535);let e=r,n=e;do e=Math.ceil(e/t),n+=e;while(e!==1);return n*Oh}function c8(r,t){if(t<2)throw new Error("Node size must be at least 2");if(r===0)throw new Error("Number of items must be greater than 0");let e=r,n=e;const i=[e];do e=Math.ceil(e/t),n+=e,i.push(e);while(e!==1);const s=[];e=n;for(const o of i)s.push(e-o),e-=o;const a=[];for(let o=0;o<i.length;o++)a.push([s[o],s[o]+i[o]]);return a}async function*u8(r,t,e,n){class i{constructor(P,M){this._level=M,this.nodes=P}level(){return this._level}startNodeIdx(){return this.nodes[0]}endNodeIdx(){return this.nodes[1]}extendEndNodeIdx(P){console.assert(P>this.nodes[1]),this.nodes[1]=P}toString(){return`[NodeRange level: ${this._level}, nodes: ${this.nodes[0]}-${this.nodes[1]}]`}}const{minX:s,minY:a,maxX:o,maxY:d}=e;Rs.info(`tree items: ${r}, nodeSize: ${t}`);const p=c8(r,t),y=p[0][0],x=[(()=>{const C=[0,1],P=p.length-1;return new i(C,P)})()];for(Rs.debug(`starting stream search with queue: ${x}, numItems: ${r}, nodeSize: ${t}, levelBounds: ${p}`);x.length!=0;){const C=x.shift();Rs.debug(`popped node: ${C}, queueLength: ${x.length}`);const P=C.startNodeIdx(),M=P>=y,k=(()=>{const[,tt]=p[C.level()],pt=Math.min(C.endNodeIdx()+t,tt);return M&&pt<tt?pt+1:pt})(),z=k-P,V=await n(P*Oh,z*Oh),$=new DataView(V);for(let tt=P;tt<k;tt++){const pt=tt-P,gt=pt*Oh;if(o<$.getFloat64(gt+0,!0)||d<$.getFloat64(gt+8,!0)||s>$.getFloat64(gt+16,!0)||a>$.getFloat64(gt+24,!0))continue;const mt=$.getBigUint64(gt+32,!0);if(M){const ct=mt,wt=(()=>{if(tt<r-1){const $t=(pt+1)*Oh;return $.getBigUint64($t+32,!0)-ct}else return null})(),vt=tt-y;yield[Number(ct),vt,Number(wt)];continue}const dt=mt,Ft=b0.global.extraRequestThreshold()/Oh,Tt=x[x.length-1];if(Tt!==void 0&&Tt.level()==C.level()-1&&dt<Tt.endNodeIdx()+Ft){Rs.debug(`Merging "nodeRange" request into existing range: ${Tt}, newEndNodeIdx: ${Tt.endNodeIdx()} -> ${dt}`),Tt.extendEndNodeIdx(Number(dt));continue}const ot=(()=>{const ct=C.level()-1,wt=[Number(dt),Number(dt)+1];return new i(wt,ct)})();Tt!==void 0&&Tt.level()==ot.level()?Rs.info(`Same level, but too far away. Pushing new request for nodeIdx: ${dt} rather than merging with distant ${Tt}`):Rs.info(`Pushing new level for ${ot} onto queue with nearestNodeRange: ${Tt} since there's not already a range for this level.`),x.push(ot)}}}const IA=new Uint8Array([102,103,98,3,102,103,98,0]),Iu=4;class Bv{constructor(t,e,n,i,s){this.headerClient=t,this.header=e,this.headerLength=n,this.indexLength=i,this.nocache=s}static async open(t,e){const i=new PS(t,e),s=(()=>{const x=l8,C=3;let P=0,M;for(M=0;M<C;M++){const k=x**M*Oh;P+=k}return P})(),a=2024+s;Rs.debug(`fetching header. minReqLength: ${a} (assumedHeaderLength: 2024, assumedIndexLength: ${s})`);{const x=new Uint8Array(await i.getRange(0,8,a,"header"));if(!x.subarray(0,3).every((C,P)=>IA[P]===C))throw Rs.error(`bytes: ${x} != ${IA}`),new Error("Not a FlatGeobuf file");Rs.debug("magic bytes look good")}let o;{const x=await i.getRange(8,4,a,"header");o=new DataView(x).getUint32(0,!0);const C=1048576*10;if(o>C||o<8)throw new Error("Invalid header size");Rs.debug(`headerLength: ${o}`)}const d=await i.getRange(12,o,a,"header"),p=new Tu(new Uint8Array(d)),y=mv(p),b=xv(y.featuresCount,y.indexNodeSize);return Rs.debug("completed: opening http reader"),new Bv(i,y,o,b,e)}async*selectBbox(t){const e=this.lengthBeforeTree(),n=this.headerClient,i=async function(d,p){return n.getRange(e+d,p,0,"index")},s=[];let a=[];for await(const d of u8(this.header.featuresCount,this.header.indexNodeSize,t,i)){const[p,,]=d;let[,,y]=d;if(y||(Rs.info("final feature"),y=4),a.length==0){a.push([p,y]);continue}const b=a[a.length-1],x=p-(b[0]+b[1]);x>b0.global.extraRequestThreshold()&&(Rs.info(`Pushing new feature batch, since gap ${x} was too large`),s.push(a),a=[]),a.push([p,y])}this.headerClient.logUsage("header+index"),a.length>0&&s.push(a);const o=s.flatMap(d=>this.readFeatureBatch(d,this.nocache));yield*Gp.merge(o)}lengthBeforeTree(){return IA.length+Iu+this.headerLength}lengthBeforeFeatures(){return this.lengthBeforeTree()+this.indexLength}buildFeatureClient(t){return new PS(this.headerClient.httpClient,t)}async*readFeatureBatch(t,e){const[n]=t[0],[i,s]=t[t.length-1],a=n,d=i+s-a,p=this.buildFeatureClient(e);let y=d;for(const[b]of t)yield await this.readFeature(p,b,y),y=0;p.logUsage("feature")}async readFeature(t,e,n){const i=e+this.lengthBeforeFeatures();let s;{const y=await t.getRange(i,4,n,"feature length");s=new DataView(y).getUint32(0,!0)}const a=await t.getRange(i+4,s,n,"feature data"),o=new Uint8Array(a),d=new Uint8Array(s+Iu);d.set(o,Iu);const p=new Tu(d);return p.setPosition(Iu),ql.getRootAsFeature(p)}}class PS{constructor(t,e){if(this.bytesEverUsed=0,this.bytesEverFetched=0,this.buffer=new ArrayBuffer(0),this.head=0,typeof t=="string")this.httpClient=new MS(t,e);else if(t instanceof MS)this.httpClient=t;else throw new Error("Unknown source ")}async getRange(t,e,n,i){this.bytesEverUsed+=e;const s=t-this.head,a=s+e;if(s>=0&&a<=this.buffer.byteLength)return this.buffer.slice(s,a);const o=Math.max(e,n);return this.bytesEverFetched+=o,Rs.debug(`requesting for new Range: ${t}-${t+o-1}`),this.buffer=await this.httpClient.getRange(t,o,i),this.head=t,this.buffer.slice(0,e)}logUsage(t){const e=t.split(" ")[0],n=this.bytesEverUsed,i=this.bytesEverFetched,s=(100*n/i).toFixed(2);Rs.info(`${e} bytes used/requested: ${n} / ${i} = ${s}%`)}}class MS{constructor(t,e){this.requestsEverMade=0,this.bytesEverRequested=0,this.url=t,this.nocache=e}async getRange(t,e,n){this.requestsEverMade+=1,this.bytesEverRequested+=e;const i=`bytes=${t}-${t+e-1}`;Rs.info(`request: #${this.requestsEverMade}, purpose: ${n}), bytes: (this_request: ${e}, ever: ${this.bytesEverRequested}), Range: ${i}`);const s={Range:i};return this.nocache&&(s["Cache-Control"]="no-cache, no-store"),(await fetch(this.url,{headers:s})).arrayBuffer()}}function A8(r,t,e){if(!r.subarray(0,3).every((y,b)=>IA[b]===y))throw new Error("Not a FlatGeobuf file");const n=new Tu(r),i=n.readUint32(IA.length);n.setPosition(IA.length+Iu);const s=mv(n);let a=IA.length+Iu+i;const{indexNodeSize:o,featuresCount:d}=s;o>0&&(a+=xv(d,o));const p=[];for(;a<n.capacity();){const y=n.readUint32(a);n.setPosition(a+Iu);const b=ql.getRootAsFeature(n);p.push(t(b,s)),a+=Iu+y}return p}async function*h8(r,t,e){const n=Yk(r),i=async x=>await n.slice(x);let s=new Uint8Array(await i(8));if(!s.subarray(0,3).every((x,C)=>IA[C]===x))throw new Error("Not a FlatGeobuf file");s=new Uint8Array(await i(4));let a=new Tu(s);const o=a.readUint32(0);s=new Uint8Array(await i(o)),a=new Tu(s);const d=mv(a),{indexNodeSize:p,featuresCount:y}=d;if(p>0){const x=xv(y,p);await i(x)}let b;for(;b=await f8(i,d,t);)yield b}function d8(r,t,e,n){try{let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return async function*(){const s=await Bv.open(r,i);Rs.debug("opened reader");for await(const a of s.selectBbox(t))yield e(a,s.header)}()}catch(i){return Promise.reject(i)}}async function f8(r,t,e){let n=new Uint8Array(await r(4,"feature length"));if(n.byteLength===0)return;let i=new Tu(n);const s=i.readUint32(0);n=new Uint8Array(await r(s,"feature data"));const a=new Uint8Array(s+4);a.set(n,4),i=new Tu(a),i.setPosition(Iu);const o=ql.getRootAsFeature(i);return e(o,t)}function p8(r,t){return{type:"FeatureCollection",features:A8(r,pv)}}function g8(r,t){return h8(r,pv)}function m8(r,t,e){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return d8(r,t,pv,e,n)}function US(r,t,e){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return r instanceof Uint8Array?p8(r):r instanceof ReadableStream?g8(r):m8(r,t,e,n)}class y8{constructor(){this._bearing=0,this._pitch=60,this._minpitchzoom=null}onAdd(t){this._map=t;let e=this;return this._btn=document.createElement("button"),this._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-3d",this._btn.id="bt3D",this._btn.type="button",this._btn["aria-label"]="Vista 3D",this._btn.onclick=function(){if(e._btn.className.indexOf("3d")!=-1){let p={pitch:e._pitch,bearing:e._bearing};e._minpitchzoom&&t.getZoom()>e._minpitchzoom&&(p.zoom=e._minpitchzoom);var n=0,i=38.5,s=6,a=62.33,{longitude:o,latitude:d}=t.getCenter();t.getZoom()<10?t.setTerrain({source:"terrainMapZen",exaggeration:1.5}):o>=n&&o<=s&&d>=i&&d<=a?t.setTerrain({source:"terrainICGC",exaggeration:1.2}):t.setTerrain({source:"terrainMapZen",exaggeration:1.5}),t.easeTo(p),e._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-2d"}else t.setTerrain(null),t.easeTo({pitch:0,bearing:0}),e._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-3d"},this._container=document.createElement("div"),this._container.className="maplibregl-ctrl maplibregl-ctrl-group",this._container.title="Vista 3D",this._container.appendChild(this._btn),this._container}onRemove(){this._container.parentNode.removeChild(this._container),this._map=void 0}}function jp(r){"@babel/helpers - typeof";return jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jp(r)}function _8(r,t){if(jp(r)!="object"||!r)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var n=e.call(r,t||"default");if(jp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function v8(r){var t=_8(r,"string");return jp(t)=="symbol"?t:t+""}function j(r,t,e){return t=v8(t),t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function ui(r,t){if(!r)throw new Error(t||"loader assertion failed.")}const w0=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),RS=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);RS&&parseFloat(RS[1]);const b8="3.4.15";function Dc(r,t){if(!r)throw new Error(t||"loaders.gl assertion failed.")}const Cv={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},w8=Cv.global||Cv.self||Cv.window||{},Fu=typeof process!="object"||String(process)!=="[object process]"||process.browser,Ev=typeof importScripts=="function",x8=typeof window<"u"&&typeof window.orientation<"u",OS=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);OS&&parseFloat(OS[1]);class B8{constructor(t,e){j(this,"name",void 0),j(this,"workerThread",void 0),j(this,"isRunning",!0),j(this,"result",void 0),j(this,"_resolve",()=>{}),j(this,"_reject",()=>{}),this.name=t,this.workerThread=e,this.result=new Promise((n,i)=>{this._resolve=n,this._reject=i})}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){Dc(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){Dc(this.isRunning),this.isRunning=!1,this._reject(t)}}let Sv=class{terminate(){}};const Tv=new Map;function C8(r){Dc(r.source&&!r.url||!r.source&&r.url);let t=Tv.get(r.source||r.url);return t||(r.url&&(t=E8(r.url),Tv.set(r.url,t)),r.source&&(t=DS(r.source),Tv.set(r.source,t))),Dc(t),t}function E8(r){if(!r.startsWith("http"))return r;const t=S8(r);return DS(t)}function DS(r){const t=new Blob([r],{type:"application/javascript"});return URL.createObjectURL(t)}function S8(r){return`try {
  importScripts('`.concat(r,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function NS(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,e=arguments.length>2?arguments[2]:void 0;const n=e||new Set;if(r){if(kS(r))n.add(r);else if(kS(r.buffer))n.add(r.buffer);else if(!ArrayBuffer.isView(r)){if(t&&typeof r=="object")for(const i in r)NS(r[i],t,n)}}return e===void 0?Array.from(n):[]}function kS(r){return r?r instanceof ArrayBuffer||typeof MessagePort<"u"&&r instanceof MessagePort||typeof ImageBitmap<"u"&&r instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas:!1}const Iv=()=>{};class Fv{static isSupported(){return typeof Worker<"u"&&Fu||typeof Sv<"u"&&!Fu}constructor(t){j(this,"name",void 0),j(this,"source",void 0),j(this,"url",void 0),j(this,"terminated",!1),j(this,"worker",void 0),j(this,"onMessage",void 0),j(this,"onError",void 0),j(this,"_loadableURL","");const{name:e,source:n,url:i}=t;Dc(n||i),this.name=e,this.source=n,this.url=i,this.onMessage=Iv,this.onError=s=>console.log(s),this.worker=Fu?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Iv,this.onError=Iv,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(t,e){e=e||NS(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+="worker ".concat(this.name," from ").concat(this.url,". "),t.message&&(e+="".concat(t.message," in ")),t.lineno&&(e+=":".concat(t.lineno,":").concat(t.colno)),new Error(e)}_createBrowserWorker(){this._loadableURL=C8({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},t.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},t.onmessageerror=e=>console.error(e),t}_createNodeWorker(){let t;if(this.url){const n=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);t=new Sv(n,{eval:!1})}else if(this.source)t=new Sv(this.source,{eval:!0});else throw new Error("no worker");return t.on("message",e=>{this.onMessage(e)}),t.on("error",e=>{this.onError(e)}),t.on("exit",e=>{}),t}}class T8{static isSupported(){return Fv.isSupported()}constructor(t){j(this,"name","unnamed"),j(this,"source",void 0),j(this,"url",void 0),j(this,"maxConcurrency",1),j(this,"maxMobileConcurrency",1),j(this,"onDebug",()=>{}),j(this,"reuseWorkers",!0),j(this,"props",{}),j(this,"jobQueue",[]),j(this,"idleQueue",[]),j(this,"count",0),j(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach(t=>t.destroy()),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},t.name!==void 0&&(this.name=t.name),t.maxConcurrency!==void 0&&(this.maxConcurrency=t.maxConcurrency),t.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=t.maxMobileConcurrency),t.reuseWorkers!==void 0&&(this.reuseWorkers=t.reuseWorkers),t.onDebug!==void 0&&(this.onDebug=t.onDebug)}async startJob(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,a,o)=>s.done(o),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,a)=>s.error(a);const i=new Promise(s=>(this.jobQueue.push({name:t,onMessage:e,onError:n,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const n=new B8(e.name,t);t.onMessage=i=>e.onMessage(n,i.type,i.payload),t.onError=i=>e.onError(n,i),e.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Fv({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return x8?this.maxMobileConcurrency:this.maxConcurrency}}const I8={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Lu{static isSupported(){return Fv.isSupported()}static getWorkerFarm(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Lu._workerFarm=Lu._workerFarm||new Lu({}),Lu._workerFarm.setProps(t),Lu._workerFarm}constructor(t){j(this,"props",void 0),j(this,"workerPools",new Map),this.props={...I8},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:i}=t;let s=this.workerPools.get(e);return s||(s=new T8({name:e,source:n,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}j(Lu,"_workerFarm",void 0);const F8="latest";function L8(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e=t[r.id]||{},n="".concat(r.id,"-worker.js");let i=e.workerUrl;if(!i&&r.id==="compression"&&(i=t.workerUrl),t._workerType==="test"&&(i="modules/".concat(r.module,"/dist/").concat(n)),!i){let s=r.version;s==="latest"&&(s=F8);const a=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(r.module).concat(a,"/dist/").concat(n)}return Dc(i),i}function P8(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:b8;Dc(r,"no worker provided");const e=r.version;return!(!t||!e)}const M8=null,U8=null,Lv=null,QS=null,R8=Object.freeze(Object.defineProperty({__proto__:null,readFileAsArrayBuffer:M8,readFileAsText:U8,requireFromFile:Lv,requireFromString:QS},Symbol.toStringTag,{value:"Module"})),O8="3.4.15",Pv={};async function Dh(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t&&(r=D8(r,t,e)),Pv[r]=Pv[r]||N8(r),await Pv[r]}function D8(r,t,e){if(r.startsWith("http"))return r;const n=e.modules||{};return n[r]?n[r]:Fu?e.CDN?(Dc(e.CDN.startsWith("http")),"".concat(e.CDN,"/").concat(t,"@").concat(O8,"/dist/libs/").concat(r)):Ev?"../src/libs/".concat(r):"modules/".concat(t,"/src/libs/").concat(r):"modules/".concat(t,"/dist/libs/").concat(r)}async function N8(r){if(r.endsWith("wasm"))return await(await fetch(r)).arrayBuffer();if(!Fu)try{return R8&&Lv&&await Lv(r)}catch{return null}if(Ev)return importScripts(r);const e=await(await fetch(r)).text();return k8(e,r)}function k8(r,t){if(!Fu)return QS;if(Ev)return eval.call(w8,r),null;const e=document.createElement("script");e.id=t;try{e.appendChild(document.createTextNode(r))}catch{e.text=r}return document.body.appendChild(e),null}function Q8(r,t){return!Lu.isSupported()||!Fu&&!(t!=null&&t._nodeWorkers)?!1:r.worker&&(t==null?void 0:t.worker)}async function z8(r,t,e,n,i){const s=r.id,a=L8(r,e),d=Lu.getWorkerFarm(e).getWorkerPool({name:s,url:a});e=JSON.parse(JSON.stringify(e)),n=JSON.parse(JSON.stringify(n||{}));const p=await d.startJob("process-on-worker",H8.bind(null,i));return p.postMessage("process",{input:t,options:e,context:n}),await(await p.result).result}async function H8(r,t,e,n){switch(e){case"done":t.done(n);break;case"error":t.error(new Error(n.error));break;case"process":const{id:i,input:s,options:a}=n;try{const o=await r(s,a);t.postMessage("done",{id:i,result:o})}catch(o){const d=o instanceof Error?o.message:"unknown error";t.postMessage("error",{id:i,error:d})}break;default:console.warn("parse-with-worker unknown message ".concat(e))}}function V8(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof r=="string"?r.slice(0,t):ArrayBuffer.isView(r)?zS(r.buffer,r.byteOffset,t):r instanceof ArrayBuffer?zS(r,0,t):""}function zS(r,t,e){if(r.byteLength<=t+e)return"";const n=new DataView(r);let i="";for(let s=0;s<e;s++)i+=String.fromCharCode(n.getUint8(t+s));return i}function G8(r){try{return JSON.parse(r)}catch{throw new Error('Failed to parse JSON from data starting with "'.concat(V8(r),'"'))}}function j8(r,t,e){if(e=e||r.byteLength,r.byteLength<e||t.byteLength<e)return!1;const n=new Uint8Array(r),i=new Uint8Array(t);for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}function q8(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];const n=t.map(o=>o instanceof ArrayBuffer?new Uint8Array(o):o),i=n.reduce((o,d)=>o+d.byteLength,0),s=new Uint8Array(i);let a=0;for(const o of n)s.set(o,a),a+=o.byteLength;return s.buffer}function Mv(r,t,e){const n=e!==void 0?new Uint8Array(r).subarray(t,t+e):new Uint8Array(r).subarray(t);return new Uint8Array(n).buffer}function qp(r,t){return ui(r>=0),ui(t>0),r+(t-1)&~(t-1)}function K8(r,t,e){let n;if(r instanceof ArrayBuffer)n=new Uint8Array(r);else{const i=r.byteOffset,s=r.byteLength;n=new Uint8Array(r.buffer||r.arrayBuffer,i,s)}return t.set(n,e),e+qp(n.byteLength,4)}async function $8(r){const t=[];for await(const e of r)t.push(e);return q8(...t)}function HS(){let r;if(typeof window<"u"&&window.performance)r=window.performance.now();else if(typeof process<"u"&&process.hrtime){const t=process.hrtime();r=t[0]*1e3+t[1]/1e6}else r=Date.now();return r}class VS{constructor(t,e){j(this,"name",void 0),j(this,"type",void 0),j(this,"sampleSize",1),j(this,"time",void 0),j(this,"count",void 0),j(this,"samples",void 0),j(this,"lastTiming",void 0),j(this,"lastSampleTime",void 0),j(this,"lastSampleCount",void 0),j(this,"_count",0),j(this,"_time",0),j(this,"_samples",0),j(this,"_startTime",0),j(this,"_timerPending",!1),this.name=t,this.type=e,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=HS(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(HS()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Kp{constructor(t){j(this,"id",void 0),j(this,"stats",{}),this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach(e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}}),t}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(e=>this._getOrCreate(e))}_getOrCreate(t){if(!t||!t.name)return null;const{name:e,type:n}=t;return this.stats[e]||(t instanceof VS?this.stats[e]=t:this.stats[e]=new VS(e,n)),this.stats[e]}}const W8="Queued Requests",X8="Active Requests",J8="Cancelled Requests",Y8="Queued Requests Ever",Z8="Active Requests Ever",tQ={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class eQ{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};j(this,"props",void 0),j(this,"stats",void 0),j(this,"activeRequestCount",0),j(this,"requestQueue",[]),j(this,"requestMap",new Map),j(this,"deferredUpdate",null),this.props={...tQ,...t},this.stats=new Kp({id:this.props.id}),this.stats.get(W8),this.stats.get(X8),this.stats.get(J8),this.stats.get(Y8),this.stats.get(Z8)}scheduleRequest(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(t))return this.requestMap.get(t);const n={handle:t,priority:0,getPriority:e},i=new Promise(s=>(n.resolve=s,n));return this.requestQueue.push(n),this.requestMap.set(t,i),this._issueNewRequests(),i}_issueRequest(t){const{handle:e,resolve:n}=t;let i=!1;const s=()=>{i||(i=!0,this.requestMap.delete(e),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(t!==0){this._updateAllRequests();for(let e=0;e<t;++e){const n=this.requestQueue.shift();n&&this._issueRequest(n)}}}_updateAllRequests(){const t=this.requestQueue;for(let e=0;e<t.length;++e){const n=t[e];this._updateRequest(n)||(t.splice(e,1),this.requestMap.delete(n.handle),e--)}t.sort((e,n)=>e.priority-n.priority)}_updateRequest(t){return t.priority=t.getPriority(t.handle),t.priority<0?(t.resolve(null),!1):!0}}let rQ="";const GS={};function nQ(r){for(const t in GS)if(r.startsWith(t)){const e=GS[t];r=r.replace(t,e)}return!r.startsWith("http://")&&!r.startsWith("https://")&&(r="".concat(rQ).concat(r)),r}function Zwt(r){return r}function iQ(r){return r&&typeof r=="object"&&r.isBuffer}function jS(r){if(iQ(r))return r;if(r instanceof ArrayBuffer)return r;if(ArrayBuffer.isView(r))return r.byteOffset===0&&r.byteLength===r.buffer.byteLength?r.buffer:r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength);if(typeof r=="string"){const t=r;return new TextEncoder().encode(t).buffer}if(r&&typeof r=="object"&&r._toArrayBuffer)return r._toArrayBuffer();throw new Error("toArrayBuffer")}function qS(r){const t=r?r.lastIndexOf("/"):-1;return t>=0?r.substr(t+1):""}function Uv(r){const t=r?r.lastIndexOf("/"):-1;return t>=0?r.substr(0,t):""}const sQ=r=>typeof r=="boolean",$p=r=>typeof r=="function",Wp=r=>r!==null&&typeof r=="object",KS=r=>Wp(r)&&r.constructor==={}.constructor,oQ=r=>r&&typeof r[Symbol.iterator]=="function",aQ=r=>r&&typeof r[Symbol.asyncIterator]=="function",Nh=r=>typeof Response<"u"&&r instanceof Response||r&&r.arrayBuffer&&r.text&&r.json,kh=r=>typeof Blob<"u"&&r instanceof Blob,lQ=r=>r&&typeof r=="object"&&r.isBuffer,cQ=r=>typeof ReadableStream<"u"&&r instanceof ReadableStream||Wp(r)&&$p(r.tee)&&$p(r.cancel)&&$p(r.getReader),uQ=r=>Wp(r)&&$p(r.read)&&$p(r.pipe)&&sQ(r.readable),$S=r=>cQ(r)||uQ(r),AQ=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,hQ=/^([-\w.]+\/[-\w.+]+)/;function dQ(r){const t=hQ.exec(r);return t?t[1]:r}function WS(r){const t=AQ.exec(r);return t?t[1]:""}const XS=/\?.*/;function fQ(r){const t=r.match(XS);return t&&t[0]}function Rv(r){return r.replace(XS,"")}function x0(r){return Nh(r)?r.url:kh(r)?r.name||"":typeof r=="string"?r:""}function Ov(r){if(Nh(r)){const t=r,e=t.headers.get("content-type")||"",n=Rv(t.url);return dQ(e)||WS(n)}return kh(r)?r.type||"":typeof r=="string"?WS(r):""}function pQ(r){return Nh(r)?r.headers["content-length"]||-1:kh(r)?r.size:typeof r=="string"?r.length:r instanceof ArrayBuffer||ArrayBuffer.isView(r)?r.byteLength:-1}async function JS(r){if(Nh(r))return r;const t={},e=pQ(r);e>=0&&(t["content-length"]=String(e));const n=x0(r),i=Ov(r);i&&(t["content-type"]=i);const s=await yQ(r);s&&(t["x-first-bytes"]=s),typeof r=="string"&&(r=new TextEncoder().encode(r));const a=new Response(r,{headers:t});return Object.defineProperty(a,"url",{value:n}),a}async function gQ(r){if(!r.ok){const t=await mQ(r);throw new Error(t)}}async function mQ(r){let t="Failed to fetch resource ".concat(r.url," (").concat(r.status,"): ");try{const e=r.headers.get("Content-Type");let n=r.statusText;e.includes("application/json")&&(n+=" ".concat(await r.text())),t+=n,t=t.length>60?"".concat(t.slice(0,60),"..."):t}catch{}return t}async function yQ(r){if(typeof r=="string")return"data:,".concat(r.slice(0,5));if(r instanceof Blob){const e=r.slice(0,5);return await new Promise(n=>{const i=new FileReader;i.onload=s=>{var a;return n(s==null||(a=s.target)===null||a===void 0?void 0:a.result)},i.readAsDataURL(e)})}if(r instanceof ArrayBuffer){const e=r.slice(0,5),n=_Q(e);return"data:base64,".concat(n)}return null}function _Q(r){let t="";const e=new Uint8Array(r);for(let n=0;n<e.byteLength;n++)t+=String.fromCharCode(e[n]);return btoa(t)}async function YS(r,t){if(typeof r=="string"){r=nQ(r);let e=t;return t!=null&&t.fetch&&typeof(t==null?void 0:t.fetch)!="function"&&(e=t.fetch),await fetch(r,e)}return await JS(r)}function ZS(r){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent;return!!(e&&e.indexOf("Electron")>=0)}function Pu(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||ZS()}const B0={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},C0=B0.window||B0.self||B0.global,Xp=B0.process||{},tT=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Pu();const Dv=globalThis;function eT(r){if(!Pu())return"Node";if(ZS())return"Electron";const e=(typeof navigator<"u"?navigator:{}).userAgent||"";if(e.indexOf("Edge")>-1)return"Edge";const n=e.indexOf("MSIE ")!==-1,i=e.indexOf("Trident/")!==-1;return n||i?"IE":Dv.chrome?"Chrome":Dv.safari?"Safari":Dv.mozInnerScreenX?"Firefox":"Unknown"}function vQ(r){try{const t=window[r],e="__storage_test__";return t.setItem(e,e),t.removeItem(e),t}catch{return null}}class bQ{constructor(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";j(this,"storage",void 0),j(this,"id",void 0),j(this,"config",void 0),this.storage=vQ(n),this.id=t,this.config=e,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function wQ(r){let t;return r<10?t="".concat(r.toFixed(2),"ms"):r<100?t="".concat(r.toFixed(1),"ms"):r<1e3?t="".concat(r.toFixed(0),"ms"):t="".concat((r/1e3).toFixed(2),"s"),t}function xQ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const e=Math.max(t-r.length,0);return"".concat(" ".repeat(e)).concat(r)}function Nv(r,t,e){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=r.src.replace(/\(/g,"%28").replace(/\)/g,"%29");r.width>n&&(e=Math.min(e,n/r.width));const s=r.width*e,a=r.height*e,o=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(t," %c+"),o]}let E0;(function(r){r[r.BLACK=30]="BLACK",r[r.RED=31]="RED",r[r.GREEN=32]="GREEN",r[r.YELLOW=33]="YELLOW",r[r.BLUE=34]="BLUE",r[r.MAGENTA=35]="MAGENTA",r[r.CYAN=36]="CYAN",r[r.WHITE=37]="WHITE",r[r.BRIGHT_BLACK=90]="BRIGHT_BLACK",r[r.BRIGHT_RED=91]="BRIGHT_RED",r[r.BRIGHT_GREEN=92]="BRIGHT_GREEN",r[r.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",r[r.BRIGHT_BLUE=94]="BRIGHT_BLUE",r[r.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",r[r.BRIGHT_CYAN=96]="BRIGHT_CYAN",r[r.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(E0||(E0={}));function rT(r){return typeof r=="string"?E0[r.toUpperCase()]||E0.WHITE:r}function BQ(r,t,e){return!Pu&&typeof r=="string"&&(t&&(t=rT(t),r="\x1B[".concat(t,"m").concat(r,"\x1B[39m")),e&&(t=rT(e),r="\x1B[".concat(e+10,"m").concat(r,"\x1B[49m"))),r}function CQ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const e=Object.getPrototypeOf(r),n=Object.getOwnPropertyNames(e);for(const i of n)typeof r[i]=="function"&&(t.find(s=>i===s)||(r[i]=r[i].bind(r)))}function S0(r,t){if(!r)throw new Error(t||"Assertion failed")}function Jd(){let r;if(Pu&&"performance"in C0){var t,e;r=C0==null||(t=C0.performance)===null||t===void 0||(e=t.now)===null||e===void 0?void 0:e.call(t)}else if("hrtime"in Xp){var n;const i=Xp==null||(n=Xp.hrtime)===null||n===void 0?void 0:n.call(Xp);r=i[0]*1e3+i[1]/1e6}else r=Date.now();return r}const Yd={debug:Pu&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},EQ={enabled:!0,level:0};function sl(){}const nT={},iT={once:!0};class Jp{constructor(){let{id:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};j(this,"id",void 0),j(this,"VERSION",tT),j(this,"_startTs",Jd()),j(this,"_deltaTs",Jd()),j(this,"_storage",void 0),j(this,"userData",{}),j(this,"LOG_THROTTLE_TIMEOUT",0),this.id=t,this.userData={},this._storage=new bQ("__probe-".concat(this.id,"__"),EQ),this.timeStamp("".concat(this.id," started")),CQ(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Jd()-this._startTs).toPrecision(10))}getDelta(){return Number((Jd()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:t}),this}setLevel(t){return this._storage.setConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,e){this._storage.setConfiguration({[t]:e})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,e){S0(t,e)}warn(t){return this._getLogFunction(0,t,Yd.warn,arguments,iT)}error(t){return this._getLogFunction(0,t,Yd.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,Yd.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,Yd.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];return this._getLogFunction(t,e,Yd.debug||Yd.info,arguments,iT)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||sl,n&&[n],{tag:FQ(e)}):sl}image(t){let{logLevel:e,priority:n,image:i,message:s="",scale:a=1}=t;return this._shouldLog(e||n)?Pu?IQ({image:i,message:s,scale:a}):TQ():sl}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||sl)}group(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=oT({logLevel:t,message:e,opts:n}),{collapsed:s}=n;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||sl)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=sT(t)}_getLogFunction(t,e,n,i,s){if(this._shouldLog(t)){s=oT({logLevel:t,message:e,args:i,opts:s}),n=n||s.method,S0(n),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Jd();const a=s.tag||s.message;if(s.once)if(!nT[a])nT[a]=Jd();else return sl;return e=SQ(this.id,s.message,s),n.bind(console,e,...s.args)}return sl}}j(Jp,"VERSION",tT);function sT(r){if(!r)return 0;let t;switch(typeof r){case"number":t=r;break;case"object":t=r.logLevel||r.priority||0;break;default:return 0}return S0(Number.isFinite(t)&&t>=0),t}function oT(r){const{logLevel:t,message:e}=r;r.logLevel=sT(t);const n=r.args?Array.from(r.args):[];for(;n.length&&n.shift()!==e;);switch(typeof t){case"string":case"function":e!==void 0&&n.unshift(e),r.message=t;break;case"object":Object.assign(r,t);break}typeof r.message=="function"&&(r.message=r.message());const i=typeof r.message;return S0(i==="string"||i==="object"),Object.assign(r,{args:n},r.opts)}function SQ(r,t,e){if(typeof t=="string"){const n=e.time?xQ(wQ(e.total)):"";t=e.time?"".concat(r,": ").concat(n,"  ").concat(t):"".concat(r,": ").concat(t),t=BQ(t,e.color,e.background)}return t}function TQ(r){return console.warn("removed"),sl}function IQ(r){let{image:t,message:e="",scale:n=1}=r;if(typeof t=="string"){const s=new Image;return s.onload=()=>{const a=Nv(s,e,n);console.log(...a)},s.src=t,sl}const i=t.nodeName||"";if(i.toLowerCase()==="img")return console.log(...Nv(t,e,n)),sl;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...Nv(s,e,n)),s.src=t.toDataURL(),sl}return sl}function FQ(r){for(const t in r)for(const e in r[t])return e||"untitled";return"empty"}const aT=new Jp({id:"loaders.gl"});class LQ{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class PQ{constructor(){j(this,"console",void 0),this.console=console}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.log.bind(this.console,...e)}info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.info.bind(this.console,...e)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.warn.bind(this.console,...e)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.error.bind(this.console,...e)}}const lT={fetch:null,mimeType:void 0,nothrow:!1,log:new PQ,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:w0,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},MQ={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function cT(){globalThis.loaders=globalThis.loaders||{};const{loaders:r}=globalThis;return r._state=r._state||{},r._state}const uT=()=>{const r=cT();return r.globalOptions=r.globalOptions||{...lT},r.globalOptions};function UQ(r,t,e,n){return e=e||[],e=Array.isArray(e)?e:[e],RQ(r,e),DQ(t,r,n)}function RQ(r,t){AT(r,null,lT,MQ,t);for(const e of t){const n=r&&r[e.id]||{},i=e.options&&e.options[e.id]||{},s=e.deprecatedOptions&&e.deprecatedOptions[e.id]||{};AT(n,e.id,i,s,t)}}function AT(r,t,e,n,i){const s=t||"Top level",a=t?"".concat(t,"."):"";for(const o in r){const d=!t&&Wp(r[o]),p=o==="baseUri"&&!t,y=o==="workerUrl"&&t;if(!(o in e)&&!p&&!y){if(o in n)aT.warn("".concat(s," loader option '").concat(a).concat(o,"' no longer supported, use '").concat(n[o],"'"))();else if(!d){const b=OQ(o,i);aT.warn("".concat(s," loader option '").concat(a).concat(o,"' not recognized. ").concat(b))()}}}}function OQ(r,t){const e=r.toLowerCase();let n="";for(const i of t)for(const s in i.options){if(r===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const a=s.toLowerCase();(e.startsWith(a)||a.startsWith(e))&&(n=n||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return n}function DQ(r,t,e){const i={...r.options||{}};return NQ(i,e),i.log===null&&(i.log=new LQ),hT(i,uT()),hT(i,t),i}function hT(r,t){for(const e in t)if(e in t){const n=t[e];KS(n)&&KS(r[e])?r[e]={...r[e],...t[e]}:r[e]=t[e]}}function NQ(r,t){t&&!("baseUri"in r)&&(r.baseUri=t)}function kv(r){var t;return r?(Array.isArray(r)&&(r=r[0]),Array.isArray((t=r)===null||t===void 0?void 0:t.extensions)):!1}function Qv(r){var t,e;ui(r,"null loader"),ui(kv(r),"invalid loader");let n;return Array.isArray(r)&&(n=r[1],r=r[0],r={...r,options:{...r.options,...n}}),((t=r)!==null&&t!==void 0&&t.parseTextSync||(e=r)!==null&&e!==void 0&&e.parseText)&&(r.text=!0),r.text||(r.binary=!0),r}const dT=()=>{const r=cT();return r.loaderRegistry=r.loaderRegistry||[],r.loaderRegistry};function kQ(r){const t=dT();r=Array.isArray(r)?r:[r];for(const e of r){const n=Qv(e);t.find(i=>n===i)||t.unshift(n)}}function QQ(){return dT()}const zQ=new Jp({id:"loaders.gl"}),HQ=/\.([^.]+)$/;async function VQ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],e=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!pT(r))return null;let i=fT(r,t,{...e,nothrow:!0},n);if(i)return i;if(kh(r)&&(r=await r.slice(0,10).arrayBuffer(),i=fT(r,t,e,n)),!i&&!(e!=null&&e.nothrow))throw new Error(gT(r));return i}function fT(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],e=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!pT(r))return null;if(t&&!Array.isArray(t))return Qv(t);let i=[];t&&(i=i.concat(t)),e!=null&&e.ignoreRegisteredLoaders||i.push(...QQ()),jQ(i);const s=GQ(r,i,e,n);if(!s&&!(e!=null&&e.nothrow))throw new Error(gT(r));return s}function GQ(r,t,e,n){const i=x0(r),s=Ov(r),a=Rv(i)||(n==null?void 0:n.url);let o=null,d="";if(e!=null&&e.mimeType&&(o=zv(t,e==null?void 0:e.mimeType),d="match forced by supplied MIME type ".concat(e==null?void 0:e.mimeType)),o=o||qQ(t,a),d=d||(o?"matched url ".concat(a):""),o=o||zv(t,s),d=d||(o?"matched MIME type ".concat(s):""),o=o||$Q(t,r),d=d||(o?"matched initial data ".concat(yT(r)):""),o=o||zv(t,e==null?void 0:e.fallbackMimeType),d=d||(o?"matched fallback MIME type ".concat(s):""),d){var p;zQ.log(1,"selectLoader selected ".concat((p=o)===null||p===void 0?void 0:p.name,": ").concat(d,"."))}return o}function pT(r){return!(r instanceof Response&&r.status===204)}function gT(r){const t=x0(r),e=Ov(r);let n="No valid loader found (";n+=t?"".concat(qS(t),", "):"no url provided, ",n+="MIME type: ".concat(e?'"'.concat(e,'"'):"not provided",", ");const i=r?yT(r):"";return n+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",n+=")",n}function jQ(r){for(const t of r)Qv(t)}function qQ(r,t){const e=t&&HQ.exec(t),n=e&&e[1];return n?KQ(r,n):null}function KQ(r,t){t=t.toLowerCase();for(const e of r)for(const n of e.extensions)if(n.toLowerCase()===t)return e;return null}function zv(r,t){for(const e of r)if(e.mimeTypes&&e.mimeTypes.includes(t)||t==="application/x.".concat(e.id))return e;return null}function $Q(r,t){if(!t)return null;for(const e of r)if(typeof t=="string"){if(WQ(t,e))return e}else if(ArrayBuffer.isView(t)){if(mT(t.buffer,t.byteOffset,e))return e}else if(t instanceof ArrayBuffer&&mT(t,0,e))return e;return null}function WQ(r,t){return t.testText?t.testText(r):(Array.isArray(t.tests)?t.tests:[t.tests]).some(n=>r.startsWith(n))}function mT(r,t,e){return(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>XQ(r,t,e,i))}function XQ(r,t,e,n){if(n instanceof ArrayBuffer)return j8(n,r,n.byteLength);switch(typeof n){case"function":return n(r,e);case"string":const i=Hv(r,t,n.length);return n===i;default:return!1}}function yT(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof r=="string"?r.slice(0,t):ArrayBuffer.isView(r)?Hv(r.buffer,r.byteOffset,t):r instanceof ArrayBuffer?Hv(r,0,t):""}function Hv(r,t,e){if(r.byteLength<t+e)return"";const n=new DataView(r);let i="";for(let s=0;s<e;s++)i+=String.fromCharCode(n.getUint8(t+s));return i}const JQ=256*1024;function*YQ(r,t){const e=(t==null?void 0:t.chunkSize)||JQ;let n=0;const i=new TextEncoder;for(;n<r.length;){const s=Math.min(r.length-n,e),a=r.slice(n,n+s);n+=s,yield i.encode(a)}}const ZQ=256*1024;function tz(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:e=ZQ}=t;let n=0;for(;n<r.byteLength;){const i=Math.min(r.byteLength-n,e),s=new ArrayBuffer(i),a=new Uint8Array(r,n,i);new Uint8Array(s).set(a),n+=i,yield s}}()}const ez=1024*1024;async function*rz(r,t){const e=(t==null?void 0:t.chunkSize)||ez;let n=0;for(;n<r.size;){const i=n+e,s=await r.slice(n,i).arrayBuffer();n=i,yield s}}function _T(r,t){return w0?nz(r,t):iz(r)}async function*nz(r,t){const e=r.getReader();let n;try{for(;;){const i=n||e.read();t!=null&&t._streamReadAhead&&(n=e.read());const{done:s,value:a}=await i;if(s)return;yield jS(a)}}catch{e.releaseLock()}}async function*iz(r,t){for await(const e of r)yield jS(e)}function sz(r,t){if(typeof r=="string")return YQ(r,t);if(r instanceof ArrayBuffer)return tz(r,t);if(kh(r))return rz(r,t);if($S(r))return _T(r,t);if(Nh(r))return _T(r.body,t);throw new Error("makeIterator")}const vT="Cannot convert supplied data type";function oz(r,t,e){if(t.text&&typeof r=="string")return r;if(lQ(r)&&(r=r.buffer),r instanceof ArrayBuffer){const n=r;return t.text&&!t.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(r)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(r);let n=r.buffer;const i=r.byteLength||r.length;return(r.byteOffset!==0||i!==n.byteLength)&&(n=n.slice(r.byteOffset,r.byteOffset+i)),n}throw new Error(vT)}async function az(r,t,e){const n=r instanceof ArrayBuffer||ArrayBuffer.isView(r);if(typeof r=="string"||n)return oz(r,t);if(kh(r)&&(r=await JS(r)),Nh(r)){const i=r;return await gQ(i),t.binary?await i.arrayBuffer():await i.text()}if($S(r)&&(r=sz(r,e)),oQ(r)||aQ(r))return $8(r);throw new Error(vT)}function bT(r,t){const e=uT(),n=r||e;return typeof n.fetch=="function"?n.fetch:Wp(n.fetch)?i=>YS(i,n):t!=null&&t.fetch?t==null?void 0:t.fetch:YS}function lz(r,t,e){if(e)return e;const n={fetch:bT(t,r),...r};if(n.url){const i=Rv(n.url);n.baseUrl=i,n.queryString=fQ(n.url),n.filename=qS(i),n.baseUrl=Uv(i)}return Array.isArray(n.loaders)||(n.loaders=null),n}function cz(r,t){if(!t&&r&&!Array.isArray(r))return r;let e;if(r&&(e=Array.isArray(r)?r:[r]),t&&t.loaders){const n=Array.isArray(t.loaders)?t.loaders:[t.loaders];e=e?[...e,...n]:n}return e&&e.length?e:null}async function Vv(r,t,e,n){Dc(!n||typeof n=="object"),t&&!Array.isArray(t)&&!kv(t)&&(n=void 0,e=t,t=void 0),r=await r,e=e||{};const i=x0(r),a=cz(t,n),o=await VQ(r,a,e);return o?(e=UQ(e,o,a,i),n=lz({url:i,parse:Vv,loaders:a},e,n||null),await uz(o,r,e,n)):null}async function uz(r,t,e,n){if(P8(r),Nh(t)){const i=t,{ok:s,redirected:a,status:o,statusText:d,type:p,url:y}=i,b=Object.fromEntries(i.headers.entries());n.response={headers:b,ok:s,redirected:a,status:o,statusText:d,type:p,url:y}}if(t=await az(t,r,e),r.parseTextSync&&typeof t=="string")return e.dataType="text",r.parseTextSync(t,e,n,r);if(Q8(r,e))return await z8(r,t,e,n,Vv);if(r.parseText&&typeof t=="string")return await r.parseText(t,e,n,r);if(r.parse)return await r.parse(t,e,n,r);throw Dc(!r.parseSync),new Error("".concat(r.id," loader - no parser found and worker is disabled"))}async function FA(r,t,e,n){!Array.isArray(t)&&!kv(t)&&(e=t,t=void 0);const i=bT(e);let s=r;return typeof r=="string"&&(s=await i(r)),kh(r)&&(s=await i(r)),await Vv(s,t,e)}const Az="3.4.15",{_parseImageNode:hz}=globalThis,Gv=typeof Image<"u",jv=typeof ImageBitmap<"u",qv=w0?!0:!!hz;function dz(r){switch(r){case"auto":return jv||Gv||qv;case"imagebitmap":return jv;case"image":return Gv;case"data":return qv;default:throw new Error("@loaders.gl/images: image ".concat(r," not supported in this environment"))}}function fz(){if(jv)return"imagebitmap";if(Gv)return"image";if(qv)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function pz(r){const t=mz(r);if(!t)throw new Error("Not an image");return t}function gz(r){switch(pz(r)){case"data":return r;case"image":case"imagebitmap":const t=document.createElement("canvas"),e=t.getContext("2d");if(!e)throw new Error("getImageData");return t.width=r.width,t.height=r.height,e.drawImage(r,0,0),e.getImageData(0,0,r.width,r.height);default:throw new Error("getImageData")}}function mz(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&r instanceof Image?"image":r&&typeof r=="object"&&r.data&&r.width&&r.height?"data":null}const yz=/^data:image\/svg\+xml/,_z=/\.svg((\?|#).*)?$/;function Kv(r){return r&&(yz.test(r)||_z.test(r))}function vz(r,t){if(Kv(t)){let n=new TextDecoder().decode(r);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(n=unescape(encodeURIComponent(n)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(n))}return wT(r,t)}function wT(r,t){if(Kv(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(r)])}async function xT(r,t,e){const n=vz(r,e),i=self.URL||self.webkitURL,s=typeof n!="string"&&i.createObjectURL(n);try{return await bz(s||n,t)}finally{s&&i.revokeObjectURL(s)}}async function bz(r,t){const e=new Image;return e.src=r,t.image&&t.image.decode&&e.decode?(await e.decode(),e):await new Promise((n,i)=>{try{e.onload=()=>n(e),e.onerror=s=>i(new Error("Could not load image ".concat(r,": ").concat(s)))}catch(s){i(s)}})}const wz={};let BT=!0;async function xz(r,t,e){let n;Kv(e)?n=await xT(r,t,e):n=wT(r,e);const i=t&&t.imagebitmap;return await Bz(n,i)}async function Bz(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((Cz(t)||!BT)&&(t=null),t)try{return await createImageBitmap(r,t)}catch(e){console.warn(e),BT=!1}return await createImageBitmap(r)}function Cz(r){for(const t in r||wz)return!1;return!0}function Ez(r){return!Fz(r,"ftyp",4)||!(r[8]&96)?null:Sz(r)}function Sz(r){switch(Tz(r,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function Tz(r,t,e){return String.fromCharCode(...r.slice(t,e))}function Iz(r){return[...r].map(t=>t.charCodeAt(0))}function Fz(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const n=Iz(t);for(let i=0;i<n.length;++i)if(n[i]!==r[i+e])return!1;return!0}const Nc=!1,Yp=!0;function $v(r){const t=Zp(r);return Pz(t)||Rz(t)||Mz(t)||Uz(t)||Lz(t)}function Lz(r){const t=new Uint8Array(r instanceof DataView?r.buffer:r),e=Ez(t);return e?{mimeType:e.mimeType,width:0,height:0}:null}function Pz(r){const t=Zp(r);return t.byteLength>=24&&t.getUint32(0,Nc)===2303741511?{mimeType:"image/png",width:t.getUint32(16,Nc),height:t.getUint32(20,Nc)}:null}function Mz(r){const t=Zp(r);return t.byteLength>=10&&t.getUint32(0,Nc)===1195984440?{mimeType:"image/gif",width:t.getUint16(6,Yp),height:t.getUint16(8,Yp)}:null}function Uz(r){const t=Zp(r);return t.byteLength>=14&&t.getUint16(0,Nc)===16973&&t.getUint32(2,Yp)===t.byteLength?{mimeType:"image/bmp",width:t.getUint32(18,Yp),height:t.getUint32(22,Yp)}:null}function Rz(r){const t=Zp(r);if(!(t.byteLength>=3&&t.getUint16(0,Nc)===65496&&t.getUint8(2)===255))return null;const{tableMarkers:n,sofMarkers:i}=Oz();let s=2;for(;s+9<t.byteLength;){const a=t.getUint16(s,Nc);if(i.has(a))return{mimeType:"image/jpeg",height:t.getUint16(s+5,Nc),width:t.getUint16(s+7,Nc)};if(!n.has(a))return null;s+=2,s+=t.getUint16(s,Nc)}return null}function Oz(){const r=new Set([65499,65476,65484,65501,65534]);for(let e=65504;e<65520;++e)r.add(e);return{tableMarkers:r,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Zp(r){if(r instanceof DataView)return r;if(ArrayBuffer.isView(r))return new DataView(r.buffer);if(r instanceof ArrayBuffer)return new DataView(r);throw new Error("toDataView")}async function Dz(r,t){const{mimeType:e}=$v(r)||{},n=globalThis._parseImageNode;return ui(n),await n(r,e)}async function Nz(r,t,e){t=t||{};const i=(t.image||{}).type||"auto",{url:s}=e||{},a=kz(i);let o;switch(a){case"imagebitmap":o=await xz(r,t,s);break;case"image":o=await xT(r,t,s);break;case"data":o=await Dz(r);break;default:ui(!1)}return i==="data"&&(o=gz(o)),o}function kz(r){switch(r){case"auto":case"data":return fz();default:return dz(r),r}}const CT={id:"image",module:"images",name:"Images",version:Az,mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:Nz,tests:[r=>!!$v(new DataView(r))],options:{image:{type:"auto",decode:!0}}},Wv={};function Qz(r){if(Wv[r]===void 0){const t=w0?Hz(r):zz(r);Wv[r]=t}return Wv[r]}function zz(r){const t=["image/png","image/jpeg","image/gif"],{_parseImageNode:e,_imageFormatsNode:n=t}=globalThis;return!!e&&n.includes(r)}function Hz(r){switch(r){case"image/avif":case"image/webp":return Vz(r);default:return!0}}function Vz(r){try{return document.createElement("canvas").toDataURL(r).indexOf("data:".concat(r))===0}catch{return!1}}const Tn=new Jp({id:"deck"}),LA={attributeUpdateStart:-1,attributeManagerUpdateStart:-1,attributeUpdateMessages:[]},Xv=1,tg=2,Jv=3,Yv=4,Gz=2,jz=r=>({"layer.changeFlag":(t,e,n)=>{r.log(Jv,"".concat(t.id," ").concat(e,": "),n[e])()},"layer.initialize":t=>{r.log(Xv,"Initializing ".concat(t))()},"layer.update":(t,e)=>{if(e){const n=t.getChangeFlags();r.log(tg,"Updating ".concat(t," because: ").concat(Object.keys(n).filter(i=>n[i]).join(", ")))()}else r.log(Yv,"".concat(t," does not need update"))()},"layer.matched":(t,e)=>{e&&r.log(Yv,"Matched ".concat(t,", state transfered"))()},"layer.finalize":t=>{r.log(Xv,"Finalizing ".concat(t))()},"compositeLayer.renderLayers":(t,e,n)=>{e?r.log(tg,"Composite layer rendered new subLayers ".concat(t),n)():r.log(Yv,"Composite layer reused subLayers ".concat(t),n)()},"layerManager.setLayers":(t,e,n)=>{e&&r.log(tg,"Updating ".concat(n.length," deck layers"))()},"layerManager.activateViewport":(t,e)=>{r.log(Jv,"Viewport changed",e)()},"attributeManager.invalidate":(t,e,n)=>{r.log(Xv,n?"invalidated attributes ".concat(n," (").concat(e,") for ").concat(t.id):"invalidated all attributes for ".concat(t.id))()},"attributeManager.updateStart":t=>{LA.attributeUpdateMessages.length=0,LA.attributeManagerUpdateStart=Date.now()},"attributeManager.updateEnd":(t,e)=>{const n=Math.round(Date.now()-LA.attributeManagerUpdateStart);r.groupCollapsed(tg,"Updated attributes for ".concat(e," instances in ").concat(t.id," in ").concat(n,"ms"))();for(const i of LA.attributeUpdateMessages)r.log(Jv,i)();r.groupEnd(tg)()},"attribute.updateStart":t=>{LA.attributeUpdateStart=Date.now()},"attribute.allocate":(t,e)=>{const n="".concat(t.id," allocated ").concat(e);LA.attributeUpdateMessages.push(n)},"attribute.updateEnd":(t,e)=>{const n=Math.round(Date.now()-LA.attributeUpdateStart),i="".concat(t.id," updated ").concat(e," in ").concat(n,"ms");LA.attributeUpdateMessages.push(i)},"deckRenderer.renderLayers":(t,e,n)=>{const{pass:i,redrawReason:s,stats:a}=n;for(const o of e){const{totalCount:d,visibleCount:p,compositeCount:y,pickableCount:b}=o,C=d-y-p;r.log(Gz,"RENDER #".concat(t.renderCount,"   ").concat(p," (of ").concat(d," layers) to ").concat(i," because ").concat(s,"   (").concat(C," hidden, ").concat(y," composite ").concat(b," pickable)"))(),a&&a.get("Redraw Layers").add(p)}}});var qz={};let T0={};qz.NODE_ENV!=="production"&&(T0=jz(Tn));function Kz(r){T0=r}function oo(r,t,e,n){Tn.level>0&&T0[r]&&T0[r].call(null,t,e,n)}function $z(r){const t=r[0],e=r[r.length-1];return t==="{"&&e==="}"||t==="["&&e==="]"}const Wz={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:$z,parseTextSync:JSON.parse};function Xz(){const r="8.9.36",t=globalThis.deck&&globalThis.deck.VERSION;if(t&&t!==r)throw new Error("deck.gl - multiple versions detected: ".concat(t," vs ").concat(r));return t||(Tn.log(1,"deck.gl ".concat(r))(),globalThis.deck={...globalThis.deck,VERSION:r,version:r,log:Tn,_registerLoggers:Kz},kQ([Wz,[CT,{imagebitmap:{premultiplyAlpha:"none"}}]])),r}const Jz=Xz(),En={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(En,"IDENTITY",{get:()=>(Tn.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const kc={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Zv={common:0,meters:1,pixels:2},ET={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},vr=new Jp({id:"luma.gl"});function Lo(r,t){if(!r)throw new Error(t||"luma.gl: assertion failed.")}const Yz="Invalid WebGLRenderingContext",Zz="Requires WebGL2";function I0(r){return typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?!0:!!(r&&Number.isFinite(r._version))}function fn(r){return typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?!0:!!(r&&r._version===2)}function tH(r){return fn(r)?r:null}function F0(r){return Lo(I0(r),Yz),r}function Po(r){return Lo(fn(r),Zz),r}const eg={};function eH(r){globalThis.console&&globalThis.console.error&&globalThis.console.error(r)}function rH(r){globalThis.console&&globalThis.console.log&&globalThis.console.log(r)}function nH(r,t){eg[r]=!0,eH(t)}function iH(r){const t=r.getError;r.getError=function(){let n;do n=t.apply(r),n!==0&&(eg[n]=!0);while(n!==0);for(n in eg)if(eg[n])return delete eg[n],parseInt(n,10);return 0}}const rg=function r(t){const e=t.gl;this.ext=t,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(t.maxVertexAttribs);for(let n=0;n<this.attribs.length;n++){const i=new r.VertexAttrib(e);this.attribs[n]=i}this.maxAttrib=0};rg.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()},rg.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Qh=function(t){const e=this;this.gl=t,iH(t);const n=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(s){return s===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(s){const a=e.currentVertexArrayObject;a.maxAttrib=Math.max(a.maxAttrib,s);const o=a.attribs[s];return o.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(s){const a=e.currentVertexArrayObject;a.maxAttrib=Math.max(a.maxAttrib,s);const o=a.attribs[s];return o.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(s,a){switch(s){case 34962:e.currentArrayBuffer=a;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=a;break}return n.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(s,a){const d=e.currentVertexArrayObject.attribs[s];switch(a){case 34975:return d.buffer;case 34338:return d.enabled;case 34339:return d.size;case 34340:return d.stride;case 34341:return d.type;case 34922:return d.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(s,a,o,d,p,y){const b=e.currentVertexArrayObject;b.maxAttrib=Math.max(b.maxAttrib,s);const x=b.attribs[s];return x.buffer=e.currentArrayBuffer,x.size=a,x.type=o,x.normalized=d,x.stride=p,x.offset=y,x.recache(),n.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",()=>{rH("OESVertexArrayObject emulation library context restored"),e.reset_()},!0),this.reset_()};Qh.prototype.VERTEX_ARRAY_BINDING_OES=34229,Qh.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let n=0;n<this.vertexArrayObjects.length;++n)this.vertexArrayObjects.isAlive=!1;const e=this.gl;this.maxVertexAttribs=e.getParameter(34921),this.defaultVertexArrayObject=new rg(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},Qh.prototype.createVertexArrayOES=function(){const t=new rg(this);return this.vertexArrayObjects.push(t),t},Qh.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},Qh.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof rg&&t.hasBeenBound&&t.ext===this)},Qh.prototype.bindVertexArrayOES=function(t){const e=this.gl;if(t&&!t.isAlive){nH(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const n=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&n.bindBuffer.call(e,34963,s.elementArrayBuffer);let a=this.currentArrayBuffer;const o=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let d=0;d<=o;d++){const p=s.attribs[d],y=i?i.attribs[d]:null;if((!i||p.enabled!==y.enabled)&&(p.enabled?n.enableVertexAttribArray.call(e,d):n.disableVertexAttribArray.call(e,d)),p.enabled){let b=!1;(!i||p.buffer!==y.buffer)&&(a!==p.buffer&&(n.bindBuffer.call(e,34962,p.buffer),a=p.buffer),b=!0),(b||p.cached!==y.cached)&&n.vertexAttribPointer.call(e,d,p.size,p.type,p.normalized,p.stride,p.offset)}}this.currentArrayBuffer!==a&&n.bindBuffer.call(e,34962,this.currentArrayBuffer)};function sH(r){if(typeof r.createVertexArray=="function")return;const t=r.getSupportedExtensions;r.getSupportedExtensions=function(){const i=t.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const e=r.getExtension;r.getExtension=function(i){const s=e.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(r.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Qh(this)),this.__OESVertexArrayObject))}}const ST="OES_element_index",TT="WEBGL_draw_buffers",oH="EXT_disjoint_timer_query",aH="EXT_disjoint_timer_query_webgl2",lH="EXT_texture_filter_anisotropic",IT="WEBGL_debug_renderer_info",cH=35723,uH=4352,AH=36795,hH=34047,dH=37445,fH=37446,gi=r=>fn(r)?void 0:0,pH={3074:r=>fn(r)?void 0:36064,[cH]:r=>fn(r)?void 0:uH,35977:gi,32937:gi,[AH]:(r,t)=>{const e=fn(r)?r.getExtension(aH):r.getExtension(oH);return e&&e.GPU_DISJOINT_EXT?t(e.GPU_DISJOINT_EXT):0},[dH]:(r,t)=>{const e=r.getExtension(IT);return t(e&&e.UNMASKED_VENDOR_WEBGL||7936)},[fH]:(r,t)=>{const e=r.getExtension(IT);return t(e&&e.UNMASKED_RENDERER_WEBGL||7937)},[hH]:(r,t)=>{const e=r.luma.extensions[lH];return e?t(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:gi,35071:gi,37447:gi,36063:(r,t)=>{if(!fn(r)){const e=r.getExtension(TT);return e?t(e.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:gi,35374:gi,35377:gi,34852:r=>{if(!fn(r)){const t=r.getExtension(TT);return t?t.MAX_DRAW_BUFFERS_WEBGL:0}},36203:r=>r.getExtension(ST)?2147483647:65535,33001:r=>r.getExtension(ST)?16777216:65535,33e3:r=>16777216,37157:gi,35373:gi,35657:gi,36183:gi,37137:gi,34045:gi,35978:gi,35979:gi,35968:gi,35376:gi,35375:gi,35659:gi,37154:gi,35371:gi,35658:gi,35076:gi,35077:gi,35380:gi};function gH(r,t,e){const n=pH[e],i=typeof n=="function"?n(r,t,e):n;return i!==void 0?i:t(e)}const mH="OES_vertex_array_object",FT="ANGLE_instanced_arrays",yH="WEBGL_draw_buffers",_H="EXT_disjoint_timer_query",vH="EXT_texture_filter_anisotropic",bH="VertexArray requires WebGL2 or OES_vertex_array_object extension";function wH(r,t){return{webgl2:fn(r),ext:r.getExtension(t)}}const LT={[mH]:{meta:{suffix:"OES"},createVertexArray:()=>{Lo(!1,bH)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[FT]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(r,t){Lo(t===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[yH]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Lo(!1)}},[_H]:{meta:{suffix:"EXT"},createQuery:()=>{Lo(!1)},deleteQuery:()=>{Lo(!1)},beginQuery:()=>{Lo(!1)},endQuery:()=>{},getQuery(r,t){return this.getQueryObject(r,t)},getQueryParameter(r,t){return this.getQueryObject(r,t)},getQueryObject:()=>{}}},tb={readBuffer:(r,t,e)=>{fn(r)&&t(e)},getVertexAttrib:(r,t,e,n)=>{const{webgl2:i,ext:s}=wH(r,FT);let a;switch(n){case 35069:a=i?void 0:!1;break;case 35070:a=!i&&!s?0:void 0;break}return a!==void 0?a:t(e,n)},getProgramParameter:(r,t,e,n)=>{if(!fn(r))switch(n){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return t(e,n)},getInternalformatParameter:(r,t,e,n,i)=>{if(!fn(r))switch(i){case 32937:return new Int32Array([0])}return r.getInternalformatParameter(e,n,i)},getTexParameter(r,t,e,n){switch(n){case 34046:const{extensions:i}=r.luma,s=i[vH];n=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return t(e,n)},getParameter:gH,hint(r,t,e,n){return t(e,n)}};function xH(r){r.luma=r.luma||{};const{luma:t}=r;return t.polyfilled||(sH(r),BH(r),EH(r,LT),CH(r,{target:t,target2:r}),t.polyfilled=!0),r}globalThis.polyfillContext=xH;function BH(r){r.luma.extensions={};const t=r.getSupportedExtensions()||[];for(const e of t)r.luma[e]=r.getExtension(e)}function CH(r,t){let{target:e,target2:n}=t;Object.keys(tb).forEach(i=>{if(typeof tb[i]=="function"){const s=r[i]?r[i].bind(r):()=>{},a=tb[i].bind(null,r,s);e[i]=a,n[i]=a}})}function EH(r,t){for(const e of Object.getOwnPropertyNames(t))e!=="overrides"&&SH(r,{extension:e,target:r.luma,target2:r})}function SH(r,t){let{extension:e,target:n,target2:i}=t;const s=LT[e];Lo(s);const{meta:a={}}=s,{suffix:o=""}=a,d=r.getExtension(e);for(const p of Object.keys(s)){const y="".concat(p).concat(o);let b=null;p==="meta"||typeof r[p]=="function"||(d&&typeof d[y]=="function"?b=function(){return d[y](...arguments)}:typeof s[p]=="function"&&(b=s[p].bind(n))),b&&(n[p]=b,i[p]=b)}}const eb={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},PA=(r,t,e)=>t?r.enable(e):r.disable(e),PT=(r,t,e)=>r.hint(e,t),Ba=(r,t,e)=>r.pixelStorei(e,t),TH=(r,t)=>{const e=fn(r)?36009:36160;return r.bindFramebuffer(e,t)},IH=(r,t)=>r.bindFramebuffer(36008,t);function ng(r){return Array.isArray(r)||ArrayBuffer.isView(r)}const FH={3042:PA,32773:(r,t)=>r.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(r,t)=>r.clearColor(...t),3107:(r,t)=>r.colorMask(...t),2884:PA,2885:(r,t)=>r.cullFace(t),2929:PA,2931:(r,t)=>r.clearDepth(t),2932:(r,t)=>r.depthFunc(t),2928:(r,t)=>r.depthRange(...t),2930:(r,t)=>r.depthMask(t),3024:PA,35723:PT,36006:TH,2886:(r,t)=>r.frontFace(t),33170:PT,2849:(r,t)=>r.lineWidth(t),32823:PA,32824:"polygonOffset",10752:"polygonOffset",35977:PA,32938:"sampleCoverage",32939:"sampleCoverage",3089:PA,3088:(r,t)=>r.scissor(...t),2960:PA,2961:(r,t)=>r.clearStencil(t),2968:(r,t)=>r.stencilMaskSeparate(1028,t),36005:(r,t)=>r.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(r,t)=>r.viewport(...t),3333:Ba,3317:Ba,37440:Ba,37441:Ba,37443:Ba,3330:Ba,3332:Ba,3331:Ba,36010:IH,3314:Ba,32878:Ba,3316:Ba,3315:Ba,32877:Ba,framebuffer:(r,t)=>{const e=t&&"handle"in t?t.handle:t;return r.bindFramebuffer(36160,e)},blend:(r,t)=>t?r.enable(3042):r.disable(3042),blendColor:(r,t)=>r.blendColor(...t),blendEquation:(r,t)=>{t=ng(t)?t:[t,t],r.blendEquationSeparate(...t)},blendFunc:(r,t)=>{t=ng(t)&&t.length===2?[...t,...t]:t,r.blendFuncSeparate(...t)},clearColor:(r,t)=>r.clearColor(...t),clearDepth:(r,t)=>r.clearDepth(t),clearStencil:(r,t)=>r.clearStencil(t),colorMask:(r,t)=>r.colorMask(...t),cull:(r,t)=>t?r.enable(2884):r.disable(2884),cullFace:(r,t)=>r.cullFace(t),depthTest:(r,t)=>t?r.enable(2929):r.disable(2929),depthFunc:(r,t)=>r.depthFunc(t),depthMask:(r,t)=>r.depthMask(t),depthRange:(r,t)=>r.depthRange(...t),dither:(r,t)=>t?r.enable(3024):r.disable(3024),derivativeHint:(r,t)=>{r.hint(35723,t)},frontFace:(r,t)=>r.frontFace(t),mipmapHint:(r,t)=>r.hint(33170,t),lineWidth:(r,t)=>r.lineWidth(t),polygonOffsetFill:(r,t)=>t?r.enable(32823):r.disable(32823),polygonOffset:(r,t)=>r.polygonOffset(...t),sampleCoverage:(r,t)=>r.sampleCoverage(...t),scissorTest:(r,t)=>t?r.enable(3089):r.disable(3089),scissor:(r,t)=>r.scissor(...t),stencilTest:(r,t)=>t?r.enable(2960):r.disable(2960),stencilMask:(r,t)=>{t=ng(t)?t:[t,t];const[e,n]=t;r.stencilMaskSeparate(1028,e),r.stencilMaskSeparate(1029,n)},stencilFunc:(r,t)=>{t=ng(t)&&t.length===3?[...t,...t]:t;const[e,n,i,s,a,o]=t;r.stencilFuncSeparate(1028,e,n,i),r.stencilFuncSeparate(1029,s,a,o)},stencilOp:(r,t)=>{t=ng(t)&&t.length===3?[...t,...t]:t;const[e,n,i,s,a,o]=t;r.stencilOpSeparate(1028,e,n,i),r.stencilOpSeparate(1029,s,a,o)},viewport:(r,t)=>r.viewport(...t)};function Oi(r,t,e){return t[r]!==void 0?t[r]:e[r]}const LH={blendEquation:(r,t,e)=>r.blendEquationSeparate(Oi(32777,t,e),Oi(34877,t,e)),blendFunc:(r,t,e)=>r.blendFuncSeparate(Oi(32969,t,e),Oi(32968,t,e),Oi(32971,t,e),Oi(32970,t,e)),polygonOffset:(r,t,e)=>r.polygonOffset(Oi(32824,t,e),Oi(10752,t,e)),sampleCoverage:(r,t,e)=>r.sampleCoverage(Oi(32938,t,e),Oi(32939,t,e)),stencilFuncFront:(r,t,e)=>r.stencilFuncSeparate(1028,Oi(2962,t,e),Oi(2967,t,e),Oi(2963,t,e)),stencilFuncBack:(r,t,e)=>r.stencilFuncSeparate(1029,Oi(34816,t,e),Oi(36003,t,e),Oi(36004,t,e)),stencilOpFront:(r,t,e)=>r.stencilOpSeparate(1028,Oi(2964,t,e),Oi(2965,t,e),Oi(2966,t,e)),stencilOpBack:(r,t,e)=>r.stencilOpSeparate(1029,Oi(34817,t,e),Oi(34818,t,e),Oi(34819,t,e))},MT={enable:(r,t)=>r({[t]:!0}),disable:(r,t)=>r({[t]:!1}),pixelStorei:(r,t,e)=>r({[t]:e}),hint:(r,t,e)=>r({[t]:e}),bindFramebuffer:(r,t,e)=>{switch(t){case 36160:return r({36006:e,36010:e});case 36009:return r({36006:e});case 36008:return r({36010:e});default:return null}},blendColor:(r,t,e,n,i)=>r({32773:new Float32Array([t,e,n,i])}),blendEquation:(r,t)=>r({32777:t,34877:t}),blendEquationSeparate:(r,t,e)=>r({32777:t,34877:e}),blendFunc:(r,t,e)=>r({32969:t,32968:e,32971:t,32970:e}),blendFuncSeparate:(r,t,e,n,i)=>r({32969:t,32968:e,32971:n,32970:i}),clearColor:(r,t,e,n,i)=>r({3106:new Float32Array([t,e,n,i])}),clearDepth:(r,t)=>r({2931:t}),clearStencil:(r,t)=>r({2961:t}),colorMask:(r,t,e,n,i)=>r({3107:[t,e,n,i]}),cullFace:(r,t)=>r({2885:t}),depthFunc:(r,t)=>r({2932:t}),depthRange:(r,t,e)=>r({2928:new Float32Array([t,e])}),depthMask:(r,t)=>r({2930:t}),frontFace:(r,t)=>r({2886:t}),lineWidth:(r,t)=>r({2849:t}),polygonOffset:(r,t,e)=>r({32824:t,10752:e}),sampleCoverage:(r,t,e)=>r({32938:t,32939:e}),scissor:(r,t,e,n,i)=>r({3088:new Int32Array([t,e,n,i])}),stencilMask:(r,t)=>r({2968:t,36005:t}),stencilMaskSeparate:(r,t,e)=>r({[t===1028?2968:36005]:e}),stencilFunc:(r,t,e,n)=>r({2962:t,2967:e,2963:n,34816:t,36003:e,36004:n}),stencilFuncSeparate:(r,t,e,n,i)=>r({[t===1028?2962:34816]:e,[t===1028?2967:36003]:n,[t===1028?2963:36004]:i}),stencilOp:(r,t,e,n)=>r({2964:t,2965:e,2966:n,34817:t,34818:e,34819:n}),stencilOpSeparate:(r,t,e,n,i)=>r({[t===1028?2964:34817]:e,[t===1028?2965:34818]:n,[t===1028?2966:34819]:i}),viewport:(r,t,e,n,i)=>r({2978:[t,e,n,i]})},Qc=(r,t)=>r.isEnabled(t),UT={3042:Qc,2884:Qc,2929:Qc,3024:Qc,32823:Qc,32926:Qc,32928:Qc,3089:Qc,2960:Qc,35977:Qc};function RT(r){for(const t in r)return!1;return!0}function PH(r,t){if(r===t)return!0;const e=Array.isArray(r)||ArrayBuffer.isView(r),n=Array.isArray(t)||ArrayBuffer.isView(t);if(e&&n&&r.length===t.length){for(let i=0;i<r.length;++i)if(r[i]!==t[i])return!1;return!0}return!1}function OT(r,t){const e=r[t].bind(r);r[t]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in r.state.cache?r.state.enable?r.state.cache[i]:e(...arguments):e(...arguments)},Object.defineProperty(r[t],"name",{value:"".concat(t,"-from-cache"),configurable:!1})}function MH(r,t,e){const n=r[t].bind(r);r[t]=function(){for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];const{valueChanged:d,oldValue:p}=e(r.state._updateCache,...a);return d&&n(...a),p},Object.defineProperty(r[t],"name",{value:"".concat(t,"-to-cache"),configurable:!1})}function UH(r){const t=r.useProgram.bind(r);r.useProgram=function(n){r.state.program!==n&&(t(n),r.state.program=n)}}class RH{constructor(t){let{copyState:e=!1,log:n=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=t,this.program=null,this.stateStack=[],this.enable=!0,this.cache=e?DH(t):Object.assign({},eb),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Lo(this.stateStack.length>0);const t=this.stateStack[this.stateStack.length-1];Mu(this.gl,t),this.stateStack.pop()}_updateCache(t){let e=!1,n;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in t){Lo(s!==void 0);const a=t[s],o=this.cache[s];PH(a,o)||(e=!0,n=o,i&&!(s in i)&&(i[s]=o),this.cache[s]=a)}return{valueChanged:e,oldValue:n}}}function DT(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:e=!0,copyState:n}=t;if(Lo(n!==void 0),!r.state){const{polyfillContext:i}=globalThis;i&&i(r),r.state=new RH(r,{copyState:n}),UH(r);for(const s in MT){const a=MT[s];MH(r,s,a)}OT(r,"getParameter"),OT(r,"isEnabled")}return r.state.enable=e,r}function OH(r){r.state||DT(r,{copyState:!1}),r.state.push()}function NT(r){Lo(r.state),r.state.pop()}function Mu(r,t){if(Lo(I0(r),"setParameters requires a WebGL context"),RT(t))return;const e={};for(const i in t){const s=Number(i),a=FH[i];a&&(typeof a=="string"?e[a]=!0:a(r,t[i],s))}const n=r.state&&r.state.cache;if(n)for(const i in e){const s=LH[i];s(r,t,n)}}function DH(r,t){if(t=t||eb,typeof t=="number"){const i=t,s=UT[i];return s?s(r,i):r.getParameter(i)}const e=Array.isArray(t)?t:Object.keys(t),n={};for(const i of e){const s=UT[i];n[i]=s?s(r,Number(i)):r.getParameter(Number(i))}return n}function NH(r){Mu(r,eb)}function $l(r,t,e){if(RT(t))return e(r);const{nocatch:n=!0}=t;OH(r),Mu(r,t);let i;if(n)i=e(r),NT(r);else try{i=e(r)}finally{NT(r)}return i}function Zd(r){const{luma:t}=r;if(r.canvas&&t){const e=t.canvasSizeInfo,n="clientWidth"in e?e.clientWidth:r.canvas.clientWidth;return n?r.drawingBufferWidth/n:1}return 1}function rb(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=Zd(r),i=r.drawingBufferWidth,s=r.drawingBufferHeight;return QH(t,n,i,s,e)}function kH(r){const t=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(r)?r<=0?1:r:r?t:1}function QH(r,t,e,n,i){const s=kT(r[0],t,e);let a=QT(r[1],t,n,i),o=kT(r[0]+1,t,e);const d=o===e-1?o:o-1;o=QT(r[1]+1,t,n,i);let p;return i?(o=o===0?o:o+1,p=a,a=o):p=o===n-1?o:o-1,{x:s,y:a,width:Math.max(d-s+1,1),height:Math.max(p-a+1,1)}}function kT(r,t,e){return Math.min(Math.round(r*t),e-1)}function QT(r,t,e,n){return n?Math.max(0,e-1-Math.round(r*t)):Math.min(Math.round(r*t),e-1)}const nb=Pu(),zH=nb&&typeof document<"u",zT={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function HT(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Lo(nb,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),r=Object.assign({},zT,r);const{width:t,height:e}=r;function n(o){if(r.throwOnError)throw new Error(o);return console.error(o),null}r.onError=n;let i;const{canvas:s}=r,a=jH({canvas:s,width:t,height:e,onError:n});return i=GH(a,r),i?(i=ib(i,r),qH(i),i):null}function ib(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!r||r._instrumented)return r;r._version=r._version||KH(r),r.luma=r.luma||{},r.luma.canvasSizeInfo=r.luma.canvasSizeInfo||{},t=Object.assign({},zT,t);const{manageState:e,debug:n}=t;return e&&DT(r,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return vr.log(1,...s)()}}),nb&&n&&(globalThis.makeDebugContext?(r=globalThis.makeDebugContext(r,t),vr.level=Math.max(vr.level,1)):vr.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),r._instrumented=!0,r}function HH(r){const t=r.getParameter(7936),e=r.getParameter(7937),n=r.getExtension("WEBGL_debug_renderer_info"),i=n&&r.getParameter(n.UNMASKED_VENDOR_WEBGL||7936),s=n&&r.getParameter(n.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||t,renderer:s||e,vendorMasked:t,rendererMasked:e,version:r.getParameter(7938),shadingLanguageVersion:r.getParameter(35724)}}function VH(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r.canvas){const n=kH(t.useDevicePixels);$H(r,n,t);return}const e=r.getExtension("STACKGL_resize_drawingbuffer");e&&"width"in t&&"height"in t&&e.resize(t.width,t.height)}function GH(r,t){const{onError:e}=t;let n=null;const i=d=>n=d.statusMessage||n;r.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:a=!0}=t;let o=null;return a&&(o=o||r.getContext("webgl2",t),o=o||r.getContext("experimental-webgl2",t)),s&&(o=o||r.getContext("webgl",t),o=o||r.getContext("experimental-webgl",t)),r.removeEventListener("webglcontextcreationerror",i,!1),o?(t.onContextLost&&r.addEventListener("webglcontextlost",t.onContextLost,!1),t.onContextRestored&&r.addEventListener("webglcontextrestored",t.onContextRestored,!1),o):e("Failed to create ".concat(a&&!s?"WebGL2":"WebGL"," context: ").concat(n||"Unknown error"))}function jH(r){let{canvas:t,width:e=800,height:n=600,onError:i}=r,s;return typeof t=="string"?(zH&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(t,"' before page was loaded")),s=document.getElementById(t)):t?s=t:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(e)?"".concat(e,"px"):"100%",s.style.height=Number.isFinite(n)?"".concat(n,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function qH(r){const t=fn(r)?"WebGL2":"WebGL1",e=HH(r),n=e?"(".concat(e.vendor,",").concat(e.renderer,")"):"",i=r.debug?" debug":"";vr.info(1,"".concat(t).concat(i," context ").concat(n))()}function KH(r){return typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?2:1}function $H(r,t,e){let n="width"in e?e.width:r.canvas.clientWidth,i="height"in e?e.height:r.canvas.clientHeight;(!n||!i)&&(vr.log(1,"Canvas clientWidth/clientHeight is 0")(),t=1,n=r.canvas.width||1,i=r.canvas.height||1),r.luma=r.luma||{},r.luma.canvasSizeInfo=r.luma.canvasSizeInfo||{};const s=r.luma.canvasSizeInfo;if(s.clientWidth!==n||s.clientHeight!==i||s.devicePixelRatio!==t){let a=t;const o=Math.floor(n*a),d=Math.floor(i*a);r.canvas.width=o,r.canvas.height=d,(r.drawingBufferWidth!==o||r.drawingBufferHeight!==d)&&(vr.warn("Device pixel ratio clamped")(),a=Math.min(r.drawingBufferWidth/n,r.drawingBufferHeight/i),r.canvas.width=Math.floor(n*a),r.canvas.height=Math.floor(i*a)),Object.assign(r.luma.canvasSizeInfo,{clientWidth:n,clientHeight:i,devicePixelRatio:t})}}const ig="8.5.21",WH="set luma.log.level=1 (or higher) to trace rendering";class XH{constructor(){this.stats=new Map}get(t){return this.stats.has(t)||this.stats.set(t,new Kp({id:t})),this.stats.get(t)}}const zh=new XH;if(globalThis.luma&&globalThis.luma.VERSION!==ig)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(ig));globalThis.luma||(Pu()&&vr.log(1,"luma.gl ".concat(ig," - ").concat(WH))(),globalThis.luma=globalThis.luma||{VERSION:ig,version:ig,log:vr,stats:zh,globals:{modules:{},nodeIO:{}}});function JH(r){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(r):setTimeout(r,1e3/60)}function YH(r){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(r):clearTimeout(r)}function ir(r,t){if(!r)throw new Error(t||"luma.gl: assertion failed.")}function sb(r,t){if(typeof t!="string")return t;const e=Number(t);if(!isNaN(e))return e;t=t.replace(/^.*\./,"");const n=r[t];return ir(n!==void 0,"Accessing undefined constant GL.".concat(t)),n}function MA(r,t){t=Number(t);for(const e in r)if(r[e]===t)return"GL.".concat(e);return String(t)}const ob={};function Uu(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";ob[r]=ob[r]||1;const t=ob[r]++;return"".concat(r,"-").concat(t)}function VT(r){return ir(typeof r=="number","Input must be a number"),r&&(r&r-1)===0}function tf(r){let t=!0;for(const e in r){t=!1;break}return t}function GT(r,t,e,n){const i="See luma.gl ".concat(e," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(r);n.forEach(a=>{s.methodName||(s[a]=()=>{throw vr.removed("Calling removed method ".concat(t,".").concat(a,": "),i)(),new Error(a)})})}const ef="Resource subclass must define virtual methods";let Ru=class{get[Symbol.toStringTag](){return"Resource"}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};F0(t);const{id:n,userData:i={}}=e;this.gl=t,this.gl2=t,this.id=n||Uu(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=e.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:t=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,e&&t&&e.filter(Boolean).forEach(n=>n.delete()),this}bind(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof t!="function")return this._bindHandle(t),this;let e;return this._bound?e=t():(this._bindHandle(this.handle),this._bound=!0,e=t(),this._bound=!1,this._bindHandle(null)),e}unbind(){this.bind(null)}getParameter(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t=sb(this.gl,t),ir(t);const i=(this.constructor.PARAMETERS||{})[t];if(i){const s=fn(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const o=i.webgl1,d="webgl2"in i?i.webgl2:i.webgl1;return s?d:o}}return this._getParameter(t,e)}getParameters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:e,keys:n}=t,i=this.constructor.PARAMETERS||{},s=fn(this.gl),a={},o=e||Object.keys(i);for(const d of o){const p=i[d];if(p&&(!("webgl2"in p)||s)&&(!("extension"in p)||this.gl.getExtension(p.extension))){const b=n?MA(this.gl,d):d;a[b]=this.getParameter(d,t),n&&p.type==="GLenum"&&(a[b]=MA(this.gl,a[b]))}}return a}setParameter(t,e){t=sb(this.gl,t),ir(t);const i=(this.constructor.PARAMETERS||{})[t];if(i){const s=fn(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(e=sb(e))}return this._setParameter(t,e),this}setParameters(t){for(const e in t)this.setParameter(e,t[e]);return this}stubRemovedMethods(t,e,n){return GT(this,t,e,n)}initialize(t){}_createHandle(){throw new Error(ef)}_deleteHandle(){throw new Error(ef)}_bindHandle(t){throw new Error(ef)}_getOptsFromHandle(){throw new Error(ef)}_getParameter(t,e){throw new Error(ef)}_setParameter(t,e){throw new Error(ef)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const t=this[Symbol.toStringTag],e=zh.get("Resource Counts");e.get("Resources Created").incrementCount(),e.get("".concat(t,"s Created")).incrementCount(),e.get("".concat(t,"s Active")).incrementCount()}_removeStats(){const t=this[Symbol.toStringTag];zh.get("Resource Counts").get("".concat(t,"s Active")).decrementCount()}_trackAllocatedMemory(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(t,e),this._trackAllocatedMemoryForContext(t,e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=t}_trackAllocatedMemoryForContext(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=zh.get("Memory Usage".concat(n));i.get("GPU Memory").addCount(t),i.get("".concat(e," Memory")).addCount(t)}_trackDeallocatedMemory(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(t),this._trackDeallocatedMemoryForContext(t,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=zh.get("Memory Usage".concat(e));n.get("GPU Memory").subtractCount(this.byteLength),n.get("".concat(t," Memory")).subtractCount(this.byteLength)}};const ZH="Failed to deduce GL constant from typed array";function ab(r){switch(ArrayBuffer.isView(r)?r.constructor:r){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(ZH)}}function sg(r){let{clamped:t=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(r){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return t?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function t7(r){let{data:t,width:e,height:n,bytesPerPixel:i=4,temp:s}=r;const a=e*i;s=s||new Uint8Array(a);for(let o=0;o<n/2;++o){const d=o*a,p=(n-o-1)*a;s.set(t.subarray(d,d+a)),t.copyWithin(d,p,p+a),t.set(s,p)}}function e7(r){let{data:t,width:e,height:n}=r;const i=Math.round(e/2),s=Math.round(n/2),a=new Uint8Array(i*s*4);for(let o=0;o<s;o++)for(let d=0;d<i;d++)for(let p=0;p<4;p++)a[(o*i+d)*4+p]=t[(o*2*e+d*2)*4+p];return{data:a,width:i,height:s}}function lb(r,t,e){const{removedProps:n={},deprecatedProps:i={},replacedProps:s={}}=e;for(const o in n)if(o in t){const p=n[o]?"".concat(r,".").concat(n[o]):"N/A";vr.removed("".concat(r,".").concat(o),p)()}for(const o in i)if(o in t){const d=i[o];vr.deprecated("".concat(r,".").concat(o),"".concat(r,".").concat(d))()}let a=null;for(const o in s)if(o in t){const d=s[o];vr.deprecated("".concat(r,".").concat(o),"".concat(r,".").concat(d))(),a=a||Object.assign({},t),a[d]=t[o],delete a[o]}return a||t}const r7={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},n7={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class ra{static getBytesPerElement(t){return sg(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){return ir(t.size),sg(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new ra(r7,...e)}constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return ra.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return ra.getBytesPerVertex(this)}_assign(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t=lb("Accessor",t,n7),t.type!==void 0&&(this.type=t.type,(t.type===5124||t.type===5125)&&(this.integer=!0)),t.size!==void 0&&(this.size=t.size),t.offset!==void 0&&(this.offset=t.offset),t.stride!==void 0&&(this.stride=t.stride),t.normalized!==void 0&&(this.normalized=t.normalized),t.integer!==void 0&&(this.integer=t.integer),t.divisor!==void 0&&(this.divisor=t.divisor),t.buffer!==void 0&&(this.buffer=t.buffer),t.index!==void 0&&(typeof t.index=="boolean"?this.index=t.index?1:0:this.index=t.index),t.instanced!==void 0&&(this.divisor=t.instanced?1:0),t.isInstanced!==void 0&&(this.divisor=t.isInstanced?1:0),this}}const jT=10,qT={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},i7={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:qT},s7={removedProps:qT};let ni=class extends Ru{get[Symbol.toStringTag](){return"Buffer"}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t,e),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=e.target||(this.gl.webgl2?36662:34962),this.initialize(e),Object.seal(this)}getElementCount(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/ra.getBytesPerElement(t))}getVertexCount(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/ra.getBytesPerVertex(t))}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t=lb("Buffer",t,i7),this.usage=t.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},t,t.accessor)),t.data?this._setData(t.data,t.offset,t.byteLength):this._setByteLength(t.byteLength||0),this}setProps(t){return t=lb("Buffer",t,s7),"accessor"in t&&this.setAccessor(t.accessor),this}setAccessor(t){return t=Object.assign({},t),delete t.buffer,this.accessor=new ra(t),this}reallocate(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}setData(t){return this.initialize(t)}subData(t){ArrayBuffer.isView(t)&&(t={data:t});const{data:e,offset:n=0,srcOffset:i=0}=t,s=t.byteLength||t.length;ir(e);const a=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(a,this.handle),i!==0||s!==void 0?(Po(this.gl),this.gl.bufferSubData(this.target,n,e,i,s)):this.gl.bufferSubData(a,n,e),this.gl.bindBuffer(a,null),this.debugData=null,this._inferType(e),this}copyData(t){let{sourceBuffer:e,readOffset:n=0,writeOffset:i=0,size:s}=t;const{gl:a}=this;return Po(a),a.bindBuffer(36662,e.handle),a.bindBuffer(36663,this.handle),a.copyBufferSubData(36662,36663,n,i,s),a.bindBuffer(36662,null),a.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:t=null,srcByteOffset:e=0,dstOffset:n=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Po(this.gl);const s=sg(this.accessor.type||5126,{clamped:!1}),a=this._getAvailableElementCount(e),o=n;let d,p;t?(p=t.length,d=p-o):(d=Math.min(a,i||a),p=o+d);const y=Math.min(a,d);return i=i||y,ir(i<=y),t=t||new s(p),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,t,n,i),this.gl.bindBuffer(36662,null),t}bind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index,offset:n=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t===35345||t===35982?i!==void 0?this.gl.bindBufferRange(t,e,this.handle,n,i):(ir(n===0),this.gl.bindBufferBase(t,e,this.handle)):this.gl.bindBuffer(t,this.handle),this}unbind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t===35345||t===35982?this.gl.bindBufferBase(t,e,null):this.gl.bindBuffer(t,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(jT,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.byteLength+e;ir(ArrayBuffer.isView(t)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.usage),this.gl.bufferSubData(i,e,t),this.gl.bindBuffer(i,null),this.debugData=t.slice(0,jT),this.bytesUsed=n,this._trackAllocatedMemory(n);const s=ab(t);return ir(s),this.setAccessor(new ra(this.accessor,{type:s})),this}_setByteLength(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;ir(t>=0),this._trackDeallocatedMemory();let n=t;t===0&&(n=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,e),this.gl.bindBuffer(i,null),this.usage=e,this.debugData=null,this.bytesUsed=t,this._trackAllocatedMemory(t),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(t){const e=sg(this.accessor.type||5126,{clamped:!1}),n=t/e.BYTES_PER_ELEMENT;return this.getElementCount()-n}_inferType(t){this.accessor.type||this.setAccessor(new ra(this.accessor,{type:ab(t)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(t){this.gl.bindBuffer(this.target,this.handle);const e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}get type(){return vr.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return vr.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(t){return vr.deprecated("setByteLength","reallocate")(),this.reallocate(t)}updateAccessor(t){return vr.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new ra(this.accessor,t),this}};const cb={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},KT={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},$T={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function o7(r,t){const e=cb[t];if(!e)return!1;if(e.gl1===void 0&&e.gl2===void 0)return!0;const n=fn(r)&&e.gl2||e.gl1;return typeof n=="string"?r.getExtension(n):n}function a7(r,t){const e=cb[t];switch(e&&e.types[0]){case 5126:return r.getExtension("OES_texture_float_linear");case 5131:return r.getExtension("OES_texture_half_float_linear");default:return!0}}const l7=[9729,9728],WT=globalThis.WebGLBuffer||function(){};class rf extends Ru{get[Symbol.toStringTag](){return"Texture"}static isSupported(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:n,linearFiltering:i}=e;let s=!0;return n&&(s=s&&o7(t,n),s=s&&(!i||a7(t,n))),s}constructor(t,e){const{id:n=Uu("texture"),handle:i,target:s}=e;super(t,{id:n,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.data;if(e instanceof Promise)return e.then(V=>this.initialize(Object.assign({},t,{pixels:V,data:V}))),this;const n=typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement;if(n&&e.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,e.addEventListener("loadeddata",()=>this.initialize(t)),this;const{pixels:i=null,format:s=6408,border:a=0,recreate:o=!1,parameters:d={},pixelStore:p={},textureUnit:y=void 0}=t;e||(e=i);let{width:b,height:x,dataFormat:C,type:P,compressed:M=!1,mipmaps:k=!0}=t;const{depth:z=0}=t;return{width:b,height:x,compressed:M,dataFormat:C,type:P}=this._deduceParameters({format:s,type:P,dataFormat:C,compressed:M,data:e,width:b,height:x}),this.width=b,this.height=x,this.depth=z,this.format=s,this.type=P,this.dataFormat=C,this.border=a,this.textureUnit=y,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),k&&this._isNPOT()&&(vr.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),k=!1,this._updateForNPOT(d)),this.mipmaps=k,this.setImageData({data:e,width:b,height:x,depth:z,format:s,type:P,dataFormat:C,border:a,mipmaps:k,parameters:p,compressed:M}),k&&this.generateMipmap(),this.setParameters(d),o&&(this.data=e),n&&(this._video={video:e,parameters:d,lastTime:e.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?e.currentTime:-1}),this}update(){if(this._video){const{video:t,parameters:e,lastTime:n}=this._video;if(n===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}resize(t){let{height:e,width:n,mipmaps:i=!1}=t;return n!==this.width||e!==this.height?this.initialize({width:n,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(vr.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),$l(this.gl,t,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(t){this._trackDeallocatedMemory("Texture");const{target:e=this.target,pixels:n=null,level:i=0,format:s=this.format,border:a=this.border,offset:o=0,parameters:d={}}=t;let{data:p=null,type:y=this.type,width:b=this.width,height:x=this.height,dataFormat:C=this.dataFormat,compressed:P=!1}=t;p||(p=n),{type:y,dataFormat:C,compressed:P,width:b,height:x}=this._deduceParameters({format:s,type:y,dataFormat:C,compressed:P,data:p,width:b,height:x});const{gl:M}=this;M.bindTexture(this.target,this.handle);let k=null;({data:p,dataType:k}=this._getDataType({data:p,compressed:P}));let z,V=0;if($l(this.gl,d,()=>{switch(k){case"null":M.texImage2D(e,i,s,b,x,a,C,y,p);break;case"typed-array":M.texImage2D(e,i,s,b,x,a,C,y,p,o);break;case"buffer":z=Po(M),z.bindBuffer(35052,p.handle||p),z.texImage2D(e,i,s,b,x,a,C,y,o),z.bindBuffer(35052,null);break;case"browser-object":fn(M)?M.texImage2D(e,i,s,b,x,a,C,y,p):M.texImage2D(e,i,s,C,y,p);break;case"compressed":for(const[$,tt]of p.entries())M.compressedTexImage2D(e,$,tt.format,tt.width,tt.height,a,tt.data),V+=tt.levelSize;break;default:ir(!1,"Unknown image data type")}}),k==="compressed")this._trackAllocatedMemory(V,"Texture");else if(p&&p.byteLength)this._trackAllocatedMemory(p.byteLength,"Texture");else{const $=KT[this.dataFormat]||4,tt=$T[this.type]||1;this._trackAllocatedMemory(this.width*this.height*$*tt,"Texture")}return this.loaded=!0,this}setSubImageData(t){let{target:e=this.target,pixels:n=null,data:i=null,x:s=0,y:a=0,width:o=this.width,height:d=this.height,level:p=0,format:y=this.format,type:b=this.type,dataFormat:x=this.dataFormat,compressed:C=!1,offset:P=0,border:M=this.border,parameters:k={}}=t;if({type:b,dataFormat:x,compressed:C,width:o,height:d}=this._deduceParameters({format:y,type:b,dataFormat:x,compressed:C,data:i,width:o,height:d}),ir(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=n),i&&i.data){const z=i;i=z.data,o=z.shape[0],d=z.shape[1]}i instanceof ni&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),$l(this.gl,k,()=>{if(C)this.gl.compressedTexSubImage2D(e,p,s,a,o,d,y,i);else if(i===null)this.gl.texSubImage2D(e,p,s,a,o,d,x,b,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(e,p,s,a,o,d,x,b,i,P);else if(i instanceof WT){const z=Po(this.gl);z.bindBuffer(35052,i),z.texSubImage2D(e,p,s,a,o,d,x,b,P),z.bindBuffer(35052,null)}else fn(this.gl)?Po(this.gl).texSubImage2D(e,p,s,a,o,d,x,b,i):this.gl.texSubImage2D(e,p,s,a,x,b,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return vr.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:e}=this;return t!==void 0&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:e}=this;return t!==void 0&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType(t){let{data:e,compressed:n=!1}=t;return n?{data:e,dataType:"compressed"}:e===null?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof ni?{data:e.handle,dataType:"buffer"}:e instanceof WT?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:n}=t;let{width:i,height:s,dataFormat:a,type:o,compressed:d}=t;const p=cb[e];return a=a||p&&p.dataFormat,o=o||p&&p.types[0],d=d||p&&p.compressed,{width:i,height:s}=this._deduceImageSize(n,i,s),{dataFormat:a,type:o,compressed:d,width:i,height:s,format:e,data:n}}_deduceImageSize(t,e,n){let i;return typeof ImageData<"u"&&t instanceof ImageData?i={width:t.width,height:t.height}:typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement?i={width:t.naturalWidth,height:t.naturalHeight}:typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement?i={width:t.width,height:t.height}:typeof ImageBitmap<"u"&&t instanceof ImageBitmap?i={width:t.width,height:t.height}:typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?i={width:t.videoWidth,height:t.videoHeight}:t?i={width:e,height:n}:i={width:e>=0?e:1,height:n>=0?n:1},ir(i,"Could not deduced texture size"),ir(e===void 0||i.width===e,"Deduced texture width does not match supplied width"),ir(n===void 0||i.height===n,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}_setParameter(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:ir(!1);break;default:this.gl.texParameteri(this.target,t,e);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return fn(this.gl)||!this.width||!this.height?!1:!VT(this.width)||!VT(this.height)}_updateForNPOT(t){t[this.gl.TEXTURE_MIN_FILTER]===void 0&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),t[this.gl.TEXTURE_WRAP_S]===void 0&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),t[this.gl.TEXTURE_WRAP_T]===void 0&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(t,e){if(this._isNPOT())switch(t){case 10241:l7.indexOf(e)===-1&&(e=9729);break;case 10242:case 10243:e!==33071&&(e=33071);break}return e}}let c7="";function u7(r,t){return ir(typeof r=="string"),r=c7+r,new Promise((e,n)=>{try{const i=new Image;i.onload=()=>e(i),i.onerror=()=>n(new Error("Could not load image ".concat(r,"."))),i.crossOrigin=t&&t.crossOrigin||"anonymous",i.src=r}catch(i){n(i)}})}class Ca extends rf{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(t,e){return rf.isSupported(t,e)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};F0(t),(e instanceof Promise||typeof e=="string")&&(e={data:e}),typeof e.data=="string"&&(e=Object.assign({},e,{data:u7(e.data)})),super(t,Object.assign({},e,{target:3553})),this.initialize(e),Object.seal(this)}}const ub=[34069,34070,34071,34072,34073,34074];class XT extends rf{get[Symbol.toStringTag](){return"TextureCube"}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};F0(t),super(t,Object.assign({},e,{target:34067})),this.initialize(e),Object.seal(this)}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:e=!0,parameters:n={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,e&&this.generateMipmap(t),this.setParameters(n)}),this}subImage(t){let{face:e,data:n,x:i=0,y:s=0,mipmapLevel:a=0}=t;return this._subImage({target:e,data:n,x:i,y:s,mipmapLevel:a})}async setCubeMapImageData(t){let{width:e,height:n,pixels:i,data:s,border:a=0,format:o=6408,type:d=5121}=t;const{gl:p}=this,y=i||s,b=await Promise.all(ub.map(x=>{const C=y[x];return Promise.all(Array.isArray(C)?C:[C])}));this.bind(),ub.forEach((x,C)=>{b[C].length>1&&this.opts.mipmaps!==!1&&vr.warn("".concat(this.id," has mipmap and multiple LODs."))(),b[C].forEach((P,M)=>{e&&n?p.texImage2D(x,M,o,e,n,a,o,d,P):p.texImage2D(x,M,o,o,d,P)})}),this.unbind()}setImageDataForFace(t){const{face:e,width:n,height:i,pixels:s,data:a,border:o=0,format:d=6408,type:p=5121}=t,{gl:y}=this,b=s||a;return this.bind(),b instanceof Promise?b.then(x=>this.setImageDataForFace(Object.assign({},t,{face:e,data:x,pixels:x}))):this.width||this.height?y.texImage2D(e,0,d,n,i,o,d,p,b):y.texImage2D(e,0,d,d,p,b),this}}XT.FACES=ub;class A7 extends rf{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(t){return fn(t)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Po(t),e=Object.assign({depth:1},e,{target:32879,unpackFlipY:!1}),super(t,e),this.initialize(e),Object.seal(this)}setImageData(t){let{level:e=0,dataFormat:n=6408,width:i,height:s,depth:a=1,border:o=0,format:d,type:p=5121,offset:y=0,data:b,parameters:x={}}=t;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),$l(this.gl,x,()=>{ArrayBuffer.isView(b)&&this.gl.texImage3D(this.target,e,n,i,s,a,o,d,p,b),b instanceof ni&&(this.gl.bindBuffer(35052,b.handle),this.gl.texImage3D(this.target,e,n,i,s,a,o,d,p,y))}),b&&b.byteLength)this._trackAllocatedMemory(b.byteLength,"Texture");else{const C=KT[this.dataFormat]||4,P=$T[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*C*P,"Texture")}return this.loaded=!0,this}}const Hh="EXT_color_buffer_float",JT={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Hh,bpp:2},33327:{gl2:Hh,bpp:4},34842:{gl2:Hh,bpp:8},33326:{gl2:Hh,bpp:4},33328:{gl2:Hh,bpp:8},34836:{gl2:Hh,bpp:16},35898:{gl2:Hh,bpp:4}};function h7(r,t,e){const n=e[t];if(!n)return!1;const i=fn(r)&&n.gl2||n.gl1;return typeof i=="string"?r.getExtension(i):i}class nf extends Ru{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(t){let{format:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!e||h7(t,e,JT)}static getSamplesForFormat(t,e){let{format:n}=e;return t.getInternalformatParameter(36161,n,32937)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t,e),this.initialize(e),Object.seal(this)}initialize(t){let{format:e,width:n=1,height:i=1,samples:s=0}=t;return ir(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&fn(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,e,n,i):this.gl.renderbufferStorage(36161,e,n,i),this.format=e,this.width=n,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*JT[this.format].bpp),this}resize(t){let{width:e,height:n}=t;return e!==this.width||n!==this.height?this.initialize({width:e,height:n,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(t){this.gl.bindRenderbuffer(36161,t)}_syncHandle(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(t){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,t)}}const d7=256,f7=1024,p7=16384,YT=6144,ZT=6145,t5=6146,e5=34041,r5="clear: bad arguments";function Ab(r){let{framebuffer:t=null,color:e=null,depth:n=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};t&&(s.framebuffer=t);let a=0;e&&(a|=p7,e!==!0&&(s.clearColor=e)),n&&(a|=d7,n!==!0&&(s.clearDepth=n)),i&&(a|=f7,n!==!0&&(s.clearStencil=n)),ir(a!==0,r5),$l(r,s,()=>{r.clear(a)})}function g7(r){let{framebuffer:t=null,buffer:e=YT,drawBuffer:n=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Po(r),$l(r,{framebuffer:t},()=>{switch(e){case YT:switch(i.constructor){case Int32Array:r.clearBufferiv(e,n,i);break;case Uint32Array:r.clearBufferuiv(e,n,i);break;case Float32Array:default:r.clearBufferfv(e,n,i)}break;case ZT:r.clearBufferfv(ZT,0,[i]);break;case t5:r.clearBufferiv(t5,0,[i]);break;case e5:const[s,a]=i;r.clearBufferfi(e5,0,s,a);break;default:ir(!1,r5)}})}function m7(r){switch(r){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return ir(!1),0}}function L0(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:e=0,sourceY:n=0,sourceFormat:i=6408}=t;let{sourceAttachment:s=36064,target:a=null,sourceWidth:o,sourceHeight:d,sourceType:p}=t;const{framebuffer:y,deleteFramebuffer:b}=y7(r);ir(y);const{gl:x,handle:C,attachments:P}=y;o=o||y.width,d=d||y.height,s===36064&&C===null&&(s=1028),ir(P[s]),p=p||P[s].type,a=_7(a,p,i,o,d),p=p||ab(a);const M=x.bindFramebuffer(36160,C);return x.readPixels(e,n,o,d,i,p,a),x.bindFramebuffer(36160,M||null),b&&y.delete(),a}function n5(r){let{sourceAttachment:t=36064,targetMaxHeight:e=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=L0(r,{sourceAttachment:t}),{width:i,height:s}=r;for(;s>e;)({data:n,width:i,height:s}=e7({data:n,width:i,height:s}));t7({data:n,width:i,height:s});const a=document.createElement("canvas");a.width=i,a.height=s;const o=a.getContext("2d"),d=o.createImageData(i,s);return d.data.set(n),o.putImageData(d,0,0),a.toDataURL()}function y7(r){return r instanceof gs?{framebuffer:r,deleteFramebuffer:!1}:{framebuffer:T7(r),deleteFramebuffer:!0}}function _7(r,t,e,n,i){if(r)return r;t=t||5121;const s=sg(t,{clamped:!1}),a=m7(e);return new s(n*i*a)}const mi={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function v7(r){const t=new Ca(r,{format:6408,type:5126,dataFormat:6408}),e=new gs(r,{id:"test-framebuffer",check:!1,attachments:{36064:t}}),n=e.getStatus();return t.delete(),e.delete(),n===36053}const i5={[mi.WEBGL2]:[!1,!0],[mi.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[mi.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[mi.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[mi.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[mi.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[mi.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[mi.FLOAT_BLEND]:["EXT_float_blend"],[mi.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[mi.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[mi.TEXTURE_FLOAT]:["OES_texture_float",!0],[mi.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[mi.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[mi.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[mi.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[mi.COLOR_ATTACHMENT_RGBA32F]:[v7,"EXT_color_buffer_float"],[mi.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[mi.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[mi.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[mi.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[mi.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[mi.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},b7=2;function hb(r,t){return s5(r,t)}function s5(r,t){return t=Array.isArray(t)?t:[t],t.every(e=>o5(r,e))}function w7(r){r.luma=r.luma||{},r.luma.caps=r.luma.caps||{};for(const t in i5)r.luma.caps[t]===void 0&&(r.luma.caps[t]=o5(r,t));return r.luma.caps}function o5(r,t){return r.luma=r.luma||{},r.luma.caps=r.luma.caps||{},r.luma.caps[t]===void 0&&(r.luma.caps[t]=x7(r,t)),r.luma.caps[t]||vr.log(b7,"Feature: ".concat(t," not supported"))(),r.luma.caps[t]}function x7(r,t){const e=i5[t];ir(e,t);let n;const i=fn(r)&&e[1]||e[0];if(typeof i=="function")n=i(r);else if(Array.isArray(i)){n=!0;for(const s of i)n=n&&!!r.getExtension(s)}else typeof i=="string"?n=!!r.getExtension(i):typeof i=="boolean"?n=i:ir(!1);return n}const a5="Multiple render targets not supported";class gs extends Ru{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:n,colorBufferHalfFloat:i}=e;let s=!0;return n&&(s=!!(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")||t.getExtension("OES_texture_float"))),i&&(s=s&&!!(t.getExtension("EXT_color_buffer_float")||t.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new gs(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const t=Po(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const t=Po(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t,e),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(e),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(t){let{width:e=1,height:n=1,attachments:i=null,color:s=!0,depth:a=!0,stencil:o=!1,check:d=!0,readBuffer:p=void 0,drawBuffers:y=void 0}=t;if(ir(e>=0&&n>=0,"Width and height need to be integers"),this.width=e,this.height=n,i)for(const b in i){const x=i[b];(Array.isArray(x)?x[0]:x).resize({width:e,height:n})}else i=this._createDefaultAttachments(s,a,o,e,n);this.update({clearAttachments:!0,attachments:i,readBuffer:p,drawBuffers:y}),i&&d&&this.checkStatus()}delete(){for(const t of this.ownResources)t.delete();return super.delete(),this}update(t){let{attachments:e={},readBuffer:n,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:a=!0}=t;this.attach(e,{clearAttachments:s,resizeAttachments:a});const{gl:o}=this,d=o.bindFramebuffer(36160,this.handle);return n&&this._setReadBuffer(n),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,d||null),this}resize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:e,height:n}=t;if(this.handle===null)return ir(e===void 0&&n===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;e===void 0&&(e=this.gl.drawingBufferWidth),n===void 0&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&vr.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(e,"x").concat(n))();for(const i in this.attachments)this.attachments[i].resize({width:e,height:n});return this.width=e,this.height=n,this}attach(t){let{clearAttachments:e=!1,resizeAttachments:n=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};e&&Object.keys(this.attachments).forEach(a=>{i[a]=null}),Object.assign(i,t);const s=this.gl.bindFramebuffer(36160,this.handle);for(const a in i){ir(a!==void 0,"Misspelled framebuffer binding point?");const o=Number(a),d=i[o];let p=d;if(!p)this._unattach(o);else if(p instanceof nf)this._attachRenderbuffer({attachment:o,renderbuffer:p});else if(Array.isArray(d)){const[y,b=0,x=0]=d;p=y,this._attachTexture({attachment:o,texture:y,layer:b,level:x})}else this._attachTexture({attachment:o,texture:p,layer:0,level:0});n&&p&&p.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter(a=>!this.attachments[a]).forEach(a=>{delete this.attachments[a]})}checkStatus(){const t=this.getStatus();if(t!==36053)throw new Error(C7(t));return this}getStatus(){const{gl:t}=this,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);return t.bindFramebuffer(36160,e||null),n}clear(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:e,depth:n,stencil:i,drawBuffers:s=[]}=t,a=this.gl.bindFramebuffer(36160,this.handle);return(e||n||i)&&Ab(this.gl,{color:e,depth:n,stencil:i}),s.forEach((o,d)=>{g7(this.gl,{drawBuffer:d,value:o})}),this.gl.bindFramebuffer(36160,a||null),this}readPixels(){return vr.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return vr.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return vr.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return vr.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return vr.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return vr.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(t){let{attachments:e=[],x:n=0,y:i=0,width:s,height:a}=t;const o=Po(this.gl),d=o.bindFramebuffer(36008,this.handle);return n===0&&i===0&&s===void 0&&a===void 0?o.invalidateFramebuffer(36008,e):o.invalidateFramebuffer(36008,e,n,i,s,a),o.bindFramebuffer(36008,d),this}getAttachmentParameter(t,e,n){let i=this._getAttachmentParameterFallback(e);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&i>1e3&&(i=MA(this.gl,i)),i}getAttachmentParameters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of n){const a=e?MA(this.gl,s):s;i[a]=this.getAttachmentParameter(t,s,e)}return i}getParameters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const e=Object.keys(this.attachments),n={};for(const i of e){const s=Number(i),a=t?MA(this.gl,s):s;n[a]=this.getAttachmentParameters(s,t)}return n}show(){return typeof window<"u"&&window.open(n5(this),"luma-debug-texture"),this}log(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(t>vr.level||typeof window>"u")return this;e=e||"Framebuffer ".concat(this.id);const n=n5(this,{targetMaxHeight:100});return vr.image({logLevel:t,message:e,image:n},e)(),this}bind(){let{target:t=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(t,this.handle),this}unbind(){let{target:t=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(t,null),this}_createDefaultAttachments(t,e,n,i,s){let a=null;return t&&(a=a||{},a[36064]=new Ca(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(a[36064])),e&&n?(a=a||{},a[33306]=new nf(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(a[33306])):e?(a=a||{},a[36096]=new nf(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(a[36096])):n&&ir(!1),a}_unattach(t){const e=this.attachments[t];e&&(e instanceof nf?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}_attachRenderbuffer(t){let{attachment:e=36064,renderbuffer:n}=t;const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,n.handle),this.attachments[e]=n}_attachTexture(t){let{attachment:e=36064,texture:n,layer:i,level:s}=t;const{gl:a}=this;switch(a.bindTexture(n.target,n.handle),n.target){case 35866:case 32879:Po(a).framebufferTextureLayer(36160,e,n.target,s,i);break;case 34067:const d=B7(i);a.framebufferTexture2D(36160,e,d,n.handle,s);break;case 3553:a.framebufferTexture2D(36160,e,3553,n.handle,s);break;default:ir(!1,"Illegal texture type")}a.bindTexture(n.target,null),this.attachments[e]=n}_setReadBuffer(t){const e=tH(this.gl);e?e.readBuffer(t):ir(t===36064||t===1029,a5),this.readBuffer=t}_setDrawBuffers(t){const{gl:e}=this,n=Po(e);if(n)n.drawBuffers(t);else{const i=e.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(t):ir(t.length===1&&(t[0]===36064||t[0]===1029),a5)}this.drawBuffers=t}_getAttachmentParameterFallback(t){const e=w7(this.gl);switch(t){case 36052:return e.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.WEBGL2?null:8;case 33297:return e.WEBGL2?null:5125;case 33296:return!e.WEBGL2&&!e.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(t){return this.gl.bindFramebuffer(36160,t)}}function B7(r){return r<34069?r+34069:r}function C7(r){return(gs.STATUS||{})[r]||"Framebuffer error ".concat(r)}const E7=[36049,36048,33296,33298,33299,33300,33301,33302,33303];gs.ATTACHMENT_PARAMETERS=E7;function S7(r,t){ir(r instanceof Ca||r instanceof XT||r instanceof A7);const e=r.constructor,{gl:n,width:i,height:s,format:a,type:o,dataFormat:d,border:p,mipmaps:y}=r,b=Object.assign({width:i,height:s,format:a,type:o,dataFormat:d,border:p,mipmaps:y},t);return new e(n,b)}function T7(r,t){const{gl:e,width:n,height:i,id:s}=r;return new gs(e,Object.assign({},t,{id:"framebuffer-for-".concat(s),width:n,height:i,attachments:{36064:r}}))}function P0(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const e=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,n=r.match(e);return n?n[1]:t}const I7=35632,F7=35633;function L7(r){switch(r){case I7:return"fragment";case F7:return"vertex";default:return"unknown type"}}function P7(r,t,e,n){const i=r.split(/\r?\n/),s={},a={},o=n||P0(t)||"(unnamed)",d="".concat(L7(e)," shader ").concat(o);for(let y=0;y<i.length;y++){const b=i[y];if(b.length<=1)continue;const x=b.split(":"),C=x[0],P=parseInt(x[2],10);if(isNaN(P))throw new Error("GLSL compilation error in ".concat(d,": ").concat(r));C!=="WARNING"?s[P]=b:a[P]=b}const p=M7(t);return{shaderName:d,errors:l5(s,p),warnings:l5(a,p)}}function l5(r,t){let e="";for(let n=0;n<t.length;n++){const i=t[n];if(!(!r[n+3]&&!r[n+2]&&!r[n+1])&&(e+="".concat(i,`
`),r[n+1])){const s=r[n+1],a=s.split(":",3),o=a[0],d=parseInt(a[1],10)||0,p=s.substring(a.join(":").length+1).trim();e+=c5("^^^ ".concat(o,": ").concat(p,`

`),d)}}return e}function M7(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const n=r.split(/\r?\n/),i=String(n.length+t-1).length;return n.map((s,a)=>{const o=String(a+t),d=o.length;return c5(o,i-d)+e+s})}function c5(r,t){let e="";for(let n=0;n<t;++n)e+=" ";return"".concat(e).concat(r)}function u5(r){let t=100;const e=r.match(/[^\s]+/g);if(e.length>=2&&e[0]==="#version"){const n=parseInt(e[1],10);Number.isFinite(n)&&(t=n)}return t}const U7="Shader: GLSL source code must be a JavaScript string";class og extends Ru{get[Symbol.toStringTag](){return"Shader"}static getTypeName(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return ir(!1),"unknown"}}constructor(t,e){F0(t),ir(typeof e.source=="string",U7);const n=P0(e.source,null)||e.id||Uu("unnamed ".concat(og.getTypeName(e.shaderType)));super(t,{id:n}),this.shaderType=e.shaderType,this.source=e.source,this.initialize(e)}initialize(t){let{source:e}=t;const n=P0(e,null);n&&(this.id=Uu(n)),this._compile(e)}getParameter(t){return this.gl.getShaderParameter(this.handle,t)}toString(){return"".concat(og.getTypeName(this.shaderType),":").concat(this.id)}getName(){return P0(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(t.startsWith("#version ")||(t=`#version 100
`.concat(t)),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const n=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:a}=P7(n,this.source,this.shaderType,this.id);throw vr.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),vr.warn("GLSL compilation warnings in ".concat(i,`
`).concat(a))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class db extends og{get[Symbol.toStringTag](){return"VertexShader"}constructor(t,e){typeof e=="string"&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class fb extends og{get[Symbol.toStringTag](){return"FragmentShader"}constructor(t,e){typeof e=="string"&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const R7={5126:xi.bind(null,"uniform1fv",Ea,1,ao),35664:xi.bind(null,"uniform2fv",Ea,2,ao),35665:xi.bind(null,"uniform3fv",Ea,3,ao),35666:xi.bind(null,"uniform4fv",Ea,4,ao),5124:xi.bind(null,"uniform1iv",UA,1,ao),35667:xi.bind(null,"uniform2iv",UA,2,ao),35668:xi.bind(null,"uniform3iv",UA,3,ao),35669:xi.bind(null,"uniform4iv",UA,4,ao),35670:xi.bind(null,"uniform1iv",UA,1,ao),35671:xi.bind(null,"uniform2iv",UA,2,ao),35672:xi.bind(null,"uniform3iv",UA,3,ao),35673:xi.bind(null,"uniform4iv",UA,4,ao),35674:xi.bind(null,"uniformMatrix2fv",Ea,4,Ou),35675:xi.bind(null,"uniformMatrix3fv",Ea,9,Ou),35676:xi.bind(null,"uniformMatrix4fv",Ea,16,Ou),35678:Gs,35680:Gs,5125:xi.bind(null,"uniform1uiv",M0,1,ao),36294:xi.bind(null,"uniform2uiv",M0,2,ao),36295:xi.bind(null,"uniform3uiv",M0,3,ao),36296:xi.bind(null,"uniform4uiv",M0,4,ao),35685:xi.bind(null,"uniformMatrix2x3fv",Ea,6,Ou),35686:xi.bind(null,"uniformMatrix2x4fv",Ea,8,Ou),35687:xi.bind(null,"uniformMatrix3x2fv",Ea,6,Ou),35688:xi.bind(null,"uniformMatrix3x4fv",Ea,12,Ou),35689:xi.bind(null,"uniformMatrix4x2fv",Ea,8,Ou),35690:xi.bind(null,"uniformMatrix4x3fv",Ea,12,Ou),35678:Gs,35680:Gs,35679:Gs,35682:Gs,36289:Gs,36292:Gs,36293:Gs,36298:Gs,36299:Gs,36300:Gs,36303:Gs,36306:Gs,36307:Gs,36308:Gs,36311:Gs},O7={},D7={},N7={},A5=[0];function pb(r,t,e,n){t===1&&typeof r=="boolean"&&(r=r?1:0),Number.isFinite(r)&&(A5[0]=r,r=A5);const i=r.length;if(i%t&&vr.warn("Uniform size should be multiples of ".concat(t),r)(),r instanceof e)return r;let s=n[i];s||(s=new e(i),n[i]=s);for(let a=0;a<i;a++)s[a]=r[a];return s}function Ea(r,t){return pb(r,t,Float32Array,O7)}function UA(r,t){return pb(r,t,Int32Array,D7)}function M0(r,t){return pb(r,t,Uint32Array,N7)}function h5(r,t,e){const n=R7[e.type];if(!n)throw new Error("Unknown GLSL uniform type ".concat(e.type));return n().bind(null,r,t)}function k7(r){if(r[r.length-1]!=="]")return{name:r,length:1,isArray:!1};const t=/([^[]*)(\[[0-9]+\])?/,e=r.match(t);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(r));return{name:e[1],length:e[2]||1,isArray:!!e[2]}}function Q7(r,t,e){for(const n in r){const i=r[n];if((!e||!!e[n])&&!z7(i))throw t=t?"".concat(t," "):"",console.error("".concat(t," Bad uniform ").concat(n),i),new Error("".concat(t," Bad uniform ").concat(n))}return!0}function z7(r){return Array.isArray(r)||ArrayBuffer.isView(r)?V7(r):isFinite(r)||r===!0||r===!1||r instanceof rf||r instanceof nf?!0:r instanceof gs?!!r.texture:!1}function H7(r,t,e){if(Array.isArray(e)||ArrayBuffer.isView(e))if(r[t]){const n=r[t];for(let i=0,s=e.length;i<s;++i)n[i]=e[i]}else r[t]=e.slice();else r[t]=e}function V7(r){if(r.length===0)return!1;const t=Math.min(r.length,16);for(let e=0;e<t;++e)if(!Number.isFinite(r[e]))return!1;return!0}function Gs(){let r=null;return(t,e,n)=>{const i=r!==n;return i&&(t.uniform1i(e,n),r=n),i}}function xi(r,t,e,n){let i=null,s=null;return(a,o,d)=>{const p=t(d,e),y=p.length;let b=!1;if(i===null)i=new Float32Array(y),s=y,b=!0;else{ir(s===y,"Uniform length cannot change.");for(let x=0;x<y;++x)if(p[x]!==i[x]){b=!0;break}}return b&&(n(a,r,o,p),i.set(p)),b}}function ao(r,t,e,n){r[t](e,n)}function Ou(r,t,e,n){r[t](e,!1,n)}const G7=5120,j7=5121,q7=5122,K7=5123,d5=0,U0=1,$7=2,W7=3,R0=4,X7=5,J7=6,ms=5126,Y7=35664,Z7=35665,t9=35666,ag=5124,e9=35667,r9=35668,n9=35669,lg=5125,i9=36294,s9=36295,o9=36296,a9=35670,l9=35671,c9=35672,u9=35673,A9=35674,h9=35675,d9=35676,f9=35685,p9=35686,g9=35687,m9=35688,y9=35689,_9=35690,gb={[ms]:[ms,1,"float"],[Y7]:[ms,2,"vec2"],[Z7]:[ms,3,"vec3"],[t9]:[ms,4,"vec4"],[ag]:[ag,1,"int"],[e9]:[ag,2,"ivec2"],[r9]:[ag,3,"ivec3"],[n9]:[ag,4,"ivec4"],[lg]:[lg,1,"uint"],[i9]:[lg,2,"uvec2"],[s9]:[lg,3,"uvec3"],[o9]:[lg,4,"uvec4"],[a9]:[ms,1,"bool"],[l9]:[ms,2,"bvec2"],[c9]:[ms,3,"bvec3"],[u9]:[ms,4,"bvec4"],[A9]:[ms,8,"mat2"],[f9]:[ms,8,"mat2x3"],[p9]:[ms,8,"mat2x4"],[h9]:[ms,12,"mat3"],[g9]:[ms,12,"mat3x2"],[m9]:[ms,12,"mat3x4"],[d9]:[ms,16,"mat4"],[y9]:[ms,16,"mat4x2"],[_9]:[ms,16,"mat4x3"]};function v9(r){switch(r){case d5:return d5;case U0:return U0;case W7:return U0;case $7:return U0;case R0:return R0;case X7:return R0;case J7:return R0;default:return ir(!1),0}}function f5(r){const t=gb[r];if(!t)return null;const[e,n]=t;return{type:e,components:n}}function p5(r,t){switch(r){case G7:case j7:case q7:case K7:r=ms;break}for(const e in gb){const[n,i,s]=gb[e];if(n===r&&i===t)return{glType:e,name:s}}return null}class b9{constructor(t){this.id=t.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(t),this._readVaryingsFromProgram(t)}getAttributeInfo(t){const e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}getAttributeLocation(t){const e=this.getAttributeInfo(t);return e?e.location:-1}getAttributeAccessor(t){const e=this.getAttributeInfo(t);return e?e.accessor:null}getVaryingInfo(t){const e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}getVaryingIndex(t){const e=this.getVaryingInfo();return e?e.location:-1}getVaryingAccessor(t){const e=this.getVaryingInfo();return e?e.accessor:null}_readAttributesFromProgram(t){const{gl:e}=t,n=e.getProgramParameter(t.handle,35721);for(let i=0;i<n;i++){const{name:s,type:a,size:o}=e.getActiveAttrib(t.handle,i),d=e.getAttribLocation(t.handle,s);d>=0&&this._addAttribute(d,s,a,o)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(t){const{gl:e}=t;if(!fn(e))return;const n=e.getProgramParameter(t.handle,35971);for(let i=0;i<n;i++){const{name:s,type:a,size:o}=e.getTransformFeedbackVarying(t.handle,i);this._addVarying(i,s,a,o)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(t,e,n,i){const{type:s,components:a}=f5(n),o={type:s,size:i*a};this._inferProperties(t,e,o);const d={location:t,name:e,accessor:new ra(o)};this.attributeInfos.push(d),this.attributeInfosByLocation[t]=d,this.attributeInfosByName[d.name]=d}_inferProperties(t,e,n){/instance/i.test(e)&&(n.divisor=1)}_addVarying(t,e,n,i){const{type:s,components:a}=f5(n),o=new ra({type:s,size:i*a}),d={location:t,name:e,accessor:o};this.varyingInfos.push(d),this.varyingInfosByName[d.name]=d}}const g5=4,w9=35981,x9=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class m5 extends Ru{get[Symbol.toStringTag](){return"Program"}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t,e),this.stubRemovedMethods("Program","v6.0",x9),this._isCached=!1,this.initialize(e),Object.seal(this),this._setId(e.id)}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:e,vs:n,fs:i,varyings:s,bufferMode:a=w9}=t;return this.hash=e||"",this.vs=typeof n=="string"?new db(this.gl,{id:"".concat(t.id,"-vs"),source:n}):n,this.fs=typeof i=="string"?new fb(this.gl,{id:"".concat(t.id,"-fs"),source:i}):i,ir(this.vs instanceof db),ir(this.fs instanceof fb),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Po(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,a)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new b9(this),this.setProps(t)}delete(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(t)}setProps(t){return"uniforms"in t&&this.setUniforms(t.uniforms),this}draw(t){let{logPriority:e,drawMode:n=4,vertexCount:i,offset:s=0,start:a,end:o,isIndexed:d=!1,indexType:p=5123,instanceCount:y=0,isInstanced:b=y>0,vertexArray:x=null,transformFeedback:C,framebuffer:P,parameters:M={},uniforms:k,samplers:z}=t;if((k||z)&&(vr.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(k||{})),vr.priority>=e){const V=P?P.id:"default",$="mode=".concat(MA(this.gl,n)," verts=").concat(i," ")+"instances=".concat(y," indexType=").concat(MA(this.gl,p)," ")+"isInstanced=".concat(b," isIndexed=").concat(d," ")+"Framebuffer=".concat(V);vr.log(e,$)()}return ir(x),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||b&&y===0?!1:(x.bindForDraw(i,y,()=>{if(P!==void 0&&(M=Object.assign({},M,{framebuffer:P})),C){const V=v9(n);C.begin(V)}this._bindTextures(),$l(this.gl,M,()=>{d&&b?this.gl2.drawElementsInstanced(n,i,p,s,y):d&&fn(this.gl)&&!isNaN(a)&&!isNaN(o)?this.gl2.drawRangeElements(n,a,o,i,p,s):d?this.gl.drawElements(n,i,p,s):b?this.gl2.drawArraysInstanced(n,s,i,y):this.gl.drawArrays(n,s,i)}),C&&C.end()}),!0)}setUniforms(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};vr.priority>=2&&Q7(t,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const e in t){const n=t[e],i=this._uniformSetters[e];if(i){let s=n,a=!1;if(s instanceof gs&&(s=s.texture),s instanceof rf)if(a=this.uniforms[e]!==n,a){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const o=s,{textureIndex:d}=i;o.bind(d),s=d,this._textureUniforms[e]=o}else s=i.textureIndex;else this._textureUniforms[e]&&delete this._textureUniforms[e];(i(s)||a)&&H7(this.uniforms,e,n)}}return this}_areTexturesRenderable(){let t=!0;for(const e in this._textureUniforms){const n=this._textureUniforms[e];n.update(),t=t&&n.loaded}return t}_bindTextures(){for(const t in this._textureUniforms){const e=this._uniformSetters[t].textureIndex;this._textureUniforms[t].bind(e)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(t){const e=this.gl.getAttachedShaders(t),n={};for(const i of e)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new db({handle:i});break;case 35632:n.fs=new fb({handle:i});break}return n}_getParameter(t){return this.gl.getProgramParameter(this.handle,t)}_setId(t){if(!t){const e=this._getName();this.id=Uu(e)}}_getName(){let t=this.vs.getName()||this.fs.getName();return t=t.replace(/shader/i,""),t=t?"".concat(t,"-program"):"program",t}_compileAndLink(){const{gl:t}=this;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),vr.time(g5,"linkProgram for ".concat(this._getName()))(),t.linkProgram(this.handle),vr.timeEnd(g5,"linkProgram for ".concat(this._getName()))(),t.debug||vr.level>0){if(!t.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(t.getProgramInfoLog(this.handle)));if(t.validateProgram(this.handle),!t.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(t.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:t}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let e=0;e<this._uniformCount;e++){const n=this.gl.getActiveUniform(this.handle,e),{name:i}=k7(n.name);let s=t.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=h5(t,s,n),n.size>1)for(let a=0;a<n.size;a++)s=t.getUniformLocation(this.handle,"".concat(i,"[").concat(a,"]")),this._uniformSetters["".concat(i,"[").concat(a,"]")]=h5(t,s,n)}this._textureIndexCounter=0}getActiveUniforms(t,e){return this.gl2.getActiveUniforms(this.handle,t,e)}getUniformBlockIndex(t){return this.gl2.getUniformBlockIndex(this.handle,t)}getActiveUniformBlockParameter(t,e){return this.gl2.getActiveUniformBlockParameter(this.handle,t,e)}uniformBlockBinding(t,e){this.gl2.uniformBlockBinding(this.handle,t,e)}}const B9=34918,C9=34919,E9=35007,S9=36795,T9=35976,I9=35887,F9=36202;class O0 extends Ru{get[Symbol.toStringTag](){return"Query"}static isSupported(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=fn(t),i=s5(t,mi.TIMER_QUERY);let s=n||i;for(const a of e)switch(a){case"queries":s=s&&n;break;case"timers":s=s&&i;break;default:ir(!1)}return s}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t,e),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(E9)}beginOcclusionQuery(){let{conservative:t=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(t?F9:I9)}beginTransformFeedbackQuery(){return this.begin(T9)}begin(t){return this._queryPending?this:(this.target=t,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const t=this.gl2.getQueryParameter(this.handle,C9);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.gl2.getParameter(S9)}getResult(){return this.gl2.getQueryParameter(this.handle,B9)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let e=0;return this._pollingPromise=new Promise((n,i)=>{const s=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):e++>t?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return O0.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class y5 extends Ru{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(t){return fn(t)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Po(t),super(t,e),this.initialize(e),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,tf(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(t),this}setProps(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}setBuffers(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const e in t)this.setBuffer(e,t[e])}),this}setBuffer(t,e){const n=this._getVaryingIndex(t),{buffer:i,byteSize:s,byteOffset:a}=this._getBufferParams(e);return n<0?(this.unused[t]=i,vr.warn("".concat(this.id," unused varying buffer ").concat(t))(),this):(this.buffers[n]=e,this.bindOnUse||this._bindBuffer(n,i,a,s),this)}begin(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(t){let e,n,i;return t instanceof ni?i=t:(i=t.buffer,n=t.byteSize,e=t.byteOffset),(e!==void 0||n!==void 0)&&(e=e||0,n=n||i.byteLength-e),{buffer:i,byteOffset:e,byteSize:n}}_getVaryingInfo(t){return this.configuration&&this.configuration.getVaryingInfo(t)}_getVaryingIndex(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;const e=Number(t);return Number.isFinite(e)?e:-1}_bindBuffers(){if(this.bindOnUse)for(const t in this.buffers){const{buffer:e,byteSize:n,byteOffset:i}=this._getBufferParams(this.buffers[t]);this._bindBuffer(t,e,i,n)}}_unbindBuffers(){if(this.bindOnUse)for(const t in this.buffers)this._bindBuffer(t,null)}_bindBuffer(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=e&&e.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,t,s):this.gl.bindBufferRange(35982,t,s,n,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(t){this.gl.bindTransformFeedback(36386,this.handle)}}let D0=null;function L9(r){return(!D0||D0.byteLength<r)&&(D0=new ArrayBuffer(r)),D0}function P9(r,t){const e=L9(r.BYTES_PER_ELEMENT*t);return new r(e,0,t)}function M9(r){let{target:t,source:e,start:n=0,count:i=1}=r;const s=e.length,a=i*s;let o=0;for(let d=n;o<s;o++)t[d++]=e[o];for(;o<a;)o<a-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+a-o),o=a);return t}const U9="elements must be GL.ELEMENT_ARRAY_BUFFER";class Sa extends Ru{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(t){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?fn(t)||eT()==="Chrome":!0}static getDefaultArray(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new Sa(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}static getMaxAttributes(t){return Sa.MAX_ATTRIBUTES=Sa.MAX_ATTRIBUTES||t.getParameter(34921),Sa.MAX_ATTRIBUTES}static setConstant(t,e,n){switch(n.constructor){case Float32Array:Sa._setConstantFloatArray(t,e,n);break;case Int32Array:Sa._setConstantIntArray(t,e,n);break;case Uint32Array:Sa._setConstantUintArray(t,e,n);break;default:ir(!1)}}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e.id||e.program&&e.program.id;super(t,Object.assign({},e,{id:n})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=e.isDefaultArray||!1,this.gl2=t,this.initialize(e),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Sa.getMaxAttributes(this.gl)}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(t)}setProps(t){return this}setElementBuffer(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return ir(!t||t.target===34963,U9),this.bind(()=>{this.gl.bindBuffer(34963,t?t.handle:null)}),this}setBuffer(t,e,n){if(e.target===34963)return this.setElementBuffer(e,n);const{size:i,type:s,stride:a,offset:o,normalized:d,integer:p,divisor:y}=n,{gl:b,gl2:x}=this;return t=Number(t),this.bind(()=>{b.bindBuffer(34962,e.handle),p?(ir(fn(b)),x.vertexAttribIPointer(t,i,s,a,o)):b.vertexAttribPointer(t,i,s,d,a,o),b.enableVertexAttribArray(t),x.vertexAttribDivisor(t,y||0)}),this}enable(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!e&&t===0&&!Sa.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind(()=>e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t))),this}getConstantBuffer(t,e){const n=this._normalizeConstantArrayValue(e),i=n.byteLength*t,s=n.length*t;let a=!this.buffer;if(this.buffer=this.buffer||new ni(this.gl,i),a=a||this.buffer.reallocate(i),a=a||!this._compareConstantArrayValues(n,this.bufferValue),a){const o=P9(e.constructor,s);M9({target:o,source:n,start:0,count:s}),this.buffer.subData(o),this.bufferValue=e}return this.buffer}_normalizeConstantArrayValue(t){return Array.isArray(t)?new Float32Array(t):t}_compareConstantArrayValues(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}static _setConstantFloatArray(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:ir(!1)}}static _setConstantIntArray(t,e,n){switch(ir(fn(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:ir(!1)}}static _setConstantUintArray(t,e,n){switch(ir(fn(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:ir(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(t){return this.gl2.deleteVertexArray(t),[this.elements]}_bindHandle(t){this.gl2.bindVertexArray(t)}_getParameter(t,e){let{location:n}=e;return ir(Number.isFinite(n)),this.bind(()=>{switch(t){case 34373:return this.gl.getVertexAttribOffset(n,t);default:return this.gl.getVertexAttrib(n,t)}})}}const R9="VertexArray: attributes must be Buffers or constants (i.e. typed array)",O9=/^(.+)__LOCATION_([0-9]+)$/,D9=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class N9{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e.id||e.program&&e.program.id;this.id=n,this.gl=t,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Sa(t),GT(this,"VertexArray","v6.0",D9),this.initialize(e),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:t}=this.vertexArrayObject;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}setProps(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(t){return Object.assign(this.attributes,t),this.vertexArrayObject.bind(()=>{for(const e in t){const n=t[e];this._setAttribute(e,n)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}setBuffer(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e.target===34963)return this.setElementBuffer(e,n);const{location:i,accessor:s}=this._resolveLocationAndAccessor(t,e,e.accessor,n);return i>=0&&(this.values[i]=e,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,e,s)),this}setConstant(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},n));return i>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[i]=e,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ni(this.gl,{accessor:{size:4}});for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this.values[t]instanceof ni&&(this.gl.disableVertexAttribArray(t),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(t,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++){const e=this.values[t];e instanceof ni&&this.setBuffer(t,e)}}),this}bindForDraw(t,e,n){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(t,e),i=n()}),i}_resolveLocationAndAccessor(t,e,n,i){const s={location:-1,accessor:null},{location:a,name:o}=this._getAttributeIndex(t);if(!Number.isFinite(a)||a<0)return this.unused[t]=e,vr.once(3,()=>"unused value ".concat(t," in ").concat(this.id))(),s;const d=this._getAttributeInfo(o||a);if(!d)return s;const p=this.accessors[a]||{},y=ra.resolve(d.accessor,p,n,i),{size:b,type:x}=y;return ir(Number.isFinite(b)&&Number.isFinite(x)),{location:a,accessor:y}}_getAttributeInfo(t){return this.configuration&&this.configuration.getAttributeInfo(t)}_getAttributeIndex(t){const e=Number(t);if(Number.isFinite(e))return{location:e};const n=O9.exec(t),i=n?n[1]:t,s=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(t,e){if(e instanceof ni)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof ni){const n=e[0],i=e[1];this.setBuffer(t,n,i)}else if(ArrayBuffer.isView(e)||Array.isArray(e)){const n=e;this.setConstant(t,n)}else if(e.buffer instanceof ni){const n=e;this.setBuffer(t,n.buffer,n)}else throw new Error(R9)}_setConstantAttributes(t,e){const n=Math.max(t|0,e|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,n);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(t,e){if(Sa.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,t);return}const n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(t,e){Sa.setConstant(this.gl,t,e)}_updateDrawParams(){const t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}_updateDrawParamsForLocation(t,e){const n=this.values[e],i=this.accessors[e];if(!n)return;const{divisor:s}=i,a=s>0;if(t.isInstanced=t.isInstanced||a,n instanceof ni){const o=n;if(a){const d=o.getVertexCount(i);t.instanceCount=Math.min(t.instanceCount,d)}else{const d=o.getVertexCount(i);t.vertexCount=Math.min(t.vertexCount,d)}}}setElements(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return vr.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(t,e)}}function k9(r,t){const{maxElts:e=16,size:n=1}=t;let i="[";for(let a=0;a<r.length&&a<e;++a)a>0&&(i+=",".concat(a%n===0?" ":"")),i+=cg(r[a],t);const s=r.length>e?"...":"]";return"".concat(i).concat(s)}function cg(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e=1e-16,{isInteger:n=!1}=t;if(Array.isArray(r)||ArrayBuffer.isView(r))return k9(r,t);if(!Number.isFinite(r))return String(r);if(Math.abs(r)<e)return n?"0":"0.";if(n||Math.abs(r)>100&&Math.abs(r)<1e4)return r.toFixed(0);const i=r.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function _5(r){let{header:t="Uniforms",program:e,uniforms:n,undefinedOnly:i=!1}=r;ir(e);const s=".*_.*",a=".*Matrix",o=e._uniformSetters,d={},p=Object.keys(o).sort();let y=0;for(const C of p)!C.match(s)&&!C.match(a)&&mb({table:d,header:t,uniforms:n,uniformName:C,undefinedOnly:i})&&y++;for(const C of p)C.match(a)&&mb({table:d,header:t,uniforms:n,uniformName:C,undefinedOnly:i})&&y++;for(const C of p)d[C]||mb({table:d,header:t,uniforms:n,uniformName:C,undefinedOnly:i})&&y++;let b=0;const x={};if(!i)for(const C in n){const P=n[C];d[C]||(b++,x[C]={Type:"NOT USED: ".concat(P),[t]:cg(P)})}return{table:d,count:y,unusedTable:x,unusedCount:b}}function mb(r){let{table:t,header:e,uniforms:n,uniformName:i,undefinedOnly:s}=r;const a=n[i],o=Q9(a);return!s||!o?(t[i]={[e]:o?cg(a):"N/A","Uniform Type":o?a:"NOT PROVIDED"},!0):!1}function Q9(r){return r!=null}function z9(r){let{vertexArray:t,header:e="Attributes"}=r;if(!t.configuration)return{};const n={};t.elements&&(n.ELEMENT_ARRAY_BUFFER=v5(t,t.elements,null,e));const i=t.values;for(const s in i){const a=t._getAttributeInfo(s);if(a){let o="".concat(s,": ").concat(a.name);const d=t.accessors[a.location];d&&(o="".concat(s,": ").concat(H9(a.name,d))),n[o]=v5(t,i[s],d,e)}}return n}function v5(r,t,e,n){const{gl:i}=r;if(!t)return{[n]:"null","Format ":"N/A"};let s="NOT PROVIDED",a=1,o=0,d=0,p,y,b;if(e&&(s=e.type,a=e.size,s=String(s).replace("Array",""),p=s.indexOf("nt")!==-1),t instanceof ni){const x=t,{data:C,changed:P}=x.getDebugData();y=P?"*":"",b=C,d=x.byteLength,o=d/C.BYTES_PER_ELEMENT/a;let M;if(e){const k=e.divisor>0;M="".concat(k?"I ":"P "," ").concat(o," (x").concat(a,"=").concat(d," bytes ").concat(MA(i,s),")")}else p=!0,M="".concat(d," bytes");return{[n]:"".concat(y).concat(cg(b,{size:a,isInteger:p})),"Format ":M}}return b=t,a=t.length,s=String(t.constructor.name).replace("Array",""),p=s.indexOf("nt")!==-1,{[n]:"".concat(cg(b,{size:a,isInteger:p})," (constant)"),"Format ":"".concat(a,"x").concat(s," (constant)")}}function H9(r,t){const{type:e,size:n}=t,i=p5(e,n);return i?"".concat(r," (").concat(i.name,")"):r}function V9(r){const t={},e="Accessors for ".concat(r.id);for(const n of r.attributeInfos)if(n){const i=b5(n);t["in ".concat(i)]={[e]:JSON.stringify(n.accessor)}}for(const n of r.varyingInfos)if(n){const i=b5(n);t["out ".concat(i)]={[e]:JSON.stringify(n.accessor)}}return t}function b5(r){const{type:t,size:e}=r.accessor,n=p5(t,e);return n?"".concat(n.name," ").concat(r.name):r.name}const w5=Pu()&&typeof document<"u";let G9=0;class j9{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:e=k=>HT(k),onAddHTML:n=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:a=()=>{},onError:o,gl:d=null,glOptions:p={},debug:y=!1,createFramebuffer:b=!1,autoResizeViewport:x=!0,autoResizeDrawingBuffer:C=!0,stats:P=zh.get("animation-loop-".concat(G9++))}=t;let{useDevicePixels:M=!0}=t;"useDevicePixelRatio"in t&&(vr.deprecated("useDevicePixelRatio","useDevicePixels")(),M=t.useDevicePixelRatio),this.props={onCreateContext:e,onAddHTML:n,onInitialize:i,onRender:s,onFinalize:a,onError:o,gl:d,glOptions:p,debug:y,createFramebuffer:b},this.gl=d,this.needsRedraw=null,this.timeline=null,this.stats=P,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:x,autoResizeDrawingBuffer:C,useDevicePixels:M}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(t){return ir(typeof t=="string"),this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}start(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const e=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(t),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=O0.isSupported(this.gl,["timers"])?new O0(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(n=>{this._running&&(this._addCallbackData(n||{}),n!==!1&&this._startLoop())});return this.props.onError&&e.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(t=>{this._resolveNextFrame=t})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const n=document.getElementById(t);return n?Number(n.value):e}setViewParameters(){return vr.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const t=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(t))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(t)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=w5?new Promise((t,e)=>{if(w5&&document.readyState==="complete"){t(document);return}window.addEventListener("load",()=>{t(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(t){this.display&&(this.display.delete(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_cancelAnimationFrame(t){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(t):YH(t)}_requestAnimationFrame(t){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(t):JH(t)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:t,height:e,aspect:n}=this._getSizeAndAspect();(t!==this.animationProps.width||e!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=e,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(t){typeof t=="object"&&t!==null&&(this.animationProps=Object.assign({},this.animationProps,t))}_createWebGLContext(t){if(this.offScreen=t.canvas&&typeof OffscreenCanvas<"u"&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,this.props.glOptions),this.gl=this.props.gl?ib(this.props.gl,t):this.onCreateContext(t),!I0(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");NH(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);const n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}_getSizeAndAspect(){const t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight;let n=1;const{canvas:i}=this.gl;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&VH(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new gs(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:t}=this.gl;t&&(t.addEventListener("mousemove",this._onMousemove),t.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}_onMouseleave(t){this.animationProps._mousePosition=null}}const ug="vs",yb="fs";function Ta(r,t){if(!r)throw new Error(t||"shadertools: assertion failed.")}const _b={number:{validate(r,t){return Number.isFinite(r)&&(!("max"in t)||r<=t.max)&&(!("min"in t)||r>=t.min)}},array:{validate(r,t){return Array.isArray(r)||ArrayBuffer.isView(r)}}};function q9(r){const t={};for(const e in r){const n=r[e],i=K9(n);t[e]=i}return t}function K9(r){let t=x5(r);return t==="object"?r?"type"in r?Object.assign({},r,_b[r.type]):"value"in r?(t=x5(r.value),Object.assign({type:t},r,_b[t])):{type:"object",value:r}:{type:"object",value:null}:Object.assign({type:t,value:r},_b[t])}function x5(r){return Array.isArray(r)||ArrayBuffer.isView(r)?"array":typeof r}const $9="vs",W9="fs";class B5{constructor(t){let{name:e,vs:n,fs:i,dependencies:s=[],uniforms:a,getUniforms:o,deprecations:d=[],defines:p={},inject:y={},vertexShader:b,fragmentShader:x}=t;Ta(typeof e=="string"),this.name=e,this.vs=n||b,this.fs=i||x,this.getModuleUniforms=o,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(d),this.defines=p,this.injections=X9(y),a&&(this.uniforms=q9(a))}getModuleSource(t){let e;switch(t){case $9:e=this.vs||"";break;case W9:e=this.fs||"";break;default:Ta(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(e,"// END MODULE_").concat(this.name,`

`)}getUniforms(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):this.uniforms?this._defaultGetUniforms(t):{}}getDefines(){return this.defines}checkDeprecations(t,e){this.deprecations.forEach(n=>{n.regex.test(t)&&(n.deprecated?e.deprecated(n.old,n.new)():e.removed(n.old,n.new)())})}_parseDeprecationDefinitions(t){return t.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp("\\b".concat(e.old,"\\("));break;default:e.regex=new RegExp("".concat(e.type," ").concat(e.old,";"))}}),t}_defaultGetUniforms(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e={},n=this.uniforms;for(const i in n){const s=n[i];i in t&&!s.private?(s.validate&&Ta(s.validate(t[i],s),"".concat(this.name,": invalid ").concat(i)),e[i]=t[i]):e[i]=s.value}return e}}function X9(r){const t={vs:{},fs:{}};for(const e in r){let n=r[e];const i=e.slice(0,2);typeof n=="string"&&(n={order:0,injection:n}),t[i][e]=n}return t}function J9(r){return Y9(E5(r))}function Y9(r){const t={},e={};return C5({modules:r,level:0,moduleMap:t,moduleDepth:e}),Object.keys(e).sort((n,i)=>e[i]-e[n]).map(n=>t[n])}function C5(r){let{modules:t,level:e,moduleMap:n,moduleDepth:i}=r;if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const s of t)n[s.name]=s,(i[s.name]===void 0||i[s.name]<e)&&(i[s.name]=e);for(const s of t)s.dependencies&&C5({modules:s.dependencies,level:e+1,moduleMap:n,moduleDepth:i})}function E5(r,t){return r.map(e=>(e instanceof B5||(Ta(typeof e!="string","Shader module use by name is deprecated. Import shader module '".concat(e,"' and use it directly.")),Ta(e.name,"shader module has no name"),e=new B5(e),e.dependencies=E5(e.dependencies)),e))}function Z9(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=typeof window<"u"?window.navigator||{}:{},e=r.userAgent||t.userAgent||"",n=e.indexOf("MSIE ")!==-1,i=e.indexOf("Trident/")!==-1;return n||i}const tV=7936,eV=7937,rV=7938,nV=35724,vb={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Vh={};Object.keys(vb).forEach(r=>{Vh[r]=r});function iV(r){return typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?!0:!!(r&&r._version===2)}function sV(r){const t=r.getExtension("WEBGL_debug_renderer_info"),e=r.getParameter(t&&t.UNMASKED_VENDOR_WEBGL||tV),n=r.getParameter(t&&t.UNMASKED_RENDERER_WEBGL||eV);return{gpuVendor:oV(e,n),vendor:e,renderer:n,version:r.getParameter(rV),shadingLanguageVersion:r.getParameter(nV)}}function oV(r,t){return r.match(/NVIDIA/i)||t.match(/NVIDIA/i)?"NVIDIA":r.match(/INTEL/i)||t.match(/INTEL/i)?"INTEL":r.match(/AMD/i)||t.match(/AMD/i)||r.match(/ATI/i)||t.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const bb={};function S5(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=vb[t];if(Ta(n,t),!Z9(e))return!0;if(t in bb)return bb[t];const i=n[0],s=e.behavior||"enable",a="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),o=r.createShader(35633);r.shaderSource(o,a),r.compileShader(o);const d=r.getShaderParameter(o,35713);return r.deleteShader(o),bb[t]=d,d}function aV(r,t){const e=vb[t];Ta(e,t);const n=iV(r)&&e[1]||e[0],i=typeof n=="string"?!!r.getExtension(n):n;return Ta(i===!1||i===!0),i}function N0(r,t){return t=Array.isArray(t)?t:[t],t.every(e=>aV(r,e))}function lV(r){switch(sV(r).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function cV(r,t,e){let n=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return N0(r,Vh.GLSL_FRAG_DEPTH)&&(n+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),N0(r,Vh.GLSL_DERIVATIVES)&&S5(r,Vh.GLSL_DERIVATIVES)&&(n+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),N0(r,Vh.GLSL_FRAG_DATA)&&S5(r,Vh.GLSL_FRAG_DATA,{behavior:"require"})&&(n+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),N0(r,Vh.GLSL_TEXTURE_LOD)&&(n+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),n}const uV=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,AV=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,hV={[ug]:uV,[yb]:AV},k0="__LUMA_INJECT_DECLARATIONS__",T5=/void\s+main\s*\([^)]*\)\s*\{\n?/,I5=/}\n?[^{}]*$/,wb=[];function F5(r,t,e){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=t===ug;for(const s in e){const a=e[s];a.sort((d,p)=>d.order-p.order),wb.length=a.length;for(let d=0,p=a.length;d<p;++d)wb[d]=a[d].injection;const o="".concat(wb.join(`
`),`
`);switch(s){case"vs:#decl":i&&(r=r.replace(k0,o));break;case"vs:#main-start":i&&(r=r.replace(T5,d=>d+o));break;case"vs:#main-end":i&&(r=r.replace(I5,d=>o+d));break;case"fs:#decl":i||(r=r.replace(k0,o));break;case"fs:#main-start":i||(r=r.replace(T5,d=>d+o));break;case"fs:#main-end":i||(r=r.replace(I5,d=>o+d));break;default:r=r.replace(s,d=>d+o)}}return r=r.replace(k0,""),n&&(r=r.replace(/\}\s*$/,s=>s+hV[t])),r}function xb(r){const t={};return Ta(Array.isArray(r)&&r.length>1),r.forEach(e=>{for(const n in e)t[n]=t[n]?"".concat(t[n],`
`).concat(e[n]):e[n]}),t}function sf(r){return new RegExp("\\b".concat(r,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const L5=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],dV=[...L5,[sf("attribute"),"in $1"],[sf("varying"),"out $1"]],fV=[...L5,[sf("varying"),"in $1"]],P5=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],pV=[...P5,[sf("in"),"attribute $1"],[sf("out"),"varying $1"]],gV=[...P5,[sf("in"),"varying $1"]],Bb="gl_FragColor",Cb=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,mV=/void\s+main\s*\([^)]*\)\s*\{\n?/;function yV(r,t,e){switch(t){case 300:return e?Q0(r,dV):_V(r);case 100:return e?Q0(r,pV):vV(r);default:throw new Error("unknown GLSL version ".concat(t))}}function Q0(r,t){for(const[e,n]of t)r=r.replace(e,n);return r}function _V(r){r=Q0(r,fV);const t=r.match(Cb);if(t){const e=t[1];r=r.replace(new RegExp("\\b".concat(Bb,"\\b"),"g"),e)}else{const e="fragmentColor";r=r.replace(mV,n=>"out vec4 ".concat(e,`;
`).concat(n)).replace(new RegExp("\\b".concat(Bb,"\\b"),"g"),e)}return r}function vV(r){r=Q0(r,gV);const t=r.match(Cb);if(t){const e=t[1];r=r.replace(Cb,"").replace(new RegExp("\\b".concat(e,"\\b"),"g"),Bb)}return r}const bV=`

`.concat(k0,`

`),M5={[ug]:"vertex",[yb]:"fragment"},wV=`precision highp float;

`;function xV(r,t){const{vs:e,fs:n}=t,i=J9(t.modules||[]);return{gl:r,vs:U5(r,Object.assign({},t,{source:e,type:ug,modules:i})),fs:U5(r,Object.assign({},t,{source:n,type:yb,modules:i})),getUniforms:BV(i)}}function U5(r,t){let{id:e,source:n,type:i,modules:s,defines:a={},hookFunctions:o=[],inject:d={},transpileToGLSL100:p=!1,prologue:y=!0,log:b}=t;Ta(typeof n=="string","shader source must be a string");const x=i===ug,C=n.split(`
`);let P=100,M="",k=n;C[0].indexOf("#version ")===0?(P=300,M=C[0],k=C.slice(1).join(`
`)):M="#version ".concat(P);const z={};s.forEach(mt=>{Object.assign(z,mt.getDefines())}),Object.assign(z,a);let V=y?"".concat(M,`
`).concat(EV({id:e,source:n,type:i}),`
`).concat(CV({type:i}),`
`).concat(lV(r),`
`).concat(cV(r),`
`).concat(SV(z),`
`).concat(x?"":wV,`
`):"".concat(M,`
`);const $=IV(o),tt={},pt={},gt={};for(const mt in d){const dt=typeof d[mt]=="string"?{injection:d[mt],order:0}:d[mt],Ft=mt.match(/^(v|f)s:(#)?([\w-]+)$/);if(Ft){const Tt=Ft[2],ot=Ft[3];Tt?ot==="decl"?pt[mt]=[dt]:gt[mt]=[dt]:tt[mt]=[dt]}else gt[mt]=[dt]}for(const mt of s){b&&mt.checkDeprecations(k,b);const dt=mt.getModuleSource(i,P);V+=dt;const Ft=mt.injections[i];for(const Tt in Ft){const ot=Tt.match(/^(v|f)s:#([\w-]+)$/);if(ot){const wt=ot[2]==="decl"?pt:gt;wt[Tt]=wt[Tt]||[],wt[Tt].push(Ft[Tt])}else tt[Tt]=tt[Tt]||[],tt[Tt].push(Ft[Tt])}}return V+=bV,V=F5(V,i,pt),V+=TV($[i],tt),V+=k,V=F5(V,i,gt),V=yV(V,p?100:P,x),V}function BV(r){return function(e){const n={};for(const i of r){const s=i.getUniforms(e,n);Object.assign(n,s)}return n}}function CV(r){let{type:t}=r;return`
#define SHADER_TYPE_`.concat(M5[t].toUpperCase(),`
`)}function EV(r){let{id:t,source:e,type:n}=r;return t&&typeof t=="string"&&e.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(t,"_").concat(M5[n],`

`):""}function SV(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=0,e="";for(const n in r){t===0&&(e+=`
// APPLICATION DEFINES
`),t++;const i=r[n];(i||Number.isFinite(i))&&(e+="#define ".concat(n.toUpperCase()," ").concat(r[n],`
`))}return t===0&&(e+=`
`),e}function TV(r,t){let e="";for(const n in r){const i=r[n];if(e+="void ".concat(i.signature,` {
`),i.header&&(e+="  ".concat(i.header)),t[n]){const s=t[n];s.sort((a,o)=>a.order-o.order);for(const a of s)e+="  ".concat(a.injection,`
`)}i.footer&&(e+="  ".concat(i.footer)),e+=`}
`}return e}function IV(r){const t={vs:{},fs:{}};return r.forEach(e=>{let n;typeof e!="string"?(n=e,e=n.hook):n={},e=e.trim();const[i,s]=e.split(":"),a=e.replace(/\(.+/,"");t[i][a]=Object.assign(n,{signature:s})}),t}const FV="void main() {gl_FragColor = vec4(0);}",R5=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,LV=`#version 300 es
`.concat(R5);function O5(r,t){t=Array.isArray(t)?t:[t];const e=r.replace(/^\s+/,"").split(/\s+/),[n,i,s]=e;if(!t.includes(n)||!i||!s)return null;const a=s.split(";")[0];return{qualifier:n,type:i,name:a}}function D5(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:t=100,input:e,inputType:n,output:i}=r;if(!e)return t===300?LV:t>300?"#version ".concat(t,`
`).concat(R5):FV;const s=UV(e,n);return t>=300?"#version ".concat(t," ").concat(t===300?"es":"",`
in `).concat(n," ").concat(e,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(n," ").concat(e,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function PV(r){switch(r){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Ta(!1),null}}function MV(r){switch(r){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Ta(!1),null}}function UV(r,t){switch(t){case"float":return"vec4(".concat(r,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(r,", 0.0, 1.0)");case"vec3":return"vec4(".concat(r,", 1.0)");case"vec4":return r;default:return Ta(!1),null}}const RV={name:"fp32",vs:`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,fs:null};function Wl(r,t){if(!r)throw new Error("math.gl assertion ".concat(t))}const OV=1/Math.PI*180,DV=1/180*Math.PI,ys={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function NV(r){let{precision:t=ys.precision}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return r=HV(r),"".concat(parseFloat(r.toPrecision(t)))}function RA(r){return Array.isArray(r)||ArrayBuffer.isView(r)&&!(r instanceof DataView)}function kV(r){return zV(r)}function QV(r){return Du(r)}function zV(r,t){return Eb(r,e=>e*DV,t)}function Du(r,t){return Eb(r,e=>e*OV,t)}function Nu(r,t,e){return Eb(r,n=>Math.max(t,Math.min(e,n)))}function z0(r,t,e){return RA(r)?r.map((n,i)=>z0(n,t[i],e)):e*t+(1-e)*r}function Xl(r,t,e){const n=ys.EPSILON;e&&(ys.EPSILON=e);try{if(r===t)return!0;if(RA(r)&&RA(t)){if(r.length!==t.length)return!1;for(let i=0;i<r.length;++i)if(!Xl(r[i],t[i]))return!1;return!0}return r&&r.equals?r.equals(t):t&&t.equals?t.equals(r):typeof r=="number"&&typeof t=="number"?Math.abs(r-t)<=ys.EPSILON*Math.max(1,Math.abs(r),Math.abs(t)):!1}finally{ys.EPSILON=n}}function HV(r){return Math.round(r/ys.EPSILON)*ys.EPSILON}function VV(r){return r.clone?r.clone():new Array(r.length)}function Eb(r,t,e){if(RA(r)){const n=r;e=e||VV(n);for(let i=0;i<e.length&&i<n.length;++i)e[i]=t(r[i],i,e);return e}return t(r)}function GV(r){function t(){var e=Reflect.construct(r,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return t.prototype=Object.create(r.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r,t}class Sb extends GV(Array){clone(){return new this.constructor().copy(this)}fromArray(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}toArray(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:RA(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(ys)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+NV(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!Xl(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){if(n===void 0)return this.lerp(this,t,e);for(let i=0;i<this.ELEMENTS;++i){const s=t[i];this[i]=s+n*(e[i]-s)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let s=0;s<this.ELEMENTS;++s)this[s]+=i[s];return this.check()}subtract(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let s=0;s<this.ELEMENTS;++s)this[s]-=i[s];return this.check()}scale(t){if(typeof t=="number")for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;else for(let e=0;e<this.ELEMENTS&&e<t.length;++e)this[e]*=t[e];return this.check()}multiplyByScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}check(){if(ys.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}get elements(){return this}}function jV(r,t){if(r.length!==t)return!1;for(let e=0;e<r.length;++e)if(!Number.isFinite(r[e]))return!1;return!0}function kn(r){if(!Number.isFinite(r))throw new Error("Invalid number ".concat(r));return r}function Ag(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(ys.debug&&!jV(r,t))throw new Error("math.gl: ".concat(e," some fields set to invalid numbers'"));return r}class Tb extends Sb{get x(){return this[0]}set x(t){this[0]=kn(t)}get y(){return this[1]}set y(t){this[1]=kn(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-t[n];e+=i*i}return kn(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return kn(e)}normalize(){const t=this.magnitude();if(t!==0)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let s=0;s<this.ELEMENTS;++s)this[s]*=i[s];return this.check()}divide(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let s=0;s<this.ELEMENTS;++s)this[s]/=i[s];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return Wl(t>=0&&t<this.ELEMENTS,"index is out of range"),kn(this[t])}setComponent(t,e){return Wl(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}var hg=1e-6,Jl=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});function qV(){var r=new Jl(2);return Jl!=Float32Array&&(r[0]=0,r[1]=0),r}function N5(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r}function KV(r,t){return r[0]=-t[0],r[1]=-t[1],r}function k5(r,t,e,n){var i=t[0],s=t[1];return r[0]=i+n*(e[0]-i),r[1]=s+n*(e[1]-s),r}function $V(r,t,e){var n=t[0],i=t[1];return r[0]=e[0]*n+e[2]*i,r[1]=e[1]*n+e[3]*i,r}function WV(r,t,e){var n=t[0],i=t[1];return r[0]=e[0]*n+e[2]*i+e[4],r[1]=e[1]*n+e[3]*i+e[5],r}function Q5(r,t,e){var n=t[0],i=t[1];return r[0]=e[0]*n+e[3]*i+e[6],r[1]=e[1]*n+e[4]*i+e[7],r}function z5(r,t,e){var n=t[0],i=t[1];return r[0]=e[0]*n+e[4]*i+e[12],r[1]=e[1]*n+e[5]*i+e[13],r}(function(){var r=qV();return function(t,e,n,i,s,a){var o,d;for(e||(e=2),n||(n=0),i?d=Math.min(i*e+n,t.length):d=t.length,o=n;o<d;o+=e)r[0]=t[o],r[1]=t[o+1],s(r,r,a),t[o]=r[0],t[o+1]=r[1];return t}})();function H5(r,t,e){const n=t[0],i=t[1],s=e[3]*n+e[7]*i||1;return r[0]=(e[0]*n+e[4]*i)/s,r[1]=(e[1]*n+e[5]*i)/s,r}function V5(r,t,e){const n=t[0],i=t[1],s=t[2],a=e[3]*n+e[7]*i+e[11]*s||1;return r[0]=(e[0]*n+e[4]*i+e[8]*s)/a,r[1]=(e[1]*n+e[5]*i+e[9]*s)/a,r[2]=(e[2]*n+e[6]*i+e[10]*s)/a,r}function XV(r,t,e){const n=t[0],i=t[1];return r[0]=e[0]*n+e[2]*i,r[1]=e[1]*n+e[3]*i,r[2]=t[2],r}function JV(r,t,e){const n=t[0],i=t[1];return r[0]=e[0]*n+e[2]*i,r[1]=e[1]*n+e[3]*i,r[2]=t[2],r[3]=t[3],r}function G5(r,t,e){const n=t[0],i=t[1],s=t[2];return r[0]=e[0]*n+e[3]*i+e[6]*s,r[1]=e[1]*n+e[4]*i+e[7]*s,r[2]=e[2]*n+e[5]*i+e[8]*s,r[3]=t[3],r}class Ib extends Tb{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;super(2),RA(t)&&arguments.length===1?this.copy(t):(ys.debug&&(kn(t),kn(e)),this[0]=t,this[1]=e)}set(t,e){return this[0]=t,this[1]=e,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return ys.debug&&(kn(t.x),kn(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return z5(this,this,t),this.check()}transformAsVector(t){return H5(this,this,t),this.check()}transformByMatrix3(t){return Q5(this,this,t),this.check()}transformByMatrix2x3(t){return WV(this,this,t),this.check()}transformByMatrix2(t){return $V(this,this,t),this.check()}}function j5(){var r=new Jl(3);return Jl!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function q5(r){var t=r[0],e=r[1],n=r[2];return Math.hypot(t,e,n)}function K5(r,t,e){var n=new Jl(3);return n[0]=r,n[1]=t,n[2]=e,n}function YV(r,t,e){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r}function ZV(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r}function tG(r,t){var e=t[0],n=t[1],i=t[2],s=e*e+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),r[0]=t[0]*s,r[1]=t[1]*s,r[2]=t[2]*s,r}function Fb(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]}function H0(r,t,e){var n=t[0],i=t[1],s=t[2],a=e[0],o=e[1],d=e[2];return r[0]=i*d-s*o,r[1]=s*a-n*d,r[2]=n*o-i*a,r}function Lb(r,t,e){var n=t[0],i=t[1],s=t[2],a=e[3]*n+e[7]*i+e[11]*s+e[15];return a=a||1,r[0]=(e[0]*n+e[4]*i+e[8]*s+e[12])/a,r[1]=(e[1]*n+e[5]*i+e[9]*s+e[13])/a,r[2]=(e[2]*n+e[6]*i+e[10]*s+e[14])/a,r}function $5(r,t,e){var n=t[0],i=t[1],s=t[2];return r[0]=n*e[0]+i*e[3]+s*e[6],r[1]=n*e[1]+i*e[4]+s*e[7],r[2]=n*e[2]+i*e[5]+s*e[8],r}function W5(r,t,e){var n=e[0],i=e[1],s=e[2],a=e[3],o=t[0],d=t[1],p=t[2],y=i*p-s*d,b=s*o-n*p,x=n*d-i*o,C=i*x-s*b,P=s*y-n*x,M=n*b-i*y,k=a*2;return y*=k,b*=k,x*=k,C*=2,P*=2,M*=2,r[0]=o+y+C,r[1]=d+b+P,r[2]=p+x+M,r}function eG(r,t,e,n){var i=[],s=[];return i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],s[0]=i[0],s[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),s[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),r[0]=s[0]+e[0],r[1]=s[1]+e[1],r[2]=s[2]+e[2],r}function rG(r,t,e,n){var i=[],s=[];return i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],s[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),s[1]=i[1],s[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),r[0]=s[0]+e[0],r[1]=s[1]+e[1],r[2]=s[2]+e[2],r}function nG(r,t,e,n){var i=[],s=[];return i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],s[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),s[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),s[2]=i[2],r[0]=s[0]+e[0],r[1]=s[1]+e[1],r[2]=s[2]+e[2],r}function iG(r,t){var e=r[0],n=r[1],i=r[2],s=t[0],a=t[1],o=t[2],d=Math.sqrt(e*e+n*n+i*i),p=Math.sqrt(s*s+a*a+o*o),y=d*p,b=y&&Fb(r,t)/y;return Math.acos(Math.min(Math.max(b,-1),1))}var sG=YV,oG=q5;(function(){var r=j5();return function(t,e,n,i,s,a){var o,d;for(e||(e=3),n||(n=0),i?d=Math.min(i*e+n,t.length):d=t.length,o=n;o<d;o+=e)r[0]=t[o],r[1]=t[o+1],r[2]=t[o+2],s(r,r,a),t[o]=r[0],t[o+1]=r[1],t[o+2]=r[2];return t}})();const Pb=[0,0,0];let V0;class se extends Tb{static get ZERO(){return V0||(V0=new se(0,0,0),Object.freeze(V0)),V0}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;super(-0,-0,-0),arguments.length===1&&RA(t)?this.copy(t):(ys.debug&&(kn(t),kn(e),kn(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return ys.debug&&(kn(t.x),kn(t.y),kn(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=kn(t)}angle(t){return iG(this,t)}cross(t){return H0(this,this,t),this.check()}rotateX(t){let{radians:e,origin:n=Pb}=t;return eG(this,this,n,e),this.check()}rotateY(t){let{radians:e,origin:n=Pb}=t;return rG(this,this,n,e),this.check()}rotateZ(t){let{radians:e,origin:n=Pb}=t;return nG(this,this,n,e),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return Lb(this,this,t),this.check()}transformAsVector(t){return V5(this,this,t),this.check()}transformByMatrix3(t){return $5(this,this,t),this.check()}transformByMatrix2(t){return XV(this,this,t),this.check()}transformByQuaternion(t){return W5(this,this,t),this.check()}}let G0;class Mb extends Tb{static get ZERO(){return G0||(G0=new Mb(0,0,0,0),Object.freeze(G0)),G0}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;super(-0,-0,-0,-0),RA(t)&&arguments.length===1?this.copy(t):(ys.debug&&(kn(t),kn(e),kn(n),kn(i)),this[0]=t,this[1]=e,this[2]=n,this[3]=i)}set(t,e,n,i){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return ys.debug&&(kn(t.x),kn(t.y),kn(t.z),kn(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=kn(t)}get w(){return this[3]}set w(t){this[3]=kn(t)}transform(t){return Lb(this,this,t),this.check()}transformByMatrix3(t){return G5(this,this,t),this.check()}transformByMatrix2(t){return JV(this,this,t),this.check()}transformByQuaternion(t){return W5(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}}class X5 extends Sb{toString(){let t="[";if(ys.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=kn(n),this}getColumn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Array(this.RANK).fill(-0);const n=t*this.RANK;for(let i=0;i<this.RANK;++i)e[i]=this[n+i];return e}setColumn(t,e){const n=t*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=e[i];return this}}function aG(){var r=new Jl(9);return Jl!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function lG(r,t){if(r===t){var e=t[1],n=t[2],i=t[5];r[1]=t[3],r[2]=t[6],r[3]=e,r[5]=t[7],r[6]=n,r[7]=i}else r[0]=t[0],r[1]=t[3],r[2]=t[6],r[3]=t[1],r[4]=t[4],r[5]=t[7],r[6]=t[2],r[7]=t[5],r[8]=t[8];return r}function cG(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5],d=t[6],p=t[7],y=t[8],b=y*a-o*p,x=-y*s+o*d,C=p*s-a*d,P=e*b+n*x+i*C;return P?(P=1/P,r[0]=b*P,r[1]=(-y*n+i*p)*P,r[2]=(o*n-i*a)*P,r[3]=x*P,r[4]=(y*e-i*d)*P,r[5]=(-o*e+i*s)*P,r[6]=C*P,r[7]=(-p*e+n*d)*P,r[8]=(a*e-n*s)*P,r):null}function uG(r){var t=r[0],e=r[1],n=r[2],i=r[3],s=r[4],a=r[5],o=r[6],d=r[7],p=r[8];return t*(p*s-a*d)+e*(-p*i+a*o)+n*(d*i-s*o)}function J5(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],d=t[5],p=t[6],y=t[7],b=t[8],x=e[0],C=e[1],P=e[2],M=e[3],k=e[4],z=e[5],V=e[6],$=e[7],tt=e[8];return r[0]=x*n+C*a+P*p,r[1]=x*i+C*o+P*y,r[2]=x*s+C*d+P*b,r[3]=M*n+k*a+z*p,r[4]=M*i+k*o+z*y,r[5]=M*s+k*d+z*b,r[6]=V*n+$*a+tt*p,r[7]=V*i+$*o+tt*y,r[8]=V*s+$*d+tt*b,r}function AG(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],d=t[5],p=t[6],y=t[7],b=t[8],x=e[0],C=e[1];return r[0]=n,r[1]=i,r[2]=s,r[3]=a,r[4]=o,r[5]=d,r[6]=x*n+C*a+p,r[7]=x*i+C*o+y,r[8]=x*s+C*d+b,r}function hG(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],d=t[5],p=t[6],y=t[7],b=t[8],x=Math.sin(e),C=Math.cos(e);return r[0]=C*n+x*a,r[1]=C*i+x*o,r[2]=C*s+x*d,r[3]=C*a-x*n,r[4]=C*o-x*i,r[5]=C*d-x*s,r[6]=p,r[7]=y,r[8]=b,r}function Y5(r,t,e){var n=e[0],i=e[1];return r[0]=n*t[0],r[1]=n*t[1],r[2]=n*t[2],r[3]=i*t[3],r[4]=i*t[4],r[5]=i*t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r}function dG(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=e+e,o=n+n,d=i+i,p=e*a,y=n*a,b=n*o,x=i*a,C=i*o,P=i*d,M=s*a,k=s*o,z=s*d;return r[0]=1-b-P,r[3]=y-z,r[6]=x+k,r[1]=y+z,r[4]=1-p-P,r[7]=C-M,r[2]=x-k,r[5]=C+M,r[8]=1-p-b,r}var Ub;(function(r){r[r.COL0ROW0=0]="COL0ROW0",r[r.COL0ROW1=1]="COL0ROW1",r[r.COL0ROW2=2]="COL0ROW2",r[r.COL1ROW0=3]="COL1ROW0",r[r.COL1ROW1=4]="COL1ROW1",r[r.COL1ROW2=5]="COL1ROW2",r[r.COL2ROW0=6]="COL2ROW0",r[r.COL2ROW1=7]="COL2ROW1",r[r.COL2ROW2=8]="COL2ROW2"})(Ub||(Ub={}));const fG=Object.freeze([1,0,0,0,1,0,0,0,1]);class Di extends X5{static get IDENTITY(){return gG()}static get ZERO(){return pG()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return Ub}constructor(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):n.length>0?this.copy([t,...n]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(fG)}fromObject(t){return this.check()}fromQuaternion(t){return dG(this,t),this.check()}set(t,e,n,i,s,a,o,d,p){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this[4]=s,this[5]=a,this[6]=o,this[7]=d,this[8]=p,this.check()}setRowMajor(t,e,n,i,s,a,o,d,p){return this[0]=t,this[1]=i,this[2]=o,this[3]=e,this[4]=s,this[5]=d,this[6]=n,this[7]=a,this[8]=p,this.check()}determinant(){return uG(this)}transpose(){return lG(this,this),this.check()}invert(){return cG(this,this),this.check()}multiplyLeft(t){return J5(this,t,this),this.check()}multiplyRight(t){return J5(this,this,t),this.check()}rotate(t){return hG(this,this,t),this.check()}scale(t){return Array.isArray(t)?Y5(this,this,t):Y5(this,this,[t,t]),this.check()}translate(t){return AG(this,this,t),this.check()}transform(t,e){let n;switch(t.length){case 2:n=Q5(e||[-0,-0],t,this);break;case 3:n=$5(e||[-0,-0,-0],t,this);break;case 4:n=G5(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Ag(n,t.length),n}transformVector(t,e){return this.transform(t,e)}transformVector2(t,e){return this.transform(t,e)}transformVector3(t,e){return this.transform(t,e)}}let j0,q0;function pG(){return j0||(j0=new Di([0,0,0,0,0,0,0,0,0]),Object.freeze(j0)),j0}function gG(){return q0||(q0=new Di,Object.freeze(q0)),q0}function mG(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function yG(r,t){if(r===t){var e=t[1],n=t[2],i=t[3],s=t[6],a=t[7],o=t[11];r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=e,r[6]=t[9],r[7]=t[13],r[8]=n,r[9]=s,r[11]=t[14],r[12]=i,r[13]=a,r[14]=o}else r[0]=t[0],r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=t[1],r[5]=t[5],r[6]=t[9],r[7]=t[13],r[8]=t[2],r[9]=t[6],r[10]=t[10],r[11]=t[14],r[12]=t[3],r[13]=t[7],r[14]=t[11],r[15]=t[15];return r}function Rb(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5],d=t[6],p=t[7],y=t[8],b=t[9],x=t[10],C=t[11],P=t[12],M=t[13],k=t[14],z=t[15],V=e*o-n*a,$=e*d-i*a,tt=e*p-s*a,pt=n*d-i*o,gt=n*p-s*o,mt=i*p-s*d,dt=y*M-b*P,Ft=y*k-x*P,Tt=y*z-C*P,ot=b*k-x*M,ct=b*z-C*M,wt=x*z-C*k,vt=V*wt-$*ct+tt*ot+pt*Tt-gt*Ft+mt*dt;return vt?(vt=1/vt,r[0]=(o*wt-d*ct+p*ot)*vt,r[1]=(i*ct-n*wt-s*ot)*vt,r[2]=(M*mt-k*gt+z*pt)*vt,r[3]=(x*gt-b*mt-C*pt)*vt,r[4]=(d*Tt-a*wt-p*Ft)*vt,r[5]=(e*wt-i*Tt+s*Ft)*vt,r[6]=(k*tt-P*mt-z*$)*vt,r[7]=(y*mt-x*tt+C*$)*vt,r[8]=(a*ct-o*Tt+p*dt)*vt,r[9]=(n*Tt-e*ct-s*dt)*vt,r[10]=(P*gt-M*tt+z*V)*vt,r[11]=(b*tt-y*gt-C*V)*vt,r[12]=(o*Ft-a*ot-d*dt)*vt,r[13]=(e*ot-n*Ft+i*dt)*vt,r[14]=(M*$-P*pt-k*V)*vt,r[15]=(y*pt-b*$+x*V)*vt,r):null}function _G(r){var t=r[0],e=r[1],n=r[2],i=r[3],s=r[4],a=r[5],o=r[6],d=r[7],p=r[8],y=r[9],b=r[10],x=r[11],C=r[12],P=r[13],M=r[14],k=r[15],z=t*a-e*s,V=t*o-n*s,$=t*d-i*s,tt=e*o-n*a,pt=e*d-i*a,gt=n*d-i*o,mt=p*P-y*C,dt=p*M-b*C,Ft=p*k-x*C,Tt=y*M-b*P,ot=y*k-x*P,ct=b*k-x*M;return z*ct-V*ot+$*Tt+tt*Ft-pt*dt+gt*mt}function Gh(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],d=t[5],p=t[6],y=t[7],b=t[8],x=t[9],C=t[10],P=t[11],M=t[12],k=t[13],z=t[14],V=t[15],$=e[0],tt=e[1],pt=e[2],gt=e[3];return r[0]=$*n+tt*o+pt*b+gt*M,r[1]=$*i+tt*d+pt*x+gt*k,r[2]=$*s+tt*p+pt*C+gt*z,r[3]=$*a+tt*y+pt*P+gt*V,$=e[4],tt=e[5],pt=e[6],gt=e[7],r[4]=$*n+tt*o+pt*b+gt*M,r[5]=$*i+tt*d+pt*x+gt*k,r[6]=$*s+tt*p+pt*C+gt*z,r[7]=$*a+tt*y+pt*P+gt*V,$=e[8],tt=e[9],pt=e[10],gt=e[11],r[8]=$*n+tt*o+pt*b+gt*M,r[9]=$*i+tt*d+pt*x+gt*k,r[10]=$*s+tt*p+pt*C+gt*z,r[11]=$*a+tt*y+pt*P+gt*V,$=e[12],tt=e[13],pt=e[14],gt=e[15],r[12]=$*n+tt*o+pt*b+gt*M,r[13]=$*i+tt*d+pt*x+gt*k,r[14]=$*s+tt*p+pt*C+gt*z,r[15]=$*a+tt*y+pt*P+gt*V,r}function K0(r,t,e){var n=e[0],i=e[1],s=e[2],a,o,d,p,y,b,x,C,P,M,k,z;return t===r?(r[12]=t[0]*n+t[4]*i+t[8]*s+t[12],r[13]=t[1]*n+t[5]*i+t[9]*s+t[13],r[14]=t[2]*n+t[6]*i+t[10]*s+t[14],r[15]=t[3]*n+t[7]*i+t[11]*s+t[15]):(a=t[0],o=t[1],d=t[2],p=t[3],y=t[4],b=t[5],x=t[6],C=t[7],P=t[8],M=t[9],k=t[10],z=t[11],r[0]=a,r[1]=o,r[2]=d,r[3]=p,r[4]=y,r[5]=b,r[6]=x,r[7]=C,r[8]=P,r[9]=M,r[10]=k,r[11]=z,r[12]=a*n+y*i+P*s+t[12],r[13]=o*n+b*i+M*s+t[13],r[14]=d*n+x*i+k*s+t[14],r[15]=p*n+C*i+z*s+t[15]),r}function Ob(r,t,e){var n=e[0],i=e[1],s=e[2];return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r[3]=t[3]*n,r[4]=t[4]*i,r[5]=t[5]*i,r[6]=t[6]*i,r[7]=t[7]*i,r[8]=t[8]*s,r[9]=t[9]*s,r[10]=t[10]*s,r[11]=t[11]*s,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function vG(r,t,e,n){var i=n[0],s=n[1],a=n[2],o=Math.hypot(i,s,a),d,p,y,b,x,C,P,M,k,z,V,$,tt,pt,gt,mt,dt,Ft,Tt,ot,ct,wt,vt,$t;return o<hg?null:(o=1/o,i*=o,s*=o,a*=o,d=Math.sin(e),p=Math.cos(e),y=1-p,b=t[0],x=t[1],C=t[2],P=t[3],M=t[4],k=t[5],z=t[6],V=t[7],$=t[8],tt=t[9],pt=t[10],gt=t[11],mt=i*i*y+p,dt=s*i*y+a*d,Ft=a*i*y-s*d,Tt=i*s*y-a*d,ot=s*s*y+p,ct=a*s*y+i*d,wt=i*a*y+s*d,vt=s*a*y-i*d,$t=a*a*y+p,r[0]=b*mt+M*dt+$*Ft,r[1]=x*mt+k*dt+tt*Ft,r[2]=C*mt+z*dt+pt*Ft,r[3]=P*mt+V*dt+gt*Ft,r[4]=b*Tt+M*ot+$*ct,r[5]=x*Tt+k*ot+tt*ct,r[6]=C*Tt+z*ot+pt*ct,r[7]=P*Tt+V*ot+gt*ct,r[8]=b*wt+M*vt+$*$t,r[9]=x*wt+k*vt+tt*$t,r[10]=C*wt+z*vt+pt*$t,r[11]=P*wt+V*vt+gt*$t,t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r)}function Z5(r,t,e){var n=Math.sin(e),i=Math.cos(e),s=t[4],a=t[5],o=t[6],d=t[7],p=t[8],y=t[9],b=t[10],x=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=s*i+p*n,r[5]=a*i+y*n,r[6]=o*i+b*n,r[7]=d*i+x*n,r[8]=p*i-s*n,r[9]=y*i-a*n,r[10]=b*i-o*n,r[11]=x*i-d*n,r}function bG(r,t,e){var n=Math.sin(e),i=Math.cos(e),s=t[0],a=t[1],o=t[2],d=t[3],p=t[8],y=t[9],b=t[10],x=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=s*i-p*n,r[1]=a*i-y*n,r[2]=o*i-b*n,r[3]=d*i-x*n,r[8]=s*n+p*i,r[9]=a*n+y*i,r[10]=o*n+b*i,r[11]=d*n+x*i,r}function t3(r,t,e){var n=Math.sin(e),i=Math.cos(e),s=t[0],a=t[1],o=t[2],d=t[3],p=t[4],y=t[5],b=t[6],x=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=s*i+p*n,r[1]=a*i+y*n,r[2]=o*i+b*n,r[3]=d*i+x*n,r[4]=p*i-s*n,r[5]=y*i-a*n,r[6]=b*i-o*n,r[7]=x*i-d*n,r}function wG(r,t){var e=t[0],n=t[1],i=t[2],s=t[4],a=t[5],o=t[6],d=t[8],p=t[9],y=t[10];return r[0]=Math.hypot(e,n,i),r[1]=Math.hypot(s,a,o),r[2]=Math.hypot(d,p,y),r}function xG(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=e+e,o=n+n,d=i+i,p=e*a,y=n*a,b=n*o,x=i*a,C=i*o,P=i*d,M=s*a,k=s*o,z=s*d;return r[0]=1-b-P,r[1]=y+z,r[2]=x-k,r[3]=0,r[4]=y-z,r[5]=1-p-P,r[6]=C+M,r[7]=0,r[8]=x+k,r[9]=C-M,r[10]=1-p-b,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function BG(r,t,e,n,i,s,a){var o=1/(e-t),d=1/(i-n),p=1/(s-a);return r[0]=s*2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s*2*d,r[6]=0,r[7]=0,r[8]=(e+t)*o,r[9]=(i+n)*d,r[10]=(a+s)*p,r[11]=-1,r[12]=0,r[13]=0,r[14]=a*s*2*p,r[15]=0,r}function CG(r,t,e,n,i){var s=1/Math.tan(t/2),a;return r[0]=s/e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0?(a=1/(n-i),r[10]=(i+n)*a,r[14]=2*i*n*a):(r[10]=-1,r[14]=-2*n),r}var EG=CG;function SG(r,t,e,n,i,s,a){var o=1/(t-e),d=1/(n-i),p=1/(s-a);return r[0]=-2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*d,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*p,r[11]=0,r[12]=(t+e)*o,r[13]=(i+n)*d,r[14]=(a+s)*p,r[15]=1,r}var TG=SG;function IG(r,t,e,n){var i,s,a,o,d,p,y,b,x,C,P=t[0],M=t[1],k=t[2],z=n[0],V=n[1],$=n[2],tt=e[0],pt=e[1],gt=e[2];return Math.abs(P-tt)<hg&&Math.abs(M-pt)<hg&&Math.abs(k-gt)<hg?mG(r):(y=P-tt,b=M-pt,x=k-gt,C=1/Math.hypot(y,b,x),y*=C,b*=C,x*=C,i=V*x-$*b,s=$*y-z*x,a=z*b-V*y,C=Math.hypot(i,s,a),C?(C=1/C,i*=C,s*=C,a*=C):(i=0,s=0,a=0),o=b*a-x*s,d=x*i-y*a,p=y*s-b*i,C=Math.hypot(o,d,p),C?(C=1/C,o*=C,d*=C,p*=C):(o=0,d=0,p=0),r[0]=i,r[1]=o,r[2]=y,r[3]=0,r[4]=s,r[5]=d,r[6]=b,r[7]=0,r[8]=a,r[9]=p,r[10]=x,r[11]=0,r[12]=-(i*P+s*M+a*k),r[13]=-(o*P+d*M+p*k),r[14]=-(y*P+b*M+x*k),r[15]=1,r)}function FG(){var r=new Jl(4);return Jl!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function LG(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r[3]=t[3]+e[3],r}function e3(r,t,e){return r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r[3]=t[3]*e,r}function PG(r){var t=r[0],e=r[1],n=r[2],i=r[3];return Math.hypot(t,e,n,i)}function MG(r){var t=r[0],e=r[1],n=r[2],i=r[3];return t*t+e*e+n*n+i*i}function UG(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=e*e+n*n+i*i+s*s;return a>0&&(a=1/Math.sqrt(a)),r[0]=e*a,r[1]=n*a,r[2]=i*a,r[3]=s*a,r}function RG(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]*t[3]}function OG(r,t,e,n){var i=t[0],s=t[1],a=t[2],o=t[3];return r[0]=i+n*(e[0]-i),r[1]=s+n*(e[1]-s),r[2]=a+n*(e[2]-a),r[3]=o+n*(e[3]-o),r}function dg(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3];return r[0]=e[0]*n+e[4]*i+e[8]*s+e[12]*a,r[1]=e[1]*n+e[5]*i+e[9]*s+e[13]*a,r[2]=e[2]*n+e[6]*i+e[10]*s+e[14]*a,r[3]=e[3]*n+e[7]*i+e[11]*s+e[15]*a,r}function DG(r,t,e){var n=t[0],i=t[1],s=t[2],a=e[0],o=e[1],d=e[2],p=e[3],y=p*n+o*s-d*i,b=p*i+d*n-a*s,x=p*s+a*i-o*n,C=-a*n-o*i-d*s;return r[0]=y*p+C*-a+b*-d-x*-o,r[1]=b*p+C*-o+x*-a-y*-d,r[2]=x*p+C*-d+y*-o-b*-a,r[3]=t[3],r}(function(){var r=FG();return function(t,e,n,i,s,a){var o,d;for(e||(e=4),n||(n=0),i?d=Math.min(i*e+n,t.length):d=t.length,o=n;o<d;o+=e)r[0]=t[o],r[1]=t[o+1],r[2]=t[o+2],r[3]=t[o+3],s(r,r,a),t[o]=r[0],t[o+1]=r[1],t[o+2]=r[2],t[o+3]=r[3];return t}})();var Db;(function(r){r[r.COL0ROW0=0]="COL0ROW0",r[r.COL0ROW1=1]="COL0ROW1",r[r.COL0ROW2=2]="COL0ROW2",r[r.COL0ROW3=3]="COL0ROW3",r[r.COL1ROW0=4]="COL1ROW0",r[r.COL1ROW1=5]="COL1ROW1",r[r.COL1ROW2=6]="COL1ROW2",r[r.COL1ROW3=7]="COL1ROW3",r[r.COL2ROW0=8]="COL2ROW0",r[r.COL2ROW1=9]="COL2ROW1",r[r.COL2ROW2=10]="COL2ROW2",r[r.COL2ROW3=11]="COL2ROW3",r[r.COL3ROW0=12]="COL3ROW0",r[r.COL3ROW1=13]="COL3ROW1",r[r.COL3ROW2=14]="COL3ROW2",r[r.COL3ROW3=15]="COL3ROW3"})(Db||(Db={}));const NG=45*Math.PI/180,kG=1,Nb=.1,kb=500,QG=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class wn extends X5{static get IDENTITY(){return HG()}static get ZERO(){return zG()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Db}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,i,s,a,o,d,p,y,b,x,C,P,M,k){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this[4]=s,this[5]=a,this[6]=o,this[7]=d,this[8]=p,this[9]=y,this[10]=b,this[11]=x,this[12]=C,this[13]=P,this[14]=M,this[15]=k,this.check()}setRowMajor(t,e,n,i,s,a,o,d,p,y,b,x,C,P,M,k){return this[0]=t,this[1]=s,this[2]=p,this[3]=C,this[4]=e,this[5]=a,this[6]=y,this[7]=P,this[8]=n,this[9]=o,this[10]=b,this[11]=M,this[12]=i,this[13]=d,this[14]=x,this[15]=k,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(QG)}fromObject(t){return this.check()}fromQuaternion(t){return xG(this,t),this.check()}frustum(t){const{left:e,right:n,bottom:i,top:s,near:a=Nb,far:o=kb}=t;return o===1/0?VG(this,e,n,i,s,a):BG(this,e,n,i,s,a,o),this.check()}lookAt(t){const{eye:e,center:n=[0,0,0],up:i=[0,1,0]}=t;return IG(this,e,n,i),this.check()}ortho(t){const{left:e,right:n,bottom:i,top:s,near:a=Nb,far:o=kb}=t;return TG(this,e,n,i,s,a,o),this.check()}orthographic(t){const{fovy:e=NG,aspect:n=kG,focalDistance:i=1,near:s=Nb,far:a=kb}=t;r3(e);const o=e/2,d=i*Math.tan(o),p=d*n;return this.ortho({left:-p,right:p,bottom:-d,top:d,near:s,far:a})}perspective(t){const{fovy:e=45*Math.PI/180,aspect:n=1,near:i=.1,far:s=500}=t;return r3(e),EG(this,e,n,i,s),this.check()}determinant(){return _G(this)}getScale(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[-0,-0,-0];return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[-0,-0,-0];return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],s=1/n[1],a=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*s,t[2]=this[2]*a,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*s,t[6]=this[6]*a,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*s,t[10]=this[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],s=1/n[1],a=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*s,t[2]=this[2]*a,t[3]=this[4]*i,t[4]=this[5]*s,t[5]=this[6]*a,t[6]=this[8]*i,t[7]=this[9]*s,t[8]=this[10]*a,t}transpose(){return yG(this,this),this.check()}invert(){return Rb(this,this),this.check()}multiplyLeft(t){return Gh(this,t,this),this.check()}multiplyRight(t){return Gh(this,this,t),this.check()}rotateX(t){return Z5(this,this,t),this.check()}rotateY(t){return bG(this,this,t),this.check()}rotateZ(t){return t3(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,e){return vG(this,this,t,e),this.check()}scale(t){return Ob(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return K0(this,this,t),this.check()}transform(t,e){return t.length===4?(e=dg(e||[-0,-0,-0,-0],t,this),Ag(e,4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;let i;switch(n){case 2:i=z5(e||[-0,-0],t,this);break;case 3:i=Lb(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Ag(i,t.length),i}transformAsVector(t,e){let n;switch(t.length){case 2:n=H5(e||[-0,-0],t,this);break;case 3:n=V5(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Ag(n,t.length),n}transformPoint(t,e){return this.transformAsPoint(t,e)}transformVector(t,e){return this.transformAsPoint(t,e)}transformDirection(t,e){return this.transformAsVector(t,e)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}}let $0,W0;function zG(){return $0||($0=new wn([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze($0)),$0}function HG(){return W0||(W0=new wn,Object.freeze(W0)),W0}function r3(r){if(r>Math.PI*2)throw Error("expected radians")}function VG(r,t,e,n,i,s){const a=2*s/(e-t),o=2*s/(i-n),d=(e+t)/(e-t),p=(i+n)/(i-n),y=-1,b=-1,x=-2*s;return r[0]=a,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o,r[6]=0,r[7]=0,r[8]=d,r[9]=p,r[10]=y,r[11]=b,r[12]=0,r[13]=0,r[14]=x,r[15]=0,r}function n3(){var r=new Jl(4);return Jl!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function GG(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function i3(r,t,e){e=e*.5;var n=Math.sin(e);return r[0]=n*t[0],r[1]=n*t[1],r[2]=n*t[2],r[3]=Math.cos(e),r}function s3(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3],o=e[0],d=e[1],p=e[2],y=e[3];return r[0]=n*y+a*o+i*p-s*d,r[1]=i*y+a*d+s*o-n*p,r[2]=s*y+a*p+n*d-i*o,r[3]=a*y-n*o-i*d-s*p,r}function jG(r,t,e){e*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(e),d=Math.cos(e);return r[0]=n*d+a*o,r[1]=i*d+s*o,r[2]=s*d-i*o,r[3]=a*d-n*o,r}function qG(r,t,e){e*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(e),d=Math.cos(e);return r[0]=n*d-s*o,r[1]=i*d+a*o,r[2]=s*d+n*o,r[3]=a*d-i*o,r}function KG(r,t,e){e*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(e),d=Math.cos(e);return r[0]=n*d+i*o,r[1]=i*d-n*o,r[2]=s*d+a*o,r[3]=a*d-s*o,r}function $G(r,t){var e=t[0],n=t[1],i=t[2];return r[0]=e,r[1]=n,r[2]=i,r[3]=Math.sqrt(Math.abs(1-e*e-n*n-i*i)),r}function X0(r,t,e,n){var i=t[0],s=t[1],a=t[2],o=t[3],d=e[0],p=e[1],y=e[2],b=e[3],x,C,P,M,k;return C=i*d+s*p+a*y+o*b,C<0&&(C=-C,d=-d,p=-p,y=-y,b=-b),1-C>hg?(x=Math.acos(C),P=Math.sin(x),M=Math.sin((1-n)*x)/P,k=Math.sin(n*x)/P):(M=1-n,k=n),r[0]=M*i+k*d,r[1]=M*s+k*p,r[2]=M*a+k*y,r[3]=M*o+k*b,r}function WG(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=e*e+n*n+i*i+s*s,o=a?1/a:0;return r[0]=-e*o,r[1]=-n*o,r[2]=-i*o,r[3]=s*o,r}function XG(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=t[3],r}function o3(r,t){var e=t[0]+t[4]+t[8],n;if(e>0)n=Math.sqrt(e+1),r[3]=.5*n,n=.5/n,r[0]=(t[5]-t[7])*n,r[1]=(t[6]-t[2])*n,r[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var s=(i+1)%3,a=(i+2)%3;n=Math.sqrt(t[i*3+i]-t[s*3+s]-t[a*3+a]+1),r[i]=.5*n,n=.5/n,r[3]=(t[s*3+a]-t[a*3+s])*n,r[s]=(t[s*3+i]+t[i*3+s])*n,r[a]=(t[a*3+i]+t[i*3+a])*n}return r}var JG=LG,YG=e3,ZG=RG,tj=OG,ej=PG,rj=MG,a3=UG,nj=function(){var r=j5(),t=K5(1,0,0),e=K5(0,1,0);return function(n,i,s){var a=Fb(i,s);return a<-.999999?(H0(r,t,i),oG(r)<1e-6&&H0(r,e,i),tG(r,r),i3(n,r,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(H0(r,i,s),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=1+a,a3(n,n))}}();(function(){var r=n3(),t=n3();return function(e,n,i,s,a,o){return X0(r,n,a,o),X0(t,i,s,o),X0(e,r,t,2*o*(1-o)),e}})(),function(){var r=aG();return function(t,e,n,i){return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=-e[0],r[5]=-e[1],r[8]=-e[2],a3(t,o3(t,r))}}();const ij=[0,0,0,1];class fg extends Sb{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;super(-0,-0,-0,-0),Array.isArray(t)&&arguments.length===1?this.copy(t):this.set(t,e,n,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,n,i){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return o3(this,t),this.check()}fromAxisRotation(t,e){return i3(this,t,e),this.check()}identity(){return GG(this),this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=kn(t)}get y(){return this[1]}set y(t){this[1]=kn(t)}get z(){return this[2]}set z(t){this[2]=kn(t)}get w(){return this[3]}set w(t){this[3]=kn(t)}len(){return ej(this)}lengthSquared(){return rj(this)}dot(t){return ZG(this,t)}rotationTo(t,e){return nj(this,t,e),this.check()}add(t){return JG(this,this,t),this.check()}calculateW(){return $G(this,this),this.check()}conjugate(){return XG(this,this),this.check()}invert(){return WG(this,this),this.check()}lerp(t,e,n){return n===void 0?this.lerp(this,t,e):(tj(this,t,e,n),this.check())}multiplyRight(t){return s3(this,this,t),this.check()}multiplyLeft(t){return s3(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,t===0&&(this[3]=1),this.check()}rotateX(t){return jG(this,this,t),this.check()}rotateY(t){return qG(this,this,t),this.check()}rotateZ(t){return KG(this,this,t),this.check()}scale(t){return YG(this,this,t),this.check()}slerp(t,e,n){let i,s,a;switch(arguments.length){case 1:({start:i=ij,target:s,ratio:a}=t);break;case 2:i=this,s=t,a=e;break;default:i=t,s=e,a=n}return X0(this,i,s,a),this.check()}transformVector4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Mb;return DG(e,t,this),Ag(e,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}}const pg={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},l3=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,sj={lightSources:{}};function Qb(){let{color:r=[0,0,0],intensity:t=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return r.map(e=>e*t/255)}function oj(r){let{ambientLight:t,pointLights:e=[],directionalLights:n=[]}=r;const i={};return t?i["lighting_uAmbientLight.color"]=Qb(t):i["lighting_uAmbientLight.color"]=[0,0,0],e.forEach((s,a)=>{i["lighting_uPointLight[".concat(a,"].color")]=Qb(s),i["lighting_uPointLight[".concat(a,"].position")]=s.position,i["lighting_uPointLight[".concat(a,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=e.length,n.forEach((s,a)=>{i["lighting_uDirectionalLight[".concat(a,"].color")]=Qb(s),i["lighting_uDirectionalLight[".concat(a,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=n.length,i}function c3(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sj;if("lightSources"in r){const{ambientLight:t,pointLights:e,directionalLights:n}=r.lightSources||{};return t||e&&e.length>0||n&&n.length>0?Object.assign({},oj({ambientLight:t,pointLights:e,directionalLights:n}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in r){const t={pointLights:[],directionalLights:[]};for(const e of r.lights||[])switch(e.type){case"ambient":t.ambientLight=e;break;case"directional":t.directionalLights.push(e);break;case"point":t.pointLights.push(e);break}return c3({lightSources:t})}return{}}const zb={name:"lights",vs:l3,fs:l3,getUniforms:c3,defines:{MAX_LIGHTS:3}},aj={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1};function lj(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:aj;const t={};if(r.pickingSelectedColor!==void 0)if(!r.pickingSelectedColor)t.picking_uSelectedColorValid=0;else{const e=r.pickingSelectedColor.slice(0,3);t.picking_uSelectedColorValid=1,t.picking_uSelectedColor=e}if(r.pickingHighlightColor){const e=Array.from(r.pickingHighlightColor,n=>n/255);Number.isFinite(e[3])||(e[3]=1),t.picking_uHighlightColor=e}return r.pickingActive!==void 0&&(t.picking_uActive=!!r.pickingActive,t.picking_uAttribute=!!r.pickingAttribute),t}const cj={name:"picking",vs:`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,fs:`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,getUniforms:lj},u3=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,uj={};function Aj(r){const{ambient:t=.35,diffuse:e=.6,shininess:n=32,specularColor:i=[30,30,30]}=r;return{lighting_uAmbient:t,lighting_uDiffuse:e,lighting_uShininess:n,lighting_uSpecularColor:i.map(s=>s/255)}}function A3(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:uj;if(!("material"in r))return{};const{material:t}=r;return t?Aj(t):{lighting_uEnabled:!1}}const hj={name:"gouraud-lighting",dependencies:[zb],vs:u3,defines:{LIGHTING_VERTEX:1},getUniforms:A3},dj={name:"phong-lighting",dependencies:[zb],fs:u3,defines:{LIGHTING_FRAGMENT:1},getUniforms:A3},Hb={name:"pbr",vs:`uniform mat4 u_MVPMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_NormalMatrix;

varying vec3 pbr_vPosition;
varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
# ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
# else
varying vec3 pbr_vNormal;
# endif
#endif

void pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)
{
  vec4 pos = u_ModelMatrix * position;
  pbr_vPosition = vec3(pos.xyz) / pos.w;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));
  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));
  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;
  pbr_vTBN = mat3(tangentW, bitangentW, normalW);
#else
  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));
#endif
#endif

#ifdef HAS_UV
  pbr_vUV = uv;
#else
  pbr_vUV = vec2(0.,0.);
#endif
}
`,fs:`#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)
# error PBR fragment shader: Texture LOD is not available
#endif

#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)
# error PBR fragment shader: Derivatives are not available
#endif


#if (__VERSION__ < 300)
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)
#else
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)
#endif

precision highp float;

uniform bool pbr_uUnlit;

#ifdef USE_IBL
uniform samplerCube u_DiffuseEnvSampler;
uniform samplerCube u_SpecularEnvSampler;
uniform sampler2D u_brdfLUT;
uniform vec2 u_ScaleIBLAmbient;
#endif

#ifdef HAS_BASECOLORMAP
uniform sampler2D u_BaseColorSampler;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D u_NormalSampler;
uniform float u_NormalScale;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D u_EmissiveSampler;
uniform vec3 u_EmissiveFactor;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D u_MetallicRoughnessSampler;
#endif
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D u_OcclusionSampler;
uniform float u_OcclusionStrength;
#endif

#ifdef ALPHA_CUTOFF
uniform float u_AlphaCutoff;
#endif

uniform vec2 u_MetallicRoughnessValues;
uniform vec4 u_BaseColorFactor;

uniform vec3 u_Camera;
#ifdef PBR_DEBUG
uniform vec4 u_ScaleDiffBaseMR;
uniform vec4 u_ScaleFGDSpec;
#endif

varying vec3 pbr_vPosition;

varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
#else
varying vec3 pbr_vNormal;
#endif
#endif


struct PBRInfo
{
  float NdotL;
  float NdotV;
  float NdotH;
  float LdotH;
  float VdotH;
  float perceptualRoughness;
  float metalness;
  vec3 reflectance0;
  vec3 reflectance90;
  float alphaRoughness;
  vec3 diffuseColor;
  vec3 specularColor;
  vec3 n;
  vec3 v;
};

const float M_PI = 3.141592653589793;
const float c_MinRoughness = 0.04;

vec4 SRGBtoLINEAR(vec4 srgbIn)
{
#ifdef MANUAL_SRGB
#ifdef SRGB_FAST_APPROXIMATION
  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));
#else
  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);
  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );
#endif
  return vec4(linOut,srgbIn.w);;
#else
  return srgbIn;
#endif
}

vec3 getNormal()
{
#ifndef HAS_TANGENTS
  vec3 pos_dx = dFdx(pbr_vPosition);
  vec3 pos_dy = dFdy(pbr_vPosition);
  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));
  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));
  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);

#ifdef HAS_NORMALS
  vec3 ng = normalize(pbr_vNormal);
#else
  vec3 ng = cross(pos_dx, pos_dy);
#endif

  t = normalize(t - ng * dot(ng, t));
  vec3 b = normalize(cross(ng, t));
  mat3 tbn = mat3(t, b, ng);
#else
  mat3 tbn = pbr_vTBN;
#endif

#ifdef HAS_NORMALMAP
  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;
  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));
#else
  vec3 n = normalize(tbn[2].xyz);
#endif

  return n;
}


#ifdef USE_IBL
vec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)
{
  float mipCount = 9.0;
  float lod = (pbrInputs.perceptualRoughness * mipCount);
  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,
    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;
  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;

#ifdef USE_TEX_LOD
  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;
#else
  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;
#endif

  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;
  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);
  diffuse *= u_ScaleIBLAmbient.x;
  specular *= u_ScaleIBLAmbient.y;

  return diffuse + specular;
}
#endif


vec3 diffuse(PBRInfo pbrInputs)
{
  return pbrInputs.diffuseColor / M_PI;
}

vec3 specularReflection(PBRInfo pbrInputs)
{
  return pbrInputs.reflectance0 +
    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *
    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);
}



float geometricOcclusion(PBRInfo pbrInputs)
{
  float NdotL = pbrInputs.NdotL;
  float NdotV = pbrInputs.NdotV;
  float r = pbrInputs.alphaRoughness;

  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));
  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));
  return attenuationL * attenuationV;
}





float microfacetDistribution(PBRInfo pbrInputs)
{
  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;
  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;
  return roughnessSq / (M_PI * f * f);
}

void PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {
  pbrInputs.NdotL = 1.0;
  pbrInputs.NdotH = 0.0;
  pbrInputs.LdotH = 0.0;
  pbrInputs.VdotH = 1.0;
}

void PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {
  vec3 n = pbrInputs.n;
  vec3 v = pbrInputs.v;
  vec3 l = normalize(lightDirection);
  vec3 h = normalize(l+v);

  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);
  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);
  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);
  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);
}

void PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {
  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);
  PBRInfo_setDirectionalLight(pbrInputs, light_direction);
}

vec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {
  vec3 F = specularReflection(pbrInputs);
  float G = geometricOcclusion(pbrInputs);
  float D = microfacetDistribution(pbrInputs);
  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);
  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);
  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);
}

vec4 pbr_filterColor(vec4 colorUnused)
{
#ifdef HAS_BASECOLORMAP
  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;
#else
  vec4 baseColor = u_BaseColorFactor;
#endif

#ifdef ALPHA_CUTOFF
  if (baseColor.a < u_AlphaCutoff) {
    discard;
  }
#endif

  vec3 color = vec3(0, 0, 0);

  if(pbr_uUnlit){
    color.rgb = baseColor.rgb;
  }
  else{


    float perceptualRoughness = u_MetallicRoughnessValues.y;
    float metallic = u_MetallicRoughnessValues.x;
#ifdef HAS_METALROUGHNESSMAP

    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);
    perceptualRoughness = mrSample.g * perceptualRoughness;
    metallic = mrSample.b * metallic;
#endif
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);
    metallic = clamp(metallic, 0.0, 1.0);

    float alphaRoughness = perceptualRoughness * perceptualRoughness;

    vec3 f0 = vec3(0.04);
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);
    diffuseColor *= 1.0 - metallic;
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);



    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);
    vec3 specularEnvironmentR0 = specularColor.rgb;
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;

    vec3 n = getNormal();
    vec3 v = normalize(u_Camera - pbr_vPosition);

    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);
    vec3 reflection = -normalize(reflect(v, n));

    PBRInfo pbrInputs = PBRInfo(
      0.0,
      NdotV,
      0.0,
      0.0,
      0.0,
      perceptualRoughness,
      metallic,
      specularEnvironmentR0,
      specularEnvironmentR90,
      alphaRoughness,
      diffuseColor,
      specularColor,
      n,
      v
    );

#ifdef USE_LIGHTS
    PBRInfo_setAmbientLight(pbrInputs);
    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {
      if (i < lighting_uDirectionalLightCount) {
        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);
        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);
      }
    }
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {
      if (i < lighting_uPointLightCount) {
        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);
        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));
        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);
      }
    }
#endif
#ifdef USE_IBL
    color += getIBLContribution(pbrInputs, n, reflection);
#endif
#ifdef HAS_OCCLUSIONMAP
    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;
    color = mix(color, color * ao, u_OcclusionStrength);
#endif

#ifdef HAS_EMISSIVEMAP
    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;
    color += emissive;
#endif

#ifdef PBR_DEBUG





    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);
    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);
    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);
#endif

  }

  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);
}
`,defines:{LIGHTING_FRAGMENT:1},dependencies:[zb]},fj={name:"transform",vs:`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,fs:null};class gg{static getDefaultProgramManager(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new gg(t),t.luma.defaultProgramManager}constructor(t){this.gl=t,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(t){this._defaultModules.find(e=>e.name===t.name)||this._defaultModules.push(t),this.stateHash++}removeDefaultModule(t){const e=typeof t=="string"?t:t.name;this._defaultModules=this._defaultModules.filter(n=>n.name!==e),this.stateHash++}addShaderHook(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t),this.stateHash++}get(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:e="",fs:n="",defines:i={},inject:s={},varyings:a=[],bufferMode:o=35981,transpileToGLSL100:d=!1}=t,p=this._getModuleList(t.modules),y=this._getHash(e),b=this._getHash(n),x=p.map($=>this._getHash($.name)).sort(),C=a.map($=>this._getHash($)),P=Object.keys(i).sort(),M=Object.keys(s).sort(),k=[],z=[];for(const $ of P)k.push(this._getHash($)),k.push(this._getHash(i[$]));for(const $ of M)z.push(this._getHash($)),z.push(this._getHash(s[$]));const V="".concat(y,"/").concat(b,"D").concat(k.join("/"),"M").concat(x.join("/"),"I").concat(z.join("/"),"V").concat(C.join("/"),"H").concat(this.stateHash,"B").concat(o).concat(d?"T":"");if(!this._programCache[V]){const $=xV(this.gl,{vs:e,fs:n,modules:p,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:d});this._programCache[V]=new m5(this.gl,{hash:V,vs:$.vs,fs:$.fs,varyings:a,bufferMode:o}),this._getUniforms[V]=$.getUniforms||(tt=>{}),this._useCounts[V]=0}return this._useCounts[V]++,this._programCache[V]}getUniforms(t){return this._getUniforms[t.hash]||null}release(t){const e=t.hash;this._useCounts[e]--,this._useCounts[e]===0&&(this._programCache[e].delete(),delete this._programCache[e],delete this._getUniforms[e],delete this._useCounts[e])}_getHash(t){return this._hashes[t]===void 0&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}_getModuleList(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=new Array(this._defaultModules.length+t.length),n={};let i=0;for(let s=0,a=this._defaultModules.length;s<a;++s){const o=this._defaultModules[s],d=o.name;e[i++]=o,n[d]=!0}for(let s=0,a=t.length;s<a;++s){const o=t[s],d=o.name;n[d]||(e[i++]=o,n[d]=!0)}return e.length=i,e}}const pj={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function gj(r,t,e){const n={};let i=t.indices;for(const s in t.attributes){const a=t.attributes[s],o=mj(s);if(s==="indices")i=a;else if(a.constant)n[o]=a.value;else{const d=a.value,p={...a};delete p.value,n[o]=[new ni(r,d),p],yj(s,p)}}if(i){const s=i.value||i;ir(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const a={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};n.indices=[new ni(r,{data:s,target:34963}),a]}return n}function mj(r,t){const{attributeMap:e=pj}={};return e&&e[r]||r}function yj(r,t){let e;switch(r){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":e="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":e="vectors";break}switch(e){case"vectors":t.size=t.size||3;break;case"uvs":t.size=t.size||2;break}ir(Number.isFinite(t.size),"attribute ".concat(r," needs size"))}const of=2,_j=1e4,vj="Model needs drawMode and vertexCount",h3=()=>{},bj={};class af{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:n=Uu("model")}=e;ir(I0(t)),this.id=n,this.gl=t,this.id=e.id||Uu("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(e)}initialize(t){this.props={},this.programManager=t.programManager||gg.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:e=null,vs:n,fs:i,modules:s,defines:a,inject:o,varyings:d,bufferMode:p,transpileToGLSL100:y}=t;this.programProps={program:e,vs:n,fs:i,modules:s,defines:a,inject:o,varyings:d,bufferMode:p,transpileToGLSL100:y},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(t.moduleSettings))),this.drawMode=t.drawMode!==void 0?t.drawMode:4,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced||t.instanceCount>0,this._setModelProps(t),this.geometry={},ir(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),vj)}setProps(t){this._setModelProps(t)}delete(){for(const t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(t){const{program:e,vs:n,fs:i,modules:s,defines:a,inject:o,varyings:d,bufferMode:p,transpileToGLSL100:y}=t;this.programProps={program:e,vs:n,fs:i,modules:s,defines:a,inject:o,varyings:d,bufferMode:p,transpileToGLSL100:y},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(t){return this.drawMode=t,this}setVertexCount(t){return ir(Number.isFinite(t)),this.vertexCount=t,this}setInstanceCount(t){return ir(Number.isFinite(t)),this.instanceCount=t,this}setGeometry(t){return this.drawMode=t.drawMode,this.vertexCount=t.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=gj(this.gl,t),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(tf(t))return this;const e={};for(const n in t){const i=t[n];e[n]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(e),this}setUniforms(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,t),this}getModuleUniforms(t){this._checkProgram();const e=this.programManager.getUniforms(this.program);return e?e(t):{}}updateModuleSettings(t){const e=this.getModuleUniforms(t||{});return this.setUniforms(e)}clear(t){return Ab(this.program.gl,t),this}draw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:e=null,framebuffer:n,uniforms:i={},attributes:s={},transformFeedback:a=this.transformFeedback,parameters:o={},vertexArray:d=this.vertexArray}=t;this.setAttributes(s),this.updateModuleSettings(e),this.setUniforms(i);let p;vr.priority>=of&&(p=this._logDrawCallStart(of));const y=this.vertexArray.getDrawParams(),{isIndexed:b=y.isIndexed,indexType:x=y.indexType,indexOffset:C=y.indexOffset,vertexArrayInstanced:P=y.isInstanced}=this.props;P&&!this.isInstanced&&vr.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:M,instanceCount:k}=this,{onBeforeRender:z=h3,onAfterRender:V=h3}=this.props;z(),this.program.setUniforms(this.uniforms);const $=this.program.draw(Object.assign(bj,t,{logPriority:p,uniforms:null,framebuffer:n,parameters:o,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:d,transformFeedback:a,isIndexed:b,indexType:x,isInstanced:M,instanceCount:k,offset:b?C:0}));return V(),vr.priority>=of&&this._logDrawCallEnd(p,d,n),$}transform(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:e=!0,feedbackBuffers:n,unbindModels:i=[]}=t;let{parameters:s}=t;n&&this._setFeedbackBuffers(n),e&&(s=Object.assign({},s,{35977:e})),i.forEach(a=>a.vertexArray.unbindBuffers());try{this.draw(Object.assign({},t,{parameters:s}))}finally{i.forEach(a=>a.vertexArray.bindBuffers())}return this}render(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return vr.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(t).draw()}_setModelProps(t){Object.assign(this.props,t),"uniforms"in t&&this.setUniforms(t.uniforms),"pickable"in t&&(this.pickable=t.pickable),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:e}=this.programProps;if(e)this._managedProgram=!1;else{const{vs:n,fs:i,modules:s,inject:a,defines:o,varyings:d,bufferMode:p,transpileToGLSL100:y}=this.programProps;e=this.programManager.get({vs:n,fs:i,modules:s,inject:a,defines:o,varyings:d,bufferMode:p,transpileToGLSL100:y}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}ir(e instanceof m5,"Model needs a program"),this._programDirty=!1,e!==this.program&&(this.program=e,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new N9(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const t in this.geometryBuffers){const e=this.geometryBuffers[t][0]||this.geometryBuffers[t];e instanceof ni&&e.delete()}}_setAnimationProps(t){this.animated&&ir(t,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(tf(t))return this;const{gl:e}=this.program;return this.transformFeedback=this.transformFeedback||new y5(e,{program:this.program}),this.transformFeedback.setBuffers(t),this}_logDrawCallStart(t){const e=t>3?0:_j;if(!(Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),vr.group(of,">>> DRAWING MODEL ".concat(this.id),{collapsed:vr.level<=2})(),t}_logDrawCallEnd(t,e,n,i){if(t===void 0)return;const s=z9({vertexArray:e,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:a,unusedTable:o,unusedCount:d}=_5({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:p,count:y}=_5({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});y>0&&vr.log("MISSING UNIFORMS",Object.keys(p))(),d>0&&vr.log("UNUSED UNIFORMS",Object.keys(o))();const b=V9(this.vertexArray.configuration);vr.table(t,s)(),vr.table(t,a)(),vr.table(t+1,b)(),i&&i.log({logLevel:of,message:"Rendered to ".concat(i.id)}),vr.groupEnd(of)()}}class wj{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=t,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}setupResources(t){for(const e of this.bindings)this._setupTransformFeedback(e,t)}updateModelProps(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:e}=this;return e.length>0&&(t=Object.assign({},t,{varyings:e})),t}getDrawOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:i}=e;return{attributes:Object.assign({},n,t.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(t)}getBuffer(t){const{feedbackBuffers:e}=this.bindings[this.currentIndex],n=t?e[t]:null;return n?n instanceof ni?n:n.buffer:null}getData(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:e}=t,n=this.getBuffer(e);return n?n.getData():null}delete(){for(const t in this.resources)this.resources[t].delete()}_initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&ir(fn(this.gl))}_getFeedbackBuffers(t){const{sourceBuffers:e={}}=t,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in e&&(n[s]=i)}Object.assign(n,t.feedbackBuffers);for(const i in n){const s=n[i];if(typeof s=="string"){const a=e[s],{byteLength:o,usage:d,accessor:p}=a;n[i]=this._createNewBuffer(i,{byteLength:o,usage:d,accessor:p})}}return n}_setupBuffers(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:e=null}=t;Object.assign(this.feedbackMap,t.feedbackMap);const n=this._getFeedbackBuffers(t);this._updateBindings({sourceBuffers:e,feedbackBuffers:n})}_setupTransformFeedback(t,e){let{model:n}=e;const{program:i}=n;t.transformFeedback=new y5(this.gl,{program:i,buffers:t.feedbackBuffers})}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this.feedbackMap){const{sourceBuffers:e,feedbackBuffers:n}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:e,feedbackBuffers:n})}}_updateBinding(t,e){return t?(Object.assign(t.sourceBuffers,e.sourceBuffers),Object.assign(t.feedbackBuffers,e.feedbackBuffers),t.transformFeedback&&t.transformFeedback.setBuffers(t.feedbackBuffers),t):{sourceBuffers:Object.assign({},e.sourceBuffers),feedbackBuffers:Object.assign({},e.feedbackBuffers)}}_swapBuffers(t){if(!this.feedbackMap)return null;const e=Object.assign({},t.sourceBuffers),n=Object.assign({},t.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];e[i]=t.feedbackBuffers[s],n[s]=t.sourceBuffers[i],ir(n[s]instanceof ni)}return{sourceBuffers:e,feedbackBuffers:n}}_createNewBuffer(t,e){const n=new ni(this.gl,e);return this.resources[t]&&this.resources[t].delete(),this.resources[t]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}const xj="transform_uSampler_",J0="transform_uSize_",d3="transform_position";function Bj(r){let{vs:t,sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}=r,a=Object.keys(e).length,o=null;const d={};let p=t,y={};if(a>0||n){const b=p.split(`
`),x=b.slice();if(b.forEach((C,P,M)=>{if(a>0){const k=Ij(C,e);if(k){const{updatedLine:z,inject:V}=k;x[P]=z,y=xb([y,V]),Object.assign(d,k.samplerTextureMap),a--}}n&&!o&&(o=Tj(C,n))}),n){ir(i);const C="".concat(J0).concat(n),P="uniform vec2 ".concat(C,`;
`),M="     vec2 ".concat(d3," = transform_getPos(").concat(C,`);
     gl_Position = vec4(`).concat(d3,`, 0, 1.);
`);y=xb([y,{"vs:#decl":P,"vs:#main-start":M}])}p=x.join(`
`)}return{vs:p,targetTextureType:o,inject:y,samplerTextureMap:d}}function Cj(r){let{sourceTextureMap:t,targetTextureVarying:e,targetTexture:n}=r;const i={};let s,a;e&&({width:s,height:a}=n,i["".concat(J0).concat(e)]=[s,a]);for(const o in t)({width:s,height:a}=t[o]),i["".concat(J0).concat(o)]=[s,a];return i}function Ej(r){return O5(r,["attribute","in"])}function Sj(r){const t="".concat(xj).concat(r),e="".concat(J0).concat(r),n="  uniform sampler2D ".concat(t,`;
  uniform vec2 `).concat(e,";");return{samplerName:t,sizeName:e,uniformDeclerations:n}}function Tj(r,t){const e=O5(r,["varying","out"]);return e&&e.name===t?e.type:null}function Ij(r,t){const e={},n=Ej(r);if(!n)return null;const{type:i,name:s}=n;if(s&&t[s]){const a="// ".concat(r," => Replaced by Transform with a sampler"),{samplerName:o,sizeName:d,uniformDeclerations:p}=Sj(s),y=PV(i),b="  ".concat(i," ").concat(s," = transform_getInput(").concat(o,", ").concat(d,").").concat(y,`;
`);return e[o]=s,{updatedLine:a,inject:{"vs:#decl":p,"vs:#main-start":b},samplerTextureMap:e}}return null}const Fj={10241:9728,10240:9728,10242:33071,10243:33071},Lj="transform_output";class Pj{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=t,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}updateModelProps(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=this._processVertexShader(t);return Object.assign({},t,e)}getDrawOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:e,sourceTextures:n,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],a=Object.assign({},e,t.attributes),o=Object.assign({},t.uniforms),d=Object.assign({},t.parameters);let p=t.discard;if(this.hasSourceTextures||this.hasTargetTexture){a.transform_elementID=this.elementIDBuffer;for(const b in this.samplerTextureMap){const x=this.samplerTextureMap[b];o[b]=n[x]}this._setSourceTextureParameters();const y=Cj({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(o,y)}return this.hasTargetTexture&&(p=!1,d.viewport=[0,0,i.width,i.height]),{attributes:a,framebuffer:i,uniforms:o,discard:p,parameters:d}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(t)}getTargetTexture(){const{targetTexture:t}=this.bindings[this.currentIndex];return t}getData(){let{packed:t=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:e}=this.bindings[this.currentIndex],n=L0(e);if(!t)return n;const i=n.constructor,s=MV(this.targetTextureType),a=new i(n.length*s/4);let o=0;for(let d=0;d<n.length;d+=4)for(let p=0;p<s;p++)a[o++]=n[d+p];return a}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:e,_swapTexture:n}=t;this._swapTexture=n,this.targetTextureVarying=e,this.hasTargetTexture=e,this._setupTextures(t)}_createTargetTexture(t){const{sourceTextures:e,textureOrReference:n}=t;if(n instanceof Ca)return n;const i=e[n];return i?(this._targetRefTexName=n,this._createNewTexture(i)):null}_setupTextures(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:e,_sourceTextures:n={},_targetTexture:i}=t,s=this._createTargetTexture({sourceTextures:n,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:e,sourceTextures:n,targetTexture:s}),"elementCount"in t&&this._updateElementIDBuffer(t.elementCount)}_updateElementIDBuffer(t){if(typeof t!="number"||this.elementCount>=t)return;const e=new Float32Array(t);e.forEach((n,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new ni(this.gl,{data:e,accessor:{size:1}}),this.elementCount=t}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this._swapTexture){const{sourceTextures:e,targetTexture:n}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:e,targetTexture:n})}}_updateBinding(t,e){const{sourceBuffers:n,sourceTextures:i,targetTexture:s}=e;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,i),Object.assign(t.sourceBuffers,n),s){t.targetTexture=s;const{width:a,height:o}=s,{framebuffer:d}=t;d?(d.update({attachments:{36064:s},resizeAttachments:!1}),d.resize({width:a,height:o})):t.framebuffer=new gs(this.gl,{id:"transform-framebuffer",width:a,height:o,attachments:{36064:s}})}return t}_setSourceTextureParameters(){const t=this.currentIndex,{sourceTextures:e}=this.bindings[t];for(const n in e)e[n].setParameters(Fj)}_swapTextures(t){if(!this._swapTexture)return null;const e=Object.assign({},t.sourceTextures);e[this._swapTexture]=t.targetTexture;const n=t.sourceTextures[this._swapTexture];return{sourceTextures:e,targetTexture:n}}_createNewTexture(t){const e=S7(t,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=e,e}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:e,targetTexture:n}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:a,inject:o,samplerTextureMap:d}=Bj({vs:t.vs,sourceTextureMap:e,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),p=xb([t.inject||{},o]);this.targetTextureType=a,this.samplerTextureMap=d;const y=t._fs||D5({version:u5(i),input:this.targetTextureVarying,inputType:a,output:Lj}),b=this.hasSourceTextures||this.targetTextureVarying?[fj].concat(t.modules||[]):t.modules;return{vs:i,fs:y,modules:b,uniforms:s,inject:p}}}class Vb{static isSupported(t){return fn(t)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=t,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(e),Object.seal(this)}delete(){const{model:t,bufferTransform:e,textureTransform:n}=this;t&&t.delete(),e&&e.delete(),n&&n.delete()}run(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:e=!0}=t,n=this._updateDrawOptions(t);e&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let t=!1;const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)t=t||n.swap();ir(t,"Nothing to swap")}getBuffer(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(t)}getData(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e){const i=n.getData(t);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in t&&this.model.setVertexCount(t.elementCount);const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)n.update(t)}_initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:e}=this;this._buildResourceTransforms(e,t),t=this._updateModelProps(t),this.model=new af(e,Object.assign({},t,{fs:t.fs||D5({version:u5(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=i.updateModelProps(e);return e}_buildResourceTransforms(t,e){Mj(e)&&(this.bufferTransform=new wj(t,e)),Uj(e)&&(this.textureTransform=new Pj(t,e)),ir(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=Object.assign(e,i.getDrawOptions(e));return e}}function Mj(r){return!!(!tf(r.feedbackBuffers)||!tf(r.feedbackMap)||r.varyings&&r.varyings.length>0)}function Uj(r){return!!(!tf(r._sourceTextures)||r._targetTexture||r._targetTextureVarying)}const f3={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class mg{static get DRAW_MODE(){return f3}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:e=Uu("geometry"),drawMode:n=f3.TRIANGLES,attributes:i={},indices:s=null,vertexCount:a=null}=t;this.id=e,this.drawMode=n|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=a||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return"Geometry ".concat(this.id," attribute ").concat(t)}_setAttributes(t,e){e&&(this.indices=ArrayBuffer.isView(e)?{value:e,size:1}:e);for(const n in t){let i=t[n];i=ArrayBuffer.isView(i)?{value:i}:i,ir(ArrayBuffer.isView(i.value),"".concat(this._print(n),": must be typed array or object with value as typed array")),(n==="POSITION"||n==="positions")&&!i.size&&(i.size=3),n==="indices"?(ir(!this.indices),this.indices=i):this.attributes[n]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(t,e){if(e)return e.value.length;let n=1/0;for(const i in t){const s=t[i],{value:a,size:o,constant:d}=s;!d&&a&&o>=1&&(n=Math.min(n,a.length/o))}return ir(Number.isFinite(n)),n}}let Rj=1,Oj=1;class p3{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(t){const{delay:e=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=t,a=Rj++,o={time:0,delay:e,duration:n,rate:i,repeat:s};return this._setChannelTime(o,this.time),this.channels.set(a,o),a}removeChannel(t){this.channels.delete(t);for(const[e,n]of this.animations)n.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return e===void 0?!1:this.time>=e.delay+e.duration*e.repeat}getTime(t){if(t===void 0)return this.time;const e=this.channels.get(t);return e===void 0?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const i of e)this._setChannelTime(i,this.time);const n=this.animations.values();for(const i of n){const{animation:s,channel:a}=i;s.setTime(this.getTime(a))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,e){const n=Oj++;return this.animations.set(n,{animation:t,channel:e}),t.setTime(this.getTime(e)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const n=e-t.delay,i=t.duration*t.repeat;n>=i?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}}const Dj=[255,255,255],Nj=1;let kj=0;class g3{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};j(this,"id",void 0),j(this,"color",void 0),j(this,"intensity",void 0),j(this,"type","ambient");const{color:e=Dj}=t,{intensity:n=Nj}=t;this.id=t.id||"ambient-".concat(kj++),this.color=e,this.intensity=n}}const Qj=[255,255,255],zj=1,Hj=[0,0,-1];let Vj=0;class m3{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};j(this,"id",void 0),j(this,"color",void 0),j(this,"intensity",void 0),j(this,"type","directional"),j(this,"direction",void 0),j(this,"shadow",void 0);const{color:e=Qj}=t,{intensity:n=zj}=t,{direction:i=Hj}=t,{_shadow:s=!1}=t;this.id=t.id||"directional-".concat(Vj++),this.color=e,this.intensity=n,this.type="directional",this.direction=new se(i).normalize().toArray(),this.shadow=s}getProjectedLight(t){return this}}class Gj{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{id:"pass"};j(this,"id",void 0),j(this,"gl",void 0),j(this,"props",void 0);const{id:n}=e;this.id=n,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(t){}cleanup(){}}class Gb extends Gj{constructor(){super(...arguments),j(this,"_lastRenderIndex",-1)}render(t){const e=this.gl;return Mu(e,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{target:e,moduleParameters:n,viewports:i,views:s,onViewportActive:a,clearStack:o=!0,clearCanvas:d=!0}=t;t.pass=t.pass||"unknown";const p=this.gl;d&&qj(p,e),o&&(this._lastRenderIndex=-1);const y=[];for(const b of i){const x=s&&s[b.id];a==null||a(b);const C=this._getDrawLayerParams(b,t),P=b.subViewports||[b];for(const M of P){const k=this._drawLayersInViewport(p,{target:e,moduleParameters:n,viewport:M,view:x,pass:t.pass,layers:t.layers},C);y.push(k)}}return y}_getDrawLayerParams(t,e){let{layers:n,pass:i,isPicking:s=!1,layerFilter:a,cullRect:o,effects:d,moduleParameters:p}=e,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const b=[],x=y3(this._lastRenderIndex+1),C={layer:n[0],viewport:t,isPicking:s,renderPass:i,cullRect:o},P={};for(let M=0;M<n.length;M++){const k=n[M],z=this._shouldDrawLayer(k,C,a,P),V={shouldDrawLayer:z};z&&!y&&(V.layerRenderIndex=x(k,z),V.moduleParameters=this._getModuleParameters(k,d,i,p),V.layerParameters=this.getLayerParameters(k,M,t)),b[M]=V}return b}_drawLayersInViewport(t,e,n){let{layers:i,moduleParameters:s,pass:a,target:o,viewport:d,view:p}=e;const y=jj(t,{moduleParameters:s,target:o,viewport:d});if(p&&p.props.clear){const x=p.props.clear===!0?{color:!0,depth:!0}:p.props.clear;$l(t,{scissorTest:!0,scissor:y},()=>Ab(t,x))}const b={totalCount:i.length,visibleCount:0,compositeCount:0,pickableCount:0};Mu(t,{viewport:y});for(let x=0;x<i.length;x++){const C=i[x],{shouldDrawLayer:P,layerRenderIndex:M,moduleParameters:k,layerParameters:z}=n[x];if(P&&C.props.pickable&&b.pickableCount++,C.isComposite)b.compositeCount++;else if(P){b.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,M),k.viewport=d;try{C._drawLayer({moduleParameters:k,uniforms:{layerIndex:M},parameters:z})}catch(V){C.raiseError(V,"drawing ".concat(C," to ").concat(a))}}}return b}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e,n){return t.props.parameters}_shouldDrawLayer(t,e,n,i){if(!(t.props.visible&&this.shouldDrawLayer(t)))return!1;e.layer=t;let a=t.parent;for(;a;){if(!a.props.visible||!a.filterSubLayer(e))return!1;e.layer=a,a=a.parent}if(n){const o=e.layer.id;if(o in i||(i[o]=n(e)),!i[o])return!1}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,i){var s;const a=Object.assign(Object.create(((s=t.internalState)===null||s===void 0?void 0:s.propsInTransition)||t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:Zd(this.gl)});if(e)for(const d of e){var o;Object.assign(a,(o=d.getModuleParameters)===null||o===void 0?void 0:o.call(d,t))}return Object.assign(a,this.getModuleParameters(t,e),i)}}function y3(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e={},n=(i,s)=>{const a=i.props._offset,o=i.id,d=i.parent&&i.parent.id;let p;if(d&&!(d in t)&&n(i.parent,!1),d in e){const y=e[d]=e[d]||y3(t[d],t);p=y(i,s),e[o]=y}else Number.isFinite(a)?(p=a+(t[d]||0),e[o]=null):p=r;return s&&p>=r&&(r=p+1),t[o]=p,p};return n}function jj(r,t){let{moduleParameters:e,target:n,viewport:i}=t;const s=n&&n.id!=="default-framebuffer",a=e&&e.devicePixelRatio||Zd(r),o=s?n.height:r.drawingBufferHeight,d=i;return[d.x*a,o-(d.y+d.height)*a,d.width*a,d.height*a]}function qj(r,t){const e=t?t.width:r.drawingBufferWidth,n=t?t.height:r.drawingBufferHeight;Mu(r,{viewport:[0,0,e,n]}),r.clear(16640)}class Kj extends Gb{constructor(t,e){super(t,e),j(this,"shadowMap",void 0),j(this,"depthBuffer",void 0),j(this,"fbo",void 0),this.shadowMap=new Ca(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new nf(t,{format:33189,width:1,height:1}),this.fbo=new gs(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(t){const e=this.fbo;$l(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const n=t.viewports[0],i=Zd(this.gl),s=n.width*i,a=n.height*i;(s!==e.width||a!==e.height)&&e.resize({width:s,height:a}),super.render({...t,target:e,pass:"shadow"})})}shouldDrawLayer(t){return t.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const _3="#define SMOOTH_EDGE_RADIUS 0.5",$j=`
`.concat(_3,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),Wj=`
`.concat(_3,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),Xj={name:"geometry",vs:$j,fs:Wj},Jj=Object.keys(En).map(r=>"const int COORDINATE_SYSTEM_".concat(r," = ").concat(En[r],";")).join(""),Yj=Object.keys(kc).map(r=>"const int PROJECTION_MODE_".concat(r," = ").concat(kc[r],";")).join(""),Zj=Object.keys(Zv).map(r=>"const int UNIT_".concat(r.toUpperCase()," = ").concat(Zv[r],";")).join(""),tq="".concat(Jj,`
`).concat(Yj,`
`).concat(Zj,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function eq(r,t){if(r===t)return!0;if(Array.isArray(r)){const e=r.length;if(!t||t.length!==e)return!1;for(let n=0;n<e;n++)if(r[n]!==t[n])return!1;return!0}return!1}function yg(r){let t={},e;return n=>{for(const i in n)if(!eq(n[i],t[i])){e=r(n),t=n;break}return e}}const v3=[0,0,0,0],rq=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],b3=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],nq=[0,0,0],w3=[0,0,0],iq=yg(aq);function x3(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:w3;e.length<3&&(e=[e[0],e[1],0]);let n=e,i,s=!0;switch(t===En.LNGLAT_OFFSETS||t===En.METER_OFFSETS?i=e:i=r.isGeospatial?[Math.fround(r.longitude),Math.fround(r.latitude),0]:null,r.projectionMode){case kc.WEB_MERCATOR:(t===En.LNGLAT||t===En.CARTESIAN)&&(i=[0,0,0],s=!1);break;case kc.WEB_MERCATOR_AUTO_OFFSET:t===En.LNGLAT?n=i:t===En.CARTESIAN&&(n=[Math.fround(r.center[0]),Math.fround(r.center[1]),0],i=r.unprojectPosition(n),n[0]-=e[0],n[1]-=e[1],n[2]-=e[2]);break;case kc.IDENTITY:n=r.position.map(Math.fround),n[2]=n[2]||0;break;case kc.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:n,offsetMode:s}}function sq(r,t,e){const{viewMatrixUncentered:n,projectionMatrix:i}=r;let{viewMatrix:s,viewProjectionMatrix:a}=r,o=v3,d=v3,p=r.cameraPosition;const{geospatialOrigin:y,shaderCoordinateOrigin:b,offsetMode:x}=x3(r,t,e);return x&&(d=r.projectPosition(y||b),p=[p[0]-d[0],p[1]-d[1],p[2]-d[2]],d[3]=1,o=dg([],d,a),s=n||s,a=Gh([],i,s),a=Gh([],a,rq)),{viewMatrix:s,viewProjectionMatrix:a,projectionCenter:o,originCommon:d,cameraPosCommon:p,shaderCoordinateOrigin:b,geospatialOrigin:y}}function oq(r){let{viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=En.DEFAULT,coordinateOrigin:s=w3,autoWrapLongitude:a=!1}=r;i===En.DEFAULT&&(i=t.isGeospatial?En.LNGLAT:En.CARTESIAN);const o=iq({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:s});return o.project_uWrapLongitude=a,o.project_uModelMatrix=n||b3,o}function aq(r){let{viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i}=r;const{projectionCenter:s,viewProjectionMatrix:a,originCommon:o,cameraPosCommon:d,shaderCoordinateOrigin:p,geospatialOrigin:y}=sq(t,n,i),b=t.getDistanceScales(),x=[t.width*e,t.height*e],C=dg([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,P={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:p,project_uCommonOrigin:o.slice(0,3),project_uCenter:s,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:x,project_uDevicePixelRatio:e,project_uFocalDistance:C,project_uCommonUnitsPerMeter:b.unitsPerMeter,project_uCommonUnitsPerWorldUnit:b.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:nq,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:a,project_uModelMatrix:b3,project_uCameraPosition:d};if(y){const M=t.getDistanceScales(y);switch(n){case En.METER_OFFSETS:P.project_uCommonUnitsPerWorldUnit=M.unitsPerMeter,P.project_uCommonUnitsPerWorldUnit2=M.unitsPerMeter2;break;case En.LNGLAT:case En.LNGLAT_OFFSETS:t._pseudoMeters||(P.project_uCommonUnitsPerMeter=M.unitsPerMeter),P.project_uCommonUnitsPerWorldUnit=M.unitsPerDegree,P.project_uCommonUnitsPerWorldUnit2=M.unitsPerDegree2;break;case En.CARTESIAN:P.project_uCommonUnitsPerWorldUnit=[1,1,M.unitsPerMeter[2]],P.project_uCommonUnitsPerWorldUnit2=[0,0,M.unitsPerMeter2[2]];break}}return P}const lq={};function cq(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:lq;return"viewport"in r?oq(r):{}}const jb={name:"project",dependencies:[RV,Xj],vs:tq,getUniforms:cq};function uq(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function lf(r,t){const e=dg([],t,r);return e3(e,e,1/e[3]),e}function B3(r,t){const e=r%t;return e<0?t+e:e}function qb(r,t,e){return r<t?t:r>e?e:r}function Aq(r){return Math.log(r)*Math.LOG2E}const Kb=Math.log2||Aq;function ku(r,t){if(!r)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const Yl=Math.PI,C3=Yl/4,ol=Yl/180,$b=180/Yl,cf=512,Y0=4003e4,Z0=85.051129,hq=1.5;function dq(r){return Kb(r)}function _g(r){const[t,e]=r;ku(Number.isFinite(t)),ku(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude");const n=t*ol,i=e*ol,s=cf*(n+Yl)/(2*Yl),a=cf*(Yl+Math.log(Math.tan(C3+i*.5)))/(2*Yl);return[s,a]}function uf(r){const[t,e]=r,n=t/cf*(2*Yl)-Yl,i=2*(Math.atan(Math.exp(e/cf*(2*Yl)-Yl))-C3);return[n*$b,i*$b]}function fq(r){const{latitude:t}=r;ku(Number.isFinite(t));const e=Math.cos(t*ol);return dq(Y0*e)-9}function ty(r){const t=Math.cos(r*ol);return cf/Y0/t}function Wb(r){const{latitude:t,longitude:e,highPrecision:n=!1}=r;ku(Number.isFinite(t)&&Number.isFinite(e));const i=cf,s=Math.cos(t*ol),a=i/360,o=a/s,d=i/Y0/s,p={unitsPerMeter:[d,d,d],metersPerUnit:[1/d,1/d,1/d],unitsPerDegree:[a,o,d],degreesPerUnit:[1/a,1/o,1/d]};if(n){const y=ol*Math.tan(t*ol)/s,b=a*y/2,x=i/Y0*y,C=x/o*d;p.unitsPerDegree2=[0,b,x],p.unitsPerMeter2=[C,0,C]}return p}function E3(r,t){const[e,n,i]=r,[s,a,o]=t,{unitsPerMeter:d,unitsPerMeter2:p}=Wb({longitude:e,latitude:n,highPrecision:!0}),y=_g(r);y[0]+=s*(d[0]+p[0]*a),y[1]+=a*(d[1]+p[1]*a);const b=uf(y),x=(i||0)+(o||0);return Number.isFinite(i)||Number.isFinite(o)?[b[0],b[1],x]:b}function pq(r){const{height:t,pitch:e,bearing:n,altitude:i,scale:s,center:a}=r,o=uq();K0(o,o,[0,0,-i]),Z5(o,o,-e*ol),t3(o,o,n*ol);const d=s/t;return Ob(o,o,[d,d,d]),a&&K0(o,o,ZV([],a)),o}function gq(r){const{width:t,height:e,altitude:n,pitch:i=0,offset:s,center:a,scale:o,nearZMultiplier:d=1,farZMultiplier:p=1}=r;let{fovy:y=ey(hq)}=r;n!==void 0&&(y=ey(n));const b=y*ol,x=i*ol,C=S3(y);let P=C;a&&(P+=a[2]*o/Math.cos(x)/e);const M=b*(.5+(s?s[1]:0)/e),k=Math.sin(M)*P/Math.sin(qb(Math.PI/2-x-M,.01,Math.PI-.01)),z=Math.sin(x)*k+P,V=P*10,$=Math.min(z*p,V);return{fov:b,aspect:t/e,focalDistance:C,near:d,far:$}}function ey(r){return 2*Math.atan(.5/r)*$b}function S3(r){return .5/Math.tan(.5*r*ol)}function T3(r,t){const[e,n,i=0]=r;return ku(Number.isFinite(e)&&Number.isFinite(n)&&Number.isFinite(i)),lf(t,[e,n,i,1])}function Xb(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const[n,i,s]=r;if(ku(Number.isFinite(n)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return lf(t,[n,i,s,1]);const a=lf(t,[n,i,0,1]),o=lf(t,[n,i,1,1]),d=a[2],p=o[2],y=d===p?0:((e||0)-d)/(p-d);return k5([],a,o,y)}function mq(r){const{width:t,height:e,bounds:n,minExtent:i=0,maxZoom:s=24,offset:a=[0,0]}=r,[[o,d],[p,y]]=n,b=yq(r.padding),x=_g([o,qb(y,-Z0,Z0)]),C=_g([p,qb(d,-Z0,Z0)]),P=[Math.max(Math.abs(C[0]-x[0]),i),Math.max(Math.abs(C[1]-x[1]),i)],M=[t-b.left-b.right-Math.abs(a[0])*2,e-b.top-b.bottom-Math.abs(a[1])*2];ku(M[0]>0&&M[1]>0);const k=M[0]/P[0],z=M[1]/P[1],V=(b.right-b.left)/2/k,$=(b.top-b.bottom)/2/z,tt=[(C[0]+x[0])/2+V,(C[1]+x[1])/2+$],pt=uf(tt),gt=Math.min(s,Kb(Math.abs(Math.min(k,z))));return ku(Number.isFinite(gt)),{longitude:pt[0],latitude:pt[1],zoom:gt}}function yq(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return typeof r=="number"?{top:r,bottom:r,left:r,right:r}:(ku(Number.isFinite(r.top)&&Number.isFinite(r.bottom)&&Number.isFinite(r.left)&&Number.isFinite(r.right)),r)}const I3=Math.PI/180;function _q(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const{width:e,height:n,unproject:i}=r,s={targetZ:t},a=i([0,n],s),o=i([e,n],s);let d,p;const y=r.fovy?.5*r.fovy*I3:Math.atan(.5/r.altitude),b=(90-r.pitch)*I3;return y>b-.01?(d=F3(r,0,t),p=F3(r,e,t)):(d=i([0,0],s),p=i([e,0],s)),[a,o,p,d]}function F3(r,t,e){const{pixelUnprojectionMatrix:n}=r,i=lf(n,[t,0,1,1]),s=lf(n,[t,r.height,1,1]),o=(e*r.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),d=k5([],i,s,o),p=uf(d);return p.push(e),p}const L3=512;function vq(r){const{width:t,height:e,pitch:n=0}=r;let{longitude:i,latitude:s,zoom:a,bearing:o=0}=r;(i<-180||i>180)&&(i=B3(i+180,360)-180),(o<-180||o>180)&&(o=B3(o+180,360)-180);const d=Kb(e/L3);if(a<=d)a=d,s=0;else{const p=e/2/Math.pow(2,a),y=uf([0,p])[1];if(s<y)s=y;else{const b=uf([0,L3-p])[1];s>b&&(s=b)}}return{width:t,height:e,longitude:i,latitude:s,zoom:a,pitch:n,bearing:o}}const bq=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,wq=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,xq=yg(Tq),Bq=yg(Iq),Cq=[0,0,0,1],Eq=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function Sq(r,t){const[e,n,i]=r,s=Xb([e,n,i],t);return Number.isFinite(i)?s:[s[0],s[1],0]}function Tq(r){let{viewport:t,center:e}=r;return new wn(t.viewProjectionMatrix).invert().transform(e)}function Iq(r){let{viewport:t,shadowMatrices:e}=r;const n=[],i=t.pixelUnprojectionMatrix,s=t.isGeospatial?void 0:1,a=[[0,0,s],[t.width,0,s],[0,t.height,s],[t.width,t.height,s],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>Sq(o,i));for(const o of e){const d=o.clone().translate(new se(t.center).negate()),p=a.map(b=>d.transform(b)),y=new wn().ortho({left:Math.min(...p.map(b=>b[0])),right:Math.max(...p.map(b=>b[0])),bottom:Math.min(...p.map(b=>b[1])),top:Math.max(...p.map(b=>b[1])),near:Math.min(...p.map(b=>-b[2])),far:Math.max(...p.map(b=>-b[2]))});n.push(y.multiplyRight(o))}return n}function Fq(r,t){const{shadowEnabled:e=!0}=r;if(!e||!r.shadowMatrices||!r.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const n={shadow_uDrawShadowMap:!!r.drawToShadowMap,shadow_uUseShadowMap:r.shadowMaps?r.shadowMaps.length>0:!1,shadow_uColor:r.shadowColor||Cq,shadow_uLightId:r.shadowLightId||0,shadow_uLightCount:r.shadowMatrices.length},i=xq({viewport:r.viewport,center:t.project_uCenter}),s=[],a=Bq({shadowMatrices:r.shadowMatrices,viewport:r.viewport}).slice();for(let o=0;o<r.shadowMatrices.length;o++){const d=a[o],p=d.clone().translate(new se(r.viewport.center).negate());t.project_uCoordinateSystem===En.LNGLAT&&t.project_uProjectionMode===kc.WEB_MERCATOR?(a[o]=p,s[o]=i):(a[o]=d.clone().multiplyRight(Eq),s[o]=p.transform(i))}for(let o=0;o<a.length;o++)n["shadow_uViewProjectionMatrices[".concat(o,"]")]=a[o],n["shadow_uProjectCenters[".concat(o,"]")]=s[o],r.shadowMaps&&r.shadowMaps.length>0?n["shadow_uShadowMap".concat(o)]=r.shadowMaps[o]:n["shadow_uShadowMap".concat(o)]=r.dummyShadowMap;return n}const Jb={name:"shadow",dependencies:[jb],vs:bq,fs:wq,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"viewport"in r&&(r.drawToShadowMap||r.shadowMaps&&r.shadowMaps.length>0)?Fq(r,t):{}}},Lq={color:[255,255,255],intensity:1},P3=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Pq=[0,0,0,200/255];class Yb{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};j(this,"id","lighting-effect"),j(this,"props",void 0),j(this,"shadowColor",Pq),j(this,"shadow",void 0),j(this,"ambientLight",void 0),j(this,"directionalLights",void 0),j(this,"pointLights",void 0),j(this,"shadowPasses",[]),j(this,"shadowMaps",[]),j(this,"dummyShadowMap",null),j(this,"programManager",void 0),j(this,"shadowMatrices",void 0),this.setProps(t)}setProps(t){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(e=>e.shadow),this.props=t}preRender(t,e){let{layers:n,layerFilter:i,viewports:s,onViewportActive:a,views:o}=e;if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(t),this.programManager||(this.programManager=gg.getDefaultProgramManager(t),Jb&&this.programManager.addDefaultModule(Jb)),this.dummyShadowMap||(this.dummyShadowMap=new Ca(t,{width:1,height:1}));for(let d=0;d<this.shadowPasses.length;d++)this.shadowPasses[d].render({layers:n,layerFilter:i,viewports:s,onViewportActive:a,views:o,moduleParameters:{shadowLightId:d,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(n=>n.getProjectedLight({layer:t})),pointLights:this.pointLights.map(n=>n.getProjectedLight({layer:t}))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Jb),this.programManager=null)}_calculateMatrices(){const t=[];for(const e of this.directionalLights){const n=new wn().lookAt({eye:new se(e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new Kj(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;!t&&e.length===0&&n.length===0&&(this.ambientLight=new g3(Lq),this.directionalLights.push(new m3(P3[0]),new m3(P3[1])))}}class Mq{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};j(this,"_pool",[]),j(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(t)}setOptions(t){Object.assign(this.opts,t)}allocate(t,e,n){let{size:i=1,type:s,padding:a=0,copy:o=!1,initialize:d=!1,maxCount:p}=n;const y=s||t&&t.constructor||Float32Array,b=e*i+a;if(ArrayBuffer.isView(t)){if(b<=t.length)return t;if(b*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new y(t.buffer,0,b)}let x=1/0;p&&(x=p*i+a);const C=this._allocate(y,b,d,x);return t&&o?C.set(t):d||C.fill(0,0,4),this._release(t),C}release(t){this._release(t)}_allocate(t,e,n,i){let s=Math.max(Math.ceil(e*this.opts.overAlloc),1);s>i&&(s=i);const a=this._pool,o=t.BYTES_PER_ELEMENT*s,d=a.findIndex(p=>p.byteLength>=o);if(d>=0){const p=new t(a.splice(d,1)[0],0,s);return n&&p.fill(0),p}return new t(s)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:i}=n,s=e.findIndex(a=>a.byteLength>=i);s<0?e.push(n):(s>0||e.length<this.opts.poolSize)&&e.splice(s,0,n),e.length>this.opts.poolSize&&e.shift()}}const vg=new Mq;function bg(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Uq(r){return[r[12],r[13],r[14]]}function Rq(r){return{left:Af(r[3]+r[0],r[7]+r[4],r[11]+r[8],r[15]+r[12]),right:Af(r[3]-r[0],r[7]-r[4],r[11]-r[8],r[15]-r[12]),bottom:Af(r[3]+r[1],r[7]+r[5],r[11]+r[9],r[15]+r[13]),top:Af(r[3]-r[1],r[7]-r[5],r[11]-r[9],r[15]-r[13]),near:Af(r[3]+r[2],r[7]+r[6],r[11]+r[10],r[15]+r[14]),far:Af(r[3]-r[2],r[7]-r[6],r[11]-r[10],r[15]-r[14])}}const M3=new se;function Af(r,t,e,n){M3.set(r,t,e);const i=M3.len();return{distance:n/i,normal:new se(-r/i,-t/i,-e/i)}}function Oq(r){return r-Math.fround(r)}let wg;function Zb(r,t){const{size:e=1,startIndex:n=0}=t,i=t.endIndex!==void 0?t.endIndex:r.length,s=(i-n)/e;wg=vg.allocate(wg,s,{type:Float32Array,size:e*2});let a=n,o=0;for(;a<i;){for(let d=0;d<e;d++){const p=r[a++];wg[o+d]=p,wg[o+d+e]=Oq(p)}o+=e*2}return wg.subarray(0,s*e*2)}function Dq(r){let t=null,e=!1;for(const n of r)n&&(t?(e||(t=[[t[0][0],t[0][1]],[t[1][0],t[1][1]]],e=!0),t[0][0]=Math.min(t[0][0],n[0][0]),t[0][1]=Math.min(t[0][1],n[0][1]),t[1][0]=Math.max(t[1][0],n[1][0]),t[1][1]=Math.max(t[1][1],n[1][1])):t=n);return t}const Nq=Math.PI/180,kq=bg(),U3=[0,0,0],Qq={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function zq(r){let{width:t,height:e,orthographic:n,fovyRadians:i,focalDistance:s,padding:a,near:o,far:d}=r;const p=t/e,y=n?new wn().orthographic({fovy:i,aspect:p,focalDistance:s,near:o,far:d}):new wn().perspective({fovy:i,aspect:p,near:o,far:d});if(a){const{left:b=0,right:x=0,top:C=0,bottom:P=0}=a,M=Nu((b+t-x)/2,0,t)-t/2,k=Nu((C+e-P)/2,0,e)-e/2;y[8]-=M*2/t,y[9]+=k*2/e}return y}class hf{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};j(this,"id",void 0),j(this,"x",void 0),j(this,"y",void 0),j(this,"width",void 0),j(this,"height",void 0),j(this,"padding",void 0),j(this,"isGeospatial",void 0),j(this,"zoom",void 0),j(this,"focalDistance",void 0),j(this,"position",void 0),j(this,"modelMatrix",void 0),j(this,"distanceScales",void 0),j(this,"scale",void 0),j(this,"center",void 0),j(this,"cameraPosition",void 0),j(this,"projectionMatrix",void 0),j(this,"viewMatrix",void 0),j(this,"viewMatrixUncentered",void 0),j(this,"viewMatrixInverse",void 0),j(this,"viewProjectionMatrix",void 0),j(this,"pixelProjectionMatrix",void 0),j(this,"pixelUnprojectionMatrix",void 0),j(this,"resolution",void 0),j(this,"_frustumPlanes",{}),this.id=t.id||this.constructor.displayName||"viewport",this.x=t.x||0,this.y=t.y||0,this.width=t.width||1,this.height=t.height||1,this.zoom=t.zoom||0,this.padding=t.padding,this.distanceScales=t.distanceScales||Qq,this.focalDistance=t.focalDistance||1,this.position=t.position||U3,this.modelMatrix=t.modelMatrix||null;const{longitude:e,latitude:n}=t;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(e),this._initProps(t),this._initMatrices(t),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?kc.WEB_MERCATOR:kc.WEB_MERCATOR_AUTO_OFFSET:kc.IDENTITY}equals(t){return t instanceof hf?this===t?!0:t.width===this.width&&t.height===this.height&&t.scale===this.scale&&Xl(t.projectionMatrix,this.projectionMatrix)&&Xl(t.viewMatrix,this.viewMatrix):!1}project(t){let{topLeft:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=this.projectPosition(t),i=T3(n,this.pixelProjectionMatrix),[s,a]=i,o=e?a:this.height-a;return t.length===2?[s,o]:[s,o,i[2]]}unproject(t){let{topLeft:e=!0,targetZ:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const[i,s,a]=t,o=e?s:this.height-s,d=n&&n*this.distanceScales.unitsPerMeter[2],p=Xb([i,o,a],this.pixelUnprojectionMatrix,d),[y,b,x]=this.unprojectPosition(p);return Number.isFinite(a)?[y,b,x]:Number.isFinite(n)?[y,b,n]:[y,b]}projectPosition(t){const[e,n]=this.projectFlat(t),i=(t[2]||0)*this.distanceScales.unitsPerMeter[2];return[e,n,i]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t),i=(t[2]||0)*this.distanceScales.metersPerUnit[2];return[e,n,i]}projectFlat(t){if(this.isGeospatial){const e=_g(t);return e[1]=Nu(e[1],-318,830),e}return t}unprojectFlat(t){return this.isGeospatial?uf(t):t}getBounds(){const e={targetZ:(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).z||0},n=this.unproject([0,0],e),i=this.unproject([this.width,0],e),s=this.unproject([0,this.height],e),a=this.unproject([this.width,this.height],e);return[Math.min(n[0],i[0],s[0],a[0]),Math.min(n[1],i[1],s[1],a[1]),Math.max(n[0],i[0],s[0],a[0]),Math.max(n[1],i[1],s[1],a[1])]}getDistanceScales(t){return t?Wb({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel(t){let{x:e,y:n,width:i=1,height:s=1}=t;return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+s}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,Rq(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(t,e){return null}_initProps(t){const e=t.longitude,n=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=fq({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||Wb({latitude:n,longitude:e}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:a}=t;let o=U3;if(s&&(o=a?new wn(a).transformAsVector(s,[]):s),this.isGeospatial){const d=this.projectPosition([e,n,0]);this.center=new se(o).scale(this.distanceScales.unitsPerMeter).add(d)}else this.center=this.projectPosition(o)}_initMatrices(t){const{viewMatrix:e=kq,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:s,fovy:a=75,near:o=.1,far:d=1e3,padding:p=null,focalDistance:y=1}=t;this.viewMatrixUncentered=e,this.viewMatrix=new wn().multiplyRight(e).translate(new se(this.center).negate()),this.projectionMatrix=n||zq({width:this.width,height:this.height,orthographic:i,fovyRadians:s||a*Nq,focalDistance:y,padding:p,near:o,far:d});const b=bg();Gh(b,b,this.projectionMatrix),Gh(b,b,this.viewMatrix),this.viewProjectionMatrix=b,this.viewMatrixInverse=Rb([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=Uq(this.viewMatrixInverse);const x=bg(),C=bg();Ob(x,x,[this.width/2,-this.height/2,1]),K0(x,x,[1,-1,0]),Gh(C,x,this.viewProjectionMatrix),this.pixelProjectionMatrix=C,this.pixelUnprojectionMatrix=Rb(bg(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Tn.warn("Pixel project matrix not invertible")()}}j(hf,"displayName","Viewport");class jh extends hf{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{latitude:e=0,longitude:n=0,zoom:i=0,pitch:s=0,bearing:a=0,nearZMultiplier:o=.1,farZMultiplier:d=1.01,nearZ:p,farZ:y,orthographic:b=!1,projectionMatrix:x,repeat:C=!1,worldOffset:P=0,position:M,padding:k,legacyMeterSizes:z=!1}=t;let{width:V,height:$,altitude:tt=1.5}=t;const pt=Math.pow(2,i);V=V||1,$=$||1;let gt,mt=null;if(x)tt=x[5]/2,gt=ey(tt);else{t.fovy?(gt=t.fovy,tt=S3(gt)):gt=ey(tt);let Ft;if(k){const{top:Tt=0,bottom:ot=0}=k;Ft=[0,Nu((Tt+$-ot)/2,0,$)-$/2]}mt=gq({width:V,height:$,scale:pt,center:M&&[0,0,M[2]*ty(e)],offset:Ft,pitch:s,fovy:gt,nearZMultiplier:o,farZMultiplier:d}),Number.isFinite(p)&&(mt.near=p),Number.isFinite(y)&&(mt.far=y)}let dt=pq({height:$,pitch:s,bearing:a,scale:pt,altitude:tt});P&&(dt=new wn().translate([512*P,0,0]).multiplyLeft(dt)),super({...t,width:V,height:$,viewMatrix:dt,longitude:n,latitude:e,zoom:i,...mt,fovy:gt,focalDistance:tt}),j(this,"longitude",void 0),j(this,"latitude",void 0),j(this,"pitch",void 0),j(this,"bearing",void 0),j(this,"altitude",void 0),j(this,"fovy",void 0),j(this,"orthographic",void 0),j(this,"_subViewports",void 0),j(this,"_pseudoMeters",void 0),this.latitude=e,this.longitude=n,this.zoom=i,this.pitch=s,this.bearing=a,this.altitude=tt,this.fovy=gt,this.orthographic=b,this._subViewports=C?[]:null,this._pseudoMeters=z,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let i=e;i<=n;i++){const s=i?new jh({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,n]=this.projectFlat(t),i=(t[2]||0)*ty(t[1]);return[e,n,i]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,n]=this.unprojectFlat(t),i=(t[2]||0)/ty(n);return[e,n,i]}addMetersToLngLat(t,e){return E3(t,e)}panByPosition(t,e){const n=Xb(e,this.pixelUnprojectionMatrix),i=this.projectFlat(t),s=N5([],i,KV([],n)),a=N5([],this.center,s),[o,d]=this.unprojectFlat(a);return{longitude:o,latitude:d}}getBounds(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=_q(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{width:n,height:i}=this,{longitude:s,latitude:a,zoom:o}=mq({width:n,height:i,bounds:t,...e});return new jh({width:n,height:i,longitude:s,latitude:a,zoom:o})}}j(jh,"displayName","WebMercatorViewport");const R3=[0,0,0];function tw(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const n=t.projectPosition(r);if(e&&t instanceof jh){const[i,s,a=0]=r,o=t.getDistanceScales([i,s]);n[2]=a*o.unitsPerMeter[2]}return n}function Hq(r){const{viewport:t,modelMatrix:e,coordinateOrigin:n}=r;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:a}=r;return i===En.DEFAULT&&(i=t.isGeospatial?En.LNGLAT:En.CARTESIAN),s===void 0&&(s=i),a===void 0&&(a=n),{viewport:t,coordinateSystem:i,coordinateOrigin:n,modelMatrix:e,fromCoordinateSystem:s,fromCoordinateOrigin:a}}function O3(r,t){let{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:s,offsetMode:a}=t,[o,d,p=0]=r;switch(n&&([o,d,p]=dg([],[o,d,p,1],n)),i){case En.LNGLAT:return tw([o,d,p],e,a);case En.LNGLAT_OFFSETS:return tw([o+s[0],d+s[1],p+(s[2]||0)],e,a);case En.METER_OFFSETS:return tw(E3(s,[o,d,p]),e,a);case En.CARTESIAN:default:return e.isGeospatial?[o+s[0],d+s[1],p+s[2]]:e.projectPosition([o,d,p])}}function Vq(r,t){const{viewport:e,coordinateSystem:n,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:a,fromCoordinateOrigin:o}=Hq(t),{autoOffset:d=!0}=t,{geospatialOrigin:p=R3,shaderCoordinateOrigin:y=R3,offsetMode:b=!1}=d?x3(e,n,i):{},x=O3(r,{viewport:e,modelMatrix:s,coordinateSystem:a,coordinateOrigin:o,offsetMode:b});if(b){const C=e.projectPosition(p||y);sG(x,x,C)}return x}const D3={blendFunc:[1,0,32771,0],blendEquation:32774};class N3 extends Gb{constructor(){super(...arguments),j(this,"pickZ",void 0),j(this,"_colorEncoderState",null)}render(t){return"pickingFBO"in t?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer(t){let{layers:e,layerFilter:n,views:i,viewports:s,onViewportActive:a,pickingFBO:o,deviceRect:{x:d,y:p,width:y,height:b},cullRect:x,effects:C,pass:P="picking",pickZ:M,moduleParameters:k}=t;const z=this.gl;this.pickZ=M;const V=this._resetColorEncoder(M),$=$l(z,{scissorTest:!0,scissor:[d,p,y,b],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...D3,blend:!M},()=>super.render({target:o,layers:e,layerFilter:n,views:i,viewports:s,onViewportActive:a,cullRect:x,effects:C==null?void 0:C.filter(pt=>pt.useInPicking),pass:P,isPicking:!0,moduleParameters:k}));return this._colorEncoderState=null,{decodePickingColor:V&&jq.bind(null,V),stats:$}}shouldDrawLayer(t){const{pickable:e,operation:n}=t.props;return e&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e,n){const i={...t.props.parameters},{pickable:s,operation:a}=t.props;return this._colorEncoderState?s&&a.includes("draw")&&(Object.assign(i,D3),i.blend=!0,i.blendColor=Gq(this._colorEncoderState,t,n)):i.blend=!1,a.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(t){return this._colorEncoderState=t?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function Gq(r,t,e){const{byLayer:n,byAlpha:i}=r;let s,a=n.get(t);return a?(a.viewports.push(e),s=a.a):(s=n.size+1,s<=255?(a={a:s,layer:t,viewports:[e]},n.set(t,a),i[s]=a):(Tn.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function jq(r,t){const e=r.byAlpha[t[3]];return e&&{pickedLayer:e.layer,pickedViewports:e.viewports,pickedObjectIndex:e.layer.decodePickingColor(t)}}const df={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},ry=Symbol.for("component"),OA=Symbol.for("propTypes"),ew=Symbol.for("deprecatedProps"),ff=Symbol.for("asyncPropDefaults"),qh=Symbol.for("asyncPropOriginal"),DA=Symbol.for("asyncPropResolved");function ny(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return Array.isArray(r)?k3(r,t,[]):t(r)?[r]:[]}function k3(r,t,e){let n=-1;for(;++n<r.length;){const i=r[n];Array.isArray(i)?k3(i,t,e):t(i)&&e.push(i)}return e}function qq(r){let{target:t,source:e,start:n=0,count:i=1}=r;const s=e.length,a=i*s;let o=0;for(let d=n;o<s;o++)t[d++]=e[o];for(;o<a;)o<a-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+a-o),o=a);return t}class Kq{constructor(t,e,n){j(this,"id",void 0),j(this,"context",void 0),j(this,"isLoaded",void 0),j(this,"persistent",void 0),j(this,"_loadCount",0),j(this,"_subscribers",new Set),j(this,"_data",void 0),j(this,"_loader",void 0),j(this,"_error",void 0),j(this,"_content",void 0),this.id=t,this.context=n,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let i=t;typeof t=="string"&&(i=FA(t)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===n&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=t);for(const s of this._subscribers)s.onChange(this.getData())}}class $q{constructor(t){let{gl:e,protocol:n}=t;j(this,"protocol",void 0),j(this,"_context",void 0),j(this,"_resources",void 0),j(this,"_consumers",void 0),j(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return t.startsWith(this.protocol)?!0:t in this._resources}add(t){let{resourceId:e,data:n,forceUpdate:i=!1,persistent:s=!0}=t,a=this._resources[e];a?a.setData(n,i):(a=new Kq(e,n,this._context),this._resources[e]=a),a.persistent=s}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe(t){let{consumerId:e}=t;const n=this._consumers[e];if(n){for(const i in n){const s=n[i],a=this._resources[s.resourceId];a&&a.unsubscribe(s)}delete this._consumers[e],this.prune()}}subscribe(t){let{resourceId:e,onChange:n,consumerId:i,requestId:s="default"}=t;const{_resources:a,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),a[e]||this.add({resourceId:e,data:null,persistent:!1}));const d=a[e];if(this._track(i,s,d,n),d)return d.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,i){const s=this._consumers,a=s[t]=s[t]||{},o=a[e]||{},d=o.resourceId&&this._resources[o.resourceId];d&&(d.unsubscribe(o),this.prune()),n&&(a[e]=o,o.onChange=i,o.resourceId=n.id,n.subscribe(o))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];!e.persistent&&!e.inUse()&&(e.delete(),delete this._resources[t])}}}const rw={name:"project32",dependencies:[jb],vs:`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`},nw={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...cj},Wq=[jb],Xq=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function Jq(r){const t=gg.getDefaultProgramManager(r);for(const e of Wq)t.addDefaultModule(e);for(const e of Xq)t.addShaderHook(e);return t}const Yq="layerManager.setLayers",Zq="layerManager.activateViewport";class tK{constructor(t){let{deck:e,stats:n,viewport:i,timeline:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};j(this,"layers",void 0),j(this,"context",void 0),j(this,"resourceManager",void 0),j(this,"_lastRenderedLayers",[]),j(this,"_needsRedraw",!1),j(this,"_needsUpdate",!1),j(this,"_nextLayers",null),j(this,"_debug",!1),j(this,"activateViewport",a=>{oo(Zq,this,a),a&&(this.context.viewport=a)}),this.layers=[],this.resourceManager=new $q({gl:t,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:t,deck:e,programManager:t&&Jq(t),stats:n||new Kp({id:"deck.gl"}),viewport:i||new hf({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new p3,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1},e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(t);e=e||i}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers(){let{layerIds:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t?this.layers.filter(e=>t.find(n=>e.id.indexOf(n)===0)):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){oo(Yq,this,e,t),this._lastRenderedLayers=t;const n=ny(t,Boolean);for(const i of n)i.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this._lastRenderedLayers,t)),this._nextLayers=null}_handleError(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}_updateLayers(t,e){const n={};for(const a of t)n[a.id]?Tn.warn("Multiple old layers with same id ".concat(a.id))():n[a.id]=a;const i=[];this._updateSublayersRecursively(e,n,i),this._finalizeOldLayers(n);let s=!1;for(const a of i)if(a.hasUniformTransition()){s="Uniform transition in ".concat(a);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(t,e,n){for(const i of t){i.context=this.context;const s=e[i.id];s===null&&Tn.warn("Multiple new layers with same id ".concat(i.id))(),e[i.id]=null;let a=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),a=i.isComposite?i.getSubLayers():null}catch(o){this._handleError("matching",o,i)}a&&this._updateSublayersRecursively(a,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=df.INITIALIZED}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle=df.MATCHED,e!==t&&(t.lifecycle=df.AWAITING_GC)}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle=df.AWAITING_FINALIZATION;try{t._finalize(),t.lifecycle=df.FINALIZED}catch(e){this._handleError("finalization",e,t)}}}function zc(r,t,e){if(r===t)return!0;if(!e||!r||!t)return!1;if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(let n=0;n<r.length;n++)if(!zc(r[n],t[n],e-1))return!1;return!0}if(Array.isArray(t))return!1;if(typeof r=="object"&&typeof t=="object"){const n=Object.keys(r),i=Object.keys(t);if(n.length!==i.length)return!1;for(const s of n)if(!t.hasOwnProperty(s)||!zc(r[s],t[s],e-1))return!1;return!0}return!1}class eK{constructor(t){j(this,"width",void 0),j(this,"height",void 0),j(this,"views",void 0),j(this,"viewState",void 0),j(this,"controllers",void 0),j(this,"timeline",void 0),j(this,"_viewports",void 0),j(this,"_viewportMap",void 0),j(this,"_isUpdating",void 0),j(this,"_needsRedraw",void 0),j(this,"_needsUpdate",void 0),j(this,"_eventManager",void 0),j(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers){const e=this.controllers[t];e&&e.finalize()}this.controllers={}}needsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter(e=>e.containsPixel(t)):this._viewports}getViews(){const t={};return this.views.forEach(e=>{t[e.id]=e}),t}getView(t){return this.views.find(e=>e.id===t)}getViewState(t){const e=typeof t=="string"?this.getView(t):t,n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),i={x:t[0],y:t[1]};for(let s=n.length-1;s>=0;--s){const a=n[s];if(a.containsPixel(i)){const o=t.slice();return o[0]-=a.x,o[1]-=a.y,a.unproject(o,e)}}return null}setProps(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){(t!==this.width||e!==this.height)&&(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=ny(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){t?(!zc(t,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):Tn.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...e,viewId:t})}_createController(t,e){const n=e.type;return new n({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var a;return(a=this.getView(t.id))===null||a===void 0?void 0:a.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(t,e,n,i){const s=t.controller;if(s&&n){const a={...e,...s,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height};return(!i||i.constructor!==s.type)&&(i=this._createController(t,a)),i&&i.setProps(a),i}return null}_rebuildViewports(){const{views:t}=this,e=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=t.length;i--;){const s=t[i],a=this.getViewState(s),o=s.makeViewport({viewState:a,width:this.width,height:this.height});let d=e[s.id];const p=!!s.controller;p&&!d&&(n=!0),(n||!p)&&d&&(d.finalize(),d=null),this.controllers[s.id]=this._updateController(s,a,o,d),o&&this._viewports.unshift(o)}for(const i in e){const s=e[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)})}_diffViews(t,e){return t.length!==e.length?!0:t.some((n,i)=>!t[i].equals(e[i]))}}const rK=/([0-9]+\.?[0-9]*)(%|px)/;function NA(r){switch(typeof r){case"number":return{position:r,relative:!1};case"string":const t=rK.exec(r);if(t&&t.length>=3){const e=t[2]==="%",n=parseFloat(t[1]);return{position:e?n/100:n,relative:e}}default:throw new Error("Could not parse position string ".concat(r))}}function kA(r,t){return r.relative?Math.round(r.position*t):r.position}function js(r,t){if(!r)throw new Error(t||"deck.gl: assertion failed.")}class nK{constructor(t){j(this,"id",void 0),j(this,"viewportInstance",void 0),j(this,"_x",void 0),j(this,"_y",void 0),j(this,"_width",void 0),j(this,"_height",void 0),j(this,"_padding",void 0),j(this,"props",void 0);const{id:e,x:n=0,y:i=0,width:s="100%",height:a="100%",padding:o=null,viewportInstance:d}=t||{};js(!d||d instanceof hf),this.viewportInstance=d,this.id=e||this.constructor.displayName||"view",this.props={...t,id:this.id},this._x=NA(n),this._y=NA(i),this._width=NA(s),this._height=NA(a),this._padding=o&&{left:NA(o.left||0),right:NA(o.right||0),top:NA(o.top||0),bottom:NA(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t?!0:this.viewportInstance?t.viewportInstance?this.viewportInstance.equals(t.viewportInstance):!1:this.ViewportType===t.ViewportType&&zc(this.props,t.props,2)}makeViewport(t){let{width:e,height:n,viewState:i}=t;if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const s=this.getDimensions({width:e,height:n});return!s.height||!s.width?null:new this.ViewportType({...i,...this.props,...s})}getViewStateId(){const{viewState:t}=this.props;return typeof t=="string"?t:(t==null?void 0:t.id)||this.id}filterViewState(t){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const n in this.props.viewState)n!=="id"&&(e[n]=this.props.viewState[n]);return e}return t}getDimensions(t){let{width:e,height:n}=t;const i={x:kA(this._x,e),y:kA(this._y,n),width:kA(this._width,e),height:kA(this._height,n)};return this._padding&&(i.padding={left:kA(this._padding.left,e),top:kA(this._padding.top,n),right:kA(this._padding.right,e),bottom:kA(this._padding.bottom,n)}),i}get controller(){const t=this.props.controller;return t?t===!0?{type:this.ControllerType}:typeof t=="function"?{type:t}:{type:this.ControllerType,...t}:null}}class xg{constructor(t){j(this,"_inProgress",void 0),j(this,"_handle",void 0),j(this,"_timeline",void 0),j(this,"time",void 0),j(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=t,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(t){var e,n;this.cancel(),this.settings=t,this._inProgress=!0,(e=(n=this.settings).onStart)===null||e===void 0||e.call(n,this)}end(){if(this._inProgress){var t,e;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(t=(e=this.settings).onEnd)===null||t===void 0||t.call(e,this)}}cancel(){if(this._inProgress){var t,e;(t=(e=this.settings).onInterrupt)===null||t===void 0||t.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var t,e;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:n,settings:i}=this;this._handle=n.addChannel({delay:n.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(t=(e=this.settings).onUpdate)===null||t===void 0||t.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Q3=()=>{},iw={BREAK:1,SNAP_TO_END:2,IGNORE:3},iK=r=>r,sK=iw.BREAK;class oK{constructor(t){j(this,"getControllerState",void 0),j(this,"props",void 0),j(this,"propsInTransition",void 0),j(this,"transition",void 0),j(this,"onViewStateChange",void 0),j(this,"onStateChange",void 0),j(this,"_onTransitionUpdate",e=>{const{time:n,settings:{interpolator:i,startProps:s,endProps:a,duration:o,easing:d}}=e,p=d(n/o),y=i.interpolateProps(s,a,p);this.propsInTransition=this.getControllerState({...this.props,...y}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=t.getControllerState,this.propsInTransition=null,this.transition=new xg(t.timeline),this.onViewStateChange=t.onViewStateChange||Q3,this.onStateChange=t.onStateChange||Q3}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(this.props=t,!n||this._shouldIgnoreViewportChange(n,t))return!1;if(this._isTransitionEnabled(t)){let i=n;if(this.transition.inProgress){const{interruption:s,endProps:a}=this.transition.settings;i={...n,...s===iw.SNAP_TO_END?a:this.propsInTransition||n}}this._triggerTransition(i,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||e==="auto")&&!!n}_isUpdateDueToCurrentTransition(t){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition):!1}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?this.transition.settings.interruption===iw.IGNORE||this._isUpdateDueToCurrentTransition(e):this._isTransitionEnabled(e)?e.transitionInterpolator.arePropsEqual(t,e):!0}_triggerTransition(t,e){const n=this.getControllerState(t),i=this.getControllerState(e).shortestPathFrom(n),s=e.transitionInterpolator,a=s.getDuration?s.getDuration(t,e):e.transitionDuration;if(a===0)return;const o=s.initializeProps(t,i);this.propsInTransition={};const d={duration:a,easing:e.transitionEasing||iK,interpolator:s,interruption:e.transitionInterruption||sK,startProps:o.start,endProps:o.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)};this.transition.start(d),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),t==null||t(e)}}}class aK{constructor(t){j(this,"_propsToCompare",void 0),j(this,"_propsToExtract",void 0),j(this,"_requiredProps",void 0);const{compare:e,extract:n,required:i}=t;this._propsToCompare=e,this._propsToExtract=n||e,this._requiredProps=i}arePropsEqual(t,e){for(const n of this._propsToCompare)if(!(n in t)||!(n in e)||!Xl(t[n],e[n]))return!1;return!0}initializeProps(t,e){const n={},i={};for(const s of this._propsToExtract)(s in t||s in e)&&(n[s]=t[s],i[s]=e[s]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach(e=>{const n=t[e];js(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))})}}const lK=["longitude","latitude","zoom","bearing","pitch"],cK=["longitude","latitude","zoom"];class z3 extends aK{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=Array.isArray(t)?t:t.transitionProps,n=Array.isArray(t)?{}:t;n.transitionProps=Array.isArray(e)?{compare:e,required:e}:e||{compare:lK,required:cK},super(n.transitionProps),j(this,"opts",void 0),this.opts=n}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:i,around:s}=this.opts;if(i&&s){const a=i(t),o=i(e),d=a.unproject(s);n.start.around=s,Object.assign(n.end,{around:o.project(d),aroundPosition:d,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const i={};for(const s of this._propsToExtract)i[s]=z0(t[s]||0,e[s]||0,n);if(e.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...e,...i});Object.assign(i,s.panByPosition(e.aroundPosition,z0(t.around,e.around,n)))}return i}}const QA={transitionDuration:0},uK=300,iy=r=>1-(1-r)*(1-r),pf={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Kh={};class AK{constructor(t){j(this,"props",void 0),j(this,"state",{}),j(this,"transitionManager",void 0),j(this,"eventManager",void 0),j(this,"onViewStateChange",void 0),j(this,"onStateChange",void 0),j(this,"makeViewport",void 0),j(this,"_controllerState",void 0),j(this,"_events",{}),j(this,"_interactionState",{isDragging:!1}),j(this,"_customEvents",[]),j(this,"_eventStartBlocked",null),j(this,"_panMove",!1),j(this,"invertPan",!1),j(this,"dragMode","rotate"),j(this,"inertia",0),j(this,"scrollZoom",!0),j(this,"dragPan",!0),j(this,"dragRotate",!0),j(this,"doubleClickZoom",!0),j(this,"touchZoom",!0),j(this,"touchRotate",!1),j(this,"keyboard",!0),this.transitionManager=new oK({...t,getControllerState:e=>new this.ControllerState(e),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=t.eventManager,this.onViewStateChange=t.onViewStateChange||(()=>{}),this.onStateChange=t.onStateChange||(()=>{}),this.makeViewport=t.makeViewport}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events)if(this._events[e]){var t;(t=this.eventManager)===null||t===void 0||t.off(e,this.handleEvent)}this.transitionManager.finalize()}handleEvent(t){this._controllerState=void 0;const e=this._eventStartBlocked;switch(t.type){case"panstart":return e?!1:this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return e?!1:this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return e?!1:this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(t){const{x:e,y:n}=this.props,{offsetCenter:i}=t;return[i.x-e,i.y-n]}isPointInBounds(t,e){const{width:n,height:i}=this.props;if(e&&e.handled)return!1;const s=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=i;return s&&e&&e.stopPropagation(),s}isFunctionKeyPressed(t){const{srcEvent:e}=t;return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(t){const e=setTimeout(()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)},t);this._eventStartBlocked=e}setProps(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);const{inertia:e}=t;this.inertia=Number.isFinite(e)?e:e===!0?uK:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:a=!0,touchZoom:o=!0,touchRotate:d=!1,keyboard:p=!0}=t,y=!!this.onViewStateChange;this.toggleEvents(pf.WHEEL,y&&n),this.toggleEvents(pf.PAN,y),this.toggleEvents(pf.PINCH,y&&(o||d)),this.toggleEvents(pf.TRIPLE_PAN,y&&d),this.toggleEvents(pf.DOUBLE_TAP,y&&a),this.toggleEvents(pf.KEYBOARD,y&&p),this.scrollZoom=n,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=a,this.touchZoom=o,this.touchRotate=d,this.keyboard=p}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach(n=>{this._events[n]!==e&&(this._events[n]=e,e?this.eventManager.on(n,this.handleEvent):this.eventManager.off(n,this.handleEvent))})}updateViewport(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i={...t.getViewportProps(),...e},s=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(n),s){const a=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:a})}}_onTransition(t){this.onViewStateChange({...t,interactionState:this._interactionState})}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(i,QA,{isDragging:!0}),!0}_onPan(t){return this.isDragging()?this._panMove?this._onPanMove(t):this._onPanRotate(t):!1}_onPanEnd(t){return this.isDragging()?this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t):!1}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,QA,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:iy},{isDragging:!1,isPanning:!0})}else{const n=this.controllerState.panEnd();this.updateViewport(n,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,QA,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:iy},{isDragging:!1,isRotating:!0})}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;t.srcEvent.preventDefault();const{speed:n=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=t;let a=2/(1+Math.exp(-Math.abs(s*n)));s<0&&a!==0&&(a=1/a);const o=this.controllerState.zoom({pos:e,scale:a});return this.updateViewport(o,{...this._getTransitionProps({around:e}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,QA,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate||!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,QA,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),i=[n[0],n[1]+=t.velocityY*e/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:iy},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return Kh._startPinchRotation=t.rotation,Kh._lastPinchEvent=t,this.updateViewport(n,QA,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,i=this.getCenter(t);e=e.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:Kh._startPinchRotation-n})}return this.updateViewport(e,QA,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Kh._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this,{_lastPinchEvent:n}=Kh;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const i=this.getCenter(t);let s=this.controllerState.rotateEnd();const a=Math.log2(t.scale),o=(a-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),d=Math.pow(2,a+o*e/2);s=s.zoom({pos:i,scale:d}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:e,transitionEasing:iy},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Kh._startPinchRotation=null,Kh._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),i=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:a}=this.keyboard===!0?{}:this.keyboard,{controllerState:o}=this;let d;const p={};switch(t.srcEvent.code){case"Minus":d=e?o.zoomOut(n).zoomOut(n):o.zoomOut(n),p.isZooming=!0;break;case"Equal":d=e?o.zoomIn(n).zoomIn(n):o.zoomIn(n),p.isZooming=!0;break;case"ArrowLeft":e?(d=o.rotateLeft(s),p.isRotating=!0):(d=o.moveLeft(i),p.isPanning=!0);break;case"ArrowRight":e?(d=o.rotateRight(s),p.isRotating=!0):(d=o.moveRight(i),p.isPanning=!0);break;case"ArrowUp":e?(d=o.rotateUp(a),p.isRotating=!0):(d=o.moveUp(i),p.isPanning=!0);break;case"ArrowDown":e?(d=o.rotateDown(a),p.isRotating=!0):(d=o.moveDown(i),p.isPanning=!0);break;default:return!1}return this.updateViewport(d,this._getTransitionProps(),p),!0}_getTransitionProps(t){const{transition:e}=this;return!e||!e.transitionInterpolator?QA:t?{...e,transitionInterpolator:new z3({...t,...e.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:e}}class hK{constructor(t,e){j(this,"_viewportProps",void 0),j(this,"_state",void 0),this._viewportProps=this.applyConstraints(t),this._state=e}getViewportProps(){return this._viewportProps}getState(){return this._state}}const H3=5,dK=1.2;class fK extends hK{constructor(t){const{width:e,height:n,latitude:i,longitude:s,zoom:a,bearing:o=0,pitch:d=0,altitude:p=1.5,position:y=[0,0,0],maxZoom:b=20,minZoom:x=0,maxPitch:C=60,minPitch:P=0,startPanLngLat:M,startZoomLngLat:k,startRotatePos:z,startBearing:V,startPitch:$,startZoom:tt,normalize:pt=!0}=t;js(Number.isFinite(s)),js(Number.isFinite(i)),js(Number.isFinite(a)),super({width:e,height:n,latitude:i,longitude:s,zoom:a,bearing:o,pitch:d,altitude:p,maxZoom:b,minZoom:x,maxPitch:C,minPitch:P,normalize:pt,position:y},{startPanLngLat:M,startZoomLngLat:k,startRotatePos:z,startBearing:V,startPitch:$,startZoom:tt}),j(this,"makeViewport",void 0),this.makeViewport=t.makeViewport}panStart(t){let{pos:e}=t;return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan(t){let{pos:e,startPos:n}=t;const i=this.getState().startPanLngLat||this._unproject(n);if(!i)return this;const a=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(a)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart(t){let{pos:e}=t;return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate(t){let{pos:e,deltaAngleX:n=0,deltaAngleY:i=0}=t;const{startRotatePos:s,startBearing:a,startPitch:o}=this.getState();if(!s||a===void 0||o===void 0)return this;let d;return e?d=this._getNewRotation(e,s,o,a):d={bearing:a+n,pitch:o+i},this._getUpdatedState(d)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart(t){let{pos:e}=t;return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom(t){let{pos:e,startPos:n,scale:i}=t,{startZoom:s,startZoomLngLat:a}=this.getState();if(a||(s=this.getViewportProps().zoom,a=this._unproject(n)||this._unproject(e)),!a)return this;const{maxZoom:o,minZoom:d}=this.getViewportProps();let p=s+Math.log2(i);p=Nu(p,d,o);const y=this.makeViewport({...this.getViewportProps(),zoom:p});return this._getUpdatedState({zoom:p,...y.panByPosition(a,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2;return this._zoomFromCenter(t)}zoomOut(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2;return this._zoomFromCenter(1/t)}moveLeft(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return this._panFromCenter([t,0])}moveRight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return this._panFromCenter([-t,0])}moveUp(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return this._panFromCenter([0,t])}moveDown(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return this._panFromCenter([0,-t])}rotateLeft(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:s}=n;return Math.abs(i-e.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(s-e.longitude)>180&&(n.longitude=s<0?s+360:s-360),n}applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i}=t;t.zoom=Nu(i,n,e);const{maxPitch:s,minPitch:a,pitch:o}=t;t.pitch=Nu(o,a,s);const{normalize:d=!0}=t;return d&&Object.assign(t,vq(t)),t}_zoomFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}_unproject(t){const e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}_getNewRotation(t,e,n,i){const s=t[0]-e[0],a=t[1]-e[1],o=t[1],d=e[1],{width:p,height:y}=this.getViewportProps(),b=s/p;let x=0;a>0?Math.abs(y-d)>H3&&(x=a/(d-y)*dK):a<0&&d>H3&&(x=1-o/d),x=Nu(x,-1,1);const{minPitch:C,maxPitch:P}=this.getViewportProps(),M=i+180*b;let k=n;return x>0?k=n+x*(P-n):x<0&&(k=n-x*(C-n)),{pitch:k,bearing:M}}}class pK extends AK{constructor(){super(...arguments),j(this,"ControllerState",fK),j(this,"transition",{transitionDuration:300,transitionInterpolator:new z3({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),j(this,"dragMode","pan")}setProps(t){t.position=t.position||[0,0,0];const e=this.props;super.setProps(t),(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...t,...this.state}))}}class sw extends nK{get ViewportType(){return jh}get ControllerType(){return pK}}j(sw,"displayName","MapView");const gK=new Yb;function mK(r,t){var e,n;const i=(e=r.order)!==null&&e!==void 0?e:1/0,s=(n=t.order)!==null&&n!==void 0?n:1/0;return i-s}class yK{constructor(){j(this,"effects",void 0),j(this,"_resolvedEffects",[]),j(this,"_defaultEffects",[]),j(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(t){const e=this._defaultEffects;if(!e.find(n=>n.id===t.id)){const n=e.findIndex(i=>mK(i,t)>0);n<0?e.push(t):e.splice(n,0,t),this._setEffects(this.effects)}}setProps(t){"effects"in t&&(zc(t.effects,this.effects,1)||this._setEffects(t.effects))}needsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._resolvedEffects}_setEffects(t){const e={};for(const i of this.effects)e[i.id]=i;const n=[];for(const i of t){const s=e[i.id];s&&s!==i?s.setProps?(s.setProps(i.props),n.push(s)):(s.cleanup(),n.push(i)):n.push(i),delete e[i.id]}for(const i in e)e[i].cleanup();this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),t.some(i=>i instanceof Yb)||this._resolvedEffects.push(gK),this._needsRedraw="effects changed"}finalize(){for(const t of this._resolvedEffects)t.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class _K extends Gb{shouldDrawLayer(t){const{operation:e}=t.props;return e.includes("draw")||e.includes("terrain")}}const vK="deckRenderer.renderLayers";class bK{constructor(t){j(this,"gl",void 0),j(this,"layerFilter",void 0),j(this,"drawPickingColors",void 0),j(this,"drawLayersPass",void 0),j(this,"pickLayersPass",void 0),j(this,"renderCount",void 0),j(this,"_needsRedraw",void 0),j(this,"renderBuffers",void 0),j(this,"lastPostProcessEffect",void 0),this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new _K(t),this.pickLayersPass=new N3(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){if(!t.viewports.length)return;const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...t,target:t.target||gs.getDefaultFramebuffer(this.gl)};n.effects&&this._preRender(n.effects,n);const i=this.lastPostProcessEffect?this.renderBuffers[0]:n.target,s=e.render({...n,target:i});n.effects&&this._postRender(n.effects,n),this.renderCount++,oo(vK,this,s,t)}needsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){this.lastPostProcessEffect=null,e.preRenderStats=e.preRenderStats||{};for(const n of t)e.preRenderStats[n.id]=n.preRender(this.gl,e),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:t}=this;t.length===0&&t.push(new gs(this.gl),new gs(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:n}=this,i={...e,inputBuffer:n[0],swapBuffer:n[1],target:null};for(const s of t)if(s.postRender){if(s.id===this.lastPostProcessEffect){i.target=e.target,s.postRender(this.gl,i);break}const a=s.postRender(this.gl,i);i.inputBuffer=a,i.swapBuffer=a===n[0]?n[1]:n[0]}}}const wK={pickedColor:null,pickedObjectIndex:-1};function xK(r){let{pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:i,deviceRadius:s,deviceRect:a}=r;const{x:o,y:d,width:p,height:y}=a;let b=s*s,x=-1,C=0;for(let P=0;P<y;P++){const M=P+d-i,k=M*M;if(k>b)C+=4*p;else for(let z=0;z<p;z++){if(t[C+3]-1>=0){const $=z+o-n,tt=$*$+k;tt<=b&&(b=tt,x=C)}C+=4}}if(x>=0){const P=t.slice(x,x+4),M=e(P);if(M){const k=Math.floor(x/4/p),z=x/4-k*p;return{...M,pickedColor:P,pickedX:o+z,pickedY:d+k}}Tn.error("Picked non-existent layer. Is picking buffer corrupt?")()}return wK}function BK(r){let{pickedColors:t,decodePickingColor:e}=r;const n=new Map;if(t){for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const a=t.slice(i,i+4),o=a.join(",");if(!n.has(o)){const d=e(a);d?n.set(o,{...d,color:a}):Tn.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function V3(r){let{pickInfo:t,viewports:e,pixelRatio:n,x:i,y:s,z:a}=r,o=e[0];e.length>1&&(o=EK((t==null?void 0:t.pickedViewports)||e,{x:i,y:s}));let d;if(o){const p=[i-o.x,s-o.y];a!==void 0&&(p[2]=a),d=o.unproject(p)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:i,y:s,pixel:[i,s],coordinate:d,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function CK(r){const{pickInfo:t,lastPickedInfo:e,mode:n,layers:i}=r,{pickedColor:s,pickedLayer:a,pickedObjectIndex:o}=t,d=a?[a]:[];if(n==="hover"){const b=e.index,x=e.layerId,C=a?a.props.id:null;if(C!==x||o!==b){if(C!==x){const P=i.find(M=>M.props.id===x);P&&d.unshift(P)}e.layerId=C,e.index=o,e.info=null}}const p=V3(r),y=new Map;return y.set(null,p),d.forEach(b=>{let x={...p};b===a&&(x.color=s,x.index=o,x.picked=!0),x=G3({layer:b,info:x,mode:n});const C=x.layer;b===a&&n==="hover"&&(e.info=x),y.set(C.id,x),n==="hover"&&C.updateAutoHighlight(x)}),y}function G3(r){let{layer:t,info:e,mode:n}=r;for(;t&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:i}),t=t.parent}return e}function EK(r,t){for(let e=r.length-1;e>=0;e--){const n=r[e];if(n.containsPixel(t))return n}return r[0]}class SK{constructor(t){j(this,"gl",void 0),j(this,"pickingFBO",void 0),j(this,"depthFBO",void 0),j(this,"pickLayersPass",void 0),j(this,"layerFilter",void 0),j(this,"lastPickedInfo",void 0),j(this,"_pickable",!0),this.gl=t,this.pickLayersPass=new N3(t),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject(t){let{x:e,y:n,layers:i,viewports:s}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.lastPickedInfo.info;const o=a&&a.layer&&a.layer.id,d=a&&a.viewport&&a.viewport.id,p=o?i.find(C=>C.id===o):null,y=d&&s.find(C=>C.id===d)||s[0],b=y&&y.unproject([e-y.x,n-y.y]);return{...a,...{x:e,y:n,viewport:y,coordinate:b,layer:p}}}_resizeBuffer(){var t,e;const{gl:n}=this;if(!this.pickingFBO&&(this.pickingFBO=new gs(n),gs.isSupported(n,{colorBufferFloat:!0}))){const i=new gs(n);i.attach({36064:new Ca(n,{format:fn(n)?34836:6408,type:5126})}),this.depthFBO=i}(t=this.pickingFBO)===null||t===void 0||t.resize({width:n.canvas.width,height:n.canvas.height}),(e=this.depthFBO)===null||e===void 0||e.resize({width:n.canvas.width,height:n.canvas.height})}_getPickable(t){if(this._pickable===!1)return null;const e=t.filter(n=>this.pickLayersPass.shouldDrawLayer(n)&&!n.isComposite);return e.length?e:null}_pickClosestObject(t){let{layers:e,views:n,viewports:i,x:s,y:a,radius:o=0,depth:d=1,mode:p="query",unproject3D:y,onViewportActive:b,effects:x}=t;const C=this._getPickable(e),P=Zd(this.gl);if(!C)return{result:[],emptyInfo:V3({viewports:i,x:s,y:a,pixelRatio:P})};this._resizeBuffer();const M=rb(this.gl,[s,a],!0),k=[M.x+Math.floor(M.width/2),M.y+Math.floor(M.height/2)],z=Math.round(o*P),{width:V,height:$}=this.pickingFBO,tt=this._getPickingRect({deviceX:k[0],deviceY:k[1],deviceRadius:z,deviceWidth:V,deviceHeight:$}),pt={x:s-o,y:a-o,width:o*2+1,height:o*2+1};let gt;const mt=[],dt=new Set;for(let Ft=0;Ft<d;Ft++){let Tt;if(tt){const ct=this._drawAndSample({layers:C,views:n,viewports:i,onViewportActive:b,deviceRect:tt,cullRect:pt,effects:x,pass:"picking:".concat(p)});Tt=xK({...ct,deviceX:k[0],deviceY:k[1],deviceRadius:z,deviceRect:tt})}else Tt={pickedColor:null,pickedObjectIndex:-1};let ot;if(Tt.pickedLayer&&y&&this.depthFBO){const{pickedColors:ct}=this._drawAndSample({layers:[Tt.pickedLayer],views:n,viewports:i,onViewportActive:b,deviceRect:{x:Tt.pickedX,y:Tt.pickedY,width:1,height:1},cullRect:pt,effects:x,pass:"picking:".concat(p,":z")},!0);ct[3]&&(ot=ct[0])}Tt.pickedLayer&&Ft+1<d&&(dt.add(Tt.pickedLayer),Tt.pickedLayer.disablePickingIndex(Tt.pickedObjectIndex)),gt=CK({pickInfo:Tt,lastPickedInfo:this.lastPickedInfo,mode:p,layers:C,viewports:i,x:s,y:a,z:ot,pixelRatio:P});for(const ct of gt.values())ct.layer&&mt.push(ct);if(!Tt.pickedColor)break}for(const Ft of dt)Ft.restorePickingColors();return{result:mt,emptyInfo:gt.get(null)}}_pickVisibleObjects(t){let{layers:e,views:n,viewports:i,x:s,y:a,width:o=1,height:d=1,mode:p="query",maxObjects:y=null,onViewportActive:b,effects:x}=t;const C=this._getPickable(e);if(!C)return[];this._resizeBuffer();const P=Zd(this.gl),M=rb(this.gl,[s,a],!0),k=M.x,z=M.y+M.height,V=rb(this.gl,[s+o,a+d],!0),$=V.x+V.width,tt=V.y,pt={x:k,y:tt,width:$-k,height:z-tt},gt=this._drawAndSample({layers:C,views:n,viewports:i,onViewportActive:b,deviceRect:pt,cullRect:{x:s,y:a,width:o,height:d},effects:x,pass:"picking:".concat(p)}),mt=BK(gt),dt=new Map,Ft=Number.isFinite(y);for(let ot=0;ot<mt.length;ot++){var Tt;if(Ft&&y&&dt.size>=y)break;const ct=mt[ot];let wt={color:ct.pickedColor,layer:null,index:ct.pickedObjectIndex,picked:!0,x:s,y:a,pixelRatio:P};wt=G3({layer:ct.pickedLayer,info:wt,mode:p});const vt=(Tt=wt.object)!==null&&Tt!==void 0?Tt:"".concat(wt.layer.id,"[").concat(wt.index,"]");dt.has(vt)||dt.set(vt,wt)}return Array.from(dt.values())}_drawAndSample(t){let{layers:e,views:n,viewports:i,onViewportActive:s,deviceRect:a,cullRect:o,effects:d,pass:p}=t,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const b=y?this.depthFBO:this.pickingFBO,x={layers:e,layerFilter:this.layerFilter,views:n,viewports:i,onViewportActive:s,pickingFBO:b,deviceRect:a,cullRect:o,effects:d,pass:p,pickZ:y,preRenderStats:{}};for(const $ of d)$.useInPicking&&(x.preRenderStats[$.id]=$.preRender(this.gl,x));const{decodePickingColor:C}=this.pickLayersPass.render(x),{x:P,y:M,width:k,height:z}=a,V=new(y?Float32Array:Uint8Array)(k*z*4);return L0(b,{sourceX:P,sourceY:M,sourceWidth:k,sourceHeight:z,target:V}),{pickedColors:V,decodePickingColor:C}}_getPickingRect(t){let{deviceX:e,deviceY:n,deviceRadius:i,deviceWidth:s,deviceHeight:a}=t;const o=Math.max(0,e-i),d=Math.max(0,n-i),p=Math.min(s,e+i+1)-o,y=Math.min(a,n+i+1)-d;return p<=0||y<=0?null:{x:o,y:d,width:p,height:y}}}const TK={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class IK{constructor(t){j(this,"el",null),j(this,"isVisible",!1);const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,TK),e.appendChild(this.el))}setTooltip(t,e,n){const i=this.el;if(i){if(typeof t=="string")i.innerText=t;else if(t)t.text&&(i.innerText=t.text),t.html&&(i.innerHTML=t.html),t.className&&(i.className=t.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(e,"px, ").concat(n,"px)"),t&&typeof t=="object"&&"style"in t&&Object.assign(i.style,t.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var j3={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(r){(function(t,e,n,i){var s=["","webkit","Moz","MS","ms","o"],a=e.createElement("div"),o="function",d=Math.round,p=Math.abs,y=Date.now;function b(ht,bt,Nt){return setTimeout($(ht,Nt),bt)}function x(ht,bt,Nt){return Array.isArray(ht)?(C(ht,Nt[bt],Nt),!0):!1}function C(ht,bt,Nt){var le;if(ht)if(ht.forEach)ht.forEach(bt,Nt);else if(ht.length!==i)for(le=0;le<ht.length;)bt.call(Nt,ht[le],le,ht),le++;else for(le in ht)ht.hasOwnProperty(le)&&bt.call(Nt,ht[le],le,ht)}function P(ht,bt,Nt){var le="DEPRECATED METHOD: "+bt+`
`+Nt+` AT 
`;return function(){var Ie=new Error("get-stack-trace"),Ze=Ie&&Ie.stack?Ie.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",zr=t.console&&(t.console.warn||t.console.log);return zr&&zr.call(t.console,le,Ze),ht.apply(this,arguments)}}var M;typeof Object.assign!="function"?M=function(bt){if(bt===i||bt===null)throw new TypeError("Cannot convert undefined or null to object");for(var Nt=Object(bt),le=1;le<arguments.length;le++){var Ie=arguments[le];if(Ie!==i&&Ie!==null)for(var Ze in Ie)Ie.hasOwnProperty(Ze)&&(Nt[Ze]=Ie[Ze])}return Nt}:M=Object.assign;var k=P(function(bt,Nt,le){for(var Ie=Object.keys(Nt),Ze=0;Ze<Ie.length;)(!le||le&&bt[Ie[Ze]]===i)&&(bt[Ie[Ze]]=Nt[Ie[Ze]]),Ze++;return bt},"extend","Use `assign`."),z=P(function(bt,Nt){return k(bt,Nt,!0)},"merge","Use `assign`.");function V(ht,bt,Nt){var le=bt.prototype,Ie;Ie=ht.prototype=Object.create(le),Ie.constructor=ht,Ie._super=le,Nt&&M(Ie,Nt)}function $(ht,bt){return function(){return ht.apply(bt,arguments)}}function tt(ht,bt){return typeof ht==o?ht.apply(bt&&bt[0]||i,bt):ht}function pt(ht,bt){return ht===i?bt:ht}function gt(ht,bt,Nt){C(Tt(bt),function(le){ht.addEventListener(le,Nt,!1)})}function mt(ht,bt,Nt){C(Tt(bt),function(le){ht.removeEventListener(le,Nt,!1)})}function dt(ht,bt){for(;ht;){if(ht==bt)return!0;ht=ht.parentNode}return!1}function Ft(ht,bt){return ht.indexOf(bt)>-1}function Tt(ht){return ht.trim().split(/\s+/g)}function ot(ht,bt,Nt){if(ht.indexOf&&!Nt)return ht.indexOf(bt);for(var le=0;le<ht.length;){if(Nt&&ht[le][Nt]==bt||!Nt&&ht[le]===bt)return le;le++}return-1}function ct(ht){return Array.prototype.slice.call(ht,0)}function wt(ht,bt,Nt){for(var le=[],Ie=[],Ze=0;Ze<ht.length;){var zr=ht[Ze][bt];ot(Ie,zr)<0&&le.push(ht[Ze]),Ie[Ze]=zr,Ze++}return le=le.sort(function(ti,Fi){return ti[bt]>Fi[bt]}),le}function vt(ht,bt){for(var Nt,le,Ie=bt[0].toUpperCase()+bt.slice(1),Ze=0;Ze<s.length;){if(Nt=s[Ze],le=Nt?Nt+Ie:bt,le in ht)return le;Ze++}return i}var $t=1;function Wt(){return $t++}function Yt(ht){var bt=ht.ownerDocument||ht;return bt.defaultView||bt.parentWindow||t}var Kt=/mobile|tablet|ip(ad|hone|od)|android/i,ee="ontouchstart"in t,Zt=vt(t,"PointerEvent")!==i,we=ee&&Kt.test(navigator.userAgent),it="touch",xt="pen",It="mouse",Ut="kinect",jt=25,Vt=1,re=2,te=4,Ce=8,Te=1,De=2,Qe=4,Je=8,he=16,st=De|Qe,fr=Je|he,er=st|fr,de=["x","y"],ve=["clientX","clientY"];function Le(ht,bt){var Nt=this;this.manager=ht,this.callback=bt,this.element=ht.element,this.target=ht.options.inputTarget,this.domHandler=function(le){tt(ht.options.enable,[ht])&&Nt.handler(le)},this.init()}Le.prototype={handler:function(){},init:function(){this.evEl&&gt(this.element,this.evEl,this.domHandler),this.evTarget&&gt(this.target,this.evTarget,this.domHandler),this.evWin&&gt(Yt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&mt(this.element,this.evEl,this.domHandler),this.evTarget&&mt(this.target,this.evTarget,this.domHandler),this.evWin&&mt(Yt(this.element),this.evWin,this.domHandler)}};function Ue(ht){var bt,Nt=ht.options.inputClass;return Nt?bt=Nt:Zt?bt=Ct:we?bt=Pt:ee?bt=xe:bt=ke,new bt(ht,Ye)}function Ye(ht,bt,Nt){var le=Nt.pointers.length,Ie=Nt.changedPointers.length,Ze=bt&Vt&&le-Ie===0,zr=bt&(te|Ce)&&le-Ie===0;Nt.isFirst=!!Ze,Nt.isFinal=!!zr,Ze&&(ht.session={}),Nt.eventType=bt,lr(ht,Nt),ht.emit("hammer.input",Nt),ht.recognize(Nt),ht.session.prevInput=Nt}function lr(ht,bt){var Nt=ht.session,le=bt.pointers,Ie=le.length;Nt.firstInput||(Nt.firstInput=Dr(bt)),Ie>1&&!Nt.firstMultiple?Nt.firstMultiple=Dr(bt):Ie===1&&(Nt.firstMultiple=!1);var Ze=Nt.firstInput,zr=Nt.firstMultiple,Zn=zr?zr.center:Ze.center,ti=bt.center=pe(le);bt.timeStamp=y(),bt.deltaTime=bt.timeStamp-Ze.timeStamp,bt.angle=An(Zn,ti),bt.distance=Re(Zn,ti),yr(Nt,bt),bt.offsetDirection=_r(bt.deltaX,bt.deltaY);var Fi=cr(bt.deltaTime,bt.deltaX,bt.deltaY);bt.overallVelocityX=Fi.x,bt.overallVelocityY=Fi.y,bt.overallVelocity=p(Fi.x)>p(Fi.y)?Fi.x:Fi.y,bt.scale=zr?gr(zr.pointers,le):1,bt.rotation=zr?me(zr.pointers,le):0,bt.maxPointers=Nt.prevInput?bt.pointers.length>Nt.prevInput.maxPointers?bt.pointers.length:Nt.prevInput.maxPointers:bt.pointers.length,Lr(Nt,bt);var yn=ht.element;dt(bt.srcEvent.target,yn)&&(yn=bt.srcEvent.target),bt.target=yn}function yr(ht,bt){var Nt=bt.center,le=ht.offsetDelta||{},Ie=ht.prevDelta||{},Ze=ht.prevInput||{};(bt.eventType===Vt||Ze.eventType===te)&&(Ie=ht.prevDelta={x:Ze.deltaX||0,y:Ze.deltaY||0},le=ht.offsetDelta={x:Nt.x,y:Nt.y}),bt.deltaX=Ie.x+(Nt.x-le.x),bt.deltaY=Ie.y+(Nt.y-le.y)}function Lr(ht,bt){var Nt=ht.lastInterval||bt,le=bt.timeStamp-Nt.timeStamp,Ie,Ze,zr,Zn;if(bt.eventType!=Ce&&(le>jt||Nt.velocity===i)){var ti=bt.deltaX-Nt.deltaX,Fi=bt.deltaY-Nt.deltaY,yn=cr(le,ti,Fi);Ze=yn.x,zr=yn.y,Ie=p(yn.x)>p(yn.y)?yn.x:yn.y,Zn=_r(ti,Fi),ht.lastInterval=bt}else Ie=Nt.velocity,Ze=Nt.velocityX,zr=Nt.velocityY,Zn=Nt.direction;bt.velocity=Ie,bt.velocityX=Ze,bt.velocityY=zr,bt.direction=Zn}function Dr(ht){for(var bt=[],Nt=0;Nt<ht.pointers.length;)bt[Nt]={clientX:d(ht.pointers[Nt].clientX),clientY:d(ht.pointers[Nt].clientY)},Nt++;return{timeStamp:y(),pointers:bt,center:pe(bt),deltaX:ht.deltaX,deltaY:ht.deltaY}}function pe(ht){var bt=ht.length;if(bt===1)return{x:d(ht[0].clientX),y:d(ht[0].clientY)};for(var Nt=0,le=0,Ie=0;Ie<bt;)Nt+=ht[Ie].clientX,le+=ht[Ie].clientY,Ie++;return{x:d(Nt/bt),y:d(le/bt)}}function cr(ht,bt,Nt){return{x:bt/ht||0,y:Nt/ht||0}}function _r(ht,bt){return ht===bt?Te:p(ht)>=p(bt)?ht<0?De:Qe:bt<0?Je:he}function Re(ht,bt,Nt){Nt||(Nt=de);var le=bt[Nt[0]]-ht[Nt[0]],Ie=bt[Nt[1]]-ht[Nt[1]];return Math.sqrt(le*le+Ie*Ie)}function An(ht,bt,Nt){Nt||(Nt=de);var le=bt[Nt[0]]-ht[Nt[0]],Ie=bt[Nt[1]]-ht[Nt[1]];return Math.atan2(Ie,le)*180/Math.PI}function me(ht,bt){return An(bt[1],bt[0],ve)+An(ht[1],ht[0],ve)}function gr(ht,bt){return Re(bt[0],bt[1],ve)/Re(ht[0],ht[1],ve)}var Ne={mousedown:Vt,mousemove:re,mouseup:te},Ur="mousedown",_n="mousemove mouseup";function ke(){this.evEl=Ur,this.evWin=_n,this.pressed=!1,Le.apply(this,arguments)}V(ke,Le,{handler:function(bt){var Nt=Ne[bt.type];Nt&Vt&&bt.button===0&&(this.pressed=!0),Nt&re&&bt.which!==1&&(Nt=te),this.pressed&&(Nt&te&&(this.pressed=!1),this.callback(this.manager,Nt,{pointers:[bt],changedPointers:[bt],pointerType:It,srcEvent:bt}))}});var Qn={pointerdown:Vt,pointermove:re,pointerup:te,pointercancel:Ce,pointerout:Ce},nn={2:it,3:xt,4:It,5:Ut},vn="pointerdown",ln="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(vn="MSPointerDown",ln="MSPointerMove MSPointerUp MSPointerCancel");function Ct(){this.evEl=vn,this.evWin=ln,Le.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}V(Ct,Le,{handler:function(bt){var Nt=this.store,le=!1,Ie=bt.type.toLowerCase().replace("ms",""),Ze=Qn[Ie],zr=nn[bt.pointerType]||bt.pointerType,Zn=zr==it,ti=ot(Nt,bt.pointerId,"pointerId");Ze&Vt&&(bt.button===0||Zn)?ti<0&&(Nt.push(bt),ti=Nt.length-1):Ze&(te|Ce)&&(le=!0),!(ti<0)&&(Nt[ti]=bt,this.callback(this.manager,Ze,{pointers:Nt,changedPointers:[bt],pointerType:zr,srcEvent:bt}),le&&Nt.splice(ti,1))}});var W={touchstart:Vt,touchmove:re,touchend:te,touchcancel:Ce},X="touchstart",ft="touchstart touchmove touchend touchcancel";function Bt(){this.evTarget=X,this.evWin=ft,this.started=!1,Le.apply(this,arguments)}V(Bt,Le,{handler:function(bt){var Nt=W[bt.type];if(Nt===Vt&&(this.started=!0),!!this.started){var le=kt.call(this,bt,Nt);Nt&(te|Ce)&&le[0].length-le[1].length===0&&(this.started=!1),this.callback(this.manager,Nt,{pointers:le[0],changedPointers:le[1],pointerType:it,srcEvent:bt})}}});function kt(ht,bt){var Nt=ct(ht.touches),le=ct(ht.changedTouches);return bt&(te|Ce)&&(Nt=wt(Nt.concat(le),"identifier")),[Nt,le]}var Gt={touchstart:Vt,touchmove:re,touchend:te,touchcancel:Ce},Ot="touchstart touchmove touchend touchcancel";function Pt(){this.evTarget=Ot,this.targetIds={},Le.apply(this,arguments)}V(Pt,Le,{handler:function(bt){var Nt=Gt[bt.type],le=ae.call(this,bt,Nt);le&&this.callback(this.manager,Nt,{pointers:le[0],changedPointers:le[1],pointerType:it,srcEvent:bt})}});function ae(ht,bt){var Nt=ct(ht.touches),le=this.targetIds;if(bt&(Vt|re)&&Nt.length===1)return le[Nt[0].identifier]=!0,[Nt,Nt];var Ie,Ze,zr=ct(ht.changedTouches),Zn=[],ti=this.target;if(Ze=Nt.filter(function(Fi){return dt(Fi.target,ti)}),bt===Vt)for(Ie=0;Ie<Ze.length;)le[Ze[Ie].identifier]=!0,Ie++;for(Ie=0;Ie<zr.length;)le[zr[Ie].identifier]&&Zn.push(zr[Ie]),bt&(te|Ce)&&delete le[zr[Ie].identifier],Ie++;if(Zn.length)return[wt(Ze.concat(Zn),"identifier"),Zn]}var fe=2500,Jt=25;function xe(){Le.apply(this,arguments);var ht=$(this.handler,this);this.touch=new Pt(this.manager,ht),this.mouse=new ke(this.manager,ht),this.primaryTouch=null,this.lastTouches=[]}V(xe,Le,{handler:function(bt,Nt,le){var Ie=le.pointerType==it,Ze=le.pointerType==It;if(!(Ze&&le.sourceCapabilities&&le.sourceCapabilities.firesTouchEvents)){if(Ie)Ge.call(this,Nt,le);else if(Ze&&Br.call(this,le))return;this.callback(bt,Nt,le)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Ge(ht,bt){ht&Vt?(this.primaryTouch=bt.changedPointers[0].identifier,nr.call(this,bt)):ht&(te|Ce)&&nr.call(this,bt)}function nr(ht){var bt=ht.changedPointers[0];if(bt.identifier===this.primaryTouch){var Nt={x:bt.clientX,y:bt.clientY};this.lastTouches.push(Nt);var le=this.lastTouches,Ie=function(){var Ze=le.indexOf(Nt);Ze>-1&&le.splice(Ze,1)};setTimeout(Ie,fe)}}function Br(ht){for(var bt=ht.srcEvent.clientX,Nt=ht.srcEvent.clientY,le=0;le<this.lastTouches.length;le++){var Ie=this.lastTouches[le],Ze=Math.abs(bt-Ie.x),zr=Math.abs(Nt-Ie.y);if(Ze<=Jt&&zr<=Jt)return!0}return!1}var Tr=vt(a.style,"touchAction"),pr=Tr!==i,Qr="compute",Gr="auto",cn="manipulation",br="none",jr="pan-x",sn="pan-y",Sn=Ee();function Mt(ht,bt){this.manager=ht,this.set(bt)}Mt.prototype={set:function(ht){ht==Qr&&(ht=this.compute()),pr&&this.manager.element.style&&Sn[ht]&&(this.manager.element.style[Tr]=ht),this.actions=ht.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ht=[];return C(this.manager.recognizers,function(bt){tt(bt.options.enable,[bt])&&(ht=ht.concat(bt.getTouchAction()))}),Oe(ht.join(" "))},preventDefaults:function(ht){var bt=ht.srcEvent,Nt=ht.offsetDirection;if(this.manager.session.prevented){bt.preventDefault();return}var le=this.actions,Ie=Ft(le,br)&&!Sn[br],Ze=Ft(le,sn)&&!Sn[sn],zr=Ft(le,jr)&&!Sn[jr];if(Ie){var Zn=ht.pointers.length===1,ti=ht.distance<2,Fi=ht.deltaTime<250;if(Zn&&ti&&Fi)return}if(!(zr&&Ze)&&(Ie||Ze&&Nt&st||zr&&Nt&fr))return this.preventSrc(bt)},preventSrc:function(ht){this.manager.session.prevented=!0,ht.preventDefault()}};function Oe(ht){if(Ft(ht,br))return br;var bt=Ft(ht,jr),Nt=Ft(ht,sn);return bt&&Nt?br:bt||Nt?bt?jr:sn:Ft(ht,cn)?cn:Gr}function Ee(){if(!pr)return!1;var ht={},bt=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Nt){ht[Nt]=bt?t.CSS.supports("touch-action",Nt):!0}),ht}var or=1,Pr=2,Mn=4,qr=8,gn=qr,vi=16,mn=32;function Wr(ht){this.options=M({},this.defaults,ht||{}),this.id=Wt(),this.manager=null,this.options.enable=pt(this.options.enable,!0),this.state=or,this.simultaneous={},this.requireFail=[]}Wr.prototype={defaults:{},set:function(ht){return M(this.options,ht),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ht){if(x(ht,"recognizeWith",this))return this;var bt=this.simultaneous;return ht=zn(ht,this),bt[ht.id]||(bt[ht.id]=ht,ht.recognizeWith(this)),this},dropRecognizeWith:function(ht){return x(ht,"dropRecognizeWith",this)?this:(ht=zn(ht,this),delete this.simultaneous[ht.id],this)},requireFailure:function(ht){if(x(ht,"requireFailure",this))return this;var bt=this.requireFail;return ht=zn(ht,this),ot(bt,ht)===-1&&(bt.push(ht),ht.requireFailure(this)),this},dropRequireFailure:function(ht){if(x(ht,"dropRequireFailure",this))return this;ht=zn(ht,this);var bt=ot(this.requireFail,ht);return bt>-1&&this.requireFail.splice(bt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ht){return!!this.simultaneous[ht.id]},emit:function(ht){var bt=this,Nt=this.state;function le(Ie){bt.manager.emit(Ie,ht)}Nt<qr&&le(bt.options.event+Da(Nt)),le(bt.options.event),ht.additionalEvent&&le(ht.additionalEvent),Nt>=qr&&le(bt.options.event+Da(Nt))},tryEmit:function(ht){if(this.canEmit())return this.emit(ht);this.state=mn},canEmit:function(){for(var ht=0;ht<this.requireFail.length;){if(!(this.requireFail[ht].state&(mn|or)))return!1;ht++}return!0},recognize:function(ht){var bt=M({},ht);if(!tt(this.options.enable,[this,bt])){this.reset(),this.state=mn;return}this.state&(gn|vi|mn)&&(this.state=or),this.state=this.process(bt),this.state&(Pr|Mn|qr|vi)&&this.tryEmit(bt)},process:function(ht){},getTouchAction:function(){},reset:function(){}};function Da(ht){return ht&vi?"cancel":ht&qr?"end":ht&Mn?"move":ht&Pr?"start":""}function Xs(ht){return ht==he?"down":ht==Je?"up":ht==De?"left":ht==Qe?"right":""}function zn(ht,bt){var Nt=bt.manager;return Nt?Nt.get(ht):ht}function Jr(){Wr.apply(this,arguments)}V(Jr,Wr,{defaults:{pointers:1},attrTest:function(ht){var bt=this.options.pointers;return bt===0||ht.pointers.length===bt},process:function(ht){var bt=this.state,Nt=ht.eventType,le=bt&(Pr|Mn),Ie=this.attrTest(ht);return le&&(Nt&Ce||!Ie)?bt|vi:le||Ie?Nt&te?bt|qr:bt&Pr?bt|Mn:Pr:mn}});function vs(){Jr.apply(this,arguments),this.pX=null,this.pY=null}V(vs,Jr,{defaults:{event:"pan",threshold:10,pointers:1,direction:er},getTouchAction:function(){var ht=this.options.direction,bt=[];return ht&st&&bt.push(sn),ht&fr&&bt.push(jr),bt},directionTest:function(ht){var bt=this.options,Nt=!0,le=ht.distance,Ie=ht.direction,Ze=ht.deltaX,zr=ht.deltaY;return Ie&bt.direction||(bt.direction&st?(Ie=Ze===0?Te:Ze<0?De:Qe,Nt=Ze!=this.pX,le=Math.abs(ht.deltaX)):(Ie=zr===0?Te:zr<0?Je:he,Nt=zr!=this.pY,le=Math.abs(ht.deltaY))),ht.direction=Ie,Nt&&le>bt.threshold&&Ie&bt.direction},attrTest:function(ht){return Jr.prototype.attrTest.call(this,ht)&&(this.state&Pr||!(this.state&Pr)&&this.directionTest(ht))},emit:function(ht){this.pX=ht.deltaX,this.pY=ht.deltaY;var bt=Xs(ht.direction);bt&&(ht.additionalEvent=this.options.event+bt),this._super.emit.call(this,ht)}});function Nn(){Jr.apply(this,arguments)}V(Nn,Jr,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[br]},attrTest:function(ht){return this._super.attrTest.call(this,ht)&&(Math.abs(ht.scale-1)>this.options.threshold||this.state&Pr)},emit:function(ht){if(ht.scale!==1){var bt=ht.scale<1?"in":"out";ht.additionalEvent=this.options.event+bt}this._super.emit.call(this,ht)}});function Qo(){Wr.apply(this,arguments),this._timer=null,this._input=null}V(Qo,Wr,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Gr]},process:function(ht){var bt=this.options,Nt=ht.pointers.length===bt.pointers,le=ht.distance<bt.threshold,Ie=ht.deltaTime>bt.time;if(this._input=ht,!le||!Nt||ht.eventType&(te|Ce)&&!Ie)this.reset();else if(ht.eventType&Vt)this.reset(),this._timer=b(function(){this.state=gn,this.tryEmit()},bt.time,this);else if(ht.eventType&te)return gn;return mn},reset:function(){clearTimeout(this._timer)},emit:function(ht){this.state===gn&&(ht&&ht.eventType&te?this.manager.emit(this.options.event+"up",ht):(this._input.timeStamp=y(),this.manager.emit(this.options.event,this._input)))}});function Ti(){Jr.apply(this,arguments)}V(Ti,Jr,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[br]},attrTest:function(ht){return this._super.attrTest.call(this,ht)&&(Math.abs(ht.rotation)>this.options.threshold||this.state&Pr)}});function zo(){Jr.apply(this,arguments)}V(zo,Jr,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:st|fr,pointers:1},getTouchAction:function(){return vs.prototype.getTouchAction.call(this)},attrTest:function(ht){var bt=this.options.direction,Nt;return bt&(st|fr)?Nt=ht.overallVelocity:bt&st?Nt=ht.overallVelocityX:bt&fr&&(Nt=ht.overallVelocityY),this._super.attrTest.call(this,ht)&&bt&ht.offsetDirection&&ht.distance>this.options.threshold&&ht.maxPointers==this.options.pointers&&p(Nt)>this.options.velocity&&ht.eventType&te},emit:function(ht){var bt=Xs(ht.offsetDirection);bt&&this.manager.emit(this.options.event+bt,ht),this.manager.emit(this.options.event,ht)}});function hi(){Wr.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}V(hi,Wr,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[cn]},process:function(ht){var bt=this.options,Nt=ht.pointers.length===bt.pointers,le=ht.distance<bt.threshold,Ie=ht.deltaTime<bt.time;if(this.reset(),ht.eventType&Vt&&this.count===0)return this.failTimeout();if(le&&Ie&&Nt){if(ht.eventType!=te)return this.failTimeout();var Ze=this.pTime?ht.timeStamp-this.pTime<bt.interval:!0,zr=!this.pCenter||Re(this.pCenter,ht.center)<bt.posThreshold;this.pTime=ht.timeStamp,this.pCenter=ht.center,!zr||!Ze?this.count=1:this.count+=1,this._input=ht;var Zn=this.count%bt.taps;if(Zn===0)return this.hasRequireFailures()?(this._timer=b(function(){this.state=gn,this.tryEmit()},bt.interval,this),Pr):gn}return mn},failTimeout:function(){return this._timer=b(function(){this.state=mn},this.options.interval,this),mn},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==gn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ts(ht,bt){return bt=bt||{},bt.recognizers=pt(bt.recognizers,ts.defaults.preset),new tn(ht,bt)}ts.VERSION="2.0.7",ts.defaults={domEvents:!1,touchAction:Qr,enable:!0,inputTarget:null,inputClass:null,preset:[[Ti,{enable:!1}],[Nn,{enable:!1},["rotate"]],[zo,{direction:st}],[vs,{direction:st},["swipe"]],[hi],[hi,{event:"doubletap",taps:2},["tap"]],[Qo]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Ii=1,bs=2;function tn(ht,bt){this.options=M({},ts.defaults,bt||{}),this.options.inputTarget=this.options.inputTarget||ht,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ht,this.input=Ue(this),this.touchAction=new Mt(this,this.options.touchAction),Na(this,!0),C(this.options.recognizers,function(Nt){var le=this.add(new Nt[0](Nt[1]));Nt[2]&&le.recognizeWith(Nt[2]),Nt[3]&&le.requireFailure(Nt[3])},this)}tn.prototype={set:function(ht){return M(this.options,ht),ht.touchAction&&this.touchAction.update(),ht.inputTarget&&(this.input.destroy(),this.input.target=ht.inputTarget,this.input.init()),this},stop:function(ht){this.session.stopped=ht?bs:Ii},recognize:function(ht){var bt=this.session;if(!bt.stopped){this.touchAction.preventDefaults(ht);var Nt,le=this.recognizers,Ie=bt.curRecognizer;(!Ie||Ie&&Ie.state&gn)&&(Ie=bt.curRecognizer=null);for(var Ze=0;Ze<le.length;)Nt=le[Ze],bt.stopped!==bs&&(!Ie||Nt==Ie||Nt.canRecognizeWith(Ie))?Nt.recognize(ht):Nt.reset(),!Ie&&Nt.state&(Pr|Mn|qr)&&(Ie=bt.curRecognizer=Nt),Ze++}},get:function(ht){if(ht instanceof Wr)return ht;for(var bt=this.recognizers,Nt=0;Nt<bt.length;Nt++)if(bt[Nt].options.event==ht)return bt[Nt];return null},add:function(ht){if(x(ht,"add",this))return this;var bt=this.get(ht.options.event);return bt&&this.remove(bt),this.recognizers.push(ht),ht.manager=this,this.touchAction.update(),ht},remove:function(ht){if(x(ht,"remove",this))return this;if(ht=this.get(ht),ht){var bt=this.recognizers,Nt=ot(bt,ht);Nt!==-1&&(bt.splice(Nt,1),this.touchAction.update())}return this},on:function(ht,bt){if(ht!==i&&bt!==i){var Nt=this.handlers;return C(Tt(ht),function(le){Nt[le]=Nt[le]||[],Nt[le].push(bt)}),this}},off:function(ht,bt){if(ht!==i){var Nt=this.handlers;return C(Tt(ht),function(le){bt?Nt[le]&&Nt[le].splice(ot(Nt[le],bt),1):delete Nt[le]}),this}},emit:function(ht,bt){this.options.domEvents&&_l(ht,bt);var Nt=this.handlers[ht]&&this.handlers[ht].slice();if(!(!Nt||!Nt.length)){bt.type=ht,bt.preventDefault=function(){bt.srcEvent.preventDefault()};for(var le=0;le<Nt.length;)Nt[le](bt),le++}},destroy:function(){this.element&&Na(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Na(ht,bt){var Nt=ht.element;if(Nt.style){var le;C(ht.options.cssProps,function(Ie,Ze){le=vt(Nt.style,Ze),bt?(ht.oldCssProps[le]=Nt.style[le],Nt.style[le]=Ie):Nt.style[le]=ht.oldCssProps[le]||""}),bt||(ht.oldCssProps={})}}function _l(ht,bt){var Nt=e.createEvent("Event");Nt.initEvent(ht,!0,!0),Nt.gesture=bt,bt.target.dispatchEvent(Nt)}M(ts,{INPUT_START:Vt,INPUT_MOVE:re,INPUT_END:te,INPUT_CANCEL:Ce,STATE_POSSIBLE:or,STATE_BEGAN:Pr,STATE_CHANGED:Mn,STATE_ENDED:qr,STATE_RECOGNIZED:gn,STATE_CANCELLED:vi,STATE_FAILED:mn,DIRECTION_NONE:Te,DIRECTION_LEFT:De,DIRECTION_RIGHT:Qe,DIRECTION_UP:Je,DIRECTION_DOWN:he,DIRECTION_HORIZONTAL:st,DIRECTION_VERTICAL:fr,DIRECTION_ALL:er,Manager:tn,Input:Le,TouchAction:Mt,TouchInput:Pt,MouseInput:ke,PointerEventInput:Ct,TouchMouseInput:xe,SingleTouchInput:Bt,Recognizer:Wr,AttrRecognizer:Jr,Tap:hi,Pan:vs,Swipe:zo,Pinch:Nn,Rotate:Ti,Press:Qo,on:gt,off:mt,each:C,merge:z,extend:k,assign:M,inherit:V,bindFn:$,prefixed:vt});var ka=typeof t<"u"?t:typeof self<"u"?self:{};ka.Hammer=ts,r.exports?r.exports=ts:t[n]=ts})(window,document,"Hammer")})(j3);var Bg=j3.exports;const Hc=Dp({__proto__:null,default:Np(Bg)},[Bg]),q3=1,K3=2,ow=4,FK={mousedown:q3,mousemove:K3,mouseup:ow};function LK(r,t){for(let e=0;e<r.length;e++)if(t(r[e]))return!0;return!1}function PK(r){const t=r.prototype.handler;r.prototype.handler=function(n){const i=this.store;n.button>0&&n.type==="pointerdown"&&(LK(i,s=>s.pointerId===n.pointerId)||i.push(n)),t.call(this,n)}}function MK(r){r.prototype.handler=function(e){let n=FK[e.type];n&q3&&e.button>=0&&(this.pressed=!0),n&K3&&e.which===0&&(n=ow),this.pressed&&(n&ow&&(this.pressed=!1),this.callback(this.manager,n,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}}PK(Bg.PointerEventInput),MK(Bg.MouseInput);const UK=Bg.Manager;class sy{constructor(t,e,n){this.element=t,this.callback=e,this.options={enable:!0,...n}}}const RK=Hc?[[Hc.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Hc.Rotate,{enable:!1}],[Hc.Pinch,{enable:!1}],[Hc.Swipe,{enable:!1}],[Hc.Pan,{threshold:0,enable:!1}],[Hc.Press,{enable:!1}],[Hc.Tap,{event:"doubletap",taps:2,enable:!1}],[Hc.Tap,{event:"anytap",enable:!1}],[Hc.Tap,{enable:!1}]]:null,$3={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},OK={doubletap:["tap"]},DK={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},aw={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},NK={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},W3={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},kK=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",gf=typeof window<"u"?window:global;let lw=!1;try{const r={get passive(){return lw=!0,!0}};gf.addEventListener("test",null,r),gf.removeEventListener("test",null)}catch{lw=!1}const QK=kK.indexOf("firefox")!==-1,{WHEEL_EVENTS:zK}=aw,X3="wheel",J3=4.000244140625,HK=40,VK=.25;class GK extends sy{constructor(t,e,n){super(t,e,n),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;gf.WheelEvent&&(QK&&i.deltaMode===gf.WheelEvent.DOM_DELTA_PIXEL&&(s/=gf.devicePixelRatio),i.deltaMode===gf.WheelEvent.DOM_DELTA_LINE&&(s*=HK)),s!==0&&s%J3===0&&(s=Math.floor(s/J3)),i.shiftKey&&s&&(s=s*VK),this.callback({type:X3,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(zK),this.events.forEach(i=>t.addEventListener(i,this.handleEvent,lw?{passive:!1}:!1))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===X3&&(this.options.enable=e)}}const{MOUSE_EVENTS:jK}=aw,Y3="pointermove",Z3="pointerover",tI="pointerout",eI="pointerenter",rI="pointerleave";class qK extends sy{constructor(t,e,n){super(t,e,n),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(jK),this.events.forEach(s=>t.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===Y3&&(this.enableMoveEvent=e),t===Z3&&(this.enableOverEvent=e),t===tI&&(this.enableOutEvent=e),t===eI&&(this.enableEnterEvent=e),t===rI&&(this.enableLeaveEvent=e)}handleOverEvent(t){this.enableOverEvent&&t.type==="mouseover"&&this._emit(Z3,t)}handleOutEvent(t){this.enableOutEvent&&t.type==="mouseout"&&this._emit(tI,t)}handleEnterEvent(t){this.enableEnterEvent&&t.type==="mouseenter"&&this._emit(eI,t)}handleLeaveEvent(t){this.enableLeaveEvent&&t.type==="mouseleave"&&this._emit(rI,t)}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":t.which===0&&(this.pressed=!1),this.pressed||this._emit(Y3,t);break;case"mouseup":this.pressed=!1;break}}_emit(t,e){this.callback({type:t,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const{KEY_EVENTS:KK}=aw,nI="keydown",iI="keyup";class $K extends sy{constructor(t,e,n){super(t,e,n),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:nI,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:iI,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(KK),t.tabIndex=this.options.tabIndex||0,t.style.outline="none",this.events.forEach(i=>t.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===nI&&(this.enableDownEvent=e),t===iI&&(this.enableUpEvent=e)}}const sI="contextmenu";class WK extends sy{constructor(t,e,n){super(t,e,n),this.handleEvent=i=>{this.options.enable&&this.callback({type:sI,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===sI&&(this.options.enable=e)}}const cw=1,oy=2,uw=4,XK={pointerdown:cw,pointermove:oy,pointerup:uw,mousedown:cw,mousemove:oy,mouseup:uw},JK=1,YK=2,ZK=3,t$=0,e$=1,r$=2,n$=1,i$=2,s$=4;function o$(r){const t=XK[r.srcEvent.type];if(!t)return null;const{buttons:e,button:n,which:i}=r.srcEvent;let s=!1,a=!1,o=!1;return t===uw||t===oy&&!Number.isFinite(e)?(s=i===JK,a=i===YK,o=i===ZK):t===oy?(s=!!(e&n$),a=!!(e&s$),o=!!(e&i$)):t===cw&&(s=n===t$,a=n===e$,o=n===r$),{leftButton:s,middleButton:a,rightButton:o}}function a$(r,t){const e=r.center;if(!e)return null;const n=t.getBoundingClientRect(),i=n.width/t.offsetWidth||1,s=n.height/t.offsetHeight||1,a={x:(e.x-n.left-t.clientLeft)/i,y:(e.y-n.top-t.clientTop)/s};return{center:e,offsetCenter:a}}const Aw={srcElement:"root",priority:0};class l${constructor(t){this.handleEvent=e=>{if(this.isEmpty())return;const n=this._normalizeEvent(e);let i=e.srcEvent.target;for(;i&&i!==n.rootElement;){if(this._emit(n,i),n.handled)return;i=i.parentNode}this._emit(n,"root")},this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;const{handlers:a,handlersByElement:o}=this;let d=Aw;typeof n=="string"||n&&n.addEventListener?d={...Aw,srcElement:n}:n&&(d={...Aw,...n});let p=o.get(d.srcElement);p||(p=[],o.set(d.srcElement,p));const y={type:t,handler:e,srcElement:d.srcElement,priority:d.priority};i&&(y.once=!0),s&&(y.passive=!0),a.push(y),this._active=this._active||!y.passive;let b=p.length-1;for(;b>=0&&!(p[b].priority>=y.priority);)b--;p.splice(b+1,0,y)}remove(t,e){const{handlers:n,handlersByElement:i}=this;for(let s=n.length-1;s>=0;s--){const a=n[s];if(a.type===t&&a.handler===e){n.splice(s,1);const o=i.get(a.srcElement);o.splice(o.indexOf(a),1),o.length===0&&i.delete(a.srcElement)}}this._active=n.some(s=>!s.passive)}_emit(t,e){const n=this.handlersByElement.get(e);if(n){let i=!1;const s=()=>{t.handled=!0},a=()=>{t.handled=!0,i=!0},o=[];for(let d=0;d<n.length;d++){const{type:p,handler:y,once:b}=n[d];if(y({...t,type:p,stopPropagation:s,stopImmediatePropagation:a}),b&&o.push(n[d]),i)break}for(let d=0;d<o.length;d++){const{type:p,handler:y}=o[d];this.remove(p,y)}}}_normalizeEvent(t){const e=this.eventManager.getElement();return{...t,...o$(t),...a$(t,e),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:e}}}const c$={events:null,recognizers:null,recognizerOptions:{},Manager:UK,touchAction:"none",tabIndex:0};class u${constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0;this._onBasicInput=i=>{const{srcEvent:s}=i,a=DK[s.type];a&&this.manager.emit(a,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...c$,...e},this.events=new Map,this.setElement(t);const{events:n}=this.options;n&&this.on(n)}getElement(){return this.element}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this,n=e.Manager;this.manager=new n(t,{touchAction:e.touchAction,recognizers:e.recognizers||RK}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys($3).forEach(i=>{const s=this.manager.get(i);s&&$3[i].forEach(a=>{s.recognizeWith(a)})});for(const i in e.recognizerOptions){const s=this.manager.get(i);if(s){const a=e.recognizerOptions[i];delete a.enable,s.set(a)}}this.wheelInput=new GK(t,this._onOtherEvent,{enable:!1}),this.moveInput=new qK(t,this._onOtherEvent,{enable:!1}),this.keyInput=new $K(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new WK(t,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,n){this._addEventHandler(t,e,n,!1)}once(t,e,n){this._addEventHandler(t,e,n,!0)}watch(t,e,n){this._addEventHandler(t,e,n,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:n}=this;if(!n)return;const i=n.get(t);if(i&&i.options.enable!==e){i.set({enable:e});const s=OK[t];s&&!this.options.recognizers&&s.forEach(a=>{const o=n.get(a);e?(o.requireFailure(t),i.dropRequireFailure(a)):o.dropRequireFailure(t)})}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,n,i,s){if(typeof t!="string"){n=e;for(const y in t)this._addEventHandler(y,t[y],n,i,s);return}const{manager:a,events:o}=this,d=W3[t]||t;let p=o.get(d);p||(p=new l$(this),o.set(d,p),p.recognizerName=NK[d]||d,a&&a.on(d,p.handleEvent)),p.add(t,e,n,i,s),p.isEmpty()||this._toggleRecognizer(p.recognizerName,!0)}_removeEventHandler(t,e){if(typeof t!="string"){for(const a in t)this._removeEventHandler(a,t[a]);return}const{events:n}=this,i=W3[t]||t,s=n.get(i);if(s&&(s.remove(t,e),s.isEmpty())){const{recognizerName:a}=s;let o=!1;for(const d of n.values())if(d.recognizerName===a&&!d.isEmpty()){o=!0;break}o||this._toggleRecognizer(a,!1)}}}function $h(){}const oI={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:$h,onResize:$h,onViewStateChange:$h,onInteractionStateChange:$h,onBeforeRender:$h,onAfterRender:$h,onLoad:$h,onError:r=>Tn.error(r.message,r.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:r=>{let{isDragging:t}=r;return t?"grabbing":"grab"},getTooltip:null,debug:!1,drawPickingColors:!1};class hw{constructor(t){j(this,"props",void 0),j(this,"width",0),j(this,"height",0),j(this,"userData",{}),j(this,"canvas",null),j(this,"viewManager",null),j(this,"layerManager",null),j(this,"effectManager",null),j(this,"deckRenderer",null),j(this,"deckPicker",null),j(this,"eventManager",null),j(this,"tooltip",null),j(this,"metrics",void 0),j(this,"animationLoop",void 0),j(this,"stats",void 0),j(this,"viewState",void 0),j(this,"cursorState",void 0),j(this,"_needsRedraw",void 0),j(this,"_pickRequest",void 0),j(this,"_lastPointerDownInfo",null),j(this,"_metricsCounter",void 0),j(this,"_onPointerMove",e=>{const{_pickRequest:n}=this;if(e.type==="pointerleave")n.x=-1,n.y=-1,n.radius=0;else{if(e.leftButton||e.rightButton)return;{const i=e.offsetCenter;if(!i)return;n.x=i.x,n.y=i.y,n.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:n.x,y:n.y}),n.event=e}),j(this,"_onEvent",e=>{const n=ET[e.type],i=e.offsetCenter;if(!n||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),a=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=a,d=o&&(o[n.handler]||o.props[n.handler]),p=this.props[n.handler];let y=!1;d&&(y=d.call(o,a,e)),!y&&p&&p(a,e)}),j(this,"_onPointerDown",e=>{const n=e.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:n.x,y:n.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...oI,...t},t=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},t.viewState&&t.initialViewState&&Tn.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),eT()==="IE"&&Tn.warn("IE 11 is not supported")(),this.viewState=t.initialViewState,t.gl||typeof document<"u"&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new Kp({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&vg.setOptions(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){var t,e,n,i,s,a,o,d;if((t=this.animationLoop)===null||t===void 0||t.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(e=this.layerManager)===null||e===void 0||e.finalize(),this.layerManager=null,(n=this.viewManager)===null||n===void 0||n.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(a=this.deckPicker)===null||a===void 0||a.finalize(),this.deckPicker=null,(o=this.eventManager)===null||o===void 0||o.destroy(),this.eventManager=null,(d=this.tooltip)===null||d===void 0||d.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var p;(p=this.canvas.parentElement)===null||p===void 0||p.removeChild(this.canvas),this.canvas=null}}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&Tn.removed("onLayerHover","onHover")(),"onLayerClick"in t&&Tn.removed("onLayerClick","onClick")(),t.initialViewState&&!zc(this.props.initialViewState,t.initialViewState,3)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),i=this.layerManager.needsRedraw(t),s=this.effectManager.needsRedraw(t),a=this.deckRenderer.needsRedraw(t);return e=e||n||i||s||a,e}redraw(t){if(!this.layerManager)return;let e=this.needsRedraw({clearRedrawFlags:!0});e=t||e,e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}get isInitialized(){return this.viewManager!==null}getViews(){return js(this.viewManager),this.viewManager.views}getViewports(t){return js(this.viewManager),this.viewManager.getViewports(t)}getCanvas(){return this.canvas}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_addDefaultEffect(t){this.effectManager.addDefaultEffect(t)}_pick(t,e,n){js(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(e).timeStart();const s=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(e).timeEnd(),s}_createCanvas(t){let e=t.canvas;return typeof e=="string"&&(e=document.getElementById(e),js(e)),e||(e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay",(t.parent||document.body).appendChild(e)),Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;const{width:e,height:n}=t;if(e||e===0){const s=Number.isFinite(e)?"".concat(e,"px"):e;this.canvas.style.width=s}if(n||n===0){var i;const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.position=((i=t.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var t,e;const{canvas:n}=this;if(!n)return;const i=(t=n.clientWidth)!==null&&t!==void 0?t:n.width,s=(e=n.clientHeight)!==null&&e!==void 0?e:n.height;if(i!==this.width||s!==this.height){var a,o;this.width=i,this.height=s,(a=this.viewManager)===null||a===void 0||a.setProps({width:i,height:s}),(o=this.layerManager)===null||o===void 0||o.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:s})}}_createAnimationLoop(t){const{width:e,height:n,gl:i,glOptions:s,debug:a,onError:o,onBeforeRender:d,onAfterRender:p,useDevicePixels:y}=t;return new j9({width:e,height:n,useDevicePixels:y,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:b=>HT({...s,...b,canvas:this.canvas,debug:a,onContextLost:()=>this._onContextLost()}),onInitialize:b=>this._setGLContext(b.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:d,onAfterRender:p,onError:o})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new sw({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:n,emptyInfo:i}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=n.length>0;let s=i,a=!1;for(const o of n){var e;s=o,a=((e=o.layer)===null||e===void 0?void 0:e.onHover(o,t.event))||a}if(!a&&this.props.onHover&&this.props.onHover(s,t.event),this.props.getTooltip&&this.tooltip){const o=this.props.getTooltip(s);this.tooltip.setTooltip(o,s.x,s.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,ib(t,{enable:!0,copyState:!0})),this.tooltip=new IK(this.canvas),Mu(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new p3;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new u$(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in ET)this.eventManager.on(i,this._onEvent);this.viewManager=new eK({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new tK(t,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new yK,this.deckRenderer=new bK(t),this.deckPicker=new SK(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:n}=this.layerManager.context;Mu(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:n})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Tn.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.cursorState.isDragging=t.isDragging||!1,this.props.onInteractionStateChange(t)}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=zh.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}j(hw,"defaultProps",oI),j(hw,"VERSION",Jz);class dw{constructor(t,e){j(this,"opts",void 0),j(this,"source",void 0),this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:n}=this.source,{size:i}=e;let s=n;if(n&&n.length!==i){s=new Float32Array(i);const a=e.elementOffset||0;for(let o=0;o<i;++o)s[o]=n[a+o]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function A$(r){switch(r){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function ay(r){return r.stride||r.size*r.bytesPerElement}function aI(r,t){t.offset&&Tn.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const e=ay(r),n=t.vertexOffset!==void 0?t.vertexOffset:r.vertexOffset||0,i=t.elementOffset||0,s=n*e+i*r.bytesPerElement+(r.offset||0);return{...t,offset:s,stride:e}}function h$(r,t){const e=aI(r,t);return{high:e,low:{...e,offset:e.offset+r.size*4}}}class d${constructor(t,e,n){j(this,"gl",void 0),j(this,"id",void 0),j(this,"size",void 0),j(this,"settings",void 0),j(this,"value",void 0),j(this,"doublePrecision",void 0),j(this,"_buffer",void 0),j(this,"state",void 0),this.gl=t,this.id=e.id||"",this.size=e.size||1;const i=e.logicalType||e.type,s=i===5130;let{defaultValue:a}=e;a=Number.isFinite(a)?[a]:a||new Array(this.size).fill(0);let o;s?o=5126:!i&&e.isIndexed?o=t&&hb(t,mi.ELEMENT_INDEX_UINT32)?5125:5123:o=i||5126;let d=A$(i||o||5126);this.doublePrecision=s,s&&e.fp64===!1&&(d=Float32Array),this.value=null,this.settings={...e,defaultType:d,defaultValue:a,logicalType:i,type:o,size:this.size,bytesPerElement:d.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new ni(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*ay(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),vg.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const n={},i=this.value instanceof Float64Array,s=h$(this.getAccessor(),e||{});return n[t]=new dw(this,s.high),n["".concat(t,"64Low")]=i?new dw(this,s.low):new Float32Array(this.size),n}if(e){const n=aI(this.getAccessor(),e);return{[t]:new dw(this,n)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant&&this.value){const e=Array.from(this.value);t=[e,e]}else{const{value:e,numInstances:n,size:i}=this,s=n*i;if(e&&s&&e.length>=s){const a=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let d=0;d<s;)for(let p=0;p<i;p++){const y=e[d++];y<a[p]&&(a[p]=y),y>o[p]&&(o[p]=y)}t=[a,o]}}return this.state.bounds=t,t}setData(t){const{state:e}=this;let n;ArrayBuffer.isView(t)?n={value:t}:t instanceof ni?n={buffer:t}:n=t;const i={...this.settings,...n};if(e.bufferAccessor=i,e.bounds=null,n.constant){let s=n.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!e.constant||!this._areValuesEqual(s,this.value)))return!1;e.externalBuffer=null,e.constant=!0,this.value=s}else if(n.buffer){const s=n.buffer;e.externalBuffer=s,e.constant=!1,this.value=n.value||null;const a=n.value instanceof Float64Array;i.type=n.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(a?2:1),i.stride=ay(i)}else if(n.value){this._checkExternalBuffer(n);let s=n.value;e.externalBuffer=null,e.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=ay(i);const{buffer:a,byteOffset:o}=this;this.doublePrecision&&s instanceof Float64Array&&(s=Zb(s,i));const d=s.byteLength+o+i.stride*2;a.byteLength<d&&a.reallocate(d),a.setAccessor(null),a.subData({data:s,offset:o}),i.type=n.type||a.accessor.type}return!0}updateSubBuffer(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.state.bounds=null;const e=this.value,{startOffset:n=0,endOffset:i}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?Zb(e,{size:this.size,startIndex:n,endIndex:i}):e.subarray(n,i),offset:n*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{state:n}=this,i=n.allocatedValue,s=vg.allocate(i,t+1,{size:this.size,type:this.settings.defaultType,copy:e});this.value=s;const{buffer:a,byteOffset:o}=this;return a.byteLength<s.byteLength+o&&(a.reallocate(s.byteLength+o),e&&i&&a.subData({data:i instanceof Float64Array?Zb(i,this):i,offset:o})),n.allocatedValue=s,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!ArrayBuffer.isView(e))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=e.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));!(e instanceof n)&&this.settings.normalized&&!("normalized"in t)&&Tn.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map(e=>(e+128)/255*2-1);case 5122:return new Float32Array(t).map(e=>(e+32768)/65535*2-1);case 5121:return new Float32Array(t).map(e=>e/255);case 5123:return new Float32Array(t).map(e=>e/65535);default:return t}}_normalizeValue(t,e,n){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t){let a=s;for(;--a>=0;)e[n+a]=i[a];return e}switch(s){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:i[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:i[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:i[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:i[0];break;default:let a=s;for(;--a>=0;)e[n+a]=Number.isFinite(t[a])?t[a]:i[a]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}}const lI=[],cI=[];function uI(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1/0,n=lI;const i={index:-1,data:r,target:[]};return r?typeof r[Symbol.iterator]=="function"?n=r:r.length>0&&(cI.length=r.length,n=cI):n=lI,(t>0||Number.isFinite(e))&&(n=(Array.isArray(n)?n:Array.from(n)).slice(t,e),i.index=t-1),{iterable:n,objectInfo:i}}function AI(r){return r&&r[Symbol.asyncIterator]}function f$(r,t){const{size:e,stride:n,offset:i,startIndices:s,nested:a}=t,o=r.BYTES_PER_ELEMENT,d=n?n/o:e,p=i?i/o:0,y=Math.floor((r.length-p)/d);return(b,x)=>{let{index:C,target:P}=x;if(!s){const V=C*d+p;for(let $=0;$<e;$++)P[$]=r[V+$];return P}const M=s[C],k=s[C+1]||y;let z;if(a){z=new Array(k-M);for(let V=M;V<k;V++){const $=V*d+p;P=new Array(e);for(let tt=0;tt<e;tt++)P[tt]=r[$+tt];z[V-M]=P}}else if(d===e)z=r.subarray(M*e+p,k*e+p);else{z=new r.constructor((k-M)*e);let V=0;for(let $=M;$<k;$++){const tt=$*d+p;for(let pt=0;pt<e;pt++)z[V++]=r[tt+pt]}}return z}}const p$=[],ly=[[0,1/0]];function g$(r,t){if(r===ly||(t[0]<0&&(t[0]=0),t[0]>=t[1]))return r;const e=[],n=r.length;let i=0;for(let s=0;s<n;s++){const a=r[s];a[1]<t[0]?(e.push(a),i=s+1):a[0]>t[1]?e.push(a):t=[Math.min(a[0],t[0]),Math.max(a[1],t[1])]}return e.splice(i,0,t),e}function fw(r){const{source:t,target:e,start:n=0,size:i,getData:s}=r,a=r.end||e.length,o=t.length,d=a-n;if(o>d){e.set(t.subarray(0,d),n);return}if(e.set(t,n),!s)return;let p=o;for(;p<d;){const y=s(p,t);for(let b=0;b<i;b++)e[n+p]=y[b]||0,p++}}function m$(r){let{source:t,target:e,size:n,getData:i,sourceStartIndices:s,targetStartIndices:a}=r;if(!Array.isArray(a))return fw({source:t,target:e,size:n,getData:i}),e;let o=0,d=0;const p=i&&((b,x)=>i(b+d,x)),y=Math.min(s.length,a.length);for(let b=1;b<y;b++){const x=s[b]*n,C=a[b]*n;fw({source:t.subarray(o,x),target:e,start:d,end:C,size:n,getData:p}),o=x,d=C}return d<e.length&&fw({source:[],target:e,start:d,size:n,getData:p}),e}const y$={interpolation:{duration:0,easing:r=>r},spring:{stiffness:.05,damping:.5}};function hI(r,t){if(!r)return null;Number.isFinite(r)&&(r={type:"interpolation",duration:r});const e=r.type||"interpolation";return{...y$[e],...t,...r,type:e}}function dI(r,t){const e=t.getBuffer();return e?[e,{divisor:0,size:t.size,normalized:t.settings.normalized}]:t.value}function fI(r){switch(r){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(r,'"'))}}function pI(r){r.push(r.shift())}function pw(r,t){const{doublePrecision:e,settings:n,value:i,size:s}=r,a=e&&i instanceof Float64Array?2:1;return(n.noAlloc?i.length:t*s)*a}function gI(r){let{buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:s,getData:a=V=>V}=r;const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,d=n.size*o,p=n.byteOffset,y=n.startIndices,b=s&&y,x=pw(n,e),C=n.isConstant;if(!b&&i>=x)return;const P=C?n.value:n.getBuffer().getData({srcByteOffset:p});if(n.settings.normalized&&!C){const V=a;a=($,tt)=>n.normalizeConstant(V($,tt))}const M=C?(V,$)=>a(P,$):(V,$)=>a(P.subarray(V,V+d),$),k=t.getData({length:i}),z=new Float32Array(x);m$({source:k,target:z,sourceStartIndices:s,targetStartIndices:y,size:d,getData:M}),t.byteLength<z.byteLength+p&&t.reallocate(z.byteLength+p),t.subData({data:z,offset:p})}class gw extends d${constructor(t,e){super(t,e,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:ly}),j(this,"constant",!1),this.settings.update=e.update||(e.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw(){let{clearChangedFlags:t=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat(typeof t!="function"&&t||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition,i=Array.isArray(e)?t[e.find(s=>t[s])]:t[e];return hI(i,n)}setNeedsUpdate(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.id,e=arguments.length>1?arguments[1]:void 0;if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:n=0,endRow:i=1/0}=e;this.state.updateRanges=g$(this.state.updateRanges,[n,i])}else this.state.updateRanges=ly}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=p$}setNeedsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.id;this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){const{state:e,settings:n}=this;return n.noAlloc?!1:n.update?(super.allocate(t,e.updateRanges!==ly),!0):!1}updateBuffer(t){let{numInstances:e,data:n,props:i,context:s}=t;if(!this.needsUpdate())return!1;const{state:{updateRanges:a},settings:{update:o,noAlloc:d}}=this;let p=!0;if(o){for(const[y,b]of a)o.call(s,this,{data:n,startRow:y,endRow:b,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[y,b]of a){const x=Number.isFinite(y)?this.getVertexOffset(y):0,C=Number.isFinite(b)?this.getVertexOffset(b):d||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:x,endOffset:C})}this._checkAttributeArray()}else p=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),p}setConstantValue(t){return t===void 0||typeof t=="function"?!1:(this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const{state:n,settings:i}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;if(n.binaryValue=t,this.setNeedsRedraw(),i.transform||e!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});const a=t;js(ArrayBuffer.isView(a.value),"invalid ".concat(i.accessor));const o=!!a.size&&a.size!==this.size;return n.binaryAccessor=f$(a.value,{size:a.size||this.size,stride:a.stride,offset:a.offset,startIndices:e,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?t<e.length?e[t]:this.numInstances:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const n in t)Object.assign(e,super.getShaderAttributes(n,t[n]));return e}_autoUpdater(t,e){let{data:n,startRow:i,endRow:s,props:a,numInstances:o}=e;if(t.constant)return;const{settings:d,state:p,value:y,size:b,startIndices:x}=t,{accessor:C,transform:P}=d,M=p.binaryAccessor||(typeof C=="function"?C:a[C]);js(typeof M=="function",'accessor "'.concat(C,'" is not a function'));let k=t.getVertexOffset(i);const{iterable:z,objectInfo:V}=uI(n,i,s);for(const $ of z){V.index++;let tt=M($,V);if(P&&(tt=P.call(this,tt)),x){const pt=(V.index<x.length-1?x[V.index+1]:o)-x[V.index];if(tt&&Array.isArray(tt[0])){let gt=k;for(const mt of tt)t._normalizeValue(mt,y,gt),gt+=b}else tt&&tt.length>b?y.set(tt,k):(t._normalizeValue(tt,V.target,0),qq({target:y,source:V.target,start:k,count:pt}));k+=pt*b}else t._normalizeValue(tt,y,k),k+=b}}_validateAttributeUpdaters(){const{settings:t}=this;if(!(t.noAlloc||typeof t.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class _${constructor(t){let{gl:e,attribute:n,timeline:i}=t;j(this,"gl",void 0),j(this,"type","interpolation"),j(this,"attributeInTransition",void 0),j(this,"settings",void 0),j(this,"attribute",void 0),j(this,"transition",void 0),j(this,"currentStartIndices",void 0),j(this,"currentLength",void 0),j(this,"transform",void 0),j(this,"buffers",void 0),this.gl=e,this.transition=new xg(i),this.attribute=n,this.attributeInTransition=new gw(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=b$(e,n);const s={byteLength:0,usage:35050};this.buffers=[new ni(e,s),new ni(e,s)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0){this.transition.cancel();return}this.settings=t;const{gl:n,buffers:i,attribute:s}=this;pI(i);const a={numInstances:e,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const o of i)gI({buffer:o,...a});this.currentStartIndices=s.startIndices,this.currentLength=pw(s,e),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:dI(n,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const t=this.transition.update();if(t){const{duration:e,easing:n}=this.settings,{time:i}=this.transition;let s=i/e;n&&(s=n(s)),this.transform.run({uniforms:{time:s}})}return t}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0}}const v$=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function b$(r,t){const e=fI(t.size);return new Vb(r,{vs:v$,defines:{ATTRIBUTE_TYPE:e},varyings:["vCurrent"]})}class w${constructor(t){let{gl:e,attribute:n,timeline:i}=t;j(this,"gl",void 0),j(this,"type","spring"),j(this,"attributeInTransition",void 0),j(this,"settings",void 0),j(this,"attribute",void 0),j(this,"transition",void 0),j(this,"currentStartIndices",void 0),j(this,"currentLength",void 0),j(this,"texture",void 0),j(this,"framebuffer",void 0),j(this,"transform",void 0),j(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new xg(i),this.attribute=n,this.attributeInTransition=new gw(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=B$(e),this.framebuffer=C$(e,this.texture),this.transform=x$(e,n,this.framebuffer);const s={byteLength:0,usage:35050};this.buffers=[new ni(e,s),new ni(e,s),new ni(e,s)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:n,buffers:i,attribute:s}=this,a={numInstances:e,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const o of i)gI({buffer:o,...a});this.settings=t,this.currentStartIndices=s.startIndices,this.currentLength=pw(s,e),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...t,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:dI(n,s)}})}update(){const{buffers:t,transform:e,framebuffer:n,transition:i}=this;if(!i.update())return!1;const a=this.settings;return e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:a.stiffness,damping:a.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),pI(t),this.attributeInTransition.setData({buffer:t[1],value:this.attribute.value}),L0(n)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function x$(r,t,e){const n=fI(t.size);return new Vb(r,{framebuffer:e,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:n},varyings:["vNext"]})}function B$(r){return new Ca(r,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function C$(r,t){return new gs(r,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:t}})}const E$={interpolation:_$,spring:w$};class S${constructor(t,e){let{id:n,timeline:i}=e;j(this,"id",void 0),j(this,"isSupported",void 0),j(this,"gl",void 0),j(this,"timeline",void 0),j(this,"transitions",void 0),j(this,"needsRedraw",void 0),j(this,"numInstances",void 0),this.id=n,this.gl=t,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=Vb.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update(t){let{attributes:e,transitions:n,numInstances:i}=t;this.numInstances=i||1;for(const s in e){const a=e[s],o=a.getTransitionSetting(n);o&&this._updateAttribute(s,a,o)}for(const s in this.transitions){const a=e[s];(!a||!a.getTransitionSetting(n))&&this._removeTransition(s)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const e in this.transitions)this.transitions[e].update()&&(this.needsRedraw=!0);const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,n){const i=this.transitions[t];let s=!i||i.type!==n.type;if(s){if(!this.isSupported){Tn.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();return}i&&this._removeTransition(t);const a=E$[n.type];a?this.transitions[t]=new a({attribute:e,timeline:this.timeline,gl:this.gl}):(Tn.error("unsupported transition type '".concat(n.type,"'"))(),s=!1)}(s||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}const mI="attributeManager.invalidate",T$="attributeManager.updateStart",I$="attributeManager.updateEnd",F$="attribute.updateStart",L$="attribute.allocate",P$="attribute.updateEnd";class M${constructor(t){let{id:e="attribute-manager",stats:n,timeline:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};j(this,"id",void 0),j(this,"gl",void 0),j(this,"attributes",void 0),j(this,"updateTriggers",void 0),j(this,"needsRedraw",void 0),j(this,"userData",void 0),j(this,"stats",void 0),j(this,"attributeTransitionManager",void 0),j(this,"mergeBoundsMemoized",yg(Dq)),this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new S$(t,{id:"".concat(e,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{instanced:1})}remove(t){for(const e of t)this.attributes[e]!==void 0&&(this.attributes[e].delete(),delete this.attributes[e])}invalidate(t,e){const n=this._invalidateTrigger(t,e);oo(mI,this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);oo(mI,this,"all")}update(t){let{data:e,numInstances:n,startIndices:i=null,transitions:s,props:a={},buffers:o={},context:d={}}=t,p=!1;oo(T$,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const y in this.attributes){const b=this.attributes[y],x=b.settings.accessor;b.startIndices=i,b.numInstances=n,a[y]&&Tn.removed("props.".concat(y),"data.attributes.".concat(y))(),b.setExternalBuffer(o[y])||b.setBinaryValue(typeof x=="string"?o[x]:void 0,e.startIndices)||typeof x=="string"&&!o[x]&&b.setConstantValue(a[x])||b.needsUpdate()&&(p=!0,this._updateAttribute({attribute:b,numInstances:n,data:e,props:a,context:d})),this.needsRedraw=this.needsRedraw||b.needsRedraw()}p&&oo(I$,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:s})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getBounds(t){const e=t.map(n=>{var i;return(i=this.attributes[n])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(e)}getChangedAttributes(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearChangedFlags:!1};const{attributes:e,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const s in e){const a=e[s];a.needsRedraw(t)&&!n.hasAttribute(s)&&(i[s]=a)}return i}getShaderAttributes(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t||(t=this.getAttributes());const n={};for(const i in t)e[i]||Object.assign(n,t[i].getShaderAttributes());return n}_add(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};for(const n in t){const i=t[n];this.attributes[n]=this._createAttribute(n,i,e)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const i={...e,id:t,size:e.isIndexed&&1||e.size||1,divisor:n.instanced?1:e.divisor||0};return new gw(this.gl,i)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes)this.attributes[e].getUpdateTriggers().forEach(i=>{t[i]||(t[i]=[]),t[i].push(e)});this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:i}=this,s=i[t];return s&&s.forEach(a=>{const o=n[a];o&&o.setNeedsUpdate(o.id,e)}),s}_updateAttribute(t){const{attribute:e,numInstances:n}=t;if(oo(F$,e),e.constant){e.setConstantValue(e.value);return}e.allocate(n)&&oo(L$,e,n),e.updateBuffer(t)&&(this.needsRedraw=!0,oo(P$,e,n))}}class U$ extends xg{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:i,easing:s}}=this,a=s(t/i);this._value=z0(e,n,a)}}const yI=1e-5;function _I(r,t,e,n,i){const s=t-r,o=(e-t)*i,d=-s*n;return o+d+s+t}function R$(r,t,e,n,i){if(Array.isArray(e)){const s=[];for(let a=0;a<e.length;a++)s[a]=_I(r[a],t[a],e[a],n,i);return s}return _I(r,t,e,n,i)}function vI(r,t){if(Array.isArray(r)){let e=0;for(let n=0;n<r.length;n++){const i=r[n]-t[n];e+=i*i}return Math.sqrt(e)}return Math.abs(r-t)}class O$ extends xg{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:i}=this.settings,{_prevValue:s=t,_currValue:a=t}=this;let o=R$(s,a,e,n,i);const d=vI(o,e),p=vI(o,a);d<yI&&p<yI&&(o=e,this.end()),this._prevValue=a,this._currValue=o}}const D$={interpolation:U$,spring:O$};class N${constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,i){const{transitions:s}=this;if(s.has(t)){const d=s.get(t),{value:p=d.settings.fromValue}=d;e=p,this.remove(t)}if(i=hI(i),!i)return;const a=D$[i.type];if(!a){Tn.error("unsupported transition type '".concat(i.type,"'"))();return}const o=new a(this.timeline);o.start({...i,fromValue:e,toValue:n}),s.set(t,o)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}function k$(r){const t=r[OA];for(const e in t){const n=t[e],{validate:i}=n;if(i&&!i(r[e],n))throw new Error("Invalid prop ".concat(e,": ").concat(r[e]))}}function Q$(r,t){const e=bI({newProps:r,oldProps:t,propTypes:r[OA],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),n=H$(r,t);let i=!1;return n||(i=V$(r,t)),{dataChanged:n,propsChanged:e,updateTriggersChanged:i,extensionsChanged:G$(r,t),transitionsChanged:z$(r,t)}}function z$(r,t){if(!r.transitions)return!1;const e={},n=r[OA];let i=!1;for(const s in r.transitions){const a=n[s],o=a&&a.type;(o==="number"||o==="color"||o==="array")&&mw(r[s],t[s],a)&&(e[s]=!0,i=!0)}return i?e:!1}function bI(r){let{newProps:t,oldProps:e,ignoreProps:n={},propTypes:i={},triggerName:s="props"}=r;if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(s," changed shallowly");for(const a of Object.keys(t))if(!(a in n)){if(!(a in e))return"".concat(s,".").concat(a," added");const o=mw(t[a],e[a],i[a]);if(o)return"".concat(s,".").concat(a," ").concat(o)}for(const a of Object.keys(e))if(!(a in n)){if(!(a in t))return"".concat(s,".").concat(a," dropped");if(!Object.hasOwnProperty.call(t,a)){const o=mw(t[a],e[a],i[a]);if(o)return"".concat(s,".").concat(a," ").concat(o)}}return!1}function mw(r,t,e){let n=e&&e.equal;return n&&!n(r,t,e)||!n&&(n=r&&t&&r.equals,n&&!n.call(r,t))?"changed deeply":!n&&t!==r?"changed shallowly":null}function H$(r,t){if(t===null)return"oldProps is null, initial diff";let e=!1;const{dataComparator:n,_dataDiff:i}=r;return n?n(r.data,t.data)||(e="Data comparator detected a change"):r.data!==t.data&&(e="A new data container was supplied"),e&&i&&(e=i(r.data,t.data)||e),e}function V$(r,t){if(t===null)return{all:!0};if("all"in r.updateTriggers&&wI(r,t,"all"))return{all:!0};const e={};let n=!1;for(const i in r.updateTriggers)i!=="all"&&wI(r,t,i)&&(e[i]=!0,n=!0);return n?e:!1}function G$(r,t){if(t===null)return!0;const e=t.extensions,{extensions:n}=r;if(n===e)return!1;if(!e||!n||n.length!==e.length)return!0;for(let i=0;i<n.length;i++)if(!n[i].equals(e[i]))return!0;return!1}function wI(r,t,e){let n=r.updateTriggers[e];n=n??{};let i=t.updateTriggers[e];return i=i??{},bI({oldProps:i,newProps:n,triggerName:e})}const j$="count(): argument not an object",q$="count(): argument not a container";function K$(r){if(!W$(r))throw new Error(j$);if(typeof r.count=="function")return r.count();if(Number.isFinite(r.size))return r.size;if(Number.isFinite(r.length))return r.length;if($$(r))return Object.keys(r).length;throw new Error(q$)}function $$(r){return r!==null&&typeof r=="object"&&r.constructor===Object}function W$(r){return r!==null&&typeof r=="object"}function X$(r,t){if(!t)return r;const e={...r,...t};if("defines"in t&&(e.defines={...r.defines,...t.defines}),"modules"in t&&(e.modules=(r.modules||[]).concat(t.modules),t.modules.some(n=>n.name==="project64"))){const n=e.modules.findIndex(i=>i.name==="project32");n>=0&&e.modules.splice(n,1)}if("inject"in t)if(!r.inject)e.inject=t.inject;else{const n={...r.inject};for(const i in t.inject)n[i]=(n[i]||"")+t.inject[i];e.inject=n}return e}const J$={10241:9987,10240:9729,10242:33071,10243:33071},yw={};function Y$(r,t,e,n){if(e instanceof Ca)return e;e.constructor&&e.constructor.name!=="Object"&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const s=new Ca(t,{...e,parameters:{...J$,...i,...n}});return yw[s.id]=r,s}function Z$(r,t){!t||!(t instanceof Ca)||yw[t.id]===r&&(t.delete(),delete yw[t.id])}const tW={boolean:{validate(r,t){return!0},equal(r,t,e){return!!r==!!t}},number:{validate(r,t){return Number.isFinite(r)&&(!("max"in t)||r<=t.max)&&(!("min"in t)||r>=t.min)}},color:{validate(r,t){return t.optional&&!r||_w(r)&&(r.length===3||r.length===4)},equal(r,t,e){return zc(r,t,1)}},accessor:{validate(r,t){const e=cy(r);return e==="function"||e===cy(t.value)},equal(r,t,e){return typeof t=="function"?!0:zc(r,t,1)}},array:{validate(r,t){return t.optional&&!r||_w(r)},equal(r,t,e){const{compare:n}=e,i=Number.isInteger(n)?n:n?1:0;return n?zc(r,t,i):r===t}},object:{equal(r,t,e){if(e.ignore)return!0;const{compare:n}=e,i=Number.isInteger(n)?n:n?1:0;return n?zc(r,t,i):r===t}},function:{validate(r,t){return t.optional&&!r||typeof r=="function"},equal(r,t,e){return!e.compare&&e.ignore!==!1||r===t}},data:{transform:(r,t,e)=>{const{dataTransform:n}=e.props;return n&&r?n(r):r}},image:{transform:(r,t,e)=>{const n=e.context;return!n||!n.gl?null:Y$(e.id,n.gl,r,{...t.parameters,...e.props.textureParameters})},release:(r,t,e)=>{Z$(e.id,r)}}};function eW(r){const t={},e={},n={};for(const[i,s]of Object.entries(r)){const a=s==null?void 0:s.deprecatedFor;if(a)n[i]=Array.isArray(a)?a:[a];else{const o=rW(i,s);t[i]=o,e[i]=o.value}}return{propTypes:t,defaultProps:e,deprecatedProps:n}}function rW(r,t){switch(cy(t)){case"object":return Cg(r,t);case"array":return Cg(r,{type:"array",value:t,compare:!1});case"boolean":return Cg(r,{type:"boolean",value:t});case"number":return Cg(r,{type:"number",value:t});case"function":return Cg(r,{type:"function",value:t,compare:!0});default:return{name:r,type:"unknown",value:t}}}function Cg(r,t){return"type"in t?{name:r,...tW[t.type],...t}:"value"in t?{name:r,type:cy(t.value),...t}:{name:r,type:"object",value:t}}function _w(r){return Array.isArray(r)||ArrayBuffer.isView(r)}function cy(r){return _w(r)?"array":r===null?"null":typeof r}function nW(r,t){let e;for(let s=t.length-1;s>=0;s--){const a=t[s];"extensions"in a&&(e=a.extensions)}const n=vw(r.constructor,e),i=Object.create(n);i[ry]=r,i[qh]={},i[DA]={};for(let s=0;s<t.length;++s){const a=t[s];for(const o in a)i[o]=a[o]}return Object.freeze(i),i}const iW="_mergedDefaultProps";function vw(r,t){let e=iW;if(t)for(const i of t){const s=i.constructor;s&&(e+=":".concat(s.extensionName||s.name))}const n=xI(r,e);return n||(r[e]=sW(r,t||[]))}function sW(r,t){if(!r.prototype)return null;const n=Object.getPrototypeOf(r),i=vw(n),s=xI(r,"defaultProps")||{},a=eW(s),o=Object.assign(Object.create(null),i,a.defaultProps),d=Object.assign(Object.create(null),i==null?void 0:i[OA],a.propTypes),p=Object.assign(Object.create(null),i==null?void 0:i[ew],a.deprecatedProps);for(const y of t){const b=vw(y.constructor);b&&(Object.assign(o,b),Object.assign(d,b[OA]),Object.assign(p,b[ew]))}return oW(o,r),lW(o,d),aW(o,p),o[OA]=d,o[ew]=p,t.length===0&&!bw(r,"_propTypes")&&(r._propTypes=d),o}function oW(r,t){const e=uW(t);Object.defineProperties(r,{id:{writable:!0,value:e}})}function aW(r,t){for(const e in t)Object.defineProperty(r,e,{enumerable:!1,set(n){const i="".concat(this.id,": ").concat(e);for(const s of t[e])bw(this,s)||(this[s]=n);Tn.deprecated(i,t[e].join("/"))()}})}function lW(r,t){const e={},n={};for(const i in t){const s=t[i],{name:a,value:o}=s;s.async&&(e[a]=o,n[a]=cW(a))}r[ff]=e,r[qh]={},Object.defineProperties(r,n)}function cW(r){return{enumerable:!0,set(t){typeof t=="string"||t instanceof Promise||AI(t)?this[qh][r]=t:this[DA][r]=t},get(){if(this[DA]){if(r in this[DA])return this[DA][r]||this[ff][r];if(r in this[qh]){const t=this[ry]&&this[ry].internalState;if(t&&t.hasAsyncProp(r))return t.getAsyncProp(r)||this[ff][r]}}return this[ff][r]}}}function bw(r,t){return Object.prototype.hasOwnProperty.call(r,t)}function xI(r,t){return bw(r,t)&&r[t]}function uW(r){const t=r.componentName;return t||Tn.warn("".concat(r.name,".componentName not specified"))(),t||r.name}let AW=0;class ww{constructor(){j(this,"id",void 0),j(this,"props",void 0),j(this,"count",void 0);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.props=nW(this,e),this.id=this.props.id,this.count=AW++}clone(t){const{props:e}=this,n={};for(const i in e[ff])i in e[DA]?n[i]=e[DA][i]:i in e[qh]&&(n[i]=e[qh][i]);return new this.constructor({...e,...n,...t})}}j(ww,"componentName","Component"),j(ww,"defaultProps",{});const hW=Object.freeze({});class dW{constructor(t){j(this,"component",void 0),j(this,"onAsyncPropUpdated",void 0),j(this,"asyncProps",void 0),j(this,"oldProps",void 0),j(this,"oldAsyncProps",void 0),this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e&&e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||hW}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return!!(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const e in this.asyncProps)if(this.isAsyncPropLoading(e))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){this.component=t[ry]||this.component;const e=t[DA]||{},n=t[qh]||t,i=t[ff]||{};for(const s in e){const a=e[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,a),e[s]=this.getAsyncProp(s)}for(const s in n){const a=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,a)}}_fetch(t,e){return null}_onResolve(t,e){}_onError(t,e){}_updateAsyncProp(t,e){if(this._didAsyncInputValueChange(t,e)){if(typeof e=="string"&&(e=this._fetch(t,e)),e instanceof Promise){this._watchPromise(t,e);return}if(AI(e)){this._resolveAsyncIterable(t,e);return}this._setPropValue(t,e)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e===n.resolvedValue||e===n.lastValue?!1:(n.lastValue=e,!0)}_setPropValue(t,e){this._freezeAsyncOldProps();const n=this.asyncProps[t];n&&(e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(t,e,n){const i=this.asyncProps[t];i&&n>=i.resolvedLoadCount&&e!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=e,i.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;e.then(s=>{this.component&&(s=this._postProcessValue(n,s),this._setAsyncPropValue(t,s,i),this._onResolve(t,s))}).catch(s=>{this._onError(t,s)})}}async _resolveAsyncIterable(t,e){if(t!=="data"){this._setPropValue(t,e);return}const n=this.asyncProps[t];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let s=[],a=0;for await(const o of e){if(!this.component)return;const{dataTransform:d}=this.component.props;d?s=d(o,s):s=s.concat(o),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:a,endRow:s.length}]}),a=s.length,this._setAsyncPropValue(t,s,i)}this._onResolve(t,s)}_postProcessValue(t,e){const n=t.type;return n&&this.component&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const i=this.component&&this.component.props[OA];this.asyncProps[t]={type:i&&i[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}class fW extends dW{constructor(t){let{attributeManager:e,layer:n}=t;super(n),j(this,"attributeManager",void 0),j(this,"needsRedraw",void 0),j(this,"needsUpdate",void 0),j(this,"subLayers",void 0),j(this,"usesPickingColorCache",void 0),j(this,"hasPickingBuffer",void 0),j(this,"changeFlags",void 0),j(this,"viewport",void 0),j(this,"uniformTransitions",void 0),j(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(t,e){const n=this.layer,i=n==null?void 0:n.props.fetch;return i?i(e,{propName:t,layer:n}):super._fetch(t,e)}_onResolve(t,e){const n=this.layer;if(n){const i=n.props.onDataLoad;t==="data"&&i&&i(e,{propName:t,layer:n})}}_onError(t,e){const n=this.layer;n&&n.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}}const pW="layer.changeFlag",gW="layer.initialize",mW="layer.update",yW="layer.finalize",_W="layer.matched",BI=2**24-1,vW=Object.freeze([]),bW=yg(r=>{let{oldViewport:t,viewport:e}=r;return t.equals(e)});let Vc=new Uint8ClampedArray(0);const wW={data:{type:"data",value:vW,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:r=>r&&r.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(r,t)=>{let{propName:e,layer:n,loaders:i,loadOptions:s,signal:a}=t;const{resourceManager:o}=n.context;if(s=s||n.getLoadOptions(),i=i||n.props.loaders,a){var d;s={...s,fetch:{...(d=s)===null||d===void 0?void 0:d.fetch,signal:a}}}let p=o.contains(r);return!p&&!s&&(o.add({resourceId:r,data:FA(r,i),persistent:!1}),p=!0),p?o.subscribe({resourceId:r,onChange:y=>{var b;return(b=n.internalState)===null||b===void 0?void 0:b.reloadAsyncProp(e,y)},consumerId:n.id,requestId:e}):FA(r,i,s)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:En.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:r=>{let{layerIndex:t}=r;return[0,-t*100]}},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class mf extends ww{constructor(){super(...arguments),j(this,"internalState",null),j(this,"lifecycle",df.NO_STATE),j(this,"context",void 0),j(this,"state",void 0),j(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}project(t){js(this.internalState);const e=this.internalState.viewport||this.context.viewport,n=O3(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,a]=T3(n,e.pixelProjectionMatrix);return t.length===2?[i,s]:[i,s,a]}unproject(t){return js(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,e){js(this.internalState);const n=this.internalState.viewport||this.context.viewport;return Vq(t,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...e})}get isComposite(){return!1}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===En.DEFAULT||t===En.LNGLAT||t===En.CARTESIAN}onHover(t,e){return this.props.onHover&&this.props.onHover(t,e)||!1}onClick(t,e){return this.props.onClick&&this.props.onClick(t,e)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){js(t instanceof Uint8Array);const[e,n,i]=t;return e+n*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:K$(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var t;return(t=this.getAttributeManager())===null||t===void 0?void 0:t.getBounds(["positions","instancePositions"])}getShaders(t){for(const e of this.props.extensions)t=X$(t,e.getShaders.call(this,e));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){const e=this.getAttributeManager(),{dataChanged:n}=t.changeFlags;if(n&&e)if(Array.isArray(n))for(const i of n)e.invalidateAll(i);else e.invalidateAll();if(e){const{props:i}=t,s=this.internalState.hasPickingBuffer,a=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(o=>o.getNeedsPickingBuffer.call(this,o));if(s!==a){this.internalState.hasPickingBuffer=a;const{pickingColors:o,instancePickingColors:d}=e.attributes,p=o||d;p&&(a&&p.constant&&(p.constant=!1,e.invalidate(p.id)),!p.value&&!a&&(p.constant=!0,p.value=[0,0,0]))}}}finalizeState(t){for(const n of this.getModels())n.delete();const e=this.getAttributeManager();e&&e.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo(t){let{info:e,mode:n,sourceLayer:i}=t;const{index:s}=e;return s>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[s]),e}raiseError(t,e){var n,i;if(e&&(t=new Error("".concat(e,": ").concat(t.message),{cause:t})),!((n=(i=this.props).onError)!==null&&n!==void 0&&n.call(i,t))){var s,a;(s=this.context)===null||s===void 0||(a=s.onError)===null||a===void 0||a.call(s,t,this)}}getNeedsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var t;return((t=this.internalState)===null||t===void 0?void 0:t.uniformTransitions.active)||!1}activateViewport(t){if(!this.internalState)return;const e=this.internalState.viewport;this.internalState.viewport=t,(!e||!bW({oldViewport:e,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"all";const e=this.getAttributeManager();e&&(t==="all"?e.invalidateAll():e.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(){const t=this.getAttributeManager();if(!t)return;const e=this.props,n=this.getNumInstances(),i=this.getStartIndices();t.update({data:e.data,numInstances:n,startIndices:i,props:e,transitions:e.transitions,buffers:e.data.attributes,context:this});const s=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const i in e)Object.defineProperty(n,i,{value:e[i]});return n}return this.props}calculateInstancePickingColors(t,e){let{numInstances:n}=e;if(t.constant)return;const i=Math.floor(Vc.length/3);if(this.internalState.usesPickingColorCache=!0,i<n){n>BI&&Tn.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Vc=vg.allocate(Vc,n,{size:3,copy:!0,maxCount:Math.max(n,BI)});const s=Math.floor(Vc.length/3),a=[];for(let o=i;o<s;o++)this.encodePickingColor(o,a),Vc[o*3+0]=a[0],Vc[o*3+1]=a[1],Vc[o*3+2]=a[2]}t.value=Vc.subarray(0,n*3)}_setModelAttributes(t,e){const n=this.getAttributeManager(),i=t.userData.excludeAttributes||{},s=n.getShaderAttributes(e,i);t.setAttributes(s)}disablePickingIndex(t){const e=this.props.data;if(!("attributes"in e)){this._disablePickingIndex(t);return}const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,s=n||i,a=s&&e.attributes&&e.attributes[s.id];if(a&&a.value){const o=a.value,d=this.encodePickingColor(t);for(let p=0;p<e.length;p++){const y=s.getVertexOffset(p);o[y]===d[0]&&o[y+1]===d[1]&&o[y+2]===d[2]&&this._disablePickingIndex(p)}}else this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;if(!i)return;const s=i.getVertexOffset(t),a=i.getVertexOffset(t+1);i.buffer.subData({data:new Uint8Array(a-s),offset:s})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==Vc.buffer&&(n.value=Vc.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){js(!this.internalState),js(Number.isFinite(this.props.coordinateSystem)),oo(gW,this);const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new fW({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Tn.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.uniformTransitions=new N$(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const e of this.props.extensions)e.initializeState.call(this,this.context,e);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){oo(_W,this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.state=e,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const t=this.needsUpdate();if(oo(mW,this,t),!t)return;const e=this.props,n=this.context,i=this.internalState,s=n.viewport,a=this._updateUniformTransition();i.propsInTransition=a,n.viewport=i.viewport||s,this.props=a;try{const o=this._getUpdateParams(),d=this.getModels();if(n.gl)this.updateState(o);else try{this.updateState(o)}catch{}for(const y of this.props.extensions)y.updateState.call(this,o,y);const p=this.getModels()[0]!==d[0];this._postUpdate(o,p)}finally{n.viewport=s,this.props=e,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){oo(yW,this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,this.context,t)}_drawLayer(t){let{moduleParameters:e=null,uniforms:n={},parameters:i={}}=t;this._updateAttributeTransition();const s=this.props,a=this.context;this.props=this.internalState.propsInTransition||s;const o=this.props.opacity;n.opacity=Math.pow(o,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:d}=this.props,p=d&&d(n)||[0,0];Mu(a.gl,{polygonOffset:p}),$l(a.gl,i,()=>{const y={moduleParameters:e,uniforms:n,parameters:i,context:a};for(const b of this.props.extensions)b.draw.call(this,y,b);this.draw(y)})}finally{this.props=s}}getChangeFlags(){var t;return(t=this.internalState)===null||t===void 0?void 0:t.changeFlags}setChangeFlags(t){if(!this.internalState)return;const{changeFlags:e}=this.internalState;for(const i in t)if(t[i]){let s=!1;switch(i){case"dataChanged":const a=t[i],o=e[i];a&&Array.isArray(o)&&(e.dataChanged=Array.isArray(a)?o.concat(a):a,s=!0);default:e[i]||(e[i]=t[i],s=!0)}s&&oo(pW,this,i,t)}const n=!!(e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged);e.propsOrDataChanged=n,e.somethingChanged=n||e.viewportChanged||e.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,e){const n=Q$(t,e);if(n.updateTriggersChanged)for(const s in n.updateTriggersChanged)n.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(n.transitionsChanged)for(const s in n.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,e[s],t[s],(i=t.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(n)}validateProps(){k$(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&typeof n=="function"&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_getAttributeManager(){const t=this.context;return new M$(t.gl,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,e){const{props:n,oldProps:i}=t;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s==null||s.setInstanceCount(this.getNumInstances());const{autoHighlight:a,highlightedObjectIndex:o,highlightColor:d}=n;if(e||i.autoHighlight!==a||i.highlightedObjectIndex!==o||i.highlightColor!==d){const p={};a||(p.pickingSelectedColor=null),Array.isArray(d)&&(p.pickingHighlightColor=d),(e||o!==i.highlightedObjectIndex)&&(p.pickingSelectedColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setModuleParameters(p)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),i=n?n.getNeedsRedraw(t):!1;if(e=e||i,e)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags,e}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}j(mf,"defaultProps",wW),j(mf,"layerName","Layer");const xW="compositeLayer.renderLayers";class CI extends mf{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(t){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo(t){let{info:e}=t;const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){return e&&e.length}getSubLayerClass(t,e){const{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||e}getSubLayerRow(t,e,n){return t.__source={parent:this,object:e,index:n},t}getSubLayerAccessor(t){if(typeof t=="function"){const e={index:-1,data:this.props.data,target:[]};return(n,i)=>n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,i)}return t}getSubLayerProps(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var e;const{opacity:n,pickable:i,visible:s,parameters:a,getPolygonOffset:o,highlightedObjectIndex:d,autoHighlight:p,highlightColor:y,coordinateSystem:b,coordinateOrigin:x,wrapLongitude:C,positionFormat:P,modelMatrix:M,extensions:k,fetch:z,operation:V,_subLayerProps:$}=this.props,tt={id:"",updateTriggers:{},opacity:n,pickable:i,visible:s,parameters:a,getPolygonOffset:o,highlightedObjectIndex:d,autoHighlight:p,highlightColor:y,coordinateSystem:b,coordinateOrigin:x,wrapLongitude:C,positionFormat:P,modelMatrix:M,extensions:k,fetch:z,operation:V},pt=$&&t.id&&$[t.id],gt=pt&&pt.updateTriggers,mt=t.id||"sublayer";if(pt){const dt=this.props[OA],Ft=t.type?t.type._propTypes:{};for(const Tt in pt){const ot=Ft[Tt]||dt[Tt];ot&&ot.type==="accessor"&&(pt[Tt]=this.getSubLayerAccessor(pt[Tt]))}}Object.assign(tt,t,pt),tt.id="".concat(this.props.id,"-").concat(mt),tt.updateTriggers={all:(e=this.props.updateTriggers)===null||e===void 0?void 0:e.all,...t.updateTriggers,...gt};for(const dt of k){const Ft=dt.getSubLayerProps.call(this,dt);Ft&&Object.assign(tt,Ft,{updateTriggers:Object.assign(tt.updateTriggers,Ft.updateTriggers)})}return tt}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_postUpdate(t,e){let n=this.internalState.subLayers;const i=!n||this.needsUpdate();if(i){const s=this.renderLayers();n=ny(s,Boolean),this.internalState.subLayers=n}oo(xW,this,i,n);for(const s of n)s.parent=this}}j(CI,"layerName","CompositeLayer");const xw=512,BW=Math.PI/180;function CW(r){let{map:t,gl:e,deck:n}=r;if(t.__deck)return t.__deck;const i=n==null?void 0:n.props._customRender,s=n==null?void 0:n.props.onLoad,a=SW({...n==null?void 0:n.props,_customRender:()=>{t.triggerRepaint(),i==null||i("")}});let o;return(!n||n.props.gl===e)&&(Object.assign(a,{gl:e,width:null,height:null,touchAction:"unset",viewState:Bw(t)}),n!=null&&n.isInitialized?EI(n,t):a.onLoad=()=>{s==null||s(),EI(o,t)}),n?(o=n,n.setProps(a),n.userData.isExternal=!0):(o=new hw(a),t.on("remove",()=>{EW(t)})),o.userData.mapboxLayers=new Set,t.__deck=o,t.on("render",()=>{o.isInitialized&&MW(o,t)}),o}function EI(r,t){const e=()=>{r.isInitialized?UW(r,t):t.off("move",e)};t.on("move",e)}function EW(r){var t;(t=r.__deck)===null||t===void 0||t.finalize(),r.__deck=null}function SW(r){return{...r,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...r.parameters},views:r.views||[new sw({id:"mapbox"})]}}function TW(r,t){r.userData.mapboxLayers.add(t),Cw(r)}function IW(r,t){r.userData.mapboxLayers.delete(t),Cw(r)}function FW(r,t){Cw(r)}function LW(r,t,e){let{currentViewport:n}=r.userData,i=!1;n||(n=SI(r,t,!0),r.userData.currentViewport=n,i=!0),r.isInitialized&&r._drawLayers("mapbox-repaint",{viewports:[n],layerFilter:s=>{let{layer:a}=s;return e.id===a.id||a.props.operation.includes("terrain")},clearStack:i,clearCanvas:!1})}function Bw(r){var t;const{lng:e,lat:n}=r.getCenter(),i={longitude:(e+540)%360-180,latitude:n,zoom:r.getZoom(),bearing:r.getBearing(),pitch:r.getPitch(),padding:r.getPadding(),repeat:r.getRenderWorldCopies()};return(t=r.getTerrain)!==null&&t!==void 0&&t.call(r)&&PW(r,i),i}function PW(r,t){if(r.getFreeCameraOptions){const{position:e}=r.getFreeCameraOptions();if(!e||e.z===void 0)return;const n=r.transform.height,{longitude:i,latitude:s,pitch:a}=t,o=e.x*xw,d=(1-e.y)*xw,p=e.z*xw,y=_g([i,s]),b=o-y[0],x=d-y[1],C=Math.sqrt(b*b+x*x),P=a*BW,M=1.5*n,k=P<.001?M*Math.cos(P)/p:M*Math.sin(P)/C;t.zoom=Math.log2(k);const z=M*Math.cos(P)/k,V=p-z;t.position=[0,0,V/ty(s)]}else typeof r.transform.elevation=="number"&&(t.position=[0,0,r.transform.elevation])}function SI(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return new jh({id:"mapbox",x:0,y:0,width:r.width,height:r.height,...Bw(t),nearZMultiplier:e?.02:.1,nearZ:t.transform._nearZ/t.transform.height,farZ:t.transform._farZ/t.transform.height})}function MW(r,t){const{mapboxLayers:e,isExternal:n}=r.userData;if(n){const i=Array.from(e,y=>y.id),a=ny(r.props.layers,Boolean).some(y=>y&&!i.includes(y.id));let o=r.getViewports();const d=o.findIndex(y=>y.id==="mapbox"),p=o.length>1||d<0;(a||p)&&(d>=0&&(o=o.slice(),o[d]=SI(r,t,!1)),r._drawLayers("mapbox-repaint",{viewports:o,layerFilter:y=>(!r.props.layerFilter||r.props.layerFilter(y))&&(y.viewport.id!=="mapbox"||!i.includes(y.layer.id)),clearCanvas:!1}))}r.userData.currentViewport=null}function UW(r,t){r.setProps({viewState:Bw(t)}),r.needsRedraw({clearRedrawFlags:!0})}function Cw(r){if(r.userData.isExternal)return;const t=[];r.userData.mapboxLayers.forEach(e=>{const n=e.props.type,i=new n(e.props);t.push(i)}),r.setProps({layers:t})}class RW{constructor(t){if(j(this,"id",void 0),j(this,"type",void 0),j(this,"renderingMode",void 0),j(this,"map",void 0),j(this,"deck",void 0),j(this,"props",void 0),!t.id)throw new Error("Layer must have an unique id");this.id=t.id,this.type="custom",this.renderingMode=t.renderingMode||"3d",this.map=null,this.deck=null,this.props=t}onAdd(t,e){this.map=t,this.deck=CW({map:t,gl:e,deck:this.props.deck}),TW(this.deck,this)}onRemove(){this.deck&&IW(this.deck,this)}setProps(t){Object.assign(this.props,t,{id:this.id}),this.deck&&FW(this.deck)}render(){LW(this.deck,this.map,this)}}const OW=`#define SHADER_NAME point-cloud-layer-vertex-shader

attribute vec3 positions;
attribute vec3 instanceNormals;
attribute vec4 instanceColors;
attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusPixels;
uniform int sizeUnits;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.normal = project_normal(instanceNormals);
  unitPosition = positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;
  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);
  DECKGL_FILTER_SIZE(offset, geometry);

  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
  vColor = vec4(lightColor, instanceColors.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,DW=`#define SHADER_NAME point-cloud-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition);

  if (distToCenter > 1.0) {
    discard;
  }

  gl_FragColor = vColor;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,TI=[0,0,0,255],II=[0,0,1],NW={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:r=>r.position},getNormal:{type:"accessor",value:II},getColor:{type:"accessor",value:TI},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};function kW(r){const{header:t,attributes:e}=r;!t||!e||(r.length=t.vertexCount,e.POSITION&&(e.instancePositions=e.POSITION),e.NORMAL&&(e.instanceNormals=e.NORMAL),e.COLOR_0&&(e.instanceColors=e.COLOR_0))}class Ew extends mf{getShaders(){return super.getShaders({vs:OW,fs:DW,modules:[rw,hj,nw]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:II},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:TI}})}updateState(t){const{changeFlags:e,props:n}=t;if(super.updateState(t),e.extensionsChanged){var i;const{gl:s}=this.context;(i=this.state.model)===null||i===void 0||i.delete(),this.state.model=this._getModel(s),this.getAttributeManager().invalidateAll()}e.dataChanged&&kW(n.data)}draw(t){let{uniforms:e}=t;const{pointSize:n,sizeUnits:i}=this.props;this.state.model.setUniforms(e).setUniforms({sizeUnits:Zv[i],radiusPixels:n}).draw()}_getModel(t){const e=[];for(let n=0;n<3;n++){const i=n/3*Math.PI*2;e.push(Math.cos(i)*2,Math.sin(i)*2,0)}return new af(t,{...this.getShaders(),id:this.props.id,geometry:new mg({drawMode:4,attributes:{positions:new Float32Array(e)}}),isInstanced:!0})}}j(Ew,"layerName","PointCloudLayer"),j(Ew,"defaultProps",NW);const Ia={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};new se,new se;const Eg=new se,FI=new se;class Sg{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;j(this,"center",void 0),j(this,"radius",void 0),this.radius=-0,this.center=new se,this.fromCenterRadius(t,e)}fromCenterRadius(t,e){return this.center.from(t),this.radius=e,this}fromCornerPoints(t,e){return e=Eg.from(e),this.center=new se().from(t).add(e).scale(.5),this.radius=this.center.distance(e),this}equals(t){return this===t||!!t&&this.center.equals(t.center)&&this.radius===t.radius}clone(){return new Sg(this.center,this.radius)}union(t){const e=this.center,n=this.radius,i=t.center,s=t.radius,a=Eg.copy(i).subtract(e),o=a.magnitude();if(n>=o+s)return this.clone();if(s>=o+n)return t.clone();const d=(n+o+s)*.5;return FI.copy(a).scale((-n+d)/o).add(e),this.center.copy(FI),this.radius=d,this}expand(t){const n=Eg.from(t).subtract(this.center).magnitude();return n>this.radius&&(this.radius=n),this}transform(t){this.center.transform(t);const e=wG(Eg,t);return this.radius=Math.max(e[0],Math.max(e[1],e[2]))*this.radius,this}distanceSquaredTo(t){const e=this.distanceTo(t);return e*e}distanceTo(t){const n=Eg.from(t).subtract(this.center);return Math.max(0,n.len()-this.radius)}intersectPlane(t){const e=this.center,n=this.radius,s=t.normal.dot(e)+t.distance;return s<-n?Ia.OUTSIDE:s<n?Ia.INTERSECTING:Ia.INSIDE}}const QW=new se,zW=new se,uy=new se,Ay=new se,hy=new se,HW=new se,VW=new se,Qu={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class Tg{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0,0,0,0,0,0,0];j(this,"center",void 0),j(this,"halfAxes",void 0),this.center=new se().from(t),this.halfAxes=new Di(e)}get halfSize(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new se(t).len(),new se(e).len(),new se(n).len()]}get quaternion(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),i=new se(t).normalize(),s=new se(e).normalize(),a=new se(n).normalize();return new fg().fromMatrix3(new Di([...i,...s,...a]))}fromCenterHalfSizeQuaternion(t,e,n){const i=new fg(n),s=new Di().fromQuaternion(i);return s[0]=s[0]*e[0],s[1]=s[1]*e[0],s[2]=s[2]*e[0],s[3]=s[3]*e[1],s[4]=s[4]*e[1],s[5]=s[5]*e[1],s[6]=s[6]*e[2],s[7]=s[7]*e[2],s[8]=s[8]*e[2],this.center=new se().from(t),this.halfAxes=s,this}clone(){return new Tg(this.center,this.halfAxes)}equals(t){return this===t||!!t&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}getBoundingSphere(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Sg;const e=this.halfAxes,n=e.getColumn(0,uy),i=e.getColumn(1,Ay),s=e.getColumn(2,hy),a=QW.copy(n).add(i).add(s);return t.center.copy(this.center),t.radius=a.magnitude(),t}intersectPlane(t){const e=this.center,n=t.normal,i=this.halfAxes,s=n.x,a=n.y,o=n.z,d=Math.abs(s*i[Qu.COLUMN0ROW0]+a*i[Qu.COLUMN0ROW1]+o*i[Qu.COLUMN0ROW2])+Math.abs(s*i[Qu.COLUMN1ROW0]+a*i[Qu.COLUMN1ROW1]+o*i[Qu.COLUMN1ROW2])+Math.abs(s*i[Qu.COLUMN2ROW0]+a*i[Qu.COLUMN2ROW1]+o*i[Qu.COLUMN2ROW2]),p=n.dot(e)+t.distance;return p<=-d?Ia.OUTSIDE:p>=d?Ia.INSIDE:Ia.INTERSECTING}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=zW.from(t).subtract(this.center),n=this.halfAxes,i=n.getColumn(0,uy),s=n.getColumn(1,Ay),a=n.getColumn(2,hy),o=i.magnitude(),d=s.magnitude(),p=a.magnitude();i.normalize(),s.normalize(),a.normalize();let y=0,b;return b=Math.abs(e.dot(i))-o,b>0&&(y+=b*b),b=Math.abs(e.dot(s))-d,b>0&&(y+=b*b),b=Math.abs(e.dot(a))-p,b>0&&(y+=b*b),y}computePlaneDistances(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[-0,-0],i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const a=this.center,o=this.halfAxes,d=o.getColumn(0,uy),p=o.getColumn(1,Ay),y=o.getColumn(2,hy),b=HW.copy(d).add(p).add(y).add(a),x=VW.copy(b).subtract(t);let C=e.dot(x);return i=Math.min(C,i),s=Math.max(C,s),b.copy(a).add(d).add(p).subtract(y),x.copy(b).subtract(t),C=e.dot(x),i=Math.min(C,i),s=Math.max(C,s),b.copy(a).add(d).subtract(p).add(y),x.copy(b).subtract(t),C=e.dot(x),i=Math.min(C,i),s=Math.max(C,s),b.copy(a).add(d).subtract(p).subtract(y),x.copy(b).subtract(t),C=e.dot(x),i=Math.min(C,i),s=Math.max(C,s),a.copy(b).subtract(d).add(p).add(y),x.copy(b).subtract(t),C=e.dot(x),i=Math.min(C,i),s=Math.max(C,s),a.copy(b).subtract(d).add(p).subtract(y),x.copy(b).subtract(t),C=e.dot(x),i=Math.min(C,i),s=Math.max(C,s),a.copy(b).subtract(d).subtract(p).add(y),x.copy(b).subtract(t),C=e.dot(x),i=Math.min(C,i),s=Math.max(C,s),a.copy(b).subtract(d).subtract(p).subtract(y),x.copy(b).subtract(t),C=e.dot(x),i=Math.min(C,i),s=Math.max(C,s),n[0]=i,n[1]=s,n}transform(t){this.center.transformAsPoint(t);const e=this.halfAxes.getColumn(0,uy);e.transformAsPoint(t);const n=this.halfAxes.getColumn(1,Ay);n.transformAsPoint(t);const i=this.halfAxes.getColumn(2,hy);return i.transformAsPoint(t),this.halfAxes=new Di([...e,...n,...i]),this}getTransform(){throw new Error("not implemented")}}const LI=new se,PI=new se;class Zl{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,1],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;j(this,"normal",void 0),j(this,"distance",void 0),this.normal=new se,this.distance=-0,this.fromNormalDistance(t,e)}fromNormalDistance(t,e){return Wl(Number.isFinite(e)),this.normal.from(t).normalize(),this.distance=e,this}fromPointNormal(t,e){t=LI.from(t),this.normal.from(e).normalize();const n=-this.normal.dot(t);return this.distance=n,this}fromCoefficients(t,e,n,i){return this.normal.set(t,e,n),Wl(Xl(this.normal.len(),1)),this.distance=i,this}clone(){return new Zl(this.normal,this.distance)}equals(t){return Xl(this.distance,t.distance)&&Xl(this.normal,t.normal)}getPointDistance(t){return this.normal.dot(t)+this.distance}transform(t){const e=PI.copy(this.normal).transformAsVector(t).normalize(),n=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(n,e)}projectPointOntoPlane(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];t=LI.from(t);const n=this.getPointDistance(t),i=PI.copy(this.normal).scale(n);return t.subtract(i).to(e)}}const MI=[new se([1,0,0]),new se([0,1,0]),new se([0,0,1])],UI=new se,GW=new se;new Zl(new se(1,0,0),0);class al{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];j(this,"planes",void 0),this.planes=t}fromBoundingSphere(t){this.planes.length=2*MI.length;const e=t.center,n=t.radius;let i=0;for(const s of MI){let a=this.planes[i],o=this.planes[i+1];a||(a=this.planes[i]=new Zl),o||(o=this.planes[i+1]=new Zl);const d=UI.copy(s).scale(-n).add(e);-s.dot(d),a.fromPointNormal(d,s);const p=UI.copy(s).scale(n).add(e),y=GW.copy(s).negate();-y.dot(p),o.fromPointNormal(p,y),i+=2}return this}computeVisibility(t){let e=Ia.INSIDE;for(const n of this.planes)switch(t.intersectPlane(n)){case Ia.OUTSIDE:return Ia.OUTSIDE;case Ia.INTERSECTING:e=Ia.INTERSECTING;break}return e}computeVisibilityWithPlaneMask(t,e){if(Wl(Number.isFinite(e),"parentPlaneMask is required."),e===al.MASK_OUTSIDE||e===al.MASK_INSIDE)return e;let n=al.MASK_INSIDE;const i=this.planes;for(let s=0;s<this.planes.length;++s){const a=s<31?1<<s:0;if(s<31&&!(e&a))continue;const o=i[s],d=t.intersectPlane(o);if(d===Ia.OUTSIDE)return al.MASK_OUTSIDE;d===Ia.INTERSECTING&&(n|=a)}return n}}j(al,"MASK_OUTSIDE",4294967295),j(al,"MASK_INSIDE",0),j(al,"MASK_INDETERMINATE",2147483647),new se,new se,new se,new se,new se,new se,new se,new se,new se,new se,new se,new se,new se,new se,new se,new se,new se;const Gc=new Di,jW=new Di,qW=new Di,dy=new Di,RI=new Di;function KW(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e=pg.EPSILON20,n=10;let i=0,s=0;const a=jW,o=qW;a.identity(),o.copy(r);const d=e*$W(o);for(;s<n&&WW(o)>d;)XW(o,dy),RI.copy(dy).transpose(),o.multiplyRight(dy),o.multiplyLeft(RI),a.multiplyRight(dy),++i>2&&(++s,i=0);return t.unitary=a.toTarget(t.unitary),t.diagonal=o.toTarget(t.diagonal),t}function $W(r){let t=0;for(let e=0;e<9;++e){const n=r[e];t+=n*n}return Math.sqrt(t)}const Sw=[1,0,0],Tw=[2,2,1];function WW(r){let t=0;for(let e=0;e<3;++e){const n=r[Gc.getElementIndex(Tw[e],Sw[e])];t+=2*n*n}return Math.sqrt(t)}function XW(r,t){const e=pg.EPSILON15;let n=0,i=1;for(let p=0;p<3;++p){const y=Math.abs(r[Gc.getElementIndex(Tw[p],Sw[p])]);y>n&&(i=p,n=y)}const s=Sw[i],a=Tw[i];let o=1,d=0;if(Math.abs(r[Gc.getElementIndex(a,s)])>e){const p=r[Gc.getElementIndex(a,a)],y=r[Gc.getElementIndex(s,s)],b=r[Gc.getElementIndex(a,s)],x=(p-y)/2/b;let C;x<0?C=-1/(-x+Math.sqrt(1+x*x)):C=1/(x+Math.sqrt(1+x*x)),o=1/Math.sqrt(1+C*C),d=C*o}return Di.IDENTITY.to(t),t[Gc.getElementIndex(s,s)]=t[Gc.getElementIndex(a,a)]=o,t[Gc.getElementIndex(a,s)]=d,t[Gc.getElementIndex(s,a)]=-d,t}const zA=new se,JW=new se,YW=new se,ZW=new se,tX=new se,eX=new Di,rX={diagonal:new Di,unitary:new Di};function nX(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Tg;if(!r||r.length===0)return t.halfAxes=new Di([0,0,0,0,0,0,0,0,0]),t.center=new se,t;const e=r.length,n=new se(0,0,0);for(const Ft of r)n.add(Ft);const i=1/e;n.multiplyByScalar(i);let s=0,a=0,o=0,d=0,p=0,y=0;for(const Ft of r){const Tt=zA.copy(Ft).subtract(n);s+=Tt.x*Tt.x,a+=Tt.x*Tt.y,o+=Tt.x*Tt.z,d+=Tt.y*Tt.y,p+=Tt.y*Tt.z,y+=Tt.z*Tt.z}s*=i,a*=i,o*=i,d*=i,p*=i,y*=i;const b=eX;b[0]=s,b[1]=a,b[2]=o,b[3]=a,b[4]=d,b[5]=p,b[6]=o,b[7]=p,b[8]=y;const{unitary:x}=KW(b,rX),C=t.halfAxes.copy(x);let P=C.getColumn(0,YW),M=C.getColumn(1,ZW),k=C.getColumn(2,tX),z=-Number.MAX_VALUE,V=-Number.MAX_VALUE,$=-Number.MAX_VALUE,tt=Number.MAX_VALUE,pt=Number.MAX_VALUE,gt=Number.MAX_VALUE;for(const Ft of r)zA.copy(Ft),z=Math.max(zA.dot(P),z),V=Math.max(zA.dot(M),V),$=Math.max(zA.dot(k),$),tt=Math.min(zA.dot(P),tt),pt=Math.min(zA.dot(M),pt),gt=Math.min(zA.dot(k),gt);P=P.multiplyByScalar(.5*(tt+z)),M=M.multiplyByScalar(.5*(pt+V)),k=k.multiplyByScalar(.5*(gt+$)),t.center.copy(P).add(M).add(k);const mt=JW.set(z-tt,V-pt,$-gt).multiplyByScalar(.5),dt=new Di([mt[0],0,0,0,mt[1],0,0,0,mt[2]]);return t.halfAxes.multiplyRight(dt),t}const Iw=Math.PI/180,fy=new Float32Array(16),OI=new Float32Array(12);function DI(r,t,e){const n=t[0]*Iw,i=t[1]*Iw,s=t[2]*Iw,a=Math.sin(s),o=Math.sin(n),d=Math.sin(i),p=Math.cos(s),y=Math.cos(n),b=Math.cos(i),x=e[0],C=e[1],P=e[2];r[0]=x*b*y,r[1]=x*d*y,r[2]=x*-o,r[3]=C*(-d*p+b*o*a),r[4]=C*(b*p+d*o*a),r[5]=C*y*a,r[6]=P*(d*a+b*o*p),r[7]=P*(-b*a+d*o*p),r[8]=P*y*p}function NI(r){return r[0]=r[0],r[1]=r[1],r[2]=r[2],r[3]=r[4],r[4]=r[5],r[5]=r[6],r[6]=r[8],r[7]=r[9],r[8]=r[10],r[9]=r[12],r[10]=r[13],r[11]=r[14],r.subarray(0,12)}const kI={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(r,t){let{startRow:e,endRow:n}=t;const{data:i,getOrientation:s,getScale:a,getTranslation:o,getTransformMatrix:d}=this.props,p=Array.isArray(d),y=p&&d.length===16,b=Array.isArray(a),x=Array.isArray(s),C=Array.isArray(o),P=y||!p&&!!d(i[0]);P?r.constant=y:r.constant=x&&b&&C;const M=r.value;if(r.constant){let k;P?(fy.set(d),k=NI(fy)):(k=OI,DI(k,s,a),k.set(o,9)),r.value=new Float32Array(k)}else{let k=e*r.size;const{iterable:z,objectInfo:V}=uI(i,e,n);for(const $ of z){V.index++;let tt;if(P)fy.set(y?d:d($,V)),tt=NI(fy);else{tt=OI;const pt=x?s:s($,V),gt=b?a:a($,V);DI(tt,pt,gt),tt.set(C?o:o($,V),9)}M[k++]=tt[0],M[k++]=tt[1],M[k++]=tt[2],M[k++]=tt[3],M[k++]=tt[4],M[k++]=tt[5],M[k++]=tt[6],M[k++]=tt[7],M[k++]=tt[8],M[k++]=tt[9],M[k++]=tt[10],M[k++]=tt[11]}}}};function QI(r,t){return t===En.CARTESIAN||t===En.METER_OFFSETS||t===En.DEFAULT&&!r.isGeospatial}const iX=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,sX=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function zI(r){let t=1/0,e=1/0,n=1/0,i=-1/0,s=-1/0,a=-1/0;const o=r.POSITION?r.POSITION.value:[],d=o&&o.length;for(let p=0;p<d;p+=3){const y=o[p],b=o[p+1],x=o[p+2];t=y<t?y:t,e=b<e?b:e,n=x<n?x:n,i=y>i?y:i,s=b>s?b:s,a=x>a?x:a}return[[t,e,n],[i,s,a]]}function oX(r,t){if(!r)throw new Error("loader assertion failed.")}class yf{constructor(t,e){j(this,"fields",void 0),j(this,"metadata",void 0),oX(Array.isArray(t)),aX(t),this.fields=t,this.metadata=e||new Map}compareTo(t){if(this.metadata!==t.metadata||this.fields.length!==t.fields.length)return!1;for(let e=0;e<this.fields.length;++e)if(!this.fields[e].compareTo(t.fields[e]))return!1;return!0}select(){const t=Object.create(null);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];for(const a of n)t[a]=!0;const s=this.fields.filter(a=>t[a.name]);return new yf(s,this.metadata)}selectAt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.map(s=>this.fields[s]).filter(Boolean);return new yf(i,this.metadata)}assign(t){let e,n=this.metadata;if(t instanceof yf){const a=t;e=a.fields,n=HI(HI(new Map,this.metadata),a.metadata)}else e=t;const i=Object.create(null);for(const a of this.fields)i[a.name]=a;for(const a of e)i[a.name]=a;const s=Object.values(i);return new yf(s,n)}}function aX(r){const t={};for(const e of r)t[e.name]&&console.warn("Schema: duplicated field name",e.name,e),t[e.name]=!0}function HI(r,t){return new Map([...r||new Map,...t||new Map])}class py{constructor(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;j(this,"name",void 0),j(this,"type",void 0),j(this,"nullable",void 0),j(this,"metadata",void 0),this.name=t,this.type=e,this.nullable=n,this.metadata=i}get typeId(){return this.type&&this.type.typeId}clone(){return new py(this.name,this.type,this.nullable,this.metadata)}compareTo(t){return this.name===t.name&&this.type===t.type&&this.nullable===t.nullable&&this.metadata===t.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let Ni=function(r){return r[r.NONE=0]="NONE",r[r.Null=1]="Null",r[r.Int=2]="Int",r[r.Float=3]="Float",r[r.Binary=4]="Binary",r[r.Utf8=5]="Utf8",r[r.Bool=6]="Bool",r[r.Decimal=7]="Decimal",r[r.Date=8]="Date",r[r.Time=9]="Time",r[r.Timestamp=10]="Timestamp",r[r.Interval=11]="Interval",r[r.List=12]="List",r[r.Struct=13]="Struct",r[r.Union=14]="Union",r[r.FixedSizeBinary=15]="FixedSizeBinary",r[r.FixedSizeList=16]="FixedSizeList",r[r.Map=17]="Map",r[r.Dictionary=-1]="Dictionary",r[r.Int8=-2]="Int8",r[r.Int16=-3]="Int16",r[r.Int32=-4]="Int32",r[r.Int64=-5]="Int64",r[r.Uint8=-6]="Uint8",r[r.Uint16=-7]="Uint16",r[r.Uint32=-8]="Uint32",r[r.Uint64=-9]="Uint64",r[r.Float16=-10]="Float16",r[r.Float32=-11]="Float32",r[r.Float64=-12]="Float64",r[r.DateDay=-13]="DateDay",r[r.DateMillisecond=-14]="DateMillisecond",r[r.TimestampSecond=-15]="TimestampSecond",r[r.TimestampMillisecond=-16]="TimestampMillisecond",r[r.TimestampMicrosecond=-17]="TimestampMicrosecond",r[r.TimestampNanosecond=-18]="TimestampNanosecond",r[r.TimeSecond=-19]="TimeSecond",r[r.TimeMillisecond=-20]="TimeMillisecond",r[r.TimeMicrosecond=-21]="TimeMicrosecond",r[r.TimeNanosecond=-22]="TimeNanosecond",r[r.DenseUnion=-23]="DenseUnion",r[r.SparseUnion=-24]="SparseUnion",r[r.IntervalDayTime=-25]="IntervalDayTime",r[r.IntervalYearMonth=-26]="IntervalYearMonth",r}({}),VI,GI,jI;class Fw{static isNull(t){return t&&t.typeId===Ni.Null}static isInt(t){return t&&t.typeId===Ni.Int}static isFloat(t){return t&&t.typeId===Ni.Float}static isBinary(t){return t&&t.typeId===Ni.Binary}static isUtf8(t){return t&&t.typeId===Ni.Utf8}static isBool(t){return t&&t.typeId===Ni.Bool}static isDecimal(t){return t&&t.typeId===Ni.Decimal}static isDate(t){return t&&t.typeId===Ni.Date}static isTime(t){return t&&t.typeId===Ni.Time}static isTimestamp(t){return t&&t.typeId===Ni.Timestamp}static isInterval(t){return t&&t.typeId===Ni.Interval}static isList(t){return t&&t.typeId===Ni.List}static isStruct(t){return t&&t.typeId===Ni.Struct}static isUnion(t){return t&&t.typeId===Ni.Union}static isFixedSizeBinary(t){return t&&t.typeId===Ni.FixedSizeBinary}static isFixedSizeList(t){return t&&t.typeId===Ni.FixedSizeList}static isMap(t){return t&&t.typeId===Ni.Map}static isDictionary(t){return t&&t.typeId===Ni.Dictionary}get typeId(){return Ni.NONE}compareTo(t){return this===t}}VI=Symbol.toStringTag;class _f extends Fw{constructor(t,e){super(),j(this,"isSigned",void 0),j(this,"bitWidth",void 0),this.isSigned=t,this.bitWidth=e}get typeId(){return Ni.Int}get[VI](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class lX extends _f{constructor(){super(!0,8)}}class cX extends _f{constructor(){super(!0,16)}}class uX extends _f{constructor(){super(!0,32)}}class AX extends _f{constructor(){super(!1,8)}}class hX extends _f{constructor(){super(!1,16)}}class dX extends _f{constructor(){super(!1,32)}}const qI={HALF:16,SINGLE:32,DOUBLE:64};GI=Symbol.toStringTag;class KI extends Fw{constructor(t){super(),j(this,"precision",void 0),this.precision=t}get typeId(){return Ni.Float}get[GI](){return"Float"}toString(){return"Float".concat(this.precision)}}class fX extends KI{constructor(){super(qI.SINGLE)}}class pX extends KI{constructor(){super(qI.DOUBLE)}}jI=Symbol.toStringTag;class gX extends Fw{constructor(t,e){super(),j(this,"listSize",void 0),j(this,"children",void 0),this.listSize=t,this.children=[e]}get typeId(){return Ni.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[jI](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function mX(r){switch(r.constructor){case Int8Array:return new lX;case Uint8Array:return new AX;case Int16Array:return new cX;case Uint16Array:return new hX;case Int32Array:return new uX;case Uint32Array:return new dX;case Float32Array:return new fX;case Float64Array:return new pX;default:throw new Error("array type not supported")}}function yX(r,t,e){const n=mX(t.value),i=e||_X(t);return new py(r,new gX(t.size,new py("value",n)),!1,i)}function _X(r){const t=new Map;return"byteOffset"in r&&t.set("byteOffset",r.byteOffset.toString(10)),"byteStride"in r&&t.set("byteStride",r.byteStride.toString(10)),"normalized"in r&&t.set("normalized",r.normalized.toString()),t}function $I(r,t){(r.COLOR_0||r.colors)&&t||(r.colors={constant:!0,value:new Float32Array([1,1,1])}),Tn.assert(r.positions||r.POSITION,'no "postions" or "POSITION" attribute in mesh')}function WI(r,t){if(r.attributes)return $I(r.attributes,t),r instanceof mg?r:new mg(r);if(r.positions||r.POSITION)return $I(r,t),new mg({attributes:r});throw Error("Invalid mesh")}const vX={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:r=>r.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class Lw extends mf{constructor(){super(...arguments),j(this,"state",void 0)}getShaders(){const t=!fn(this.context.gl),e={};return hb(this.context.gl,mi.GLSL_DERIVATIVES)&&(e.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:iX,fs:sX,modules:[rw,dj,nw],transpileToGLSL100:t,defines:e})}getBounds(){var t;if(this.props._instanced)return super.getBounds();let e=this.state.positionBounds;if(e)return e;const{mesh:n}=this.props;if(!n)return null;if(e=(t=n.header)===null||t===void 0?void 0:t.boundingBox,!e){const{attributes:i}=WI(n,this.props._useMeshColors);i.POSITION=i.POSITION||i.positions,e=zI(i)}return this.state.positionBounds=e,e}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:kI}),this.setState({emptyTexture:new Ca(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:i}=t;if(e.mesh!==n.mesh||i.extensionsChanged){var s;if(this.state.positionBounds=null,(s=this.state.model)===null||s===void 0||s.delete(),e.mesh){this.state.model=this.getModel(e.mesh);const a=e.mesh.attributes||e.mesh;this.setState({hasNormals:!!(a.NORMAL||a.normals)})}this.getAttributeManager().invalidateAll()}e.texture!==n.texture&&this.setTexture(e.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(t){super.finalizeState(t),this.state.emptyTexture.delete()}draw(t){let{uniforms:e}=t;if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:i,coordinateSystem:s,_instanced:a}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:i,composeModelMatrix:!a||QI(n,s),flatShading:!this.state.hasNormals}).draw()}get isLoaded(){var t;return((t=this.state)===null||t===void 0?void 0:t.model)&&super.isLoaded}getModel(t){const e=new af(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:WI(t,this.props._useMeshColors),isInstanced:!0}),{texture:n}=this.props,{emptyTexture:i}=this.state;return e.setUniforms({sampler:n||i,hasTexture:!!n}),e}setTexture(t){const{emptyTexture:e,model:n}=this.state;n&&n.setUniforms({sampler:t||e,hasTexture:!!t})}}j(Lw,"defaultProps",vX),j(Lw,"layerName","SimpleMeshLayer");class vf{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:e}=t;this.id=e||Uu(this.constructor.name),this.display=!0,this.position=new se,this.rotation=new se,this.scale=new se(1,1,1),this.matrix=new wn,this.userData={},this.props={},this._setScenegraphNodeProps(t)}delete(){}setProps(t){return this._setScenegraphNodeProps(t),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}getBounds(){return null}setPosition(t){return ir(t.length===3,"setPosition requires vector argument"),this.position=t,this}setRotation(t){return ir(t.length===3,"setRotation requires vector argument"),this.rotation=t,this}setScale(t){return ir(t.length===3,"setScale requires vector argument"),this.scale=t,this}setMatrix(t){(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?this.matrix.copy(t):this.matrix=t}setMatrixComponents(t){let{position:e,rotation:n,scale:i,update:s=!0}=t;return e&&this.setPosition(e),n&&this.setRotation(n),i&&this.setScale(i),s&&this.updateMatrix(),this}updateMatrix(){const t=this.position,e=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(t),this.matrix.rotateXYZ(e),this.matrix.scale(n),this}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{position:e,rotation:n,scale:i}=t;return e&&this.setPosition(e),n&&this.setRotation(n),i&&this.setScale(i),this.updateMatrix(),this}getCoordinateUniforms(t,e){ir(t),e=e||this.matrix;const n=new wn(t).multiplyRight(e),i=n.invert(),s=i.transpose();return{viewMatrix:t,modelMatrix:e,objectMatrix:e,worldMatrix:n,worldInverseMatrix:i,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(t){"display"in t&&(this.display=t.display),"position"in t&&this.setPosition(t.position),"rotation"in t&&this.setRotation(t.rotation),"scale"in t&&this.setScale(t.scale),"matrix"in t&&this.setMatrix(t.matrix),Object.assign(this.props,t)}}class Ig extends vf{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t=Array.isArray(t)?{children:t}:t;const{children:e=[]}=t;vr.assert(e.every(n=>n instanceof vf),"every child must an instance of ScenegraphNode"),super(t),this.children=e}add(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)Array.isArray(i)?this.add(...i):this.children.push(i);return this}remove(t){const e=this.children,n=e.indexOf(t);return n>-1&&e.splice(n,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(t=>t.delete()),this.removeAll(),super.delete()}getBounds(){const t=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse((e,n)=>{let{worldMatrix:i}=n;const s=e.getBounds();if(!s)return;const[a,o]=s,d=new se(a).add(o).divide([2,2,2]);i.transformAsPoint(d,d);const p=new se(o).subtract(a).divide([2,2,2]);i.transformAsVector(p,p);for(let y=0;y<8;y++){const b=new se(y&1?-1:1,y&2?-1:1,y&4?-1:1).multiply(p).add(d);for(let x=0;x<3;x++)t[0][x]=Math.min(t[0][x],b[x]),t[1][x]=Math.max(t[1][x],b[x])}}),Number.isFinite(t[0][0])?t:null}traverse(t){let{worldMatrix:e=new wn}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=new wn(e).multiplyRight(this.matrix);for(const i of this.children)i instanceof Ig?i.traverse(t,{worldMatrix:n}):t(i,{worldMatrix:n})}}const bX={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},wX={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function XI(r){if(!r._animation){const t=wX[r.componentType],e=bX[r.type],n=e*r.count,{buffer:i,byteOffset:s}=r.bufferView.data,a=new t(i,s+(r.byteOffset||0),n);if(e===1)r._animation=Array.from(a);else{const o=[];for(let d=0;d<a.length;d+=e)o.push(Array.from(a.slice(d,d+e)));r._animation=o}}return r._animation}const xX=new wn;function BX(r,t){if(t.matrix.identity(),r.translation&&t.matrix.translate(r.translation),r.rotation){const e=xX.fromQuaternion(r.rotation);t.matrix.multiplyRight(e)}r.scale&&t.matrix.scale(r.scale)}const Pw=new fg;function CX(r,t,e,n,i){if(t==="rotation"){Pw.slerp({start:e,target:n,ratio:i});for(let s=0;s<Pw.length;s++)r[t][s]=Pw[s]}else for(let s=0;s<e.length;s++)r[t][s]=i*n[s]+(1-i)*e[s]}function EX(r,t,e){let{p0:n,outTangent0:i,inTangent1:s,p1:a,tDiff:o,ratio:d}=e;for(let p=0;p<r[t].length;p++){const y=i[p]*o,b=s[p]*o;r[t][p]=(2*Math.pow(d,3)-3*Math.pow(d,2)+1)*n[p]+(Math.pow(d,3)-2*Math.pow(d,2)+d)*y+(-2*Math.pow(d,3)+3*Math.pow(d,2))*a[p]+(Math.pow(d,3)-Math.pow(d,2))*b}}function SX(r,t,e){for(let n=0;n<e.length;n++)r[t][n]=e[n]}function TX(r,t,e,n){let{input:i,interpolation:s,output:a}=t;const o=i[i.length-1],d=r%o,p=i.findIndex(C=>C>=d),y=Math.max(0,p-1);if(!Array.isArray(e[n]))switch(n){case"translation":e[n]=[0,0,0];break;case"rotation":e[n]=[0,0,0,1];break;case"scale":e[n]=[1,1,1];break;default:vr.warn("Bad animation path ".concat(n))()}ir(e[n].length===a[y].length);const b=i[y],x=i[p];switch(s){case"STEP":SX(e,n,a[y]);break;case"LINEAR":if(x>b){const C=(d-b)/(x-b);CX(e,n,a[y],a[p],C)}break;case"CUBICSPLINE":if(x>b){const C=(d-b)/(x-b),P=x-b,M=a[3*y+1],k=a[3*y+2],z=a[3*p+0],V=a[3*p+1];EX(e,n,{p0:M,outTangent0:k,inTangent1:z,p1:V,tDiff:P,ratio:C})}break;default:vr.warn("Interpolation ".concat(s," not supported"))();break}}class IX{constructor(t){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,t)}animate(t){if(!this.playing)return;const n=(t/1e3-this.startTime)*this.speed;this.channels.forEach(i=>{let{sampler:s,target:a,path:o}=i;TX(n,s,a,o),BX(a,a._node)})}}class FX{constructor(t){this.animations=t.animations.map((e,n)=>{const i=e.name||"Animation-".concat(n),s=e.samplers.map(o=>{let{input:d,interpolation:p="LINEAR",output:y}=o;return{input:XI(t.accessors[d]),interpolation:p,output:XI(t.accessors[y])}}),a=e.channels.map(o=>{let{sampler:d,target:p}=o;return{sampler:s[d],target:t.nodes[p.node],path:p.path}});return new IX({name:i,channels:a})})}animate(t){this.setTime(t)}setTime(t){this.animations.forEach(e=>e.animate(t))}getAnimations(){return this.animations}}class LX extends vf{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),this.onBeforeRender=null,this.AfterRender=null,t instanceof af?(this.model=t,this._setModelNodeProps(e)):this.model=new af(t,e),this.bounds=null,this.managedResources=e.managedResources||[]}setProps(t){return super.setProps(t),this._setModelNodeProps(t),this}getBounds(){return this.bounds}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(t=>t.delete()),this.managedResources=[]}draw(){return this.model.draw(...arguments)}setUniforms(){return this.model.setUniforms(...arguments),this}setAttributes(){return this.model.setAttributes(...arguments),this}updateModuleSettings(){return this.model.updateModuleSettings(...arguments),this}_setModelNodeProps(t){this.model.setProps(t)}}class JI{constructor(t,e){let{attributes:n,material:i,pbrDebug:s,imageBasedLightingEnvironment:a,lights:o,useTangents:d}=e;this.gl=t,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},hb(t,mi.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],a&&(this.uniforms.u_DiffuseEnvSampler=a.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=a.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=a.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),s&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(n.NORMAL,"HAS_NORMALS"),this.defineIfPresent(n.TANGENT&&d,"HAS_TANGENTS"),this.defineIfPresent(n.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(a,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(s,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(t,e){t&&(this.defines[e]=1)}parseTexture(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=t.texture&&t.texture.sampler&&t.texture.sampler.parameters||{},s=t.texture.source.image;let a,o={};s.compressed?(a=s,o={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):a={data:s};const d=new Ca(this.gl,{id:t.name||t.id,parameters:{...i,...o},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...a});this.uniforms[e]=d,this.defineIfPresent(n,n),this.generatedTextures.push(d)}parsePbrMetallicRoughness(t){t.baseColorTexture&&this.parseTexture(t.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=t.baseColorFactor||[1,1,1,1],t.metallicRoughnessTexture&&this.parseTexture(t.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:e=1,roughnessFactor:n=1}=t;this.uniforms.u_MetallicRoughnessValues=[e,n]}parseMaterial(t){if(this.uniforms.pbr_uUnlit=!!t.unlit,t.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(t.pbrMetallicRoughness),t.normalTexture){this.parseTexture(t.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:e=1}=t.normalTexture;this.uniforms.u_NormalScale=e}if(t.occlusionTexture){this.parseTexture(t.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:e=1}=t.occlusionTexture;this.uniforms.u_OcclusionStrength=e}if(t.emissiveTexture&&(this.parseTexture(t.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=t.emissiveFactor||[0,0,0]),t.alphaMode==="MASK"){const{alphaCutoff:e=.5}=t;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=e}else t.alphaMode==="BLEND"&&(vr.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}delete(){this.generatedTextures.forEach(t=>t.delete())}}const PX=`
#if (__VERSION__ < 300)
  #define _attr attribute
#else
  #define _attr in
#endif

  _attr vec4 POSITION;

  #ifdef HAS_NORMALS
    _attr vec4 NORMAL;
  #endif

  #ifdef HAS_TANGENTS
    _attr vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    _attr vec2 TEXCOORD_0;
  #endif

  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = NORMAL;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = TEXCOORD_0;
    #endif

    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = u_MVPMatrix * POSITION;
  }
`,MX=`
#if (__VERSION__ < 300)
  #define fragmentColor gl_FragColor
#else
  out vec4 fragmentColor;
#endif

  void main(void) {
    fragmentColor = pbr_filterColor(vec4(0));
  }
`;function YI(r,t){return fn(r)?`#version 300 es
`.concat(t):t}function UX(r,t){const{id:e,drawMode:n,vertexCount:i,attributes:s,modelOptions:a}=t,o=new JI(r,t);vr.info(4,"createGLTFModel defines: ",o.defines)();const d=[];d.push(...o.generatedTextures),d.push(...Object.values(s).map(y=>y.buffer));const p=new LX(r,{id:e,drawMode:n,vertexCount:i,modules:[Hb],parameters:o.parameters,vs:YI(r,PX),fs:YI(r,MX),managedResources:d,...a,defines:{...o.defines,...a.defines}});return p.setProps({attributes:s}),p.setUniforms(o.uniforms),p}const RX={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},OX={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class DX{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=t,this.options=Object.assign({},OX,e)}instantiate(t){return this.gltf=t,(t.scenes||[]).map(n=>this.createScene(n))}createAnimator(){return Array.isArray(this.gltf.animations)?new FX(this.gltf):null}createScene(t){const n=(t.nodes||[]).map(s=>this.createNode(s));return new Ig({id:t.name||t.id,children:n})}createNode(t){if(!t._node){const n=(t.children||[]).map(s=>this.createNode(s));t.mesh&&n.push(this.createMesh(t.mesh));const i=new Ig({id:t.name||t.id,children:n});if(t.matrix)i.setMatrix(t.matrix);else{if(i.matrix.identity(),t.translation&&i.matrix.translate(t.translation),t.rotation){const s=new wn().fromQuaternion(t.rotation);i.matrix.multiplyRight(s)}t.scale&&i.matrix.scale(t.scale)}t._node=i}return t._node}createMesh(t){if(!t._mesh){const n=(t.primitives||[]).map((s,a)=>this.createPrimitive(s,a,t)),i=new Ig({id:t.name||t.id,children:n});t._mesh=i}return t._mesh}getVertexCount(t){vr.warn("getVertexCount() not found")()}createPrimitive(t,e,n){const i=UX(this.gl,Object.assign({id:t.name||"".concat(n.name||n.id,"-primitive-").concat(e),drawMode:t.mode||4,vertexCount:t.indices?t.indices.count:this.getVertexCount(t.attributes),attributes:this.createAttributes(t.attributes,t.indices),material:t.material},this.options));return i.bounds=[t.attributes.POSITION.min,t.attributes.POSITION.max],i}createAttributes(t,e){const n={};return Object.keys(t).forEach(i=>{n[i]=this.createAccessor(t[i],this.createBuffer(t[i],this.gl.ARRAY_BUFFER))}),e&&(n.indices=this.createAccessor(e,this.createBuffer(e,this.gl.ELEMENT_ARRAY_BUFFER))),vr.info(4,"glTF Attributes",{attributes:t,indices:e,generated:n})(),n}createBuffer(t,e){t.bufferView||(t.bufferView={});const{bufferView:n}=t;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[e]||(n.lumaBuffers[e]=new ni(this.gl,{id:"from-".concat(n.id),data:n.data||t.value,target:e})),n.lumaBuffers[e]}createAccessor(t,e){return new ra({buffer:e,offset:t.byteOffset||0,stride:t.bufferView.byteStride||0,type:t.componentType,size:RX[t.type]})}createSampler(t){return t}needsPOT(){return!1}}function NX(r,t,e){const n=new DX(r,e),i=n.instantiate(t),s=n.createAnimator();return{scenes:i,animator:s}}const kX="3.4.15",QX="3.4.15",ZI="3.4.15",zX="https://unpkg.com/@loaders.gl/textures@".concat(ZI,"/dist/libs/basis_encoder.wasm"),HX="https://unpkg.com/@loaders.gl/textures@".concat(ZI,"/dist/libs/basis_encoder.js");let Mw;async function tF(r){const t=r.modules||{};return t.basis?t.basis:(Mw=Mw||VX(r),await Mw)}async function VX(r){let t=null,e=null;return[t,e]=await Promise.all([await Dh("basis_transcoder.js","textures",r),await Dh("basis_transcoder.wasm","textures",r)]),t=t||globalThis.BASIS,await GX(t,e)}function GX(r,t){const e={};return t&&(e.wasmBinary=t),new Promise(n=>{r(e).then(i=>{const{BasisFile:s,initializeBasis:a}=i;a(),n({BasisFile:s})})})}let Uw;async function eF(r){const t=r.modules||{};return t.basisEncoder?t.basisEncoder:(Uw=Uw||jX(r),await Uw)}async function jX(r){let t=null,e=null;return[t,e]=await Promise.all([await Dh(HX,"textures",r),await Dh(zX,"textures",r)]),t=t||globalThis.BASIS,await qX(t,e)}function qX(r,t){const e={};return t&&(e.wasmBinary=t),new Promise(n=>{r(e).then(i=>{const{BasisFile:s,KTX2File:a,initializeBasis:o,BasisEncoder:d}=i;o(),n({BasisFile:s,KTX2File:a,BasisEncoder:d})})})}const bf={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919},KX=["","WEBKIT_","MOZ_"],rF={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let gy=null;function $X(r){if(!gy){r=r||WX()||void 0,gy=new Set;for(const t of KX)for(const e in rF)if(r&&r.getExtension("".concat(t).concat(e))){const n=rF[e];gy.add(n)}}return gy}function WX(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}var nF,iF,sF,oF,aF,lF,cF,uF;(function(r){r[r.NONE=0]="NONE",r[r.BASISLZ=1]="BASISLZ",r[r.ZSTD=2]="ZSTD",r[r.ZLIB=3]="ZLIB"})(nF||(nF={})),function(r){r[r.BASICFORMAT=0]="BASICFORMAT"}(iF||(iF={})),function(r){r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.ETC1S=163]="ETC1S",r[r.UASTC=166]="UASTC"}(sF||(sF={})),function(r){r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.SRGB=1]="SRGB"}(oF||(oF={})),function(r){r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.LINEAR=1]="LINEAR",r[r.SRGB=2]="SRGB",r[r.ITU=3]="ITU",r[r.NTSC=4]="NTSC",r[r.SLOG=5]="SLOG",r[r.SLOG2=6]="SLOG2"}(aF||(aF={})),function(r){r[r.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",r[r.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(lF||(lF={})),function(r){r[r.RGB=0]="RGB",r[r.RRR=3]="RRR",r[r.GGG=4]="GGG",r[r.AAA=15]="AAA"}(cF||(cF={})),function(r){r[r.RGB=0]="RGB",r[r.RGBA=3]="RGBA",r[r.RRR=4]="RRR",r[r.RRRG=5]="RRRG"}(uF||(uF={}));const Fa=[171,75,84,88,32,50,48,187,13,10,26,10];function XX(r){const t=new Uint8Array(r);return!(t.byteLength<Fa.length||t[0]!==Fa[0]||t[1]!==Fa[1]||t[2]!==Fa[2]||t[3]!==Fa[3]||t[4]!==Fa[4]||t[5]!==Fa[5]||t[6]!==Fa[6]||t[7]!==Fa[7]||t[8]!==Fa[8]||t[9]!==Fa[9]||t[10]!==Fa[10]||t[11]!==Fa[11])}const JX={etc1:{basisFormat:0,compressed:!0,format:bf.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:bf.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:bf.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:bf.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:bf.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:bf.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function YX(r,t){if(t.basis.containerFormat==="auto"){if(XX(r)){const n=await eF(t);return AF(n.KTX2File,r,t)}const{BasisFile:e}=await tF(t);return Rw(e,r,t)}switch(t.basis.module){case"encoder":const e=await eF(t);switch(t.basis.containerFormat){case"ktx2":return AF(e.KTX2File,r,t);case"basis":default:return Rw(e.BasisFile,r,t)}case"transcoder":default:const{BasisFile:n}=await tF(t);return Rw(n,r,t)}}function Rw(r,t,e){const n=new r(new Uint8Array(t));try{if(!n.startTranscoding())throw new Error("Failed to start basis transcoding");const i=n.getNumImages(),s=[];for(let a=0;a<i;a++){const o=n.getNumLevels(a),d=[];for(let p=0;p<o;p++)d.push(ZX(n,a,p,e));s.push(d)}return s}finally{n.close(),n.delete()}}function ZX(r,t,e,n){const i=r.getImageWidth(t,e),s=r.getImageHeight(t,e),a=r.getHasAlpha(),{compressed:o,format:d,basisFormat:p}=hF(n,a),y=r.getImageTranscodedSizeInBytes(t,e,p),b=new Uint8Array(y);if(!r.transcodeImage(b,t,e,p,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:s,data:b,compressed:o,format:d,hasAlpha:a}}function AF(r,t,e){const n=new r(new Uint8Array(t));try{if(!n.startTranscoding())throw new Error("failed to start KTX2 transcoding");const i=n.getLevels(),s=[];for(let a=0;a<i;a++){s.push(tJ(n,a,e));break}return[s]}finally{n.close(),n.delete()}}function tJ(r,t,e){const{alphaFlag:n,height:i,width:s}=r.getImageLevelInfo(t,0,0),{compressed:a,format:o,basisFormat:d}=hF(e,n),p=r.getImageTranscodedSizeInBytes(t,0,0,d),y=new Uint8Array(p);if(!r.transcodeImage(y,t,0,0,d,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:s,height:i,data:y,compressed:a,levelSize:p,hasAlpha:n,format:o}}function hF(r,t){let e=r&&r.basis&&r.basis.format;return e==="auto"&&(e=dF()),typeof e=="object"&&(e=t?e.alpha:e.noAlpha),e=e.toLowerCase(),JX[e]}function dF(){const r=$X();return r.has("astc")?"astc-4x4":r.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:r.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:r.has("etc1")?"etc1":r.has("etc2")?"etc2":"rgb565"}const eJ={...{name:"Basis",id:Fu?"basis":"basis-nodejs",module:"textures",version:QX,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},parse:YX};function La(r,t){if(!r)throw new Error(t||"assert failed: gltf")}function fF(r,t){if(r.startsWith("data:")||r.startsWith("http:")||r.startsWith("https:"))return r;const n=t.baseUri||t.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url ".concat(r));return n.substr(0,n.lastIndexOf("/")+1)+r}function rJ(r,t,e){const n=r.bufferViews[e];La(n);const i=n.buffer,s=t[i];La(s);const a=(n.byteOffset||0)+s.byteOffset;return new Uint8Array(s.arrayBuffer,a,n.byteLength)}const pF=["SCALAR","VEC2","VEC3","VEC4"],nJ=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],iJ=new Map(nJ),sJ={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},oJ={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},aJ={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function gF(r){return pF[r-1]||pF[0]}function mF(r){const t=iJ.get(r.constructor);if(!t)throw new Error("Illegal typed array");return t}function Ow(r,t){const e=aJ[r.componentType],n=sJ[r.type],i=oJ[r.componentType],s=r.count*n,a=r.count*n*i;return La(a>=0&&a<=t.byteLength),{ArrayType:e,length:s,byteLength:a}}function yF(r){let{images:t,bufferViews:e}=r;t=t||[],e=e||[];const n=t.map(a=>a.bufferView);e=e.filter(a=>!n.includes(a));const i=e.reduce((a,o)=>a+o.byteLength,0),s=t.reduce((a,o)=>{const{width:d,height:p}=o.image;return a+d*p},0);return i+Math.ceil(4*s*1.33)}const lJ={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class na{constructor(t){j(this,"gltf",void 0),j(this,"sourceBuffers",void 0),j(this,"byteLength",void 0),this.gltf=t||{json:{...lJ},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(t){return this.json[t]}getExtraData(t){return(this.json.extras||{})[t]}getExtension(t){const e=this.getUsedExtensions().find(i=>i===t),n=this.json.extensions||{};return e?n[t]||!0:null}getRequiredExtension(t){return this.getRequiredExtensions().find(n=>n===t)?this.getExtension(t):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(t,e){return(t.extensions||{})[e]}getScene(t){return this.getObject("scenes",t)}getNode(t){return this.getObject("nodes",t)}getSkin(t){return this.getObject("skins",t)}getMesh(t){return this.getObject("meshes",t)}getMaterial(t){return this.getObject("materials",t)}getAccessor(t){return this.getObject("accessors",t)}getTexture(t){return this.getObject("textures",t)}getSampler(t){return this.getObject("samplers",t)}getImage(t){return this.getObject("images",t)}getBufferView(t){return this.getObject("bufferViews",t)}getBuffer(t){return this.getObject("buffers",t)}getObject(t,e){if(typeof e=="object")return e;const n=this.json[t]&&this.json[t][e];if(!n)throw new Error("glTF file error: Could not find ".concat(t,"[").concat(e,"]"));return n}getTypedArrayForBufferView(t){t=this.getBufferView(t);const e=t.buffer,n=this.gltf.buffers[e];La(n);const i=(t.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,i,t.byteLength)}getTypedArrayForAccessor(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),i=this.getBuffer(e.buffer).data,{ArrayType:s,length:a}=Ow(t,e),o=e.byteOffset+t.byteOffset;return new s(i,o,a)}getTypedArrayForImageData(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),i=this.getBuffer(e.buffer).data,s=e.byteOffset||0;return new Uint8Array(i,s,e.byteLength)}addApplicationData(t,e){return this.json[t]=e,this}addExtraData(t,e){return this.json.extras=this.json.extras||{},this.json.extras[t]=e,this}addObjectExtension(t,e,n){return t.extensions=t.extensions||{},t.extensions[e]=n,this.registerUsedExtension(e),this}setObjectExtension(t,e,n){const i=t.extensions||{};i[e]=n}removeObjectExtension(t,e){const n=t.extensions||{},i=n[e];return delete n[e],i}addExtension(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return La(e),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=e,this.registerUsedExtension(t),e}addRequiredExtension(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return La(e),this.addExtension(t,e),this.registerRequiredExtension(t),e}registerUsedExtension(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(e=>e===t)||this.json.extensionsUsed.push(t)}registerRequiredExtension(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(e=>e===t)||this.json.extensionsRequired.push(t)}removeExtension(t){if(!this.getExtension(t))return;this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t),this.json.extensions&&delete this.json.extensions[t],Array.isArray(this.json.extensionsRemoved)||(this.json.extensionsRemoved=[]);const e=this.json.extensionsRemoved;e.includes(t)||e.push(t)}setDefaultScene(t){this.json.scene=t}addScene(t){const{nodeIndices:e}=t;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:e}),this.json.scenes.length-1}addNode(t){const{meshIndex:e,matrix:n}=t;this.json.nodes=this.json.nodes||[];const i={mesh:e};return n&&(i.matrix=n),this.json.nodes.push(i),this.json.nodes.length-1}addMesh(t){const{attributes:e,indices:n,material:i,mode:s=4}=t,o={primitives:[{attributes:this._addAttributes(e),mode:s}]};if(n){const d=this._addIndices(n);o.primitives[0].indices=d}return Number.isFinite(i)&&(o.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(o),this.json.meshes.length-1}addPointCloud(t){const n={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(n),this.json.meshes.length-1}addImage(t,e){const n=$v(t),i=e||(n==null?void 0:n.mimeType),a={bufferView:this.addBufferView(t),mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(a),this.json.images.length-1}addBufferView(t){const e=t.byteLength;La(Number.isFinite(e)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);const n={buffer:0,byteOffset:this.byteLength,byteLength:e};return this.byteLength+=qp(e,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1}addAccessor(t,e){const n={bufferView:t,type:gF(e.size),componentType:e.componentType,count:e.count,max:e.max,min:e.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}addBinaryBuffer(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{size:3};const n=this.addBufferView(t);let i={min:e.min,max:e.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(t,e.size));const s={size:e.size,componentType:mF(t),count:Math.round(t.length/e.size),min:i.min,max:i.max};return this.addAccessor(n,Object.assign(s,e))}addTexture(t){const{imageIndex:e}=t,n={source:e};return this.json.textures=this.json.textures||[],this.json.textures.push(n),this.json.textures.length-1}addMaterial(t){return this.json.materials=this.json.materials||[],this.json.materials.push(t),this.json.materials.length-1}createBinaryChunk(){var t,e;this.gltf.buffers=[];const n=this.byteLength,i=new ArrayBuffer(n),s=new Uint8Array(i);let a=0;for(const o of this.sourceBuffers||[])a=K8(o,s,a);(t=this.json)!==null&&t!==void 0&&(e=t.buffers)!==null&&e!==void 0&&e[0]?this.json.buffers[0].byteLength=n:this.json.buffers=[{byteLength:n}],this.gltf.binary=i,this.sourceBuffers=[i]}_removeStringFromArray(t,e){let n=!0;for(;n;){const i=t.indexOf(e);i>-1?t.splice(i,1):n=!1}}_addAttributes(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e={};for(const n in t){const i=t[n],s=this._getGltfAttributeName(n),a=this.addBinaryBuffer(i.value,i);e[s]=a}return e}_addIndices(t){return this.addBinaryBuffer(t,{size:1})}_getGltfAttributeName(t){switch(t.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return t}}_getAccessorMinMax(t,e){const n={min:null,max:null};if(t.length<e)return n;n.min=[],n.max=[];const i=t.subarray(0,e);for(const s of i)n.min.push(s),n.max.push(s);for(let s=e;s<t.length;s+=e)for(let a=0;a<e;a++)n.min[0+a]=Math.min(n.min[0+a],t[s+a]),n.max[0+a]=Math.max(n.max[0+a],t[s+a]);return n}}const cJ="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",uJ="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",AJ=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),hJ=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),dJ={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},fJ={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function pJ(r,t,e,n,i){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"NONE";const a=await gJ();_J(a,a.exports[fJ[i]],r,t,e,n,a.exports[dJ[s||"NONE"]])}let Dw;async function gJ(){return Dw||(Dw=mJ()),Dw}async function mJ(){let r=cJ;WebAssembly.validate(AJ)&&(r=uJ,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const t=await WebAssembly.instantiate(yJ(r),{});return await t.instance.exports.__wasm_call_ctors(),t.instance}function yJ(r){const t=new Uint8Array(r.length);for(let n=0;n<r.length;++n){const i=r.charCodeAt(n);t[n]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let e=0;for(let n=0;n<r.length;++n)t[e++]=t[n]<60?hJ[t[n]]:(t[n]-60)*64+t[++n];return t.buffer.slice(0,e)}function _J(r,t,e,n,i,s,a){const o=r.exports.sbrk,d=n+3&-4,p=o(d*i),y=o(s.length),b=new Uint8Array(r.exports.memory.buffer);b.set(s,y);const x=t(p,n,i,y,s.length);if(x===0&&a&&a(p,d,i),e.set(b.subarray(p,p+n*i)),o(p-o(0)),x!==0)throw new Error("Malformed buffer data: ".concat(x))}const Nw="EXT_meshopt_compression",vJ=Nw;async function bJ(r,t){var e;const n=new na(r);if(!(t!=null&&(e=t.gltf)!==null&&e!==void 0&&e.decompressMeshes))return;const i=[];for(const s of r.json.bufferViews||[])i.push(wJ(n,s));await Promise.all(i),n.removeExtension(Nw)}async function wJ(r,t){const e=r.getObjectExtension(t,Nw);if(e){const{byteOffset:n=0,byteLength:i=0,byteStride:s,count:a,mode:o,filter:d="NONE",buffer:p}=e,y=r.gltf.buffers[p],b=new Uint8Array(y.arrayBuffer,y.byteOffset+n,i),x=new Uint8Array(r.gltf.buffers[t.buffer].arrayBuffer,t.byteOffset,t.byteLength);return await pJ(x,a,s,b,o,d),x}return null}const xJ=Object.freeze(Object.defineProperty({__proto__:null,decode:bJ,name:vJ},Symbol.toStringTag,{value:"Module"})),wf="EXT_texture_webp",BJ=wf;function CJ(r,t){const e=new na(r);if(!Qz("image/webp")){if(e.getRequiredExtensions().includes(wf))throw new Error("gltf: Required extension ".concat(wf," not supported by browser"));return}const{json:n}=e;for(const i of n.textures||[]){const s=e.getObjectExtension(i,wf);s&&(i.source=s.source),e.removeObjectExtension(i,wf)}e.removeExtension(wf)}const EJ=Object.freeze(Object.defineProperty({__proto__:null,name:BJ,preprocess:CJ},Symbol.toStringTag,{value:"Module"})),my="KHR_texture_basisu",SJ=my;function TJ(r,t){const e=new na(r),{json:n}=e;for(const i of n.textures||[]){const s=e.getObjectExtension(i,my);s&&(i.source=s.source),e.removeObjectExtension(i,my)}e.removeExtension(my)}const IJ=Object.freeze(Object.defineProperty({__proto__:null,name:SJ,preprocess:TJ},Symbol.toStringTag,{value:"Module"})),FJ={name:"Draco",id:Fu?"draco":"draco-nodejs",module:"draco",shapes:["mesh"],version:"3.4.15",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};function LJ(r,t,e){const n=vF(t.metadata),i=[],s=PJ(t.attributes);for(const a in r){const o=r[a],d=_F(a,o,s[a]);i.push(d)}if(e){const a=_F("indices",e);i.push(a)}return new yf(i,n)}function PJ(r){const t={};for(const e in r){const n=r[e];t[n.name||"undefined"]=n}return t}function _F(r,t,e){const n=e?vF(e.metadata):void 0;return yX(r,t,n)}function vF(r){const t=new Map;for(const e in r)t.set("".concat(e,".string"),JSON.stringify(r[e]));return t}const bF={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},MJ={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},UJ=4;class RJ{constructor(t){j(this,"draco",void 0),j(this,"decoder",void 0),j(this,"metadataQuerier",void 0),this.draco=t,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=new this.draco.DecoderBuffer;n.Init(new Int8Array(t),t.byteLength),this._disableAttributeTransforms(e);const i=this.decoder.GetEncodedGeometryType(n),s=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let a;switch(i){case this.draco.TRIANGULAR_MESH:a=this.decoder.DecodeBufferToMesh(n,s);break;case this.draco.POINT_CLOUD:a=this.decoder.DecodeBufferToPointCloud(n,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!a.ok()||!s.ptr){const x="DRACO decompression failed: ".concat(a.error_msg());throw new Error(x)}const o=this._getDracoLoaderData(s,i,e),d=this._getMeshData(s,o,e),p=zI(d.attributes),y=LJ(d.attributes,o,d.indices);return{loader:"draco",loaderData:o,header:{vertexCount:s.num_points(),boundingBox:p},...d,schema:y}}finally{this.draco.destroy(n),s&&this.draco.destroy(s)}}_getDracoLoaderData(t,e,n){const i=this._getTopLevelMetadata(t),s=this._getDracoAttributes(t,n);return{geometry_type:e,num_attributes:t.num_attributes(),num_points:t.num_points(),num_faces:t instanceof this.draco.Mesh?t.num_faces():0,metadata:i,attributes:s}}_getDracoAttributes(t,e){const n={};for(let i=0;i<t.num_attributes();i++){const s=this.decoder.GetAttribute(t,i),a=this._getAttributeMetadata(t,i);n[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:i,metadata:a};const o=this._getQuantizationTransform(s,e);o&&(n[s.unique_id()].quantization_transform=o);const d=this._getOctahedronTransform(s,e);d&&(n[s.unique_id()].octahedron_transform=d)}return n}_getMeshData(t,e,n){const i=this._getMeshAttributes(e,t,n);if(!i.POSITION)throw new Error("DRACO: No position attribute found.");if(t instanceof this.draco.Mesh)switch(n.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(t),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(t),size:1}}}return{topology:"point-list",mode:0,attributes:i}}_getMeshAttributes(t,e,n){const i={};for(const s of Object.values(t.attributes)){const a=this._deduceAttributeName(s,n);s.name=a;const{value:o,size:d}=this._getAttributeValues(e,s);i[a]={value:o,size:d,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return i}_getTriangleListIndices(t){const n=t.num_faces()*3,i=n*UJ,s=this.draco._malloc(i);try{return this.decoder.GetTrianglesUInt32Array(t,i,s),new Uint32Array(this.draco.HEAPF32.buffer,s,n).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(t){const e=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(t,e),NJ(e)}finally{this.draco.destroy(e)}}_getAttributeValues(t,e){const n=MJ[e.data_type],i=e.num_components,a=t.num_points()*i,o=a*n.BYTES_PER_ELEMENT,d=OJ(this.draco,n);let p;const y=this.draco._malloc(o);try{const b=this.decoder.GetAttribute(t,e.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(t,b,d,o,y),p=new n(this.draco.HEAPF32.buffer,y,a).slice()}finally{this.draco._free(y)}return{value:p,size:i}}_deduceAttributeName(t,e){const n=t.unique_id;for(const[a,o]of Object.entries(e.extraAttributes||{}))if(o===n)return a;const i=t.attribute_type;for(const a in bF)if(this.draco[a]===i)return bF[a];const s=e.attributeNameEntry||"name";return t.metadata[s]?t.metadata[s].string:"CUSTOM_ATTRIBUTE_".concat(n)}_getTopLevelMetadata(t){const e=this.decoder.GetMetadata(t);return this._getDracoMetadata(e)}_getAttributeMetadata(t,e){const n=this.decoder.GetAttributeMetadata(t,e);return this._getDracoMetadata(n)}_getDracoMetadata(t){if(!t||!t.ptr)return{};const e={},n=this.metadataQuerier.NumEntries(t);for(let i=0;i<n;i++){const s=this.metadataQuerier.GetEntryName(t,i);e[s]=this._getDracoMetadataField(t,s)}return e}_getDracoMetadataField(t,e){const n=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(t,e,n);const i=DJ(n);return{int:this.metadataQuerier.GetIntEntry(t,e),string:this.metadataQuerier.GetStringEntry(t,e),double:this.metadataQuerier.GetDoubleEntry(t,e),intArray:i}}finally{this.draco.destroy(n)}}_disableAttributeTransforms(t){const{quantizedAttributes:e=[],octahedronAttributes:n=[]}=t,i=[...e,...n];for(const s of i)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(t,e){const{quantizedAttributes:n=[]}=e,i=t.attribute_type();if(n.map(a=>this.decoder[a]).includes(i)){const a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(t))return{quantization_bits:a.quantization_bits(),range:a.range(),min_values:new Float32Array([1,2,3]).map(o=>a.min_value(o))}}finally{this.draco.destroy(a)}}return null}_getOctahedronTransform(t,e){const{octahedronAttributes:n=[]}=e,i=t.attribute_type();if(n.map(a=>this.decoder[a]).includes(i)){const a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(t))return{quantization_bits:a.quantization_bits()}}finally{this.draco.destroy(a)}}return null}}function OJ(r,t){switch(t){case Float32Array:return r.DT_FLOAT32;case Int8Array:return r.DT_INT8;case Int16Array:return r.DT_INT16;case Int32Array:return r.DT_INT32;case Uint8Array:return r.DT_UINT8;case Uint16Array:return r.DT_UINT16;case Uint32Array:return r.DT_UINT32;default:return r.DT_INVALID}}function DJ(r){const t=r.size(),e=new Int32Array(t);for(let n=0;n<t;n++)e[n]=r.GetValue(n);return e}function NJ(r){const t=r.size(),e=new Int32Array(t);for(let n=0;n<t;n++)e[n]=r.GetValue(n);return e}const kw="https://www.gstatic.com/draco/versioned/decoders/".concat("1.5.5"),kJ="".concat(kw,"/draco_decoder.js"),QJ="".concat(kw,"/draco_wasm_wrapper.js"),zJ="".concat(kw,"/draco_decoder.wasm");let Fg;async function HJ(r){const t=r.modules||{};return t.draco3d?Fg=Fg||t.draco3d.createDecoderModule({}).then(e=>({draco:e})):Fg=Fg||VJ(r),await Fg}async function VJ(r){let t,e;switch(r.draco&&r.draco.decoderType){case"js":t=await Dh(kJ,"draco",r);break;case"wasm":default:[t,e]=await Promise.all([await Dh(QJ,"draco",r),await Dh(zJ,"draco",r)])}return t=t||globalThis.DracoDecoderModule,await GJ(t,e)}function GJ(r,t){const e={};return t&&(e.wasmBinary=t),new Promise(n=>{r({...e,onModuleLoaded:i=>n({draco:i})})})}const wF={...FJ,parse:jJ};async function jJ(r,t){const{draco:e}=await HJ(t),n=new RJ(e);try{return n.parseSync(r,t==null?void 0:t.draco)}finally{n.destroy()}}function qJ(r){const t={};for(const e in r){const n=r[e];if(e!=="indices"){const i=xF(n);t[e]=i}}return t}function xF(r){const{buffer:t,size:e,count:n}=KJ(r);return{value:t,size:e,byteOffset:0,count:n,type:gF(e),componentType:mF(t)}}function KJ(r){let t=r,e=1,n=0;return r&&r.value&&(t=r.value,e=r.size||1),t&&(ArrayBuffer.isView(t)||(t=$J(t,Float32Array)),n=t.length/e),{buffer:t,size:e,count:n}}function $J(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return r?Array.isArray(r)?new t(r):e&&!(r instanceof t)?new t(r):r:null}const Wh="KHR_draco_mesh_compression",WJ=Wh;function XJ(r,t,e){const n=new na(r);for(const i of BF(n))n.getObjectExtension(i,Wh)}async function JJ(r,t,e){var n;if(!(t!=null&&(n=t.gltf)!==null&&n!==void 0&&n.decompressMeshes))return;const i=new na(r),s=[];for(const a of BF(i))i.getObjectExtension(a,Wh)&&s.push(ZJ(i,a,t,e));await Promise.all(s),i.removeExtension(Wh)}function YJ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e=new na(r);for(const n of e.json.meshes||[])tY(n,t),e.addRequiredExtension(Wh)}async function ZJ(r,t,e,n){const i=r.getObjectExtension(t,Wh);if(!i)return;const s=r.getTypedArrayForBufferView(i.bufferView),a=Mv(s.buffer,s.byteOffset),{parse:o}=n,d={...e};delete d["3d-tiles"];const p=await o(a,wF,d,n),y=qJ(p.attributes);for(const[b,x]of Object.entries(y))if(b in t.attributes){const C=t.attributes[b],P=r.getAccessor(C);P!=null&&P.min&&P!==null&&P!==void 0&&P.max&&(x.min=P.min,x.max=P.max)}t.attributes=y,p.indices&&(t.indices=xF(p.indices)),eY(t)}function tY(r,t){var e;let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:4,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const a=i.DracoWriter.encodeSync({attributes:r}),o=s==null||(e=s.parseSync)===null||e===void 0?void 0:e.call(s,{attributes:r}),d=i._addFauxAttributes(o.attributes),p=i.addBufferView(a);return{primitives:[{attributes:d,mode:n,extensions:{[Wh]:{bufferView:p,attributes:d}}}]}}function eY(r){if(!r.attributes&&Object.keys(r.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*BF(r){for(const t of r.json.meshes||[])for(const e of t.primitives)yield e}const rY=Object.freeze(Object.defineProperty({__proto__:null,decode:JJ,encode:YJ,name:WJ,preprocess:XJ},Symbol.toStringTag,{value:"Module"})),nY={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},iY={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Qw="KHR_texture_transform",sY=Qw,yy=new se,oY=new Di,aY=new Di;async function lY(r,t){if(!new na(r).getExtension(Qw))return;const i=r.json.materials||[];for(let s=0;s<i.length;s++)cY(s,r)}function cY(r,t){var e,n,i;const s=[],a=(e=t.json.materials)===null||e===void 0?void 0:e[r],o=a==null||(n=a.pbrMetallicRoughness)===null||n===void 0?void 0:n.baseColorTexture;o&&Lg(t,r,o,s);const d=a==null?void 0:a.emissiveTexture;d&&Lg(t,r,d,s);const p=a==null?void 0:a.normalTexture;p&&Lg(t,r,p,s);const y=a==null?void 0:a.occlusionTexture;y&&Lg(t,r,y,s);const b=a==null||(i=a.pbrMetallicRoughness)===null||i===void 0?void 0:i.metallicRoughnessTexture;b&&Lg(t,r,b,s)}function Lg(r,t,e,n){const i=uY(e,n);if(!i)return;const s=r.json.meshes||[];for(const a of s)for(const o of a.primitives){const d=o.material;Number.isFinite(d)&&t===d&&AY(r,o,i)}}function uY(r,t){var e;const n=(e=r.extensions)===null||e===void 0?void 0:e[Qw],{texCoord:i=0}=r,{texCoord:s=i}=n;if(!(t.findIndex(o=>{let[d,p]=o;return d===i&&p===s})!==-1)){const o=fY(n);return i!==s&&(r.texCoord=s),t.push([i,s]),{originalTexCoord:i,texCoord:s,matrix:o}}return null}function AY(r,t,e){const{originalTexCoord:n,texCoord:i,matrix:s}=e,a=t.attributes["TEXCOORD_".concat(n)];if(Number.isFinite(a)){var o;const p=(o=r.json.accessors)===null||o===void 0?void 0:o[a];if(p&&p.bufferView){var d;const y=(d=r.json.bufferViews)===null||d===void 0?void 0:d[p.bufferView];if(y){const{arrayBuffer:b,byteOffset:x}=r.buffers[y.buffer],C=(x||0)+(p.byteOffset||0)+(y.byteOffset||0),{ArrayType:P,length:M}=Ow(p,y),k=iY[p.componentType],z=nY[p.type],V=y.byteStride||k*z,$=new Float32Array(M);for(let tt=0;tt<p.count;tt++){const pt=new P(b,C+tt*V,2);yy.set(pt[0],pt[1],1),yy.transformByMatrix3(s),$.set([yy[0],yy[1]],tt*z)}n===i?hY(p,y,r.buffers,$):dY(i,p,t,r,$)}}}}function hY(r,t,e,n){r.componentType=5126,e.push({arrayBuffer:n.buffer,byteOffset:0,byteLength:n.buffer.byteLength}),t.buffer=e.length-1,t.byteLength=n.buffer.byteLength,t.byteOffset=0,delete t.byteStride}function dY(r,t,e,n,i){n.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});const s=n.json.bufferViews;if(!s)return;s.push({buffer:n.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});const a=n.json.accessors;a&&(a.push({bufferView:(s==null?void 0:s.length)-1,byteOffset:0,componentType:5126,count:t.count,type:"VEC2"}),e.attributes["TEXCOORD_".concat(r)]=a.length-1)}function fY(r){const{offset:t=[0,0],rotation:e=0,scale:n=[1,1]}=r,i=new Di().set(1,0,0,0,1,0,t[0],t[1],1),s=oY.set(Math.cos(e),Math.sin(e),0,-Math.sin(e),Math.cos(e),0,0,0,1),a=aY.set(n[0],0,0,0,n[1],0,0,0,1);return i.multiplyRight(s).multiplyRight(a)}const pY=Object.freeze(Object.defineProperty({__proto__:null,decode:lY,name:sY},Symbol.toStringTag,{value:"Module"})),Xh="KHR_lights_punctual",gY=Xh;async function mY(r){const t=new na(r),{json:e}=t,n=t.getExtension(Xh);n&&(t.json.lights=n.lights,t.removeExtension(Xh));for(const i of e.nodes||[]){const s=t.getObjectExtension(i,Xh);s&&(i.light=s.light),t.removeObjectExtension(i,Xh)}}async function yY(r){const t=new na(r),{json:e}=t;if(e.lights){const n=t.addExtension(Xh);La(!n.lights),n.lights=e.lights,delete e.lights}if(t.json.lights){for(const n of t.json.lights){const i=n.node;t.addObjectExtension(i,Xh,n)}delete t.json.lights}}const _Y=Object.freeze(Object.defineProperty({__proto__:null,decode:mY,encode:yY,name:gY},Symbol.toStringTag,{value:"Module"})),Pg="KHR_materials_unlit",vY=Pg;async function bY(r){const t=new na(r),{json:e}=t;for(const n of e.materials||[])n.extensions&&n.extensions.KHR_materials_unlit&&(n.unlit=!0),t.removeObjectExtension(n,Pg);t.removeExtension(Pg)}function wY(r){const t=new na(r),{json:e}=t;if(t.materials)for(const n of e.materials||[])n.unlit&&(delete n.unlit,t.addObjectExtension(n,Pg,{}),t.addExtension(Pg))}const xY=Object.freeze(Object.defineProperty({__proto__:null,decode:bY,encode:wY,name:vY},Symbol.toStringTag,{value:"Module"})),Mg="KHR_techniques_webgl",BY=Mg;async function CY(r){const t=new na(r),{json:e}=t,n=t.getExtension(Mg);if(n){const i=SY(n,t);for(const s of e.materials||[]){const a=t.getObjectExtension(s,Mg);a&&(s.technique=Object.assign({},a,i[a.technique]),s.technique.values=TY(s.technique,t)),t.removeObjectExtension(s,Mg)}t.removeExtension(Mg)}}async function EY(r,t){}function SY(r,t){const{programs:e=[],shaders:n=[],techniques:i=[]}=r,s=new TextDecoder;return n.forEach(a=>{if(Number.isFinite(a.bufferView))a.code=s.decode(t.getTypedArrayForBufferView(a.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),e.forEach(a=>{a.fragmentShader=n[a.fragmentShader],a.vertexShader=n[a.vertexShader]}),i.forEach(a=>{a.program=e[a.program]}),i}function TY(r,t){const e=Object.assign({},r.values);return Object.keys(r.uniforms||{}).forEach(n=>{r.uniforms[n].value&&!(n in e)&&(e[n]=r.uniforms[n].value)}),Object.keys(e).forEach(n=>{typeof e[n]=="object"&&e[n].index!==void 0&&(e[n].texture=t.getTexture(e[n].index))}),e}const IY=Object.freeze(Object.defineProperty({__proto__:null,decode:CY,encode:EY,name:BY},Symbol.toStringTag,{value:"Module"})),CF="EXT_feature_metadata",FY=CF;async function LY(r){const t=new na(r);PY(t)}function PY(r){var t;const e=r.getExtension(CF),n=e==null||(t=e.schema)===null||t===void 0?void 0:t.classes,i=e==null?void 0:e.featureTables;if((e==null?void 0:e.featureTextures)&&console.warn('featureTextures is not yet supported in the "EXT_feature_metadata" extension.'),n&&i)for(const a in n){const o=n[a],d=RY(i,a);d&&MY(r,d,o)}}function MY(r,t,e){for(const i in e.properties){var n;const s=e.properties[i],a=t==null||(n=t.properties)===null||n===void 0?void 0:n[i],o=t.count;if(a){const d=UY(r,s,o,a);a.data=d}}}function UY(r,t,e,n){const i=n.bufferView;let s=r.getTypedArrayForBufferView(i);switch(t.type){case"STRING":{const a=n.stringOffsetBufferView,o=r.getTypedArrayForBufferView(a);s=OY(s,o,e);break}}return s}function RY(r,t){for(const e in r){const n=r[e];if(n.class===t)return n}return null}function OY(r,t,e){const n=[],i=new TextDecoder("utf8");let s=0;const a=4;for(let o=0;o<e;o++){const d=t[(o+1)*a]-t[o*a],p=r.subarray(s,d+s),y=i.decode(p);n.push(y),s+=d}return n}const EF=[xJ,EJ,IJ,rY,_Y,xY,IY,pY,Object.freeze(Object.defineProperty({__proto__:null,decode:LY,name:FY},Symbol.toStringTag,{value:"Module"}))];function DY(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0;const n=EF.filter(s=>SF(s.name,t));for(const s of n){var i;(i=s.preprocess)===null||i===void 0||i.call(s,r,t,e)}}async function NY(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0;const n=EF.filter(s=>SF(s.name,t));for(const s of n){var i;await((i=s.decode)===null||i===void 0?void 0:i.call(s,r,t,e))}}function SF(r,t){var e;const n=(t==null||(e=t.gltf)===null||e===void 0?void 0:e.excludeExtensions)||{};return!(r in n&&!n[r])}const zw="KHR_binary_glTF";function kY(r){const t=new na(r),{json:e}=t;for(const n of e.images||[]){const i=t.getObjectExtension(n,zw);i&&Object.assign(n,i),t.removeObjectExtension(n,zw)}e.buffers&&e.buffers[0]&&delete e.buffers[0].uri,t.removeExtension(zw)}const TF={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},QY={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class zY{constructor(){j(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),j(this,"json",void 0)}normalize(t,e){this.json=t.json;const n=t.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn("glTF: Unknown version ".concat(n.asset.version));return}if(!e.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),kY(t),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)}_addAsset(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(t){for(const e in TF)this._convertTopLevelObjectToArray(t,e)}_convertTopLevelObjectToArray(t,e){const n=t[e];if(!(!n||Array.isArray(n))){t[e]=[];for(const i in n){const s=n[i];s.id=s.id||i;const a=t[e].length;t[e].push(s),this.idToIndexMap[e][i]=a}}}_convertObjectIdsToArrayIndices(t){for(const e in TF)this._convertIdsToIndices(t,e);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));for(const e of t.textures)this._convertTextureIds(e);for(const e of t.meshes)this._convertMeshIds(e);for(const e of t.nodes)this._convertNodeIds(e);for(const e of t.scenes)this._convertSceneIds(e)}_convertTextureIds(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}_convertMeshIds(t){for(const e of t.primitives){const{attributes:n,indices:i,material:s}=e;for(const a in n)n[a]=this._convertIdToIndex(n[a],"accessor");i&&(e.indices=this._convertIdToIndex(i,"accessor")),s&&(e.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(t){t.children&&(t.children=t.children.map(e=>this._convertIdToIndex(e,"node"))),t.meshes&&(t.meshes=t.meshes.map(e=>this._convertIdToIndex(e,"mesh")))}_convertSceneIds(t){t.nodes&&(t.nodes=t.nodes.map(e=>this._convertIdToIndex(e,"node")))}_convertIdsToIndices(t,e){t[e]||(console.warn("gltf v1: json doesn't contain attribute ".concat(e)),t[e]=[]);for(const n of t[e])for(const i in n){const s=n[i],a=this._convertIdToIndex(s,i);n[i]=a}}_convertIdToIndex(t,e){const n=QY[e];if(n in this.idToIndexMap){const i=this.idToIndexMap[n][t];if(!Number.isFinite(i))throw new Error("gltf v1: failed to resolve ".concat(e," with id ").concat(t));return i}return t}_updateObjects(t){for(const e of this.json.buffers)delete e.type}_updateMaterial(t){for(const s of t.materials){var e,n,i;s.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const a=((e=s.values)===null||e===void 0?void 0:e.tex)||((n=s.values)===null||n===void 0?void 0:n.texture2d_0)||((i=s.values)===null||i===void 0?void 0:i.diffuseTex),o=t.textures.findIndex(d=>d.id===a);o!==-1&&(s.pbrMetallicRoughness.baseColorTexture={index:o})}}}function HY(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new zY().normalize(r,t)}const VY={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},GY={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},ll={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},jY={magFilter:ll.TEXTURE_MAG_FILTER,minFilter:ll.TEXTURE_MIN_FILTER,wrapS:ll.TEXTURE_WRAP_S,wrapT:ll.TEXTURE_WRAP_T},qY={[ll.TEXTURE_MAG_FILTER]:ll.LINEAR,[ll.TEXTURE_MIN_FILTER]:ll.NEAREST_MIPMAP_LINEAR,[ll.TEXTURE_WRAP_S]:ll.REPEAT,[ll.TEXTURE_WRAP_T]:ll.REPEAT};function KY(r){return GY[r]}function $Y(r){return VY[r]}class WY{constructor(){j(this,"baseUri",""),j(this,"json",{}),j(this,"buffers",[]),j(this,"images",[])}postProcess(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{json:n,buffers:i=[],images:s=[],baseUri:a=""}=t;return La(n),this.baseUri=a,this.json=n,this.buffers=i,this.images=s,this._resolveTree(this.json,e),this.json}_resolveTree(t){t.bufferViews&&(t.bufferViews=t.bufferViews.map((e,n)=>this._resolveBufferView(e,n))),t.images&&(t.images=t.images.map((e,n)=>this._resolveImage(e,n))),t.samplers&&(t.samplers=t.samplers.map((e,n)=>this._resolveSampler(e,n))),t.textures&&(t.textures=t.textures.map((e,n)=>this._resolveTexture(e,n))),t.accessors&&(t.accessors=t.accessors.map((e,n)=>this._resolveAccessor(e,n))),t.materials&&(t.materials=t.materials.map((e,n)=>this._resolveMaterial(e,n))),t.meshes&&(t.meshes=t.meshes.map((e,n)=>this._resolveMesh(e,n))),t.nodes&&(t.nodes=t.nodes.map((e,n)=>this._resolveNode(e,n))),t.skins&&(t.skins=t.skins.map((e,n)=>this._resolveSkin(e,n))),t.scenes&&(t.scenes=t.scenes.map((e,n)=>this._resolveScene(e,n))),t.scene!==void 0&&(t.scene=t.scenes[this.json.scene])}getScene(t){return this._get("scenes",t)}getNode(t){return this._get("nodes",t)}getSkin(t){return this._get("skins",t)}getMesh(t){return this._get("meshes",t)}getMaterial(t){return this._get("materials",t)}getAccessor(t){return this._get("accessors",t)}getCamera(t){return null}getTexture(t){return this._get("textures",t)}getSampler(t){return this._get("samplers",t)}getImage(t){return this._get("images",t)}getBufferView(t){return this._get("bufferViews",t)}getBuffer(t){return this._get("buffers",t)}_get(t,e){if(typeof e=="object")return e;const n=this.json[t]&&this.json[t][e];return n||console.warn("glTF file error: Could not find ".concat(t,"[").concat(e,"]")),n}_resolveScene(t,e){return t.id=t.id||"scene-".concat(e),t.nodes=(t.nodes||[]).map(n=>this.getNode(n)),t}_resolveNode(t,e){return t.id=t.id||"node-".concat(e),t.children&&(t.children=t.children.map(n=>this.getNode(n))),t.mesh!==void 0?t.mesh=this.getMesh(t.mesh):t.meshes!==void 0&&t.meshes.length&&(t.mesh=t.meshes.reduce((n,i)=>{const s=this.getMesh(i);return n.id=s.id,n.primitives=n.primitives.concat(s.primitives),n},{primitives:[]})),t.camera!==void 0&&(t.camera=this.getCamera(t.camera)),t.skin!==void 0&&(t.skin=this.getSkin(t.skin)),t}_resolveSkin(t,e){return t.id=t.id||"skin-".concat(e),t.inverseBindMatrices=this.getAccessor(t.inverseBindMatrices),t}_resolveMesh(t,e){return t.id=t.id||"mesh-".concat(e),t.primitives&&(t.primitives=t.primitives.map(n=>{n={...n};const i=n.attributes;n.attributes={};for(const s in i)n.attributes[s]=this.getAccessor(i[s]);return n.indices!==void 0&&(n.indices=this.getAccessor(n.indices)),n.material!==void 0&&(n.material=this.getMaterial(n.material)),n})),t}_resolveMaterial(t,e){if(t.id=t.id||"material-".concat(e),t.normalTexture&&(t.normalTexture={...t.normalTexture},t.normalTexture.texture=this.getTexture(t.normalTexture.index)),t.occlusionTexture&&(t.occlustionTexture={...t.occlustionTexture},t.occlusionTexture.texture=this.getTexture(t.occlusionTexture.index)),t.emissiveTexture&&(t.emmisiveTexture={...t.emmisiveTexture},t.emissiveTexture.texture=this.getTexture(t.emissiveTexture.index)),t.emissiveFactor||(t.emissiveFactor=t.emmisiveTexture?[1,1,1]:[0,0,0]),t.pbrMetallicRoughness){t.pbrMetallicRoughness={...t.pbrMetallicRoughness};const n=t.pbrMetallicRoughness;n.baseColorTexture&&(n.baseColorTexture={...n.baseColorTexture},n.baseColorTexture.texture=this.getTexture(n.baseColorTexture.index)),n.metallicRoughnessTexture&&(n.metallicRoughnessTexture={...n.metallicRoughnessTexture},n.metallicRoughnessTexture.texture=this.getTexture(n.metallicRoughnessTexture.index))}return t}_resolveAccessor(t,e){if(t.id=t.id||"accessor-".concat(e),t.bufferView!==void 0&&(t.bufferView=this.getBufferView(t.bufferView)),t.bytesPerComponent=KY(t.componentType),t.components=$Y(t.type),t.bytesPerElement=t.bytesPerComponent*t.components,t.bufferView){const n=t.bufferView.buffer,{ArrayType:i,byteLength:s}=Ow(t,t.bufferView),a=(t.bufferView.byteOffset||0)+(t.byteOffset||0)+n.byteOffset;let o=n.arrayBuffer.slice(a,a+s);t.bufferView.byteStride&&(o=this._getValueFromInterleavedBuffer(n,a,t.bufferView.byteStride,t.bytesPerElement,t.count)),t.value=new i(o)}return t}_getValueFromInterleavedBuffer(t,e,n,i,s){const a=new Uint8Array(s*i);for(let o=0;o<s;o++){const d=e+o*n;a.set(new Uint8Array(t.arrayBuffer.slice(d,d+i)),o*i)}return a.buffer}_resolveTexture(t,e){return t.id=t.id||"texture-".concat(e),t.sampler="sampler"in t?this.getSampler(t.sampler):qY,t.source=this.getImage(t.source),t}_resolveSampler(t,e){t.id=t.id||"sampler-".concat(e),t.parameters={};for(const n in t){const i=this._enumSamplerParameter(n);i!==void 0&&(t.parameters[i]=t[n])}return t}_enumSamplerParameter(t){return jY[t]}_resolveImage(t,e){t.id=t.id||"image-".concat(e),t.bufferView!==void 0&&(t.bufferView=this.getBufferView(t.bufferView));const n=this.images[e];return n&&(t.image=n),t}_resolveBufferView(t,e){const n=t.buffer,i={id:"bufferView-".concat(e),...t,buffer:this.buffers[n]},s=this.buffers[n].arrayBuffer;let a=this.buffers[n].byteOffset||0;return"byteOffset"in t&&(a+=t.byteOffset),i.data=new Uint8Array(s,a,t.byteLength),i}_resolveCamera(t,e){return t.id=t.id||"camera-".concat(e),t.perspective,t.orthographic,t}}function XY(r,t){return new WY().postProcess(r,t)}const IF=1735152710,Hw=12,_y=8,JY=1313821514,YY=5130562,ZY=0,tZ=1,eZ=0,xf=!0;function rZ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return"".concat(String.fromCharCode(r.getUint8(t+0))).concat(String.fromCharCode(r.getUint8(t+1))).concat(String.fromCharCode(r.getUint8(t+2))).concat(String.fromCharCode(r.getUint8(t+3)))}function nZ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=new DataView(r),{magic:i=IF}=e,s=n.getUint32(t,!1);return s===i||s===IF}function iZ(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const n=new DataView(t),i=rZ(n,e+0),s=n.getUint32(e+4,xf),a=n.getUint32(e+8,xf);switch(Object.assign(r,{header:{byteOffset:e,byteLength:a,hasBinChunk:!1},type:i,version:s,json:{},binChunks:[]}),e+=Hw,r.version){case 1:return sZ(r,n,e);case 2:return oZ(r,n,e,{});default:throw new Error("Invalid GLB version ".concat(r.version,". Only supports v1 and v2."))}}function sZ(r,t,e){ui(r.header.byteLength>Hw+_y);const n=t.getUint32(e+0,xf),i=t.getUint32(e+4,xf);return e+=_y,ui(i===eZ),Vw(r,t,e,n),e+=n,e+=Gw(r,t,e,r.header.byteLength),e}function oZ(r,t,e,n){return ui(r.header.byteLength>Hw+_y),aZ(r,t,e,n),e+r.header.byteLength}function aZ(r,t,e,n){for(;e+8<=r.header.byteLength;){const i=t.getUint32(e+0,xf),s=t.getUint32(e+4,xf);switch(e+=_y,s){case JY:Vw(r,t,e,i);break;case YY:Gw(r,t,e,i);break;case ZY:n.strict||Vw(r,t,e,i);break;case tZ:n.strict||Gw(r,t,e,i);break}e+=qp(i,4)}return e}function Vw(r,t,e,n){const i=new Uint8Array(t.buffer,e,n),a=new TextDecoder("utf8").decode(i);return r.json=JSON.parse(a),qp(n,4)}function Gw(r,t,e,n){return r.header.hasBinChunk=!0,r.binChunks.push({byteOffset:e,byteLength:n,arrayBuffer:t.buffer}),qp(n,4)}async function lZ(r,t){var e,n,i,s;let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3?arguments[3]:void 0,d=arguments.length>4?arguments[4]:void 0;cZ(r,t,a,o),HY(r,{normalize:o==null||(e=o.gltf)===null||e===void 0?void 0:e.normalize}),DY(r,o,d);const p=[];if(o!=null&&(n=o.gltf)!==null&&n!==void 0&&n.loadBuffers&&r.json.buffers&&await uZ(r,o,d),o!=null&&(i=o.gltf)!==null&&i!==void 0&&i.loadImages){const b=AZ(r,o,d);p.push(b)}const y=NY(r,o,d);return p.push(y),await Promise.all(p),o!=null&&(s=o.gltf)!==null&&s!==void 0&&s.postProcess?XY(r,o):r}function cZ(r,t,e,n){if(n.uri&&(r.baseUri=n.uri),t instanceof ArrayBuffer&&!nZ(t,e,n)&&(t=new TextDecoder().decode(t)),typeof t=="string")r.json=G8(t);else if(t instanceof ArrayBuffer){const a={};e=iZ(a,t,e,n.glb),La(a.type==="glTF","Invalid GLB magic string ".concat(a.type)),r._glb=a,r.json=a.json}else La(!1,"GLTF: must be ArrayBuffer or string");const i=r.json.buffers||[];if(r.buffers=new Array(i.length).fill(null),r._glb&&r._glb.header.hasBinChunk){const{binChunks:a}=r._glb;r.buffers[0]={arrayBuffer:a[0].arrayBuffer,byteOffset:a[0].byteOffset,byteLength:a[0].byteLength}}const s=r.json.images||[];r.images=new Array(s.length).fill({})}async function uZ(r,t,e){const n=r.json.buffers||[];for(let a=0;a<n.length;++a){const o=n[a];if(o.uri){var i,s;const{fetch:d}=e;La(d);const p=fF(o.uri,t),y=await(e==null||(i=e.fetch)===null||i===void 0?void 0:i.call(e,p)),b=await(y==null||(s=y.arrayBuffer)===null||s===void 0?void 0:s.call(y));r.buffers[a]={arrayBuffer:b,byteOffset:0,byteLength:b.byteLength},delete o.uri}else r.buffers[a]===null&&(r.buffers[a]={arrayBuffer:new ArrayBuffer(o.byteLength),byteOffset:0,byteLength:o.byteLength})}}async function AZ(r,t,e){const n=hZ(r),i=r.json.images||[],s=[];for(const a of n)s.push(dZ(r,i[a],a,t,e));return await Promise.all(s)}function hZ(r){const t=new Set,e=r.json.textures||[];for(const n of e)n.source!==void 0&&t.add(n.source);return Array.from(t).sort()}async function dZ(r,t,e,n,i){const{fetch:s,parse:a}=i;let o;if(t.uri&&!t.hasOwnProperty("bufferView")){const p=fF(t.uri,n);o=await(await s(p)).arrayBuffer(),t.bufferView={data:o}}if(Number.isFinite(t.bufferView)){const p=rJ(r.json,r.buffers,t.bufferView);o=Mv(p.buffer,p.byteOffset,p.byteLength)}La(o,"glTF image has no data");let d=await a(o,[CT,eJ],{mimeType:t.mimeType,basis:n.basis||{format:dF()}},i);d&&d[0]&&(d={compressed:!0,mipmaps:!1,width:d[0].width,height:d[0].height,data:d[0]}),r.images=r.images||[],r.images[e]=d}const Ug={name:"glTF",id:"gltf",module:"gltf",version:kX,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:fZ,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};async function fZ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0;t={...Ug.options,...t},t.gltf={...Ug.options.gltf,...t.gltf};const{byteOffset:n=0}=t;return await lZ({},r,n,t,e)}async function pZ(r){const t=[];return r.scenes.forEach(e=>{e.traverse(n=>{Object.values(n.model.getUniforms()).forEach(i=>{i.loaded===!1&&t.push(i)})})}),await gZ(()=>t.some(e=>!e.loaded))}async function gZ(r){for(;r();)await new Promise(t=>requestAnimationFrame(t))}const mZ=`#version 300 es
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform mat4 sceneModelMatrix;
uniform bool composeModelMatrix;
in vec4 POSITION;

#ifdef HAS_UV
  in vec2 TEXCOORD_0;
#endif

#ifdef MODULE_PBR
  #ifdef HAS_NORMALS
    in vec4 NORMAL;
  #endif
#endif
out vec4 vColor;
#ifndef MODULE_PBR
  #ifdef HAS_UV
    out vec2 vTEXCOORD_0;
  #endif
#endif
void main(void) {
  #if defined(HAS_UV) && !defined(MODULE_PBR)
    vTEXCOORD_0 = TEXCOORD_0;
    geometry.uv = vTEXCOORD_0;
  #endif

  geometry.worldPosition = instancePositions;
  geometry.pickingColor = instancePickingColors;

  vec3 normal = vec3(0.0, 0.0, 1.0);
  #ifdef MODULE_PBR
    #ifdef HAS_NORMALS
      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;
    #endif
  #endif

  float originalSize = project_size_to_pixel(sizeScale);
  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);

  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;
  if(composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    geometry.normal = project_normal(normal);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);
    geometry.normal = project_normal(normal);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = TEXCOORD_0;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,yZ=`#version 300 es
uniform float opacity;
in vec4 vColor;

out vec4 fragmentColor;
#ifndef MODULE_PBR
  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
    in vec2 vTEXCOORD_0;
    uniform sampler2D u_BaseColorSampler;
  #endif
#endif

void main(void) {
  #ifdef MODULE_PBR
    fragmentColor = vColor * pbr_filterColor(vec4(0));
    geometry.uv = pbr_vUV;
  #else
    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);
      geometry.uv = vTEXCOORD_0;
    #else
      fragmentColor = vColor;
    #endif
  #endif

  fragmentColor.a *= opacity;
  DECKGL_FILTER_COLOR(fragmentColor, geometry);
}
`,FF=[255,255,255,255],_Z={scenegraph:{type:"object",value:null,async:!0},getScene:r=>r&&r.scenes?typeof r.scene=="object"?r.scene:r.scenes[r.scene||0]:r,getAnimator:r=>r&&r.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:r=>r.position},getColor:{type:"accessor",value:FF},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[Ug]};class jw extends mf{constructor(){super(...arguments),j(this,"state",void 0)}getShaders(){const t=[rw,nw];return this.props._lighting==="pbr"&&t.push(Hb),super.getShaders({vs:mZ,fs:yZ,modules:t})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:FF,transition:!0},instanceModelMatrix:kI})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;e.scenegraph!==n.scenegraph?this._updateScenegraph():e._animations!==n._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,e._animations)}finalizeState(t){super.finalizeState(t),this._deleteScenegraph()}get isLoaded(){var t;return((t=this.state)===null||t===void 0?void 0:t.scenegraph)&&super.isLoaded}_updateScenegraph(){const t=this.props,{gl:e}=this.context;let n=null;if(t.scenegraph instanceof vf)n={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const o=t.scenegraph,d=NX(e,o,this._getModelOptions());n={gltf:o,...d},pZ(d).then(()=>this.setNeedsRedraw())}else t.scenegraph&&(Tn.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),n=t.scenegraph);const i={layer:this,gl:e},s=t.getScene(n,i),a=t.getAnimator(n,i);s instanceof vf?(this._deleteScenegraph(),this._applyAllAttributes(s),this._applyAnimationsProp(s,a,t._animations),this.setState({scenegraph:s,animator:a})):s!==null&&Tn.warn("invalid scenegraph:",s)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const e=this.getAttributeManager().getAttributes();t.traverse(n=>{this._setModelAttributes(n.model,e)})}}_applyAnimationsProp(t,e,n){if(!t||!e||!n)return;const i=e.getAnimations();Object.keys(n).sort().forEach(s=>{const a=n[s];if(s==="*")i.forEach(o=>{Object.assign(o,a)});else if(Number.isFinite(Number(s))){const o=Number(s);o>=0&&o<i.length?Object.assign(i[o],a):Tn.warn("animation ".concat(s," not found"))()}else{const o=i.find(d=>{let{name:p}=d;return p===s});o?Object.assign(o,a):Tn.warn("animation ".concat(s," not found"))()}})}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof vf&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let e=null;return t&&(typeof t=="function"?e=t({gl:this.context.gl,layer:this}):e=t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:e,modelOptions:{isInstanced:!0,transpileToGLSL100:!fn(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(e=>{this._setModelAttributes(e.model,t)})}draw(t){let{moduleParameters:e=null,parameters:n={},context:i}=t;if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(i.timeline.getTime()),this.setNeedsRedraw());const{viewport:s}=this.context,{sizeScale:a,sizeMinPixels:o,sizeMaxPixels:d,opacity:p,coordinateSystem:y}=this.props,b=this.getNumInstances();this.state.scenegraph.traverse((x,C)=>{let{worldMatrix:P}=C;x.model.setInstanceCount(b),x.updateModuleSettings(e),x.draw({parameters:n,uniforms:{sizeScale:a,opacity:p,sizeMinPixels:o,sizeMaxPixels:d,composeModelMatrix:QI(s,y),sceneModelMatrix:P,u_Camera:x.model.getUniforms().project_uCameraPosition}})})}}j(jw,"defaultProps",_Z),j(jw,"layerName","ScenegraphLayer");const vZ=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
uniform bool pickFeatureIds;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec4 uvRegions;
in vec3 featureIdsPickingColors;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

vec2 applyUVRegion(vec2 uv) {
  #ifdef HAS_UV_REGIONS
    return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;
  #else
    return uv;
  #endif
}

void main(void) {
  vec2 uv = applyUVRegion(texCoords);
  geometry.uv = uv;

  if (pickFeatureIds) {
    geometry.pickingColor = featureIdsPickingColors;
  } else {
    geometry.pickingColor = instancePickingColors;
  }

  vTexCoord = uv;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale;
  vec3 projectedPosition = project_position(positions);
  position_commonspace = vec4(projectedPosition, 1.0);
  gl_Position = project_common_position_to_clipspace(position_commonspace);

  geometry.position = position_commonspace;
  normals_commonspace = project_normal(instanceModelMatrix * normals);
  geometry.normal = normals_commonspace;

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = uv;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,bZ=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  
#ifdef MODULE_PBR

  fragColor = vColor * pbr_filterColor(vec4(0));
  geometry.uv = pbr_vUV;
  fragColor.a *= opacity;

#else

  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);

#endif

  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function wZ(r){r.COLOR_0||r.colors||(r.colors={constant:!0,value:new Float32Array([1,1,1])})}const xZ={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}};class qw extends Lw{getShaders(){const t=super.getShaders();return t.modules.push(Hb),{...t,vs:vZ,fs:bZ}}initializeState(){const{featureIds:t}=this.props;super.initializeState();const e=this.getAttributeManager();t&&e.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;e.pbrMaterial!==n.pbrMaterial&&this.updatePbrMaterialUniforms(e.pbrMaterial)}draw(t){const{featureIds:e}=this.props;this.state.model&&(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,pickFeatureIds:!!e}),super.draw(t))}getModel(t){const{id:e,pbrMaterial:n}=this.props,i=this.parseMaterial(n,t);this.setState({materialParser:i});const s=this.getShaders();return wZ(t.attributes),new af(this.context.gl,{...this.getShaders(),id:e,geometry:t,defines:{...s.defines,...i==null?void 0:i.defines,HAS_UV_REGIONS:t.attributes.uvRegions},parameters:i==null?void 0:i.parameters,isInstanced:!0})}updatePbrMaterialUniforms(t){const{model:e}=this.state;if(e){const{mesh:n}=this.props,i=this.parseMaterial(t,n);this.setState({materialParser:i}),e.setUniforms(i.uniforms)}}parseMaterial(t,e){var n;const i=!!(t.pbrMetallicRoughness&&t.pbrMetallicRoughness.baseColorTexture);return(n=this.state.materialParser)===null||n===void 0||n.delete(),new JI(this.context.gl,{attributes:{NORMAL:e.attributes.normals,TEXCOORD_0:e.attributes.texCoords},material:{unlit:i,...t},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(t){const e=this.props.featureIds,n=new Uint8ClampedArray(e.length*t.size),i=[];for(let s=0;s<e.length;s++)this.encodePickingColor(e[s],i),n[s*3]=i[0],n[s*3+1]=i[1],n[s*3+2]=i[2];t.value=n}finalizeState(t){var e;super.finalizeState(t),(e=this.state.materialParser)===null||e===void 0||e.delete(),this.setState({materialParser:null})}}j(qw,"layerName","MeshLayer"),j(qw,"defaultProps",xZ);const BZ=6378137,CZ=6378137,EZ=6356752314245179e-9;function vy(r){return r}new se;function SZ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:vy;return"longitude"in r?(t[0]=e(r.longitude),t[1]=e(r.latitude),t[2]=r.height):"x"in r?(t[0]=e(r.x),t[1]=e(r.y),t[2]=r.z):(t[0]=e(r[0]),t[1]=e(r[1]),t[2]=r[2]),t}function TZ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return SZ(r,t,ys._cartographicRadians?vy:kV)}function IZ(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:vy;return"longitude"in t?(t.longitude=e(r[0]),t.latitude=e(r[1]),t.height=r[2]):"x"in t?(t.x=e(r[0]),t.y=e(r[1]),t.z=r[2]):(t[0]=e(r[0]),t[1]=e(r[1]),t[2]=r[2]),t}function FZ(r,t){return IZ(r,t,ys._cartographicRadians?vy:QV)}const Bf=new se,LZ=new se,PZ=new se;function MZ(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const{oneOverRadii:n,oneOverRadiiSquared:i,centerToleranceSquared:s}=t;Bf.from(r);const a=Bf.x,o=Bf.y,d=Bf.z,p=n.x,y=n.y,b=n.z,x=a*a*p*p,C=o*o*y*y,P=d*d*b*b,M=x+C+P,k=Math.sqrt(1/M);if(!Number.isFinite(k))return;const z=LZ;if(z.copy(r).scale(k),M<s)return z.to(e);const V=i.x,$=i.y,tt=i.z,pt=PZ;pt.set(z.x*V*2,z.y*$*2,z.z*tt*2);let gt=(1-k)*Bf.len()/(.5*pt.len()),mt=0,dt,Ft,Tt,ot;do{gt-=mt,dt=1/(1+gt*V),Ft=1/(1+gt*$),Tt=1/(1+gt*tt);const ct=dt*dt,wt=Ft*Ft,vt=Tt*Tt,$t=ct*dt,Wt=wt*Ft,Yt=vt*Tt;ot=x*ct+C*wt+P*vt-1;const ee=-2*(x*$t*V+C*Wt*$+P*Yt*tt);mt=ot/ee}while(Math.abs(ot)>pg.EPSILON12);return Bf.scale([dt,Ft,Tt]).to(e)}const LF=1e-14,UZ=new se,PF={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Kw={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},Rg={east:new se,north:new se,up:new se,west:new se,south:new se,down:new se},RZ=new se,OZ=new se,DZ=new se;function MF(r,t,e,n,i,s){const a=PF[t]&&PF[t][e];Wl(a&&(!n||n===a));let o,d,p;const y=UZ.copy(i);if(Xl(y.x,0,LF)&&Xl(y.y,0,LF)){const x=Math.sign(y.z);o=RZ.fromArray(Kw[t]),t!=="east"&&t!=="west"&&o.scale(x),d=OZ.fromArray(Kw[e]),e!=="east"&&e!=="west"&&d.scale(x),p=DZ.fromArray(Kw[n]),n!=="east"&&n!=="west"&&p.scale(x)}else{const{up:x,east:C,north:P}=Rg;C.set(-y.y,y.x,0).normalize(),r.geodeticSurfaceNormal(y,x),P.copy(x).cross(C);const{down:M,west:k,south:z}=Rg;M.copy(x).scale(-1),k.copy(C).scale(-1),z.copy(P).scale(-1),o=Rg[t],d=Rg[e],p=Rg[n]}return s[0]=o.x,s[1]=o.y,s[2]=o.z,s[3]=0,s[4]=d.x,s[5]=d.y,s[6]=d.z,s[7]=0,s[8]=p.x,s[9]=p.y,s[10]=p.z,s[11]=0,s[12]=y.x,s[13]=y.y,s[14]=y.z,s[15]=1,s}const by=new se,UF=new se,NZ=new se,tc=new se,kZ=new se,wy=new se;class Mi{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;j(this,"radii",void 0),j(this,"radiiSquared",void 0),j(this,"radiiToTheFourth",void 0),j(this,"oneOverRadii",void 0),j(this,"oneOverRadiiSquared",void 0),j(this,"minimumRadius",void 0),j(this,"maximumRadius",void 0),j(this,"centerToleranceSquared",pg.EPSILON1),j(this,"squaredXOverSquaredZ",void 0),Wl(t>=0),Wl(e>=0),Wl(n>=0),this.radii=new se(t,e,n),this.radiiSquared=new se(t*t,e*e,n*n),this.radiiToTheFourth=new se(t*t*t*t,e*e*e*e,n*n*n*n),this.oneOverRadii=new se(t===0?0:1/t,e===0?0:1/e,n===0?0:1/n),this.oneOverRadiiSquared=new se(t===0?0:1/(t*t),e===0?0:1/(e*e),n===0?0:1/(n*n)),this.minimumRadius=Math.min(t,e,n),this.maximumRadius=Math.max(t,e,n),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(t){return this===t||!!(t&&this.radii.equals(t.radii))}toString(){return this.radii.toString()}cartographicToCartesian(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const n=UF,i=NZ,[,,s]=t;this.geodeticSurfaceNormalCartographic(t,n),i.copy(this.radiiSquared).scale(n);const a=Math.sqrt(n.dot(i));return i.scale(1/a),n.scale(s),i.add(n),i.to(e)}cartesianToCartographic(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];wy.from(t);const n=this.scaleToGeodeticSurface(wy,tc);if(!n)return;const i=this.geodeticSurfaceNormal(n,UF),s=kZ;s.copy(wy).subtract(n);const a=Math.atan2(i.y,i.x),o=Math.asin(i.z),d=Math.sign(Fb(s,wy))*q5(s);return FZ([a,o,d],e)}eastNorthUpToFixedFrame(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new wn;return MF(this,"east","north","up",t,e)}localFrameToFixedFrame(t,e,n,i){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:new wn;return MF(this,t,e,n,i,s)}geocentricSurfaceNormal(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return by.from(t).normalize().to(e)}geodeticSurfaceNormalCartographic(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const n=TZ(t),i=n[0],s=n[1],a=Math.cos(s);return by.set(a*Math.cos(i),a*Math.sin(i),Math.sin(s)).normalize(),by.to(e)}geodeticSurfaceNormal(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return by.from(t).scale(this.oneOverRadiiSquared).normalize().to(e)}scaleToGeodeticSurface(t,e){return MZ(t,this,e)}scaleToGeocentricSurface(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];tc.from(t);const n=tc.x,i=tc.y,s=tc.z,a=this.oneOverRadiiSquared,o=1/Math.sqrt(n*n*a.x+i*i*a.y+s*s*a.z);return tc.multiplyScalar(o).to(e)}transformPositionToScaledSpace(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return tc.from(t).scale(this.oneOverRadii).to(e)}transformPositionFromScaledSpace(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return tc.from(t).scale(this.radii).to(e)}getSurfaceNormalIntersectionWithZAxis(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[0,0,0];Wl(Xl(this.radii.x,this.radii.y,pg.EPSILON15)),Wl(this.radii.z>0),tc.from(t);const i=tc.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(i)>=this.radii.z-e))return tc.set(0,0,i).to(n)}}j(Mi,"WGS84",new Mi(BZ,CZ,EZ));class QZ{constructor(t,e,n){j(this,"item",void 0),j(this,"previous",void 0),j(this,"next",void 0),this.item=t,this.previous=e,this.next=n}}class zZ{constructor(){j(this,"head",null),j(this,"tail",null),j(this,"_length",0)}get length(){return this._length}add(t){const e=new QZ(t,this.tail,null);return this.tail?(this.tail.next=e,this.tail=e):(this.head=e,this.tail=e),++this._length,e}remove(t){t&&(t.previous&&t.next?(t.previous.next=t.next,t.next.previous=t.previous):t.previous?(t.previous.next=null,this.tail=t.previous):t.next?(t.next.previous=null,this.head=t.next):(this.head=null,this.tail=null),t.next=null,t.previous=null,--this._length)}splice(t,e){t!==e&&(this.remove(e),this._insert(t,e))}_insert(t,e){const n=t.next;t.next=e,this.tail===t?this.tail=e:n.previous=e,e.next=n,e.previous=t,++this._length}}class HZ{constructor(){j(this,"_list",void 0),j(this,"_sentinel",void 0),j(this,"_trimTiles",void 0),this._list=new zZ,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(t){const e=t._cacheNode;e&&this._list.splice(this._sentinel,e)}add(t,e,n){e._cacheNode||(e._cacheNode=this._list.add(e),n&&n(t,e))}unloadTile(t,e,n){const i=e._cacheNode;i&&(this._list.remove(i),e._cacheNode=null,n&&n(t,e))}unloadTiles(t,e){const n=this._trimTiles;this._trimTiles=!1;const i=this._list,s=t.maximumMemoryUsage*1024*1024,a=this._sentinel;let o=i.head;for(;o!==a&&(t.gpuMemoryUsageInBytes>s||n);){const d=o.item;o=o.next,this.unloadTile(t,d,e)}}trim(){this._trimTiles=!0}}function VZ(r,t){ui(r),ui(t);const{rtcCenter:e,gltfUpAxis:n}=t,{computedTransform:i,boundingVolume:{center:s}}=r;let a=new wn(i);switch(e&&a.translate(e),n){case"Z":break;case"Y":const b=new wn().rotateX(Math.PI/2);a=a.multiplyRight(b);break;case"X":const x=new wn().rotateY(-Math.PI/2);a=a.multiplyRight(x);break}t.isQuantized&&a.translate(t.quantizedVolumeOffset).scale(t.quantizedVolumeScale);const o=new se(s);t.cartesianModelMatrix=a,t.cartesianOrigin=o;const d=Mi.WGS84.cartesianToCartographic(o,new se),y=Mi.WGS84.eastNorthUpToFixedFrame(o).invert();t.cartographicModelMatrix=y.multiplyRight(a),t.cartographicOrigin=d,t.coordinateSystem||(t.modelMatrix=t.cartographicModelMatrix)}const RF=new se,$w=new se,Ww=new al([new Zl,new Zl,new Zl,new Zl,new Zl,new Zl]);function GZ(r,t){const{cameraDirection:e,cameraUp:n,height:i}=r,{metersPerUnit:s}=r.distanceScales,a=xy(r,r.center),o=Mi.WGS84.eastNorthUpToFixedFrame(a),d=r.unprojectPosition(r.cameraPosition),p=Mi.WGS84.cartographicToCartesian(d,new se),y=new se(o.transformAsVector(new se(e).scale(s))).normalize(),b=new se(o.transformAsVector(new se(n).scale(s))).normalize();qZ(r);const x=r.constructor,{longitude:C,latitude:P,width:M,bearing:k,zoom:z}=r,V=new x({longitude:C,latitude:P,height:i,width:M,bearing:k,zoom:z,pitch:0});return{camera:{position:p,direction:y,up:b},viewport:r,topDownViewport:V,height:i,cullingVolume:Ww,frameNumber:t,sseDenominator:1.15}}function jZ(r,t,e){if(e===0||r.length<=e)return[r,[]];const n=[],{longitude:i,latitude:s}=t.viewport;for(const[p,y]of r.entries()){const[b,x]=y.header.mbs,C=Math.abs(i-b),P=Math.abs(s-x),M=Math.sqrt(P*P+C*C);n.push([p,M])}const a=n.sort((p,y)=>p[1]-y[1]),o=[];for(let p=0;p<e;p++)o.push(r[a[p][0]]);const d=[];for(let p=e;p<a.length;p++)d.push(r[a[p][0]]);return[o,d]}function qZ(r){const t=r.getFrustumPlanes(),e=OF(t.near,r.cameraPosition),n=xy(r,e),i=xy(r,r.cameraPosition,$w);let s=0;Ww.planes[s++].fromPointNormal(n,RF.copy(n).subtract(i));for(const a in t){if(a==="near")continue;const o=t[a],d=OF(o,e,$w),p=xy(r,d,$w);Ww.planes[s++].fromPointNormal(p,RF.copy(n).subtract(p))}}function OF(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new se;const n=r.normal.dot(t);return e.copy(r.normal).scale(r.distance-n).add(t),e}function xy(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new se;const n=r.unprojectPosition(t);return Mi.WGS84.cartographicToCartesian(n,e)}const KZ=6378137,$Z=6378137,Xw=6356752314245179e-9,DF=new se;function WZ(r,t){if(r instanceof Tg){const{halfAxes:e}=r,n=JZ(e);return Math.log2(Xw/(n+t[2]))}else if(r instanceof Sg){const{radius:e}=r;return Math.log2(Xw/(e+t[2]))}else if(r.width&&r.height){const{width:e,height:n}=r,i=Math.log2(KZ/e),s=Math.log2($Z/n);return(i+s)/2}return 1}function NF(r,t,e){const n=Mi.WGS84.cartographicToCartesian([r.xmax,r.ymax,r.zmax],new se),i=Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)+Math.pow(n[2]-e[2],2));return Math.log2(Xw/(i+t[2]))}function XZ(r,t,e){const[n,i,s,a]=r;return NF({xmin:n,xmax:s,ymin:i,ymax:a,zmin:0,zmax:0},t,e)}function JZ(r){r.getColumn(0,DF);const t=r.getColumn(1),e=r.getColumn(2);return DF.add(t).add(e).len()}const Pa={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},zu={ADD:1,REPLACE:2},Cf={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},cl={I3S:"I3S",TILES3D:"TILES3D"},By={GEOMETRIC_ERROR:"geometricError",MAX_SCREEN_THRESHOLD:"maxScreenThreshold"},YZ={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};function kF(r){return r!=null}const lo=new se,Cy=new se,ZZ=new se,ttt=new se;function Jw(r,t,e){if(ui(r,"3D Tile: boundingVolume must be defined"),r.box)return rtt(r.box,t,e);if(r.region){const[n,i,s,a,o,d]=r.region,p=Mi.WGS84.cartographicToCartesian([Du(n),Du(a),o],ZZ),y=Mi.WGS84.cartographicToCartesian([Du(s),Du(i),d],ttt),b=new se().addVectors(p,y).multiplyScalar(.5),x=new se().subVectors(p,y).len()/2;return QF([b[0],b[1],b[2],x],new wn)}if(r.sphere)return QF(r.sphere,t,e);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function ett(r,t){if(r.box)return ntt(t);if(r.region){const[e,n,i,s,a,o]=r.region;return[[Du(e),Du(n),a],[Du(i),Du(s),o]]}if(r.sphere)return itt(t);throw new Error("Unkown boundingVolume type")}function rtt(r,t,e){const n=new se(r[0],r[1],r[2]);t.transform(n,n);let i=[];if(r.length===10){const p=r.slice(3,6),y=new fg;y.fromArray(r,6);const b=new se([1,0,0]),x=new se([0,1,0]),C=new se([0,0,1]);b.transformByQuaternion(y),b.scale(p[0]),x.transformByQuaternion(y),x.scale(p[1]),C.transformByQuaternion(y),C.scale(p[2]),i=[...b.toArray(),...x.toArray(),...C.toArray()]}else i=[...r.slice(3,6),...r.slice(6,9),...r.slice(9,12)];const s=t.transformAsVector(i.slice(0,3)),a=t.transformAsVector(i.slice(3,6)),o=t.transformAsVector(i.slice(6,9)),d=new Di([s[0],s[1],s[2],a[0],a[1],a[2],o[0],o[1],o[2]]);return kF(e)?(e.center=n,e.halfAxes=d,e):new Tg(n,d)}function QF(r,t,e){const n=new se(r[0],r[1],r[2]);t.transform(n,n);const i=t.getScale(Cy),s=Math.max(Math.max(i[0],i[1]),i[2]),a=r[3]*s;return kF(e)?(e.center=n,e.radius=a,e):new Sg(n,a)}function ntt(r){const t=zF(),{halfAxes:e}=r,n=new se(e.getColumn(0)),i=new se(e.getColumn(1)),s=new se(e.getColumn(2));for(let a=0;a<2;a++){for(let o=0;o<2;o++){for(let d=0;d<2;d++)lo.copy(r.center),lo.add(n),lo.add(i),lo.add(s),HF(t,lo),s.negate();i.negate()}n.negate()}return t}function itt(r){const t=zF(),{center:e,radius:n}=r,i=Mi.WGS84.scaleToGeodeticSurface(e,lo);let s;i?s=Mi.WGS84.geodeticSurfaceNormal(i):s=new se(0,0,1);let a=new se(s[2],-s[1],0);a.len()>0?a.normalize():a=new se(0,1,0);const o=a.clone().cross(s);for(const d of[a,o,s]){Cy.copy(d).scale(n);for(let p=0;p<2;p++)lo.copy(e),lo.add(Cy),HF(t,lo),Cy.negate()}return t}function zF(){return[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]]}function HF(r,t){Mi.WGS84.cartesianToCartographic(t,lo),r[0][0]=Math.min(r[0][0],lo[0]),r[0][1]=Math.min(r[0][1],lo[1]),r[0][2]=Math.min(r[0][2],lo[2]),r[1][0]=Math.max(r[1][0],lo[0]),r[1][1]=Math.max(r[1][1],lo[1]),r[1][2]=Math.max(r[1][2],lo[2])}new se,new se,new wn,new se,new se,new se;function stt(r,t){const e=r*t;return 1-Math.exp(-(e*e))}function ott(r,t){if(r.dynamicScreenSpaceError&&r.dynamicScreenSpaceErrorComputedDensity){const e=r.dynamicScreenSpaceErrorComputedDensity,n=r.dynamicScreenSpaceErrorFactor;return stt(t,e)*n}return 0}function att(r,t,e){const n=r.tileset,i=r.parent&&r.parent.lodMetricValue||r.lodMetricValue,s=e?i:r.lodMetricValue;if(s===0)return 0;const a=Math.max(r._distanceToCamera,1e-7),{height:o,sseDenominator:d}=t,{viewDistanceScale:p}=n.options;let y=s*o*(p||1)/(a*d);return y-=ott(n,a),y}const Yw=new se,VF=new se,HA=new se,GF=new se,ltt=new se,Zw=new wn,jF=new wn;function ctt(r,t){if(r.lodMetricValue===0||isNaN(r.lodMetricValue))return"DIG";const e=2*qF(r,t);return e<2?"OUT":!r.header.children||e<=r.lodMetricValue?"DRAW":r.header.children?"DIG":"OUT"}function qF(r,t){const{topDownViewport:e}=t,n=r.header.mbs[1],i=r.header.mbs[0],s=r.header.mbs[2],a=r.header.mbs[3],o=[...r.boundingVolume.center],d=e.unprojectPosition(e.cameraPosition);Mi.WGS84.cartographicToCartesian(d,Yw),VF.copy(Yw).subtract(o).normalize(),Mi.WGS84.eastNorthUpToFixedFrame(o,Zw),jF.copy(Zw).invert(),HA.copy(Yw).transform(jF);const p=Math.sqrt(HA[0]*HA[0]+HA[1]*HA[1]),y=p*p/HA[2];GF.copy([HA[0],HA[1],y]);const x=GF.transform(Zw).subtract(o).normalize(),P=VF.cross(x).normalize().scale(a).add(o),M=Mi.WGS84.cartesianToCartographic(P),k=e.project([i,n,s]),z=e.project(M);return ltt.copy(k).subtract(z).magnitude()}function utt(r){return{assetGltfUpAxis:r.asset&&r.asset.gltfUpAxis||"Y"}}class KF{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;j(this,"_map",new Map),j(this,"_array",void 0),j(this,"_length",void 0),this._array=new Array(t),this._length=t}get length(){return this._length}set length(t){this._length=t,t>this._array.length&&(this._array.length=t)}get values(){return this._array}get(t){return ui(t<this._array.length),this._array[t]}set(t,e){ui(t>=0),t>=this.length&&(this.length=t+1),this._map.has(this._array[t])&&this._map.delete(this._array[t]),this._array[t]=e,this._map.set(e,t)}delete(t){const e=this._map.get(t);e>=0&&(this._array.splice(e,1),this._map.delete(t),this.length--)}peek(){return this._array[this._length-1]}push(t){if(!this._map.has(t)){const e=this.length++;this._array[e]=t,this._map.set(t,e)}}pop(){const t=this._array[--this.length];return this._map.delete(t),t}reserve(t){ui(t>=0),t>this._array.length&&(this._array.length=t)}resize(t){ui(t>=0),this.length=t}trim(t){t==null&&(t=this.length),this._array.length=t}reset(){this._array=[],this._map=new Map,this._length=0}find(t){return this._map.has(t)}}const Att={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class Ey{traversalFinished(t){return!0}constructor(t){j(this,"options",void 0),j(this,"root",null),j(this,"selectedTiles",{}),j(this,"requestedTiles",{}),j(this,"emptyTiles",{}),j(this,"lastUpdate",new Date().getTime()),j(this,"updateDebounceTime",1e3),j(this,"_traversalStack",new KF),j(this,"_emptyTraversalStack",new KF),j(this,"_frameNumber",null),this.options={...Att,...t}}traverse(t,e,n){this.root=t,this.options={...this.options,...n},this.reset(),this.updateTile(t,e),this._frameNumber=e.frameNumber,this.executeTraversal(t,e)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(t,e){const n=this._traversalStack;for(t._selectionDepth=1,n.push(t);n.length>0;){const s=n.pop();let a=!1;this.canTraverse(s,e)&&(this.updateChildTiles(s,e),a=this.updateAndPushChildren(s,e,n,s.hasRenderContent?s._selectionDepth+1:s._selectionDepth));const o=s.parent,d=!!(!o||o._shouldRefine),p=!a;s.hasRenderContent?s.refine===zu.ADD?(this.loadTile(s,e),this.selectTile(s,e)):s.refine===zu.REPLACE&&(this.loadTile(s,e),p&&this.selectTile(s,e)):(this.emptyTiles[s.id]=s,this.loadTile(s,e),p&&this.selectTile(s,e)),this.touchTile(s,e),s._shouldRefine=a&&d}const i=new Date().getTime();(this.traversalFinished(e)||i-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=i,this.options.onTraversalEnd(e))}updateChildTiles(t,e){const n=t.children;for(const i of n)this.updateTile(i,e)}updateAndPushChildren(t,e,n,i){const{loadSiblings:s,skipLevelOfDetail:a}=this.options,o=t.children;o.sort(this.compareDistanceToCamera.bind(this));const d=t.refine===zu.REPLACE&&t.hasRenderContent&&!a;let p=!1,y=!0;for(const b of o)if(b._selectionDepth=i,b.isVisibleAndInRequestVolume?(n.find(b)&&n.delete(b),n.push(b),p=!0):(d||s)&&(this.loadTile(b,e),this.touchTile(b,e)),d){let x;if(b._inRequestVolume?b.hasRenderContent?x=b.contentAvailable:x=this.executeEmptyTraversal(b,e):x=!1,y=y&&x,!y)return!1}return p||(y=!1),y}updateTile(t,e){this.updateTileVisibility(t,e)}selectTile(t,e){this.shouldSelectTile(t)&&(t._selectedFrame=e.frameNumber,this.selectedTiles[t.id]=t)}loadTile(t,e){this.shouldLoadTile(t)&&(t._requestedFrame=e.frameNumber,t._priority=t._getPriority(),this.requestedTiles[t.id]=t)}touchTile(t,e){t.tileset._cache.touch(t),t._touchedFrame=e.frameNumber}canTraverse(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return t.hasChildren?t.hasTilesetContent?!t.contentExpired:!i&&!t.isVisibleAndInRequestVolume?!1:this.shouldRefine(t,e,n):!1}shouldLoadTile(t){return t.hasUnloadedContent||t.contentExpired}shouldSelectTile(t){return t.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=t._screenSpaceError;return n&&(i=t.getScreenSpaceError(e,!0)),i>this.options.maximumScreenSpaceError}updateTileVisibility(t,e){const n=[];if(this.options.viewportTraversersMap)for(const i in this.options.viewportTraversersMap)this.options.viewportTraversersMap[i]===e.viewport.id&&n.push(i);else n.push(e.viewport.id);t.updateVisibility(e,n)}compareDistanceToCamera(t,e){return t._distanceToCamera-e._distanceToCamera}anyChildrenVisible(t,e){let n=!1;for(const i of t.children)i.updateVisibility(e),n=n||i.isVisibleAndInRequestVolume;return n}executeEmptyTraversal(t,e){let n=!0;const i=this._emptyTraversalStack;for(i.push(t);i.length>0&&n;){const s=i.pop();if(this.updateTile(s,e),s.isVisibleAndInRequestVolume||this.loadTile(s,e),this.touchTile(s,e),!s.hasRenderContent&&this.canTraverse(s,e,!1,!0)){const o=s.children;for(const d of o)i.find(d)&&i.delete(d),i.push(d)}else!s.contentAvailable&&!s.hasEmptyContent&&(n=!1)}return n}}const $F=new se;function htt(r){return r!=null}class t2{constructor(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"";j(this,"tileset",void 0),j(this,"header",void 0),j(this,"id",void 0),j(this,"url",void 0),j(this,"parent",void 0),j(this,"refine",void 0),j(this,"type",void 0),j(this,"contentUrl",void 0),j(this,"lodMetricType","geometricError"),j(this,"lodMetricValue",0),j(this,"boundingVolume",null),j(this,"content",null),j(this,"contentState",Pa.UNLOADED),j(this,"gpuMemoryUsageInBytes",0),j(this,"children",[]),j(this,"depth",0),j(this,"viewportIds",[]),j(this,"transform",new wn),j(this,"extensions",null),j(this,"implicitTiling",null),j(this,"userData",{}),j(this,"computedTransform",void 0),j(this,"hasEmptyContent",!1),j(this,"hasTilesetContent",!1),j(this,"traverser",new Ey({})),j(this,"_cacheNode",null),j(this,"_frameNumber",null),j(this,"_expireDate",null),j(this,"_expiredContent",null),j(this,"_boundingBox",void 0),j(this,"_distanceToCamera",0),j(this,"_screenSpaceError",0),j(this,"_visibilityPlaneMask",void 0),j(this,"_visible",void 0),j(this,"_contentBoundingVolume",void 0),j(this,"_viewerRequestVolume",void 0),j(this,"_initialTransform",new wn),j(this,"_priority",0),j(this,"_selectedFrame",0),j(this,"_requestedFrame",0),j(this,"_selectionDepth",0),j(this,"_touchedFrame",0),j(this,"_centerZDepth",0),j(this,"_shouldRefine",!1),j(this,"_stackLength",0),j(this,"_visitedFrame",0),j(this,"_inRequestVolume",!1),j(this,"_lodJudge",null),this.header=e,this.tileset=t,this.id=i||e.id,this.url=e.url,this.parent=n,this.refine=this._getRefine(e.refine),this.type=e.type,this.contentUrl=e.contentUrl,this._initializeLodMetric(e),this._initializeTransforms(e),this._initializeBoundingVolumes(e),this._initializeContent(e),this._initializeRenderingState(e),Object.seal(this)}destroy(){this.header=null}isDestroyed(){return this.header===null}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return this.contentState===Pa.READY||this.hasEmptyContent}get contentAvailable(){return!!(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return this.contentState===Pa.UNLOADED}get contentExpired(){return this.contentState===Pa.EXPIRED}get contentFailed(){return this.contentState===Pa.FAILED}get distanceToCamera(){return this._distanceToCamera}get screenSpaceError(){return this._screenSpaceError}get boundingBox(){return this._boundingBox||(this._boundingBox=ett(this.header.boundingVolume,this.boundingVolume)),this._boundingBox}getScreenSpaceError(t,e){switch(this.tileset.type){case cl.I3S:return qF(this,t);case cl.TILES3D:return att(this,t,e);default:throw new Error("Unsupported tileset type")}}unselect(){this._selectedFrame=0}_getGpuMemoryUsageInBytes(){return this.content.gpuMemoryUsageInBytes||this.content.byteLength||0}_getPriority(){const t=this.tileset._traverser,{skipLevelOfDetail:e}=t.options,n=this.refine===zu.ADD||e;if(n&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===Pa.UNLOADED)return-1;const i=this.parent,a=i&&(!n||this._screenSpaceError===0||i.hasTilesetContent)?i._screenSpaceError:this._screenSpaceError,o=t.root?t.root._screenSpaceError:0;return Math.max(o-a,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=Pa.LOADING;const e=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!e)return this.contentState=Pa.UNLOADED,!1;try{const n=this.tileset.getTileUrl(this.contentUrl),i=this.tileset.loader,s={...this.tileset.loadOptions,[i.id]:{...this.tileset.loadOptions[i.id],isTileset:this.type==="json",...this._getLoaderSpecificOptions(i.id)}};return this.content=await FA(n,i,s),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=Pa.READY,this._onContentLoaded(),!0}catch(n){throw this.contentState=Pa.FAILED,n}finally{e.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=Pa.UNLOADED,!0}updateVisibility(t,e){if(this._frameNumber===t.frameNumber)return;const n=this.parent,i=n?n._visibilityPlaneMask:al.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const s=n?n.computedTransform:this.tileset.modelMatrix;this._updateTransform(s)}this._distanceToCamera=this.distanceToTile(t),this._screenSpaceError=this.getScreenSpaceError(t,!1),this._visibilityPlaneMask=this.visibility(t,i),this._visible=this._visibilityPlaneMask!==al.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(t),this._frameNumber=t.frameNumber,this.viewportIds=e}visibility(t,e){const{cullingVolume:n}=t,{boundingVolume:i}=this;return n.computeVisibilityWithPlaneMask(i,e)}contentVisibility(){return!0}distanceToTile(t){const e=this.boundingVolume;return Math.sqrt(Math.max(e.distanceSquaredTo(t.camera.position),0))}cameraSpaceZDepth(t){let{camera:e}=t;const n=this.boundingVolume;return $F.subVectors(n.center,e.position),e.direction.dot($F)}insideViewerRequestVolume(t){const e=this._viewerRequestVolume;return!e||e.distanceSquaredTo(t.camera.position)<=0}updateExpiration(){if(htt(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){const t=Date.now();Date.lessThan(this._expireDate,t)&&(this.contentState=Pa.EXPIRED,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(t){"lodMetricType"in t?this.lodMetricType=t.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in t?this.lodMetricValue=t.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(t){this.transform=t.transform?new wn(t.transform):new wn;const e=this.parent,n=this.tileset,i=e&&e.computedTransform?e.computedTransform.clone():n.modelMatrix.clone();this.computedTransform=new wn(i).multiplyRight(this.transform);const s=e&&e._initialTransform?e._initialTransform.clone():new wn;this._initialTransform=new wn(s).multiplyRight(this.transform)}_initializeBoundingVolumes(t){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(t)}_initializeContent(t){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=Pa.UNLOADED,this.hasTilesetContent=!1,t.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(t){this.depth=t.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=al.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(t){return t||this.parent&&this.parent.refine||zu.REPLACE}_isTileset(){return this.contentUrl.indexOf(".json")!==-1}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0;break}this._isTileset()?this.hasTilesetContent=!0:this.gpuMemoryUsageInBytes=this._getGpuMemoryUsageInBytes()}_updateBoundingVolume(t){this.boundingVolume=Jw(t.boundingVolume,this.computedTransform,this.boundingVolume);const e=t.content;e&&(e.boundingVolume&&(this._contentBoundingVolume=Jw(e.boundingVolume,this.computedTransform,this._contentBoundingVolume)),t.viewerRequestVolume&&(this._viewerRequestVolume=Jw(t.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:new wn).clone().multiplyRight(this.transform);e.equals(this.computedTransform)||(this.computedTransform=e,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(t){switch(t){case"i3s":return{...this.tileset.options.i3s,_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1};case"3d-tiles":case"cesium-ion":default:return utt(this.tileset.tileset)}}}class dtt extends Ey{compareDistanceToCamera(t,e){return e._distanceToCamera===0&&t._distanceToCamera===0?e._centerZDepth-t._centerZDepth:e._distanceToCamera-t._distanceToCamera}updateTileVisibility(t,e){if(super.updateTileVisibility(t,e),!t.isVisibleAndInRequestVolume)return;const n=t.children.length>0;if(t.hasTilesetContent&&n){const a=t.children[0];this.updateTileVisibility(a,e),t._visible=a._visible;return}if(this.meetsScreenSpaceErrorEarly(t,e)){t._visible=!1;return}const i=t.refine===zu.REPLACE,s=t._optimChildrenWithinParent===YZ.USE_OPTIMIZATION;if(i&&s&&n&&!this.anyChildrenVisible(t,e)){t._visible=!1;return}}meetsScreenSpaceErrorEarly(t,e){const{parent:n}=t;return!n||n.hasTilesetContent||n.refine!==zu.ADD?!1:!this.shouldRefine(t,e,!0)}}class ftt{constructor(){j(this,"frameNumberMap",new Map)}register(t,e){const n=this.frameNumberMap.get(t)||new Map,i=n.get(e)||0;n.set(e,i+1),this.frameNumberMap.set(t,n)}deregister(t,e){const n=this.frameNumberMap.get(t);if(!n)return;const i=n.get(e)||1;n.set(e,i-1)}isZero(t,e){var n;return(((n=this.frameNumberMap.get(t))===null||n===void 0?void 0:n.get(e))||0)===0}}const e2={REQUESTED:"REQUESTED",COMPLETED:"COMPLETED",ERROR:"ERROR"};class ptt{constructor(){j(this,"_statusMap",void 0),j(this,"pendingTilesRegister",new ftt),this._statusMap={}}add(t,e,n,i){if(!this._statusMap[e]){const{frameNumber:s,viewport:{id:a}}=i;this._statusMap[e]={request:t,callback:n,key:e,frameState:i,status:e2.REQUESTED},this.pendingTilesRegister.register(a,s),t().then(o=>{this._statusMap[e].status=e2.COMPLETED;const{frameNumber:d,viewport:{id:p}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(p,d),this._statusMap[e].callback(o,i)}).catch(o=>{this._statusMap[e].status=e2.ERROR;const{frameNumber:d,viewport:{id:p}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(p,d),n(o)})}}update(t,e){if(this._statusMap[t]){const{frameNumber:n,viewport:{id:i}}=this._statusMap[t].frameState;this.pendingTilesRegister.deregister(i,n);const{frameNumber:s,viewport:{id:a}}=e;this.pendingTilesRegister.register(a,s),this._statusMap[t].frameState=e}}find(t){return this._statusMap[t]}hasPendingTiles(t,e){return!this.pendingTilesRegister.isZero(t,e)}}class gtt extends Ey{constructor(t){super(t),j(this,"_tileManager",void 0),this._tileManager=new ptt}traversalFinished(t){return!this._tileManager.hasPendingTiles(t.viewport.id,this._frameNumber||0)}shouldRefine(t,e){return t._lodJudge=ctt(t,e),t._lodJudge==="DIG"}updateChildTiles(t,e){const n=t.header.children||[],i=t.children,s=t.tileset;for(const a of n){const o="".concat(a.id,"-").concat(e.viewport.id),d=i&&i.find(p=>p.id===o);if(d)d&&this.updateTile(d,e);else{let p=()=>this._loadTile(a.id,s);this._tileManager.find(o)?this._tileManager.update(o,e):(s.tileset.nodePages&&(p=()=>s.tileset.nodePagesTile.formTileFromNodePages(a.id)),this._tileManager.add(p,o,b=>this._onTileLoad(b,t,o),e))}}return!1}async _loadTile(t,e){const{loader:n}=e,i=e.getTileUrl("".concat(e.url,"/nodes/").concat(t)),s={...e.loadOptions,i3s:{...e.loadOptions.i3s,isTileHeader:!0}};return await FA(i,n,s)}_onTileLoad(t,e,n){const i=new t2(e.tileset,t,e,n);e.children.push(i);const s=this._tileManager.find(i.id).frameState;this.updateTile(i,s),this._frameNumber===s.frameNumber&&(this.traversalFinished(s)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(i,s)}}const mtt={description:"",ellipsoid:Mi.WGS84,modelMatrix:new wn,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:r=>r,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},Sy="Tiles In Tileset(s)",r2="Tiles In Memory",WF="Tiles In View",XF="Tiles To Render",JF="Tiles Loaded",n2="Tiles Loading",YF="Tiles Unloaded",ZF="Failed Tile Loads",tL="Points/Vertices",i2="Tile Memory Use";class ytt{constructor(t,e){j(this,"options",void 0),j(this,"loadOptions",void 0),j(this,"type",void 0),j(this,"tileset",void 0),j(this,"loader",void 0),j(this,"url",void 0),j(this,"basePath",void 0),j(this,"modelMatrix",void 0),j(this,"ellipsoid",void 0),j(this,"lodMetricType",void 0),j(this,"lodMetricValue",void 0),j(this,"refine",void 0),j(this,"root",null),j(this,"roots",{}),j(this,"asset",{}),j(this,"description",""),j(this,"properties",void 0),j(this,"extras",null),j(this,"attributions",{}),j(this,"credits",{}),j(this,"stats",void 0),j(this,"contentFormats",{draco:!1,meshopt:!1,dds:!1,ktx2:!1}),j(this,"cartographicCenter",null),j(this,"cartesianCenter",null),j(this,"zoom",1),j(this,"boundingVolume",null),j(this,"dynamicScreenSpaceErrorComputedDensity",0),j(this,"maximumMemoryUsage",32),j(this,"gpuMemoryUsageInBytes",0),j(this,"_frameNumber",0),j(this,"_queryParams",{}),j(this,"_extensionsUsed",[]),j(this,"_tiles",{}),j(this,"_pendingCount",0),j(this,"selectedTiles",[]),j(this,"traverseCounter",0),j(this,"geometricError",0),j(this,"lastUpdatedVieports",null),j(this,"_requestedTiles",[]),j(this,"_emptyTiles",[]),j(this,"frameStateData",{}),j(this,"_traverser",void 0),j(this,"_cache",new HZ),j(this,"_requestScheduler",void 0),j(this,"updatePromise",null),j(this,"tilesetInitializationPromise",void 0),this.options={...mtt,...e},this.tileset=t,this.loader=t.loader,this.type=t.type,this.url=t.url,this.basePath=t.basePath||Uv(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=t.lodMetricType,this.lodMetricValue=t.lodMetricValue,this.refine=t.root.refine,this.loadOptions=this.options.loadOptions||{},this._traverser=this._initializeTraverser(),this._requestScheduler=new eQ({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this.stats=new Kp({id:this.url}),this._initializeStats(),this.tilesetInitializationPromise=this._initializeTileSet(t)}destroy(){this._destroy()}isLoaded(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return new URLSearchParams(this._queryParams).toString()}setProps(t){this.options={...this.options,...t}}setOptions(t){this.options={...this.options,...t}}getTileUrl(t){return t.startsWith("data:")?t:"".concat(t).concat(t.includes("?")?"&":"?").concat(this.queryParams)}hasExtension(t){return this._extensionsUsed.indexOf(t)>-1}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.tilesetInitializationPromise.then(()=>{!t&&this.lastUpdatedVieports?t=this.lastUpdatedVieports:this.lastUpdatedVieports=t,t&&this.doUpdate(t)})}async selectTiles(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return await this.tilesetInitializationPromise,t&&(this.lastUpdatedVieports=t),this.updatePromise||(this.updatePromise=new Promise(e=>{setTimeout(()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),e(this._frameNumber),this.updatePromise=null},this.options.debounceTime)})),this.updatePromise}doUpdate(t){if("loadTiles"in this.options&&!this.options.loadTiles||this.traverseCounter>0)return;const e=t instanceof Array?t:[t];this._cache.reset(),this._frameNumber++,this.traverseCounter=e.length;const n=[];for(const i of e){const s=i.id;this._needTraverse(s)?n.push(s):this.traverseCounter--}for(const i of e){const s=i.id;if(this.roots[s]||(this.roots[s]=this._initializeTileHeaders(this.tileset,null)),!n.includes(s))continue;const a=GZ(i,this._frameNumber);this._traverser.traverse(this.roots[s],a,this.options)}}_needTraverse(t){let e=t;return this.options.viewportTraversersMap&&(e=this.options.viewportTraversersMap[t]),e===t}_onTraversalEnd(t){const e=t.viewport.id;this.frameStateData[e]||(this.frameStateData[e]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const n=this.frameStateData[e],i=Object.values(this._traverser.selectedTiles),[s,a]=jZ(i,t,this.options.maximumTilesSelected);n.selectedTiles=s;for(const o of a)o.unselect();n._requestedTiles=Object.values(this._traverser.requestedTiles),n._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const t in this.frameStateData){const e=this.frameStateData[t];this.selectedTiles=this.selectedTiles.concat(e.selectedTiles),this._requestedTiles=this._requestedTiles.concat(e._requestedTiles),this._emptyTiles=this._emptyTiles.concat(e._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const t of this.selectedTiles)this._tiles[t.id]=t;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(t,e){if(t.length!==e.length)return!0;const n=new Set(t.map(a=>a.id)),i=new Set(e.map(a=>a.id));let s=t.filter(a=>!i.has(a.id)).length>0;return s=s||e.filter(a=>!n.has(a.id)).length>0,s}_loadTiles(){for(const t of this._requestedTiles)t.contentUnloaded&&this._loadTile(t)}_unloadTiles(){this._cache.unloadTiles(this,(t,e)=>t._unloadTile(e))}_updateStats(){let t=0,e=0;for(const n of this.selectedTiles)n.contentAvailable&&n.content&&(t++,n.content.pointCount?e+=n.content.pointCount:e+=n.content.vertexCount);this.stats.get(WF).count=this.selectedTiles.length,this.stats.get(XF).count=t,this.stats.get(tL).count=e}async _initializeTileSet(t){this.type===cl.I3S&&(this.calculateViewPropsI3S(),t.root=await t.root),this.root=this._initializeTileHeaders(t,null),this.type===cl.TILES3D&&(this._initializeTiles3DTileset(t),this.calculateViewPropsTiles3D()),this.type===cl.I3S&&this._initializeI3STileset()}calculateViewPropsI3S(){var t;const e=this.tileset.fullExtent;if(e){const{xmin:i,xmax:s,ymin:a,ymax:o,zmin:d,zmax:p}=e;this.cartographicCenter=new se(i+(s-i)/2,a+(o-a)/2,d+(p-d)/2),this.cartesianCenter=Mi.WGS84.cartographicToCartesian(this.cartographicCenter,new se),this.zoom=NF(e,this.cartographicCenter,this.cartesianCenter);return}const n=(t=this.tileset.store)===null||t===void 0?void 0:t.extent;if(n){const[i,s,a,o]=n;this.cartographicCenter=new se(i+(a-i)/2,s+(o-s)/2,0),this.cartesianCenter=Mi.WGS84.cartographicToCartesian(this.cartographicCenter,new se),this.zoom=XZ(n,this.cartographicCenter,this.cartesianCenter);return}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new se,this.zoom=1}calculateViewPropsTiles3D(){const t=this.root,{center:e}=t.boundingVolume;if(!e){console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new se,this.zoom=1;return}e[0]!==0||e[1]!==0||e[2]!==0?this.cartographicCenter=Mi.WGS84.cartesianToCartographic(e,new se):this.cartographicCenter=new se(0,0,-Mi.WGS84.radii[0]),this.cartesianCenter=e,this.zoom=WZ(t.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get(Sy),this.stats.get(n2),this.stats.get(r2),this.stats.get(WF),this.stats.get(XF),this.stats.get(JF),this.stats.get(YF),this.stats.get(ZF),this.stats.get(tL),this.stats.get(i2,"memory")}_initializeTileHeaders(t,e){const n=new t2(this,t.root,e);if(e&&(e.children.push(n),n.depth=e.depth+1),this.type===cl.TILES3D){const s=[];for(s.push(n);s.length>0;){const a=s.pop();this.stats.get(Sy).incrementCount();const o=a.header.children||[];for(const d of o){var i;const p=new t2(this,d,a);if((i=p.contentUrl)!==null&&i!==void 0&&i.includes("?session=")){const b=new URL(p.contentUrl).searchParams.get("session");b&&(this._queryParams.session=b)}a.children.push(p),p.depth=a.depth+1,s.push(p)}}}return n}_initializeTraverser(){let t;switch(this.type){case cl.TILES3D:t=dtt;break;case cl.I3S:t=gtt;break;default:t=Ey}return new t({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(t){this._destroySubtree(t)}async _loadTile(t){let e;try{this._onStartTileLoading(),e=await t.loadContent()}catch(n){this._onTileLoadError(t,n instanceof Error?n:new Error("load failed"))}finally{this._onEndTileLoading(),this._onTileLoad(t,e)}}_onTileLoadError(t,e){this.stats.get(ZF).incrementCount();const n=e.message||e.toString(),i=t.url;console.error("A 3D tile failed to load: ".concat(t.url," ").concat(n)),this.options.onTileError(t,n,i)}_onTileLoad(t,e){if(e){if(this.type===cl.I3S){var n,i;const s=((n=this.tileset)===null||n===void 0||(i=n.nodePagesTile)===null||i===void 0?void 0:i.nodesInNodePages)||0;this.stats.get(Sy).reset(),this.stats.get(Sy).addCount(s)}t&&t.content&&VZ(t,t.content),this.updateContentTypes(t),this._addTileToCache(t),this.options.onTileLoad(t)}}updateContentTypes(t){if(this.type===cl.I3S)switch(t.header.isDracoGeometry&&(this.contentFormats.draco=!0),t.header.textureFormat){case"dds":this.contentFormats.dds=!0;break;case"ktx2":this.contentFormats.ktx2=!0;break}else if(this.type===cl.TILES3D){var e;const{extensionsRemoved:n=[]}=((e=t.content)===null||e===void 0?void 0:e.gltf)||{};n.includes("KHR_draco_mesh_compression")&&(this.contentFormats.draco=!0),n.includes("EXT_meshopt_compression")&&(this.contentFormats.meshopt=!0),n.includes("KHR_texture_basisu")&&(this.contentFormats.ktx2=!0)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(n2).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(n2).decrementCount()}_addTileToCache(t){this._cache.add(this,t,e=>e._updateCacheStats(t))}_updateCacheStats(t){this.stats.get(JF).incrementCount(),this.stats.get(r2).incrementCount(),this.gpuMemoryUsageInBytes+=t.gpuMemoryUsageInBytes||0,this.stats.get(i2).count=this.gpuMemoryUsageInBytes}_unloadTile(t){this.gpuMemoryUsageInBytes-=t.gpuMemoryUsageInBytes||0,this.stats.get(r2).decrementCount(),this.stats.get(YF).incrementCount(),this.stats.get(i2).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(t),t.unloadContent()}_destroy(){const t=[];for(this.root&&t.push(this.root);t.length>0;){const e=t.pop();for(const n of e.children)t.push(n);this._destroyTile(e)}this.root=null}_destroySubtree(t){const e=t,n=[];for(n.push(e);n.length>0;){t=n.pop();for(const i of t.children)n.push(i);t!==e&&this._destroyTile(t)}e.children=[]}_destroyTile(t){this._cache.unloadTile(this,t),this._unloadTile(t),t.destroy()}_initializeTiles3DTileset(t){if(t.queryString){const e=new URLSearchParams(t.queryString),n=Object.fromEntries(e.entries());this._queryParams={...this._queryParams,...n}}if(this.asset=t.asset,!this.asset)throw new Error("Tileset must have an asset property.");if(this.asset.version!=="0.0"&&this.asset.version!=="1.0")throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=t.properties,this.geometricError=t.geometricError,this._extensionsUsed=t.extensionsUsed||[],this.extras=t.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}const eL="3.4.15",Og={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"};function rL(r,t,e){ui(r instanceof ArrayBuffer);const n=new TextDecoder("utf8"),i=new Uint8Array(r,t,e);return n.decode(i)}function _tt(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const e=new DataView(r);return"".concat(String.fromCharCode(e.getUint8(t+0))).concat(String.fromCharCode(e.getUint8(t+1))).concat(String.fromCharCode(e.getUint8(t+2))).concat(String.fromCharCode(e.getUint8(t+3)))}const vtt={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},os={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},Ln={...vtt,...os},s2={[os.DOUBLE]:Float64Array,[os.FLOAT]:Float32Array,[os.UNSIGNED_SHORT]:Uint16Array,[os.UNSIGNED_INT]:Uint32Array,[os.UNSIGNED_BYTE]:Uint8Array,[os.BYTE]:Int8Array,[os.SHORT]:Int16Array,[os.INT]:Int32Array},btt={DOUBLE:os.DOUBLE,FLOAT:os.FLOAT,UNSIGNED_SHORT:os.UNSIGNED_SHORT,UNSIGNED_INT:os.UNSIGNED_INT,UNSIGNED_BYTE:os.UNSIGNED_BYTE,BYTE:os.BYTE,SHORT:os.SHORT,INT:os.INT},o2="Failed to convert GL type";class jc{static fromTypedArray(t){t=ArrayBuffer.isView(t)?t.constructor:t;for(const e in s2)if(s2[e]===t)return e;throw new Error(o2)}static fromName(t){const e=btt[t];if(!e)throw new Error(o2);return e}static getArrayType(t){switch(t){case os.UNSIGNED_SHORT_5_6_5:case os.UNSIGNED_SHORT_4_4_4_4:case os.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const e=s2[t];if(!e)throw new Error(o2);return e}}static getByteSize(t){return jc.getArrayType(t).BYTES_PER_ELEMENT}static validate(t){return!!jc.getArrayType(t)}static createTypedArray(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;i===void 0&&(i=(e.byteLength-n)/jc.getByteSize(t));const s=jc.getArrayType(t);return new s(e,n,i)}}function wtt(r,t){if(!r)throw new Error("math.gl assertion failed. ".concat(t))}function xtt(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const e=r>>11&31,n=r>>5&63,i=r&31;return t[0]=e<<3,t[1]=n<<2,t[2]=i<<3,t}new Ib,new se,new Ib,new Ib;function nL(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:255;return Nu(r,0,t)/t*2-1}function iL(r){return r<0?-1:1}function Btt(r,t,e,n){if(wtt(n),r<0||r>e||t<0||t>e)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(e));if(n.x=nL(r,e),n.y=nL(t,e),n.z=1-(Math.abs(n.x)+Math.abs(n.y)),n.z<0){const i=n.x;n.x=(1-Math.abs(n.y))*iL(i),n.y=(1-Math.abs(i))*iL(n.y)}return n.normalize()}function Ctt(r,t,e){return Btt(r,t,255,e)}class a2{constructor(t,e){j(this,"json",void 0),j(this,"buffer",void 0),j(this,"featuresLength",0),j(this,"_cachedTypedArrays",{}),this.json=t,this.buffer=e}getExtension(t){return this.json.extensions&&this.json.extensions[t]}hasProperty(t){return!!this.json[t]}getGlobalProperty(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ln.UNSIGNED_INT,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=this.json[t];return i&&Number.isFinite(i.byteOffset)?this._getTypedArrayFromBinary(t,e,n,1,i.byteOffset):i}getPropertyArray(t,e,n){const i=this.json[t];return i&&Number.isFinite(i.byteOffset)?("componentType"in i&&(e=jc.fromName(i.componentType)),this._getTypedArrayFromBinary(t,e,n,this.featuresLength,i.byteOffset)):this._getTypedArrayFromArray(t,e,i)}getProperty(t,e,n,i,s){const a=this.json[t];if(!a)return a;const o=this.getPropertyArray(t,e,n);if(n===1)return o[i];for(let d=0;d<n;++d)s[d]=o[n*i+d];return s}_getTypedArrayFromBinary(t,e,n,i,s){const a=this._cachedTypedArrays;let o=a[t];return o||(o=jc.createTypedArray(e,this.buffer.buffer,this.buffer.byteOffset+s,i*n),a[t]=o),o}_getTypedArrayFromArray(t,e,n){const i=this._cachedTypedArrays;let s=i[t];return s||(s=jc.createTypedArray(e,n),i[t]=s),s}}const Ett={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Stt={SCALAR:(r,t)=>r[t],VEC2:(r,t)=>[r[2*t+0],r[2*t+1]],VEC3:(r,t)=>[r[3*t+0],r[3*t+1],r[3*t+2]],VEC4:(r,t)=>[r[4*t+0],r[4*t+1],r[4*t+2],r[4*t+3]],MAT2:(r,t)=>[r[4*t+0],r[4*t+1],r[4*t+2],r[4*t+3]],MAT3:(r,t)=>[r[9*t+0],r[9*t+1],r[9*t+2],r[9*t+3],r[9*t+4],r[9*t+5],r[9*t+6],r[9*t+7],r[9*t+8]],MAT4:(r,t)=>[r[16*t+0],r[16*t+1],r[16*t+2],r[16*t+3],r[16*t+4],r[16*t+5],r[16*t+6],r[16*t+7],r[16*t+8],r[16*t+9],r[16*t+10],r[16*t+11],r[16*t+12],r[16*t+13],r[16*t+14],r[16*t+15]]},Ttt={SCALAR:(r,t,e)=>{t[e]=r},VEC2:(r,t,e)=>{t[2*e+0]=r[0],t[2*e+1]=r[1]},VEC3:(r,t,e)=>{t[3*e+0]=r[0],t[3*e+1]=r[1],t[3*e+2]=r[2]},VEC4:(r,t,e)=>{t[4*e+0]=r[0],t[4*e+1]=r[1],t[4*e+2]=r[2],t[4*e+3]=r[3]},MAT2:(r,t,e)=>{t[4*e+0]=r[0],t[4*e+1]=r[1],t[4*e+2]=r[2],t[4*e+3]=r[3]},MAT3:(r,t,e)=>{t[9*e+0]=r[0],t[9*e+1]=r[1],t[9*e+2]=r[2],t[9*e+3]=r[3],t[9*e+4]=r[4],t[9*e+5]=r[5],t[9*e+6]=r[6],t[9*e+7]=r[7],t[9*e+8]=r[8],t[9*e+9]=r[9]},MAT4:(r,t,e)=>{t[16*e+0]=r[0],t[16*e+1]=r[1],t[16*e+2]=r[2],t[16*e+3]=r[3],t[16*e+4]=r[4],t[16*e+5]=r[5],t[16*e+6]=r[6],t[16*e+7]=r[7],t[16*e+8]=r[8],t[16*e+9]=r[9],t[16*e+10]=r[10],t[16*e+11]=r[11],t[16*e+12]=r[12],t[16*e+13]=r[13],t[16*e+14]=r[14],t[16*e+15]=r[15]}};function Itt(r,t,e,n){const{componentType:i}=r;ui(r.componentType);const s=typeof i=="string"?jc.fromName(i):i,a=Ett[r.type],o=Stt[r.type],d=Ttt[r.type];return e+=r.byteOffset,{values:jc.createTypedArray(s,t,e,a*n),type:s,size:a,unpacker:o,packer:d}}const qc=r=>r!==void 0;function Ftt(r,t,e){if(!t)return null;let n=r.getExtension("3DTILES_batch_table_hierarchy");const i=t.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),t.extensions=t.extensions||{},t.extensions["3DTILES_batch_table_hierarchy"]=i,n=i),n?Ltt(n,e):null}function Ltt(r,t){let e,n,i;const s=r.instancesLength,a=r.classes;let o=r.classIds,d=r.parentCounts,p=r.parentIds,y=s;qc(o.byteOffset)&&(o.componentType=defaultValue(o.componentType,GL.UNSIGNED_SHORT),o.type=AttributeType.SCALAR,i=getBinaryAccessor(o),o=i.createArrayBufferView(t.buffer,t.byteOffset+o.byteOffset,s));let b;if(qc(d))for(qc(d.byteOffset)&&(d.componentType=defaultValue(d.componentType,GL.UNSIGNED_SHORT),d.type=AttributeType.SCALAR,i=getBinaryAccessor(d),d=i.createArrayBufferView(t.buffer,t.byteOffset+d.byteOffset,s)),b=new Uint16Array(s),y=0,e=0;e<s;++e)b[e]=y,y+=d[e];qc(p)&&qc(p.byteOffset)&&(p.componentType=defaultValue(p.componentType,GL.UNSIGNED_SHORT),p.type=AttributeType.SCALAR,i=getBinaryAccessor(p),p=i.createArrayBufferView(t.buffer,t.byteOffset+p.byteOffset,y));const x=a.length;for(e=0;e<x;++e){const k=a[e].length,z=a[e].instances,V=getBinaryProperties(k,z,t);a[e].instances=combine(V,z)}const C=new Array(x).fill(0),P=new Uint16Array(s);for(e=0;e<s;++e)n=o[e],P[e]=C[n],++C[n];const M={classes:a,classIds:o,classIndexes:P,parentCounts:d,parentIndexes:b,parentIds:p};return Utt(M),M}function Dg(r,t,e){if(!r)return;const n=r.parentCounts;return r.parentIds?e(r,t):n>0?Ptt(r,t,e):Mtt(r,t,e)}function Ptt(r,t,e){const n=r.classIds,i=r.parentCounts,s=r.parentIds,a=r.parentIndexes,o=n.length,d=scratchVisited;d.length=Math.max(d.length,o);const p=++marker,y=scratchStack;for(y.length=0,y.push(t);y.length>0;){if(t=y.pop(),d[t]===p)continue;d[t]=p;const b=e(r,t);if(qc(b))return b;const x=i[t],C=a[t];for(let P=0;P<x;++P){const M=s[C+P];M!==t&&y.push(M)}}return null}function Mtt(r,t,e){let n=!0;for(;n;){const i=e(r,t);if(qc(i))return i;const s=r.parentIds[t];n=s!==t,t=s}throw new Error("traverseHierarchySingleParent")}function Utt(r){const e=r.classIds.length;for(let n=0;n<e;++n)sL(r,n,stack)}function sL(r,t,e){const n=r.parentCounts,i=r.parentIds,s=r.parentIndexes,o=r.classIds.length;if(!qc(i))return;assert(t<o,"Parent index ".concat(t," exceeds the total number of instances: ").concat(o)),assert(e.indexOf(t)===-1,"Circular dependency detected in the batch table hierarchy."),e.push(t);const d=qc(n)?n[t]:1,p=qc(n)?s[t]:t;for(let y=0;y<d;++y){const b=i[p+y];b!==t&&sL(r,b,e)}e.pop(t)}function ia(r){return r!=null}const Ty=(r,t)=>r,Rtt={HIERARCHY:!0,extensions:!0,extras:!0};class oL{constructor(t,e,n){var i;let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};j(this,"json",void 0),j(this,"binary",void 0),j(this,"featureCount",void 0),j(this,"_extensions",void 0),j(this,"_properties",void 0),j(this,"_binaryProperties",void 0),j(this,"_hierarchy",void 0),ui(n>=0),this.json=t||{},this.binary=e,this.featureCount=n,this._extensions=((i=this.json)===null||i===void 0?void 0:i.extensions)||{},this._properties={};for(const a in this.json)Rtt[a]||(this._properties[a]=this.json[a]);this._binaryProperties=this._initializeBinaryProperties(),s["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=Ftt(this,this.json,this.binary))}getExtension(t){return this.json&&this.json.extensions&&this.json.extensions[t]}memorySizeInBytes(){return 0}isClass(t,e){if(this._checkBatchId(t),ui(typeof e=="string",e),this._hierarchy){const n=Dg(this._hierarchy,t,(i,s)=>{const a=i.classIds[s];return i.classes[a].name===e});return ia(n)}return!1}isExactClass(t,e){return ui(typeof e=="string",e),this.getExactClassName(t)===e}getExactClassName(t){if(this._checkBatchId(t),this._hierarchy){const e=this._hierarchy.classIds[t];return this._hierarchy.classes[e].name}}hasProperty(t,e){return this._checkBatchId(t),ui(typeof e=="string",e),ia(this._properties[e])||this._hasPropertyInHierarchy(t,e)}getPropertyNames(t,e){this._checkBatchId(t),e=ia(e)?e:[],e.length=0;const n=Object.keys(this._properties);return e.push(...n),this._hierarchy&&this._getPropertyNamesInHierarchy(t,e),e}getProperty(t,e){if(this._checkBatchId(t),ui(typeof e=="string",e),this._binaryProperties){const i=this._binaryProperties[e];if(ia(i))return this._getBinaryProperty(i,t)}const n=this._properties[e];if(ia(n))return Ty(n[t]);if(this._hierarchy){const i=this._getHierarchyProperty(t,e);if(ia(i))return i}}setProperty(t,e,n){const i=this.featureCount;if(this._checkBatchId(t),ui(typeof e=="string",e),this._binaryProperties){const a=this._binaryProperties[e];if(a){this._setBinaryProperty(a,t,n);return}}if(this._hierarchy&&this._setHierarchyProperty(this,t,e,n))return;let s=this._properties[e];ia(s)||(this._properties[e]=new Array(i),s=this._properties[e]),s[t]=Ty(n)}_checkBatchId(t){if(!(t>=0&&t<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(t,e){return t.unpack(t.typedArray,e)}_setBinaryProperty(t,e,n){t.pack(n,t.typedArray,e)}_initializeBinaryProperties(){let t=null;for(const e in this._properties){const n=this._properties[e],i=this._initializeBinaryProperty(e,n);i&&(t=t||{},t[e]=i)}return t}_initializeBinaryProperty(t,e){if("byteOffset"in e){const n=e;ui(this.binary,"Property ".concat(t," requires a batch table binary.")),ui(n.type,"Property ".concat(t," requires a type."));const i=Itt(n,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:i.values,componentCount:i.size,unpack:i.unpacker,pack:i.packer}}return null}_hasPropertyInHierarchy(t,e){if(!this._hierarchy)return!1;const n=Dg(this._hierarchy,t,(i,s)=>{const a=i.classIds[s],o=i.classes[a].instances;return ia(o[e])});return ia(n)}_getPropertyNamesInHierarchy(t,e){Dg(this._hierarchy,t,(n,i)=>{const s=n.classIds[i],a=n.classes[s].instances;for(const o in a)a.hasOwnProperty(o)&&e.indexOf(o)===-1&&e.push(o)})}_getHierarchyProperty(t,e){return Dg(this._hierarchy,t,(n,i)=>{const s=n.classIds[i],a=n.classes[s],o=n.classIndexes[i],d=a.instances[e];return ia(d)?ia(d.typedArray)?this._getBinaryProperty(d,o):Ty(d[o]):null})}_setHierarchyProperty(t,e,n,i){const s=Dg(this._hierarchy,e,(a,o)=>{const d=a.classIds[o],p=a.classes[d],y=a.classIndexes[o],b=p.instances[n];return ia(b)?(ui(o===e,'Inherited property "'.concat(n,'" is read-only.')),ia(b.typedArray)?this._setBinaryProperty(b,y,i):b[y]=Ty(i),!0):!1});return ia(s)}}const l2=4;function Iy(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const n=new DataView(t);if(r.magic=n.getUint32(e,!0),e+=l2,r.version=n.getUint32(e,!0),e+=l2,r.byteLength=n.getUint32(e,!0),e+=l2,r.version!==1)throw new Error("3D Tile Version ".concat(r.version," not supported"));return e}const Ef=4,aL="b3dm tile in legacy format.";function c2(r,t,e){const n=new DataView(t);let i;r.header=r.header||{};let s=n.getUint32(e,!0);e+=Ef;let a=n.getUint32(e,!0);e+=Ef;let o=n.getUint32(e,!0);e+=Ef;let d=n.getUint32(e,!0);return e+=Ef,o>=570425344?(e-=Ef*2,i=s,o=a,d=0,s=0,a=0,console.warn(aL)):d>=570425344&&(e-=Ef,i=o,o=s,d=a,s=0,a=0,console.warn(aL)),r.header.featureTableJsonByteLength=s,r.header.featureTableBinaryByteLength=a,r.header.batchTableJsonByteLength=o,r.header.batchTableBinaryByteLength=d,r.header.batchLength=i,e}function u2(r,t,e,n){return e=Ott(r,t,e),e=Dtt(r,t,e),e}function Ott(r,t,e,n){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:s,batchLength:a}=r.header;if(r.featureTableJson={BATCH_LENGTH:a||0},i>0){const o=rL(t,e,i);r.featureTableJson=JSON.parse(o)}return e+=i,r.featureTableBinary=new Uint8Array(t,e,s),e+=s,e}function Dtt(r,t,e,n){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:s}=r.header;if(i>0){const a=rL(t,e,i);r.batchTableJson=JSON.parse(a),e+=i,s>0&&(r.batchTableBinary=new Uint8Array(t,e,s),r.batchTableBinary=new Uint8Array(r.batchTableBinary),e+=s)}return e}function lL(r,t,e){if(!t&&(!r||!r.batchIds||!e))return null;const{batchIds:n,isRGB565:i,pointCount:s}=r;if(n&&e){const a=new Uint8ClampedArray(s*3);for(let o=0;o<s;o++){const d=n[o],y=e.getProperty(d,"dimensions").map(b=>b*255);a[o*3]=y[0],a[o*3+1]=y[1],a[o*3+2]=y[2]}return{type:Ln.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}if(i){const a=new Uint8ClampedArray(s*3);for(let o=0;o<s;o++){const d=xtt(t[o]);a[o*3]=d[0],a[o*3+1]=d[1],a[o*3+2]=d[2]}return{type:Ln.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}return t&&t.length===s*3?{type:Ln.UNSIGNED_BYTE,value:t,size:3,normalized:!0}:{type:Ln.UNSIGNED_BYTE,value:t,size:4,normalized:!0}}const cL=new se;function Ntt(r,t){if(!t)return null;if(r.isOctEncoded16P){const e=new Float32Array(r.pointsLength*3);for(let n=0;n<r.pointsLength;n++)Ctt(t[n*2],t[n*2+1],cL),cL.toArray(e,n*3);return{type:Ln.FLOAT,size:2,value:e}}return{type:Ln.FLOAT,size:2,value:t}}function ktt(r,t,e){return r.isQuantized?e["3d-tiles"]&&e["3d-tiles"].decodeQuantizedPositions?(r.isQuantized=!1,Qtt(r,t)):{type:Ln.UNSIGNED_SHORT,value:t,size:3,normalized:!0}:t}function Qtt(r,t){const e=new se,n=new Float32Array(r.pointCount*3);for(let i=0;i<r.pointCount;i++)e.set(t[i*3],t[i*3+1],t[i*3+2]).scale(1/r.quantizedRange).multiply(r.quantizedVolumeScale).add(r.quantizedVolumeOffset).toArray(n,i*3);return n}async function ztt(r,t,e,n,i){e=Iy(r,t,e),e=c2(r,t,e),e=u2(r,t,e),Htt(r);const{featureTable:s,batchTable:a}=Vtt(r);return await $tt(r,s,a,n,i),Gtt(r,s,n),jtt(r,s,a),qtt(r,s),e}function Htt(r){r.attributes={positions:null,colors:null,normals:null,batchIds:null},r.isQuantized=!1,r.isTranslucent=!1,r.isRGB565=!1,r.isOctEncoded16P=!1}function Vtt(r){const t=new a2(r.featureTableJson,r.featureTableBinary),e=t.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(e))throw new Error("POINTS_LENGTH must be defined");t.featuresLength=e,r.featuresLength=e,r.pointsLength=e,r.pointCount=e,r.rtcCenter=t.getGlobalProperty("RTC_CENTER",Ln.FLOAT,3);const n=Ktt(r,t);return{featureTable:t,batchTable:n}}function Gtt(r,t,e){if(!r.attributes.positions){if(t.hasProperty("POSITION"))r.attributes.positions=t.getPropertyArray("POSITION",Ln.FLOAT,3);else if(t.hasProperty("POSITION_QUANTIZED")){const n=t.getPropertyArray("POSITION_QUANTIZED",Ln.UNSIGNED_SHORT,3);if(r.isQuantized=!0,r.quantizedRange=65535,r.quantizedVolumeScale=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Ln.FLOAT,3),!r.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(r.quantizedVolumeOffset=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Ln.FLOAT,3),!r.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");r.attributes.positions=ktt(r,n,e)}}if(!r.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function jtt(r,t,e){if(!r.attributes.colors){let n=null;t.hasProperty("RGBA")?(n=t.getPropertyArray("RGBA",Ln.UNSIGNED_BYTE,4),r.isTranslucent=!0):t.hasProperty("RGB")?n=t.getPropertyArray("RGB",Ln.UNSIGNED_BYTE,3):t.hasProperty("RGB565")&&(n=t.getPropertyArray("RGB565",Ln.UNSIGNED_SHORT,1),r.isRGB565=!0),r.attributes.colors=lL(r,n,e)}t.hasProperty("CONSTANT_RGBA")&&(r.constantRGBA=t.getGlobalProperty("CONSTANT_RGBA",Ln.UNSIGNED_BYTE,4))}function qtt(r,t){if(!r.attributes.normals){let e=null;t.hasProperty("NORMAL")?e=t.getPropertyArray("NORMAL",Ln.FLOAT,3):t.hasProperty("NORMAL_OCT16P")&&(e=t.getPropertyArray("NORMAL_OCT16P",Ln.UNSIGNED_BYTE,2),r.isOctEncoded16P=!0),r.attributes.normals=Ntt(r,e)}}function Ktt(r,t){let e=null;if(!r.batchIds&&t.hasProperty("BATCH_ID")&&(r.batchIds=t.getPropertyArray("BATCH_ID",Ln.UNSIGNED_SHORT,1),r.batchIds)){const n=t.getGlobalProperty("BATCH_LENGTH");if(!n)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:s}=r;e=new oL(i,s,n)}return e}async function $tt(r,t,e,n,i){let s,a,o;const d=r.batchTableJson&&r.batchTableJson.extensions&&r.batchTableJson.extensions["3DTILES_draco_point_compression"];d&&(o=d.properties);const p=t.getExtension("3DTILES_draco_point_compression");if(p){a=p.properties;const b=p.byteOffset,x=p.byteLength;if(!a||!Number.isFinite(b)||!x)throw new Error("Draco properties, byteOffset, and byteLength must be defined");s=r.featureTableBinary.slice(b,b+x),r.hasPositions=Number.isFinite(a.POSITION),r.hasColors=Number.isFinite(a.RGB)||Number.isFinite(a.RGBA),r.hasNormals=Number.isFinite(a.NORMAL),r.hasBatchIds=Number.isFinite(a.BATCH_ID),r.isTranslucent=Number.isFinite(a.RGBA)}if(!s)return!0;const y={buffer:s,properties:{...a,...o},featureTableProperties:a,batchTableProperties:o,dequantizeInShader:!1};return await Wtt(r,y,n,i)}async function Wtt(r,t,e,n){const{parse:i}=n,s={...e,draco:{...e.draco,extraAttributes:t.batchTableProperties||{}}};delete s["3d-tiles"];const a=await i(t.buffer,wF,s),o=a.attributes.POSITION&&a.attributes.POSITION.value,d=a.attributes.COLOR_0&&a.attributes.COLOR_0.value,p=a.attributes.NORMAL&&a.attributes.NORMAL.value,y=a.attributes.BATCH_ID&&a.attributes.BATCH_ID.value,b=o&&a.attributes.POSITION.value.quantization,x=p&&a.attributes.NORMAL.value.quantization;if(b){const P=a.POSITION.data.quantization,M=P.range;r.quantizedVolumeScale=new se(M,M,M),r.quantizedVolumeOffset=new se(P.minValues),r.quantizedRange=(1<<P.quantizationBits)-1,r.isQuantizedDraco=!0}x&&(r.octEncodedRange=(1<<a.NORMAL.data.quantization.quantizationBits)-1,r.isOctEncodedDraco=!0);const C={};if(t.batchTableProperties)for(const P of Object.keys(t.batchTableProperties))a.attributes[P]&&a.attributes[P].value&&(C[P.toLowerCase()]=a.attributes[P].value);r.attributes={positions:o,colors:lL(r,d,void 0),normals:p,batchIds:y,...C}}const A2={URI:0,EMBEDDED:1};function uL(r,t,e,n){r.rotateYtoZ=!0;const i=r.byteOffset+r.byteLength-e;if(i===0)throw new Error("glTF byte length must be greater than 0.");return r.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y",r.gltfArrayBuffer=Mv(t,e,i),r.gltfByteOffset=0,r.gltfByteLength=i,e%4===0||console.warn("".concat(r.type,": embedded glb is not aligned to a 4-byte boundary.")),r.byteOffset+r.byteLength}async function AL(r,t,e,n){const i=e["3d-tiles"]||{};if(Xtt(r,t),i.loadGLTF){const{parse:s,fetch:a}=n;r.gltfUrl&&(r.gltfArrayBuffer=await a(r.gltfUrl,e),r.gltfByteOffset=0),r.gltfArrayBuffer&&(r.gltf=await s(r.gltfArrayBuffer,Ug,e,n),r.gpuMemoryUsageInBytes=yF(r.gltf),delete r.gltfArrayBuffer,delete r.gltfByteOffset,delete r.gltfByteLength)}}function Xtt(r,t,e){switch(t){case A2.URI:const n=new Uint8Array(r.gltfArrayBuffer,r.gltfByteOffset),s=new TextDecoder().decode(n);r.gltfUrl=s.replace(/[\s\0]+$/,""),delete r.gltfArrayBuffer,delete r.gltfByteOffset,delete r.gltfByteLength;break;case A2.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function Jtt(r,t,e,n,i){var s;e=Ytt(r,t,e,n),await AL(r,A2.EMBEDDED,n,i);const a=r==null||(s=r.gltf)===null||s===void 0?void 0:s.extensions;return a&&a.CESIUM_RTC&&(r.rtcCenter=a.CESIUM_RTC.center),e}function Ytt(r,t,e,n,i){e=Iy(r,t,e),e=c2(r,t,e),e=u2(r,t,e),e=uL(r,t,e,n);const s=new a2(r.featureTableJson,r.featureTableBinary);return r.rtcCenter=s.getGlobalProperty("RTC_CENTER",Ln.FLOAT,3),e}async function Ztt(r,t,e,n,i){return e=tet(r,t,e,n),await AL(r,r.gltfFormat,n,i),e}function tet(r,t,e,n,i){if(e=Iy(r,t,e),r.version!==1)throw new Error("Instanced 3D Model version ".concat(r.version," is not supported"));e=c2(r,t,e);const s=new DataView(t);if(r.gltfFormat=s.getUint32(e,!0),e+=4,e=u2(r,t,e),e=uL(r,t,e,n),r.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const a=new a2(r.featureTableJson,r.featureTableBinary),o=a.getGlobalProperty("INSTANCES_LENGTH");if(a.featuresLength=o,!Number.isFinite(o))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");r.eastNorthUp=a.getGlobalProperty("EAST_NORTH_UP"),r.rtcCenter=a.getGlobalProperty("RTC_CENTER",Ln.FLOAT,3);const d=new oL(r.batchTableJson,r.batchTableBinary,o);return eet(r,a,d,o),e}function eet(r,t,e,n){const s={instances:new Array(n),batchTable:r._batchTable,cull:!1,url:void 0,gltf:void 0,basePath:void 0,incrementallyLoadTextures:!1,forwardAxis:[1,0,0]}.instances,a=new se;new se,new se,new se;const o=new Di,d=new fg,p=new se,y={},b=new wn,x=[],C=[],P=new se,M=new se;for(let k=0;k<n;k++){let z;if(t.hasProperty("POSITION"))z=t.getProperty("POSITION",Ln.FLOAT,3,k,a);else if(t.hasProperty("POSITION_QUANTIZED")){z=t.getProperty("POSITION_QUANTIZED",Ln.UNSIGNED_SHORT,3,k,a);const mt=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Ln.FLOAT,3,P);if(!mt)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const dt=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Ln.FLOAT,3,M);if(!dt)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const Ft=65535;for(let Tt=0;Tt<3;Tt++)z[Tt]=z[Tt]/Ft*dt[Tt]+mt[Tt]}if(!z)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");if(a.copy(z),y.translation=a,r.normalUp=t.getProperty("NORMAL_UP",Ln.FLOAT,3,k,x),r.normalRight=t.getProperty("NORMAL_RIGHT",Ln.FLOAT,3,k,C),r.normalUp){if(!r.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");r.hasCustomOrientation=!0}else{if(r.octNormalUp=t.getProperty("NORMAL_UP_OCT32P",Ln.UNSIGNED_SHORT,2,x),r.octNormalRight=t.getProperty("NORMAL_RIGHT_OCT32P",Ln.UNSIGNED_SHORT,2,C),r.octNormalUp)throw r.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");r.eastNorthUp?(Mi.WGS84.eastNorthUpToFixedFrame(a,b),b.getRotationMatrix3(o)):o.identity()}d.fromMatrix3(o),y.rotation=d,p.set(1,1,1);const V=t.getProperty("SCALE",Ln.FLOAT,1,k);Number.isFinite(V)&&p.multiplyByScalar(V);const $=t.getProperty("SCALE_NON_UNIFORM",Ln.FLOAT,3,k,x);$&&p.scale($),y.scale=p;let tt=t.getProperty("BATCH_ID",Ln.UNSIGNED_SHORT,1,k);tt===void 0&&(tt=k);const pt=new wn().fromQuaternion(y.rotation);b.identity(),b.translate(y.translation),b.multiplyRight(pt),b.scale(y.scale);const gt=b.clone();s[k]={modelMatrix:gt,batchId:tt}}r.instances=s}async function ret(r,t,e,n,i,s){e=Iy(r,t,e);const a=new DataView(t);for(r.tilesLength=a.getUint32(e,!0),e+=4,r.tiles=[];r.tiles.length<r.tilesLength&&r.byteLength-e>12;){const o={};r.tiles.push(o),e=await s(t,e,n,i,o)}return e}async function net(r,t,e,n){r.rotateYtoZ=!0,r.gltfUpAxis=e["3d-tiles"]&&e["3d-tiles"].assetGltfUpAxis?e["3d-tiles"].assetGltfUpAxis:"Y";const{parse:i}=n;r.gltf=await i(t,Ug,e,n),r.gpuMemoryUsageInBytes=yF(r.gltf)}async function hL(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};switch(i.byteOffset=t,i.type=_tt(r,t),i.type){case Og.COMPOSITE:return await ret(i,r,t,e,n,hL);case Og.BATCHED_3D_MODEL:return await Jtt(i,r,t,e,n);case Og.GLTF:return await net(i,r,e,n);case Og.INSTANCED_3D_MODEL:return await Ztt(i,r,t,e,n);case Og.POINT_CLOUD:return await ztt(i,r,t,e,n);default:throw new Error("3DTileLoader: unknown type ".concat(i.type))}}const iet=1952609651,set=1;async function oet(r,t,e){if(new Uint32Array(r.slice(0,4))[0]!==iet)throw new Error("Wrong subtree file magic number");if(new Uint32Array(r.slice(4,8))[0]!==set)throw new Error("Wrong subtree file verson, must be 1");const s=dL(r.slice(8,16)),a=new Uint8Array(r,24,s),d=new TextDecoder("utf8").decode(a),p=JSON.parse(d),y=dL(r.slice(16,24));let b=new ArrayBuffer(0);return y&&(b=r.slice(24+s)),"bufferView"in p.tileAvailability&&(p.tileAvailability.explicitBitstream=await h2(p,"tileAvailability",b,e)),"bufferView"in p.contentAvailability&&(p.contentAvailability.explicitBitstream=await h2(p,"contentAvailability",b,e)),"bufferView"in p.childSubtreeAvailability&&(p.childSubtreeAvailability.explicitBitstream=await h2(p,"childSubtreeAvailability",b,e)),p}function aet(r,t){if(t.startsWith("http")){const s=new URL(r,t);return decodeURI(s.toString())}const n="http://".concat(t),i=new URL(r,n);return"/".concat(i.host).concat(i.pathname)}async function h2(r,t,e,n){const i=r[t].bufferView,s=r.bufferViews[i],a=r.buffers[s.buffer];if(!(n!=null&&n.url)||!n.fetch)throw new Error("Url is not provided");if(!n.fetch)throw new Error("fetch is not provided");if(a.uri){const o=aet(a.uri,n==null?void 0:n.url),p=await(await n.fetch(o)).arrayBuffer();return new Uint8Array(p,s.byteOffset,s.byteLength)}return new Uint8Array(e,s.byteOffset,s.byteLength)}function dL(r){const t=new DataView(r),e=t.getUint32(0,!0),n=t.getUint32(4,!0);return e+2**32*n}const fL={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:eL,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:oet,options:{}};/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var ul=null;try{ul=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Yn(r,t,e){this.low=r|0,this.high=t|0,this.unsigned=!!e}Yn.prototype.__isLong__,Object.defineProperty(Yn.prototype,"__isLong__",{value:!0});function co(r){return(r&&r.__isLong__)===!0}function pL(r){var t=Math.clz32(r&-r);return r?31-t:t}Yn.isLong=co;var gL={},mL={};function Jh(r,t){var e,n,i;return t?(r>>>=0,(i=0<=r&&r<256)&&(n=mL[r],n)?n:(e=Rn(r,0,!0),i&&(mL[r]=e),e)):(r|=0,(i=-128<=r&&r<128)&&(n=gL[r],n)?n:(e=Rn(r,r<0?-1:0,!1),i&&(gL[r]=e),e))}Yn.fromInt=Jh;function Al(r,t){if(isNaN(r))return t?Hu:rc;if(t){if(r<0)return Hu;if(r>=_L)return BL}else{if(r<=-vL)return sa;if(r+1>=vL)return xL}return r<0?Al(-r,t).neg():Rn(r%Sf|0,r/Sf|0,t)}Yn.fromNumber=Al;function Rn(r,t,e){return new Yn(r,t,e)}Yn.fromBits=Rn;var Fy=Math.pow;function d2(r,t,e){if(r.length===0)throw Error("empty string");if(typeof t=="number"?(e=t,t=!1):t=!!t,r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return t?Hu:rc;if(e=e||10,e<2||36<e)throw RangeError("radix");var n;if((n=r.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return d2(r.substring(1),t,e).neg();for(var i=Al(Fy(e,8)),s=rc,a=0;a<r.length;a+=8){var o=Math.min(8,r.length-a),d=parseInt(r.substring(a,a+o),e);if(o<8){var p=Al(Fy(e,o));s=s.mul(p).add(Al(d))}else s=s.mul(i),s=s.add(Al(d))}return s.unsigned=t,s}Yn.fromString=d2;function ec(r,t){return typeof r=="number"?Al(r,t):typeof r=="string"?d2(r,t):Rn(r.low,r.high,typeof t=="boolean"?t:r.unsigned)}Yn.fromValue=ec;var yL=65536,cet=1<<24,Sf=yL*yL,_L=Sf*Sf,vL=_L/2,bL=Jh(cet),rc=Jh(0);Yn.ZERO=rc;var Hu=Jh(0,!0);Yn.UZERO=Hu;var Tf=Jh(1);Yn.ONE=Tf;var wL=Jh(1,!0);Yn.UONE=wL;var f2=Jh(-1);Yn.NEG_ONE=f2;var xL=Rn(-1,2147483647,!1);Yn.MAX_VALUE=xL;var BL=Rn(-1,-1,!0);Yn.MAX_UNSIGNED_VALUE=BL;var sa=Rn(0,-2147483648,!1);Yn.MIN_VALUE=sa;var ze=Yn.prototype;ze.toInt=function(){return this.unsigned?this.low>>>0:this.low},ze.toNumber=function(){return this.unsigned?(this.high>>>0)*Sf+(this.low>>>0):this.high*Sf+(this.low>>>0)},ze.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(sa)){var e=Al(t),n=this.div(e),i=n.mul(e).sub(this);return n.toString(t)+i.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var s=Al(Fy(t,6),this.unsigned),a=this,o="";;){var d=a.div(s),p=a.sub(d.mul(s)).toInt()>>>0,y=p.toString(t);if(a=d,a.isZero())return y+o;for(;y.length<6;)y="0"+y;o=""+y+o}},ze.getHighBits=function(){return this.high},ze.getHighBitsUnsigned=function(){return this.high>>>0},ze.getLowBits=function(){return this.low},ze.getLowBitsUnsigned=function(){return this.low>>>0},ze.getNumBitsAbs=function(){if(this.isNegative())return this.eq(sa)?64:this.neg().getNumBitsAbs();for(var t=this.high!=0?this.high:this.low,e=31;e>0&&!(t&1<<e);e--);return this.high!=0?e+33:e+1},ze.isZero=function(){return this.high===0&&this.low===0},ze.eqz=ze.isZero,ze.isNegative=function(){return!this.unsigned&&this.high<0},ze.isPositive=function(){return this.unsigned||this.high>=0},ze.isOdd=function(){return(this.low&1)===1},ze.isEven=function(){return(this.low&1)===0},ze.equals=function(t){return co(t)||(t=ec(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low},ze.eq=ze.equals,ze.notEquals=function(t){return!this.eq(t)},ze.neq=ze.notEquals,ze.ne=ze.notEquals,ze.lessThan=function(t){return this.comp(t)<0},ze.lt=ze.lessThan,ze.lessThanOrEqual=function(t){return this.comp(t)<=0},ze.lte=ze.lessThanOrEqual,ze.le=ze.lessThanOrEqual,ze.greaterThan=function(t){return this.comp(t)>0},ze.gt=ze.greaterThan,ze.greaterThanOrEqual=function(t){return this.comp(t)>=0},ze.gte=ze.greaterThanOrEqual,ze.ge=ze.greaterThanOrEqual,ze.compare=function(t){if(co(t)||(t=ec(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},ze.comp=ze.compare,ze.negate=function(){return!this.unsigned&&this.eq(sa)?sa:this.not().add(Tf)},ze.neg=ze.negate,ze.add=function(t){co(t)||(t=ec(t));var e=this.high>>>16,n=this.high&65535,i=this.low>>>16,s=this.low&65535,a=t.high>>>16,o=t.high&65535,d=t.low>>>16,p=t.low&65535,y=0,b=0,x=0,C=0;return C+=s+p,x+=C>>>16,C&=65535,x+=i+d,b+=x>>>16,x&=65535,b+=n+o,y+=b>>>16,b&=65535,y+=e+a,y&=65535,Rn(x<<16|C,y<<16|b,this.unsigned)},ze.subtract=function(t){return co(t)||(t=ec(t)),this.add(t.neg())},ze.sub=ze.subtract,ze.multiply=function(t){if(this.isZero())return this;if(co(t)||(t=ec(t)),ul){var e=ul.mul(this.low,this.high,t.low,t.high);return Rn(e,ul.get_high(),this.unsigned)}if(t.isZero())return this.unsigned?Hu:rc;if(this.eq(sa))return t.isOdd()?sa:rc;if(t.eq(sa))return this.isOdd()?sa:rc;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(bL)&&t.lt(bL))return Al(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,i=this.high&65535,s=this.low>>>16,a=this.low&65535,o=t.high>>>16,d=t.high&65535,p=t.low>>>16,y=t.low&65535,b=0,x=0,C=0,P=0;return P+=a*y,C+=P>>>16,P&=65535,C+=s*y,x+=C>>>16,C&=65535,C+=a*p,x+=C>>>16,C&=65535,x+=i*y,b+=x>>>16,x&=65535,x+=s*p,b+=x>>>16,x&=65535,x+=a*d,b+=x>>>16,x&=65535,b+=n*y+i*p+s*d+a*o,b&=65535,Rn(C<<16|P,b<<16|x,this.unsigned)},ze.mul=ze.multiply,ze.divide=function(t){if(co(t)||(t=ec(t)),t.isZero())throw Error("division by zero");if(ul){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var e=(this.unsigned?ul.div_u:ul.div_s)(this.low,this.high,t.low,t.high);return Rn(e,ul.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Hu:rc;var n,i,s;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return Hu;if(t.gt(this.shru(1)))return wL;s=Hu}else{if(this.eq(sa)){if(t.eq(Tf)||t.eq(f2))return sa;if(t.eq(sa))return Tf;var a=this.shr(1);return n=a.div(t).shl(1),n.eq(rc)?t.isNegative()?Tf:f2:(i=this.sub(t.mul(n)),s=n.add(i.div(t)),s)}else if(t.eq(sa))return this.unsigned?Hu:rc;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();s=rc}for(i=this;i.gte(t);){n=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),d=o<=48?1:Fy(2,o-48),p=Al(n),y=p.mul(t);y.isNegative()||y.gt(i);)n-=d,p=Al(n,this.unsigned),y=p.mul(t);p.isZero()&&(p=Tf),s=s.add(p),i=i.sub(y)}return s},ze.div=ze.divide,ze.modulo=function(t){if(co(t)||(t=ec(t)),ul){var e=(this.unsigned?ul.rem_u:ul.rem_s)(this.low,this.high,t.low,t.high);return Rn(e,ul.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))},ze.mod=ze.modulo,ze.rem=ze.modulo,ze.not=function(){return Rn(~this.low,~this.high,this.unsigned)},ze.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},ze.clz=ze.countLeadingZeros,ze.countTrailingZeros=function(){return this.low?pL(this.low):pL(this.high)+32},ze.ctz=ze.countTrailingZeros,ze.and=function(t){return co(t)||(t=ec(t)),Rn(this.low&t.low,this.high&t.high,this.unsigned)},ze.or=function(t){return co(t)||(t=ec(t)),Rn(this.low|t.low,this.high|t.high,this.unsigned)},ze.xor=function(t){return co(t)||(t=ec(t)),Rn(this.low^t.low,this.high^t.high,this.unsigned)},ze.shiftLeft=function(t){return co(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?Rn(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):Rn(0,this.low<<t-32,this.unsigned)},ze.shl=ze.shiftLeft,ze.shiftRight=function(t){return co(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?Rn(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):Rn(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},ze.shr=ze.shiftRight,ze.shiftRightUnsigned=function(t){return co(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?Rn(this.low>>>t|this.high<<32-t,this.high>>>t,this.unsigned):t===32?Rn(this.high,0,this.unsigned):Rn(this.high>>>t-32,0,this.unsigned)},ze.shru=ze.shiftRightUnsigned,ze.shr_u=ze.shiftRightUnsigned,ze.rotateLeft=function(t){var e;return co(t)&&(t=t.toInt()),(t&=63)===0?this:t===32?Rn(this.high,this.low,this.unsigned):t<32?(e=32-t,Rn(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned)):(t-=32,e=32-t,Rn(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned))},ze.rotl=ze.rotateLeft,ze.rotateRight=function(t){var e;return co(t)&&(t=t.toInt()),(t&=63)===0?this:t===32?Rn(this.high,this.low,this.unsigned):t<32?(e=32-t,Rn(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned)):(t-=32,e=32-t,Rn(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned))},ze.rotr=ze.rotateRight,ze.toSigned=function(){return this.unsigned?Rn(this.low,this.high,!1):this},ze.toUnsigned=function(){return this.unsigned?this:Rn(this.low,this.high,!0)},ze.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},ze.toBytesLE=function(){var t=this.high,e=this.low;return[e&255,e>>>8&255,e>>>16&255,e>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]},ze.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,e>>>24,e>>>16&255,e>>>8&255,e&255]},Yn.fromBytes=function(t,e,n){return n?Yn.fromBytesLE(t,e):Yn.fromBytesBE(t,e)},Yn.fromBytesLE=function(t,e){return new Yn(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},Yn.fromBytesBE=function(t,e){return new Yn(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)};const uet=16;function CL(r){r==="X"&&(r="");const t=r.padEnd(uet,"0");return Yn.fromString(t,!0,16)}function Aet(r){if(r.isZero())return"X";let t=r.countTrailingZeros();const e=t%4;t=(t-e)/4;const n=t;t*=4;const s=r.shiftRightUnsigned(t).toString(16).replace(/0+$/,"");return Array(17-n-s.length).join("0")+s}function het(r,t){const e=det(r).shiftRightUnsigned(2);return r.add(Yn.fromNumber(2*t+1-4).multiply(e))}function det(r){return r.and(r.not().add(1))}const fet=3,pet=2*30+1,EL=180/Math.PI;function get(r){if(r.length===0)throw new Error("Invalid Hilbert quad key ".concat(r));const t=r.split("/"),e=parseInt(t[0],10),n=t[1],i=n.length;let s=0;const a=[0,0];for(let o=i-1;o>=0;o--){s=i-o;const d=n[o];let p=0,y=0;d==="1"?y=1:d==="2"?(p=1,y=1):d==="3"&&(p=1);const b=Math.pow(2,s-1);yet(b,a,p,y),a[0]+=b*p,a[1]+=b*y}if(e%2===1){const o=a[0];a[0]=a[1],a[1]=o}return{face:e,ij:a,level:s}}function met(r){if(r.isZero())return"";let t=r.toString(2);for(;t.length<fet+pet;)t="0"+t;const e=t.lastIndexOf("1"),n=t.substring(0,3),i=t.substring(3,e),s=i.length/2,a=Yn.fromString(n,!0,2).toString(10);let o="";if(s!==0)for(o=Yn.fromString(i,!0,2).toString(4);o.length<s;)o="0"+o;return"".concat(a,"/").concat(o)}function SL(r,t,e){const n=1<<t;return[(r[0]+e[0])/n,(r[1]+e[1])/n]}function TL(r){return r>=.5?1/3*(4*r*r-1):1/3*(1-4*(1-r)*(1-r))}function IL(r){return[TL(r[0]),TL(r[1])]}function FL(r,t){let[e,n]=t;switch(r){case 0:return[1,e,n];case 1:return[-e,1,n];case 2:return[-e,-n,1];case 3:return[-1,-n,-e];case 4:return[n,-1,-e];case 5:return[n,e,-1];default:throw new Error("Invalid face")}}function LL(r){let[t,e,n]=r;const i=Math.atan2(n,Math.sqrt(t*t+e*e));return[Math.atan2(e,t)*EL,i*EL]}function yet(r,t,e,n){if(n===0){e===1&&(t[0]=r-1-t[0],t[1]=r-1-t[1]);const i=t[0];t[0]=t[1],t[1]=i}}function _et(r){const t=SL(r.ij,r.level,[.5,.5]),e=IL(t),n=FL(r.face,e);return LL(n)}const vet=100;function PL(r){const{face:t,ij:e,level:n}=r,i=[[0,0],[0,1],[1,1],[1,0],[0,0]],s=Math.max(1,Math.ceil(vet*Math.pow(2,-n))),a=new Float64Array(4*s*2+2);let o=0,d=0;for(let p=0;p<4;p++){const y=i[p].slice(0),b=i[p+1],x=(b[0]-y[0])/s,C=(b[1]-y[1])/s;for(let P=0;P<s;P++){y[0]+=x,y[1]+=C;const M=SL(e,n,y),k=IL(M),z=FL(t,k),V=LL(z);Math.abs(V[1])>89.999&&(V[0]=d);const $=V[0]-d;V[0]+=$>180?-360:$<-180?360:0,a[o++]=V[0],a[o++]=V[1],d=V[0]}}return a[o++]=a[0],a[o++]=a[1],a}function p2(r){const t=bet(r);return get(t)}function bet(r){if(r.indexOf("/")>0)return r;const t=CL(r);return met(t)}function wet(r){const t=p2(r);return _et(t)}function xet(r){let t;if(r.face===2||r.face===5){let e=null,n=0;for(let i=0;i<4;i++){const s="".concat(r.face,"/").concat(i),a=p2(s),o=PL(a);(typeof e>"u"||e===null)&&(e=new Float64Array(4*o.length)),e.set(o,n),n+=o.length}t=ML(e)}else{const e=PL(r);t=ML(e)}return t}function ML(r){if(r.length%2!==0)throw new Error("Invalid corners");const t=[],e=[];for(let n=0;n<r.length;n+=2)t.push(r[n]),e.push(r[n+1]);return t.sort((n,i)=>n-i),e.sort((n,i)=>n-i),{west:t[0],east:t[t.length-1],north:e[e.length-1],south:e[0]}}function Bet(r,t){const e=(t==null?void 0:t.minimumHeight)||0,n=(t==null?void 0:t.maximumHeight)||0,i=p2(r),s=xet(i),a=s.west,o=s.south,d=s.east,p=s.north,y=[];return y.push(new se(a,p,e)),y.push(new se(d,p,e)),y.push(new se(d,o,e)),y.push(new se(a,o,e)),y.push(new se(a,p,n)),y.push(new se(d,p,n)),y.push(new se(d,o,n)),y.push(new se(a,o,n)),y}function UL(r){const t=r.token,e={minimumHeight:r.minimumHeight,maximumHeight:r.maximumHeight},n=Bet(t,e),i=wet(t),s=i[0],a=i[1],o=Mi.WGS84.cartographicToCartesian([s,a,e.maximumHeight]),d=new se(o[0],o[1],o[2]);n.push(d);const p=nX(n);return[...p.center,...p.halfAxes]}const Cet={QUADTREE:4,OCTREE:8};function Eet(r,t,e){if(r!=null&&r.box){const n=CL(r.s2VolumeInfo.token),i=het(n,t),s=Aet(i),a={...r.s2VolumeInfo};switch(a.token=s,e){case"OCTREE":const p=r.s2VolumeInfo,y=p.maximumHeight-p.minimumHeight,b=y/2,x=p.minimumHeight+y/2;p.minimumHeight=x-b,p.maximumHeight=x+b;break}return{box:UL(a),s2VolumeInfo:a}}}async function RL(r){const{options:t,parentData:e={mortonIndex:0,x:0,y:0,z:0},childIndex:n=0,globalData:i={level:0,mortonIndex:0,x:0,y:0,z:0},s2VolumeBox:s}=r;let{subtree:a,level:o=0}=r;const{subdivisionScheme:d,subtreeLevels:p,maximumLevel:y,contentUrlTemplate:b,subtreesUriTemplate:x,basePath:C}=t,P={children:[],lodMetricValue:0,contentUrl:""},M=Cet[d],k=n&1,z=n>>1&1,V=n>>2&1,$=(M**o-1)/(M-1);let tt=Yh(e.mortonIndex,n),pt=$+tt,gt=Yh(e.x,k),mt=Yh(e.y,z),dt=Yh(e.z,V),Ft=!1;o+1>p&&(Ft=g2(a.childSubtreeAvailability,tt));const Tt=Yh(i.x,gt),ot=Yh(i.y,mt),ct=Yh(i.z,dt),wt=o+i.level;if(Ft){const Kt="".concat(C,"/").concat(x),ee=m2(Kt,wt,Tt,ot,ct);a=await FA(ee,fL),i.mortonIndex=tt,i.x=gt,i.y=mt,i.z=dt,i.level=o,tt=0,pt=0,gt=0,mt=0,dt=0,o=0}if(!g2(a.tileAvailability,pt)||o>y)return P;g2(a.contentAvailability,pt)&&(P.contentUrl=m2(b,wt,Tt,ot,ct));const Wt=o+1,Yt={mortonIndex:tt,x:gt,y:mt,z:dt};for(let Kt=0;Kt<M;Kt++){const ee=Eet(s,Kt,d),Zt=await RL({subtree:a,options:t,parentData:Yt,childIndex:Kt,level:Wt,globalData:i,s2VolumeBox:ee});if(Zt.contentUrl||Zt.children.length){const we=wt+1,xt=Tet(Zt,we,{childTileX:gt,childTileY:mt,childTileZ:dt},t,s);P.children.push(xt)}}return P}function g2(r,t){return"constant"in r?!!r.constant:r.explicitBitstream?Let(t,r.explicitBitstream):!1}function Tet(r,t,e,n,i){const{basePath:s,refine:a,getRefine:o,lodMetricType:d,getTileType:p,rootLodMetricValue:y,rootBoundingVolume:b}=n,x=r.contentUrl&&r.contentUrl.replace("".concat(s,"/"),""),C=y/2**t,P=i!=null&&i.box?{box:i.box}:b,M=Iet(t,P,e);return{children:r.children,contentUrl:r.contentUrl,content:{uri:x},id:r.contentUrl,refine:o(a),type:p(r),lodMetricType:d,lodMetricValue:C,geometricError:C,transform:r.transform,boundingVolume:M}}function Iet(r,t,e){if(t.region){const{childTileX:n,childTileY:i,childTileZ:s}=e,[a,o,d,p,y,b]=t.region,x=2**r,C=(d-a)/x,P=(p-o)/x,M=(b-y)/x,[k,z]=[a+C*n,a+C*(n+1)],[V,$]=[o+P*i,o+P*(i+1)],[tt,pt]=[y+M*s,y+M*(s+1)];return{region:[k,V,z,$,tt,pt]}}if(t.box)return t;throw new Error("Unsupported bounding volume type ".concat(t))}function Yh(r,t){return parseInt(r.toString(2)+t.toString(2),2)}function m2(r,t,e,n,i){const s=Fet({level:t,x:e,y:n,z:i});return r.replace(/{level}|{x}|{y}|{z}/gi,a=>s[a])}function Fet(r){const t={};for(const e in r)t["{".concat(e,"}")]=r[e];return t}function Let(r,t){const e=Math.floor(r/8),n=r%8;return(t[e]>>n&1)===1}function y2(r){if(!r.contentUrl)return Cf.EMPTY;const e=r.contentUrl.split("?")[0].split(".").pop();switch(e){case"pnts":return Cf.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return Cf.SCENEGRAPH;default:return e}}function _2(r){switch(r){case"REPLACE":case"replace":return zu.REPLACE;case"ADD":case"add":return zu.ADD;default:return r}}function v2(r,t){if(/^[a-z][0-9a-z+.-]*:/i.test(t)){const n=new URL(r,"".concat(t,"/"));return decodeURI(n.toString())}else if(r.startsWith("/"))return r;return"".concat(t,"/").concat(r)}function OL(r,t){if(!r)return null;if(r.content){const e=r.content.uri||r.content.url;r.contentUrl=v2(e,t.basePath)}return r.id=r.contentUrl,r.lodMetricType=By.GEOMETRIC_ERROR,r.lodMetricValue=r.geometricError,r.transformMatrix=r.transform,r.type=y2(r),r.refine=_2(r.refine),r}async function Pet(r,t){const e=r.basePath;let n;const i=NL(r==null?void 0:r.root);i&&r.root?n=await DL(r.root,r,i,t):n=OL(r.root,r);const s=[];for(s.push(n);s.length>0;){const o=(s.pop()||{}).children||[];for(let d of o){const p=NL(d);p?d=await DL(d,r,p,t):OL(d,{basePath:e}),s.push(d)}}return n}async function DL(r,t,e,n){var i,s;const a=t.basePath,{subdivisionScheme:o,maximumLevel:d,subtreeLevels:p,subtrees:{uri:y}}=e,b=m2(y,0,0,0,0),x=v2(b,a),C=await FA(x,fL,n),P=v2(r.content.uri,a),M=t==null||(i=t.root)===null||i===void 0?void 0:i.refine,k=r.geometricError,z=(s=r.boundingVolume.extensions)===null||s===void 0?void 0:s["3DTILES_bounding_volume_S2"];if(z){const pt={box:UL(z),s2VolumeInfo:z};r.boundingVolume=pt}const V=r.boundingVolume,$={contentUrlTemplate:P,subtreesUriTemplate:y,subdivisionScheme:o,subtreeLevels:p,maximumLevel:d,refine:M,basePath:a,lodMetricType:By.GEOMETRIC_ERROR,rootLodMetricValue:k,rootBoundingVolume:V,getTileType:y2,getRefine:_2};return await Met(r,C,$)}async function Met(r,t,e){if(!r)return null;r.lodMetricType=By.GEOMETRIC_ERROR,r.lodMetricValue=r.geometricError,r.transformMatrix=r.transform;const{children:n,contentUrl:i}=await RL({subtree:t,options:e,s2VolumeBox:r});return i&&(r.contentUrl=i,r.content={uri:i.replace("".concat(e.basePath,"/"),"")}),r.refine=_2(r.refine),r.type=y2(r),r.children=n,r.id=r.contentUrl,r}function NL(r){var t;return(r==null||(t=r.extensions)===null||t===void 0?void 0:t["3DTILES_implicit_tiling"])||(r==null?void 0:r.implicitTiling)}const b2={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:eL,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:Det,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};function Uet(r){return Uv(r.url)}async function Ret(r,t,e){const n={content:{featureIds:null}};return await hL(r,0,t,e,n.content),n.content}async function Oet(r,t,e){var n;const i=JSON.parse(new TextDecoder().decode(r));return i.loader=t.loader||b2,i.url=e.url,i.queryString=e.queryString,i.basePath=Uet(i),i.root=await Pet(i,t),i.type=cl.TILES3D,i.lodMetricType=By.GEOMETRIC_ERROR,i.lodMetricValue=((n=i.root)===null||n===void 0?void 0:n.lodMetricValue)||0,i}async function Det(r,t,e){const n=t["3d-tiles"]||{};let i;return n.isTileset==="auto"?i=e.url&&e.url.indexOf(".json")!==-1:i=n.isTileset,i?r=await Oet(r,t,e):r=await Ret(r,t,e),r}const kL=[0],Net={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:"",loader:b2,onTilesetLoad:{type:"function",value:r=>{}},onTileLoad:{type:"function",value:r=>{}},onTileUnload:{type:"function",value:r=>{}},onTileError:{type:"function",value:(r,t,e)=>{}},_getMeshColor:{type:"function",value:r=>[255,255,255]}};class w2 extends CI{constructor(){super(...arguments),j(this,"state",void 0)}initializeState(){"onTileLoadFail"in this.props&&Tn.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){var t,e;return!!(!((t=this.state)===null||t===void 0||(e=t.tileset3d)===null||e===void 0)&&e.isLoaded()&&super.isLoaded)}shouldUpdateState(t){let{changeFlags:e}=t;return e.somethingChanged}updateState(t){let{props:e,oldProps:n,changeFlags:i}=t;if(e.data&&e.data!==n.data&&this._loadTileset(e.data),i.viewportChanged){const{activeViewports:s}=this.state;Object.keys(s).length&&(this._updateTileset(s),this.state.lastUpdatedViewports=s,this.state.activeViewports={})}if(i.propsChanged){const{layerMap:s}=this.state;for(const a in s)s[a].needsUpdate=!0}}activateViewport(t){const{activeViewports:e,lastUpdatedViewports:n}=this.state;this.internalState.viewport=t,e[t.id]=t;const i=n==null?void 0:n[t.id];(!i||!t.equals(i))&&(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo(t){let{info:e,sourceLayer:n}=t;const i=n&&n.props.tile;return e.picked&&(e.object=i),e.sourceTile=i,e}filterSubLayer(t){let{layer:e,viewport:n}=t;const{tile:i}=e.props,{id:s}=n;return i.selected&&i.viewportIds.includes(s)}_updateAutoHighlight(t){const e=t.sourceTile,n=this.state.layerMap[e==null?void 0:e.id];n&&n.layer&&n.layer.updateAutoHighlight(t)}async _loadTileset(t){const{loadOptions:e={}}=this.props;let n=this.props.loader||this.props.loaders;Array.isArray(n)&&(n=n[0]);const i={loadOptions:{...e}};let s=t;if(n.preload){const d=await n.preload(t,e);d.url&&(s=d.url),d.headers&&(i.loadOptions.fetch={...i.loadOptions.fetch,headers:d.headers}),Object.assign(i,d)}const a=await FA(s,n,i.loadOptions),o=new ytt(a,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError,...i});this.setState({tileset3d:o,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(o)}_onTileLoad(t){const{lastUpdatedViewports:e}=this.state;this.props.onTileLoad(t),this._updateTileset(e),this.setNeedsUpdate()}_onTileUnload(t){delete this.state.layerMap[t.id],this.props.onTileUnload(t)}_updateTileset(t){if(!t)return;const{tileset3d:e}=this.state,{timeline:n}=this.context,i=Object.keys(t).length;!n||!i||!e||e.selectTiles(Object.values(t)).then(s=>{this.state.frameNumber!==s&&this.setState({frameNumber:s})})}_getSubLayer(t,e){if(!t.content)return null;switch(t.type){case Cf.POINTCLOUD:return this._makePointCloudLayer(t,e);case Cf.SCENEGRAPH:return this._make3DModelLayer(t);case Cf.MESH:return this._makeSimpleMeshLayer(t,e);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(t.content.type))}}_makePointCloudLayer(t,e){const{attributes:n,pointCount:i,constantRGBA:s,cartographicOrigin:a,modelMatrix:o}=t.content,{positions:d,normals:p,colors:y}=n;if(!d)return null;const b=e&&e.props.data||{header:{vertexCount:i},attributes:{POSITION:d,NORMAL:p,COLOR_0:y}},{pointSize:x,getPointColor:C}=this.props,P=this.getSubLayerClass("pointcloud",Ew);return new P({pointSize:x},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(t.id),tile:t,data:b,coordinateSystem:En.METER_OFFSETS,coordinateOrigin:a,modelMatrix:o,getColor:s||C,_offset:0})}_make3DModelLayer(t){const{gltf:e,instances:n,cartographicOrigin:i,modelMatrix:s}=t.content,a=this.getSubLayerClass("scenegraph",jw);return new a({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(t.id),tile:t,data:n||kL,scenegraph:e,coordinateSystem:En.METER_OFFSETS,coordinateOrigin:i,modelMatrix:s,getTransformMatrix:o=>o.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(t,e){const n=t.content,{attributes:i,indices:s,modelMatrix:a,cartographicOrigin:o,coordinateSystem:d=En.METER_OFFSETS,material:p,featureIds:y}=n,{_getMeshColor:b}=this.props,x=e&&e.props.mesh||new mg({drawMode:4,attributes:ket(i),indices:s}),C=this.getSubLayerClass("mesh",qw);return new C(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(t.id),tile:t,mesh:x,data:kL,getColor:b(t),pbrMaterial:p,modelMatrix:a,coordinateOrigin:o,coordinateSystem:d,featureIds:y,_offset:0})}renderLayers(){const{tileset3d:t,layerMap:e}=this.state;return t?t.tiles.map(n=>{const i=e[n.id]=e[n.id]||{tile:n};let{layer:s}=i;return n.selected&&(s?i.needsUpdate&&(s=this._getSubLayer(n,s),i.needsUpdate=!1):s=this._getSubLayer(n)),i.layer=s,s}).filter(Boolean):null}}j(w2,"defaultProps",Net),j(w2,"layerName","Tile3DLayer");function ket(r){const t={};return t.positions={...r.positions,value:new Float32Array(r.positions.value)},r.normals&&(t.normals=r.normals),r.texCoords&&(t.texCoords=r.texCoords),r.colors&&(t.colors=r.colors),r.uvRegions&&(t.uvRegions=r.uvRegions),t}var Qet=Object.defineProperty,zet=(r,t,e)=>t in r?Qet(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,On=(r,t,e)=>(zet(r,typeof t!="symbol"?t+"":t,e),e);let Het=class{constructor(t){On(this,"map"),On(this,"width"),On(this,"height"),On(this,"svgCanvas"),On(this,"xLine"),On(this,"yLine"),On(this,"color","#535353"),this.map=t,this.mapResize=this.mapResize.bind(this)}create(){this.updateValues(),this.map!==void 0?(this.map.on("resize",this.mapResize),this.createCanvas(this.map.getCanvasContainer())):console.error("map object is null")}updateValues(){var t,e;this.width=(t=this.map)==null?void 0:t.getCanvas().clientWidth,this.height=(e=this.map)==null?void 0:e.getCanvas().clientHeight}mapResize(){this.updateValues(),this.updateCanvas()}updateCanvas(){if(this.svgCanvas!==void 0&&this.yLine!==void 0&&this.xLine!==void 0&&this.width!==void 0&&this.height!==void 0){this.svgCanvas.setAttribute("width",`${this.width}px`),this.svgCanvas.setAttribute("height",`${this.height}px`);const t=this.width/2,e=this.height/2;this.yLine.setAttribute("x1",`${t}px`),this.yLine.setAttribute("y1","0px"),this.yLine.setAttribute("x2",`${t}px`),this.yLine.setAttribute("y2",`${this.height}px`),this.xLine.setAttribute("x1","0px"),this.xLine.setAttribute("y1",`${e}px`),this.xLine.setAttribute("x2",`${this.width}px`),this.xLine.setAttribute("y2",`${e}px`)}else console.error("element value is null")}createCanvas(t){if(this.width!==void 0&&this.height!==void 0){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.style.position="relative",e.setAttribute("width",`${this.width}px`),e.setAttribute("height",`${this.height}px`);const n=this.width/2,i=this.height/2;this.yLine=e.appendChild(this.createLine(n,0,n,this.height,this.color,"2px")),this.xLine=e.appendChild(this.createLine(0,i,this.width,i,this.color,"2px")),t==null||t.appendChild(e),this.svgCanvas=e}}createLine(t,e,n,i,s,a){const o=document.createElementNS("http://www.w3.org/2000/svg","line");return o.setAttribute("x1",t),o.setAttribute("y1",e),o.setAttribute("x2",n),o.setAttribute("y2",i),o.setAttribute("stroke-dasharray","5,5"),o.setAttribute("stroke",s),o.setAttribute("stroke-width",a),o}destroy(){this.xLine!==void 0&&(this.xLine.remove(),this.xLine=void 0),this.yLine!==void 0&&(this.yLine.remove(),this.yLine=void 0),this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map.off("resize",this.mapResize),this.map=void 0)}};const x2={72:72,96:96,200:200,300:300,400:400},Vu={JPEG:"jpg",PNG:"png",PDF:"pdf",SVG:"svg"},Ng={Landscape:"landscape",Portrait:"portrait"},Zh={LETTER:[279,216],A2:[594,420],A3:[420,297],A4:[297,210],A5:[210,148],A6:[148,105],B2:[707,500],B3:[500,353],B4:[353,250],B5:[250,176],B6:[176,125]},If={in:"in",mm:"mm"};let Vet=class{constructor(t){On(this,"map"),On(this,"width"),On(this,"height"),On(this,"unit"),On(this,"svgCanvas"),On(this,"svgPath");var e,n,i;if(this.map=t,this.map===void 0)return;this.mapResize=this.mapResize.bind(this),this.map.on("resize",this.mapResize);const s=(e=this.map)==null?void 0:e.getCanvas().clientWidth,a=(n=this.map)==null?void 0:n.getCanvas().clientHeight,o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.style.position="absolute",o.style.top="0px",o.style.left="0px",o.setAttribute("width",`${s}px`),o.setAttribute("height",`${a}px`);const d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("style","fill:#888888;stroke-width:0"),d.setAttribute("fill-opacity","0.5"),o.append(d),(i=this.map)==null||i.getCanvasContainer().appendChild(o),this.svgCanvas=o,this.svgPath=d}mapResize(){this.generateCutOut()}updateArea(t,e){this.width=t,this.height=e,this.unit=If.mm,this.generateCutOut()}generateCutOut(){var t,e;if(this.map===void 0||this.svgCanvas===void 0||this.svgPath===void 0)return;const n=this.toPixels(this.width),i=this.toPixels(this.height),s=(t=this.map)==null?void 0:t.getCanvas().clientWidth,a=(e=this.map)==null?void 0:e.getCanvas().clientHeight,o=s/2-n/2,d=o+n,p=a/2-i/2,y=p+i;this.svgCanvas.setAttribute("width",`${s}px`),this.svgCanvas.setAttribute("height",`${a}px`),this.svgPath.setAttribute("d",`M 0 0 L ${s} 0 L ${s} ${a} L 0 ${a} M ${o} ${p} L ${o} ${y} L ${d} ${y} L ${d} ${p}`)}destroy(){this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map=void 0)}toPixels(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:96;return this.unit===If.mm&&(e/=25.4),e*t}};const QL={PageSize:"Page Size",PageOrientation:"Page Orientation",Format:"Format",DPI:"DPI",Generate:"Generate",LanguageName:"English",LanguageCode:"en"},Get={PageSize:"Taille de page",PageOrientation:"Orientation de la page",Format:"Format",DPI:"DPI",Generate:"Gnrer",LanguageName:"Franais",LanguageCode:"fr"},jet={PageSize:"Sivukoko",PageOrientation:"Sivun suunta",Format:"Muoto",DPI:"DPI",Generate:"Generoi",LanguageName:"Suomalainen",LanguageCode:"fi"},qet={PageSize:"Papierformat",PageOrientation:"Papierausrichtung",Format:"Dateiformat",DPI:"Druckauflsung",Generate:"Erstellen",LanguageName:"Deutsch",LanguageCode:"de"},Ket={PageSize:"Sidstorlek",PageOrientation:"Sidorientering",Format:"Format",DPI:"DPI",Generate:"Generera",LanguageName:"Svenska",LanguageCode:"sv"},$et={PageSize:"Tamao de pgina",PageOrientation:"Orientacin de pgina",Format:"Formato",DPI:"DPI",Generate:"Generar",LanguageName:"Espaola",LanguageCode:"es"},Wet={PageSize:"Mida",PageOrientation:"Orientaci",Format:"Format",DPI:"DPI",Generate:"Genera",LanguageName:"Catalan",LanguageCode:"ca"},Xet={PageSize:"Kch thc trang",PageOrientation:"Loi trang",Format:"nh dng",DPI:"Mt  im nh (DPI)",Generate:"To",LanguageName:"Ting Vit",LanguageCode:"vi"},Jet={PageSize:" ",PageOrientation:" ",Format:"",DPI:"DPI",Generate:"",LanguageName:"",LanguageCode:"uk"},Yet={PageSize:"",PageOrientation:"",Format:"",DPI:"",Generate:"",LanguageName:"",LanguageCode:"zhHans"},Zet={PageSize:"",PageOrientation:"",Format:"",DPI:"",Generate:"",LanguageName:"",LanguageCode:"zhHant"},trt={PageSize:"",PageOrientation:"",Format:"",DPI:"DPI",Generate:"",LanguageName:"",LanguageCode:"ja"},ert={PageSize:"Tamanho da pgina",PageOrientation:"Orientao da pgina",Format:"Formato",DPI:"DPI",Generate:"Gerar",LanguageName:"Portugus",LanguageCode:"pt"},rrt=[QL,Get,jet,qet,Ket,$et,Wet,Xet,Jet,Yet,Zet,trt,ert],nrt=r=>rrt.find(t=>t.LanguageCode===r)??QL;(function(r){var t={};function e(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return r[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=r,e.c=t,e.d=function(n,i,s){e.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:s})},e.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,i){if(1&i&&(n=e(n)),8&i||4&i&&typeof n=="object"&&n&&n.__esModule)return n;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:n}),2&i&&typeof n!="string")for(var a in n)e.d(s,a,(function(o){return n[o]}).bind(null,a));return s},e.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(i,"a",i),i},e.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)},e.p="",e(e.s=0)})([function(r,t,e){r.exports=e(1)},function(r,t){function e(i,s){for(var a=0;a<s.length;a++){var o=s[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(i,o.key,o)}}var n=function(){function i(){(function(o,d){if(!(o instanceof d))throw new TypeError("Cannot call a class as a function")})(this,i),this.options={overlayBackgroundColor:"#666666",overlayOpacity:.6,spinnerIcon:"ball-circus",spinnerColor:"#000",spinnerSize:"3x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetY:0,offsetX:0,lockScroll:!1,containerID:null,spinnerZIndex:99999,overlayZIndex:99998},this.stylesheetBaseURL="https://cdn.jsdelivr.net/npm/load-awesome@1.1.0/css/",this.spinner=null,this.spinnerStylesheetURL=null,this.numberOfEmptyDivForSpinner={"ball-8bits":16,"ball-atom":4,"ball-beat":3,"ball-circus":5,"ball-climbing-dot":1,"ball-clip-rotate":1,"ball-clip-rotate-multiple":2,"ball-clip-rotate-pulse":2,"ball-elastic-dots":5,"ball-fall":3,"ball-fussion":4,"ball-grid-beat":9,"ball-grid-pulse":9,"ball-newton-cradle":4,"ball-pulse":3,"ball-pulse-rise":5,"ball-pulse-sync":3,"ball-rotate":1,"ball-running-dots":5,"ball-scale":1,"ball-scale-multiple":3,"ball-scale-pulse":2,"ball-scale-ripple":1,"ball-scale-ripple-multiple":3,"ball-spin":8,"ball-spin-clockwise":8,"ball-spin-clockwise-fade":8,"ball-spin-clockwise-fade-rotating":8,"ball-spin-fade":8,"ball-spin-fade-rotating":8,"ball-spin-rotate":2,"ball-square-clockwise-spin":8,"ball-square-spin":8,"ball-triangle-path":3,"ball-zig-zag":2,"ball-zig-zag-deflect":2,cog:1,"cube-transition":2,fire:3,"line-scale":5,"line-scale-party":5,"line-scale-pulse-out":5,"line-scale-pulse-out-rapid":5,"line-spin-clockwise-fade":8,"line-spin-clockwise-fade-rotating":8,"line-spin-fade":8,"line-spin-fade-rotating":8,pacman:6,"square-jelly-box":2,"square-loader":1,"square-spin":1,timer:1,"triangle-skew-spin":1}}var s,a;return s=i,(a=[{key:"show",value:function(o){this.setOptions(o),this.addSpinnerStylesheet(),this.generateSpinnerElement(),this.options.lockScroll&&(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"),this.generateAndAddOverlayElement()}},{key:"hide",value:function(){this.options.lockScroll&&(document.body.style.overflow="",document.documentElement.style.overflow="");var o=document.getElementById("loading-overlay-stylesheet");o&&(o.disabled=!0,o.parentNode.removeChild(o),document.getElementById(this.options.overlayIDName).remove(),document.getElementById(this.options.spinnerIDName).remove())}},{key:"setOptions",value:function(o){if(o!==void 0)for(var d in o)this.options[d]=o[d]}},{key:"generateAndAddOverlayElement",value:function(){var o="50%";this.options.offsetX!==0&&(o="calc(50% + "+this.options.offsetX+")");var d="50%";if(this.options.offsetY!==0&&(d="calc(50% + "+this.options.offsetY+")"),this.options.containerID&&document.body.contains(document.getElementById(this.options.containerID))){var p='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: absolute; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,'; z-index: 50; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: absolute; top: ').concat(d,"; left: ").concat(o,'; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: 9999;">').concat(this.spinner,"</div>"),y=document.getElementById(this.options.containerID);return y.style.position="relative",void y.insertAdjacentHTML("beforeend",p)}var b='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: fixed; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,"; z-index: ").concat(this.options.overlayZIndex,'; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: fixed; top: ').concat(d,"; left: ").concat(o,"; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: ").concat(this.options.spinnerZIndex,';">').concat(this.spinner,"</div>");document.body.insertAdjacentHTML("beforeend",b)}},{key:"generateSpinnerElement",value:function(){var o=this,d=Object.keys(this.numberOfEmptyDivForSpinner).find(function(y){return y===o.options.spinnerIcon}),p=this.generateEmptyDivElement(this.numberOfEmptyDivForSpinner[d]);this.spinner='<div style="color: '.concat(this.options.spinnerColor,'" class="la-').concat(this.options.spinnerIcon," la-").concat(this.options.spinnerSize,'">').concat(p,"</div>")}},{key:"addSpinnerStylesheet",value:function(){this.setSpinnerStylesheetURL();var o=document.createElement("link");o.setAttribute("id","loading-overlay-stylesheet"),o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",this.spinnerStylesheetURL),document.getElementsByTagName("head")[0].appendChild(o)}},{key:"setSpinnerStylesheetURL",value:function(){this.spinnerStylesheetURL=this.stylesheetBaseURL+this.options.spinnerIcon+".min.css"}},{key:"generateEmptyDivElement",value:function(o){for(var d="",p=1;p<=o;p++)d+="<div></div>";return d}}])&&e(s.prototype,a),i}();window.JsLoadingOverlay=new n,r.exports=JsLoadingOverlay}]);function Dn(r){"@babel/helpers - typeof";return Dn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dn(r)}var oa=Uint8Array,Mo=Uint16Array,kg=Uint32Array,Ly=new oa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Py=new oa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),B2=new oa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),zL=function(r,t){for(var e=new Mo(31),n=0;n<31;++n)e[n]=t+=1<<r[n-1];for(var i=new kg(e[30]),n=1;n<30;++n)for(var s=e[n];s<e[n+1];++s)i[s]=s-e[n]<<5|n;return[e,i]},HL=zL(Ly,2),VL=HL[0],C2=HL[1];VL[28]=258,C2[258]=28;for(var jL=zL(Py,0),irt=jL[0],qL=jL[1],E2=new Mo(32768),Bi=0;Bi<32768;++Bi){var VA=(Bi&43690)>>>1|(Bi&21845)<<1;VA=(VA&52428)>>>2|(VA&13107)<<2,VA=(VA&61680)>>>4|(VA&3855)<<4,E2[Bi]=((VA&65280)>>>8|(VA&255)<<8)>>>1}for(var Kc=function(r,t,e){for(var n=r.length,i=0,s=new Mo(t);i<n;++i)++s[r[i]-1];var a=new Mo(t);for(i=0;i<t;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(e){o=new Mo(1<<t);var d=15-t;for(i=0;i<n;++i)if(r[i])for(var p=i<<4|r[i],y=t-r[i],b=a[r[i]-1]++<<y,x=b|(1<<y)-1;b<=x;++b)o[E2[b]>>>d]=p}else for(o=new Mo(n),i=0;i<n;++i)o[i]=E2[a[r[i]-1]++]>>>15-r[i];return o},GA=new oa(288),Bi=0;Bi<144;++Bi)GA[Bi]=8;for(var Bi=144;Bi<256;++Bi)GA[Bi]=9;for(var Bi=256;Bi<280;++Bi)GA[Bi]=7;for(var Bi=280;Bi<288;++Bi)GA[Bi]=8;for(var Qg=new oa(32),Bi=0;Bi<32;++Bi)Qg[Bi]=5;var srt=Kc(GA,9,0),ort=Kc(GA,9,1),art=Kc(Qg,5,0),lrt=Kc(Qg,5,1),S2=function(r){for(var t=r[0],e=1;e<r.length;++e)r[e]>t&&(t=r[e]);return t},nc=function(r,t,e){var n=t/8>>0;return(r[n]|r[n+1]<<8)>>>(t&7)&e},T2=function(r,t){var e=t/8>>0;return(r[e]|r[e+1]<<8|r[e+2]<<16)>>>(t&7)},I2=function(r){return(r/8>>0)+(r&7&&1)},KL=function(r,t,e){(e==null||e>r.length)&&(e=r.length);var n=new(r instanceof Mo?Mo:r instanceof kg?kg:oa)(e-t);return n.set(r.subarray(t,e)),n},crt=function(r,t,e){var n=r.length,i=!t||e,s=!e||e.i;e||(e={}),t||(t=new oa(n*3));var a=function(jt){var Vt=t.length;if(jt>Vt){var re=new oa(Math.max(Vt*2,jt));re.set(t),t=re}},o=e.f||0,d=e.p||0,p=e.b||0,y=e.l,b=e.d,x=e.m,C=e.n,P=n*8;do{if(!y){e.f=o=nc(r,d,1);var M=nc(r,d+1,3);if(d+=3,M)if(M==1)y=ort,b=lrt,x=9,C=5;else if(M==2){var k=nc(r,d,31)+257,z=nc(r,d+10,15)+4,V=k+nc(r,d+5,31)+1;d+=14;for(var $=new oa(V),tt=new oa(19),pt=0;pt<z;++pt)tt[B2[pt]]=nc(r,d+pt*3,7);d+=z*3;var gt=S2(tt),mt=(1<<gt)-1;if(!s&&d+V*(gt+7)>P)break;for(var dt=Kc(tt,gt,1),pt=0;pt<V;){var Ft=dt[nc(r,d,mt)];d+=Ft&15;var Tt=Ft>>>4;if(Tt<16)$[pt++]=Tt;else{var ot=0,ct=0;for(Tt==16?(ct=3+nc(r,d,3),d+=2,ot=$[pt-1]):Tt==17?(ct=3+nc(r,d,7),d+=3):Tt==18&&(ct=11+nc(r,d,127),d+=7);ct--;)$[pt++]=ot}}var wt=$.subarray(0,k),vt=$.subarray(k);x=S2(wt),C=S2(vt),y=Kc(wt,x,1),b=Kc(vt,C,1)}else throw"invalid block type";else{var Tt=I2(d)+4,$t=r[Tt-4]|r[Tt-3]<<8,Wt=Tt+$t;if(Wt>n){if(s)throw"unexpected EOF";break}i&&a(p+$t),t.set(r.subarray(Tt,Wt),p),e.b=p+=$t,e.p=d=Wt*8;continue}if(d>P)throw"unexpected EOF"}i&&a(p+131072);for(var Yt=(1<<x)-1,Kt=(1<<C)-1,ee=x+C+18;s||d+ee<P;){var ot=y[T2(r,d)&Yt],Zt=ot>>>4;if(d+=ot&15,d>P)throw"unexpected EOF";if(!ot)throw"invalid length/literal";if(Zt<256)t[p++]=Zt;else if(Zt==256){y=null;break}else{var we=Zt-254;if(Zt>264){var pt=Zt-257,it=Ly[pt];we=nc(r,d,(1<<it)-1)+VL[pt],d+=it}var xt=b[T2(r,d)&Kt],It=xt>>>4;if(!xt)throw"invalid distance";d+=xt&15;var vt=irt[It];if(It>3){var it=Py[It];vt+=T2(r,d)&(1<<it)-1,d+=it}if(d>P)throw"unexpected EOF";i&&a(p+131072);for(var Ut=p+we;p<Ut;p+=4)t[p]=t[p-vt],t[p+1]=t[p+1-vt],t[p+2]=t[p+2-vt],t[p+3]=t[p+3-vt];p=Ut}}e.l=y,e.p=d,e.b=p,y&&(o=1,e.m=x,e.d=b,e.n=C)}while(!o);return p==t.length?t:KL(t,0,p)},Gu=function(r,t,e){e<<=t&7;var n=t/8>>0;r[n]|=e,r[n+1]|=e>>>8},zg=function(r,t,e){e<<=t&7;var n=t/8>>0;r[n]|=e,r[n+1]|=e>>>8,r[n+2]|=e>>>16},F2=function(r,t){for(var e=[],n=0;n<r.length;++n)r[n]&&e.push({s:n,f:r[n]});var i=e.length,s=e.slice();if(!i)return[new oa(0),0];if(i==1){var a=new oa(e[0].s+1);return a[e[0].s]=1,[a,1]}e.sort(function(pt,gt){return pt.f-gt.f}),e.push({s:-1,f:25001});var o=e[0],d=e[1],p=0,y=1,b=2;for(e[0]={s:-1,f:o.f+d.f,l:o,r:d};y!=i-1;)o=e[e[p].f<e[b].f?p++:b++],d=e[p!=y&&e[p].f<e[b].f?p++:b++],e[y++]={s:-1,f:o.f+d.f,l:o,r:d};for(var x=s[0].s,n=1;n<i;++n)s[n].s>x&&(x=s[n].s);var C=new Mo(x+1),P=L2(e[y-1],C,0);if(P>t){var n=0,M=0,k=P-t,z=1<<k;for(s.sort(function(gt,mt){return C[mt.s]-C[gt.s]||gt.f-mt.f});n<i;++n){var V=s[n].s;if(C[V]>t)M+=z-(1<<P-C[V]),C[V]=t;else break}for(M>>>=k;M>0;){var $=s[n].s;C[$]<t?M-=1<<t-C[$]++-1:++n}for(;n>=0&&M;--n){var tt=s[n].s;C[tt]==t&&(--C[tt],++M)}P=t}return[new oa(C),P]},L2=function(r,t,e){return r.s==-1?Math.max(L2(r.l,t,e+1),L2(r.r,t,e+1)):t[r.s]=e},$L=function(r){for(var t=r.length;t&&!r[--t];);for(var e=new Mo(++t),n=0,i=r[0],s=1,a=function(d){e[n++]=d},o=1;o<=t;++o)if(r[o]==i&&o!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=r[o]}return[e.subarray(0,n),t]},Hg=function(r,t){for(var e=0,n=0;n<t.length;++n)e+=r[n]*t[n];return e},P2=function(r,t,e){var n=e.length,i=I2(t+2);r[i]=n&255,r[i+1]=n>>>8,r[i+2]=r[i]^255,r[i+3]=r[i+1]^255;for(var s=0;s<n;++s)r[i+s+4]=e[s];return(i+4+n)*8},WL=function(r,t,e,n,i,s,a,o,d,p,y){Gu(t,y++,e),++i[256];for(var b=F2(i,15),x=b[0],C=b[1],P=F2(s,15),M=P[0],k=P[1],z=$L(x),V=z[0],$=z[1],tt=$L(M),pt=tt[0],gt=tt[1],mt=new Mo(19),dt=0;dt<V.length;++dt)mt[V[dt]&31]++;for(var dt=0;dt<pt.length;++dt)mt[pt[dt]&31]++;for(var Ft=F2(mt,7),Tt=Ft[0],ot=Ft[1],ct=19;ct>4&&!Tt[B2[ct-1]];--ct);var wt=p+5<<3,vt=Hg(i,GA)+Hg(s,Qg)+a,$t=Hg(i,x)+Hg(s,M)+a+14+3*ct+Hg(mt,Tt)+(2*mt[16]+3*mt[17]+7*mt[18]);if(wt<=vt&&wt<=$t)return P2(t,y,r.subarray(d,d+p));var Wt,Yt,Kt,ee;if(Gu(t,y,1+($t<vt)),y+=2,$t<vt){Wt=Kc(x,C,0),Yt=x,Kt=Kc(M,k,0),ee=M;var Zt=Kc(Tt,ot,0);Gu(t,y,$-257),Gu(t,y+5,gt-1),Gu(t,y+10,ct-4),y+=14;for(var dt=0;dt<ct;++dt)Gu(t,y+3*dt,Tt[B2[dt]]);y+=3*ct;for(var we=[V,pt],it=0;it<2;++it)for(var xt=we[it],dt=0;dt<xt.length;++dt){var It=xt[dt]&31;Gu(t,y,Zt[It]),y+=Tt[It],It>15&&(Gu(t,y,xt[dt]>>>5&127),y+=xt[dt]>>>12)}}else Wt=srt,Yt=GA,Kt=art,ee=Qg;for(var dt=0;dt<o;++dt)if(n[dt]>255){var It=n[dt]>>>18&31;zg(t,y,Wt[It+257]),y+=Yt[It+257],It>7&&(Gu(t,y,n[dt]>>>23&31),y+=Ly[It]);var Ut=n[dt]&31;zg(t,y,Kt[Ut]),y+=ee[Ut],Ut>3&&(zg(t,y,n[dt]>>>5&8191),y+=Py[Ut])}else zg(t,y,Wt[n[dt]]),y+=Yt[n[dt]];return zg(t,y,Wt[256]),y+Yt[256]},urt=new kg([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Art=function(r,t,e,n,i,s){var a=r.length,o=new oa(n+a+5*(1+Math.floor(a/7e3))+i),d=o.subarray(n,o.length-i),p=0;if(!t||a<8)for(var y=0;y<=a;y+=65535){var b=y+65535;b<a?p=P2(d,p,r.subarray(y,b)):(d[y]=s,p=P2(d,p,r.subarray(y,a)))}else{for(var x=urt[t-1],C=x>>>13,P=x&8191,M=(1<<e)-1,k=new Mo(32768),z=new Mo(M+1),V=Math.ceil(e/3),$=2*V,tt=function(Je){return(r[Je]^r[Je+1]<<V^r[Je+2]<<$)&M},pt=new kg(25e3),gt=new Mo(288),mt=new Mo(32),dt=0,Ft=0,y=0,Tt=0,ot=0,ct=0;y<a;++y){var wt=tt(y),vt=y&32767,$t=z[wt];if(k[vt]=$t,z[wt]=vt,ot<=y){var Wt=a-y;if((dt>7e3||Tt>24576)&&Wt>423){p=WL(r,d,0,pt,gt,mt,Ft,Tt,ct,y-ct,p),Tt=dt=Ft=0,ct=y;for(var Yt=0;Yt<286;++Yt)gt[Yt]=0;for(var Yt=0;Yt<30;++Yt)mt[Yt]=0}var Kt=2,ee=0,Zt=P,we=vt-$t&32767;if(Wt>2&&wt==tt(y-we))for(var it=Math.min(C,Wt)-1,xt=Math.min(32767,y),It=Math.min(258,Wt);we<=xt&&--Zt&&vt!=$t;){if(r[y+Kt]==r[y+Kt-we]){for(var Ut=0;Ut<It&&r[y+Ut]==r[y+Ut-we];++Ut);if(Ut>Kt){if(Kt=Ut,ee=we,Ut>it)break;for(var jt=Math.min(we,Ut-2),Vt=0,Yt=0;Yt<jt;++Yt){var re=y-we+Yt+32768&32767,te=k[re],Ce=re-te+32768&32767;Ce>Vt&&(Vt=Ce,$t=re)}}}vt=$t,$t=k[vt],we+=vt-$t+32768&32767}if(ee){pt[Tt++]=268435456|C2[Kt]<<18|qL[ee];var Te=C2[Kt]&31,De=qL[ee]&31;Ft+=Ly[Te]+Py[De],++gt[257+Te],++mt[De],ot=y+Kt,++dt}else pt[Tt++]=r[y],++gt[r[y]]}}p=WL(r,d,s,pt,gt,mt,Ft,Tt,ct,y-ct,p)}return KL(o,0,n+I2(p)+i)},hrt=function(){var r=1,t=0;return{p:function(e){for(var n=r,i=t,s=e.length,a=0;a!=s;){for(var o=Math.min(a+5552,s);a<o;++a)n+=e[a],i+=n;n%=65521,i%=65521}r=n,t=i},d:function(){return(r>>>8<<16|(t&255)<<8|t>>>8)+((r&255)<<23)*2}}},drt=function(r,t,e,n,i){return Art(r,t.level==null?6:t.level,t.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):12+t.mem,e,n,!i)},frt=function(r,t,e){for(;e;++t)r[t]=e,e>>>=8},prt=function(r,t){var e=t.level,n=e==0?0:e<6?1:e==9?3:2;r[0]=120,r[1]=n<<6|(n?32-2*n:1)},grt=function(r){if((r[0]&15)!=8||r[0]>>>4>7||(r[0]<<8|r[1])%31)throw"invalid zlib data";if(r[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function M2(r,t){t===void 0&&(t={});var e=hrt();e.p(r);var n=drt(r,t,2,4);return prt(n,t),frt(n,n.length-4,e.d()),n}function mrt(r,t){return crt((grt(r),r.subarray(2,-4)),t)}/** @license
*
* jsPDF - PDF Document creation from JavaScript
* Version 2.5.1 Built on 2022-01-28T15:37:57.791Z
*                      CommitID 00000000
*
* Copyright (c) 2010-2021 James Hall <james@parall.ax>, https://github.com/MrRio/jsPDF
*               2015-2021 yWorks GmbH, http://www.yworks.com
*               2015-2021 Lukas Hollnder <lukas.hollaender@yworks.com>, https://github.com/HackbrettXXX
*               2016-2018 Aras Abbasi <aras.abbasi@gmail.com>
*               2010 Aaron Spike, https://github.com/acspike
*               2012 Willow Systems Corporation, https://github.com/willowsystems
*               2012 Pablo Hess, https://github.com/pablohess
*               2012 Florian Jenett, https://github.com/fjenett
*               2013 Warren Weckesser, https://github.com/warrenweckesser
*               2013 Youssef Beddad, https://github.com/lifof
*               2013 Lee Driscoll, https://github.com/lsdriscoll
*               2013 Stefan Slonevskiy, https://github.com/stefslon
*               2013 Jeremy Morel, https://github.com/jmorel
*               2013 Christoph Hartmann, https://github.com/chris-rock
*               2014 Juan Pablo Gaviria, https://github.com/juanpgaviria
*               2014 James Makes, https://github.com/dollaruw
*               2014 Diego Casorran, https://github.com/diegocr
*               2014 Steven Spungin, https://github.com/Flamenco
*               2014 Kenneth Glassey, https://github.com/Gavvers
*
* Permission is hereby granted, free of charge, to any person obtaining
* a copy of this software and associated documentation files (the
* "Software"), to deal in the Software without restriction, including
* without limitation the rights to use, copy, modify, merge, publish,
* distribute, sublicense, and/or sell copies of the Software, and to
* permit persons to whom the Software is furnished to do so, subject to
* the following conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
* LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
* OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
* WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*
* Contributor(s):
*    siefkenj, ahwolf, rickygu, Midnith, saintclair, eaparango,
*    kim3er, mfo, alnorth, Flamenco
*/var Hr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function U2(){Hr.console&&typeof Hr.console.log=="function"&&Hr.console.log.apply(Hr.console,arguments)}var Ai={log:U2,warn:function(r){Hr.console&&(typeof Hr.console.warn=="function"?Hr.console.warn.apply(Hr.console,arguments):U2.call(null,arguments))},error:function(r){Hr.console&&(typeof Hr.console.error=="function"?Hr.console.error.apply(Hr.console,arguments):U2(r))}};function R2(r,t,e){var n=new XMLHttpRequest;n.open("GET",r),n.responseType="blob",n.onload=function(){td(n.response,t,e)},n.onerror=function(){Ai.error("could not download file")},n.send()}function XL(r){var t=new XMLHttpRequest;t.open("HEAD",r,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function My(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(t)}}var Vg,O2,td=Hr.saveAs||((typeof window>"u"?"undefined":Dn(window))!=="object"||window!==Hr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,t,e){var n=Hr.URL||Hr.webkitURL,i=document.createElement("a");t=t||r.name||"download",i.download=t,i.rel="noopener",typeof r=="string"?(i.href=r,i.origin!==location.origin?XL(i.href)?R2(r,t,e):My(i,i.target="_blank"):My(i)):(i.href=n.createObjectURL(r),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){My(i)},0))}:"msSaveOrOpenBlob"in navigator?function(r,t,e){if(t=t||r.name||"download",typeof r=="string")if(XL(r))R2(r,t,e);else{var n=document.createElement("a");n.href=r,n.target="_blank",setTimeout(function(){My(n)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:Dn(s)!=="object"&&(Ai.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(r,e),t)}:function(r,t,e,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof r=="string")return R2(r,t,e);var i=r.type==="application/octet-stream",s=/constructor/i.test(Hr.HTMLElement)||Hr.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||i&&s)&&(typeof FileReader>"u"?"undefined":Dn(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var y=o.result;y=a?y:y.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=y:location=y,n=null},o.readAsDataURL(r)}else{var d=Hr.URL||Hr.webkitURL,p=d.createObjectURL(r);n?n.location=p:location.href=p,n=null,setTimeout(function(){d.revokeObjectURL(p)},4e4)}});/**
* A class to parse color values
* @author Stoyan Stefanov <sstoo@gmail.com>
* {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
* @license Use it if you like it
*/function JL(r){var t;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<e.length;n++){var i=e[n].re,s=e[n].process,a=i.exec(r);a&&(t=s(a),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),d=this.g.toString(16),p=this.b.toString(16);return o.length==1&&(o="0"+o),d.length==1&&(d="0"+d),p.length==1&&(p="0"+p),"#"+o+d+p}}/**
* @license
* Joseph Myers does not specify a particular license for his work.
*
* Author: Joseph Myers
* Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
*
* Modified by: Owen Leong
*/function D2(r,t){var e=r[0],n=r[1],i=r[2],s=r[3];e=uo(e,n,i,s,t[0],7,-680876936),s=uo(s,e,n,i,t[1],12,-389564586),i=uo(i,s,e,n,t[2],17,606105819),n=uo(n,i,s,e,t[3],22,-1044525330),e=uo(e,n,i,s,t[4],7,-176418897),s=uo(s,e,n,i,t[5],12,1200080426),i=uo(i,s,e,n,t[6],17,-1473231341),n=uo(n,i,s,e,t[7],22,-45705983),e=uo(e,n,i,s,t[8],7,1770035416),s=uo(s,e,n,i,t[9],12,-1958414417),i=uo(i,s,e,n,t[10],17,-42063),n=uo(n,i,s,e,t[11],22,-1990404162),e=uo(e,n,i,s,t[12],7,1804603682),s=uo(s,e,n,i,t[13],12,-40341101),i=uo(i,s,e,n,t[14],17,-1502002290),e=Ao(e,n=uo(n,i,s,e,t[15],22,1236535329),i,s,t[1],5,-165796510),s=Ao(s,e,n,i,t[6],9,-1069501632),i=Ao(i,s,e,n,t[11],14,643717713),n=Ao(n,i,s,e,t[0],20,-373897302),e=Ao(e,n,i,s,t[5],5,-701558691),s=Ao(s,e,n,i,t[10],9,38016083),i=Ao(i,s,e,n,t[15],14,-660478335),n=Ao(n,i,s,e,t[4],20,-405537848),e=Ao(e,n,i,s,t[9],5,568446438),s=Ao(s,e,n,i,t[14],9,-1019803690),i=Ao(i,s,e,n,t[3],14,-187363961),n=Ao(n,i,s,e,t[8],20,1163531501),e=Ao(e,n,i,s,t[13],5,-1444681467),s=Ao(s,e,n,i,t[2],9,-51403784),i=Ao(i,s,e,n,t[7],14,1735328473),e=ho(e,n=Ao(n,i,s,e,t[12],20,-1926607734),i,s,t[5],4,-378558),s=ho(s,e,n,i,t[8],11,-2022574463),i=ho(i,s,e,n,t[11],16,1839030562),n=ho(n,i,s,e,t[14],23,-35309556),e=ho(e,n,i,s,t[1],4,-1530992060),s=ho(s,e,n,i,t[4],11,1272893353),i=ho(i,s,e,n,t[7],16,-155497632),n=ho(n,i,s,e,t[10],23,-1094730640),e=ho(e,n,i,s,t[13],4,681279174),s=ho(s,e,n,i,t[0],11,-358537222),i=ho(i,s,e,n,t[3],16,-722521979),n=ho(n,i,s,e,t[6],23,76029189),e=ho(e,n,i,s,t[9],4,-640364487),s=ho(s,e,n,i,t[12],11,-421815835),i=ho(i,s,e,n,t[15],16,530742520),e=fo(e,n=ho(n,i,s,e,t[2],23,-995338651),i,s,t[0],6,-198630844),s=fo(s,e,n,i,t[7],10,1126891415),i=fo(i,s,e,n,t[14],15,-1416354905),n=fo(n,i,s,e,t[5],21,-57434055),e=fo(e,n,i,s,t[12],6,1700485571),s=fo(s,e,n,i,t[3],10,-1894986606),i=fo(i,s,e,n,t[10],15,-1051523),n=fo(n,i,s,e,t[1],21,-2054922799),e=fo(e,n,i,s,t[8],6,1873313359),s=fo(s,e,n,i,t[15],10,-30611744),i=fo(i,s,e,n,t[6],15,-1560198380),n=fo(n,i,s,e,t[13],21,1309151649),e=fo(e,n,i,s,t[4],6,-145523070),s=fo(s,e,n,i,t[11],10,-1120210379),i=fo(i,s,e,n,t[2],15,718787259),n=fo(n,i,s,e,t[9],21,-343485551),r[0]=jA(e,r[0]),r[1]=jA(n,r[1]),r[2]=jA(i,r[2]),r[3]=jA(s,r[3])}function Uy(r,t,e,n,i,s){return t=jA(jA(t,r),jA(n,s)),jA(t<<i|t>>>32-i,e)}function uo(r,t,e,n,i,s,a){return Uy(t&e|~t&n,r,t,i,s,a)}function Ao(r,t,e,n,i,s,a){return Uy(t&n|e&~n,r,t,i,s,a)}function ho(r,t,e,n,i,s,a){return Uy(t^e^n,r,t,i,s,a)}function fo(r,t,e,n,i,s,a){return Uy(e^(t|~n),r,t,i,s,a)}function YL(r){var t,e=r.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=r.length;t+=64)D2(n,yrt(r.substring(t-64,t)));r=r.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<r.length;t++)i[t>>2]|=r.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(D2(n,i),t=0;t<16;t++)i[t]=0;return i[14]=8*e,D2(n,i),n}function yrt(r){var t,e=[];for(t=0;t<64;t+=4)e[t>>2]=r.charCodeAt(t)+(r.charCodeAt(t+1)<<8)+(r.charCodeAt(t+2)<<16)+(r.charCodeAt(t+3)<<24);return e}Vg=Hr.atob.bind(Hr),O2=Hr.btoa.bind(Hr);var ZL="0123456789abcdef".split("");function _rt(r){for(var t="",e=0;e<4;e++)t+=ZL[r>>8*e+4&15]+ZL[r>>8*e&15];return t}function vrt(r){return String.fromCharCode((255&r)>>0,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function N2(r){return YL(r).map(vrt).join("")}var brt=function(r){for(var t=0;t<r.length;t++)r[t]=_rt(r[t]);return r.join("")}(YL("hello"))!="5d41402abc4b2a76b9719d911017c592";function jA(r,t){if(brt){var e=(65535&r)+(65535&t);return(r>>16)+(t>>16)+(e>>16)<<16|65535&e}return r+t&4294967295}/**
* @license
* FPDF is released under a permissive license: there is no usage restriction.
* You may embed it freely in your application (commercial or not), with or
* without modifications.
*
* Reference: http://www.fpdf.org/en/script/script37.php
*/function k2(r,t){var e,n,i,s;if(r!==e){for(var a=(i=r,s=1+(256/r.length>>0),new Array(s+1).join(i)),o=[],d=0;d<256;d++)o[d]=d;var p=0;for(d=0;d<256;d++){var y=o[d];p=(p+y+a.charCodeAt(d))%256,o[d]=o[p],o[p]=y}e=r,n=o}else o=n;var b=t.length,x=0,C=0,P="";for(d=0;d<b;d++)C=(C+(y=o[x=(x+1)%256]))%256,o[x]=o[C],o[C]=y,a=o[(o[x]+o[C])%256],P+=String.fromCharCode(t.charCodeAt(d)^a);return P}/**
* @license
* Licensed under the MIT License.
* http://opensource.org/licenses/mit-license
* Author: Owen Leong (@owenl131)
* Date: 15 Oct 2020
* References:
* https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
* https://github.com/foliojs/pdfkit/blob/master/lib/security.js
* http://www.fpdf.org/en/script/script37.php
*/var tP={print:4,modify:8,copy:16,"annot-forms":32};function Ff(r,t,e,n){this.v=1,this.r=2;var i=192;r.forEach(function(o){if(tP.perm!==void 0)throw new Error("Invalid permission: "+o);i+=tP[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(t+this.padding).substr(0,32),a=(e+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,a),this.P=-(1+(255^i)),this.encryptionKey=N2(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=k2(this.encryptionKey,this.padding)}function Lf(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var t="",e=r.length,n=0;n<e;n++){var i=r.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?t+="#"+("0"+i.toString(16)).slice(-2):t+=r[n]}return t}function eP(r){if(Dn(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,n,i){if(i=i||!1,typeof e!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var s=Math.random().toString(35);return t[e][s]=[n,!!i],s},this.unsubscribe=function(e){for(var n in t)if(t[n][e])return delete t[n][e],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(e){if(t.hasOwnProperty(e)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var s in t[e]){var a=t[e][s];try{a[0].apply(r,n)}catch(o){Hr.console&&Ai.error("jsPDF PubSub Error",o.message,o)}a[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Ry(r){if(!(this instanceof Ry))return new Ry(r);var t="opacity,stroke-opacity".split(",");for(var e in r)r.hasOwnProperty(e)&&t.indexOf(e)>=0&&(this[e]=r[e]);this.id="",this.objectNumber=-1}function rP(r,t){this.gState=r,this.matrix=t,this.id="",this.objectNumber=-1}function ed(r,t,e,n,i){if(!(this instanceof ed))return new ed(r,t,e,n,i);this.type=r==="axial"?2:3,this.coords=t,this.colors=e,rP.call(this,n,i)}function Pf(r,t,e,n,i){if(!(this instanceof Pf))return new Pf(r,t,e,n,i);this.boundingBox=r,this.xStep=t,this.yStep=e,this.stream="",this.cloneIndex=0,rP.call(this,n,i)}function Vr(r){var t,e=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],s=arguments[3],a=[],o=1,d=16,p="S",y=null;Dn(r=r||{})==="object"&&(e=r.orientation,n=r.unit||n,i=r.format||i,s=r.compress||r.compressPdf||s,(y=r.encryption||null)!==null&&(y.userPassword=y.userPassword||"",y.ownerPassword=y.ownerPassword||"",y.userPermissions=y.userPermissions||[]),o=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(t=r.precision),r.floatPrecision!==void 0&&(d=r.floatPrecision),p=r.defaultPathOperation||"S"),a=r.filters||(s===!0?["FlateEncode"]:a),n=n||"mm",e=(""+(e||"P")).toLowerCase();var b=r.putOnlyUsedFonts||!1,x={},C={internal:{},__private__:{}};C.__private__.PubSub=eP;var P="1.3",M=C.__private__.getPdfVersion=function(){return P};C.__private__.setPdfVersion=function(D){P=D};var k={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};C.__private__.getPageFormats=function(){return k};var z=C.__private__.getPageFormat=function(D){return k[D]};i=i||"a4";var V={COMPAT:"compat",ADVANCED:"advanced"},$=V.COMPAT;function tt(){this.saveGraphicsState(),st(new Ot(Re,0,0,-Re,0,xl()*Re).toString()+" cm"),this.setFontSize(this.getFontSize()/Re),p="n",$=V.ADVANCED}function pt(){this.restoreGraphicsState(),p="S",$=V.COMPAT}var gt=C.__private__.combineFontStyleAndFontWeight=function(D,nt){if(D=="bold"&&nt=="normal"||D=="bold"&&nt==400||D=="normal"&&nt=="italic"||D=="bold"&&nt=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return nt&&(D=nt==400||nt==="normal"?D==="italic"?"italic":"normal":nt!=700&&nt!=="bold"||D!=="normal"?(nt==700?"bold":nt)+""+D:"bold"),D};C.advancedAPI=function(D){var nt=$===V.COMPAT;return nt&&tt.call(this),typeof D!="function"||(D(this),nt&&pt.call(this)),this},C.compatAPI=function(D){var nt=$===V.ADVANCED;return nt&&pt.call(this),typeof D!="function"||(D(this),nt&&tt.call(this)),this},C.isAdvancedAPI=function(){return $===V.ADVANCED};var mt,dt=function(D){if($!==V.ADVANCED)throw new Error(D+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Ft=C.roundToPrecision=C.__private__.roundToPrecision=function(D,nt){var Lt=t||nt;if(isNaN(D)||isNaN(Lt))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return D.toFixed(Lt).replace(/0+$/,"")};mt=C.hpf=C.__private__.hpf=typeof d=="number"?function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.hpf");return Ft(D,d)}:d==="smart"?function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.hpf");return Ft(D,D>-1&&D<1?16:5)}:function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.hpf");return Ft(D,16)};var Tt=C.f2=C.__private__.f2=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.f2");return Ft(D,2)},ot=C.__private__.f3=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.f3");return Ft(D,3)},ct=C.scale=C.__private__.scale=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.scale");return $===V.COMPAT?D*Re:$===V.ADVANCED?D:void 0},wt=function(D){return $===V.COMPAT?xl()-D:$===V.ADVANCED?D:void 0},vt=function(D){return ct(wt(D))};C.__private__.setPrecision=C.setPrecision=function(D){typeof parseInt(D,10)=="number"&&(t=parseInt(D,10))};var $t,Wt="00000000000000000000000000000000",Yt=C.__private__.getFileId=function(){return Wt},Kt=C.__private__.setFileId=function(D){return Wt=D!==void 0&&/^[a-fA-F0-9]{32}$/.test(D)?D.toUpperCase():Wt.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),y!==null&&(yn=new Ff(y.userPermissions,y.userPassword,y.ownerPassword,Wt)),Wt};C.setFileId=function(D){return Kt(D),this},C.getFileId=function(){return Yt()};var ee=C.__private__.convertDateToPDFDate=function(D){var nt=D.getTimezoneOffset(),Lt=nt<0?"+":"-",Ht=Math.floor(Math.abs(nt/60)),ne=Math.abs(nt%60),ge=[Lt,It(Ht),"'",It(ne),"'"].join("");return["D:",D.getFullYear(),It(D.getMonth()+1),It(D.getDate()),It(D.getHours()),It(D.getMinutes()),It(D.getSeconds()),ge].join("")},Zt=C.__private__.convertPDFDateToDate=function(D){var nt=parseInt(D.substr(2,4),10),Lt=parseInt(D.substr(6,2),10)-1,Ht=parseInt(D.substr(8,2),10),ne=parseInt(D.substr(10,2),10),ge=parseInt(D.substr(12,2),10),Fe=parseInt(D.substr(14,2),10);return new Date(nt,Lt,Ht,ne,ge,Fe,0)},we=C.__private__.setCreationDate=function(D){var nt;if(D===void 0&&(D=new Date),D instanceof Date)nt=ee(D);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(D))throw new Error("Invalid argument passed to jsPDF.setCreationDate");nt=D}return $t=nt},it=C.__private__.getCreationDate=function(D){var nt=$t;return D==="jsDate"&&(nt=Zt($t)),nt};C.setCreationDate=function(D){return we(D),this},C.getCreationDate=function(D){return it(D)};var xt,It=C.__private__.padd2=function(D){return("0"+parseInt(D)).slice(-2)},Ut=C.__private__.padd2Hex=function(D){return("00"+(D=D.toString())).substr(D.length)},jt=0,Vt=[],re=[],te=0,Ce=[],Te=[],De=!1,Qe=re,Je=function(){jt=0,te=0,re=[],Vt=[],Ce=[],Br=xe(),Tr=xe()};C.__private__.setCustomOutputDestination=function(D){De=!0,Qe=D};var he=function(D){De||(Qe=D)};C.__private__.resetCustomOutputDestination=function(){De=!1,Qe=re};var st=C.__private__.out=function(D){return D=D.toString(),te+=D.length+1,Qe.push(D),Qe},fr=C.__private__.write=function(D){return st(arguments.length===1?D.toString():Array.prototype.join.call(arguments," "))},er=C.__private__.getArrayBuffer=function(D){for(var nt=D.length,Lt=new ArrayBuffer(nt),Ht=new Uint8Array(Lt);nt--;)Ht[nt]=D.charCodeAt(nt);return Lt},de=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];C.__private__.getStandardFonts=function(){return de};var ve=r.fontSize||16;C.__private__.setFontSize=C.setFontSize=function(D){return ve=$===V.ADVANCED?D/Re:D,this};var Le,Ue=C.__private__.getFontSize=C.getFontSize=function(){return $===V.COMPAT?ve:ve*Re},Ye=r.R2L||!1;C.__private__.setR2L=C.setR2L=function(D){return Ye=D,this},C.__private__.getR2L=C.getR2L=function(){return Ye};var lr,yr=C.__private__.setZoomMode=function(D){var nt=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(D))Le=D;else if(isNaN(D)){if(nt.indexOf(D)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+D+'" is not recognized.');Le=D}else Le=parseInt(D,10)};C.__private__.getZoomMode=function(){return Le};var Lr,Dr=C.__private__.setPageMode=function(D){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(D)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+D+'" is not recognized.');lr=D};C.__private__.getPageMode=function(){return lr};var pe=C.__private__.setLayoutMode=function(D){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(D)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+D+'" is not recognized.');Lr=D};C.__private__.getLayoutMode=function(){return Lr},C.__private__.setDisplayMode=C.setDisplayMode=function(D,nt,Lt){return yr(D),pe(nt),Dr(Lt),this};var cr={title:"",subject:"",author:"",keywords:"",creator:""};C.__private__.getDocumentProperty=function(D){if(Object.keys(cr).indexOf(D)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return cr[D]},C.__private__.getDocumentProperties=function(){return cr},C.__private__.setDocumentProperties=C.setProperties=C.setDocumentProperties=function(D){for(var nt in cr)cr.hasOwnProperty(nt)&&D[nt]&&(cr[nt]=D[nt]);return this},C.__private__.setDocumentProperty=function(D,nt){if(Object.keys(cr).indexOf(D)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return cr[D]=nt};var _r,Re,An,me,gr,Ne={},Ur={},_n=[],ke={},Qn={},nn={},vn={},ln=null,Ct=0,W=[],X=new eP(C),ft=r.hotfixes||[],Bt={},kt={},Gt=[],Ot=function D(nt,Lt,Ht,ne,ge,Fe){if(!(this instanceof D))return new D(nt,Lt,Ht,ne,ge,Fe);isNaN(nt)&&(nt=1),isNaN(Lt)&&(Lt=0),isNaN(Ht)&&(Ht=0),isNaN(ne)&&(ne=1),isNaN(ge)&&(ge=0),isNaN(Fe)&&(Fe=0),this._matrix=[nt,Lt,Ht,ne,ge,Fe]};Object.defineProperty(Ot.prototype,"sx",{get:function(){return this._matrix[0]},set:function(D){this._matrix[0]=D}}),Object.defineProperty(Ot.prototype,"shy",{get:function(){return this._matrix[1]},set:function(D){this._matrix[1]=D}}),Object.defineProperty(Ot.prototype,"shx",{get:function(){return this._matrix[2]},set:function(D){this._matrix[2]=D}}),Object.defineProperty(Ot.prototype,"sy",{get:function(){return this._matrix[3]},set:function(D){this._matrix[3]=D}}),Object.defineProperty(Ot.prototype,"tx",{get:function(){return this._matrix[4]},set:function(D){this._matrix[4]=D}}),Object.defineProperty(Ot.prototype,"ty",{get:function(){return this._matrix[5]},set:function(D){this._matrix[5]=D}}),Object.defineProperty(Ot.prototype,"a",{get:function(){return this._matrix[0]},set:function(D){this._matrix[0]=D}}),Object.defineProperty(Ot.prototype,"b",{get:function(){return this._matrix[1]},set:function(D){this._matrix[1]=D}}),Object.defineProperty(Ot.prototype,"c",{get:function(){return this._matrix[2]},set:function(D){this._matrix[2]=D}}),Object.defineProperty(Ot.prototype,"d",{get:function(){return this._matrix[3]},set:function(D){this._matrix[3]=D}}),Object.defineProperty(Ot.prototype,"e",{get:function(){return this._matrix[4]},set:function(D){this._matrix[4]=D}}),Object.defineProperty(Ot.prototype,"f",{get:function(){return this._matrix[5]},set:function(D){this._matrix[5]=D}}),Object.defineProperty(Ot.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ot.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ot.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ot.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ot.prototype.join=function(D){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(mt).join(D)},Ot.prototype.multiply=function(D){var nt=D.sx*this.sx+D.shy*this.shx,Lt=D.sx*this.shy+D.shy*this.sy,Ht=D.shx*this.sx+D.sy*this.shx,ne=D.shx*this.shy+D.sy*this.sy,ge=D.tx*this.sx+D.ty*this.shx+this.tx,Fe=D.tx*this.shy+D.ty*this.sy+this.ty;return new Ot(nt,Lt,Ht,ne,ge,Fe)},Ot.prototype.decompose=function(){var D=this.sx,nt=this.shy,Lt=this.shx,Ht=this.sy,ne=this.tx,ge=this.ty,Fe=Math.sqrt(D*D+nt*nt),tr=(D/=Fe)*Lt+(nt/=Fe)*Ht;Lt-=D*tr,Ht-=nt*tr;var Fr=Math.sqrt(Lt*Lt+Ht*Ht);return tr/=Fr,D*(Ht/=Fr)<nt*(Lt/=Fr)&&(D=-D,nt=-nt,tr=-tr,Fe=-Fe),{scale:new Ot(Fe,0,0,Fr,0,0),translate:new Ot(1,0,0,1,ne,ge),rotate:new Ot(D,nt,-nt,D,0,0),skew:new Ot(1,0,tr,1,0,0)}},Ot.prototype.toString=function(D){return this.join(" ")},Ot.prototype.inversed=function(){var D=this.sx,nt=this.shy,Lt=this.shx,Ht=this.sy,ne=this.tx,ge=this.ty,Fe=1/(D*Ht-nt*Lt),tr=Ht*Fe,Fr=-nt*Fe,Kr=-Lt*Fe,Yr=D*Fe;return new Ot(tr,Fr,Kr,Yr,-tr*ne-Kr*ge,-Fr*ne-Yr*ge)},Ot.prototype.applyToPoint=function(D){var nt=D.x*this.sx+D.y*this.shx+this.tx,Lt=D.x*this.shy+D.y*this.sy+this.ty;return new yo(nt,Lt)},Ot.prototype.applyToRectangle=function(D){var nt=this.applyToPoint(D),Lt=this.applyToPoint(new yo(D.x+D.w,D.y+D.h));return new uu(nt.x,nt.y,Lt.x-nt.x,Lt.y-nt.y)},Ot.prototype.clone=function(){var D=this.sx,nt=this.shy,Lt=this.shx,Ht=this.sy,ne=this.tx,ge=this.ty;return new Ot(D,nt,Lt,Ht,ne,ge)},C.Matrix=Ot;var Pt=C.matrixMult=function(D,nt){return nt.multiply(D)},ae=new Ot(1,0,0,1,0,0);C.unitMatrix=C.identityMatrix=ae;var fe=function(D,nt){if(!Qn[D]){var Lt=(nt instanceof ed?"Sh":"P")+(Object.keys(ke).length+1).toString(10);nt.id=Lt,Qn[D]=Lt,ke[Lt]=nt,X.publish("addPattern",nt)}};C.ShadingPattern=ed,C.TilingPattern=Pf,C.addShadingPattern=function(D,nt){return dt("addShadingPattern()"),fe(D,nt),this},C.beginTilingPattern=function(D){dt("beginTilingPattern()"),dh(D.boundingBox[0],D.boundingBox[1],D.boundingBox[2]-D.boundingBox[0],D.boundingBox[3]-D.boundingBox[1],D.matrix)},C.endTilingPattern=function(D,nt){dt("endTilingPattern()"),nt.stream=Te[xt].join(`
`),fe(D,nt),X.publish("endTilingPattern",nt),Gt.pop().restore()};var Jt=C.__private__.newObject=function(){var D=xe();return Ge(D,!0),D},xe=C.__private__.newObjectDeferred=function(){return jt++,Vt[jt]=function(){return te},jt},Ge=function(D,nt){return nt=typeof nt=="boolean"&&nt,Vt[D]=te,nt&&st(D+" 0 obj"),D},nr=C.__private__.newAdditionalObject=function(){var D={objId:xe(),content:""};return Ce.push(D),D},Br=xe(),Tr=xe(),pr=C.__private__.decodeColorString=function(D){var nt=D.split(" ");if(nt.length!==2||nt[1]!=="g"&&nt[1]!=="G")nt.length===5&&(nt[4]==="k"||nt[4]==="K")&&(nt=[(1-nt[0])*(1-nt[3]),(1-nt[1])*(1-nt[3]),(1-nt[2])*(1-nt[3]),"r"]);else{var Lt=parseFloat(nt[0]);nt=[Lt,Lt,Lt,"r"]}for(var Ht="#",ne=0;ne<3;ne++)Ht+=("0"+Math.floor(255*parseFloat(nt[ne])).toString(16)).slice(-2);return Ht},Qr=C.__private__.encodeColorString=function(D){var nt;typeof D=="string"&&(D={ch1:D});var Lt=D.ch1,Ht=D.ch2,ne=D.ch3,ge=D.ch4,Fe=D.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Lt=="string"&&Lt.charAt(0)!=="#"){var tr=new JL(Lt);if(tr.ok)Lt=tr.toHex();else if(!/^\d*\.?\d*$/.test(Lt))throw new Error('Invalid color "'+Lt+'" passed to jsPDF.encodeColorString.')}if(typeof Lt=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Lt)&&(Lt="#"+Lt[1]+Lt[1]+Lt[2]+Lt[2]+Lt[3]+Lt[3]),typeof Lt=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Lt)){var Fr=parseInt(Lt.substr(1),16);Lt=Fr>>16&255,Ht=Fr>>8&255,ne=255&Fr}if(Ht===void 0||ge===void 0&&Lt===Ht&&Ht===ne)if(typeof Lt=="string")nt=Lt+" "+Fe[0];else switch(D.precision){case 2:nt=Tt(Lt/255)+" "+Fe[0];break;case 3:default:nt=ot(Lt/255)+" "+Fe[0]}else if(ge===void 0||Dn(ge)==="object"){if(ge&&!isNaN(ge.a)&&ge.a===0)return nt=["1.","1.","1.",Fe[1]].join(" ");if(typeof Lt=="string")nt=[Lt,Ht,ne,Fe[1]].join(" ");else switch(D.precision){case 2:nt=[Tt(Lt/255),Tt(Ht/255),Tt(ne/255),Fe[1]].join(" ");break;default:case 3:nt=[ot(Lt/255),ot(Ht/255),ot(ne/255),Fe[1]].join(" ")}}else if(typeof Lt=="string")nt=[Lt,Ht,ne,ge,Fe[2]].join(" ");else switch(D.precision){case 2:nt=[Tt(Lt),Tt(Ht),Tt(ne),Tt(ge),Fe[2]].join(" ");break;case 3:default:nt=[ot(Lt),ot(Ht),ot(ne),ot(ge),Fe[2]].join(" ")}return nt},Gr=C.__private__.getFilters=function(){return a},cn=C.__private__.putStream=function(D){var nt=(D=D||{}).data||"",Lt=D.filters||Gr(),Ht=D.alreadyAppliedFilters||[],ne=D.addLength1||!1,ge=nt.length,Fe=D.objectId,tr=function(Hi){return Hi};if(y!==null&&Fe===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");y!==null&&(tr=yn.encryptor(Fe,0));var Fr={};Lt===!0&&(Lt=["FlateEncode"]);var Kr=D.additionalKeyValues||[],Yr=(Fr=Vr.API.processDataByFilters!==void 0?Vr.API.processDataByFilters(nt,Lt):{data:nt,reverseChain:[]}).reverseChain+(Array.isArray(Ht)?Ht.join(" "):Ht.toString());if(Fr.data.length!==0&&(Kr.push({key:"Length",value:Fr.data.length}),ne===!0&&Kr.push({key:"Length1",value:ge})),Yr.length!=0)if(Yr.split("/").length-1==1)Kr.push({key:"Filter",value:Yr});else{Kr.push({key:"Filter",value:"["+Yr+"]"});for(var hn=0;hn<Kr.length;hn+=1)if(Kr[hn].key==="DecodeParms"){for(var kr=[],di=0;di<Fr.reverseChain.split("/").length-1;di+=1)kr.push("null");kr.push(Kr[hn].value),Kr[hn].value="["+kr.join(" ")+"]"}}st("<<");for(var Cr=0;Cr<Kr.length;Cr++)st("/"+Kr[Cr].key+" "+Kr[Cr].value);st(">>"),Fr.data.length!==0&&(st("stream"),st(tr(Fr.data)),st("endstream"))},br=C.__private__.putPage=function(D){var nt=D.number,Lt=D.data,Ht=D.objId,ne=D.contentsObjId;Ge(Ht,!0),st("<</Type /Page"),st("/Parent "+D.rootDictionaryObjId+" 0 R"),st("/Resources "+D.resourceDictionaryObjId+" 0 R"),st("/MediaBox ["+parseFloat(mt(D.mediaBox.bottomLeftX))+" "+parseFloat(mt(D.mediaBox.bottomLeftY))+" "+mt(D.mediaBox.topRightX)+" "+mt(D.mediaBox.topRightY)+"]"),D.cropBox!==null&&st("/CropBox ["+mt(D.cropBox.bottomLeftX)+" "+mt(D.cropBox.bottomLeftY)+" "+mt(D.cropBox.topRightX)+" "+mt(D.cropBox.topRightY)+"]"),D.bleedBox!==null&&st("/BleedBox ["+mt(D.bleedBox.bottomLeftX)+" "+mt(D.bleedBox.bottomLeftY)+" "+mt(D.bleedBox.topRightX)+" "+mt(D.bleedBox.topRightY)+"]"),D.trimBox!==null&&st("/TrimBox ["+mt(D.trimBox.bottomLeftX)+" "+mt(D.trimBox.bottomLeftY)+" "+mt(D.trimBox.topRightX)+" "+mt(D.trimBox.topRightY)+"]"),D.artBox!==null&&st("/ArtBox ["+mt(D.artBox.bottomLeftX)+" "+mt(D.artBox.bottomLeftY)+" "+mt(D.artBox.topRightX)+" "+mt(D.artBox.topRightY)+"]"),typeof D.userUnit=="number"&&D.userUnit!==1&&st("/UserUnit "+D.userUnit),X.publish("putPage",{objId:Ht,pageContext:W[nt],pageNumber:nt,page:Lt}),st("/Contents "+ne+" 0 R"),st(">>"),st("endobj");var ge=Lt.join(`
`);return $===V.ADVANCED&&(ge+=`
Q`),Ge(ne,!0),cn({data:ge,filters:Gr(),objectId:ne}),st("endobj"),Ht},jr=C.__private__.putPages=function(){var D,nt,Lt=[];for(D=1;D<=Ct;D++)W[D].objId=xe(),W[D].contentsObjId=xe();for(D=1;D<=Ct;D++)Lt.push(br({number:D,data:Te[D],objId:W[D].objId,contentsObjId:W[D].contentsObjId,mediaBox:W[D].mediaBox,cropBox:W[D].cropBox,bleedBox:W[D].bleedBox,trimBox:W[D].trimBox,artBox:W[D].artBox,userUnit:W[D].userUnit,rootDictionaryObjId:Br,resourceDictionaryObjId:Tr}));Ge(Br,!0),st("<</Type /Pages");var Ht="/Kids [";for(nt=0;nt<Ct;nt++)Ht+=Lt[nt]+" 0 R ";st(Ht+"]"),st("/Count "+Ct),st(">>"),st("endobj"),X.publish("postPutPages")},sn=function(D){X.publish("putFont",{font:D,out:st,newObject:Jt,putStream:cn}),D.isAlreadyPutted!==!0&&(D.objectNumber=Jt(),st("<<"),st("/Type /Font"),st("/BaseFont /"+Lf(D.postScriptName)),st("/Subtype /Type1"),typeof D.encoding=="string"&&st("/Encoding /"+D.encoding),st("/FirstChar 32"),st("/LastChar 255"),st(">>"),st("endobj"))},Sn=function(){for(var D in Ne)Ne.hasOwnProperty(D)&&(b===!1||b===!0&&x.hasOwnProperty(D))&&sn(Ne[D])},Mt=function(D){D.objectNumber=Jt();var nt=[];nt.push({key:"Type",value:"/XObject"}),nt.push({key:"Subtype",value:"/Form"}),nt.push({key:"BBox",value:"["+[mt(D.x),mt(D.y),mt(D.x+D.width),mt(D.y+D.height)].join(" ")+"]"}),nt.push({key:"Matrix",value:"["+D.matrix.toString()+"]"});var Lt=D.pages[1].join(`
`);cn({data:Lt,additionalKeyValues:nt,objectId:D.objectNumber}),st("endobj")},Oe=function(){for(var D in Bt)Bt.hasOwnProperty(D)&&Mt(Bt[D])},Ee=function(D,nt){var Lt,Ht=[],ne=1/(nt-1);for(Lt=0;Lt<1;Lt+=ne)Ht.push(Lt);if(Ht.push(1),D[0].offset!=0){var ge={offset:0,color:D[0].color};D.unshift(ge)}if(D[D.length-1].offset!=1){var Fe={offset:1,color:D[D.length-1].color};D.push(Fe)}for(var tr="",Fr=0,Kr=0;Kr<Ht.length;Kr++){for(Lt=Ht[Kr];Lt>D[Fr+1].offset;)Fr++;var Yr=D[Fr].offset,hn=(Lt-Yr)/(D[Fr+1].offset-Yr),kr=D[Fr].color,di=D[Fr+1].color;tr+=Ut(Math.round((1-hn)*kr[0]+hn*di[0]).toString(16))+Ut(Math.round((1-hn)*kr[1]+hn*di[1]).toString(16))+Ut(Math.round((1-hn)*kr[2]+hn*di[2]).toString(16))}return tr.trim()},or=function(D,nt){nt||(nt=21);var Lt=Jt(),Ht=Ee(D.colors,nt),ne=[];ne.push({key:"FunctionType",value:"0"}),ne.push({key:"Domain",value:"[0.0 1.0]"}),ne.push({key:"Size",value:"["+nt+"]"}),ne.push({key:"BitsPerSample",value:"8"}),ne.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ne.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),cn({data:Ht,additionalKeyValues:ne,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Lt}),st("endobj"),D.objectNumber=Jt(),st("<< /ShadingType "+D.type),st("/ColorSpace /DeviceRGB");var ge="/Coords ["+mt(parseFloat(D.coords[0]))+" "+mt(parseFloat(D.coords[1]))+" ";D.type===2?ge+=mt(parseFloat(D.coords[2]))+" "+mt(parseFloat(D.coords[3])):ge+=mt(parseFloat(D.coords[2]))+" "+mt(parseFloat(D.coords[3]))+" "+mt(parseFloat(D.coords[4]))+" "+mt(parseFloat(D.coords[5])),st(ge+="]"),D.matrix&&st("/Matrix ["+D.matrix.toString()+"]"),st("/Function "+Lt+" 0 R"),st("/Extend [true true]"),st(">>"),st("endobj")},Pr=function(D,nt){var Lt=xe(),Ht=Jt();nt.push({resourcesOid:Lt,objectOid:Ht}),D.objectNumber=Ht;var ne=[];ne.push({key:"Type",value:"/Pattern"}),ne.push({key:"PatternType",value:"1"}),ne.push({key:"PaintType",value:"1"}),ne.push({key:"TilingType",value:"1"}),ne.push({key:"BBox",value:"["+D.boundingBox.map(mt).join(" ")+"]"}),ne.push({key:"XStep",value:mt(D.xStep)}),ne.push({key:"YStep",value:mt(D.yStep)}),ne.push({key:"Resources",value:Lt+" 0 R"}),D.matrix&&ne.push({key:"Matrix",value:"["+D.matrix.toString()+"]"}),cn({data:D.stream,additionalKeyValues:ne,objectId:D.objectNumber}),st("endobj")},Mn=function(D){var nt;for(nt in ke)ke.hasOwnProperty(nt)&&(ke[nt]instanceof ed?or(ke[nt]):ke[nt]instanceof Pf&&Pr(ke[nt],D))},qr=function(D){for(var nt in D.objectNumber=Jt(),st("<<"),D)switch(nt){case"opacity":st("/ca "+Tt(D[nt]));break;case"stroke-opacity":st("/CA "+Tt(D[nt]))}st(">>"),st("endobj")},gn=function(){var D;for(D in nn)nn.hasOwnProperty(D)&&qr(nn[D])},vi=function(){for(var D in st("/XObject <<"),Bt)Bt.hasOwnProperty(D)&&Bt[D].objectNumber>=0&&st("/"+D+" "+Bt[D].objectNumber+" 0 R");X.publish("putXobjectDict"),st(">>")},mn=function(){yn.oid=Jt(),st("<<"),st("/Filter /Standard"),st("/V "+yn.v),st("/R "+yn.r),st("/U <"+yn.toHexString(yn.U)+">"),st("/O <"+yn.toHexString(yn.O)+">"),st("/P "+yn.P),st(">>"),st("endobj")},Wr=function(){for(var D in st("/Font <<"),Ne)Ne.hasOwnProperty(D)&&(b===!1||b===!0&&x.hasOwnProperty(D))&&st("/"+D+" "+Ne[D].objectNumber+" 0 R");st(">>")},Da=function(){if(Object.keys(ke).length>0){for(var D in st("/Shading <<"),ke)ke.hasOwnProperty(D)&&ke[D]instanceof ed&&ke[D].objectNumber>=0&&st("/"+D+" "+ke[D].objectNumber+" 0 R");X.publish("putShadingPatternDict"),st(">>")}},Xs=function(D){if(Object.keys(ke).length>0){for(var nt in st("/Pattern <<"),ke)ke.hasOwnProperty(nt)&&ke[nt]instanceof C.TilingPattern&&ke[nt].objectNumber>=0&&ke[nt].objectNumber<D&&st("/"+nt+" "+ke[nt].objectNumber+" 0 R");X.publish("putTilingPatternDict"),st(">>")}},zn=function(){if(Object.keys(nn).length>0){var D;for(D in st("/ExtGState <<"),nn)nn.hasOwnProperty(D)&&nn[D].objectNumber>=0&&st("/"+D+" "+nn[D].objectNumber+" 0 R");X.publish("putGStateDict"),st(">>")}},Jr=function(D){Ge(D.resourcesOid,!0),st("<<"),st("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Wr(),Da(),Xs(D.objectOid),zn(),vi(),st(">>"),st("endobj")},vs=function(){var D=[];Sn(),gn(),Oe(),Mn(D),X.publish("putResources"),D.forEach(Jr),Jr({resourcesOid:Tr,objectOid:Number.MAX_SAFE_INTEGER}),X.publish("postPutResources")},Nn=function(){X.publish("putAdditionalObjects");for(var D=0;D<Ce.length;D++){var nt=Ce[D];Ge(nt.objId,!0),st(nt.content),st("endobj")}X.publish("postPutAdditionalObjects")},Qo=function(D){Ur[D.fontName]=Ur[D.fontName]||{},Ur[D.fontName][D.fontStyle]=D.id},Ti=function(D,nt,Lt,Ht,ne){var ge={id:"F"+(Object.keys(Ne).length+1).toString(10),postScriptName:D,fontName:nt,fontStyle:Lt,encoding:Ht,isStandardFont:ne||!1,metadata:{}};return X.publish("addFont",{font:ge,instance:this}),Ne[ge.id]=ge,Qo(ge),ge.id},zo=function(D){for(var nt=0,Lt=de.length;nt<Lt;nt++){var Ht=Ti.call(this,D[nt][0],D[nt][1],D[nt][2],de[nt][3],!0);b===!1&&(x[Ht]=!0);var ne=D[nt][0].split("-");Qo({id:Ht,fontName:ne[0],fontStyle:ne[1]||""})}X.publish("addFonts",{fonts:Ne,dictionary:Ur})},hi=function(D){return D.foo=function(){try{return D.apply(this,arguments)}catch(Ht){var nt=Ht.stack||"";~nt.indexOf(" at ")&&(nt=nt.split(" at ")[1]);var Lt="Error in function "+nt.split(`
`)[0].split("<")[0]+": "+Ht.message;if(!Hr.console)throw new Error(Lt);Hr.console.error(Lt,Ht),Hr.alert&&alert(Lt)}},D.foo.bar=D,D.foo},ts=function(D,nt){var Lt,Ht,ne,ge,Fe,tr,Fr,Kr,Yr;if(ne=(nt=nt||{}).sourceEncoding||"Unicode",Fe=nt.outputEncoding,(nt.autoencode||Fe)&&Ne[_r].metadata&&Ne[_r].metadata[ne]&&Ne[_r].metadata[ne].encoding&&(ge=Ne[_r].metadata[ne].encoding,!Fe&&Ne[_r].encoding&&(Fe=Ne[_r].encoding),!Fe&&ge.codePages&&(Fe=ge.codePages[0]),typeof Fe=="string"&&(Fe=ge[Fe]),Fe)){for(Fr=!1,tr=[],Lt=0,Ht=D.length;Lt<Ht;Lt++)(Kr=Fe[D.charCodeAt(Lt)])?tr.push(String.fromCharCode(Kr)):tr.push(D[Lt]),tr[Lt].charCodeAt(0)>>8&&(Fr=!0);D=tr.join("")}for(Lt=D.length;Fr===void 0&&Lt!==0;)D.charCodeAt(Lt-1)>>8&&(Fr=!0),Lt--;if(!Fr)return D;for(tr=nt.noBOM?[]:[254,255],Lt=0,Ht=D.length;Lt<Ht;Lt++){if((Yr=(Kr=D.charCodeAt(Lt))>>8)>>8)throw new Error("Character at position "+Lt+" of string '"+D+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");tr.push(Yr),tr.push(Kr-(Yr<<8))}return String.fromCharCode.apply(void 0,tr)},Ii=C.__private__.pdfEscape=C.pdfEscape=function(D,nt){return ts(D,nt).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},bs=C.__private__.beginPage=function(D){Te[++Ct]=[],W[Ct]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(D[0]),topRightY:Number(D[1])}},_l(Ct),he(Te[xt])},tn=function(D,nt){var Lt,Ht,ne;switch(e=nt||e,typeof D=="string"&&(Lt=z(D.toLowerCase()),Array.isArray(Lt)&&(Ht=Lt[0],ne=Lt[1])),Array.isArray(D)&&(Ht=D[0]*Re,ne=D[1]*Re),isNaN(Ht)&&(Ht=i[0],ne=i[1]),(Ht>14400||ne>14400)&&(Ai.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ht=Math.min(14400,Ht),ne=Math.min(14400,ne)),i=[Ht,ne],e.substr(0,1)){case"l":ne>Ht&&(i=[ne,Ht]);break;case"p":Ht>ne&&(i=[ne,Ht])}bs(i),ou(bc),st(Go),lu!==0&&st(lu+" J"),cu!==0&&st(cu+" j"),X.publish("addPage",{pageNumber:Ct})},Na=function(D){D>0&&D<=Ct&&(Te.splice(D,1),W.splice(D,1),Ct--,xt>Ct&&(xt=Ct),this.setPage(xt))},_l=function(D){D>0&&D<=Ct&&(xt=D)},ka=C.__private__.getNumberOfPages=C.getNumberOfPages=function(){return Te.length-1},ht=function(D,nt,Lt){var Ht,ne=void 0;return Lt=Lt||{},D=D!==void 0?D:Ne[_r].fontName,nt=nt!==void 0?nt:Ne[_r].fontStyle,Ht=D.toLowerCase(),Ur[Ht]!==void 0&&Ur[Ht][nt]!==void 0?ne=Ur[Ht][nt]:Ur[D]!==void 0&&Ur[D][nt]!==void 0?ne=Ur[D][nt]:Lt.disableWarning===!1&&Ai.warn("Unable to look up font label for font '"+D+"', '"+nt+"'. Refer to getFontList() for available fonts."),ne||Lt.noFallback||(ne=Ur.times[nt])==null&&(ne=Ur.times.normal),ne},bt=C.__private__.putInfo=function(){var D=Jt(),nt=function(Ht){return Ht};for(var Lt in y!==null&&(nt=yn.encryptor(D,0)),st("<<"),st("/Producer ("+Ii(nt("jsPDF "+Vr.version))+")"),cr)cr.hasOwnProperty(Lt)&&cr[Lt]&&st("/"+Lt.substr(0,1).toUpperCase()+Lt.substr(1)+" ("+Ii(nt(cr[Lt]))+")");st("/CreationDate ("+Ii(nt($t))+")"),st(">>"),st("endobj")},Nt=C.__private__.putCatalog=function(D){var nt=(D=D||{}).rootDictionaryObjId||Br;switch(Jt(),st("<<"),st("/Type /Catalog"),st("/Pages "+nt+" 0 R"),Le||(Le="fullwidth"),Le){case"fullwidth":st("/OpenAction [3 0 R /FitH null]");break;case"fullheight":st("/OpenAction [3 0 R /FitV null]");break;case"fullpage":st("/OpenAction [3 0 R /Fit]");break;case"original":st("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Lt=""+Le;Lt.substr(Lt.length-1)==="%"&&(Le=parseInt(Le)/100),typeof Le=="number"&&st("/OpenAction [3 0 R /XYZ null null "+Tt(Le)+"]")}switch(Lr||(Lr="continuous"),Lr){case"continuous":st("/PageLayout /OneColumn");break;case"single":st("/PageLayout /SinglePage");break;case"two":case"twoleft":st("/PageLayout /TwoColumnLeft");break;case"tworight":st("/PageLayout /TwoColumnRight")}lr&&st("/PageMode /"+lr),X.publish("putCatalog"),st(">>"),st("endobj")},le=C.__private__.putTrailer=function(){st("trailer"),st("<<"),st("/Size "+(jt+1)),st("/Root "+jt+" 0 R"),st("/Info "+(jt-1)+" 0 R"),y!==null&&st("/Encrypt "+yn.oid+" 0 R"),st("/ID [ <"+Wt+"> <"+Wt+"> ]"),st(">>")},Ie=C.__private__.putHeader=function(){st("%PDF-"+P),st("%")},Ze=C.__private__.putXRef=function(){var D="0000000000";st("xref"),st("0 "+(jt+1)),st("0000000000 65535 f ");for(var nt=1;nt<=jt;nt++)typeof Vt[nt]=="function"?st((D+Vt[nt]()).slice(-10)+" 00000 n "):Vt[nt]!==void 0?st((D+Vt[nt]).slice(-10)+" 00000 n "):st("0000000000 00000 n ")},zr=C.__private__.buildDocument=function(){Je(),he(re),X.publish("buildDocument"),Ie(),jr(),Nn(),vs(),y!==null&&mn(),bt(),Nt();var D=te;return Ze(),le(),st("startxref"),st(""+D),st("%%EOF"),he(Te[xt]),re.join(`
`)},Zn=C.__private__.getBlob=function(D){return new Blob([er(D)],{type:"application/pdf"})},ti=C.output=C.__private__.output=hi(function(D,nt){switch(typeof(nt=nt||{})=="string"?nt={filename:nt}:nt.filename=nt.filename||"generated.pdf",D){case void 0:return zr();case"save":C.save(nt.filename);break;case"arraybuffer":return er(zr());case"blob":return Zn(zr());case"bloburi":case"bloburl":if(Hr.URL!==void 0&&typeof Hr.URL.createObjectURL=="function")return Hr.URL&&Hr.URL.createObjectURL(Zn(zr()))||void 0;Ai.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Lt="",Ht=zr();try{Lt=O2(Ht)}catch{Lt=O2(unescape(encodeURIComponent(Ht)))}return"data:application/pdf;filename="+nt.filename+";base64,"+Lt;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Hr)==="[object Window]"){var ne="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ge=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';nt.pdfObjectUrl&&(ne=nt.pdfObjectUrl,ge="");var Fe='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ne+'"'+ge+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(nt)+");<\/script></body></html>",tr=Hr.open();return tr!==null&&tr.document.write(Fe),tr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Hr)==="[object Window]"){var Fr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(nt.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+nt.filename+'" width="500px" height="400px" /></body></html>',Kr=Hr.open();if(Kr!==null){Kr.document.write(Fr);var Yr=this;Kr.document.documentElement.querySelector("#pdfViewer").onload=function(){Kr.document.title=nt.filename,Kr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Yr.output("bloburl"))}}return Kr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Hr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var hn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",nt)+'"></iframe></body></html>',kr=Hr.open();if(kr!==null&&(kr.document.write(hn),kr.document.title=nt.filename),kr||typeof safari>"u")return kr;break;case"datauri":case"dataurl":return Hr.document.location.href=this.output("datauristring",nt);default:return null}}),Fi=function(D){return Array.isArray(ft)===!0&&ft.indexOf(D)>-1};switch(n){case"pt":Re=1;break;case"mm":Re=72/25.4;break;case"cm":Re=72/2.54;break;case"in":Re=72;break;case"px":Re=Fi("px_scaling")==1?.75:96/72;break;case"pc":case"em":Re=12;break;case"ex":Re=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Re=n}var yn=null;we(),Kt();var yc=function(D){return y!==null?yn.encryptor(D,0):function(nt){return nt}},As=C.__private__.getPageInfo=C.getPageInfo=function(D){if(isNaN(D)||D%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:W[D].objId,pageNumber:D,pageContext:W[D]}},Ir=C.__private__.getPageInfoByObjId=function(D){if(isNaN(D)||D%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var nt in W)if(W[nt].objId===D)break;return As(nt)},_c=C.__private__.getCurrentPageInfo=C.getCurrentPageInfo=function(){return{objId:W[xt].objId,pageNumber:xt,pageContext:W[xt]}};C.addPage=function(){return tn.apply(this,arguments),this},C.setPage=function(){return _l.apply(this,arguments),he.call(this,Te[xt]),this},C.insertPage=function(D){return this.addPage(),this.movePage(xt,D),this},C.movePage=function(D,nt){var Lt,Ht;if(D>nt){Lt=Te[D],Ht=W[D];for(var ne=D;ne>nt;ne--)Te[ne]=Te[ne-1],W[ne]=W[ne-1];Te[nt]=Lt,W[nt]=Ht,this.setPage(nt)}else if(D<nt){Lt=Te[D],Ht=W[D];for(var ge=D;ge<nt;ge++)Te[ge]=Te[ge+1],W[ge]=W[ge+1];Te[nt]=Lt,W[nt]=Ht,this.setPage(nt)}return this},C.deletePage=function(){return Na.apply(this,arguments),this},C.__private__.text=C.text=function(D,nt,Lt,Ht,ne){var ge,Fe,tr,Fr,Kr,Yr,hn,kr,di,Cr=(Ht=Ht||{}).scope||this;if(typeof D=="number"&&typeof nt=="number"&&(typeof Lt=="string"||Array.isArray(Lt))){var Hi=Lt;Lt=nt,nt=D,D=Hi}if(arguments[3]instanceof Ot?(dt("The transform parameter of text() with a Matrix value"),di=ne):(tr=arguments[4],Fr=arguments[5],Dn(hn=arguments[3])==="object"&&hn!==null||(typeof tr=="string"&&(Fr=tr,tr=null),typeof hn=="string"&&(Fr=hn,hn=null),typeof hn=="number"&&(tr=hn,hn=null),Ht={flags:hn,angle:tr,align:Fr})),isNaN(nt)||isNaN(Lt)||D==null)throw new Error("Invalid arguments passed to jsPDF.text");if(D.length===0)return Cr;var Xr="",dn=!1,hs=typeof Ht.lineHeightFactor=="number"?Ht.lineHeightFactor:Qa,pa=Cr.internal.scaleFactor;function Au(en){return en=en.split("	").join(Array(Ht.TabLen||9).join(" ")),Ii(en,hn)}function Bl(en){for(var Fn,fi=en.concat(),bi=[],Wo=fi.length;Wo--;)typeof(Fn=fi.shift())=="string"?bi.push(Fn):Array.isArray(en)&&(Fn.length===1||Fn[1]===void 0&&Fn[2]===void 0)?bi.push(Fn[0]):bi.push([Fn[0],Fn[1],Fn[2]]);return bi}function Cl(en,Fn){var fi;if(typeof en=="string")fi=Fn(en)[0];else if(Array.isArray(en)){for(var bi,Wo,Zs=en.concat(),Pl=[],Xa=Zs.length;Xa--;)typeof(bi=Zs.shift())=="string"?Pl.push(Fn(bi)[0]):Array.isArray(bi)&&typeof bi[0]=="string"&&(Wo=Fn(bi[0],bi[1],bi[2]),Pl.push([Wo[0],Wo[1],Wo[2]]));fi=Pl}return fi}var Va=!1,Bc=!0;if(typeof D=="string")Va=!0;else if(Array.isArray(D)){var _o=D.concat();Fe=[];for(var vo,Wn=_o.length;Wn--;)(typeof(vo=_o.shift())!="string"||Array.isArray(vo)&&typeof vo[0]!="string")&&(Bc=!1);Va=Bc}if(Va===!1)throw new Error('Type of text must be string or Array. "'+D+'" is not recognized.');typeof D=="string"&&(D=D.match(/[\r?\n]/)?D.split(/\r\n|\r|\n/g):[D]);var El=ve/Cr.internal.scaleFactor,Ga=El*(hs-1);switch(Ht.baseline){case"bottom":Lt-=Ga;break;case"top":Lt+=El-Ga;break;case"hanging":Lt+=El-2*Ga;break;case"middle":Lt+=El/2-Ga}if((Yr=Ht.maxWidth||0)>0&&(typeof D=="string"?D=Cr.splitTextToSize(D,Yr):Object.prototype.toString.call(D)==="[object Array]"&&(D=D.reduce(function(en,Fn){return en.concat(Cr.splitTextToSize(Fn,Yr))},[]))),ge={text:D,x:nt,y:Lt,options:Ht,mutex:{pdfEscape:Ii,activeFontKey:_r,fonts:Ne,activeFontSize:ve}},X.publish("preProcessText",ge),D=ge.text,tr=(Ht=ge.options).angle,!(di instanceof Ot)&&tr&&typeof tr=="number"){tr*=Math.PI/180,Ht.rotationDirection===0&&(tr=-tr),$===V.ADVANCED&&(tr=-tr);var Sl=Math.cos(tr),jo=Math.sin(tr);di=new Ot(Sl,jo,-jo,Sl,0,0)}else tr&&tr instanceof Ot&&(di=tr);$!==V.ADVANCED||di||(di=ae),(Kr=Ht.charSpace||bl)!==void 0&&(Xr+=mt(ct(Kr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(kr=Ht.horizontalScale)!==void 0&&(Xr+=mt(100*kr)+` Tz
`),Ht.lang;var es=-1,hu=Ht.renderingMode!==void 0?Ht.renderingMode:Ht.stroke,ja=Cr.internal.getCurrentPageInfo().pageContext;switch(hu){case 0:case!1:case"fill":es=0;break;case 1:case!0:case"stroke":es=1;break;case 2:case"fillThenStroke":es=2;break;case 3:case"invisible":es=3;break;case 4:case"fillAndAddForClipping":es=4;break;case 5:case"strokeAndAddPathForClipping":es=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":es=6;break;case 7:case"addToPathForClipping":es=7}var Cc=ja.usedRenderingMode!==void 0?ja.usedRenderingMode:-1;es!==-1?Xr+=es+` Tr
`:Cc!==-1&&(Xr+=`0 Tr
`),es!==-1&&(ja.usedRenderingMode=es),Fr=Ht.align||"left";var bo,ga=ve*hs,qa=Cr.internal.pageSize.getWidth(),cA=Ne[_r];Kr=Ht.charSpace||bl,Yr=Ht.maxWidth||0,hn=Object.assign({autoencode:!0,noBOM:!0},Ht.flags);var Ys=[];if(Object.prototype.toString.call(D)==="[object Array]"){var $r;Fe=Bl(D),Fr!=="left"&&(bo=Fe.map(function(en){return Cr.getStringUnitWidth(en,{font:cA,charSpace:Kr,fontSize:ve,doKerning:!1})*ve/pa}));var xs,Ka=0;if(Fr==="right"){nt-=bo[0],D=[],Wn=Fe.length;for(var qo=0;qo<Wn;qo++)qo===0?(xs=Ha(nt),$r=Vo(Lt)):(xs=ct(Ka-bo[qo]),$r=-ga),D.push([Fe[qo],xs,$r]),Ka=bo[qo]}else if(Fr==="center"){nt-=bo[0]/2,D=[],Wn=Fe.length;for(var Bs=0;Bs<Wn;Bs++)Bs===0?(xs=Ha(nt),$r=Vo(Lt)):(xs=ct((Ka-bo[Bs])/2),$r=-ga),D.push([Fe[Bs],xs,$r]),Ka=bo[Bs]}else if(Fr==="left"){D=[],Wn=Fe.length;for(var $a=0;$a<Wn;$a++)D.push(Fe[$a])}else{if(Fr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');D=[],Wn=Fe.length,Yr=Yr!==0?Yr:qa;for(var ks=0;ks<Wn;ks++)$r=ks===0?Vo(Lt):-ga,xs=ks===0?Ha(nt):0,ks<Wn-1?Ys.push(mt(ct((Yr-bo[ks])/(Fe[ks].split(" ").length-1)))):Ys.push(0),D.push([Fe[ks],xs,$r])}}var Tl=typeof Ht.R2L=="boolean"?Ht.R2L:Ye;Tl===!0&&(D=Cl(D,function(en,Fn,fi){return[en.split("").reverse().join(""),Fn,fi]})),ge={text:D,x:nt,y:Lt,options:Ht,mutex:{pdfEscape:Ii,activeFontKey:_r,fonts:Ne,activeFontSize:ve}},X.publish("postProcessText",ge),D=ge.text,dn=ge.mutex.isHex||!1;var Ec=Ne[_r].encoding;Ec!=="WinAnsiEncoding"&&Ec!=="StandardEncoding"||(D=Cl(D,function(en,Fn,fi){return[Au(en),Fn,fi]})),Fe=Bl(D),D=[];for(var Ko,Cs,Es,Wa=0,Il=1,Fl=Array.isArray(Fe[0])?Il:Wa,$o="",Ll=function(en,Fn,fi){var bi="";return fi instanceof Ot?(fi=typeof Ht.angle=="number"?Pt(fi,new Ot(1,0,0,1,en,Fn)):Pt(new Ot(1,0,0,1,en,Fn),fi),$===V.ADVANCED&&(fi=Pt(new Ot(1,0,0,-1,0,0),fi)),bi=fi.join(" ")+` Tm
`):bi=mt(en)+" "+mt(Fn)+` Td
`,bi},rs=0;rs<Fe.length;rs++){switch($o="",Fl){case Il:Es=(dn?"<":"(")+Fe[rs][0]+(dn?">":")"),Ko=parseFloat(Fe[rs][1]),Cs=parseFloat(Fe[rs][2]);break;case Wa:Es=(dn?"<":"(")+Fe[rs]+(dn?">":")"),Ko=Ha(nt),Cs=Vo(Lt)}Ys!==void 0&&Ys[rs]!==void 0&&($o=Ys[rs]+` Tw
`),rs===0?D.push($o+Ll(Ko,Cs,di)+Es):Fl===Wa?D.push($o+Es):Fl===Il&&D.push($o+Ll(Ko,Cs,di)+Es)}D=Fl===Wa?D.join(` Tj
T* `):D.join(` Tj
`),D+=` Tj
`;var wo=`BT
/`;return wo+=_r+" "+ve+` Tf
`,wo+=mt(ve*hs)+` TL
`,wo+=wc+`
`,wo+=Xr,wo+=D,st(wo+="ET"),x[_r]=!0,Cr};var iu=C.__private__.clip=C.clip=function(D){return st(D==="evenodd"?"W*":"W"),this};C.clipEvenOdd=function(){return iu("evenodd")},C.__private__.discardPath=C.discardPath=function(){return st("n"),this};var Ho=C.__private__.isValidStyle=function(D){var nt=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(D)!==-1&&(nt=!0),nt};C.__private__.setDefaultPathOperation=C.setDefaultPathOperation=function(D){return Ho(D)&&(p=D),this};var nA=C.__private__.getStyle=C.getStyle=function(D){var nt=p;switch(D){case"D":case"S":nt="S";break;case"F":nt="f";break;case"FD":case"DF":nt="B";break;case"f":case"f*":case"B":case"B*":nt=D}return nt},Aa=C.close=function(){return st("h"),this};C.stroke=function(){return st("S"),this},C.fill=function(D){return vc("f",D),this},C.fillEvenOdd=function(D){return vc("f*",D),this},C.fillStroke=function(D){return vc("B",D),this},C.fillStrokeEvenOdd=function(D){return vc("B*",D),this};var vc=function(D,nt){Dn(nt)==="object"?ch(nt,D):st(D)},iA=function(D){D===null||$===V.ADVANCED&&D===void 0||(D=nA(D),st(D))};function Ed(D,nt,Lt,Ht,ne){var ge=new Pf(nt||this.boundingBox,Lt||this.xStep,Ht||this.yStep,this.gState,ne||this.matrix);ge.stream=this.stream;var Fe=D+"$$"+this.cloneIndex+++"$$";return fe(Fe,ge),ge}var ch=function(D,nt){var Lt=Qn[D.key],Ht=ke[Lt];if(Ht instanceof ed)st("q"),st(uh(nt)),Ht.gState&&C.setGState(Ht.gState),st(D.matrix.toString()+" cm"),st("/"+Lt+" sh"),st("Q");else if(Ht instanceof Pf){var ne=new Ot(1,0,0,-1,0,xl());D.matrix&&(ne=ne.multiply(D.matrix||ae),Lt=Ed.call(Ht,D.key,D.boundingBox,D.xStep,D.yStep,ne).id),st("q"),st("/Pattern cs"),st("/"+Lt+" scn"),Ht.gState&&C.setGState(Ht.gState),st(nt),st("Q")}},uh=function(D){switch(D){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},sA=C.moveTo=function(D,nt){return st(mt(ct(D))+" "+mt(vt(nt))+" m"),this},ha=C.lineTo=function(D,nt){return st(mt(ct(D))+" "+mt(vt(nt))+" l"),this},da=C.curveTo=function(D,nt,Lt,Ht,ne,ge){return st([mt(ct(D)),mt(vt(nt)),mt(ct(Lt)),mt(vt(Ht)),mt(ct(ne)),mt(vt(ge)),"c"].join(" ")),this};C.__private__.line=C.line=function(D,nt,Lt,Ht,ne){if(isNaN(D)||isNaN(nt)||isNaN(Lt)||isNaN(Ht)||!Ho(ne))throw new Error("Invalid arguments passed to jsPDF.line");return $===V.COMPAT?this.lines([[Lt-D,Ht-nt]],D,nt,[1,1],ne||"S"):this.lines([[Lt-D,Ht-nt]],D,nt,[1,1]).stroke()},C.__private__.lines=C.lines=function(D,nt,Lt,Ht,ne,ge){var Fe,tr,Fr,Kr,Yr,hn,kr,di,Cr,Hi,Xr,dn;if(typeof D=="number"&&(dn=Lt,Lt=nt,nt=D,D=dn),Ht=Ht||[1,1],ge=ge||!1,isNaN(nt)||isNaN(Lt)||!Array.isArray(D)||!Array.isArray(Ht)||!Ho(ne)||typeof ge!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(sA(nt,Lt),Fe=Ht[0],tr=Ht[1],Kr=D.length,Hi=nt,Xr=Lt,Fr=0;Fr<Kr;Fr++)(Yr=D[Fr]).length===2?(Hi=Yr[0]*Fe+Hi,Xr=Yr[1]*tr+Xr,ha(Hi,Xr)):(hn=Yr[0]*Fe+Hi,kr=Yr[1]*tr+Xr,di=Yr[2]*Fe+Hi,Cr=Yr[3]*tr+Xr,Hi=Yr[4]*Fe+Hi,Xr=Yr[5]*tr+Xr,da(hn,kr,di,Cr,Hi,Xr));return ge&&Aa(),iA(ne),this},C.path=function(D){for(var nt=0;nt<D.length;nt++){var Lt=D[nt],Ht=Lt.c;switch(Lt.op){case"m":sA(Ht[0],Ht[1]);break;case"l":ha(Ht[0],Ht[1]);break;case"c":da.apply(this,Ht);break;case"h":Aa()}}return this},C.__private__.rect=C.rect=function(D,nt,Lt,Ht,ne){if(isNaN(D)||isNaN(nt)||isNaN(Lt)||isNaN(Ht)||!Ho(ne))throw new Error("Invalid arguments passed to jsPDF.rect");return $===V.COMPAT&&(Ht=-Ht),st([mt(ct(D)),mt(vt(nt)),mt(ct(Lt)),mt(ct(Ht)),"re"].join(" ")),iA(ne),this},C.__private__.triangle=C.triangle=function(D,nt,Lt,Ht,ne,ge,Fe){if(isNaN(D)||isNaN(nt)||isNaN(Lt)||isNaN(Ht)||isNaN(ne)||isNaN(ge)||!Ho(Fe))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Lt-D,Ht-nt],[ne-Lt,ge-Ht],[D-ne,nt-ge]],D,nt,[1,1],Fe,!0),this},C.__private__.roundedRect=C.roundedRect=function(D,nt,Lt,Ht,ne,ge,Fe){if(isNaN(D)||isNaN(nt)||isNaN(Lt)||isNaN(Ht)||isNaN(ne)||isNaN(ge)||!Ho(Fe))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var tr=4/3*(Math.SQRT2-1);return ne=Math.min(ne,.5*Lt),ge=Math.min(ge,.5*Ht),this.lines([[Lt-2*ne,0],[ne*tr,0,ne,ge-ge*tr,ne,ge],[0,Ht-2*ge],[0,ge*tr,-ne*tr,ge,-ne,ge],[2*ne-Lt,0],[-ne*tr,0,-ne,-ge*tr,-ne,-ge],[0,2*ge-Ht],[0,-ge*tr,ne*tr,-ge,ne,-ge]],D+ne,nt,[1,1],Fe,!0),this},C.__private__.ellipse=C.ellipse=function(D,nt,Lt,Ht,ne){if(isNaN(D)||isNaN(nt)||isNaN(Lt)||isNaN(Ht)||!Ho(ne))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ge=4/3*(Math.SQRT2-1)*Lt,Fe=4/3*(Math.SQRT2-1)*Ht;return sA(D+Lt,nt),da(D+Lt,nt-Fe,D+ge,nt-Ht,D,nt-Ht),da(D-ge,nt-Ht,D-Lt,nt-Fe,D-Lt,nt),da(D-Lt,nt+Fe,D-ge,nt+Ht,D,nt+Ht),da(D+ge,nt+Ht,D+Lt,nt+Fe,D+Lt,nt),iA(ne),this},C.__private__.circle=C.circle=function(D,nt,Lt,Ht){if(isNaN(D)||isNaN(nt)||isNaN(Lt)||!Ho(Ht))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(D,nt,Lt,Lt,Ht)},C.setFont=function(D,nt,Lt){return Lt&&(nt=gt(nt,Lt)),_r=ht(D,nt,{disableWarning:!1}),this};var su=C.__private__.getFont=C.getFont=function(){return Ne[ht.apply(C,arguments)]};C.__private__.getFontList=C.getFontList=function(){var D,nt,Lt={};for(D in Ur)if(Ur.hasOwnProperty(D))for(nt in Lt[D]=[],Ur[D])Ur[D].hasOwnProperty(nt)&&Lt[D].push(nt);return Lt},C.addFont=function(D,nt,Lt,Ht,ne){var ge=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ge.indexOf(arguments[3])!==-1?ne=arguments[3]:arguments[3]&&ge.indexOf(arguments[3])==-1&&(Lt=gt(Lt,Ht)),ne=ne||"Identity-H",Ti.call(this,D,nt,Lt,ne)};var Qa,bc=r.lineWidth||.200025,ws=C.__private__.getLineWidth=C.getLineWidth=function(){return bc},ou=C.__private__.setLineWidth=C.setLineWidth=function(D){return bc=D,st(mt(ct(D))+" w"),this};C.__private__.setLineDash=Vr.API.setLineDash=Vr.API.setLineDashPattern=function(D,nt){if(D=D||[],nt=nt||0,isNaN(nt)||!Array.isArray(D))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return D=D.map(function(Lt){return mt(ct(Lt))}).join(" "),nt=mt(ct(nt)),st("["+D+"] "+nt+" d"),this};var za=C.__private__.getLineHeight=C.getLineHeight=function(){return ve*Qa};C.__private__.getLineHeight=C.getLineHeight=function(){return ve*Qa};var on=C.__private__.setLineHeightFactor=C.setLineHeightFactor=function(D){return typeof(D=D||1.15)=="number"&&(Qa=D),this},vl=C.__private__.getLineHeightFactor=C.getLineHeightFactor=function(){return Qa};on(r.lineHeight);var Ha=C.__private__.getHorizontalCoordinate=function(D){return ct(D)},Vo=C.__private__.getVerticalCoordinate=function(D){return $===V.ADVANCED?D:W[xt].mediaBox.topRightY-W[xt].mediaBox.bottomLeftY-ct(D)},Sd=C.__private__.getHorizontalCoordinateString=C.getHorizontalCoordinateString=function(D){return mt(Ha(D))},Js=C.__private__.getVerticalCoordinateString=C.getVerticalCoordinateString=function(D){return mt(Vo(D))},Go=r.strokeColor||"0 G";C.__private__.getStrokeColor=C.getDrawColor=function(){return pr(Go)},C.__private__.setStrokeColor=C.setDrawColor=function(D,nt,Lt,Ht){return Go=Qr({ch1:D,ch2:nt,ch3:Lt,ch4:Ht,pdfColorType:"draw",precision:2}),st(Go),this};var au=r.fillColor||"0 g";C.__private__.getFillColor=C.getFillColor=function(){return pr(au)},C.__private__.setFillColor=C.setFillColor=function(D,nt,Lt,Ht){return au=Qr({ch1:D,ch2:nt,ch3:Lt,ch4:Ht,pdfColorType:"fill",precision:2}),st(au),this};var wc=r.textColor||"0 g",Ah=C.__private__.getTextColor=C.getTextColor=function(){return pr(wc)};C.__private__.setTextColor=C.setTextColor=function(D,nt,Lt,Ht){return wc=Qr({ch1:D,ch2:nt,ch3:Lt,ch4:Ht,pdfColorType:"text",precision:3}),this};var bl=r.charSpace,hh=C.__private__.getCharSpace=C.getCharSpace=function(){return parseFloat(bl||0)};C.__private__.setCharSpace=C.setCharSpace=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return bl=D,this};var lu=0;C.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},C.__private__.setLineCap=C.setLineCap=function(D){var nt=C.CapJoinStyles[D];if(nt===void 0)throw new Error("Line cap style of '"+D+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return lu=nt,st(nt+" J"),this};var cu=0;C.__private__.setLineJoin=C.setLineJoin=function(D){var nt=C.CapJoinStyles[D];if(nt===void 0)throw new Error("Line join style of '"+D+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return cu=nt,st(nt+" j"),this},C.__private__.setLineMiterLimit=C.__private__.setMiterLimit=C.setLineMiterLimit=C.setMiterLimit=function(D){if(D=D||0,isNaN(D))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return st(mt(ct(D))+" M"),this},C.GState=Ry,C.setGState=function(D){(D=typeof D=="string"?nn[vn[D]]:oA(null,D)).equals(ln)||(st("/"+D.id+" gs"),ln=D)};var oA=function(D,nt){if(!D||!vn[D]){var Lt=!1;for(var Ht in nn)if(nn.hasOwnProperty(Ht)&&nn[Ht].equals(nt)){Lt=!0;break}if(Lt)nt=nn[Ht];else{var ne="GS"+(Object.keys(nn).length+1).toString(10);nn[ne]=nt,nt.id=ne}return D&&(vn[D]=nt.id),X.publish("addGState",nt),nt}};C.addGState=function(D,nt){return oA(D,nt),this},C.saveGraphicsState=function(){return st("q"),_n.push({key:_r,size:ve,color:wc}),this},C.restoreGraphicsState=function(){st("Q");var D=_n.pop();return _r=D.key,ve=D.size,wc=D.color,ln=null,this},C.setCurrentTransformationMatrix=function(D){return st(D.toString()+" cm"),this},C.comment=function(D){return st("#"+D),this};var yo=function(D,nt){var Lt=D||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Lt},set:function(ge){isNaN(ge)||(Lt=parseFloat(ge))}});var Ht=nt||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ht},set:function(ge){isNaN(ge)||(Ht=parseFloat(ge))}});var ne="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ne},set:function(ge){ne=ge.toString()}}),this},uu=function(D,nt,Lt,Ht){yo.call(this,D,nt),this.type="rect";var ne=Lt||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ne},set:function(Fe){isNaN(Fe)||(ne=parseFloat(Fe))}});var ge=Ht||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ge},set:function(Fe){isNaN(Fe)||(ge=parseFloat(Fe))}}),this},aA=function(){this.page=Ct,this.currentPage=xt,this.pages=Te.slice(0),this.pagesContext=W.slice(0),this.x=An,this.y=me,this.matrix=gr,this.width=xc(xt),this.height=xl(xt),this.outputDestination=Qe,this.id="",this.objectNumber=-1};aA.prototype.restore=function(){Ct=this.page,xt=this.currentPage,W=this.pagesContext,Te=this.pages,An=this.x,me=this.y,gr=this.matrix,wl(xt,this.width),lA(xt,this.height),Qe=this.outputDestination};var dh=function(D,nt,Lt,Ht,ne){Gt.push(new aA),Ct=xt=0,Te=[],An=D,me=nt,gr=ne,bs([Lt,Ht])},fh=function(D){if(kt[D])Gt.pop().restore();else{var nt=new aA,Lt="Xo"+(Object.keys(Bt).length+1).toString(10);nt.id=Lt,kt[D]=Lt,Bt[Lt]=nt,X.publish("addFormObject",nt),Gt.pop().restore()}};for(var fa in C.beginFormObject=function(D,nt,Lt,Ht,ne){return dh(D,nt,Lt,Ht,ne),this},C.endFormObject=function(D){return fh(D),this},C.doFormObject=function(D,nt){var Lt=Bt[kt[D]];return st("q"),st(nt.toString()+" cm"),st("/"+Lt.id+" Do"),st("Q"),this},C.getFormObject=function(D){var nt=Bt[kt[D]];return{x:nt.x,y:nt.y,width:nt.width,height:nt.height,matrix:nt.matrix}},C.save=function(D,nt){return D=D||"generated.pdf",(nt=nt||{}).returnPromise=nt.returnPromise||!1,nt.returnPromise===!1?(td(Zn(zr()),D),typeof td.unload=="function"&&Hr.setTimeout&&setTimeout(td.unload,911),this):new Promise(function(Lt,Ht){try{var ne=td(Zn(zr()),D);typeof td.unload=="function"&&Hr.setTimeout&&setTimeout(td.unload,911),Lt(ne)}catch(ge){Ht(ge.message)}})},Vr.API)Vr.API.hasOwnProperty(fa)&&(fa==="events"&&Vr.API.events.length?function(D,nt){var Lt,Ht,ne;for(ne=nt.length-1;ne!==-1;ne--)Lt=nt[ne][0],Ht=nt[ne][1],D.subscribe.apply(D,[Lt].concat(typeof Ht=="function"?[Ht]:Ht))}(X,Vr.API.events):C[fa]=Vr.API[fa]);var xc=C.getPageWidth=function(D){return(W[D=D||xt].mediaBox.topRightX-W[D].mediaBox.bottomLeftX)/Re},wl=C.setPageWidth=function(D,nt){W[D].mediaBox.topRightX=nt*Re+W[D].mediaBox.bottomLeftX},xl=C.getPageHeight=function(D){return(W[D=D||xt].mediaBox.topRightY-W[D].mediaBox.bottomLeftY)/Re},lA=C.setPageHeight=function(D,nt){W[D].mediaBox.topRightY=nt*Re+W[D].mediaBox.bottomLeftY};return C.internal={pdfEscape:Ii,getStyle:nA,getFont:su,getFontSize:Ue,getCharSpace:hh,getTextColor:Ah,getLineHeight:za,getLineHeightFactor:vl,getLineWidth:ws,write:fr,getHorizontalCoordinate:Ha,getVerticalCoordinate:Vo,getCoordinateString:Sd,getVerticalCoordinateString:Js,collections:{},newObject:Jt,newAdditionalObject:nr,newObjectDeferred:xe,newObjectDeferredBegin:Ge,getFilters:Gr,putStream:cn,events:X,scaleFactor:Re,pageSize:{getWidth:function(){return xc(xt)},setWidth:function(D){wl(xt,D)},getHeight:function(){return xl(xt)},setHeight:function(D){lA(xt,D)}},encryptionOptions:y,encryption:yn,getEncryptor:yc,output:ti,getNumberOfPages:ka,pages:Te,out:st,f2:Tt,f3:ot,getPageInfo:As,getPageInfoByObjId:Ir,getCurrentPageInfo:_c,getPDFVersion:M,Point:yo,Rectangle:uu,Matrix:Ot,hasHotfix:Fi},Object.defineProperty(C.internal.pageSize,"width",{get:function(){return xc(xt)},set:function(D){wl(xt,D)},enumerable:!0,configurable:!0}),Object.defineProperty(C.internal.pageSize,"height",{get:function(){return xl(xt)},set:function(D){lA(xt,D)},enumerable:!0,configurable:!0}),zo.call(C,de),_r="F1",tn(i,e),X.publish("initialized"),C}Ff.prototype.lsbFirstWord=function(r){return String.fromCharCode(r>>0&255,r>>8&255,r>>16&255,r>>24&255)},Ff.prototype.toHexString=function(r){return r.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Ff.prototype.hexToBytes=function(r){for(var t=[],e=0;e<r.length;e+=2)t.push(String.fromCharCode(parseInt(r.substr(e,2),16)));return t.join("")},Ff.prototype.processOwnerPassword=function(r,t){return k2(N2(t).substr(0,5),r)},Ff.prototype.encryptor=function(r,t){var e=N2(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return k2(e,n)}},Ry.prototype.equals=function(r){var t,e="id,objectNumber,equals";if(!r||Dn(r)!==Dn(this))return!1;var n=0;for(t in this)if(!(e.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!r.hasOwnProperty(t)||this[t]!==r[t])return!1;n++}for(t in r)r.hasOwnProperty(t)&&e.indexOf(t)<0&&n--;return n===0},Vr.API={events:[]},Vr.version="2.5.1";var ki=Vr.API,Q2=1,rd=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Mf=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Zr=function(r){return r.toFixed(2)},qA=function(r){return r.toFixed(5)};ki.__acroform__={};var aa=function(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r},nP=function(r){return r*Q2},$c=function(r){var t=new sP,e=xr.internal.getHeight(r)||0,n=xr.internal.getWidth(r)||0;return t.BBox=[0,0,Number(Zr(n)),Number(Zr(e))],t},wrt=ki.__acroform__.setBit=function(r,t){if(r=r||0,t=t||0,isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|=1<<t},xrt=ki.__acroform__.clearBit=function(r,t){if(r=r||0,t=t||0,isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&=~(1<<t)},Brt=ki.__acroform__.getBit=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return r&1<<t?1:0},ji=ki.__acroform__.getBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Brt(r,t-1)},qi=ki.__acroform__.setBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return wrt(r,t-1)},Ki=ki.__acroform__.clearBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return xrt(r,t-1)},Crt=ki.__acroform__.calculateCoordinates=function(r,t){var e=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,i=r[0],s=r[1],a=r[2],o=r[3],d={};return d.lowerLeft_X=e(i)||0,d.lowerLeft_Y=n(s+o)||0,d.upperRight_X=e(i+a)||0,d.upperRight_Y=n(s)||0,[Number(Zr(d.lowerLeft_X)),Number(Zr(d.lowerLeft_Y)),Number(Zr(d.upperRight_X)),Number(Zr(d.upperRight_Y))]},Ert=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var t=[],e=r._V||r.DV,n=z2(r,e),i=r.scope.internal.getFont(r.fontName,r.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(r.scope.__private__.encodeColorString(r.color)),t.push("/"+i+" "+Zr(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=$c(r);return s.scope=r.scope,s.stream=t.join(`
`),s}},z2=function(r,t){var e=r.fontSize===0?r.maxFontSize:r.fontSize,n={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=r.multiline?i.map(function(ot){return ot.split(`
`)}):i.map(function(ot){return[ot]});var s=e,a=xr.internal.getHeight(r)||0;a=a<0?-a:a;var o=xr.internal.getWidth(r)||0;o=o<0?-o:o;var d=function(ot,ct,wt){if(ot+1<i.length){var vt=ct+" "+i[ot+1][0];return Oy(vt,r,wt).width<=o-4}return!1};s++;t:for(;s>0;){t="",s--;var p,y,b=Oy("3",r,s).height,x=r.multiline?a-s:(a-b)/2,C=x+=2,P=0,M=0,k=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+Oy(t,r,s=12).width+", FieldWidth:"+o+`
`;break}for(var z="",V=0,$=0;$<i.length;$++)if(i.hasOwnProperty($)){var tt=!1;if(i[$].length!==1&&k!==i[$].length-1){if((b+2)*(V+2)+2>a)continue t;z+=i[$][k],tt=!0,M=$,$--}else{z=(z+=i[$][k]+" ").substr(z.length-1)==" "?z.substr(0,z.length-1):z;var pt=parseInt($),gt=d(pt,z,s),mt=$>=i.length-1;if(gt&&!mt){z+=" ",k=0;continue}if(gt||mt){if(mt)M=pt;else if(r.multiline&&(b+2)*(V+2)+2>a)continue t}else{if(!r.multiline||(b+2)*(V+2)+2>a)continue t;M=pt}}for(var dt="",Ft=P;Ft<=M;Ft++){var Tt=i[Ft];if(r.multiline){if(Ft===M){dt+=Tt[k]+" ",k=(k+1)%Tt.length;continue}if(Ft===P){dt+=Tt[Tt.length-1]+" ";continue}}dt+=Tt[0]+" "}switch(dt=dt.substr(dt.length-1)==" "?dt.substr(0,dt.length-1):dt,y=Oy(dt,r,s).width,r.textAlign){case"right":p=o-y-2;break;case"center":p=(o-y)/2;break;case"left":default:p=2}t+=Zr(p)+" "+Zr(C)+` Td
`,t+="("+rd(dt)+`) Tj
`,t+=-Zr(p)+` 0 Td
`,C=-(s+2),y=0,P=tt?M:M+1,V++,z=""}break}return n.text=t,n.fontSize=s,n},Oy=function(r,t,e){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(r,{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e)*1.5,width:i}},Srt={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Trt=function(r,t){var e={type:"reference",object:r};t.internal.getPageInfo(r.page).pageContext.annotations.find(function(n){return n.type===e.type&&n.object===e.object})===void 0&&t.internal.getPageInfo(r.page).pageContext.annotations.push(e)},Irt=function(r,t){for(var e in r)if(r.hasOwnProperty(e)){var n=e,i=r[e];t.internal.newObjectDeferredBegin(i.objId,!0),Dn(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete r[n]}},Frt=function(r,t){if(t.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(ic.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(Srt)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Q2=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new oP,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(e){e.internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var s=n[i];s.objId=void 0,s.hasAnnotation&&Trt(s,e)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(e){if(e.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(e){(function(n,i){var s=!n;for(var a in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(a)){var o=n[a],d=[],p=o.Rect;if(o.Rect&&(o.Rect=Crt(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=xr.createDefaultAppearanceStream(o),Dn(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(d=o.getKeyValueListForStream()),o.Rect=p,o.hasAppearanceStream&&!o.appearanceStreamContent){var y=Ert(o);d.push({key:"AP",value:"<</N "+y+">>"}),i.internal.acroformPlugin.xForms.push(y)}if(o.appearanceStreamContent){var b="";for(var x in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(x)){var C=o.appearanceStreamContent[x];if(b+="/"+x+" ",b+="<<",Object.keys(C).length>=1||Array.isArray(C)){for(var a in C)if(C.hasOwnProperty(a)){var P=C[a];typeof P=="function"&&(P=P.call(i,o)),b+="/"+a+" "+P+" ",i.internal.acroformPlugin.xForms.indexOf(P)>=0||i.internal.acroformPlugin.xForms.push(P)}}else typeof(P=C)=="function"&&(P=P.call(i,o)),b+="/"+a+" "+P,i.internal.acroformPlugin.xForms.indexOf(P)>=0||i.internal.acroformPlugin.xForms.push(P);b+=">>"}d.push({key:"AP",value:`<<
`+b+">>"})}i.internal.putStream({additionalKeyValues:d,objectId:o.objId}),i.internal.out("endobj")}s&&Irt(i.internal.acroformPlugin.xForms,i)})(e,r)}),r.internal.acroformPlugin.isInitialized=!0}},iP=ki.__acroform__.arrayToPdfArray=function(r,t,e){var n=function(a){return a};if(Array.isArray(r)){for(var i="[",s=0;s<r.length;s++)switch(s!==0&&(i+=" "),Dn(r[s])){case"boolean":case"number":case"object":i+=r[s].toString();break;case"string":r[s].substr(0,1)!=="/"?(t!==void 0&&e&&(n=e.internal.getEncryptor(t)),i+="("+rd(n(r[s].toString()))+")"):i+=r[s].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},H2=function(r,t,e){var n=function(i){return i};return t!==void 0&&e&&(n=e.internal.getEncryptor(t)),(r=r||"").toString(),r="("+rd(n(r))+")"},Wc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Wc.prototype.toString=function(){return this.objId+" 0 R"},Wc.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},Wc.prototype.getKeyValueListForStream=function(){var r=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var e in t)if(Object.getOwnPropertyDescriptor(this,t[e]).configurable===!1){var n=t[e],i=this[n];i&&(Array.isArray(i)?r.push({key:n,value:iP(i,this.objId,this.scope)}):i instanceof Wc?(i.scope=this.scope,r.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&r.push({key:n,value:i}))}return r};var sP=function(){Wc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){r=e.trim()},get:function(){return r||null}})};aa(sP,Wc);var oP=function(){Wc.call(this);var r,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var e=function(n){return n};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+rd(e(r))+")"}},set:function(e){r=e}})};aa(oP,Wc);var ic=function r(){Wc.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(z){if(isNaN(z))throw new Error('Invalid value "'+z+'" for attribute F supplied.');t=z}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!ji(t,3)},set:function(z){z?this.F=qi(t,3):this.F=Ki(t,3)}});var e=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return e},set:function(z){if(isNaN(z))throw new Error('Invalid value "'+z+'" for attribute Ff supplied.');e=z}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(z){n=z!==void 0?z:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(z){n[0]=z}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(z){n[1]=z}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(z){n[2]=z}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(z){n[3]=z}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(z){switch(z){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=z;break;default:throw new Error('Invalid value "'+z+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof ky)return;s="FieldObject"+r.FieldNum++}var z=function(V){return V};return this.scope&&(z=this.scope.internal.getEncryptor(this.objId)),"("+rd(z(s))+")"},set:function(z){s=z.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(z){s=z}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(z){a=z}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(z){o=z}});var d=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return d},set:function(z){d=z}});var p=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return p===void 0?50/Q2:p},set:function(z){p=z}});var y="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return y},set:function(z){y=z}});var b="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!b||this instanceof ky||this instanceof nd))return H2(b,this.objId,this.scope)},set:function(z){z=z.toString(),b=z}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof Os?x:H2(x,this.objId,this.scope)},set:function(z){z=z.toString(),x=this instanceof Os?z:z.substr(0,1)==="("?Mf(z.substr(1,z.length-2)):Mf(z)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Os?Mf(x.substr(1,x.length-1)):x},set:function(z){z=z.toString(),x=this instanceof Os?"/"+z:z}});var C=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(C)return C},set:function(z){this.V=z}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(C)return this instanceof Os?C:H2(C,this.objId,this.scope)},set:function(z){z=z.toString(),C=this instanceof Os?z:z.substr(0,1)==="("?Mf(z.substr(1,z.length-2)):Mf(z)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Os?Mf(C.substr(1,C.length-1)):C},set:function(z){z=z.toString(),C=this instanceof Os?"/"+z:z}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var P,M=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return M},set:function(z){z=!!z,M=z}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(P)return P},set:function(z){P=z}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,1)},set:function(z){z?this.Ff=qi(this.Ff,1):this.Ff=Ki(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,2)},set:function(z){z?this.Ff=qi(this.Ff,2):this.Ff=Ki(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,3)},set:function(z){z?this.Ff=qi(this.Ff,3):this.Ff=Ki(this.Ff,3)}});var k=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(k!==null)return k},set:function(z){if([0,1,2].indexOf(z)===-1)throw new Error('Invalid value "'+z+'" for attribute Q supplied.');k=z}}),Object.defineProperty(this,"textAlign",{get:function(){var z;switch(k){case 0:default:z="left";break;case 1:z="center";break;case 2:z="right"}return z},configurable:!0,enumerable:!0,set:function(z){switch(z){case"right":case 2:k=2;break;case"center":case 1:k=1;break;case"left":case 0:default:k=0}}})};aa(ic,Wc);var Uf=function(){ic.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){r=e}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return iP(t,this.objId,this.scope)},set:function(e){var n,i;i=[],typeof(n=e)=="string"&&(i=function(s,a,o){o||(o=1);for(var d,p=[];d=a.exec(s);)p.push(d[o]);return p}(n,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,n){for(n=n||!1,e=(e=e||"").toString();t.indexOf(e)!==-1&&(t.splice(t.indexOf(e),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,18)},set:function(e){e?this.Ff=qi(this.Ff,18):this.Ff=Ki(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,19)},set:function(e){this.combo===!0&&(e?this.Ff=qi(this.Ff,19):this.Ff=Ki(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,20)},set:function(e){e?(this.Ff=qi(this.Ff,20),t.sort()):this.Ff=Ki(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,22)},set:function(e){e?this.Ff=qi(this.Ff,22):this.Ff=Ki(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,23)},set:function(e){e?this.Ff=qi(this.Ff,23):this.Ff=Ki(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,27)},set:function(e){e?this.Ff=qi(this.Ff,27):this.Ff=Ki(this.Ff,27)}}),this.hasAppearanceStream=!1};aa(Uf,ic);var Rf=function(){Uf.call(this),this.fontName="helvetica",this.combo=!1};aa(Rf,Uf);var Of=function(){Rf.call(this),this.combo=!0};aa(Of,Rf);var Dy=function(){Of.call(this),this.edit=!0};aa(Dy,Of);var Os=function(){ic.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,15)},set:function(e){e?this.Ff=qi(this.Ff,15):this.Ff=Ki(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,16)},set:function(e){e?this.Ff=qi(this.Ff,16):this.Ff=Ki(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,17)},set:function(e){e?this.Ff=qi(this.Ff,17):this.Ff=Ki(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,26)},set:function(e){e?this.Ff=qi(this.Ff,26):this.Ff=Ki(this.Ff,26)}});var r,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(s){return s};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,i=[];for(n in i.push("<<"),t)i.push("/"+n+" ("+rd(e(t[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(e){Dn(e)==="object"&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){typeof e=="string"&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(e){r="/"+e}})};aa(Os,ic);var Ny=function(){Os.call(this),this.pushButton=!0};aa(Ny,Os);var Df=function(){Os.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t!==void 0?t:[]}})};aa(Df,Os);var ky=function(){var r,t;ic.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var e,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,a=[];for(s in a.push("<<"),n)a.push("/"+s+" ("+rd(i(n[s]))+")");return a.push(">>"),a.join(`
`)},set:function(i){Dn(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(i){e="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=xr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};aa(ky,ic),Df.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var e=this.Kids[t];e.appearanceStreamContent=r.createAppearanceStream(e.optionName),e.caption=r.getCA()}},Df.prototype.createOption=function(r){var t=new ky;return t.Parent=this,t.optionName=r,this.Kids.push(t),Lrt.call(this.scope,t),t};var Qy=function(){Os.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=xr.CheckBox.createAppearanceStream()};aa(Qy,Os);var nd=function(){ic.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,13)},set:function(t){t?this.Ff=qi(this.Ff,13):this.Ff=Ki(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,21)},set:function(t){t?this.Ff=qi(this.Ff,21):this.Ff=Ki(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,23)},set:function(t){t?this.Ff=qi(this.Ff,23):this.Ff=Ki(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,24)},set:function(t){t?this.Ff=qi(this.Ff,24):this.Ff=Ki(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,25)},set:function(t){t?this.Ff=qi(this.Ff,25):this.Ff=Ki(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,26)},set:function(t){t?this.Ff=qi(this.Ff,26):this.Ff=Ki(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){Number.isInteger(t)&&(r=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};aa(nd,ic);var zy=function(){nd.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!ji(this.Ff,14)},set:function(r){r?this.Ff=qi(this.Ff,14):this.Ff=Ki(this.Ff,14)}}),this.password=!0};aa(zy,nd);var xr={CheckBox:{createAppearanceStream:function(){return{N:{On:xr.CheckBox.YesNormal},D:{On:xr.CheckBox.YesPushDown,Off:xr.CheckBox.OffPushDown}}},YesPushDown:function(r){var t=$c(r);t.scope=r.scope;var e=[],n=r.scope.internal.getFont(r.fontName,r.fontStyle).id,i=r.scope.__private__.encodeColorString(r.color),s=z2(r,r.caption);return e.push("0.749023 g"),e.push("0 0 "+Zr(xr.internal.getWidth(r))+" "+Zr(xr.internal.getHeight(r))+" re"),e.push("f"),e.push("BMC"),e.push("q"),e.push("0 0 1 rg"),e.push("/"+n+" "+Zr(s.fontSize)+" Tf "+i),e.push("BT"),e.push(s.text),e.push("ET"),e.push("Q"),e.push("EMC"),t.stream=e.join(`
`),t},YesNormal:function(r){var t=$c(r);t.scope=r.scope;var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),i=[],s=xr.internal.getHeight(r),a=xr.internal.getWidth(r),o=z2(r,r.caption);return i.push("1 g"),i.push("0 0 "+Zr(a)+" "+Zr(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Zr(a-1)+" "+Zr(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+e+" "+Zr(o.fontSize)+" Tf "+n),i.push(o.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(r){var t=$c(r);t.scope=r.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+Zr(xr.internal.getWidth(r))+" "+Zr(xr.internal.getHeight(r))+" re"),e.push("f"),t.stream=e.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(r){var t={D:{Off:xr.RadioButton.Circle.OffPushDown},N:{}};return t.N[r]=xr.RadioButton.Circle.YesNormal,t.D[r]=xr.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(r){var t=$c(r);t.scope=r.scope;var e=[],n=xr.internal.getWidth(r)<=xr.internal.getHeight(r)?xr.internal.getWidth(r)/4:xr.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var i=xr.internal.Bezier_C,s=Number((n*i).toFixed(5));return e.push("q"),e.push("1 0 0 1 "+qA(xr.internal.getWidth(r)/2)+" "+qA(xr.internal.getHeight(r)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),e.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),e.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),e.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(r){var t=$c(r);t.scope=r.scope;var e=[],n=xr.internal.getWidth(r)<=xr.internal.getHeight(r)?xr.internal.getWidth(r)/4:xr.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*xr.internal.Bezier_C).toFixed(5)),a=Number((n*xr.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+qA(xr.internal.getWidth(r)/2)+" "+qA(xr.internal.getHeight(r)/2)+" cm"),e.push(i+" 0 m"),e.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),e.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),e.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),e.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),e.push("f"),e.push("Q"),e.push("0 g"),e.push("q"),e.push("1 0 0 1 "+qA(xr.internal.getWidth(r)/2)+" "+qA(xr.internal.getHeight(r)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),e.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),e.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),e.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},OffPushDown:function(r){var t=$c(r);t.scope=r.scope;var e=[],n=xr.internal.getWidth(r)<=xr.internal.getHeight(r)?xr.internal.getWidth(r)/4:xr.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*xr.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+qA(xr.internal.getWidth(r)/2)+" "+qA(xr.internal.getHeight(r)/2)+" cm"),e.push(i+" 0 m"),e.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),e.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),e.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),e.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t}},Cross:{createAppearanceStream:function(r){var t={D:{Off:xr.RadioButton.Cross.OffPushDown},N:{}};return t.N[r]=xr.RadioButton.Cross.YesNormal,t.D[r]=xr.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(r){var t=$c(r);t.scope=r.scope;var e=[],n=xr.internal.calculateCross(r);return e.push("q"),e.push("1 1 "+Zr(xr.internal.getWidth(r)-2)+" "+Zr(xr.internal.getHeight(r)-2)+" re"),e.push("W"),e.push("n"),e.push(Zr(n.x1.x)+" "+Zr(n.x1.y)+" m"),e.push(Zr(n.x2.x)+" "+Zr(n.x2.y)+" l"),e.push(Zr(n.x4.x)+" "+Zr(n.x4.y)+" m"),e.push(Zr(n.x3.x)+" "+Zr(n.x3.y)+" l"),e.push("s"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(r){var t=$c(r);t.scope=r.scope;var e=xr.internal.calculateCross(r),n=[];return n.push("0.749023 g"),n.push("0 0 "+Zr(xr.internal.getWidth(r))+" "+Zr(xr.internal.getHeight(r))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Zr(xr.internal.getWidth(r)-2)+" "+Zr(xr.internal.getHeight(r)-2)+" re"),n.push("W"),n.push("n"),n.push(Zr(e.x1.x)+" "+Zr(e.x1.y)+" m"),n.push(Zr(e.x2.x)+" "+Zr(e.x2.y)+" l"),n.push(Zr(e.x4.x)+" "+Zr(e.x4.y)+" m"),n.push(Zr(e.x3.x)+" "+Zr(e.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(r){var t=$c(r);t.scope=r.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+Zr(xr.internal.getWidth(r))+" "+Zr(xr.internal.getHeight(r))+" re"),e.push("f"),t.stream=e.join(`
`),t}}},createDefaultAppearanceStream:function(r){var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,e=r.scope.__private__.encodeColorString(r.color);return"/"+t+" "+r.fontSize+" Tf "+e}};xr.internal={Bezier_C:.551915024494,calculateCross:function(r){var t=xr.internal.getWidth(r),e=xr.internal.getHeight(r),n=Math.min(t,e);return{x1:{x:(t-n)/2,y:(e-n)/2+n},x2:{x:(t-n)/2+n,y:(e-n)/2},x3:{x:(t-n)/2,y:(e-n)/2},x4:{x:(t-n)/2+n,y:(e-n)/2+n}}}},xr.internal.getWidth=function(r){var t=0;return Dn(r)==="object"&&(t=nP(r.Rect[2])),t},xr.internal.getHeight=function(r){var t=0;return Dn(r)==="object"&&(t=nP(r.Rect[3])),t};var Lrt=ki.addField=function(r){if(Frt(this,r),!(r instanceof ic))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=r).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};ki.AcroFormChoiceField=Uf,ki.AcroFormListBox=Rf,ki.AcroFormComboBox=Of,ki.AcroFormEditBox=Dy,ki.AcroFormButton=Os,ki.AcroFormPushButton=Ny,ki.AcroFormRadioButton=Df,ki.AcroFormCheckBox=Qy,ki.AcroFormTextField=nd,ki.AcroFormPasswordField=zy,ki.AcroFormAppearance=xr,ki.AcroForm={ChoiceField:Uf,ListBox:Rf,ComboBox:Of,EditBox:Dy,Button:Os,PushButton:Ny,RadioButton:Df,CheckBox:Qy,TextField:nd,PasswordField:zy,Appearance:xr},Vr.AcroForm={ChoiceField:Uf,ListBox:Rf,ComboBox:Of,EditBox:Dy,Button:Os,PushButton:Ny,RadioButton:Df,CheckBox:Qy,TextField:nd,PasswordField:zy,Appearance:xr};function aP(r){return r.reduce(function(t,e,n){return t[e]=n,t},{})}(function(r){r.__addimage__={};var t="UNKNOWN",e={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=r.__addimage__.getImageFileTypeByImageData=function(ot,ct){var wt,vt,$t,Wt,Yt,Kt=t;if((ct=ct||t)==="RGBA"||ot.data!==void 0&&ot.data instanceof Uint8ClampedArray&&"height"in ot&&"width"in ot)return"RGBA";if(gt(ot))for(Yt in e)for($t=e[Yt],wt=0;wt<$t.length;wt+=1){for(Wt=!0,vt=0;vt<$t[wt].length;vt+=1)if($t[wt][vt]!==void 0&&$t[wt][vt]!==ot[vt]){Wt=!1;break}if(Wt===!0){Kt=Yt;break}}else for(Yt in e)for($t=e[Yt],wt=0;wt<$t.length;wt+=1){for(Wt=!0,vt=0;vt<$t[wt].length;vt+=1)if($t[wt][vt]!==void 0&&$t[wt][vt]!==ot.charCodeAt(vt)){Wt=!1;break}if(Wt===!0){Kt=Yt;break}}return Kt===t&&ct!==t&&(Kt=ct),Kt},i=function ot(ct){for(var wt=this.internal.write,vt=this.internal.putStream,$t=(0,this.internal.getFilters)();$t.indexOf("FlateEncode")!==-1;)$t.splice($t.indexOf("FlateEncode"),1);ct.objectId=this.internal.newObject();var Wt=[];if(Wt.push({key:"Type",value:"/XObject"}),Wt.push({key:"Subtype",value:"/Image"}),Wt.push({key:"Width",value:ct.width}),Wt.push({key:"Height",value:ct.height}),ct.colorSpace===k.INDEXED?Wt.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(ct.palette.length/3-1)+" "+("sMask"in ct&&ct.sMask!==void 0?ct.objectId+2:ct.objectId+1)+" 0 R]"}):(Wt.push({key:"ColorSpace",value:"/"+ct.colorSpace}),ct.colorSpace===k.DEVICE_CMYK&&Wt.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Wt.push({key:"BitsPerComponent",value:ct.bitsPerComponent}),"decodeParameters"in ct&&ct.decodeParameters!==void 0&&Wt.push({key:"DecodeParms",value:"<<"+ct.decodeParameters+">>"}),"transparency"in ct&&Array.isArray(ct.transparency)){for(var Yt="",Kt=0,ee=ct.transparency.length;Kt<ee;Kt++)Yt+=ct.transparency[Kt]+" "+ct.transparency[Kt]+" ";Wt.push({key:"Mask",value:"["+Yt+"]"})}ct.sMask!==void 0&&Wt.push({key:"SMask",value:ct.objectId+1+" 0 R"});var Zt=ct.filter!==void 0?["/"+ct.filter]:void 0;if(vt({data:ct.data,additionalKeyValues:Wt,alreadyAppliedFilters:Zt,objectId:ct.objectId}),wt("endobj"),"sMask"in ct&&ct.sMask!==void 0){var we="/Predictor "+ct.predictor+" /Colors 1 /BitsPerComponent "+ct.bitsPerComponent+" /Columns "+ct.width,it={width:ct.width,height:ct.height,colorSpace:"DeviceGray",bitsPerComponent:ct.bitsPerComponent,decodeParameters:we,data:ct.sMask};"filter"in ct&&(it.filter=ct.filter),ot.call(this,it)}if(ct.colorSpace===k.INDEXED){var xt=this.internal.newObject();vt({data:dt(new Uint8Array(ct.palette)),objectId:xt}),wt("endobj")}},s=function(){var ot=this.internal.collections.addImage_images;for(var ct in ot)i.call(this,ot[ct])},a=function(){var ot,ct=this.internal.collections.addImage_images,wt=this.internal.write;for(var vt in ct)wt("/I"+(ot=ct[vt]).index,ot.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",a))},d=function(){var ot=this.internal.collections.addImage_images;return o.call(this),ot},p=function(){return Object.keys(this.internal.collections.addImage_images).length},y=function(ot){return typeof r["process"+ot.toUpperCase()]=="function"},b=function(ot){return Dn(ot)==="object"&&ot.nodeType===1},x=function(ot,ct){if(ot.nodeName==="IMG"&&ot.hasAttribute("src")){var wt=""+ot.getAttribute("src");if(wt.indexOf("data:image/")===0)return Vg(unescape(wt).split("base64,").pop());var vt=r.loadFile(wt,!0);if(vt!==void 0)return vt}if(ot.nodeName==="CANVAS"){if(ot.width===0||ot.height===0)throw new Error("Given canvas must have data. Canvas width: "+ot.width+", height: "+ot.height);var $t;switch(ct){case"PNG":$t="image/png";break;case"WEBP":$t="image/webp";break;case"JPEG":case"JPG":default:$t="image/jpeg"}return Vg(ot.toDataURL($t,1).split("base64,").pop())}},C=function(ot){var ct=this.internal.collections.addImage_images;if(ct){for(var wt in ct)if(ot===ct[wt].alias)return ct[wt]}},P=function(ot,ct,wt){return ot||ct||(ot=-96,ct=-96),ot<0&&(ot=-1*wt.width*72/ot/this.internal.scaleFactor),ct<0&&(ct=-1*wt.height*72/ct/this.internal.scaleFactor),ot===0&&(ot=ct*wt.width/wt.height),ct===0&&(ct=ot*wt.height/wt.width),[ot,ct]},M=function(ot,ct,wt,vt,$t,Wt){var Yt=P.call(this,wt,vt,$t),Kt=this.internal.getCoordinateString,ee=this.internal.getVerticalCoordinateString,Zt=d.call(this);if(wt=Yt[0],vt=Yt[1],Zt[$t.index]=$t,Wt){Wt*=Math.PI/180;var we=Math.cos(Wt),it=Math.sin(Wt),xt=function(Ut){return Ut.toFixed(4)},It=[xt(we),xt(it),xt(-1*it),xt(we),0,0,"cm"]}this.internal.write("q"),Wt?(this.internal.write([1,"0","0",1,Kt(ot),ee(ct+vt),"cm"].join(" ")),this.internal.write(It.join(" ")),this.internal.write([Kt(wt),"0","0",Kt(vt),"0","0","cm"].join(" "))):this.internal.write([Kt(wt),"0","0",Kt(vt),Kt(ot),ee(ct+vt),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+$t.index+" Do"),this.internal.write("Q")},k=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var z=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},V=r.__addimage__.sHashCode=function(ot){var ct,wt,vt=0;if(typeof ot=="string")for(wt=ot.length,ct=0;ct<wt;ct++)vt=(vt<<5)-vt+ot.charCodeAt(ct),vt|=0;else if(gt(ot))for(wt=ot.byteLength/2,ct=0;ct<wt;ct++)vt=(vt<<5)-vt+ot[ct],vt|=0;return vt},$=r.__addimage__.validateStringAsBase64=function(ot){(ot=ot||"").toString().trim();var ct=!0;return ot.length===0&&(ct=!1),ot.length%4!=0&&(ct=!1),/^[A-Za-z0-9+/]+$/.test(ot.substr(0,ot.length-2))===!1&&(ct=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(ot.substr(-2))===!1&&(ct=!1),ct},tt=r.__addimage__.extractImageFromDataUrl=function(ot){var ct=(ot=ot||"").split("base64,"),wt=null;if(ct.length===2){var vt=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(ct[0]);Array.isArray(vt)&&(wt={mimeType:vt[1],charset:vt[2],data:ct[1]})}return wt},pt=r.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};r.__addimage__.isArrayBuffer=function(ot){return pt()&&ot instanceof ArrayBuffer};var gt=r.__addimage__.isArrayBufferView=function(ot){return pt()&&typeof Uint32Array<"u"&&(ot instanceof Int8Array||ot instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&ot instanceof Uint8ClampedArray||ot instanceof Int16Array||ot instanceof Uint16Array||ot instanceof Int32Array||ot instanceof Uint32Array||ot instanceof Float32Array||ot instanceof Float64Array)},mt=r.__addimage__.binaryStringToUint8Array=function(ot){for(var ct=ot.length,wt=new Uint8Array(ct),vt=0;vt<ct;vt++)wt[vt]=ot.charCodeAt(vt);return wt},dt=r.__addimage__.arrayBufferToBinaryString=function(ot){for(var ct="",wt=gt(ot)?ot:new Uint8Array(ot),vt=0;vt<wt.length;vt+=8192)ct+=String.fromCharCode.apply(null,wt.subarray(vt,vt+8192));return ct};r.addImage=function(){var ot,ct,wt,vt,$t,Wt,Yt,Kt,ee;if(typeof arguments[1]=="number"?(ct=t,wt=arguments[1],vt=arguments[2],$t=arguments[3],Wt=arguments[4],Yt=arguments[5],Kt=arguments[6],ee=arguments[7]):(ct=arguments[1],wt=arguments[2],vt=arguments[3],$t=arguments[4],Wt=arguments[5],Yt=arguments[6],Kt=arguments[7],ee=arguments[8]),Dn(ot=arguments[0])==="object"&&!b(ot)&&"imageData"in ot){var Zt=ot;ot=Zt.imageData,ct=Zt.format||ct||t,wt=Zt.x||wt||0,vt=Zt.y||vt||0,$t=Zt.w||Zt.width||$t,Wt=Zt.h||Zt.height||Wt,Yt=Zt.alias||Yt,Kt=Zt.compression||Kt,ee=Zt.rotation||Zt.angle||ee}var we=this.internal.getFilters();if(Kt===void 0&&we.indexOf("FlateEncode")!==-1&&(Kt="SLOW"),isNaN(wt)||isNaN(vt))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var it=Ft.call(this,ot,ct,Yt,Kt);return M.call(this,wt,vt,$t,Wt,it,ee),this};var Ft=function(ot,ct,wt,vt){var $t,Wt,Yt;if(typeof ot=="string"&&n(ot)===t){ot=unescape(ot);var Kt=Tt(ot,!1);(Kt!==""||(Kt=r.loadFile(ot,!0))!==void 0)&&(ot=Kt)}if(b(ot)&&(ot=x(ot,ct)),ct=n(ot,ct),!y(ct))throw new Error("addImage does not support files of type '"+ct+"', please ensure that a plugin for '"+ct+"' support is added.");if(((Yt=wt)==null||Yt.length===0)&&(wt=function(ee){return typeof ee=="string"||gt(ee)?V(ee):gt(ee.data)?V(ee.data):null}(ot)),($t=C.call(this,wt))||(pt()&&(ot instanceof Uint8Array||ct==="RGBA"||(Wt=ot,ot=mt(ot))),$t=this["process"+ct.toUpperCase()](ot,p.call(this),wt,function(ee){return ee&&typeof ee=="string"&&(ee=ee.toUpperCase()),ee in r.image_compression?ee:z.NONE}(vt),Wt)),!$t)throw new Error("An unknown error occurred whilst processing the image.");return $t},Tt=r.__addimage__.convertBase64ToBinaryString=function(ot,ct){var wt;ct=typeof ct!="boolean"||ct;var vt,$t="";if(typeof ot=="string"){vt=(wt=tt(ot))!==null?wt.data:ot;try{$t=Vg(vt)}catch(Wt){if(ct)throw $(vt)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Wt.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return $t};r.getImageProperties=function(ot){var ct,wt,vt="";if(b(ot)&&(ot=x(ot)),typeof ot=="string"&&n(ot)===t&&((vt=Tt(ot,!1))===""&&(vt=r.loadFile(ot)||""),ot=vt),wt=n(ot),!y(wt))throw new Error("addImage does not support files of type '"+wt+"', please ensure that a plugin for '"+wt+"' support is added.");if(!pt()||ot instanceof Uint8Array||(ot=mt(ot)),!(ct=this["process"+wt.toUpperCase()](ot)))throw new Error("An unknown error occurred whilst processing the image");return ct.fileType=wt,ct}})(Vr.API),function(r){var t=function(e){if(e!==void 0&&e!="")return!0};Vr.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(e){for(var n,i,s,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,d=this.internal.getPageInfoByObjId(e.objId),p=e.pageContext.annotations,y=!1,b=0;b<p.length&&!y;b++)switch((n=p[b]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(y=!0);break;case"reference":case"text":case"freetext":y=!0}if(y!=0){this.internal.write("/Annots [");for(var x=0;x<p.length;x++){n=p[x];var C=this.internal.pdfEscape,P=this.internal.getEncryptor(e.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var M=this.internal.newAdditionalObject(),k=this.internal.newAdditionalObject(),z=this.internal.getEncryptor(M.objId),V=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+C(z(n.contents))+")",s+=" /Popup "+k.objId+" 0 R",s+=" /P "+d.objId+" 0 R",s+=" /T ("+C(z(V))+") >>",M.content=s;var $=M.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+a(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+$,n.open&&(s+=" /Open true"),s+=" >>",k.content=s,this.internal.write(M.objId,"0 R",k.objId,"0 R");break;case"freetext":i="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var tt=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+C(P(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+tt+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var pt=this.annotations._nameMap[n.options.name];n.options.pageNumber=pt.page,n.options.top=pt.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+C(P(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var gt=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+gt+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),r.createAnnotation=function(e){var n=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":n.pageContext.annotations.push(e)}},r.link=function(e,n,i,s,a){var o=this.internal.getCurrentPageInfo(),d=this.internal.getCoordinateString,p=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:d(e),y:p(n),w:d(e+i),h:p(n+s)},options:a,type:"link"})},r.textWithLink=function(e,n,i,s){var a,o,d=this.getTextWidth(e),p=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){o=s.maxWidth;var y=this.splitTextToSize(e,o).length;a=Math.ceil(p*y)}else o=d,a=p;return this.text(e,n,i,s),i+=.2*p,s.align==="center"&&(n-=d/2),s.align==="right"&&(n-=d),this.link(n,i-p,o,a,s),d},r.getTextWidth=function(e){var n=this.internal.getFontSize();return this.getStringUnitWidth(e)*n/this.internal.scaleFactor}}(Vr.API),function(r){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},e={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];r.__arabicParser__={};var s=r.__arabicParser__.isInArabicSubstitutionA=function(M){return t[M.charCodeAt(0)]!==void 0},a=r.__arabicParser__.isArabicLetter=function(M){return typeof M=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(M)},o=r.__arabicParser__.isArabicEndLetter=function(M){return a(M)&&s(M)&&t[M.charCodeAt(0)].length<=2},d=r.__arabicParser__.isArabicAlfLetter=function(M){return a(M)&&i.indexOf(M.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(M){return a(M)&&s(M)&&t[M.charCodeAt(0)].length>=1};var p=r.__arabicParser__.arabicLetterHasFinalForm=function(M){return a(M)&&s(M)&&t[M.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(M){return a(M)&&s(M)&&t[M.charCodeAt(0)].length>=3};var y=r.__arabicParser__.arabicLetterHasMedialForm=function(M){return a(M)&&s(M)&&t[M.charCodeAt(0)].length==4},b=r.__arabicParser__.resolveLigatures=function(M){var k=0,z=e,V="",$=0;for(k=0;k<M.length;k+=1)z[M.charCodeAt(k)]!==void 0?($++,typeof(z=z[M.charCodeAt(k)])=="number"&&(V+=String.fromCharCode(z),z=e,$=0),k===M.length-1&&(z=e,V+=M.charAt(k-($-1)),k-=$-1,$=0)):(z=e,V+=M.charAt(k-$),k-=$,$=0);return V};r.__arabicParser__.isArabicDiacritic=function(M){return M!==void 0&&n[M.charCodeAt(0)]!==void 0};var x=r.__arabicParser__.getCorrectForm=function(M,k,z){return a(M)?s(M)===!1?-1:!p(M)||!a(k)&&!a(z)||!a(z)&&o(k)||o(M)&&!a(k)||o(M)&&d(k)||o(M)&&o(k)?0:y(M)&&a(k)&&!o(k)&&a(z)&&p(z)?3:o(M)||!a(z)?1:2:-1},C=function(M){var k=0,z=0,V=0,$="",tt="",pt="",gt=(M=M||"").split("\\s+"),mt=[];for(k=0;k<gt.length;k+=1){for(mt.push(""),z=0;z<gt[k].length;z+=1)$=gt[k][z],tt=gt[k][z-1],pt=gt[k][z+1],a($)?(V=x($,tt,pt),mt[k]+=V!==-1?String.fromCharCode(t[$.charCodeAt(0)][V]):$):mt[k]+=$;mt[k]=b(mt[k])}return mt.join(" ")},P=r.__arabicParser__.processArabic=r.processArabic=function(){var M,k=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,z=[];if(Array.isArray(k)){var V=0;for(z=[],V=0;V<k.length;V+=1)Array.isArray(k[V])?z.push([C(k[V][0]),k[V][1],k[V][2]]):z.push([C(k[V])]);M=z}else M=C(k);return typeof arguments[0]=="string"?M:(arguments[0].text=M,arguments[0])};r.events.push(["preProcessText",P])}(Vr.API),Vr.API.autoPrint=function(r){var t;switch((r=r||{}).variant=r.variant||"non-conform",r.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(r){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(o){e=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(o){s=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,n){var i;if((e=e||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Vr.API),function(r){var t={left:0,top:0,bottom:0,right:0},e=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var d=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return d},set:function(M){d=M}});var p=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return p},set:function(M){p=M}});var y=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return y},set:function(M){y=M}});var b=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return b},set:function(M){b=M}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(M){x=M}});var C=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return C},set:function(M){C=M}});var P=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return P},set:function(M){P=M}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(d){return n.call(this),this.internal.__cell__.headerFunction=typeof d=="function"?d:void 0,this},r.getTextDimensions=function(d,p){n.call(this);var y=(p=p||{}).fontSize||this.getFontSize(),b=p.font||this.getFont(),x=p.scaleFactor||this.internal.scaleFactor,C=0,P=0,M=0,k=this;if(!Array.isArray(d)&&typeof d!="string"){if(typeof d!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");d=String(d)}var z=p.maxWidth;z>0?typeof d=="string"?d=this.splitTextToSize(d,z):Object.prototype.toString.call(d)==="[object Array]"&&(d=d.reduce(function($,tt){return $.concat(k.splitTextToSize(tt,z))},[])):d=Array.isArray(d)?d:[d];for(var V=0;V<d.length;V++)C<(M=this.getStringUnitWidth(d[V],{font:b})*y)&&(C=M);return C!==0&&(P=d.length),{w:C/=x,h:Math.max((P*y*this.getLineHeightFactor()-y*(this.getLineHeightFactor()-1))/x,0)}},r.cellAddPage=function(){n.call(this),this.addPage();var d=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(d.left,d.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=r.cell=function(){var d;d=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var p=this.internal.__cell__.lastCell,y=this.internal.__cell__.padding,b=this.internal.__cell__.margins||t,x=this.internal.__cell__.tableHeaderRow,C=this.internal.__cell__.printHeaders;return p.lineNumber!==void 0&&(p.lineNumber===d.lineNumber?(d.x=(p.x||0)+(p.width||0),d.y=p.y||0):p.y+p.height+d.height+b.bottom>this.getPageHeight()?(this.cellAddPage(),d.y=b.top,C&&x&&(this.printHeaderRow(d.lineNumber,!0),d.y+=x[0].height)):d.y=p.y+p.height||d.y),d.text[0]!==void 0&&(this.rect(d.x,d.y,d.width,d.height,e===!0?"FD":void 0),d.align==="right"?this.text(d.text,d.x+d.width-y,d.y+y,{align:"right",baseline:"top"}):d.align==="center"?this.text(d.text,d.x+d.width/2,d.y+y,{align:"center",baseline:"top",maxWidth:d.width-y-y}):this.text(d.text,d.x+y,d.y+y,{align:"left",baseline:"top",maxWidth:d.width-y-y})),this.internal.__cell__.lastCell=d,this};r.table=function(d,p,y,b,x){if(n.call(this),!y)throw new Error("No data for PDF table.");var C,P,M,k,z=[],V=[],$=[],tt={},pt={},gt=[],mt=[],dt=(x=x||{}).autoSize||!1,Ft=x.printHeaders!==!1,Tt=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,ot=x.margins||Object.assign({width:this.getPageWidth()},t),ct=typeof x.padding=="number"?x.padding:3,wt=x.headerBackgroundColor||"#c8c8c8",vt=x.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=Ft,this.internal.__cell__.margins=ot,this.internal.__cell__.table_font_size=Tt,this.internal.__cell__.padding=ct,this.internal.__cell__.headerBackgroundColor=wt,this.internal.__cell__.headerTextColor=vt,this.setFontSize(Tt),b==null)V=z=Object.keys(y[0]),$=z.map(function(){return"left"});else if(Array.isArray(b)&&Dn(b[0])==="object")for(z=b.map(function(Zt){return Zt.name}),V=b.map(function(Zt){return Zt.prompt||Zt.name||""}),$=b.map(function(Zt){return Zt.align||"left"}),C=0;C<b.length;C+=1)pt[b[C].name]=b[C].width*(19.049976/25.4);else Array.isArray(b)&&typeof b[0]=="string"&&(V=z=b,$=z.map(function(){return"left"}));if(dt||Array.isArray(b)&&typeof b[0]=="string")for(C=0;C<z.length;C+=1){for(tt[k=z[C]]=y.map(function(Zt){return Zt[k]}),this.setFont(void 0,"bold"),gt.push(this.getTextDimensions(V[C],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),P=tt[k],this.setFont(void 0,"normal"),M=0;M<P.length;M+=1)gt.push(this.getTextDimensions(P[M],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);pt[k]=Math.max.apply(null,gt)+ct+ct,gt=[]}if(Ft){var $t={};for(C=0;C<z.length;C+=1)$t[z[C]]={},$t[z[C]].text=V[C],$t[z[C]].align=$[C];var Wt=o.call(this,$t,pt);mt=z.map(function(Zt){return new s(d,p,pt[Zt],Wt,$t[Zt].text,void 0,$t[Zt].align)}),this.setTableHeaderRow(mt),this.printHeaderRow(1,!1)}var Yt=b.reduce(function(Zt,we){return Zt[we.name]=we.align,Zt},{});for(C=0;C<y.length;C+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:C,data:y[C]},this);var Kt=o.call(this,y[C],pt);for(M=0;M<z.length;M+=1){var ee=y[C][z[M]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:C,col:M,data:ee},this),a.call(this,new s(d,p,pt[z[M]],Kt,ee,C+2,Yt[z[M]]))}}return this.internal.__cell__.table_x=d,this.internal.__cell__.table_y=p,this};var o=function(d,p){var y=this.internal.__cell__.padding,b=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(d).map(function(C){var P=d[C];return this.splitTextToSize(P.hasOwnProperty("text")?P.text:P,p[C]-y-y)},this).map(function(C){return this.getLineHeightFactor()*C.length*b/x+y+y},this).reduce(function(C,P){return Math.max(C,P)},0)};r.setTableHeaderRow=function(d){n.call(this),this.internal.__cell__.tableHeaderRow=d},r.printHeaderRow=function(d,p){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var y;if(e=!0,typeof this.internal.__cell__.headerFunction=="function"){var b=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(b[0],b[1],b[2],b[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],C=0;C<this.internal.__cell__.tableHeaderRow.length;C+=1){y=this.internal.__cell__.tableHeaderRow[C].clone(),p&&(y.y=this.internal.__cell__.margins.top||0,x.push(y)),y.lineNumber=d;var P=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,y),this.setTextColor(P)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),e=!1}}(Vr.API);var lP={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},cP=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],V2=aP(cP),uP=[100,200,300,400,500,600,700,800,900],Prt=aP(uP);function G2(r){var t=r.family.replace(/"|'/g,"").toLowerCase(),e=function(s){return lP[s=s||"normal"]?s:"normal"}(r.style),n=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(r.weight),i=function(s){return typeof V2[s=s||"normal"]=="number"?s:"normal"}(r.stretch);return{family:t,style:e,weight:n,stretch:i,src:r.src||[],ref:r.ref||{name:t,style:[i,e,n].join(" ")}}}function AP(r,t,e,n){var i;for(i=e;i>=0&&i<t.length;i+=n)if(r[t[i]])return r[t[i]];for(i=e;i>=0&&i<t.length;i-=n)if(r[t[i]])return r[t[i]]}var Mrt={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},hP={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function dP(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function Urt(r,t,e){for(var n=(e=e||{}).defaultFontFamily||"times",i=Object.assign({},Mrt,e.genericFontFamilies||{}),s=null,a=null,o=0;o<t.length;++o)if(i[(s=G2(t[o])).family]&&(s.family=i[s.family]),r.hasOwnProperty(s.family)){a=r[s.family];break}if(!(a=a||r[n]))throw new Error("Could not find a font-family for the rule '"+dP(s)+"' and default family '"+n+"'.");if(a=function(d,p){if(p[d])return p[d];var y=V2[d],b=y<=V2.normal?-1:1,x=AP(p,cP,y,b);if(!x)throw new Error("Could not find a matching font-stretch value for "+d);return x}(s.stretch,a),a=function(d,p){if(p[d])return p[d];for(var y=lP[d],b=0;b<y.length;++b)if(p[y[b]])return p[y[b]];throw new Error("Could not find a matching font-style for "+d)}(s.style,a),!(a=function(d,p){if(p[d])return p[d];if(d===400&&p[500])return p[500];if(d===500&&p[400])return p[400];var y=Prt[d],b=AP(p,uP,y,d<400?-1:1);if(!b)throw new Error("Could not find a matching font-weight for value "+d);return b}(s.weight,a)))throw new Error("Failed to resolve a font for the rule '"+dP(s)+"'.");return a}function fP(r){return r.trimLeft()}function Rrt(r,t){for(var e=0;e<r.length;){if(r.charAt(e)===t)return[r.substring(0,e),r.substring(e+1)];e+=1}return null}function Ort(r){var t=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],r.substring(t[0].length)]}var Hy,pP,gP,mP=["times"];(function(r){var t,e,n,i,s,a,o,d,p,y=function(it){return it=it||{},this.isStrokeTransparent=it.isStrokeTransparent||!1,this.strokeOpacity=it.strokeOpacity||1,this.strokeStyle=it.strokeStyle||"#000000",this.fillStyle=it.fillStyle||"#000000",this.isFillTransparent=it.isFillTransparent||!1,this.fillOpacity=it.fillOpacity||1,this.font=it.font||"10px sans-serif",this.textBaseline=it.textBaseline||"alphabetic",this.textAlign=it.textAlign||"left",this.lineWidth=it.lineWidth||1,this.lineJoin=it.lineJoin||"miter",this.lineCap=it.lineCap||"butt",this.path=it.path||[],this.transform=it.transform!==void 0?it.transform.clone():new d,this.globalCompositeOperation=it.globalCompositeOperation||"normal",this.globalAlpha=it.globalAlpha||1,this.clip_path=it.clip_path||[],this.currentPoint=it.currentPoint||new a,this.miterLimit=it.miterLimit||10,this.lastPoint=it.lastPoint||new a,this.lineDashOffset=it.lineDashOffset||0,this.lineDash=it.lineDash||[],this.margin=it.margin||[0,0,0,0],this.prevPageLastElemOffset=it.prevPageLastElemOffset||0,this.ignoreClearRect=typeof it.ignoreClearRect!="boolean"||it.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new b(this),t=this.internal.f2,e=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,d=this.internal.Matrix,p=new y}]);var b=function(it){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var xt=it;Object.defineProperty(this,"pdf",{get:function(){return xt}});var It=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return It},set:function(he){It=!!he}});var Ut=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Ut},set:function(he){Ut=!!he}});var jt=0;Object.defineProperty(this,"posX",{get:function(){return jt},set:function(he){isNaN(he)||(jt=he)}});var Vt=0;Object.defineProperty(this,"posY",{get:function(){return Vt},set:function(he){isNaN(he)||(Vt=he)}}),Object.defineProperty(this,"margin",{get:function(){return p.margin},set:function(he){var st;typeof he=="number"?st=[he,he,he,he]:((st=new Array(4))[0]=he[0],st[1]=he.length>=2?he[1]:st[0],st[2]=he.length>=3?he[2]:st[0],st[3]=he.length>=4?he[3]:st[1]),p.margin=st}});var re=!1;Object.defineProperty(this,"autoPaging",{get:function(){return re},set:function(he){re=he}});var te=0;Object.defineProperty(this,"lastBreak",{get:function(){return te},set:function(he){te=he}});var Ce=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ce},set:function(he){Ce=he}}),Object.defineProperty(this,"ctx",{get:function(){return p},set:function(he){he instanceof y&&(p=he)}}),Object.defineProperty(this,"path",{get:function(){return p.path},set:function(he){p.path=he}});var Te=[];Object.defineProperty(this,"ctxStack",{get:function(){return Te},set:function(he){Te=he}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(he){var st;st=x(he),this.ctx.fillStyle=st.style,this.ctx.isFillTransparent=st.a===0,this.ctx.fillOpacity=st.a,this.pdf.setFillColor(st.r,st.g,st.b,{a:st.a}),this.pdf.setTextColor(st.r,st.g,st.b,{a:st.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(he){var st=x(he);this.ctx.strokeStyle=st.style,this.ctx.isStrokeTransparent=st.a===0,this.ctx.strokeOpacity=st.a,st.a===0?this.pdf.setDrawColor(255,255,255):(st.a,this.pdf.setDrawColor(st.r,st.g,st.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(he){["butt","round","square"].indexOf(he)!==-1&&(this.ctx.lineCap=he,this.pdf.setLineCap(he))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(he){isNaN(he)||(this.ctx.lineWidth=he,this.pdf.setLineWidth(he))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(he){["bevel","round","miter"].indexOf(he)!==-1&&(this.ctx.lineJoin=he,this.pdf.setLineJoin(he))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(he){isNaN(he)||(this.ctx.miterLimit=he,this.pdf.setMiterLimit(he))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(he){this.ctx.textBaseline=he}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(he){["right","end","center","left","start"].indexOf(he)!==-1&&(this.ctx.textAlign=he)}});var De=null;function Qe(he,st){if(De===null){var fr=function(er){var de=[];return Object.keys(er).forEach(function(ve){er[ve].forEach(function(Le){var Ue=null;switch(Le){case"bold":Ue={family:ve,weight:"bold"};break;case"italic":Ue={family:ve,style:"italic"};break;case"bolditalic":Ue={family:ve,weight:"bold",style:"italic"};break;case"":case"normal":Ue={family:ve}}Ue!==null&&(Ue.ref={name:ve,style:Le},de.push(Ue))})}),de}(he.getFontList());De=function(er){for(var de={},ve=0;ve<er.length;++ve){var Le=G2(er[ve]),Ue=Le.family,Ye=Le.stretch,lr=Le.style,yr=Le.weight;de[Ue]=de[Ue]||{},de[Ue][Ye]=de[Ue][Ye]||{},de[Ue][Ye][lr]=de[Ue][Ye][lr]||{},de[Ue][Ye][lr][yr]=Le}return de}(fr.concat(st))}return De}var Je=null;Object.defineProperty(this,"fontFaces",{get:function(){return Je},set:function(he){De=null,Je=he}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(he){var st;if(this.ctx.font=he,(st=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(he))!==null){var fr=st[1],er=(st[2],st[3]),de=st[4],ve=(st[5],st[6]),Le=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(de)[2];de=Math.floor(Le==="px"?parseFloat(de)*this.pdf.internal.scaleFactor:Le==="em"?parseFloat(de)*this.pdf.getFontSize():parseFloat(de)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(de);var Ue=function(cr){var _r,Re,An=[],me=cr.trim();if(me==="")return mP;if(me in hP)return[hP[me]];for(;me!=="";){switch(Re=null,_r=(me=fP(me)).charAt(0)){case'"':case"'":Re=Rrt(me.substring(1),_r);break;default:Re=Ort(me)}if(Re===null||(An.push(Re[0]),(me=fP(Re[1]))!==""&&me.charAt(0)!==","))return mP;me=me.replace(/^,/,"")}return An}(ve);if(this.fontFaces){var Ye=Urt(Qe(this.pdf,this.fontFaces),Ue.map(function(cr){return{family:cr,stretch:"normal",weight:er,style:fr}}));this.pdf.setFont(Ye.ref.name,Ye.ref.style)}else{var lr="";(er==="bold"||parseInt(er,10)>=700||fr==="bold")&&(lr="bold"),fr==="italic"&&(lr+="italic"),lr.length===0&&(lr="normal");for(var yr="",Lr={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Dr=0;Dr<Ue.length;Dr++){if(this.pdf.internal.getFont(Ue[Dr],lr,{noFallback:!0,disableWarning:!0})!==void 0){yr=Ue[Dr];break}if(lr==="bolditalic"&&this.pdf.internal.getFont(Ue[Dr],"bold",{noFallback:!0,disableWarning:!0})!==void 0)yr=Ue[Dr],lr="bold";else if(this.pdf.internal.getFont(Ue[Dr],"normal",{noFallback:!0,disableWarning:!0})!==void 0){yr=Ue[Dr],lr="normal";break}}if(yr===""){for(var pe=0;pe<Ue.length;pe++)if(Lr[Ue[pe]]){yr=Lr[Ue[pe]];break}}yr=yr===""?"Times":yr,this.pdf.setFont(yr,lr)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(he){this.ctx.globalCompositeOperation=he}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(he){this.ctx.globalAlpha=he}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(he){this.ctx.lineDashOffset=he,we.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(he){this.ctx.lineDash=he,we.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(he){this.ctx.ignoreClearRect=!!he}})};b.prototype.setLineDash=function(it){this.lineDash=it},b.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},b.prototype.fill=function(){tt.call(this,"fill",!1)},b.prototype.stroke=function(){tt.call(this,"stroke",!1)},b.prototype.beginPath=function(){this.path=[{type:"begin"}]},b.prototype.moveTo=function(it,xt){if(isNaN(it)||isNaN(xt))throw Ai.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var It=this.ctx.transform.applyToPoint(new a(it,xt));this.path.push({type:"mt",x:It.x,y:It.y}),this.ctx.lastPoint=new a(it,xt)},b.prototype.closePath=function(){var it=new a(0,0),xt=0;for(xt=this.path.length-1;xt!==-1;xt--)if(this.path[xt].type==="begin"&&Dn(this.path[xt+1])==="object"&&typeof this.path[xt+1].x=="number"){it=new a(this.path[xt+1].x,this.path[xt+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(it.x,it.y)},b.prototype.lineTo=function(it,xt){if(isNaN(it)||isNaN(xt))throw Ai.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var It=this.ctx.transform.applyToPoint(new a(it,xt));this.path.push({type:"lt",x:It.x,y:It.y}),this.ctx.lastPoint=new a(It.x,It.y)},b.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),tt.call(this,null,!0)},b.prototype.quadraticCurveTo=function(it,xt,It,Ut){if(isNaN(It)||isNaN(Ut)||isNaN(it)||isNaN(xt))throw Ai.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var jt=this.ctx.transform.applyToPoint(new a(It,Ut)),Vt=this.ctx.transform.applyToPoint(new a(it,xt));this.path.push({type:"qct",x1:Vt.x,y1:Vt.y,x:jt.x,y:jt.y}),this.ctx.lastPoint=new a(jt.x,jt.y)},b.prototype.bezierCurveTo=function(it,xt,It,Ut,jt,Vt){if(isNaN(jt)||isNaN(Vt)||isNaN(it)||isNaN(xt)||isNaN(It)||isNaN(Ut))throw Ai.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var re=this.ctx.transform.applyToPoint(new a(jt,Vt)),te=this.ctx.transform.applyToPoint(new a(it,xt)),Ce=this.ctx.transform.applyToPoint(new a(It,Ut));this.path.push({type:"bct",x1:te.x,y1:te.y,x2:Ce.x,y2:Ce.y,x:re.x,y:re.y}),this.ctx.lastPoint=new a(re.x,re.y)},b.prototype.arc=function(it,xt,It,Ut,jt,Vt){if(isNaN(it)||isNaN(xt)||isNaN(It)||isNaN(Ut)||isNaN(jt))throw Ai.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Vt=!!Vt,!this.ctx.transform.isIdentity){var re=this.ctx.transform.applyToPoint(new a(it,xt));it=re.x,xt=re.y;var te=this.ctx.transform.applyToPoint(new a(0,It)),Ce=this.ctx.transform.applyToPoint(new a(0,0));It=Math.sqrt(Math.pow(te.x-Ce.x,2)+Math.pow(te.y-Ce.y,2))}Math.abs(jt-Ut)>=2*Math.PI&&(Ut=0,jt=2*Math.PI),this.path.push({type:"arc",x:it,y:xt,radius:It,startAngle:Ut,endAngle:jt,counterclockwise:Vt})},b.prototype.arcTo=function(it,xt,It,Ut,jt){throw new Error("arcTo not implemented.")},b.prototype.rect=function(it,xt,It,Ut){if(isNaN(it)||isNaN(xt)||isNaN(It)||isNaN(Ut))throw Ai.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(it,xt),this.lineTo(it+It,xt),this.lineTo(it+It,xt+Ut),this.lineTo(it,xt+Ut),this.lineTo(it,xt),this.lineTo(it+It,xt),this.lineTo(it,xt)},b.prototype.fillRect=function(it,xt,It,Ut){if(isNaN(it)||isNaN(xt)||isNaN(It)||isNaN(Ut))throw Ai.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!C.call(this)){var jt={};this.lineCap!=="butt"&&(jt.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(jt.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(it,xt,It,Ut),this.fill(),jt.hasOwnProperty("lineCap")&&(this.lineCap=jt.lineCap),jt.hasOwnProperty("lineJoin")&&(this.lineJoin=jt.lineJoin)}},b.prototype.strokeRect=function(it,xt,It,Ut){if(isNaN(it)||isNaN(xt)||isNaN(It)||isNaN(Ut))throw Ai.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");P.call(this)||(this.beginPath(),this.rect(it,xt,It,Ut),this.stroke())},b.prototype.clearRect=function(it,xt,It,Ut){if(isNaN(it)||isNaN(xt)||isNaN(It)||isNaN(Ut))throw Ai.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(it,xt,It,Ut))},b.prototype.save=function(it){it=typeof it!="boolean"||it;for(var xt=this.pdf.internal.getCurrentPageInfo().pageNumber,It=0;It<this.pdf.internal.getNumberOfPages();It++)this.pdf.setPage(It+1),this.pdf.internal.out("q");if(this.pdf.setPage(xt),it){this.ctx.fontSize=this.pdf.internal.getFontSize();var Ut=new y(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Ut}},b.prototype.restore=function(it){it=typeof it!="boolean"||it;for(var xt=this.pdf.internal.getCurrentPageInfo().pageNumber,It=0;It<this.pdf.internal.getNumberOfPages();It++)this.pdf.setPage(It+1),this.pdf.internal.out("Q");this.pdf.setPage(xt),it&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},b.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(it){var xt,It,Ut,jt;if(it.isCanvasGradient===!0&&(it=it.getColor()),!it)return{r:0,g:0,b:0,a:0,style:it};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(it))xt=0,It=0,Ut=0,jt=0;else{var Vt=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(it);if(Vt!==null)xt=parseInt(Vt[1]),It=parseInt(Vt[2]),Ut=parseInt(Vt[3]),jt=1;else if((Vt=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(it))!==null)xt=parseInt(Vt[1]),It=parseInt(Vt[2]),Ut=parseInt(Vt[3]),jt=parseFloat(Vt[4]);else{if(jt=1,typeof it=="string"&&it.charAt(0)!=="#"){var re=new JL(it);it=re.ok?re.toHex():"#000000"}it.length===4?(xt=it.substring(1,2),xt+=xt,It=it.substring(2,3),It+=It,Ut=it.substring(3,4),Ut+=Ut):(xt=it.substring(1,3),It=it.substring(3,5),Ut=it.substring(5,7)),xt=parseInt(xt,16),It=parseInt(It,16),Ut=parseInt(Ut,16)}}return{r:xt,g:It,b:Ut,a:jt,style:it}},C=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},P=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};b.prototype.fillText=function(it,xt,It,Ut){if(isNaN(xt)||isNaN(It)||typeof it!="string")throw Ai.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Ut=isNaN(Ut)?void 0:Ut,!C.call(this)){var jt=Kt(this.ctx.transform.rotation),Vt=this.ctx.transform.scaleX;ct.call(this,{text:it,x:xt,y:It,scale:Vt,angle:jt,align:this.textAlign,maxWidth:Ut})}},b.prototype.strokeText=function(it,xt,It,Ut){if(isNaN(xt)||isNaN(It)||typeof it!="string")throw Ai.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!P.call(this)){Ut=isNaN(Ut)?void 0:Ut;var jt=Kt(this.ctx.transform.rotation),Vt=this.ctx.transform.scaleX;ct.call(this,{text:it,x:xt,y:It,scale:Vt,renderingMode:"stroke",angle:jt,align:this.textAlign,maxWidth:Ut})}},b.prototype.measureText=function(it){if(typeof it!="string")throw Ai.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var xt=this.pdf,It=this.pdf.internal.scaleFactor,Ut=xt.internal.getFontSize(),jt=xt.getStringUnitWidth(it)*Ut/xt.internal.scaleFactor,Vt=function(re){var te=(re=re||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return te}}),this};return new Vt({width:jt*=Math.round(96*It/72*1e4)/1e4})},b.prototype.scale=function(it,xt){if(isNaN(it)||isNaN(xt))throw Ai.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var It=new d(it,0,0,xt,0,0);this.ctx.transform=this.ctx.transform.multiply(It)},b.prototype.rotate=function(it){if(isNaN(it))throw Ai.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var xt=new d(Math.cos(it),Math.sin(it),-Math.sin(it),Math.cos(it),0,0);this.ctx.transform=this.ctx.transform.multiply(xt)},b.prototype.translate=function(it,xt){if(isNaN(it)||isNaN(xt))throw Ai.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var It=new d(1,0,0,1,it,xt);this.ctx.transform=this.ctx.transform.multiply(It)},b.prototype.transform=function(it,xt,It,Ut,jt,Vt){if(isNaN(it)||isNaN(xt)||isNaN(It)||isNaN(Ut)||isNaN(jt)||isNaN(Vt))throw Ai.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var re=new d(it,xt,It,Ut,jt,Vt);this.ctx.transform=this.ctx.transform.multiply(re)},b.prototype.setTransform=function(it,xt,It,Ut,jt,Vt){it=isNaN(it)?1:it,xt=isNaN(xt)?0:xt,It=isNaN(It)?0:It,Ut=isNaN(Ut)?1:Ut,jt=isNaN(jt)?0:jt,Vt=isNaN(Vt)?0:Vt,this.ctx.transform=new d(it,xt,It,Ut,jt,Vt)};var M=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};b.prototype.drawImage=function(it,xt,It,Ut,jt,Vt,re,te,Ce){var Te=this.pdf.getImageProperties(it),De=1,Qe=1,Je=1,he=1;Ut!==void 0&&te!==void 0&&(Je=te/Ut,he=Ce/jt,De=Te.width/Ut*te/Ut,Qe=Te.height/jt*Ce/jt),Vt===void 0&&(Vt=xt,re=It,xt=0,It=0),Ut!==void 0&&te===void 0&&(te=Ut,Ce=jt),Ut===void 0&&te===void 0&&(te=Te.width,Ce=Te.height);for(var st,fr=this.ctx.transform.decompose(),er=Kt(fr.rotate.shx),de=new d,ve=(de=(de=(de=de.multiply(fr.translate)).multiply(fr.skew)).multiply(fr.scale)).applyToRectangle(new o(Vt-xt*Je,re-It*he,Ut*De,jt*Qe)),Le=k.call(this,ve),Ue=[],Ye=0;Ye<Le.length;Ye+=1)Ue.indexOf(Le[Ye])===-1&&Ue.push(Le[Ye]);if($(Ue),this.autoPaging)for(var lr=Ue[0],yr=Ue[Ue.length-1],Lr=lr;Lr<yr+1;Lr++){this.pdf.setPage(Lr);var Dr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],pe=Lr===1?this.posY+this.margin[0]:this.margin[0],cr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_r=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Re=Lr===1?0:cr+(Lr-2)*_r;if(this.ctx.clip_path.length!==0){var An=this.path;st=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=V(st,this.posX+this.margin[3],-Re+pe+this.ctx.prevPageLastElemOffset),pt.call(this,"fill",!0),this.path=An}var me=JSON.parse(JSON.stringify(ve));me=V([me],this.posX+this.margin[3],-Re+pe+this.ctx.prevPageLastElemOffset)[0];var gr=(Lr>lr||Lr<yr)&&M.call(this);gr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Dr,_r,null).clip().discardPath()),this.pdf.addImage(it,"JPEG",me.x,me.y,me.w,me.h,null,null,er),gr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(it,"JPEG",ve.x,ve.y,ve.w,ve.h,null,null,er)};var k=function(it,xt,It){var Ut=[];xt=xt||this.pdf.internal.pageSize.width,It=It||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var jt=this.posY+this.ctx.prevPageLastElemOffset;switch(it.type){default:case"mt":case"lt":Ut.push(Math.floor((it.y+jt)/It)+1);break;case"arc":Ut.push(Math.floor((it.y+jt-it.radius)/It)+1),Ut.push(Math.floor((it.y+jt+it.radius)/It)+1);break;case"qct":var Vt=ee(this.ctx.lastPoint.x,this.ctx.lastPoint.y,it.x1,it.y1,it.x,it.y);Ut.push(Math.floor((Vt.y+jt)/It)+1),Ut.push(Math.floor((Vt.y+Vt.h+jt)/It)+1);break;case"bct":var re=Zt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,it.x1,it.y1,it.x2,it.y2,it.x,it.y);Ut.push(Math.floor((re.y+jt)/It)+1),Ut.push(Math.floor((re.y+re.h+jt)/It)+1);break;case"rect":Ut.push(Math.floor((it.y+jt)/It)+1),Ut.push(Math.floor((it.y+it.h+jt)/It)+1)}for(var te=0;te<Ut.length;te+=1)for(;this.pdf.internal.getNumberOfPages()<Ut[te];)z.call(this);return Ut},z=function(){var it=this.fillStyle,xt=this.strokeStyle,It=this.font,Ut=this.lineCap,jt=this.lineWidth,Vt=this.lineJoin;this.pdf.addPage(),this.fillStyle=it,this.strokeStyle=xt,this.font=It,this.lineCap=Ut,this.lineWidth=jt,this.lineJoin=Vt},V=function(it,xt,It){for(var Ut=0;Ut<it.length;Ut++)switch(it[Ut].type){case"bct":it[Ut].x2+=xt,it[Ut].y2+=It;case"qct":it[Ut].x1+=xt,it[Ut].y1+=It;case"mt":case"lt":case"arc":default:it[Ut].x+=xt,it[Ut].y+=It}return it},$=function(it){return it.sort(function(xt,It){return xt-It})},tt=function(it,xt){for(var It,Ut,jt=this.fillStyle,Vt=this.strokeStyle,re=this.lineCap,te=this.lineWidth,Ce=Math.abs(te*this.ctx.transform.scaleX),Te=this.lineJoin,De=JSON.parse(JSON.stringify(this.path)),Qe=JSON.parse(JSON.stringify(this.path)),Je=[],he=0;he<Qe.length;he++)if(Qe[he].x!==void 0)for(var st=k.call(this,Qe[he]),fr=0;fr<st.length;fr+=1)Je.indexOf(st[fr])===-1&&Je.push(st[fr]);for(var er=0;er<Je.length;er++)for(;this.pdf.internal.getNumberOfPages()<Je[er];)z.call(this);if($(Je),this.autoPaging)for(var de=Je[0],ve=Je[Je.length-1],Le=de;Le<ve+1;Le++){this.pdf.setPage(Le),this.fillStyle=jt,this.strokeStyle=Vt,this.lineCap=re,this.lineWidth=Ce,this.lineJoin=Te;var Ue=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ye=Le===1?this.posY+this.margin[0]:this.margin[0],lr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],yr=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Lr=Le===1?0:lr+(Le-2)*yr;if(this.ctx.clip_path.length!==0){var Dr=this.path;It=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=V(It,this.posX+this.margin[3],-Lr+Ye+this.ctx.prevPageLastElemOffset),pt.call(this,it,!0),this.path=Dr}if(Ut=JSON.parse(JSON.stringify(De)),this.path=V(Ut,this.posX+this.margin[3],-Lr+Ye+this.ctx.prevPageLastElemOffset),xt===!1||Le===0){var pe=(Le>de||Le<ve)&&M.call(this);pe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ue,yr,null).clip().discardPath()),pt.call(this,it,xt),pe&&this.pdf.restoreGraphicsState()}this.lineWidth=te}else this.lineWidth=Ce,pt.call(this,it,xt),this.lineWidth=te;this.path=De},pt=function(it,xt){if((it!=="stroke"||xt||!P.call(this))&&(it==="stroke"||xt||!C.call(this))){for(var It,Ut,jt=[],Vt=this.path,re=0;re<Vt.length;re++){var te=Vt[re];switch(te.type){case"begin":jt.push({begin:!0});break;case"close":jt.push({close:!0});break;case"mt":jt.push({start:te,deltas:[],abs:[]});break;case"lt":var Ce=jt.length;if(Vt[re-1]&&!isNaN(Vt[re-1].x)&&(It=[te.x-Vt[re-1].x,te.y-Vt[re-1].y],Ce>0)){for(;Ce>=0;Ce--)if(jt[Ce-1].close!==!0&&jt[Ce-1].begin!==!0){jt[Ce-1].deltas.push(It),jt[Ce-1].abs.push(te);break}}break;case"bct":It=[te.x1-Vt[re-1].x,te.y1-Vt[re-1].y,te.x2-Vt[re-1].x,te.y2-Vt[re-1].y,te.x-Vt[re-1].x,te.y-Vt[re-1].y],jt[jt.length-1].deltas.push(It);break;case"qct":var Te=Vt[re-1].x+2/3*(te.x1-Vt[re-1].x),De=Vt[re-1].y+2/3*(te.y1-Vt[re-1].y),Qe=te.x+2/3*(te.x1-te.x),Je=te.y+2/3*(te.y1-te.y),he=te.x,st=te.y;It=[Te-Vt[re-1].x,De-Vt[re-1].y,Qe-Vt[re-1].x,Je-Vt[re-1].y,he-Vt[re-1].x,st-Vt[re-1].y],jt[jt.length-1].deltas.push(It);break;case"arc":jt.push({deltas:[],abs:[],arc:!0}),Array.isArray(jt[jt.length-1].abs)&&jt[jt.length-1].abs.push(te)}}Ut=xt?null:it==="stroke"?"stroke":"fill";for(var fr=!1,er=0;er<jt.length;er++)if(jt[er].arc)for(var de=jt[er].abs,ve=0;ve<de.length;ve++){var Le=de[ve];Le.type==="arc"?dt.call(this,Le.x,Le.y,Le.radius,Le.startAngle,Le.endAngle,Le.counterclockwise,void 0,xt,!fr):wt.call(this,Le.x,Le.y),fr=!0}else if(jt[er].close===!0)this.pdf.internal.out("h"),fr=!1;else if(jt[er].begin!==!0){var Ue=jt[er].start.x,Ye=jt[er].start.y;vt.call(this,jt[er].deltas,Ue,Ye),fr=!0}Ut&&Ft.call(this,Ut),xt&&Tt.call(this)}},gt=function(it){var xt=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,It=xt*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return it-It;case"top":return it+xt-It;case"hanging":return it+xt-2*It;case"middle":return it+xt/2-It;case"ideographic":return it;case"alphabetic":default:return it}},mt=function(it){return it+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};b.prototype.createLinearGradient=function(){var it=function(){};return it.colorStops=[],it.addColorStop=function(xt,It){this.colorStops.push([xt,It])},it.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},it.isCanvasGradient=!0,it},b.prototype.createPattern=function(){return this.createLinearGradient()},b.prototype.createRadialGradient=function(){return this.createLinearGradient()};var dt=function(it,xt,It,Ut,jt,Vt,re,te,Ce){for(var Te=Wt.call(this,It,Ut,jt,Vt),De=0;De<Te.length;De++){var Qe=Te[De];De===0&&(Ce?ot.call(this,Qe.x1+it,Qe.y1+xt):wt.call(this,Qe.x1+it,Qe.y1+xt)),$t.call(this,it,xt,Qe.x2,Qe.y2,Qe.x3,Qe.y3,Qe.x4,Qe.y4)}te?Tt.call(this):Ft.call(this,re)},Ft=function(it){switch(it){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Tt=function(){this.pdf.clip(),this.pdf.discardPath()},ot=function(it,xt){this.pdf.internal.out(e(it)+" "+n(xt)+" m")},ct=function(it){var xt;switch(it.align){case"right":case"end":xt="right";break;case"center":xt="center";break;case"left":case"start":default:xt="left"}var It=this.pdf.getTextDimensions(it.text),Ut=gt.call(this,it.y),jt=mt.call(this,Ut)-It.h,Vt=this.ctx.transform.applyToPoint(new a(it.x,Ut)),re=this.ctx.transform.decompose(),te=new d;te=(te=(te=te.multiply(re.translate)).multiply(re.skew)).multiply(re.scale);for(var Ce,Te,De,Qe=this.ctx.transform.applyToRectangle(new o(it.x,Ut,It.w,It.h)),Je=te.applyToRectangle(new o(it.x,jt,It.w,It.h)),he=k.call(this,Je),st=[],fr=0;fr<he.length;fr+=1)st.indexOf(he[fr])===-1&&st.push(he[fr]);if($(st),this.autoPaging)for(var er=st[0],de=st[st.length-1],ve=er;ve<de+1;ve++){this.pdf.setPage(ve);var Le=ve===1?this.posY+this.margin[0]:this.margin[0],Ue=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ye=this.pdf.internal.pageSize.height-this.margin[2],lr=Ye-this.margin[0],yr=this.pdf.internal.pageSize.width-this.margin[1],Lr=yr-this.margin[3],Dr=ve===1?0:Ue+(ve-2)*lr;if(this.ctx.clip_path.length!==0){var pe=this.path;Ce=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=V(Ce,this.posX+this.margin[3],-1*Dr+Le),pt.call(this,"fill",!0),this.path=pe}var cr=V([JSON.parse(JSON.stringify(Je))],this.posX+this.margin[3],-Dr+Le+this.ctx.prevPageLastElemOffset)[0];it.scale>=.01&&(Te=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Te*it.scale),De=this.lineWidth,this.lineWidth=De*it.scale);var _r=this.autoPaging!=="text";if(_r||cr.y+cr.h<=Ye){if(_r||cr.y>=Le&&cr.x<=yr){var Re=_r?it.text:this.pdf.splitTextToSize(it.text,it.maxWidth||yr-cr.x)[0],An=V([JSON.parse(JSON.stringify(Qe))],this.posX+this.margin[3],-Dr+Le+this.ctx.prevPageLastElemOffset)[0],me=_r&&(ve>er||ve<de)&&M.call(this);me&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Lr,lr,null).clip().discardPath()),this.pdf.text(Re,An.x,An.y,{angle:it.angle,align:xt,renderingMode:it.renderingMode}),me&&this.pdf.restoreGraphicsState()}}else cr.y<Ye&&(this.ctx.prevPageLastElemOffset+=Ye-cr.y);it.scale>=.01&&(this.pdf.setFontSize(Te),this.lineWidth=De)}else it.scale>=.01&&(Te=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Te*it.scale),De=this.lineWidth,this.lineWidth=De*it.scale),this.pdf.text(it.text,Vt.x+this.posX,Vt.y+this.posY,{angle:it.angle,align:xt,renderingMode:it.renderingMode,maxWidth:it.maxWidth}),it.scale>=.01&&(this.pdf.setFontSize(Te),this.lineWidth=De)},wt=function(it,xt,It,Ut){It=It||0,Ut=Ut||0,this.pdf.internal.out(e(it+It)+" "+n(xt+Ut)+" l")},vt=function(it,xt,It){return this.pdf.lines(it,xt,It,null,null)},$t=function(it,xt,It,Ut,jt,Vt,re,te){this.pdf.internal.out([t(i(It+it)),t(s(Ut+xt)),t(i(jt+it)),t(s(Vt+xt)),t(i(re+it)),t(s(te+xt)),"c"].join(" "))},Wt=function(it,xt,It,Ut){for(var jt=2*Math.PI,Vt=Math.PI/2;xt>It;)xt-=jt;var re=Math.abs(It-xt);re<jt&&Ut&&(re=jt-re);for(var te=[],Ce=Ut?-1:1,Te=xt;re>1e-5;){var De=Te+Ce*Math.min(re,Vt);te.push(Yt.call(this,it,Te,De)),re-=Math.abs(De-Te),Te=De}return te},Yt=function(it,xt,It){var Ut=(It-xt)/2,jt=it*Math.cos(Ut),Vt=it*Math.sin(Ut),re=jt,te=-Vt,Ce=re*re+te*te,Te=Ce+re*jt+te*Vt,De=4/3*(Math.sqrt(2*Ce*Te)-Te)/(re*Vt-te*jt),Qe=re-De*te,Je=te+De*re,he=Qe,st=-Je,fr=Ut+xt,er=Math.cos(fr),de=Math.sin(fr);return{x1:it*Math.cos(xt),y1:it*Math.sin(xt),x2:Qe*er-Je*de,y2:Qe*de+Je*er,x3:he*er-st*de,y3:he*de+st*er,x4:it*Math.cos(It),y4:it*Math.sin(It)}},Kt=function(it){return 180*it/Math.PI},ee=function(it,xt,It,Ut,jt,Vt){var re=it+.5*(It-it),te=xt+.5*(Ut-xt),Ce=jt+.5*(It-jt),Te=Vt+.5*(Ut-Vt),De=Math.min(it,jt,re,Ce),Qe=Math.max(it,jt,re,Ce),Je=Math.min(xt,Vt,te,Te),he=Math.max(xt,Vt,te,Te);return new o(De,Je,Qe-De,he-Je)},Zt=function(it,xt,It,Ut,jt,Vt,re,te){var Ce,Te,De,Qe,Je,he,st,fr,er,de,ve,Le,Ue,Ye,lr=It-it,yr=Ut-xt,Lr=jt-It,Dr=Vt-Ut,pe=re-jt,cr=te-Vt;for(Te=0;Te<41;Te++)er=(st=(De=it+(Ce=Te/40)*lr)+Ce*((Je=It+Ce*Lr)-De))+Ce*(Je+Ce*(jt+Ce*pe-Je)-st),de=(fr=(Qe=xt+Ce*yr)+Ce*((he=Ut+Ce*Dr)-Qe))+Ce*(he+Ce*(Vt+Ce*cr-he)-fr),Te==0?(ve=er,Le=de,Ue=er,Ye=de):(ve=Math.min(ve,er),Le=Math.min(Le,de),Ue=Math.max(Ue,er),Ye=Math.max(Ye,de));return new o(Math.round(ve),Math.round(Le),Math.round(Ue-ve),Math.round(Ye-Le))},we=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var it,xt,It=(it=this.ctx.lineDash,xt=this.ctx.lineDashOffset,JSON.stringify({lineDash:it,lineDashOffset:xt}));this.prevLineDash!==It&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=It)}}})(Vr.API),function(r){var t=function(s){var a,o,d,p,y,b,x,C,P,M;for(o=[],d=0,p=(s+=a="\0\0\0\0".slice(s.length%4||4)).length;p>d;d+=4)(y=(s.charCodeAt(d)<<24)+(s.charCodeAt(d+1)<<16)+(s.charCodeAt(d+2)<<8)+s.charCodeAt(d+3))!==0?(b=(y=((y=((y=((y=(y-(M=y%85))/85)-(P=y%85))/85)-(C=y%85))/85)-(x=y%85))/85)%85,o.push(b+33,x+33,C+33,P+33,M+33)):o.push(122);return function(k,z){for(var V=z;V>0;V--)k.pop()}(o,a.length),String.fromCharCode.apply(String,o)+"~>"},e=function(s){var a,o,d,p,y,b=String,x="length",C=255,P="charCodeAt",M="slice",k="replace";for(s[M](-2),s=s[M](0,-2)[k](/\s/g,"")[k]("z","!!!!!"),d=[],p=0,y=(s+=a="uuuuu"[M](s[x]%5||5))[x];y>p;p+=5)o=52200625*(s[P](p)-33)+614125*(s[P](p+1)-33)+7225*(s[P](p+2)-33)+85*(s[P](p+3)-33)+(s[P](p+4)-33),d.push(C&o>>24,C&o>>16,C&o>>8,C&o);return function(z,V){for(var $=V;$>0;$--)z.pop()}(d,a[x]),b.fromCharCode.apply(b,d)},n=function(s){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),a.test(s)===!1)return"";for(var o="",d=0;d<s.length;d+=2)o+=String.fromCharCode("0x"+(s[d]+s[d+1]));return o},i=function(s){for(var a=new Uint8Array(s.length),o=s.length;o--;)a[o]=s.charCodeAt(o);return s=(a=M2(a)).reduce(function(d,p){return d+String.fromCharCode(p)},"")};r.processDataByFilters=function(s,a){var o=0,d=s||"",p=[];for(typeof(a=a||[])=="string"&&(a=[a]),o=0;o<a.length;o+=1)switch(a[o]){case"ASCII85Decode":case"/ASCII85Decode":d=e(d),p.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=t(d),p.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=n(d),p.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=d.split("").map(function(y){return("0"+y.charCodeAt().toString(16)).slice(-2)}).join("")+">",p.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=i(d),p.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[o]+'" is not implemented')}return{data:d,reverseChain:p.reverse().join(" ")}}}(Vr.API),function(r){r.loadFile=function(t,e,n){return function(i,s,a){s=s!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=function(d,p,y){var b=new XMLHttpRequest,x=0,C=function(P){var M=P.length,k=[],z=String.fromCharCode;for(x=0;x<M;x+=1)k.push(z(255&P.charCodeAt(x)));return k.join("")};if(b.open("GET",d,!p),b.overrideMimeType("text/plain; charset=x-user-defined"),p===!1&&(b.onload=function(){b.status===200?y(C(this.responseText)):y(void 0)}),b.send(null),p&&b.status===200)return C(b.responseText)}(i,s,a)}catch{}return o}(t,e,n)},r.loadImageFile=r.loadFile}(Vr.API),function(r){function t(){return(Hr.html2canvas?Promise.resolve(Hr.html2canvas):Promise.resolve().then(()=>zut)).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function e(){return(Hr.DOMPurify?Promise.resolve(Hr.DOMPurify):Promise.resolve().then(()=>mAt)).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var n=function(a){var o=Dn(a);return o==="undefined"?"undefined":o==="string"||a instanceof String?"string":o==="number"||a instanceof Number?"number":o==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":o==="object"?"object":"unknown"},i=function(a,o){var d=document.createElement(a);for(var p in o.className&&(d.className=o.className),o.innerHTML&&o.dompurify&&(d.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)d.style[p]=o.style[p];return d},s=function a(o){var d=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),p=a.convert(Promise.resolve(),d);return p=(p=p.setProgress(1,a,1,[a])).set(o)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(a,o){return a.__proto__=o||s.prototype,a},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(a,o){return this.then(function(){switch(o=o||function(d){switch(n(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(a)){case"string":return this.then(e).then(function(d){return this.set({src:i("div",{innerHTML:a,dompurify:d})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},s.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function d(p,y){for(var b=p.nodeType===3?document.createTextNode(p.nodeValue):p.cloneNode(!1),x=p.firstChild;x;x=x.nextSibling)y!==!0&&x.nodeType===1&&x.nodeName==="SCRIPT"||b.appendChild(d(x,y));return p.nodeType===1&&(p.nodeName==="CANVAS"?(b.width=p.width,b.height=p.height,b.getContext("2d").drawImage(p,0,0)):p.nodeName!=="TEXTAREA"&&p.nodeName!=="SELECT"||(b.value=p.value),b.addEventListener("load",function(){b.scrollTop=p.scrollTop,b.scrollLeft=p.scrollLeft},!0)),b}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(o){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,o(this.prop.container,d)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(o){var d=this.opt.jsPDF,p=this.opt.fontFaces,y=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,b=Object.assign({async:!0,allowTaint:!0,scale:y,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete b.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=p,p)for(var x=0;x<p.length;++x){var C=p[x],P=C.src.find(function(M){return M.format==="truetype"});P&&d.addFont(P.url,C.ref.name,C.ref.style)}return b.windowHeight=b.windowHeight||0,b.windowHeight=b.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):b.windowHeight,d.context2d.save(!0),o(this.prop.container,b)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(a,o,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(a,o):this.outputPdf(a,o)},s.prototype.outputPdf=function(a,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,o)})},s.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},s.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(a){if(n(a)!=="object")return this;var o=Object.keys(a||{}).map(function(d){if(d in s.template.prop)return function(){this.prop[d]=a[d]};switch(d){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[d]=a[d]}}},this);return this.then(function(){return this.thenList(o)})},s.prototype.get=function(a,o){return this.then(function(){var d=a in s.template.prop?this.prop[a]:this.opt[a];return o?o(d):d})},s.prototype.setMargin=function(a){return this.then(function(){switch(n(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},s.prototype.setPageSize=function(a){function o(d,p){return Math.floor(d*p/72*96)}return this.then(function(){(a=a||Vr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:o(a.inner.width,a.k),height:o(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},s.prototype.setProgress=function(a,o,d,p){return a!=null&&(this.progress.val=a),o!=null&&(this.progress.state=o),d!=null&&(this.progress.n=d),p!=null&&(this.progress.stack=p),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(a,o,d,p){return this.setProgress(a?this.progress.val+a:null,o||null,d?this.progress.n+d:null,p?this.progress.stack.concat(p):null)},s.prototype.then=function(a,o){var d=this;return this.thenCore(a,o,function(p,y){return d.updateProgress(null,null,1,[p]),Promise.prototype.then.call(this,function(b){return d.updateProgress(null,p),b}).then(p,y).then(function(b){return d.updateProgress(1),b})})},s.prototype.thenCore=function(a,o,d){d=d||Promise.prototype.then,a&&(a=a.bind(this)),o&&(o=o.bind(this));var p=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),y=d.call(p,a,o);return s.convert(y,this.__proto__)},s.prototype.thenExternal=function(a,o){return Promise.prototype.then.call(this,a,o)},s.prototype.thenList=function(a){var o=this;return a.forEach(function(d){o=o.thenCore(d)}),o},s.prototype.catch=function(a){a&&(a=a.bind(this));var o=Promise.prototype.catch.call(this,a);return s.convert(o,this)},s.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},s.prototype.error=function(a){return this.then(function(){throw new Error(a)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,Vr.getPageSize=function(a,o,d){if(Dn(a)==="object"){var p=a;a=p.orientation,o=p.unit||o,d=p.format||d}o=o||"mm",d=d||"a4",a=(""+(a||"P")).toLowerCase();var y,b=(""+d).toLowerCase(),x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":y=1;break;case"mm":y=72/25.4;break;case"cm":y=72/2.54;break;case"in":y=72;break;case"px":y=.75;break;case"pc":case"em":y=12;break;case"ex":y=6;break;default:throw"Invalid unit: "+o}var C,P=0,M=0;if(x.hasOwnProperty(b))P=x[b][1]/y,M=x[b][0]/y;else try{P=d[1],M=d[0]}catch{throw new Error("Invalid format: "+d)}if(a==="p"||a==="portrait")a="p",M>P&&(C=M,M=P,P=C);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",P>M&&(C=M,M=P,P=C)}return{width:M,height:P,unit:o,k:y,orientation:a}},r.html=function(a,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(G2):null;var d=new s(o);return o.worker?d:d.from(a).doCallback()}}(Vr.API),Vr.API.addJS=function(r){return gP=r,this.internal.events.subscribe("postPutResources",function(){Hy=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Hy+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),pP=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+gP+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Hy!==void 0&&pP!==void 0&&this.internal.out("/Names <</JavaScript "+Hy+" 0 R>>")}),this},function(r){var t;r.events.push(["postPutResources",function(){var e=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=e.outline.render().split(/\r\n/),s=0;s<i.length;s++){var a=i[s],o=n.exec(a);if(o!=null){var d=o[1];e.internal.newObjectDeferredBegin(d,!1)}e.internal.write(a)}if(this.outline.createNamedDestinations){var p=this.internal.pages.length,y=[];for(s=0;s<p;s++){var b=e.internal.newObject();y.push(b);var x=e.internal.getPageInfo(s+1);e.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var C=e.internal.newObject();for(e.internal.write("<< /Names [ "),s=0;s<y.length;s++)e.internal.write("(page_"+(s+1)+")"+y[s]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+C+" 0 R"),e.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),r.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(n,i,s){var a={title:i,options:s,children:[]};return n==null&&(n=this.root),n.children.push(a),a},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(n){n.id=e.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},e.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},e.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var a=n.children[s];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var d=e.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+d.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var p=0;p<n.children.length;p++)this.renderItems(n.children[p])},e.outline.line=function(n){this.ctx.val+=n+`\r
`},e.outline.makeRef=function(n){return n.id+" 0 R"},e.outline.makeString=function(n){return"("+e.internal.pdfEscape(n)+")"},e.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},e.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},e.outline.count_r=function(n,i){for(var s=0;s<i.children.length;s++)n.count++,this.count_r(n,i.children[s]);return n.count}}])}(Vr.API),function(r){var t=[192,193,194,195,196,197,198,199];r.processJPEG=function(e,n,i,s,a,o){var d,p=this.decode.DCT_DECODE,y=null;if(typeof e=="string"||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=a||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,(d=function(b){for(var x,C=256*b.charCodeAt(4)+b.charCodeAt(5),P=b.length,M={width:0,height:0,numcomponents:1},k=4;k<P;k+=2){if(k+=C,t.indexOf(b.charCodeAt(k+1))!==-1){x=256*b.charCodeAt(k+5)+b.charCodeAt(k+6),M={width:256*b.charCodeAt(k+7)+b.charCodeAt(k+8),height:x,numcomponents:b.charCodeAt(k+9)};break}C=256*b.charCodeAt(k+2)+b.charCodeAt(k+3)}return M}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}y={data:e,width:d.width,height:d.height,colorSpace:o,bitsPerComponent:8,filter:p,index:n,alias:i}}return y}}(Vr.API);var Nf,Vy,yP,_P,vP,Drt=function(){var r,t,e;function n(s){var a,o,d,p,y,b,x,C,P,M,k,z,V,$;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},b=null;;){switch(a=this.readUInt32(),P=(function(){var tt,pt;for(pt=[],tt=0;tt<4;++tt)pt.push(String.fromCharCode(this.data[this.pos++]));return pt}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(a);break;case"fcTL":b&&this.animation.frames.push(b),this.pos+=4,b={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},y=this.readUInt16(),p=this.readUInt16()||100,b.delay=1e3*y/p,b.disposeOp=this.data[this.pos++],b.blendOp=this.data[this.pos++],b.data=[];break;case"IDAT":case"fdAT":for(P==="fdAT"&&(this.pos+=4,a-=4),s=(b!=null?b.data:void 0)||this.imgData,z=0;0<=a?z<a:z>a;0<=a?++z:--z)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(d=this.palette.length/3,this.transparency.indexed=this.read(a),this.transparency.indexed.length>d)throw new Error("More transparent colors than palette size");if((M=d-this.transparency.indexed.length)>0)for(V=0;0<=M?V<M:V>M;0<=M?++V:--V)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(a)[0];break;case 2:this.transparency.rgb=this.read(a)}break;case"tEXt":x=(k=this.read(a)).indexOf(0),C=String.fromCharCode.apply(String,k.slice(0,x)),this.text[C]=String.fromCharCode.apply(String,k.slice(x+1));break;case"IEND":return b&&this.animation.frames.push(b),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=($=this.colorType)===4||$===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=a}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(s){var a,o;for(o=[],a=0;0<=s?a<s:a>s;0<=s?++a:--a)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(s){var a=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*a),d=0,p=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function y(b,x,C,P){var M,k,z,V,$,tt,pt,gt,mt,dt,Ft,Tt,ot,ct,wt,vt,$t,Wt,Yt,Kt,ee,Zt=Math.ceil((p.width-b)/C),we=Math.ceil((p.height-x)/P),it=p.width==Zt&&p.height==we;for(ct=a*Zt,Tt=it?o:new Uint8Array(ct*we),tt=s.length,ot=0,k=0;ot<we&&d<tt;){switch(s[d++]){case 0:for(V=$t=0;$t<ct;V=$t+=1)Tt[k++]=s[d++];break;case 1:for(V=Wt=0;Wt<ct;V=Wt+=1)M=s[d++],$=V<a?0:Tt[k-a],Tt[k++]=(M+$)%256;break;case 2:for(V=Yt=0;Yt<ct;V=Yt+=1)M=s[d++],z=(V-V%a)/a,wt=ot&&Tt[(ot-1)*ct+z*a+V%a],Tt[k++]=(wt+M)%256;break;case 3:for(V=Kt=0;Kt<ct;V=Kt+=1)M=s[d++],z=(V-V%a)/a,$=V<a?0:Tt[k-a],wt=ot&&Tt[(ot-1)*ct+z*a+V%a],Tt[k++]=(M+Math.floor(($+wt)/2))%256;break;case 4:for(V=ee=0;ee<ct;V=ee+=1)M=s[d++],z=(V-V%a)/a,$=V<a?0:Tt[k-a],ot===0?wt=vt=0:(wt=Tt[(ot-1)*ct+z*a+V%a],vt=z&&Tt[(ot-1)*ct+(z-1)*a+V%a]),pt=$+wt-vt,gt=Math.abs(pt-$),dt=Math.abs(pt-wt),Ft=Math.abs(pt-vt),mt=gt<=dt&&gt<=Ft?$:dt<=Ft?wt:vt,Tt[k++]=(M+mt)%256;break;default:throw new Error("Invalid filter algorithm: "+s[d-1])}if(!it){var xt=((x+ot*P)*p.width+b)*a,It=ot*ct;for(V=0;V<Zt;V+=1){for(var Ut=0;Ut<a;Ut+=1)o[xt++]=Tt[It++];xt+=(C-1)*a}}ot++}}return s=mrt(s),p.interlaceMethod==1?(y(0,0,8,8),y(4,0,8,8),y(0,4,4,8),y(2,0,4,4),y(0,2,2,4),y(1,0,2,2),y(0,1,1,2)):y(0,0,1,1),o},n.prototype.decodePalette=function(){var s,a,o,d,p,y,b,x,C;for(o=this.palette,y=this.transparency.indexed||[],p=new Uint8Array((y.length||0)+o.length),d=0,s=0,a=b=0,x=o.length;b<x;a=b+=3)p[d++]=o[a],p[d++]=o[a+1],p[d++]=o[a+2],p[d++]=(C=y[s++])!=null?C:255;return p},n.prototype.copyToImageData=function(s,a){var o,d,p,y,b,x,C,P,M,k,z;if(d=this.colors,M=null,o=this.hasAlphaChannel,this.palette.length&&(M=(z=this._decodedPalette)!=null?z:this._decodedPalette=this.decodePalette(),d=4,o=!0),P=(p=s.data||s).length,b=M||a,y=x=0,d===1)for(;y<P;)C=M?4*a[y/4]:x,k=b[C++],p[y++]=k,p[y++]=k,p[y++]=k,p[y++]=o?b[C++]:255,x=C;else for(;y<P;)C=M?4*a[y/4]:x,p[y++]=b[C++],p[y++]=b[C++],p[y++]=b[C++],p[y++]=o?b[C++]:255,x=C},n.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var i=function(){if(Object.prototype.toString.call(Hr)==="[object Window]"){try{t=Hr.document.createElement("canvas"),e=t.getContext("2d")}catch{return!1}return!0}return!1};return i(),r=function(s){var a;if(i()===!0)return e.width=s.width,e.height=s.height,e.clearRect(0,0,s.width,s.height),e.putImageData(s,0,0),(a=new Image).src=t.toDataURL(),a;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(s){var a,o,d,p,y,b,x,C;if(this.animation){for(C=[],o=y=0,b=(x=this.animation.frames).length;y<b;o=++y)a=x[o],d=s.createImageData(a.width,a.height),p=this.decodePixels(new Uint8Array(a.data)),this.copyToImageData(d,p),a.imageData=d,C.push(a.image=r(d));return C}},n.prototype.renderFrame=function(s,a){var o,d,p;return o=(d=this.animation.frames)[a],p=d[a-1],a===0&&s.clearRect(0,0,this.width,this.height),(p!=null?p.disposeOp:void 0)===1?s.clearRect(p.xOffset,p.yOffset,p.width,p.height):(p!=null?p.disposeOp:void 0)===2&&s.putImageData(p.imageData,p.xOffset,p.yOffset),o.blendOp===0&&s.clearRect(o.xOffset,o.yOffset,o.width,o.height),s.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(s){var a,o,d,p,y,b,x=this;return o=0,b=this.animation,p=b.numFrames,d=b.frames,y=b.numPlays,(a=function(){var C,P;if(C=o++%p,P=d[C],x.renderFrame(s,C),p>1&&o/p<y)return x.animation._timeout=setTimeout(a,P.delay)})()},n.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},n.prototype.render=function(s){var a,o;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,a=s.getContext("2d"),this.animation?(this.decodeFrames(a),this.animate(a)):(o=a.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),a.putImageData(o,0,0))},n}();/**
* @license
*
* Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
*
* Permission is hereby granted, free of charge, to any person obtaining
* a copy of this software and associated documentation files (the
* "Software"), to deal in the Software without restriction, including
* without limitation the rights to use, copy, modify, merge, publish,
* distribute, sublicense, and/or sell copies of the Software, and to
* permit persons to whom the Software is furnished to do so, subject to
* the following conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
* LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
* OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
* WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
* ====================================================================
*//**
* @license
* (c) Dean McNamee <dean@gmail.com>, 2013.
*
* https://github.com/deanm/omggif
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to
* deal in the Software without restriction, including without limitation the
* rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
* sell copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in
* all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
* IN THE SOFTWARE.
*
* omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
* including animation and compression.  It does not rely on any specific
* underlying system, so should run in the browser, Node, or Plask.
*/function Nrt(r){var t=0;if(r[t++]!==71||r[t++]!==73||r[t++]!==70||r[t++]!==56||(r[t++]+1&253)!=56||r[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var e=r[t++]|r[t++]<<8,n=r[t++]|r[t++]<<8,i=r[t++],s=i>>7,a=1<<(7&i)+1;r[t++],r[t++];var o=null,d=null;s&&(o=t,d=a,t+=3*a);var p=!0,y=[],b=0,x=null,C=0,P=null;for(this.width=e,this.height=n;p&&t<r.length;)switch(r[t++]){case 33:switch(r[t++]){case 255:if(r[t]!==11||r[t+1]==78&&r[t+2]==69&&r[t+3]==84&&r[t+4]==83&&r[t+5]==67&&r[t+6]==65&&r[t+7]==80&&r[t+8]==69&&r[t+9]==50&&r[t+10]==46&&r[t+11]==48&&r[t+12]==3&&r[t+13]==1&&r[t+16]==0)t+=14,P=r[t++]|r[t++]<<8,t++;else for(t+=12;;){if(!((ot=r[t++])>=0))throw Error("Invalid block size");if(ot===0)break;t+=ot}break;case 249:if(r[t++]!==4||r[t+4]!==0)throw new Error("Invalid graphics extension block.");var M=r[t++];b=r[t++]|r[t++]<<8,x=r[t++],!(1&M)&&(x=null),C=M>>2&7,t++;break;case 254:for(;;){if(!((ot=r[t++])>=0))throw Error("Invalid block size");if(ot===0)break;t+=ot}break;default:throw new Error("Unknown graphic control label: 0x"+r[t-1].toString(16))}break;case 44:var k=r[t++]|r[t++]<<8,z=r[t++]|r[t++]<<8,V=r[t++]|r[t++]<<8,$=r[t++]|r[t++]<<8,tt=r[t++],pt=tt>>6&1,gt=1<<(7&tt)+1,mt=o,dt=d,Ft=!1;tt>>7&&(Ft=!0,mt=t,dt=gt,t+=3*gt);var Tt=t;for(t++;;){var ot;if(!((ot=r[t++])>=0))throw Error("Invalid block size");if(ot===0)break;t+=ot}y.push({x:k,y:z,width:V,height:$,has_local_palette:Ft,palette_offset:mt,palette_size:dt,data_offset:Tt,data_length:t-Tt,transparent_index:x,interlaced:!!pt,delay:b,disposal:C});break;case 59:p=!1;break;default:throw new Error("Unknown gif block: 0x"+r[t-1].toString(16))}this.numFrames=function(){return y.length},this.loopCount=function(){return P},this.frameInfo=function(ct){if(ct<0||ct>=y.length)throw new Error("Frame index out of range.");return y[ct]},this.decodeAndBlitFrameBGRA=function(ct,wt){var vt=this.frameInfo(ct),$t=vt.width*vt.height,Wt=new Uint8Array($t);bP(r,vt.data_offset,Wt,$t);var Yt=vt.palette_offset,Kt=vt.transparent_index;Kt===null&&(Kt=256);var ee=vt.width,Zt=e-ee,we=ee,it=4*(vt.y*e+vt.x),xt=4*((vt.y+vt.height)*e+vt.x),It=it,Ut=4*Zt;vt.interlaced===!0&&(Ut+=4*e*7);for(var jt=8,Vt=0,re=Wt.length;Vt<re;++Vt){var te=Wt[Vt];if(we===0&&(we=ee,(It+=Ut)>=xt&&(Ut=4*Zt+4*e*(jt-1),It=it+(ee+Zt)*(jt<<1),jt>>=1)),te===Kt)It+=4;else{var Ce=r[Yt+3*te],Te=r[Yt+3*te+1],De=r[Yt+3*te+2];wt[It++]=De,wt[It++]=Te,wt[It++]=Ce,wt[It++]=255}--we}},this.decodeAndBlitFrameRGBA=function(ct,wt){var vt=this.frameInfo(ct),$t=vt.width*vt.height,Wt=new Uint8Array($t);bP(r,vt.data_offset,Wt,$t);var Yt=vt.palette_offset,Kt=vt.transparent_index;Kt===null&&(Kt=256);var ee=vt.width,Zt=e-ee,we=ee,it=4*(vt.y*e+vt.x),xt=4*((vt.y+vt.height)*e+vt.x),It=it,Ut=4*Zt;vt.interlaced===!0&&(Ut+=4*e*7);for(var jt=8,Vt=0,re=Wt.length;Vt<re;++Vt){var te=Wt[Vt];if(we===0&&(we=ee,(It+=Ut)>=xt&&(Ut=4*Zt+4*e*(jt-1),It=it+(ee+Zt)*(jt<<1),jt>>=1)),te===Kt)It+=4;else{var Ce=r[Yt+3*te],Te=r[Yt+3*te+1],De=r[Yt+3*te+2];wt[It++]=Ce,wt[It++]=Te,wt[It++]=De,wt[It++]=255}--we}}}function bP(r,t,e,n){for(var i=r[t++],s=1<<i,a=s+1,o=a+1,d=i+1,p=(1<<d)-1,y=0,b=0,x=0,C=r[t++],P=new Int32Array(4096),M=null;;){for(;y<16&&C!==0;)b|=r[t++]<<y,y+=8,C===1?C=r[t++]:--C;if(y<d)break;var k=b&p;if(b>>=d,y-=d,k!==s){if(k===a)break;for(var z=k<o?k:M,V=0,$=z;$>s;)$=P[$]>>8,++V;var tt=$;if(x+V+(z!==k?1:0)>n)return void Ai.log("Warning, gif stream longer than expected.");e[x++]=tt;var pt=x+=V;for(z!==k&&(e[x++]=tt),$=z;V--;)$=P[$],e[--pt]=255&$,$>>=8;M!==null&&o<4096&&(P[o++]=M<<8|tt,o>=p+1&&d<12&&(++d,p=p<<1|1)),M=k}else o=a+1,p=(1<<(d=i+1))-1,M=null}return x!==n&&Ai.log("Warning, gif stream shorter than expected."),e}/**
	 * @license
	  Copyright (c) 2008, Adobe Systems Incorporated
	  All rights reserved.

	  Redistribution and use in source and binary forms, with or without 
	  modification, are permitted provided that the following conditions are
	  met:

	  * Redistributions of source code must retain the above copyright notice, 
	    this list of conditions and the following disclaimer.
	  
	  * Redistributions in binary form must reproduce the above copyright
	    notice, this list of conditions and the following disclaimer in the 
	    documentation and/or other materials provided with the distribution.
	  
	  * Neither the name of Adobe Systems Incorporated nor the names of its 
	    contributors may be used to endorse or promote products derived from 
	    this software without specific prior written permission.

	  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
	  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
	  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
	  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
	  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
	  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
	  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
	  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
	  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
	  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
	  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	*/function j2(r){var t,e,n,i,s,a=Math.floor,o=new Array(64),d=new Array(64),p=new Array(64),y=new Array(64),b=new Array(65535),x=new Array(65535),C=new Array(64),P=new Array(64),M=[],k=0,z=7,V=new Array(64),$=new Array(64),tt=new Array(64),pt=new Array(256),gt=new Array(2048),mt=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],dt=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Ft=[0,1,2,3,4,5,6,7,8,9,10,11],Tt=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],ot=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],ct=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],wt=[0,1,2,3,4,5,6,7,8,9,10,11],vt=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],$t=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Wt(it,xt){for(var It=0,Ut=0,jt=new Array,Vt=1;Vt<=16;Vt++){for(var re=1;re<=it[Vt];re++)jt[xt[Ut]]=[],jt[xt[Ut]][0]=It,jt[xt[Ut]][1]=Vt,Ut++,It++;It*=2}return jt}function Yt(it){for(var xt=it[0],It=it[1]-1;It>=0;)xt&1<<It&&(k|=1<<z),It--,--z<0&&(k==255?(Kt(255),Kt(0)):Kt(k),z=7,k=0)}function Kt(it){M.push(it)}function ee(it){Kt(it>>8&255),Kt(255&it)}function Zt(it,xt,It,Ut,jt){for(var Vt,re=jt[0],te=jt[240],Ce=function(de,ve){var Le,Ue,Ye,lr,yr,Lr,Dr,pe,cr,_r,Re=0;for(cr=0;cr<8;++cr){Le=de[Re],Ue=de[Re+1],Ye=de[Re+2],lr=de[Re+3],yr=de[Re+4],Lr=de[Re+5],Dr=de[Re+6];var An=Le+(pe=de[Re+7]),me=Le-pe,gr=Ue+Dr,Ne=Ue-Dr,Ur=Ye+Lr,_n=Ye-Lr,ke=lr+yr,Qn=lr-yr,nn=An+ke,vn=An-ke,ln=gr+Ur,Ct=gr-Ur;de[Re]=nn+ln,de[Re+4]=nn-ln;var W=.707106781*(Ct+vn);de[Re+2]=vn+W,de[Re+6]=vn-W;var X=.382683433*((nn=Qn+_n)-(Ct=Ne+me)),ft=.5411961*nn+X,Bt=1.306562965*Ct+X,kt=.707106781*(ln=_n+Ne),Gt=me+kt,Ot=me-kt;de[Re+5]=Ot+ft,de[Re+3]=Ot-ft,de[Re+1]=Gt+Bt,de[Re+7]=Gt-Bt,Re+=8}for(Re=0,cr=0;cr<8;++cr){Le=de[Re],Ue=de[Re+8],Ye=de[Re+16],lr=de[Re+24],yr=de[Re+32],Lr=de[Re+40],Dr=de[Re+48];var Pt=Le+(pe=de[Re+56]),ae=Le-pe,fe=Ue+Dr,Jt=Ue-Dr,xe=Ye+Lr,Ge=Ye-Lr,nr=lr+yr,Br=lr-yr,Tr=Pt+nr,pr=Pt-nr,Qr=fe+xe,Gr=fe-xe;de[Re]=Tr+Qr,de[Re+32]=Tr-Qr;var cn=.707106781*(Gr+pr);de[Re+16]=pr+cn,de[Re+48]=pr-cn;var br=.382683433*((Tr=Br+Ge)-(Gr=Jt+ae)),jr=.5411961*Tr+br,sn=1.306562965*Gr+br,Sn=.707106781*(Qr=Ge+Jt),Mt=ae+Sn,Oe=ae-Sn;de[Re+40]=Oe+jr,de[Re+24]=Oe-jr,de[Re+8]=Mt+sn,de[Re+56]=Mt-sn,Re++}for(cr=0;cr<64;++cr)_r=de[cr]*ve[cr],C[cr]=_r>0?_r+.5|0:_r-.5|0;return C}(it,xt),Te=0;Te<64;++Te)P[mt[Te]]=Ce[Te];var De=P[0]-It;It=P[0],De==0?Yt(Ut[0]):(Yt(Ut[x[Vt=32767+De]]),Yt(b[Vt]));for(var Qe=63;Qe>0&&P[Qe]==0;)Qe--;if(Qe==0)return Yt(re),It;for(var Je,he=1;he<=Qe;){for(var st=he;P[he]==0&&he<=Qe;)++he;var fr=he-st;if(fr>=16){Je=fr>>4;for(var er=1;er<=Je;++er)Yt(te);fr&=15}Vt=32767+P[he],Yt(jt[(fr<<4)+x[Vt]]),Yt(b[Vt]),he++}return Qe!=63&&Yt(re),It}function we(it){it=Math.min(Math.max(it,1),100),s!=it&&(function(xt){for(var It=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Ut=0;Ut<64;Ut++){var jt=a((It[Ut]*xt+50)/100);jt=Math.min(Math.max(jt,1),255),o[mt[Ut]]=jt}for(var Vt=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],re=0;re<64;re++){var te=a((Vt[re]*xt+50)/100);te=Math.min(Math.max(te,1),255),d[mt[re]]=te}for(var Ce=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Te=0,De=0;De<8;De++)for(var Qe=0;Qe<8;Qe++)p[Te]=1/(o[mt[Te]]*Ce[De]*Ce[Qe]*8),y[Te]=1/(d[mt[Te]]*Ce[De]*Ce[Qe]*8),Te++}(it<50?Math.floor(5e3/it):Math.floor(200-2*it)),s=it)}this.encode=function(it,xt){xt&&we(xt),M=new Array,k=0,z=7,ee(65496),ee(65504),ee(16),Kt(74),Kt(70),Kt(73),Kt(70),Kt(0),Kt(1),Kt(1),Kt(0),ee(1),ee(1),Kt(0),Kt(0),function(){ee(65499),ee(132),Kt(0);for(var Ue=0;Ue<64;Ue++)Kt(o[Ue]);Kt(1);for(var Ye=0;Ye<64;Ye++)Kt(d[Ye])}(),function(Ue,Ye){ee(65472),ee(17),Kt(8),ee(Ye),ee(Ue),Kt(3),Kt(1),Kt(17),Kt(0),Kt(2),Kt(17),Kt(1),Kt(3),Kt(17),Kt(1)}(it.width,it.height),function(){ee(65476),ee(418),Kt(0);for(var Ue=0;Ue<16;Ue++)Kt(dt[Ue+1]);for(var Ye=0;Ye<=11;Ye++)Kt(Ft[Ye]);Kt(16);for(var lr=0;lr<16;lr++)Kt(Tt[lr+1]);for(var yr=0;yr<=161;yr++)Kt(ot[yr]);Kt(1);for(var Lr=0;Lr<16;Lr++)Kt(ct[Lr+1]);for(var Dr=0;Dr<=11;Dr++)Kt(wt[Dr]);Kt(17);for(var pe=0;pe<16;pe++)Kt(vt[pe+1]);for(var cr=0;cr<=161;cr++)Kt($t[cr])}(),ee(65498),ee(12),Kt(3),Kt(1),Kt(0),Kt(2),Kt(17),Kt(3),Kt(17),Kt(0),Kt(63),Kt(0);var It=0,Ut=0,jt=0;k=0,z=7,this.encode.displayName="_encode_";for(var Vt,re,te,Ce,Te,De,Qe,Je,he,st=it.data,fr=it.width,er=it.height,de=4*fr,ve=0;ve<er;){for(Vt=0;Vt<de;){for(Te=de*ve+Vt,Qe=-1,Je=0,he=0;he<64;he++)De=Te+(Je=he>>3)*de+(Qe=4*(7&he)),ve+Je>=er&&(De-=de*(ve+1+Je-er)),Vt+Qe>=de&&(De-=Vt+Qe-de+4),re=st[De++],te=st[De++],Ce=st[De++],V[he]=(gt[re]+gt[te+256>>0]+gt[Ce+512>>0]>>16)-128,$[he]=(gt[re+768>>0]+gt[te+1024>>0]+gt[Ce+1280>>0]>>16)-128,tt[he]=(gt[re+1280>>0]+gt[te+1536>>0]+gt[Ce+1792>>0]>>16)-128;It=Zt(V,p,It,t,n),Ut=Zt($,y,Ut,e,i),jt=Zt(tt,y,jt,e,i),Vt+=32}ve+=8}if(z>=0){var Le=[];Le[1]=z+1,Le[0]=(1<<z+1)-1,Yt(Le)}return ee(65497),new Uint8Array(M)},r=r||50,function(){for(var it=String.fromCharCode,xt=0;xt<256;xt++)pt[xt]=it(xt)}(),t=Wt(dt,Ft),e=Wt(ct,wt),n=Wt(Tt,ot),i=Wt(vt,$t),function(){for(var it=1,xt=2,It=1;It<=15;It++){for(var Ut=it;Ut<xt;Ut++)x[32767+Ut]=It,b[32767+Ut]=[],b[32767+Ut][1]=It,b[32767+Ut][0]=Ut;for(var jt=-(xt-1);jt<=-it;jt++)x[32767+jt]=It,b[32767+jt]=[],b[32767+jt][1]=It,b[32767+jt][0]=xt-1+jt;it<<=1,xt<<=1}}(),function(){for(var it=0;it<256;it++)gt[it]=19595*it,gt[it+256>>0]=38470*it,gt[it+512>>0]=7471*it+32768,gt[it+768>>0]=-11059*it,gt[it+1024>>0]=-21709*it,gt[it+1280>>0]=32768*it+8421375,gt[it+1536>>0]=-27439*it,gt[it+1792>>0]=-5329*it}(),we(r)}/**
* @license
* Copyright (c) 2017 Aras Abbasi
*
* Licensed under the MIT License.
* http://opensource.org/licenses/mit-license
*/function sc(r,t){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function wP(r){function t(dt){if(!dt)throw Error("assert :P")}function e(dt,Ft,Tt){for(var ot=0;4>ot;ot++)if(dt[Ft+ot]!=Tt.charCodeAt(ot))return!0;return!1}function n(dt,Ft,Tt,ot,ct){for(var wt=0;wt<ct;wt++)dt[Ft+wt]=Tt[ot+wt]}function i(dt,Ft,Tt,ot){for(var ct=0;ct<ot;ct++)dt[Ft+ct]=Tt}function s(dt){return new Int32Array(dt)}function a(dt,Ft){for(var Tt=[],ot=0;ot<dt;ot++)Tt.push(new Ft);return Tt}function o(dt,Ft){var Tt=[];return function ot(ct,wt,vt){for(var $t=vt[wt],Wt=0;Wt<$t&&(ct.push(vt.length>wt+1?[]:new Ft),!(vt.length<wt+1));Wt++)ot(ct[Wt],wt+1,vt)}(Tt,0,dt),Tt}var d=function(){var dt=this;function Ft(A,g){for(var w=1<<g-1>>>0;A&w;)w>>>=1;return w?(A&w-1)+w:A}function Tt(A,g,w,B,I){t(!(B%w));do A[g+(B-=w)]=I;while(0<B)}function ot(A,g,w,B,I){if(t(2328>=I),512>=I)var L=s(512);else if((L=s(I))==null)return 0;return function(R,O,N,H,K,et){var Y,Z,yt=O,at=1<<N,lt=s(16),At=s(16);for(t(K!=0),t(H!=null),t(R!=null),t(0<N),Z=0;Z<K;++Z){if(15<H[Z])return 0;++lt[H[Z]]}if(lt[0]==K)return 0;for(At[1]=0,Y=1;15>Y;++Y){if(lt[Y]>1<<Y)return 0;At[Y+1]=At[Y]+lt[Y]}for(Z=0;Z<K;++Z)Y=H[Z],0<H[Z]&&(et[At[Y]++]=Z);if(At[15]==1)return(H=new ct).g=0,H.value=et[0],Tt(R,yt,1,at,H),at;var Et,Dt=-1,zt=at-1,ue=0,oe=1,ce=1,ie=1<<N;for(Z=0,Y=1,K=2;Y<=N;++Y,K<<=1){if(oe+=ce<<=1,0>(ce-=lt[Y]))return 0;for(;0<lt[Y];--lt[Y])(H=new ct).g=Y,H.value=et[Z++],Tt(R,yt+ue,K,ie,H),ue=Ft(ue,Y)}for(Y=N+1,K=2;15>=Y;++Y,K<<=1){if(oe+=ce<<=1,0>(ce-=lt[Y]))return 0;for(;0<lt[Y];--lt[Y]){if(H=new ct,(ue&zt)!=Dt){for(yt+=ie,Et=1<<(Dt=Y)-N;15>Dt&&!(0>=(Et-=lt[Dt]));)++Dt,Et<<=1;at+=ie=1<<(Et=Dt-N),R[O+(Dt=ue&zt)].g=Et+N,R[O+Dt].value=yt-O-Dt}H.g=Y-N,H.value=et[Z++],Tt(R,yt+(ue>>N),K,ie,H),ue=Ft(ue,Y)}}return oe!=2*At[15]-1?0:at}(A,g,w,B,I,L)}function ct(){this.value=this.g=0}function wt(){this.value=this.g=0}function vt(){this.G=a(5,ct),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(Wn,wt)}function $t(A,g,w,B){t(A!=null),t(g!=null),t(2147483648>B),A.Ca=254,A.I=0,A.b=-8,A.Ka=0,A.oa=g,A.pa=w,A.Jd=g,A.Yc=w+B,A.Zc=4<=B?w+B-4+1:w,Vt(A)}function Wt(A,g){for(var w=0;0<g--;)w|=te(A,128)<<g;return w}function Yt(A,g){var w=Wt(A,g);return re(A)?-w:w}function Kt(A,g,w,B){var I,L=0;for(t(A!=null),t(g!=null),t(4294967288>B),A.Sb=B,A.Ra=0,A.u=0,A.h=0,4<B&&(B=4),I=0;I<B;++I)L+=g[w+I]<<8*I;A.Ra=L,A.bb=B,A.oa=g,A.pa=w}function ee(A){for(;8<=A.u&&A.bb<A.Sb;)A.Ra>>>=8,A.Ra+=A.oa[A.pa+A.bb]<<Sl-8>>>0,++A.bb,A.u-=8;It(A)&&(A.h=1,A.u=0)}function Zt(A,g){if(t(0<=g),!A.h&&g<=Ga){var w=xt(A)&El[g];return A.u+=g,ee(A),w}return A.h=1,A.u=0}function we(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function it(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function xt(A){return A.Ra>>>(A.u&Sl-1)>>>0}function It(A){return t(A.bb<=A.Sb),A.h||A.bb==A.Sb&&A.u>Sl}function Ut(A,g){A.u=g,A.h=It(A)}function jt(A){A.u>=jo&&(t(A.u>=jo),ee(A))}function Vt(A){t(A!=null&&A.oa!=null),A.pa<A.Zc?(A.I=(A.oa[A.pa++]|A.I<<8)>>>0,A.b+=8):(t(A!=null&&A.oa!=null),A.pa<A.Yc?(A.b+=8,A.I=A.oa[A.pa++]|A.I<<8):A.Ka?A.b=0:(A.I<<=8,A.b+=8,A.Ka=1))}function re(A){return Wt(A,1)}function te(A,g){var w=A.Ca;0>A.b&&Vt(A);var B=A.b,I=w*g>>>8,L=(A.I>>>B>I)+0;for(L?(w-=I,A.I-=I+1<<B>>>0):w=I+1,B=w,I=0;256<=B;)I+=8,B>>=8;return B=7^I+es[B],A.b-=B,A.Ca=(w<<B)-1,L}function Ce(A,g,w){A[g+0]=w>>24&255,A[g+1]=w>>16&255,A[g+2]=w>>8&255,A[g+3]=w>>0&255}function Te(A,g){return A[g+0]<<0|A[g+1]<<8}function De(A,g){return Te(A,g)|A[g+2]<<16}function Qe(A,g){return Te(A,g)|Te(A,g+2)<<16}function Je(A,g){var w=1<<g;return t(A!=null),t(0<g),A.X=s(w),A.X==null?0:(A.Mb=32-g,A.Xa=g,1)}function he(A,g){t(A!=null),t(g!=null),t(A.Xa==g.Xa),n(g.X,0,A.X,0,1<<g.Xa)}function st(){this.X=[],this.Xa=this.Mb=0}function fr(A,g,w,B){t(w!=null),t(B!=null);var I=w[0],L=B[0];return I==0&&(I=(A*L+g/2)/g),L==0&&(L=(g*I+A/2)/A),0>=I||0>=L?0:(w[0]=I,B[0]=L,1)}function er(A,g){return A+(1<<g)-1>>>g}function de(A,g){return((4278255360&A)+(4278255360&g)>>>0&4278255360)+((16711935&A)+(16711935&g)>>>0&16711935)>>>0}function ve(A,g){dt[g]=function(w,B,I,L,R,O,N){var H;for(H=0;H<R;++H){var K=dt[A](O[N+H-1],I,L+H);O[N+H]=de(w[B+H],K)}}}function Le(){this.ud=this.hd=this.jd=0}function Ue(A,g){return((4278124286&(A^g))>>>1)+(A&g)>>>0}function Ye(A){return 0<=A&&256>A?A:0>A?0:255<A?255:void 0}function lr(A,g){return Ye(A+(A-g+.5>>1))}function yr(A,g,w){return Math.abs(g-w)-Math.abs(A-w)}function Lr(A,g,w,B,I,L,R){for(B=L[R-1],w=0;w<I;++w)L[R+w]=B=de(A[g+w],B)}function Dr(A,g,w,B,I){var L;for(L=0;L<w;++L){var R=A[g+L],O=R>>8&255,N=16711935&(N=(N=16711935&R)+((O<<16)+O));B[I+L]=(4278255360&R)+N>>>0}}function pe(A,g){g.jd=A>>0&255,g.hd=A>>8&255,g.ud=A>>16&255}function cr(A,g,w,B,I,L){var R;for(R=0;R<B;++R){var O=g[w+R],N=O>>>8,H=O,K=255&(K=(K=O>>>16)+((A.jd<<24>>24)*(N<<24>>24)>>>5));H=255&(H=(H=H+((A.hd<<24>>24)*(N<<24>>24)>>>5))+((A.ud<<24>>24)*(K<<24>>24)>>>5)),I[L+R]=(4278255360&O)+(K<<16)+H}}function _r(A,g,w,B,I){dt[g]=function(L,R,O,N,H,K,et,Y,Z){for(N=et;N<Y;++N)for(et=0;et<Z;++et)H[K++]=I(O[B(L[R++])])},dt[A]=function(L,R,O,N,H,K,et){var Y=8>>L.b,Z=L.Ea,yt=L.K[0],at=L.w;if(8>Y)for(L=(1<<L.b)-1,at=(1<<Y)-1;R<O;++R){var lt,At=0;for(lt=0;lt<Z;++lt)lt&L||(At=B(N[H++])),K[et++]=I(yt[At&at]),At>>=Y}else dt["VP8LMapColor"+w](N,H,yt,at,K,et,R,O,Z)}}function Re(A,g,w,B,I){for(w=g+w;g<w;){var L=A[g++];B[I++]=L>>16&255,B[I++]=L>>8&255,B[I++]=L>>0&255}}function An(A,g,w,B,I){for(w=g+w;g<w;){var L=A[g++];B[I++]=L>>16&255,B[I++]=L>>8&255,B[I++]=L>>0&255,B[I++]=L>>24&255}}function me(A,g,w,B,I){for(w=g+w;g<w;){var L=(R=A[g++])>>16&240|R>>12&15,R=R>>0&240|R>>28&15;B[I++]=L,B[I++]=R}}function gr(A,g,w,B,I){for(w=g+w;g<w;){var L=(R=A[g++])>>16&248|R>>13&7,R=R>>5&224|R>>3&31;B[I++]=L,B[I++]=R}}function Ne(A,g,w,B,I){for(w=g+w;g<w;){var L=A[g++];B[I++]=L>>0&255,B[I++]=L>>8&255,B[I++]=L>>16&255}}function Ur(A,g,w,B,I,L){if(L==0)for(w=g+w;g<w;)Ce(B,((L=A[g++])[0]>>24|L[1]>>8&65280|L[2]<<8&16711680|L[3]<<24)>>>0),I+=32;else n(B,I,A,g,w)}function _n(A,g){dt[g][0]=dt[A+"0"],dt[g][1]=dt[A+"1"],dt[g][2]=dt[A+"2"],dt[g][3]=dt[A+"3"],dt[g][4]=dt[A+"4"],dt[g][5]=dt[A+"5"],dt[g][6]=dt[A+"6"],dt[g][7]=dt[A+"7"],dt[g][8]=dt[A+"8"],dt[g][9]=dt[A+"9"],dt[g][10]=dt[A+"10"],dt[g][11]=dt[A+"11"],dt[g][12]=dt[A+"12"],dt[g][13]=dt[A+"13"],dt[g][14]=dt[A+"0"],dt[g][15]=dt[A+"0"]}function ke(A){return A==Xo||A==AA||A==hA||A==dA}function Qn(){this.eb=[],this.size=this.A=this.fb=0}function nn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function vn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Qn,this.f.kb=new nn,this.sd=null}function ln(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ct(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function W(A){return alert("todo:WebPSamplerProcessPlane"),A.T}function X(A,g){var w=A.T,B=g.ba.f.RGBA,I=B.eb,L=B.fb+A.ka*B.A,R=ro[g.ba.S],O=A.y,N=A.O,H=A.f,K=A.N,et=A.ea,Y=A.W,Z=g.cc,yt=g.dc,at=g.Mc,lt=g.Nc,At=A.ka,Et=A.ka+A.T,Dt=A.U,zt=Dt+1>>1;for(At==0?R(O,N,null,null,H,K,et,Y,H,K,et,Y,I,L,null,null,Dt):(R(g.ec,g.fc,O,N,Z,yt,at,lt,H,K,et,Y,I,L-B.A,I,L,Dt),++w);At+2<Et;At+=2)Z=H,yt=K,at=et,lt=Y,K+=A.Rc,Y+=A.Rc,L+=2*B.A,R(O,(N+=2*A.fa)-A.fa,O,N,Z,yt,at,lt,H,K,et,Y,I,L-B.A,I,L,Dt);return N+=A.fa,A.j+Et<A.o?(n(g.ec,g.fc,O,N,Dt),n(g.cc,g.dc,H,K,zt),n(g.Mc,g.Nc,et,Y,zt),w--):1&Et||R(O,N,null,null,H,K,et,Y,H,K,et,Y,I,L+B.A,null,null,Dt),w}function ft(A,g,w){var B=A.F,I=[A.J];if(B!=null){var L=A.U,R=g.ba.S,O=R==gu||R==hA;g=g.ba.f.RGBA;var N=[0],H=A.ka;N[0]=A.T,A.Kb&&(H==0?--N[0]:(--H,I[0]-=A.width),A.j+A.ka+A.T==A.o&&(N[0]=A.o-A.j-H));var K=g.eb;H=g.fb+H*g.A,A=Xa(B,I[0],A.width,L,N,K,H+(O?0:3),g.A),t(w==N),A&&ke(R)&&Zs(K,H,O,L,N,g.A)}return 0}function Bt(A){var g=A.ma,w=g.ba.S,B=11>w,I=w==Ol||w==pu||w==gu||w==uA||w==12||ke(w);if(g.memory=null,g.Ib=null,g.Jb=null,g.Nd=null,!Bc(g.Oa,A,I?11:12))return 0;if(I&&ke(w)&&Fe(),A.da)alert("todo:use_scaling");else{if(B){if(g.Ib=W,A.Kb){if(w=A.U+1>>1,g.memory=s(A.U+2*w),g.memory==null)return 0;g.ec=g.memory,g.fc=0,g.cc=g.ec,g.dc=g.fc+A.U,g.Mc=g.cc,g.Nc=g.dc+w,g.Ib=X,Fe()}}else alert("todo:EmitYUV");I&&(g.Jb=ft,B&&ne())}if(B&&!Sc){for(A=0;256>A;++A)Cp[A]=89858*(A-128)+_u>>gA,ya[A]=-22014*(A-128)+_u,yA[A]=-45773*(A-128),Od[A]=113618*(A-128)+_u>>gA;for(A=Co;A<Un;++A)g=76283*(A-16)+_u>>gA,vh[A-Co]=hs(g,255),ur[A-Co]=hs(g+8>>4,15);Sc=1}return 1}function kt(A){var g=A.ma,w=A.U,B=A.T;return t(!(1&A.ka)),0>=w||0>=B?0:(w=g.Ib(A,g),g.Jb!=null&&g.Jb(A,g,w),g.Dc+=w,1)}function Gt(A){A.ma.memory=null}function Ot(A,g,w,B){return Zt(A,8)!=47?0:(g[0]=Zt(A,14)+1,w[0]=Zt(A,14)+1,B[0]=Zt(A,1),Zt(A,3)!=0?0:!A.h)}function Pt(A,g){if(4>A)return A+1;var w=A-2>>1;return(2+(1&A)<<w)+Zt(g,w)+1}function ae(A,g){return 120<g?g-120:1<=(w=((w=bp[g-1])>>4)*A+(8-(15&w)))?w:1;var w}function fe(A,g,w){var B=xt(w),I=A[g+=255&B].g-8;return 0<I&&(Ut(w,w.u+8),B=xt(w),g+=A[g].value,g+=B&(1<<I)-1),Ut(w,w.u+A[g].g),A[g].value}function Jt(A,g,w){return w.g+=A.g,w.value+=A.value<<g>>>0,t(8>=w.g),A.g}function xe(A,g,w){var B=A.xc;return t((g=B==0?0:A.vc[A.md*(w>>B)+(g>>B)])<A.Wb),A.Ya[g]}function Ge(A,g,w,B){var I=A.ab,L=A.c*g,R=A.C;g=R+g;var O=w,N=B;for(B=A.Ta,w=A.Ua;0<I--;){var H=A.gc[I],K=R,et=g,Y=O,Z=N,yt=(N=B,O=w,H.Ea);switch(t(K<et),t(et<=H.nc),H.hc){case 2:Cc(Y,Z,(et-K)*yt,N,O);break;case 0:var at=K,lt=et,At=N,Et=O,Dt=(ie=H).Ea;at==0&&(hu(Y,Z,null,null,1,At,Et),Lr(Y,Z+1,0,0,Dt-1,At,Et+1),Z+=Dt,Et+=Dt,++at);for(var zt=1<<ie.b,ue=zt-1,oe=er(Dt,ie.b),ce=ie.K,ie=ie.w+(at>>ie.b)*oe;at<lt;){var Pe=ce,We=ie,_e=1;for(ja(Y,Z,At,Et-Dt,1,At,Et);_e<Dt;){var be=(_e&~ue)+zt;be>Dt&&(be=Dt),(0,Ys[Pe[We++]>>8&15])(Y,Z+ +_e,At,Et+_e-Dt,be-_e,At,Et+_e),_e=be}Z+=Dt,Et+=Dt,++at&ue||(ie+=oe)}et!=H.nc&&n(N,O-yt,N,O+(et-K-1)*yt,yt);break;case 1:for(yt=Y,lt=Z,Dt=(Y=H.Ea)-(Et=Y&~(At=(Z=1<<H.b)-1)),at=er(Y,H.b),zt=H.K,H=H.w+(K>>H.b)*at;K<et;){for(ue=zt,oe=H,ce=new Le,ie=lt+Et,Pe=lt+Y;lt<ie;)pe(ue[oe++],ce),$r(ce,yt,lt,Z,N,O),lt+=Z,O+=Z;lt<Pe&&(pe(ue[oe++],ce),$r(ce,yt,lt,Dt,N,O),lt+=Dt,O+=Dt),++K&At||(H+=at)}break;case 3:if(Y==N&&Z==O&&0<H.b){for(lt=N,Y=yt=O+(et-K)*yt-(Et=(et-K)*er(H.Ea,H.b)),Z=N,At=O,at=[],Et=(Dt=Et)-1;0<=Et;--Et)at[Et]=Z[At+Et];for(Et=Dt-1;0<=Et;--Et)lt[Y+Et]=at[Et];bo(H,K,et,N,yt,N,O)}else bo(H,K,et,Y,Z,N,O)}O=B,N=w}N!=w&&n(B,w,O,N,L)}function nr(A,g){var w=A.V,B=A.Ba+A.c*A.C,I=g-A.C;if(t(g<=A.l.o),t(16>=I),0<I){var L=A.l,R=A.Ta,O=A.Ua,N=L.width;if(Ge(A,I,w,B),I=O=[O],t((w=A.C)<(B=g)),t(L.v<L.va),B>L.o&&(B=L.o),w<L.j){var H=L.j-w;w=L.j,I[0]+=H*N}if(w>=B?w=0:(I[0]+=4*L.v,L.ka=w-L.j,L.U=L.va-L.v,L.T=B-w,w=1),w){if(O=O[0],11>(w=A.ca).S){var K=w.f.RGBA,et=(B=w.S,I=L.U,L=L.T,H=K.eb,K.A),Y=L;for(K=K.fb+A.Ma*K.A;0<Y--;){var Z=R,yt=O,at=I,lt=H,At=K;switch(B){case Rl:xs(Z,yt,at,lt,At);break;case Ol:Ka(Z,yt,at,lt,At);break;case Xo:Ka(Z,yt,at,lt,At),Zs(lt,At,0,at,1,0);break;case fu:$a(Z,yt,at,lt,At);break;case pu:Ur(Z,yt,at,lt,At,1);break;case AA:Ur(Z,yt,at,lt,At,1),Zs(lt,At,0,at,1,0);break;case gu:Ur(Z,yt,at,lt,At,0);break;case hA:Ur(Z,yt,at,lt,At,0),Zs(lt,At,1,at,1,0);break;case uA:qo(Z,yt,at,lt,At);break;case dA:qo(Z,yt,at,lt,At),Pl(lt,At,at,1,0);break;case mh:Bs(Z,yt,at,lt,At);break;default:t(0)}O+=N,K+=et}A.Ma+=L}else alert("todo:EmitRescaledRowsYUVA");t(A.Ma<=w.height)}}A.C=g,t(A.C<=A.i)}function Br(A){var g;if(0<A.ua)return 0;for(g=0;g<A.Wb;++g){var w=A.Ya[g].G,B=A.Ya[g].H;if(0<w[1][B[1]+0].g||0<w[2][B[2]+0].g||0<w[3][B[3]+0].g)return 0}return 1}function Tr(A,g,w,B,I,L){if(A.Z!=0){var R=A.qd,O=A.rd;for(t(ns[A.Z]!=null);g<w;++g)ns[A.Z](R,O,B,I,B,I,L),R=B,O=I,I+=L;A.qd=R,A.rd=O}}function pr(A,g){var w=A.l.ma,B=w.Z==0||w.Z==1?A.l.j:A.C;if(B=A.C<B?B:A.C,t(g<=A.l.o),g>B){var I=A.l.width,L=w.ca,R=w.tb+I*B,O=A.V,N=A.Ba+A.c*B,H=A.gc;t(A.ab==1),t(H[0].hc==3),qa(H[0],B,g,O,N,L,R),Tr(w,B,g,L,R,I)}A.C=A.Ma=g}function Qr(A,g,w,B,I,L,R){var O=A.$/B,N=A.$%B,H=A.m,K=A.s,et=w+A.$,Y=et;I=w+B*I;var Z=w+B*L,yt=280+K.ua,at=A.Pb?O:16777216,lt=0<K.ua?K.Wa:null,At=K.wc,Et=et<Z?xe(K,N,O):null;t(A.C<L),t(Z<=I);var Dt=!1;t:for(;;){for(;Dt||et<Z;){var zt=0;if(O>=at){var ue=et-w;t((at=A).Pb),at.wd=at.m,at.xd=ue,0<at.s.ua&&he(at.s.Wa,at.s.vb),at=O+Jo}if(N&At||(Et=xe(K,N,O)),t(Et!=null),Et.Qb&&(g[et]=Et.qb,Dt=!0),!Dt)if(jt(H),Et.jc){zt=H,ue=g;var oe=et,ce=Et.pd[xt(zt)&Wn-1];t(Et.jc),256>ce.g?(Ut(zt,zt.u+ce.g),ue[oe]=ce.value,zt=0):(Ut(zt,zt.u+ce.g-256),t(256<=ce.value),zt=ce.value),zt==0&&(Dt=!0)}else zt=fe(Et.G[0],Et.H[0],H);if(H.h)break;if(Dt||256>zt){if(!Dt)if(Et.nd)g[et]=(Et.qb|zt<<8)>>>0;else{if(jt(H),Dt=fe(Et.G[1],Et.H[1],H),jt(H),ue=fe(Et.G[2],Et.H[2],H),oe=fe(Et.G[3],Et.H[3],H),H.h)break;g[et]=(oe<<24|Dt<<16|zt<<8|ue)>>>0}if(Dt=!1,++et,++N>=B&&(N=0,++O,R!=null&&O<=L&&!(O%16)&&R(A,O),lt!=null))for(;Y<et;)zt=g[Y++],lt.X[(506832829*zt&4294967295)>>>lt.Mb]=zt}else if(280>zt){if(zt=Pt(zt-256,H),ue=fe(Et.G[4],Et.H[4],H),jt(H),ue=ae(B,ue=Pt(ue,H)),H.h)break;if(et-w<ue||I-et<zt)break t;for(oe=0;oe<zt;++oe)g[et+oe]=g[et+oe-ue];for(et+=zt,N+=zt;N>=B;)N-=B,++O,R!=null&&O<=L&&!(O%16)&&R(A,O);if(t(et<=I),N&At&&(Et=xe(K,N,O)),lt!=null)for(;Y<et;)zt=g[Y++],lt.X[(506832829*zt&4294967295)>>>lt.Mb]=zt}else{if(!(zt<yt))break t;for(Dt=zt-280,t(lt!=null);Y<et;)zt=g[Y++],lt.X[(506832829*zt&4294967295)>>>lt.Mb]=zt;zt=et,t(!(Dt>>>(ue=lt).Xa)),g[zt]=ue.X[Dt],Dt=!0}Dt||t(H.h==It(H))}if(A.Pb&&H.h&&et<I)t(A.m.h),A.a=5,A.m=A.wd,A.$=A.xd,0<A.s.ua&&he(A.s.vb,A.s.Wa);else{if(H.h)break t;R!=null&&R(A,O>L?L:O),A.a=0,A.$=et-w}return 1}return A.a=3,0}function Gr(A){t(A!=null),A.vc=null,A.yc=null,A.Ya=null;var g=A.Wa;g!=null&&(g.X=null),A.vb=null,t(A!=null)}function cn(){var A=new fh;return A==null?null:(A.a=0,A.xb=yu,_n("Predictor","VP8LPredictors"),_n("Predictor","VP8LPredictors_C"),_n("PredictorAdd","VP8LPredictorsAdd"),_n("PredictorAdd","VP8LPredictorsAdd_C"),Cc=Dr,$r=cr,xs=Re,Ka=An,qo=me,Bs=gr,$a=Ne,dt.VP8LMapColor32b=ga,dt.VP8LMapColor8b=cA,A)}function br(A,g,w,B,I){var L=1,R=[A],O=[g],N=B.m,H=B.s,K=null,et=0;t:for(;;){if(w)for(;L&&Zt(N,1);){var Y=R,Z=O,yt=B,at=1,lt=yt.m,At=yt.gc[yt.ab],Et=Zt(lt,2);if(yt.Oc&1<<Et)L=0;else{switch(yt.Oc|=1<<Et,At.hc=Et,At.Ea=Y[0],At.nc=Z[0],At.K=[null],++yt.ab,t(4>=yt.ab),Et){case 0:case 1:At.b=Zt(lt,3)+2,at=br(er(At.Ea,At.b),er(At.nc,At.b),0,yt,At.K),At.K=At.K[0];break;case 3:var Dt,zt=Zt(lt,8)+1,ue=16<zt?0:4<zt?1:2<zt?2:3;if(Y[0]=er(At.Ea,ue),At.b=ue,Dt=at=br(zt,1,0,yt,At.K)){var oe,ce=zt,ie=At,Pe=1<<(8>>ie.b),We=s(Pe);if(We==null)Dt=0;else{var _e=ie.K[0],be=ie.w;for(We[0]=ie.K[0][0],oe=1;oe<1*ce;++oe)We[oe]=de(_e[be+oe],We[oe-1]);for(;oe<4*Pe;++oe)We[oe]=0;ie.K[0]=null,ie.K[0]=We,Dt=1}}at=Dt;break;case 2:break;default:t(0)}L=at}}if(R=R[0],O=O[0],L&&Zt(N,1)&&!(L=1<=(et=Zt(N,4))&&11>=et)){B.a=3;break t}var Xe;if(Xe=L)e:{var Rr,He,Sr,an=B,pn=R,oi=O,Mr=et,Xn=w,Vn=an.m,bn=an.s,xn=[null],ei=1,Gi=0,no=xo[Mr];r:for(;;){if(Xn&&Zt(Vn,1)){var pi=Zt(Vn,3)+2,Is=er(pn,pi),_a=er(oi,pi),Nl=Is*_a;if(!br(Is,_a,0,an,xn))break r;for(xn=xn[0],bn.xc=pi,Rr=0;Rr<Nl;++Rr){var ai=xn[Rr]>>8&65535;xn[Rr]=ai,ai>=ei&&(ei=ai+1)}}if(Vn.h)break r;for(He=0;5>He;++He){var Bn=yh[He];!He&&0<Mr&&(Bn+=1<<Mr),Gi<Bn&&(Gi=Bn)}var va=a(ei*no,ct),Tc=ei,is=a(Tc,vt);if(is==null)var Ui=null;else t(65536>=Tc),Ui=is;var wi=s(Gi);if(Ui==null||wi==null||va==null){an.a=1;break r}var Gn=va;for(Rr=Sr=0;Rr<ei;++Rr){var ds=Ui[Rr],kl=ds.G,li=ds.H,Dd=0,Ic=1,_A=0;for(He=0;5>He;++He){Bn=yh[He],kl[He]=Gn,li[He]=Sr,!He&&0<Mr&&(Bn+=1<<Mr);i:{var Zo,bh=Bn,bu=an,Fc=wi,Nd=Gn,wh=Sr,Ql=0,Lc=bu.m,Vm=Zt(Lc,1);if(i(Fc,0,0,bh),Vm){var Ep=Zt(Lc,1)+1,vA=Zt(Lc,1),kd=Zt(Lc,vA==0?1:8);Fc[kd]=1,Ep==2&&(Fc[kd=Zt(Lc,8)]=1);var Qd=1}else{var Gm=s(19),q_=Zt(Lc,4)+4;if(19<q_){bu.a=3;var xh=0;break i}for(Zo=0;Zo<q_;++Zo)Gm[fA[Zo]]=Zt(Lc,3);var bA=void 0,zl=void 0,Hl=bu,Ja=Gm,Ya=bh,jm=Fc,Pc=0,wu=Hl.m,qm=8,Ci=a(128,ct);n:for(;ot(Ci,0,7,Ja,19);){if(Zt(wu,1)){var Km=2+2*Zt(wu,3);if((bA=2+Zt(wu,Km))>Ya)break n}else bA=Ya;for(zl=0;zl<Ya&&bA--;){jt(wu);var $m=Ci[0+(127&xt(wu))];Ut(wu,wu.u+$m.g);var ba=$m.value;if(16>ba)jm[zl++]=ba,ba!=0&&(qm=ba);else{var wA=ba==16,zd=ba-16,Wm=Id[zd],Xm=Zt(wu,vp[zd])+Wm;if(zl+Xm>Ya)break n;for(var NE=wA?qm:0;0<Xm--;)jm[zl++]=NE}}Pc=1;break n}Pc||(Hl.a=3),Qd=Pc}(Qd=Qd&&!Lc.h)&&(Ql=ot(Nd,wh,8,Fc,bh)),Qd&&Ql!=0?xh=Ql:(bu.a=3,xh=0)}if(xh==0)break r;if(Ic&&Fd[He]==1&&(Ic=Gn[Sr].g==0),Dd+=Gn[Sr].g,Sr+=xh,3>=He){var Bh,Jm=wi[0];for(Bh=1;Bh<Bn;++Bh)wi[Bh]>Jm&&(Jm=wi[Bh]);_A+=Jm}}if(ds.nd=Ic,ds.Qb=0,Ic&&(ds.qb=(kl[3][li[3]+0].value<<24|kl[1][li[1]+0].value<<16|kl[2][li[2]+0].value)>>>0,Dd==0&&256>kl[0][li[0]+0].value&&(ds.Qb=1,ds.qb+=kl[0][li[0]+0].value<<8)),ds.jc=!ds.Qb&&6>_A,ds.jc){var Ch,Mc=ds;for(Ch=0;Ch<Wn;++Ch){var Vl=Ch,Uc=Mc.pd[Vl],Hd=Mc.G[0][Mc.H[0]+Vl];256<=Hd.value?(Uc.g=Hd.g+256,Uc.value=Hd.value):(Uc.g=0,Uc.value=0,Vl>>=Jt(Hd,8,Uc),Vl>>=Jt(Mc.G[1][Mc.H[1]+Vl],16,Uc),Vl>>=Jt(Mc.G[2][Mc.H[2]+Vl],0,Uc),Jt(Mc.G[3][Mc.H[3]+Vl],24,Uc))}}}bn.vc=xn,bn.Wb=ei,bn.Ya=Ui,bn.yc=va,Xe=1;break e}Xe=0}if(!(L=Xe)){B.a=3;break t}if(0<et){if(H.ua=1<<et,!Je(H.Wa,et)){B.a=1,L=0;break t}}else H.ua=0;var xu=B,K_=R,Vd=O,Eh=xu.s,Sh=Eh.xc;if(xu.c=K_,xu.i=Vd,Eh.md=er(K_,Sh),Eh.wc=Sh==0?-1:(1<<Sh)-1,w){B.xb=xp;break t}if((K=s(R*O))==null){B.a=1,L=0;break t}L=(L=Qr(B,K,0,R,O,O,null))&&!N.h;break t}return L?(I!=null?I[0]=K:(t(K==null),t(w)),B.$=0,w||Gr(H)):Gr(H),L}function jr(A,g){var w=A.c*A.i,B=w+g+16*g;return t(A.c<=g),A.V=s(B),A.V==null?(A.Ta=null,A.Ua=0,A.a=1,0):(A.Ta=A.V,A.Ua=A.Ba+w+g,1)}function sn(A,g){var w=A.C,B=g-w,I=A.V,L=A.Ba+A.c*w;for(t(g<=A.l.o);0<B;){var R=16<B?16:B,O=A.l.ma,N=A.l.width,H=N*R,K=O.ca,et=O.tb+N*w,Y=A.Ta,Z=A.Ua;Ge(A,R,I,L),ph(Y,Z,K,et,H),Tr(O,w,w+R,K,et,N),B-=R,I+=R*A.c,w+=R}t(w==g),A.C=A.Ma=g}function Sn(){this.ub=this.yd=this.td=this.Rb=0}function Mt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Oe(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Ee(){this.Yb=function(){var A=[];return function g(w,B,I){for(var L=I[B],R=0;R<L&&(w.push(I.length>B+1?[]:0),!(I.length<B+1));R++)g(w[R],B+1,I)}(A,0,[3,11]),A}()}function or(){this.jb=s(3),this.Wc=o([4,8],Ee),this.Xc=o([4,17],Ee)}function Pr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Mn(){this.ld=this.La=this.dd=this.tc=0}function qr(){this.Na=this.la=0}function gn(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function vi(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function mn(){this.uc=this.M=this.Nb=0,this.wa=Array(new Mn),this.Y=0,this.ya=Array(new vi),this.aa=0,this.l=new Xs}function Wr(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Da(){this.cb=this.a=0,this.sc="",this.m=new we,this.Od=new Sn,this.Kc=new Mt,this.ed=new Pr,this.Qa=new Oe,this.Ic=this.$c=this.Aa=0,this.D=new mn,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,we),this.ia=0,this.pb=a(4,gn),this.Pa=new or,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Wr),this.Hd=0,this.rb=Array(new qr),this.sb=0,this.wa=Array(new Mn),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new vi),this.L=this.aa=0,this.gd=o([4,2],Mn),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Xs(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function zn(){var A=new Da;return A!=null&&(A.a=0,A.sc="OK",A.cb=0,A.Xb=0,eo||(eo=Qo)),A}function Jr(A,g,w){return A.a==0&&(A.a=g,A.sc=w,A.cb=0),0}function vs(A,g,w){return 3<=w&&A[g+0]==157&&A[g+1]==1&&A[g+2]==42}function Nn(A,g){if(A==null)return 0;if(A.a=0,A.sc="OK",g==null)return Jr(A,2,"null VP8Io passed to VP8GetHeaders()");var w=g.data,B=g.w,I=g.ha;if(4>I)return Jr(A,7,"Truncated header.");var L=w[B+0]|w[B+1]<<8|w[B+2]<<16,R=A.Od;if(R.Rb=!(1&L),R.td=L>>1&7,R.yd=L>>4&1,R.ub=L>>5,3<R.td)return Jr(A,3,"Incorrect keyframe parameters.");if(!R.yd)return Jr(A,4,"Frame not displayable.");B+=3,I-=3;var O=A.Kc;if(R.Rb){if(7>I)return Jr(A,7,"cannot parse picture header");if(!vs(w,B,I))return Jr(A,3,"Bad code word");O.c=16383&(w[B+4]<<8|w[B+3]),O.Td=w[B+4]>>6,O.i=16383&(w[B+6]<<8|w[B+5]),O.Ud=w[B+6]>>6,B+=7,I-=7,A.za=O.c+15>>4,A.Ub=O.i+15>>4,g.width=O.c,g.height=O.i,g.Da=0,g.j=0,g.v=0,g.va=g.width,g.o=g.height,g.da=0,g.ib=g.width,g.hb=g.height,g.U=g.width,g.T=g.height,i((L=A.Pa).jb,0,255,L.jb.length),t((L=A.Qa)!=null),L.Cb=0,L.Bb=0,L.Fb=1,i(L.Zb,0,0,L.Zb.length),i(L.Lb,0,0,L.Lb)}if(R.ub>I)return Jr(A,7,"bad partition length");$t(L=A.m,w,B,R.ub),B+=R.ub,I-=R.ub,R.Rb&&(O.Ld=re(L),O.Kd=re(L)),O=A.Qa;var N,H=A.Pa;if(t(L!=null),t(O!=null),O.Cb=re(L),O.Cb){if(O.Bb=re(L),re(L)){for(O.Fb=re(L),N=0;4>N;++N)O.Zb[N]=re(L)?Yt(L,7):0;for(N=0;4>N;++N)O.Lb[N]=re(L)?Yt(L,6):0}if(O.Bb)for(N=0;3>N;++N)H.jb[N]=re(L)?Wt(L,8):255}else O.Bb=0;if(L.Ka)return Jr(A,3,"cannot parse segment header");if((O=A.ed).zd=re(L),O.Tb=Wt(L,6),O.wb=Wt(L,3),O.Pc=re(L),O.Pc&&re(L)){for(H=0;4>H;++H)re(L)&&(O.vd[H]=Yt(L,6));for(H=0;4>H;++H)re(L)&&(O.od[H]=Yt(L,6))}if(A.L=O.Tb==0?0:O.zd?1:2,L.Ka)return Jr(A,3,"cannot parse filter header");var K=I;if(I=N=B,B=N+K,O=K,A.Xb=(1<<Wt(A.m,2))-1,K<3*(H=A.Xb))w=7;else{for(N+=3*H,O-=3*H,K=0;K<H;++K){var et=w[I+0]|w[I+1]<<8|w[I+2]<<16;et>O&&(et=O),$t(A.Jc[+K],w,N,et),N+=et,O-=et,I+=3}$t(A.Jc[+H],w,N,O),w=N<B?0:5}if(w!=0)return Jr(A,w,"cannot parse partitions");for(w=Wt(N=A.m,7),I=re(N)?Yt(N,4):0,B=re(N)?Yt(N,4):0,O=re(N)?Yt(N,4):0,H=re(N)?Yt(N,4):0,N=re(N)?Yt(N,4):0,K=A.Qa,et=0;4>et;++et){if(K.Cb){var Y=K.Zb[et];K.Fb||(Y+=w)}else{if(0<et){A.pb[et]=A.pb[0];continue}Y=w}var Z=A.pb[et];Z.Sc[0]=pA[hs(Y+I,127)],Z.Sc[1]=to[hs(Y+0,127)],Z.Eb[0]=2*pA[hs(Y+B,127)],Z.Eb[1]=101581*to[hs(Y+O,127)]>>16,8>Z.Eb[1]&&(Z.Eb[1]=8),Z.Qc[0]=pA[hs(Y+H,117)],Z.Qc[1]=to[hs(Y+N,127)],Z.lc=Y+N}if(!R.Rb)return Jr(A,4,"Not a key frame.");for(re(L),R=A.Pa,w=0;4>w;++w){for(I=0;8>I;++I)for(B=0;3>B;++B)for(O=0;11>O;++O)H=te(L,mu[w][I][B][O])?Wt(L,8):Hm[w][I][B][O],R.Wc[w][I].Yb[B][O]=H;for(I=0;17>I;++I)R.Xc[w][I]=R.Wc[w][ma[I]]}return A.kc=re(L),A.kc&&(A.Bd=Wt(L,8)),A.cb=1}function Qo(A,g,w,B,I,L,R){var O=g[I].Yb[w];for(w=0;16>I;++I){if(!te(A,O[w+0]))return I;for(;!te(A,O[w+1]);)if(O=g[++I].Yb[0],w=0,I==16)return 16;var N=g[I+1].Yb;if(te(A,O[w+2])){var H=A,K=0;if(te(H,(Y=O)[(et=w)+3]))if(te(H,Y[et+6])){for(O=0,et=2*(K=te(H,Y[et+8]))+(Y=te(H,Y[et+9+K])),K=0,Y=zm[et];Y[O];++O)K+=K+te(H,Y[O]);K+=3+(8<<et)}else te(H,Y[et+7])?(K=7+2*te(H,165),K+=te(H,145)):K=5+te(H,159);else K=te(H,Y[et+4])?3+te(H,Y[et+5]):2;O=N[2]}else K=1,O=N[1];N=R+Ld[I],0>(H=A).b&&Vt(H);var et,Y=H.b,Z=(et=H.Ca>>1)-(H.I>>Y)>>31;--H.b,H.Ca+=Z,H.Ca|=1,H.I-=(et+1&Z)<<Y,L[N]=((K^Z)-Z)*B[(0<I)+0]}return 16}function Ti(A){var g=A.rb[A.sb-1];g.la=0,g.Na=0,i(A.zc,0,0,A.zc.length),A.ja=0}function zo(A,g){if(A==null)return 0;if(g==null)return Jr(A,2,"NULL VP8Io parameter in VP8Decode().");if(!A.cb&&!Nn(A,g))return 0;if(t(A.cb),g.ac==null||g.ac(g)){g.ob&&(A.L=0);var w=S[A.L];if(A.L==2?(A.yb=0,A.zb=0):(A.yb=g.v-w>>4,A.zb=g.j-w>>4,0>A.yb&&(A.yb=0),0>A.zb&&(A.zb=0)),A.Va=g.o+15+w>>4,A.Hb=g.va+15+w>>4,A.Hb>A.za&&(A.Hb=A.za),A.Va>A.Ub&&(A.Va=A.Ub),0<A.L){var B=A.ed;for(w=0;4>w;++w){var I;if(A.Qa.Cb){var L=A.Qa.Lb[w];A.Qa.Fb||(L+=B.Tb)}else L=B.Tb;for(I=0;1>=I;++I){var R=A.gd[w][I],O=L;if(B.Pc&&(O+=B.vd[0],I&&(O+=B.od[0])),0<(O=0>O?0:63<O?63:O)){var N=O;0<B.wb&&(N=4<B.wb?N>>2:N>>1)>9-B.wb&&(N=9-B.wb),1>N&&(N=1),R.dd=N,R.tc=2*O+N,R.ld=40<=O?2:15<=O?1:0}else R.tc=0;R.La=I}}}w=0}else Jr(A,6,"Frame setup failed"),w=A.a;if(w=w==0){if(w){A.$c=0,0<A.Aa||(A.Ic=f);t:{w=A.Ic,B=4*(N=A.za);var H=32*N,K=N+1,et=0<A.L?N*(0<A.Aa?2:1):0,Y=(A.Aa==2?2:1)*N;if((R=B+832+(I=3*(16*w+S[A.L])/2*H)+(L=A.Fa!=null&&0<A.Fa.length?A.Kc.c*A.Kc.i:0))!=R)w=0;else{if(R>A.Vb){if(A.Vb=0,A.Ec=s(R),A.Fc=0,A.Ec==null){w=Jr(A,1,"no memory during frame initialization.");break t}A.Vb=R}R=A.Ec,O=A.Fc,A.Ac=R,A.Bc=O,O+=B,A.Gd=a(H,Wr),A.Hd=0,A.rb=a(K+1,qr),A.sb=1,A.wa=et?a(et,Mn):null,A.Y=0,A.D.Nb=0,A.D.wa=A.wa,A.D.Y=A.Y,0<A.Aa&&(A.D.Y+=N),t(!0),A.oc=R,A.pc=O,O+=832,A.ya=a(Y,vi),A.aa=0,A.D.ya=A.ya,A.D.aa=A.aa,A.Aa==2&&(A.D.aa+=N),A.R=16*N,A.B=8*N,N=(H=S[A.L])*A.R,H=H/2*A.B,A.sa=R,A.ta=O+N,A.qa=A.sa,A.ra=A.ta+16*w*A.R+H,A.Ha=A.qa,A.Ia=A.ra+8*w*A.B+H,A.$c=0,O+=I,A.mb=L?R:null,A.nb=L?O:null,t(O+L<=A.Fc+A.Vb),Ti(A),i(A.Ac,A.Bc,0,B),w=1}}if(w){if(g.ka=0,g.y=A.sa,g.O=A.ta,g.f=A.qa,g.N=A.ra,g.ea=A.Ha,g.Vd=A.Ia,g.fa=A.R,g.Rc=A.B,g.F=null,g.J=0,!Ss){for(w=-255;255>=w;++w)gh[255+w]=0>w?-w:w;for(w=-1020;1020>=w;++w)Td[1020+w]=-128>w?-128:127<w?127:w;for(w=-112;112>=w;++w)Hn[112+w]=-16>w?-16:15<w?15:w;for(w=-255;510>=w;++w)Ml[255+w]=0>w?0:255<w?255:w;Ss=1}ks=bt,Tl=Na,Ko=_l,Cs=ka,Es=ht,Ec=tn,Wa=au,Il=wc,Fl=hh,$o=lu,Ll=Ah,rs=bl,wo=cu,en=oA,Fn=vl,fi=Ha,bi=Vo,Wo=Sd,Bo[0]=Ho,Bo[1]=le,Bo[2]=_c,Bo[3]=iu,Bo[4]=nA,Bo[5]=vc,Bo[6]=Aa,Bo[7]=iA,Bo[8]=ch,Bo[9]=Ed,je[0]=Fi,je[1]=Ze,je[2]=zr,je[3]=Zn,je[4]=yn,je[5]=yc,je[6]=As,Yo[0]=da,Yo[1]=Ie,Yo[2]=uh,Yo[3]=sA,Yo[4]=Qa,Yo[5]=su,Yo[6]=bc,w=1}else w=0}w&&(w=function(Z,yt){for(Z.M=0;Z.M<Z.Va;++Z.M){var at,lt=Z.Jc[Z.M&Z.Xb],At=Z.m,Et=Z;for(at=0;at<Et.za;++at){var Dt=At,zt=Et,ue=zt.Ac,oe=zt.Bc+4*at,ce=zt.zc,ie=zt.ya[zt.aa+at];if(zt.Qa.Bb?ie.$b=te(Dt,zt.Pa.jb[0])?2+te(Dt,zt.Pa.jb[2]):te(Dt,zt.Pa.jb[1]):ie.$b=0,zt.kc&&(ie.Ad=te(Dt,zt.Bd)),ie.Za=!te(Dt,145)+0,ie.Za){var Pe=ie.Ob,We=0;for(zt=0;4>zt;++zt){var _e,be=ce[0+zt];for(_e=0;4>_e;++_e){be=Pd[ue[oe+_e]][be];for(var Xe=wp[te(Dt,be[0])];0<Xe;)Xe=wp[2*Xe+te(Dt,be[Xe])];be=-Xe,ue[oe+_e]=be}n(Pe,We,ue,oe,4),We+=4,ce[0+zt]=be}}else be=te(Dt,156)?te(Dt,128)?1:3:te(Dt,163)?2:0,ie.Ob[0]=be,i(ue,oe,be,4),i(ce,0,be,4);ie.Dd=te(Dt,142)?te(Dt,114)?te(Dt,183)?1:3:2:0}if(Et.m.Ka)return Jr(Z,7,"Premature end-of-partition0 encountered.");for(;Z.ja<Z.za;++Z.ja){if(Et=lt,Dt=(At=Z).rb[At.sb-1],ue=At.rb[At.sb+At.ja],at=At.ya[At.aa+At.ja],oe=At.kc?at.Ad:0)Dt.la=ue.la=0,at.Za||(Dt.Na=ue.Na=0),at.Hc=0,at.Gc=0,at.ia=0;else{var Rr,He;if(Dt=ue,ue=Et,oe=At.Pa.Xc,ce=At.ya[At.aa+At.ja],ie=At.pb[ce.$b],zt=ce.ad,Pe=0,We=At.rb[At.sb-1],be=_e=0,i(zt,Pe,0,384),ce.Za)var Sr=0,an=oe[3];else{Xe=s(16);var pn=Dt.Na+We.Na;if(pn=eo(ue,oe[1],pn,ie.Eb,0,Xe,0),Dt.Na=We.Na=(0<pn)+0,1<pn)ks(Xe,0,zt,Pe);else{var oi=Xe[0]+3>>3;for(Xe=0;256>Xe;Xe+=16)zt[Pe+Xe]=oi}Sr=1,an=oe[0]}var Mr=15&Dt.la,Xn=15&We.la;for(Xe=0;4>Xe;++Xe){var Vn=1&Xn;for(oi=He=0;4>oi;++oi)Mr=Mr>>1|(Vn=(pn=eo(ue,an,pn=Vn+(1&Mr),ie.Sc,Sr,zt,Pe))>Sr)<<7,He=He<<2|(3<pn?3:1<pn?2:zt[Pe+0]!=0),Pe+=16;Mr>>=4,Xn=Xn>>1|Vn<<7,_e=(_e<<8|He)>>>0}for(an=Mr,Sr=Xn>>4,Rr=0;4>Rr;Rr+=2){for(He=0,Mr=Dt.la>>4+Rr,Xn=We.la>>4+Rr,Xe=0;2>Xe;++Xe){for(Vn=1&Xn,oi=0;2>oi;++oi)pn=Vn+(1&Mr),Mr=Mr>>1|(Vn=0<(pn=eo(ue,oe[2],pn,ie.Qc,0,zt,Pe)))<<3,He=He<<2|(3<pn?3:1<pn?2:zt[Pe+0]!=0),Pe+=16;Mr>>=2,Xn=Xn>>1|Vn<<5}be|=He<<4*Rr,an|=Mr<<4<<Rr,Sr|=(240&Xn)<<Rr}Dt.la=an,We.la=Sr,ce.Hc=_e,ce.Gc=be,ce.ia=43690&be?0:ie.ia,oe=!(_e|be)}if(0<At.L&&(At.wa[At.Y+At.ja]=At.gd[at.$b][at.Za],At.wa[At.Y+At.ja].La|=!oe),Et.Ka)return Jr(Z,7,"Premature end-of-file encountered.")}if(Ti(Z),At=yt,Et=1,at=(lt=Z).D,Dt=0<lt.L&&lt.M>=lt.zb&&lt.M<=lt.Va,lt.Aa==0)t:{if(at.M=lt.M,at.uc=Dt,Cl(lt,at),Et=1,at=(He=lt.D).Nb,Dt=(be=S[lt.L])*lt.R,ue=be/2*lt.B,Xe=16*at*lt.R,oi=8*at*lt.B,oe=lt.sa,ce=lt.ta-Dt+Xe,ie=lt.qa,zt=lt.ra-ue+oi,Pe=lt.Ha,We=lt.Ia-ue+oi,Xn=(Mr=He.M)==0,_e=Mr>=lt.Va-1,lt.Aa==2&&Cl(lt,He),He.uc)for(Vn=(pn=lt).D.M,t(pn.D.uc),He=pn.yb;He<pn.Hb;++He){Sr=He,an=Vn;var bn=(xn=(Bn=pn).D).Nb;Rr=Bn.R;var xn=xn.wa[xn.Y+Sr],ei=Bn.sa,Gi=Bn.ta+16*bn*Rr+16*Sr,no=xn.dd,pi=xn.tc;if(pi!=0)if(t(3<=pi),Bn.L==1)0<Sr&&fi(ei,Gi,Rr,pi+4),xn.La&&Wo(ei,Gi,Rr,pi),0<an&&Fn(ei,Gi,Rr,pi+4),xn.La&&bi(ei,Gi,Rr,pi);else{var Is=Bn.B,_a=Bn.qa,Nl=Bn.ra+8*bn*Is+8*Sr,ai=Bn.Ha,Bn=Bn.Ia+8*bn*Is+8*Sr;bn=xn.ld,0<Sr&&(Il(ei,Gi,Rr,pi+4,no,bn),$o(_a,Nl,ai,Bn,Is,pi+4,no,bn)),xn.La&&(rs(ei,Gi,Rr,pi,no,bn),en(_a,Nl,ai,Bn,Is,pi,no,bn)),0<an&&(Wa(ei,Gi,Rr,pi+4,no,bn),Fl(_a,Nl,ai,Bn,Is,pi+4,no,bn)),xn.La&&(Ll(ei,Gi,Rr,pi,no,bn),wo(_a,Nl,ai,Bn,Is,pi,no,bn))}}if(lt.ia&&alert("todo:DitherRow"),At.put!=null){if(He=16*Mr,Mr=16*(Mr+1),Xn?(At.y=lt.sa,At.O=lt.ta+Xe,At.f=lt.qa,At.N=lt.ra+oi,At.ea=lt.Ha,At.W=lt.Ia+oi):(He-=be,At.y=oe,At.O=ce,At.f=ie,At.N=zt,At.ea=Pe,At.W=We),_e||(Mr-=be),Mr>At.o&&(Mr=At.o),At.F=null,At.J=null,lt.Fa!=null&&0<lt.Fa.length&&He<Mr&&(At.J=lA(lt,At,He,Mr-He),At.F=lt.mb,At.F==null&&At.F.length==0)){Et=Jr(lt,3,"Could not decode alpha data.");break t}He<At.j&&(be=At.j-He,He=At.j,t(!(1&be)),At.O+=lt.R*be,At.N+=lt.B*(be>>1),At.W+=lt.B*(be>>1),At.F!=null&&(At.J+=At.width*be)),He<Mr&&(At.O+=At.v,At.N+=At.v>>1,At.W+=At.v>>1,At.F!=null&&(At.J+=At.v),At.ka=He-At.j,At.U=At.va-At.v,At.T=Mr-He,Et=At.put(At))}at+1!=lt.Ic||_e||(n(lt.sa,lt.ta-Dt,oe,ce+16*lt.R,Dt),n(lt.qa,lt.ra-ue,ie,zt+8*lt.B,ue),n(lt.Ha,lt.Ia-ue,Pe,We+8*lt.B,ue))}if(!Et)return Jr(Z,6,"Output aborted.")}return 1}(A,g)),g.bc!=null&&g.bc(g),w&=1}return w?(A.cb=0,w):0}function hi(A,g,w,B,I){I=A[g+w+32*B]+(I>>3),A[g+w+32*B]=-256&I?0>I?0:255:I}function ts(A,g,w,B,I,L){hi(A,g,0,w,B+I),hi(A,g,1,w,B+L),hi(A,g,2,w,B-L),hi(A,g,3,w,B-I)}function Ii(A){return(20091*A>>16)+A}function bs(A,g,w,B){var I,L=0,R=s(16);for(I=0;4>I;++I){var O=A[g+0]+A[g+8],N=A[g+0]-A[g+8],H=(35468*A[g+4]>>16)-Ii(A[g+12]),K=Ii(A[g+4])+(35468*A[g+12]>>16);R[L+0]=O+K,R[L+1]=N+H,R[L+2]=N-H,R[L+3]=O-K,L+=4,g++}for(I=L=0;4>I;++I)O=(A=R[L+0]+4)+R[L+8],N=A-R[L+8],H=(35468*R[L+4]>>16)-Ii(R[L+12]),hi(w,B,0,0,O+(K=Ii(R[L+4])+(35468*R[L+12]>>16))),hi(w,B,1,0,N+H),hi(w,B,2,0,N-H),hi(w,B,3,0,O-K),L++,B+=32}function tn(A,g,w,B){var I=A[g+0]+4,L=35468*A[g+4]>>16,R=Ii(A[g+4]),O=35468*A[g+1]>>16;ts(w,B,0,I+R,A=Ii(A[g+1]),O),ts(w,B,1,I+L,A,O),ts(w,B,2,I-L,A,O),ts(w,B,3,I-R,A,O)}function Na(A,g,w,B,I){bs(A,g,w,B),I&&bs(A,g+16,w,B+4)}function _l(A,g,w,B){Tl(A,g+0,w,B,1),Tl(A,g+32,w,B+128,1)}function ka(A,g,w,B){var I;for(A=A[g+0]+4,I=0;4>I;++I)for(g=0;4>g;++g)hi(w,B,g,I,A)}function ht(A,g,w,B){A[g+0]&&Cs(A,g+0,w,B),A[g+16]&&Cs(A,g+16,w,B+4),A[g+32]&&Cs(A,g+32,w,B+128),A[g+48]&&Cs(A,g+48,w,B+128+4)}function bt(A,g,w,B){var I,L=s(16);for(I=0;4>I;++I){var R=A[g+0+I]+A[g+12+I],O=A[g+4+I]+A[g+8+I],N=A[g+4+I]-A[g+8+I],H=A[g+0+I]-A[g+12+I];L[0+I]=R+O,L[8+I]=R-O,L[4+I]=H+N,L[12+I]=H-N}for(I=0;4>I;++I)R=(A=L[0+4*I]+3)+L[3+4*I],O=L[1+4*I]+L[2+4*I],N=L[1+4*I]-L[2+4*I],H=A-L[3+4*I],w[B+0]=R+O>>3,w[B+16]=H+N>>3,w[B+32]=R-O>>3,w[B+48]=H-N>>3,B+=64}function Nt(A,g,w){var B,I=g-32,L=Ts,R=255-A[I-1];for(B=0;B<w;++B){var O,N=L,H=R+A[g-1];for(O=0;O<w;++O)A[g+O]=N[H+A[I+O]];g+=32}}function le(A,g){Nt(A,g,4)}function Ie(A,g){Nt(A,g,8)}function Ze(A,g){Nt(A,g,16)}function zr(A,g){var w;for(w=0;16>w;++w)n(A,g+32*w,A,g-32,16)}function Zn(A,g){var w;for(w=16;0<w;--w)i(A,g,A[g-1],16),g+=32}function ti(A,g,w){var B;for(B=0;16>B;++B)i(g,w+32*B,A,16)}function Fi(A,g){var w,B=16;for(w=0;16>w;++w)B+=A[g-1+32*w]+A[g+w-32];ti(B>>5,A,g)}function yn(A,g){var w,B=8;for(w=0;16>w;++w)B+=A[g-1+32*w];ti(B>>4,A,g)}function yc(A,g){var w,B=8;for(w=0;16>w;++w)B+=A[g+w-32];ti(B>>4,A,g)}function As(A,g){ti(128,A,g)}function Ir(A,g,w){return A+2*g+w+2>>2}function _c(A,g){var w,B=g-32;for(B=new Uint8Array([Ir(A[B-1],A[B+0],A[B+1]),Ir(A[B+0],A[B+1],A[B+2]),Ir(A[B+1],A[B+2],A[B+3]),Ir(A[B+2],A[B+3],A[B+4])]),w=0;4>w;++w)n(A,g+32*w,B,0,B.length)}function iu(A,g){var w=A[g-1],B=A[g-1+32],I=A[g-1+64],L=A[g-1+96];Ce(A,g+0,16843009*Ir(A[g-1-32],w,B)),Ce(A,g+32,16843009*Ir(w,B,I)),Ce(A,g+64,16843009*Ir(B,I,L)),Ce(A,g+96,16843009*Ir(I,L,L))}function Ho(A,g){var w,B=4;for(w=0;4>w;++w)B+=A[g+w-32]+A[g-1+32*w];for(B>>=3,w=0;4>w;++w)i(A,g+32*w,B,4)}function nA(A,g){var w=A[g-1+0],B=A[g-1+32],I=A[g-1+64],L=A[g-1-32],R=A[g+0-32],O=A[g+1-32],N=A[g+2-32],H=A[g+3-32];A[g+0+96]=Ir(B,I,A[g-1+96]),A[g+1+96]=A[g+0+64]=Ir(w,B,I),A[g+2+96]=A[g+1+64]=A[g+0+32]=Ir(L,w,B),A[g+3+96]=A[g+2+64]=A[g+1+32]=A[g+0+0]=Ir(R,L,w),A[g+3+64]=A[g+2+32]=A[g+1+0]=Ir(O,R,L),A[g+3+32]=A[g+2+0]=Ir(N,O,R),A[g+3+0]=Ir(H,N,O)}function Aa(A,g){var w=A[g+1-32],B=A[g+2-32],I=A[g+3-32],L=A[g+4-32],R=A[g+5-32],O=A[g+6-32],N=A[g+7-32];A[g+0+0]=Ir(A[g+0-32],w,B),A[g+1+0]=A[g+0+32]=Ir(w,B,I),A[g+2+0]=A[g+1+32]=A[g+0+64]=Ir(B,I,L),A[g+3+0]=A[g+2+32]=A[g+1+64]=A[g+0+96]=Ir(I,L,R),A[g+3+32]=A[g+2+64]=A[g+1+96]=Ir(L,R,O),A[g+3+64]=A[g+2+96]=Ir(R,O,N),A[g+3+96]=Ir(O,N,N)}function vc(A,g){var w=A[g-1+0],B=A[g-1+32],I=A[g-1+64],L=A[g-1-32],R=A[g+0-32],O=A[g+1-32],N=A[g+2-32],H=A[g+3-32];A[g+0+0]=A[g+1+64]=L+R+1>>1,A[g+1+0]=A[g+2+64]=R+O+1>>1,A[g+2+0]=A[g+3+64]=O+N+1>>1,A[g+3+0]=N+H+1>>1,A[g+0+96]=Ir(I,B,w),A[g+0+64]=Ir(B,w,L),A[g+0+32]=A[g+1+96]=Ir(w,L,R),A[g+1+32]=A[g+2+96]=Ir(L,R,O),A[g+2+32]=A[g+3+96]=Ir(R,O,N),A[g+3+32]=Ir(O,N,H)}function iA(A,g){var w=A[g+0-32],B=A[g+1-32],I=A[g+2-32],L=A[g+3-32],R=A[g+4-32],O=A[g+5-32],N=A[g+6-32],H=A[g+7-32];A[g+0+0]=w+B+1>>1,A[g+1+0]=A[g+0+64]=B+I+1>>1,A[g+2+0]=A[g+1+64]=I+L+1>>1,A[g+3+0]=A[g+2+64]=L+R+1>>1,A[g+0+32]=Ir(w,B,I),A[g+1+32]=A[g+0+96]=Ir(B,I,L),A[g+2+32]=A[g+1+96]=Ir(I,L,R),A[g+3+32]=A[g+2+96]=Ir(L,R,O),A[g+3+64]=Ir(R,O,N),A[g+3+96]=Ir(O,N,H)}function Ed(A,g){var w=A[g-1+0],B=A[g-1+32],I=A[g-1+64],L=A[g-1+96];A[g+0+0]=w+B+1>>1,A[g+2+0]=A[g+0+32]=B+I+1>>1,A[g+2+32]=A[g+0+64]=I+L+1>>1,A[g+1+0]=Ir(w,B,I),A[g+3+0]=A[g+1+32]=Ir(B,I,L),A[g+3+32]=A[g+1+64]=Ir(I,L,L),A[g+3+64]=A[g+2+64]=A[g+0+96]=A[g+1+96]=A[g+2+96]=A[g+3+96]=L}function ch(A,g){var w=A[g-1+0],B=A[g-1+32],I=A[g-1+64],L=A[g-1+96],R=A[g-1-32],O=A[g+0-32],N=A[g+1-32],H=A[g+2-32];A[g+0+0]=A[g+2+32]=w+R+1>>1,A[g+0+32]=A[g+2+64]=B+w+1>>1,A[g+0+64]=A[g+2+96]=I+B+1>>1,A[g+0+96]=L+I+1>>1,A[g+3+0]=Ir(O,N,H),A[g+2+0]=Ir(R,O,N),A[g+1+0]=A[g+3+32]=Ir(w,R,O),A[g+1+32]=A[g+3+64]=Ir(B,w,R),A[g+1+64]=A[g+3+96]=Ir(I,B,w),A[g+1+96]=Ir(L,I,B)}function uh(A,g){var w;for(w=0;8>w;++w)n(A,g+32*w,A,g-32,8)}function sA(A,g){var w;for(w=0;8>w;++w)i(A,g,A[g-1],8),g+=32}function ha(A,g,w){var B;for(B=0;8>B;++B)i(g,w+32*B,A,8)}function da(A,g){var w,B=8;for(w=0;8>w;++w)B+=A[g+w-32]+A[g-1+32*w];ha(B>>4,A,g)}function su(A,g){var w,B=4;for(w=0;8>w;++w)B+=A[g+w-32];ha(B>>3,A,g)}function Qa(A,g){var w,B=4;for(w=0;8>w;++w)B+=A[g-1+32*w];ha(B>>3,A,g)}function bc(A,g){ha(128,A,g)}function ws(A,g,w){var B=A[g-w],I=A[g+0],L=3*(I-B)+du[1020+A[g-2*w]-A[g+w]],R=Ul[112+(L+4>>3)];A[g-w]=Ts[255+B+Ul[112+(L+3>>3)]],A[g+0]=Ts[255+I-R]}function ou(A,g,w,B){var I=A[g+0],L=A[g+w];return Vi[255+A[g-2*w]-A[g-w]]>B||Vi[255+L-I]>B}function za(A,g,w,B){return 4*Vi[255+A[g-w]-A[g+0]]+Vi[255+A[g-2*w]-A[g+w]]<=B}function on(A,g,w,B,I){var L=A[g-3*w],R=A[g-2*w],O=A[g-w],N=A[g+0],H=A[g+w],K=A[g+2*w],et=A[g+3*w];return 4*Vi[255+O-N]+Vi[255+R-H]>B?0:Vi[255+A[g-4*w]-L]<=I&&Vi[255+L-R]<=I&&Vi[255+R-O]<=I&&Vi[255+et-K]<=I&&Vi[255+K-H]<=I&&Vi[255+H-N]<=I}function vl(A,g,w,B){var I=2*B+1;for(B=0;16>B;++B)za(A,g+B,w,I)&&ws(A,g+B,w)}function Ha(A,g,w,B){var I=2*B+1;for(B=0;16>B;++B)za(A,g+B*w,1,I)&&ws(A,g+B*w,1)}function Vo(A,g,w,B){var I;for(I=3;0<I;--I)vl(A,g+=4*w,w,B)}function Sd(A,g,w,B){var I;for(I=3;0<I;--I)Ha(A,g+=4,w,B)}function Js(A,g,w,B,I,L,R,O){for(L=2*L+1;0<I--;){if(on(A,g,w,L,R))if(ou(A,g,w,O))ws(A,g,w);else{var N=A,H=g,K=w,et=N[H-2*K],Y=N[H-K],Z=N[H+0],yt=N[H+K],at=N[H+2*K],lt=27*(Et=du[1020+3*(Z-Y)+du[1020+et-yt]])+63>>7,At=18*Et+63>>7,Et=9*Et+63>>7;N[H-3*K]=Ts[255+N[H-3*K]+Et],N[H-2*K]=Ts[255+et+At],N[H-K]=Ts[255+Y+lt],N[H+0]=Ts[255+Z-lt],N[H+K]=Ts[255+yt-At],N[H+2*K]=Ts[255+at-Et]}g+=B}}function Go(A,g,w,B,I,L,R,O){for(L=2*L+1;0<I--;){if(on(A,g,w,L,R))if(ou(A,g,w,O))ws(A,g,w);else{var N=A,H=g,K=w,et=N[H-K],Y=N[H+0],Z=N[H+K],yt=Ul[112+((at=3*(Y-et))+4>>3)],at=Ul[112+(at+3>>3)],lt=yt+1>>1;N[H-2*K]=Ts[255+N[H-2*K]+lt],N[H-K]=Ts[255+et+at],N[H+0]=Ts[255+Y-yt],N[H+K]=Ts[255+Z-lt]}g+=B}}function au(A,g,w,B,I,L){Js(A,g,w,1,16,B,I,L)}function wc(A,g,w,B,I,L){Js(A,g,1,w,16,B,I,L)}function Ah(A,g,w,B,I,L){var R;for(R=3;0<R;--R)Go(A,g+=4*w,w,1,16,B,I,L)}function bl(A,g,w,B,I,L){var R;for(R=3;0<R;--R)Go(A,g+=4,1,w,16,B,I,L)}function hh(A,g,w,B,I,L,R,O){Js(A,g,I,1,8,L,R,O),Js(w,B,I,1,8,L,R,O)}function lu(A,g,w,B,I,L,R,O){Js(A,g,1,I,8,L,R,O),Js(w,B,1,I,8,L,R,O)}function cu(A,g,w,B,I,L,R,O){Go(A,g+4*I,I,1,8,L,R,O),Go(w,B+4*I,I,1,8,L,R,O)}function oA(A,g,w,B,I,L,R,O){Go(A,g+4,1,I,8,L,R,O),Go(w,B+4,1,I,8,L,R,O)}function yo(){this.ba=new vn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ct,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function uu(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function aA(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function dh(){this.ua=0,this.Wa=new st,this.vb=new st,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new vt,this.yc=new ct}function fh(){this.xb=this.a=0,this.l=new Xs,this.ca=new vn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new it,this.Pb=0,this.wd=new it,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new dh,this.ab=0,this.gc=a(4,aA),this.Oc=0}function fa(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Xs,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function xc(A,g,w,B,I,L,R){for(A=A==null?0:A[g+0],g=0;g<R;++g)I[L+g]=A+w[B+g]&255,A=I[L+g]}function wl(A,g,w,B,I,L,R){var O;if(A==null)xc(null,null,w,B,I,L,R);else for(O=0;O<R;++O)I[L+O]=A[g+O]+w[B+O]&255}function xl(A,g,w,B,I,L,R){if(A==null)xc(null,null,w,B,I,L,R);else{var O,N=A[g+0],H=N,K=N;for(O=0;O<R;++O)H=K+(N=A[g+O])-H,K=w[B+O]+(-256&H?0>H?0:255:H)&255,H=N,I[L+O]=K}}function lA(A,g,w,B){var I=g.width,L=g.o;if(t(A!=null&&g!=null),0>w||0>=B||w+B>L)return null;if(!A.Cc){if(A.ga==null){var R;if(A.ga=new fa,(R=A.ga==null)||(R=g.width*g.o,t(A.Gb.length==0),A.Gb=s(R),A.Uc=0,A.Gb==null?R=0:(A.mb=A.Gb,A.nb=A.Uc,A.rc=null,R=1),R=!R),!R){R=A.ga;var O=A.Fa,N=A.P,H=A.qc,K=A.mb,et=A.nb,Y=N+1,Z=H-1,yt=R.l;if(t(O!=null&&K!=null&&g!=null),ns[0]=null,ns[1]=xc,ns[2]=wl,ns[3]=xl,R.ca=K,R.tb=et,R.c=g.width,R.i=g.height,t(0<R.c&&0<R.i),1>=H)g=0;else if(R.$a=O[N+0]>>0&3,R.Z=O[N+0]>>2&3,R.Lc=O[N+0]>>4&3,N=O[N+0]>>6&3,0>R.$a||1<R.$a||4<=R.Z||1<R.Lc||N)g=0;else if(yt.put=kt,yt.ac=Bt,yt.bc=Gt,yt.ma=R,yt.width=g.width,yt.height=g.height,yt.Da=g.Da,yt.v=g.v,yt.va=g.va,yt.j=g.j,yt.o=g.o,R.$a)t:{t(R.$a==1),g=cn();e:for(;;){if(g==null){g=0;break t}if(t(R!=null),R.mc=g,g.c=R.c,g.i=R.i,g.l=R.l,g.l.ma=R,g.l.width=R.c,g.l.height=R.i,g.a=0,Kt(g.m,O,Y,Z),!br(R.c,R.i,1,g,null)||(g.ab==1&&g.gc[0].hc==3&&Br(g.s)?(R.ic=1,O=g.c*g.i,g.Ta=null,g.Ua=0,g.V=s(O),g.Ba=0,g.V==null?(g.a=1,g=0):g=1):(R.ic=0,g=jr(g,R.c)),!g))break e;g=1;break t}R.mc=null,g=0}else g=Z>=R.c*R.i;R=!g}if(R)return null;A.ga.Lc!=1?A.Ga=0:B=L-w}t(A.ga!=null),t(w+B<=L);t:{if(g=(O=A.ga).c,L=O.l.o,O.$a==0){if(Y=A.rc,Z=A.Vc,yt=A.Fa,N=A.P+1+w*g,H=A.mb,K=A.nb+w*g,t(N<=A.P+A.qc),O.Z!=0)for(t(ns[O.Z]!=null),R=0;R<B;++R)ns[O.Z](Y,Z,yt,N,H,K,g),Y=H,Z=K,K+=g,N+=g;else for(R=0;R<B;++R)n(H,K,yt,N,g),Y=H,Z=K,K+=g,N+=g;A.rc=Y,A.Vc=Z}else{if(t(O.mc!=null),g=w+B,t((R=O.mc)!=null),t(g<=R.i),R.C>=g)g=1;else if(O.ic||ne(),O.ic){O=R.V,Y=R.Ba,Z=R.c;var at=R.i,lt=(yt=1,N=R.$/Z,H=R.$%Z,K=R.m,et=R.s,R.$),At=Z*at,Et=Z*g,Dt=et.wc,zt=lt<Et?xe(et,H,N):null;t(lt<=At),t(g<=at),t(Br(et));e:for(;;){for(;!K.h&&lt<Et;){if(H&Dt||(zt=xe(et,H,N)),t(zt!=null),jt(K),256>(at=fe(zt.G[0],zt.H[0],K)))O[Y+lt]=at,++lt,++H>=Z&&(H=0,++N<=g&&!(N%16)&&pr(R,N));else{if(!(280>at)){yt=0;break e}at=Pt(at-256,K);var ue,oe=fe(zt.G[4],zt.H[4],K);if(jt(K),!(lt>=(oe=ae(Z,oe=Pt(oe,K)))&&At-lt>=at)){yt=0;break e}for(ue=0;ue<at;++ue)O[Y+lt+ue]=O[Y+lt+ue-oe];for(lt+=at,H+=at;H>=Z;)H-=Z,++N<=g&&!(N%16)&&pr(R,N);lt<Et&&H&Dt&&(zt=xe(et,H,N))}t(K.h==It(K))}pr(R,N>g?g:N);break e}!yt||K.h&&lt<At?(yt=0,R.a=K.h?5:3):R.$=lt,g=yt}else g=Qr(R,R.V,R.Ba,R.c,R.i,g,sn);if(!g){B=0;break t}}w+B>=L&&(A.Cc=1),B=1}if(!B)return null;if(A.Cc&&((B=A.ga)!=null&&(B.mc=null),A.ga=null,0<A.Ga))return alert("todo:WebPDequantizeLevels"),null}return A.nb+w*I}function D(A,g,w,B,I,L){for(;0<I--;){var R,O=A,N=g+(w?1:0),H=A,K=g+(w?0:3);for(R=0;R<B;++R){var et=H[K+4*R];et!=255&&(et*=32897,O[N+4*R+0]=O[N+4*R+0]*et>>23,O[N+4*R+1]=O[N+4*R+1]*et>>23,O[N+4*R+2]=O[N+4*R+2]*et>>23)}g+=L}}function nt(A,g,w,B,I){for(;0<B--;){var L;for(L=0;L<w;++L){var R=A[g+2*L+0],O=15&(H=A[g+2*L+1]),N=4369*O,H=(240&H|H>>4)*N>>16;A[g+2*L+0]=(240&R|R>>4)*N>>16&240|(15&R|R<<4)*N>>16>>4&15,A[g+2*L+1]=240&H|O}g+=I}}function Lt(A,g,w,B,I,L,R,O){var N,H,K=255;for(H=0;H<I;++H){for(N=0;N<B;++N){var et=A[g+N];L[R+4*N]=et,K&=et}g+=w,R+=O}return K!=255}function Ht(A,g,w,B,I){var L;for(L=0;L<I;++L)w[B+L]=A[g+L]>>8}function ne(){Zs=D,Pl=nt,Xa=Lt,ph=Ht}function ge(A,g,w){dt[A]=function(B,I,L,R,O,N,H,K,et,Y,Z,yt,at,lt,At,Et,Dt){var zt,ue=Dt-1>>1,oe=O[N+0]|H[K+0]<<16,ce=et[Y+0]|Z[yt+0]<<16;t(B!=null);var ie=3*oe+ce+131074>>2;for(g(B[I+0],255&ie,ie>>16,at,lt),L!=null&&(ie=3*ce+oe+131074>>2,g(L[R+0],255&ie,ie>>16,At,Et)),zt=1;zt<=ue;++zt){var Pe=O[N+zt]|H[K+zt]<<16,We=et[Y+zt]|Z[yt+zt]<<16,_e=oe+Pe+ce+We+524296,be=_e+2*(Pe+ce)>>3;ie=be+oe>>1,oe=(_e=_e+2*(oe+We)>>3)+Pe>>1,g(B[I+2*zt-1],255&ie,ie>>16,at,lt+(2*zt-1)*w),g(B[I+2*zt-0],255&oe,oe>>16,at,lt+(2*zt-0)*w),L!=null&&(ie=_e+ce>>1,oe=be+We>>1,g(L[R+2*zt-1],255&ie,ie>>16,At,Et+(2*zt-1)*w),g(L[R+2*zt+0],255&oe,oe>>16,At,Et+(2*zt+0)*w)),oe=Pe,ce=We}1&Dt||(ie=3*oe+ce+131074>>2,g(B[I+Dt-1],255&ie,ie>>16,at,lt+(Dt-1)*w),L!=null&&(ie=3*ce+oe+131074>>2,g(L[R+Dt-1],255&ie,ie>>16,At,Et+(Dt-1)*w)))}}function Fe(){ro[Rl]=$e,ro[Ol]=Bp,ro[fu]=Md,ro[pu]=Ud,ro[gu]=_h,ro[uA]=Rd,ro[mh]=Dl,ro[Xo]=Bp,ro[AA]=Ud,ro[hA]=_h,ro[dA]=Rd}function tr(A){return A&~vu?0>A?0:255:A>>mA}function Fr(A,g){return tr((19077*A>>8)+(26149*g>>8)-14234)}function Kr(A,g,w){return tr((19077*A>>8)-(6419*g>>8)-(13320*w>>8)+8708)}function Yr(A,g){return tr((19077*A>>8)+(33050*g>>8)-17685)}function hn(A,g,w,B,I){B[I+0]=Fr(A,w),B[I+1]=Kr(A,g,w),B[I+2]=Yr(A,g)}function kr(A,g,w,B,I){B[I+0]=Yr(A,g),B[I+1]=Kr(A,g,w),B[I+2]=Fr(A,w)}function di(A,g,w,B,I){var L=Kr(A,g,w);g=L<<3&224|Yr(A,g)>>3,B[I+0]=248&Fr(A,w)|L>>5,B[I+1]=g}function Cr(A,g,w,B,I){var L=240&Yr(A,g)|15;B[I+0]=240&Fr(A,w)|Kr(A,g,w)>>4,B[I+1]=L}function Hi(A,g,w,B,I){B[I+0]=255,hn(A,g,w,B,I+1)}function Xr(A,g,w,B,I){kr(A,g,w,B,I),B[I+3]=255}function dn(A,g,w,B,I){hn(A,g,w,B,I),B[I+3]=255}function hs(A,g){return 0>A?0:A>g?g:A}function pa(A,g,w){dt[A]=function(B,I,L,R,O,N,H,K,et){for(var Y=K+(-2&et)*w;K!=Y;)g(B[I+0],L[R+0],O[N+0],H,K),g(B[I+1],L[R+0],O[N+0],H,K+w),I+=2,++R,++N,K+=2*w;1&et&&g(B[I+0],L[R+0],O[N+0],H,K)}}function Au(A,g,w){return w==0?A==0?g==0?6:5:g==0?4:0:w}function Bl(A,g,w,B,I){switch(A>>>30){case 3:Tl(g,w,B,I,0);break;case 2:Ec(g,w,B,I);break;case 1:Cs(g,w,B,I)}}function Cl(A,g){var w,B,I=g.M,L=g.Nb,R=A.oc,O=A.pc+40,N=A.oc,H=A.pc+584,K=A.oc,et=A.pc+600;for(w=0;16>w;++w)R[O+32*w-1]=129;for(w=0;8>w;++w)N[H+32*w-1]=129,K[et+32*w-1]=129;for(0<I?R[O-1-32]=N[H-1-32]=K[et-1-32]=129:(i(R,O-32-1,127,21),i(N,H-32-1,127,9),i(K,et-32-1,127,9)),B=0;B<A.za;++B){var Y=g.ya[g.aa+B];if(0<B){for(w=-1;16>w;++w)n(R,O+32*w-4,R,O+32*w+12,4);for(w=-1;8>w;++w)n(N,H+32*w-4,N,H+32*w+4,4),n(K,et+32*w-4,K,et+32*w+4,4)}var Z=A.Gd,yt=A.Hd+B,at=Y.ad,lt=Y.Hc;if(0<I&&(n(R,O-32,Z[yt].y,0,16),n(N,H-32,Z[yt].f,0,8),n(K,et-32,Z[yt].ea,0,8)),Y.Za){var At=R,Et=O-32+16;for(0<I&&(B>=A.za-1?i(At,Et,Z[yt].y[15],4):n(At,Et,Z[yt+1].y,0,4)),w=0;4>w;w++)At[Et+128+w]=At[Et+256+w]=At[Et+384+w]=At[Et+0+w];for(w=0;16>w;++w,lt<<=2)At=R,Et=O+Er[w],Bo[Y.Ob[w]](At,Et),Bl(lt,at,16*+w,At,Et)}else if(At=Au(B,I,Y.Ob[0]),je[At](R,O),lt!=0)for(w=0;16>w;++w,lt<<=2)Bl(lt,at,16*+w,R,O+Er[w]);for(w=Y.Gc,At=Au(B,I,Y.Dd),Yo[At](N,H),Yo[At](K,et),lt=at,At=N,Et=H,255&(Y=w>>0)&&(170&Y?Ko(lt,256,At,Et):Es(lt,256,At,Et)),Y=K,lt=et,255&(w>>=8)&&(170&w?Ko(at,320,Y,lt):Es(at,320,Y,lt)),I<A.Ub-1&&(n(Z[yt].y,0,R,O+480,16),n(Z[yt].f,0,N,H+224,8),n(Z[yt].ea,0,K,et+224,8)),w=8*L*A.B,Z=A.sa,yt=A.ta+16*B+16*L*A.R,at=A.qa,Y=A.ra+8*B+w,lt=A.Ha,At=A.Ia+8*B+w,w=0;16>w;++w)n(Z,yt+w*A.R,R,O+32*w,16);for(w=0;8>w;++w)n(at,Y+w*A.B,N,H+32*w,8),n(lt,At+w*A.B,K,et+32*w,8)}}function Va(A,g,w,B,I,L,R,O,N){var H=[0],K=[0],et=0,Y=N!=null?N.kd:0,Z=N??new uu;if(A==null||12>w)return 7;Z.data=A,Z.w=g,Z.ha=w,g=[g],w=[w],Z.gb=[Z.gb];t:{var yt=g,at=w,lt=Z.gb;if(t(A!=null),t(at!=null),t(lt!=null),lt[0]=0,12<=at[0]&&!e(A,yt[0],"RIFF")){if(e(A,yt[0]+8,"WEBP")){lt=3;break t}var At=Qe(A,yt[0]+4);if(12>At||4294967286<At){lt=3;break t}if(Y&&At>at[0]-8){lt=7;break t}lt[0]=At,yt[0]+=12,at[0]-=12}lt=0}if(lt!=0)return lt;for(At=0<Z.gb[0],w=w[0];;){t:{var Et=A;at=g,lt=w;var Dt=H,zt=K,ue=yt=[0];if((ie=et=[et])[0]=0,8>lt[0])lt=7;else{if(!e(Et,at[0],"VP8X")){if(Qe(Et,at[0]+4)!=10){lt=3;break t}if(18>lt[0]){lt=7;break t}var oe=Qe(Et,at[0]+8),ce=1+De(Et,at[0]+12);if(2147483648<=ce*(Et=1+De(Et,at[0]+15))){lt=3;break t}ue!=null&&(ue[0]=oe),Dt!=null&&(Dt[0]=ce),zt!=null&&(zt[0]=Et),at[0]+=18,lt[0]-=18,ie[0]=1}lt=0}}if(et=et[0],yt=yt[0],lt!=0)return lt;if(at=!!(2&yt),!At&&et)return 3;if(L!=null&&(L[0]=!!(16&yt)),R!=null&&(R[0]=at),O!=null&&(O[0]=0),R=H[0],yt=K[0],et&&at&&N==null){lt=0;break}if(4>w){lt=7;break}if(At&&et||!At&&!et&&!e(A,g[0],"ALPH")){w=[w],Z.na=[Z.na],Z.P=[Z.P],Z.Sa=[Z.Sa];t:{oe=A,lt=g,At=w;var ie=Z.gb;Dt=Z.na,zt=Z.P,ue=Z.Sa,ce=22,t(oe!=null),t(At!=null),Et=lt[0];var Pe=At[0];for(t(Dt!=null),t(ue!=null),Dt[0]=null,zt[0]=null,ue[0]=0;;){if(lt[0]=Et,At[0]=Pe,8>Pe){lt=7;break t}var We=Qe(oe,Et+4);if(4294967286<We){lt=3;break t}var _e=8+We+1&-2;if(ce+=_e,0<ie&&ce>ie){lt=3;break t}if(!e(oe,Et,"VP8 ")||!e(oe,Et,"VP8L")){lt=0;break t}if(Pe[0]<_e){lt=7;break t}e(oe,Et,"ALPH")||(Dt[0]=oe,zt[0]=Et+8,ue[0]=We),Et+=_e,Pe-=_e}}if(w=w[0],Z.na=Z.na[0],Z.P=Z.P[0],Z.Sa=Z.Sa[0],lt!=0)break}w=[w],Z.Ja=[Z.Ja],Z.xa=[Z.xa];t:if(ie=A,lt=g,At=w,Dt=Z.gb[0],zt=Z.Ja,ue=Z.xa,oe=lt[0],Et=!e(ie,oe,"VP8 "),ce=!e(ie,oe,"VP8L"),t(ie!=null),t(At!=null),t(zt!=null),t(ue!=null),8>At[0])lt=7;else{if(Et||ce){if(ie=Qe(ie,oe+4),12<=Dt&&ie>Dt-12){lt=3;break t}if(Y&&ie>At[0]-8){lt=7;break t}zt[0]=ie,lt[0]+=8,At[0]-=8,ue[0]=ce}else ue[0]=5<=At[0]&&ie[oe+0]==47&&!(ie[oe+4]>>5),zt[0]=At[0];lt=0}if(w=w[0],Z.Ja=Z.Ja[0],Z.xa=Z.xa[0],g=g[0],lt!=0)break;if(4294967286<Z.Ja)return 3;if(O==null||at||(O[0]=Z.xa?2:1),R=[R],yt=[yt],Z.xa){if(5>w){lt=7;break}O=R,Y=yt,at=L,A==null||5>w?A=0:5<=w&&A[g+0]==47&&!(A[g+4]>>5)?(At=[0],ie=[0],Dt=[0],Kt(zt=new it,A,g,w),Ot(zt,At,ie,Dt)?(O!=null&&(O[0]=At[0]),Y!=null&&(Y[0]=ie[0]),at!=null&&(at[0]=Dt[0]),A=1):A=0):A=0}else{if(10>w){lt=7;break}O=yt,A==null||10>w||!vs(A,g+3,w-3)?A=0:(Y=A[g+0]|A[g+1]<<8|A[g+2]<<16,at=16383&(A[g+7]<<8|A[g+6]),A=16383&(A[g+9]<<8|A[g+8]),1&Y||3<(Y>>1&7)||!(Y>>4&1)||Y>>5>=Z.Ja||!at||!A?A=0:(R&&(R[0]=at),O&&(O[0]=A),A=1))}if(!A||(R=R[0],yt=yt[0],et&&(H[0]!=R||K[0]!=yt)))return 3;N!=null&&(N[0]=Z,N.offset=g-N.w,t(4294967286>g-N.w),t(N.offset==N.ha-w));break}return lt==0||lt==7&&et&&N==null?(L!=null&&(L[0]|=Z.na!=null&&0<Z.na.length),B!=null&&(B[0]=R),I!=null&&(I[0]=yt),0):lt}function Bc(A,g,w){var B=g.width,I=g.height,L=0,R=0,O=B,N=I;if(g.Da=A!=null&&0<A.Da,g.Da&&(O=A.cd,N=A.bd,L=A.v,R=A.j,11>w||(L&=-2,R&=-2),0>L||0>R||0>=O||0>=N||L+O>B||R+N>I))return 0;if(g.v=L,g.j=R,g.va=L+O,g.o=R+N,g.U=O,g.T=N,g.da=A!=null&&0<A.da,g.da){if(!fr(O,N,w=[A.ib],L=[A.hb]))return 0;g.ib=w[0],g.hb=L[0]}return g.ob=A!=null&&A.ob,g.Kb=A==null||!A.Sd,g.da&&(g.ob=g.ib<3*B/4&&g.hb<3*I/4,g.Kb=0),1}function _o(A){if(A==null)return 2;if(11>A.S){var g=A.f.RGBA;g.fb+=(A.height-1)*g.A,g.A=-g.A}else g=A.f.kb,A=A.height,g.O+=(A-1)*g.fa,g.fa=-g.fa,g.N+=(A-1>>1)*g.Ab,g.Ab=-g.Ab,g.W+=(A-1>>1)*g.Db,g.Db=-g.Db,g.F!=null&&(g.J+=(A-1)*g.lb,g.lb=-g.lb);return 0}function vo(A,g,w,B){if(B==null||0>=A||0>=g)return 2;if(w!=null){if(w.Da){var I=w.cd,L=w.bd,R=-2&w.v,O=-2&w.j;if(0>R||0>O||0>=I||0>=L||R+I>A||O+L>g)return 2;A=I,g=L}if(w.da){if(!fr(A,g,I=[w.ib],L=[w.hb]))return 2;A=I[0],g=L[0]}}B.width=A,B.height=g;t:{var N=B.width,H=B.height;if(A=B.S,0>=N||0>=H||!(A>=Rl&&13>A))A=2;else{if(0>=B.Rd&&B.sd==null){R=L=I=g=0;var K=(O=N*_[A])*H;if(11>A||(L=(H+1)/2*(g=(N+1)/2),A==12&&(R=(I=N)*H)),(H=s(K+2*L+R))==null){A=1;break t}B.sd=H,11>A?((N=B.f.RGBA).eb=H,N.fb=0,N.A=O,N.size=K):((N=B.f.kb).y=H,N.O=0,N.fa=O,N.Fd=K,N.f=H,N.N=0+K,N.Ab=g,N.Cd=L,N.ea=H,N.W=0+K+L,N.Db=g,N.Ed=L,A==12&&(N.F=H,N.J=0+K+2*L),N.Tc=R,N.lb=I)}if(g=1,I=B.S,L=B.width,R=B.height,I>=Rl&&13>I)if(11>I)A=B.f.RGBA,g&=(O=Math.abs(A.A))*(R-1)+L<=A.size,g&=O>=L*_[I],g&=A.eb!=null;else{A=B.f.kb,O=(L+1)/2,K=(R+1)/2,N=Math.abs(A.fa),H=Math.abs(A.Ab);var et=Math.abs(A.Db),Y=Math.abs(A.lb),Z=Y*(R-1)+L;g&=N*(R-1)+L<=A.Fd,g&=H*(K-1)+O<=A.Cd,g=(g&=et*(K-1)+O<=A.Ed)&N>=L&H>=O&et>=O,g&=A.y!=null,g&=A.f!=null,g&=A.ea!=null,I==12&&(g&=Y>=L,g&=Z<=A.Tc,g&=A.F!=null)}else g=0;A=g?0:2}}return A!=0||w!=null&&w.fd&&(A=_o(B)),A}var Wn=64,El=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ga=24,Sl=32,jo=8,es=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ve("Predictor0","PredictorAdd0"),dt.Predictor0=function(){return 4278190080},dt.Predictor1=function(A){return A},dt.Predictor2=function(A,g,w){return g[w+0]},dt.Predictor3=function(A,g,w){return g[w+1]},dt.Predictor4=function(A,g,w){return g[w-1]},dt.Predictor5=function(A,g,w){return Ue(Ue(A,g[w+1]),g[w+0])},dt.Predictor6=function(A,g,w){return Ue(A,g[w-1])},dt.Predictor7=function(A,g,w){return Ue(A,g[w+0])},dt.Predictor8=function(A,g,w){return Ue(g[w-1],g[w+0])},dt.Predictor9=function(A,g,w){return Ue(g[w+0],g[w+1])},dt.Predictor10=function(A,g,w){return Ue(Ue(A,g[w-1]),Ue(g[w+0],g[w+1]))},dt.Predictor11=function(A,g,w){var B=g[w+0];return 0>=yr(B>>24&255,A>>24&255,(g=g[w-1])>>24&255)+yr(B>>16&255,A>>16&255,g>>16&255)+yr(B>>8&255,A>>8&255,g>>8&255)+yr(255&B,255&A,255&g)?B:A},dt.Predictor12=function(A,g,w){var B=g[w+0];return(Ye((A>>24&255)+(B>>24&255)-((g=g[w-1])>>24&255))<<24|Ye((A>>16&255)+(B>>16&255)-(g>>16&255))<<16|Ye((A>>8&255)+(B>>8&255)-(g>>8&255))<<8|Ye((255&A)+(255&B)-(255&g)))>>>0},dt.Predictor13=function(A,g,w){var B=g[w-1];return(lr((A=Ue(A,g[w+0]))>>24&255,B>>24&255)<<24|lr(A>>16&255,B>>16&255)<<16|lr(A>>8&255,B>>8&255)<<8|lr(A>>0&255,B>>0&255))>>>0};var hu=dt.PredictorAdd0;dt.PredictorAdd1=Lr,ve("Predictor2","PredictorAdd2"),ve("Predictor3","PredictorAdd3"),ve("Predictor4","PredictorAdd4"),ve("Predictor5","PredictorAdd5"),ve("Predictor6","PredictorAdd6"),ve("Predictor7","PredictorAdd7"),ve("Predictor8","PredictorAdd8"),ve("Predictor9","PredictorAdd9"),ve("Predictor10","PredictorAdd10"),ve("Predictor11","PredictorAdd11"),ve("Predictor12","PredictorAdd12"),ve("Predictor13","PredictorAdd13");var ja=dt.PredictorAdd2;_r("ColorIndexInverseTransform","MapARGB","32b",function(A){return A>>8&255},function(A){return A}),_r("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(A){return A},function(A){return A>>8&255});var Cc,bo=dt.ColorIndexInverseTransform,ga=dt.MapARGB,qa=dt.VP8LColorIndexInverseTransformAlpha,cA=dt.MapAlpha,Ys=dt.VP8LPredictorsAdd=[];Ys.length=16,(dt.VP8LPredictors=[]).length=16,(dt.VP8LPredictorsAdd_C=[]).length=16,(dt.VP8LPredictors_C=[]).length=16;var $r,xs,Ka,qo,Bs,$a,ks,Tl,Ec,Ko,Cs,Es,Wa,Il,Fl,$o,Ll,rs,wo,en,Fn,fi,bi,Wo,Zs,Pl,Xa,ph,gh=s(511),Td=s(2041),Hn=s(225),Ml=s(767),Ss=0,du=Td,Ul=Hn,Ts=Ml,Vi=gh,Rl=0,Ol=1,fu=2,pu=3,gu=4,uA=5,mh=6,Xo=7,AA=8,hA=9,dA=10,vp=[2,3,7],Id=[3,3,11],yh=[280,256,256,256,40],Fd=[0,1,1,1,0],fA=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],bp=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],xo=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Jo=8,pA=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],to=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],eo=null,zm=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Ld=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],wp=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Hm=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Pd=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],mu=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ma=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],je=[],Bo=[],Yo=[],xp=1,yu=2,ns=[],ro=[];ge("UpsampleRgbLinePair",hn,3),ge("UpsampleBgrLinePair",kr,3),ge("UpsampleRgbaLinePair",dn,4),ge("UpsampleBgraLinePair",Xr,4),ge("UpsampleArgbLinePair",Hi,4),ge("UpsampleRgba4444LinePair",Cr,2),ge("UpsampleRgb565LinePair",di,2);var $e=dt.UpsampleRgbLinePair,Md=dt.UpsampleBgrLinePair,Bp=dt.UpsampleRgbaLinePair,Ud=dt.UpsampleBgraLinePair,_h=dt.UpsampleArgbLinePair,Rd=dt.UpsampleRgba4444LinePair,Dl=dt.UpsampleRgb565LinePair,gA=16,_u=1<<gA-1,Co=-227,Un=482,mA=6,vu=(256<<mA)-1,Sc=0,Cp=s(256),Od=s(256),yA=s(256),ya=s(256),vh=s(Un-Co),ur=s(Un-Co);pa("YuvToRgbRow",hn,3),pa("YuvToBgrRow",kr,3),pa("YuvToRgbaRow",dn,4),pa("YuvToBgraRow",Xr,4),pa("YuvToArgbRow",Hi,4),pa("YuvToRgba4444Row",Cr,2),pa("YuvToRgb565Row",di,2);var Er=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],S=[0,2,8],c=[8,7,6,4,4,2,2,2,1,1,1,1],f=1;this.WebPDecodeRGBA=function(A,g,w,B,I){var L=Ol,R=new yo,O=new vn;R.ba=O,O.S=L,O.width=[O.width],O.height=[O.height];var N=O.width,H=O.height,K=new ln;if(K==null||A==null)var et=2;else t(K!=null),et=Va(A,g,w,K.width,K.height,K.Pd,K.Qd,K.format,null);if(et!=0?N=0:(N!=null&&(N[0]=K.width[0]),H!=null&&(H[0]=K.height[0]),N=1),N){O.width=O.width[0],O.height=O.height[0],B!=null&&(B[0]=O.width),I!=null&&(I[0]=O.height);t:{if(B=new Xs,(I=new uu).data=A,I.w=g,I.ha=w,I.kd=1,g=[0],t(I!=null),((A=Va(I.data,I.w,I.ha,null,null,null,g,null,I))==0||A==7)&&g[0]&&(A=4),(g=A)==0){if(t(R!=null),B.data=I.data,B.w=I.w+I.offset,B.ha=I.ha-I.offset,B.put=kt,B.ac=Bt,B.bc=Gt,B.ma=R,I.xa){if((A=cn())==null){R=1;break t}if(function(Y,Z){var yt=[0],at=[0],lt=[0];e:for(;;){if(Y==null)return 0;if(Z==null)return Y.a=2,0;if(Y.l=Z,Y.a=0,Kt(Y.m,Z.data,Z.w,Z.ha),!Ot(Y.m,yt,at,lt)){Y.a=3;break e}if(Y.xb=yu,Z.width=yt[0],Z.height=at[0],!br(yt[0],at[0],1,Y,null))break e;return 1}return t(Y.a!=0),0}(A,B)){if(B=(g=vo(B.width,B.height,R.Oa,R.ba))==0){e:{B=A;r:for(;;){if(B==null){B=0;break e}if(t(B.s.yc!=null),t(B.s.Ya!=null),t(0<B.s.Wb),t((w=B.l)!=null),t((I=w.ma)!=null),B.xb!=0){if(B.ca=I.ba,B.tb=I.tb,t(B.ca!=null),!Bc(I.Oa,w,pu)){B.a=2;break r}if(!jr(B,w.width)||w.da)break r;if((w.da||ke(B.ca.S))&&ne(),11>B.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),B.ca.f.kb.F!=null&&ne()),B.Pb&&0<B.s.ua&&B.s.vb.X==null&&!Je(B.s.vb,B.s.Wa.Xa)){B.a=1;break r}B.xb=0}if(!Qr(B,B.V,B.Ba,B.c,B.i,w.o,nr))break r;I.Dc=B.Ma,B=1;break e}t(B.a!=0),B=0}B=!B}B&&(g=A.a)}else g=A.a}else{if((A=new zn)==null){R=1;break t}if(A.Fa=I.na,A.P=I.P,A.qc=I.Sa,Nn(A,B)){if((g=vo(B.width,B.height,R.Oa,R.ba))==0){if(A.Aa=0,w=R.Oa,t((I=A)!=null),w!=null){if(0<(N=0>(N=w.Md)?0:100<N?255:255*N/100)){for(H=K=0;4>H;++H)12>(et=I.pb[H]).lc&&(et.ia=N*c[0>et.lc?0:et.lc]>>3),K|=et.ia;K&&(alert("todo:VP8InitRandom"),I.ia=1)}I.Ga=w.Id,100<I.Ga?I.Ga=100:0>I.Ga&&(I.Ga=0)}zo(A,B)||(g=A.a)}}else g=A.a}g==0&&R.Oa!=null&&R.Oa.fd&&(g=_o(R.ba))}R=g}L=R!=0?null:11>L?O.f.RGBA.eb:O.f.kb.y}else L=null;return L};var _=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function p(dt,Ft){for(var Tt="",ot=0;ot<4;ot++)Tt+=String.fromCharCode(dt[Ft++]);return Tt}function y(dt,Ft){return(dt[Ft+0]<<0|dt[Ft+1]<<8|dt[Ft+2]<<16)>>>0}function b(dt,Ft){return(dt[Ft+0]<<0|dt[Ft+1]<<8|dt[Ft+2]<<16|dt[Ft+3]<<24)>>>0}new d;var x=[0],C=[0],P=[],M=new d,k=r,z=function(dt,Ft){var Tt={},ot=0,ct=!1,wt=0,vt=0;if(Tt.frames=[],!function(xt,It,Ut,jt){for(var Vt=0;Vt<jt;Vt++)if(xt[It+Vt]!=Ut.charCodeAt(Vt))return!0;return!1}(dt,Ft,"RIFF",4)){var $t,Wt;for(b(dt,Ft+=4),Ft+=8;Ft<dt.length;){var Yt=p(dt,Ft),Kt=b(dt,Ft+=4);Ft+=4;var ee=Kt+(1&Kt);switch(Yt){case"VP8 ":case"VP8L":Tt.frames[ot]===void 0&&(Tt.frames[ot]={}),(it=Tt.frames[ot]).src_off=ct?vt:Ft-8,it.src_size=wt+Kt+8,ot++,ct&&(ct=!1,wt=0,vt=0);break;case"VP8X":(it=Tt.header={}).feature_flags=dt[Ft];var Zt=Ft+4;it.canvas_width=1+y(dt,Zt),Zt+=3,it.canvas_height=1+y(dt,Zt),Zt+=3;break;case"ALPH":ct=!0,wt=ee+8,vt=Ft-8;break;case"ANIM":(it=Tt.header).bgcolor=b(dt,Ft),Zt=Ft+4,it.loop_count=($t=dt)[(Wt=Zt)+0]<<0|$t[Wt+1]<<8,Zt+=2;break;case"ANMF":var we,it;(it=Tt.frames[ot]={}).offset_x=2*y(dt,Ft),Ft+=3,it.offset_y=2*y(dt,Ft),Ft+=3,it.width=1+y(dt,Ft),Ft+=3,it.height=1+y(dt,Ft),Ft+=3,it.duration=y(dt,Ft),Ft+=3,we=dt[Ft++],it.dispose=1&we,it.blend=we>>1&1}Yt!="ANMF"&&(Ft+=ee)}return Tt}}(k,0);z.response=k,z.rgbaoutput=!0,z.dataurl=!1;var V=z.header?z.header:null,$=z.frames?z.frames:null;if(V){V.loop_counter=V.loop_count,x=[V.canvas_height],C=[V.canvas_width];for(var tt=0;tt<$.length&&$[tt].blend!=0;tt++);}var pt=$[0],gt=M.WebPDecodeRGBA(k,pt.src_off,pt.src_size,C,x);pt.rgba=gt,pt.imgwidth=C[0],pt.imgheight=x[0];for(var mt=0;mt<C[0]*x[0]*4;mt++)P[mt]=gt[mt];return this.width=C,this.height=x,this.data=P,this}(function(r){var t=function(){return typeof M2=="function"},e=function(x,C,P,M){var k=4,z=a;switch(M){case r.image_compression.FAST:k=1,z=s;break;case r.image_compression.MEDIUM:k=6,z=o;break;case r.image_compression.SLOW:k=9,z=d}x=n(x,C,P,z);var V=M2(x,{level:k});return r.__addimage__.arrayBufferToBinaryString(V)},n=function(x,C,P,M){for(var k,z,V,$=x.length/C,tt=new Uint8Array(x.length+$),pt=y(),gt=0;gt<$;gt+=1){if(V=gt*C,k=x.subarray(V,V+C),M)tt.set(M(k,P,z),V+gt);else{for(var mt,dt=pt.length,Ft=[];mt<dt;mt+=1)Ft[mt]=pt[mt](k,P,z);var Tt=b(Ft.concat());tt.set(Ft[Tt],V+gt)}z=k}return tt},i=function(x){var C=Array.apply([],x);return C.unshift(0),C},s=function(x,C){var P,M=[],k=x.length;M[0]=1;for(var z=0;z<k;z+=1)P=x[z-C]||0,M[z+1]=x[z]-P+256&255;return M},a=function(x,C,P){var M,k=[],z=x.length;k[0]=2;for(var V=0;V<z;V+=1)M=P&&P[V]||0,k[V+1]=x[V]-M+256&255;return k},o=function(x,C,P){var M,k,z=[],V=x.length;z[0]=3;for(var $=0;$<V;$+=1)M=x[$-C]||0,k=P&&P[$]||0,z[$+1]=x[$]+256-(M+k>>>1)&255;return z},d=function(x,C,P){var M,k,z,V,$=[],tt=x.length;$[0]=4;for(var pt=0;pt<tt;pt+=1)M=x[pt-C]||0,k=P&&P[pt]||0,z=P&&P[pt-C]||0,V=p(M,k,z),$[pt+1]=x[pt]-V+256&255;return $},p=function(x,C,P){if(x===C&&C===P)return x;var M=Math.abs(C-P),k=Math.abs(x-P),z=Math.abs(x+C-P-P);return M<=k&&M<=z?x:k<=z?C:P},y=function(){return[i,s,a,o,d]},b=function(x){var C=x.map(function(P){return P.reduce(function(M,k){return M+Math.abs(k)},0)});return C.indexOf(Math.min.apply(null,C))};r.processPNG=function(x,C,P,M){var k,z,V,$,tt,pt,gt,mt,dt,Ft,Tt,ot,ct,wt,vt,$t=this.decode.FLATE_DECODE,Wt="";if(this.__addimage__.isArrayBuffer(x)&&(x=new Uint8Array(x)),this.__addimage__.isArrayBufferView(x)){if(x=(V=new Drt(x)).imgData,z=V.bits,k=V.colorSpace,tt=V.colors,[4,6].indexOf(V.colorType)!==-1){if(V.bits===8){dt=(mt=V.pixelBitlength==32?new Uint32Array(V.decodePixels().buffer):V.pixelBitlength==16?new Uint16Array(V.decodePixels().buffer):new Uint8Array(V.decodePixels().buffer)).length,Tt=new Uint8Array(dt*V.colors),Ft=new Uint8Array(dt);var Yt,Kt=V.pixelBitlength-V.bits;for(wt=0,vt=0;wt<dt;wt++){for(ct=mt[wt],Yt=0;Yt<Kt;)Tt[vt++]=ct>>>Yt&255,Yt+=V.bits;Ft[wt]=ct>>>Yt&255}}if(V.bits===16){dt=(mt=new Uint32Array(V.decodePixels().buffer)).length,Tt=new Uint8Array(dt*(32/V.pixelBitlength)*V.colors),Ft=new Uint8Array(dt*(32/V.pixelBitlength)),ot=V.colors>1,wt=0,vt=0;for(var ee=0;wt<dt;)ct=mt[wt++],Tt[vt++]=ct>>>0&255,ot&&(Tt[vt++]=ct>>>16&255,ct=mt[wt++],Tt[vt++]=ct>>>0&255),Ft[ee++]=ct>>>16&255;z=8}M!==r.image_compression.NONE&&t()?(x=e(Tt,V.width*V.colors,V.colors,M),gt=e(Ft,V.width,1,M)):(x=Tt,gt=Ft,$t=void 0)}if(V.colorType===3&&(k=this.color_spaces.INDEXED,pt=V.palette,V.transparency.indexed)){var Zt=V.transparency.indexed,we=0;for(wt=0,dt=Zt.length;wt<dt;++wt)we+=Zt[wt];if((we/=255)===dt-1&&Zt.indexOf(0)!==-1)$=[Zt.indexOf(0)];else if(we!==dt){for(mt=V.decodePixels(),Ft=new Uint8Array(mt.length),wt=0,dt=mt.length;wt<dt;wt++)Ft[wt]=Zt[mt[wt]];gt=e(Ft,V.width,1)}}var it=function(xt){var It;switch(xt){case r.image_compression.FAST:It=11;break;case r.image_compression.MEDIUM:It=13;break;case r.image_compression.SLOW:It=14;break;default:It=12}return It}(M);return $t===this.decode.FLATE_DECODE&&(Wt="/Predictor "+it+" "),Wt+="/Colors "+tt+" /BitsPerComponent "+z+" /Columns "+V.width,(this.__addimage__.isArrayBuffer(x)||this.__addimage__.isArrayBufferView(x))&&(x=this.__addimage__.arrayBufferToBinaryString(x)),(gt&&this.__addimage__.isArrayBuffer(gt)||this.__addimage__.isArrayBufferView(gt))&&(gt=this.__addimage__.arrayBufferToBinaryString(gt)),{alias:P,data:x,index:C,filter:$t,decodeParameters:Wt,transparency:$,palette:pt,sMask:gt,predictor:it,width:V.width,height:V.height,bitsPerComponent:z,colorSpace:k}}}})(Vr.API),function(r){r.processGIF89A=function(t,e,n,i){var s=new Nrt(t),a=s.width,o=s.height,d=[];s.decodeAndBlitFrameRGBA(0,d);var p={data:d,width:a,height:o},y=new j2(100).encode(p,100);return r.processJPEG.call(this,y,e,n,i)},r.processGIF87A=r.processGIF89A}(Vr.API),sc.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var t=0;t<r;t++){var e=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:n,blue:e,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},sc.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[r]()}catch(e){Ai.log("bit decode error:"+e)}},sc.prototype.bit1=function(){var r,t=Math.ceil(this.width/8),e=t%4;for(r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++)for(var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var d=this.palette[s>>7-o&1];this.data[a+4*o]=d.blue,this.data[a+4*o+1]=d.green,this.data[a+4*o+2]=d.red,this.data[a+4*o+3]=255}e!==0&&(this.pos+=4-e)}},sc.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),t=r%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<r;i++){var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+2*i*4,o=s>>4,d=15&s,p=this.palette[o];if(this.data[a]=p.blue,this.data[a+1]=p.green,this.data[a+2]=p.red,this.data[a+3]=255,2*i+1>=this.width)break;p=this.palette[d],this.data[a+4]=p.blue,this.data[a+4+1]=p.green,this.data[a+4+2]=p.red,this.data[a+4+3]=255}t!==0&&(this.pos+=4-t)}},sc.prototype.bit8=function(){for(var r=this.width%4,t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*n;if(i<this.palette.length){var a=this.palette[i];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}r!==0&&(this.pos+=4-r)}},sc.prototype.bit15=function(){for(var r=this.width%3,t=parseInt("11111",2),e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&t)/t*255|0,o=(s>>5&t)/t*255|0,d=(s>>10&t)/t*255|0,p=s>>15?255:0,y=n*this.width*4+4*i;this.data[y]=d,this.data[y+1]=o,this.data[y+2]=a,this.data[y+3]=p}this.pos+=r}},sc.prototype.bit16=function(){for(var r=this.width%3,t=parseInt("11111",2),e=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&t)/t*255|0,d=(a>>5&e)/e*255|0,p=(a>>11)/t*255|0,y=i*this.width*4+4*s;this.data[y]=p,this.data[y+1]=d,this.data[y+2]=o,this.data[y+3]=255}this.pos+=r}},sc.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var t=this.bottom_up?r:this.height-1-r,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*e;this.data[a]=s,this.data[a+1]=i,this.data[a+2]=n,this.data[a+3]=255}this.pos+=this.width%4}},sc.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var t=this.bottom_up?r:this.height-1-r,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*e;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=a}},sc.prototype.getData=function(){return this.data},function(r){r.processBMP=function(t,e,n,i){var s=new sc(t,!1),a=s.width,o=s.height,d={data:s.getData(),width:a,height:o},p=new j2(100).encode(d,100);return r.processJPEG.call(this,p,e,n,i)}}(Vr.API),wP.prototype.getData=function(){return this.data},function(r){r.processWEBP=function(t,e,n,i){var s=new wP(t),a=s.width,o=s.height,d={data:s.getData(),width:a,height:o},p=new j2(100).encode(d,100);return r.processJPEG.call(this,p,e,n,i)}}(Vr.API),Vr.API.processRGBA=function(r,t,e){for(var n=r.data,i=n.length,s=new Uint8Array(i/4*3),a=new Uint8Array(i/4),o=0,d=0,p=0;p<i;p+=4){var y=n[p],b=n[p+1],x=n[p+2],C=n[p+3];s[o++]=y,s[o++]=b,s[o++]=x,a[d++]=C}var P=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:P,index:t,alias:e,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},Vr.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Nf=Vr.API,Vy=Nf.getCharWidthsArray=function(r,t){var e,n,i=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),a=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:i.metadata.Unicode.widths,d=o.fof?o.fof:1,p=t.kerning?t.kerning:i.metadata.Unicode.kerning,y=p.fof?p.fof:1,b=t.doKerning!==!1,x=0,C=r.length,P=0,M=o[0]||d,k=[];for(e=0;e<C;e++)n=r.charCodeAt(e),typeof i.metadata.widthOfString=="function"?k.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+a*(1e3/s)||0)/1e3):(x=b&&Dn(p[n])==="object"&&!isNaN(parseInt(p[n][P],10))?p[n][P]/y:0,k.push((o[n]||M)/d+x)),P=n;return k},yP=Nf.getStringUnitWidth=function(r,t){var e=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return Nf.processArabic&&(r=Nf.processArabic(r)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(r,e,i)/e:Vy.apply(this,arguments).reduce(function(s,a){return s+a},0)},_P=function(r,t,e,n){for(var i=[],s=0,a=r.length,o=0;s!==a&&o+t[s]<e;)o+=t[s],s++;i.push(r.slice(0,s));var d=s;for(o=0;s!==a;)o+t[s]>n&&(i.push(r.slice(d,s)),o=0,d=s),o+=t[s],s++;return d!==s&&i.push(r.slice(d,s)),i},vP=function(r,t,e){e||(e={});var n,i,s,a,o,d,p,y=[],b=[y],x=e.textIndent||0,C=0,P=0,M=r.split(" "),k=Vy.apply(this,[" ",e])[0];if(d=e.lineIndent===-1?M[0].length+2:e.lineIndent||0){var z=Array(d).join(" "),V=[];M.map(function(tt){(tt=tt.split(/\s*\n/)).length>1?V=V.concat(tt.map(function(pt,gt){return(gt&&pt.length?`
`:"")+pt})):V.push(tt[0])}),M=V,d=yP.apply(this,[z,e])}for(s=0,a=M.length;s<a;s++){var $=0;if(n=M[s],d&&n[0]==`
`&&(n=n.substr(1),$=1),x+C+(P=(i=Vy.apply(this,[n,e])).reduce(function(tt,pt){return tt+pt},0))>t||$){if(P>t){for(o=_P.apply(this,[n,i,t-(x+C),t]),y.push(o.shift()),y=[o.pop()];o.length;)b.push([o.shift()]);P=i.slice(n.length-(y[0]?y[0].length:0)).reduce(function(tt,pt){return tt+pt},0)}else y=[n];b.push(y),x=P+d,C=k}else y.push(n),x+=C+P,C=k}return p=d?function(tt,pt){return(pt?z:"")+tt.join(" ")}:function(tt){return tt.join(" ")},b.map(p)},Nf.splitTextToSize=function(r,t,e){var n,i=(e=e||{}).fontSize||this.internal.getFontSize(),s=(function(y){if(y.widths&&y.kerning)return{widths:y.widths,kerning:y.kerning};var b=this.internal.getFont(y.fontName,y.fontStyle);return b.metadata.Unicode?{widths:b.metadata.Unicode.widths||{0:1},kerning:b.metadata.Unicode.kerning||{}}:{font:b.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,e);n=Array.isArray(r)?r:String(r).split(/\r?\n/);var a=1*this.internal.scaleFactor*t/i;s.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=e.lineIndent;var o,d,p=[];for(o=0,d=n.length;o<d;o++)p=p.concat(vP.apply(this,[n[o],a,s]));return p},function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",e={},n={},i=0;i<t.length;i++)e[t[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=t[i];var s=function(b){return"0x"+parseInt(b,10).toString(16)},a=r.__fontmetrics__.compress=function(b){var x,C,P,M,k=["{"];for(var z in b){if(x=b[z],isNaN(parseInt(z,10))?C="'"+z+"'":(z=parseInt(z,10),C=(C=s(z).slice(2)).slice(0,-1)+n[C.slice(-1)]),typeof x=="number")x<0?(P=s(x).slice(3),M="-"):(P=s(x).slice(2),M=""),P=M+P.slice(0,-1)+n[P.slice(-1)];else{if(Dn(x)!=="object")throw new Error("Don't know what to do with value type "+Dn(x)+".");P=a(x)}k.push(C+P)}return k.push("}"),k.join("")},o=r.__fontmetrics__.uncompress=function(b){if(typeof b!="string")throw new Error("Invalid argument passed to uncompress.");for(var x,C,P,M,k={},z=1,V=k,$=[],tt="",pt="",gt=b.length-1,mt=1;mt<gt;mt+=1)(M=b[mt])=="'"?x?(P=x.join(""),x=void 0):x=[]:x?x.push(M):M=="{"?($.push([V,P]),V={},P=void 0):M=="}"?((C=$.pop())[0][C[1]]=V,P=void 0,V=C[0]):M=="-"?z=-1:P===void 0?e.hasOwnProperty(M)?(tt+=e[M],P=parseInt(tt,16)*z,z=1,tt=""):tt+=M:e.hasOwnProperty(M)?(pt+=e[M],V[P]=parseInt(pt,16)*z,z=1,P=void 0,pt=""):pt+=M;return k},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},p={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},y={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(b){var x=b.font,C=y.Unicode[x.postScriptName];C&&(x.metadata.Unicode={},x.metadata.Unicode.widths=C.widths,x.metadata.Unicode.kerning=C.kerning);var P=p.Unicode[x.postScriptName];P&&(x.metadata.Unicode.encoding=P,x.encoding=P.codePages[0])}])}(Vr.API),function(r){var t=function(e){for(var n=e.length,i=new Uint8Array(n),s=0;s<n;s++)i[s]=e.charCodeAt(s);return i};r.API.events.push(["addFont",function(e){var n=void 0,i=e.font,s=e.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Vg(o)),a.metadata=r.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(i,n)}}])}(Vr),function(r){function t(){return(Hr.canvg?Promise.resolve(Hr.canvg):Promise.resolve().then(()=>Abt)).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e})}Vr.API.addSvgAsImage=function(e,n,i,s,a,o,d,p){if(isNaN(n)||isNaN(i))throw Ai.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(a))throw Ai.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var y=document.createElement("canvas");y.width=s,y.height=a;var b=y.getContext("2d");b.fillStyle="#fff",b.fillRect(0,0,y.width,y.height);var x={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},C=this;return t().then(function(P){return P.fromString(b,e,x)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(P){return P.render(x)}).then(function(){C.addImage(y.toDataURL("image/jpeg",1),n,i,s,a,d,p)})}}(),Vr.API.putTotalPages=function(r){var t,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(r,"g"),e=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(t,e);return this},Vr.API.viewerPreferences=function(r,t){var e;r=r||{},t=t||!1;var n,i,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),d=[],p=0,y=0,b=0;function x(P,M){var k,z=!1;for(k=0;k<P.length;k+=1)P[k]===M&&(z=!0);return z}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,r==="reset"||t===!0){var C=o.length;for(b=0;b<C;b+=1)e[o[b]].value=e[o[b]].defaultValue,e[o[b]].explicitSet=!1}if(Dn(r)==="object"){for(i in r)if(s=r[i],x(o,i)&&s!==void 0){if(e[i].type==="boolean"&&typeof s=="boolean")e[i].value=s;else if(e[i].type==="name"&&x(e[i].valueSet,s))e[i].value=s;else if(e[i].type==="integer"&&Number.isInteger(s))e[i].value=s;else if(e[i].type==="array"){for(p=0;p<s.length;p+=1)if(n=!0,s[p].length===1&&typeof s[p][0]=="number")d.push(String(s[p]-1));else if(s[p].length>1){for(y=0;y<s[p].length;y+=1)typeof s[p][y]!="number"&&(n=!1);n===!0&&d.push([s[p][0]-1,s[p][1]-1].join(" "))}e[i].value="["+d.join(" ")+"]"}else e[i].value=e[i].defaultValue;e[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var P,M=[];for(P in e)e[P].explicitSet===!0&&(e[P].type==="name"?M.push("/"+P+" /"+e[P].value):M.push("/"+P+" "+e[P].value));M.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+M.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=e,this},function(r){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),d=unescape(encodeURIComponent("</x:xmpmeta>")),p=s.length+a.length+o.length+i.length+d.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+p+" >>"),this.internal.write("stream"),this.internal.write(i+s+a+o+d),this.internal.write("endstream"),this.internal.write("endobj")},e=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",e),this.internal.events.subscribe("postPutResources",t)),this}}(Vr.API),function(r){var t=r.API,e=t.pdfEscape16=function(s,a){for(var o,d=a.metadata.Unicode.widths,p=["","0","00","000","0000"],y=[""],b=0,x=s.length;b<x;++b){if(o=a.metadata.characterToGlyph(s.charCodeAt(b)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=s.charCodeAt(b),d.indexOf(o)==-1&&(d.push(o),d.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return y.join("");o=o.toString(16),y.push(p[4-o.length],o)}return y.join("")},n=function(s){var a,o,d,p,y,b,x;for(y=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,d=[],b=0,x=(o=Object.keys(s).sort(function(C,P){return C-P})).length;b<x;b++)a=o[b],d.length>=100&&(y+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar`,d=[]),s[a]!==void 0&&s[a]!==null&&typeof s[a].toString=="function"&&(p=("0000"+s[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),d.push("<"+a+"><"+p+">"));return d.length&&(y+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar
`),y+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(a){var o=a.font,d=a.out,p=a.newObject,y=a.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="Identity-H"){for(var b=o.metadata.Unicode.widths,x=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),C="",P=0;P<x.length;P++)C+=String.fromCharCode(x[P]);var M=p();y({data:C,addLength1:!0,objectId:M}),d("endobj");var k=p();y({data:n(o.metadata.toUnicode),addLength1:!0,objectId:k}),d("endobj");var z=p();d("<<"),d("/Type /FontDescriptor"),d("/FontName /"+Lf(o.fontName)),d("/FontFile2 "+M+" 0 R"),d("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),d("/Flags "+o.metadata.flags),d("/StemV "+o.metadata.stemV),d("/ItalicAngle "+o.metadata.italicAngle),d("/Ascent "+o.metadata.ascender),d("/Descent "+o.metadata.decender),d("/CapHeight "+o.metadata.capHeight),d(">>"),d("endobj");var V=p();d("<<"),d("/Type /Font"),d("/BaseFont /"+Lf(o.fontName)),d("/FontDescriptor "+z+" 0 R"),d("/W "+r.API.PDFObject.convert(b)),d("/CIDToGIDMap /Identity"),d("/DW 1000"),d("/Subtype /CIDFontType2"),d("/CIDSystemInfo"),d("<<"),d("/Supplement 0"),d("/Registry (Adobe)"),d("/Ordering ("+o.encoding+")"),d(">>"),d(">>"),d("endobj"),o.objectNumber=p(),d("<<"),d("/Type /Font"),d("/Subtype /Type0"),d("/ToUnicode "+k+" 0 R"),d("/BaseFont /"+Lf(o.fontName)),d("/Encoding /"+o.encoding),d("/DescendantFonts ["+V+" 0 R]"),d(">>"),d("endobj"),o.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(a){var o=a.font,d=a.out,p=a.newObject,y=a.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var b=o.metadata.rawData,x="",C=0;C<b.length;C++)x+=String.fromCharCode(b[C]);var P=p();y({data:x,addLength1:!0,objectId:P}),d("endobj");var M=p();y({data:n(o.metadata.toUnicode),addLength1:!0,objectId:M}),d("endobj");var k=p();d("<<"),d("/Descent "+o.metadata.decender),d("/CapHeight "+o.metadata.capHeight),d("/StemV "+o.metadata.stemV),d("/Type /FontDescriptor"),d("/FontFile2 "+P+" 0 R"),d("/Flags 96"),d("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),d("/FontName /"+Lf(o.fontName)),d("/ItalicAngle "+o.metadata.italicAngle),d("/Ascent "+o.metadata.ascender),d(">>"),d("endobj"),o.objectNumber=p();for(var z=0;z<o.metadata.hmtx.widths.length;z++)o.metadata.hmtx.widths[z]=parseInt(o.metadata.hmtx.widths[z]*(1e3/o.metadata.head.unitsPerEm));d("<</Subtype/TrueType/Type/Font/ToUnicode "+M+" 0 R/BaseFont/"+Lf(o.fontName)+"/FontDescriptor "+k+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),d("endobj"),o.isAlreadyPutted=!0}})(s)}]);var i=function(s){var a,o=s.text||"",d=s.x,p=s.y,y=s.options||{},b=s.mutex||{},x=b.pdfEscape,C=b.activeFontKey,P=b.fonts,M=C,k="",z=0,V="",$=P[M].encoding;if(P[M].encoding!=="Identity-H")return{text:o,x:d,y:p,options:y,mutex:b};for(V=o,M=C,Array.isArray(o)&&(V=o[0]),z=0;z<V.length;z+=1)P[M].metadata.hasOwnProperty("cmap")&&(a=P[M].metadata.cmap.unicode.codeMap[V[z].charCodeAt(0)]),a||V[z].charCodeAt(0)<256&&P[M].metadata.hasOwnProperty("Unicode")?k+=V[z]:k+="";var tt="";return parseInt(M.slice(1))<14||$==="WinAnsiEncoding"?tt=x(k,M).split("").map(function(pt){return pt.charCodeAt(0).toString(16)}).join(""):$==="Identity-H"&&(tt=e(k,P[M])),b.isHex=!0,{text:tt,x:d,y:p,options:y,mutex:b}};t.events.push(["postProcessText",function(s){var a=s.text||"",o=[],d={text:a,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(a)){var p=0;for(p=0;p<a.length;p+=1)Array.isArray(a[p])&&a[p].length===3?o.push([i(Object.assign({},d,{text:a[p][0]})).text,a[p][1],a[p][2]]):o.push(i(Object.assign({},d,{text:a[p]})).text);s.text=o}else s.text=i(Object.assign({},d,{text:a})).text}])}(Vr),function(r){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0},r.addFileToVFS=function(e,n){return t.call(this),this.internal.vFS[e]=n,this},r.getFileFromVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0?this.internal.vFS[e]:null}}(Vr.API),function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(n){var i,s,a,o,d,p,y,b=t,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],C=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],P={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},M={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},k=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],z=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),V=!1,$=0;this.__bidiEngine__={};var tt=function(ot){var ct=ot.charCodeAt(),wt=ct>>8,vt=M[wt];return vt!==void 0?b[256*vt+(255&ct)]:wt===252||wt===253?"AL":z.test(wt)?"L":wt===8?"R":"N"},pt=function(ot){for(var ct,wt=0;wt<ot.length;wt++){if((ct=tt(ot.charAt(wt)))==="L")return!1;if(ct==="R")return!0}return!1},gt=function(ot,ct,wt,vt){var $t,Wt,Yt,Kt,ee=ct[vt];switch(ee){case"L":case"R":V=!1;break;case"N":case"AN":break;case"EN":V&&(ee="AN");break;case"AL":V=!0,ee="R";break;case"WS":ee="N";break;case"CS":vt<1||vt+1>=ct.length||($t=wt[vt-1])!=="EN"&&$t!=="AN"||(Wt=ct[vt+1])!=="EN"&&Wt!=="AN"?ee="N":V&&(Wt="AN"),ee=Wt===$t?Wt:"N";break;case"ES":ee=($t=vt>0?wt[vt-1]:"B")==="EN"&&vt+1<ct.length&&ct[vt+1]==="EN"?"EN":"N";break;case"ET":if(vt>0&&wt[vt-1]==="EN"){ee="EN";break}if(V){ee="N";break}for(Yt=vt+1,Kt=ct.length;Yt<Kt&&ct[Yt]==="ET";)Yt++;ee=Yt<Kt&&ct[Yt]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(Kt=ct.length,Yt=vt+1;Yt<Kt&&ct[Yt]==="NSM";)Yt++;if(Yt<Kt){var Zt=ot[vt],we=Zt>=1425&&Zt<=2303||Zt===64286;if($t=ct[Yt],we&&($t==="R"||$t==="AL")){ee="R";break}}}ee=vt<1||($t=ct[vt-1])==="B"?"N":wt[vt-1];break;case"B":V=!1,i=!0,ee=$;break;case"S":s=!0,ee="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":V=!1;break;case"BN":ee="N"}return ee},mt=function(ot,ct,wt){var vt=ot.split("");return wt&&dt(vt,wt,{hiLevel:$}),vt.reverse(),ct&&ct.reverse(),vt.join("")},dt=function(ot,ct,wt){var vt,$t,Wt,Yt,Kt,ee=-1,Zt=ot.length,we=0,it=[],xt=$?C:x,It=[];for(V=!1,i=!1,s=!1,$t=0;$t<Zt;$t++)It[$t]=tt(ot[$t]);for(Wt=0;Wt<Zt;Wt++){if(Kt=we,it[Wt]=gt(ot,It,it,Wt),vt=240&(we=xt[Kt][P[it[Wt]]]),we&=15,ct[Wt]=Yt=xt[we][5],vt>0)if(vt===16){for($t=ee;$t<Wt;$t++)ct[$t]=1;ee=-1}else ee=-1;if(xt[we][6])ee===-1&&(ee=Wt);else if(ee>-1){for($t=ee;$t<Wt;$t++)ct[$t]=Yt;ee=-1}It[Wt]==="B"&&(ct[Wt]=0),wt.hiLevel|=Yt}s&&function(Ut,jt,Vt){for(var re=0;re<Vt;re++)if(Ut[re]==="S"){jt[re]=$;for(var te=re-1;te>=0&&Ut[te]==="WS";te--)jt[te]=$}}(It,ct,Zt)},Ft=function(ot,ct,wt,vt,$t){if(!($t.hiLevel<ot)){if(ot===1&&$===1&&!i)return ct.reverse(),void(wt&&wt.reverse());for(var Wt,Yt,Kt,ee,Zt=ct.length,we=0;we<Zt;){if(vt[we]>=ot){for(Kt=we+1;Kt<Zt&&vt[Kt]>=ot;)Kt++;for(ee=we,Yt=Kt-1;ee<Yt;ee++,Yt--)Wt=ct[ee],ct[ee]=ct[Yt],ct[Yt]=Wt,wt&&(Wt=wt[ee],wt[ee]=wt[Yt],wt[Yt]=Wt);we=Kt}we++}}},Tt=function(ot,ct,wt){var vt=ot.split(""),$t={hiLevel:$};return wt||(wt=[]),dt(vt,wt,$t),function(Wt,Yt,Kt){if(Kt.hiLevel!==0&&y)for(var ee,Zt=0;Zt<Wt.length;Zt++)Yt[Zt]===1&&(ee=k.indexOf(Wt[Zt]))>=0&&(Wt[Zt]=k[ee+1])}(vt,wt,$t),Ft(2,vt,ct,wt,$t),Ft(1,vt,ct,wt,$t),vt.join("")};return this.__bidiEngine__.doBidiReorder=function(ot,ct,wt){if(function($t,Wt){if(Wt)for(var Yt=0;Yt<$t.length;Yt++)Wt[Yt]=Yt;o===void 0&&(o=pt($t)),p===void 0&&(p=pt($t))}(ot,ct),a||!d||p)if(a&&d&&o^p)$=o?1:0,ot=mt(ot,ct,wt);else if(!a&&d&&p)$=o?1:0,ot=Tt(ot,ct,wt),ot=mt(ot,ct);else if(!a||o||d||p){if(a&&!d&&o^p)ot=mt(ot,ct),o?($=0,ot=Tt(ot,ct,wt)):($=1,ot=Tt(ot,ct,wt),ot=mt(ot,ct));else if(a&&o&&!d&&p)$=1,ot=Tt(ot,ct,wt),ot=mt(ot,ct);else if(!a&&!d&&o^p){var vt=y;o?($=1,ot=Tt(ot,ct,wt),$=0,y=!1,ot=Tt(ot,ct,wt),y=vt):($=0,ot=Tt(ot,ct,wt),ot=mt(ot,ct),$=1,y=!1,ot=Tt(ot,ct,wt),y=vt,ot=mt(ot,ct))}}else $=0,ot=Tt(ot,ct,wt);else $=o?1:0,ot=Tt(ot,ct,wt);return ot},this.__bidiEngine__.setOptions=function(ot){ot&&(a=ot.isInputVisual,d=ot.isOutputVisual,o=ot.isInputRtl,p=ot.isOutputRtl,y=ot.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],e=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(n){var i=n.text,s=(n.x,n.y,n.options||{}),a=(n.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,e.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(a=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?a.push([e.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):a.push([e.doBidiReorder(i[o])]);n.text=a}else n.text=e.doBidiReorder(i);e.setOptions({isInputVisual:!0})}])}(Vr),Vr.API.TTFFont=function(){function r(t){var e;if(this.rawData=t,e=this.contents=new KA(t),this.contents.pos=4,e.readString(4)==="ttcf")throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new Zrt(this),this.registerTTF()}return r.open=function(t){return new r(t)},r.prototype.parse=function(){return this.directory=new krt(this.contents),this.head=new zrt(this),this.name=new qrt(this),this.cmap=new BP(this),this.toUnicode={},this.hhea=new Hrt(this),this.maxp=new Krt(this),this.hmtx=new $rt(this),this.post=new Grt(this),this.os2=new Vrt(this),this.loca=new Yrt(this),this.glyf=new Wrt(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var t,e,n,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,o,d,p;for(p=[],a=0,o=(d=this.bbox).length;a<o;a++)t=d[a],p.push(Math.round(t*this.scaleFactor));return p}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(e=i>>16)&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(t){var e;return((e=this.cmap.unicode)!=null?e.codeMap[t]:void 0)||0},r.prototype.widthOfGlyph=function(t){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*e},r.prototype.widthOfString=function(t,e,n){var i,s,a,o;for(a=0,s=0,o=(t=""+t).length;0<=o?s<o:s>o;s=0<=o?++s:--s)i=t.charCodeAt(s),a+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/e)||0;return a*(e/1e3)},r.prototype.lineHeight=function(t,e){var n;return e==null&&(e=!1),n=e?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},r}();var oc,KA=function(){function r(t){this.data=t??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(t){return this.data[this.pos++]=t},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},r.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},r.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},r.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},r.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},r.prototype.readString=function(t){var e,n;for(n=[],e=0;0<=t?e<t:e>t;e=0<=t?++e:--e)n[e]=String.fromCharCode(this.readByte());return n.join("")},r.prototype.writeString=function(t){var e,n,i;for(i=[],e=0,n=t.length;0<=n?e<n:e>n;e=0<=n?++e:--e)i.push(this.writeByte(t.charCodeAt(e)));return i},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(t){return this.writeInt16(t)},r.prototype.readLongLong=function(){var t,e,n,i,s,a,o,d;return t=this.readByte(),e=this.readByte(),n=this.readByte(),i=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),d=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^s)+65536*(255^a)+256*(255^o)+(255^d)+1):72057594037927940*t+281474976710656*e+1099511627776*n+4294967296*i+16777216*s+65536*a+256*o+d},r.prototype.writeLongLong=function(t){var e,n;return e=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(t){return this.writeInt32(t)},r.prototype.read=function(t){var e,n;for(e=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)e.push(this.readByte());return e},r.prototype.write=function(t){var e,n,i,s;for(s=[],n=0,i=t.length;n<i;n++)e=t[n],s.push(this.writeByte(e));return s},r}(),krt=function(){var r;function t(e){var n,i,s;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)n={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(e){var n,i,s,a,o,d,p,y,b,x,C,P,M;for(M in C=Object.keys(e).length,d=Math.log(2),b=16*Math.floor(Math.log(C)/d),a=Math.floor(b/d),y=16*C-b,(i=new KA).writeInt(this.scalarType),i.writeShort(C),i.writeShort(b),i.writeShort(a),i.writeShort(y),s=16*C,p=i.pos+s,o=null,P=[],e)for(x=e[M],i.writeString(M),i.writeInt(r(x)),i.writeInt(p),i.writeInt(x.length),P=P.concat(x),M==="head"&&(o=p),p+=x.length;p%4;)P.push(0),p++;return i.write(P),n=2981146554-r(i.data),i.pos=o+8,i.writeUInt32(n),i.data},r=function(e){var n,i,s,a;for(e=CP.call(e);e.length%4;)e.push(0);for(s=new KA(e),i=0,n=0,a=e.length;n<a;n=n+=4)i+=s.readUInt32();return 4294967295&i},t}(),Qrt={}.hasOwnProperty,Xc=function(r,t){for(var e in t)Qrt.call(t,e)&&(r[e]=t[e]);function n(){this.constructor=r}return n.prototype=t.prototype,r.prototype=new n,r.__super__=t.prototype,r};oc=function(){function r(t){var e;this.file=t,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r}();var zrt=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Xc(t,oc),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new KA).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t}(),xP=function(){function r(t,e){var n,i,s,a,o,d,p,y,b,x,C,P,M,k,z,V,$;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=e+t.readInt(),b=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(d=0;d<256;++d)this.codeMap[d]=t.readByte();break;case 4:for(C=t.readUInt16(),x=C/2,t.pos+=6,s=function(){var tt,pt;for(pt=[],d=tt=0;0<=x?tt<x:tt>x;d=0<=x?++tt:--tt)pt.push(t.readUInt16());return pt}(),t.pos+=2,M=function(){var tt,pt;for(pt=[],d=tt=0;0<=x?tt<x:tt>x;d=0<=x?++tt:--tt)pt.push(t.readUInt16());return pt}(),p=function(){var tt,pt;for(pt=[],d=tt=0;0<=x?tt<x:tt>x;d=0<=x?++tt:--tt)pt.push(t.readUInt16());return pt}(),y=function(){var tt,pt;for(pt=[],d=tt=0;0<=x?tt<x:tt>x;d=0<=x?++tt:--tt)pt.push(t.readUInt16());return pt}(),i=(this.length-t.pos+this.offset)/2,o=function(){var tt,pt;for(pt=[],d=tt=0;0<=i?tt<i:tt>i;d=0<=i?++tt:--tt)pt.push(t.readUInt16());return pt}(),d=z=0,$=s.length;z<$;d=++z)for(k=s[d],n=V=P=M[d];P<=k?V<=k:V>=k;n=P<=k?++V:--V)y[d]===0?a=n+p[d]:(a=o[y[d]/2+(n-P)-(x-d)]||0)!==0&&(a+=p[d]),this.codeMap[n]=65535&a}t.pos=b}return r.encode=function(t,e){var n,i,s,a,o,d,p,y,b,x,C,P,M,k,z,V,$,tt,pt,gt,mt,dt,Ft,Tt,ot,ct,wt,vt,$t,Wt,Yt,Kt,ee,Zt,we,it,xt,It,Ut,jt,Vt,re,te,Ce,Te,De;switch(vt=new KA,a=Object.keys(t).sort(function(Qe,Je){return Qe-Je}),e){case"macroman":for(M=0,k=function(){var Qe=[];for(P=0;P<256;++P)Qe.push(0);return Qe}(),V={0:0},s={},$t=0,ee=a.length;$t<ee;$t++)V[te=t[i=a[$t]]]==null&&(V[te]=++M),s[i]={old:t[i],new:V[t[i]]},k[i]=V[t[i]];return vt.writeUInt16(1),vt.writeUInt16(0),vt.writeUInt32(12),vt.writeUInt16(0),vt.writeUInt16(262),vt.writeUInt16(0),vt.write(k),{charMap:s,subtable:vt.data,maxGlyphID:M+1};case"unicode":for(ct=[],b=[],$=0,V={},n={},z=p=null,Wt=0,Zt=a.length;Wt<Zt;Wt++)V[pt=t[i=a[Wt]]]==null&&(V[pt]=++$),n[i]={old:pt,new:V[pt]},o=V[pt]-i,z!=null&&o===p||(z&&b.push(z),ct.push(i),p=o),z=i;for(z&&b.push(z),b.push(65535),ct.push(65535),Tt=2*(Ft=ct.length),dt=2*Math.pow(Math.log(Ft)/Math.LN2,2),x=Math.log(dt/2)/Math.LN2,mt=2*Ft-dt,d=[],gt=[],C=[],P=Yt=0,we=ct.length;Yt<we;P=++Yt){if(ot=ct[P],y=b[P],ot===65535){d.push(0),gt.push(0);break}if(ot-(wt=n[ot].new)>=32768)for(d.push(0),gt.push(2*(C.length+Ft-P)),i=Kt=ot;ot<=y?Kt<=y:Kt>=y;i=ot<=y?++Kt:--Kt)C.push(n[i].new);else d.push(wt-ot),gt.push(0)}for(vt.writeUInt16(3),vt.writeUInt16(1),vt.writeUInt32(12),vt.writeUInt16(4),vt.writeUInt16(16+8*Ft+2*C.length),vt.writeUInt16(0),vt.writeUInt16(Tt),vt.writeUInt16(dt),vt.writeUInt16(x),vt.writeUInt16(mt),Vt=0,it=b.length;Vt<it;Vt++)i=b[Vt],vt.writeUInt16(i);for(vt.writeUInt16(0),re=0,xt=ct.length;re<xt;re++)i=ct[re],vt.writeUInt16(i);for(Ce=0,It=d.length;Ce<It;Ce++)o=d[Ce],vt.writeUInt16(o);for(Te=0,Ut=gt.length;Te<Ut;Te++)tt=gt[Te],vt.writeUInt16(tt);for(De=0,jt=C.length;De<jt;De++)M=C[De],vt.writeUInt16(M);return{charMap:n,subtable:vt.data,maxGlyphID:$+1}}},r}(),BP=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Xc(t,oc),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,i,s;for(e.pos=this.offset,this.version=e.readUInt16(),s=e.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=s?i<s:i>s;i=0<=s?++i:--i)n=new xP(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var i,s;return n==null&&(n="macroman"),i=xP.encode(e,n),(s=new KA).writeUInt16(0),s.writeUInt16(1),i.table=s.data.concat(i.subtable),i},t}(),Hrt=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Xc(t,oc),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),Vrt=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Xc(t,oc),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(e.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(e.readInt());return i}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(e.readInt());return i}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),Grt=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Xc(t,oc),t.prototype.tag="post",t.prototype.parse=function(e){var n,i,s;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:break;case 131072:var a;for(i=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],s=[];e.pos<this.offset+this.length;)n=e.readByte(),s.push(this.names.push(e.readString(n)));return s;case 151552:return i=e.readUInt16(),this.offsets=e.read(i);case 196608:break;case 262144:return this.map=(function(){var o,d,p;for(p=[],a=o=0,d=this.file.maxp.numGlyphs;0<=d?o<d:o>d;a=0<=d?++o:--o)p.push(e.readUInt32());return p}).call(this)}},t}(),jrt=function(r,t){this.raw=r,this.length=r.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},qrt=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Xc(t,oc),t.prototype.tag="name",t.prototype.parse=function(e){var n,i,s,a,o,d,p,y,b,x,C;for(e.pos=this.offset,e.readShort(),n=e.readShort(),d=e.readShort(),i=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)i.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+d+e.readShort()});for(p={},a=b=0,x=i.length;b<x;a=++b)s=i[a],e.pos=s.offset,y=e.readString(s.length),o=new jrt(y,s),p[C=s.nameID]==null&&(p[C]=[]),p[s.nameID].push(o);this.strings=p,this.copyright=p[0],this.fontFamily=p[1],this.fontSubfamily=p[2],this.uniqueSubfamily=p[3],this.fontName=p[4],this.version=p[5];try{this.postscriptName=p[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=p[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=p[7],this.manufacturer=p[8],this.designer=p[9],this.description=p[10],this.vendorUrl=p[11],this.designerUrl=p[12],this.license=p[13],this.licenseUrl=p[14],this.preferredFamily=p[15],this.preferredSubfamily=p[17],this.compatibleFull=p[18],this.sampleText=p[19]},t}(),Krt=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Xc(t,oc),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),$rt=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Xc(t,oc),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,i,s,a,o,d,p;for(e.pos=this.offset,this.metrics=[],n=0,d=this.file.hhea.numberOfMetrics;0<=d?n<d:n>d;n=0<=d?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var y,b;for(b=[],n=y=0;0<=s?y<s:y>s;n=0<=s?++y:--y)b.push(e.readInt16());return b}(),this.widths=(function(){var y,b,x,C;for(C=[],y=0,b=(x=this.metrics).length;y<b;y++)a=x[y],C.push(a.advance);return C}).call(this),i=this.widths[this.widths.length-1],p=[],n=o=0;0<=s?o<s:o>s;n=0<=s?++o:--o)p.push(this.widths.push(i));return p},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),CP=[].slice,Wrt=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Xc(t,oc),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,i,s,a,o,d,p,y,b,x;return e in this.cache?this.cache[e]:(a=this.file.loca,n=this.file.contents,i=a.indexOf(e),(s=a.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+i,o=(d=new KA(n.read(s))).readShort(),y=d.readShort(),x=d.readShort(),p=d.readShort(),b=d.readShort(),this.cache[e]=o===-1?new Jrt(d,y,x,p,b):new Xrt(d,o,y,x,p,b),this.cache[e]))},t.prototype.encode=function(e,n,i){var s,a,o,d,p;for(o=[],a=[],d=0,p=n.length;d<p;d++)s=e[n[d]],a.push(o.length),s&&(o=o.concat(s.encode(i)));return a.push(o.length),{table:o,offsets:a}},t}(),Xrt=function(){function r(t,e,n,i,s,a){this.raw=t,this.numberOfContours=e,this.xMin=n,this.yMin=i,this.xMax=s,this.yMax=a,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r}(),Jrt=function(){function r(t,e,n,i,s){var a,o;for(this.raw=t,this.xMin=e,this.yMin=n,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return r.prototype.encode=function(){var t,e,n;for(e=new KA(CP.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)e.pos=this.glyphOffsets[t];return e.data},r}(),Yrt=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Xc(t,oc),t.prototype.tag="loca",t.prototype.parse=function(e){var n,i;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var s,a;for(a=[],i=0,s=this.length;i<s;i+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],i=0,s=this.length;i<s;i+=4)a.push(e.readUInt32());return a}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var i=new Uint32Array(this.offsets.length),s=0,a=0,o=0;o<i.length;++o)if(i[o]=s,a<n.length&&n[a]==o){++a,i[o]=s;var d=this.offsets[o],p=this.offsets[o+1]-d;p>0&&(s+=p)}for(var y=new Array(4*i.length),b=0;b<i.length;++b)y[4*b+3]=255&i[b],y[4*b+2]=(65280&i[b])>>8,y[4*b+1]=(16711680&i[b])>>16,y[4*b]=(4278190080&i[b])>>24;return y},t}(),Zrt=function(){function r(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var t,e,n,i,s;for(e in i=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[e],t[e]=i[n];return t},r.prototype.glyphsFor=function(t){var e,n,i,s,a,o,d;for(i={},a=0,o=t.length;a<o;a++)i[s=t[a]]=this.font.glyf.glyphFor(s);for(s in e=[],i)(n=i[s])!=null&&n.compound&&e.push.apply(e,n.glyphIDs);if(e.length>0)for(s in d=this.glyphsFor(e))n=d[s],i[s]=n;return i},r.prototype.encode=function(t,e){var n,i,s,a,o,d,p,y,b,x,C,P,M,k,z;for(i in n=BP.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(t),C={0:0},z=n.charMap)C[(d=z[i]).old]=d.new;for(P in x=n.maxGlyphID,a)P in C||(C[P]=x++);return y=function(V){var $,tt;for($ in tt={},V)tt[V[$]]=$;return tt}(C),b=Object.keys(y).sort(function(V,$){return V-$}),M=function(){var V,$,tt;for(tt=[],V=0,$=b.length;V<$;V++)o=b[V],tt.push(y[o]);return tt}(),s=this.font.glyf.encode(a,M,C),p=this.font.loca.encode(s.offsets,M),k={cmap:this.font.cmap.raw(),glyf:s.table,loca:p,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(k["OS/2"]=this.font.os2.raw()),this.font.directory.encode(k)},r}();Vr.API.PDFObject=function(){var r;function t(){}return r=function(e,n){return(Array(n+1).join("0")+e).slice(-n)},t.convert=function(e){var n,i,s,a;if(Array.isArray(e))return"["+function(){var o,d,p;for(p=[],o=0,d=e.length;o<d;o++)n=e[o],p.push(t.convert(n));return p}().join(" ")+"]";if(typeof e=="string")return"/"+e;if(e!=null&&e.isString)return"("+e+")";if(e instanceof Date)return"(D:"+r(e.getUTCFullYear(),4)+r(e.getUTCMonth(),2)+r(e.getUTCDate(),2)+r(e.getUTCHours(),2)+r(e.getUTCMinutes(),2)+r(e.getUTCSeconds(),2)+"Z)";if({}.toString.call(e)==="[object Object]"){for(i in s=["<<"],e)a=e[i],s.push("/"+i+" "+t.convert(a));return s.push(">>"),s.join(`
`)}return""+e},t}();const q2={"circle-radius":8,"circle-color":"red","circle-stroke-width":1,"circle-stroke-color":"black"},K2={textSize:16,textHaloColor:"#FFFFFF",textHaloWidth:.8,textColor:"#000000",fallbackTextFont:["Open Sans Regular"]};let tnt=class{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Zh.A4,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:300,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Vu.PNG,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:If.mm,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"map",o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:"maplibregl-marker",d=arguments.length>7&&arguments[7]!==void 0?arguments[7]:q2,p=arguments.length>8&&arguments[8]!==void 0?arguments[8]:"maplibregl-ctrl-attrib-inner",y=arguments.length>9&&arguments[9]!==void 0?arguments[9]:K2;On(this,"map"),On(this,"width"),On(this,"height"),On(this,"dpi"),On(this,"format"),On(this,"unit"),On(this,"fileName"),On(this,"markerClassName"),On(this,"markerCirclePaint"),On(this,"attributionClassName"),On(this,"attributionStyle"),this.map=t,this.width=e[0],this.height=e[1],this.dpi=n,this.format=i,this.unit=s,this.fileName=a,this.markerClassName=o,this.markerCirclePaint=d,this.attributionClassName=p,this.attributionStyle=y}renderMapPost(t){return t}getMarkers(){return this.map.getCanvasContainer().getElementsByClassName(this.markerClassName)}renderMarkers(t){const e=this.getMarkers();for(let n=0;n<e.length;n++){const i=e.item(n);if(!i)continue;const s=i.getAttribute("style");if(!s)continue;const a=/translate\(([^,]+)px,\s*([^,]+)px\)/,o=s.match(a);if(!o)continue;const d=parseInt(o[1]),p=parseInt(o[2]),y=this.map.unproject([d,p]),b=`point${n}`;t.addSource(b,{type:"geojson",data:{type:"Point",coordinates:[y.lng,y.lat]}}),t.addLayer({id:b,source:b,type:"circle",paint:this.markerCirclePaint})}return t}generate(){const t=this;JsLoadingOverlay.show({overlayBackgroundColor:"#5D5959",overlayOpacity:"0.6",spinnerIcon:"ball-spin",spinnerColor:"#2400FD",spinnerSize:"2x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetX:0,offsetY:0,containerID:null,lockScroll:!1,overlayZIndex:9998,spinnerZIndex:9999});const e=window.devicePixelRatio;Object.defineProperty(window,"devicePixelRatio",{get(){return t.dpi/96}});const n=document.createElement("div");n.className="hidden-map",document.body.appendChild(n);const i=document.createElement("div");i.style.width=this.toPixels(this.width),i.style.height=this.toPixels(this.height),n.appendChild(i);const s=this.map.getStyle();if(s&&s.sources){const o=s.sources;Object.keys(o).forEach(d=>{const p=o[d];Object.keys(p).forEach(y=>{p[y]||delete p[y]})})}let a=this.getRenderedMap(i,s);a.once("idle",()=>{this.addAttributions(a)?a.once("idle",()=>{a=this.renderMapPost(a),this.getMarkers().length===0?this.exportImage(a,n,e):(a=this.renderMarkers(a),a.once("idle",()=>{this.exportImage(a,n,e)}))}):(a=this.renderMapPost(a),this.getMarkers().length===0?this.exportImage(a,n,e):(a=this.renderMarkers(a),a.once("idle",()=>{this.exportImage(a,n,e)})))})}stripHtml(t){const e=document.createElement("div");return e.innerHTML=t,e.textContent||e.innerText||""}addAttributions(t){if(!this.map.getStyle().glyphs)return!1;const e=t.getContainer(),n=parseInt(e.style.width.replace("px",""))-5,i=parseInt(e.style.height.replace("px",""))-5,s=[n,i],a=t.unproject(s),o=e.getElementsByClassName(this.attributionClassName),d=[];if((o==null?void 0:o.length)>0){const C=o.item(0);if(C)for(let P=0;P<C.children.length;P++){const M=C.children.item(P);M&&d.push(this.stripHtml(M.outerHTML))}}else{const C=this.map.getStyle().sources;Object.keys(C).forEach(P=>{const M=C[P];if("attribution"in M){const k=M.attribution;d.push(this.stripHtml(k))}})}if(d.length===0)return!1;const p=d.join(" | "),y="attribution";t.addSource(y,{type:"geojson",data:{type:"Feature",geometry:{type:"Point",coordinates:[a.lng,a.lat]},properties:{attribution:p}}});const b=this.map.getStyle().layers.filter(C=>C.type==="symbol"&&C.layout&&"text-font"in C.layout),x=b.length>0&&b[0].layout?b[0].layout["text-font"]:this.attributionStyle.fallbackTextFont;return t.addLayer({id:y,source:y,type:"symbol",layout:{"text-field":["get","attribution"],"text-font":x,"text-max-width":parseInt(`${n/this.attributionStyle.textSize}`),"text-anchor":"bottom-right","text-justify":"right","text-size":this.attributionStyle.textSize},paint:{"text-halo-color":this.attributionStyle.textHaloColor,"text-halo-width":this.attributionStyle.textHaloWidth,"text-color":this.attributionStyle.textColor}}),!0}exportImage(t,e,n){var i;const s=t.getCanvas(),a=`${this.fileName}.${this.format}`;switch(this.format){case Vu.PNG:this.toPNG(s,a);break;case Vu.JPEG:this.toJPEG(s,a);break;case Vu.PDF:this.toPDF(t,a);break;case Vu.SVG:this.toSVG(s,a);break;default:console.error(`Invalid file format: ${this.format}`);break}t.remove(),(i=e.parentNode)==null||i.removeChild(e),Object.defineProperty(window,"devicePixelRatio",{get(){return n}}),e.remove(),JsLoadingOverlay.hide()}toPNG(t,e){const n=document.createElement("a");n.href=t.toDataURL(),n.download=e,n.click(),n.remove()}toJPEG(t,e){const n=t.toDataURL("image/jpeg",.85),i=document.createElement("a");i.href=n,i.download=e,i.click(),i.remove()}toPDF(t,e){const n=t.getCanvas(),i=new Vr({orientation:this.width>this.height?"l":"p",unit:this.unit,compress:!0,format:[this.width,this.height]});i.addImage(n.toDataURL("image/png"),"png",0,0,this.width,this.height,void 0,"FAST");const{lng:s,lat:a}=t.getCenter();i.setProperties({title:t.getStyle().name,subject:`center: [${s}, ${a}], zoom: ${t.getZoom()}`,creator:"Mapbox GL Export Plugin",author:"(c)Mapbox, (c)OpenStreetMap"}),i.save(e)}toSVG(t,e){const n=t.toDataURL("image/png"),i=Number(this.toPixels(this.width,this.dpi).replace("px","")),s=Number(this.toPixels(this.height,this.dpi).replace("px","")),a=`
    <svg xmlns="http://www.w3.org/2000/svg" 
      xmlns:xlink="http://www.w3.org/1999/xlink" 
      version="1.1" 
      width="${i}" 
      height="${s}" 
      viewBox="0 0 ${i} ${s}" 
      xml:space="preserve">
        <image style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(0,0,0); fill-rule: nonzero; opacity: 1;"  
      xlink:href="${n}" width="${i}" height="${s}"></image>
    </svg>`,o=document.createElement("a");o.href=`data:application/xml,${encodeURIComponent(a)}`,o.download=e,o.click(),o.remove()}toPixels(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:96;return this.unit===If.mm&&(e/=25.4),`${e*t}px`}},ent=class extends tnt{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Zh.A4,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:300,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Vu.PNG,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:If.mm,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"map",o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:q2,d=arguments.length>7&&arguments[7]!==void 0?arguments[7]:K2;super(t,e,n,i,s,a,"maplibregl-marker",o,"maplibregl-ctrl-attrib-inner",d)}getRenderedMap(t,e){const n=new BS.Map({container:t,style:e,center:this.map.getCenter(),zoom:this.map.getZoom(),bearing:this.map.getBearing(),pitch:this.map.getPitch(),interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,transformRequest:this.map._requestManager._transformRequestFn});this.map.getTerrain()&&(n.setMaxPitch(85),n.setPitch(this.map.getPitch()));const i=(this.map.style.imageManager||{}).images||[];return Object.keys(i).forEach(s=>{n.addImage(s,i[s].data)}),n}renderMapPost(t){const e=this.map.getTerrain();return e&&t.setTerrain({source:e.source,exaggeration:e.exaggeration}),t}},rnt=class{constructor(t){On(this,"controlContainer"),On(this,"exportContainer"),On(this,"crosshair"),On(this,"printableArea"),On(this,"map"),On(this,"exportButton"),On(this,"options",{PageSize:Zh.A4,PageOrientation:Ng.Landscape,Format:Vu.PDF,DPI:x2[300],Crosshair:!1,PrintableArea:!1,Local:"en",AllowedSizes:Object.keys(Zh),Filename:"map",markerCirclePaint:q2,attributionStyle:K2}),On(this,"MAPLIB_CSS_PREFIX","maplibregl"),t&&(this.options=Object.assign(this.options,t)),this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}getTranslation(){const t=this.options.Local??"en";return nrt(t)}onAdd(t){var e;this.map=t,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add(`${this.MAPLIB_CSS_PREFIX}-ctrl`),this.controlContainer.classList.add(`${this.MAPLIB_CSS_PREFIX}-ctrl-group`),this.exportContainer=document.createElement("div"),this.exportContainer.classList.add(`${this.MAPLIB_CSS_PREFIX}-export-list`),this.exportButton=document.createElement("button"),this.exportButton.classList.add(`${this.MAPLIB_CSS_PREFIX}-ctrl-icon`),this.exportButton.classList.add(`${this.MAPLIB_CSS_PREFIX}-export-control`),this.exportButton.type="button",this.exportButton.addEventListener("click",()=>{this.exportButton.style.display="none",this.exportContainer.style.display="block",this.toggleCrosshair(!0),this.togglePrintableArea(!0)}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.exportButton),this.controlContainer.appendChild(this.exportContainer);const n=document.createElement("TABLE");n.className="print-table";const i={};(e=this.options.AllowedSizes)==null||e.forEach(y=>{Zh[y]&&(i[y]=Zh[y])});const s=this.createSelection(i,this.getTranslation().PageSize,"page-size",this.options.PageSize,(y,b)=>JSON.stringify(y[b]));n.appendChild(s);const a=this.createSelection(Ng,this.getTranslation().PageOrientation,"page-orientation",this.options.PageOrientation,(y,b)=>y[b]);n.appendChild(a);const o=this.createSelection(Vu,this.getTranslation().Format,"format-type",this.options.Format,(y,b)=>y[b]);n.appendChild(o);const d=this.createSelection(x2,this.getTranslation().DPI,"dpi-type",this.options.DPI,(y,b)=>y[b]);n.appendChild(d),this.exportContainer.appendChild(n);const p=document.createElement("button");return p.type="button",p.textContent=this.getTranslation().Generate,p.classList.add("generate-button"),p.addEventListener("click",()=>{const y=document.getElementById("mapbox-gl-export-page-size"),b=document.getElementById("mapbox-gl-export-page-orientation"),x=document.getElementById("mapbox-gl-export-format-type"),C=document.getElementById("mapbox-gl-export-dpi-type"),P=b.value;let M=JSON.parse(y.value);P===Ng.Portrait&&(M=M.reverse()),this.generateMap(t,M,Number(C.value),x.value,If.mm,this.options.Filename)}),this.exportContainer.appendChild(p),this.controlContainer}generateMap(t,e,n,i,s,a){new ent(t,e,n,i,s,a,this.options.markerCirclePaint,this.options.attributionStyle).generate()}createSelection(t,e,n,i,s){const a=document.createElement("label");a.textContent=e;const o=document.createElement("select");o.setAttribute("id",`mapbox-gl-export-${n}`),o.style.width="100%",Object.keys(t).forEach(b=>{const x=document.createElement("option");x.setAttribute("value",s(t,b)),x.appendChild(document.createTextNode(b)),x.setAttribute("name",n),i===t[b]&&(x.selected=!0),o.appendChild(x)}),o.addEventListener("change",()=>{this.updatePrintableArea()});const d=document.createElement("TR"),p=document.createElement("TD"),y=document.createElement("TD");return p.appendChild(a),y.appendChild(o),d.appendChild(p),d.appendChild(y),d}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.exportButton||(this.exportButton.removeEventListener("click",this.onDocumentClick),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0),this.printableArea!==void 0&&(this.printableArea.destroy(),this.printableArea=void 0),this.map=void 0)}onDocumentClick(t){this.controlContainer&&!this.controlContainer.contains(t.target)&&this.exportContainer&&this.exportButton&&(this.exportContainer.style.display="none",this.exportButton.style.display="block",this.toggleCrosshair(!1),this.togglePrintableArea(!1))}toggleCrosshair(t){this.options.Crosshair===!0&&(t===!1?this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0):(this.crosshair=new Het(this.map),this.crosshair.create()))}togglePrintableArea(t){this.options.PrintableArea===!0&&(t===!1?this.printableArea!==void 0&&(this.printableArea.destroy(),this.printableArea=void 0):(this.printableArea=new Vet(this.map),this.updatePrintableArea()))}updatePrintableArea(){if(this.printableArea===void 0)return;const t=document.getElementById("mapbox-gl-export-page-size"),e=document.getElementById("mapbox-gl-export-page-orientation").value;let n=JSON.parse(t.value);e===Ng.Portrait&&(n=n.reverse()),this.printableArea.updateArea(n[0],n[1])}};var EP=int,nnt=Object.prototype.hasOwnProperty;function int(){for(var r={},t=0;t<arguments.length;t++){var e=arguments[t];for(var n in e)nnt.call(e,n)&&(r[n]=e[n])}return r}var SP={exports:{}};(function(r,t){(function(){var e={};r.exports=e,e.simpleFilter=function(n,i){return i.filter(function(s){return e.test(n,s)})},e.test=function(n,i){return e.match(n,i)!==null},e.match=function(n,i,s){s=s||{};var a=0,o=[],d=i.length,p=0,y=0,b=s.pre||"",x=s.post||"",C=s.caseSensitive&&i||i.toLowerCase(),P;n=s.caseSensitive&&n||n.toLowerCase();for(var M=0;M<d;M++)P=i[M],C[M]===n[a]?(P=b+P+x,a+=1,y+=1+y):y=0,p+=y,o[o.length]=P;return a===n.length?(p=C===n?1/0:p,{rendered:o.join(""),score:p}):null},e.filter=function(n,i,s){return!i||i.length===0?[]:typeof n!="string"?i:(s=s||{},i.reduce(function(a,o,d,p){var y=o;s.extract&&(y=s.extract(o));var b=e.match(n,y,s);return b!=null&&(a[a.length]={string:b.rendered,score:b.score,index:d,original:o}),a},[]).sort(function(a,o){var d=o.score-a.score;return d||a.index-o.index}))}})()})(SP);var snt=SP.exports,la=function(r){return this.component=r,this.items=[],this.active=r.options.noInitialSelection?-1:0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,r.el.parentNode.insertBefore(this.wrapper,r.el.nextSibling),this};la.prototype.show=function(){this.element.style.display="block"},la.prototype.hide=function(){this.element.style.display="none"},la.prototype.add=function(r){this.items.push(r)},la.prototype.clear=function(){this.items=[],this.active=this.component.options.noInitialSelection?-1:0},la.prototype.isEmpty=function(){return!this.items.length},la.prototype.isVisible=function(){return this.element.style.display==="block"},la.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var r=0;r<this.items.length;r++)this.drawItem(this.items[r],this.active===r);this.show()},la.prototype.drawItem=function(r,t){var e=document.createElement("li"),n=document.createElement("a");t&&(e.className+=" active"),n.innerHTML=r.string,e.appendChild(n),this.element.appendChild(e),e.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),e.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,r)}).bind(this))},la.prototype.handleMouseUp=function(r){this.selectingListItem=!1,this.component.value(r.original),this.clear(),this.draw()},la.prototype.move=function(r){this.active=r,this.draw()},la.prototype.previous=function(){this.move(this.active<=0?this.items.length-1:this.active-1)},la.prototype.next=function(){this.move(this.active>=this.items.length-1?0:this.active+1)},la.prototype.drawError=function(r){var t=document.createElement("li");t.innerHTML=r,this.element.appendChild(t),this.show()};var ont=la,ant=EP,lnt=snt,cnt=ont,po=function(r,t,e){return e=e||{},this.options=ant({minLength:2,limit:5,filter:!0,hideOnBlur:!0,noInitialSelection:!0},e),this.el=r,this.data=t||[],this.list=new cnt(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(n){this.handleKeyUp(n.keyCode,n)}).bind(this),!1),this.el.addEventListener("keydown",(function(n){this.handleKeyDown(n)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(n){this.handlePaste(n)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};po.prototype.handleKeyUp=function(r,t){if(!(r===40||r===38||r===27||r===9)){if(r===13){this.list.items[this.list.active]&&(this.list.handleMouseUp(this.list.items[this.list.active]),t.stopPropagation());return}this.handleInputChange(this.el.value)}},po.prototype.handleKeyDown=function(r){switch(r.keyCode){case 13:this.list.active>=0&&(this.list.selectingListItem=!0);break;case 9:this.list.isEmpty()||(this.list.isVisible()&&r.preventDefault(),this.value(this.list.active>=0?this.list.items[this.list.active].original:null),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}},po.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},po.prototype.handlePaste=function(r){if(r.clipboardData)this.handleInputChange(r.clipboardData.getData("Text"));else{var t=this;setTimeout(function(){t.handleInputChange(r.target.value)},100)}},po.prototype.handleInputChange=function(r){if(this.query=this.normalize(r),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(t){for(var e=0;e<t.length&&(this.list.add(t[e]),e!==this.options.limit-1);e++);this.list.draw()}).bind(this))},po.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},po.prototype.update=function(r){this.data=r,this.handleKeyUp()},po.prototype.clear=function(){this.data=[],this.list.clear()},po.prototype.normalize=function(r){return r=r.toLowerCase(),r},po.prototype.match=function(r,t){return r.indexOf(t)>-1},po.prototype.value=function(r){if(this.selected=r,this.el.value=this.getItemValue(r||{place_name:this.query}),document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this.el.dispatchEvent(t)}else this.el.fireEvent("onchange")},po.prototype.getCandidates=function(r){var t={pre:"<strong>",post:"</strong>",extract:(function(n){return this.getItemValue(n)}).bind(this)},e;this.options.filter?(e=lnt.filter(this.query,this.data,t),e=e.map((function(n){return{original:n.original,string:this.render(n.original,n.string)}}).bind(this))):e=this.data.map((function(n){var i=this.render(n);return{original:n,string:i}}).bind(this)),r(e)},po.prototype.getItemValue=function(r){return r},po.prototype.render=function(r,t){if(t)return t;for(var e=r.original?this.getItemValue(r.original):this.getItemValue(r),n=this.normalize(e),i=n.lastIndexOf(this.query);i>-1;){var s=i+this.query.length;e=e.slice(0,i)+"<strong>"+e.slice(i,s)+"</strong>"+e.slice(s),i=n.slice(0,i).lastIndexOf(this.query)}return e},po.prototype.renderError=function(r){this.list.drawError(r)};var unt=po,TP=unt,Ant=TP;typeof window<"u"&&(window.Suggestions=TP);var hnt="Expected a function",IP=NaN,dnt="[object Symbol]",fnt=/^\s+|\s+$/g,pnt=/^[-+]0x[0-9a-f]+$/i,gnt=/^0b[01]+$/i,mnt=/^0o[0-7]+$/i,ynt=parseInt,_nt=typeof Kd=="object"&&Kd&&Kd.Object===Object&&Kd,vnt=typeof self=="object"&&self&&self.Object===Object&&self,bnt=_nt||vnt||Function("return this")(),wnt=Object.prototype,xnt=wnt.toString,Bnt=Math.max,Cnt=Math.min,$2=function(){return bnt.Date.now()};function Ent(r,t,e){var n,i,s,a,o,d,p=0,y=!1,b=!1,x=!0;if(typeof r!="function")throw new TypeError(hnt);t=FP(t)||0,W2(e)&&(y=!!e.leading,b="maxWait"in e,s=b?Bnt(FP(e.maxWait)||0,t):s,x="trailing"in e?!!e.trailing:x);function C(gt){var mt=n,dt=i;return n=i=void 0,p=gt,a=r.apply(dt,mt),a}function P(gt){return p=gt,o=setTimeout(z,t),y?C(gt):a}function M(gt){var mt=gt-d,dt=gt-p,Ft=t-mt;return b?Cnt(Ft,s-dt):Ft}function k(gt){var mt=gt-d,dt=gt-p;return d===void 0||mt>=t||mt<0||b&&dt>=s}function z(){var gt=$2();if(k(gt))return V(gt);o=setTimeout(z,M(gt))}function V(gt){return o=void 0,x&&n?C(gt):(n=i=void 0,a)}function $(){o!==void 0&&clearTimeout(o),p=0,n=d=i=o=void 0}function tt(){return o===void 0?a:V($2())}function pt(){var gt=$2(),mt=k(gt);if(n=arguments,i=this,d=gt,mt){if(o===void 0)return P(d);if(b)return o=setTimeout(z,t),C(d)}return o===void 0&&(o=setTimeout(z,t)),a}return pt.cancel=$,pt.flush=tt,pt}function W2(r){var t=typeof r;return!!r&&(t=="object"||t=="function")}function Snt(r){return!!r&&typeof r=="object"}function Tnt(r){return typeof r=="symbol"||Snt(r)&&xnt.call(r)==dnt}function FP(r){if(typeof r=="number")return r;if(Tnt(r))return IP;if(W2(r)){var t=typeof r.valueOf=="function"?r.valueOf():r;r=W2(t)?t+"":t}if(typeof r!="string")return r===0?r:+r;r=r.replace(fnt,"");var e=gnt.test(r);return e||mnt.test(r)?ynt(r.slice(2),e?2:8):pnt.test(r)?IP:+r}var Int=Ent,X2={exports:{}},kf=typeof Reflect=="object"?Reflect:null,LP=kf&&typeof kf.apply=="function"?kf.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)},Gy;kf&&typeof kf.ownKeys=="function"?Gy=kf.ownKeys:Object.getOwnPropertySymbols?Gy=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Gy=function(t){return Object.getOwnPropertyNames(t)};function Fnt(r){console&&console.warn&&console.warn(r)}var PP=Number.isNaN||function(t){return t!==t};function ii(){ii.init.call(this)}X2.exports=ii,X2.exports.once=Unt,ii.EventEmitter=ii,ii.prototype._events=void 0,ii.prototype._eventsCount=0,ii.prototype._maxListeners=void 0;var MP=10;function jy(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(ii,"defaultMaxListeners",{enumerable:!0,get:function(){return MP},set:function(r){if(typeof r!="number"||r<0||PP(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");MP=r}}),ii.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ii.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||PP(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function UP(r){return r._maxListeners===void 0?ii.defaultMaxListeners:r._maxListeners}ii.prototype.getMaxListeners=function(){return UP(this)},ii.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var d=s[t];if(d===void 0)return!1;if(typeof d=="function")LP(d,this,e);else for(var p=d.length,y=kP(d,p),n=0;n<p;++n)LP(y[n],this,e);return!0};function RP(r,t,e,n){var i,s,a;if(jy(e),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",t,e.listener?e.listener:e),s=r._events),a=s[t]),a===void 0)a=s[t]=e,++r._eventsCount;else if(typeof a=="function"?a=s[t]=n?[e,a]:[a,e]:n?a.unshift(e):a.push(e),i=UP(r),i>0&&a.length>i&&!a.warned){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=r,o.type=t,o.count=a.length,Fnt(o)}return r}ii.prototype.addListener=function(t,e){return RP(this,t,e,!1)},ii.prototype.on=ii.prototype.addListener,ii.prototype.prependListener=function(t,e){return RP(this,t,e,!0)};function Lnt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function OP(r,t,e){var n={fired:!1,wrapFn:void 0,target:r,type:t,listener:e},i=Lnt.bind(n);return i.listener=e,n.wrapFn=i,i}ii.prototype.once=function(t,e){return jy(e),this.on(t,OP(this,t,e)),this},ii.prototype.prependOnceListener=function(t,e){return jy(e),this.prependListener(t,OP(this,t,e)),this},ii.prototype.removeListener=function(t,e){var n,i,s,a,o;if(jy(e),i=this._events,i===void 0)return this;if(n=i[t],n===void 0)return this;if(n===e||n.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if(typeof n!="function"){for(s=-1,a=n.length-1;a>=0;a--)if(n[a]===e||n[a].listener===e){o=n[a].listener,s=a;break}if(s<0)return this;s===0?n.shift():Pnt(n,s),n.length===1&&(i[t]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",t,o||e)}return this},ii.prototype.off=ii.prototype.removeListener,ii.prototype.removeAllListeners=function(t){var e,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var s=Object.keys(n),a;for(i=0;i<s.length;++i)a=s[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=n[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this};function DP(r,t,e){var n=r._events;if(n===void 0)return[];var i=n[t];return i===void 0?[]:typeof i=="function"?e?[i.listener||i]:[i]:e?Mnt(i):kP(i,i.length)}ii.prototype.listeners=function(t){return DP(this,t,!0)},ii.prototype.rawListeners=function(t){return DP(this,t,!1)},ii.listenerCount=function(r,t){return typeof r.listenerCount=="function"?r.listenerCount(t):NP.call(r,t)},ii.prototype.listenerCount=NP;function NP(r){var t=this._events;if(t!==void 0){var e=t[r];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}ii.prototype.eventNames=function(){return this._eventsCount>0?Gy(this._events):[]};function kP(r,t){for(var e=new Array(t),n=0;n<t;++n)e[n]=r[n];return e}function Pnt(r,t){for(;t+1<r.length;t++)r[t]=r[t+1];r.pop()}function Mnt(r){for(var t=new Array(r.length),e=0;e<t.length;++e)t[e]=r[e].listener||r[e];return t}function Unt(r,t){return new Promise(function(e,n){function i(a){r.removeListener(t,s),n(a)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",i),e([].slice.call(arguments))}QP(r,t,s,{once:!0}),t!=="error"&&Rnt(r,i,{once:!0})})}function Rnt(r,t,e){typeof r.on=="function"&&QP(r,"error",t,e)}function QP(r,t,e,n){if(typeof r.on=="function")n.once?r.once(t,e):r.on(t,e);else if(typeof r.addEventListener=="function")r.addEventListener(t,function i(s){n.once&&r.removeEventListener(t,i),e(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var zP=X2.exports,Ont={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}},Dnt={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"",ja:"",lv:"Meklt",pt:"Procurar",sr:"",zh:"",cs:"Vyhledvn",hu:"Keress",ka:"",nb:"Ske",sk:"Vyhadvanie",th:"",fi:"Hae",is:"Leita",ko:"",pl:"Szukaj",sl:"Iskanje",fa:"",ru:""},Nnt={placeholder:Dnt},HP={exports:{}};(function(r){(function(t,e,n){r.exports?r.exports=n():t[e]=n()})(Kd,"subtag",function(){var t="",e=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function n(d){return d.match(e)||[]}function i(d){return n(d).filter(function(p,y){return p&&y})}function s(d){return d=n(d),{language:d[1]||t,extlang:d[2]||t,script:d[3]||t,region:d[4]||t}}function a(d,p,y){Object.defineProperty(d,p,{value:y,enumerable:!0})}function o(d,p,y){function b(x){return n(x)[d]||t}a(b,"pattern",p),a(s,y,b)}return o(1,/^[a-zA-Z]{2,3}$/,"language"),o(2,/^[a-zA-Z]{3}$/,"extlang"),o(3,/^[a-zA-Z]{4}$/,"script"),o(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),a(s,"split",i),s})})(HP);var knt=HP.exports,Qnt=Ant,znt=Int,Ma=EP,Hnt=zP.EventEmitter,VP=Ont,Vnt=Nnt,Gnt=knt;function GP(r,t){this._eventEmitter=new Hnt,this.options=Ma({},this.options,t),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geocoderApi=r}GP.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,showResultsWhileTyping:!1,minLength:2,reverseGeocode:!1,limit:5,enableEventLogging:!0,marker:!0,popup:!1,maplibregl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,getItemValue:function(r){return r.text!==void 0?r.text:r.place_name},render:function(r){if(r.geometry){var o=r.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--result maplibregl-ctrl-geocoder--result"><svg class="mapboxgl-ctrl-geocoder--result-icon maplibre-ctrl-geocoder--result-icon" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36571 0 0 5.38676 0 12.0471C0 21.0824 12 32 12 32C12 32 24 21.0824 24 12.0471C24 5.38676 18.6343 0 12 0ZM12 16.3496C9.63428 16.3496 7.71429 14.4221 7.71429 12.0471C7.71429 9.67207 9.63428 7.74454 12 7.74454C14.3657 7.74454 16.2857 9.67207 16.2857 12.0471C16.2857 14.4221 14.3657 16.3496 12 16.3496Z" fill="#687078"/></svg><div><div class="mapboxgl-ctrl-geocoder--result-title maplibregl-ctrl-geocoder--result-title">'+o[0]+'</div><div class="mapboxgl-ctrl-geocoder--result-address maplibregl-ctrl-geocoder--result-address">'+o.splice(1,o.length).join(",")+"</div></div></div>"}else{var t=r.text,e=t.toLowerCase().indexOf(this.query.toLowerCase()),n=this.query.length,i=t.substring(0,e),s=t.substring(e,e+n),a=t.substring(e+n);return'<div class="mapboxgl-ctrl-geocoder--suggestion maplibregl-ctrl-geocoder--suggestion"><svg class="mapboxgl-ctrl-geocoder--suggestion-icon maplibre-ctrl-geocoder--suggestion-icon" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22.8702 20.1258H21.4248L20.9125 19.6318C22.7055 17.546 23.785 14.8382 23.785 11.8925C23.785 5.32419 18.4608 0 11.8925 0C5.32419 0 0 5.32419 0 11.8925C0 18.4608 5.32419 23.785 11.8925 23.785C14.8382 23.785 17.546 22.7055 19.6318 20.9125L20.1258 21.4248V22.8702L29.2739 32L32 29.2739L22.8702 20.1258ZM11.8925 20.1258C7.33676 20.1258 3.65923 16.4483 3.65923 11.8925C3.65923 7.33676 7.33676 3.65923 11.8925 3.65923C16.4483 3.65923 20.1258 7.33676 20.1258 11.8925C20.1258 16.4483 16.4483 20.1258 11.8925 20.1258Z" fill="#687078"/></svg><div class="mapboxgl-ctrl-geocoder--suggestion-info maplibregl-ctrl-geocoder--suggestion-info"><div class="mapboxgl-ctrl-geocoder--suggestion-title maplibregl-ctrl-geocoder--suggestion-title">'+i+'<span class="mapboxgl-ctrl-geocoder--suggestion-match maplibregl-ctrl-geocoder--suggestion-match">'+s+"</span>"+a+"</div></div></div>"}},popupRender:function(r){var t=r.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion maplibre-ctrl-geocoder--suggestion popup-suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title maplibre-ctrl-geocoder--suggestion-title popup-suggestion-title">'+t[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address maplibre-ctrl-geocoder--suggestion-address popup-suggestion-address">'+t.splice(1,t.length).join(",")+"</div></div>"},showResultMarkers:!0,debounceSearch:200},addTo:function(r){function t(n,i){if(!document.body.contains(i))throw new Error("Element provided to #addTo() exists, but is not in the DOM");var s=n.onAdd();i.appendChild(s)}if(r._controlContainer)r.addControl(this);else if(r instanceof HTMLElement)t(this,r);else if(typeof r=="string"){var e=document.querySelectorAll(r);if(e.length===0)throw new Error("Element ",r,"not found.");if(e.length>1)throw new Error("Geocoder can only be added to a single html element");t(this,e[0])}else throw new Error("Error: addTo must be a maplibre-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(r){if(r&&typeof r!="string"&&(this._map=r),this.setLanguage(),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this);var t=this.container=document.createElement("div");t.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl";var e=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input maplibregl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",znt(this._onKeyDown,this.options.debounceSearch)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton);var n=document.createElement("div");n.classList.add("mapboxgl-ctrl-geocoder--pin-right","maplibregl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button maplibregl-ctrl-geocoder--button";var i=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');return this._clearEl.appendChild(i),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),n.appendChild(this._clearEl),n.appendChild(this._loadingEl),t.appendChild(e),t.appendChild(this._inputEl),t.appendChild(n),this._typeahead=new Qnt(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit,noInitialSelection:!0}),this.setRenderFunction(this.options.render),this._typeahead.getItemValue=this.options.getItemValue,this.mapMarker=null,this.resultMarkers=[],this._handleMarker=this._handleMarker.bind(this),this._handleResultMarkers=this._handleResultMarkers.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._maplibregl=this.options.maplibregl,!this._maplibregl&&this.options.marker&&(console.error("No maplibregl detected in options. Map markers are disabled. Please set options.maplibregl."),this.options.marker=!1)),t},createIcon:function(r,t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+r+" maplibregl-ctrl-geocoder--icon maplibregl-ctrl-geocoder--icon-"+r),e.setAttribute("viewBox","0 0 18 18"),e.setAttribute("xml:space","preserve"),e.setAttribute("width",18),e.setAttribute("height",18),"innerHTML"in e)e.innerHTML=t;else{var n=document.createElement("div");n.innerHTML="<svg>"+t.valueOf().toString()+"</svg>";var i=n.firstChild,s=i.firstChild;e.appendChild(s)}return e},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_onPaste:function(r){var t=(r.clipboardData||window.clipboardData).getData("text");t.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(t)},_onKeyDown:function(r){var t=27,e=9;if(r.keyCode===t&&this.options.clearAndBlurOnEsc)return this._clear(r),this._inputEl.blur();var n=r.target&&r.target.shadowRoot?r.target.shadowRoot.activeElement:r.target,i=n?n.value:"";if(!i)return this.fresh=!0,r.keyCode!==e&&this.clear(r),this._clearEl.style.display="none";if(!(r.metaKey||[e,t,37,39,38,40].indexOf(r.keyCode)!==-1)){if(r.keyCode===13)if(!this.options.showResultsWhileTyping)this._typeahead.selected||this._geocode(n.value);else{this._typeahead.selected==null&&this.geocoderApi.getSuggestions?this._geocode(n.value,!0):this._typeahead.selected==null&&this.options.showResultMarkers&&this._fitBoundsForMarkers();return}n.value.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(n.value)}},_showButton:function(){this._inputEl.value.length>0&&(this._clearEl.style.display="block")},_hideButton:function(){this._typeahead.selected&&(this._clearEl.style.display="none")},_onBlur:function(r){this.options.clearOnBlur&&this._clearOnBlur(r),this.options.collapsed&&this._collapse()},_onChange:function(){var r=this._typeahead.selected;if(r&&!r.geometry)r.placeId?this._geocode(r.placeId,!0,!0):this._geocode(r.text,!0);else if(r&&JSON.stringify(r)!==this.lastSelected){if(this._clearEl.style.display="none",this.options.flyTo){var t;if(this._removeResultMarkers(),r.properties&&VP[r.properties.short_code])t=Ma({},this.options.flyTo),this._map&&this._map.fitBounds(VP[r.properties.short_code].bbox,t);else if(r.bbox){var e=r.bbox;t=Ma({},this.options.flyTo),this._map&&this._map.fitBounds([[e[0],e[1]],[e[2],e[3]]],t)}else{var n={zoom:this.options.zoom};t=Ma({},n,this.options.flyTo),r.center?t.center=r.center:r.geometry&&r.geometry.type&&r.geometry.type==="Point"&&r.geometry.coordinates&&(t.center=r.geometry.coordinates),this._map&&this._map.flyTo(t)}}this.options.marker&&this._maplibregl&&this._handleMarker(r),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(r),this._typeahead.selected=null,this._eventEmitter.emit("result",{result:r})}},_getConfigForRequest:function(){var r=["bbox","limit","proximity","countries","types","language","reverseMode"],t=this,e=r.reduce(function(n,i){return t.options[i]&&(["countries","types","language"].indexOf(i)>-1?n[i]=t.options[i].split(/[\s,]+/):n[i]=t.options[i],i==="proximity"&&t.options[i]&&typeof t.options[i].longitude=="number"&&typeof t.options[i].latitude=="number"&&(n[i]=[t.options[i].longitude,t.options[i].latitude])),n},{});return e},_geocode:function(r,t,e){this._loadingEl.style.display="block",this._eventEmitter.emit("loading",{query:r}),this.inputString=r;var n=null,i=this._getConfigForRequest(),s;if(this.options.localGeocoderOnly)s=Promise.resolve();else if(this.options.reverseGeocode&&/(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/.test(r)){var a=r.split(/[\s(,)?]+/).map(function(p){return parseFloat(p,10)}).reverse();i.types&&i.types[0],i=Ma(i,{query:a,limit:1}),"proximity"in i&&delete i.proximity,s=this.geocoderApi.reverseGeocode(i)}else i=Ma(i,{query:r}),this.geocoderApi.getSuggestions?t?this.geocoderApi.searchByPlaceId&&e?s=this.geocoderApi.searchByPlaceId(i):s=this.geocoderApi.forwardGeocode(i):s=this.geocoderApi.getSuggestions(i):s=this.geocoderApi.forwardGeocode(i);var o=[];this.options.localGeocoder&&(o=this.options.localGeocoder(r),o||(o=[]));var d=[];return s.catch((function(p){n=p}).bind(this)).then((function(p){this._loadingEl.style.display="none";var y={};return p?y=p:y={type:"FeatureCollection",features:[]},y.config=i,this.fresh&&(this.fresh=!1),y.features=y.features?o.concat(y.features):o,this.options.externalGeocoder?(d=this.options.externalGeocoder(r,y.features,i)||[],d.then(function(b){return y.features=y.features?b.concat(y.features):b,y},function(){return y})):y}).bind(this)).then((function(p){if(n)throw n;this.options.filter&&p.features.length&&(p.features=p.features.filter(this.options.filter));var y=[];p.suggestions?y=p.suggestions:p.place?y=[p.place]:y=p.features,y.length?(this._clearEl.style.display="block",this._typeahead.update(y),(!this.options.showResultsWhileTyping||t)&&this.options.showResultMarkers&&(p.features.length>0||p.place)&&this._fitBoundsForMarkers(),this._eventEmitter.emit("results",p)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",p))}).bind(this)).catch((function(p){this._loadingEl.style.display="none",o.length&&this.options.localGeocoder||d.length&&this.options.externalGeocoder?(this._clearEl.style.display="block",this._typeahead.update(o)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:o}),this._eventEmitter.emit("error",{error:p})}).bind(this)),s},_clear:function(r){r&&r.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._clearEl.style.display="none",this._removeMarker(),this._removeResultMarkers(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(r){this._clear(r),this._inputEl.focus()},_clearOnBlur:function(r){var t=this;r.relatedTarget&&t._clear(r)},_onQueryResult:function(r){var t=r;if(t.features.length){var e=t.features[0];this._typeahead.selected=e,this._inputEl.value=e.place_name,this._onChange()}},_updateProximity:function(){if(this._map)if(this._map.getZoom()>9){var r=this._map.getCenter().wrap();this.setProximity({longitude:r.lng,latitude:r.lat})}else this.setProximity(null)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed","maplibregl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed","maplibregl-ctrl-geocoder--collapsed")},query:function(r){return this._geocode(r).then(this._onQueryResult),this},_renderError:function(){var r="<div class='mapbox-gl-geocoder--error maplibre-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(r)},_renderNoResults:function(){var r="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results maplibre-gl-geocoder--error maplibre-gl-geocoder--no-results'>No results found</div>";this._renderMessage(r)},_renderMessage:function(r){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(r)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var r=this.options.language.split(",")[0],t=Gnt.language(r),e=Vnt.placeholder[t];if(e)return e}return"Search"},_fitBoundsForMarkers:function(){if(!(this._typeahead.data.length<1)){var r=this._typeahead.data.filter(function(i){return typeof i!="string"}).slice(0,this.options.limit);if(this._clearEl.style.display="none",this.options.flyTo&&this._maplibregl&&this._map){var t={padding:100},e=Ma({},t,this.options.flyTo),n=new this._maplibregl.LngLatBounds;r.forEach(function(i){n.extend(i.geometry.coordinates)}),this._map.fitBounds(n.toArray(),e)}return r.length>0&&this._maplibregl&&this._handleResultMarkers(r),this}},setInput:function(r){return this._inputEl.value=r,this._typeahead.selected=null,this._typeahead.clear(),r.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(r),this},setProximity:function(r){return this.options.proximity=r,this},getProximity:function(){return this.options.proximity},setRenderFunction:function(r){return r&&typeof r=="function"&&(this._typeahead.render=r),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(r){var t=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=r||this.options.language||t,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(r){return this.options.zoom=r,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(r){return this.options.flyTo=r,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(r){return this.placeholder=r||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(r){return this.options.bbox=r,this},getCountries:function(){return this.options.countries},setCountries:function(r){return this.options.countries=r,this},getTypes:function(){return this.options.types},setTypes:function(r){return this.options.types=r,this},getMinLength:function(){return this.options.minLength},setMinLength:function(r){return this.options.minLength=r,this._typeahead&&(this._typeahead.options.minLength=r),this},getLimit:function(){return this.options.limit},setLimit:function(r){return this.options.limit=r,this._typeahead&&(this._typeahead.options.limit=r),this},getFilter:function(){return this.options.filter},setFilter:function(r){return this.options.filter=r,this},setGeocoderApi:function(r){return this.geocoderApi=r,this},getGeocoderApi:function(){return this.geocoderApi},_handleMarker:function(r){if(this._map){this._removeMarker();var t={color:"#4668F2"},e=Ma({},t,this.options.marker);this.mapMarker=new this._maplibregl.Marker(e);var n;if(this.options.popup){var i={},s=Ma({},i,this.options.popup);n=new this._maplibregl.Popup(s).setHTML(this.options.popupRender(r))}return r.center?(this.mapMarker.setLngLat(r.center).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(n)):r.geometry&&r.geometry.type&&r.geometry.type==="Point"&&r.geometry.coordinates&&(this.mapMarker.setLngLat(r.geometry.coordinates).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(n)),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},_handleResultMarkers:function(r){if(this._map){this._removeResultMarkers();var t={color:"#4668F2"},e=Ma({},t,this.options.showResultMarkers);return r.forEach((function(n){if(this.options.showResultMarkers&&this.options.showResultMarkers.element){var i=this.options.showResultMarkers.element.cloneNode(!0);e=Ma(e,{element:i})}var s=new this._maplibregl.Marker(Ma({},e,{element:i})),a;if(this.options.popup){var o={},d=Ma({},o,this.options.popup);a=new this._maplibregl.Popup(d).setHTML(this.options.popupRender(n))}n.center?(s.setLngLat(n.center).addTo(this._map),this.options.popup&&s.setPopup(a)):n.geometry&&n.geometry.type&&n.geometry.type==="Point"&&n.geometry.coordinates&&(s.setLngLat(n.geometry.coordinates).addTo(this._map),this.options.popup&&s.setPopup(a)),this.resultMarkers.push(s)}).bind(this)),this}},_removeResultMarkers:function(){this.resultMarkers&&this.resultMarkers.length>0&&(this.resultMarkers.forEach(function(r){r.remove()}),this.resultMarkers=[])},on:function(r,t){return this._eventEmitter.on(r,t),this},off:function(r,t){return this._eventEmitter.removeListener(r,t),this}};var jnt=GP;const qnt=Np(jnt),id={defaultOptions:{limitsUrl:"https://tilemaps.icgc.cat/vt/limits-tilejsonV3.json",geocoder:{peliasUrl1:"https://eines.icgc.cat/geocodificador/autocompletar?text=",peliasUrl2:"&layers=topo1%2Ctopo2%2Caddress&size=5"},mapOptions:{container:"map",center:{0:1.537786,1:41.837539},zoom:7.5,bearing:0,pitch:0,hash:!1,style:"https://geoserveis.icgc.cat/styles/icgc_mapa_base_gris.json.json",maxZoom:18,maxPitch:85},logoIcgcOptions:{logoUrlColor:"https://tilemaps.icgc.cat/cdn/logos/icgc_logo_color.png",logoUrlWhite:"https://tilemaps.icgc.cat/cdn/logos/icgc_logo_blanc.svg",logoLink:"https://www.icgc.cat",logoTitle:"Institut Cartogrfic i Geolgic de Catalunya",logoWidth:100},logoGencatOptions:{logoUrlColor:"https://tilemaps.icgc.cat/cdn/logos/gencat_logo_color.png",logoUrlWhite:"https://tilemaps.icgc.cat/cdn/logos/gencat_logo_blanc.png",logoLink:"https://web.gencat.cat/",logoTitle:"Generalitat de Catalunya",logoWidth:100},map3dOptions:{spaceErrorFactor:2,exaggeration:1,zfactor:48,minZoomRange:15.5,maxZoomRange:22,urlTilesetCities:"https://tilemaps.icgc.cat/vector/3dtiles/ciutats/v1/tilesetV1.0.json",layerIdOrder:"place-isolated",sourceLayerFilterId:"place",minZoomFilter:14,layerId3d:"edificisMapboxLayer",terrainSource:"ICGC5M",style3dName:"orto3d",imageIcon:"https://tilemaps.icgc.cat/cdn/images/stick.png"},baseStyles:[{key:"TOPO",url:"https://geoserveis.icgc.cat/styles/icgc_mapa_base_topografic.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_estandard.png"},{key:"ORTO",url:"https://geoserveis.icgc.cat/styles/icgc_orto_estandard.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_orto_estandard.png"},{key:"ORTO3D",url:"https://tilemaps.icgc.cat/cdn/styles/icgc_orto_3d.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_orto_estandard.png"},{key:"ORTOHYBRID",url:"https://geoserveis.icgc.cat/styles/icgc_orto_hibrida.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_orto_hibrida.png"},{key:"ADMIN",url:"https://geoserveis.icgc.cat/styles/icgc_limits_administratius_gris.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_delimitacio_limits_administratius.png"},{key:"DARK",url:"https://geoserveis.icgc.cat/styles/icgc_mapa_base_fosc.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_base_fosc.png"},{key:"LIGHT",url:"https://geoserveis.icgc.cat/styles/icgc_mapa_base_gris.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_base_gris.png"},{key:"GEOLOGY",url:"https://geoserveis.icgc.cat/styles/icgc_geologic_informacio.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_geologic_informacio.png"}],urlTerrainICGC:[{name:"ICGC5M",url:"https://tilemaps.icgc.cat/tileserver/tileserver/terreny-5m-30m-rgb-extent/{z}/{x}/{y}.png"},{name:"WORLD30M",url:"https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png",encoding:"terrarium"}],ortoLayersICGC:[{name:"ortofotoColorProvisional",key:"ortofoto_color_provisional",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_provisional"},{name:"ortofotoColor2023",key:"ortofoto_color_2023",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2023"},{name:"ortofotoColor2022",key:"ortofoto_color_2022",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2022"},{name:"ortofotoColor2021",key:"ortofoto_color_2021",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2021"},{name:"ortofotoColor2020",key:"ortofoto_color_2020",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2020"},{name:"ortofotoColor2019",key:"ortofoto_color_2019",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2019"},{name:"ortofotoColor2018",key:"ortofoto_color_2018",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2018"},{name:"ortofotoColor2017",key:"ortofoto_color_2017",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2017"},{name:"ortofotoColor2016",key:"ortofoto_color_2016",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2016"},{name:"ortofotoColor2015",key:"ortofoto_color_2015",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2015"},{name:"ortofotoColor2014",key:"ortofoto_color_2014",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2014"},{name:"ortofotoColor2013",key:"ortofoto_color_2013",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2013"},{name:"ortofotoColor2012",key:"ortofoto_color_2012",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2012"},{name:"ortofotoColor2011",key:"ortofoto_color_2011",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2011"},{name:"ortofotoColor2010",key:"ortofoto_color_2010",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2010"},{name:"ortofotoColor2009",key:"ortofoto_color_2009",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2009"},{name:"ortofotoColor2008",key:"ortofoto_color_2008",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2008"},{name:"ortofotoColor20062007",key:"ortofoto_color_2006-2007",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2006-2007"},{name:"ortofotoColor20042005",key:"ortofoto_color_2004-2005",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2004-2005"},{name:"ortofotoColor20002003",key:"ortofoto_color_2000-2003",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2000-2003"},{name:"ortofotoBlancINegre1998",key:"ortofoto_blanc_i_negre_1998",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1998"},{name:"ortofotoBlancINegre19941997",key:"ortofoto_blanc_i_negre_1994-1997",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1994-1997"},{name:"ortofotoColor1993",key:"ortofoto_color_1993",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_1993"},{name:"ortofotoBlancINegre19831992",key:"ortofoto_blanc_i_negre_1983-1992",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1983-1992"},{name:"ortofotoBlancINegre19701977",key:"ortofoto_blanc_i_negre_1970-1977",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1970-1977"},{name:"ortofotoBlancINegre1956",key:"ortofoto_blanc_i_negre_1956",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1956"},{name:"ortofotoBlancINegre1945",key:"ortofoto_blanc_i_negre_1945",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1945"},{name:"ortofotoColorSerieAnual",key:"ortofoto_color_serie_anual",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_serie_anual"},{name:"ortofotoInfraroigProvisional",key:"ortofoto_infraroig_provisional",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_provisional"},{name:"ortofotoInfraroig2023",key:"ortofoto_infraroig_2023",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2023"},{name:"ortofotoInfraroig2022",key:"ortofoto_infraroig_2022",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2022"},{name:"ortofotoInfraroig2021",key:"ortofoto_infraroig_2021",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2021"},{name:"ortofotoInfraroig2020",key:"ortofoto_infraroig_2020",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2020"},{name:"ortofotoInfraroig2019",key:"ortofoto_infraroig_2019",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2019"},{name:"ortofotoInfraroig2018",key:"ortofoto_infraroig_2018",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2018"},{name:"ortofotoInfraroig2017",key:"ortofoto_infraroig_2017",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2017"},{name:"ortofotoInfraroig2016",key:"ortofoto_infraroig_2016",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2016"},{name:"ortofotoInfraroig2015",key:"ortofoto_infraroig_2015",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2015"},{name:"ortofotoInfraroig2014",key:"ortofoto_infraroig_2014",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2014"},{name:"ortofotoInfraroig2013",key:"ortofoto_infraroig_2013",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2013"},{name:"ortofotoInfraroig2012",key:"ortofoto_infraroig_2012",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2012"},{name:"ortofotoInfraroig2011",key:"ortofoto_infraroig_2011",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2011"},{name:"ortofotoInfraroig2010",key:"ortofoto_infraroig_2010",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2010"},{name:"ortofotoInfraroig2009",key:"ortofoto_infraroig_2009",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2009"},{name:"ortofotoInfraroig2008",key:"ortofoto_infraroig_2008",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2008"},{name:"ortofotoInfraroig20062007",key:"ortofoto_infraroig_2006-2007",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2006-2007"},{name:"ortofotoInfraroig19961997",key:"ortofoto_infraroig_1996-1997",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_1996-1997"},{name:"ortofotoInfraroigSerieAnual",key:"ortofoto_infraroig_serie_anual",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_serie_anual"}],vectorLayersICGC:[{name:"agrupacionsCensals2015",key:"agrupacions_censals_2015"},{name:"agrupacionsCensals2016",key:"agrupacions_censals_2016"},{name:"agrupacionsCensals2017",key:"agrupacions_censals_2017"},{name:"agrupacionsCensals2018",key:"agrupacions_censals_2018"},{name:"agrupacionsCensals2019",key:"agrupacions_censals_2019"},{name:"agrupacionsCensals2020",key:"agrupacions_censals_2020"},{name:"agrupacionsCensals2021",key:"agrupacions_censals_2021"},{name:"agrupacionsCensalsVigent",key:"agrupacions_censals_vigent"},{name:"agrupacionsCensalsVigentText",key:"agrupacions_censals_vigent_text"},{name:"areesBasiquesPolicials2019",key:"arees_basiques_policials_2019"},{name:"areesBasiquesPolicials2020",key:"arees_basiques_policials_2020"},{name:"areesBasiquesPolicials2022",key:"arees_basiques_policials_2022"},{name:"areesBasiquesPolicialsVigent",key:"arees_basiques_policials_vigent"},{name:"areesBasiquesPolicialsVigentText",key:"arees_basiques_policials_vigent_text"},{name:"areesBasiquesSalutVigent",key:"arees_basiques_salut_vigent"},{name:"areesBasiquesServeisSocialsVigent",key:"arees_basiques_serveis_socials_vigent"},{name:"areesBasiquesServeisSocialsVigentText",key:"arees_basiques_serveis_socials_vigent_text"},{name:"areesGestioAssistencialVigent",key:"arees_gestio_assistencial_vigent"},{name:"areesHidrogeologiquesAquifersVigent",key:"arees_hidrogeologiques_aquifers_vigent"},{name:"catalunyaVigent",key:"catalunya_vigent"},{name:"catalunyaVigentText",key:"catalunya_vigent_text"},{name:"comarques2022",key:"comarques_2022"},{name:"comarquesVigent",key:"comarques_vigent"},{name:"comarquesVigentText",key:"comarques_vigent_text"},{name:"districtesCensals2015",key:"districtes_censals_2015"},{name:"districtesCensals2016",key:"districtes_censals_2016"},{name:"districtesCensals2017",key:"districtes_censals_2017"},{name:"districtesCensals2018",key:"districtes_censals_2018"},{name:"districtesCensals2019",key:"districtes_censals_2019"},{name:"districtesCensals2020",key:"districtes_censals_2020"},{name:"districtesCensals2021",key:"districtes_censals_2021"},{name:"districtesCensals2022",key:"districtes_censals_2022"},{name:"districtesCensals2023",key:"districtes_censals_2023"},{name:"districtesCensalsVigent",key:"districtes_censals_vigent"},{name:"districtesCensalsVigentText",key:"districtes_censals_vigent_text"},{name:"incendisForestalsVigent",key:"incendis_forestals_vigent"},{name:"incendisForestalsVigentText",key:"incendis_forestals_vigent_text"},{name:"municipis2022",key:"municipis_2022"},{name:"municipis2022Text",key:"municipis_2022_text"},{name:"municipisVigent",key:"municipis_vigent"},{name:"municipisVigentText",key:"municipis_vigent_text"},{name:"partitsJudicialsVigent",key:"partits_judicials_vigent"},{name:"partitsJudicialsVigentText",key:"partits_judicials_vigent_text"},{name:"plaTerritorial2015",key:"pla_territorial_2015"},{name:"plaTerritorialVigent",key:"pla_territorial_vigent"},{name:"plaTerritorialVigentText",key:"pla_territorial_vigent_text"},{name:"provinciesVigent",key:"provincies_vigent"},{name:"provinciesVigentText",key:"provincies_vigent_text"},{name:"regionsPolicialsVigent",key:"regions_policials_vigent"},{name:"regionsPolicialsVigentText",key:"regions_policials_vigent_text"},{name:"regionsSanitariesVigent",key:"regions_sanitaries_vigent"},{name:"regionsSanitariesVigentText",key:"regions_sanitaries_vigent_text"},{name:"seccionsCensals2015",key:"seccions_censals_2015"},{name:"seccionsCensals2016",key:"seccions_censals_2016"},{name:"seccionsCensals2017",key:"seccions_censals_2017"},{name:"seccionsCensals2018",key:"seccions_censals_2018"},{name:"seccionsCensals2019",key:"seccions_censals_2019"},{name:"seccionsCensals2020",key:"seccions_censals_2020"},{name:"seccionsCensals2021",key:"seccions_censals_2021"},{name:"seccionsCensals2022",key:"seccions_censals_2022"},{name:"seccionsCensals2023",key:"seccions_censals_2023"},{name:"seccionsCensalsVigent",key:"seccions_censals_vigent"},{name:"seccionsCensalsVigentText",key:"seccions_censals_vigent_text"},{name:"sectorsSanitarisVigent",key:"sectors_sanitaris_vigent"},{name:"vegueriesVigent",key:"vegueries_vigent"},{name:"vegueriesVigentText",key:"vegueries_vigent_text"}],vectorLayers:[{key:"cobertes2018",url:"https://tilemaps.icgc.cat/tileserver/cobertes_tilejson.json",legend:"https://tilemaps.icgc.cat/cdn/images/llegendaCobertesSol2018.jpg"}],wmsLayers:[{key:"espaisInteresGeologic",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/espais-interes-geologic/wms/service?&service=WMS&request=GetMap&layers=espais-interes-geologic&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},{key:"gravimetriaBouguer500000",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/gravimetria/wms/service?&service=WMS&request=GetMap&layers=anomalia_bouguer_500000&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},{key:"cobertesSol2018",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms/service?&service=WMS&request=GetMap&layers=cobertes_2018&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},{key:"administratiu",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/administratiu/MON3857NW/{z}/{x}/{y}.png"},{key:"simplificat",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/simplificat/MON3857NW/{z}/{x}/{y}.png"},{key:"cims",layer:"",url:"https://geoserveis.icgc.cat/icc_100cims/wms/service?REQUEST=GetMap&SERVICE=WMS&VERSION=1.1.1&LAYERS=0&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&SRS=EPSG:25831&BBOX=137118.923076923,4488408.75,650959.076923077,4749634.75&WIDTH=895&HEIGHT=455"},{key:"cobertesSol",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms?REQUEST=GetMap&SERVICE=WMS&VERSION=1.3.0&LAYERS=cobertes_2009&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&CRS=EPSG:25831&BBOX=374110.828167253,4639230.79853085,452621.120632226,4703578.45000215&WIDTH=1020&HEIGHT=836"}],fgbLayers:[{name:"agrupacionsCensalsVigent",key:"agrupacions_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent.fgb"},{name:"agrupacionsCensalsVigentText",key:"agrupacions_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent_text.fgb"},{name:"areesBasiquesPolicialsVigent",key:"arees_basiques_policials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent.fgb"},{name:"areesBasiquesPolicialsVigentText",key:"arees_basiques_policials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent_text.fgb"},{name:"areesBasiquesSalutVigent",key:"arees_basiques_salut_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_salut_vigent.fgb"},{name:"areesBasiquesServeisSocialsVigent",key:"arees_basiques_serveis_socials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent.fgb"},{name:"areesBasiquesServeisSocialsVigentText",key:"arees_basiques_serveis_socials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent_text.fgb"},{name:"areesGestioAssistencialVigent",key:"arees_gestio_assistencial_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_gestio_assistencial_vigent.fgb"},{name:"areesHidrogeologiquesAquifersVigent",key:"arees_hidrogeologiques_aquifers_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_hidrogeologiques_aquifers_vigent.fgb"},{name:"catalunyaVigent",key:"catalunya_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent.fgb"},{name:"catalunyaVigentText",key:"catalunya_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent_text.fgb"},{name:"comarquesVigent",key:"comarques_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent.fgb"},{name:"comarquesVigentText",key:"comarques_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent_text.fgb"},{name:"districtesCensalsVigent",key:"districtes_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent.fgb"},{name:"districtesCensalsVigentText",key:"districtes_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent_text.fgb"},{name:"incendisForestalsVigent",key:"incendis_forestals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent.fgb"},{name:"incendisForestalsVigentText",key:"incendis_forestals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent_text.fgb"},{name:"municipisVigent",key:"municipis_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent.fgb"},{name:"municipisVigentText",key:"municipis_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent_text.fgb"},{name:"partitsJudicialsVigent",key:"partits_judicials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent.fgb"},{name:"partitsJudicialsVigentText",key:"partits_judicials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent_text.fgb"},{name:"plaTerritorialVigent",key:"pla_territorial_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent.fgb"},{name:"plaTerritorialVigentText",key:"pla_territorial_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent_text.fgb"},{name:"provinciesVigent",key:"provincies_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent.fgb"},{name:"provinciesVigentText",key:"provincies_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent_text.fgb"},{name:"regionsPolicialsVigent",key:"regions_policials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent.fgb"},{name:"regionsPolicialsVigentText",key:"regions_policials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent_text.fgb"},{name:"regionsSanitariesVigent",key:"regions_sanitaries_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent.fgb"},{name:"regionsSanitariesVigentText",key:"regions_sanitaries_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent_text.fgb"},{name:"seccionsCensalsVigent",key:"seccions_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent.fgb"},{name:"seccionsCensalsVigentText",key:"seccions_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent_text.fgb"},{name:"sectorsSanitarisVigent",key:"sectors_sanitaris_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/sectors_sanitaris_vigent.fgb"},{name:"vegueriesVigent",key:"vegueries_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent.fgb"},{name:"vegueriesVigentText",key:"vegueries_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent_text.fgb"}]},Styles:{TOPO:"https://geoserveis.icgc.cat/styles/icgc_mapa_base_topografic.json",ORTO:"https://geoserveis.icgc.cat/styles/icgc_orto_estandard.json",ORTO3D:"https://tilemaps.icgc.cat/cdn/styles/icgc_orto_3d.json",ORTOHYBRID:"https://geoserveis.icgc.cat/styles/icgc_orto_hibrida.json",ADMIN:"https://geoserveis.icgc.cat/styles/icgc_limits_administratius_gris.json",DARK:"https://geoserveis.icgc.cat/styles/icgc_mapa_base_fosc.json",LIGHT:"https://geoserveis.icgc.cat/styles/icgc_mapa_base_gris.json",GEOLOGY:"https://geoserveis.icgc.cat/styles/icgc_geologic_informacio.json"},Terrains:{ICGC5M:"https://tilemaps.icgc.cat/tileserver/tileserver/terreny-5m-30m-rgb-extent/{z}/{x}/{y}.png",WORLD30M:"https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png"},Layers:{Orto:{ortofotoColorProvisional:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_provisional",ortofotoColor2023:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2023",ortofotoColor2022:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2022",ortofotoColor2021:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2021",ortofotoColor2020:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2020",ortofotoColor2019:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2019",ortofotoColor2018:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2018",ortofotoColor2017:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2017",ortofotoColor2016:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2016",ortofotoColor2015:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2015",ortofotoColor2014:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2014",ortofotoColor2013:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2013",ortofotoColor2012:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2012",ortofotoColor2011:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2011",ortofotoColor2010:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2010",ortofotoColor2009:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2009",ortofotoColor2008:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2008",ortofotoColor20062007:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2006-2007",ortofotoColor20042005:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2004-2005",ortofotoColor20002003:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2000-2003",ortofotoBlancINegre1998:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1998",ortofotoBlancINegre19941997:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1994-1997",ortofotoColor1993:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_1993",ortofotoBlancINegre19831992:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1983-1992",ortofotoBlancINegre19701977:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1970-1977",ortofotoBlancINegre1956:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1956",ortofotoBlancINegre1945:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1945",ortofotoColorSerieAnual:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_serie_anual",ortofotoInfraroigProvisional:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_provisional",ortofotoInfraroig2023:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2023",ortofotoInfraroig2022:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2022",ortofotoInfraroig2021:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2021",ortofotoInfraroig2020:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2020",ortofotoInfraroig2019:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2019",ortofotoInfraroig2018:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2018",ortofotoInfraroig2017:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2017",ortofotoInfraroig2016:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2016",ortofotoInfraroig2015:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2015",ortofotoInfraroig2014:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2014",ortofotoInfraroig2013:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2013",ortofotoInfraroig2012:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2012",ortofotoInfraroig2011:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2011",ortofotoInfraroig2010:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2010",ortofotoInfraroig2009:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2009",ortofotoInfraroig2008:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2008",ortofotoInfraroig20062007:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2006-2007",ortofotoInfraroig19961997:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_1996-1997",ortofotoInfraroigSerieAnual:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_serie_anual"},VectorAdmin:{agrupacionsCensals2015:"agrupacions_censals_2015",agrupacionsCensals2016:"agrupacions_censals_2016",agrupacionsCensals2017:"agrupacions_censals_2017",agrupacionsCensals2018:"agrupacions_censals_2018",agrupacionsCensals2019:"agrupacions_censals_2019",agrupacionsCensals2020:"agrupacions_censals_2020",agrupacionsCensals2021:"agrupacions_censals_2021",agrupacionsCensalsVigent:"agrupacions_censals_vigent",agrupacionsCensalsVigentText:"agrupacions_censals_vigent_text",areesBasiquesPolicials2019:"arees_basiques_policials_2019",areesBasiquesPolicials2020:"arees_basiques_policials_2020",areesBasiquesPolicials2022:"arees_basiques_policials_2022",areesBasiquesPolicialsVigent:"arees_basiques_policials_vigent",areesBasiquesPolicialsVigentText:"arees_basiques_policials_vigent_text",areesBasiquesSalutVigent:"arees_basiques_salut_vigent",areesBasiquesServeisSocialsVigent:"arees_basiques_serveis_socials_vigent",areesBasiquesServeisSocialsVigentText:"arees_basiques_serveis_socials_vigent_text",areesGestioAssistencialVigent:"arees_gestio_assistencial_vigent",areesHidrogeologiquesAquifersVigent:"arees_hidrogeologiques_aquifers_vigent",catalunyaVigent:"catalunya_vigent",catalunyaVigentText:"catalunya_vigent_text",comarques2022:"comarques_2022",comarquesVigent:"comarques_vigent",comarquesVigentText:"comarques_vigent_text",districtesCensals2015:"districtes_censals_2015",districtesCensals2016:"districtes_censals_2016",districtesCensals2017:"districtes_censals_2017",districtesCensals2018:"districtes_censals_2018",districtesCensals2019:"districtes_censals_2019",districtesCensals2020:"districtes_censals_2020",districtesCensals2021:"districtes_censals_2021",districtesCensals2022:"districtes_censals_2022",districtesCensals2023:"districtes_censals_2023",districtesCensalsVigent:"districtes_censals_vigent",districtesCensalsVigentText:"districtes_censals_vigent_text",incendisForestalsVigent:"incendis_forestals_vigent",incendisForestalsVigentText:"incendis_forestals_vigent_text",municipis2022:"municipis_2022",municipis2022Text:"municipis_2022_text",municipisVigent:"municipis_vigent",municipisVigentText:"municipis_vigent_text",partitsJudicialsVigent:"partits_judicials_vigent",partitsJudicialsVigentText:"partits_judicials_vigent_text",plaTerritorial2015:"pla_territorial_2015",plaTerritorialVigent:"pla_territorial_vigent",plaTerritorialVigentText:"pla_territorial_vigent_text",provinciesVigent:"provincies_vigent",provinciesVigentText:"provincies_vigent_text",regionsPolicialsVigent:"regions_policials_vigent",regionsPolicialsVigentText:"regions_policials_vigent_text",regionsSanitariesVigent:"regions_sanitaries_vigent",regionsSanitariesVigentText:"regions_sanitaries_vigent_text",seccionsCensals2015:"seccions_censals_2015",seccionsCensals2016:"seccions_censals_2016",seccionsCensals2017:"seccions_censals_2017",seccionsCensals2018:"seccions_censals_2018",seccionsCensals2019:"seccions_censals_2019",seccionsCensals2020:"seccions_censals_2020",seccionsCensals2021:"seccions_censals_2021",seccionsCensals2022:"seccions_censals_2022",seccionsCensals2023:"seccions_censals_2023",seccionsCensalsVigent:"seccions_censals_vigent",seccionsCensalsVigentText:"seccions_censals_vigent_text",sectorsSanitarisVigent:"sectors_sanitaris_vigent",vegueriesVigent:"vegueries_vigent",vegueriesVigentText:"vegueries_vigent_text"},FGBAdmin:{agrupacionsCensalsVigent:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent.fgb",agrupacionsCensalsVigentText:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent_text.fgb",areesBasiquesPolicialsVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent.fgb",areesBasiquesPolicialsVigentText:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent_text.fgb",areesBasiquesSalutVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_salut_vigent.fgb",areesBasiquesServeisSocialsVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent.fgb",areesBasiquesServeisSocialsVigentText:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent_text.fgb",areesGestioAssistencialVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_gestio_assistencial_vigent.fgb",areesHidrogeologiquesAquifersVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_hidrogeologiques_aquifers_vigent.fgb",catalunyaVigent:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent.fgb",catalunyaVigentText:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent_text.fgb",comarquesVigent:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent.fgb",comarquesVigentText:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent_text.fgb",districtesCensalsVigent:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent.fgb",districtesCensalsVigentText:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent_text.fgb",incendisForestalsVigent:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent.fgb",incendisForestalsVigentText:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent_text.fgb",municipisVigent:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent.fgb",municipisVigentText:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent_text.fgb",partitsJudicialsVigent:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent.fgb",partitsJudicialsVigentText:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent_text.fgb",plaTerritorialVigent:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent.fgb",plaTerritorialVigentText:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent_text.fgb",provinciesVigent:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent.fgb",provinciesVigentText:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent_text.fgb",regionsPolicialsVigent:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent.fgb",regionsPolicialsVigentText:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent_text.fgb",regionsSanitariesVigent:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent.fgb",regionsSanitariesVigentText:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent_text.fgb",seccionsCensalsVigent:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent.fgb",seccionsCensalsVigentText:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent_text.fgb",sectorsSanitarisVigent:"https://tilemaps.icgc.cat/vector/fgb/sectors_sanitaris_vigent.fgb",vegueriesVigent:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent.fgb",vegueriesVigentText:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent_text.fgb"},Vector:{cobertes2018:"https://tilemaps.icgc.cat/tileserver/cobertes_tilejson.json"},WMS:{espaisInteresGeologic:"https://geoserveis.icgc.cat/servei/catalunya/espais-interes-geologic/wms/service?&service=WMS&request=GetMap&layers=espais-interes-geologic&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}",gravimetriaBouguer500000:"https://geoserveis.icgc.cat/servei/catalunya/gravimetria/wms/service?&service=WMS&request=GetMap&layers=anomalia_bouguer_500000&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}",cobertesSol2018:"https://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms/service?&service=WMS&request=GetMap&layers=cobertes_2018&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}",administratiu:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/administratiu/MON3857NW/{z}/{x}/{y}.png",simplificat:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/simplificat/MON3857NW/{z}/{x}/{y}.png",cims:"https://geoserveis.icgc.cat/icc_100cims/wms/service?REQUEST=GetMap&SERVICE=WMS&VERSION=1.1.1&LAYERS=0&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&SRS=EPSG:25831&BBOX=137118.923076923,4488408.75,650959.076923077,4749634.75&WIDTH=895&HEIGHT=455",cobertesSol:"http://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms?REQUEST=GetMap&SERVICE=WMS&VERSION=1.3.0&LAYERS=cobertes_2009&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&CRS=EPSG:25831&BBOX=374110.828167253,4639230.79853085,452621.120632226,4703578.45000215&WIDTH=1020&HEIGHT=836"}}};class Knt{constructor(t){this.options=t||{}}onAdd(t){let e=id.defaultOptions;return this._map=t,this._img1=document.createElement("img"),this._img1.className="maplibregl-ctrl",this._img1.src=this.options.color?e.logoIcgcOptions.logoUrlColor:e.logoIcgcOptions.logoUrlWhite,this._img1.width=e.logoIcgcOptions.logoWidth,this._img1.title=e.logoIcgcOptions.logoTitle,this.link1=document.createElement("a"),this.link1.href=e.logoIcgcOptions.logoLink,this.link1.target="_blank",this.link1.appendChild(this._img1),this._container1=document.createElement("div"),this._container1.className="maplibregl-ctrl",this._container1.style.width=`${e.logoIcgcOptions.logoWidth}px`,this._container1.appendChild(this.link1),this._img2=document.createElement("img"),this._img2.className="maplibregl-ctrl",this._img2.src=this.options.color?e.logoGencatOptions.logoUrlColor:e.logoGencatOptions.logoUrlWhite,this._img2.width=e.logoGencatOptions.logoWidth,this._img2.title=e.logoGencatOptions.logoTitle,this.link2=document.createElement("a"),this.link2.href=e.logoGencatOptions.logoLink,this.link2.target="_blank",this.link2.appendChild(this._img2),this._container2=document.createElement("div"),this._container2.className="maplibregl-ctrl",this._container2.style.width=`${e.logoGencatOptions.logoWidth}px`,this._container2.appendChild(this.link2),this._mainContainer=document.createElement("div"),this._mainContainer.className="divLogos",this._mainContainer.style="display: flex",this._mainContainer.appendChild(this._container1),this._mainContainer.appendChild(this._container2),this._mainContainer}}class $nt{constructor(t){this.options=t||{}}onAdd(t){this._map=t,this._img1=document.createElement("img"),this._img1.src=this.options.url,this._img1.width=150,this._img1.title=300,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("maplibregl-ctrl"),this.controlContainer.classList.add("maplibregl-ctrl-group"),this.legendContainer=document.createElement("div"),this.legendContainer.classList.add("maplibregl-legend-list"),this.legendButton=document.createElement("button"),this.legendButton.classList.add("maplibregl-ctrl-icon"),this.legendButton.classList.add("maplibregl-legend-switcher"),this.legendButton.addEventListener("click",()=>{this.legendButton.style.display="none",this.legendContainer.style.display="block"}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.legendButton),this.controlContainer.appendChild(this.legendContainer),this.closeButton=document.createElement("button"),this.closeButton.textContent="x",this.closeButton.classList.add("maplibregl-legend-close-button"),this.closeButton.addEventListener("click",()=>{this.legendButton.style.display="block",this.legendContainer.style.display="none"}),this.legendContainer.appendChild(this.closeButton);const e=document.createElement("label");return e.classList.add("maplibregl-legend-title-label"),e.textContent=this.options.idLayer||"Llegenda",this.legendContainer.appendChild(e),this.legendContainer.appendChild(document.createElement("br")),this.legendContainer.appendChild(this._img1),this.controlContainer}}var Qf=jP.prototype,J2="WGS 84";function jP(r){r!==void 0&&(J2=r),this.setEllipsoid(J2)}Qf.convertLatLngToUtm=function(r,t,e){var n;if(this.status)return"No ecclipsoid data associated with unknown datum: "+J2;if(!Number.isInteger(e))return"Precision is not integer number.";r=parseFloat(r),t=parseFloat(t);var i=t,s=this.toRadians(r),a=this.toRadians(i);i>=8&&i<=13&&r>54.5&&r<58||r>=56&&r<64&&i>=3&&i<12?n=32:(n=(i+180)/6+1,r>=72&&r<84&&(i>=0&&i<9?n=31:i>=9&&i<21?n=33:i>=21&&i<33?n=35:i>=33&&i<42&&(n=37))),n=parseInt(n);var o=(n-1)*6-180+3,d=this.toRadians(o),p=this.getUtmLetterDesignator(r),y=this.eccSquared/(1-this.eccSquared),b=this.a/Math.sqrt(1-this.eccSquared*Math.sin(s)*Math.sin(s)),x=Math.tan(s)*Math.tan(s),C=y*Math.cos(s)*Math.cos(s),P=Math.cos(s)*(a-d),M=this.a*((1-this.eccSquared/4-3*this.eccSquared*this.eccSquared/64-5*this.eccSquared*this.eccSquared*this.eccSquared/256)*s-(3*this.eccSquared/8+3*this.eccSquared*this.eccSquared/32+45*this.eccSquared*this.eccSquared*this.eccSquared/1024)*Math.sin(2*s)+(15*this.eccSquared*this.eccSquared/256+45*this.eccSquared*this.eccSquared*this.eccSquared/1024)*Math.sin(4*s)-35*this.eccSquared*this.eccSquared*this.eccSquared/3072*Math.sin(6*s)),k=parseFloat(.9996*b*(P+(1-x+C)*P*P*P/6+(5-18*x+x*x+72*C-58*y)*P*P*P*P*P/120)+5e5),z=parseFloat(.9996*(M+b*Math.tan(s)*(P*P/2+(5-x+9*C+4*C*C)*P*P*P*P/24+(61-58*x+x*x+600*C-330*y)*P*P*P*P*P*P/720)));return r<0&&(z+=1e7),z=qP(z,e),k=qP(k,e),{Easting:k,Northing:z,ZoneNumber:parseInt(n),ZoneLetter:p}},Qf.convertUtmToLatLng=function(r,t,e,n){var i=(1-Math.sqrt(1-this.eccSquared))/(1+Math.sqrt(1-this.eccSquared)),s=r-5e5,a=t,o=e,d=n;if(r===void 0)return"Please pass the UTMEasting!";if(t===void 0)return"Please pass the UTMNorthing!";if(e===void 0)return"Please pass the UTMZoneNumber!";if(n===void 0)return"Please pass the UTMZoneLetter!";["N","P","Q","R","S","T","U","V","W","X","Y","Z"].indexOf(d)!==-1||(a-=1e7);var p=(o-1)*6-180+3,y=this.eccSquared/(1-this.eccSquared),b=a/.9996,x=b/(this.a*(1-this.eccSquared/4-3*this.eccSquared*this.eccSquared/64-5*this.eccSquared*this.eccSquared*this.eccSquared/256)),C=x+(3*i/2-27*i*i*i/32)*Math.sin(2*x)+(21*i*i/16-55*i*i*i*i/32)*Math.sin(4*x)+151*i*i*i/96*Math.sin(6*x);this.toDegrees(C);var P=this.a/Math.sqrt(1-this.eccSquared*Math.sin(C)*Math.sin(C)),M=Math.tan(C)*Math.tan(C),k=y*Math.cos(C)*Math.cos(C),z=this.a*(1-this.eccSquared)/Math.pow(1-this.eccSquared*Math.sin(C)*Math.sin(C),1.5),V=s/(P*.9996),$=C-P*Math.tan(C)/z*(V*V/2-(5+3*M+10*k-4*k*k-9*y)*V*V*V*V/24+(61+90*M+298*k+45*M*M-252*y-3*k*k)*V*V*V*V*V*V/720);$=this.toDegrees($);var tt=(V-(1+2*M+k)*V*V*V/6+(5-2*k+28*M-3*k*k+8*y+24*M*M)*V*V*V*V*V/120)/Math.cos(C);return tt=p+this.toDegrees(tt),{lat:$,lng:tt}},Qf.getUtmLetterDesignator=function(r){return r=parseFloat(r),84>=r&&r>=72?"X":72>r&&r>=64?"W":64>r&&r>=56?"V":56>r&&r>=48?"U":48>r&&r>=40?"T":40>r&&r>=32?"S":32>r&&r>=24?"R":24>r&&r>=16?"Q":16>r&&r>=8?"P":8>r&&r>=0?"N":0>r&&r>=-8?"M":-8>r&&r>=-16?"L":-16>r&&r>=-24?"K":-24>r&&r>=-32?"J":-32>r&&r>=-40?"H":-40>r&&r>=-48?"G":-48>r&&r>=-56?"F":-56>r&&r>=-64?"E":-64>r&&r>=-72?"D":-72>r&&r>=-80?"C":"Z"},Qf.setEllipsoid=function(r){switch(r){case"Airy":this.a=6377563,this.eccSquared=.00667054;break;case"Australian National":this.a=6378160,this.eccSquared=.006694542;break;case"Bessel 1841":this.a=6377397,this.eccSquared=.006674372;break;case"Bessel 1841 Nambia":this.a=6377484,this.eccSquared=.006674372;break;case"Clarke 1866":this.a=6378206,this.eccSquared=.006768658;break;case"Clarke 1880":this.a=6378249,this.eccSquared=.006803511;break;case"Everest":this.a=6377276,this.eccSquared=.006637847;break;case"Fischer 1960 Mercury":this.a=6378166,this.eccSquared=.006693422;break;case"Fischer 1968":this.a=6378150,this.eccSquared=.006693422;break;case"GRS 1967":this.a=6378160,this.eccSquared=.006694605;break;case"GRS 1980":this.a=6378137,this.eccSquared=.00669438;break;case"Helmert 1906":this.a=6378200,this.eccSquared=.006693422;break;case"Hough":this.a=6378270,this.eccSquared=.00672267;break;case"International":this.a=6378388,this.eccSquared=.00672267;break;case"Krassovsky":this.a=6378245,this.eccSquared=.006693422;break;case"Modified Airy":this.a=6377340,this.eccSquared=.00667054;break;case"Modified Everest":this.a=6377304,this.eccSquared=.006637847;break;case"Modified Fischer 1960":this.a=6378155,this.eccSquared=.006693422;break;case"South American 1969":this.a=6378160,this.eccSquared=.006694542;break;case"WGS 60":this.a=6378165,this.eccSquared=.006693422;break;case"WGS 66":this.a=6378145,this.eccSquared=.006694542;break;case"WGS 72":this.a=6378135,this.eccSquared=.006694318;break;case"ED50":this.a=6378388,this.eccSquared=.00672267;break;case"WGS 84":case"EUREF89":case"ETRS89":this.a=6378137,this.eccSquared=.00669438;break;default:this.status=!0}},Qf.toDegrees=function(r){return r/Math.PI*180},Qf.toRadians=function(r){return r*Math.PI/180};function qP(r,t){var e=Math.pow(10,t);return Math.round(r*e)/e}var Wnt=jP;const Xnt=Np(Wnt);class Jnt{constructor(t){this.options=t||{},this.options.utm=this.options.hasOwnProperty("utm")?this.options.utm:!0,this.options.lonlat=this.options.hasOwnProperty("lonlat")?this.options.lonlat:!0}onAdd(t){const e=new Xnt;return this._map=t,this._container=document.createElement("div"),this._container.className="maplibregl-ctrl coordControl",this._container.style.width=`${this.options.width||"225px"}`,this._map.on("mousemove",n=>{const i=n.lngLat.lat,s=n.lngLat.lng;let a="",o="";const d=e.convertLatLngToUtm(i,s,2),p=i>0?"N":"S";this.options.utm&&(a=`ETRS89 UTM ${d.ZoneNumber}${p} X:<b> ${d.Easting}</b> Y:<b> ${d.Northing}</b> <br>`),this.options.lonlat&&(o=`WGS 84 Lon:<b> ${s.toFixed(5)}</b>  Lat:<b> ${i.toFixed(5)}</b>`);const y=`${a}${o}`;this._container.innerHTML=y}),this._container}_lookUTM31(t,e){var n=0,i=0,s=6,a=84;return t>=n&&t<=s&&e>=i&&e<=a}onRemove(){this._container.parentNode.removeChild(this._container),this._map=void 0}}function KP(r,t){return function(){return r.apply(t,arguments)}}const{toString:Ynt}=Object.prototype,{getPrototypeOf:Y2}=Object,qy=(r=>t=>{const e=Ynt.call(t);return r[e]||(r[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),Jc=r=>(r=r.toLowerCase(),t=>qy(t)===r),Ky=r=>t=>typeof t===r,{isArray:zf}=Array,Gg=Ky("undefined");function Znt(r){return r!==null&&!Gg(r)&&r.constructor!==null&&!Gg(r.constructor)&&hl(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const $P=Jc("ArrayBuffer");function tit(r){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(r):t=r&&r.buffer&&$P(r.buffer),t}const eit=Ky("string"),hl=Ky("function"),WP=Ky("number"),$y=r=>r!==null&&typeof r=="object",rit=r=>r===!0||r===!1,Wy=r=>{if(qy(r)!=="object")return!1;const t=Y2(r);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},nit=Jc("Date"),iit=Jc("File"),sit=Jc("Blob"),oit=Jc("FileList"),ait=r=>$y(r)&&hl(r.pipe),lit=r=>{let t;return r&&(typeof FormData=="function"&&r instanceof FormData||hl(r.append)&&((t=qy(r))==="formdata"||t==="object"&&hl(r.toString)&&r.toString()==="[object FormData]"))},cit=Jc("URLSearchParams"),uit=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function jg(r,t){let{allOwnKeys:e=!1}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(r===null||typeof r>"u")return;let n,i;if(typeof r!="object"&&(r=[r]),zf(r))for(n=0,i=r.length;n<i;n++)t.call(null,r[n],n,r);else{const s=e?Object.getOwnPropertyNames(r):Object.keys(r),a=s.length;let o;for(n=0;n<a;n++)o=s[n],t.call(null,r[o],o,r)}}function XP(r,t){t=t.toLowerCase();const e=Object.keys(r);let n=e.length,i;for(;n-- >0;)if(i=e[n],t===i.toLowerCase())return i;return null}const JP=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,YP=r=>!Gg(r)&&r!==JP;function Z2(){const{caseless:r}=YP(this)&&this||{},t={},e=(n,i)=>{const s=r&&XP(t,i)||i;Wy(t[s])&&Wy(n)?t[s]=Z2(t[s],n):Wy(n)?t[s]=Z2({},n):zf(n)?t[s]=n.slice():t[s]=n};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&jg(arguments[n],e);return t}const Ait=function(r,t,e){let{allOwnKeys:n}=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return jg(t,(i,s)=>{e&&hl(i)?r[s]=KP(i,e):r[s]=i},{allOwnKeys:n}),r},hit=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),dit=(r,t,e,n)=>{r.prototype=Object.create(t.prototype,n),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:t.prototype}),e&&Object.assign(r.prototype,e)},fit=(r,t,e,n)=>{let i,s,a;const o={};if(t=t||{},r==null)return t;do{for(i=Object.getOwnPropertyNames(r),s=i.length;s-- >0;)a=i[s],(!n||n(a,r,t))&&!o[a]&&(t[a]=r[a],o[a]=!0);r=e!==!1&&Y2(r)}while(r&&(!e||e(r,t))&&r!==Object.prototype);return t},pit=(r,t,e)=>{r=String(r),(e===void 0||e>r.length)&&(e=r.length),e-=t.length;const n=r.indexOf(t,e);return n!==-1&&n===e},git=r=>{if(!r)return null;if(zf(r))return r;let t=r.length;if(!WP(t))return null;const e=new Array(t);for(;t-- >0;)e[t]=r[t];return e},mit=(r=>t=>r&&t instanceof r)(typeof Uint8Array<"u"&&Y2(Uint8Array)),yit=(r,t)=>{const n=(r&&r[Symbol.iterator]).call(r);let i;for(;(i=n.next())&&!i.done;){const s=i.value;t.call(r,s[0],s[1])}},_it=(r,t)=>{let e;const n=[];for(;(e=r.exec(t))!==null;)n.push(e);return n},vit=Jc("HTMLFormElement"),bit=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,n,i){return n.toUpperCase()+i}),ZP=(r=>{let{hasOwnProperty:t}=r;return(e,n)=>t.call(e,n)})(Object.prototype),wit=Jc("RegExp"),t4=(r,t)=>{const e=Object.getOwnPropertyDescriptors(r),n={};jg(e,(i,s)=>{let a;(a=t(i,s,r))!==!1&&(n[s]=a||i)}),Object.defineProperties(r,n)},xit=r=>{t4(r,(t,e)=>{if(hl(r)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const n=r[e];if(hl(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},Bit=(r,t)=>{const e={},n=i=>{i.forEach(s=>{e[s]=!0})};return zf(r)?n(r):n(String(r).split(t)),e},Cit=()=>{},Eit=(r,t)=>(r=+r,Number.isFinite(r)?r:t),tx="abcdefghijklmnopqrstuvwxyz",e4="0123456789",r4={DIGIT:e4,ALPHA:tx,ALPHA_DIGIT:tx+tx.toUpperCase()+e4},Sit=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r4.ALPHA_DIGIT,e="";const{length:n}=t;for(;r--;)e+=t[Math.random()*n|0];return e};function Tit(r){return!!(r&&hl(r.append)&&r[Symbol.toStringTag]==="FormData"&&r[Symbol.iterator])}const Iit=r=>{const t=new Array(10),e=(n,i)=>{if($y(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[i]=n;const s=zf(n)?[]:{};return jg(n,(a,o)=>{const d=e(a,i+1);!Gg(d)&&(s[o]=d)}),t[i]=void 0,s}}return n};return e(r,0)},Fit=Jc("AsyncFunction"),Se={isArray:zf,isArrayBuffer:$P,isBuffer:Znt,isFormData:lit,isArrayBufferView:tit,isString:eit,isNumber:WP,isBoolean:rit,isObject:$y,isPlainObject:Wy,isUndefined:Gg,isDate:nit,isFile:iit,isBlob:sit,isRegExp:wit,isFunction:hl,isStream:ait,isURLSearchParams:cit,isTypedArray:mit,isFileList:oit,forEach:jg,merge:Z2,extend:Ait,trim:uit,stripBOM:hit,inherits:dit,toFlatObject:fit,kindOf:qy,kindOfTest:Jc,endsWith:pit,toArray:git,forEachEntry:yit,matchAll:_it,isHTMLForm:vit,hasOwnProperty:ZP,hasOwnProp:ZP,reduceDescriptors:t4,freezeMethods:xit,toObjectSet:Bit,toCamelCase:bit,noop:Cit,toFiniteNumber:Eit,findKey:XP,global:JP,isContextDefined:YP,ALPHABET:r4,generateString:Sit,isSpecCompliantForm:Tit,toJSONObject:Iit,isAsyncFn:Fit,isThenable:r=>r&&($y(r)||hl(r))&&hl(r.then)&&hl(r.catch)};function In(r,t,e,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",t&&(this.code=t),e&&(this.config=e),n&&(this.request=n),i&&(this.response=i)}Se.inherits(In,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Se.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const n4=In.prototype,i4={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{i4[r]={value:r}}),Object.defineProperties(In,i4),Object.defineProperty(n4,"isAxiosError",{value:!0}),In.from=(r,t,e,n,i,s)=>{const a=Object.create(n4);return Se.toFlatObject(r,a,function(d){return d!==Error.prototype},o=>o!=="isAxiosError"),In.call(a,r.message,t,e,n,i),a.cause=r,a.name=r.name,s&&Object.assign(a,s),a};const Lit=null;function ex(r){return Se.isPlainObject(r)||Se.isArray(r)}function s4(r){return Se.endsWith(r,"[]")?r.slice(0,-2):r}function o4(r,t,e){return r?r.concat(t).map(function(i,s){return i=s4(i),!e&&s?"["+i+"]":i}).join(e?".":""):t}function Pit(r){return Se.isArray(r)&&!r.some(ex)}const Mit=Se.toFlatObject(Se,{},null,function(t){return/^is[A-Z]/.test(t)});function Xy(r,t,e){if(!Se.isObject(r))throw new TypeError("target must be an object");t=t||new FormData,e=Se.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(M,k){return!Se.isUndefined(k[M])});const n=e.metaTokens,i=e.visitor||y,s=e.dots,a=e.indexes,d=(e.Blob||typeof Blob<"u"&&Blob)&&Se.isSpecCompliantForm(t);if(!Se.isFunction(i))throw new TypeError("visitor must be a function");function p(P){if(P===null)return"";if(Se.isDate(P))return P.toISOString();if(!d&&Se.isBlob(P))throw new In("Blob is not supported. Use a Buffer instead.");return Se.isArrayBuffer(P)||Se.isTypedArray(P)?d&&typeof Blob=="function"?new Blob([P]):Buffer.from(P):P}function y(P,M,k){let z=P;if(P&&!k&&typeof P=="object"){if(Se.endsWith(M,"{}"))M=n?M:M.slice(0,-2),P=JSON.stringify(P);else if(Se.isArray(P)&&Pit(P)||(Se.isFileList(P)||Se.endsWith(M,"[]"))&&(z=Se.toArray(P)))return M=s4(M),z.forEach(function($,tt){!(Se.isUndefined($)||$===null)&&t.append(a===!0?o4([M],tt,s):a===null?M:M+"[]",p($))}),!1}return ex(P)?!0:(t.append(o4(k,M,s),p(P)),!1)}const b=[],x=Object.assign(Mit,{defaultVisitor:y,convertValue:p,isVisitable:ex});function C(P,M){if(!Se.isUndefined(P)){if(b.indexOf(P)!==-1)throw Error("Circular reference detected in "+M.join("."));b.push(P),Se.forEach(P,function(z,V){(!(Se.isUndefined(z)||z===null)&&i.call(t,z,Se.isString(V)?V.trim():V,M,x))===!0&&C(z,M?M.concat(V):[V])}),b.pop()}}if(!Se.isObject(r))throw new TypeError("data must be an object");return C(r),t}function a4(r){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function rx(r,t){this._pairs=[],r&&Xy(r,this,t)}const l4=rx.prototype;l4.append=function(t,e){this._pairs.push([t,e])},l4.toString=function(t){const e=t?function(n){return t.call(this,n,a4)}:a4;return this._pairs.map(function(i){return e(i[0])+"="+e(i[1])},"").join("&")};function Uit(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function c4(r,t,e){if(!t)return r;const n=e&&e.encode||Uit,i=e&&e.serialize;let s;if(i?s=i(t,e):s=Se.isURLSearchParams(t)?t.toString():new rx(t,e).toString(n),s){const a=r.indexOf("#");a!==-1&&(r=r.slice(0,a)),r+=(r.indexOf("?")===-1?"?":"&")+s}return r}class u4{constructor(){this.handlers=[]}use(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Se.forEach(this.handlers,function(n){n!==null&&t(n)})}}const A4={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Rit={isBrowser:!0,classes:{URLSearchParams:typeof URLSearchParams<"u"?URLSearchParams:rx,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]},h4=typeof window<"u"&&typeof document<"u",Oit=(r=>h4&&["ReactNative","NativeScript","NS"].indexOf(r)<0)(typeof navigator<"u"&&navigator.product),Dit=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Yc={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:h4,hasStandardBrowserEnv:Oit,hasStandardBrowserWebWorkerEnv:Dit},Symbol.toStringTag,{value:"Module"})),...Rit};function Nit(r,t){return Xy(r,new Yc.classes.URLSearchParams,Object.assign({visitor:function(e,n,i,s){return Yc.isNode&&Se.isBuffer(e)?(this.append(n,e.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function kit(r){return Se.matchAll(/\w+|\[(\w*)]/g,r).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Qit(r){const t={},e=Object.keys(r);let n;const i=e.length;let s;for(n=0;n<i;n++)s=e[n],t[s]=r[s];return t}function d4(r){function t(e,n,i,s){let a=e[s++];if(a==="__proto__")return!0;const o=Number.isFinite(+a),d=s>=e.length;return a=!a&&Se.isArray(i)?i.length:a,d?(Se.hasOwnProp(i,a)?i[a]=[i[a],n]:i[a]=n,!o):((!i[a]||!Se.isObject(i[a]))&&(i[a]=[]),t(e,n,i[a],s)&&Se.isArray(i[a])&&(i[a]=Qit(i[a])),!o)}if(Se.isFormData(r)&&Se.isFunction(r.entries)){const e={};return Se.forEachEntry(r,(n,i)=>{t(kit(n),i,e,0)}),e}return null}function zit(r,t,e){if(Se.isString(r))try{return(t||JSON.parse)(r),Se.trim(r)}catch(n){if(n.name!=="SyntaxError")throw n}return(e||JSON.stringify)(r)}const qg={transitional:A4,adapter:["xhr","http"],transformRequest:[function(t,e){const n=e.getContentType()||"",i=n.indexOf("application/json")>-1,s=Se.isObject(t);if(s&&Se.isHTMLForm(t)&&(t=new FormData(t)),Se.isFormData(t))return i?JSON.stringify(d4(t)):t;if(Se.isArrayBuffer(t)||Se.isBuffer(t)||Se.isStream(t)||Se.isFile(t)||Se.isBlob(t))return t;if(Se.isArrayBufferView(t))return t.buffer;if(Se.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Nit(t,this.formSerializer).toString();if((o=Se.isFileList(t))||n.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Xy(o?{"files[]":t}:t,d&&new d,this.formSerializer)}}return s||i?(e.setContentType("application/json",!1),zit(t)):t}],transformResponse:[function(t){const e=this.transitional||qg.transitional,n=e&&e.forcedJSONParsing,i=this.responseType==="json";if(t&&Se.isString(t)&&(n&&!this.responseType||i)){const a=!(e&&e.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(o){if(a)throw o.name==="SyntaxError"?In.from(o,In.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Yc.classes.FormData,Blob:Yc.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Se.forEach(["delete","get","head","post","put","patch"],r=>{qg.headers[r]={}});const Hit=Se.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Vit=r=>{const t={};let e,n,i;return r&&r.split(`
`).forEach(function(a){i=a.indexOf(":"),e=a.substring(0,i).trim().toLowerCase(),n=a.substring(i+1).trim(),!(!e||t[e]&&Hit[e])&&(e==="set-cookie"?t[e]?t[e].push(n):t[e]=[n]:t[e]=t[e]?t[e]+", "+n:n)}),t},f4=Symbol("internals");function Kg(r){return r&&String(r).trim().toLowerCase()}function Jy(r){return r===!1||r==null?r:Se.isArray(r)?r.map(Jy):String(r)}function Git(r){const t=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=e.exec(r);)t[n[1]]=n[2];return t}const jit=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function nx(r,t,e,n,i){if(Se.isFunction(n))return n.call(this,t,e);if(i&&(t=e),!!Se.isString(t)){if(Se.isString(n))return t.indexOf(n)!==-1;if(Se.isRegExp(n))return n.test(t)}}function qit(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,n)=>e.toUpperCase()+n)}function Kit(r,t){const e=Se.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(r,n+e,{value:function(i,s,a){return this[n].call(this,t,i,s,a)},configurable:!0})})}class dl{constructor(t){t&&this.set(t)}set(t,e,n){const i=this;function s(o,d,p){const y=Kg(d);if(!y)throw new Error("header name must be a non-empty string");const b=Se.findKey(i,y);(!b||i[b]===void 0||p===!0||p===void 0&&i[b]!==!1)&&(i[b||d]=Jy(o))}const a=(o,d)=>Se.forEach(o,(p,y)=>s(p,y,d));return Se.isPlainObject(t)||t instanceof this.constructor?a(t,e):Se.isString(t)&&(t=t.trim())&&!jit(t)?a(Vit(t),e):t!=null&&s(e,t,n),this}get(t,e){if(t=Kg(t),t){const n=Se.findKey(this,t);if(n){const i=this[n];if(!e)return i;if(e===!0)return Git(i);if(Se.isFunction(e))return e.call(this,i,n);if(Se.isRegExp(e))return e.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=Kg(t),t){const n=Se.findKey(this,t);return!!(n&&this[n]!==void 0&&(!e||nx(this,this[n],n,e)))}return!1}delete(t,e){const n=this;let i=!1;function s(a){if(a=Kg(a),a){const o=Se.findKey(n,a);o&&(!e||nx(n,n[o],o,e))&&(delete n[o],i=!0)}}return Se.isArray(t)?t.forEach(s):s(t),i}clear(t){const e=Object.keys(this);let n=e.length,i=!1;for(;n--;){const s=e[n];(!t||nx(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const e=this,n={};return Se.forEach(this,(i,s)=>{const a=Se.findKey(n,s);if(a){e[a]=Jy(i),delete e[s];return}const o=t?qit(s):String(s).trim();o!==s&&delete e[s],e[o]=Jy(i),n[o]=!0}),this}concat(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.constructor.concat(this,...e)}toJSON(t){const e=Object.create(null);return Se.forEach(this,(n,i)=>{n!=null&&n!==!1&&(e[i]=t&&Se.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(t=>{let[e,n]=t;return e+": "+n}).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t){const e=new this(t);for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return i.forEach(a=>e.set(a)),e}static accessor(t){const n=(this[f4]=this[f4]={accessors:{}}).accessors,i=this.prototype;function s(a){const o=Kg(a);n[o]||(Kit(i,a),n[o]=!0)}return Se.isArray(t)?t.forEach(s):s(t),this}}dl.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Se.reduceDescriptors(dl.prototype,(r,t)=>{let{value:e}=r,n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[n]=i}}}),Se.freezeMethods(dl);function ix(r,t){const e=this||qg,n=t||e,i=dl.from(n.headers);let s=n.data;return Se.forEach(r,function(o){s=o.call(e,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function p4(r){return!!(r&&r.__CANCEL__)}function $g(r,t,e){In.call(this,r??"canceled",In.ERR_CANCELED,t,e),this.name="CanceledError"}Se.inherits($g,In,{__CANCEL__:!0});function $it(r,t,e){const n=e.config.validateStatus;!e.status||!n||n(e.status)?r(e):t(new In("Request failed with status code "+e.status,[In.ERR_BAD_REQUEST,In.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}const Wit=Yc.hasStandardBrowserEnv?{write(r,t,e,n,i,s){const a=[r+"="+encodeURIComponent(t)];Se.isNumber(e)&&a.push("expires="+new Date(e).toGMTString()),Se.isString(n)&&a.push("path="+n),Se.isString(i)&&a.push("domain="+i),s===!0&&a.push("secure"),document.cookie=a.join("; ")},read(r){const t=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Xit(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function Jit(r,t){return t?r.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):r}function g4(r,t){return r&&!Xit(t)?Jit(r,t):t}const Yit=Yc.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let n;function i(s){let a=s;return t&&(e.setAttribute("href",a),a=e.href),e.setAttribute("href",a),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:e.pathname.charAt(0)==="/"?e.pathname:"/"+e.pathname}}return n=i(window.location.href),function(a){const o=Se.isString(a)?i(a):a;return o.protocol===n.protocol&&o.host===n.host}}():function(){return function(){return!0}}();function Zit(r){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return t&&t[1]||""}function tst(r,t){r=r||10;const e=new Array(r),n=new Array(r);let i=0,s=0,a;return t=t!==void 0?t:1e3,function(d){const p=Date.now(),y=n[s];a||(a=p),e[i]=d,n[i]=p;let b=s,x=0;for(;b!==i;)x+=e[b++],b=b%r;if(i=(i+1)%r,i===s&&(s=(s+1)%r),p-a<t)return;const C=y&&p-y;return C?Math.round(x*1e3/C):void 0}}function m4(r,t){let e=0;const n=tst(50,250);return i=>{const s=i.loaded,a=i.lengthComputable?i.total:void 0,o=s-e,d=n(o),p=s<=a;e=s;const y={loaded:s,total:a,progress:a?s/a:void 0,bytes:o,rate:d||void 0,estimated:d&&a&&p?(a-s)/d:void 0,event:i};y[t?"download":"upload"]=!0,r(y)}}const sx={http:Lit,xhr:typeof XMLHttpRequest<"u"&&function(r){return new Promise(function(e,n){let i=r.data;const s=dl.from(r.headers).normalize();let{responseType:a,withXSRFToken:o}=r,d;function p(){r.cancelToken&&r.cancelToken.unsubscribe(d),r.signal&&r.signal.removeEventListener("abort",d)}let y;if(Se.isFormData(i)){if(Yc.hasStandardBrowserEnv||Yc.hasStandardBrowserWebWorkerEnv)s.setContentType(!1);else if((y=s.getContentType())!==!1){const[M,...k]=y?y.split(";").map(z=>z.trim()).filter(Boolean):[];s.setContentType([M||"multipart/form-data",...k].join("; "))}}let b=new XMLHttpRequest;if(r.auth){const M=r.auth.username||"",k=r.auth.password?unescape(encodeURIComponent(r.auth.password)):"";s.set("Authorization","Basic "+btoa(M+":"+k))}const x=g4(r.baseURL,r.url);b.open(r.method.toUpperCase(),c4(x,r.params,r.paramsSerializer),!0),b.timeout=r.timeout;function C(){if(!b)return;const M=dl.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),z={data:!a||a==="text"||a==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:M,config:r,request:b};$it(function($){e($),p()},function($){n($),p()},z),b=null}if("onloadend"in b?b.onloadend=C:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(C)},b.onabort=function(){b&&(n(new In("Request aborted",In.ECONNABORTED,r,b)),b=null)},b.onerror=function(){n(new In("Network Error",In.ERR_NETWORK,r,b)),b=null},b.ontimeout=function(){let k=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const z=r.transitional||A4;r.timeoutErrorMessage&&(k=r.timeoutErrorMessage),n(new In(k,z.clarifyTimeoutError?In.ETIMEDOUT:In.ECONNABORTED,r,b)),b=null},Yc.hasStandardBrowserEnv&&(o&&Se.isFunction(o)&&(o=o(r)),o||o!==!1&&Yit(x))){const M=r.xsrfHeaderName&&r.xsrfCookieName&&Wit.read(r.xsrfCookieName);M&&s.set(r.xsrfHeaderName,M)}i===void 0&&s.setContentType(null),"setRequestHeader"in b&&Se.forEach(s.toJSON(),function(k,z){b.setRequestHeader(z,k)}),Se.isUndefined(r.withCredentials)||(b.withCredentials=!!r.withCredentials),a&&a!=="json"&&(b.responseType=r.responseType),typeof r.onDownloadProgress=="function"&&b.addEventListener("progress",m4(r.onDownloadProgress,!0)),typeof r.onUploadProgress=="function"&&b.upload&&b.upload.addEventListener("progress",m4(r.onUploadProgress)),(r.cancelToken||r.signal)&&(d=M=>{b&&(n(!M||M.type?new $g(null,r,b):M),b.abort(),b=null)},r.cancelToken&&r.cancelToken.subscribe(d),r.signal&&(r.signal.aborted?d():r.signal.addEventListener("abort",d)));const P=Zit(x);if(P&&Yc.protocols.indexOf(P)===-1){n(new In("Unsupported protocol "+P+":",In.ERR_BAD_REQUEST,r));return}b.send(i||null)})}};Se.forEach(sx,(r,t)=>{if(r){try{Object.defineProperty(r,"name",{value:t})}catch{}Object.defineProperty(r,"adapterName",{value:t})}});const y4=r=>`- ${r}`,est=r=>Se.isFunction(r)||r===null||r===!1,_4={getAdapter:r=>{r=Se.isArray(r)?r:[r];const{length:t}=r;let e,n;const i={};for(let s=0;s<t;s++){e=r[s];let a;if(n=e,!est(e)&&(n=sx[(a=String(e)).toLowerCase()],n===void 0))throw new In(`Unknown adapter '${a}'`);if(n)break;i[a||"#"+s]=n}if(!n){const s=Object.entries(i).map(o=>{let[d,p]=o;return`adapter ${d} `+(p===!1?"is not supported by the environment":"is not available in the build")});let a=t?s.length>1?`since :
`+s.map(y4).join(`
`):" "+y4(s[0]):"as no adapter specified";throw new In("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return n},adapters:sx};function ox(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new $g(null,r)}function v4(r){return ox(r),r.headers=dl.from(r.headers),r.data=ix.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),_4.getAdapter(r.adapter||qg.adapter)(r).then(function(n){return ox(r),n.data=ix.call(r,r.transformResponse,n),n.headers=dl.from(n.headers),n},function(n){return p4(n)||(ox(r),n&&n.response&&(n.response.data=ix.call(r,r.transformResponse,n.response),n.response.headers=dl.from(n.response.headers))),Promise.reject(n)})}const b4=r=>r instanceof dl?{...r}:r;function Hf(r,t){t=t||{};const e={};function n(p,y,b){return Se.isPlainObject(p)&&Se.isPlainObject(y)?Se.merge.call({caseless:b},p,y):Se.isPlainObject(y)?Se.merge({},y):Se.isArray(y)?y.slice():y}function i(p,y,b){if(Se.isUndefined(y)){if(!Se.isUndefined(p))return n(void 0,p,b)}else return n(p,y,b)}function s(p,y){if(!Se.isUndefined(y))return n(void 0,y)}function a(p,y){if(Se.isUndefined(y)){if(!Se.isUndefined(p))return n(void 0,p)}else return n(void 0,y)}function o(p,y,b){if(b in t)return n(p,y);if(b in r)return n(void 0,p)}const d={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(p,y)=>i(b4(p),b4(y),!0)};return Se.forEach(Object.keys(Object.assign({},r,t)),function(y){const b=d[y]||i,x=b(r[y],t[y],y);Se.isUndefined(x)&&b!==o||(e[y]=x)}),e}const w4="1.6.8",ax={};["object","boolean","number","function","string","symbol"].forEach((r,t)=>{ax[r]=function(n){return typeof n===r||"a"+(t<1?"n ":" ")+r}});const x4={};ax.transitional=function(t,e,n){function i(s,a){return"[Axios v"+w4+"] Transitional option '"+s+"'"+a+(n?". "+n:"")}return(s,a,o)=>{if(t===!1)throw new In(i(a," has been removed"+(e?" in "+e:"")),In.ERR_DEPRECATED);return e&&!x4[a]&&(x4[a]=!0,console.warn(i(a," has been deprecated since v"+e+" and will be removed in the near future"))),t?t(s,a,o):!0}};function rst(r,t,e){if(typeof r!="object")throw new In("options must be an object",In.ERR_BAD_OPTION_VALUE);const n=Object.keys(r);let i=n.length;for(;i-- >0;){const s=n[i],a=t[s];if(a){const o=r[s],d=o===void 0||a(o,s,r);if(d!==!0)throw new In("option "+s+" must be "+d,In.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new In("Unknown option "+s,In.ERR_BAD_OPTION)}}const lx={assertOptions:rst,validators:ax},$A=lx.validators;class sd{constructor(t){this.defaults=t,this.interceptors={request:new u4,response:new u4}}async request(t,e){try{return await this._request(t,e)}catch(n){if(n instanceof Error){let i;Error.captureStackTrace?Error.captureStackTrace(i={}):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}throw n}}_request(t,e){typeof t=="string"?(e=e||{},e.url=t):e=t||{},e=Hf(this.defaults,e);const{transitional:n,paramsSerializer:i,headers:s}=e;n!==void 0&&lx.assertOptions(n,{silentJSONParsing:$A.transitional($A.boolean),forcedJSONParsing:$A.transitional($A.boolean),clarifyTimeoutError:$A.transitional($A.boolean)},!1),i!=null&&(Se.isFunction(i)?e.paramsSerializer={serialize:i}:lx.assertOptions(i,{encode:$A.function,serialize:$A.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let a=s&&Se.merge(s.common,s[e.method]);s&&Se.forEach(["delete","get","head","post","put","patch","common"],P=>{delete s[P]}),e.headers=dl.concat(a,s);const o=[];let d=!0;this.interceptors.request.forEach(function(M){typeof M.runWhen=="function"&&M.runWhen(e)===!1||(d=d&&M.synchronous,o.unshift(M.fulfilled,M.rejected))});const p=[];this.interceptors.response.forEach(function(M){p.push(M.fulfilled,M.rejected)});let y,b=0,x;if(!d){const P=[v4.bind(this),void 0];for(P.unshift.apply(P,o),P.push.apply(P,p),x=P.length,y=Promise.resolve(e);b<x;)y=y.then(P[b++],P[b++]);return y}x=o.length;let C=e;for(b=0;b<x;){const P=o[b++],M=o[b++];try{C=P(C)}catch(k){M.call(this,k);break}}try{y=v4.call(this,C)}catch(P){return Promise.reject(P)}for(b=0,x=p.length;b<x;)y=y.then(p[b++],p[b++]);return y}getUri(t){t=Hf(this.defaults,t);const e=g4(t.baseURL,t.url);return c4(e,t.params,t.paramsSerializer)}}Se.forEach(["delete","get","head","options"],function(t){sd.prototype[t]=function(e,n){return this.request(Hf(n||{},{method:t,url:e,data:(n||{}).data}))}}),Se.forEach(["post","put","patch"],function(t){function e(n){return function(s,a,o){return this.request(Hf(o||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}sd.prototype[t]=e(),sd.prototype[t+"Form"]=e(!0)});class cx{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(s){e=s});const n=this;this.promise.then(i=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](i);n._listeners=null}),this.promise.then=i=>{let s;const a=new Promise(o=>{n.subscribe(o),s=o}).then(i);return a.cancel=function(){n.unsubscribe(s)},a},t(function(s,a,o){n.reason||(n.reason=new $g(s,a,o),e(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);e!==-1&&this._listeners.splice(e,1)}static source(){let t;return{token:new cx(function(i){t=i}),cancel:t}}}function nst(r){return function(e){return r.apply(null,e)}}function ist(r){return Se.isObject(r)&&r.isAxiosError===!0}const ux={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ux).forEach(r=>{let[t,e]=r;ux[e]=t});function B4(r){const t=new sd(r),e=KP(sd.prototype.request,t);return Se.extend(e,sd.prototype,t,{allOwnKeys:!0}),Se.extend(e,t,null,{allOwnKeys:!0}),e.create=function(i){return B4(Hf(r,i))},e}const as=B4(qg);as.Axios=sd,as.CanceledError=$g,as.CancelToken=cx,as.isCancel=p4,as.VERSION=w4,as.toFormData=Xy,as.AxiosError=In,as.Cancel=as.CanceledError,as.all=function(t){return Promise.all(t)},as.spread=nst,as.isAxiosError=ist,as.mergeConfig=Hf,as.AxiosHeaders=dl,as.formToJSON=r=>d4(Se.isHTMLForm(r)?new FormData(r):r),as.getAdapter=_4.getAdapter,as.HttpStatusCode=ux,as.default=as;const sst="https://tilemaps.icgc.cat/cdn/configs/mapicgc-config.json",ost=5e3;class C4{static async getConfigICGC(){try{const t=await as.get(sst,{timeout:ost});return t.data?t.data:(console.log("Resposta sense dades:",t),id)}catch(t){return t.response?(console.error("Error de resposta:",t.response.data),console.error("Codi d'estat:",t.response.status)):t.request?console.error("No s'ha rebut resposta del servidor:",t.request):console.error("Error:",t.message),id}}}const ast={cobertesSol:{"fill-opacity":["interpolate",["exponential",.5],["zoom"],13.5,1,18,.4],"fill-outline-color":"rgba(0,0, 0, 0)","fill-color":["interpolate",["cubic-bezier",.5,1,1,1],["get","nivell_2"],0,"#ffffff",111,"#ffff00",112,"#ccff33",113,"#af5b15",114,"#808000",115,"#cdcd00",116,"#ffffcc",221,"#33cc33",222,"#66ff33",223,"#689018",224,"#967d5f",225,"#19e61e",226,"#b4ff9b",227,"#aaa500",228,"#c3c3a0",229,"#00ff9b",230,"#ff9632",231,"#282828",232,"#79797a",233,"#f5df78",234,"#3296ff",341,"#ff007d",342,"#ff53cd",343,"#ffa4e2",344,"#ffc8e2",345,"#ffb4b4",346,"#0f3700",347,"#730055",348,"#6200c4",349,"#4a9595",350,"#ff00f0",351,"#adaaca",352,"#ffe6e6",353,"#67629a",354,"#4a466e",355,"#2f2d46",461,"#6f6fff",462,"#0000dc",463,"#000064",464,"#185f94",465,"#12466d",466,"#000080"]}},lst="lines",Yy="labels";let od,Wg,Qi,Pn,cst=class{constructor(t){C4.getConfigICGC().then(e=>{od={...e.Styles},Qi={...e.Layers},Wg={...e.Terrains},Pn={...e.defaultOptions},this.initTheMap(t)}).catch(e=>{console.info("Configuracio per defecte",e),od={...id.Styles},Qi={...id.Layers},Wg={...id.Terrains},Pn={...id.defaultOptions},this.initTheMap(t)})}initTheMap(t){if(!t)t=Pn.mapOptions;else for(const e in Pn.mapOptions){let n=[Pn.mapOptions.center[0],Pn.mapOptions.center[1]];Pn.mapOptions.center=n,t.hasOwnProperty(e)||(t[e]=Pn.mapOptions[e])}t.maxPitch=85,t.maplibreLogo=!1,t.attributionControl=!1,this.map=new Ls.Map(t),this.map.options=t,this.map.addControl(new Ls.AttributionControl({compact:!0})),this.map.on("load",async()=>{const e=this.map.getStyle().name,n=this.map.options.style;if(window.document.querySelector(".maplibregl-compact-show")){var i=window.document.querySelector(".maplibregl-compact-show");i.classList.remove("maplibregl-compact-show")}this.map.addControl(new Knt({color:n.indexOf("orto")===-1,defaultOptions:Pn}),"bottom-left"),this._dealOrto3dStyle(e)})}addGeocoderICGC(t){try{t===void 0&&(t="top-right");let e={collapsed:!0,marker:!0,popup:!0,showResultMarkers:!0,maplibregl:Ls,showResultsWhileTyping:!0,minLength:2};const n={forwardGeocode:async s=>{const a=[];try{const o=Pn.geocoder.peliasUrl1+encodeURIComponent(s.query)+Pn.geocoder.peliasUrl2,p=await(await fetch(o)).json();for(const y of p.features){const b=y.geometry.coordinates,x={type:"Feature",geometry:{type:"Point",coordinates:b},place_name:y.properties.etiqueta,properties:y.properties,text:y.properties.etiqueta,place_type:["place"],center:b};a.push(x)}}catch(o){console.error(`Failed to forwardGeocode with error: ${o}`)}return{features:a}}};this.map.addControl(new qnt(n,e),t);let i=document.getElementsByClassName("maplibregl-ctrl-geocoder--input");i[0].attributes[2].nodeValue="Cerca...",i[0].addEventListener("input",function(s){s.target.value.length>3})}catch(e){console.error(`Error adding ICGC geocoder: ${e.message}`)}}async loadImage(t){try{return this.map.loadImage(t)}catch(e){console.error(`Error getting loadImage: ${e.message}`)}}getConfigStyles(){try{let t=[];for(const e of od)t.push(e.name);return t}catch(t){console.error(`Error retrieving base styles: ${t.message}`)}}getConfigWMSLayers(){try{let t=[];for(const e in Qi.WMS)Qi.WMS.hasOwnProperty(e)&&t.push(e);return t}catch(t){console.error(`Error retrieving WMS layers: ${t.message}`)}}getConfigOrtoLayers(){try{let t=[];for(const e in Qi.Orto)Qi.Orto.hasOwnProperty(e)&&t.push(e);return t}catch(t){console.error(`Error retrieving orto image layers: ${t.message}`)}}getConfigVectorLayers(){try{let t=[];for(const e in Qi.Vector)Qi.Vector.hasOwnProperty(e)&&t.push(e);return t}catch(t){console.error(`Error retrieving vector layers: ${t.message}`)}}getConfigVectorAdminLayers(){try{let t=[];for(const e in Qi.VectorAdmin)Qi.VectorAdmin.hasOwnProperty(e)&&t.push(e);return t}catch(t){console.error(`Error retrieving vectorAdmin layers: ${t.message}`)}}getConfigFGBAdminLayers(){try{let t=[];for(const e in Qi.FGBAdmin)Qi.FGBAdmin.hasOwnProperty(e)&&t.push(e);return t}catch(t){console.error(`Error retrieving FGBAdmin layers: ${t.message}`)}}async fetchData(t,e,n){try{(!n||n===void 0)&&(n={type:"line",layout:{visibility:"visible"},paint:{"line-color":"grey","line-width":2},layerPosition:"top"});let i=n.layerPosition;if(t.includes(".fgb"))this.addFGBLayerICGC(t,e,n);else{const a=await(await fetch(t)).json();let o=e,d=this._dealOrderLayer(i),p=a.features[0].geometry.type;p.includes("ine")&&(n!==void 0?this.map.addLayer({id:o,type:"line",source:{type:"geojson",data:a},layout:n.layout||{},paint:n.paint||{}},d):this.map.addLayer({id:o,type:"line",source:{type:"geojson",data:a},layout:{visibility:"visible"},paint:{"line-color":"black","line-width":2,"line-opacity":1}},d)),p.includes("olygon")&&(n!==void 0?this.map.addLayer({id:o,type:"fill",source:{type:"geojson",data:a},layout:n.layout,paint:n.paint},d):this.map.addLayer({id:o,type:"fill",source:{type:"geojson",data:a},layout:{visibility:"visible"},paint:{"fill-color":"blue","fill-opacity":.6}},d)),p.includes("oint")&&(n!==void 0?this.map.addLayer({id:o,type:"circle",source:{type:"geojson",data:a},layout:n.layout,paint:n.paint},d):this.map.addLayer({id:o,type:"circle",source:{type:"geojson",data:a},layout:{visibility:"visible"},paint:{"circle-color":"red","circle-opacity":.85}},d))}}catch(i){console.error(`Error fetching data: ${i.message}`)}}async fetchDataAndMenu(t,e,n,i){try{let s;i!==null?s=i.layerPosition:s=Yy;let a,o=document.getElementById("map");if(document.getElementById("menu-group")?a=document.getElementById("menu-group"):(a=document.createElement("nav"),a.id="menu-group",a.classList.add="filter-group",o.appendChild(a)),a!==null){let d="visible",p=this._dealOrderLayer(s),y;if(t.includes(".fgb")){let x=this._getKeyByUrlFGB(t);x===null&&(x="userFGB");const C=await fetch(t),P={type:"FeatureCollection",features:[]};for await(const k of US(C.body))P.features.push(k);y=P;let M=e;if(this.map.addSource(M,{type:"geojson",data:P}),t.includes("text"))i!==void 0?this.map.addLayer({id:e,type:"symbol",source:M,layout:i.layout,paint:i.paint},p):this.map.addLayer({id:e,type:"symbol",source:M,layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[8,0],[12,14],[15,15]]},"text-font":["FiraSans-Regular"],"text-field":["get","NOM_AC"],"text-transform":"none","text-max-width":25,visibility:d,"text-justify":"right","text-anchor":"top","text-allow-overlap":!1,"symbol-spacing":2,"text-line-height":1},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},p);else{let k=e+"Text";this.map.addLayer({id:k,type:"symbol",source:M,layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[8,0],[12,14],[15,15]]},"text-font":["FiraSans-Regular"],"text-field":["get","NOM_AC"],"text-transform":"none","text-max-width":25,visibility:d,"text-justify":"right","text-anchor":"top","text-allow-overlap":!1,"symbol-spacing":2,"text-line-height":1},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},p)}}else y=await(await fetch(t)).json();if(n!=="all"){const x=document.createElement("div");x.id="titleDivMenu",x.textContent=e,a.appendChild(x);const C=document.createElement("div");C.id="titleDivMenuSub",C.textContent=` ${n}`,a.appendChild(C)}let b;if(i.type?b=i.type:b=y.features[0].geometry.type,n==="all")b.includes("ine")&&(i!==void 0?this.map.addLayer({id:e,type:"line",source:{type:"geojson",data:y},layout:i.layout,paint:i.paint},p):this.map.addLayer({id:e,type:"line",source:{type:"geojson",data:y},layout:{visibility:"visible"},paint:{"line-color":"black","line-width":2,"line-opacity":1}},p)),b.includes("olygon")&&(i!==void 0?this.map.addLayer({id:e,type:"fill",source:{type:"geojson",data:y},layout:i.layout,paint:i.paint},p):this.map.addLayer({id:e,type:"fill",source:{type:"geojson",data:y},layout:{visibility:"visible"},paint:{"fill-color":"#0000FF","fill-opacity":0}},p)),b.includes("oint")&&(i!==void 0?this.map.addLayer({id:e,type:"circle",source:{type:"geojson",data:y},layout:i.layout,paint:i.paint},p):this.map.addLayer({id:e,type:"circle",source:{type:"geojson",data:y},layout:{visibility:"visible"},paint:{"circle-color":"red","circle-opacity":.85}},p)),b.includes("ymbol")&&(i!==void 0?this.map.addLayer({id:e,type:"symbol",source:{type:"geojson",data:y},layout:i.layout,paint:i.paint},p):this.map.addLayer({id:e,type:"symbol",source:{type:"geojson",data:y},layout:{visibility:"visible"},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},p)),this.addMenuItem(e);else{let x=n;const C={};y.features.forEach(P=>{const M=P.properties[x],k=M+"-userFieldFilter-"+e;M!==null&&(C[k]||(b.includes("ine")&&(i!==void 0?this.map.addLayer({id:k,type:"line",source:{type:"geojson",data:y},layout:i.layout,paint:i.paint,filter:["==",`${x}`,M]},p):this.map.addLayer({id:k,type:"line",source:{type:"geojson",data:y},layout:{visibility:"visible"},filter:["==",`${x}`,M],paint:{"line-color":"black","line-width":2,"line-opacity":1}},p)),b.includes("olygon")&&(i!==void 0?this.map.addLayer({id:k,type:"fill",source:{type:"geojson",data:y},filter:["==",`${x}`,M],layout:i.layout,paint:i.paint},p):this.map.addLayer({id:k,type:"fill",source:{type:"geojson",data:y},layout:{visibility:"visible"},filter:["==",`${x}`,M],paint:{"fill-color":"blue","fill-opacity":.6}},p)),b.includes("oint")&&(i!==void 0?this.map.addLayer({id:k,type:"circle",source:{type:"geojson",data:y},filter:["==",`${x}`,M],layout:i.layout,paint:i.paint},p):this.map.addLayer({id:k,type:"circle",source:{type:"geojson",data:y},layout:{visibility:"visible"},filter:["==",`${x}`,M],paint:{"circle-color":"red","circle-opacity":.85}},p)),C[k]=!0,this.addMenuItem(k)))})}}}catch(s){console.error(`Error fetching data: ${s.message}`)}}on(t,e){setTimeout(()=>{try{this.map.on(t,e)}catch(n){console.error(`Error adding event ON listener: ${n.message}`)}},500)}setStyle(t,e){try{e!==void 0?this.map.setStyle(t,e):this.map.setStyle(t),this.map.on("styledata",()=>{if(window.document.querySelector(".maplibregl-compact-show")){var n=window.document.querySelector(".maplibregl-compact-show");n.classList.remove("maplibregl-compact-show")}this._dealOrto3dStyle(this.map.getStyle().name)})}catch(n){console.error(`Error setting style: ${n.message}`)}}addControl(t,e){try{e===void 0&&(e="top-right"),this.map.addControl(t,e)}catch(n){console.error(`Error adding control: ${n.message}`)}}setSky(t){try{t===void 0&&(this.map.options.style.includes("orto")&&(t={"sky-color":"#86bbd5","sky-horizon-blend":.3,"horizon-color":"#ffffff33","horizon-fog-blend":.1,"fog-ground-blend":.75,"fog-color":"#c5d6d6"}),this.map.options.style.includes("mapa_estandard_general")&&(t={"sky-color":"#a5f0f0","sky-horizon-blend":.3,"horizon-color":"#e1e3e3","horizon-fog-blend":.9,"fog-ground-blend":.85,"fog-color":"#c5d6d6"}),this.map.options.style.includes("fosc")&&(t={"sky-color":"#232423","sky-horizon-blend":.3,"horizon-color":"#969996","horizon-fog-blend":.9,"fog-ground-blend":.85,"fog-color":"#383838"})),this.map.setSky(t)}catch(e){console.error(`Error setting sky properties: ${e.message}`)}}addMouseCoordControl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"bottom-left";try{this.map.addControl(new Jnt(t),e)}catch(n){console.error(`Error adding mouse coordinate control: ${n.message}`)}}addGeolocateControl(t,e){try{e===void 0&&(e="top-right"),t===void 0?this.map.addControl(new Ls.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),e):this.map.addControl(new Ls.GeolocateControl(t),e)}catch(n){console.error(`Error adding geolocate control: ${n.message}`)}}addFullscreenControl(t,e){try{e===void 0&&(e="top-right"),t===void 0?this.map.addControl(new Ls.FullscreenControl({container:HTMLElement}),e):this.map.addControl(new Ls.FullscreenControl(t),e)}catch(n){console.error(`Error adding fullscreen control: ${n.message}`)}}addLayer(t,e){try{this.map.addLayer(t,e)}catch(n){console.error(`Error adding layer: ${n.message}`)}}addImage(t,e,n){try{this.map.addImage(t,e,n)}catch(i){console.error(`Error adding image: ${i.message}`)}return this}addSource(t,e){try{this.map.addSource(t,e)}catch(n){console.error(`Error adding source: ${n.message}`)}return this}addSprite(t,e,n){try{this.map.addSprite(t,e,n)}catch(i){console.error(`Error adding sprite: ${i.message}`)}return this}areTilesLoaded(){return this.map.areTilesLoaded()}cameraForBounds(t,e){return this.map.cameraForBounds(t,e)}easeTo(t,e){return this.map.easeTo(t,e),this}fitBounds(t,e,n){return this.map.fitBounds(t,e,n),this}fitScreenCoordinates(t,e,n,i,s){return this.map.fitScreenCoordinates(t,e,n,i,s),this}flyTo(t,e){return this.map.flyTo(t,e),this}getBearing(){return this.map.getBearing()}getBounds(){return this.map.getBounds()}getCameraTargetElevation(){return this.map.getCameraTargetElevation()}getCanvas(){return this.map.getCanvas()}getCanvasContainer(){return this.map.getCanvasContainer()}getCenter(){return this.map.getCenter()}getContainer(){return this.map.getContainer()}getFeatureState(t){return this.map.getFeatureState(t)}getFilter(t){return this.map.getFilter(t)}getGlyphs(){return this.map.getGlyphs()}getImage(t){return this.map.getImage(t)}getLayer(t){return this.map.getLayer(t)}getLayersOrder(){return this.map.getLayersOrder()}getLayoutProperty(t,e){return this.map.getLayoutProperty(t,e)}getLight(){return this.map.getLight()}getMaxBounds(){return this.map.getMaxBounds()}getMaxPitch(){return this.map.getMaxPitch()}getMaxZoom(){return this.map.getMaxZoom()}getMinPitch(){return this.map.getMinPitch()}getMinZoom(){return this.map.getMinZoom()}getPadding(){return this.map.getPadding()}getPaintProperty(t,e){return this.map.getPaintProperty(t,e)}getPitch(){return this.map.getPitch()}getPixelRatio(){return this.map.getPixelRatio()}getRenderWorldCopies(){return this.map.getRenderWorldCopies()}getSource(t){return this.map.getSource(t)}getSprite(){return this.map.getSprite()}getStyle(){return this.map.getStyle()}getTerrain(){return this.map.getTerrain()}getZoom(){return this.map.getZoom()}hasControl(t){return this.map.hasControl(t)}hasImage(t){return this.map.hasImage(t)}isMoving(){return this.map.isMoving()}isRotating(){return this.map.isRotating()}isSourceLoaded(t){return this.map.isSourceLoaded(t)}isStyleLoaded(){return this.map.isStyleLoaded()}isZooming(){return this.map.isZooming()}jumpTo(t,e){return this.map.jumpTo(t,e)}listImages(){return this.map.listImages()}listens(t){return this.map.listens(t)}loadImage(t){return this.map.loadImage(t)}loaded(){return this.map.loaded()}LngLatBounds(t,e){return new Ls.LngLatBounds(t,e)}addProtocol(t,e){return this.map.addProtocol(t,e)}moveLayer(t,e){return this.map.moveLayer(t,e)}panBy(t,e,n){return this.map.panBy(t,e,n)}panTo(t,e,n){return this.map.panTo(t,e,n)}project(t){return this.map.project(t)}queryRenderedFeatures(t,e){return this.map.queryRenderedFeatures(t,e)}querySourceFeatures(t,e){return this.map.querySourceFeatures(t,e)}queryTerrainElevation(t){return this.map.queryTerrainElevation(t)}redraw(){return this.map.redraw()}remove(){return this.map.remove()}removeControl(t){return this.map.removeControl(t)}removeFeatureState(t,e){return this.map.removeFeatureState(t,e)}removeImage(t){return this.map.removeImage(t)}removeLayer(t){try{this.map.removeLayer(t)}catch(e){console.error(`Error removing layer: ${e.message}`)}}removeSource(t){try{this.map.removeSource(t)}catch(e){console.error(`Error removing source: ${e.message}`)}}removeSprite(t){return this.map.removeSprite(t)}resetNorth(t,e){return this.map.resetNorth(t,e)}resetNorthPitch(t,e){return this.map.resetNorthPitch(t,e)}resize(t){return this.map.resize(t)}rotateTo(t,e,n){return this.map.rotateTo(t,e,n)}setBearing(t,e){return this.map.setBearing(t,e)}setCenter(t,e){return this.map.setCenter(t,e)}setEventedParent(t,e){return this.map.setEventedParent(t,e)}setFeatureState(t,e){return this.map.setFeatureState(t,e)}setFilter(t,e,n){return this.map.setFilter(t,e,n)}setGlyphs(t,e){return this.map.setGlyphs(t,e)}setLayerZoomRange(t,e,n){return this.map.setLayerZoomRange(t,e,n)}setLayoutProperty(t,e,n,i){return this.map.setLayoutProperty(t,e,n,i)}setLight(t,e){return this.map.setLight(t,e)}setMaxBounds(t){return this.map.setMaxBounds(t)}setMaxPitch(t){return this.map.setMaxPitch(t)}setMaxZoom(t){return this.map.setMaxZoom(t)}setMinPitch(t){return this.map.setMinPitch(t)}setMinZoom(t){return this.map.setMinZoom(t)}setPadding(t,e){return this.map.setPadding(t,e)}setPaintProperty(t,e,n,i){return this.map.setPaintProperty(t,e,n,i)}setPitch(t,e){return this.map.setPitch(t,e)}setPixelRatio(t){return this.map.setPixelRatio(t)}setRenderWorldCopies(t){return this.map.setRenderWorldCopies(t)}setSprite(t,e){return this.map.setSprite(t,e)}setTerrain(t){return this.map.setTerrain(t)}setTransformRequest(t){return this.map.setTransformRequest(t)}setZoom(t,e){return this.map.setZoom(t,e)}snapToNorth(t,e){return this.map.snapToNorth(t,e)}stop(){return this.map.stop()}triggerRepaint(){return this.map.triggerRepaint()}unproject(t){return this.map.unproject(t)}updateImage(t,e){return this.map.updateImage(t,e)}zoomIn(t,e){return this.map.zoomIn(t,e)}zoomOut(t,e){return this.map.zoomOut(t,e)}zoomTo(t,e,n){return this.map.zoomTo(t,e,n)}addLayerGeoJSON(t,e){try{let n=this._dealOrderLayer(e);this.map.addSource(`${t.id}`,{type:"geojson",data:t.data}),this.map.addLayer({id:`${t.id}-layerIcgcMap`,type:t.type,source:`${t.id}`,layout:t.layout,paint:t.paint},n)}catch(n){console.error(`Error adding GeoJSON layer: ${n.message}`)}}addLayerWMS(t,e,n){try{let i=this._dealOrderLayer(n.layerPosition);n?(this.map.addSource(`${e}`,{type:"raster",tiles:[t],tileSize:256},i),this.map.addLayer({id:e,type:"raster",source:e,layout:n.layout,paint:n.paint},i)):(this.map.addSource(`${e}`,{type:"raster",tiles:[t],tileSize:256},i),this.map.addLayer({id:e,type:"raster",source:e,paint:{}},i))}catch(i){console.error(`Error adding WMS layer: ${i.message}`)}}addLogo(t){try{let e=document.getElementById("map"),n;n=document.createElement("div"),n.id="logos",e.appendChild(n);const i=document.createElement("img");i.src=t.url,i.style.height=t.height;const s=document.getElementById("logos"),a=document.createElement("a");a.id=t.id,a.href=t.href,a.target="_blank",a.style.position="relative",a.style.bottom="1px",a.appendChild(i),s.appendChild(a)}catch(e){console.error(`Error adding logo: ${e.message}`)}}addBasemapsICGC(t){try{const e=a=>{this.map.setStyle(a)};let n=document.getElementById("map"),i;i=document.createElement("div"),i.id="basemap-group",i.classList.add="filter-group",n.appendChild(i);const s=document.getElementById("basemap-group");for(const a of t)for(const o of Object.keys(Pn.baseStyles)){const d=Pn.baseStyles[o];if(a===d.url){const p=document.createElement("div");p.className="basemap-item",p.title=d.key,p.style.backgroundImage=`url('${d.image}')`,s.appendChild(p),p.addEventListener("click",()=>e(d.url))}}}catch(e){console.error(`Error adding basemaps: ${e.message}`)}}addBasemaps(t){try{const e=a=>{map.setStyle(a.url)};let n=document.getElementById("map"),i;i=document.createElement("div"),i.id="basemap-group",i.classList.add="basemap-group",n.appendChild(i);const s=document.getElementById("basemap-group");t.forEach(a=>{const o=document.createElement("div");o.className="basemap-item",o.title=a.label,o.style.backgroundImage=`url('${a.image}')`,s.appendChild(o),o.addEventListener("click",()=>e(a))})}catch(e){console.error(`Error adding basemaps: ${e.message}`)}}addFeatureQuery(t,e,n){try{let i;this.map.on("mouseenter",t,()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave",t,()=>{this.map.getCanvas().style.cursor=""}),this.map.on("click",s=>{let a=this.map.queryRenderedFeatures(s.point);if(a&&a[0].source.includes(t)){let o=[s.lngLat.lng,s.lngLat.lat];if(e!==void 0&&e.length>0&&e!=="all"){if(e!==null){let d="";e.forEach(p=>{let y=a[0].properties[p];d=d+`<h4>${y}</h4>`}),i=d,this.addPopup(o,i,n)}}else{let d="";for(const p in a[0].properties)d+="<b>"+p+"</b>:"+a[0].properties[p]+"<br>";i=d,this.addPopup(o,i,n)}}})}catch(i){console.error(`Error adding feature query: ${i.message}`)}}addScaleControl(t,e){try{var n=new Ls.ScaleControl(t);this.map.addControl(n,e)}catch(i){console.error(`Error adding scale: ${i.message}`)}}addExportControl(t,e){try{typeof t=="string"&&(e=t,t=void 0),t===void 0&&(t={PageSize:Zh.A4,PageOrientation:Ng.Landscape,Format:Vu.PNG,DPI:x2[300],Crosshair:!0,PrintableArea:!0,Local:"ca"},e="top-right"),this.map.addControl(new rnt(t),e)}catch(n){console.error(`Error adding export control: ${n.message}`)}}addMarker(t){try{let e,n;return t.text===void 0?e=new Ls.Marker(t.options).setLngLat(t.coord).addTo(this.map):(n=new Ls.Popup({offset:t.textOffset}).setHTML(t.text),e=new Ls.Marker(t.options).setLngLat(t.coord).setPopup(n).addTo(this.map)),e}catch(e){return console.error(`Error adding marker: ${e.message}`),null}}addPopup(t,e,n){try{return n.image===void 0?new Ls.Popup().setLngLat(t).setHTML(`
        <div class="popupBody">
          <div class="popupTop">
          ${n.title}
          </div>
          <div class="popupBottom">
          <div class="popupBottomUp">
 ${e}
          </div>
          <div class="popupBottomDown">
          </div>
          </div>
        </div>
      `).addTo(this.map):new Ls.Popup().setLngLat(t).setHTML(`
        <div class="popupBody">
          <div class="popupTop">
          ${n.title}
          </div>
          <div class="popupBottom">
          <div class="popupBottomUp">
          ${e}
          </div>
          <div class="popupBottomDown">
             <img style="  padding: 8px;  width: 50%;" src=${n.image} />
          </div>
          </div>
        </div>
      `).addTo(this.map)}catch(i){return console.error(`Error adding popup: ${i.message}`),null}}addFullScreen(t){try{t===void 0&&(t="top-right"),this.map.addControl(new Ls.FullscreenControl,t)}catch(e){console.error(`Error adding fullscreen control: ${e.message}`)}}addMenuItem(t){try{let e;if(t.includes("-userFieldFilter-")?e=t.split("-userFieldFilter-")[0]:e=t,t.length>0){const n=document.getElementById("menu-group"),i=document.createElement("input");i.type="checkbox",i.id=t,i.checked=!0,n.appendChild(i);const s=document.createElement("label");s.setAttribute("for",t),s.textContent=e,n.appendChild(s),i.addEventListener("change",a=>{this.map.setLayoutProperty(t,"visibility",a.target.checked?"visible":"none")})}}catch(e){console.error(`Error adding menu item: ${e.message}`)}}addLayerTree(t){try{let e=t.features,n=document.getElementById("map"),i=document.createElement("nav");i.id="filter-group",n.appendChild(i);const s=document.getElementById("filter-group");this.map.addSource(`${t.id}`,{type:t.type,data:e}),e.features.forEach(a=>{const o=a.properties.icon,d=`poi-${o}`;if(!this.map.getLayer(d)){this.map.addLayer({id:d,type:"circle",source:`${t.id}`,paint:{"circle-radius":6,"circle-color":"#B42222"},filter:["==","icon",o]},this._firstSymbolLayer());const p=document.createElement("input");p.type="checkbox",p.id=d,p.checked=!0,s.appendChild(p);const y=document.createElement("label");y.setAttribute("for",d),y.textContent=o,s.appendChild(y),p.addEventListener("change",b=>{this.map.setLayoutProperty(d,"visibility",b.target.checked?"visible":"none")})}})}catch(e){console.error(`Error adding layer tree: ${e.message}`)}}createNavigationControl(t,e){try{e===void 0&&(e="top-right"),this.map.addControl(new Ls.NavigationControl(t),e)}catch(n){return console.error(`Error creating navigation control: ${n.message}`),null}}addNavigationControl(t,e){try{e===void 0&&(e="top-right"),this.map.addControl(new Ls.NavigationControl(t),e)}catch(n){console.error(`Error adding navigation control: ${n.message}`)}}addAttributionControl(t,e){try{this.map.addControl(new Ls.AttributionControl(t),e)}catch(n){console.error(`Error adding attribution control: ${n.message}`)}}addImageLayerICGC(t,e,n){try{let i=null,s,a;n?(a=n,s=n.layerPosition):a={type:"raster",layout:{visibility:"visible"},paint:{"raster-opacity":1},layerPosition:Yy},i=this._findImageType(t,Qi.Orto,Qi.VectorAdmin,Qi.WMS,Qi.Vector),i||console.log(" %c The layer: %c%s%c does not exist in the ICGC DB. Consult the documentation.","font-weight: bold; font-style: italic;","font-weight: normal; font-style: normal; color: red;",t,"font-weight: bold; font-style: italic;");let o={id:e,tiles:t};this.addLayerWMS(t,e,a)}catch(i){console.error(`Error adding ICGC image layer: ${i.message}`)}}async addVectorLayerICGC(t,e,n){try{let{type:i="line",layerPosition:s=Yy,layoutOptions:a={visibility:"visible"},paintOption:o}=n||{},d=this._dealOrderLayer(s);if(!t){console.log(" %c The layer: %c%s%c does not exist in the ICGC DB. Consult the documentation.","font-weight: bold; font-style: italic;","font-weight: normal; font-style: normal; color: red;",t,"font-weight: bold; font-style: italic;");return}if(t.includes("https")){let p=this._getKeyByUrlVector(t);this.map.addSource(p,{type:"vector",url:t});let y={id:p,type:"fill",source:p,"source-layer":"cobertes",maxzoom:18,layout:n.layout,paint:ast.cobertesSol};if(p==="cobertes2018"&&this.map.addLayer(y,d),a.visibility==="visible"){let b=this._getLegendByName(p);console.info("legendUrl",b),console.info("sourceName",p),this.addLegend(b,p)}}else{let p=e;this.map.addSource(p,{type:"vector",url:Pn.limitsUrl});let y={id:e,type:i,source:p,"source-layer":t,layout:n.layout,paint:n.paint||{}};i==="fill"||i==="polygon"?y.paint=o||{"fill-color":"#0000FF","fill-opacity":0}:i==="line"&&(y.paint=o||{"line-color":"#4832a8","line-opacity":1,"line-width":1}),this.map.addLayer(y,d)}}catch(i){console.error(`Error adding ICGC vector layer: ${i.message}`)}}async addFGBLayerICGC(t,e,n){try{n||(n.layout={visibility:!0},n.paint={"line-color":"#4832a8","line-opacity":1,"line-width":1},n.type="lines",n.layerPosition="labels");let i=this._dealOrderLayer(n.layerPosition);const s=await fetch(t),a={type:"FeatureCollection",features:[]};for await(const d of US(s.body))a.features.push(d);let o=e;this.map.addSource(o,{type:"geojson",data:a}),t.includes("text")?this.map.addLayer({id:e,type:"symbol",source:o,layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[8,0],[12,14],[15,15]]},"text-font":["FiraSans-Regular"],"text-field":["get","NOM_AC"],"text-transform":"none","text-max-width":25,visibility:n.layout.visibility,"text-justify":"right","text-anchor":"top","text-allow-overlap":!1,"symbol-spacing":2,"text-line-height":1},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},i):this.map.addLayer({id:e,type:n.type,source:o,layout:n.layout,paint:n.paint},i)}catch(i){console.error(`Error adding ICGC FGB layer: ${i.message}`)}}addTerrainICGC(t,e){try{let n;for(const s in Wg)if(Wg.hasOwnProperty(s)){const a=Wg[s];a===t&&(n=a)}let i=n;this.getSource("terrainICGC")!==void 0&&(this.getStyle().layers.forEach(a=>{a.source==="terrainICGC"&&this.removeLayer(a.id)}),this.removeSource("terrainICGC")),this.getSource("terrainICGC")===void 0&&(t.includes("terrarium")?this.map.addSource("terrainICGC",{type:"raster-dem",tiles:[i],tileSize:512,encoding:"terrarium",maxzoom:16}):this.map.addSource("terrainICGC",{type:"raster-dem",tiles:[i],tileSize:512,maxzoom:16})),this.map.setTerrain({source:"terrainICGC",exaggeration:1.5}),e==null||this.map.addControl(new y8({pitch:90,bearing:null,minpitchzoom:null}),e)}catch(n){console.error(`Error adding 3D terrain: ${n.message}`)}}addLegend(t,e){try{this.map.addControl(new $nt({url:t,idLayer:e}))}catch(n){console.error(`Error adding legend: ${n.message}`)}}_findImageType(t,e,n,i,s){const a=[e,n,i,s];for(const o of a)for(const[d,p]of Object.entries(o))if(p===t)return d;return null}_getKeyByUrlFGB(t){for(const e in Qi.FGBAdmin)if(Qi.FGBAdmin.hasOwnProperty(e)&&Qi.FGBAdmin[e]===t)return e;return null}_getLegendByName(t){for(const e in Pn.vectorLayers){const n=Pn.vectorLayers[e];if(n.key===t)return n.legend}return null}_getKeyByUrlVector(t){for(const e in Qi.Vector)if(Qi.Vector.hasOwnProperty(e)&&Qi.Vector[e]===t)return e;return null}async _raiseText3DStyle(){try{const t=await this.map.loadImage(Pn.map3dOptions.imageIcon);this.map.addImage("stick",t.data),this.map.getStyle().layers.forEach(e=>{if(e["source-layer"]===Pn.map3dOptions.sourceLayerFilterId&&e.minzoom>=Pn.map3dOptions.minZoomFilter&&t){const n=e.id;this.map.setLayoutProperty(n,"icon-image","stick"),this.map.setLayoutProperty(n,"text-offset",[0,-9]),this.map.setLayoutProperty(n,"symbol-placement","point"),this.map.setLayoutProperty(n,"symbol-avoid-edges",!1),this.map.setLayoutProperty(n,"text-allow-overlap",!0),this.map.setLayoutProperty(n,"text-ignore-placement",!1),this.map.setLayoutProperty(n,"text-pitch-alignment","auto"),this.map.setLayoutProperty(n,"text-rotation-alignment","auto"),this.map.setLayoutProperty(n,"text-justify","center"),this.map.setLayoutProperty(n,"text-anchor","bottom"),this.map.setLayoutProperty(n,"icon-anchor","bottom"),this.map.setPaintProperty(n,"text-color","#ffffff"),this.map.setPaintProperty(n,"text-halo-color","#000000"),this.map.setPaintProperty(n,"text-halo-width",2)}})}catch(t){return console.error(`Error dealing orto 3D: ${t.message}`),null}}_dealStyleMaps(t){try{if(t&&t.indexOf("icgc.cat")!=-1){for(const e in od)if(od.hasOwnProperty(e)){const n=od[e];if(e===t)return n}return od[0]}else return t}catch(e){return console.error(`Error dealing with map styles: ${e.message}`),null}}_dealOrto3dStyle(t){try{if(t=="orto3d"){this.map.setMaxZoom(18.8),this.map.easeTo({pitch:45});const e=new g3({intensity:4}),n=new Yb({ambientLight:e});this.map.setTerrain({source:Pn.map3dOptions.terrainSource,exaggeration:Pn.map3dOptions.exaggeration});const i=this._createCitiesMapboxLayer();this.map.getLayer(Pn.map3dOptions.layerId3d)||(this.map.addLayer(i,Pn.map3dOptions.layerIdOrder),this.map.setLayerZoomRange(Pn.map3dOptions.layerId3d,Pn.map3dOptions.minZoomRange,Pn.map3dOptions.maxZoomRange),i.deck.setProps({effects:[n]}),this._raiseText3DStyle()),this.map.setSky({"sky-color":"#86bbd5","sky-horizon-blend":.3,"horizon-color":"#ffffff33","horizon-fog-blend":.1,"fog-ground-blend":.75,"fog-color":"#c5d6d6"})}else this.map.getLayer(Pn.map3dOptions.layerId3d)&&(this.map.removeLayer(Pn.map3dOptions.layerId3d),this.map.setTerrain(null))}catch(e){return console.error(`Error dealing orto 3D: ${e.message}`),null}}_dealOrderLayer(t){return t===Yy?this._firstSymbolLayer():t===lst?this._firstLineLayer():""}_firstSymbolLayer(){try{const t=this.map.getStyle().layers;let e;for(let n=0;n<t.length;n++)if(t[n].type==="symbol"&&t[n].id.indexOf("contour")===-1&&t[n].id.indexOf("water")===-1){console.info(t[n].id),e=t[n].id;break}return e}catch(t){console.error(`Error getting first symbol layer: ${t.message}`)}}_firstLineLayer(){try{const t=this.map.getStyle().layers;let e;for(let n=0;n<t.length;n++)if(t[n].type==="line"){e=t[n].id;break}return e}catch(t){console.error(`Error getting first symbol layer: ${t.message}`)}}_createCitiesMapboxLayer(){try{return new RW({id:Pn.map3dOptions.layerId3d,type:w2,data:Pn.map3dOptions.urlTilesetCities,loader:b2,loadOptions:{tileset:{viewDistanceScale:1,updateTransforms:!0,maximumScreenSpaceError:Pn.map3dOptions.spaceErrorFactor}},onTilesetLoad:e=>{e.options.maximumScreenSpaceError=Pn.map3dOptions.spaceErrorFactor},onTileLoad:e=>{e.content.cartographicOrigin.z-=Pn.map3dOptions.zfactor},operation:"terrain+draw"})}catch(t){return console.error(`Error adding MapboxLayer: ${t.message}`),null}}};var E4={exports:{}};function ust(r,t){var e=r.getCenter(),n=r.getZoom(),i=r.getBearing(),s=r.getPitch();t.forEach(function(a){a.jumpTo({center:e,zoom:n,bearing:i,pitch:s})})}function Ast(){var r,t=arguments.length;if(t===1)r=arguments[0];else{r=[];for(var e=0;e<t;e++)r.push(arguments[e])}var n=[];r.forEach(function(o,d){n[d]=a.bind(null,o,r.filter(function(p,y){return y!==d}))});function i(){r.forEach(function(o,d){o.on("move",n[d])})}function s(){r.forEach(function(o,d){o.off("move",n[d])})}function a(o,d){s(),ust(o,d),i()}return i(),function(){s(),n=[],r=[]}}var hst=Ast;(function(r){var t=hst,e=zP.EventEmitter;function n(i,s,a,o){if(this.options=o||{},this._mapA=i,this._mapB=s,this._horizontal=this.options.orientation==="horizontal",this._onDown=this._onDown.bind(this),this._onMove=this._onMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._ev=new e,this._swiper=document.createElement("div"),this._swiper.className=this._horizontal?"compare-swiper-horizontal":"compare-swiper-vertical",this._controlContainer=document.createElement("div"),this._controlContainer.className=this._horizontal?"maplibregl-compare maplibregl-compare-horizontal":"maplibregl-compare",this._controlContainer.className=this._controlContainer.className,this._controlContainer.appendChild(this._swiper),typeof a=="string"&&document.body.querySelectorAll){var d=document.body.querySelectorAll(a)[0];if(!d)throw new Error("Cannot find element with specified container selector.");d.appendChild(this._controlContainer)}else if(a instanceof Element&&a.appendChild)a.appendChild(this._controlContainer);else throw new Error("Invalid container specified. Must be CSS selector or HTML element.");this._bounds=s.getContainer().getBoundingClientRect();var p=(this._horizontal?this._bounds.height:this._bounds.width)/2;this._setPosition(p),this._clearSync=t(i,s),this._onResize=(function(){this._bounds=s.getContainer().getBoundingClientRect(),this.currentPosition&&this._setPosition(this.currentPosition)}).bind(this),s.on("resize",this._onResize),this.options&&this.options.mousemove&&(i.getContainer().addEventListener("mousemove",this._onMove),s.getContainer().addEventListener("mousemove",this._onMove)),this._swiper.addEventListener("mousedown",this._onDown),this._swiper.addEventListener("touchstart",this._onDown)}n.prototype={_setPointerEvents:function(i){this._controlContainer.style.pointerEvents=i,this._swiper.style.pointerEvents=i},_onDown:function(i){i.touches?(document.addEventListener("touchmove",this._onMove),document.addEventListener("touchend",this._onTouchEnd)):(document.addEventListener("mousemove",this._onMove),document.addEventListener("mouseup",this._onMouseUp))},_setPosition:function(i){i=Math.min(i,this._horizontal?this._bounds.height:this._bounds.width);var s=this._horizontal?"translate(0, "+i+"px)":"translate("+i+"px, 0)";this._controlContainer.style.transform=s,this._controlContainer.style.WebkitTransform=s;var a=this._horizontal?"rect(0, 999em, "+i+"px, 0)":"rect(0, "+i+"px, "+this._bounds.height+"px, 0)",o=this._horizontal?"rect("+i+"px, 999em, "+this._bounds.height+"px,0)":"rect(0, 999em, "+this._bounds.height+"px,"+i+"px)";this._mapA.getContainer().style.clip=a,this._mapB.getContainer().style.clip=o,this.currentPosition=i},_onMove:function(i){this.options&&this.options.mousemove&&this._setPointerEvents(i.touches?"auto":"none"),this._horizontal?this._setPosition(this._getY(i)):this._setPosition(this._getX(i))},_onMouseUp:function(){document.removeEventListener("mousemove",this._onMove),document.removeEventListener("mouseup",this._onMouseUp),this.fire("slideend",{currentPosition:this.currentPosition})},_onTouchEnd:function(){document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onTouchEnd),this.fire("slideend",{currentPosition:this.currentPosition})},_getX:function(i){i=i.touches?i.touches[0]:i;var s=i.clientX-this._bounds.left;return s<0&&(s=0),s>this._bounds.width&&(s=this._bounds.width),s},_getY:function(i){i=i.touches?i.touches[0]:i;var s=i.clientY-this._bounds.top;return s<0&&(s=0),s>this._bounds.height&&(s=this._bounds.height),s},setSlider:function(i){this._setPosition(i)},on:function(i,s){return this._ev.on(i,s),this},fire:function(i,s){return this._ev.emit(i,s),this},off:function(i,s){return this._ev.removeListener(i,s),this},remove:function(){this._clearSync(),this._mapB.off("resize",this._onResize);var i=this._mapA.getContainer();i&&(i.style.clip=null,i.removeEventListener("mousemove",this._onMove));var s=this._mapB.getContainer();s&&(s.style.clip=null,s.removeEventListener("mousemove",this._onMove)),this._swiper.removeEventListener("mousedown",this._onDown),this._swiper.removeEventListener("touchstart",this._onDown),this._controlContainer.remove()}},window.maplibregl?maplibregl.Compare=n:r.exports=n})(E4);var dst=E4.exports;const fst=Np(dst);class pst{constructor(t,e,n,i){const s=this;setTimeout(function(){s.mapCompare=new fst(t.map,e.map,n,{})},1e3)}}/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Ax=function(r,t){return Ax=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])},Ax(r,t)};function ac(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ax(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var hx=function(){return hx=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},hx.apply(this,arguments)};function Uo(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(y){try{p(n.next(y))}catch(b){a(b)}}function d(y){try{p(n.throw(y))}catch(b){a(b)}}function p(y){y.done?s(y.value):i(y.value).then(o,d)}p((n=n.apply(r,[])).next())})}function go(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(p){return function(y){return d([p,y])}}function d(p){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=p[0]&2?i.return:p[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,p[1])).done)return s;switch(i=0,s&&(p=[p[0]&2,s.value]),p[0]){case 0:case 1:s=p;break;case 4:return e.label++,{value:p[1],done:!1};case 5:e.label++,i=p[1],p=[0];continue;case 7:p=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(p[0]===6||p[0]===2)){e=0;continue}if(p[0]===3&&(!s||p[1]>s[0]&&p[1]<s[3])){e.label=p[1];break}if(p[0]===6&&e.label<s[1]){e.label=s[1],s=p;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(p);break}s[2]&&e.ops.pop(),e.trys.pop();continue}p=t.call(r,e)}catch(y){p=[6,y],i=0}finally{n=s=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Zy(r,t,e){if(arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return r.concat(s||t)}for(var ju=function(){function r(t,e,n,i){this.left=t,this.top=e,this.width=n,this.height=i}return r.prototype.add=function(t,e,n,i){return new r(this.left+t,this.top+e,this.width+n,this.height+i)},r.fromClientRect=function(t,e){return new r(e.left+t.windowBounds.left,e.top+t.windowBounds.top,e.width,e.height)},r.fromDOMRectList=function(t,e){var n=Array.from(e).find(function(i){return i.width!==0});return n?new r(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height):r.EMPTY},r.EMPTY=new r(0,0,0,0),r}(),t1=function(r,t){return ju.fromClientRect(r,t.getBoundingClientRect())},gst=function(r){var t=r.body,e=r.documentElement;if(!t||!e)throw new Error("Unable to get document size");var n=Math.max(Math.max(t.scrollWidth,e.scrollWidth),Math.max(t.offsetWidth,e.offsetWidth),Math.max(t.clientWidth,e.clientWidth)),i=Math.max(Math.max(t.scrollHeight,e.scrollHeight),Math.max(t.offsetHeight,e.offsetHeight),Math.max(t.clientHeight,e.clientHeight));return new ju(0,0,n,i)},e1=function(r){for(var t=[],e=0,n=r.length;e<n;){var i=r.charCodeAt(e++);if(i>=55296&&i<=56319&&e<n){var s=r.charCodeAt(e++);(s&64512)===56320?t.push(((i&1023)<<10)+(s&1023)+65536):(t.push(i),e--)}else t.push(i)}return t},$i=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,r);var e=r.length;if(!e)return"";for(var n=[],i=-1,s="";++i<e;){var a=r[i];a<=65535?n.push(a):(a-=65536,n.push((a>>10)+55296,a%1024+56320)),(i+1===e||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},S4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",mst=typeof Uint8Array>"u"?[]:new Uint8Array(256),r1=0;r1<S4.length;r1++)mst[S4.charCodeAt(r1)]=r1;for(var T4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Xg=typeof Uint8Array>"u"?[]:new Uint8Array(256),n1=0;n1<T4.length;n1++)Xg[T4.charCodeAt(n1)]=n1;for(var yst=function(r){var t=r.length*.75,e=r.length,n,i=0,s,a,o,d;r[r.length-1]==="="&&(t--,r[r.length-2]==="="&&t--);var p=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),y=Array.isArray(p)?p:new Uint8Array(p);for(n=0;n<e;n+=4)s=Xg[r.charCodeAt(n)],a=Xg[r.charCodeAt(n+1)],o=Xg[r.charCodeAt(n+2)],d=Xg[r.charCodeAt(n+3)],y[i++]=s<<2|a>>4,y[i++]=(a&15)<<4|o>>2,y[i++]=(o&3)<<6|d&63;return p},_st=function(r){for(var t=r.length,e=[],n=0;n<t;n+=2)e.push(r[n+1]<<8|r[n]);return e},vst=function(r){for(var t=r.length,e=[],n=0;n<t;n+=4)e.push(r[n+3]<<24|r[n+2]<<16|r[n+1]<<8|r[n]);return e},ad=5,dx=11,fx=2,bst=dx-ad,I4=65536>>ad,wst=1<<ad,px=wst-1,xst=1024>>ad,Bst=I4+xst,Cst=Bst,Est=32,Sst=Cst+Est,Tst=65536>>dx,Ist=1<<bst,Fst=Ist-1,F4=function(r,t,e){return r.slice?r.slice(t,e):new Uint16Array(Array.prototype.slice.call(r,t,e))},Lst=function(r,t,e){return r.slice?r.slice(t,e):new Uint32Array(Array.prototype.slice.call(r,t,e))},Pst=function(r,t){var e=yst(r),n=Array.isArray(e)?vst(e):new Uint32Array(e),i=Array.isArray(e)?_st(e):new Uint16Array(e),s=24,a=F4(i,s/2,n[4]/2),o=n[5]===2?F4(i,(s+n[4])/2):Lst(n,Math.ceil((s+n[4])/4));return new Mst(n[0],n[1],n[2],n[3],a,o)},Mst=function(){function r(t,e,n,i,s,a){this.initialValue=t,this.errorValue=e,this.highStart=n,this.highValueIndex=i,this.index=s,this.data=a}return r.prototype.get=function(t){var e;if(t>=0){if(t<55296||t>56319&&t<=65535)return e=this.index[t>>ad],e=(e<<fx)+(t&px),this.data[e];if(t<=65535)return e=this.index[I4+(t-55296>>ad)],e=(e<<fx)+(t&px),this.data[e];if(t<this.highStart)return e=Sst-Tst+(t>>dx),e=this.index[e],e+=t>>ad&Fst,e=this.index[e],e=(e<<fx)+(t&px),this.data[e];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},r}(),L4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ust=typeof Uint8Array>"u"?[]:new Uint8Array(256),i1=0;i1<L4.length;i1++)Ust[L4.charCodeAt(i1)]=i1;var Rst="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",P4=50,Ost=1,M4=2,U4=3,Dst=4,Nst=5,R4=7,O4=8,D4=9,WA=10,gx=11,N4=12,mx=13,kst=14,Jg=15,yx=16,s1=17,Yg=18,Qst=19,k4=20,_x=21,Zg=22,vx=23,Vf=24,Ua=25,tm=26,em=27,Gf=28,zst=29,jf=30,Hst=31,o1=32,a1=33,bx=34,wx=35,xx=36,rm=37,Bx=38,l1=39,c1=40,Cx=41,Q4=42,Vst=43,Gst=[9001,65288],z4="!",Ro="",u1="",Ex=Pst(Rst),qu=[jf,xx],Sx=[Ost,M4,U4,Nst],H4=[WA,O4],V4=[em,tm],jst=Sx.concat(H4),G4=[Bx,l1,c1,bx,wx],qst=[Jg,mx],Kst=function(r,t){t===void 0&&(t="strict");var e=[],n=[],i=[];return r.forEach(function(s,a){var o=Ex.get(s);if(o>P4?(i.push(!0),o-=P4):i.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return n.push(a),e.push(yx);if(o===Dst||o===gx){if(a===0)return n.push(a),e.push(jf);var d=e[a-1];return jst.indexOf(d)===-1?(n.push(n[a-1]),e.push(d)):(n.push(a),e.push(jf))}if(n.push(a),o===Hst)return e.push(t==="strict"?_x:rm);if(o===Q4||o===zst)return e.push(jf);if(o===Vst)return s>=131072&&s<=196605||s>=196608&&s<=262141?e.push(rm):e.push(jf);e.push(o)}),[n,e,i]},Tx=function(r,t,e,n){var i=n[e];if(Array.isArray(r)?r.indexOf(i)!==-1:r===i)for(var s=e;s<=n.length;){s++;var a=n[s];if(a===t)return!0;if(a!==WA)break}if(i===WA)for(var s=e;s>0;){s--;var o=n[s];if(Array.isArray(r)?r.indexOf(o)!==-1:r===o)for(var d=e;d<=n.length;){d++;var a=n[d];if(a===t)return!0;if(a!==WA)break}if(o!==WA)break}return!1},j4=function(r,t){for(var e=r;e>=0;){var n=t[e];if(n===WA)e--;else return n}return 0},$st=function(r,t,e,n,i){if(e[n]===0)return Ro;var s=n-1;if(Array.isArray(i)&&i[s]===!0)return Ro;var a=s-1,o=s+1,d=t[s],p=a>=0?t[a]:0,y=t[o];if(d===M4&&y===U4)return Ro;if(Sx.indexOf(d)!==-1)return z4;if(Sx.indexOf(y)!==-1||H4.indexOf(y)!==-1)return Ro;if(j4(s,t)===O4)return u1;if(Ex.get(r[s])===gx||(d===o1||d===a1)&&Ex.get(r[o])===gx||d===R4||y===R4||d===D4||[WA,mx,Jg].indexOf(d)===-1&&y===D4||[s1,Yg,Qst,Vf,Gf].indexOf(y)!==-1||j4(s,t)===Zg||Tx(vx,Zg,s,t)||Tx([s1,Yg],_x,s,t)||Tx(N4,N4,s,t))return Ro;if(d===WA)return u1;if(d===vx||y===vx)return Ro;if(y===yx||d===yx)return u1;if([mx,Jg,_x].indexOf(y)!==-1||d===kst||p===xx&&qst.indexOf(d)!==-1||d===Gf&&y===xx||y===k4||qu.indexOf(y)!==-1&&d===Ua||qu.indexOf(d)!==-1&&y===Ua||d===em&&[rm,o1,a1].indexOf(y)!==-1||[rm,o1,a1].indexOf(d)!==-1&&y===tm||qu.indexOf(d)!==-1&&V4.indexOf(y)!==-1||V4.indexOf(d)!==-1&&qu.indexOf(y)!==-1||[em,tm].indexOf(d)!==-1&&(y===Ua||[Zg,Jg].indexOf(y)!==-1&&t[o+1]===Ua)||[Zg,Jg].indexOf(d)!==-1&&y===Ua||d===Ua&&[Ua,Gf,Vf].indexOf(y)!==-1)return Ro;if([Ua,Gf,Vf,s1,Yg].indexOf(y)!==-1)for(var b=s;b>=0;){var x=t[b];if(x===Ua)return Ro;if([Gf,Vf].indexOf(x)!==-1)b--;else break}if([em,tm].indexOf(y)!==-1)for(var b=[s1,Yg].indexOf(d)!==-1?a:s;b>=0;){var x=t[b];if(x===Ua)return Ro;if([Gf,Vf].indexOf(x)!==-1)b--;else break}if(Bx===d&&[Bx,l1,bx,wx].indexOf(y)!==-1||[l1,bx].indexOf(d)!==-1&&[l1,c1].indexOf(y)!==-1||[c1,wx].indexOf(d)!==-1&&y===c1||G4.indexOf(d)!==-1&&[k4,tm].indexOf(y)!==-1||G4.indexOf(y)!==-1&&d===em||qu.indexOf(d)!==-1&&qu.indexOf(y)!==-1||d===Vf&&qu.indexOf(y)!==-1||qu.concat(Ua).indexOf(d)!==-1&&y===Zg&&Gst.indexOf(r[o])===-1||qu.concat(Ua).indexOf(y)!==-1&&d===Yg)return Ro;if(d===Cx&&y===Cx){for(var C=e[s],P=1;C>0&&(C--,t[C]===Cx);)P++;if(P%2!==0)return Ro}return d===o1&&y===a1?Ro:u1},Wst=function(r,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var e=Kst(r,t.lineBreak),n=e[0],i=e[1],s=e[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(i=i.map(function(o){return[Ua,jf,Q4].indexOf(o)!==-1?rm:o}));var a=t.wordBreak==="keep-all"?s.map(function(o,d){return o&&r[d]>=19968&&r[d]<=40959}):void 0;return[n,i,a]},Xst=function(){function r(t,e,n,i){this.codePoints=t,this.required=e===z4,this.start=n,this.end=i}return r.prototype.slice=function(){return $i.apply(void 0,this.codePoints.slice(this.start,this.end))},r}(),Jst=function(r,t){var e=e1(r),n=Wst(e,t),i=n[0],s=n[1],a=n[2],o=e.length,d=0,p=0;return{next:function(){if(p>=o)return{done:!0,value:null};for(var y=Ro;p<o&&(y=$st(e,s,i,++p,a))===Ro;);if(y!==Ro||p===o){var b=new Xst(e,y,d,p);return d=p,{value:b,done:!1}}return{done:!0,value:null}}}},Yst=1,Zst=2,nm=4,q4=8,A1=10,K4=47,im=92,tot=9,eot=32,h1=34,sm=61,rot=35,not=36,iot=37,d1=39,f1=40,om=41,sot=95,ca=45,oot=33,aot=60,lot=62,cot=64,uot=91,Aot=93,hot=61,dot=123,p1=63,fot=125,$4=124,pot=126,got=128,W4=65533,Ix=42,ld=43,mot=44,yot=58,_ot=59,am=46,vot=0,bot=8,wot=11,xot=14,Bot=31,Cot=127,Zc=-1,X4=48,J4=97,Y4=101,Eot=102,Sot=117,Tot=122,Z4=65,tM=69,eM=70,Iot=85,Fot=90,Oo=function(r){return r>=X4&&r<=57},Lot=function(r){return r>=55296&&r<=57343},qf=function(r){return Oo(r)||r>=Z4&&r<=eM||r>=J4&&r<=Eot},Pot=function(r){return r>=J4&&r<=Tot},Mot=function(r){return r>=Z4&&r<=Fot},Uot=function(r){return Pot(r)||Mot(r)},Rot=function(r){return r>=got},g1=function(r){return r===A1||r===tot||r===eot},m1=function(r){return Uot(r)||Rot(r)||r===sot},rM=function(r){return m1(r)||Oo(r)||r===ca},Oot=function(r){return r>=vot&&r<=bot||r===wot||r>=xot&&r<=Bot||r===Cot},XA=function(r,t){return r!==im?!1:t!==A1},y1=function(r,t,e){return r===ca?m1(t)||XA(t,e):m1(r)?!0:!!(r===im&&XA(r,t))},Fx=function(r,t,e){return r===ld||r===ca?Oo(t)?!0:t===am&&Oo(e):Oo(r===am?t:r)},Dot=function(r){var t=0,e=1;(r[t]===ld||r[t]===ca)&&(r[t]===ca&&(e=-1),t++);for(var n=[];Oo(r[t]);)n.push(r[t++]);var i=n.length?parseInt($i.apply(void 0,n),10):0;r[t]===am&&t++;for(var s=[];Oo(r[t]);)s.push(r[t++]);var a=s.length,o=a?parseInt($i.apply(void 0,s),10):0;(r[t]===tM||r[t]===Y4)&&t++;var d=1;(r[t]===ld||r[t]===ca)&&(r[t]===ca&&(d=-1),t++);for(var p=[];Oo(r[t]);)p.push(r[t++]);var y=p.length?parseInt($i.apply(void 0,p),10):0;return e*(i+o*Math.pow(10,-a))*Math.pow(10,d*y)},Not={type:2},kot={type:3},Qot={type:4},zot={type:13},Hot={type:8},Vot={type:21},Got={type:9},jot={type:10},qot={type:11},Kot={type:12},$ot={type:14},_1={type:23},Wot={type:1},Xot={type:25},Jot={type:24},Yot={type:26},Zot={type:27},tat={type:28},eat={type:29},rat={type:31},Lx={type:32},nM=function(){function r(){this._value=[]}return r.prototype.write=function(t){this._value=this._value.concat(e1(t))},r.prototype.read=function(){for(var t=[],e=this.consumeToken();e!==Lx;)t.push(e),e=this.consumeToken();return t},r.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case h1:return this.consumeStringToken(h1);case rot:var e=this.peekCodePoint(0),n=this.peekCodePoint(1),i=this.peekCodePoint(2);if(rM(e)||XA(n,i)){var s=y1(e,n,i)?Zst:Yst,a=this.consumeName();return{type:5,value:a,flags:s}}break;case not:if(this.peekCodePoint(0)===sm)return this.consumeCodePoint(),zot;break;case d1:return this.consumeStringToken(d1);case f1:return Not;case om:return kot;case Ix:if(this.peekCodePoint(0)===sm)return this.consumeCodePoint(),$ot;break;case ld:if(Fx(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case mot:return Qot;case ca:var o=t,d=this.peekCodePoint(0),p=this.peekCodePoint(1);if(Fx(o,d,p))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(y1(o,d,p))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(d===ca&&p===lot)return this.consumeCodePoint(),this.consumeCodePoint(),Jot;break;case am:if(Fx(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case K4:if(this.peekCodePoint(0)===Ix)for(this.consumeCodePoint();;){var y=this.consumeCodePoint();if(y===Ix&&(y=this.consumeCodePoint(),y===K4))return this.consumeToken();if(y===Zc)return this.consumeToken()}break;case yot:return Yot;case _ot:return Zot;case aot:if(this.peekCodePoint(0)===oot&&this.peekCodePoint(1)===ca&&this.peekCodePoint(2)===ca)return this.consumeCodePoint(),this.consumeCodePoint(),Xot;break;case cot:var b=this.peekCodePoint(0),x=this.peekCodePoint(1),C=this.peekCodePoint(2);if(y1(b,x,C)){var a=this.consumeName();return{type:7,value:a}}break;case uot:return tat;case im:if(XA(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case Aot:return eat;case hot:if(this.peekCodePoint(0)===sm)return this.consumeCodePoint(),Hot;break;case dot:return qot;case fot:return Kot;case Sot:case Iot:var P=this.peekCodePoint(0),M=this.peekCodePoint(1);return P===ld&&(qf(M)||M===p1)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case $4:if(this.peekCodePoint(0)===sm)return this.consumeCodePoint(),Got;if(this.peekCodePoint(0)===$4)return this.consumeCodePoint(),Vot;break;case pot:if(this.peekCodePoint(0)===sm)return this.consumeCodePoint(),jot;break;case Zc:return Lx}return g1(t)?(this.consumeWhiteSpace(),rat):Oo(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):m1(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:$i(t)}},r.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},r.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},r.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},r.prototype.consumeUnicodeRangeToken=function(){for(var t=[],e=this.consumeCodePoint();qf(e)&&t.length<6;)t.push(e),e=this.consumeCodePoint();for(var n=!1;e===p1&&t.length<6;)t.push(e),e=this.consumeCodePoint(),n=!0;if(n){var i=parseInt($i.apply(void 0,t.map(function(d){return d===p1?X4:d})),16),s=parseInt($i.apply(void 0,t.map(function(d){return d===p1?eM:d})),16);return{type:30,start:i,end:s}}var a=parseInt($i.apply(void 0,t),16);if(this.peekCodePoint(0)===ca&&qf(this.peekCodePoint(1))){this.consumeCodePoint(),e=this.consumeCodePoint();for(var o=[];qf(e)&&o.length<6;)o.push(e),e=this.consumeCodePoint();var s=parseInt($i.apply(void 0,o),16);return{type:30,start:a,end:s}}else return{type:30,start:a,end:a}},r.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===f1?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===f1?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},r.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Zc)return{type:22,value:""};var e=this.peekCodePoint(0);if(e===d1||e===h1){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Zc||this.peekCodePoint(0)===om)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),_1)}for(;;){var i=this.consumeCodePoint();if(i===Zc||i===om)return{type:22,value:$i.apply(void 0,t)};if(g1(i))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Zc||this.peekCodePoint(0)===om?(this.consumeCodePoint(),{type:22,value:$i.apply(void 0,t)}):(this.consumeBadUrlRemnants(),_1);if(i===h1||i===d1||i===f1||Oot(i))return this.consumeBadUrlRemnants(),_1;if(i===im)if(XA(i,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),_1;else t.push(i)}},r.prototype.consumeWhiteSpace=function(){for(;g1(this.peekCodePoint(0));)this.consumeCodePoint()},r.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===om||t===Zc)return;XA(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},r.prototype.consumeStringSlice=function(t){for(var e=5e4,n="";t>0;){var i=Math.min(e,t);n+=$i.apply(void 0,this._value.splice(0,i)),t-=i}return this._value.shift(),n},r.prototype.consumeStringToken=function(t){var e="",n=0;do{var i=this._value[n];if(i===Zc||i===void 0||i===t)return e+=this.consumeStringSlice(n),{type:0,value:e};if(i===A1)return this._value.splice(0,n),Wot;if(i===im){var s=this._value[n+1];s!==Zc&&s!==void 0&&(s===A1?(e+=this.consumeStringSlice(n),n=-1,this._value.shift()):XA(i,s)&&(e+=this.consumeStringSlice(n),e+=$i(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},r.prototype.consumeNumber=function(){var t=[],e=nm,n=this.peekCodePoint(0);for((n===ld||n===ca)&&t.push(this.consumeCodePoint());Oo(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0);var i=this.peekCodePoint(1);if(n===am&&Oo(i))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),e=q4;Oo(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0),i=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((n===tM||n===Y4)&&((i===ld||i===ca)&&Oo(s)||Oo(i)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),e=q4;Oo(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[Dot(t),e]},r.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),e=t[0],n=t[1],i=this.peekCodePoint(0),s=this.peekCodePoint(1),a=this.peekCodePoint(2);if(y1(i,s,a)){var o=this.consumeName();return{type:15,number:e,flags:n,unit:o}}return i===iot?(this.consumeCodePoint(),{type:16,number:e,flags:n}):{type:17,number:e,flags:n}},r.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(qf(t)){for(var e=$i(t);qf(this.peekCodePoint(0))&&e.length<6;)e+=$i(this.consumeCodePoint());g1(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(e,16);return n===0||Lot(n)||n>1114111?W4:n}return t===Zc?W4:t},r.prototype.consumeName=function(){for(var t="";;){var e=this.consumeCodePoint();if(rM(e))t+=$i(e);else if(XA(e,this.peekCodePoint(0)))t+=$i(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(e),t}},r}(),iM=function(){function r(t){this._tokens=t}return r.create=function(t){var e=new nM;return e.write(t),new r(e.read())},r.parseValue=function(t){return r.create(t).parseComponentValue()},r.parseValues=function(t){return r.create(t).parseComponentValues()},r.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var e=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return e;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},r.prototype.parseComponentValues=function(){for(var t=[];;){var e=this.consumeComponentValue();if(e.type===32)return t;t.push(e),t.push()}},r.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},r.prototype.consumeSimpleBlock=function(t){for(var e={type:t,values:[]},n=this.consumeToken();;){if(n.type===32||iat(n,t))return e;this.reconsumeToken(n),e.values.push(this.consumeComponentValue()),n=this.consumeToken()}},r.prototype.consumeFunction=function(t){for(var e={name:t.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return e;this.reconsumeToken(n),e.values.push(this.consumeComponentValue())}},r.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?Lx:t},r.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},r}(),lm=function(r){return r.type===15},Kf=function(r){return r.type===17},si=function(r){return r.type===20},nat=function(r){return r.type===0},Px=function(r,t){return si(r)&&r.value===t},sM=function(r){return r.type!==31},$f=function(r){return r.type!==31&&r.type!==4},tu=function(r){var t=[],e=[];return r.forEach(function(n){if(n.type===4){if(e.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(e),e=[];return}n.type!==31&&e.push(n)}),e.length&&t.push(e),t},iat=function(r,t){return t===11&&r.type===12||t===28&&r.type===29?!0:t===2&&r.type===3},JA=function(r){return r.type===17||r.type===15},ls=function(r){return r.type===16||JA(r)},oM=function(r){return r.length>1?[r[0],r[1]]:[r[0]]},qs={type:17,number:0,flags:nm},Mx={type:16,number:50,flags:nm},YA={type:16,number:100,flags:nm},cm=function(r,t,e){var n=r[0],i=r[1];return[yi(n,t),yi(typeof i<"u"?i:n,e)]},yi=function(r,t){if(r.type===16)return r.number/100*t;if(lm(r))switch(r.unit){case"rem":case"em":return 16*r.number;case"px":default:return r.number}return r.number},aM="deg",lM="grad",cM="rad",uM="turn",v1={name:"angle",parse:function(r,t){if(t.type===15)switch(t.unit){case aM:return Math.PI*t.number/180;case lM:return Math.PI/200*t.number;case cM:return t.number;case uM:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},AM=function(r){return r.type===15&&(r.unit===aM||r.unit===lM||r.unit===cM||r.unit===uM)},hM=function(r){var t=r.filter(si).map(function(e){return e.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[qs,qs];case"to top":case"bottom":return fl(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[qs,YA];case"to right":case"left":return fl(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[YA,YA];case"to bottom":case"top":return fl(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[YA,qs];case"to left":case"right":return fl(270)}return 0},fl=function(r){return Math.PI*r/180},ZA={name:"color",parse:function(r,t){if(t.type===18){var e=sat[t.name];if(typeof e>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return e(r,t.values)}if(t.type===5){if(t.value.length===3){var n=t.value.substring(0,1),i=t.value.substring(1,2),s=t.value.substring(2,3);return eh(parseInt(n+n,16),parseInt(i+i,16),parseInt(s+s,16),1)}if(t.value.length===4){var n=t.value.substring(0,1),i=t.value.substring(1,2),s=t.value.substring(2,3),a=t.value.substring(3,4);return eh(parseInt(n+n,16),parseInt(i+i,16),parseInt(s+s,16),parseInt(a+a,16)/255)}if(t.value.length===6){var n=t.value.substring(0,2),i=t.value.substring(2,4),s=t.value.substring(4,6);return eh(parseInt(n,16),parseInt(i,16),parseInt(s,16),1)}if(t.value.length===8){var n=t.value.substring(0,2),i=t.value.substring(2,4),s=t.value.substring(4,6),a=t.value.substring(6,8);return eh(parseInt(n,16),parseInt(i,16),parseInt(s,16),parseInt(a,16)/255)}}if(t.type===20){var o=Ku[t.value.toUpperCase()];if(typeof o<"u")return o}return Ku.TRANSPARENT}},th=function(r){return(255&r)===0},Ds=function(r){var t=255&r,e=255&r>>8,n=255&r>>16,i=255&r>>24;return t<255?"rgba("+i+","+n+","+e+","+t/255+")":"rgb("+i+","+n+","+e+")"},eh=function(r,t,e,n){return(r<<24|t<<16|e<<8|Math.round(n*255)<<0)>>>0},dM=function(r,t){if(r.type===17)return r.number;if(r.type===16){var e=t===3?1:255;return t===3?r.number/100*e:Math.round(r.number/100*e)}return 0},fM=function(r,t){var e=t.filter($f);if(e.length===3){var n=e.map(dM),i=n[0],s=n[1],a=n[2];return eh(i,s,a,1)}if(e.length===4){var o=e.map(dM),i=o[0],s=o[1],a=o[2],d=o[3];return eh(i,s,a,d)}return 0};function Ux(r,t,e){return e<0&&(e+=1),e>=1&&(e-=1),e<1/6?(t-r)*e*6+r:e<1/2?t:e<2/3?(t-r)*6*(2/3-e)+r:r}var pM=function(r,t){var e=t.filter($f),n=e[0],i=e[1],s=e[2],a=e[3],o=(n.type===17?fl(n.number):v1.parse(r,n))/(Math.PI*2),d=ls(i)?i.number/100:0,p=ls(s)?s.number/100:0,y=typeof a<"u"&&ls(a)?yi(a,1):1;if(d===0)return eh(p*255,p*255,p*255,1);var b=p<=.5?p*(d+1):p+d-p*d,x=p*2-b,C=Ux(x,b,o+1/3),P=Ux(x,b,o),M=Ux(x,b,o-1/3);return eh(C*255,P*255,M*255,y)},sat={hsl:pM,hsla:pM,rgb:fM,rgba:fM},um=function(r,t){return ZA.parse(r,iM.create(t).parseComponentValue())},Ku={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},oat={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(r,t){return t.map(function(e){if(si(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},aat={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},b1=function(r,t){var e=ZA.parse(r,t[0]),n=t[1];return n&&ls(n)?{color:e,stop:n}:{color:e,stop:null}},gM=function(r,t){var e=r[0],n=r[r.length-1];e.stop===null&&(e.stop=qs),n.stop===null&&(n.stop=YA);for(var i=[],s=0,a=0;a<r.length;a++){var o=r[a].stop;if(o!==null){var d=yi(o,t);d>s?i.push(d):i.push(s),s=d}else i.push(null)}for(var p=null,a=0;a<i.length;a++){var y=i[a];if(y===null)p===null&&(p=a);else if(p!==null){for(var b=a-p,x=i[p-1],C=(y-x)/(b+1),P=1;P<=b;P++)i[p+P-1]=C*P;p=null}}return r.map(function(M,k){var z=M.color;return{color:z,stop:Math.max(Math.min(1,i[k]/t),0)}})},lat=function(r,t,e){var n=t/2,i=e/2,s=yi(r[0],t)-n,a=i-yi(r[1],e);return(Math.atan2(a,s)+Math.PI*2)%(Math.PI*2)},cat=function(r,t,e){var n=typeof r=="number"?r:lat(r,t,e),i=Math.abs(t*Math.sin(n))+Math.abs(e*Math.cos(n)),s=t/2,a=e/2,o=i/2,d=Math.sin(n-Math.PI/2)*o,p=Math.cos(n-Math.PI/2)*o;return[i,s-p,s+p,a-d,a+d]},lc=function(r,t){return Math.sqrt(r*r+t*t)},mM=function(r,t,e,n,i){var s=[[0,0],[0,t],[r,0],[r,t]];return s.reduce(function(a,o){var d=o[0],p=o[1],y=lc(e-d,n-p);return(i?y<a.optimumDistance:y>a.optimumDistance)?{optimumCorner:o,optimumDistance:y}:a},{optimumDistance:i?1/0:-1/0,optimumCorner:null}).optimumCorner},uat=function(r,t,e,n,i){var s=0,a=0;switch(r.size){case 0:r.shape===0?s=a=Math.min(Math.abs(t),Math.abs(t-n),Math.abs(e),Math.abs(e-i)):r.shape===1&&(s=Math.min(Math.abs(t),Math.abs(t-n)),a=Math.min(Math.abs(e),Math.abs(e-i)));break;case 2:if(r.shape===0)s=a=Math.min(lc(t,e),lc(t,e-i),lc(t-n,e),lc(t-n,e-i));else if(r.shape===1){var o=Math.min(Math.abs(e),Math.abs(e-i))/Math.min(Math.abs(t),Math.abs(t-n)),d=mM(n,i,t,e,!0),p=d[0],y=d[1];s=lc(p-t,(y-e)/o),a=o*s}break;case 1:r.shape===0?s=a=Math.max(Math.abs(t),Math.abs(t-n),Math.abs(e),Math.abs(e-i)):r.shape===1&&(s=Math.max(Math.abs(t),Math.abs(t-n)),a=Math.max(Math.abs(e),Math.abs(e-i)));break;case 3:if(r.shape===0)s=a=Math.max(lc(t,e),lc(t,e-i),lc(t-n,e),lc(t-n,e-i));else if(r.shape===1){var o=Math.max(Math.abs(e),Math.abs(e-i))/Math.max(Math.abs(t),Math.abs(t-n)),b=mM(n,i,t,e,!1),p=b[0],y=b[1];s=lc(p-t,(y-e)/o),a=o*s}break}return Array.isArray(r.size)&&(s=yi(r.size[0],n),a=r.size.length===2?yi(r.size[1],i):s),[s,a]},Aat=function(r,t){var e=fl(180),n=[];return tu(t).forEach(function(i,s){if(s===0){var a=i[0];if(a.type===20&&a.value==="to"){e=hM(i);return}else if(AM(a)){e=v1.parse(r,a);return}}var o=b1(r,i);n.push(o)}),{angle:e,stops:n,type:1}},w1=function(r,t){var e=fl(180),n=[];return tu(t).forEach(function(i,s){if(s===0){var a=i[0];if(a.type===20&&["top","left","right","bottom"].indexOf(a.value)!==-1){e=hM(i);return}else if(AM(a)){e=(v1.parse(r,a)+fl(270))%fl(360);return}}var o=b1(r,i);n.push(o)}),{angle:e,stops:n,type:1}},hat=function(r,t){var e=fl(180),n=[],i=1,s=0,a=3,o=[];return tu(t).forEach(function(d,p){var y=d[0];if(p===0){if(si(y)&&y.value==="linear"){i=1;return}else if(si(y)&&y.value==="radial"){i=2;return}}if(y.type===18){if(y.name==="from"){var b=ZA.parse(r,y.values[0]);n.push({stop:qs,color:b})}else if(y.name==="to"){var b=ZA.parse(r,y.values[0]);n.push({stop:YA,color:b})}else if(y.name==="color-stop"){var x=y.values.filter($f);if(x.length===2){var b=ZA.parse(r,x[1]),C=x[0];Kf(C)&&n.push({stop:{type:16,number:C.number*100,flags:C.flags},color:b})}}}}),i===1?{angle:(e+fl(180))%fl(360),stops:n,type:i}:{size:a,shape:s,stops:n,position:o,type:i}},yM="closest-side",_M="farthest-side",vM="closest-corner",bM="farthest-corner",wM="circle",xM="ellipse",BM="cover",CM="contain",dat=function(r,t){var e=0,n=3,i=[],s=[];return tu(t).forEach(function(a,o){var d=!0;if(o===0){var p=!1;d=a.reduce(function(b,x){if(p)if(si(x))switch(x.value){case"center":return s.push(Mx),b;case"top":case"left":return s.push(qs),b;case"right":case"bottom":return s.push(YA),b}else(ls(x)||JA(x))&&s.push(x);else if(si(x))switch(x.value){case wM:return e=0,!1;case xM:return e=1,!1;case"at":return p=!0,!1;case yM:return n=0,!1;case BM:case _M:return n=1,!1;case CM:case vM:return n=2,!1;case bM:return n=3,!1}else if(JA(x)||ls(x))return Array.isArray(n)||(n=[]),n.push(x),!1;return b},d)}if(d){var y=b1(r,a);i.push(y)}}),{size:n,shape:e,stops:i,position:s,type:2}},x1=function(r,t){var e=0,n=3,i=[],s=[];return tu(t).forEach(function(a,o){var d=!0;if(o===0?d=a.reduce(function(y,b){if(si(b))switch(b.value){case"center":return s.push(Mx),!1;case"top":case"left":return s.push(qs),!1;case"right":case"bottom":return s.push(YA),!1}else if(ls(b)||JA(b))return s.push(b),!1;return y},d):o===1&&(d=a.reduce(function(y,b){if(si(b))switch(b.value){case wM:return e=0,!1;case xM:return e=1,!1;case CM:case yM:return n=0,!1;case _M:return n=1,!1;case vM:return n=2,!1;case BM:case bM:return n=3,!1}else if(JA(b)||ls(b))return Array.isArray(n)||(n=[]),n.push(b),!1;return y},d)),d){var p=b1(r,a);i.push(p)}}),{size:n,shape:e,stops:i,position:s,type:2}},fat=function(r){return r.type===1},pat=function(r){return r.type===2},Rx={name:"image",parse:function(r,t){if(t.type===22){var e={url:t.value,type:0};return r.cache.addImage(t.value),e}if(t.type===18){var n=EM[t.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return n(r,t.values)}throw new Error("Unsupported image type "+t.type)}};function gat(r){return!(r.type===20&&r.value==="none")&&(r.type!==18||!!EM[r.name])}var EM={"linear-gradient":Aat,"-moz-linear-gradient":w1,"-ms-linear-gradient":w1,"-o-linear-gradient":w1,"-webkit-linear-gradient":w1,"radial-gradient":dat,"-moz-radial-gradient":x1,"-ms-radial-gradient":x1,"-o-radial-gradient":x1,"-webkit-radial-gradient":x1,"-webkit-gradient":hat},mat={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(r,t){if(t.length===0)return[];var e=t[0];return e.type===20&&e.value==="none"?[]:t.filter(function(n){return $f(n)&&gat(n)}).map(function(n){return Rx.parse(r,n)})}},yat={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(r,t){return t.map(function(e){if(si(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},_at={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(r,t){return tu(t).map(function(e){return e.filter(ls)}).map(oM)}},vat={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(r,t){return tu(t).map(function(e){return e.filter(si).map(function(n){return n.value}).join(" ")}).map(bat)}},bat=function(r){switch(r){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},Wf;(function(r){r.AUTO="auto",r.CONTAIN="contain",r.COVER="cover"})(Wf||(Wf={}));var wat={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(r,t){return tu(t).map(function(e){return e.filter(xat)})}},xat=function(r){return si(r)||ls(r)},B1=function(r){return{name:"border-"+r+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},Bat=B1("top"),Cat=B1("right"),Eat=B1("bottom"),Sat=B1("left"),C1=function(r){return{name:"border-radius-"+r,initialValue:"0 0",prefix:!1,type:1,parse:function(t,e){return oM(e.filter(ls))}}},Tat=C1("top-left"),Iat=C1("top-right"),Fat=C1("bottom-right"),Lat=C1("bottom-left"),E1=function(r){return{name:"border-"+r+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,e){switch(e){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Pat=E1("top"),Mat=E1("right"),Uat=E1("bottom"),Rat=E1("left"),S1=function(r){return{name:"border-"+r+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return lm(e)?e.number:0}}},Oat=S1("top"),Dat=S1("right"),Nat=S1("bottom"),kat=S1("left"),Qat={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},zat={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(r,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},Hat={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(r,t){return t.filter(si).reduce(function(e,n){return e|Vat(n.value)},0)}},Vat=function(r){switch(r){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Gat={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(r,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},jat={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(r,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},T1;(function(r){r.NORMAL="normal",r.STRICT="strict"})(T1||(T1={}));var qat={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(r,t){switch(t){case"strict":return T1.STRICT;case"normal":default:return T1.NORMAL}}},Kat={name:"line-height",initialValue:"normal",prefix:!1,type:4},SM=function(r,t){return si(r)&&r.value==="normal"?1.2*t:r.type===17?t*r.number:ls(r)?yi(r,t):t},$at={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(r,t){return t.type===20&&t.value==="none"?null:Rx.parse(r,t)}},Wat={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(r,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},Ox={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(r,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},I1=function(r){return{name:"margin-"+r,initialValue:"0",prefix:!1,type:4}},Xat=I1("top"),Jat=I1("right"),Yat=I1("bottom"),Zat=I1("left"),tlt={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(r,t){return t.filter(si).map(function(e){switch(e.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},elt={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(r,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},F1=function(r){return{name:"padding-"+r,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},rlt=F1("top"),nlt=F1("right"),ilt=F1("bottom"),slt=F1("left"),olt={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(r,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},alt={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(r,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},llt={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(r,t){return t.length===1&&Px(t[0],"none")?[]:tu(t).map(function(e){for(var n={color:Ku.TRANSPARENT,offsetX:qs,offsetY:qs,blur:qs},i=0,s=0;s<e.length;s++){var a=e[s];JA(a)?(i===0?n.offsetX=a:i===1?n.offsetY=a:n.blur=a,i++):n.color=ZA.parse(r,a)}return n})}},clt={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(r,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},ult={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(r,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var e=dlt[t.name];if(typeof e>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return e(t.values)}return null}},Alt=function(r){var t=r.filter(function(e){return e.type===17}).map(function(e){return e.number});return t.length===6?t:null},hlt=function(r){var t=r.filter(function(d){return d.type===17}).map(function(d){return d.number}),e=t[0],n=t[1];t[2],t[3];var i=t[4],s=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var a=t[12],o=t[13];return t[14],t[15],t.length===16?[e,n,i,s,a,o]:null},dlt={matrix:Alt,matrix3d:hlt},TM={type:16,number:50,flags:nm},flt=[TM,TM],plt={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(r,t){var e=t.filter(ls);return e.length!==2?flt:[e[0],e[1]]}},glt={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(r,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Am;(function(r){r.NORMAL="normal",r.BREAK_ALL="break-all",r.KEEP_ALL="keep-all"})(Am||(Am={}));for(var mlt={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(r,t){switch(t){case"break-all":return Am.BREAK_ALL;case"keep-all":return Am.KEEP_ALL;case"normal":default:return Am.NORMAL}}},ylt={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(r,t){if(t.type===20)return{auto:!0,order:0};if(Kf(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},IM={name:"time",parse:function(r,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},_lt={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(r,t){return Kf(t)?t.number:1}},vlt={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},blt={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(r,t){return t.filter(si).map(function(e){switch(e.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(e){return e!==0})}},wlt={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(r,t){var e=[],n=[];return t.forEach(function(i){switch(i.type){case 20:case 0:e.push(i.value);break;case 17:e.push(i.number.toString());break;case 4:n.push(e.join(" ")),e.length=0;break}}),e.length&&n.push(e.join(" ")),n.map(function(i){return i.indexOf(" ")===-1?i:"'"+i+"'"})}},xlt={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},Blt={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(r,t){if(Kf(t))return t.number;if(si(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},Clt={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(r,t){return t.filter(si).map(function(e){return e.value})}},Elt={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(r,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},_s=function(r,t){return(r&t)!==0},Slt={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(r,t){if(t.length===0)return[];var e=t[0];return e.type===20&&e.value==="none"?[]:t}},Tlt={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(r,t){if(t.length===0)return null;var e=t[0];if(e.type===20&&e.value==="none")return null;for(var n=[],i=t.filter(sM),s=0;s<i.length;s++){var a=i[s],o=i[s+1];if(a.type===20){var d=o&&Kf(o)?o.number:1;n.push({counter:a.value,increment:d})}}return n}},Ilt={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(r,t){if(t.length===0)return[];for(var e=[],n=t.filter(sM),i=0;i<n.length;i++){var s=n[i],a=n[i+1];if(si(s)&&s.value!=="none"){var o=a&&Kf(a)?a.number:0;e.push({counter:s.value,reset:o})}}return e}},Flt={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(r,t){return t.filter(lm).map(function(e){return IM.parse(r,e)})}},Llt={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(r,t){if(t.length===0)return null;var e=t[0];if(e.type===20&&e.value==="none")return null;var n=[],i=t.filter(nat);if(i.length%2!==0)return null;for(var s=0;s<i.length;s+=2){var a=i[s].value,o=i[s+1].value;n.push({open:a,close:o})}return n}},FM=function(r,t,e){if(!r)return"";var n=r[Math.min(t,r.length-1)];return n?e?n.open:n.close:""},Plt={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(r,t){return t.length===1&&Px(t[0],"none")?[]:tu(t).map(function(e){for(var n={color:255,offsetX:qs,offsetY:qs,blur:qs,spread:qs,inset:!1},i=0,s=0;s<e.length;s++){var a=e[s];Px(a,"inset")?n.inset=!0:JA(a)?(i===0?n.offsetX=a:i===1?n.offsetY=a:i===2?n.blur=a:n.spread=a,i++):n.color=ZA.parse(r,a)}return n})}},Mlt={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(r,t){var e=[0,1,2],n=[];return t.filter(si).forEach(function(i){switch(i.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),e.forEach(function(i){n.indexOf(i)===-1&&n.push(i)}),n}},Ult={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},Rlt={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(r,t){return lm(t)?t.number:0}},Olt=function(){function r(t,e){var n,i;this.animationDuration=hr(t,Flt,e.animationDuration),this.backgroundClip=hr(t,oat,e.backgroundClip),this.backgroundColor=hr(t,aat,e.backgroundColor),this.backgroundImage=hr(t,mat,e.backgroundImage),this.backgroundOrigin=hr(t,yat,e.backgroundOrigin),this.backgroundPosition=hr(t,_at,e.backgroundPosition),this.backgroundRepeat=hr(t,vat,e.backgroundRepeat),this.backgroundSize=hr(t,wat,e.backgroundSize),this.borderTopColor=hr(t,Bat,e.borderTopColor),this.borderRightColor=hr(t,Cat,e.borderRightColor),this.borderBottomColor=hr(t,Eat,e.borderBottomColor),this.borderLeftColor=hr(t,Sat,e.borderLeftColor),this.borderTopLeftRadius=hr(t,Tat,e.borderTopLeftRadius),this.borderTopRightRadius=hr(t,Iat,e.borderTopRightRadius),this.borderBottomRightRadius=hr(t,Fat,e.borderBottomRightRadius),this.borderBottomLeftRadius=hr(t,Lat,e.borderBottomLeftRadius),this.borderTopStyle=hr(t,Pat,e.borderTopStyle),this.borderRightStyle=hr(t,Mat,e.borderRightStyle),this.borderBottomStyle=hr(t,Uat,e.borderBottomStyle),this.borderLeftStyle=hr(t,Rat,e.borderLeftStyle),this.borderTopWidth=hr(t,Oat,e.borderTopWidth),this.borderRightWidth=hr(t,Dat,e.borderRightWidth),this.borderBottomWidth=hr(t,Nat,e.borderBottomWidth),this.borderLeftWidth=hr(t,kat,e.borderLeftWidth),this.boxShadow=hr(t,Plt,e.boxShadow),this.color=hr(t,Qat,e.color),this.direction=hr(t,zat,e.direction),this.display=hr(t,Hat,e.display),this.float=hr(t,Gat,e.cssFloat),this.fontFamily=hr(t,wlt,e.fontFamily),this.fontSize=hr(t,xlt,e.fontSize),this.fontStyle=hr(t,Elt,e.fontStyle),this.fontVariant=hr(t,Clt,e.fontVariant),this.fontWeight=hr(t,Blt,e.fontWeight),this.letterSpacing=hr(t,jat,e.letterSpacing),this.lineBreak=hr(t,qat,e.lineBreak),this.lineHeight=hr(t,Kat,e.lineHeight),this.listStyleImage=hr(t,$at,e.listStyleImage),this.listStylePosition=hr(t,Wat,e.listStylePosition),this.listStyleType=hr(t,Ox,e.listStyleType),this.marginTop=hr(t,Xat,e.marginTop),this.marginRight=hr(t,Jat,e.marginRight),this.marginBottom=hr(t,Yat,e.marginBottom),this.marginLeft=hr(t,Zat,e.marginLeft),this.opacity=hr(t,_lt,e.opacity);var s=hr(t,tlt,e.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=hr(t,elt,e.overflowWrap),this.paddingTop=hr(t,rlt,e.paddingTop),this.paddingRight=hr(t,nlt,e.paddingRight),this.paddingBottom=hr(t,ilt,e.paddingBottom),this.paddingLeft=hr(t,slt,e.paddingLeft),this.paintOrder=hr(t,Mlt,e.paintOrder),this.position=hr(t,alt,e.position),this.textAlign=hr(t,olt,e.textAlign),this.textDecorationColor=hr(t,vlt,(n=e.textDecorationColor)!==null&&n!==void 0?n:e.color),this.textDecorationLine=hr(t,blt,(i=e.textDecorationLine)!==null&&i!==void 0?i:e.textDecoration),this.textShadow=hr(t,llt,e.textShadow),this.textTransform=hr(t,clt,e.textTransform),this.transform=hr(t,ult,e.transform),this.transformOrigin=hr(t,plt,e.transformOrigin),this.visibility=hr(t,glt,e.visibility),this.webkitTextStrokeColor=hr(t,Ult,e.webkitTextStrokeColor),this.webkitTextStrokeWidth=hr(t,Rlt,e.webkitTextStrokeWidth),this.wordBreak=hr(t,mlt,e.wordBreak),this.zIndex=hr(t,ylt,e.zIndex)}return r.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},r.prototype.isTransparent=function(){return th(this.backgroundColor)},r.prototype.isTransformed=function(){return this.transform!==null},r.prototype.isPositioned=function(){return this.position!==0},r.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},r.prototype.isFloating=function(){return this.float!==0},r.prototype.isInlineLevel=function(){return _s(this.display,4)||_s(this.display,33554432)||_s(this.display,268435456)||_s(this.display,536870912)||_s(this.display,67108864)||_s(this.display,134217728)},r}(),Dlt=function(){function r(t,e){this.content=hr(t,Slt,e.content),this.quotes=hr(t,Llt,e.quotes)}return r}(),LM=function(){function r(t,e){this.counterIncrement=hr(t,Tlt,e.counterIncrement),this.counterReset=hr(t,Ilt,e.counterReset)}return r}(),hr=function(r,t,e){var n=new nM,i=e!==null&&typeof e<"u"?e.toString():t.initialValue;n.write(i);var s=new iM(n.read());switch(t.type){case 2:var a=s.parseComponentValue();return t.parse(r,si(a)?a.value:t.initialValue);case 0:return t.parse(r,s.parseComponentValue());case 1:return t.parse(r,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(t.format){case"angle":return v1.parse(r,s.parseComponentValue());case"color":return ZA.parse(r,s.parseComponentValue());case"image":return Rx.parse(r,s.parseComponentValue());case"length":var o=s.parseComponentValue();return JA(o)?o:qs;case"length-percentage":var d=s.parseComponentValue();return ls(d)?d:qs;case"time":return IM.parse(r,s.parseComponentValue())}break}},Nlt="data-html2canvas-debug",klt=function(r){var t=r.getAttribute(Nlt);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Dx=function(r,t){var e=klt(r);return e===1||t===e},eu=function(){function r(t,e){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,Dx(e,3))debugger;this.styles=new Olt(t,window.getComputedStyle(e,null)),Xx(e)&&(this.styles.animationDuration.some(function(n){return n>0})&&(e.style.animationDuration="0s"),this.styles.transform!==null&&(e.style.transform="none")),this.bounds=t1(this.context,e),Dx(e,4)&&(this.flags|=16)}return r}(),Qlt="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",PM="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",hm=typeof Uint8Array>"u"?[]:new Uint8Array(256),L1=0;L1<PM.length;L1++)hm[PM.charCodeAt(L1)]=L1;for(var zlt=function(r){var t=r.length*.75,e=r.length,n,i=0,s,a,o,d;r[r.length-1]==="="&&(t--,r[r.length-2]==="="&&t--);var p=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),y=Array.isArray(p)?p:new Uint8Array(p);for(n=0;n<e;n+=4)s=hm[r.charCodeAt(n)],a=hm[r.charCodeAt(n+1)],o=hm[r.charCodeAt(n+2)],d=hm[r.charCodeAt(n+3)],y[i++]=s<<2|a>>4,y[i++]=(a&15)<<4|o>>2,y[i++]=(o&3)<<6|d&63;return p},Hlt=function(r){for(var t=r.length,e=[],n=0;n<t;n+=2)e.push(r[n+1]<<8|r[n]);return e},Vlt=function(r){for(var t=r.length,e=[],n=0;n<t;n+=4)e.push(r[n+3]<<24|r[n+2]<<16|r[n+1]<<8|r[n]);return e},cd=5,Nx=11,kx=2,Glt=Nx-cd,MM=65536>>cd,jlt=1<<cd,Qx=jlt-1,qlt=1024>>cd,Klt=MM+qlt,$lt=Klt,Wlt=32,Xlt=$lt+Wlt,Jlt=65536>>Nx,Ylt=1<<Glt,Zlt=Ylt-1,UM=function(r,t,e){return r.slice?r.slice(t,e):new Uint16Array(Array.prototype.slice.call(r,t,e))},tct=function(r,t,e){return r.slice?r.slice(t,e):new Uint32Array(Array.prototype.slice.call(r,t,e))},ect=function(r,t){var e=zlt(r),n=Array.isArray(e)?Vlt(e):new Uint32Array(e),i=Array.isArray(e)?Hlt(e):new Uint16Array(e),s=24,a=UM(i,s/2,n[4]/2),o=n[5]===2?UM(i,(s+n[4])/2):tct(n,Math.ceil((s+n[4])/4));return new rct(n[0],n[1],n[2],n[3],a,o)},rct=function(){function r(t,e,n,i,s,a){this.initialValue=t,this.errorValue=e,this.highStart=n,this.highValueIndex=i,this.index=s,this.data=a}return r.prototype.get=function(t){var e;if(t>=0){if(t<55296||t>56319&&t<=65535)return e=this.index[t>>cd],e=(e<<kx)+(t&Qx),this.data[e];if(t<=65535)return e=this.index[MM+(t-55296>>cd)],e=(e<<kx)+(t&Qx),this.data[e];if(t<this.highStart)return e=Xlt-Jlt+(t>>Nx),e=this.index[e],e+=t>>cd&Zlt,e=this.index[e],e=(e<<kx)+(t&Qx),this.data[e];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},r}(),RM="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",nct=typeof Uint8Array>"u"?[]:new Uint8Array(256),P1=0;P1<RM.length;P1++)nct[RM.charCodeAt(P1)]=P1;var ict=1,zx=2,Hx=3,OM=4,DM=5,sct=7,NM=8,Vx=9,Gx=10,kM=11,QM=12,zM=13,HM=14,jx=15,oct=function(r){for(var t=[],e=0,n=r.length;e<n;){var i=r.charCodeAt(e++);if(i>=55296&&i<=56319&&e<n){var s=r.charCodeAt(e++);(s&64512)===56320?t.push(((i&1023)<<10)+(s&1023)+65536):(t.push(i),e--)}else t.push(i)}return t},act=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,r);var e=r.length;if(!e)return"";for(var n=[],i=-1,s="";++i<e;){var a=r[i];a<=65535?n.push(a):(a-=65536,n.push((a>>10)+55296,a%1024+56320)),(i+1===e||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},lct=ect(Qlt),ud="",VM="",cct=function(r){return lct.get(r)},uct=function(r,t,e){var n=e-2,i=t[n],s=t[e-1],a=t[e];if(s===zx&&a===Hx)return ud;if(s===zx||s===Hx||s===OM||a===zx||a===Hx||a===OM)return VM;if(s===NM&&[NM,Vx,kM,QM].indexOf(a)!==-1||(s===kM||s===Vx)&&(a===Vx||a===Gx)||(s===QM||s===Gx)&&a===Gx||a===zM||a===DM||a===sct||s===ict)return ud;if(s===zM&&a===HM){for(;i===DM;)i=t[--n];if(i===HM)return ud}if(s===jx&&a===jx){for(var o=0;i===jx;)o++,i=t[--n];if(o%2===0)return ud}return VM},Act=function(r){var t=oct(r),e=t.length,n=0,i=0,s=t.map(cct);return{next:function(){if(n>=e)return{done:!0,value:null};for(var a=ud;n<e&&(a=uct(t,s,++n))===ud;);if(a!==ud||n===e){var o=act.apply(null,t.slice(i,n));return i=n,{value:o,done:!1}}return{done:!0,value:null}}}},hct=function(r){for(var t=Act(r),e=[],n;!(n=t.next()).done;)n.value&&e.push(n.value.slice());return e},dct=function(r){var t=123;if(r.createRange){var e=r.createRange();if(e.getBoundingClientRect){var n=r.createElement("boundtest");n.style.height=t+"px",n.style.display="block",r.body.appendChild(n),e.selectNode(n);var i=e.getBoundingClientRect(),s=Math.round(i.height);if(r.body.removeChild(n),s===t)return!0}}return!1},fct=function(r){var t=r.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",r.body.appendChild(t);var e=r.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=t.firstChild,i=e1(n.data).map(function(d){return $i(d)}),s=0,a={},o=i.every(function(d,p){e.setStart(n,s),e.setEnd(n,s+d.length);var y=e.getBoundingClientRect();s+=d.length;var b=y.x>a.x||y.y>a.y;return a=y,p===0?!0:b});return r.body.removeChild(t),o},pct=function(){return typeof new Image().crossOrigin<"u"},gct=function(){return typeof new XMLHttpRequest().responseType=="string"},mct=function(r){var t=new Image,e=r.createElement("canvas"),n=e.getContext("2d");if(!n)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),e.toDataURL()}catch{return!1}return!0},GM=function(r){return r[0]===0&&r[1]===255&&r[2]===0&&r[3]===255},yct=function(r){var t=r.createElement("canvas"),e=100;t.width=e,t.height=e;var n=t.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,e,e);var i=new Image,s=t.toDataURL();i.src=s;var a=qx(e,e,0,0,i);return n.fillStyle="red",n.fillRect(0,0,e,e),jM(a).then(function(o){n.drawImage(o,0,0);var d=n.getImageData(0,0,e,e).data;n.fillStyle="red",n.fillRect(0,0,e,e);var p=r.createElement("div");return p.style.backgroundImage="url("+s+")",p.style.height=e+"px",GM(d)?jM(qx(e,e,0,0,p)):Promise.reject(!1)}).then(function(o){return n.drawImage(o,0,0),GM(n.getImageData(0,0,e,e).data)}).catch(function(){return!1})},qx=function(r,t,e,n,i){var s="http://www.w3.org/2000/svg",a=document.createElementNS(s,"svg"),o=document.createElementNS(s,"foreignObject");return a.setAttributeNS(null,"width",r.toString()),a.setAttributeNS(null,"height",t.toString()),o.setAttributeNS(null,"width","100%"),o.setAttributeNS(null,"height","100%"),o.setAttributeNS(null,"x",e.toString()),o.setAttributeNS(null,"y",n.toString()),o.setAttributeNS(null,"externalResourcesRequired","true"),a.appendChild(o),o.appendChild(i),a},jM=function(r){return new Promise(function(t,e){var n=new Image;n.onload=function(){return t(n)},n.onerror=e,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(r))})},Ks={get SUPPORT_RANGE_BOUNDS(){var r=dct(document);return Object.defineProperty(Ks,"SUPPORT_RANGE_BOUNDS",{value:r}),r},get SUPPORT_WORD_BREAKING(){var r=Ks.SUPPORT_RANGE_BOUNDS&&fct(document);return Object.defineProperty(Ks,"SUPPORT_WORD_BREAKING",{value:r}),r},get SUPPORT_SVG_DRAWING(){var r=mct(document);return Object.defineProperty(Ks,"SUPPORT_SVG_DRAWING",{value:r}),r},get SUPPORT_FOREIGNOBJECT_DRAWING(){var r=typeof Array.from=="function"&&typeof window.fetch=="function"?yct(document):Promise.resolve(!1);return Object.defineProperty(Ks,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:r}),r},get SUPPORT_CORS_IMAGES(){var r=pct();return Object.defineProperty(Ks,"SUPPORT_CORS_IMAGES",{value:r}),r},get SUPPORT_RESPONSE_TYPE(){var r=gct();return Object.defineProperty(Ks,"SUPPORT_RESPONSE_TYPE",{value:r}),r},get SUPPORT_CORS_XHR(){var r="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Ks,"SUPPORT_CORS_XHR",{value:r}),r},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var r=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Ks,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:r}),r}},dm=function(){function r(t,e){this.text=t,this.bounds=e}return r}(),_ct=function(r,t,e,n){var i=wct(t,e),s=[],a=0;return i.forEach(function(o){if(e.textDecorationLine.length||o.trim().length>0)if(Ks.SUPPORT_RANGE_BOUNDS){var d=qM(n,a,o.length).getClientRects();if(d.length>1){var p=Kx(o),y=0;p.forEach(function(x){s.push(new dm(x,ju.fromDOMRectList(r,qM(n,y+a,x.length).getClientRects()))),y+=x.length})}else s.push(new dm(o,ju.fromDOMRectList(r,d)))}else{var b=n.splitText(o.length);s.push(new dm(o,vct(r,n))),n=b}else Ks.SUPPORT_RANGE_BOUNDS||(n=n.splitText(o.length));a+=o.length}),s},vct=function(r,t){var e=t.ownerDocument;if(e){var n=e.createElement("html2canvaswrapper");n.appendChild(t.cloneNode(!0));var i=t.parentNode;if(i){i.replaceChild(n,t);var s=t1(r,n);return n.firstChild&&i.replaceChild(n.firstChild,n),s}}return ju.EMPTY},qM=function(r,t,e){var n=r.ownerDocument;if(!n)throw new Error("Node has no owner document");var i=n.createRange();return i.setStart(r,t),i.setEnd(r,t+e),i},Kx=function(r){if(Ks.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(r)).map(function(e){return e.segment})}return hct(r)},bct=function(r,t){if(Ks.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(e.segment(r)).map(function(n){return n.segment})}return Bct(r,t)},wct=function(r,t){return t.letterSpacing!==0?Kx(r):bct(r,t)},xct=[32,160,4961,65792,65793,4153,4241],Bct=function(r,t){for(var e=Jst(r,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),n=[],i,s=function(){if(i.value){var a=i.value.slice(),o=e1(a),d="";o.forEach(function(p){xct.indexOf(p)===-1?d+=$i(p):(d.length&&n.push(d),n.push($i(p)),d="")}),d.length&&n.push(d)}};!(i=e.next()).done;)s();return n},Cct=function(){function r(t,e,n){this.text=Ect(e.data,n.textTransform),this.textBounds=_ct(t,this.text,n,e)}return r}(),Ect=function(r,t){switch(t){case 1:return r.toLowerCase();case 3:return r.replace(Sct,Tct);case 2:return r.toUpperCase();default:return r}},Sct=/(^|\s|:|-|\(|\))([a-z])/g,Tct=function(r,t,e){return r.length>0?t+e.toUpperCase():r},KM=function(r){ac(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.src=n.currentSrc||n.src,i.intrinsicWidth=n.naturalWidth,i.intrinsicHeight=n.naturalHeight,i.context.cache.addImage(i.src),i}return t}(eu),$M=function(r){ac(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.canvas=n,i.intrinsicWidth=n.width,i.intrinsicHeight=n.height,i}return t}(eu),WM=function(r){ac(t,r);function t(e,n){var i=r.call(this,e,n)||this,s=new XMLSerializer,a=t1(e,n);return n.setAttribute("width",a.width+"px"),n.setAttribute("height",a.height+"px"),i.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(n)),i.intrinsicWidth=n.width.baseVal.value,i.intrinsicHeight=n.height.baseVal.value,i.context.cache.addImage(i.svg),i}return t}(eu),XM=function(r){ac(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.value=n.value,i}return t}(eu),$x=function(r){ac(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.start=n.start,i.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,i}return t}(eu),Ict=[{type:15,flags:0,unit:"px",number:3}],Fct=[{type:16,flags:0,number:50}],Lct=function(r){return r.width>r.height?new ju(r.left+(r.width-r.height)/2,r.top,r.height,r.height):r.width<r.height?new ju(r.left,r.top+(r.height-r.width)/2,r.width,r.width):r},Pct=function(r){var t=r.type===Mct?new Array(r.value.length+1).join(""):r.value;return t.length===0?r.placeholder||"":t},M1="checkbox",U1="radio",Mct="password",JM=707406591,Wx=function(r){ac(t,r);function t(e,n){var i=r.call(this,e,n)||this;switch(i.type=n.type.toLowerCase(),i.checked=n.checked,i.value=Pct(n),(i.type===M1||i.type===U1)&&(i.styles.backgroundColor=3739148031,i.styles.borderTopColor=i.styles.borderRightColor=i.styles.borderBottomColor=i.styles.borderLeftColor=2779096575,i.styles.borderTopWidth=i.styles.borderRightWidth=i.styles.borderBottomWidth=i.styles.borderLeftWidth=1,i.styles.borderTopStyle=i.styles.borderRightStyle=i.styles.borderBottomStyle=i.styles.borderLeftStyle=1,i.styles.backgroundClip=[0],i.styles.backgroundOrigin=[0],i.bounds=Lct(i.bounds)),i.type){case M1:i.styles.borderTopRightRadius=i.styles.borderTopLeftRadius=i.styles.borderBottomRightRadius=i.styles.borderBottomLeftRadius=Ict;break;case U1:i.styles.borderTopRightRadius=i.styles.borderTopLeftRadius=i.styles.borderBottomRightRadius=i.styles.borderBottomLeftRadius=Fct;break}return i}return t}(eu),YM=function(r){ac(t,r);function t(e,n){var i=r.call(this,e,n)||this,s=n.options[n.selectedIndex||0];return i.value=s&&s.text||"",i}return t}(eu),ZM=function(r){ac(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.value=n.value,i}return t}(eu),tU=function(r){ac(t,r);function t(e,n){var i=r.call(this,e,n)||this;i.src=n.src,i.width=parseInt(n.width,10)||0,i.height=parseInt(n.height,10)||0,i.backgroundColor=i.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){i.tree=rU(e,n.contentWindow.document.documentElement);var s=n.contentWindow.document.documentElement?um(e,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):Ku.TRANSPARENT,a=n.contentWindow.document.body?um(e,getComputedStyle(n.contentWindow.document.body).backgroundColor):Ku.TRANSPARENT;i.backgroundColor=th(s)?th(a)?i.styles.backgroundColor:a:s}}catch{}return i}return t}(eu),Uct=["OL","UL","MENU"],R1=function(r,t,e,n){for(var i=t.firstChild,s=void 0;i;i=s)if(s=i.nextSibling,nU(i)&&i.data.trim().length>0)e.textNodes.push(new Cct(r,i,e.styles));else if(Xf(i))if(cU(i)&&i.assignedNodes)i.assignedNodes().forEach(function(o){return R1(r,o,e,n)});else{var a=eU(r,i);a.styles.isVisible()&&(Rct(i,a,n)?a.flags|=4:Oct(a.styles)&&(a.flags|=2),Uct.indexOf(i.tagName)!==-1&&(a.flags|=8),e.elements.push(a),i.slot,i.shadowRoot?R1(r,i.shadowRoot,a,n):!D1(i)&&!iU(i)&&!N1(i)&&R1(r,i,a,n))}},eU=function(r,t){return Yx(t)?new KM(r,t):sU(t)?new $M(r,t):iU(t)?new WM(r,t):Dct(t)?new XM(r,t):Nct(t)?new $x(r,t):kct(t)?new Wx(r,t):N1(t)?new YM(r,t):D1(t)?new ZM(r,t):aU(t)?new tU(r,t):new eu(r,t)},rU=function(r,t){var e=eU(r,t);return e.flags|=4,R1(r,t,e,e),e},Rct=function(r,t,e){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||Jx(r)&&e.styles.isTransparent()},Oct=function(r){return r.isPositioned()||r.isFloating()},nU=function(r){return r.nodeType===Node.TEXT_NODE},Xf=function(r){return r.nodeType===Node.ELEMENT_NODE},Xx=function(r){return Xf(r)&&typeof r.style<"u"&&!O1(r)},O1=function(r){return typeof r.className=="object"},Dct=function(r){return r.tagName==="LI"},Nct=function(r){return r.tagName==="OL"},kct=function(r){return r.tagName==="INPUT"},Qct=function(r){return r.tagName==="HTML"},iU=function(r){return r.tagName==="svg"},Jx=function(r){return r.tagName==="BODY"},sU=function(r){return r.tagName==="CANVAS"},oU=function(r){return r.tagName==="VIDEO"},Yx=function(r){return r.tagName==="IMG"},aU=function(r){return r.tagName==="IFRAME"},lU=function(r){return r.tagName==="STYLE"},zct=function(r){return r.tagName==="SCRIPT"},D1=function(r){return r.tagName==="TEXTAREA"},N1=function(r){return r.tagName==="SELECT"},cU=function(r){return r.tagName==="SLOT"},uU=function(r){return r.tagName.indexOf("-")>0},Hct=function(){function r(){this.counters={}}return r.prototype.getCounterValue=function(t){var e=this.counters[t];return e&&e.length?e[e.length-1]:1},r.prototype.getCounterValues=function(t){var e=this.counters[t];return e||[]},r.prototype.pop=function(t){var e=this;t.forEach(function(n){return e.counters[n].pop()})},r.prototype.parse=function(t){var e=this,n=t.counterIncrement,i=t.counterReset,s=!0;n!==null&&n.forEach(function(o){var d=e.counters[o.counter];d&&o.increment!==0&&(s=!1,d.length||d.push(1),d[Math.max(0,d.length-1)]+=o.increment)});var a=[];return s&&i.forEach(function(o){var d=e.counters[o.counter];a.push(o.counter),d||(d=e.counters[o.counter]=[]),d.push(o.reset)}),a},r}(),AU={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},hU={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Vct={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Gct={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Jf=function(r,t,e,n,i,s){return r<t||r>e?pm(r,i,s.length>0):n.integers.reduce(function(a,o,d){for(;r>=o;)r-=o,a+=n.values[d];return a},"")+s},dU=function(r,t,e,n){var i="";do e||r--,i=n(r)+i,r/=t;while(r*t>=t);return i},Wi=function(r,t,e,n,i){var s=e-t+1;return(r<0?"-":"")+(dU(Math.abs(r),s,n,function(a){return $i(Math.floor(a%s)+t)})+i)},Ad=function(r,t,e){e===void 0&&(e=". ");var n=t.length;return dU(Math.abs(r),n,!1,function(i){return t[Math.floor(i%n)]})+e},Yf=1,rh=2,nh=4,fm=8,$u=function(r,t,e,n,i,s){if(r<-9999||r>9999)return pm(r,4,i.length>0);var a=Math.abs(r),o=i;if(a===0)return t[0]+o;for(var d=0;a>0&&d<=4;d++){var p=a%10;p===0&&_s(s,Yf)&&o!==""?o=t[p]+o:p>1||p===1&&d===0||p===1&&d===1&&_s(s,rh)||p===1&&d===1&&_s(s,nh)&&r>100||p===1&&d>1&&_s(s,fm)?o=t[p]+(d>0?e[d-1]:"")+o:p===1&&d>0&&(o=e[d-1]+o),a=Math.floor(a/10)}return(r<0?n:"")+o},fU="",pU="",gU="",Zx="",pm=function(r,t,e){var n=e?". ":"",i=e?"":"",s=e?", ":"",a=e?" ":"";switch(t){case 0:return""+a;case 1:return""+a;case 2:return""+a;case 5:var o=Wi(r,48,57,!0,n);return o.length<4?"0"+o:o;case 4:return Ad(r,"",i);case 6:return Jf(r,1,3999,AU,3,n).toLowerCase();case 7:return Jf(r,1,3999,AU,3,n);case 8:return Wi(r,945,969,!1,n);case 9:return Wi(r,97,122,!1,n);case 10:return Wi(r,65,90,!1,n);case 11:return Wi(r,1632,1641,!0,n);case 12:case 49:return Jf(r,1,9999,hU,3,n);case 35:return Jf(r,1,9999,hU,3,n).toLowerCase();case 13:return Wi(r,2534,2543,!0,n);case 14:case 30:return Wi(r,6112,6121,!0,n);case 15:return Ad(r,"",i);case 16:return Ad(r,"",i);case 17:case 48:return $u(r,"",fU,"",i,rh|nh|fm);case 47:return $u(r,"",pU,"",i,Yf|rh|nh|fm);case 42:return $u(r,"",fU,"",i,rh|nh|fm);case 41:return $u(r,"",pU,"",i,Yf|rh|nh|fm);case 26:return $u(r,"","",gU,i,0);case 25:return $u(r,"","",gU,i,Yf|rh|nh);case 31:return $u(r,"","",Zx,s,Yf|rh|nh);case 33:return $u(r,"","",Zx,s,0);case 32:return $u(r,"","",Zx,s,Yf|rh|nh);case 18:return Wi(r,2406,2415,!0,n);case 20:return Jf(r,1,19999,Gct,3,n);case 21:return Wi(r,2790,2799,!0,n);case 22:return Wi(r,2662,2671,!0,n);case 22:return Jf(r,1,10999,Vct,3,n);case 23:return Ad(r,"");case 24:return Ad(r,"");case 27:return Wi(r,3302,3311,!0,n);case 28:return Ad(r,"",i);case 29:return Ad(r,"",i);case 34:return Wi(r,3792,3801,!0,n);case 37:return Wi(r,6160,6169,!0,n);case 38:return Wi(r,4160,4169,!0,n);case 39:return Wi(r,2918,2927,!0,n);case 40:return Wi(r,1776,1785,!0,n);case 43:return Wi(r,3046,3055,!0,n);case 44:return Wi(r,3174,3183,!0,n);case 45:return Wi(r,3664,3673,!0,n);case 46:return Wi(r,3872,3881,!0,n);case 3:default:return Wi(r,48,57,!0,n)}},mU="data-html2canvas-ignore",yU=function(){function r(t,e,n){if(this.context=t,this.options=n,this.scrolledElements=[],this.referenceElement=e,this.counters=new Hct,this.quoteDepth=0,!e.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(e.ownerDocument.documentElement,!1)}return r.prototype.toIFrame=function(t,e){var n=this,i=jct(t,e);if(!i.contentWindow)return Promise.reject("Unable to find iframe window");var s=t.defaultView.pageXOffset,a=t.defaultView.pageYOffset,o=i.contentWindow,d=o.document,p=$ct(i).then(function(){return Uo(n,void 0,void 0,function(){var y,b;return go(this,function(x){switch(x.label){case 0:return this.scrolledElements.forEach(Yct),o&&(o.scrollTo(e.left,e.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(o.scrollY!==e.top||o.scrollX!==e.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(o.scrollX-e.left,o.scrollY-e.top,0,0))),y=this.options.onclone,b=this.clonedReferenceElement,typeof b>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:d.fonts&&d.fonts.ready?[4,d.fonts.ready]:[3,2];case 1:x.sent(),x.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,Kct(d)]:[3,4];case 3:x.sent(),x.label=4;case 4:return typeof y=="function"?[2,Promise.resolve().then(function(){return y(d,b)}).then(function(){return i})]:[2,i]}})})});return d.open(),d.write(Xct(document.doctype)+"<html></html>"),Jct(this.referenceElement.ownerDocument,s,a),d.replaceChild(d.adoptNode(this.documentElement),d.documentElement),d.close(),p},r.prototype.createElementClone=function(t){if(Dx(t,2))debugger;if(sU(t))return this.createCanvasClone(t);if(oU(t))return this.createVideoClone(t);if(lU(t))return this.createStyleClone(t);var e=t.cloneNode(!1);return Yx(e)&&(Yx(t)&&t.currentSrc&&t.currentSrc!==t.src&&(e.src=t.currentSrc,e.srcset=""),e.loading==="lazy"&&(e.loading="eager")),uU(e)?this.createCustomElementClone(e):e},r.prototype.createCustomElementClone=function(t){var e=document.createElement("html2canvascustomelement");return tB(t.style,e),e},r.prototype.createStyleClone=function(t){try{var e=t.sheet;if(e&&e.cssRules){var n=[].slice.call(e.cssRules,0).reduce(function(s,a){return a&&typeof a.cssText=="string"?s+a.cssText:s},""),i=t.cloneNode(!1);return i.textContent=n,i}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return t.cloneNode(!1)},r.prototype.createCanvasClone=function(t){var e;if(this.options.inlineImages&&t.ownerDocument){var n=t.ownerDocument.createElement("img");try{return n.src=t.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var i=t.cloneNode(!1);try{i.width=t.width,i.height=t.height;var s=t.getContext("2d"),a=i.getContext("2d");if(a)if(!this.options.allowTaint&&s)a.putImageData(s.getImageData(0,0,t.width,t.height),0,0);else{var o=(e=t.getContext("webgl2"))!==null&&e!==void 0?e:t.getContext("webgl");if(o){var d=o.getContextAttributes();(d==null?void 0:d.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}a.drawImage(t,0,0)}return i}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return i},r.prototype.createVideoClone=function(t){var e=t.ownerDocument.createElement("canvas");e.width=t.offsetWidth,e.height=t.offsetHeight;var n=e.getContext("2d");try{return n&&(n.drawImage(t,0,0,e.width,e.height),this.options.allowTaint||n.getImageData(0,0,e.width,e.height)),e}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var i=t.ownerDocument.createElement("canvas");return i.width=t.offsetWidth,i.height=t.offsetHeight,i},r.prototype.appendChildNode=function(t,e,n){(!Xf(e)||!zct(e)&&!e.hasAttribute(mU)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(e)))&&(!this.options.copyStyles||!Xf(e)||!lU(e))&&t.appendChild(this.cloneNode(e,n))},r.prototype.cloneChildNodes=function(t,e,n){for(var i=this,s=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;s;s=s.nextSibling)if(Xf(s)&&cU(s)&&typeof s.assignedNodes=="function"){var a=s.assignedNodes();a.length&&a.forEach(function(o){return i.appendChildNode(e,o,n)})}else this.appendChildNode(e,s,n)},r.prototype.cloneNode=function(t,e){if(nU(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var n=t.ownerDocument.defaultView;if(n&&Xf(t)&&(Xx(t)||O1(t))){var i=this.createElementClone(t);i.style.transitionProperty="none";var s=n.getComputedStyle(t),a=n.getComputedStyle(t,":before"),o=n.getComputedStyle(t,":after");this.referenceElement===t&&Xx(i)&&(this.clonedReferenceElement=i),Jx(i)&&eut(i);var d=this.counters.parse(new LM(this.context,s)),p=this.resolvePseudoContent(t,i,a,gm.BEFORE);uU(t)&&(e=!0),oU(t)||this.cloneChildNodes(t,i,e),p&&i.insertBefore(p,i.firstChild);var y=this.resolvePseudoContent(t,i,o,gm.AFTER);return y&&i.appendChild(y),this.counters.pop(d),(s&&(this.options.copyStyles||O1(t))&&!aU(t)||e)&&tB(s,i),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([i,t.scrollLeft,t.scrollTop]),(D1(t)||N1(t))&&(D1(i)||N1(i))&&(i.value=t.value),i}return t.cloneNode(!1)},r.prototype.resolvePseudoContent=function(t,e,n,i){var s=this;if(n){var a=n.content,o=e.ownerDocument;if(!(!o||!a||a==="none"||a==="-moz-alt-content"||n.display==="none")){this.counters.parse(new LM(this.context,n));var d=new Dlt(this.context,n),p=o.createElement("html2canvaspseudoelement");tB(n,p),d.content.forEach(function(b){if(b.type===0)p.appendChild(o.createTextNode(b.value));else if(b.type===22){var x=o.createElement("img");x.src=b.value,x.style.opacity="1",p.appendChild(x)}else if(b.type===18){if(b.name==="attr"){var C=b.values.filter(si);C.length&&p.appendChild(o.createTextNode(t.getAttribute(C[0].value)||""))}else if(b.name==="counter"){var P=b.values.filter($f),M=P[0],k=P[1];if(M&&si(M)){var z=s.counters.getCounterValue(M.value),V=k&&si(k)?Ox.parse(s.context,k.value):3;p.appendChild(o.createTextNode(pm(z,V,!1)))}}else if(b.name==="counters"){var $=b.values.filter($f),M=$[0],tt=$[1],k=$[2];if(M&&si(M)){var pt=s.counters.getCounterValues(M.value),gt=k&&si(k)?Ox.parse(s.context,k.value):3,mt=tt&&tt.type===0?tt.value:"",dt=pt.map(function(ot){return pm(ot,gt,!1)}).join(mt);p.appendChild(o.createTextNode(dt))}}}else if(b.type===20)switch(b.value){case"open-quote":p.appendChild(o.createTextNode(FM(d.quotes,s.quoteDepth++,!0)));break;case"close-quote":p.appendChild(o.createTextNode(FM(d.quotes,--s.quoteDepth,!1)));break;default:p.appendChild(o.createTextNode(b.value))}}),p.className=eB+" "+rB;var y=i===gm.BEFORE?" "+eB:" "+rB;return O1(e)?e.className.baseValue+=y:e.className+=y,p}}},r.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},r}(),gm;(function(r){r[r.BEFORE=0]="BEFORE",r[r.AFTER=1]="AFTER"})(gm||(gm={}));var jct=function(r,t){var e=r.createElement("iframe");return e.className="html2canvas-container",e.style.visibility="hidden",e.style.position="fixed",e.style.left="-10000px",e.style.top="0px",e.style.border="0",e.width=t.width.toString(),e.height=t.height.toString(),e.scrolling="no",e.setAttribute(mU,"true"),r.body.appendChild(e),e},qct=function(r){return new Promise(function(t){if(r.complete){t();return}if(!r.src){t();return}r.onload=t,r.onerror=t})},Kct=function(r){return Promise.all([].slice.call(r.images,0).map(qct))},$ct=function(r){return new Promise(function(t,e){var n=r.contentWindow;if(!n)return e("No window assigned for iframe");var i=n.document;n.onload=r.onload=function(){n.onload=r.onload=null;var s=setInterval(function(){i.body.childNodes.length>0&&i.readyState==="complete"&&(clearInterval(s),t(r))},50)}})},Wct=["all","d","content"],tB=function(r,t){for(var e=r.length-1;e>=0;e--){var n=r.item(e);Wct.indexOf(n)===-1&&t.style.setProperty(n,r.getPropertyValue(n))}return t},Xct=function(r){var t="";return r&&(t+="<!DOCTYPE ",r.name&&(t+=r.name),r.internalSubset&&(t+=r.internalSubset),r.publicId&&(t+='"'+r.publicId+'"'),r.systemId&&(t+='"'+r.systemId+'"'),t+=">"),t},Jct=function(r,t,e){r&&r.defaultView&&(t!==r.defaultView.pageXOffset||e!==r.defaultView.pageYOffset)&&r.defaultView.scrollTo(t,e)},Yct=function(r){var t=r[0],e=r[1],n=r[2];t.scrollLeft=e,t.scrollTop=n},Zct=":before",tut=":after",eB="___html2canvas___pseudoelement_before",rB="___html2canvas___pseudoelement_after",_U=`{
    content: "" !important;
    display: none !important;
}`,eut=function(r){rut(r,"."+eB+Zct+_U+`
         .`+rB+tut+_U)},rut=function(r,t){var e=r.ownerDocument;if(e){var n=e.createElement("style");n.textContent=t,r.appendChild(n)}},vU=function(){function r(){}return r.getOrigin=function(t){var e=r._link;return e?(e.href=t,e.href=e.href,e.protocol+e.hostname+e.port):"about:blank"},r.isSameOrigin=function(t){return r.getOrigin(t)===r._origin},r.setContext=function(t){r._link=t.document.createElement("a"),r._origin=r.getOrigin(t.location.href)},r._origin="about:blank",r}(),nut=function(){function r(t,e){this.context=t,this._options=e,this._cache={}}return r.prototype.addImage=function(t){var e=Promise.resolve();return this.has(t)||(iB(t)||aut(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),e},r.prototype.match=function(t){return this._cache[t]},r.prototype.loadImage=function(t){return Uo(this,void 0,void 0,function(){var e,n,i,s,a=this;return go(this,function(o){switch(o.label){case 0:return e=vU.isSameOrigin(t),n=!nB(t)&&this._options.useCORS===!0&&Ks.SUPPORT_CORS_IMAGES&&!e,i=!nB(t)&&!e&&!iB(t)&&typeof this._options.proxy=="string"&&Ks.SUPPORT_CORS_XHR&&!n,!e&&this._options.allowTaint===!1&&!nB(t)&&!iB(t)&&!i&&!n?[2]:(s=t,i?[4,this.proxy(s)]:[3,2]);case 1:s=o.sent(),o.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(d,p){var y=new Image;y.onload=function(){return d(y)},y.onerror=p,(lut(s)||n)&&(y.crossOrigin="anonymous"),y.src=s,y.complete===!0&&setTimeout(function(){return d(y)},500),a._options.imageTimeout>0&&setTimeout(function(){return p("Timed out ("+a._options.imageTimeout+"ms) loading image")},a._options.imageTimeout)})];case 3:return[2,o.sent()]}})})},r.prototype.has=function(t){return typeof this._cache[t]<"u"},r.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},r.prototype.proxy=function(t){var e=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var i=t.substring(0,256);return new Promise(function(s,a){var o=Ks.SUPPORT_RESPONSE_TYPE?"blob":"text",d=new XMLHttpRequest;d.onload=function(){if(d.status===200)if(o==="text")s(d.response);else{var b=new FileReader;b.addEventListener("load",function(){return s(b.result)},!1),b.addEventListener("error",function(x){return a(x)},!1),b.readAsDataURL(d.response)}else a("Failed to proxy resource "+i+" with status code "+d.status)},d.onerror=a;var p=n.indexOf("?")>-1?"&":"?";if(d.open("GET",""+n+p+"url="+encodeURIComponent(t)+"&responseType="+o),o!=="text"&&d instanceof XMLHttpRequest&&(d.responseType=o),e._options.imageTimeout){var y=e._options.imageTimeout;d.timeout=y,d.ontimeout=function(){return a("Timed out ("+y+"ms) proxying "+i)}}d.send()})},r}(),iut=/^data:image\/svg\+xml/i,sut=/^data:image\/.*;base64,/i,out=/^data:image\/.*/i,aut=function(r){return Ks.SUPPORT_SVG_DRAWING||!cut(r)},nB=function(r){return out.test(r)},lut=function(r){return sut.test(r)},iB=function(r){return r.substr(0,4)==="blob"},cut=function(r){return r.substr(-3).toLowerCase()==="svg"||iut.test(r)},ar=function(){function r(t,e){this.type=0,this.x=t,this.y=e}return r.prototype.add=function(t,e){return new r(this.x+t,this.y+e)},r}(),Zf=function(r,t,e){return new ar(r.x+(t.x-r.x)*e,r.y+(t.y-r.y)*e)},k1=function(){function r(t,e,n,i){this.type=1,this.start=t,this.startControl=e,this.endControl=n,this.end=i}return r.prototype.subdivide=function(t,e){var n=Zf(this.start,this.startControl,t),i=Zf(this.startControl,this.endControl,t),s=Zf(this.endControl,this.end,t),a=Zf(n,i,t),o=Zf(i,s,t),d=Zf(a,o,t);return e?new r(this.start,n,a,d):new r(d,o,s,this.end)},r.prototype.add=function(t,e){return new r(this.start.add(t,e),this.startControl.add(t,e),this.endControl.add(t,e),this.end.add(t,e))},r.prototype.reverse=function(){return new r(this.end,this.endControl,this.startControl,this.start)},r}(),pl=function(r){return r.type===1},uut=function(){function r(t){var e=t.styles,n=t.bounds,i=cm(e.borderTopLeftRadius,n.width,n.height),s=i[0],a=i[1],o=cm(e.borderTopRightRadius,n.width,n.height),d=o[0],p=o[1],y=cm(e.borderBottomRightRadius,n.width,n.height),b=y[0],x=y[1],C=cm(e.borderBottomLeftRadius,n.width,n.height),P=C[0],M=C[1],k=[];k.push((s+d)/n.width),k.push((P+b)/n.width),k.push((a+M)/n.height),k.push((p+x)/n.height);var z=Math.max.apply(Math,k);z>1&&(s/=z,a/=z,d/=z,p/=z,b/=z,x/=z,P/=z,M/=z);var V=n.width-d,$=n.height-x,tt=n.width-b,pt=n.height-M,gt=e.borderTopWidth,mt=e.borderRightWidth,dt=e.borderBottomWidth,Ft=e.borderLeftWidth,Tt=yi(e.paddingTop,t.bounds.width),ot=yi(e.paddingRight,t.bounds.width),ct=yi(e.paddingBottom,t.bounds.width),wt=yi(e.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||a>0?Si(n.left+Ft/3,n.top+gt/3,s-Ft/3,a-gt/3,Kn.TOP_LEFT):new ar(n.left+Ft/3,n.top+gt/3),this.topRightBorderDoubleOuterBox=s>0||a>0?Si(n.left+V,n.top+gt/3,d-mt/3,p-gt/3,Kn.TOP_RIGHT):new ar(n.left+n.width-mt/3,n.top+gt/3),this.bottomRightBorderDoubleOuterBox=b>0||x>0?Si(n.left+tt,n.top+$,b-mt/3,x-dt/3,Kn.BOTTOM_RIGHT):new ar(n.left+n.width-mt/3,n.top+n.height-dt/3),this.bottomLeftBorderDoubleOuterBox=P>0||M>0?Si(n.left+Ft/3,n.top+pt,P-Ft/3,M-dt/3,Kn.BOTTOM_LEFT):new ar(n.left+Ft/3,n.top+n.height-dt/3),this.topLeftBorderDoubleInnerBox=s>0||a>0?Si(n.left+Ft*2/3,n.top+gt*2/3,s-Ft*2/3,a-gt*2/3,Kn.TOP_LEFT):new ar(n.left+Ft*2/3,n.top+gt*2/3),this.topRightBorderDoubleInnerBox=s>0||a>0?Si(n.left+V,n.top+gt*2/3,d-mt*2/3,p-gt*2/3,Kn.TOP_RIGHT):new ar(n.left+n.width-mt*2/3,n.top+gt*2/3),this.bottomRightBorderDoubleInnerBox=b>0||x>0?Si(n.left+tt,n.top+$,b-mt*2/3,x-dt*2/3,Kn.BOTTOM_RIGHT):new ar(n.left+n.width-mt*2/3,n.top+n.height-dt*2/3),this.bottomLeftBorderDoubleInnerBox=P>0||M>0?Si(n.left+Ft*2/3,n.top+pt,P-Ft*2/3,M-dt*2/3,Kn.BOTTOM_LEFT):new ar(n.left+Ft*2/3,n.top+n.height-dt*2/3),this.topLeftBorderStroke=s>0||a>0?Si(n.left+Ft/2,n.top+gt/2,s-Ft/2,a-gt/2,Kn.TOP_LEFT):new ar(n.left+Ft/2,n.top+gt/2),this.topRightBorderStroke=s>0||a>0?Si(n.left+V,n.top+gt/2,d-mt/2,p-gt/2,Kn.TOP_RIGHT):new ar(n.left+n.width-mt/2,n.top+gt/2),this.bottomRightBorderStroke=b>0||x>0?Si(n.left+tt,n.top+$,b-mt/2,x-dt/2,Kn.BOTTOM_RIGHT):new ar(n.left+n.width-mt/2,n.top+n.height-dt/2),this.bottomLeftBorderStroke=P>0||M>0?Si(n.left+Ft/2,n.top+pt,P-Ft/2,M-dt/2,Kn.BOTTOM_LEFT):new ar(n.left+Ft/2,n.top+n.height-dt/2),this.topLeftBorderBox=s>0||a>0?Si(n.left,n.top,s,a,Kn.TOP_LEFT):new ar(n.left,n.top),this.topRightBorderBox=d>0||p>0?Si(n.left+V,n.top,d,p,Kn.TOP_RIGHT):new ar(n.left+n.width,n.top),this.bottomRightBorderBox=b>0||x>0?Si(n.left+tt,n.top+$,b,x,Kn.BOTTOM_RIGHT):new ar(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=P>0||M>0?Si(n.left,n.top+pt,P,M,Kn.BOTTOM_LEFT):new ar(n.left,n.top+n.height),this.topLeftPaddingBox=s>0||a>0?Si(n.left+Ft,n.top+gt,Math.max(0,s-Ft),Math.max(0,a-gt),Kn.TOP_LEFT):new ar(n.left+Ft,n.top+gt),this.topRightPaddingBox=d>0||p>0?Si(n.left+Math.min(V,n.width-mt),n.top+gt,V>n.width+mt?0:Math.max(0,d-mt),Math.max(0,p-gt),Kn.TOP_RIGHT):new ar(n.left+n.width-mt,n.top+gt),this.bottomRightPaddingBox=b>0||x>0?Si(n.left+Math.min(tt,n.width-Ft),n.top+Math.min($,n.height-dt),Math.max(0,b-mt),Math.max(0,x-dt),Kn.BOTTOM_RIGHT):new ar(n.left+n.width-mt,n.top+n.height-dt),this.bottomLeftPaddingBox=P>0||M>0?Si(n.left+Ft,n.top+Math.min(pt,n.height-dt),Math.max(0,P-Ft),Math.max(0,M-dt),Kn.BOTTOM_LEFT):new ar(n.left+Ft,n.top+n.height-dt),this.topLeftContentBox=s>0||a>0?Si(n.left+Ft+wt,n.top+gt+Tt,Math.max(0,s-(Ft+wt)),Math.max(0,a-(gt+Tt)),Kn.TOP_LEFT):new ar(n.left+Ft+wt,n.top+gt+Tt),this.topRightContentBox=d>0||p>0?Si(n.left+Math.min(V,n.width+Ft+wt),n.top+gt+Tt,V>n.width+Ft+wt?0:d-Ft+wt,p-(gt+Tt),Kn.TOP_RIGHT):new ar(n.left+n.width-(mt+ot),n.top+gt+Tt),this.bottomRightContentBox=b>0||x>0?Si(n.left+Math.min(tt,n.width-(Ft+wt)),n.top+Math.min($,n.height+gt+Tt),Math.max(0,b-(mt+ot)),x-(dt+ct),Kn.BOTTOM_RIGHT):new ar(n.left+n.width-(mt+ot),n.top+n.height-(dt+ct)),this.bottomLeftContentBox=P>0||M>0?Si(n.left+Ft+wt,n.top+pt,Math.max(0,P-(Ft+wt)),M-(dt+ct),Kn.BOTTOM_LEFT):new ar(n.left+Ft+wt,n.top+n.height-(dt+ct))}return r}(),Kn;(function(r){r[r.TOP_LEFT=0]="TOP_LEFT",r[r.TOP_RIGHT=1]="TOP_RIGHT",r[r.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",r[r.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Kn||(Kn={}));var Si=function(r,t,e,n,i){var s=4*((Math.sqrt(2)-1)/3),a=e*s,o=n*s,d=r+e,p=t+n;switch(i){case Kn.TOP_LEFT:return new k1(new ar(r,p),new ar(r,p-o),new ar(d-a,t),new ar(d,t));case Kn.TOP_RIGHT:return new k1(new ar(r,t),new ar(r+a,t),new ar(d,p-o),new ar(d,p));case Kn.BOTTOM_RIGHT:return new k1(new ar(d,t),new ar(d,t+o),new ar(r+a,p),new ar(r,p));case Kn.BOTTOM_LEFT:default:return new k1(new ar(d,p),new ar(d-a,p),new ar(r,t+o),new ar(r,t))}},Q1=function(r){return[r.topLeftBorderBox,r.topRightBorderBox,r.bottomRightBorderBox,r.bottomLeftBorderBox]},Aut=function(r){return[r.topLeftContentBox,r.topRightContentBox,r.bottomRightContentBox,r.bottomLeftContentBox]},z1=function(r){return[r.topLeftPaddingBox,r.topRightPaddingBox,r.bottomRightPaddingBox,r.bottomLeftPaddingBox]},hut=function(){function r(t,e,n){this.offsetX=t,this.offsetY=e,this.matrix=n,this.type=0,this.target=6}return r}(),H1=function(){function r(t,e){this.path=t,this.target=e,this.type=1}return r}(),dut=function(){function r(t){this.opacity=t,this.type=2,this.target=6}return r}(),fut=function(r){return r.type===0},bU=function(r){return r.type===1},put=function(r){return r.type===2},wU=function(r,t){return r.length===t.length?r.some(function(e,n){return e===t[n]}):!1},gut=function(r,t,e,n,i){return r.map(function(s,a){switch(a){case 0:return s.add(t,e);case 1:return s.add(t+n,e);case 2:return s.add(t+n,e+i);case 3:return s.add(t,e+i)}return s})},xU=function(){function r(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return r}(),BU=function(){function r(t,e){if(this.container=t,this.parent=e,this.effects=[],this.curves=new uut(this.container),this.container.styles.opacity<1&&this.effects.push(new dut(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,i=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new hut(n,i,s))}if(this.container.styles.overflowX!==0){var a=Q1(this.curves),o=z1(this.curves);wU(a,o)?this.effects.push(new H1(a,6)):(this.effects.push(new H1(a,2)),this.effects.push(new H1(o,4)))}}return r.prototype.getEffects=function(t){for(var e=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,i=this.effects.slice(0);n;){var s=n.effects.filter(function(d){return!bU(d)});if(e||n.container.styles.position!==0||!n.parent){if(i.unshift.apply(i,s),e=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var a=Q1(n.curves),o=z1(n.curves);wU(a,o)||i.unshift(new H1(o,6))}}else i.unshift.apply(i,s);n=n.parent}return i.filter(function(d){return _s(d.target,t)})},r}(),sB=function(r,t,e,n){r.container.elements.forEach(function(i){var s=_s(i.flags,4),a=_s(i.flags,2),o=new BU(i,r);_s(i.styles.display,2048)&&n.push(o);var d=_s(i.flags,8)?[]:n;if(s||a){var p=s||i.styles.isPositioned()?e:t,y=new xU(o);if(i.styles.isPositioned()||i.styles.opacity<1||i.styles.isTransformed()){var b=i.styles.zIndex.order;if(b<0){var x=0;p.negativeZIndex.some(function(P,M){return b>P.element.container.styles.zIndex.order?(x=M,!1):x>0}),p.negativeZIndex.splice(x,0,y)}else if(b>0){var C=0;p.positiveZIndex.some(function(P,M){return b>=P.element.container.styles.zIndex.order?(C=M+1,!1):C>0}),p.positiveZIndex.splice(C,0,y)}else p.zeroOrAutoZIndexOrTransformedOrOpacity.push(y)}else i.styles.isFloating()?p.nonPositionedFloats.push(y):p.nonPositionedInlineLevel.push(y);sB(o,y,s?y:e,d)}else i.styles.isInlineLevel()?t.inlineLevel.push(o):t.nonInlineLevel.push(o),sB(o,t,e,d);_s(i.flags,8)&&CU(i,d)})},CU=function(r,t){for(var e=r instanceof $x?r.start:1,n=r instanceof $x?r.reversed:!1,i=0;i<t.length;i++){var s=t[i];s.container instanceof XM&&typeof s.container.value=="number"&&s.container.value!==0&&(e=s.container.value),s.listValue=pm(e,s.container.styles.listStyleType,!0),e+=n?-1:1}},mut=function(r){var t=new BU(r,null),e=new xU(t),n=[];return sB(t,e,e,n),CU(t.container,n),e},EU=function(r,t){switch(t){case 0:return gl(r.topLeftBorderBox,r.topLeftPaddingBox,r.topRightBorderBox,r.topRightPaddingBox);case 1:return gl(r.topRightBorderBox,r.topRightPaddingBox,r.bottomRightBorderBox,r.bottomRightPaddingBox);case 2:return gl(r.bottomRightBorderBox,r.bottomRightPaddingBox,r.bottomLeftBorderBox,r.bottomLeftPaddingBox);case 3:default:return gl(r.bottomLeftBorderBox,r.bottomLeftPaddingBox,r.topLeftBorderBox,r.topLeftPaddingBox)}},yut=function(r,t){switch(t){case 0:return gl(r.topLeftBorderBox,r.topLeftBorderDoubleOuterBox,r.topRightBorderBox,r.topRightBorderDoubleOuterBox);case 1:return gl(r.topRightBorderBox,r.topRightBorderDoubleOuterBox,r.bottomRightBorderBox,r.bottomRightBorderDoubleOuterBox);case 2:return gl(r.bottomRightBorderBox,r.bottomRightBorderDoubleOuterBox,r.bottomLeftBorderBox,r.bottomLeftBorderDoubleOuterBox);case 3:default:return gl(r.bottomLeftBorderBox,r.bottomLeftBorderDoubleOuterBox,r.topLeftBorderBox,r.topLeftBorderDoubleOuterBox)}},_ut=function(r,t){switch(t){case 0:return gl(r.topLeftBorderDoubleInnerBox,r.topLeftPaddingBox,r.topRightBorderDoubleInnerBox,r.topRightPaddingBox);case 1:return gl(r.topRightBorderDoubleInnerBox,r.topRightPaddingBox,r.bottomRightBorderDoubleInnerBox,r.bottomRightPaddingBox);case 2:return gl(r.bottomRightBorderDoubleInnerBox,r.bottomRightPaddingBox,r.bottomLeftBorderDoubleInnerBox,r.bottomLeftPaddingBox);case 3:default:return gl(r.bottomLeftBorderDoubleInnerBox,r.bottomLeftPaddingBox,r.topLeftBorderDoubleInnerBox,r.topLeftPaddingBox)}},vut=function(r,t){switch(t){case 0:return V1(r.topLeftBorderStroke,r.topRightBorderStroke);case 1:return V1(r.topRightBorderStroke,r.bottomRightBorderStroke);case 2:return V1(r.bottomRightBorderStroke,r.bottomLeftBorderStroke);case 3:default:return V1(r.bottomLeftBorderStroke,r.topLeftBorderStroke)}},V1=function(r,t){var e=[];return pl(r)?e.push(r.subdivide(.5,!1)):e.push(r),pl(t)?e.push(t.subdivide(.5,!0)):e.push(t),e},gl=function(r,t,e,n){var i=[];return pl(r)?i.push(r.subdivide(.5,!1)):i.push(r),pl(e)?i.push(e.subdivide(.5,!0)):i.push(e),pl(n)?i.push(n.subdivide(.5,!0).reverse()):i.push(n),pl(t)?i.push(t.subdivide(.5,!1).reverse()):i.push(t),i},SU=function(r){var t=r.bounds,e=r.styles;return t.add(e.borderLeftWidth,e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth),-(e.borderTopWidth+e.borderBottomWidth))},G1=function(r){var t=r.styles,e=r.bounds,n=yi(t.paddingLeft,e.width),i=yi(t.paddingRight,e.width),s=yi(t.paddingTop,e.width),a=yi(t.paddingBottom,e.width);return e.add(n+t.borderLeftWidth,s+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+n+i),-(t.borderTopWidth+t.borderBottomWidth+s+a))},but=function(r,t){return r===0?t.bounds:r===2?G1(t):SU(t)},wut=function(r,t){return r===0?t.bounds:r===2?G1(t):SU(t)},oB=function(r,t,e){var n=but(ep(r.styles.backgroundOrigin,t),r),i=wut(ep(r.styles.backgroundClip,t),r),s=xut(ep(r.styles.backgroundSize,t),e,n),a=s[0],o=s[1],d=cm(ep(r.styles.backgroundPosition,t),n.width-a,n.height-o),p=But(ep(r.styles.backgroundRepeat,t),d,s,n,i),y=Math.round(n.left+d[0]),b=Math.round(n.top+d[1]);return[p,y,b,a,o]},tp=function(r){return si(r)&&r.value===Wf.AUTO},j1=function(r){return typeof r=="number"},xut=function(r,t,e){var n=t[0],i=t[1],s=t[2],a=r[0],o=r[1];if(!a)return[0,0];if(ls(a)&&o&&ls(o))return[yi(a,e.width),yi(o,e.height)];var d=j1(s);if(si(a)&&(a.value===Wf.CONTAIN||a.value===Wf.COVER)){if(j1(s)){var p=e.width/e.height;return p<s!=(a.value===Wf.COVER)?[e.width,e.width/s]:[e.height*s,e.height]}return[e.width,e.height]}var y=j1(n),b=j1(i),x=y||b;if(tp(a)&&(!o||tp(o))){if(y&&b)return[n,i];if(!d&&!x)return[e.width,e.height];if(x&&d){var C=y?n:i*s,P=b?i:n/s;return[C,P]}var M=y?n:e.width,k=b?i:e.height;return[M,k]}if(d){var z=0,V=0;return ls(a)?z=yi(a,e.width):ls(o)&&(V=yi(o,e.height)),tp(a)?z=V*s:(!o||tp(o))&&(V=z/s),[z,V]}var $=null,tt=null;if(ls(a)?$=yi(a,e.width):o&&ls(o)&&(tt=yi(o,e.height)),$!==null&&(!o||tp(o))&&(tt=y&&b?$/n*i:e.height),tt!==null&&tp(a)&&($=y&&b?tt/i*n:e.width),$!==null&&tt!==null)return[$,tt];throw new Error("Unable to calculate background-size for element")},ep=function(r,t){var e=r[t];return typeof e>"u"?r[0]:e},But=function(r,t,e,n,i){var s=t[0],a=t[1],o=e[0],d=e[1];switch(r){case 2:return[new ar(Math.round(n.left),Math.round(n.top+a)),new ar(Math.round(n.left+n.width),Math.round(n.top+a)),new ar(Math.round(n.left+n.width),Math.round(d+n.top+a)),new ar(Math.round(n.left),Math.round(d+n.top+a))];case 3:return[new ar(Math.round(n.left+s),Math.round(n.top)),new ar(Math.round(n.left+s+o),Math.round(n.top)),new ar(Math.round(n.left+s+o),Math.round(n.height+n.top)),new ar(Math.round(n.left+s),Math.round(n.height+n.top))];case 1:return[new ar(Math.round(n.left+s),Math.round(n.top+a)),new ar(Math.round(n.left+s+o),Math.round(n.top+a)),new ar(Math.round(n.left+s+o),Math.round(n.top+a+d)),new ar(Math.round(n.left+s),Math.round(n.top+a+d))];default:return[new ar(Math.round(i.left),Math.round(i.top)),new ar(Math.round(i.left+i.width),Math.round(i.top)),new ar(Math.round(i.left+i.width),Math.round(i.height+i.top)),new ar(Math.round(i.left),Math.round(i.height+i.top))]}},Cut="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",TU="Hidden Text",Eut=function(){function r(t){this._data={},this._document=t}return r.prototype.parseMetrics=function(t,e){var n=this._document.createElement("div"),i=this._document.createElement("img"),s=this._document.createElement("span"),a=this._document.body;n.style.visibility="hidden",n.style.fontFamily=t,n.style.fontSize=e,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",a.appendChild(n),i.src=Cut,i.width=1,i.height=1,i.style.margin="0",i.style.padding="0",i.style.verticalAlign="baseline",s.style.fontFamily=t,s.style.fontSize=e,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(TU)),n.appendChild(s),n.appendChild(i);var o=i.offsetTop-s.offsetTop+2;n.removeChild(s),n.appendChild(this._document.createTextNode(TU)),n.style.lineHeight="normal",i.style.verticalAlign="super";var d=i.offsetTop-n.offsetTop+2;return a.removeChild(n),{baseline:o,middle:d}},r.prototype.getMetrics=function(t,e){var n=t+" "+e;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(t,e)),this._data[n]},r}(),IU=function(){function r(t,e){this.context=t,this.options=e}return r}(),Sut=1e4,Tut=function(r){ac(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i._activeEffects=[],i.canvas=n.canvas?n.canvas:document.createElement("canvas"),i.ctx=i.canvas.getContext("2d"),n.canvas||(i.canvas.width=Math.floor(n.width*n.scale),i.canvas.height=Math.floor(n.height*n.scale),i.canvas.style.width=n.width+"px",i.canvas.style.height=n.height+"px"),i.fontMetrics=new Eut(document),i.ctx.scale(i.options.scale,i.options.scale),i.ctx.translate(-n.x,-n.y),i.ctx.textBaseline="bottom",i._activeEffects=[],i.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),i}return t.prototype.applyEffects=function(e){for(var n=this;this._activeEffects.length;)this.popEffect();e.forEach(function(i){return n.applyEffect(i)})},t.prototype.applyEffect=function(e){this.ctx.save(),put(e)&&(this.ctx.globalAlpha=e.opacity),fut(e)&&(this.ctx.translate(e.offsetX,e.offsetY),this.ctx.transform(e.matrix[0],e.matrix[1],e.matrix[2],e.matrix[3],e.matrix[4],e.matrix[5]),this.ctx.translate(-e.offsetX,-e.offsetY)),bU(e)&&(this.path(e.path),this.ctx.clip()),this._activeEffects.push(e)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(e){return Uo(this,void 0,void 0,function(){var n;return go(this,function(i){switch(i.label){case 0:return n=e.element.container.styles,n.isVisible()?[4,this.renderStackContent(e)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(e){return Uo(this,void 0,void 0,function(){return go(this,function(n){switch(n.label){case 0:if(_s(e.container.flags,16))debugger;return e.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(e)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(e)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(e,n,i){var s=this;if(n===0)this.ctx.fillText(e.text,e.bounds.left,e.bounds.top+i);else{var a=Kx(e.text);a.reduce(function(o,d){return s.ctx.fillText(d,o,e.bounds.top+i),o+s.ctx.measureText(d).width},e.bounds.left)}},t.prototype.createFontStyle=function(e){var n=e.fontVariant.filter(function(a){return a==="normal"||a==="small-caps"}).join(""),i=Mut(e.fontFamily).join(", "),s=lm(e.fontSize)?""+e.fontSize.number+e.fontSize.unit:e.fontSize.number+"px";return[[e.fontStyle,n,e.fontWeight,s,i].join(" "),i,s]},t.prototype.renderTextNode=function(e,n){return Uo(this,void 0,void 0,function(){var i,s,a,o,d,p,y,b,x=this;return go(this,function(C){return i=this.createFontStyle(n),s=i[0],a=i[1],o=i[2],this.ctx.font=s,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",d=this.fontMetrics.getMetrics(a,o),p=d.baseline,y=d.middle,b=n.paintOrder,e.textBounds.forEach(function(P){b.forEach(function(M){switch(M){case 0:x.ctx.fillStyle=Ds(n.color),x.renderTextWithLetterSpacing(P,n.letterSpacing,p);var k=n.textShadow;k.length&&P.text.trim().length&&(k.slice(0).reverse().forEach(function(z){x.ctx.shadowColor=Ds(z.color),x.ctx.shadowOffsetX=z.offsetX.number*x.options.scale,x.ctx.shadowOffsetY=z.offsetY.number*x.options.scale,x.ctx.shadowBlur=z.blur.number,x.renderTextWithLetterSpacing(P,n.letterSpacing,p)}),x.ctx.shadowColor="",x.ctx.shadowOffsetX=0,x.ctx.shadowOffsetY=0,x.ctx.shadowBlur=0),n.textDecorationLine.length&&(x.ctx.fillStyle=Ds(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(z){switch(z){case 1:x.ctx.fillRect(P.bounds.left,Math.round(P.bounds.top+p),P.bounds.width,1);break;case 2:x.ctx.fillRect(P.bounds.left,Math.round(P.bounds.top),P.bounds.width,1);break;case 3:x.ctx.fillRect(P.bounds.left,Math.ceil(P.bounds.top+y),P.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&P.text.trim().length&&(x.ctx.strokeStyle=Ds(n.webkitTextStrokeColor),x.ctx.lineWidth=n.webkitTextStrokeWidth,x.ctx.lineJoin=window.chrome?"miter":"round",x.ctx.strokeText(P.text,P.bounds.left,P.bounds.top+p)),x.ctx.strokeStyle="",x.ctx.lineWidth=0,x.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(e,n,i){if(i&&e.intrinsicWidth>0&&e.intrinsicHeight>0){var s=G1(e),a=z1(n);this.path(a),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(i,0,0,e.intrinsicWidth,e.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(e){return Uo(this,void 0,void 0,function(){var n,i,s,a,o,d,V,V,p,y,b,x,tt,C,P,pt,M,k,z,V,$,tt,pt;return go(this,function(gt){switch(gt.label){case 0:this.applyEffects(e.getEffects(4)),n=e.container,i=e.curves,s=n.styles,a=0,o=n.textNodes,gt.label=1;case 1:return a<o.length?(d=o[a],[4,this.renderTextNode(d,s)]):[3,4];case 2:gt.sent(),gt.label=3;case 3:return a++,[3,1];case 4:if(!(n instanceof KM))return[3,8];gt.label=5;case 5:return gt.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return V=gt.sent(),this.renderReplacedElement(n,i,V),[3,8];case 7:return gt.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof $M&&this.renderReplacedElement(n,i,n.canvas),!(n instanceof WM))return[3,12];gt.label=9;case 9:return gt.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return V=gt.sent(),this.renderReplacedElement(n,i,V),[3,12];case 11:return gt.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof tU&&n.tree?(p=new t(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,p.render(n.tree)]):[3,14];case 13:y=gt.sent(),n.width&&n.height&&this.ctx.drawImage(y,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),gt.label=14;case 14:if(n instanceof Wx&&(b=Math.min(n.bounds.width,n.bounds.height),n.type===M1?n.checked&&(this.ctx.save(),this.path([new ar(n.bounds.left+b*.39363,n.bounds.top+b*.79),new ar(n.bounds.left+b*.16,n.bounds.top+b*.5549),new ar(n.bounds.left+b*.27347,n.bounds.top+b*.44071),new ar(n.bounds.left+b*.39694,n.bounds.top+b*.5649),new ar(n.bounds.left+b*.72983,n.bounds.top+b*.23),new ar(n.bounds.left+b*.84,n.bounds.top+b*.34085),new ar(n.bounds.left+b*.39363,n.bounds.top+b*.79)]),this.ctx.fillStyle=Ds(JM),this.ctx.fill(),this.ctx.restore()):n.type===U1&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+b/2,n.bounds.top+b/2,b/4,0,Math.PI*2,!0),this.ctx.fillStyle=Ds(JM),this.ctx.fill(),this.ctx.restore())),Iut(n)&&n.value.length){switch(x=this.createFontStyle(s),tt=x[0],C=x[1],P=this.fontMetrics.getMetrics(tt,C).baseline,this.ctx.font=tt,this.ctx.fillStyle=Ds(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=Lut(n.styles.textAlign),pt=G1(n),M=0,n.styles.textAlign){case 1:M+=pt.width/2;break;case 2:M+=pt.width;break}k=pt.add(M,0,0,-pt.height/2+1),this.ctx.save(),this.path([new ar(pt.left,pt.top),new ar(pt.left+pt.width,pt.top),new ar(pt.left+pt.width,pt.top+pt.height),new ar(pt.left,pt.top+pt.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new dm(n.value,k),s.letterSpacing,P),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!_s(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(z=n.styles.listStyleImage,z.type!==0)return[3,18];V=void 0,$=z.url,gt.label=15;case 15:return gt.trys.push([15,17,,18]),[4,this.context.cache.match($)];case 16:return V=gt.sent(),this.ctx.drawImage(V,n.bounds.left-(V.width+10),n.bounds.top),[3,18];case 17:return gt.sent(),this.context.logger.error("Error loading list-style-image "+$),[3,18];case 18:return[3,20];case 19:e.listValue&&n.styles.listStyleType!==-1&&(tt=this.createFontStyle(s)[0],this.ctx.font=tt,this.ctx.fillStyle=Ds(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",pt=new ju(n.bounds.left,n.bounds.top+yi(n.styles.paddingTop,n.bounds.width),n.bounds.width,SM(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new dm(e.listValue,pt),s.letterSpacing,SM(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),gt.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(e){return Uo(this,void 0,void 0,function(){var n,i,z,s,a,z,o,d,z,p,y,z,b,x,z,C,P,z,M,k,z;return go(this,function(V){switch(V.label){case 0:if(_s(e.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(e.element)];case 1:V.sent(),n=0,i=e.negativeZIndex,V.label=2;case 2:return n<i.length?(z=i[n],[4,this.renderStack(z)]):[3,5];case 3:V.sent(),V.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(e.element)];case 6:V.sent(),s=0,a=e.nonInlineLevel,V.label=7;case 7:return s<a.length?(z=a[s],[4,this.renderNode(z)]):[3,10];case 8:V.sent(),V.label=9;case 9:return s++,[3,7];case 10:o=0,d=e.nonPositionedFloats,V.label=11;case 11:return o<d.length?(z=d[o],[4,this.renderStack(z)]):[3,14];case 12:V.sent(),V.label=13;case 13:return o++,[3,11];case 14:p=0,y=e.nonPositionedInlineLevel,V.label=15;case 15:return p<y.length?(z=y[p],[4,this.renderStack(z)]):[3,18];case 16:V.sent(),V.label=17;case 17:return p++,[3,15];case 18:b=0,x=e.inlineLevel,V.label=19;case 19:return b<x.length?(z=x[b],[4,this.renderNode(z)]):[3,22];case 20:V.sent(),V.label=21;case 21:return b++,[3,19];case 22:C=0,P=e.zeroOrAutoZIndexOrTransformedOrOpacity,V.label=23;case 23:return C<P.length?(z=P[C],[4,this.renderStack(z)]):[3,26];case 24:V.sent(),V.label=25;case 25:return C++,[3,23];case 26:M=0,k=e.positiveZIndex,V.label=27;case 27:return M<k.length?(z=k[M],[4,this.renderStack(z)]):[3,30];case 28:V.sent(),V.label=29;case 29:return M++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(e){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(e.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(e){this.ctx.beginPath(),this.formatPath(e),this.ctx.closePath()},t.prototype.formatPath=function(e){var n=this;e.forEach(function(i,s){var a=pl(i)?i.start:i;s===0?n.ctx.moveTo(a.x,a.y):n.ctx.lineTo(a.x,a.y),pl(i)&&n.ctx.bezierCurveTo(i.startControl.x,i.startControl.y,i.endControl.x,i.endControl.y,i.end.x,i.end.y)})},t.prototype.renderRepeat=function(e,n,i,s){this.path(e),this.ctx.fillStyle=n,this.ctx.translate(i,s),this.ctx.fill(),this.ctx.translate(-i,-s)},t.prototype.resizeImage=function(e,n,i){var s;if(e.width===n&&e.height===i)return e;var a=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,o=a.createElement("canvas");o.width=Math.max(1,n),o.height=Math.max(1,i);var d=o.getContext("2d");return d.drawImage(e,0,0,e.width,e.height,0,0,n,i),o},t.prototype.renderBackgroundImage=function(e){return Uo(this,void 0,void 0,function(){var n,i,s,a,o,d;return go(this,function(p){switch(p.label){case 0:n=e.styles.backgroundImage.length-1,i=function(y){var b,x,C,Tt,Wt,Yt,wt,vt,dt,P,Tt,Wt,Yt,wt,vt,M,k,z,V,$,tt,pt,gt,mt,dt,Ft,Tt,ot,ct,wt,vt,$t,Wt,Yt,Kt,ee,Zt,we,it,xt,It,Ut;return go(this,function(jt){switch(jt.label){case 0:if(y.type!==0)return[3,5];b=void 0,x=y.url,jt.label=1;case 1:return jt.trys.push([1,3,,4]),[4,s.context.cache.match(x)];case 2:return b=jt.sent(),[3,4];case 3:return jt.sent(),s.context.logger.error("Error loading background-image "+x),[3,4];case 4:return b&&(C=oB(e,n,[b.width,b.height,b.width/b.height]),Tt=C[0],Wt=C[1],Yt=C[2],wt=C[3],vt=C[4],dt=s.ctx.createPattern(s.resizeImage(b,wt,vt),"repeat"),s.renderRepeat(Tt,dt,Wt,Yt)),[3,6];case 5:fat(y)?(P=oB(e,n,[null,null,null]),Tt=P[0],Wt=P[1],Yt=P[2],wt=P[3],vt=P[4],M=cat(y.angle,wt,vt),k=M[0],z=M[1],V=M[2],$=M[3],tt=M[4],pt=document.createElement("canvas"),pt.width=wt,pt.height=vt,gt=pt.getContext("2d"),mt=gt.createLinearGradient(z,$,V,tt),gM(y.stops,k).forEach(function(Vt){return mt.addColorStop(Vt.stop,Ds(Vt.color))}),gt.fillStyle=mt,gt.fillRect(0,0,wt,vt),wt>0&&vt>0&&(dt=s.ctx.createPattern(pt,"repeat"),s.renderRepeat(Tt,dt,Wt,Yt))):pat(y)&&(Ft=oB(e,n,[null,null,null]),Tt=Ft[0],ot=Ft[1],ct=Ft[2],wt=Ft[3],vt=Ft[4],$t=y.position.length===0?[Mx]:y.position,Wt=yi($t[0],wt),Yt=yi($t[$t.length-1],vt),Kt=uat(y,Wt,Yt,wt,vt),ee=Kt[0],Zt=Kt[1],ee>0&&Zt>0&&(we=s.ctx.createRadialGradient(ot+Wt,ct+Yt,0,ot+Wt,ct+Yt,ee),gM(y.stops,ee*2).forEach(function(Vt){return we.addColorStop(Vt.stop,Ds(Vt.color))}),s.path(Tt),s.ctx.fillStyle=we,ee!==Zt?(it=e.bounds.left+.5*e.bounds.width,xt=e.bounds.top+.5*e.bounds.height,It=Zt/ee,Ut=1/It,s.ctx.save(),s.ctx.translate(it,xt),s.ctx.transform(1,0,0,It,0,0),s.ctx.translate(-it,-xt),s.ctx.fillRect(ot,Ut*(ct-xt)+xt,wt,vt*Ut),s.ctx.restore()):s.ctx.fill())),jt.label=6;case 6:return n--,[2]}})},s=this,a=0,o=e.styles.backgroundImage.slice(0).reverse(),p.label=1;case 1:return a<o.length?(d=o[a],[5,i(d)]):[3,4];case 2:p.sent(),p.label=3;case 3:return a++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(e,n,i){return Uo(this,void 0,void 0,function(){return go(this,function(s){return this.path(EU(i,n)),this.ctx.fillStyle=Ds(e),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(e,n,i,s){return Uo(this,void 0,void 0,function(){var a,o;return go(this,function(d){switch(d.label){case 0:return n<3?[4,this.renderSolidBorder(e,i,s)]:[3,2];case 1:return d.sent(),[2];case 2:return a=yut(s,i),this.path(a),this.ctx.fillStyle=Ds(e),this.ctx.fill(),o=_ut(s,i),this.path(o),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(e){return Uo(this,void 0,void 0,function(){var n,i,s,a,o,d,p,y,b=this;return go(this,function(x){switch(x.label){case 0:return this.applyEffects(e.getEffects(2)),n=e.container.styles,i=!th(n.backgroundColor)||n.backgroundImage.length,s=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],a=Fut(ep(n.backgroundClip,0),e.curves),i||n.boxShadow.length?(this.ctx.save(),this.path(a),this.ctx.clip(),th(n.backgroundColor)||(this.ctx.fillStyle=Ds(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(e.container)]):[3,2];case 1:x.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(C){b.ctx.save();var P=Q1(e.curves),M=C.inset?0:Sut,k=gut(P,-M+(C.inset?1:-1)*C.spread.number,(C.inset?1:-1)*C.spread.number,C.spread.number*(C.inset?-2:2),C.spread.number*(C.inset?-2:2));C.inset?(b.path(P),b.ctx.clip(),b.mask(k)):(b.mask(P),b.ctx.clip(),b.path(k)),b.ctx.shadowOffsetX=C.offsetX.number+M,b.ctx.shadowOffsetY=C.offsetY.number,b.ctx.shadowColor=Ds(C.color),b.ctx.shadowBlur=C.blur.number,b.ctx.fillStyle=C.inset?Ds(C.color):"rgba(0,0,0,1)",b.ctx.fill(),b.ctx.restore()}),x.label=2;case 2:o=0,d=0,p=s,x.label=3;case 3:return d<p.length?(y=p[d],y.style!==0&&!th(y.color)&&y.width>0?y.style!==2?[3,5]:[4,this.renderDashedDottedBorder(y.color,y.width,o,e.curves,2)]:[3,11]):[3,13];case 4:return x.sent(),[3,11];case 5:return y.style!==3?[3,7]:[4,this.renderDashedDottedBorder(y.color,y.width,o,e.curves,3)];case 6:return x.sent(),[3,11];case 7:return y.style!==4?[3,9]:[4,this.renderDoubleBorder(y.color,y.width,o,e.curves)];case 8:return x.sent(),[3,11];case 9:return[4,this.renderSolidBorder(y.color,o,e.curves)];case 10:x.sent(),x.label=11;case 11:o++,x.label=12;case 12:return d++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(e,n,i,s,a){return Uo(this,void 0,void 0,function(){var o,d,p,y,b,x,C,P,M,k,z,V,$,tt,pt,gt,pt,gt;return go(this,function(mt){return this.ctx.save(),o=vut(s,i),d=EU(s,i),a===2&&(this.path(d),this.ctx.clip()),pl(d[0])?(p=d[0].start.x,y=d[0].start.y):(p=d[0].x,y=d[0].y),pl(d[1])?(b=d[1].end.x,x=d[1].end.y):(b=d[1].x,x=d[1].y),i===0||i===2?C=Math.abs(p-b):C=Math.abs(y-x),this.ctx.beginPath(),a===3?this.formatPath(o):this.formatPath(d.slice(0,2)),P=n<3?n*3:n*2,M=n<3?n*2:n,a===3&&(P=n,M=n),k=!0,C<=P*2?k=!1:C<=P*2+M?(z=C/(2*P+M),P*=z,M*=z):(V=Math.floor((C+M)/(P+M)),$=(C-V*P)/(V-1),tt=(C-(V+1)*P)/V,M=tt<=0||Math.abs(M-$)<Math.abs(M-tt)?$:tt),k&&(a===3?this.ctx.setLineDash([0,P+M]):this.ctx.setLineDash([P,M])),a===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=Ds(e),this.ctx.stroke(),this.ctx.setLineDash([]),a===2&&(pl(d[0])&&(pt=d[3],gt=d[0],this.ctx.beginPath(),this.formatPath([new ar(pt.end.x,pt.end.y),new ar(gt.start.x,gt.start.y)]),this.ctx.stroke()),pl(d[1])&&(pt=d[1],gt=d[2],this.ctx.beginPath(),this.formatPath([new ar(pt.end.x,pt.end.y),new ar(gt.start.x,gt.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(e){return Uo(this,void 0,void 0,function(){var n;return go(this,function(i){switch(i.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Ds(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=mut(e),[4,this.renderStack(n)];case 1:return i.sent(),this.applyEffects([]),[2,this.canvas]}})})},t}(IU),Iut=function(r){return r instanceof ZM||r instanceof YM?!0:r instanceof Wx&&r.type!==U1&&r.type!==M1},Fut=function(r,t){switch(r){case 0:return Q1(t);case 2:return Aut(t);case 1:default:return z1(t)}},Lut=function(r){switch(r){case 1:return"center";case 2:return"right";case 0:default:return"left"}},Put=["-apple-system","system-ui"],Mut=function(r){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?r.filter(function(t){return Put.indexOf(t)===-1}):r},Uut=function(r){ac(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.canvas=n.canvas?n.canvas:document.createElement("canvas"),i.ctx=i.canvas.getContext("2d"),i.options=n,i.canvas.width=Math.floor(n.width*n.scale),i.canvas.height=Math.floor(n.height*n.scale),i.canvas.style.width=n.width+"px",i.canvas.style.height=n.height+"px",i.ctx.scale(i.options.scale,i.options.scale),i.ctx.translate(-n.x,-n.y),i.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),i}return t.prototype.render=function(e){return Uo(this,void 0,void 0,function(){var n,i;return go(this,function(s){switch(s.label){case 0:return n=qx(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,e),[4,Rut(n)];case 1:return i=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Ds(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(i,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t}(IU),Rut=function(r){return new Promise(function(t,e){var n=new Image;n.onload=function(){t(n)},n.onerror=e,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(r))})},Out=function(){function r(t){var e=t.id,n=t.enabled;this.id=e,this.enabled=n,this.start=Date.now()}return r.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Zy([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},r.prototype.getTime=function(){return Date.now()-this.start},r.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Zy([this.id,this.getTime()+"ms"],t))},r.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Zy([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},r.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Zy([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},r.instances={},r}(),Dut=function(){function r(t,e){var n;this.windowBounds=e,this.instanceName="#"+r.instanceCount++,this.logger=new Out({id:this.instanceName,enabled:t.logging}),this.cache=(n=t.cache)!==null&&n!==void 0?n:new nut(this,t)}return r.instanceCount=1,r}(),Nut=function(r,t){return t===void 0&&(t={}),kut(r,t)};typeof window<"u"&&vU.setContext(window);var kut=function(r,t){return Uo(void 0,void 0,void 0,function(){var e,n,i,s,a,o,d,p,y,b,x,C,P,M,k,z,V,$,tt,pt,mt,gt,mt,dt,Ft,Tt,ot,ct,wt,vt,$t,Wt,Yt,Kt,ee,Zt,we,it,xt,It;return go(this,function(Ut){switch(Ut.label){case 0:if(!r||typeof r!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(e=r.ownerDocument,!e)throw new Error("Element is not attached to a Document");if(n=e.defaultView,!n)throw new Error("Document is not attached to a Window");return i={allowTaint:(dt=t.allowTaint)!==null&&dt!==void 0?dt:!1,imageTimeout:(Ft=t.imageTimeout)!==null&&Ft!==void 0?Ft:15e3,proxy:t.proxy,useCORS:(Tt=t.useCORS)!==null&&Tt!==void 0?Tt:!1},s=hx({logging:(ot=t.logging)!==null&&ot!==void 0?ot:!0,cache:t.cache},i),a={windowWidth:(ct=t.windowWidth)!==null&&ct!==void 0?ct:n.innerWidth,windowHeight:(wt=t.windowHeight)!==null&&wt!==void 0?wt:n.innerHeight,scrollX:(vt=t.scrollX)!==null&&vt!==void 0?vt:n.pageXOffset,scrollY:($t=t.scrollY)!==null&&$t!==void 0?$t:n.pageYOffset},o=new ju(a.scrollX,a.scrollY,a.windowWidth,a.windowHeight),d=new Dut(s,o),p=(Wt=t.foreignObjectRendering)!==null&&Wt!==void 0?Wt:!1,y={allowTaint:(Yt=t.allowTaint)!==null&&Yt!==void 0?Yt:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:p,copyStyles:p},d.logger.debug("Starting document clone with size "+o.width+"x"+o.height+" scrolled to "+-o.left+","+-o.top),b=new yU(d,r,y),x=b.clonedReferenceElement,x?[4,b.toIFrame(e,o)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return C=Ut.sent(),P=Jx(x)||Qct(x)?gst(x.ownerDocument):t1(d,x),M=P.width,k=P.height,z=P.left,V=P.top,$=Qut(d,x,t.backgroundColor),tt={canvas:t.canvas,backgroundColor:$,scale:(ee=(Kt=t.scale)!==null&&Kt!==void 0?Kt:n.devicePixelRatio)!==null&&ee!==void 0?ee:1,x:((Zt=t.x)!==null&&Zt!==void 0?Zt:0)+z,y:((we=t.y)!==null&&we!==void 0?we:0)+V,width:(it=t.width)!==null&&it!==void 0?it:Math.ceil(M),height:(xt=t.height)!==null&&xt!==void 0?xt:Math.ceil(k)},p?(d.logger.debug("Document cloned, using foreign object rendering"),mt=new Uut(d,tt),[4,mt.render(x)]):[3,3];case 2:return pt=Ut.sent(),[3,5];case 3:return d.logger.debug("Document cloned, element located at "+z+","+V+" with size "+M+"x"+k+" using computed rendering"),d.logger.debug("Starting DOM parsing"),gt=rU(d,x),$===gt.styles.backgroundColor&&(gt.styles.backgroundColor=Ku.TRANSPARENT),d.logger.debug("Starting renderer for element at "+tt.x+","+tt.y+" with size "+tt.width+"x"+tt.height),mt=new Tut(d,tt),[4,mt.render(gt)];case 4:pt=Ut.sent(),Ut.label=5;case 5:return(!((It=t.removeContainer)!==null&&It!==void 0)||It)&&(yU.destroy(C)||d.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),d.logger.debug("Finished rendering"),[2,pt]}})})},Qut=function(r,t,e){var n=t.ownerDocument,i=n.documentElement?um(r,getComputedStyle(n.documentElement).backgroundColor):Ku.TRANSPARENT,s=n.body?um(r,getComputedStyle(n.body).backgroundColor):Ku.TRANSPARENT,a=typeof e=="string"?um(r,e):e===null?Ku.TRANSPARENT:4294967295;return t===n.documentElement?th(i)?th(s)?a:s:i:a};const zut=Object.freeze(Object.defineProperty({__proto__:null,default:Nut},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.5.3 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.3/LICENSE */function ih(r){"@babel/helpers - typeof";return ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ih(r)}function aB(r,t){return aB=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},aB(r,t)}function Hut(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function q1(r,t,e){return Hut()?q1=Reflect.construct:q1=function(n,i,s){var a=[null];a.push.apply(a,i);var o=Function.bind.apply(n,a),d=new o;return s&&aB(d,s.prototype),d},q1.apply(null,arguments)}function cc(r){return Vut(r)||Gut(r)||jut(r)||qut()}function Vut(r){if(Array.isArray(r))return lB(r)}function Gut(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function jut(r,t){if(r){if(typeof r=="string")return lB(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return lB(r,t)}}function lB(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function qut(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Kut=Object.hasOwnProperty,FU=Object.setPrototypeOf,$ut=Object.isFrozen,Wut=Object.getPrototypeOf,Xut=Object.getOwnPropertyDescriptor,Do=Object.freeze,ml=Object.seal,Jut=Object.create,LU=typeof Reflect<"u"&&Reflect,K1=LU.apply,cB=LU.construct;K1||(K1=function(r,t,e){return r.apply(t,e)}),Do||(Do=function(r){return r}),ml||(ml=function(r){return r}),cB||(cB=function(r,t){return q1(r,cc(t))});var Yut=Ra(Array.prototype.forEach),PU=Ra(Array.prototype.pop),mm=Ra(Array.prototype.push),$1=Ra(String.prototype.toLowerCase),uB=Ra(String.prototype.toString),MU=Ra(String.prototype.match),uc=Ra(String.prototype.replace),Zut=Ra(String.prototype.indexOf),tAt=Ra(String.prototype.trim),$s=Ra(RegExp.prototype.test),AB=eAt(TypeError),UU=Ra(Number.isNaN);function Ra(r){return function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return K1(r,t,n)}}function eAt(r){return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return cB(r,e)}}function un(r,t,e){var n;e=(n=e)!==null&&n!==void 0?n:$1,FU&&FU(r,null);for(var i=t.length;i--;){var s=t[i];if(typeof s=="string"){var a=e(s);a!==s&&($ut(t)||(t[i]=a),s=a)}r[s]=!0}return r}function hd(r){var t=Jut(null),e;for(e in r)K1(Kut,r,[e])===!0&&(t[e]=r[e]);return t}function W1(r,t){for(;r!==null;){var e=Xut(r,t);if(e){if(e.get)return Ra(e.get);if(typeof e.value=="function")return Ra(e.value)}r=Wut(r)}function n(i){return console.warn("fallback value for",i),null}return n}var RU=Do(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),hB=Do(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),dB=Do(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),rAt=Do(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),fB=Do(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),nAt=Do(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),OU=Do(["#text"]),DU=Do(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),pB=Do(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),NU=Do(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),X1=Do(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),iAt=ml(/\{\{[\w\W]*|[\w\W]*\}\}/gm),sAt=ml(/<%[\w\W]*|[\w\W]*%>/gm),oAt=ml(/\${[\w\W]*}/gm),aAt=ml(/^data-[\-\w.\u00B7-\uFFFF]/),lAt=ml(/^aria-[\-\w]+$/),cAt=ml(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),uAt=ml(/^(?:\w+script|data):/i),AAt=ml(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),hAt=ml(/^html$/i),dAt=ml(/^[a-z][.\w]*(-[.\w]+)+$/i),fAt=function(){return typeof window>"u"?null:window},pAt=function(r,t){if(ih(r)!=="object"||typeof r.createPolicy!="function")return null;var e=null,n="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(n)&&(e=t.currentScript.getAttribute(n));var i="dompurify"+(e?"#"+e:"");try{return r.createPolicy(i,{createHTML:function(s){return s},createScriptURL:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function kU(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:fAt(),t=function(Mt){return kU(Mt)};if(t.version="2.5.3",t.removed=[],!r||!r.document||r.document.nodeType!==9)return t.isSupported=!1,t;var e=r.document,n=r.document,i=r.DocumentFragment,s=r.HTMLTemplateElement,a=r.Node,o=r.Element,d=r.NodeFilter,p=r.NamedNodeMap,y=p===void 0?r.NamedNodeMap||r.MozNamedAttrMap:p,b=r.HTMLFormElement,x=r.DOMParser,C=r.trustedTypes,P=o.prototype,M=W1(P,"cloneNode"),k=W1(P,"nextSibling"),z=W1(P,"childNodes"),V=W1(P,"parentNode");if(typeof s=="function"){var $=n.createElement("template");$.content&&$.content.ownerDocument&&(n=$.content.ownerDocument)}var tt=pAt(C,e),pt=tt?tt.createHTML(""):"",gt=n,mt=gt.implementation,dt=gt.createNodeIterator,Ft=gt.createDocumentFragment,Tt=gt.getElementsByTagName,ot=e.importNode,ct={};try{ct=hd(n).documentMode?n.documentMode:{}}catch{}var wt={};t.isSupported=typeof V=="function"&&mt&&mt.createHTMLDocument!==void 0&&ct!==9;var vt=iAt,$t=sAt,Wt=oAt,Yt=aAt,Kt=lAt,ee=uAt,Zt=AAt,we=dAt,it=cAt,xt=null,It=un({},[].concat(cc(RU),cc(hB),cc(dB),cc(fB),cc(OU))),Ut=null,jt=un({},[].concat(cc(DU),cc(pB),cc(NU),cc(X1))),Vt=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),re=null,te=null,Ce=!0,Te=!0,De=!1,Qe=!0,Je=!1,he=!0,st=!1,fr=!1,er=!1,de=!1,ve=!1,Le=!1,Ue=!0,Ye=!1,lr="user-content-",yr=!0,Lr=!1,Dr={},pe=null,cr=un({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),_r=null,Re=un({},["audio","video","img","source","image","track"]),An=null,me=un({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),gr="http://www.w3.org/1998/Math/MathML",Ne="http://www.w3.org/2000/svg",Ur="http://www.w3.org/1999/xhtml",_n=Ur,ke=!1,Qn=null,nn=un({},[gr,Ne,Ur],uB),vn,ln=["application/xhtml+xml","text/html"],Ct="text/html",W,X=null,ft=255,Bt=n.createElement("form"),kt=function(Mt){return Mt instanceof RegExp||Mt instanceof Function},Gt=function(Mt){X&&X===Mt||((!Mt||ih(Mt)!=="object")&&(Mt={}),Mt=hd(Mt),vn=ln.indexOf(Mt.PARSER_MEDIA_TYPE)===-1?vn=Ct:vn=Mt.PARSER_MEDIA_TYPE,W=vn==="application/xhtml+xml"?uB:$1,xt="ALLOWED_TAGS"in Mt?un({},Mt.ALLOWED_TAGS,W):It,Ut="ALLOWED_ATTR"in Mt?un({},Mt.ALLOWED_ATTR,W):jt,Qn="ALLOWED_NAMESPACES"in Mt?un({},Mt.ALLOWED_NAMESPACES,uB):nn,An="ADD_URI_SAFE_ATTR"in Mt?un(hd(me),Mt.ADD_URI_SAFE_ATTR,W):me,_r="ADD_DATA_URI_TAGS"in Mt?un(hd(Re),Mt.ADD_DATA_URI_TAGS,W):Re,pe="FORBID_CONTENTS"in Mt?un({},Mt.FORBID_CONTENTS,W):cr,re="FORBID_TAGS"in Mt?un({},Mt.FORBID_TAGS,W):{},te="FORBID_ATTR"in Mt?un({},Mt.FORBID_ATTR,W):{},Dr="USE_PROFILES"in Mt?Mt.USE_PROFILES:!1,Ce=Mt.ALLOW_ARIA_ATTR!==!1,Te=Mt.ALLOW_DATA_ATTR!==!1,De=Mt.ALLOW_UNKNOWN_PROTOCOLS||!1,Qe=Mt.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Je=Mt.SAFE_FOR_TEMPLATES||!1,he=Mt.SAFE_FOR_XML!==!1,st=Mt.WHOLE_DOCUMENT||!1,de=Mt.RETURN_DOM||!1,ve=Mt.RETURN_DOM_FRAGMENT||!1,Le=Mt.RETURN_TRUSTED_TYPE||!1,er=Mt.FORCE_BODY||!1,Ue=Mt.SANITIZE_DOM!==!1,Ye=Mt.SANITIZE_NAMED_PROPS||!1,yr=Mt.KEEP_CONTENT!==!1,Lr=Mt.IN_PLACE||!1,it=Mt.ALLOWED_URI_REGEXP||it,_n=Mt.NAMESPACE||Ur,Vt=Mt.CUSTOM_ELEMENT_HANDLING||{},Mt.CUSTOM_ELEMENT_HANDLING&&kt(Mt.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Vt.tagNameCheck=Mt.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Mt.CUSTOM_ELEMENT_HANDLING&&kt(Mt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Vt.attributeNameCheck=Mt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Mt.CUSTOM_ELEMENT_HANDLING&&typeof Mt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Vt.allowCustomizedBuiltInElements=Mt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Je&&(Te=!1),ve&&(de=!0),Dr&&(xt=un({},cc(OU)),Ut=[],Dr.html===!0&&(un(xt,RU),un(Ut,DU)),Dr.svg===!0&&(un(xt,hB),un(Ut,pB),un(Ut,X1)),Dr.svgFilters===!0&&(un(xt,dB),un(Ut,pB),un(Ut,X1)),Dr.mathMl===!0&&(un(xt,fB),un(Ut,NU),un(Ut,X1))),Mt.ADD_TAGS&&(xt===It&&(xt=hd(xt)),un(xt,Mt.ADD_TAGS,W)),Mt.ADD_ATTR&&(Ut===jt&&(Ut=hd(Ut)),un(Ut,Mt.ADD_ATTR,W)),Mt.ADD_URI_SAFE_ATTR&&un(An,Mt.ADD_URI_SAFE_ATTR,W),Mt.FORBID_CONTENTS&&(pe===cr&&(pe=hd(pe)),un(pe,Mt.FORBID_CONTENTS,W)),yr&&(xt["#text"]=!0),st&&un(xt,["html","head","body"]),xt.table&&(un(xt,["tbody"]),delete re.tbody),Do&&Do(Mt),X=Mt)},Ot=un({},["mi","mo","mn","ms","mtext"]),Pt=un({},["foreignobject","annotation-xml"]),ae=un({},["title","style","font","a","script"]),fe=un({},hB);un(fe,dB),un(fe,rAt);var Jt=un({},fB);un(Jt,nAt);var xe=function(Mt){var Oe=V(Mt);(!Oe||!Oe.tagName)&&(Oe={namespaceURI:_n,tagName:"template"});var Ee=$1(Mt.tagName),or=$1(Oe.tagName);return Qn[Mt.namespaceURI]?Mt.namespaceURI===Ne?Oe.namespaceURI===Ur?Ee==="svg":Oe.namespaceURI===gr?Ee==="svg"&&(or==="annotation-xml"||Ot[or]):!!fe[Ee]:Mt.namespaceURI===gr?Oe.namespaceURI===Ur?Ee==="math":Oe.namespaceURI===Ne?Ee==="math"&&Pt[or]:!!Jt[Ee]:Mt.namespaceURI===Ur?Oe.namespaceURI===Ne&&!Pt[or]||Oe.namespaceURI===gr&&!Ot[or]?!1:!Jt[Ee]&&(ae[Ee]||!fe[Ee]):!!(vn==="application/xhtml+xml"&&Qn[Mt.namespaceURI]):!1},Ge=function(Mt){mm(t.removed,{element:Mt});try{Mt.parentNode.removeChild(Mt)}catch{try{Mt.outerHTML=pt}catch{Mt.remove()}}},nr=function(Mt,Oe){try{mm(t.removed,{attribute:Oe.getAttributeNode(Mt),from:Oe})}catch{mm(t.removed,{attribute:null,from:Oe})}if(Oe.removeAttribute(Mt),Mt==="is"&&!Ut[Mt])if(de||ve)try{Ge(Oe)}catch{}else try{Oe.setAttribute(Mt,"")}catch{}},Br=function(Mt){var Oe,Ee;if(er)Mt="<remove></remove>"+Mt;else{var or=MU(Mt,/^[\r\n\t ]+/);Ee=or&&or[0]}vn==="application/xhtml+xml"&&_n===Ur&&(Mt='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Mt+"</body></html>");var Pr=tt?tt.createHTML(Mt):Mt;if(_n===Ur)try{Oe=new x().parseFromString(Pr,vn)}catch{}if(!Oe||!Oe.documentElement){Oe=mt.createDocument(_n,"template",null);try{Oe.documentElement.innerHTML=ke?pt:Pr}catch{}}var Mn=Oe.body||Oe.documentElement;return Mt&&Ee&&Mn.insertBefore(n.createTextNode(Ee),Mn.childNodes[0]||null),_n===Ur?Tt.call(Oe,st?"html":"body")[0]:st?Oe.documentElement:Mn},Tr=function(Mt){return dt.call(Mt.ownerDocument||Mt,Mt,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null,!1)},pr=function(Mt){return Mt instanceof b&&(typeof Mt.__depth<"u"&&typeof Mt.__depth!="number"||typeof Mt.__removalCount<"u"&&typeof Mt.__removalCount!="number"||typeof Mt.nodeName!="string"||typeof Mt.textContent!="string"||typeof Mt.removeChild!="function"||!(Mt.attributes instanceof y)||typeof Mt.removeAttribute!="function"||typeof Mt.setAttribute!="function"||typeof Mt.namespaceURI!="string"||typeof Mt.insertBefore!="function"||typeof Mt.hasChildNodes!="function")},Qr=function(Mt){return ih(a)==="object"?Mt instanceof a:Mt&&ih(Mt)==="object"&&typeof Mt.nodeType=="number"&&typeof Mt.nodeName=="string"},Gr=function(Mt,Oe,Ee){wt[Mt]&&Yut(wt[Mt],function(or){or.call(t,Oe,Ee,X)})},cn=function(Mt){var Oe;if(Gr("beforeSanitizeElements",Mt,null),pr(Mt)||$s(/[\u0080-\uFFFF]/,Mt.nodeName))return Ge(Mt),!0;var Ee=W(Mt.nodeName);if(Gr("uponSanitizeElement",Mt,{tagName:Ee,allowedTags:xt}),Mt.hasChildNodes()&&!Qr(Mt.firstElementChild)&&(!Qr(Mt.content)||!Qr(Mt.content.firstElementChild))&&$s(/<[/\w]/g,Mt.innerHTML)&&$s(/<[/\w]/g,Mt.textContent)||Ee==="select"&&$s(/<template/i,Mt.innerHTML)||Mt.nodeType===7||he&&Mt.nodeType===8&&$s(/<[/\w]/g,Mt.data))return Ge(Mt),!0;if(!xt[Ee]||re[Ee]){if(!re[Ee]&&jr(Ee)&&(Vt.tagNameCheck instanceof RegExp&&$s(Vt.tagNameCheck,Ee)||Vt.tagNameCheck instanceof Function&&Vt.tagNameCheck(Ee)))return!1;if(yr&&!pe[Ee]){var or=V(Mt)||Mt.parentNode,Pr=z(Mt)||Mt.childNodes;if(Pr&&or)for(var Mn=Pr.length,qr=Mn-1;qr>=0;--qr){var gn=M(Pr[qr],!0);gn.__removalCount=(Mt.__removalCount||0)+1,or.insertBefore(gn,k(Mt))}}return Ge(Mt),!0}return Mt instanceof o&&!xe(Mt)||(Ee==="noscript"||Ee==="noembed"||Ee==="noframes")&&$s(/<\/no(script|embed|frames)/i,Mt.innerHTML)?(Ge(Mt),!0):(Je&&Mt.nodeType===3&&(Oe=Mt.textContent,Oe=uc(Oe,vt," "),Oe=uc(Oe,$t," "),Oe=uc(Oe,Wt," "),Mt.textContent!==Oe&&(mm(t.removed,{element:Mt.cloneNode()}),Mt.textContent=Oe)),Gr("afterSanitizeElements",Mt,null),!1)},br=function(Mt,Oe,Ee){if(Ue&&(Oe==="id"||Oe==="name")&&(Ee in n||Ee in Bt||Ee==="__depth"||Ee==="__removalCount"))return!1;if(!(Te&&!te[Oe]&&$s(Yt,Oe))&&!(Ce&&$s(Kt,Oe))){if(!Ut[Oe]||te[Oe]){if(!(jr(Mt)&&(Vt.tagNameCheck instanceof RegExp&&$s(Vt.tagNameCheck,Mt)||Vt.tagNameCheck instanceof Function&&Vt.tagNameCheck(Mt))&&(Vt.attributeNameCheck instanceof RegExp&&$s(Vt.attributeNameCheck,Oe)||Vt.attributeNameCheck instanceof Function&&Vt.attributeNameCheck(Oe))||Oe==="is"&&Vt.allowCustomizedBuiltInElements&&(Vt.tagNameCheck instanceof RegExp&&$s(Vt.tagNameCheck,Ee)||Vt.tagNameCheck instanceof Function&&Vt.tagNameCheck(Ee))))return!1}else if(!An[Oe]&&!$s(it,uc(Ee,Zt,""))&&!((Oe==="src"||Oe==="xlink:href"||Oe==="href")&&Mt!=="script"&&Zut(Ee,"data:")===0&&_r[Mt])&&!(De&&!$s(ee,uc(Ee,Zt,"")))&&Ee)return!1}return!0},jr=function(Mt){return Mt!=="annotation-xml"&&MU(Mt,we)},sn=function(Mt){var Oe,Ee,or,Pr;Gr("beforeSanitizeAttributes",Mt,null);var Mn=Mt.attributes;if(Mn){var qr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ut};for(Pr=Mn.length;Pr--;){Oe=Mn[Pr];var gn=Oe,vi=gn.name,mn=gn.namespaceURI;if(Ee=vi==="value"?Oe.value:tAt(Oe.value),or=W(vi),qr.attrName=or,qr.attrValue=Ee,qr.keepAttr=!0,qr.forceKeepAttr=void 0,Gr("uponSanitizeAttribute",Mt,qr),Ee=qr.attrValue,!qr.forceKeepAttr&&(nr(vi,Mt),!!qr.keepAttr)){if(!Qe&&$s(/\/>/i,Ee)){nr(vi,Mt);continue}if(he&&$s(/((--!?|])>)|<\/(style|title)/i,Ee)){nr(vi,Mt);continue}Je&&(Ee=uc(Ee,vt," "),Ee=uc(Ee,$t," "),Ee=uc(Ee,Wt," "));var Wr=W(Mt.nodeName);if(br(Wr,or,Ee)){if(Ye&&(or==="id"||or==="name")&&(nr(vi,Mt),Ee=lr+Ee),tt&&ih(C)==="object"&&typeof C.getAttributeType=="function"&&!mn)switch(C.getAttributeType(Wr,or)){case"TrustedHTML":{Ee=tt.createHTML(Ee);break}case"TrustedScriptURL":{Ee=tt.createScriptURL(Ee);break}}try{mn?Mt.setAttributeNS(mn,vi,Ee):Mt.setAttribute(vi,Ee),pr(Mt)?Ge(Mt):PU(t.removed)}catch{}}}}Gr("afterSanitizeAttributes",Mt,null)}},Sn=function Mt(Oe){var Ee,or=Tr(Oe);for(Gr("beforeSanitizeShadowDOM",Oe,null);Ee=or.nextNode();)if(Gr("uponSanitizeShadowNode",Ee,null),!cn(Ee)){var Pr=V(Ee);Ee.nodeType===1&&(Pr&&Pr.__depth?Ee.__depth=(Ee.__removalCount||0)+Pr.__depth+1:Ee.__depth=1),(Ee.__depth>=ft||UU(Ee.__depth))&&Ge(Ee),Ee.content instanceof i&&(Ee.content.__depth=Ee.__depth,Mt(Ee.content)),sn(Ee)}Gr("afterSanitizeShadowDOM",Oe,null)};return t.sanitize=function(Mt){var Oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ee,or,Pr,Mn,qr;if(ke=!Mt,ke&&(Mt="<!-->"),typeof Mt!="string"&&!Qr(Mt))if(typeof Mt.toString=="function"){if(Mt=Mt.toString(),typeof Mt!="string")throw AB("dirty is not a string, aborting")}else throw AB("toString is not a function");if(!t.isSupported){if(ih(r.toStaticHTML)==="object"||typeof r.toStaticHTML=="function"){if(typeof Mt=="string")return r.toStaticHTML(Mt);if(Qr(Mt))return r.toStaticHTML(Mt.outerHTML)}return Mt}if(fr||Gt(Oe),t.removed=[],typeof Mt=="string"&&(Lr=!1),Lr){if(Mt.nodeName){var gn=W(Mt.nodeName);if(!xt[gn]||re[gn])throw AB("root node is forbidden and cannot be sanitized in-place")}}else if(Mt instanceof a)Ee=Br("<!---->"),or=Ee.ownerDocument.importNode(Mt,!0),or.nodeType===1&&or.nodeName==="BODY"||or.nodeName==="HTML"?Ee=or:Ee.appendChild(or);else{if(!de&&!Je&&!st&&Mt.indexOf("<")===-1)return tt&&Le?tt.createHTML(Mt):Mt;if(Ee=Br(Mt),!Ee)return de?null:Le?pt:""}Ee&&er&&Ge(Ee.firstChild);for(var vi=Tr(Lr?Mt:Ee);Pr=vi.nextNode();)if(!(Pr.nodeType===3&&Pr===Mn)&&!cn(Pr)){var mn=V(Pr);Pr.nodeType===1&&(mn&&mn.__depth?Pr.__depth=(Pr.__removalCount||0)+mn.__depth+1:Pr.__depth=1),(Pr.__depth>=ft||UU(Pr.__depth))&&Ge(Pr),Pr.content instanceof i&&(Pr.content.__depth=Pr.__depth,Sn(Pr.content)),sn(Pr),Mn=Pr}if(Mn=null,Lr)return Mt;if(de){if(ve)for(qr=Ft.call(Ee.ownerDocument);Ee.firstChild;)qr.appendChild(Ee.firstChild);else qr=Ee;return(Ut.shadowroot||Ut.shadowrootmod)&&(qr=ot.call(e,qr,!0)),qr}var Wr=st?Ee.outerHTML:Ee.innerHTML;return st&&xt["!doctype"]&&Ee.ownerDocument&&Ee.ownerDocument.doctype&&Ee.ownerDocument.doctype.name&&$s(hAt,Ee.ownerDocument.doctype.name)&&(Wr="<!DOCTYPE "+Ee.ownerDocument.doctype.name+`>
`+Wr),Je&&(Wr=uc(Wr,vt," "),Wr=uc(Wr,$t," "),Wr=uc(Wr,Wt," ")),tt&&Le?tt.createHTML(Wr):Wr},t.setConfig=function(Mt){Gt(Mt),fr=!0},t.clearConfig=function(){X=null,fr=!1},t.isValidAttribute=function(Mt,Oe,Ee){X||Gt({});var or=W(Mt),Pr=W(Oe);return br(or,Pr,Ee)},t.addHook=function(Mt,Oe){typeof Oe=="function"&&(wt[Mt]=wt[Mt]||[],mm(wt[Mt],Oe))},t.removeHook=function(Mt){if(wt[Mt])return PU(wt[Mt])},t.removeHooks=function(Mt){wt[Mt]&&(wt[Mt]=[])},t.removeAllHooks=function(){wt={}},t}var gAt=kU();const mAt=Object.freeze(Object.defineProperty({__proto__:null,default:gAt},Symbol.toStringTag,{value:"Module"}));var rp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function QU(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ym=function(r){return r&&r.Math===Math&&r},Xi=ym(typeof globalThis=="object"&&globalThis)||ym(typeof window=="object"&&window)||ym(typeof self=="object"&&self)||ym(typeof rp=="object"&&rp)||ym(typeof rp=="object"&&rp)||function(){return this}()||Function("return this")(),_m={},Ji=function(r){try{return!!r()}catch{return!0}},yAt=Ji,Ac=!yAt(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),_At=Ji,J1=!_At(function(){var r=(function(){}).bind();return typeof r!="function"||r.hasOwnProperty("prototype")}),vAt=J1,Y1=Function.prototype.call,Ws=vAt?Y1.bind(Y1):function(){return Y1.apply(Y1,arguments)},zU={},HU={}.propertyIsEnumerable,VU=Object.getOwnPropertyDescriptor,bAt=VU&&!HU.call({1:2},1);zU.f=bAt?function(r){var t=VU(this,r);return!!t&&t.enumerable}:HU;var gB=function(r,t){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:t}},GU=J1,jU=Function.prototype,mB=jU.call,wAt=GU&&jU.bind.bind(mB,mB),Yi=GU?wAt:function(r){return function(){return mB.apply(r,arguments)}},qU=Yi,xAt=qU({}.toString),BAt=qU("".slice),dd=function(r){return BAt(xAt(r),8,-1)},CAt=Yi,EAt=Ji,SAt=dd,yB=Object,TAt=CAt("".split),KU=EAt(function(){return!yB("z").propertyIsEnumerable(0)})?function(r){return SAt(r)==="String"?TAt(r,""):yB(r)}:yB,fd=function(r){return r==null},IAt=fd,FAt=TypeError,hc=function(r){if(IAt(r))throw new FAt("Can't call method on "+r);return r},LAt=KU,PAt=hc,vm=function(r){return LAt(PAt(r))},_B=typeof document=="object"&&document.all,Zi=typeof _B>"u"&&_B!==void 0?function(r){return typeof r=="function"||r===_B}:function(r){return typeof r=="function"},MAt=Zi,dc=function(r){return typeof r=="object"?r!==null:MAt(r)},vB=Xi,UAt=Zi,RAt=function(r){return UAt(r)?r:void 0},pd=function(r,t){return arguments.length<2?RAt(vB[r]):vB[r]&&vB[r][t]},OAt=Yi,Z1=OAt({}.isPrototypeOf),t_=typeof navigator<"u"&&String(navigator.userAgent)||"",$U=Xi,bB=t_,WU=$U.process,XU=$U.Deno,JU=WU&&WU.versions||XU&&XU.version,YU=JU&&JU.v8,fc,e_;YU&&(fc=YU.split("."),e_=fc[0]>0&&fc[0]<4?1:+(fc[0]+fc[1])),!e_&&bB&&(fc=bB.match(/Edge\/(\d+)/),(!fc||fc[1]>=74)&&(fc=bB.match(/Chrome\/(\d+)/),fc&&(e_=+fc[1])));var wB=e_,ZU=wB,DAt=Ji,NAt=Xi,kAt=NAt.String,tR=!!Object.getOwnPropertySymbols&&!DAt(function(){var r=Symbol("symbol detection");return!kAt(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&ZU&&ZU<41}),QAt=tR,eR=QAt&&!Symbol.sham&&typeof Symbol.iterator=="symbol",zAt=pd,HAt=Zi,VAt=Z1,GAt=eR,jAt=Object,rR=GAt?function(r){return typeof r=="symbol"}:function(r){var t=zAt("Symbol");return HAt(t)&&VAt(t.prototype,jAt(r))},qAt=String,r_=function(r){try{return qAt(r)}catch{return"Object"}},KAt=Zi,$At=r_,WAt=TypeError,Wu=function(r){if(KAt(r))return r;throw new WAt($At(r)+" is not a function")},XAt=Wu,JAt=fd,np=function(r,t){var e=r[t];return JAt(e)?void 0:XAt(e)},xB=Ws,BB=Zi,CB=dc,YAt=TypeError,ZAt=function(r,t){var e,n;if(t==="string"&&BB(e=r.toString)&&!CB(n=xB(e,r))||BB(e=r.valueOf)&&!CB(n=xB(e,r))||t!=="string"&&BB(e=r.toString)&&!CB(n=xB(e,r)))return n;throw new YAt("Can't convert object to primitive value")},nR={exports:{}},iR=Xi,tht=Object.defineProperty,EB=function(r,t){try{tht(iR,r,{value:t,configurable:!0,writable:!0})}catch{iR[r]=t}return t},eht=Xi,rht=EB,sR="__core-js_shared__",oR=nR.exports=eht[sR]||rht(sR,{});(oR.versions||(oR.versions=[])).push({version:"3.37.0",mode:"global",copyright:" 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.0/LICENSE",source:"https://github.com/zloirock/core-js"});var SB=nR.exports,aR=SB,TB=function(r,t){return aR[r]||(aR[r]=t||{})},nht=hc,iht=Object,n_=function(r){return iht(nht(r))},sht=Yi,oht=n_,aht=sht({}.hasOwnProperty),pc=Object.hasOwn||function(r,t){return aht(oht(r),t)},lht=Yi,cht=0,uht=Math.random(),Aht=lht(1 .toString),lR=function(r){return"Symbol("+(r===void 0?"":r)+")_"+Aht(++cht+uht,36)},hht=Xi,dht=TB,cR=pc,fht=lR,pht=tR,ght=eR,ip=hht.Symbol,IB=dht("wks"),mht=ght?ip.for||ip:ip&&ip.withoutSetter||fht,Ns=function(r){return cR(IB,r)||(IB[r]=pht&&cR(ip,r)?ip[r]:mht("Symbol."+r)),IB[r]},yht=Ws,uR=dc,AR=rR,_ht=np,vht=ZAt,bht=Ns,wht=TypeError,xht=bht("toPrimitive"),Bht=function(r,t){if(!uR(r)||AR(r))return r;var e=_ht(r,xht),n;if(e){if(t===void 0&&(t="default"),n=yht(e,r,t),!uR(n)||AR(n))return n;throw new wht("Can't convert object to primitive value")}return t===void 0&&(t="number"),vht(r,t)},Cht=Bht,Eht=rR,hR=function(r){var t=Cht(r,"string");return Eht(t)?t:t+""},Sht=Xi,dR=dc,FB=Sht.document,Tht=dR(FB)&&dR(FB.createElement),i_=function(r){return Tht?FB.createElement(r):{}},Iht=Ac,Fht=Ji,Lht=i_,fR=!Iht&&!Fht(function(){return Object.defineProperty(Lht("div"),"a",{get:function(){return 7}}).a!==7}),Pht=Ac,Mht=Ws,Uht=zU,Rht=gB,Oht=vm,Dht=hR,Nht=pc,kht=fR,pR=Object.getOwnPropertyDescriptor;_m.f=Pht?pR:function(r,t){if(r=Oht(r),t=Dht(t),kht)try{return pR(r,t)}catch{}if(Nht(r,t))return Rht(!Mht(Uht.f,r,t),r[t])};var Xu={},Qht=Ac,zht=Ji,gR=Qht&&zht(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Hht=dc,Vht=String,Ght=TypeError,No=function(r){if(Hht(r))return r;throw new Ght(Vht(r)+" is not an object")},jht=Ac,qht=fR,Kht=gR,s_=No,mR=hR,$ht=TypeError,LB=Object.defineProperty,Wht=Object.getOwnPropertyDescriptor,PB="enumerable",MB="configurable",UB="writable";Xu.f=jht?Kht?function(r,t,e){if(s_(r),t=mR(t),s_(e),typeof r=="function"&&t==="prototype"&&"value"in e&&UB in e&&!e[UB]){var n=Wht(r,t);n&&n[UB]&&(r[t]=e.value,e={configurable:MB in e?e[MB]:n[MB],enumerable:PB in e?e[PB]:n[PB],writable:!1})}return LB(r,t,e)}:LB:function(r,t,e){if(s_(r),t=mR(t),s_(e),qht)try{return LB(r,t,e)}catch{}if("get"in e||"set"in e)throw new $ht("Accessors not supported");return"value"in e&&(r[t]=e.value),r};var Xht=Ac,Jht=Xu,Yht=gB,bm=Xht?function(r,t,e){return Jht.f(r,t,Yht(1,e))}:function(r,t,e){return r[t]=e,r},yR={exports:{}},RB=Ac,Zht=pc,_R=Function.prototype,tdt=RB&&Object.getOwnPropertyDescriptor,OB=Zht(_R,"name"),edt=OB&&(function(){}).name==="something",rdt=OB&&(!RB||RB&&tdt(_R,"name").configurable),o_={EXISTS:OB,PROPER:edt,CONFIGURABLE:rdt},ndt=Yi,idt=Zi,DB=SB,sdt=ndt(Function.toString);idt(DB.inspectSource)||(DB.inspectSource=function(r){return sdt(r)});var NB=DB.inspectSource,odt=Xi,adt=Zi,vR=odt.WeakMap,ldt=adt(vR)&&/native code/.test(String(vR)),cdt=TB,udt=lR,bR=cdt("keys"),kB=function(r){return bR[r]||(bR[r]=udt(r))},QB={},Adt=ldt,wR=Xi,hdt=dc,ddt=bm,zB=pc,HB=SB,fdt=kB,pdt=QB,xR="Object already initialized",VB=wR.TypeError,gdt=wR.WeakMap,a_,wm,l_,mdt=function(r){return l_(r)?wm(r):a_(r,{})},ydt=function(r){return function(t){var e;if(!hdt(t)||(e=wm(t)).type!==r)throw new VB("Incompatible receiver, "+r+" required");return e}};if(Adt||HB.state){var ru=HB.state||(HB.state=new gdt);ru.get=ru.get,ru.has=ru.has,ru.set=ru.set,a_=function(r,t){if(ru.has(r))throw new VB(xR);return t.facade=r,ru.set(r,t),t},wm=function(r){return ru.get(r)||{}},l_=function(r){return ru.has(r)}}else{var sp=fdt("state");pdt[sp]=!0,a_=function(r,t){if(zB(r,sp))throw new VB(xR);return t.facade=r,ddt(r,sp,t),t},wm=function(r){return zB(r,sp)?r[sp]:{}},l_=function(r){return zB(r,sp)}}var c_={set:a_,get:wm,has:l_,enforce:mdt,getterFor:ydt},GB=Yi,_dt=Ji,vdt=Zi,u_=pc,jB=Ac,bdt=o_.CONFIGURABLE,wdt=NB,BR=c_,xdt=BR.enforce,Bdt=BR.get,CR=String,A_=Object.defineProperty,Cdt=GB("".slice),Edt=GB("".replace),Sdt=GB([].join),Tdt=jB&&!_dt(function(){return A_(function(){},"length",{value:8}).length!==8}),Idt=String(String).split("String"),Fdt=yR.exports=function(r,t,e){Cdt(CR(t),0,7)==="Symbol("&&(t="["+Edt(CR(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),e&&e.getter&&(t="get "+t),e&&e.setter&&(t="set "+t),(!u_(r,"name")||bdt&&r.name!==t)&&(jB?A_(r,"name",{value:t,configurable:!0}):r.name=t),Tdt&&e&&u_(e,"arity")&&r.length!==e.arity&&A_(r,"length",{value:e.arity});try{e&&u_(e,"constructor")&&e.constructor?jB&&A_(r,"prototype",{writable:!1}):r.prototype&&(r.prototype=void 0)}catch{}var n=xdt(r);return u_(n,"source")||(n.source=Sdt(Idt,typeof t=="string"?t:"")),r};Function.prototype.toString=Fdt(function(){return vdt(this)&&Bdt(this).source||wdt(this)},"toString");var ER=yR.exports,Ldt=Zi,Pdt=Xu,Mdt=ER,Udt=EB,gd=function(r,t,e,n){n||(n={});var i=n.enumerable,s=n.name!==void 0?n.name:t;if(Ldt(e)&&Mdt(e,s,n),n.global)i?r[t]=e:Udt(t,e);else{try{n.unsafe?r[t]&&(i=!0):delete r[t]}catch{}i?r[t]=e:Pdt.f(r,t,{value:e,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return r},SR={},Rdt=Math.ceil,Odt=Math.floor,Ddt=Math.trunc||function(r){var t=+r;return(t>0?Odt:Rdt)(t)},Ndt=Ddt,h_=function(r){var t=+r;return t!==t||t===0?0:Ndt(t)},kdt=h_,Qdt=Math.max,zdt=Math.min,Hdt=function(r,t){var e=kdt(r);return e<0?Qdt(e+t,0):zdt(e,t)},Vdt=h_,Gdt=Math.min,op=function(r){var t=Vdt(r);return t>0?Gdt(t,9007199254740991):0},jdt=op,qB=function(r){return jdt(r.length)},qdt=vm,Kdt=Hdt,$dt=qB,TR=function(r){return function(t,e,n){var i=qdt(t),s=$dt(i);if(s===0)return!r&&-1;var a=Kdt(n,s),o;if(r&&e!==e){for(;s>a;)if(o=i[a++],o!==o)return!0}else for(;s>a;a++)if((r||a in i)&&i[a]===e)return r||a||0;return!r&&-1}},IR={includes:TR(!0),indexOf:TR(!1)},Wdt=Yi,KB=pc,Xdt=vm,Jdt=IR.indexOf,Ydt=QB,FR=Wdt([].push),LR=function(r,t){var e=Xdt(r),n=0,i=[],s;for(s in e)!KB(Ydt,s)&&KB(e,s)&&FR(i,s);for(;t.length>n;)KB(e,s=t[n++])&&(~Jdt(i,s)||FR(i,s));return i},$B=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Zdt=LR,tft=$B,eft=tft.concat("length","prototype");SR.f=Object.getOwnPropertyNames||function(r){return Zdt(r,eft)};var PR={};PR.f=Object.getOwnPropertySymbols;var rft=pd,nft=Yi,ift=SR,sft=PR,oft=No,aft=nft([].concat),lft=rft("Reflect","ownKeys")||function(r){var t=ift.f(oft(r)),e=sft.f;return e?aft(t,e(r)):t},MR=pc,cft=lft,uft=_m,Aft=Xu,hft=function(r,t,e){for(var n=cft(t),i=Aft.f,s=uft.f,a=0;a<n.length;a++){var o=n[a];!MR(r,o)&&!(e&&MR(e,o))&&i(r,o,s(t,o))}},dft=Ji,fft=Zi,pft=/#|\.prototype\./,xm=function(r,t){var e=mft[gft(r)];return e===_ft?!0:e===yft?!1:fft(t)?dft(t):!!t},gft=xm.normalize=function(r){return String(r).replace(pft,".").toLowerCase()},mft=xm.data={},yft=xm.NATIVE="N",_ft=xm.POLYFILL="P",UR=xm,d_=Xi,vft=_m.f,bft=bm,wft=gd,xft=EB,Bft=hft,Cft=UR,ko=function(r,t){var e=r.target,n=r.global,i=r.stat,s,a,o,d,p,y;if(n?a=d_:i?a=d_[e]||xft(e,{}):a=d_[e]&&d_[e].prototype,a)for(o in t){if(p=t[o],r.dontCallGetSet?(y=vft(a,o),d=y&&y.value):d=a[o],s=Cft(n?o:e+(i?".":"#")+o,r.forced),!s&&d!==void 0){if(typeof p==typeof d)continue;Bft(p,d)}(r.sham||d&&d.sham)&&bft(p,"sham",!0),wft(a,o,p,r)}},Eft=Xi,Sft=dd,Bm=Sft(Eft.process)==="process",Tft=Yi,Ift=Wu,Fft=function(r,t,e){try{return Tft(Ift(Object.getOwnPropertyDescriptor(r,t)[e]))}catch{}},Lft=dc,Pft=function(r){return Lft(r)||r===null},Mft=Pft,Uft=String,Rft=TypeError,Oft=function(r){if(Mft(r))return r;throw new Rft("Can't set "+Uft(r)+" as a prototype")},Dft=Fft,Nft=dc,kft=hc,Qft=Oft,RR=Object.setPrototypeOf||("__proto__"in{}?function(){var r=!1,t={},e;try{e=Dft(Object.prototype,"__proto__","set"),e(t,[]),r=t instanceof Array}catch{}return function(n,i){return kft(n),Qft(i),Nft(n)&&(r?e(n,i):n.__proto__=i),n}}():void 0),zft=Xu.f,Hft=pc,Vft=Ns,OR=Vft("toStringTag"),f_=function(r,t,e){r&&!e&&(r=r.prototype),r&&!Hft(r,OR)&&zft(r,OR,{configurable:!0,value:t})},DR=ER,Gft=Xu,jft=function(r,t,e){return e.get&&DR(e.get,t,{getter:!0}),e.set&&DR(e.set,t,{setter:!0}),Gft.f(r,t,e)},qft=pd,Kft=jft,$ft=Ns,Wft=Ac,NR=$ft("species"),Xft=function(r){var t=qft(r);Wft&&t&&!t[NR]&&Kft(t,NR,{configurable:!0,get:function(){return this}})},Jft=Z1,Yft=TypeError,Zft=function(r,t){if(Jft(t,r))return r;throw new Yft("Incorrect invocation")},tpt=Ns,ept=tpt("toStringTag"),kR={};kR[ept]="z";var rpt=String(kR)==="[object z]",npt=rpt,ipt=Zi,p_=dd,spt=Ns,opt=spt("toStringTag"),apt=Object,lpt=p_(function(){return arguments}())==="Arguments",cpt=function(r,t){try{return r[t]}catch{}},WB=npt?p_:function(r){var t,e,n;return r===void 0?"Undefined":r===null?"Null":typeof(e=cpt(t=apt(r),opt))=="string"?e:lpt?p_(t):(n=p_(t))==="Object"&&ipt(t.callee)?"Arguments":n},upt=Yi,Apt=Ji,QR=Zi,hpt=WB,dpt=pd,fpt=NB,zR=function(){},HR=dpt("Reflect","construct"),XB=/^\s*(?:class|function)\b/,ppt=upt(XB.exec),gpt=!XB.test(zR),Cm=function(r){if(!QR(r))return!1;try{return HR(zR,[],r),!0}catch{return!1}},VR=function(r){if(!QR(r))return!1;switch(hpt(r)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return gpt||!!ppt(XB,fpt(r))}catch{return!0}};VR.sham=!0;var mpt=!HR||Apt(function(){var r;return Cm(Cm.call)||!Cm(Object)||!Cm(function(){r=!0})||r})?VR:Cm,ypt=mpt,_pt=r_,vpt=TypeError,bpt=function(r){if(ypt(r))return r;throw new vpt(_pt(r)+" is not a constructor")},GR=No,wpt=bpt,xpt=fd,Bpt=Ns,Cpt=Bpt("species"),jR=function(r,t){var e=GR(r).constructor,n;return e===void 0||xpt(n=GR(e)[Cpt])?t:wpt(n)},Ept=J1,qR=Function.prototype,KR=qR.apply,$R=qR.call,WR=typeof Reflect=="object"&&Reflect.apply||(Ept?$R.bind(KR):function(){return $R.apply(KR,arguments)}),Spt=dd,Tpt=Yi,g_=function(r){if(Spt(r)==="Function")return Tpt(r)},XR=g_,Ipt=Wu,Fpt=J1,Lpt=XR(XR.bind),JB=function(r,t){return Ipt(r),t===void 0?r:Fpt?Lpt(r,t):function(){return r.apply(t,arguments)}},Ppt=pd,JR=Ppt("document","documentElement"),Mpt=Yi,Upt=Mpt([].slice),Rpt=TypeError,Opt=function(r,t){if(r<t)throw new Rpt("Not enough arguments");return r},Dpt=t_,YR=/(?:ipad|iphone|ipod).*applewebkit/i.test(Dpt),Oa=Xi,Npt=WR,kpt=JB,ZR=Zi,Qpt=pc,tO=Ji,eO=JR,zpt=Upt,rO=i_,Hpt=Opt,Vpt=YR,Gpt=Bm,YB=Oa.setImmediate,ZB=Oa.clearImmediate,jpt=Oa.process,tC=Oa.Dispatch,qpt=Oa.Function,nO=Oa.MessageChannel,Kpt=Oa.String,eC=0,Em={},iO="onreadystatechange",Sm,md,rC,nC;tO(function(){Sm=Oa.location});var iC=function(r){if(Qpt(Em,r)){var t=Em[r];delete Em[r],t()}},sC=function(r){return function(){iC(r)}},sO=function(r){iC(r.data)},oO=function(r){Oa.postMessage(Kpt(r),Sm.protocol+"//"+Sm.host)};(!YB||!ZB)&&(YB=function(r){Hpt(arguments.length,1);var t=ZR(r)?r:qpt(r),e=zpt(arguments,1);return Em[++eC]=function(){Npt(t,void 0,e)},md(eC),eC},ZB=function(r){delete Em[r]},Gpt?md=function(r){jpt.nextTick(sC(r))}:tC&&tC.now?md=function(r){tC.now(sC(r))}:nO&&!Vpt?(rC=new nO,nC=rC.port2,rC.port1.onmessage=sO,md=kpt(nC.postMessage,nC)):Oa.addEventListener&&ZR(Oa.postMessage)&&!Oa.importScripts&&Sm&&Sm.protocol!=="file:"&&!tO(oO)?(md=oO,Oa.addEventListener("message",sO,!1)):iO in rO("script")?md=function(r){eO.appendChild(rO("script"))[iO]=function(){eO.removeChild(this),iC(r)}}:md=function(r){setTimeout(sC(r),0)});var aO={set:YB,clear:ZB},lO=Xi,$pt=Ac,Wpt=Object.getOwnPropertyDescriptor,Xpt=function(r){if(!$pt)return lO[r];var t=Wpt(lO,r);return t&&t.value},cO=function(){this.head=null,this.tail=null};cO.prototype={add:function(r){var t={item:r,next:null},e=this.tail;e?e.next=t:this.head=t,this.tail=t},get:function(){var r=this.head;if(r){var t=this.head=r.next;return t===null&&(this.tail=null),r.item}}};var uO=cO,Jpt=t_,Ypt=/ipad|iphone|ipod/i.test(Jpt)&&typeof Pebble<"u",Zpt=t_,tgt=/web0s(?!.*chrome)/i.test(Zpt),ap=Xi,egt=Xpt,AO=JB,oC=aO.set,rgt=uO,ngt=YR,igt=Ypt,sgt=tgt,aC=Bm,hO=ap.MutationObserver||ap.WebKitMutationObserver,dO=ap.document,fO=ap.process,m_=ap.Promise,lC=egt("queueMicrotask"),lp,cC,uC,y_,pO;if(!lC){var __=new rgt,v_=function(){var r,t;for(aC&&(r=fO.domain)&&r.exit();t=__.get();)try{t()}catch(e){throw __.head&&lp(),e}r&&r.enter()};!ngt&&!aC&&!sgt&&hO&&dO?(cC=!0,uC=dO.createTextNode(""),new hO(v_).observe(uC,{characterData:!0}),lp=function(){uC.data=cC=!cC}):!igt&&m_&&m_.resolve?(y_=m_.resolve(void 0),y_.constructor=m_,pO=AO(y_.then,y_),lp=function(){pO(v_)}):aC?lp=function(){fO.nextTick(v_)}:(oC=AO(oC,ap),lp=function(){oC(v_)}),lC=function(r){__.head||lp(),__.add(r)}}var ogt=lC,agt=function(r,t){try{arguments.length===1?console.error(r):console.error(r,t)}catch{}},AC=function(r){try{return{error:!1,value:r()}}catch(t){return{error:!0,value:t}}},lgt=Xi,b_=lgt.Promise,gO=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",cgt=gO,ugt=Bm,Agt=!cgt&&!ugt&&typeof window=="object"&&typeof document=="object",hgt=Xi,Tm=b_,dgt=Zi,fgt=UR,pgt=NB,ggt=Ns,mgt=Agt,ygt=gO,hC=wB;Tm&&Tm.prototype;var _gt=ggt("species"),dC=!1,mO=dgt(hgt.PromiseRejectionEvent),vgt=fgt("Promise",function(){var r=pgt(Tm),t=r!==String(Tm);if(!t&&hC===66)return!0;if(!hC||hC<51||!/native code/.test(r)){var e=new Tm(function(s){s(1)}),n=function(s){s(function(){},function(){})},i=e.constructor={};if(i[_gt]=n,dC=e.then(function(){})instanceof n,!dC)return!0}return!t&&(mgt||ygt)&&!mO}),Im={CONSTRUCTOR:vgt,REJECTION_EVENT:mO,SUBCLASSING:dC},cp={},yO=Wu,bgt=TypeError,wgt=function(r){var t,e;this.promise=new r(function(n,i){if(t!==void 0||e!==void 0)throw new bgt("Bad Promise constructor");t=n,e=i}),this.resolve=yO(t),this.reject=yO(e)};cp.f=function(r){return new wgt(r)};var xgt=ko,w_=Bm,sh=Xi,up=Ws,_O=gd,vO=RR,Bgt=f_,Cgt=Xft,Egt=Wu,x_=Zi,Sgt=dc,Tgt=Zft,Igt=jR,bO=aO.set,fC=ogt,Fgt=agt,Lgt=AC,Pgt=uO,wO=c_,B_=b_,pC=Im,xO=cp,C_="Promise",BO=pC.CONSTRUCTOR,Mgt=pC.REJECTION_EVENT,Ugt=pC.SUBCLASSING,gC=wO.getterFor(C_),Rgt=wO.set,Ap=B_&&B_.prototype,yd=B_,E_=Ap,CO=sh.TypeError,mC=sh.document,yC=sh.process,_C=xO.f,Ogt=_C,Dgt=!!(mC&&mC.createEvent&&sh.dispatchEvent),EO="unhandledrejection",Ngt="rejectionhandled",SO=0,TO=1,kgt=2,vC=1,IO=2,S_,FO,Qgt,LO,PO=function(r){var t;return Sgt(r)&&x_(t=r.then)?t:!1},MO=function(r,t){var e=t.value,n=t.state===TO,i=n?r.ok:r.fail,s=r.resolve,a=r.reject,o=r.domain,d,p,y;try{i?(n||(t.rejection===IO&&Hgt(t),t.rejection=vC),i===!0?d=e:(o&&o.enter(),d=i(e),o&&(o.exit(),y=!0)),d===r.promise?a(new CO("Promise-chain cycle")):(p=PO(d))?up(p,d,s,a):s(d)):a(e)}catch(b){o&&!y&&o.exit(),a(b)}},UO=function(r,t){r.notified||(r.notified=!0,fC(function(){for(var e=r.reactions,n;n=e.get();)MO(n,r);r.notified=!1,t&&!r.rejection&&zgt(r)}))},RO=function(r,t,e){var n,i;Dgt?(n=mC.createEvent("Event"),n.promise=t,n.reason=e,n.initEvent(r,!1,!0),sh.dispatchEvent(n)):n={promise:t,reason:e},!Mgt&&(i=sh["on"+r])?i(n):r===EO&&Fgt("Unhandled promise rejection",e)},zgt=function(r){up(bO,sh,function(){var t=r.facade,e=r.value,n=OO(r),i;if(n&&(i=Lgt(function(){w_?yC.emit("unhandledRejection",e,t):RO(EO,t,e)}),r.rejection=w_||OO(r)?IO:vC,i.error))throw i.value})},OO=function(r){return r.rejection!==vC&&!r.parent},Hgt=function(r){up(bO,sh,function(){var t=r.facade;w_?yC.emit("rejectionHandled",t):RO(Ngt,t,r.value)})},hp=function(r,t,e){return function(n){r(t,n,e)}},dp=function(r,t,e){r.done||(r.done=!0,e&&(r=e),r.value=t,r.state=kgt,UO(r,!0))},bC=function(r,t,e){if(!r.done){r.done=!0,e&&(r=e);try{if(r.facade===t)throw new CO("Promise can't be resolved itself");var n=PO(t);n?fC(function(){var i={done:!1};try{up(n,t,hp(bC,i,r),hp(dp,i,r))}catch(s){dp(i,s,r)}}):(r.value=t,r.state=TO,UO(r,!1))}catch(i){dp({done:!1},i,r)}}};if(BO&&(yd=function(r){Tgt(this,E_),Egt(r),up(S_,this);var t=gC(this);try{r(hp(bC,t),hp(dp,t))}catch(e){dp(t,e)}},E_=yd.prototype,S_=function(r){Rgt(this,{type:C_,done:!1,notified:!1,parent:!1,reactions:new Pgt,rejection:!1,state:SO,value:void 0})},S_.prototype=_O(E_,"then",function(r,t){var e=gC(this),n=_C(Igt(this,yd));return e.parent=!0,n.ok=x_(r)?r:!0,n.fail=x_(t)&&t,n.domain=w_?yC.domain:void 0,e.state===SO?e.reactions.add(n):fC(function(){MO(n,e)}),n.promise}),FO=function(){var r=new S_,t=gC(r);this.promise=r,this.resolve=hp(bC,t),this.reject=hp(dp,t)},xO.f=_C=function(r){return r===yd||r===Qgt?new FO(r):Ogt(r)},x_(B_)&&Ap!==Object.prototype)){LO=Ap.then,Ugt||_O(Ap,"then",function(r,t){var e=this;return new yd(function(n,i){up(LO,e,n,i)}).then(r,t)},{unsafe:!0});try{delete Ap.constructor}catch{}vO&&vO(Ap,E_)}xgt({global:!0,constructor:!0,wrap:!0,forced:BO},{Promise:yd}),Bgt(yd,C_,!1),Cgt(C_);var Fm={},Vgt=Ns,Ggt=Fm,jgt=Vgt("iterator"),qgt=Array.prototype,Kgt=function(r){return r!==void 0&&(Ggt.Array===r||qgt[jgt]===r)},$gt=WB,DO=np,Wgt=fd,Xgt=Fm,Jgt=Ns,Ygt=Jgt("iterator"),NO=function(r){if(!Wgt(r))return DO(r,Ygt)||DO(r,"@@iterator")||Xgt[$gt(r)]},Zgt=Ws,tmt=Wu,emt=No,rmt=r_,nmt=NO,imt=TypeError,smt=function(r,t){var e=arguments.length<2?nmt(r):t;if(tmt(e))return emt(Zgt(e,r));throw new imt(rmt(r)+" is not iterable")},omt=Ws,kO=No,amt=np,lmt=function(r,t,e){var n,i;kO(r);try{if(n=amt(r,"return"),!n){if(t==="throw")throw e;return e}n=omt(n,r)}catch(s){i=!0,n=s}if(t==="throw")throw e;if(i)throw n;return kO(n),e},cmt=JB,umt=Ws,Amt=No,hmt=r_,dmt=Kgt,fmt=qB,QO=Z1,pmt=smt,gmt=NO,zO=lmt,mmt=TypeError,T_=function(r,t){this.stopped=r,this.result=t},HO=T_.prototype,VO=function(r,t,e){var n=e&&e.that,i=!!(e&&e.AS_ENTRIES),s=!!(e&&e.IS_RECORD),a=!!(e&&e.IS_ITERATOR),o=!!(e&&e.INTERRUPTED),d=cmt(t,n),p,y,b,x,C,P,M,k=function(V){return p&&zO(p,"normal",V),new T_(!0,V)},z=function(V){return i?(Amt(V),o?d(V[0],V[1],k):d(V[0],V[1])):o?d(V,k):d(V)};if(s)p=r.iterator;else if(a)p=r;else{if(y=gmt(r),!y)throw new mmt(hmt(r)+" is not iterable");if(dmt(y)){for(b=0,x=fmt(r);x>b;b++)if(C=z(r[b]),C&&QO(HO,C))return C;return new T_(!1)}p=pmt(r,y)}for(P=s?r.next:p.next;!(M=umt(P,p)).done;){try{C=z(M.value)}catch(V){zO(p,"throw",V)}if(typeof C=="object"&&C&&QO(HO,C))return C}return new T_(!1)},ymt=Ns,GO=ymt("iterator"),jO=!1;try{var _mt=0,qO={next:function(){return{done:!!_mt++}},return:function(){jO=!0}};qO[GO]=function(){return this},Array.from(qO,function(){throw 2})}catch{}var vmt=function(r,t){try{if(!t&&!jO)return!1}catch{return!1}var e=!1;try{var n={};n[GO]=function(){return{next:function(){return{done:e=!0}}}},r(n)}catch{}return e},bmt=b_,wmt=vmt,xmt=Im.CONSTRUCTOR,KO=xmt||!wmt(function(r){bmt.all(r).then(void 0,function(){})}),Bmt=ko,Cmt=Ws,Emt=Wu,Smt=cp,Tmt=AC,Imt=VO,Fmt=KO;Bmt({target:"Promise",stat:!0,forced:Fmt},{all:function(r){var t=this,e=Smt.f(t),n=e.resolve,i=e.reject,s=Tmt(function(){var a=Emt(t.resolve),o=[],d=0,p=1;Imt(r,function(y){var b=d++,x=!1;p++,Cmt(a,t,y).then(function(C){x||(x=!0,o[b]=C,--p||n(o))},i)}),--p||n(o)});return s.error&&i(s.value),e.promise}});var Lmt=ko,Pmt=Im.CONSTRUCTOR,wC=b_,Mmt=pd,Umt=Zi,Rmt=gd,$O=wC&&wC.prototype;if(Lmt({target:"Promise",proto:!0,forced:Pmt,real:!0},{catch:function(r){return this.then(void 0,r)}}),Umt(wC)){var WO=Mmt("Promise").prototype.catch;$O.catch!==WO&&Rmt($O,"catch",WO,{unsafe:!0})}var Omt=ko,Dmt=Ws,Nmt=Wu,kmt=cp,Qmt=AC,zmt=VO,Hmt=KO;Omt({target:"Promise",stat:!0,forced:Hmt},{race:function(r){var t=this,e=kmt.f(t),n=e.reject,i=Qmt(function(){var s=Nmt(t.resolve);zmt(r,function(a){Dmt(s,t,a).then(e.resolve,n)})});return i.error&&n(i.value),e.promise}});var Vmt=ko,Gmt=cp,jmt=Im.CONSTRUCTOR;Vmt({target:"Promise",stat:!0,forced:jmt},{reject:function(r){var t=Gmt.f(this),e=t.reject;return e(r),t.promise}});var qmt=No,Kmt=dc,$mt=cp,Wmt=function(r,t){if(qmt(r),Kmt(t)&&t.constructor===r)return t;var e=$mt.f(r),n=e.resolve;return n(t),e.promise},Xmt=ko,Jmt=pd,Ymt=Im.CONSTRUCTOR,Zmt=Wmt;Jmt("Promise"),Xmt({target:"Promise",stat:!0,forced:Ymt},{resolve:function(r){return Zmt(this,r)}});function XO(r,t,e,n,i,s,a){try{var o=r[s](a),d=o.value}catch(p){e(p);return}o.done?t(d):Promise.resolve(d).then(n,i)}function Ju(r){return function(){var t=this,e=arguments;return new Promise(function(n,i){var s=r.apply(t,e);function a(d){XO(s,n,i,a,o,"next",d)}function o(d){XO(s,n,i,a,o,"throw",d)}a(void 0)})}}var t0t=WB,e0t=String,nu=function(r){if(t0t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e0t(r)},r0t=No,JO=function(){var r=r0t(this),t="";return r.hasIndices&&(t+="d"),r.global&&(t+="g"),r.ignoreCase&&(t+="i"),r.multiline&&(t+="m"),r.dotAll&&(t+="s"),r.unicode&&(t+="u"),r.unicodeSets&&(t+="v"),r.sticky&&(t+="y"),t},xC=Ji,n0t=Xi,BC=n0t.RegExp,CC=xC(function(){var r=BC("a","y");return r.lastIndex=2,r.exec("abcd")!==null}),i0t=CC||xC(function(){return!BC("a","y").sticky}),s0t=CC||xC(function(){var r=BC("^r","gy");return r.lastIndex=2,r.exec("str")!==null}),YO={BROKEN_CARET:s0t,MISSED_STICKY:i0t,UNSUPPORTED_Y:CC},ZO={},o0t=LR,a0t=$B,l0t=Object.keys||function(r){return o0t(r,a0t)},c0t=Ac,u0t=gR,A0t=Xu,h0t=No,d0t=vm,f0t=l0t;ZO.f=c0t&&!u0t?Object.defineProperties:function(r,t){h0t(r);for(var e=d0t(t),n=f0t(t),i=n.length,s=0,a;i>s;)A0t.f(r,a=n[s++],e[a]);return r};var p0t=No,g0t=ZO,tD=$B,m0t=QB,y0t=JR,_0t=i_,v0t=kB,eD=">",rD="<",EC="prototype",SC="script",nD=v0t("IE_PROTO"),TC=function(){},iD=function(r){return rD+SC+eD+r+rD+"/"+SC+eD},sD=function(r){r.write(iD("")),r.close();var t=r.parentWindow.Object;return r=null,t},b0t=function(){var r=_0t("iframe"),t="java"+SC+":",e;return r.style.display="none",y0t.appendChild(r),r.src=String(t),e=r.contentWindow.document,e.open(),e.write(iD("document.F=Object")),e.close(),e.F},I_,F_=function(){try{I_=new ActiveXObject("htmlfile")}catch{}F_=typeof document<"u"?document.domain&&I_?sD(I_):b0t():sD(I_);for(var r=tD.length;r--;)delete F_[EC][tD[r]];return F_()};m0t[nD]=!0;var IC=Object.create||function(r,t){var e;return r!==null?(TC[EC]=p0t(r),e=new TC,TC[EC]=null,e[nD]=r):e=F_(),t===void 0?e:g0t.f(e,t)},w0t=Ji,x0t=Xi,B0t=x0t.RegExp,C0t=w0t(function(){var r=B0t(".","s");return!(r.dotAll&&r.test(`
`)&&r.flags==="s")}),E0t=Ji,S0t=Xi,T0t=S0t.RegExp,I0t=E0t(function(){var r=T0t("(?<a>b)","g");return r.exec("b").groups.a!=="b"||"b".replace(r,"$<a>c")!=="bc"}),fp=Ws,L_=Yi,F0t=nu,L0t=JO,P0t=YO,M0t=TB,U0t=IC,R0t=c_.get,O0t=C0t,D0t=I0t,N0t=M0t("native-string-replace",String.prototype.replace),P_=RegExp.prototype.exec,FC=P_,k0t=L_("".charAt),Q0t=L_("".indexOf),z0t=L_("".replace),LC=L_("".slice),PC=function(){var r=/a/,t=/b*/g;return fp(P_,r,"a"),fp(P_,t,"a"),r.lastIndex!==0||t.lastIndex!==0}(),oD=P0t.BROKEN_CARET,MC=/()??/.exec("")[1]!==void 0,H0t=PC||MC||oD||O0t||D0t;H0t&&(FC=function(r){var t=this,e=R0t(t),n=F0t(r),i=e.raw,s,a,o,d,p,y,b;if(i)return i.lastIndex=t.lastIndex,s=fp(FC,i,n),t.lastIndex=i.lastIndex,s;var x=e.groups,C=oD&&t.sticky,P=fp(L0t,t),M=t.source,k=0,z=n;if(C&&(P=z0t(P,"y",""),Q0t(P,"g")===-1&&(P+="g"),z=LC(n,t.lastIndex),t.lastIndex>0&&(!t.multiline||t.multiline&&k0t(n,t.lastIndex-1)!==`
`)&&(M="(?: "+M+")",z=" "+z,k++),a=new RegExp("^(?:"+M+")",P)),MC&&(a=new RegExp("^"+M+"$(?!\\s)",P)),PC&&(o=t.lastIndex),d=fp(P_,C?a:t,z),C?d?(d.input=LC(d.input,k),d[0]=LC(d[0],k),d.index=t.lastIndex,t.lastIndex+=d[0].length):t.lastIndex=0:PC&&d&&(t.lastIndex=t.global?d.index+d[0].length:o),MC&&d&&d.length>1&&fp(N0t,d[0],a,function(){for(p=1;p<arguments.length-2;p++)arguments[p]===void 0&&(d[p]=void 0)}),d&&x)for(d.groups=y=U0t(null),p=0;p<x.length;p++)b=x[p],y[b[0]]=d[b[1]];return d});var UC=FC,V0t=ko,aD=UC;V0t({target:"RegExp",proto:!0,forced:/./.exec!==aD},{exec:aD});var lD=Ws,cD=gd,G0t=UC,uD=Ji,AD=Ns,j0t=bm,q0t=AD("species"),RC=RegExp.prototype,OC=function(r,t,e,n){var i=AD(r),s=!uD(function(){var p={};return p[i]=function(){return 7},""[r](p)!==7}),a=s&&!uD(function(){var p=!1,y=/a/;return r==="split"&&(y={},y.constructor={},y.constructor[q0t]=function(){return y},y.flags="",y[i]=/./[i]),y.exec=function(){return p=!0,null},y[i](""),!p});if(!s||!a||e){var o=/./[i],d=t(i,""[r],function(p,y,b,x,C){var P=y.exec;return P===G0t||P===RC.exec?s&&!C?{done:!0,value:lD(o,y,b,x)}:{done:!0,value:lD(p,b,y,x)}:{done:!1}});cD(String.prototype,r,d[0]),cD(RC,i,d[1])}n&&j0t(RC[i],"sham",!0)},DC=Yi,K0t=h_,$0t=nu,W0t=hc,X0t=DC("".charAt),hD=DC("".charCodeAt),J0t=DC("".slice),dD=function(r){return function(t,e){var n=$0t(W0t(t)),i=K0t(e),s=n.length,a,o;return i<0||i>=s?r?"":void 0:(a=hD(n,i),a<55296||a>56319||i+1===s||(o=hD(n,i+1))<56320||o>57343?r?X0t(n,i):a:r?J0t(n,i,i+2):(a-55296<<10)+(o-56320)+65536)}},Y0t={codeAt:dD(!1),charAt:dD(!0)},Z0t=Y0t.charAt,NC=function(r,t,e){return t+(e?Z0t(r,t).length:1)},fD=Ws,tyt=No,eyt=Zi,ryt=dd,nyt=UC,iyt=TypeError,kC=function(r,t){var e=r.exec;if(eyt(e)){var n=fD(e,r,t);return n!==null&&tyt(n),n}if(ryt(r)==="RegExp")return fD(nyt,r,t);throw new iyt("RegExp#exec called on incompatible receiver")},syt=Ws,oyt=OC,ayt=No,lyt=fd,cyt=op,QC=nu,uyt=hc,Ayt=np,hyt=NC,pD=kC;oyt("match",function(r,t,e){return[function(n){var i=uyt(this),s=lyt(n)?void 0:Ayt(n,r);return s?syt(s,n,i):new RegExp(n)[r](QC(i))},function(n){var i=ayt(this),s=QC(n),a=e(t,i,s);if(a.done)return a.value;if(!i.global)return pD(i,s);var o=i.unicode;i.lastIndex=0;for(var d=[],p=0,y;(y=pD(i,s))!==null;){var b=QC(y[0]);d[p]=b,b===""&&(i.lastIndex=hyt(s,cyt(i.lastIndex),o)),p++}return p===0?null:d}]});var zC=Yi,dyt=n_,fyt=Math.floor,HC=zC("".charAt),pyt=zC("".replace),VC=zC("".slice),gyt=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,myt=/\$([$&'`]|\d{1,2})/g,yyt=function(r,t,e,n,i,s){var a=e+r.length,o=n.length,d=myt;return i!==void 0&&(i=dyt(i),d=gyt),pyt(s,d,function(p,y){var b;switch(HC(y,0)){case"$":return"$";case"&":return r;case"`":return VC(t,0,e);case"'":return VC(t,a);case"<":b=i[VC(y,1,-1)];break;default:var x=+y;if(x===0)return p;if(x>o){var C=fyt(x/10);return C===0?p:C<=o?n[C-1]===void 0?HC(y,1):n[C-1]+HC(y,1):p}b=n[x-1]}return b===void 0?"":b})},_yt=WR,gD=Ws,M_=Yi,vyt=OC,byt=Ji,wyt=No,xyt=Zi,Byt=fd,Cyt=h_,Eyt=op,pp=nu,Syt=hc,Tyt=NC,Iyt=np,Fyt=yyt,Lyt=kC,Pyt=Ns,GC=Pyt("replace"),Myt=Math.max,Uyt=Math.min,Ryt=M_([].concat),jC=M_([].push),mD=M_("".indexOf),yD=M_("".slice),Oyt=function(r){return r===void 0?r:String(r)},Dyt=function(){return"a".replace(/./,"$0")==="$0"}(),_D=function(){return/./[GC]?/./[GC]("a","$0")==="":!1}(),Nyt=!byt(function(){var r=/./;return r.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(r,"$<a>")!=="7"});vyt("replace",function(r,t,e){var n=_D?"$":"$0";return[function(i,s){var a=Syt(this),o=Byt(i)?void 0:Iyt(i,GC);return o?gD(o,i,a,s):gD(t,pp(a),i,s)},function(i,s){var a=wyt(this),o=pp(i);if(typeof s=="string"&&mD(s,n)===-1&&mD(s,"$<")===-1){var d=e(t,a,o,s);if(d.done)return d.value}var p=xyt(s);p||(s=pp(s));var y=a.global,b;y&&(b=a.unicode,a.lastIndex=0);for(var x=[],C;C=Lyt(a,o),!(C===null||(jC(x,C),!y));){var P=pp(C[0]);P===""&&(a.lastIndex=Tyt(o,Eyt(a.lastIndex),b))}for(var M="",k=0,z=0;z<x.length;z++){C=x[z];for(var V=pp(C[0]),$=Myt(Uyt(Cyt(C.index),o.length),0),tt=[],pt,gt=1;gt<C.length;gt++)jC(tt,Oyt(C[gt]));var mt=C.groups;if(p){var dt=Ryt([V],tt,$,o);mt!==void 0&&jC(dt,mt),pt=pp(_yt(s,void 0,dt))}else pt=Fyt(V,o,$,tt,mt,s);$>=k&&(M+=yD(o,k,$)+pt,k=$+V.length)}return M+yD(o,k)}]},!Nyt||!Dyt||_D);var kyt=dc,Qyt=dd,zyt=Ns,Hyt=zyt("match"),Vyt=function(r){var t;return kyt(r)&&((t=r[Hyt])!==void 0?!!t:Qyt(r)==="RegExp")},Gyt=Vyt,jyt=TypeError,qC=function(r){if(Gyt(r))throw new jyt("The method doesn't accept regular expressions");return r},qyt=Ns,Kyt=qyt("match"),KC=function(r){var t=/./;try{"/./"[r](t)}catch{try{return t[Kyt]=!1,"/./"[r](t)}catch{}}return!1},$yt=ko,Wyt=g_,Xyt=_m.f,Jyt=op,vD=nu,Yyt=qC,Zyt=hc,t1t=KC,e1t=Wyt("".slice),r1t=Math.min,bD=t1t("startsWith"),n1t=!bD&&!!function(){var r=Xyt(String.prototype,"startsWith");return r&&!r.writable}();$yt({target:"String",proto:!0,forced:!n1t&&!bD},{startsWith:function(r){var t=vD(Zyt(this));Yyt(r);var e=Jyt(r1t(arguments.length>1?arguments[1]:void 0,t.length)),n=vD(r);return e1t(t,e,e+n.length)===n}});var i1t=Ns,s1t=IC,o1t=Xu.f,$C=i1t("unscopables"),WC=Array.prototype;WC[$C]===void 0&&o1t(WC,$C,{configurable:!0,value:s1t(null)});var a1t=function(r){WC[$C][r]=!0},l1t=Ji,c1t=!l1t(function(){function r(){}return r.prototype.constructor=null,Object.getPrototypeOf(new r)!==r.prototype}),u1t=pc,A1t=Zi,h1t=n_,d1t=kB,f1t=c1t,wD=d1t("IE_PROTO"),XC=Object,p1t=XC.prototype,xD=f1t?XC.getPrototypeOf:function(r){var t=h1t(r);if(u1t(t,wD))return t[wD];var e=t.constructor;return A1t(e)&&t instanceof e?e.prototype:t instanceof XC?p1t:null},g1t=Ji,m1t=Zi,y1t=dc,BD=xD,_1t=gd,v1t=Ns,JC=v1t("iterator"),CD=!1,_d,YC,ZC;[].keys&&(ZC=[].keys(),"next"in ZC?(YC=BD(BD(ZC)),YC!==Object.prototype&&(_d=YC)):CD=!0);var b1t=!y1t(_d)||g1t(function(){var r={};return _d[JC].call(r)!==r});b1t&&(_d={}),m1t(_d[JC])||_1t(_d,JC,function(){return this});var ED={IteratorPrototype:_d,BUGGY_SAFARI_ITERATORS:CD},w1t=ED.IteratorPrototype,x1t=IC,B1t=gB,C1t=f_,E1t=Fm,S1t=function(){return this},T1t=function(r,t,e,n){var i=t+" Iterator";return r.prototype=x1t(w1t,{next:B1t(+!n,e)}),C1t(r,i,!1),E1t[i]=S1t,r},I1t=ko,F1t=Ws,SD=o_,L1t=Zi,P1t=T1t,TD=xD,ID=RR,M1t=f_,U1t=bm,tE=gd,R1t=Ns,O1t=Fm,FD=ED,D1t=SD.PROPER,N1t=SD.CONFIGURABLE,LD=FD.IteratorPrototype,U_=FD.BUGGY_SAFARI_ITERATORS,Lm=R1t("iterator"),PD="keys",Pm="values",MD="entries",k1t=function(){return this},Q1t=function(r,t,e,n,i,s,a){P1t(e,t,n);var o=function(z){if(z===i&&x)return x;if(!U_&&z&&z in y)return y[z];switch(z){case PD:return function(){return new e(this,z)};case Pm:return function(){return new e(this,z)};case MD:return function(){return new e(this,z)}}return function(){return new e(this)}},d=t+" Iterator",p=!1,y=r.prototype,b=y[Lm]||y["@@iterator"]||i&&y[i],x=!U_&&b||o(i),C=t==="Array"&&y.entries||b,P,M,k;if(C&&(P=TD(C.call(new r)),P!==Object.prototype&&P.next&&(TD(P)!==LD&&(ID?ID(P,LD):L1t(P[Lm])||tE(P,Lm,k1t)),M1t(P,d,!0))),D1t&&i===Pm&&b&&b.name!==Pm&&(N1t?U1t(y,"name",Pm):(p=!0,x=function(){return F1t(b,this)})),i)if(M={values:o(Pm),keys:s?x:o(PD),entries:o(MD)},a)for(k in M)(U_||p||!(k in y))&&tE(y,k,M[k]);else I1t({target:t,proto:!0,forced:U_||p},M);return y[Lm]!==x&&tE(y,Lm,x,{name:i}),O1t[t]=x,M},z1t=function(r,t){return{value:r,done:t}},H1t=vm,eE=a1t,UD=Fm,RD=c_,V1t=Xu.f,G1t=Q1t,R_=z1t,j1t=Ac,OD="Array Iterator",q1t=RD.set,K1t=RD.getterFor(OD),$1t=G1t(Array,"Array",function(r,t){q1t(this,{type:OD,target:H1t(r),index:0,kind:t})},function(){var r=K1t(this),t=r.target,e=r.index++;if(!t||e>=t.length)return r.target=void 0,R_(void 0,!0);switch(r.kind){case"keys":return R_(e,!1);case"values":return R_(t[e],!1)}return R_([e,t[e]],!1)},"values"),DD=UD.Arguments=UD.Array;if(eE("keys"),eE("values"),eE("entries"),j1t&&DD.name!=="values")try{V1t(DD,"name",{value:"values"})}catch{}var W1t={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},X1t=i_,rE=X1t("span").classList,ND=rE&&rE.constructor&&rE.constructor.prototype,J1t=ND===Object.prototype?void 0:ND,kD=Xi,QD=W1t,Y1t=J1t,Mm=$1t,zD=bm,Z1t=f_,t_t=Ns,nE=t_t("iterator"),iE=Mm.values,HD=function(r,t){if(r){if(r[nE]!==iE)try{zD(r,nE,iE)}catch{r[nE]=iE}if(Z1t(r,t,!0),QD[t]){for(var e in Mm)if(r[e]!==Mm[e])try{zD(r,e,Mm[e])}catch{r[e]=Mm[e]}}}};for(var sE in QD)HD(kD[sE]&&kD[sE].prototype,sE);HD(Y1t,"DOMTokenList");function e_t(r,t){if(Dn(r)!="object"||!r)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var n=e.call(r,t||"default");if(Dn(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function r_t(r){var t=e_t(r,"string");return Dn(t)=="symbol"?t:t+""}function oE(r,t,e){return t=r_t(t),t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}var n_t=Wu,i_t=n_,s_t=KU,o_t=qB,VD=TypeError,GD="Reduce of empty array with no initial value",jD=function(r){return function(t,e,n,i){var s=i_t(t),a=s_t(s),o=o_t(s);if(n_t(e),o===0&&n<2)throw new VD(GD);var d=r?o-1:0,p=r?-1:1;if(n<2)for(;;){if(d in a){i=a[d],d+=p;break}if(d+=p,r?d<0:o<=d)throw new VD(GD)}for(;r?d>=0:o>d;d+=p)d in a&&(i=e(i,a[d],d,s));return i}},a_t={left:jD(!1),right:jD(!0)},l_t=Ji,qD=function(r,t){var e=[][r];return!!e&&l_t(function(){e.call(null,t||function(){return 1},1)})},c_t=ko,u_t=a_t.left,A_t=qD,KD=wB,h_t=Bm,d_t=!h_t&&KD>79&&KD<83,f_t=d_t||!A_t("reduce");c_t({target:"Array",proto:!0,forced:f_t},{reduce:function(r){var t=arguments.length;return u_t(this,r,t,t>1?arguments[1]:void 0)}});var p_t=ko,g_t=g_,m_t=_m.f,y_t=op,$D=nu,__t=qC,v_t=hc,b_t=KC,w_t=g_t("".slice),x_t=Math.min,WD=b_t("endsWith"),B_t=!WD&&!!function(){var r=m_t(String.prototype,"endsWith");return r&&!r.writable}();p_t({target:"String",proto:!0,forced:!B_t&&!WD},{endsWith:function(r){var t=$D(v_t(this));__t(r);var e=arguments.length>1?arguments[1]:void 0,n=t.length,i=e===void 0?n:x_t(y_t(e),n),s=$D(r);return w_t(t,i-s.length,i)===s}});var aE=Ws,XD=Yi,C_t=OC,E_t=No,S_t=fd,T_t=hc,I_t=jR,F_t=NC,L_t=op,JD=nu,P_t=np,YD=kC,M_t=YO,U_t=Ji,gp=M_t.UNSUPPORTED_Y,R_t=4294967295,O_t=Math.min,lE=XD([].push),cE=XD("".slice),D_t=!U_t(function(){var r=/(?:)/,t=r.exec;r.exec=function(){return t.apply(this,arguments)};var e="ab".split(r);return e.length!==2||e[0]!=="a"||e[1]!=="b"}),ZD="abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length;C_t("split",function(r,t,e){var n="0".split(void 0,0).length?function(i,s){return i===void 0&&s===0?[]:aE(t,this,i,s)}:t;return[function(i,s){var a=T_t(this),o=S_t(i)?void 0:P_t(i,r);return o?aE(o,i,a,s):aE(n,JD(a),i,s)},function(i,s){var a=E_t(this),o=JD(i);if(!ZD){var d=e(n,a,o,s,n!==t);if(d.done)return d.value}var p=I_t(a,RegExp),y=a.unicode,b=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(gp?"g":"y"),x=new p(gp?"^(?:"+a.source+")":a,b),C=s===void 0?R_t:s>>>0;if(C===0)return[];if(o.length===0)return YD(x,o)===null?[o]:[];for(var P=0,M=0,k=[];M<o.length;){x.lastIndex=gp?0:M;var z=YD(x,gp?cE(o,M):o),V;if(z===null||(V=O_t(L_t(x.lastIndex+(gp?M:0)),o.length))===P)M=F_t(o,M,y);else{if(lE(k,cE(o,P,M)),k.length===C)return k;for(var $=1;$<=z.length-1;$++)if(lE(k,z[$]),k.length===C)return k;M=P=V}}return lE(k,cE(o,P)),k}]},ZD||!D_t,gp);var O_={exports:{}},Um={exports:{}};(function(){var r,t,e,n,i,s;typeof performance<"u"&&performance!==null&&performance.now?Um.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(Um.exports=function(){return(r()-i)/1e6},t=process.hrtime,r=function(){var a;return a=t(),a[0]*1e9+a[1]},n=r(),s=process.uptime()*1e9,i=n-s):Date.now?(Um.exports=function(){return Date.now()-e},e=Date.now()):(Um.exports=function(){return new Date().getTime()-e},e=new Date().getTime())}).call(rp);for(var N_t=Um.exports,k_t=N_t,Yu=typeof window>"u"?rp:window,D_=["moz","webkit"],mp="AnimationFrame",yp=Yu["request"+mp],Rm=Yu["cancel"+mp]||Yu["cancelRequest"+mp],Om=0;!yp&&Om<D_.length;Om++)yp=Yu[D_[Om]+"Request"+mp],Rm=Yu[D_[Om]+"Cancel"+mp]||Yu[D_[Om]+"CancelRequest"+mp];if(!yp||!Rm){var uE=0,t6=0,vd=[],Q_t=1e3/60;yp=function(r){if(vd.length===0){var t=k_t(),e=Math.max(0,Q_t-(t-uE));uE=e+t,setTimeout(function(){var n=vd.slice(0);vd.length=0;for(var i=0;i<n.length;i++)if(!n[i].cancelled)try{n[i].callback(uE)}catch(s){setTimeout(function(){throw s},0)}},Math.round(e))}return vd.push({handle:++t6,callback:r,cancelled:!1}),t6},Rm=function(r){for(var t=0;t<vd.length;t++)vd[t].handle===r&&(vd[t].cancelled=!0)}}O_.exports=function(r){return yp.call(Yu,r)},O_.exports.cancel=function(){Rm.apply(Yu,arguments)},O_.exports.polyfill=function(r){r||(r=Yu),r.requestAnimationFrame=yp,r.cancelAnimationFrame=Rm};var z_t=O_.exports;const AE=QU(z_t);var e6=`	
\v\f\r \u2028\u2029\uFEFF`,H_t=Yi,V_t=hc,G_t=nu,hE=e6,r6=H_t("".replace),j_t=RegExp("^["+hE+"]+"),q_t=RegExp("(^|[^"+hE+"])["+hE+"]+$"),dE=function(r){return function(t){var e=G_t(V_t(t));return r&1&&(e=r6(e,j_t,"")),r&2&&(e=r6(e,q_t,"$1")),e}},K_t={start:dE(1),end:dE(2),trim:dE(3)},$_t=o_.PROPER,W_t=Ji,n6=e6,i6="",X_t=function(r){return W_t(function(){return!!n6[r]()||i6[r]()!==i6||$_t&&n6[r].name!==r})},J_t=ko,Y_t=K_t.trim,Z_t=X_t;J_t({target:"String",proto:!0,forced:Z_t("trim")},{trim:function(){return Y_t(this)}});var tvt=function(r){this.ok=!1,this.alpha=1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r=r.replace(/ /g,""),r=r.toLowerCase();var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};r=t[r]||r;for(var e=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(d){return[parseInt(d[1]),parseInt(d[2]),parseInt(d[3]),parseFloat(d[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(d){return[parseInt(d[1]),parseInt(d[2]),parseInt(d[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(d){return[parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(d){return[parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16)]}}],n=0;n<e.length;n++){var i=e[n].re,s=e[n].process,a=i.exec(r);if(a){var o=s(a);this.r=o[0],this.g=o[1],this.b=o[2],o.length>3&&(this.alpha=o[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var d=this.r.toString(16),p=this.g.toString(16),y=this.b.toString(16);return d.length==1&&(d="0"+d),p.length==1&&(p="0"+p),y.length==1&&(y="0"+y),"#"+d+p+y},this.getHelpXML=function(){for(var d=new Array,p=0;p<e.length;p++)for(var y=e[p].example,b=0;b<y.length;b++)d[d.length]=y[b];for(var x in t)d[d.length]=x;var C=document.createElement("ul");C.setAttribute("id","rgbcolor-examples");for(var p=0;p<d.length;p++)try{var P=document.createElement("li"),M=new RGBColor(d[p]),k=document.createElement("div");k.style.cssText="margin: 3px; border: 1px solid black; background:"+M.toHex()+"; color:"+M.toHex(),k.appendChild(document.createTextNode("test"));var z=document.createTextNode(" "+d[p]+" -> "+M.toRGB()+" -> "+M.toHex());P.appendChild(k),P.appendChild(z),C.appendChild(P)}catch{}return C}};const fE=QU(tvt);var evt=ko,rvt=g_,nvt=IR.indexOf,ivt=qD,pE=rvt([].indexOf),s6=!!pE&&1/pE([1],1,-0)<0,svt=s6||!ivt("indexOf");evt({target:"Array",proto:!0,forced:svt},{indexOf:function(r){var t=arguments.length>1?arguments[1]:void 0;return s6?pE(this,r,t)||0:nvt(this,r,t)}});var ovt=ko,avt=Yi,lvt=qC,cvt=hc,o6=nu,uvt=KC,Avt=avt("".indexOf);ovt({target:"String",proto:!0,forced:!uvt("includes")},{includes:function(r){return!!~Avt(o6(cvt(this)),o6(lvt(r)),arguments.length>1?arguments[1]:void 0)}});var hvt=dd,dvt=Array.isArray||function(r){return hvt(r)==="Array"},fvt=ko,pvt=Yi,gvt=dvt,mvt=pvt([].reverse),a6=[1,2];fvt({target:"Array",proto:!0,forced:String(a6)===String(a6.reverse())},{reverse:function(){return gvt(this)&&(this.length=this.length),mvt(this)}});/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var l6=function(r,t){return(l6=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])})(r,t)};function c6(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=r}l6(r,t),r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function yvt(r){var t="";Array.isArray(r)||(r=[r]);for(var e=0;e<r.length;e++){var n=r[e];if(n.type===Me.CLOSE_PATH)t+="z";else if(n.type===Me.HORIZ_LINE_TO)t+=(n.relative?"h":"H")+n.x;else if(n.type===Me.VERT_LINE_TO)t+=(n.relative?"v":"V")+n.y;else if(n.type===Me.MOVE_TO)t+=(n.relative?"m":"M")+n.x+" "+n.y;else if(n.type===Me.LINE_TO)t+=(n.relative?"l":"L")+n.x+" "+n.y;else if(n.type===Me.CURVE_TO)t+=(n.relative?"c":"C")+n.x1+" "+n.y1+" "+n.x2+" "+n.y2+" "+n.x+" "+n.y;else if(n.type===Me.SMOOTH_CURVE_TO)t+=(n.relative?"s":"S")+n.x2+" "+n.y2+" "+n.x+" "+n.y;else if(n.type===Me.QUAD_TO)t+=(n.relative?"q":"Q")+n.x1+" "+n.y1+" "+n.x+" "+n.y;else if(n.type===Me.SMOOTH_QUAD_TO)t+=(n.relative?"t":"T")+n.x+" "+n.y;else{if(n.type!==Me.ARC)throw new Error('Unexpected command type "'+n.type+'" at index '+e+".");t+=(n.relative?"a":"A")+n.rX+" "+n.rY+" "+n.xRot+" "+ +n.lArcFlag+" "+ +n.sweepFlag+" "+n.x+" "+n.y}}return t}function gE(r,t){var e=r[0],n=r[1];return[e*Math.cos(t)-n*Math.sin(t),e*Math.sin(t)+n*Math.cos(t)]}function gc(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];for(var e=0;e<r.length;e++)if(typeof r[e]!="number")throw new Error("assertNumbers arguments["+e+"] is not a number. "+typeof r[e]+" == typeof "+r[e]);return!0}var oh=Math.PI;function mE(r,t,e){r.lArcFlag=r.lArcFlag===0?0:1,r.sweepFlag=r.sweepFlag===0?0:1;var n=r.rX,i=r.rY,s=r.x,a=r.y;n=Math.abs(r.rX),i=Math.abs(r.rY);var o=gE([(t-s)/2,(e-a)/2],-r.xRot/180*oh),d=o[0],p=o[1],y=Math.pow(d,2)/Math.pow(n,2)+Math.pow(p,2)/Math.pow(i,2);1<y&&(n*=Math.sqrt(y),i*=Math.sqrt(y)),r.rX=n,r.rY=i;var b=Math.pow(n,2)*Math.pow(p,2)+Math.pow(i,2)*Math.pow(d,2),x=(r.lArcFlag!==r.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(n,2)*Math.pow(i,2)-b)/b)),C=n*p/i*x,P=-i*d/n*x,M=gE([C,P],r.xRot/180*oh);r.cX=M[0]+(t+s)/2,r.cY=M[1]+(e+a)/2,r.phi1=Math.atan2((p-P)/i,(d-C)/n),r.phi2=Math.atan2((-p-P)/i,(-d-C)/n),r.sweepFlag===0&&r.phi2>r.phi1&&(r.phi2-=2*oh),r.sweepFlag===1&&r.phi2<r.phi1&&(r.phi2+=2*oh),r.phi1*=180/oh,r.phi2*=180/oh}function u6(r,t,e){gc(r,t,e);var n=r*r+t*t-e*e;if(0>n)return[];if(n===0)return[[r*e/(r*r+t*t),t*e/(r*r+t*t)]];var i=Math.sqrt(n);return[[(r*e+t*i)/(r*r+t*t),(t*e-r*i)/(r*r+t*t)],[(r*e-t*i)/(r*r+t*t),(t*e+r*i)/(r*r+t*t)]]}var cs,Zu=Math.PI/180;function A6(r,t,e){return(1-e)*r+e*t}function h6(r,t,e,n){return r+Math.cos(n/180*oh)*t+Math.sin(n/180*oh)*e}function d6(r,t,e,n){var i=1e-6,s=t-r,a=e-t,o=3*s+3*(n-e)-6*a,d=6*(a-s),p=3*s;return Math.abs(o)<i?[-p/d]:function(y,b,x){var C=y*y/4-b;if(C<-x)return[];if(C<=x)return[-y/2];var P=Math.sqrt(C);return[-y/2-P,-y/2+P]}(d/o,p/o,i)}function f6(r,t,e,n,i){var s=1-i;return r*(s*s*s)+t*(3*s*s*i)+e*(3*s*i*i)+n*(i*i*i)}(function(r){function t(){return i(function(o,d,p){return o.relative&&(o.x1!==void 0&&(o.x1+=d),o.y1!==void 0&&(o.y1+=p),o.x2!==void 0&&(o.x2+=d),o.y2!==void 0&&(o.y2+=p),o.x!==void 0&&(o.x+=d),o.y!==void 0&&(o.y+=p),o.relative=!1),o})}function e(){var o=NaN,d=NaN,p=NaN,y=NaN;return i(function(b,x,C){return b.type&Me.SMOOTH_CURVE_TO&&(b.type=Me.CURVE_TO,o=isNaN(o)?x:o,d=isNaN(d)?C:d,b.x1=b.relative?x-o:2*x-o,b.y1=b.relative?C-d:2*C-d),b.type&Me.CURVE_TO?(o=b.relative?x+b.x2:b.x2,d=b.relative?C+b.y2:b.y2):(o=NaN,d=NaN),b.type&Me.SMOOTH_QUAD_TO&&(b.type=Me.QUAD_TO,p=isNaN(p)?x:p,y=isNaN(y)?C:y,b.x1=b.relative?x-p:2*x-p,b.y1=b.relative?C-y:2*C-y),b.type&Me.QUAD_TO?(p=b.relative?x+b.x1:b.x1,y=b.relative?C+b.y1:b.y1):(p=NaN,y=NaN),b})}function n(){var o=NaN,d=NaN;return i(function(p,y,b){if(p.type&Me.SMOOTH_QUAD_TO&&(p.type=Me.QUAD_TO,o=isNaN(o)?y:o,d=isNaN(d)?b:d,p.x1=p.relative?y-o:2*y-o,p.y1=p.relative?b-d:2*b-d),p.type&Me.QUAD_TO){o=p.relative?y+p.x1:p.x1,d=p.relative?b+p.y1:p.y1;var x=p.x1,C=p.y1;p.type=Me.CURVE_TO,p.x1=((p.relative?0:y)+2*x)/3,p.y1=((p.relative?0:b)+2*C)/3,p.x2=(p.x+2*x)/3,p.y2=(p.y+2*C)/3}else o=NaN,d=NaN;return p})}function i(o){var d=0,p=0,y=NaN,b=NaN;return function(x){if(isNaN(y)&&!(x.type&Me.MOVE_TO))throw new Error("path must start with moveto");var C=o(x,d,p,y,b);return x.type&Me.CLOSE_PATH&&(d=y,p=b),x.x!==void 0&&(d=x.relative?d+x.x:x.x),x.y!==void 0&&(p=x.relative?p+x.y:x.y),x.type&Me.MOVE_TO&&(y=d,b=p),C}}function s(o,d,p,y,b,x){return gc(o,d,p,y,b,x),i(function(C,P,M,k){var z=C.x1,V=C.x2,$=C.relative&&!isNaN(k),tt=C.x!==void 0?C.x:$?0:P,pt=C.y!==void 0?C.y:$?0:M;function gt(it){return it*it}C.type&Me.HORIZ_LINE_TO&&d!==0&&(C.type=Me.LINE_TO,C.y=C.relative?0:M),C.type&Me.VERT_LINE_TO&&p!==0&&(C.type=Me.LINE_TO,C.x=C.relative?0:P),C.x!==void 0&&(C.x=C.x*o+pt*p+($?0:b)),C.y!==void 0&&(C.y=tt*d+C.y*y+($?0:x)),C.x1!==void 0&&(C.x1=C.x1*o+C.y1*p+($?0:b)),C.y1!==void 0&&(C.y1=z*d+C.y1*y+($?0:x)),C.x2!==void 0&&(C.x2=C.x2*o+C.y2*p+($?0:b)),C.y2!==void 0&&(C.y2=V*d+C.y2*y+($?0:x));var mt=o*y-d*p;if(C.xRot!==void 0&&(o!==1||d!==0||p!==0||y!==1))if(mt===0)delete C.rX,delete C.rY,delete C.xRot,delete C.lArcFlag,delete C.sweepFlag,C.type=Me.LINE_TO;else{var dt=C.xRot*Math.PI/180,Ft=Math.sin(dt),Tt=Math.cos(dt),ot=1/gt(C.rX),ct=1/gt(C.rY),wt=gt(Tt)*ot+gt(Ft)*ct,vt=2*Ft*Tt*(ot-ct),$t=gt(Ft)*ot+gt(Tt)*ct,Wt=wt*y*y-vt*d*y+$t*d*d,Yt=vt*(o*y+d*p)-2*(wt*p*y+$t*o*d),Kt=wt*p*p-vt*o*p+$t*o*o,ee=(Math.atan2(Yt,Wt-Kt)+Math.PI)%Math.PI/2,Zt=Math.sin(ee),we=Math.cos(ee);C.rX=Math.abs(mt)/Math.sqrt(Wt*gt(we)+Yt*Zt*we+Kt*gt(Zt)),C.rY=Math.abs(mt)/Math.sqrt(Wt*gt(Zt)-Yt*Zt*we+Kt*gt(we)),C.xRot=180*ee/Math.PI}return C.sweepFlag!==void 0&&0>mt&&(C.sweepFlag=+!C.sweepFlag),C})}function a(){return function(o){var d={};for(var p in o)d[p]=o[p];return d}}r.ROUND=function(o){function d(p){return Math.round(p*o)/o}return o===void 0&&(o=1e13),gc(o),function(p){return p.x1!==void 0&&(p.x1=d(p.x1)),p.y1!==void 0&&(p.y1=d(p.y1)),p.x2!==void 0&&(p.x2=d(p.x2)),p.y2!==void 0&&(p.y2=d(p.y2)),p.x!==void 0&&(p.x=d(p.x)),p.y!==void 0&&(p.y=d(p.y)),p.rX!==void 0&&(p.rX=d(p.rX)),p.rY!==void 0&&(p.rY=d(p.rY)),p}},r.TO_ABS=t,r.TO_REL=function(){return i(function(o,d,p){return o.relative||(o.x1!==void 0&&(o.x1-=d),o.y1!==void 0&&(o.y1-=p),o.x2!==void 0&&(o.x2-=d),o.y2!==void 0&&(o.y2-=p),o.x!==void 0&&(o.x-=d),o.y!==void 0&&(o.y-=p),o.relative=!0),o})},r.NORMALIZE_HVZ=function(o,d,p){return o===void 0&&(o=!0),d===void 0&&(d=!0),p===void 0&&(p=!0),i(function(y,b,x,C,P){if(isNaN(C)&&!(y.type&Me.MOVE_TO))throw new Error("path must start with moveto");return d&&y.type&Me.HORIZ_LINE_TO&&(y.type=Me.LINE_TO,y.y=y.relative?0:x),p&&y.type&Me.VERT_LINE_TO&&(y.type=Me.LINE_TO,y.x=y.relative?0:b),o&&y.type&Me.CLOSE_PATH&&(y.type=Me.LINE_TO,y.x=y.relative?C-b:C,y.y=y.relative?P-x:P),y.type&Me.ARC&&(y.rX===0||y.rY===0)&&(y.type=Me.LINE_TO,delete y.rX,delete y.rY,delete y.xRot,delete y.lArcFlag,delete y.sweepFlag),y})},r.NORMALIZE_ST=e,r.QT_TO_C=n,r.INFO=i,r.SANITIZE=function(o){o===void 0&&(o=0),gc(o);var d=NaN,p=NaN,y=NaN,b=NaN;return i(function(x,C,P,M,k){var z=Math.abs,V=!1,$=0,tt=0;if(x.type&Me.SMOOTH_CURVE_TO&&($=isNaN(d)?0:C-d,tt=isNaN(p)?0:P-p),x.type&(Me.CURVE_TO|Me.SMOOTH_CURVE_TO)?(d=x.relative?C+x.x2:x.x2,p=x.relative?P+x.y2:x.y2):(d=NaN,p=NaN),x.type&Me.SMOOTH_QUAD_TO?(y=isNaN(y)?C:2*C-y,b=isNaN(b)?P:2*P-b):x.type&Me.QUAD_TO?(y=x.relative?C+x.x1:x.x1,b=x.relative?P+x.y1:x.y2):(y=NaN,b=NaN),x.type&Me.LINE_COMMANDS||x.type&Me.ARC&&(x.rX===0||x.rY===0||!x.lArcFlag)||x.type&Me.CURVE_TO||x.type&Me.SMOOTH_CURVE_TO||x.type&Me.QUAD_TO||x.type&Me.SMOOTH_QUAD_TO){var pt=x.x===void 0?0:x.relative?x.x:x.x-C,gt=x.y===void 0?0:x.relative?x.y:x.y-P;$=isNaN(y)?x.x1===void 0?$:x.relative?x.x:x.x1-C:y-C,tt=isNaN(b)?x.y1===void 0?tt:x.relative?x.y:x.y1-P:b-P;var mt=x.x2===void 0?0:x.relative?x.x:x.x2-C,dt=x.y2===void 0?0:x.relative?x.y:x.y2-P;z(pt)<=o&&z(gt)<=o&&z($)<=o&&z(tt)<=o&&z(mt)<=o&&z(dt)<=o&&(V=!0)}return x.type&Me.CLOSE_PATH&&z(C-M)<=o&&z(P-k)<=o&&(V=!0),V?[]:x})},r.MATRIX=s,r.ROTATE=function(o,d,p){d===void 0&&(d=0),p===void 0&&(p=0),gc(o,d,p);var y=Math.sin(o),b=Math.cos(o);return s(b,y,-y,b,d-d*b+p*y,p-d*y-p*b)},r.TRANSLATE=function(o,d){return d===void 0&&(d=0),gc(o,d),s(1,0,0,1,o,d)},r.SCALE=function(o,d){return d===void 0&&(d=o),gc(o,d),s(o,0,0,d,0,0)},r.SKEW_X=function(o){return gc(o),s(1,0,Math.atan(o),1,0,0)},r.SKEW_Y=function(o){return gc(o),s(1,Math.atan(o),0,1,0,0)},r.X_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),gc(o),s(-1,0,0,1,o,0)},r.Y_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),gc(o),s(1,0,0,-1,0,o)},r.A_TO_C=function(){return i(function(o,d,p){return Me.ARC===o.type?function(y,b,x){var C,P,M,k;y.cX||mE(y,b,x);for(var z=Math.min(y.phi1,y.phi2),V=Math.max(y.phi1,y.phi2)-z,$=Math.ceil(V/90),tt=new Array($),pt=b,gt=x,mt=0;mt<$;mt++){var dt=A6(y.phi1,y.phi2,mt/$),Ft=A6(y.phi1,y.phi2,(mt+1)/$),Tt=Ft-dt,ot=4/3*Math.tan(Tt*Zu/4),ct=[Math.cos(dt*Zu)-ot*Math.sin(dt*Zu),Math.sin(dt*Zu)+ot*Math.cos(dt*Zu)],wt=ct[0],vt=ct[1],$t=[Math.cos(Ft*Zu),Math.sin(Ft*Zu)],Wt=$t[0],Yt=$t[1],Kt=[Wt+ot*Math.sin(Ft*Zu),Yt-ot*Math.cos(Ft*Zu)],ee=Kt[0],Zt=Kt[1];tt[mt]={relative:y.relative,type:Me.CURVE_TO};var we=function(it,xt){var It=gE([it*y.rX,xt*y.rY],y.xRot),Ut=It[0],jt=It[1];return[y.cX+Ut,y.cY+jt]};C=we(wt,vt),tt[mt].x1=C[0],tt[mt].y1=C[1],P=we(ee,Zt),tt[mt].x2=P[0],tt[mt].y2=P[1],M=we(Wt,Yt),tt[mt].x=M[0],tt[mt].y=M[1],y.relative&&(tt[mt].x1-=pt,tt[mt].y1-=gt,tt[mt].x2-=pt,tt[mt].y2-=gt,tt[mt].x-=pt,tt[mt].y-=gt),pt=(k=[tt[mt].x,tt[mt].y])[0],gt=k[1]}return tt}(o,o.relative?0:d,o.relative?0:p):o})},r.ANNOTATE_ARCS=function(){return i(function(o,d,p){return o.relative&&(d=0,p=0),Me.ARC===o.type&&mE(o,d,p),o})},r.CLONE=a,r.CALCULATE_BOUNDS=function(){var o=function(x){var C={};for(var P in x)C[P]=x[P];return C},d=t(),p=n(),y=e(),b=i(function(x,C,P){var M=y(p(d(o(x))));function k(Zt){Zt>b.maxX&&(b.maxX=Zt),Zt<b.minX&&(b.minX=Zt)}function z(Zt){Zt>b.maxY&&(b.maxY=Zt),Zt<b.minY&&(b.minY=Zt)}if(M.type&Me.DRAWING_COMMANDS&&(k(C),z(P)),M.type&Me.HORIZ_LINE_TO&&k(M.x),M.type&Me.VERT_LINE_TO&&z(M.y),M.type&Me.LINE_TO&&(k(M.x),z(M.y)),M.type&Me.CURVE_TO){k(M.x),z(M.y);for(var V=0,$=d6(C,M.x1,M.x2,M.x);V<$.length;V++)0<(ee=$[V])&&1>ee&&k(f6(C,M.x1,M.x2,M.x,ee));for(var tt=0,pt=d6(P,M.y1,M.y2,M.y);tt<pt.length;tt++)0<(ee=pt[tt])&&1>ee&&z(f6(P,M.y1,M.y2,M.y,ee))}if(M.type&Me.ARC){k(M.x),z(M.y),mE(M,C,P);for(var gt=M.xRot/180*Math.PI,mt=Math.cos(gt)*M.rX,dt=Math.sin(gt)*M.rX,Ft=-Math.sin(gt)*M.rY,Tt=Math.cos(gt)*M.rY,ot=M.phi1<M.phi2?[M.phi1,M.phi2]:-180>M.phi2?[M.phi2+360,M.phi1+360]:[M.phi2,M.phi1],ct=ot[0],wt=ot[1],vt=function(Zt){var we=Zt[0],it=Zt[1],xt=180*Math.atan2(it,we)/Math.PI;return xt<ct?xt+360:xt},$t=0,Wt=u6(Ft,-mt,0).map(vt);$t<Wt.length;$t++)(ee=Wt[$t])>ct&&ee<wt&&k(h6(M.cX,mt,Ft,ee));for(var Yt=0,Kt=u6(Tt,-dt,0).map(vt);Yt<Kt.length;Yt++){var ee;(ee=Kt[Yt])>ct&&ee<wt&&z(h6(M.cY,dt,Tt,ee))}}return x});return b.minX=1/0,b.maxX=-1/0,b.minY=1/0,b.maxY=-1/0,b}})(cs||(cs={}));var mc,p6=function(){function r(){}return r.prototype.round=function(t){return this.transform(cs.ROUND(t))},r.prototype.toAbs=function(){return this.transform(cs.TO_ABS())},r.prototype.toRel=function(){return this.transform(cs.TO_REL())},r.prototype.normalizeHVZ=function(t,e,n){return this.transform(cs.NORMALIZE_HVZ(t,e,n))},r.prototype.normalizeST=function(){return this.transform(cs.NORMALIZE_ST())},r.prototype.qtToC=function(){return this.transform(cs.QT_TO_C())},r.prototype.aToC=function(){return this.transform(cs.A_TO_C())},r.prototype.sanitize=function(t){return this.transform(cs.SANITIZE(t))},r.prototype.translate=function(t,e){return this.transform(cs.TRANSLATE(t,e))},r.prototype.scale=function(t,e){return this.transform(cs.SCALE(t,e))},r.prototype.rotate=function(t,e,n){return this.transform(cs.ROTATE(t,e,n))},r.prototype.matrix=function(t,e,n,i,s,a){return this.transform(cs.MATRIX(t,e,n,i,s,a))},r.prototype.skewX=function(t){return this.transform(cs.SKEW_X(t))},r.prototype.skewY=function(t){return this.transform(cs.SKEW_Y(t))},r.prototype.xSymmetry=function(t){return this.transform(cs.X_AXIS_SYMMETRY(t))},r.prototype.ySymmetry=function(t){return this.transform(cs.Y_AXIS_SYMMETRY(t))},r.prototype.annotateArcs=function(){return this.transform(cs.ANNOTATE_ARCS())},r}(),_vt=function(r){return r===" "||r==="	"||r==="\r"||r===`
`},g6=function(r){return 48<=r.charCodeAt(0)&&r.charCodeAt(0)<=57},vvt=function(r){function t(){var e=r.call(this)||this;return e.curNumber="",e.curCommandType=-1,e.curCommandRelative=!1,e.canParseCommandOrComma=!0,e.curNumberHasExp=!1,e.curNumberHasExpDigits=!1,e.curNumberHasDecimal=!1,e.curArgs=[],e}return c6(t,r),t.prototype.finish=function(e){if(e===void 0&&(e=[]),this.parse(" ",e),this.curArgs.length!==0||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return e},t.prototype.parse=function(e,n){var i=this;n===void 0&&(n=[]);for(var s=function(b){n.push(b),i.curArgs.length=0,i.canParseCommandOrComma=!0},a=0;a<e.length;a++){var o=e[a],d=!(this.curCommandType!==Me.ARC||this.curArgs.length!==3&&this.curArgs.length!==4||this.curNumber.length!==1||this.curNumber!=="0"&&this.curNumber!=="1"),p=g6(o)&&(this.curNumber==="0"&&o==="0"||d);if(!g6(o)||p)if(o!=="e"&&o!=="E")if(o!=="-"&&o!=="+"||!this.curNumberHasExp||this.curNumberHasExpDigits)if(o!=="."||this.curNumberHasExp||this.curNumberHasDecimal||d){if(this.curNumber&&this.curCommandType!==-1){var y=Number(this.curNumber);if(isNaN(y))throw new SyntaxError("Invalid number ending at "+a);if(this.curCommandType===Me.ARC){if(this.curArgs.length===0||this.curArgs.length===1){if(0>y)throw new SyntaxError('Expected positive number, got "'+y+'" at index "'+a+'"')}else if((this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber!=="0"&&this.curNumber!=="1")throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+a+'"')}this.curArgs.push(y),this.curArgs.length===bvt[this.curCommandType]&&(Me.HORIZ_LINE_TO===this.curCommandType?s({type:Me.HORIZ_LINE_TO,relative:this.curCommandRelative,x:y}):Me.VERT_LINE_TO===this.curCommandType?s({type:Me.VERT_LINE_TO,relative:this.curCommandRelative,y}):this.curCommandType===Me.MOVE_TO||this.curCommandType===Me.LINE_TO||this.curCommandType===Me.SMOOTH_QUAD_TO?(s({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),Me.MOVE_TO===this.curCommandType&&(this.curCommandType=Me.LINE_TO)):this.curCommandType===Me.CURVE_TO?s({type:Me.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===Me.SMOOTH_CURVE_TO?s({type:Me.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===Me.QUAD_TO?s({type:Me.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===Me.ARC&&s({type:Me.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!_vt(o))if(o===","&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if(o!=="+"&&o!=="-"&&o!==".")if(p)this.curNumber=o,this.curNumberHasDecimal=!1;else{if(this.curArgs.length!==0)throw new SyntaxError("Unterminated command at index "+a+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+o+'" at index '+a+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,o!=="z"&&o!=="Z")if(o==="h"||o==="H")this.curCommandType=Me.HORIZ_LINE_TO,this.curCommandRelative=o==="h";else if(o==="v"||o==="V")this.curCommandType=Me.VERT_LINE_TO,this.curCommandRelative=o==="v";else if(o==="m"||o==="M")this.curCommandType=Me.MOVE_TO,this.curCommandRelative=o==="m";else if(o==="l"||o==="L")this.curCommandType=Me.LINE_TO,this.curCommandRelative=o==="l";else if(o==="c"||o==="C")this.curCommandType=Me.CURVE_TO,this.curCommandRelative=o==="c";else if(o==="s"||o==="S")this.curCommandType=Me.SMOOTH_CURVE_TO,this.curCommandRelative=o==="s";else if(o==="q"||o==="Q")this.curCommandType=Me.QUAD_TO,this.curCommandRelative=o==="q";else if(o==="t"||o==="T")this.curCommandType=Me.SMOOTH_QUAD_TO,this.curCommandRelative=o==="t";else{if(o!=="a"&&o!=="A")throw new SyntaxError('Unexpected character "'+o+'" at index '+a+".");this.curCommandType=Me.ARC,this.curCommandRelative=o==="a"}else n.push({type:Me.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=o,this.curNumberHasDecimal=o==="."}else this.curNumber+=o,this.curNumberHasDecimal=!0;else this.curNumber+=o;else this.curNumber+=o,this.curNumberHasExp=!0;else this.curNumber+=o,this.curNumberHasExpDigits=this.curNumberHasExp}return n},t.prototype.transform=function(e){return Object.create(this,{parse:{value:function(n,i){i===void 0&&(i=[]);for(var s=0,a=Object.getPrototypeOf(this).parse.call(this,n);s<a.length;s++){var o=a[s],d=e(o);Array.isArray(d)?i.push.apply(i,d):i.push(d)}return i}}})},t}(p6),Me=function(r){function t(e){var n=r.call(this)||this;return n.commands=typeof e=="string"?t.parse(e):e,n}return c6(t,r),t.prototype.encode=function(){return t.encode(this.commands)},t.prototype.getBounds=function(){var e=cs.CALCULATE_BOUNDS();return this.transform(e),e},t.prototype.transform=function(e){for(var n=[],i=0,s=this.commands;i<s.length;i++){var a=e(s[i]);Array.isArray(a)?n.push.apply(n,a):n.push(a)}return this.commands=n,this},t.encode=function(e){return yvt(e)},t.parse=function(e){var n=new vvt,i=[];return n.parse(e,i),n.finish(i),i},t.CLOSE_PATH=1,t.MOVE_TO=2,t.HORIZ_LINE_TO=4,t.VERT_LINE_TO=8,t.LINE_TO=16,t.CURVE_TO=32,t.SMOOTH_CURVE_TO=64,t.QUAD_TO=128,t.SMOOTH_QUAD_TO=256,t.ARC=512,t.LINE_COMMANDS=t.LINE_TO|t.HORIZ_LINE_TO|t.VERT_LINE_TO,t.DRAWING_COMMANDS=t.HORIZ_LINE_TO|t.VERT_LINE_TO|t.LINE_TO|t.CURVE_TO|t.SMOOTH_CURVE_TO|t.QUAD_TO|t.SMOOTH_QUAD_TO|t.ARC,t}(p6),bvt=((mc={})[Me.MOVE_TO]=2,mc[Me.LINE_TO]=2,mc[Me.HORIZ_LINE_TO]=1,mc[Me.VERT_LINE_TO]=1,mc[Me.CLOSE_PATH]=0,mc[Me.QUAD_TO]=4,mc[Me.SMOOTH_QUAD_TO]=2,mc[Me.CURVE_TO]=6,mc[Me.SMOOTH_CURVE_TO]=4,mc[Me.ARC]=7,mc),wvt=Ws,xvt=pc,Bvt=Z1,Cvt=JO,m6=RegExp.prototype,Evt=function(r){var t=r.flags;return t===void 0&&!("flags"in m6)&&!xvt(r,"flags")&&Bvt(m6,r)?wvt(Cvt,r):t},Svt=o_.PROPER,Tvt=gd,Ivt=No,y6=nu,Fvt=Ji,Lvt=Evt,yE="toString",_6=RegExp.prototype,v6=_6[yE],Pvt=Fvt(function(){return v6.call({source:"a",flags:"b"})!=="/a/b"}),Mvt=Svt&&v6.name!==yE;(Pvt||Mvt)&&Tvt(_6,yE,function(){var r=Ivt(this),t=y6(r.source),e=y6(Lvt(r));return"/"+t+"/"+e},{unsafe:!0});function N_(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?N_=function(t){return typeof t}:N_=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N_(r)}function Uvt(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Rvt=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],Ovt=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function Dvt(r,t,e,n,i){if(typeof r=="string"&&(r=document.getElementById(r)),!r||N_(r)!=="object"||!("getContext"in r))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var s=r.getContext("2d");try{return s.getImageData(t,e,n,i)}catch(a){throw new Error("unable to access image data: "+a)}}function Nvt(r,t,e,n,i,s){if(!(isNaN(s)||s<1)){s|=0;var a=Dvt(r,t,e,n,i);a=kvt(a,t,e,n,i,s),r.getContext("2d").putImageData(a,t,e)}}function kvt(r,t,e,n,i,s){for(var a=r.data,o=2*s+1,d=n-1,p=i-1,y=s+1,b=y*(y+1)/2,x=new b6,C=x,P,M=1;M<o;M++)C=C.next=new b6,M===y&&(P=C);C.next=x;for(var k=null,z=null,V=0,$=0,tt=Rvt[s],pt=Ovt[s],gt=0;gt<i;gt++){C=x;for(var mt=a[$],dt=a[$+1],Ft=a[$+2],Tt=a[$+3],ot=0;ot<y;ot++)C.r=mt,C.g=dt,C.b=Ft,C.a=Tt,C=C.next;for(var ct=0,wt=0,vt=0,$t=0,Wt=y*mt,Yt=y*dt,Kt=y*Ft,ee=y*Tt,Zt=b*mt,we=b*dt,it=b*Ft,xt=b*Tt,It=1;It<y;It++){var Ut=$+((d<It?d:It)<<2),jt=a[Ut],Vt=a[Ut+1],re=a[Ut+2],te=a[Ut+3],Ce=y-It;Zt+=(C.r=jt)*Ce,we+=(C.g=Vt)*Ce,it+=(C.b=re)*Ce,xt+=(C.a=te)*Ce,ct+=jt,wt+=Vt,vt+=re,$t+=te,C=C.next}k=x,z=P;for(var Te=0;Te<n;Te++){var De=xt*tt>>>pt;if(a[$+3]=De,De!==0){var Qe=255/De;a[$]=(Zt*tt>>>pt)*Qe,a[$+1]=(we*tt>>>pt)*Qe,a[$+2]=(it*tt>>>pt)*Qe}else a[$]=a[$+1]=a[$+2]=0;Zt-=Wt,we-=Yt,it-=Kt,xt-=ee,Wt-=k.r,Yt-=k.g,Kt-=k.b,ee-=k.a;var Je=Te+s+1;Je=V+(Je<d?Je:d)<<2,ct+=k.r=a[Je],wt+=k.g=a[Je+1],vt+=k.b=a[Je+2],$t+=k.a=a[Je+3],Zt+=ct,we+=wt,it+=vt,xt+=$t,k=k.next;var he=z,st=he.r,fr=he.g,er=he.b,de=he.a;Wt+=st,Yt+=fr,Kt+=er,ee+=de,ct-=st,wt-=fr,vt-=er,$t-=de,z=z.next,$+=4}V+=n}for(var ve=0;ve<n;ve++){$=ve<<2;var Le=a[$],Ue=a[$+1],Ye=a[$+2],lr=a[$+3],yr=y*Le,Lr=y*Ue,Dr=y*Ye,pe=y*lr,cr=b*Le,_r=b*Ue,Re=b*Ye,An=b*lr;C=x;for(var me=0;me<y;me++)C.r=Le,C.g=Ue,C.b=Ye,C.a=lr,C=C.next;for(var gr=n,Ne=0,Ur=0,_n=0,ke=0,Qn=1;Qn<=s;Qn++){$=gr+ve<<2;var nn=y-Qn;cr+=(C.r=Le=a[$])*nn,_r+=(C.g=Ue=a[$+1])*nn,Re+=(C.b=Ye=a[$+2])*nn,An+=(C.a=lr=a[$+3])*nn,ke+=Le,Ne+=Ue,Ur+=Ye,_n+=lr,C=C.next,Qn<p&&(gr+=n)}$=ve,k=x,z=P;for(var vn=0;vn<i;vn++){var ln=$<<2;a[ln+3]=lr=An*tt>>>pt,lr>0?(lr=255/lr,a[ln]=(cr*tt>>>pt)*lr,a[ln+1]=(_r*tt>>>pt)*lr,a[ln+2]=(Re*tt>>>pt)*lr):a[ln]=a[ln+1]=a[ln+2]=0,cr-=yr,_r-=Lr,Re-=Dr,An-=pe,yr-=k.r,Lr-=k.g,Dr-=k.b,pe-=k.a,ln=ve+((ln=vn+y)<p?ln:p)*n<<2,cr+=ke+=k.r=a[ln],_r+=Ne+=k.g=a[ln+1],Re+=Ur+=k.b=a[ln+2],An+=_n+=k.a=a[ln+3],k=k.next,yr+=Le=z.r,Lr+=Ue=z.g,Dr+=Ye=z.b,pe+=lr=z.a,ke-=Le,Ne-=Ue,Ur-=Ye,_n-=lr,z=z.next,$+=n}}return r}var b6=function r(){Uvt(this,r),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};function Qvt(){var{DOMParser:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:r,createCanvas(e,n){return new OffscreenCanvas(e,n)},createImage(e){return Ju(function*(){var n=yield fetch(e),i=yield n.blob(),s=yield createImageBitmap(i);return s})()}};return(typeof DOMParser<"u"||typeof r>"u")&&Reflect.deleteProperty(t,"DOMParser"),t}function zvt(r){var{DOMParser:t,canvas:e,fetch:n}=r;return{window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:t,fetch:n,createCanvas:e.createCanvas,createImage:e.loadImage}}var Hvt=Object.freeze({__proto__:null,offscreen:Qvt,node:zvt});function bd(r){return r.replace(/(?!\u3000)\s+/gm," ")}function w6(r){return r.replace(/^[\n \t]+/,"")}function x6(r){return r.replace(/[\n \t]+$/,"")}function ua(r){var t=(r||"").match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm)||[];return t.map(parseFloat)}var Vvt=/^[A-Z-]+$/;function B6(r){return Vvt.test(r)?r.toLowerCase():r}function _E(r){var t=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(r)||[];return t[2]||t[3]||t[4]}function C6(r){if(!r.startsWith("rgb"))return r;var t=3,e=r.replace(/\d+(\.\d+)?/g,(n,i)=>t--&&i?String(Math.round(parseFloat(n))):n);return e}var Gvt=/(\[[^\]]+\])/g,jvt=/(#[^\s+>~.[:]+)/g,qvt=/(\.[^\s+>~.[:]+)/g,Kvt=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,$vt=/(:[\w-]+\([^)]*\))/gi,Wvt=/(:[^\s+>~.[:]+)/g,Xvt=/([^\s+>~.[:]+)/g;function wd(r,t){var e=t.exec(r);return e?[r.replace(t," "),e.length]:[r,0]}function E6(r){var t=[0,0,0],e=r.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),n=0;return[e,n]=wd(e,Gvt),t[1]+=n,[e,n]=wd(e,jvt),t[0]+=n,[e,n]=wd(e,qvt),t[1]+=n,[e,n]=wd(e,Kvt),t[2]+=n,[e,n]=wd(e,$vt),t[1]+=n,[e,n]=wd(e,Wvt),t[1]+=n,e=e.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),[e,n]=wd(e,Xvt),t[2]+=n,t.join("")}var xd=1e-8;function vE(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2))}function k_(r,t){return(r[0]*t[0]+r[1]*t[1])/(vE(r)*vE(t))}function bE(r,t){return(r[0]*t[1]<r[1]*t[0]?-1:1)*Math.acos(k_(r,t))}function wE(r){return r*r*r}function xE(r){return 3*r*r*(1-r)}function BE(r){return 3*r*(1-r)*(1-r)}function CE(r){return(1-r)*(1-r)*(1-r)}function EE(r){return r*r}function SE(r){return 2*r*(1-r)}function TE(r){return(1-r)*(1-r)}class Or{constructor(t,e,n){this.document=t,this.name=e,this.value=n,this.isNormalizedColor=!1}static empty(t){return new Or(t,"EMPTY","")}split(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:" ",{document:e,name:n}=this;return bd(this.getString()).trim().split(t).map(i=>new Or(e,n,i))}hasValue(t){var{value:e}=this;return e!==null&&e!==""&&(t||e!==0)&&typeof e<"u"}isString(t){var{value:e}=this,n=typeof e=="string";return!n||!t?n:t.test(e)}isUrlDefinition(){return this.isString(/^url\(/)}isPixels(){if(!this.hasValue())return!1;var t=this.getString();switch(!0){case t.endsWith("px"):case/^[0-9]+$/.test(t):return!0;default:return!1}}setValue(t){return this.value=t,this}getValue(t){return typeof t>"u"||this.hasValue()?this.value:t}getNumber(t){if(!this.hasValue())return typeof t>"u"?0:parseFloat(t);var{value:e}=this,n=parseFloat(e);return this.isString(/%$/)&&(n/=100),n}getString(t){return typeof t>"u"||this.hasValue()?typeof this.value>"u"?"":String(this.value):String(t)}getColor(t){var e=this.getString(t);return this.isNormalizedColor||(this.isNormalizedColor=!0,e=C6(e),this.value=e),e}getDpi(){return 96}getRem(){return this.document.rootEmSize}getEm(){return this.document.emSize}getUnits(){return this.getString().replace(/[0-9.-]/g,"")}getPixels(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!this.hasValue())return 0;var[n,i]=typeof t=="boolean"?[void 0,t]:[t],{viewPort:s}=this.document.screen;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(s.computeSize("x"),s.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(s.computeSize("x"),s.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*s.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*s.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return this.getNumber()*15;case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case(this.isString(/%$/)&&i):return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*s.computeSize(n);default:{var a=this.getNumber();return e&&a<1?a*s.computeSize(n):a}}}getMilliseconds(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():this.getNumber()*1e3:0}getRadians(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}getDefinition(){var t=this.getString(),e=/#([^)'"]+)/.exec(t);return e&&(e=e[1]),e||(e=t),this.document.definitions[e]}getFillStyleDefinition(t,e){var n=this.getDefinition();if(!n)return null;if(typeof n.createGradient=="function")return n.createGradient(this.document.ctx,t,e);if(typeof n.createPattern=="function"){if(n.getHrefAttribute().hasValue()){var i=n.getAttribute("patternTransform");n=n.getHrefAttribute().getDefinition(),i.hasValue()&&n.getAttribute("patternTransform",!0).setValue(i.value)}return n.createPattern(this.document.ctx,t,e)}return null}getTextBaseline(){return this.hasValue()?Or.textBaselineMapping[this.getString()]:null}addOpacity(t){for(var e=this.getColor(),n=e.length,i=0,s=0;s<n&&(e[s]===","&&i++,i!==3);s++);if(t.hasValue()&&this.isString()&&i!==3){var a=new fE(e);a.ok&&(a.alpha=t.getNumber(),e=a.toRGBA())}return new Or(this.document,this.name,e)}}Or.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};class S6{constructor(){this.viewPorts=[]}clear(){this.viewPorts=[]}setCurrent(t,e){this.viewPorts.push({width:t,height:e})}removeCurrent(){this.viewPorts.pop()}getCurrent(){var{viewPorts:t}=this;return t[t.length-1]}get width(){return this.getCurrent().width}get height(){return this.getCurrent().height}computeSize(t){return typeof t=="number"?t:t==="x"?this.width:t==="y"?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}}class zi{constructor(t,e){this.x=t,this.y=e}static parse(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,[n=e,i=e]=ua(t);return new zi(n,i)}static parseScale(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,[n=e,i=n]=ua(t);return new zi(n,i)}static parsePath(t){for(var e=ua(t),n=e.length,i=[],s=0;s<n;s+=2)i.push(new zi(e[s],e[s+1]));return i}angleTo(t){return Math.atan2(t.y-this.y,t.x-this.x)}applyTransform(t){var{x:e,y:n}=this,i=e*t[0]+n*t[2]+t[4],s=e*t[1]+n*t[3]+t[5];this.x=i,this.y=s}}class T6{constructor(t){this.screen=t,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}isWorking(){return this.working}start(){if(!this.working){var{screen:t,onClick:e,onMouseMove:n}=this,i=t.ctx.canvas;i.onclick=e,i.onmousemove=n,this.working=!0}}stop(){if(this.working){var t=this.screen.ctx.canvas;this.working=!1,t.onclick=null,t.onmousemove=null}}hasEvents(){return this.working&&this.events.length>0}runEvents(){if(this.working){var{screen:t,events:e,eventElements:n}=this,{style:i}=t.ctx.canvas;i&&(i.cursor=""),e.forEach((s,a)=>{for(var{run:o}=s,d=n[a];d;)o(d),d=d.parent}),this.events=[],this.eventElements=[]}}checkPath(t,e){if(!(!this.working||!e)){var{events:n,eventElements:i}=this;n.forEach((s,a)=>{var{x:o,y:d}=s;!i[a]&&e.isPointInPath&&e.isPointInPath(o,d)&&(i[a]=t)})}}checkBoundingBox(t,e){if(!(!this.working||!e)){var{events:n,eventElements:i}=this;n.forEach((s,a)=>{var{x:o,y:d}=s;!i[a]&&e.isPointInBox(o,d)&&(i[a]=t)})}}mapXY(t,e){for(var{window:n,ctx:i}=this.screen,s=new zi(t,e),a=i.canvas;a;)s.x-=a.offsetLeft,s.y-=a.offsetTop,a=a.offsetParent;return n.scrollX&&(s.x+=n.scrollX),n.scrollY&&(s.y+=n.scrollY),s}onClick(t){var{x:e,y:n}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onclick",x:e,y:n,run(i){i.onClick&&i.onClick()}})}onMouseMove(t){var{x:e,y:n}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onmousemove",x:e,y:n,run(i){i.onMouseMove&&i.onMouseMove()}})}}var I6=typeof window<"u"?window:null,F6=typeof fetch<"u"?fetch.bind(void 0):null;class Dm{constructor(t){var{fetch:e=F6,window:n=I6}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.ctx=t,this.FRAMERATE=30,this.MAX_VIRTUAL_PIXELS=3e4,this.CLIENT_WIDTH=800,this.CLIENT_HEIGHT=600,this.viewPort=new S6,this.mouse=new T6(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=n,this.fetch=e}wait(t){this.waits.push(t)}ready(){return this.readyPromise?this.readyPromise:Promise.resolve()}isReady(){if(this.isReadyLock)return!0;var t=this.waits.every(e=>e());return t&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=t,t}setDefaults(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4}setViewBox(t){var{document:e,ctx:n,aspectRatio:i,width:s,desiredWidth:a,height:o,desiredHeight:d,minX:p=0,minY:y=0,refX:b,refY:x,clip:C=!1,clipX:P=0,clipY:M=0}=t,k=bd(i).replace(/^defer\s/,""),[z,V]=k.split(" "),$=z||"xMidYMid",tt=V||"meet",pt=s/a,gt=o/d,mt=Math.min(pt,gt),dt=Math.max(pt,gt),Ft=a,Tt=d;tt==="meet"&&(Ft*=mt,Tt*=mt),tt==="slice"&&(Ft*=dt,Tt*=dt);var ot=new Or(e,"refX",b),ct=new Or(e,"refY",x),wt=ot.hasValue()&&ct.hasValue();if(wt&&n.translate(-mt*ot.getPixels("x"),-mt*ct.getPixels("y")),C){var vt=mt*P,$t=mt*M;n.beginPath(),n.moveTo(vt,$t),n.lineTo(s,$t),n.lineTo(s,o),n.lineTo(vt,o),n.closePath(),n.clip()}if(!wt){var Wt=tt==="meet"&&mt===gt,Yt=tt==="slice"&&dt===gt,Kt=tt==="meet"&&mt===pt,ee=tt==="slice"&&dt===pt;$.startsWith("xMid")&&(Wt||Yt)&&n.translate(s/2-Ft/2,0),$.endsWith("YMid")&&(Kt||ee)&&n.translate(0,o/2-Tt/2),$.startsWith("xMax")&&(Wt||Yt)&&n.translate(s-Ft,0),$.endsWith("YMax")&&(Kt||ee)&&n.translate(0,o-Tt)}switch(!0){case $==="none":n.scale(pt,gt);break;case tt==="meet":n.scale(mt,mt);break;case tt==="slice":n.scale(dt,dt);break}n.translate(-p,-y)}start(t){var{enableRedraw:e=!1,ignoreMouse:n=!1,ignoreAnimation:i=!1,ignoreDimensions:s=!1,ignoreClear:a=!1,forceRedraw:o,scaleWidth:d,scaleHeight:p,offsetX:y,offsetY:b}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{FRAMERATE:x,mouse:C}=this,P=1e3/x;if(this.frameDuration=P,this.readyPromise=new Promise($=>{this.resolveReady=$}),this.isReady()&&this.render(t,s,a,d,p,y,b),!!e){var M=Date.now(),k=M,z=0,V=()=>{M=Date.now(),z=M-k,z>=P&&(k=M-z%P,this.shouldUpdate(i,o)&&(this.render(t,s,a,d,p,y,b),C.runEvents())),this.intervalId=AE(V)};n||C.start(),this.intervalId=AE(V)}}stop(){this.intervalId&&(AE.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}shouldUpdate(t,e){if(!t){var{frameDuration:n}=this,i=this.animations.reduce((s,a)=>a.update(n)||s,!1);if(i)return!0}return!!(typeof e=="function"&&e()||!this.isReadyLock&&this.isReady()||this.mouse.hasEvents())}render(t,e,n,i,s,a,o){var{CLIENT_WIDTH:d,CLIENT_HEIGHT:p,viewPort:y,ctx:b,isFirstRender:x}=this,C=b.canvas;y.clear(),C.width&&C.height?y.setCurrent(C.width,C.height):y.setCurrent(d,p);var P=t.getStyle("width"),M=t.getStyle("height");!e&&(x||typeof i!="number"&&typeof s!="number")&&(P.hasValue()&&(C.width=P.getPixels("x"),C.style&&(C.style.width="".concat(C.width,"px"))),M.hasValue()&&(C.height=M.getPixels("y"),C.style&&(C.style.height="".concat(C.height,"px"))));var k=C.clientWidth||C.width,z=C.clientHeight||C.height;if(e&&P.hasValue()&&M.hasValue()&&(k=P.getPixels("x"),z=M.getPixels("y")),y.setCurrent(k,z),typeof a=="number"&&t.getAttribute("x",!0).setValue(a),typeof o=="number"&&t.getAttribute("y",!0).setValue(o),typeof i=="number"||typeof s=="number"){var V=ua(t.getAttribute("viewBox").getString()),$=0,tt=0;if(typeof i=="number"){var pt=t.getStyle("width");pt.hasValue()?$=pt.getPixels("x")/i:isNaN(V[2])||($=V[2]/i)}if(typeof s=="number"){var gt=t.getStyle("height");gt.hasValue()?tt=gt.getPixels("y")/s:isNaN(V[3])||(tt=V[3]/s)}$||($=tt),tt||(tt=$),t.getAttribute("width",!0).setValue(i),t.getAttribute("height",!0).setValue(s);var mt=t.getStyle("transform",!0,!0);mt.setValue("".concat(mt.getString()," scale(").concat(1/$,", ").concat(1/tt,")"))}n||b.clearRect(0,0,k,z),t.render(b),x&&(this.isFirstRender=!1)}}Dm.defaultWindow=I6,Dm.defaultFetch=F6;var{defaultFetch:Jvt}=Dm,Yvt=typeof DOMParser<"u"?DOMParser:null;class Q_{constructor(){var{fetch:t=Jvt,DOMParser:e=Yvt}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fetch=t,this.DOMParser=e}parse(t){var e=this;return Ju(function*(){return t.startsWith("<")?e.parseFromString(t):e.load(t)})()}parseFromString(t){var e=new this.DOMParser;try{return this.checkDocument(e.parseFromString(t,"image/svg+xml"))}catch{return this.checkDocument(e.parseFromString(t,"text/xml"))}}checkDocument(t){var e=t.getElementsByTagName("parsererror")[0];if(e)throw new Error(e.textContent);return t}load(t){var e=this;return Ju(function*(){var n=yield e.fetch(t),i=yield n.text();return e.parseFromString(i)})()}}class L6{constructor(t,e){this.type="translate",this.point=null,this.point=zi.parse(e)}apply(t){var{x:e,y:n}=this.point;t.translate(e||0,n||0)}unapply(t){var{x:e,y:n}=this.point;t.translate(-1*e||0,-1*n||0)}applyToPoint(t){var{x:e,y:n}=this.point;t.applyTransform([1,0,0,1,e||0,n||0])}}class P6{constructor(t,e,n){this.type="rotate",this.angle=null,this.originX=null,this.originY=null,this.cx=0,this.cy=0;var i=ua(e);this.angle=new Or(t,"angle",i[0]),this.originX=n[0],this.originY=n[1],this.cx=i[1]||0,this.cy=i[2]||0}apply(t){var{cx:e,cy:n,originX:i,originY:s,angle:a}=this,o=e+i.getPixels("x"),d=n+s.getPixels("y");t.translate(o,d),t.rotate(a.getRadians()),t.translate(-o,-d)}unapply(t){var{cx:e,cy:n,originX:i,originY:s,angle:a}=this,o=e+i.getPixels("x"),d=n+s.getPixels("y");t.translate(o,d),t.rotate(-1*a.getRadians()),t.translate(-o,-d)}applyToPoint(t){var{cx:e,cy:n,angle:i}=this,s=i.getRadians();t.applyTransform([1,0,0,1,e||0,n||0]),t.applyTransform([Math.cos(s),Math.sin(s),-Math.sin(s),Math.cos(s),0,0]),t.applyTransform([1,0,0,1,-e||0,-n||0])}}class M6{constructor(t,e,n){this.type="scale",this.scale=null,this.originX=null,this.originY=null;var i=zi.parseScale(e);(i.x===0||i.y===0)&&(i.x=xd,i.y=xd),this.scale=i,this.originX=n[0],this.originY=n[1]}apply(t){var{scale:{x:e,y:n},originX:i,originY:s}=this,a=i.getPixels("x"),o=s.getPixels("y");t.translate(a,o),t.scale(e,n||e),t.translate(-a,-o)}unapply(t){var{scale:{x:e,y:n},originX:i,originY:s}=this,a=i.getPixels("x"),o=s.getPixels("y");t.translate(a,o),t.scale(1/e,1/n||e),t.translate(-a,-o)}applyToPoint(t){var{x:e,y:n}=this.scale;t.applyTransform([e||0,0,0,n||0,0,0])}}class IE{constructor(t,e,n){this.type="matrix",this.matrix=[],this.originX=null,this.originY=null,this.matrix=ua(e),this.originX=n[0],this.originY=n[1]}apply(t){var{originX:e,originY:n,matrix:i}=this,s=e.getPixels("x"),a=n.getPixels("y");t.translate(s,a),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),t.translate(-s,-a)}unapply(t){var{originX:e,originY:n,matrix:i}=this,s=i[0],a=i[2],o=i[4],d=i[1],p=i[3],y=i[5],b=0,x=0,C=1,P=1/(s*(p*C-y*x)-a*(d*C-y*b)+o*(d*x-p*b)),M=e.getPixels("x"),k=n.getPixels("y");t.translate(M,k),t.transform(P*(p*C-y*x),P*(y*b-d*C),P*(o*x-a*C),P*(s*C-o*b),P*(a*y-o*p),P*(o*d-s*y)),t.translate(-M,-k)}applyToPoint(t){t.applyTransform(this.matrix)}}class FE extends IE{constructor(t,e,n){super(t,e,n),this.type="skew",this.angle=null,this.angle=new Or(t,"angle",e)}}class U6 extends FE{constructor(t,e,n){super(t,e,n),this.type="skewX",this.matrix=[1,0,Math.tan(this.angle.getRadians()),1,0,0]}}class R6 extends FE{constructor(t,e,n){super(t,e,n),this.type="skewY",this.matrix=[1,Math.tan(this.angle.getRadians()),0,1,0,0]}}function Zvt(r){return bd(r).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)}function tbt(r){var[t,e]=r.split("(");return[t.trim(),e.trim().replace(")","")]}class ah{constructor(t,e,n){this.document=t,this.transforms=[];var i=Zvt(e);i.forEach(s=>{if(s!=="none"){var[a,o]=tbt(s),d=ah.transformTypes[a];typeof d<"u"&&this.transforms.push(new d(this.document,o,n))}})}static fromElement(t,e){var n=e.getStyle("transform",!1,!0),[i,s=i]=e.getStyle("transform-origin",!1,!0).split(),a=[i,s];return n.hasValue()?new ah(t,n.getString(),a):null}apply(t){for(var{transforms:e}=this,n=e.length,i=0;i<n;i++)e[i].apply(t)}unapply(t){for(var{transforms:e}=this,n=e.length,i=n-1;i>=0;i--)e[i].unapply(t)}applyToPoint(t){for(var{transforms:e}=this,n=e.length,i=0;i<n;i++)e[i].applyToPoint(t)}}ah.transformTypes={translate:L6,rotate:P6,scale:M6,matrix:IE,skewX:U6,skewY:R6};class _i{constructor(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.document=t,this.node=e,this.captureTextNodes=n,this.attributes={},this.styles={},this.stylesSpecificity={},this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],!(!e||e.nodeType!==1)){if(Array.from(e.attributes).forEach(o=>{var d=B6(o.nodeName);this.attributes[d]=new Or(t,d,o.value)}),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()){var i=this.getAttribute("style").getString().split(";").map(o=>o.trim());i.forEach(o=>{if(o){var[d,p]=o.split(":").map(y=>y.trim());this.styles[d]=new Or(t,d,p)}})}var{definitions:s}=t,a=this.getAttribute("id");a.hasValue()&&(s[a.getString()]||(s[a.getString()]=this)),Array.from(e.childNodes).forEach(o=>{if(o.nodeType===1)this.addChild(o);else if(n&&(o.nodeType===3||o.nodeType===4)){var d=t.createTextNode(o);d.getText().length>0&&this.addChild(d)}})}}getAttribute(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this.attributes[t];if(!n&&e){var i=new Or(this.document,t,"");return this.attributes[t]=i,i}return n||Or.empty(this.document)}getHrefAttribute(){for(var t in this.attributes)if(t==="href"||t.endsWith(":href"))return this.attributes[t];return Or.empty(this.document)}getStyle(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.styles[t];if(i)return i;var s=this.getAttribute(t);if(s!=null&&s.hasValue())return this.styles[t]=s,s;if(!n){var{parent:a}=this;if(a){var o=a.getStyle(t);if(o!=null&&o.hasValue())return o}}if(e){var d=new Or(this.document,t,"");return this.styles[t]=d,d}return i||Or.empty(this.document)}render(t){if(!(this.getStyle("display").getString()==="none"||this.getStyle("visibility").getString()==="hidden")){if(t.save(),this.getStyle("mask").hasValue()){var e=this.getStyle("mask").getDefinition();e&&(this.applyEffects(t),e.apply(t,this))}else if(this.getStyle("filter").getValue("none")!=="none"){var n=this.getStyle("filter").getDefinition();n&&(this.applyEffects(t),n.apply(t,this))}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}}setContext(t){}applyEffects(t){var e=ah.fromElement(this.document,this);e&&e.apply(t);var n=this.getStyle("clip-path",!1,!0);if(n.hasValue()){var i=n.getDefinition();i&&i.apply(t)}}clearContext(t){}renderChildren(t){this.children.forEach(e=>{e.render(t)})}addChild(t){var e=t instanceof _i?t:this.document.createElement(t);e.parent=this,_i.ignoreChildTypes.includes(e.type)||this.children.push(e)}matchesSelector(t){var e,{node:n}=this;if(typeof n.matches=="function")return n.matches(t);var i=(e=n.getAttribute)===null||e===void 0?void 0:e.call(n,"class");return!i||i===""?!1:i.split(" ").some(s=>".".concat(s)===t)}addStylesFromStyleDefinition(){var{styles:t,stylesSpecificity:e}=this.document;for(var n in t)if(!n.startsWith("@")&&this.matchesSelector(n)){var i=t[n],s=e[n];if(i)for(var a in i){var o=this.stylesSpecificity[a];typeof o>"u"&&(o="000"),s>=o&&(this.styles[a]=i[a],this.stylesSpecificity[a]=s)}}}removeStyles(t,e){var n=e.reduce((i,s)=>{var a=t.getStyle(s);if(!a.hasValue())return i;var o=a.getString();return a.setValue(""),[...i,[s,o]]},[]);return n}restoreStyles(t,e){e.forEach(n=>{var[i,s]=n;t.getStyle(i,!0).setValue(s)})}isFirstChild(){var t;return((t=this.parent)===null||t===void 0?void 0:t.children.indexOf(this))===0}}_i.ignoreChildTypes=["title"];class O6 extends _i{constructor(t,e,n){super(t,e,n)}}function ebt(r){var t=r.trim();return/^('|")/.test(t)?t:'"'.concat(t,'"')}function rbt(r){return typeof process>"u"?r:r.trim().split(",").map(ebt).join(",")}function nbt(r){if(!r)return"";var t=r.trim().toLowerCase();switch(t){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return t;default:return/^oblique\s+(-|)\d+deg$/.test(t)?t:""}}function ibt(r){if(!r)return"";var t=r.trim().toLowerCase();switch(t){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return t;default:return/^[\d.]+$/.test(t)?t:""}}class mo{constructor(t,e,n,i,s,a){var o=a?typeof a=="string"?mo.parse(a):a:{};this.fontFamily=s||o.fontFamily,this.fontSize=i||o.fontSize,this.fontStyle=t||o.fontStyle,this.fontWeight=n||o.fontWeight,this.fontVariant=e||o.fontVariant}static parse(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n="",i="",s="",a="",o="",d=bd(t).trim().split(" "),p={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return d.forEach(y=>{switch(!0){case(!p.fontStyle&&mo.styles.includes(y)):y!=="inherit"&&(n=y),p.fontStyle=!0;break;case(!p.fontVariant&&mo.variants.includes(y)):y!=="inherit"&&(i=y),p.fontStyle=!0,p.fontVariant=!0;break;case(!p.fontWeight&&mo.weights.includes(y)):y!=="inherit"&&(s=y),p.fontStyle=!0,p.fontVariant=!0,p.fontWeight=!0;break;case!p.fontSize:y!=="inherit"&&([a]=y.split("/")),p.fontStyle=!0,p.fontVariant=!0,p.fontWeight=!0,p.fontSize=!0;break;default:y!=="inherit"&&(o+=y)}}),new mo(n,i,s,a,o,e)}toString(){return[nbt(this.fontStyle),this.fontVariant,ibt(this.fontWeight),this.fontSize,rbt(this.fontFamily)].join(" ").trim()}}mo.styles="normal|italic|oblique|inherit",mo.variants="normal|small-caps|inherit",mo.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";class yl{constructor(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.NaN,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.NaN,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Number.NaN,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Number.NaN;this.x1=t,this.y1=e,this.x2=n,this.y2=i,this.addPoint(t,e),this.addPoint(n,i)}get x(){return this.x1}get y(){return this.y1}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}addPoint(t,e){typeof t<"u"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),typeof e<"u"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))}addX(t){this.addPoint(t,null)}addY(t){this.addPoint(null,t)}addBoundingBox(t){if(t){var{x1:e,y1:n,x2:i,y2:s}=t;this.addPoint(e,n),this.addPoint(i,s)}}sumCubic(t,e,n,i,s){return Math.pow(1-t,3)*e+3*Math.pow(1-t,2)*t*n+3*(1-t)*Math.pow(t,2)*i+Math.pow(t,3)*s}bezierCurveAdd(t,e,n,i,s){var a=6*e-12*n+6*i,o=-3*e+9*n-9*i+3*s,d=3*n-3*e;if(o===0){if(a===0)return;var p=-d/a;0<p&&p<1&&(t?this.addX(this.sumCubic(p,e,n,i,s)):this.addY(this.sumCubic(p,e,n,i,s)));return}var y=Math.pow(a,2)-4*d*o;if(!(y<0)){var b=(-a+Math.sqrt(y))/(2*o);0<b&&b<1&&(t?this.addX(this.sumCubic(b,e,n,i,s)):this.addY(this.sumCubic(b,e,n,i,s)));var x=(-a-Math.sqrt(y))/(2*o);0<x&&x<1&&(t?this.addX(this.sumCubic(x,e,n,i,s)):this.addY(this.sumCubic(x,e,n,i,s)))}}addBezierCurve(t,e,n,i,s,a,o,d){this.addPoint(t,e),this.addPoint(o,d),this.bezierCurveAdd(!0,t,n,s,o),this.bezierCurveAdd(!1,e,i,a,d)}addQuadraticCurve(t,e,n,i,s,a){var o=t+.6666666666666666*(n-t),d=e+2/3*(i-e),p=o+1/3*(s-t),y=d+1/3*(a-e);this.addBezierCurve(t,e,o,p,d,y,s,a)}isPointInBox(t,e){var{x1:n,y1:i,x2:s,y2:a}=this;return n<=t&&t<=s&&i<=e&&e<=a}}class rn extends Me{constructor(t){super(t.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,"")),this.control=null,this.start=null,this.current=null,this.command=null,this.commands=this.commands,this.i=-1,this.previousCommand=null,this.points=[],this.angles=[]}reset(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new zi(0,0),this.control=new zi(0,0),this.current=new zi(0,0),this.points=[],this.angles=[]}isEnd(){var{i:t,commands:e}=this;return t>=e.length-1}next(){var t=this.commands[++this.i];return this.previousCommand=this.command,this.command=t,t}getPoint(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"x",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"y",n=new zi(this.command[t],this.command[e]);return this.makeAbsolute(n)}getAsControlPoint(t,e){var n=this.getPoint(t,e);return this.control=n,n}getAsCurrentPoint(t,e){var n=this.getPoint(t,e);return this.current=n,n}getReflectedControlPoint(){var t=this.previousCommand.type;if(t!==Me.CURVE_TO&&t!==Me.SMOOTH_CURVE_TO&&t!==Me.QUAD_TO&&t!==Me.SMOOTH_QUAD_TO)return this.current;var{current:{x:e,y:n},control:{x:i,y:s}}=this,a=new zi(2*e-i,2*n-s);return a}makeAbsolute(t){if(this.command.relative){var{x:e,y:n}=this.current;t.x+=e,t.y+=n}return t}addMarker(t,e,n){var{points:i,angles:s}=this;n&&s.length>0&&!s[s.length-1]&&(s[s.length-1]=i[i.length-1].angleTo(n)),this.addMarkerAngle(t,e?e.angleTo(t):null)}addMarkerAngle(t,e){this.points.push(t),this.angles.push(e)}getMarkerPoints(){return this.points}getMarkerAngles(){for(var{angles:t}=this,e=t.length,n=0;n<e;n++)if(!t[n]){for(var i=n+1;i<e;i++)if(t[i]){t[n]=t[i];break}}return t}}class lh extends _i{constructor(){super(...arguments),this.modifiedEmSizeStack=!1}calculateOpacity(){for(var t=1,e=this;e;){var n=e.getStyle("opacity",!1,!0);n.hasValue(!0)&&(t*=n.getNumber()),e=e.parent}return t}setContext(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!e){var n=this.getStyle("fill"),i=this.getStyle("fill-opacity"),s=this.getStyle("stroke"),a=this.getStyle("stroke-opacity");if(n.isUrlDefinition()){var o=n.getFillStyleDefinition(this,i);o&&(t.fillStyle=o)}else if(n.hasValue()){n.getString()==="currentColor"&&n.setValue(this.getStyle("color").getColor());var d=n.getColor();d!=="inherit"&&(t.fillStyle=d==="none"?"rgba(0,0,0,0)":d)}if(i.hasValue()){var p=new Or(this.document,"fill",t.fillStyle).addOpacity(i).getColor();t.fillStyle=p}if(s.isUrlDefinition()){var y=s.getFillStyleDefinition(this,a);y&&(t.strokeStyle=y)}else if(s.hasValue()){s.getString()==="currentColor"&&s.setValue(this.getStyle("color").getColor());var b=s.getString();b!=="inherit"&&(t.strokeStyle=b==="none"?"rgba(0,0,0,0)":b)}if(a.hasValue()){var x=new Or(this.document,"stroke",t.strokeStyle).addOpacity(a).getString();t.strokeStyle=x}var C=this.getStyle("stroke-width");if(C.hasValue()){var P=C.getPixels();t.lineWidth=P||xd}var M=this.getStyle("stroke-linecap"),k=this.getStyle("stroke-linejoin"),z=this.getStyle("stroke-miterlimit"),V=this.getStyle("stroke-dasharray"),$=this.getStyle("stroke-dashoffset");if(M.hasValue()&&(t.lineCap=M.getString()),k.hasValue()&&(t.lineJoin=k.getString()),z.hasValue()&&(t.miterLimit=z.getNumber()),V.hasValue()&&V.getString()!=="none"){var tt=ua(V.getString());typeof t.setLineDash<"u"?t.setLineDash(tt):typeof t.webkitLineDash<"u"?t.webkitLineDash=tt:typeof t.mozDash<"u"&&!(tt.length===1&&tt[0]===0)&&(t.mozDash=tt);var pt=$.getPixels();typeof t.lineDashOffset<"u"?t.lineDashOffset=pt:typeof t.webkitLineDashOffset<"u"?t.webkitLineDashOffset=pt:typeof t.mozDashOffset<"u"&&(t.mozDashOffset=pt)}}if(this.modifiedEmSizeStack=!1,typeof t.font<"u"){var gt=this.getStyle("font"),mt=this.getStyle("font-style"),dt=this.getStyle("font-variant"),Ft=this.getStyle("font-weight"),Tt=this.getStyle("font-size"),ot=this.getStyle("font-family"),ct=new mo(mt.getString(),dt.getString(),Ft.getString(),Tt.hasValue()?"".concat(Tt.getPixels(!0),"px"):"",ot.getString(),mo.parse(gt.getString(),t.font));mt.setValue(ct.fontStyle),dt.setValue(ct.fontVariant),Ft.setValue(ct.fontWeight),Tt.setValue(ct.fontSize),ot.setValue(ct.fontFamily),t.font=ct.toString(),Tt.isPixels()&&(this.document.emSize=Tt.getPixels(),this.modifiedEmSizeStack=!0)}e||(this.applyEffects(t),t.globalAlpha=this.calculateOpacity())}clearContext(t){super.clearContext(t),this.modifiedEmSizeStack&&this.document.popEmSize()}}class $n extends lh{constructor(t,e,n){super(t,e,n),this.type="path",this.pathParser=null,this.pathParser=new rn(this.getAttribute("d").getString())}path(t){var{pathParser:e}=this,n=new yl;for(e.reset(),t&&t.beginPath();!e.isEnd();)switch(e.next().type){case rn.MOVE_TO:this.pathM(t,n);break;case rn.LINE_TO:this.pathL(t,n);break;case rn.HORIZ_LINE_TO:this.pathH(t,n);break;case rn.VERT_LINE_TO:this.pathV(t,n);break;case rn.CURVE_TO:this.pathC(t,n);break;case rn.SMOOTH_CURVE_TO:this.pathS(t,n);break;case rn.QUAD_TO:this.pathQ(t,n);break;case rn.SMOOTH_QUAD_TO:this.pathT(t,n);break;case rn.ARC:this.pathA(t,n);break;case rn.CLOSE_PATH:this.pathZ(t,n);break}return n}getBoundingBox(t){return this.path()}getMarkers(){var{pathParser:t}=this,e=t.getMarkerPoints(),n=t.getMarkerAngles(),i=e.map((s,a)=>[s,n[a]]);return i}renderChildren(t){this.path(t),this.document.screen.mouse.checkPath(this,t);var e=this.getStyle("fill-rule");t.fillStyle!==""&&(e.getString("inherit")!=="inherit"?t.fill(e.getString()):t.fill()),t.strokeStyle!==""&&(this.getAttribute("vector-effect").getString()==="non-scaling-stroke"?(t.save(),t.setTransform(1,0,0,1,0,0),t.stroke(),t.restore()):t.stroke());var n=this.getMarkers();if(n){var i=n.length-1,s=this.getStyle("marker-start"),a=this.getStyle("marker-mid"),o=this.getStyle("marker-end");if(s.isUrlDefinition()){var d=s.getDefinition(),[p,y]=n[0];d.render(t,p,y)}if(a.isUrlDefinition())for(var b=a.getDefinition(),x=1;x<i;x++){var[C,P]=n[x];b.render(t,C,P)}if(o.isUrlDefinition()){var M=o.getDefinition(),[k,z]=n[i];M.render(t,k,z)}}}static pathM(t){var e=t.getAsCurrentPoint();return t.start=t.current,{point:e}}pathM(t,e){var{pathParser:n}=this,{point:i}=$n.pathM(n),{x:s,y:a}=i;n.addMarker(i),e.addPoint(s,a),t&&t.moveTo(s,a)}static pathL(t){var{current:e}=t,n=t.getAsCurrentPoint();return{current:e,point:n}}pathL(t,e){var{pathParser:n}=this,{current:i,point:s}=$n.pathL(n),{x:a,y:o}=s;n.addMarker(s,i),e.addPoint(a,o),t&&t.lineTo(a,o)}static pathH(t){var{current:e,command:n}=t,i=new zi((n.relative?e.x:0)+n.x,e.y);return t.current=i,{current:e,point:i}}pathH(t,e){var{pathParser:n}=this,{current:i,point:s}=$n.pathH(n),{x:a,y:o}=s;n.addMarker(s,i),e.addPoint(a,o),t&&t.lineTo(a,o)}static pathV(t){var{current:e,command:n}=t,i=new zi(e.x,(n.relative?e.y:0)+n.y);return t.current=i,{current:e,point:i}}pathV(t,e){var{pathParser:n}=this,{current:i,point:s}=$n.pathV(n),{x:a,y:o}=s;n.addMarker(s,i),e.addPoint(a,o),t&&t.lineTo(a,o)}static pathC(t){var{current:e}=t,n=t.getPoint("x1","y1"),i=t.getAsControlPoint("x2","y2"),s=t.getAsCurrentPoint();return{current:e,point:n,controlPoint:i,currentPoint:s}}pathC(t,e){var{pathParser:n}=this,{current:i,point:s,controlPoint:a,currentPoint:o}=$n.pathC(n);n.addMarker(o,a,s),e.addBezierCurve(i.x,i.y,s.x,s.y,a.x,a.y,o.x,o.y),t&&t.bezierCurveTo(s.x,s.y,a.x,a.y,o.x,o.y)}static pathS(t){var{current:e}=t,n=t.getReflectedControlPoint(),i=t.getAsControlPoint("x2","y2"),s=t.getAsCurrentPoint();return{current:e,point:n,controlPoint:i,currentPoint:s}}pathS(t,e){var{pathParser:n}=this,{current:i,point:s,controlPoint:a,currentPoint:o}=$n.pathS(n);n.addMarker(o,a,s),e.addBezierCurve(i.x,i.y,s.x,s.y,a.x,a.y,o.x,o.y),t&&t.bezierCurveTo(s.x,s.y,a.x,a.y,o.x,o.y)}static pathQ(t){var{current:e}=t,n=t.getAsControlPoint("x1","y1"),i=t.getAsCurrentPoint();return{current:e,controlPoint:n,currentPoint:i}}pathQ(t,e){var{pathParser:n}=this,{current:i,controlPoint:s,currentPoint:a}=$n.pathQ(n);n.addMarker(a,s,s),e.addQuadraticCurve(i.x,i.y,s.x,s.y,a.x,a.y),t&&t.quadraticCurveTo(s.x,s.y,a.x,a.y)}static pathT(t){var{current:e}=t,n=t.getReflectedControlPoint();t.control=n;var i=t.getAsCurrentPoint();return{current:e,controlPoint:n,currentPoint:i}}pathT(t,e){var{pathParser:n}=this,{current:i,controlPoint:s,currentPoint:a}=$n.pathT(n);n.addMarker(a,s,s),e.addQuadraticCurve(i.x,i.y,s.x,s.y,a.x,a.y),t&&t.quadraticCurveTo(s.x,s.y,a.x,a.y)}static pathA(t){var{current:e,command:n}=t,{rX:i,rY:s,xRot:a,lArcFlag:o,sweepFlag:d}=n,p=a*(Math.PI/180),y=t.getAsCurrentPoint(),b=new zi(Math.cos(p)*(e.x-y.x)/2+Math.sin(p)*(e.y-y.y)/2,-Math.sin(p)*(e.x-y.x)/2+Math.cos(p)*(e.y-y.y)/2),x=Math.pow(b.x,2)/Math.pow(i,2)+Math.pow(b.y,2)/Math.pow(s,2);x>1&&(i*=Math.sqrt(x),s*=Math.sqrt(x));var C=(o===d?-1:1)*Math.sqrt((Math.pow(i,2)*Math.pow(s,2)-Math.pow(i,2)*Math.pow(b.y,2)-Math.pow(s,2)*Math.pow(b.x,2))/(Math.pow(i,2)*Math.pow(b.y,2)+Math.pow(s,2)*Math.pow(b.x,2)));isNaN(C)&&(C=0);var P=new zi(C*i*b.y/s,C*-s*b.x/i),M=new zi((e.x+y.x)/2+Math.cos(p)*P.x-Math.sin(p)*P.y,(e.y+y.y)/2+Math.sin(p)*P.x+Math.cos(p)*P.y),k=bE([1,0],[(b.x-P.x)/i,(b.y-P.y)/s]),z=[(b.x-P.x)/i,(b.y-P.y)/s],V=[(-b.x-P.x)/i,(-b.y-P.y)/s],$=bE(z,V);return k_(z,V)<=-1&&($=Math.PI),k_(z,V)>=1&&($=0),{currentPoint:y,rX:i,rY:s,sweepFlag:d,xAxisRotation:p,centp:M,a1:k,ad:$}}pathA(t,e){var{pathParser:n}=this,{currentPoint:i,rX:s,rY:a,sweepFlag:o,xAxisRotation:d,centp:p,a1:y,ad:b}=$n.pathA(n),x=1-o?1:-1,C=y+x*(b/2),P=new zi(p.x+s*Math.cos(C),p.y+a*Math.sin(C));if(n.addMarkerAngle(P,C-x*Math.PI/2),n.addMarkerAngle(i,C-x*Math.PI),e.addPoint(i.x,i.y),t&&!isNaN(y)&&!isNaN(b)){var M=s>a?s:a,k=s>a?1:s/a,z=s>a?a/s:1;t.translate(p.x,p.y),t.rotate(d),t.scale(k,z),t.arc(0,0,M,y,y+b,!!(1-o)),t.scale(1/k,1/z),t.rotate(-d),t.translate(-p.x,-p.y)}}static pathZ(t){t.current=t.start}pathZ(t,e){$n.pathZ(this.pathParser),t&&e.x1!==e.x2&&e.y1!==e.y2&&t.closePath()}}class LE extends $n{constructor(t,e,n){super(t,e,n),this.type="glyph",this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber(),this.unicode=this.getAttribute("unicode").getString(),this.arabicForm=this.getAttribute("arabic-form").getString()}}class tA extends lh{constructor(t,e,n){super(t,e,new.target===tA?!0:n),this.type="text",this.x=0,this.y=0,this.measureCache=-1}setContext(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.setContext(t,e);var n=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();n&&(t.textBaseline=n)}initializeCoordinates(){this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY}getBoundingBox(t){if(this.type!=="text")return this.getTElementBoundingBox(t);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t);var e=null;return this.children.forEach((n,i)=>{var s=this.getChildBoundingBox(t,this,this,i);e?e.addBoundingBox(s):e=s}),e}getFontSize(){var{document:t,parent:e}=this,n=mo.parse(t.ctx.font).fontSize,i=e.getStyle("font-size").getNumber(n);return i}getTElementBoundingBox(t){var e=this.getFontSize();return new yl(this.x,this.y-e,this.x+this.measureText(t),this.y)}getGlyph(t,e,n){var i=e[n],s=null;if(t.isArabic){var a=e.length,o=e[n-1],d=e[n+1],p="isolated";if((n===0||o===" ")&&n<a-1&&d!==" "&&(p="terminal"),n>0&&o!==" "&&n<a-1&&d!==" "&&(p="medial"),n>0&&o!==" "&&(n===a-1||d===" ")&&(p="initial"),typeof t.glyphs[i]<"u"){var y=t.glyphs[i];s=y instanceof LE?y:y[p]}}else s=t.glyphs[i];return s||(s=t.missingGlyph),s}getText(){return""}getTextFromNode(t){var e=t||this.node,n=Array.from(e.parentNode.childNodes),i=n.indexOf(e),s=n.length-1,a=bd(e.textContent||"");return i===0&&(a=w6(a)),i===s&&(a=x6(a)),a}renderChildren(t){if(this.type!=="text"){this.renderTElementChildren(t);return}this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t),this.children.forEach((n,i)=>{this.renderChild(t,this,this,i)});var{mouse:e}=this.document.screen;e.isWorking()&&e.checkBoundingBox(this,this.getBoundingBox(t))}renderTElementChildren(t){var{document:e,parent:n}=this,i=this.getText(),s=n.getStyle("font-family").getDefinition();if(s){for(var{unitsPerEm:a}=s.fontFace,o=mo.parse(e.ctx.font),d=n.getStyle("font-size").getNumber(o.fontSize),p=n.getStyle("font-style").getString(o.fontStyle),y=d/a,b=s.isRTL?i.split("").reverse().join(""):i,x=ua(n.getAttribute("dx").getString()),C=b.length,P=0;P<C;P++){var M=this.getGlyph(s,b,P);t.translate(this.x,this.y),t.scale(y,-y);var k=t.lineWidth;t.lineWidth=t.lineWidth*a/d,p==="italic"&&t.transform(1,0,.4,1,0,0),M.render(t),p==="italic"&&t.transform(1,0,-.4,1,0,0),t.lineWidth=k,t.scale(1/y,-1/y),t.translate(-this.x,-this.y),this.x+=d*(M.horizAdvX||s.horizAdvX)/a,typeof x[P]<"u"&&!isNaN(x[P])&&(this.x+=x[P])}return}var{x:z,y:V}=this;t.fillStyle&&t.fillText(i,z,V),t.strokeStyle&&t.strokeText(i,z,V)}applyAnchoring(){if(!(this.textChunkStart>=this.leafTexts.length)){var t=this.leafTexts[this.textChunkStart],e=t.getStyle("text-anchor").getString("start"),n=!1,i=0;e==="start"&&!n||e==="end"&&n?i=t.x-this.minX:e==="end"&&!n||e==="start"&&n?i=t.x-this.maxX:i=t.x-(this.minX+this.maxX)/2;for(var s=this.textChunkStart;s<this.leafTexts.length;s++)this.leafTexts[s].x+=i;this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.textChunkStart=this.leafTexts.length}}adjustChildCoordinatesRecursive(t){this.children.forEach((e,n)=>{this.adjustChildCoordinatesRecursiveCore(t,this,this,n)}),this.applyAnchoring()}adjustChildCoordinatesRecursiveCore(t,e,n,i){var s=n.children[i];s.children.length>0?s.children.forEach((a,o)=>{e.adjustChildCoordinatesRecursiveCore(t,e,s,o)}):this.adjustChildCoordinates(t,e,n,i)}adjustChildCoordinates(t,e,n,i){var s=n.children[i];if(typeof s.measureText!="function")return s;t.save(),s.setContext(t,!0);var a=s.getAttribute("x"),o=s.getAttribute("y"),d=s.getAttribute("dx"),p=s.getAttribute("dy"),y=s.getStyle("font-family").getDefinition(),b=!!y&&y.isRTL;i===0&&(a.hasValue()||a.setValue(s.getInheritedAttribute("x")),o.hasValue()||o.setValue(s.getInheritedAttribute("y")),d.hasValue()||d.setValue(s.getInheritedAttribute("dx")),p.hasValue()||p.setValue(s.getInheritedAttribute("dy")));var x=s.measureText(t);return b&&(e.x-=x),a.hasValue()?(e.applyAnchoring(),s.x=a.getPixels("x"),d.hasValue()&&(s.x+=d.getPixels("x"))):(d.hasValue()&&(e.x+=d.getPixels("x")),s.x=e.x),e.x=s.x,b||(e.x+=x),o.hasValue()?(s.y=o.getPixels("y"),p.hasValue()&&(s.y+=p.getPixels("y"))):(p.hasValue()&&(e.y+=p.getPixels("y")),s.y=e.y),e.y=s.y,e.leafTexts.push(s),e.minX=Math.min(e.minX,s.x,s.x+x),e.maxX=Math.max(e.maxX,s.x,s.x+x),s.clearContext(t),t.restore(),s}getChildBoundingBox(t,e,n,i){var s=n.children[i];if(typeof s.getBoundingBox!="function")return null;var a=s.getBoundingBox(t);return a?(s.children.forEach((o,d)=>{var p=e.getChildBoundingBox(t,e,s,d);a.addBoundingBox(p)}),a):null}renderChild(t,e,n,i){var s=n.children[i];s.render(t),s.children.forEach((a,o)=>{e.renderChild(t,e,s,o)})}measureText(t){var{measureCache:e}=this;if(~e)return e;var n=this.getText(),i=this.measureTargetText(t,n);return this.measureCache=i,i}measureTargetText(t,e){if(!e.length)return 0;var{parent:n}=this,i=n.getStyle("font-family").getDefinition();if(i){for(var s=this.getFontSize(),a=i.isRTL?e.split("").reverse().join(""):e,o=ua(n.getAttribute("dx").getString()),d=a.length,p=0,y=0;y<d;y++){var b=this.getGlyph(i,a,y);p+=(b.horizAdvX||i.horizAdvX)*s/i.fontFace.unitsPerEm,typeof o[y]<"u"&&!isNaN(o[y])&&(p+=o[y])}return p}if(!t.measureText)return e.length*10;t.save(),this.setContext(t,!0);var{width:x}=t.measureText(e);return this.clearContext(t),t.restore(),x}getInheritedAttribute(t){for(var e=this;e instanceof tA&&e.isFirstChild();){var n=e.parent.getAttribute(t);if(n.hasValue(!0))return n.getValue("0");e=e.parent}return null}}class Nm extends tA{constructor(t,e,n){super(t,e,new.target===Nm?!0:n),this.type="tspan",this.text=this.children.length>0?"":this.getTextFromNode()}getText(){return this.text}}class sbt extends Nm{constructor(){super(...arguments),this.type="textNode"}}class _p extends lh{constructor(){super(...arguments),this.type="svg",this.root=!1}setContext(t){var e,{document:n}=this,{screen:i,window:s}=n,a=t.canvas;if(i.setDefaults(t),a.style&&typeof t.font<"u"&&s&&typeof s.getComputedStyle<"u"){t.font=s.getComputedStyle(a).getPropertyValue("font");var o=new Or(n,"fontSize",mo.parse(t.font).fontSize);o.hasValue()&&(n.rootEmSize=o.getPixels("y"),n.emSize=n.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);var{width:d,height:p}=i.viewPort;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");var y=this.getAttribute("refX"),b=this.getAttribute("refY"),x=this.getAttribute("viewBox"),C=x.hasValue()?ua(x.getString()):null,P=!this.root&&this.getStyle("overflow").getValue("hidden")!=="visible",M=0,k=0,z=0,V=0;C&&(M=C[0],k=C[1]),this.root||(d=this.getStyle("width").getPixels("x"),p=this.getStyle("height").getPixels("y"),this.type==="marker"&&(z=M,V=k,M=0,k=0)),i.viewPort.setCurrent(d,p),this.node&&(!this.parent||((e=this.node.parentNode)===null||e===void 0?void 0:e.nodeName)==="foreignObject")&&this.getStyle("transform",!1,!0).hasValue()&&!this.getStyle("transform-origin",!1,!0).hasValue()&&this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),super.setContext(t),t.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),C&&(d=C[2],p=C[3]),n.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:i.viewPort.width,desiredWidth:d,height:i.viewPort.height,desiredHeight:p,minX:M,minY:k,refX:y.getValue(),refY:b.getValue(),clip:P,clipX:z,clipY:V}),C&&(i.viewPort.removeCurrent(),i.viewPort.setCurrent(d,p))}clearContext(t){super.clearContext(t),this.document.screen.viewPort.removeCurrent()}resize(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getAttribute("width",!0),s=this.getAttribute("height",!0),a=this.getAttribute("viewBox"),o=this.getAttribute("style"),d=i.getNumber(0),p=s.getNumber(0);if(n)if(typeof n=="string")this.getAttribute("preserveAspectRatio",!0).setValue(n);else{var y=this.getAttribute("preserveAspectRatio");y.hasValue()&&y.setValue(y.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(i.setValue(t),s.setValue(e),a.hasValue()||a.setValue("0 0 ".concat(d||t," ").concat(p||e)),o.hasValue()){var b=this.getStyle("width"),x=this.getStyle("height");b.hasValue()&&b.setValue("".concat(t,"px")),x.hasValue()&&x.setValue("".concat(e,"px"))}}}class PE extends $n{constructor(){super(...arguments),this.type="rect"}path(t){var e=this.getAttribute("x").getPixels("x"),n=this.getAttribute("y").getPixels("y"),i=this.getStyle("width",!1,!0).getPixels("x"),s=this.getStyle("height",!1,!0).getPixels("y"),a=this.getAttribute("rx"),o=this.getAttribute("ry"),d=a.getPixels("x"),p=o.getPixels("y");if(a.hasValue()&&!o.hasValue()&&(p=d),o.hasValue()&&!a.hasValue()&&(d=p),d=Math.min(d,i/2),p=Math.min(p,s/2),t){var y=4*((Math.sqrt(2)-1)/3);t.beginPath(),s>0&&i>0&&(t.moveTo(e+d,n),t.lineTo(e+i-d,n),t.bezierCurveTo(e+i-d+y*d,n,e+i,n+p-y*p,e+i,n+p),t.lineTo(e+i,n+s-p),t.bezierCurveTo(e+i,n+s-p+y*p,e+i-d+y*d,n+s,e+i-d,n+s),t.lineTo(e+d,n+s),t.bezierCurveTo(e+d-y*d,n+s,e,n+s-p+y*p,e,n+s-p),t.lineTo(e,n+p),t.bezierCurveTo(e,n+p-y*p,e+d-y*d,n,e+d,n),t.closePath())}return new yl(e,n,e+i,n+s)}getMarkers(){return null}}class D6 extends $n{constructor(){super(...arguments),this.type="circle"}path(t){var e=this.getAttribute("cx").getPixels("x"),n=this.getAttribute("cy").getPixels("y"),i=this.getAttribute("r").getPixels();return t&&i>0&&(t.beginPath(),t.arc(e,n,i,0,Math.PI*2,!1),t.closePath()),new yl(e-i,n-i,e+i,n+i)}getMarkers(){return null}}class N6 extends $n{constructor(){super(...arguments),this.type="ellipse"}path(t){var e=4*((Math.sqrt(2)-1)/3),n=this.getAttribute("rx").getPixels("x"),i=this.getAttribute("ry").getPixels("y"),s=this.getAttribute("cx").getPixels("x"),a=this.getAttribute("cy").getPixels("y");return t&&n>0&&i>0&&(t.beginPath(),t.moveTo(s+n,a),t.bezierCurveTo(s+n,a+e*i,s+e*n,a+i,s,a+i),t.bezierCurveTo(s-e*n,a+i,s-n,a+e*i,s-n,a),t.bezierCurveTo(s-n,a-e*i,s-e*n,a-i,s,a-i),t.bezierCurveTo(s+e*n,a-i,s+n,a-e*i,s+n,a),t.closePath()),new yl(s-n,a-i,s+n,a+i)}getMarkers(){return null}}class k6 extends $n{constructor(){super(...arguments),this.type="line"}getPoints(){return[new zi(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new zi(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}path(t){var[{x:e,y:n},{x:i,y:s}]=this.getPoints();return t&&(t.beginPath(),t.moveTo(e,n),t.lineTo(i,s)),new yl(e,n,i,s)}getMarkers(){var[t,e]=this.getPoints(),n=t.angleTo(e);return[[t,n],[e,n]]}}class ME extends $n{constructor(t,e,n){super(t,e,n),this.type="polyline",this.points=[],this.points=zi.parsePath(this.getAttribute("points").getString())}path(t){var{points:e}=this,[{x:n,y:i}]=e,s=new yl(n,i);return t&&(t.beginPath(),t.moveTo(n,i)),e.forEach(a=>{var{x:o,y:d}=a;s.addPoint(o,d),t&&t.lineTo(o,d)}),s}getMarkers(){var{points:t}=this,e=t.length-1,n=[];return t.forEach((i,s)=>{s!==e&&n.push([i,i.angleTo(t[s+1])])}),n.length>0&&n.push([t[t.length-1],n[n.length-1][1]]),n}}class Q6 extends ME{constructor(){super(...arguments),this.type="polygon"}path(t){var e=super.path(t),[{x:n,y:i}]=this.points;return t&&(t.lineTo(n,i),t.closePath()),e}}class z6 extends _i{constructor(){super(...arguments),this.type="pattern"}createPattern(t,e,n){var i=this.getStyle("width").getPixels("x",!0),s=this.getStyle("height").getPixels("y",!0),a=new _p(this.document,null);a.attributes.viewBox=new Or(this.document,"viewBox",this.getAttribute("viewBox").getValue()),a.attributes.width=new Or(this.document,"width","".concat(i,"px")),a.attributes.height=new Or(this.document,"height","".concat(s,"px")),a.attributes.transform=new Or(this.document,"transform",this.getAttribute("patternTransform").getValue()),a.children=this.children;var o=this.document.createCanvas(i,s),d=o.getContext("2d"),p=this.getAttribute("x"),y=this.getAttribute("y");p.hasValue()&&y.hasValue()&&d.translate(p.getPixels("x",!0),y.getPixels("y",!0)),n.hasValue()?this.styles["fill-opacity"]=n:Reflect.deleteProperty(this.styles,"fill-opacity");for(var b=-1;b<=1;b++)for(var x=-1;x<=1;x++)d.save(),a.attributes.x=new Or(this.document,"x",b*o.width),a.attributes.y=new Or(this.document,"y",x*o.height),a.render(d),d.restore();var C=t.createPattern(o,"repeat");return C}}class H6 extends _i{constructor(){super(...arguments),this.type="marker"}render(t,e,n){if(e){var{x:i,y:s}=e,a=this.getAttribute("orient").getString("auto"),o=this.getAttribute("markerUnits").getString("strokeWidth");t.translate(i,s),a==="auto"&&t.rotate(n),o==="strokeWidth"&&t.scale(t.lineWidth,t.lineWidth),t.save();var d=new _p(this.document,null);d.type=this.type,d.attributes.viewBox=new Or(this.document,"viewBox",this.getAttribute("viewBox").getValue()),d.attributes.refX=new Or(this.document,"refX",this.getAttribute("refX").getValue()),d.attributes.refY=new Or(this.document,"refY",this.getAttribute("refY").getValue()),d.attributes.width=new Or(this.document,"width",this.getAttribute("markerWidth").getValue()),d.attributes.height=new Or(this.document,"height",this.getAttribute("markerHeight").getValue()),d.attributes.overflow=new Or(this.document,"overflow",this.getAttribute("overflow").getValue()),d.attributes.fill=new Or(this.document,"fill",this.getAttribute("fill").getColor("black")),d.attributes.stroke=new Or(this.document,"stroke",this.getAttribute("stroke").getValue("none")),d.children=this.children,d.render(t),t.restore(),o==="strokeWidth"&&t.scale(1/t.lineWidth,1/t.lineWidth),a==="auto"&&t.rotate(-n),t.translate(-i,-s)}}}class V6 extends _i{constructor(){super(...arguments),this.type="defs"}render(){}}class z_ extends lh{constructor(){super(...arguments),this.type="g"}getBoundingBox(t){var e=new yl;return this.children.forEach(n=>{e.addBoundingBox(n.getBoundingBox(t))}),e}}class UE extends _i{constructor(t,e,n){super(t,e,n),this.attributesToInherit=["gradientUnits"],this.stops=[];var{stops:i,children:s}=this;s.forEach(a=>{a.type==="stop"&&i.push(a)})}getGradientUnits(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}createGradient(t,e,n){var i=this;this.getHrefAttribute().hasValue()&&(i=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(i));var{stops:s}=i,a=this.getGradient(t,e);if(!a)return this.addParentOpacity(n,s[s.length-1].color);if(s.forEach(k=>{a.addColorStop(k.offset,this.addParentOpacity(n,k.color))}),this.getAttribute("gradientTransform").hasValue()){var{document:o}=this,{MAX_VIRTUAL_PIXELS:d,viewPort:p}=o.screen,[y]=p.viewPorts,b=new PE(o,null);b.attributes.x=new Or(o,"x",-d/3),b.attributes.y=new Or(o,"y",-d/3),b.attributes.width=new Or(o,"width",d),b.attributes.height=new Or(o,"height",d);var x=new z_(o,null);x.attributes.transform=new Or(o,"transform",this.getAttribute("gradientTransform").getValue()),x.children=[b];var C=new _p(o,null);C.attributes.x=new Or(o,"x",0),C.attributes.y=new Or(o,"y",0),C.attributes.width=new Or(o,"width",y.width),C.attributes.height=new Or(o,"height",y.height),C.children=[x];var P=o.createCanvas(y.width,y.height),M=P.getContext("2d");return M.fillStyle=a,C.render(M),M.createPattern(P,"no-repeat")}return a}inheritStopContainer(t){this.attributesToInherit.forEach(e=>{!this.getAttribute(e).hasValue()&&t.getAttribute(e).hasValue()&&this.getAttribute(e,!0).setValue(t.getAttribute(e).getValue())})}addParentOpacity(t,e){if(t.hasValue()){var n=new Or(this.document,"color",e);return n.addOpacity(t).getColor()}return e}}class G6 extends UE{constructor(t,e,n){super(t,e,n),this.type="linearGradient",this.attributesToInherit.push("x1","y1","x2","y2")}getGradient(t,e){var n=this.getGradientUnits()==="objectBoundingBox",i=n?e.getBoundingBox(t):null;if(n&&!i)return null;!this.getAttribute("x1").hasValue()&&!this.getAttribute("y1").hasValue()&&!this.getAttribute("x2").hasValue()&&!this.getAttribute("y2").hasValue()&&(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));var s=n?i.x+i.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),a=n?i.y+i.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),o=n?i.x+i.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),d=n?i.y+i.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return s===o&&a===d?null:t.createLinearGradient(s,a,o,d)}}class j6 extends UE{constructor(t,e,n){super(t,e,n),this.type="radialGradient",this.attributesToInherit.push("cx","cy","r","fx","fy","fr")}getGradient(t,e){var n=this.getGradientUnits()==="objectBoundingBox",i=e.getBoundingBox(t);if(n&&!i)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");var s=n?i.x+i.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),a=n?i.y+i.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y"),o=s,d=a;this.getAttribute("fx").hasValue()&&(o=n?i.x+i.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(d=n?i.y+i.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));var p=n?(i.width+i.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),y=this.getAttribute("fr").getPixels();return t.createRadialGradient(o,d,y,s,a,p)}}class q6 extends _i{constructor(t,e,n){super(t,e,n),this.type="stop";var i=Math.max(0,Math.min(1,this.getAttribute("offset").getNumber())),s=this.getStyle("stop-opacity"),a=this.getStyle("stop-color",!0);a.getString()===""&&a.setValue("#000"),s.hasValue()&&(a=a.addOpacity(s)),this.offset=i,this.color=a.getColor()}}class H_ extends _i{constructor(t,e,n){super(t,e,n),this.type="animate",this.duration=0,this.initialValue=null,this.initialUnits="",this.removed=!1,this.frozen=!1,t.screen.animations.push(this),this.begin=this.getAttribute("begin").getMilliseconds(),this.maxDuration=this.begin+this.getAttribute("dur").getMilliseconds(),this.from=this.getAttribute("from"),this.to=this.getAttribute("to"),this.values=new Or(t,"values",null);var i=this.getAttribute("values");i.hasValue()&&this.values.setValue(i.getString().split(";"))}getProperty(){var t=this.getAttribute("attributeType").getString(),e=this.getAttribute("attributeName").getString();return t==="CSS"?this.parent.getStyle(e,!0):this.parent.getAttribute(e,!0)}calcValue(){var{initialUnits:t}=this,{progress:e,from:n,to:i}=this.getProgress(),s=n.getNumber()+(i.getNumber()-n.getNumber())*e;return t==="%"&&(s*=100),"".concat(s).concat(t)}update(t){var{parent:e}=this,n=this.getProperty();if(this.initialValue||(this.initialValue=n.getString(),this.initialUnits=n.getUnits()),this.duration>this.maxDuration){var i=this.getAttribute("fill").getString("remove");if(this.getAttribute("repeatCount").getString()==="indefinite"||this.getAttribute("repeatDur").getString()==="indefinite")this.duration=0;else if(i==="freeze"&&!this.frozen)this.frozen=!0,e.animationFrozen=!0,e.animationFrozenValue=n.getString();else if(i==="remove"&&!this.removed)return this.removed=!0,n.setValue(e.animationFrozen?e.animationFrozenValue:this.initialValue),!0;return!1}this.duration+=t;var s=!1;if(this.begin<this.duration){var a=this.calcValue(),o=this.getAttribute("type");if(o.hasValue()){var d=o.getString();a="".concat(d,"(").concat(a,")")}n.setValue(a),s=!0}return s}getProgress(){var{document:t,values:e}=this,n={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(e.hasValue()){var i=n.progress*(e.getValue().length-1),s=Math.floor(i),a=Math.ceil(i);n.from=new Or(t,"from",parseFloat(e.getValue()[s])),n.to=new Or(t,"to",parseFloat(e.getValue()[a])),n.progress=(i-s)/(a-s)}else n.from=this.from,n.to=this.to;return n}}class K6 extends H_{constructor(){super(...arguments),this.type="animateColor"}calcValue(){var{progress:t,from:e,to:n}=this.getProgress(),i=new fE(e.getColor()),s=new fE(n.getColor());if(i.ok&&s.ok){var a=i.r+(s.r-i.r)*t,o=i.g+(s.g-i.g)*t,d=i.b+(s.b-i.b)*t;return"rgb(".concat(Math.floor(a),", ").concat(Math.floor(o),", ").concat(Math.floor(d),")")}return this.getAttribute("from").getColor()}}class $6 extends H_{constructor(){super(...arguments),this.type="animateTransform"}calcValue(){var{progress:t,from:e,to:n}=this.getProgress(),i=ua(e.getString()),s=ua(n.getString()),a=i.map((o,d)=>{var p=s[d];return o+(p-o)*t}).join(" ");return a}}class W6 extends _i{constructor(t,e,n){super(t,e,n),this.type="font",this.glyphs={},this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber();var{definitions:i}=t,{children:s}=this;for(var a of s)switch(a.type){case"font-face":{this.fontFace=a;var o=a.getStyle("font-family");o.hasValue()&&(i[o.getString()]=this);break}case"missing-glyph":this.missingGlyph=a;break;case"glyph":{var d=a;d.arabicForm?(this.isRTL=!0,this.isArabic=!0,typeof this.glyphs[d.unicode]>"u"&&(this.glyphs[d.unicode]={}),this.glyphs[d.unicode][d.arabicForm]=d):this.glyphs[d.unicode]=d;break}}}render(){}}class X6 extends _i{constructor(t,e,n){super(t,e,n),this.type="font-face",this.ascent=this.getAttribute("ascent").getNumber(),this.descent=this.getAttribute("descent").getNumber(),this.unitsPerEm=this.getAttribute("units-per-em").getNumber()}}class J6 extends $n{constructor(){super(...arguments),this.type="missing-glyph",this.horizAdvX=0}}class Y6 extends tA{constructor(){super(...arguments),this.type="tref"}getText(){var t=this.getHrefAttribute().getDefinition();if(t){var e=t.children[0];if(e)return e.getText()}return""}}class Z6 extends tA{constructor(t,e,n){super(t,e,n),this.type="a";var{childNodes:i}=e,s=i[0],a=i.length>0&&Array.from(i).every(o=>o.nodeType===3);this.hasText=a,this.text=a?this.getTextFromNode(s):""}getText(){return this.text}renderChildren(t){if(this.hasText){super.renderChildren(t);var{document:e,x:n,y:i}=this,{mouse:s}=e.screen,a=new Or(e,"fontSize",mo.parse(e.ctx.font).fontSize);s.isWorking()&&s.checkBoundingBox(this,new yl(n,i-a.getPixels("y"),n+this.measureText(t),i))}else if(this.children.length>0){var o=new z_(this.document,null);o.children=this.children,o.parent=this,o.render(t)}}onClick(){var{window:t}=this.document;t&&t.open(this.getHrefAttribute().getString())}onMouseMove(){var t=this.document.ctx;t.canvas.style.cursor="pointer"}}function tN(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),e.push.apply(e,n)}return e}function V_(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?tN(Object(e),!0).forEach(function(n){oE(r,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):tN(Object(e)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))})}return r}class eN extends tA{constructor(t,e,n){super(t,e,n),this.type="textPath",this.textWidth=0,this.textHeight=0,this.pathLength=-1,this.glyphInfo=null,this.letterSpacingCache=[],this.measuresCache=new Map([["",0]]);var i=this.getHrefAttribute().getDefinition();this.text=this.getTextFromNode(),this.dataArray=this.parsePathData(i)}getText(){return this.text}path(t){var{dataArray:e}=this;t&&t.beginPath(),e.forEach(n=>{var{type:i,points:s}=n;switch(i){case rn.LINE_TO:t&&t.lineTo(s[0],s[1]);break;case rn.MOVE_TO:t&&t.moveTo(s[0],s[1]);break;case rn.CURVE_TO:t&&t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case rn.QUAD_TO:t&&t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case rn.ARC:{var[a,o,d,p,y,b,x,C]=s,P=d>p?d:p,M=d>p?1:d/p,k=d>p?p/d:1;t&&(t.translate(a,o),t.rotate(x),t.scale(M,k),t.arc(0,0,P,y,y+b,!!(1-C)),t.scale(1/M,1/k),t.rotate(-x),t.translate(-a,-o));break}case rn.CLOSE_PATH:t&&t.closePath();break}})}renderChildren(t){this.setTextData(t),t.save();var e=this.parent.getStyle("text-decoration").getString(),n=this.getFontSize(),{glyphInfo:i}=this,s=t.fillStyle;e==="underline"&&t.beginPath(),i.forEach((a,o)=>{var{p0:d,p1:p,rotation:y,text:b}=a;t.save(),t.translate(d.x,d.y),t.rotate(y),t.fillStyle&&t.fillText(b,0,0),t.strokeStyle&&t.strokeText(b,0,0),t.restore(),e==="underline"&&(o===0&&t.moveTo(d.x,d.y+n/8),t.lineTo(p.x,p.y+n/5))}),e==="underline"&&(t.lineWidth=n/20,t.strokeStyle=s,t.stroke(),t.closePath()),t.restore()}getLetterSpacingAt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.letterSpacingCache[t]||0}findSegmentToFitChar(t,e,n,i,s,a,o,d,p){var y=a,b=this.measureText(t,d);d===" "&&e==="justify"&&n<i&&(b+=(i-n)/s),p>-1&&(y+=this.getLetterSpacingAt(p));var x=this.textHeight/20,C=this.getEquidistantPointOnPath(y,x,0),P=this.getEquidistantPointOnPath(y+b,x,0),M={p0:C,p1:P},k=C&&P?Math.atan2(P.y-C.y,P.x-C.x):0;if(o){var z=Math.cos(Math.PI/2+k)*o,V=Math.cos(-k)*o;M.p0=V_(V_({},C),{},{x:C.x+z,y:C.y+V}),M.p1=V_(V_({},P),{},{x:P.x+z,y:P.y+V})}return y+=b,{offset:y,segment:M,rotation:k}}measureText(t,e){var{measuresCache:n}=this,i=e||this.getText();if(n.has(i))return n.get(i);var s=this.measureTargetText(t,i);return n.set(i,s),s}setTextData(t){if(!this.glyphInfo){var e=this.getText(),n=e.split(""),i=e.split(" ").length-1,s=this.parent.getAttribute("dx").split().map(tt=>tt.getPixels("x")),a=this.parent.getAttribute("dy").getPixels("y"),o=this.parent.getStyle("text-anchor").getString("start"),d=this.getStyle("letter-spacing"),p=this.parent.getStyle("letter-spacing"),y=0;!d.hasValue()||d.getValue()==="inherit"?y=p.getPixels():d.hasValue()&&d.getValue()!=="initial"&&d.getValue()!=="unset"&&(y=d.getPixels());var b=[],x=e.length;this.letterSpacingCache=b;for(var C=0;C<x;C++)b.push(typeof s[C]<"u"?s[C]:y);var P=b.reduce((tt,pt,gt)=>gt===0?0:tt+pt||0,0),M=this.measureText(t),k=Math.max(M+P,0);this.textWidth=M,this.textHeight=this.getFontSize(),this.glyphInfo=[];var z=this.getPathLength(),V=this.getStyle("startOffset").getNumber(0)*z,$=0;(o==="middle"||o==="center")&&($=-k/2),(o==="end"||o==="right")&&($=-k),$+=V,n.forEach((tt,pt)=>{var{offset:gt,segment:mt,rotation:dt}=this.findSegmentToFitChar(t,o,k,z,i,$,a,tt,pt);$=gt,!(!mt.p0||!mt.p1)&&this.glyphInfo.push({text:n[pt],p0:mt.p0,p1:mt.p1,rotation:dt})})}}parsePathData(t){if(this.pathLength=-1,!t)return[];var e=[],{pathParser:n}=t;for(n.reset();!n.isEnd();){var{current:i}=n,s=i?i.x:0,a=i?i.y:0,o=n.next(),d=o.type,p=[];switch(o.type){case rn.MOVE_TO:this.pathM(n,p);break;case rn.LINE_TO:d=this.pathL(n,p);break;case rn.HORIZ_LINE_TO:d=this.pathH(n,p);break;case rn.VERT_LINE_TO:d=this.pathV(n,p);break;case rn.CURVE_TO:this.pathC(n,p);break;case rn.SMOOTH_CURVE_TO:d=this.pathS(n,p);break;case rn.QUAD_TO:this.pathQ(n,p);break;case rn.SMOOTH_QUAD_TO:d=this.pathT(n,p);break;case rn.ARC:p=this.pathA(n);break;case rn.CLOSE_PATH:$n.pathZ(n);break}o.type!==rn.CLOSE_PATH?e.push({type:d,points:p,start:{x:s,y:a},pathLength:this.calcLength(s,a,d,p)}):e.push({type:rn.CLOSE_PATH,points:[],pathLength:0})}return e}pathM(t,e){var{x:n,y:i}=$n.pathM(t).point;e.push(n,i)}pathL(t,e){var{x:n,y:i}=$n.pathL(t).point;return e.push(n,i),rn.LINE_TO}pathH(t,e){var{x:n,y:i}=$n.pathH(t).point;return e.push(n,i),rn.LINE_TO}pathV(t,e){var{x:n,y:i}=$n.pathV(t).point;return e.push(n,i),rn.LINE_TO}pathC(t,e){var{point:n,controlPoint:i,currentPoint:s}=$n.pathC(t);e.push(n.x,n.y,i.x,i.y,s.x,s.y)}pathS(t,e){var{point:n,controlPoint:i,currentPoint:s}=$n.pathS(t);return e.push(n.x,n.y,i.x,i.y,s.x,s.y),rn.CURVE_TO}pathQ(t,e){var{controlPoint:n,currentPoint:i}=$n.pathQ(t);e.push(n.x,n.y,i.x,i.y)}pathT(t,e){var{controlPoint:n,currentPoint:i}=$n.pathT(t);return e.push(n.x,n.y,i.x,i.y),rn.QUAD_TO}pathA(t){var{rX:e,rY:n,sweepFlag:i,xAxisRotation:s,centp:a,a1:o,ad:d}=$n.pathA(t);return i===0&&d>0&&(d-=2*Math.PI),i===1&&d<0&&(d+=2*Math.PI),[a.x,a.y,e,n,o,d,s,i]}calcLength(t,e,n,i){var s=0,a=null,o=null,d=0;switch(n){case rn.LINE_TO:return this.getLineLength(t,e,i[0],i[1]);case rn.CURVE_TO:for(s=0,a=this.getPointOnCubicBezier(0,t,e,i[0],i[1],i[2],i[3],i[4],i[5]),d=.01;d<=1;d+=.01)o=this.getPointOnCubicBezier(d,t,e,i[0],i[1],i[2],i[3],i[4],i[5]),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return s;case rn.QUAD_TO:for(s=0,a=this.getPointOnQuadraticBezier(0,t,e,i[0],i[1],i[2],i[3]),d=.01;d<=1;d+=.01)o=this.getPointOnQuadraticBezier(d,t,e,i[0],i[1],i[2],i[3]),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return s;case rn.ARC:{s=0;var p=i[4],y=i[5],b=i[4]+y,x=Math.PI/180;if(Math.abs(p-b)<x&&(x=Math.abs(p-b)),a=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],p,0),y<0)for(d=p-x;d>b;d-=x)o=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],d,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;else for(d=p+x;d<b;d+=x)o=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],d,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return o=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],b,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),s}}return 0}getPointOnLine(t,e,n,i,s){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:e,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:n,d=(s-n)/(i-e+xd),p=Math.sqrt(t*t/(1+d*d));i<e&&(p*=-1);var y=d*p,b=null;if(i===e)b={x:a,y:o+y};else if((o-n)/(a-e+xd)===d)b={x:a+p,y:o+y};else{var x=0,C=0,P=this.getLineLength(e,n,i,s);if(P<xd)return null;var M=(a-e)*(i-e)+(o-n)*(s-n);M/=P*P,x=e+M*(i-e),C=n+M*(s-n);var k=this.getLineLength(a,o,x,C),z=Math.sqrt(t*t-k*k);p=Math.sqrt(z*z/(1+d*d)),i<e&&(p*=-1),y=d*p,b={x:x+p,y:C+y}}return b}getPointOnPath(t){var e=this.getPathLength(),n=0,i=null;if(t<-5e-5||t-5e-5>e)return null;var{dataArray:s}=this;for(var a of s){if(a&&(a.pathLength<5e-5||n+a.pathLength+5e-5<t)){n+=a.pathLength;continue}var o=t-n,d=0;switch(a.type){case rn.LINE_TO:i=this.getPointOnLine(o,a.start.x,a.start.y,a.points[0],a.points[1],a.start.x,a.start.y);break;case rn.ARC:{var p=a.points[4],y=a.points[5],b=a.points[4]+y;if(d=p+o/a.pathLength*y,y<0&&d<b||y>=0&&d>b)break;i=this.getPointOnEllipticalArc(a.points[0],a.points[1],a.points[2],a.points[3],d,a.points[6]);break}case rn.CURVE_TO:d=o/a.pathLength,d>1&&(d=1),i=this.getPointOnCubicBezier(d,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3],a.points[4],a.points[5]);break;case rn.QUAD_TO:d=o/a.pathLength,d>1&&(d=1),i=this.getPointOnQuadraticBezier(d,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3]);break}if(i)return i;break}return null}getLineLength(t,e,n,i){return Math.sqrt((n-t)*(n-t)+(i-e)*(i-e))}getPathLength(){return this.pathLength===-1&&(this.pathLength=this.dataArray.reduce((t,e)=>e.pathLength>0?t+e.pathLength:t,0)),this.pathLength}getPointOnCubicBezier(t,e,n,i,s,a,o,d,p){var y=d*wE(t)+a*xE(t)+i*BE(t)+e*CE(t),b=p*wE(t)+o*xE(t)+s*BE(t)+n*CE(t);return{x:y,y:b}}getPointOnQuadraticBezier(t,e,n,i,s,a,o){var d=a*EE(t)+i*SE(t)+e*TE(t),p=o*EE(t)+s*SE(t)+n*TE(t);return{x:d,y:p}}getPointOnEllipticalArc(t,e,n,i,s,a){var o=Math.cos(a),d=Math.sin(a),p={x:n*Math.cos(s),y:i*Math.sin(s)};return{x:t+(p.x*o-p.y*d),y:e+(p.x*d+p.y*o)}}buildEquidistantCache(t,e){var n=this.getPathLength(),i=e||.25,s=t||n/100;if(!this.equidistantCache||this.equidistantCache.step!==s||this.equidistantCache.precision!==i){this.equidistantCache={step:s,precision:i,points:[]};for(var a=0,o=0;o<=n;o+=i){var d=this.getPointOnPath(o),p=this.getPointOnPath(o+i);!d||!p||(a+=this.getLineLength(d.x,d.y,p.x,p.y),a>=s&&(this.equidistantCache.points.push({x:d.x,y:d.y,distance:o}),a-=s))}}}getEquidistantPointOnPath(t,e,n){if(this.buildEquidistantCache(e,n),t<0||t-this.getPathLength()>5e-5)return null;var i=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[i]||null}}var obt=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i;class rN extends lh{constructor(t,e,n){super(t,e,n),this.type="image",this.loaded=!1;var i=this.getHrefAttribute().getString();if(i){var s=i.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(i);t.images.push(this),s?this.loadSvg(i):this.loadImage(i),this.isSvg=s}}loadImage(t){var e=this;return Ju(function*(){try{var n=yield e.document.createImage(t);e.image=n}catch(i){console.error('Error while loading image "'.concat(t,'":'),i)}e.loaded=!0})()}loadSvg(t){var e=this;return Ju(function*(){var n=obt.exec(t);if(n){var i=n[5];n[4]==="base64"?e.image=atob(i):e.image=decodeURIComponent(i)}else try{var s=yield e.document.fetch(t),a=yield s.text();e.image=a}catch(o){console.error('Error while loading image "'.concat(t,'":'),o)}e.loaded=!0})()}renderChildren(t){var{document:e,image:n,loaded:i}=this,s=this.getAttribute("x").getPixels("x"),a=this.getAttribute("y").getPixels("y"),o=this.getStyle("width").getPixels("x"),d=this.getStyle("height").getPixels("y");if(!(!i||!n||!o||!d)){if(t.save(),t.translate(s,a),this.isSvg){var p=e.canvg.forkString(t,this.image,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:o,scaleHeight:d});p.document.documentElement.parent=this,p.render()}else{var y=this.image;e.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:o,desiredWidth:y.width,height:d,desiredHeight:y.height}),this.loaded&&(typeof y.complete>"u"||y.complete)&&t.drawImage(y,0,0)}t.restore()}}getBoundingBox(){var t=this.getAttribute("x").getPixels("x"),e=this.getAttribute("y").getPixels("y"),n=this.getStyle("width").getPixels("x"),i=this.getStyle("height").getPixels("y");return new yl(t,e,t+n,e+i)}}class nN extends lh{constructor(){super(...arguments),this.type="symbol"}render(t){}}class iN{constructor(t){this.document=t,this.loaded=!1,t.fonts.push(this)}load(t,e){var n=this;return Ju(function*(){try{var{document:i}=n,s=yield i.canvg.parser.load(e),a=s.getElementsByTagName("font");Array.from(a).forEach(o=>{var d=i.createElement(o);i.definitions[t]=d})}catch(o){console.error('Error while loading font "'.concat(e,'":'),o)}n.loaded=!0})()}}class RE extends _i{constructor(t,e,n){super(t,e,n),this.type="style";var i=bd(Array.from(e.childNodes).map(a=>a.textContent).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,"")),s=i.split("}");s.forEach(a=>{var o=a.trim();if(o){var d=o.split("{"),p=d[0].split(","),y=d[1].split(";");p.forEach(b=>{var x=b.trim();if(x){var C=t.styles[x]||{};if(y.forEach(k=>{var z=k.indexOf(":"),V=k.substr(0,z).trim(),$=k.substr(z+1,k.length-z).trim();V&&$&&(C[V]=new Or(t,V,$))}),t.styles[x]=C,t.stylesSpecificity[x]=E6(x),x==="@font-face"){var P=C["font-family"].getString().replace(/"|'/g,""),M=C.src.getString().split(",");M.forEach(k=>{if(k.indexOf('format("svg")')>0){var z=_E(k);z&&new iN(t).load(P,z)}})}}})}})}}RE.parseExternalUrl=_E;class sN extends lh{constructor(){super(...arguments),this.type="use"}setContext(t){super.setContext(t);var e=this.getAttribute("x"),n=this.getAttribute("y");e.hasValue()&&t.translate(e.getPixels("x"),0),n.hasValue()&&t.translate(0,n.getPixels("y"))}path(t){var{element:e}=this;e&&e.path(t)}renderChildren(t){var{document:e,element:n}=this;if(n){var i=n;if(n.type==="symbol"&&(i=new _p(e,null),i.attributes.viewBox=new Or(e,"viewBox",n.getAttribute("viewBox").getString()),i.attributes.preserveAspectRatio=new Or(e,"preserveAspectRatio",n.getAttribute("preserveAspectRatio").getString()),i.attributes.overflow=new Or(e,"overflow",n.getAttribute("overflow").getString()),i.children=n.children,n.styles.opacity=new Or(e,"opacity",this.calculateOpacity())),i.type==="svg"){var s=this.getStyle("width",!1,!0),a=this.getStyle("height",!1,!0);s.hasValue()&&(i.attributes.width=new Or(e,"width",s.getString())),a.hasValue()&&(i.attributes.height=new Or(e,"height",a.getString()))}var o=i.parent;i.parent=this,i.render(t),i.parent=o}}getBoundingBox(t){var{element:e}=this;return e?e.getBoundingBox(t):null}elementTransform(){var{document:t,element:e}=this;return ah.fromElement(t,e)}get element(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}}function G_(r,t,e,n,i,s){return r[e*n*4+t*4+s]}function j_(r,t,e,n,i,s,a){r[e*n*4+t*4+s]=a}function us(r,t,e){var n=r[t];return n*e}function eA(r,t,e,n){return t+Math.cos(r)*e+Math.sin(r)*n}class OE extends _i{constructor(t,e,n){super(t,e,n),this.type="feColorMatrix";var i=ua(this.getAttribute("values").getString());switch(this.getAttribute("type").getString("matrix")){case"saturate":{var s=i[0];i=[.213+.787*s,.715-.715*s,.072-.072*s,0,0,.213-.213*s,.715+.285*s,.072-.072*s,0,0,.213-.213*s,.715-.715*s,.072+.928*s,0,0,0,0,0,1,0,0,0,0,0,1];break}case"hueRotate":{var a=i[0]*Math.PI/180;i=[eA(a,.213,.787,-.213),eA(a,.715,-.715,-.715),eA(a,.072,-.072,.928),0,0,eA(a,.213,-.213,.143),eA(a,.715,.285,.14),eA(a,.072,-.072,-.283),0,0,eA(a,.213,-.213,-.787),eA(a,.715,-.715,.715),eA(a,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break}case"luminanceToAlpha":i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1];break}this.matrix=i,this.includeOpacity=this.getAttribute("includeOpacity").hasValue()}apply(t,e,n,i,s){for(var{includeOpacity:a,matrix:o}=this,d=t.getImageData(0,0,i,s),p=0;p<s;p++)for(var y=0;y<i;y++){var b=G_(d.data,y,p,i,s,0),x=G_(d.data,y,p,i,s,1),C=G_(d.data,y,p,i,s,2),P=G_(d.data,y,p,i,s,3),M=us(o,0,b)+us(o,1,x)+us(o,2,C)+us(o,3,P)+us(o,4,1),k=us(o,5,b)+us(o,6,x)+us(o,7,C)+us(o,8,P)+us(o,9,1),z=us(o,10,b)+us(o,11,x)+us(o,12,C)+us(o,13,P)+us(o,14,1),V=us(o,15,b)+us(o,16,x)+us(o,17,C)+us(o,18,P)+us(o,19,1);a&&(M=0,k=0,z=0,V*=P/255),j_(d.data,y,p,i,s,0,M),j_(d.data,y,p,i,s,1,k),j_(d.data,y,p,i,s,2,z),j_(d.data,y,p,i,s,3,V)}t.clearRect(0,0,i,s),t.putImageData(d,0,0)}}class km extends _i{constructor(){super(...arguments),this.type="mask"}apply(t,e){var{document:n}=this,i=this.getAttribute("x").getPixels("x"),s=this.getAttribute("y").getPixels("y"),a=this.getStyle("width").getPixels("x"),o=this.getStyle("height").getPixels("y");if(!a&&!o){var d=new yl;this.children.forEach(P=>{d.addBoundingBox(P.getBoundingBox(t))}),i=Math.floor(d.x1),s=Math.floor(d.y1),a=Math.floor(d.width),o=Math.floor(d.height)}var p=this.removeStyles(e,km.ignoreStyles),y=n.createCanvas(i+a,s+o),b=y.getContext("2d");n.screen.setDefaults(b),this.renderChildren(b),new OE(n,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(b,0,0,i+a,s+o);var x=n.createCanvas(i+a,s+o),C=x.getContext("2d");n.screen.setDefaults(C),e.render(C),C.globalCompositeOperation="destination-in",C.fillStyle=b.createPattern(y,"no-repeat"),C.fillRect(0,0,i+a,s+o),t.fillStyle=C.createPattern(x,"no-repeat"),t.fillRect(0,0,i+a,s+o),this.restoreStyles(e,p)}render(t){}}km.ignoreStyles=["mask","transform","clip-path"];var oN=()=>{};class aN extends _i{constructor(){super(...arguments),this.type="clipPath"}apply(t){var{document:e}=this,n=Reflect.getPrototypeOf(t),{beginPath:i,closePath:s}=t;n&&(n.beginPath=oN,n.closePath=oN),Reflect.apply(i,t,[]),this.children.forEach(a=>{if(!(typeof a.path>"u")){var o=typeof a.elementTransform<"u"?a.elementTransform():null;o||(o=ah.fromElement(e,a)),o&&o.apply(t),a.path(t),n&&(n.closePath=s),o&&o.unapply(t)}}),Reflect.apply(s,t,[]),t.clip(),n&&(n.beginPath=i,n.closePath=s)}render(t){}}class Qm extends _i{constructor(){super(...arguments),this.type="filter"}apply(t,e){var{document:n,children:i}=this,s=e.getBoundingBox(t);if(s){var a=0,o=0;i.forEach(z=>{var V=z.extraFilterDistance||0;a=Math.max(a,V),o=Math.max(o,V)});var d=Math.floor(s.width),p=Math.floor(s.height),y=d+2*a,b=p+2*o;if(!(y<1||b<1)){var x=Math.floor(s.x),C=Math.floor(s.y),P=this.removeStyles(e,Qm.ignoreStyles),M=n.createCanvas(y,b),k=M.getContext("2d");n.screen.setDefaults(k),k.translate(-x+a,-C+o),e.render(k),i.forEach(z=>{typeof z.apply=="function"&&z.apply(k,0,0,y,b)}),t.drawImage(M,0,0,y,b,x-a,C-o,y,b),this.restoreStyles(e,P)}}}render(t){}}Qm.ignoreStyles=["filter","transform","clip-path"];class lN extends _i{constructor(t,e,n){super(t,e,n),this.type="feDropShadow",this.addStylesFromStyleDefinition()}apply(t,e,n,i,s){}}class cN extends _i{constructor(){super(...arguments),this.type="feMorphology"}apply(t,e,n,i,s){}}class uN extends _i{constructor(){super(...arguments),this.type="feComposite"}apply(t,e,n,i,s){}}class AN extends _i{constructor(t,e,n){super(t,e,n),this.type="feGaussianBlur",this.blurRadius=Math.floor(this.getAttribute("stdDeviation").getNumber()),this.extraFilterDistance=this.blurRadius}apply(t,e,n,i,s){var{document:a,blurRadius:o}=this,d=a.window?a.window.document.body:null,p=t.canvas;p.id=a.getUniqueId(),d&&(p.style.display="none",d.appendChild(p)),Nvt(p,e,n,i,s,o),d&&d.removeChild(p)}}class hN extends _i{constructor(){super(...arguments),this.type="title"}}class dN extends _i{constructor(){super(...arguments),this.type="desc"}}var abt={svg:_p,rect:PE,circle:D6,ellipse:N6,line:k6,polyline:ME,polygon:Q6,path:$n,pattern:z6,marker:H6,defs:V6,linearGradient:G6,radialGradient:j6,stop:q6,animate:H_,animateColor:K6,animateTransform:$6,font:W6,"font-face":X6,"missing-glyph":J6,glyph:LE,text:tA,tspan:Nm,tref:Y6,a:Z6,textPath:eN,image:rN,g:z_,symbol:nN,style:RE,use:sN,mask:km,clipPath:aN,filter:Qm,feDropShadow:lN,feMorphology:cN,feComposite:uN,feColorMatrix:OE,feGaussianBlur:AN,title:hN,desc:dN};function fN(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),e.push.apply(e,n)}return e}function lbt(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?fN(Object(e),!0).forEach(function(n){oE(r,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):fN(Object(e)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))})}return r}function cbt(r,t){var e=document.createElement("canvas");return e.width=r,e.height=t,e}function ubt(r){return DE.apply(this,arguments)}function DE(){return DE=Ju(function*(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,e=document.createElement("img");return t&&(e.crossOrigin="Anonymous"),new Promise((n,i)=>{e.onload=()=>{n(e)},e.onerror=(s,a,o,d,p)=>{i(p)},e.src=r})}),DE.apply(this,arguments)}class rA{constructor(t){var{rootEmSize:e=12,emSize:n=12,createCanvas:i=rA.createCanvas,createImage:s=rA.createImage,anonymousCrossOrigin:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.canvg=t,this.definitions={},this.styles={},this.stylesSpecificity={},this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=t.screen,this.rootEmSize=e,this.emSize=n,this.createCanvas=i,this.createImage=this.bindCreateImage(s,a),this.screen.wait(this.isImagesLoaded.bind(this)),this.screen.wait(this.isFontsLoaded.bind(this))}bindCreateImage(t,e){return typeof e=="boolean"?(n,i)=>t(n,typeof i=="boolean"?i:e):t}get window(){return this.screen.window}get fetch(){return this.screen.fetch}get ctx(){return this.screen.ctx}get emSize(){var{emSizeStack:t}=this;return t[t.length-1]}set emSize(t){var{emSizeStack:e}=this;e.push(t)}popEmSize(){var{emSizeStack:t}=this;t.pop()}getUniqueId(){return"canvg".concat(++this.uniqueId)}isImagesLoaded(){return this.images.every(t=>t.loaded)}isFontsLoaded(){return this.fonts.every(t=>t.loaded)}createDocumentElement(t){var e=this.createElement(t.documentElement);return e.root=!0,e.addStylesFromStyleDefinition(),this.documentElement=e,e}createElement(t){var e=t.nodeName.replace(/^[^:]+:/,""),n=rA.elementTypes[e];return typeof n<"u"?new n(this,t):new O6(this,t)}createTextNode(t){return new sbt(this,t)}setViewBox(t){this.screen.setViewBox(lbt({document:this},t))}}rA.createCanvas=cbt,rA.createImage=ubt,rA.elementTypes=abt;function pN(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),e.push.apply(e,n)}return e}function Bd(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?pN(Object(e),!0).forEach(function(n){oE(r,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):pN(Object(e)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))})}return r}class Cd{constructor(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.parser=new Q_(n),this.screen=new Dm(t,n),this.options=n;var i=new rA(this,n),s=i.createDocumentElement(e);this.document=i,this.documentElement=s}static from(t,e){var n=arguments;return Ju(function*(){var i=n.length>2&&n[2]!==void 0?n[2]:{},s=new Q_(i),a=yield s.parse(e);return new Cd(t,a,i)})()}static fromString(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=new Q_(n),s=i.parseFromString(e);return new Cd(t,s,n)}fork(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Cd.from(t,e,Bd(Bd({},this.options),n))}forkString(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Cd.fromString(t,e,Bd(Bd({},this.options),n))}ready(){return this.screen.ready()}isReady(){return this.screen.isReady()}render(){var t=arguments,e=this;return Ju(function*(){var n=t.length>0&&t[0]!==void 0?t[0]:{};e.start(Bd({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0},n)),yield e.ready(),e.stop()})()}start(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{documentElement:e,screen:n,options:i}=this;n.start(e,Bd(Bd({enableRedraw:!0},i),t))}stop(){this.screen.stop()}resize(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.documentElement.resize(t,e,n)}}const Abt=Object.freeze(Object.defineProperty({__proto__:null,AElement:Z6,AnimateColorElement:K6,AnimateElement:H_,AnimateTransformElement:$6,BoundingBox:yl,CB1:wE,CB2:xE,CB3:BE,CB4:CE,Canvg:Cd,CircleElement:D6,ClipPathElement:aN,DefsElement:V6,DescElement:dN,Document:rA,Element:_i,EllipseElement:N6,FeColorMatrixElement:OE,FeCompositeElement:uN,FeDropShadowElement:lN,FeGaussianBlurElement:AN,FeMorphologyElement:cN,FilterElement:Qm,Font:mo,FontElement:W6,FontFaceElement:X6,GElement:z_,GlyphElement:LE,GradientElement:UE,ImageElement:rN,LineElement:k6,LinearGradientElement:G6,MarkerElement:H6,MaskElement:km,Matrix:IE,MissingGlyphElement:J6,Mouse:T6,PSEUDO_ZERO:xd,Parser:Q_,PathElement:$n,PathParser:rn,PatternElement:z6,Point:zi,PolygonElement:Q6,PolylineElement:ME,Property:Or,QB1:EE,QB2:SE,QB3:TE,RadialGradientElement:j6,RectElement:PE,RenderedElement:lh,Rotate:P6,SVGElement:_p,SVGFontLoader:iN,Scale:M6,Screen:Dm,Skew:FE,SkewX:U6,SkewY:R6,StopElement:q6,StyleElement:RE,SymbolElement:nN,TRefElement:Y6,TSpanElement:Nm,TextElement:tA,TextPathElement:eN,TitleElement:hN,Transform:ah,Translate:L6,UnknownElement:O6,UseElement:sN,ViewPort:S6,compressSpaces:bd,default:Cd,getSelectorSpecificity:E6,normalizeAttributeName:B6,normalizeColor:C6,parseExternalUrl:_E,presets:Hvt,toNumbers:ua,trimLeft:w6,trimRight:x6,vectorMagnitude:vE,vectorsAngle:bE,vectorsRatio:k_},Symbol.toStringTag,{value:"Module"}));EA.CompareMaps=pst,EA.Config=C4,EA.Map=cst,Object.defineProperty(EA,Symbol.toStringTag,{value:"Module"})});
