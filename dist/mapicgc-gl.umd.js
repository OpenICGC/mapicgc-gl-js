(function(LA,Hp){typeof exports=="object"&&typeof module<"u"?Hp(exports):typeof define=="function"&&define.amd?define(["exports"],Hp):(LA=typeof globalThis<"u"?globalThis:LA||self,Hp(LA.mapicgcgl={}))})(this,function(LA){"use strict";function Hp(r,t){for(var e=0;e<t.length;e++){const n=t[e];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in r)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(r,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}var Kd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vp(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var LS={exports:{}};(function(r,t){(function(e,n){r.exports=n()})(Kd,function(){var e={},n={};function i(a,o,d){if(n[a]=d,a==="index"){var f="var sharedModule = {}; ("+n.shared+")(sharedModule); ("+n.worker+")(sharedModule);",_={};return n.shared(_),n.index(e,_),typeof window<"u"&&e.setWorkerUrl(window.URL.createObjectURL(new Blob([f],{type:"text/javascript"}))),e}}i("shared",["exports"],function(a){function o(u,c,h,g){return new(h||(h=Promise))(function(b,C){function T(k){try{U(g.next(k))}catch(G){C(G)}}function F(k){try{U(g.throw(k))}catch(G){C(G)}}function U(k){var G;k.done?b(k.value):(G=k.value,G instanceof h?G:new h(function(q){q(G)})).then(T,F)}U((g=g.apply(u,c||[])).next())})}function d(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}typeof SuppressedError=="function"&&SuppressedError;var f=_;function _(u,c){this.x=u,this.y=c}_.prototype={clone:function(){return new _(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,c){return this.clone()._rotateAround(u,c)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var c=u.x-this.x,h=u.y-this.y;return c*c+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,c){return Math.atan2(this.x*c-this.y*u,this.x*u+this.y*c)},_matMult:function(u){var c=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=c,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var c=Math.cos(u),h=Math.sin(u),g=h*this.x+c*this.y;return this.x=c*this.x-h*this.y,this.y=g,this},_rotateAround:function(u,c){var h=Math.cos(u),g=Math.sin(u),b=c.y+g*(this.x-c.x)+h*(this.y-c.y);return this.x=c.x+h*(this.x-c.x)-g*(this.y-c.y),this.y=b,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},_.convert=function(u){return u instanceof _?u:Array.isArray(u)?new _(u[0],u[1]):u};var w=d(f),x=B;function B(u,c,h,g){this.cx=3*u,this.bx=3*(h-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(g-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=c,this.p2x=h,this.p2y=g}B.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,c){if(c===void 0&&(c=1e-6),u<0)return 0;if(u>1)return 1;for(var h=u,g=0;g<8;g++){var b=this.sampleCurveX(h)-u;if(Math.abs(b)<c)return h;var C=this.sampleCurveDerivativeX(h);if(Math.abs(C)<1e-6)break;h-=b/C}var T=0,F=1;for(h=u,g=0;g<20&&(b=this.sampleCurveX(h),!(Math.abs(b-u)<c));g++)u>b?T=h:F=h,h=.5*(F-T)+T;return h},solve:function(u,c){return this.sampleCurveY(this.solveCurveX(u,c))}};var P=d(x);let R,N;function Q(){return R==null&&(R=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),R}function V(){if(N==null&&(N=!1,Q())){const c=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(c){for(let g=0;g<5*5;g++){const b=4*g;c.fillStyle=`rgb(${b},${b+1},${b+2})`,c.fillRect(g%5,Math.floor(g/5),1,1)}const h=c.getImageData(0,0,5,5).data;for(let g=0;g<5*5*4;g++)if(g%4!=3&&h[g]!==g){N=!0;break}}}return N||!1}function W(u,c,h,g){const b=new P(u,c,h,g);return C=>b.solve(C)}const et=W(.25,.1,.25,1);function ct(u,c,h){return Math.min(h,Math.max(c,u))}function dt(u,c,h){const g=h-c,b=((u-c)%g+g)%g+c;return b===c?h:b}function gt(u){for(var c=arguments.length,h=new Array(c>1?c-1:0),g=1;g<c;g++)h[g-1]=arguments[g];for(const b of h)for(const C in b)u[C]=b[C];return u}let ht=1;function It(u,c,h){const g={};for(const b in u)g[b]=c.call(this,u[b],b,u);return g}function St(u,c,h){const g={};for(const b in u)c.call(this,u[b],b,u)&&(g[b]=u[b]);return g}function ot(u){return Array.isArray(u)?u.map(ot):typeof u=="object"&&u?It(u,ot):u}const at={};function bt(u){at[u]||(typeof console<"u"&&console.warn(u),at[u]=!0)}function vt(u,c,h){return(h.y-u.y)*(c.x-u.x)>(c.y-u.y)*(h.x-u.x)}function $t(u){return typeof WorkerGlobalScope<"u"&&u!==void 0&&u instanceof WorkerGlobalScope}let Wt=null;function Jt(u){return typeof ImageBitmap<"u"&&u instanceof ImageBitmap}const qt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function te(u,c,h,g,b){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const C=new VideoFrame(u,{timestamp:0});try{const T=C==null?void 0:C.format;if(!T||!T.startsWith("BGR")&&!T.startsWith("RGB"))throw new Error(`Unrecognized format ${T}`);const F=T.startsWith("BGR"),U=new Uint8ClampedArray(g*b*4);if(yield C.copyTo(U,function(k,G,q,Y,rt){const lt=4*Math.max(-G,0),yt=(Math.max(0,q)-q)*Y*4+lt,Tt=4*Y,Ot=Math.max(0,G),ne=Math.max(0,q);return{rect:{x:Ot,y:ne,width:Math.min(k.width,G+Y)-Ot,height:Math.min(k.height,q+rt)-ne},layout:[{offset:yt,stride:Tt}]}}(u,c,h,g,b)),F)for(let k=0;k<U.length;k+=4){const G=U[k];U[k]=U[k+2],U[k+2]=G}return U}finally{C.close()}})}let Yt,be;const it="AbortError";function wt(){return new Error(it)}const Ft={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Ut(u){return Ft.REGISTERED_PROTOCOLS[u.substring(0,u.indexOf("://"))]}const jt="global-dispatcher";class Vt extends Error{constructor(c,h,g,b){super(`AJAXError: ${h} (${c}): ${g}`),this.status=c,this.statusText=h,this.url=g,this.body=b}}const re=()=>$t(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Zt=function(u,c){if(/:\/\//.test(u.url)&&!/^https?:|^file:/.test(u.url)){const g=Ut(u.url);if(g)return g(u,c);if($t(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:u,targetMapId:jt},c)}if(!(/^file:/.test(h=u.url)||/^file:/.test(re())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(g,b){return o(this,void 0,void 0,function*(){const C=new Request(g.url,{method:g.method||"GET",body:g.body,credentials:g.credentials,headers:g.headers,cache:g.cache,referrer:re(),signal:b.signal});g.type!=="json"||C.headers.has("Accept")||C.headers.set("Accept","application/json");const T=yield fetch(C);if(!T.ok){const k=yield T.blob();throw new Vt(T.status,T.statusText,g.url,k)}let F;F=g.type==="arrayBuffer"||g.type==="image"?T.arrayBuffer():g.type==="json"?T.json():T.text();const U=yield F;if(b.signal.aborted)throw wt();return{data:U,cacheControl:T.headers.get("Cache-Control"),expires:T.headers.get("Expires")}})}(u,c);if($t(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:u,mustQueue:!0,targetMapId:jt},c)}var h;return function(g,b){return new Promise((C,T)=>{var F;const U=new XMLHttpRequest;U.open(g.method||"GET",g.url,!0),g.type!=="arrayBuffer"&&g.type!=="image"||(U.responseType="arraybuffer");for(const k in g.headers)U.setRequestHeader(k,g.headers[k]);g.type==="json"&&(U.responseType="text",!((F=g.headers)===null||F===void 0)&&F.Accept||U.setRequestHeader("Accept","application/json")),U.withCredentials=g.credentials==="include",U.onerror=()=>{T(new Error(U.statusText))},U.onload=()=>{if(!b.signal.aborted)if((U.status>=200&&U.status<300||U.status===0)&&U.response!==null){let k=U.response;if(g.type==="json")try{k=JSON.parse(U.response)}catch(G){return void T(G)}C({data:k,cacheControl:U.getResponseHeader("Cache-Control"),expires:U.getResponseHeader("Expires")})}else{const k=new Blob([U.response],{type:U.getResponseHeader("Content-Type")});T(new Vt(U.status,U.statusText,g.url,k))}},b.signal.addEventListener("abort",()=>{U.abort(),T(wt())}),U.send(g.body)})}(u,c)};function Be(u){if(!u||u.indexOf("://")<=0||u.indexOf("data:image/")===0||u.indexOf("blob:")===0)return!0;const c=new URL(u),h=window.location;return c.protocol===h.protocol&&c.host===h.host}function Ie(u,c,h){h[u]&&h[u].indexOf(c)!==-1||(h[u]=h[u]||[],h[u].push(c))}function ke(u,c,h){if(h&&h[u]){const g=h[u].indexOf(c);g!==-1&&h[u].splice(g,1)}}class He{constructor(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};gt(this,h),this.type=c}}class Ke extends He{constructor(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super("error",gt({error:c},h))}}class le{on(c,h){return this._listeners=this._listeners||{},Ie(c,h,this._listeners),this}off(c,h){return ke(c,h,this._listeners),ke(c,h,this._oneTimeListeners),this}once(c,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},Ie(c,h,this._oneTimeListeners),this):new Promise(g=>this.once(c,g))}fire(c,h){typeof c=="string"&&(c=new He(c,h||{}));const g=c.type;if(this.listens(g)){c.target=this;const b=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];for(const F of b)F.call(this,c);const C=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];for(const F of C)ke(g,F,this._oneTimeListeners),F.call(this,c);const T=this._eventedParent;T&&(gt(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(c))}else c instanceof Ke&&console.error(c.error);return this}listens(c){return this._listeners&&this._listeners[c]&&this._listeners[c].length>0||this._oneTimeListeners&&this._oneTimeListeners[c]&&this._oneTimeListeners[c].length>0||this._eventedParent&&this._eventedParent.listens(c)}setEventedParent(c,h){return this._eventedParent=c,this._eventedParentData=h,this}}var st={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const pr=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ye(u,c){const h={};for(const g in u)g!=="ref"&&(h[g]=u[g]);return pr.forEach(g=>{g in c&&(h[g]=c[g])}),h}function ue(u,c){if(Array.isArray(u)){if(!Array.isArray(c)||u.length!==c.length)return!1;for(let h=0;h<u.length;h++)if(!ue(u[h],c[h]))return!1;return!0}if(typeof u=="object"&&u!==null&&c!==null){if(typeof c!="object"||Object.keys(u).length!==Object.keys(c).length)return!1;for(const h in u)if(!ue(u[h],c[h]))return!1;return!0}return u===c}function ye(u,c){u.push(c)}function Le(u,c,h){ye(h,{command:"addSource",args:[u,c[u]]})}function Oe(u,c,h){ye(c,{command:"removeSource",args:[u]}),h[u]=!0}function We(u,c,h,g){Oe(u,h,g),Le(u,c,h)}function cr(u,c,h){let g;for(g in u[h])if(Object.prototype.hasOwnProperty.call(u[h],g)&&g!=="data"&&!ue(u[h][g],c[h][g]))return!1;for(g in c[h])if(Object.prototype.hasOwnProperty.call(c[h],g)&&g!=="data"&&!ue(u[h][g],c[h][g]))return!1;return!0}function yr(u,c,h,g,b,C){u=u||{},c=c||{};for(const T in u)Object.prototype.hasOwnProperty.call(u,T)&&(ue(u[T],c[T])||h.push({command:C,args:[g,T,c[T],b]}));for(const T in c)Object.prototype.hasOwnProperty.call(c,T)&&!Object.prototype.hasOwnProperty.call(u,T)&&(ue(u[T],c[T])||h.push({command:C,args:[g,T,c[T],b]}))}function Fr(u){return u.id}function Ur(u,c){return u[c.id]=c,u}class de{constructor(c,h,g,b){this.message=(c?`${c}: `:"")+g,b&&(this.identifier=b),h!=null&&h.__line__&&(this.line=h.__line__)}}function ur(u){for(var c=arguments.length,h=new Array(c>1?c-1:0),g=1;g<c;g++)h[g-1]=arguments[g];for(const b of h)for(const C in b)u[C]=b[C];return u}class _r extends Error{constructor(c,h){super(h),this.message=h,this.key=c}}class De{constructor(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.parent=c,this.bindings={};for(const[g,b]of h)this.bindings[g]=b}concat(c){return new De(this,c)}get(c){if(this.bindings[c])return this.bindings[c];if(this.parent)return this.parent.get(c);throw new Error(`${c} not found in scope.`)}has(c){return!!this.bindings[c]||!!this.parent&&this.parent.has(c)}}const gn={kind:"null"},pe={kind:"number"},gr={kind:"string"},Qe={kind:"boolean"},Mr={kind:"color"},_n={kind:"object"},ze={kind:"value"},Nn={kind:"collator"},sn={kind:"formatted"},vn={kind:"padding"},cn={kind:"resolvedImage"},Ct={kind:"variableAnchorOffsetCollection"};function X(u,c){return{kind:"array",itemType:u,N:c}}function Z(u){if(u.kind==="array"){const c=Z(u.itemType);return typeof u.N=="number"?`array<${c}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${c}>`}return u.kind}const ft=[gn,pe,gr,Qe,Mr,sn,_n,X(ze),vn,cn,Ct];function Bt(u,c){if(c.kind==="error")return null;if(u.kind==="array"){if(c.kind==="array"&&(c.N===0&&c.itemType.kind==="value"||!Bt(u.itemType,c.itemType))&&(typeof u.N!="number"||u.N===c.N))return null}else{if(u.kind===c.kind)return null;if(u.kind==="value"){for(const h of ft)if(!Bt(h,c))return null}}return`Expected ${Z(u)} but found ${Z(c)} instead.`}function Qt(u,c){return c.some(h=>h.kind===u.kind)}function Gt(u,c){return c.some(h=>h==="null"?u===null:h==="array"?Array.isArray(u):h==="object"?u&&!Array.isArray(u)&&typeof u=="object":h===typeof u)}function Nt(u,c){return u.kind==="array"&&c.kind==="array"?u.itemType.kind===c.itemType.kind&&typeof u.N=="number":u.kind===c.kind}const Pt=.96422,se=.82521,he=4/29,Xt=6/29,we=3*Xt*Xt,je=Xt*Xt*Xt,tr=Math.PI/180,Qr=180/Math.PI;function ir(u){return(u%=360)<0&&(u+=360),u}function Or(u){let[c,h,g,b]=u,C,T;const F=$r((.2225045*(c=xr(c))+.7168786*(h=xr(h))+.0606169*(g=xr(g)))/1);c===h&&h===g?C=T=F:(C=$r((.4360747*c+.3850649*h+.1430804*g)/Pt),T=$r((.0139322*c+.0971045*h+.7141733*g)/se));const U=116*F-16;return[U<0?0:U,500*(C-F),200*(F-T),b]}function xr(u){return u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function $r(u){return u>je?Math.pow(u,1/3):u/we+he}function Xr(u){let[c,h,g,b]=u,C=(c+16)/116,T=isNaN(h)?C:C+h/500,F=isNaN(g)?C:C-g/200;return C=1*jr(C),T=Pt*jr(T),F=se*jr(F),[vr(3.1338561*T-1.6168667*C-.4906146*F),vr(-.9787684*T+1.9161415*C+.033454*F),vr(.0719453*T-.2289914*C+1.4052427*F),b]}function vr(u){return(u=u<=.00304?12.92*u:1.055*Math.pow(u,1/2.4)-.055)<0?0:u>1?1:u}function jr(u){return u>Xt?u*u*u:we*(u-he)}function on(u){return parseInt(u.padEnd(2,u),16)/255}function In(u,c){return Mt(c?u/100:u,0,1)}function Mt(u,c,h){return Math.min(Math.max(c,u),h)}function Ne(u){return!u.some(Number.isNaN)}const Ee={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class or{constructor(c,h,g){let b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,C=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;this.r=c,this.g=h,this.b=g,this.a=b,C||(this.r*=b,this.g*=b,this.b*=b,b||this.overwriteGetter("rgb",[c,h,g,b]))}static parse(c){if(c instanceof or)return c;if(typeof c!="string")return;const h=function(g){if((g=g.toLowerCase().trim())==="transparent")return[0,0,0,0];const b=Ee[g];if(b){const[T,F,U]=b;return[T/255,F/255,U/255,1]}if(g.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(g)){const T=g.length<6?1:2;let F=1;return[on(g.slice(F,F+=T)),on(g.slice(F,F+=T)),on(g.slice(F,F+=T)),on(g.slice(F,F+T)||"ff")]}if(g.startsWith("rgb")){const T=g.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[F,U,k,G,q,Y,rt,lt,yt,Tt,Ot,ne]=T,zt=[G||" ",rt||" ",Tt].join("");if(zt==="  "||zt==="  /"||zt===",,"||zt===",,,"){const Kt=[k,Y,yt].join(""),ce=Kt==="%%%"?100:Kt===""?255:0;if(ce){const Te=[Mt(+U/ce,0,1),Mt(+q/ce,0,1),Mt(+lt/ce,0,1),Ot?In(+Ot,ne):1];if(Ne(Te))return Te}}return}}const C=g.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(C){const[T,F,U,k,G,q,Y,rt,lt]=C,yt=[U||" ",G||" ",Y].join("");if(yt==="  "||yt==="  /"||yt===",,"||yt===",,,"){const Tt=[+F,Mt(+k,0,100),Mt(+q,0,100),rt?In(+rt,lt):1];if(Ne(Tt))return function(Ot){let[ne,zt,Kt,ce]=Ot;function Te($e){const Sr=($e+ne/30)%12,qe=zt*Math.min(Kt,1-Kt);return Kt-qe*Math.max(-1,Math.min(Sr-3,9-Sr,1))}return ne=ir(ne),zt/=100,Kt/=100,[Te(0),Te(8),Te(4),ce]}(Tt)}}}(c);return h?new or(...h,!1):void 0}get rgb(){const{r:c,g:h,b:g,a:b}=this,C=b||1/0;return this.overwriteGetter("rgb",[c/C,h/C,g/C,b])}get hcl(){return this.overwriteGetter("hcl",function(c){const[h,g,b,C]=Or(c),T=Math.sqrt(g*g+b*b);return[Math.round(1e4*T)?ir(Math.atan2(b,g)*Qr):NaN,T,h,C]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Or(this.rgb))}overwriteGetter(c,h){return Object.defineProperty(this,c,{value:h}),h}toString(){const[c,h,g,b]=this.rgb;return`rgba(${[c,h,g].map(C=>Math.round(255*C)).join(",")},${b})`}}or.black=new or(0,0,0,1),or.white=new or(1,1,1,1),or.transparent=new or(0,0,0,0),or.red=new or(1,0,0,1);class Lr{constructor(c,h,g){this.sensitivity=c?h?"variant":"case":h?"accent":"base",this.locale=g,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(c,h){return this.collator.compare(c,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Pn{constructor(c,h,g,b,C){this.text=c,this.image=h,this.scale=g,this.fontStack=b,this.textColor=C}}class qr{constructor(c){this.sections=c}static fromString(c){return new qr([new Pn(c,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(c=>c.text.length!==0||c.image&&c.image.name.length!==0)}static factory(c){return c instanceof qr?c:qr.fromString(c)}toString(){return this.sections.length===0?"":this.sections.map(c=>c.text).join("")}}class yn{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof yn)return c;if(typeof c=="number")return new yn([c,c,c,c]);if(Array.isArray(c)&&!(c.length<1||c.length>4)){for(const h of c)if(typeof h!="number")return;switch(c.length){case 1:c=[c[0],c[0],c[0],c[0]];break;case 2:c=[c[0],c[1],c[0],c[1]];break;case 3:c=[c[0],c[1],c[2],c[1]]}return new yn(c)}}toString(){return JSON.stringify(this.values)}}const mi=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class bn{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof bn)return c;if(Array.isArray(c)&&!(c.length<1)&&c.length%2==0){for(let h=0;h<c.length;h+=2){const g=c[h],b=c[h+1];if(typeof g!="string"||!mi.has(g)||!Array.isArray(b)||b.length!==2||typeof b[0]!="number"||typeof b[1]!="number")return}return new bn(c)}}toString(){return JSON.stringify(this.values)}}class tn{constructor(c){this.name=c.name,this.available=c.available}toString(){return this.name}static fromString(c){return c?new tn({name:c,available:!1}):null}}function $o(u,c,h,g){return typeof u=="number"&&u>=0&&u<=255&&typeof c=="number"&&c>=0&&c<=255&&typeof h=="number"&&h>=0&&h<=255?g===void 0||typeof g=="number"&&g>=0&&g<=1?null:`Invalid rgba value [${[u,c,h,g].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof g=="number"?[u,c,h,g]:[u,c,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ws(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof or||u instanceof Lr||u instanceof qr||u instanceof yn||u instanceof bn||u instanceof tn)return!0;if(Array.isArray(u)){for(const c of u)if(!ws(c))return!1;return!0}if(typeof u=="object"){for(const c in u)if(!ws(u[c]))return!1;return!0}return!1}function kn(u){if(u===null)return gn;if(typeof u=="string")return gr;if(typeof u=="boolean")return Qe;if(typeof u=="number")return pe;if(u instanceof or)return Mr;if(u instanceof Lr)return Nn;if(u instanceof qr)return sn;if(u instanceof yn)return vn;if(u instanceof bn)return Ct;if(u instanceof tn)return cn;if(Array.isArray(u)){const c=u.length;let h;for(const g of u){const b=kn(g);if(h){if(h===b)continue;h=ze;break}h=b}return X(h||ze,c)}return _n}function hn(u){const c=typeof u;return u===null?"":c==="string"||c==="number"||c==="boolean"?String(u):u instanceof or||u instanceof qr||u instanceof yn||u instanceof bn||u instanceof tn?u.toString():JSON.stringify(u)}class Li{constructor(c,h){this.type=c,this.value=h}static parse(c,h){if(c.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${c.length-1} instead.`);if(!ws(c[1]))return h.error("invalid value");const g=c[1];let b=kn(g);const C=h.expectedType;return b.kind!=="array"||b.N!==0||!C||C.kind!=="array"||typeof C.N=="number"&&C.N!==0||(b=C),new Li(b,g)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class On{constructor(c){this.name="ExpressionEvaluationError",this.message=c}toJSON(){return this.message}}const Wo={string:gr,number:pe,boolean:Qe,object:_n};class Pi{constructor(c,h){this.type=c,this.args=h}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");let g,b=1;const C=c[0];if(C==="array"){let F,U;if(c.length>2){const k=c[1];if(typeof k!="string"||!(k in Wo)||k==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);F=Wo[k],b++}else F=ze;if(c.length>3){if(c[2]!==null&&(typeof c[2]!="number"||c[2]<0||c[2]!==Math.floor(c[2])))return h.error('The length argument to "array" must be a positive integer literal',2);U=c[2],b++}g=X(F,U)}else{if(!Wo[C])throw new Error(`Types doesn't contain name = ${C}`);g=Wo[C]}const T=[];for(;b<c.length;b++){const F=h.parse(c[b],b,ze);if(!F)return null;T.push(F)}return new Pi(g,T)}evaluate(c){for(let h=0;h<this.args.length;h++){const g=this.args[h].evaluate(c);if(!Bt(this.type,kn(g)))return g;if(h===this.args.length-1)throw new On(`Expected value to be of type ${Z(this.type)}, but found ${Z(kn(g))} instead.`)}throw new Error}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}const $a={"to-boolean":Qe,"to-color":Mr,"to-number":pe,"to-string":gr};class qn{constructor(c,h){this.type=c,this.args=h}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");const g=c[0];if(!$a[g])throw new Error(`Can't parse ${g} as it is not part of the known types`);if((g==="to-boolean"||g==="to-string")&&c.length!==2)return h.error("Expected one argument.");const b=$a[g],C=[];for(let T=1;T<c.length;T++){const F=h.parse(c[T],T,ze);if(!F)return null;C.push(F)}return new qn(b,C)}evaluate(c){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(c);case"color":{let h,g;for(const b of this.args){if(h=b.evaluate(c),g=null,h instanceof or)return h;if(typeof h=="string"){const C=c.parseColor(h);if(C)return C}else if(Array.isArray(h)&&(g=h.length<3||h.length>4?`Invalid rbga value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:$o(h[0],h[1],h[2],h[3]),!g))return new or(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new On(g||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const g of this.args){h=g.evaluate(c);const b=yn.parse(h);if(b)return b}throw new On(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const g of this.args){h=g.evaluate(c);const b=bn.parse(h);if(b)return b}throw new On(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const g of this.args){if(h=g.evaluate(c),h===null)return 0;const b=Number(h);if(!isNaN(b))return b}throw new On(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return qr.fromString(hn(this.args[0].evaluate(c)));case"resolvedImage":return tn.fromString(hn(this.args[0].evaluate(c)));default:return hn(this.args[0].evaluate(c))}}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}const xs=["Unknown","Point","LineString","Polygon"];class Mi{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?xs[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(c){let h=this._parseColorCache[c];return h||(h=this._parseColorCache[c]=or.parse(c)),h}}class Qs{constructor(c,h){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],b=arguments.length>3?arguments[3]:void 0,C=arguments.length>4&&arguments[4]!==void 0?arguments[4]:new De,T=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[];this.registry=c,this.path=g,this.key=g.map(F=>`[${F}]`).join(""),this.scope=C,this.errors=T,this.expectedType=b,this._isConstant=h}parse(c,h,g,b){let C=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};return h?this.concat(h,g,b)._parse(c,C):this._parse(c,C)}_parse(c,h){function g(b,C,T){return T==="assert"?new Pi(C,[b]):T==="coerce"?new qn(C,[b]):b}if(c!==null&&typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"||(c=["literal",c]),Array.isArray(c)){if(c.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const b=c[0];if(typeof b!="string")return this.error(`Expression name must be a string, but found ${typeof b} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const C=this.registry[b];if(C){let T=C.parse(c,this);if(!T)return null;if(this.expectedType){const F=this.expectedType,U=T.type;if(F.kind!=="string"&&F.kind!=="number"&&F.kind!=="boolean"&&F.kind!=="object"&&F.kind!=="array"||U.kind!=="value")if(F.kind!=="color"&&F.kind!=="formatted"&&F.kind!=="resolvedImage"||U.kind!=="value"&&U.kind!=="string")if(F.kind!=="padding"||U.kind!=="value"&&U.kind!=="number"&&U.kind!=="array")if(F.kind!=="variableAnchorOffsetCollection"||U.kind!=="value"&&U.kind!=="array"){if(this.checkSubtype(F,U))return null}else T=g(T,F,h.typeAnnotation||"coerce");else T=g(T,F,h.typeAnnotation||"coerce");else T=g(T,F,h.typeAnnotation||"coerce");else T=g(T,F,h.typeAnnotation||"assert")}if(!(T instanceof Li)&&T.type.kind!=="resolvedImage"&&this._isConstant(T)){const F=new Mi;try{T=new Li(T.type,T.evaluate(F))}catch(U){return this.error(U.message),null}}return T}return this.error(`Unknown expression "${b}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(c===void 0?"'undefined' value invalid. Use null instead.":typeof c=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof c} instead.`)}concat(c,h,g){const b=typeof c=="number"?this.path.concat(c):this.path,C=g?this.scope.concat(g):this.scope;return new Qs(this.registry,this._isConstant,b,h||null,C,this.errors)}error(c){for(var h=arguments.length,g=new Array(h>1?h-1:0),b=1;b<h;b++)g[b-1]=arguments[b];const C=`${this.key}${g.map(T=>`[${T}]`).join("")}`;this.errors.push(new _r(C,c))}checkSubtype(c,h){const g=Bt(c,h);return g&&this.error(g),g}}class Bs{constructor(c,h){this.type=h.type,this.bindings=[].concat(c),this.result=h}evaluate(c){return this.result.evaluate(c)}eachChild(c){for(const h of this.bindings)c(h[1]);c(this.result)}static parse(c,h){if(c.length<4)return h.error(`Expected at least 3 arguments, but found ${c.length-1} instead.`);const g=[];for(let C=1;C<c.length-1;C+=2){const T=c[C];if(typeof T!="string")return h.error(`Expected string, but found ${typeof T} instead.`,C);if(/[^a-zA-Z0-9_]/.test(T))return h.error("Variable names must contain only alphanumeric characters or '_'.",C);const F=h.parse(c[C+1],C+1);if(!F)return null;g.push([T,F])}const b=h.parse(c[c.length-1],c.length-1,h.expectedType,g);return b?new Bs(g,b):null}outputDefined(){return this.result.outputDefined()}}class un{constructor(c,h){this.type=h.type,this.name=c,this.boundExpression=h}static parse(c,h){if(c.length!==2||typeof c[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const g=c[1];return h.scope.has(g)?new un(g,h.scope.get(g)):h.error(`Unknown variable "${g}". Make sure "${g}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(c){return this.boundExpression.evaluate(c)}eachChild(){}outputDefined(){return!1}}class Cl{constructor(c,h,g){this.type=c,this.index=h,this.input=g}static parse(c,h){if(c.length!==3)return h.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const g=h.parse(c[1],1,pe),b=h.parse(c[2],2,X(h.expectedType||ze));return g&&b?new Cl(b.type.itemType,g,b):null}evaluate(c){const h=this.index.evaluate(c),g=this.input.evaluate(c);if(h<0)throw new On(`Array index out of bounds: ${h} < 0.`);if(h>=g.length)throw new On(`Array index out of bounds: ${h} > ${g.length-1}.`);if(h!==Math.floor(h))throw new On(`Array index must be an integer, but found ${h} instead.`);return g[h]}eachChild(c){c(this.index),c(this.input)}outputDefined(){return!1}}class mc{constructor(c,h){this.type=Qe,this.needle=c,this.haystack=h}static parse(c,h){if(c.length!==3)return h.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const g=h.parse(c[1],1,ze),b=h.parse(c[2],2,ze);return g&&b?Qt(g.type,[Qe,gr,pe,gn,ze])?new mc(g,b):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Z(g.type)} instead`):null}evaluate(c){const h=this.needle.evaluate(c),g=this.haystack.evaluate(c);if(!g)return!1;if(!Gt(h,["boolean","string","number","null"]))throw new On(`Expected first argument to be of type boolean, string, number or null, but found ${Z(kn(h))} instead.`);if(!Gt(g,["string","array"]))throw new On(`Expected second argument to be of type array or string, but found ${Z(kn(g))} instead.`);return g.indexOf(h)>=0}eachChild(c){c(this.needle),c(this.haystack)}outputDefined(){return!0}}class ut{constructor(c,h,g){this.type=pe,this.needle=c,this.haystack=h,this.fromIndex=g}static parse(c,h){if(c.length<=2||c.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const g=h.parse(c[1],1,ze),b=h.parse(c[2],2,ze);if(!g||!b)return null;if(!Qt(g.type,[Qe,gr,pe,gn,ze]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Z(g.type)} instead`);if(c.length===4){const C=h.parse(c[3],3,pe);return C?new ut(g,b,C):null}return new ut(g,b)}evaluate(c){const h=this.needle.evaluate(c),g=this.haystack.evaluate(c);if(!Gt(h,["boolean","string","number","null"]))throw new On(`Expected first argument to be of type boolean, string, number or null, but found ${Z(kn(h))} instead.`);let b;if(this.fromIndex&&(b=this.fromIndex.evaluate(c)),Gt(g,["string"])){const C=g.indexOf(h,b);return C===-1?-1:[...g.slice(0,C)].length}if(Gt(g,["array"]))return g.indexOf(h,b);throw new On(`Expected second argument to be of type array or string, but found ${Z(kn(g))} instead.`)}eachChild(c){c(this.needle),c(this.haystack),this.fromIndex&&c(this.fromIndex)}outputDefined(){return!1}}class xt{constructor(c,h,g,b,C,T){this.inputType=c,this.type=h,this.input=g,this.cases=b,this.outputs=C,this.otherwise=T}static parse(c,h){if(c.length<5)return h.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if(c.length%2!=1)return h.error("Expected an even number of arguments.");let g,b;h.expectedType&&h.expectedType.kind!=="value"&&(b=h.expectedType);const C={},T=[];for(let k=2;k<c.length-1;k+=2){let G=c[k];const q=c[k+1];Array.isArray(G)||(G=[G]);const Y=h.concat(k);if(G.length===0)return Y.error("Expected at least one branch label.");for(const lt of G){if(typeof lt!="number"&&typeof lt!="string")return Y.error("Branch labels must be numbers or strings.");if(typeof lt=="number"&&Math.abs(lt)>Number.MAX_SAFE_INTEGER)return Y.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof lt=="number"&&Math.floor(lt)!==lt)return Y.error("Numeric branch labels must be integer values.");if(g){if(Y.checkSubtype(g,kn(lt)))return null}else g=kn(lt);if(C[String(lt)]!==void 0)return Y.error("Branch labels must be unique.");C[String(lt)]=T.length}const rt=h.parse(q,k,b);if(!rt)return null;b=b||rt.type,T.push(rt)}const F=h.parse(c[1],1,ze);if(!F)return null;const U=h.parse(c[c.length-1],c.length-1,b);return U?F.type.kind!=="value"&&h.concat(1).checkSubtype(g,F.type)?null:new xt(g,b,F,C,T,U):null}evaluate(c){const h=this.input.evaluate(c);return(kn(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(c)}eachChild(c){c(this.input),this.outputs.forEach(c),c(this.otherwise)}outputDefined(){return this.outputs.every(c=>c.outputDefined())&&this.otherwise.outputDefined()}}class kt{constructor(c,h,g){this.type=c,this.branches=h,this.otherwise=g}static parse(c,h){if(c.length<4)return h.error(`Expected at least 3 arguments, but found only ${c.length-1}.`);if(c.length%2!=0)return h.error("Expected an odd number of arguments.");let g;h.expectedType&&h.expectedType.kind!=="value"&&(g=h.expectedType);const b=[];for(let T=1;T<c.length-1;T+=2){const F=h.parse(c[T],T,Qe);if(!F)return null;const U=h.parse(c[T+1],T+1,g);if(!U)return null;b.push([F,U]),g=g||U.type}const C=h.parse(c[c.length-1],c.length-1,g);if(!C)return null;if(!g)throw new Error("Can't infer output type");return new kt(g,b,C)}evaluate(c){for(const[h,g]of this.branches)if(h.evaluate(c))return g.evaluate(c);return this.otherwise.evaluate(c)}eachChild(c){for(const[h,g]of this.branches)c(h),c(g);c(this.otherwise)}outputDefined(){return this.branches.every(c=>{let[h,g]=c;return g.outputDefined()})&&this.otherwise.outputDefined()}}class ae{constructor(c,h,g,b){this.type=c,this.input=h,this.beginIndex=g,this.endIndex=b}static parse(c,h){if(c.length<=2||c.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const g=h.parse(c[1],1,ze),b=h.parse(c[2],2,pe);if(!g||!b)return null;if(!Qt(g.type,[X(ze),gr,ze]))return h.error(`Expected first argument to be of type array or string, but found ${Z(g.type)} instead`);if(c.length===4){const C=h.parse(c[3],3,pe);return C?new ae(g.type,g,b,C):null}return new ae(g.type,g,b)}evaluate(c){const h=this.input.evaluate(c),g=this.beginIndex.evaluate(c);let b;if(this.endIndex&&(b=this.endIndex.evaluate(c)),Gt(h,["string"]))return[...h].slice(g,b).join("");if(Gt(h,["array"]))return h.slice(g,b);throw new On(`Expected first argument to be of type array or string, but found ${Z(kn(h))} instead.`)}eachChild(c){c(this.input),c(this.beginIndex),this.endIndex&&c(this.endIndex)}outputDefined(){return!1}}function Fe(u,c){const h=u.length-1;let g,b,C=0,T=h,F=0;for(;C<=T;)if(F=Math.floor((C+T)/2),g=u[F],b=u[F+1],g<=c){if(F===h||c<b)return F;C=F+1}else{if(!(g>c))throw new On("Input is not a number.");T=F-1}return 0}class Xe{constructor(c,h,g){this.type=c,this.input=h,this.labels=[],this.outputs=[];for(const[b,C]of g)this.labels.push(b),this.outputs.push(C)}static parse(c,h){if(c.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return h.error("Expected an even number of arguments.");const g=h.parse(c[1],1,pe);if(!g)return null;const b=[];let C=null;h.expectedType&&h.expectedType.kind!=="value"&&(C=h.expectedType);for(let T=1;T<c.length;T+=2){const F=T===1?-1/0:c[T],U=c[T+1],k=T,G=T+1;if(typeof F!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(b.length&&b[b.length-1][0]>=F)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const q=h.parse(U,G,C);if(!q)return null;C=C||q.type,b.push([F,q])}return new Xe(C,g,b)}evaluate(c){const h=this.labels,g=this.outputs;if(h.length===1)return g[0].evaluate(c);const b=this.input.evaluate(c);if(b<=h[0])return g[0].evaluate(c);const C=h.length;return b>=h[C-1]?g[C-1].evaluate(c):g[Fe(h,b)].evaluate(c)}eachChild(c){c(this.input);for(const h of this.outputs)c(h)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}}function zr(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var Xn=Jn;function Jn(u,c,h,g){this.cx=3*u,this.bx=3*(h-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(g-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=c,this.p2x=h,this.p2y=g}Jn.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,c){if(c===void 0&&(c=1e-6),u<0)return 0;if(u>1)return 1;for(var h=u,g=0;g<8;g++){var b=this.sampleCurveX(h)-u;if(Math.abs(b)<c)return h;var C=this.sampleCurveDerivativeX(h);if(Math.abs(C)<1e-6)break;h-=b/C}var T=0,F=1;for(h=u,g=0;g<20&&(b=this.sampleCurveX(h),!(Math.abs(b-u)<c));g++)u>b?T=h:F=h,h=.5*(F-T)+T;return h},solve:function(u,c){return this.sampleCurveY(this.solveCurveX(u,c))}};var Si=zr(Xn);function wn(u,c,h){return u+h*(c-u)}function yc(u,c,h){return u.map((g,b)=>wn(g,c[b],h))}const Zi={number:wn,color:function(u,c,h){switch(arguments.length>3&&arguments[3]!==void 0?arguments[3]:"rgb"){case"rgb":{const[b,C,T,F]=yc(u.rgb,c.rgb,h);return new or(b,C,T,F,!1)}case"hcl":{const[b,C,T,F]=u.hcl,[U,k,G,q]=c.hcl;let Y,rt;if(isNaN(b)||isNaN(U))isNaN(b)?isNaN(U)?Y=NaN:(Y=U,T!==1&&T!==0||(rt=k)):(Y=b,G!==1&&G!==0||(rt=C));else{let ne=U-b;U>b&&ne>180?ne-=360:U<b&&b-U>180&&(ne+=360),Y=b+h*ne}const[lt,yt,Tt,Ot]=function(ne){let[zt,Kt,ce,Te]=ne;return zt=isNaN(zt)?0:zt*tr,Xr([ce,Math.cos(zt)*Kt,Math.sin(zt)*Kt,Te])}([Y,rt??wn(C,k,h),wn(T,G,h),wn(F,q,h)]);return new or(lt,yt,Tt,Ot,!1)}case"lab":{const[b,C,T,F]=Xr(yc(u.lab,c.lab,h));return new or(b,C,T,F,!1)}}},array:yc,padding:function(u,c,h){return new yn(yc(u.values,c.values,h))},variableAnchorOffsetCollection:function(u,c,h){const g=u.values,b=c.values;if(g.length!==b.length)throw new On(`Cannot interpolate values of different length. from: ${u.toString()}, to: ${c.toString()}`);const C=[];for(let T=0;T<g.length;T+=2){if(g[T]!==b[T])throw new On(`Cannot interpolate values containing mismatched anchors. from[${T}]: ${g[T]}, to[${T}]: ${b[T]}`);C.push(g[T]);const[F,U]=g[T+1],[k,G]=b[T+1];C.push([wn(F,k,h),wn(U,G,h)])}return new bn(C)}};class Br{constructor(c,h,g,b,C){this.type=c,this.operator=h,this.interpolation=g,this.input=b,this.labels=[],this.outputs=[];for(const[T,F]of C)this.labels.push(T),this.outputs.push(F)}static interpolationFactor(c,h,g,b){let C=0;if(c.name==="exponential")C=tu(h,c.base,g,b);else if(c.name==="linear")C=tu(h,1,g,b);else if(c.name==="cubic-bezier"){const T=c.controlPoints;C=new Si(T[0],T[1],T[2],T[3]).solve(tu(h,1,g,b))}return C}static parse(c,h){let[g,b,C,...T]=c;if(!Array.isArray(b)||b.length===0)return h.error("Expected an interpolation type expression.",1);if(b[0]==="linear")b={name:"linear"};else if(b[0]==="exponential"){const k=b[1];if(typeof k!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);b={name:"exponential",base:k}}else{if(b[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(b[0])}`,1,0);{const k=b.slice(1);if(k.length!==4||k.some(G=>typeof G!="number"||G<0||G>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);b={name:"cubic-bezier",controlPoints:k}}}if(c.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(C=h.parse(C,2,pe),!C)return null;const F=[];let U=null;g==="interpolate-hcl"||g==="interpolate-lab"?U=Mr:h.expectedType&&h.expectedType.kind!=="value"&&(U=h.expectedType);for(let k=0;k<T.length;k+=2){const G=T[k],q=T[k+1],Y=k+3,rt=k+4;if(typeof G!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Y);if(F.length&&F[F.length-1][0]>=G)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Y);const lt=h.parse(q,rt,U);if(!lt)return null;U=U||lt.type,F.push([G,lt])}return Nt(U,pe)||Nt(U,Mr)||Nt(U,vn)||Nt(U,Ct)||Nt(U,X(pe))?new Br(U,g,b,C,F):h.error(`Type ${Z(U)} is not interpolatable.`)}evaluate(c){const h=this.labels,g=this.outputs;if(h.length===1)return g[0].evaluate(c);const b=this.input.evaluate(c);if(b<=h[0])return g[0].evaluate(c);const C=h.length;if(b>=h[C-1])return g[C-1].evaluate(c);const T=Fe(h,b),F=Br.interpolationFactor(this.interpolation,b,h[T],h[T+1]),U=g[T].evaluate(c),k=g[T+1].evaluate(c);switch(this.operator){case"interpolate":return Zi[this.type.kind](U,k,F);case"interpolate-hcl":return Zi.color(U,k,F,"hcl");case"interpolate-lab":return Zi.color(U,k,F,"lab")}}eachChild(c){c(this.input);for(const h of this.outputs)c(h)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}}function tu(u,c,h,g){const b=g-h,C=u-h;return b===0?0:c===1?C/b:(Math.pow(c,C)-1)/(Math.pow(c,b)-1)}class eu{constructor(c,h){this.type=c,this.args=h}static parse(c,h){if(c.length<2)return h.error("Expectected at least one argument.");let g=null;const b=h.expectedType;b&&b.kind!=="value"&&(g=b);const C=[];for(const F of c.slice(1)){const U=h.parse(F,1+C.length,g,void 0,{typeAnnotation:"omit"});if(!U)return null;g=g||U.type,C.push(U)}if(!g)throw new Error("No output type");const T=b&&C.some(F=>Bt(b,F.type));return new eu(T?ze:g,C)}evaluate(c){let h,g=null,b=0;for(const C of this.args)if(b++,g=C.evaluate(c),g&&g instanceof tn&&!g.available&&(h||(h=g.name),g=null,b===this.args.length&&(g=h)),g!==null)break;return g}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}function to(u,c){return u==="=="||u==="!="?c.kind==="boolean"||c.kind==="string"||c.kind==="number"||c.kind==="null"||c.kind==="value":c.kind==="string"||c.kind==="number"||c.kind==="value"}function lA(u,c,h,g){return g.compare(c,h)===0}function Wa(u,c,h){const g=u!=="=="&&u!=="!=";return class i8{constructor(C,T,F){this.type=Qe,this.lhs=C,this.rhs=T,this.collator=F,this.hasUntypedArgument=C.type.kind==="value"||T.type.kind==="value"}static parse(C,T){if(C.length!==3&&C.length!==4)return T.error("Expected two or three arguments.");const F=C[0];let U=T.parse(C[1],1,ze);if(!U)return null;if(!to(F,U.type))return T.concat(1).error(`"${F}" comparisons are not supported for type '${Z(U.type)}'.`);let k=T.parse(C[2],2,ze);if(!k)return null;if(!to(F,k.type))return T.concat(2).error(`"${F}" comparisons are not supported for type '${Z(k.type)}'.`);if(U.type.kind!==k.type.kind&&U.type.kind!=="value"&&k.type.kind!=="value")return T.error(`Cannot compare types '${Z(U.type)}' and '${Z(k.type)}'.`);g&&(U.type.kind==="value"&&k.type.kind!=="value"?U=new Pi(k.type,[U]):U.type.kind!=="value"&&k.type.kind==="value"&&(k=new Pi(U.type,[k])));let G=null;if(C.length===4){if(U.type.kind!=="string"&&k.type.kind!=="string"&&U.type.kind!=="value"&&k.type.kind!=="value")return T.error("Cannot use collator to compare non-string types.");if(G=T.parse(C[3],3,Nn),!G)return null}return new i8(U,k,G)}evaluate(C){const T=this.lhs.evaluate(C),F=this.rhs.evaluate(C);if(g&&this.hasUntypedArgument){const U=kn(T),k=kn(F);if(U.kind!==k.kind||U.kind!=="string"&&U.kind!=="number")throw new On(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${U.kind}, ${k.kind}) instead.`)}if(this.collator&&!g&&this.hasUntypedArgument){const U=kn(T),k=kn(F);if(U.kind!=="string"||k.kind!=="string")return c(C,T,F)}return this.collator?h(C,T,F,this.collator.evaluate(C)):c(C,T,F)}eachChild(C){C(this.lhs),C(this.rhs),this.collator&&C(this.collator)}outputDefined(){return!0}}}const ru=Wa("==",function(u,c,h){return c===h},lA),nu=Wa("!=",function(u,c,h){return c!==h},function(u,c,h,g){return!lA(0,c,h,g)}),dh=Wa("<",function(u,c,h){return c<h},function(u,c,h,g){return g.compare(c,h)<0}),Cd=Wa(">",function(u,c,h){return c>h},function(u,c,h,g){return g.compare(c,h)>0}),Ed=Wa("<=",function(u,c,h){return c<=h},function(u,c,h,g){return g.compare(c,h)<=0}),iu=Wa(">=",function(u,c,h){return c>=h},function(u,c,h,g){return g.compare(c,h)>=0});class Xo{constructor(c,h,g){this.type=Nn,this.locale=g,this.caseSensitive=c,this.diacriticSensitive=h}static parse(c,h){if(c.length!==2)return h.error("Expected one argument.");const g=c[1];if(typeof g!="object"||Array.isArray(g))return h.error("Collator options argument must be an object.");const b=h.parse(g["case-sensitive"]!==void 0&&g["case-sensitive"],1,Qe);if(!b)return null;const C=h.parse(g["diacritic-sensitive"]!==void 0&&g["diacritic-sensitive"],1,Qe);if(!C)return null;let T=null;return g.locale&&(T=h.parse(g.locale,1,gr),!T)?null:new Xo(b,C,T)}evaluate(c){return new Lr(this.caseSensitive.evaluate(c),this.diacriticSensitive.evaluate(c),this.locale?this.locale.evaluate(c):null)}eachChild(c){c(this.caseSensitive),c(this.diacriticSensitive),this.locale&&c(this.locale)}outputDefined(){return!1}}class _a{constructor(c,h,g,b,C){this.type=gr,this.number=c,this.locale=h,this.currency=g,this.minFractionDigits=b,this.maxFractionDigits=C}static parse(c,h){if(c.length!==3)return h.error("Expected two arguments.");const g=h.parse(c[1],1,pe);if(!g)return null;const b=c[2];if(typeof b!="object"||Array.isArray(b))return h.error("NumberFormat options argument must be an object.");let C=null;if(b.locale&&(C=h.parse(b.locale,1,gr),!C))return null;let T=null;if(b.currency&&(T=h.parse(b.currency,1,gr),!T))return null;let F=null;if(b["min-fraction-digits"]&&(F=h.parse(b["min-fraction-digits"],1,pe),!F))return null;let U=null;return b["max-fraction-digits"]&&(U=h.parse(b["max-fraction-digits"],1,pe),!U)?null:new _a(g,C,T,F,U)}evaluate(c){return new Intl.NumberFormat(this.locale?this.locale.evaluate(c):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(c):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(c):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(c):void 0}).format(this.number.evaluate(c))}eachChild(c){c(this.number),this.locale&&c(this.locale),this.currency&&c(this.currency),this.minFractionDigits&&c(this.minFractionDigits),this.maxFractionDigits&&c(this.maxFractionDigits)}outputDefined(){return!1}}class su{constructor(c){this.type=sn,this.sections=c}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");const g=c[1];if(!Array.isArray(g)&&typeof g=="object")return h.error("First argument must be an image or text section.");const b=[];let C=!1;for(let T=1;T<=c.length-1;++T){const F=c[T];if(C&&typeof F=="object"&&!Array.isArray(F)){C=!1;let U=null;if(F["font-scale"]&&(U=h.parse(F["font-scale"],1,pe),!U))return null;let k=null;if(F["text-font"]&&(k=h.parse(F["text-font"],1,X(gr)),!k))return null;let G=null;if(F["text-color"]&&(G=h.parse(F["text-color"],1,Mr),!G))return null;const q=b[b.length-1];q.scale=U,q.font=k,q.textColor=G}else{const U=h.parse(c[T],1,ze);if(!U)return null;const k=U.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");C=!0,b.push({content:U,scale:null,font:null,textColor:null})}}return new su(b)}evaluate(c){return new qr(this.sections.map(h=>{const g=h.content.evaluate(c);return kn(g)===cn?new Pn("",g,null,null,null):new Pn(hn(g),null,h.scale?h.scale.evaluate(c):null,h.font?h.font.evaluate(c).join(","):null,h.textColor?h.textColor.evaluate(c):null)}))}eachChild(c){for(const h of this.sections)c(h.content),h.scale&&c(h.scale),h.font&&c(h.font),h.textColor&&c(h.textColor)}outputDefined(){return!1}}class Xa{constructor(c){this.type=cn,this.input=c}static parse(c,h){if(c.length!==2)return h.error("Expected two arguments.");const g=h.parse(c[1],1,gr);return g?new Xa(g):h.error("No image name provided.")}evaluate(c){const h=this.input.evaluate(c),g=tn.fromString(h);return g&&c.availableImages&&(g.available=c.availableImages.indexOf(h)>-1),g}eachChild(c){c(this.input)}outputDefined(){return!1}}class _c{constructor(c){this.type=pe,this.input=c}static parse(c,h){if(c.length!==2)return h.error(`Expected 1 argument, but found ${c.length-1} instead.`);const g=h.parse(c[1],1);return g?g.type.kind!=="array"&&g.type.kind!=="string"&&g.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${Z(g.type)} instead.`):new _c(g):null}evaluate(c){const h=this.input.evaluate(c);if(typeof h=="string")return[...h].length;if(Array.isArray(h))return h.length;throw new On(`Expected value to be of type string or array, but found ${Z(kn(h))} instead.`)}eachChild(c){c(this.input)}outputDefined(){return!1}}const Cs=8192;function fh(u,c){const h=(180+u[0])/360,g=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,b=Math.pow(2,c.z);return[Math.round(h*b*Cs),Math.round(g*b*Cs)]}function ou(u,c){const h=Math.pow(2,c.z);return[(b=(u[0]/Cs+c.x)/h,360*b-180),(g=(u[1]/Cs+c.y)/h,360/Math.PI*Math.atan(Math.exp((180-360*g)*Math.PI/180))-90)];var g,b}function va(u,c){u[0]=Math.min(u[0],c[0]),u[1]=Math.min(u[1],c[1]),u[2]=Math.max(u[2],c[0]),u[3]=Math.max(u[3],c[1])}function Jo(u,c){return!(u[0]<=c[0]||u[2]>=c[2]||u[1]<=c[1]||u[3]>=c[3])}function en(u,c,h){const g=u[0]-c[0],b=u[1]-c[1],C=u[0]-h[0],T=u[1]-h[1];return g*T-C*b==0&&g*C<=0&&b*T<=0}function Yo(u,c,h,g){return(b=[g[0]-h[0],g[1]-h[1]])[0]*(C=[c[0]-u[0],c[1]-u[1]])[1]-b[1]*C[0]!=0&&!(!ph(u,c,h,g)||!ph(h,g,u,c));var b,C}function Sd(u,c,h){for(const g of h)for(let b=0;b<g.length-1;++b)if(Yo(u,c,g[b],g[b+1]))return!0;return!1}function eo(u,c){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,g=!1;for(const F of c)for(let U=0;U<F.length-1;U++){if(en(u,F[U],F[U+1]))return h;(C=F[U])[1]>(b=u)[1]!=(T=F[U+1])[1]>b[1]&&b[0]<(T[0]-C[0])*(b[1]-C[1])/(T[1]-C[1])+C[0]&&(g=!g)}var b,C,T;return g}function Zo(u,c){for(const h of c)if(eo(u,h))return!0;return!1}function au(u,c){for(const h of u)if(!eo(h,c))return!1;for(let h=0;h<u.length-1;++h)if(Sd(u[h],u[h+1],c))return!1;return!0}function vc(u,c){for(const h of c)if(au(u,h))return!0;return!1}function ph(u,c,h,g){const b=g[0]-h[0],C=g[1]-h[1],T=(u[0]-h[0])*C-b*(u[1]-h[1]),F=(c[0]-h[0])*C-b*(c[1]-h[1]);return T>0&&F<0||T<0&&F>0}function El(u,c,h){const g=[];for(let b=0;b<u.length;b++){const C=[];for(let T=0;T<u[b].length;T++){const F=fh(u[b][T],h);va(c,F),C.push(F)}g.push(C)}return g}function gh(u,c,h){const g=[];for(let b=0;b<u.length;b++){const C=El(u[b],c,h);g.push(C)}return g}function lu(u,c,h,g){if(u[0]<h[0]||u[0]>h[2]){const b=.5*g;let C=u[0]-h[0]>b?-g:h[0]-u[0]>b?g:0;C===0&&(C=u[0]-h[2]>b?-g:h[2]-u[0]>b?g:0),u[0]+=C}va(c,u)}function cu(u,c,h,g){const b=Math.pow(2,g.z)*Cs,C=[g.x*Cs,g.y*Cs],T=[];for(const F of u)for(const U of F){const k=[U.x+C[0],U.y+C[1]];lu(k,c,h,b),T.push(k)}return T}function cA(u,c,h,g){const b=Math.pow(2,g.z)*Cs,C=[g.x*Cs,g.y*Cs],T=[];for(const U of u){const k=[];for(const G of U){const q=[G.x+C[0],G.y+C[1]];va(c,q),k.push(q)}T.push(k)}if(c[2]-c[0]<=b/2){(F=c)[0]=F[1]=1/0,F[2]=F[3]=-1/0;for(const U of T)for(const k of U)lu(k,c,h,b)}var F;return T}class Bo{constructor(c,h){this.type=Qe,this.geojson=c,this.geometries=h}static parse(c,h){if(c.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${c.length-1} instead.`);if(ws(c[1])){const g=c[1];if(g.type==="FeatureCollection"){const b=[];for(const C of g.features){const{type:T,coordinates:F}=C.geometry;T==="Polygon"&&b.push(F),T==="MultiPolygon"&&b.push(...F)}if(b.length)return new Bo(g,{type:"MultiPolygon",coordinates:b})}else if(g.type==="Feature"){const b=g.geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new Bo(g,g.geometry)}else if(g.type==="Polygon"||g.type==="MultiPolygon")return new Bo(g,g)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(h,g){const b=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],T=h.canonicalID();if(g.type==="Polygon"){const F=El(g.coordinates,C,T),U=cu(h.geometry(),b,C,T);if(!Jo(b,C))return!1;for(const k of U)if(!eo(k,F))return!1}if(g.type==="MultiPolygon"){const F=gh(g.coordinates,C,T),U=cu(h.geometry(),b,C,T);if(!Jo(b,C))return!1;for(const k of U)if(!Zo(k,F))return!1}return!0}(c,this.geometries);if(c.geometryType()==="LineString")return function(h,g){const b=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],T=h.canonicalID();if(g.type==="Polygon"){const F=El(g.coordinates,C,T),U=cA(h.geometry(),b,C,T);if(!Jo(b,C))return!1;for(const k of U)if(!au(k,F))return!1}if(g.type==="MultiPolygon"){const F=gh(g.coordinates,C,T),U=cA(h.geometry(),b,C,T);if(!Jo(b,C))return!1;for(const k of U)if(!vc(k,F))return!1}return!0}(c,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let uu=class{constructor(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(h,g)=>h<g?-1:h>g?1:0;if(this.data=u,this.length=this.data.length,this.compare=c,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(u){this.data.push(u),this._up(this.length++)}pop(){if(this.length===0)return;const u=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:c,compare:h}=this,g=c[u];for(;u>0;){const b=u-1>>1,C=c[b];if(h(g,C)>=0)break;c[u]=C,u=b}c[u]=g}_down(u){const{data:c,compare:h}=this,g=this.length>>1,b=c[u];for(;u<g;){let C=1+(u<<1);const T=C+1;if(T<this.length&&h(c[T],c[C])<0&&(C=T),h(c[C],b)>=0)break;c[u]=c[C],u=C}c[u]=b}};function uA(u,c,h,g,b){AA(u,c,h,g||u.length-1,b||Au)}function AA(u,c,h,g,b){for(;g>h;){if(g-h>600){var C=g-h+1,T=c-h+1,F=Math.log(C),U=.5*Math.exp(2*F/3),k=.5*Math.sqrt(F*U*(C-U)/C)*(T-C/2<0?-1:1);AA(u,c,Math.max(h,Math.floor(c-T*U/C+k)),Math.min(g,Math.floor(c+(C-T)*U/C+k)),b)}var G=u[c],q=h,Y=g;for(bc(u,h,c),b(u[g],G)>0&&bc(u,h,g);q<Y;){for(bc(u,q,Y),q++,Y--;b(u[q],G)<0;)q++;for(;b(u[Y],G)>0;)Y--}b(u[h],G)===0?bc(u,h,Y):bc(u,++Y,g),Y<=c&&(h=Y+1),c<=Y&&(g=Y-1)}}function bc(u,c,h){var g=u[c];u[c]=u[h],u[h]=g}function Au(u,c){return u<c?-1:u>c?1:0}function ba(u,c){if(u.length<=1)return[u];const h=[];let g,b;for(const C of u){const T=Sl(C);T!==0&&(C.area=Math.abs(T),b===void 0&&(b=T<0),b===T<0?(g&&h.push(g),g=[C]):g.push(C))}if(g&&h.push(g),c>1)for(let C=0;C<h.length;C++)h[C].length<=c||(uA(h[C],c,1,h[C].length-1,hA),h[C]=h[C].slice(0,c));return h}function hA(u,c){return c.area-u.area}function Sl(u){let c=0;for(let h,g,b=0,C=u.length,T=C-1;b<C;T=b++)h=u[b],g=u[T],c+=(g.x-h.x)*(h.y+g.y);return c}const hu=1/298.257223563,O=hu*(2-hu),nt=Math.PI/180;class Lt{constructor(c){const h=6378.137*nt*1e3,g=Math.cos(c*nt),b=1/(1-O*(1-g*g)),C=Math.sqrt(b);this.kx=h*C*g,this.ky=h*C*b*(1-O)}distance(c,h){const g=this.wrap(c[0]-h[0])*this.kx,b=(c[1]-h[1])*this.ky;return Math.sqrt(g*g+b*b)}pointOnLine(c,h){let g,b,C,T,F=1/0;for(let U=0;U<c.length-1;U++){let k=c[U][0],G=c[U][1],q=this.wrap(c[U+1][0]-k)*this.kx,Y=(c[U+1][1]-G)*this.ky,rt=0;q===0&&Y===0||(rt=(this.wrap(h[0]-k)*this.kx*q+(h[1]-G)*this.ky*Y)/(q*q+Y*Y),rt>1?(k=c[U+1][0],G=c[U+1][1]):rt>0&&(k+=q/this.kx*rt,G+=Y/this.ky*rt)),q=this.wrap(h[0]-k)*this.kx,Y=(h[1]-G)*this.ky;const lt=q*q+Y*Y;lt<F&&(F=lt,g=k,b=G,C=U,T=rt)}return{point:[g,b],index:C,t:Math.max(0,Math.min(1,T))}}wrap(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}}function Ht(u,c){return c[0]-u[0]}function ee(u){return u[1]-u[0]+1}function Ae(u,c){return u[1]>=u[0]&&u[1]<c}function Re(u,c){if(u[0]>u[1])return[null,null];const h=ee(u);if(c){if(h===2)return[u,null];const b=Math.floor(h/2);return[[u[0],u[0]+b],[u[0]+b,u[1]]]}if(h===1)return[u,null];const g=Math.floor(h/2)-1;return[[u[0],u[0]+g],[u[0]+g+1,u[1]]]}function er(u,c){if(!Ae(c,u.length))return[1/0,1/0,-1/0,-1/0];const h=[1/0,1/0,-1/0,-1/0];for(let g=c[0];g<=c[1];++g)va(h,u[g]);return h}function Tr(u){const c=[1/0,1/0,-1/0,-1/0];for(const h of u)for(const g of h)va(c,g);return c}function Hr(u){return u[0]!==-1/0&&u[1]!==-1/0&&u[2]!==1/0&&u[3]!==1/0}function Wr(u,c,h){if(!Hr(u)||!Hr(c))return NaN;let g=0,b=0;return u[2]<c[0]&&(g=c[0]-u[2]),u[0]>c[2]&&(g=u[0]-c[2]),u[1]>c[3]&&(b=u[1]-c[3]),u[3]<c[1]&&(b=c[1]-u[3]),h.distance([0,0],[g,b])}function rn(u,c,h){const g=h.pointOnLine(c,u);return h.distance(u,g.point)}function Yn(u,c,h,g,b){const C=Math.min(rn(u,[h,g],b),rn(c,[h,g],b)),T=Math.min(rn(h,[u,c],b),rn(g,[u,c],b));return Math.min(C,T)}function bi(u,c,h,g,b){if(!Ae(c,u.length)||!Ae(g,h.length))return 1/0;let C=1/0;for(let T=c[0];T<c[1];++T){const F=u[T],U=u[T+1];for(let k=g[0];k<g[1];++k){const G=h[k],q=h[k+1];if(Yo(F,U,G,q))return 0;C=Math.min(C,Yn(F,U,G,q,b))}}return C}function Jr(u,c,h,g,b){if(!Ae(c,u.length)||!Ae(g,h.length))return NaN;let C=1/0;for(let T=c[0];T<=c[1];++T)for(let F=g[0];F<=g[1];++F)if(C=Math.min(C,b.distance(u[T],h[F])),C===0)return C;return C}function ls(u,c,h){if(eo(u,c,!0))return 0;let g=1/0;for(const b of c){const C=b[0],T=b[b.length-1];if(C!==T&&(g=Math.min(g,rn(u,[T,C],h)),g===0))return g;const F=h.pointOnLine(b,u);if(g=Math.min(g,h.distance(u,F.point)),g===0)return g}return g}function Cr(u,c,h,g){if(!Ae(c,u.length))return NaN;for(let C=c[0];C<=c[1];++C)if(eo(u[C],h,!0))return 0;let b=1/0;for(let C=c[0];C<c[1];++C){const T=u[C],F=u[C+1];for(const U of h)for(let k=0,G=U.length,q=G-1;k<G;q=k++){const Y=U[q],rt=U[k];if(Yo(T,F,Y,rt))return 0;b=Math.min(b,Yn(T,F,Y,rt,g))}}return b}function zs(u,c){for(const h of u)for(const g of h)if(eo(g,c,!0))return!0;return!1}function An(u,c,h){let g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1/0;const b=Tr(u),C=Tr(c);if(g!==1/0&&Wr(b,C,h)>=g)return g;if(Jo(b,C)){if(zs(u,c))return 0}else if(zs(c,u))return 0;let T=1/0;for(const F of u)for(let U=0,k=F.length,G=k-1;U<k;G=U++){const q=F[G],Y=F[U];for(const rt of c)for(let lt=0,yt=rt.length,Tt=yt-1;lt<yt;Tt=lt++){const Ot=rt[Tt],ne=rt[lt];if(Yo(q,Y,Ot,ne))return 0;T=Math.min(T,Yn(q,Y,Ot,ne,h))}}return T}function dn(u,c,h,g,b,C){if(!C)return;const T=Wr(er(g,C),b,h);T<c&&u.push([T,C,[0,0]])}function wa(u,c,h,g,b,C,T){if(!C||!T)return;const F=Wr(er(g,C),er(b,T),h);F<c&&u.push([F,C,T])}function Ja(u,c,h,g){let b=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1/0,C=Math.min(g.distance(u[0],h[0][0]),b);if(C===0)return C;const T=new uu([[0,[0,u.length-1],[0,0]]],Ht),F=Tr(h);for(;T.length>0;){const U=T.pop();if(U[0]>=C)continue;const k=U[1],G=c?50:100;if(ee(k)<=G){if(!Ae(k,u.length))return NaN;if(c){const q=Cr(u,k,h,g);if(isNaN(q)||q===0)return q;C=Math.min(C,q)}else for(let q=k[0];q<=k[1];++q){const Y=ls(u[q],h,g);if(C=Math.min(C,Y),C===0)return 0}}else{const q=Re(k,c);dn(T,C,g,u,F,q[0]),dn(T,C,g,u,F,q[1])}}return C}function Ya(u,c,h,g,b){let C=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1/0,T=Math.min(C,b.distance(u[0],h[0]));if(T===0)return T;const F=new uu([[0,[0,u.length-1],[0,h.length-1]]],Ht);for(;F.length>0;){const U=F.pop();if(U[0]>=T)continue;const k=U[1],G=U[2],q=c?50:100,Y=g?50:100;if(ee(k)<=q&&ee(G)<=Y){if(!Ae(k,u.length)&&Ae(G,h.length))return NaN;let rt;if(c&&g)rt=bi(u,k,h,G,b),T=Math.min(T,rt);else if(c&&!g){const lt=u.slice(k[0],k[1]+1);for(let yt=G[0];yt<=G[1];++yt)if(rt=rn(h[yt],lt,b),T=Math.min(T,rt),T===0)return T}else if(!c&&g){const lt=h.slice(G[0],G[1]+1);for(let yt=k[0];yt<=k[1];++yt)if(rt=rn(u[yt],lt,b),T=Math.min(T,rt),T===0)return T}else rt=Jr(u,k,h,G,b),T=Math.min(T,rt)}else{const rt=Re(k,c),lt=Re(G,g);wa(F,T,b,u,h,rt[0],lt[0]),wa(F,T,b,u,h,rt[0],lt[1]),wa(F,T,b,u,h,rt[1],lt[0]),wa(F,T,b,u,h,rt[1],lt[1])}}return T}function Tl(u){return u.type==="MultiPolygon"?u.coordinates.map(c=>({type:"Polygon",coordinates:c})):u.type==="MultiLineString"?u.coordinates.map(c=>({type:"LineString",coordinates:c})):u.type==="MultiPoint"?u.coordinates.map(c=>({type:"Point",coordinates:c})):[u]}class ta{constructor(c,h){this.type=pe,this.geojson=c,this.geometries=h}static parse(c,h){if(c.length!==2)return h.error(`'distance' expression requires exactly one argument, but found ${c.length-1} instead.`);if(ws(c[1])){const g=c[1];if(g.type==="FeatureCollection")return new ta(g,g.features.map(b=>Tl(b.geometry)).flat());if(g.type==="Feature")return new ta(g,Tl(g.geometry));if("type"in g&&"coordinates"in g)return new ta(g,Tl(g))}return h.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(h,g){const b=h.geometry(),C=b.flat().map(U=>ou([U.x,U.y],h.canonical));if(b.length===0)return NaN;const T=new Lt(C[0][1]);let F=1/0;for(const U of g){switch(U.type){case"Point":F=Math.min(F,Ya(C,!1,[U.coordinates],!1,T,F));break;case"LineString":F=Math.min(F,Ya(C,!1,U.coordinates,!0,T,F));break;case"Polygon":F=Math.min(F,Ja(C,!1,U.coordinates,T,F))}if(F===0)return F}return F}(c,this.geometries);if(c.geometryType()==="LineString")return function(h,g){const b=h.geometry(),C=b.flat().map(U=>ou([U.x,U.y],h.canonical));if(b.length===0)return NaN;const T=new Lt(C[0][1]);let F=1/0;for(const U of g){switch(U.type){case"Point":F=Math.min(F,Ya(C,!0,[U.coordinates],!1,T,F));break;case"LineString":F=Math.min(F,Ya(C,!0,U.coordinates,!0,T,F));break;case"Polygon":F=Math.min(F,Ja(C,!0,U.coordinates,T,F))}if(F===0)return F}return F}(c,this.geometries);if(c.geometryType()==="Polygon")return function(h,g){const b=h.geometry();if(b.length===0||b[0].length===0)return NaN;const C=ba(b,0).map(U=>U.map(k=>k.map(G=>ou([G.x,G.y],h.canonical)))),T=new Lt(C[0][0][0][1]);let F=1/0;for(const U of g)for(const k of C){switch(U.type){case"Point":F=Math.min(F,Ja([U.coordinates],!1,k,T,F));break;case"LineString":F=Math.min(F,Ja(U.coordinates,!0,k,T,F));break;case"Polygon":F=Math.min(F,An(k,U.coordinates,T,F))}if(F===0)return F}return F}(c,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const xa={"==":ru,"!=":nu,">":Cd,"<":dh,">=":iu,"<=":Ed,array:Pi,at:Cl,boolean:Pi,case:kt,coalesce:eu,collator:Xo,format:su,image:Xa,in:mc,"index-of":ut,interpolate:Br,"interpolate-hcl":Br,"interpolate-lab":Br,length:_c,let:Bs,literal:Li,match:xt,number:Pi,"number-format":_a,object:Pi,slice:ae,step:Xe,string:Pi,"to-boolean":qn,"to-color":qn,"to-number":qn,"to-string":qn,var:un,within:Bo,distance:ta};class ts{constructor(c,h,g,b){this.name=c,this.type=h,this._evaluate=g,this.args=b}evaluate(c){return this._evaluate(c,this.args)}eachChild(c){this.args.forEach(c)}outputDefined(){return!1}static parse(c,h){const g=c[0],b=ts.definitions[g];if(!b)return h.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0);const C=Array.isArray(b)?b[0]:b.type,T=Array.isArray(b)?[[b[1],b[2]]]:b.overloads,F=T.filter(k=>{let[G]=k;return!Array.isArray(G)||G.length===c.length-1});let U=null;for(const[k,G]of F){U=new Qs(h.registry,Za,h.path,null,h.scope);const q=[];let Y=!1;for(let rt=1;rt<c.length;rt++){const lt=c[rt],yt=Array.isArray(k)?k[rt-1]:k.type,Tt=U.parse(lt,1+q.length,yt);if(!Tt){Y=!0;break}q.push(Tt)}if(!Y)if(Array.isArray(k)&&k.length!==q.length)U.error(`Expected ${k.length} arguments, but found ${q.length} instead.`);else{for(let rt=0;rt<q.length;rt++){const lt=Array.isArray(k)?k[rt]:k.type,yt=q[rt];U.concat(rt+1).checkSubtype(lt,yt.type)}if(U.errors.length===0)return new ts(g,C,G,q)}}if(F.length===1)h.errors.push(...U.errors);else{const k=(F.length?F:T).map(q=>{let[Y]=q;return rt=Y,Array.isArray(rt)?`(${rt.map(Z).join(", ")})`:`(${Z(rt.type)}...)`;var rt}).join(" | "),G=[];for(let q=1;q<c.length;q++){const Y=h.parse(c[q],1+G.length);if(!Y)return null;G.push(Z(Y.type))}h.error(`Expected arguments of type ${k}, but found (${G.join(", ")}) instead.`)}return null}static register(c,h){ts.definitions=h;for(const g in h)c[g]=ts}}function cs(u,c){let[h,g,b,C]=c;h=h.evaluate(u),g=g.evaluate(u),b=b.evaluate(u);const T=C?C.evaluate(u):1,F=$o(h,g,b,T);if(F)throw new On(F);return new or(h/255,g/255,b/255,T,!1)}function Il(u,c){return u in c}function Fl(u,c){const h=c[u];return h===void 0?null:h}function Co(u){return{type:u}}function Za(u){if(u instanceof un)return Za(u.boundExpression);if(u instanceof ts&&u.name==="error"||u instanceof Xo||u instanceof Bo||u instanceof ta)return!1;const c=u instanceof qn||u instanceof Pi;let h=!0;return u.eachChild(g=>{h=c?h&&Za(g):h&&g instanceof Li}),!!h&&zi(u)&&tl(u,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function zi(u){if(u instanceof ts&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof Bo||u instanceof ta)return!1;let c=!0;return u.eachChild(h=>{c&&!zi(h)&&(c=!1)}),c}function Ll(u){if(u instanceof ts&&u.name==="feature-state")return!1;let c=!0;return u.eachChild(h=>{c&&!Ll(h)&&(c=!1)}),c}function tl(u,c){if(u instanceof ts&&c.indexOf(u.name)>=0)return!1;let h=!0;return u.eachChild(g=>{h&&!tl(g,c)&&(h=!1)}),h}function wc(u){return{result:"success",value:u}}function us(u){return{result:"error",value:u}}function Ba(u){return u["property-type"]==="data-driven"||u["property-type"]==="cross-faded-data-driven"}function mh(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function dA(u){return!!u.expression&&u.expression.interpolated}function Yr(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function Es(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function ea(u){return u}function el(u,c){const h=c.type==="color",g=u.stops&&typeof u.stops[0][0]=="object",b=g||!(g||u.property!==void 0),C=u.type||(dA(c)?"exponential":"interval");if(h||c.type==="padding"){const G=h?or.parse:yn.parse;(u=ur({},u)).stops&&(u.stops=u.stops.map(q=>[q[0],G(q[1])])),u.default=G(u.default?u.default:c.default)}if(u.colorSpace&&(T=u.colorSpace)!=="rgb"&&T!=="hcl"&&T!=="lab")throw new Error(`Unknown color space: "${u.colorSpace}"`);var T;let F,U,k;if(C==="exponential")F=Eo;else if(C==="interval")F=rl;else if(C==="categorical"){F=Ca,U=Object.create(null);for(const G of u.stops)U[G[0]]=G[1];k=typeof u.stops[0][0]}else{if(C!=="identity")throw new Error(`Unknown function type "${C}"`);F=xc}if(g){const G={},q=[];for(let lt=0;lt<u.stops.length;lt++){const yt=u.stops[lt],Tt=yt[0].zoom;G[Tt]===void 0&&(G[Tt]={zoom:Tt,type:u.type,property:u.property,default:u.default,stops:[]},q.push(Tt)),G[Tt].stops.push([yt[0].value,yt[1]])}const Y=[];for(const lt of q)Y.push([G[lt].zoom,el(G[lt],c)]);const rt={name:"linear"};return{kind:"composite",interpolationType:rt,interpolationFactor:Br.interpolationFactor.bind(void 0,rt),zoomStops:Y.map(lt=>lt[0]),evaluate:(lt,yt)=>{let{zoom:Tt}=lt;return Eo({stops:Y,base:u.base},c,Tt).evaluate(Tt,yt)}}}if(b){const G=C==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:G,interpolationFactor:Br.interpolationFactor.bind(void 0,G),zoomStops:u.stops.map(q=>q[0]),evaluate:q=>{let{zoom:Y}=q;return F(u,c,Y,U,k)}}}return{kind:"source",evaluate(G,q){const Y=q&&q.properties?q.properties[u.property]:void 0;return Y===void 0?Ss(u.default,c.default):F(u,c,Y,U,k)}}}function Ss(u,c,h){return u!==void 0?u:c!==void 0?c:h!==void 0?h:void 0}function Ca(u,c,h,g,b){return Ss(typeof h===b?g[h]:void 0,u.default,c.default)}function rl(u,c,h){if(Yr(h)!=="number")return Ss(u.default,c.default);const g=u.stops.length;if(g===1||h<=u.stops[0][0])return u.stops[0][1];if(h>=u.stops[g-1][0])return u.stops[g-1][1];const b=Fe(u.stops.map(C=>C[0]),h);return u.stops[b][1]}function Eo(u,c,h){const g=u.base!==void 0?u.base:1;if(Yr(h)!=="number")return Ss(u.default,c.default);const b=u.stops.length;if(b===1||h<=u.stops[0][0])return u.stops[0][1];if(h>=u.stops[b-1][0])return u.stops[b-1][1];const C=Fe(u.stops.map(G=>G[0]),h),T=function(G,q,Y,rt){const lt=rt-Y,yt=G-Y;return lt===0?0:q===1?yt/lt:(Math.pow(q,yt)-1)/(Math.pow(q,lt)-1)}(h,g,u.stops[C][0],u.stops[C+1][0]),F=u.stops[C][1],U=u.stops[C+1][1],k=Zi[c.type]||ea;return typeof F.evaluate=="function"?{evaluate(){for(var G=arguments.length,q=new Array(G),Y=0;Y<G;Y++)q[Y]=arguments[Y];const rt=F.evaluate.apply(void 0,q),lt=U.evaluate.apply(void 0,q);if(rt!==void 0&&lt!==void 0)return k(rt,lt,T,u.colorSpace)}}:k(F,U,T,u.colorSpace)}function xc(u,c,h){switch(c.type){case"color":h=or.parse(h);break;case"formatted":h=qr.fromString(h.toString());break;case"resolvedImage":h=tn.fromString(h.toString());break;case"padding":h=yn.parse(h);break;default:Yr(h)===c.type||c.type==="enum"&&c.values[h]||(h=void 0)}return Ss(h,u.default,c.default)}ts.register(xa,{error:[{kind:"error"},[gr],(u,c)=>{let[h]=c;throw new On(h.evaluate(u))}],typeof:[gr,[ze],(u,c)=>{let[h]=c;return Z(kn(h.evaluate(u)))}],"to-rgba":[X(pe,4),[Mr],(u,c)=>{let[h]=c;const[g,b,C,T]=h.evaluate(u).rgb;return[255*g,255*b,255*C,T]}],rgb:[Mr,[pe,pe,pe],cs],rgba:[Mr,[pe,pe,pe,pe],cs],has:{type:Qe,overloads:[[[gr],(u,c)=>{let[h]=c;return Il(h.evaluate(u),u.properties())}],[[gr,_n],(u,c)=>{let[h,g]=c;return Il(h.evaluate(u),g.evaluate(u))}]]},get:{type:ze,overloads:[[[gr],(u,c)=>{let[h]=c;return Fl(h.evaluate(u),u.properties())}],[[gr,_n],(u,c)=>{let[h,g]=c;return Fl(h.evaluate(u),g.evaluate(u))}]]},"feature-state":[ze,[gr],(u,c)=>{let[h]=c;return Fl(h.evaluate(u),u.featureState||{})}],properties:[_n,[],u=>u.properties()],"geometry-type":[gr,[],u=>u.geometryType()],id:[ze,[],u=>u.id()],zoom:[pe,[],u=>u.globals.zoom],"heatmap-density":[pe,[],u=>u.globals.heatmapDensity||0],"line-progress":[pe,[],u=>u.globals.lineProgress||0],accumulated:[ze,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[pe,Co(pe),(u,c)=>{let h=0;for(const g of c)h+=g.evaluate(u);return h}],"*":[pe,Co(pe),(u,c)=>{let h=1;for(const g of c)h*=g.evaluate(u);return h}],"-":{type:pe,overloads:[[[pe,pe],(u,c)=>{let[h,g]=c;return h.evaluate(u)-g.evaluate(u)}],[[pe],(u,c)=>{let[h]=c;return-h.evaluate(u)}]]},"/":[pe,[pe,pe],(u,c)=>{let[h,g]=c;return h.evaluate(u)/g.evaluate(u)}],"%":[pe,[pe,pe],(u,c)=>{let[h,g]=c;return h.evaluate(u)%g.evaluate(u)}],ln2:[pe,[],()=>Math.LN2],pi:[pe,[],()=>Math.PI],e:[pe,[],()=>Math.E],"^":[pe,[pe,pe],(u,c)=>{let[h,g]=c;return Math.pow(h.evaluate(u),g.evaluate(u))}],sqrt:[pe,[pe],(u,c)=>{let[h]=c;return Math.sqrt(h.evaluate(u))}],log10:[pe,[pe],(u,c)=>{let[h]=c;return Math.log(h.evaluate(u))/Math.LN10}],ln:[pe,[pe],(u,c)=>{let[h]=c;return Math.log(h.evaluate(u))}],log2:[pe,[pe],(u,c)=>{let[h]=c;return Math.log(h.evaluate(u))/Math.LN2}],sin:[pe,[pe],(u,c)=>{let[h]=c;return Math.sin(h.evaluate(u))}],cos:[pe,[pe],(u,c)=>{let[h]=c;return Math.cos(h.evaluate(u))}],tan:[pe,[pe],(u,c)=>{let[h]=c;return Math.tan(h.evaluate(u))}],asin:[pe,[pe],(u,c)=>{let[h]=c;return Math.asin(h.evaluate(u))}],acos:[pe,[pe],(u,c)=>{let[h]=c;return Math.acos(h.evaluate(u))}],atan:[pe,[pe],(u,c)=>{let[h]=c;return Math.atan(h.evaluate(u))}],min:[pe,Co(pe),(u,c)=>Math.min(...c.map(h=>h.evaluate(u)))],max:[pe,Co(pe),(u,c)=>Math.max(...c.map(h=>h.evaluate(u)))],abs:[pe,[pe],(u,c)=>{let[h]=c;return Math.abs(h.evaluate(u))}],round:[pe,[pe],(u,c)=>{let[h]=c;const g=h.evaluate(u);return g<0?-Math.round(-g):Math.round(g)}],floor:[pe,[pe],(u,c)=>{let[h]=c;return Math.floor(h.evaluate(u))}],ceil:[pe,[pe],(u,c)=>{let[h]=c;return Math.ceil(h.evaluate(u))}],"filter-==":[Qe,[gr,ze],(u,c)=>{let[h,g]=c;return u.properties()[h.value]===g.value}],"filter-id-==":[Qe,[ze],(u,c)=>{let[h]=c;return u.id()===h.value}],"filter-type-==":[Qe,[gr],(u,c)=>{let[h]=c;return u.geometryType()===h.value}],"filter-<":[Qe,[gr,ze],(u,c)=>{let[h,g]=c;const b=u.properties()[h.value],C=g.value;return typeof b==typeof C&&b<C}],"filter-id-<":[Qe,[ze],(u,c)=>{let[h]=c;const g=u.id(),b=h.value;return typeof g==typeof b&&g<b}],"filter->":[Qe,[gr,ze],(u,c)=>{let[h,g]=c;const b=u.properties()[h.value],C=g.value;return typeof b==typeof C&&b>C}],"filter-id->":[Qe,[ze],(u,c)=>{let[h]=c;const g=u.id(),b=h.value;return typeof g==typeof b&&g>b}],"filter-<=":[Qe,[gr,ze],(u,c)=>{let[h,g]=c;const b=u.properties()[h.value],C=g.value;return typeof b==typeof C&&b<=C}],"filter-id-<=":[Qe,[ze],(u,c)=>{let[h]=c;const g=u.id(),b=h.value;return typeof g==typeof b&&g<=b}],"filter->=":[Qe,[gr,ze],(u,c)=>{let[h,g]=c;const b=u.properties()[h.value],C=g.value;return typeof b==typeof C&&b>=C}],"filter-id->=":[Qe,[ze],(u,c)=>{let[h]=c;const g=u.id(),b=h.value;return typeof g==typeof b&&g>=b}],"filter-has":[Qe,[ze],(u,c)=>{let[h]=c;return h.value in u.properties()}],"filter-has-id":[Qe,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Qe,[X(gr)],(u,c)=>{let[h]=c;return h.value.indexOf(u.geometryType())>=0}],"filter-id-in":[Qe,[X(ze)],(u,c)=>{let[h]=c;return h.value.indexOf(u.id())>=0}],"filter-in-small":[Qe,[gr,X(ze)],(u,c)=>{let[h,g]=c;return g.value.indexOf(u.properties()[h.value])>=0}],"filter-in-large":[Qe,[gr,X(ze)],(u,c)=>{let[h,g]=c;return function(b,C,T,F){for(;T<=F;){const U=T+F>>1;if(C[U]===b)return!0;C[U]>b?F=U-1:T=U+1}return!1}(u.properties()[h.value],g.value,0,g.value.length-1)}],all:{type:Qe,overloads:[[[Qe,Qe],(u,c)=>{let[h,g]=c;return h.evaluate(u)&&g.evaluate(u)}],[Co(Qe),(u,c)=>{for(const h of c)if(!h.evaluate(u))return!1;return!0}]]},any:{type:Qe,overloads:[[[Qe,Qe],(u,c)=>{let[h,g]=c;return h.evaluate(u)||g.evaluate(u)}],[Co(Qe),(u,c)=>{for(const h of c)if(h.evaluate(u))return!0;return!1}]]},"!":[Qe,[Qe],(u,c)=>{let[h]=c;return!h.evaluate(u)}],"is-supported-script":[Qe,[gr],(u,c)=>{let[h]=c;const g=u.globals&&u.globals.isSupportedScript;return!g||g(h.evaluate(u))}],upcase:[gr,[gr],(u,c)=>{let[h]=c;return h.evaluate(u).toUpperCase()}],downcase:[gr,[gr],(u,c)=>{let[h]=c;return h.evaluate(u).toLowerCase()}],concat:[gr,Co(ze),(u,c)=>c.map(h=>hn(h.evaluate(u))).join("")],"resolved-locale":[gr,[Nn],(u,c)=>{let[h]=c;return h.evaluate(u).resolvedLocale()}]});class Pl{constructor(c,h){var g;this.expression=c,this._warningHistory={},this._evaluator=new Mi,this._defaultValue=h?(g=h).type==="color"&&Es(g.default)?new or(0,0,0,0):g.type==="color"?or.parse(g.default)||null:g.type==="padding"?yn.parse(g.default)||null:g.type==="variableAnchorOffsetCollection"?bn.parse(g.default)||null:g.default===void 0?null:g.default:null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(c,h,g,b,C,T){return this._evaluator.globals=c,this._evaluator.feature=h,this._evaluator.featureState=g,this._evaluator.canonical=b,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=T,this.expression.evaluate(this._evaluator)}evaluate(c,h,g,b,C,T){this._evaluator.globals=c,this._evaluator.feature=h||null,this._evaluator.featureState=g||null,this._evaluator.canonical=b,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=T||null;try{const F=this.expression.evaluate(this._evaluator);if(F==null||typeof F=="number"&&F!=F)return this._defaultValue;if(this._enumValues&&!(F in this._enumValues))throw new On(`Expected value to be one of ${Object.keys(this._enumValues).map(U=>JSON.stringify(U)).join(", ")}, but found ${JSON.stringify(F)} instead.`);return F}catch(F){return this._warningHistory[F.message]||(this._warningHistory[F.message]=!0,typeof console<"u"&&console.warn(F.message)),this._defaultValue}}}function ra(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in xa}function As(u,c){const h=new Qs(xa,Za,[],c?function(b){const C={color:Mr,string:gr,number:pe,enum:gr,boolean:Qe,formatted:sn,padding:vn,resolvedImage:cn,variableAnchorOffsetCollection:Ct};return b.type==="array"?X(C[b.value]||ze,b.length):C[b.type]}(c):void 0),g=h.parse(u,void 0,void 0,void 0,c&&c.type==="string"?{typeAnnotation:"coerce"}:void 0);return g?wc(new Pl(g,c)):us(h.errors)}class Hs{constructor(c,h){this.kind=c,this._styleExpression=h,this.isStateDependent=c!=="constant"&&!Ll(h.expression)}evaluateWithoutErrorHandling(c,h,g,b,C,T){return this._styleExpression.evaluateWithoutErrorHandling(c,h,g,b,C,T)}evaluate(c,h,g,b,C,T){return this._styleExpression.evaluate(c,h,g,b,C,T)}}class So{constructor(c,h,g,b){this.kind=c,this.zoomStops=g,this._styleExpression=h,this.isStateDependent=c!=="camera"&&!Ll(h.expression),this.interpolationType=b}evaluateWithoutErrorHandling(c,h,g,b,C,T){return this._styleExpression.evaluateWithoutErrorHandling(c,h,g,b,C,T)}evaluate(c,h,g,b,C,T){return this._styleExpression.evaluate(c,h,g,b,C,T)}interpolationFactor(c,h,g){return this.interpolationType?Br.interpolationFactor(this.interpolationType,c,h,g):0}}function Ml(u,c){const h=As(u,c);if(h.result==="error")return h;const g=h.value.expression,b=zi(g);if(!b&&!Ba(c))return us([new _r("","data expressions not supported")]);const C=tl(g,["zoom"]);if(!C&&!mh(c))return us([new _r("","zoom expressions not supported")]);const T=Io(g);return T||C?T instanceof _r?us([T]):T instanceof Br&&!dA(c)?us([new _r("",'"interpolate" expressions cannot be used with this property')]):wc(T?new So(b?"camera":"composite",h.value,T.labels,T instanceof Br?T.interpolation:void 0):new Hs(b?"constant":"source",h.value)):us([new _r("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class To{constructor(c,h){this._parameters=c,this._specification=h,ur(this,el(this._parameters,this._specification))}static deserialize(c){return new To(c._parameters,c._specification)}static serialize(c){return{_parameters:c._parameters,_specification:c._specification}}}function Io(u){let c=null;if(u instanceof Bs)c=Io(u.result);else if(u instanceof eu){for(const h of u.args)if(c=Io(h),c)break}else(u instanceof Xe||u instanceof Br)&&u.input instanceof ts&&u.input.name==="zoom"&&(c=u);return c instanceof _r||u.eachChild(h=>{const g=Io(h);g instanceof _r?c=g:!c&&g?c=new _r("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):c&&g&&c!==g&&(c=new _r("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),c}function Rl(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const c of u.slice(1))if(!Rl(c)&&typeof c!="boolean")return!1;return!0;default:return!0}}const Ts={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function na(u){if(u==null)return{filter:()=>!0,needGeometry:!1};Rl(u)||(u=oi(u));const c=As(u,Ts);if(c.result==="error")throw new Error(c.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,g,b)=>c.value.evaluate(h,g,{},b),needGeometry:Qn(u)}}function Kn(u,c){return u<c?-1:u>c?1:0}function Qn(u){if(!Array.isArray(u))return!1;if(u[0]==="within"||u[0]==="distance")return!0;for(let c=1;c<u.length;c++)if(Qn(u[c]))return!0;return!1}function oi(u){if(!u)return!0;const c=u[0];return u.length<=1?c!=="any":c==="=="?wi(u[1],u[2],"=="):c==="!="?xi(wi(u[1],u[2],"==")):c==="<"||c===">"||c==="<="||c===">="?wi(u[1],u[2],c):c==="any"?(h=u.slice(1),["any"].concat(h.map(oi))):c==="all"?["all"].concat(u.slice(1).map(oi)):c==="none"?["all"].concat(u.slice(1).map(oi).map(xi)):c==="in"?ro(u[1],u.slice(2)):c==="!in"?xi(ro(u[1],u.slice(2))):c==="has"?Fo(u[1]):c!=="!has"||xi(Fo(u[1]));var h}function wi(u,c,h){switch(u){case"$type":return[`filter-type-${h}`,c];case"$id":return[`filter-id-${h}`,c];default:return[`filter-${h}`,u,c]}}function ro(u,c){if(c.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",c]];case"$id":return["filter-id-in",["literal",c]];default:return c.length>200&&!c.some(h=>typeof h!=typeof c[0])?["filter-in-large",u,["literal",c.sort(Kn)]]:["filter-in-small",u,["literal",c]]}}function Fo(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function xi(u){return["!",u]}function Ea(u){const c=typeof u;if(c==="number"||c==="boolean"||c==="string"||u==null)return JSON.stringify(u);if(Array.isArray(u)){let b="[";for(const C of u)b+=`${Ea(C)},`;return`${b}]`}const h=Object.keys(u).sort();let g="{";for(let b=0;b<h.length;b++)g+=`${JSON.stringify(h[b])}:${Ea(u[h[b]])},`;return`${g}}`}function Td(u){let c="";for(const h of pr)c+=`/${Ea(u[h])}`;return c}function Id(u){const c=u.value;return c?[new de(u.key,c,"constants have been deprecated as of v8")]:[]}function Ai(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function Lo(u){if(Array.isArray(u))return u.map(Lo);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const c={};for(const h in u)c[h]=Lo(u[h]);return c}return Ai(u)}function Vs(u){const c=u.key,h=u.value,g=u.valueSpec||{},b=u.objectElementValidators||{},C=u.style,T=u.styleSpec,F=u.validateSpec;let U=[];const k=Yr(h);if(k!=="object")return[new de(c,h,`object expected, ${k} found`)];for(const G in h){const q=G.split(".")[0],Y=g[q]||g["*"];let rt;if(b[q])rt=b[q];else if(g[q])rt=F;else if(b["*"])rt=b["*"];else{if(!g["*"]){U.push(new de(c,h[G],`unknown property "${G}"`));continue}rt=F}U=U.concat(rt({key:(c&&`${c}.`)+G,value:h[G],valueSpec:Y,style:C,styleSpec:T,object:h,objectKey:G,validateSpec:F},h))}for(const G in g)b[G]||g[G].required&&g[G].default===void 0&&h[G]===void 0&&U.push(new de(c,h,`missing required property "${G}"`));return U}function du(u){const c=u.value,h=u.valueSpec,g=u.style,b=u.styleSpec,C=u.key,T=u.arrayElementValidator||u.validateSpec;if(Yr(c)!=="array")return[new de(C,c,`array expected, ${Yr(c)} found`)];if(h.length&&c.length!==h.length)return[new de(C,c,`array length ${h.length} expected, length ${c.length} found`)];if(h["min-length"]&&c.length<h["min-length"])return[new de(C,c,`array length at least ${h["min-length"]} expected, length ${c.length} found`)];let F={type:h.value,values:h.values};b.$version<7&&(F.function=h.function),Yr(h.value)==="object"&&(F=h.value);let U=[];for(let k=0;k<c.length;k++)U=U.concat(T({array:c,arrayIndex:k,value:c[k],valueSpec:F,validateSpec:u.validateSpec,style:g,styleSpec:b,key:`${C}[${k}]`}));return U}function fA(u){const c=u.key,h=u.value,g=u.valueSpec;let b=Yr(h);return b==="number"&&h!=h&&(b="NaN"),b!=="number"?[new de(c,h,`number expected, ${b} found`)]:"minimum"in g&&h<g.minimum?[new de(c,h,`${h} is less than the minimum value ${g.minimum}`)]:"maximum"in g&&h>g.maximum?[new de(c,h,`${h} is greater than the maximum value ${g.maximum}`)]:[]}function Bc(u){const c=u.valueSpec,h=Ai(u.value.type);let g,b,C,T={};const F=h!=="categorical"&&u.value.property===void 0,U=!F,k=Yr(u.value.stops)==="array"&&Yr(u.value.stops[0])==="array"&&Yr(u.value.stops[0][0])==="object",G=Vs({key:u.key,value:u.value,valueSpec:u.styleSpec.function,validateSpec:u.validateSpec,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(rt){if(h==="identity")return[new de(rt.key,rt.value,'identity function may not have a "stops" property')];let lt=[];const yt=rt.value;return lt=lt.concat(du({key:rt.key,value:yt,valueSpec:rt.valueSpec,validateSpec:rt.validateSpec,style:rt.style,styleSpec:rt.styleSpec,arrayElementValidator:q})),Yr(yt)==="array"&&yt.length===0&&lt.push(new de(rt.key,yt,"array must have at least one stop")),lt},default:function(rt){return rt.validateSpec({key:rt.key,value:rt.value,valueSpec:c,validateSpec:rt.validateSpec,style:rt.style,styleSpec:rt.styleSpec})}}});return h==="identity"&&F&&G.push(new de(u.key,u.value,'missing required property "property"')),h==="identity"||u.value.stops||G.push(new de(u.key,u.value,'missing required property "stops"')),h==="exponential"&&u.valueSpec.expression&&!dA(u.valueSpec)&&G.push(new de(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(U&&!Ba(u.valueSpec)?G.push(new de(u.key,u.value,"property functions not supported")):F&&!mh(u.valueSpec)&&G.push(new de(u.key,u.value,"zoom functions not supported"))),h!=="categorical"&&!k||u.value.property!==void 0||G.push(new de(u.key,u.value,'"property" property is required')),G;function q(rt){let lt=[];const yt=rt.value,Tt=rt.key;if(Yr(yt)!=="array")return[new de(Tt,yt,`array expected, ${Yr(yt)} found`)];if(yt.length!==2)return[new de(Tt,yt,`array length 2 expected, length ${yt.length} found`)];if(k){if(Yr(yt[0])!=="object")return[new de(Tt,yt,`object expected, ${Yr(yt[0])} found`)];if(yt[0].zoom===void 0)return[new de(Tt,yt,"object stop key must have zoom")];if(yt[0].value===void 0)return[new de(Tt,yt,"object stop key must have value")];if(C&&C>Ai(yt[0].zoom))return[new de(Tt,yt[0].zoom,"stop zoom values must appear in ascending order")];Ai(yt[0].zoom)!==C&&(C=Ai(yt[0].zoom),b=void 0,T={}),lt=lt.concat(Vs({key:`${Tt}[0]`,value:yt[0],valueSpec:{zoom:{}},validateSpec:rt.validateSpec,style:rt.style,styleSpec:rt.styleSpec,objectElementValidators:{zoom:fA,value:Y}}))}else lt=lt.concat(Y({key:`${Tt}[0]`,value:yt[0],valueSpec:{},validateSpec:rt.validateSpec,style:rt.style,styleSpec:rt.styleSpec},yt));return ra(Lo(yt[1]))?lt.concat([new de(`${Tt}[1]`,yt[1],"expressions are not allowed in function stops.")]):lt.concat(rt.validateSpec({key:`${Tt}[1]`,value:yt[1],valueSpec:c,validateSpec:rt.validateSpec,style:rt.style,styleSpec:rt.styleSpec}))}function Y(rt,lt){const yt=Yr(rt.value),Tt=Ai(rt.value),Ot=rt.value!==null?rt.value:lt;if(g){if(yt!==g)return[new de(rt.key,Ot,`${yt} stop domain type must match previous stop domain type ${g}`)]}else g=yt;if(yt!=="number"&&yt!=="string"&&yt!=="boolean")return[new de(rt.key,Ot,"stop domain value must be a number, string, or boolean")];if(yt!=="number"&&h!=="categorical"){let ne=`number expected, ${yt} found`;return Ba(c)&&h===void 0&&(ne+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new de(rt.key,Ot,ne)]}return h!=="categorical"||yt!=="number"||isFinite(Tt)&&Math.floor(Tt)===Tt?h!=="categorical"&&yt==="number"&&b!==void 0&&Tt<b?[new de(rt.key,Ot,"stop domain values must appear in ascending order")]:(b=Tt,h==="categorical"&&Tt in T?[new de(rt.key,Ot,"stop domain values must be unique")]:(T[Tt]=!0,[])):[new de(rt.key,Ot,`integer expected, found ${Tt}`)]}}function Hi(u){const c=(u.expressionContext==="property"?Ml:As)(Lo(u.value),u.valueSpec);if(c.result==="error")return c.value.map(g=>new de(`${u.key}${g.key}`,u.value,g.message));const h=c.value.expression||c.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!h.outputDefined())return[new de(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!Ll(h))return[new de(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter"&&!Ll(h))return[new de(u.key,u.value,'"feature-state" data expressions are not supported with filters.')];if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!tl(h,["zoom","feature-state"]))return[new de(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!zi(h))return[new de(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ti(u){const c=u.key,h=u.value,g=u.valueSpec,b=[];return Array.isArray(g.values)?g.values.indexOf(Ai(h))===-1&&b.push(new de(c,h,`expected one of [${g.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(g.values).indexOf(Ai(h))===-1&&b.push(new de(c,h,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(h)} found`)),b}function fu(u){return Rl(Lo(u.value))?Hi(ur({},u,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Cc(u)}function Cc(u){const c=u.value,h=u.key;if(Yr(c)!=="array")return[new de(h,c,`array expected, ${Yr(c)} found`)];const g=u.styleSpec;let b,C=[];if(c.length<1)return[new de(h,c,"filter array must have at least 1 element")];switch(C=C.concat(Ti({key:`${h}[0]`,value:c[0],valueSpec:g.filter_operator,style:u.style,styleSpec:u.styleSpec})),Ai(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&Ai(c[1])==="$type"&&C.push(new de(h,c,`"$type" cannot be use with operator "${c[0]}"`));case"==":case"!=":c.length!==3&&C.push(new de(h,c,`filter array for operator "${c[0]}" must have 3 elements`));case"in":case"!in":c.length>=2&&(b=Yr(c[1]),b!=="string"&&C.push(new de(`${h}[1]`,c[1],`string expected, ${b} found`)));for(let T=2;T<c.length;T++)b=Yr(c[T]),Ai(c[1])==="$type"?C=C.concat(Ti({key:`${h}[${T}]`,value:c[T],valueSpec:g.geometry_type,style:u.style,styleSpec:u.styleSpec})):b!=="string"&&b!=="number"&&b!=="boolean"&&C.push(new de(`${h}[${T}]`,c[T],`string, number, or boolean expected, ${b} found`));break;case"any":case"all":case"none":for(let T=1;T<c.length;T++)C=C.concat(Cc({key:`${h}[${T}]`,value:c[T],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":b=Yr(c[1]),c.length!==2?C.push(new de(h,c,`filter array for "${c[0]}" operator must have 2 elements`)):b!=="string"&&C.push(new de(`${h}[1]`,c[1],`string expected, ${b} found`))}return C}function yh(u,c){const h=u.key,g=u.validateSpec,b=u.style,C=u.styleSpec,T=u.value,F=u.objectKey,U=C[`${c}_${u.layerType}`];if(!U)return[];const k=F.match(/^(.*)-transition$/);if(c==="paint"&&k&&U[k[1]]&&U[k[1]].transition)return g({key:h,value:T,valueSpec:C.transition,style:b,styleSpec:C});const G=u.valueSpec||U[F];if(!G)return[new de(h,T,`unknown property "${F}"`)];let q;if(Yr(T)==="string"&&Ba(G)&&!G.tokens&&(q=/^{([^}]+)}$/.exec(T)))return[new de(h,T,`"${F}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(q[1])} }\`.`)];const Y=[];return u.layerType==="symbol"&&(F==="text-field"&&b&&!b.glyphs&&Y.push(new de(h,T,'use of "text-field" requires a style "glyphs" property')),F==="text-font"&&Es(Lo(T))&&Ai(T.type)==="identity"&&Y.push(new de(h,T,'"text-font" does not support identity functions'))),Y.concat(g({key:u.key,value:T,valueSpec:G,style:b,styleSpec:C,expressionContext:"property",propertyType:c,propertyKey:F}))}function Ec(u){return yh(u,"paint")}function pu(u){return yh(u,"layout")}function pA(u){let c=[];const h=u.value,g=u.key,b=u.style,C=u.styleSpec;h.type||h.ref||c.push(new de(g,h,'either "type" or "ref" is required'));let T=Ai(h.type);const F=Ai(h.ref);if(h.id){const U=Ai(h.id);for(let k=0;k<u.arrayIndex;k++){const G=b.layers[k];Ai(G.id)===U&&c.push(new de(g,h.id,`duplicate layer id "${h.id}", previously used at line ${G.id.__line__}`))}}if("ref"in h){let U;["type","source","source-layer","filter","layout"].forEach(k=>{k in h&&c.push(new de(g,h[k],`"${k}" is prohibited for ref layers`))}),b.layers.forEach(k=>{Ai(k.id)===F&&(U=k)}),U?U.ref?c.push(new de(g,h.ref,"ref cannot reference another ref layer")):T=Ai(U.type):c.push(new de(g,h.ref,`ref layer "${F}" not found`))}else if(T!=="background")if(h.source){const U=b.sources&&b.sources[h.source],k=U&&Ai(U.type);U?k==="vector"&&T==="raster"?c.push(new de(g,h.source,`layer "${h.id}" requires a raster source`)):k!=="raster-dem"&&T==="hillshade"?c.push(new de(g,h.source,`layer "${h.id}" requires a raster-dem source`)):k==="raster"&&T!=="raster"?c.push(new de(g,h.source,`layer "${h.id}" requires a vector source`)):k!=="vector"||h["source-layer"]?k==="raster-dem"&&T!=="hillshade"?c.push(new de(g,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):T!=="line"||!h.paint||!h.paint["line-gradient"]||k==="geojson"&&U.lineMetrics||c.push(new de(g,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):c.push(new de(g,h,`layer "${h.id}" must specify a "source-layer"`)):c.push(new de(g,h.source,`source "${h.source}" not found`))}else c.push(new de(g,h,'missing required property "source"'));return c=c.concat(Vs({key:g,value:h,valueSpec:C.layer,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*":()=>[],type:()=>u.validateSpec({key:`${g}.type`,value:h.type,valueSpec:C.layer.type,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,object:h,objectKey:"type"}),filter:fu,layout:U=>Vs({layer:h,key:U.key,value:U.value,style:U.style,styleSpec:U.styleSpec,validateSpec:U.validateSpec,objectElementValidators:{"*":k=>pu(ur({layerType:T},k))}}),paint:U=>Vs({layer:h,key:U.key,value:U.value,style:U.style,styleSpec:U.styleSpec,validateSpec:U.validateSpec,objectElementValidators:{"*":k=>Ec(ur({layerType:T},k))}})}})),c}function Ul(u){const c=u.value,h=u.key,g=Yr(c);return g!=="string"?[new de(h,c,`string expected, ${g} found`)]:[]}const gu={promoteId:function(u){let{key:c,value:h}=u;if(Yr(h)==="string")return Ul({key:c,value:h});{const g=[];for(const b in h)g.push(...Ul({key:`${c}.${b}`,value:h[b]}));return g}}};function Sc(u){const c=u.value,h=u.key,g=u.styleSpec,b=u.style,C=u.validateSpec;if(!c.type)return[new de(h,c,'"type" is required')];const T=Ai(c.type);let F;switch(T){case"vector":case"raster":return F=Vs({key:h,value:c,valueSpec:g[`source_${T.replace("-","_")}`],style:u.style,styleSpec:g,objectElementValidators:gu,validateSpec:C}),F;case"raster-dem":return F=function(U){var k;const G=(k=U.sourceName)!==null&&k!==void 0?k:"",q=U.value,Y=U.styleSpec,rt=Y.source_raster_dem,lt=U.style;let yt=[];const Tt=Yr(q);if(q===void 0)return yt;if(Tt!=="object")return yt.push(new de("source_raster_dem",q,`object expected, ${Tt} found`)),yt;const Ot=Ai(q.encoding)==="custom",ne=["redFactor","greenFactor","blueFactor","baseShift"],zt=U.value.encoding?`"${U.value.encoding}"`:"Default";for(const Kt in q)!Ot&&ne.includes(Kt)?yt.push(new de(Kt,q[Kt],`In "${G}": "${Kt}" is only valid when "encoding" is set to "custom". ${zt} encoding found`)):rt[Kt]?yt=yt.concat(U.validateSpec({key:Kt,value:q[Kt],valueSpec:rt[Kt],validateSpec:U.validateSpec,style:lt,styleSpec:Y})):yt.push(new de(Kt,q[Kt],`unknown property "${Kt}"`));return yt}({sourceName:h,value:c,style:u.style,styleSpec:g,validateSpec:C}),F;case"geojson":if(F=Vs({key:h,value:c,valueSpec:g.source_geojson,style:b,styleSpec:g,validateSpec:C,objectElementValidators:gu}),c.cluster)for(const U in c.clusterProperties){const[k,G]=c.clusterProperties[U],q=typeof k=="string"?[k,["accumulated"],["get",U]]:k;F.push(...Hi({key:`${h}.${U}.map`,value:G,validateSpec:C,expressionContext:"cluster-map"})),F.push(...Hi({key:`${h}.${U}.reduce`,value:q,validateSpec:C,expressionContext:"cluster-reduce"}))}return F;case"video":return Vs({key:h,value:c,valueSpec:g.source_video,style:b,validateSpec:C,styleSpec:g});case"image":return Vs({key:h,value:c,valueSpec:g.source_image,style:b,validateSpec:C,styleSpec:g});case"canvas":return[new de(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ti({key:`${h}.type`,value:c.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:b,validateSpec:C,styleSpec:g})}}function mu(u){const c=u.value,h=u.styleSpec,g=h.light,b=u.style;let C=[];const T=Yr(c);if(c===void 0)return C;if(T!=="object")return C=C.concat([new de("light",c,`object expected, ${T} found`)]),C;for(const F in c){const U=F.match(/^(.*)-transition$/);C=C.concat(U&&g[U[1]]&&g[U[1]].transition?u.validateSpec({key:F,value:c[F],valueSpec:h.transition,validateSpec:u.validateSpec,style:b,styleSpec:h}):g[F]?u.validateSpec({key:F,value:c[F],valueSpec:g[F],validateSpec:u.validateSpec,style:b,styleSpec:h}):[new de(F,c[F],`unknown property "${F}"`)])}return C}function gA(u){const c=u.value,h=u.styleSpec,g=h.sky,b=u.style,C=Yr(c);if(c===void 0)return[];if(C!=="object")return[new de("sky",c,`object expected, ${C} found`)];let T=[];for(const F in c)T=T.concat(g[F]?u.validateSpec({key:F,value:c[F],valueSpec:g[F],style:b,styleSpec:h}):[new de(F,c[F],`unknown property "${F}"`)]);return T}function Fd(u){const c=u.value,h=u.styleSpec,g=h.terrain,b=u.style;let C=[];const T=Yr(c);if(c===void 0)return C;if(T!=="object")return C=C.concat([new de("terrain",c,`object expected, ${T} found`)]),C;for(const F in c)C=C.concat(g[F]?u.validateSpec({key:F,value:c[F],valueSpec:g[F],validateSpec:u.validateSpec,style:b,styleSpec:h}):[new de(F,c[F],`unknown property "${F}"`)]);return C}function Ld(u){let c=[];const h=u.value,g=u.key;if(Array.isArray(h)){const b=[],C=[];for(const T in h)h[T].id&&b.includes(h[T].id)&&c.push(new de(g,h,`all the sprites' ids must be unique, but ${h[T].id} is duplicated`)),b.push(h[T].id),h[T].url&&C.includes(h[T].url)&&c.push(new de(g,h,`all the sprites' URLs must be unique, but ${h[T].url} is duplicated`)),C.push(h[T].url),c=c.concat(Vs({key:`${g}[${T}]`,value:h[T],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:u.validateSpec}));return c}return Ul({key:g,value:h})}const mA={"*":()=>[],array:du,boolean:function(u){const c=u.value,h=u.key,g=Yr(c);return g!=="boolean"?[new de(h,c,`boolean expected, ${g} found`)]:[]},number:fA,color:function(u){const c=u.key,h=u.value,g=Yr(h);return g!=="string"?[new de(c,h,`color expected, ${g} found`)]:or.parse(String(h))?[]:[new de(c,h,`color expected, "${h}" found`)]},constants:Id,enum:Ti,filter:fu,function:Bc,layer:pA,object:Vs,source:Sc,light:mu,sky:gA,terrain:Fd,projection:function(u){const c=u.value,h=u.styleSpec,g=h.projection,b=u.style,C=Yr(c);if(c===void 0)return[];if(C!=="object")return[new de("projection",c,`object expected, ${C} found`)];let T=[];for(const F in c)T=T.concat(g[F]?u.validateSpec({key:F,value:c[F],valueSpec:g[F],style:b,styleSpec:h}):[new de(F,c[F],`unknown property "${F}"`)]);return T},string:Ul,formatted:function(u){return Ul(u).length===0?[]:Hi(u)},resolvedImage:function(u){return Ul(u).length===0?[]:Hi(u)},padding:function(u){const c=u.key,h=u.value;if(Yr(h)==="array"){if(h.length<1||h.length>4)return[new de(c,h,`padding requires 1 to 4 values; ${h.length} values found`)];const g={type:"number"};let b=[];for(let C=0;C<h.length;C++)b=b.concat(u.validateSpec({key:`${c}[${C}]`,value:h[C],validateSpec:u.validateSpec,valueSpec:g}));return b}return fA({key:c,value:h,valueSpec:{}})},variableAnchorOffsetCollection:function(u){const c=u.key,h=u.value,g=Yr(h),b=u.styleSpec;if(g!=="array"||h.length<1||h.length%2!=0)return[new de(c,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let C=[];for(let T=0;T<h.length;T+=2)C=C.concat(Ti({key:`${c}[${T}]`,value:h[T],valueSpec:b.layout_symbol["text-anchor"]})),C=C.concat(du({key:`${c}[${T+1}]`,value:h[T+1],valueSpec:{length:2,value:"number"},validateSpec:u.validateSpec,style:u.style,styleSpec:b}));return C},sprite:Ld};function yu(u){const c=u.value,h=u.valueSpec,g=u.styleSpec;return u.validateSpec=yu,h.expression&&Es(Ai(c))?Bc(u):h.expression&&ra(Lo(c))?Hi(u):h.type&&mA[h.type]?mA[h.type](u):Vs(ur({},u,{valueSpec:h.type?g[h.type]:h}))}function vp(u){const c=u.value,h=u.key,g=Ul(u);return g.length||(c.indexOf("{fontstack}")===-1&&g.push(new de(h,c,'"glyphs" url must include a "{fontstack}" token')),c.indexOf("{range}")===-1&&g.push(new de(h,c,'"glyphs" url must include a "{range}" token'))),g}function Po(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:st,h=[];return h=h.concat(yu({key:"",value:u,valueSpec:c.$root,styleSpec:c,style:u,validateSpec:yu,objectElementValidators:{glyphs:vp,"*":()=>[]}})),u.constants&&(h=h.concat(Id({key:"constants",value:u.constants,style:u,styleSpec:c,validateSpec:yu}))),Pd(h)}function Sa(u){return function(c){return u({...c,validateSpec:yu})}}function Pd(u){return[].concat(u).sort((c,h)=>c.line-h.line)}function no(u){return function(){for(var c=arguments.length,h=new Array(c),g=0;g<c;g++)h[g]=arguments[g];return Pd(u.apply(this,h))}}Po.source=no(Sa(Sc)),Po.sprite=no(Sa(Ld)),Po.glyphs=no(Sa(vp)),Po.light=no(Sa(mu)),Po.sky=no(Sa(gA)),Po.terrain=no(Sa(Fd)),Po.layer=no(Sa(pA)),Po.filter=no(Sa(fu)),Po.paintProperty=no(Sa(Ec)),Po.layoutProperty=no(Sa(pu));const nl=Po,yA=nl.light,jm=nl.sky,bp=nl.paintProperty,Md=nl.layoutProperty;function Rd(u,c){let h=!1;if(c&&c.length)for(const g of c)u.fire(new Ke(new Error(g.message))),h=!0;return h}class _u{constructor(c,h,g){const b=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;const T=new Int32Array(this.arrayBuffer);c=T[0],this.d=(h=T[1])+2*(g=T[2]);for(let U=0;U<this.d*this.d;U++){const k=T[3+U],G=T[3+U+1];b.push(k===G?null:T.subarray(k,G))}const F=T[3+b.length+1];this.keys=T.subarray(T[3+b.length],F),this.bboxes=T.subarray(F),this.insert=this._insertReadonly}else{this.d=h+2*g;for(let T=0;T<this.d*this.d;T++)b.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=c,this.padding=g,this.scale=h/c,this.uid=0;const C=g/h*c;this.min=-C,this.max=c+C}insert(c,h,g,b,C){this._forEachCell(h,g,b,C,this._insertCell,this.uid++,void 0,void 0),this.keys.push(c),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(b),this.bboxes.push(C)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(c,h,g,b,C,T){this.cells[C].push(T)}query(c,h,g,b,C){const T=this.min,F=this.max;if(c<=T&&h<=T&&F<=g&&F<=b&&!C)return Array.prototype.slice.call(this.keys);{const U=[];return this._forEachCell(c,h,g,b,this._queryCell,U,{},C),U}}_queryCell(c,h,g,b,C,T,F,U){const k=this.cells[C];if(k!==null){const G=this.keys,q=this.bboxes;for(let Y=0;Y<k.length;Y++){const rt=k[Y];if(F[rt]===void 0){const lt=4*rt;(U?U(q[lt+0],q[lt+1],q[lt+2],q[lt+3]):c<=q[lt+2]&&h<=q[lt+3]&&g>=q[lt+0]&&b>=q[lt+1])?(F[rt]=!0,T.push(G[rt])):F[rt]=!1}}}}_forEachCell(c,h,g,b,C,T,F,U){const k=this._convertToCellCoord(c),G=this._convertToCellCoord(h),q=this._convertToCellCoord(g),Y=this._convertToCellCoord(b);for(let rt=k;rt<=q;rt++)for(let lt=G;lt<=Y;lt++){const yt=this.d*lt+rt;if((!U||U(this._convertFromCellCoord(rt),this._convertFromCellCoord(lt),this._convertFromCellCoord(rt+1),this._convertFromCellCoord(lt+1)))&&C.call(this,c,h,g,b,yt,T,F,U))return}}_convertFromCellCoord(c){return(c-this.padding)/this.scale}_convertToCellCoord(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const c=this.cells,h=3+this.cells.length+1+1;let g=0;for(let T=0;T<this.cells.length;T++)g+=this.cells[T].length;const b=new Int32Array(h+g+this.keys.length+this.bboxes.length);b[0]=this.extent,b[1]=this.n,b[2]=this.padding;let C=h;for(let T=0;T<c.length;T++){const F=c[T];b[3+T]=C,b.set(F,C),C+=F.length}return b[3+c.length]=C,b.set(this.keys,C),C+=this.keys.length,b[3+c.length+1]=C,b.set(this.bboxes,C),C+=this.bboxes.length,b.buffer}static serialize(c,h){const g=c.toArrayBuffer();return h&&h.push(g),{buffer:g}}static deserialize(c){return new _u(c.buffer)}}const Mo={};function Je(u,c){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Mo[u])throw new Error(`${u} is already registered.`);Object.defineProperty(c,"_classRegistryKey",{value:u,writeable:!1}),Mo[u]={klass:c,omit:h.omit||[],shallow:h.shallow||[]}}Je("Object",Object),Je("TransferableGridIndex",_u),Je("Color",or),Je("Error",Error),Je("AJAXError",Vt),Je("ResolvedImage",tn),Je("StylePropertyFunction",To),Je("StyleExpression",Pl,{omit:["_evaluator"]}),Je("ZoomDependentExpression",So),Je("ZoomConstantExpression",Hs),Je("CompoundExpression",ts,{omit:["_evaluate"]});for(const u in xa)xa[u]._classRegistryKey||Je(`Expression_${u}`,xa[u]);function ia(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function io(u){return u.$name||u.constructor._classRegistryKey}function Ta(u){return!function(c){if(c===null||typeof c!="object")return!1;const h=io(c);return!(!h||h==="Object")}(u)&&(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob||u instanceof Error||ia(u)||Jt(u)||ArrayBuffer.isView(u)||u instanceof ImageData)}function vu(u,c){if(Ta(u))return(ia(u)||Jt(u))&&c&&c.push(u),ArrayBuffer.isView(u)&&c&&c.push(u.buffer),u instanceof ImageData&&c&&c.push(u.data.buffer),u;if(Array.isArray(u)){const C=[];for(const T of u)C.push(vu(T,c));return C}if(typeof u!="object")throw new Error("can't serialize object of type "+typeof u);const h=io(u);if(!h)throw new Error(`can't serialize object of unregistered class ${u.constructor.name}`);if(!Mo[h])throw new Error(`${h} is not registered.`);const{klass:g}=Mo[h],b=g.serialize?g.serialize(u,c):{};if(g.serialize){if(c&&b===c[c.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const C in u){if(!u.hasOwnProperty(C)||Mo[h].omit.indexOf(C)>=0)continue;const T=u[C];b[C]=Mo[h].shallow.indexOf(C)>=0?T:vu(T,c)}u instanceof Error&&(b.message=u.message)}if(b.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(b.$name=h),b}function Tc(u){if(Ta(u))return u;if(Array.isArray(u))return u.map(Tc);if(typeof u!="object")throw new Error("can't deserialize object of type "+typeof u);const c=io(u)||"Object";if(!Mo[c])throw new Error(`can't deserialize unregistered class ${c}`);const{klass:h}=Mo[c];if(!h)throw new Error(`can't deserialize unregistered class ${c}`);if(h.deserialize)return h.deserialize(u);const g=Object.create(h.prototype);for(const b of Object.keys(u)){if(b==="$name")continue;const C=u[b];g[b]=Mo[c].shallow.indexOf(b)>=0?C:Tc(C)}return g}class Ia{constructor(){this.first=!0}update(c,h){const g=Math.floor(c);return this.first?(this.first=!1,this.lastIntegerZoom=g,this.lastIntegerZoomTime=0,this.lastZoom=c,this.lastFloorZoom=g,!0):(this.lastFloorZoom>g?(this.lastIntegerZoom=g+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<g&&(this.lastIntegerZoom=g,this.lastIntegerZoomTime=h),c!==this.lastZoom&&(this.lastZoom=c,this.lastFloorZoom=g,!0))}}const kr={"Latin-1 Supplement":u=>u>=128&&u<=255,"Hangul Jamo":u=>u>=4352&&u<=4607,Khmer:u=>u>=6016&&u<=6143,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Katakana:u=>u>=12448&&u<=12543,Kanbun:u=>u>=12688&&u<=12703,"CJK Strokes":u=>u>=12736&&u<=12783,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"Private Use Area":u=>u>=57344&&u<=63743,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519};function Ud(u){for(const c of u)if(Dd(c.charCodeAt(0)))return!0;return!1}function qm(u){for(const c of u)if(!Ic(c.charCodeAt(0)))return!1;return!0}function _h(u){const c=u.map(h=>{try{return new RegExp(`\\p{sc=${h}}`,"u").source}catch{return null}}).filter(h=>h);return new RegExp(c.join("|"),"u")}const wp=_h(["Arab","Dupl","Mong","Ougr","Syrc"]);function Ic(u){return!wp.test(String.fromCodePoint(u))}const Od=_h(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Dd(u){return!(u!==746&&u!==747&&(u<4352||!(kr["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||kr["CJK Compatibility"](u)||kr["CJK Strokes"](u)||!(!kr["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||kr["Enclosed CJK Letters and Months"](u)||kr["Ideographic Description Characters"](u)||kr.Kanbun(u)||kr.Katakana(u)&&u!==12540||!(!kr["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!kr["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||kr["Vertical Forms"](u)||kr["Yijing Hexagram Symbols"](u)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(u))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(u))||Od.test(String.fromCodePoint(u)))))}function _A(u){return!(Dd(u)||function(c){return!!(kr["Latin-1 Supplement"](c)&&(c===167||c===169||c===174||c===177||c===188||c===189||c===190||c===215||c===247)||kr["General Punctuation"](c)&&(c===8214||c===8224||c===8225||c===8240||c===8241||c===8251||c===8252||c===8258||c===8263||c===8264||c===8265||c===8273)||kr["Letterlike Symbols"](c)||kr["Number Forms"](c)||kr["Miscellaneous Technical"](c)&&(c>=8960&&c<=8967||c>=8972&&c<=8991||c>=8996&&c<=9e3||c===9003||c>=9085&&c<=9114||c>=9150&&c<=9165||c===9167||c>=9169&&c<=9179||c>=9186&&c<=9215)||kr["Control Pictures"](c)&&c!==9251||kr["Optical Character Recognition"](c)||kr["Enclosed Alphanumerics"](c)||kr["Geometric Shapes"](c)||kr["Miscellaneous Symbols"](c)&&!(c>=9754&&c<=9759)||kr["Miscellaneous Symbols and Arrows"](c)&&(c>=11026&&c<=11055||c>=11088&&c<=11097||c>=11192&&c<=11243)||kr["CJK Symbols and Punctuation"](c)||kr.Katakana(c)||kr["Private Use Area"](c)||kr["CJK Compatibility Forms"](c)||kr["Small Form Variants"](c)||kr["Halfwidth and Fullwidth Forms"](c)||c===8734||c===8756||c===8757||c>=9984&&c<=10087||c>=10102&&c<=10131||c===65532||c===65533)}(u))}const vh=_h(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Fc(u){return vh.test(String.fromCodePoint(u))}function Nd(u,c){return!(!c&&Fc(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||kr.Khmer(u))}function xp(u){for(const c of u)if(Fc(c.charCodeAt(0)))return!0;return!1}const so=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(u){this.pluginStatus=u.pluginStatus,this.pluginURL=u.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(u){this.applyArabicShaping=u.applyArabicShaping,this.processBidirectionalText=u.processBidirectionalText,this.processStyledBidirectionalText=u.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class zn{constructor(c,h){this.zoom=c,h?(this.now=h.now,this.fadeDuration=h.fadeDuration,this.zoomHistory=h.zoomHistory,this.transition=h.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ia,this.transition={})}isSupportedScript(c){return function(h,g){for(const b of h)if(!Nd(b.charCodeAt(0),g))return!1;return!0}(c,so.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const c=this.zoom,h=c-Math.floor(c),g=this.crossFadingFactor();return c>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*g}:{fromScale:.5,toScale:1,t:1-(1-g)*h}}}class bu{constructor(c,h){this.property=c,this.value=h,this.expression=function(g,b){if(Es(g))return new To(g,b);if(ra(g)){const C=Ml(g,b);if(C.result==="error")throw new Error(C.value.map(T=>`${T.key}: ${T.message}`).join(", "));return C.value}{let C=g;return b.type==="color"&&typeof g=="string"?C=or.parse(g):b.type!=="padding"||typeof g!="number"&&!Array.isArray(g)?b.type==="variableAnchorOffsetCollection"&&Array.isArray(g)&&(C=bn.parse(g)):C=yn.parse(g),{kind:"constant",evaluate:()=>C}}}(h===void 0?c.specification.default:h,c.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(c,h,g){return this.property.possiblyEvaluate(this,c,h,g)}}class bh{constructor(c){this.property=c,this.value=new bu(c,void 0)}transitioned(c,h){return new Bp(this.property,this.value,h,gt({},c.transition,this.transition),c.now)}untransitioned(){return new Bp(this.property,this.value,null,{},0)}}class wh{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitionablePropertyValues)}getValue(c){return ot(this._values[c].value.value)}setValue(c,h){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new bh(this._values[c].property)),this._values[c].value=new bu(this._values[c].property,h===null?void 0:ot(h))}getTransition(c){return ot(this._values[c].transition)}setTransition(c,h){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new bh(this._values[c].property)),this._values[c].transition=ot(h)||void 0}serialize(){const c={};for(const h of Object.keys(this._values)){const g=this.getValue(h);g!==void 0&&(c[h]=g);const b=this.getTransition(h);b!==void 0&&(c[`${h}-transition`]=b)}return c}transitioned(c,h){const g=new vA(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].transitioned(c,h._values[b]);return g}untransitioned(){const c=new vA(this._properties);for(const h of Object.keys(this._values))c._values[h]=this._values[h].untransitioned();return c}}class Bp{constructor(c,h,g,b,C){this.property=c,this.value=h,this.begin=C+b.delay||0,this.end=this.begin+b.duration||0,c.specification.transition&&(b.delay||b.duration)&&(this.prior=g)}possiblyEvaluate(c,h,g){const b=c.now||0,C=this.value.possiblyEvaluate(c,h,g),T=this.prior;if(T){if(b>this.end)return this.prior=null,C;if(this.value.isDataDriven())return this.prior=null,C;if(b<this.begin)return T.possiblyEvaluate(c,h,g);{const F=(b-this.begin)/(this.end-this.begin);return this.property.interpolate(T.possiblyEvaluate(c,h,g),C,function(U){if(U<=0)return 0;if(U>=1)return 1;const k=U*U,G=k*U;return 4*(U<.5?G:3*(U-k)+G-.75)}(F))}}return C}}class vA{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitioningPropertyValues)}possiblyEvaluate(c,h,g){const b=new Ol(this._properties);for(const C of Object.keys(this._values))b._values[C]=this._values[C].possiblyEvaluate(c,h,g);return b}hasTransition(){for(const c of Object.keys(this._values))if(this._values[c].prior)return!0;return!1}}class bA{constructor(c){this._properties=c,this._values=Object.create(c.defaultPropertyValues)}hasValue(c){return this._values[c].value!==void 0}getValue(c){return ot(this._values[c].value)}setValue(c,h){this._values[c]=new bu(this._values[c].property,h===null?void 0:ot(h))}serialize(){const c={};for(const h of Object.keys(this._values)){const g=this.getValue(h);g!==void 0&&(c[h]=g)}return c}possiblyEvaluate(c,h,g){const b=new Ol(this._properties);for(const C of Object.keys(this._values))b._values[C]=this._values[C].possiblyEvaluate(c,h,g);return b}}class sa{constructor(c,h,g){this.property=c,this.value=h,this.parameters=g}isConstant(){return this.value.kind==="constant"}constantOr(c){return this.value.kind==="constant"?this.value.value:c}evaluate(c,h,g,b){return this.property.evaluate(this.value,this.parameters,c,h,g,b)}}class Ol{constructor(c){this._properties=c,this._values=Object.create(c.defaultPossiblyEvaluatedValues)}get(c){return this._values[c]}}class ar{constructor(c){this.specification=c}possiblyEvaluate(c,h){if(c.isDataDriven())throw new Error("Value should not be data driven");return c.expression.evaluate(h)}interpolate(c,h,g){const b=Zi[this.specification.type];return b?b(c,h,g):c}}class Er{constructor(c,h){this.specification=c,this.overrides=h}possiblyEvaluate(c,h,g,b){return new sa(this,c.expression.kind==="constant"||c.expression.kind==="camera"?{kind:"constant",value:c.expression.evaluate(h,null,{},g,b)}:c.expression,h)}interpolate(c,h,g){if(c.value.kind!=="constant"||h.value.kind!=="constant")return c;if(c.value.value===void 0||h.value.value===void 0)return new sa(this,{kind:"constant",value:void 0},c.parameters);const b=Zi[this.specification.type];if(b){const C=b(c.value.value,h.value.value,g);return new sa(this,{kind:"constant",value:C},c.parameters)}return c}evaluate(c,h,g,b,C,T){return c.kind==="constant"?c.value:c.evaluate(h,g,b,C,T)}}class wA extends Er{possiblyEvaluate(c,h,g,b){if(c.value===void 0)return new sa(this,{kind:"constant",value:void 0},h);if(c.expression.kind==="constant"){const C=c.expression.evaluate(h,null,{},g,b),T=c.property.specification.type==="resolvedImage"&&typeof C!="string"?C.name:C,F=this._calculate(T,T,T,h);return new sa(this,{kind:"constant",value:F},h)}if(c.expression.kind==="camera"){const C=this._calculate(c.expression.evaluate({zoom:h.zoom-1}),c.expression.evaluate({zoom:h.zoom}),c.expression.evaluate({zoom:h.zoom+1}),h);return new sa(this,{kind:"constant",value:C},h)}return new sa(this,c.expression,h)}evaluate(c,h,g,b,C,T){if(c.kind==="source"){const F=c.evaluate(h,g,b,C,T);return this._calculate(F,F,F,h)}return c.kind==="composite"?this._calculate(c.evaluate({zoom:Math.floor(h.zoom)-1},g,b),c.evaluate({zoom:Math.floor(h.zoom)},g,b),c.evaluate({zoom:Math.floor(h.zoom)+1},g,b),h):c.value}_calculate(c,h,g,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:c,to:h}:{from:g,to:h}}interpolate(c){return c}}class E{constructor(c){this.specification=c}possiblyEvaluate(c,h,g,b){if(c.value!==void 0){if(c.expression.kind==="constant"){const C=c.expression.evaluate(h,null,{},g,b);return this._calculate(C,C,C,h)}return this._calculate(c.expression.evaluate(new zn(Math.floor(h.zoom-1),h)),c.expression.evaluate(new zn(Math.floor(h.zoom),h)),c.expression.evaluate(new zn(Math.floor(h.zoom+1),h)),h)}}_calculate(c,h,g,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:c,to:h}:{from:g,to:h}}interpolate(c){return c}}class L{constructor(c){this.specification=c}possiblyEvaluate(c,h,g,b){return!!c.expression.evaluate(h,null,{},g,b)}interpolate(){return!1}}class m{constructor(c){this.properties=c,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in c){const g=c[h];g.specification.overridable&&this.overridableProperties.push(h);const b=this.defaultPropertyValues[h]=new bu(g,void 0),C=this.defaultTransitionablePropertyValues[h]=new bh(g);this.defaultTransitioningPropertyValues[h]=C.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=b.possiblyEvaluate({})}}}Je("DataDrivenProperty",Er),Je("DataConstantProperty",ar),Je("CrossFadedDataDrivenProperty",wA),Je("CrossFadedProperty",E),Je("ColorRampProperty",L);const l="-transition";class A extends le{constructor(c,h){if(super(),this.id=c.id,this.type=c.type,this._featureFilter={filter:()=>!0,needGeometry:!1},c.type!=="custom"&&(this.metadata=c.metadata,this.minzoom=c.minzoom,this.maxzoom=c.maxzoom,c.type!=="background"&&(this.source=c.source,this.sourceLayer=c["source-layer"],this.filter=c.filter),h.layout&&(this._unevaluatedLayout=new bA(h.layout)),h.paint)){this._transitionablePaint=new wh(h.paint);for(const g in c.paint)this.setPaintProperty(g,c.paint[g],{validate:!1});for(const g in c.layout)this.setLayoutProperty(g,c.layout[g],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ol(h.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(c){return c==="visibility"?this.visibility:this._unevaluatedLayout.getValue(c)}setLayoutProperty(c,h){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};h!=null&&this._validate(Md,`layers.${this.id}.layout.${c}`,c,h,g)||(c!=="visibility"?this._unevaluatedLayout.setValue(c,h):this.visibility=h)}getPaintProperty(c){return c.endsWith(l)?this._transitionablePaint.getTransition(c.slice(0,-11)):this._transitionablePaint.getValue(c)}setPaintProperty(c,h){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(h!=null&&this._validate(bp,`layers.${this.id}.paint.${c}`,c,h,g))return!1;if(c.endsWith(l))return this._transitionablePaint.setTransition(c.slice(0,-11),h||void 0),!1;{const b=this._transitionablePaint._values[c],C=b.property.specification["property-type"]==="cross-faded-data-driven",T=b.value.isDataDriven(),F=b.value;this._transitionablePaint.setValue(c,h),this._handleSpecialPaintPropertyUpdate(c);const U=this._transitionablePaint._values[c].value;return U.isDataDriven()||T||C||this._handleOverridablePaintPropertyUpdate(c,F,U)}}_handleSpecialPaintPropertyUpdate(c){}_handleOverridablePaintPropertyUpdate(c,h,g){return!1}isHidden(c){return!!(this.minzoom&&c<this.minzoom)||!!(this.maxzoom&&c>=this.maxzoom)||this.visibility==="none"}updateTransitions(c){this._transitioningPaint=this._transitionablePaint.transitioned(c,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(c,h){c.getCrossfadeParameters&&(this._crossfadeParameters=c.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(c,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(c,void 0,h)}serialize(){const c={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(c.layout=c.layout||{},c.layout.visibility=this.visibility),St(c,(h,g)=>!(h===void 0||g==="layout"&&!Object.keys(h).length||g==="paint"&&!Object.keys(h).length))}_validate(c,h,g,b){let C=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};return(!C||C.validate!==!1)&&Rd(this,c.call(nl,{key:h,layerType:this.type,objectKey:g,value:b,styleSpec:st,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const c in this.paint._values){const h=this.paint.get(c);if(h instanceof sa&&Ba(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}const p={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class y{constructor(c,h){this._structArray=c,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class v{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(c,h){return c._trim(),h&&(c.isTransferred=!0,h.push(c.arrayBuffer)),{length:c.length,arrayBuffer:c.arrayBuffer}}static deserialize(c){const h=Object.create(this.prototype);return h.arrayBuffer=c.arrayBuffer,h.length=c.length,h.capacity=c.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(c){this.reserve(c),this.length=c}reserve(c){if(c>this.capacity){this.capacity=Math.max(c,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function S(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,h=0,g=0;return{members:u.map(b=>{const C=p[b.type].BYTES_PER_ELEMENT,T=h=I(h,Math.max(c,C)),F=b.components||1;return g=Math.max(g,C),h+=C*F,{name:b.name,type:b.type,components:F,offset:T}}),size:I(h,Math.max(g,c)),alignment:c}}function I(u,c){return Math.ceil(u/c)*c}class M extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h){const g=this.length;return this.resize(g+1),this.emplace(g,c,h)}emplace(c,h,g){const b=2*c;return this.int16[b+0]=h,this.int16[b+1]=g,c}}M.prototype.bytesPerElement=4,Je("StructArrayLayout2i4",M);class D extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,c,h,g)}emplace(c,h,g,b){const C=3*c;return this.int16[C+0]=h,this.int16[C+1]=g,this.int16[C+2]=b,c}}D.prototype.bytesPerElement=6,Je("StructArrayLayout3i6",D);class H extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,g,b){const C=this.length;return this.resize(C+1),this.emplace(C,c,h,g,b)}emplace(c,h,g,b,C){const T=4*c;return this.int16[T+0]=h,this.int16[T+1]=g,this.int16[T+2]=b,this.int16[T+3]=C,c}}H.prototype.bytesPerElement=8,Je("StructArrayLayout4i8",H);class z extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,g,b,C,T){const F=this.length;return this.resize(F+1),this.emplace(F,c,h,g,b,C,T)}emplace(c,h,g,b,C,T,F){const U=6*c;return this.int16[U+0]=h,this.int16[U+1]=g,this.int16[U+2]=b,this.int16[U+3]=C,this.int16[U+4]=T,this.int16[U+5]=F,c}}z.prototype.bytesPerElement=12,Je("StructArrayLayout2i4i12",z);class $ extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,g,b,C,T){const F=this.length;return this.resize(F+1),this.emplace(F,c,h,g,b,C,T)}emplace(c,h,g,b,C,T,F){const U=4*c,k=8*c;return this.int16[U+0]=h,this.int16[U+1]=g,this.uint8[k+4]=b,this.uint8[k+5]=C,this.uint8[k+6]=T,this.uint8[k+7]=F,c}}$.prototype.bytesPerElement=8,Je("StructArrayLayout2i4ub8",$);class J extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h){const g=this.length;return this.resize(g+1),this.emplace(g,c,h)}emplace(c,h,g){const b=2*c;return this.float32[b+0]=h,this.float32[b+1]=g,c}}J.prototype.bytesPerElement=8,Je("StructArrayLayout2f8",J);class K extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,g,b,C,T,F,U,k,G){const q=this.length;return this.resize(q+1),this.emplace(q,c,h,g,b,C,T,F,U,k,G)}emplace(c,h,g,b,C,T,F,U,k,G,q){const Y=10*c;return this.uint16[Y+0]=h,this.uint16[Y+1]=g,this.uint16[Y+2]=b,this.uint16[Y+3]=C,this.uint16[Y+4]=T,this.uint16[Y+5]=F,this.uint16[Y+6]=U,this.uint16[Y+7]=k,this.uint16[Y+8]=G,this.uint16[Y+9]=q,c}}K.prototype.bytesPerElement=20,Je("StructArrayLayout10ui20",K);class tt extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,g,b,C,T,F,U,k,G,q,Y){const rt=this.length;return this.resize(rt+1),this.emplace(rt,c,h,g,b,C,T,F,U,k,G,q,Y)}emplace(c,h,g,b,C,T,F,U,k,G,q,Y,rt){const lt=12*c;return this.int16[lt+0]=h,this.int16[lt+1]=g,this.int16[lt+2]=b,this.int16[lt+3]=C,this.uint16[lt+4]=T,this.uint16[lt+5]=F,this.uint16[lt+6]=U,this.uint16[lt+7]=k,this.int16[lt+8]=G,this.int16[lt+9]=q,this.int16[lt+10]=Y,this.int16[lt+11]=rt,c}}tt.prototype.bytesPerElement=24,Je("StructArrayLayout4i4ui4i24",tt);class At extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,c,h,g)}emplace(c,h,g,b){const C=3*c;return this.float32[C+0]=h,this.float32[C+1]=g,this.float32[C+2]=b,c}}At.prototype.bytesPerElement=12,Je("StructArrayLayout3f12",At);class pt extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c){const h=this.length;return this.resize(h+1),this.emplace(h,c)}emplace(c,h){return this.uint32[1*c+0]=h,c}}pt.prototype.bytesPerElement=4,Je("StructArrayLayout1ul4",pt);class _t extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,g,b,C,T,F,U,k){const G=this.length;return this.resize(G+1),this.emplace(G,c,h,g,b,C,T,F,U,k)}emplace(c,h,g,b,C,T,F,U,k,G){const q=10*c,Y=5*c;return this.int16[q+0]=h,this.int16[q+1]=g,this.int16[q+2]=b,this.int16[q+3]=C,this.int16[q+4]=T,this.int16[q+5]=F,this.uint32[Y+3]=U,this.uint16[q+8]=k,this.uint16[q+9]=G,c}}_t.prototype.bytesPerElement=20,Je("StructArrayLayout6i1ul2ui20",_t);class mt extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,g,b,C,T){const F=this.length;return this.resize(F+1),this.emplace(F,c,h,g,b,C,T)}emplace(c,h,g,b,C,T,F){const U=6*c;return this.int16[U+0]=h,this.int16[U+1]=g,this.int16[U+2]=b,this.int16[U+3]=C,this.int16[U+4]=T,this.int16[U+5]=F,c}}mt.prototype.bytesPerElement=12,Je("StructArrayLayout2i2i2i12",mt);class Et extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,g,b,C){const T=this.length;return this.resize(T+1),this.emplace(T,c,h,g,b,C)}emplace(c,h,g,b,C,T){const F=4*c,U=8*c;return this.float32[F+0]=h,this.float32[F+1]=g,this.float32[F+2]=b,this.int16[U+6]=C,this.int16[U+7]=T,c}}Et.prototype.bytesPerElement=16,Je("StructArrayLayout2f1f2i16",Et);class Dt extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,g,b,C,T){const F=this.length;return this.resize(F+1),this.emplace(F,c,h,g,b,C,T)}emplace(c,h,g,b,C,T,F){const U=16*c,k=4*c,G=8*c;return this.uint8[U+0]=h,this.uint8[U+1]=g,this.float32[k+1]=b,this.float32[k+2]=C,this.int16[G+6]=T,this.int16[G+7]=F,c}}Dt.prototype.bytesPerElement=16,Je("StructArrayLayout2ub2f2i16",Dt);class Rt extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,c,h,g)}emplace(c,h,g,b){const C=3*c;return this.uint16[C+0]=h,this.uint16[C+1]=g,this.uint16[C+2]=b,c}}Rt.prototype.bytesPerElement=6,Je("StructArrayLayout3ui6",Rt);class oe extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,g,b,C,T,F,U,k,G,q,Y,rt,lt,yt,Tt,Ot){const ne=this.length;return this.resize(ne+1),this.emplace(ne,c,h,g,b,C,T,F,U,k,G,q,Y,rt,lt,yt,Tt,Ot)}emplace(c,h,g,b,C,T,F,U,k,G,q,Y,rt,lt,yt,Tt,Ot,ne){const zt=24*c,Kt=12*c,ce=48*c;return this.int16[zt+0]=h,this.int16[zt+1]=g,this.uint16[zt+2]=b,this.uint16[zt+3]=C,this.uint32[Kt+2]=T,this.uint32[Kt+3]=F,this.uint32[Kt+4]=U,this.uint16[zt+10]=k,this.uint16[zt+11]=G,this.uint16[zt+12]=q,this.float32[Kt+7]=Y,this.float32[Kt+8]=rt,this.uint8[ce+36]=lt,this.uint8[ce+37]=yt,this.uint8[ce+38]=Tt,this.uint32[Kt+10]=Ot,this.int16[zt+22]=ne,c}}oe.prototype.bytesPerElement=48,Je("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",oe);class ge extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,g,b,C,T,F,U,k,G,q,Y,rt,lt,yt,Tt,Ot,ne,zt,Kt,ce,Te,$e,Sr,qe,Ge,fr,nr){const Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,c,h,g,b,C,T,F,U,k,G,q,Y,rt,lt,yt,Tt,Ot,ne,zt,Kt,ce,Te,$e,Sr,qe,Ge,fr,nr)}emplace(c,h,g,b,C,T,F,U,k,G,q,Y,rt,lt,yt,Tt,Ot,ne,zt,Kt,ce,Te,$e,Sr,qe,Ge,fr,nr,Ze){const me=32*c,mr=16*c;return this.int16[me+0]=h,this.int16[me+1]=g,this.int16[me+2]=b,this.int16[me+3]=C,this.int16[me+4]=T,this.int16[me+5]=F,this.int16[me+6]=U,this.int16[me+7]=k,this.uint16[me+8]=G,this.uint16[me+9]=q,this.uint16[me+10]=Y,this.uint16[me+11]=rt,this.uint16[me+12]=lt,this.uint16[me+13]=yt,this.uint16[me+14]=Tt,this.uint16[me+15]=Ot,this.uint16[me+16]=ne,this.uint16[me+17]=zt,this.uint16[me+18]=Kt,this.uint16[me+19]=ce,this.uint16[me+20]=Te,this.uint16[me+21]=$e,this.uint16[me+22]=Sr,this.uint32[mr+12]=qe,this.float32[mr+13]=Ge,this.float32[mr+14]=fr,this.uint16[me+30]=nr,this.uint16[me+31]=Ze,c}}ge.prototype.bytesPerElement=64,Je("StructArrayLayout8i15ui1ul2f2ui64",ge);class _e extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c){const h=this.length;return this.resize(h+1),this.emplace(h,c)}emplace(c,h){return this.float32[1*c+0]=h,c}}_e.prototype.bytesPerElement=4,Je("StructArrayLayout1f4",_e);class Ce extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,c,h,g)}emplace(c,h,g,b){const C=3*c;return this.uint16[6*c+0]=h,this.float32[C+1]=g,this.float32[C+2]=b,c}}Ce.prototype.bytesPerElement=12,Je("StructArrayLayout1ui2f12",Ce);class xe extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,c,h,g)}emplace(c,h,g,b){const C=4*c;return this.uint32[2*c+0]=h,this.uint16[C+2]=g,this.uint16[C+3]=b,c}}xe.prototype.bytesPerElement=8,Je("StructArrayLayout1ul2ui8",xe);class ve extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h){const g=this.length;return this.resize(g+1),this.emplace(g,c,h)}emplace(c,h,g){const b=2*c;return this.uint16[b+0]=h,this.uint16[b+1]=g,c}}ve.prototype.bytesPerElement=4,Je("StructArrayLayout2ui4",ve);class Se extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c){const h=this.length;return this.resize(h+1),this.emplace(h,c)}emplace(c,h){return this.uint16[1*c+0]=h,c}}Se.prototype.bytesPerElement=2,Je("StructArrayLayout1ui2",Se);class sr extends v{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,g,b){const C=this.length;return this.resize(C+1),this.emplace(C,c,h,g,b)}emplace(c,h,g,b,C){const T=4*c;return this.float32[T+0]=h,this.float32[T+1]=g,this.float32[T+2]=b,this.float32[T+3]=C,c}}sr.prototype.bytesPerElement=16,Je("StructArrayLayout4f16",sr);class Pe extends y{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new w(this.anchorPointX,this.anchorPointY)}}Pe.prototype.size=20;class Me extends _t{get(c){return new Pe(this,c)}}Je("CollisionBoxArray",Me);class dr extends y{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(c){this._structArray.uint8[this._pos1+37]=c}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(c){this._structArray.uint8[this._pos1+38]=c}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(c){this._structArray.uint32[this._pos4+10]=c}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}dr.prototype.size=48;class Pr extends oe{get(c){return new dr(this,c)}}Je("PlacedSymbolArray",Pr);class Ir extends y{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(c){this._structArray.uint32[this._pos4+12]=c}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Ir.prototype.size=64;class Dr extends ge{get(c){return new Ir(this,c)}}Je("SymbolInstanceArray",Dr);class Kr extends _e{getoffsetX(c){return this.float32[1*c+0]}}Je("GlyphOffsetArray",Kr);class Bn extends D{getx(c){return this.int16[3*c+0]}gety(c){return this.int16[3*c+1]}gettileUnitDistanceFromAnchor(c){return this.int16[3*c+2]}}Je("SymbolLineVertexArray",Bn);class Zn extends y{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Zn.prototype.size=12;class fn extends Ce{get(c){return new Zn(this,c)}}Je("TextAnchorOffsetArray",fn);class hi extends y{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}hi.prototype.size=8;class Cn extends xe{get(c){return new hi(this,c)}}Je("FeatureIndexArray",Cn);class ai extends M{}class Bi extends M{}class Is extends M{}class oo extends z{}class ti extends ${}class Dl extends J{}class ao extends K{}class xA extends tt{}class wu extends At{}class hs extends pt{}class Fs extends mt{}class Vi extends Dt{}class ds extends Rt{}class yi extends ve{}const es=S([{name:"a_pos",components:2,type:"Int16"}],4),{members:fs}=es;class an{constructor(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.segments=c}prepareSegment(c,h,g,b){let C=this.segments[this.segments.length-1];return c>an.MAX_VERTEX_ARRAY_LENGTH&&bt(`Max vertices per segment is ${an.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${c}`),(!C||C.vertexLength+c>an.MAX_VERTEX_ARRAY_LENGTH||C.sortKey!==b)&&(C={vertexOffset:h.length,primitiveOffset:g.length,vertexLength:0,primitiveLength:0},b!==void 0&&(C.sortKey=b),this.segments.push(C)),C}get(){return this.segments}destroy(){for(const c of this.segments)for(const h in c.vaos)c.vaos[h].destroy()}static simpleSegment(c,h,g,b){return new an([{vertexOffset:c,primitiveOffset:h,vertexLength:g,primitiveLength:b,vaos:{},sortKey:0}])}}function Fa(u,c){return 256*(u=ct(Math.floor(u),0,255))+ct(Math.floor(c),0,255)}an.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Je("SegmentVector",an);const Nl=S([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var il={exports:{}},xu={exports:{}};xu.exports=function(u,c){var h,g,b,C,T,F,U,k;for(g=u.length-(h=3&u.length),b=c,T=3432918353,F=461845907,k=0;k<g;)U=255&u.charCodeAt(k)|(255&u.charCodeAt(++k))<<8|(255&u.charCodeAt(++k))<<16|(255&u.charCodeAt(++k))<<24,++k,b=27492+(65535&(C=5*(65535&(b=(b^=U=(65535&(U=(U=(65535&U)*T+(((U>>>16)*T&65535)<<16)&4294967295)<<15|U>>>17))*F+(((U>>>16)*F&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(U=0,h){case 3:U^=(255&u.charCodeAt(k+2))<<16;case 2:U^=(255&u.charCodeAt(k+1))<<8;case 1:b^=U=(65535&(U=(U=(65535&(U^=255&u.charCodeAt(k)))*T+(((U>>>16)*T&65535)<<16)&4294967295)<<15|U>>>17))*F+(((U>>>16)*F&65535)<<16)&4294967295}return b^=u.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0};var Km=xu.exports,Cp={exports:{}};Cp.exports=function(u,c){for(var h,g=u.length,b=c^g,C=0;g>=4;)h=1540483477*(65535&(h=255&u.charCodeAt(C)|(255&u.charCodeAt(++C))<<8|(255&u.charCodeAt(++C))<<16|(255&u.charCodeAt(++C))<<24))+((1540483477*(h>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),g-=4,++C;switch(g){case 3:b^=(255&u.charCodeAt(C+2))<<16;case 2:b^=(255&u.charCodeAt(C+1))<<8;case 1:b=1540483477*(65535&(b^=255&u.charCodeAt(C)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0};var La=Km,sl=Cp.exports;il.exports=La,il.exports.murmur3=La,il.exports.murmur2=sl;var xh=d(il.exports);class BA{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(c,h,g,b){this.ids.push(Bh(c)),this.positions.push(h,g,b)}getPositions(c){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=Bh(c);let g=0,b=this.ids.length-1;for(;g<b;){const T=g+b>>1;this.ids[T]>=h?b=T:g=T+1}const C=[];for(;this.ids[g]===h;)C.push({index:this.positions[3*g],start:this.positions[3*g+1],end:this.positions[3*g+2]}),g++;return C}static serialize(c,h){const g=new Float64Array(c.ids),b=new Uint32Array(c.positions);return CA(g,b,0,g.length-1),h&&h.push(g.buffer,b.buffer),{ids:g,positions:b}}static deserialize(c){const h=new BA;return h.ids=c.ids,h.positions=c.positions,h.indexed=!0,h}}function Bh(u){const c=+u;return!isNaN(c)&&c<=Number.MAX_SAFE_INTEGER?c:xh(String(u))}function CA(u,c,h,g){for(;h<g;){const b=u[h+g>>1];let C=h-1,T=g+1;for(;;){do C++;while(u[C]<b);do T--;while(u[T]>b);if(C>=T)break;ol(u,C,T),ol(c,3*C,3*T),ol(c,3*C+1,3*T+1),ol(c,3*C+2,3*T+2)}T-h<g-T?(CA(u,c,h,T),h=T+1):(CA(u,c,T+1,g),g=T)}}function ol(u,c,h){const g=u[c];u[c]=u[h],u[h]=g}Je("FeaturePositionMap",BA);class Bu{constructor(c,h){this.gl=c.gl,this.location=h}}class kd extends Bu{constructor(c,h){super(c,h),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class Qd extends Bu{constructor(c,h){super(c,h),this.current=[0,0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3]))}}class Ep extends Bu{constructor(c,h){super(c,h),this.current=or.transparent}set(c){c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a))}}const zd=new Float32Array(16);function Sp(u){return[Fa(255*u.r,255*u.g),Fa(255*u.b,255*u.a)]}class Hd{constructor(c,h,g){this.value=c,this.uniformNames=h.map(b=>`u_${b}`),this.type=g}setUniform(c,h,g){c.set(g.constantOr(this.value))}getBinding(c,h,g){return this.type==="color"?new Ep(c,h):new kd(c,h)}}class Lc{constructor(c,h){this.uniformNames=h.map(g=>`u_${g}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(c,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=c.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=c.tlbr}setUniform(c,h,g,b){const C=b==="u_pattern_to"?this.patternTo:b==="u_pattern_from"?this.patternFrom:b==="u_pixel_ratio_to"?this.pixelRatioTo:b==="u_pixel_ratio_from"?this.pixelRatioFrom:null;C&&c.set(C)}getBinding(c,h,g){return g.substr(0,9)==="u_pattern"?new Qd(c,h):new kd(c,h)}}class kl{constructor(c,h,g,b){this.expression=c,this.type=g,this.maxValue=0,this.paintVertexAttributes=h.map(C=>({name:`a_${C}`,type:"Float32",components:g==="color"?2:1,offset:0})),this.paintVertexArray=new b}populatePaintArray(c,h,g,b,C){const T=this.paintVertexArray.length,F=this.expression.evaluate(new zn(0),h,{},b,[],C);this.paintVertexArray.resize(c),this._setPaintValue(T,c,F)}updatePaintArray(c,h,g,b){const C=this.expression.evaluate({zoom:0},g,b);this._setPaintValue(c,h,C)}_setPaintValue(c,h,g){if(this.type==="color"){const b=Sp(g);for(let C=c;C<h;C++)this.paintVertexArray.emplace(C,b[0],b[1])}else{for(let b=c;b<h;b++)this.paintVertexArray.emplace(b,g);this.maxValue=Math.max(this.maxValue,Math.abs(g))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class oa{constructor(c,h,g,b,C,T){this.expression=c,this.uniformNames=h.map(F=>`u_${F}_t`),this.type=g,this.useIntegerZoom=b,this.zoom=C,this.maxValue=0,this.paintVertexAttributes=h.map(F=>({name:`a_${F}`,type:"Float32",components:g==="color"?4:2,offset:0})),this.paintVertexArray=new T}populatePaintArray(c,h,g,b,C){const T=this.expression.evaluate(new zn(this.zoom),h,{},b,[],C),F=this.expression.evaluate(new zn(this.zoom+1),h,{},b,[],C),U=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValue(U,c,T,F)}updatePaintArray(c,h,g,b){const C=this.expression.evaluate({zoom:this.zoom},g,b),T=this.expression.evaluate({zoom:this.zoom+1},g,b);this._setPaintValue(c,h,C,T)}_setPaintValue(c,h,g,b){if(this.type==="color"){const C=Sp(g),T=Sp(b);for(let F=c;F<h;F++)this.paintVertexArray.emplace(F,C[0],C[1],T[0],T[1])}else{for(let C=c;C<h;C++)this.paintVertexArray.emplace(C,g,b);this.maxValue=Math.max(this.maxValue,Math.abs(g),Math.abs(b))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(c,h){const g=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,b=ct(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);c.set(b)}getBinding(c,h,g){return new kd(c,h)}}class lo{constructor(c,h,g,b,C,T){this.expression=c,this.type=h,this.useIntegerZoom=g,this.zoom=b,this.layerId=T,this.zoomInPaintVertexArray=new C,this.zoomOutPaintVertexArray=new C}populatePaintArray(c,h,g){const b=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(c),this.zoomOutPaintVertexArray.resize(c),this._setPaintValues(b,c,h.patterns&&h.patterns[this.layerId],g)}updatePaintArray(c,h,g,b,C){this._setPaintValues(c,h,g.patterns&&g.patterns[this.layerId],C)}_setPaintValues(c,h,g,b){if(!b||!g)return;const{min:C,mid:T,max:F}=g,U=b[C],k=b[T],G=b[F];if(U&&k&&G)for(let q=c;q<h;q++)this.zoomInPaintVertexArray.emplace(q,k.tl[0],k.tl[1],k.br[0],k.br[1],U.tl[0],U.tl[1],U.br[0],U.br[1],k.pixelRatio,U.pixelRatio),this.zoomOutPaintVertexArray.emplace(q,k.tl[0],k.tl[1],k.br[0],k.br[1],G.tl[0],G.tl[1],G.br[0],G.br[1],k.pixelRatio,G.pixelRatio)}upload(c){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=c.createVertexBuffer(this.zoomInPaintVertexArray,Nl.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=c.createVertexBuffer(this.zoomOutPaintVertexArray,Nl.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class $m{constructor(c,h,g){this.binders={},this._buffers=[];const b=[];for(const C in c.paint._values){if(!g(C))continue;const T=c.paint.get(C);if(!(T instanceof sa&&Ba(T.property.specification)))continue;const F=KE(C,c.type),U=T.value,k=T.property.specification.type,G=T.property.useIntegerZoom,q=T.property.specification["property-type"],Y=q==="cross-faded"||q==="cross-faded-data-driven";if(U.kind==="constant")this.binders[C]=Y?new Lc(U.value,F):new Hd(U.value,F,k),b.push(`/u_${C}`);else if(U.kind==="source"||Y){const rt=Wm(C,k,"source");this.binders[C]=Y?new lo(U,k,G,h,rt,c.id):new kl(U,F,k,rt),b.push(`/a_${C}`)}else{const rt=Wm(C,k,"composite");this.binders[C]=new oa(U,F,k,G,h,rt),b.push(`/z_${C}`)}}this.cacheKey=b.sort().join("")}getMaxValue(c){const h=this.binders[c];return h instanceof kl||h instanceof oa?h.maxValue:0}populatePaintArrays(c,h,g,b,C){for(const T in this.binders){const F=this.binders[T];(F instanceof kl||F instanceof oa||F instanceof lo)&&F.populatePaintArray(c,h,g,b,C)}}setConstantPatternPositions(c,h){for(const g in this.binders){const b=this.binders[g];b instanceof Lc&&b.setConstantPatternPositions(c,h)}}updatePaintArrays(c,h,g,b,C){let T=!1;for(const F in c){const U=h.getPositions(F);for(const k of U){const G=g.feature(k.index);for(const q in this.binders){const Y=this.binders[q];if((Y instanceof kl||Y instanceof oa||Y instanceof lo)&&Y.expression.isStateDependent===!0){const rt=b.paint.get(q);Y.expression=rt.value,Y.updatePaintArray(k.start,k.end,G,c[F],C),T=!0}}}}return T}defines(){const c=[];for(const h in this.binders){const g=this.binders[h];(g instanceof Hd||g instanceof Lc)&&c.push(...g.uniformNames.map(b=>`#define HAS_UNIFORM_${b}`))}return c}getBinderAttributes(){const c=[];for(const h in this.binders){const g=this.binders[h];if(g instanceof kl||g instanceof oa)for(let b=0;b<g.paintVertexAttributes.length;b++)c.push(g.paintVertexAttributes[b].name);else if(g instanceof lo)for(let b=0;b<Nl.members.length;b++)c.push(Nl.members[b].name)}return c}getBinderUniforms(){const c=[];for(const h in this.binders){const g=this.binders[h];if(g instanceof Hd||g instanceof Lc||g instanceof oa)for(const b of g.uniformNames)c.push(b)}return c}getPaintVertexBuffers(){return this._buffers}getUniforms(c,h){const g=[];for(const b in this.binders){const C=this.binders[b];if(C instanceof Hd||C instanceof Lc||C instanceof oa){for(const T of C.uniformNames)if(h[T]){const F=C.getBinding(c,h[T],T);g.push({name:T,property:b,binding:F})}}}return g}setUniforms(c,h,g,b){for(const{name:C,property:T,binding:F}of h)this.binders[T].setUniform(F,b,g.get(T),C)}updatePaintBuffers(c){this._buffers=[];for(const h in this.binders){const g=this.binders[h];if(c&&g instanceof lo){const b=c.fromScale===2?g.zoomInPaintVertexBuffer:g.zoomOutPaintVertexBuffer;b&&this._buffers.push(b)}else(g instanceof kl||g instanceof oa)&&g.paintVertexBuffer&&this._buffers.push(g.paintVertexBuffer)}}upload(c){for(const h in this.binders){const g=this.binders[h];(g instanceof kl||g instanceof oa||g instanceof lo)&&g.upload(c)}this.updatePaintBuffers()}destroy(){for(const c in this.binders){const h=this.binders[c];(h instanceof kl||h instanceof oa||h instanceof lo)&&h.destroy()}}}class Cu{constructor(c,h){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>!0;this.programConfigurations={};for(const b of c)this.programConfigurations[b.id]=new $m(b,h,g);this.needsUpload=!1,this._featureMap=new BA,this._bufferOffset=0}populatePaintArrays(c,h,g,b,C,T){for(const F in this.programConfigurations)this.programConfigurations[F].populatePaintArrays(c,h,b,C,T);h.id!==void 0&&this._featureMap.add(h.id,g,this._bufferOffset,c),this._bufferOffset=c,this.needsUpload=!0}updatePaintArrays(c,h,g,b){for(const C of g)this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(c,this._featureMap,h,C,b)||this.needsUpload}get(c){return this.programConfigurations[c]}upload(c){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(c);this.needsUpload=!1}}destroy(){for(const c in this.programConfigurations)this.programConfigurations[c].destroy()}}function KE(u,c){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[u]||[u.replace(`${c}-`,"").replace(/-/g,"_")]}function Wm(u,c,h){const g={color:{source:J,composite:sr},number:{source:_e,composite:J}},b=function(C){return{"line-pattern":{source:ao,composite:ao},"fill-pattern":{source:ao,composite:ao},"fill-extrusion-pattern":{source:ao,composite:ao}}[C]}(u);return b&&b[h]||g[c][h]}Je("ConstantBinder",Hd),Je("CrossFadedConstantBinder",Lc),Je("SourceExpressionBinder",kl),Je("CrossFadedCompositeBinder",lo),Je("CompositeExpressionBinder",oa),Je("ProgramConfiguration",$m,{omit:["_buffers"]}),Je("ProgramConfigurationSet",Cu);const ei=8192,Xm=Math.pow(2,14)-1,Jm=-Xm-1;function EA(u){const c=ei/u.extent,h=u.loadGeometry();for(let g=0;g<h.length;g++){const b=h[g];for(let C=0;C<b.length;C++){const T=b[C],F=Math.round(T.x*c),U=Math.round(T.y*c);T.x=ct(F,Jm,Xm),T.y=ct(U,Jm,Xm),(F<T.x||F>T.x+1||U<T.y||U>T.y+1)&&bt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function Eu(u,c){return{type:u.type,id:u.id,properties:u.properties,geometry:c?EA(u):[]}}function Tp(u,c,h,g,b){u.emplaceBack(2*c+(g+1)/2,2*h+(b+1)/2)}class SA{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(h=>h.id),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new Bi,this.indexArray=new ds,this.segments=new an,this.programConfigurations=new Cu(c.layers,c.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(c,h,g){const b=this.layers[0],C=[];let T=null,F=!1;b.type==="circle"&&(T=b.layout.get("circle-sort-key"),F=!T.isConstant());for(const{feature:U,id:k,index:G,sourceLayerIndex:q}of c){const Y=this.layers[0]._featureFilter.needGeometry,rt=Eu(U,Y);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),rt,g))continue;const lt=F?T.evaluate(rt,{},g):void 0,yt={id:k,properties:U.properties,type:U.type,sourceLayerIndex:q,index:G,geometry:Y?rt.geometry:EA(U),patterns:{},sortKey:lt};C.push(yt)}F&&C.sort((U,k)=>U.sortKey-k.sortKey);for(const U of C){const{geometry:k,index:G,sourceLayerIndex:q}=U,Y=c[G].feature;this.addFeature(U,k,G,g),h.featureIndex.insert(Y,k,G,q,this.index)}}update(c,h,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,fs),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(c,h,g,b){for(const C of h)for(const T of C){const F=T.x,U=T.y;if(F<0||F>=ei||U<0||U>=ei)continue;const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,c.sortKey),G=k.vertexLength;Tp(this.layoutVertexArray,F,U,-1,-1),Tp(this.layoutVertexArray,F,U,1,-1),Tp(this.layoutVertexArray,F,U,1,1),Tp(this.layoutVertexArray,F,U,-1,1),this.indexArray.emplaceBack(G,G+1,G+2),this.indexArray.emplaceBack(G,G+3,G+2),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,{},b)}}function Ip(u,c){for(let h=0;h<u.length;h++)if(Tu(c,u[h]))return!0;for(let h=0;h<c.length;h++)if(Tu(u,c[h]))return!0;return!!zl(u,c)}function Fp(u,c,h){return!!Tu(u,c)||!!Vd(c,u,h)}function Ql(u,c){if(u.length===1)return ev(c,u[0]);for(let h=0;h<c.length;h++){const g=c[h];for(let b=0;b<g.length;b++)if(Tu(u,g[b]))return!0}for(let h=0;h<u.length;h++)if(ev(c,u[h]))return!0;for(let h=0;h<c.length;h++)if(zl(u,c[h]))return!0;return!1}function Su(u,c,h){if(u.length>1){if(zl(u,c))return!0;for(let g=0;g<c.length;g++)if(Vd(c[g],u,h))return!0}for(let g=0;g<u.length;g++)if(Vd(u[g],c,h))return!0;return!1}function zl(u,c){if(u.length===0||c.length===0)return!1;for(let h=0;h<u.length-1;h++){const g=u[h],b=u[h+1];for(let C=0;C<c.length-1;C++)if(Lp(g,b,c[C],c[C+1]))return!0}return!1}function Lp(u,c,h,g){return vt(u,h,g)!==vt(c,h,g)&&vt(u,c,h)!==vt(u,c,g)}function Vd(u,c,h){const g=h*h;if(c.length===1)return u.distSqr(c[0])<g;for(let b=1;b<c.length;b++)if(Ym(u,c[b-1],c[b])<g)return!0;return!1}function Ym(u,c,h){const g=c.distSqr(h);if(g===0)return u.distSqr(c);const b=((u.x-c.x)*(h.x-c.x)+(u.y-c.y)*(h.y-c.y))/g;return u.distSqr(b<0?c:b>1?h:h.sub(c)._mult(b)._add(c))}function ev(u,c){let h,g,b,C=!1;for(let T=0;T<u.length;T++){h=u[T];for(let F=0,U=h.length-1;F<h.length;U=F++)g=h[F],b=h[U],g.y>c.y!=b.y>c.y&&c.x<(b.x-g.x)*(c.y-g.y)/(b.y-g.y)+g.x&&(C=!C)}return C}function Tu(u,c){let h=!1;for(let g=0,b=u.length-1;g<u.length;b=g++){const C=u[g],T=u[b];C.y>c.y!=T.y>c.y&&c.x<(T.x-C.x)*(c.y-C.y)/(T.y-C.y)+C.x&&(h=!h)}return h}function Zm(u,c,h){const g=h[0],b=h[2];if(u.x<g.x&&c.x<g.x||u.x>b.x&&c.x>b.x||u.y<g.y&&c.y<g.y||u.y>b.y&&c.y>b.y)return!1;const C=vt(u,c,h[0]);return C!==vt(u,c,h[1])||C!==vt(u,c,h[2])||C!==vt(u,c,h[3])}function t0(u,c,h){const g=c.paint.get(u).value;return g.kind==="constant"?g.value:h.programConfigurations.get(c.id).getMaxValue(u)}function rv(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function nv(u,c,h,g,b){if(!c[0]&&!c[1])return u;const C=w.convert(c)._mult(b);h==="viewport"&&C._rotate(-g);const T=[];for(let F=0;F<u.length;F++)T.push(u[F].sub(C));return T}let FN,LN;Je("CircleBucket",SA,{omit:["layers"]});var Hbt={get paint(){return LN=LN||new m({"circle-radius":new Er(st.paint_circle["circle-radius"]),"circle-color":new Er(st.paint_circle["circle-color"]),"circle-blur":new Er(st.paint_circle["circle-blur"]),"circle-opacity":new Er(st.paint_circle["circle-opacity"]),"circle-translate":new ar(st.paint_circle["circle-translate"]),"circle-translate-anchor":new ar(st.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ar(st.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ar(st.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Er(st.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Er(st.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Er(st.paint_circle["circle-stroke-opacity"])})},get layout(){return FN=FN||new m({"circle-sort-key":new Er(st.layout_circle["circle-sort-key"])})}},Ro=1e-6,Pp=typeof Float32Array<"u"?Float32Array:Array;function $E(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function PN(u,c,h){var g=c[0],b=c[1],C=c[2],T=c[3],F=c[4],U=c[5],k=c[6],G=c[7],q=c[8],Y=c[9],rt=c[10],lt=c[11],yt=c[12],Tt=c[13],Ot=c[14],ne=c[15],zt=h[0],Kt=h[1],ce=h[2],Te=h[3];return u[0]=zt*g+Kt*F+ce*q+Te*yt,u[1]=zt*b+Kt*U+ce*Y+Te*Tt,u[2]=zt*C+Kt*k+ce*rt+Te*Ot,u[3]=zt*T+Kt*G+ce*lt+Te*ne,u[4]=(zt=h[4])*g+(Kt=h[5])*F+(ce=h[6])*q+(Te=h[7])*yt,u[5]=zt*b+Kt*U+ce*Y+Te*Tt,u[6]=zt*C+Kt*k+ce*rt+Te*Ot,u[7]=zt*T+Kt*G+ce*lt+Te*ne,u[8]=(zt=h[8])*g+(Kt=h[9])*F+(ce=h[10])*q+(Te=h[11])*yt,u[9]=zt*b+Kt*U+ce*Y+Te*Tt,u[10]=zt*C+Kt*k+ce*rt+Te*Ot,u[11]=zt*T+Kt*G+ce*lt+Te*ne,u[12]=(zt=h[12])*g+(Kt=h[13])*F+(ce=h[14])*q+(Te=h[15])*yt,u[13]=zt*b+Kt*U+ce*Y+Te*Tt,u[14]=zt*C+Kt*k+ce*rt+Te*Ot,u[15]=zt*T+Kt*G+ce*lt+Te*ne,u}Math.hypot||(Math.hypot=function(){for(var u=0,c=arguments.length;c--;)u+=arguments[c]*arguments[c];return Math.sqrt(u)});var e0,Vbt=PN;function iv(u,c,h){var g=c[0],b=c[1],C=c[2],T=c[3];return u[0]=h[0]*g+h[4]*b+h[8]*C+h[12]*T,u[1]=h[1]*g+h[5]*b+h[9]*C+h[13]*T,u[2]=h[2]*g+h[6]*b+h[10]*C+h[14]*T,u[3]=h[3]*g+h[7]*b+h[11]*C+h[15]*T,u}e0=new Pp(4),Pp!=Float32Array&&(e0[0]=0,e0[1]=0,e0[2]=0,e0[3]=0);class Gbt extends A{constructor(c){super(c,Hbt)}createBucket(c){return new SA(c)}queryRadius(c){const h=c;return t0("circle-radius",this,h)+t0("circle-stroke-width",this,h)+rv(this.paint.get("circle-translate"))}queryIntersectsFeature(c,h,g,b,C,T,F,U){const k=nv(c,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),T.angle,F),G=this.paint.get("circle-radius").evaluate(h,g)+this.paint.get("circle-stroke-width").evaluate(h,g),q=this.paint.get("circle-pitch-alignment")==="map",Y=q?k:function(lt,yt){return lt.map(Tt=>MN(Tt,yt))}(k,U),rt=q?G*F:G;for(const lt of b)for(const yt of lt){const Tt=q?yt:MN(yt,U);let Ot=rt;const ne=iv([],[yt.x,yt.y,0,1],U);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ot*=ne[3]/T.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ot*=T.cameraToCenterDistance/ne[3]),Fp(Y,Tt,Ot))return!0}return!1}}function MN(u,c){const h=iv([],[u.x,u.y,0,1],c);return new w(h[0]/h[3],h[1]/h[3])}class RN extends SA{}let UN;Je("HeatmapBucket",RN,{omit:["layers"]});var jbt={get paint(){return UN=UN||new m({"heatmap-radius":new Er(st.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Er(st.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ar(st.paint_heatmap["heatmap-intensity"]),"heatmap-color":new L(st.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ar(st.paint_heatmap["heatmap-opacity"])})}};function WE(u,c,h,g){let{width:b,height:C}=c;if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==b*C*h)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${b*C*h}`)}else g=new Uint8Array(b*C*h);return u.width=b,u.height=C,u.data=g,u}function ON(u,c,h){let{width:g,height:b}=c;if(g===u.width&&b===u.height)return;const C=WE({},{width:g,height:b},h);XE(u,C,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,g),height:Math.min(u.height,b)},h),u.width=g,u.height=b,u.data=C.data}function XE(u,c,h,g,b,C){if(b.width===0||b.height===0)return c;if(b.width>u.width||b.height>u.height||h.x>u.width-b.width||h.y>u.height-b.height)throw new RangeError("out of range source coordinates for image copy");if(b.width>c.width||b.height>c.height||g.x>c.width-b.width||g.y>c.height-b.height)throw new RangeError("out of range destination coordinates for image copy");const T=u.data,F=c.data;if(T===F)throw new Error("srcData equals dstData, so image is already copied");for(let U=0;U<b.height;U++){const k=((h.y+U)*u.width+h.x)*C,G=((g.y+U)*c.width+g.x)*C;for(let q=0;q<b.width*C;q++)F[G+q]=T[k+q]}return c}class r0{constructor(c,h){WE(this,c,1,h)}resize(c){ON(this,c,1)}clone(){return new r0({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,h,g,b,C){XE(c,h,g,b,C,1)}}class al{constructor(c,h){WE(this,c,4,h)}resize(c){ON(this,c,4)}replace(c,h){h?this.data.set(c):this.data=c instanceof Uint8ClampedArray?new Uint8Array(c.buffer):c}clone(){return new al({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,h,g,b,C){XE(c,h,g,b,C,4)}}function DN(u){const c={},h=u.resolution||256,g=u.clips?u.clips.length:1,b=u.image||new al({width:h,height:g});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const C=(T,F,U)=>{c[u.evaluationKey]=U;const k=u.expression.evaluate(c);b.data[T+F+0]=Math.floor(255*k.r/k.a),b.data[T+F+1]=Math.floor(255*k.g/k.a),b.data[T+F+2]=Math.floor(255*k.b/k.a),b.data[T+F+3]=Math.floor(255*k.a)};if(u.clips)for(let T=0,F=0;T<g;++T,F+=4*h)for(let U=0,k=0;U<h;U++,k+=4){const G=U/(h-1),{start:q,end:Y}=u.clips[T];C(F,k,q*(1-G)+Y*G)}else for(let T=0,F=0;T<h;T++,F+=4)C(0,F,T/(h-1));return b}Je("AlphaImage",r0),Je("RGBAImage",al);const JE="big-fb";class qbt extends A{createBucket(c){return new RN(c)}constructor(c){super(c,jbt),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=DN({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(JE)&&this.heatmapFbos.delete(JE)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let NN;var Kbt={get paint(){return NN=NN||new m({"hillshade-illumination-direction":new ar(st.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ar(st.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ar(st.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ar(st.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ar(st.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ar(st.paint_hillshade["hillshade-accent-color"])})}};class $bt extends A{constructor(c){super(c,Kbt)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const Wbt=S([{name:"a_pos",components:2,type:"Int16"}],4),{members:Xbt}=Wbt;function kN(u,c){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:2;const g=c&&c.length,b=g?c[0]*h:u.length;let C=QN(u,0,b,h,!0);const T=[];if(!C||C.next===C.prev)return T;let F,U,k;if(g&&(C=function(G,q,Y,rt){const lt=[];for(let yt=0,Tt=q.length;yt<Tt;yt++){const Ot=QN(G,q[yt]*rt,yt<Tt-1?q[yt+1]*rt:G.length,rt,!1);Ot===Ot.next&&(Ot.steiner=!0),lt.push(iwt(Ot))}lt.sort(ewt);for(let yt=0;yt<lt.length;yt++)Y=rwt(lt[yt],Y);return Y}(u,c,C,h)),u.length>80*h){F=1/0,U=1/0;let G=-1/0,q=-1/0;for(let Y=h;Y<b;Y+=h){const rt=u[Y],lt=u[Y+1];rt<F&&(F=rt),lt<U&&(U=lt),rt>G&&(G=rt),lt>q&&(q=lt)}k=Math.max(G-F,q-U),k=k!==0?32767/k:0}return n0(C,T,h,F,U,k,0),T}function QN(u,c,h,g,b){let C;if(b===function(T,F,U,k){let G=0;for(let q=F,Y=U-k;q<U;q+=k)G+=(T[Y]-T[q])*(T[q+1]+T[Y+1]),Y=q;return G}(u,c,h,g)>0)for(let T=c;T<h;T+=g)C=VN(T/g|0,u[T],u[T+1],C);else for(let T=h-g;T>=c;T-=g)C=VN(T/g|0,u[T],u[T+1],C);return C&&sv(C,C.next)&&(s0(C),C=C.next),C}function Gd(u,c){if(!u)return u;c||(c=u);let h,g=u;do if(h=!1,g.steiner||!sv(g,g.next)&&Ri(g.prev,g,g.next)!==0)g=g.next;else{if(s0(g),g=c=g.prev,g===g.next)break;h=!0}while(h||g!==c);return c}function n0(u,c,h,g,b,C,T){if(!u)return;!T&&C&&function(U,k,G,q){let Y=U;do Y.z===0&&(Y.z=YE(Y.x,Y.y,k,G,q)),Y.prevZ=Y.prev,Y.nextZ=Y.next,Y=Y.next;while(Y!==U);Y.prevZ.nextZ=null,Y.prevZ=null,function(rt){let lt,yt=1;do{let Tt,Ot=rt;rt=null;let ne=null;for(lt=0;Ot;){lt++;let zt=Ot,Kt=0;for(let Te=0;Te<yt&&(Kt++,zt=zt.nextZ,zt);Te++);let ce=yt;for(;Kt>0||ce>0&&zt;)Kt!==0&&(ce===0||!zt||Ot.z<=zt.z)?(Tt=Ot,Ot=Ot.nextZ,Kt--):(Tt=zt,zt=zt.nextZ,ce--),ne?ne.nextZ=Tt:rt=Tt,Tt.prevZ=ne,ne=Tt;Ot=zt}ne.nextZ=null,yt*=2}while(lt>1)}(Y)}(u,g,b,C);let F=u;for(;u.prev!==u.next;){const U=u.prev,k=u.next;if(C?Ybt(u,g,b,C):Jbt(u))c.push(U.i,u.i,k.i),s0(u),u=k.next,F=k.next;else if((u=k)===F){T?T===1?n0(u=Zbt(Gd(u),c),c,h,g,b,C,2):T===2&&twt(u,c,h,g,b,C):n0(Gd(u),c,h,g,b,C,1);break}}}function Jbt(u){const c=u.prev,h=u,g=u.next;if(Ri(c,h,g)>=0)return!1;const b=c.x,C=h.x,T=g.x,F=c.y,U=h.y,k=g.y,G=b<C?b<T?b:T:C<T?C:T,q=F<U?F<k?F:k:U<k?U:k,Y=b>C?b>T?b:T:C>T?C:T,rt=F>U?F>k?F:k:U>k?U:k;let lt=g.next;for(;lt!==c;){if(lt.x>=G&&lt.x<=Y&&lt.y>=q&&lt.y<=rt&&Mp(b,F,C,U,T,k,lt.x,lt.y)&&Ri(lt.prev,lt,lt.next)>=0)return!1;lt=lt.next}return!0}function Ybt(u,c,h,g){const b=u.prev,C=u,T=u.next;if(Ri(b,C,T)>=0)return!1;const F=b.x,U=C.x,k=T.x,G=b.y,q=C.y,Y=T.y,rt=F<U?F<k?F:k:U<k?U:k,lt=G<q?G<Y?G:Y:q<Y?q:Y,yt=F>U?F>k?F:k:U>k?U:k,Tt=G>q?G>Y?G:Y:q>Y?q:Y,Ot=YE(rt,lt,c,h,g),ne=YE(yt,Tt,c,h,g);let zt=u.prevZ,Kt=u.nextZ;for(;zt&&zt.z>=Ot&&Kt&&Kt.z<=ne;){if(zt.x>=rt&&zt.x<=yt&&zt.y>=lt&&zt.y<=Tt&&zt!==b&&zt!==T&&Mp(F,G,U,q,k,Y,zt.x,zt.y)&&Ri(zt.prev,zt,zt.next)>=0||(zt=zt.prevZ,Kt.x>=rt&&Kt.x<=yt&&Kt.y>=lt&&Kt.y<=Tt&&Kt!==b&&Kt!==T&&Mp(F,G,U,q,k,Y,Kt.x,Kt.y)&&Ri(Kt.prev,Kt,Kt.next)>=0))return!1;Kt=Kt.nextZ}for(;zt&&zt.z>=Ot;){if(zt.x>=rt&&zt.x<=yt&&zt.y>=lt&&zt.y<=Tt&&zt!==b&&zt!==T&&Mp(F,G,U,q,k,Y,zt.x,zt.y)&&Ri(zt.prev,zt,zt.next)>=0)return!1;zt=zt.prevZ}for(;Kt&&Kt.z<=ne;){if(Kt.x>=rt&&Kt.x<=yt&&Kt.y>=lt&&Kt.y<=Tt&&Kt!==b&&Kt!==T&&Mp(F,G,U,q,k,Y,Kt.x,Kt.y)&&Ri(Kt.prev,Kt,Kt.next)>=0)return!1;Kt=Kt.nextZ}return!0}function Zbt(u,c){let h=u;do{const g=h.prev,b=h.next.next;!sv(g,b)&&zN(g,h,h.next,b)&&i0(g,b)&&i0(b,g)&&(c.push(g.i,h.i,b.i),s0(h),s0(h.next),h=u=b),h=h.next}while(h!==u);return Gd(h)}function twt(u,c,h,g,b,C){let T=u;do{let F=T.next.next;for(;F!==T.prev;){if(T.i!==F.i&&swt(T,F)){let U=HN(T,F);return T=Gd(T,T.next),U=Gd(U,U.next),n0(T,c,h,g,b,C,0),void n0(U,c,h,g,b,C,0)}F=F.next}T=T.next}while(T!==u)}function ewt(u,c){return u.x-c.x}function rwt(u,c){const h=function(b,C){let T=C;const F=b.x,U=b.y;let k,G=-1/0;do{if(U<=T.y&&U>=T.next.y&&T.next.y!==T.y){const yt=T.x+(U-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(yt<=F&&yt>G&&(G=yt,k=T.x<T.next.x?T:T.next,yt===F))return k}T=T.next}while(T!==C);if(!k)return null;const q=k,Y=k.x,rt=k.y;let lt=1/0;T=k;do{if(F>=T.x&&T.x>=Y&&F!==T.x&&Mp(U<rt?F:G,U,Y,rt,U<rt?G:F,U,T.x,T.y)){const yt=Math.abs(U-T.y)/(F-T.x);i0(T,b)&&(yt<lt||yt===lt&&(T.x>k.x||T.x===k.x&&nwt(k,T)))&&(k=T,lt=yt)}T=T.next}while(T!==q);return k}(u,c);if(!h)return c;const g=HN(h,u);return Gd(g,g.next),Gd(h,h.next)}function nwt(u,c){return Ri(u.prev,u,c.prev)<0&&Ri(c.next,u,u.next)<0}function YE(u,c,h,g,b){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-h)*b|0)|u<<8))|u<<4))|u<<2))|u<<1))|(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-g)*b|0)|c<<8))|c<<4))|c<<2))|c<<1))<<1}function iwt(u){let c=u,h=u;do(c.x<h.x||c.x===h.x&&c.y<h.y)&&(h=c),c=c.next;while(c!==u);return h}function Mp(u,c,h,g,b,C,T,F){return(b-T)*(c-F)>=(u-T)*(C-F)&&(u-T)*(g-F)>=(h-T)*(c-F)&&(h-T)*(C-F)>=(b-T)*(g-F)}function swt(u,c){return u.next.i!==c.i&&u.prev.i!==c.i&&!function(h,g){let b=h;do{if(b.i!==h.i&&b.next.i!==h.i&&b.i!==g.i&&b.next.i!==g.i&&zN(b,b.next,h,g))return!0;b=b.next}while(b!==h);return!1}(u,c)&&(i0(u,c)&&i0(c,u)&&function(h,g){let b=h,C=!1;const T=(h.x+g.x)/2,F=(h.y+g.y)/2;do b.y>F!=b.next.y>F&&b.next.y!==b.y&&T<(b.next.x-b.x)*(F-b.y)/(b.next.y-b.y)+b.x&&(C=!C),b=b.next;while(b!==h);return C}(u,c)&&(Ri(u.prev,u,c.prev)||Ri(u,c.prev,c))||sv(u,c)&&Ri(u.prev,u,u.next)>0&&Ri(c.prev,c,c.next)>0)}function Ri(u,c,h){return(c.y-u.y)*(h.x-c.x)-(c.x-u.x)*(h.y-c.y)}function sv(u,c){return u.x===c.x&&u.y===c.y}function zN(u,c,h,g){const b=av(Ri(u,c,h)),C=av(Ri(u,c,g)),T=av(Ri(h,g,u)),F=av(Ri(h,g,c));return b!==C&&T!==F||!(b!==0||!ov(u,h,c))||!(C!==0||!ov(u,g,c))||!(T!==0||!ov(h,u,g))||!(F!==0||!ov(h,c,g))}function ov(u,c,h){return c.x<=Math.max(u.x,h.x)&&c.x>=Math.min(u.x,h.x)&&c.y<=Math.max(u.y,h.y)&&c.y>=Math.min(u.y,h.y)}function av(u){return u>0?1:u<0?-1:0}function i0(u,c){return Ri(u.prev,u,u.next)<0?Ri(u,c,u.next)>=0&&Ri(u,u.prev,c)>=0:Ri(u,c,u.prev)<0||Ri(u,u.next,c)<0}function HN(u,c){const h=ZE(u.i,u.x,u.y),g=ZE(c.i,c.x,c.y),b=u.next,C=c.prev;return u.next=c,c.prev=u,h.next=b,b.prev=h,g.next=h,h.prev=g,C.next=g,g.prev=C,g}function VN(u,c,h,g){const b=ZE(u,c,h);return g?(b.next=g.next,b.prev=g,g.next.prev=b,g.next=b):(b.prev=b,b.next=b),b}function s0(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function ZE(u,c,h){return{i:u,x:c,y:h,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function tS(u,c,h){const g=h.patternDependencies;let b=!1;for(const C of c){const T=C.paint.get(`${u}-pattern`);T.isConstant()||(b=!0);const F=T.constantOr(null);F&&(b=!0,g[F.to]=!0,g[F.from]=!0)}return b}function eS(u,c,h,g,b){const C=b.patternDependencies;for(const T of c){const F=T.paint.get(`${u}-pattern`).value;if(F.kind!=="constant"){let U=F.evaluate({zoom:g-1},h,{},b.availableImages),k=F.evaluate({zoom:g},h,{},b.availableImages),G=F.evaluate({zoom:g+1},h,{},b.availableImages);U=U&&U.name?U.name:U,k=k&&k.name?k.name:k,G=G&&G.name?G.name:G,C[U]=!0,C[k]=!0,C[G]=!0,h.patterns[T.id]={min:U,mid:k,max:G}}}return h}class rS{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(h=>h.id),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Is,this.indexArray=new ds,this.indexArray2=new yi,this.programConfigurations=new Cu(c.layers,c.zoom),this.segments=new an,this.segments2=new an,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(c,h,g){this.hasPattern=tS("fill",this.layers,h);const b=this.layers[0].layout.get("fill-sort-key"),C=!b.isConstant(),T=[];for(const{feature:F,id:U,index:k,sourceLayerIndex:G}of c){const q=this.layers[0]._featureFilter.needGeometry,Y=Eu(F,q);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),Y,g))continue;const rt=C?b.evaluate(Y,{},g,h.availableImages):void 0,lt={id:U,properties:F.properties,type:F.type,sourceLayerIndex:G,index:k,geometry:q?Y.geometry:EA(F),patterns:{},sortKey:rt};T.push(lt)}C&&T.sort((F,U)=>F.sortKey-U.sortKey);for(const F of T){const{geometry:U,index:k,sourceLayerIndex:G}=F;if(this.hasPattern){const q=eS("fill",this.layers,F,this.zoom,h);this.patternFeatures.push(q)}else this.addFeature(F,U,k,g,{});h.featureIndex.insert(c[k].feature,U,k,G,this.index)}}update(c,h,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,g)}addFeatures(c,h,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,h,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,Xbt),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.indexBuffer2=c.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(c,h,g,b,C){for(const T of ba(h,500)){let F=0;for(const rt of T)F+=rt.length;const U=this.segments.prepareSegment(F,this.layoutVertexArray,this.indexArray),k=U.vertexLength,G=[],q=[];for(const rt of T){if(rt.length===0)continue;rt!==T[0]&&q.push(G.length/2);const lt=this.segments2.prepareSegment(rt.length,this.layoutVertexArray,this.indexArray2),yt=lt.vertexLength;this.layoutVertexArray.emplaceBack(rt[0].x,rt[0].y),this.indexArray2.emplaceBack(yt+rt.length-1,yt),G.push(rt[0].x),G.push(rt[0].y);for(let Tt=1;Tt<rt.length;Tt++)this.layoutVertexArray.emplaceBack(rt[Tt].x,rt[Tt].y),this.indexArray2.emplaceBack(yt+Tt-1,yt+Tt),G.push(rt[Tt].x),G.push(rt[Tt].y);lt.vertexLength+=rt.length,lt.primitiveLength+=rt.length}const Y=kN(G,q);for(let rt=0;rt<Y.length;rt+=3)this.indexArray.emplaceBack(k+Y[rt],k+Y[rt+1],k+Y[rt+2]);U.vertexLength+=F,U.primitiveLength+=Y.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,C,b)}}let GN,jN;Je("FillBucket",rS,{omit:["layers","patternFeatures"]});var owt={get paint(){return jN=jN||new m({"fill-antialias":new ar(st.paint_fill["fill-antialias"]),"fill-opacity":new Er(st.paint_fill["fill-opacity"]),"fill-color":new Er(st.paint_fill["fill-color"]),"fill-outline-color":new Er(st.paint_fill["fill-outline-color"]),"fill-translate":new ar(st.paint_fill["fill-translate"]),"fill-translate-anchor":new ar(st.paint_fill["fill-translate-anchor"]),"fill-pattern":new wA(st.paint_fill["fill-pattern"])})},get layout(){return GN=GN||new m({"fill-sort-key":new Er(st.layout_fill["fill-sort-key"])})}};class awt extends A{constructor(c){super(c,owt)}recalculate(c,h){super.recalculate(c,h);const g=this.paint._values["fill-outline-color"];g.value.kind==="constant"&&g.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new rS(c)}queryRadius(){return rv(this.paint.get("fill-translate"))}queryIntersectsFeature(c,h,g,b,C,T,F){return Ql(nv(c,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),T.angle,F),b)}isTileClipped(){return!0}}const lwt=S([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),cwt=S([{name:"a_centroid",components:2,type:"Int16"}],4),{members:uwt}=lwt;var Ch={},Awt=f,qN=Rp;function Rp(u,c,h,g,b){this.properties={},this.extent=h,this.type=0,this._pbf=u,this._geometry=-1,this._keys=g,this._values=b,u.readFields(hwt,this,c)}function hwt(u,c,h){u==1?c.id=h.readVarint():u==2?function(g,b){for(var C=g.readVarint()+g.pos;g.pos<C;){var T=b._keys[g.readVarint()],F=b._values[g.readVarint()];b.properties[T]=F}}(h,c):u==3?c.type=h.readVarint():u==4&&(c._geometry=h.pos)}function dwt(u){for(var c,h,g=0,b=0,C=u.length,T=C-1;b<C;T=b++)g+=((h=u[T]).x-(c=u[b]).x)*(c.y+h.y);return g}Rp.types=["Unknown","Point","LineString","Polygon"],Rp.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var c,h=u.readVarint()+u.pos,g=1,b=0,C=0,T=0,F=[];u.pos<h;){if(b<=0){var U=u.readVarint();g=7&U,b=U>>3}if(b--,g===1||g===2)C+=u.readSVarint(),T+=u.readSVarint(),g===1&&(c&&F.push(c),c=[]),c.push(new Awt(C,T));else{if(g!==7)throw new Error("unknown command "+g);c&&c.push(c[0].clone())}}return c&&F.push(c),F},Rp.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var c=u.readVarint()+u.pos,h=1,g=0,b=0,C=0,T=1/0,F=-1/0,U=1/0,k=-1/0;u.pos<c;){if(g<=0){var G=u.readVarint();h=7&G,g=G>>3}if(g--,h===1||h===2)(b+=u.readSVarint())<T&&(T=b),b>F&&(F=b),(C+=u.readSVarint())<U&&(U=C),C>k&&(k=C);else if(h!==7)throw new Error("unknown command "+h)}return[T,U,F,k]},Rp.prototype.toGeoJSON=function(u,c,h){var g,b,C=this.extent*Math.pow(2,h),T=this.extent*u,F=this.extent*c,U=this.loadGeometry(),k=Rp.types[this.type];function G(rt){for(var lt=0;lt<rt.length;lt++){var yt=rt[lt];rt[lt]=[360*(yt.x+T)/C-180,360/Math.PI*Math.atan(Math.exp((180-360*(yt.y+F)/C)*Math.PI/180))-90]}}switch(this.type){case 1:var q=[];for(g=0;g<U.length;g++)q[g]=U[g][0];G(U=q);break;case 2:for(g=0;g<U.length;g++)G(U[g]);break;case 3:for(U=function(rt){var lt=rt.length;if(lt<=1)return[rt];for(var yt,Tt,Ot=[],ne=0;ne<lt;ne++){var zt=dwt(rt[ne]);zt!==0&&(Tt===void 0&&(Tt=zt<0),Tt===zt<0?(yt&&Ot.push(yt),yt=[rt[ne]]):yt.push(rt[ne]))}return yt&&Ot.push(yt),Ot}(U),g=0;g<U.length;g++)for(b=0;b<U[g].length;b++)G(U[g][b])}U.length===1?U=U[0]:k="Multi"+k;var Y={type:"Feature",geometry:{type:k,coordinates:U},properties:this.properties};return"id"in this&&(Y.id=this.id),Y};var fwt=qN,KN=$N;function $N(u,c){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(pwt,this,c),this.length=this._features.length}function pwt(u,c,h){u===15?c.version=h.readVarint():u===1?c.name=h.readString():u===5?c.extent=h.readVarint():u===2?c._features.push(h.pos):u===3?c._keys.push(h.readString()):u===4&&c._values.push(function(g){for(var b=null,C=g.readVarint()+g.pos;g.pos<C;){var T=g.readVarint()>>3;b=T===1?g.readString():T===2?g.readFloat():T===3?g.readDouble():T===4?g.readVarint64():T===5?g.readVarint():T===6?g.readSVarint():T===7?g.readBoolean():null}return b}(h))}$N.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var c=this._pbf.readVarint()+this._pbf.pos;return new fwt(this._pbf,c,this.extent,this._keys,this._values)};var gwt=KN;function mwt(u,c,h){if(u===3){var g=new gwt(h,h.readVarint()+h.pos);g.length&&(c[g.name]=g)}}Ch.VectorTile=function(u,c){this.layers=u.readFields(mwt,{},c)},Ch.VectorTileFeature=qN,Ch.VectorTileLayer=KN;const ywt=Ch.VectorTileFeature.types,nS=Math.pow(2,13);function o0(u,c,h,g,b,C,T,F){u.emplaceBack(c,h,2*Math.floor(g*nS)+T,b*nS*2,C*nS*2,Math.round(F))}class iS{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(h=>h.id),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new oo,this.centroidVertexArray=new ai,this.indexArray=new ds,this.programConfigurations=new Cu(c.layers,c.zoom),this.segments=new an,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(c,h,g){this.features=[],this.hasPattern=tS("fill-extrusion",this.layers,h);for(const{feature:b,id:C,index:T,sourceLayerIndex:F}of c){const U=this.layers[0]._featureFilter.needGeometry,k=Eu(b,U);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),k,g))continue;const G={id:C,sourceLayerIndex:F,index:T,geometry:U?k.geometry:EA(b),properties:b.properties,type:b.type,patterns:{}};this.hasPattern?this.features.push(eS("fill-extrusion",this.layers,G,this.zoom,h)):this.addFeature(G,G.geometry,T,g,{}),h.featureIndex.insert(b,G.geometry,T,F,this.index,!0)}}addFeatures(c,h,g){for(const b of this.features){const{geometry:C}=b;this.addFeature(b,C,b.index,h,g)}}update(c,h,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,g)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,uwt),this.centroidVertexBuffer=c.createVertexBuffer(this.centroidVertexArray,cwt.members,!0),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(c,h,g,b,C){for(const T of ba(h,500)){const F={x:0,y:0,vertexCount:0};let U=0;for(const lt of T)U+=lt.length;let k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const lt of T){if(lt.length===0||vwt(lt))continue;let yt=0;for(let Tt=0;Tt<lt.length;Tt++){const Ot=lt[Tt];if(Tt>=1){const ne=lt[Tt-1];if(!_wt(Ot,ne)){k.vertexLength+4>an.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const zt=Ot.sub(ne)._perp()._unit(),Kt=ne.dist(Ot);yt+Kt>32768&&(yt=0),o0(this.layoutVertexArray,Ot.x,Ot.y,zt.x,zt.y,0,0,yt),o0(this.layoutVertexArray,Ot.x,Ot.y,zt.x,zt.y,0,1,yt),F.x+=2*Ot.x,F.y+=2*Ot.y,F.vertexCount+=2,yt+=Kt,o0(this.layoutVertexArray,ne.x,ne.y,zt.x,zt.y,0,0,yt),o0(this.layoutVertexArray,ne.x,ne.y,zt.x,zt.y,0,1,yt),F.x+=2*ne.x,F.y+=2*ne.y,F.vertexCount+=2;const ce=k.vertexLength;this.indexArray.emplaceBack(ce,ce+2,ce+1),this.indexArray.emplaceBack(ce+1,ce+2,ce+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+U>an.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(U,this.layoutVertexArray,this.indexArray)),ywt[c.type]!=="Polygon")continue;const G=[],q=[],Y=k.vertexLength;for(const lt of T)if(lt.length!==0){lt!==T[0]&&q.push(G.length/2);for(let yt=0;yt<lt.length;yt++){const Tt=lt[yt];o0(this.layoutVertexArray,Tt.x,Tt.y,0,0,1,1,0),F.x+=Tt.x,F.y+=Tt.y,F.vertexCount+=1,G.push(Tt.x),G.push(Tt.y)}}const rt=kN(G,q);for(let lt=0;lt<rt.length;lt+=3)this.indexArray.emplaceBack(Y+rt[lt],Y+rt[lt+2],Y+rt[lt+1]);k.primitiveLength+=rt.length/3,k.vertexLength+=U;for(let lt=0;lt<F.vertexCount;lt++){const yt=Math.floor(F.x/F.vertexCount),Tt=Math.floor(F.y/F.vertexCount);this.centroidVertexArray.emplaceBack(yt,Tt)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,C,b)}}function _wt(u,c){return u.x===c.x&&(u.x<0||u.x>ei)||u.y===c.y&&(u.y<0||u.y>ei)}function vwt(u){return u.every(c=>c.x<0)||u.every(c=>c.x>ei)||u.every(c=>c.y<0)||u.every(c=>c.y>ei)}let WN;Je("FillExtrusionBucket",iS,{omit:["layers","features"]});var bwt={get paint(){return WN=WN||new m({"fill-extrusion-opacity":new ar(st["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Er(st["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ar(st["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ar(st["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new wA(st["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Er(st["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Er(st["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ar(st["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class wwt extends A{constructor(c){super(c,bwt)}createBucket(c){return new iS(c)}queryRadius(){return rv(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(c,h,g,b,C,T,F,U){const k=nv(c,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),T.angle,F),G=this.paint.get("fill-extrusion-height").evaluate(h,g),q=this.paint.get("fill-extrusion-base").evaluate(h,g),Y=function(lt,yt,Tt,Ot){const ne=[];for(const zt of lt){const Kt=[zt.x,zt.y,0,1];iv(Kt,Kt,yt),ne.push(new w(Kt[0]/Kt[3],Kt[1]/Kt[3]))}return ne}(k,U),rt=function(lt,yt,Tt,Ot){const ne=[],zt=[],Kt=Ot[8]*yt,ce=Ot[9]*yt,Te=Ot[10]*yt,$e=Ot[11]*yt,Sr=Ot[8]*Tt,qe=Ot[9]*Tt,Ge=Ot[10]*Tt,fr=Ot[11]*Tt;for(const nr of lt){const Ze=[],me=[];for(const mr of nr){const Ar=mr.x,Nr=mr.y,$n=Ot[0]*Ar+Ot[4]*Nr+Ot[12],Vn=Ot[1]*Ar+Ot[5]*Nr+Ot[13],ps=Ot[2]*Ar+Ot[6]*Nr+Ot[14],Hl=Ot[3]*Ar+Ot[7]*Nr+Ot[15],js=ps+Te,gs=Hl+$e,Uo=$n+Sr,Oo=Vn+qe,Do=ps+Ge,Ii=Hl+fr,ms=new w(($n+Kt)/gs,(Vn+ce)/gs);ms.z=js/gs,Ze.push(ms);const co=new w(Uo/Ii,Oo/Ii);co.z=Do/Ii,me.push(co)}ne.push(Ze),zt.push(me)}return[ne,zt]}(b,q,G,U);return function(lt,yt,Tt){let Ot=1/0;Ql(Tt,yt)&&(Ot=XN(Tt,yt[0]));for(let ne=0;ne<yt.length;ne++){const zt=yt[ne],Kt=lt[ne];for(let ce=0;ce<zt.length-1;ce++){const Te=zt[ce],$e=[Te,zt[ce+1],Kt[ce+1],Kt[ce],Te];Ip(Tt,$e)&&(Ot=Math.min(Ot,XN(Tt,$e)))}}return Ot!==1/0&&Ot}(rt[0],rt[1],Y)}}function a0(u,c){return u.x*c.x+u.y*c.y}function XN(u,c){if(u.length===1){let h=0;const g=c[h++];let b;for(;!b||g.equals(b);)if(b=c[h++],!b)return 1/0;for(;h<c.length;h++){const C=c[h],T=u[0],F=b.sub(g),U=C.sub(g),k=T.sub(g),G=a0(F,F),q=a0(F,U),Y=a0(U,U),rt=a0(k,F),lt=a0(k,U),yt=G*Y-q*q,Tt=(Y*rt-q*lt)/yt,Ot=(G*lt-q*rt)/yt,ne=g.z*(1-Tt-Ot)+b.z*Tt+C.z*Ot;if(isFinite(ne))return ne}return 1/0}{let h=1/0;for(const g of c)h=Math.min(h,g.z);return h}}const xwt=S([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Bwt}=xwt,Cwt=S([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Ewt}=Cwt,Swt=Ch.VectorTileFeature.types,Twt=Math.cos(Math.PI/180*37.5),JN=Math.pow(2,14)/.5;class sS{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(h=>h.id),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new ti,this.layoutVertexArray2=new Dl,this.indexArray=new ds,this.programConfigurations=new Cu(c.layers,c.zoom),this.segments=new an,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(c,h,g){this.hasPattern=tS("line",this.layers,h);const b=this.layers[0].layout.get("line-sort-key"),C=!b.isConstant(),T=[];for(const{feature:F,id:U,index:k,sourceLayerIndex:G}of c){const q=this.layers[0]._featureFilter.needGeometry,Y=Eu(F,q);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),Y,g))continue;const rt=C?b.evaluate(Y,{},g):void 0,lt={id:U,properties:F.properties,type:F.type,sourceLayerIndex:G,index:k,geometry:q?Y.geometry:EA(F),patterns:{},sortKey:rt};T.push(lt)}C&&T.sort((F,U)=>F.sortKey-U.sortKey);for(const F of T){const{geometry:U,index:k,sourceLayerIndex:G}=F;if(this.hasPattern){const q=eS("line",this.layers,F,this.zoom,h);this.patternFeatures.push(q)}else this.addFeature(F,U,k,g,{});h.featureIndex.insert(c[k].feature,U,k,G,this.index)}}update(c,h,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,g)}addFeatures(c,h,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,h,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=c.createVertexBuffer(this.layoutVertexArray2,Ewt)),this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,Bwt),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(c){if(c.properties&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_end"))return{start:+c.properties.mapbox_clip_start,end:+c.properties.mapbox_clip_end}}addFeature(c,h,g,b,C){const T=this.layers[0].layout,F=T.get("line-join").evaluate(c,{}),U=T.get("line-cap"),k=T.get("line-miter-limit"),G=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(c);for(const q of h)this.addLine(q,c,F,U,k,G);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,C,b)}addLine(c,h,g,b,C,T){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ot=0;Ot<c.length-1;Ot++)this.totalDistance+=c[Ot].dist(c[Ot+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const F=Swt[h.type]==="Polygon";let U=c.length;for(;U>=2&&c[U-1].equals(c[U-2]);)U--;let k=0;for(;k<U-1&&c[k].equals(c[k+1]);)k++;if(U<(F?3:2))return;g==="bevel"&&(C=1.05);const G=this.overscaling<=16?15*ei/(512*this.overscaling):0,q=this.segments.prepareSegment(10*U,this.layoutVertexArray,this.indexArray);let Y,rt,lt,yt,Tt;this.e1=this.e2=-1,F&&(Y=c[U-2],Tt=c[k].sub(Y)._unit()._perp());for(let Ot=k;Ot<U;Ot++){if(lt=Ot===U-1?F?c[k+1]:void 0:c[Ot+1],lt&&c[Ot].equals(lt))continue;Tt&&(yt=Tt),Y&&(rt=Y),Y=c[Ot],Tt=lt?lt.sub(Y)._unit()._perp():yt,yt=yt||Tt;let ne=yt.add(Tt);ne.x===0&&ne.y===0||ne._unit();const zt=yt.x*Tt.x+yt.y*Tt.y,Kt=ne.x*Tt.x+ne.y*Tt.y,ce=Kt!==0?1/Kt:1/0,Te=2*Math.sqrt(2-2*Kt),$e=Kt<Twt&&rt&&lt,Sr=yt.x*Tt.y-yt.y*Tt.x>0;if($e&&Ot>k){const fr=Y.dist(rt);if(fr>2*G){const nr=Y.sub(Y.sub(rt)._mult(G/fr)._round());this.updateDistance(rt,nr),this.addCurrentVertex(nr,yt,0,0,q),rt=nr}}const qe=rt&&lt;let Ge=qe?g:F?"butt":b;if(qe&&Ge==="round"&&(ce<T?Ge="miter":ce<=2&&(Ge="fakeround")),Ge==="miter"&&ce>C&&(Ge="bevel"),Ge==="bevel"&&(ce>2&&(Ge="flipbevel"),ce<C&&(Ge="miter")),rt&&this.updateDistance(rt,Y),Ge==="miter")ne._mult(ce),this.addCurrentVertex(Y,ne,0,0,q);else if(Ge==="flipbevel"){if(ce>100)ne=Tt.mult(-1);else{const fr=ce*yt.add(Tt).mag()/yt.sub(Tt).mag();ne._perp()._mult(fr*(Sr?-1:1))}this.addCurrentVertex(Y,ne,0,0,q),this.addCurrentVertex(Y,ne.mult(-1),0,0,q)}else if(Ge==="bevel"||Ge==="fakeround"){const fr=-Math.sqrt(ce*ce-1),nr=Sr?fr:0,Ze=Sr?0:fr;if(rt&&this.addCurrentVertex(Y,yt,nr,Ze,q),Ge==="fakeround"){const me=Math.round(180*Te/Math.PI/20);for(let mr=1;mr<me;mr++){let Ar=mr/me;if(Ar!==.5){const $n=Ar-.5;Ar+=Ar*$n*(Ar-1)*((1.0904+zt*(zt*(3.55645-1.43519*zt)-3.2452))*$n*$n+(.848013+zt*(.215638*zt-1.06021)))}const Nr=Tt.sub(yt)._mult(Ar)._add(yt)._unit()._mult(Sr?-1:1);this.addHalfVertex(Y,Nr.x,Nr.y,!1,Sr,0,q)}}lt&&this.addCurrentVertex(Y,Tt,-nr,-Ze,q)}else if(Ge==="butt")this.addCurrentVertex(Y,ne,0,0,q);else if(Ge==="square"){const fr=rt?1:-1;this.addCurrentVertex(Y,ne,fr,fr,q)}else Ge==="round"&&(rt&&(this.addCurrentVertex(Y,yt,0,0,q),this.addCurrentVertex(Y,yt,1,1,q,!0)),lt&&(this.addCurrentVertex(Y,Tt,-1,-1,q,!0),this.addCurrentVertex(Y,Tt,0,0,q)));if($e&&Ot<U-1){const fr=Y.dist(lt);if(fr>2*G){const nr=Y.add(lt.sub(Y)._mult(G/fr)._round());this.updateDistance(Y,nr),this.addCurrentVertex(nr,Tt,0,0,q),Y=nr}}}}addCurrentVertex(c,h,g,b,C){let T=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;const F=h.y*b-h.x,U=-h.y-h.x*b;this.addHalfVertex(c,h.x+h.y*g,h.y-h.x*g,T,!1,g,C),this.addHalfVertex(c,F,U,T,!0,-b,C),this.distance>JN/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(c,h,g,b,C,T))}addHalfVertex(c,h,g,b,C,T,F){let{x:U,y:k}=c;const G=.5*(this.lineClips?this.scaledDistance*(JN-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((U<<1)+(b?1:0),(k<<1)+(C?1:0),Math.round(63*h)+128,Math.round(63*g)+128,1+(T===0?0:T<0?-1:1)|(63&G)<<2,G>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const q=F.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,q),F.primitiveLength++),C?this.e2=q:this.e1=q}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(c,h){this.distance+=c.dist(h),this.updateScaledDistance()}}let YN,ZN;Je("LineBucket",sS,{omit:["layers","patternFeatures"]});var tk={get paint(){return ZN=ZN||new m({"line-opacity":new Er(st.paint_line["line-opacity"]),"line-color":new Er(st.paint_line["line-color"]),"line-translate":new ar(st.paint_line["line-translate"]),"line-translate-anchor":new ar(st.paint_line["line-translate-anchor"]),"line-width":new Er(st.paint_line["line-width"]),"line-gap-width":new Er(st.paint_line["line-gap-width"]),"line-offset":new Er(st.paint_line["line-offset"]),"line-blur":new Er(st.paint_line["line-blur"]),"line-dasharray":new E(st.paint_line["line-dasharray"]),"line-pattern":new wA(st.paint_line["line-pattern"]),"line-gradient":new L(st.paint_line["line-gradient"])})},get layout(){return YN=YN||new m({"line-cap":new ar(st.layout_line["line-cap"]),"line-join":new Er(st.layout_line["line-join"]),"line-miter-limit":new ar(st.layout_line["line-miter-limit"]),"line-round-limit":new ar(st.layout_line["line-round-limit"]),"line-sort-key":new Er(st.layout_line["line-sort-key"])})}};class Iwt extends Er{possiblyEvaluate(c,h){return h=new zn(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(c,h)}evaluate(c,h,g,b){return h=gt({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(c,h,g,b)}}let lv;class Fwt extends A{constructor(c){super(c,tk),this.gradientVersion=0,lv||(lv=new Iwt(tk.paint.properties["line-width"].specification),lv.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const h=this.gradientExpression();this.stepInterpolant=!!function(g){return g._styleExpression!==void 0}(h)&&h._styleExpression.expression instanceof Xe,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(c,h){super.recalculate(c,h),this.paint._values["line-floorwidth"]=lv.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new sS(c)}queryRadius(c){const h=c,g=ek(t0("line-width",this,h),t0("line-gap-width",this,h)),b=t0("line-offset",this,h);return g/2+Math.abs(b)+rv(this.paint.get("line-translate"))}queryIntersectsFeature(c,h,g,b,C,T,F){const U=nv(c,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),T.angle,F),k=F/2*ek(this.paint.get("line-width").evaluate(h,g),this.paint.get("line-gap-width").evaluate(h,g)),G=this.paint.get("line-offset").evaluate(h,g);return G&&(b=function(q,Y){const rt=[];for(let lt=0;lt<q.length;lt++){const yt=q[lt],Tt=[];for(let Ot=0;Ot<yt.length;Ot++){const ne=yt[Ot-1],zt=yt[Ot],Kt=yt[Ot+1],ce=Ot===0?new w(0,0):zt.sub(ne)._unit()._perp(),Te=Ot===yt.length-1?new w(0,0):Kt.sub(zt)._unit()._perp(),$e=ce._add(Te)._unit(),Sr=$e.x*Te.x+$e.y*Te.y;Sr!==0&&$e._mult(1/Sr),Tt.push($e._mult(Y)._add(zt))}rt.push(Tt)}return rt}(b,G*F)),function(q,Y,rt){for(let lt=0;lt<Y.length;lt++){const yt=Y[lt];if(q.length>=3){for(let Tt=0;Tt<yt.length;Tt++)if(Tu(q,yt[Tt]))return!0}if(Su(q,yt,rt))return!0}return!1}(U,b,k)}isTileClipped(){return!0}}function ek(u,c){return c>0?c+2*u:u}const Lwt=S([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Pwt=S([{name:"a_projected_pos",components:3,type:"Float32"}],4);S([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Mwt=S([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);S([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const rk=S([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Rwt=S([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Uwt(u,c,h){return u.sections.forEach(g=>{g.text=function(b,C,T){const F=C.layout.get("text-transform").evaluate(T,{});return F==="uppercase"?b=b.toLocaleUpperCase():F==="lowercase"&&(b=b.toLocaleLowerCase()),so.applyArabicShaping&&(b=so.applyArabicShaping(b)),b}(g.text,c,h)}),u}S([{name:"triangle",components:3,type:"Uint16"}]),S([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),S([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),S([{type:"Float32",name:"offsetX"}]),S([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),S([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const l0={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var rs=24,nk=Hn,ik=function(u,c,h,g,b){var C,T,F=8*b-g-1,U=(1<<F)-1,k=U>>1,G=-7,q=b-1,Y=-1,rt=u[c+q];for(q+=Y,C=rt&(1<<-G)-1,rt>>=-G,G+=F;G>0;C=256*C+u[c+q],q+=Y,G-=8);for(T=C&(1<<-G)-1,C>>=-G,G+=g;G>0;T=256*T+u[c+q],q+=Y,G-=8);if(C===0)C=1-k;else{if(C===U)return T?NaN:1/0*(rt?-1:1);T+=Math.pow(2,g),C-=k}return(rt?-1:1)*T*Math.pow(2,C-g)},sk=function(u,c,h,g,b,C){var T,F,U,k=8*C-b-1,G=(1<<k)-1,q=G>>1,Y=b===23?Math.pow(2,-24)-Math.pow(2,-77):0,rt=0,lt=1,yt=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(F=isNaN(c)?1:0,T=G):(T=Math.floor(Math.log(c)/Math.LN2),c*(U=Math.pow(2,-T))<1&&(T--,U*=2),(c+=T+q>=1?Y/U:Y*Math.pow(2,1-q))*U>=2&&(T++,U/=2),T+q>=G?(F=0,T=G):T+q>=1?(F=(c*U-1)*Math.pow(2,b),T+=q):(F=c*Math.pow(2,q-1)*Math.pow(2,b),T=0));b>=8;u[h+rt]=255&F,rt+=lt,F/=256,b-=8);for(T=T<<b|F,k+=b;k>0;u[h+rt]=255&T,rt+=lt,T/=256,k-=8);u[h+rt-lt]|=128*yt};function Hn(u){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(u)?u:new Uint8Array(u||0),this.pos=0,this.type=0,this.length=this.buf.length}Hn.Varint=0,Hn.Fixed64=1,Hn.Bytes=2,Hn.Fixed32=5;var oS=4294967296,ok=1/oS,ak=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function TA(u){return u.type===Hn.Bytes?u.readVarint()+u.pos:u.pos+1}function Up(u,c,h){return h?4294967296*c+(u>>>0):4294967296*(c>>>0)+(u>>>0)}function lk(u,c,h){var g=c<=16383?1:c<=2097151?2:c<=268435455?3:Math.floor(Math.log(c)/(7*Math.LN2));h.realloc(g);for(var b=h.pos-1;b>=u;b--)h.buf[b+g]=h.buf[b]}function Owt(u,c){for(var h=0;h<u.length;h++)c.writeVarint(u[h])}function Dwt(u,c){for(var h=0;h<u.length;h++)c.writeSVarint(u[h])}function Nwt(u,c){for(var h=0;h<u.length;h++)c.writeFloat(u[h])}function kwt(u,c){for(var h=0;h<u.length;h++)c.writeDouble(u[h])}function Qwt(u,c){for(var h=0;h<u.length;h++)c.writeBoolean(u[h])}function zwt(u,c){for(var h=0;h<u.length;h++)c.writeFixed32(u[h])}function Hwt(u,c){for(var h=0;h<u.length;h++)c.writeSFixed32(u[h])}function Vwt(u,c){for(var h=0;h<u.length;h++)c.writeFixed64(u[h])}function Gwt(u,c){for(var h=0;h<u.length;h++)c.writeSFixed64(u[h])}function cv(u,c){return(u[c]|u[c+1]<<8|u[c+2]<<16)+16777216*u[c+3]}function Op(u,c,h){u[h]=c,u[h+1]=c>>>8,u[h+2]=c>>>16,u[h+3]=c>>>24}function ck(u,c){return(u[c]|u[c+1]<<8|u[c+2]<<16)+(u[c+3]<<24)}Hn.prototype={destroy:function(){this.buf=null},readFields:function(u,c,h){for(h=h||this.length;this.pos<h;){var g=this.readVarint(),b=g>>3,C=this.pos;this.type=7&g,u(b,c,this),this.pos===C&&this.skip(g)}return c},readMessage:function(u,c){return this.readFields(u,c,this.readVarint()+this.pos)},readFixed32:function(){var u=cv(this.buf,this.pos);return this.pos+=4,u},readSFixed32:function(){var u=ck(this.buf,this.pos);return this.pos+=4,u},readFixed64:function(){var u=cv(this.buf,this.pos)+cv(this.buf,this.pos+4)*oS;return this.pos+=8,u},readSFixed64:function(){var u=cv(this.buf,this.pos)+ck(this.buf,this.pos+4)*oS;return this.pos+=8,u},readFloat:function(){var u=ik(this.buf,this.pos,!0,23,4);return this.pos+=4,u},readDouble:function(){var u=ik(this.buf,this.pos,!0,52,8);return this.pos+=8,u},readVarint:function(u){var c,h,g=this.buf;return c=127&(h=g[this.pos++]),h<128?c:(c|=(127&(h=g[this.pos++]))<<7,h<128?c:(c|=(127&(h=g[this.pos++]))<<14,h<128?c:(c|=(127&(h=g[this.pos++]))<<21,h<128?c:function(b,C,T){var F,U,k=T.buf;if(F=(112&(U=k[T.pos++]))>>4,U<128||(F|=(127&(U=k[T.pos++]))<<3,U<128)||(F|=(127&(U=k[T.pos++]))<<10,U<128)||(F|=(127&(U=k[T.pos++]))<<17,U<128)||(F|=(127&(U=k[T.pos++]))<<24,U<128)||(F|=(1&(U=k[T.pos++]))<<31,U<128))return Up(b,F,C);throw new Error("Expected varint not more than 10 bytes")}(c|=(15&(h=g[this.pos]))<<28,u,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var u=this.readVarint();return u%2==1?(u+1)/-2:u/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var u=this.readVarint()+this.pos,c=this.pos;return this.pos=u,u-c>=12&&ak?function(h,g,b){return ak.decode(h.subarray(g,b))}(this.buf,c,u):function(h,g,b){for(var C="",T=g;T<b;){var F,U,k,G=h[T],q=null,Y=G>239?4:G>223?3:G>191?2:1;if(T+Y>b)break;Y===1?G<128&&(q=G):Y===2?(192&(F=h[T+1]))==128&&(q=(31&G)<<6|63&F)<=127&&(q=null):Y===3?(U=h[T+2],(192&(F=h[T+1]))==128&&(192&U)==128&&((q=(15&G)<<12|(63&F)<<6|63&U)<=2047||q>=55296&&q<=57343)&&(q=null)):Y===4&&(U=h[T+2],k=h[T+3],(192&(F=h[T+1]))==128&&(192&U)==128&&(192&k)==128&&((q=(15&G)<<18|(63&F)<<12|(63&U)<<6|63&k)<=65535||q>=1114112)&&(q=null)),q===null?(q=65533,Y=1):q>65535&&(q-=65536,C+=String.fromCharCode(q>>>10&1023|55296),q=56320|1023&q),C+=String.fromCharCode(q),T+=Y}return C}(this.buf,c,u)},readBytes:function(){var u=this.readVarint()+this.pos,c=this.buf.subarray(this.pos,u);return this.pos=u,c},readPackedVarint:function(u,c){if(this.type!==Hn.Bytes)return u.push(this.readVarint(c));var h=TA(this);for(u=u||[];this.pos<h;)u.push(this.readVarint(c));return u},readPackedSVarint:function(u){if(this.type!==Hn.Bytes)return u.push(this.readSVarint());var c=TA(this);for(u=u||[];this.pos<c;)u.push(this.readSVarint());return u},readPackedBoolean:function(u){if(this.type!==Hn.Bytes)return u.push(this.readBoolean());var c=TA(this);for(u=u||[];this.pos<c;)u.push(this.readBoolean());return u},readPackedFloat:function(u){if(this.type!==Hn.Bytes)return u.push(this.readFloat());var c=TA(this);for(u=u||[];this.pos<c;)u.push(this.readFloat());return u},readPackedDouble:function(u){if(this.type!==Hn.Bytes)return u.push(this.readDouble());var c=TA(this);for(u=u||[];this.pos<c;)u.push(this.readDouble());return u},readPackedFixed32:function(u){if(this.type!==Hn.Bytes)return u.push(this.readFixed32());var c=TA(this);for(u=u||[];this.pos<c;)u.push(this.readFixed32());return u},readPackedSFixed32:function(u){if(this.type!==Hn.Bytes)return u.push(this.readSFixed32());var c=TA(this);for(u=u||[];this.pos<c;)u.push(this.readSFixed32());return u},readPackedFixed64:function(u){if(this.type!==Hn.Bytes)return u.push(this.readFixed64());var c=TA(this);for(u=u||[];this.pos<c;)u.push(this.readFixed64());return u},readPackedSFixed64:function(u){if(this.type!==Hn.Bytes)return u.push(this.readSFixed64());var c=TA(this);for(u=u||[];this.pos<c;)u.push(this.readSFixed64());return u},skip:function(u){var c=7&u;if(c===Hn.Varint)for(;this.buf[this.pos++]>127;);else if(c===Hn.Bytes)this.pos=this.readVarint()+this.pos;else if(c===Hn.Fixed32)this.pos+=4;else{if(c!==Hn.Fixed64)throw new Error("Unimplemented type: "+c);this.pos+=8}},writeTag:function(u,c){this.writeVarint(u<<3|c)},realloc:function(u){for(var c=this.length||16;c<this.pos+u;)c*=2;if(c!==this.length){var h=new Uint8Array(c);h.set(this.buf),this.buf=h,this.length=c}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(u){this.realloc(4),Op(this.buf,u,this.pos),this.pos+=4},writeSFixed32:function(u){this.realloc(4),Op(this.buf,u,this.pos),this.pos+=4},writeFixed64:function(u){this.realloc(8),Op(this.buf,-1&u,this.pos),Op(this.buf,Math.floor(u*ok),this.pos+4),this.pos+=8},writeSFixed64:function(u){this.realloc(8),Op(this.buf,-1&u,this.pos),Op(this.buf,Math.floor(u*ok),this.pos+4),this.pos+=8},writeVarint:function(u){(u=+u||0)>268435455||u<0?function(c,h){var g,b;if(c>=0?(g=c%4294967296|0,b=c/4294967296|0):(b=~(-c/4294967296),4294967295^(g=~(-c%4294967296))?g=g+1|0:(g=0,b=b+1|0)),c>=18446744073709552e3||c<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),function(C,T,F){F.buf[F.pos++]=127&C|128,C>>>=7,F.buf[F.pos++]=127&C|128,C>>>=7,F.buf[F.pos++]=127&C|128,C>>>=7,F.buf[F.pos++]=127&C|128,F.buf[F.pos]=127&(C>>>=7)}(g,0,h),function(C,T){var F=(7&C)<<4;T.buf[T.pos++]|=F|((C>>>=3)?128:0),C&&(T.buf[T.pos++]=127&C|((C>>>=7)?128:0),C&&(T.buf[T.pos++]=127&C|((C>>>=7)?128:0),C&&(T.buf[T.pos++]=127&C|((C>>>=7)?128:0),C&&(T.buf[T.pos++]=127&C|((C>>>=7)?128:0),C&&(T.buf[T.pos++]=127&C)))))}(b,h)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(u){this.writeVarint(u<0?2*-u-1:2*u)},writeBoolean:function(u){this.writeVarint(!!u)},writeString:function(u){u=String(u),this.realloc(4*u.length),this.pos++;var c=this.pos;this.pos=function(g,b,C){for(var T,F,U=0;U<b.length;U++){if((T=b.charCodeAt(U))>55295&&T<57344){if(!F){T>56319||U+1===b.length?(g[C++]=239,g[C++]=191,g[C++]=189):F=T;continue}if(T<56320){g[C++]=239,g[C++]=191,g[C++]=189,F=T;continue}T=F-55296<<10|T-56320|65536,F=null}else F&&(g[C++]=239,g[C++]=191,g[C++]=189,F=null);T<128?g[C++]=T:(T<2048?g[C++]=T>>6|192:(T<65536?g[C++]=T>>12|224:(g[C++]=T>>18|240,g[C++]=T>>12&63|128),g[C++]=T>>6&63|128),g[C++]=63&T|128)}return C}(this.buf,u,this.pos);var h=this.pos-c;h>=128&&lk(c,h,this),this.pos=c-1,this.writeVarint(h),this.pos+=h},writeFloat:function(u){this.realloc(4),sk(this.buf,u,this.pos,!0,23,4),this.pos+=4},writeDouble:function(u){this.realloc(8),sk(this.buf,u,this.pos,!0,52,8),this.pos+=8},writeBytes:function(u){var c=u.length;this.writeVarint(c),this.realloc(c);for(var h=0;h<c;h++)this.buf[this.pos++]=u[h]},writeRawMessage:function(u,c){this.pos++;var h=this.pos;u(c,this);var g=this.pos-h;g>=128&&lk(h,g,this),this.pos=h-1,this.writeVarint(g),this.pos+=g},writeMessage:function(u,c,h){this.writeTag(u,Hn.Bytes),this.writeRawMessage(c,h)},writePackedVarint:function(u,c){c.length&&this.writeMessage(u,Owt,c)},writePackedSVarint:function(u,c){c.length&&this.writeMessage(u,Dwt,c)},writePackedBoolean:function(u,c){c.length&&this.writeMessage(u,Qwt,c)},writePackedFloat:function(u,c){c.length&&this.writeMessage(u,Nwt,c)},writePackedDouble:function(u,c){c.length&&this.writeMessage(u,kwt,c)},writePackedFixed32:function(u,c){c.length&&this.writeMessage(u,zwt,c)},writePackedSFixed32:function(u,c){c.length&&this.writeMessage(u,Hwt,c)},writePackedFixed64:function(u,c){c.length&&this.writeMessage(u,Vwt,c)},writePackedSFixed64:function(u,c){c.length&&this.writeMessage(u,Gwt,c)},writeBytesField:function(u,c){this.writeTag(u,Hn.Bytes),this.writeBytes(c)},writeFixed32Field:function(u,c){this.writeTag(u,Hn.Fixed32),this.writeFixed32(c)},writeSFixed32Field:function(u,c){this.writeTag(u,Hn.Fixed32),this.writeSFixed32(c)},writeFixed64Field:function(u,c){this.writeTag(u,Hn.Fixed64),this.writeFixed64(c)},writeSFixed64Field:function(u,c){this.writeTag(u,Hn.Fixed64),this.writeSFixed64(c)},writeVarintField:function(u,c){this.writeTag(u,Hn.Varint),this.writeVarint(c)},writeSVarintField:function(u,c){this.writeTag(u,Hn.Varint),this.writeSVarint(c)},writeStringField:function(u,c){this.writeTag(u,Hn.Bytes),this.writeString(c)},writeFloatField:function(u,c){this.writeTag(u,Hn.Fixed32),this.writeFloat(c)},writeDoubleField:function(u,c){this.writeTag(u,Hn.Fixed64),this.writeDouble(c)},writeBooleanField:function(u,c){this.writeVarintField(u,!!c)}};var aS=d(nk);const lS=3;function jwt(u,c,h){u===1&&h.readMessage(qwt,c)}function qwt(u,c,h){if(u===3){const{id:g,bitmap:b,width:C,height:T,left:F,top:U,advance:k}=h.readMessage(Kwt,{});c.push({id:g,bitmap:new r0({width:C+2*lS,height:T+2*lS},b),metrics:{width:C,height:T,left:F,top:U,advance:k}})}}function Kwt(u,c,h){u===1?c.id=h.readVarint():u===2?c.bitmap=h.readBytes():u===3?c.width=h.readVarint():u===4?c.height=h.readVarint():u===5?c.left=h.readSVarint():u===6?c.top=h.readSVarint():u===7&&(c.advance=h.readVarint())}const uk=lS;function Ak(u){let c=0,h=0;for(const T of u)c+=T.w*T.h,h=Math.max(h,T.w);u.sort((T,F)=>F.h-T.h);const g=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(c/.95)),h),h:1/0}];let b=0,C=0;for(const T of u)for(let F=g.length-1;F>=0;F--){const U=g[F];if(!(T.w>U.w||T.h>U.h)){if(T.x=U.x,T.y=U.y,C=Math.max(C,T.y+T.h),b=Math.max(b,T.x+T.w),T.w===U.w&&T.h===U.h){const k=g.pop();F<g.length&&(g[F]=k)}else T.h===U.h?(U.x+=T.w,U.w-=T.w):T.w===U.w?(U.y+=T.h,U.h-=T.h):(g.push({x:U.x+T.w,y:U.y,w:U.w-T.w,h:T.h}),U.y+=T.h,U.h-=T.h);break}}return{w:b,h:C,fill:c/(b*C)||0}}const aa=1;class cS{constructor(c,h){let{pixelRatio:g,version:b,stretchX:C,stretchY:T,content:F,textFitWidth:U,textFitHeight:k}=h;this.paddedRect=c,this.pixelRatio=g,this.stretchX=C,this.stretchY=T,this.content=F,this.version=b,this.textFitWidth=U,this.textFitHeight=k}get tl(){return[this.paddedRect.x+aa,this.paddedRect.y+aa]}get br(){return[this.paddedRect.x+this.paddedRect.w-aa,this.paddedRect.y+this.paddedRect.h-aa]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*aa)/this.pixelRatio,(this.paddedRect.h-2*aa)/this.pixelRatio]}}class hk{constructor(c,h){const g={},b={};this.haveRenderCallbacks=[];const C=[];this.addImages(c,g,C),this.addImages(h,b,C);const{w:T,h:F}=Ak(C),U=new al({width:T||1,height:F||1});for(const k in c){const G=c[k],q=g[k].paddedRect;al.copy(G.data,U,{x:0,y:0},{x:q.x+aa,y:q.y+aa},G.data)}for(const k in h){const G=h[k],q=b[k].paddedRect,Y=q.x+aa,rt=q.y+aa,lt=G.data.width,yt=G.data.height;al.copy(G.data,U,{x:0,y:0},{x:Y,y:rt},G.data),al.copy(G.data,U,{x:0,y:yt-1},{x:Y,y:rt-1},{width:lt,height:1}),al.copy(G.data,U,{x:0,y:0},{x:Y,y:rt+yt},{width:lt,height:1}),al.copy(G.data,U,{x:lt-1,y:0},{x:Y-1,y:rt},{width:1,height:yt}),al.copy(G.data,U,{x:0,y:0},{x:Y+lt,y:rt},{width:1,height:yt})}this.image=U,this.iconPositions=g,this.patternPositions=b}addImages(c,h,g){for(const b in c){const C=c[b],T={x:0,y:0,w:C.data.width+2*aa,h:C.data.height+2*aa};g.push(T),h[b]=new cS(T,C),C.hasRenderCallback&&this.haveRenderCallbacks.push(b)}}patchUpdatedImages(c,h){c.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const g in c.updatedImages)this.patchUpdatedImage(this.iconPositions[g],c.getImage(g),h),this.patchUpdatedImage(this.patternPositions[g],c.getImage(g),h)}patchUpdatedImage(c,h,g){if(!c||!h||c.version===h.version)return;c.version=h.version;const[b,C]=c.tl;g.update(h.data,void 0,{x:b,y:C})}}var Eh;Je("ImagePosition",cS),Je("ImageAtlas",hk),a.ah=void 0,(Eh=a.ah||(a.ah={}))[Eh.none=0]="none",Eh[Eh.horizontal=1]="horizontal",Eh[Eh.vertical=2]="vertical",Eh[Eh.horizontalOnly=3]="horizontalOnly";const c0=-17;class u0{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(c,h){const g=new u0;return g.scale=c||1,g.fontStack=h,g}static forImage(c){const h=new u0;return h.imageName=c,h}}class Dp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(c,h){const g=new Dp;for(let b=0;b<c.sections.length;b++){const C=c.sections[b];C.image?g.addImageSection(C):g.addTextSection(C,h)}return g}length(){return this.text.length}getSection(c){return this.sections[this.sectionIndex[c]]}getSectionIndex(c){return this.sectionIndex[c]}getCharCode(c){return this.text.charCodeAt(c)}verticalizePunctuation(){this.text=function(c){let h="";for(let g=0;g<c.length;g++){const b=c.charCodeAt(g+1)||null,C=c.charCodeAt(g-1)||null;h+=b&&_A(b)&&!l0[c[g+1]]||C&&_A(C)&&!l0[c[g-1]]||!l0[c[g]]?c[g]:l0[c[g]]}return h}(this.text)}trim(){let c=0;for(let g=0;g<this.text.length&&Av[this.text.charCodeAt(g)];g++)c++;let h=this.text.length;for(let g=this.text.length-1;g>=0&&g>=c&&Av[this.text.charCodeAt(g)];g--)h--;this.text=this.text.substring(c,h),this.sectionIndex=this.sectionIndex.slice(c,h)}substring(c,h){const g=new Dp;return g.text=this.text.substring(c,h),g.sectionIndex=this.sectionIndex.slice(c,h),g.sections=this.sections,g}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((c,h)=>Math.max(c,this.sections[h].scale),0)}addTextSection(c,h){this.text+=c.text,this.sections.push(u0.forText(c.scale,c.fontStack||h));const g=this.sections.length-1;for(let b=0;b<c.text.length;++b)this.sectionIndex.push(g)}addImageSection(c){const h=c.image?c.image.name:"";if(h.length===0)return void bt("Can't add FormattedSection with an empty image.");const g=this.getNextImageSectionCharCode();g?(this.text+=String.fromCharCode(g),this.sections.push(u0.forImage(h)),this.sectionIndex.push(this.sections.length-1)):bt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function uv(u,c,h,g,b,C,T,F,U,k,G,q,Y,rt,lt){const yt=Dp.fromFeature(u,b);let Tt;q===a.ah.vertical&&yt.verticalizePunctuation();const{processBidirectionalText:Ot,processStyledBidirectionalText:ne}=so;if(Ot&&yt.sections.length===1){Tt=[];const ce=Ot(yt.toString(),uS(yt,k,C,c,g,rt));for(const Te of ce){const $e=new Dp;$e.text=Te,$e.sections=yt.sections;for(let Sr=0;Sr<Te.length;Sr++)$e.sectionIndex.push(0);Tt.push($e)}}else if(ne){Tt=[];const ce=ne(yt.text,yt.sectionIndex,uS(yt,k,C,c,g,rt));for(const Te of ce){const $e=new Dp;$e.text=Te[0],$e.sectionIndex=Te[1],$e.sections=yt.sections,Tt.push($e)}}else Tt=function(ce,Te){const $e=[],Sr=ce.text;let qe=0;for(const Ge of Te)$e.push(ce.substring(qe,Ge)),qe=Ge;return qe<Sr.length&&$e.push(ce.substring(qe,Sr.length)),$e}(yt,uS(yt,k,C,c,g,rt));const zt=[],Kt={positionedLines:zt,text:yt.toString(),top:G[1],bottom:G[1],left:G[0],right:G[0],writingMode:q,iconsInText:!1,verticalizable:!1};return function(ce,Te,$e,Sr,qe,Ge,fr,nr,Ze,me,mr,Ar){let Nr=0,$n=c0,Vn=0,ps=0;const Hl=nr==="right"?1:nr==="left"?0:.5;let js=0;for(const Ii of qe){Ii.trim();const ms=Ii.getMaxScale(),co=(ms-1)*rs,qs={positionedGlyphs:[],lineOffset:0};ce.positionedLines[js]=qs;const No=qs.positionedGlyphs;let Ks=0;if(!Ii.length()){$n+=Ge,++js;continue}for(let la=0;la<Ii.length();la++){const En=Ii.getSection(la),ri=Ii.getSectionIndex(la),li=Ii.getCharCode(la);let Pa=0,Ci=null,zp=null,Fu=null,Lu=rs;const Vl=!(Ze===a.ah.horizontal||!mr&&!Dd(li)||mr&&(Av[li]||(gs=li,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(gs)))));if(En.imageName){const ul=Sr[En.imageName];if(!ul)continue;Fu=En.imageName,ce.iconsInText=ce.iconsInText||!0,zp=ul.paddedRect;const Ls=ul.displaySize;En.scale=En.scale*rs/Ar,Ci={width:Ls[0],height:Ls[1],left:aa,top:-uk,advance:Vl?Ls[1]:Ls[0]},Pa=co+(rs-Ls[1]*En.scale),Lu=Ci.advance;const IA=Vl?Ls[0]*En.scale-rs*ms:Ls[1]*En.scale-rs*ms;IA>0&&IA>Ks&&(Ks=IA)}else{const ul=$e[En.fontStack],Ls=ul&&ul[li];if(Ls&&Ls.rect)zp=Ls.rect,Ci=Ls.metrics;else{const IA=Te[En.fontStack],g0=IA&&IA[li];if(!g0)continue;Ci=g0.metrics}Pa=(ms-En.scale)*rs}Vl?(ce.verticalizable=!0,No.push({glyph:li,imageName:Fu,x:Nr,y:$n+Pa,vertical:Vl,scale:En.scale,fontStack:En.fontStack,sectionIndex:ri,metrics:Ci,rect:zp}),Nr+=Lu*En.scale+me):(No.push({glyph:li,imageName:Fu,x:Nr,y:$n+Pa,vertical:Vl,scale:En.scale,fontStack:En.fontStack,sectionIndex:ri,metrics:Ci,rect:zp}),Nr+=Ci.advance*En.scale+me)}No.length!==0&&(Vn=Math.max(Nr-me,Vn),Jwt(No,0,No.length-1,Hl,Ks)),Nr=0;const cl=Ge*ms+Ks;qs.lineOffset=Math.max(Ks,co),$n+=cl,ps=Math.max(cl,ps),++js}var gs;const Uo=$n-c0,{horizontalAlign:Oo,verticalAlign:Do}=AS(fr);(function(Ii,ms,co,qs,No,Ks,cl,la,En){const ri=(ms-co)*No;let li=0;li=Ks!==cl?-la*qs-c0:(-qs*En+.5)*cl;for(const Pa of Ii)for(const Ci of Pa.positionedGlyphs)Ci.x+=ri,Ci.y+=li})(ce.positionedLines,Hl,Oo,Do,Vn,ps,Ge,Uo,qe.length),ce.top+=-Do*Uo,ce.bottom=ce.top+Uo,ce.left+=-Oo*Vn,ce.right=ce.left+Vn}(Kt,c,h,g,Tt,T,F,U,q,k,Y,lt),!function(ce){for(const Te of ce)if(Te.positionedGlyphs.length!==0)return!1;return!0}(zt)&&Kt}const Av={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},$wt={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Wwt={40:!0};function dk(u,c,h,g,b,C){if(c.imageName){const T=g[c.imageName];return T?T.displaySize[0]*c.scale*rs/C+b:0}{const T=h[c.fontStack],F=T&&T[u];return F?F.metrics.advance*c.scale+b:0}}function fk(u,c,h,g){const b=Math.pow(u-c,2);return g?u<c?b/2:2*b:b+Math.abs(h)*h}function Xwt(u,c,h){let g=0;return u===10&&(g-=1e4),h&&(g+=150),u!==40&&u!==65288||(g+=50),c!==41&&c!==65289||(g+=50),g}function pk(u,c,h,g,b,C){let T=null,F=fk(c,h,b,C);for(const U of g){const k=fk(c-U.x,h,b,C)+U.badness;k<=F&&(T=U,F=k)}return{index:u,x:c,priorBreak:T,badness:F}}function gk(u){return u?gk(u.priorBreak).concat(u.index):[]}function uS(u,c,h,g,b,C){if(!u)return[];const T=[],F=function(q,Y,rt,lt,yt,Tt){let Ot=0;for(let ne=0;ne<q.length();ne++){const zt=q.getSection(ne);Ot+=dk(q.getCharCode(ne),zt,lt,yt,Y,Tt)}return Ot/Math.max(1,Math.ceil(Ot/rt))}(u,c,h,g,b,C),U=u.text.indexOf("")>=0;let k=0;for(let q=0;q<u.length();q++){const Y=u.getSection(q),rt=u.getCharCode(q);if(Av[rt]||(k+=dk(rt,Y,g,b,c,C)),q<u.length()-1){const lt=!((G=rt)<11904)&&(!!kr["CJK Compatibility Forms"](G)||!!kr["CJK Compatibility"](G)||!!kr["CJK Strokes"](G)||!!kr["CJK Symbols and Punctuation"](G)||!!kr["Enclosed CJK Letters and Months"](G)||!!kr["Halfwidth and Fullwidth Forms"](G)||!!kr["Ideographic Description Characters"](G)||!!kr["Vertical Forms"](G)||Od.test(String.fromCodePoint(G)));($wt[rt]||lt||Y.imageName||q!==u.length()-2&&Wwt[u.getCharCode(q+1)])&&T.push(pk(q+1,k,F,T,Xwt(rt,u.getCharCode(q+1),lt&&U),!1))}}var G;return gk(pk(u.length(),k,F,T,0,!0))}function AS(u){let c=.5,h=.5;switch(u){case"right":case"top-right":case"bottom-right":c=1;break;case"left":case"top-left":case"bottom-left":c=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:c,verticalAlign:h}}function Jwt(u,c,h,g,b){if(!g&&!b)return;const C=u[h],T=(u[h].x+C.metrics.advance*C.scale)*g;for(let F=c;F<=h;F++)u[F].x-=T,u[F].y+=b}function Ywt(u,c,h){const{horizontalAlign:g,verticalAlign:b}=AS(h),C=c[0]-u.displaySize[0]*g,T=c[1]-u.displaySize[1]*b;return{image:u,top:T,bottom:T+u.displaySize[1],left:C,right:C+u.displaySize[0]}}function mk(u){var c,h;let g=u.left,b=u.top,C=u.right-g,T=u.bottom-b;const F=(c=u.image.textFitWidth)!==null&&c!==void 0?c:"stretchOrShrink",U=(h=u.image.textFitHeight)!==null&&h!==void 0?h:"stretchOrShrink",k=(u.image.content[2]-u.image.content[0])/(u.image.content[3]-u.image.content[1]);if(U==="proportional"){if(F==="stretchOnly"&&C/T<k||F==="proportional"){const G=Math.ceil(T*k);g*=G/C,C=G}}else if(F==="proportional"&&U==="stretchOnly"&&k!==0&&C/T>k){const G=Math.ceil(C/k);b*=G/T,T=G}return{x1:g,y1:b,x2:g+C,y2:b+T}}function yk(u,c,h,g,b,C){const T=u.image;let F;if(T.content){const Tt=T.content,Ot=T.pixelRatio||1;F=[Tt[0]/Ot,Tt[1]/Ot,T.displaySize[0]-Tt[2]/Ot,T.displaySize[1]-Tt[3]/Ot]}const U=c.left*C,k=c.right*C;let G,q,Y,rt;h==="width"||h==="both"?(rt=b[0]+U-g[3],q=b[0]+k+g[1]):(rt=b[0]+(U+k-T.displaySize[0])/2,q=rt+T.displaySize[0]);const lt=c.top*C,yt=c.bottom*C;return h==="height"||h==="both"?(G=b[1]+lt-g[0],Y=b[1]+yt+g[2]):(G=b[1]+(lt+yt-T.displaySize[1])/2,Y=G+T.displaySize[1]),{image:T,top:G,right:q,bottom:Y,left:rt,collisionPadding:F}}const A0=255,Iu=128,Sh=A0*Iu;function _k(u,c){const{expression:h}=c;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new zn(u+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:g,interpolationType:b}=h;let C=0;for(;C<g.length&&g[C]<=u;)C++;C=Math.max(0,C-1);let T=C;for(;T<g.length&&g[T]<u+1;)T++;T=Math.min(g.length-1,T);const F=g[C],U=g[T];return h.kind==="composite"?{kind:"composite",minZoom:F,maxZoom:U,interpolationType:b}:{kind:"camera",minZoom:F,maxZoom:U,minSize:h.evaluate(new zn(F)),maxSize:h.evaluate(new zn(U)),interpolationType:b}}}function hS(u,c,h){let g="never";const b=u.get(c);return b?g=b:u.get(h)&&(g="always"),g}const Zwt=Ch.VectorTileFeature.types,t2t=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function hv(u,c,h,g,b,C,T,F,U,k,G,q,Y){const rt=F?Math.min(Sh,Math.round(F[0])):0,lt=F?Math.min(Sh,Math.round(F[1])):0;u.emplaceBack(c,h,Math.round(32*g),Math.round(32*b),C,T,(rt<<1)+(U?1:0),lt,16*k,16*G,256*q,256*Y)}function dS(u,c,h){u.emplaceBack(c.x,c.y,h),u.emplaceBack(c.x,c.y,h),u.emplaceBack(c.x,c.y,h),u.emplaceBack(c.x,c.y,h)}function e2t(u){for(const c of u.sections)if(xp(c.text))return!0;return!1}class fS{constructor(c){this.layoutVertexArray=new xA,this.indexArray=new ds,this.programConfigurations=c,this.segments=new an,this.dynamicLayoutVertexArray=new wu,this.opacityVertexArray=new hs,this.hasVisibleVertices=!1,this.placedSymbolArray=new Pr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(c,h,g,b){this.isEmpty()||(g&&(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,Lwt.members),this.indexBuffer=c.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=c.createVertexBuffer(this.dynamicLayoutVertexArray,Pwt.members,!0),this.opacityVertexBuffer=c.createVertexBuffer(this.opacityVertexArray,t2t,!0),this.opacityVertexBuffer.itemSize=1),(g||b)&&this.programConfigurations.upload(c))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Je("SymbolBuffers",fS);class pS{constructor(c,h,g){this.layoutVertexArray=new c,this.layoutAttributes=h,this.indexArray=new g,this.segments=new an,this.collisionVertexArray=new Vi}upload(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=c.createVertexBuffer(this.collisionVertexArray,Mwt.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Je("CollisionBuffers",pS);class Np{constructor(c){this.collisionBoxArray=c.collisionBoxArray,this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(T=>T.id),this.index=c.index,this.pixelRatio=c.pixelRatio,this.sourceLayerIndex=c.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=$E([]),this.placementViewportMatrix=$E([]);const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=_k(this.zoom,h["text-size"]),this.iconSizeData=_k(this.zoom,h["icon-size"]);const g=this.layers[0].layout,b=g.get("symbol-sort-key"),C=g.get("symbol-z-order");this.canOverlap=hS(g,"text-overlap","text-allow-overlap")!=="never"||hS(g,"icon-overlap","icon-allow-overlap")!=="never"||g.get("text-ignore-placement")||g.get("icon-ignore-placement"),this.sortFeaturesByKey=C!=="viewport-y"&&!b.isConstant(),this.sortFeaturesByY=(C==="viewport-y"||C==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,g.get("symbol-placement")==="point"&&(this.writingModes=g.get("text-writing-mode").map(T=>a.ah[T])),this.stateDependentLayerIds=this.layers.filter(T=>T.isStateDependent()).map(T=>T.id),this.sourceID=c.sourceID}createArrays(){this.text=new fS(new Cu(this.layers,this.zoom,c=>/^text/.test(c))),this.icon=new fS(new Cu(this.layers,this.zoom,c=>/^icon/.test(c))),this.glyphOffsetArray=new Kr,this.lineVertexArray=new Bn,this.symbolInstances=new Dr,this.textAnchorOffsets=new fn}calculateGlyphDependencies(c,h,g,b,C){for(let T=0;T<c.length;T++)if(h[c.charCodeAt(T)]=!0,(g||b)&&C){const F=l0[c.charAt(T)];F&&(h[F.charCodeAt(0)]=!0)}}populate(c,h,g){const b=this.layers[0],C=b.layout,T=C.get("text-font"),F=C.get("text-field"),U=C.get("icon-image"),k=(F.value.kind!=="constant"||F.value.value instanceof qr&&!F.value.value.isEmpty()||F.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),G=U.value.kind!=="constant"||!!U.value.value||Object.keys(U.parameters).length>0,q=C.get("symbol-sort-key");if(this.features=[],!k&&!G)return;const Y=h.iconDependencies,rt=h.glyphDependencies,lt=h.availableImages,yt=new zn(this.zoom);for(const{feature:Tt,id:Ot,index:ne,sourceLayerIndex:zt}of c){const Kt=b._featureFilter.needGeometry,ce=Eu(Tt,Kt);if(!b._featureFilter.filter(yt,ce,g))continue;let Te,$e;if(Kt||(ce.geometry=EA(Tt)),k){const qe=b.getValueAndResolveTokens("text-field",ce,g,lt),Ge=qr.factory(qe),fr=this.hasRTLText=this.hasRTLText||e2t(Ge);(!fr||so.getRTLTextPluginStatus()==="unavailable"||fr&&so.isParsed())&&(Te=Uwt(Ge,b,ce))}if(G){const qe=b.getValueAndResolveTokens("icon-image",ce,g,lt);$e=qe instanceof tn?qe:tn.fromString(qe)}if(!Te&&!$e)continue;const Sr=this.sortFeaturesByKey?q.evaluate(ce,{},g):void 0;if(this.features.push({id:Ot,text:Te,icon:$e,index:ne,sourceLayerIndex:zt,geometry:ce.geometry,properties:Tt.properties,type:Zwt[Tt.type],sortKey:Sr}),$e&&(Y[$e.name]=!0),Te){const qe=T.evaluate(ce,{},g).join(","),Ge=C.get("text-rotation-alignment")!=="viewport"&&C.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.ah.vertical)>=0;for(const fr of Te.sections)if(fr.image)Y[fr.image.name]=!0;else{const nr=Ud(Te.toString()),Ze=fr.fontStack||qe,me=rt[Ze]=rt[Ze]||{};this.calculateGlyphDependencies(fr.text,me,Ge,this.allowVerticalPlacement,nr)}}}C.get("symbol-placement")==="line"&&(this.features=function(Tt){const Ot={},ne={},zt=[];let Kt=0;function ce(qe){zt.push(Tt[qe]),Kt++}function Te(qe,Ge,fr){const nr=ne[qe];return delete ne[qe],ne[Ge]=nr,zt[nr].geometry[0].pop(),zt[nr].geometry[0]=zt[nr].geometry[0].concat(fr[0]),nr}function $e(qe,Ge,fr){const nr=Ot[Ge];return delete Ot[Ge],Ot[qe]=nr,zt[nr].geometry[0].shift(),zt[nr].geometry[0]=fr[0].concat(zt[nr].geometry[0]),nr}function Sr(qe,Ge,fr){const nr=fr?Ge[0][Ge[0].length-1]:Ge[0][0];return`${qe}:${nr.x}:${nr.y}`}for(let qe=0;qe<Tt.length;qe++){const Ge=Tt[qe],fr=Ge.geometry,nr=Ge.text?Ge.text.toString():null;if(!nr){ce(qe);continue}const Ze=Sr(nr,fr),me=Sr(nr,fr,!0);if(Ze in ne&&me in Ot&&ne[Ze]!==Ot[me]){const mr=$e(Ze,me,fr),Ar=Te(Ze,me,zt[mr].geometry);delete Ot[Ze],delete ne[me],ne[Sr(nr,zt[Ar].geometry,!0)]=Ar,zt[mr].geometry=null}else Ze in ne?Te(Ze,me,fr):me in Ot?$e(Ze,me,fr):(ce(qe),Ot[Ze]=Kt-1,ne[me]=Kt-1)}return zt.filter(qe=>qe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Tt,Ot)=>Tt.sortKey-Ot.sortKey)}update(c,h,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(c,h,this.layers,g),this.icon.programConfigurations.updatePaintArrays(c,h,this.layers,g))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(c){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(c),this.iconCollisionBox.upload(c)),this.text.upload(c,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(c,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(c,h){const g=this.lineVertexArray.length;if(c.segment!==void 0){let b=c.dist(h[c.segment+1]),C=c.dist(h[c.segment]);const T={};for(let F=c.segment+1;F<h.length;F++)T[F]={x:h[F].x,y:h[F].y,tileUnitDistanceFromAnchor:b},F<h.length-1&&(b+=h[F+1].dist(h[F]));for(let F=c.segment||0;F>=0;F--)T[F]={x:h[F].x,y:h[F].y,tileUnitDistanceFromAnchor:C},F>0&&(C+=h[F-1].dist(h[F]));for(let F=0;F<h.length;F++){const U=T[F];this.lineVertexArray.emplaceBack(U.x,U.y,U.tileUnitDistanceFromAnchor)}}return{lineStartIndex:g,lineLength:this.lineVertexArray.length-g}}addSymbols(c,h,g,b,C,T,F,U,k,G,q,Y){const rt=c.indexArray,lt=c.layoutVertexArray,yt=c.segments.prepareSegment(4*h.length,lt,rt,this.canOverlap?T.sortKey:void 0),Tt=this.glyphOffsetArray.length,Ot=yt.vertexLength,ne=this.allowVerticalPlacement&&F===a.ah.vertical?Math.PI/2:0,zt=T.text&&T.text.sections;for(let Kt=0;Kt<h.length;Kt++){const{tl:ce,tr:Te,bl:$e,br:Sr,tex:qe,pixelOffsetTL:Ge,pixelOffsetBR:fr,minFontScaleX:nr,minFontScaleY:Ze,glyphOffset:me,isSDF:mr,sectionIndex:Ar}=h[Kt],Nr=yt.vertexLength,$n=me[1];hv(lt,U.x,U.y,ce.x,$n+ce.y,qe.x,qe.y,g,mr,Ge.x,Ge.y,nr,Ze),hv(lt,U.x,U.y,Te.x,$n+Te.y,qe.x+qe.w,qe.y,g,mr,fr.x,Ge.y,nr,Ze),hv(lt,U.x,U.y,$e.x,$n+$e.y,qe.x,qe.y+qe.h,g,mr,Ge.x,fr.y,nr,Ze),hv(lt,U.x,U.y,Sr.x,$n+Sr.y,qe.x+qe.w,qe.y+qe.h,g,mr,fr.x,fr.y,nr,Ze),dS(c.dynamicLayoutVertexArray,U,ne),rt.emplaceBack(Nr,Nr+1,Nr+2),rt.emplaceBack(Nr+1,Nr+2,Nr+3),yt.vertexLength+=4,yt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(me[0]),Kt!==h.length-1&&Ar===h[Kt+1].sectionIndex||c.programConfigurations.populatePaintArrays(lt.length,T,T.index,{},Y,zt&&zt[Ar])}c.placedSymbolArray.emplaceBack(U.x,U.y,Tt,this.glyphOffsetArray.length-Tt,Ot,k,G,U.segment,g?g[0]:0,g?g[1]:0,b[0],b[1],F,0,!1,0,q)}_addCollisionDebugVertex(c,h,g,b,C,T){return h.emplaceBack(0,0),c.emplaceBack(g.x,g.y,b,C,Math.round(T.x),Math.round(T.y))}addCollisionDebugVertices(c,h,g,b,C,T,F){const U=C.segments.prepareSegment(4,C.layoutVertexArray,C.indexArray),k=U.vertexLength,G=C.layoutVertexArray,q=C.collisionVertexArray,Y=F.anchorX,rt=F.anchorY;this._addCollisionDebugVertex(G,q,T,Y,rt,new w(c,h)),this._addCollisionDebugVertex(G,q,T,Y,rt,new w(g,h)),this._addCollisionDebugVertex(G,q,T,Y,rt,new w(g,b)),this._addCollisionDebugVertex(G,q,T,Y,rt,new w(c,b)),U.vertexLength+=4;const lt=C.indexArray;lt.emplaceBack(k,k+1),lt.emplaceBack(k+1,k+2),lt.emplaceBack(k+2,k+3),lt.emplaceBack(k+3,k),U.primitiveLength+=4}addDebugCollisionBoxes(c,h,g,b){for(let C=c;C<h;C++){const T=this.collisionBoxArray.get(C);this.addCollisionDebugVertices(T.x1,T.y1,T.x2,T.y2,b?this.textCollisionBox:this.iconCollisionBox,T.anchorPoint,g)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new pS(Fs,rk.members,yi),this.iconCollisionBox=new pS(Fs,rk.members,yi);for(let c=0;c<this.symbolInstances.length;c++){const h=this.symbolInstances.get(c);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(c,h,g,b,C,T,F,U,k){const G={};for(let q=h;q<g;q++){const Y=c.get(q);G.textBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,anchorPointX:Y.anchorPointX,anchorPointY:Y.anchorPointY},G.textFeatureIndex=Y.featureIndex;break}for(let q=b;q<C;q++){const Y=c.get(q);G.verticalTextBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,anchorPointX:Y.anchorPointX,anchorPointY:Y.anchorPointY},G.verticalTextFeatureIndex=Y.featureIndex;break}for(let q=T;q<F;q++){const Y=c.get(q);G.iconBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,anchorPointX:Y.anchorPointX,anchorPointY:Y.anchorPointY},G.iconFeatureIndex=Y.featureIndex;break}for(let q=U;q<k;q++){const Y=c.get(q);G.verticalIconBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,anchorPointX:Y.anchorPointX,anchorPointY:Y.anchorPointY},G.verticalIconFeatureIndex=Y.featureIndex;break}return G}deserializeCollisionBoxes(c){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const g=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,g.textBoxStartIndex,g.textBoxEndIndex,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g.iconBoxStartIndex,g.iconBoxEndIndex,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(c,h){const g=c.placedSymbolArray.get(h),b=g.vertexStartIndex+4*g.numGlyphs;for(let C=g.vertexStartIndex;C<b;C+=4)c.indexArray.emplaceBack(C,C+1,C+2),c.indexArray.emplaceBack(C+1,C+2,C+3)}getSortedSymbolIndexes(c){if(this.sortedAngle===c&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(c),g=Math.cos(c),b=[],C=[],T=[];for(let F=0;F<this.symbolInstances.length;++F){T.push(F);const U=this.symbolInstances.get(F);b.push(0|Math.round(h*U.anchorX+g*U.anchorY)),C.push(U.featureIndex)}return T.sort((F,U)=>b[F]-b[U]||C[U]-C[F]),T}addToSortKeyRanges(c,h){const g=this.sortKeyRanges[this.sortKeyRanges.length-1];g&&g.sortKey===h?g.symbolInstanceEnd=c+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:c,symbolInstanceEnd:c+1})}sortFeatures(c){if(this.sortFeaturesByY&&this.sortedAngle!==c&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(c),this.sortedAngle=c,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const g=this.symbolInstances.get(h);this.featureSortOrder.push(g.featureIndex),[g.rightJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.leftJustifiedTextSymbolIndex].forEach((b,C,T)=>{b>=0&&T.indexOf(b)===C&&this.addIndicesForPlacedSymbol(this.text,b)}),g.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,g.verticalPlacedTextSymbolIndex),g.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.placedIconSymbolIndex),g.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let vk,bk;Je("SymbolBucket",Np,{omit:["layers","collisionBoxArray","features","compareText"]}),Np.MAX_GLYPHS=65535,Np.addDynamicAttributes=dS;var gS={get paint(){return bk=bk||new m({"icon-opacity":new Er(st.paint_symbol["icon-opacity"]),"icon-color":new Er(st.paint_symbol["icon-color"]),"icon-halo-color":new Er(st.paint_symbol["icon-halo-color"]),"icon-halo-width":new Er(st.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Er(st.paint_symbol["icon-halo-blur"]),"icon-translate":new ar(st.paint_symbol["icon-translate"]),"icon-translate-anchor":new ar(st.paint_symbol["icon-translate-anchor"]),"text-opacity":new Er(st.paint_symbol["text-opacity"]),"text-color":new Er(st.paint_symbol["text-color"],{runtimeType:Mr,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new Er(st.paint_symbol["text-halo-color"]),"text-halo-width":new Er(st.paint_symbol["text-halo-width"]),"text-halo-blur":new Er(st.paint_symbol["text-halo-blur"]),"text-translate":new ar(st.paint_symbol["text-translate"]),"text-translate-anchor":new ar(st.paint_symbol["text-translate-anchor"])})},get layout(){return vk=vk||new m({"symbol-placement":new ar(st.layout_symbol["symbol-placement"]),"symbol-spacing":new ar(st.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ar(st.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Er(st.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ar(st.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ar(st.layout_symbol["icon-allow-overlap"]),"icon-overlap":new ar(st.layout_symbol["icon-overlap"]),"icon-ignore-placement":new ar(st.layout_symbol["icon-ignore-placement"]),"icon-optional":new ar(st.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ar(st.layout_symbol["icon-rotation-alignment"]),"icon-size":new Er(st.layout_symbol["icon-size"]),"icon-text-fit":new ar(st.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ar(st.layout_symbol["icon-text-fit-padding"]),"icon-image":new Er(st.layout_symbol["icon-image"]),"icon-rotate":new Er(st.layout_symbol["icon-rotate"]),"icon-padding":new Er(st.layout_symbol["icon-padding"]),"icon-keep-upright":new ar(st.layout_symbol["icon-keep-upright"]),"icon-offset":new Er(st.layout_symbol["icon-offset"]),"icon-anchor":new Er(st.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ar(st.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ar(st.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ar(st.layout_symbol["text-rotation-alignment"]),"text-field":new Er(st.layout_symbol["text-field"]),"text-font":new Er(st.layout_symbol["text-font"]),"text-size":new Er(st.layout_symbol["text-size"]),"text-max-width":new Er(st.layout_symbol["text-max-width"]),"text-line-height":new ar(st.layout_symbol["text-line-height"]),"text-letter-spacing":new Er(st.layout_symbol["text-letter-spacing"]),"text-justify":new Er(st.layout_symbol["text-justify"]),"text-radial-offset":new Er(st.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ar(st.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Er(st.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Er(st.layout_symbol["text-anchor"]),"text-max-angle":new ar(st.layout_symbol["text-max-angle"]),"text-writing-mode":new ar(st.layout_symbol["text-writing-mode"]),"text-rotate":new Er(st.layout_symbol["text-rotate"]),"text-padding":new ar(st.layout_symbol["text-padding"]),"text-keep-upright":new ar(st.layout_symbol["text-keep-upright"]),"text-transform":new Er(st.layout_symbol["text-transform"]),"text-offset":new Er(st.layout_symbol["text-offset"]),"text-allow-overlap":new ar(st.layout_symbol["text-allow-overlap"]),"text-overlap":new ar(st.layout_symbol["text-overlap"]),"text-ignore-placement":new ar(st.layout_symbol["text-ignore-placement"]),"text-optional":new ar(st.layout_symbol["text-optional"])})}};class wk{constructor(c){if(c.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=c.property.overrides?c.property.overrides.runtimeType:gn,this.defaultValue=c}evaluate(c){if(c.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(c.formattedSection))return h.getOverride(c.formattedSection)}return c.feature&&c.featureState?this.defaultValue.evaluate(c.feature,c.featureState):this.defaultValue.property.specification.default}eachChild(c){this.defaultValue.isConstant()||c(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Je("FormatSectionOverride",wk,{omit:["defaultValue"]});class dv extends A{constructor(c){super(c,gS)}recalculate(c,h){if(super.recalculate(c,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const g=this.layout.get("text-writing-mode");if(g){const b=[];for(const C of g)b.indexOf(C)<0&&b.push(C);this.layout._values["text-writing-mode"]=b}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(c,h,g,b){const C=this.layout.get(c).evaluate(h,{},g,b),T=this._unevaluatedLayout._values[c];return T.isDataDriven()||ra(T.value)||!C?C:function(F,U){return U.replace(/{([^{}]+)}/g,(k,G)=>F&&G in F?String(F[G]):"")}(h.properties,C)}createBucket(c){return new Np(c)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const c of gS.paint.overridableProperties){if(!dv.hasPaintOverride(this.layout,c))continue;const h=this.paint.get(c),g=new wk(h),b=new Pl(g,h.property.specification);let C=null;C=h.value.kind==="constant"||h.value.kind==="source"?new Hs("source",b):new So("composite",b,h.value.zoomStops),this.paint._values[c]=new sa(h.property,C,h.parameters)}}_handleOverridablePaintPropertyUpdate(c,h,g){return!(!this.layout||h.isDataDriven()||g.isDataDriven())&&dv.hasPaintOverride(this.layout,c)}static hasPaintOverride(c,h){const g=c.get("text-field"),b=gS.paint.properties[h];let C=!1;const T=F=>{for(const U of F)if(b.overrides&&b.overrides.hasOverride(U))return void(C=!0)};if(g.value.kind==="constant"&&g.value.value instanceof qr)T(g.value.value.sections);else if(g.value.kind==="source"){const F=k=>{C||(k instanceof Li&&kn(k.value)===sn?T(k.value.sections):k instanceof su?T(k.sections):k.eachChild(F))},U=g.value;U._styleExpression&&F(U._styleExpression.expression)}return C}}let xk;var r2t={get paint(){return xk=xk||new m({"background-color":new ar(st.paint_background["background-color"]),"background-pattern":new E(st.paint_background["background-pattern"]),"background-opacity":new ar(st.paint_background["background-opacity"])})}};class n2t extends A{constructor(c){super(c,r2t)}}let Bk;var i2t={get paint(){return Bk=Bk||new m({"raster-opacity":new ar(st.paint_raster["raster-opacity"]),"raster-hue-rotate":new ar(st.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ar(st.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ar(st.paint_raster["raster-brightness-max"]),"raster-saturation":new ar(st.paint_raster["raster-saturation"]),"raster-contrast":new ar(st.paint_raster["raster-contrast"]),"raster-resampling":new ar(st.paint_raster["raster-resampling"]),"raster-fade-duration":new ar(st.paint_raster["raster-fade-duration"])})}};class s2t extends A{constructor(c){super(c,i2t)}}class o2t extends A{constructor(c){super(c,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=c}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class a2t{constructor(c){this._methodToThrottle=c,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const mS=63710088e-1;class Th{constructor(c,h){if(isNaN(c)||isNaN(h))throw new Error(`Invalid LngLat object: (${c}, ${h})`);if(this.lng=+c,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Th(dt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(c){const h=Math.PI/180,g=this.lat*h,b=c.lat*h,C=Math.sin(g)*Math.sin(b)+Math.cos(g)*Math.cos(b)*Math.cos((c.lng-this.lng)*h);return mS*Math.acos(Math.min(C,1))}static convert(c){if(c instanceof Th)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new Th(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&typeof c=="object"&&c!==null)return new Th(Number("lng"in c?c.lng:c.lon),Number(c.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ck=2*Math.PI*mS;function Ek(u){return Ck*Math.cos(u*Math.PI/180)}function Sk(u){return(180+u)/360}function Tk(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function Ik(u,c){return u/Ek(c)}function yS(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}class h0{constructor(c,h){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;this.x=+c,this.y=+h,this.z=+g}static fromLngLat(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const g=Th.convert(c);return new h0(Sk(g.lng),Tk(g.lat),Ik(h,g.lat))}toLngLat(){return new Th(360*this.x-180,yS(this.y))}toAltitude(){return this.z*Ek(yS(this.y))}meterInMercatorCoordinateUnits(){return 1/Ck*(c=yS(this.y),1/Math.cos(c*Math.PI/180));var c}}function Fk(u,c,h){var g=2*Math.PI*6378137/256/Math.pow(2,h);return[u*g-2*Math.PI*6378137/2,c*g-2*Math.PI*6378137/2]}class _S{constructor(c,h,g){if(!function(b,C,T){return!(b<0||b>25||T<0||T>=Math.pow(2,b)||C<0||C>=Math.pow(2,b))}(c,h,g))throw new Error(`x=${h}, y=${g}, z=${c} outside of bounds. 0<=x<${Math.pow(2,c)}, 0<=y<${Math.pow(2,c)} 0<=z<=25 `);this.z=c,this.x=h,this.y=g,this.key=d0(0,c,c,h,g)}equals(c){return this.z===c.z&&this.x===c.x&&this.y===c.y}url(c,h,g){const b=(T=this.y,F=this.z,U=Fk(256*(C=this.x),256*(T=Math.pow(2,F)-T-1),F),k=Fk(256*(C+1),256*(T+1),F),U[0]+","+U[1]+","+k[0]+","+k[1]);var C,T,F,U,k;const G=function(q,Y,rt){let lt,yt="";for(let Tt=q;Tt>0;Tt--)lt=1<<Tt-1,yt+=(Y&lt?1:0)+(rt&lt?2:0);return yt}(this.z,this.x,this.y);return c[(this.x+this.y)%c.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(g==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,G).replace(/{bbox-epsg-3857}/g,b)}isChildOf(c){const h=this.z-c.z;return h>0&&c.x===this.x>>h&&c.y===this.y>>h}getTilePoint(c){const h=Math.pow(2,this.z);return new w((c.x*h-this.x)*ei,(c.y*h-this.y)*ei)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Lk{constructor(c,h){this.wrap=c,this.canonical=h,this.key=d0(c,h.z,h.z,h.x,h.y)}}class ll{constructor(c,h,g,b,C){if(c<g)throw new Error(`overscaledZ should be >= z; overscaledZ = ${c}; z = ${g}`);this.overscaledZ=c,this.wrap=h,this.canonical=new _S(g,+b,+C),this.key=d0(h,c,g,b,C)}clone(){return new ll(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(c){return this.overscaledZ===c.overscaledZ&&this.wrap===c.wrap&&this.canonical.equals(c.canonical)}scaledTo(c){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-c;return c>this.canonical.z?new ll(c,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ll(c,this.wrap,c,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(c,h){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);const g=this.canonical.z-c;return c>this.canonical.z?d0(this.wrap*+h,c,this.canonical.z,this.canonical.x,this.canonical.y):d0(this.wrap*+h,c,c,this.canonical.x>>g,this.canonical.y>>g)}isChildOf(c){if(c.wrap!==this.wrap)return!1;const h=this.canonical.z-c.canonical.z;return c.overscaledZ===0||c.overscaledZ<this.overscaledZ&&c.canonical.x===this.canonical.x>>h&&c.canonical.y===this.canonical.y>>h}children(c){if(this.overscaledZ>=c)return[new ll(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,g=2*this.canonical.x,b=2*this.canonical.y;return[new ll(h,this.wrap,h,g,b),new ll(h,this.wrap,h,g+1,b),new ll(h,this.wrap,h,g,b+1),new ll(h,this.wrap,h,g+1,b+1)]}isLessThan(c){return this.wrap<c.wrap||!(this.wrap>c.wrap)&&(this.overscaledZ<c.overscaledZ||!(this.overscaledZ>c.overscaledZ)&&(this.canonical.x<c.canonical.x||!(this.canonical.x>c.canonical.x)&&this.canonical.y<c.canonical.y))}wrapped(){return new ll(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(c){return new ll(this.overscaledZ,c,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Lk(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(c){return this.canonical.getTilePoint(new h0(c.x-this.wrap,c.y))}}function d0(u,c,h,g,b){(u*=2)<0&&(u=-1*u-1);const C=1<<h;return(C*C*u+C*b+g).toString(36)+h.toString(36)+c.toString(36)}Je("CanonicalTileID",_S),Je("OverscaledTileID",ll,{omit:["posMatrix"]});class Pk{constructor(c,h,g){let b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,C=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,T=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1,F=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0;if(this.uid=c,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(g&&!["mapbox","terrarium","custom"].includes(g))return void bt(`"${g}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;const U=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),g){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=b,this.greenFactor=C,this.blueFactor=T,this.baseShift=F;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let k=0;k<U;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(U,k)]=this.data[this._idx(U-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,U)]=this.data[this._idx(k,U-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(U,-1)]=this.data[this._idx(U-1,0)],this.data[this._idx(-1,U)]=this.data[this._idx(0,U-1)],this.data[this._idx(U,U)]=this.data[this._idx(U-1,U-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let k=0;k<U;k++)for(let G=0;G<U;G++){const q=this.get(k,G);q>this.max&&(this.max=q),q<this.min&&(this.min=q)}}get(c,h){const g=new Uint8Array(this.data.buffer),b=4*this._idx(c,h);return this.unpack(g[b],g[b+1],g[b+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(c,h){if(c<-1||c>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(c+1)}unpack(c,h,g){return c*this.redFactor+h*this.greenFactor+g*this.blueFactor-this.baseShift}getPixels(){return new al({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(c,h,g){if(this.dim!==c.dim)throw new Error("dem dimension mismatch");let b=h*this.dim,C=h*this.dim+this.dim,T=g*this.dim,F=g*this.dim+this.dim;switch(h){case-1:b=C-1;break;case 1:C=b+1}switch(g){case-1:T=F-1;break;case 1:F=T+1}const U=-h*this.dim,k=-g*this.dim;for(let G=T;G<F;G++)for(let q=b;q<C;q++)this.data[this._idx(q,G)]=c.data[this._idx(q+U,G+k)]}}Je("DEMData",Pk);class Mk{constructor(c){this._stringToNumber={},this._numberToString=[];for(let h=0;h<c.length;h++){const g=c[h];this._stringToNumber[g]=h,this._numberToString[h]=g}}encode(c){return this._stringToNumber[c]}decode(c){if(c>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${c} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[c]}}class Rk{constructor(c,h,g,b,C){this.type="Feature",this._vectorTileFeature=c,c._z=h,c._x=g,c._y=b,this.properties=c.properties,this.id=C}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(c){this._geometry=c}toJSON(){const c={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(c[h]=this[h]);return c}}class Uk{constructor(c,h){this.tileID=c,this.x=c.canonical.x,this.y=c.canonical.y,this.z=c.canonical.z,this.grid=new _u(ei,16,0),this.grid3D=new _u(ei,16,0),this.featureIndexArray=new Cn,this.promoteId=h}insert(c,h,g,b,C,T){const F=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(g,b,C);const U=T?this.grid3D:this.grid;for(let k=0;k<h.length;k++){const G=h[k],q=[1/0,1/0,-1/0,-1/0];for(let Y=0;Y<G.length;Y++){const rt=G[Y];q[0]=Math.min(q[0],rt.x),q[1]=Math.min(q[1],rt.y),q[2]=Math.max(q[2],rt.x),q[3]=Math.max(q[3],rt.y)}q[0]<ei&&q[1]<ei&&q[2]>=0&&q[3]>=0&&U.insert(F,q[0],q[1],q[2],q[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ch.VectorTile(new aS(this.rawTileData)).layers,this.sourceLayerCoder=new Mk(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(c,h,g,b){this.loadVTLayers();const C=c.params||{},T=ei/c.tileSize/c.scale,F=na(C.filter),U=c.queryGeometry,k=c.queryPadding*T,G=Dk(U),q=this.grid.query(G.minX-k,G.minY-k,G.maxX+k,G.maxY+k),Y=Dk(c.cameraQueryGeometry),rt=this.grid3D.query(Y.minX-k,Y.minY-k,Y.maxX+k,Y.maxY+k,(Tt,Ot,ne,zt)=>function(Kt,ce,Te,$e,Sr){for(const Ge of Kt)if(ce<=Ge.x&&Te<=Ge.y&&$e>=Ge.x&&Sr>=Ge.y)return!0;const qe=[new w(ce,Te),new w(ce,Sr),new w($e,Sr),new w($e,Te)];if(Kt.length>2){for(const Ge of qe)if(Tu(Kt,Ge))return!0}for(let Ge=0;Ge<Kt.length-1;Ge++)if(Zm(Kt[Ge],Kt[Ge+1],qe))return!0;return!1}(c.cameraQueryGeometry,Tt-k,Ot-k,ne+k,zt+k));for(const Tt of rt)q.push(Tt);q.sort(l2t);const lt={};let yt;for(let Tt=0;Tt<q.length;Tt++){const Ot=q[Tt];if(Ot===yt)continue;yt=Ot;const ne=this.featureIndexArray.get(Ot);let zt=null;this.loadMatchingFeature(lt,ne.bucketIndex,ne.sourceLayerIndex,ne.featureIndex,F,C.layers,C.availableImages,h,g,b,(Kt,ce,Te)=>(zt||(zt=EA(Kt)),ce.queryIntersectsFeature(U,Kt,Te,zt,this.z,c.transform,T,c.pixelPosMatrix)))}return lt}loadMatchingFeature(c,h,g,b,C,T,F,U,k,G,q){const Y=this.bucketLayerIDs[h];if(T&&!function(Tt,Ot){for(let ne=0;ne<Tt.length;ne++)if(Ot.indexOf(Tt[ne])>=0)return!0;return!1}(T,Y))return;const rt=this.sourceLayerCoder.decode(g),lt=this.vtLayers[rt].feature(b);if(C.needGeometry){const Tt=Eu(lt,!0);if(!C.filter(new zn(this.tileID.overscaledZ),Tt,this.tileID.canonical))return}else if(!C.filter(new zn(this.tileID.overscaledZ),lt))return;const yt=this.getId(lt,rt);for(let Tt=0;Tt<Y.length;Tt++){const Ot=Y[Tt];if(T&&T.indexOf(Ot)<0)continue;const ne=U[Ot];if(!ne)continue;let zt={};yt&&G&&(zt=G.getState(ne.sourceLayer||"_geojsonTileLayer",yt));const Kt=gt({},k[Ot]);Kt.paint=Ok(Kt.paint,ne.paint,lt,zt,F),Kt.layout=Ok(Kt.layout,ne.layout,lt,zt,F);const ce=!q||q(lt,ne,zt);if(!ce)continue;const Te=new Rk(lt,this.z,this.x,this.y,yt);Te.layer=Kt;let $e=c[Ot];$e===void 0&&($e=c[Ot]=[]),$e.push({featureIndex:b,feature:Te,intersectionZ:ce})}}lookupSymbolFeatures(c,h,g,b,C,T,F,U){const k={};this.loadVTLayers();const G=na(C);for(const q of c)this.loadMatchingFeature(k,g,b,q,G,T,F,U,h);return k}hasLayer(c){for(const h of this.bucketLayerIDs)for(const g of h)if(c===g)return!0;return!1}getId(c,h){let g=c.id;return this.promoteId&&(g=c.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof g=="boolean"&&(g=Number(g))),g}}function Ok(u,c,h,g,b){return It(u,(C,T)=>{const F=c instanceof Ol?c.get(T):null;return F&&F.evaluate?F.evaluate(h,g,b):F})}function Dk(u){let c=1/0,h=1/0,g=-1/0,b=-1/0;for(const C of u)c=Math.min(c,C.x),h=Math.min(h,C.y),g=Math.max(g,C.x),b=Math.max(b,C.y);return{minX:c,minY:h,maxX:g,maxY:b}}function l2t(u,c){return c-u}function Nk(u,c,h,g,b){const C=[];for(let T=0;T<u.length;T++){const F=u[T];let U;for(let k=0;k<F.length-1;k++){let G=F[k],q=F[k+1];G.x<c&&q.x<c||(G.x<c?G=new w(c,G.y+(c-G.x)/(q.x-G.x)*(q.y-G.y))._round():q.x<c&&(q=new w(c,G.y+(c-G.x)/(q.x-G.x)*(q.y-G.y))._round()),G.y<h&&q.y<h||(G.y<h?G=new w(G.x+(h-G.y)/(q.y-G.y)*(q.x-G.x),h)._round():q.y<h&&(q=new w(G.x+(h-G.y)/(q.y-G.y)*(q.x-G.x),h)._round()),G.x>=g&&q.x>=g||(G.x>=g?G=new w(g,G.y+(g-G.x)/(q.x-G.x)*(q.y-G.y))._round():q.x>=g&&(q=new w(g,G.y+(g-G.x)/(q.x-G.x)*(q.y-G.y))._round()),G.y>=b&&q.y>=b||(G.y>=b?G=new w(G.x+(b-G.y)/(q.y-G.y)*(q.x-G.x),b)._round():q.y>=b&&(q=new w(G.x+(b-G.y)/(q.y-G.y)*(q.x-G.x),b)._round()),U&&G.equals(U[U.length-1])||(U=[G],C.push(U)),U.push(q)))))}}return C}Je("FeatureIndex",Uk,{omit:["rawTileData","sourceLayerCoder"]});class Ih extends w{constructor(c,h,g,b){super(c,h),this.angle=g,b!==void 0&&(this.segment=b)}clone(){return new Ih(this.x,this.y,this.angle,this.segment)}}function kk(u,c,h,g,b){if(c.segment===void 0||h===0)return!0;let C=c,T=c.segment+1,F=0;for(;F>-h/2;){if(T--,T<0)return!1;F-=u[T].dist(C),C=u[T]}F+=u[T].dist(u[T+1]),T++;const U=[];let k=0;for(;F<h/2;){const G=u[T],q=u[T+1];if(!q)return!1;let Y=u[T-1].angleTo(G)-G.angleTo(q);for(Y=Math.abs((Y+3*Math.PI)%(2*Math.PI)-Math.PI),U.push({distance:F,angleDelta:Y}),k+=Y;F-U[0].distance>g;)k-=U.shift().angleDelta;if(k>b)return!1;T++,F+=G.dist(q)}return!0}function Qk(u){let c=0;for(let h=0;h<u.length-1;h++)c+=u[h].dist(u[h+1]);return c}function zk(u,c,h){return u?.6*c*h:0}function Hk(u,c){return Math.max(u?u.right-u.left:0,c?c.right-c.left:0)}function c2t(u,c,h,g,b,C){const T=zk(h,b,C),F=Hk(h,g)*C;let U=0;const k=Qk(u)/2;for(let G=0;G<u.length-1;G++){const q=u[G],Y=u[G+1],rt=q.dist(Y);if(U+rt>k){const lt=(k-U)/rt,yt=Zi.number(q.x,Y.x,lt),Tt=Zi.number(q.y,Y.y,lt),Ot=new Ih(yt,Tt,Y.angleTo(q),G);return Ot._round(),!T||kk(u,Ot,F,T,c)?Ot:void 0}U+=rt}}function u2t(u,c,h,g,b,C,T,F,U){const k=zk(g,C,T),G=Hk(g,b),q=G*T,Y=u[0].x===0||u[0].x===U||u[0].y===0||u[0].y===U;return c-q<c/4&&(c=q+c/4),Vk(u,Y?c/2*F%c:(G/2+2*C)*T*F%c,c,k,h,q,Y,!1,U)}function Vk(u,c,h,g,b,C,T,F,U){const k=C/2,G=Qk(u);let q=0,Y=c-h,rt=[];for(let lt=0;lt<u.length-1;lt++){const yt=u[lt],Tt=u[lt+1],Ot=yt.dist(Tt),ne=Tt.angleTo(yt);for(;Y+h<q+Ot;){Y+=h;const zt=(Y-q)/Ot,Kt=Zi.number(yt.x,Tt.x,zt),ce=Zi.number(yt.y,Tt.y,zt);if(Kt>=0&&Kt<U&&ce>=0&&ce<U&&Y-k>=0&&Y+k<=G){const Te=new Ih(Kt,ce,ne,lt);Te._round(),g&&!kk(u,Te,C,g,b)||rt.push(Te)}}q+=Ot}return F||rt.length||T||(rt=Vk(u,q/2,h,g,b,C,T,!0,U)),rt}Je("Anchor",Ih);const kp=aa;function Gk(u,c,h,g){const b=[],C=u.image,T=C.pixelRatio,F=C.paddedRect.w-2*kp,U=C.paddedRect.h-2*kp;let k={x1:u.left,y1:u.top,x2:u.right,y2:u.bottom};const G=C.stretchX||[[0,F]],q=C.stretchY||[[0,U]],Y=(me,mr)=>me+mr[1]-mr[0],rt=G.reduce(Y,0),lt=q.reduce(Y,0),yt=F-rt,Tt=U-lt;let Ot=0,ne=rt,zt=0,Kt=lt,ce=0,Te=yt,$e=0,Sr=Tt;if(C.content&&g){const me=C.content,mr=me[2]-me[0],Ar=me[3]-me[1];(C.textFitWidth||C.textFitHeight)&&(k=mk(u)),Ot=fv(G,0,me[0]),zt=fv(q,0,me[1]),ne=fv(G,me[0],me[2]),Kt=fv(q,me[1],me[3]),ce=me[0]-Ot,$e=me[1]-zt,Te=mr-ne,Sr=Ar-Kt}const qe=k.x1,Ge=k.y1,fr=k.x2-qe,nr=k.y2-Ge,Ze=(me,mr,Ar,Nr)=>{const $n=pv(me.stretch-Ot,ne,fr,qe),Vn=gv(me.fixed-ce,Te,me.stretch,rt),ps=pv(mr.stretch-zt,Kt,nr,Ge),Hl=gv(mr.fixed-$e,Sr,mr.stretch,lt),js=pv(Ar.stretch-Ot,ne,fr,qe),gs=gv(Ar.fixed-ce,Te,Ar.stretch,rt),Uo=pv(Nr.stretch-zt,Kt,nr,Ge),Oo=gv(Nr.fixed-$e,Sr,Nr.stretch,lt),Do=new w($n,ps),Ii=new w(js,ps),ms=new w(js,Uo),co=new w($n,Uo),qs=new w(Vn/T,Hl/T),No=new w(gs/T,Oo/T),Ks=c*Math.PI/180;if(Ks){const En=Math.sin(Ks),ri=Math.cos(Ks),li=[ri,-En,En,ri];Do._matMult(li),Ii._matMult(li),co._matMult(li),ms._matMult(li)}const cl=me.stretch+me.fixed,la=mr.stretch+mr.fixed;return{tl:Do,tr:Ii,bl:co,br:ms,tex:{x:C.paddedRect.x+kp+cl,y:C.paddedRect.y+kp+la,w:Ar.stretch+Ar.fixed-cl,h:Nr.stretch+Nr.fixed-la},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:qs,pixelOffsetBR:No,minFontScaleX:Te/T/fr,minFontScaleY:Sr/T/nr,isSDF:h}};if(g&&(C.stretchX||C.stretchY)){const me=jk(G,yt,rt),mr=jk(q,Tt,lt);for(let Ar=0;Ar<me.length-1;Ar++){const Nr=me[Ar],$n=me[Ar+1];for(let Vn=0;Vn<mr.length-1;Vn++)b.push(Ze(Nr,mr[Vn],$n,mr[Vn+1]))}}else b.push(Ze({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:F+1},{fixed:0,stretch:U+1}));return b}function fv(u,c,h){let g=0;for(const b of u)g+=Math.max(c,Math.min(h,b[1]))-Math.max(c,Math.min(h,b[0]));return g}function jk(u,c,h){const g=[{fixed:-kp,stretch:0}];for(const[b,C]of u){const T=g[g.length-1];g.push({fixed:b-T.stretch,stretch:T.stretch}),g.push({fixed:b-T.stretch,stretch:T.stretch+(C-b)})}return g.push({fixed:c+kp,stretch:h}),g}function pv(u,c,h,g){return u/c*h+g}function gv(u,c,h,g){return u-c*h/g}class mv{constructor(c,h,g,b,C,T,F,U,k,G){var q;if(this.boxStartIndex=c.length,k){let Y=T.top,rt=T.bottom;const lt=T.collisionPadding;lt&&(Y-=lt[1],rt+=lt[3]);let yt=rt-Y;yt>0&&(yt=Math.max(10,yt),this.circleDiameter=yt)}else{const Y=!((q=T.image)===null||q===void 0)&&q.content&&(T.image.textFitWidth||T.image.textFitHeight)?mk(T):{x1:T.left,y1:T.top,x2:T.right,y2:T.bottom};Y.y1=Y.y1*F-U[0],Y.y2=Y.y2*F+U[2],Y.x1=Y.x1*F-U[3],Y.x2=Y.x2*F+U[1];const rt=T.collisionPadding;if(rt&&(Y.x1-=rt[0]*F,Y.y1-=rt[1]*F,Y.x2+=rt[2]*F,Y.y2+=rt[3]*F),G){const lt=new w(Y.x1,Y.y1),yt=new w(Y.x2,Y.y1),Tt=new w(Y.x1,Y.y2),Ot=new w(Y.x2,Y.y2),ne=G*Math.PI/180;lt._rotate(ne),yt._rotate(ne),Tt._rotate(ne),Ot._rotate(ne),Y.x1=Math.min(lt.x,yt.x,Tt.x,Ot.x),Y.x2=Math.max(lt.x,yt.x,Tt.x,Ot.x),Y.y1=Math.min(lt.y,yt.y,Tt.y,Ot.y),Y.y2=Math.max(lt.y,yt.y,Tt.y,Ot.y)}c.emplaceBack(h.x,h.y,Y.x1,Y.y1,Y.x2,Y.y2,g,b,C)}this.boxEndIndex=c.length}}class A2t{constructor(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(g,b)=>g<b?-1:g>b?1:0;if(this.data=c,this.length=this.data.length,this.compare=h,this.length>0)for(let g=(this.length>>1)-1;g>=0;g--)this._down(g)}push(c){this.data.push(c),this._up(this.length++)}pop(){if(this.length===0)return;const c=this.data[0],h=this.data.pop();return--this.length>0&&(this.data[0]=h,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:h,compare:g}=this,b=h[c];for(;c>0;){const C=c-1>>1,T=h[C];if(g(b,T)>=0)break;h[c]=T,c=C}h[c]=b}_down(c){const{data:h,compare:g}=this,b=this.length>>1,C=h[c];for(;c<b;){let T=1+(c<<1);const F=T+1;if(F<this.length&&g(h[F],h[T])<0&&(T=F),g(h[T],C)>=0)break;h[c]=h[T],c=T}h[c]=C}}function h2t(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,g=1/0,b=1/0,C=-1/0,T=-1/0;const F=u[0];for(let rt=0;rt<F.length;rt++){const lt=F[rt];(!rt||lt.x<g)&&(g=lt.x),(!rt||lt.y<b)&&(b=lt.y),(!rt||lt.x>C)&&(C=lt.x),(!rt||lt.y>T)&&(T=lt.y)}const U=Math.min(C-g,T-b);let k=U/2;const G=new A2t([],d2t);if(U===0)return new w(g,b);for(let rt=g;rt<C;rt+=U)for(let lt=b;lt<T;lt+=U)G.push(new Qp(rt+k,lt+k,k,u));let q=function(rt){let lt=0,yt=0,Tt=0;const Ot=rt[0];for(let ne=0,zt=Ot.length,Kt=zt-1;ne<zt;Kt=ne++){const ce=Ot[ne],Te=Ot[Kt],$e=ce.x*Te.y-Te.x*ce.y;yt+=(ce.x+Te.x)*$e,Tt+=(ce.y+Te.y)*$e,lt+=3*$e}return new Qp(yt/lt,Tt/lt,0,rt)}(u),Y=G.length;for(;G.length;){const rt=G.pop();(rt.d>q.d||!q.d)&&(q=rt,h&&console.log("found best %d after %d probes",Math.round(1e4*rt.d)/1e4,Y)),rt.max-q.d<=c||(k=rt.h/2,G.push(new Qp(rt.p.x-k,rt.p.y-k,k,u)),G.push(new Qp(rt.p.x+k,rt.p.y-k,k,u)),G.push(new Qp(rt.p.x-k,rt.p.y+k,k,u)),G.push(new Qp(rt.p.x+k,rt.p.y+k,k,u)),Y+=4)}return h&&(console.log(`num probes: ${Y}`),console.log(`best distance: ${q.d}`)),q.p}function d2t(u,c){return c.max-u.max}function Qp(u,c,h,g){this.p=new w(u,c),this.h=h,this.d=function(b,C){let T=!1,F=1/0;for(let U=0;U<C.length;U++){const k=C[U];for(let G=0,q=k.length,Y=q-1;G<q;Y=G++){const rt=k[G],lt=k[Y];rt.y>b.y!=lt.y>b.y&&b.x<(lt.x-rt.x)*(b.y-rt.y)/(lt.y-rt.y)+rt.x&&(T=!T),F=Math.min(F,Ym(b,rt,lt))}}return(T?1:-1)*Math.sqrt(F)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}var Gs;a.aq=void 0,(Gs=a.aq||(a.aq={}))[Gs.center=1]="center",Gs[Gs.left=2]="left",Gs[Gs.right=3]="right",Gs[Gs.top=4]="top",Gs[Gs.bottom=5]="bottom",Gs[Gs["top-left"]=6]="top-left",Gs[Gs["top-right"]=7]="top-right",Gs[Gs["bottom-left"]=8]="bottom-left",Gs[Gs["bottom-right"]=9]="bottom-right";const Fh=7,vS=Number.POSITIVE_INFINITY;function qk(u,c){return c[1]!==vS?function(h,g,b){let C=0,T=0;switch(g=Math.abs(g),b=Math.abs(b),h){case"top-right":case"top-left":case"top":T=b-Fh;break;case"bottom-right":case"bottom-left":case"bottom":T=-b+Fh}switch(h){case"top-right":case"bottom-right":case"right":C=-g;break;case"top-left":case"bottom-left":case"left":C=g}return[C,T]}(u,c[0],c[1]):function(h,g){let b=0,C=0;g<0&&(g=0);const T=g/Math.SQRT2;switch(h){case"top-right":case"top-left":C=T-Fh;break;case"bottom-right":case"bottom-left":C=-T+Fh;break;case"bottom":C=-g+Fh;break;case"top":C=g-Fh}switch(h){case"top-right":case"bottom-right":b=-T;break;case"top-left":case"bottom-left":b=T;break;case"left":b=g;break;case"right":b=-g}return[b,C]}(u,c[0])}function Kk(u,c,h){var g;const b=u.layout,C=(g=b.get("text-variable-anchor-offset"))===null||g===void 0?void 0:g.evaluate(c,{},h);if(C){const F=C.values,U=[];for(let k=0;k<F.length;k+=2){const G=U[k]=F[k],q=F[k+1].map(Y=>Y*rs);G.startsWith("top")?q[1]-=Fh:G.startsWith("bottom")&&(q[1]+=Fh),U[k+1]=q}return new bn(U)}const T=b.get("text-variable-anchor");if(T){let F;F=u._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[b.get("text-radial-offset").evaluate(c,{},h)*rs,vS]:b.get("text-offset").evaluate(c,{},h).map(k=>k*rs);const U=[];for(const k of T)U.push(k,qk(k,F));return new bn(U)}return null}function bS(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function f2t(u,c,h,g,b,C,T,F,U,k,G){let q=C.textMaxSize.evaluate(c,{});q===void 0&&(q=T);const Y=u.layers[0].layout,rt=Y.get("icon-offset").evaluate(c,{},G),lt=Wk(h.horizontal),yt=T/24,Tt=u.tilePixelRatio*yt,Ot=u.tilePixelRatio*q/24,ne=u.tilePixelRatio*F,zt=u.tilePixelRatio*Y.get("symbol-spacing"),Kt=Y.get("text-padding")*u.tilePixelRatio,ce=function(me,mr,Ar){let Nr=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const $n=me.get("icon-padding").evaluate(mr,{},Ar),Vn=$n&&$n.values;return[Vn[0]*Nr,Vn[1]*Nr,Vn[2]*Nr,Vn[3]*Nr]}(Y,c,G,u.tilePixelRatio),Te=Y.get("text-max-angle")/180*Math.PI,$e=Y.get("text-rotation-alignment")!=="viewport"&&Y.get("symbol-placement")!=="point",Sr=Y.get("icon-rotation-alignment")==="map"&&Y.get("symbol-placement")!=="point",qe=Y.get("symbol-placement"),Ge=zt/2,fr=Y.get("icon-text-fit");let nr;g&&fr!=="none"&&(u.allowVerticalPlacement&&h.vertical&&(nr=yk(g,h.vertical,fr,Y.get("icon-text-fit-padding"),rt,yt)),lt&&(g=yk(g,lt,fr,Y.get("icon-text-fit-padding"),rt,yt)));const Ze=(me,mr)=>{mr.x<0||mr.x>=ei||mr.y<0||mr.y>=ei||function(Ar,Nr,$n,Vn,ps,Hl,js,gs,Uo,Oo,Do,Ii,ms,co,qs,No,Ks,cl,la,En,ri,li,Pa,Ci,zp){const Fu=Ar.addToLineVertexArray(Nr,$n);let Lu,Vl,ul,Ls,IA=0,g0=0,Zk=0,t8=0,IS=-1,FS=-1;const FA={};let e8=xh("");if(Ar.allowVerticalPlacement&&Vn.vertical){const uo=gs.layout.get("text-rotate").evaluate(ri,{},Ci)+90;ul=new mv(Uo,Nr,Oo,Do,Ii,Vn.vertical,ms,co,qs,uo),js&&(Ls=new mv(Uo,Nr,Oo,Do,Ii,js,Ks,cl,qs,uo))}if(ps){const uo=gs.layout.get("icon-rotate").evaluate(ri,{}),Al=gs.layout.get("icon-text-fit")!=="none",jd=Gk(ps,uo,Pa,Al),Mc=js?Gk(js,uo,Pa,Al):void 0;Vl=new mv(Uo,Nr,Oo,Do,Ii,ps,Ks,cl,!1,uo),IA=4*jd.length;const qd=Ar.iconSizeData;let Pu=null;qd.kind==="source"?(Pu=[Iu*gs.layout.get("icon-size").evaluate(ri,{})],Pu[0]>Sh&&bt(`${Ar.layerIds[0]}: Value for "icon-size" is >= ${A0}. Reduce your "icon-size".`)):qd.kind==="composite"&&(Pu=[Iu*li.compositeIconSizes[0].evaluate(ri,{},Ci),Iu*li.compositeIconSizes[1].evaluate(ri,{},Ci)],(Pu[0]>Sh||Pu[1]>Sh)&&bt(`${Ar.layerIds[0]}: Value for "icon-size" is >= ${A0}. Reduce your "icon-size".`)),Ar.addSymbols(Ar.icon,jd,Pu,En,la,ri,a.ah.none,Nr,Fu.lineStartIndex,Fu.lineLength,-1,Ci),IS=Ar.icon.placedSymbolArray.length-1,Mc&&(g0=4*Mc.length,Ar.addSymbols(Ar.icon,Mc,Pu,En,la,ri,a.ah.vertical,Nr,Fu.lineStartIndex,Fu.lineLength,-1,Ci),FS=Ar.icon.placedSymbolArray.length-1)}const r8=Object.keys(Vn.horizontal);for(const uo of r8){const Al=Vn.horizontal[uo];if(!Lu){e8=xh(Al.text);const Mc=gs.layout.get("text-rotate").evaluate(ri,{},Ci);Lu=new mv(Uo,Nr,Oo,Do,Ii,Al,ms,co,qs,Mc)}const jd=Al.positionedLines.length===1;if(Zk+=$k(Ar,Nr,Al,Hl,gs,qs,ri,No,Fu,Vn.vertical?a.ah.horizontal:a.ah.horizontalOnly,jd?r8:[uo],FA,IS,li,Ci),jd)break}Vn.vertical&&(t8+=$k(Ar,Nr,Vn.vertical,Hl,gs,qs,ri,No,Fu,a.ah.vertical,["vertical"],FA,FS,li,Ci));const m2t=Lu?Lu.boxStartIndex:Ar.collisionBoxArray.length,y2t=Lu?Lu.boxEndIndex:Ar.collisionBoxArray.length,_2t=ul?ul.boxStartIndex:Ar.collisionBoxArray.length,v2t=ul?ul.boxEndIndex:Ar.collisionBoxArray.length,b2t=Vl?Vl.boxStartIndex:Ar.collisionBoxArray.length,w2t=Vl?Vl.boxEndIndex:Ar.collisionBoxArray.length,x2t=Ls?Ls.boxStartIndex:Ar.collisionBoxArray.length,B2t=Ls?Ls.boxEndIndex:Ar.collisionBoxArray.length;let Pc=-1;const _v=(uo,Al)=>uo&&uo.circleDiameter?Math.max(uo.circleDiameter,Al):Al;Pc=_v(Lu,Pc),Pc=_v(ul,Pc),Pc=_v(Vl,Pc),Pc=_v(Ls,Pc);const n8=Pc>-1?1:0;n8&&(Pc*=zp/rs),Ar.glyphOffsetArray.length>=Np.MAX_GLYPHS&&bt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ri.sortKey!==void 0&&Ar.addToSortKeyRanges(Ar.symbolInstances.length,ri.sortKey);const C2t=Kk(gs,ri,Ci),[E2t,S2t]=function(uo,Al){const jd=uo.length,Mc=Al==null?void 0:Al.values;if((Mc==null?void 0:Mc.length)>0)for(let qd=0;qd<Mc.length;qd+=2){const Pu=Mc[qd+1];uo.emplaceBack(a.aq[Mc[qd]],Pu[0],Pu[1])}return[jd,uo.length]}(Ar.textAnchorOffsets,C2t);Ar.symbolInstances.emplaceBack(Nr.x,Nr.y,FA.right>=0?FA.right:-1,FA.center>=0?FA.center:-1,FA.left>=0?FA.left:-1,FA.vertical||-1,IS,FS,e8,m2t,y2t,_2t,v2t,b2t,w2t,x2t,B2t,Oo,Zk,t8,IA,g0,n8,0,ms,Pc,E2t,S2t)}(u,mr,me,h,g,b,nr,u.layers[0],u.collisionBoxArray,c.index,c.sourceLayerIndex,u.index,Tt,[Kt,Kt,Kt,Kt],$e,U,ne,ce,Sr,rt,c,C,k,G,T)};if(qe==="line")for(const me of Nk(c.geometry,0,0,ei,ei)){const mr=u2t(me,zt,Te,h.vertical||lt,g,24,Ot,u.overscaling,ei);for(const Ar of mr)lt&&p2t(u,lt.text,Ge,Ar)||Ze(me,Ar)}else if(qe==="line-center"){for(const me of c.geometry)if(me.length>1){const mr=c2t(me,Te,h.vertical||lt,g,24,Ot);mr&&Ze(me,mr)}}else if(c.type==="Polygon")for(const me of ba(c.geometry,0)){const mr=h2t(me,16);Ze(me[0],new Ih(mr.x,mr.y,0))}else if(c.type==="LineString")for(const me of c.geometry)Ze(me,new Ih(me[0].x,me[0].y,0));else if(c.type==="Point")for(const me of c.geometry)for(const mr of me)Ze([mr],new Ih(mr.x,mr.y,0))}function $k(u,c,h,g,b,C,T,F,U,k,G,q,Y,rt,lt){const yt=function(ne,zt,Kt,ce,Te,$e,Sr,qe){const Ge=ce.layout.get("text-rotate").evaluate($e,{})*Math.PI/180,fr=[];for(const nr of zt.positionedLines)for(const Ze of nr.positionedGlyphs){if(!Ze.rect)continue;const me=Ze.rect||{};let mr=uk+1,Ar=!0,Nr=1,$n=0;const Vn=(Te||qe)&&Ze.vertical,ps=Ze.metrics.advance*Ze.scale/2;if(qe&&zt.verticalizable&&($n=nr.lineOffset/2-(Ze.imageName?-(rs-Ze.metrics.width*Ze.scale)/2:(Ze.scale-1)*rs)),Ze.imageName){const En=Sr[Ze.imageName];Ar=En.sdf,Nr=En.pixelRatio,mr=aa/Nr}const Hl=Te?[Ze.x+ps,Ze.y]:[0,0];let js=Te?[0,0]:[Ze.x+ps+Kt[0],Ze.y+Kt[1]-$n],gs=[0,0];Vn&&(gs=js,js=[0,0]);const Uo=Ze.metrics.isDoubleResolution?2:1,Oo=(Ze.metrics.left-mr)*Ze.scale-ps+js[0],Do=(-Ze.metrics.top-mr)*Ze.scale+js[1],Ii=Oo+me.w/Uo*Ze.scale/Nr,ms=Do+me.h/Uo*Ze.scale/Nr,co=new w(Oo,Do),qs=new w(Ii,Do),No=new w(Oo,ms),Ks=new w(Ii,ms);if(Vn){const En=new w(-ps,ps-c0),ri=-Math.PI/2,li=rs/2-ps,Pa=new w(5-c0-li,-(Ze.imageName?li:0)),Ci=new w(...gs);co._rotateAround(ri,En)._add(Pa)._add(Ci),qs._rotateAround(ri,En)._add(Pa)._add(Ci),No._rotateAround(ri,En)._add(Pa)._add(Ci),Ks._rotateAround(ri,En)._add(Pa)._add(Ci)}if(Ge){const En=Math.sin(Ge),ri=Math.cos(Ge),li=[ri,-En,En,ri];co._matMult(li),qs._matMult(li),No._matMult(li),Ks._matMult(li)}const cl=new w(0,0),la=new w(0,0);fr.push({tl:co,tr:qs,bl:No,br:Ks,tex:me,writingMode:zt.writingMode,glyphOffset:Hl,sectionIndex:Ze.sectionIndex,isSDF:Ar,pixelOffsetTL:cl,pixelOffsetBR:la,minFontScaleX:0,minFontScaleY:0})}return fr}(0,h,F,b,C,T,g,u.allowVerticalPlacement),Tt=u.textSizeData;let Ot=null;Tt.kind==="source"?(Ot=[Iu*b.layout.get("text-size").evaluate(T,{})],Ot[0]>Sh&&bt(`${u.layerIds[0]}: Value for "text-size" is >= ${A0}. Reduce your "text-size".`)):Tt.kind==="composite"&&(Ot=[Iu*rt.compositeTextSizes[0].evaluate(T,{},lt),Iu*rt.compositeTextSizes[1].evaluate(T,{},lt)],(Ot[0]>Sh||Ot[1]>Sh)&&bt(`${u.layerIds[0]}: Value for "text-size" is >= ${A0}. Reduce your "text-size".`)),u.addSymbols(u.text,yt,Ot,F,C,T,k,c,U.lineStartIndex,U.lineLength,Y,lt);for(const ne of G)q[ne]=u.text.placedSymbolArray.length-1;return 4*yt.length}function Wk(u){for(const c in u)return u[c];return null}function p2t(u,c,h,g){const b=u.compareText;if(c in b){const C=b[c];for(let T=C.length-1;T>=0;T--)if(g.dist(C[T])<h)return!0}else b[c]=[];return b[c].push(g),!1}const Xk=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class wS{static from(c){if(!(c instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,g]=new Uint8Array(c,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const b=g>>4;if(b!==1)throw new Error(`Got v${b} data when expected v1.`);const C=Xk[15&g];if(!C)throw new Error("Unrecognized array type.");const[T]=new Uint16Array(c,2,1),[F]=new Uint32Array(c,4,1);return new wS(F,T,C,c)}constructor(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,b=arguments.length>3?arguments[3]:void 0;if(isNaN(c)||c<0)throw new Error(`Unpexpected numItems value: ${c}.`);this.numItems=+c,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=g,this.IndexArrayType=c<65536?Uint16Array:Uint32Array;const C=Xk.indexOf(this.ArrayType),T=2*c*this.ArrayType.BYTES_PER_ELEMENT,F=c*this.IndexArrayType.BYTES_PER_ELEMENT,U=(8-F%8)%8;if(C<0)throw new Error(`Unexpected typed array class: ${g}.`);b&&b instanceof ArrayBuffer?(this.data=b,this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+F+U,2*c),this._pos=2*c,this._finished=!0):(this.data=new ArrayBuffer(8+T+F+U),this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+F+U,2*c),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+C]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=c)}add(c,h){const g=this._pos>>1;return this.ids[g]=g,this.coords[this._pos++]=c,this.coords[this._pos++]=h,g}finish(){const c=this._pos>>1;if(c!==this.numItems)throw new Error(`Added ${c} items when expected ${this.numItems}.`);return xS(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(c,h,g,b){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:C,coords:T,nodeSize:F}=this,U=[0,C.length-1,0],k=[];for(;U.length;){const G=U.pop()||0,q=U.pop()||0,Y=U.pop()||0;if(q-Y<=F){for(let Tt=Y;Tt<=q;Tt++){const Ot=T[2*Tt],ne=T[2*Tt+1];Ot>=c&&Ot<=g&&ne>=h&&ne<=b&&k.push(C[Tt])}continue}const rt=Y+q>>1,lt=T[2*rt],yt=T[2*rt+1];lt>=c&&lt<=g&&yt>=h&&yt<=b&&k.push(C[rt]),(G===0?c<=lt:h<=yt)&&(U.push(Y),U.push(rt-1),U.push(1-G)),(G===0?g>=lt:b>=yt)&&(U.push(rt+1),U.push(q),U.push(1-G))}return k}within(c,h,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:C,nodeSize:T}=this,F=[0,b.length-1,0],U=[],k=g*g;for(;F.length;){const G=F.pop()||0,q=F.pop()||0,Y=F.pop()||0;if(q-Y<=T){for(let Tt=Y;Tt<=q;Tt++)Yk(C[2*Tt],C[2*Tt+1],c,h)<=k&&U.push(b[Tt]);continue}const rt=Y+q>>1,lt=C[2*rt],yt=C[2*rt+1];Yk(lt,yt,c,h)<=k&&U.push(b[rt]),(G===0?c-g<=lt:h-g<=yt)&&(F.push(Y),F.push(rt-1),F.push(1-G)),(G===0?c+g>=lt:h+g>=yt)&&(F.push(rt+1),F.push(q),F.push(1-G))}return U}}function xS(u,c,h,g,b,C){if(b-g<=h)return;const T=g+b>>1;Jk(u,c,T,g,b,C),xS(u,c,h,g,T-1,1-C),xS(u,c,h,T+1,b,1-C)}function Jk(u,c,h,g,b,C){for(;b>g;){if(b-g>600){const k=b-g+1,G=h-g+1,q=Math.log(k),Y=.5*Math.exp(2*q/3),rt=.5*Math.sqrt(q*Y*(k-Y)/k)*(G-k/2<0?-1:1);Jk(u,c,h,Math.max(g,Math.floor(h-G*Y/k+rt)),Math.min(b,Math.floor(h+(k-G)*Y/k+rt)),C)}const T=c[2*h+C];let F=g,U=b;for(f0(u,c,g,h),c[2*b+C]>T&&f0(u,c,g,b);F<U;){for(f0(u,c,F,U),F++,U--;c[2*F+C]<T;)F++;for(;c[2*U+C]>T;)U--}c[2*g+C]===T?f0(u,c,g,U):(U++,f0(u,c,U,b)),U<=h&&(g=U+1),h<=U&&(b=U-1)}}function f0(u,c,h,g){BS(u,h,g),BS(c,2*h,2*g),BS(c,2*h+1,2*g+1)}function BS(u,c,h){const g=u[c];u[c]=u[h],u[h]=g}function Yk(u,c,h,g){const b=u-h,C=c-g;return b*b+C*C}var CS;a.bg=void 0,(CS=a.bg||(a.bg={})).create="create",CS.load="load",CS.fullLoad="fullLoad";let yv=null,p0=[];const ES=1e3/60,SS="loadTime",TS="fullLoadTime",g2t={mark(u){performance.mark(u)},frame(u){const c=u;yv!=null&&p0.push(c-yv),yv=c},clearMetrics(){yv=null,p0=[],performance.clearMeasures(SS),performance.clearMeasures(TS);for(const u in a.bg)performance.clearMarks(a.bg[u])},getPerformanceMetrics(){performance.measure(SS,a.bg.create,a.bg.load),performance.measure(TS,a.bg.create,a.bg.fullLoad);const u=performance.getEntriesByName(SS)[0].duration,c=performance.getEntriesByName(TS)[0].duration,h=p0.length,g=1/(p0.reduce((C,T)=>C+T,0)/h/1e3),b=p0.filter(C=>C>ES).reduce((C,T)=>C+(T-ES)/ES,0);return{loadTime:u,fullLoadTime:c,fps:g,percentDroppedFrames:b/(h+b)*100,totalFrames:h}}};a.$=class extends H{},a.A=Pp,a.B=jm,a.C=function(u){if(Wt==null){const c=u.navigator?u.navigator.userAgent:null;Wt=!!u.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return Wt},a.D=ar,a.E=le,a.F=class{constructor(u,c){this.target=u,this.mapId=c,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new a2t(()=>this.process()),this.subscription=function(h,g,b,C){return h.addEventListener(g,b,!1),{unsubscribe:()=>{h.removeEventListener(g,b,!1)}}}(this.target,"message",h=>this.receive(h)),this.globalScope=$t(self)?u:window}registerMessageHandler(u,c){this.messageHandlers[u]=c}sendAsync(u,c){return new Promise((h,g)=>{const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[b]={resolve:h,reject:g},c&&c.signal.addEventListener("abort",()=>{delete this.resolveRejects[b];const F={id:b,type:"<cancel>",origin:location.origin,targetMapId:u.targetMapId,sourceMapId:this.mapId};this.target.postMessage(F)},{once:!0});const C=[],T=Object.assign(Object.assign({},u),{id:b,sourceMapId:this.mapId,origin:location.origin,data:vu(u.data,C)});this.target.postMessage(T,{transfer:C})})}receive(u){const c=u.data,h=c.id;if(!(c.origin!=="file://"&&location.origin!=="file://"&&c.origin!=="resource://android"&&location.origin!=="resource://android"&&c.origin!==location.origin||c.targetMapId&&this.mapId!==c.targetMapId)){if(c.type==="<cancel>"){delete this.tasks[h];const g=this.abortControllers[h];return delete this.abortControllers[h],void(g&&g.abort())}if($t(self)||c.mustQueue)return this.tasks[h]=c,this.taskQueue.push(h),void this.invoker.trigger();this.processTask(h,c)}}process(){if(this.taskQueue.length===0)return;const u=this.taskQueue.shift(),c=this.tasks[u];delete this.tasks[u],this.taskQueue.length>0&&this.invoker.trigger(),c&&this.processTask(u,c)}processTask(u,c){return o(this,void 0,void 0,function*(){if(c.type==="<response>"){const b=this.resolveRejects[u];return delete this.resolveRejects[u],b?void(c.error?b.reject(Tc(c.error)):b.resolve(Tc(c.data))):void 0}if(!this.messageHandlers[c.type])return void this.completeTask(u,new Error(`Could not find a registered handler for ${c.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const h=Tc(c.data),g=new AbortController;this.abortControllers[u]=g;try{const b=yield this.messageHandlers[c.type](c.sourceMapId,h,g);this.completeTask(u,null,b)}catch(b){this.completeTask(u,b)}})}completeTask(u,c,h){const g=[];delete this.abortControllers[u];const b={id:u,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:c?vu(c):null,data:vu(h,g)};this.target.postMessage(b,{transfer:g})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},a.G=jt,a.H=function(){var u=new Pp(16);return Pp!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},a.I=cS,a.J=function(u,c,h){var g,b,C,T,F,U,k,G,q,Y,rt,lt,yt=h[0],Tt=h[1],Ot=h[2];return c===u?(u[12]=c[0]*yt+c[4]*Tt+c[8]*Ot+c[12],u[13]=c[1]*yt+c[5]*Tt+c[9]*Ot+c[13],u[14]=c[2]*yt+c[6]*Tt+c[10]*Ot+c[14],u[15]=c[3]*yt+c[7]*Tt+c[11]*Ot+c[15]):(b=c[1],C=c[2],T=c[3],F=c[4],U=c[5],k=c[6],G=c[7],q=c[8],Y=c[9],rt=c[10],lt=c[11],u[0]=g=c[0],u[1]=b,u[2]=C,u[3]=T,u[4]=F,u[5]=U,u[6]=k,u[7]=G,u[8]=q,u[9]=Y,u[10]=rt,u[11]=lt,u[12]=g*yt+F*Tt+q*Ot+c[12],u[13]=b*yt+U*Tt+Y*Ot+c[13],u[14]=C*yt+k*Tt+rt*Ot+c[14],u[15]=T*yt+G*Tt+lt*Ot+c[15]),u},a.K=function(u,c,h){var g=h[0],b=h[1],C=h[2];return u[0]=c[0]*g,u[1]=c[1]*g,u[2]=c[2]*g,u[3]=c[3]*g,u[4]=c[4]*b,u[5]=c[5]*b,u[6]=c[6]*b,u[7]=c[7]*b,u[8]=c[8]*C,u[9]=c[9]*C,u[10]=c[10]*C,u[11]=c[11]*C,u[12]=c[12],u[13]=c[13],u[14]=c[14],u[15]=c[15],u},a.L=PN,a.M=function(u,c){const h={};for(let g=0;g<c.length;g++){const b=c[g];b in u&&(h[b]=u[b])}return h},a.N=Th,a.O=Sk,a.P=w,a.Q=Tk,a.R=al,a.S=ll,a.T=wh,a.U=Q,a.V=V,a.W=te,a.X=ei,a.Y=S,a.Z=h0,a._=o,a.a=Ft,a.a$=function(u,c){var h=u[0],g=u[1],b=u[2],C=u[3],T=u[4],F=u[5],U=u[6],k=u[7],G=u[8],q=u[9],Y=u[10],rt=u[11],lt=u[12],yt=u[13],Tt=u[14],Ot=u[15],ne=c[0],zt=c[1],Kt=c[2],ce=c[3],Te=c[4],$e=c[5],Sr=c[6],qe=c[7],Ge=c[8],fr=c[9],nr=c[10],Ze=c[11],me=c[12],mr=c[13],Ar=c[14],Nr=c[15];return Math.abs(h-ne)<=Ro*Math.max(1,Math.abs(h),Math.abs(ne))&&Math.abs(g-zt)<=Ro*Math.max(1,Math.abs(g),Math.abs(zt))&&Math.abs(b-Kt)<=Ro*Math.max(1,Math.abs(b),Math.abs(Kt))&&Math.abs(C-ce)<=Ro*Math.max(1,Math.abs(C),Math.abs(ce))&&Math.abs(T-Te)<=Ro*Math.max(1,Math.abs(T),Math.abs(Te))&&Math.abs(F-$e)<=Ro*Math.max(1,Math.abs(F),Math.abs($e))&&Math.abs(U-Sr)<=Ro*Math.max(1,Math.abs(U),Math.abs(Sr))&&Math.abs(k-qe)<=Ro*Math.max(1,Math.abs(k),Math.abs(qe))&&Math.abs(G-Ge)<=Ro*Math.max(1,Math.abs(G),Math.abs(Ge))&&Math.abs(q-fr)<=Ro*Math.max(1,Math.abs(q),Math.abs(fr))&&Math.abs(Y-nr)<=Ro*Math.max(1,Math.abs(Y),Math.abs(nr))&&Math.abs(rt-Ze)<=Ro*Math.max(1,Math.abs(rt),Math.abs(Ze))&&Math.abs(lt-me)<=Ro*Math.max(1,Math.abs(lt),Math.abs(me))&&Math.abs(yt-mr)<=Ro*Math.max(1,Math.abs(yt),Math.abs(mr))&&Math.abs(Tt-Ar)<=Ro*Math.max(1,Math.abs(Tt),Math.abs(Ar))&&Math.abs(Ot-Nr)<=Ro*Math.max(1,Math.abs(Ot),Math.abs(Nr))},a.a0=an,a.a1=_S,a.a2=de,a.a3=u=>{const c=window.document.createElement("video");return c.muted=!0,new Promise(h=>{c.onloadstart=()=>{h(c)};for(const g of u){const b=window.document.createElement("source");Be(g)||(c.crossOrigin="Anonymous"),b.src=g,c.appendChild(b)}})},a.a4=function(){return ht++},a.a5=Me,a.a6=Np,a.a7=na,a.a8=Eu,a.a9=Rk,a.aA=function(u){if(u.type==="custom")return new o2t(u);switch(u.type){case"background":return new n2t(u);case"circle":return new Gbt(u);case"fill":return new awt(u);case"fill-extrusion":return new wwt(u);case"heatmap":return new qbt(u);case"hillshade":return new $bt(u);case"line":return new Fwt(u);case"raster":return new s2t(u);case"symbol":return new dv(u)}},a.aB=ot,a.aC=function(u,c){if(!u)return[{command:"setStyle",args:[c]}];let h=[];try{if(!ue(u.version,c.version))return[{command:"setStyle",args:[c]}];ue(u.center,c.center)||h.push({command:"setCenter",args:[c.center]}),ue(u.zoom,c.zoom)||h.push({command:"setZoom",args:[c.zoom]}),ue(u.bearing,c.bearing)||h.push({command:"setBearing",args:[c.bearing]}),ue(u.pitch,c.pitch)||h.push({command:"setPitch",args:[c.pitch]}),ue(u.sprite,c.sprite)||h.push({command:"setSprite",args:[c.sprite]}),ue(u.glyphs,c.glyphs)||h.push({command:"setGlyphs",args:[c.glyphs]}),ue(u.transition,c.transition)||h.push({command:"setTransition",args:[c.transition]}),ue(u.light,c.light)||h.push({command:"setLight",args:[c.light]}),ue(u.terrain,c.terrain)||h.push({command:"setTerrain",args:[c.terrain]}),ue(u.sky,c.sky)||h.push({command:"setSky",args:[c.sky]}),ue(u.projection,c.projection)||h.push({command:"setProjection",args:[c.projection]});const g={},b=[];(function(T,F,U,k){let G;for(G in F=F||{},T=T||{})Object.prototype.hasOwnProperty.call(T,G)&&(Object.prototype.hasOwnProperty.call(F,G)||Oe(G,U,k));for(G in F)Object.prototype.hasOwnProperty.call(F,G)&&(Object.prototype.hasOwnProperty.call(T,G)?ue(T[G],F[G])||(T[G].type==="geojson"&&F[G].type==="geojson"&&cr(T,F,G)?ye(U,{command:"setGeoJSONSourceData",args:[G,F[G].data]}):We(G,F,U,k)):Le(G,F,U))})(u.sources,c.sources,b,g);const C=[];u.layers&&u.layers.forEach(T=>{"source"in T&&g[T.source]?h.push({command:"removeLayer",args:[T.id]}):C.push(T)}),h=h.concat(b),function(T,F,U){F=F||[];const k=(T=T||[]).map(Fr),G=F.map(Fr),q=T.reduce(Ur,{}),Y=F.reduce(Ur,{}),rt=k.slice(),lt=Object.create(null);let yt,Tt,Ot,ne,zt;for(let Kt=0,ce=0;Kt<k.length;Kt++)yt=k[Kt],Object.prototype.hasOwnProperty.call(Y,yt)?ce++:(ye(U,{command:"removeLayer",args:[yt]}),rt.splice(rt.indexOf(yt,ce),1));for(let Kt=0,ce=0;Kt<G.length;Kt++)yt=G[G.length-1-Kt],rt[rt.length-1-Kt]!==yt&&(Object.prototype.hasOwnProperty.call(q,yt)?(ye(U,{command:"removeLayer",args:[yt]}),rt.splice(rt.lastIndexOf(yt,rt.length-ce),1)):ce++,ne=rt[rt.length-Kt],ye(U,{command:"addLayer",args:[Y[yt],ne]}),rt.splice(rt.length-Kt,0,yt),lt[yt]=!0);for(let Kt=0;Kt<G.length;Kt++)if(yt=G[Kt],Tt=q[yt],Ot=Y[yt],!lt[yt]&&!ue(Tt,Ot))if(ue(Tt.source,Ot.source)&&ue(Tt["source-layer"],Ot["source-layer"])&&ue(Tt.type,Ot.type)){for(zt in yr(Tt.layout,Ot.layout,U,yt,null,"setLayoutProperty"),yr(Tt.paint,Ot.paint,U,yt,null,"setPaintProperty"),ue(Tt.filter,Ot.filter)||ye(U,{command:"setFilter",args:[yt,Ot.filter]}),ue(Tt.minzoom,Ot.minzoom)&&ue(Tt.maxzoom,Ot.maxzoom)||ye(U,{command:"setLayerZoomRange",args:[yt,Ot.minzoom,Ot.maxzoom]}),Tt)Object.prototype.hasOwnProperty.call(Tt,zt)&&zt!=="layout"&&zt!=="paint"&&zt!=="filter"&&zt!=="metadata"&&zt!=="minzoom"&&zt!=="maxzoom"&&(zt.indexOf("paint.")===0?yr(Tt[zt],Ot[zt],U,yt,zt.slice(6),"setPaintProperty"):ue(Tt[zt],Ot[zt])||ye(U,{command:"setLayerProperty",args:[yt,zt,Ot[zt]]}));for(zt in Ot)Object.prototype.hasOwnProperty.call(Ot,zt)&&!Object.prototype.hasOwnProperty.call(Tt,zt)&&zt!=="layout"&&zt!=="paint"&&zt!=="filter"&&zt!=="metadata"&&zt!=="minzoom"&&zt!=="maxzoom"&&(zt.indexOf("paint.")===0?yr(Tt[zt],Ot[zt],U,yt,zt.slice(6),"setPaintProperty"):ue(Tt[zt],Ot[zt])||ye(U,{command:"setLayerProperty",args:[yt,zt,Ot[zt]]}))}else ye(U,{command:"removeLayer",args:[yt]}),ne=rt[rt.lastIndexOf(yt)+1],ye(U,{command:"addLayer",args:[Ot,ne]})}(C,c.layers,h)}catch(g){console.warn("Unable to compute style diff:",g),h=[{command:"setStyle",args:[c]}]}return h},a.aD=function(u){const c=[],h=u.id;return h===void 0&&c.push({message:`layers.${h}: missing required property "id"`}),u.render===void 0&&c.push({message:`layers.${h}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&c.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),c},a.aE=function u(c,h){if(Array.isArray(c)){if(!Array.isArray(h)||c.length!==h.length)return!1;for(let g=0;g<c.length;g++)if(!u(c[g],h[g]))return!1;return!0}if(typeof c=="object"&&c!==null&&h!==null){if(typeof h!="object"||Object.keys(c).length!==Object.keys(h).length)return!1;for(const g in c)if(!u(c[g],h[g]))return!1;return!0}return c===h},a.aF=It,a.aG=St,a.aH=class extends Bu{constructor(u,c){super(u,c),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},a.aI=kd,a.aJ=class extends Bu{constructor(u,c){super(u,c),this.current=zd}set(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let c=1;c<16;c++)if(u[c]!==this.current[c]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}},a.aK=Qd,a.aL=Ep,a.aM=or,a.aN=class extends Bu{constructor(u,c){super(u,c),this.current=[0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))}},a.aO=class extends Bu{constructor(u,c){super(u,c),this.current=[0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))}},a.aP=function(u,c,h,g,b,C,T){var F=1/(c-h),U=1/(g-b),k=1/(C-T);return u[0]=-2*F,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*U,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*k,u[11]=0,u[12]=(c+h)*F,u[13]=(b+g)*U,u[14]=(T+C)*k,u[15]=1,u},a.aQ=Vbt,a.aR=class extends Et{},a.aS=Rwt,a.aT=class extends Rt{},a.aU=JE,a.aV=function(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))},a.aW=DN,a.aX=ai,a.aY=ds,a.aZ=class extends Se{},a.a_=function(u,c){return u[0]===c[0]&&u[1]===c[1]&&u[2]===c[2]&&u[3]===c[3]&&u[4]===c[4]&&u[5]===c[5]&&u[6]===c[6]&&u[7]===c[7]&&u[8]===c[8]&&u[9]===c[9]&&u[10]===c[10]&&u[11]===c[11]&&u[12]===c[12]&&u[13]===c[13]&&u[14]===c[14]&&u[15]===c[15]},a.aa=function(u){const c={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,g,b,C)=>{const T=b||C;return c[g]=!T||T.toLowerCase(),""}),c["max-age"]){const h=parseInt(c["max-age"],10);isNaN(h)?delete c["max-age"]:c["max-age"]=h}return c},a.ab=function(u,c){const h=[];for(const g in u)g in c||h.push(g);return h},a.ac=ct,a.ad=function(u,c,h){var g=Math.sin(h),b=Math.cos(h),C=c[0],T=c[1],F=c[2],U=c[3],k=c[4],G=c[5],q=c[6],Y=c[7];return c!==u&&(u[8]=c[8],u[9]=c[9],u[10]=c[10],u[11]=c[11],u[12]=c[12],u[13]=c[13],u[14]=c[14],u[15]=c[15]),u[0]=C*b+k*g,u[1]=T*b+G*g,u[2]=F*b+q*g,u[3]=U*b+Y*g,u[4]=k*b-C*g,u[5]=G*b-T*g,u[6]=q*b-F*g,u[7]=Y*b-U*g,u},a.ae=function(u){var c=new Pp(16);return c[0]=u[0],c[1]=u[1],c[2]=u[2],c[3]=u[3],c[4]=u[4],c[5]=u[5],c[6]=u[6],c[7]=u[7],c[8]=u[8],c[9]=u[9],c[10]=u[10],c[11]=u[11],c[12]=u[12],c[13]=u[13],c[14]=u[14],c[15]=u[15],c},a.af=iv,a.ag=function(u,c){let h=0,g=0;if(u.kind==="constant")g=u.layoutSize;else if(u.kind!=="source"){const{interpolationType:b,minZoom:C,maxZoom:T}=u,F=b?ct(Br.interpolationFactor(b,c,C,T),0,1):0;u.kind==="camera"?g=Zi.number(u.minSize,u.maxSize,F):h=F}return{uSizeT:h,uSize:g}},a.ai=function(u,c,h){let{uSize:g,uSizeT:b}=c,{lowerSize:C,upperSize:T}=h;return u.kind==="source"?C/Iu:u.kind==="composite"?Zi.number(C/Iu,T/Iu,b):g},a.aj=dS,a.ak=function(u,c,h,g){const b=c.y-u.y,C=c.x-u.x,T=g.y-h.y,F=g.x-h.x,U=T*C-F*b;if(U===0)return null;const k=(F*(u.y-h.y)-T*(u.x-h.x))/U;return new w(u.x+k*C,u.y+k*b)},a.al=Nk,a.am=Ip,a.an=$E,a.ao=function(u){let c=1/0,h=1/0,g=-1/0,b=-1/0;for(const C of u)c=Math.min(c,C.x),h=Math.min(h,C.y),g=Math.max(g,C.x),b=Math.max(b,C.y);return[c,h,g,b]},a.ap=rs,a.ar=hS,a.as=function(u,c){var h=c[0],g=c[1],b=c[2],C=c[3],T=c[4],F=c[5],U=c[6],k=c[7],G=c[8],q=c[9],Y=c[10],rt=c[11],lt=c[12],yt=c[13],Tt=c[14],Ot=c[15],ne=h*F-g*T,zt=h*U-b*T,Kt=h*k-C*T,ce=g*U-b*F,Te=g*k-C*F,$e=b*k-C*U,Sr=G*yt-q*lt,qe=G*Tt-Y*lt,Ge=G*Ot-rt*lt,fr=q*Tt-Y*yt,nr=q*Ot-rt*yt,Ze=Y*Ot-rt*Tt,me=ne*Ze-zt*nr+Kt*fr+ce*Ge-Te*qe+$e*Sr;return me?(u[0]=(F*Ze-U*nr+k*fr)*(me=1/me),u[1]=(b*nr-g*Ze-C*fr)*me,u[2]=(yt*$e-Tt*Te+Ot*ce)*me,u[3]=(Y*Te-q*$e-rt*ce)*me,u[4]=(U*Ge-T*Ze-k*qe)*me,u[5]=(h*Ze-b*Ge+C*qe)*me,u[6]=(Tt*Kt-lt*$e-Ot*zt)*me,u[7]=(G*$e-Y*Kt+rt*zt)*me,u[8]=(T*nr-F*Ge+k*Sr)*me,u[9]=(g*Ge-h*nr-C*Sr)*me,u[10]=(lt*Te-yt*Kt+Ot*ne)*me,u[11]=(q*Kt-G*Te-rt*ne)*me,u[12]=(F*qe-T*fr-U*Sr)*me,u[13]=(h*fr-g*qe+b*Sr)*me,u[14]=(yt*zt-lt*ce-Tt*ne)*me,u[15]=(G*ce-q*zt+Y*ne)*me,u):null},a.at=bS,a.au=AS,a.av=wS,a.aw=function(){const u={},c=st.$version;for(const h in st.$root){const g=st.$root[h];if(g.required){let b=null;b=h==="version"?c:g.type==="array"?[]:{},b!=null&&(u[h]=b)}}return u},a.ax=Ia,a.ay=re,a.az=function(u){u=u.slice();const c=Object.create(null);for(let h=0;h<u.length;h++)c[u[h].id]=u[h];for(let h=0;h<u.length;h++)"ref"in u[h]&&(u[h]=Ye(u[h],c[u[h].ref]));return u},a.b=Jt,a.b0=function(u,c){return u[0]=c[0],u[1]=c[1],u[2]=c[2],u[3]=c[3],u[4]=c[4],u[5]=c[5],u[6]=c[6],u[7]=c[7],u[8]=c[8],u[9]=c[9],u[10]=c[10],u[11]=c[11],u[12]=c[12],u[13]=c[13],u[14]=c[14],u[15]=c[15],u},a.b1=function(u,c,h){return u[0]=c[0]*h[0],u[1]=c[1]*h[1],u[2]=c[2]*h[2],u[3]=c[3]*h[3],u},a.b2=function(u,c){return u[0]*c[0]+u[1]*c[1]+u[2]*c[2]+u[3]*c[3]},a.b3=dt,a.b4=Lk,a.b5=Ik,a.b6=function(u,c,h,g,b){var C,T=1/Math.tan(c/2);return u[0]=T/h,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=T,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,b!=null&&b!==1/0?(u[10]=(b+g)*(C=1/(g-b)),u[14]=2*b*g*C):(u[10]=-1,u[14]=-2*g),u},a.b7=function(u,c,h){var g=Math.sin(h),b=Math.cos(h),C=c[4],T=c[5],F=c[6],U=c[7],k=c[8],G=c[9],q=c[10],Y=c[11];return c!==u&&(u[0]=c[0],u[1]=c[1],u[2]=c[2],u[3]=c[3],u[12]=c[12],u[13]=c[13],u[14]=c[14],u[15]=c[15]),u[4]=C*b+k*g,u[5]=T*b+G*g,u[6]=F*b+q*g,u[7]=U*b+Y*g,u[8]=k*b-C*g,u[9]=G*b-T*g,u[10]=q*b-F*g,u[11]=Y*b-U*g,u},a.b8=W,a.b9=et,a.bA=nk,a.bB=function(u){return u.message===it},a.bC=As,a.bD=so,a.ba=function(u){return u*Math.PI/180},a.bb=function(u,c){const{x:h,y:g}=h0.fromLngLat(c);return!(u<0||u>25||g<0||g>=1||h<0||h>=1)},a.bc=function(u,c){return u[0]=c[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=c[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=c[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},a.bd=class extends D{},a.be=mS,a.bf=g2t,a.bh=Vt,a.bi=function(u,c){Ft.REGISTERED_PROTOCOLS[u]=c},a.bj=function(u){delete Ft.REGISTERED_PROTOCOLS[u]},a.bk=function(u,c){const h={};for(let b=0;b<u.length;b++){const C=c&&c[u[b].id]||Td(u[b]);c&&(c[u[b].id]=C);let T=h[C];T||(T=h[C]=[]),T.push(u[b])}const g=[];for(const b in h)g.push(h[b]);return g},a.bl=Je,a.bm=Mk,a.bn=Uk,a.bo=hk,a.bp=function(u){u.bucket.createArrays(),u.bucket.tilePixelRatio=ei/(512*u.bucket.overscaling),u.bucket.compareText={},u.bucket.iconsNeedLinear=!1;const c=u.bucket.layers[0],h=c.layout,g=c._unevaluatedLayout._values,b={layoutIconSize:g["icon-size"].possiblyEvaluate(new zn(u.bucket.zoom+1),u.canonical),layoutTextSize:g["text-size"].possiblyEvaluate(new zn(u.bucket.zoom+1),u.canonical),textMaxSize:g["text-size"].possiblyEvaluate(new zn(18))};if(u.bucket.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:G}=u.bucket.textSizeData;b.compositeTextSizes=[g["text-size"].possiblyEvaluate(new zn(k),u.canonical),g["text-size"].possiblyEvaluate(new zn(G),u.canonical)]}if(u.bucket.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:G}=u.bucket.iconSizeData;b.compositeIconSizes=[g["icon-size"].possiblyEvaluate(new zn(k),u.canonical),g["icon-size"].possiblyEvaluate(new zn(G),u.canonical)]}const C=h.get("text-line-height")*rs,T=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",F=h.get("text-keep-upright"),U=h.get("text-size");for(const k of u.bucket.features){const G=h.get("text-font").evaluate(k,{},u.canonical).join(","),q=U.evaluate(k,{},u.canonical),Y=b.layoutTextSize.evaluate(k,{},u.canonical),rt=b.layoutIconSize.evaluate(k,{},u.canonical),lt={horizontal:{},vertical:void 0},yt=k.text;let Tt,Ot=[0,0];if(yt){const Kt=yt.toString(),ce=h.get("text-letter-spacing").evaluate(k,{},u.canonical)*rs,Te=qm(Kt)?ce:0,$e=h.get("text-anchor").evaluate(k,{},u.canonical),Sr=Kk(c,k,u.canonical);if(!Sr){const nr=h.get("text-radial-offset").evaluate(k,{},u.canonical);Ot=nr?qk($e,[nr*rs,vS]):h.get("text-offset").evaluate(k,{},u.canonical).map(Ze=>Ze*rs)}let qe=T?"center":h.get("text-justify").evaluate(k,{},u.canonical);const Ge=h.get("symbol-placement")==="point"?h.get("text-max-width").evaluate(k,{},u.canonical)*rs:1/0,fr=()=>{u.bucket.allowVerticalPlacement&&Ud(Kt)&&(lt.vertical=uv(yt,u.glyphMap,u.glyphPositions,u.imagePositions,G,Ge,C,$e,"left",Te,Ot,a.ah.vertical,!0,Y,q))};if(!T&&Sr){const nr=new Set;if(qe==="auto")for(let me=0;me<Sr.values.length;me+=2)nr.add(bS(Sr.values[me]));else nr.add(qe);let Ze=!1;for(const me of nr)if(!lt.horizontal[me])if(Ze)lt.horizontal[me]=lt.horizontal[0];else{const mr=uv(yt,u.glyphMap,u.glyphPositions,u.imagePositions,G,Ge,C,"center",me,Te,Ot,a.ah.horizontal,!1,Y,q);mr&&(lt.horizontal[me]=mr,Ze=mr.positionedLines.length===1)}fr()}else{qe==="auto"&&(qe=bS($e));const nr=uv(yt,u.glyphMap,u.glyphPositions,u.imagePositions,G,Ge,C,$e,qe,Te,Ot,a.ah.horizontal,!1,Y,q);nr&&(lt.horizontal[qe]=nr),fr(),Ud(Kt)&&T&&F&&(lt.vertical=uv(yt,u.glyphMap,u.glyphPositions,u.imagePositions,G,Ge,C,$e,qe,Te,Ot,a.ah.vertical,!1,Y,q))}}let ne=!1;if(k.icon&&k.icon.name){const Kt=u.imageMap[k.icon.name];Kt&&(Tt=Ywt(u.imagePositions[k.icon.name],h.get("icon-offset").evaluate(k,{},u.canonical),h.get("icon-anchor").evaluate(k,{},u.canonical)),ne=!!Kt.sdf,u.bucket.sdfIcons===void 0?u.bucket.sdfIcons=ne:u.bucket.sdfIcons!==ne&&bt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Kt.pixelRatio!==u.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(u.bucket.iconsNeedLinear=!0))}const zt=Wk(lt.horizontal)||lt.vertical;u.bucket.iconsInText=!!zt&&zt.iconsInText,(zt||Tt)&&f2t(u.bucket,k,lt,Tt,u.imageMap,b,Y,rt,Ot,ne,u.canonical)}u.showCollisionBoxes&&u.bucket.generateCollisionDebugBuffers()},a.bq=sS,a.br=rS,a.bs=iS,a.bt=Ch,a.bu=aS,a.bv=class{constructor(u){this._marks={start:[u.url,"start"].join("#"),end:[u.url,"end"].join("#"),measure:u.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let u=performance.getEntriesByName(this._marks.measure);return u.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),u=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),u}},a.bw=function(u,c,h,g,b){return o(this,void 0,void 0,function*(){if(V())try{return yield te(u,c,h,g,b)}catch{}return function(C,T,F,U,k){const G=C.width,q=C.height;Yt&&be||(Yt=new OffscreenCanvas(G,q),be=Yt.getContext("2d",{willReadFrequently:!0})),Yt.width=G,Yt.height=q,be.drawImage(C,0,0,G,q);const Y=be.getImageData(T,F,U,k);return be.clearRect(0,0,G,q),Y.data}(u,c,h,g,b)})},a.bx=Pk,a.by=d,a.bz=f,a.c=wt,a.d=u=>o(void 0,void 0,void 0,function*(){if(u.byteLength===0)return createImageBitmap(new ImageData(1,1));const c=new Blob([new Uint8Array(u)],{type:"image/png"});try{return createImageBitmap(c)}catch(h){throw new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),a.e=gt,a.f=u=>new Promise((c,h)=>{const g=new Image;g.onload=()=>{c(g),URL.revokeObjectURL(g.src),g.onload=null,window.requestAnimationFrame(()=>{g.src=qt})},g.onerror=()=>h(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const b=new Blob([new Uint8Array(u)],{type:"image/png"});g.src=u.byteLength?URL.createObjectURL(b):qt}),a.g=Ut,a.h=(u,c)=>Zt(gt(u,{type:"json"}),c),a.i=$t,a.j=Ke,a.k=He,a.l=(u,c)=>Zt(gt(u,{type:"arrayBuffer"}),c),a.m=Zt,a.n=function(u){return new aS(u).readFields(jwt,[])},a.o=r0,a.p=Ak,a.q=m,a.r=yA,a.s=Be,a.t=Rd,a.u=nl,a.v=st,a.w=bt,a.x=function(u){let[c,h,g]=u;return h+=90,h*=Math.PI/180,g*=Math.PI/180,{x:c*Math.cos(h)*Math.sin(g),y:c*Math.sin(h)*Math.sin(g),z:c*Math.cos(g)}},a.y=Zi,a.z=zn}),i("worker",["./shared"],function(a){class o{constructor(X){this.keyCache={},X&&this.replace(X)}replace(X){this._layerConfigs={},this._layers={},this.update(X,[])}update(X,Z){for(const Bt of X){this._layerConfigs[Bt.id]=Bt;const Qt=this._layers[Bt.id]=a.aA(Bt);Qt._featureFilter=a.a7(Qt.filter),this.keyCache[Bt.id]&&delete this.keyCache[Bt.id]}for(const Bt of Z)delete this.keyCache[Bt],delete this._layerConfigs[Bt],delete this._layers[Bt];this.familiesBySource={};const ft=a.bk(Object.values(this._layerConfigs),this.keyCache);for(const Bt of ft){const Qt=Bt.map(Xt=>this._layers[Xt.id]),Gt=Qt[0];if(Gt.visibility==="none")continue;const Nt=Gt.source||"";let Pt=this.familiesBySource[Nt];Pt||(Pt=this.familiesBySource[Nt]={});const se=Gt.sourceLayer||"_geojsonTileLayer";let he=Pt[se];he||(he=Pt[se]=[]),he.push(Qt)}}}class d{constructor(X){const Z={},ft=[];for(const Nt in X){const Pt=X[Nt],se=Z[Nt]={};for(const he in Pt){const Xt=Pt[+he];if(!Xt||Xt.bitmap.width===0||Xt.bitmap.height===0)continue;const we={x:0,y:0,w:Xt.bitmap.width+2,h:Xt.bitmap.height+2};ft.push(we),se[he]={rect:we,metrics:Xt.metrics}}}const{w:Bt,h:Qt}=a.p(ft),Gt=new a.o({width:Bt||1,height:Qt||1});for(const Nt in X){const Pt=X[Nt];for(const se in Pt){const he=Pt[+se];if(!he||he.bitmap.width===0||he.bitmap.height===0)continue;const Xt=Z[Nt][se].rect;a.o.copy(he.bitmap,Gt,{x:0,y:0},{x:Xt.x+1,y:Xt.y+1},he.bitmap)}}this.image=Gt,this.positions=Z}}a.bl("GlyphAtlas",d);class f{constructor(X){this.tileID=new a.S(X.tileID.overscaledZ,X.tileID.wrap,X.tileID.canonical.z,X.tileID.canonical.x,X.tileID.canonical.y),this.uid=X.uid,this.zoom=X.zoom,this.pixelRatio=X.pixelRatio,this.tileSize=X.tileSize,this.source=X.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=X.showCollisionBoxes,this.collectResourceTiming=!!X.collectResourceTiming,this.returnDependencies=!!X.returnDependencies,this.promoteId=X.promoteId,this.inFlightDependencies=[]}parse(X,Z,ft,Bt){return a._(this,void 0,void 0,function*(){this.status="parsing",this.data=X,this.collisionBoxArray=new a.a5;const Qt=new a.bm(Object.keys(X.layers).sort()),Gt=new a.bn(this.tileID,this.promoteId);Gt.bucketLayerIDs=[];const Nt={},Pt={featureIndex:Gt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ft},se=Z.familiesBySource[this.source];for(const vr in se){const jr=X.layers[vr];if(!jr)continue;jr.version===1&&a.w(`Vector tile source "${this.source}" layer "${vr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const on=Qt.encode(vr),In=[];for(let Mt=0;Mt<jr.length;Mt++){const Ne=jr.feature(Mt),Ee=Gt.getId(Ne,vr);In.push({feature:Ne,id:Ee,index:Mt,sourceLayerIndex:on})}for(const Mt of se[vr]){const Ne=Mt[0];Ne.source!==this.source&&a.w(`layer.source = ${Ne.source} does not equal this.source = ${this.source}`),Ne.minzoom&&this.zoom<Math.floor(Ne.minzoom)||Ne.maxzoom&&this.zoom>=Ne.maxzoom||Ne.visibility!=="none"&&(_(Mt,this.zoom,ft),(Nt[Ne.id]=Ne.createBucket({index:Gt.bucketLayerIDs.length,layers:Mt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:on,sourceID:this.source})).populate(In,Pt,this.tileID.canonical),Gt.bucketLayerIDs.push(Mt.map(Ee=>Ee.id)))}}const he=a.aF(Pt.glyphDependencies,vr=>Object.keys(vr).map(Number));this.inFlightDependencies.forEach(vr=>vr==null?void 0:vr.abort()),this.inFlightDependencies=[];let Xt=Promise.resolve({});if(Object.keys(he).length){const vr=new AbortController;this.inFlightDependencies.push(vr),Xt=Bt.sendAsync({type:"GG",data:{stacks:he,source:this.source,tileID:this.tileID,type:"glyphs"}},vr)}const we=Object.keys(Pt.iconDependencies);let je=Promise.resolve({});if(we.length){const vr=new AbortController;this.inFlightDependencies.push(vr),je=Bt.sendAsync({type:"GI",data:{icons:we,source:this.source,tileID:this.tileID,type:"icons"}},vr)}const tr=Object.keys(Pt.patternDependencies);let Qr=Promise.resolve({});if(tr.length){const vr=new AbortController;this.inFlightDependencies.push(vr),Qr=Bt.sendAsync({type:"GI",data:{icons:tr,source:this.source,tileID:this.tileID,type:"patterns"}},vr)}const[ir,Or,xr]=yield Promise.all([Xt,je,Qr]),$r=new d(ir),Xr=new a.bo(Or,xr);for(const vr in Nt){const jr=Nt[vr];jr instanceof a.a6?(_(jr.layers,this.zoom,ft),a.bp({bucket:jr,glyphMap:ir,glyphPositions:$r.positions,imageMap:Or,imagePositions:Xr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):jr.hasPattern&&(jr instanceof a.bq||jr instanceof a.br||jr instanceof a.bs)&&(_(jr.layers,this.zoom,ft),jr.addFeatures(Pt,this.tileID.canonical,Xr.patternPositions))}return this.status="done",{buckets:Object.values(Nt).filter(vr=>!vr.isEmpty()),featureIndex:Gt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:$r.image,imageAtlas:Xr,glyphMap:this.returnDependencies?ir:null,iconMap:this.returnDependencies?Or:null,glyphPositions:this.returnDependencies?$r.positions:null}})}}function _(Ct,X,Z){const ft=new a.z(X);for(const Bt of Ct)Bt.recalculate(ft,Z)}class w{constructor(X,Z,ft){this.actor=X,this.layerIndex=Z,this.availableImages=ft,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(X,Z){return a._(this,void 0,void 0,function*(){const ft=yield a.l(X.request,Z);try{return{vectorTile:new a.bt.VectorTile(new a.bu(ft.data)),rawData:ft.data,cacheControl:ft.cacheControl,expires:ft.expires}}catch(Bt){const Qt=new Uint8Array(ft.data);let Gt=`Unable to parse the tile at ${X.request.url}, `;throw Gt+=Qt[0]===31&&Qt[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Bt.message}`,new Error(Gt)}})}loadTile(X){return a._(this,void 0,void 0,function*(){const Z=X.uid,ft=!!(X&&X.request&&X.request.collectResourceTiming)&&new a.bv(X.request),Bt=new f(X);this.loading[Z]=Bt;const Qt=new AbortController;Bt.abort=Qt;try{const Gt=yield this.loadVectorTile(X,Qt);if(delete this.loading[Z],!Gt)return null;const Nt=Gt.rawData,Pt={};Gt.expires&&(Pt.expires=Gt.expires),Gt.cacheControl&&(Pt.cacheControl=Gt.cacheControl);const se={};if(ft){const Xt=ft.finish();Xt&&(se.resourceTiming=JSON.parse(JSON.stringify(Xt)))}Bt.vectorTile=Gt.vectorTile;const he=Bt.parse(Gt.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[Z]=Bt,this.fetching[Z]={rawTileData:Nt,cacheControl:Pt,resourceTiming:se};try{const Xt=yield he;return a.e({rawTileData:Nt.slice(0)},Xt,Pt,se)}finally{delete this.fetching[Z]}}catch(Gt){throw delete this.loading[Z],Bt.status="done",this.loaded[Z]=Bt,Gt}})}reloadTile(X){return a._(this,void 0,void 0,function*(){const Z=X.uid;if(!this.loaded||!this.loaded[Z])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ft=this.loaded[Z];if(ft.showCollisionBoxes=X.showCollisionBoxes,ft.status==="parsing"){const Bt=yield ft.parse(ft.vectorTile,this.layerIndex,this.availableImages,this.actor);let Qt;if(this.fetching[Z]){const{rawTileData:Gt,cacheControl:Nt,resourceTiming:Pt}=this.fetching[Z];delete this.fetching[Z],Qt=a.e({rawTileData:Gt.slice(0)},Bt,Nt,Pt)}else Qt=Bt;return Qt}if(ft.status==="done"&&ft.vectorTile)return ft.parse(ft.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(X){return a._(this,void 0,void 0,function*(){const Z=this.loading,ft=X.uid;Z&&Z[ft]&&Z[ft].abort&&(Z[ft].abort.abort(),delete Z[ft])})}removeTile(X){return a._(this,void 0,void 0,function*(){this.loaded&&this.loaded[X.uid]&&delete this.loaded[X.uid]})}}class x{constructor(){this.loaded={}}loadTile(X){return a._(this,void 0,void 0,function*(){const{uid:Z,encoding:ft,rawImageData:Bt,redFactor:Qt,greenFactor:Gt,blueFactor:Nt,baseShift:Pt}=X,se=Bt.width+2,he=Bt.height+2,Xt=a.b(Bt)?new a.R({width:se,height:he},yield a.bw(Bt,-1,-1,se,he)):Bt,we=new a.bx(Z,Xt,ft,Qt,Gt,Nt,Pt);return this.loaded=this.loaded||{},this.loaded[Z]=we,we})}removeTile(X){const Z=this.loaded,ft=X.uid;Z&&Z[ft]&&delete Z[ft]}}function B(Ct,X){if(Ct.length!==0){P(Ct[0],X);for(var Z=1;Z<Ct.length;Z++)P(Ct[Z],!X)}}function P(Ct,X){for(var Z=0,ft=0,Bt=0,Qt=Ct.length,Gt=Qt-1;Bt<Qt;Gt=Bt++){var Nt=(Ct[Bt][0]-Ct[Gt][0])*(Ct[Gt][1]+Ct[Bt][1]),Pt=Z+Nt;ft+=Math.abs(Z)>=Math.abs(Nt)?Z-Pt+Nt:Nt-Pt+Z,Z=Pt}Z+ft>=0!=!!X&&Ct.reverse()}var R=a.by(function Ct(X,Z){var ft,Bt=X&&X.type;if(Bt==="FeatureCollection")for(ft=0;ft<X.features.length;ft++)Ct(X.features[ft],Z);else if(Bt==="GeometryCollection")for(ft=0;ft<X.geometries.length;ft++)Ct(X.geometries[ft],Z);else if(Bt==="Feature")Ct(X.geometry,Z);else if(Bt==="Polygon")B(X.coordinates,Z);else if(Bt==="MultiPolygon")for(ft=0;ft<X.coordinates.length;ft++)B(X.coordinates[ft],Z);return X});const N=a.bt.VectorTileFeature.prototype.toGeoJSON;var Q={exports:{}},V=a.bz,W=a.bt.VectorTileFeature,et=ct;function ct(Ct,X){this.options=X||{},this.features=Ct,this.length=Ct.length}function dt(Ct,X){this.id=typeof Ct.id=="number"?Ct.id:void 0,this.type=Ct.type,this.rawGeometry=Ct.type===1?[Ct.geometry]:Ct.geometry,this.properties=Ct.tags,this.extent=X||4096}ct.prototype.feature=function(Ct){return new dt(this.features[Ct],this.options.extent)},dt.prototype.loadGeometry=function(){var Ct=this.rawGeometry;this.geometry=[];for(var X=0;X<Ct.length;X++){for(var Z=Ct[X],ft=[],Bt=0;Bt<Z.length;Bt++)ft.push(new V(Z[Bt][0],Z[Bt][1]));this.geometry.push(ft)}return this.geometry},dt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ct=this.geometry,X=1/0,Z=-1/0,ft=1/0,Bt=-1/0,Qt=0;Qt<Ct.length;Qt++)for(var Gt=Ct[Qt],Nt=0;Nt<Gt.length;Nt++){var Pt=Gt[Nt];X=Math.min(X,Pt.x),Z=Math.max(Z,Pt.x),ft=Math.min(ft,Pt.y),Bt=Math.max(Bt,Pt.y)}return[X,ft,Z,Bt]},dt.prototype.toGeoJSON=W.prototype.toGeoJSON;var gt=a.bA,ht=et;function It(Ct){var X=new gt;return function(Z,ft){for(var Bt in Z.layers)ft.writeMessage(3,St,Z.layers[Bt])}(Ct,X),X.finish()}function St(Ct,X){var Z;X.writeVarintField(15,Ct.version||1),X.writeStringField(1,Ct.name||""),X.writeVarintField(5,Ct.extent||4096);var ft={keys:[],values:[],keycache:{},valuecache:{}};for(Z=0;Z<Ct.length;Z++)ft.feature=Ct.feature(Z),X.writeMessage(2,ot,ft);var Bt=ft.keys;for(Z=0;Z<Bt.length;Z++)X.writeStringField(3,Bt[Z]);var Qt=ft.values;for(Z=0;Z<Qt.length;Z++)X.writeMessage(4,Wt,Qt[Z])}function ot(Ct,X){var Z=Ct.feature;Z.id!==void 0&&X.writeVarintField(1,Z.id),X.writeMessage(2,at,Ct),X.writeVarintField(3,Z.type),X.writeMessage(4,$t,Z)}function at(Ct,X){var Z=Ct.feature,ft=Ct.keys,Bt=Ct.values,Qt=Ct.keycache,Gt=Ct.valuecache;for(var Nt in Z.properties){var Pt=Z.properties[Nt],se=Qt[Nt];if(Pt!==null){se===void 0&&(ft.push(Nt),Qt[Nt]=se=ft.length-1),X.writeVarint(se);var he=typeof Pt;he!=="string"&&he!=="boolean"&&he!=="number"&&(Pt=JSON.stringify(Pt));var Xt=he+":"+Pt,we=Gt[Xt];we===void 0&&(Bt.push(Pt),Gt[Xt]=we=Bt.length-1),X.writeVarint(we)}}}function bt(Ct,X){return(X<<3)+(7&Ct)}function vt(Ct){return Ct<<1^Ct>>31}function $t(Ct,X){for(var Z=Ct.loadGeometry(),ft=Ct.type,Bt=0,Qt=0,Gt=Z.length,Nt=0;Nt<Gt;Nt++){var Pt=Z[Nt],se=1;ft===1&&(se=Pt.length),X.writeVarint(bt(1,se));for(var he=ft===3?Pt.length-1:Pt.length,Xt=0;Xt<he;Xt++){Xt===1&&ft!==1&&X.writeVarint(bt(2,he-1));var we=Pt[Xt].x-Bt,je=Pt[Xt].y-Qt;X.writeVarint(vt(we)),X.writeVarint(vt(je)),Bt+=we,Qt+=je}ft===3&&X.writeVarint(bt(7,1))}}function Wt(Ct,X){var Z=typeof Ct;Z==="string"?X.writeStringField(1,Ct):Z==="boolean"?X.writeBooleanField(7,Ct):Z==="number"&&(Ct%1!=0?X.writeDoubleField(3,Ct):Ct<0?X.writeSVarintField(6,Ct):X.writeVarintField(5,Ct))}Q.exports=It,Q.exports.fromVectorTileJs=It,Q.exports.fromGeojsonVt=function(Ct,X){X=X||{};var Z={};for(var ft in Ct)Z[ft]=new ht(Ct[ft].features,X),Z[ft].name=ft,Z[ft].version=X.version,Z[ft].extent=X.extent;return It({layers:Z})},Q.exports.GeoJSONWrapper=ht;var Jt=a.by(Q.exports);const qt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ct=>Ct},te=Math.fround||(Yt=new Float32Array(1),Ct=>(Yt[0]=+Ct,Yt[0]));var Yt;const be=3,it=5,wt=6;class Ft{constructor(X){this.options=Object.assign(Object.create(qt),X),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(X){const{log:Z,minZoom:ft,maxZoom:Bt}=this.options;Z&&console.time("total time");const Qt=`prepare ${X.length} points`;Z&&console.time(Qt),this.points=X;const Gt=[];for(let Pt=0;Pt<X.length;Pt++){const se=X[Pt];if(!se.geometry)continue;const[he,Xt]=se.geometry.coordinates,we=te(Vt(he)),je=te(re(Xt));Gt.push(we,je,1/0,Pt,-1,1),this.options.reduce&&Gt.push(0)}let Nt=this.trees[Bt+1]=this._createTree(Gt);Z&&console.timeEnd(Qt);for(let Pt=Bt;Pt>=ft;Pt--){const se=+Date.now();Nt=this.trees[Pt]=this._createTree(this._cluster(Nt,Pt)),Z&&console.log("z%d: %d clusters in %dms",Pt,Nt.numItems,+Date.now()-se)}return Z&&console.timeEnd("total time"),this}getClusters(X,Z){let ft=((X[0]+180)%360+360)%360-180;const Bt=Math.max(-90,Math.min(90,X[1]));let Qt=X[2]===180?180:((X[2]+180)%360+360)%360-180;const Gt=Math.max(-90,Math.min(90,X[3]));if(X[2]-X[0]>=360)ft=-180,Qt=180;else if(ft>Qt){const Xt=this.getClusters([ft,Bt,180,Gt],Z),we=this.getClusters([-180,Bt,Qt,Gt],Z);return Xt.concat(we)}const Nt=this.trees[this._limitZoom(Z)],Pt=Nt.range(Vt(ft),re(Gt),Vt(Qt),re(Bt)),se=Nt.data,he=[];for(const Xt of Pt){const we=this.stride*Xt;he.push(se[we+it]>1?Ut(se,we,this.clusterProps):this.points[se[we+be]])}return he}getChildren(X){const Z=this._getOriginId(X),ft=this._getOriginZoom(X),Bt="No cluster with the specified id.",Qt=this.trees[ft];if(!Qt)throw new Error(Bt);const Gt=Qt.data;if(Z*this.stride>=Gt.length)throw new Error(Bt);const Nt=this.options.radius/(this.options.extent*Math.pow(2,ft-1)),Pt=Qt.within(Gt[Z*this.stride],Gt[Z*this.stride+1],Nt),se=[];for(const he of Pt){const Xt=he*this.stride;Gt[Xt+4]===X&&se.push(Gt[Xt+it]>1?Ut(Gt,Xt,this.clusterProps):this.points[Gt[Xt+be]])}if(se.length===0)throw new Error(Bt);return se}getLeaves(X,Z,ft){const Bt=[];return this._appendLeaves(Bt,X,Z=Z||10,ft=ft||0,0),Bt}getTile(X,Z,ft){const Bt=this.trees[this._limitZoom(X)],Qt=Math.pow(2,X),{extent:Gt,radius:Nt}=this.options,Pt=Nt/Gt,se=(ft-Pt)/Qt,he=(ft+1+Pt)/Qt,Xt={features:[]};return this._addTileFeatures(Bt.range((Z-Pt)/Qt,se,(Z+1+Pt)/Qt,he),Bt.data,Z,ft,Qt,Xt),Z===0&&this._addTileFeatures(Bt.range(1-Pt/Qt,se,1,he),Bt.data,Qt,ft,Qt,Xt),Z===Qt-1&&this._addTileFeatures(Bt.range(0,se,Pt/Qt,he),Bt.data,-1,ft,Qt,Xt),Xt.features.length?Xt:null}getClusterExpansionZoom(X){let Z=this._getOriginZoom(X)-1;for(;Z<=this.options.maxZoom;){const ft=this.getChildren(X);if(Z++,ft.length!==1)break;X=ft[0].properties.cluster_id}return Z}_appendLeaves(X,Z,ft,Bt,Qt){const Gt=this.getChildren(Z);for(const Nt of Gt){const Pt=Nt.properties;if(Pt&&Pt.cluster?Qt+Pt.point_count<=Bt?Qt+=Pt.point_count:Qt=this._appendLeaves(X,Pt.cluster_id,ft,Bt,Qt):Qt<Bt?Qt++:X.push(Nt),X.length===ft)break}return Qt}_createTree(X){const Z=new a.av(X.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ft=0;ft<X.length;ft+=this.stride)Z.add(X[ft],X[ft+1]);return Z.finish(),Z.data=X,Z}_addTileFeatures(X,Z,ft,Bt,Qt,Gt){for(const Nt of X){const Pt=Nt*this.stride,se=Z[Pt+it]>1;let he,Xt,we;if(se)he=jt(Z,Pt,this.clusterProps),Xt=Z[Pt],we=Z[Pt+1];else{const Qr=this.points[Z[Pt+be]];he=Qr.properties;const[ir,Or]=Qr.geometry.coordinates;Xt=Vt(ir),we=re(Or)}const je={type:1,geometry:[[Math.round(this.options.extent*(Xt*Qt-ft)),Math.round(this.options.extent*(we*Qt-Bt))]],tags:he};let tr;tr=se||this.options.generateId?Z[Pt+be]:this.points[Z[Pt+be]].id,tr!==void 0&&(je.id=tr),Gt.features.push(je)}}_limitZoom(X){return Math.max(this.options.minZoom,Math.min(Math.floor(+X),this.options.maxZoom+1))}_cluster(X,Z){const{radius:ft,extent:Bt,reduce:Qt,minPoints:Gt}=this.options,Nt=ft/(Bt*Math.pow(2,Z)),Pt=X.data,se=[],he=this.stride;for(let Xt=0;Xt<Pt.length;Xt+=he){if(Pt[Xt+2]<=Z)continue;Pt[Xt+2]=Z;const we=Pt[Xt],je=Pt[Xt+1],tr=X.within(Pt[Xt],Pt[Xt+1],Nt),Qr=Pt[Xt+it];let ir=Qr;for(const Or of tr){const xr=Or*he;Pt[xr+2]>Z&&(ir+=Pt[xr+it])}if(ir>Qr&&ir>=Gt){let Or,xr=we*Qr,$r=je*Qr,Xr=-1;const vr=((Xt/he|0)<<5)+(Z+1)+this.points.length;for(const jr of tr){const on=jr*he;if(Pt[on+2]<=Z)continue;Pt[on+2]=Z;const In=Pt[on+it];xr+=Pt[on]*In,$r+=Pt[on+1]*In,Pt[on+4]=vr,Qt&&(Or||(Or=this._map(Pt,Xt,!0),Xr=this.clusterProps.length,this.clusterProps.push(Or)),Qt(Or,this._map(Pt,on)))}Pt[Xt+4]=vr,se.push(xr/ir,$r/ir,1/0,vr,-1,ir),Qt&&se.push(Xr)}else{for(let Or=0;Or<he;Or++)se.push(Pt[Xt+Or]);if(ir>1)for(const Or of tr){const xr=Or*he;if(!(Pt[xr+2]<=Z)){Pt[xr+2]=Z;for(let $r=0;$r<he;$r++)se.push(Pt[xr+$r])}}}}return se}_getOriginId(X){return X-this.points.length>>5}_getOriginZoom(X){return(X-this.points.length)%32}_map(X,Z,ft){if(X[Z+it]>1){const Gt=this.clusterProps[X[Z+wt]];return ft?Object.assign({},Gt):Gt}const Bt=this.points[X[Z+be]].properties,Qt=this.options.map(Bt);return ft&&Qt===Bt?Object.assign({},Qt):Qt}}function Ut(Ct,X,Z){return{type:"Feature",id:Ct[X+be],properties:jt(Ct,X,Z),geometry:{type:"Point",coordinates:[(ft=Ct[X],360*(ft-.5)),Zt(Ct[X+1])]}};var ft}function jt(Ct,X,Z){const ft=Ct[X+it],Bt=ft>=1e4?`${Math.round(ft/1e3)}k`:ft>=1e3?Math.round(ft/100)/10+"k":ft,Qt=Ct[X+wt],Gt=Qt===-1?{}:Object.assign({},Z[Qt]);return Object.assign(Gt,{cluster:!0,cluster_id:Ct[X+be],point_count:ft,point_count_abbreviated:Bt})}function Vt(Ct){return Ct/360+.5}function re(Ct){const X=Math.sin(Ct*Math.PI/180),Z=.5-.25*Math.log((1+X)/(1-X))/Math.PI;return Z<0?0:Z>1?1:Z}function Zt(Ct){const X=(180-360*Ct)*Math.PI/180;return 360*Math.atan(Math.exp(X))/Math.PI-90}function Be(Ct,X,Z,ft){let Bt=ft;const Qt=X+(Z-X>>1);let Gt,Nt=Z-X;const Pt=Ct[X],se=Ct[X+1],he=Ct[Z],Xt=Ct[Z+1];for(let we=X+3;we<Z;we+=3){const je=Ie(Ct[we],Ct[we+1],Pt,se,he,Xt);if(je>Bt)Gt=we,Bt=je;else if(je===Bt){const tr=Math.abs(we-Qt);tr<Nt&&(Gt=we,Nt=tr)}}Bt>ft&&(Gt-X>3&&Be(Ct,X,Gt,ft),Ct[Gt+2]=Bt,Z-Gt>3&&Be(Ct,Gt,Z,ft))}function Ie(Ct,X,Z,ft,Bt,Qt){let Gt=Bt-Z,Nt=Qt-ft;if(Gt!==0||Nt!==0){const Pt=((Ct-Z)*Gt+(X-ft)*Nt)/(Gt*Gt+Nt*Nt);Pt>1?(Z=Bt,ft=Qt):Pt>0&&(Z+=Gt*Pt,ft+=Nt*Pt)}return Gt=Ct-Z,Nt=X-ft,Gt*Gt+Nt*Nt}function ke(Ct,X,Z,ft){const Bt={id:Ct??null,type:X,geometry:Z,tags:ft,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(X==="Point"||X==="MultiPoint"||X==="LineString")He(Bt,Z);else if(X==="Polygon")He(Bt,Z[0]);else if(X==="MultiLineString")for(const Qt of Z)He(Bt,Qt);else if(X==="MultiPolygon")for(const Qt of Z)He(Bt,Qt[0]);return Bt}function He(Ct,X){for(let Z=0;Z<X.length;Z+=3)Ct.minX=Math.min(Ct.minX,X[Z]),Ct.minY=Math.min(Ct.minY,X[Z+1]),Ct.maxX=Math.max(Ct.maxX,X[Z]),Ct.maxY=Math.max(Ct.maxY,X[Z+1])}function Ke(Ct,X,Z,ft){if(!X.geometry)return;const Bt=X.geometry.coordinates;if(Bt&&Bt.length===0)return;const Qt=X.geometry.type,Gt=Math.pow(Z.tolerance/((1<<Z.maxZoom)*Z.extent),2);let Nt=[],Pt=X.id;if(Z.promoteId?Pt=X.properties[Z.promoteId]:Z.generateId&&(Pt=ft||0),Qt==="Point")le(Bt,Nt);else if(Qt==="MultiPoint")for(const se of Bt)le(se,Nt);else if(Qt==="LineString")st(Bt,Nt,Gt,!1);else if(Qt==="MultiLineString"){if(Z.lineMetrics){for(const se of Bt)Nt=[],st(se,Nt,Gt,!1),Ct.push(ke(Pt,"LineString",Nt,X.properties));return}pr(Bt,Nt,Gt,!1)}else if(Qt==="Polygon")pr(Bt,Nt,Gt,!0);else{if(Qt!=="MultiPolygon"){if(Qt==="GeometryCollection"){for(const se of X.geometry.geometries)Ke(Ct,{id:Pt,geometry:se,properties:X.properties},Z,ft);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const se of Bt){const he=[];pr(se,he,Gt,!0),Nt.push(he)}}Ct.push(ke(Pt,Qt,Nt,X.properties))}function le(Ct,X){X.push(Ye(Ct[0]),ue(Ct[1]),0)}function st(Ct,X,Z,ft){let Bt,Qt,Gt=0;for(let Pt=0;Pt<Ct.length;Pt++){const se=Ye(Ct[Pt][0]),he=ue(Ct[Pt][1]);X.push(se,he,0),Pt>0&&(Gt+=ft?(Bt*he-se*Qt)/2:Math.sqrt(Math.pow(se-Bt,2)+Math.pow(he-Qt,2))),Bt=se,Qt=he}const Nt=X.length-3;X[2]=1,Be(X,0,Nt,Z),X[Nt+2]=1,X.size=Math.abs(Gt),X.start=0,X.end=X.size}function pr(Ct,X,Z,ft){for(let Bt=0;Bt<Ct.length;Bt++){const Qt=[];st(Ct[Bt],Qt,Z,ft),X.push(Qt)}}function Ye(Ct){return Ct/360+.5}function ue(Ct){const X=Math.sin(Ct*Math.PI/180),Z=.5-.25*Math.log((1+X)/(1-X))/Math.PI;return Z<0?0:Z>1?1:Z}function ye(Ct,X,Z,ft,Bt,Qt,Gt,Nt){if(ft/=X,Qt>=(Z/=X)&&Gt<ft)return Ct;if(Gt<Z||Qt>=ft)return null;const Pt=[];for(const se of Ct){const he=se.geometry;let Xt=se.type;const we=Bt===0?se.minX:se.minY,je=Bt===0?se.maxX:se.maxY;if(we>=Z&&je<ft){Pt.push(se);continue}if(je<Z||we>=ft)continue;let tr=[];if(Xt==="Point"||Xt==="MultiPoint")Le(he,tr,Z,ft,Bt);else if(Xt==="LineString")Oe(he,tr,Z,ft,Bt,!1,Nt.lineMetrics);else if(Xt==="MultiLineString")cr(he,tr,Z,ft,Bt,!1);else if(Xt==="Polygon")cr(he,tr,Z,ft,Bt,!0);else if(Xt==="MultiPolygon")for(const Qr of he){const ir=[];cr(Qr,ir,Z,ft,Bt,!0),ir.length&&tr.push(ir)}if(tr.length){if(Nt.lineMetrics&&Xt==="LineString"){for(const Qr of tr)Pt.push(ke(se.id,Xt,Qr,se.tags));continue}Xt!=="LineString"&&Xt!=="MultiLineString"||(tr.length===1?(Xt="LineString",tr=tr[0]):Xt="MultiLineString"),Xt!=="Point"&&Xt!=="MultiPoint"||(Xt=tr.length===3?"Point":"MultiPoint"),Pt.push(ke(se.id,Xt,tr,se.tags))}}return Pt.length?Pt:null}function Le(Ct,X,Z,ft,Bt){for(let Qt=0;Qt<Ct.length;Qt+=3){const Gt=Ct[Qt+Bt];Gt>=Z&&Gt<=ft&&yr(X,Ct[Qt],Ct[Qt+1],Ct[Qt+2])}}function Oe(Ct,X,Z,ft,Bt,Qt,Gt){let Nt=We(Ct);const Pt=Bt===0?Fr:Ur;let se,he,Xt=Ct.start;for(let ir=0;ir<Ct.length-3;ir+=3){const Or=Ct[ir],xr=Ct[ir+1],$r=Ct[ir+2],Xr=Ct[ir+3],vr=Ct[ir+4],jr=Bt===0?Or:xr,on=Bt===0?Xr:vr;let In=!1;Gt&&(se=Math.sqrt(Math.pow(Or-Xr,2)+Math.pow(xr-vr,2))),jr<Z?on>Z&&(he=Pt(Nt,Or,xr,Xr,vr,Z),Gt&&(Nt.start=Xt+se*he)):jr>ft?on<ft&&(he=Pt(Nt,Or,xr,Xr,vr,ft),Gt&&(Nt.start=Xt+se*he)):yr(Nt,Or,xr,$r),on<Z&&jr>=Z&&(he=Pt(Nt,Or,xr,Xr,vr,Z),In=!0),on>ft&&jr<=ft&&(he=Pt(Nt,Or,xr,Xr,vr,ft),In=!0),!Qt&&In&&(Gt&&(Nt.end=Xt+se*he),X.push(Nt),Nt=We(Ct)),Gt&&(Xt+=se)}let we=Ct.length-3;const je=Ct[we],tr=Ct[we+1],Qr=Bt===0?je:tr;Qr>=Z&&Qr<=ft&&yr(Nt,je,tr,Ct[we+2]),we=Nt.length-3,Qt&&we>=3&&(Nt[we]!==Nt[0]||Nt[we+1]!==Nt[1])&&yr(Nt,Nt[0],Nt[1],Nt[2]),Nt.length&&X.push(Nt)}function We(Ct){const X=[];return X.size=Ct.size,X.start=Ct.start,X.end=Ct.end,X}function cr(Ct,X,Z,ft,Bt,Qt){for(const Gt of Ct)Oe(Gt,X,Z,ft,Bt,Qt,!1)}function yr(Ct,X,Z,ft){Ct.push(X,Z,ft)}function Fr(Ct,X,Z,ft,Bt,Qt){const Gt=(Qt-X)/(ft-X);return yr(Ct,Qt,Z+(Bt-Z)*Gt,1),Gt}function Ur(Ct,X,Z,ft,Bt,Qt){const Gt=(Qt-Z)/(Bt-Z);return yr(Ct,X+(ft-X)*Gt,Qt,1),Gt}function de(Ct,X){const Z=[];for(let ft=0;ft<Ct.length;ft++){const Bt=Ct[ft],Qt=Bt.type;let Gt;if(Qt==="Point"||Qt==="MultiPoint"||Qt==="LineString")Gt=ur(Bt.geometry,X);else if(Qt==="MultiLineString"||Qt==="Polygon"){Gt=[];for(const Nt of Bt.geometry)Gt.push(ur(Nt,X))}else if(Qt==="MultiPolygon"){Gt=[];for(const Nt of Bt.geometry){const Pt=[];for(const se of Nt)Pt.push(ur(se,X));Gt.push(Pt)}}Z.push(ke(Bt.id,Qt,Gt,Bt.tags))}return Z}function ur(Ct,X){const Z=[];Z.size=Ct.size,Ct.start!==void 0&&(Z.start=Ct.start,Z.end=Ct.end);for(let ft=0;ft<Ct.length;ft+=3)Z.push(Ct[ft]+X,Ct[ft+1],Ct[ft+2]);return Z}function _r(Ct,X){if(Ct.transformed)return Ct;const Z=1<<Ct.z,ft=Ct.x,Bt=Ct.y;for(const Qt of Ct.features){const Gt=Qt.geometry,Nt=Qt.type;if(Qt.geometry=[],Nt===1)for(let Pt=0;Pt<Gt.length;Pt+=2)Qt.geometry.push(De(Gt[Pt],Gt[Pt+1],X,Z,ft,Bt));else for(let Pt=0;Pt<Gt.length;Pt++){const se=[];for(let he=0;he<Gt[Pt].length;he+=2)se.push(De(Gt[Pt][he],Gt[Pt][he+1],X,Z,ft,Bt));Qt.geometry.push(se)}}return Ct.transformed=!0,Ct}function De(Ct,X,Z,ft,Bt,Qt){return[Math.round(Z*(Ct*ft-Bt)),Math.round(Z*(X*ft-Qt))]}function gn(Ct,X,Z,ft,Bt){const Qt=X===Bt.maxZoom?0:Bt.tolerance/((1<<X)*Bt.extent),Gt={features:[],numPoints:0,numSimplified:0,numFeatures:Ct.length,source:null,x:Z,y:ft,z:X,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Nt of Ct)pe(Gt,Nt,Qt,Bt);return Gt}function pe(Ct,X,Z,ft){const Bt=X.geometry,Qt=X.type,Gt=[];if(Ct.minX=Math.min(Ct.minX,X.minX),Ct.minY=Math.min(Ct.minY,X.minY),Ct.maxX=Math.max(Ct.maxX,X.maxX),Ct.maxY=Math.max(Ct.maxY,X.maxY),Qt==="Point"||Qt==="MultiPoint")for(let Nt=0;Nt<Bt.length;Nt+=3)Gt.push(Bt[Nt],Bt[Nt+1]),Ct.numPoints++,Ct.numSimplified++;else if(Qt==="LineString")gr(Gt,Bt,Ct,Z,!1,!1);else if(Qt==="MultiLineString"||Qt==="Polygon")for(let Nt=0;Nt<Bt.length;Nt++)gr(Gt,Bt[Nt],Ct,Z,Qt==="Polygon",Nt===0);else if(Qt==="MultiPolygon")for(let Nt=0;Nt<Bt.length;Nt++){const Pt=Bt[Nt];for(let se=0;se<Pt.length;se++)gr(Gt,Pt[se],Ct,Z,!0,se===0)}if(Gt.length){let Nt=X.tags||null;if(Qt==="LineString"&&ft.lineMetrics){Nt={};for(const se in X.tags)Nt[se]=X.tags[se];Nt.mapbox_clip_start=Bt.start/Bt.size,Nt.mapbox_clip_end=Bt.end/Bt.size}const Pt={geometry:Gt,type:Qt==="Polygon"||Qt==="MultiPolygon"?3:Qt==="LineString"||Qt==="MultiLineString"?2:1,tags:Nt};X.id!==null&&(Pt.id=X.id),Ct.features.push(Pt)}}function gr(Ct,X,Z,ft,Bt,Qt){const Gt=ft*ft;if(ft>0&&X.size<(Bt?Gt:ft))return void(Z.numPoints+=X.length/3);const Nt=[];for(let Pt=0;Pt<X.length;Pt+=3)(ft===0||X[Pt+2]>Gt)&&(Z.numSimplified++,Nt.push(X[Pt],X[Pt+1])),Z.numPoints++;Bt&&function(Pt,se){let he=0;for(let Xt=0,we=Pt.length,je=we-2;Xt<we;je=Xt,Xt+=2)he+=(Pt[Xt]-Pt[je])*(Pt[Xt+1]+Pt[je+1]);if(he>0===se)for(let Xt=0,we=Pt.length;Xt<we/2;Xt+=2){const je=Pt[Xt],tr=Pt[Xt+1];Pt[Xt]=Pt[we-2-Xt],Pt[Xt+1]=Pt[we-1-Xt],Pt[we-2-Xt]=je,Pt[we-1-Xt]=tr}}(Nt,Qt),Ct.push(Nt)}const Qe={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Mr{constructor(X,Z){const ft=(Z=this.options=function(Qt,Gt){for(const Nt in Gt)Qt[Nt]=Gt[Nt];return Qt}(Object.create(Qe),Z)).debug;if(ft&&console.time("preprocess data"),Z.maxZoom<0||Z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Z.promoteId&&Z.generateId)throw new Error("promoteId and generateId cannot be used together.");let Bt=function(Qt,Gt){const Nt=[];if(Qt.type==="FeatureCollection")for(let Pt=0;Pt<Qt.features.length;Pt++)Ke(Nt,Qt.features[Pt],Gt,Pt);else Ke(Nt,Qt.type==="Feature"?Qt:{geometry:Qt},Gt);return Nt}(X,Z);this.tiles={},this.tileCoords=[],ft&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Z.indexMaxZoom,Z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Bt=function(Qt,Gt){const Nt=Gt.buffer/Gt.extent;let Pt=Qt;const se=ye(Qt,1,-1-Nt,Nt,0,-1,2,Gt),he=ye(Qt,1,1-Nt,2+Nt,0,-1,2,Gt);return(se||he)&&(Pt=ye(Qt,1,-Nt,1+Nt,0,-1,2,Gt)||[],se&&(Pt=de(se,1).concat(Pt)),he&&(Pt=Pt.concat(de(he,-1)))),Pt}(Bt,Z),Bt.length&&this.splitTile(Bt,0,0,0),ft&&(Bt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(X,Z,ft,Bt,Qt,Gt,Nt){const Pt=[X,Z,ft,Bt],se=this.options,he=se.debug;for(;Pt.length;){Bt=Pt.pop(),ft=Pt.pop(),Z=Pt.pop(),X=Pt.pop();const Xt=1<<Z,we=_n(Z,ft,Bt);let je=this.tiles[we];if(!je&&(he>1&&console.time("creation"),je=this.tiles[we]=gn(X,Z,ft,Bt,se),this.tileCoords.push({z:Z,x:ft,y:Bt}),he)){he>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Z,ft,Bt,je.numFeatures,je.numPoints,je.numSimplified),console.timeEnd("creation"));const In=`z${Z}`;this.stats[In]=(this.stats[In]||0)+1,this.total++}if(je.source=X,Qt==null){if(Z===se.indexMaxZoom||je.numPoints<=se.indexMaxPoints)continue}else{if(Z===se.maxZoom||Z===Qt)continue;if(Qt!=null){const In=Qt-Z;if(ft!==Gt>>In||Bt!==Nt>>In)continue}}if(je.source=null,X.length===0)continue;he>1&&console.time("clipping");const tr=.5*se.buffer/se.extent,Qr=.5-tr,ir=.5+tr,Or=1+tr;let xr=null,$r=null,Xr=null,vr=null,jr=ye(X,Xt,ft-tr,ft+ir,0,je.minX,je.maxX,se),on=ye(X,Xt,ft+Qr,ft+Or,0,je.minX,je.maxX,se);X=null,jr&&(xr=ye(jr,Xt,Bt-tr,Bt+ir,1,je.minY,je.maxY,se),$r=ye(jr,Xt,Bt+Qr,Bt+Or,1,je.minY,je.maxY,se),jr=null),on&&(Xr=ye(on,Xt,Bt-tr,Bt+ir,1,je.minY,je.maxY,se),vr=ye(on,Xt,Bt+Qr,Bt+Or,1,je.minY,je.maxY,se),on=null),he>1&&console.timeEnd("clipping"),Pt.push(xr||[],Z+1,2*ft,2*Bt),Pt.push($r||[],Z+1,2*ft,2*Bt+1),Pt.push(Xr||[],Z+1,2*ft+1,2*Bt),Pt.push(vr||[],Z+1,2*ft+1,2*Bt+1)}}getTile(X,Z,ft){X=+X,Z=+Z,ft=+ft;const Bt=this.options,{extent:Qt,debug:Gt}=Bt;if(X<0||X>24)return null;const Nt=1<<X,Pt=_n(X,Z=Z+Nt&Nt-1,ft);if(this.tiles[Pt])return _r(this.tiles[Pt],Qt);Gt>1&&console.log("drilling down to z%d-%d-%d",X,Z,ft);let se,he=X,Xt=Z,we=ft;for(;!se&&he>0;)he--,Xt>>=1,we>>=1,se=this.tiles[_n(he,Xt,we)];return se&&se.source?(Gt>1&&(console.log("found parent tile z%d-%d-%d",he,Xt,we),console.time("drilling down")),this.splitTile(se.source,he,Xt,we,X,Z,ft),Gt>1&&console.timeEnd("drilling down"),this.tiles[Pt]?_r(this.tiles[Pt],Qt):null):null}}function _n(Ct,X,Z){return 32*((1<<Ct)*Z+X)+Ct}function ze(Ct,X){return X?Ct.properties[X]:Ct.id}function Nn(Ct,X){if(Ct==null)return!0;if(Ct.type==="Feature")return ze(Ct,X)!=null;if(Ct.type==="FeatureCollection"){const Z=new Set;for(const ft of Ct.features){const Bt=ze(ft,X);if(Bt==null||Z.has(Bt))return!1;Z.add(Bt)}return!0}return!1}function sn(Ct,X){const Z=new Map;if(Ct!=null)if(Ct.type==="Feature")Z.set(ze(Ct,X),Ct);else for(const ft of Ct.features)Z.set(ze(ft,X),ft);return Z}class vn extends w{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(X,Z){return a._(this,void 0,void 0,function*(){const ft=X.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Bt=this._geoJSONIndex.getTile(ft.z,ft.x,ft.y);if(!Bt)return null;const Qt=new class{constructor(Nt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.X,this.length=Nt.length,this._features=Nt}feature(Nt){return new class{constructor(Pt){this._feature=Pt,this.extent=a.X,this.type=Pt.type,this.properties=Pt.tags,"id"in Pt&&!isNaN(Pt.id)&&(this.id=parseInt(Pt.id,10))}loadGeometry(){if(this._feature.type===1){const Pt=[];for(const se of this._feature.geometry)Pt.push([new a.P(se[0],se[1])]);return Pt}{const Pt=[];for(const se of this._feature.geometry){const he=[];for(const Xt of se)he.push(new a.P(Xt[0],Xt[1]));Pt.push(he)}return Pt}}toGeoJSON(Pt,se,he){return N.call(this,Pt,se,he)}}(this._features[Nt])}}(Bt.features);let Gt=Jt(Qt);return Gt.byteOffset===0&&Gt.byteLength===Gt.buffer.byteLength||(Gt=new Uint8Array(Gt)),{vectorTile:Qt,rawData:Gt.buffer}})}loadData(X){return a._(this,void 0,void 0,function*(){var Z;(Z=this._pendingRequest)===null||Z===void 0||Z.abort();const ft=!!(X&&X.request&&X.request.collectResourceTiming)&&new a.bv(X.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(X,this._pendingRequest),this._geoJSONIndex=X.cluster?new Ft(function(Gt){let{superclusterOptions:Nt,clusterProperties:Pt}=Gt;if(!Pt||!Nt)return Nt;const se={},he={},Xt={accumulated:null,zoom:0},we={properties:null},je=Object.keys(Pt);for(const tr of je){const[Qr,ir]=Pt[tr],Or=a.bC(ir),xr=a.bC(typeof Qr=="string"?[Qr,["accumulated"],["get",tr]]:Qr);se[tr]=Or.value,he[tr]=xr.value}return Nt.map=tr=>{we.properties=tr;const Qr={};for(const ir of je)Qr[ir]=se[ir].evaluate(Xt,we);return Qr},Nt.reduce=(tr,Qr)=>{we.properties=Qr;for(const ir of je)Xt.accumulated=tr[ir],tr[ir]=he[ir].evaluate(Xt,we)},Nt}(X)).load((yield this._pendingData).features):(Bt=yield this._pendingData,new Mr(Bt,X.geojsonVtOptions)),this.loaded={};const Qt={};if(ft){const Gt=ft.finish();Gt&&(Qt.resourceTiming={},Qt.resourceTiming[X.source]=JSON.parse(JSON.stringify(Gt)))}return Qt}catch(Qt){if(delete this._pendingRequest,a.bB(Qt))return{abandoned:!0};throw Qt}var Bt})}getData(){return a._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(X){const Z=this.loaded;return Z&&Z[X.uid]?super.reloadTile(X):this.loadTile(X)}loadAndProcessGeoJSON(X,Z){return a._(this,void 0,void 0,function*(){let ft=yield this.loadGeoJSON(X,Z);if(delete this._pendingRequest,typeof ft!="object")throw new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`);if(R(ft,!0),X.filter){const Bt=a.bC(X.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Bt.result==="error")throw new Error(Bt.value.map(Gt=>`${Gt.key}: ${Gt.message}`).join(", "));ft={type:"FeatureCollection",features:ft.features.filter(Gt=>Bt.value.evaluate({zoom:0},Gt))}}return ft})}loadGeoJSON(X,Z){return a._(this,void 0,void 0,function*(){const{promoteId:ft}=X;if(X.request){const Bt=yield a.h(X.request,Z);return this._dataUpdateable=Nn(Bt.data,ft)?sn(Bt.data,ft):void 0,Bt.data}if(typeof X.data=="string")try{const Bt=JSON.parse(X.data);return this._dataUpdateable=Nn(Bt,ft)?sn(Bt,ft):void 0,Bt}catch{throw new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`)}if(!X.dataDiff)throw new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${X.source}`);return function(Bt,Qt,Gt){var Nt,Pt,se,he;if(Qt.removeAll&&Bt.clear(),Qt.remove)for(const Xt of Qt.remove)Bt.delete(Xt);if(Qt.add)for(const Xt of Qt.add){const we=ze(Xt,Gt);we!=null&&Bt.set(we,Xt)}if(Qt.update)for(const Xt of Qt.update){let we=Bt.get(Xt.id);if(we==null)continue;const je=!Xt.removeAllProperties&&(((Nt=Xt.removeProperties)===null||Nt===void 0?void 0:Nt.length)>0||((Pt=Xt.addOrUpdateProperties)===null||Pt===void 0?void 0:Pt.length)>0);if((Xt.newGeometry||Xt.removeAllProperties||je)&&(we=Object.assign({},we),Bt.set(Xt.id,we),je&&(we.properties=Object.assign({},we.properties))),Xt.newGeometry&&(we.geometry=Xt.newGeometry),Xt.removeAllProperties)we.properties={};else if(((se=Xt.removeProperties)===null||se===void 0?void 0:se.length)>0)for(const tr of Xt.removeProperties)Object.prototype.hasOwnProperty.call(we.properties,tr)&&delete we.properties[tr];if(((he=Xt.addOrUpdateProperties)===null||he===void 0?void 0:he.length)>0)for(const{key:tr,value:Qr}of Xt.addOrUpdateProperties)we.properties[tr]=Qr}}(this._dataUpdateable,X.dataDiff,ft),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(X){return a._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(X){return this._geoJSONIndex.getClusterExpansionZoom(X.clusterId)}getClusterChildren(X){return this._geoJSONIndex.getChildren(X.clusterId)}getClusterLeaves(X){return this._geoJSONIndex.getLeaves(X.clusterId,X.limit,X.offset)}}class cn{constructor(X){this.self=X,this.actor=new a.F(X),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(Z,ft)=>{if(this.externalWorkerSourceTypes[Z])throw new Error(`Worker source with name "${Z}" already registered.`);this.externalWorkerSourceTypes[Z]=ft},this.self.addProtocol=a.bi,this.self.removeProtocol=a.bj,this.self.registerRTLTextPlugin=Z=>{if(a.bD.isParsed())throw new Error("RTL text plugin already registered.");a.bD.setMethods(Z)},this.actor.registerMessageHandler("LDT",(Z,ft)=>this._getDEMWorkerSource(Z,ft.source).loadTile(ft)),this.actor.registerMessageHandler("RDT",(Z,ft)=>a._(this,void 0,void 0,function*(){this._getDEMWorkerSource(Z,ft.source).removeTile(ft)})),this.actor.registerMessageHandler("GCEZ",(Z,ft)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(Z,ft.type,ft.source).getClusterExpansionZoom(ft)})),this.actor.registerMessageHandler("GCC",(Z,ft)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(Z,ft.type,ft.source).getClusterChildren(ft)})),this.actor.registerMessageHandler("GCL",(Z,ft)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(Z,ft.type,ft.source).getClusterLeaves(ft)})),this.actor.registerMessageHandler("LD",(Z,ft)=>this._getWorkerSource(Z,ft.type,ft.source).loadData(ft)),this.actor.registerMessageHandler("GD",(Z,ft)=>this._getWorkerSource(Z,ft.type,ft.source).getData()),this.actor.registerMessageHandler("LT",(Z,ft)=>this._getWorkerSource(Z,ft.type,ft.source).loadTile(ft)),this.actor.registerMessageHandler("RT",(Z,ft)=>this._getWorkerSource(Z,ft.type,ft.source).reloadTile(ft)),this.actor.registerMessageHandler("AT",(Z,ft)=>this._getWorkerSource(Z,ft.type,ft.source).abortTile(ft)),this.actor.registerMessageHandler("RMT",(Z,ft)=>this._getWorkerSource(Z,ft.type,ft.source).removeTile(ft)),this.actor.registerMessageHandler("RS",(Z,ft)=>a._(this,void 0,void 0,function*(){if(!this.workerSources[Z]||!this.workerSources[Z][ft.type]||!this.workerSources[Z][ft.type][ft.source])return;const Bt=this.workerSources[Z][ft.type][ft.source];delete this.workerSources[Z][ft.type][ft.source],Bt.removeSource!==void 0&&Bt.removeSource(ft)})),this.actor.registerMessageHandler("RM",Z=>a._(this,void 0,void 0,function*(){delete this.layerIndexes[Z],delete this.availableImages[Z],delete this.workerSources[Z],delete this.demWorkerSources[Z]})),this.actor.registerMessageHandler("SR",(Z,ft)=>a._(this,void 0,void 0,function*(){this.referrer=ft})),this.actor.registerMessageHandler("SRPS",(Z,ft)=>this._syncRTLPluginState(Z,ft)),this.actor.registerMessageHandler("IS",(Z,ft)=>a._(this,void 0,void 0,function*(){this.self.importScripts(ft)})),this.actor.registerMessageHandler("SI",(Z,ft)=>this._setImages(Z,ft)),this.actor.registerMessageHandler("UL",(Z,ft)=>a._(this,void 0,void 0,function*(){this._getLayerIndex(Z).update(ft.layers,ft.removedIds)})),this.actor.registerMessageHandler("SL",(Z,ft)=>a._(this,void 0,void 0,function*(){this._getLayerIndex(Z).replace(ft)}))}_setImages(X,Z){return a._(this,void 0,void 0,function*(){this.availableImages[X]=Z;for(const ft in this.workerSources[X]){const Bt=this.workerSources[X][ft];for(const Qt in Bt)Bt[Qt].availableImages=Z}})}_syncRTLPluginState(X,Z){return a._(this,void 0,void 0,function*(){if(a.bD.isParsed())return a.bD.getState();if(Z.pluginStatus!=="loading")return a.bD.setState(Z),Z;const ft=Z.pluginURL;if(this.self.importScripts(ft),a.bD.isParsed()){const Bt={pluginStatus:"loaded",pluginURL:ft};return a.bD.setState(Bt),Bt}throw a.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${ft}`)})}_getAvailableImages(X){let Z=this.availableImages[X];return Z||(Z=[]),Z}_getLayerIndex(X){let Z=this.layerIndexes[X];return Z||(Z=this.layerIndexes[X]=new o),Z}_getWorkerSource(X,Z,ft){if(this.workerSources[X]||(this.workerSources[X]={}),this.workerSources[X][Z]||(this.workerSources[X][Z]={}),!this.workerSources[X][Z][ft]){const Bt={sendAsync:(Qt,Gt)=>(Qt.targetMapId=X,this.actor.sendAsync(Qt,Gt))};switch(Z){case"vector":this.workerSources[X][Z][ft]=new w(Bt,this._getLayerIndex(X),this._getAvailableImages(X));break;case"geojson":this.workerSources[X][Z][ft]=new vn(Bt,this._getLayerIndex(X),this._getAvailableImages(X));break;default:this.workerSources[X][Z][ft]=new this.externalWorkerSourceTypes[Z](Bt,this._getLayerIndex(X),this._getAvailableImages(X))}}return this.workerSources[X][Z][ft]}_getDEMWorkerSource(X,Z){return this.demWorkerSources[X]||(this.demWorkerSources[X]={}),this.demWorkerSources[X][Z]||(this.demWorkerSources[X][Z]=new x),this.demWorkerSources[X][Z]}}return a.i(self)&&(self.worker=new cn(self)),cn}),i("index",["exports","./shared"],function(a,o){var d="4.7.1";let f,_;const w={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:m=>new Promise((l,A)=>{const p=requestAnimationFrame(l);m.signal.addEventListener("abort",()=>{cancelAnimationFrame(p),A(o.c())})}),getImageData(m){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return this.getImageCanvasContext(m).getImageData(-l,-l,m.width+2*l,m.height+2*l)},getImageCanvasContext(m){const l=window.document.createElement("canvas"),A=l.getContext("2d",{willReadFrequently:!0});if(!A)throw new Error("failed to create canvas 2d context");return l.width=m.width,l.height=m.height,A.drawImage(m,0,0,m.width,m.height),A},resolveURL:m=>(f||(f=document.createElement("a")),f.href=m,f.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(_==null&&(_=matchMedia("(prefers-reduced-motion: reduce)")),_.matches)}};class x{static testProp(l){if(!x.docStyle)return l[0];for(let A=0;A<l.length;A++)if(l[A]in x.docStyle)return l[A];return l[0]}static create(l,A,p){const y=window.document.createElement(l);return A!==void 0&&(y.className=A),p&&p.appendChild(y),y}static createNS(l,A){return window.document.createElementNS(l,A)}static disableDrag(){x.docStyle&&x.selectProp&&(x.userSelect=x.docStyle[x.selectProp],x.docStyle[x.selectProp]="none")}static enableDrag(){x.docStyle&&x.selectProp&&(x.docStyle[x.selectProp]=x.userSelect)}static setTransform(l,A){l.style[x.transformProp]=A}static addEventListener(l,A,p){let y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};l.addEventListener(A,p,"passive"in y?y:y.capture)}static removeEventListener(l,A,p){let y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};l.removeEventListener(A,p,"passive"in y?y:y.capture)}static suppressClickInternal(l){l.preventDefault(),l.stopPropagation(),window.removeEventListener("click",x.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",x.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",x.suppressClickInternal,!0)},0)}static getScale(l){const A=l.getBoundingClientRect();return{x:A.width/l.offsetWidth||1,y:A.height/l.offsetHeight||1,boundingClientRect:A}}static getPoint(l,A,p){const y=A.boundingClientRect;return new o.P((p.clientX-y.left)/A.x-l.clientLeft,(p.clientY-y.top)/A.y-l.clientTop)}static mousePos(l,A){const p=x.getScale(l);return x.getPoint(l,p,A)}static touchPos(l,A){const p=[],y=x.getScale(l);for(let v=0;v<A.length;v++)p.push(x.getPoint(l,y,A[v]));return p}static mouseButton(l){return l.button}static remove(l){l.parentNode&&l.parentNode.removeChild(l)}}x.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,x.selectProp=x.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),x.transformProp=x.testProp(["transform","WebkitTransform"]);const B={supported:!1,testSupport:function(m){!N&&R&&(Q?V(m):P=m)}};let P,R,N=!1,Q=!1;function V(m){const l=m.createTexture();m.bindTexture(m.TEXTURE_2D,l);try{if(m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,R),m.isContextLost())return;B.supported=!0}catch{}m.deleteTexture(l),N=!0}var W;typeof document<"u"&&(R=document.createElement("img"),R.onload=()=>{P&&V(P),P=null,Q=!0},R.onerror=()=>{N=!0,P=null},R.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(m){let l,A,p,y;m.resetRequestQueue=()=>{l=[],A=0,p=0,y={}},m.addThrottleControl=M=>{const D=p++;return y[D]=M,D},m.removeThrottleControl=M=>{delete y[M],S()},m.getImage=function(M,D){let H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return new Promise((z,$)=>{B.supported&&(M.headers||(M.headers={}),M.headers.accept="image/webp,*/*"),o.e(M,{type:"image"}),l.push({abortController:D,requestParameters:M,supportImageRefresh:H,state:"queued",onError:J=>{$(J)},onSuccess:J=>{z(J)}}),S()})};const v=M=>o._(this,void 0,void 0,function*(){M.state="running";const{requestParameters:D,supportImageRefresh:H,onError:z,onSuccess:$,abortController:J}=M,K=H===!1&&!o.i(self)&&!o.g(D.url)&&(!D.headers||Object.keys(D.headers).reduce((pt,_t)=>pt&&_t==="accept",!0));A++;const tt=K?I(D,J):o.m(D,J);try{const pt=yield tt;delete M.abortController,M.state="completed",pt.data instanceof HTMLImageElement||o.b(pt.data)?$(pt):pt.data&&$({data:yield(At=pt.data,typeof createImageBitmap=="function"?o.d(At):o.f(At)),cacheControl:pt.cacheControl,expires:pt.expires})}catch(pt){delete M.abortController,z(pt)}finally{A--,S()}var At}),S=()=>{const M=(()=>{for(const D of Object.keys(y))if(y[D]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let D=A;D<M&&l.length>0;D++){const H=l.shift();H.abortController.signal.aborted?D--:v(H)}},I=(M,D)=>new Promise((H,z)=>{const $=new Image,J=M.url,K=M.credentials;K&&K==="include"?$.crossOrigin="use-credentials":(K&&K==="same-origin"||!o.s(J))&&($.crossOrigin="anonymous"),D.signal.addEventListener("abort",()=>{$.src="",z(o.c())}),$.fetchPriority="high",$.onload=()=>{$.onerror=$.onload=null,H({data:$})},$.onerror=()=>{$.onerror=$.onload=null,D.signal.aborted||z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},$.src=J})}(W||(W={})),W.resetRequestQueue();class et{constructor(l){this._transformRequestFn=l}transformRequest(l,A){return this._transformRequestFn&&this._transformRequestFn(l,A)||{url:l}}setTransformRequest(l){this._transformRequestFn=l}}function ct(m){var l=new o.A(3);return l[0]=m[0],l[1]=m[1],l[2]=m[2],l}var dt,gt=function(m,l,A){return m[0]=l[0]-A[0],m[1]=l[1]-A[1],m[2]=l[2]-A[2],m};dt=new o.A(3),o.A!=Float32Array&&(dt[0]=0,dt[1]=0,dt[2]=0);var ht=function(m){var l=m[0],A=m[1];return l*l+A*A};function It(m){const l=[];if(typeof m=="string")l.push({id:"default",url:m});else if(m&&m.length>0){const A=[];for(const{id:p,url:y}of m){const v=`${p}${y}`;A.indexOf(v)===-1&&(A.push(v),l.push({id:p,url:y}))}}return l}function St(m,l,A){const p=m.split("?");return p[0]+=`${l}${A}`,p.join("?")}(function(){var m=new o.A(2);o.A!=Float32Array&&(m[0]=0,m[1]=0)})();class ot{constructor(l,A,p,y){this.context=l,this.format=p,this.texture=l.gl.createTexture(),this.update(A,y)}update(l,A,p){const{width:y,height:v}=l,S=!(this.size&&this.size[0]===y&&this.size[1]===v||p),{context:I}=this,{gl:M}=I;if(this.useMipmap=!!(A&&A.useMipmap),M.bindTexture(M.TEXTURE_2D,this.texture),I.pixelStoreUnpackFlipY.set(!1),I.pixelStoreUnpack.set(1),I.pixelStoreUnpackPremultiplyAlpha.set(this.format===M.RGBA&&(!A||A.premultiply!==!1)),S)this.size=[y,v],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||o.b(l)?M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,M.UNSIGNED_BYTE,l):M.texImage2D(M.TEXTURE_2D,0,this.format,y,v,0,this.format,M.UNSIGNED_BYTE,l.data);else{const{x:D,y:H}=p||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||o.b(l)?M.texSubImage2D(M.TEXTURE_2D,0,D,H,M.RGBA,M.UNSIGNED_BYTE,l):M.texSubImage2D(M.TEXTURE_2D,0,D,H,y,v,M.RGBA,M.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&M.generateMipmap(M.TEXTURE_2D)}bind(l,A,p){const{context:y}=this,{gl:v}=y;v.bindTexture(v.TEXTURE_2D,this.texture),p!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=v.LINEAR),l!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,l),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,p||l),this.filter=l),A!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,A),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,A),this.wrap=A)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}function at(m){const{userImage:l}=m;return!!(l&&l.render&&l.render())&&(m.data.replace(new Uint8Array(l.data.buffer)),!0)}class bt extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:A,promiseResolve:p}of this.requestors)p(this._getImagesForIds(A));this.requestors=[]}}getImage(l){const A=this.images[l];if(A&&!A.data&&A.spriteData){const p=A.spriteData;A.data=new o.R({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),A.spriteData=null}return A}addImage(l,A){if(this.images[l])throw new Error(`Image id ${l} already exist, use updateImage instead`);this._validate(l,A)&&(this.images[l]=A)}_validate(l,A){let p=!0;const y=A.data||A.spriteData;return this._validateStretch(A.stretchX,y&&y.width)||(this.fire(new o.j(new Error(`Image "${l}" has invalid "stretchX" value`))),p=!1),this._validateStretch(A.stretchY,y&&y.height)||(this.fire(new o.j(new Error(`Image "${l}" has invalid "stretchY" value`))),p=!1),this._validateContent(A.content,A)||(this.fire(new o.j(new Error(`Image "${l}" has invalid "content" value`))),p=!1),p}_validateStretch(l,A){if(!l)return!0;let p=0;for(const y of l){if(y[0]<p||y[1]<y[0]||A<y[1])return!1;p=y[1]}return!0}_validateContent(l,A){if(!l)return!0;if(l.length!==4)return!1;const p=A.spriteData,y=p&&p.width||A.data.width,v=p&&p.height||A.data.height;return!(l[0]<0||y<l[0]||l[1]<0||v<l[1]||l[2]<0||y<l[2]||l[3]<0||v<l[3]||l[2]<l[0]||l[3]<l[1])}updateImage(l,A){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const y=this.getImage(l);if(p&&(y.data.width!==A.data.width||y.data.height!==A.data.height))throw new Error(`size mismatch between old image (${y.data.width}x${y.data.height}) and new image (${A.data.width}x${A.data.height}).`);A.version=y.version+1,this.images[l]=A,this.updatedImages[l]=!0}removeImage(l){const A=this.images[l];delete this.images[l],delete this.patterns[l],A.userImage&&A.userImage.onRemove&&A.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l){return new Promise((A,p)=>{let y=!0;if(!this.isLoaded())for(const v of l)this.images[v]||(y=!1);this.isLoaded()||y?A(this._getImagesForIds(l)):this.requestors.push({ids:l,promiseResolve:A})})}_getImagesForIds(l){const A={};for(const p of l){let y=this.getImage(p);y||(this.fire(new o.k("styleimagemissing",{id:p})),y=this.getImage(p)),y?A[p]={data:y.data.clone(),pixelRatio:y.pixelRatio,sdf:y.sdf,version:y.version,stretchX:y.stretchX,stretchY:y.stretchY,content:y.content,textFitWidth:y.textFitWidth,textFitHeight:y.textFitHeight,hasRenderCallback:!!(y.userImage&&y.userImage.render)}:o.w(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return A}getPixelSize(){const{width:l,height:A}=this.atlasImage;return{width:l,height:A}}getPattern(l){const A=this.patterns[l],p=this.getImage(l);if(!p)return null;if(A&&A.position.version===p.version)return A.position;if(A)A.position.version=p.version;else{const y={w:p.data.width+2,h:p.data.height+2,x:0,y:0},v=new o.I(y,p);this.patterns[l]={bin:y,position:v}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const A=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ot(l,this.atlasImage,A.RGBA),this.atlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const v in this.patterns)l.push(this.patterns[v].bin);const{w:A,h:p}=o.p(l),y=this.atlasImage;y.resize({width:A||1,height:p||1});for(const v in this.patterns){const{bin:S}=this.patterns[v],I=S.x+1,M=S.y+1,D=this.getImage(v).data,H=D.width,z=D.height;o.R.copy(D,y,{x:0,y:0},{x:I,y:M},{width:H,height:z}),o.R.copy(D,y,{x:0,y:z-1},{x:I,y:M-1},{width:H,height:1}),o.R.copy(D,y,{x:0,y:0},{x:I,y:M+z},{width:H,height:1}),o.R.copy(D,y,{x:H-1,y:0},{x:I-1,y:M},{width:1,height:z}),o.R.copy(D,y,{x:0,y:0},{x:I+H,y:M},{width:1,height:z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const A of l){if(this.callbackDispatchedThisFrame[A])continue;this.callbackDispatchedThisFrame[A]=!0;const p=this.getImage(A);p||o.w(`Image with ID: "${A}" was not found`),at(p)&&this.updateImage(A,p)}}}const vt=1e20;function $t(m,l,A,p,y,v,S,I,M){for(let D=l;D<l+p;D++)Wt(m,A*v+D,v,y,S,I,M);for(let D=A;D<A+y;D++)Wt(m,D*v+l,1,p,S,I,M)}function Wt(m,l,A,p,y,v,S){v[0]=0,S[0]=-vt,S[1]=vt,y[0]=m[l];for(let I=1,M=0,D=0;I<p;I++){y[I]=m[l+I*A];const H=I*I;do{const z=v[M];D=(y[I]-y[z]+H-z*z)/(I-z)/2}while(D<=S[M]&&--M>-1);M++,v[M]=I,S[M]=D,S[M+1]=vt}for(let I=0,M=0;I<p;I++){for(;S[M+1]<I;)M++;const D=v[M],H=I-D;m[l+I*A]=y[D]+H*H}}class Jt{constructor(l,A){this.requestManager=l,this.localIdeographFontFamily=A,this.entries={}}setURL(l){this.url=l}getGlyphs(l){return o._(this,void 0,void 0,function*(){const A=[];for(const v in l)for(const S of l[v])A.push(this._getAndCacheGlyphsPromise(v,S));const p=yield Promise.all(A),y={};for(const{stack:v,id:S,glyph:I}of p)y[v]||(y[v]={}),y[v][S]=I&&{id:I.id,bitmap:I.bitmap.clone(),metrics:I.metrics};return y})}_getAndCacheGlyphsPromise(l,A){return o._(this,void 0,void 0,function*(){let p=this.entries[l];p||(p=this.entries[l]={glyphs:{},requests:{},ranges:{}});let y=p.glyphs[A];if(y!==void 0)return{stack:l,id:A,glyph:y};if(y=this._tinySDF(p,l,A),y)return p.glyphs[A]=y,{stack:l,id:A,glyph:y};const v=Math.floor(A/256);if(256*v>65535)throw new Error("glyphs > 65535 not supported");if(p.ranges[v])return{stack:l,id:A,glyph:y};if(!this.url)throw new Error("glyphsUrl is not set");if(!p.requests[v]){const I=Jt.loadGlyphRange(l,v,this.url,this.requestManager);p.requests[v]=I}const S=yield p.requests[v];for(const I in S)this._doesCharSupportLocalGlyph(+I)||(p.glyphs[+I]=S[+I]);return p.ranges[v]=!0,{stack:l,id:A,glyph:S[A]||null}})}_doesCharSupportLocalGlyph(l){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(l))}_tinySDF(l,A,p){const y=this.localIdeographFontFamily;if(!y||!this._doesCharSupportLocalGlyph(p))return;let v=l.tinySDF;if(!v){let I="400";/bold/i.test(A)?I="900":/medium/i.test(A)?I="500":/light/i.test(A)&&(I="200"),v=l.tinySDF=new Jt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:y,fontWeight:I})}const S=v.draw(String.fromCharCode(p));return{id:p,bitmap:new o.o({width:S.width||60,height:S.height||60},S.data),metrics:{width:S.glyphWidth/2||24,height:S.glyphHeight/2||24,left:S.glyphLeft/2+.5||0,top:S.glyphTop/2-27.5||-8,advance:S.glyphAdvance/2||24,isDoubleResolution:!0}}}}Jt.loadGlyphRange=function(m,l,A,p){return o._(this,void 0,void 0,function*(){const y=256*l,v=y+255,S=p.transformRequest(A.replace("{fontstack}",m).replace("{range}",`${y}-${v}`),"Glyphs"),I=yield o.l(S,new AbortController);if(!I||!I.data)throw new Error(`Could not load glyph range. range: ${l}, ${y}-${v}`);const M={};for(const D of o.n(I.data))M[D.id]=D;return M})},Jt.TinySDF=class{constructor(){let{fontSize:m=24,buffer:l=3,radius:A=8,cutoff:p=.25,fontFamily:y="sans-serif",fontWeight:v="normal",fontStyle:S="normal"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.buffer=l,this.cutoff=p,this.radius=A;const I=this.size=m+4*l,M=this._createCanvas(I),D=this.ctx=M.getContext("2d",{willReadFrequently:!0});D.font=`${S} ${v} ${m}px ${y}`,D.textBaseline="alphabetic",D.textAlign="left",D.fillStyle="black",this.gridOuter=new Float64Array(I*I),this.gridInner=new Float64Array(I*I),this.f=new Float64Array(I),this.z=new Float64Array(I+1),this.v=new Uint16Array(I)}_createCanvas(m){const l=document.createElement("canvas");return l.width=l.height=m,l}draw(m){const{width:l,actualBoundingBoxAscent:A,actualBoundingBoxDescent:p,actualBoundingBoxLeft:y,actualBoundingBoxRight:v}=this.ctx.measureText(m),S=Math.ceil(A),I=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-y))),M=Math.min(this.size-this.buffer,S+Math.ceil(p)),D=I+2*this.buffer,H=M+2*this.buffer,z=Math.max(D*H,0),$=new Uint8ClampedArray(z),J={data:$,width:D,height:H,glyphWidth:I,glyphHeight:M,glyphTop:S,glyphLeft:0,glyphAdvance:l};if(I===0||M===0)return J;const{ctx:K,buffer:tt,gridInner:At,gridOuter:pt}=this;K.clearRect(tt,tt,I,M),K.fillText(m,tt,tt+S);const _t=K.getImageData(tt,tt,I,M);pt.fill(vt,0,z),At.fill(0,0,z);for(let mt=0;mt<M;mt++)for(let Et=0;Et<I;Et++){const Dt=_t.data[4*(mt*I+Et)+3]/255;if(Dt===0)continue;const Rt=(mt+tt)*D+Et+tt;if(Dt===1)pt[Rt]=0,At[Rt]=vt;else{const oe=.5-Dt;pt[Rt]=oe>0?oe*oe:0,At[Rt]=oe<0?oe*oe:0}}$t(pt,0,0,D,H,D,this.f,this.v,this.z),$t(At,tt,tt,I,M,D,this.f,this.v,this.z);for(let mt=0;mt<z;mt++){const Et=Math.sqrt(pt[mt])-Math.sqrt(At[mt]);$[mt]=Math.round(255-255*(Et/this.radius+this.cutoff))}return J}};class qt{constructor(){this.specification=o.v.light.position}possiblyEvaluate(l,A){return o.x(l.expression.evaluate(A))}interpolate(l,A,p){return{x:o.y.number(l.x,A.x,p),y:o.y.number(l.y,A.y,p),z:o.y.number(l.z,A.z,p)}}}let te;class Yt extends o.E{constructor(l){super(),te=te||new o.q({anchor:new o.D(o.v.light.anchor),position:new qt,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.T(te),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this._validate(o.r,l,A))for(const p in l){const y=l[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),y):this._transitionable.setValue(p,y)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,A,p){return(!p||p.validate!==!1)&&o.t(this,l.call(o.u,{value:A,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}const be=new o.q({"sky-color":new o.D(o.v.sky["sky-color"]),"horizon-color":new o.D(o.v.sky["horizon-color"]),"fog-color":new o.D(o.v.sky["fog-color"]),"fog-ground-blend":new o.D(o.v.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.v.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.v.sky["atmosphere-blend"])});class it extends o.E{constructor(l){super(),this._transitionable=new o.T(be),this.setSky(l),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.z(0))}setSky(l){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this._validate(o.B,l,A)){l||(l={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const p in l){const y=l[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),y):this._transitionable.setValue(p,y)}}}getSky(){return this._transitionable.serialize()}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,A){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return(p==null?void 0:p.validate)!==!1&&o.t(this,l.call(o.u,o.e({value:A,style:{glyphs:!0,sprite:!0},styleSpec:o.v})))}calculateFogBlendOpacity(l){return l<60?0:l<70?(l-60)/10:1}}class wt{constructor(l,A){this.width=l,this.height=A,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(l,A){const p=l.join(",")+String(A);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(l,A)),this.dashEntry[p]}getDashRanges(l,A,p){const y=[];let v=l.length%2==1?-l[l.length-1]*p:0,S=l[0]*p,I=!0;y.push({left:v,right:S,isDash:I,zeroLength:l[0]===0});let M=l[0];for(let D=1;D<l.length;D++){I=!I;const H=l[D];v=M*p,M+=H,S=M*p,y.push({left:v,right:S,isDash:I,zeroLength:H===0})}return y}addRoundDash(l,A,p){const y=A/2;for(let v=-p;v<=p;v++){const S=this.width*(this.nextRow+p+v);let I=0,M=l[I];for(let D=0;D<this.width;D++){D/M.right>1&&(M=l[++I]);const H=Math.abs(D-M.left),z=Math.abs(D-M.right),$=Math.min(H,z);let J;const K=v/p*(y+1);if(M.isDash){const tt=y-Math.abs(K);J=Math.sqrt($*$+tt*tt)}else J=y-Math.sqrt($*$+K*K);this.data[S+D]=Math.max(0,Math.min(255,J+128))}}}addRegularDash(l){for(let I=l.length-1;I>=0;--I){const M=l[I],D=l[I+1];M.zeroLength?l.splice(I,1):D&&D.isDash===M.isDash&&(D.left=M.left,l.splice(I,1))}const A=l[0],p=l[l.length-1];A.isDash===p.isDash&&(A.left=p.left-this.width,p.right=A.right+this.width);const y=this.width*this.nextRow;let v=0,S=l[v];for(let I=0;I<this.width;I++){I/S.right>1&&(S=l[++v]);const M=Math.abs(I-S.left),D=Math.abs(I-S.right),H=Math.min(M,D);this.data[y+I]=Math.max(0,Math.min(255,(S.isDash?H:-H)+128))}}addDash(l,A){const p=A?7:0,y=2*p+1;if(this.nextRow+y>this.height)return o.w("LineAtlas out of space"),null;let v=0;for(let I=0;I<l.length;I++)v+=l[I];if(v!==0){const I=this.width/v,M=this.getDashRanges(l,this.width,I);A?this.addRoundDash(M,I,p):this.addRegularDash(M)}const S={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:v};return this.nextRow+=y,this.dirty=!0,S}bind(l){const A=l.gl;this.texture?(A.bindTexture(A.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,A.texSubImage2D(A.TEXTURE_2D,0,0,0,this.width,this.height,A.ALPHA,A.UNSIGNED_BYTE,this.data))):(this.texture=A.createTexture(),A.bindTexture(A.TEXTURE_2D,this.texture),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,A.REPEAT),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,A.REPEAT),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,A.LINEAR),A.texImage2D(A.TEXTURE_2D,0,A.ALPHA,this.width,this.height,0,A.ALPHA,A.UNSIGNED_BYTE,this.data))}}const Ft="maplibre_preloaded_worker_pool";class Ut{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<Ut.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(A=>{A.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ft]}numActive(){return Object.keys(this.active).length}}const jt=Math.floor(w.hardwareConcurrency/2);let Vt,re;function Zt(){return Vt||(Vt=new Ut),Vt}Ut.workerCount=o.C(globalThis)?Math.max(Math.min(jt,3),1):1;class Be{constructor(l,A){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=A;const p=this.workerPool.acquire(A);for(let y=0;y<p.length;y++){const v=new o.F(p[y],A);v.name=`Worker ${y}`,this.actors.push(v)}if(!this.actors.length)throw new Error("No actors found")}broadcast(l,A){const p=[];for(const y of this.actors)p.push(y.sendAsync({type:l,data:A}));return Promise.all(p)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.actors.forEach(A=>{A.remove()}),this.actors=[],l&&this.workerPool.release(this.id)}registerMessageHandler(l,A){for(const p of this.actors)p.registerMessageHandler(l,A)}}function Ie(){return re||(re=new Be(Zt(),o.G),re.registerMessageHandler("GR",(m,l,A)=>o.m(l,A))),re}function ke(m,l){const A=o.H();return o.J(A,A,[1,1,0]),o.K(A,A,[.5*m.width,.5*m.height,1]),o.L(A,A,m.calculatePosMatrix(l.toUnwrapped()))}function He(m,l,A,p,y,v){const S=function(z,$,J){if(z)for(const K of z){const tt=$[K];if(tt&&tt.source===J&&tt.type==="fill-extrusion")return!0}else for(const K in $){const tt=$[K];if(tt.source===J&&tt.type==="fill-extrusion")return!0}return!1}(y&&y.layers,l,m.id),I=v.maxPitchScaleFactor(),M=m.tilesIn(p,I,S);M.sort(Ke);const D=[];for(const z of M)D.push({wrappedTileID:z.tileID.wrapped().key,queryResults:z.tile.queryRenderedFeatures(l,A,m._state,z.queryGeometry,z.cameraQueryGeometry,z.scale,y,v,I,ke(m.transform,z.tileID))});const H=function(z){const $={},J={};for(const K of z){const tt=K.queryResults,At=K.wrappedTileID,pt=J[At]=J[At]||{};for(const _t in tt){const mt=tt[_t],Et=pt[_t]=pt[_t]||{},Dt=$[_t]=$[_t]||[];for(const Rt of mt)Et[Rt.featureIndex]||(Et[Rt.featureIndex]=!0,Dt.push(Rt))}}return $}(D);for(const z in H)H[z].forEach($=>{const J=$.feature,K=m.getFeatureState(J.layer["source-layer"],J.id);J.source=J.layer.source,J.layer["source-layer"]&&(J.sourceLayer=J.layer["source-layer"]),J.state=K});return H}function Ke(m,l){const A=m.tileID,p=l.tileID;return A.overscaledZ-p.overscaledZ||A.canonical.y-p.canonical.y||A.wrap-p.wrap||A.canonical.x-p.canonical.x}function le(m,l,A){return o._(this,void 0,void 0,function*(){let p=m;if(m.url?p=(yield o.h(l.transformRequest(m.url,"Source"),A)).data:yield w.frameAsync(A),!p)return null;const y=o.M(o.e(p,m),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in p&&p.vector_layers&&(y.vectorLayerIds=p.vector_layers.map(v=>v.id)),y})}class st{constructor(l,A){l&&(A?this.setSouthWest(l).setNorthEast(A):Array.isArray(l)&&(l.length===4?this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]]):this.setSouthWest(l[0]).setNorthEast(l[1])))}setNorthEast(l){return this._ne=l instanceof o.N?new o.N(l.lng,l.lat):o.N.convert(l),this}setSouthWest(l){return this._sw=l instanceof o.N?new o.N(l.lng,l.lat):o.N.convert(l),this}extend(l){const A=this._sw,p=this._ne;let y,v;if(l instanceof o.N)y=l,v=l;else{if(!(l instanceof st))return Array.isArray(l)?l.length===4||l.every(Array.isArray)?this.extend(st.convert(l)):this.extend(o.N.convert(l)):l&&("lng"in l||"lon"in l)&&"lat"in l?this.extend(o.N.convert(l)):this;if(y=l._sw,v=l._ne,!y||!v)return this}return A||p?(A.lng=Math.min(y.lng,A.lng),A.lat=Math.min(y.lat,A.lat),p.lng=Math.max(v.lng,p.lng),p.lat=Math.max(v.lat,p.lat)):(this._sw=new o.N(y.lng,y.lat),this._ne=new o.N(v.lng,v.lat)),this}getCenter(){return new o.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.N(this.getWest(),this.getNorth())}getSouthEast(){return new o.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(l){const{lng:A,lat:p}=o.N.convert(l);let y=this._sw.lng<=A&&A<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=A&&A>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&y}static convert(l){return l instanceof st?l:l&&new st(l)}static fromLngLat(l){const p=360*(arguments.length>1&&arguments[1]!==void 0?arguments[1]:0)/40075017,y=p/Math.cos(Math.PI/180*l.lat);return new st(new o.N(l.lng-y,l.lat-p),new o.N(l.lng+y,l.lat+p))}adjustAntiMeridian(){const l=new o.N(this._sw.lng,this._sw.lat),A=new o.N(this._ne.lng,this._ne.lat);return new st(l,l.lng>A.lng?new o.N(A.lng+360,A.lat):A)}}class pr{constructor(l,A,p){this.bounds=st.convert(this.validateBounds(l)),this.minzoom=A||0,this.maxzoom=p||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const A=Math.pow(2,l.z),p=Math.floor(o.O(this.bounds.getWest())*A),y=Math.floor(o.Q(this.bounds.getNorth())*A),v=Math.ceil(o.O(this.bounds.getEast())*A),S=Math.ceil(o.Q(this.bounds.getSouth())*A);return l.x>=p&&l.x<v&&l.y>=y&&l.y<S}}class Ye extends o.E{constructor(l,A,p,y){if(super(),this.id=l,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.M(A,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},A),this._collectResourceTiming=A.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y)}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield le(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),l&&(o.e(this,l),l.bounds&&(this.tileBounds=new pr(l.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(l){this._tileJSONRequest=null,this.fire(new o.j(l))}})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.abort(),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(l){return o._(this,void 0,void 0,function*(){const A=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(A,"Tile"),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};p.request.collectResourceTiming=this._collectResourceTiming;let y="RT";if(l.actor&&l.state!=="expired"){if(l.state==="loading")return new Promise((v,S)=>{l.reloadPromise={resolve:v,reject:S}})}else l.actor=this.dispatcher.getActor(),y="LT";l.abortController=new AbortController;try{const v=yield l.actor.sendAsync({type:y,data:p},l.abortController);if(delete l.abortController,l.aborted)return;this._afterTileLoadWorkerResponse(l,v)}catch(v){if(delete l.abortController,l.aborted)return;if(v&&v.status!==404)throw v;this._afterTileLoadWorkerResponse(l,null)}})}_afterTileLoadWorkerResponse(l,A){if(A&&A.resourceTiming&&(l.resourceTiming=A.resourceTiming),A&&this.map._refreshExpiredTiles&&l.setExpiryData(A),l.loadVectorData(A,this.map.painter),l.reloadPromise){const p=l.reloadPromise;l.reloadPromise=null,this.loadTile(l).then(p.resolve).catch(p.reject)}}abortTile(l){return o._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.actor&&(yield l.actor.sendAsync({type:"AT",data:{uid:l.uid,type:this.type,source:this.id}}))})}unloadTile(l){return o._(this,void 0,void 0,function*(){l.unloadVectorData(),l.actor&&(yield l.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class ue extends o.E{constructor(l,A,p,y){super(),this.id=l,this.dispatcher=p,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},A),o.e(this,o.M(A,["url","scheme","tileSize"]))}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield le(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,l&&(o.e(this,l),l.bounds&&(this.tileBounds=new pr(l.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(l){this._tileJSONRequest=null,this.fire(new o.j(l))}})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(l){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}serialize(){return o.e({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l){return o._(this,void 0,void 0,function*(){const A=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);l.abortController=new AbortController;try{const p=yield W.getImage(this.map._requestManager.transformRequest(A,"Tile"),l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(p&&p.data){this.map._refreshExpiredTiles&&p.cacheControl&&p.expires&&l.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});const y=this.map.painter.context,v=y.gl,S=p.data;l.texture=this.map.painter.getTileTexture(S.width),l.texture?l.texture.update(S,{useMipmap:!0}):(l.texture=new ot(y,S,v.RGBA,{useMipmap:!0}),l.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE,v.LINEAR_MIPMAP_NEAREST)),l.state="loaded"}}catch(p){if(delete l.abortController,l.aborted)l.state="unloaded";else if(p)throw l.state="errored",p}})}abortTile(l){return o._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController)})}unloadTile(l){return o._(this,void 0,void 0,function*(){l.texture&&this.map.painter.saveTileTexture(l.texture)})}hasTransition(){return!1}}class ye extends ue{constructor(l,A,p,y){super(l,A,p,y),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},A),this.encoding=A.encoding||"mapbox",this.redFactor=A.redFactor,this.greenFactor=A.greenFactor,this.blueFactor=A.blueFactor,this.baseShift=A.baseShift}loadTile(l){return o._(this,void 0,void 0,function*(){const A=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p=this.map._requestManager.transformRequest(A,"Tile");l.neighboringTiles=this._getNeighboringTiles(l.tileID),l.abortController=new AbortController;try{const y=yield W.getImage(p,l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(y&&y.data){const v=y.data;this.map._refreshExpiredTiles&&y.cacheControl&&y.expires&&l.setExpiryData({cacheControl:y.cacheControl,expires:y.expires});const S=o.b(v)&&o.U()?v:yield this.readImageNow(v),I={type:this.type,uid:l.uid,source:this.id,rawImageData:S,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!l.actor||l.state==="expired"){l.actor=this.dispatcher.getActor();const M=yield l.actor.sendAsync({type:"LDT",data:I});l.dem=M,l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0,l.state="loaded"}}}catch(y){if(delete l.abortController,l.aborted)l.state="unloaded";else if(y)throw l.state="errored",y}})}readImageNow(l){return o._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&o.V()){const A=l.width+2,p=l.height+2;try{return new o.R({width:A,height:p},yield o.W(l,-1,-1,A,p))}catch{}}return w.getImageData(l,1)})}_getNeighboringTiles(l){const A=l.canonical,p=Math.pow(2,A.z),y=(A.x-1+p)%p,v=A.x===0?l.wrap-1:l.wrap,S=(A.x+1+p)%p,I=A.x+1===p?l.wrap+1:l.wrap,M={};return M[new o.S(l.overscaledZ,v,A.z,y,A.y).key]={backfilled:!1},M[new o.S(l.overscaledZ,I,A.z,S,A.y).key]={backfilled:!1},A.y>0&&(M[new o.S(l.overscaledZ,v,A.z,y,A.y-1).key]={backfilled:!1},M[new o.S(l.overscaledZ,l.wrap,A.z,A.x,A.y-1).key]={backfilled:!1},M[new o.S(l.overscaledZ,I,A.z,S,A.y-1).key]={backfilled:!1}),A.y+1<p&&(M[new o.S(l.overscaledZ,v,A.z,y,A.y+1).key]={backfilled:!1},M[new o.S(l.overscaledZ,l.wrap,A.z,A.x,A.y+1).key]={backfilled:!1},M[new o.S(l.overscaledZ,I,A.z,S,A.y+1).key]={backfilled:!1}),M}unloadTile(l){return o._(this,void 0,void 0,function*(){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&(yield l.actor.sendAsync({type:"RDT",data:{type:this.type,uid:l.uid,source:this.id}}))})}}class Le extends o.E{constructor(l,A,p,y){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=p.getActor(),this.setEventedParent(y),this._data=A.data,this._options=o.e({},A),this._collectResourceTiming=A.collectResourceTiming,A.maxzoom!==void 0&&(this.maxzoom=A.maxzoom),A.type&&(this.type=A.type),A.attribution&&(this.attribution=A.attribution),this.promoteId=A.promoteId;const v=o.X/this.tileSize;A.clusterMaxZoom!==void 0&&this.maxzoom<=A.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${A.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:A.cluster||!1,geojsonVtOptions:{buffer:(A.buffer!==void 0?A.buffer:128)*v,tolerance:(A.tolerance!==void 0?A.tolerance:.375)*v,extent:o.X,maxZoom:this.maxzoom,lineMetrics:A.lineMetrics||!1,generateId:A.generateId||!1},superclusterOptions:{maxZoom:A.clusterMaxZoom!==void 0?A.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,A.clusterMinPoints||2),extent:o.X,radius:(A.clusterRadius||50)*v,log:!1,generateId:A.generateId||!1},clusterProperties:A.clusterProperties,filter:A.filter},A.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return o._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(l){this.map=l,this.load()}setData(l){return this._data=l,this._updateWorkerData(),this}updateData(l){return this._updateWorkerData(l),this}getData(){return o._(this,void 0,void 0,function*(){const l=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:l})})}setClusterOptions(l){return this.workerOptions.cluster=l.cluster,l&&(l.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=l.clusterRadius),l.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=l.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(l){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:l,source:this.id}})}getClusterChildren(l){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:l,source:this.id}})}getClusterLeaves(l,A,p){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:l,limit:A,offset:p}})}_updateWorkerData(l){return o._(this,void 0,void 0,function*(){const A=o.e({type:this.type},this.workerOptions);l?A.dataDiff=l:typeof this._data=="string"?(A.request=this.map._requestManager.transformRequest(w.resolveURL(this._data),"Source"),A.request.collectResourceTiming=this._collectResourceTiming):A.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new o.k("dataloading",{dataType:"source"}));try{const p=yield this.actor.sendAsync({type:"LD",data:A});if(this._pendingLoads--,this._removed||p.abandoned)return void this.fire(new o.k("dataabort",{dataType:"source"}));let y=null;p.resourceTiming&&p.resourceTiming[this.id]&&(y=p.resourceTiming[this.id].slice(0));const v={dataType:"source"};this._collectResourceTiming&&y&&y.length>0&&o.e(v,{resourceTiming:y}),this.fire(new o.k("data",Object.assign(Object.assign({},v),{sourceDataType:"metadata"}))),this.fire(new o.k("data",Object.assign(Object.assign({},v),{sourceDataType:"content"})))}catch(p){if(this._pendingLoads--,this._removed)return void this.fire(new o.k("dataabort",{dataType:"source"}));this.fire(new o.j(p))}})}loaded(){return this._pendingLoads===0}loadTile(l){return o._(this,void 0,void 0,function*(){const A=l.actor?"RT":"LT";l.actor=this.actor;const p={type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};l.abortController=new AbortController;const y=yield this.actor.sendAsync({type:A,data:p},l.abortController);delete l.abortController,l.unloadVectorData(),l.aborted||l.loadVectorData(y,this.map.painter,A==="RT")})}abortTile(l){return o._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.aborted=!0})}unloadTile(l){return o._(this,void 0,void 0,function*(){l.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Oe=o.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class We extends o.E{constructor(l,A,p,y){super(),this.id=l,this.dispatcher=p,this.coordinates=A.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=A}load(l){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const A=yield W.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,A&&A.data&&(this.image=A.data,l&&(this.coordinates=l),this._finishLoading())}catch(A){this._request=null,this._loaded=!0,this.fire(new o.j(A))}})}loaded(){return this._loaded}updateImage(l){return l.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=l.url,this.load(l.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(l){this.coordinates=l;const A=l.map(o.Z.fromLngLat);this.tileID=function(y){let v=1/0,S=1/0,I=-1/0,M=-1/0;for(const $ of y)v=Math.min(v,$.x),S=Math.min(S,$.y),I=Math.max(I,$.x),M=Math.max(M,$.y);const D=Math.max(I-v,M-S),H=Math.max(0,Math.floor(-Math.log(D)/Math.LN2)),z=Math.pow(2,H);return new o.a1(H,Math.floor((v+I)/2*z),Math.floor((S+M)/2*z))}(A),this.minzoom=this.maxzoom=this.tileID.z;const p=A.map(y=>this.tileID.getTilePoint(y)._round());return this._boundsArray=new o.$,this._boundsArray.emplaceBack(p[0].x,p[0].y,0,0),this._boundsArray.emplaceBack(p[1].x,p[1].y,o.X,0),this._boundsArray.emplaceBack(p[3].x,p[3].y,0,o.X),this._boundsArray.emplaceBack(p[2].x,p[2].y,o.X,o.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const l=this.map.painter.context,A=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Oe.members)),this.boundsSegments||(this.boundsSegments=o.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ot(l,this.image,A.RGBA),this.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE));let p=!1;for(const y in this.tiles){const v=this.tiles[y];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,p=!0)}p&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(l){return o._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={}):l.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class cr extends We{constructor(l,A,p,y){super(l,A,p,y),this.roundZoom=!0,this.type="video",this.options=A}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1;const l=this.options;this.urls=[];for(const A of l.urls)this.urls.push(this.map._requestManager.transformRequest(A,"Source").url);try{const A=yield o.a3(this.urls);if(this._loaded=!0,!A)return;this.video=A,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(A){this.fire(new o.j(A))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const A=this.video.seekable;l<A.start(0)||l>A.end(0)?this.fire(new o.j(new o.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${A.start(0)} and ${A.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const l=this.map.painter.context,A=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Oe.members)),this.boundsSegments||(this.boundsSegments=o.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE),A.texSubImage2D(A.TEXTURE_2D,0,0,0,A.RGBA,A.UNSIGNED_BYTE,this.video)):(this.texture=new ot(l,this.video,A.RGBA),this.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE));let p=!1;for(const y in this.tiles){const v=this.tiles[y];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,p=!0)}p&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class yr extends We{constructor(l,A,p,y){super(l,A,p,y),A.coordinates?Array.isArray(A.coordinates)&&A.coordinates.length===4&&!A.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(S=>typeof S!="number"))||this.fire(new o.j(new o.a2(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.j(new o.a2(`sources.${l}`,null,'missing required property "coordinates"'))),A.animate&&typeof A.animate!="boolean"&&this.fire(new o.j(new o.a2(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),A.canvas?typeof A.canvas=="string"||A.canvas instanceof HTMLCanvasElement||this.fire(new o.j(new o.a2(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.j(new o.a2(`sources.${l}`,null,'missing required property "canvas"'))),this.options=A,this.animate=A.animate===void 0||A.animate}load(){return o._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const A=this.map.painter.context,p=A.gl;this.boundsBuffer||(this.boundsBuffer=A.createVertexBuffer(this._boundsArray,Oe.members)),this.boundsSegments||(this.boundsSegments=o.a0.simpleSegment(0,0,4,2)),this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ot(A,this.canvas,p.RGBA,{premultiply:!0});let y=!1;for(const v in this.tiles){const S=this.tiles[v];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,y=!0)}y&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}}const Fr={},Ur=m=>{switch(m){case"geojson":return Le;case"image":return We;case"raster":return ue;case"raster-dem":return ye;case"vector":return Ye;case"video":return cr;case"canvas":return yr}return Fr[m]},de="RTLPluginLoaded";class ur extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Ie()}_syncState(l){return this.status=l,this.dispatcher.broadcast("SRPS",{pluginStatus:l,pluginURL:this.url}).catch(A=>{throw this.status="error",A})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(l){return o._(this,arguments,void 0,function(A){var p=this;let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(p.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(p.url=w.resolveURL(A),!p.url)throw new Error(`requested url ${A} is invalid`);if(p.status==="unavailable"){if(!y)return p._requestImport();p.status="deferred",p._syncState(p.status)}else if(p.status==="requested")return p._requestImport()}()})}_requestImport(){return o._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.k(de))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let _r=null;function De(){return _r||(_r=new ur),_r}class gn{constructor(l,A){this.timeAdded=0,this.fadeEndTime=0,this.tileID=l,this.uid=o.a4(),this.uses=0,this.tileSize=A,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(l){const A=l+this.timeAdded;A<this.fadeEndTime||(this.fadeEndTime=A)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(l){this.demTexture&&l.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(l,A,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(y,v){const S={};if(!v)return S;for(const I of y){const M=I.layerIds.map(D=>v.getLayer(D)).filter(Boolean);if(M.length!==0){I.layers=M,I.stateDependentLayerIds&&(I.stateDependentLayers=I.stateDependentLayerIds.map(D=>M.filter(H=>H.id===D)[0]));for(const D of M)S[D.id]=I}}return S}(l.buckets,A.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const v=this.buckets[y];if(v instanceof o.a6){if(this.hasSymbolBuckets=!0,!p)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const v=this.buckets[y];if(v instanceof o.a6&&v.hasRTLText){this.hasRTLText=!0,De().lazyLoad();break}}this.queryPadding=0;for(const y in this.buckets){const v=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,A.style.getLayer(y).queryRadius(v))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage)}else this.collisionBoxArray=new o.a5}unloadVectorData(){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(l){return this.buckets[l.id]}upload(l){for(const p in this.buckets){const y=this.buckets[p];y.uploadPending()&&y.upload(l)}const A=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ot(l,this.imageAtlas.image,A.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ot(l,this.glyphAtlasImage,A.ALPHA),this.glyphAtlasImage=null)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,A,p,y,v,S,I,M,D,H){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:y,cameraQueryGeometry:v,scale:S,tileSize:this.tileSize,pixelPosMatrix:H,transform:M,params:I,queryPadding:this.queryPadding*D},l,A,p):{}}querySourceFeatures(l,A){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const y=p.loadVTLayers(),v=A&&A.sourceLayer?A.sourceLayer:"",S=y._geojsonTileLayer||y[v];if(!S)return;const I=o.a7(A&&A.filter),{z:M,x:D,y:H}=this.tileID.canonical,z={z:M,x:D,y:H};for(let $=0;$<S.length;$++){const J=S.feature($);if(I.needGeometry){const At=o.a8(J,!0);if(!I.filter(new o.z(this.tileID.overscaledZ),At,this.tileID.canonical))continue}else if(!I.filter(new o.z(this.tileID.overscaledZ),J))continue;const K=p.getId(J,v),tt=new o.a9(J,M,D,H,K);tt.tile=z,l.push(tt)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const A=this.expirationTime;if(l.cacheControl){const p=o.aa(l.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const p=Date.now();let y=!1;if(this.expirationTime>p)y=!1;else if(A)if(this.expirationTime<A)y=!0;else{const v=this.expirationTime-A;v?this.expirationTime=p+Math.max(v,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,A){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0)return;const p=this.latestFeatureIndex.loadVTLayers();for(const y in this.buckets){if(!A.style.hasLayer(y))continue;const v=this.buckets[y],S=v.layers[0].sourceLayer||"_geojsonTileLayer",I=p[S],M=l[S];if(!I||!M||Object.keys(M).length===0)continue;v.update(M,I,this.imageAtlas&&this.imageAtlas.patternPositions||{});const D=A&&A.style&&A.style.getLayer(y);D&&(this.queryPadding=Math.max(this.queryPadding,D.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<w.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=w.now()+l}setDependencies(l,A){const p={};for(const y of A)p[y]=!0;this.dependencies[l]=p}hasDependency(l,A){for(const p of l){const y=this.dependencies[p];if(y){for(const v of A)if(y[v])return!0}}return!1}}class pe{constructor(l,A){this.max=l,this.onRemove=A,this.reset()}reset(){for(const l in this.data)for(const A of this.data[l])A.timeout&&clearTimeout(A.timeout),this.onRemove(A.value);return this.data={},this.order=[],this}add(l,A,p){const y=l.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);const v={value:A,timeout:void 0};if(p!==void 0&&(v.timeout=setTimeout(()=>{this.remove(l,v)},p)),this.data[y].push(v),this.order.push(y),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const A=this.data[l].shift();return A.timeout&&clearTimeout(A.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),A.value}getByKey(l){const A=this.data[l];return A?A[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,A){if(!this.has(l))return this;const p=l.wrapped().key,y=A===void 0?0:this.data[p].indexOf(A),v=this.data[p][y];return this.data[p].splice(y,1),v.timeout&&clearTimeout(v.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(v.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const A=this._getAndRemoveByKey(this.order[0]);A&&this.onRemove(A)}return this}filter(l){const A=[];for(const p in this.data)for(const y of this.data[p])l(y.value)||A.push(y);for(const p of A)this.remove(p.value.tileID,p)}}class gr{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,A,p){const y=String(A);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][y]=this.stateChanges[l][y]||{},o.e(this.stateChanges[l][y],p),this.deletedStates[l]===null){this.deletedStates[l]={};for(const v in this.state[l])v!==y&&(this.deletedStates[l][v]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][y]===null){this.deletedStates[l][y]={};for(const v in this.state[l][y])p[v]||(this.deletedStates[l][y][v]=null)}else for(const v in p)this.deletedStates[l]&&this.deletedStates[l][y]&&this.deletedStates[l][y][v]===null&&delete this.deletedStates[l][y][v]}removeFeatureState(l,A,p){if(this.deletedStates[l]===null)return;const y=String(A);if(this.deletedStates[l]=this.deletedStates[l]||{},p&&A!==void 0)this.deletedStates[l][y]!==null&&(this.deletedStates[l][y]=this.deletedStates[l][y]||{},this.deletedStates[l][y][p]=null);else if(A!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][y])for(p in this.deletedStates[l][y]={},this.stateChanges[l][y])this.deletedStates[l][y][p]=null;else this.deletedStates[l][y]=null;else this.deletedStates[l]=null}getState(l,A){const p=String(A),y=o.e({},(this.state[l]||{})[p],(this.stateChanges[l]||{})[p]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){const v=this.deletedStates[l][A];if(v===null)return{};for(const S in v)delete y[S]}return y}initializeTileState(l,A){l.setFeatureState(this.state,A)}coalesceChanges(l,A){const p={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const v={};for(const S in this.stateChanges[y])this.state[y][S]||(this.state[y][S]={}),o.e(this.state[y][S],this.stateChanges[y][S]),v[S]=this.state[y][S];p[y]=v}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const v={};if(this.deletedStates[y]===null)for(const S in this.state[y])v[S]={},this.state[y][S]={};else for(const S in this.deletedStates[y]){if(this.deletedStates[y][S]===null)this.state[y][S]={};else for(const I of Object.keys(this.deletedStates[y][S]))delete this.state[y][S][I];v[S]=this.state[y][S]}p[y]=p[y]||{},o.e(p[y],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const y in l)l[y].setFeatureState(p,A)}}class Qe extends o.E{constructor(l,A,p){super(),this.id=l,this.dispatcher=p,this.on("data",y=>this._dataHandler(y)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((y,v,S,I)=>{const M=new(Ur(v.type))(y,v,S,I);if(M.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${M.id}`);return M})(l,A,p,this),this._tiles={},this._cache=new pe(0,y=>this._unloadTile(y)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new gr,this._didEmitContent=!1,this._updated=!1}onAdd(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._maxTileCacheZoomLevels=l?l._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(l)}onRemove(l){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(l)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const l in this._tiles){const A=this._tiles[l];if(A.state!=="loaded"&&A.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(l,A,p){return o._(this,void 0,void 0,function*(){try{yield this._source.loadTile(l),this._tileLoaded(l,A,p)}catch(y){l.state="errored",y.status!==404?this._source.fire(new o.j(y,{tile:l})):this.update(this.transform,this.terrain)}})}_unloadTile(l){this._source.unloadTile&&this._source.unloadTile(l)}_abortTile(l){this._source.abortTile&&this._source.abortTile(l),this._source.fire(new o.k("dataabort",{tile:l,coord:l.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const A in this._tiles){const p=this._tiles[A];p.upload(l),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(l=>l.tileID).sort(Mr).map(l=>l.key)}getRenderableIds(l){const A=[];for(const p in this._tiles)this._isIdRenderable(p,l)&&A.push(this._tiles[p]);return l?A.sort((p,y)=>{const v=p.tileID,S=y.tileID,I=new o.P(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),M=new o.P(S.canonical.x,S.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-S.overscaledZ||M.y-I.y||M.x-I.x}).map(p=>p.tileID.key):A.map(p=>p.tileID).sort(Mr).map(p=>p.key)}hasRenderableParent(l){const A=this.findLoadedParent(l,0);return!!A&&this._isIdRenderable(A.tileID.key)}_isIdRenderable(l,A){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(A||!this._tiles[l].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading")}}_reloadTile(l,A){return o._(this,void 0,void 0,function*(){const p=this._tiles[l];p&&(p.state!=="loading"&&(p.state=A),yield this._loadTile(p,l,A))})}_tileLoaded(l,A,p){l.timeAdded=w.now(),p==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(A,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),l.aborted||this._source.fire(new o.k("data",{dataType:"source",tile:l,coord:l.tileID}))}_backfillDEM(l){const A=this.getRenderableIds();for(let y=0;y<A.length;y++){const v=A[y];if(l.neighboringTiles&&l.neighboringTiles[v]){const S=this.getTileByID(v);p(l,S),p(S,l)}}function p(y,v){y.needsHillshadePrepare=!0,y.needsTerrainPrepare=!0;let S=v.tileID.canonical.x-y.tileID.canonical.x;const I=v.tileID.canonical.y-y.tileID.canonical.y,M=Math.pow(2,y.tileID.canonical.z),D=v.tileID.key;S===0&&I===0||Math.abs(I)>1||(Math.abs(S)>1&&(Math.abs(S+M)===1?S+=M:Math.abs(S-M)===1&&(S-=M)),v.dem&&y.dem&&(y.dem.backfillBorder(v.dem,S,I),y.neighboringTiles&&y.neighboringTiles[D]&&(y.neighboringTiles[D].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,A,p,y){for(const v in this._tiles){let S=this._tiles[v];if(y[v]||!S.hasData()||S.tileID.overscaledZ<=A||S.tileID.overscaledZ>p)continue;let I=S.tileID;for(;S&&S.tileID.overscaledZ>A+1;){const D=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[D.key],S&&S.hasData()&&(I=D)}let M=I;for(;M.overscaledZ>A;)if(M=M.scaledTo(M.overscaledZ-1),l[M.key]){y[I.key]=I;break}}}findLoadedParent(l,A){if(l.key in this._loadedParentTiles){const p=this._loadedParentTiles[l.key];return p&&p.tileID.overscaledZ>=A?p:null}for(let p=l.overscaledZ-1;p>=A;p--){const y=l.scaledTo(p),v=this._getLoadedTile(y);if(v)return v}}findLoadedSibling(l){return this._getLoadedTile(l)}_getLoadedTile(l){const A=this._tiles[l.key];return A&&A.hasData()?A:this._cache.getByKey(l.wrapped().key)}updateCacheSize(l){const A=Math.ceil(l.width/this._source.tileSize)+1,p=Math.ceil(l.height/this._source.tileSize)+1,y=Math.floor(A*p*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(v)}handleWrapJump(l){const A=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,A){const p={};for(const y in this._tiles){const v=this._tiles[y];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+A),p[v.tileID.key]=v}this._tiles=p;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(y,this._tiles[y])}}_updateCoveredAndRetainedTiles(l,A,p,y,v,S){const I={},M={},D=Object.keys(l),H=w.now();for(const z of D){const $=l[z],J=this._tiles[z];if(!J||J.fadeEndTime!==0&&J.fadeEndTime<=H)continue;const K=this.findLoadedParent($,A),tt=this.findLoadedSibling($),At=K||tt||null;At&&(this._addTile(At.tileID),I[At.tileID.key]=At.tileID),M[z]=$}this._retainLoadedChildren(M,y,p,l);for(const z in I)l[z]||(this._coveredTiles[z]=!0,l[z]=I[z]);if(S){const z={},$={};for(const J of v)this._tiles[J.key].hasData()?z[J.key]=J:$[J.key]=J;for(const J in $){const K=$[J].children(this._source.maxzoom);this._tiles[K[0].key]&&this._tiles[K[1].key]&&this._tiles[K[2].key]&&this._tiles[K[3].key]&&(z[K[0].key]=l[K[0].key]=K[0],z[K[1].key]=l[K[1].key]=K[1],z[K[2].key]=l[K[2].key]=K[2],z[K[3].key]=l[K[3].key]=K[3],delete $[J])}for(const J in $){const K=$[J],tt=this.findLoadedParent(K,this._source.minzoom),At=this.findLoadedSibling(K),pt=tt||At||null;if(pt){z[pt.tileID.key]=l[pt.tileID.key]=pt.tileID;for(const _t in z)z[_t].isChildOf(pt.tileID)&&delete z[_t]}}for(const J in this._tiles)z[J]||(this._coveredTiles[J]=!0)}}update(l,A){if(!this._sourceLoaded||this._paused)return;let p;this.transform=l,this.terrain=A,this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(H=>new o.S(H.canonical.z,H.wrap,H.canonical.z,H.canonical.x,H.canonical.y)):(p=l.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:A}),this._source.hasTile&&(p=p.filter(H=>this._source.hasTile(H)))):p=[];const y=l.coveringZoomLevel(this._source),v=Math.max(y-Qe.maxOverzooming,this._source.minzoom),S=Math.max(y+Qe.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const H={};for(const z of p)if(z.canonical.z>this._source.minzoom){const $=z.scaledTo(z.canonical.z-1);H[$.key]=$;const J=z.scaledTo(Math.max(this._source.minzoom,Math.min(z.canonical.z,5)));H[J.key]=J}p=p.concat(Object.values(H))}const I=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,I&&this.fire(new o.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const M=this._updateRetainedTiles(p,y);_n(this._source.type)&&this._updateCoveredAndRetainedTiles(M,v,S,y,p,A);for(const H in M)this._tiles[H].clearFadeHold();const D=o.ab(this._tiles,M);for(const H of D){const z=this._tiles[H];z.hasSymbolBuckets&&!z.holdingForFade()?z.setHoldDuration(this.map._fadeDuration):z.hasSymbolBuckets&&!z.symbolFadeFinished()||this._removeTile(H)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)}_updateRetainedTiles(l,A){var p;const y={},v={},S=Math.max(A-Qe.maxOverzooming,this._source.minzoom),I=Math.max(A+Qe.maxUnderzooming,this._source.minzoom),M={};for(const D of l){const H=this._addTile(D);y[D.key]=D,H.hasData()||A<this._source.maxzoom&&(M[D.key]=D)}this._retainLoadedChildren(M,A,I,y);for(const D of l){let H=this._tiles[D.key];if(H.hasData())continue;if(A+1>this._source.maxzoom){const $=D.children(this._source.maxzoom)[0],J=this.getTile($);if(J&&J.hasData()){y[$.key]=$;continue}}else{const $=D.children(this._source.maxzoom);if(y[$[0].key]&&y[$[1].key]&&y[$[2].key]&&y[$[3].key])continue}let z=H.wasRequested();for(let $=D.overscaledZ-1;$>=S;--$){const J=D.scaledTo($);if(v[J.key])break;if(v[J.key]=!0,H=this.getTile(J),!H&&z&&(H=this._addTile(J)),H){const K=H.hasData();if((K||!(!((p=this.map)===null||p===void 0)&&p.cancelPendingTileRequestsWhileZooming)||z)&&(y[J.key]=J),z=H.wasRequested(),K)break}}}return y}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const l in this._tiles){const A=[];let p,y=this._tiles[l].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){p=this._loadedParentTiles[y.key];break}A.push(y.key);const v=y.scaledTo(y.overscaledZ-1);if(p=this._getLoadedTile(v),p)break;y=v}for(const v of A)this._loadedParentTiles[v]=p}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const l in this._tiles){const A=this._tiles[l].tileID,p=this._getLoadedTile(A);this._loadedSiblingTiles[A.key]=p}}_addTile(l){let A=this._tiles[l.key];if(A)return A;A=this._cache.getAndRemove(l),A&&(this._setTileReloadTimer(l.key,A),A.tileID=l,this._state.initializeTileState(A,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,A)));const p=A;return A||(A=new gn(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(A,l.key,A.state)),A.uses++,this._tiles[l.key]=A,p||this._source.fire(new o.k("dataloading",{tile:A,coord:A.tileID,dataType:"source"})),A}_setTileReloadTimer(l,A){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);const p=A.getExpiryTimeout();p&&(this._timers[l]=setTimeout(()=>{this._reloadTile(l,"expired"),delete this._timers[l]},p))}_removeTile(l){const A=this._tiles[l];A&&(A.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),A.uses>0||(A.hasData()&&A.state!=="reloading"?this._cache.add(A.tileID,A,A.getExpiryTimeout()):(A.aborted=!0,this._abortTile(A),this._unloadTile(A))))}_dataHandler(l){const A=l.sourceDataType;l.dataType==="source"&&A==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&l.dataType==="source"&&A==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(l);this._cache.reset()}tilesIn(l,A,p){const y=[],v=this.transform;if(!v)return y;const S=p?v.getCameraQueryGeometry(l):l,I=l.map(K=>v.pointCoordinate(K,this.terrain)),M=S.map(K=>v.pointCoordinate(K,this.terrain)),D=this.getIds();let H=1/0,z=1/0,$=-1/0,J=-1/0;for(const K of M)H=Math.min(H,K.x),z=Math.min(z,K.y),$=Math.max($,K.x),J=Math.max(J,K.y);for(let K=0;K<D.length;K++){const tt=this._tiles[D[K]];if(tt.holdingForFade())continue;const At=tt.tileID,pt=Math.pow(2,v.zoom-tt.tileID.overscaledZ),_t=A*tt.queryPadding*o.X/tt.tileSize/pt,mt=[At.getTilePoint(new o.Z(H,z)),At.getTilePoint(new o.Z($,J))];if(mt[0].x-_t<o.X&&mt[0].y-_t<o.X&&mt[1].x+_t>=0&&mt[1].y+_t>=0){const Et=I.map(Rt=>At.getTilePoint(Rt)),Dt=M.map(Rt=>At.getTilePoint(Rt));y.push({tile:tt,tileID:At,queryGeometry:Et,cameraQueryGeometry:Dt,scale:pt})}}return y}getVisibleCoordinates(l){const A=this.getRenderableIds(l).map(p=>this._tiles[p].tileID);for(const p of A)p.posMatrix=this.transform.calculatePosMatrix(p.toUnwrapped());return A}hasTransition(){if(this._source.hasTransition())return!0;if(_n(this._source.type)){const l=w.now();for(const A in this._tiles)if(this._tiles[A].fadeEndTime>=l)return!0}return!1}setFeatureState(l,A,p){this._state.updateState(l=l||"_geojsonTileLayer",A,p)}removeFeatureState(l,A,p){this._state.removeFeatureState(l=l||"_geojsonTileLayer",A,p)}getFeatureState(l,A){return this._state.getState(l=l||"_geojsonTileLayer",A)}setDependencies(l,A,p){const y=this._tiles[l];y&&y.setDependencies(A,p)}reloadTilesForDependencies(l,A){for(const p in this._tiles)this._tiles[p].hasDependency(l,A)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(l,A))}}function Mr(m,l){const A=Math.abs(2*m.wrap)-+(m.wrap<0),p=Math.abs(2*l.wrap)-+(l.wrap<0);return m.overscaledZ-l.overscaledZ||p-A||l.canonical.y-m.canonical.y||l.canonical.x-m.canonical.x}function _n(m){return m==="raster"||m==="image"||m==="video"}Qe.maxOverzooming=10,Qe.maxUnderzooming=3;class ze{constructor(l,A){this.reset(l,A)}reset(l,A){this.points=l||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(A||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=o.ac(l,0,1);let A=1,p=this._distances[A];const y=l*this.paddedLength+this.padding;for(;p<y&&A<this._distances.length;)p=this._distances[++A];const v=A-1,S=this._distances[v],I=p-S,M=I>0?(y-S)/I:0;return this.points[v].mult(1-M).add(this.points[A].mult(M))}}function Nn(m,l){let A=!0;return m==="always"||m!=="never"&&l!=="never"||(A=!1),A}class sn{constructor(l,A,p){const y=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(l/p),this.yCellCount=Math.ceil(A/p);for(let S=0;S<this.xCellCount*this.yCellCount;S++)y.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=A,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/A,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,A,p,y,v){this._forEachCell(A,p,y,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(A),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(v)}insertCircle(l,A,p,y){this._forEachCell(A-y,p-y,A+y,p+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(A),this.circles.push(p),this.circles.push(y)}_insertBoxCell(l,A,p,y,v,S){this.boxCells[v].push(S)}_insertCircleCell(l,A,p,y,v,S){this.circleCells[v].push(S)}_query(l,A,p,y,v,S,I){if(p<0||l>this.width||y<0||A>this.height)return[];const M=[];if(l<=0&&A<=0&&this.width<=p&&this.height<=y){if(v)return[{key:null,x1:l,y1:A,x2:p,y2:y}];for(let D=0;D<this.boxKeys.length;D++)M.push({key:this.boxKeys[D],x1:this.bboxes[4*D],y1:this.bboxes[4*D+1],x2:this.bboxes[4*D+2],y2:this.bboxes[4*D+3]});for(let D=0;D<this.circleKeys.length;D++){const H=this.circles[3*D],z=this.circles[3*D+1],$=this.circles[3*D+2];M.push({key:this.circleKeys[D],x1:H-$,y1:z-$,x2:H+$,y2:z+$})}}else this._forEachCell(l,A,p,y,this._queryCell,M,{hitTest:v,overlapMode:S,seenUids:{box:{},circle:{}}},I);return M}query(l,A,p,y){return this._query(l,A,p,y,!1,null)}hitTest(l,A,p,y,v,S){return this._query(l,A,p,y,!0,v,S).length>0}hitTestCircle(l,A,p,y,v){const S=l-p,I=l+p,M=A-p,D=A+p;if(I<0||S>this.width||D<0||M>this.height)return!1;const H=[];return this._forEachCell(S,M,I,D,this._queryCellCircle,H,{hitTest:!0,overlapMode:y,circle:{x:l,y:A,radius:p},seenUids:{box:{},circle:{}}},v),H.length>0}_queryCell(l,A,p,y,v,S,I,M){const{seenUids:D,hitTest:H,overlapMode:z}=I,$=this.boxCells[v];if($!==null){const K=this.bboxes;for(const tt of $)if(!D.box[tt]){D.box[tt]=!0;const At=4*tt,pt=this.boxKeys[tt];if(l<=K[At+2]&&A<=K[At+3]&&p>=K[At+0]&&y>=K[At+1]&&(!M||M(pt))&&(!H||!Nn(z,pt.overlapMode))&&(S.push({key:pt,x1:K[At],y1:K[At+1],x2:K[At+2],y2:K[At+3]}),H))return!0}}const J=this.circleCells[v];if(J!==null){const K=this.circles;for(const tt of J)if(!D.circle[tt]){D.circle[tt]=!0;const At=3*tt,pt=this.circleKeys[tt];if(this._circleAndRectCollide(K[At],K[At+1],K[At+2],l,A,p,y)&&(!M||M(pt))&&(!H||!Nn(z,pt.overlapMode))){const _t=K[At],mt=K[At+1],Et=K[At+2];if(S.push({key:pt,x1:_t-Et,y1:mt-Et,x2:_t+Et,y2:mt+Et}),H)return!0}}}return!1}_queryCellCircle(l,A,p,y,v,S,I,M){const{circle:D,seenUids:H,overlapMode:z}=I,$=this.boxCells[v];if($!==null){const K=this.bboxes;for(const tt of $)if(!H.box[tt]){H.box[tt]=!0;const At=4*tt,pt=this.boxKeys[tt];if(this._circleAndRectCollide(D.x,D.y,D.radius,K[At+0],K[At+1],K[At+2],K[At+3])&&(!M||M(pt))&&!Nn(z,pt.overlapMode))return S.push(!0),!0}}const J=this.circleCells[v];if(J!==null){const K=this.circles;for(const tt of J)if(!H.circle[tt]){H.circle[tt]=!0;const At=3*tt,pt=this.circleKeys[tt];if(this._circlesCollide(K[At],K[At+1],K[At+2],D.x,D.y,D.radius)&&(!M||M(pt))&&!Nn(z,pt.overlapMode))return S.push(!0),!0}}}_forEachCell(l,A,p,y,v,S,I,M){const D=this._convertToXCellCoord(l),H=this._convertToYCellCoord(A),z=this._convertToXCellCoord(p),$=this._convertToYCellCoord(y);for(let J=D;J<=z;J++)for(let K=H;K<=$;K++)if(v.call(this,l,A,p,y,this.xCellCount*K+J,S,I,M))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,A,p,y,v,S){const I=y-l,M=v-A,D=p+S;return D*D>I*I+M*M}_circleAndRectCollide(l,A,p,y,v,S,I){const M=(S-y)/2,D=Math.abs(l-(y+M));if(D>M+p)return!1;const H=(I-v)/2,z=Math.abs(A-(v+H));if(z>H+p)return!1;if(D<=M||z<=H)return!0;const $=D-M,J=z-H;return $*$+J*J<=p*p}}function vn(m,l,A,p,y){const v=o.H();return l?(o.K(v,v,[1/y,1/y,1]),A||o.ad(v,v,p.angle)):o.L(v,p.labelPlaneMatrix,m),v}function cn(m,l,A,p,y){if(l){const v=o.ae(m);return o.K(v,v,[y,y,1]),A||o.ad(v,v,-p.angle),v}return p.glCoordMatrix}function Ct(m,l,A,p){let y;p?(y=[m,l,p(m,l),1],o.af(y,y,A)):(y=[m,l,0,1],Qr(y,y,A));const v=y[3];return{point:new o.P(y[0]/v,y[1]/v),signedDistanceFromCamera:v,isOccluded:!1}}function X(m,l){return .5+m/l*.5}function Z(m,l){return m.x>=-l[0]&&m.x<=l[0]&&m.y>=-l[1]&&m.y<=l[1]}function ft(m,l,A,p,y,v,S,I,M,D,H,z,$,J,K){const tt=p?m.textSizeData:m.iconSizeData,At=o.ag(tt,A.transform.zoom),pt=[256/A.width*2+1,256/A.height*2+1],_t=p?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;_t.clear();const mt=m.lineVertexArray,Et=p?m.text.placedSymbolArray:m.icon.placedSymbolArray,Dt=A.transform.width/A.transform.height;let Rt=!1;for(let oe=0;oe<Et.length;oe++){const ge=Et.get(oe);if(ge.hidden||ge.writingMode===o.ah.vertical&&!Rt){tr(ge.numGlyphs,_t);continue}Rt=!1;const _e=Ct(ge.anchorX,ge.anchorY,l,K);if(!Z(_e.point,pt)){tr(ge.numGlyphs,_t);continue}const Ce=X(A.transform.cameraToCenterDistance,_e.signedDistanceFromCamera),xe=o.ai(tt,At,ge),ve=S?xe/Ce:xe*Ce,Se={getElevation:K,labelPlaneMatrix:y,lineVertexArray:mt,pitchWithMap:S,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:D,tileAnchorPoint:new o.P(ge.anchorX,ge.anchorY),unwrappedTileID:H,width:z,height:$,translation:J},sr=Gt(Se,ge,ve,!1,I,l,v,m.glyphOffsetArray,_t,Dt,M);Rt=sr.useVertical,(sr.notEnoughRoom||Rt||sr.needsFlipping&&Gt(Se,ge,ve,!0,I,l,v,m.glyphOffsetArray,_t,Dt,M).notEnoughRoom)&&tr(ge.numGlyphs,_t)}p?m.text.dynamicLayoutVertexBuffer.updateData(_t):m.icon.dynamicLayoutVertexBuffer.updateData(_t)}function Bt(m,l,A,p,y,v,S,I){const M=v.glyphStartIndex+v.numGlyphs,D=v.lineStartIndex,H=v.lineStartIndex+v.lineLength,z=l.getoffsetX(v.glyphStartIndex),$=l.getoffsetX(M-1),J=we(m*z,A,p,y,v.segment,D,H,I,S);if(!J)return null;const K=we(m*$,A,p,y,v.segment,D,H,I,S);return K?I.projectionCache.anyProjectionOccluded?null:{first:J,last:K}:null}function Qt(m,l,A,p){return m===o.ah.horizontal&&Math.abs(A.y-l.y)>Math.abs(A.x-l.x)*p?{useVertical:!0}:(m===o.ah.vertical?l.y<A.y:l.x>A.x)?{needsFlipping:!0}:null}function Gt(m,l,A,p,y,v,S,I,M,D,H){const z=A/24,$=l.lineOffsetX*z,J=l.lineOffsetY*z;let K;if(l.numGlyphs>1){const tt=l.glyphStartIndex+l.numGlyphs,At=l.lineStartIndex,pt=l.lineStartIndex+l.lineLength,_t=Bt(z,I,$,J,p,l,H,m);if(!_t)return{notEnoughRoom:!0};const mt=Ct(_t.first.point.x,_t.first.point.y,S,m.getElevation).point,Et=Ct(_t.last.point.x,_t.last.point.y,S,m.getElevation).point;if(y&&!p){const Dt=Qt(l.writingMode,mt,Et,D);if(Dt)return Dt}K=[_t.first];for(let Dt=l.glyphStartIndex+1;Dt<tt-1;Dt++)K.push(we(z*I.getoffsetX(Dt),$,J,p,l.segment,At,pt,m,H));K.push(_t.last)}else{if(y&&!p){const At=Ct(m.tileAnchorPoint.x,m.tileAnchorPoint.y,v,m.getElevation).point,pt=l.lineStartIndex+l.segment+1,_t=new o.P(m.lineVertexArray.getx(pt),m.lineVertexArray.gety(pt)),mt=Ct(_t.x,_t.y,v,m.getElevation),Et=mt.signedDistanceFromCamera>0?mt.point:function(Rt,oe,ge,_e,Ce,xe){return Nt(Rt,oe,ge,1,Ce,xe)}(m.tileAnchorPoint,_t,At,0,v,m),Dt=Qt(l.writingMode,At,Et,D);if(Dt)return Dt}const tt=we(z*I.getoffsetX(l.glyphStartIndex),$,J,p,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,m,H);if(!tt||m.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};K=[tt]}for(const tt of K)o.aj(M,tt.point,tt.angle);return{}}function Nt(m,l,A,p,y,v){const S=m.add(m.sub(l)._unit()),I=y!==void 0?Ct(S.x,S.y,y,v.getElevation).point:se(S.x,S.y,v).point,M=A.sub(I);return A.add(M._mult(p/M.mag()))}function Pt(m,l,A){const p=l.projectionCache;if(p.projections[m])return p.projections[m];const y=new o.P(l.lineVertexArray.getx(m),l.lineVertexArray.gety(m)),v=se(y.x,y.y,l);if(v.signedDistanceFromCamera>0)return p.projections[m]=v.point,p.anyProjectionOccluded=p.anyProjectionOccluded||v.isOccluded,v.point;const S=m-A.direction;return function(I,M,D,H,z){return Nt(I,M,D,H,void 0,z)}(A.distanceFromAnchor===0?l.tileAnchorPoint:new o.P(l.lineVertexArray.getx(S),l.lineVertexArray.gety(S)),y,A.previousVertex,A.absOffsetX-A.distanceFromAnchor+1,l)}function se(m,l,A){const p=m+A.translation[0],y=l+A.translation[1];let v;return!A.pitchWithMap&&A.projection.useSpecialProjectionForSymbols?(v=A.projection.projectTileCoordinates(p,y,A.unwrappedTileID,A.getElevation),v.point.x=(.5*v.point.x+.5)*A.width,v.point.y=(.5*-v.point.y+.5)*A.height):(v=Ct(p,y,A.labelPlaneMatrix,A.getElevation),v.isOccluded=!1),v}function he(m,l,A){return m._unit()._perp()._mult(l*A)}function Xt(m,l,A,p,y,v,S,I,M){if(I.projectionCache.offsets[m])return I.projectionCache.offsets[m];const D=A.add(l);if(m+M.direction<p||m+M.direction>=y)return I.projectionCache.offsets[m]=D,D;const H=Pt(m+M.direction,I,M),z=he(H.sub(A),S,M.direction),$=A.add(z),J=H.add(z);return I.projectionCache.offsets[m]=o.ak(v,D,$,J)||D,I.projectionCache.offsets[m]}function we(m,l,A,p,y,v,S,I,M){const D=p?m-l:m+l;let H=D>0?1:-1,z=0;p&&(H*=-1,z=Math.PI),H<0&&(z+=Math.PI);let $,J=H>0?v+y:v+y+1;I.projectionCache.cachedAnchorPoint?$=I.projectionCache.cachedAnchorPoint:($=se(I.tileAnchorPoint.x,I.tileAnchorPoint.y,I).point,I.projectionCache.cachedAnchorPoint=$);let K,tt,At=$,pt=$,_t=0,mt=0;const Et=Math.abs(D),Dt=[];let Rt;for(;_t+mt<=Et;){if(J+=H,J<v||J>=S)return null;_t+=mt,pt=At,tt=K;const _e={absOffsetX:Et,direction:H,distanceFromAnchor:_t,previousVertex:pt};if(At=Pt(J,I,_e),A===0)Dt.push(pt),Rt=At.sub(pt);else{let Ce;const xe=At.sub(pt);Ce=xe.mag()===0?he(Pt(J+H,I,_e).sub(At),A,H):he(xe,A,H),tt||(tt=pt.add(Ce)),K=Xt(J,Ce,At,v,S,tt,A,I,_e),Dt.push(tt),Rt=K.sub(tt)}mt=Rt.mag()}const oe=Rt._mult((Et-_t)/mt)._add(tt||pt),ge=z+Math.atan2(At.y-pt.y,At.x-pt.x);return Dt.push(oe),{point:oe,angle:M?ge:0,path:Dt}}const je=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function tr(m,l){for(let A=0;A<m;A++){const p=l.length;l.resize(p+4),l.float32.set(je,3*p)}}function Qr(m,l,A){const p=l[0],y=l[1];return m[0]=A[0]*p+A[4]*y+A[12],m[1]=A[1]*p+A[5]*y+A[13],m[3]=A[3]*p+A[7]*y+A[15],m}const ir=100;class Or{constructor(l,A){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new sn(l.width+200,l.height+200,25),y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new sn(l.width+200,l.height+200,25);this.transform=l,this.mapProjection=A,this.grid=p,this.ignoredGrid=y,this.pitchFactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+ir,this.screenBottomBoundary=l.height+ir,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(l,A,p,y,v,S,I,M,D,H,z){const $=l.anchorPointX+M[0],J=l.anchorPointY+M[1],K=this.projectAndGetPerspectiveRatio(y,$,J,v,H),tt=p*K.perspectiveRatio;let At;if(S||I)At=this._projectCollisionBox(l,tt,y,v,S,I,M,K,H,z);else{const Dt=K.point.x+(z?z.x*tt:0),Rt=K.point.y+(z?z.y*tt:0);At={allPointsOccluded:!1,box:[Dt+l.x1*tt,Rt+l.y1*tt,Dt+l.x2*tt,Rt+l.y2*tt]}}const[pt,_t,mt,Et]=At.box;return this.mapProjection.useSpecialProjectionForSymbols&&(S?At.allPointsOccluded:this.mapProjection.isOccluded($,J,v))||K.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(pt,_t,mt,Et)||A!=="always"&&this.grid.hitTest(pt,_t,mt,Et,A,D)?{box:[pt,_t,mt,Et],placeable:!1,offscreen:!1}:{box:[pt,_t,mt,Et],placeable:!0,offscreen:this.isOffscreen(pt,_t,mt,Et)}}placeCollisionCircles(l,A,p,y,v,S,I,M,D,H,z,$,J,K,tt,At){const pt=[],_t=new o.P(A.anchorX,A.anchorY),mt=this.getPerspectiveRatio(S,_t.x,_t.y,I,At),Et=(z?v/mt:v*mt)/o.ap,Dt={getElevation:At,labelPlaneMatrix:M,lineVertexArray:p,pitchWithMap:z,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:_t,unwrappedTileID:I,width:this.transform.width,height:this.transform.height,translation:tt},Rt=Bt(Et,y,A.lineOffsetX*Et,A.lineOffsetY*Et,!1,A,!1,Dt);let oe=!1,ge=!1,_e=!0;if(Rt){const Ce=.5*J*mt+K,xe=new o.P(-100,-100),ve=new o.P(this.screenRightBoundary,this.screenBottomBoundary),Se=new ze,sr=Rt.first,Pe=Rt.last;let Me=[];for(let Ir=sr.path.length-1;Ir>=1;Ir--)Me.push(sr.path[Ir]);for(let Ir=1;Ir<Pe.path.length;Ir++)Me.push(Pe.path[Ir]);const dr=2.5*Ce;if(D){const Ir=this.projectPathToScreenSpace(Me,Dt,D);Me=Ir.some(Dr=>Dr.signedDistanceFromCamera<=0)?[]:Ir.map(Dr=>Dr.point)}let Pr=[];if(Me.length>0){const Ir=Me[0].clone(),Dr=Me[0].clone();for(let Kr=1;Kr<Me.length;Kr++)Ir.x=Math.min(Ir.x,Me[Kr].x),Ir.y=Math.min(Ir.y,Me[Kr].y),Dr.x=Math.max(Dr.x,Me[Kr].x),Dr.y=Math.max(Dr.y,Me[Kr].y);Pr=Ir.x>=xe.x&&Dr.x<=ve.x&&Ir.y>=xe.y&&Dr.y<=ve.y?[Me]:Dr.x<xe.x||Ir.x>ve.x||Dr.y<xe.y||Ir.y>ve.y?[]:o.al([Me],xe.x,xe.y,ve.x,ve.y)}for(const Ir of Pr){Se.reset(Ir,.25*Ce);let Dr=0;Dr=Se.length<=.5*Ce?1:Math.ceil(Se.paddedLength/dr)+1;for(let Kr=0;Kr<Dr;Kr++){const Bn=Kr/Math.max(Dr-1,1),Zn=Se.lerp(Bn),fn=Zn.x+ir,hi=Zn.y+ir;pt.push(fn,hi,Ce,0);const Cn=fn-Ce,ai=hi-Ce,Bi=fn+Ce,Is=hi+Ce;if(_e=_e&&this.isOffscreen(Cn,ai,Bi,Is),ge=ge||this.isInsideGrid(Cn,ai,Bi,Is),l!=="always"&&this.grid.hitTestCircle(fn,hi,Ce,l,$)&&(oe=!0,!H))return{circles:[],offscreen:!1,collisionDetected:oe}}}}return{circles:!H&&oe||!ge||mt<this.perspectiveRatioCutoff?[]:pt,offscreen:_e,collisionDetected:oe}}projectPathToScreenSpace(l,A,p){return l.map(y=>Ct(y.x,y.y,p,A.getElevation))}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const A=[];let p=1/0,y=1/0,v=-1/0,S=-1/0;for(const H of l){const z=new o.P(H.x+ir,H.y+ir);p=Math.min(p,z.x),y=Math.min(y,z.y),v=Math.max(v,z.x),S=Math.max(S,z.y),A.push(z)}const I=this.grid.query(p,y,v,S).concat(this.ignoredGrid.query(p,y,v,S)),M={},D={};for(const H of I){const z=H.key;if(M[z.bucketInstanceId]===void 0&&(M[z.bucketInstanceId]={}),M[z.bucketInstanceId][z.featureIndex])continue;const $=[new o.P(H.x1,H.y1),new o.P(H.x2,H.y1),new o.P(H.x2,H.y2),new o.P(H.x1,H.y2)];o.am(A,$)&&(M[z.bucketInstanceId][z.featureIndex]=!0,D[z.bucketInstanceId]===void 0&&(D[z.bucketInstanceId]=[]),D[z.bucketInstanceId].push(z.featureIndex))}return D}insertCollisionBox(l,A,p,y,v,S){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:v,collisionGroupID:S,overlapMode:A},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,A,p,y,v,S){const I=p?this.ignoredGrid:this.grid,M={bucketInstanceId:y,featureIndex:v,collisionGroupID:S,overlapMode:A};for(let D=0;D<l.length;D+=4)I.insertCircle(M,l[D],l[D+1],l[D+2])}projectAndGetPerspectiveRatio(l,A,p,y,v){let S;v?(S=[A,p,v(A,p),1],o.af(S,S,l)):(S=[A,p,0,1],Qr(S,S,l));const I=S[3];return{point:new o.P((S[0]/I+1)/2*this.transform.width+ir,(-S[1]/I+1)/2*this.transform.height+ir),perspectiveRatio:.5+this.transform.cameraToCenterDistance/I*.5,isOccluded:!1,signedDistanceFromCamera:I}}getPerspectiveRatio(l,A,p,y,v){const S=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(A,p,y,v):Ct(A,p,l,v);return .5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5}isOffscreen(l,A,p,y){return p<ir||l>=this.screenRightBoundary||y<ir||A>this.screenBottomBoundary}isInsideGrid(l,A,p,y){return p>=0&&l<this.gridRightBoundary&&y>=0&&A<this.gridBottomBoundary}getViewportMatrix(){const l=o.an([]);return o.J(l,l,[-100,-100,0]),l}_projectCollisionBox(l,A,p,y,v,S,I,M,D,H){let z=new o.P(1,0),$=new o.P(0,1);const J=new o.P(l.anchorPointX+I[0],l.anchorPointY+I[1]);if(S&&!v){const _e=this.projectAndGetPerspectiveRatio(p,J.x+1,J.y,y,D).point.sub(M.point).unit(),Ce=Math.atan(_e.y/_e.x)+(_e.x<0?Math.PI:0),xe=Math.sin(Ce),ve=Math.cos(Ce);z=new o.P(ve,xe),$=new o.P(-xe,ve)}else if(!S&&v){const _e=-this.transform.angle,Ce=Math.sin(_e),xe=Math.cos(_e);z=new o.P(xe,Ce),$=new o.P(-Ce,xe)}let K=M.point,tt=A;if(v){K=J;const _e=this.transform.zoom-Math.floor(this.transform.zoom);tt=Math.pow(2,-_e),tt*=this.mapProjection.getPitchedTextCorrection(this.transform,J,y),H||(tt*=o.ac(.5+M.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}H&&(K=K.add(z.mult(H.x*tt)).add($.mult(H.y*tt)));const At=l.x1*tt,pt=l.x2*tt,_t=(At+pt)/2,mt=l.y1*tt,Et=l.y2*tt,Dt=(mt+Et)/2,Rt=[{offsetX:At,offsetY:mt},{offsetX:_t,offsetY:mt},{offsetX:pt,offsetY:mt},{offsetX:pt,offsetY:Dt},{offsetX:pt,offsetY:Et},{offsetX:_t,offsetY:Et},{offsetX:At,offsetY:Et},{offsetX:At,offsetY:Dt}];let oe=[];for(const{offsetX:_e,offsetY:Ce}of Rt)oe.push(new o.P(K.x+z.x*_e+$.x*Ce,K.y+z.y*_e+$.y*Ce));let ge=!1;if(v){const _e=oe.map(Ce=>this.projectAndGetPerspectiveRatio(p,Ce.x,Ce.y,y,D));ge=_e.some(Ce=>!Ce.isOccluded),oe=_e.map(Ce=>Ce.point)}else ge=!0;return{box:o.ao(oe),allPointsOccluded:!ge}}}function xr(m,l,A){return l*(o.X/(m.tileSize*Math.pow(2,A-m.tileID.overscaledZ)))}class $r{constructor(l,A,p,y){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?A:-A))):y&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class Xr{constructor(l,A,p,y,v){this.text=new $r(l?l.text:null,A,p,v),this.icon=new $r(l?l.icon:null,A,y,v)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class vr{constructor(l,A,p){this.text=l,this.icon=A,this.skipFade=p}}class jr{constructor(){this.invProjMatrix=o.H(),this.viewportMatrix=o.H(),this.circles=[]}}class on{constructor(l,A,p,y,v){this.bucketInstanceId=l,this.featureIndex=A,this.sourceLayerIndex=p,this.bucketIndex=y,this.tileID=v}}class In{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const A=++this.maxGroupID;this.collisionGroups[l]={ID:A,predicate:p=>p.collisionGroupID===A}}return this.collisionGroups[l]}}function Mt(m,l,A,p,y){const{horizontalAlign:v,verticalAlign:S}=o.au(m);return new o.P(-(v-.5)*l+p[0]*y,-(S-.5)*A+p[1]*y)}class Ne{constructor(l,A,p,y,v,S){this.transform=l.clone(),this.terrain=p,this.collisionIndex=new Or(this.transform,A),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=y,this.retainedQueryData={},this.collisionGroups=new In(v),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(l){const A=this.terrain;return A?(p,y)=>A.getElevation(l,p,y):null}getBucketParts(l,A,p,y){const v=p.getBucket(A),S=p.latestFeatureIndex;if(!v||!S||A.id!==v.layerIds[0])return;const I=p.collisionBoxArray,M=v.layers[0].layout,D=v.layers[0].paint,H=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),z=p.tileSize/o.X,$=p.tileID.toUnwrapped(),J=this.transform.calculatePosMatrix($),K=M.get("text-pitch-alignment")==="map",tt=M.get("text-rotation-alignment")==="map",At=xr(p,1,this.transform.zoom),pt=this.collisionIndex.mapProjection.translatePosition(this.transform,p,D.get("text-translate"),D.get("text-translate-anchor")),_t=this.collisionIndex.mapProjection.translatePosition(this.transform,p,D.get("icon-translate"),D.get("icon-translate-anchor")),mt=vn(J,K,tt,this.transform,At);let Et=null;if(K){const Rt=cn(J,K,tt,this.transform,At);Et=o.L([],this.transform.labelPlaneMatrix,Rt)}this.retainedQueryData[v.bucketInstanceId]=new on(v.bucketInstanceId,S,v.sourceLayerIndex,v.index,p.tileID);const Dt={bucket:v,layout:M,translationText:pt,translationIcon:_t,posMatrix:J,unwrappedTileID:$,textLabelPlaneMatrix:mt,labelToScreenMatrix:Et,scale:H,textPixelRatio:z,holdingForFade:p.holdingForFade(),collisionBoxArray:I,partiallyEvaluatedTextSize:o.ag(v.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(y)for(const Rt of v.sortKeyRanges){const{sortKey:oe,symbolInstanceStart:ge,symbolInstanceEnd:_e}=Rt;l.push({sortKey:oe,symbolInstanceStart:ge,symbolInstanceEnd:_e,parameters:Dt})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:Dt})}attemptAnchorPlacement(l,A,p,y,v,S,I,M,D,H,z,$,J,K,tt,At,pt,_t,mt){const Et=o.aq[l.textAnchor],Dt=[l.textOffset0,l.textOffset1],Rt=Mt(Et,p,y,Dt,v),oe=this.collisionIndex.placeCollisionBox(A,$,M,D,H,I,S,At,z.predicate,mt,Rt);if((!_t||this.collisionIndex.placeCollisionBox(_t,$,M,D,H,I,S,pt,z.predicate,mt,Rt).placeable)&&oe.placeable){let ge;if(this.prevPlacement&&this.prevPlacement.variableOffsets[J.crossTileID]&&this.prevPlacement.placements[J.crossTileID]&&this.prevPlacement.placements[J.crossTileID].text&&(ge=this.prevPlacement.variableOffsets[J.crossTileID].anchor),J.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[J.crossTileID]={textOffset:Dt,width:p,height:y,anchor:Et,textBoxScale:v,prevAnchor:ge},this.markUsedJustification(K,Et,J,tt),K.allowVerticalPlacement&&(this.markUsedOrientation(K,tt,J),this.placedOrientations[J.crossTileID]=tt),{shift:Rt,placedGlyphBoxes:oe}}}placeLayerBucketPart(l,A,p){const{bucket:y,layout:v,translationText:S,translationIcon:I,posMatrix:M,unwrappedTileID:D,textLabelPlaneMatrix:H,labelToScreenMatrix:z,textPixelRatio:$,holdingForFade:J,collisionBoxArray:K,partiallyEvaluatedTextSize:tt,collisionGroup:At}=l.parameters,pt=v.get("text-optional"),_t=v.get("icon-optional"),mt=o.ar(v,"text-overlap","text-allow-overlap"),Et=mt==="always",Dt=o.ar(v,"icon-overlap","icon-allow-overlap"),Rt=Dt==="always",oe=v.get("text-rotation-alignment")==="map",ge=v.get("text-pitch-alignment")==="map",_e=v.get("icon-text-fit")!=="none",Ce=v.get("symbol-z-order")==="viewport-y",xe=Et&&(Rt||!y.hasIconData()||_t),ve=Rt&&(Et||!y.hasTextData()||pt);!y.collisionArrays&&K&&y.deserializeCollisionBoxes(K);const Se=this._getTerrainElevationFunc(this.retainedQueryData[y.bucketInstanceId].tileID),sr=(Pe,Me,dr)=>{var Pr,Ir;if(A[Pe.crossTileID])return;if(J)return void(this.placements[Pe.crossTileID]=new vr(!1,!1,!1));let Dr=!1,Kr=!1,Bn=!0,Zn=null,fn={box:null,placeable:!1,offscreen:null},hi={box:null,placeable:!1,offscreen:null},Cn=null,ai=null,Bi=null,Is=0,oo=0,ti=0;Me.textFeatureIndex?Is=Me.textFeatureIndex:Pe.useRuntimeCollisionCircles&&(Is=Pe.featureIndex),Me.verticalTextFeatureIndex&&(oo=Me.verticalTextFeatureIndex);const Dl=Me.textBox;if(Dl){const hs=yi=>{let es=o.ah.horizontal;if(y.allowVerticalPlacement&&!yi&&this.prevPlacement){const fs=this.prevPlacement.placedOrientations[Pe.crossTileID];fs&&(this.placedOrientations[Pe.crossTileID]=fs,es=fs,this.markUsedOrientation(y,es,Pe))}return es},Fs=(yi,es)=>{if(y.allowVerticalPlacement&&Pe.numVerticalGlyphVertices>0&&Me.verticalTextBox){for(const fs of y.writingModes)if(fs===o.ah.vertical?(fn=es(),hi=fn):fn=yi(),fn&&fn.placeable)break}else fn=yi()},Vi=Pe.textAnchorOffsetStartIndex,ds=Pe.textAnchorOffsetEndIndex;if(ds===Vi){const yi=(es,fs)=>{const an=this.collisionIndex.placeCollisionBox(es,mt,$,M,D,ge,oe,S,At.predicate,Se);return an&&an.placeable&&(this.markUsedOrientation(y,fs,Pe),this.placedOrientations[Pe.crossTileID]=fs),an};Fs(()=>yi(Dl,o.ah.horizontal),()=>{const es=Me.verticalTextBox;return y.allowVerticalPlacement&&Pe.numVerticalGlyphVertices>0&&es?yi(es,o.ah.vertical):{box:null,offscreen:null}}),hs(fn&&fn.placeable)}else{let yi=o.aq[(Ir=(Pr=this.prevPlacement)===null||Pr===void 0?void 0:Pr.variableOffsets[Pe.crossTileID])===null||Ir===void 0?void 0:Ir.anchor];const es=(an,Fa,Nl)=>{const il=an.x2-an.x1,xu=an.y2-an.y1,Km=Pe.textBoxScale,Cp=_e&&Dt==="never"?Fa:null;let La=null,sl=mt==="never"?1:2,xh="never";yi&&sl++;for(let BA=0;BA<sl;BA++){for(let Bh=Vi;Bh<ds;Bh++){const CA=y.textAnchorOffsets.get(Bh);if(yi&&CA.textAnchor!==yi)continue;const ol=this.attemptAnchorPlacement(CA,an,il,xu,Km,oe,ge,$,M,D,At,xh,Pe,y,Nl,S,I,Cp,Se);if(ol&&(La=ol.placedGlyphBoxes,La&&La.placeable))return Dr=!0,Zn=ol.shift,La}yi?yi=null:xh=mt}return p&&!La&&(La={box:this.collisionIndex.placeCollisionBox(Dl,"always",$,M,D,ge,oe,S,At.predicate,Se,new o.P(0,0)).box,offscreen:!1,placeable:!1}),La};Fs(()=>es(Dl,Me.iconBox,o.ah.horizontal),()=>{const an=Me.verticalTextBox;return y.allowVerticalPlacement&&(!fn||!fn.placeable)&&Pe.numVerticalGlyphVertices>0&&an?es(an,Me.verticalIconBox,o.ah.vertical):{box:null,occluded:!0,offscreen:null}}),fn&&(Dr=fn.placeable,Bn=fn.offscreen);const fs=hs(fn&&fn.placeable);if(!Dr&&this.prevPlacement){const an=this.prevPlacement.variableOffsets[Pe.crossTileID];an&&(this.variableOffsets[Pe.crossTileID]=an,this.markUsedJustification(y,an.anchor,Pe,fs))}}}if(Cn=fn,Dr=Cn&&Cn.placeable,Bn=Cn&&Cn.offscreen,Pe.useRuntimeCollisionCircles){const hs=y.text.placedSymbolArray.get(Pe.centerJustifiedTextSymbolIndex),Fs=o.ai(y.textSizeData,tt,hs),Vi=v.get("text-padding");ai=this.collisionIndex.placeCollisionCircles(mt,hs,y.lineVertexArray,y.glyphOffsetArray,Fs,M,D,H,z,p,ge,At.predicate,Pe.collisionCircleDiameter,Vi,S,Se),ai.circles.length&&ai.collisionDetected&&!p&&o.w("Collisions detected, but collision boxes are not shown"),Dr=Et||ai.circles.length>0&&!ai.collisionDetected,Bn=Bn&&ai.offscreen}if(Me.iconFeatureIndex&&(ti=Me.iconFeatureIndex),Me.iconBox){const hs=Fs=>this.collisionIndex.placeCollisionBox(Fs,Dt,$,M,D,ge,oe,I,At.predicate,Se,_e&&Zn?Zn:void 0);hi&&hi.placeable&&Me.verticalIconBox?(Bi=hs(Me.verticalIconBox),Kr=Bi.placeable):(Bi=hs(Me.iconBox),Kr=Bi.placeable),Bn=Bn&&Bi.offscreen}const ao=pt||Pe.numHorizontalGlyphVertices===0&&Pe.numVerticalGlyphVertices===0,xA=_t||Pe.numIconVertices===0;ao||xA?xA?ao||(Kr=Kr&&Dr):Dr=Kr&&Dr:Kr=Dr=Kr&&Dr;const wu=Kr&&Bi.placeable;if(Dr&&Cn.placeable&&this.collisionIndex.insertCollisionBox(Cn.box,mt,v.get("text-ignore-placement"),y.bucketInstanceId,hi&&hi.placeable&&oo?oo:Is,At.ID),wu&&this.collisionIndex.insertCollisionBox(Bi.box,Dt,v.get("icon-ignore-placement"),y.bucketInstanceId,ti,At.ID),ai&&Dr&&this.collisionIndex.insertCollisionCircles(ai.circles,mt,v.get("text-ignore-placement"),y.bucketInstanceId,Is,At.ID),p&&this.storeCollisionData(y.bucketInstanceId,dr,Me,Cn,Bi,ai),Pe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(y.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Pe.crossTileID]=new vr(Dr||xe,Kr||ve,Bn||y.justReloaded),A[Pe.crossTileID]=!0};if(Ce){if(l.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Pe=y.getSortedSymbolIndexes(this.transform.angle);for(let Me=Pe.length-1;Me>=0;--Me){const dr=Pe[Me];sr(y.symbolInstances.get(dr),y.collisionArrays[dr],dr)}}else for(let Pe=l.symbolInstanceStart;Pe<l.symbolInstanceEnd;Pe++)sr(y.symbolInstances.get(Pe),y.collisionArrays[Pe],Pe);if(p&&y.bucketInstanceId in this.collisionCircleArrays){const Pe=this.collisionCircleArrays[y.bucketInstanceId];o.as(Pe.invProjMatrix,M),Pe.viewportMatrix=this.collisionIndex.getViewportMatrix()}y.justReloaded=!1}storeCollisionData(l,A,p,y,v,S){if(p.textBox||p.iconBox){let I,M;this.collisionBoxArrays.has(l)?I=this.collisionBoxArrays.get(l):(I=new Map,this.collisionBoxArrays.set(l,I)),I.has(A)?M=I.get(A):(M={text:null,icon:null},I.set(A,M)),p.textBox&&(M.text=y.box),p.iconBox&&(M.icon=v.box)}if(S){let I=this.collisionCircleArrays[l];I===void 0&&(I=this.collisionCircleArrays[l]=new jr);for(let M=0;M<S.circles.length;M+=4)I.circles.push(S.circles[M+0]),I.circles.push(S.circles[M+1]),I.circles.push(S.circles[M+2]),I.circles.push(S.collisionDetected?1:0)}}markUsedJustification(l,A,p,y){let v;v=y===o.ah.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[o.at(A)];const S=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const I of S)I>=0&&(l.text.placedSymbolArray.get(I).crossTileID=v>=0&&I!==v?0:p.crossTileID)}markUsedOrientation(l,A,p){const y=A===o.ah.horizontal||A===o.ah.horizontalOnly?A:0,v=A===o.ah.vertical?A:0,S=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const I of S)l.text.placedSymbolArray.get(I).placedOrientation=y;p.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=v)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const A=this.prevPlacement;let p=!1;this.prevZoomAdjustment=A?A.zoomAdjustment(this.transform.zoom):0;const y=A?A.symbolFadeChange(l):1,v=A?A.opacities:{},S=A?A.variableOffsets:{},I=A?A.placedOrientations:{};for(const M in this.placements){const D=this.placements[M],H=v[M];H?(this.opacities[M]=new Xr(H,y,D.text,D.icon),p=p||D.text!==H.text.placed||D.icon!==H.icon.placed):(this.opacities[M]=new Xr(null,y,D.text,D.icon,D.skipFade),p=p||D.text||D.icon)}for(const M in v){const D=v[M];if(!this.opacities[M]){const H=new Xr(D,y,!1,!1);H.isHidden()||(this.opacities[M]=H,p=p||D.text.placed||D.icon.placed)}}for(const M in S)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=S[M]);for(const M in I)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=I[M]);if(A&&A.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=A?A.lastPlacementChangeTime:l)}updateLayerOpacities(l,A){const p={};for(const y of A){const v=y.getBucket(l);v&&y.latestFeatureIndex&&l.id===v.layerIds[0]&&this.updateBucketOpacities(v,y.tileID,p,y.collisionBoxArray)}}updateBucketOpacities(l,A,p,y){l.hasTextData()&&(l.text.opacityVertexArray.clear(),l.text.hasVisibleVertices=!1),l.hasIconData()&&(l.icon.opacityVertexArray.clear(),l.icon.hasVisibleVertices=!1),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const v=l.layers[0],S=v.layout,I=new Xr(null,0,!1,!1,!0),M=S.get("text-allow-overlap"),D=S.get("icon-allow-overlap"),H=v._unevaluatedLayout.hasValue("text-variable-anchor")||v._unevaluatedLayout.hasValue("text-variable-anchor-offset"),z=S.get("text-rotation-alignment")==="map",$=S.get("text-pitch-alignment")==="map",J=S.get("icon-text-fit")!=="none",K=new Xr(null,0,M&&(D||!l.hasIconData()||S.get("icon-optional")),D&&(M||!l.hasTextData()||S.get("text-optional")),!0);!l.collisionArrays&&y&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(y);const tt=(pt,_t,mt)=>{for(let Et=0;Et<_t/4;Et++)pt.opacityVertexArray.emplaceBack(mt);pt.hasVisibleVertices=pt.hasVisibleVertices||mt!==$o},At=this.collisionBoxArrays.get(l.bucketInstanceId);for(let pt=0;pt<l.symbolInstances.length;pt++){const _t=l.symbolInstances.get(pt),{numHorizontalGlyphVertices:mt,numVerticalGlyphVertices:Et,crossTileID:Dt}=_t;let Rt=this.opacities[Dt];p[Dt]?Rt=I:Rt||(Rt=K,this.opacities[Dt]=Rt),p[Dt]=!0;const oe=_t.numIconVertices>0,ge=this.placedOrientations[_t.crossTileID],_e=ge===o.ah.vertical,Ce=ge===o.ah.horizontal||ge===o.ah.horizontalOnly;if(mt>0||Et>0){const ve=tn(Rt.text);tt(l.text,mt,_e?$o:ve),tt(l.text,Et,Ce?$o:ve);const Se=Rt.text.isHidden();[_t.rightJustifiedTextSymbolIndex,_t.centerJustifiedTextSymbolIndex,_t.leftJustifiedTextSymbolIndex].forEach(Me=>{Me>=0&&(l.text.placedSymbolArray.get(Me).hidden=Se||_e?1:0)}),_t.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(_t.verticalPlacedTextSymbolIndex).hidden=Se||Ce?1:0);const sr=this.variableOffsets[_t.crossTileID];sr&&this.markUsedJustification(l,sr.anchor,_t,ge);const Pe=this.placedOrientations[_t.crossTileID];Pe&&(this.markUsedJustification(l,"left",_t,Pe),this.markUsedOrientation(l,Pe,_t))}if(oe){const ve=tn(Rt.icon),Se=!(J&&_t.verticalPlacedIconSymbolIndex&&_e);_t.placedIconSymbolIndex>=0&&(tt(l.icon,_t.numIconVertices,Se?ve:$o),l.icon.placedSymbolArray.get(_t.placedIconSymbolIndex).hidden=Rt.icon.isHidden()),_t.verticalPlacedIconSymbolIndex>=0&&(tt(l.icon,_t.numVerticalIconVertices,Se?$o:ve),l.icon.placedSymbolArray.get(_t.verticalPlacedIconSymbolIndex).hidden=Rt.icon.isHidden())}const xe=At&&At.has(pt)?At.get(pt):{text:null,icon:null};if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const ve=l.collisionArrays[pt];if(ve){let Se=new o.P(0,0);if(ve.textBox||ve.verticalTextBox){let sr=!0;if(H){const Pe=this.variableOffsets[Dt];Pe?(Se=Mt(Pe.anchor,Pe.width,Pe.height,Pe.textOffset,Pe.textBoxScale),z&&Se._rotate($?this.transform.angle:-this.transform.angle)):sr=!1}if(ve.textBox||ve.verticalTextBox){let Pe;ve.textBox&&(Pe=_e),ve.verticalTextBox&&(Pe=Ce),Ee(l.textCollisionBox.collisionVertexArray,Rt.text.placed,!sr||Pe,xe.text,Se.x,Se.y)}}if(ve.iconBox||ve.verticalIconBox){const sr=!!(!Ce&&ve.verticalIconBox);let Pe;ve.iconBox&&(Pe=sr),ve.verticalIconBox&&(Pe=!sr),Ee(l.iconCollisionBox.collisionVertexArray,Rt.icon.placed,Pe,xe.icon,J?Se.x:0,J?Se.y:0)}}}}if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.text.opacityVertexArray.length!==l.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${l.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${l.text.layoutVertexArray.length}) / 4`);if(l.icon.opacityVertexArray.length!==l.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${l.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${l.icon.layoutVertexArray.length}) / 4`);if(l.bucketInstanceId in this.collisionCircleArrays){const pt=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=pt.invProjMatrix,l.placementViewportMatrix=pt.viewportMatrix,l.collisionCircleArray=pt.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,A){const p=this.zoomAtLastRecencyCheck===A?1-this.zoomAdjustment(A):1;return this.zoomAtLastRecencyCheck=A,this.commitTime+this.fadeDuration*p>l}setStale(){this.stale=!0}}function Ee(m,l,A,p,y,v){p&&p.length!==0||(p=[0,0,0,0]);const S=p[0]-ir,I=p[1]-ir,M=p[2]-ir,D=p[3]-ir;m.emplaceBack(l?1:0,A?1:0,y||0,v||0,S,I),m.emplaceBack(l?1:0,A?1:0,y||0,v||0,M,I),m.emplaceBack(l?1:0,A?1:0,y||0,v||0,M,D),m.emplaceBack(l?1:0,A?1:0,y||0,v||0,S,D)}const or=Math.pow(2,25),Lr=Math.pow(2,24),Pn=Math.pow(2,17),qr=Math.pow(2,16),yn=Math.pow(2,9),mi=Math.pow(2,8),bn=Math.pow(2,1);function tn(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const l=m.placed?1:0,A=Math.floor(127*m.opacity);return A*or+l*Lr+A*Pn+l*qr+A*yn+l*mi+A*bn+l}const $o=0;function ws(){return{isOccluded:(m,l,A)=>!1,getPitchedTextCorrection:(m,l,A)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(m,l,A,p){throw new Error("Not implemented.")},translatePosition:(m,l,A,p)=>function(y,v,S,I){let M=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(!S[0]&&!S[1])return[0,0];const D=M?I==="map"?y.angle:0:I==="viewport"?-y.angle:0;if(D){const H=Math.sin(D),z=Math.cos(D);S=[S[0]*z-S[1]*H,S[0]*H+S[1]*z]}return[M?S[0]:xr(v,S[0],y.zoom),M?S[1]:xr(v,S[1],y.zoom)]}(m,l,A,p),getCircleRadiusCorrection:m=>1}}class kn{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,A,p,y,v){const S=this._bucketParts;for(;this._currentTileIndex<l.length;)if(A.getBucketParts(S,y,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((I,M)=>I.sortKey-M.sortKey));this._currentPartIndex<S.length;)if(A.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,v())return!0;return!1}}class hn{constructor(l,A,p,y,v,S,I,M){this.placement=new Ne(l,ws(),A,S,I,M),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(l,A,p){const y=w.now(),v=()=>!this._forceFullPlacement&&w.now()-y>2;for(;this._currentPlacementIndex>=0;){const S=A[l[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=I)&&(!S.maxzoom||S.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new kn(S)),this._inProgressLayer.continuePlacement(p[S.source],this.placement,this._showCollisionBoxes,S,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const Li=512/o.X/2;class On{constructor(l,A,p){this.tileID=l,this.bucketInstanceId=p,this._symbolsByKey={};const y=new Map;for(let v=0;v<A.length;v++){const S=A.get(v),I=S.key,M=y.get(I);M?M.push(S):y.set(I,[S])}for(const[v,S]of y){const I={positions:S.map(M=>({x:Math.floor(M.anchorX*Li),y:Math.floor(M.anchorY*Li)})),crossTileIDs:S.map(M=>M.crossTileID)};if(I.positions.length>128){const M=new o.av(I.positions.length,16,Uint16Array);for(const{x:D,y:H}of I.positions)M.add(D,H);M.finish(),delete I.positions,I.index=M}this._symbolsByKey[v]=I}}getScaledCoordinates(l,A){const{x:p,y,z:v}=this.tileID.canonical,{x:S,y:I,z:M}=A.canonical,D=Li/Math.pow(2,M-v),H=(I*o.X+l.anchorY)*D,z=y*o.X*Li;return{x:Math.floor((S*o.X+l.anchorX)*D-p*o.X*Li),y:Math.floor(H-z)}}findMatches(l,A,p){const y=this.tileID.canonical.z<A.canonical.z?1:Math.pow(2,this.tileID.canonical.z-A.canonical.z);for(let v=0;v<l.length;v++){const S=l.get(v);if(S.crossTileID)continue;const I=this._symbolsByKey[S.key];if(!I)continue;const M=this.getScaledCoordinates(S,A);if(I.index){const D=I.index.range(M.x-y,M.y-y,M.x+y,M.y+y).sort();for(const H of D){const z=I.crossTileIDs[H];if(!p[z]){p[z]=!0,S.crossTileID=z;break}}}else if(I.positions)for(let D=0;D<I.positions.length;D++){const H=I.positions[D],z=I.crossTileIDs[D];if(Math.abs(H.x-M.x)<=y&&Math.abs(H.y-M.y)<=y&&!p[z]){p[z]=!0,S.crossTileID=z;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(l=>{let{crossTileIDs:A}=l;return A})}}class Wo{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Pi{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const A=Math.round((l-this.lng)/360);if(A!==0)for(const p in this.indexes){const y=this.indexes[p],v={};for(const S in y){const I=y[S];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+A),v[I.tileID.key]=I}this.indexes[p]=v}this.lng=l}addBucket(l,A,p){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===A.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let v=0;v<A.symbolInstances.length;v++)A.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});const y=this.usedCrossTileIDs[l.overscaledZ];for(const v in this.indexes){const S=this.indexes[v];if(Number(v)>l.overscaledZ)for(const I in S){const M=S[I];M.tileID.isChildOf(l)&&M.findMatches(A.symbolInstances,l,y)}else{const I=S[l.scaledTo(Number(v)).key];I&&I.findMatches(A.symbolInstances,l,y)}}for(let v=0;v<A.symbolInstances.length;v++){const S=A.symbolInstances.get(v);S.crossTileID||(S.crossTileID=p.generate(),y[S.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new On(l,A.symbolInstances,A.bucketInstanceId),!0}removeBucketCrossTileIDs(l,A){for(const p of A.getCrossTileIDsLists())for(const y of p)delete this.usedCrossTileIDs[l][y]}removeStaleBuckets(l){let A=!1;for(const p in this.indexes){const y=this.indexes[p];for(const v in y)l[y[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,y[v]),delete y[v],A=!0)}return A}}class $a{constructor(){this.layerIndexes={},this.crossTileIDs=new Wo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,A,p){let y=this.layerIndexes[l.id];y===void 0&&(y=this.layerIndexes[l.id]=new Pi);let v=!1;const S={};y.handleWrapJump(p);for(const I of A){const M=I.getBucket(l);M&&l.id===M.layerIds[0]&&(M.bucketInstanceId||(M.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(I.tileID,M,this.crossTileIDs)&&(v=!0),S[M.bucketInstanceId]=!0)}return y.removeStaleBuckets(S)&&(v=!0),v}pruneUnusedLayers(l){const A={};l.forEach(p=>{A[p]=!0});for(const p in this.layerIndexes)A[p]||delete this.layerIndexes[p]}}const qn=(m,l)=>o.t(m,l&&l.filter(A=>A.identifier!=="source.canvas")),xs=o.aw();class Mi extends o.E{constructor(l){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),this._rtlPluginLoaded=()=>{for(const p in this.sourceCaches){const y=this.sourceCaches[p].getSource().type;y!=="vector"&&y!=="geojson"||this.sourceCaches[p].reload()}},this.map=l,this.dispatcher=new Be(Zt(),l._getMapId()),this.dispatcher.registerMessageHandler("GG",(p,y)=>this.getGlyphs(p,y)),this.dispatcher.registerMessageHandler("GI",(p,y)=>this.getImages(p,y)),this.imageManager=new bt,this.imageManager.setEventedParent(this),this.glyphManager=new Jt(l._requestManager,A.localIdeographFontFamily),this.lineAtlas=new wt(256,512),this.crossTileSymbolIndex=new $a,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",o.ay()),De().on(de,this._rtlPluginLoaded),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const y=this.sourceCaches[p.sourceId];if(!y)return;const v=y.getSource();if(v&&v.vectorLayerIds)for(const S in this._layers){const I=this._layers[S];I.source===v.id&&this._validateLayer(I)}})}loadURL(l){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=arguments.length>2?arguments[2]:void 0;this.fire(new o.k("dataloading",{dataType:"style"})),A.validate=typeof A.validate!="boolean"||A.validate;const y=this.map._requestManager.transformRequest(l,"Style");this._loadStyleRequest=new AbortController;const v=this._loadStyleRequest;o.h(y,this._loadStyleRequest).then(S=>{this._loadStyleRequest=null,this._load(S.data,A,p)}).catch(S=>{this._loadStyleRequest=null,S&&!v.signal.aborted&&this.fire(new o.j(S))})}loadJSON(l){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=arguments.length>2?arguments[2]:void 0;this.fire(new o.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,w.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,A.validate=A.validate!==!1,this._load(l,A,p)}).catch(()=>{})}loadEmpty(){this.fire(new o.k("dataloading",{dataType:"style"})),this._load(xs,{validate:!1})}_load(l,A,p){var y;const v=A.transformStyle?A.transformStyle(p,l):l;if(!A.validate||!qn(this,o.u(v))){this._loaded=!0,this.stylesheet=v;for(const S in v.sources)this.addSource(S,v.sources[S],{validate:!1});v.sprite?this._loadSprite(v.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(v.glyphs),this._createLayers(),this.light=new Yt(this.stylesheet.light),this.sky=new it(this.stylesheet.sky),this.map.setTerrain((y=this.stylesheet.terrain)!==null&&y!==void 0?y:null),this.fire(new o.k("data",{dataType:"style"})),this.fire(new o.k("style.load"))}}_createLayers(){const l=o.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",l),this._order=l.map(A=>A.id),this._layers={},this._serializedLayers=null;for(const A of l){const p=o.aA(A);p.setEventedParent(this,{layer:{id:A.id}}),this._layers[A.id]=p}}_loadSprite(l){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,y;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(v,S,I,M){return o._(this,void 0,void 0,function*(){const D=It(v),H=I>1?"@2x":"",z={},$={};for(const{id:J,url:K}of D){const tt=S.transformRequest(St(K,H,".json"),"SpriteJSON");z[J]=o.h(tt,M);const At=S.transformRequest(St(K,H,".png"),"SpriteImage");$[J]=W.getImage(At,M)}return yield Promise.all([...Object.values(z),...Object.values($)]),function(J,K){return o._(this,void 0,void 0,function*(){const tt={};for(const At in J){tt[At]={};const pt=w.getImageCanvasContext((yield K[At]).data),_t=(yield J[At]).data;for(const mt in _t){const{width:Et,height:Dt,x:Rt,y:oe,sdf:ge,pixelRatio:_e,stretchX:Ce,stretchY:xe,content:ve,textFitWidth:Se,textFitHeight:sr}=_t[mt];tt[At][mt]={data:null,pixelRatio:_e,sdf:ge,stretchX:Ce,stretchY:xe,content:ve,textFitWidth:Se,textFitHeight:sr,spriteData:{width:Et,height:Dt,x:Rt,y:oe,context:pt}}}}return tt})}(z,$)})}(l,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(v=>{if(this._spriteRequest=null,v)for(const S in v){this._spritesImagesIds[S]=[];const I=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter(M=>!(M in v)):[];for(const M of I)this.imageManager.removeImage(M),this._changedImages[M]=!0;for(const M in v[S]){const D=S==="default"?M:`${S}:${M}`;this._spritesImagesIds[S].push(D),D in this.imageManager.images?this.imageManager.updateImage(D,v[S][M],!1):this.imageManager.addImage(D,v[S][M]),A&&(this._changedImages[D]=!0)}}}).catch(v=>{this._spriteRequest=null,y=v,this.fire(new o.j(y))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),A&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"})),p&&p(y)})}_unloadSprite(){for(const l of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(l),this._changedImages[l]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}_validateLayer(l){const A=this.sourceCaches[l.source];if(!A)return;const p=l.sourceLayer;if(!p)return;const y=A.getSource();(y.type==="geojson"||y.vectorLayerIds&&y.vectorLayerIds.indexOf(p)===-1)&&this.fire(new o.j(new Error(`Source layer "${p}" does not exist on source "${y.id}" as specified by style layer "${l.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(l){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=this._serializedAllLayers();if(!l||l.length===0)return Object.values(A?o.aB(p):p);const y=[];for(const v of l)if(p[v]){const S=A?o.aB(p[v]):p[v];y.push(S)}return y}_serializedAllLayers(){let l=this._serializedLayers;if(l)return l;l=this._serializedLayers={};const A=Object.keys(this._layers);for(const p of A){const y=this._layers[p];y.type!=="custom"&&(l[p]=y.serialize())}return l}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const l in this.sourceCaches)if(this.sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(l){if(!this._loaded)return;const A=this._changed;if(A){const y=Object.keys(this._updatedLayers),v=Object.keys(this._removedLayers);(y.length||v.length)&&this._updateWorkerLayers(y,v);for(const S in this._updatedSources){const I=this._updatedSources[S];if(I==="reload")this._reloadSource(S);else{if(I!=="clear")throw new Error(`Invalid action ${I}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(l);this.light.updateTransitions(l),this.sky.updateTransitions(l),this._resetUpdates()}const p={};for(const y in this.sourceCaches){const v=this.sourceCaches[y];p[y]=v.used,v.used=!1}for(const y of this._order){const v=this._layers[y];v.recalculate(l,this._availableImages),!v.isHidden(l.zoom)&&v.source&&(this.sourceCaches[v.source].used=!0)}for(const y in p){const v=this.sourceCaches[y];!!p[y]!=!!v.used&&v.fire(new o.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:y}))}this.light.recalculate(l),this.sky.recalculate(l),this.z=l.zoom,A&&this.fire(new o.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const A in this.sourceCaches)this.sourceCaches[A].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(l,A){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(l,!1),removedIds:A})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(l){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var p;this._checkLoaded();const y=this.serialize();if(l=A.transformStyle?A.transformStyle(y,l):l,((p=A.validate)===null||p===void 0||p)&&qn(this,o.u(l)))return!1;(l=o.aB(l)).layers=o.az(l.layers);const v=o.aC(y,l),S=this._getOperationsToPerform(v);if(S.unimplemented.length>0)throw new Error(`Unimplemented: ${S.unimplemented.join(", ")}.`);if(S.operations.length===0)return!1;for(const I of S.operations)I();return this.stylesheet=l,this._serializedLayers=null,!0}_getOperationsToPerform(l){const A=[],p=[];for(const y of l)switch(y.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":A.push(()=>this.addLayer.apply(this,y.args));break;case"removeLayer":A.push(()=>this.removeLayer.apply(this,y.args));break;case"setPaintProperty":A.push(()=>this.setPaintProperty.apply(this,y.args));break;case"setLayoutProperty":A.push(()=>this.setLayoutProperty.apply(this,y.args));break;case"setFilter":A.push(()=>this.setFilter.apply(this,y.args));break;case"addSource":A.push(()=>this.addSource.apply(this,y.args));break;case"removeSource":A.push(()=>this.removeSource.apply(this,y.args));break;case"setLayerZoomRange":A.push(()=>this.setLayerZoomRange.apply(this,y.args));break;case"setLight":A.push(()=>this.setLight.apply(this,y.args));break;case"setGeoJSONSourceData":A.push(()=>this.setGeoJSONSourceData.apply(this,y.args));break;case"setGlyphs":A.push(()=>this.setGlyphs.apply(this,y.args));break;case"setSprite":A.push(()=>this.setSprite.apply(this,y.args));break;case"setSky":A.push(()=>this.setSky.apply(this,y.args));break;case"setTerrain":A.push(()=>this.map.setTerrain.apply(this,y.args));break;case"setTransition":A.push(()=>{});break;default:p.push(y.command)}return{operations:A,unimplemented:p}}addImage(l,A){if(this.getImage(l))return this.fire(new o.j(new Error(`An image named "${l}" already exists.`)));this.imageManager.addImage(l,A),this._afterImageUpdated(l)}updateImage(l,A){this.imageManager.updateImage(l,A)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new o.j(new Error(`An image named "${l}" does not exist.`)));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(l,A){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error(`Source "${l}" already exists.`);if(!A.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(A).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(A.type)>=0&&this._validate(o.u.source,`sources.${l}`,A,null,p))return;this.map&&this.map._collectResourceTiming&&(A.collectResourceTiming=!0);const y=this.sourceCaches[l]=new Qe(l,A,this.dispatcher);y.style=this,y.setEventedParent(this,()=>({isSourceLoaded:y.loaded(),source:y.serialize(),sourceId:l})),y.onAdd(this.map),this._changed=!0}removeSource(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===l)return this.fire(new o.j(new Error(`Source "${l}" cannot be removed while layer "${p}" is using it.`)));const A=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],A.fire(new o.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),A.setEventedParent(null),A.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,A){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error(`There is no source with this ID=${l}`);const p=this.sourceCaches[l].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(A),this._changed=!0}getSource(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()}addLayer(l,A){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this._checkLoaded();const y=l.id;if(this.getLayer(y))return void this.fire(new o.j(new Error(`Layer "${y}" already exists on this map.`)));let v;if(l.type==="custom"){if(qn(this,o.aD(l)))return;v=o.aA(l)}else{if("source"in l&&typeof l.source=="object"&&(this.addSource(y,l.source),l=o.aB(l),l=o.e(l,{source:y})),this._validate(o.u.layer,`layers.${y}`,l,{arrayIndex:-1},p))return;v=o.aA(l),this._validateLayer(v),v.setEventedParent(this,{layer:{id:y}})}const S=A?this._order.indexOf(A):this._order.length;if(A&&S===-1)this.fire(new o.j(new Error(`Cannot add layer "${y}" before non-existing layer "${A}".`)));else{if(this._order.splice(S,0,y),this._layerOrderChanged=!0,this._layers[y]=v,this._removedLayers[y]&&v.source&&v.type!=="custom"){const I=this._removedLayers[y];delete this._removedLayers[y],I.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",this.sourceCaches[v.source].pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map)}}moveLayer(l,A){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new o.j(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===A)return;const p=this._order.indexOf(l);this._order.splice(p,1);const y=A?this._order.indexOf(A):this._order.length;A&&y===-1?this.fire(new o.j(new Error(`Cannot move layer "${l}" before non-existing layer "${A}".`))):(this._order.splice(y,0,l),this._layerOrderChanged=!0)}removeLayer(l){this._checkLoaded();const A=this._layers[l];if(!A)return void this.fire(new o.j(new Error(`Cannot remove non-existing layer "${l}".`)));A.setEventedParent(null);const p=this._order.indexOf(l);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=A,delete this._layers[l],this._serializedLayers&&delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],A.onRemove&&A.onRemove(this.map)}getLayer(l){return this._layers[l]}getLayersOrder(){return[...this._order]}hasLayer(l){return l in this._layers}setLayerZoomRange(l,A,p){this._checkLoaded();const y=this.getLayer(l);y?y.minzoom===A&&y.maxzoom===p||(A!=null&&(y.minzoom=A),p!=null&&(y.maxzoom=p),this._updateLayer(y)):this.fire(new o.j(new Error(`Cannot set the zoom range of non-existing layer "${l}".`)))}setFilter(l,A){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this._checkLoaded();const y=this.getLayer(l);if(y){if(!o.aE(y.filter,A))return A==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(o.u.filter,`layers.${y.id}.filter`,A,null,p)||(y.filter=o.aB(A),this._updateLayer(y)))}else this.fire(new o.j(new Error(`Cannot filter non-existing layer "${l}".`)))}getFilter(l){return o.aB(this.getLayer(l).filter)}setLayoutProperty(l,A,p){let y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this._checkLoaded();const v=this.getLayer(l);v?o.aE(v.getLayoutProperty(A),p)||(v.setLayoutProperty(A,p,y),this._updateLayer(v)):this.fire(new o.j(new Error(`Cannot style non-existing layer "${l}".`)))}getLayoutProperty(l,A){const p=this.getLayer(l);if(p)return p.getLayoutProperty(A);this.fire(new o.j(new Error(`Cannot get style of non-existing layer "${l}".`)))}setPaintProperty(l,A,p){let y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this._checkLoaded();const v=this.getLayer(l);v?o.aE(v.getPaintProperty(A),p)||(v.setPaintProperty(A,p,y)&&this._updateLayer(v),this._changed=!0,this._updatedPaintProps[l]=!0,this._serializedLayers=null):this.fire(new o.j(new Error(`Cannot style non-existing layer "${l}".`)))}getPaintProperty(l,A){return this.getLayer(l).getPaintProperty(A)}setFeatureState(l,A){this._checkLoaded();const p=l.source,y=l.sourceLayer,v=this.sourceCaches[p];if(v===void 0)return void this.fire(new o.j(new Error(`The source '${p}' does not exist in the map's style.`)));const S=v.getSource().type;S==="geojson"&&y?this.fire(new o.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):S!=="vector"||y?(l.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),v.setFeatureState(y,l.id,A)):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(l,A){this._checkLoaded();const p=l.source,y=this.sourceCaches[p];if(y===void 0)return void this.fire(new o.j(new Error(`The source '${p}' does not exist in the map's style.`)));const v=y.getSource().type,S=v==="vector"?l.sourceLayer:void 0;v!=="vector"||S?A&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new o.j(new Error("A feature id is required to remove its specific state property."))):y.removeFeatureState(S,l.id,A):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(l){this._checkLoaded();const A=l.source,p=l.sourceLayer,y=this.sourceCaches[A];if(y!==void 0)return y.getSource().type!=="vector"||p?(l.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),y.getFeatureState(p,l.id)):void this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.j(new Error(`The source '${A}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const l=o.aF(this.sourceCaches,v=>v.serialize()),A=this._serializeByIds(this._order,!0),p=this.map.getTerrain()||void 0,y=this.stylesheet;return o.aG({version:y.version,name:y.name,metadata:y.metadata,light:y.light,sky:y.sky,center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch,sprite:y.sprite,glyphs:y.glyphs,transition:y.transition,sources:l,layers:A,terrain:p},v=>v!==void 0)}_updateLayer(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(l){const A=S=>this._layers[S].type==="fill-extrusion",p={},y=[];for(let S=this._order.length-1;S>=0;S--){const I=this._order[S];if(A(I)){p[I]=S;for(const M of l){const D=M[I];if(D)for(const H of D)y.push(H)}}}y.sort((S,I)=>I.intersectionZ-S.intersectionZ);const v=[];for(let S=this._order.length-1;S>=0;S--){const I=this._order[S];if(A(I))for(let M=y.length-1;M>=0;M--){const D=y[M].feature;if(p[D.layer.id]<S)break;v.push(D),y.pop()}else for(const M of l){const D=M[I];if(D)for(const H of D)v.push(H.feature)}}return v}queryRenderedFeatures(l,A,p){A&&A.filter&&this._validate(o.u.filter,"queryRenderedFeatures.filter",A.filter,null,A);const y={};if(A&&A.layers){if(!Array.isArray(A.layers))return this.fire(new o.j(new Error("parameters.layers must be an Array."))),[];for(const I of A.layers){const M=this._layers[I];if(!M)return this.fire(new o.j(new Error(`The layer '${I}' does not exist in the map's style and cannot be queried for features.`))),[];y[M.source]=!0}}const v=[];A.availableImages=this._availableImages;const S=this._serializedAllLayers();for(const I in this.sourceCaches)A.layers&&!y[I]||v.push(He(this.sourceCaches[I],this._layers,S,l,A,p));return this.placement&&v.push(function(I,M,D,H,z,$,J){const K={},tt=$.queryRenderedSymbols(H),At=[];for(const pt of Object.keys(tt).map(Number))At.push(J[pt]);At.sort(Ke);for(const pt of At){const _t=pt.featureIndex.lookupSymbolFeatures(tt[pt.bucketInstanceId],M,pt.bucketIndex,pt.sourceLayerIndex,z.filter,z.layers,z.availableImages,I);for(const mt in _t){const Et=K[mt]=K[mt]||[],Dt=_t[mt];Dt.sort((Rt,oe)=>{const ge=pt.featureSortOrder;if(ge){const _e=ge.indexOf(Rt.featureIndex);return ge.indexOf(oe.featureIndex)-_e}return oe.featureIndex-Rt.featureIndex});for(const Rt of Dt)Et.push(Rt)}}for(const pt in K)K[pt].forEach(_t=>{const mt=_t.feature,Et=D[I[pt].source].getFeatureState(mt.layer["source-layer"],mt.id);mt.source=mt.layer.source,mt.layer["source-layer"]&&(mt.sourceLayer=mt.layer["source-layer"]),mt.state=Et});return K}(this._layers,S,this.sourceCaches,l,A,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(l,A){A&&A.filter&&this._validate(o.u.filter,"querySourceFeatures.filter",A.filter,null,A);const p=this.sourceCaches[l];return p?function(y,v){const S=y.getRenderableIds().map(D=>y.getTileByID(D)),I=[],M={};for(let D=0;D<S.length;D++){const H=S[D],z=H.tileID.canonical.key;M[z]||(M[z]=!0,H.querySourceFeatures(I,v))}return I}(p,A):[]}getLight(){return this.light.getLight()}setLight(l){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this._checkLoaded();const p=this.light.getLight();let y=!1;for(const S in l)if(!o.aE(l[S],p[S])){y=!0;break}if(!y)return;const v={now:w.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,A),this.light.updateTransitions(v)}getSky(){var l;return(l=this.stylesheet)===null||l===void 0?void 0:l.sky}setSky(l){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const p=this.getSky();let y=!1;if(!l&&!p)return;if(l&&!p)y=!0;else if(!l&&p)y=!0;else for(const S in l)if(!o.aE(l[S],p[S])){y=!0;break}if(!y)return;const v={now:w.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=l,this.sky.setSky(l,A),this.sky.updateTransitions(v)}_validate(l,A,p,y){let v=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};return(!v||v.validate!==!1)&&qn(this,l.call(o.u,o.e({key:A,style:this.serialize(),value:p,styleSpec:o.v},y)))}_remove(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),De().off(de,this._rtlPluginLoaded);for(const A in this._layers)this._layers[A].setEventedParent(null);for(const A in this.sourceCaches){const p=this.sourceCaches[A];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),l&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(l)}_clearSource(l){this.sourceCaches[l].clearTiles()}_reloadSource(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()}_updateSources(l){for(const A in this.sourceCaches)this.sourceCaches[A].update(l,this.map.terrain)}_generateCollisionBoxes(){for(const l in this.sourceCaches)this._reloadSource(l)}_updatePlacement(l,A,p,y){let v=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,S=!1,I=!1;const M={};for(const D of this._order){const H=this._layers[D];if(H.type!=="symbol")continue;if(!M[H.source]){const $=this.sourceCaches[H.source];M[H.source]=$.getRenderableIds(!0).map(J=>$.getTileByID(J)).sort((J,K)=>K.tileID.overscaledZ-J.tileID.overscaledZ||(J.tileID.isLessThan(K.tileID)?-1:1))}const z=this.crossTileSymbolIndex.addLayer(H,M[H.source],l.center.lng);S=S||z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((v=v||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(w.now(),l.zoom))&&(this.pauseablePlacement=new hn(l,this.map.terrain,this._order,v,A,p,y,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(w.now()),I=!0),S&&this.pauseablePlacement.placement.setStale()),I||S)for(const D of this._order){const H=this._layers[D];H.type==="symbol"&&this.placement.updateLayerOpacities(H,M[H.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(w.now())}_releaseSymbolFadeTiles(){for(const l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,A){return o._(this,void 0,void 0,function*(){const p=yield this.imageManager.getImages(A.icons);this._updateTilesForChangedImages();const y=this.sourceCaches[A.source];return y&&y.setDependencies(A.tileID.key,A.type,A.icons),p})}getGlyphs(l,A){return o._(this,void 0,void 0,function*(){const p=yield this.glyphManager.getGlyphs(A.stacks),y=this.sourceCaches[A.source];return y&&y.setDependencies(A.tileID.key,A.type,[""]),p})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(l){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this._checkLoaded(),l&&this._validate(o.u.glyphs,"glyphs",l,null,A)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=l,this.glyphManager.entries={},this.glyphManager.setURL(l))}addSprite(l,A){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},y=arguments.length>3?arguments[3]:void 0;this._checkLoaded();const v=[{id:l,url:A}],S=[...It(this.stylesheet.sprite),...v];this._validate(o.u.sprite,"sprite",S,null,p)||(this.stylesheet.sprite=S,this._loadSprite(v,!0,y))}removeSprite(l){this._checkLoaded();const A=It(this.stylesheet.sprite);if(A.find(p=>p.id===l)){if(this._spritesImagesIds[l])for(const p of this._spritesImagesIds[l])this.imageManager.removeImage(p),this._changedImages[p]=!0;A.splice(A.findIndex(p=>p.id===l),1),this.stylesheet.sprite=A.length>0?A:void 0,delete this._spritesImagesIds[l],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}else this.fire(new o.j(new Error(`Sprite "${l}" doesn't exists on this map.`)))}getSprite(){return It(this.stylesheet.sprite)}setSprite(l){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=arguments.length>2?arguments[2]:void 0;this._checkLoaded(),l&&this._validate(o.u.sprite,"sprite",l,null,A)||(this.stylesheet.sprite=l,l?this._loadSprite(l,!0,p):(this._unloadSprite(),p&&p(null)))}}var Qs=o.Y([{name:"a_pos",type:"Int16",components:2}]);const Bs={prelude:un(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:un(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:un(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:un(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:un("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:un(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:un(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:un("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:un("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:un("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:un(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:un(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:un(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:un(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:un(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:un(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:un(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:un(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:un(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:un(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:un(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:un(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:un(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:un(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:un(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:un(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:un("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:un("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:un("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:un("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function un(m,l){const A=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=l.match(/attribute ([\w]+) ([\w]+)/g),y=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=v?v.concat(y):y,I={};return{fragmentSource:m=m.replace(A,(M,D,H,z,$)=>(I[$]=!0,D==="define"?`
#ifndef HAS_UNIFORM_u_${$}
varying ${H} ${z} ${$};
#else
uniform ${H} ${z} u_${$};
#endif
`:`
#ifdef HAS_UNIFORM_u_${$}
    ${H} ${z} ${$} = u_${$};
#endif
`)),vertexSource:l=l.replace(A,(M,D,H,z,$)=>{const J=z==="float"?"vec2":"vec4",K=$.match(/color/)?"color":J;return I[$]?D==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${H} ${J} a_${$};
varying ${H} ${z} ${$};
#else
uniform ${H} ${z} u_${$};
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = a_${$};
#else
    ${H} ${z} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = unpack_mix_${K}(a_${$}, u_${$}_t);
#else
    ${H} ${z} ${$} = u_${$};
#endif
`:D==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${H} ${J} a_${$};
#else
uniform ${H} ${z} u_${$};
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${H} ${z} ${$} = a_${$};
#else
    ${H} ${z} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${H} ${z} ${$} = unpack_mix_${K}(a_${$}, u_${$}_t);
#else
    ${H} ${z} ${$} = u_${$};
#endif
`}),staticAttributes:p,staticUniforms:S}}class Cl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,A,p,y,v,S,I,M,D){this.context=l;let H=this.boundPaintVertexBuffers.length!==y.length;for(let z=0;!H&&z<y.length;z++)this.boundPaintVertexBuffers[z]!==y[z]&&(H=!0);!this.vao||this.boundProgram!==A||this.boundLayoutVertexBuffer!==p||H||this.boundIndexBuffer!==v||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==I||this.boundDynamicVertexBuffer2!==M||this.boundDynamicVertexBuffer3!==D?this.freshBind(A,p,y,v,S,I,M,D):(l.bindVertexArray.set(this.vao),I&&I.bind(),v&&v.dynamicDraw&&v.bind(),M&&M.bind(),D&&D.bind())}freshBind(l,A,p,y,v,S,I,M){const D=l.numAttributes,H=this.context,z=H.gl;this.vao&&this.destroy(),this.vao=H.createVertexArray(),H.bindVertexArray.set(this.vao),this.boundProgram=l,this.boundLayoutVertexBuffer=A,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=y,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=I,this.boundDynamicVertexBuffer3=M,A.enableAttributes(z,l);for(const $ of p)$.enableAttributes(z,l);S&&S.enableAttributes(z,l),I&&I.enableAttributes(z,l),M&&M.enableAttributes(z,l),A.bind(),A.setVertexAttribPointers(z,l,v);for(const $ of p)$.bind(),$.setVertexAttribPointers(z,l,v);S&&(S.bind(),S.setVertexAttribPointers(z,l,v)),y&&y.bind(),I&&(I.bind(),I.setVertexAttribPointers(z,l,v)),M&&(M.bind(),M.setVertexAttribPointers(z,l,v)),H.currentNumAttributes=D}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const mc=(m,l,A,p,y)=>({u_matrix:m,u_texture:0,u_ele_delta:l,u_fog_matrix:A,u_fog_color:p?p.properties.get("fog-color"):o.aM.white,u_fog_ground_blend:p?p.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:p?p.calculateFogBlendOpacity(y):0,u_horizon_color:p?p.properties.get("horizon-color"):o.aM.white,u_horizon_fog_blend:p?p.properties.get("horizon-fog-blend"):1});function ut(m){const l=[];for(let A=0;A<m.length;A++){if(m[A]===null)continue;const p=m[A].split(" ");l.push(p.pop())}return l}class xt{constructor(l,A,p,y,v,S){const I=l.gl;this.program=I.createProgram();const M=ut(A.staticAttributes),D=p?p.getBinderAttributes():[],H=M.concat(D),z=Bs.prelude.staticUniforms?ut(Bs.prelude.staticUniforms):[],$=A.staticUniforms?ut(A.staticUniforms):[],J=p?p.getBinderUniforms():[],K=z.concat($).concat(J),tt=[];for(const Rt of K)tt.indexOf(Rt)<0&&tt.push(Rt);const At=p?p.defines():[];v&&At.push("#define OVERDRAW_INSPECTOR;"),S&&At.push("#define TERRAIN3D;");const pt=At.concat(Bs.prelude.fragmentSource,A.fragmentSource).join(`
`),_t=At.concat(Bs.prelude.vertexSource,A.vertexSource).join(`
`),mt=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);if(I.shaderSource(mt,pt),I.compileShader(mt),!I.getShaderParameter(mt,I.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${I.getShaderInfoLog(mt)}`);I.attachShader(this.program,mt);const Et=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);if(I.shaderSource(Et,_t),I.compileShader(Et),!I.getShaderParameter(Et,I.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${I.getShaderInfoLog(Et)}`);I.attachShader(this.program,Et),this.attributes={};const Dt={};this.numAttributes=H.length;for(let Rt=0;Rt<this.numAttributes;Rt++)H[Rt]&&(I.bindAttribLocation(this.program,Rt,H[Rt]),this.attributes[H[Rt]]=Rt);if(I.linkProgram(this.program),!I.getProgramParameter(this.program,I.LINK_STATUS))throw new Error(`Program failed to link: ${I.getProgramInfoLog(this.program)}`);I.deleteShader(Et),I.deleteShader(mt);for(let Rt=0;Rt<tt.length;Rt++){const oe=tt[Rt];if(oe&&!Dt[oe]){const ge=I.getUniformLocation(this.program,oe);ge&&(Dt[oe]=ge)}}this.fixedUniforms=y(l,Dt),this.terrainUniforms=((Rt,oe)=>({u_depth:new o.aH(Rt,oe.u_depth),u_terrain:new o.aH(Rt,oe.u_terrain),u_terrain_dim:new o.aI(Rt,oe.u_terrain_dim),u_terrain_matrix:new o.aJ(Rt,oe.u_terrain_matrix),u_terrain_unpack:new o.aK(Rt,oe.u_terrain_unpack),u_terrain_exaggeration:new o.aI(Rt,oe.u_terrain_exaggeration)}))(l,Dt),this.binderUniforms=p?p.getUniforms(l,Dt):[]}draw(l,A,p,y,v,S,I,M,D,H,z,$,J,K,tt,At,pt,_t){const mt=l.gl;if(this.failedToCreate)return;if(l.program.set(this.program),l.setDepthMode(p),l.setStencilMode(y),l.setColorMode(v),l.setCullFace(S),M){l.activeTexture.set(mt.TEXTURE2),mt.bindTexture(mt.TEXTURE_2D,M.depthTexture),l.activeTexture.set(mt.TEXTURE3),mt.bindTexture(mt.TEXTURE_2D,M.texture);for(const Dt in this.terrainUniforms)this.terrainUniforms[Dt].set(M[Dt])}for(const Dt in this.fixedUniforms)this.fixedUniforms[Dt].set(I[Dt]);tt&&tt.setUniforms(l,this.binderUniforms,J,{zoom:K});let Et=0;switch(A){case mt.LINES:Et=2;break;case mt.TRIANGLES:Et=3;break;case mt.LINE_STRIP:Et=1}for(const Dt of $.get()){const Rt=Dt.vaos||(Dt.vaos={});(Rt[D]||(Rt[D]=new Cl)).bind(l,this,H,tt?tt.getPaintVertexBuffers():[],z,Dt.vertexOffset,At,pt,_t),mt.drawElements(A,Dt.primitiveLength*Et,mt.UNSIGNED_SHORT,Dt.primitiveOffset*Et*2)}}}function kt(m,l,A){const p=1/xr(A,1,l.transform.tileZoom),y=Math.pow(2,A.tileID.overscaledZ),v=A.tileSize*Math.pow(2,l.transform.tileZoom)/y,S=v*(A.tileID.canonical.x+A.tileID.wrap*y),I=v*A.tileID.canonical.y;return{u_image:0,u_texsize:A.imageAtlasTexture.size,u_scale:[p,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[S>>16,I>>16],u_pixel_coord_lower:[65535&S,65535&I]}}const ae=(m,l,A,p)=>{const y=l.style.light,v=y.properties.get("position"),S=[v.x,v.y,v.z],I=function(){var D=new o.A(9);return o.A!=Float32Array&&(D[1]=0,D[2]=0,D[3]=0,D[5]=0,D[6]=0,D[7]=0),D[0]=1,D[4]=1,D[8]=1,D}();y.properties.get("anchor")==="viewport"&&function(D,H){var z=Math.sin(H),$=Math.cos(H);D[0]=$,D[1]=z,D[2]=0,D[3]=-z,D[4]=$,D[5]=0,D[6]=0,D[7]=0,D[8]=1}(I,-l.transform.angle),function(D,H,z){var $=H[0],J=H[1],K=H[2];D[0]=$*z[0]+J*z[3]+K*z[6],D[1]=$*z[1]+J*z[4]+K*z[7],D[2]=$*z[2]+J*z[5]+K*z[8]}(S,S,I);const M=y.properties.get("color");return{u_matrix:m,u_lightpos:S,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[M.r,M.g,M.b],u_vertical_gradient:+A,u_opacity:p}},Fe=(m,l,A,p,y,v,S)=>o.e(ae(m,l,A,p),kt(v,l,S),{u_height_factor:-Math.pow(2,y.overscaledZ)/S.tileSize/8}),Xe=m=>({u_matrix:m}),zr=(m,l,A,p)=>o.e(Xe(m),kt(A,l,p)),Xn=(m,l)=>({u_matrix:m,u_world:l}),Jn=(m,l,A,p,y)=>o.e(zr(m,l,A,p),{u_world:y}),Si=(m,l,A,p)=>{const y=m.transform;let v,S;if(p.paint.get("circle-pitch-alignment")==="map"){const I=xr(A,1,y.zoom);v=!0,S=[I,I]}else v=!1,S=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(p.paint.get("circle-pitch-scale")==="map"),u_matrix:m.translatePosMatrix(l.posMatrix,A,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+v,u_device_pixel_ratio:m.pixelRatio,u_extrude_scale:S}},wn=(m,l,A)=>({u_matrix:m,u_inv_matrix:l,u_camera_to_center_distance:A.cameraToCenterDistance,u_viewport_size:[A.width,A.height]}),yc=function(m,l){let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return{u_matrix:m,u_color:l,u_overlay:0,u_overlay_scale:A}},Zi=m=>({u_matrix:m}),Br=(m,l,A,p)=>({u_matrix:m,u_extrude_scale:xr(l,1,A),u_intensity:p}),tu=(m,l,A,p)=>{const y=o.H();o.aP(y,0,m.width,m.height,0,0,1);const v=m.context.gl;return{u_matrix:y,u_world:[v.drawingBufferWidth,v.drawingBufferHeight],u_image:A,u_color_ramp:p,u_opacity:l.paint.get("heatmap-opacity")}};function eu(m,l){const A=Math.pow(2,l.canonical.z),p=l.canonical.y;return[new o.Z(0,p/A).toLngLat().lat,new o.Z(0,(p+1)/A).toLngLat().lat]}const to=(m,l,A,p)=>{const y=m.transform;return{u_matrix:dh(m,l,A,p),u_ratio:1/xr(l,1,y.zoom),u_device_pixel_ratio:m.pixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},lA=(m,l,A,p,y)=>o.e(to(m,l,A,y),{u_image:0,u_image_height:p}),Wa=(m,l,A,p,y)=>{const v=m.transform,S=nu(l,v);return{u_matrix:dh(m,l,A,y),u_texsize:l.imageAtlasTexture.size,u_ratio:1/xr(l,1,v.zoom),u_device_pixel_ratio:m.pixelRatio,u_image:0,u_scale:[S,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},ru=(m,l,A,p,y,v)=>{const S=m.lineAtlas,I=nu(l,m.transform),M=A.layout.get("line-cap")==="round",D=S.getDash(p.from,M),H=S.getDash(p.to,M),z=D.width*y.fromScale,$=H.width*y.toScale;return o.e(to(m,l,A,v),{u_patternscale_a:[I/z,-D.height/2],u_patternscale_b:[I/$,-H.height/2],u_sdfgamma:S.width/(256*Math.min(z,$)*m.pixelRatio)/2,u_image:0,u_tex_y_a:D.y,u_tex_y_b:H.y,u_mix:y.t})};function nu(m,l){return 1/xr(m,1,l.tileZoom)}function dh(m,l,A,p){return m.translatePosMatrix(p?p.posMatrix:l.tileID.posMatrix,l,A.paint.get("line-translate"),A.paint.get("line-translate-anchor"))}const Cd=(m,l,A,p,y)=>{return{u_matrix:m,u_tl_parent:l,u_scale_parent:A,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(S=y.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(v=y.paint.get("raster-contrast"),v>0?1/(1-v):1+v),u_spin_weights:Ed(y.paint.get("raster-hue-rotate"))};var v,S};function Ed(m){m*=Math.PI/180;const l=Math.sin(m),A=Math.cos(m);return[(2*A+1)/3,(-Math.sqrt(3)*l-A+1)/3,(Math.sqrt(3)*l-A+1)/3]}const iu=(m,l,A,p,y,v,S,I,M,D,H,z,$,J)=>{const K=S.transform;return{u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:K.cameraToCenterDistance,u_pitch:K.pitch/360*2*Math.PI,u_rotate_symbol:+A,u_aspect_ratio:K.width/K.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:I,u_label_plane_matrix:M,u_coord_matrix:D,u_is_text:+z,u_pitch_with_map:+p,u_is_along_line:y,u_is_variable_anchor:v,u_texsize:$,u_texture:0,u_translation:H,u_pitched_scale:J}},Xo=(m,l,A,p,y,v,S,I,M,D,H,z,$,J,K)=>{const tt=S.transform;return o.e(iu(m,l,A,p,y,v,S,I,M,D,H,z,$,K),{u_gamma_scale:p?Math.cos(tt._pitch)*tt.cameraToCenterDistance:1,u_device_pixel_ratio:S.pixelRatio,u_is_halo:+J})},_a=(m,l,A,p,y,v,S,I,M,D,H,z,$,J)=>o.e(Xo(m,l,A,p,y,v,S,I,M,D,H,!0,z,!0,J),{u_texsize_icon:$,u_texture_icon:1}),su=(m,l,A)=>({u_matrix:m,u_opacity:l,u_color:A}),Xa=(m,l,A,p,y,v)=>o.e(function(S,I,M,D){const H=M.imageManager.getPattern(S.from.toString()),z=M.imageManager.getPattern(S.to.toString()),{width:$,height:J}=M.imageManager.getPixelSize(),K=Math.pow(2,D.tileID.overscaledZ),tt=D.tileSize*Math.pow(2,M.transform.tileZoom)/K,At=tt*(D.tileID.canonical.x+D.tileID.wrap*K),pt=tt*D.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:H.tl,u_pattern_br_a:H.br,u_pattern_tl_b:z.tl,u_pattern_br_b:z.br,u_texsize:[$,J],u_mix:I.t,u_pattern_size_a:H.displaySize,u_pattern_size_b:z.displaySize,u_scale_a:I.fromScale,u_scale_b:I.toScale,u_tile_units_to_pixels:1/xr(D,1,M.transform.tileZoom),u_pixel_coord_upper:[At>>16,pt>>16],u_pixel_coord_lower:[65535&At,65535&pt]}}(p,v,A,y),{u_matrix:m,u_opacity:l}),_c={fillExtrusion:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_lightpos:new o.aN(m,l.u_lightpos),u_lightintensity:new o.aI(m,l.u_lightintensity),u_lightcolor:new o.aN(m,l.u_lightcolor),u_vertical_gradient:new o.aI(m,l.u_vertical_gradient),u_opacity:new o.aI(m,l.u_opacity)}),fillExtrusionPattern:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_lightpos:new o.aN(m,l.u_lightpos),u_lightintensity:new o.aI(m,l.u_lightintensity),u_lightcolor:new o.aN(m,l.u_lightcolor),u_vertical_gradient:new o.aI(m,l.u_vertical_gradient),u_height_factor:new o.aI(m,l.u_height_factor),u_image:new o.aH(m,l.u_image),u_texsize:new o.aO(m,l.u_texsize),u_pixel_coord_upper:new o.aO(m,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aO(m,l.u_pixel_coord_lower),u_scale:new o.aN(m,l.u_scale),u_fade:new o.aI(m,l.u_fade),u_opacity:new o.aI(m,l.u_opacity)}),fill:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix)}),fillPattern:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_image:new o.aH(m,l.u_image),u_texsize:new o.aO(m,l.u_texsize),u_pixel_coord_upper:new o.aO(m,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aO(m,l.u_pixel_coord_lower),u_scale:new o.aN(m,l.u_scale),u_fade:new o.aI(m,l.u_fade)}),fillOutline:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_world:new o.aO(m,l.u_world)}),fillOutlinePattern:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_world:new o.aO(m,l.u_world),u_image:new o.aH(m,l.u_image),u_texsize:new o.aO(m,l.u_texsize),u_pixel_coord_upper:new o.aO(m,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aO(m,l.u_pixel_coord_lower),u_scale:new o.aN(m,l.u_scale),u_fade:new o.aI(m,l.u_fade)}),circle:(m,l)=>({u_camera_to_center_distance:new o.aI(m,l.u_camera_to_center_distance),u_scale_with_map:new o.aH(m,l.u_scale_with_map),u_pitch_with_map:new o.aH(m,l.u_pitch_with_map),u_extrude_scale:new o.aO(m,l.u_extrude_scale),u_device_pixel_ratio:new o.aI(m,l.u_device_pixel_ratio),u_matrix:new o.aJ(m,l.u_matrix)}),collisionBox:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_pixel_extrude_scale:new o.aO(m,l.u_pixel_extrude_scale)}),collisionCircle:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_inv_matrix:new o.aJ(m,l.u_inv_matrix),u_camera_to_center_distance:new o.aI(m,l.u_camera_to_center_distance),u_viewport_size:new o.aO(m,l.u_viewport_size)}),debug:(m,l)=>({u_color:new o.aL(m,l.u_color),u_matrix:new o.aJ(m,l.u_matrix),u_overlay:new o.aH(m,l.u_overlay),u_overlay_scale:new o.aI(m,l.u_overlay_scale)}),clippingMask:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix)}),heatmap:(m,l)=>({u_extrude_scale:new o.aI(m,l.u_extrude_scale),u_intensity:new o.aI(m,l.u_intensity),u_matrix:new o.aJ(m,l.u_matrix)}),heatmapTexture:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_world:new o.aO(m,l.u_world),u_image:new o.aH(m,l.u_image),u_color_ramp:new o.aH(m,l.u_color_ramp),u_opacity:new o.aI(m,l.u_opacity)}),hillshade:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_image:new o.aH(m,l.u_image),u_latrange:new o.aO(m,l.u_latrange),u_light:new o.aO(m,l.u_light),u_shadow:new o.aL(m,l.u_shadow),u_highlight:new o.aL(m,l.u_highlight),u_accent:new o.aL(m,l.u_accent)}),hillshadePrepare:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_image:new o.aH(m,l.u_image),u_dimension:new o.aO(m,l.u_dimension),u_zoom:new o.aI(m,l.u_zoom),u_unpack:new o.aK(m,l.u_unpack)}),line:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_ratio:new o.aI(m,l.u_ratio),u_device_pixel_ratio:new o.aI(m,l.u_device_pixel_ratio),u_units_to_pixels:new o.aO(m,l.u_units_to_pixels)}),lineGradient:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_ratio:new o.aI(m,l.u_ratio),u_device_pixel_ratio:new o.aI(m,l.u_device_pixel_ratio),u_units_to_pixels:new o.aO(m,l.u_units_to_pixels),u_image:new o.aH(m,l.u_image),u_image_height:new o.aI(m,l.u_image_height)}),linePattern:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_texsize:new o.aO(m,l.u_texsize),u_ratio:new o.aI(m,l.u_ratio),u_device_pixel_ratio:new o.aI(m,l.u_device_pixel_ratio),u_image:new o.aH(m,l.u_image),u_units_to_pixels:new o.aO(m,l.u_units_to_pixels),u_scale:new o.aN(m,l.u_scale),u_fade:new o.aI(m,l.u_fade)}),lineSDF:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_ratio:new o.aI(m,l.u_ratio),u_device_pixel_ratio:new o.aI(m,l.u_device_pixel_ratio),u_units_to_pixels:new o.aO(m,l.u_units_to_pixels),u_patternscale_a:new o.aO(m,l.u_patternscale_a),u_patternscale_b:new o.aO(m,l.u_patternscale_b),u_sdfgamma:new o.aI(m,l.u_sdfgamma),u_image:new o.aH(m,l.u_image),u_tex_y_a:new o.aI(m,l.u_tex_y_a),u_tex_y_b:new o.aI(m,l.u_tex_y_b),u_mix:new o.aI(m,l.u_mix)}),raster:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_tl_parent:new o.aO(m,l.u_tl_parent),u_scale_parent:new o.aI(m,l.u_scale_parent),u_buffer_scale:new o.aI(m,l.u_buffer_scale),u_fade_t:new o.aI(m,l.u_fade_t),u_opacity:new o.aI(m,l.u_opacity),u_image0:new o.aH(m,l.u_image0),u_image1:new o.aH(m,l.u_image1),u_brightness_low:new o.aI(m,l.u_brightness_low),u_brightness_high:new o.aI(m,l.u_brightness_high),u_saturation_factor:new o.aI(m,l.u_saturation_factor),u_contrast_factor:new o.aI(m,l.u_contrast_factor),u_spin_weights:new o.aN(m,l.u_spin_weights)}),symbolIcon:(m,l)=>({u_is_size_zoom_constant:new o.aH(m,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aH(m,l.u_is_size_feature_constant),u_size_t:new o.aI(m,l.u_size_t),u_size:new o.aI(m,l.u_size),u_camera_to_center_distance:new o.aI(m,l.u_camera_to_center_distance),u_pitch:new o.aI(m,l.u_pitch),u_rotate_symbol:new o.aH(m,l.u_rotate_symbol),u_aspect_ratio:new o.aI(m,l.u_aspect_ratio),u_fade_change:new o.aI(m,l.u_fade_change),u_matrix:new o.aJ(m,l.u_matrix),u_label_plane_matrix:new o.aJ(m,l.u_label_plane_matrix),u_coord_matrix:new o.aJ(m,l.u_coord_matrix),u_is_text:new o.aH(m,l.u_is_text),u_pitch_with_map:new o.aH(m,l.u_pitch_with_map),u_is_along_line:new o.aH(m,l.u_is_along_line),u_is_variable_anchor:new o.aH(m,l.u_is_variable_anchor),u_texsize:new o.aO(m,l.u_texsize),u_texture:new o.aH(m,l.u_texture),u_translation:new o.aO(m,l.u_translation),u_pitched_scale:new o.aI(m,l.u_pitched_scale)}),symbolSDF:(m,l)=>({u_is_size_zoom_constant:new o.aH(m,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aH(m,l.u_is_size_feature_constant),u_size_t:new o.aI(m,l.u_size_t),u_size:new o.aI(m,l.u_size),u_camera_to_center_distance:new o.aI(m,l.u_camera_to_center_distance),u_pitch:new o.aI(m,l.u_pitch),u_rotate_symbol:new o.aH(m,l.u_rotate_symbol),u_aspect_ratio:new o.aI(m,l.u_aspect_ratio),u_fade_change:new o.aI(m,l.u_fade_change),u_matrix:new o.aJ(m,l.u_matrix),u_label_plane_matrix:new o.aJ(m,l.u_label_plane_matrix),u_coord_matrix:new o.aJ(m,l.u_coord_matrix),u_is_text:new o.aH(m,l.u_is_text),u_pitch_with_map:new o.aH(m,l.u_pitch_with_map),u_is_along_line:new o.aH(m,l.u_is_along_line),u_is_variable_anchor:new o.aH(m,l.u_is_variable_anchor),u_texsize:new o.aO(m,l.u_texsize),u_texture:new o.aH(m,l.u_texture),u_gamma_scale:new o.aI(m,l.u_gamma_scale),u_device_pixel_ratio:new o.aI(m,l.u_device_pixel_ratio),u_is_halo:new o.aH(m,l.u_is_halo),u_translation:new o.aO(m,l.u_translation),u_pitched_scale:new o.aI(m,l.u_pitched_scale)}),symbolTextAndIcon:(m,l)=>({u_is_size_zoom_constant:new o.aH(m,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aH(m,l.u_is_size_feature_constant),u_size_t:new o.aI(m,l.u_size_t),u_size:new o.aI(m,l.u_size),u_camera_to_center_distance:new o.aI(m,l.u_camera_to_center_distance),u_pitch:new o.aI(m,l.u_pitch),u_rotate_symbol:new o.aH(m,l.u_rotate_symbol),u_aspect_ratio:new o.aI(m,l.u_aspect_ratio),u_fade_change:new o.aI(m,l.u_fade_change),u_matrix:new o.aJ(m,l.u_matrix),u_label_plane_matrix:new o.aJ(m,l.u_label_plane_matrix),u_coord_matrix:new o.aJ(m,l.u_coord_matrix),u_is_text:new o.aH(m,l.u_is_text),u_pitch_with_map:new o.aH(m,l.u_pitch_with_map),u_is_along_line:new o.aH(m,l.u_is_along_line),u_is_variable_anchor:new o.aH(m,l.u_is_variable_anchor),u_texsize:new o.aO(m,l.u_texsize),u_texsize_icon:new o.aO(m,l.u_texsize_icon),u_texture:new o.aH(m,l.u_texture),u_texture_icon:new o.aH(m,l.u_texture_icon),u_gamma_scale:new o.aI(m,l.u_gamma_scale),u_device_pixel_ratio:new o.aI(m,l.u_device_pixel_ratio),u_is_halo:new o.aH(m,l.u_is_halo),u_translation:new o.aO(m,l.u_translation),u_pitched_scale:new o.aI(m,l.u_pitched_scale)}),background:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_opacity:new o.aI(m,l.u_opacity),u_color:new o.aL(m,l.u_color)}),backgroundPattern:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_opacity:new o.aI(m,l.u_opacity),u_image:new o.aH(m,l.u_image),u_pattern_tl_a:new o.aO(m,l.u_pattern_tl_a),u_pattern_br_a:new o.aO(m,l.u_pattern_br_a),u_pattern_tl_b:new o.aO(m,l.u_pattern_tl_b),u_pattern_br_b:new o.aO(m,l.u_pattern_br_b),u_texsize:new o.aO(m,l.u_texsize),u_mix:new o.aI(m,l.u_mix),u_pattern_size_a:new o.aO(m,l.u_pattern_size_a),u_pattern_size_b:new o.aO(m,l.u_pattern_size_b),u_scale_a:new o.aI(m,l.u_scale_a),u_scale_b:new o.aI(m,l.u_scale_b),u_pixel_coord_upper:new o.aO(m,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aO(m,l.u_pixel_coord_lower),u_tile_units_to_pixels:new o.aI(m,l.u_tile_units_to_pixels)}),terrain:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_texture:new o.aH(m,l.u_texture),u_ele_delta:new o.aI(m,l.u_ele_delta),u_fog_matrix:new o.aJ(m,l.u_fog_matrix),u_fog_color:new o.aL(m,l.u_fog_color),u_fog_ground_blend:new o.aI(m,l.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.aI(m,l.u_fog_ground_blend_opacity),u_horizon_color:new o.aL(m,l.u_horizon_color),u_horizon_fog_blend:new o.aI(m,l.u_horizon_fog_blend)}),terrainDepth:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_ele_delta:new o.aI(m,l.u_ele_delta)}),terrainCoords:(m,l)=>({u_matrix:new o.aJ(m,l.u_matrix),u_texture:new o.aH(m,l.u_texture),u_terrain_coords_id:new o.aI(m,l.u_terrain_coords_id),u_ele_delta:new o.aI(m,l.u_ele_delta)}),sky:(m,l)=>({u_sky_color:new o.aL(m,l.u_sky_color),u_horizon_color:new o.aL(m,l.u_horizon_color),u_horizon:new o.aI(m,l.u_horizon),u_sky_horizon_blend:new o.aI(m,l.u_sky_horizon_blend)})};class Cs{constructor(l,A,p){this.context=l;const y=l.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,A.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete A.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const A=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),A.bufferSubData(A.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const fh={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ou{constructor(l,A,p,y){this.length=A.length,this.attributes=p,this.itemSize=A.bytesPerElement,this.dynamicDraw=y,this.context=l;const v=l.gl;this.buffer=v.createBuffer(),l.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,A.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete A.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){if(l.length!==this.length)throw new Error(`Length of new data is ${l.length}, which doesn't match current length of ${this.length}`);const A=this.context.gl;this.bind(),A.bufferSubData(A.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,A){for(let p=0;p<this.attributes.length;p++){const y=A.attributes[this.attributes[p].name];y!==void 0&&l.enableVertexAttribArray(y)}}setVertexAttribPointers(l,A,p){for(let y=0;y<this.attributes.length;y++){const v=this.attributes[y],S=A.attributes[v.name];S!==void 0&&l.vertexAttribPointer(S,v.components,l[fh[v.type]],!1,this.itemSize,v.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const va=new WeakMap;function Jo(m){var l;if(va.has(m))return va.get(m);{const A=(l=m.getParameter(m.VERSION))===null||l===void 0?void 0:l.startsWith("WebGL 2.0");return va.set(m,A),A}}class en{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Yo extends en{getDefault(){return o.aM.transparent}set(l){const A=this.current;(l.r!==A.r||l.g!==A.g||l.b!==A.b||l.a!==A.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Sd extends en{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class eo extends en{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class Zo extends en{getDefault(){return[!0,!0,!0,!0]}set(l){const A=this.current;(l[0]!==A[0]||l[1]!==A[1]||l[2]!==A[2]||l[3]!==A[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class au extends en{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class vc extends en{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class ph extends en{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const A=this.current;(l.func!==A.func||l.ref!==A.ref||l.mask!==A.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class El extends en{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const A=this.current;(l[0]!==A[0]||l[1]!==A[1]||l[2]!==A[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class gh extends en{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const A=this.gl;l?A.enable(A.STENCIL_TEST):A.disable(A.STENCIL_TEST),this.current=l,this.dirty=!1}}class lu extends en{getDefault(){return[0,1]}set(l){const A=this.current;(l[0]!==A[0]||l[1]!==A[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class cu extends en{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const A=this.gl;l?A.enable(A.DEPTH_TEST):A.disable(A.DEPTH_TEST),this.current=l,this.dirty=!1}}class cA extends en{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class Bo extends en{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const A=this.gl;l?A.enable(A.BLEND):A.disable(A.BLEND),this.current=l,this.dirty=!1}}class uu extends en{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const A=this.current;(l[0]!==A[0]||l[1]!==A[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class uA extends en{getDefault(){return o.aM.transparent}set(l){const A=this.current;(l.r!==A.r||l.g!==A.g||l.b!==A.b||l.a!==A.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class AA extends en{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class bc extends en{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const A=this.gl;l?A.enable(A.CULL_FACE):A.disable(A.CULL_FACE),this.current=l,this.dirty=!1}}class Au extends en{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class ba extends en{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class hA extends en{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class Sl extends en{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class hu extends en{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const A=this.current;(l[0]!==A[0]||l[1]!==A[1]||l[2]!==A[2]||l[3]!==A[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class O extends en{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const A=this.gl;A.bindFramebuffer(A.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class nt extends en{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const A=this.gl;A.bindRenderbuffer(A.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Lt extends en{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const A=this.gl;A.bindTexture(A.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class Ht extends en{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const A=this.gl;A.bindBuffer(A.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class ee extends en{getDefault(){return null}set(l){const A=this.gl;A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Ae extends en{getDefault(){return null}set(l){var A;if(l===this.current&&!this.dirty)return;const p=this.gl;Jo(p)?p.bindVertexArray(l):(A=p.getExtension("OES_vertex_array_object"))===null||A===void 0||A.bindVertexArrayOES(l),this.current=l,this.dirty=!1}}class Re extends en{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const A=this.gl;A.pixelStorei(A.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class er extends en{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const A=this.gl;A.pixelStorei(A.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class Tr extends en{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const A=this.gl;A.pixelStorei(A.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class Hr extends en{constructor(l,A){super(l),this.context=l,this.parent=A}getDefault(){return null}}class Wr extends Hr{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const A=this.gl;A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class rn extends Hr{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const A=this.gl;A.framebufferRenderbuffer(A.FRAMEBUFFER,A.DEPTH_ATTACHMENT,A.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Yn extends Hr{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const A=this.gl;A.framebufferRenderbuffer(A.FRAMEBUFFER,A.DEPTH_STENCIL_ATTACHMENT,A.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class bi{constructor(l,A,p,y,v){this.context=l,this.width=A,this.height=p;const S=l.gl,I=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new Wr(l,I),y)this.depthAttachment=v?new Yn(l,I):new rn(l,I);else if(v)throw new Error("Stencil cannot be set without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const l=this.context.gl,A=this.colorAttachment.get();if(A&&l.deleteTexture(A),this.depthAttachment){const p=this.depthAttachment.get();p&&l.deleteRenderbuffer(p)}l.deleteFramebuffer(this.framebuffer)}}class Jr{constructor(l,A,p){this.blendFunction=l,this.blendColor=A,this.mask=p}}Jr.Replace=[1,0],Jr.disabled=new Jr(Jr.Replace,o.aM.transparent,[!1,!1,!1,!1]),Jr.unblended=new Jr(Jr.Replace,o.aM.transparent,[!0,!0,!0,!0]),Jr.alphaBlended=new Jr([1,771],o.aM.transparent,[!0,!0,!0,!0]);class ls{constructor(l){var A,p;if(this.gl=l,this.clearColor=new Yo(this),this.clearDepth=new Sd(this),this.clearStencil=new eo(this),this.colorMask=new Zo(this),this.depthMask=new au(this),this.stencilMask=new vc(this),this.stencilFunc=new ph(this),this.stencilOp=new El(this),this.stencilTest=new gh(this),this.depthRange=new lu(this),this.depthTest=new cu(this),this.depthFunc=new cA(this),this.blend=new Bo(this),this.blendFunc=new uu(this),this.blendColor=new uA(this),this.blendEquation=new AA(this),this.cullFace=new bc(this),this.cullFaceSide=new Au(this),this.frontFace=new ba(this),this.program=new hA(this),this.activeTexture=new Sl(this),this.viewport=new hu(this),this.bindFramebuffer=new O(this),this.bindRenderbuffer=new nt(this),this.bindTexture=new Lt(this),this.bindVertexBuffer=new Ht(this),this.bindElementBuffer=new ee(this),this.bindVertexArray=new Ae(this),this.pixelStoreUnpack=new Re(this),this.pixelStoreUnpackPremultiplyAlpha=new er(this),this.pixelStoreUnpackFlipY=new Tr(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),Jo(l)){this.HALF_FLOAT=l.HALF_FLOAT;const y=l.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(A=l.RGBA16F)!==null&&A!==void 0?A:y==null?void 0:y.RGBA16F_EXT,this.RGB16F=(p=l.RGB16F)!==null&&p!==void 0?p:y==null?void 0:y.RGB16F_EXT,l.getExtension("EXT_color_buffer_float")}else{l.getExtension("EXT_color_buffer_half_float"),l.getExtension("OES_texture_half_float_linear");const y=l.getExtension("OES_texture_half_float");this.HALF_FLOAT=y==null?void 0:y.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,A){return new Cs(this,l,A)}createVertexBuffer(l,A,p){return new ou(this,l,A,p)}createRenderbuffer(l,A,p){const y=this.gl,v=y.createRenderbuffer();return this.bindRenderbuffer.set(v),y.renderbufferStorage(y.RENDERBUFFER,l,A,p),this.bindRenderbuffer.set(null),v}createFramebuffer(l,A,p,y){return new bi(this,l,A,p,y)}clear(l){let{color:A,depth:p,stencil:y}=l;const v=this.gl;let S=0;A&&(S|=v.COLOR_BUFFER_BIT,this.clearColor.set(A),this.colorMask.set([!0,!0,!0,!0])),p!==void 0&&(S|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),y!==void 0&&(S|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),v.clear(S)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){o.aE(l.blendFunction,Jr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}createVertexArray(){var l;return Jo(this.gl)?this.gl.createVertexArray():(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.createVertexArrayOES()}deleteVertexArray(l){var A;return Jo(this.gl)?this.gl.deleteVertexArray(l):(A=this.gl.getExtension("OES_vertex_array_object"))===null||A===void 0?void 0:A.deleteVertexArrayOES(l)}unbindVAO(){this.bindVertexArray.set(null)}}class Cr{constructor(l,A,p){this.func=l,this.mask=A,this.range=p}}Cr.ReadOnly=!1,Cr.ReadWrite=!0,Cr.disabled=new Cr(519,Cr.ReadOnly,[0,1]);const zs=7680;class An{constructor(l,A,p,y,v,S){this.test=l,this.ref=A,this.mask=p,this.fail=y,this.depthFail=v,this.pass=S}}An.disabled=new An({func:519,mask:0},0,0,zs,zs,zs);class dn{constructor(l,A,p){this.enable=l,this.mode=A,this.frontFace=p}}let wa;function Ja(m,l,A,p,y){const v=m.context,S=v.gl,I=m.useProgram("collisionBox"),M=[];let D=0,H=0;for(let pt=0;pt<p.length;pt++){const _t=p[pt],mt=l.getTile(_t).getBucket(A);if(!mt)continue;const Et=y?mt.textCollisionBox:mt.iconCollisionBox,Dt=mt.collisionCircleArray;if(Dt.length>0){const Rt=o.H();o.aQ(Rt,mt.placementInvProjMatrix,m.transform.glCoordMatrix),o.aQ(Rt,Rt,mt.placementViewportMatrix),M.push({circleArray:Dt,circleOffset:H,transform:_t.posMatrix,invTransform:Rt,coord:_t}),D+=Dt.length/4,H=D}Et&&I.draw(v,S.LINES,Cr.disabled,An.disabled,m.colorModeForRenderPass(),dn.disabled,{u_matrix:_t.posMatrix,u_pixel_extrude_scale:[1/(z=m.transform).width,1/z.height]},m.style.map.terrain&&m.style.map.terrain.getTerrainData(_t),A.id,Et.layoutVertexBuffer,Et.indexBuffer,Et.segments,null,m.transform.zoom,null,null,Et.collisionVertexBuffer)}var z;if(!y||!M.length)return;const $=m.useProgram("collisionCircle"),J=new o.aR;J.resize(4*D),J._trim();let K=0;for(const pt of M)for(let _t=0;_t<pt.circleArray.length/4;_t++){const mt=4*_t,Et=pt.circleArray[mt+0],Dt=pt.circleArray[mt+1],Rt=pt.circleArray[mt+2],oe=pt.circleArray[mt+3];J.emplace(K++,Et,Dt,Rt,oe,0),J.emplace(K++,Et,Dt,Rt,oe,1),J.emplace(K++,Et,Dt,Rt,oe,2),J.emplace(K++,Et,Dt,Rt,oe,3)}(!wa||wa.length<2*D)&&(wa=function(pt){const _t=2*pt,mt=new o.aT;mt.resize(_t),mt._trim();for(let Et=0;Et<_t;Et++){const Dt=6*Et;mt.uint16[Dt+0]=4*Et+0,mt.uint16[Dt+1]=4*Et+1,mt.uint16[Dt+2]=4*Et+2,mt.uint16[Dt+3]=4*Et+2,mt.uint16[Dt+4]=4*Et+3,mt.uint16[Dt+5]=4*Et+0}return mt}(D));const tt=v.createIndexBuffer(wa,!0),At=v.createVertexBuffer(J,o.aS.members,!0);for(const pt of M){const _t=wn(pt.transform,pt.invTransform,m.transform);$.draw(v,S.TRIANGLES,Cr.disabled,An.disabled,m.colorModeForRenderPass(),dn.disabled,_t,m.style.map.terrain&&m.style.map.terrain.getTerrainData(pt.coord),A.id,At,tt,o.a0.simpleSegment(0,2*pt.circleOffset,pt.circleArray.length,pt.circleArray.length/2),null,m.transform.zoom,null,null,null)}At.destroy(),tt.destroy()}dn.disabled=new dn(!1,1029,2305),dn.backCCW=new dn(!0,1029,2305);const Ya=o.an(new Float32Array(16));function Tl(m,l,A,p,y,v){const{horizontalAlign:S,verticalAlign:I}=o.au(m);return new o.P((-(S-.5)*l/y+p[0])*v,(-(I-.5)*A/y+p[1])*v)}function ta(m,l,A,p,y,v){const S=l.tileAnchorPoint.add(new o.P(l.translation[0],l.translation[1]));if(l.pitchWithMap){let I=p.mult(v);A||(I=I.rotate(-y));const M=S.add(I);return Ct(M.x,M.y,l.labelPlaneMatrix,l.getElevation).point}if(A){const I=se(l.tileAnchorPoint.x+1,l.tileAnchorPoint.y,l).point.sub(m),M=Math.atan(I.y/I.x)+(I.x<0?Math.PI:0);return m.add(p.rotate(M))}return m.add(p)}function xa(m,l,A,p,y,v,S,I,M,D,H,z,$,J){const K=m.text.placedSymbolArray,tt=m.text.dynamicLayoutVertexArray,At=m.icon.dynamicLayoutVertexArray,pt={};tt.clear();for(let _t=0;_t<K.length;_t++){const mt=K.get(_t),Et=mt.hidden||!mt.crossTileID||m.allowVerticalPlacement&&!mt.placedOrientation?null:p[mt.crossTileID];if(Et){const Dt=new o.P(mt.anchorX,mt.anchorY),Rt={getElevation:J,width:y.width,height:y.height,labelPlaneMatrix:v,lineVertexArray:null,pitchWithMap:A,projection:H,projectionCache:null,tileAnchorPoint:Dt,translation:z,unwrappedTileID:$},oe=A?Ct(Dt.x,Dt.y,S,J):se(Dt.x,Dt.y,Rt),ge=X(y.cameraToCenterDistance,oe.signedDistanceFromCamera);let _e=o.ai(m.textSizeData,M,mt)*ge/o.ap;A&&(_e*=m.tilePixelRatio/I);const{width:Ce,height:xe,anchor:ve,textOffset:Se,textBoxScale:sr}=Et,Pe=Tl(ve,Ce,xe,Se,sr,_e),Me=H.getPitchedTextCorrection(y,Dt.add(new o.P(z[0],z[1])),$),dr=ta(oe.point,Rt,l,Pe,y.angle,Me),Pr=m.allowVerticalPlacement&&mt.placedOrientation===o.ah.vertical?Math.PI/2:0;for(let Ir=0;Ir<mt.numGlyphs;Ir++)o.aj(tt,dr,Pr);D&&mt.associatedIconIndex>=0&&(pt[mt.associatedIconIndex]={shiftedAnchor:dr,angle:Pr})}else tr(mt.numGlyphs,tt)}if(D){At.clear();const _t=m.icon.placedSymbolArray;for(let mt=0;mt<_t.length;mt++){const Et=_t.get(mt);if(Et.hidden)tr(Et.numGlyphs,At);else{const Dt=pt[mt];if(Dt)for(let Rt=0;Rt<Et.numGlyphs;Rt++)o.aj(At,Dt.shiftedAnchor,Dt.angle);else tr(Et.numGlyphs,At)}}m.icon.dynamicLayoutVertexBuffer.updateData(At)}m.text.dynamicLayoutVertexBuffer.updateData(tt)}function ts(m,l,A){return A.iconsInText&&l?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function cs(m,l,A,p,y,v,S,I,M,D,H,z){const $=m.context,J=$.gl,K=m.transform,tt=ws(),At=I==="map",pt=M==="map",_t=I!=="viewport"&&A.layout.get("symbol-placement")!=="point",mt=At&&!pt&&!_t,Et=!pt&&_t,Dt=!A.layout.get("symbol-sort-key").isConstant();let Rt=!1;const oe=m.depthModeForSublayer(0,Cr.ReadOnly),ge=A._unevaluatedLayout.hasValue("text-variable-anchor")||A._unevaluatedLayout.hasValue("text-variable-anchor-offset"),_e=[],Ce=tt.getCircleRadiusCorrection(K);for(const xe of p){const ve=l.getTile(xe),Se=ve.getBucket(A);if(!Se)continue;const sr=y?Se.text:Se.icon;if(!sr||!sr.segments.get().length||!sr.hasVisibleVertices)continue;const Pe=sr.programConfigurations.get(A.id),Me=y||Se.sdfIcons,dr=y?Se.textSizeData:Se.iconSizeData,Pr=pt||K.pitch!==0,Ir=m.useProgram(ts(Me,y,Se),Pe),Dr=o.ag(dr,K.zoom),Kr=m.style.map.terrain&&m.style.map.terrain.getTerrainData(xe);let Bn,Zn,fn,hi,Cn=[0,0],ai=null;if(y)Zn=ve.glyphAtlasTexture,fn=J.LINEAR,Bn=ve.glyphAtlasTexture.size,Se.iconsInText&&(Cn=ve.imageAtlasTexture.size,ai=ve.imageAtlasTexture,hi=Pr||m.options.rotating||m.options.zooming||dr.kind==="composite"||dr.kind==="camera"?J.LINEAR:J.NEAREST);else{const an=A.layout.get("icon-size").constantOr(0)!==1||Se.iconsNeedLinear;Zn=ve.imageAtlasTexture,fn=Me||m.options.rotating||m.options.zooming||an||Pr?J.LINEAR:J.NEAREST,Bn=ve.imageAtlasTexture.size}const Bi=xr(ve,1,m.transform.zoom),Is=Et?xe.posMatrix:Ya,oo=vn(Is,pt,At,m.transform,Bi),ti=cn(Is,pt,At,m.transform,Bi),Dl=cn(xe.posMatrix,pt,At,m.transform,Bi),ao=tt.translatePosition(m.transform,ve,v,S),xA=ge&&Se.hasTextData(),wu=A.layout.get("icon-text-fit")!=="none"&&xA&&Se.hasIconData();if(_t){const an=m.style.map.terrain?(Nl,il)=>m.style.map.terrain.getElevation(xe,Nl,il):null,Fa=A.layout.get("text-rotation-alignment")==="map";ft(Se,xe.posMatrix,m,y,oo,Dl,pt,D,Fa,tt,xe.toUnwrapped(),K.width,K.height,ao,an)}const hs=xe.posMatrix,Fs=y&&ge||wu,Vi=_t||Fs?Ya:oo,ds=ti,yi=Me&&A.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let es;es=Me?Se.iconsInText?_a(dr.kind,Dr,mt,pt,_t,Fs,m,hs,Vi,ds,ao,Bn,Cn,Ce):Xo(dr.kind,Dr,mt,pt,_t,Fs,m,hs,Vi,ds,ao,y,Bn,!0,Ce):iu(dr.kind,Dr,mt,pt,_t,Fs,m,hs,Vi,ds,ao,y,Bn,Ce);const fs={program:Ir,buffers:sr,uniformValues:es,atlasTexture:Zn,atlasTextureIcon:ai,atlasInterpolation:fn,atlasInterpolationIcon:hi,isSDF:Me,hasHalo:yi};if(Dt&&Se.canOverlap){Rt=!0;const an=sr.segments.get();for(const Fa of an)_e.push({segments:new o.a0([Fa]),sortKey:Fa.sortKey,state:fs,terrainData:Kr})}else _e.push({segments:sr.segments,sortKey:0,state:fs,terrainData:Kr})}Rt&&_e.sort((xe,ve)=>xe.sortKey-ve.sortKey);for(const xe of _e){const ve=xe.state;if($.activeTexture.set(J.TEXTURE0),ve.atlasTexture.bind(ve.atlasInterpolation,J.CLAMP_TO_EDGE),ve.atlasTextureIcon&&($.activeTexture.set(J.TEXTURE1),ve.atlasTextureIcon&&ve.atlasTextureIcon.bind(ve.atlasInterpolationIcon,J.CLAMP_TO_EDGE)),ve.isSDF){const Se=ve.uniformValues;ve.hasHalo&&(Se.u_is_halo=1,Il(ve.buffers,xe.segments,A,m,ve.program,oe,H,z,Se,xe.terrainData)),Se.u_is_halo=0}Il(ve.buffers,xe.segments,A,m,ve.program,oe,H,z,ve.uniformValues,xe.terrainData)}}function Il(m,l,A,p,y,v,S,I,M,D){const H=p.context;y.draw(H,H.gl.TRIANGLES,v,S,I,dn.disabled,M,D,A.id,m.layoutVertexBuffer,m.indexBuffer,l,A.paint,p.transform.zoom,m.programConfigurations.get(A.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function Fl(m,l,A,p){const y=m.context,v=y.gl,S=An.disabled,I=new Jr([v.ONE,v.ONE],o.aM.transparent,[!0,!0,!0,!0]),M=l.getBucket(A);if(!M)return;const D=p.key;let H=A.heatmapFbos.get(D);H||(H=Za(y,l.tileSize,l.tileSize),A.heatmapFbos.set(D,H)),y.bindFramebuffer.set(H.framebuffer),y.viewport.set([0,0,l.tileSize,l.tileSize]),y.clear({color:o.aM.transparent});const z=M.programConfigurations.get(A.id),$=m.useProgram("heatmap",z),J=m.style.map.terrain.getTerrainData(p);$.draw(y,v.TRIANGLES,Cr.disabled,S,I,dn.disabled,Br(p.posMatrix,l,m.transform.zoom,A.paint.get("heatmap-intensity")),J,A.id,M.layoutVertexBuffer,M.indexBuffer,M.segments,A.paint,m.transform.zoom,z)}function Co(m,l,A){const p=m.context,y=p.gl;p.setColorMode(m.colorModeForRenderPass());const v=zi(p,l),S=A.key,I=l.heatmapFbos.get(S);I&&(p.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,I.colorAttachment.get()),p.activeTexture.set(y.TEXTURE1),v.bind(y.LINEAR,y.CLAMP_TO_EDGE),m.useProgram("heatmapTexture").draw(p,y.TRIANGLES,Cr.disabled,An.disabled,m.colorModeForRenderPass(),dn.disabled,tu(m,l,0,1),null,l.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments,l.paint,m.transform.zoom),I.destroy(),l.heatmapFbos.delete(S))}function Za(m,l,A){var p,y;const v=m.gl,S=v.createTexture();v.bindTexture(v.TEXTURE_2D,S),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.LINEAR),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.LINEAR);const I=(p=m.HALF_FLOAT)!==null&&p!==void 0?p:v.UNSIGNED_BYTE,M=(y=m.RGBA16F)!==null&&y!==void 0?y:v.RGBA;v.texImage2D(v.TEXTURE_2D,0,M,l,A,0,v.RGBA,I,null);const D=m.createFramebuffer(l,A,!1,!1);return D.colorAttachment.set(S),D}function zi(m,l){return l.colorRampTexture||(l.colorRampTexture=new ot(m,l.colorRamp,m.gl.RGBA)),l.colorRampTexture}function Ll(m,l,A,p,y){if(!A||!p||!p.imageAtlas)return;const v=p.imageAtlas.patternPositions;let S=v[A.to.toString()],I=v[A.from.toString()];if(!S&&I&&(S=I),!I&&S&&(I=S),!S||!I){const M=y.getPaintProperty(l);S=v[M],I=v[M]}S&&I&&m.setConstantPatternPositions(S,I)}function tl(m,l,A,p,y,v,S){const I=m.context.gl,M="fill-pattern",D=A.paint.get(M),H=D&&D.constantOr(1),z=A.getCrossfadeParameters();let $,J,K,tt,At;S?(J=H&&!A.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=I.LINES):(J=H?"fillPattern":"fill",$=I.TRIANGLES);const pt=D.constantOr(null);for(const _t of p){const mt=l.getTile(_t);if(H&&!mt.patternsLoaded())continue;const Et=mt.getBucket(A);if(!Et)continue;const Dt=Et.programConfigurations.get(A.id),Rt=m.useProgram(J,Dt),oe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(_t);H&&(m.context.activeTexture.set(I.TEXTURE0),mt.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),Dt.updatePaintBuffers(z)),Ll(Dt,M,pt,mt,A);const ge=oe?_t:null,_e=m.translatePosMatrix(ge?ge.posMatrix:_t.posMatrix,mt,A.paint.get("fill-translate"),A.paint.get("fill-translate-anchor"));if(S){tt=Et.indexBuffer2,At=Et.segments2;const Ce=[I.drawingBufferWidth,I.drawingBufferHeight];K=J==="fillOutlinePattern"&&H?Jn(_e,m,z,mt,Ce):Xn(_e,Ce)}else tt=Et.indexBuffer,At=Et.segments,K=H?zr(_e,m,z,mt):Xe(_e);Rt.draw(m.context,$,y,m.stencilModeForClipping(_t),v,dn.disabled,K,oe,A.id,Et.layoutVertexBuffer,tt,At,A.paint,m.transform.zoom,Dt)}}function wc(m,l,A,p,y,v,S){const I=m.context,M=I.gl,D="fill-extrusion-pattern",H=A.paint.get(D),z=H.constantOr(1),$=A.getCrossfadeParameters(),J=A.paint.get("fill-extrusion-opacity"),K=H.constantOr(null);for(const tt of p){const At=l.getTile(tt),pt=At.getBucket(A);if(!pt)continue;const _t=m.style.map.terrain&&m.style.map.terrain.getTerrainData(tt),mt=pt.programConfigurations.get(A.id),Et=m.useProgram(z?"fillExtrusionPattern":"fillExtrusion",mt);z&&(m.context.activeTexture.set(M.TEXTURE0),At.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),mt.updatePaintBuffers($)),Ll(mt,D,K,At,A);const Dt=m.translatePosMatrix(tt.posMatrix,At,A.paint.get("fill-extrusion-translate"),A.paint.get("fill-extrusion-translate-anchor")),Rt=A.paint.get("fill-extrusion-vertical-gradient"),oe=z?Fe(Dt,m,Rt,J,tt,$,At):ae(Dt,m,Rt,J);Et.draw(I,I.gl.TRIANGLES,y,v,S,dn.backCCW,oe,_t,A.id,pt.layoutVertexBuffer,pt.indexBuffer,pt.segments,A.paint,m.transform.zoom,mt,m.style.map.terrain&&pt.centroidVertexBuffer)}}function us(m,l,A,p,y,v,S){const I=m.context,M=I.gl,D=A.fbo;if(!D)return;const H=m.useProgram("hillshade"),z=m.style.map.terrain&&m.style.map.terrain.getTerrainData(l);I.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,D.colorAttachment.get()),H.draw(I,M.TRIANGLES,y,v,S,dn.disabled,(($,J,K,tt)=>{const At=K.paint.get("hillshade-shadow-color"),pt=K.paint.get("hillshade-highlight-color"),_t=K.paint.get("hillshade-accent-color");let mt=K.paint.get("hillshade-illumination-direction")*(Math.PI/180);K.paint.get("hillshade-illumination-anchor")==="viewport"&&(mt-=$.transform.angle);const Et=!$.options.moving;return{u_matrix:tt?tt.posMatrix:$.transform.calculatePosMatrix(J.tileID.toUnwrapped(),Et),u_image:0,u_latrange:eu(0,J.tileID),u_light:[K.paint.get("hillshade-exaggeration"),mt],u_shadow:At,u_highlight:pt,u_accent:_t}})(m,A,p,z?l:null),z,p.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}function Ba(m,l,A,p,y,v){const S=m.context,I=S.gl,M=l.dem;if(M&&M.data){const D=M.dim,H=M.stride,z=M.getPixels();if(S.activeTexture.set(I.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||m.getTileTexture(H),l.demTexture){const J=l.demTexture;J.update(z,{premultiply:!1}),J.bind(I.NEAREST,I.CLAMP_TO_EDGE)}else l.demTexture=new ot(S,z,I.RGBA,{premultiply:!1}),l.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);S.activeTexture.set(I.TEXTURE0);let $=l.fbo;if(!$){const J=new ot(S,{width:D,height:D,data:null},I.RGBA);J.bind(I.LINEAR,I.CLAMP_TO_EDGE),$=l.fbo=S.createFramebuffer(D,D,!0,!1),$.colorAttachment.set(J.texture)}S.bindFramebuffer.set($.framebuffer),S.viewport.set([0,0,D,D]),m.useProgram("hillshadePrepare").draw(S,I.TRIANGLES,p,y,v,dn.disabled,((J,K)=>{const tt=K.stride,At=o.H();return o.aP(At,0,o.X,-o.X,0,0,1),o.J(At,At,[0,-o.X,0]),{u_matrix:At,u_image:1,u_dimension:[tt,tt],u_zoom:J.overscaledZ,u_unpack:K.getUnpackVector()}})(l.tileID,M),null,A.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments),l.needsHillshadePrepare=!1}}function mh(m,l,A,p,y,v){const S=p.paint.get("raster-fade-duration");if(!v&&S>0){const I=w.now(),M=(I-m.timeAdded)/S,D=l?(I-l.timeAdded)/S:-1,H=A.getSource(),z=y.coveringZoomLevel({tileSize:H.tileSize,roundZoom:H.roundZoom}),$=!l||Math.abs(l.tileID.overscaledZ-z)>Math.abs(m.tileID.overscaledZ-z),J=$&&m.refreshedUponExpiration?1:o.ac($?M:1-D,0,1);return m.refreshedUponExpiration&&M>=1&&(m.refreshedUponExpiration=!1),l?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}const dA=new o.aM(1,0,0,1),Yr=new o.aM(0,1,0,1),Es=new o.aM(0,0,1,1),ea=new o.aM(1,0,1,1),el=new o.aM(0,1,1,1);function Ss(m,l,A,p){rl(m,0,l+A/2,m.transform.width,A,p)}function Ca(m,l,A,p){rl(m,l-A/2,0,A,m.transform.height,p)}function rl(m,l,A,p,y,v){const S=m.context,I=S.gl;I.enable(I.SCISSOR_TEST),I.scissor(l*m.pixelRatio,A*m.pixelRatio,p*m.pixelRatio,y*m.pixelRatio),S.clear({color:v}),I.disable(I.SCISSOR_TEST)}function Eo(m,l,A){const p=m.context,y=p.gl,v=A.posMatrix,S=m.useProgram("debug"),I=Cr.disabled,M=An.disabled,D=m.colorModeForRenderPass(),H="$debug",z=m.style.map.terrain&&m.style.map.terrain.getTerrainData(A);p.activeTexture.set(y.TEXTURE0);const $=l.getTileByID(A.key).latestRawTileData,J=Math.floor(($&&$.byteLength||0)/1024),K=l.getTile(A).tileSize,tt=512/Math.min(K,512)*(A.overscaledZ/m.transform.zoom)*.5;let At=A.canonical.toString();A.overscaledZ!==A.canonical.z&&(At+=` => ${A.overscaledZ}`),function(pt,_t){pt.initDebugOverlayCanvas();const mt=pt.debugOverlayCanvas,Et=pt.context.gl,Dt=pt.debugOverlayCanvas.getContext("2d");Dt.clearRect(0,0,mt.width,mt.height),Dt.shadowColor="white",Dt.shadowBlur=2,Dt.lineWidth=1.5,Dt.strokeStyle="white",Dt.textBaseline="top",Dt.font="bold 36px Open Sans, sans-serif",Dt.fillText(_t,5,5),Dt.strokeText(_t,5,5),pt.debugOverlayTexture.update(mt),pt.debugOverlayTexture.bind(Et.LINEAR,Et.CLAMP_TO_EDGE)}(m,`${At} ${J}kB`),S.draw(p,y.TRIANGLES,I,M,Jr.alphaBlended,dn.disabled,yc(v,o.aM.transparent,tt),null,H,m.debugBuffer,m.quadTriangleIndexBuffer,m.debugSegments),S.draw(p,y.LINE_STRIP,I,M,D,dn.disabled,yc(v,o.aM.red),z,H,m.debugBuffer,m.tileBorderIndexBuffer,m.debugSegments)}function xc(m,l,A){const p=m.context,y=p.gl,v=m.colorModeForRenderPass(),S=new Cr(y.LEQUAL,Cr.ReadWrite,m.depthRangeFor3D),I=m.useProgram("terrain"),M=l.getTerrainMesh();p.bindFramebuffer.set(null),p.viewport.set([0,0,m.width,m.height]);for(const D of A){const H=m.renderToTexture.getTexture(D),z=l.getTerrainData(D.tileID);p.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,H.texture);const $=m.transform.calculatePosMatrix(D.tileID.toUnwrapped()),J=l.getMeshFrameDelta(m.transform.zoom),K=m.transform.calculateFogMatrix(D.tileID.toUnwrapped()),tt=mc($,J,K,m.style.sky,m.transform.pitch);I.draw(p,y.TRIANGLES,S,An.disabled,v,dn.backCCW,tt,z,"terrain",M.vertexBuffer,M.indexBuffer,M.segments)}}class Pl{constructor(l,A,p){this.vertexBuffer=l,this.indexBuffer=A,this.segments=p}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class ra{constructor(l,A){this.context=new ls(l),this.transform=A,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Qe.maxUnderzooming+Qe.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new $a}resize(l,A,p){if(this.width=Math.floor(l*p),this.height=Math.floor(A*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style._order)this.style._layers[y].resize()}setup(){const l=this.context,A=new o.aX;A.emplaceBack(0,0),A.emplaceBack(o.X,0),A.emplaceBack(0,o.X),A.emplaceBack(o.X,o.X),this.tileExtentBuffer=l.createVertexBuffer(A,Qs.members),this.tileExtentSegments=o.a0.simpleSegment(0,0,4,2);const p=new o.aX;p.emplaceBack(0,0),p.emplaceBack(o.X,0),p.emplaceBack(0,o.X),p.emplaceBack(o.X,o.X),this.debugBuffer=l.createVertexBuffer(p,Qs.members),this.debugSegments=o.a0.simpleSegment(0,0,4,5);const y=new o.$;y.emplaceBack(0,0,0,0),y.emplaceBack(o.X,0,o.X,0),y.emplaceBack(0,o.X,0,o.X),y.emplaceBack(o.X,o.X,o.X,o.X),this.rasterBoundsBuffer=l.createVertexBuffer(y,Oe.members),this.rasterBoundsSegments=o.a0.simpleSegment(0,0,4,2);const v=new o.aX;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(v,Qs.members),this.viewportSegments=o.a0.simpleSegment(0,0,4,2);const S=new o.aZ;S.emplaceBack(0),S.emplaceBack(1),S.emplaceBack(3),S.emplaceBack(2),S.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(S);const I=new o.aY;I.emplaceBack(0,1,2),I.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(I);const M=this.context.gl;this.stencilClearMode=new An({func:M.ALWAYS,mask:0},0,255,M.ZERO,M.ZERO,M.ZERO)}clearStencil(){const l=this.context,A=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=o.H();o.aP(p,0,this.width,this.height,0,0,1),o.K(p,p,[A.drawingBufferWidth,A.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,A.TRIANGLES,Cr.disabled,this.stencilClearMode,Jr.disabled,dn.disabled,Zi(p),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,A){if(this.currentStencilSource===l.source||!l.isTileClipped()||!A||!A.length)return;this.currentStencilSource=l.source;const p=this.context,y=p.gl;this.nextStencilID+A.length>256&&this.clearStencil(),p.setColorMode(Jr.disabled),p.setDepthMode(Cr.disabled);const v=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const S of A){const I=this._tileClippingMaskIDs[S.key]=this.nextStencilID++,M=this.style.map.terrain&&this.style.map.terrain.getTerrainData(S);v.draw(p,y.TRIANGLES,Cr.disabled,new An({func:y.ALWAYS,mask:0},I,255,y.KEEP,y.KEEP,y.REPLACE),Jr.disabled,dn.disabled,Zi(S.posMatrix),M,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,A=this.context.gl;return new An({func:A.NOTEQUAL,mask:255},l,255,A.KEEP,A.KEEP,A.REPLACE)}stencilModeForClipping(l){const A=this.context.gl;return new An({func:A.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,A.KEEP,A.KEEP,A.REPLACE)}stencilConfigForOverlap(l){const A=this.context.gl,p=l.sort((S,I)=>I.overscaledZ-S.overscaledZ),y=p[p.length-1].overscaledZ,v=p[0].overscaledZ-y+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const S={};for(let I=0;I<v;I++)S[I+y]=new An({func:A.GEQUAL,mask:255},I+this.nextStencilID,255,A.KEEP,A.KEEP,A.REPLACE);return this.nextStencilID+=v,[S,p]}return[{[y]:An.disabled},p]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new Jr([l.CONSTANT_COLOR,l.ONE],new o.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Jr.unblended:Jr.alphaBlended}depthModeForSublayer(l,A,p){if(!this.opaquePassEnabledForLayer())return Cr.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new Cr(p||this.context.gl.LEQUAL,A,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,A){this.style=l,this.options=A,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(w.now()),this.imageManager.beginFrame();const p=this.style._order,y=this.style.sourceCaches,v={},S={},I={};for(const M in y){const D=y[M];D.used&&D.prepare(this.context),v[M]=D.getVisibleCoordinates(),S[M]=v[M].slice().reverse(),I[M]=D.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let M=0;M<p.length;M++)if(this.style._layers[p[M]].is3D()){this.opaquePassCutoff=M;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const M of p){const D=this.style._layers[M];if(!D.hasOffscreenPass()||D.isHidden(this.transform.zoom))continue;const H=S[D.source];(D.type==="custom"||H.length)&&this.renderLayer(this,y[D.source],D,H)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:A.showOverdrawInspector?o.aM.black:o.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(M,D){const H=M.context,z=H.gl,$=((pt,_t,mt)=>({u_sky_color:pt.properties.get("sky-color"),u_horizon_color:pt.properties.get("horizon-color"),u_horizon:(_t.height/2+_t.getHorizon())*mt,u_sky_horizon_blend:pt.properties.get("sky-horizon-blend")*_t.height/2*mt}))(D,M.style.map.transform,M.pixelRatio),J=new Cr(z.LEQUAL,Cr.ReadWrite,[0,1]),K=An.disabled,tt=M.colorModeForRenderPass(),At=M.useProgram("sky");if(!D.mesh){const pt=new o.aX;pt.emplaceBack(-1,-1),pt.emplaceBack(1,-1),pt.emplaceBack(1,1),pt.emplaceBack(-1,1);const _t=new o.aY;_t.emplaceBack(0,1,2),_t.emplaceBack(0,2,3),D.mesh=new Pl(H.createVertexBuffer(pt,Qs.members),H.createIndexBuffer(_t),o.a0.simpleSegment(0,0,pt.length,_t.length))}At.draw(H,z.TRIANGLES,J,K,tt,dn.disabled,$,void 0,"sky",D.mesh.vertexBuffer,D.mesh.indexBuffer,D.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=A.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const M=this.style._layers[p[this.currentLayer]],D=y[M.source],H=v[M.source];this._renderTileClippingMasks(M,H),this.renderLayer(this,D,M,H)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const M=this.style._layers[p[this.currentLayer]],D=y[M.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(M))continue;const H=(M.type==="symbol"?I:S)[M.source];this._renderTileClippingMasks(M,v[M.source]),this.renderLayer(this,D,M,H)}if(this.options.showTileBoundaries){const M=function(D,H){let z=null;const $=Object.values(D._layers).flatMap(At=>At.source&&!At.isHidden(H)?[D.sourceCaches[At.source]]:[]),J=$.filter(At=>At.getSource().type==="vector"),K=$.filter(At=>At.getSource().type!=="vector"),tt=At=>{(!z||z.getSource().maxzoom<At.getSource().maxzoom)&&(z=At)};return J.forEach(At=>tt(At)),z||K.forEach(At=>tt(At)),z}(this.style,this.transform.zoom);M&&function(D,H,z){for(let $=0;$<z.length;$++)Eo(D,H,z[$])}(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(M){const D=M.transform.padding;Ss(M,M.transform.height-(D.top||0),3,dA),Ss(M,D.bottom||0,3,Yr),Ca(M,D.left||0,3,Es),Ca(M,M.transform.width-(D.right||0),3,ea);const H=M.transform.centerPoint;(function(z,$,J,K){rl(z,$-1,J-10,2,20,K),rl(z,$-10,J-1,20,2,K)})(M,H.x,M.transform.height-H.y,el)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(l){if(!this.style||!this.style.map||!this.style.map.terrain)return;const A=this.terrainFacilitator.matrix,p=this.transform.modelViewProjectionMatrix;let y=this.terrainFacilitator.dirty;y||(y=l?!o.a_(A,p):!o.a$(A,p)),y||(y=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),y&&(o.b0(A,p),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(v,S){const I=v.context,M=I.gl,D=Jr.unblended,H=new Cr(M.LEQUAL,Cr.ReadWrite,[0,1]),z=S.getTerrainMesh(),$=S.sourceCache.getRenderableTiles(),J=v.useProgram("terrainDepth");I.bindFramebuffer.set(S.getFramebuffer("depth").framebuffer),I.viewport.set([0,0,v.width/devicePixelRatio,v.height/devicePixelRatio]),I.clear({color:o.aM.transparent,depth:1});for(const K of $){const tt=S.getTerrainData(K.tileID),At={u_matrix:v.transform.calculatePosMatrix(K.tileID.toUnwrapped()),u_ele_delta:S.getMeshFrameDelta(v.transform.zoom)};J.draw(I,M.TRIANGLES,H,An.disabled,D,dn.backCCW,At,tt,"terrain",z.vertexBuffer,z.indexBuffer,z.segments)}I.bindFramebuffer.set(null),I.viewport.set([0,0,v.width,v.height])}(this,this.style.map.terrain),function(v,S){const I=v.context,M=I.gl,D=Jr.unblended,H=new Cr(M.LEQUAL,Cr.ReadWrite,[0,1]),z=S.getTerrainMesh(),$=S.getCoordsTexture(),J=S.sourceCache.getRenderableTiles(),K=v.useProgram("terrainCoords");I.bindFramebuffer.set(S.getFramebuffer("coords").framebuffer),I.viewport.set([0,0,v.width/devicePixelRatio,v.height/devicePixelRatio]),I.clear({color:o.aM.transparent,depth:1}),S.coordsIndex=[];for(const tt of J){const At=S.getTerrainData(tt.tileID);I.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,$.texture);const pt={u_matrix:v.transform.calculatePosMatrix(tt.tileID.toUnwrapped()),u_terrain_coords_id:(255-S.coordsIndex.length)/255,u_texture:0,u_ele_delta:S.getMeshFrameDelta(v.transform.zoom)};K.draw(I,M.TRIANGLES,H,An.disabled,D,dn.backCCW,pt,At,"terrain",z.vertexBuffer,z.indexBuffer,z.segments),S.coordsIndex.push(tt.tileID.key)}I.bindFramebuffer.set(null),I.viewport.set([0,0,v.width,v.height])}(this,this.style.map.terrain))}renderLayer(l,A,p,y){if(!p.isHidden(this.transform.zoom)&&(p.type==="background"||p.type==="custom"||(y||[]).length))switch(this.id=p.id,p.type){case"symbol":(function(v,S,I,M,D){if(v.renderPass!=="translucent")return;const H=An.disabled,z=v.colorModeForRenderPass();(I._unevaluatedLayout.hasValue("text-variable-anchor")||I._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function($,J,K,tt,At,pt,_t,mt,Et){const Dt=J.transform,Rt=ws(),oe=At==="map",ge=pt==="map";for(const _e of $){const Ce=tt.getTile(_e),xe=Ce.getBucket(K);if(!xe||!xe.text||!xe.text.segments.get().length)continue;const ve=o.ag(xe.textSizeData,Dt.zoom),Se=xr(Ce,1,J.transform.zoom),sr=vn(_e.posMatrix,ge,oe,J.transform,Se),Pe=K.layout.get("icon-text-fit")!=="none"&&xe.hasIconData();if(ve){const Me=Math.pow(2,Dt.zoom-Ce.tileID.overscaledZ),dr=J.style.map.terrain?(Ir,Dr)=>J.style.map.terrain.getElevation(_e,Ir,Dr):null,Pr=Rt.translatePosition(Dt,Ce,_t,mt);xa(xe,oe,ge,Et,Dt,sr,_e.posMatrix,Me,ve,Pe,Rt,Pr,_e.toUnwrapped(),dr)}}}(M,v,I,S,I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),D),I.paint.get("icon-opacity").constantOr(1)!==0&&cs(v,S,I,M,!1,I.paint.get("icon-translate"),I.paint.get("icon-translate-anchor"),I.layout.get("icon-rotation-alignment"),I.layout.get("icon-pitch-alignment"),I.layout.get("icon-keep-upright"),H,z),I.paint.get("text-opacity").constantOr(1)!==0&&cs(v,S,I,M,!0,I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.layout.get("text-keep-upright"),H,z),S.map.showCollisionBoxes&&(Ja(v,S,I,M,!0),Ja(v,S,I,M,!1))})(l,A,p,y,this.style.placement.variableOffsets);break;case"circle":(function(v,S,I,M){if(v.renderPass!=="translucent")return;const D=I.paint.get("circle-opacity"),H=I.paint.get("circle-stroke-width"),z=I.paint.get("circle-stroke-opacity"),$=!I.layout.get("circle-sort-key").isConstant();if(D.constantOr(1)===0&&(H.constantOr(1)===0||z.constantOr(1)===0))return;const J=v.context,K=J.gl,tt=v.depthModeForSublayer(0,Cr.ReadOnly),At=An.disabled,pt=v.colorModeForRenderPass(),_t=[];for(let mt=0;mt<M.length;mt++){const Et=M[mt],Dt=S.getTile(Et),Rt=Dt.getBucket(I);if(!Rt)continue;const oe=Rt.programConfigurations.get(I.id),ge=v.useProgram("circle",oe),_e=Rt.layoutVertexBuffer,Ce=Rt.indexBuffer,xe=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Et),ve={programConfiguration:oe,program:ge,layoutVertexBuffer:_e,indexBuffer:Ce,uniformValues:Si(v,Et,Dt,I),terrainData:xe};if($){const Se=Rt.segments.get();for(const sr of Se)_t.push({segments:new o.a0([sr]),sortKey:sr.sortKey,state:ve})}else _t.push({segments:Rt.segments,sortKey:0,state:ve})}$&&_t.sort((mt,Et)=>mt.sortKey-Et.sortKey);for(const mt of _t){const{programConfiguration:Et,program:Dt,layoutVertexBuffer:Rt,indexBuffer:oe,uniformValues:ge,terrainData:_e}=mt.state;Dt.draw(J,K.TRIANGLES,tt,At,pt,dn.disabled,ge,_e,I.id,Rt,oe,mt.segments,I.paint,v.transform.zoom,Et)}})(l,A,p,y);break;case"heatmap":(function(v,S,I,M){if(I.paint.get("heatmap-opacity")===0)return;const D=v.context;if(v.style.map.terrain){for(const H of M){const z=S.getTile(H);S.hasRenderableParent(H)||(v.renderPass==="offscreen"?Fl(v,z,I,H):v.renderPass==="translucent"&&Co(v,I,H))}D.viewport.set([0,0,v.width,v.height])}else v.renderPass==="offscreen"?function(H,z,$,J){const K=H.context,tt=K.gl,At=An.disabled,pt=new Jr([tt.ONE,tt.ONE],o.aM.transparent,[!0,!0,!0,!0]);(function(_t,mt,Et){const Dt=_t.gl;_t.activeTexture.set(Dt.TEXTURE1),_t.viewport.set([0,0,mt.width/4,mt.height/4]);let Rt=Et.heatmapFbos.get(o.aU);Rt?(Dt.bindTexture(Dt.TEXTURE_2D,Rt.colorAttachment.get()),_t.bindFramebuffer.set(Rt.framebuffer)):(Rt=Za(_t,mt.width/4,mt.height/4),Et.heatmapFbos.set(o.aU,Rt))})(K,H,$),K.clear({color:o.aM.transparent});for(let _t=0;_t<J.length;_t++){const mt=J[_t];if(z.hasRenderableParent(mt))continue;const Et=z.getTile(mt),Dt=Et.getBucket($);if(!Dt)continue;const Rt=Dt.programConfigurations.get($.id),oe=H.useProgram("heatmap",Rt),{zoom:ge}=H.transform;oe.draw(K,tt.TRIANGLES,Cr.disabled,At,pt,dn.disabled,Br(mt.posMatrix,Et,ge,$.paint.get("heatmap-intensity")),null,$.id,Dt.layoutVertexBuffer,Dt.indexBuffer,Dt.segments,$.paint,H.transform.zoom,Rt)}K.viewport.set([0,0,H.width,H.height])}(v,S,I,M):v.renderPass==="translucent"&&function(H,z){const $=H.context,J=$.gl;$.setColorMode(H.colorModeForRenderPass());const K=z.heatmapFbos.get(o.aU);K&&($.activeTexture.set(J.TEXTURE0),J.bindTexture(J.TEXTURE_2D,K.colorAttachment.get()),$.activeTexture.set(J.TEXTURE1),zi($,z).bind(J.LINEAR,J.CLAMP_TO_EDGE),H.useProgram("heatmapTexture").draw($,J.TRIANGLES,Cr.disabled,An.disabled,H.colorModeForRenderPass(),dn.disabled,tu(H,z,0,1),null,z.id,H.viewportBuffer,H.quadTriangleIndexBuffer,H.viewportSegments,z.paint,H.transform.zoom))}(v,I)})(l,A,p,y);break;case"line":(function(v,S,I,M){if(v.renderPass!=="translucent")return;const D=I.paint.get("line-opacity"),H=I.paint.get("line-width");if(D.constantOr(1)===0||H.constantOr(1)===0)return;const z=v.depthModeForSublayer(0,Cr.ReadOnly),$=v.colorModeForRenderPass(),J=I.paint.get("line-dasharray"),K=I.paint.get("line-pattern"),tt=K.constantOr(1),At=I.paint.get("line-gradient"),pt=I.getCrossfadeParameters(),_t=tt?"linePattern":J?"lineSDF":At?"lineGradient":"line",mt=v.context,Et=mt.gl;let Dt=!0;for(const Rt of M){const oe=S.getTile(Rt);if(tt&&!oe.patternsLoaded())continue;const ge=oe.getBucket(I);if(!ge)continue;const _e=ge.programConfigurations.get(I.id),Ce=v.context.program.get(),xe=v.useProgram(_t,_e),ve=Dt||xe.program!==Ce,Se=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Rt),sr=K.constantOr(null);if(sr&&oe.imageAtlas){const dr=oe.imageAtlas,Pr=dr.patternPositions[sr.to.toString()],Ir=dr.patternPositions[sr.from.toString()];Pr&&Ir&&_e.setConstantPatternPositions(Pr,Ir)}const Pe=Se?Rt:null,Me=tt?Wa(v,oe,I,pt,Pe):J?ru(v,oe,I,J,pt,Pe):At?lA(v,oe,I,ge.lineClipsArray.length,Pe):to(v,oe,I,Pe);if(tt)mt.activeTexture.set(Et.TEXTURE0),oe.imageAtlasTexture.bind(Et.LINEAR,Et.CLAMP_TO_EDGE),_e.updatePaintBuffers(pt);else if(J&&(ve||v.lineAtlas.dirty))mt.activeTexture.set(Et.TEXTURE0),v.lineAtlas.bind(mt);else if(At){const dr=ge.gradients[I.id];let Pr=dr.texture;if(I.gradientVersion!==dr.version){let Ir=256;if(I.stepInterpolant){const Dr=S.getSource().maxzoom,Kr=Rt.canonical.z===Dr?Math.ceil(1<<v.transform.maxZoom-Rt.canonical.z):1;Ir=o.ac(o.aV(ge.maxLineLength/o.X*1024*Kr),256,mt.maxTextureSize)}dr.gradient=o.aW({expression:I.gradientExpression(),evaluationKey:"lineProgress",resolution:Ir,image:dr.gradient||void 0,clips:ge.lineClipsArray}),dr.texture?dr.texture.update(dr.gradient):dr.texture=new ot(mt,dr.gradient,Et.RGBA),dr.version=I.gradientVersion,Pr=dr.texture}mt.activeTexture.set(Et.TEXTURE0),Pr.bind(I.stepInterpolant?Et.NEAREST:Et.LINEAR,Et.CLAMP_TO_EDGE)}xe.draw(mt,Et.TRIANGLES,z,v.stencilModeForClipping(Rt),$,dn.disabled,Me,Se,I.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,I.paint,v.transform.zoom,_e,ge.layoutVertexBuffer2),Dt=!1}})(l,A,p,y);break;case"fill":(function(v,S,I,M){const D=I.paint.get("fill-color"),H=I.paint.get("fill-opacity");if(H.constantOr(1)===0)return;const z=v.colorModeForRenderPass(),$=I.paint.get("fill-pattern"),J=v.opaquePassEnabledForLayer()&&!$.constantOr(1)&&D.constantOr(o.aM.transparent).a===1&&H.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===J){const K=v.depthModeForSublayer(1,v.renderPass==="opaque"?Cr.ReadWrite:Cr.ReadOnly);tl(v,S,I,M,K,z,!1)}if(v.renderPass==="translucent"&&I.paint.get("fill-antialias")){const K=v.depthModeForSublayer(I.getPaintProperty("fill-outline-color")?2:0,Cr.ReadOnly);tl(v,S,I,M,K,z,!0)}})(l,A,p,y);break;case"fill-extrusion":(function(v,S,I,M){const D=I.paint.get("fill-extrusion-opacity");if(D!==0&&v.renderPass==="translucent"){const H=new Cr(v.context.gl.LEQUAL,Cr.ReadWrite,v.depthRangeFor3D);if(D!==1||I.paint.get("fill-extrusion-pattern").constantOr(1))wc(v,S,I,M,H,An.disabled,Jr.disabled),wc(v,S,I,M,H,v.stencilModeFor3D(),v.colorModeForRenderPass());else{const z=v.colorModeForRenderPass();wc(v,S,I,M,H,An.disabled,z)}}})(l,A,p,y);break;case"hillshade":(function(v,S,I,M){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;const D=v.context,H=v.depthModeForSublayer(0,Cr.ReadOnly),z=v.colorModeForRenderPass(),[$,J]=v.renderPass==="translucent"?v.stencilConfigForOverlap(M):[{},M];for(const K of J){const tt=S.getTile(K);tt.needsHillshadePrepare!==void 0&&tt.needsHillshadePrepare&&v.renderPass==="offscreen"?Ba(v,tt,I,H,An.disabled,z):v.renderPass==="translucent"&&us(v,K,tt,I,H,$[K.overscaledZ],z)}D.viewport.set([0,0,v.width,v.height])})(l,A,p,y);break;case"raster":(function(v,S,I,M){if(v.renderPass!=="translucent"||I.paint.get("raster-opacity")===0||!M.length)return;const D=v.context,H=D.gl,z=S.getSource(),$=v.useProgram("raster"),J=v.colorModeForRenderPass(),[K,tt]=z instanceof We?[{},M]:v.stencilConfigForOverlap(M),At=tt[tt.length-1].overscaledZ,pt=!v.options.moving;for(const _t of tt){const mt=v.depthModeForSublayer(_t.overscaledZ-At,I.paint.get("raster-opacity")===1?Cr.ReadWrite:Cr.ReadOnly,H.LESS),Et=S.getTile(_t);Et.registerFadeDuration(I.paint.get("raster-fade-duration"));const Dt=S.findLoadedParent(_t,0),Rt=S.findLoadedSibling(_t),oe=mh(Et,Dt||Rt||null,S,I,v.transform,v.style.map.terrain);let ge,_e;const Ce=I.paint.get("raster-resampling")==="nearest"?H.NEAREST:H.LINEAR;D.activeTexture.set(H.TEXTURE0),Et.texture.bind(Ce,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),D.activeTexture.set(H.TEXTURE1),Dt?(Dt.texture.bind(Ce,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),ge=Math.pow(2,Dt.tileID.overscaledZ-Et.tileID.overscaledZ),_e=[Et.tileID.canonical.x*ge%1,Et.tileID.canonical.y*ge%1]):Et.texture.bind(Ce,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),Et.texture.useMipmap&&D.extTextureFilterAnisotropic&&v.transform.pitch>20&&H.texParameterf(H.TEXTURE_2D,D.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,D.extTextureFilterAnisotropicMax);const xe=v.style.map.terrain&&v.style.map.terrain.getTerrainData(_t),ve=xe?_t:null,Se=ve?ve.posMatrix:v.transform.calculatePosMatrix(_t.toUnwrapped(),pt),sr=Cd(Se,_e||[0,0],ge||1,oe,I);z instanceof We?$.draw(D,H.TRIANGLES,mt,An.disabled,J,dn.disabled,sr,xe,I.id,z.boundsBuffer,v.quadTriangleIndexBuffer,z.boundsSegments):$.draw(D,H.TRIANGLES,mt,K[_t.overscaledZ],J,dn.disabled,sr,xe,I.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments)}})(l,A,p,y);break;case"background":(function(v,S,I,M){const D=I.paint.get("background-color"),H=I.paint.get("background-opacity");if(H===0)return;const z=v.context,$=z.gl,J=v.transform,K=J.tileSize,tt=I.paint.get("background-pattern");if(v.isPatternMissing(tt))return;const At=!tt&&D.a===1&&H===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==At)return;const pt=An.disabled,_t=v.depthModeForSublayer(0,At==="opaque"?Cr.ReadWrite:Cr.ReadOnly),mt=v.colorModeForRenderPass(),Et=v.useProgram(tt?"backgroundPattern":"background"),Dt=M||J.coveringTiles({tileSize:K,terrain:v.style.map.terrain});tt&&(z.activeTexture.set($.TEXTURE0),v.imageManager.bind(v.context));const Rt=I.getCrossfadeParameters();for(const oe of Dt){const ge=M?oe.posMatrix:v.transform.calculatePosMatrix(oe.toUnwrapped()),_e=tt?Xa(ge,H,v,tt,{tileID:oe,tileSize:K},Rt):su(ge,H,D),Ce=v.style.map.terrain&&v.style.map.terrain.getTerrainData(oe);Et.draw(z,$.TRIANGLES,_t,pt,mt,dn.disabled,_e,Ce,I.id,v.tileExtentBuffer,v.quadTriangleIndexBuffer,v.tileExtentSegments)}})(l,0,p,y);break;case"custom":(function(v,S,I){const M=v.context,D=I.implementation;if(v.renderPass==="offscreen"){const H=D.prerender;H&&(v.setCustomLayerDefaults(),M.setColorMode(v.colorModeForRenderPass()),H.call(D,M.gl,v.transform.customLayerMatrix()),M.setDirty(),v.setBaseState())}else if(v.renderPass==="translucent"){v.setCustomLayerDefaults(),M.setColorMode(v.colorModeForRenderPass()),M.setStencilMode(An.disabled);const H=D.renderingMode==="3d"?new Cr(v.context.gl.LEQUAL,Cr.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,Cr.ReadOnly);M.setDepthMode(H),D.render(M.gl,v.transform.customLayerMatrix(),{farZ:v.transform.farZ,nearZ:v.transform.nearZ,fov:v.transform._fov,modelViewProjectionMatrix:v.transform.modelViewProjectionMatrix,projectionMatrix:v.transform.projectionMatrix}),M.setDirty(),v.setBaseState(),M.bindFramebuffer.set(null)}})(l,0,p)}}translatePosMatrix(l,A,p,y,v){if(!p[0]&&!p[1])return l;const S=v?y==="map"?this.transform.angle:0:y==="viewport"?-this.transform.angle:0;if(S){const D=Math.sin(S),H=Math.cos(S);p=[p[0]*H-p[1]*D,p[0]*D+p[1]*H]}const I=[v?p[0]:xr(A,p[0],this.transform.zoom),v?p[1]:xr(A,p[1],this.transform.zoom),0],M=new Float32Array(16);return o.J(M,l,I),M}saveTileTexture(l){const A=this._tileTextures[l.size[0]];A?A.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const A=this._tileTextures[l];return A&&A.length>0?A.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;const A=this.imageManager.getPattern(l.from.toString()),p=this.imageManager.getPattern(l.to.toString());return!A||!p}useProgram(l,A){this.cache=this.cache||{};const p=l+(A?A.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[p]||(this.cache[p]=new xt(this.context,Bs[l],A,_c[l],this._showOverdrawInspector,this.style.map.terrain)),this.cache[p]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ot(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:l,drawingBufferHeight:A}=this.context.gl;return this.width!==l||this.height!==A}}class As{constructor(l,A){this.points=l,this.planes=A}static fromInvProjectionMatrix(l,A,p){const y=Math.pow(2,p),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(I=>{const M=1/(I=o.af([],I,l))[3]/A*y;return o.b1(I,I,[M,M,1/I[3],M])}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(I=>{const M=function($,J){var K=J[0],tt=J[1],At=J[2],pt=K*K+tt*tt+At*At;return pt>0&&(pt=1/Math.sqrt(pt)),$[0]=J[0]*pt,$[1]=J[1]*pt,$[2]=J[2]*pt,$}([],function($,J,K){var tt=J[0],At=J[1],pt=J[2],_t=K[0],mt=K[1],Et=K[2];return $[0]=At*Et-pt*mt,$[1]=pt*_t-tt*Et,$[2]=tt*mt-At*_t,$}([],gt([],v[I[0]],v[I[1]]),gt([],v[I[2]],v[I[1]]))),D=-((H=M)[0]*(z=v[I[1]])[0]+H[1]*z[1]+H[2]*z[2]);var H,z;return M.concat(D)});return new As(v,S)}}class Hs{constructor(l,A){this.min=l,this.max=A,this.center=function(p,y,v){return p[0]=.5*y[0],p[1]=.5*y[1],p[2]=.5*y[2],p}([],function(p,y,v){return p[0]=y[0]+v[0],p[1]=y[1]+v[1],p[2]=y[2]+v[2],p}([],this.min,this.max))}quadrant(l){const A=[l%2==0,l<2],p=ct(this.min),y=ct(this.max);for(let v=0;v<A.length;v++)p[v]=A[v]?this.min[v]:this.center[v],y[v]=A[v]?this.center[v]:this.max[v];return y[2]=this.max[2],new Hs(p,y)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}intersects(l){const A=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let p=!0;for(let y=0;y<l.planes.length;y++){const v=l.planes[y];let S=0;for(let I=0;I<A.length;I++)o.b2(v,A[I])>=0&&S++;if(S===0)return 0;S!==A.length&&(p=!1)}if(p)return 2;for(let y=0;y<3;y++){let v=Number.MAX_VALUE,S=-Number.MAX_VALUE;for(let I=0;I<l.points.length;I++){const M=l.points[I][y]-this.min[y];v=Math.min(v,M),S=Math.max(S,M)}if(S<0||v>this.max[y]-this.min[y])return 0}return 1}}class So{constructor(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(isNaN(l)||l<0||isNaN(A)||A<0||isNaN(p)||p<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=A,this.left=p,this.right=y}interpolate(l,A,p){return A.top!=null&&l.top!=null&&(this.top=o.y.number(l.top,A.top,p)),A.bottom!=null&&l.bottom!=null&&(this.bottom=o.y.number(l.bottom,A.bottom,p)),A.left!=null&&l.left!=null&&(this.left=o.y.number(l.left,A.left,p)),A.right!=null&&l.right!=null&&(this.right=o.y.number(l.right,A.right,p)),this}getCenter(l,A){const p=o.ac((this.left+l-this.right)/2,0,l),y=o.ac((this.top+A-this.bottom)/2,0,A);return new o.P(p,y)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new So(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Ml=85.051129;class To{constructor(l,A,p,y,v){this.tileSize=512,this._renderWorldCopies=v===void 0||!!v,this._minZoom=l||0,this._maxZoom=A||22,this._minPitch=p??0,this._maxPitch=y??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new So,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const l=new To(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.apply(this),l}apply(l){this.tileSize=l.tileSize,this.latRange=l.latRange,this.lngRange=l.lngRange,this.width=l.width,this.height=l.height,this._center=l._center,this._elevation=l._elevation,this.minElevationForCurrentTile=l.minElevationForCurrentTile,this.zoom=l.zoom,this.angle=l.angle,this._fov=l._fov,this._pitch=l._pitch,this._unmodified=l._unmodified,this._edgeInsets=l._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(l){const A=-o.b3(l,-180,180)*Math.PI/180;this.angle!==A&&(this._unmodified=!1,this.angle=A,this._calcMatrices(),this.rotationMatrix=function(){var p=new o.A(4);return o.A!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p}(),function(p,y,v){var S=y[0],I=y[1],M=y[2],D=y[3],H=Math.sin(v),z=Math.cos(v);p[0]=S*z+M*H,p[1]=I*z+D*H,p[2]=S*-H+M*z,p[3]=I*-H+D*z}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const A=o.ac(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==A&&(this._unmodified=!1,this._pitch=A,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(l){const A=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==A&&(this._unmodified=!1,this._zoom=A,this.tileZoom=Math.max(0,Math.floor(A)),this.scale=this.zoomScale(A),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(l){l!==this._elevation&&(this._elevation=l,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,A,p){this._unmodified=!1,this._edgeInsets.interpolate(l,A,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const A=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,A)}getVisibleUnwrappedCoordinates(l){const A=[new o.b4(0,l)];if(this._renderWorldCopies){const p=this.pointCoordinate(new o.P(0,0)),y=this.pointCoordinate(new o.P(this.width,0)),v=this.pointCoordinate(new o.P(this.width,this.height)),S=this.pointCoordinate(new o.P(0,this.height)),I=Math.floor(Math.min(p.x,y.x,v.x,S.x)),M=Math.floor(Math.max(p.x,y.x,v.x,S.x)),D=1;for(let H=I-D;H<=M+D;H++)H!==0&&A.push(new o.b4(H,l))}return A}coveringTiles(l){var A,p;let y=this.coveringZoomLevel(l);const v=y;if(l.minzoom!==void 0&&y<l.minzoom)return[];l.maxzoom!==void 0&&y>l.maxzoom&&(y=l.maxzoom);const S=this.pointCoordinate(this.getCameraPoint()),I=o.Z.fromLngLat(this.center),M=Math.pow(2,y),D=[M*S.x,M*S.y,0],H=[M*I.x,M*I.y,0],z=As.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,y);let $=l.minzoom||0;!l.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&($=y);const J=l.terrain?2/Math.min(this.tileSize,l.tileSize)*this.tileSize:3,K=mt=>({aabb:new Hs([mt*M,0,0],[(mt+1)*M,M,0]),zoom:0,x:0,y:0,wrap:mt,fullyVisible:!1}),tt=[],At=[],pt=y,_t=l.reparseOverscaled?v:y;if(this._renderWorldCopies)for(let mt=1;mt<=3;mt++)tt.push(K(-mt)),tt.push(K(mt));for(tt.push(K(0));tt.length>0;){const mt=tt.pop(),Et=mt.x,Dt=mt.y;let Rt=mt.fullyVisible;if(!Rt){const xe=mt.aabb.intersects(z);if(xe===0)continue;Rt=xe===2}const oe=l.terrain?D:H,ge=mt.aabb.distanceX(oe),_e=mt.aabb.distanceY(oe),Ce=Math.max(Math.abs(ge),Math.abs(_e));if(mt.zoom===pt||Ce>J+(1<<pt-mt.zoom)-2&&mt.zoom>=$){const xe=pt-mt.zoom,ve=D[0]-.5-(Et<<xe),Se=D[1]-.5-(Dt<<xe);At.push({tileID:new o.S(mt.zoom===pt?_t:mt.zoom,mt.wrap,mt.zoom,Et,Dt),distanceSq:ht([H[0]-.5-Et,H[1]-.5-Dt]),tileDistanceToCamera:Math.sqrt(ve*ve+Se*Se)})}else for(let xe=0;xe<4;xe++){const ve=(Et<<1)+xe%2,Se=(Dt<<1)+(xe>>1),sr=mt.zoom+1;let Pe=mt.aabb.quadrant(xe);if(l.terrain){const Me=new o.S(sr,mt.wrap,sr,ve,Se),dr=l.terrain.getMinMaxElevation(Me),Pr=(A=dr.minElevation)!==null&&A!==void 0?A:this.elevation,Ir=(p=dr.maxElevation)!==null&&p!==void 0?p:this.elevation;Pe=new Hs([Pe.min[0],Pe.min[1],Pr],[Pe.max[0],Pe.max[1],Ir])}tt.push({aabb:Pe,zoom:sr,x:ve,y:Se,wrap:mt.wrap,fullyVisible:Rt})}}return At.sort((mt,Et)=>mt.distanceSq-Et.distanceSq).map(mt=>mt.tileID)}resize(l,A){this.width=l,this.height=A,this.pixelsToGLUnits=[2/l,-2/A],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const A=o.ac(l.lat,-85.051129,Ml);return new o.P(o.O(l.lng)*this.worldSize,o.Q(A)*this.worldSize)}unproject(l){return new o.Z(l.x/this.worldSize,l.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(l){const A=this.elevation,p=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,y=this.pointLocation(this.centerPoint,l),v=l.getElevationForLngLatZoom(y,this.tileZoom);if(!(this.elevation-v))return;const S=p+A-v,I=Math.cos(this._pitch)*this.cameraToCenterDistance/S/o.b5(1,y.lat),M=this.scaleZoom(I/this.tileSize);this._elevation=v,this._center=y,this.zoom=M}setLocationAtPoint(l,A){const p=this.pointCoordinate(A),y=this.pointCoordinate(this.centerPoint),v=this.locationCoordinate(l),S=new o.Z(v.x-(p.x-y.x),v.y-(p.y-y.y));this.center=this.coordinateLocation(S),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(l,A){return A?this.coordinatePoint(this.locationCoordinate(l),A.getElevationForLngLatZoom(l,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(l))}pointLocation(l,A){return this.coordinateLocation(this.pointCoordinate(l,A))}locationCoordinate(l){return o.Z.fromLngLat(l)}coordinateLocation(l){return l&&l.toLngLat()}pointCoordinate(l,A){if(A){const $=A.pointCoordinate(l);if($!=null)return $}const p=[l.x,l.y,0,1],y=[l.x,l.y,1,1];o.af(p,p,this.pixelMatrixInverse),o.af(y,y,this.pixelMatrixInverse);const v=p[3],S=y[3],I=p[1]/v,M=y[1]/S,D=p[2]/v,H=y[2]/S,z=D===H?0:(0-D)/(H-D);return new o.Z(o.y.number(p[0]/v,y[0]/S,z)/this.worldSize,o.y.number(I,M,z)/this.worldSize)}coordinatePoint(l){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.pixelMatrix;const y=[l.x*this.worldSize,l.y*this.worldSize,A,1];return o.af(y,y,p),new o.P(y[0]/y[3],y[1]/y[3])}getBounds(){const l=Math.max(0,this.height/2-this.getHorizon());return new st().extend(this.pointLocation(new o.P(0,l))).extend(this.pointLocation(new o.P(this.width,l))).extend(this.pointLocation(new o.P(this.width,this.height))).extend(this.pointLocation(new o.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new st([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Ml])}calculateTileMatrix(l){const A=l.canonical,p=this.worldSize/this.zoomScale(A.z),y=A.x+Math.pow(2,A.z)*l.wrap,v=o.an(new Float64Array(16));return o.J(v,v,[y*p,A.y*p,0]),o.K(v,v,[p/o.X,p/o.X,1]),v}calculatePosMatrix(l){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=l.key,y=A?this._alignedPosMatrixCache:this._posMatrixCache;if(y[p])return y[p];const v=this.calculateTileMatrix(l);return o.L(v,A?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,v),y[p]=new Float32Array(v),y[p]}calculateFogMatrix(l){const A=l.key,p=this._fogMatrixCache;if(p[A])return p[A];const y=this.calculateTileMatrix(l);return o.L(y,this.fogMatrix,y),p[A]=new Float32Array(y),p[A]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(l,A){A=o.ac(+A,this.minZoom,this.maxZoom);const p={center:new o.N(l.lng,l.lat),zoom:A};let y=this.lngRange;if(!this._renderWorldCopies&&y===null){const mt=179.9999999999;y=[-mt,mt]}const v=this.tileSize*this.zoomScale(p.zoom);let S=0,I=v,M=0,D=v,H=0,z=0;const{x:$,y:J}=this.size;if(this.latRange){const mt=this.latRange;S=o.Q(mt[1])*v,I=o.Q(mt[0])*v,I-S<J&&(H=J/(I-S))}y&&(M=o.b3(o.O(y[0])*v,0,v),D=o.b3(o.O(y[1])*v,0,v),D<M&&(D+=v),D-M<$&&(z=$/(D-M)));const{x:K,y:tt}=this.project.call({worldSize:v},l);let At,pt;const _t=Math.max(z||0,H||0);if(_t){const mt=new o.P(z?(D+M)/2:K,H?(I+S)/2:tt);return p.center=this.unproject.call({worldSize:v},mt).wrap(),p.zoom+=this.scaleZoom(_t),p}if(this.latRange){const mt=J/2;tt-mt<S&&(pt=S+mt),tt+mt>I&&(pt=I-mt)}if(y){const mt=(M+D)/2;let Et=K;this._renderWorldCopies&&(Et=o.b3(K,mt-v/2,mt+v/2));const Dt=$/2;Et-Dt<M&&(At=M+Dt),Et+Dt>D&&(At=D-Dt)}if(At!==void 0||pt!==void 0){const mt=new o.P(At??K,pt??tt);p.center=this.unproject.call({worldSize:v},mt).wrap()}return p}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const l=this._unmodified,{center:A,zoom:p}=this.getConstrained(this.center,this.zoom);this.center=A,this.zoom=p,this._unmodified=l,this._constraining=!1}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,A=this.point.x,p=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=o.b5(1,this.center.lat)*this.worldSize;let y=o.an(new Float64Array(16));o.K(y,y,[this.width/2,-this.height/2,1]),o.J(y,y,[1,-1,0]),this.labelPlaneMatrix=y,y=o.an(new Float64Array(16)),o.K(y,y,[1,-1,1]),o.J(y,y,[-1,-1,0]),o.K(y,y,[2/this.width,2/this.height,1]),this.glCoordMatrix=y;const v=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),S=Math.min(this.elevation,this.minElevationForCurrentTile),I=v-S*this._pixelPerMeter/Math.cos(this._pitch),M=S<0?I:v,D=Math.PI/2+this._pitch,H=this._fov*(.5+l.y/this.height),z=Math.sin(H)*M/Math.sin(o.ac(Math.PI-D-H,.01,Math.PI-.01)),$=this.getHorizon(),J=2*Math.atan($/this.cameraToCenterDistance)*(.5+l.y/(2*$)),K=Math.sin(J)*M/Math.sin(o.ac(Math.PI-D-J,.01,Math.PI-.01)),tt=Math.min(z,K);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*tt+M),this.nearZ=this.height/50,y=new Float64Array(16),o.b6(y,this._fov,this.width/this.height,this.nearZ,this.farZ),y[8]=2*-l.x/this.width,y[9]=2*l.y/this.height,this.projectionMatrix=o.ae(y),o.K(y,y,[1,-1,1]),o.J(y,y,[0,0,-this.cameraToCenterDistance]),o.b7(y,y,this._pitch),o.ad(y,y,this.angle),o.J(y,y,[-A,-p,0]),this.mercatorMatrix=o.K([],y,[this.worldSize,this.worldSize,this.worldSize]),o.K(y,y,[1,1,this._pixelPerMeter]),this.pixelMatrix=o.L(new Float64Array(16),this.labelPlaneMatrix,y),o.J(y,y,[0,0,-this.elevation]),this.modelViewProjectionMatrix=y,this.invModelViewProjectionMatrix=o.as([],y),this.fogMatrix=new Float64Array(16),o.b6(this.fogMatrix,this._fov,this.width/this.height,v,this.farZ),this.fogMatrix[8]=2*-l.x/this.width,this.fogMatrix[9]=2*l.y/this.height,o.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),o.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),o.b7(this.fogMatrix,this.fogMatrix,this._pitch),o.ad(this.fogMatrix,this.fogMatrix,this.angle),o.J(this.fogMatrix,this.fogMatrix,[-A,-p,0]),o.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),o.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=o.L(new Float64Array(16),this.labelPlaneMatrix,y);const At=this.width%2/2,pt=this.height%2/2,_t=Math.cos(this.angle),mt=Math.sin(this.angle),Et=A-Math.round(A)+_t*At+mt*pt,Dt=p-Math.round(p)+_t*pt+mt*At,Rt=new Float64Array(y);if(o.J(Rt,Rt,[Et>.5?Et-1:Et,Dt>.5?Dt-1:Dt,0]),this.alignedModelViewProjectionMatrix=Rt,y=o.as(new Float64Array(16),this.pixelMatrix),!y)throw new Error("failed to invert matrix");this.pixelMatrixInverse=y,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const l=this.pointCoordinate(new o.P(0,0)),A=[l.x*this.worldSize,l.y*this.worldSize,0,1];return o.af(A,A,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,l))}getCameraQueryGeometry(l){const A=this.getCameraPoint();if(l.length===1)return[l[0],A];{let p=A.x,y=A.y,v=A.x,S=A.y;for(const I of l)p=Math.min(p,I.x),y=Math.min(y,I.y),v=Math.max(v,I.x),S=Math.max(S,I.y);return[new o.P(p,y),new o.P(v,y),new o.P(v,S),new o.P(p,S),new o.P(p,y)]}}lngLatToCameraDepth(l,A){const p=this.locationCoordinate(l),y=[p.x*this.worldSize,p.y*this.worldSize,A,1];return o.af(y,y,this.modelViewProjectionMatrix),y[2]/y[3]}}function Io(m,l){var A=this;let p,y=!1,v=null,S=null;const I=()=>{v=null,y&&(m.apply(S,p),v=setTimeout(I,l),y=!1)};return function(){for(var M=arguments.length,D=new Array(M),H=0;H<M;H++)D[H]=arguments[H];return y=!0,S=A,p=D,v||I(),v}}class Rl{constructor(l){this._getCurrentHash=()=>{const A=window.location.hash.replace("#","");if(this._hashName){let p;return A.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(p=y)}),(p&&p[1]||"").split("/")}return A.split("/")},this._onHashChange=()=>{const A=this._getCurrentHash();if(A.length>=3&&!A.some(p=>isNaN(p))){const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(A[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+A[2],+A[1]],zoom:+A[0],bearing:p,pitch:+(A[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const A=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,A)},this._removeHash=()=>{const A=this._getCurrentHash();if(A.length===0)return;const p=A.join("/");let y=p;y.split("&").length>0&&(y=y.split("&")[0]),this._hashName&&(y=`${this._hashName}=${p}`);let v=window.location.hash.replace(y,"");v.startsWith("#&")?v=v.slice(0,1)+v.slice(2):v==="#"&&(v="");let S=window.location.href.replace(/(#.+)?$/,v);S=S.replace("&&","&"),window.history.replaceState(window.history.state,null,S)},this._updateHash=Io(this._updateHashUnthrottled,300),this._hashName=l&&encodeURIComponent(l)}addTo(l){return this._map=l,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(l){const A=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,y=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,y),S=Math.round(A.lng*v)/v,I=Math.round(A.lat*v)/v,M=this._map.getBearing(),D=this._map.getPitch();let H="";if(H+=l?`/${S}/${I}/${p}`:`${p}/${I}/${S}`,(M||D)&&(H+="/"+Math.round(10*M)/10),D&&(H+=`/${Math.round(D)}`),this._hashName){const z=this._hashName;let $=!1;const J=window.location.hash.slice(1).split("&").map(K=>{const tt=K.split("=")[0];return tt===z?($=!0,`${tt}=${H}`):K}).filter(K=>K);return $||J.push(`${z}=${H}`),`#${J.join("&")}`}return`#${H}`}}const Ts={linearity:.3,easing:o.b8(0,0,.3,1)},na=o.e({deceleration:2500,maxSpeed:1400},Ts),Kn=o.e({deceleration:20,maxSpeed:1400},Ts),Qn=o.e({deceleration:1e3,maxSpeed:360},Ts),oi=o.e({deceleration:1e3,maxSpeed:90},Ts);class wi{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:w.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,A=w.now();for(;l.length>0&&A-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const A={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)A.zoom+=v.zoomDelta||0,A.bearing+=v.bearingDelta||0,A.pitch+=v.pitchDelta||0,v.panDelta&&A.pan._add(v.panDelta),v.around&&(A.around=v.around),v.pinchAround&&(A.pinchAround=v.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(A.pan.mag()){const v=Fo(A.pan.mag(),p,o.e({},na,l||{}));y.offset=A.pan.mult(v.amount/A.pan.mag()),y.center=this._map.transform.center,ro(y,v)}if(A.zoom){const v=Fo(A.zoom,p,Kn);y.zoom=this._map.transform.zoom+v.amount,ro(y,v)}if(A.bearing){const v=Fo(A.bearing,p,Qn);y.bearing=this._map.transform.bearing+o.ac(v.amount,-179,179),ro(y,v)}if(A.pitch){const v=Fo(A.pitch,p,oi);y.pitch=this._map.transform.pitch+v.amount,ro(y,v)}if(y.zoom||y.bearing){const v=A.pinchAround===void 0?A.around:A.pinchAround;y.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),o.e(y,{noMoveStart:!0})}}function ro(m,l){(!m.duration||m.duration<l.duration)&&(m.duration=l.duration,m.easing=l.easing)}function Fo(m,l,A){const{maxSpeed:p,linearity:y,deceleration:v}=A,S=o.ac(m*y/(l/1e3),-p,p),I=Math.abs(S)/(v*y);return{easing:A.easing,duration:1e3*I,amount:S*(I/2)}}class xi extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,A,p){let y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const v=x.mousePos(A.getCanvas(),p),S=A.unproject(v);super(l,o.e({point:v,lngLat:S,originalEvent:p},y)),this._defaultPrevented=!1,this.target=A}}class Ea extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,A,p){const y=l==="touchend"?p.changedTouches:p.touches,v=x.touchPos(A.getCanvasContainer(),y),S=v.map(M=>A.unproject(M)),I=v.reduce((M,D,H,z)=>M.add(D.div(z.length)),new o.P(0,0));super(l,{points:v,point:I,lngLats:S,lngLat:A.unproject(I),originalEvent:p}),this._defaultPrevented=!1}}class Td extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,A,p){super(l,{originalEvent:p}),this._defaultPrevented=!1}}class Id{constructor(l,A){this._map=l,this._clickTolerance=A.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new Td(l.type,this._map,l))}mousedown(l,A){return this._mousedownPos=A,this._firePreventable(new xi(l.type,this._map,l))}mouseup(l){this._map.fire(new xi(l.type,this._map,l))}click(l,A){this._mousedownPos&&this._mousedownPos.dist(A)>=this._clickTolerance||this._map.fire(new xi(l.type,this._map,l))}dblclick(l){return this._firePreventable(new xi(l.type,this._map,l))}mouseover(l){this._map.fire(new xi(l.type,this._map,l))}mouseout(l){this._map.fire(new xi(l.type,this._map,l))}touchstart(l){return this._firePreventable(new Ea(l.type,this._map,l))}touchmove(l){this._map.fire(new Ea(l.type,this._map,l))}touchend(l){this._map.fire(new Ea(l.type,this._map,l))}touchcancel(l){this._map.fire(new Ea(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ai{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(l){this._map.fire(new xi(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new xi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._ignoreContextMenu||this._map.fire(new xi(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Lo{constructor(l){this._map=l}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(l){return this.transform.pointLocation(o.P.convert(l),this._map.terrain)}}class Vs{constructor(l,A){this._map=l,this._tr=new Lo(l),this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=A.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,A){this.isEnabled()&&l.shiftKey&&l.button===0&&(x.disableDrag(),this._startPos=this._lastPos=A,this._active=!0)}mousemoveWindow(l,A){if(!this._active)return;const p=A;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const y=this._startPos;this._lastPos=p,this._box||(this._box=x.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",l));const v=Math.min(y.x,p.x),S=Math.max(y.x,p.x),I=Math.min(y.y,p.y),M=Math.max(y.y,p.y);x.setTransform(this._box,`translate(${v}px,${I}px)`),this._box.style.width=S-v+"px",this._box.style.height=M-I+"px"}mouseupWindow(l,A){if(!this._active||l.button!==0)return;const p=this._startPos,y=A;if(this.reset(),x.suppressClick(),p.x!==y.x||p.y!==y.y)return this._map.fire(new o.k("boxzoomend",{originalEvent:l})),{cameraAnimation:v=>v.fitScreenCoordinates(p,y,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",l)}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(x.remove(this._box),this._box=null),x.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,A){return this._map.fire(new o.k(l,{originalEvent:A}))}}function du(m,l){if(m.length!==l.length)throw new Error(`The number of touches and points are not equal - touches ${m.length}, points ${l.length}`);const A={};for(let p=0;p<m.length;p++)A[m[p].identifier]=l[p];return A}class fA{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,A,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),p.length===this.numTouches&&(this.centroid=function(y){const v=new o.P(0,0);for(const S of y)v._add(S);return v.div(y.length)}(A),this.touches=du(p,A)))}touchmove(l,A,p){if(this.aborted||!this.centroid)return;const y=du(p,A);for(const v in this.touches){const S=y[v];(!S||S.dist(this.touches[v])>30)&&(this.aborted=!0)}}touchend(l,A,p){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class Bc{constructor(l){this.singleTap=new fA(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,A,p){this.singleTap.touchstart(l,A,p)}touchmove(l,A,p){this.singleTap.touchmove(l,A,p)}touchend(l,A,p){const y=this.singleTap.touchend(l,A,p);if(y){const v=l.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(y)<30;if(v&&S||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class Hi{constructor(l){this._tr=new Lo(l),this._zoomIn=new Bc({numTouches:1,numTaps:2}),this._zoomOut=new Bc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,A,p){this._zoomIn.touchstart(l,A,p),this._zoomOut.touchstart(l,A,p)}touchmove(l,A,p){this._zoomIn.touchmove(l,A,p),this._zoomOut.touchmove(l,A,p)}touchend(l,A,p){const y=this._zoomIn.touchend(l,A,p),v=this._zoomOut.touchend(l,A,p),S=this._tr;return y?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(y)},{originalEvent:l})}):v?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(v)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ti{constructor(l){this._enabled=!!l.enable,this._moveStateManager=l.moveStateManager,this._clickTolerance=l.clickTolerance||1,this._moveFunction=l.move,this._activateOnStart=!!l.activateOnStart,l.assignEvents(this),this.reset()}reset(l){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(l)}_move(){const l=this._moveFunction(...arguments);if(l.bearingDelta||l.pitchDelta||l.around||l.panDelta)return this._active=!0,l}dragStart(l,A){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(l)&&(this._moveStateManager.startMove(l),this._lastPoint=A.length?A[0]:A,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(l,A){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(l.preventDefault(),!this._moveStateManager.isValidMoveEvent(l))return void this.reset(l);const y=A.length?A[0]:A;return!this._moved&&y.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=y,this._move(p,y))}dragEnd(l){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(l)&&(this._moved&&x.suppressClick(),this.reset(l))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const fu={0:1,2:2};class Cc{constructor(l){this._correctEvent=l.checkCorrectEvent}startMove(l){const A=x.mouseButton(l);this._eventButton=A}endMove(l){delete this._eventButton}isValidStartEvent(l){return this._correctEvent(l)}isValidMoveEvent(l){return!function(A,p){const y=fu[p];return A.buttons===void 0||(A.buttons&y)!==y}(l,this._eventButton)}isValidEndEvent(l){return x.mouseButton(l)===this._eventButton}}class yh{constructor(){this._firstTouch=void 0}_isOneFingerTouch(l){return l.targetTouches.length===1}_isSameTouchEvent(l){return l.targetTouches[0].identifier===this._firstTouch}startMove(l){this._firstTouch=l.targetTouches[0].identifier}endMove(l){delete this._firstTouch}isValidStartEvent(l){return this._isOneFingerTouch(l)}isValidMoveEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}isValidEndEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}}const Ec=m=>{m.mousedown=m.dragStart,m.mousemoveWindow=m.dragMove,m.mouseup=m.dragEnd,m.contextmenu=l=>{l.preventDefault()}},pu=m=>{let{enable:l,clickTolerance:A,bearingDegreesPerPixelMoved:p=.8}=m;const y=new Cc({checkCorrectEvent:v=>x.mouseButton(v)===0&&v.ctrlKey||x.mouseButton(v)===2});return new Ti({clickTolerance:A,move:(v,S)=>({bearingDelta:(S.x-v.x)*p}),moveStateManager:y,enable:l,assignEvents:Ec})},pA=m=>{let{enable:l,clickTolerance:A,pitchDegreesPerPixelMoved:p=-.5}=m;const y=new Cc({checkCorrectEvent:v=>x.mouseButton(v)===0&&v.ctrlKey||x.mouseButton(v)===2});return new Ti({clickTolerance:A,move:(v,S)=>({pitchDelta:(S.y-v.y)*p}),moveStateManager:y,enable:l,assignEvents:Ec})};class Ul{constructor(l,A){this._clickTolerance=l.clickTolerance||1,this._map=A,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(l){return l<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(l,A,p){return this._calculateTransform(l,A,p)}touchmove(l,A,p){if(this._active){if(!this._shouldBePrevented(p.length))return l.preventDefault(),this._calculateTransform(l,A,p);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",l)}}touchend(l,A,p){this._calculateTransform(l,A,p),this._active&&this._shouldBePrevented(p.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,A,p){p.length>0&&(this._active=!0);const y=du(p,A),v=new o.P(0,0),S=new o.P(0,0);let I=0;for(const D in y){const H=y[D],z=this._touches[D];z&&(v._add(H),S._add(H.sub(z)),I++,y[D]=H)}if(this._touches=y,this._shouldBePrevented(I)||!S.mag())return;const M=S.div(I);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(I),panDelta:M}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(l,A,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([A[0],A[1]]))}touchmove(l,A,p){if(!this._firstTwoTouches)return;l.preventDefault();const[y,v]=this._firstTwoTouches,S=Sc(p,A,y),I=Sc(p,A,v);if(!S||!I)return;const M=this._aroundCenter?null:S.add(I).div(2);return this._move([S,I],M,l)}touchend(l,A,p){if(!this._firstTwoTouches)return;const[y,v]=this._firstTwoTouches,S=Sc(p,A,y),I=Sc(p,A,v);S&&I||(this._active&&x.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Sc(m,l,A){for(let p=0;p<m.length;p++)if(m[p].identifier===A)return l[p]}function mu(m,l){return Math.log(m/l)/Math.LN2}class gA extends gu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,A){const p=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(mu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:mu(this._distance,p),pinchAround:A}}}function Fd(m,l){return 180*m.angleWith(l)/Math.PI}class Ld extends gu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,A,p){const y=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Fd(this._vector,y),pinchAround:A}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const A=25/(Math.PI*this._minDiameter)*360,p=Fd(l,this._startVector);return Math.abs(p)<A}}function mA(m){return Math.abs(m.y)>Math.abs(m.x)}class yu extends gu{constructor(l){super(),this._currentTouchCount=0,this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(l,A,p){super.touchstart(l,A,p),this._currentTouchCount=p.length}_start(l){this._lastPoints=l,mA(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,A,p){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const y=l[0].sub(this._lastPoints[0]),v=l[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(y,v,p.timeStamp),this._valid?(this._lastPoints=l,this._active=!0,{pitchDelta:(y.y+v.y)/2*-.5}):void 0}gestureBeginsVertically(l,A,p){if(this._valid!==void 0)return this._valid;const y=l.mag()>=2,v=A.mag()>=2;if(!y&&!v)return;if(!y||!v)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const S=l.y>0==A.y>0;return mA(l)&&mA(A)&&S}}const vp={panStep:100,bearingStep:15,pitchStep:10};class Po{constructor(l){this._tr=new Lo(l);const A=vp;this._panStep=A.panStep,this._bearingStep=A.bearingStep,this._pitchStep=A.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let A=0,p=0,y=0,v=0,S=0;switch(l.keyCode){case 61:case 107:case 171:case 187:A=1;break;case 189:case 109:case 173:A=-1;break;case 37:l.shiftKey?p=-1:(l.preventDefault(),v=-1);break;case 39:l.shiftKey?p=1:(l.preventDefault(),v=1);break;case 38:l.shiftKey?y=1:(l.preventDefault(),S=-1);break;case 40:l.shiftKey?y=-1:(l.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(p=0,y=0),{cameraAnimation:I=>{const M=this._tr;I.easeTo({duration:300,easeId:"keyboardHandler",easing:Sa,zoom:A?Math.round(M.zoom)+A*(l.shiftKey?2:1):M.zoom,bearing:M.bearing+p*this._bearingStep,pitch:M.pitch+y*this._pitchStep,offset:[-v*this._panStep,-S*this._panStep],center:M.center},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Sa(m){return m*(2-m)}const Pd=4.000244140625;class no{constructor(l,A){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=l,this._tr=new Lo(l),this._triggerRenderFrame=A,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(l){return!!this._map.cooperativeGestures.isEnabled()&&!(l.ctrlKey||this._map.cooperativeGestures.isBypassed(l))}wheel(l){if(!this.isEnabled())return;if(this._shouldBePrevented(l))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",l);let A=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const p=w.now(),y=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,A!==0&&A%Pd==0?this._type="wheel":A!==0&&Math.abs(A)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=A,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(y*A)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,A+=this._lastValue)),l.shiftKey&&A&&(A/=4),this._type&&(this._lastWheelEvent=l,this._delta-=A,this._active||this._start(l)),l.preventDefault()}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const A=x.mousePos(this._map.getCanvas(),l),p=this._tr;this._around=A.y>p.transform.height/2-p.transform.getHorizon()?o.N.convert(this._aroundCenter?p.center:p.unproject(A)):o.N.convert(p.center),this._aroundPoint=p.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._tr.transform;if(this._delta!==0){const M=this._type==="wheel"&&Math.abs(this._delta)>Pd?this._wheelZoomRate:this._defaultZoomRate;let D=2/(1+Math.exp(-Math.abs(this._delta*M)));this._delta<0&&D!==0&&(D=1/D);const H=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):l.scale;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(H*D))),this._type==="wheel"&&(this._startZoom=l.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const A=typeof this._targetZoom=="number"?this._targetZoom:l.zoom,p=this._startZoom,y=this._easing;let v,S=!1;const I=w.now()-this._lastWheelEventTime;if(this._type==="wheel"&&p&&y&&I){const M=Math.min(I/200,1),D=y(M);v=o.y.number(p,A,D),M<1?this._frameId||(this._frameId=!0):S=!0}else v=A,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!S,zoomDelta:v-l.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let A=o.b9;if(this._prevEase){const p=this._prevEase,y=(w.now()-p.start)/p.duration,v=p.easing(y+.01)-p.easing(y),S=.27/Math.sqrt(v*v+1e-4)*.01,I=Math.sqrt(.0729-S*S);A=o.b8(S,I,.25,1)}return this._prevEase={start:w.now(),duration:l,easing:A},A}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class nl{constructor(l,A){this._clickZoom=l,this._tapZoom=A}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class yA{constructor(l){this._tr=new Lo(l),this.reset()}reset(){this._active=!1}dblclick(l,A){return l.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(l.shiftKey?-1:1),around:this._tr.unproject(A)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jm{constructor(){this._tap=new Bc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(l,A,p){if(!this._swipePoint)if(this._tapTime){const y=A[0],v=l.timeStamp-this._tapTime<500,S=this._tapPoint.dist(y)<30;v&&S?p.length>0&&(this._swipePoint=y,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(l,A,p)}touchmove(l,A,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const y=A[0],v=y.y-this._swipePoint.y;return this._swipePoint=y,l.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(l,A,p)}touchend(l,A,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{const y=this._tap.touchend(l,A,p);y&&(this._tapTime=l.timeStamp,this._tapPoint=y)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bp{constructor(l,A,p){this._el=l,this._mousePan=A,this._touchPan=p}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Md{constructor(l,A,p){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=A,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Rd{constructor(l,A,p,y){this._el=l,this._touchZoom=A,this._touchRotate=p,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class _u{constructor(l,A){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=l,this._options=A,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const l=this._map.getCanvasContainer();l.classList.add("maplibregl-cooperative-gestures"),this._container=x.create("div","maplibregl-cooperative-gesture-screen",l);let A=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(A=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const p=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),y=document.createElement("div");y.className="maplibregl-desktop-message",y.textContent=A,this._container.appendChild(y);const v=document.createElement("div");v.className="maplibregl-mobile-message",v.textContent=p,this._container.appendChild(v),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(x.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(l){return l[this._bypassKey]}notifyGestureBlocked(l,A){this._enabled&&(this._map.fire(new o.k("cooperativegestureprevented",{gestureType:l,originalEvent:A})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Mo=m=>m.zoom||m.drag||m.pitch||m.rotate;class Je extends o.k{}function ia(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class io{constructor(l,A){this.handleWindowEvent=y=>{this.handleEvent(y,`${y.type}Window`)},this.handleEvent=(y,v)=>{if(y.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const S=y.type==="renderFrame"?void 0:y,I={needsRenderFrame:!1},M={},D={},H=y.touches,z=H?this._getMapTouches(H):void 0,$=z?x.touchPos(this._map.getCanvas(),z):x.mousePos(this._map.getCanvas(),y);for(const{handlerName:tt,handler:At,allowed:pt}of this._handlers){if(!At.isEnabled())continue;let _t;this._blockedByActive(D,pt,tt)?At.reset():At[v||y.type]&&(_t=At[v||y.type](y,$,z),this.mergeHandlerResult(I,M,_t,tt,S),_t&&_t.needsRenderFrame&&this._triggerRenderFrame()),(_t||At.isActive())&&(D[tt]=At)}const J={};for(const tt in this._previousActiveHandlers)D[tt]||(J[tt]=S);this._previousActiveHandlers=D,(Object.keys(J).length||ia(I))&&(this._changes.push([I,M,J]),this._triggerRenderFrame()),(Object.keys(D).length||ia(I))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:K}=I;K&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],K(this._map))},this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new wi(l),this._bearingSnap=A.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(A);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[y,v,S]of this._listeners)x.addEventListener(y,v,y===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[l,A,p]of this._listeners)x.removeEventListener(l,A,l===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(l){const A=this._map,p=A.getCanvasContainer();this._add("mapEvent",new Id(A,l));const y=A.boxZoom=new Vs(A,l);this._add("boxZoom",y),l.interactive&&l.boxZoom&&y.enable();const v=A.cooperativeGestures=new _u(A,l.cooperativeGestures);this._add("cooperativeGestures",v),l.cooperativeGestures&&v.enable();const S=new Hi(A),I=new yA(A);A.doubleClickZoom=new nl(I,S),this._add("tapZoom",S),this._add("clickZoom",I),l.interactive&&l.doubleClickZoom&&A.doubleClickZoom.enable();const M=new jm;this._add("tapDragZoom",M);const D=A.touchPitch=new yu(A);this._add("touchPitch",D),l.interactive&&l.touchPitch&&A.touchPitch.enable(l.touchPitch);const H=pu(l),z=pA(l);A.dragRotate=new Md(l,H,z),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]),l.interactive&&l.dragRotate&&A.dragRotate.enable();const $=(_t=>{let{enable:mt,clickTolerance:Et}=_t;const Dt=new Cc({checkCorrectEvent:Rt=>x.mouseButton(Rt)===0&&!Rt.ctrlKey});return new Ti({clickTolerance:Et,move:(Rt,oe)=>({around:oe,panDelta:oe.sub(Rt)}),activateOnStart:!0,moveStateManager:Dt,enable:mt,assignEvents:Ec})})(l),J=new Ul(l,A);A.dragPan=new bp(p,$,J),this._add("mousePan",$),this._add("touchPan",J,["touchZoom","touchRotate"]),l.interactive&&l.dragPan&&A.dragPan.enable(l.dragPan);const K=new Ld,tt=new gA;A.touchZoomRotate=new Rd(p,tt,K,M),this._add("touchRotate",K,["touchPan","touchZoom"]),this._add("touchZoom",tt,["touchPan","touchRotate"]),l.interactive&&l.touchZoomRotate&&A.touchZoomRotate.enable(l.touchZoomRotate);const At=A.scrollZoom=new no(A,()=>this._triggerRenderFrame());this._add("scrollZoom",At,["mousePan"]),l.interactive&&l.scrollZoom&&A.scrollZoom.enable(l.scrollZoom);const pt=A.keyboard=new Po(A);this._add("keyboard",pt),l.interactive&&l.keyboard&&A.keyboard.enable(),this._add("blockableMapEvent",new Ai(A))}_add(l,A,p){this._handlers.push({handlerName:l,handler:A,allowed:p}),this._handlersById[l]=A}stop(l){if(!this._updatingCamera){for(const{handler:A}of this._handlers)A.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Mo(this._eventsInProgress)||this.isZooming()}_blockedByActive(l,A,p){for(const y in l)if(y!==p&&(!A||A.indexOf(y)<0))return!0;return!1}_getMapTouches(l){const A=[];for(const p of l)this._el.contains(p.target)&&A.push(p);return A}mergeHandlerResult(l,A,p,y,v){if(!p)return;o.e(l,p);const S={handlerName:y,originalEvent:p.originalEvent||v};p.zoomDelta!==void 0&&(A.zoom=S),p.panDelta!==void 0&&(A.drag=S),p.pitchDelta!==void 0&&(A.pitch=S),p.bearingDelta!==void 0&&(A.rotate=S)}_applyChanges(){const l={},A={},p={};for(const[y,v,S]of this._changes)y.panDelta&&(l.panDelta=(l.panDelta||new o.P(0,0))._add(y.panDelta)),y.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(l.around=y.around),y.pinchAround!==void 0&&(l.pinchAround=y.pinchAround),y.noInertia&&(l.noInertia=y.noInertia),o.e(A,v),o.e(p,S);this._updateMapTransform(l,A,p),this._changes=[]}_updateMapTransform(l,A,p){const y=this._map,v=y._getTransformForUpdate(),S=y.terrain;if(!(ia(l)||S&&this._terrainMovement))return this._fireEvents(A,p,!0);let{panDelta:I,zoomDelta:M,bearingDelta:D,pitchDelta:H,around:z,pinchAround:$}=l;$!==void 0&&(z=$),y._stop(!0),z=z||y.transform.centerPoint;const J=v.pointLocation(I?z.sub(I):z);D&&(v.bearing+=D),H&&(v.pitch+=H),M&&(v.zoom+=M),S?this._terrainMovement||!A.drag&&!A.zoom?A.drag&&this._terrainMovement?v.center=v.pointLocation(v.centerPoint.sub(I)):v.setLocationAtPoint(J,z):(this._terrainMovement=!0,this._map._elevationFreeze=!0,v.setLocationAtPoint(J,z)):v.setLocationAtPoint(J,z),y._applyUpdatedTransform(v),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(A,p,!0)}_fireEvents(l,A,p){const y=Mo(this._eventsInProgress),v=Mo(l),S={};for(const z in l){const{originalEvent:$}=l[z];this._eventsInProgress[z]||(S[`${z}start`]=$),this._eventsInProgress[z]=l[z]}!y&&v&&this._fireEvent("movestart",v.originalEvent);for(const z in S)this._fireEvent(z,S[z]);v&&this._fireEvent("move",v.originalEvent);for(const z in l){const{originalEvent:$}=l[z];this._fireEvent(z,$)}const I={};let M;for(const z in this._eventsInProgress){const{handlerName:$,originalEvent:J}=this._eventsInProgress[z];this._handlersById[$].isActive()||(delete this._eventsInProgress[z],M=A[$]||J,I[`${z}end`]=M)}for(const z in I)this._fireEvent(z,I[z]);const D=Mo(this._eventsInProgress),H=(y||v)&&!D;if(H&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const z=this._map._getTransformForUpdate();z.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(z)}if(p&&H){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),$=J=>J!==0&&-this._bearingSnap<J&&J<this._bearingSnap;!z||!z.essential&&w.prefersReducedMotion?(this._map.fire(new o.k("moveend",{originalEvent:M})),$(this._map.getBearing())&&this._map.resetNorth()):($(z.bearing||this._map.getBearing())&&(z.bearing=0),z.freezeElevation=!0,this._map.easeTo(z,{originalEvent:M})),this._updatingCamera=!1}}_fireEvent(l,A){this._map.fire(new o.k(l,A?{originalEvent:A}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{delete this._frameId,this.handleEvent(new Je("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Ta extends o.E{constructor(l,A){super(),this._renderFrameCallback=()=>{const p=Math.min((w.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=A.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new o.N(this.transform.center.lng,this.transform.center.lat)}setCenter(l,A){return this.jumpTo({center:l},A)}panBy(l,A,p){return l=o.P.convert(l).mult(-1),this.panTo(this.transform.center,o.e({offset:l},A),p)}panTo(l,A,p){return this.easeTo(o.e({center:l},A),p)}getZoom(){return this.transform.zoom}setZoom(l,A){return this.jumpTo({zoom:l},A),this}zoomTo(l,A,p){return this.easeTo(o.e({zoom:l},A),p)}zoomIn(l,A){return this.zoomTo(this.getZoom()+1,l,A),this}zoomOut(l,A){return this.zoomTo(this.getZoom()-1,l,A),this}getBearing(){return this.transform.bearing}setBearing(l,A){return this.jumpTo({bearing:l},A),this}getPadding(){return this.transform.padding}setPadding(l,A){return this.jumpTo({padding:l},A),this}rotateTo(l,A,p){return this.easeTo(o.e({bearing:l},A),p)}resetNorth(l,A){return this.rotateTo(0,o.e({duration:1e3},l),A),this}resetNorthPitch(l,A){return this.easeTo(o.e({bearing:0,pitch:0,duration:1e3},l),A),this}snapToNorth(l,A){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,A):this}getPitch(){return this.transform.pitch}setPitch(l,A){return this.jumpTo({pitch:l},A),this}cameraForBounds(l,A){l=st.convert(l).adjustAntiMeridian();const p=A&&A.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),p,A)}_cameraForBoxAndBearing(l,A,p,y){const v={top:0,bottom:0,right:0,left:0};if(typeof(y=o.e({padding:v,offset:[0,0],maxZoom:this.transform.maxZoom},y)).padding=="number"){const xe=y.padding;y.padding={top:xe,bottom:xe,right:xe,left:xe}}y.padding=o.e(v,y.padding);const S=this.transform,I=S.padding,M=new st(l,A),D=S.project(M.getNorthWest()),H=S.project(M.getNorthEast()),z=S.project(M.getSouthEast()),$=S.project(M.getSouthWest()),J=o.ba(-p),K=D.rotate(J),tt=H.rotate(J),At=z.rotate(J),pt=$.rotate(J),_t=new o.P(Math.max(K.x,tt.x,pt.x,At.x),Math.max(K.y,tt.y,pt.y,At.y)),mt=new o.P(Math.min(K.x,tt.x,pt.x,At.x),Math.min(K.y,tt.y,pt.y,At.y)),Et=_t.sub(mt),Dt=(S.width-(I.left+I.right+y.padding.left+y.padding.right))/Et.x,Rt=(S.height-(I.top+I.bottom+y.padding.top+y.padding.bottom))/Et.y;if(Rt<0||Dt<0)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const oe=Math.min(S.scaleZoom(S.scale*Math.min(Dt,Rt)),y.maxZoom),ge=o.P.convert(y.offset),_e=new o.P((y.padding.left-y.padding.right)/2,(y.padding.top-y.padding.bottom)/2).rotate(o.ba(p)),Ce=ge.add(_e).mult(S.scale/S.zoomScale(oe));return{center:S.unproject(D.add(z).div(2).sub(Ce)),zoom:oe,bearing:p}}fitBounds(l,A,p){return this._fitInternal(this.cameraForBounds(l,A),A,p)}fitScreenCoordinates(l,A,p,y,v){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.P.convert(l)),this.transform.pointLocation(o.P.convert(A)),p,y),y,v)}_fitInternal(l,A,p){return l?(delete(A=o.e(l,A)).padding,A.linear?this.easeTo(A,p):this.flyTo(A,p)):this}jumpTo(l,A){this.stop();const p=this._getTransformForUpdate();let y=!1,v=!1,S=!1;return"zoom"in l&&p.zoom!==+l.zoom&&(y=!0,p.zoom=+l.zoom),l.center!==void 0&&(p.center=o.N.convert(l.center)),"bearing"in l&&p.bearing!==+l.bearing&&(v=!0,p.bearing=+l.bearing),"pitch"in l&&p.pitch!==+l.pitch&&(S=!0,p.pitch=+l.pitch),l.padding==null||p.isPaddingEqual(l.padding)||(p.padding=l.padding),this._applyUpdatedTransform(p),this.fire(new o.k("movestart",A)).fire(new o.k("move",A)),y&&this.fire(new o.k("zoomstart",A)).fire(new o.k("zoom",A)).fire(new o.k("zoomend",A)),v&&this.fire(new o.k("rotatestart",A)).fire(new o.k("rotate",A)).fire(new o.k("rotateend",A)),S&&this.fire(new o.k("pitchstart",A)).fire(new o.k("pitch",A)).fire(new o.k("pitchend",A)),this.fire(new o.k("moveend",A))}calculateCameraOptionsFromTo(l,A,p){let y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const v=o.Z.fromLngLat(l,A),S=o.Z.fromLngLat(p,y),I=S.x-v.x,M=S.y-v.y,D=S.z-v.z,H=Math.hypot(I,M,D);if(H===0)throw new Error("Can't calculate camera options with same From and To");const z=Math.hypot(I,M),$=this.transform.scaleZoom(this.transform.cameraToCenterDistance/H/this.transform.tileSize),J=180*Math.atan2(I,-M)/Math.PI;let K=180*Math.acos(z/H)/Math.PI;return K=D<0?90-K:90+K,{center:S.toLngLat(),zoom:$,pitch:K,bearing:J}}easeTo(l,A){var p;this._stop(!1,l.easeId),((l=o.e({offset:[0,0],duration:500,easing:o.b9},l)).animate===!1||!l.essential&&w.prefersReducedMotion)&&(l.duration=0);const y=this._getTransformForUpdate(),v=y.zoom,S=y.bearing,I=y.pitch,M=y.padding,D="bearing"in l?this._normalizeBearing(l.bearing,S):S,H="pitch"in l?+l.pitch:I,z="padding"in l?l.padding:y.padding,$=o.P.convert(l.offset);let J=y.centerPoint.add($);const K=y.pointLocation(J),{center:tt,zoom:At}=y.getConstrained(o.N.convert(l.center||K),(p=l.zoom)!==null&&p!==void 0?p:v);this._normalizeCenter(tt,y);const pt=y.project(K),_t=y.project(tt).sub(pt),mt=y.zoomScale(At-v);let Et,Dt;l.around&&(Et=o.N.convert(l.around),Dt=y.locationPoint(Et));const Rt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||At!==v,this._rotating=this._rotating||S!==D,this._pitching=this._pitching||H!==I,this._padding=!y.isPaddingEqual(z),this._easeId=l.easeId,this._prepareEase(A,l.noMoveStart,Rt),this.terrain&&this._prepareElevation(tt),this._ease(oe=>{if(this._zooming&&(y.zoom=o.y.number(v,At,oe)),this._rotating&&(y.bearing=o.y.number(S,D,oe)),this._pitching&&(y.pitch=o.y.number(I,H,oe)),this._padding&&(y.interpolatePadding(M,z,oe),J=y.centerPoint.add($)),this.terrain&&!l.freezeElevation&&this._updateElevation(oe),Et)y.setLocationAtPoint(Et,Dt);else{const ge=y.zoomScale(y.zoom-v),_e=At>v?Math.min(2,mt):Math.max(.5,mt),Ce=Math.pow(_e,1-oe),xe=y.unproject(pt.add(_t.mult(oe*Ce)).mult(ge));y.setLocationAtPoint(y.renderWorldCopies?xe.wrap():xe,J)}this._applyUpdatedTransform(y),this._fireMoveEvents(A)},oe=>{this.terrain&&l.freezeElevation&&this._finalizeElevation(),this._afterEase(A,oe)},l),this}_prepareEase(l,A){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this._moving=!0,A||p.moving||this.fire(new o.k("movestart",l)),this._zooming&&!p.zooming&&this.fire(new o.k("zoomstart",l)),this._rotating&&!p.rotating&&this.fire(new o.k("rotatestart",l)),this._pitching&&!p.pitching&&this.fire(new o.k("pitchstart",l))}_prepareElevation(l){this._elevationCenter=l,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(l){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const A=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(l<1&&A!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=l*(p-(A-(p*l+this._elevationStart))/(1-l)),this._elevationTarget=A}this.transform.elevation=o.y.number(this._elevationStart,this._elevationTarget,l)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(l){const A=l.getCameraPosition(),p=this.terrain.getElevationForLngLatZoom(A.lngLat,l.zoom);if(A.altitude<p){const y=this.calculateCameraOptionsFromTo(A.lngLat,p,l.center,l.elevation);return{pitch:y.pitch,zoom:y.zoom}}return{}}_applyUpdatedTransform(l){const A=[];if(this.terrain&&A.push(y=>this._elevateCameraIfInsideTerrain(y)),this.transformCameraUpdate&&A.push(y=>this.transformCameraUpdate(y)),!A.length)return;const p=l.clone();for(const y of A){const v=p.clone(),{center:S,zoom:I,pitch:M,bearing:D,elevation:H}=y(v);S&&(v.center=S),I!==void 0&&(v.zoom=I),M!==void 0&&(v.pitch=M),D!==void 0&&(v.bearing=D),H!==void 0&&(v.elevation=H),p.apply(v)}this.transform.apply(p)}_fireMoveEvents(l){this.fire(new o.k("move",l)),this._zooming&&this.fire(new o.k("zoom",l)),this._rotating&&this.fire(new o.k("rotate",l)),this._pitching&&this.fire(new o.k("pitch",l))}_afterEase(l,A){if(this._easeId&&A&&this._easeId===A)return;delete this._easeId;const p=this._zooming,y=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new o.k("zoomend",l)),y&&this.fire(new o.k("rotateend",l)),v&&this.fire(new o.k("pitchend",l)),this.fire(new o.k("moveend",l))}flyTo(l,A){var p;if(!l.essential&&w.prefersReducedMotion){const Me=o.M(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Me,A)}this.stop(),l=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.b9},l);const y=this._getTransformForUpdate(),v=y.zoom,S=y.bearing,I=y.pitch,M=y.padding,D="bearing"in l?this._normalizeBearing(l.bearing,S):S,H="pitch"in l?+l.pitch:I,z="padding"in l?l.padding:y.padding,$=o.P.convert(l.offset);let J=y.centerPoint.add($);const K=y.pointLocation(J),{center:tt,zoom:At}=y.getConstrained(o.N.convert(l.center||K),(p=l.zoom)!==null&&p!==void 0?p:v);this._normalizeCenter(tt,y);const pt=y.zoomScale(At-v),_t=y.project(K),mt=y.project(tt).sub(_t);let Et=l.curve;const Dt=Math.max(y.width,y.height),Rt=Dt/pt,oe=mt.mag();if("minZoom"in l){const Me=o.ac(Math.min(l.minZoom,v,At),y.minZoom,y.maxZoom),dr=Dt/y.zoomScale(Me-v);Et=Math.sqrt(dr/oe*2)}const ge=Et*Et;function _e(Me){const dr=(Rt*Rt-Dt*Dt+(Me?-1:1)*ge*ge*oe*oe)/(2*(Me?Rt:Dt)*ge*oe);return Math.log(Math.sqrt(dr*dr+1)-dr)}function Ce(Me){return(Math.exp(Me)-Math.exp(-Me))/2}function xe(Me){return(Math.exp(Me)+Math.exp(-Me))/2}const ve=_e(!1);let Se=function(Me){return xe(ve)/xe(ve+Et*Me)},sr=function(Me){return Dt*((xe(ve)*(Ce(dr=ve+Et*Me)/xe(dr))-Ce(ve))/ge)/oe;var dr},Pe=(_e(!0)-ve)/Et;if(Math.abs(oe)<1e-6||!isFinite(Pe)){if(Math.abs(Dt-Rt)<1e-6)return this.easeTo(l,A);const Me=Rt<Dt?-1:1;Pe=Math.abs(Math.log(Rt/Dt))/Et,sr=()=>0,Se=dr=>Math.exp(Me*Et*dr)}return l.duration="duration"in l?+l.duration:1e3*Pe/("screenSpeed"in l?+l.screenSpeed/Et:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=S!==D,this._pitching=H!==I,this._padding=!y.isPaddingEqual(z),this._prepareEase(A,!1),this.terrain&&this._prepareElevation(tt),this._ease(Me=>{const dr=Me*Pe,Pr=1/Se(dr);y.zoom=Me===1?At:v+y.scaleZoom(Pr),this._rotating&&(y.bearing=o.y.number(S,D,Me)),this._pitching&&(y.pitch=o.y.number(I,H,Me)),this._padding&&(y.interpolatePadding(M,z,Me),J=y.centerPoint.add($)),this.terrain&&!l.freezeElevation&&this._updateElevation(Me);const Ir=Me===1?tt:y.unproject(_t.add(mt.mult(sr(dr))).mult(Pr));y.setLocationAtPoint(y.renderWorldCopies?Ir.wrap():Ir,J),this._applyUpdatedTransform(y),this._fireMoveEvents(A)},()=>{this.terrain&&l.freezeElevation&&this._finalizeElevation(),this._afterEase(A)},l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,A){var p;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,A)}return l||(p=this.handlers)===null||p===void 0||p.stop(!1),this}_ease(l,A,p){p.animate===!1||p.duration===0?(l(1),A()):(this._easeStart=w.now(),this._easeOptions=p,this._onEaseFrame=l,this._onEaseEnd=A,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(l,A){l=o.b3(l,-180,180);const p=Math.abs(l-A);return Math.abs(l-360-A)<p&&(l-=360),Math.abs(l+360-A)<p&&(l+=360),l}_normalizeCenter(l,A){if(!A.renderWorldCopies||A.lngRange)return;const p=l.lng-A.center.lng;l.lng+=p>180?-360:p<-180?360:0}queryTerrainElevation(l){return this.terrain?this.terrain.getElevationForLngLatZoom(o.N.convert(l),this.transform.tileZoom)-this.transform.elevation:null}}const vu={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Tc{constructor(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vu;this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=A=>{!A||A.sourceDataType!=="metadata"&&A.sourceDataType!=="visibility"&&A.dataType!=="style"&&A.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=l}getDefaultPosition(){return"bottom-right"}onAdd(l){return this._map=l,this._compact=this.options.compact,this._container=x.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=x.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=x.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){x.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(l,A){const p=this._map._getUIString(`AttributionControl.${A}`);l.title=p,l.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(y=>typeof y!="string"?"":y)):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const A=this._map.style.sourceCaches;for(const y in A){const v=A[y];if(v.used||v.usedForTerrain){const S=v.getSource();S.attribution&&l.indexOf(S.attribution)<0&&l.push(S.attribution)}}l=l.filter(y=>String(y).trim()),l.sort((y,v)=>y.length-v.length),l=l.filter((y,v)=>{for(let S=v+1;S<l.length;S++)if(l[S].indexOf(y)>=0)return!1;return!0});const p=l.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,l.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Ia{constructor(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._updateCompact=()=>{const A=this._container.children;if(A.length){const p=A[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=l}getDefaultPosition(){return"bottom-left"}onAdd(l){this._map=l,this._compact=this.options&&this.options.compact,this._container=x.create("div","maplibregl-ctrl");const A=x.create("a","maplibregl-ctrl-logo");return A.target="_blank",A.rel="noopener nofollow",A.href="https://maplibre.org/",A.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),A.setAttribute("rel","noopener nofollow"),this._container.appendChild(A),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){x.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class kr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const A=++this._id;return this._queue.push({callback:l,id:A,cancelled:!1}),A}remove(l){const A=this._currentlyRunning,p=A?this._queue.concat(A):this._queue;for(const y of p)if(y.id===l)return void(y.cancelled=!0)}run(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const A=this._currentlyRunning=this._queue;this._queue=[];for(const p of A)if(!p.cancelled&&(p.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Ud=o.Y([{name:"a_pos3d",type:"Int16",components:3}]);class qm extends o.E{constructor(l){super(),this.sourceCache=l,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,l.usedForTerrain=!0,l.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(l,A){this.sourceCache.update(l,A),this._renderableTilesKeys=[];const p={};for(const y of l.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:A}))p[y.key]=!0,this._renderableTilesKeys.push(y.key),this._tiles[y.key]||(y.posMatrix=new Float64Array(16),o.aP(y.posMatrix,0,o.X,0,o.X,0,1),this._tiles[y.key]=new gn(y,this.tileSize));for(const y in this._tiles)p[y]||delete this._tiles[y]}freeRtt(l){for(const A in this._tiles){const p=this._tiles[A];(!l||p.tileID.equals(l)||p.tileID.isChildOf(l)||l.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(l=>this.getTileByID(l))}getTileByID(l){return this._tiles[l]}getTerrainCoords(l){const A={};for(const p of this._renderableTilesKeys){const y=this._tiles[p].tileID;if(y.canonical.equals(l.canonical)){const v=l.clone();v.posMatrix=new Float64Array(16),o.aP(v.posMatrix,0,o.X,0,o.X,0,1),A[p]=v}else if(y.canonical.isChildOf(l.canonical)){const v=l.clone();v.posMatrix=new Float64Array(16);const S=y.canonical.z-l.canonical.z,I=y.canonical.x-(y.canonical.x>>S<<S),M=y.canonical.y-(y.canonical.y>>S<<S),D=o.X>>S;o.aP(v.posMatrix,0,D,0,D,0,1),o.J(v.posMatrix,v.posMatrix,[-I*D,-M*D,0]),A[p]=v}else if(l.canonical.isChildOf(y.canonical)){const v=l.clone();v.posMatrix=new Float64Array(16);const S=l.canonical.z-y.canonical.z,I=l.canonical.x-(l.canonical.x>>S<<S),M=l.canonical.y-(l.canonical.y>>S<<S),D=o.X>>S;o.aP(v.posMatrix,0,o.X,0,o.X,0,1),o.J(v.posMatrix,v.posMatrix,[I*D,M*D,0]),o.K(v.posMatrix,v.posMatrix,[1/2**S,1/2**S,0]),A[p]=v}}return A}getSourceTile(l,A){const p=this.sourceCache._source;let y=l.overscaledZ-this.deltaZoom;if(y>p.maxzoom&&(y=p.maxzoom),y<p.minzoom)return null;this._sourceTileCache[l.key]||(this._sourceTileCache[l.key]=l.scaledTo(y).key);let v=this.sourceCache.getTileByID(this._sourceTileCache[l.key]);if((!v||!v.dem)&&A)for(;y>=p.minzoom&&(!v||!v.dem);)v=this.sourceCache.getTileByID(l.scaledTo(y--).key);return v}tilesAfterTime(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Date.now();return Object.values(this._tiles).filter(A=>A.timeAdded>=l)}}class _h{constructor(l,A,p){this.painter=l,this.sourceCache=new qm(A),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(l,A,p){let y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:o.X;var v;if(!(A>=0&&A<y&&p>=0&&p<y))return 0;const S=this.getTerrainData(l),I=(v=S.tile)===null||v===void 0?void 0:v.dem;if(!I)return 0;const M=function(K,tt,At){var pt=tt[0],_t=tt[1];return K[0]=At[0]*pt+At[4]*_t+At[12],K[1]=At[1]*pt+At[5]*_t+At[13],K}([],[A/y*o.X,p/y*o.X],S.u_terrain_matrix),D=[M[0]*I.dim,M[1]*I.dim],H=Math.floor(D[0]),z=Math.floor(D[1]),$=D[0]-H,J=D[1]-z;return I.get(H,z)*(1-$)*(1-J)+I.get(H+1,z)*$*(1-J)+I.get(H,z+1)*(1-$)*J+I.get(H+1,z+1)*$*J}getElevationForLngLatZoom(l,A){if(!o.bb(A,l.wrap()))return 0;const{tileID:p,mercatorX:y,mercatorY:v}=this._getOverscaledTileIDFromLngLatZoom(l,A);return this.getElevation(p,y%o.X,v%o.X,o.X)}getElevation(l,A,p){let y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:o.X;return this.getDEMElevation(l,A,p,y)*this.exaggeration}getTerrainData(l){if(!this._emptyDemTexture){const y=this.painter.context,v=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ot(y,v,y.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ot(y,new o.R({width:1,height:1}),y.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.an([])}const A=this.sourceCache.getSourceTile(l,!0);if(A&&A.dem&&(!A.demTexture||A.needsTerrainPrepare)){const y=this.painter.context;A.demTexture=this.painter.getTileTexture(A.dem.stride),A.demTexture?A.demTexture.update(A.dem.getPixels(),{premultiply:!1}):A.demTexture=new ot(y,A.dem.getPixels(),y.gl.RGBA,{premultiply:!1}),A.demTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),A.needsTerrainPrepare=!1}const p=A&&A+A.tileID.key+l.key;if(p&&!this._demMatrixCache[p]){const y=this.sourceCache.sourceCache._source.maxzoom;let v=l.canonical.z-A.tileID.canonical.z;l.overscaledZ>l.canonical.z&&(l.canonical.z>=y?v=l.canonical.z-y:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=l.canonical.x-(l.canonical.x>>v<<v),I=l.canonical.y-(l.canonical.y>>v<<v),M=o.bc(new Float64Array(16),[1/(o.X<<v),1/(o.X<<v),0]);o.J(M,M,[S*o.X,I*o.X,0]),this._demMatrixCache[l.key]={matrix:M,coord:l}}return{u_depth:2,u_terrain:3,u_terrain_dim:A&&A.dem&&A.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[l.key].matrix:this._emptyDemMatrix,u_terrain_unpack:A&&A.dem&&A.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(A&&A.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:A}}getFramebuffer(l){const A=this.painter,p=A.width/devicePixelRatio,y=A.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===y||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ot(A.context,{width:p,height:y,data:null},A.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(A.context.gl.NEAREST,A.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ot(A.context,{width:p,height:y,data:null},A.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(A.context.gl.NEAREST,A.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=A.context.createFramebuffer(p,y,!0,!1),this._fbo.depthAttachment.set(A.context.createRenderbuffer(A.context.gl.DEPTH_COMPONENT16,p,y))),this._fbo.colorAttachment.set(l==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const l=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const A=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let v=0,S=0;v<this._coordsTextureSize;v++)for(let I=0;I<this._coordsTextureSize;I++,S+=4)A[S+0]=255&I,A[S+1]=255&v,A[S+2]=I>>8<<4|v>>8,A[S+3]=0;const p=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(A.buffer)),y=new ot(l,p,l.gl.RGBA,{premultiply:!1});return y.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._coordsTexture=y,y}pointCoordinate(l){this.painter.maybeDrawDepthAndCoords(!0);const A=new Uint8Array(4),p=this.painter.context,y=p.gl,v=Math.round(l.x*this.painter.pixelRatio/devicePixelRatio),S=Math.round(l.y*this.painter.pixelRatio/devicePixelRatio),I=Math.round(this.painter.height/devicePixelRatio);p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),y.readPixels(v,I-S-1,1,1,y.RGBA,y.UNSIGNED_BYTE,A),p.bindFramebuffer.set(null);const M=A[0]+(A[2]>>4<<8),D=A[1]+((15&A[2])<<8),H=this.coordsIndex[255-A[3]],z=H&&this.sourceCache.getTileByID(H);if(!z)return null;const $=this._coordsTextureSize,J=(1<<z.tileID.canonical.z)*$;return new o.Z((z.tileID.canonical.x*$+M)/J+z.tileID.wrap,(z.tileID.canonical.y*$+D)/J,this.getElevation(z.tileID,M,D,$))}depthAtPoint(l){const A=new Uint8Array(4),p=this.painter.context,y=p.gl;return p.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),y.readPixels(l.x,this.painter.height/devicePixelRatio-l.y-1,1,1,y.RGBA,y.UNSIGNED_BYTE,A),p.bindFramebuffer.set(null),(A[0]/16777216+A[1]/65536+A[2]/256+A[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const l=this.painter.context,A=new o.bd,p=new o.aY,y=this.meshSize,v=o.X/y,S=y*y;for(let z=0;z<=y;z++)for(let $=0;$<=y;$++)A.emplaceBack($*v,z*v,0);for(let z=0;z<S;z+=y+1)for(let $=0;$<y;$++)p.emplaceBack($+z,y+$+z+1,y+$+z+2),p.emplaceBack($+z,y+$+z+2,$+z+1);const I=A.length,M=I+2*(y+1);for(const z of[0,1])for(let $=0;$<=y;$++)for(const J of[0,1])A.emplaceBack($*v,z*o.X,J);for(let z=0;z<2*y;z+=2)p.emplaceBack(M+z,M+z+1,M+z+3),p.emplaceBack(M+z,M+z+3,M+z+2),p.emplaceBack(I+z,I+z+3,I+z+1),p.emplaceBack(I+z,I+z+2,I+z+3);const D=A.length,H=D+2*(y+1);for(const z of[0,1])for(let $=0;$<=y;$++)for(const J of[0,1])A.emplaceBack(z*o.X,$*v,J);for(let z=0;z<2*y;z+=2)p.emplaceBack(D+z,D+z+1,D+z+3),p.emplaceBack(D+z,D+z+3,D+z+2),p.emplaceBack(H+z,H+z+3,H+z+1),p.emplaceBack(H+z,H+z+2,H+z+3);return this._mesh=new Pl(l.createVertexBuffer(A,Ud.members),l.createIndexBuffer(p),o.a0.simpleSegment(0,0,A.length,p.length)),this._mesh}getMeshFrameDelta(l){return 2*Math.PI*o.be/Math.pow(2,l)/5}getMinTileElevationForLngLatZoom(l,A){var p;const{tileID:y}=this._getOverscaledTileIDFromLngLatZoom(l,A);return(p=this.getMinMaxElevation(y).minElevation)!==null&&p!==void 0?p:0}getMinMaxElevation(l){const A=this.getTerrainData(l).tile,p={minElevation:null,maxElevation:null};return A&&A.dem&&(p.minElevation=A.dem.min*this.exaggeration,p.maxElevation=A.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(l,A){const p=o.Z.fromLngLat(l.wrap()),y=(1<<A)*o.X,v=p.x*y,S=p.y*y,I=Math.floor(v/o.X),M=Math.floor(S/o.X);return{tileID:new o.S(A,0,A,I,M),mercatorX:v,mercatorY:S}}}class wp{constructor(l,A,p){this._context=l,this._size=A,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const l of this._objects)l.texture.destroy(),l.fbo.destroy()}_createObject(l){const A=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new ot(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),A.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),A.colorAttachment.set(p.texture),{id:l,fbo:A,texture:p,stamp:-1,inUse:!1}}getObjectForId(l){return this._objects[l]}useObject(l){l.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(A=>l.id!==A),this._recentlyUsed.push(l.id)}stampObject(l){l.stamp=++this._stamp}getOrCreateFreeObject(){for(const A of this._recentlyUsed)if(!this._objects[A].inUse)return this._objects[A];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const l=this._createObject(this._objects.length);return this._objects.push(l),l}freeObject(l){l.inUse=!1}freeAllObjects(){for(const l of this._objects)this.freeObject(l)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(l=>!l.inUse)===!1}}const Ic={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Od{constructor(l,A){this.painter=l,this.terrain=A,this.pool=new wp(l.context,30,A.sourceCache.tileSize*A.qualityFactor)}destruct(){this.pool.destruct()}getTexture(l){return this.pool.getObjectForId(l.rtt[this._stacks.length-1].id).texture}prepareForRender(l,A){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=l._order.filter(p=>!l._layers[p].isHidden(A)),this._coordsDescendingInv={};for(const p in l.sourceCaches){this._coordsDescendingInv[p]={};const y=l.sourceCaches[p].getVisibleCoordinates();for(const v of y){const S=this.terrain.sourceCache.getTerrainCoords(v);for(const I in S)this._coordsDescendingInv[p][I]||(this._coordsDescendingInv[p][I]=[]),this._coordsDescendingInv[p][I].push(S[I])}}this._coordsDescendingInvStr={};for(const p of l._order){const y=l._layers[p],v=y.source;if(Ic[y.type]&&!this._coordsDescendingInvStr[v]){this._coordsDescendingInvStr[v]={};for(const S in this._coordsDescendingInv[v])this._coordsDescendingInvStr[v][S]=this._coordsDescendingInv[v][S].map(I=>I.key).sort().join()}}for(const p of this._renderableTiles)for(const y in this._coordsDescendingInvStr){const v=this._coordsDescendingInvStr[y][p.tileID.key];v&&v!==p.rttCoords[y]&&(p.rtt=[])}}renderLayer(l){if(l.isHidden(this.painter.transform.zoom))return!1;const A=l.type,p=this.painter,y=this._renderableLayerIds[this._renderableLayerIds.length-1]===l.id;if(Ic[A]&&(this._prevType&&Ic[this._prevType]||this._stacks.push([]),this._prevType=A,this._stacks[this._stacks.length-1].push(l.id),!y))return!0;if(Ic[this._prevType]||Ic[A]&&y){this._prevType=A;const v=this._stacks.length-1,S=this._stacks[v]||[];for(const I of this._renderableTiles){if(this.pool.isFull()&&(xc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(I),I.rtt[v]){const D=this.pool.getObjectForId(I.rtt[v].id);if(D.stamp===I.rtt[v].stamp){this.pool.useObject(D);continue}}const M=this.pool.getOrCreateFreeObject();this.pool.useObject(M),this.pool.stampObject(M),I.rtt[v]={id:M.id,stamp:M.stamp},p.context.bindFramebuffer.set(M.fbo.framebuffer),p.context.clear({color:o.aM.transparent,stencil:0}),p.currentStencilSource=void 0;for(let D=0;D<S.length;D++){const H=p.style._layers[S[D]],z=H.source?this._coordsDescendingInv[H.source][I.tileID.key]:[I.tileID];p.context.viewport.set([0,0,M.fbo.width,M.fbo.height]),p._renderTileClippingMasks(H,z),p.renderLayer(p,p.style.sourceCaches[H.source],H,z),H.source&&(I.rttCoords[H.source]=this._coordsDescendingInvStr[H.source][I.tileID.key])}}return xc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Ic[A]}return!1}}const Dd={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},_A=d,vh={hash:!1,interactive:!0,bearingSnap:7,attributionControl:vu,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Fc=m=>{m.touchstart=m.dragStart,m.touchmoveWindow=m.dragMove,m.touchend=m.dragEnd},Nd={showCompass:!0,showZoom:!0,visualizePitch:!1};class xp{constructor(l,A){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.mousedown=S=>{this.startMouse(o.e({},S,{ctrlKey:!0,preventDefault:()=>S.preventDefault()}),x.mousePos(this.element,S)),x.addEventListener(window,"mousemove",this.mousemove),x.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=S=>{this.moveMouse(S,x.mousePos(this.element,S))},this.mouseup=S=>{this.mouseRotate.dragEnd(S),this.mousePitch&&this.mousePitch.dragEnd(S),this.offTemp()},this.touchstart=S=>{S.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=x.touchPos(this.element,S.targetTouches)[0],this.startTouch(S,this._startPos),x.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),x.addEventListener(window,"touchend",this.touchend))},this.touchmove=S=>{S.targetTouches.length!==1?this.reset():(this._lastPos=x.touchPos(this.element,S.targetTouches)[0],this.moveTouch(S,this._lastPos))},this.touchend=S=>{S.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const y=l.dragRotate._mouseRotate.getClickTolerance(),v=l.dragRotate._mousePitch.getClickTolerance();this.element=A,this.mouseRotate=pu({clickTolerance:y,enable:!0}),this.touchRotate=(S=>{let{enable:I,clickTolerance:M,bearingDegreesPerPixelMoved:D=.8}=S;const H=new yh;return new Ti({clickTolerance:M,move:(z,$)=>({bearingDelta:($.x-z.x)*D}),moveStateManager:H,enable:I,assignEvents:Fc})})({clickTolerance:y,enable:!0}),this.map=l,p&&(this.mousePitch=pA({clickTolerance:v,enable:!0}),this.touchPitch=(S=>{let{enable:I,clickTolerance:M,pitchDegreesPerPixelMoved:D=-.5}=S;const H=new yh;return new Ti({clickTolerance:M,move:(z,$)=>({pitchDelta:($.y-z.y)*D}),moveStateManager:H,enable:I,assignEvents:Fc})})({clickTolerance:v,enable:!0})),x.addEventListener(A,"mousedown",this.mousedown),x.addEventListener(A,"touchstart",this.touchstart,{passive:!1}),x.addEventListener(A,"touchcancel",this.reset)}startMouse(l,A){this.mouseRotate.dragStart(l,A),this.mousePitch&&this.mousePitch.dragStart(l,A),x.disableDrag()}startTouch(l,A){this.touchRotate.dragStart(l,A),this.touchPitch&&this.touchPitch.dragStart(l,A),x.disableDrag()}moveMouse(l,A){const p=this.map,{bearingDelta:y}=this.mouseRotate.dragMove(l,A)||{};if(y&&p.setBearing(p.getBearing()+y),this.mousePitch){const{pitchDelta:v}=this.mousePitch.dragMove(l,A)||{};v&&p.setPitch(p.getPitch()+v)}}moveTouch(l,A){const p=this.map,{bearingDelta:y}=this.touchRotate.dragMove(l,A)||{};if(y&&p.setBearing(p.getBearing()+y),this.touchPitch){const{pitchDelta:v}=this.touchPitch.dragMove(l,A)||{};v&&p.setPitch(p.getPitch()+v)}}off(){const l=this.element;x.removeEventListener(l,"mousedown",this.mousedown),x.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),x.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),x.removeEventListener(window,"touchend",this.touchend),x.removeEventListener(l,"touchcancel",this.reset),this.offTemp()}offTemp(){x.enableDrag(),x.removeEventListener(window,"mousemove",this.mousemove),x.removeEventListener(window,"mouseup",this.mouseup),x.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),x.removeEventListener(window,"touchend",this.touchend)}}let so;function zn(m,l,A){const p=new o.N(m.lng,m.lat);if(m=new o.N(m.lng,m.lat),l){const y=new o.N(m.lng-360,m.lat),v=new o.N(m.lng+360,m.lat),S=A.locationPoint(m).distSqr(l);A.locationPoint(y).distSqr(l)<S?m=y:A.locationPoint(v).distSqr(l)<S&&(m=v)}for(;Math.abs(m.lng-A.center.lng)>180;){const y=A.locationPoint(m);if(y.x>=0&&y.y>=0&&y.x<=A.width&&y.y<=A.height)break;m.lng>A.center.lng?m.lng-=360:m.lng+=360}return m.lng!==p.lng&&A.locationPoint(m).y>A.height/2-A.getHorizon()?m:p}const bu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function bh(m,l,A){const p=m.classList;for(const y in bu)p.remove(`maplibregl-${A}-anchor-${y}`);p.add(`maplibregl-${A}-anchor-${l}`)}class wh extends o.E{constructor(l){if(super(),this._onKeyPress=A=>{const p=A.code,y=A.charCode||A.keyCode;p!=="Space"&&p!=="Enter"&&y!==32&&y!==13||this.togglePopup()},this._onMapClick=A=>{const p=A.originalEvent.target,y=this._element;this._popup&&(p===y||y.contains(p))&&this.togglePopup()},this._update=A=>{var p;if(!this._map)return;const y=this._map.loaded()&&!this._map.isMoving();((A==null?void 0:A.type)==="terrain"||(A==null?void 0:A.type)==="render"&&!y)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?zn(this._lngLat,this._flatPos,this._map.transform):(p=this._lngLat)===null||p===void 0?void 0:p.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(v=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let S="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?S="rotateX(0deg)":this._pitchAlignment==="map"&&(S=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||A&&A.type!=="moveend"||(this._pos=this._pos.round()),x.setTransform(this._element,`${bu[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${S} ${v}`),w.frameAsync(new AbortController).then(()=>{this._updateOpacity(A&&A.type==="moveend")}).catch(()=>{})},this._onMove=A=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=A.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=A.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.k("dragstart"))),this.fire(new o.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.k("dragend")),this._state="inactive"},this._addDragHandler=A=>{this._element.contains(A.originalEvent.target)&&(A.preventDefault(),this._positionDelta=A.point.sub(this._pos).add(this._offset),this._pointerdownPos=A.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._subpixelPositioning=l&&l.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(l==null?void 0:l.opacity,l==null?void 0:l.opacityWhenCovered),l&&l.element)this._element=l.element,this._offset=o.P.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=x.create("div");const A=x.createNS("http://www.w3.org/2000/svg","svg"),p=41,y=27;A.setAttributeNS(null,"display","block"),A.setAttributeNS(null,"height",`${p}px`),A.setAttributeNS(null,"width",`${y}px`),A.setAttributeNS(null,"viewBox",`0 0 ${y} ${p}`);const v=x.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"stroke","none"),v.setAttributeNS(null,"stroke-width","1"),v.setAttributeNS(null,"fill","none"),v.setAttributeNS(null,"fill-rule","evenodd");const S=x.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const I=x.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"transform","translate(3.0, 29.0)"),I.setAttributeNS(null,"fill","#000000");const M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const pt of M){const _t=x.createNS("http://www.w3.org/2000/svg","ellipse");_t.setAttributeNS(null,"opacity","0.04"),_t.setAttributeNS(null,"cx","10.5"),_t.setAttributeNS(null,"cy","5.80029008"),_t.setAttributeNS(null,"rx",pt.rx),_t.setAttributeNS(null,"ry",pt.ry),I.appendChild(_t)}const D=x.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"fill",this._color);const H=x.createNS("http://www.w3.org/2000/svg","path");H.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),D.appendChild(H);const z=x.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"opacity","0.25"),z.setAttributeNS(null,"fill","#000000");const $=x.createNS("http://www.w3.org/2000/svg","path");$.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),z.appendChild($);const J=x.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(6.0, 7.0)"),J.setAttributeNS(null,"fill","#FFFFFF");const K=x.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"transform","translate(8.0, 8.0)");const tt=x.createNS("http://www.w3.org/2000/svg","circle");tt.setAttributeNS(null,"fill","#000000"),tt.setAttributeNS(null,"opacity","0.25"),tt.setAttributeNS(null,"cx","5.5"),tt.setAttributeNS(null,"cy","5.5"),tt.setAttributeNS(null,"r","5.4999962");const At=x.createNS("http://www.w3.org/2000/svg","circle");At.setAttributeNS(null,"fill","#FFFFFF"),At.setAttributeNS(null,"cx","5.5"),At.setAttributeNS(null,"cy","5.5"),At.setAttributeNS(null,"r","5.4999962"),K.appendChild(tt),K.appendChild(At),S.appendChild(I),S.appendChild(D),S.appendChild(z),S.appendChild(J),S.appendChild(K),A.appendChild(S),A.setAttributeNS(null,"height",p*this._scale+"px"),A.setAttributeNS(null,"width",y*this._scale+"px"),this._element.appendChild(A),this._offset=o.P.convert(l&&l.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",A=>{A.preventDefault()}),this._element.addEventListener("mousedown",A=>{A.preventDefault()}),bh(this._element,this._anchor,"marker"),l&&l.className)for(const A of l.className.split(" "))this._element.classList.add(A);this._popup=null}addTo(l){return this.remove(),this._map=l,this._element.setAttribute("aria-label",l._getUIString("Marker.Title")),l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),l.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),x.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=o.N.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const y=Math.abs(13.5)/Math.SQRT2;l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(l){return this._subpixelPositioning=l,this}getPopup(){return this._popup}togglePopup(){const l=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:l?(l.isOpen()?l.remove():(l.setLngLat(this._lngLat),l.addTo(this._map)),this):this}_updateOpacity(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;var A,p;if(!(!((A=this._map)===null||A===void 0)&&A.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(l)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const y=this._map,v=y.terrain.depthAtPoint(this._pos),S=y.terrain.getElevationForLngLatZoom(this._lngLat,y.transform.tileZoom);if(y.transform.lngLatToCameraDepth(this._lngLat,S)-v<.006)return void(this._element.style.opacity=this._opacity);const I=-this._offset.y/y.transform._pixelPerMeter,M=Math.sin(y.getPitch()*Math.PI/180)*I,D=y.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),H=y.transform.lngLatToCameraDepth(this._lngLat,S+M)-D>.006;!((p=this._popup)===null||p===void 0)&&p.isOpen()&&H&&this._popup.remove(),this._element.style.opacity=H?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(l){return this._offset=o.P.convert(l),this._update(),this}addClassName(l){this._element.classList.add(l)}removeClassName(l){this._element.classList.remove(l)}toggleClassName(l){return this._element.classList.toggle(l)}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(l,A){return l===void 0&&A===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),l!==void 0&&(this._opacity=l),A!==void 0&&(this._opacityWhenCovered=A),this._map&&this._updateOpacity(!0),this}}const Bp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let vA=0,bA=!1;const sa={maxWidth:100,unit:"metric"};function Ol(m,l,A){const p=A&&A.maxWidth||100,y=m._container.clientHeight/2,v=m.unproject([0,y]),S=m.unproject([p,y]),I=v.distanceTo(S);if(A&&A.unit==="imperial"){const M=3.2808*I;M>5280?ar(l,p,M/5280,m._getUIString("ScaleControl.Miles")):ar(l,p,M,m._getUIString("ScaleControl.Feet"))}else A&&A.unit==="nautical"?ar(l,p,I/1852,m._getUIString("ScaleControl.NauticalMiles")):I>=1e3?ar(l,p,I/1e3,m._getUIString("ScaleControl.Kilometers")):ar(l,p,I,m._getUIString("ScaleControl.Meters"))}function ar(m,l,A,p){const y=function(v){const S=Math.pow(10,`${Math.floor(v)}`.length-1);let I=v/S;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(M){const D=Math.pow(10,Math.ceil(-Math.log(M)/Math.LN10));return Math.round(M*D)/D}(I),S*I}(A);m.style.width=l*(y/A)+"px",m.innerHTML=`${y}&nbsp;${p}`}const Er={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},wA=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function E(m){if(m){if(typeof m=="number"){const l=Math.round(Math.abs(m)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,m),"top-left":new o.P(l,l),"top-right":new o.P(-l,l),bottom:new o.P(0,-m),"bottom-left":new o.P(l,-l),"bottom-right":new o.P(-l,-l),left:new o.P(m,0),right:new o.P(-m,0)}}if(m instanceof o.P||Array.isArray(m)){const l=o.P.convert(m);return{center:l,top:l,"top-left":l,"top-right":l,bottom:l,"bottom-left":l,"bottom-right":l,left:l,right:l}}return{center:o.P.convert(m.center||[0,0]),top:o.P.convert(m.top||[0,0]),"top-left":o.P.convert(m["top-left"]||[0,0]),"top-right":o.P.convert(m["top-right"]||[0,0]),bottom:o.P.convert(m.bottom||[0,0]),"bottom-left":o.P.convert(m["bottom-left"]||[0,0]),"bottom-right":o.P.convert(m["bottom-right"]||[0,0]),left:o.P.convert(m.left||[0,0]),right:o.P.convert(m.right||[0,0])}}return E(new o.P(0,0))}const L=d;a.AJAXError=o.bh,a.Evented=o.E,a.LngLat=o.N,a.MercatorCoordinate=o.Z,a.Point=o.P,a.addProtocol=o.bi,a.config=o.a,a.removeProtocol=o.bj,a.AttributionControl=Tc,a.BoxZoomHandler=Vs,a.CanvasSource=yr,a.CooperativeGesturesHandler=_u,a.DoubleClickZoomHandler=nl,a.DragPanHandler=bp,a.DragRotateHandler=Md,a.EdgeInsets=So,a.FullscreenControl=class extends o.E{constructor(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this._onFullscreenChange=()=>{var l;let A=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((l=A==null?void 0:A.shadowRoot)===null||l===void 0)&&l.fullscreenElement;)A=A.shadowRoot.fullscreenElement;A===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){x.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const m=this._fullscreenButton=x.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);x.create("span","maplibregl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.title=m}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},a.GeoJSONSource=Le,a.GeolocateControl=class extends o.E{constructor(m){super(),this._onSuccess=l=>{if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new o.k("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.k("geolocate",l)),this._finish()}},this._updateCamera=l=>{const A=new o.N(l.coords.longitude,l.coords.latitude),p=l.coords.accuracy,y=this._map.getBearing(),v=o.e({bearing:y},this.options.fitBoundsOptions),S=st.fromLngLat(A,p);this._map.fitBounds(S,v,{geolocateSource:!0})},this._updateMarker=l=>{if(l){const A=new o.N(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(A).addTo(this._map),this._userLocationDotMarker.setLngLat(A).addTo(this._map),this._accuracy=l.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=l=>{if(this._map){if(this.options.trackUserLocation)if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const A=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=A,this._geolocateButton.setAttribute("aria-label",A),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&bA)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.k("error",l)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=x.create("button","maplibregl-ctrl-geolocate",this._container),x.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=l=>{if(this._map){if(l===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const A=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=A,this._geolocateButton.setAttribute("aria-label",A)}else{const A=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=A,this._geolocateButton.setAttribute("aria-label",A)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=x.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new wh({element:this._dotElement}),this._circleElement=x.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new wh({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",A=>{A.geolocateSource||this._watchState!=="ACTIVE_LOCK"||A.originalEvent&&A.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.k("trackuserlocationend")),this.fire(new o.k("userlocationlostfocus")))})}},this.options=o.e({},Bp,m)}onAdd(m){return this._map=m,this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return o._(this,arguments,void 0,function(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return function*(){if(so!==void 0&&!l)return so;if(window.navigator.permissions===void 0)return so=!!window.navigator.geolocation,so;try{so=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{so=!!window.navigator.geolocation}return so}()})}().then(l=>this._finishSetupUI(l)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),x.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,vA=0,bA=!1}_isOutOfMapMaxBounds(m){const l=this._map.getMaxBounds(),A=m.coords;return l&&(A.longitude<l.getWest()||A.longitude>l.getEast()||A.latitude<l.getSouth()||A.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const m=this._map.getBounds(),l=m.getSouthEast(),A=m.getNorthEast(),p=l.distanceTo(A),y=Math.ceil(this._accuracy/(p/this._map._container.clientHeight)*2);this._circleElement.style.width=`${y}px`,this._circleElement.style.height=`${y}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":vA--,bA=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.k("trackuserlocationstart")),this.fire(new o.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),vA++,vA>1?(m={maximumAge:6e5,timeout:0},bA=!0):(m=this.options.positionOptions,bA=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},a.Hash=Rl,a.ImageSource=We,a.KeyboardHandler=Po,a.LngLatBounds=st,a.LogoControl=Ia,a.Map=class extends Ta{constructor(m){o.bf.mark(o.bg.create);const l=Object.assign(Object.assign({},vh),m);if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new To(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies),{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new kr,this._controls=[],this._mapId=o.a4(),this._contextLost=A=>{A.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.k("webglcontextlost",{originalEvent:A}))},this._contextRestored=A=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.k("webglcontextrestored",{originalEvent:A}))},this._onMapScroll=A=>{if(A.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=l.preserveDrawingBuffer===!0,this._antialias=l.antialias===!0,this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Dd),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this.transformCameraUpdate=l.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=W.addThrottleControl(()=>this.isMoving()),this._requestManager=new et(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let A=!1;const p=Io(y=>{this._trackResize&&!this._removed&&(this.resize(y),this.redraw())},50);this._resizeObserver=new ResizeObserver(y=>{A?p(y):A=!0}),this._resizeObserver.observe(this._container)}this.handlers=new io(this,l),this._hash=l.hash&&new Rl(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,o.e({},l.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new Tc(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new Ia,l.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",A=>{this._update(A.dataType==="style"),this.fire(new o.k(`${A.dataType}data`,A))}),this.on("dataloading",A=>{this.fire(new o.k(`${A.dataType}dataloading`,A))}),this.on("dataabort",A=>{this.fire(new o.k("sourcedataabort",A))})}_getMapId(){return this._mapId}addControl(m,l){if(l===void 0&&(l=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new o.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const A=m.onAdd(this);this._controls.push(m);const p=this._controlPositions[l];return l.indexOf("bottom")!==-1?p.insertBefore(A,p.firstChild):p.appendChild(A),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new o.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(m);return l>-1&&this._controls.splice(l,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}calculateCameraOptionsFromTo(m,l,A,p){return p==null&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(A,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(m,l,A,p)}resize(m){var l;const A=this._containerDimensions(),p=A[0],y=A[1],v=this._getClampedPixelRatio(p,y);if(this._resizeCanvas(p,y,v),this.painter.resize(p,y,v),this.painter.overLimit()){const I=this.painter.context.gl;this._maxCanvasSize=[I.drawingBufferWidth,I.drawingBufferHeight];const M=this._getClampedPixelRatio(p,y);this._resizeCanvas(p,y,M),this.painter.resize(p,y,M)}this.transform.resize(p,y),(l=this._requestedCameraState)===null||l===void 0||l.resize(p,y);const S=!this._moving;return S&&(this.stop(),this.fire(new o.k("movestart",m)).fire(new o.k("move",m))),this.fire(new o.k("resize",m)),S&&this.fire(new o.k("moveend",m)),this}_getClampedPixelRatio(m,l){const{0:A,1:p}=this._maxCanvasSize,y=this.getPixelRatio(),v=m*y,S=l*y;return Math.min(v>A?A/v:1,S>p?p/S:1)*y}getPixelRatio(){var m;return(m=this._overridePixelRatio)!==null&&m!==void 0?m:devicePixelRatio}setPixelRatio(m){this._overridePixelRatio=m,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(m){return this.transform.setMaxBounds(st.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this._update()}project(m){return this.transform.locationPoint(o.N.convert(m),this.style&&this.terrain)}unproject(m){return this.transform.pointLocation(o.P.convert(m),this.terrain)}isMoving(){var m;return this._moving||((m=this.handlers)===null||m===void 0?void 0:m.isMoving())}isZooming(){var m;return this._zooming||((m=this.handlers)===null||m===void 0?void 0:m.isZooming())}isRotating(){var m;return this._rotating||((m=this.handlers)===null||m===void 0?void 0:m.isRotating())}_createDelegatedListener(m,l,A){if(m==="mouseenter"||m==="mouseover"){let p=!1;return{layers:l,listener:A,delegates:{mousemove:v=>{const S=l.filter(M=>this.getLayer(M)),I=S.length!==0?this.queryRenderedFeatures(v.point,{layers:S}):[];I.length?p||(p=!0,A.call(this,new xi(m,this,v.originalEvent,{features:I}))):p=!1},mouseout:()=>{p=!1}}}}if(m==="mouseleave"||m==="mouseout"){let p=!1;return{layers:l,listener:A,delegates:{mousemove:S=>{const I=l.filter(M=>this.getLayer(M));(I.length!==0?this.queryRenderedFeatures(S.point,{layers:I}):[]).length?p=!0:p&&(p=!1,A.call(this,new xi(m,this,S.originalEvent)))},mouseout:S=>{p&&(p=!1,A.call(this,new xi(m,this,S.originalEvent)))}}}}{const p=y=>{const v=l.filter(I=>this.getLayer(I)),S=v.length!==0?this.queryRenderedFeatures(y.point,{layers:v}):[];S.length&&(y.features=S,A.call(this,y),delete y.features)};return{layers:l,listener:A,delegates:{[m]:p}}}}_saveDelegatedListener(m,l){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(l)}_removeDelegatedListener(m,l,A){if(!this._delegatedListeners||!this._delegatedListeners[m])return;const p=this._delegatedListeners[m];for(let y=0;y<p.length;y++){const v=p[y];if(v.listener===A&&v.layers.length===l.length&&v.layers.every(S=>l.includes(S))){for(const S in v.delegates)this.off(S,v.delegates[S]);return void p.splice(y,1)}}}on(m,l,A){if(A===void 0)return super.on(m,l);const p=this._createDelegatedListener(m,typeof l=="string"?[l]:l,A);this._saveDelegatedListener(m,p);for(const y in p.delegates)this.on(y,p.delegates[y]);return this}once(m,l,A){var p=this;if(A===void 0)return super.once(m,l);const y=typeof l=="string"?[l]:l,v=this._createDelegatedListener(m,y,A);for(const S in v.delegates){const I=v.delegates[S];v.delegates[S]=function(){p._removeDelegatedListener(m,y,A),I(...arguments)}}this._saveDelegatedListener(m,v);for(const S in v.delegates)this.once(S,v.delegates[S]);return this}off(m,l,A){return A===void 0?super.off(m,l):(this._removeDelegatedListener(m,typeof l=="string"?[l]:l,A),this)}queryRenderedFeatures(m,l){if(!this.style)return[];let A;const p=m instanceof o.P||Array.isArray(m),y=p?m:[[0,0],[this.transform.width,this.transform.height]];if(l=l||(p?{}:m)||{},y instanceof o.P||typeof y[0]=="number")A=[o.P.convert(y)];else{const v=o.P.convert(y[0]),S=o.P.convert(y[1]);A=[v,new o.P(S.x,v.y),S,new o.P(v.x,S.y),v]}return this.style.queryRenderedFeatures(A,l,this.transform)}querySourceFeatures(m,l){return this.style.querySourceFeatures(m,l)}setStyle(m,l){return(l=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._updateStyle(m,l))}setTransformRequest(m){return this._requestManager.setTransformRequest(m),this}_getUIString(m){const l=this._locale[m];if(l==null)throw new Error(`Missing UI string '${m}'`);return l}_updateStyle(m,l){if(l.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(m,l));const A=this.style&&l.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!m)),m?(this.style=new Mi(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m,l,A):this.style.loadJSON(m,l,A),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Mi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,l){if(typeof m=="string"){const A=this._requestManager.transformRequest(m,"Style");o.h(A,new AbortController).then(p=>{this._updateDiff(p.data,l)}).catch(p=>{p&&this.fire(new o.j(p))})}else typeof m=="object"&&this._updateDiff(m,l)}_updateDiff(m,l){try{this.style.setState(m,l)&&this._update(!0)}catch(A){o.w(`Unable to perform style diff: ${A.message||A.error||A}.  Rebuilding the style from scratch.`),this._updateStyle(m,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(m,l){return this._lazyInitEmptyStyle(),this.style.addSource(m,l),this._update(!0)}isSourceLoaded(m){const l=this.style&&this.style.sourceCaches[m];if(l!==void 0)return l.loaded();this.fire(new o.j(new Error(`There is no source with ID '${m}'`)))}setTerrain(m){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),m){const l=this.style.sourceCaches[m.source];if(!l)throw new Error(`cannot load terrain, because there exists no source with ID: ${m.source}`);this.terrain===null&&l.reload();for(const A in this.style._layers){const p=this.style._layers[A];p.type==="hillshade"&&p.source===m.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new _h(this.painter,l,m),this.painter.renderToTexture=new Od(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=A=>{A.dataType==="style"?this.terrain.sourceCache.freeRtt():A.dataType==="source"&&A.tile&&(A.sourceId!==m.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(A.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new o.k("terrain",{terrain:m})),this}getTerrain(){var m,l;return(l=(m=this.terrain)===null||m===void 0?void 0:m.options)!==null&&l!==void 0?l:null}areTilesLoaded(){const m=this.style&&this.style.sourceCaches;for(const l in m){const A=m[l]._tiles;for(const p in A){const y=A[p];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}removeSource(m){return this.style.removeSource(m),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,l){let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{pixelRatio:p=1,sdf:y=!1,stretchX:v,stretchY:S,content:I,textFitWidth:M,textFitHeight:D}=A;if(this._lazyInitEmptyStyle(),!(l instanceof HTMLImageElement||o.b(l))){if(l.width===void 0||l.height===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:H,height:z,data:$}=l,J=l;return this.style.addImage(m,{data:new o.R({width:H,height:z},new Uint8Array($)),pixelRatio:p,stretchX:v,stretchY:S,content:I,textFitWidth:M,textFitHeight:D,sdf:y,version:0,userImage:J}),J.onAdd&&J.onAdd(this,m),this}}{const{width:H,height:z,data:$}=w.getImageData(l);this.style.addImage(m,{data:new o.R({width:H,height:z},$),pixelRatio:p,stretchX:v,stretchY:S,content:I,textFitWidth:M,textFitHeight:D,sdf:y,version:0})}}updateImage(m,l){const A=this.style.getImage(m);if(!A)return this.fire(new o.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=l instanceof HTMLImageElement||o.b(l)?w.getImageData(l):l,{width:y,height:v,data:S}=p;if(y===void 0||v===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(y!==A.data.width||v!==A.data.height)return this.fire(new o.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const I=!(l instanceof HTMLImageElement||o.b(l));return A.data.replace(S,I),this.style.updateImage(m,A),this}getImage(m){return this.style.getImage(m)}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new o.j(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m){return W.getImage(this._requestManager.transformRequest(m,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(m,l){return this._lazyInitEmptyStyle(),this.style.addLayer(m,l),this._update(!0)}moveLayer(m,l){return this.style.moveLayer(m,l),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(m,l,A){return this.style.setLayerZoomRange(m,l,A),this._update(!0)}setFilter(m,l){let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.style.setFilter(m,l,A),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,l,A){let p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.style.setPaintProperty(m,l,A,p),this._update(!0)}getPaintProperty(m,l){return this.style.getPaintProperty(m,l)}setLayoutProperty(m,l,A){let p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.style.setLayoutProperty(m,l,A,p),this._update(!0)}getLayoutProperty(m,l){return this.style.getLayoutProperty(m,l)}setGlyphs(m){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setGlyphs(m,l),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(m,l){let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._lazyInitEmptyStyle(),this.style.addSprite(m,l,A,p=>{p||this._update(!0)}),this}removeSprite(m){return this._lazyInitEmptyStyle(),this.style.removeSprite(m),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(m){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setSprite(m,l,A=>{A||this._update(!0)}),this}setLight(m){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setLight(m,l),this._update(!0)}getLight(){return this.style.getLight()}setSky(m){return this._lazyInitEmptyStyle(),this.style.setSky(m),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(m,l){return this.style.setFeatureState(m,l),this._update()}removeFeatureState(m,l){return this.style.removeFeatureState(m,l),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let m=0,l=0;return this._container&&(m=this._container.clientWidth||400,l=this._container.clientHeight||300),[m,l]}_setupContainer(){const m=this._container;m.classList.add("maplibregl-map");const l=this._canvasContainer=x.create("div","maplibregl-canvas-container",m);this._interactive&&l.classList.add("maplibregl-interactive"),this._canvas=x.create("canvas","maplibregl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const A=this._containerDimensions(),p=this._getClampedPixelRatio(A[0],A[1]);this._resizeCanvas(A[0],A[1],p);const y=this._controlContainer=x.create("div","maplibregl-control-container",m),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{v[S]=x.create("div",`maplibregl-ctrl-${S} `,y)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,l,A){this._canvas.width=Math.floor(A*m),this._canvas.height=Math.floor(A*l),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${l}px`}_setupPainter(){const m={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let l=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{l={requestedAttributes:m},p&&(l.statusMessage=p.statusMessage,l.type=p.type)},{once:!0});const A=this._canvas.getContext("webgl2",m)||this._canvas.getContext("webgl",m);if(!A){const p="Failed to initialize WebGL";throw l?(l.message=p,new Error(JSON.stringify(l))):new Error(p)}this.painter=new ra(A,this.transform),B.testSupport(A)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_render(m){const l=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._removed)return;let A=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const y=this.transform.zoom,v=w.now();this.style.zoomHistory.update(y,v);const S=new o.z(y,{now:v,fadeDuration:l,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),I=S.crossFadingFactor();I===1&&I===this._crossFadingFactor||(A=!0,this._crossFadingFactor=I),this.style.update(S)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,l,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:l,showPadding:this.showPadding}),this.fire(new o.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.bf.mark(o.bg.load),this.fire(new o.k("load"))),this.style&&(this.style.hasTransitions()||A)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const p=this._sourcesDirty||this._styleDirty||this._placementDirty;return p||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.k("idle")),!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,o.bf.mark(o.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var m;this._hash&&this._hash.remove();for(const A of this._controls)A.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),W.removeThrottleControl(this._imageQueueHandle),(m=this._resizeObserver)===null||m===void 0||m.disconnect();const l=this.painter.context.gl.getExtension("WEBGL_lose_context");l!=null&&l.loseContext&&l.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),x.remove(this._canvasContainer),x.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),o.bf.clearMetrics(),this._removed=!0,this.fire(new o.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,w.frameAsync(this._frameRequest).then(m=>{o.bf.frame(m),this._frameRequest=null,this._render(m)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get version(){return _A}getCameraTargetElevation(){return this.transform.elevation}},a.MapMouseEvent=xi,a.MapTouchEvent=Ea,a.MapWheelEvent=Td,a.Marker=wh,a.NavigationControl=class{constructor(m){this._updateZoomButtons=()=>{const l=this._map.getZoom(),A=l===this._map.getMaxZoom(),p=l===this._map.getMinZoom();this._zoomInButton.disabled=A,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",A.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{const l=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=l},this._setButtonTitle=(l,A)=>{const p=this._map._getUIString(`NavigationControl.${A}`);l.title=p,l.setAttribute("aria-label",p)},this.options=o.e({},Nd,m),this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",l=>this._map.zoomIn({},{originalEvent:l})),x.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",l=>this._map.zoomOut({},{originalEvent:l})),x.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})}),this._compassIcon=x.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new xp(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){x.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(m,l){const A=x.create("button",m,this._container);return A.type="button",A.addEventListener("click",l),A}},a.Popup=class extends o.E{constructor(m){super(),this.remove=()=>(this._content&&x.remove(this._content),this._container&&(x.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.k("close"))),this),this._onMouseUp=l=>{this._update(l.point)},this._onMouseMove=l=>{this._update(l.point)},this._onDrag=l=>{this._update(l.point)},this._update=l=>{var A;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=x.create("div","maplibregl-popup",this._map.getContainer()),this._tip=x.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const I of this.options.className.split(" "))this._container.classList.add(I);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?zn(this._lngLat,this._flatPos,this._map.transform):(A=this._lngLat)===null||A===void 0?void 0:A.wrap(),this._trackPointer&&!l)return;const p=this._flatPos=this._pos=this._trackPointer&&l?l:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&l?l:this._map.transform.locationPoint(this._lngLat));let y=this.options.anchor;const v=E(this.options.offset);if(!y){const I=this._container.offsetWidth,M=this._container.offsetHeight;let D;D=p.y+v.bottom.y<M?["top"]:p.y>this._map.transform.height-M?["bottom"]:[],p.x<I/2?D.push("left"):p.x>this._map.transform.width-I/2&&D.push("right"),y=D.length===0?"bottom":D.join("-")}let S=p.add(v[y]);this.options.subpixelPositioning||(S=S.round()),x.setTransform(this._container,`${bu[y]} translate(${S.x}px,${S.y}px)`),bh(this._container,y,"popup")},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(Er),m)}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=o.N.convert(m),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const l=document.createDocumentFragment(),A=document.createElement("body");let p;for(A.innerHTML=m;p=A.firstChild,p;)l.appendChild(p);return this.setDOMContent(l)}getMaxWidth(){var m;return(m=this._container)===null||m===void 0?void 0:m.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=x.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(m){return this._container&&this._container.classList.add(m),this}removeClassName(m){return this._container&&this._container.classList.remove(m),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){if(this._container)return this._container.classList.toggle(m)}setSubpixelPositioning(m){this.options.subpixelPositioning=m}_createCloseButton(){this.options.closeButton&&(this._closeButton=x.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(wA);m&&m.focus()}},a.RasterDEMTileSource=ye,a.RasterTileSource=ue,a.ScaleControl=class{constructor(m){this._onMove=()=>{Ol(this._map,this._container,this.options)},this.setUnit=l=>{this.options.unit=l,Ol(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},sa),m)}getDefaultPosition(){return"bottom-left"}onAdd(m){return this._map=m,this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){x.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},a.ScrollZoomHandler=no,a.Style=Mi,a.TerrainControl=class{constructor(m){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=m}onAdd(m){return this._map=m,this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=x.create("button","maplibregl-ctrl-terrain",this._container),x.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){x.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},a.TwoFingersTouchPitchHandler=yu,a.TwoFingersTouchRotateHandler=Ld,a.TwoFingersTouchZoomHandler=gA,a.TwoFingersTouchZoomRotateHandler=Rd,a.VectorTileSource=Ye,a.VideoSource=cr,a.addSourceType=(m,l)=>o._(void 0,void 0,void 0,function*(){if(Ur(m))throw new Error(`A source type called "${m}" already exists.`);((A,p)=>{Fr[A]=p})(m,l)}),a.clearPrewarmedResources=function(){const m=Vt;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(Ft),Vt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},a.getRTLTextPluginStatus=function(){return De().getRTLTextPluginStatus()},a.getVersion=function(){return L},a.getWorkerCount=function(){return Ut.workerCount},a.getWorkerUrl=function(){return o.a.WORKER_URL},a.importScriptInWorkers=function(m){return Ie().broadcast("IS",m)},a.prewarm=function(){Zt().acquire(Ft)},a.setMaxParallelImageRequests=function(m){o.a.MAX_PARALLEL_IMAGE_REQUESTS=m},a.setRTLTextPlugin=function(m,l){return De().setRTLTextPlugin(m,l)},a.setWorkerCount=function(m){Ut.workerCount=m},a.setWorkerUrl=function(m){o.a.WORKER_URL=m}});var s=e;return s})})(LS);var PS=LS.exports;const Ps=Vp(PS);var Ms;(function(r){r[r.Unknown=0]="Unknown",r[r.Point=1]="Point",r[r.LineString=2]="LineString",r[r.Polygon=3]="Polygon",r[r.MultiPoint=4]="MultiPoint",r[r.MultiLineString=5]="MultiLineString",r[r.MultiPolygon=6]="MultiPolygon",r[r.GeometryCollection=7]="GeometryCollection",r[r.CircularString=8]="CircularString",r[r.CompoundCurve=9]="CompoundCurve",r[r.CurvePolygon=10]="CurvePolygon",r[r.MultiCurve=11]="MultiCurve",r[r.MultiSurface=12]="MultiSurface",r[r.Curve=13]="Curve",r[r.Surface=14]="Surface",r[r.PolyhedralSurface=15]="PolyhedralSurface",r[r.TIN=16]="TIN",r[r.Triangle=17]="Triangle"})(Ms||(Ms={}));const Gp=4,jp=4,qp=4,PA=new Int32Array(2),MS=new Float32Array(PA.buffer),RS=new Float64Array(PA.buffer),m0=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var vv;(function(r){r[r.UTF8_BYTES=1]="UTF8_BYTES",r[r.UTF16_STRING=2]="UTF16_STRING"})(vv||(vv={}));class Mu{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new Mu(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return PA[0]=this.readInt32(t),MS[0]}readFloat64(t){return PA[m0?0:1]=this.readInt32(t),PA[m0?1:0]=this.readInt32(t+4),RS[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,Number(BigInt.asIntN(32,e))),this.writeInt32(t+4,Number(BigInt.asIntN(32,e>>BigInt(32))))}writeUint64(t,e){this.writeUint32(t,Number(BigInt.asUintN(32,e))),this.writeUint32(t+4,Number(BigInt.asUintN(32,e>>BigInt(32))))}writeFloat32(t,e){MS[0]=e,this.writeInt32(t,PA[0])}writeFloat64(t,e){RS[0]=e,this.writeInt32(t,PA[m0?0:1]),this.writeInt32(t+4,PA[m0?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+Gp+jp)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<jp;e++)t+=String.fromCharCode(this.readInt8(this.position_+Gp+e));return t}__offset(t,e){const n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const n=this.readInt32(t);t+=Gp;const i=this.bytes_.subarray(t,t+n);return e===vv.UTF8_BYTES?i:this.text_decoder_.decode(i)}__union_with_string(t,e){return typeof t=="string"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+Gp}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=jp)throw new Error("FlatBuffers: file identifier must be length "+jp);for(let e=0;e<jp;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+Gp+e))return!1;return!0}createScalarList(t,e){const n=[];for(let i=0;i<e;++i){const s=t(i);s!==null&&n.push(s)}return n}createObjList(t,e){const n=[];for(let i=0;i<e;++i){const s=t(i);s!==null&&n.push(s.unpack())}return n}}let s8=class Ma{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsGeometry(t,e){return(e||new Ma).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsGeometry(t,e){return t.setPosition(t.position()+qp),(e||new Ma).__init(t.readInt32(t.position())+t.position(),t)}ends(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}endsLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}endsArray(){const t=this.bb.__offset(this.bb_pos,4);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}xy(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+t*8):0}xyLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}xyArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}z(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+t*8):0}zLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}zArray(){const t=this.bb.__offset(this.bb_pos,8);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}m(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+t*8):0}mLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}mArray(){const t=this.bb.__offset(this.bb_pos,10);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}t(t){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+t*8):0}tLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}tArray(){const t=this.bb.__offset(this.bb_pos,12);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}tm(t){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readUint64(this.bb.__vector(this.bb_pos+e)+t*8):BigInt(0)}tmLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}type(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readUint8(this.bb_pos+t):Ms.Unknown}parts(t,e){const n=this.bb.__offset(this.bb_pos,18);return n?(e||new Ma).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}partsLength(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}static startGeometry(t){t.startObject(8)}static addEnds(t,e){t.addFieldOffset(0,e,0)}static createEndsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addInt32(e[n]);return t.endVector()}static startEndsVector(t,e){t.startVector(4,e,4)}static addXy(t,e){t.addFieldOffset(1,e,0)}static createXyVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startXyVector(t,e){t.startVector(8,e,8)}static addZ(t,e){t.addFieldOffset(2,e,0)}static createZVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startZVector(t,e){t.startVector(8,e,8)}static addM(t,e){t.addFieldOffset(3,e,0)}static createMVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startMVector(t,e){t.startVector(8,e,8)}static addT(t,e){t.addFieldOffset(4,e,0)}static createTVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startTVector(t,e){t.startVector(8,e,8)}static addTm(t,e){t.addFieldOffset(5,e,0)}static createTmVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addInt64(e[n]);return t.endVector()}static startTmVector(t,e){t.startVector(8,e,8)}static addType(t,e){t.addFieldInt8(6,e,Ms.Unknown)}static addParts(t,e){t.addFieldOffset(7,e,0)}static createPartsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startPartsVector(t,e){t.startVector(4,e,4)}static endGeometry(t){return t.endObject()}static createGeometry(t,e,n,i,s,a,o,d,f){return Ma.startGeometry(t),Ma.addEnds(t,e),Ma.addXy(t,n),Ma.addZ(t,i),Ma.addM(t,s),Ma.addT(t,a),Ma.addTm(t,o),Ma.addType(t,d),Ma.addParts(t,f),Ma.endGeometry(t)}};function bv(r,t){const e=[];for(let n=0;n<r.length;n+=2){const i=[r[n],r[n+1]];t&&i.push(t[n>>1]),e.push(i)}return e}function US(r,t,e){if(!e||e.length===0)return[bv(r,t)];let n=0;const i=Array.from(e).map(a=>r.slice(n,n=a<<1));let s;return t&&(n=0,s=Array.from(e).map(a=>t.slice(n,n=a))),i.map((a,o)=>bv(a,s?s[o]:void 0))}function o8(r,t){const e=r.xyArray(),n=r.zArray();switch(t){case Ms.Point:{const i=Array.from(e);return n&&i.push(n[0]),i}case Ms.MultiPoint:case Ms.LineString:return bv(e,n);case Ms.MultiLineString:return US(e,n,r.endsArray());case Ms.Polygon:return US(e,n,r.endsArray())}}function wv(r,t){let e=t;if(e===Ms.Unknown&&(e=r.type()),e===Ms.GeometryCollection){const i=[];for(let s=0;s<r.partsLength();s++){const a=r.parts(s),o=a.type();i.push(wv(a,o))}return{type:Ms[e],geometries:i}}else if(e===Ms.MultiPolygon){const i=[];for(let s=0;s<r.partsLength();s++)i.push(wv(r.parts(s),Ms.Polygon));return{type:Ms[e],coordinates:i.map(s=>s.coordinates)}}const n=o8(r,e);return{type:Ms[e],coordinates:n}}var Rs;(function(r){r[r.Byte=0]="Byte",r[r.UByte=1]="UByte",r[r.Bool=2]="Bool",r[r.Short=3]="Short",r[r.UShort=4]="UShort",r[r.Int=5]="Int",r[r.UInt=6]="UInt",r[r.Long=7]="Long",r[r.ULong=8]="ULong",r[r.Float=9]="Float",r[r.Double=10]="Double",r[r.String=11]="String",r[r.Json=12]="Json",r[r.DateTime=13]="DateTime",r[r.Binary=14]="Binary"})(Rs||(Rs={}));class Us{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsColumn(t,e){return(e||new Us).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsColumn(t,e){return t.setPosition(t.position()+qp),(e||new Us).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}type(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):Rs.Byte}title(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,t):null}width(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt32(this.bb_pos+t):-1}precision(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt32(this.bb_pos+t):-1}scale(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readInt32(this.bb_pos+t):-1}nullable(){const t=this.bb.__offset(this.bb_pos,18);return t?!!this.bb.readInt8(this.bb_pos+t):!0}unique(){const t=this.bb.__offset(this.bb_pos,20);return t?!!this.bb.readInt8(this.bb_pos+t):!1}primaryKey(){const t=this.bb.__offset(this.bb_pos,22);return t?!!this.bb.readInt8(this.bb_pos+t):!1}metadata(t){const e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__string(this.bb_pos+e,t):null}static startColumn(t){t.startObject(11)}static addName(t,e){t.addFieldOffset(0,e,0)}static addType(t,e){t.addFieldInt8(1,e,Rs.Byte)}static addTitle(t,e){t.addFieldOffset(2,e,0)}static addDescription(t,e){t.addFieldOffset(3,e,0)}static addWidth(t,e){t.addFieldInt32(4,e,-1)}static addPrecision(t,e){t.addFieldInt32(5,e,-1)}static addScale(t,e){t.addFieldInt32(6,e,-1)}static addNullable(t,e){t.addFieldInt8(7,+e,1)}static addUnique(t,e){t.addFieldInt8(8,+e,0)}static addPrimaryKey(t,e){t.addFieldInt8(9,+e,0)}static addMetadata(t,e){t.addFieldOffset(10,e,0)}static endColumn(t){const e=t.endObject();return t.requiredField(e,4),e}static createColumn(t,e,n,i,s,a,o,d,f,_,w,x){return Us.startColumn(t),Us.addName(t,e),Us.addType(t,n),Us.addTitle(t,i),Us.addDescription(t,s),Us.addWidth(t,a),Us.addPrecision(t,o),Us.addScale(t,d),Us.addNullable(t,f),Us.addUnique(t,_),Us.addPrimaryKey(t,w),Us.addMetadata(t,x),Us.endColumn(t)}}class Gl{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFeature(t,e){return(e||new Gl).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFeature(t,e){return t.setPosition(t.position()+qp),(e||new Gl).__init(t.readInt32(t.position())+t.position(),t)}geometry(t){const e=this.bb.__offset(this.bb_pos,4);return e?(t||new s8).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}properties(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}propertiesLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}propertiesArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}columns(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new Us).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}columnsLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFeature(t){t.startObject(3)}static addGeometry(t,e){t.addFieldOffset(0,e,0)}static addProperties(t,e){t.addFieldOffset(1,e,0)}static createPropertiesVector(t,e){t.startVector(1,e.length,1);for(let n=e.length-1;n>=0;n--)t.addInt8(e[n]);return t.endVector()}static startPropertiesVector(t,e){t.startVector(1,e,1)}static addColumns(t,e){t.addFieldOffset(2,e,0)}static createColumnsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startColumnsVector(t,e){t.startVector(4,e,4)}static endFeature(t){return t.endObject()}static finishFeatureBuffer(t,e){t.finish(e)}static finishSizePrefixedFeatureBuffer(t,e){t.finish(e,void 0,!0)}static createFeature(t,e,n,i){return Gl.startFeature(t),Gl.addGeometry(t,e),Gl.addProperties(t,n),Gl.addColumns(t,i),Gl.endFeature(t)}}new TextEncoder;const OS=new TextDecoder;function a8(r,t){const e={};if(!t||t.length===0)return e;const n=r.propertiesArray();if(!n)return e;const i=new DataView(n.buffer,n.byteOffset),s=r.propertiesLength();let a=0;for(;a<s;){const o=i.getUint16(a,!0);a+=2;const d=t[o],f=d.name;switch(d.type){case Rs.Bool:{e[f]=!!i.getUint8(a),a+=1;break}case Rs.Byte:{e[f]=i.getInt8(a),a+=1;break}case Rs.UByte:{e[f]=i.getUint8(a),a+=1;break}case Rs.Short:{e[f]=i.getInt16(a,!0),a+=2;break}case Rs.UShort:{e[f]=i.getUint16(a,!0),a+=2;break}case Rs.Int:{e[f]=i.getInt32(a,!0),a+=4;break}case Rs.UInt:{e[f]=i.getUint32(a,!0),a+=4;break}case Rs.Long:{e[f]=Number(i.getBigInt64(a,!0)),a+=8;break}case Rs.ULong:{e[f]=Number(i.getBigUint64(a,!0)),a+=8;break}case Rs.Float:{e[f]=i.getFloat32(a,!0),a+=4;break}case Rs.Double:{e[f]=i.getFloat64(a,!0),a+=8;break}case Rs.DateTime:case Rs.String:{const _=i.getUint32(a,!0);a+=4,e[f]=OS.decode(n.subarray(a,a+_)),a+=_;break}case Rs.Json:{const _=i.getUint32(a,!0);a+=4;const w=OS.decode(n.subarray(a,a+_));e[f]=JSON.parse(w),a+=_;break}default:throw new Error("Unknown type "+d.type)}}return e}function xv(r,t){const e=t.columns;return{type:"Feature",geometry:wv(r.geometry(),t.geometryType),properties:a8(r,e)}}const Bv=new Uint8Array(0);function l8(){return this._source.cancel()}function c8(r,t){if(!r.length)return t;if(!t.length)return r;var e=new Uint8Array(r.length+t.length);return e.set(r),e.set(t,r.length),e}function u8(){var r=this,t=r._array.subarray(r._index);return r._source.read().then(function(e){return r._array=Bv,r._index=0,e.done?t.length>0?{done:!1,value:t}:{done:!0,value:void 0}:{done:!1,value:c8(t,e.value)}})}function A8(r){if((r|=0)<0)throw new Error("invalid length");var t=this,e=this._array.length-this._index;if(this._index+r<=this._array.length)return Promise.resolve(this._array.subarray(this._index,this._index+=r));var n=new Uint8Array(r);return n.set(this._array.subarray(this._index)),function i(){return t._source.read().then(function(s){return s.done?(t._array=Bv,t._index=0,e>0?n.subarray(0,e):null):e+s.value.length>=r?(t._array=s.value,t._index=r-e,n.set(s.value.subarray(0,r-e),e),n):(n.set(s.value,e),e+=s.value.length,i())})}()}function h8(r){return typeof r.slice=="function"?r:new y0(typeof r.read=="function"?r:r.getReader())}function y0(r){this._source=r,this._array=Bv,this._index=0}y0.prototype.read=u8,y0.prototype.slice=A8,y0.prototype.cancel=l8;class hl{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsCrs(t,e){return(e||new hl).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsCrs(t,e){return t.setPosition(t.position()+qp),(e||new hl).__init(t.readInt32(t.position())+t.position(),t)}org(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}code(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}name(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,t):null}wkt(t){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__string(this.bb_pos+e,t):null}codeString(t){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__string(this.bb_pos+e,t):null}static startCrs(t){t.startObject(6)}static addOrg(t,e){t.addFieldOffset(0,e,0)}static addCode(t,e){t.addFieldInt32(1,e,0)}static addName(t,e){t.addFieldOffset(2,e,0)}static addDescription(t,e){t.addFieldOffset(3,e,0)}static addWkt(t,e){t.addFieldOffset(4,e,0)}static addCodeString(t,e){t.addFieldOffset(5,e,0)}static endCrs(t){return t.endObject()}static createCrs(t,e,n,i,s,a,o){return hl.startCrs(t),hl.addOrg(t,e),hl.addCode(t,n),hl.addName(t,i),hl.addDescription(t,s),hl.addWkt(t,a),hl.addCodeString(t,o),hl.endCrs(t)}}class _0{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsHeader(t,e){return(e||new _0).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsHeader(t,e){return t.setPosition(t.position()+qp),(e||new _0).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}envelope(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+t*8):0}envelopeLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}envelopeArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}geometryType(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):Ms.Unknown}hasZ(){const t=this.bb.__offset(this.bb_pos,10);return t?!!this.bb.readInt8(this.bb_pos+t):!1}hasM(){const t=this.bb.__offset(this.bb_pos,12);return t?!!this.bb.readInt8(this.bb_pos+t):!1}hasT(){const t=this.bb.__offset(this.bb_pos,14);return t?!!this.bb.readInt8(this.bb_pos+t):!1}hasTm(){const t=this.bb.__offset(this.bb_pos,16);return t?!!this.bb.readInt8(this.bb_pos+t):!1}columns(t,e){const n=this.bb.__offset(this.bb_pos,18);return n?(e||new Us).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}columnsLength(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}featuresCount(){const t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readUint64(this.bb_pos+t):BigInt("0")}indexNodeSize(){const t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readUint16(this.bb_pos+t):16}crs(t){const e=this.bb.__offset(this.bb_pos,24);return e?(t||new hl).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}title(t){const e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){const e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__string(this.bb_pos+e,t):null}metadata(t){const e=this.bb.__offset(this.bb_pos,30);return e?this.bb.__string(this.bb_pos+e,t):null}static startHeader(t){t.startObject(14)}static addName(t,e){t.addFieldOffset(0,e,0)}static addEnvelope(t,e){t.addFieldOffset(1,e,0)}static createEnvelopeVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startEnvelopeVector(t,e){t.startVector(8,e,8)}static addGeometryType(t,e){t.addFieldInt8(2,e,Ms.Unknown)}static addHasZ(t,e){t.addFieldInt8(3,+e,0)}static addHasM(t,e){t.addFieldInt8(4,+e,0)}static addHasT(t,e){t.addFieldInt8(5,+e,0)}static addHasTm(t,e){t.addFieldInt8(6,+e,0)}static addColumns(t,e){t.addFieldOffset(7,e,0)}static createColumnsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startColumnsVector(t,e){t.startVector(4,e,4)}static addFeaturesCount(t,e){t.addFieldInt64(8,e,BigInt("0"))}static addIndexNodeSize(t,e){t.addFieldInt16(9,e,16)}static addCrs(t,e){t.addFieldOffset(10,e,0)}static addTitle(t,e){t.addFieldOffset(11,e,0)}static addDescription(t,e){t.addFieldOffset(12,e,0)}static addMetadata(t,e){t.addFieldOffset(13,e,0)}static endHeader(t){return t.endObject()}static finishHeaderBuffer(t,e){t.finish(e)}static finishSizePrefixedHeaderBuffer(t,e){t.finish(e,void 0,!0)}}function Cv(r){const t=_0.getRootAsHeader(r),e=t.featuresCount(),n=t.indexNodeSize(),i=[];for(let d=0;d<t.columnsLength();d++){const f=t.columns(d);if(!f)throw new Error("Column unexpectedly missing");if(!f.name())throw new Error("Column name unexpectedly missing");i.push({name:f.name(),type:f.type(),title:f.title(),description:f.description(),width:f.width(),precision:f.precision(),scale:f.scale(),nullable:f.nullable(),unique:f.unique(),primary_key:f.primaryKey()})}const s=t.crs(),a=s?{org:s.org(),code:s.code(),name:s.name(),description:s.description(),wkt:s.wkt(),code_string:s.codeString()}:null;return{geometryType:t.geometryType(),columns:i,envelope:null,featuresCount:Number(e),indexNodeSize:n,crs:a,title:t.title(),description:t.description(),metadata:t.metadata()}}/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Ev=function(r,t){return Ev=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])},Ev(r,t)};function d8(r,t){Ev(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function $d(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(_){try{f(n.next(_))}catch(w){a(w)}}function d(_){try{f(n.throw(_))}catch(w){a(w)}}function f(_){_.done?s(_.value):i(_.value).then(o,d)}f((n=n.apply(r,[])).next())})}function MA(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(f){return function(_){return d([f,_])}}function d(f){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return e.label++,{value:f[1],done:!1};case 5:e.label++,i=f[1],f=[0];continue;case 7:f=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){e=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){e.label=f[1];break}if(f[0]===6&&e.label<s[1]){e.label=s[1],s=f;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(f);break}s[2]&&e.ops.pop(),e.trys.pop();continue}f=t.call(r,e)}catch(_){f=[6,_],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Wd(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Kp(r){return this instanceof Kp?(this.v=r,this):new Kp(r)}function f8(r,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(r,t||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(x){n[x]&&(i[x]=function(B){return new Promise(function(P,R){s.push([x,B,P,R])>1||o(x,B)})})}function o(x,B){try{d(n[x](B))}catch(P){w(s[0][3],P)}}function d(x){x.value instanceof Kp?Promise.resolve(x.value.v).then(f,_):w(s[0][2],x)}function f(x){o("next",x)}function _(x){o("throw",x)}function w(x,B){x(B),s.shift(),s.length&&o(s[0][0],s[0][1])}}var DS=function(r){d8(t,r);function t(e){var n=r.call(this,e)||this;return Object.defineProperty(n,"name",{value:"RepeaterOverflowError",enumerable:!1}),typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(n,n.constructor.prototype):n.__proto__=n.constructor.prototype,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(n,n.constructor),n}return t}(Error);(function(){function r(t){if(t<0)throw new RangeError("Capacity may not be less than 0");this._c=t,this._q=[]}return Object.defineProperty(r.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"full",{get:function(){return this._q.length>=this._c},enumerable:!1,configurable:!0}),r.prototype.add=function(t){if(this.full)throw new Error("Buffer full");this._q.push(t)},r.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},r})(),function(){function r(t){if(t<1)throw new RangeError("Capacity may not be less than 1");this._c=t,this._q=[]}return Object.defineProperty(r.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"full",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.add=function(t){for(;this._q.length>=this._c;)this._q.shift();this._q.push(t)},r.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},r}(),function(){function r(t){if(t<1)throw new RangeError("Capacity may not be less than 1");this._c=t,this._q=[]}return Object.defineProperty(r.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"full",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.add=function(t){this._q.length<this._c&&this._q.push(t)},r.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},r}();function Sv(r){r!=null&&typeof r.then=="function"&&r.then(w0,w0)}var Tv=0,NS=1,Lh=2,v0=3,Iv=4,b0=1024,w0=function(){};function Xd(r){var t=r.err,e=Promise.resolve(r.execution).then(function(n){if(t!=null)throw t;return n});return r.err=void 0,r.execution=e.then(function(){},function(){}),r.pending===void 0?e:r.pending.then(function(){return e})}function Ph(r,t){var e=r.state>=v0;return Promise.resolve(t).then(function(n){return!e&&r.state>=Iv?Xd(r).then(function(i){return{value:i,done:!0}}):{value:n,done:e}})}function Fv(r,t){var e,n;if(!(r.state>=Lh))if(r.state=Lh,r.onnext(),r.onstop(),r.err==null&&(r.err=t),r.pushes.length===0&&(typeof r.buffer>"u"||r.buffer.empty))$p(r);else try{for(var i=Wd(r.pushes),s=i.next();!s.done;s=i.next()){var a=s.value;a.resolve()}}catch(o){e={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}function $p(r){var t,e;if(!(r.state>=v0)){r.state<Lh&&Fv(r),r.state=v0,r.buffer=void 0;try{for(var n=Wd(r.nexts),i=n.next();!i.done;i=n.next()){var s=i.value,a=r.pending===void 0?Xd(r):r.pending.then(function(){return Xd(r)});s.resolve(Ph(r,a))}}catch(o){t={error:o}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}r.pushes=[],r.nexts=[]}}function kS(r){r.state>=Iv||(r.state<v0&&$p(r),r.state=Iv)}function p8(r,t){if(Sv(t),r.pushes.length>=b0)throw new DS("No more than "+b0+" pending calls to push are allowed on a single repeater.");if(r.state>=Lh)return Promise.resolve(void 0);var e=r.pending===void 0?Promise.resolve(t):r.pending.then(function(){return t});e=e.catch(function(d){r.state<Lh&&(r.err=d),kS(r)});var n;if(r.nexts.length){var i=r.nexts.shift();i.resolve(Ph(r,e)),r.nexts.length?n=Promise.resolve(r.nexts[0].value):n=new Promise(function(d){return r.onnext=d})}else typeof r.buffer<"u"&&!r.buffer.full?(r.buffer.add(e),n=Promise.resolve(void 0)):n=new Promise(function(d){return r.pushes.push({resolve:d,value:e})});var s=!0,a={},o=n.catch(function(d){if(s)throw d});return a.then=function(d,f){return s=!1,Promise.prototype.then.call(n,d,f)},a.catch=function(d){return s=!1,Promise.prototype.catch.call(n,d)},a.finally=n.finally.bind(n),r.pending=e.then(function(){return o}).catch(function(d){r.err=d,kS(r)}),a}function g8(r){var t=Fv.bind(null,r),e=new Promise(function(n){return r.onstop=n});return t.then=e.then.bind(e),t.catch=e.catch.bind(e),t.finally=e.finally.bind(e),t}function m8(r){if(!(r.state>=NS)){r.state=NS;var t=p8.bind(null,r),e=g8(r);r.execution=new Promise(function(n){return n(r.executor(t,e))}),r.execution.catch(function(){return Fv(r)})}}var x0=new WeakMap,Wp=function(){function r(t,e){x0.set(this,{executor:t,buffer:e,err:void 0,state:Tv,pushes:[],nexts:[],pending:void 0,execution:void 0,onnext:w0,onstop:w0})}return r.prototype.next=function(t){Sv(t);var e=x0.get(this);if(e===void 0)throw new Error("WeakMap error");if(e.nexts.length>=b0)throw new DS("No more than "+b0+" pending calls to next are allowed on a single repeater.");if(e.state<=Tv&&m8(e),e.onnext(t),typeof e.buffer<"u"&&!e.buffer.empty){var n=Ph(e,e.buffer.remove());if(e.pushes.length){var i=e.pushes.shift();e.buffer.add(i.value),e.onnext=i.resolve}return n}else if(e.pushes.length){var s=e.pushes.shift();return e.onnext=s.resolve,Ph(e,s.value)}else if(e.state>=Lh)return $p(e),Ph(e,Xd(e));return new Promise(function(a){return e.nexts.push({resolve:a,value:t})})},r.prototype.return=function(t){Sv(t);var e=x0.get(this);if(e===void 0)throw new Error("WeakMap error");return $p(e),e.execution=Promise.resolve(e.execution).then(function(){return t}),Ph(e,Xd(e))},r.prototype.throw=function(t){var e=x0.get(this);if(e===void 0)throw new Error("WeakMap error");return e.state<=Tv||e.state>=Lh||typeof e.buffer<"u"&&!e.buffer.empty?($p(e),e.err==null&&(e.err=t),Ph(e,Xd(e))):this.next(Promise.reject(t))},r.prototype[Symbol.asyncIterator]=function(){return this},r.race=y8,r.merge=_8,r.zip=v8,r.latest=b8,r}();function B0(r,t){var e,n,i=[],s=function(f){f!=null&&typeof f[Symbol.asyncIterator]=="function"?i.push(f[Symbol.asyncIterator]()):f!=null&&typeof f[Symbol.iterator]=="function"?i.push(f[Symbol.iterator]()):i.push(function(){return f8(this,arguments,function(){return MA(this,function(x){switch(x.label){case 0:return t.yieldValues?[4,Kp(f)]:[3,3];case 1:return[4,x.sent()];case 2:x.sent(),x.label=3;case 3:return t.returnValues?[4,Kp(f)]:[3,5];case 4:return[2,x.sent()];case 5:return[2]}})})}())};try{for(var a=Wd(r),o=a.next();!o.done;o=a.next()){var d=o.value;s(d)}}catch(f){e={error:f}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i}function y8(r){var t=this,e=B0(r,{returnValues:!0});return new Wp(function(n,i){return $d(t,void 0,void 0,function(){var s,a,o,d,f,_;return MA(this,function(w){switch(w.label){case 0:if(!e.length)return i(),[2];a=!1,i.then(function(){s(),a=!0}),w.label=1;case 1:w.trys.push([1,,5,7]),d=void 0,f=0,_=function(){var x,B,P,R,N,Q;return MA(this,function(V){switch(V.label){case 0:x=f;try{for(B=(N=void 0,Wd(e)),P=B.next();!P.done;P=B.next())R=P.value,Promise.resolve(R.next()).then(function(W){W.done?(i(),o===void 0&&(o=W)):f===x&&(f++,s(W))},function(W){return i(W)})}catch(W){N={error:W}}finally{try{P&&!P.done&&(Q=B.return)&&Q.call(B)}finally{if(N)throw N.error}}return[4,new Promise(function(W){return s=W})];case 1:return d=V.sent(),d===void 0?[3,3]:[4,n(d.value)];case 2:V.sent(),V.label=3;case 3:return[2]}})},w.label=2;case 2:return a?[3,4]:[5,_()];case 3:return w.sent(),[3,2];case 4:return[2,o&&o.value];case 5:return i(),[4,Promise.race(e.map(function(x){return x.return&&x.return()}))];case 6:return w.sent(),[7];case 7:return[2]}})})})}function _8(r){var t=this,e=B0(r,{yieldValues:!0});return new Wp(function(n,i){return $d(t,void 0,void 0,function(){var s,a,o,d=this;return MA(this,function(f){switch(f.label){case 0:if(!e.length)return i(),[2];s=[],a=!1,i.then(function(){var _,w;a=!0;try{for(var x=Wd(s),B=x.next();!B.done;B=x.next()){var P=B.value;P()}}catch(R){_={error:R}}finally{try{B&&!B.done&&(w=x.return)&&w.call(x)}finally{if(_)throw _.error}}}),f.label=1;case 1:return f.trys.push([1,,3,4]),[4,Promise.all(e.map(function(_,w){return $d(d,void 0,void 0,function(){var x,B;return MA(this,function(P){switch(P.label){case 0:P.trys.push([0,,6,9]),P.label=1;case 1:return a?[3,5]:(Promise.resolve(_.next()).then(function(R){return s[w](R)},function(R){return i(R)}),[4,new Promise(function(R){s[w]=R})]);case 2:return x=P.sent(),x===void 0?[3,4]:x.done?(o=x,[2]):[4,n(x.value)];case 3:P.sent(),P.label=4;case 4:return[3,1];case 5:return[3,9];case 6:return B=_.return,B?[4,_.return()]:[3,8];case 7:B=P.sent(),P.label=8;case 8:return[7];case 9:return[2]}})})}))];case 2:return f.sent(),[2,o&&o.value];case 3:return i(),[7];case 4:return[2]}})})})}function v8(r){var t=this,e=B0(r,{returnValues:!0});return new Wp(function(n,i){return $d(t,void 0,void 0,function(){var s,a,o,d;return MA(this,function(f){switch(f.label){case 0:if(!e.length)return i(),[2,[]];a=!1,i.then(function(){s(),a=!0}),f.label=1;case 1:f.trys.push([1,,6,8]),f.label=2;case 2:return a?[3,5]:(Promise.all(e.map(function(_){return _.next()})).then(function(_){return s(_)},function(_){return i(_)}),[4,new Promise(function(_){return s=_})]);case 3:return o=f.sent(),o===void 0?[2]:(d=o.map(function(_){return _.value}),o.some(function(_){return _.done})?[2,d]:[4,n(d)]);case 4:return f.sent(),[3,2];case 5:return[3,8];case 6:return i(),[4,Promise.all(e.map(function(_){return _.return&&_.return()}))];case 7:return f.sent(),[7];case 8:return[2]}})})})}function b8(r){var t=this,e=B0(r,{yieldValues:!0,returnValues:!0});return new Wp(function(n,i){return $d(t,void 0,void 0,function(){var s,a,o,d,f,_=this;return MA(this,function(w){switch(w.label){case 0:if(!e.length)return i(),[2,[]];a=[],o=!1,i.then(function(){var x,B;s();try{for(var P=Wd(a),R=P.next();!R.done;R=P.next()){var N=R.value;N()}}catch(Q){x={error:Q}}finally{try{R&&!R.done&&(B=P.return)&&B.call(P)}finally{if(x)throw x.error}}o=!0}),w.label=1;case 1:return w.trys.push([1,,5,7]),Promise.all(e.map(function(x){return x.next()})).then(function(x){return s(x)},function(x){return i(x)}),[4,new Promise(function(x){return s=x})];case 2:return d=w.sent(),d===void 0?[2]:(f=d.map(function(x){return x.value}),d.every(function(x){return x.done})?[2,f]:[4,n(f.slice())]);case 3:return w.sent(),[4,Promise.all(e.map(function(x,B){return $d(_,void 0,void 0,function(){var P;return MA(this,function(R){switch(R.label){case 0:if(d[B].done)return[2,d[B].value];R.label=1;case 1:return o?[3,4]:(Promise.resolve(x.next()).then(function(N){return a[B](N)},function(N){return i(N)}),[4,new Promise(function(N){return a[B]=N})]);case 2:return P=R.sent(),P===void 0?[2,d[B].value]:P.done?[2,P.value]:(f[B]=P.value,[4,n(f.slice())]);case 3:return R.sent(),[3,1];case 4:return[2]}})})}))];case 4:return[2,w.sent()];case 5:return i(),[4,Promise.all(e.map(function(x){return x.return&&x.return()}))];case 6:return w.sent(),[7];case 7:return[2]}})})})}let C0=class{constructor(){this._extraRequestThreshold=256*1024}extraRequestThreshold(){return this._extraRequestThreshold}setExtraRequestThreshold(t){if(t<0)throw new Error("extraRequestThreshold cannot be negative");this._extraRequestThreshold=t}};C0.global=new C0;var jl;(function(r){r[r.Debug=0]="Debug",r[r.Info=1]="Info",r[r.Warn=2]="Warn",r[r.Error=3]="Error"})(jl||(jl={}));class Os{static debug(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.log(jl.Debug,...e)}static info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.log(jl.Info,...e)}static warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.log(jl.Warn,...e)}static error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.log(jl.Error,...e)}static log(t){if(!(this.logLevel>t)){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];switch(t){case jl.Debug:{console.debug(...n);break}case jl.Info:{console.info(...n);break}case jl.Warn:{console.warn(...n);break}case jl.Error:{console.error(...n);break}}}}}Os.logLevel=jl.Warn;const Mh=8*4+8,w8=16;function Lv(r,t){t=Math.min(Math.max(+t,2),65535);let e=r,n=e;do e=Math.ceil(e/t),n+=e;while(e!==1);return n*Mh}function x8(r,t){if(t<2)throw new Error("Node size must be at least 2");if(r===0)throw new Error("Number of items must be greater than 0");let e=r,n=e;const i=[e];do e=Math.ceil(e/t),n+=e,i.push(e);while(e!==1);const s=[];e=n;for(const o of i)s.push(e-o),e-=o;const a=[];for(let o=0;o<i.length;o++)a.push([s[o],s[o]+i[o]]);return a}async function*B8(r,t,e,n){class i{constructor(P,R){this._level=R,this.nodes=P}level(){return this._level}startNodeIdx(){return this.nodes[0]}endNodeIdx(){return this.nodes[1]}extendEndNodeIdx(P){console.assert(P>this.nodes[1]),this.nodes[1]=P}toString(){return`[NodeRange level: ${this._level}, nodes: ${this.nodes[0]}-${this.nodes[1]}]`}}const{minX:s,minY:a,maxX:o,maxY:d}=e;Os.info(`tree items: ${r}, nodeSize: ${t}`);const f=x8(r,t),_=f[0][0],x=[(()=>{const B=[0,1],P=f.length-1;return new i(B,P)})()];for(Os.debug(`starting stream search with queue: ${x}, numItems: ${r}, nodeSize: ${t}, levelBounds: ${f}`);x.length!=0;){const B=x.shift();Os.debug(`popped node: ${B}, queueLength: ${x.length}`);const P=B.startNodeIdx(),R=P>=_,N=(()=>{const[,et]=f[B.level()],ct=Math.min(B.endNodeIdx()+t,et);return R&&ct<et?ct+1:ct})(),Q=N-P,V=await n(P*Mh,Q*Mh),W=new DataView(V);for(let et=P;et<N;et++){const ct=et-P,dt=ct*Mh;if(o<W.getFloat64(dt+0,!0)||d<W.getFloat64(dt+8,!0)||s>W.getFloat64(dt+16,!0)||a>W.getFloat64(dt+24,!0))continue;const gt=W.getBigUint64(dt+32,!0);if(R){const at=gt,bt=(()=>{if(et<r-1){const $t=(ct+1)*Mh;return W.getBigUint64($t+32,!0)-at}else return null})(),vt=et-_;yield[Number(at),vt,Number(bt)];continue}const ht=gt,It=C0.global.extraRequestThreshold()/Mh,St=x[x.length-1];if(St!==void 0&&St.level()==B.level()-1&&ht<St.endNodeIdx()+It){Os.debug(`Merging "nodeRange" request into existing range: ${St}, newEndNodeIdx: ${St.endNodeIdx()} -> ${ht}`),St.extendEndNodeIdx(Number(ht));continue}const ot=(()=>{const at=B.level()-1,bt=[Number(ht),Number(ht)+1];return new i(bt,at)})();St!==void 0&&St.level()==ot.level()?Os.info(`Same level, but too far away. Pushing new request for nodeIdx: ${ht} rather than merging with distant ${St}`):Os.info(`Pushing new level for ${ot} onto queue with nearestNodeRange: ${St} since there's not already a range for this level.`),x.push(ot)}}}const RA=new Uint8Array([102,103,98,3,102,103,98,0]),Ru=4;class Pv{constructor(t,e,n,i,s){this.headerClient=t,this.header=e,this.headerLength=n,this.indexLength=i,this.nocache=s}static async open(t,e){const i=new QS(t,e),s=(()=>{const x=w8,B=3;let P=0,R;for(R=0;R<B;R++){const N=x**R*Mh;P+=N}return P})(),a=2024+s;Os.debug(`fetching header. minReqLength: ${a} (assumedHeaderLength: 2024, assumedIndexLength: ${s})`);{const x=new Uint8Array(await i.getRange(0,8,a,"header"));if(!x.subarray(0,3).every((B,P)=>RA[P]===B))throw Os.error(`bytes: ${x} != ${RA}`),new Error("Not a FlatGeobuf file");Os.debug("magic bytes look good")}let o;{const x=await i.getRange(8,4,a,"header");o=new DataView(x).getUint32(0,!0);const B=1048576*10;if(o>B||o<8)throw new Error("Invalid header size");Os.debug(`headerLength: ${o}`)}const d=await i.getRange(12,o,a,"header"),f=new Mu(new Uint8Array(d)),_=Cv(f),w=Lv(_.featuresCount,_.indexNodeSize);return Os.debug("completed: opening http reader"),new Pv(i,_,o,w,e)}async*selectBbox(t){const e=this.lengthBeforeTree(),n=this.headerClient,i=async function(d,f){return n.getRange(e+d,f,0,"index")},s=[];let a=[];for await(const d of B8(this.header.featuresCount,this.header.indexNodeSize,t,i)){const[f,,]=d;let[,,_]=d;if(_||(Os.info("final feature"),_=4),a.length==0){a.push([f,_]);continue}const w=a[a.length-1],x=f-(w[0]+w[1]);x>C0.global.extraRequestThreshold()&&(Os.info(`Pushing new feature batch, since gap ${x} was too large`),s.push(a),a=[]),a.push([f,_])}this.headerClient.logUsage("header+index"),a.length>0&&s.push(a);const o=s.flatMap(d=>this.readFeatureBatch(d,this.nocache));yield*Wp.merge(o)}lengthBeforeTree(){return RA.length+Ru+this.headerLength}lengthBeforeFeatures(){return this.lengthBeforeTree()+this.indexLength}buildFeatureClient(t){return new QS(this.headerClient.httpClient,t)}async*readFeatureBatch(t,e){const[n]=t[0],[i,s]=t[t.length-1],a=n,d=i+s-a,f=this.buildFeatureClient(e);let _=d;for(const[w]of t)yield await this.readFeature(f,w,_),_=0;f.logUsage("feature")}async readFeature(t,e,n){const i=e+this.lengthBeforeFeatures();let s;{const _=await t.getRange(i,4,n,"feature length");s=new DataView(_).getUint32(0,!0)}const a=await t.getRange(i+4,s,n,"feature data"),o=new Uint8Array(a),d=new Uint8Array(s+Ru);d.set(o,Ru);const f=new Mu(d);return f.setPosition(Ru),Gl.getRootAsFeature(f)}}class QS{constructor(t,e){if(this.bytesEverUsed=0,this.bytesEverFetched=0,this.buffer=new ArrayBuffer(0),this.head=0,typeof t=="string")this.httpClient=new zS(t,e);else if(t instanceof zS)this.httpClient=t;else throw new Error("Unknown source ")}async getRange(t,e,n,i){this.bytesEverUsed+=e;const s=t-this.head,a=s+e;if(s>=0&&a<=this.buffer.byteLength)return this.buffer.slice(s,a);const o=Math.max(e,n);return this.bytesEverFetched+=o,Os.debug(`requesting for new Range: ${t}-${t+o-1}`),this.buffer=await this.httpClient.getRange(t,o,i),this.head=t,this.buffer.slice(0,e)}logUsage(t){const e=t.split(" ")[0],n=this.bytesEverUsed,i=this.bytesEverFetched,s=(100*n/i).toFixed(2);Os.info(`${e} bytes used/requested: ${n} / ${i} = ${s}%`)}}class zS{constructor(t,e){this.requestsEverMade=0,this.bytesEverRequested=0,this.url=t,this.nocache=e}async getRange(t,e,n){this.requestsEverMade+=1,this.bytesEverRequested+=e;const i=`bytes=${t}-${t+e-1}`;Os.info(`request: #${this.requestsEverMade}, purpose: ${n}), bytes: (this_request: ${e}, ever: ${this.bytesEverRequested}), Range: ${i}`);const s={Range:i};return this.nocache&&(s["Cache-Control"]="no-cache, no-store"),(await fetch(this.url,{headers:s})).arrayBuffer()}}function C8(r,t,e){if(!r.subarray(0,3).every((_,w)=>RA[w]===_))throw new Error("Not a FlatGeobuf file");const n=new Mu(r),i=n.readUint32(RA.length);n.setPosition(RA.length+Ru);const s=Cv(n);let a=RA.length+Ru+i;const{indexNodeSize:o,featuresCount:d}=s;o>0&&(a+=Lv(d,o));const f=[];for(;a<n.capacity();){const _=n.readUint32(a);n.setPosition(a+Ru);const w=Gl.getRootAsFeature(n);f.push(t(w,s)),a+=Ru+_}return f}async function*E8(r,t,e){const n=h8(r),i=async x=>await n.slice(x);let s=new Uint8Array(await i(8));if(!s.subarray(0,3).every((x,B)=>RA[B]===x))throw new Error("Not a FlatGeobuf file");s=new Uint8Array(await i(4));let a=new Mu(s);const o=a.readUint32(0);s=new Uint8Array(await i(o)),a=new Mu(s);const d=Cv(a),{indexNodeSize:f,featuresCount:_}=d;if(f>0){const x=Lv(_,f);await i(x)}let w;for(;w=await T8(i,d,t);)yield w}function S8(r,t,e,n){try{let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return async function*(){const s=await Pv.open(r,i);Os.debug("opened reader");for await(const a of s.selectBbox(t))yield e(a,s.header)}()}catch(i){return Promise.reject(i)}}async function T8(r,t,e){let n=new Uint8Array(await r(4,"feature length"));if(n.byteLength===0)return;let i=new Mu(n);const s=i.readUint32(0);n=new Uint8Array(await r(s,"feature data"));const a=new Uint8Array(s+4);a.set(n,4),i=new Mu(a),i.setPosition(Ru);const o=Gl.getRootAsFeature(i);return e(o,t)}function I8(r,t){return{type:"FeatureCollection",features:C8(r,xv)}}function F8(r,t){return E8(r,xv)}function L8(r,t,e){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return S8(r,t,xv,e,n)}function HS(r,t,e){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return r instanceof Uint8Array?I8(r):r instanceof ReadableStream?F8(r):L8(r,t,e,n)}class P8{constructor(){this._bearing=0,this._pitch=60,this._minpitchzoom=null}onAdd(t){this._map=t;let e=this;return this._btn=document.createElement("button"),this._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-2d",this._btn.id="bt3D",this._btn.type="button",this._btn["aria-label"]="Vista 3D",this._btn.onclick=function(){if(e._btn.className.indexOf("3d")!=-1){let f={pitch:e._pitch,bearing:e._bearing};e._minpitchzoom&&t.getZoom()>e._minpitchzoom&&(f.zoom=e._minpitchzoom);var n=0,i=38.5,s=6,a=62.33,{longitude:o,latitude:d}=t.getCenter();t.getZoom()<10?t.setTerrain({source:"terrainICGC",exaggeration:1.5}):o>=n&&o<=s&&d>=i&&d<=a?t.setTerrain({source:"terrainICGC",exaggeration:1.2}):t.setTerrain({source:"terrainICGC",exaggeration:1.5}),t.easeTo(f),e._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-2d"}else t.setTerrain(null),t.easeTo({pitch:0,bearing:0}),e._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-3d"},this._container=document.createElement("div"),this._container.className="maplibregl-ctrl maplibregl-ctrl-group",this._container.title="Vista 3D",this._container.appendChild(this._btn),this._container}onRemove(){this._container.parentNode.removeChild(this._container),this._map=void 0}}function Xp(r){"@babel/helpers - typeof";return Xp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xp(r)}function M8(r,t){if(Xp(r)!="object"||!r)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var n=e.call(r,t||"default");if(Xp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function R8(r){var t=M8(r,"string");return Xp(t)=="symbol"?t:t+""}function j(r,t,e){return t=R8(t),t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function ci(r,t){if(!r)throw new Error(t||"loader assertion failed.")}const E0=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),VS=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);VS&&parseFloat(VS[1]);const U8="3.4.15";function Rc(r,t){if(!r)throw new Error(t||"loaders.gl assertion failed.")}const Mv={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},O8=Mv.global||Mv.self||Mv.window||{},Uu=typeof process!="object"||String(process)!=="[object process]"||process.browser,Rv=typeof importScripts=="function",D8=typeof window<"u"&&typeof window.orientation<"u",GS=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);GS&&parseFloat(GS[1]);class N8{constructor(t,e){j(this,"name",void 0),j(this,"workerThread",void 0),j(this,"isRunning",!0),j(this,"result",void 0),j(this,"_resolve",()=>{}),j(this,"_reject",()=>{}),this.name=t,this.workerThread=e,this.result=new Promise((n,i)=>{this._resolve=n,this._reject=i})}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){Rc(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){Rc(this.isRunning),this.isRunning=!1,this._reject(t)}}let Uv=class{terminate(){}};const Ov=new Map;function k8(r){Rc(r.source&&!r.url||!r.source&&r.url);let t=Ov.get(r.source||r.url);return t||(r.url&&(t=Q8(r.url),Ov.set(r.url,t)),r.source&&(t=jS(r.source),Ov.set(r.source,t))),Rc(t),t}function Q8(r){if(!r.startsWith("http"))return r;const t=z8(r);return jS(t)}function jS(r){const t=new Blob([r],{type:"application/javascript"});return URL.createObjectURL(t)}function z8(r){return`try {
  importScripts('`.concat(r,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function qS(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,e=arguments.length>2?arguments[2]:void 0;const n=e||new Set;if(r){if(KS(r))n.add(r);else if(KS(r.buffer))n.add(r.buffer);else if(!ArrayBuffer.isView(r)){if(t&&typeof r=="object")for(const i in r)qS(r[i],t,n)}}return e===void 0?Array.from(n):[]}function KS(r){return r?r instanceof ArrayBuffer||typeof MessagePort<"u"&&r instanceof MessagePort||typeof ImageBitmap<"u"&&r instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas:!1}const Dv=()=>{};class Nv{static isSupported(){return typeof Worker<"u"&&Uu||typeof Uv<"u"&&!Uu}constructor(t){j(this,"name",void 0),j(this,"source",void 0),j(this,"url",void 0),j(this,"terminated",!1),j(this,"worker",void 0),j(this,"onMessage",void 0),j(this,"onError",void 0),j(this,"_loadableURL","");const{name:e,source:n,url:i}=t;Rc(n||i),this.name=e,this.source=n,this.url=i,this.onMessage=Dv,this.onError=s=>console.log(s),this.worker=Uu?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Dv,this.onError=Dv,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(t,e){e=e||qS(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+="worker ".concat(this.name," from ").concat(this.url,". "),t.message&&(e+="".concat(t.message," in ")),t.lineno&&(e+=":".concat(t.lineno,":").concat(t.colno)),new Error(e)}_createBrowserWorker(){this._loadableURL=k8({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},t.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},t.onmessageerror=e=>console.error(e),t}_createNodeWorker(){let t;if(this.url){const n=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);t=new Uv(n,{eval:!1})}else if(this.source)t=new Uv(this.source,{eval:!0});else throw new Error("no worker");return t.on("message",e=>{this.onMessage(e)}),t.on("error",e=>{this.onError(e)}),t.on("exit",e=>{}),t}}class H8{static isSupported(){return Nv.isSupported()}constructor(t){j(this,"name","unnamed"),j(this,"source",void 0),j(this,"url",void 0),j(this,"maxConcurrency",1),j(this,"maxMobileConcurrency",1),j(this,"onDebug",()=>{}),j(this,"reuseWorkers",!0),j(this,"props",{}),j(this,"jobQueue",[]),j(this,"idleQueue",[]),j(this,"count",0),j(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach(t=>t.destroy()),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},t.name!==void 0&&(this.name=t.name),t.maxConcurrency!==void 0&&(this.maxConcurrency=t.maxConcurrency),t.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=t.maxMobileConcurrency),t.reuseWorkers!==void 0&&(this.reuseWorkers=t.reuseWorkers),t.onDebug!==void 0&&(this.onDebug=t.onDebug)}async startJob(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,a,o)=>s.done(o),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,a)=>s.error(a);const i=new Promise(s=>(this.jobQueue.push({name:t,onMessage:e,onError:n,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const n=new N8(e.name,t);t.onMessage=i=>e.onMessage(n,i.type,i.payload),t.onError=i=>e.onError(n,i),e.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Nv({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return D8?this.maxMobileConcurrency:this.maxConcurrency}}const V8={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Ou{static isSupported(){return Nv.isSupported()}static getWorkerFarm(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Ou._workerFarm=Ou._workerFarm||new Ou({}),Ou._workerFarm.setProps(t),Ou._workerFarm}constructor(t){j(this,"props",void 0),j(this,"workerPools",new Map),this.props={...V8},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:i}=t;let s=this.workerPools.get(e);return s||(s=new H8({name:e,source:n,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}j(Ou,"_workerFarm",void 0);const G8="latest";function j8(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e=t[r.id]||{},n="".concat(r.id,"-worker.js");let i=e.workerUrl;if(!i&&r.id==="compression"&&(i=t.workerUrl),t._workerType==="test"&&(i="modules/".concat(r.module,"/dist/").concat(n)),!i){let s=r.version;s==="latest"&&(s=G8);const a=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(r.module).concat(a,"/dist/").concat(n)}return Rc(i),i}function q8(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:U8;Rc(r,"no worker provided");const e=r.version;return!(!t||!e)}const K8=null,$8=null,kv=null,$S=null,W8=Object.freeze(Object.defineProperty({__proto__:null,readFileAsArrayBuffer:K8,readFileAsText:$8,requireFromFile:kv,requireFromString:$S},Symbol.toStringTag,{value:"Module"})),X8="3.4.15",Qv={};async function Rh(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t&&(r=J8(r,t,e)),Qv[r]=Qv[r]||Y8(r),await Qv[r]}function J8(r,t,e){if(r.startsWith("http"))return r;const n=e.modules||{};return n[r]?n[r]:Uu?e.CDN?(Rc(e.CDN.startsWith("http")),"".concat(e.CDN,"/").concat(t,"@").concat(X8,"/dist/libs/").concat(r)):Rv?"../src/libs/".concat(r):"modules/".concat(t,"/src/libs/").concat(r):"modules/".concat(t,"/dist/libs/").concat(r)}async function Y8(r){if(r.endsWith("wasm"))return await(await fetch(r)).arrayBuffer();if(!Uu)try{return W8&&kv&&await kv(r)}catch{return null}if(Rv)return importScripts(r);const e=await(await fetch(r)).text();return Z8(e,r)}function Z8(r,t){if(!Uu)return $S;if(Rv)return eval.call(O8,r),null;const e=document.createElement("script");e.id=t;try{e.appendChild(document.createTextNode(r))}catch{e.text=r}return document.body.appendChild(e),null}function tQ(r,t){return!Ou.isSupported()||!Uu&&!(t!=null&&t._nodeWorkers)?!1:r.worker&&(t==null?void 0:t.worker)}async function eQ(r,t,e,n,i){const s=r.id,a=j8(r,e),d=Ou.getWorkerFarm(e).getWorkerPool({name:s,url:a});e=JSON.parse(JSON.stringify(e)),n=JSON.parse(JSON.stringify(n||{}));const f=await d.startJob("process-on-worker",rQ.bind(null,i));return f.postMessage("process",{input:t,options:e,context:n}),await(await f.result).result}async function rQ(r,t,e,n){switch(e){case"done":t.done(n);break;case"error":t.error(new Error(n.error));break;case"process":const{id:i,input:s,options:a}=n;try{const o=await r(s,a);t.postMessage("done",{id:i,result:o})}catch(o){const d=o instanceof Error?o.message:"unknown error";t.postMessage("error",{id:i,error:d})}break;default:console.warn("parse-with-worker unknown message ".concat(e))}}function nQ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof r=="string"?r.slice(0,t):ArrayBuffer.isView(r)?WS(r.buffer,r.byteOffset,t):r instanceof ArrayBuffer?WS(r,0,t):""}function WS(r,t,e){if(r.byteLength<=t+e)return"";const n=new DataView(r);let i="";for(let s=0;s<e;s++)i+=String.fromCharCode(n.getUint8(t+s));return i}function iQ(r){try{return JSON.parse(r)}catch{throw new Error('Failed to parse JSON from data starting with "'.concat(nQ(r),'"'))}}function sQ(r,t,e){if(e=e||r.byteLength,r.byteLength<e||t.byteLength<e)return!1;const n=new Uint8Array(r),i=new Uint8Array(t);for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}function oQ(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];const n=t.map(o=>o instanceof ArrayBuffer?new Uint8Array(o):o),i=n.reduce((o,d)=>o+d.byteLength,0),s=new Uint8Array(i);let a=0;for(const o of n)s.set(o,a),a+=o.byteLength;return s.buffer}function zv(r,t,e){const n=e!==void 0?new Uint8Array(r).subarray(t,t+e):new Uint8Array(r).subarray(t);return new Uint8Array(n).buffer}function Jp(r,t){return ci(r>=0),ci(t>0),r+(t-1)&~(t-1)}function aQ(r,t,e){let n;if(r instanceof ArrayBuffer)n=new Uint8Array(r);else{const i=r.byteOffset,s=r.byteLength;n=new Uint8Array(r.buffer||r.arrayBuffer,i,s)}return t.set(n,e),e+Jp(n.byteLength,4)}async function lQ(r){const t=[];for await(const e of r)t.push(e);return oQ(...t)}function XS(){let r;if(typeof window<"u"&&window.performance)r=window.performance.now();else if(typeof process<"u"&&process.hrtime){const t=process.hrtime();r=t[0]*1e3+t[1]/1e6}else r=Date.now();return r}class JS{constructor(t,e){j(this,"name",void 0),j(this,"type",void 0),j(this,"sampleSize",1),j(this,"time",void 0),j(this,"count",void 0),j(this,"samples",void 0),j(this,"lastTiming",void 0),j(this,"lastSampleTime",void 0),j(this,"lastSampleCount",void 0),j(this,"_count",0),j(this,"_time",0),j(this,"_samples",0),j(this,"_startTime",0),j(this,"_timerPending",!1),this.name=t,this.type=e,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=XS(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(XS()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Yp{constructor(t){j(this,"id",void 0),j(this,"stats",{}),this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach(e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}}),t}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(e=>this._getOrCreate(e))}_getOrCreate(t){if(!t||!t.name)return null;const{name:e,type:n}=t;return this.stats[e]||(t instanceof JS?this.stats[e]=t:this.stats[e]=new JS(e,n)),this.stats[e]}}const cQ="Queued Requests",uQ="Active Requests",AQ="Cancelled Requests",hQ="Queued Requests Ever",dQ="Active Requests Ever",fQ={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class pQ{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};j(this,"props",void 0),j(this,"stats",void 0),j(this,"activeRequestCount",0),j(this,"requestQueue",[]),j(this,"requestMap",new Map),j(this,"deferredUpdate",null),this.props={...fQ,...t},this.stats=new Yp({id:this.props.id}),this.stats.get(cQ),this.stats.get(uQ),this.stats.get(AQ),this.stats.get(hQ),this.stats.get(dQ)}scheduleRequest(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(t))return this.requestMap.get(t);const n={handle:t,priority:0,getPriority:e},i=new Promise(s=>(n.resolve=s,n));return this.requestQueue.push(n),this.requestMap.set(t,i),this._issueNewRequests(),i}_issueRequest(t){const{handle:e,resolve:n}=t;let i=!1;const s=()=>{i||(i=!0,this.requestMap.delete(e),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(t!==0){this._updateAllRequests();for(let e=0;e<t;++e){const n=this.requestQueue.shift();n&&this._issueRequest(n)}}}_updateAllRequests(){const t=this.requestQueue;for(let e=0;e<t.length;++e){const n=t[e];this._updateRequest(n)||(t.splice(e,1),this.requestMap.delete(n.handle),e--)}t.sort((e,n)=>e.priority-n.priority)}_updateRequest(t){return t.priority=t.getPriority(t.handle),t.priority<0?(t.resolve(null),!1):!0}}let gQ="";const YS={};function mQ(r){for(const t in YS)if(r.startsWith(t)){const e=YS[t];r=r.replace(t,e)}return!r.startsWith("http://")&&!r.startsWith("https://")&&(r="".concat(gQ).concat(r)),r}function T2t(r){return r}function yQ(r){return r&&typeof r=="object"&&r.isBuffer}function ZS(r){if(yQ(r))return r;if(r instanceof ArrayBuffer)return r;if(ArrayBuffer.isView(r))return r.byteOffset===0&&r.byteLength===r.buffer.byteLength?r.buffer:r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength);if(typeof r=="string"){const t=r;return new TextEncoder().encode(t).buffer}if(r&&typeof r=="object"&&r._toArrayBuffer)return r._toArrayBuffer();throw new Error("toArrayBuffer")}function tT(r){const t=r?r.lastIndexOf("/"):-1;return t>=0?r.substr(t+1):""}function Hv(r){const t=r?r.lastIndexOf("/"):-1;return t>=0?r.substr(0,t):""}const _Q=r=>typeof r=="boolean",Zp=r=>typeof r=="function",tg=r=>r!==null&&typeof r=="object",eT=r=>tg(r)&&r.constructor==={}.constructor,vQ=r=>r&&typeof r[Symbol.iterator]=="function",bQ=r=>r&&typeof r[Symbol.asyncIterator]=="function",Uh=r=>typeof Response<"u"&&r instanceof Response||r&&r.arrayBuffer&&r.text&&r.json,Oh=r=>typeof Blob<"u"&&r instanceof Blob,wQ=r=>r&&typeof r=="object"&&r.isBuffer,xQ=r=>typeof ReadableStream<"u"&&r instanceof ReadableStream||tg(r)&&Zp(r.tee)&&Zp(r.cancel)&&Zp(r.getReader),BQ=r=>tg(r)&&Zp(r.read)&&Zp(r.pipe)&&_Q(r.readable),rT=r=>xQ(r)||BQ(r),CQ=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,EQ=/^([-\w.]+\/[-\w.+]+)/;function SQ(r){const t=EQ.exec(r);return t?t[1]:r}function nT(r){const t=CQ.exec(r);return t?t[1]:""}const iT=/\?.*/;function TQ(r){const t=r.match(iT);return t&&t[0]}function Vv(r){return r.replace(iT,"")}function S0(r){return Uh(r)?r.url:Oh(r)?r.name||"":typeof r=="string"?r:""}function Gv(r){if(Uh(r)){const t=r,e=t.headers.get("content-type")||"",n=Vv(t.url);return SQ(e)||nT(n)}return Oh(r)?r.type||"":typeof r=="string"?nT(r):""}function IQ(r){return Uh(r)?r.headers["content-length"]||-1:Oh(r)?r.size:typeof r=="string"?r.length:r instanceof ArrayBuffer||ArrayBuffer.isView(r)?r.byteLength:-1}async function sT(r){if(Uh(r))return r;const t={},e=IQ(r);e>=0&&(t["content-length"]=String(e));const n=S0(r),i=Gv(r);i&&(t["content-type"]=i);const s=await PQ(r);s&&(t["x-first-bytes"]=s),typeof r=="string"&&(r=new TextEncoder().encode(r));const a=new Response(r,{headers:t});return Object.defineProperty(a,"url",{value:n}),a}async function FQ(r){if(!r.ok){const t=await LQ(r);throw new Error(t)}}async function LQ(r){let t="Failed to fetch resource ".concat(r.url," (").concat(r.status,"): ");try{const e=r.headers.get("Content-Type");let n=r.statusText;e.includes("application/json")&&(n+=" ".concat(await r.text())),t+=n,t=t.length>60?"".concat(t.slice(0,60),"..."):t}catch{}return t}async function PQ(r){if(typeof r=="string")return"data:,".concat(r.slice(0,5));if(r instanceof Blob){const e=r.slice(0,5);return await new Promise(n=>{const i=new FileReader;i.onload=s=>{var a;return n(s==null||(a=s.target)===null||a===void 0?void 0:a.result)},i.readAsDataURL(e)})}if(r instanceof ArrayBuffer){const e=r.slice(0,5),n=MQ(e);return"data:base64,".concat(n)}return null}function MQ(r){let t="";const e=new Uint8Array(r);for(let n=0;n<e.byteLength;n++)t+=String.fromCharCode(e[n]);return btoa(t)}async function oT(r,t){if(typeof r=="string"){r=mQ(r);let e=t;return t!=null&&t.fetch&&typeof(t==null?void 0:t.fetch)!="function"&&(e=t.fetch),await fetch(r,e)}return await sT(r)}function aT(r){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent;return!!(e&&e.indexOf("Electron")>=0)}function Du(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||aT()}const T0={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},I0=T0.window||T0.self||T0.global,eg=T0.process||{},lT=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Du();const jv=globalThis;function cT(r){if(!Du())return"Node";if(aT())return"Electron";const e=(typeof navigator<"u"?navigator:{}).userAgent||"";if(e.indexOf("Edge")>-1)return"Edge";const n=e.indexOf("MSIE ")!==-1,i=e.indexOf("Trident/")!==-1;return n||i?"IE":jv.chrome?"Chrome":jv.safari?"Safari":jv.mozInnerScreenX?"Firefox":"Unknown"}function RQ(r){try{const t=window[r],e="__storage_test__";return t.setItem(e,e),t.removeItem(e),t}catch{return null}}class UQ{constructor(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";j(this,"storage",void 0),j(this,"id",void 0),j(this,"config",void 0),this.storage=RQ(n),this.id=t,this.config=e,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function OQ(r){let t;return r<10?t="".concat(r.toFixed(2),"ms"):r<100?t="".concat(r.toFixed(1),"ms"):r<1e3?t="".concat(r.toFixed(0),"ms"):t="".concat((r/1e3).toFixed(2),"s"),t}function DQ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const e=Math.max(t-r.length,0);return"".concat(" ".repeat(e)).concat(r)}function qv(r,t,e){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=r.src.replace(/\(/g,"%28").replace(/\)/g,"%29");r.width>n&&(e=Math.min(e,n/r.width));const s=r.width*e,a=r.height*e,o=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(t," %c+"),o]}let F0;(function(r){r[r.BLACK=30]="BLACK",r[r.RED=31]="RED",r[r.GREEN=32]="GREEN",r[r.YELLOW=33]="YELLOW",r[r.BLUE=34]="BLUE",r[r.MAGENTA=35]="MAGENTA",r[r.CYAN=36]="CYAN",r[r.WHITE=37]="WHITE",r[r.BRIGHT_BLACK=90]="BRIGHT_BLACK",r[r.BRIGHT_RED=91]="BRIGHT_RED",r[r.BRIGHT_GREEN=92]="BRIGHT_GREEN",r[r.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",r[r.BRIGHT_BLUE=94]="BRIGHT_BLUE",r[r.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",r[r.BRIGHT_CYAN=96]="BRIGHT_CYAN",r[r.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(F0||(F0={}));function uT(r){return typeof r=="string"?F0[r.toUpperCase()]||F0.WHITE:r}function NQ(r,t,e){return!Du&&typeof r=="string"&&(t&&(t=uT(t),r="\x1B[".concat(t,"m").concat(r,"\x1B[39m")),e&&(t=uT(e),r="\x1B[".concat(e+10,"m").concat(r,"\x1B[49m"))),r}function kQ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const e=Object.getPrototypeOf(r),n=Object.getOwnPropertyNames(e);for(const i of n)typeof r[i]=="function"&&(t.find(s=>i===s)||(r[i]=r[i].bind(r)))}function L0(r,t){if(!r)throw new Error(t||"Assertion failed")}function Jd(){let r;if(Du&&"performance"in I0){var t,e;r=I0==null||(t=I0.performance)===null||t===void 0||(e=t.now)===null||e===void 0?void 0:e.call(t)}else if("hrtime"in eg){var n;const i=eg==null||(n=eg.hrtime)===null||n===void 0?void 0:n.call(eg);r=i[0]*1e3+i[1]/1e6}else r=Date.now();return r}const Yd={debug:Du&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},QQ={enabled:!0,level:0};function dl(){}const AT={},hT={once:!0};class rg{constructor(){let{id:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};j(this,"id",void 0),j(this,"VERSION",lT),j(this,"_startTs",Jd()),j(this,"_deltaTs",Jd()),j(this,"_storage",void 0),j(this,"userData",{}),j(this,"LOG_THROTTLE_TIMEOUT",0),this.id=t,this.userData={},this._storage=new UQ("__probe-".concat(this.id,"__"),QQ),this.timeStamp("".concat(this.id," started")),kQ(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Jd()-this._startTs).toPrecision(10))}getDelta(){return Number((Jd()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:t}),this}setLevel(t){return this._storage.setConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,e){this._storage.setConfiguration({[t]:e})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,e){L0(t,e)}warn(t){return this._getLogFunction(0,t,Yd.warn,arguments,hT)}error(t){return this._getLogFunction(0,t,Yd.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,Yd.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,Yd.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];return this._getLogFunction(t,e,Yd.debug||Yd.info,arguments,hT)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||dl,n&&[n],{tag:GQ(e)}):dl}image(t){let{logLevel:e,priority:n,image:i,message:s="",scale:a=1}=t;return this._shouldLog(e||n)?Du?VQ({image:i,message:s,scale:a}):HQ():dl}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||dl)}group(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=fT({logLevel:t,message:e,opts:n}),{collapsed:s}=n;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||dl)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=dT(t)}_getLogFunction(t,e,n,i,s){if(this._shouldLog(t)){s=fT({logLevel:t,message:e,args:i,opts:s}),n=n||s.method,L0(n),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Jd();const a=s.tag||s.message;if(s.once)if(!AT[a])AT[a]=Jd();else return dl;return e=zQ(this.id,s.message,s),n.bind(console,e,...s.args)}return dl}}j(rg,"VERSION",lT);function dT(r){if(!r)return 0;let t;switch(typeof r){case"number":t=r;break;case"object":t=r.logLevel||r.priority||0;break;default:return 0}return L0(Number.isFinite(t)&&t>=0),t}function fT(r){const{logLevel:t,message:e}=r;r.logLevel=dT(t);const n=r.args?Array.from(r.args):[];for(;n.length&&n.shift()!==e;);switch(typeof t){case"string":case"function":e!==void 0&&n.unshift(e),r.message=t;break;case"object":Object.assign(r,t);break}typeof r.message=="function"&&(r.message=r.message());const i=typeof r.message;return L0(i==="string"||i==="object"),Object.assign(r,{args:n},r.opts)}function zQ(r,t,e){if(typeof t=="string"){const n=e.time?DQ(OQ(e.total)):"";t=e.time?"".concat(r,": ").concat(n,"  ").concat(t):"".concat(r,": ").concat(t),t=NQ(t,e.color,e.background)}return t}function HQ(r){return console.warn("removed"),dl}function VQ(r){let{image:t,message:e="",scale:n=1}=r;if(typeof t=="string"){const s=new Image;return s.onload=()=>{const a=qv(s,e,n);console.log(...a)},s.src=t,dl}const i=t.nodeName||"";if(i.toLowerCase()==="img")return console.log(...qv(t,e,n)),dl;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...qv(s,e,n)),s.src=t.toDataURL(),dl}return dl}function GQ(r){for(const t in r)for(const e in r[t])return e||"untitled";return"empty"}const pT=new rg({id:"loaders.gl"});class jQ{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class qQ{constructor(){j(this,"console",void 0),this.console=console}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.log.bind(this.console,...e)}info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.info.bind(this.console,...e)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.warn.bind(this.console,...e)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.error.bind(this.console,...e)}}const gT={fetch:null,mimeType:void 0,nothrow:!1,log:new qQ,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:E0,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},KQ={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function mT(){globalThis.loaders=globalThis.loaders||{};const{loaders:r}=globalThis;return r._state=r._state||{},r._state}const yT=()=>{const r=mT();return r.globalOptions=r.globalOptions||{...gT},r.globalOptions};function $Q(r,t,e,n){return e=e||[],e=Array.isArray(e)?e:[e],WQ(r,e),JQ(t,r,n)}function WQ(r,t){_T(r,null,gT,KQ,t);for(const e of t){const n=r&&r[e.id]||{},i=e.options&&e.options[e.id]||{},s=e.deprecatedOptions&&e.deprecatedOptions[e.id]||{};_T(n,e.id,i,s,t)}}function _T(r,t,e,n,i){const s=t||"Top level",a=t?"".concat(t,"."):"";for(const o in r){const d=!t&&tg(r[o]),f=o==="baseUri"&&!t,_=o==="workerUrl"&&t;if(!(o in e)&&!f&&!_){if(o in n)pT.warn("".concat(s," loader option '").concat(a).concat(o,"' no longer supported, use '").concat(n[o],"'"))();else if(!d){const w=XQ(o,i);pT.warn("".concat(s," loader option '").concat(a).concat(o,"' not recognized. ").concat(w))()}}}}function XQ(r,t){const e=r.toLowerCase();let n="";for(const i of t)for(const s in i.options){if(r===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const a=s.toLowerCase();(e.startsWith(a)||a.startsWith(e))&&(n=n||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return n}function JQ(r,t,e){const i={...r.options||{}};return YQ(i,e),i.log===null&&(i.log=new jQ),vT(i,yT()),vT(i,t),i}function vT(r,t){for(const e in t)if(e in t){const n=t[e];eT(n)&&eT(r[e])?r[e]={...r[e],...t[e]}:r[e]=t[e]}}function YQ(r,t){t&&!("baseUri"in r)&&(r.baseUri=t)}function Kv(r){var t;return r?(Array.isArray(r)&&(r=r[0]),Array.isArray((t=r)===null||t===void 0?void 0:t.extensions)):!1}function $v(r){var t,e;ci(r,"null loader"),ci(Kv(r),"invalid loader");let n;return Array.isArray(r)&&(n=r[1],r=r[0],r={...r,options:{...r.options,...n}}),((t=r)!==null&&t!==void 0&&t.parseTextSync||(e=r)!==null&&e!==void 0&&e.parseText)&&(r.text=!0),r.text||(r.binary=!0),r}const bT=()=>{const r=mT();return r.loaderRegistry=r.loaderRegistry||[],r.loaderRegistry};function ZQ(r){const t=bT();r=Array.isArray(r)?r:[r];for(const e of r){const n=$v(e);t.find(i=>n===i)||t.unshift(n)}}function tz(){return bT()}const ez=new rg({id:"loaders.gl"}),rz=/\.([^.]+)$/;async function nz(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],e=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!xT(r))return null;let i=wT(r,t,{...e,nothrow:!0},n);if(i)return i;if(Oh(r)&&(r=await r.slice(0,10).arrayBuffer(),i=wT(r,t,e,n)),!i&&!(e!=null&&e.nothrow))throw new Error(BT(r));return i}function wT(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],e=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!xT(r))return null;if(t&&!Array.isArray(t))return $v(t);let i=[];t&&(i=i.concat(t)),e!=null&&e.ignoreRegisteredLoaders||i.push(...tz()),sz(i);const s=iz(r,i,e,n);if(!s&&!(e!=null&&e.nothrow))throw new Error(BT(r));return s}function iz(r,t,e,n){const i=S0(r),s=Gv(r),a=Vv(i)||(n==null?void 0:n.url);let o=null,d="";if(e!=null&&e.mimeType&&(o=Wv(t,e==null?void 0:e.mimeType),d="match forced by supplied MIME type ".concat(e==null?void 0:e.mimeType)),o=o||oz(t,a),d=d||(o?"matched url ".concat(a):""),o=o||Wv(t,s),d=d||(o?"matched MIME type ".concat(s):""),o=o||lz(t,r),d=d||(o?"matched initial data ".concat(ET(r)):""),o=o||Wv(t,e==null?void 0:e.fallbackMimeType),d=d||(o?"matched fallback MIME type ".concat(s):""),d){var f;ez.log(1,"selectLoader selected ".concat((f=o)===null||f===void 0?void 0:f.name,": ").concat(d,"."))}return o}function xT(r){return!(r instanceof Response&&r.status===204)}function BT(r){const t=S0(r),e=Gv(r);let n="No valid loader found (";n+=t?"".concat(tT(t),", "):"no url provided, ",n+="MIME type: ".concat(e?'"'.concat(e,'"'):"not provided",", ");const i=r?ET(r):"";return n+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",n+=")",n}function sz(r){for(const t of r)$v(t)}function oz(r,t){const e=t&&rz.exec(t),n=e&&e[1];return n?az(r,n):null}function az(r,t){t=t.toLowerCase();for(const e of r)for(const n of e.extensions)if(n.toLowerCase()===t)return e;return null}function Wv(r,t){for(const e of r)if(e.mimeTypes&&e.mimeTypes.includes(t)||t==="application/x.".concat(e.id))return e;return null}function lz(r,t){if(!t)return null;for(const e of r)if(typeof t=="string"){if(cz(t,e))return e}else if(ArrayBuffer.isView(t)){if(CT(t.buffer,t.byteOffset,e))return e}else if(t instanceof ArrayBuffer&&CT(t,0,e))return e;return null}function cz(r,t){return t.testText?t.testText(r):(Array.isArray(t.tests)?t.tests:[t.tests]).some(n=>r.startsWith(n))}function CT(r,t,e){return(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>uz(r,t,e,i))}function uz(r,t,e,n){if(n instanceof ArrayBuffer)return sQ(n,r,n.byteLength);switch(typeof n){case"function":return n(r,e);case"string":const i=Xv(r,t,n.length);return n===i;default:return!1}}function ET(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof r=="string"?r.slice(0,t):ArrayBuffer.isView(r)?Xv(r.buffer,r.byteOffset,t):r instanceof ArrayBuffer?Xv(r,0,t):""}function Xv(r,t,e){if(r.byteLength<t+e)return"";const n=new DataView(r);let i="";for(let s=0;s<e;s++)i+=String.fromCharCode(n.getUint8(t+s));return i}const Az=256*1024;function*hz(r,t){const e=(t==null?void 0:t.chunkSize)||Az;let n=0;const i=new TextEncoder;for(;n<r.length;){const s=Math.min(r.length-n,e),a=r.slice(n,n+s);n+=s,yield i.encode(a)}}const dz=256*1024;function fz(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:e=dz}=t;let n=0;for(;n<r.byteLength;){const i=Math.min(r.byteLength-n,e),s=new ArrayBuffer(i),a=new Uint8Array(r,n,i);new Uint8Array(s).set(a),n+=i,yield s}}()}const pz=1024*1024;async function*gz(r,t){const e=(t==null?void 0:t.chunkSize)||pz;let n=0;for(;n<r.size;){const i=n+e,s=await r.slice(n,i).arrayBuffer();n=i,yield s}}function ST(r,t){return E0?mz(r,t):yz(r)}async function*mz(r,t){const e=r.getReader();let n;try{for(;;){const i=n||e.read();t!=null&&t._streamReadAhead&&(n=e.read());const{done:s,value:a}=await i;if(s)return;yield ZS(a)}}catch{e.releaseLock()}}async function*yz(r,t){for await(const e of r)yield ZS(e)}function _z(r,t){if(typeof r=="string")return hz(r,t);if(r instanceof ArrayBuffer)return fz(r,t);if(Oh(r))return gz(r,t);if(rT(r))return ST(r,t);if(Uh(r))return ST(r.body,t);throw new Error("makeIterator")}const TT="Cannot convert supplied data type";function vz(r,t,e){if(t.text&&typeof r=="string")return r;if(wQ(r)&&(r=r.buffer),r instanceof ArrayBuffer){const n=r;return t.text&&!t.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(r)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(r);let n=r.buffer;const i=r.byteLength||r.length;return(r.byteOffset!==0||i!==n.byteLength)&&(n=n.slice(r.byteOffset,r.byteOffset+i)),n}throw new Error(TT)}async function bz(r,t,e){const n=r instanceof ArrayBuffer||ArrayBuffer.isView(r);if(typeof r=="string"||n)return vz(r,t);if(Oh(r)&&(r=await sT(r)),Uh(r)){const i=r;return await FQ(i),t.binary?await i.arrayBuffer():await i.text()}if(rT(r)&&(r=_z(r,e)),vQ(r)||bQ(r))return lQ(r);throw new Error(TT)}function IT(r,t){const e=yT(),n=r||e;return typeof n.fetch=="function"?n.fetch:tg(n.fetch)?i=>oT(i,n):t!=null&&t.fetch?t==null?void 0:t.fetch:oT}function wz(r,t,e){if(e)return e;const n={fetch:IT(t,r),...r};if(n.url){const i=Vv(n.url);n.baseUrl=i,n.queryString=TQ(n.url),n.filename=tT(i),n.baseUrl=Hv(i)}return Array.isArray(n.loaders)||(n.loaders=null),n}function xz(r,t){if(!t&&r&&!Array.isArray(r))return r;let e;if(r&&(e=Array.isArray(r)?r:[r]),t&&t.loaders){const n=Array.isArray(t.loaders)?t.loaders:[t.loaders];e=e?[...e,...n]:n}return e&&e.length?e:null}async function Jv(r,t,e,n){Rc(!n||typeof n=="object"),t&&!Array.isArray(t)&&!Kv(t)&&(n=void 0,e=t,t=void 0),r=await r,e=e||{};const i=S0(r),a=xz(t,n),o=await nz(r,a,e);return o?(e=$Q(e,o,a,i),n=wz({url:i,parse:Jv,loaders:a},e,n||null),await Bz(o,r,e,n)):null}async function Bz(r,t,e,n){if(q8(r),Uh(t)){const i=t,{ok:s,redirected:a,status:o,statusText:d,type:f,url:_}=i,w=Object.fromEntries(i.headers.entries());n.response={headers:w,ok:s,redirected:a,status:o,statusText:d,type:f,url:_}}if(t=await bz(t,r,e),r.parseTextSync&&typeof t=="string")return e.dataType="text",r.parseTextSync(t,e,n,r);if(tQ(r,e))return await eQ(r,t,e,n,Jv);if(r.parseText&&typeof t=="string")return await r.parseText(t,e,n,r);if(r.parse)return await r.parse(t,e,n,r);throw Rc(!r.parseSync),new Error("".concat(r.id," loader - no parser found and worker is disabled"))}async function UA(r,t,e,n){!Array.isArray(t)&&!Kv(t)&&(e=t,t=void 0);const i=IT(e);let s=r;return typeof r=="string"&&(s=await i(r)),Oh(r)&&(s=await i(r)),await Jv(s,t,e)}const Cz="3.4.15",{_parseImageNode:Ez}=globalThis,Yv=typeof Image<"u",Zv=typeof ImageBitmap<"u",tb=E0?!0:!!Ez;function Sz(r){switch(r){case"auto":return Zv||Yv||tb;case"imagebitmap":return Zv;case"image":return Yv;case"data":return tb;default:throw new Error("@loaders.gl/images: image ".concat(r," not supported in this environment"))}}function Tz(){if(Zv)return"imagebitmap";if(Yv)return"image";if(tb)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function Iz(r){const t=Lz(r);if(!t)throw new Error("Not an image");return t}function Fz(r){switch(Iz(r)){case"data":return r;case"image":case"imagebitmap":const t=document.createElement("canvas"),e=t.getContext("2d");if(!e)throw new Error("getImageData");return t.width=r.width,t.height=r.height,e.drawImage(r,0,0),e.getImageData(0,0,r.width,r.height);default:throw new Error("getImageData")}}function Lz(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&r instanceof Image?"image":r&&typeof r=="object"&&r.data&&r.width&&r.height?"data":null}const Pz=/^data:image\/svg\+xml/,Mz=/\.svg((\?|#).*)?$/;function eb(r){return r&&(Pz.test(r)||Mz.test(r))}function Rz(r,t){if(eb(t)){let n=new TextDecoder().decode(r);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(n=unescape(encodeURIComponent(n)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(n))}return FT(r,t)}function FT(r,t){if(eb(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(r)])}async function LT(r,t,e){const n=Rz(r,e),i=self.URL||self.webkitURL,s=typeof n!="string"&&i.createObjectURL(n);try{return await Uz(s||n,t)}finally{s&&i.revokeObjectURL(s)}}async function Uz(r,t){const e=new Image;return e.src=r,t.image&&t.image.decode&&e.decode?(await e.decode(),e):await new Promise((n,i)=>{try{e.onload=()=>n(e),e.onerror=s=>i(new Error("Could not load image ".concat(r,": ").concat(s)))}catch(s){i(s)}})}const Oz={};let PT=!0;async function Dz(r,t,e){let n;eb(e)?n=await LT(r,t,e):n=FT(r,e);const i=t&&t.imagebitmap;return await Nz(n,i)}async function Nz(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((kz(t)||!PT)&&(t=null),t)try{return await createImageBitmap(r,t)}catch(e){console.warn(e),PT=!1}return await createImageBitmap(r)}function kz(r){for(const t in r||Oz)return!1;return!0}function Qz(r){return!Gz(r,"ftyp",4)||!(r[8]&96)?null:zz(r)}function zz(r){switch(Hz(r,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function Hz(r,t,e){return String.fromCharCode(...r.slice(t,e))}function Vz(r){return[...r].map(t=>t.charCodeAt(0))}function Gz(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const n=Vz(t);for(let i=0;i<n.length;++i)if(n[i]!==r[i+e])return!1;return!0}const Uc=!1,ng=!0;function rb(r){const t=ig(r);return qz(t)||Wz(t)||Kz(t)||$z(t)||jz(t)}function jz(r){const t=new Uint8Array(r instanceof DataView?r.buffer:r),e=Qz(t);return e?{mimeType:e.mimeType,width:0,height:0}:null}function qz(r){const t=ig(r);return t.byteLength>=24&&t.getUint32(0,Uc)===2303741511?{mimeType:"image/png",width:t.getUint32(16,Uc),height:t.getUint32(20,Uc)}:null}function Kz(r){const t=ig(r);return t.byteLength>=10&&t.getUint32(0,Uc)===1195984440?{mimeType:"image/gif",width:t.getUint16(6,ng),height:t.getUint16(8,ng)}:null}function $z(r){const t=ig(r);return t.byteLength>=14&&t.getUint16(0,Uc)===16973&&t.getUint32(2,ng)===t.byteLength?{mimeType:"image/bmp",width:t.getUint32(18,ng),height:t.getUint32(22,ng)}:null}function Wz(r){const t=ig(r);if(!(t.byteLength>=3&&t.getUint16(0,Uc)===65496&&t.getUint8(2)===255))return null;const{tableMarkers:n,sofMarkers:i}=Xz();let s=2;for(;s+9<t.byteLength;){const a=t.getUint16(s,Uc);if(i.has(a))return{mimeType:"image/jpeg",height:t.getUint16(s+5,Uc),width:t.getUint16(s+7,Uc)};if(!n.has(a))return null;s+=2,s+=t.getUint16(s,Uc)}return null}function Xz(){const r=new Set([65499,65476,65484,65501,65534]);for(let e=65504;e<65520;++e)r.add(e);return{tableMarkers:r,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function ig(r){if(r instanceof DataView)return r;if(ArrayBuffer.isView(r))return new DataView(r.buffer);if(r instanceof ArrayBuffer)return new DataView(r);throw new Error("toDataView")}async function Jz(r,t){const{mimeType:e}=rb(r)||{},n=globalThis._parseImageNode;return ci(n),await n(r,e)}async function Yz(r,t,e){t=t||{};const i=(t.image||{}).type||"auto",{url:s}=e||{},a=Zz(i);let o;switch(a){case"imagebitmap":o=await Dz(r,t,s);break;case"image":o=await LT(r,t,s);break;case"data":o=await Jz(r);break;default:ci(!1)}return i==="data"&&(o=Fz(o)),o}function Zz(r){switch(r){case"auto":case"data":return Tz();default:return Sz(r),r}}const MT={id:"image",module:"images",name:"Images",version:Cz,mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:Yz,tests:[r=>!!rb(new DataView(r))],options:{image:{type:"auto",decode:!0}}},nb={};function tH(r){if(nb[r]===void 0){const t=E0?rH(r):eH(r);nb[r]=t}return nb[r]}function eH(r){const t=["image/png","image/jpeg","image/gif"],{_parseImageNode:e,_imageFormatsNode:n=t}=globalThis;return!!e&&n.includes(r)}function rH(r){switch(r){case"image/avif":case"image/webp":return nH(r);default:return!0}}function nH(r){try{return document.createElement("canvas").toDataURL(r).indexOf("data:".concat(r))===0}catch{return!1}}const Tn=new rg({id:"deck"}),OA={attributeUpdateStart:-1,attributeManagerUpdateStart:-1,attributeUpdateMessages:[]},ib=1,sg=2,sb=3,ob=4,iH=2,sH=r=>({"layer.changeFlag":(t,e,n)=>{r.log(sb,"".concat(t.id," ").concat(e,": "),n[e])()},"layer.initialize":t=>{r.log(ib,"Initializing ".concat(t))()},"layer.update":(t,e)=>{if(e){const n=t.getChangeFlags();r.log(sg,"Updating ".concat(t," because: ").concat(Object.keys(n).filter(i=>n[i]).join(", ")))()}else r.log(ob,"".concat(t," does not need update"))()},"layer.matched":(t,e)=>{e&&r.log(ob,"Matched ".concat(t,", state transfered"))()},"layer.finalize":t=>{r.log(ib,"Finalizing ".concat(t))()},"compositeLayer.renderLayers":(t,e,n)=>{e?r.log(sg,"Composite layer rendered new subLayers ".concat(t),n)():r.log(ob,"Composite layer reused subLayers ".concat(t),n)()},"layerManager.setLayers":(t,e,n)=>{e&&r.log(sg,"Updating ".concat(n.length," deck layers"))()},"layerManager.activateViewport":(t,e)=>{r.log(sb,"Viewport changed",e)()},"attributeManager.invalidate":(t,e,n)=>{r.log(ib,n?"invalidated attributes ".concat(n," (").concat(e,") for ").concat(t.id):"invalidated all attributes for ".concat(t.id))()},"attributeManager.updateStart":t=>{OA.attributeUpdateMessages.length=0,OA.attributeManagerUpdateStart=Date.now()},"attributeManager.updateEnd":(t,e)=>{const n=Math.round(Date.now()-OA.attributeManagerUpdateStart);r.groupCollapsed(sg,"Updated attributes for ".concat(e," instances in ").concat(t.id," in ").concat(n,"ms"))();for(const i of OA.attributeUpdateMessages)r.log(sb,i)();r.groupEnd(sg)()},"attribute.updateStart":t=>{OA.attributeUpdateStart=Date.now()},"attribute.allocate":(t,e)=>{const n="".concat(t.id," allocated ").concat(e);OA.attributeUpdateMessages.push(n)},"attribute.updateEnd":(t,e)=>{const n=Math.round(Date.now()-OA.attributeUpdateStart),i="".concat(t.id," updated ").concat(e," in ").concat(n,"ms");OA.attributeUpdateMessages.push(i)},"deckRenderer.renderLayers":(t,e,n)=>{const{pass:i,redrawReason:s,stats:a}=n;for(const o of e){const{totalCount:d,visibleCount:f,compositeCount:_,pickableCount:w}=o,B=d-_-f;r.log(iH,"RENDER #".concat(t.renderCount,"   ").concat(f," (of ").concat(d," layers) to ").concat(i," because ").concat(s,"   (").concat(B," hidden, ").concat(_," composite ").concat(w," pickable)"))(),a&&a.get("Redraw Layers").add(f)}}});var oH={};let P0={};oH.NODE_ENV!=="production"&&(P0=sH(Tn));function aH(r){P0=r}function Ao(r,t,e,n){Tn.level>0&&P0[r]&&P0[r].call(null,t,e,n)}function lH(r){const t=r[0],e=r[r.length-1];return t==="{"&&e==="}"||t==="["&&e==="]"}const cH={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:lH,parseTextSync:JSON.parse};function uH(){const r="8.9.36",t=globalThis.deck&&globalThis.deck.VERSION;if(t&&t!==r)throw new Error("deck.gl - multiple versions detected: ".concat(t," vs ").concat(r));return t||(Tn.log(1,"deck.gl ".concat(r))(),globalThis.deck={...globalThis.deck,VERSION:r,version:r,log:Tn,_registerLoggers:aH},ZQ([cH,[MT,{imagebitmap:{premultiplyAlpha:"none"}}]])),r}const AH=uH(),Sn={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Sn,"IDENTITY",{get:()=>(Tn.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Oc={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},ab={common:0,meters:1,pixels:2},RT={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},br=new rg({id:"luma.gl"});function ko(r,t){if(!r)throw new Error(t||"luma.gl: assertion failed.")}const hH="Invalid WebGLRenderingContext",dH="Requires WebGL2";function M0(r){return typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?!0:!!(r&&Number.isFinite(r._version))}function mn(r){return typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?!0:!!(r&&r._version===2)}function fH(r){return mn(r)?r:null}function R0(r){return ko(M0(r),hH),r}function Qo(r){return ko(mn(r),dH),r}const og={};function pH(r){globalThis.console&&globalThis.console.error&&globalThis.console.error(r)}function gH(r){globalThis.console&&globalThis.console.log&&globalThis.console.log(r)}function mH(r,t){og[r]=!0,pH(t)}function yH(r){const t=r.getError;r.getError=function(){let n;do n=t.apply(r),n!==0&&(og[n]=!0);while(n!==0);for(n in og)if(og[n])return delete og[n],parseInt(n,10);return 0}}const ag=function r(t){const e=t.gl;this.ext=t,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(t.maxVertexAttribs);for(let n=0;n<this.attribs.length;n++){const i=new r.VertexAttrib(e);this.attribs[n]=i}this.maxAttrib=0};ag.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()},ag.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Dh=function(t){const e=this;this.gl=t,yH(t);const n=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(s){return s===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(s){const a=e.currentVertexArrayObject;a.maxAttrib=Math.max(a.maxAttrib,s);const o=a.attribs[s];return o.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(s){const a=e.currentVertexArrayObject;a.maxAttrib=Math.max(a.maxAttrib,s);const o=a.attribs[s];return o.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(s,a){switch(s){case 34962:e.currentArrayBuffer=a;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=a;break}return n.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(s,a){const d=e.currentVertexArrayObject.attribs[s];switch(a){case 34975:return d.buffer;case 34338:return d.enabled;case 34339:return d.size;case 34340:return d.stride;case 34341:return d.type;case 34922:return d.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(s,a,o,d,f,_){const w=e.currentVertexArrayObject;w.maxAttrib=Math.max(w.maxAttrib,s);const x=w.attribs[s];return x.buffer=e.currentArrayBuffer,x.size=a,x.type=o,x.normalized=d,x.stride=f,x.offset=_,x.recache(),n.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",()=>{gH("OESVertexArrayObject emulation library context restored"),e.reset_()},!0),this.reset_()};Dh.prototype.VERTEX_ARRAY_BINDING_OES=34229,Dh.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let n=0;n<this.vertexArrayObjects.length;++n)this.vertexArrayObjects.isAlive=!1;const e=this.gl;this.maxVertexAttribs=e.getParameter(34921),this.defaultVertexArrayObject=new ag(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},Dh.prototype.createVertexArrayOES=function(){const t=new ag(this);return this.vertexArrayObjects.push(t),t},Dh.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},Dh.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof ag&&t.hasBeenBound&&t.ext===this)},Dh.prototype.bindVertexArrayOES=function(t){const e=this.gl;if(t&&!t.isAlive){mH(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const n=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&n.bindBuffer.call(e,34963,s.elementArrayBuffer);let a=this.currentArrayBuffer;const o=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let d=0;d<=o;d++){const f=s.attribs[d],_=i?i.attribs[d]:null;if((!i||f.enabled!==_.enabled)&&(f.enabled?n.enableVertexAttribArray.call(e,d):n.disableVertexAttribArray.call(e,d)),f.enabled){let w=!1;(!i||f.buffer!==_.buffer)&&(a!==f.buffer&&(n.bindBuffer.call(e,34962,f.buffer),a=f.buffer),w=!0),(w||f.cached!==_.cached)&&n.vertexAttribPointer.call(e,d,f.size,f.type,f.normalized,f.stride,f.offset)}}this.currentArrayBuffer!==a&&n.bindBuffer.call(e,34962,this.currentArrayBuffer)};function _H(r){if(typeof r.createVertexArray=="function")return;const t=r.getSupportedExtensions;r.getSupportedExtensions=function(){const i=t.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const e=r.getExtension;r.getExtension=function(i){const s=e.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(r.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Dh(this)),this.__OESVertexArrayObject))}}const UT="OES_element_index",OT="WEBGL_draw_buffers",vH="EXT_disjoint_timer_query",bH="EXT_disjoint_timer_query_webgl2",wH="EXT_texture_filter_anisotropic",DT="WEBGL_debug_renderer_info",xH=35723,BH=4352,CH=36795,EH=34047,SH=37445,TH=37446,di=r=>mn(r)?void 0:0,IH={3074:r=>mn(r)?void 0:36064,[xH]:r=>mn(r)?void 0:BH,35977:di,32937:di,[CH]:(r,t)=>{const e=mn(r)?r.getExtension(bH):r.getExtension(vH);return e&&e.GPU_DISJOINT_EXT?t(e.GPU_DISJOINT_EXT):0},[SH]:(r,t)=>{const e=r.getExtension(DT);return t(e&&e.UNMASKED_VENDOR_WEBGL||7936)},[TH]:(r,t)=>{const e=r.getExtension(DT);return t(e&&e.UNMASKED_RENDERER_WEBGL||7937)},[EH]:(r,t)=>{const e=r.luma.extensions[wH];return e?t(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:di,35071:di,37447:di,36063:(r,t)=>{if(!mn(r)){const e=r.getExtension(OT);return e?t(e.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:di,35374:di,35377:di,34852:r=>{if(!mn(r)){const t=r.getExtension(OT);return t?t.MAX_DRAW_BUFFERS_WEBGL:0}},36203:r=>r.getExtension(UT)?2147483647:65535,33001:r=>r.getExtension(UT)?16777216:65535,33e3:r=>16777216,37157:di,35373:di,35657:di,36183:di,37137:di,34045:di,35978:di,35979:di,35968:di,35376:di,35375:di,35659:di,37154:di,35371:di,35658:di,35076:di,35077:di,35380:di};function FH(r,t,e){const n=IH[e],i=typeof n=="function"?n(r,t,e):n;return i!==void 0?i:t(e)}const LH="OES_vertex_array_object",NT="ANGLE_instanced_arrays",PH="WEBGL_draw_buffers",MH="EXT_disjoint_timer_query",RH="EXT_texture_filter_anisotropic",UH="VertexArray requires WebGL2 or OES_vertex_array_object extension";function OH(r,t){return{webgl2:mn(r),ext:r.getExtension(t)}}const kT={[LH]:{meta:{suffix:"OES"},createVertexArray:()=>{ko(!1,UH)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[NT]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(r,t){ko(t===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[PH]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{ko(!1)}},[MH]:{meta:{suffix:"EXT"},createQuery:()=>{ko(!1)},deleteQuery:()=>{ko(!1)},beginQuery:()=>{ko(!1)},endQuery:()=>{},getQuery(r,t){return this.getQueryObject(r,t)},getQueryParameter(r,t){return this.getQueryObject(r,t)},getQueryObject:()=>{}}},lb={readBuffer:(r,t,e)=>{mn(r)&&t(e)},getVertexAttrib:(r,t,e,n)=>{const{webgl2:i,ext:s}=OH(r,NT);let a;switch(n){case 35069:a=i?void 0:!1;break;case 35070:a=!i&&!s?0:void 0;break}return a!==void 0?a:t(e,n)},getProgramParameter:(r,t,e,n)=>{if(!mn(r))switch(n){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return t(e,n)},getInternalformatParameter:(r,t,e,n,i)=>{if(!mn(r))switch(i){case 32937:return new Int32Array([0])}return r.getInternalformatParameter(e,n,i)},getTexParameter(r,t,e,n){switch(n){case 34046:const{extensions:i}=r.luma,s=i[RH];n=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return t(e,n)},getParameter:FH,hint(r,t,e,n){return t(e,n)}};function DH(r){r.luma=r.luma||{};const{luma:t}=r;return t.polyfilled||(_H(r),NH(r),QH(r,kT),kH(r,{target:t,target2:r}),t.polyfilled=!0),r}globalThis.polyfillContext=DH;function NH(r){r.luma.extensions={};const t=r.getSupportedExtensions()||[];for(const e of t)r.luma[e]=r.getExtension(e)}function kH(r,t){let{target:e,target2:n}=t;Object.keys(lb).forEach(i=>{if(typeof lb[i]=="function"){const s=r[i]?r[i].bind(r):()=>{},a=lb[i].bind(null,r,s);e[i]=a,n[i]=a}})}function QH(r,t){for(const e of Object.getOwnPropertyNames(t))e!=="overrides"&&zH(r,{extension:e,target:r.luma,target2:r})}function zH(r,t){let{extension:e,target:n,target2:i}=t;const s=kT[e];ko(s);const{meta:a={}}=s,{suffix:o=""}=a,d=r.getExtension(e);for(const f of Object.keys(s)){const _="".concat(f).concat(o);let w=null;f==="meta"||typeof r[f]=="function"||(d&&typeof d[_]=="function"?w=function(){return d[_](...arguments)}:typeof s[f]=="function"&&(w=s[f].bind(n))),w&&(n[f]=w,i[f]=w)}}const cb={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},DA=(r,t,e)=>t?r.enable(e):r.disable(e),QT=(r,t,e)=>r.hint(e,t),Ra=(r,t,e)=>r.pixelStorei(e,t),HH=(r,t)=>{const e=mn(r)?36009:36160;return r.bindFramebuffer(e,t)},VH=(r,t)=>r.bindFramebuffer(36008,t);function lg(r){return Array.isArray(r)||ArrayBuffer.isView(r)}const GH={3042:DA,32773:(r,t)=>r.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(r,t)=>r.clearColor(...t),3107:(r,t)=>r.colorMask(...t),2884:DA,2885:(r,t)=>r.cullFace(t),2929:DA,2931:(r,t)=>r.clearDepth(t),2932:(r,t)=>r.depthFunc(t),2928:(r,t)=>r.depthRange(...t),2930:(r,t)=>r.depthMask(t),3024:DA,35723:QT,36006:HH,2886:(r,t)=>r.frontFace(t),33170:QT,2849:(r,t)=>r.lineWidth(t),32823:DA,32824:"polygonOffset",10752:"polygonOffset",35977:DA,32938:"sampleCoverage",32939:"sampleCoverage",3089:DA,3088:(r,t)=>r.scissor(...t),2960:DA,2961:(r,t)=>r.clearStencil(t),2968:(r,t)=>r.stencilMaskSeparate(1028,t),36005:(r,t)=>r.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(r,t)=>r.viewport(...t),3333:Ra,3317:Ra,37440:Ra,37441:Ra,37443:Ra,3330:Ra,3332:Ra,3331:Ra,36010:VH,3314:Ra,32878:Ra,3316:Ra,3315:Ra,32877:Ra,framebuffer:(r,t)=>{const e=t&&"handle"in t?t.handle:t;return r.bindFramebuffer(36160,e)},blend:(r,t)=>t?r.enable(3042):r.disable(3042),blendColor:(r,t)=>r.blendColor(...t),blendEquation:(r,t)=>{t=lg(t)?t:[t,t],r.blendEquationSeparate(...t)},blendFunc:(r,t)=>{t=lg(t)&&t.length===2?[...t,...t]:t,r.blendFuncSeparate(...t)},clearColor:(r,t)=>r.clearColor(...t),clearDepth:(r,t)=>r.clearDepth(t),clearStencil:(r,t)=>r.clearStencil(t),colorMask:(r,t)=>r.colorMask(...t),cull:(r,t)=>t?r.enable(2884):r.disable(2884),cullFace:(r,t)=>r.cullFace(t),depthTest:(r,t)=>t?r.enable(2929):r.disable(2929),depthFunc:(r,t)=>r.depthFunc(t),depthMask:(r,t)=>r.depthMask(t),depthRange:(r,t)=>r.depthRange(...t),dither:(r,t)=>t?r.enable(3024):r.disable(3024),derivativeHint:(r,t)=>{r.hint(35723,t)},frontFace:(r,t)=>r.frontFace(t),mipmapHint:(r,t)=>r.hint(33170,t),lineWidth:(r,t)=>r.lineWidth(t),polygonOffsetFill:(r,t)=>t?r.enable(32823):r.disable(32823),polygonOffset:(r,t)=>r.polygonOffset(...t),sampleCoverage:(r,t)=>r.sampleCoverage(...t),scissorTest:(r,t)=>t?r.enable(3089):r.disable(3089),scissor:(r,t)=>r.scissor(...t),stencilTest:(r,t)=>t?r.enable(2960):r.disable(2960),stencilMask:(r,t)=>{t=lg(t)?t:[t,t];const[e,n]=t;r.stencilMaskSeparate(1028,e),r.stencilMaskSeparate(1029,n)},stencilFunc:(r,t)=>{t=lg(t)&&t.length===3?[...t,...t]:t;const[e,n,i,s,a,o]=t;r.stencilFuncSeparate(1028,e,n,i),r.stencilFuncSeparate(1029,s,a,o)},stencilOp:(r,t)=>{t=lg(t)&&t.length===3?[...t,...t]:t;const[e,n,i,s,a,o]=t;r.stencilOpSeparate(1028,e,n,i),r.stencilOpSeparate(1029,s,a,o)},viewport:(r,t)=>r.viewport(...t)};function Ui(r,t,e){return t[r]!==void 0?t[r]:e[r]}const jH={blendEquation:(r,t,e)=>r.blendEquationSeparate(Ui(32777,t,e),Ui(34877,t,e)),blendFunc:(r,t,e)=>r.blendFuncSeparate(Ui(32969,t,e),Ui(32968,t,e),Ui(32971,t,e),Ui(32970,t,e)),polygonOffset:(r,t,e)=>r.polygonOffset(Ui(32824,t,e),Ui(10752,t,e)),sampleCoverage:(r,t,e)=>r.sampleCoverage(Ui(32938,t,e),Ui(32939,t,e)),stencilFuncFront:(r,t,e)=>r.stencilFuncSeparate(1028,Ui(2962,t,e),Ui(2967,t,e),Ui(2963,t,e)),stencilFuncBack:(r,t,e)=>r.stencilFuncSeparate(1029,Ui(34816,t,e),Ui(36003,t,e),Ui(36004,t,e)),stencilOpFront:(r,t,e)=>r.stencilOpSeparate(1028,Ui(2964,t,e),Ui(2965,t,e),Ui(2966,t,e)),stencilOpBack:(r,t,e)=>r.stencilOpSeparate(1029,Ui(34817,t,e),Ui(34818,t,e),Ui(34819,t,e))},zT={enable:(r,t)=>r({[t]:!0}),disable:(r,t)=>r({[t]:!1}),pixelStorei:(r,t,e)=>r({[t]:e}),hint:(r,t,e)=>r({[t]:e}),bindFramebuffer:(r,t,e)=>{switch(t){case 36160:return r({36006:e,36010:e});case 36009:return r({36006:e});case 36008:return r({36010:e});default:return null}},blendColor:(r,t,e,n,i)=>r({32773:new Float32Array([t,e,n,i])}),blendEquation:(r,t)=>r({32777:t,34877:t}),blendEquationSeparate:(r,t,e)=>r({32777:t,34877:e}),blendFunc:(r,t,e)=>r({32969:t,32968:e,32971:t,32970:e}),blendFuncSeparate:(r,t,e,n,i)=>r({32969:t,32968:e,32971:n,32970:i}),clearColor:(r,t,e,n,i)=>r({3106:new Float32Array([t,e,n,i])}),clearDepth:(r,t)=>r({2931:t}),clearStencil:(r,t)=>r({2961:t}),colorMask:(r,t,e,n,i)=>r({3107:[t,e,n,i]}),cullFace:(r,t)=>r({2885:t}),depthFunc:(r,t)=>r({2932:t}),depthRange:(r,t,e)=>r({2928:new Float32Array([t,e])}),depthMask:(r,t)=>r({2930:t}),frontFace:(r,t)=>r({2886:t}),lineWidth:(r,t)=>r({2849:t}),polygonOffset:(r,t,e)=>r({32824:t,10752:e}),sampleCoverage:(r,t,e)=>r({32938:t,32939:e}),scissor:(r,t,e,n,i)=>r({3088:new Int32Array([t,e,n,i])}),stencilMask:(r,t)=>r({2968:t,36005:t}),stencilMaskSeparate:(r,t,e)=>r({[t===1028?2968:36005]:e}),stencilFunc:(r,t,e,n)=>r({2962:t,2967:e,2963:n,34816:t,36003:e,36004:n}),stencilFuncSeparate:(r,t,e,n,i)=>r({[t===1028?2962:34816]:e,[t===1028?2967:36003]:n,[t===1028?2963:36004]:i}),stencilOp:(r,t,e,n)=>r({2964:t,2965:e,2966:n,34817:t,34818:e,34819:n}),stencilOpSeparate:(r,t,e,n,i)=>r({[t===1028?2964:34817]:e,[t===1028?2965:34818]:n,[t===1028?2966:34819]:i}),viewport:(r,t,e,n,i)=>r({2978:[t,e,n,i]})},Dc=(r,t)=>r.isEnabled(t),HT={3042:Dc,2884:Dc,2929:Dc,3024:Dc,32823:Dc,32926:Dc,32928:Dc,3089:Dc,2960:Dc,35977:Dc};function VT(r){for(const t in r)return!1;return!0}function qH(r,t){if(r===t)return!0;const e=Array.isArray(r)||ArrayBuffer.isView(r),n=Array.isArray(t)||ArrayBuffer.isView(t);if(e&&n&&r.length===t.length){for(let i=0;i<r.length;++i)if(r[i]!==t[i])return!1;return!0}return!1}function GT(r,t){const e=r[t].bind(r);r[t]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in r.state.cache?r.state.enable?r.state.cache[i]:e(...arguments):e(...arguments)},Object.defineProperty(r[t],"name",{value:"".concat(t,"-from-cache"),configurable:!1})}function KH(r,t,e){const n=r[t].bind(r);r[t]=function(){for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];const{valueChanged:d,oldValue:f}=e(r.state._updateCache,...a);return d&&n(...a),f},Object.defineProperty(r[t],"name",{value:"".concat(t,"-to-cache"),configurable:!1})}function $H(r){const t=r.useProgram.bind(r);r.useProgram=function(n){r.state.program!==n&&(t(n),r.state.program=n)}}class WH{constructor(t){let{copyState:e=!1,log:n=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=t,this.program=null,this.stateStack=[],this.enable=!0,this.cache=e?JH(t):Object.assign({},cb),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){ko(this.stateStack.length>0);const t=this.stateStack[this.stateStack.length-1];Nu(this.gl,t),this.stateStack.pop()}_updateCache(t){let e=!1,n;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in t){ko(s!==void 0);const a=t[s],o=this.cache[s];qH(a,o)||(e=!0,n=o,i&&!(s in i)&&(i[s]=o),this.cache[s]=a)}return{valueChanged:e,oldValue:n}}}function jT(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:e=!0,copyState:n}=t;if(ko(n!==void 0),!r.state){const{polyfillContext:i}=globalThis;i&&i(r),r.state=new WH(r,{copyState:n}),$H(r);for(const s in zT){const a=zT[s];KH(r,s,a)}GT(r,"getParameter"),GT(r,"isEnabled")}return r.state.enable=e,r}function XH(r){r.state||jT(r,{copyState:!1}),r.state.push()}function qT(r){ko(r.state),r.state.pop()}function Nu(r,t){if(ko(M0(r),"setParameters requires a WebGL context"),VT(t))return;const e={};for(const i in t){const s=Number(i),a=GH[i];a&&(typeof a=="string"?e[a]=!0:a(r,t[i],s))}const n=r.state&&r.state.cache;if(n)for(const i in e){const s=jH[i];s(r,t,n)}}function JH(r,t){if(t=t||cb,typeof t=="number"){const i=t,s=HT[i];return s?s(r,i):r.getParameter(i)}const e=Array.isArray(t)?t:Object.keys(t),n={};for(const i of e){const s=HT[i];n[i]=s?s(r,Number(i)):r.getParameter(Number(i))}return n}function YH(r){Nu(r,cb)}function ql(r,t,e){if(VT(t))return e(r);const{nocatch:n=!0}=t;XH(r),Nu(r,t);let i;if(n)i=e(r),qT(r);else try{i=e(r)}finally{qT(r)}return i}function Zd(r){const{luma:t}=r;if(r.canvas&&t){const e=t.canvasSizeInfo,n="clientWidth"in e?e.clientWidth:r.canvas.clientWidth;return n?r.drawingBufferWidth/n:1}return 1}function ub(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=Zd(r),i=r.drawingBufferWidth,s=r.drawingBufferHeight;return t7(t,n,i,s,e)}function ZH(r){const t=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(r)?r<=0?1:r:r?t:1}function t7(r,t,e,n,i){const s=KT(r[0],t,e);let a=$T(r[1],t,n,i),o=KT(r[0]+1,t,e);const d=o===e-1?o:o-1;o=$T(r[1]+1,t,n,i);let f;return i?(o=o===0?o:o+1,f=a,a=o):f=o===n-1?o:o-1,{x:s,y:a,width:Math.max(d-s+1,1),height:Math.max(f-a+1,1)}}function KT(r,t,e){return Math.min(Math.round(r*t),e-1)}function $T(r,t,e,n){return n?Math.max(0,e-1-Math.round(r*t)):Math.min(Math.round(r*t),e-1)}const Ab=Du(),e7=Ab&&typeof document<"u",WT={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function XT(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ko(Ab,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),r=Object.assign({},WT,r);const{width:t,height:e}=r;function n(o){if(r.throwOnError)throw new Error(o);return console.error(o),null}r.onError=n;let i;const{canvas:s}=r,a=s7({canvas:s,width:t,height:e,onError:n});return i=i7(a,r),i?(i=hb(i,r),o7(i),i):null}function hb(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!r||r._instrumented)return r;r._version=r._version||a7(r),r.luma=r.luma||{},r.luma.canvasSizeInfo=r.luma.canvasSizeInfo||{},t=Object.assign({},WT,t);const{manageState:e,debug:n}=t;return e&&jT(r,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return br.log(1,...s)()}}),Ab&&n&&(globalThis.makeDebugContext?(r=globalThis.makeDebugContext(r,t),br.level=Math.max(br.level,1)):br.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),r._instrumented=!0,r}function r7(r){const t=r.getParameter(7936),e=r.getParameter(7937),n=r.getExtension("WEBGL_debug_renderer_info"),i=n&&r.getParameter(n.UNMASKED_VENDOR_WEBGL||7936),s=n&&r.getParameter(n.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||t,renderer:s||e,vendorMasked:t,rendererMasked:e,version:r.getParameter(7938),shadingLanguageVersion:r.getParameter(35724)}}function n7(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r.canvas){const n=ZH(t.useDevicePixels);l7(r,n,t);return}const e=r.getExtension("STACKGL_resize_drawingbuffer");e&&"width"in t&&"height"in t&&e.resize(t.width,t.height)}function i7(r,t){const{onError:e}=t;let n=null;const i=d=>n=d.statusMessage||n;r.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:a=!0}=t;let o=null;return a&&(o=o||r.getContext("webgl2",t),o=o||r.getContext("experimental-webgl2",t)),s&&(o=o||r.getContext("webgl",t),o=o||r.getContext("experimental-webgl",t)),r.removeEventListener("webglcontextcreationerror",i,!1),o?(t.onContextLost&&r.addEventListener("webglcontextlost",t.onContextLost,!1),t.onContextRestored&&r.addEventListener("webglcontextrestored",t.onContextRestored,!1),o):e("Failed to create ".concat(a&&!s?"WebGL2":"WebGL"," context: ").concat(n||"Unknown error"))}function s7(r){let{canvas:t,width:e=800,height:n=600,onError:i}=r,s;return typeof t=="string"?(e7&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(t,"' before page was loaded")),s=document.getElementById(t)):t?s=t:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(e)?"".concat(e,"px"):"100%",s.style.height=Number.isFinite(n)?"".concat(n,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function o7(r){const t=mn(r)?"WebGL2":"WebGL1",e=r7(r),n=e?"(".concat(e.vendor,",").concat(e.renderer,")"):"",i=r.debug?" debug":"";br.info(1,"".concat(t).concat(i," context ").concat(n))()}function a7(r){return typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?2:1}function l7(r,t,e){let n="width"in e?e.width:r.canvas.clientWidth,i="height"in e?e.height:r.canvas.clientHeight;(!n||!i)&&(br.log(1,"Canvas clientWidth/clientHeight is 0")(),t=1,n=r.canvas.width||1,i=r.canvas.height||1),r.luma=r.luma||{},r.luma.canvasSizeInfo=r.luma.canvasSizeInfo||{};const s=r.luma.canvasSizeInfo;if(s.clientWidth!==n||s.clientHeight!==i||s.devicePixelRatio!==t){let a=t;const o=Math.floor(n*a),d=Math.floor(i*a);r.canvas.width=o,r.canvas.height=d,(r.drawingBufferWidth!==o||r.drawingBufferHeight!==d)&&(br.warn("Device pixel ratio clamped")(),a=Math.min(r.drawingBufferWidth/n,r.drawingBufferHeight/i),r.canvas.width=Math.floor(n*a),r.canvas.height=Math.floor(i*a)),Object.assign(r.luma.canvasSizeInfo,{clientWidth:n,clientHeight:i,devicePixelRatio:t})}}const cg="8.5.21",c7="set luma.log.level=1 (or higher) to trace rendering";class u7{constructor(){this.stats=new Map}get(t){return this.stats.has(t)||this.stats.set(t,new Yp({id:t})),this.stats.get(t)}}const Nh=new u7;if(globalThis.luma&&globalThis.luma.VERSION!==cg)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(cg));globalThis.luma||(Du()&&br.log(1,"luma.gl ".concat(cg," - ").concat(c7))(),globalThis.luma=globalThis.luma||{VERSION:cg,version:cg,log:br,stats:Nh,globals:{modules:{},nodeIO:{}}});function A7(r){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(r):setTimeout(r,1e3/60)}function h7(r){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(r):clearTimeout(r)}function rr(r,t){if(!r)throw new Error(t||"luma.gl: assertion failed.")}function db(r,t){if(typeof t!="string")return t;const e=Number(t);if(!isNaN(e))return e;t=t.replace(/^.*\./,"");const n=r[t];return rr(n!==void 0,"Accessing undefined constant GL.".concat(t)),n}function NA(r,t){t=Number(t);for(const e in r)if(r[e]===t)return"GL.".concat(e);return String(t)}const fb={};function ku(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";fb[r]=fb[r]||1;const t=fb[r]++;return"".concat(r,"-").concat(t)}function JT(r){return rr(typeof r=="number","Input must be a number"),r&&(r&r-1)===0}function tf(r){let t=!0;for(const e in r){t=!1;break}return t}function YT(r,t,e,n){const i="See luma.gl ".concat(e," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(r);n.forEach(a=>{s.methodName||(s[a]=()=>{throw br.removed("Calling removed method ".concat(t,".").concat(a,": "),i)(),new Error(a)})})}const ef="Resource subclass must define virtual methods";let Qu=class{get[Symbol.toStringTag](){return"Resource"}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};R0(t);const{id:n,userData:i={}}=e;this.gl=t,this.gl2=t,this.id=n||ku(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=e.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:t=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,e&&t&&e.filter(Boolean).forEach(n=>n.delete()),this}bind(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof t!="function")return this._bindHandle(t),this;let e;return this._bound?e=t():(this._bindHandle(this.handle),this._bound=!0,e=t(),this._bound=!1,this._bindHandle(null)),e}unbind(){this.bind(null)}getParameter(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t=db(this.gl,t),rr(t);const i=(this.constructor.PARAMETERS||{})[t];if(i){const s=mn(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const o=i.webgl1,d="webgl2"in i?i.webgl2:i.webgl1;return s?d:o}}return this._getParameter(t,e)}getParameters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:e,keys:n}=t,i=this.constructor.PARAMETERS||{},s=mn(this.gl),a={},o=e||Object.keys(i);for(const d of o){const f=i[d];if(f&&(!("webgl2"in f)||s)&&(!("extension"in f)||this.gl.getExtension(f.extension))){const w=n?NA(this.gl,d):d;a[w]=this.getParameter(d,t),n&&f.type==="GLenum"&&(a[w]=NA(this.gl,a[w]))}}return a}setParameter(t,e){t=db(this.gl,t),rr(t);const i=(this.constructor.PARAMETERS||{})[t];if(i){const s=mn(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(e=db(e))}return this._setParameter(t,e),this}setParameters(t){for(const e in t)this.setParameter(e,t[e]);return this}stubRemovedMethods(t,e,n){return YT(this,t,e,n)}initialize(t){}_createHandle(){throw new Error(ef)}_deleteHandle(){throw new Error(ef)}_bindHandle(t){throw new Error(ef)}_getOptsFromHandle(){throw new Error(ef)}_getParameter(t,e){throw new Error(ef)}_setParameter(t,e){throw new Error(ef)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const t=this[Symbol.toStringTag],e=Nh.get("Resource Counts");e.get("Resources Created").incrementCount(),e.get("".concat(t,"s Created")).incrementCount(),e.get("".concat(t,"s Active")).incrementCount()}_removeStats(){const t=this[Symbol.toStringTag];Nh.get("Resource Counts").get("".concat(t,"s Active")).decrementCount()}_trackAllocatedMemory(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(t,e),this._trackAllocatedMemoryForContext(t,e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=t}_trackAllocatedMemoryForContext(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=Nh.get("Memory Usage".concat(n));i.get("GPU Memory").addCount(t),i.get("".concat(e," Memory")).addCount(t)}_trackDeallocatedMemory(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(t),this._trackDeallocatedMemoryForContext(t,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=Nh.get("Memory Usage".concat(e));n.get("GPU Memory").subtractCount(this.byteLength),n.get("".concat(t," Memory")).subtractCount(this.byteLength)}};const d7="Failed to deduce GL constant from typed array";function pb(r){switch(ArrayBuffer.isView(r)?r.constructor:r){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(d7)}}function ug(r){let{clamped:t=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(r){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return t?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function f7(r){let{data:t,width:e,height:n,bytesPerPixel:i=4,temp:s}=r;const a=e*i;s=s||new Uint8Array(a);for(let o=0;o<n/2;++o){const d=o*a,f=(n-o-1)*a;s.set(t.subarray(d,d+a)),t.copyWithin(d,f,f+a),t.set(s,f)}}function p7(r){let{data:t,width:e,height:n}=r;const i=Math.round(e/2),s=Math.round(n/2),a=new Uint8Array(i*s*4);for(let o=0;o<s;o++)for(let d=0;d<i;d++)for(let f=0;f<4;f++)a[(o*i+d)*4+f]=t[(o*2*e+d*2)*4+f];return{data:a,width:i,height:s}}function gb(r,t,e){const{removedProps:n={},deprecatedProps:i={},replacedProps:s={}}=e;for(const o in n)if(o in t){const f=n[o]?"".concat(r,".").concat(n[o]):"N/A";br.removed("".concat(r,".").concat(o),f)()}for(const o in i)if(o in t){const d=i[o];br.deprecated("".concat(r,".").concat(o),"".concat(r,".").concat(d))()}let a=null;for(const o in s)if(o in t){const d=s[o];br.deprecated("".concat(r,".").concat(o),"".concat(r,".").concat(d))(),a=a||Object.assign({},t),a[d]=t[o],delete a[o]}return a||t}const g7={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},m7={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class ca{static getBytesPerElement(t){return ug(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){return rr(t.size),ug(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new ca(g7,...e)}constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return ca.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return ca.getBytesPerVertex(this)}_assign(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t=gb("Accessor",t,m7),t.type!==void 0&&(this.type=t.type,(t.type===5124||t.type===5125)&&(this.integer=!0)),t.size!==void 0&&(this.size=t.size),t.offset!==void 0&&(this.offset=t.offset),t.stride!==void 0&&(this.stride=t.stride),t.normalized!==void 0&&(this.normalized=t.normalized),t.integer!==void 0&&(this.integer=t.integer),t.divisor!==void 0&&(this.divisor=t.divisor),t.buffer!==void 0&&(this.buffer=t.buffer),t.index!==void 0&&(typeof t.index=="boolean"?this.index=t.index?1:0:this.index=t.index),t.instanced!==void 0&&(this.divisor=t.instanced?1:0),t.isInstanced!==void 0&&(this.divisor=t.isInstanced?1:0),this}}const ZT=10,t5={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},y7={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:t5},_7={removedProps:t5};let ni=class extends Qu{get[Symbol.toStringTag](){return"Buffer"}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t,e),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=e.target||(this.gl.webgl2?36662:34962),this.initialize(e),Object.seal(this)}getElementCount(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/ca.getBytesPerElement(t))}getVertexCount(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/ca.getBytesPerVertex(t))}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t=gb("Buffer",t,y7),this.usage=t.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},t,t.accessor)),t.data?this._setData(t.data,t.offset,t.byteLength):this._setByteLength(t.byteLength||0),this}setProps(t){return t=gb("Buffer",t,_7),"accessor"in t&&this.setAccessor(t.accessor),this}setAccessor(t){return t=Object.assign({},t),delete t.buffer,this.accessor=new ca(t),this}reallocate(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}setData(t){return this.initialize(t)}subData(t){ArrayBuffer.isView(t)&&(t={data:t});const{data:e,offset:n=0,srcOffset:i=0}=t,s=t.byteLength||t.length;rr(e);const a=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(a,this.handle),i!==0||s!==void 0?(Qo(this.gl),this.gl.bufferSubData(this.target,n,e,i,s)):this.gl.bufferSubData(a,n,e),this.gl.bindBuffer(a,null),this.debugData=null,this._inferType(e),this}copyData(t){let{sourceBuffer:e,readOffset:n=0,writeOffset:i=0,size:s}=t;const{gl:a}=this;return Qo(a),a.bindBuffer(36662,e.handle),a.bindBuffer(36663,this.handle),a.copyBufferSubData(36662,36663,n,i,s),a.bindBuffer(36662,null),a.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:t=null,srcByteOffset:e=0,dstOffset:n=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Qo(this.gl);const s=ug(this.accessor.type||5126,{clamped:!1}),a=this._getAvailableElementCount(e),o=n;let d,f;t?(f=t.length,d=f-o):(d=Math.min(a,i||a),f=o+d);const _=Math.min(a,d);return i=i||_,rr(i<=_),t=t||new s(f),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,t,n,i),this.gl.bindBuffer(36662,null),t}bind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index,offset:n=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t===35345||t===35982?i!==void 0?this.gl.bindBufferRange(t,e,this.handle,n,i):(rr(n===0),this.gl.bindBufferBase(t,e,this.handle)):this.gl.bindBuffer(t,this.handle),this}unbind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t===35345||t===35982?this.gl.bindBufferBase(t,e,null):this.gl.bindBuffer(t,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(ZT,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.byteLength+e;rr(ArrayBuffer.isView(t)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.usage),this.gl.bufferSubData(i,e,t),this.gl.bindBuffer(i,null),this.debugData=t.slice(0,ZT),this.bytesUsed=n,this._trackAllocatedMemory(n);const s=pb(t);return rr(s),this.setAccessor(new ca(this.accessor,{type:s})),this}_setByteLength(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;rr(t>=0),this._trackDeallocatedMemory();let n=t;t===0&&(n=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,e),this.gl.bindBuffer(i,null),this.usage=e,this.debugData=null,this.bytesUsed=t,this._trackAllocatedMemory(t),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(t){const e=ug(this.accessor.type||5126,{clamped:!1}),n=t/e.BYTES_PER_ELEMENT;return this.getElementCount()-n}_inferType(t){this.accessor.type||this.setAccessor(new ca(this.accessor,{type:pb(t)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(t){this.gl.bindBuffer(this.target,this.handle);const e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}get type(){return br.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return br.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(t){return br.deprecated("setByteLength","reallocate")(),this.reallocate(t)}updateAccessor(t){return br.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new ca(this.accessor,t),this}};const mb={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},e5={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},r5={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function v7(r,t){const e=mb[t];if(!e)return!1;if(e.gl1===void 0&&e.gl2===void 0)return!0;const n=mn(r)&&e.gl2||e.gl1;return typeof n=="string"?r.getExtension(n):n}function b7(r,t){const e=mb[t];switch(e&&e.types[0]){case 5126:return r.getExtension("OES_texture_float_linear");case 5131:return r.getExtension("OES_texture_half_float_linear");default:return!0}}const w7=[9729,9728],n5=globalThis.WebGLBuffer||function(){};class rf extends Qu{get[Symbol.toStringTag](){return"Texture"}static isSupported(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:n,linearFiltering:i}=e;let s=!0;return n&&(s=s&&v7(t,n),s=s&&(!i||b7(t,n))),s}constructor(t,e){const{id:n=ku("texture"),handle:i,target:s}=e;super(t,{id:n,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.data;if(e instanceof Promise)return e.then(V=>this.initialize(Object.assign({},t,{pixels:V,data:V}))),this;const n=typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement;if(n&&e.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,e.addEventListener("loadeddata",()=>this.initialize(t)),this;const{pixels:i=null,format:s=6408,border:a=0,recreate:o=!1,parameters:d={},pixelStore:f={},textureUnit:_=void 0}=t;e||(e=i);let{width:w,height:x,dataFormat:B,type:P,compressed:R=!1,mipmaps:N=!0}=t;const{depth:Q=0}=t;return{width:w,height:x,compressed:R,dataFormat:B,type:P}=this._deduceParameters({format:s,type:P,dataFormat:B,compressed:R,data:e,width:w,height:x}),this.width=w,this.height=x,this.depth=Q,this.format=s,this.type=P,this.dataFormat=B,this.border=a,this.textureUnit=_,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),N&&this._isNPOT()&&(br.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),N=!1,this._updateForNPOT(d)),this.mipmaps=N,this.setImageData({data:e,width:w,height:x,depth:Q,format:s,type:P,dataFormat:B,border:a,mipmaps:N,parameters:f,compressed:R}),N&&this.generateMipmap(),this.setParameters(d),o&&(this.data=e),n&&(this._video={video:e,parameters:d,lastTime:e.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?e.currentTime:-1}),this}update(){if(this._video){const{video:t,parameters:e,lastTime:n}=this._video;if(n===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}resize(t){let{height:e,width:n,mipmaps:i=!1}=t;return n!==this.width||e!==this.height?this.initialize({width:n,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(br.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),ql(this.gl,t,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(t){this._trackDeallocatedMemory("Texture");const{target:e=this.target,pixels:n=null,level:i=0,format:s=this.format,border:a=this.border,offset:o=0,parameters:d={}}=t;let{data:f=null,type:_=this.type,width:w=this.width,height:x=this.height,dataFormat:B=this.dataFormat,compressed:P=!1}=t;f||(f=n),{type:_,dataFormat:B,compressed:P,width:w,height:x}=this._deduceParameters({format:s,type:_,dataFormat:B,compressed:P,data:f,width:w,height:x});const{gl:R}=this;R.bindTexture(this.target,this.handle);let N=null;({data:f,dataType:N}=this._getDataType({data:f,compressed:P}));let Q,V=0;if(ql(this.gl,d,()=>{switch(N){case"null":R.texImage2D(e,i,s,w,x,a,B,_,f);break;case"typed-array":R.texImage2D(e,i,s,w,x,a,B,_,f,o);break;case"buffer":Q=Qo(R),Q.bindBuffer(35052,f.handle||f),Q.texImage2D(e,i,s,w,x,a,B,_,o),Q.bindBuffer(35052,null);break;case"browser-object":mn(R)?R.texImage2D(e,i,s,w,x,a,B,_,f):R.texImage2D(e,i,s,B,_,f);break;case"compressed":for(const[W,et]of f.entries())R.compressedTexImage2D(e,W,et.format,et.width,et.height,a,et.data),V+=et.levelSize;break;default:rr(!1,"Unknown image data type")}}),N==="compressed")this._trackAllocatedMemory(V,"Texture");else if(f&&f.byteLength)this._trackAllocatedMemory(f.byteLength,"Texture");else{const W=e5[this.dataFormat]||4,et=r5[this.type]||1;this._trackAllocatedMemory(this.width*this.height*W*et,"Texture")}return this.loaded=!0,this}setSubImageData(t){let{target:e=this.target,pixels:n=null,data:i=null,x:s=0,y:a=0,width:o=this.width,height:d=this.height,level:f=0,format:_=this.format,type:w=this.type,dataFormat:x=this.dataFormat,compressed:B=!1,offset:P=0,border:R=this.border,parameters:N={}}=t;if({type:w,dataFormat:x,compressed:B,width:o,height:d}=this._deduceParameters({format:_,type:w,dataFormat:x,compressed:B,data:i,width:o,height:d}),rr(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=n),i&&i.data){const Q=i;i=Q.data,o=Q.shape[0],d=Q.shape[1]}i instanceof ni&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),ql(this.gl,N,()=>{if(B)this.gl.compressedTexSubImage2D(e,f,s,a,o,d,_,i);else if(i===null)this.gl.texSubImage2D(e,f,s,a,o,d,x,w,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(e,f,s,a,o,d,x,w,i,P);else if(i instanceof n5){const Q=Qo(this.gl);Q.bindBuffer(35052,i),Q.texSubImage2D(e,f,s,a,o,d,x,w,P),Q.bindBuffer(35052,null)}else mn(this.gl)?Qo(this.gl).texSubImage2D(e,f,s,a,o,d,x,w,i):this.gl.texSubImage2D(e,f,s,a,x,w,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return br.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:e}=this;return t!==void 0&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:e}=this;return t!==void 0&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType(t){let{data:e,compressed:n=!1}=t;return n?{data:e,dataType:"compressed"}:e===null?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof ni?{data:e.handle,dataType:"buffer"}:e instanceof n5?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:n}=t;let{width:i,height:s,dataFormat:a,type:o,compressed:d}=t;const f=mb[e];return a=a||f&&f.dataFormat,o=o||f&&f.types[0],d=d||f&&f.compressed,{width:i,height:s}=this._deduceImageSize(n,i,s),{dataFormat:a,type:o,compressed:d,width:i,height:s,format:e,data:n}}_deduceImageSize(t,e,n){let i;return typeof ImageData<"u"&&t instanceof ImageData?i={width:t.width,height:t.height}:typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement?i={width:t.naturalWidth,height:t.naturalHeight}:typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement?i={width:t.width,height:t.height}:typeof ImageBitmap<"u"&&t instanceof ImageBitmap?i={width:t.width,height:t.height}:typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?i={width:t.videoWidth,height:t.videoHeight}:t?i={width:e,height:n}:i={width:e>=0?e:1,height:n>=0?n:1},rr(i,"Could not deduced texture size"),rr(e===void 0||i.width===e,"Deduced texture width does not match supplied width"),rr(n===void 0||i.height===n,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}_setParameter(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:rr(!1);break;default:this.gl.texParameteri(this.target,t,e);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return mn(this.gl)||!this.width||!this.height?!1:!JT(this.width)||!JT(this.height)}_updateForNPOT(t){t[this.gl.TEXTURE_MIN_FILTER]===void 0&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),t[this.gl.TEXTURE_WRAP_S]===void 0&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),t[this.gl.TEXTURE_WRAP_T]===void 0&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(t,e){if(this._isNPOT())switch(t){case 10241:w7.indexOf(e)===-1&&(e=9729);break;case 10242:case 10243:e!==33071&&(e=33071);break}return e}}let x7="";function B7(r,t){return rr(typeof r=="string"),r=x7+r,new Promise((e,n)=>{try{const i=new Image;i.onload=()=>e(i),i.onerror=()=>n(new Error("Could not load image ".concat(r,"."))),i.crossOrigin=t&&t.crossOrigin||"anonymous",i.src=r}catch(i){n(i)}})}class Ua extends rf{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(t,e){return rf.isSupported(t,e)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};R0(t),(e instanceof Promise||typeof e=="string")&&(e={data:e}),typeof e.data=="string"&&(e=Object.assign({},e,{data:B7(e.data)})),super(t,Object.assign({},e,{target:3553})),this.initialize(e),Object.seal(this)}}const yb=[34069,34070,34071,34072,34073,34074];class i5 extends rf{get[Symbol.toStringTag](){return"TextureCube"}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};R0(t),super(t,Object.assign({},e,{target:34067})),this.initialize(e),Object.seal(this)}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:e=!0,parameters:n={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,e&&this.generateMipmap(t),this.setParameters(n)}),this}subImage(t){let{face:e,data:n,x:i=0,y:s=0,mipmapLevel:a=0}=t;return this._subImage({target:e,data:n,x:i,y:s,mipmapLevel:a})}async setCubeMapImageData(t){let{width:e,height:n,pixels:i,data:s,border:a=0,format:o=6408,type:d=5121}=t;const{gl:f}=this,_=i||s,w=await Promise.all(yb.map(x=>{const B=_[x];return Promise.all(Array.isArray(B)?B:[B])}));this.bind(),yb.forEach((x,B)=>{w[B].length>1&&this.opts.mipmaps!==!1&&br.warn("".concat(this.id," has mipmap and multiple LODs."))(),w[B].forEach((P,R)=>{e&&n?f.texImage2D(x,R,o,e,n,a,o,d,P):f.texImage2D(x,R,o,o,d,P)})}),this.unbind()}setImageDataForFace(t){const{face:e,width:n,height:i,pixels:s,data:a,border:o=0,format:d=6408,type:f=5121}=t,{gl:_}=this,w=s||a;return this.bind(),w instanceof Promise?w.then(x=>this.setImageDataForFace(Object.assign({},t,{face:e,data:x,pixels:x}))):this.width||this.height?_.texImage2D(e,0,d,n,i,o,d,f,w):_.texImage2D(e,0,d,d,f,w),this}}i5.FACES=yb;class C7 extends rf{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(t){return mn(t)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Qo(t),e=Object.assign({depth:1},e,{target:32879,unpackFlipY:!1}),super(t,e),this.initialize(e),Object.seal(this)}setImageData(t){let{level:e=0,dataFormat:n=6408,width:i,height:s,depth:a=1,border:o=0,format:d,type:f=5121,offset:_=0,data:w,parameters:x={}}=t;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),ql(this.gl,x,()=>{ArrayBuffer.isView(w)&&this.gl.texImage3D(this.target,e,n,i,s,a,o,d,f,w),w instanceof ni&&(this.gl.bindBuffer(35052,w.handle),this.gl.texImage3D(this.target,e,n,i,s,a,o,d,f,_))}),w&&w.byteLength)this._trackAllocatedMemory(w.byteLength,"Texture");else{const B=e5[this.dataFormat]||4,P=r5[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*B*P,"Texture")}return this.loaded=!0,this}}const kh="EXT_color_buffer_float",s5={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:kh,bpp:2},33327:{gl2:kh,bpp:4},34842:{gl2:kh,bpp:8},33326:{gl2:kh,bpp:4},33328:{gl2:kh,bpp:8},34836:{gl2:kh,bpp:16},35898:{gl2:kh,bpp:4}};function E7(r,t,e){const n=e[t];if(!n)return!1;const i=mn(r)&&n.gl2||n.gl1;return typeof i=="string"?r.getExtension(i):i}class nf extends Qu{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(t){let{format:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!e||E7(t,e,s5)}static getSamplesForFormat(t,e){let{format:n}=e;return t.getInternalformatParameter(36161,n,32937)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t,e),this.initialize(e),Object.seal(this)}initialize(t){let{format:e,width:n=1,height:i=1,samples:s=0}=t;return rr(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&mn(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,e,n,i):this.gl.renderbufferStorage(36161,e,n,i),this.format=e,this.width=n,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*s5[this.format].bpp),this}resize(t){let{width:e,height:n}=t;return e!==this.width||n!==this.height?this.initialize({width:e,height:n,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(t){this.gl.bindRenderbuffer(36161,t)}_syncHandle(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(t){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,t)}}const S7=256,T7=1024,I7=16384,o5=6144,a5=6145,l5=6146,c5=34041,u5="clear: bad arguments";function _b(r){let{framebuffer:t=null,color:e=null,depth:n=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};t&&(s.framebuffer=t);let a=0;e&&(a|=I7,e!==!0&&(s.clearColor=e)),n&&(a|=S7,n!==!0&&(s.clearDepth=n)),i&&(a|=T7,n!==!0&&(s.clearStencil=n)),rr(a!==0,u5),ql(r,s,()=>{r.clear(a)})}function F7(r){let{framebuffer:t=null,buffer:e=o5,drawBuffer:n=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Qo(r),ql(r,{framebuffer:t},()=>{switch(e){case o5:switch(i.constructor){case Int32Array:r.clearBufferiv(e,n,i);break;case Uint32Array:r.clearBufferuiv(e,n,i);break;case Float32Array:default:r.clearBufferfv(e,n,i)}break;case a5:r.clearBufferfv(a5,0,[i]);break;case l5:r.clearBufferiv(l5,0,[i]);break;case c5:const[s,a]=i;r.clearBufferfi(c5,0,s,a);break;default:rr(!1,u5)}})}function L7(r){switch(r){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return rr(!1),0}}function U0(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:e=0,sourceY:n=0,sourceFormat:i=6408}=t;let{sourceAttachment:s=36064,target:a=null,sourceWidth:o,sourceHeight:d,sourceType:f}=t;const{framebuffer:_,deleteFramebuffer:w}=P7(r);rr(_);const{gl:x,handle:B,attachments:P}=_;o=o||_.width,d=d||_.height,s===36064&&B===null&&(s=1028),rr(P[s]),f=f||P[s].type,a=M7(a,f,i,o,d),f=f||pb(a);const R=x.bindFramebuffer(36160,B);return x.readPixels(e,n,o,d,i,f,a),x.bindFramebuffer(36160,R||null),w&&_.delete(),a}function A5(r){let{sourceAttachment:t=36064,targetMaxHeight:e=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=U0(r,{sourceAttachment:t}),{width:i,height:s}=r;for(;s>e;)({data:n,width:i,height:s}=p7({data:n,width:i,height:s}));f7({data:n,width:i,height:s});const a=document.createElement("canvas");a.width=i,a.height=s;const o=a.getContext("2d"),d=o.createImageData(i,s);return d.data.set(n),o.putImageData(d,0,0),a.toDataURL()}function P7(r){return r instanceof ys?{framebuffer:r,deleteFramebuffer:!1}:{framebuffer:H7(r),deleteFramebuffer:!0}}function M7(r,t,e,n,i){if(r)return r;t=t||5121;const s=ug(t,{clamped:!1}),a=L7(e);return new s(n*i*a)}const fi={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function R7(r){const t=new Ua(r,{format:6408,type:5126,dataFormat:6408}),e=new ys(r,{id:"test-framebuffer",check:!1,attachments:{36064:t}}),n=e.getStatus();return t.delete(),e.delete(),n===36053}const h5={[fi.WEBGL2]:[!1,!0],[fi.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[fi.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[fi.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[fi.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[fi.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[fi.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[fi.FLOAT_BLEND]:["EXT_float_blend"],[fi.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[fi.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[fi.TEXTURE_FLOAT]:["OES_texture_float",!0],[fi.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[fi.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[fi.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[fi.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[fi.COLOR_ATTACHMENT_RGBA32F]:[R7,"EXT_color_buffer_float"],[fi.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[fi.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[fi.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[fi.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[fi.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[fi.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},U7=2;function vb(r,t){return d5(r,t)}function d5(r,t){return t=Array.isArray(t)?t:[t],t.every(e=>f5(r,e))}function O7(r){r.luma=r.luma||{},r.luma.caps=r.luma.caps||{};for(const t in h5)r.luma.caps[t]===void 0&&(r.luma.caps[t]=f5(r,t));return r.luma.caps}function f5(r,t){return r.luma=r.luma||{},r.luma.caps=r.luma.caps||{},r.luma.caps[t]===void 0&&(r.luma.caps[t]=D7(r,t)),r.luma.caps[t]||br.log(U7,"Feature: ".concat(t," not supported"))(),r.luma.caps[t]}function D7(r,t){const e=h5[t];rr(e,t);let n;const i=mn(r)&&e[1]||e[0];if(typeof i=="function")n=i(r);else if(Array.isArray(i)){n=!0;for(const s of i)n=n&&!!r.getExtension(s)}else typeof i=="string"?n=!!r.getExtension(i):typeof i=="boolean"?n=i:rr(!1);return n}const p5="Multiple render targets not supported";class ys extends Qu{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:n,colorBufferHalfFloat:i}=e;let s=!0;return n&&(s=!!(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")||t.getExtension("OES_texture_float"))),i&&(s=s&&!!(t.getExtension("EXT_color_buffer_float")||t.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new ys(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const t=Qo(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const t=Qo(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t,e),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(e),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(t){let{width:e=1,height:n=1,attachments:i=null,color:s=!0,depth:a=!0,stencil:o=!1,check:d=!0,readBuffer:f=void 0,drawBuffers:_=void 0}=t;if(rr(e>=0&&n>=0,"Width and height need to be integers"),this.width=e,this.height=n,i)for(const w in i){const x=i[w];(Array.isArray(x)?x[0]:x).resize({width:e,height:n})}else i=this._createDefaultAttachments(s,a,o,e,n);this.update({clearAttachments:!0,attachments:i,readBuffer:f,drawBuffers:_}),i&&d&&this.checkStatus()}delete(){for(const t of this.ownResources)t.delete();return super.delete(),this}update(t){let{attachments:e={},readBuffer:n,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:a=!0}=t;this.attach(e,{clearAttachments:s,resizeAttachments:a});const{gl:o}=this,d=o.bindFramebuffer(36160,this.handle);return n&&this._setReadBuffer(n),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,d||null),this}resize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:e,height:n}=t;if(this.handle===null)return rr(e===void 0&&n===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;e===void 0&&(e=this.gl.drawingBufferWidth),n===void 0&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&br.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(e,"x").concat(n))();for(const i in this.attachments)this.attachments[i].resize({width:e,height:n});return this.width=e,this.height=n,this}attach(t){let{clearAttachments:e=!1,resizeAttachments:n=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};e&&Object.keys(this.attachments).forEach(a=>{i[a]=null}),Object.assign(i,t);const s=this.gl.bindFramebuffer(36160,this.handle);for(const a in i){rr(a!==void 0,"Misspelled framebuffer binding point?");const o=Number(a),d=i[o];let f=d;if(!f)this._unattach(o);else if(f instanceof nf)this._attachRenderbuffer({attachment:o,renderbuffer:f});else if(Array.isArray(d)){const[_,w=0,x=0]=d;f=_,this._attachTexture({attachment:o,texture:_,layer:w,level:x})}else this._attachTexture({attachment:o,texture:f,layer:0,level:0});n&&f&&f.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter(a=>!this.attachments[a]).forEach(a=>{delete this.attachments[a]})}checkStatus(){const t=this.getStatus();if(t!==36053)throw new Error(k7(t));return this}getStatus(){const{gl:t}=this,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);return t.bindFramebuffer(36160,e||null),n}clear(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:e,depth:n,stencil:i,drawBuffers:s=[]}=t,a=this.gl.bindFramebuffer(36160,this.handle);return(e||n||i)&&_b(this.gl,{color:e,depth:n,stencil:i}),s.forEach((o,d)=>{F7(this.gl,{drawBuffer:d,value:o})}),this.gl.bindFramebuffer(36160,a||null),this}readPixels(){return br.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return br.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return br.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return br.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return br.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return br.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(t){let{attachments:e=[],x:n=0,y:i=0,width:s,height:a}=t;const o=Qo(this.gl),d=o.bindFramebuffer(36008,this.handle);return n===0&&i===0&&s===void 0&&a===void 0?o.invalidateFramebuffer(36008,e):o.invalidateFramebuffer(36008,e,n,i,s,a),o.bindFramebuffer(36008,d),this}getAttachmentParameter(t,e,n){let i=this._getAttachmentParameterFallback(e);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&i>1e3&&(i=NA(this.gl,i)),i}getAttachmentParameters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of n){const a=e?NA(this.gl,s):s;i[a]=this.getAttachmentParameter(t,s,e)}return i}getParameters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const e=Object.keys(this.attachments),n={};for(const i of e){const s=Number(i),a=t?NA(this.gl,s):s;n[a]=this.getAttachmentParameters(s,t)}return n}show(){return typeof window<"u"&&window.open(A5(this),"luma-debug-texture"),this}log(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(t>br.level||typeof window>"u")return this;e=e||"Framebuffer ".concat(this.id);const n=A5(this,{targetMaxHeight:100});return br.image({logLevel:t,message:e,image:n},e)(),this}bind(){let{target:t=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(t,this.handle),this}unbind(){let{target:t=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(t,null),this}_createDefaultAttachments(t,e,n,i,s){let a=null;return t&&(a=a||{},a[36064]=new Ua(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(a[36064])),e&&n?(a=a||{},a[33306]=new nf(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(a[33306])):e?(a=a||{},a[36096]=new nf(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(a[36096])):n&&rr(!1),a}_unattach(t){const e=this.attachments[t];e&&(e instanceof nf?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}_attachRenderbuffer(t){let{attachment:e=36064,renderbuffer:n}=t;const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,n.handle),this.attachments[e]=n}_attachTexture(t){let{attachment:e=36064,texture:n,layer:i,level:s}=t;const{gl:a}=this;switch(a.bindTexture(n.target,n.handle),n.target){case 35866:case 32879:Qo(a).framebufferTextureLayer(36160,e,n.target,s,i);break;case 34067:const d=N7(i);a.framebufferTexture2D(36160,e,d,n.handle,s);break;case 3553:a.framebufferTexture2D(36160,e,3553,n.handle,s);break;default:rr(!1,"Illegal texture type")}a.bindTexture(n.target,null),this.attachments[e]=n}_setReadBuffer(t){const e=fH(this.gl);e?e.readBuffer(t):rr(t===36064||t===1029,p5),this.readBuffer=t}_setDrawBuffers(t){const{gl:e}=this,n=Qo(e);if(n)n.drawBuffers(t);else{const i=e.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(t):rr(t.length===1&&(t[0]===36064||t[0]===1029),p5)}this.drawBuffers=t}_getAttachmentParameterFallback(t){const e=O7(this.gl);switch(t){case 36052:return e.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.WEBGL2?null:8;case 33297:return e.WEBGL2?null:5125;case 33296:return!e.WEBGL2&&!e.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(t){return this.gl.bindFramebuffer(36160,t)}}function N7(r){return r<34069?r+34069:r}function k7(r){return(ys.STATUS||{})[r]||"Framebuffer error ".concat(r)}const Q7=[36049,36048,33296,33298,33299,33300,33301,33302,33303];ys.ATTACHMENT_PARAMETERS=Q7;function z7(r,t){rr(r instanceof Ua||r instanceof i5||r instanceof C7);const e=r.constructor,{gl:n,width:i,height:s,format:a,type:o,dataFormat:d,border:f,mipmaps:_}=r,w=Object.assign({width:i,height:s,format:a,type:o,dataFormat:d,border:f,mipmaps:_},t);return new e(n,w)}function H7(r,t){const{gl:e,width:n,height:i,id:s}=r;return new ys(e,Object.assign({},t,{id:"framebuffer-for-".concat(s),width:n,height:i,attachments:{36064:r}}))}function O0(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const e=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,n=r.match(e);return n?n[1]:t}const V7=35632,G7=35633;function j7(r){switch(r){case V7:return"fragment";case G7:return"vertex";default:return"unknown type"}}function q7(r,t,e,n){const i=r.split(/\r?\n/),s={},a={},o=n||O0(t)||"(unnamed)",d="".concat(j7(e)," shader ").concat(o);for(let _=0;_<i.length;_++){const w=i[_];if(w.length<=1)continue;const x=w.split(":"),B=x[0],P=parseInt(x[2],10);if(isNaN(P))throw new Error("GLSL compilation error in ".concat(d,": ").concat(r));B!=="WARNING"?s[P]=w:a[P]=w}const f=K7(t);return{shaderName:d,errors:g5(s,f),warnings:g5(a,f)}}function g5(r,t){let e="";for(let n=0;n<t.length;n++){const i=t[n];if(!(!r[n+3]&&!r[n+2]&&!r[n+1])&&(e+="".concat(i,`
`),r[n+1])){const s=r[n+1],a=s.split(":",3),o=a[0],d=parseInt(a[1],10)||0,f=s.substring(a.join(":").length+1).trim();e+=m5("^^^ ".concat(o,": ").concat(f,`

`),d)}}return e}function K7(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const n=r.split(/\r?\n/),i=String(n.length+t-1).length;return n.map((s,a)=>{const o=String(a+t),d=o.length;return m5(o,i-d)+e+s})}function m5(r,t){let e="";for(let n=0;n<t;++n)e+=" ";return"".concat(e).concat(r)}function y5(r){let t=100;const e=r.match(/[^\s]+/g);if(e.length>=2&&e[0]==="#version"){const n=parseInt(e[1],10);Number.isFinite(n)&&(t=n)}return t}const $7="Shader: GLSL source code must be a JavaScript string";class Ag extends Qu{get[Symbol.toStringTag](){return"Shader"}static getTypeName(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return rr(!1),"unknown"}}constructor(t,e){R0(t),rr(typeof e.source=="string",$7);const n=O0(e.source,null)||e.id||ku("unnamed ".concat(Ag.getTypeName(e.shaderType)));super(t,{id:n}),this.shaderType=e.shaderType,this.source=e.source,this.initialize(e)}initialize(t){let{source:e}=t;const n=O0(e,null);n&&(this.id=ku(n)),this._compile(e)}getParameter(t){return this.gl.getShaderParameter(this.handle,t)}toString(){return"".concat(Ag.getTypeName(this.shaderType),":").concat(this.id)}getName(){return O0(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(t.startsWith("#version ")||(t=`#version 100
`.concat(t)),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const n=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:a}=q7(n,this.source,this.shaderType,this.id);throw br.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),br.warn("GLSL compilation warnings in ".concat(i,`
`).concat(a))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class bb extends Ag{get[Symbol.toStringTag](){return"VertexShader"}constructor(t,e){typeof e=="string"&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class wb extends Ag{get[Symbol.toStringTag](){return"FragmentShader"}constructor(t,e){typeof e=="string"&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const W7={5126:_i.bind(null,"uniform1fv",Oa,1,ho),35664:_i.bind(null,"uniform2fv",Oa,2,ho),35665:_i.bind(null,"uniform3fv",Oa,3,ho),35666:_i.bind(null,"uniform4fv",Oa,4,ho),5124:_i.bind(null,"uniform1iv",kA,1,ho),35667:_i.bind(null,"uniform2iv",kA,2,ho),35668:_i.bind(null,"uniform3iv",kA,3,ho),35669:_i.bind(null,"uniform4iv",kA,4,ho),35670:_i.bind(null,"uniform1iv",kA,1,ho),35671:_i.bind(null,"uniform2iv",kA,2,ho),35672:_i.bind(null,"uniform3iv",kA,3,ho),35673:_i.bind(null,"uniform4iv",kA,4,ho),35674:_i.bind(null,"uniformMatrix2fv",Oa,4,zu),35675:_i.bind(null,"uniformMatrix3fv",Oa,9,zu),35676:_i.bind(null,"uniformMatrix4fv",Oa,16,zu),35678:$s,35680:$s,5125:_i.bind(null,"uniform1uiv",D0,1,ho),36294:_i.bind(null,"uniform2uiv",D0,2,ho),36295:_i.bind(null,"uniform3uiv",D0,3,ho),36296:_i.bind(null,"uniform4uiv",D0,4,ho),35685:_i.bind(null,"uniformMatrix2x3fv",Oa,6,zu),35686:_i.bind(null,"uniformMatrix2x4fv",Oa,8,zu),35687:_i.bind(null,"uniformMatrix3x2fv",Oa,6,zu),35688:_i.bind(null,"uniformMatrix3x4fv",Oa,12,zu),35689:_i.bind(null,"uniformMatrix4x2fv",Oa,8,zu),35690:_i.bind(null,"uniformMatrix4x3fv",Oa,12,zu),35678:$s,35680:$s,35679:$s,35682:$s,36289:$s,36292:$s,36293:$s,36298:$s,36299:$s,36300:$s,36303:$s,36306:$s,36307:$s,36308:$s,36311:$s},X7={},J7={},Y7={},_5=[0];function xb(r,t,e,n){t===1&&typeof r=="boolean"&&(r=r?1:0),Number.isFinite(r)&&(_5[0]=r,r=_5);const i=r.length;if(i%t&&br.warn("Uniform size should be multiples of ".concat(t),r)(),r instanceof e)return r;let s=n[i];s||(s=new e(i),n[i]=s);for(let a=0;a<i;a++)s[a]=r[a];return s}function Oa(r,t){return xb(r,t,Float32Array,X7)}function kA(r,t){return xb(r,t,Int32Array,J7)}function D0(r,t){return xb(r,t,Uint32Array,Y7)}function v5(r,t,e){const n=W7[e.type];if(!n)throw new Error("Unknown GLSL uniform type ".concat(e.type));return n().bind(null,r,t)}function Z7(r){if(r[r.length-1]!=="]")return{name:r,length:1,isArray:!1};const t=/([^[]*)(\[[0-9]+\])?/,e=r.match(t);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(r));return{name:e[1],length:e[2]||1,isArray:!!e[2]}}function t9(r,t,e){for(const n in r){const i=r[n];if((!e||!!e[n])&&!e9(i))throw t=t?"".concat(t," "):"",console.error("".concat(t," Bad uniform ").concat(n),i),new Error("".concat(t," Bad uniform ").concat(n))}return!0}function e9(r){return Array.isArray(r)||ArrayBuffer.isView(r)?n9(r):isFinite(r)||r===!0||r===!1||r instanceof rf||r instanceof nf?!0:r instanceof ys?!!r.texture:!1}function r9(r,t,e){if(Array.isArray(e)||ArrayBuffer.isView(e))if(r[t]){const n=r[t];for(let i=0,s=e.length;i<s;++i)n[i]=e[i]}else r[t]=e.slice();else r[t]=e}function n9(r){if(r.length===0)return!1;const t=Math.min(r.length,16);for(let e=0;e<t;++e)if(!Number.isFinite(r[e]))return!1;return!0}function $s(){let r=null;return(t,e,n)=>{const i=r!==n;return i&&(t.uniform1i(e,n),r=n),i}}function _i(r,t,e,n){let i=null,s=null;return(a,o,d)=>{const f=t(d,e),_=f.length;let w=!1;if(i===null)i=new Float32Array(_),s=_,w=!0;else{rr(s===_,"Uniform length cannot change.");for(let x=0;x<_;++x)if(f[x]!==i[x]){w=!0;break}}return w&&(n(a,r,o,f),i.set(f)),w}}function ho(r,t,e,n){r[t](e,n)}function zu(r,t,e,n){r[t](e,!1,n)}const i9=5120,s9=5121,o9=5122,a9=5123,b5=0,N0=1,l9=2,c9=3,k0=4,u9=5,A9=6,_s=5126,h9=35664,d9=35665,f9=35666,hg=5124,p9=35667,g9=35668,m9=35669,dg=5125,y9=36294,_9=36295,v9=36296,b9=35670,w9=35671,x9=35672,B9=35673,C9=35674,E9=35675,S9=35676,T9=35685,I9=35686,F9=35687,L9=35688,P9=35689,M9=35690,Bb={[_s]:[_s,1,"float"],[h9]:[_s,2,"vec2"],[d9]:[_s,3,"vec3"],[f9]:[_s,4,"vec4"],[hg]:[hg,1,"int"],[p9]:[hg,2,"ivec2"],[g9]:[hg,3,"ivec3"],[m9]:[hg,4,"ivec4"],[dg]:[dg,1,"uint"],[y9]:[dg,2,"uvec2"],[_9]:[dg,3,"uvec3"],[v9]:[dg,4,"uvec4"],[b9]:[_s,1,"bool"],[w9]:[_s,2,"bvec2"],[x9]:[_s,3,"bvec3"],[B9]:[_s,4,"bvec4"],[C9]:[_s,8,"mat2"],[T9]:[_s,8,"mat2x3"],[I9]:[_s,8,"mat2x4"],[E9]:[_s,12,"mat3"],[F9]:[_s,12,"mat3x2"],[L9]:[_s,12,"mat3x4"],[S9]:[_s,16,"mat4"],[P9]:[_s,16,"mat4x2"],[M9]:[_s,16,"mat4x3"]};function R9(r){switch(r){case b5:return b5;case N0:return N0;case c9:return N0;case l9:return N0;case k0:return k0;case u9:return k0;case A9:return k0;default:return rr(!1),0}}function w5(r){const t=Bb[r];if(!t)return null;const[e,n]=t;return{type:e,components:n}}function x5(r,t){switch(r){case i9:case s9:case o9:case a9:r=_s;break}for(const e in Bb){const[n,i,s]=Bb[e];if(n===r&&i===t)return{glType:e,name:s}}return null}class U9{constructor(t){this.id=t.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(t),this._readVaryingsFromProgram(t)}getAttributeInfo(t){const e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}getAttributeLocation(t){const e=this.getAttributeInfo(t);return e?e.location:-1}getAttributeAccessor(t){const e=this.getAttributeInfo(t);return e?e.accessor:null}getVaryingInfo(t){const e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}getVaryingIndex(t){const e=this.getVaryingInfo();return e?e.location:-1}getVaryingAccessor(t){const e=this.getVaryingInfo();return e?e.accessor:null}_readAttributesFromProgram(t){const{gl:e}=t,n=e.getProgramParameter(t.handle,35721);for(let i=0;i<n;i++){const{name:s,type:a,size:o}=e.getActiveAttrib(t.handle,i),d=e.getAttribLocation(t.handle,s);d>=0&&this._addAttribute(d,s,a,o)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(t){const{gl:e}=t;if(!mn(e))return;const n=e.getProgramParameter(t.handle,35971);for(let i=0;i<n;i++){const{name:s,type:a,size:o}=e.getTransformFeedbackVarying(t.handle,i);this._addVarying(i,s,a,o)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(t,e,n,i){const{type:s,components:a}=w5(n),o={type:s,size:i*a};this._inferProperties(t,e,o);const d={location:t,name:e,accessor:new ca(o)};this.attributeInfos.push(d),this.attributeInfosByLocation[t]=d,this.attributeInfosByName[d.name]=d}_inferProperties(t,e,n){/instance/i.test(e)&&(n.divisor=1)}_addVarying(t,e,n,i){const{type:s,components:a}=w5(n),o=new ca({type:s,size:i*a}),d={location:t,name:e,accessor:o};this.varyingInfos.push(d),this.varyingInfosByName[d.name]=d}}const B5=4,O9=35981,D9=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class C5 extends Qu{get[Symbol.toStringTag](){return"Program"}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t,e),this.stubRemovedMethods("Program","v6.0",D9),this._isCached=!1,this.initialize(e),Object.seal(this),this._setId(e.id)}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:e,vs:n,fs:i,varyings:s,bufferMode:a=O9}=t;return this.hash=e||"",this.vs=typeof n=="string"?new bb(this.gl,{id:"".concat(t.id,"-vs"),source:n}):n,this.fs=typeof i=="string"?new wb(this.gl,{id:"".concat(t.id,"-fs"),source:i}):i,rr(this.vs instanceof bb),rr(this.fs instanceof wb),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Qo(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,a)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new U9(this),this.setProps(t)}delete(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(t)}setProps(t){return"uniforms"in t&&this.setUniforms(t.uniforms),this}draw(t){let{logPriority:e,drawMode:n=4,vertexCount:i,offset:s=0,start:a,end:o,isIndexed:d=!1,indexType:f=5123,instanceCount:_=0,isInstanced:w=_>0,vertexArray:x=null,transformFeedback:B,framebuffer:P,parameters:R={},uniforms:N,samplers:Q}=t;if((N||Q)&&(br.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(N||{})),br.priority>=e){const V=P?P.id:"default",W="mode=".concat(NA(this.gl,n)," verts=").concat(i," ")+"instances=".concat(_," indexType=").concat(NA(this.gl,f)," ")+"isInstanced=".concat(w," isIndexed=").concat(d," ")+"Framebuffer=".concat(V);br.log(e,W)()}return rr(x),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||w&&_===0?!1:(x.bindForDraw(i,_,()=>{if(P!==void 0&&(R=Object.assign({},R,{framebuffer:P})),B){const V=R9(n);B.begin(V)}this._bindTextures(),ql(this.gl,R,()=>{d&&w?this.gl2.drawElementsInstanced(n,i,f,s,_):d&&mn(this.gl)&&!isNaN(a)&&!isNaN(o)?this.gl2.drawRangeElements(n,a,o,i,f,s):d?this.gl.drawElements(n,i,f,s):w?this.gl2.drawArraysInstanced(n,s,i,_):this.gl.drawArrays(n,s,i)}),B&&B.end()}),!0)}setUniforms(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};br.priority>=2&&t9(t,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const e in t){const n=t[e],i=this._uniformSetters[e];if(i){let s=n,a=!1;if(s instanceof ys&&(s=s.texture),s instanceof rf)if(a=this.uniforms[e]!==n,a){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const o=s,{textureIndex:d}=i;o.bind(d),s=d,this._textureUniforms[e]=o}else s=i.textureIndex;else this._textureUniforms[e]&&delete this._textureUniforms[e];(i(s)||a)&&r9(this.uniforms,e,n)}}return this}_areTexturesRenderable(){let t=!0;for(const e in this._textureUniforms){const n=this._textureUniforms[e];n.update(),t=t&&n.loaded}return t}_bindTextures(){for(const t in this._textureUniforms){const e=this._uniformSetters[t].textureIndex;this._textureUniforms[t].bind(e)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(t){const e=this.gl.getAttachedShaders(t),n={};for(const i of e)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new bb({handle:i});break;case 35632:n.fs=new wb({handle:i});break}return n}_getParameter(t){return this.gl.getProgramParameter(this.handle,t)}_setId(t){if(!t){const e=this._getName();this.id=ku(e)}}_getName(){let t=this.vs.getName()||this.fs.getName();return t=t.replace(/shader/i,""),t=t?"".concat(t,"-program"):"program",t}_compileAndLink(){const{gl:t}=this;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),br.time(B5,"linkProgram for ".concat(this._getName()))(),t.linkProgram(this.handle),br.timeEnd(B5,"linkProgram for ".concat(this._getName()))(),t.debug||br.level>0){if(!t.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(t.getProgramInfoLog(this.handle)));if(t.validateProgram(this.handle),!t.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(t.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:t}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let e=0;e<this._uniformCount;e++){const n=this.gl.getActiveUniform(this.handle,e),{name:i}=Z7(n.name);let s=t.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=v5(t,s,n),n.size>1)for(let a=0;a<n.size;a++)s=t.getUniformLocation(this.handle,"".concat(i,"[").concat(a,"]")),this._uniformSetters["".concat(i,"[").concat(a,"]")]=v5(t,s,n)}this._textureIndexCounter=0}getActiveUniforms(t,e){return this.gl2.getActiveUniforms(this.handle,t,e)}getUniformBlockIndex(t){return this.gl2.getUniformBlockIndex(this.handle,t)}getActiveUniformBlockParameter(t,e){return this.gl2.getActiveUniformBlockParameter(this.handle,t,e)}uniformBlockBinding(t,e){this.gl2.uniformBlockBinding(this.handle,t,e)}}const N9=34918,k9=34919,Q9=35007,z9=36795,H9=35976,V9=35887,G9=36202;class Q0 extends Qu{get[Symbol.toStringTag](){return"Query"}static isSupported(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=mn(t),i=d5(t,fi.TIMER_QUERY);let s=n||i;for(const a of e)switch(a){case"queries":s=s&&n;break;case"timers":s=s&&i;break;default:rr(!1)}return s}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t,e),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(Q9)}beginOcclusionQuery(){let{conservative:t=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(t?G9:V9)}beginTransformFeedbackQuery(){return this.begin(H9)}begin(t){return this._queryPending?this:(this.target=t,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const t=this.gl2.getQueryParameter(this.handle,k9);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.gl2.getParameter(z9)}getResult(){return this.gl2.getQueryParameter(this.handle,N9)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let e=0;return this._pollingPromise=new Promise((n,i)=>{const s=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):e++>t?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return Q0.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class E5 extends Qu{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(t){return mn(t)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Qo(t),super(t,e),this.initialize(e),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,tf(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(t),this}setProps(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}setBuffers(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const e in t)this.setBuffer(e,t[e])}),this}setBuffer(t,e){const n=this._getVaryingIndex(t),{buffer:i,byteSize:s,byteOffset:a}=this._getBufferParams(e);return n<0?(this.unused[t]=i,br.warn("".concat(this.id," unused varying buffer ").concat(t))(),this):(this.buffers[n]=e,this.bindOnUse||this._bindBuffer(n,i,a,s),this)}begin(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(t){let e,n,i;return t instanceof ni?i=t:(i=t.buffer,n=t.byteSize,e=t.byteOffset),(e!==void 0||n!==void 0)&&(e=e||0,n=n||i.byteLength-e),{buffer:i,byteOffset:e,byteSize:n}}_getVaryingInfo(t){return this.configuration&&this.configuration.getVaryingInfo(t)}_getVaryingIndex(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;const e=Number(t);return Number.isFinite(e)?e:-1}_bindBuffers(){if(this.bindOnUse)for(const t in this.buffers){const{buffer:e,byteSize:n,byteOffset:i}=this._getBufferParams(this.buffers[t]);this._bindBuffer(t,e,i,n)}}_unbindBuffers(){if(this.bindOnUse)for(const t in this.buffers)this._bindBuffer(t,null)}_bindBuffer(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=e&&e.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,t,s):this.gl.bindBufferRange(35982,t,s,n,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(t){this.gl.bindTransformFeedback(36386,this.handle)}}let z0=null;function j9(r){return(!z0||z0.byteLength<r)&&(z0=new ArrayBuffer(r)),z0}function q9(r,t){const e=j9(r.BYTES_PER_ELEMENT*t);return new r(e,0,t)}function K9(r){let{target:t,source:e,start:n=0,count:i=1}=r;const s=e.length,a=i*s;let o=0;for(let d=n;o<s;o++)t[d++]=e[o];for(;o<a;)o<a-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+a-o),o=a);return t}const $9="elements must be GL.ELEMENT_ARRAY_BUFFER";class Da extends Qu{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(t){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?mn(t)||cT()==="Chrome":!0}static getDefaultArray(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new Da(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}static getMaxAttributes(t){return Da.MAX_ATTRIBUTES=Da.MAX_ATTRIBUTES||t.getParameter(34921),Da.MAX_ATTRIBUTES}static setConstant(t,e,n){switch(n.constructor){case Float32Array:Da._setConstantFloatArray(t,e,n);break;case Int32Array:Da._setConstantIntArray(t,e,n);break;case Uint32Array:Da._setConstantUintArray(t,e,n);break;default:rr(!1)}}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e.id||e.program&&e.program.id;super(t,Object.assign({},e,{id:n})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=e.isDefaultArray||!1,this.gl2=t,this.initialize(e),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Da.getMaxAttributes(this.gl)}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(t)}setProps(t){return this}setElementBuffer(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return rr(!t||t.target===34963,$9),this.bind(()=>{this.gl.bindBuffer(34963,t?t.handle:null)}),this}setBuffer(t,e,n){if(e.target===34963)return this.setElementBuffer(e,n);const{size:i,type:s,stride:a,offset:o,normalized:d,integer:f,divisor:_}=n,{gl:w,gl2:x}=this;return t=Number(t),this.bind(()=>{w.bindBuffer(34962,e.handle),f?(rr(mn(w)),x.vertexAttribIPointer(t,i,s,a,o)):w.vertexAttribPointer(t,i,s,d,a,o),w.enableVertexAttribArray(t),x.vertexAttribDivisor(t,_||0)}),this}enable(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!e&&t===0&&!Da.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind(()=>e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t))),this}getConstantBuffer(t,e){const n=this._normalizeConstantArrayValue(e),i=n.byteLength*t,s=n.length*t;let a=!this.buffer;if(this.buffer=this.buffer||new ni(this.gl,i),a=a||this.buffer.reallocate(i),a=a||!this._compareConstantArrayValues(n,this.bufferValue),a){const o=q9(e.constructor,s);K9({target:o,source:n,start:0,count:s}),this.buffer.subData(o),this.bufferValue=e}return this.buffer}_normalizeConstantArrayValue(t){return Array.isArray(t)?new Float32Array(t):t}_compareConstantArrayValues(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}static _setConstantFloatArray(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:rr(!1)}}static _setConstantIntArray(t,e,n){switch(rr(mn(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:rr(!1)}}static _setConstantUintArray(t,e,n){switch(rr(mn(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:rr(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(t){return this.gl2.deleteVertexArray(t),[this.elements]}_bindHandle(t){this.gl2.bindVertexArray(t)}_getParameter(t,e){let{location:n}=e;return rr(Number.isFinite(n)),this.bind(()=>{switch(t){case 34373:return this.gl.getVertexAttribOffset(n,t);default:return this.gl.getVertexAttrib(n,t)}})}}const W9="VertexArray: attributes must be Buffers or constants (i.e. typed array)",X9=/^(.+)__LOCATION_([0-9]+)$/,J9=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Y9{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e.id||e.program&&e.program.id;this.id=n,this.gl=t,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Da(t),YT(this,"VertexArray","v6.0",J9),this.initialize(e),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:t}=this.vertexArrayObject;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}setProps(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(t){return Object.assign(this.attributes,t),this.vertexArrayObject.bind(()=>{for(const e in t){const n=t[e];this._setAttribute(e,n)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}setBuffer(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e.target===34963)return this.setElementBuffer(e,n);const{location:i,accessor:s}=this._resolveLocationAndAccessor(t,e,e.accessor,n);return i>=0&&(this.values[i]=e,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,e,s)),this}setConstant(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},n));return i>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[i]=e,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ni(this.gl,{accessor:{size:4}});for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this.values[t]instanceof ni&&(this.gl.disableVertexAttribArray(t),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(t,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++){const e=this.values[t];e instanceof ni&&this.setBuffer(t,e)}}),this}bindForDraw(t,e,n){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(t,e),i=n()}),i}_resolveLocationAndAccessor(t,e,n,i){const s={location:-1,accessor:null},{location:a,name:o}=this._getAttributeIndex(t);if(!Number.isFinite(a)||a<0)return this.unused[t]=e,br.once(3,()=>"unused value ".concat(t," in ").concat(this.id))(),s;const d=this._getAttributeInfo(o||a);if(!d)return s;const f=this.accessors[a]||{},_=ca.resolve(d.accessor,f,n,i),{size:w,type:x}=_;return rr(Number.isFinite(w)&&Number.isFinite(x)),{location:a,accessor:_}}_getAttributeInfo(t){return this.configuration&&this.configuration.getAttributeInfo(t)}_getAttributeIndex(t){const e=Number(t);if(Number.isFinite(e))return{location:e};const n=X9.exec(t),i=n?n[1]:t,s=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(t,e){if(e instanceof ni)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof ni){const n=e[0],i=e[1];this.setBuffer(t,n,i)}else if(ArrayBuffer.isView(e)||Array.isArray(e)){const n=e;this.setConstant(t,n)}else if(e.buffer instanceof ni){const n=e;this.setBuffer(t,n.buffer,n)}else throw new Error(W9)}_setConstantAttributes(t,e){const n=Math.max(t|0,e|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,n);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(t,e){if(Da.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,t);return}const n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(t,e){Da.setConstant(this.gl,t,e)}_updateDrawParams(){const t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}_updateDrawParamsForLocation(t,e){const n=this.values[e],i=this.accessors[e];if(!n)return;const{divisor:s}=i,a=s>0;if(t.isInstanced=t.isInstanced||a,n instanceof ni){const o=n;if(a){const d=o.getVertexCount(i);t.instanceCount=Math.min(t.instanceCount,d)}else{const d=o.getVertexCount(i);t.vertexCount=Math.min(t.vertexCount,d)}}}setElements(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return br.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(t,e)}}function Z9(r,t){const{maxElts:e=16,size:n=1}=t;let i="[";for(let a=0;a<r.length&&a<e;++a)a>0&&(i+=",".concat(a%n===0?" ":"")),i+=fg(r[a],t);const s=r.length>e?"...":"]";return"".concat(i).concat(s)}function fg(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e=1e-16,{isInteger:n=!1}=t;if(Array.isArray(r)||ArrayBuffer.isView(r))return Z9(r,t);if(!Number.isFinite(r))return String(r);if(Math.abs(r)<e)return n?"0":"0.";if(n||Math.abs(r)>100&&Math.abs(r)<1e4)return r.toFixed(0);const i=r.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function S5(r){let{header:t="Uniforms",program:e,uniforms:n,undefinedOnly:i=!1}=r;rr(e);const s=".*_.*",a=".*Matrix",o=e._uniformSetters,d={},f=Object.keys(o).sort();let _=0;for(const B of f)!B.match(s)&&!B.match(a)&&Cb({table:d,header:t,uniforms:n,uniformName:B,undefinedOnly:i})&&_++;for(const B of f)B.match(a)&&Cb({table:d,header:t,uniforms:n,uniformName:B,undefinedOnly:i})&&_++;for(const B of f)d[B]||Cb({table:d,header:t,uniforms:n,uniformName:B,undefinedOnly:i})&&_++;let w=0;const x={};if(!i)for(const B in n){const P=n[B];d[B]||(w++,x[B]={Type:"NOT USED: ".concat(P),[t]:fg(P)})}return{table:d,count:_,unusedTable:x,unusedCount:w}}function Cb(r){let{table:t,header:e,uniforms:n,uniformName:i,undefinedOnly:s}=r;const a=n[i],o=tV(a);return!s||!o?(t[i]={[e]:o?fg(a):"N/A","Uniform Type":o?a:"NOT PROVIDED"},!0):!1}function tV(r){return r!=null}function eV(r){let{vertexArray:t,header:e="Attributes"}=r;if(!t.configuration)return{};const n={};t.elements&&(n.ELEMENT_ARRAY_BUFFER=T5(t,t.elements,null,e));const i=t.values;for(const s in i){const a=t._getAttributeInfo(s);if(a){let o="".concat(s,": ").concat(a.name);const d=t.accessors[a.location];d&&(o="".concat(s,": ").concat(rV(a.name,d))),n[o]=T5(t,i[s],d,e)}}return n}function T5(r,t,e,n){const{gl:i}=r;if(!t)return{[n]:"null","Format ":"N/A"};let s="NOT PROVIDED",a=1,o=0,d=0,f,_,w;if(e&&(s=e.type,a=e.size,s=String(s).replace("Array",""),f=s.indexOf("nt")!==-1),t instanceof ni){const x=t,{data:B,changed:P}=x.getDebugData();_=P?"*":"",w=B,d=x.byteLength,o=d/B.BYTES_PER_ELEMENT/a;let R;if(e){const N=e.divisor>0;R="".concat(N?"I ":"P "," ").concat(o," (x").concat(a,"=").concat(d," bytes ").concat(NA(i,s),")")}else f=!0,R="".concat(d," bytes");return{[n]:"".concat(_).concat(fg(w,{size:a,isInteger:f})),"Format ":R}}return w=t,a=t.length,s=String(t.constructor.name).replace("Array",""),f=s.indexOf("nt")!==-1,{[n]:"".concat(fg(w,{size:a,isInteger:f})," (constant)"),"Format ":"".concat(a,"x").concat(s," (constant)")}}function rV(r,t){const{type:e,size:n}=t,i=x5(e,n);return i?"".concat(r," (").concat(i.name,")"):r}function nV(r){const t={},e="Accessors for ".concat(r.id);for(const n of r.attributeInfos)if(n){const i=I5(n);t["in ".concat(i)]={[e]:JSON.stringify(n.accessor)}}for(const n of r.varyingInfos)if(n){const i=I5(n);t["out ".concat(i)]={[e]:JSON.stringify(n.accessor)}}return t}function I5(r){const{type:t,size:e}=r.accessor,n=x5(t,e);return n?"".concat(n.name," ").concat(r.name):r.name}const F5=Du()&&typeof document<"u";let iV=0;class sV{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:e=N=>XT(N),onAddHTML:n=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:a=()=>{},onError:o,gl:d=null,glOptions:f={},debug:_=!1,createFramebuffer:w=!1,autoResizeViewport:x=!0,autoResizeDrawingBuffer:B=!0,stats:P=Nh.get("animation-loop-".concat(iV++))}=t;let{useDevicePixels:R=!0}=t;"useDevicePixelRatio"in t&&(br.deprecated("useDevicePixelRatio","useDevicePixels")(),R=t.useDevicePixelRatio),this.props={onCreateContext:e,onAddHTML:n,onInitialize:i,onRender:s,onFinalize:a,onError:o,gl:d,glOptions:f,debug:_,createFramebuffer:w},this.gl=d,this.needsRedraw=null,this.timeline=null,this.stats=P,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:x,autoResizeDrawingBuffer:B,useDevicePixels:R}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(t){return rr(typeof t=="string"),this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}start(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const e=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(t),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Q0.isSupported(this.gl,["timers"])?new Q0(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(n=>{this._running&&(this._addCallbackData(n||{}),n!==!1&&this._startLoop())});return this.props.onError&&e.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(t=>{this._resolveNextFrame=t})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const n=document.getElementById(t);return n?Number(n.value):e}setViewParameters(){return br.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const t=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(t))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(t)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=F5?new Promise((t,e)=>{if(F5&&document.readyState==="complete"){t(document);return}window.addEventListener("load",()=>{t(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(t){this.display&&(this.display.delete(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_cancelAnimationFrame(t){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(t):h7(t)}_requestAnimationFrame(t){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(t):A7(t)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:t,height:e,aspect:n}=this._getSizeAndAspect();(t!==this.animationProps.width||e!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=e,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(t){typeof t=="object"&&t!==null&&(this.animationProps=Object.assign({},this.animationProps,t))}_createWebGLContext(t){if(this.offScreen=t.canvas&&typeof OffscreenCanvas<"u"&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,this.props.glOptions),this.gl=this.props.gl?hb(this.props.gl,t):this.onCreateContext(t),!M0(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");YH(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);const n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}_getSizeAndAspect(){const t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight;let n=1;const{canvas:i}=this.gl;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&n7(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new ys(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:t}=this.gl;t&&(t.addEventListener("mousemove",this._onMousemove),t.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}_onMouseleave(t){this.animationProps._mousePosition=null}}const pg="vs",Eb="fs";function Na(r,t){if(!r)throw new Error(t||"shadertools: assertion failed.")}const Sb={number:{validate(r,t){return Number.isFinite(r)&&(!("max"in t)||r<=t.max)&&(!("min"in t)||r>=t.min)}},array:{validate(r,t){return Array.isArray(r)||ArrayBuffer.isView(r)}}};function oV(r){const t={};for(const e in r){const n=r[e],i=aV(n);t[e]=i}return t}function aV(r){let t=L5(r);return t==="object"?r?"type"in r?Object.assign({},r,Sb[r.type]):"value"in r?(t=L5(r.value),Object.assign({type:t},r,Sb[t])):{type:"object",value:r}:{type:"object",value:null}:Object.assign({type:t,value:r},Sb[t])}function L5(r){return Array.isArray(r)||ArrayBuffer.isView(r)?"array":typeof r}const lV="vs",cV="fs";class P5{constructor(t){let{name:e,vs:n,fs:i,dependencies:s=[],uniforms:a,getUniforms:o,deprecations:d=[],defines:f={},inject:_={},vertexShader:w,fragmentShader:x}=t;Na(typeof e=="string"),this.name=e,this.vs=n||w,this.fs=i||x,this.getModuleUniforms=o,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(d),this.defines=f,this.injections=uV(_),a&&(this.uniforms=oV(a))}getModuleSource(t){let e;switch(t){case lV:e=this.vs||"";break;case cV:e=this.fs||"";break;default:Na(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(e,"// END MODULE_").concat(this.name,`

`)}getUniforms(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):this.uniforms?this._defaultGetUniforms(t):{}}getDefines(){return this.defines}checkDeprecations(t,e){this.deprecations.forEach(n=>{n.regex.test(t)&&(n.deprecated?e.deprecated(n.old,n.new)():e.removed(n.old,n.new)())})}_parseDeprecationDefinitions(t){return t.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp("\\b".concat(e.old,"\\("));break;default:e.regex=new RegExp("".concat(e.type," ").concat(e.old,";"))}}),t}_defaultGetUniforms(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e={},n=this.uniforms;for(const i in n){const s=n[i];i in t&&!s.private?(s.validate&&Na(s.validate(t[i],s),"".concat(this.name,": invalid ").concat(i)),e[i]=t[i]):e[i]=s.value}return e}}function uV(r){const t={vs:{},fs:{}};for(const e in r){let n=r[e];const i=e.slice(0,2);typeof n=="string"&&(n={order:0,injection:n}),t[i][e]=n}return t}function AV(r){return hV(R5(r))}function hV(r){const t={},e={};return M5({modules:r,level:0,moduleMap:t,moduleDepth:e}),Object.keys(e).sort((n,i)=>e[i]-e[n]).map(n=>t[n])}function M5(r){let{modules:t,level:e,moduleMap:n,moduleDepth:i}=r;if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const s of t)n[s.name]=s,(i[s.name]===void 0||i[s.name]<e)&&(i[s.name]=e);for(const s of t)s.dependencies&&M5({modules:s.dependencies,level:e+1,moduleMap:n,moduleDepth:i})}function R5(r,t){return r.map(e=>(e instanceof P5||(Na(typeof e!="string","Shader module use by name is deprecated. Import shader module '".concat(e,"' and use it directly.")),Na(e.name,"shader module has no name"),e=new P5(e),e.dependencies=R5(e.dependencies)),e))}function dV(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=typeof window<"u"?window.navigator||{}:{},e=r.userAgent||t.userAgent||"",n=e.indexOf("MSIE ")!==-1,i=e.indexOf("Trident/")!==-1;return n||i}const fV=7936,pV=7937,gV=7938,mV=35724,Tb={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Qh={};Object.keys(Tb).forEach(r=>{Qh[r]=r});function yV(r){return typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?!0:!!(r&&r._version===2)}function _V(r){const t=r.getExtension("WEBGL_debug_renderer_info"),e=r.getParameter(t&&t.UNMASKED_VENDOR_WEBGL||fV),n=r.getParameter(t&&t.UNMASKED_RENDERER_WEBGL||pV);return{gpuVendor:vV(e,n),vendor:e,renderer:n,version:r.getParameter(gV),shadingLanguageVersion:r.getParameter(mV)}}function vV(r,t){return r.match(/NVIDIA/i)||t.match(/NVIDIA/i)?"NVIDIA":r.match(/INTEL/i)||t.match(/INTEL/i)?"INTEL":r.match(/AMD/i)||t.match(/AMD/i)||r.match(/ATI/i)||t.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const Ib={};function U5(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=Tb[t];if(Na(n,t),!dV(e))return!0;if(t in Ib)return Ib[t];const i=n[0],s=e.behavior||"enable",a="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),o=r.createShader(35633);r.shaderSource(o,a),r.compileShader(o);const d=r.getShaderParameter(o,35713);return r.deleteShader(o),Ib[t]=d,d}function bV(r,t){const e=Tb[t];Na(e,t);const n=yV(r)&&e[1]||e[0],i=typeof n=="string"?!!r.getExtension(n):n;return Na(i===!1||i===!0),i}function H0(r,t){return t=Array.isArray(t)?t:[t],t.every(e=>bV(r,e))}function wV(r){switch(_V(r).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function xV(r,t,e){let n=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return H0(r,Qh.GLSL_FRAG_DEPTH)&&(n+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),H0(r,Qh.GLSL_DERIVATIVES)&&U5(r,Qh.GLSL_DERIVATIVES)&&(n+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),H0(r,Qh.GLSL_FRAG_DATA)&&U5(r,Qh.GLSL_FRAG_DATA,{behavior:"require"})&&(n+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),H0(r,Qh.GLSL_TEXTURE_LOD)&&(n+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),n}const BV=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,CV=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,EV={[pg]:BV,[Eb]:CV},V0="__LUMA_INJECT_DECLARATIONS__",O5=/void\s+main\s*\([^)]*\)\s*\{\n?/,D5=/}\n?[^{}]*$/,Fb=[];function N5(r,t,e){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=t===pg;for(const s in e){const a=e[s];a.sort((d,f)=>d.order-f.order),Fb.length=a.length;for(let d=0,f=a.length;d<f;++d)Fb[d]=a[d].injection;const o="".concat(Fb.join(`
`),`
`);switch(s){case"vs:#decl":i&&(r=r.replace(V0,o));break;case"vs:#main-start":i&&(r=r.replace(O5,d=>d+o));break;case"vs:#main-end":i&&(r=r.replace(D5,d=>o+d));break;case"fs:#decl":i||(r=r.replace(V0,o));break;case"fs:#main-start":i||(r=r.replace(O5,d=>d+o));break;case"fs:#main-end":i||(r=r.replace(D5,d=>o+d));break;default:r=r.replace(s,d=>d+o)}}return r=r.replace(V0,""),n&&(r=r.replace(/\}\s*$/,s=>s+EV[t])),r}function Lb(r){const t={};return Na(Array.isArray(r)&&r.length>1),r.forEach(e=>{for(const n in e)t[n]=t[n]?"".concat(t[n],`
`).concat(e[n]):e[n]}),t}function sf(r){return new RegExp("\\b".concat(r,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const k5=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],SV=[...k5,[sf("attribute"),"in $1"],[sf("varying"),"out $1"]],TV=[...k5,[sf("varying"),"in $1"]],Q5=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],IV=[...Q5,[sf("in"),"attribute $1"],[sf("out"),"varying $1"]],FV=[...Q5,[sf("in"),"varying $1"]],Pb="gl_FragColor",Mb=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,LV=/void\s+main\s*\([^)]*\)\s*\{\n?/;function PV(r,t,e){switch(t){case 300:return e?G0(r,SV):MV(r);case 100:return e?G0(r,IV):RV(r);default:throw new Error("unknown GLSL version ".concat(t))}}function G0(r,t){for(const[e,n]of t)r=r.replace(e,n);return r}function MV(r){r=G0(r,TV);const t=r.match(Mb);if(t){const e=t[1];r=r.replace(new RegExp("\\b".concat(Pb,"\\b"),"g"),e)}else{const e="fragmentColor";r=r.replace(LV,n=>"out vec4 ".concat(e,`;
`).concat(n)).replace(new RegExp("\\b".concat(Pb,"\\b"),"g"),e)}return r}function RV(r){r=G0(r,FV);const t=r.match(Mb);if(t){const e=t[1];r=r.replace(Mb,"").replace(new RegExp("\\b".concat(e,"\\b"),"g"),Pb)}return r}const UV=`

`.concat(V0,`

`),z5={[pg]:"vertex",[Eb]:"fragment"},OV=`precision highp float;

`;function DV(r,t){const{vs:e,fs:n}=t,i=AV(t.modules||[]);return{gl:r,vs:H5(r,Object.assign({},t,{source:e,type:pg,modules:i})),fs:H5(r,Object.assign({},t,{source:n,type:Eb,modules:i})),getUniforms:NV(i)}}function H5(r,t){let{id:e,source:n,type:i,modules:s,defines:a={},hookFunctions:o=[],inject:d={},transpileToGLSL100:f=!1,prologue:_=!0,log:w}=t;Na(typeof n=="string","shader source must be a string");const x=i===pg,B=n.split(`
`);let P=100,R="",N=n;B[0].indexOf("#version ")===0?(P=300,R=B[0],N=B.slice(1).join(`
`)):R="#version ".concat(P);const Q={};s.forEach(gt=>{Object.assign(Q,gt.getDefines())}),Object.assign(Q,a);let V=_?"".concat(R,`
`).concat(QV({id:e,source:n,type:i}),`
`).concat(kV({type:i}),`
`).concat(wV(r),`
`).concat(xV(r),`
`).concat(zV(Q),`
`).concat(x?"":OV,`
`):"".concat(R,`
`);const W=VV(o),et={},ct={},dt={};for(const gt in d){const ht=typeof d[gt]=="string"?{injection:d[gt],order:0}:d[gt],It=gt.match(/^(v|f)s:(#)?([\w-]+)$/);if(It){const St=It[2],ot=It[3];St?ot==="decl"?ct[gt]=[ht]:dt[gt]=[ht]:et[gt]=[ht]}else dt[gt]=[ht]}for(const gt of s){w&&gt.checkDeprecations(N,w);const ht=gt.getModuleSource(i,P);V+=ht;const It=gt.injections[i];for(const St in It){const ot=St.match(/^(v|f)s:#([\w-]+)$/);if(ot){const bt=ot[2]==="decl"?ct:dt;bt[St]=bt[St]||[],bt[St].push(It[St])}else et[St]=et[St]||[],et[St].push(It[St])}}return V+=UV,V=N5(V,i,ct),V+=HV(W[i],et),V+=N,V=N5(V,i,dt),V=PV(V,f?100:P,x),V}function NV(r){return function(e){const n={};for(const i of r){const s=i.getUniforms(e,n);Object.assign(n,s)}return n}}function kV(r){let{type:t}=r;return`
#define SHADER_TYPE_`.concat(z5[t].toUpperCase(),`
`)}function QV(r){let{id:t,source:e,type:n}=r;return t&&typeof t=="string"&&e.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(t,"_").concat(z5[n],`

`):""}function zV(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=0,e="";for(const n in r){t===0&&(e+=`
// APPLICATION DEFINES
`),t++;const i=r[n];(i||Number.isFinite(i))&&(e+="#define ".concat(n.toUpperCase()," ").concat(r[n],`
`))}return t===0&&(e+=`
`),e}function HV(r,t){let e="";for(const n in r){const i=r[n];if(e+="void ".concat(i.signature,` {
`),i.header&&(e+="  ".concat(i.header)),t[n]){const s=t[n];s.sort((a,o)=>a.order-o.order);for(const a of s)e+="  ".concat(a.injection,`
`)}i.footer&&(e+="  ".concat(i.footer)),e+=`}
`}return e}function VV(r){const t={vs:{},fs:{}};return r.forEach(e=>{let n;typeof e!="string"?(n=e,e=n.hook):n={},e=e.trim();const[i,s]=e.split(":"),a=e.replace(/\(.+/,"");t[i][a]=Object.assign(n,{signature:s})}),t}const GV="void main() {gl_FragColor = vec4(0);}",V5=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,jV=`#version 300 es
`.concat(V5);function G5(r,t){t=Array.isArray(t)?t:[t];const e=r.replace(/^\s+/,"").split(/\s+/),[n,i,s]=e;if(!t.includes(n)||!i||!s)return null;const a=s.split(";")[0];return{qualifier:n,type:i,name:a}}function j5(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:t=100,input:e,inputType:n,output:i}=r;if(!e)return t===300?jV:t>300?"#version ".concat(t,`
`).concat(V5):GV;const s=$V(e,n);return t>=300?"#version ".concat(t," ").concat(t===300?"es":"",`
in `).concat(n," ").concat(e,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(n," ").concat(e,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function qV(r){switch(r){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Na(!1),null}}function KV(r){switch(r){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Na(!1),null}}function $V(r,t){switch(t){case"float":return"vec4(".concat(r,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(r,", 0.0, 1.0)");case"vec3":return"vec4(".concat(r,", 1.0)");case"vec4":return r;default:return Na(!1),null}}const WV={name:"fp32",vs:`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,fs:null};function Kl(r,t){if(!r)throw new Error("math.gl assertion ".concat(t))}const XV=1/Math.PI*180,JV=1/180*Math.PI,vs={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function YV(r){let{precision:t=vs.precision}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return r=rG(r),"".concat(parseFloat(r.toPrecision(t)))}function QA(r){return Array.isArray(r)||ArrayBuffer.isView(r)&&!(r instanceof DataView)}function ZV(r){return eG(r)}function tG(r){return Hu(r)}function eG(r,t){return Rb(r,e=>e*JV,t)}function Hu(r,t){return Rb(r,e=>e*XV,t)}function Vu(r,t,e){return Rb(r,n=>Math.max(t,Math.min(e,n)))}function j0(r,t,e){return QA(r)?r.map((n,i)=>j0(n,t[i],e)):e*t+(1-e)*r}function $l(r,t,e){const n=vs.EPSILON;e&&(vs.EPSILON=e);try{if(r===t)return!0;if(QA(r)&&QA(t)){if(r.length!==t.length)return!1;for(let i=0;i<r.length;++i)if(!$l(r[i],t[i]))return!1;return!0}return r&&r.equals?r.equals(t):t&&t.equals?t.equals(r):typeof r=="number"&&typeof t=="number"?Math.abs(r-t)<=vs.EPSILON*Math.max(1,Math.abs(r),Math.abs(t)):!1}finally{vs.EPSILON=n}}function rG(r){return Math.round(r/vs.EPSILON)*vs.EPSILON}function nG(r){return r.clone?r.clone():new Array(r.length)}function Rb(r,t,e){if(QA(r)){const n=r;e=e||nG(n);for(let i=0;i<e.length&&i<n.length;++i)e[i]=t(r[i],i,e);return e}return t(r)}function iG(r){function t(){var e=Reflect.construct(r,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return t.prototype=Object.create(r.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r,t}class Ub extends iG(Array){clone(){return new this.constructor().copy(this)}fromArray(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}toArray(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:QA(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(vs)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+YV(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!$l(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){if(n===void 0)return this.lerp(this,t,e);for(let i=0;i<this.ELEMENTS;++i){const s=t[i];this[i]=s+n*(e[i]-s)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let s=0;s<this.ELEMENTS;++s)this[s]+=i[s];return this.check()}subtract(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let s=0;s<this.ELEMENTS;++s)this[s]-=i[s];return this.check()}scale(t){if(typeof t=="number")for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;else for(let e=0;e<this.ELEMENTS&&e<t.length;++e)this[e]*=t[e];return this.check()}multiplyByScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}check(){if(vs.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}get elements(){return this}}function sG(r,t){if(r.length!==t)return!1;for(let e=0;e<r.length;++e)if(!Number.isFinite(r[e]))return!1;return!0}function Dn(r){if(!Number.isFinite(r))throw new Error("Invalid number ".concat(r));return r}function gg(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(vs.debug&&!sG(r,t))throw new Error("math.gl: ".concat(e," some fields set to invalid numbers'"));return r}class Ob extends Ub{get x(){return this[0]}set x(t){this[0]=Dn(t)}get y(){return this[1]}set y(t){this[1]=Dn(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-t[n];e+=i*i}return Dn(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Dn(e)}normalize(){const t=this.magnitude();if(t!==0)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let s=0;s<this.ELEMENTS;++s)this[s]*=i[s];return this.check()}divide(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let s=0;s<this.ELEMENTS;++s)this[s]/=i[s];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return Kl(t>=0&&t<this.ELEMENTS,"index is out of range"),Dn(this[t])}setComponent(t,e){return Kl(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}var mg=1e-6,Wl=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});function oG(){var r=new Wl(2);return Wl!=Float32Array&&(r[0]=0,r[1]=0),r}function q5(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r}function aG(r,t){return r[0]=-t[0],r[1]=-t[1],r}function K5(r,t,e,n){var i=t[0],s=t[1];return r[0]=i+n*(e[0]-i),r[1]=s+n*(e[1]-s),r}function lG(r,t,e){var n=t[0],i=t[1];return r[0]=e[0]*n+e[2]*i,r[1]=e[1]*n+e[3]*i,r}function cG(r,t,e){var n=t[0],i=t[1];return r[0]=e[0]*n+e[2]*i+e[4],r[1]=e[1]*n+e[3]*i+e[5],r}function $5(r,t,e){var n=t[0],i=t[1];return r[0]=e[0]*n+e[3]*i+e[6],r[1]=e[1]*n+e[4]*i+e[7],r}function W5(r,t,e){var n=t[0],i=t[1];return r[0]=e[0]*n+e[4]*i+e[12],r[1]=e[1]*n+e[5]*i+e[13],r}(function(){var r=oG();return function(t,e,n,i,s,a){var o,d;for(e||(e=2),n||(n=0),i?d=Math.min(i*e+n,t.length):d=t.length,o=n;o<d;o+=e)r[0]=t[o],r[1]=t[o+1],s(r,r,a),t[o]=r[0],t[o+1]=r[1];return t}})();function X5(r,t,e){const n=t[0],i=t[1],s=e[3]*n+e[7]*i||1;return r[0]=(e[0]*n+e[4]*i)/s,r[1]=(e[1]*n+e[5]*i)/s,r}function J5(r,t,e){const n=t[0],i=t[1],s=t[2],a=e[3]*n+e[7]*i+e[11]*s||1;return r[0]=(e[0]*n+e[4]*i+e[8]*s)/a,r[1]=(e[1]*n+e[5]*i+e[9]*s)/a,r[2]=(e[2]*n+e[6]*i+e[10]*s)/a,r}function uG(r,t,e){const n=t[0],i=t[1];return r[0]=e[0]*n+e[2]*i,r[1]=e[1]*n+e[3]*i,r[2]=t[2],r}function AG(r,t,e){const n=t[0],i=t[1];return r[0]=e[0]*n+e[2]*i,r[1]=e[1]*n+e[3]*i,r[2]=t[2],r[3]=t[3],r}function Y5(r,t,e){const n=t[0],i=t[1],s=t[2];return r[0]=e[0]*n+e[3]*i+e[6]*s,r[1]=e[1]*n+e[4]*i+e[7]*s,r[2]=e[2]*n+e[5]*i+e[8]*s,r[3]=t[3],r}class Db extends Ob{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;super(2),QA(t)&&arguments.length===1?this.copy(t):(vs.debug&&(Dn(t),Dn(e)),this[0]=t,this[1]=e)}set(t,e){return this[0]=t,this[1]=e,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return vs.debug&&(Dn(t.x),Dn(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return W5(this,this,t),this.check()}transformAsVector(t){return X5(this,this,t),this.check()}transformByMatrix3(t){return $5(this,this,t),this.check()}transformByMatrix2x3(t){return cG(this,this,t),this.check()}transformByMatrix2(t){return lG(this,this,t),this.check()}}function Z5(){var r=new Wl(3);return Wl!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function tI(r){var t=r[0],e=r[1],n=r[2];return Math.hypot(t,e,n)}function eI(r,t,e){var n=new Wl(3);return n[0]=r,n[1]=t,n[2]=e,n}function hG(r,t,e){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r}function dG(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r}function fG(r,t){var e=t[0],n=t[1],i=t[2],s=e*e+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),r[0]=t[0]*s,r[1]=t[1]*s,r[2]=t[2]*s,r}function Nb(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]}function q0(r,t,e){var n=t[0],i=t[1],s=t[2],a=e[0],o=e[1],d=e[2];return r[0]=i*d-s*o,r[1]=s*a-n*d,r[2]=n*o-i*a,r}function kb(r,t,e){var n=t[0],i=t[1],s=t[2],a=e[3]*n+e[7]*i+e[11]*s+e[15];return a=a||1,r[0]=(e[0]*n+e[4]*i+e[8]*s+e[12])/a,r[1]=(e[1]*n+e[5]*i+e[9]*s+e[13])/a,r[2]=(e[2]*n+e[6]*i+e[10]*s+e[14])/a,r}function rI(r,t,e){var n=t[0],i=t[1],s=t[2];return r[0]=n*e[0]+i*e[3]+s*e[6],r[1]=n*e[1]+i*e[4]+s*e[7],r[2]=n*e[2]+i*e[5]+s*e[8],r}function nI(r,t,e){var n=e[0],i=e[1],s=e[2],a=e[3],o=t[0],d=t[1],f=t[2],_=i*f-s*d,w=s*o-n*f,x=n*d-i*o,B=i*x-s*w,P=s*_-n*x,R=n*w-i*_,N=a*2;return _*=N,w*=N,x*=N,B*=2,P*=2,R*=2,r[0]=o+_+B,r[1]=d+w+P,r[2]=f+x+R,r}function pG(r,t,e,n){var i=[],s=[];return i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],s[0]=i[0],s[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),s[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),r[0]=s[0]+e[0],r[1]=s[1]+e[1],r[2]=s[2]+e[2],r}function gG(r,t,e,n){var i=[],s=[];return i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],s[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),s[1]=i[1],s[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),r[0]=s[0]+e[0],r[1]=s[1]+e[1],r[2]=s[2]+e[2],r}function mG(r,t,e,n){var i=[],s=[];return i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],s[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),s[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),s[2]=i[2],r[0]=s[0]+e[0],r[1]=s[1]+e[1],r[2]=s[2]+e[2],r}function yG(r,t){var e=r[0],n=r[1],i=r[2],s=t[0],a=t[1],o=t[2],d=Math.sqrt(e*e+n*n+i*i),f=Math.sqrt(s*s+a*a+o*o),_=d*f,w=_&&Nb(r,t)/_;return Math.acos(Math.min(Math.max(w,-1),1))}var _G=hG,vG=tI;(function(){var r=Z5();return function(t,e,n,i,s,a){var o,d;for(e||(e=3),n||(n=0),i?d=Math.min(i*e+n,t.length):d=t.length,o=n;o<d;o+=e)r[0]=t[o],r[1]=t[o+1],r[2]=t[o+2],s(r,r,a),t[o]=r[0],t[o+1]=r[1],t[o+2]=r[2];return t}})();const Qb=[0,0,0];let K0;class ie extends Ob{static get ZERO(){return K0||(K0=new ie(0,0,0),Object.freeze(K0)),K0}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;super(-0,-0,-0),arguments.length===1&&QA(t)?this.copy(t):(vs.debug&&(Dn(t),Dn(e),Dn(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return vs.debug&&(Dn(t.x),Dn(t.y),Dn(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=Dn(t)}angle(t){return yG(this,t)}cross(t){return q0(this,this,t),this.check()}rotateX(t){let{radians:e,origin:n=Qb}=t;return pG(this,this,n,e),this.check()}rotateY(t){let{radians:e,origin:n=Qb}=t;return gG(this,this,n,e),this.check()}rotateZ(t){let{radians:e,origin:n=Qb}=t;return mG(this,this,n,e),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return kb(this,this,t),this.check()}transformAsVector(t){return J5(this,this,t),this.check()}transformByMatrix3(t){return rI(this,this,t),this.check()}transformByMatrix2(t){return uG(this,this,t),this.check()}transformByQuaternion(t){return nI(this,this,t),this.check()}}let $0;class zb extends Ob{static get ZERO(){return $0||($0=new zb(0,0,0,0),Object.freeze($0)),$0}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;super(-0,-0,-0,-0),QA(t)&&arguments.length===1?this.copy(t):(vs.debug&&(Dn(t),Dn(e),Dn(n),Dn(i)),this[0]=t,this[1]=e,this[2]=n,this[3]=i)}set(t,e,n,i){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return vs.debug&&(Dn(t.x),Dn(t.y),Dn(t.z),Dn(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=Dn(t)}get w(){return this[3]}set w(t){this[3]=Dn(t)}transform(t){return kb(this,this,t),this.check()}transformByMatrix3(t){return Y5(this,this,t),this.check()}transformByMatrix2(t){return AG(this,this,t),this.check()}transformByQuaternion(t){return nI(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}}class iI extends Ub{toString(){let t="[";if(vs.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=Dn(n),this}getColumn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Array(this.RANK).fill(-0);const n=t*this.RANK;for(let i=0;i<this.RANK;++i)e[i]=this[n+i];return e}setColumn(t,e){const n=t*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=e[i];return this}}function bG(){var r=new Wl(9);return Wl!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function wG(r,t){if(r===t){var e=t[1],n=t[2],i=t[5];r[1]=t[3],r[2]=t[6],r[3]=e,r[5]=t[7],r[6]=n,r[7]=i}else r[0]=t[0],r[1]=t[3],r[2]=t[6],r[3]=t[1],r[4]=t[4],r[5]=t[7],r[6]=t[2],r[7]=t[5],r[8]=t[8];return r}function xG(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5],d=t[6],f=t[7],_=t[8],w=_*a-o*f,x=-_*s+o*d,B=f*s-a*d,P=e*w+n*x+i*B;return P?(P=1/P,r[0]=w*P,r[1]=(-_*n+i*f)*P,r[2]=(o*n-i*a)*P,r[3]=x*P,r[4]=(_*e-i*d)*P,r[5]=(-o*e+i*s)*P,r[6]=B*P,r[7]=(-f*e+n*d)*P,r[8]=(a*e-n*s)*P,r):null}function BG(r){var t=r[0],e=r[1],n=r[2],i=r[3],s=r[4],a=r[5],o=r[6],d=r[7],f=r[8];return t*(f*s-a*d)+e*(-f*i+a*o)+n*(d*i-s*o)}function sI(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],d=t[5],f=t[6],_=t[7],w=t[8],x=e[0],B=e[1],P=e[2],R=e[3],N=e[4],Q=e[5],V=e[6],W=e[7],et=e[8];return r[0]=x*n+B*a+P*f,r[1]=x*i+B*o+P*_,r[2]=x*s+B*d+P*w,r[3]=R*n+N*a+Q*f,r[4]=R*i+N*o+Q*_,r[5]=R*s+N*d+Q*w,r[6]=V*n+W*a+et*f,r[7]=V*i+W*o+et*_,r[8]=V*s+W*d+et*w,r}function CG(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],d=t[5],f=t[6],_=t[7],w=t[8],x=e[0],B=e[1];return r[0]=n,r[1]=i,r[2]=s,r[3]=a,r[4]=o,r[5]=d,r[6]=x*n+B*a+f,r[7]=x*i+B*o+_,r[8]=x*s+B*d+w,r}function EG(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],d=t[5],f=t[6],_=t[7],w=t[8],x=Math.sin(e),B=Math.cos(e);return r[0]=B*n+x*a,r[1]=B*i+x*o,r[2]=B*s+x*d,r[3]=B*a-x*n,r[4]=B*o-x*i,r[5]=B*d-x*s,r[6]=f,r[7]=_,r[8]=w,r}function oI(r,t,e){var n=e[0],i=e[1];return r[0]=n*t[0],r[1]=n*t[1],r[2]=n*t[2],r[3]=i*t[3],r[4]=i*t[4],r[5]=i*t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r}function SG(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=e+e,o=n+n,d=i+i,f=e*a,_=n*a,w=n*o,x=i*a,B=i*o,P=i*d,R=s*a,N=s*o,Q=s*d;return r[0]=1-w-P,r[3]=_-Q,r[6]=x+N,r[1]=_+Q,r[4]=1-f-P,r[7]=B-R,r[2]=x-N,r[5]=B+R,r[8]=1-f-w,r}var Hb;(function(r){r[r.COL0ROW0=0]="COL0ROW0",r[r.COL0ROW1=1]="COL0ROW1",r[r.COL0ROW2=2]="COL0ROW2",r[r.COL1ROW0=3]="COL1ROW0",r[r.COL1ROW1=4]="COL1ROW1",r[r.COL1ROW2=5]="COL1ROW2",r[r.COL2ROW0=6]="COL2ROW0",r[r.COL2ROW1=7]="COL2ROW1",r[r.COL2ROW2=8]="COL2ROW2"})(Hb||(Hb={}));const TG=Object.freeze([1,0,0,0,1,0,0,0,1]);class Oi extends iI{static get IDENTITY(){return FG()}static get ZERO(){return IG()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return Hb}constructor(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):n.length>0?this.copy([t,...n]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(TG)}fromObject(t){return this.check()}fromQuaternion(t){return SG(this,t),this.check()}set(t,e,n,i,s,a,o,d,f){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this[4]=s,this[5]=a,this[6]=o,this[7]=d,this[8]=f,this.check()}setRowMajor(t,e,n,i,s,a,o,d,f){return this[0]=t,this[1]=i,this[2]=o,this[3]=e,this[4]=s,this[5]=d,this[6]=n,this[7]=a,this[8]=f,this.check()}determinant(){return BG(this)}transpose(){return wG(this,this),this.check()}invert(){return xG(this,this),this.check()}multiplyLeft(t){return sI(this,t,this),this.check()}multiplyRight(t){return sI(this,this,t),this.check()}rotate(t){return EG(this,this,t),this.check()}scale(t){return Array.isArray(t)?oI(this,this,t):oI(this,this,[t,t]),this.check()}translate(t){return CG(this,this,t),this.check()}transform(t,e){let n;switch(t.length){case 2:n=$5(e||[-0,-0],t,this);break;case 3:n=rI(e||[-0,-0,-0],t,this);break;case 4:n=Y5(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return gg(n,t.length),n}transformVector(t,e){return this.transform(t,e)}transformVector2(t,e){return this.transform(t,e)}transformVector3(t,e){return this.transform(t,e)}}let W0,X0;function IG(){return W0||(W0=new Oi([0,0,0,0,0,0,0,0,0]),Object.freeze(W0)),W0}function FG(){return X0||(X0=new Oi,Object.freeze(X0)),X0}function LG(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function PG(r,t){if(r===t){var e=t[1],n=t[2],i=t[3],s=t[6],a=t[7],o=t[11];r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=e,r[6]=t[9],r[7]=t[13],r[8]=n,r[9]=s,r[11]=t[14],r[12]=i,r[13]=a,r[14]=o}else r[0]=t[0],r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=t[1],r[5]=t[5],r[6]=t[9],r[7]=t[13],r[8]=t[2],r[9]=t[6],r[10]=t[10],r[11]=t[14],r[12]=t[3],r[13]=t[7],r[14]=t[11],r[15]=t[15];return r}function Vb(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5],d=t[6],f=t[7],_=t[8],w=t[9],x=t[10],B=t[11],P=t[12],R=t[13],N=t[14],Q=t[15],V=e*o-n*a,W=e*d-i*a,et=e*f-s*a,ct=n*d-i*o,dt=n*f-s*o,gt=i*f-s*d,ht=_*R-w*P,It=_*N-x*P,St=_*Q-B*P,ot=w*N-x*R,at=w*Q-B*R,bt=x*Q-B*N,vt=V*bt-W*at+et*ot+ct*St-dt*It+gt*ht;return vt?(vt=1/vt,r[0]=(o*bt-d*at+f*ot)*vt,r[1]=(i*at-n*bt-s*ot)*vt,r[2]=(R*gt-N*dt+Q*ct)*vt,r[3]=(x*dt-w*gt-B*ct)*vt,r[4]=(d*St-a*bt-f*It)*vt,r[5]=(e*bt-i*St+s*It)*vt,r[6]=(N*et-P*gt-Q*W)*vt,r[7]=(_*gt-x*et+B*W)*vt,r[8]=(a*at-o*St+f*ht)*vt,r[9]=(n*St-e*at-s*ht)*vt,r[10]=(P*dt-R*et+Q*V)*vt,r[11]=(w*et-_*dt-B*V)*vt,r[12]=(o*It-a*ot-d*ht)*vt,r[13]=(e*ot-n*It+i*ht)*vt,r[14]=(R*W-P*ct-N*V)*vt,r[15]=(_*ct-w*W+x*V)*vt,r):null}function MG(r){var t=r[0],e=r[1],n=r[2],i=r[3],s=r[4],a=r[5],o=r[6],d=r[7],f=r[8],_=r[9],w=r[10],x=r[11],B=r[12],P=r[13],R=r[14],N=r[15],Q=t*a-e*s,V=t*o-n*s,W=t*d-i*s,et=e*o-n*a,ct=e*d-i*a,dt=n*d-i*o,gt=f*P-_*B,ht=f*R-w*B,It=f*N-x*B,St=_*R-w*P,ot=_*N-x*P,at=w*N-x*R;return Q*at-V*ot+W*St+et*It-ct*ht+dt*gt}function zh(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],d=t[5],f=t[6],_=t[7],w=t[8],x=t[9],B=t[10],P=t[11],R=t[12],N=t[13],Q=t[14],V=t[15],W=e[0],et=e[1],ct=e[2],dt=e[3];return r[0]=W*n+et*o+ct*w+dt*R,r[1]=W*i+et*d+ct*x+dt*N,r[2]=W*s+et*f+ct*B+dt*Q,r[3]=W*a+et*_+ct*P+dt*V,W=e[4],et=e[5],ct=e[6],dt=e[7],r[4]=W*n+et*o+ct*w+dt*R,r[5]=W*i+et*d+ct*x+dt*N,r[6]=W*s+et*f+ct*B+dt*Q,r[7]=W*a+et*_+ct*P+dt*V,W=e[8],et=e[9],ct=e[10],dt=e[11],r[8]=W*n+et*o+ct*w+dt*R,r[9]=W*i+et*d+ct*x+dt*N,r[10]=W*s+et*f+ct*B+dt*Q,r[11]=W*a+et*_+ct*P+dt*V,W=e[12],et=e[13],ct=e[14],dt=e[15],r[12]=W*n+et*o+ct*w+dt*R,r[13]=W*i+et*d+ct*x+dt*N,r[14]=W*s+et*f+ct*B+dt*Q,r[15]=W*a+et*_+ct*P+dt*V,r}function J0(r,t,e){var n=e[0],i=e[1],s=e[2],a,o,d,f,_,w,x,B,P,R,N,Q;return t===r?(r[12]=t[0]*n+t[4]*i+t[8]*s+t[12],r[13]=t[1]*n+t[5]*i+t[9]*s+t[13],r[14]=t[2]*n+t[6]*i+t[10]*s+t[14],r[15]=t[3]*n+t[7]*i+t[11]*s+t[15]):(a=t[0],o=t[1],d=t[2],f=t[3],_=t[4],w=t[5],x=t[6],B=t[7],P=t[8],R=t[9],N=t[10],Q=t[11],r[0]=a,r[1]=o,r[2]=d,r[3]=f,r[4]=_,r[5]=w,r[6]=x,r[7]=B,r[8]=P,r[9]=R,r[10]=N,r[11]=Q,r[12]=a*n+_*i+P*s+t[12],r[13]=o*n+w*i+R*s+t[13],r[14]=d*n+x*i+N*s+t[14],r[15]=f*n+B*i+Q*s+t[15]),r}function Gb(r,t,e){var n=e[0],i=e[1],s=e[2];return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r[3]=t[3]*n,r[4]=t[4]*i,r[5]=t[5]*i,r[6]=t[6]*i,r[7]=t[7]*i,r[8]=t[8]*s,r[9]=t[9]*s,r[10]=t[10]*s,r[11]=t[11]*s,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function RG(r,t,e,n){var i=n[0],s=n[1],a=n[2],o=Math.hypot(i,s,a),d,f,_,w,x,B,P,R,N,Q,V,W,et,ct,dt,gt,ht,It,St,ot,at,bt,vt,$t;return o<mg?null:(o=1/o,i*=o,s*=o,a*=o,d=Math.sin(e),f=Math.cos(e),_=1-f,w=t[0],x=t[1],B=t[2],P=t[3],R=t[4],N=t[5],Q=t[6],V=t[7],W=t[8],et=t[9],ct=t[10],dt=t[11],gt=i*i*_+f,ht=s*i*_+a*d,It=a*i*_-s*d,St=i*s*_-a*d,ot=s*s*_+f,at=a*s*_+i*d,bt=i*a*_+s*d,vt=s*a*_-i*d,$t=a*a*_+f,r[0]=w*gt+R*ht+W*It,r[1]=x*gt+N*ht+et*It,r[2]=B*gt+Q*ht+ct*It,r[3]=P*gt+V*ht+dt*It,r[4]=w*St+R*ot+W*at,r[5]=x*St+N*ot+et*at,r[6]=B*St+Q*ot+ct*at,r[7]=P*St+V*ot+dt*at,r[8]=w*bt+R*vt+W*$t,r[9]=x*bt+N*vt+et*$t,r[10]=B*bt+Q*vt+ct*$t,r[11]=P*bt+V*vt+dt*$t,t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r)}function aI(r,t,e){var n=Math.sin(e),i=Math.cos(e),s=t[4],a=t[5],o=t[6],d=t[7],f=t[8],_=t[9],w=t[10],x=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=s*i+f*n,r[5]=a*i+_*n,r[6]=o*i+w*n,r[7]=d*i+x*n,r[8]=f*i-s*n,r[9]=_*i-a*n,r[10]=w*i-o*n,r[11]=x*i-d*n,r}function UG(r,t,e){var n=Math.sin(e),i=Math.cos(e),s=t[0],a=t[1],o=t[2],d=t[3],f=t[8],_=t[9],w=t[10],x=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=s*i-f*n,r[1]=a*i-_*n,r[2]=o*i-w*n,r[3]=d*i-x*n,r[8]=s*n+f*i,r[9]=a*n+_*i,r[10]=o*n+w*i,r[11]=d*n+x*i,r}function lI(r,t,e){var n=Math.sin(e),i=Math.cos(e),s=t[0],a=t[1],o=t[2],d=t[3],f=t[4],_=t[5],w=t[6],x=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=s*i+f*n,r[1]=a*i+_*n,r[2]=o*i+w*n,r[3]=d*i+x*n,r[4]=f*i-s*n,r[5]=_*i-a*n,r[6]=w*i-o*n,r[7]=x*i-d*n,r}function OG(r,t){var e=t[0],n=t[1],i=t[2],s=t[4],a=t[5],o=t[6],d=t[8],f=t[9],_=t[10];return r[0]=Math.hypot(e,n,i),r[1]=Math.hypot(s,a,o),r[2]=Math.hypot(d,f,_),r}function DG(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=e+e,o=n+n,d=i+i,f=e*a,_=n*a,w=n*o,x=i*a,B=i*o,P=i*d,R=s*a,N=s*o,Q=s*d;return r[0]=1-w-P,r[1]=_+Q,r[2]=x-N,r[3]=0,r[4]=_-Q,r[5]=1-f-P,r[6]=B+R,r[7]=0,r[8]=x+N,r[9]=B-R,r[10]=1-f-w,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function NG(r,t,e,n,i,s,a){var o=1/(e-t),d=1/(i-n),f=1/(s-a);return r[0]=s*2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s*2*d,r[6]=0,r[7]=0,r[8]=(e+t)*o,r[9]=(i+n)*d,r[10]=(a+s)*f,r[11]=-1,r[12]=0,r[13]=0,r[14]=a*s*2*f,r[15]=0,r}function kG(r,t,e,n,i){var s=1/Math.tan(t/2),a;return r[0]=s/e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0?(a=1/(n-i),r[10]=(i+n)*a,r[14]=2*i*n*a):(r[10]=-1,r[14]=-2*n),r}var QG=kG;function zG(r,t,e,n,i,s,a){var o=1/(t-e),d=1/(n-i),f=1/(s-a);return r[0]=-2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*d,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*f,r[11]=0,r[12]=(t+e)*o,r[13]=(i+n)*d,r[14]=(a+s)*f,r[15]=1,r}var HG=zG;function VG(r,t,e,n){var i,s,a,o,d,f,_,w,x,B,P=t[0],R=t[1],N=t[2],Q=n[0],V=n[1],W=n[2],et=e[0],ct=e[1],dt=e[2];return Math.abs(P-et)<mg&&Math.abs(R-ct)<mg&&Math.abs(N-dt)<mg?LG(r):(_=P-et,w=R-ct,x=N-dt,B=1/Math.hypot(_,w,x),_*=B,w*=B,x*=B,i=V*x-W*w,s=W*_-Q*x,a=Q*w-V*_,B=Math.hypot(i,s,a),B?(B=1/B,i*=B,s*=B,a*=B):(i=0,s=0,a=0),o=w*a-x*s,d=x*i-_*a,f=_*s-w*i,B=Math.hypot(o,d,f),B?(B=1/B,o*=B,d*=B,f*=B):(o=0,d=0,f=0),r[0]=i,r[1]=o,r[2]=_,r[3]=0,r[4]=s,r[5]=d,r[6]=w,r[7]=0,r[8]=a,r[9]=f,r[10]=x,r[11]=0,r[12]=-(i*P+s*R+a*N),r[13]=-(o*P+d*R+f*N),r[14]=-(_*P+w*R+x*N),r[15]=1,r)}function GG(){var r=new Wl(4);return Wl!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function jG(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r[3]=t[3]+e[3],r}function cI(r,t,e){return r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r[3]=t[3]*e,r}function qG(r){var t=r[0],e=r[1],n=r[2],i=r[3];return Math.hypot(t,e,n,i)}function KG(r){var t=r[0],e=r[1],n=r[2],i=r[3];return t*t+e*e+n*n+i*i}function $G(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=e*e+n*n+i*i+s*s;return a>0&&(a=1/Math.sqrt(a)),r[0]=e*a,r[1]=n*a,r[2]=i*a,r[3]=s*a,r}function WG(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]*t[3]}function XG(r,t,e,n){var i=t[0],s=t[1],a=t[2],o=t[3];return r[0]=i+n*(e[0]-i),r[1]=s+n*(e[1]-s),r[2]=a+n*(e[2]-a),r[3]=o+n*(e[3]-o),r}function yg(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3];return r[0]=e[0]*n+e[4]*i+e[8]*s+e[12]*a,r[1]=e[1]*n+e[5]*i+e[9]*s+e[13]*a,r[2]=e[2]*n+e[6]*i+e[10]*s+e[14]*a,r[3]=e[3]*n+e[7]*i+e[11]*s+e[15]*a,r}function JG(r,t,e){var n=t[0],i=t[1],s=t[2],a=e[0],o=e[1],d=e[2],f=e[3],_=f*n+o*s-d*i,w=f*i+d*n-a*s,x=f*s+a*i-o*n,B=-a*n-o*i-d*s;return r[0]=_*f+B*-a+w*-d-x*-o,r[1]=w*f+B*-o+x*-a-_*-d,r[2]=x*f+B*-d+_*-o-w*-a,r[3]=t[3],r}(function(){var r=GG();return function(t,e,n,i,s,a){var o,d;for(e||(e=4),n||(n=0),i?d=Math.min(i*e+n,t.length):d=t.length,o=n;o<d;o+=e)r[0]=t[o],r[1]=t[o+1],r[2]=t[o+2],r[3]=t[o+3],s(r,r,a),t[o]=r[0],t[o+1]=r[1],t[o+2]=r[2],t[o+3]=r[3];return t}})();var jb;(function(r){r[r.COL0ROW0=0]="COL0ROW0",r[r.COL0ROW1=1]="COL0ROW1",r[r.COL0ROW2=2]="COL0ROW2",r[r.COL0ROW3=3]="COL0ROW3",r[r.COL1ROW0=4]="COL1ROW0",r[r.COL1ROW1=5]="COL1ROW1",r[r.COL1ROW2=6]="COL1ROW2",r[r.COL1ROW3=7]="COL1ROW3",r[r.COL2ROW0=8]="COL2ROW0",r[r.COL2ROW1=9]="COL2ROW1",r[r.COL2ROW2=10]="COL2ROW2",r[r.COL2ROW3=11]="COL2ROW3",r[r.COL3ROW0=12]="COL3ROW0",r[r.COL3ROW1=13]="COL3ROW1",r[r.COL3ROW2=14]="COL3ROW2",r[r.COL3ROW3=15]="COL3ROW3"})(jb||(jb={}));const YG=45*Math.PI/180,ZG=1,qb=.1,Kb=500,tj=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class xn extends iI{static get IDENTITY(){return rj()}static get ZERO(){return ej()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return jb}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,i,s,a,o,d,f,_,w,x,B,P,R,N){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this[4]=s,this[5]=a,this[6]=o,this[7]=d,this[8]=f,this[9]=_,this[10]=w,this[11]=x,this[12]=B,this[13]=P,this[14]=R,this[15]=N,this.check()}setRowMajor(t,e,n,i,s,a,o,d,f,_,w,x,B,P,R,N){return this[0]=t,this[1]=s,this[2]=f,this[3]=B,this[4]=e,this[5]=a,this[6]=_,this[7]=P,this[8]=n,this[9]=o,this[10]=w,this[11]=R,this[12]=i,this[13]=d,this[14]=x,this[15]=N,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(tj)}fromObject(t){return this.check()}fromQuaternion(t){return DG(this,t),this.check()}frustum(t){const{left:e,right:n,bottom:i,top:s,near:a=qb,far:o=Kb}=t;return o===1/0?nj(this,e,n,i,s,a):NG(this,e,n,i,s,a,o),this.check()}lookAt(t){const{eye:e,center:n=[0,0,0],up:i=[0,1,0]}=t;return VG(this,e,n,i),this.check()}ortho(t){const{left:e,right:n,bottom:i,top:s,near:a=qb,far:o=Kb}=t;return HG(this,e,n,i,s,a,o),this.check()}orthographic(t){const{fovy:e=YG,aspect:n=ZG,focalDistance:i=1,near:s=qb,far:a=Kb}=t;uI(e);const o=e/2,d=i*Math.tan(o),f=d*n;return this.ortho({left:-f,right:f,bottom:-d,top:d,near:s,far:a})}perspective(t){const{fovy:e=45*Math.PI/180,aspect:n=1,near:i=.1,far:s=500}=t;return uI(e),QG(this,e,n,i,s),this.check()}determinant(){return MG(this)}getScale(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[-0,-0,-0];return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[-0,-0,-0];return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],s=1/n[1],a=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*s,t[2]=this[2]*a,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*s,t[6]=this[6]*a,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*s,t[10]=this[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],s=1/n[1],a=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*s,t[2]=this[2]*a,t[3]=this[4]*i,t[4]=this[5]*s,t[5]=this[6]*a,t[6]=this[8]*i,t[7]=this[9]*s,t[8]=this[10]*a,t}transpose(){return PG(this,this),this.check()}invert(){return Vb(this,this),this.check()}multiplyLeft(t){return zh(this,t,this),this.check()}multiplyRight(t){return zh(this,this,t),this.check()}rotateX(t){return aI(this,this,t),this.check()}rotateY(t){return UG(this,this,t),this.check()}rotateZ(t){return lI(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,e){return RG(this,this,t,e),this.check()}scale(t){return Gb(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return J0(this,this,t),this.check()}transform(t,e){return t.length===4?(e=yg(e||[-0,-0,-0,-0],t,this),gg(e,4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;let i;switch(n){case 2:i=W5(e||[-0,-0],t,this);break;case 3:i=kb(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return gg(i,t.length),i}transformAsVector(t,e){let n;switch(t.length){case 2:n=X5(e||[-0,-0],t,this);break;case 3:n=J5(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return gg(n,t.length),n}transformPoint(t,e){return this.transformAsPoint(t,e)}transformVector(t,e){return this.transformAsPoint(t,e)}transformDirection(t,e){return this.transformAsVector(t,e)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}}let Y0,Z0;function ej(){return Y0||(Y0=new xn([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Y0)),Y0}function rj(){return Z0||(Z0=new xn,Object.freeze(Z0)),Z0}function uI(r){if(r>Math.PI*2)throw Error("expected radians")}function nj(r,t,e,n,i,s){const a=2*s/(e-t),o=2*s/(i-n),d=(e+t)/(e-t),f=(i+n)/(i-n),_=-1,w=-1,x=-2*s;return r[0]=a,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o,r[6]=0,r[7]=0,r[8]=d,r[9]=f,r[10]=_,r[11]=w,r[12]=0,r[13]=0,r[14]=x,r[15]=0,r}function AI(){var r=new Wl(4);return Wl!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function ij(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function hI(r,t,e){e=e*.5;var n=Math.sin(e);return r[0]=n*t[0],r[1]=n*t[1],r[2]=n*t[2],r[3]=Math.cos(e),r}function dI(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3],o=e[0],d=e[1],f=e[2],_=e[3];return r[0]=n*_+a*o+i*f-s*d,r[1]=i*_+a*d+s*o-n*f,r[2]=s*_+a*f+n*d-i*o,r[3]=a*_-n*o-i*d-s*f,r}function sj(r,t,e){e*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(e),d=Math.cos(e);return r[0]=n*d+a*o,r[1]=i*d+s*o,r[2]=s*d-i*o,r[3]=a*d-n*o,r}function oj(r,t,e){e*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(e),d=Math.cos(e);return r[0]=n*d-s*o,r[1]=i*d+a*o,r[2]=s*d+n*o,r[3]=a*d-i*o,r}function aj(r,t,e){e*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(e),d=Math.cos(e);return r[0]=n*d+i*o,r[1]=i*d-n*o,r[2]=s*d+a*o,r[3]=a*d-s*o,r}function lj(r,t){var e=t[0],n=t[1],i=t[2];return r[0]=e,r[1]=n,r[2]=i,r[3]=Math.sqrt(Math.abs(1-e*e-n*n-i*i)),r}function ty(r,t,e,n){var i=t[0],s=t[1],a=t[2],o=t[3],d=e[0],f=e[1],_=e[2],w=e[3],x,B,P,R,N;return B=i*d+s*f+a*_+o*w,B<0&&(B=-B,d=-d,f=-f,_=-_,w=-w),1-B>mg?(x=Math.acos(B),P=Math.sin(x),R=Math.sin((1-n)*x)/P,N=Math.sin(n*x)/P):(R=1-n,N=n),r[0]=R*i+N*d,r[1]=R*s+N*f,r[2]=R*a+N*_,r[3]=R*o+N*w,r}function cj(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=e*e+n*n+i*i+s*s,o=a?1/a:0;return r[0]=-e*o,r[1]=-n*o,r[2]=-i*o,r[3]=s*o,r}function uj(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=t[3],r}function fI(r,t){var e=t[0]+t[4]+t[8],n;if(e>0)n=Math.sqrt(e+1),r[3]=.5*n,n=.5/n,r[0]=(t[5]-t[7])*n,r[1]=(t[6]-t[2])*n,r[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var s=(i+1)%3,a=(i+2)%3;n=Math.sqrt(t[i*3+i]-t[s*3+s]-t[a*3+a]+1),r[i]=.5*n,n=.5/n,r[3]=(t[s*3+a]-t[a*3+s])*n,r[s]=(t[s*3+i]+t[i*3+s])*n,r[a]=(t[a*3+i]+t[i*3+a])*n}return r}var Aj=jG,hj=cI,dj=WG,fj=XG,pj=qG,gj=KG,pI=$G,mj=function(){var r=Z5(),t=eI(1,0,0),e=eI(0,1,0);return function(n,i,s){var a=Nb(i,s);return a<-.999999?(q0(r,t,i),vG(r)<1e-6&&q0(r,e,i),fG(r,r),hI(n,r,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(q0(r,i,s),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=1+a,pI(n,n))}}();(function(){var r=AI(),t=AI();return function(e,n,i,s,a,o){return ty(r,n,a,o),ty(t,i,s,o),ty(e,r,t,2*o*(1-o)),e}})(),function(){var r=bG();return function(t,e,n,i){return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=-e[0],r[5]=-e[1],r[8]=-e[2],pI(t,fI(t,r))}}();const yj=[0,0,0,1];class _g extends Ub{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;super(-0,-0,-0,-0),Array.isArray(t)&&arguments.length===1?this.copy(t):this.set(t,e,n,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,n,i){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return fI(this,t),this.check()}fromAxisRotation(t,e){return hI(this,t,e),this.check()}identity(){return ij(this),this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=Dn(t)}get y(){return this[1]}set y(t){this[1]=Dn(t)}get z(){return this[2]}set z(t){this[2]=Dn(t)}get w(){return this[3]}set w(t){this[3]=Dn(t)}len(){return pj(this)}lengthSquared(){return gj(this)}dot(t){return dj(this,t)}rotationTo(t,e){return mj(this,t,e),this.check()}add(t){return Aj(this,this,t),this.check()}calculateW(){return lj(this,this),this.check()}conjugate(){return uj(this,this),this.check()}invert(){return cj(this,this),this.check()}lerp(t,e,n){return n===void 0?this.lerp(this,t,e):(fj(this,t,e,n),this.check())}multiplyRight(t){return dI(this,this,t),this.check()}multiplyLeft(t){return dI(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,t===0&&(this[3]=1),this.check()}rotateX(t){return sj(this,this,t),this.check()}rotateY(t){return oj(this,this,t),this.check()}rotateZ(t){return aj(this,this,t),this.check()}scale(t){return hj(this,this,t),this.check()}slerp(t,e,n){let i,s,a;switch(arguments.length){case 1:({start:i=yj,target:s,ratio:a}=t);break;case 2:i=this,s=t,a=e;break;default:i=t,s=e,a=n}return ty(this,i,s,a),this.check()}transformVector4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new zb;return JG(e,t,this),gg(e,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}}const vg={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},gI=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,_j={lightSources:{}};function $b(){let{color:r=[0,0,0],intensity:t=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return r.map(e=>e*t/255)}function vj(r){let{ambientLight:t,pointLights:e=[],directionalLights:n=[]}=r;const i={};return t?i["lighting_uAmbientLight.color"]=$b(t):i["lighting_uAmbientLight.color"]=[0,0,0],e.forEach((s,a)=>{i["lighting_uPointLight[".concat(a,"].color")]=$b(s),i["lighting_uPointLight[".concat(a,"].position")]=s.position,i["lighting_uPointLight[".concat(a,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=e.length,n.forEach((s,a)=>{i["lighting_uDirectionalLight[".concat(a,"].color")]=$b(s),i["lighting_uDirectionalLight[".concat(a,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=n.length,i}function mI(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_j;if("lightSources"in r){const{ambientLight:t,pointLights:e,directionalLights:n}=r.lightSources||{};return t||e&&e.length>0||n&&n.length>0?Object.assign({},vj({ambientLight:t,pointLights:e,directionalLights:n}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in r){const t={pointLights:[],directionalLights:[]};for(const e of r.lights||[])switch(e.type){case"ambient":t.ambientLight=e;break;case"directional":t.directionalLights.push(e);break;case"point":t.pointLights.push(e);break}return mI({lightSources:t})}return{}}const Wb={name:"lights",vs:gI,fs:gI,getUniforms:mI,defines:{MAX_LIGHTS:3}},bj={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1};function wj(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bj;const t={};if(r.pickingSelectedColor!==void 0)if(!r.pickingSelectedColor)t.picking_uSelectedColorValid=0;else{const e=r.pickingSelectedColor.slice(0,3);t.picking_uSelectedColorValid=1,t.picking_uSelectedColor=e}if(r.pickingHighlightColor){const e=Array.from(r.pickingHighlightColor,n=>n/255);Number.isFinite(e[3])||(e[3]=1),t.picking_uHighlightColor=e}return r.pickingActive!==void 0&&(t.picking_uActive=!!r.pickingActive,t.picking_uAttribute=!!r.pickingAttribute),t}const xj={name:"picking",vs:`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,fs:`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,getUniforms:wj},yI=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,Bj={};function Cj(r){const{ambient:t=.35,diffuse:e=.6,shininess:n=32,specularColor:i=[30,30,30]}=r;return{lighting_uAmbient:t,lighting_uDiffuse:e,lighting_uShininess:n,lighting_uSpecularColor:i.map(s=>s/255)}}function _I(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Bj;if(!("material"in r))return{};const{material:t}=r;return t?Cj(t):{lighting_uEnabled:!1}}const Ej={name:"gouraud-lighting",dependencies:[Wb],vs:yI,defines:{LIGHTING_VERTEX:1},getUniforms:_I},Sj={name:"phong-lighting",dependencies:[Wb],fs:yI,defines:{LIGHTING_FRAGMENT:1},getUniforms:_I},Xb={name:"pbr",vs:`uniform mat4 u_MVPMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_NormalMatrix;

varying vec3 pbr_vPosition;
varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
# ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
# else
varying vec3 pbr_vNormal;
# endif
#endif

void pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)
{
  vec4 pos = u_ModelMatrix * position;
  pbr_vPosition = vec3(pos.xyz) / pos.w;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));
  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));
  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;
  pbr_vTBN = mat3(tangentW, bitangentW, normalW);
#else
  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));
#endif
#endif

#ifdef HAS_UV
  pbr_vUV = uv;
#else
  pbr_vUV = vec2(0.,0.);
#endif
}
`,fs:`#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)
# error PBR fragment shader: Texture LOD is not available
#endif

#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)
# error PBR fragment shader: Derivatives are not available
#endif


#if (__VERSION__ < 300)
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)
#else
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)
#endif

precision highp float;

uniform bool pbr_uUnlit;

#ifdef USE_IBL
uniform samplerCube u_DiffuseEnvSampler;
uniform samplerCube u_SpecularEnvSampler;
uniform sampler2D u_brdfLUT;
uniform vec2 u_ScaleIBLAmbient;
#endif

#ifdef HAS_BASECOLORMAP
uniform sampler2D u_BaseColorSampler;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D u_NormalSampler;
uniform float u_NormalScale;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D u_EmissiveSampler;
uniform vec3 u_EmissiveFactor;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D u_MetallicRoughnessSampler;
#endif
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D u_OcclusionSampler;
uniform float u_OcclusionStrength;
#endif

#ifdef ALPHA_CUTOFF
uniform float u_AlphaCutoff;
#endif

uniform vec2 u_MetallicRoughnessValues;
uniform vec4 u_BaseColorFactor;

uniform vec3 u_Camera;
#ifdef PBR_DEBUG
uniform vec4 u_ScaleDiffBaseMR;
uniform vec4 u_ScaleFGDSpec;
#endif

varying vec3 pbr_vPosition;

varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
#else
varying vec3 pbr_vNormal;
#endif
#endif


struct PBRInfo
{
  float NdotL;
  float NdotV;
  float NdotH;
  float LdotH;
  float VdotH;
  float perceptualRoughness;
  float metalness;
  vec3 reflectance0;
  vec3 reflectance90;
  float alphaRoughness;
  vec3 diffuseColor;
  vec3 specularColor;
  vec3 n;
  vec3 v;
};

const float M_PI = 3.141592653589793;
const float c_MinRoughness = 0.04;

vec4 SRGBtoLINEAR(vec4 srgbIn)
{
#ifdef MANUAL_SRGB
#ifdef SRGB_FAST_APPROXIMATION
  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));
#else
  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);
  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );
#endif
  return vec4(linOut,srgbIn.w);;
#else
  return srgbIn;
#endif
}

vec3 getNormal()
{
#ifndef HAS_TANGENTS
  vec3 pos_dx = dFdx(pbr_vPosition);
  vec3 pos_dy = dFdy(pbr_vPosition);
  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));
  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));
  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);

#ifdef HAS_NORMALS
  vec3 ng = normalize(pbr_vNormal);
#else
  vec3 ng = cross(pos_dx, pos_dy);
#endif

  t = normalize(t - ng * dot(ng, t));
  vec3 b = normalize(cross(ng, t));
  mat3 tbn = mat3(t, b, ng);
#else
  mat3 tbn = pbr_vTBN;
#endif

#ifdef HAS_NORMALMAP
  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;
  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));
#else
  vec3 n = normalize(tbn[2].xyz);
#endif

  return n;
}


#ifdef USE_IBL
vec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)
{
  float mipCount = 9.0;
  float lod = (pbrInputs.perceptualRoughness * mipCount);
  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,
    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;
  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;

#ifdef USE_TEX_LOD
  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;
#else
  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;
#endif

  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;
  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);
  diffuse *= u_ScaleIBLAmbient.x;
  specular *= u_ScaleIBLAmbient.y;

  return diffuse + specular;
}
#endif


vec3 diffuse(PBRInfo pbrInputs)
{
  return pbrInputs.diffuseColor / M_PI;
}

vec3 specularReflection(PBRInfo pbrInputs)
{
  return pbrInputs.reflectance0 +
    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *
    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);
}



float geometricOcclusion(PBRInfo pbrInputs)
{
  float NdotL = pbrInputs.NdotL;
  float NdotV = pbrInputs.NdotV;
  float r = pbrInputs.alphaRoughness;

  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));
  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));
  return attenuationL * attenuationV;
}





float microfacetDistribution(PBRInfo pbrInputs)
{
  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;
  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;
  return roughnessSq / (M_PI * f * f);
}

void PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {
  pbrInputs.NdotL = 1.0;
  pbrInputs.NdotH = 0.0;
  pbrInputs.LdotH = 0.0;
  pbrInputs.VdotH = 1.0;
}

void PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {
  vec3 n = pbrInputs.n;
  vec3 v = pbrInputs.v;
  vec3 l = normalize(lightDirection);
  vec3 h = normalize(l+v);

  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);
  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);
  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);
  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);
}

void PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {
  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);
  PBRInfo_setDirectionalLight(pbrInputs, light_direction);
}

vec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {
  vec3 F = specularReflection(pbrInputs);
  float G = geometricOcclusion(pbrInputs);
  float D = microfacetDistribution(pbrInputs);
  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);
  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);
  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);
}

vec4 pbr_filterColor(vec4 colorUnused)
{
#ifdef HAS_BASECOLORMAP
  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;
#else
  vec4 baseColor = u_BaseColorFactor;
#endif

#ifdef ALPHA_CUTOFF
  if (baseColor.a < u_AlphaCutoff) {
    discard;
  }
#endif

  vec3 color = vec3(0, 0, 0);

  if(pbr_uUnlit){
    color.rgb = baseColor.rgb;
  }
  else{


    float perceptualRoughness = u_MetallicRoughnessValues.y;
    float metallic = u_MetallicRoughnessValues.x;
#ifdef HAS_METALROUGHNESSMAP

    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);
    perceptualRoughness = mrSample.g * perceptualRoughness;
    metallic = mrSample.b * metallic;
#endif
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);
    metallic = clamp(metallic, 0.0, 1.0);

    float alphaRoughness = perceptualRoughness * perceptualRoughness;

    vec3 f0 = vec3(0.04);
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);
    diffuseColor *= 1.0 - metallic;
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);



    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);
    vec3 specularEnvironmentR0 = specularColor.rgb;
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;

    vec3 n = getNormal();
    vec3 v = normalize(u_Camera - pbr_vPosition);

    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);
    vec3 reflection = -normalize(reflect(v, n));

    PBRInfo pbrInputs = PBRInfo(
      0.0,
      NdotV,
      0.0,
      0.0,
      0.0,
      perceptualRoughness,
      metallic,
      specularEnvironmentR0,
      specularEnvironmentR90,
      alphaRoughness,
      diffuseColor,
      specularColor,
      n,
      v
    );

#ifdef USE_LIGHTS
    PBRInfo_setAmbientLight(pbrInputs);
    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {
      if (i < lighting_uDirectionalLightCount) {
        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);
        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);
      }
    }
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {
      if (i < lighting_uPointLightCount) {
        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);
        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));
        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);
      }
    }
#endif
#ifdef USE_IBL
    color += getIBLContribution(pbrInputs, n, reflection);
#endif
#ifdef HAS_OCCLUSIONMAP
    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;
    color = mix(color, color * ao, u_OcclusionStrength);
#endif

#ifdef HAS_EMISSIVEMAP
    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;
    color += emissive;
#endif

#ifdef PBR_DEBUG





    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);
    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);
    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);
#endif

  }

  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);
}
`,defines:{LIGHTING_FRAGMENT:1},dependencies:[Wb]},Tj={name:"transform",vs:`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,fs:null};class bg{static getDefaultProgramManager(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new bg(t),t.luma.defaultProgramManager}constructor(t){this.gl=t,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(t){this._defaultModules.find(e=>e.name===t.name)||this._defaultModules.push(t),this.stateHash++}removeDefaultModule(t){const e=typeof t=="string"?t:t.name;this._defaultModules=this._defaultModules.filter(n=>n.name!==e),this.stateHash++}addShaderHook(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t),this.stateHash++}get(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:e="",fs:n="",defines:i={},inject:s={},varyings:a=[],bufferMode:o=35981,transpileToGLSL100:d=!1}=t,f=this._getModuleList(t.modules),_=this._getHash(e),w=this._getHash(n),x=f.map(W=>this._getHash(W.name)).sort(),B=a.map(W=>this._getHash(W)),P=Object.keys(i).sort(),R=Object.keys(s).sort(),N=[],Q=[];for(const W of P)N.push(this._getHash(W)),N.push(this._getHash(i[W]));for(const W of R)Q.push(this._getHash(W)),Q.push(this._getHash(s[W]));const V="".concat(_,"/").concat(w,"D").concat(N.join("/"),"M").concat(x.join("/"),"I").concat(Q.join("/"),"V").concat(B.join("/"),"H").concat(this.stateHash,"B").concat(o).concat(d?"T":"");if(!this._programCache[V]){const W=DV(this.gl,{vs:e,fs:n,modules:f,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:d});this._programCache[V]=new C5(this.gl,{hash:V,vs:W.vs,fs:W.fs,varyings:a,bufferMode:o}),this._getUniforms[V]=W.getUniforms||(et=>{}),this._useCounts[V]=0}return this._useCounts[V]++,this._programCache[V]}getUniforms(t){return this._getUniforms[t.hash]||null}release(t){const e=t.hash;this._useCounts[e]--,this._useCounts[e]===0&&(this._programCache[e].delete(),delete this._programCache[e],delete this._getUniforms[e],delete this._useCounts[e])}_getHash(t){return this._hashes[t]===void 0&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}_getModuleList(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=new Array(this._defaultModules.length+t.length),n={};let i=0;for(let s=0,a=this._defaultModules.length;s<a;++s){const o=this._defaultModules[s],d=o.name;e[i++]=o,n[d]=!0}for(let s=0,a=t.length;s<a;++s){const o=t[s],d=o.name;n[d]||(e[i++]=o,n[d]=!0)}return e.length=i,e}}const Ij={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function Fj(r,t,e){const n={};let i=t.indices;for(const s in t.attributes){const a=t.attributes[s],o=Lj(s);if(s==="indices")i=a;else if(a.constant)n[o]=a.value;else{const d=a.value,f={...a};delete f.value,n[o]=[new ni(r,d),f],Pj(s,f)}}if(i){const s=i.value||i;rr(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const a={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};n.indices=[new ni(r,{data:s,target:34963}),a]}return n}function Lj(r,t){const{attributeMap:e=Ij}={};return e&&e[r]||r}function Pj(r,t){let e;switch(r){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":e="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":e="vectors";break}switch(e){case"vectors":t.size=t.size||3;break;case"uvs":t.size=t.size||2;break}rr(Number.isFinite(t.size),"attribute ".concat(r," needs size"))}const of=2,Mj=1e4,Rj="Model needs drawMode and vertexCount",vI=()=>{},Uj={};class af{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:n=ku("model")}=e;rr(M0(t)),this.id=n,this.gl=t,this.id=e.id||ku("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(e)}initialize(t){this.props={},this.programManager=t.programManager||bg.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:e=null,vs:n,fs:i,modules:s,defines:a,inject:o,varyings:d,bufferMode:f,transpileToGLSL100:_}=t;this.programProps={program:e,vs:n,fs:i,modules:s,defines:a,inject:o,varyings:d,bufferMode:f,transpileToGLSL100:_},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(t.moduleSettings))),this.drawMode=t.drawMode!==void 0?t.drawMode:4,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced||t.instanceCount>0,this._setModelProps(t),this.geometry={},rr(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),Rj)}setProps(t){this._setModelProps(t)}delete(){for(const t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(t){const{program:e,vs:n,fs:i,modules:s,defines:a,inject:o,varyings:d,bufferMode:f,transpileToGLSL100:_}=t;this.programProps={program:e,vs:n,fs:i,modules:s,defines:a,inject:o,varyings:d,bufferMode:f,transpileToGLSL100:_},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(t){return this.drawMode=t,this}setVertexCount(t){return rr(Number.isFinite(t)),this.vertexCount=t,this}setInstanceCount(t){return rr(Number.isFinite(t)),this.instanceCount=t,this}setGeometry(t){return this.drawMode=t.drawMode,this.vertexCount=t.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=Fj(this.gl,t),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(tf(t))return this;const e={};for(const n in t){const i=t[n];e[n]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(e),this}setUniforms(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,t),this}getModuleUniforms(t){this._checkProgram();const e=this.programManager.getUniforms(this.program);return e?e(t):{}}updateModuleSettings(t){const e=this.getModuleUniforms(t||{});return this.setUniforms(e)}clear(t){return _b(this.program.gl,t),this}draw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:e=null,framebuffer:n,uniforms:i={},attributes:s={},transformFeedback:a=this.transformFeedback,parameters:o={},vertexArray:d=this.vertexArray}=t;this.setAttributes(s),this.updateModuleSettings(e),this.setUniforms(i);let f;br.priority>=of&&(f=this._logDrawCallStart(of));const _=this.vertexArray.getDrawParams(),{isIndexed:w=_.isIndexed,indexType:x=_.indexType,indexOffset:B=_.indexOffset,vertexArrayInstanced:P=_.isInstanced}=this.props;P&&!this.isInstanced&&br.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:R,instanceCount:N}=this,{onBeforeRender:Q=vI,onAfterRender:V=vI}=this.props;Q(),this.program.setUniforms(this.uniforms);const W=this.program.draw(Object.assign(Uj,t,{logPriority:f,uniforms:null,framebuffer:n,parameters:o,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:d,transformFeedback:a,isIndexed:w,indexType:x,isInstanced:R,instanceCount:N,offset:w?B:0}));return V(),br.priority>=of&&this._logDrawCallEnd(f,d,n),W}transform(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:e=!0,feedbackBuffers:n,unbindModels:i=[]}=t;let{parameters:s}=t;n&&this._setFeedbackBuffers(n),e&&(s=Object.assign({},s,{35977:e})),i.forEach(a=>a.vertexArray.unbindBuffers());try{this.draw(Object.assign({},t,{parameters:s}))}finally{i.forEach(a=>a.vertexArray.bindBuffers())}return this}render(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return br.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(t).draw()}_setModelProps(t){Object.assign(this.props,t),"uniforms"in t&&this.setUniforms(t.uniforms),"pickable"in t&&(this.pickable=t.pickable),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:e}=this.programProps;if(e)this._managedProgram=!1;else{const{vs:n,fs:i,modules:s,inject:a,defines:o,varyings:d,bufferMode:f,transpileToGLSL100:_}=this.programProps;e=this.programManager.get({vs:n,fs:i,modules:s,inject:a,defines:o,varyings:d,bufferMode:f,transpileToGLSL100:_}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}rr(e instanceof C5,"Model needs a program"),this._programDirty=!1,e!==this.program&&(this.program=e,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Y9(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const t in this.geometryBuffers){const e=this.geometryBuffers[t][0]||this.geometryBuffers[t];e instanceof ni&&e.delete()}}_setAnimationProps(t){this.animated&&rr(t,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(tf(t))return this;const{gl:e}=this.program;return this.transformFeedback=this.transformFeedback||new E5(e,{program:this.program}),this.transformFeedback.setBuffers(t),this}_logDrawCallStart(t){const e=t>3?0:Mj;if(!(Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),br.group(of,">>> DRAWING MODEL ".concat(this.id),{collapsed:br.level<=2})(),t}_logDrawCallEnd(t,e,n,i){if(t===void 0)return;const s=eV({vertexArray:e,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:a,unusedTable:o,unusedCount:d}=S5({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:f,count:_}=S5({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});_>0&&br.log("MISSING UNIFORMS",Object.keys(f))(),d>0&&br.log("UNUSED UNIFORMS",Object.keys(o))();const w=nV(this.vertexArray.configuration);br.table(t,s)(),br.table(t,a)(),br.table(t+1,w)(),i&&i.log({logLevel:of,message:"Rendered to ".concat(i.id)}),br.groupEnd(of)()}}class Oj{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=t,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}setupResources(t){for(const e of this.bindings)this._setupTransformFeedback(e,t)}updateModelProps(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:e}=this;return e.length>0&&(t=Object.assign({},t,{varyings:e})),t}getDrawOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:i}=e;return{attributes:Object.assign({},n,t.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(t)}getBuffer(t){const{feedbackBuffers:e}=this.bindings[this.currentIndex],n=t?e[t]:null;return n?n instanceof ni?n:n.buffer:null}getData(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:e}=t,n=this.getBuffer(e);return n?n.getData():null}delete(){for(const t in this.resources)this.resources[t].delete()}_initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&rr(mn(this.gl))}_getFeedbackBuffers(t){const{sourceBuffers:e={}}=t,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in e&&(n[s]=i)}Object.assign(n,t.feedbackBuffers);for(const i in n){const s=n[i];if(typeof s=="string"){const a=e[s],{byteLength:o,usage:d,accessor:f}=a;n[i]=this._createNewBuffer(i,{byteLength:o,usage:d,accessor:f})}}return n}_setupBuffers(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:e=null}=t;Object.assign(this.feedbackMap,t.feedbackMap);const n=this._getFeedbackBuffers(t);this._updateBindings({sourceBuffers:e,feedbackBuffers:n})}_setupTransformFeedback(t,e){let{model:n}=e;const{program:i}=n;t.transformFeedback=new E5(this.gl,{program:i,buffers:t.feedbackBuffers})}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this.feedbackMap){const{sourceBuffers:e,feedbackBuffers:n}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:e,feedbackBuffers:n})}}_updateBinding(t,e){return t?(Object.assign(t.sourceBuffers,e.sourceBuffers),Object.assign(t.feedbackBuffers,e.feedbackBuffers),t.transformFeedback&&t.transformFeedback.setBuffers(t.feedbackBuffers),t):{sourceBuffers:Object.assign({},e.sourceBuffers),feedbackBuffers:Object.assign({},e.feedbackBuffers)}}_swapBuffers(t){if(!this.feedbackMap)return null;const e=Object.assign({},t.sourceBuffers),n=Object.assign({},t.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];e[i]=t.feedbackBuffers[s],n[s]=t.sourceBuffers[i],rr(n[s]instanceof ni)}return{sourceBuffers:e,feedbackBuffers:n}}_createNewBuffer(t,e){const n=new ni(this.gl,e);return this.resources[t]&&this.resources[t].delete(),this.resources[t]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}const Dj="transform_uSampler_",ey="transform_uSize_",bI="transform_position";function Nj(r){let{vs:t,sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}=r,a=Object.keys(e).length,o=null;const d={};let f=t,_={};if(a>0||n){const w=f.split(`
`),x=w.slice();if(w.forEach((B,P,R)=>{if(a>0){const N=Vj(B,e);if(N){const{updatedLine:Q,inject:V}=N;x[P]=Q,_=Lb([_,V]),Object.assign(d,N.samplerTextureMap),a--}}n&&!o&&(o=Hj(B,n))}),n){rr(i);const B="".concat(ey).concat(n),P="uniform vec2 ".concat(B,`;
`),R="     vec2 ".concat(bI," = transform_getPos(").concat(B,`);
     gl_Position = vec4(`).concat(bI,`, 0, 1.);
`);_=Lb([_,{"vs:#decl":P,"vs:#main-start":R}])}f=x.join(`
`)}return{vs:f,targetTextureType:o,inject:_,samplerTextureMap:d}}function kj(r){let{sourceTextureMap:t,targetTextureVarying:e,targetTexture:n}=r;const i={};let s,a;e&&({width:s,height:a}=n,i["".concat(ey).concat(e)]=[s,a]);for(const o in t)({width:s,height:a}=t[o]),i["".concat(ey).concat(o)]=[s,a];return i}function Qj(r){return G5(r,["attribute","in"])}function zj(r){const t="".concat(Dj).concat(r),e="".concat(ey).concat(r),n="  uniform sampler2D ".concat(t,`;
  uniform vec2 `).concat(e,";");return{samplerName:t,sizeName:e,uniformDeclerations:n}}function Hj(r,t){const e=G5(r,["varying","out"]);return e&&e.name===t?e.type:null}function Vj(r,t){const e={},n=Qj(r);if(!n)return null;const{type:i,name:s}=n;if(s&&t[s]){const a="// ".concat(r," => Replaced by Transform with a sampler"),{samplerName:o,sizeName:d,uniformDeclerations:f}=zj(s),_=qV(i),w="  ".concat(i," ").concat(s," = transform_getInput(").concat(o,", ").concat(d,").").concat(_,`;
`);return e[o]=s,{updatedLine:a,inject:{"vs:#decl":f,"vs:#main-start":w},samplerTextureMap:e}}return null}const Gj={10241:9728,10240:9728,10242:33071,10243:33071},jj="transform_output";class qj{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=t,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}updateModelProps(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=this._processVertexShader(t);return Object.assign({},t,e)}getDrawOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:e,sourceTextures:n,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],a=Object.assign({},e,t.attributes),o=Object.assign({},t.uniforms),d=Object.assign({},t.parameters);let f=t.discard;if(this.hasSourceTextures||this.hasTargetTexture){a.transform_elementID=this.elementIDBuffer;for(const w in this.samplerTextureMap){const x=this.samplerTextureMap[w];o[w]=n[x]}this._setSourceTextureParameters();const _=kj({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(o,_)}return this.hasTargetTexture&&(f=!1,d.viewport=[0,0,i.width,i.height]),{attributes:a,framebuffer:i,uniforms:o,discard:f,parameters:d}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(t)}getTargetTexture(){const{targetTexture:t}=this.bindings[this.currentIndex];return t}getData(){let{packed:t=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:e}=this.bindings[this.currentIndex],n=U0(e);if(!t)return n;const i=n.constructor,s=KV(this.targetTextureType),a=new i(n.length*s/4);let o=0;for(let d=0;d<n.length;d+=4)for(let f=0;f<s;f++)a[o++]=n[d+f];return a}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:e,_swapTexture:n}=t;this._swapTexture=n,this.targetTextureVarying=e,this.hasTargetTexture=e,this._setupTextures(t)}_createTargetTexture(t){const{sourceTextures:e,textureOrReference:n}=t;if(n instanceof Ua)return n;const i=e[n];return i?(this._targetRefTexName=n,this._createNewTexture(i)):null}_setupTextures(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:e,_sourceTextures:n={},_targetTexture:i}=t,s=this._createTargetTexture({sourceTextures:n,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:e,sourceTextures:n,targetTexture:s}),"elementCount"in t&&this._updateElementIDBuffer(t.elementCount)}_updateElementIDBuffer(t){if(typeof t!="number"||this.elementCount>=t)return;const e=new Float32Array(t);e.forEach((n,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new ni(this.gl,{data:e,accessor:{size:1}}),this.elementCount=t}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this._swapTexture){const{sourceTextures:e,targetTexture:n}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:e,targetTexture:n})}}_updateBinding(t,e){const{sourceBuffers:n,sourceTextures:i,targetTexture:s}=e;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,i),Object.assign(t.sourceBuffers,n),s){t.targetTexture=s;const{width:a,height:o}=s,{framebuffer:d}=t;d?(d.update({attachments:{36064:s},resizeAttachments:!1}),d.resize({width:a,height:o})):t.framebuffer=new ys(this.gl,{id:"transform-framebuffer",width:a,height:o,attachments:{36064:s}})}return t}_setSourceTextureParameters(){const t=this.currentIndex,{sourceTextures:e}=this.bindings[t];for(const n in e)e[n].setParameters(Gj)}_swapTextures(t){if(!this._swapTexture)return null;const e=Object.assign({},t.sourceTextures);e[this._swapTexture]=t.targetTexture;const n=t.sourceTextures[this._swapTexture];return{sourceTextures:e,targetTexture:n}}_createNewTexture(t){const e=z7(t,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=e,e}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:e,targetTexture:n}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:a,inject:o,samplerTextureMap:d}=Nj({vs:t.vs,sourceTextureMap:e,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),f=Lb([t.inject||{},o]);this.targetTextureType=a,this.samplerTextureMap=d;const _=t._fs||j5({version:y5(i),input:this.targetTextureVarying,inputType:a,output:jj}),w=this.hasSourceTextures||this.targetTextureVarying?[Tj].concat(t.modules||[]):t.modules;return{vs:i,fs:_,modules:w,uniforms:s,inject:f}}}class Jb{static isSupported(t){return mn(t)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=t,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(e),Object.seal(this)}delete(){const{model:t,bufferTransform:e,textureTransform:n}=this;t&&t.delete(),e&&e.delete(),n&&n.delete()}run(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:e=!0}=t,n=this._updateDrawOptions(t);e&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let t=!1;const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)t=t||n.swap();rr(t,"Nothing to swap")}getBuffer(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(t)}getData(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e){const i=n.getData(t);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in t&&this.model.setVertexCount(t.elementCount);const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)n.update(t)}_initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:e}=this;this._buildResourceTransforms(e,t),t=this._updateModelProps(t),this.model=new af(e,Object.assign({},t,{fs:t.fs||j5({version:y5(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=i.updateModelProps(e);return e}_buildResourceTransforms(t,e){Kj(e)&&(this.bufferTransform=new Oj(t,e)),$j(e)&&(this.textureTransform=new qj(t,e)),rr(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=Object.assign(e,i.getDrawOptions(e));return e}}function Kj(r){return!!(!tf(r.feedbackBuffers)||!tf(r.feedbackMap)||r.varyings&&r.varyings.length>0)}function $j(r){return!!(!tf(r._sourceTextures)||r._targetTexture||r._targetTextureVarying)}const wI={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class wg{static get DRAW_MODE(){return wI}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:e=ku("geometry"),drawMode:n=wI.TRIANGLES,attributes:i={},indices:s=null,vertexCount:a=null}=t;this.id=e,this.drawMode=n|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=a||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return"Geometry ".concat(this.id," attribute ").concat(t)}_setAttributes(t,e){e&&(this.indices=ArrayBuffer.isView(e)?{value:e,size:1}:e);for(const n in t){let i=t[n];i=ArrayBuffer.isView(i)?{value:i}:i,rr(ArrayBuffer.isView(i.value),"".concat(this._print(n),": must be typed array or object with value as typed array")),(n==="POSITION"||n==="positions")&&!i.size&&(i.size=3),n==="indices"?(rr(!this.indices),this.indices=i):this.attributes[n]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(t,e){if(e)return e.value.length;let n=1/0;for(const i in t){const s=t[i],{value:a,size:o,constant:d}=s;!d&&a&&o>=1&&(n=Math.min(n,a.length/o))}return rr(Number.isFinite(n)),n}}let Wj=1,Xj=1;class xI{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(t){const{delay:e=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=t,a=Wj++,o={time:0,delay:e,duration:n,rate:i,repeat:s};return this._setChannelTime(o,this.time),this.channels.set(a,o),a}removeChannel(t){this.channels.delete(t);for(const[e,n]of this.animations)n.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return e===void 0?!1:this.time>=e.delay+e.duration*e.repeat}getTime(t){if(t===void 0)return this.time;const e=this.channels.get(t);return e===void 0?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const i of e)this._setChannelTime(i,this.time);const n=this.animations.values();for(const i of n){const{animation:s,channel:a}=i;s.setTime(this.getTime(a))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,e){const n=Xj++;return this.animations.set(n,{animation:t,channel:e}),t.setTime(this.getTime(e)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const n=e-t.delay,i=t.duration*t.repeat;n>=i?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}}const Jj=[255,255,255],Yj=1;let Zj=0;class BI{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};j(this,"id",void 0),j(this,"color",void 0),j(this,"intensity",void 0),j(this,"type","ambient");const{color:e=Jj}=t,{intensity:n=Yj}=t;this.id=t.id||"ambient-".concat(Zj++),this.color=e,this.intensity=n}}const tq=[255,255,255],eq=1,rq=[0,0,-1];let nq=0;class CI{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};j(this,"id",void 0),j(this,"color",void 0),j(this,"intensity",void 0),j(this,"type","directional"),j(this,"direction",void 0),j(this,"shadow",void 0);const{color:e=tq}=t,{intensity:n=eq}=t,{direction:i=rq}=t,{_shadow:s=!1}=t;this.id=t.id||"directional-".concat(nq++),this.color=e,this.intensity=n,this.type="directional",this.direction=new ie(i).normalize().toArray(),this.shadow=s}getProjectedLight(t){return this}}class iq{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{id:"pass"};j(this,"id",void 0),j(this,"gl",void 0),j(this,"props",void 0);const{id:n}=e;this.id=n,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(t){}cleanup(){}}class Yb extends iq{constructor(){super(...arguments),j(this,"_lastRenderIndex",-1)}render(t){const e=this.gl;return Nu(e,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{target:e,moduleParameters:n,viewports:i,views:s,onViewportActive:a,clearStack:o=!0,clearCanvas:d=!0}=t;t.pass=t.pass||"unknown";const f=this.gl;d&&oq(f,e),o&&(this._lastRenderIndex=-1);const _=[];for(const w of i){const x=s&&s[w.id];a==null||a(w);const B=this._getDrawLayerParams(w,t),P=w.subViewports||[w];for(const R of P){const N=this._drawLayersInViewport(f,{target:e,moduleParameters:n,viewport:R,view:x,pass:t.pass,layers:t.layers},B);_.push(N)}}return _}_getDrawLayerParams(t,e){let{layers:n,pass:i,isPicking:s=!1,layerFilter:a,cullRect:o,effects:d,moduleParameters:f}=e,_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const w=[],x=EI(this._lastRenderIndex+1),B={layer:n[0],viewport:t,isPicking:s,renderPass:i,cullRect:o},P={};for(let R=0;R<n.length;R++){const N=n[R],Q=this._shouldDrawLayer(N,B,a,P),V={shouldDrawLayer:Q};Q&&!_&&(V.layerRenderIndex=x(N,Q),V.moduleParameters=this._getModuleParameters(N,d,i,f),V.layerParameters=this.getLayerParameters(N,R,t)),w[R]=V}return w}_drawLayersInViewport(t,e,n){let{layers:i,moduleParameters:s,pass:a,target:o,viewport:d,view:f}=e;const _=sq(t,{moduleParameters:s,target:o,viewport:d});if(f&&f.props.clear){const x=f.props.clear===!0?{color:!0,depth:!0}:f.props.clear;ql(t,{scissorTest:!0,scissor:_},()=>_b(t,x))}const w={totalCount:i.length,visibleCount:0,compositeCount:0,pickableCount:0};Nu(t,{viewport:_});for(let x=0;x<i.length;x++){const B=i[x],{shouldDrawLayer:P,layerRenderIndex:R,moduleParameters:N,layerParameters:Q}=n[x];if(P&&B.props.pickable&&w.pickableCount++,B.isComposite)w.compositeCount++;else if(P){w.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,R),N.viewport=d;try{B._drawLayer({moduleParameters:N,uniforms:{layerIndex:R},parameters:Q})}catch(V){B.raiseError(V,"drawing ".concat(B," to ").concat(a))}}}return w}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e,n){return t.props.parameters}_shouldDrawLayer(t,e,n,i){if(!(t.props.visible&&this.shouldDrawLayer(t)))return!1;e.layer=t;let a=t.parent;for(;a;){if(!a.props.visible||!a.filterSubLayer(e))return!1;e.layer=a,a=a.parent}if(n){const o=e.layer.id;if(o in i||(i[o]=n(e)),!i[o])return!1}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,i){var s;const a=Object.assign(Object.create(((s=t.internalState)===null||s===void 0?void 0:s.propsInTransition)||t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:Zd(this.gl)});if(e)for(const d of e){var o;Object.assign(a,(o=d.getModuleParameters)===null||o===void 0?void 0:o.call(d,t))}return Object.assign(a,this.getModuleParameters(t,e),i)}}function EI(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e={},n=(i,s)=>{const a=i.props._offset,o=i.id,d=i.parent&&i.parent.id;let f;if(d&&!(d in t)&&n(i.parent,!1),d in e){const _=e[d]=e[d]||EI(t[d],t);f=_(i,s),e[o]=_}else Number.isFinite(a)?(f=a+(t[d]||0),e[o]=null):f=r;return s&&f>=r&&(r=f+1),t[o]=f,f};return n}function sq(r,t){let{moduleParameters:e,target:n,viewport:i}=t;const s=n&&n.id!=="default-framebuffer",a=e&&e.devicePixelRatio||Zd(r),o=s?n.height:r.drawingBufferHeight,d=i;return[d.x*a,o-(d.y+d.height)*a,d.width*a,d.height*a]}function oq(r,t){const e=t?t.width:r.drawingBufferWidth,n=t?t.height:r.drawingBufferHeight;Nu(r,{viewport:[0,0,e,n]}),r.clear(16640)}class aq extends Yb{constructor(t,e){super(t,e),j(this,"shadowMap",void 0),j(this,"depthBuffer",void 0),j(this,"fbo",void 0),this.shadowMap=new Ua(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new nf(t,{format:33189,width:1,height:1}),this.fbo=new ys(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(t){const e=this.fbo;ql(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const n=t.viewports[0],i=Zd(this.gl),s=n.width*i,a=n.height*i;(s!==e.width||a!==e.height)&&e.resize({width:s,height:a}),super.render({...t,target:e,pass:"shadow"})})}shouldDrawLayer(t){return t.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const SI="#define SMOOTH_EDGE_RADIUS 0.5",lq=`
`.concat(SI,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),cq=`
`.concat(SI,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),uq={name:"geometry",vs:lq,fs:cq},Aq=Object.keys(Sn).map(r=>"const int COORDINATE_SYSTEM_".concat(r," = ").concat(Sn[r],";")).join(""),hq=Object.keys(Oc).map(r=>"const int PROJECTION_MODE_".concat(r," = ").concat(Oc[r],";")).join(""),dq=Object.keys(ab).map(r=>"const int UNIT_".concat(r.toUpperCase()," = ").concat(ab[r],";")).join(""),fq="".concat(Aq,`
`).concat(hq,`
`).concat(dq,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function pq(r,t){if(r===t)return!0;if(Array.isArray(r)){const e=r.length;if(!t||t.length!==e)return!1;for(let n=0;n<e;n++)if(r[n]!==t[n])return!1;return!0}return!1}function xg(r){let t={},e;return n=>{for(const i in n)if(!pq(n[i],t[i])){e=r(n),t=n;break}return e}}const TI=[0,0,0,0],gq=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],II=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],mq=[0,0,0],FI=[0,0,0],yq=xg(bq);function LI(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:FI;e.length<3&&(e=[e[0],e[1],0]);let n=e,i,s=!0;switch(t===Sn.LNGLAT_OFFSETS||t===Sn.METER_OFFSETS?i=e:i=r.isGeospatial?[Math.fround(r.longitude),Math.fround(r.latitude),0]:null,r.projectionMode){case Oc.WEB_MERCATOR:(t===Sn.LNGLAT||t===Sn.CARTESIAN)&&(i=[0,0,0],s=!1);break;case Oc.WEB_MERCATOR_AUTO_OFFSET:t===Sn.LNGLAT?n=i:t===Sn.CARTESIAN&&(n=[Math.fround(r.center[0]),Math.fround(r.center[1]),0],i=r.unprojectPosition(n),n[0]-=e[0],n[1]-=e[1],n[2]-=e[2]);break;case Oc.IDENTITY:n=r.position.map(Math.fround),n[2]=n[2]||0;break;case Oc.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:n,offsetMode:s}}function _q(r,t,e){const{viewMatrixUncentered:n,projectionMatrix:i}=r;let{viewMatrix:s,viewProjectionMatrix:a}=r,o=TI,d=TI,f=r.cameraPosition;const{geospatialOrigin:_,shaderCoordinateOrigin:w,offsetMode:x}=LI(r,t,e);return x&&(d=r.projectPosition(_||w),f=[f[0]-d[0],f[1]-d[1],f[2]-d[2]],d[3]=1,o=yg([],d,a),s=n||s,a=zh([],i,s),a=zh([],a,gq)),{viewMatrix:s,viewProjectionMatrix:a,projectionCenter:o,originCommon:d,cameraPosCommon:f,shaderCoordinateOrigin:w,geospatialOrigin:_}}function vq(r){let{viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=Sn.DEFAULT,coordinateOrigin:s=FI,autoWrapLongitude:a=!1}=r;i===Sn.DEFAULT&&(i=t.isGeospatial?Sn.LNGLAT:Sn.CARTESIAN);const o=yq({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:s});return o.project_uWrapLongitude=a,o.project_uModelMatrix=n||II,o}function bq(r){let{viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i}=r;const{projectionCenter:s,viewProjectionMatrix:a,originCommon:o,cameraPosCommon:d,shaderCoordinateOrigin:f,geospatialOrigin:_}=_q(t,n,i),w=t.getDistanceScales(),x=[t.width*e,t.height*e],B=yg([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,P={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:f,project_uCommonOrigin:o.slice(0,3),project_uCenter:s,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:x,project_uDevicePixelRatio:e,project_uFocalDistance:B,project_uCommonUnitsPerMeter:w.unitsPerMeter,project_uCommonUnitsPerWorldUnit:w.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:mq,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:a,project_uModelMatrix:II,project_uCameraPosition:d};if(_){const R=t.getDistanceScales(_);switch(n){case Sn.METER_OFFSETS:P.project_uCommonUnitsPerWorldUnit=R.unitsPerMeter,P.project_uCommonUnitsPerWorldUnit2=R.unitsPerMeter2;break;case Sn.LNGLAT:case Sn.LNGLAT_OFFSETS:t._pseudoMeters||(P.project_uCommonUnitsPerMeter=R.unitsPerMeter),P.project_uCommonUnitsPerWorldUnit=R.unitsPerDegree,P.project_uCommonUnitsPerWorldUnit2=R.unitsPerDegree2;break;case Sn.CARTESIAN:P.project_uCommonUnitsPerWorldUnit=[1,1,R.unitsPerMeter[2]],P.project_uCommonUnitsPerWorldUnit2=[0,0,R.unitsPerMeter2[2]];break}}return P}const wq={};function xq(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wq;return"viewport"in r?vq(r):{}}const Zb={name:"project",dependencies:[WV,uq],vs:fq,getUniforms:xq};function Bq(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function lf(r,t){const e=yg([],t,r);return cI(e,e,1/e[3]),e}function PI(r,t){const e=r%t;return e<0?t+e:e}function tw(r,t,e){return r<t?t:r>e?e:r}function Cq(r){return Math.log(r)*Math.LOG2E}const ew=Math.log2||Cq;function Gu(r,t){if(!r)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const Xl=Math.PI,MI=Xl/4,fl=Xl/180,rw=180/Xl,cf=512,ry=4003e4,ny=85.051129,Eq=1.5;function Sq(r){return ew(r)}function Bg(r){const[t,e]=r;Gu(Number.isFinite(t)),Gu(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude");const n=t*fl,i=e*fl,s=cf*(n+Xl)/(2*Xl),a=cf*(Xl+Math.log(Math.tan(MI+i*.5)))/(2*Xl);return[s,a]}function uf(r){const[t,e]=r,n=t/cf*(2*Xl)-Xl,i=2*(Math.atan(Math.exp(e/cf*(2*Xl)-Xl))-MI);return[n*rw,i*rw]}function Tq(r){const{latitude:t}=r;Gu(Number.isFinite(t));const e=Math.cos(t*fl);return Sq(ry*e)-9}function iy(r){const t=Math.cos(r*fl);return cf/ry/t}function nw(r){const{latitude:t,longitude:e,highPrecision:n=!1}=r;Gu(Number.isFinite(t)&&Number.isFinite(e));const i=cf,s=Math.cos(t*fl),a=i/360,o=a/s,d=i/ry/s,f={unitsPerMeter:[d,d,d],metersPerUnit:[1/d,1/d,1/d],unitsPerDegree:[a,o,d],degreesPerUnit:[1/a,1/o,1/d]};if(n){const _=fl*Math.tan(t*fl)/s,w=a*_/2,x=i/ry*_,B=x/o*d;f.unitsPerDegree2=[0,w,x],f.unitsPerMeter2=[B,0,B]}return f}function RI(r,t){const[e,n,i]=r,[s,a,o]=t,{unitsPerMeter:d,unitsPerMeter2:f}=nw({longitude:e,latitude:n,highPrecision:!0}),_=Bg(r);_[0]+=s*(d[0]+f[0]*a),_[1]+=a*(d[1]+f[1]*a);const w=uf(_),x=(i||0)+(o||0);return Number.isFinite(i)||Number.isFinite(o)?[w[0],w[1],x]:w}function Iq(r){const{height:t,pitch:e,bearing:n,altitude:i,scale:s,center:a}=r,o=Bq();J0(o,o,[0,0,-i]),aI(o,o,-e*fl),lI(o,o,n*fl);const d=s/t;return Gb(o,o,[d,d,d]),a&&J0(o,o,dG([],a)),o}function Fq(r){const{width:t,height:e,altitude:n,pitch:i=0,offset:s,center:a,scale:o,nearZMultiplier:d=1,farZMultiplier:f=1}=r;let{fovy:_=sy(Eq)}=r;n!==void 0&&(_=sy(n));const w=_*fl,x=i*fl,B=UI(_);let P=B;a&&(P+=a[2]*o/Math.cos(x)/e);const R=w*(.5+(s?s[1]:0)/e),N=Math.sin(R)*P/Math.sin(tw(Math.PI/2-x-R,.01,Math.PI-.01)),Q=Math.sin(x)*N+P,V=P*10,W=Math.min(Q*f,V);return{fov:w,aspect:t/e,focalDistance:B,near:d,far:W}}function sy(r){return 2*Math.atan(.5/r)*rw}function UI(r){return .5/Math.tan(.5*r*fl)}function OI(r,t){const[e,n,i=0]=r;return Gu(Number.isFinite(e)&&Number.isFinite(n)&&Number.isFinite(i)),lf(t,[e,n,i,1])}function iw(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const[n,i,s]=r;if(Gu(Number.isFinite(n)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return lf(t,[n,i,s,1]);const a=lf(t,[n,i,0,1]),o=lf(t,[n,i,1,1]),d=a[2],f=o[2],_=d===f?0:((e||0)-d)/(f-d);return K5([],a,o,_)}function Lq(r){const{width:t,height:e,bounds:n,minExtent:i=0,maxZoom:s=24,offset:a=[0,0]}=r,[[o,d],[f,_]]=n,w=Pq(r.padding),x=Bg([o,tw(_,-ny,ny)]),B=Bg([f,tw(d,-ny,ny)]),P=[Math.max(Math.abs(B[0]-x[0]),i),Math.max(Math.abs(B[1]-x[1]),i)],R=[t-w.left-w.right-Math.abs(a[0])*2,e-w.top-w.bottom-Math.abs(a[1])*2];Gu(R[0]>0&&R[1]>0);const N=R[0]/P[0],Q=R[1]/P[1],V=(w.right-w.left)/2/N,W=(w.top-w.bottom)/2/Q,et=[(B[0]+x[0])/2+V,(B[1]+x[1])/2+W],ct=uf(et),dt=Math.min(s,ew(Math.abs(Math.min(N,Q))));return Gu(Number.isFinite(dt)),{longitude:ct[0],latitude:ct[1],zoom:dt}}function Pq(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return typeof r=="number"?{top:r,bottom:r,left:r,right:r}:(Gu(Number.isFinite(r.top)&&Number.isFinite(r.bottom)&&Number.isFinite(r.left)&&Number.isFinite(r.right)),r)}const DI=Math.PI/180;function Mq(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const{width:e,height:n,unproject:i}=r,s={targetZ:t},a=i([0,n],s),o=i([e,n],s);let d,f;const _=r.fovy?.5*r.fovy*DI:Math.atan(.5/r.altitude),w=(90-r.pitch)*DI;return _>w-.01?(d=NI(r,0,t),f=NI(r,e,t)):(d=i([0,0],s),f=i([e,0],s)),[a,o,f,d]}function NI(r,t,e){const{pixelUnprojectionMatrix:n}=r,i=lf(n,[t,0,1,1]),s=lf(n,[t,r.height,1,1]),o=(e*r.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),d=K5([],i,s,o),f=uf(d);return f.push(e),f}const kI=512;function Rq(r){const{width:t,height:e,pitch:n=0}=r;let{longitude:i,latitude:s,zoom:a,bearing:o=0}=r;(i<-180||i>180)&&(i=PI(i+180,360)-180),(o<-180||o>180)&&(o=PI(o+180,360)-180);const d=ew(e/kI);if(a<=d)a=d,s=0;else{const f=e/2/Math.pow(2,a),_=uf([0,f])[1];if(s<_)s=_;else{const w=uf([0,kI-f])[1];s>w&&(s=w)}}return{width:t,height:e,longitude:i,latitude:s,zoom:a,pitch:n,bearing:o}}const Uq=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,Oq=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,Dq=xg(Hq),Nq=xg(Vq),kq=[0,0,0,1],Qq=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function zq(r,t){const[e,n,i]=r,s=iw([e,n,i],t);return Number.isFinite(i)?s:[s[0],s[1],0]}function Hq(r){let{viewport:t,center:e}=r;return new xn(t.viewProjectionMatrix).invert().transform(e)}function Vq(r){let{viewport:t,shadowMatrices:e}=r;const n=[],i=t.pixelUnprojectionMatrix,s=t.isGeospatial?void 0:1,a=[[0,0,s],[t.width,0,s],[0,t.height,s],[t.width,t.height,s],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>zq(o,i));for(const o of e){const d=o.clone().translate(new ie(t.center).negate()),f=a.map(w=>d.transform(w)),_=new xn().ortho({left:Math.min(...f.map(w=>w[0])),right:Math.max(...f.map(w=>w[0])),bottom:Math.min(...f.map(w=>w[1])),top:Math.max(...f.map(w=>w[1])),near:Math.min(...f.map(w=>-w[2])),far:Math.max(...f.map(w=>-w[2]))});n.push(_.multiplyRight(o))}return n}function Gq(r,t){const{shadowEnabled:e=!0}=r;if(!e||!r.shadowMatrices||!r.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const n={shadow_uDrawShadowMap:!!r.drawToShadowMap,shadow_uUseShadowMap:r.shadowMaps?r.shadowMaps.length>0:!1,shadow_uColor:r.shadowColor||kq,shadow_uLightId:r.shadowLightId||0,shadow_uLightCount:r.shadowMatrices.length},i=Dq({viewport:r.viewport,center:t.project_uCenter}),s=[],a=Nq({shadowMatrices:r.shadowMatrices,viewport:r.viewport}).slice();for(let o=0;o<r.shadowMatrices.length;o++){const d=a[o],f=d.clone().translate(new ie(r.viewport.center).negate());t.project_uCoordinateSystem===Sn.LNGLAT&&t.project_uProjectionMode===Oc.WEB_MERCATOR?(a[o]=f,s[o]=i):(a[o]=d.clone().multiplyRight(Qq),s[o]=f.transform(i))}for(let o=0;o<a.length;o++)n["shadow_uViewProjectionMatrices[".concat(o,"]")]=a[o],n["shadow_uProjectCenters[".concat(o,"]")]=s[o],r.shadowMaps&&r.shadowMaps.length>0?n["shadow_uShadowMap".concat(o)]=r.shadowMaps[o]:n["shadow_uShadowMap".concat(o)]=r.dummyShadowMap;return n}const sw={name:"shadow",dependencies:[Zb],vs:Uq,fs:Oq,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"viewport"in r&&(r.drawToShadowMap||r.shadowMaps&&r.shadowMaps.length>0)?Gq(r,t):{}}},jq={color:[255,255,255],intensity:1},QI=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],qq=[0,0,0,200/255];class ow{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};j(this,"id","lighting-effect"),j(this,"props",void 0),j(this,"shadowColor",qq),j(this,"shadow",void 0),j(this,"ambientLight",void 0),j(this,"directionalLights",void 0),j(this,"pointLights",void 0),j(this,"shadowPasses",[]),j(this,"shadowMaps",[]),j(this,"dummyShadowMap",null),j(this,"programManager",void 0),j(this,"shadowMatrices",void 0),this.setProps(t)}setProps(t){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(e=>e.shadow),this.props=t}preRender(t,e){let{layers:n,layerFilter:i,viewports:s,onViewportActive:a,views:o}=e;if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(t),this.programManager||(this.programManager=bg.getDefaultProgramManager(t),sw&&this.programManager.addDefaultModule(sw)),this.dummyShadowMap||(this.dummyShadowMap=new Ua(t,{width:1,height:1}));for(let d=0;d<this.shadowPasses.length;d++)this.shadowPasses[d].render({layers:n,layerFilter:i,viewports:s,onViewportActive:a,views:o,moduleParameters:{shadowLightId:d,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(n=>n.getProjectedLight({layer:t})),pointLights:this.pointLights.map(n=>n.getProjectedLight({layer:t}))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(sw),this.programManager=null)}_calculateMatrices(){const t=[];for(const e of this.directionalLights){const n=new xn().lookAt({eye:new ie(e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new aq(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;!t&&e.length===0&&n.length===0&&(this.ambientLight=new BI(jq),this.directionalLights.push(new CI(QI[0]),new CI(QI[1])))}}class Kq{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};j(this,"_pool",[]),j(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(t)}setOptions(t){Object.assign(this.opts,t)}allocate(t,e,n){let{size:i=1,type:s,padding:a=0,copy:o=!1,initialize:d=!1,maxCount:f}=n;const _=s||t&&t.constructor||Float32Array,w=e*i+a;if(ArrayBuffer.isView(t)){if(w<=t.length)return t;if(w*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new _(t.buffer,0,w)}let x=1/0;f&&(x=f*i+a);const B=this._allocate(_,w,d,x);return t&&o?B.set(t):d||B.fill(0,0,4),this._release(t),B}release(t){this._release(t)}_allocate(t,e,n,i){let s=Math.max(Math.ceil(e*this.opts.overAlloc),1);s>i&&(s=i);const a=this._pool,o=t.BYTES_PER_ELEMENT*s,d=a.findIndex(f=>f.byteLength>=o);if(d>=0){const f=new t(a.splice(d,1)[0],0,s);return n&&f.fill(0),f}return new t(s)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:i}=n,s=e.findIndex(a=>a.byteLength>=i);s<0?e.push(n):(s>0||e.length<this.opts.poolSize)&&e.splice(s,0,n),e.length>this.opts.poolSize&&e.shift()}}const Cg=new Kq;function Eg(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function $q(r){return[r[12],r[13],r[14]]}function Wq(r){return{left:Af(r[3]+r[0],r[7]+r[4],r[11]+r[8],r[15]+r[12]),right:Af(r[3]-r[0],r[7]-r[4],r[11]-r[8],r[15]-r[12]),bottom:Af(r[3]+r[1],r[7]+r[5],r[11]+r[9],r[15]+r[13]),top:Af(r[3]-r[1],r[7]-r[5],r[11]-r[9],r[15]-r[13]),near:Af(r[3]+r[2],r[7]+r[6],r[11]+r[10],r[15]+r[14]),far:Af(r[3]-r[2],r[7]-r[6],r[11]-r[10],r[15]-r[14])}}const zI=new ie;function Af(r,t,e,n){zI.set(r,t,e);const i=zI.len();return{distance:n/i,normal:new ie(-r/i,-t/i,-e/i)}}function Xq(r){return r-Math.fround(r)}let Sg;function aw(r,t){const{size:e=1,startIndex:n=0}=t,i=t.endIndex!==void 0?t.endIndex:r.length,s=(i-n)/e;Sg=Cg.allocate(Sg,s,{type:Float32Array,size:e*2});let a=n,o=0;for(;a<i;){for(let d=0;d<e;d++){const f=r[a++];Sg[o+d]=f,Sg[o+d+e]=Xq(f)}o+=e*2}return Sg.subarray(0,s*e*2)}function Jq(r){let t=null,e=!1;for(const n of r)n&&(t?(e||(t=[[t[0][0],t[0][1]],[t[1][0],t[1][1]]],e=!0),t[0][0]=Math.min(t[0][0],n[0][0]),t[0][1]=Math.min(t[0][1],n[0][1]),t[1][0]=Math.max(t[1][0],n[1][0]),t[1][1]=Math.max(t[1][1],n[1][1])):t=n);return t}const Yq=Math.PI/180,Zq=Eg(),HI=[0,0,0],tK={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function eK(r){let{width:t,height:e,orthographic:n,fovyRadians:i,focalDistance:s,padding:a,near:o,far:d}=r;const f=t/e,_=n?new xn().orthographic({fovy:i,aspect:f,focalDistance:s,near:o,far:d}):new xn().perspective({fovy:i,aspect:f,near:o,far:d});if(a){const{left:w=0,right:x=0,top:B=0,bottom:P=0}=a,R=Vu((w+t-x)/2,0,t)-t/2,N=Vu((B+e-P)/2,0,e)-e/2;_[8]-=R*2/t,_[9]+=N*2/e}return _}class hf{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};j(this,"id",void 0),j(this,"x",void 0),j(this,"y",void 0),j(this,"width",void 0),j(this,"height",void 0),j(this,"padding",void 0),j(this,"isGeospatial",void 0),j(this,"zoom",void 0),j(this,"focalDistance",void 0),j(this,"position",void 0),j(this,"modelMatrix",void 0),j(this,"distanceScales",void 0),j(this,"scale",void 0),j(this,"center",void 0),j(this,"cameraPosition",void 0),j(this,"projectionMatrix",void 0),j(this,"viewMatrix",void 0),j(this,"viewMatrixUncentered",void 0),j(this,"viewMatrixInverse",void 0),j(this,"viewProjectionMatrix",void 0),j(this,"pixelProjectionMatrix",void 0),j(this,"pixelUnprojectionMatrix",void 0),j(this,"resolution",void 0),j(this,"_frustumPlanes",{}),this.id=t.id||this.constructor.displayName||"viewport",this.x=t.x||0,this.y=t.y||0,this.width=t.width||1,this.height=t.height||1,this.zoom=t.zoom||0,this.padding=t.padding,this.distanceScales=t.distanceScales||tK,this.focalDistance=t.focalDistance||1,this.position=t.position||HI,this.modelMatrix=t.modelMatrix||null;const{longitude:e,latitude:n}=t;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(e),this._initProps(t),this._initMatrices(t),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Oc.WEB_MERCATOR:Oc.WEB_MERCATOR_AUTO_OFFSET:Oc.IDENTITY}equals(t){return t instanceof hf?this===t?!0:t.width===this.width&&t.height===this.height&&t.scale===this.scale&&$l(t.projectionMatrix,this.projectionMatrix)&&$l(t.viewMatrix,this.viewMatrix):!1}project(t){let{topLeft:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=this.projectPosition(t),i=OI(n,this.pixelProjectionMatrix),[s,a]=i,o=e?a:this.height-a;return t.length===2?[s,o]:[s,o,i[2]]}unproject(t){let{topLeft:e=!0,targetZ:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const[i,s,a]=t,o=e?s:this.height-s,d=n&&n*this.distanceScales.unitsPerMeter[2],f=iw([i,o,a],this.pixelUnprojectionMatrix,d),[_,w,x]=this.unprojectPosition(f);return Number.isFinite(a)?[_,w,x]:Number.isFinite(n)?[_,w,n]:[_,w]}projectPosition(t){const[e,n]=this.projectFlat(t),i=(t[2]||0)*this.distanceScales.unitsPerMeter[2];return[e,n,i]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t),i=(t[2]||0)*this.distanceScales.metersPerUnit[2];return[e,n,i]}projectFlat(t){if(this.isGeospatial){const e=Bg(t);return e[1]=Vu(e[1],-318,830),e}return t}unprojectFlat(t){return this.isGeospatial?uf(t):t}getBounds(){const e={targetZ:(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).z||0},n=this.unproject([0,0],e),i=this.unproject([this.width,0],e),s=this.unproject([0,this.height],e),a=this.unproject([this.width,this.height],e);return[Math.min(n[0],i[0],s[0],a[0]),Math.min(n[1],i[1],s[1],a[1]),Math.max(n[0],i[0],s[0],a[0]),Math.max(n[1],i[1],s[1],a[1])]}getDistanceScales(t){return t?nw({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel(t){let{x:e,y:n,width:i=1,height:s=1}=t;return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+s}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,Wq(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(t,e){return null}_initProps(t){const e=t.longitude,n=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=Tq({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||nw({latitude:n,longitude:e}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:a}=t;let o=HI;if(s&&(o=a?new xn(a).transformAsVector(s,[]):s),this.isGeospatial){const d=this.projectPosition([e,n,0]);this.center=new ie(o).scale(this.distanceScales.unitsPerMeter).add(d)}else this.center=this.projectPosition(o)}_initMatrices(t){const{viewMatrix:e=Zq,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:s,fovy:a=75,near:o=.1,far:d=1e3,padding:f=null,focalDistance:_=1}=t;this.viewMatrixUncentered=e,this.viewMatrix=new xn().multiplyRight(e).translate(new ie(this.center).negate()),this.projectionMatrix=n||eK({width:this.width,height:this.height,orthographic:i,fovyRadians:s||a*Yq,focalDistance:_,padding:f,near:o,far:d});const w=Eg();zh(w,w,this.projectionMatrix),zh(w,w,this.viewMatrix),this.viewProjectionMatrix=w,this.viewMatrixInverse=Vb([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=$q(this.viewMatrixInverse);const x=Eg(),B=Eg();Gb(x,x,[this.width/2,-this.height/2,1]),J0(x,x,[1,-1,0]),zh(B,x,this.viewProjectionMatrix),this.pixelProjectionMatrix=B,this.pixelUnprojectionMatrix=Vb(Eg(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Tn.warn("Pixel project matrix not invertible")()}}j(hf,"displayName","Viewport");class Hh extends hf{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{latitude:e=0,longitude:n=0,zoom:i=0,pitch:s=0,bearing:a=0,nearZMultiplier:o=.1,farZMultiplier:d=1.01,nearZ:f,farZ:_,orthographic:w=!1,projectionMatrix:x,repeat:B=!1,worldOffset:P=0,position:R,padding:N,legacyMeterSizes:Q=!1}=t;let{width:V,height:W,altitude:et=1.5}=t;const ct=Math.pow(2,i);V=V||1,W=W||1;let dt,gt=null;if(x)et=x[5]/2,dt=sy(et);else{t.fovy?(dt=t.fovy,et=UI(dt)):dt=sy(et);let It;if(N){const{top:St=0,bottom:ot=0}=N;It=[0,Vu((St+W-ot)/2,0,W)-W/2]}gt=Fq({width:V,height:W,scale:ct,center:R&&[0,0,R[2]*iy(e)],offset:It,pitch:s,fovy:dt,nearZMultiplier:o,farZMultiplier:d}),Number.isFinite(f)&&(gt.near=f),Number.isFinite(_)&&(gt.far=_)}let ht=Iq({height:W,pitch:s,bearing:a,scale:ct,altitude:et});P&&(ht=new xn().translate([512*P,0,0]).multiplyLeft(ht)),super({...t,width:V,height:W,viewMatrix:ht,longitude:n,latitude:e,zoom:i,...gt,fovy:dt,focalDistance:et}),j(this,"longitude",void 0),j(this,"latitude",void 0),j(this,"pitch",void 0),j(this,"bearing",void 0),j(this,"altitude",void 0),j(this,"fovy",void 0),j(this,"orthographic",void 0),j(this,"_subViewports",void 0),j(this,"_pseudoMeters",void 0),this.latitude=e,this.longitude=n,this.zoom=i,this.pitch=s,this.bearing=a,this.altitude=et,this.fovy=dt,this.orthographic=w,this._subViewports=B?[]:null,this._pseudoMeters=Q,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let i=e;i<=n;i++){const s=i?new Hh({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,n]=this.projectFlat(t),i=(t[2]||0)*iy(t[1]);return[e,n,i]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,n]=this.unprojectFlat(t),i=(t[2]||0)/iy(n);return[e,n,i]}addMetersToLngLat(t,e){return RI(t,e)}panByPosition(t,e){const n=iw(e,this.pixelUnprojectionMatrix),i=this.projectFlat(t),s=q5([],i,aG([],n)),a=q5([],this.center,s),[o,d]=this.unprojectFlat(a);return{longitude:o,latitude:d}}getBounds(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=Mq(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{width:n,height:i}=this,{longitude:s,latitude:a,zoom:o}=Lq({width:n,height:i,bounds:t,...e});return new Hh({width:n,height:i,longitude:s,latitude:a,zoom:o})}}j(Hh,"displayName","WebMercatorViewport");const VI=[0,0,0];function lw(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const n=t.projectPosition(r);if(e&&t instanceof Hh){const[i,s,a=0]=r,o=t.getDistanceScales([i,s]);n[2]=a*o.unitsPerMeter[2]}return n}function rK(r){const{viewport:t,modelMatrix:e,coordinateOrigin:n}=r;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:a}=r;return i===Sn.DEFAULT&&(i=t.isGeospatial?Sn.LNGLAT:Sn.CARTESIAN),s===void 0&&(s=i),a===void 0&&(a=n),{viewport:t,coordinateSystem:i,coordinateOrigin:n,modelMatrix:e,fromCoordinateSystem:s,fromCoordinateOrigin:a}}function GI(r,t){let{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:s,offsetMode:a}=t,[o,d,f=0]=r;switch(n&&([o,d,f]=yg([],[o,d,f,1],n)),i){case Sn.LNGLAT:return lw([o,d,f],e,a);case Sn.LNGLAT_OFFSETS:return lw([o+s[0],d+s[1],f+(s[2]||0)],e,a);case Sn.METER_OFFSETS:return lw(RI(s,[o,d,f]),e,a);case Sn.CARTESIAN:default:return e.isGeospatial?[o+s[0],d+s[1],f+s[2]]:e.projectPosition([o,d,f])}}function nK(r,t){const{viewport:e,coordinateSystem:n,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:a,fromCoordinateOrigin:o}=rK(t),{autoOffset:d=!0}=t,{geospatialOrigin:f=VI,shaderCoordinateOrigin:_=VI,offsetMode:w=!1}=d?LI(e,n,i):{},x=GI(r,{viewport:e,modelMatrix:s,coordinateSystem:a,coordinateOrigin:o,offsetMode:w});if(w){const B=e.projectPosition(f||_);_G(x,x,B)}return x}const jI={blendFunc:[1,0,32771,0],blendEquation:32774};class qI extends Yb{constructor(){super(...arguments),j(this,"pickZ",void 0),j(this,"_colorEncoderState",null)}render(t){return"pickingFBO"in t?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer(t){let{layers:e,layerFilter:n,views:i,viewports:s,onViewportActive:a,pickingFBO:o,deviceRect:{x:d,y:f,width:_,height:w},cullRect:x,effects:B,pass:P="picking",pickZ:R,moduleParameters:N}=t;const Q=this.gl;this.pickZ=R;const V=this._resetColorEncoder(R),W=ql(Q,{scissorTest:!0,scissor:[d,f,_,w],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...jI,blend:!R},()=>super.render({target:o,layers:e,layerFilter:n,views:i,viewports:s,onViewportActive:a,cullRect:x,effects:B==null?void 0:B.filter(ct=>ct.useInPicking),pass:P,isPicking:!0,moduleParameters:N}));return this._colorEncoderState=null,{decodePickingColor:V&&sK.bind(null,V),stats:W}}shouldDrawLayer(t){const{pickable:e,operation:n}=t.props;return e&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e,n){const i={...t.props.parameters},{pickable:s,operation:a}=t.props;return this._colorEncoderState?s&&a.includes("draw")&&(Object.assign(i,jI),i.blend=!0,i.blendColor=iK(this._colorEncoderState,t,n)):i.blend=!1,a.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(t){return this._colorEncoderState=t?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function iK(r,t,e){const{byLayer:n,byAlpha:i}=r;let s,a=n.get(t);return a?(a.viewports.push(e),s=a.a):(s=n.size+1,s<=255?(a={a:s,layer:t,viewports:[e]},n.set(t,a),i[s]=a):(Tn.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function sK(r,t){const e=r.byAlpha[t[3]];return e&&{pickedLayer:e.layer,pickedViewports:e.viewports,pickedObjectIndex:e.layer.decodePickingColor(t)}}const df={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},oy=Symbol.for("component"),zA=Symbol.for("propTypes"),cw=Symbol.for("deprecatedProps"),ff=Symbol.for("asyncPropDefaults"),Vh=Symbol.for("asyncPropOriginal"),HA=Symbol.for("asyncPropResolved");function ay(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return Array.isArray(r)?KI(r,t,[]):t(r)?[r]:[]}function KI(r,t,e){let n=-1;for(;++n<r.length;){const i=r[n];Array.isArray(i)?KI(i,t,e):t(i)&&e.push(i)}return e}function oK(r){let{target:t,source:e,start:n=0,count:i=1}=r;const s=e.length,a=i*s;let o=0;for(let d=n;o<s;o++)t[d++]=e[o];for(;o<a;)o<a-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+a-o),o=a);return t}class aK{constructor(t,e,n){j(this,"id",void 0),j(this,"context",void 0),j(this,"isLoaded",void 0),j(this,"persistent",void 0),j(this,"_loadCount",0),j(this,"_subscribers",new Set),j(this,"_data",void 0),j(this,"_loader",void 0),j(this,"_error",void 0),j(this,"_content",void 0),this.id=t,this.context=n,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let i=t;typeof t=="string"&&(i=UA(t)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===n&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=t);for(const s of this._subscribers)s.onChange(this.getData())}}class lK{constructor(t){let{gl:e,protocol:n}=t;j(this,"protocol",void 0),j(this,"_context",void 0),j(this,"_resources",void 0),j(this,"_consumers",void 0),j(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return t.startsWith(this.protocol)?!0:t in this._resources}add(t){let{resourceId:e,data:n,forceUpdate:i=!1,persistent:s=!0}=t,a=this._resources[e];a?a.setData(n,i):(a=new aK(e,n,this._context),this._resources[e]=a),a.persistent=s}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe(t){let{consumerId:e}=t;const n=this._consumers[e];if(n){for(const i in n){const s=n[i],a=this._resources[s.resourceId];a&&a.unsubscribe(s)}delete this._consumers[e],this.prune()}}subscribe(t){let{resourceId:e,onChange:n,consumerId:i,requestId:s="default"}=t;const{_resources:a,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),a[e]||this.add({resourceId:e,data:null,persistent:!1}));const d=a[e];if(this._track(i,s,d,n),d)return d.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,i){const s=this._consumers,a=s[t]=s[t]||{},o=a[e]||{},d=o.resourceId&&this._resources[o.resourceId];d&&(d.unsubscribe(o),this.prune()),n&&(a[e]=o,o.onChange=i,o.resourceId=n.id,n.subscribe(o))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];!e.persistent&&!e.inUse()&&(e.delete(),delete this._resources[t])}}}const uw={name:"project32",dependencies:[Zb],vs:`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`},Aw={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...xj},cK=[Zb],uK=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function AK(r){const t=bg.getDefaultProgramManager(r);for(const e of cK)t.addDefaultModule(e);for(const e of uK)t.addShaderHook(e);return t}const hK="layerManager.setLayers",dK="layerManager.activateViewport";class fK{constructor(t){let{deck:e,stats:n,viewport:i,timeline:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};j(this,"layers",void 0),j(this,"context",void 0),j(this,"resourceManager",void 0),j(this,"_lastRenderedLayers",[]),j(this,"_needsRedraw",!1),j(this,"_needsUpdate",!1),j(this,"_nextLayers",null),j(this,"_debug",!1),j(this,"activateViewport",a=>{Ao(dK,this,a),a&&(this.context.viewport=a)}),this.layers=[],this.resourceManager=new lK({gl:t,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:t,deck:e,programManager:t&&AK(t),stats:n||new Yp({id:"deck.gl"}),viewport:i||new hf({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new xI,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1},e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(t);e=e||i}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers(){let{layerIds:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t?this.layers.filter(e=>t.find(n=>e.id.indexOf(n)===0)):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){Ao(hK,this,e,t),this._lastRenderedLayers=t;const n=ay(t,Boolean);for(const i of n)i.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this._lastRenderedLayers,t)),this._nextLayers=null}_handleError(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}_updateLayers(t,e){const n={};for(const a of t)n[a.id]?Tn.warn("Multiple old layers with same id ".concat(a.id))():n[a.id]=a;const i=[];this._updateSublayersRecursively(e,n,i),this._finalizeOldLayers(n);let s=!1;for(const a of i)if(a.hasUniformTransition()){s="Uniform transition in ".concat(a);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(t,e,n){for(const i of t){i.context=this.context;const s=e[i.id];s===null&&Tn.warn("Multiple new layers with same id ".concat(i.id))(),e[i.id]=null;let a=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),a=i.isComposite?i.getSubLayers():null}catch(o){this._handleError("matching",o,i)}a&&this._updateSublayersRecursively(a,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=df.INITIALIZED}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle=df.MATCHED,e!==t&&(t.lifecycle=df.AWAITING_GC)}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle=df.AWAITING_FINALIZATION;try{t._finalize(),t.lifecycle=df.FINALIZED}catch(e){this._handleError("finalization",e,t)}}}function Nc(r,t,e){if(r===t)return!0;if(!e||!r||!t)return!1;if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(let n=0;n<r.length;n++)if(!Nc(r[n],t[n],e-1))return!1;return!0}if(Array.isArray(t))return!1;if(typeof r=="object"&&typeof t=="object"){const n=Object.keys(r),i=Object.keys(t);if(n.length!==i.length)return!1;for(const s of n)if(!t.hasOwnProperty(s)||!Nc(r[s],t[s],e-1))return!1;return!0}return!1}class pK{constructor(t){j(this,"width",void 0),j(this,"height",void 0),j(this,"views",void 0),j(this,"viewState",void 0),j(this,"controllers",void 0),j(this,"timeline",void 0),j(this,"_viewports",void 0),j(this,"_viewportMap",void 0),j(this,"_isUpdating",void 0),j(this,"_needsRedraw",void 0),j(this,"_needsUpdate",void 0),j(this,"_eventManager",void 0),j(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers){const e=this.controllers[t];e&&e.finalize()}this.controllers={}}needsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter(e=>e.containsPixel(t)):this._viewports}getViews(){const t={};return this.views.forEach(e=>{t[e.id]=e}),t}getView(t){return this.views.find(e=>e.id===t)}getViewState(t){const e=typeof t=="string"?this.getView(t):t,n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),i={x:t[0],y:t[1]};for(let s=n.length-1;s>=0;--s){const a=n[s];if(a.containsPixel(i)){const o=t.slice();return o[0]-=a.x,o[1]-=a.y,a.unproject(o,e)}}return null}setProps(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){(t!==this.width||e!==this.height)&&(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=ay(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){t?(!Nc(t,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):Tn.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...e,viewId:t})}_createController(t,e){const n=e.type;return new n({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var a;return(a=this.getView(t.id))===null||a===void 0?void 0:a.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(t,e,n,i){const s=t.controller;if(s&&n){const a={...e,...s,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height};return(!i||i.constructor!==s.type)&&(i=this._createController(t,a)),i&&i.setProps(a),i}return null}_rebuildViewports(){const{views:t}=this,e=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=t.length;i--;){const s=t[i],a=this.getViewState(s),o=s.makeViewport({viewState:a,width:this.width,height:this.height});let d=e[s.id];const f=!!s.controller;f&&!d&&(n=!0),(n||!f)&&d&&(d.finalize(),d=null),this.controllers[s.id]=this._updateController(s,a,o,d),o&&this._viewports.unshift(o)}for(const i in e){const s=e[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)})}_diffViews(t,e){return t.length!==e.length?!0:t.some((n,i)=>!t[i].equals(e[i]))}}const gK=/([0-9]+\.?[0-9]*)(%|px)/;function VA(r){switch(typeof r){case"number":return{position:r,relative:!1};case"string":const t=gK.exec(r);if(t&&t.length>=3){const e=t[2]==="%",n=parseFloat(t[1]);return{position:e?n/100:n,relative:e}}default:throw new Error("Could not parse position string ".concat(r))}}function GA(r,t){return r.relative?Math.round(r.position*t):r.position}function Ws(r,t){if(!r)throw new Error(t||"deck.gl: assertion failed.")}class mK{constructor(t){j(this,"id",void 0),j(this,"viewportInstance",void 0),j(this,"_x",void 0),j(this,"_y",void 0),j(this,"_width",void 0),j(this,"_height",void 0),j(this,"_padding",void 0),j(this,"props",void 0);const{id:e,x:n=0,y:i=0,width:s="100%",height:a="100%",padding:o=null,viewportInstance:d}=t||{};Ws(!d||d instanceof hf),this.viewportInstance=d,this.id=e||this.constructor.displayName||"view",this.props={...t,id:this.id},this._x=VA(n),this._y=VA(i),this._width=VA(s),this._height=VA(a),this._padding=o&&{left:VA(o.left||0),right:VA(o.right||0),top:VA(o.top||0),bottom:VA(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t?!0:this.viewportInstance?t.viewportInstance?this.viewportInstance.equals(t.viewportInstance):!1:this.ViewportType===t.ViewportType&&Nc(this.props,t.props,2)}makeViewport(t){let{width:e,height:n,viewState:i}=t;if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const s=this.getDimensions({width:e,height:n});return!s.height||!s.width?null:new this.ViewportType({...i,...this.props,...s})}getViewStateId(){const{viewState:t}=this.props;return typeof t=="string"?t:(t==null?void 0:t.id)||this.id}filterViewState(t){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const n in this.props.viewState)n!=="id"&&(e[n]=this.props.viewState[n]);return e}return t}getDimensions(t){let{width:e,height:n}=t;const i={x:GA(this._x,e),y:GA(this._y,n),width:GA(this._width,e),height:GA(this._height,n)};return this._padding&&(i.padding={left:GA(this._padding.left,e),top:GA(this._padding.top,n),right:GA(this._padding.right,e),bottom:GA(this._padding.bottom,n)}),i}get controller(){const t=this.props.controller;return t?t===!0?{type:this.ControllerType}:typeof t=="function"?{type:t}:{type:this.ControllerType,...t}:null}}class Tg{constructor(t){j(this,"_inProgress",void 0),j(this,"_handle",void 0),j(this,"_timeline",void 0),j(this,"time",void 0),j(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=t,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(t){var e,n;this.cancel(),this.settings=t,this._inProgress=!0,(e=(n=this.settings).onStart)===null||e===void 0||e.call(n,this)}end(){if(this._inProgress){var t,e;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(t=(e=this.settings).onEnd)===null||t===void 0||t.call(e,this)}}cancel(){if(this._inProgress){var t,e;(t=(e=this.settings).onInterrupt)===null||t===void 0||t.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var t,e;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:n,settings:i}=this;this._handle=n.addChannel({delay:n.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(t=(e=this.settings).onUpdate)===null||t===void 0||t.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const $I=()=>{},hw={BREAK:1,SNAP_TO_END:2,IGNORE:3},yK=r=>r,_K=hw.BREAK;class vK{constructor(t){j(this,"getControllerState",void 0),j(this,"props",void 0),j(this,"propsInTransition",void 0),j(this,"transition",void 0),j(this,"onViewStateChange",void 0),j(this,"onStateChange",void 0),j(this,"_onTransitionUpdate",e=>{const{time:n,settings:{interpolator:i,startProps:s,endProps:a,duration:o,easing:d}}=e,f=d(n/o),_=i.interpolateProps(s,a,f);this.propsInTransition=this.getControllerState({...this.props,..._}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=t.getControllerState,this.propsInTransition=null,this.transition=new Tg(t.timeline),this.onViewStateChange=t.onViewStateChange||$I,this.onStateChange=t.onStateChange||$I}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(this.props=t,!n||this._shouldIgnoreViewportChange(n,t))return!1;if(this._isTransitionEnabled(t)){let i=n;if(this.transition.inProgress){const{interruption:s,endProps:a}=this.transition.settings;i={...n,...s===hw.SNAP_TO_END?a:this.propsInTransition||n}}this._triggerTransition(i,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||e==="auto")&&!!n}_isUpdateDueToCurrentTransition(t){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition):!1}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?this.transition.settings.interruption===hw.IGNORE||this._isUpdateDueToCurrentTransition(e):this._isTransitionEnabled(e)?e.transitionInterpolator.arePropsEqual(t,e):!0}_triggerTransition(t,e){const n=this.getControllerState(t),i=this.getControllerState(e).shortestPathFrom(n),s=e.transitionInterpolator,a=s.getDuration?s.getDuration(t,e):e.transitionDuration;if(a===0)return;const o=s.initializeProps(t,i);this.propsInTransition={};const d={duration:a,easing:e.transitionEasing||yK,interpolator:s,interruption:e.transitionInterruption||_K,startProps:o.start,endProps:o.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)};this.transition.start(d),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),t==null||t(e)}}}class bK{constructor(t){j(this,"_propsToCompare",void 0),j(this,"_propsToExtract",void 0),j(this,"_requiredProps",void 0);const{compare:e,extract:n,required:i}=t;this._propsToCompare=e,this._propsToExtract=n||e,this._requiredProps=i}arePropsEqual(t,e){for(const n of this._propsToCompare)if(!(n in t)||!(n in e)||!$l(t[n],e[n]))return!1;return!0}initializeProps(t,e){const n={},i={};for(const s of this._propsToExtract)(s in t||s in e)&&(n[s]=t[s],i[s]=e[s]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach(e=>{const n=t[e];Ws(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))})}}const wK=["longitude","latitude","zoom","bearing","pitch"],xK=["longitude","latitude","zoom"];class WI extends bK{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=Array.isArray(t)?t:t.transitionProps,n=Array.isArray(t)?{}:t;n.transitionProps=Array.isArray(e)?{compare:e,required:e}:e||{compare:wK,required:xK},super(n.transitionProps),j(this,"opts",void 0),this.opts=n}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:i,around:s}=this.opts;if(i&&s){const a=i(t),o=i(e),d=a.unproject(s);n.start.around=s,Object.assign(n.end,{around:o.project(d),aroundPosition:d,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const i={};for(const s of this._propsToExtract)i[s]=j0(t[s]||0,e[s]||0,n);if(e.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...e,...i});Object.assign(i,s.panByPosition(e.aroundPosition,j0(t.around,e.around,n)))}return i}}const jA={transitionDuration:0},BK=300,ly=r=>1-(1-r)*(1-r),pf={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Gh={};class CK{constructor(t){j(this,"props",void 0),j(this,"state",{}),j(this,"transitionManager",void 0),j(this,"eventManager",void 0),j(this,"onViewStateChange",void 0),j(this,"onStateChange",void 0),j(this,"makeViewport",void 0),j(this,"_controllerState",void 0),j(this,"_events",{}),j(this,"_interactionState",{isDragging:!1}),j(this,"_customEvents",[]),j(this,"_eventStartBlocked",null),j(this,"_panMove",!1),j(this,"invertPan",!1),j(this,"dragMode","rotate"),j(this,"inertia",0),j(this,"scrollZoom",!0),j(this,"dragPan",!0),j(this,"dragRotate",!0),j(this,"doubleClickZoom",!0),j(this,"touchZoom",!0),j(this,"touchRotate",!1),j(this,"keyboard",!0),this.transitionManager=new vK({...t,getControllerState:e=>new this.ControllerState(e),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=t.eventManager,this.onViewStateChange=t.onViewStateChange||(()=>{}),this.onStateChange=t.onStateChange||(()=>{}),this.makeViewport=t.makeViewport}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events)if(this._events[e]){var t;(t=this.eventManager)===null||t===void 0||t.off(e,this.handleEvent)}this.transitionManager.finalize()}handleEvent(t){this._controllerState=void 0;const e=this._eventStartBlocked;switch(t.type){case"panstart":return e?!1:this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return e?!1:this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return e?!1:this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(t){const{x:e,y:n}=this.props,{offsetCenter:i}=t;return[i.x-e,i.y-n]}isPointInBounds(t,e){const{width:n,height:i}=this.props;if(e&&e.handled)return!1;const s=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=i;return s&&e&&e.stopPropagation(),s}isFunctionKeyPressed(t){const{srcEvent:e}=t;return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(t){const e=setTimeout(()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)},t);this._eventStartBlocked=e}setProps(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);const{inertia:e}=t;this.inertia=Number.isFinite(e)?e:e===!0?BK:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:a=!0,touchZoom:o=!0,touchRotate:d=!1,keyboard:f=!0}=t,_=!!this.onViewStateChange;this.toggleEvents(pf.WHEEL,_&&n),this.toggleEvents(pf.PAN,_),this.toggleEvents(pf.PINCH,_&&(o||d)),this.toggleEvents(pf.TRIPLE_PAN,_&&d),this.toggleEvents(pf.DOUBLE_TAP,_&&a),this.toggleEvents(pf.KEYBOARD,_&&f),this.scrollZoom=n,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=a,this.touchZoom=o,this.touchRotate=d,this.keyboard=f}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach(n=>{this._events[n]!==e&&(this._events[n]=e,e?this.eventManager.on(n,this.handleEvent):this.eventManager.off(n,this.handleEvent))})}updateViewport(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i={...t.getViewportProps(),...e},s=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(n),s){const a=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:a})}}_onTransition(t){this.onViewStateChange({...t,interactionState:this._interactionState})}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(i,jA,{isDragging:!0}),!0}_onPan(t){return this.isDragging()?this._panMove?this._onPanMove(t):this._onPanRotate(t):!1}_onPanEnd(t){return this.isDragging()?this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t):!1}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,jA,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:ly},{isDragging:!1,isPanning:!0})}else{const n=this.controllerState.panEnd();this.updateViewport(n,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,jA,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:ly},{isDragging:!1,isRotating:!0})}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;t.srcEvent.preventDefault();const{speed:n=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=t;let a=2/(1+Math.exp(-Math.abs(s*n)));s<0&&a!==0&&(a=1/a);const o=this.controllerState.zoom({pos:e,scale:a});return this.updateViewport(o,{...this._getTransitionProps({around:e}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,jA,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate||!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,jA,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),i=[n[0],n[1]+=t.velocityY*e/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:ly},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return Gh._startPinchRotation=t.rotation,Gh._lastPinchEvent=t,this.updateViewport(n,jA,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,i=this.getCenter(t);e=e.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:Gh._startPinchRotation-n})}return this.updateViewport(e,jA,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Gh._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this,{_lastPinchEvent:n}=Gh;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const i=this.getCenter(t);let s=this.controllerState.rotateEnd();const a=Math.log2(t.scale),o=(a-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),d=Math.pow(2,a+o*e/2);s=s.zoom({pos:i,scale:d}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:e,transitionEasing:ly},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Gh._startPinchRotation=null,Gh._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),i=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:a}=this.keyboard===!0?{}:this.keyboard,{controllerState:o}=this;let d;const f={};switch(t.srcEvent.code){case"Minus":d=e?o.zoomOut(n).zoomOut(n):o.zoomOut(n),f.isZooming=!0;break;case"Equal":d=e?o.zoomIn(n).zoomIn(n):o.zoomIn(n),f.isZooming=!0;break;case"ArrowLeft":e?(d=o.rotateLeft(s),f.isRotating=!0):(d=o.moveLeft(i),f.isPanning=!0);break;case"ArrowRight":e?(d=o.rotateRight(s),f.isRotating=!0):(d=o.moveRight(i),f.isPanning=!0);break;case"ArrowUp":e?(d=o.rotateUp(a),f.isRotating=!0):(d=o.moveUp(i),f.isPanning=!0);break;case"ArrowDown":e?(d=o.rotateDown(a),f.isRotating=!0):(d=o.moveDown(i),f.isPanning=!0);break;default:return!1}return this.updateViewport(d,this._getTransitionProps(),f),!0}_getTransitionProps(t){const{transition:e}=this;return!e||!e.transitionInterpolator?jA:t?{...e,transitionInterpolator:new WI({...t,...e.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:e}}class EK{constructor(t,e){j(this,"_viewportProps",void 0),j(this,"_state",void 0),this._viewportProps=this.applyConstraints(t),this._state=e}getViewportProps(){return this._viewportProps}getState(){return this._state}}const XI=5,SK=1.2;class TK extends EK{constructor(t){const{width:e,height:n,latitude:i,longitude:s,zoom:a,bearing:o=0,pitch:d=0,altitude:f=1.5,position:_=[0,0,0],maxZoom:w=20,minZoom:x=0,maxPitch:B=60,minPitch:P=0,startPanLngLat:R,startZoomLngLat:N,startRotatePos:Q,startBearing:V,startPitch:W,startZoom:et,normalize:ct=!0}=t;Ws(Number.isFinite(s)),Ws(Number.isFinite(i)),Ws(Number.isFinite(a)),super({width:e,height:n,latitude:i,longitude:s,zoom:a,bearing:o,pitch:d,altitude:f,maxZoom:w,minZoom:x,maxPitch:B,minPitch:P,normalize:ct,position:_},{startPanLngLat:R,startZoomLngLat:N,startRotatePos:Q,startBearing:V,startPitch:W,startZoom:et}),j(this,"makeViewport",void 0),this.makeViewport=t.makeViewport}panStart(t){let{pos:e}=t;return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan(t){let{pos:e,startPos:n}=t;const i=this.getState().startPanLngLat||this._unproject(n);if(!i)return this;const a=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(a)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart(t){let{pos:e}=t;return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate(t){let{pos:e,deltaAngleX:n=0,deltaAngleY:i=0}=t;const{startRotatePos:s,startBearing:a,startPitch:o}=this.getState();if(!s||a===void 0||o===void 0)return this;let d;return e?d=this._getNewRotation(e,s,o,a):d={bearing:a+n,pitch:o+i},this._getUpdatedState(d)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart(t){let{pos:e}=t;return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom(t){let{pos:e,startPos:n,scale:i}=t,{startZoom:s,startZoomLngLat:a}=this.getState();if(a||(s=this.getViewportProps().zoom,a=this._unproject(n)||this._unproject(e)),!a)return this;const{maxZoom:o,minZoom:d}=this.getViewportProps();let f=s+Math.log2(i);f=Vu(f,d,o);const _=this.makeViewport({...this.getViewportProps(),zoom:f});return this._getUpdatedState({zoom:f,..._.panByPosition(a,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2;return this._zoomFromCenter(t)}zoomOut(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2;return this._zoomFromCenter(1/t)}moveLeft(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return this._panFromCenter([t,0])}moveRight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return this._panFromCenter([-t,0])}moveUp(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return this._panFromCenter([0,t])}moveDown(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return this._panFromCenter([0,-t])}rotateLeft(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:s}=n;return Math.abs(i-e.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(s-e.longitude)>180&&(n.longitude=s<0?s+360:s-360),n}applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i}=t;t.zoom=Vu(i,n,e);const{maxPitch:s,minPitch:a,pitch:o}=t;t.pitch=Vu(o,a,s);const{normalize:d=!0}=t;return d&&Object.assign(t,Rq(t)),t}_zoomFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}_unproject(t){const e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}_getNewRotation(t,e,n,i){const s=t[0]-e[0],a=t[1]-e[1],o=t[1],d=e[1],{width:f,height:_}=this.getViewportProps(),w=s/f;let x=0;a>0?Math.abs(_-d)>XI&&(x=a/(d-_)*SK):a<0&&d>XI&&(x=1-o/d),x=Vu(x,-1,1);const{minPitch:B,maxPitch:P}=this.getViewportProps(),R=i+180*w;let N=n;return x>0?N=n+x*(P-n):x<0&&(N=n-x*(B-n)),{pitch:N,bearing:R}}}class IK extends CK{constructor(){super(...arguments),j(this,"ControllerState",TK),j(this,"transition",{transitionDuration:300,transitionInterpolator:new WI({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),j(this,"dragMode","pan")}setProps(t){t.position=t.position||[0,0,0];const e=this.props;super.setProps(t),(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...t,...this.state}))}}class dw extends mK{get ViewportType(){return Hh}get ControllerType(){return IK}}j(dw,"displayName","MapView");const FK=new ow;function LK(r,t){var e,n;const i=(e=r.order)!==null&&e!==void 0?e:1/0,s=(n=t.order)!==null&&n!==void 0?n:1/0;return i-s}class PK{constructor(){j(this,"effects",void 0),j(this,"_resolvedEffects",[]),j(this,"_defaultEffects",[]),j(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(t){const e=this._defaultEffects;if(!e.find(n=>n.id===t.id)){const n=e.findIndex(i=>LK(i,t)>0);n<0?e.push(t):e.splice(n,0,t),this._setEffects(this.effects)}}setProps(t){"effects"in t&&(Nc(t.effects,this.effects,1)||this._setEffects(t.effects))}needsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._resolvedEffects}_setEffects(t){const e={};for(const i of this.effects)e[i.id]=i;const n=[];for(const i of t){const s=e[i.id];s&&s!==i?s.setProps?(s.setProps(i.props),n.push(s)):(s.cleanup(),n.push(i)):n.push(i),delete e[i.id]}for(const i in e)e[i].cleanup();this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),t.some(i=>i instanceof ow)||this._resolvedEffects.push(FK),this._needsRedraw="effects changed"}finalize(){for(const t of this._resolvedEffects)t.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class MK extends Yb{shouldDrawLayer(t){const{operation:e}=t.props;return e.includes("draw")||e.includes("terrain")}}const RK="deckRenderer.renderLayers";class UK{constructor(t){j(this,"gl",void 0),j(this,"layerFilter",void 0),j(this,"drawPickingColors",void 0),j(this,"drawLayersPass",void 0),j(this,"pickLayersPass",void 0),j(this,"renderCount",void 0),j(this,"_needsRedraw",void 0),j(this,"renderBuffers",void 0),j(this,"lastPostProcessEffect",void 0),this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new MK(t),this.pickLayersPass=new qI(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){if(!t.viewports.length)return;const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...t,target:t.target||ys.getDefaultFramebuffer(this.gl)};n.effects&&this._preRender(n.effects,n);const i=this.lastPostProcessEffect?this.renderBuffers[0]:n.target,s=e.render({...n,target:i});n.effects&&this._postRender(n.effects,n),this.renderCount++,Ao(RK,this,s,t)}needsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){this.lastPostProcessEffect=null,e.preRenderStats=e.preRenderStats||{};for(const n of t)e.preRenderStats[n.id]=n.preRender(this.gl,e),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:t}=this;t.length===0&&t.push(new ys(this.gl),new ys(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:n}=this,i={...e,inputBuffer:n[0],swapBuffer:n[1],target:null};for(const s of t)if(s.postRender){if(s.id===this.lastPostProcessEffect){i.target=e.target,s.postRender(this.gl,i);break}const a=s.postRender(this.gl,i);i.inputBuffer=a,i.swapBuffer=a===n[0]?n[1]:n[0]}}}const OK={pickedColor:null,pickedObjectIndex:-1};function DK(r){let{pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:i,deviceRadius:s,deviceRect:a}=r;const{x:o,y:d,width:f,height:_}=a;let w=s*s,x=-1,B=0;for(let P=0;P<_;P++){const R=P+d-i,N=R*R;if(N>w)B+=4*f;else for(let Q=0;Q<f;Q++){if(t[B+3]-1>=0){const W=Q+o-n,et=W*W+N;et<=w&&(w=et,x=B)}B+=4}}if(x>=0){const P=t.slice(x,x+4),R=e(P);if(R){const N=Math.floor(x/4/f),Q=x/4-N*f;return{...R,pickedColor:P,pickedX:o+Q,pickedY:d+N}}Tn.error("Picked non-existent layer. Is picking buffer corrupt?")()}return OK}function NK(r){let{pickedColors:t,decodePickingColor:e}=r;const n=new Map;if(t){for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const a=t.slice(i,i+4),o=a.join(",");if(!n.has(o)){const d=e(a);d?n.set(o,{...d,color:a}):Tn.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function JI(r){let{pickInfo:t,viewports:e,pixelRatio:n,x:i,y:s,z:a}=r,o=e[0];e.length>1&&(o=QK((t==null?void 0:t.pickedViewports)||e,{x:i,y:s}));let d;if(o){const f=[i-o.x,s-o.y];a!==void 0&&(f[2]=a),d=o.unproject(f)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:i,y:s,pixel:[i,s],coordinate:d,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function kK(r){const{pickInfo:t,lastPickedInfo:e,mode:n,layers:i}=r,{pickedColor:s,pickedLayer:a,pickedObjectIndex:o}=t,d=a?[a]:[];if(n==="hover"){const w=e.index,x=e.layerId,B=a?a.props.id:null;if(B!==x||o!==w){if(B!==x){const P=i.find(R=>R.props.id===x);P&&d.unshift(P)}e.layerId=B,e.index=o,e.info=null}}const f=JI(r),_=new Map;return _.set(null,f),d.forEach(w=>{let x={...f};w===a&&(x.color=s,x.index=o,x.picked=!0),x=YI({layer:w,info:x,mode:n});const B=x.layer;w===a&&n==="hover"&&(e.info=x),_.set(B.id,x),n==="hover"&&B.updateAutoHighlight(x)}),_}function YI(r){let{layer:t,info:e,mode:n}=r;for(;t&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:i}),t=t.parent}return e}function QK(r,t){for(let e=r.length-1;e>=0;e--){const n=r[e];if(n.containsPixel(t))return n}return r[0]}class zK{constructor(t){j(this,"gl",void 0),j(this,"pickingFBO",void 0),j(this,"depthFBO",void 0),j(this,"pickLayersPass",void 0),j(this,"layerFilter",void 0),j(this,"lastPickedInfo",void 0),j(this,"_pickable",!0),this.gl=t,this.pickLayersPass=new qI(t),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject(t){let{x:e,y:n,layers:i,viewports:s}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.lastPickedInfo.info;const o=a&&a.layer&&a.layer.id,d=a&&a.viewport&&a.viewport.id,f=o?i.find(B=>B.id===o):null,_=d&&s.find(B=>B.id===d)||s[0],w=_&&_.unproject([e-_.x,n-_.y]);return{...a,...{x:e,y:n,viewport:_,coordinate:w,layer:f}}}_resizeBuffer(){var t,e;const{gl:n}=this;if(!this.pickingFBO&&(this.pickingFBO=new ys(n),ys.isSupported(n,{colorBufferFloat:!0}))){const i=new ys(n);i.attach({36064:new Ua(n,{format:mn(n)?34836:6408,type:5126})}),this.depthFBO=i}(t=this.pickingFBO)===null||t===void 0||t.resize({width:n.canvas.width,height:n.canvas.height}),(e=this.depthFBO)===null||e===void 0||e.resize({width:n.canvas.width,height:n.canvas.height})}_getPickable(t){if(this._pickable===!1)return null;const e=t.filter(n=>this.pickLayersPass.shouldDrawLayer(n)&&!n.isComposite);return e.length?e:null}_pickClosestObject(t){let{layers:e,views:n,viewports:i,x:s,y:a,radius:o=0,depth:d=1,mode:f="query",unproject3D:_,onViewportActive:w,effects:x}=t;const B=this._getPickable(e),P=Zd(this.gl);if(!B)return{result:[],emptyInfo:JI({viewports:i,x:s,y:a,pixelRatio:P})};this._resizeBuffer();const R=ub(this.gl,[s,a],!0),N=[R.x+Math.floor(R.width/2),R.y+Math.floor(R.height/2)],Q=Math.round(o*P),{width:V,height:W}=this.pickingFBO,et=this._getPickingRect({deviceX:N[0],deviceY:N[1],deviceRadius:Q,deviceWidth:V,deviceHeight:W}),ct={x:s-o,y:a-o,width:o*2+1,height:o*2+1};let dt;const gt=[],ht=new Set;for(let It=0;It<d;It++){let St;if(et){const at=this._drawAndSample({layers:B,views:n,viewports:i,onViewportActive:w,deviceRect:et,cullRect:ct,effects:x,pass:"picking:".concat(f)});St=DK({...at,deviceX:N[0],deviceY:N[1],deviceRadius:Q,deviceRect:et})}else St={pickedColor:null,pickedObjectIndex:-1};let ot;if(St.pickedLayer&&_&&this.depthFBO){const{pickedColors:at}=this._drawAndSample({layers:[St.pickedLayer],views:n,viewports:i,onViewportActive:w,deviceRect:{x:St.pickedX,y:St.pickedY,width:1,height:1},cullRect:ct,effects:x,pass:"picking:".concat(f,":z")},!0);at[3]&&(ot=at[0])}St.pickedLayer&&It+1<d&&(ht.add(St.pickedLayer),St.pickedLayer.disablePickingIndex(St.pickedObjectIndex)),dt=kK({pickInfo:St,lastPickedInfo:this.lastPickedInfo,mode:f,layers:B,viewports:i,x:s,y:a,z:ot,pixelRatio:P});for(const at of dt.values())at.layer&&gt.push(at);if(!St.pickedColor)break}for(const It of ht)It.restorePickingColors();return{result:gt,emptyInfo:dt.get(null)}}_pickVisibleObjects(t){let{layers:e,views:n,viewports:i,x:s,y:a,width:o=1,height:d=1,mode:f="query",maxObjects:_=null,onViewportActive:w,effects:x}=t;const B=this._getPickable(e);if(!B)return[];this._resizeBuffer();const P=Zd(this.gl),R=ub(this.gl,[s,a],!0),N=R.x,Q=R.y+R.height,V=ub(this.gl,[s+o,a+d],!0),W=V.x+V.width,et=V.y,ct={x:N,y:et,width:W-N,height:Q-et},dt=this._drawAndSample({layers:B,views:n,viewports:i,onViewportActive:w,deviceRect:ct,cullRect:{x:s,y:a,width:o,height:d},effects:x,pass:"picking:".concat(f)}),gt=NK(dt),ht=new Map,It=Number.isFinite(_);for(let ot=0;ot<gt.length;ot++){var St;if(It&&_&&ht.size>=_)break;const at=gt[ot];let bt={color:at.pickedColor,layer:null,index:at.pickedObjectIndex,picked:!0,x:s,y:a,pixelRatio:P};bt=YI({layer:at.pickedLayer,info:bt,mode:f});const vt=(St=bt.object)!==null&&St!==void 0?St:"".concat(bt.layer.id,"[").concat(bt.index,"]");ht.has(vt)||ht.set(vt,bt)}return Array.from(ht.values())}_drawAndSample(t){let{layers:e,views:n,viewports:i,onViewportActive:s,deviceRect:a,cullRect:o,effects:d,pass:f}=t,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=_?this.depthFBO:this.pickingFBO,x={layers:e,layerFilter:this.layerFilter,views:n,viewports:i,onViewportActive:s,pickingFBO:w,deviceRect:a,cullRect:o,effects:d,pass:f,pickZ:_,preRenderStats:{}};for(const W of d)W.useInPicking&&(x.preRenderStats[W.id]=W.preRender(this.gl,x));const{decodePickingColor:B}=this.pickLayersPass.render(x),{x:P,y:R,width:N,height:Q}=a,V=new(_?Float32Array:Uint8Array)(N*Q*4);return U0(w,{sourceX:P,sourceY:R,sourceWidth:N,sourceHeight:Q,target:V}),{pickedColors:V,decodePickingColor:B}}_getPickingRect(t){let{deviceX:e,deviceY:n,deviceRadius:i,deviceWidth:s,deviceHeight:a}=t;const o=Math.max(0,e-i),d=Math.max(0,n-i),f=Math.min(s,e+i+1)-o,_=Math.min(a,n+i+1)-d;return f<=0||_<=0?null:{x:o,y:d,width:f,height:_}}}const HK={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class VK{constructor(t){j(this,"el",null),j(this,"isVisible",!1);const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,HK),e.appendChild(this.el))}setTooltip(t,e,n){const i=this.el;if(i){if(typeof t=="string")i.innerText=t;else if(t)t.text&&(i.innerText=t.text),t.html&&(i.innerHTML=t.html),t.className&&(i.className=t.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(e,"px, ").concat(n,"px)"),t&&typeof t=="object"&&"style"in t&&Object.assign(i.style,t.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var ZI={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(r){(function(t,e,n,i){var s=["","webkit","Moz","MS","ms","o"],a=e.createElement("div"),o="function",d=Math.round,f=Math.abs,_=Date.now;function w(ut,xt,kt){return setTimeout(W(ut,kt),xt)}function x(ut,xt,kt){return Array.isArray(ut)?(B(ut,kt[xt],kt),!0):!1}function B(ut,xt,kt){var ae;if(ut)if(ut.forEach)ut.forEach(xt,kt);else if(ut.length!==i)for(ae=0;ae<ut.length;)xt.call(kt,ut[ae],ae,ut),ae++;else for(ae in ut)ut.hasOwnProperty(ae)&&xt.call(kt,ut[ae],ae,ut)}function P(ut,xt,kt){var ae="DEPRECATED METHOD: "+xt+`
`+kt+` AT 
`;return function(){var Fe=new Error("get-stack-trace"),Xe=Fe&&Fe.stack?Fe.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",zr=t.console&&(t.console.warn||t.console.log);return zr&&zr.call(t.console,ae,Xe),ut.apply(this,arguments)}}var R;typeof Object.assign!="function"?R=function(xt){if(xt===i||xt===null)throw new TypeError("Cannot convert undefined or null to object");for(var kt=Object(xt),ae=1;ae<arguments.length;ae++){var Fe=arguments[ae];if(Fe!==i&&Fe!==null)for(var Xe in Fe)Fe.hasOwnProperty(Xe)&&(kt[Xe]=Fe[Xe])}return kt}:R=Object.assign;var N=P(function(xt,kt,ae){for(var Fe=Object.keys(kt),Xe=0;Xe<Fe.length;)(!ae||ae&&xt[Fe[Xe]]===i)&&(xt[Fe[Xe]]=kt[Fe[Xe]]),Xe++;return xt},"extend","Use `assign`."),Q=P(function(xt,kt){return N(xt,kt,!0)},"merge","Use `assign`.");function V(ut,xt,kt){var ae=xt.prototype,Fe;Fe=ut.prototype=Object.create(ae),Fe.constructor=ut,Fe._super=ae,kt&&R(Fe,kt)}function W(ut,xt){return function(){return ut.apply(xt,arguments)}}function et(ut,xt){return typeof ut==o?ut.apply(xt&&xt[0]||i,xt):ut}function ct(ut,xt){return ut===i?xt:ut}function dt(ut,xt,kt){B(St(xt),function(ae){ut.addEventListener(ae,kt,!1)})}function gt(ut,xt,kt){B(St(xt),function(ae){ut.removeEventListener(ae,kt,!1)})}function ht(ut,xt){for(;ut;){if(ut==xt)return!0;ut=ut.parentNode}return!1}function It(ut,xt){return ut.indexOf(xt)>-1}function St(ut){return ut.trim().split(/\s+/g)}function ot(ut,xt,kt){if(ut.indexOf&&!kt)return ut.indexOf(xt);for(var ae=0;ae<ut.length;){if(kt&&ut[ae][kt]==xt||!kt&&ut[ae]===xt)return ae;ae++}return-1}function at(ut){return Array.prototype.slice.call(ut,0)}function bt(ut,xt,kt){for(var ae=[],Fe=[],Xe=0;Xe<ut.length;){var zr=ut[Xe][xt];ot(Fe,zr)<0&&ae.push(ut[Xe]),Fe[Xe]=zr,Xe++}return ae=ae.sort(function(Jn,Si){return Jn[xt]>Si[xt]}),ae}function vt(ut,xt){for(var kt,ae,Fe=xt[0].toUpperCase()+xt.slice(1),Xe=0;Xe<s.length;){if(kt=s[Xe],ae=kt?kt+Fe:xt,ae in ut)return ae;Xe++}return i}var $t=1;function Wt(){return $t++}function Jt(ut){var xt=ut.ownerDocument||ut;return xt.defaultView||xt.parentWindow||t}var qt=/mobile|tablet|ip(ad|hone|od)|android/i,te="ontouchstart"in t,Yt=vt(t,"PointerEvent")!==i,be=te&&qt.test(navigator.userAgent),it="touch",wt="pen",Ft="mouse",Ut="kinect",jt=25,Vt=1,re=2,Zt=4,Be=8,Ie=1,ke=2,He=4,Ke=8,le=16,st=ke|He,pr=Ke|le,Ye=st|pr,ue=["x","y"],ye=["clientX","clientY"];function Le(ut,xt){var kt=this;this.manager=ut,this.callback=xt,this.element=ut.element,this.target=ut.options.inputTarget,this.domHandler=function(ae){et(ut.options.enable,[ut])&&kt.handler(ae)},this.init()}Le.prototype={handler:function(){},init:function(){this.evEl&&dt(this.element,this.evEl,this.domHandler),this.evTarget&&dt(this.target,this.evTarget,this.domHandler),this.evWin&&dt(Jt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&gt(this.element,this.evEl,this.domHandler),this.evTarget&&gt(this.target,this.evTarget,this.domHandler),this.evWin&&gt(Jt(this.element),this.evWin,this.domHandler)}};function Oe(ut){var xt,kt=ut.options.inputClass;return kt?xt=kt:Yt?xt=Ct:be?xt=Pt:te?xt=we:xt=ze,new xt(ut,We)}function We(ut,xt,kt){var ae=kt.pointers.length,Fe=kt.changedPointers.length,Xe=xt&Vt&&ae-Fe===0,zr=xt&(Zt|Be)&&ae-Fe===0;kt.isFirst=!!Xe,kt.isFinal=!!zr,Xe&&(ut.session={}),kt.eventType=xt,cr(ut,kt),ut.emit("hammer.input",kt),ut.recognize(kt),ut.session.prevInput=kt}function cr(ut,xt){var kt=ut.session,ae=xt.pointers,Fe=ae.length;kt.firstInput||(kt.firstInput=Ur(xt)),Fe>1&&!kt.firstMultiple?kt.firstMultiple=Ur(xt):Fe===1&&(kt.firstMultiple=!1);var Xe=kt.firstInput,zr=kt.firstMultiple,Xn=zr?zr.center:Xe.center,Jn=xt.center=de(ae);xt.timeStamp=_(),xt.deltaTime=xt.timeStamp-Xe.timeStamp,xt.angle=gn(Xn,Jn),xt.distance=De(Xn,Jn),yr(kt,xt),xt.offsetDirection=_r(xt.deltaX,xt.deltaY);var Si=ur(xt.deltaTime,xt.deltaX,xt.deltaY);xt.overallVelocityX=Si.x,xt.overallVelocityY=Si.y,xt.overallVelocity=f(Si.x)>f(Si.y)?Si.x:Si.y,xt.scale=zr?gr(zr.pointers,ae):1,xt.rotation=zr?pe(zr.pointers,ae):0,xt.maxPointers=kt.prevInput?xt.pointers.length>kt.prevInput.maxPointers?xt.pointers.length:kt.prevInput.maxPointers:xt.pointers.length,Fr(kt,xt);var wn=ut.element;ht(xt.srcEvent.target,wn)&&(wn=xt.srcEvent.target),xt.target=wn}function yr(ut,xt){var kt=xt.center,ae=ut.offsetDelta||{},Fe=ut.prevDelta||{},Xe=ut.prevInput||{};(xt.eventType===Vt||Xe.eventType===Zt)&&(Fe=ut.prevDelta={x:Xe.deltaX||0,y:Xe.deltaY||0},ae=ut.offsetDelta={x:kt.x,y:kt.y}),xt.deltaX=Fe.x+(kt.x-ae.x),xt.deltaY=Fe.y+(kt.y-ae.y)}function Fr(ut,xt){var kt=ut.lastInterval||xt,ae=xt.timeStamp-kt.timeStamp,Fe,Xe,zr,Xn;if(xt.eventType!=Be&&(ae>jt||kt.velocity===i)){var Jn=xt.deltaX-kt.deltaX,Si=xt.deltaY-kt.deltaY,wn=ur(ae,Jn,Si);Xe=wn.x,zr=wn.y,Fe=f(wn.x)>f(wn.y)?wn.x:wn.y,Xn=_r(Jn,Si),ut.lastInterval=xt}else Fe=kt.velocity,Xe=kt.velocityX,zr=kt.velocityY,Xn=kt.direction;xt.velocity=Fe,xt.velocityX=Xe,xt.velocityY=zr,xt.direction=Xn}function Ur(ut){for(var xt=[],kt=0;kt<ut.pointers.length;)xt[kt]={clientX:d(ut.pointers[kt].clientX),clientY:d(ut.pointers[kt].clientY)},kt++;return{timeStamp:_(),pointers:xt,center:de(xt),deltaX:ut.deltaX,deltaY:ut.deltaY}}function de(ut){var xt=ut.length;if(xt===1)return{x:d(ut[0].clientX),y:d(ut[0].clientY)};for(var kt=0,ae=0,Fe=0;Fe<xt;)kt+=ut[Fe].clientX,ae+=ut[Fe].clientY,Fe++;return{x:d(kt/xt),y:d(ae/xt)}}function ur(ut,xt,kt){return{x:xt/ut||0,y:kt/ut||0}}function _r(ut,xt){return ut===xt?Ie:f(ut)>=f(xt)?ut<0?ke:He:xt<0?Ke:le}function De(ut,xt,kt){kt||(kt=ue);var ae=xt[kt[0]]-ut[kt[0]],Fe=xt[kt[1]]-ut[kt[1]];return Math.sqrt(ae*ae+Fe*Fe)}function gn(ut,xt,kt){kt||(kt=ue);var ae=xt[kt[0]]-ut[kt[0]],Fe=xt[kt[1]]-ut[kt[1]];return Math.atan2(Fe,ae)*180/Math.PI}function pe(ut,xt){return gn(xt[1],xt[0],ye)+gn(ut[1],ut[0],ye)}function gr(ut,xt){return De(xt[0],xt[1],ye)/De(ut[0],ut[1],ye)}var Qe={mousedown:Vt,mousemove:re,mouseup:Zt},Mr="mousedown",_n="mousemove mouseup";function ze(){this.evEl=Mr,this.evWin=_n,this.pressed=!1,Le.apply(this,arguments)}V(ze,Le,{handler:function(xt){var kt=Qe[xt.type];kt&Vt&&xt.button===0&&(this.pressed=!0),kt&re&&xt.which!==1&&(kt=Zt),this.pressed&&(kt&Zt&&(this.pressed=!1),this.callback(this.manager,kt,{pointers:[xt],changedPointers:[xt],pointerType:Ft,srcEvent:xt}))}});var Nn={pointerdown:Vt,pointermove:re,pointerup:Zt,pointercancel:Be,pointerout:Be},sn={2:it,3:wt,4:Ft,5:Ut},vn="pointerdown",cn="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(vn="MSPointerDown",cn="MSPointerMove MSPointerUp MSPointerCancel");function Ct(){this.evEl=vn,this.evWin=cn,Le.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}V(Ct,Le,{handler:function(xt){var kt=this.store,ae=!1,Fe=xt.type.toLowerCase().replace("ms",""),Xe=Nn[Fe],zr=sn[xt.pointerType]||xt.pointerType,Xn=zr==it,Jn=ot(kt,xt.pointerId,"pointerId");Xe&Vt&&(xt.button===0||Xn)?Jn<0&&(kt.push(xt),Jn=kt.length-1):Xe&(Zt|Be)&&(ae=!0),!(Jn<0)&&(kt[Jn]=xt,this.callback(this.manager,Xe,{pointers:kt,changedPointers:[xt],pointerType:zr,srcEvent:xt}),ae&&kt.splice(Jn,1))}});var X={touchstart:Vt,touchmove:re,touchend:Zt,touchcancel:Be},Z="touchstart",ft="touchstart touchmove touchend touchcancel";function Bt(){this.evTarget=Z,this.evWin=ft,this.started=!1,Le.apply(this,arguments)}V(Bt,Le,{handler:function(xt){var kt=X[xt.type];if(kt===Vt&&(this.started=!0),!!this.started){var ae=Qt.call(this,xt,kt);kt&(Zt|Be)&&ae[0].length-ae[1].length===0&&(this.started=!1),this.callback(this.manager,kt,{pointers:ae[0],changedPointers:ae[1],pointerType:it,srcEvent:xt})}}});function Qt(ut,xt){var kt=at(ut.touches),ae=at(ut.changedTouches);return xt&(Zt|Be)&&(kt=bt(kt.concat(ae),"identifier")),[kt,ae]}var Gt={touchstart:Vt,touchmove:re,touchend:Zt,touchcancel:Be},Nt="touchstart touchmove touchend touchcancel";function Pt(){this.evTarget=Nt,this.targetIds={},Le.apply(this,arguments)}V(Pt,Le,{handler:function(xt){var kt=Gt[xt.type],ae=se.call(this,xt,kt);ae&&this.callback(this.manager,kt,{pointers:ae[0],changedPointers:ae[1],pointerType:it,srcEvent:xt})}});function se(ut,xt){var kt=at(ut.touches),ae=this.targetIds;if(xt&(Vt|re)&&kt.length===1)return ae[kt[0].identifier]=!0,[kt,kt];var Fe,Xe,zr=at(ut.changedTouches),Xn=[],Jn=this.target;if(Xe=kt.filter(function(Si){return ht(Si.target,Jn)}),xt===Vt)for(Fe=0;Fe<Xe.length;)ae[Xe[Fe].identifier]=!0,Fe++;for(Fe=0;Fe<zr.length;)ae[zr[Fe].identifier]&&Xn.push(zr[Fe]),xt&(Zt|Be)&&delete ae[zr[Fe].identifier],Fe++;if(Xn.length)return[bt(Xe.concat(Xn),"identifier"),Xn]}var he=2500,Xt=25;function we(){Le.apply(this,arguments);var ut=W(this.handler,this);this.touch=new Pt(this.manager,ut),this.mouse=new ze(this.manager,ut),this.primaryTouch=null,this.lastTouches=[]}V(we,Le,{handler:function(xt,kt,ae){var Fe=ae.pointerType==it,Xe=ae.pointerType==Ft;if(!(Xe&&ae.sourceCapabilities&&ae.sourceCapabilities.firesTouchEvents)){if(Fe)je.call(this,kt,ae);else if(Xe&&Qr.call(this,ae))return;this.callback(xt,kt,ae)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function je(ut,xt){ut&Vt?(this.primaryTouch=xt.changedPointers[0].identifier,tr.call(this,xt)):ut&(Zt|Be)&&tr.call(this,xt)}function tr(ut){var xt=ut.changedPointers[0];if(xt.identifier===this.primaryTouch){var kt={x:xt.clientX,y:xt.clientY};this.lastTouches.push(kt);var ae=this.lastTouches,Fe=function(){var Xe=ae.indexOf(kt);Xe>-1&&ae.splice(Xe,1)};setTimeout(Fe,he)}}function Qr(ut){for(var xt=ut.srcEvent.clientX,kt=ut.srcEvent.clientY,ae=0;ae<this.lastTouches.length;ae++){var Fe=this.lastTouches[ae],Xe=Math.abs(xt-Fe.x),zr=Math.abs(kt-Fe.y);if(Xe<=Xt&&zr<=Xt)return!0}return!1}var ir=vt(a.style,"touchAction"),Or=ir!==i,xr="compute",$r="auto",Xr="manipulation",vr="none",jr="pan-x",on="pan-y",In=Ee();function Mt(ut,xt){this.manager=ut,this.set(xt)}Mt.prototype={set:function(ut){ut==xr&&(ut=this.compute()),Or&&this.manager.element.style&&In[ut]&&(this.manager.element.style[ir]=ut),this.actions=ut.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ut=[];return B(this.manager.recognizers,function(xt){et(xt.options.enable,[xt])&&(ut=ut.concat(xt.getTouchAction()))}),Ne(ut.join(" "))},preventDefaults:function(ut){var xt=ut.srcEvent,kt=ut.offsetDirection;if(this.manager.session.prevented){xt.preventDefault();return}var ae=this.actions,Fe=It(ae,vr)&&!In[vr],Xe=It(ae,on)&&!In[on],zr=It(ae,jr)&&!In[jr];if(Fe){var Xn=ut.pointers.length===1,Jn=ut.distance<2,Si=ut.deltaTime<250;if(Xn&&Jn&&Si)return}if(!(zr&&Xe)&&(Fe||Xe&&kt&st||zr&&kt&pr))return this.preventSrc(xt)},preventSrc:function(ut){this.manager.session.prevented=!0,ut.preventDefault()}};function Ne(ut){if(It(ut,vr))return vr;var xt=It(ut,jr),kt=It(ut,on);return xt&&kt?vr:xt||kt?xt?jr:on:It(ut,Xr)?Xr:$r}function Ee(){if(!Or)return!1;var ut={},xt=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(kt){ut[kt]=xt?t.CSS.supports("touch-action",kt):!0}),ut}var or=1,Lr=2,Pn=4,qr=8,yn=qr,mi=16,bn=32;function tn(ut){this.options=R({},this.defaults,ut||{}),this.id=Wt(),this.manager=null,this.options.enable=ct(this.options.enable,!0),this.state=or,this.simultaneous={},this.requireFail=[]}tn.prototype={defaults:{},set:function(ut){return R(this.options,ut),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ut){if(x(ut,"recognizeWith",this))return this;var xt=this.simultaneous;return ut=kn(ut,this),xt[ut.id]||(xt[ut.id]=ut,ut.recognizeWith(this)),this},dropRecognizeWith:function(ut){return x(ut,"dropRecognizeWith",this)?this:(ut=kn(ut,this),delete this.simultaneous[ut.id],this)},requireFailure:function(ut){if(x(ut,"requireFailure",this))return this;var xt=this.requireFail;return ut=kn(ut,this),ot(xt,ut)===-1&&(xt.push(ut),ut.requireFailure(this)),this},dropRequireFailure:function(ut){if(x(ut,"dropRequireFailure",this))return this;ut=kn(ut,this);var xt=ot(this.requireFail,ut);return xt>-1&&this.requireFail.splice(xt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ut){return!!this.simultaneous[ut.id]},emit:function(ut){var xt=this,kt=this.state;function ae(Fe){xt.manager.emit(Fe,ut)}kt<qr&&ae(xt.options.event+$o(kt)),ae(xt.options.event),ut.additionalEvent&&ae(ut.additionalEvent),kt>=qr&&ae(xt.options.event+$o(kt))},tryEmit:function(ut){if(this.canEmit())return this.emit(ut);this.state=bn},canEmit:function(){for(var ut=0;ut<this.requireFail.length;){if(!(this.requireFail[ut].state&(bn|or)))return!1;ut++}return!0},recognize:function(ut){var xt=R({},ut);if(!et(this.options.enable,[this,xt])){this.reset(),this.state=bn;return}this.state&(yn|mi|bn)&&(this.state=or),this.state=this.process(xt),this.state&(Lr|Pn|qr|mi)&&this.tryEmit(xt)},process:function(ut){},getTouchAction:function(){},reset:function(){}};function $o(ut){return ut&mi?"cancel":ut&qr?"end":ut&Pn?"move":ut&Lr?"start":""}function ws(ut){return ut==le?"down":ut==Ke?"up":ut==ke?"left":ut==He?"right":""}function kn(ut,xt){var kt=xt.manager;return kt?kt.get(ut):ut}function hn(){tn.apply(this,arguments)}V(hn,tn,{defaults:{pointers:1},attrTest:function(ut){var xt=this.options.pointers;return xt===0||ut.pointers.length===xt},process:function(ut){var xt=this.state,kt=ut.eventType,ae=xt&(Lr|Pn),Fe=this.attrTest(ut);return ae&&(kt&Be||!Fe)?xt|mi:ae||Fe?kt&Zt?xt|qr:xt&Lr?xt|Pn:Lr:bn}});function Li(){hn.apply(this,arguments),this.pX=null,this.pY=null}V(Li,hn,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ye},getTouchAction:function(){var ut=this.options.direction,xt=[];return ut&st&&xt.push(on),ut&pr&&xt.push(jr),xt},directionTest:function(ut){var xt=this.options,kt=!0,ae=ut.distance,Fe=ut.direction,Xe=ut.deltaX,zr=ut.deltaY;return Fe&xt.direction||(xt.direction&st?(Fe=Xe===0?Ie:Xe<0?ke:He,kt=Xe!=this.pX,ae=Math.abs(ut.deltaX)):(Fe=zr===0?Ie:zr<0?Ke:le,kt=zr!=this.pY,ae=Math.abs(ut.deltaY))),ut.direction=Fe,kt&&ae>xt.threshold&&Fe&xt.direction},attrTest:function(ut){return hn.prototype.attrTest.call(this,ut)&&(this.state&Lr||!(this.state&Lr)&&this.directionTest(ut))},emit:function(ut){this.pX=ut.deltaX,this.pY=ut.deltaY;var xt=ws(ut.direction);xt&&(ut.additionalEvent=this.options.event+xt),this._super.emit.call(this,ut)}});function On(){hn.apply(this,arguments)}V(On,hn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[vr]},attrTest:function(ut){return this._super.attrTest.call(this,ut)&&(Math.abs(ut.scale-1)>this.options.threshold||this.state&Lr)},emit:function(ut){if(ut.scale!==1){var xt=ut.scale<1?"in":"out";ut.additionalEvent=this.options.event+xt}this._super.emit.call(this,ut)}});function Wo(){tn.apply(this,arguments),this._timer=null,this._input=null}V(Wo,tn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[$r]},process:function(ut){var xt=this.options,kt=ut.pointers.length===xt.pointers,ae=ut.distance<xt.threshold,Fe=ut.deltaTime>xt.time;if(this._input=ut,!ae||!kt||ut.eventType&(Zt|Be)&&!Fe)this.reset();else if(ut.eventType&Vt)this.reset(),this._timer=w(function(){this.state=yn,this.tryEmit()},xt.time,this);else if(ut.eventType&Zt)return yn;return bn},reset:function(){clearTimeout(this._timer)},emit:function(ut){this.state===yn&&(ut&&ut.eventType&Zt?this.manager.emit(this.options.event+"up",ut):(this._input.timeStamp=_(),this.manager.emit(this.options.event,this._input)))}});function Pi(){hn.apply(this,arguments)}V(Pi,hn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[vr]},attrTest:function(ut){return this._super.attrTest.call(this,ut)&&(Math.abs(ut.rotation)>this.options.threshold||this.state&Lr)}});function $a(){hn.apply(this,arguments)}V($a,hn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:st|pr,pointers:1},getTouchAction:function(){return Li.prototype.getTouchAction.call(this)},attrTest:function(ut){var xt=this.options.direction,kt;return xt&(st|pr)?kt=ut.overallVelocity:xt&st?kt=ut.overallVelocityX:xt&pr&&(kt=ut.overallVelocityY),this._super.attrTest.call(this,ut)&&xt&ut.offsetDirection&&ut.distance>this.options.threshold&&ut.maxPointers==this.options.pointers&&f(kt)>this.options.velocity&&ut.eventType&Zt},emit:function(ut){var xt=ws(ut.offsetDirection);xt&&this.manager.emit(this.options.event+xt,ut),this.manager.emit(this.options.event,ut)}});function qn(){tn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}V(qn,tn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Xr]},process:function(ut){var xt=this.options,kt=ut.pointers.length===xt.pointers,ae=ut.distance<xt.threshold,Fe=ut.deltaTime<xt.time;if(this.reset(),ut.eventType&Vt&&this.count===0)return this.failTimeout();if(ae&&Fe&&kt){if(ut.eventType!=Zt)return this.failTimeout();var Xe=this.pTime?ut.timeStamp-this.pTime<xt.interval:!0,zr=!this.pCenter||De(this.pCenter,ut.center)<xt.posThreshold;this.pTime=ut.timeStamp,this.pCenter=ut.center,!zr||!Xe?this.count=1:this.count+=1,this._input=ut;var Xn=this.count%xt.taps;if(Xn===0)return this.hasRequireFailures()?(this._timer=w(function(){this.state=yn,this.tryEmit()},xt.interval,this),Lr):yn}return bn},failTimeout:function(){return this._timer=w(function(){this.state=bn},this.options.interval,this),bn},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==yn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function xs(ut,xt){return xt=xt||{},xt.recognizers=ct(xt.recognizers,xs.defaults.preset),new Bs(ut,xt)}xs.VERSION="2.0.7",xs.defaults={domEvents:!1,touchAction:xr,enable:!0,inputTarget:null,inputClass:null,preset:[[Pi,{enable:!1}],[On,{enable:!1},["rotate"]],[$a,{direction:st}],[Li,{direction:st},["swipe"]],[qn],[qn,{event:"doubletap",taps:2},["tap"]],[Wo]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Mi=1,Qs=2;function Bs(ut,xt){this.options=R({},xs.defaults,xt||{}),this.options.inputTarget=this.options.inputTarget||ut,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ut,this.input=Oe(this),this.touchAction=new Mt(this,this.options.touchAction),un(this,!0),B(this.options.recognizers,function(kt){var ae=this.add(new kt[0](kt[1]));kt[2]&&ae.recognizeWith(kt[2]),kt[3]&&ae.requireFailure(kt[3])},this)}Bs.prototype={set:function(ut){return R(this.options,ut),ut.touchAction&&this.touchAction.update(),ut.inputTarget&&(this.input.destroy(),this.input.target=ut.inputTarget,this.input.init()),this},stop:function(ut){this.session.stopped=ut?Qs:Mi},recognize:function(ut){var xt=this.session;if(!xt.stopped){this.touchAction.preventDefaults(ut);var kt,ae=this.recognizers,Fe=xt.curRecognizer;(!Fe||Fe&&Fe.state&yn)&&(Fe=xt.curRecognizer=null);for(var Xe=0;Xe<ae.length;)kt=ae[Xe],xt.stopped!==Qs&&(!Fe||kt==Fe||kt.canRecognizeWith(Fe))?kt.recognize(ut):kt.reset(),!Fe&&kt.state&(Lr|Pn|qr)&&(Fe=xt.curRecognizer=kt),Xe++}},get:function(ut){if(ut instanceof tn)return ut;for(var xt=this.recognizers,kt=0;kt<xt.length;kt++)if(xt[kt].options.event==ut)return xt[kt];return null},add:function(ut){if(x(ut,"add",this))return this;var xt=this.get(ut.options.event);return xt&&this.remove(xt),this.recognizers.push(ut),ut.manager=this,this.touchAction.update(),ut},remove:function(ut){if(x(ut,"remove",this))return this;if(ut=this.get(ut),ut){var xt=this.recognizers,kt=ot(xt,ut);kt!==-1&&(xt.splice(kt,1),this.touchAction.update())}return this},on:function(ut,xt){if(ut!==i&&xt!==i){var kt=this.handlers;return B(St(ut),function(ae){kt[ae]=kt[ae]||[],kt[ae].push(xt)}),this}},off:function(ut,xt){if(ut!==i){var kt=this.handlers;return B(St(ut),function(ae){xt?kt[ae]&&kt[ae].splice(ot(kt[ae],xt),1):delete kt[ae]}),this}},emit:function(ut,xt){this.options.domEvents&&Cl(ut,xt);var kt=this.handlers[ut]&&this.handlers[ut].slice();if(!(!kt||!kt.length)){xt.type=ut,xt.preventDefault=function(){xt.srcEvent.preventDefault()};for(var ae=0;ae<kt.length;)kt[ae](xt),ae++}},destroy:function(){this.element&&un(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function un(ut,xt){var kt=ut.element;if(kt.style){var ae;B(ut.options.cssProps,function(Fe,Xe){ae=vt(kt.style,Xe),xt?(ut.oldCssProps[ae]=kt.style[ae],kt.style[ae]=Fe):kt.style[ae]=ut.oldCssProps[ae]||""}),xt||(ut.oldCssProps={})}}function Cl(ut,xt){var kt=e.createEvent("Event");kt.initEvent(ut,!0,!0),kt.gesture=xt,xt.target.dispatchEvent(kt)}R(xs,{INPUT_START:Vt,INPUT_MOVE:re,INPUT_END:Zt,INPUT_CANCEL:Be,STATE_POSSIBLE:or,STATE_BEGAN:Lr,STATE_CHANGED:Pn,STATE_ENDED:qr,STATE_RECOGNIZED:yn,STATE_CANCELLED:mi,STATE_FAILED:bn,DIRECTION_NONE:Ie,DIRECTION_LEFT:ke,DIRECTION_RIGHT:He,DIRECTION_UP:Ke,DIRECTION_DOWN:le,DIRECTION_HORIZONTAL:st,DIRECTION_VERTICAL:pr,DIRECTION_ALL:Ye,Manager:Bs,Input:Le,TouchAction:Mt,TouchInput:Pt,MouseInput:ze,PointerEventInput:Ct,TouchMouseInput:we,SingleTouchInput:Bt,Recognizer:tn,AttrRecognizer:hn,Tap:qn,Pan:Li,Swipe:$a,Pinch:On,Rotate:Pi,Press:Wo,on:dt,off:gt,each:B,merge:Q,extend:N,assign:R,inherit:V,bindFn:W,prefixed:vt});var mc=typeof t<"u"?t:typeof self<"u"?self:{};mc.Hammer=xs,r.exports?r.exports=xs:t[n]=xs})(window,document,"Hammer")})(ZI);var Ig=ZI.exports;const kc=Hp({__proto__:null,default:Vp(Ig)},[Ig]),t3=1,e3=2,fw=4,GK={mousedown:t3,mousemove:e3,mouseup:fw};function jK(r,t){for(let e=0;e<r.length;e++)if(t(r[e]))return!0;return!1}function qK(r){const t=r.prototype.handler;r.prototype.handler=function(n){const i=this.store;n.button>0&&n.type==="pointerdown"&&(jK(i,s=>s.pointerId===n.pointerId)||i.push(n)),t.call(this,n)}}function KK(r){r.prototype.handler=function(e){let n=GK[e.type];n&t3&&e.button>=0&&(this.pressed=!0),n&e3&&e.which===0&&(n=fw),this.pressed&&(n&fw&&(this.pressed=!1),this.callback(this.manager,n,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}}qK(Ig.PointerEventInput),KK(Ig.MouseInput);const $K=Ig.Manager;class cy{constructor(t,e,n){this.element=t,this.callback=e,this.options={enable:!0,...n}}}const WK=kc?[[kc.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[kc.Rotate,{enable:!1}],[kc.Pinch,{enable:!1}],[kc.Swipe,{enable:!1}],[kc.Pan,{threshold:0,enable:!1}],[kc.Press,{enable:!1}],[kc.Tap,{event:"doubletap",taps:2,enable:!1}],[kc.Tap,{event:"anytap",enable:!1}],[kc.Tap,{enable:!1}]]:null,r3={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},XK={doubletap:["tap"]},JK={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},pw={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},YK={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},n3={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},ZK=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",gf=typeof window<"u"?window:global;let gw=!1;try{const r={get passive(){return gw=!0,!0}};gf.addEventListener("test",null,r),gf.removeEventListener("test",null)}catch{gw=!1}const t$=ZK.indexOf("firefox")!==-1,{WHEEL_EVENTS:e$}=pw,i3="wheel",s3=4.000244140625,r$=40,n$=.25;class i$ extends cy{constructor(t,e,n){super(t,e,n),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;gf.WheelEvent&&(t$&&i.deltaMode===gf.WheelEvent.DOM_DELTA_PIXEL&&(s/=gf.devicePixelRatio),i.deltaMode===gf.WheelEvent.DOM_DELTA_LINE&&(s*=r$)),s!==0&&s%s3===0&&(s=Math.floor(s/s3)),i.shiftKey&&s&&(s=s*n$),this.callback({type:i3,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(e$),this.events.forEach(i=>t.addEventListener(i,this.handleEvent,gw?{passive:!1}:!1))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===i3&&(this.options.enable=e)}}const{MOUSE_EVENTS:s$}=pw,o3="pointermove",a3="pointerover",l3="pointerout",c3="pointerenter",u3="pointerleave";class o$ extends cy{constructor(t,e,n){super(t,e,n),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(s$),this.events.forEach(s=>t.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===o3&&(this.enableMoveEvent=e),t===a3&&(this.enableOverEvent=e),t===l3&&(this.enableOutEvent=e),t===c3&&(this.enableEnterEvent=e),t===u3&&(this.enableLeaveEvent=e)}handleOverEvent(t){this.enableOverEvent&&t.type==="mouseover"&&this._emit(a3,t)}handleOutEvent(t){this.enableOutEvent&&t.type==="mouseout"&&this._emit(l3,t)}handleEnterEvent(t){this.enableEnterEvent&&t.type==="mouseenter"&&this._emit(c3,t)}handleLeaveEvent(t){this.enableLeaveEvent&&t.type==="mouseleave"&&this._emit(u3,t)}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":t.which===0&&(this.pressed=!1),this.pressed||this._emit(o3,t);break;case"mouseup":this.pressed=!1;break}}_emit(t,e){this.callback({type:t,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const{KEY_EVENTS:a$}=pw,A3="keydown",h3="keyup";class l$ extends cy{constructor(t,e,n){super(t,e,n),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:A3,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:h3,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(a$),t.tabIndex=this.options.tabIndex||0,t.style.outline="none",this.events.forEach(i=>t.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===A3&&(this.enableDownEvent=e),t===h3&&(this.enableUpEvent=e)}}const d3="contextmenu";class c$ extends cy{constructor(t,e,n){super(t,e,n),this.handleEvent=i=>{this.options.enable&&this.callback({type:d3,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===d3&&(this.options.enable=e)}}const mw=1,uy=2,yw=4,u$={pointerdown:mw,pointermove:uy,pointerup:yw,mousedown:mw,mousemove:uy,mouseup:yw},A$=1,h$=2,d$=3,f$=0,p$=1,g$=2,m$=1,y$=2,_$=4;function v$(r){const t=u$[r.srcEvent.type];if(!t)return null;const{buttons:e,button:n,which:i}=r.srcEvent;let s=!1,a=!1,o=!1;return t===yw||t===uy&&!Number.isFinite(e)?(s=i===A$,a=i===h$,o=i===d$):t===uy?(s=!!(e&m$),a=!!(e&_$),o=!!(e&y$)):t===mw&&(s=n===f$,a=n===p$,o=n===g$),{leftButton:s,middleButton:a,rightButton:o}}function b$(r,t){const e=r.center;if(!e)return null;const n=t.getBoundingClientRect(),i=n.width/t.offsetWidth||1,s=n.height/t.offsetHeight||1,a={x:(e.x-n.left-t.clientLeft)/i,y:(e.y-n.top-t.clientTop)/s};return{center:e,offsetCenter:a}}const _w={srcElement:"root",priority:0};class w${constructor(t){this.handleEvent=e=>{if(this.isEmpty())return;const n=this._normalizeEvent(e);let i=e.srcEvent.target;for(;i&&i!==n.rootElement;){if(this._emit(n,i),n.handled)return;i=i.parentNode}this._emit(n,"root")},this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;const{handlers:a,handlersByElement:o}=this;let d=_w;typeof n=="string"||n&&n.addEventListener?d={..._w,srcElement:n}:n&&(d={..._w,...n});let f=o.get(d.srcElement);f||(f=[],o.set(d.srcElement,f));const _={type:t,handler:e,srcElement:d.srcElement,priority:d.priority};i&&(_.once=!0),s&&(_.passive=!0),a.push(_),this._active=this._active||!_.passive;let w=f.length-1;for(;w>=0&&!(f[w].priority>=_.priority);)w--;f.splice(w+1,0,_)}remove(t,e){const{handlers:n,handlersByElement:i}=this;for(let s=n.length-1;s>=0;s--){const a=n[s];if(a.type===t&&a.handler===e){n.splice(s,1);const o=i.get(a.srcElement);o.splice(o.indexOf(a),1),o.length===0&&i.delete(a.srcElement)}}this._active=n.some(s=>!s.passive)}_emit(t,e){const n=this.handlersByElement.get(e);if(n){let i=!1;const s=()=>{t.handled=!0},a=()=>{t.handled=!0,i=!0},o=[];for(let d=0;d<n.length;d++){const{type:f,handler:_,once:w}=n[d];if(_({...t,type:f,stopPropagation:s,stopImmediatePropagation:a}),w&&o.push(n[d]),i)break}for(let d=0;d<o.length;d++){const{type:f,handler:_}=o[d];this.remove(f,_)}}}_normalizeEvent(t){const e=this.eventManager.getElement();return{...t,...v$(t),...b$(t,e),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:e}}}const x$={events:null,recognizers:null,recognizerOptions:{},Manager:$K,touchAction:"none",tabIndex:0};class B${constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0;this._onBasicInput=i=>{const{srcEvent:s}=i,a=JK[s.type];a&&this.manager.emit(a,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...x$,...e},this.events=new Map,this.setElement(t);const{events:n}=this.options;n&&this.on(n)}getElement(){return this.element}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this,n=e.Manager;this.manager=new n(t,{touchAction:e.touchAction,recognizers:e.recognizers||WK}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys(r3).forEach(i=>{const s=this.manager.get(i);s&&r3[i].forEach(a=>{s.recognizeWith(a)})});for(const i in e.recognizerOptions){const s=this.manager.get(i);if(s){const a=e.recognizerOptions[i];delete a.enable,s.set(a)}}this.wheelInput=new i$(t,this._onOtherEvent,{enable:!1}),this.moveInput=new o$(t,this._onOtherEvent,{enable:!1}),this.keyInput=new l$(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new c$(t,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,n){this._addEventHandler(t,e,n,!1)}once(t,e,n){this._addEventHandler(t,e,n,!0)}watch(t,e,n){this._addEventHandler(t,e,n,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:n}=this;if(!n)return;const i=n.get(t);if(i&&i.options.enable!==e){i.set({enable:e});const s=XK[t];s&&!this.options.recognizers&&s.forEach(a=>{const o=n.get(a);e?(o.requireFailure(t),i.dropRequireFailure(a)):o.dropRequireFailure(t)})}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,n,i,s){if(typeof t!="string"){n=e;for(const _ in t)this._addEventHandler(_,t[_],n,i,s);return}const{manager:a,events:o}=this,d=n3[t]||t;let f=o.get(d);f||(f=new w$(this),o.set(d,f),f.recognizerName=YK[d]||d,a&&a.on(d,f.handleEvent)),f.add(t,e,n,i,s),f.isEmpty()||this._toggleRecognizer(f.recognizerName,!0)}_removeEventHandler(t,e){if(typeof t!="string"){for(const a in t)this._removeEventHandler(a,t[a]);return}const{events:n}=this,i=n3[t]||t,s=n.get(i);if(s&&(s.remove(t,e),s.isEmpty())){const{recognizerName:a}=s;let o=!1;for(const d of n.values())if(d.recognizerName===a&&!d.isEmpty()){o=!0;break}o||this._toggleRecognizer(a,!1)}}}function jh(){}const f3={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:jh,onResize:jh,onViewStateChange:jh,onInteractionStateChange:jh,onBeforeRender:jh,onAfterRender:jh,onLoad:jh,onError:r=>Tn.error(r.message,r.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:r=>{let{isDragging:t}=r;return t?"grabbing":"grab"},getTooltip:null,debug:!1,drawPickingColors:!1};class vw{constructor(t){j(this,"props",void 0),j(this,"width",0),j(this,"height",0),j(this,"userData",{}),j(this,"canvas",null),j(this,"viewManager",null),j(this,"layerManager",null),j(this,"effectManager",null),j(this,"deckRenderer",null),j(this,"deckPicker",null),j(this,"eventManager",null),j(this,"tooltip",null),j(this,"metrics",void 0),j(this,"animationLoop",void 0),j(this,"stats",void 0),j(this,"viewState",void 0),j(this,"cursorState",void 0),j(this,"_needsRedraw",void 0),j(this,"_pickRequest",void 0),j(this,"_lastPointerDownInfo",null),j(this,"_metricsCounter",void 0),j(this,"_onPointerMove",e=>{const{_pickRequest:n}=this;if(e.type==="pointerleave")n.x=-1,n.y=-1,n.radius=0;else{if(e.leftButton||e.rightButton)return;{const i=e.offsetCenter;if(!i)return;n.x=i.x,n.y=i.y,n.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:n.x,y:n.y}),n.event=e}),j(this,"_onEvent",e=>{const n=RT[e.type],i=e.offsetCenter;if(!n||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),a=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=a,d=o&&(o[n.handler]||o.props[n.handler]),f=this.props[n.handler];let _=!1;d&&(_=d.call(o,a,e)),!_&&f&&f(a,e)}),j(this,"_onPointerDown",e=>{const n=e.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:n.x,y:n.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...f3,...t},t=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},t.viewState&&t.initialViewState&&Tn.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),cT()==="IE"&&Tn.warn("IE 11 is not supported")(),this.viewState=t.initialViewState,t.gl||typeof document<"u"&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new Yp({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&Cg.setOptions(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){var t,e,n,i,s,a,o,d;if((t=this.animationLoop)===null||t===void 0||t.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(e=this.layerManager)===null||e===void 0||e.finalize(),this.layerManager=null,(n=this.viewManager)===null||n===void 0||n.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(a=this.deckPicker)===null||a===void 0||a.finalize(),this.deckPicker=null,(o=this.eventManager)===null||o===void 0||o.destroy(),this.eventManager=null,(d=this.tooltip)===null||d===void 0||d.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var f;(f=this.canvas.parentElement)===null||f===void 0||f.removeChild(this.canvas),this.canvas=null}}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&Tn.removed("onLayerHover","onHover")(),"onLayerClick"in t&&Tn.removed("onLayerClick","onClick")(),t.initialViewState&&!Nc(this.props.initialViewState,t.initialViewState,3)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),i=this.layerManager.needsRedraw(t),s=this.effectManager.needsRedraw(t),a=this.deckRenderer.needsRedraw(t);return e=e||n||i||s||a,e}redraw(t){if(!this.layerManager)return;let e=this.needsRedraw({clearRedrawFlags:!0});e=t||e,e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}get isInitialized(){return this.viewManager!==null}getViews(){return Ws(this.viewManager),this.viewManager.views}getViewports(t){return Ws(this.viewManager),this.viewManager.getViewports(t)}getCanvas(){return this.canvas}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_addDefaultEffect(t){this.effectManager.addDefaultEffect(t)}_pick(t,e,n){Ws(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(e).timeStart();const s=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(e).timeEnd(),s}_createCanvas(t){let e=t.canvas;return typeof e=="string"&&(e=document.getElementById(e),Ws(e)),e||(e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay",(t.parent||document.body).appendChild(e)),Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;const{width:e,height:n}=t;if(e||e===0){const s=Number.isFinite(e)?"".concat(e,"px"):e;this.canvas.style.width=s}if(n||n===0){var i;const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.position=((i=t.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var t,e;const{canvas:n}=this;if(!n)return;const i=(t=n.clientWidth)!==null&&t!==void 0?t:n.width,s=(e=n.clientHeight)!==null&&e!==void 0?e:n.height;if(i!==this.width||s!==this.height){var a,o;this.width=i,this.height=s,(a=this.viewManager)===null||a===void 0||a.setProps({width:i,height:s}),(o=this.layerManager)===null||o===void 0||o.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:s})}}_createAnimationLoop(t){const{width:e,height:n,gl:i,glOptions:s,debug:a,onError:o,onBeforeRender:d,onAfterRender:f,useDevicePixels:_}=t;return new sV({width:e,height:n,useDevicePixels:_,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:w=>XT({...s,...w,canvas:this.canvas,debug:a,onContextLost:()=>this._onContextLost()}),onInitialize:w=>this._setGLContext(w.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:d,onAfterRender:f,onError:o})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new dw({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:n,emptyInfo:i}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=n.length>0;let s=i,a=!1;for(const o of n){var e;s=o,a=((e=o.layer)===null||e===void 0?void 0:e.onHover(o,t.event))||a}if(!a&&this.props.onHover&&this.props.onHover(s,t.event),this.props.getTooltip&&this.tooltip){const o=this.props.getTooltip(s);this.tooltip.setTooltip(o,s.x,s.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,hb(t,{enable:!0,copyState:!0})),this.tooltip=new VK(this.canvas),Nu(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new xI;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new B$(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in RT)this.eventManager.on(i,this._onEvent);this.viewManager=new pK({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new fK(t,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new PK,this.deckRenderer=new UK(t),this.deckPicker=new zK(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:n}=this.layerManager.context;Nu(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:n})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Tn.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.cursorState.isDragging=t.isDragging||!1,this.props.onInteractionStateChange(t)}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=Nh.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}j(vw,"defaultProps",f3),j(vw,"VERSION",AH);class bw{constructor(t,e){j(this,"opts",void 0),j(this,"source",void 0),this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:n}=this.source,{size:i}=e;let s=n;if(n&&n.length!==i){s=new Float32Array(i);const a=e.elementOffset||0;for(let o=0;o<i;++o)s[o]=n[a+o]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function C$(r){switch(r){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function Ay(r){return r.stride||r.size*r.bytesPerElement}function p3(r,t){t.offset&&Tn.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const e=Ay(r),n=t.vertexOffset!==void 0?t.vertexOffset:r.vertexOffset||0,i=t.elementOffset||0,s=n*e+i*r.bytesPerElement+(r.offset||0);return{...t,offset:s,stride:e}}function E$(r,t){const e=p3(r,t);return{high:e,low:{...e,offset:e.offset+r.size*4}}}class S${constructor(t,e,n){j(this,"gl",void 0),j(this,"id",void 0),j(this,"size",void 0),j(this,"settings",void 0),j(this,"value",void 0),j(this,"doublePrecision",void 0),j(this,"_buffer",void 0),j(this,"state",void 0),this.gl=t,this.id=e.id||"",this.size=e.size||1;const i=e.logicalType||e.type,s=i===5130;let{defaultValue:a}=e;a=Number.isFinite(a)?[a]:a||new Array(this.size).fill(0);let o;s?o=5126:!i&&e.isIndexed?o=t&&vb(t,fi.ELEMENT_INDEX_UINT32)?5125:5123:o=i||5126;let d=C$(i||o||5126);this.doublePrecision=s,s&&e.fp64===!1&&(d=Float32Array),this.value=null,this.settings={...e,defaultType:d,defaultValue:a,logicalType:i,type:o,size:this.size,bytesPerElement:d.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new ni(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*Ay(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Cg.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const n={},i=this.value instanceof Float64Array,s=E$(this.getAccessor(),e||{});return n[t]=new bw(this,s.high),n["".concat(t,"64Low")]=i?new bw(this,s.low):new Float32Array(this.size),n}if(e){const n=p3(this.getAccessor(),e);return{[t]:new bw(this,n)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant&&this.value){const e=Array.from(this.value);t=[e,e]}else{const{value:e,numInstances:n,size:i}=this,s=n*i;if(e&&s&&e.length>=s){const a=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let d=0;d<s;)for(let f=0;f<i;f++){const _=e[d++];_<a[f]&&(a[f]=_),_>o[f]&&(o[f]=_)}t=[a,o]}}return this.state.bounds=t,t}setData(t){const{state:e}=this;let n;ArrayBuffer.isView(t)?n={value:t}:t instanceof ni?n={buffer:t}:n=t;const i={...this.settings,...n};if(e.bufferAccessor=i,e.bounds=null,n.constant){let s=n.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!e.constant||!this._areValuesEqual(s,this.value)))return!1;e.externalBuffer=null,e.constant=!0,this.value=s}else if(n.buffer){const s=n.buffer;e.externalBuffer=s,e.constant=!1,this.value=n.value||null;const a=n.value instanceof Float64Array;i.type=n.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(a?2:1),i.stride=Ay(i)}else if(n.value){this._checkExternalBuffer(n);let s=n.value;e.externalBuffer=null,e.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=Ay(i);const{buffer:a,byteOffset:o}=this;this.doublePrecision&&s instanceof Float64Array&&(s=aw(s,i));const d=s.byteLength+o+i.stride*2;a.byteLength<d&&a.reallocate(d),a.setAccessor(null),a.subData({data:s,offset:o}),i.type=n.type||a.accessor.type}return!0}updateSubBuffer(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.state.bounds=null;const e=this.value,{startOffset:n=0,endOffset:i}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?aw(e,{size:this.size,startIndex:n,endIndex:i}):e.subarray(n,i),offset:n*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{state:n}=this,i=n.allocatedValue,s=Cg.allocate(i,t+1,{size:this.size,type:this.settings.defaultType,copy:e});this.value=s;const{buffer:a,byteOffset:o}=this;return a.byteLength<s.byteLength+o&&(a.reallocate(s.byteLength+o),e&&i&&a.subData({data:i instanceof Float64Array?aw(i,this):i,offset:o})),n.allocatedValue=s,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!ArrayBuffer.isView(e))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=e.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));!(e instanceof n)&&this.settings.normalized&&!("normalized"in t)&&Tn.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map(e=>(e+128)/255*2-1);case 5122:return new Float32Array(t).map(e=>(e+32768)/65535*2-1);case 5121:return new Float32Array(t).map(e=>e/255);case 5123:return new Float32Array(t).map(e=>e/65535);default:return t}}_normalizeValue(t,e,n){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t){let a=s;for(;--a>=0;)e[n+a]=i[a];return e}switch(s){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:i[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:i[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:i[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:i[0];break;default:let a=s;for(;--a>=0;)e[n+a]=Number.isFinite(t[a])?t[a]:i[a]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}}const g3=[],m3=[];function y3(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1/0,n=g3;const i={index:-1,data:r,target:[]};return r?typeof r[Symbol.iterator]=="function"?n=r:r.length>0&&(m3.length=r.length,n=m3):n=g3,(t>0||Number.isFinite(e))&&(n=(Array.isArray(n)?n:Array.from(n)).slice(t,e),i.index=t-1),{iterable:n,objectInfo:i}}function _3(r){return r&&r[Symbol.asyncIterator]}function T$(r,t){const{size:e,stride:n,offset:i,startIndices:s,nested:a}=t,o=r.BYTES_PER_ELEMENT,d=n?n/o:e,f=i?i/o:0,_=Math.floor((r.length-f)/d);return(w,x)=>{let{index:B,target:P}=x;if(!s){const V=B*d+f;for(let W=0;W<e;W++)P[W]=r[V+W];return P}const R=s[B],N=s[B+1]||_;let Q;if(a){Q=new Array(N-R);for(let V=R;V<N;V++){const W=V*d+f;P=new Array(e);for(let et=0;et<e;et++)P[et]=r[W+et];Q[V-R]=P}}else if(d===e)Q=r.subarray(R*e+f,N*e+f);else{Q=new r.constructor((N-R)*e);let V=0;for(let W=R;W<N;W++){const et=W*d+f;for(let ct=0;ct<e;ct++)Q[V++]=r[et+ct]}}return Q}}const I$=[],hy=[[0,1/0]];function F$(r,t){if(r===hy||(t[0]<0&&(t[0]=0),t[0]>=t[1]))return r;const e=[],n=r.length;let i=0;for(let s=0;s<n;s++){const a=r[s];a[1]<t[0]?(e.push(a),i=s+1):a[0]>t[1]?e.push(a):t=[Math.min(a[0],t[0]),Math.max(a[1],t[1])]}return e.splice(i,0,t),e}function ww(r){const{source:t,target:e,start:n=0,size:i,getData:s}=r,a=r.end||e.length,o=t.length,d=a-n;if(o>d){e.set(t.subarray(0,d),n);return}if(e.set(t,n),!s)return;let f=o;for(;f<d;){const _=s(f,t);for(let w=0;w<i;w++)e[n+f]=_[w]||0,f++}}function L$(r){let{source:t,target:e,size:n,getData:i,sourceStartIndices:s,targetStartIndices:a}=r;if(!Array.isArray(a))return ww({source:t,target:e,size:n,getData:i}),e;let o=0,d=0;const f=i&&((w,x)=>i(w+d,x)),_=Math.min(s.length,a.length);for(let w=1;w<_;w++){const x=s[w]*n,B=a[w]*n;ww({source:t.subarray(o,x),target:e,start:d,end:B,size:n,getData:f}),o=x,d=B}return d<e.length&&ww({source:[],target:e,start:d,size:n,getData:f}),e}const P$={interpolation:{duration:0,easing:r=>r},spring:{stiffness:.05,damping:.5}};function v3(r,t){if(!r)return null;Number.isFinite(r)&&(r={type:"interpolation",duration:r});const e=r.type||"interpolation";return{...P$[e],...t,...r,type:e}}function b3(r,t){const e=t.getBuffer();return e?[e,{divisor:0,size:t.size,normalized:t.settings.normalized}]:t.value}function w3(r){switch(r){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(r,'"'))}}function x3(r){r.push(r.shift())}function xw(r,t){const{doublePrecision:e,settings:n,value:i,size:s}=r,a=e&&i instanceof Float64Array?2:1;return(n.noAlloc?i.length:t*s)*a}function B3(r){let{buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:s,getData:a=V=>V}=r;const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,d=n.size*o,f=n.byteOffset,_=n.startIndices,w=s&&_,x=xw(n,e),B=n.isConstant;if(!w&&i>=x)return;const P=B?n.value:n.getBuffer().getData({srcByteOffset:f});if(n.settings.normalized&&!B){const V=a;a=(W,et)=>n.normalizeConstant(V(W,et))}const R=B?(V,W)=>a(P,W):(V,W)=>a(P.subarray(V,V+d),W),N=t.getData({length:i}),Q=new Float32Array(x);L$({source:N,target:Q,sourceStartIndices:s,targetStartIndices:_,size:d,getData:R}),t.byteLength<Q.byteLength+f&&t.reallocate(Q.byteLength+f),t.subData({data:Q,offset:f})}class Bw extends S${constructor(t,e){super(t,e,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:hy}),j(this,"constant",!1),this.settings.update=e.update||(e.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw(){let{clearChangedFlags:t=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat(typeof t!="function"&&t||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition,i=Array.isArray(e)?t[e.find(s=>t[s])]:t[e];return v3(i,n)}setNeedsUpdate(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.id,e=arguments.length>1?arguments[1]:void 0;if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:n=0,endRow:i=1/0}=e;this.state.updateRanges=F$(this.state.updateRanges,[n,i])}else this.state.updateRanges=hy}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=I$}setNeedsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.id;this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){const{state:e,settings:n}=this;return n.noAlloc?!1:n.update?(super.allocate(t,e.updateRanges!==hy),!0):!1}updateBuffer(t){let{numInstances:e,data:n,props:i,context:s}=t;if(!this.needsUpdate())return!1;const{state:{updateRanges:a},settings:{update:o,noAlloc:d}}=this;let f=!0;if(o){for(const[_,w]of a)o.call(s,this,{data:n,startRow:_,endRow:w,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[_,w]of a){const x=Number.isFinite(_)?this.getVertexOffset(_):0,B=Number.isFinite(w)?this.getVertexOffset(w):d||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:x,endOffset:B})}this._checkAttributeArray()}else f=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),f}setConstantValue(t){return t===void 0||typeof t=="function"?!1:(this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const{state:n,settings:i}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;if(n.binaryValue=t,this.setNeedsRedraw(),i.transform||e!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});const a=t;Ws(ArrayBuffer.isView(a.value),"invalid ".concat(i.accessor));const o=!!a.size&&a.size!==this.size;return n.binaryAccessor=T$(a.value,{size:a.size||this.size,stride:a.stride,offset:a.offset,startIndices:e,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?t<e.length?e[t]:this.numInstances:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const n in t)Object.assign(e,super.getShaderAttributes(n,t[n]));return e}_autoUpdater(t,e){let{data:n,startRow:i,endRow:s,props:a,numInstances:o}=e;if(t.constant)return;const{settings:d,state:f,value:_,size:w,startIndices:x}=t,{accessor:B,transform:P}=d,R=f.binaryAccessor||(typeof B=="function"?B:a[B]);Ws(typeof R=="function",'accessor "'.concat(B,'" is not a function'));let N=t.getVertexOffset(i);const{iterable:Q,objectInfo:V}=y3(n,i,s);for(const W of Q){V.index++;let et=R(W,V);if(P&&(et=P.call(this,et)),x){const ct=(V.index<x.length-1?x[V.index+1]:o)-x[V.index];if(et&&Array.isArray(et[0])){let dt=N;for(const gt of et)t._normalizeValue(gt,_,dt),dt+=w}else et&&et.length>w?_.set(et,N):(t._normalizeValue(et,V.target,0),oK({target:_,source:V.target,start:N,count:ct}));N+=ct*w}else t._normalizeValue(et,_,N),N+=w}}_validateAttributeUpdaters(){const{settings:t}=this;if(!(t.noAlloc||typeof t.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class M${constructor(t){let{gl:e,attribute:n,timeline:i}=t;j(this,"gl",void 0),j(this,"type","interpolation"),j(this,"attributeInTransition",void 0),j(this,"settings",void 0),j(this,"attribute",void 0),j(this,"transition",void 0),j(this,"currentStartIndices",void 0),j(this,"currentLength",void 0),j(this,"transform",void 0),j(this,"buffers",void 0),this.gl=e,this.transition=new Tg(i),this.attribute=n,this.attributeInTransition=new Bw(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=U$(e,n);const s={byteLength:0,usage:35050};this.buffers=[new ni(e,s),new ni(e,s)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0){this.transition.cancel();return}this.settings=t;const{gl:n,buffers:i,attribute:s}=this;x3(i);const a={numInstances:e,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const o of i)B3({buffer:o,...a});this.currentStartIndices=s.startIndices,this.currentLength=xw(s,e),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:b3(n,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const t=this.transition.update();if(t){const{duration:e,easing:n}=this.settings,{time:i}=this.transition;let s=i/e;n&&(s=n(s)),this.transform.run({uniforms:{time:s}})}return t}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0}}const R$=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function U$(r,t){const e=w3(t.size);return new Jb(r,{vs:R$,defines:{ATTRIBUTE_TYPE:e},varyings:["vCurrent"]})}class O${constructor(t){let{gl:e,attribute:n,timeline:i}=t;j(this,"gl",void 0),j(this,"type","spring"),j(this,"attributeInTransition",void 0),j(this,"settings",void 0),j(this,"attribute",void 0),j(this,"transition",void 0),j(this,"currentStartIndices",void 0),j(this,"currentLength",void 0),j(this,"texture",void 0),j(this,"framebuffer",void 0),j(this,"transform",void 0),j(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Tg(i),this.attribute=n,this.attributeInTransition=new Bw(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=N$(e),this.framebuffer=k$(e,this.texture),this.transform=D$(e,n,this.framebuffer);const s={byteLength:0,usage:35050};this.buffers=[new ni(e,s),new ni(e,s),new ni(e,s)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:n,buffers:i,attribute:s}=this,a={numInstances:e,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const o of i)B3({buffer:o,...a});this.settings=t,this.currentStartIndices=s.startIndices,this.currentLength=xw(s,e),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...t,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:b3(n,s)}})}update(){const{buffers:t,transform:e,framebuffer:n,transition:i}=this;if(!i.update())return!1;const a=this.settings;return e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:a.stiffness,damping:a.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),x3(t),this.attributeInTransition.setData({buffer:t[1],value:this.attribute.value}),U0(n)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function D$(r,t,e){const n=w3(t.size);return new Jb(r,{framebuffer:e,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:n},varyings:["vNext"]})}function N$(r){return new Ua(r,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function k$(r,t){return new ys(r,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:t}})}const Q$={interpolation:M$,spring:O$};class z${constructor(t,e){let{id:n,timeline:i}=e;j(this,"id",void 0),j(this,"isSupported",void 0),j(this,"gl",void 0),j(this,"timeline",void 0),j(this,"transitions",void 0),j(this,"needsRedraw",void 0),j(this,"numInstances",void 0),this.id=n,this.gl=t,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=Jb.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update(t){let{attributes:e,transitions:n,numInstances:i}=t;this.numInstances=i||1;for(const s in e){const a=e[s],o=a.getTransitionSetting(n);o&&this._updateAttribute(s,a,o)}for(const s in this.transitions){const a=e[s];(!a||!a.getTransitionSetting(n))&&this._removeTransition(s)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const e in this.transitions)this.transitions[e].update()&&(this.needsRedraw=!0);const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,n){const i=this.transitions[t];let s=!i||i.type!==n.type;if(s){if(!this.isSupported){Tn.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();return}i&&this._removeTransition(t);const a=Q$[n.type];a?this.transitions[t]=new a({attribute:e,timeline:this.timeline,gl:this.gl}):(Tn.error("unsupported transition type '".concat(n.type,"'"))(),s=!1)}(s||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}const C3="attributeManager.invalidate",H$="attributeManager.updateStart",V$="attributeManager.updateEnd",G$="attribute.updateStart",j$="attribute.allocate",q$="attribute.updateEnd";class K${constructor(t){let{id:e="attribute-manager",stats:n,timeline:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};j(this,"id",void 0),j(this,"gl",void 0),j(this,"attributes",void 0),j(this,"updateTriggers",void 0),j(this,"needsRedraw",void 0),j(this,"userData",void 0),j(this,"stats",void 0),j(this,"attributeTransitionManager",void 0),j(this,"mergeBoundsMemoized",xg(Jq)),this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new z$(t,{id:"".concat(e,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{instanced:1})}remove(t){for(const e of t)this.attributes[e]!==void 0&&(this.attributes[e].delete(),delete this.attributes[e])}invalidate(t,e){const n=this._invalidateTrigger(t,e);Ao(C3,this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);Ao(C3,this,"all")}update(t){let{data:e,numInstances:n,startIndices:i=null,transitions:s,props:a={},buffers:o={},context:d={}}=t,f=!1;Ao(H$,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const _ in this.attributes){const w=this.attributes[_],x=w.settings.accessor;w.startIndices=i,w.numInstances=n,a[_]&&Tn.removed("props.".concat(_),"data.attributes.".concat(_))(),w.setExternalBuffer(o[_])||w.setBinaryValue(typeof x=="string"?o[x]:void 0,e.startIndices)||typeof x=="string"&&!o[x]&&w.setConstantValue(a[x])||w.needsUpdate()&&(f=!0,this._updateAttribute({attribute:w,numInstances:n,data:e,props:a,context:d})),this.needsRedraw=this.needsRedraw||w.needsRedraw()}f&&Ao(V$,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:s})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getBounds(t){const e=t.map(n=>{var i;return(i=this.attributes[n])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(e)}getChangedAttributes(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearChangedFlags:!1};const{attributes:e,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const s in e){const a=e[s];a.needsRedraw(t)&&!n.hasAttribute(s)&&(i[s]=a)}return i}getShaderAttributes(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t||(t=this.getAttributes());const n={};for(const i in t)e[i]||Object.assign(n,t[i].getShaderAttributes());return n}_add(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};for(const n in t){const i=t[n];this.attributes[n]=this._createAttribute(n,i,e)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const i={...e,id:t,size:e.isIndexed&&1||e.size||1,divisor:n.instanced?1:e.divisor||0};return new Bw(this.gl,i)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes)this.attributes[e].getUpdateTriggers().forEach(i=>{t[i]||(t[i]=[]),t[i].push(e)});this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:i}=this,s=i[t];return s&&s.forEach(a=>{const o=n[a];o&&o.setNeedsUpdate(o.id,e)}),s}_updateAttribute(t){const{attribute:e,numInstances:n}=t;if(Ao(G$,e),e.constant){e.setConstantValue(e.value);return}e.allocate(n)&&Ao(j$,e,n),e.updateBuffer(t)&&(this.needsRedraw=!0,Ao(q$,e,n))}}class $$ extends Tg{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:i,easing:s}}=this,a=s(t/i);this._value=j0(e,n,a)}}const E3=1e-5;function S3(r,t,e,n,i){const s=t-r,o=(e-t)*i,d=-s*n;return o+d+s+t}function W$(r,t,e,n,i){if(Array.isArray(e)){const s=[];for(let a=0;a<e.length;a++)s[a]=S3(r[a],t[a],e[a],n,i);return s}return S3(r,t,e,n,i)}function T3(r,t){if(Array.isArray(r)){let e=0;for(let n=0;n<r.length;n++){const i=r[n]-t[n];e+=i*i}return Math.sqrt(e)}return Math.abs(r-t)}class X$ extends Tg{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:i}=this.settings,{_prevValue:s=t,_currValue:a=t}=this;let o=W$(s,a,e,n,i);const d=T3(o,e),f=T3(o,a);d<E3&&f<E3&&(o=e,this.end()),this._prevValue=a,this._currValue=o}}const J$={interpolation:$$,spring:X$};class Y${constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,i){const{transitions:s}=this;if(s.has(t)){const d=s.get(t),{value:f=d.settings.fromValue}=d;e=f,this.remove(t)}if(i=v3(i),!i)return;const a=J$[i.type];if(!a){Tn.error("unsupported transition type '".concat(i.type,"'"))();return}const o=new a(this.timeline);o.start({...i,fromValue:e,toValue:n}),s.set(t,o)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}function Z$(r){const t=r[zA];for(const e in t){const n=t[e],{validate:i}=n;if(i&&!i(r[e],n))throw new Error("Invalid prop ".concat(e,": ").concat(r[e]))}}function tW(r,t){const e=I3({newProps:r,oldProps:t,propTypes:r[zA],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),n=rW(r,t);let i=!1;return n||(i=nW(r,t)),{dataChanged:n,propsChanged:e,updateTriggersChanged:i,extensionsChanged:iW(r,t),transitionsChanged:eW(r,t)}}function eW(r,t){if(!r.transitions)return!1;const e={},n=r[zA];let i=!1;for(const s in r.transitions){const a=n[s],o=a&&a.type;(o==="number"||o==="color"||o==="array")&&Cw(r[s],t[s],a)&&(e[s]=!0,i=!0)}return i?e:!1}function I3(r){let{newProps:t,oldProps:e,ignoreProps:n={},propTypes:i={},triggerName:s="props"}=r;if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(s," changed shallowly");for(const a of Object.keys(t))if(!(a in n)){if(!(a in e))return"".concat(s,".").concat(a," added");const o=Cw(t[a],e[a],i[a]);if(o)return"".concat(s,".").concat(a," ").concat(o)}for(const a of Object.keys(e))if(!(a in n)){if(!(a in t))return"".concat(s,".").concat(a," dropped");if(!Object.hasOwnProperty.call(t,a)){const o=Cw(t[a],e[a],i[a]);if(o)return"".concat(s,".").concat(a," ").concat(o)}}return!1}function Cw(r,t,e){let n=e&&e.equal;return n&&!n(r,t,e)||!n&&(n=r&&t&&r.equals,n&&!n.call(r,t))?"changed deeply":!n&&t!==r?"changed shallowly":null}function rW(r,t){if(t===null)return"oldProps is null, initial diff";let e=!1;const{dataComparator:n,_dataDiff:i}=r;return n?n(r.data,t.data)||(e="Data comparator detected a change"):r.data!==t.data&&(e="A new data container was supplied"),e&&i&&(e=i(r.data,t.data)||e),e}function nW(r,t){if(t===null)return{all:!0};if("all"in r.updateTriggers&&F3(r,t,"all"))return{all:!0};const e={};let n=!1;for(const i in r.updateTriggers)i!=="all"&&F3(r,t,i)&&(e[i]=!0,n=!0);return n?e:!1}function iW(r,t){if(t===null)return!0;const e=t.extensions,{extensions:n}=r;if(n===e)return!1;if(!e||!n||n.length!==e.length)return!0;for(let i=0;i<n.length;i++)if(!n[i].equals(e[i]))return!0;return!1}function F3(r,t,e){let n=r.updateTriggers[e];n=n??{};let i=t.updateTriggers[e];return i=i??{},I3({oldProps:i,newProps:n,triggerName:e})}const sW="count(): argument not an object",oW="count(): argument not a container";function aW(r){if(!cW(r))throw new Error(sW);if(typeof r.count=="function")return r.count();if(Number.isFinite(r.size))return r.size;if(Number.isFinite(r.length))return r.length;if(lW(r))return Object.keys(r).length;throw new Error(oW)}function lW(r){return r!==null&&typeof r=="object"&&r.constructor===Object}function cW(r){return r!==null&&typeof r=="object"}function uW(r,t){if(!t)return r;const e={...r,...t};if("defines"in t&&(e.defines={...r.defines,...t.defines}),"modules"in t&&(e.modules=(r.modules||[]).concat(t.modules),t.modules.some(n=>n.name==="project64"))){const n=e.modules.findIndex(i=>i.name==="project32");n>=0&&e.modules.splice(n,1)}if("inject"in t)if(!r.inject)e.inject=t.inject;else{const n={...r.inject};for(const i in t.inject)n[i]=(n[i]||"")+t.inject[i];e.inject=n}return e}const AW={10241:9987,10240:9729,10242:33071,10243:33071},Ew={};function hW(r,t,e,n){if(e instanceof Ua)return e;e.constructor&&e.constructor.name!=="Object"&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const s=new Ua(t,{...e,parameters:{...AW,...i,...n}});return Ew[s.id]=r,s}function dW(r,t){!t||!(t instanceof Ua)||Ew[t.id]===r&&(t.delete(),delete Ew[t.id])}const fW={boolean:{validate(r,t){return!0},equal(r,t,e){return!!r==!!t}},number:{validate(r,t){return Number.isFinite(r)&&(!("max"in t)||r<=t.max)&&(!("min"in t)||r>=t.min)}},color:{validate(r,t){return t.optional&&!r||Sw(r)&&(r.length===3||r.length===4)},equal(r,t,e){return Nc(r,t,1)}},accessor:{validate(r,t){const e=dy(r);return e==="function"||e===dy(t.value)},equal(r,t,e){return typeof t=="function"?!0:Nc(r,t,1)}},array:{validate(r,t){return t.optional&&!r||Sw(r)},equal(r,t,e){const{compare:n}=e,i=Number.isInteger(n)?n:n?1:0;return n?Nc(r,t,i):r===t}},object:{equal(r,t,e){if(e.ignore)return!0;const{compare:n}=e,i=Number.isInteger(n)?n:n?1:0;return n?Nc(r,t,i):r===t}},function:{validate(r,t){return t.optional&&!r||typeof r=="function"},equal(r,t,e){return!e.compare&&e.ignore!==!1||r===t}},data:{transform:(r,t,e)=>{const{dataTransform:n}=e.props;return n&&r?n(r):r}},image:{transform:(r,t,e)=>{const n=e.context;return!n||!n.gl?null:hW(e.id,n.gl,r,{...t.parameters,...e.props.textureParameters})},release:(r,t,e)=>{dW(e.id,r)}}};function pW(r){const t={},e={},n={};for(const[i,s]of Object.entries(r)){const a=s==null?void 0:s.deprecatedFor;if(a)n[i]=Array.isArray(a)?a:[a];else{const o=gW(i,s);t[i]=o,e[i]=o.value}}return{propTypes:t,defaultProps:e,deprecatedProps:n}}function gW(r,t){switch(dy(t)){case"object":return Fg(r,t);case"array":return Fg(r,{type:"array",value:t,compare:!1});case"boolean":return Fg(r,{type:"boolean",value:t});case"number":return Fg(r,{type:"number",value:t});case"function":return Fg(r,{type:"function",value:t,compare:!0});default:return{name:r,type:"unknown",value:t}}}function Fg(r,t){return"type"in t?{name:r,...fW[t.type],...t}:"value"in t?{name:r,type:dy(t.value),...t}:{name:r,type:"object",value:t}}function Sw(r){return Array.isArray(r)||ArrayBuffer.isView(r)}function dy(r){return Sw(r)?"array":r===null?"null":typeof r}function mW(r,t){let e;for(let s=t.length-1;s>=0;s--){const a=t[s];"extensions"in a&&(e=a.extensions)}const n=Tw(r.constructor,e),i=Object.create(n);i[oy]=r,i[Vh]={},i[HA]={};for(let s=0;s<t.length;++s){const a=t[s];for(const o in a)i[o]=a[o]}return Object.freeze(i),i}const yW="_mergedDefaultProps";function Tw(r,t){let e=yW;if(t)for(const i of t){const s=i.constructor;s&&(e+=":".concat(s.extensionName||s.name))}const n=L3(r,e);return n||(r[e]=_W(r,t||[]))}function _W(r,t){if(!r.prototype)return null;const n=Object.getPrototypeOf(r),i=Tw(n),s=L3(r,"defaultProps")||{},a=pW(s),o=Object.assign(Object.create(null),i,a.defaultProps),d=Object.assign(Object.create(null),i==null?void 0:i[zA],a.propTypes),f=Object.assign(Object.create(null),i==null?void 0:i[cw],a.deprecatedProps);for(const _ of t){const w=Tw(_.constructor);w&&(Object.assign(o,w),Object.assign(d,w[zA]),Object.assign(f,w[cw]))}return vW(o,r),wW(o,d),bW(o,f),o[zA]=d,o[cw]=f,t.length===0&&!Iw(r,"_propTypes")&&(r._propTypes=d),o}function vW(r,t){const e=BW(t);Object.defineProperties(r,{id:{writable:!0,value:e}})}function bW(r,t){for(const e in t)Object.defineProperty(r,e,{enumerable:!1,set(n){const i="".concat(this.id,": ").concat(e);for(const s of t[e])Iw(this,s)||(this[s]=n);Tn.deprecated(i,t[e].join("/"))()}})}function wW(r,t){const e={},n={};for(const i in t){const s=t[i],{name:a,value:o}=s;s.async&&(e[a]=o,n[a]=xW(a))}r[ff]=e,r[Vh]={},Object.defineProperties(r,n)}function xW(r){return{enumerable:!0,set(t){typeof t=="string"||t instanceof Promise||_3(t)?this[Vh][r]=t:this[HA][r]=t},get(){if(this[HA]){if(r in this[HA])return this[HA][r]||this[ff][r];if(r in this[Vh]){const t=this[oy]&&this[oy].internalState;if(t&&t.hasAsyncProp(r))return t.getAsyncProp(r)||this[ff][r]}}return this[ff][r]}}}function Iw(r,t){return Object.prototype.hasOwnProperty.call(r,t)}function L3(r,t){return Iw(r,t)&&r[t]}function BW(r){const t=r.componentName;return t||Tn.warn("".concat(r.name,".componentName not specified"))(),t||r.name}let CW=0;class Fw{constructor(){j(this,"id",void 0),j(this,"props",void 0),j(this,"count",void 0);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.props=mW(this,e),this.id=this.props.id,this.count=CW++}clone(t){const{props:e}=this,n={};for(const i in e[ff])i in e[HA]?n[i]=e[HA][i]:i in e[Vh]&&(n[i]=e[Vh][i]);return new this.constructor({...e,...n,...t})}}j(Fw,"componentName","Component"),j(Fw,"defaultProps",{});const EW=Object.freeze({});class SW{constructor(t){j(this,"component",void 0),j(this,"onAsyncPropUpdated",void 0),j(this,"asyncProps",void 0),j(this,"oldProps",void 0),j(this,"oldAsyncProps",void 0),this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e&&e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||EW}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return!!(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const e in this.asyncProps)if(this.isAsyncPropLoading(e))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){this.component=t[oy]||this.component;const e=t[HA]||{},n=t[Vh]||t,i=t[ff]||{};for(const s in e){const a=e[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,a),e[s]=this.getAsyncProp(s)}for(const s in n){const a=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,a)}}_fetch(t,e){return null}_onResolve(t,e){}_onError(t,e){}_updateAsyncProp(t,e){if(this._didAsyncInputValueChange(t,e)){if(typeof e=="string"&&(e=this._fetch(t,e)),e instanceof Promise){this._watchPromise(t,e);return}if(_3(e)){this._resolveAsyncIterable(t,e);return}this._setPropValue(t,e)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e===n.resolvedValue||e===n.lastValue?!1:(n.lastValue=e,!0)}_setPropValue(t,e){this._freezeAsyncOldProps();const n=this.asyncProps[t];n&&(e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(t,e,n){const i=this.asyncProps[t];i&&n>=i.resolvedLoadCount&&e!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=e,i.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;e.then(s=>{this.component&&(s=this._postProcessValue(n,s),this._setAsyncPropValue(t,s,i),this._onResolve(t,s))}).catch(s=>{this._onError(t,s)})}}async _resolveAsyncIterable(t,e){if(t!=="data"){this._setPropValue(t,e);return}const n=this.asyncProps[t];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let s=[],a=0;for await(const o of e){if(!this.component)return;const{dataTransform:d}=this.component.props;d?s=d(o,s):s=s.concat(o),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:a,endRow:s.length}]}),a=s.length,this._setAsyncPropValue(t,s,i)}this._onResolve(t,s)}_postProcessValue(t,e){const n=t.type;return n&&this.component&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const i=this.component&&this.component.props[zA];this.asyncProps[t]={type:i&&i[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}class TW extends SW{constructor(t){let{attributeManager:e,layer:n}=t;super(n),j(this,"attributeManager",void 0),j(this,"needsRedraw",void 0),j(this,"needsUpdate",void 0),j(this,"subLayers",void 0),j(this,"usesPickingColorCache",void 0),j(this,"hasPickingBuffer",void 0),j(this,"changeFlags",void 0),j(this,"viewport",void 0),j(this,"uniformTransitions",void 0),j(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(t,e){const n=this.layer,i=n==null?void 0:n.props.fetch;return i?i(e,{propName:t,layer:n}):super._fetch(t,e)}_onResolve(t,e){const n=this.layer;if(n){const i=n.props.onDataLoad;t==="data"&&i&&i(e,{propName:t,layer:n})}}_onError(t,e){const n=this.layer;n&&n.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}}const IW="layer.changeFlag",FW="layer.initialize",LW="layer.update",PW="layer.finalize",MW="layer.matched",P3=2**24-1,RW=Object.freeze([]),UW=xg(r=>{let{oldViewport:t,viewport:e}=r;return t.equals(e)});let Qc=new Uint8ClampedArray(0);const OW={data:{type:"data",value:RW,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:r=>r&&r.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(r,t)=>{let{propName:e,layer:n,loaders:i,loadOptions:s,signal:a}=t;const{resourceManager:o}=n.context;if(s=s||n.getLoadOptions(),i=i||n.props.loaders,a){var d;s={...s,fetch:{...(d=s)===null||d===void 0?void 0:d.fetch,signal:a}}}let f=o.contains(r);return!f&&!s&&(o.add({resourceId:r,data:UA(r,i),persistent:!1}),f=!0),f?o.subscribe({resourceId:r,onChange:_=>{var w;return(w=n.internalState)===null||w===void 0?void 0:w.reloadAsyncProp(e,_)},consumerId:n.id,requestId:e}):UA(r,i,s)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Sn.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:r=>{let{layerIndex:t}=r;return[0,-t*100]}},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class mf extends Fw{constructor(){super(...arguments),j(this,"internalState",null),j(this,"lifecycle",df.NO_STATE),j(this,"context",void 0),j(this,"state",void 0),j(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}project(t){Ws(this.internalState);const e=this.internalState.viewport||this.context.viewport,n=GI(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,a]=OI(n,e.pixelProjectionMatrix);return t.length===2?[i,s]:[i,s,a]}unproject(t){return Ws(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,e){Ws(this.internalState);const n=this.internalState.viewport||this.context.viewport;return nK(t,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...e})}get isComposite(){return!1}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===Sn.DEFAULT||t===Sn.LNGLAT||t===Sn.CARTESIAN}onHover(t,e){return this.props.onHover&&this.props.onHover(t,e)||!1}onClick(t,e){return this.props.onClick&&this.props.onClick(t,e)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){Ws(t instanceof Uint8Array);const[e,n,i]=t;return e+n*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:aW(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var t;return(t=this.getAttributeManager())===null||t===void 0?void 0:t.getBounds(["positions","instancePositions"])}getShaders(t){for(const e of this.props.extensions)t=uW(t,e.getShaders.call(this,e));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){const e=this.getAttributeManager(),{dataChanged:n}=t.changeFlags;if(n&&e)if(Array.isArray(n))for(const i of n)e.invalidateAll(i);else e.invalidateAll();if(e){const{props:i}=t,s=this.internalState.hasPickingBuffer,a=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(o=>o.getNeedsPickingBuffer.call(this,o));if(s!==a){this.internalState.hasPickingBuffer=a;const{pickingColors:o,instancePickingColors:d}=e.attributes,f=o||d;f&&(a&&f.constant&&(f.constant=!1,e.invalidate(f.id)),!f.value&&!a&&(f.constant=!0,f.value=[0,0,0]))}}}finalizeState(t){for(const n of this.getModels())n.delete();const e=this.getAttributeManager();e&&e.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo(t){let{info:e,mode:n,sourceLayer:i}=t;const{index:s}=e;return s>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[s]),e}raiseError(t,e){var n,i;if(e&&(t=new Error("".concat(e,": ").concat(t.message),{cause:t})),!((n=(i=this.props).onError)!==null&&n!==void 0&&n.call(i,t))){var s,a;(s=this.context)===null||s===void 0||(a=s.onError)===null||a===void 0||a.call(s,t,this)}}getNeedsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var t;return((t=this.internalState)===null||t===void 0?void 0:t.uniformTransitions.active)||!1}activateViewport(t){if(!this.internalState)return;const e=this.internalState.viewport;this.internalState.viewport=t,(!e||!UW({oldViewport:e,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"all";const e=this.getAttributeManager();e&&(t==="all"?e.invalidateAll():e.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(){const t=this.getAttributeManager();if(!t)return;const e=this.props,n=this.getNumInstances(),i=this.getStartIndices();t.update({data:e.data,numInstances:n,startIndices:i,props:e,transitions:e.transitions,buffers:e.data.attributes,context:this});const s=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const i in e)Object.defineProperty(n,i,{value:e[i]});return n}return this.props}calculateInstancePickingColors(t,e){let{numInstances:n}=e;if(t.constant)return;const i=Math.floor(Qc.length/3);if(this.internalState.usesPickingColorCache=!0,i<n){n>P3&&Tn.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Qc=Cg.allocate(Qc,n,{size:3,copy:!0,maxCount:Math.max(n,P3)});const s=Math.floor(Qc.length/3),a=[];for(let o=i;o<s;o++)this.encodePickingColor(o,a),Qc[o*3+0]=a[0],Qc[o*3+1]=a[1],Qc[o*3+2]=a[2]}t.value=Qc.subarray(0,n*3)}_setModelAttributes(t,e){const n=this.getAttributeManager(),i=t.userData.excludeAttributes||{},s=n.getShaderAttributes(e,i);t.setAttributes(s)}disablePickingIndex(t){const e=this.props.data;if(!("attributes"in e)){this._disablePickingIndex(t);return}const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,s=n||i,a=s&&e.attributes&&e.attributes[s.id];if(a&&a.value){const o=a.value,d=this.encodePickingColor(t);for(let f=0;f<e.length;f++){const _=s.getVertexOffset(f);o[_]===d[0]&&o[_+1]===d[1]&&o[_+2]===d[2]&&this._disablePickingIndex(f)}}else this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;if(!i)return;const s=i.getVertexOffset(t),a=i.getVertexOffset(t+1);i.buffer.subData({data:new Uint8Array(a-s),offset:s})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==Qc.buffer&&(n.value=Qc.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){Ws(!this.internalState),Ws(Number.isFinite(this.props.coordinateSystem)),Ao(FW,this);const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new TW({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Tn.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.uniformTransitions=new Y$(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const e of this.props.extensions)e.initializeState.call(this,this.context,e);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){Ao(MW,this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.state=e,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const t=this.needsUpdate();if(Ao(LW,this,t),!t)return;const e=this.props,n=this.context,i=this.internalState,s=n.viewport,a=this._updateUniformTransition();i.propsInTransition=a,n.viewport=i.viewport||s,this.props=a;try{const o=this._getUpdateParams(),d=this.getModels();if(n.gl)this.updateState(o);else try{this.updateState(o)}catch{}for(const _ of this.props.extensions)_.updateState.call(this,o,_);const f=this.getModels()[0]!==d[0];this._postUpdate(o,f)}finally{n.viewport=s,this.props=e,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Ao(PW,this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,this.context,t)}_drawLayer(t){let{moduleParameters:e=null,uniforms:n={},parameters:i={}}=t;this._updateAttributeTransition();const s=this.props,a=this.context;this.props=this.internalState.propsInTransition||s;const o=this.props.opacity;n.opacity=Math.pow(o,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:d}=this.props,f=d&&d(n)||[0,0];Nu(a.gl,{polygonOffset:f}),ql(a.gl,i,()=>{const _={moduleParameters:e,uniforms:n,parameters:i,context:a};for(const w of this.props.extensions)w.draw.call(this,_,w);this.draw(_)})}finally{this.props=s}}getChangeFlags(){var t;return(t=this.internalState)===null||t===void 0?void 0:t.changeFlags}setChangeFlags(t){if(!this.internalState)return;const{changeFlags:e}=this.internalState;for(const i in t)if(t[i]){let s=!1;switch(i){case"dataChanged":const a=t[i],o=e[i];a&&Array.isArray(o)&&(e.dataChanged=Array.isArray(a)?o.concat(a):a,s=!0);default:e[i]||(e[i]=t[i],s=!0)}s&&Ao(IW,this,i,t)}const n=!!(e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged);e.propsOrDataChanged=n,e.somethingChanged=n||e.viewportChanged||e.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,e){const n=tW(t,e);if(n.updateTriggersChanged)for(const s in n.updateTriggersChanged)n.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(n.transitionsChanged)for(const s in n.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,e[s],t[s],(i=t.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(n)}validateProps(){Z$(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&typeof n=="function"&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_getAttributeManager(){const t=this.context;return new K$(t.gl,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,e){const{props:n,oldProps:i}=t;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s==null||s.setInstanceCount(this.getNumInstances());const{autoHighlight:a,highlightedObjectIndex:o,highlightColor:d}=n;if(e||i.autoHighlight!==a||i.highlightedObjectIndex!==o||i.highlightColor!==d){const f={};a||(f.pickingSelectedColor=null),Array.isArray(d)&&(f.pickingHighlightColor=d),(e||o!==i.highlightedObjectIndex)&&(f.pickingSelectedColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setModuleParameters(f)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),i=n?n.getNeedsRedraw(t):!1;if(e=e||i,e)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags,e}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}j(mf,"defaultProps",OW),j(mf,"layerName","Layer");const DW="compositeLayer.renderLayers";class M3 extends mf{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(t){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo(t){let{info:e}=t;const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){return e&&e.length}getSubLayerClass(t,e){const{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||e}getSubLayerRow(t,e,n){return t.__source={parent:this,object:e,index:n},t}getSubLayerAccessor(t){if(typeof t=="function"){const e={index:-1,data:this.props.data,target:[]};return(n,i)=>n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,i)}return t}getSubLayerProps(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var e;const{opacity:n,pickable:i,visible:s,parameters:a,getPolygonOffset:o,highlightedObjectIndex:d,autoHighlight:f,highlightColor:_,coordinateSystem:w,coordinateOrigin:x,wrapLongitude:B,positionFormat:P,modelMatrix:R,extensions:N,fetch:Q,operation:V,_subLayerProps:W}=this.props,et={id:"",updateTriggers:{},opacity:n,pickable:i,visible:s,parameters:a,getPolygonOffset:o,highlightedObjectIndex:d,autoHighlight:f,highlightColor:_,coordinateSystem:w,coordinateOrigin:x,wrapLongitude:B,positionFormat:P,modelMatrix:R,extensions:N,fetch:Q,operation:V},ct=W&&t.id&&W[t.id],dt=ct&&ct.updateTriggers,gt=t.id||"sublayer";if(ct){const ht=this.props[zA],It=t.type?t.type._propTypes:{};for(const St in ct){const ot=It[St]||ht[St];ot&&ot.type==="accessor"&&(ct[St]=this.getSubLayerAccessor(ct[St]))}}Object.assign(et,t,ct),et.id="".concat(this.props.id,"-").concat(gt),et.updateTriggers={all:(e=this.props.updateTriggers)===null||e===void 0?void 0:e.all,...t.updateTriggers,...dt};for(const ht of N){const It=ht.getSubLayerProps.call(this,ht);It&&Object.assign(et,It,{updateTriggers:Object.assign(et.updateTriggers,It.updateTriggers)})}return et}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_postUpdate(t,e){let n=this.internalState.subLayers;const i=!n||this.needsUpdate();if(i){const s=this.renderLayers();n=ay(s,Boolean),this.internalState.subLayers=n}Ao(DW,this,i,n);for(const s of n)s.parent=this}}j(M3,"layerName","CompositeLayer");const Lw=512,NW=Math.PI/180;function kW(r){let{map:t,gl:e,deck:n}=r;if(t.__deck)return t.__deck;const i=n==null?void 0:n.props._customRender,s=n==null?void 0:n.props.onLoad,a=zW({...n==null?void 0:n.props,_customRender:()=>{t.triggerRepaint(),i==null||i("")}});let o;return(!n||n.props.gl===e)&&(Object.assign(a,{gl:e,width:null,height:null,touchAction:"unset",viewState:Pw(t)}),n!=null&&n.isInitialized?R3(n,t):a.onLoad=()=>{s==null||s(),R3(o,t)}),n?(o=n,n.setProps(a),n.userData.isExternal=!0):(o=new vw(a),t.on("remove",()=>{QW(t)})),o.userData.mapboxLayers=new Set,t.__deck=o,t.on("render",()=>{o.isInitialized&&KW(o,t)}),o}function R3(r,t){const e=()=>{r.isInitialized?$W(r,t):t.off("move",e)};t.on("move",e)}function QW(r){var t;(t=r.__deck)===null||t===void 0||t.finalize(),r.__deck=null}function zW(r){return{...r,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...r.parameters},views:r.views||[new dw({id:"mapbox"})]}}function HW(r,t){r.userData.mapboxLayers.add(t),Mw(r)}function VW(r,t){r.userData.mapboxLayers.delete(t),Mw(r)}function GW(r,t){Mw(r)}function jW(r,t,e){let{currentViewport:n}=r.userData,i=!1;n||(n=U3(r,t,!0),r.userData.currentViewport=n,i=!0),r.isInitialized&&r._drawLayers("mapbox-repaint",{viewports:[n],layerFilter:s=>{let{layer:a}=s;return e.id===a.id||a.props.operation.includes("terrain")},clearStack:i,clearCanvas:!1})}function Pw(r){var t;const{lng:e,lat:n}=r.getCenter(),i={longitude:(e+540)%360-180,latitude:n,zoom:r.getZoom(),bearing:r.getBearing(),pitch:r.getPitch(),padding:r.getPadding(),repeat:r.getRenderWorldCopies()};return(t=r.getTerrain)!==null&&t!==void 0&&t.call(r)&&qW(r,i),i}function qW(r,t){if(r.getFreeCameraOptions){const{position:e}=r.getFreeCameraOptions();if(!e||e.z===void 0)return;const n=r.transform.height,{longitude:i,latitude:s,pitch:a}=t,o=e.x*Lw,d=(1-e.y)*Lw,f=e.z*Lw,_=Bg([i,s]),w=o-_[0],x=d-_[1],B=Math.sqrt(w*w+x*x),P=a*NW,R=1.5*n,N=P<.001?R*Math.cos(P)/f:R*Math.sin(P)/B;t.zoom=Math.log2(N);const Q=R*Math.cos(P)/N,V=f-Q;t.position=[0,0,V/iy(s)]}else typeof r.transform.elevation=="number"&&(t.position=[0,0,r.transform.elevation])}function U3(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return new Hh({id:"mapbox",x:0,y:0,width:r.width,height:r.height,...Pw(t),nearZMultiplier:e?.02:.1,nearZ:t.transform._nearZ/t.transform.height,farZ:t.transform._farZ/t.transform.height})}function KW(r,t){const{mapboxLayers:e,isExternal:n}=r.userData;if(n){const i=Array.from(e,_=>_.id),a=ay(r.props.layers,Boolean).some(_=>_&&!i.includes(_.id));let o=r.getViewports();const d=o.findIndex(_=>_.id==="mapbox"),f=o.length>1||d<0;(a||f)&&(d>=0&&(o=o.slice(),o[d]=U3(r,t,!1)),r._drawLayers("mapbox-repaint",{viewports:o,layerFilter:_=>(!r.props.layerFilter||r.props.layerFilter(_))&&(_.viewport.id!=="mapbox"||!i.includes(_.layer.id)),clearCanvas:!1}))}r.userData.currentViewport=null}function $W(r,t){r.setProps({viewState:Pw(t)}),r.needsRedraw({clearRedrawFlags:!0})}function Mw(r){if(r.userData.isExternal)return;const t=[];r.userData.mapboxLayers.forEach(e=>{const n=e.props.type,i=new n(e.props);t.push(i)}),r.setProps({layers:t})}class WW{constructor(t){if(j(this,"id",void 0),j(this,"type",void 0),j(this,"renderingMode",void 0),j(this,"map",void 0),j(this,"deck",void 0),j(this,"props",void 0),!t.id)throw new Error("Layer must have an unique id");this.id=t.id,this.type="custom",this.renderingMode=t.renderingMode||"3d",this.map=null,this.deck=null,this.props=t}onAdd(t,e){this.map=t,this.deck=kW({map:t,gl:e,deck:this.props.deck}),HW(this.deck,this)}onRemove(){this.deck&&VW(this.deck,this)}setProps(t){Object.assign(this.props,t,{id:this.id}),this.deck&&GW(this.deck)}render(){jW(this.deck,this.map,this)}}const XW=`#define SHADER_NAME point-cloud-layer-vertex-shader

attribute vec3 positions;
attribute vec3 instanceNormals;
attribute vec4 instanceColors;
attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusPixels;
uniform int sizeUnits;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.normal = project_normal(instanceNormals);
  unitPosition = positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;
  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);
  DECKGL_FILTER_SIZE(offset, geometry);

  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
  vColor = vec4(lightColor, instanceColors.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,JW=`#define SHADER_NAME point-cloud-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition);

  if (distToCenter > 1.0) {
    discard;
  }

  gl_FragColor = vColor;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,O3=[0,0,0,255],D3=[0,0,1],YW={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:r=>r.position},getNormal:{type:"accessor",value:D3},getColor:{type:"accessor",value:O3},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};function ZW(r){const{header:t,attributes:e}=r;!t||!e||(r.length=t.vertexCount,e.POSITION&&(e.instancePositions=e.POSITION),e.NORMAL&&(e.instanceNormals=e.NORMAL),e.COLOR_0&&(e.instanceColors=e.COLOR_0))}class Rw extends mf{getShaders(){return super.getShaders({vs:XW,fs:JW,modules:[uw,Ej,Aw]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:D3},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:O3}})}updateState(t){const{changeFlags:e,props:n}=t;if(super.updateState(t),e.extensionsChanged){var i;const{gl:s}=this.context;(i=this.state.model)===null||i===void 0||i.delete(),this.state.model=this._getModel(s),this.getAttributeManager().invalidateAll()}e.dataChanged&&ZW(n.data)}draw(t){let{uniforms:e}=t;const{pointSize:n,sizeUnits:i}=this.props;this.state.model.setUniforms(e).setUniforms({sizeUnits:ab[i],radiusPixels:n}).draw()}_getModel(t){const e=[];for(let n=0;n<3;n++){const i=n/3*Math.PI*2;e.push(Math.cos(i)*2,Math.sin(i)*2,0)}return new af(t,{...this.getShaders(),id:this.props.id,geometry:new wg({drawMode:4,attributes:{positions:new Float32Array(e)}}),isInstanced:!0})}}j(Rw,"layerName","PointCloudLayer"),j(Rw,"defaultProps",YW);const ka={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};new ie,new ie;const Lg=new ie,N3=new ie;class Pg{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;j(this,"center",void 0),j(this,"radius",void 0),this.radius=-0,this.center=new ie,this.fromCenterRadius(t,e)}fromCenterRadius(t,e){return this.center.from(t),this.radius=e,this}fromCornerPoints(t,e){return e=Lg.from(e),this.center=new ie().from(t).add(e).scale(.5),this.radius=this.center.distance(e),this}equals(t){return this===t||!!t&&this.center.equals(t.center)&&this.radius===t.radius}clone(){return new Pg(this.center,this.radius)}union(t){const e=this.center,n=this.radius,i=t.center,s=t.radius,a=Lg.copy(i).subtract(e),o=a.magnitude();if(n>=o+s)return this.clone();if(s>=o+n)return t.clone();const d=(n+o+s)*.5;return N3.copy(a).scale((-n+d)/o).add(e),this.center.copy(N3),this.radius=d,this}expand(t){const n=Lg.from(t).subtract(this.center).magnitude();return n>this.radius&&(this.radius=n),this}transform(t){this.center.transform(t);const e=OG(Lg,t);return this.radius=Math.max(e[0],Math.max(e[1],e[2]))*this.radius,this}distanceSquaredTo(t){const e=this.distanceTo(t);return e*e}distanceTo(t){const n=Lg.from(t).subtract(this.center);return Math.max(0,n.len()-this.radius)}intersectPlane(t){const e=this.center,n=this.radius,s=t.normal.dot(e)+t.distance;return s<-n?ka.OUTSIDE:s<n?ka.INTERSECTING:ka.INSIDE}}const tX=new ie,eX=new ie,fy=new ie,py=new ie,gy=new ie,rX=new ie,nX=new ie,ju={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class Mg{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0,0,0,0,0,0,0];j(this,"center",void 0),j(this,"halfAxes",void 0),this.center=new ie().from(t),this.halfAxes=new Oi(e)}get halfSize(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new ie(t).len(),new ie(e).len(),new ie(n).len()]}get quaternion(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),i=new ie(t).normalize(),s=new ie(e).normalize(),a=new ie(n).normalize();return new _g().fromMatrix3(new Oi([...i,...s,...a]))}fromCenterHalfSizeQuaternion(t,e,n){const i=new _g(n),s=new Oi().fromQuaternion(i);return s[0]=s[0]*e[0],s[1]=s[1]*e[0],s[2]=s[2]*e[0],s[3]=s[3]*e[1],s[4]=s[4]*e[1],s[5]=s[5]*e[1],s[6]=s[6]*e[2],s[7]=s[7]*e[2],s[8]=s[8]*e[2],this.center=new ie().from(t),this.halfAxes=s,this}clone(){return new Mg(this.center,this.halfAxes)}equals(t){return this===t||!!t&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}getBoundingSphere(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Pg;const e=this.halfAxes,n=e.getColumn(0,fy),i=e.getColumn(1,py),s=e.getColumn(2,gy),a=tX.copy(n).add(i).add(s);return t.center.copy(this.center),t.radius=a.magnitude(),t}intersectPlane(t){const e=this.center,n=t.normal,i=this.halfAxes,s=n.x,a=n.y,o=n.z,d=Math.abs(s*i[ju.COLUMN0ROW0]+a*i[ju.COLUMN0ROW1]+o*i[ju.COLUMN0ROW2])+Math.abs(s*i[ju.COLUMN1ROW0]+a*i[ju.COLUMN1ROW1]+o*i[ju.COLUMN1ROW2])+Math.abs(s*i[ju.COLUMN2ROW0]+a*i[ju.COLUMN2ROW1]+o*i[ju.COLUMN2ROW2]),f=n.dot(e)+t.distance;return f<=-d?ka.OUTSIDE:f>=d?ka.INSIDE:ka.INTERSECTING}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=eX.from(t).subtract(this.center),n=this.halfAxes,i=n.getColumn(0,fy),s=n.getColumn(1,py),a=n.getColumn(2,gy),o=i.magnitude(),d=s.magnitude(),f=a.magnitude();i.normalize(),s.normalize(),a.normalize();let _=0,w;return w=Math.abs(e.dot(i))-o,w>0&&(_+=w*w),w=Math.abs(e.dot(s))-d,w>0&&(_+=w*w),w=Math.abs(e.dot(a))-f,w>0&&(_+=w*w),_}computePlaneDistances(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[-0,-0],i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const a=this.center,o=this.halfAxes,d=o.getColumn(0,fy),f=o.getColumn(1,py),_=o.getColumn(2,gy),w=rX.copy(d).add(f).add(_).add(a),x=nX.copy(w).subtract(t);let B=e.dot(x);return i=Math.min(B,i),s=Math.max(B,s),w.copy(a).add(d).add(f).subtract(_),x.copy(w).subtract(t),B=e.dot(x),i=Math.min(B,i),s=Math.max(B,s),w.copy(a).add(d).subtract(f).add(_),x.copy(w).subtract(t),B=e.dot(x),i=Math.min(B,i),s=Math.max(B,s),w.copy(a).add(d).subtract(f).subtract(_),x.copy(w).subtract(t),B=e.dot(x),i=Math.min(B,i),s=Math.max(B,s),a.copy(w).subtract(d).add(f).add(_),x.copy(w).subtract(t),B=e.dot(x),i=Math.min(B,i),s=Math.max(B,s),a.copy(w).subtract(d).add(f).subtract(_),x.copy(w).subtract(t),B=e.dot(x),i=Math.min(B,i),s=Math.max(B,s),a.copy(w).subtract(d).subtract(f).add(_),x.copy(w).subtract(t),B=e.dot(x),i=Math.min(B,i),s=Math.max(B,s),a.copy(w).subtract(d).subtract(f).subtract(_),x.copy(w).subtract(t),B=e.dot(x),i=Math.min(B,i),s=Math.max(B,s),n[0]=i,n[1]=s,n}transform(t){this.center.transformAsPoint(t);const e=this.halfAxes.getColumn(0,fy);e.transformAsPoint(t);const n=this.halfAxes.getColumn(1,py);n.transformAsPoint(t);const i=this.halfAxes.getColumn(2,gy);return i.transformAsPoint(t),this.halfAxes=new Oi([...e,...n,...i]),this}getTransform(){throw new Error("not implemented")}}const k3=new ie,Q3=new ie;class Jl{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,1],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;j(this,"normal",void 0),j(this,"distance",void 0),this.normal=new ie,this.distance=-0,this.fromNormalDistance(t,e)}fromNormalDistance(t,e){return Kl(Number.isFinite(e)),this.normal.from(t).normalize(),this.distance=e,this}fromPointNormal(t,e){t=k3.from(t),this.normal.from(e).normalize();const n=-this.normal.dot(t);return this.distance=n,this}fromCoefficients(t,e,n,i){return this.normal.set(t,e,n),Kl($l(this.normal.len(),1)),this.distance=i,this}clone(){return new Jl(this.normal,this.distance)}equals(t){return $l(this.distance,t.distance)&&$l(this.normal,t.normal)}getPointDistance(t){return this.normal.dot(t)+this.distance}transform(t){const e=Q3.copy(this.normal).transformAsVector(t).normalize(),n=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(n,e)}projectPointOntoPlane(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];t=k3.from(t);const n=this.getPointDistance(t),i=Q3.copy(this.normal).scale(n);return t.subtract(i).to(e)}}const z3=[new ie([1,0,0]),new ie([0,1,0]),new ie([0,0,1])],H3=new ie,iX=new ie;new Jl(new ie(1,0,0),0);class pl{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];j(this,"planes",void 0),this.planes=t}fromBoundingSphere(t){this.planes.length=2*z3.length;const e=t.center,n=t.radius;let i=0;for(const s of z3){let a=this.planes[i],o=this.planes[i+1];a||(a=this.planes[i]=new Jl),o||(o=this.planes[i+1]=new Jl);const d=H3.copy(s).scale(-n).add(e);-s.dot(d),a.fromPointNormal(d,s);const f=H3.copy(s).scale(n).add(e),_=iX.copy(s).negate();-_.dot(f),o.fromPointNormal(f,_),i+=2}return this}computeVisibility(t){let e=ka.INSIDE;for(const n of this.planes)switch(t.intersectPlane(n)){case ka.OUTSIDE:return ka.OUTSIDE;case ka.INTERSECTING:e=ka.INTERSECTING;break}return e}computeVisibilityWithPlaneMask(t,e){if(Kl(Number.isFinite(e),"parentPlaneMask is required."),e===pl.MASK_OUTSIDE||e===pl.MASK_INSIDE)return e;let n=pl.MASK_INSIDE;const i=this.planes;for(let s=0;s<this.planes.length;++s){const a=s<31?1<<s:0;if(s<31&&!(e&a))continue;const o=i[s],d=t.intersectPlane(o);if(d===ka.OUTSIDE)return pl.MASK_OUTSIDE;d===ka.INTERSECTING&&(n|=a)}return n}}j(pl,"MASK_OUTSIDE",4294967295),j(pl,"MASK_INSIDE",0),j(pl,"MASK_INDETERMINATE",2147483647),new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie;const zc=new Oi,sX=new Oi,oX=new Oi,my=new Oi,V3=new Oi;function aX(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e=vg.EPSILON20,n=10;let i=0,s=0;const a=sX,o=oX;a.identity(),o.copy(r);const d=e*lX(o);for(;s<n&&cX(o)>d;)uX(o,my),V3.copy(my).transpose(),o.multiplyRight(my),o.multiplyLeft(V3),a.multiplyRight(my),++i>2&&(++s,i=0);return t.unitary=a.toTarget(t.unitary),t.diagonal=o.toTarget(t.diagonal),t}function lX(r){let t=0;for(let e=0;e<9;++e){const n=r[e];t+=n*n}return Math.sqrt(t)}const Uw=[1,0,0],Ow=[2,2,1];function cX(r){let t=0;for(let e=0;e<3;++e){const n=r[zc.getElementIndex(Ow[e],Uw[e])];t+=2*n*n}return Math.sqrt(t)}function uX(r,t){const e=vg.EPSILON15;let n=0,i=1;for(let f=0;f<3;++f){const _=Math.abs(r[zc.getElementIndex(Ow[f],Uw[f])]);_>n&&(i=f,n=_)}const s=Uw[i],a=Ow[i];let o=1,d=0;if(Math.abs(r[zc.getElementIndex(a,s)])>e){const f=r[zc.getElementIndex(a,a)],_=r[zc.getElementIndex(s,s)],w=r[zc.getElementIndex(a,s)],x=(f-_)/2/w;let B;x<0?B=-1/(-x+Math.sqrt(1+x*x)):B=1/(x+Math.sqrt(1+x*x)),o=1/Math.sqrt(1+B*B),d=B*o}return Oi.IDENTITY.to(t),t[zc.getElementIndex(s,s)]=t[zc.getElementIndex(a,a)]=o,t[zc.getElementIndex(a,s)]=d,t[zc.getElementIndex(s,a)]=-d,t}const qA=new ie,AX=new ie,hX=new ie,dX=new ie,fX=new ie,pX=new Oi,gX={diagonal:new Oi,unitary:new Oi};function mX(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Mg;if(!r||r.length===0)return t.halfAxes=new Oi([0,0,0,0,0,0,0,0,0]),t.center=new ie,t;const e=r.length,n=new ie(0,0,0);for(const It of r)n.add(It);const i=1/e;n.multiplyByScalar(i);let s=0,a=0,o=0,d=0,f=0,_=0;for(const It of r){const St=qA.copy(It).subtract(n);s+=St.x*St.x,a+=St.x*St.y,o+=St.x*St.z,d+=St.y*St.y,f+=St.y*St.z,_+=St.z*St.z}s*=i,a*=i,o*=i,d*=i,f*=i,_*=i;const w=pX;w[0]=s,w[1]=a,w[2]=o,w[3]=a,w[4]=d,w[5]=f,w[6]=o,w[7]=f,w[8]=_;const{unitary:x}=aX(w,gX),B=t.halfAxes.copy(x);let P=B.getColumn(0,hX),R=B.getColumn(1,dX),N=B.getColumn(2,fX),Q=-Number.MAX_VALUE,V=-Number.MAX_VALUE,W=-Number.MAX_VALUE,et=Number.MAX_VALUE,ct=Number.MAX_VALUE,dt=Number.MAX_VALUE;for(const It of r)qA.copy(It),Q=Math.max(qA.dot(P),Q),V=Math.max(qA.dot(R),V),W=Math.max(qA.dot(N),W),et=Math.min(qA.dot(P),et),ct=Math.min(qA.dot(R),ct),dt=Math.min(qA.dot(N),dt);P=P.multiplyByScalar(.5*(et+Q)),R=R.multiplyByScalar(.5*(ct+V)),N=N.multiplyByScalar(.5*(dt+W)),t.center.copy(P).add(R).add(N);const gt=AX.set(Q-et,V-ct,W-dt).multiplyByScalar(.5),ht=new Oi([gt[0],0,0,0,gt[1],0,0,0,gt[2]]);return t.halfAxes.multiplyRight(ht),t}const Dw=Math.PI/180,yy=new Float32Array(16),G3=new Float32Array(12);function j3(r,t,e){const n=t[0]*Dw,i=t[1]*Dw,s=t[2]*Dw,a=Math.sin(s),o=Math.sin(n),d=Math.sin(i),f=Math.cos(s),_=Math.cos(n),w=Math.cos(i),x=e[0],B=e[1],P=e[2];r[0]=x*w*_,r[1]=x*d*_,r[2]=x*-o,r[3]=B*(-d*f+w*o*a),r[4]=B*(w*f+d*o*a),r[5]=B*_*a,r[6]=P*(d*a+w*o*f),r[7]=P*(-w*a+d*o*f),r[8]=P*_*f}function q3(r){return r[0]=r[0],r[1]=r[1],r[2]=r[2],r[3]=r[4],r[4]=r[5],r[5]=r[6],r[6]=r[8],r[7]=r[9],r[8]=r[10],r[9]=r[12],r[10]=r[13],r[11]=r[14],r.subarray(0,12)}const K3={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(r,t){let{startRow:e,endRow:n}=t;const{data:i,getOrientation:s,getScale:a,getTranslation:o,getTransformMatrix:d}=this.props,f=Array.isArray(d),_=f&&d.length===16,w=Array.isArray(a),x=Array.isArray(s),B=Array.isArray(o),P=_||!f&&!!d(i[0]);P?r.constant=_:r.constant=x&&w&&B;const R=r.value;if(r.constant){let N;P?(yy.set(d),N=q3(yy)):(N=G3,j3(N,s,a),N.set(o,9)),r.value=new Float32Array(N)}else{let N=e*r.size;const{iterable:Q,objectInfo:V}=y3(i,e,n);for(const W of Q){V.index++;let et;if(P)yy.set(_?d:d(W,V)),et=q3(yy);else{et=G3;const ct=x?s:s(W,V),dt=w?a:a(W,V);j3(et,ct,dt),et.set(B?o:o(W,V),9)}R[N++]=et[0],R[N++]=et[1],R[N++]=et[2],R[N++]=et[3],R[N++]=et[4],R[N++]=et[5],R[N++]=et[6],R[N++]=et[7],R[N++]=et[8],R[N++]=et[9],R[N++]=et[10],R[N++]=et[11]}}}};function $3(r,t){return t===Sn.CARTESIAN||t===Sn.METER_OFFSETS||t===Sn.DEFAULT&&!r.isGeospatial}const yX=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,_X=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function W3(r){let t=1/0,e=1/0,n=1/0,i=-1/0,s=-1/0,a=-1/0;const o=r.POSITION?r.POSITION.value:[],d=o&&o.length;for(let f=0;f<d;f+=3){const _=o[f],w=o[f+1],x=o[f+2];t=_<t?_:t,e=w<e?w:e,n=x<n?x:n,i=_>i?_:i,s=w>s?w:s,a=x>a?x:a}return[[t,e,n],[i,s,a]]}function vX(r,t){if(!r)throw new Error("loader assertion failed.")}class yf{constructor(t,e){j(this,"fields",void 0),j(this,"metadata",void 0),vX(Array.isArray(t)),bX(t),this.fields=t,this.metadata=e||new Map}compareTo(t){if(this.metadata!==t.metadata||this.fields.length!==t.fields.length)return!1;for(let e=0;e<this.fields.length;++e)if(!this.fields[e].compareTo(t.fields[e]))return!1;return!0}select(){const t=Object.create(null);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];for(const a of n)t[a]=!0;const s=this.fields.filter(a=>t[a.name]);return new yf(s,this.metadata)}selectAt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.map(s=>this.fields[s]).filter(Boolean);return new yf(i,this.metadata)}assign(t){let e,n=this.metadata;if(t instanceof yf){const a=t;e=a.fields,n=X3(X3(new Map,this.metadata),a.metadata)}else e=t;const i=Object.create(null);for(const a of this.fields)i[a.name]=a;for(const a of e)i[a.name]=a;const s=Object.values(i);return new yf(s,n)}}function bX(r){const t={};for(const e of r)t[e.name]&&console.warn("Schema: duplicated field name",e.name,e),t[e.name]=!0}function X3(r,t){return new Map([...r||new Map,...t||new Map])}class _y{constructor(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;j(this,"name",void 0),j(this,"type",void 0),j(this,"nullable",void 0),j(this,"metadata",void 0),this.name=t,this.type=e,this.nullable=n,this.metadata=i}get typeId(){return this.type&&this.type.typeId}clone(){return new _y(this.name,this.type,this.nullable,this.metadata)}compareTo(t){return this.name===t.name&&this.type===t.type&&this.nullable===t.nullable&&this.metadata===t.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let Di=function(r){return r[r.NONE=0]="NONE",r[r.Null=1]="Null",r[r.Int=2]="Int",r[r.Float=3]="Float",r[r.Binary=4]="Binary",r[r.Utf8=5]="Utf8",r[r.Bool=6]="Bool",r[r.Decimal=7]="Decimal",r[r.Date=8]="Date",r[r.Time=9]="Time",r[r.Timestamp=10]="Timestamp",r[r.Interval=11]="Interval",r[r.List=12]="List",r[r.Struct=13]="Struct",r[r.Union=14]="Union",r[r.FixedSizeBinary=15]="FixedSizeBinary",r[r.FixedSizeList=16]="FixedSizeList",r[r.Map=17]="Map",r[r.Dictionary=-1]="Dictionary",r[r.Int8=-2]="Int8",r[r.Int16=-3]="Int16",r[r.Int32=-4]="Int32",r[r.Int64=-5]="Int64",r[r.Uint8=-6]="Uint8",r[r.Uint16=-7]="Uint16",r[r.Uint32=-8]="Uint32",r[r.Uint64=-9]="Uint64",r[r.Float16=-10]="Float16",r[r.Float32=-11]="Float32",r[r.Float64=-12]="Float64",r[r.DateDay=-13]="DateDay",r[r.DateMillisecond=-14]="DateMillisecond",r[r.TimestampSecond=-15]="TimestampSecond",r[r.TimestampMillisecond=-16]="TimestampMillisecond",r[r.TimestampMicrosecond=-17]="TimestampMicrosecond",r[r.TimestampNanosecond=-18]="TimestampNanosecond",r[r.TimeSecond=-19]="TimeSecond",r[r.TimeMillisecond=-20]="TimeMillisecond",r[r.TimeMicrosecond=-21]="TimeMicrosecond",r[r.TimeNanosecond=-22]="TimeNanosecond",r[r.DenseUnion=-23]="DenseUnion",r[r.SparseUnion=-24]="SparseUnion",r[r.IntervalDayTime=-25]="IntervalDayTime",r[r.IntervalYearMonth=-26]="IntervalYearMonth",r}({}),J3,Y3,Z3;class Nw{static isNull(t){return t&&t.typeId===Di.Null}static isInt(t){return t&&t.typeId===Di.Int}static isFloat(t){return t&&t.typeId===Di.Float}static isBinary(t){return t&&t.typeId===Di.Binary}static isUtf8(t){return t&&t.typeId===Di.Utf8}static isBool(t){return t&&t.typeId===Di.Bool}static isDecimal(t){return t&&t.typeId===Di.Decimal}static isDate(t){return t&&t.typeId===Di.Date}static isTime(t){return t&&t.typeId===Di.Time}static isTimestamp(t){return t&&t.typeId===Di.Timestamp}static isInterval(t){return t&&t.typeId===Di.Interval}static isList(t){return t&&t.typeId===Di.List}static isStruct(t){return t&&t.typeId===Di.Struct}static isUnion(t){return t&&t.typeId===Di.Union}static isFixedSizeBinary(t){return t&&t.typeId===Di.FixedSizeBinary}static isFixedSizeList(t){return t&&t.typeId===Di.FixedSizeList}static isMap(t){return t&&t.typeId===Di.Map}static isDictionary(t){return t&&t.typeId===Di.Dictionary}get typeId(){return Di.NONE}compareTo(t){return this===t}}J3=Symbol.toStringTag;class _f extends Nw{constructor(t,e){super(),j(this,"isSigned",void 0),j(this,"bitWidth",void 0),this.isSigned=t,this.bitWidth=e}get typeId(){return Di.Int}get[J3](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class wX extends _f{constructor(){super(!0,8)}}class xX extends _f{constructor(){super(!0,16)}}class BX extends _f{constructor(){super(!0,32)}}class CX extends _f{constructor(){super(!1,8)}}class EX extends _f{constructor(){super(!1,16)}}class SX extends _f{constructor(){super(!1,32)}}const tF={HALF:16,SINGLE:32,DOUBLE:64};Y3=Symbol.toStringTag;class eF extends Nw{constructor(t){super(),j(this,"precision",void 0),this.precision=t}get typeId(){return Di.Float}get[Y3](){return"Float"}toString(){return"Float".concat(this.precision)}}class TX extends eF{constructor(){super(tF.SINGLE)}}class IX extends eF{constructor(){super(tF.DOUBLE)}}Z3=Symbol.toStringTag;class FX extends Nw{constructor(t,e){super(),j(this,"listSize",void 0),j(this,"children",void 0),this.listSize=t,this.children=[e]}get typeId(){return Di.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[Z3](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function LX(r){switch(r.constructor){case Int8Array:return new wX;case Uint8Array:return new CX;case Int16Array:return new xX;case Uint16Array:return new EX;case Int32Array:return new BX;case Uint32Array:return new SX;case Float32Array:return new TX;case Float64Array:return new IX;default:throw new Error("array type not supported")}}function PX(r,t,e){const n=LX(t.value),i=e||MX(t);return new _y(r,new FX(t.size,new _y("value",n)),!1,i)}function MX(r){const t=new Map;return"byteOffset"in r&&t.set("byteOffset",r.byteOffset.toString(10)),"byteStride"in r&&t.set("byteStride",r.byteStride.toString(10)),"normalized"in r&&t.set("normalized",r.normalized.toString()),t}function rF(r,t){(r.COLOR_0||r.colors)&&t||(r.colors={constant:!0,value:new Float32Array([1,1,1])}),Tn.assert(r.positions||r.POSITION,'no "postions" or "POSITION" attribute in mesh')}function nF(r,t){if(r.attributes)return rF(r.attributes,t),r instanceof wg?r:new wg(r);if(r.positions||r.POSITION)return rF(r,t),new wg({attributes:r});throw Error("Invalid mesh")}const RX={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:r=>r.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class kw extends mf{constructor(){super(...arguments),j(this,"state",void 0)}getShaders(){const t=!mn(this.context.gl),e={};return vb(this.context.gl,fi.GLSL_DERIVATIVES)&&(e.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:yX,fs:_X,modules:[uw,Sj,Aw],transpileToGLSL100:t,defines:e})}getBounds(){var t;if(this.props._instanced)return super.getBounds();let e=this.state.positionBounds;if(e)return e;const{mesh:n}=this.props;if(!n)return null;if(e=(t=n.header)===null||t===void 0?void 0:t.boundingBox,!e){const{attributes:i}=nF(n,this.props._useMeshColors);i.POSITION=i.POSITION||i.positions,e=W3(i)}return this.state.positionBounds=e,e}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:K3}),this.setState({emptyTexture:new Ua(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:i}=t;if(e.mesh!==n.mesh||i.extensionsChanged){var s;if(this.state.positionBounds=null,(s=this.state.model)===null||s===void 0||s.delete(),e.mesh){this.state.model=this.getModel(e.mesh);const a=e.mesh.attributes||e.mesh;this.setState({hasNormals:!!(a.NORMAL||a.normals)})}this.getAttributeManager().invalidateAll()}e.texture!==n.texture&&this.setTexture(e.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(t){super.finalizeState(t),this.state.emptyTexture.delete()}draw(t){let{uniforms:e}=t;if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:i,coordinateSystem:s,_instanced:a}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:i,composeModelMatrix:!a||$3(n,s),flatShading:!this.state.hasNormals}).draw()}get isLoaded(){var t;return((t=this.state)===null||t===void 0?void 0:t.model)&&super.isLoaded}getModel(t){const e=new af(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:nF(t,this.props._useMeshColors),isInstanced:!0}),{texture:n}=this.props,{emptyTexture:i}=this.state;return e.setUniforms({sampler:n||i,hasTexture:!!n}),e}setTexture(t){const{emptyTexture:e,model:n}=this.state;n&&n.setUniforms({sampler:t||e,hasTexture:!!t})}}j(kw,"defaultProps",RX),j(kw,"layerName","SimpleMeshLayer");class vf{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:e}=t;this.id=e||ku(this.constructor.name),this.display=!0,this.position=new ie,this.rotation=new ie,this.scale=new ie(1,1,1),this.matrix=new xn,this.userData={},this.props={},this._setScenegraphNodeProps(t)}delete(){}setProps(t){return this._setScenegraphNodeProps(t),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}getBounds(){return null}setPosition(t){return rr(t.length===3,"setPosition requires vector argument"),this.position=t,this}setRotation(t){return rr(t.length===3,"setRotation requires vector argument"),this.rotation=t,this}setScale(t){return rr(t.length===3,"setScale requires vector argument"),this.scale=t,this}setMatrix(t){(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?this.matrix.copy(t):this.matrix=t}setMatrixComponents(t){let{position:e,rotation:n,scale:i,update:s=!0}=t;return e&&this.setPosition(e),n&&this.setRotation(n),i&&this.setScale(i),s&&this.updateMatrix(),this}updateMatrix(){const t=this.position,e=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(t),this.matrix.rotateXYZ(e),this.matrix.scale(n),this}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{position:e,rotation:n,scale:i}=t;return e&&this.setPosition(e),n&&this.setRotation(n),i&&this.setScale(i),this.updateMatrix(),this}getCoordinateUniforms(t,e){rr(t),e=e||this.matrix;const n=new xn(t).multiplyRight(e),i=n.invert(),s=i.transpose();return{viewMatrix:t,modelMatrix:e,objectMatrix:e,worldMatrix:n,worldInverseMatrix:i,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(t){"display"in t&&(this.display=t.display),"position"in t&&this.setPosition(t.position),"rotation"in t&&this.setRotation(t.rotation),"scale"in t&&this.setScale(t.scale),"matrix"in t&&this.setMatrix(t.matrix),Object.assign(this.props,t)}}class Rg extends vf{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t=Array.isArray(t)?{children:t}:t;const{children:e=[]}=t;br.assert(e.every(n=>n instanceof vf),"every child must an instance of ScenegraphNode"),super(t),this.children=e}add(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)Array.isArray(i)?this.add(...i):this.children.push(i);return this}remove(t){const e=this.children,n=e.indexOf(t);return n>-1&&e.splice(n,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(t=>t.delete()),this.removeAll(),super.delete()}getBounds(){const t=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse((e,n)=>{let{worldMatrix:i}=n;const s=e.getBounds();if(!s)return;const[a,o]=s,d=new ie(a).add(o).divide([2,2,2]);i.transformAsPoint(d,d);const f=new ie(o).subtract(a).divide([2,2,2]);i.transformAsVector(f,f);for(let _=0;_<8;_++){const w=new ie(_&1?-1:1,_&2?-1:1,_&4?-1:1).multiply(f).add(d);for(let x=0;x<3;x++)t[0][x]=Math.min(t[0][x],w[x]),t[1][x]=Math.max(t[1][x],w[x])}}),Number.isFinite(t[0][0])?t:null}traverse(t){let{worldMatrix:e=new xn}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=new xn(e).multiplyRight(this.matrix);for(const i of this.children)i instanceof Rg?i.traverse(t,{worldMatrix:n}):t(i,{worldMatrix:n})}}const UX={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},OX={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function iF(r){if(!r._animation){const t=OX[r.componentType],e=UX[r.type],n=e*r.count,{buffer:i,byteOffset:s}=r.bufferView.data,a=new t(i,s+(r.byteOffset||0),n);if(e===1)r._animation=Array.from(a);else{const o=[];for(let d=0;d<a.length;d+=e)o.push(Array.from(a.slice(d,d+e)));r._animation=o}}return r._animation}const DX=new xn;function NX(r,t){if(t.matrix.identity(),r.translation&&t.matrix.translate(r.translation),r.rotation){const e=DX.fromQuaternion(r.rotation);t.matrix.multiplyRight(e)}r.scale&&t.matrix.scale(r.scale)}const Qw=new _g;function kX(r,t,e,n,i){if(t==="rotation"){Qw.slerp({start:e,target:n,ratio:i});for(let s=0;s<Qw.length;s++)r[t][s]=Qw[s]}else for(let s=0;s<e.length;s++)r[t][s]=i*n[s]+(1-i)*e[s]}function QX(r,t,e){let{p0:n,outTangent0:i,inTangent1:s,p1:a,tDiff:o,ratio:d}=e;for(let f=0;f<r[t].length;f++){const _=i[f]*o,w=s[f]*o;r[t][f]=(2*Math.pow(d,3)-3*Math.pow(d,2)+1)*n[f]+(Math.pow(d,3)-2*Math.pow(d,2)+d)*_+(-2*Math.pow(d,3)+3*Math.pow(d,2))*a[f]+(Math.pow(d,3)-Math.pow(d,2))*w}}function zX(r,t,e){for(let n=0;n<e.length;n++)r[t][n]=e[n]}function HX(r,t,e,n){let{input:i,interpolation:s,output:a}=t;const o=i[i.length-1],d=r%o,f=i.findIndex(B=>B>=d),_=Math.max(0,f-1);if(!Array.isArray(e[n]))switch(n){case"translation":e[n]=[0,0,0];break;case"rotation":e[n]=[0,0,0,1];break;case"scale":e[n]=[1,1,1];break;default:br.warn("Bad animation path ".concat(n))()}rr(e[n].length===a[_].length);const w=i[_],x=i[f];switch(s){case"STEP":zX(e,n,a[_]);break;case"LINEAR":if(x>w){const B=(d-w)/(x-w);kX(e,n,a[_],a[f],B)}break;case"CUBICSPLINE":if(x>w){const B=(d-w)/(x-w),P=x-w,R=a[3*_+1],N=a[3*_+2],Q=a[3*f+0],V=a[3*f+1];QX(e,n,{p0:R,outTangent0:N,inTangent1:Q,p1:V,tDiff:P,ratio:B})}break;default:br.warn("Interpolation ".concat(s," not supported"))();break}}class VX{constructor(t){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,t)}animate(t){if(!this.playing)return;const n=(t/1e3-this.startTime)*this.speed;this.channels.forEach(i=>{let{sampler:s,target:a,path:o}=i;HX(n,s,a,o),NX(a,a._node)})}}class GX{constructor(t){this.animations=t.animations.map((e,n)=>{const i=e.name||"Animation-".concat(n),s=e.samplers.map(o=>{let{input:d,interpolation:f="LINEAR",output:_}=o;return{input:iF(t.accessors[d]),interpolation:f,output:iF(t.accessors[_])}}),a=e.channels.map(o=>{let{sampler:d,target:f}=o;return{sampler:s[d],target:t.nodes[f.node],path:f.path}});return new VX({name:i,channels:a})})}animate(t){this.setTime(t)}setTime(t){this.animations.forEach(e=>e.animate(t))}getAnimations(){return this.animations}}class jX extends vf{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),this.onBeforeRender=null,this.AfterRender=null,t instanceof af?(this.model=t,this._setModelNodeProps(e)):this.model=new af(t,e),this.bounds=null,this.managedResources=e.managedResources||[]}setProps(t){return super.setProps(t),this._setModelNodeProps(t),this}getBounds(){return this.bounds}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(t=>t.delete()),this.managedResources=[]}draw(){return this.model.draw(...arguments)}setUniforms(){return this.model.setUniforms(...arguments),this}setAttributes(){return this.model.setAttributes(...arguments),this}updateModuleSettings(){return this.model.updateModuleSettings(...arguments),this}_setModelNodeProps(t){this.model.setProps(t)}}class sF{constructor(t,e){let{attributes:n,material:i,pbrDebug:s,imageBasedLightingEnvironment:a,lights:o,useTangents:d}=e;this.gl=t,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},vb(t,fi.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],a&&(this.uniforms.u_DiffuseEnvSampler=a.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=a.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=a.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),s&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(n.NORMAL,"HAS_NORMALS"),this.defineIfPresent(n.TANGENT&&d,"HAS_TANGENTS"),this.defineIfPresent(n.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(a,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(s,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(t,e){t&&(this.defines[e]=1)}parseTexture(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=t.texture&&t.texture.sampler&&t.texture.sampler.parameters||{},s=t.texture.source.image;let a,o={};s.compressed?(a=s,o={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):a={data:s};const d=new Ua(this.gl,{id:t.name||t.id,parameters:{...i,...o},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...a});this.uniforms[e]=d,this.defineIfPresent(n,n),this.generatedTextures.push(d)}parsePbrMetallicRoughness(t){t.baseColorTexture&&this.parseTexture(t.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=t.baseColorFactor||[1,1,1,1],t.metallicRoughnessTexture&&this.parseTexture(t.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:e=1,roughnessFactor:n=1}=t;this.uniforms.u_MetallicRoughnessValues=[e,n]}parseMaterial(t){if(this.uniforms.pbr_uUnlit=!!t.unlit,t.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(t.pbrMetallicRoughness),t.normalTexture){this.parseTexture(t.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:e=1}=t.normalTexture;this.uniforms.u_NormalScale=e}if(t.occlusionTexture){this.parseTexture(t.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:e=1}=t.occlusionTexture;this.uniforms.u_OcclusionStrength=e}if(t.emissiveTexture&&(this.parseTexture(t.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=t.emissiveFactor||[0,0,0]),t.alphaMode==="MASK"){const{alphaCutoff:e=.5}=t;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=e}else t.alphaMode==="BLEND"&&(br.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}delete(){this.generatedTextures.forEach(t=>t.delete())}}const qX=`
#if (__VERSION__ < 300)
  #define _attr attribute
#else
  #define _attr in
#endif

  _attr vec4 POSITION;

  #ifdef HAS_NORMALS
    _attr vec4 NORMAL;
  #endif

  #ifdef HAS_TANGENTS
    _attr vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    _attr vec2 TEXCOORD_0;
  #endif

  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = NORMAL;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = TEXCOORD_0;
    #endif

    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = u_MVPMatrix * POSITION;
  }
`,KX=`
#if (__VERSION__ < 300)
  #define fragmentColor gl_FragColor
#else
  out vec4 fragmentColor;
#endif

  void main(void) {
    fragmentColor = pbr_filterColor(vec4(0));
  }
`;function oF(r,t){return mn(r)?`#version 300 es
`.concat(t):t}function $X(r,t){const{id:e,drawMode:n,vertexCount:i,attributes:s,modelOptions:a}=t,o=new sF(r,t);br.info(4,"createGLTFModel defines: ",o.defines)();const d=[];d.push(...o.generatedTextures),d.push(...Object.values(s).map(_=>_.buffer));const f=new jX(r,{id:e,drawMode:n,vertexCount:i,modules:[Xb],parameters:o.parameters,vs:oF(r,qX),fs:oF(r,KX),managedResources:d,...a,defines:{...o.defines,...a.defines}});return f.setProps({attributes:s}),f.setUniforms(o.uniforms),f}const WX={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},XX={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class JX{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=t,this.options=Object.assign({},XX,e)}instantiate(t){return this.gltf=t,(t.scenes||[]).map(n=>this.createScene(n))}createAnimator(){return Array.isArray(this.gltf.animations)?new GX(this.gltf):null}createScene(t){const n=(t.nodes||[]).map(s=>this.createNode(s));return new Rg({id:t.name||t.id,children:n})}createNode(t){if(!t._node){const n=(t.children||[]).map(s=>this.createNode(s));t.mesh&&n.push(this.createMesh(t.mesh));const i=new Rg({id:t.name||t.id,children:n});if(t.matrix)i.setMatrix(t.matrix);else{if(i.matrix.identity(),t.translation&&i.matrix.translate(t.translation),t.rotation){const s=new xn().fromQuaternion(t.rotation);i.matrix.multiplyRight(s)}t.scale&&i.matrix.scale(t.scale)}t._node=i}return t._node}createMesh(t){if(!t._mesh){const n=(t.primitives||[]).map((s,a)=>this.createPrimitive(s,a,t)),i=new Rg({id:t.name||t.id,children:n});t._mesh=i}return t._mesh}getVertexCount(t){br.warn("getVertexCount() not found")()}createPrimitive(t,e,n){const i=$X(this.gl,Object.assign({id:t.name||"".concat(n.name||n.id,"-primitive-").concat(e),drawMode:t.mode||4,vertexCount:t.indices?t.indices.count:this.getVertexCount(t.attributes),attributes:this.createAttributes(t.attributes,t.indices),material:t.material},this.options));return i.bounds=[t.attributes.POSITION.min,t.attributes.POSITION.max],i}createAttributes(t,e){const n={};return Object.keys(t).forEach(i=>{n[i]=this.createAccessor(t[i],this.createBuffer(t[i],this.gl.ARRAY_BUFFER))}),e&&(n.indices=this.createAccessor(e,this.createBuffer(e,this.gl.ELEMENT_ARRAY_BUFFER))),br.info(4,"glTF Attributes",{attributes:t,indices:e,generated:n})(),n}createBuffer(t,e){t.bufferView||(t.bufferView={});const{bufferView:n}=t;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[e]||(n.lumaBuffers[e]=new ni(this.gl,{id:"from-".concat(n.id),data:n.data||t.value,target:e})),n.lumaBuffers[e]}createAccessor(t,e){return new ca({buffer:e,offset:t.byteOffset||0,stride:t.bufferView.byteStride||0,type:t.componentType,size:WX[t.type]})}createSampler(t){return t}needsPOT(){return!1}}function YX(r,t,e){const n=new JX(r,e),i=n.instantiate(t),s=n.createAnimator();return{scenes:i,animator:s}}const ZX="3.4.15",tJ="3.4.15",aF="3.4.15",eJ="https://unpkg.com/@loaders.gl/textures@".concat(aF,"/dist/libs/basis_encoder.wasm"),rJ="https://unpkg.com/@loaders.gl/textures@".concat(aF,"/dist/libs/basis_encoder.js");let zw;async function lF(r){const t=r.modules||{};return t.basis?t.basis:(zw=zw||nJ(r),await zw)}async function nJ(r){let t=null,e=null;return[t,e]=await Promise.all([await Rh("basis_transcoder.js","textures",r),await Rh("basis_transcoder.wasm","textures",r)]),t=t||globalThis.BASIS,await iJ(t,e)}function iJ(r,t){const e={};return t&&(e.wasmBinary=t),new Promise(n=>{r(e).then(i=>{const{BasisFile:s,initializeBasis:a}=i;a(),n({BasisFile:s})})})}let Hw;async function cF(r){const t=r.modules||{};return t.basisEncoder?t.basisEncoder:(Hw=Hw||sJ(r),await Hw)}async function sJ(r){let t=null,e=null;return[t,e]=await Promise.all([await Rh(rJ,"textures",r),await Rh(eJ,"textures",r)]),t=t||globalThis.BASIS,await oJ(t,e)}function oJ(r,t){const e={};return t&&(e.wasmBinary=t),new Promise(n=>{r(e).then(i=>{const{BasisFile:s,KTX2File:a,initializeBasis:o,BasisEncoder:d}=i;o(),n({BasisFile:s,KTX2File:a,BasisEncoder:d})})})}const bf={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919},aJ=["","WEBKIT_","MOZ_"],uF={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let vy=null;function lJ(r){if(!vy){r=r||cJ()||void 0,vy=new Set;for(const t of aJ)for(const e in uF)if(r&&r.getExtension("".concat(t).concat(e))){const n=uF[e];vy.add(n)}}return vy}function cJ(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}var AF,hF,dF,fF,pF,gF,mF,yF;(function(r){r[r.NONE=0]="NONE",r[r.BASISLZ=1]="BASISLZ",r[r.ZSTD=2]="ZSTD",r[r.ZLIB=3]="ZLIB"})(AF||(AF={})),function(r){r[r.BASICFORMAT=0]="BASICFORMAT"}(hF||(hF={})),function(r){r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.ETC1S=163]="ETC1S",r[r.UASTC=166]="UASTC"}(dF||(dF={})),function(r){r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.SRGB=1]="SRGB"}(fF||(fF={})),function(r){r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.LINEAR=1]="LINEAR",r[r.SRGB=2]="SRGB",r[r.ITU=3]="ITU",r[r.NTSC=4]="NTSC",r[r.SLOG=5]="SLOG",r[r.SLOG2=6]="SLOG2"}(pF||(pF={})),function(r){r[r.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",r[r.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(gF||(gF={})),function(r){r[r.RGB=0]="RGB",r[r.RRR=3]="RRR",r[r.GGG=4]="GGG",r[r.AAA=15]="AAA"}(mF||(mF={})),function(r){r[r.RGB=0]="RGB",r[r.RGBA=3]="RGBA",r[r.RRR=4]="RRR",r[r.RRRG=5]="RRRG"}(yF||(yF={}));const Qa=[171,75,84,88,32,50,48,187,13,10,26,10];function uJ(r){const t=new Uint8Array(r);return!(t.byteLength<Qa.length||t[0]!==Qa[0]||t[1]!==Qa[1]||t[2]!==Qa[2]||t[3]!==Qa[3]||t[4]!==Qa[4]||t[5]!==Qa[5]||t[6]!==Qa[6]||t[7]!==Qa[7]||t[8]!==Qa[8]||t[9]!==Qa[9]||t[10]!==Qa[10]||t[11]!==Qa[11])}const AJ={etc1:{basisFormat:0,compressed:!0,format:bf.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:bf.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:bf.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:bf.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:bf.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:bf.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function hJ(r,t){if(t.basis.containerFormat==="auto"){if(uJ(r)){const n=await cF(t);return _F(n.KTX2File,r,t)}const{BasisFile:e}=await lF(t);return Vw(e,r,t)}switch(t.basis.module){case"encoder":const e=await cF(t);switch(t.basis.containerFormat){case"ktx2":return _F(e.KTX2File,r,t);case"basis":default:return Vw(e.BasisFile,r,t)}case"transcoder":default:const{BasisFile:n}=await lF(t);return Vw(n,r,t)}}function Vw(r,t,e){const n=new r(new Uint8Array(t));try{if(!n.startTranscoding())throw new Error("Failed to start basis transcoding");const i=n.getNumImages(),s=[];for(let a=0;a<i;a++){const o=n.getNumLevels(a),d=[];for(let f=0;f<o;f++)d.push(dJ(n,a,f,e));s.push(d)}return s}finally{n.close(),n.delete()}}function dJ(r,t,e,n){const i=r.getImageWidth(t,e),s=r.getImageHeight(t,e),a=r.getHasAlpha(),{compressed:o,format:d,basisFormat:f}=vF(n,a),_=r.getImageTranscodedSizeInBytes(t,e,f),w=new Uint8Array(_);if(!r.transcodeImage(w,t,e,f,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:s,data:w,compressed:o,format:d,hasAlpha:a}}function _F(r,t,e){const n=new r(new Uint8Array(t));try{if(!n.startTranscoding())throw new Error("failed to start KTX2 transcoding");const i=n.getLevels(),s=[];for(let a=0;a<i;a++){s.push(fJ(n,a,e));break}return[s]}finally{n.close(),n.delete()}}function fJ(r,t,e){const{alphaFlag:n,height:i,width:s}=r.getImageLevelInfo(t,0,0),{compressed:a,format:o,basisFormat:d}=vF(e,n),f=r.getImageTranscodedSizeInBytes(t,0,0,d),_=new Uint8Array(f);if(!r.transcodeImage(_,t,0,0,d,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:s,height:i,data:_,compressed:a,levelSize:f,hasAlpha:n,format:o}}function vF(r,t){let e=r&&r.basis&&r.basis.format;return e==="auto"&&(e=bF()),typeof e=="object"&&(e=t?e.alpha:e.noAlpha),e=e.toLowerCase(),AJ[e]}function bF(){const r=lJ();return r.has("astc")?"astc-4x4":r.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:r.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:r.has("etc1")?"etc1":r.has("etc2")?"etc2":"rgb565"}const pJ={...{name:"Basis",id:Uu?"basis":"basis-nodejs",module:"textures",version:tJ,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},parse:hJ};function za(r,t){if(!r)throw new Error(t||"assert failed: gltf")}function wF(r,t){if(r.startsWith("data:")||r.startsWith("http:")||r.startsWith("https:"))return r;const n=t.baseUri||t.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url ".concat(r));return n.substr(0,n.lastIndexOf("/")+1)+r}function gJ(r,t,e){const n=r.bufferViews[e];za(n);const i=n.buffer,s=t[i];za(s);const a=(n.byteOffset||0)+s.byteOffset;return new Uint8Array(s.arrayBuffer,a,n.byteLength)}const xF=["SCALAR","VEC2","VEC3","VEC4"],mJ=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],yJ=new Map(mJ),_J={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},vJ={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},bJ={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function BF(r){return xF[r-1]||xF[0]}function CF(r){const t=yJ.get(r.constructor);if(!t)throw new Error("Illegal typed array");return t}function Gw(r,t){const e=bJ[r.componentType],n=_J[r.type],i=vJ[r.componentType],s=r.count*n,a=r.count*n*i;return za(a>=0&&a<=t.byteLength),{ArrayType:e,length:s,byteLength:a}}function EF(r){let{images:t,bufferViews:e}=r;t=t||[],e=e||[];const n=t.map(a=>a.bufferView);e=e.filter(a=>!n.includes(a));const i=e.reduce((a,o)=>a+o.byteLength,0),s=t.reduce((a,o)=>{const{width:d,height:f}=o.image;return a+d*f},0);return i+Math.ceil(4*s*1.33)}const wJ={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class ua{constructor(t){j(this,"gltf",void 0),j(this,"sourceBuffers",void 0),j(this,"byteLength",void 0),this.gltf=t||{json:{...wJ},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(t){return this.json[t]}getExtraData(t){return(this.json.extras||{})[t]}getExtension(t){const e=this.getUsedExtensions().find(i=>i===t),n=this.json.extensions||{};return e?n[t]||!0:null}getRequiredExtension(t){return this.getRequiredExtensions().find(n=>n===t)?this.getExtension(t):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(t,e){return(t.extensions||{})[e]}getScene(t){return this.getObject("scenes",t)}getNode(t){return this.getObject("nodes",t)}getSkin(t){return this.getObject("skins",t)}getMesh(t){return this.getObject("meshes",t)}getMaterial(t){return this.getObject("materials",t)}getAccessor(t){return this.getObject("accessors",t)}getTexture(t){return this.getObject("textures",t)}getSampler(t){return this.getObject("samplers",t)}getImage(t){return this.getObject("images",t)}getBufferView(t){return this.getObject("bufferViews",t)}getBuffer(t){return this.getObject("buffers",t)}getObject(t,e){if(typeof e=="object")return e;const n=this.json[t]&&this.json[t][e];if(!n)throw new Error("glTF file error: Could not find ".concat(t,"[").concat(e,"]"));return n}getTypedArrayForBufferView(t){t=this.getBufferView(t);const e=t.buffer,n=this.gltf.buffers[e];za(n);const i=(t.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,i,t.byteLength)}getTypedArrayForAccessor(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),i=this.getBuffer(e.buffer).data,{ArrayType:s,length:a}=Gw(t,e),o=e.byteOffset+t.byteOffset;return new s(i,o,a)}getTypedArrayForImageData(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),i=this.getBuffer(e.buffer).data,s=e.byteOffset||0;return new Uint8Array(i,s,e.byteLength)}addApplicationData(t,e){return this.json[t]=e,this}addExtraData(t,e){return this.json.extras=this.json.extras||{},this.json.extras[t]=e,this}addObjectExtension(t,e,n){return t.extensions=t.extensions||{},t.extensions[e]=n,this.registerUsedExtension(e),this}setObjectExtension(t,e,n){const i=t.extensions||{};i[e]=n}removeObjectExtension(t,e){const n=t.extensions||{},i=n[e];return delete n[e],i}addExtension(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return za(e),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=e,this.registerUsedExtension(t),e}addRequiredExtension(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return za(e),this.addExtension(t,e),this.registerRequiredExtension(t),e}registerUsedExtension(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(e=>e===t)||this.json.extensionsUsed.push(t)}registerRequiredExtension(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(e=>e===t)||this.json.extensionsRequired.push(t)}removeExtension(t){if(!this.getExtension(t))return;this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t),this.json.extensions&&delete this.json.extensions[t],Array.isArray(this.json.extensionsRemoved)||(this.json.extensionsRemoved=[]);const e=this.json.extensionsRemoved;e.includes(t)||e.push(t)}setDefaultScene(t){this.json.scene=t}addScene(t){const{nodeIndices:e}=t;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:e}),this.json.scenes.length-1}addNode(t){const{meshIndex:e,matrix:n}=t;this.json.nodes=this.json.nodes||[];const i={mesh:e};return n&&(i.matrix=n),this.json.nodes.push(i),this.json.nodes.length-1}addMesh(t){const{attributes:e,indices:n,material:i,mode:s=4}=t,o={primitives:[{attributes:this._addAttributes(e),mode:s}]};if(n){const d=this._addIndices(n);o.primitives[0].indices=d}return Number.isFinite(i)&&(o.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(o),this.json.meshes.length-1}addPointCloud(t){const n={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(n),this.json.meshes.length-1}addImage(t,e){const n=rb(t),i=e||(n==null?void 0:n.mimeType),a={bufferView:this.addBufferView(t),mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(a),this.json.images.length-1}addBufferView(t){const e=t.byteLength;za(Number.isFinite(e)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);const n={buffer:0,byteOffset:this.byteLength,byteLength:e};return this.byteLength+=Jp(e,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1}addAccessor(t,e){const n={bufferView:t,type:BF(e.size),componentType:e.componentType,count:e.count,max:e.max,min:e.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}addBinaryBuffer(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{size:3};const n=this.addBufferView(t);let i={min:e.min,max:e.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(t,e.size));const s={size:e.size,componentType:CF(t),count:Math.round(t.length/e.size),min:i.min,max:i.max};return this.addAccessor(n,Object.assign(s,e))}addTexture(t){const{imageIndex:e}=t,n={source:e};return this.json.textures=this.json.textures||[],this.json.textures.push(n),this.json.textures.length-1}addMaterial(t){return this.json.materials=this.json.materials||[],this.json.materials.push(t),this.json.materials.length-1}createBinaryChunk(){var t,e;this.gltf.buffers=[];const n=this.byteLength,i=new ArrayBuffer(n),s=new Uint8Array(i);let a=0;for(const o of this.sourceBuffers||[])a=aQ(o,s,a);(t=this.json)!==null&&t!==void 0&&(e=t.buffers)!==null&&e!==void 0&&e[0]?this.json.buffers[0].byteLength=n:this.json.buffers=[{byteLength:n}],this.gltf.binary=i,this.sourceBuffers=[i]}_removeStringFromArray(t,e){let n=!0;for(;n;){const i=t.indexOf(e);i>-1?t.splice(i,1):n=!1}}_addAttributes(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e={};for(const n in t){const i=t[n],s=this._getGltfAttributeName(n),a=this.addBinaryBuffer(i.value,i);e[s]=a}return e}_addIndices(t){return this.addBinaryBuffer(t,{size:1})}_getGltfAttributeName(t){switch(t.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return t}}_getAccessorMinMax(t,e){const n={min:null,max:null};if(t.length<e)return n;n.min=[],n.max=[];const i=t.subarray(0,e);for(const s of i)n.min.push(s),n.max.push(s);for(let s=e;s<t.length;s+=e)for(let a=0;a<e;a++)n.min[0+a]=Math.min(n.min[0+a],t[s+a]),n.max[0+a]=Math.max(n.max[0+a],t[s+a]);return n}}const xJ="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",BJ="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",CJ=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),EJ=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),SJ={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},TJ={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function IJ(r,t,e,n,i){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"NONE";const a=await FJ();MJ(a,a.exports[TJ[i]],r,t,e,n,a.exports[SJ[s||"NONE"]])}let jw;async function FJ(){return jw||(jw=LJ()),jw}async function LJ(){let r=xJ;WebAssembly.validate(CJ)&&(r=BJ,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const t=await WebAssembly.instantiate(PJ(r),{});return await t.instance.exports.__wasm_call_ctors(),t.instance}function PJ(r){const t=new Uint8Array(r.length);for(let n=0;n<r.length;++n){const i=r.charCodeAt(n);t[n]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let e=0;for(let n=0;n<r.length;++n)t[e++]=t[n]<60?EJ[t[n]]:(t[n]-60)*64+t[++n];return t.buffer.slice(0,e)}function MJ(r,t,e,n,i,s,a){const o=r.exports.sbrk,d=n+3&-4,f=o(d*i),_=o(s.length),w=new Uint8Array(r.exports.memory.buffer);w.set(s,_);const x=t(f,n,i,_,s.length);if(x===0&&a&&a(f,d,i),e.set(w.subarray(f,f+n*i)),o(f-o(0)),x!==0)throw new Error("Malformed buffer data: ".concat(x))}const qw="EXT_meshopt_compression",RJ=qw;async function UJ(r,t){var e;const n=new ua(r);if(!(t!=null&&(e=t.gltf)!==null&&e!==void 0&&e.decompressMeshes))return;const i=[];for(const s of r.json.bufferViews||[])i.push(OJ(n,s));await Promise.all(i),n.removeExtension(qw)}async function OJ(r,t){const e=r.getObjectExtension(t,qw);if(e){const{byteOffset:n=0,byteLength:i=0,byteStride:s,count:a,mode:o,filter:d="NONE",buffer:f}=e,_=r.gltf.buffers[f],w=new Uint8Array(_.arrayBuffer,_.byteOffset+n,i),x=new Uint8Array(r.gltf.buffers[t.buffer].arrayBuffer,t.byteOffset,t.byteLength);return await IJ(x,a,s,w,o,d),x}return null}const DJ=Object.freeze(Object.defineProperty({__proto__:null,decode:UJ,name:RJ},Symbol.toStringTag,{value:"Module"})),wf="EXT_texture_webp",NJ=wf;function kJ(r,t){const e=new ua(r);if(!tH("image/webp")){if(e.getRequiredExtensions().includes(wf))throw new Error("gltf: Required extension ".concat(wf," not supported by browser"));return}const{json:n}=e;for(const i of n.textures||[]){const s=e.getObjectExtension(i,wf);s&&(i.source=s.source),e.removeObjectExtension(i,wf)}e.removeExtension(wf)}const QJ=Object.freeze(Object.defineProperty({__proto__:null,name:NJ,preprocess:kJ},Symbol.toStringTag,{value:"Module"})),by="KHR_texture_basisu",zJ=by;function HJ(r,t){const e=new ua(r),{json:n}=e;for(const i of n.textures||[]){const s=e.getObjectExtension(i,by);s&&(i.source=s.source),e.removeObjectExtension(i,by)}e.removeExtension(by)}const VJ=Object.freeze(Object.defineProperty({__proto__:null,name:zJ,preprocess:HJ},Symbol.toStringTag,{value:"Module"})),GJ={name:"Draco",id:Uu?"draco":"draco-nodejs",module:"draco",shapes:["mesh"],version:"3.4.15",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};function jJ(r,t,e){const n=TF(t.metadata),i=[],s=qJ(t.attributes);for(const a in r){const o=r[a],d=SF(a,o,s[a]);i.push(d)}if(e){const a=SF("indices",e);i.push(a)}return new yf(i,n)}function qJ(r){const t={};for(const e in r){const n=r[e];t[n.name||"undefined"]=n}return t}function SF(r,t,e){const n=e?TF(e.metadata):void 0;return PX(r,t,n)}function TF(r){const t=new Map;for(const e in r)t.set("".concat(e,".string"),JSON.stringify(r[e]));return t}const IF={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},KJ={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},$J=4;class WJ{constructor(t){j(this,"draco",void 0),j(this,"decoder",void 0),j(this,"metadataQuerier",void 0),this.draco=t,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=new this.draco.DecoderBuffer;n.Init(new Int8Array(t),t.byteLength),this._disableAttributeTransforms(e);const i=this.decoder.GetEncodedGeometryType(n),s=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let a;switch(i){case this.draco.TRIANGULAR_MESH:a=this.decoder.DecodeBufferToMesh(n,s);break;case this.draco.POINT_CLOUD:a=this.decoder.DecodeBufferToPointCloud(n,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!a.ok()||!s.ptr){const x="DRACO decompression failed: ".concat(a.error_msg());throw new Error(x)}const o=this._getDracoLoaderData(s,i,e),d=this._getMeshData(s,o,e),f=W3(d.attributes),_=jJ(d.attributes,o,d.indices);return{loader:"draco",loaderData:o,header:{vertexCount:s.num_points(),boundingBox:f},...d,schema:_}}finally{this.draco.destroy(n),s&&this.draco.destroy(s)}}_getDracoLoaderData(t,e,n){const i=this._getTopLevelMetadata(t),s=this._getDracoAttributes(t,n);return{geometry_type:e,num_attributes:t.num_attributes(),num_points:t.num_points(),num_faces:t instanceof this.draco.Mesh?t.num_faces():0,metadata:i,attributes:s}}_getDracoAttributes(t,e){const n={};for(let i=0;i<t.num_attributes();i++){const s=this.decoder.GetAttribute(t,i),a=this._getAttributeMetadata(t,i);n[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:i,metadata:a};const o=this._getQuantizationTransform(s,e);o&&(n[s.unique_id()].quantization_transform=o);const d=this._getOctahedronTransform(s,e);d&&(n[s.unique_id()].octahedron_transform=d)}return n}_getMeshData(t,e,n){const i=this._getMeshAttributes(e,t,n);if(!i.POSITION)throw new Error("DRACO: No position attribute found.");if(t instanceof this.draco.Mesh)switch(n.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(t),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(t),size:1}}}return{topology:"point-list",mode:0,attributes:i}}_getMeshAttributes(t,e,n){const i={};for(const s of Object.values(t.attributes)){const a=this._deduceAttributeName(s,n);s.name=a;const{value:o,size:d}=this._getAttributeValues(e,s);i[a]={value:o,size:d,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return i}_getTriangleListIndices(t){const n=t.num_faces()*3,i=n*$J,s=this.draco._malloc(i);try{return this.decoder.GetTrianglesUInt32Array(t,i,s),new Uint32Array(this.draco.HEAPF32.buffer,s,n).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(t){const e=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(t,e),YJ(e)}finally{this.draco.destroy(e)}}_getAttributeValues(t,e){const n=KJ[e.data_type],i=e.num_components,a=t.num_points()*i,o=a*n.BYTES_PER_ELEMENT,d=XJ(this.draco,n);let f;const _=this.draco._malloc(o);try{const w=this.decoder.GetAttribute(t,e.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(t,w,d,o,_),f=new n(this.draco.HEAPF32.buffer,_,a).slice()}finally{this.draco._free(_)}return{value:f,size:i}}_deduceAttributeName(t,e){const n=t.unique_id;for(const[a,o]of Object.entries(e.extraAttributes||{}))if(o===n)return a;const i=t.attribute_type;for(const a in IF)if(this.draco[a]===i)return IF[a];const s=e.attributeNameEntry||"name";return t.metadata[s]?t.metadata[s].string:"CUSTOM_ATTRIBUTE_".concat(n)}_getTopLevelMetadata(t){const e=this.decoder.GetMetadata(t);return this._getDracoMetadata(e)}_getAttributeMetadata(t,e){const n=this.decoder.GetAttributeMetadata(t,e);return this._getDracoMetadata(n)}_getDracoMetadata(t){if(!t||!t.ptr)return{};const e={},n=this.metadataQuerier.NumEntries(t);for(let i=0;i<n;i++){const s=this.metadataQuerier.GetEntryName(t,i);e[s]=this._getDracoMetadataField(t,s)}return e}_getDracoMetadataField(t,e){const n=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(t,e,n);const i=JJ(n);return{int:this.metadataQuerier.GetIntEntry(t,e),string:this.metadataQuerier.GetStringEntry(t,e),double:this.metadataQuerier.GetDoubleEntry(t,e),intArray:i}}finally{this.draco.destroy(n)}}_disableAttributeTransforms(t){const{quantizedAttributes:e=[],octahedronAttributes:n=[]}=t,i=[...e,...n];for(const s of i)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(t,e){const{quantizedAttributes:n=[]}=e,i=t.attribute_type();if(n.map(a=>this.decoder[a]).includes(i)){const a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(t))return{quantization_bits:a.quantization_bits(),range:a.range(),min_values:new Float32Array([1,2,3]).map(o=>a.min_value(o))}}finally{this.draco.destroy(a)}}return null}_getOctahedronTransform(t,e){const{octahedronAttributes:n=[]}=e,i=t.attribute_type();if(n.map(a=>this.decoder[a]).includes(i)){const a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(t))return{quantization_bits:a.quantization_bits()}}finally{this.draco.destroy(a)}}return null}}function XJ(r,t){switch(t){case Float32Array:return r.DT_FLOAT32;case Int8Array:return r.DT_INT8;case Int16Array:return r.DT_INT16;case Int32Array:return r.DT_INT32;case Uint8Array:return r.DT_UINT8;case Uint16Array:return r.DT_UINT16;case Uint32Array:return r.DT_UINT32;default:return r.DT_INVALID}}function JJ(r){const t=r.size(),e=new Int32Array(t);for(let n=0;n<t;n++)e[n]=r.GetValue(n);return e}function YJ(r){const t=r.size(),e=new Int32Array(t);for(let n=0;n<t;n++)e[n]=r.GetValue(n);return e}const Kw="https://www.gstatic.com/draco/versioned/decoders/".concat("1.5.5"),ZJ="".concat(Kw,"/draco_decoder.js"),tY="".concat(Kw,"/draco_wasm_wrapper.js"),eY="".concat(Kw,"/draco_decoder.wasm");let Ug;async function rY(r){const t=r.modules||{};return t.draco3d?Ug=Ug||t.draco3d.createDecoderModule({}).then(e=>({draco:e})):Ug=Ug||nY(r),await Ug}async function nY(r){let t,e;switch(r.draco&&r.draco.decoderType){case"js":t=await Rh(ZJ,"draco",r);break;case"wasm":default:[t,e]=await Promise.all([await Rh(tY,"draco",r),await Rh(eY,"draco",r)])}return t=t||globalThis.DracoDecoderModule,await iY(t,e)}function iY(r,t){const e={};return t&&(e.wasmBinary=t),new Promise(n=>{r({...e,onModuleLoaded:i=>n({draco:i})})})}const FF={...GJ,parse:sY};async function sY(r,t){const{draco:e}=await rY(t),n=new WJ(e);try{return n.parseSync(r,t==null?void 0:t.draco)}finally{n.destroy()}}function oY(r){const t={};for(const e in r){const n=r[e];if(e!=="indices"){const i=LF(n);t[e]=i}}return t}function LF(r){const{buffer:t,size:e,count:n}=aY(r);return{value:t,size:e,byteOffset:0,count:n,type:BF(e),componentType:CF(t)}}function aY(r){let t=r,e=1,n=0;return r&&r.value&&(t=r.value,e=r.size||1),t&&(ArrayBuffer.isView(t)||(t=lY(t,Float32Array)),n=t.length/e),{buffer:t,size:e,count:n}}function lY(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return r?Array.isArray(r)?new t(r):e&&!(r instanceof t)?new t(r):r:null}const qh="KHR_draco_mesh_compression",cY=qh;function uY(r,t,e){const n=new ua(r);for(const i of PF(n))n.getObjectExtension(i,qh)}async function AY(r,t,e){var n;if(!(t!=null&&(n=t.gltf)!==null&&n!==void 0&&n.decompressMeshes))return;const i=new ua(r),s=[];for(const a of PF(i))i.getObjectExtension(a,qh)&&s.push(dY(i,a,t,e));await Promise.all(s),i.removeExtension(qh)}function hY(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e=new ua(r);for(const n of e.json.meshes||[])fY(n,t),e.addRequiredExtension(qh)}async function dY(r,t,e,n){const i=r.getObjectExtension(t,qh);if(!i)return;const s=r.getTypedArrayForBufferView(i.bufferView),a=zv(s.buffer,s.byteOffset),{parse:o}=n,d={...e};delete d["3d-tiles"];const f=await o(a,FF,d,n),_=oY(f.attributes);for(const[w,x]of Object.entries(_))if(w in t.attributes){const B=t.attributes[w],P=r.getAccessor(B);P!=null&&P.min&&P!==null&&P!==void 0&&P.max&&(x.min=P.min,x.max=P.max)}t.attributes=_,f.indices&&(t.indices=LF(f.indices)),pY(t)}function fY(r,t){var e;let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:4,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const a=i.DracoWriter.encodeSync({attributes:r}),o=s==null||(e=s.parseSync)===null||e===void 0?void 0:e.call(s,{attributes:r}),d=i._addFauxAttributes(o.attributes),f=i.addBufferView(a);return{primitives:[{attributes:d,mode:n,extensions:{[qh]:{bufferView:f,attributes:d}}}]}}function pY(r){if(!r.attributes&&Object.keys(r.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*PF(r){for(const t of r.json.meshes||[])for(const e of t.primitives)yield e}const gY=Object.freeze(Object.defineProperty({__proto__:null,decode:AY,encode:hY,name:cY,preprocess:uY},Symbol.toStringTag,{value:"Module"})),mY={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},yY={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},$w="KHR_texture_transform",_Y=$w,wy=new ie,vY=new Oi,bY=new Oi;async function wY(r,t){if(!new ua(r).getExtension($w))return;const i=r.json.materials||[];for(let s=0;s<i.length;s++)xY(s,r)}function xY(r,t){var e,n,i;const s=[],a=(e=t.json.materials)===null||e===void 0?void 0:e[r],o=a==null||(n=a.pbrMetallicRoughness)===null||n===void 0?void 0:n.baseColorTexture;o&&Og(t,r,o,s);const d=a==null?void 0:a.emissiveTexture;d&&Og(t,r,d,s);const f=a==null?void 0:a.normalTexture;f&&Og(t,r,f,s);const _=a==null?void 0:a.occlusionTexture;_&&Og(t,r,_,s);const w=a==null||(i=a.pbrMetallicRoughness)===null||i===void 0?void 0:i.metallicRoughnessTexture;w&&Og(t,r,w,s)}function Og(r,t,e,n){const i=BY(e,n);if(!i)return;const s=r.json.meshes||[];for(const a of s)for(const o of a.primitives){const d=o.material;Number.isFinite(d)&&t===d&&CY(r,o,i)}}function BY(r,t){var e;const n=(e=r.extensions)===null||e===void 0?void 0:e[$w],{texCoord:i=0}=r,{texCoord:s=i}=n;if(!(t.findIndex(o=>{let[d,f]=o;return d===i&&f===s})!==-1)){const o=TY(n);return i!==s&&(r.texCoord=s),t.push([i,s]),{originalTexCoord:i,texCoord:s,matrix:o}}return null}function CY(r,t,e){const{originalTexCoord:n,texCoord:i,matrix:s}=e,a=t.attributes["TEXCOORD_".concat(n)];if(Number.isFinite(a)){var o;const f=(o=r.json.accessors)===null||o===void 0?void 0:o[a];if(f&&f.bufferView){var d;const _=(d=r.json.bufferViews)===null||d===void 0?void 0:d[f.bufferView];if(_){const{arrayBuffer:w,byteOffset:x}=r.buffers[_.buffer],B=(x||0)+(f.byteOffset||0)+(_.byteOffset||0),{ArrayType:P,length:R}=Gw(f,_),N=yY[f.componentType],Q=mY[f.type],V=_.byteStride||N*Q,W=new Float32Array(R);for(let et=0;et<f.count;et++){const ct=new P(w,B+et*V,2);wy.set(ct[0],ct[1],1),wy.transformByMatrix3(s),W.set([wy[0],wy[1]],et*Q)}n===i?EY(f,_,r.buffers,W):SY(i,f,t,r,W)}}}}function EY(r,t,e,n){r.componentType=5126,e.push({arrayBuffer:n.buffer,byteOffset:0,byteLength:n.buffer.byteLength}),t.buffer=e.length-1,t.byteLength=n.buffer.byteLength,t.byteOffset=0,delete t.byteStride}function SY(r,t,e,n,i){n.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});const s=n.json.bufferViews;if(!s)return;s.push({buffer:n.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});const a=n.json.accessors;a&&(a.push({bufferView:(s==null?void 0:s.length)-1,byteOffset:0,componentType:5126,count:t.count,type:"VEC2"}),e.attributes["TEXCOORD_".concat(r)]=a.length-1)}function TY(r){const{offset:t=[0,0],rotation:e=0,scale:n=[1,1]}=r,i=new Oi().set(1,0,0,0,1,0,t[0],t[1],1),s=vY.set(Math.cos(e),Math.sin(e),0,-Math.sin(e),Math.cos(e),0,0,0,1),a=bY.set(n[0],0,0,0,n[1],0,0,0,1);return i.multiplyRight(s).multiplyRight(a)}const IY=Object.freeze(Object.defineProperty({__proto__:null,decode:wY,name:_Y},Symbol.toStringTag,{value:"Module"})),Kh="KHR_lights_punctual",FY=Kh;async function LY(r){const t=new ua(r),{json:e}=t,n=t.getExtension(Kh);n&&(t.json.lights=n.lights,t.removeExtension(Kh));for(const i of e.nodes||[]){const s=t.getObjectExtension(i,Kh);s&&(i.light=s.light),t.removeObjectExtension(i,Kh)}}async function PY(r){const t=new ua(r),{json:e}=t;if(e.lights){const n=t.addExtension(Kh);za(!n.lights),n.lights=e.lights,delete e.lights}if(t.json.lights){for(const n of t.json.lights){const i=n.node;t.addObjectExtension(i,Kh,n)}delete t.json.lights}}const MY=Object.freeze(Object.defineProperty({__proto__:null,decode:LY,encode:PY,name:FY},Symbol.toStringTag,{value:"Module"})),Dg="KHR_materials_unlit",RY=Dg;async function UY(r){const t=new ua(r),{json:e}=t;for(const n of e.materials||[])n.extensions&&n.extensions.KHR_materials_unlit&&(n.unlit=!0),t.removeObjectExtension(n,Dg);t.removeExtension(Dg)}function OY(r){const t=new ua(r),{json:e}=t;if(t.materials)for(const n of e.materials||[])n.unlit&&(delete n.unlit,t.addObjectExtension(n,Dg,{}),t.addExtension(Dg))}const DY=Object.freeze(Object.defineProperty({__proto__:null,decode:UY,encode:OY,name:RY},Symbol.toStringTag,{value:"Module"})),Ng="KHR_techniques_webgl",NY=Ng;async function kY(r){const t=new ua(r),{json:e}=t,n=t.getExtension(Ng);if(n){const i=zY(n,t);for(const s of e.materials||[]){const a=t.getObjectExtension(s,Ng);a&&(s.technique=Object.assign({},a,i[a.technique]),s.technique.values=HY(s.technique,t)),t.removeObjectExtension(s,Ng)}t.removeExtension(Ng)}}async function QY(r,t){}function zY(r,t){const{programs:e=[],shaders:n=[],techniques:i=[]}=r,s=new TextDecoder;return n.forEach(a=>{if(Number.isFinite(a.bufferView))a.code=s.decode(t.getTypedArrayForBufferView(a.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),e.forEach(a=>{a.fragmentShader=n[a.fragmentShader],a.vertexShader=n[a.vertexShader]}),i.forEach(a=>{a.program=e[a.program]}),i}function HY(r,t){const e=Object.assign({},r.values);return Object.keys(r.uniforms||{}).forEach(n=>{r.uniforms[n].value&&!(n in e)&&(e[n]=r.uniforms[n].value)}),Object.keys(e).forEach(n=>{typeof e[n]=="object"&&e[n].index!==void 0&&(e[n].texture=t.getTexture(e[n].index))}),e}const VY=Object.freeze(Object.defineProperty({__proto__:null,decode:kY,encode:QY,name:NY},Symbol.toStringTag,{value:"Module"})),MF="EXT_feature_metadata",GY=MF;async function jY(r){const t=new ua(r);qY(t)}function qY(r){var t;const e=r.getExtension(MF),n=e==null||(t=e.schema)===null||t===void 0?void 0:t.classes,i=e==null?void 0:e.featureTables;if((e==null?void 0:e.featureTextures)&&console.warn('featureTextures is not yet supported in the "EXT_feature_metadata" extension.'),n&&i)for(const a in n){const o=n[a],d=WY(i,a);d&&KY(r,d,o)}}function KY(r,t,e){for(const i in e.properties){var n;const s=e.properties[i],a=t==null||(n=t.properties)===null||n===void 0?void 0:n[i],o=t.count;if(a){const d=$Y(r,s,o,a);a.data=d}}}function $Y(r,t,e,n){const i=n.bufferView;let s=r.getTypedArrayForBufferView(i);switch(t.type){case"STRING":{const a=n.stringOffsetBufferView,o=r.getTypedArrayForBufferView(a);s=XY(s,o,e);break}}return s}function WY(r,t){for(const e in r){const n=r[e];if(n.class===t)return n}return null}function XY(r,t,e){const n=[],i=new TextDecoder("utf8");let s=0;const a=4;for(let o=0;o<e;o++){const d=t[(o+1)*a]-t[o*a],f=r.subarray(s,d+s),_=i.decode(f);n.push(_),s+=d}return n}const RF=[DJ,QJ,VJ,gY,MY,DY,VY,IY,Object.freeze(Object.defineProperty({__proto__:null,decode:jY,name:GY},Symbol.toStringTag,{value:"Module"}))];function JY(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0;const n=RF.filter(s=>UF(s.name,t));for(const s of n){var i;(i=s.preprocess)===null||i===void 0||i.call(s,r,t,e)}}async function YY(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0;const n=RF.filter(s=>UF(s.name,t));for(const s of n){var i;await((i=s.decode)===null||i===void 0?void 0:i.call(s,r,t,e))}}function UF(r,t){var e;const n=(t==null||(e=t.gltf)===null||e===void 0?void 0:e.excludeExtensions)||{};return!(r in n&&!n[r])}const Ww="KHR_binary_glTF";function ZY(r){const t=new ua(r),{json:e}=t;for(const n of e.images||[]){const i=t.getObjectExtension(n,Ww);i&&Object.assign(n,i),t.removeObjectExtension(n,Ww)}e.buffers&&e.buffers[0]&&delete e.buffers[0].uri,t.removeExtension(Ww)}const OF={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},tZ={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class eZ{constructor(){j(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),j(this,"json",void 0)}normalize(t,e){this.json=t.json;const n=t.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn("glTF: Unknown version ".concat(n.asset.version));return}if(!e.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),ZY(t),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)}_addAsset(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(t){for(const e in OF)this._convertTopLevelObjectToArray(t,e)}_convertTopLevelObjectToArray(t,e){const n=t[e];if(!(!n||Array.isArray(n))){t[e]=[];for(const i in n){const s=n[i];s.id=s.id||i;const a=t[e].length;t[e].push(s),this.idToIndexMap[e][i]=a}}}_convertObjectIdsToArrayIndices(t){for(const e in OF)this._convertIdsToIndices(t,e);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));for(const e of t.textures)this._convertTextureIds(e);for(const e of t.meshes)this._convertMeshIds(e);for(const e of t.nodes)this._convertNodeIds(e);for(const e of t.scenes)this._convertSceneIds(e)}_convertTextureIds(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}_convertMeshIds(t){for(const e of t.primitives){const{attributes:n,indices:i,material:s}=e;for(const a in n)n[a]=this._convertIdToIndex(n[a],"accessor");i&&(e.indices=this._convertIdToIndex(i,"accessor")),s&&(e.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(t){t.children&&(t.children=t.children.map(e=>this._convertIdToIndex(e,"node"))),t.meshes&&(t.meshes=t.meshes.map(e=>this._convertIdToIndex(e,"mesh")))}_convertSceneIds(t){t.nodes&&(t.nodes=t.nodes.map(e=>this._convertIdToIndex(e,"node")))}_convertIdsToIndices(t,e){t[e]||(console.warn("gltf v1: json doesn't contain attribute ".concat(e)),t[e]=[]);for(const n of t[e])for(const i in n){const s=n[i],a=this._convertIdToIndex(s,i);n[i]=a}}_convertIdToIndex(t,e){const n=tZ[e];if(n in this.idToIndexMap){const i=this.idToIndexMap[n][t];if(!Number.isFinite(i))throw new Error("gltf v1: failed to resolve ".concat(e," with id ").concat(t));return i}return t}_updateObjects(t){for(const e of this.json.buffers)delete e.type}_updateMaterial(t){for(const s of t.materials){var e,n,i;s.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const a=((e=s.values)===null||e===void 0?void 0:e.tex)||((n=s.values)===null||n===void 0?void 0:n.texture2d_0)||((i=s.values)===null||i===void 0?void 0:i.diffuseTex),o=t.textures.findIndex(d=>d.id===a);o!==-1&&(s.pbrMetallicRoughness.baseColorTexture={index:o})}}}function rZ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new eZ().normalize(r,t)}const nZ={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},iZ={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},gl={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},sZ={magFilter:gl.TEXTURE_MAG_FILTER,minFilter:gl.TEXTURE_MIN_FILTER,wrapS:gl.TEXTURE_WRAP_S,wrapT:gl.TEXTURE_WRAP_T},oZ={[gl.TEXTURE_MAG_FILTER]:gl.LINEAR,[gl.TEXTURE_MIN_FILTER]:gl.NEAREST_MIPMAP_LINEAR,[gl.TEXTURE_WRAP_S]:gl.REPEAT,[gl.TEXTURE_WRAP_T]:gl.REPEAT};function aZ(r){return iZ[r]}function lZ(r){return nZ[r]}class cZ{constructor(){j(this,"baseUri",""),j(this,"json",{}),j(this,"buffers",[]),j(this,"images",[])}postProcess(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{json:n,buffers:i=[],images:s=[],baseUri:a=""}=t;return za(n),this.baseUri=a,this.json=n,this.buffers=i,this.images=s,this._resolveTree(this.json,e),this.json}_resolveTree(t){t.bufferViews&&(t.bufferViews=t.bufferViews.map((e,n)=>this._resolveBufferView(e,n))),t.images&&(t.images=t.images.map((e,n)=>this._resolveImage(e,n))),t.samplers&&(t.samplers=t.samplers.map((e,n)=>this._resolveSampler(e,n))),t.textures&&(t.textures=t.textures.map((e,n)=>this._resolveTexture(e,n))),t.accessors&&(t.accessors=t.accessors.map((e,n)=>this._resolveAccessor(e,n))),t.materials&&(t.materials=t.materials.map((e,n)=>this._resolveMaterial(e,n))),t.meshes&&(t.meshes=t.meshes.map((e,n)=>this._resolveMesh(e,n))),t.nodes&&(t.nodes=t.nodes.map((e,n)=>this._resolveNode(e,n))),t.skins&&(t.skins=t.skins.map((e,n)=>this._resolveSkin(e,n))),t.scenes&&(t.scenes=t.scenes.map((e,n)=>this._resolveScene(e,n))),t.scene!==void 0&&(t.scene=t.scenes[this.json.scene])}getScene(t){return this._get("scenes",t)}getNode(t){return this._get("nodes",t)}getSkin(t){return this._get("skins",t)}getMesh(t){return this._get("meshes",t)}getMaterial(t){return this._get("materials",t)}getAccessor(t){return this._get("accessors",t)}getCamera(t){return null}getTexture(t){return this._get("textures",t)}getSampler(t){return this._get("samplers",t)}getImage(t){return this._get("images",t)}getBufferView(t){return this._get("bufferViews",t)}getBuffer(t){return this._get("buffers",t)}_get(t,e){if(typeof e=="object")return e;const n=this.json[t]&&this.json[t][e];return n||console.warn("glTF file error: Could not find ".concat(t,"[").concat(e,"]")),n}_resolveScene(t,e){return t.id=t.id||"scene-".concat(e),t.nodes=(t.nodes||[]).map(n=>this.getNode(n)),t}_resolveNode(t,e){return t.id=t.id||"node-".concat(e),t.children&&(t.children=t.children.map(n=>this.getNode(n))),t.mesh!==void 0?t.mesh=this.getMesh(t.mesh):t.meshes!==void 0&&t.meshes.length&&(t.mesh=t.meshes.reduce((n,i)=>{const s=this.getMesh(i);return n.id=s.id,n.primitives=n.primitives.concat(s.primitives),n},{primitives:[]})),t.camera!==void 0&&(t.camera=this.getCamera(t.camera)),t.skin!==void 0&&(t.skin=this.getSkin(t.skin)),t}_resolveSkin(t,e){return t.id=t.id||"skin-".concat(e),t.inverseBindMatrices=this.getAccessor(t.inverseBindMatrices),t}_resolveMesh(t,e){return t.id=t.id||"mesh-".concat(e),t.primitives&&(t.primitives=t.primitives.map(n=>{n={...n};const i=n.attributes;n.attributes={};for(const s in i)n.attributes[s]=this.getAccessor(i[s]);return n.indices!==void 0&&(n.indices=this.getAccessor(n.indices)),n.material!==void 0&&(n.material=this.getMaterial(n.material)),n})),t}_resolveMaterial(t,e){if(t.id=t.id||"material-".concat(e),t.normalTexture&&(t.normalTexture={...t.normalTexture},t.normalTexture.texture=this.getTexture(t.normalTexture.index)),t.occlusionTexture&&(t.occlustionTexture={...t.occlustionTexture},t.occlusionTexture.texture=this.getTexture(t.occlusionTexture.index)),t.emissiveTexture&&(t.emmisiveTexture={...t.emmisiveTexture},t.emissiveTexture.texture=this.getTexture(t.emissiveTexture.index)),t.emissiveFactor||(t.emissiveFactor=t.emmisiveTexture?[1,1,1]:[0,0,0]),t.pbrMetallicRoughness){t.pbrMetallicRoughness={...t.pbrMetallicRoughness};const n=t.pbrMetallicRoughness;n.baseColorTexture&&(n.baseColorTexture={...n.baseColorTexture},n.baseColorTexture.texture=this.getTexture(n.baseColorTexture.index)),n.metallicRoughnessTexture&&(n.metallicRoughnessTexture={...n.metallicRoughnessTexture},n.metallicRoughnessTexture.texture=this.getTexture(n.metallicRoughnessTexture.index))}return t}_resolveAccessor(t,e){if(t.id=t.id||"accessor-".concat(e),t.bufferView!==void 0&&(t.bufferView=this.getBufferView(t.bufferView)),t.bytesPerComponent=aZ(t.componentType),t.components=lZ(t.type),t.bytesPerElement=t.bytesPerComponent*t.components,t.bufferView){const n=t.bufferView.buffer,{ArrayType:i,byteLength:s}=Gw(t,t.bufferView),a=(t.bufferView.byteOffset||0)+(t.byteOffset||0)+n.byteOffset;let o=n.arrayBuffer.slice(a,a+s);t.bufferView.byteStride&&(o=this._getValueFromInterleavedBuffer(n,a,t.bufferView.byteStride,t.bytesPerElement,t.count)),t.value=new i(o)}return t}_getValueFromInterleavedBuffer(t,e,n,i,s){const a=new Uint8Array(s*i);for(let o=0;o<s;o++){const d=e+o*n;a.set(new Uint8Array(t.arrayBuffer.slice(d,d+i)),o*i)}return a.buffer}_resolveTexture(t,e){return t.id=t.id||"texture-".concat(e),t.sampler="sampler"in t?this.getSampler(t.sampler):oZ,t.source=this.getImage(t.source),t}_resolveSampler(t,e){t.id=t.id||"sampler-".concat(e),t.parameters={};for(const n in t){const i=this._enumSamplerParameter(n);i!==void 0&&(t.parameters[i]=t[n])}return t}_enumSamplerParameter(t){return sZ[t]}_resolveImage(t,e){t.id=t.id||"image-".concat(e),t.bufferView!==void 0&&(t.bufferView=this.getBufferView(t.bufferView));const n=this.images[e];return n&&(t.image=n),t}_resolveBufferView(t,e){const n=t.buffer,i={id:"bufferView-".concat(e),...t,buffer:this.buffers[n]},s=this.buffers[n].arrayBuffer;let a=this.buffers[n].byteOffset||0;return"byteOffset"in t&&(a+=t.byteOffset),i.data=new Uint8Array(s,a,t.byteLength),i}_resolveCamera(t,e){return t.id=t.id||"camera-".concat(e),t.perspective,t.orthographic,t}}function uZ(r,t){return new cZ().postProcess(r,t)}const DF=1735152710,Xw=12,xy=8,AZ=1313821514,hZ=5130562,dZ=0,fZ=1,pZ=0,xf=!0;function gZ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return"".concat(String.fromCharCode(r.getUint8(t+0))).concat(String.fromCharCode(r.getUint8(t+1))).concat(String.fromCharCode(r.getUint8(t+2))).concat(String.fromCharCode(r.getUint8(t+3)))}function mZ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=new DataView(r),{magic:i=DF}=e,s=n.getUint32(t,!1);return s===i||s===DF}function yZ(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const n=new DataView(t),i=gZ(n,e+0),s=n.getUint32(e+4,xf),a=n.getUint32(e+8,xf);switch(Object.assign(r,{header:{byteOffset:e,byteLength:a,hasBinChunk:!1},type:i,version:s,json:{},binChunks:[]}),e+=Xw,r.version){case 1:return _Z(r,n,e);case 2:return vZ(r,n,e,{});default:throw new Error("Invalid GLB version ".concat(r.version,". Only supports v1 and v2."))}}function _Z(r,t,e){ci(r.header.byteLength>Xw+xy);const n=t.getUint32(e+0,xf),i=t.getUint32(e+4,xf);return e+=xy,ci(i===pZ),Jw(r,t,e,n),e+=n,e+=Yw(r,t,e,r.header.byteLength),e}function vZ(r,t,e,n){return ci(r.header.byteLength>Xw+xy),bZ(r,t,e,n),e+r.header.byteLength}function bZ(r,t,e,n){for(;e+8<=r.header.byteLength;){const i=t.getUint32(e+0,xf),s=t.getUint32(e+4,xf);switch(e+=xy,s){case AZ:Jw(r,t,e,i);break;case hZ:Yw(r,t,e,i);break;case dZ:n.strict||Jw(r,t,e,i);break;case fZ:n.strict||Yw(r,t,e,i);break}e+=Jp(i,4)}return e}function Jw(r,t,e,n){const i=new Uint8Array(t.buffer,e,n),a=new TextDecoder("utf8").decode(i);return r.json=JSON.parse(a),Jp(n,4)}function Yw(r,t,e,n){return r.header.hasBinChunk=!0,r.binChunks.push({byteOffset:e,byteLength:n,arrayBuffer:t.buffer}),Jp(n,4)}async function wZ(r,t){var e,n,i,s;let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3?arguments[3]:void 0,d=arguments.length>4?arguments[4]:void 0;xZ(r,t,a,o),rZ(r,{normalize:o==null||(e=o.gltf)===null||e===void 0?void 0:e.normalize}),JY(r,o,d);const f=[];if(o!=null&&(n=o.gltf)!==null&&n!==void 0&&n.loadBuffers&&r.json.buffers&&await BZ(r,o,d),o!=null&&(i=o.gltf)!==null&&i!==void 0&&i.loadImages){const w=CZ(r,o,d);f.push(w)}const _=YY(r,o,d);return f.push(_),await Promise.all(f),o!=null&&(s=o.gltf)!==null&&s!==void 0&&s.postProcess?uZ(r,o):r}function xZ(r,t,e,n){if(n.uri&&(r.baseUri=n.uri),t instanceof ArrayBuffer&&!mZ(t,e,n)&&(t=new TextDecoder().decode(t)),typeof t=="string")r.json=iQ(t);else if(t instanceof ArrayBuffer){const a={};e=yZ(a,t,e,n.glb),za(a.type==="glTF","Invalid GLB magic string ".concat(a.type)),r._glb=a,r.json=a.json}else za(!1,"GLTF: must be ArrayBuffer or string");const i=r.json.buffers||[];if(r.buffers=new Array(i.length).fill(null),r._glb&&r._glb.header.hasBinChunk){const{binChunks:a}=r._glb;r.buffers[0]={arrayBuffer:a[0].arrayBuffer,byteOffset:a[0].byteOffset,byteLength:a[0].byteLength}}const s=r.json.images||[];r.images=new Array(s.length).fill({})}async function BZ(r,t,e){const n=r.json.buffers||[];for(let a=0;a<n.length;++a){const o=n[a];if(o.uri){var i,s;const{fetch:d}=e;za(d);const f=wF(o.uri,t),_=await(e==null||(i=e.fetch)===null||i===void 0?void 0:i.call(e,f)),w=await(_==null||(s=_.arrayBuffer)===null||s===void 0?void 0:s.call(_));r.buffers[a]={arrayBuffer:w,byteOffset:0,byteLength:w.byteLength},delete o.uri}else r.buffers[a]===null&&(r.buffers[a]={arrayBuffer:new ArrayBuffer(o.byteLength),byteOffset:0,byteLength:o.byteLength})}}async function CZ(r,t,e){const n=EZ(r),i=r.json.images||[],s=[];for(const a of n)s.push(SZ(r,i[a],a,t,e));return await Promise.all(s)}function EZ(r){const t=new Set,e=r.json.textures||[];for(const n of e)n.source!==void 0&&t.add(n.source);return Array.from(t).sort()}async function SZ(r,t,e,n,i){const{fetch:s,parse:a}=i;let o;if(t.uri&&!t.hasOwnProperty("bufferView")){const f=wF(t.uri,n);o=await(await s(f)).arrayBuffer(),t.bufferView={data:o}}if(Number.isFinite(t.bufferView)){const f=gJ(r.json,r.buffers,t.bufferView);o=zv(f.buffer,f.byteOffset,f.byteLength)}za(o,"glTF image has no data");let d=await a(o,[MT,pJ],{mimeType:t.mimeType,basis:n.basis||{format:bF()}},i);d&&d[0]&&(d={compressed:!0,mipmaps:!1,width:d[0].width,height:d[0].height,data:d[0]}),r.images=r.images||[],r.images[e]=d}const kg={name:"glTF",id:"gltf",module:"gltf",version:ZX,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:TZ,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};async function TZ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0;t={...kg.options,...t},t.gltf={...kg.options.gltf,...t.gltf};const{byteOffset:n=0}=t;return await wZ({},r,n,t,e)}async function IZ(r){const t=[];return r.scenes.forEach(e=>{e.traverse(n=>{Object.values(n.model.getUniforms()).forEach(i=>{i.loaded===!1&&t.push(i)})})}),await FZ(()=>t.some(e=>!e.loaded))}async function FZ(r){for(;r();)await new Promise(t=>requestAnimationFrame(t))}const LZ=`#version 300 es
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform mat4 sceneModelMatrix;
uniform bool composeModelMatrix;
in vec4 POSITION;

#ifdef HAS_UV
  in vec2 TEXCOORD_0;
#endif

#ifdef MODULE_PBR
  #ifdef HAS_NORMALS
    in vec4 NORMAL;
  #endif
#endif
out vec4 vColor;
#ifndef MODULE_PBR
  #ifdef HAS_UV
    out vec2 vTEXCOORD_0;
  #endif
#endif
void main(void) {
  #if defined(HAS_UV) && !defined(MODULE_PBR)
    vTEXCOORD_0 = TEXCOORD_0;
    geometry.uv = vTEXCOORD_0;
  #endif

  geometry.worldPosition = instancePositions;
  geometry.pickingColor = instancePickingColors;

  vec3 normal = vec3(0.0, 0.0, 1.0);
  #ifdef MODULE_PBR
    #ifdef HAS_NORMALS
      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;
    #endif
  #endif

  float originalSize = project_size_to_pixel(sizeScale);
  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);

  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;
  if(composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    geometry.normal = project_normal(normal);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);
    geometry.normal = project_normal(normal);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = TEXCOORD_0;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,PZ=`#version 300 es
uniform float opacity;
in vec4 vColor;

out vec4 fragmentColor;
#ifndef MODULE_PBR
  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
    in vec2 vTEXCOORD_0;
    uniform sampler2D u_BaseColorSampler;
  #endif
#endif

void main(void) {
  #ifdef MODULE_PBR
    fragmentColor = vColor * pbr_filterColor(vec4(0));
    geometry.uv = pbr_vUV;
  #else
    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);
      geometry.uv = vTEXCOORD_0;
    #else
      fragmentColor = vColor;
    #endif
  #endif

  fragmentColor.a *= opacity;
  DECKGL_FILTER_COLOR(fragmentColor, geometry);
}
`,NF=[255,255,255,255],MZ={scenegraph:{type:"object",value:null,async:!0},getScene:r=>r&&r.scenes?typeof r.scene=="object"?r.scene:r.scenes[r.scene||0]:r,getAnimator:r=>r&&r.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:r=>r.position},getColor:{type:"accessor",value:NF},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[kg]};class Zw extends mf{constructor(){super(...arguments),j(this,"state",void 0)}getShaders(){const t=[uw,Aw];return this.props._lighting==="pbr"&&t.push(Xb),super.getShaders({vs:LZ,fs:PZ,modules:t})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:NF,transition:!0},instanceModelMatrix:K3})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;e.scenegraph!==n.scenegraph?this._updateScenegraph():e._animations!==n._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,e._animations)}finalizeState(t){super.finalizeState(t),this._deleteScenegraph()}get isLoaded(){var t;return((t=this.state)===null||t===void 0?void 0:t.scenegraph)&&super.isLoaded}_updateScenegraph(){const t=this.props,{gl:e}=this.context;let n=null;if(t.scenegraph instanceof vf)n={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const o=t.scenegraph,d=YX(e,o,this._getModelOptions());n={gltf:o,...d},IZ(d).then(()=>this.setNeedsRedraw())}else t.scenegraph&&(Tn.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),n=t.scenegraph);const i={layer:this,gl:e},s=t.getScene(n,i),a=t.getAnimator(n,i);s instanceof vf?(this._deleteScenegraph(),this._applyAllAttributes(s),this._applyAnimationsProp(s,a,t._animations),this.setState({scenegraph:s,animator:a})):s!==null&&Tn.warn("invalid scenegraph:",s)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const e=this.getAttributeManager().getAttributes();t.traverse(n=>{this._setModelAttributes(n.model,e)})}}_applyAnimationsProp(t,e,n){if(!t||!e||!n)return;const i=e.getAnimations();Object.keys(n).sort().forEach(s=>{const a=n[s];if(s==="*")i.forEach(o=>{Object.assign(o,a)});else if(Number.isFinite(Number(s))){const o=Number(s);o>=0&&o<i.length?Object.assign(i[o],a):Tn.warn("animation ".concat(s," not found"))()}else{const o=i.find(d=>{let{name:f}=d;return f===s});o?Object.assign(o,a):Tn.warn("animation ".concat(s," not found"))()}})}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof vf&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let e=null;return t&&(typeof t=="function"?e=t({gl:this.context.gl,layer:this}):e=t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:e,modelOptions:{isInstanced:!0,transpileToGLSL100:!mn(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(e=>{this._setModelAttributes(e.model,t)})}draw(t){let{moduleParameters:e=null,parameters:n={},context:i}=t;if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(i.timeline.getTime()),this.setNeedsRedraw());const{viewport:s}=this.context,{sizeScale:a,sizeMinPixels:o,sizeMaxPixels:d,opacity:f,coordinateSystem:_}=this.props,w=this.getNumInstances();this.state.scenegraph.traverse((x,B)=>{let{worldMatrix:P}=B;x.model.setInstanceCount(w),x.updateModuleSettings(e),x.draw({parameters:n,uniforms:{sizeScale:a,opacity:f,sizeMinPixels:o,sizeMaxPixels:d,composeModelMatrix:$3(s,_),sceneModelMatrix:P,u_Camera:x.model.getUniforms().project_uCameraPosition}})})}}j(Zw,"defaultProps",MZ),j(Zw,"layerName","ScenegraphLayer");const RZ=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
uniform bool pickFeatureIds;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec4 uvRegions;
in vec3 featureIdsPickingColors;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

vec2 applyUVRegion(vec2 uv) {
  #ifdef HAS_UV_REGIONS
    return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;
  #else
    return uv;
  #endif
}

void main(void) {
  vec2 uv = applyUVRegion(texCoords);
  geometry.uv = uv;

  if (pickFeatureIds) {
    geometry.pickingColor = featureIdsPickingColors;
  } else {
    geometry.pickingColor = instancePickingColors;
  }

  vTexCoord = uv;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale;
  vec3 projectedPosition = project_position(positions);
  position_commonspace = vec4(projectedPosition, 1.0);
  gl_Position = project_common_position_to_clipspace(position_commonspace);

  geometry.position = position_commonspace;
  normals_commonspace = project_normal(instanceModelMatrix * normals);
  geometry.normal = normals_commonspace;

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = uv;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,UZ=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  
#ifdef MODULE_PBR

  fragColor = vColor * pbr_filterColor(vec4(0));
  geometry.uv = pbr_vUV;
  fragColor.a *= opacity;

#else

  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);

#endif

  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function OZ(r){r.COLOR_0||r.colors||(r.colors={constant:!0,value:new Float32Array([1,1,1])})}const DZ={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}};class t2 extends kw{getShaders(){const t=super.getShaders();return t.modules.push(Xb),{...t,vs:RZ,fs:UZ}}initializeState(){const{featureIds:t}=this.props;super.initializeState();const e=this.getAttributeManager();t&&e.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;e.pbrMaterial!==n.pbrMaterial&&this.updatePbrMaterialUniforms(e.pbrMaterial)}draw(t){const{featureIds:e}=this.props;this.state.model&&(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,pickFeatureIds:!!e}),super.draw(t))}getModel(t){const{id:e,pbrMaterial:n}=this.props,i=this.parseMaterial(n,t);this.setState({materialParser:i});const s=this.getShaders();return OZ(t.attributes),new af(this.context.gl,{...this.getShaders(),id:e,geometry:t,defines:{...s.defines,...i==null?void 0:i.defines,HAS_UV_REGIONS:t.attributes.uvRegions},parameters:i==null?void 0:i.parameters,isInstanced:!0})}updatePbrMaterialUniforms(t){const{model:e}=this.state;if(e){const{mesh:n}=this.props,i=this.parseMaterial(t,n);this.setState({materialParser:i}),e.setUniforms(i.uniforms)}}parseMaterial(t,e){var n;const i=!!(t.pbrMetallicRoughness&&t.pbrMetallicRoughness.baseColorTexture);return(n=this.state.materialParser)===null||n===void 0||n.delete(),new sF(this.context.gl,{attributes:{NORMAL:e.attributes.normals,TEXCOORD_0:e.attributes.texCoords},material:{unlit:i,...t},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(t){const e=this.props.featureIds,n=new Uint8ClampedArray(e.length*t.size),i=[];for(let s=0;s<e.length;s++)this.encodePickingColor(e[s],i),n[s*3]=i[0],n[s*3+1]=i[1],n[s*3+2]=i[2];t.value=n}finalizeState(t){var e;super.finalizeState(t),(e=this.state.materialParser)===null||e===void 0||e.delete(),this.setState({materialParser:null})}}j(t2,"layerName","MeshLayer"),j(t2,"defaultProps",DZ);const NZ=6378137,kZ=6378137,QZ=6356752314245179e-9;function By(r){return r}new ie;function zZ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:By;return"longitude"in r?(t[0]=e(r.longitude),t[1]=e(r.latitude),t[2]=r.height):"x"in r?(t[0]=e(r.x),t[1]=e(r.y),t[2]=r.z):(t[0]=e(r[0]),t[1]=e(r[1]),t[2]=r[2]),t}function HZ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return zZ(r,t,vs._cartographicRadians?By:ZV)}function VZ(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:By;return"longitude"in t?(t.longitude=e(r[0]),t.latitude=e(r[1]),t.height=r[2]):"x"in t?(t.x=e(r[0]),t.y=e(r[1]),t.z=r[2]):(t[0]=e(r[0]),t[1]=e(r[1]),t[2]=r[2]),t}function GZ(r,t){return VZ(r,t,vs._cartographicRadians?By:tG)}const Bf=new ie,jZ=new ie,qZ=new ie;function KZ(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const{oneOverRadii:n,oneOverRadiiSquared:i,centerToleranceSquared:s}=t;Bf.from(r);const a=Bf.x,o=Bf.y,d=Bf.z,f=n.x,_=n.y,w=n.z,x=a*a*f*f,B=o*o*_*_,P=d*d*w*w,R=x+B+P,N=Math.sqrt(1/R);if(!Number.isFinite(N))return;const Q=jZ;if(Q.copy(r).scale(N),R<s)return Q.to(e);const V=i.x,W=i.y,et=i.z,ct=qZ;ct.set(Q.x*V*2,Q.y*W*2,Q.z*et*2);let dt=(1-N)*Bf.len()/(.5*ct.len()),gt=0,ht,It,St,ot;do{dt-=gt,ht=1/(1+dt*V),It=1/(1+dt*W),St=1/(1+dt*et);const at=ht*ht,bt=It*It,vt=St*St,$t=at*ht,Wt=bt*It,Jt=vt*St;ot=x*at+B*bt+P*vt-1;const te=-2*(x*$t*V+B*Wt*W+P*Jt*et);gt=ot/te}while(Math.abs(ot)>vg.EPSILON12);return Bf.scale([ht,It,St]).to(e)}const kF=1e-14,$Z=new ie,QF={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},e2={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},Qg={east:new ie,north:new ie,up:new ie,west:new ie,south:new ie,down:new ie},WZ=new ie,XZ=new ie,JZ=new ie;function zF(r,t,e,n,i,s){const a=QF[t]&&QF[t][e];Kl(a&&(!n||n===a));let o,d,f;const _=$Z.copy(i);if($l(_.x,0,kF)&&$l(_.y,0,kF)){const x=Math.sign(_.z);o=WZ.fromArray(e2[t]),t!=="east"&&t!=="west"&&o.scale(x),d=XZ.fromArray(e2[e]),e!=="east"&&e!=="west"&&d.scale(x),f=JZ.fromArray(e2[n]),n!=="east"&&n!=="west"&&f.scale(x)}else{const{up:x,east:B,north:P}=Qg;B.set(-_.y,_.x,0).normalize(),r.geodeticSurfaceNormal(_,x),P.copy(x).cross(B);const{down:R,west:N,south:Q}=Qg;R.copy(x).scale(-1),N.copy(B).scale(-1),Q.copy(P).scale(-1),o=Qg[t],d=Qg[e],f=Qg[n]}return s[0]=o.x,s[1]=o.y,s[2]=o.z,s[3]=0,s[4]=d.x,s[5]=d.y,s[6]=d.z,s[7]=0,s[8]=f.x,s[9]=f.y,s[10]=f.z,s[11]=0,s[12]=_.x,s[13]=_.y,s[14]=_.z,s[15]=1,s}const Cy=new ie,HF=new ie,YZ=new ie,Yl=new ie,ZZ=new ie,Ey=new ie;class Fi{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;j(this,"radii",void 0),j(this,"radiiSquared",void 0),j(this,"radiiToTheFourth",void 0),j(this,"oneOverRadii",void 0),j(this,"oneOverRadiiSquared",void 0),j(this,"minimumRadius",void 0),j(this,"maximumRadius",void 0),j(this,"centerToleranceSquared",vg.EPSILON1),j(this,"squaredXOverSquaredZ",void 0),Kl(t>=0),Kl(e>=0),Kl(n>=0),this.radii=new ie(t,e,n),this.radiiSquared=new ie(t*t,e*e,n*n),this.radiiToTheFourth=new ie(t*t*t*t,e*e*e*e,n*n*n*n),this.oneOverRadii=new ie(t===0?0:1/t,e===0?0:1/e,n===0?0:1/n),this.oneOverRadiiSquared=new ie(t===0?0:1/(t*t),e===0?0:1/(e*e),n===0?0:1/(n*n)),this.minimumRadius=Math.min(t,e,n),this.maximumRadius=Math.max(t,e,n),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(t){return this===t||!!(t&&this.radii.equals(t.radii))}toString(){return this.radii.toString()}cartographicToCartesian(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const n=HF,i=YZ,[,,s]=t;this.geodeticSurfaceNormalCartographic(t,n),i.copy(this.radiiSquared).scale(n);const a=Math.sqrt(n.dot(i));return i.scale(1/a),n.scale(s),i.add(n),i.to(e)}cartesianToCartographic(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];Ey.from(t);const n=this.scaleToGeodeticSurface(Ey,Yl);if(!n)return;const i=this.geodeticSurfaceNormal(n,HF),s=ZZ;s.copy(Ey).subtract(n);const a=Math.atan2(i.y,i.x),o=Math.asin(i.z),d=Math.sign(Nb(s,Ey))*tI(s);return GZ([a,o,d],e)}eastNorthUpToFixedFrame(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new xn;return zF(this,"east","north","up",t,e)}localFrameToFixedFrame(t,e,n,i){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:new xn;return zF(this,t,e,n,i,s)}geocentricSurfaceNormal(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return Cy.from(t).normalize().to(e)}geodeticSurfaceNormalCartographic(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const n=HZ(t),i=n[0],s=n[1],a=Math.cos(s);return Cy.set(a*Math.cos(i),a*Math.sin(i),Math.sin(s)).normalize(),Cy.to(e)}geodeticSurfaceNormal(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return Cy.from(t).scale(this.oneOverRadiiSquared).normalize().to(e)}scaleToGeodeticSurface(t,e){return KZ(t,this,e)}scaleToGeocentricSurface(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];Yl.from(t);const n=Yl.x,i=Yl.y,s=Yl.z,a=this.oneOverRadiiSquared,o=1/Math.sqrt(n*n*a.x+i*i*a.y+s*s*a.z);return Yl.multiplyScalar(o).to(e)}transformPositionToScaledSpace(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return Yl.from(t).scale(this.oneOverRadii).to(e)}transformPositionFromScaledSpace(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return Yl.from(t).scale(this.radii).to(e)}getSurfaceNormalIntersectionWithZAxis(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[0,0,0];Kl($l(this.radii.x,this.radii.y,vg.EPSILON15)),Kl(this.radii.z>0),Yl.from(t);const i=Yl.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(i)>=this.radii.z-e))return Yl.set(0,0,i).to(n)}}j(Fi,"WGS84",new Fi(NZ,kZ,QZ));class ttt{constructor(t,e,n){j(this,"item",void 0),j(this,"previous",void 0),j(this,"next",void 0),this.item=t,this.previous=e,this.next=n}}class ett{constructor(){j(this,"head",null),j(this,"tail",null),j(this,"_length",0)}get length(){return this._length}add(t){const e=new ttt(t,this.tail,null);return this.tail?(this.tail.next=e,this.tail=e):(this.head=e,this.tail=e),++this._length,e}remove(t){t&&(t.previous&&t.next?(t.previous.next=t.next,t.next.previous=t.previous):t.previous?(t.previous.next=null,this.tail=t.previous):t.next?(t.next.previous=null,this.head=t.next):(this.head=null,this.tail=null),t.next=null,t.previous=null,--this._length)}splice(t,e){t!==e&&(this.remove(e),this._insert(t,e))}_insert(t,e){const n=t.next;t.next=e,this.tail===t?this.tail=e:n.previous=e,e.next=n,e.previous=t,++this._length}}class rtt{constructor(){j(this,"_list",void 0),j(this,"_sentinel",void 0),j(this,"_trimTiles",void 0),this._list=new ett,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(t){const e=t._cacheNode;e&&this._list.splice(this._sentinel,e)}add(t,e,n){e._cacheNode||(e._cacheNode=this._list.add(e),n&&n(t,e))}unloadTile(t,e,n){const i=e._cacheNode;i&&(this._list.remove(i),e._cacheNode=null,n&&n(t,e))}unloadTiles(t,e){const n=this._trimTiles;this._trimTiles=!1;const i=this._list,s=t.maximumMemoryUsage*1024*1024,a=this._sentinel;let o=i.head;for(;o!==a&&(t.gpuMemoryUsageInBytes>s||n);){const d=o.item;o=o.next,this.unloadTile(t,d,e)}}trim(){this._trimTiles=!0}}function ntt(r,t){ci(r),ci(t);const{rtcCenter:e,gltfUpAxis:n}=t,{computedTransform:i,boundingVolume:{center:s}}=r;let a=new xn(i);switch(e&&a.translate(e),n){case"Z":break;case"Y":const w=new xn().rotateX(Math.PI/2);a=a.multiplyRight(w);break;case"X":const x=new xn().rotateY(-Math.PI/2);a=a.multiplyRight(x);break}t.isQuantized&&a.translate(t.quantizedVolumeOffset).scale(t.quantizedVolumeScale);const o=new ie(s);t.cartesianModelMatrix=a,t.cartesianOrigin=o;const d=Fi.WGS84.cartesianToCartographic(o,new ie),_=Fi.WGS84.eastNorthUpToFixedFrame(o).invert();t.cartographicModelMatrix=_.multiplyRight(a),t.cartographicOrigin=d,t.coordinateSystem||(t.modelMatrix=t.cartographicModelMatrix)}const VF=new ie,r2=new ie,n2=new pl([new Jl,new Jl,new Jl,new Jl,new Jl,new Jl]);function itt(r,t){const{cameraDirection:e,cameraUp:n,height:i}=r,{metersPerUnit:s}=r.distanceScales,a=Sy(r,r.center),o=Fi.WGS84.eastNorthUpToFixedFrame(a),d=r.unprojectPosition(r.cameraPosition),f=Fi.WGS84.cartographicToCartesian(d,new ie),_=new ie(o.transformAsVector(new ie(e).scale(s))).normalize(),w=new ie(o.transformAsVector(new ie(n).scale(s))).normalize();ott(r);const x=r.constructor,{longitude:B,latitude:P,width:R,bearing:N,zoom:Q}=r,V=new x({longitude:B,latitude:P,height:i,width:R,bearing:N,zoom:Q,pitch:0});return{camera:{position:f,direction:_,up:w},viewport:r,topDownViewport:V,height:i,cullingVolume:n2,frameNumber:t,sseDenominator:1.15}}function stt(r,t,e){if(e===0||r.length<=e)return[r,[]];const n=[],{longitude:i,latitude:s}=t.viewport;for(const[f,_]of r.entries()){const[w,x]=_.header.mbs,B=Math.abs(i-w),P=Math.abs(s-x),R=Math.sqrt(P*P+B*B);n.push([f,R])}const a=n.sort((f,_)=>f[1]-_[1]),o=[];for(let f=0;f<e;f++)o.push(r[a[f][0]]);const d=[];for(let f=e;f<a.length;f++)d.push(r[a[f][0]]);return[o,d]}function ott(r){const t=r.getFrustumPlanes(),e=GF(t.near,r.cameraPosition),n=Sy(r,e),i=Sy(r,r.cameraPosition,r2);let s=0;n2.planes[s++].fromPointNormal(n,VF.copy(n).subtract(i));for(const a in t){if(a==="near")continue;const o=t[a],d=GF(o,e,r2),f=Sy(r,d,r2);n2.planes[s++].fromPointNormal(f,VF.copy(n).subtract(f))}}function GF(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new ie;const n=r.normal.dot(t);return e.copy(r.normal).scale(r.distance-n).add(t),e}function Sy(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new ie;const n=r.unprojectPosition(t);return Fi.WGS84.cartographicToCartesian(n,e)}const att=6378137,ltt=6378137,i2=6356752314245179e-9,jF=new ie;function ctt(r,t){if(r instanceof Mg){const{halfAxes:e}=r,n=Att(e);return Math.log2(i2/(n+t[2]))}else if(r instanceof Pg){const{radius:e}=r;return Math.log2(i2/(e+t[2]))}else if(r.width&&r.height){const{width:e,height:n}=r,i=Math.log2(att/e),s=Math.log2(ltt/n);return(i+s)/2}return 1}function qF(r,t,e){const n=Fi.WGS84.cartographicToCartesian([r.xmax,r.ymax,r.zmax],new ie),i=Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)+Math.pow(n[2]-e[2],2));return Math.log2(i2/(i+t[2]))}function utt(r,t,e){const[n,i,s,a]=r;return qF({xmin:n,xmax:s,ymin:i,ymax:a,zmin:0,zmax:0},t,e)}function Att(r){r.getColumn(0,jF);const t=r.getColumn(1),e=r.getColumn(2);return jF.add(t).add(e).len()}const Ha={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},qu={ADD:1,REPLACE:2},Cf={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},ml={I3S:"I3S",TILES3D:"TILES3D"},Ty={GEOMETRIC_ERROR:"geometricError",MAX_SCREEN_THRESHOLD:"maxScreenThreshold"},htt={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};function KF(r){return r!=null}const fo=new ie,Iy=new ie,dtt=new ie,ftt=new ie;function s2(r,t,e){if(ci(r,"3D Tile: boundingVolume must be defined"),r.box)return gtt(r.box,t,e);if(r.region){const[n,i,s,a,o,d]=r.region,f=Fi.WGS84.cartographicToCartesian([Hu(n),Hu(a),o],dtt),_=Fi.WGS84.cartographicToCartesian([Hu(s),Hu(i),d],ftt),w=new ie().addVectors(f,_).multiplyScalar(.5),x=new ie().subVectors(f,_).len()/2;return $F([w[0],w[1],w[2],x],new xn)}if(r.sphere)return $F(r.sphere,t,e);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function ptt(r,t){if(r.box)return mtt(t);if(r.region){const[e,n,i,s,a,o]=r.region;return[[Hu(e),Hu(n),a],[Hu(i),Hu(s),o]]}if(r.sphere)return ytt(t);throw new Error("Unkown boundingVolume type")}function gtt(r,t,e){const n=new ie(r[0],r[1],r[2]);t.transform(n,n);let i=[];if(r.length===10){const f=r.slice(3,6),_=new _g;_.fromArray(r,6);const w=new ie([1,0,0]),x=new ie([0,1,0]),B=new ie([0,0,1]);w.transformByQuaternion(_),w.scale(f[0]),x.transformByQuaternion(_),x.scale(f[1]),B.transformByQuaternion(_),B.scale(f[2]),i=[...w.toArray(),...x.toArray(),...B.toArray()]}else i=[...r.slice(3,6),...r.slice(6,9),...r.slice(9,12)];const s=t.transformAsVector(i.slice(0,3)),a=t.transformAsVector(i.slice(3,6)),o=t.transformAsVector(i.slice(6,9)),d=new Oi([s[0],s[1],s[2],a[0],a[1],a[2],o[0],o[1],o[2]]);return KF(e)?(e.center=n,e.halfAxes=d,e):new Mg(n,d)}function $F(r,t,e){const n=new ie(r[0],r[1],r[2]);t.transform(n,n);const i=t.getScale(Iy),s=Math.max(Math.max(i[0],i[1]),i[2]),a=r[3]*s;return KF(e)?(e.center=n,e.radius=a,e):new Pg(n,a)}function mtt(r){const t=WF(),{halfAxes:e}=r,n=new ie(e.getColumn(0)),i=new ie(e.getColumn(1)),s=new ie(e.getColumn(2));for(let a=0;a<2;a++){for(let o=0;o<2;o++){for(let d=0;d<2;d++)fo.copy(r.center),fo.add(n),fo.add(i),fo.add(s),XF(t,fo),s.negate();i.negate()}n.negate()}return t}function ytt(r){const t=WF(),{center:e,radius:n}=r,i=Fi.WGS84.scaleToGeodeticSurface(e,fo);let s;i?s=Fi.WGS84.geodeticSurfaceNormal(i):s=new ie(0,0,1);let a=new ie(s[2],-s[1],0);a.len()>0?a.normalize():a=new ie(0,1,0);const o=a.clone().cross(s);for(const d of[a,o,s]){Iy.copy(d).scale(n);for(let f=0;f<2;f++)fo.copy(e),fo.add(Iy),XF(t,fo),Iy.negate()}return t}function WF(){return[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]]}function XF(r,t){Fi.WGS84.cartesianToCartographic(t,fo),r[0][0]=Math.min(r[0][0],fo[0]),r[0][1]=Math.min(r[0][1],fo[1]),r[0][2]=Math.min(r[0][2],fo[2]),r[1][0]=Math.max(r[1][0],fo[0]),r[1][1]=Math.max(r[1][1],fo[1]),r[1][2]=Math.max(r[1][2],fo[2])}new ie,new ie,new xn,new ie,new ie,new ie;function _tt(r,t){const e=r*t;return 1-Math.exp(-(e*e))}function vtt(r,t){if(r.dynamicScreenSpaceError&&r.dynamicScreenSpaceErrorComputedDensity){const e=r.dynamicScreenSpaceErrorComputedDensity,n=r.dynamicScreenSpaceErrorFactor;return _tt(t,e)*n}return 0}function btt(r,t,e){const n=r.tileset,i=r.parent&&r.parent.lodMetricValue||r.lodMetricValue,s=e?i:r.lodMetricValue;if(s===0)return 0;const a=Math.max(r._distanceToCamera,1e-7),{height:o,sseDenominator:d}=t,{viewDistanceScale:f}=n.options;let _=s*o*(f||1)/(a*d);return _-=vtt(n,a),_}const o2=new ie,JF=new ie,KA=new ie,YF=new ie,wtt=new ie,a2=new xn,ZF=new xn;function xtt(r,t){if(r.lodMetricValue===0||isNaN(r.lodMetricValue))return"DIG";const e=2*tL(r,t);return e<2?"OUT":!r.header.children||e<=r.lodMetricValue?"DRAW":r.header.children?"DIG":"OUT"}function tL(r,t){const{topDownViewport:e}=t,n=r.header.mbs[1],i=r.header.mbs[0],s=r.header.mbs[2],a=r.header.mbs[3],o=[...r.boundingVolume.center],d=e.unprojectPosition(e.cameraPosition);Fi.WGS84.cartographicToCartesian(d,o2),JF.copy(o2).subtract(o).normalize(),Fi.WGS84.eastNorthUpToFixedFrame(o,a2),ZF.copy(a2).invert(),KA.copy(o2).transform(ZF);const f=Math.sqrt(KA[0]*KA[0]+KA[1]*KA[1]),_=f*f/KA[2];YF.copy([KA[0],KA[1],_]);const x=YF.transform(a2).subtract(o).normalize(),P=JF.cross(x).normalize().scale(a).add(o),R=Fi.WGS84.cartesianToCartographic(P),N=e.project([i,n,s]),Q=e.project(R);return wtt.copy(N).subtract(Q).magnitude()}function Btt(r){return{assetGltfUpAxis:r.asset&&r.asset.gltfUpAxis||"Y"}}class eL{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;j(this,"_map",new Map),j(this,"_array",void 0),j(this,"_length",void 0),this._array=new Array(t),this._length=t}get length(){return this._length}set length(t){this._length=t,t>this._array.length&&(this._array.length=t)}get values(){return this._array}get(t){return ci(t<this._array.length),this._array[t]}set(t,e){ci(t>=0),t>=this.length&&(this.length=t+1),this._map.has(this._array[t])&&this._map.delete(this._array[t]),this._array[t]=e,this._map.set(e,t)}delete(t){const e=this._map.get(t);e>=0&&(this._array.splice(e,1),this._map.delete(t),this.length--)}peek(){return this._array[this._length-1]}push(t){if(!this._map.has(t)){const e=this.length++;this._array[e]=t,this._map.set(t,e)}}pop(){const t=this._array[--this.length];return this._map.delete(t),t}reserve(t){ci(t>=0),t>this._array.length&&(this._array.length=t)}resize(t){ci(t>=0),this.length=t}trim(t){t==null&&(t=this.length),this._array.length=t}reset(){this._array=[],this._map=new Map,this._length=0}find(t){return this._map.has(t)}}const Ctt={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class Fy{traversalFinished(t){return!0}constructor(t){j(this,"options",void 0),j(this,"root",null),j(this,"selectedTiles",{}),j(this,"requestedTiles",{}),j(this,"emptyTiles",{}),j(this,"lastUpdate",new Date().getTime()),j(this,"updateDebounceTime",1e3),j(this,"_traversalStack",new eL),j(this,"_emptyTraversalStack",new eL),j(this,"_frameNumber",null),this.options={...Ctt,...t}}traverse(t,e,n){this.root=t,this.options={...this.options,...n},this.reset(),this.updateTile(t,e),this._frameNumber=e.frameNumber,this.executeTraversal(t,e)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(t,e){const n=this._traversalStack;for(t._selectionDepth=1,n.push(t);n.length>0;){const s=n.pop();let a=!1;this.canTraverse(s,e)&&(this.updateChildTiles(s,e),a=this.updateAndPushChildren(s,e,n,s.hasRenderContent?s._selectionDepth+1:s._selectionDepth));const o=s.parent,d=!!(!o||o._shouldRefine),f=!a;s.hasRenderContent?s.refine===qu.ADD?(this.loadTile(s,e),this.selectTile(s,e)):s.refine===qu.REPLACE&&(this.loadTile(s,e),f&&this.selectTile(s,e)):(this.emptyTiles[s.id]=s,this.loadTile(s,e),f&&this.selectTile(s,e)),this.touchTile(s,e),s._shouldRefine=a&&d}const i=new Date().getTime();(this.traversalFinished(e)||i-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=i,this.options.onTraversalEnd(e))}updateChildTiles(t,e){const n=t.children;for(const i of n)this.updateTile(i,e)}updateAndPushChildren(t,e,n,i){const{loadSiblings:s,skipLevelOfDetail:a}=this.options,o=t.children;o.sort(this.compareDistanceToCamera.bind(this));const d=t.refine===qu.REPLACE&&t.hasRenderContent&&!a;let f=!1,_=!0;for(const w of o)if(w._selectionDepth=i,w.isVisibleAndInRequestVolume?(n.find(w)&&n.delete(w),n.push(w),f=!0):(d||s)&&(this.loadTile(w,e),this.touchTile(w,e)),d){let x;if(w._inRequestVolume?w.hasRenderContent?x=w.contentAvailable:x=this.executeEmptyTraversal(w,e):x=!1,_=_&&x,!_)return!1}return f||(_=!1),_}updateTile(t,e){this.updateTileVisibility(t,e)}selectTile(t,e){this.shouldSelectTile(t)&&(t._selectedFrame=e.frameNumber,this.selectedTiles[t.id]=t)}loadTile(t,e){this.shouldLoadTile(t)&&(t._requestedFrame=e.frameNumber,t._priority=t._getPriority(),this.requestedTiles[t.id]=t)}touchTile(t,e){t.tileset._cache.touch(t),t._touchedFrame=e.frameNumber}canTraverse(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return t.hasChildren?t.hasTilesetContent?!t.contentExpired:!i&&!t.isVisibleAndInRequestVolume?!1:this.shouldRefine(t,e,n):!1}shouldLoadTile(t){return t.hasUnloadedContent||t.contentExpired}shouldSelectTile(t){return t.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=t._screenSpaceError;return n&&(i=t.getScreenSpaceError(e,!0)),i>this.options.maximumScreenSpaceError}updateTileVisibility(t,e){const n=[];if(this.options.viewportTraversersMap)for(const i in this.options.viewportTraversersMap)this.options.viewportTraversersMap[i]===e.viewport.id&&n.push(i);else n.push(e.viewport.id);t.updateVisibility(e,n)}compareDistanceToCamera(t,e){return t._distanceToCamera-e._distanceToCamera}anyChildrenVisible(t,e){let n=!1;for(const i of t.children)i.updateVisibility(e),n=n||i.isVisibleAndInRequestVolume;return n}executeEmptyTraversal(t,e){let n=!0;const i=this._emptyTraversalStack;for(i.push(t);i.length>0&&n;){const s=i.pop();if(this.updateTile(s,e),s.isVisibleAndInRequestVolume||this.loadTile(s,e),this.touchTile(s,e),!s.hasRenderContent&&this.canTraverse(s,e,!1,!0)){const o=s.children;for(const d of o)i.find(d)&&i.delete(d),i.push(d)}else!s.contentAvailable&&!s.hasEmptyContent&&(n=!1)}return n}}const rL=new ie;function Ett(r){return r!=null}class l2{constructor(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"";j(this,"tileset",void 0),j(this,"header",void 0),j(this,"id",void 0),j(this,"url",void 0),j(this,"parent",void 0),j(this,"refine",void 0),j(this,"type",void 0),j(this,"contentUrl",void 0),j(this,"lodMetricType","geometricError"),j(this,"lodMetricValue",0),j(this,"boundingVolume",null),j(this,"content",null),j(this,"contentState",Ha.UNLOADED),j(this,"gpuMemoryUsageInBytes",0),j(this,"children",[]),j(this,"depth",0),j(this,"viewportIds",[]),j(this,"transform",new xn),j(this,"extensions",null),j(this,"implicitTiling",null),j(this,"userData",{}),j(this,"computedTransform",void 0),j(this,"hasEmptyContent",!1),j(this,"hasTilesetContent",!1),j(this,"traverser",new Fy({})),j(this,"_cacheNode",null),j(this,"_frameNumber",null),j(this,"_expireDate",null),j(this,"_expiredContent",null),j(this,"_boundingBox",void 0),j(this,"_distanceToCamera",0),j(this,"_screenSpaceError",0),j(this,"_visibilityPlaneMask",void 0),j(this,"_visible",void 0),j(this,"_contentBoundingVolume",void 0),j(this,"_viewerRequestVolume",void 0),j(this,"_initialTransform",new xn),j(this,"_priority",0),j(this,"_selectedFrame",0),j(this,"_requestedFrame",0),j(this,"_selectionDepth",0),j(this,"_touchedFrame",0),j(this,"_centerZDepth",0),j(this,"_shouldRefine",!1),j(this,"_stackLength",0),j(this,"_visitedFrame",0),j(this,"_inRequestVolume",!1),j(this,"_lodJudge",null),this.header=e,this.tileset=t,this.id=i||e.id,this.url=e.url,this.parent=n,this.refine=this._getRefine(e.refine),this.type=e.type,this.contentUrl=e.contentUrl,this._initializeLodMetric(e),this._initializeTransforms(e),this._initializeBoundingVolumes(e),this._initializeContent(e),this._initializeRenderingState(e),Object.seal(this)}destroy(){this.header=null}isDestroyed(){return this.header===null}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return this.contentState===Ha.READY||this.hasEmptyContent}get contentAvailable(){return!!(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return this.contentState===Ha.UNLOADED}get contentExpired(){return this.contentState===Ha.EXPIRED}get contentFailed(){return this.contentState===Ha.FAILED}get distanceToCamera(){return this._distanceToCamera}get screenSpaceError(){return this._screenSpaceError}get boundingBox(){return this._boundingBox||(this._boundingBox=ptt(this.header.boundingVolume,this.boundingVolume)),this._boundingBox}getScreenSpaceError(t,e){switch(this.tileset.type){case ml.I3S:return tL(this,t);case ml.TILES3D:return btt(this,t,e);default:throw new Error("Unsupported tileset type")}}unselect(){this._selectedFrame=0}_getGpuMemoryUsageInBytes(){return this.content.gpuMemoryUsageInBytes||this.content.byteLength||0}_getPriority(){const t=this.tileset._traverser,{skipLevelOfDetail:e}=t.options,n=this.refine===qu.ADD||e;if(n&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===Ha.UNLOADED)return-1;const i=this.parent,a=i&&(!n||this._screenSpaceError===0||i.hasTilesetContent)?i._screenSpaceError:this._screenSpaceError,o=t.root?t.root._screenSpaceError:0;return Math.max(o-a,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=Ha.LOADING;const e=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!e)return this.contentState=Ha.UNLOADED,!1;try{const n=this.tileset.getTileUrl(this.contentUrl),i=this.tileset.loader,s={...this.tileset.loadOptions,[i.id]:{...this.tileset.loadOptions[i.id],isTileset:this.type==="json",...this._getLoaderSpecificOptions(i.id)}};return this.content=await UA(n,i,s),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=Ha.READY,this._onContentLoaded(),!0}catch(n){throw this.contentState=Ha.FAILED,n}finally{e.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=Ha.UNLOADED,!0}updateVisibility(t,e){if(this._frameNumber===t.frameNumber)return;const n=this.parent,i=n?n._visibilityPlaneMask:pl.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const s=n?n.computedTransform:this.tileset.modelMatrix;this._updateTransform(s)}this._distanceToCamera=this.distanceToTile(t),this._screenSpaceError=this.getScreenSpaceError(t,!1),this._visibilityPlaneMask=this.visibility(t,i),this._visible=this._visibilityPlaneMask!==pl.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(t),this._frameNumber=t.frameNumber,this.viewportIds=e}visibility(t,e){const{cullingVolume:n}=t,{boundingVolume:i}=this;return n.computeVisibilityWithPlaneMask(i,e)}contentVisibility(){return!0}distanceToTile(t){const e=this.boundingVolume;return Math.sqrt(Math.max(e.distanceSquaredTo(t.camera.position),0))}cameraSpaceZDepth(t){let{camera:e}=t;const n=this.boundingVolume;return rL.subVectors(n.center,e.position),e.direction.dot(rL)}insideViewerRequestVolume(t){const e=this._viewerRequestVolume;return!e||e.distanceSquaredTo(t.camera.position)<=0}updateExpiration(){if(Ett(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){const t=Date.now();Date.lessThan(this._expireDate,t)&&(this.contentState=Ha.EXPIRED,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(t){"lodMetricType"in t?this.lodMetricType=t.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in t?this.lodMetricValue=t.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(t){this.transform=t.transform?new xn(t.transform):new xn;const e=this.parent,n=this.tileset,i=e&&e.computedTransform?e.computedTransform.clone():n.modelMatrix.clone();this.computedTransform=new xn(i).multiplyRight(this.transform);const s=e&&e._initialTransform?e._initialTransform.clone():new xn;this._initialTransform=new xn(s).multiplyRight(this.transform)}_initializeBoundingVolumes(t){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(t)}_initializeContent(t){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=Ha.UNLOADED,this.hasTilesetContent=!1,t.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(t){this.depth=t.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=pl.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(t){return t||this.parent&&this.parent.refine||qu.REPLACE}_isTileset(){return this.contentUrl.indexOf(".json")!==-1}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0;break}this._isTileset()?this.hasTilesetContent=!0:this.gpuMemoryUsageInBytes=this._getGpuMemoryUsageInBytes()}_updateBoundingVolume(t){this.boundingVolume=s2(t.boundingVolume,this.computedTransform,this.boundingVolume);const e=t.content;e&&(e.boundingVolume&&(this._contentBoundingVolume=s2(e.boundingVolume,this.computedTransform,this._contentBoundingVolume)),t.viewerRequestVolume&&(this._viewerRequestVolume=s2(t.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:new xn).clone().multiplyRight(this.transform);e.equals(this.computedTransform)||(this.computedTransform=e,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(t){switch(t){case"i3s":return{...this.tileset.options.i3s,_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1};case"3d-tiles":case"cesium-ion":default:return Btt(this.tileset.tileset)}}}class Stt extends Fy{compareDistanceToCamera(t,e){return e._distanceToCamera===0&&t._distanceToCamera===0?e._centerZDepth-t._centerZDepth:e._distanceToCamera-t._distanceToCamera}updateTileVisibility(t,e){if(super.updateTileVisibility(t,e),!t.isVisibleAndInRequestVolume)return;const n=t.children.length>0;if(t.hasTilesetContent&&n){const a=t.children[0];this.updateTileVisibility(a,e),t._visible=a._visible;return}if(this.meetsScreenSpaceErrorEarly(t,e)){t._visible=!1;return}const i=t.refine===qu.REPLACE,s=t._optimChildrenWithinParent===htt.USE_OPTIMIZATION;if(i&&s&&n&&!this.anyChildrenVisible(t,e)){t._visible=!1;return}}meetsScreenSpaceErrorEarly(t,e){const{parent:n}=t;return!n||n.hasTilesetContent||n.refine!==qu.ADD?!1:!this.shouldRefine(t,e,!0)}}class Ttt{constructor(){j(this,"frameNumberMap",new Map)}register(t,e){const n=this.frameNumberMap.get(t)||new Map,i=n.get(e)||0;n.set(e,i+1),this.frameNumberMap.set(t,n)}deregister(t,e){const n=this.frameNumberMap.get(t);if(!n)return;const i=n.get(e)||1;n.set(e,i-1)}isZero(t,e){var n;return(((n=this.frameNumberMap.get(t))===null||n===void 0?void 0:n.get(e))||0)===0}}const c2={REQUESTED:"REQUESTED",COMPLETED:"COMPLETED",ERROR:"ERROR"};class Itt{constructor(){j(this,"_statusMap",void 0),j(this,"pendingTilesRegister",new Ttt),this._statusMap={}}add(t,e,n,i){if(!this._statusMap[e]){const{frameNumber:s,viewport:{id:a}}=i;this._statusMap[e]={request:t,callback:n,key:e,frameState:i,status:c2.REQUESTED},this.pendingTilesRegister.register(a,s),t().then(o=>{this._statusMap[e].status=c2.COMPLETED;const{frameNumber:d,viewport:{id:f}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(f,d),this._statusMap[e].callback(o,i)}).catch(o=>{this._statusMap[e].status=c2.ERROR;const{frameNumber:d,viewport:{id:f}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(f,d),n(o)})}}update(t,e){if(this._statusMap[t]){const{frameNumber:n,viewport:{id:i}}=this._statusMap[t].frameState;this.pendingTilesRegister.deregister(i,n);const{frameNumber:s,viewport:{id:a}}=e;this.pendingTilesRegister.register(a,s),this._statusMap[t].frameState=e}}find(t){return this._statusMap[t]}hasPendingTiles(t,e){return!this.pendingTilesRegister.isZero(t,e)}}class Ftt extends Fy{constructor(t){super(t),j(this,"_tileManager",void 0),this._tileManager=new Itt}traversalFinished(t){return!this._tileManager.hasPendingTiles(t.viewport.id,this._frameNumber||0)}shouldRefine(t,e){return t._lodJudge=xtt(t,e),t._lodJudge==="DIG"}updateChildTiles(t,e){const n=t.header.children||[],i=t.children,s=t.tileset;for(const a of n){const o="".concat(a.id,"-").concat(e.viewport.id),d=i&&i.find(f=>f.id===o);if(d)d&&this.updateTile(d,e);else{let f=()=>this._loadTile(a.id,s);this._tileManager.find(o)?this._tileManager.update(o,e):(s.tileset.nodePages&&(f=()=>s.tileset.nodePagesTile.formTileFromNodePages(a.id)),this._tileManager.add(f,o,w=>this._onTileLoad(w,t,o),e))}}return!1}async _loadTile(t,e){const{loader:n}=e,i=e.getTileUrl("".concat(e.url,"/nodes/").concat(t)),s={...e.loadOptions,i3s:{...e.loadOptions.i3s,isTileHeader:!0}};return await UA(i,n,s)}_onTileLoad(t,e,n){const i=new l2(e.tileset,t,e,n);e.children.push(i);const s=this._tileManager.find(i.id).frameState;this.updateTile(i,s),this._frameNumber===s.frameNumber&&(this.traversalFinished(s)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(i,s)}}const Ltt={description:"",ellipsoid:Fi.WGS84,modelMatrix:new xn,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:r=>r,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},Ly="Tiles In Tileset(s)",u2="Tiles In Memory",nL="Tiles In View",iL="Tiles To Render",sL="Tiles Loaded",A2="Tiles Loading",oL="Tiles Unloaded",aL="Failed Tile Loads",lL="Points/Vertices",h2="Tile Memory Use";class Ptt{constructor(t,e){j(this,"options",void 0),j(this,"loadOptions",void 0),j(this,"type",void 0),j(this,"tileset",void 0),j(this,"loader",void 0),j(this,"url",void 0),j(this,"basePath",void 0),j(this,"modelMatrix",void 0),j(this,"ellipsoid",void 0),j(this,"lodMetricType",void 0),j(this,"lodMetricValue",void 0),j(this,"refine",void 0),j(this,"root",null),j(this,"roots",{}),j(this,"asset",{}),j(this,"description",""),j(this,"properties",void 0),j(this,"extras",null),j(this,"attributions",{}),j(this,"credits",{}),j(this,"stats",void 0),j(this,"contentFormats",{draco:!1,meshopt:!1,dds:!1,ktx2:!1}),j(this,"cartographicCenter",null),j(this,"cartesianCenter",null),j(this,"zoom",1),j(this,"boundingVolume",null),j(this,"dynamicScreenSpaceErrorComputedDensity",0),j(this,"maximumMemoryUsage",32),j(this,"gpuMemoryUsageInBytes",0),j(this,"_frameNumber",0),j(this,"_queryParams",{}),j(this,"_extensionsUsed",[]),j(this,"_tiles",{}),j(this,"_pendingCount",0),j(this,"selectedTiles",[]),j(this,"traverseCounter",0),j(this,"geometricError",0),j(this,"lastUpdatedVieports",null),j(this,"_requestedTiles",[]),j(this,"_emptyTiles",[]),j(this,"frameStateData",{}),j(this,"_traverser",void 0),j(this,"_cache",new rtt),j(this,"_requestScheduler",void 0),j(this,"updatePromise",null),j(this,"tilesetInitializationPromise",void 0),this.options={...Ltt,...e},this.tileset=t,this.loader=t.loader,this.type=t.type,this.url=t.url,this.basePath=t.basePath||Hv(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=t.lodMetricType,this.lodMetricValue=t.lodMetricValue,this.refine=t.root.refine,this.loadOptions=this.options.loadOptions||{},this._traverser=this._initializeTraverser(),this._requestScheduler=new pQ({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this.stats=new Yp({id:this.url}),this._initializeStats(),this.tilesetInitializationPromise=this._initializeTileSet(t)}destroy(){this._destroy()}isLoaded(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return new URLSearchParams(this._queryParams).toString()}setProps(t){this.options={...this.options,...t}}setOptions(t){this.options={...this.options,...t}}getTileUrl(t){return t.startsWith("data:")?t:"".concat(t).concat(t.includes("?")?"&":"?").concat(this.queryParams)}hasExtension(t){return this._extensionsUsed.indexOf(t)>-1}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.tilesetInitializationPromise.then(()=>{!t&&this.lastUpdatedVieports?t=this.lastUpdatedVieports:this.lastUpdatedVieports=t,t&&this.doUpdate(t)})}async selectTiles(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return await this.tilesetInitializationPromise,t&&(this.lastUpdatedVieports=t),this.updatePromise||(this.updatePromise=new Promise(e=>{setTimeout(()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),e(this._frameNumber),this.updatePromise=null},this.options.debounceTime)})),this.updatePromise}doUpdate(t){if("loadTiles"in this.options&&!this.options.loadTiles||this.traverseCounter>0)return;const e=t instanceof Array?t:[t];this._cache.reset(),this._frameNumber++,this.traverseCounter=e.length;const n=[];for(const i of e){const s=i.id;this._needTraverse(s)?n.push(s):this.traverseCounter--}for(const i of e){const s=i.id;if(this.roots[s]||(this.roots[s]=this._initializeTileHeaders(this.tileset,null)),!n.includes(s))continue;const a=itt(i,this._frameNumber);this._traverser.traverse(this.roots[s],a,this.options)}}_needTraverse(t){let e=t;return this.options.viewportTraversersMap&&(e=this.options.viewportTraversersMap[t]),e===t}_onTraversalEnd(t){const e=t.viewport.id;this.frameStateData[e]||(this.frameStateData[e]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const n=this.frameStateData[e],i=Object.values(this._traverser.selectedTiles),[s,a]=stt(i,t,this.options.maximumTilesSelected);n.selectedTiles=s;for(const o of a)o.unselect();n._requestedTiles=Object.values(this._traverser.requestedTiles),n._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const t in this.frameStateData){const e=this.frameStateData[t];this.selectedTiles=this.selectedTiles.concat(e.selectedTiles),this._requestedTiles=this._requestedTiles.concat(e._requestedTiles),this._emptyTiles=this._emptyTiles.concat(e._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const t of this.selectedTiles)this._tiles[t.id]=t;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(t,e){if(t.length!==e.length)return!0;const n=new Set(t.map(a=>a.id)),i=new Set(e.map(a=>a.id));let s=t.filter(a=>!i.has(a.id)).length>0;return s=s||e.filter(a=>!n.has(a.id)).length>0,s}_loadTiles(){for(const t of this._requestedTiles)t.contentUnloaded&&this._loadTile(t)}_unloadTiles(){this._cache.unloadTiles(this,(t,e)=>t._unloadTile(e))}_updateStats(){let t=0,e=0;for(const n of this.selectedTiles)n.contentAvailable&&n.content&&(t++,n.content.pointCount?e+=n.content.pointCount:e+=n.content.vertexCount);this.stats.get(nL).count=this.selectedTiles.length,this.stats.get(iL).count=t,this.stats.get(lL).count=e}async _initializeTileSet(t){this.type===ml.I3S&&(this.calculateViewPropsI3S(),t.root=await t.root),this.root=this._initializeTileHeaders(t,null),this.type===ml.TILES3D&&(this._initializeTiles3DTileset(t),this.calculateViewPropsTiles3D()),this.type===ml.I3S&&this._initializeI3STileset()}calculateViewPropsI3S(){var t;const e=this.tileset.fullExtent;if(e){const{xmin:i,xmax:s,ymin:a,ymax:o,zmin:d,zmax:f}=e;this.cartographicCenter=new ie(i+(s-i)/2,a+(o-a)/2,d+(f-d)/2),this.cartesianCenter=Fi.WGS84.cartographicToCartesian(this.cartographicCenter,new ie),this.zoom=qF(e,this.cartographicCenter,this.cartesianCenter);return}const n=(t=this.tileset.store)===null||t===void 0?void 0:t.extent;if(n){const[i,s,a,o]=n;this.cartographicCenter=new ie(i+(a-i)/2,s+(o-s)/2,0),this.cartesianCenter=Fi.WGS84.cartographicToCartesian(this.cartographicCenter,new ie),this.zoom=utt(n,this.cartographicCenter,this.cartesianCenter);return}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new ie,this.zoom=1}calculateViewPropsTiles3D(){const t=this.root,{center:e}=t.boundingVolume;if(!e){console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new ie,this.zoom=1;return}e[0]!==0||e[1]!==0||e[2]!==0?this.cartographicCenter=Fi.WGS84.cartesianToCartographic(e,new ie):this.cartographicCenter=new ie(0,0,-Fi.WGS84.radii[0]),this.cartesianCenter=e,this.zoom=ctt(t.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get(Ly),this.stats.get(A2),this.stats.get(u2),this.stats.get(nL),this.stats.get(iL),this.stats.get(sL),this.stats.get(oL),this.stats.get(aL),this.stats.get(lL),this.stats.get(h2,"memory")}_initializeTileHeaders(t,e){const n=new l2(this,t.root,e);if(e&&(e.children.push(n),n.depth=e.depth+1),this.type===ml.TILES3D){const s=[];for(s.push(n);s.length>0;){const a=s.pop();this.stats.get(Ly).incrementCount();const o=a.header.children||[];for(const d of o){var i;const f=new l2(this,d,a);if((i=f.contentUrl)!==null&&i!==void 0&&i.includes("?session=")){const w=new URL(f.contentUrl).searchParams.get("session");w&&(this._queryParams.session=w)}a.children.push(f),f.depth=a.depth+1,s.push(f)}}}return n}_initializeTraverser(){let t;switch(this.type){case ml.TILES3D:t=Stt;break;case ml.I3S:t=Ftt;break;default:t=Fy}return new t({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(t){this._destroySubtree(t)}async _loadTile(t){let e;try{this._onStartTileLoading(),e=await t.loadContent()}catch(n){this._onTileLoadError(t,n instanceof Error?n:new Error("load failed"))}finally{this._onEndTileLoading(),this._onTileLoad(t,e)}}_onTileLoadError(t,e){this.stats.get(aL).incrementCount();const n=e.message||e.toString(),i=t.url;console.error("A 3D tile failed to load: ".concat(t.url," ").concat(n)),this.options.onTileError(t,n,i)}_onTileLoad(t,e){if(e){if(this.type===ml.I3S){var n,i;const s=((n=this.tileset)===null||n===void 0||(i=n.nodePagesTile)===null||i===void 0?void 0:i.nodesInNodePages)||0;this.stats.get(Ly).reset(),this.stats.get(Ly).addCount(s)}t&&t.content&&ntt(t,t.content),this.updateContentTypes(t),this._addTileToCache(t),this.options.onTileLoad(t)}}updateContentTypes(t){if(this.type===ml.I3S)switch(t.header.isDracoGeometry&&(this.contentFormats.draco=!0),t.header.textureFormat){case"dds":this.contentFormats.dds=!0;break;case"ktx2":this.contentFormats.ktx2=!0;break}else if(this.type===ml.TILES3D){var e;const{extensionsRemoved:n=[]}=((e=t.content)===null||e===void 0?void 0:e.gltf)||{};n.includes("KHR_draco_mesh_compression")&&(this.contentFormats.draco=!0),n.includes("EXT_meshopt_compression")&&(this.contentFormats.meshopt=!0),n.includes("KHR_texture_basisu")&&(this.contentFormats.ktx2=!0)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(A2).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(A2).decrementCount()}_addTileToCache(t){this._cache.add(this,t,e=>e._updateCacheStats(t))}_updateCacheStats(t){this.stats.get(sL).incrementCount(),this.stats.get(u2).incrementCount(),this.gpuMemoryUsageInBytes+=t.gpuMemoryUsageInBytes||0,this.stats.get(h2).count=this.gpuMemoryUsageInBytes}_unloadTile(t){this.gpuMemoryUsageInBytes-=t.gpuMemoryUsageInBytes||0,this.stats.get(u2).decrementCount(),this.stats.get(oL).incrementCount(),this.stats.get(h2).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(t),t.unloadContent()}_destroy(){const t=[];for(this.root&&t.push(this.root);t.length>0;){const e=t.pop();for(const n of e.children)t.push(n);this._destroyTile(e)}this.root=null}_destroySubtree(t){const e=t,n=[];for(n.push(e);n.length>0;){t=n.pop();for(const i of t.children)n.push(i);t!==e&&this._destroyTile(t)}e.children=[]}_destroyTile(t){this._cache.unloadTile(this,t),this._unloadTile(t),t.destroy()}_initializeTiles3DTileset(t){if(t.queryString){const e=new URLSearchParams(t.queryString),n=Object.fromEntries(e.entries());this._queryParams={...this._queryParams,...n}}if(this.asset=t.asset,!this.asset)throw new Error("Tileset must have an asset property.");if(this.asset.version!=="0.0"&&this.asset.version!=="1.0")throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=t.properties,this.geometricError=t.geometricError,this._extensionsUsed=t.extensionsUsed||[],this.extras=t.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}const cL="3.4.15",zg={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"};function uL(r,t,e){ci(r instanceof ArrayBuffer);const n=new TextDecoder("utf8"),i=new Uint8Array(r,t,e);return n.decode(i)}function Mtt(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const e=new DataView(r);return"".concat(String.fromCharCode(e.getUint8(t+0))).concat(String.fromCharCode(e.getUint8(t+1))).concat(String.fromCharCode(e.getUint8(t+2))).concat(String.fromCharCode(e.getUint8(t+3)))}const Rtt={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},ns={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},Fn={...Rtt,...ns},d2={[ns.DOUBLE]:Float64Array,[ns.FLOAT]:Float32Array,[ns.UNSIGNED_SHORT]:Uint16Array,[ns.UNSIGNED_INT]:Uint32Array,[ns.UNSIGNED_BYTE]:Uint8Array,[ns.BYTE]:Int8Array,[ns.SHORT]:Int16Array,[ns.INT]:Int32Array},Utt={DOUBLE:ns.DOUBLE,FLOAT:ns.FLOAT,UNSIGNED_SHORT:ns.UNSIGNED_SHORT,UNSIGNED_INT:ns.UNSIGNED_INT,UNSIGNED_BYTE:ns.UNSIGNED_BYTE,BYTE:ns.BYTE,SHORT:ns.SHORT,INT:ns.INT},f2="Failed to convert GL type";class Hc{static fromTypedArray(t){t=ArrayBuffer.isView(t)?t.constructor:t;for(const e in d2)if(d2[e]===t)return e;throw new Error(f2)}static fromName(t){const e=Utt[t];if(!e)throw new Error(f2);return e}static getArrayType(t){switch(t){case ns.UNSIGNED_SHORT_5_6_5:case ns.UNSIGNED_SHORT_4_4_4_4:case ns.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const e=d2[t];if(!e)throw new Error(f2);return e}}static getByteSize(t){return Hc.getArrayType(t).BYTES_PER_ELEMENT}static validate(t){return!!Hc.getArrayType(t)}static createTypedArray(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;i===void 0&&(i=(e.byteLength-n)/Hc.getByteSize(t));const s=Hc.getArrayType(t);return new s(e,n,i)}}function Ott(r,t){if(!r)throw new Error("math.gl assertion failed. ".concat(t))}function Dtt(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const e=r>>11&31,n=r>>5&63,i=r&31;return t[0]=e<<3,t[1]=n<<2,t[2]=i<<3,t}new Db,new ie,new Db,new Db;function AL(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:255;return Vu(r,0,t)/t*2-1}function hL(r){return r<0?-1:1}function Ntt(r,t,e,n){if(Ott(n),r<0||r>e||t<0||t>e)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(e));if(n.x=AL(r,e),n.y=AL(t,e),n.z=1-(Math.abs(n.x)+Math.abs(n.y)),n.z<0){const i=n.x;n.x=(1-Math.abs(n.y))*hL(i),n.y=(1-Math.abs(i))*hL(n.y)}return n.normalize()}function ktt(r,t,e){return Ntt(r,t,255,e)}class p2{constructor(t,e){j(this,"json",void 0),j(this,"buffer",void 0),j(this,"featuresLength",0),j(this,"_cachedTypedArrays",{}),this.json=t,this.buffer=e}getExtension(t){return this.json.extensions&&this.json.extensions[t]}hasProperty(t){return!!this.json[t]}getGlobalProperty(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Fn.UNSIGNED_INT,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=this.json[t];return i&&Number.isFinite(i.byteOffset)?this._getTypedArrayFromBinary(t,e,n,1,i.byteOffset):i}getPropertyArray(t,e,n){const i=this.json[t];return i&&Number.isFinite(i.byteOffset)?("componentType"in i&&(e=Hc.fromName(i.componentType)),this._getTypedArrayFromBinary(t,e,n,this.featuresLength,i.byteOffset)):this._getTypedArrayFromArray(t,e,i)}getProperty(t,e,n,i,s){const a=this.json[t];if(!a)return a;const o=this.getPropertyArray(t,e,n);if(n===1)return o[i];for(let d=0;d<n;++d)s[d]=o[n*i+d];return s}_getTypedArrayFromBinary(t,e,n,i,s){const a=this._cachedTypedArrays;let o=a[t];return o||(o=Hc.createTypedArray(e,this.buffer.buffer,this.buffer.byteOffset+s,i*n),a[t]=o),o}_getTypedArrayFromArray(t,e,n){const i=this._cachedTypedArrays;let s=i[t];return s||(s=Hc.createTypedArray(e,n),i[t]=s),s}}const Qtt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ztt={SCALAR:(r,t)=>r[t],VEC2:(r,t)=>[r[2*t+0],r[2*t+1]],VEC3:(r,t)=>[r[3*t+0],r[3*t+1],r[3*t+2]],VEC4:(r,t)=>[r[4*t+0],r[4*t+1],r[4*t+2],r[4*t+3]],MAT2:(r,t)=>[r[4*t+0],r[4*t+1],r[4*t+2],r[4*t+3]],MAT3:(r,t)=>[r[9*t+0],r[9*t+1],r[9*t+2],r[9*t+3],r[9*t+4],r[9*t+5],r[9*t+6],r[9*t+7],r[9*t+8]],MAT4:(r,t)=>[r[16*t+0],r[16*t+1],r[16*t+2],r[16*t+3],r[16*t+4],r[16*t+5],r[16*t+6],r[16*t+7],r[16*t+8],r[16*t+9],r[16*t+10],r[16*t+11],r[16*t+12],r[16*t+13],r[16*t+14],r[16*t+15]]},Htt={SCALAR:(r,t,e)=>{t[e]=r},VEC2:(r,t,e)=>{t[2*e+0]=r[0],t[2*e+1]=r[1]},VEC3:(r,t,e)=>{t[3*e+0]=r[0],t[3*e+1]=r[1],t[3*e+2]=r[2]},VEC4:(r,t,e)=>{t[4*e+0]=r[0],t[4*e+1]=r[1],t[4*e+2]=r[2],t[4*e+3]=r[3]},MAT2:(r,t,e)=>{t[4*e+0]=r[0],t[4*e+1]=r[1],t[4*e+2]=r[2],t[4*e+3]=r[3]},MAT3:(r,t,e)=>{t[9*e+0]=r[0],t[9*e+1]=r[1],t[9*e+2]=r[2],t[9*e+3]=r[3],t[9*e+4]=r[4],t[9*e+5]=r[5],t[9*e+6]=r[6],t[9*e+7]=r[7],t[9*e+8]=r[8],t[9*e+9]=r[9]},MAT4:(r,t,e)=>{t[16*e+0]=r[0],t[16*e+1]=r[1],t[16*e+2]=r[2],t[16*e+3]=r[3],t[16*e+4]=r[4],t[16*e+5]=r[5],t[16*e+6]=r[6],t[16*e+7]=r[7],t[16*e+8]=r[8],t[16*e+9]=r[9],t[16*e+10]=r[10],t[16*e+11]=r[11],t[16*e+12]=r[12],t[16*e+13]=r[13],t[16*e+14]=r[14],t[16*e+15]=r[15]}};function Vtt(r,t,e,n){const{componentType:i}=r;ci(r.componentType);const s=typeof i=="string"?Hc.fromName(i):i,a=Qtt[r.type],o=ztt[r.type],d=Htt[r.type];return e+=r.byteOffset,{values:Hc.createTypedArray(s,t,e,a*n),type:s,size:a,unpacker:o,packer:d}}const Vc=r=>r!==void 0;function Gtt(r,t,e){if(!t)return null;let n=r.getExtension("3DTILES_batch_table_hierarchy");const i=t.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),t.extensions=t.extensions||{},t.extensions["3DTILES_batch_table_hierarchy"]=i,n=i),n?jtt(n,e):null}function jtt(r,t){let e,n,i;const s=r.instancesLength,a=r.classes;let o=r.classIds,d=r.parentCounts,f=r.parentIds,_=s;Vc(o.byteOffset)&&(o.componentType=defaultValue(o.componentType,GL.UNSIGNED_SHORT),o.type=AttributeType.SCALAR,i=getBinaryAccessor(o),o=i.createArrayBufferView(t.buffer,t.byteOffset+o.byteOffset,s));let w;if(Vc(d))for(Vc(d.byteOffset)&&(d.componentType=defaultValue(d.componentType,GL.UNSIGNED_SHORT),d.type=AttributeType.SCALAR,i=getBinaryAccessor(d),d=i.createArrayBufferView(t.buffer,t.byteOffset+d.byteOffset,s)),w=new Uint16Array(s),_=0,e=0;e<s;++e)w[e]=_,_+=d[e];Vc(f)&&Vc(f.byteOffset)&&(f.componentType=defaultValue(f.componentType,GL.UNSIGNED_SHORT),f.type=AttributeType.SCALAR,i=getBinaryAccessor(f),f=i.createArrayBufferView(t.buffer,t.byteOffset+f.byteOffset,_));const x=a.length;for(e=0;e<x;++e){const N=a[e].length,Q=a[e].instances,V=getBinaryProperties(N,Q,t);a[e].instances=combine(V,Q)}const B=new Array(x).fill(0),P=new Uint16Array(s);for(e=0;e<s;++e)n=o[e],P[e]=B[n],++B[n];const R={classes:a,classIds:o,classIndexes:P,parentCounts:d,parentIndexes:w,parentIds:f};return $tt(R),R}function Hg(r,t,e){if(!r)return;const n=r.parentCounts;return r.parentIds?e(r,t):n>0?qtt(r,t,e):Ktt(r,t,e)}function qtt(r,t,e){const n=r.classIds,i=r.parentCounts,s=r.parentIds,a=r.parentIndexes,o=n.length,d=scratchVisited;d.length=Math.max(d.length,o);const f=++marker,_=scratchStack;for(_.length=0,_.push(t);_.length>0;){if(t=_.pop(),d[t]===f)continue;d[t]=f;const w=e(r,t);if(Vc(w))return w;const x=i[t],B=a[t];for(let P=0;P<x;++P){const R=s[B+P];R!==t&&_.push(R)}}return null}function Ktt(r,t,e){let n=!0;for(;n;){const i=e(r,t);if(Vc(i))return i;const s=r.parentIds[t];n=s!==t,t=s}throw new Error("traverseHierarchySingleParent")}function $tt(r){const e=r.classIds.length;for(let n=0;n<e;++n)dL(r,n,stack)}function dL(r,t,e){const n=r.parentCounts,i=r.parentIds,s=r.parentIndexes,o=r.classIds.length;if(!Vc(i))return;assert(t<o,"Parent index ".concat(t," exceeds the total number of instances: ").concat(o)),assert(e.indexOf(t)===-1,"Circular dependency detected in the batch table hierarchy."),e.push(t);const d=Vc(n)?n[t]:1,f=Vc(n)?s[t]:t;for(let _=0;_<d;++_){const w=i[f+_];w!==t&&dL(r,w,e)}e.pop(t)}function Aa(r){return r!=null}const Py=(r,t)=>r,Wtt={HIERARCHY:!0,extensions:!0,extras:!0};class fL{constructor(t,e,n){var i;let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};j(this,"json",void 0),j(this,"binary",void 0),j(this,"featureCount",void 0),j(this,"_extensions",void 0),j(this,"_properties",void 0),j(this,"_binaryProperties",void 0),j(this,"_hierarchy",void 0),ci(n>=0),this.json=t||{},this.binary=e,this.featureCount=n,this._extensions=((i=this.json)===null||i===void 0?void 0:i.extensions)||{},this._properties={};for(const a in this.json)Wtt[a]||(this._properties[a]=this.json[a]);this._binaryProperties=this._initializeBinaryProperties(),s["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=Gtt(this,this.json,this.binary))}getExtension(t){return this.json&&this.json.extensions&&this.json.extensions[t]}memorySizeInBytes(){return 0}isClass(t,e){if(this._checkBatchId(t),ci(typeof e=="string",e),this._hierarchy){const n=Hg(this._hierarchy,t,(i,s)=>{const a=i.classIds[s];return i.classes[a].name===e});return Aa(n)}return!1}isExactClass(t,e){return ci(typeof e=="string",e),this.getExactClassName(t)===e}getExactClassName(t){if(this._checkBatchId(t),this._hierarchy){const e=this._hierarchy.classIds[t];return this._hierarchy.classes[e].name}}hasProperty(t,e){return this._checkBatchId(t),ci(typeof e=="string",e),Aa(this._properties[e])||this._hasPropertyInHierarchy(t,e)}getPropertyNames(t,e){this._checkBatchId(t),e=Aa(e)?e:[],e.length=0;const n=Object.keys(this._properties);return e.push(...n),this._hierarchy&&this._getPropertyNamesInHierarchy(t,e),e}getProperty(t,e){if(this._checkBatchId(t),ci(typeof e=="string",e),this._binaryProperties){const i=this._binaryProperties[e];if(Aa(i))return this._getBinaryProperty(i,t)}const n=this._properties[e];if(Aa(n))return Py(n[t]);if(this._hierarchy){const i=this._getHierarchyProperty(t,e);if(Aa(i))return i}}setProperty(t,e,n){const i=this.featureCount;if(this._checkBatchId(t),ci(typeof e=="string",e),this._binaryProperties){const a=this._binaryProperties[e];if(a){this._setBinaryProperty(a,t,n);return}}if(this._hierarchy&&this._setHierarchyProperty(this,t,e,n))return;let s=this._properties[e];Aa(s)||(this._properties[e]=new Array(i),s=this._properties[e]),s[t]=Py(n)}_checkBatchId(t){if(!(t>=0&&t<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(t,e){return t.unpack(t.typedArray,e)}_setBinaryProperty(t,e,n){t.pack(n,t.typedArray,e)}_initializeBinaryProperties(){let t=null;for(const e in this._properties){const n=this._properties[e],i=this._initializeBinaryProperty(e,n);i&&(t=t||{},t[e]=i)}return t}_initializeBinaryProperty(t,e){if("byteOffset"in e){const n=e;ci(this.binary,"Property ".concat(t," requires a batch table binary.")),ci(n.type,"Property ".concat(t," requires a type."));const i=Vtt(n,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:i.values,componentCount:i.size,unpack:i.unpacker,pack:i.packer}}return null}_hasPropertyInHierarchy(t,e){if(!this._hierarchy)return!1;const n=Hg(this._hierarchy,t,(i,s)=>{const a=i.classIds[s],o=i.classes[a].instances;return Aa(o[e])});return Aa(n)}_getPropertyNamesInHierarchy(t,e){Hg(this._hierarchy,t,(n,i)=>{const s=n.classIds[i],a=n.classes[s].instances;for(const o in a)a.hasOwnProperty(o)&&e.indexOf(o)===-1&&e.push(o)})}_getHierarchyProperty(t,e){return Hg(this._hierarchy,t,(n,i)=>{const s=n.classIds[i],a=n.classes[s],o=n.classIndexes[i],d=a.instances[e];return Aa(d)?Aa(d.typedArray)?this._getBinaryProperty(d,o):Py(d[o]):null})}_setHierarchyProperty(t,e,n,i){const s=Hg(this._hierarchy,e,(a,o)=>{const d=a.classIds[o],f=a.classes[d],_=a.classIndexes[o],w=f.instances[n];return Aa(w)?(ci(o===e,'Inherited property "'.concat(n,'" is read-only.')),Aa(w.typedArray)?this._setBinaryProperty(w,_,i):w[_]=Py(i),!0):!1});return Aa(s)}}const g2=4;function My(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const n=new DataView(t);if(r.magic=n.getUint32(e,!0),e+=g2,r.version=n.getUint32(e,!0),e+=g2,r.byteLength=n.getUint32(e,!0),e+=g2,r.version!==1)throw new Error("3D Tile Version ".concat(r.version," not supported"));return e}const Ef=4,pL="b3dm tile in legacy format.";function m2(r,t,e){const n=new DataView(t);let i;r.header=r.header||{};let s=n.getUint32(e,!0);e+=Ef;let a=n.getUint32(e,!0);e+=Ef;let o=n.getUint32(e,!0);e+=Ef;let d=n.getUint32(e,!0);return e+=Ef,o>=570425344?(e-=Ef*2,i=s,o=a,d=0,s=0,a=0,console.warn(pL)):d>=570425344&&(e-=Ef,i=o,o=s,d=a,s=0,a=0,console.warn(pL)),r.header.featureTableJsonByteLength=s,r.header.featureTableBinaryByteLength=a,r.header.batchTableJsonByteLength=o,r.header.batchTableBinaryByteLength=d,r.header.batchLength=i,e}function y2(r,t,e,n){return e=Xtt(r,t,e),e=Jtt(r,t,e),e}function Xtt(r,t,e,n){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:s,batchLength:a}=r.header;if(r.featureTableJson={BATCH_LENGTH:a||0},i>0){const o=uL(t,e,i);r.featureTableJson=JSON.parse(o)}return e+=i,r.featureTableBinary=new Uint8Array(t,e,s),e+=s,e}function Jtt(r,t,e,n){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:s}=r.header;if(i>0){const a=uL(t,e,i);r.batchTableJson=JSON.parse(a),e+=i,s>0&&(r.batchTableBinary=new Uint8Array(t,e,s),r.batchTableBinary=new Uint8Array(r.batchTableBinary),e+=s)}return e}function gL(r,t,e){if(!t&&(!r||!r.batchIds||!e))return null;const{batchIds:n,isRGB565:i,pointCount:s}=r;if(n&&e){const a=new Uint8ClampedArray(s*3);for(let o=0;o<s;o++){const d=n[o],_=e.getProperty(d,"dimensions").map(w=>w*255);a[o*3]=_[0],a[o*3+1]=_[1],a[o*3+2]=_[2]}return{type:Fn.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}if(i){const a=new Uint8ClampedArray(s*3);for(let o=0;o<s;o++){const d=Dtt(t[o]);a[o*3]=d[0],a[o*3+1]=d[1],a[o*3+2]=d[2]}return{type:Fn.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}return t&&t.length===s*3?{type:Fn.UNSIGNED_BYTE,value:t,size:3,normalized:!0}:{type:Fn.UNSIGNED_BYTE,value:t,size:4,normalized:!0}}const mL=new ie;function Ytt(r,t){if(!t)return null;if(r.isOctEncoded16P){const e=new Float32Array(r.pointsLength*3);for(let n=0;n<r.pointsLength;n++)ktt(t[n*2],t[n*2+1],mL),mL.toArray(e,n*3);return{type:Fn.FLOAT,size:2,value:e}}return{type:Fn.FLOAT,size:2,value:t}}function Ztt(r,t,e){return r.isQuantized?e["3d-tiles"]&&e["3d-tiles"].decodeQuantizedPositions?(r.isQuantized=!1,tet(r,t)):{type:Fn.UNSIGNED_SHORT,value:t,size:3,normalized:!0}:t}function tet(r,t){const e=new ie,n=new Float32Array(r.pointCount*3);for(let i=0;i<r.pointCount;i++)e.set(t[i*3],t[i*3+1],t[i*3+2]).scale(1/r.quantizedRange).multiply(r.quantizedVolumeScale).add(r.quantizedVolumeOffset).toArray(n,i*3);return n}async function eet(r,t,e,n,i){e=My(r,t,e),e=m2(r,t,e),e=y2(r,t,e),ret(r);const{featureTable:s,batchTable:a}=net(r);return await cet(r,s,a,n,i),iet(r,s,n),set(r,s,a),oet(r,s),e}function ret(r){r.attributes={positions:null,colors:null,normals:null,batchIds:null},r.isQuantized=!1,r.isTranslucent=!1,r.isRGB565=!1,r.isOctEncoded16P=!1}function net(r){const t=new p2(r.featureTableJson,r.featureTableBinary),e=t.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(e))throw new Error("POINTS_LENGTH must be defined");t.featuresLength=e,r.featuresLength=e,r.pointsLength=e,r.pointCount=e,r.rtcCenter=t.getGlobalProperty("RTC_CENTER",Fn.FLOAT,3);const n=aet(r,t);return{featureTable:t,batchTable:n}}function iet(r,t,e){if(!r.attributes.positions){if(t.hasProperty("POSITION"))r.attributes.positions=t.getPropertyArray("POSITION",Fn.FLOAT,3);else if(t.hasProperty("POSITION_QUANTIZED")){const n=t.getPropertyArray("POSITION_QUANTIZED",Fn.UNSIGNED_SHORT,3);if(r.isQuantized=!0,r.quantizedRange=65535,r.quantizedVolumeScale=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Fn.FLOAT,3),!r.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(r.quantizedVolumeOffset=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Fn.FLOAT,3),!r.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");r.attributes.positions=Ztt(r,n,e)}}if(!r.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function set(r,t,e){if(!r.attributes.colors){let n=null;t.hasProperty("RGBA")?(n=t.getPropertyArray("RGBA",Fn.UNSIGNED_BYTE,4),r.isTranslucent=!0):t.hasProperty("RGB")?n=t.getPropertyArray("RGB",Fn.UNSIGNED_BYTE,3):t.hasProperty("RGB565")&&(n=t.getPropertyArray("RGB565",Fn.UNSIGNED_SHORT,1),r.isRGB565=!0),r.attributes.colors=gL(r,n,e)}t.hasProperty("CONSTANT_RGBA")&&(r.constantRGBA=t.getGlobalProperty("CONSTANT_RGBA",Fn.UNSIGNED_BYTE,4))}function oet(r,t){if(!r.attributes.normals){let e=null;t.hasProperty("NORMAL")?e=t.getPropertyArray("NORMAL",Fn.FLOAT,3):t.hasProperty("NORMAL_OCT16P")&&(e=t.getPropertyArray("NORMAL_OCT16P",Fn.UNSIGNED_BYTE,2),r.isOctEncoded16P=!0),r.attributes.normals=Ytt(r,e)}}function aet(r,t){let e=null;if(!r.batchIds&&t.hasProperty("BATCH_ID")&&(r.batchIds=t.getPropertyArray("BATCH_ID",Fn.UNSIGNED_SHORT,1),r.batchIds)){const n=t.getGlobalProperty("BATCH_LENGTH");if(!n)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:s}=r;e=new fL(i,s,n)}return e}async function cet(r,t,e,n,i){let s,a,o;const d=r.batchTableJson&&r.batchTableJson.extensions&&r.batchTableJson.extensions["3DTILES_draco_point_compression"];d&&(o=d.properties);const f=t.getExtension("3DTILES_draco_point_compression");if(f){a=f.properties;const w=f.byteOffset,x=f.byteLength;if(!a||!Number.isFinite(w)||!x)throw new Error("Draco properties, byteOffset, and byteLength must be defined");s=r.featureTableBinary.slice(w,w+x),r.hasPositions=Number.isFinite(a.POSITION),r.hasColors=Number.isFinite(a.RGB)||Number.isFinite(a.RGBA),r.hasNormals=Number.isFinite(a.NORMAL),r.hasBatchIds=Number.isFinite(a.BATCH_ID),r.isTranslucent=Number.isFinite(a.RGBA)}if(!s)return!0;const _={buffer:s,properties:{...a,...o},featureTableProperties:a,batchTableProperties:o,dequantizeInShader:!1};return await uet(r,_,n,i)}async function uet(r,t,e,n){const{parse:i}=n,s={...e,draco:{...e.draco,extraAttributes:t.batchTableProperties||{}}};delete s["3d-tiles"];const a=await i(t.buffer,FF,s),o=a.attributes.POSITION&&a.attributes.POSITION.value,d=a.attributes.COLOR_0&&a.attributes.COLOR_0.value,f=a.attributes.NORMAL&&a.attributes.NORMAL.value,_=a.attributes.BATCH_ID&&a.attributes.BATCH_ID.value,w=o&&a.attributes.POSITION.value.quantization,x=f&&a.attributes.NORMAL.value.quantization;if(w){const P=a.POSITION.data.quantization,R=P.range;r.quantizedVolumeScale=new ie(R,R,R),r.quantizedVolumeOffset=new ie(P.minValues),r.quantizedRange=(1<<P.quantizationBits)-1,r.isQuantizedDraco=!0}x&&(r.octEncodedRange=(1<<a.NORMAL.data.quantization.quantizationBits)-1,r.isOctEncodedDraco=!0);const B={};if(t.batchTableProperties)for(const P of Object.keys(t.batchTableProperties))a.attributes[P]&&a.attributes[P].value&&(B[P.toLowerCase()]=a.attributes[P].value);r.attributes={positions:o,colors:gL(r,d,void 0),normals:f,batchIds:_,...B}}const _2={URI:0,EMBEDDED:1};function yL(r,t,e,n){r.rotateYtoZ=!0;const i=r.byteOffset+r.byteLength-e;if(i===0)throw new Error("glTF byte length must be greater than 0.");return r.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y",r.gltfArrayBuffer=zv(t,e,i),r.gltfByteOffset=0,r.gltfByteLength=i,e%4===0||console.warn("".concat(r.type,": embedded glb is not aligned to a 4-byte boundary.")),r.byteOffset+r.byteLength}async function _L(r,t,e,n){const i=e["3d-tiles"]||{};if(Aet(r,t),i.loadGLTF){const{parse:s,fetch:a}=n;r.gltfUrl&&(r.gltfArrayBuffer=await a(r.gltfUrl,e),r.gltfByteOffset=0),r.gltfArrayBuffer&&(r.gltf=await s(r.gltfArrayBuffer,kg,e,n),r.gpuMemoryUsageInBytes=EF(r.gltf),delete r.gltfArrayBuffer,delete r.gltfByteOffset,delete r.gltfByteLength)}}function Aet(r,t,e){switch(t){case _2.URI:const n=new Uint8Array(r.gltfArrayBuffer,r.gltfByteOffset),s=new TextDecoder().decode(n);r.gltfUrl=s.replace(/[\s\0]+$/,""),delete r.gltfArrayBuffer,delete r.gltfByteOffset,delete r.gltfByteLength;break;case _2.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function het(r,t,e,n,i){var s;e=det(r,t,e,n),await _L(r,_2.EMBEDDED,n,i);const a=r==null||(s=r.gltf)===null||s===void 0?void 0:s.extensions;return a&&a.CESIUM_RTC&&(r.rtcCenter=a.CESIUM_RTC.center),e}function det(r,t,e,n,i){e=My(r,t,e),e=m2(r,t,e),e=y2(r,t,e),e=yL(r,t,e,n);const s=new p2(r.featureTableJson,r.featureTableBinary);return r.rtcCenter=s.getGlobalProperty("RTC_CENTER",Fn.FLOAT,3),e}async function fet(r,t,e,n,i){return e=pet(r,t,e,n),await _L(r,r.gltfFormat,n,i),e}function pet(r,t,e,n,i){if(e=My(r,t,e),r.version!==1)throw new Error("Instanced 3D Model version ".concat(r.version," is not supported"));e=m2(r,t,e);const s=new DataView(t);if(r.gltfFormat=s.getUint32(e,!0),e+=4,e=y2(r,t,e),e=yL(r,t,e,n),r.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const a=new p2(r.featureTableJson,r.featureTableBinary),o=a.getGlobalProperty("INSTANCES_LENGTH");if(a.featuresLength=o,!Number.isFinite(o))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");r.eastNorthUp=a.getGlobalProperty("EAST_NORTH_UP"),r.rtcCenter=a.getGlobalProperty("RTC_CENTER",Fn.FLOAT,3);const d=new fL(r.batchTableJson,r.batchTableBinary,o);return get(r,a,d,o),e}function get(r,t,e,n){const s={instances:new Array(n),batchTable:r._batchTable,cull:!1,url:void 0,gltf:void 0,basePath:void 0,incrementallyLoadTextures:!1,forwardAxis:[1,0,0]}.instances,a=new ie;new ie,new ie,new ie;const o=new Oi,d=new _g,f=new ie,_={},w=new xn,x=[],B=[],P=new ie,R=new ie;for(let N=0;N<n;N++){let Q;if(t.hasProperty("POSITION"))Q=t.getProperty("POSITION",Fn.FLOAT,3,N,a);else if(t.hasProperty("POSITION_QUANTIZED")){Q=t.getProperty("POSITION_QUANTIZED",Fn.UNSIGNED_SHORT,3,N,a);const gt=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Fn.FLOAT,3,P);if(!gt)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const ht=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Fn.FLOAT,3,R);if(!ht)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const It=65535;for(let St=0;St<3;St++)Q[St]=Q[St]/It*ht[St]+gt[St]}if(!Q)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");if(a.copy(Q),_.translation=a,r.normalUp=t.getProperty("NORMAL_UP",Fn.FLOAT,3,N,x),r.normalRight=t.getProperty("NORMAL_RIGHT",Fn.FLOAT,3,N,B),r.normalUp){if(!r.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");r.hasCustomOrientation=!0}else{if(r.octNormalUp=t.getProperty("NORMAL_UP_OCT32P",Fn.UNSIGNED_SHORT,2,x),r.octNormalRight=t.getProperty("NORMAL_RIGHT_OCT32P",Fn.UNSIGNED_SHORT,2,B),r.octNormalUp)throw r.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");r.eastNorthUp?(Fi.WGS84.eastNorthUpToFixedFrame(a,w),w.getRotationMatrix3(o)):o.identity()}d.fromMatrix3(o),_.rotation=d,f.set(1,1,1);const V=t.getProperty("SCALE",Fn.FLOAT,1,N);Number.isFinite(V)&&f.multiplyByScalar(V);const W=t.getProperty("SCALE_NON_UNIFORM",Fn.FLOAT,3,N,x);W&&f.scale(W),_.scale=f;let et=t.getProperty("BATCH_ID",Fn.UNSIGNED_SHORT,1,N);et===void 0&&(et=N);const ct=new xn().fromQuaternion(_.rotation);w.identity(),w.translate(_.translation),w.multiplyRight(ct),w.scale(_.scale);const dt=w.clone();s[N]={modelMatrix:dt,batchId:et}}r.instances=s}async function met(r,t,e,n,i,s){e=My(r,t,e);const a=new DataView(t);for(r.tilesLength=a.getUint32(e,!0),e+=4,r.tiles=[];r.tiles.length<r.tilesLength&&r.byteLength-e>12;){const o={};r.tiles.push(o),e=await s(t,e,n,i,o)}return e}async function yet(r,t,e,n){r.rotateYtoZ=!0,r.gltfUpAxis=e["3d-tiles"]&&e["3d-tiles"].assetGltfUpAxis?e["3d-tiles"].assetGltfUpAxis:"Y";const{parse:i}=n;r.gltf=await i(t,kg,e,n),r.gpuMemoryUsageInBytes=EF(r.gltf)}async function vL(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};switch(i.byteOffset=t,i.type=Mtt(r,t),i.type){case zg.COMPOSITE:return await met(i,r,t,e,n,vL);case zg.BATCHED_3D_MODEL:return await het(i,r,t,e,n);case zg.GLTF:return await yet(i,r,e,n);case zg.INSTANCED_3D_MODEL:return await fet(i,r,t,e,n);case zg.POINT_CLOUD:return await eet(i,r,t,e,n);default:throw new Error("3DTileLoader: unknown type ".concat(i.type))}}const _et=1952609651,vet=1;async function bet(r,t,e){if(new Uint32Array(r.slice(0,4))[0]!==_et)throw new Error("Wrong subtree file magic number");if(new Uint32Array(r.slice(4,8))[0]!==vet)throw new Error("Wrong subtree file verson, must be 1");const s=bL(r.slice(8,16)),a=new Uint8Array(r,24,s),d=new TextDecoder("utf8").decode(a),f=JSON.parse(d),_=bL(r.slice(16,24));let w=new ArrayBuffer(0);return _&&(w=r.slice(24+s)),"bufferView"in f.tileAvailability&&(f.tileAvailability.explicitBitstream=await v2(f,"tileAvailability",w,e)),"bufferView"in f.contentAvailability&&(f.contentAvailability.explicitBitstream=await v2(f,"contentAvailability",w,e)),"bufferView"in f.childSubtreeAvailability&&(f.childSubtreeAvailability.explicitBitstream=await v2(f,"childSubtreeAvailability",w,e)),f}function wet(r,t){if(t.startsWith("http")){const s=new URL(r,t);return decodeURI(s.toString())}const n="http://".concat(t),i=new URL(r,n);return"/".concat(i.host).concat(i.pathname)}async function v2(r,t,e,n){const i=r[t].bufferView,s=r.bufferViews[i],a=r.buffers[s.buffer];if(!(n!=null&&n.url)||!n.fetch)throw new Error("Url is not provided");if(!n.fetch)throw new Error("fetch is not provided");if(a.uri){const o=wet(a.uri,n==null?void 0:n.url),f=await(await n.fetch(o)).arrayBuffer();return new Uint8Array(f,s.byteOffset,s.byteLength)}return new Uint8Array(e,s.byteOffset,s.byteLength)}function bL(r){const t=new DataView(r),e=t.getUint32(0,!0),n=t.getUint32(4,!0);return e+2**32*n}const wL={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:cL,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:bet,options:{}};/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var yl=null;try{yl=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Wn(r,t,e){this.low=r|0,this.high=t|0,this.unsigned=!!e}Wn.prototype.__isLong__,Object.defineProperty(Wn.prototype,"__isLong__",{value:!0});function po(r){return(r&&r.__isLong__)===!0}function xL(r){var t=Math.clz32(r&-r);return r?31-t:t}Wn.isLong=po;var BL={},CL={};function $h(r,t){var e,n,i;return t?(r>>>=0,(i=0<=r&&r<256)&&(n=CL[r],n)?n:(e=Mn(r,0,!0),i&&(CL[r]=e),e)):(r|=0,(i=-128<=r&&r<128)&&(n=BL[r],n)?n:(e=Mn(r,r<0?-1:0,!1),i&&(BL[r]=e),e))}Wn.fromInt=$h;function _l(r,t){if(isNaN(r))return t?Ku:tc;if(t){if(r<0)return Ku;if(r>=SL)return PL}else{if(r<=-TL)return ha;if(r+1>=TL)return LL}return r<0?_l(-r,t).neg():Mn(r%Sf|0,r/Sf|0,t)}Wn.fromNumber=_l;function Mn(r,t,e){return new Wn(r,t,e)}Wn.fromBits=Mn;var Ry=Math.pow;function b2(r,t,e){if(r.length===0)throw Error("empty string");if(typeof t=="number"?(e=t,t=!1):t=!!t,r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return t?Ku:tc;if(e=e||10,e<2||36<e)throw RangeError("radix");var n;if((n=r.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return b2(r.substring(1),t,e).neg();for(var i=_l(Ry(e,8)),s=tc,a=0;a<r.length;a+=8){var o=Math.min(8,r.length-a),d=parseInt(r.substring(a,a+o),e);if(o<8){var f=_l(Ry(e,o));s=s.mul(f).add(_l(d))}else s=s.mul(i),s=s.add(_l(d))}return s.unsigned=t,s}Wn.fromString=b2;function Zl(r,t){return typeof r=="number"?_l(r,t):typeof r=="string"?b2(r,t):Mn(r.low,r.high,typeof t=="boolean"?t:r.unsigned)}Wn.fromValue=Zl;var EL=65536,xet=1<<24,Sf=EL*EL,SL=Sf*Sf,TL=SL/2,IL=$h(xet),tc=$h(0);Wn.ZERO=tc;var Ku=$h(0,!0);Wn.UZERO=Ku;var Tf=$h(1);Wn.ONE=Tf;var FL=$h(1,!0);Wn.UONE=FL;var w2=$h(-1);Wn.NEG_ONE=w2;var LL=Mn(-1,2147483647,!1);Wn.MAX_VALUE=LL;var PL=Mn(-1,-1,!0);Wn.MAX_UNSIGNED_VALUE=PL;var ha=Mn(0,-2147483648,!1);Wn.MIN_VALUE=ha;var Ve=Wn.prototype;Ve.toInt=function(){return this.unsigned?this.low>>>0:this.low},Ve.toNumber=function(){return this.unsigned?(this.high>>>0)*Sf+(this.low>>>0):this.high*Sf+(this.low>>>0)},Ve.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ha)){var e=_l(t),n=this.div(e),i=n.mul(e).sub(this);return n.toString(t)+i.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var s=_l(Ry(t,6),this.unsigned),a=this,o="";;){var d=a.div(s),f=a.sub(d.mul(s)).toInt()>>>0,_=f.toString(t);if(a=d,a.isZero())return _+o;for(;_.length<6;)_="0"+_;o=""+_+o}},Ve.getHighBits=function(){return this.high},Ve.getHighBitsUnsigned=function(){return this.high>>>0},Ve.getLowBits=function(){return this.low},Ve.getLowBitsUnsigned=function(){return this.low>>>0},Ve.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ha)?64:this.neg().getNumBitsAbs();for(var t=this.high!=0?this.high:this.low,e=31;e>0&&!(t&1<<e);e--);return this.high!=0?e+33:e+1},Ve.isZero=function(){return this.high===0&&this.low===0},Ve.eqz=Ve.isZero,Ve.isNegative=function(){return!this.unsigned&&this.high<0},Ve.isPositive=function(){return this.unsigned||this.high>=0},Ve.isOdd=function(){return(this.low&1)===1},Ve.isEven=function(){return(this.low&1)===0},Ve.equals=function(t){return po(t)||(t=Zl(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low},Ve.eq=Ve.equals,Ve.notEquals=function(t){return!this.eq(t)},Ve.neq=Ve.notEquals,Ve.ne=Ve.notEquals,Ve.lessThan=function(t){return this.comp(t)<0},Ve.lt=Ve.lessThan,Ve.lessThanOrEqual=function(t){return this.comp(t)<=0},Ve.lte=Ve.lessThanOrEqual,Ve.le=Ve.lessThanOrEqual,Ve.greaterThan=function(t){return this.comp(t)>0},Ve.gt=Ve.greaterThan,Ve.greaterThanOrEqual=function(t){return this.comp(t)>=0},Ve.gte=Ve.greaterThanOrEqual,Ve.ge=Ve.greaterThanOrEqual,Ve.compare=function(t){if(po(t)||(t=Zl(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},Ve.comp=Ve.compare,Ve.negate=function(){return!this.unsigned&&this.eq(ha)?ha:this.not().add(Tf)},Ve.neg=Ve.negate,Ve.add=function(t){po(t)||(t=Zl(t));var e=this.high>>>16,n=this.high&65535,i=this.low>>>16,s=this.low&65535,a=t.high>>>16,o=t.high&65535,d=t.low>>>16,f=t.low&65535,_=0,w=0,x=0,B=0;return B+=s+f,x+=B>>>16,B&=65535,x+=i+d,w+=x>>>16,x&=65535,w+=n+o,_+=w>>>16,w&=65535,_+=e+a,_&=65535,Mn(x<<16|B,_<<16|w,this.unsigned)},Ve.subtract=function(t){return po(t)||(t=Zl(t)),this.add(t.neg())},Ve.sub=Ve.subtract,Ve.multiply=function(t){if(this.isZero())return this;if(po(t)||(t=Zl(t)),yl){var e=yl.mul(this.low,this.high,t.low,t.high);return Mn(e,yl.get_high(),this.unsigned)}if(t.isZero())return this.unsigned?Ku:tc;if(this.eq(ha))return t.isOdd()?ha:tc;if(t.eq(ha))return this.isOdd()?ha:tc;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(IL)&&t.lt(IL))return _l(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,i=this.high&65535,s=this.low>>>16,a=this.low&65535,o=t.high>>>16,d=t.high&65535,f=t.low>>>16,_=t.low&65535,w=0,x=0,B=0,P=0;return P+=a*_,B+=P>>>16,P&=65535,B+=s*_,x+=B>>>16,B&=65535,B+=a*f,x+=B>>>16,B&=65535,x+=i*_,w+=x>>>16,x&=65535,x+=s*f,w+=x>>>16,x&=65535,x+=a*d,w+=x>>>16,x&=65535,w+=n*_+i*f+s*d+a*o,w&=65535,Mn(B<<16|P,w<<16|x,this.unsigned)},Ve.mul=Ve.multiply,Ve.divide=function(t){if(po(t)||(t=Zl(t)),t.isZero())throw Error("division by zero");if(yl){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var e=(this.unsigned?yl.div_u:yl.div_s)(this.low,this.high,t.low,t.high);return Mn(e,yl.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Ku:tc;var n,i,s;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return Ku;if(t.gt(this.shru(1)))return FL;s=Ku}else{if(this.eq(ha)){if(t.eq(Tf)||t.eq(w2))return ha;if(t.eq(ha))return Tf;var a=this.shr(1);return n=a.div(t).shl(1),n.eq(tc)?t.isNegative()?Tf:w2:(i=this.sub(t.mul(n)),s=n.add(i.div(t)),s)}else if(t.eq(ha))return this.unsigned?Ku:tc;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();s=tc}for(i=this;i.gte(t);){n=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),d=o<=48?1:Ry(2,o-48),f=_l(n),_=f.mul(t);_.isNegative()||_.gt(i);)n-=d,f=_l(n,this.unsigned),_=f.mul(t);f.isZero()&&(f=Tf),s=s.add(f),i=i.sub(_)}return s},Ve.div=Ve.divide,Ve.modulo=function(t){if(po(t)||(t=Zl(t)),yl){var e=(this.unsigned?yl.rem_u:yl.rem_s)(this.low,this.high,t.low,t.high);return Mn(e,yl.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))},Ve.mod=Ve.modulo,Ve.rem=Ve.modulo,Ve.not=function(){return Mn(~this.low,~this.high,this.unsigned)},Ve.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},Ve.clz=Ve.countLeadingZeros,Ve.countTrailingZeros=function(){return this.low?xL(this.low):xL(this.high)+32},Ve.ctz=Ve.countTrailingZeros,Ve.and=function(t){return po(t)||(t=Zl(t)),Mn(this.low&t.low,this.high&t.high,this.unsigned)},Ve.or=function(t){return po(t)||(t=Zl(t)),Mn(this.low|t.low,this.high|t.high,this.unsigned)},Ve.xor=function(t){return po(t)||(t=Zl(t)),Mn(this.low^t.low,this.high^t.high,this.unsigned)},Ve.shiftLeft=function(t){return po(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?Mn(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):Mn(0,this.low<<t-32,this.unsigned)},Ve.shl=Ve.shiftLeft,Ve.shiftRight=function(t){return po(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?Mn(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):Mn(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},Ve.shr=Ve.shiftRight,Ve.shiftRightUnsigned=function(t){return po(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?Mn(this.low>>>t|this.high<<32-t,this.high>>>t,this.unsigned):t===32?Mn(this.high,0,this.unsigned):Mn(this.high>>>t-32,0,this.unsigned)},Ve.shru=Ve.shiftRightUnsigned,Ve.shr_u=Ve.shiftRightUnsigned,Ve.rotateLeft=function(t){var e;return po(t)&&(t=t.toInt()),(t&=63)===0?this:t===32?Mn(this.high,this.low,this.unsigned):t<32?(e=32-t,Mn(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned)):(t-=32,e=32-t,Mn(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned))},Ve.rotl=Ve.rotateLeft,Ve.rotateRight=function(t){var e;return po(t)&&(t=t.toInt()),(t&=63)===0?this:t===32?Mn(this.high,this.low,this.unsigned):t<32?(e=32-t,Mn(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned)):(t-=32,e=32-t,Mn(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned))},Ve.rotr=Ve.rotateRight,Ve.toSigned=function(){return this.unsigned?Mn(this.low,this.high,!1):this},Ve.toUnsigned=function(){return this.unsigned?this:Mn(this.low,this.high,!0)},Ve.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},Ve.toBytesLE=function(){var t=this.high,e=this.low;return[e&255,e>>>8&255,e>>>16&255,e>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]},Ve.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,e>>>24,e>>>16&255,e>>>8&255,e&255]},Wn.fromBytes=function(t,e,n){return n?Wn.fromBytesLE(t,e):Wn.fromBytesBE(t,e)},Wn.fromBytesLE=function(t,e){return new Wn(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},Wn.fromBytesBE=function(t,e){return new Wn(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)};const Bet=16;function ML(r){r==="X"&&(r="");const t=r.padEnd(Bet,"0");return Wn.fromString(t,!0,16)}function Cet(r){if(r.isZero())return"X";let t=r.countTrailingZeros();const e=t%4;t=(t-e)/4;const n=t;t*=4;const s=r.shiftRightUnsigned(t).toString(16).replace(/0+$/,"");return Array(17-n-s.length).join("0")+s}function Eet(r,t){const e=Tet(r).shiftRightUnsigned(2);return r.add(Wn.fromNumber(2*t+1-4).multiply(e))}function Tet(r){return r.and(r.not().add(1))}const Iet=3,Fet=2*30+1,RL=180/Math.PI;function Let(r){if(r.length===0)throw new Error("Invalid Hilbert quad key ".concat(r));const t=r.split("/"),e=parseInt(t[0],10),n=t[1],i=n.length;let s=0;const a=[0,0];for(let o=i-1;o>=0;o--){s=i-o;const d=n[o];let f=0,_=0;d==="1"?_=1:d==="2"?(f=1,_=1):d==="3"&&(f=1);const w=Math.pow(2,s-1);Met(w,a,f,_),a[0]+=w*f,a[1]+=w*_}if(e%2===1){const o=a[0];a[0]=a[1],a[1]=o}return{face:e,ij:a,level:s}}function Pet(r){if(r.isZero())return"";let t=r.toString(2);for(;t.length<Iet+Fet;)t="0"+t;const e=t.lastIndexOf("1"),n=t.substring(0,3),i=t.substring(3,e),s=i.length/2,a=Wn.fromString(n,!0,2).toString(10);let o="";if(s!==0)for(o=Wn.fromString(i,!0,2).toString(4);o.length<s;)o="0"+o;return"".concat(a,"/").concat(o)}function UL(r,t,e){const n=1<<t;return[(r[0]+e[0])/n,(r[1]+e[1])/n]}function OL(r){return r>=.5?1/3*(4*r*r-1):1/3*(1-4*(1-r)*(1-r))}function DL(r){return[OL(r[0]),OL(r[1])]}function NL(r,t){let[e,n]=t;switch(r){case 0:return[1,e,n];case 1:return[-e,1,n];case 2:return[-e,-n,1];case 3:return[-1,-n,-e];case 4:return[n,-1,-e];case 5:return[n,e,-1];default:throw new Error("Invalid face")}}function kL(r){let[t,e,n]=r;const i=Math.atan2(n,Math.sqrt(t*t+e*e));return[Math.atan2(e,t)*RL,i*RL]}function Met(r,t,e,n){if(n===0){e===1&&(t[0]=r-1-t[0],t[1]=r-1-t[1]);const i=t[0];t[0]=t[1],t[1]=i}}function Ret(r){const t=UL(r.ij,r.level,[.5,.5]),e=DL(t),n=NL(r.face,e);return kL(n)}const Uet=100;function QL(r){const{face:t,ij:e,level:n}=r,i=[[0,0],[0,1],[1,1],[1,0],[0,0]],s=Math.max(1,Math.ceil(Uet*Math.pow(2,-n))),a=new Float64Array(4*s*2+2);let o=0,d=0;for(let f=0;f<4;f++){const _=i[f].slice(0),w=i[f+1],x=(w[0]-_[0])/s,B=(w[1]-_[1])/s;for(let P=0;P<s;P++){_[0]+=x,_[1]+=B;const R=UL(e,n,_),N=DL(R),Q=NL(t,N),V=kL(Q);Math.abs(V[1])>89.999&&(V[0]=d);const W=V[0]-d;V[0]+=W>180?-360:W<-180?360:0,a[o++]=V[0],a[o++]=V[1],d=V[0]}}return a[o++]=a[0],a[o++]=a[1],a}function x2(r){const t=Oet(r);return Let(t)}function Oet(r){if(r.indexOf("/")>0)return r;const t=ML(r);return Pet(t)}function Det(r){const t=x2(r);return Ret(t)}function Net(r){let t;if(r.face===2||r.face===5){let e=null,n=0;for(let i=0;i<4;i++){const s="".concat(r.face,"/").concat(i),a=x2(s),o=QL(a);(typeof e>"u"||e===null)&&(e=new Float64Array(4*o.length)),e.set(o,n),n+=o.length}t=zL(e)}else{const e=QL(r);t=zL(e)}return t}function zL(r){if(r.length%2!==0)throw new Error("Invalid corners");const t=[],e=[];for(let n=0;n<r.length;n+=2)t.push(r[n]),e.push(r[n+1]);return t.sort((n,i)=>n-i),e.sort((n,i)=>n-i),{west:t[0],east:t[t.length-1],north:e[e.length-1],south:e[0]}}function ket(r,t){const e=(t==null?void 0:t.minimumHeight)||0,n=(t==null?void 0:t.maximumHeight)||0,i=x2(r),s=Net(i),a=s.west,o=s.south,d=s.east,f=s.north,_=[];return _.push(new ie(a,f,e)),_.push(new ie(d,f,e)),_.push(new ie(d,o,e)),_.push(new ie(a,o,e)),_.push(new ie(a,f,n)),_.push(new ie(d,f,n)),_.push(new ie(d,o,n)),_.push(new ie(a,o,n)),_}function HL(r){const t=r.token,e={minimumHeight:r.minimumHeight,maximumHeight:r.maximumHeight},n=ket(t,e),i=Det(t),s=i[0],a=i[1],o=Fi.WGS84.cartographicToCartesian([s,a,e.maximumHeight]),d=new ie(o[0],o[1],o[2]);n.push(d);const f=mX(n);return[...f.center,...f.halfAxes]}const Qet={QUADTREE:4,OCTREE:8};function zet(r,t,e){if(r!=null&&r.box){const n=ML(r.s2VolumeInfo.token),i=Eet(n,t),s=Cet(i),a={...r.s2VolumeInfo};switch(a.token=s,e){case"OCTREE":const f=r.s2VolumeInfo,_=f.maximumHeight-f.minimumHeight,w=_/2,x=f.minimumHeight+_/2;f.minimumHeight=x-w,f.maximumHeight=x+w;break}return{box:HL(a),s2VolumeInfo:a}}}async function VL(r){const{options:t,parentData:e={mortonIndex:0,x:0,y:0,z:0},childIndex:n=0,globalData:i={level:0,mortonIndex:0,x:0,y:0,z:0},s2VolumeBox:s}=r;let{subtree:a,level:o=0}=r;const{subdivisionScheme:d,subtreeLevels:f,maximumLevel:_,contentUrlTemplate:w,subtreesUriTemplate:x,basePath:B}=t,P={children:[],lodMetricValue:0,contentUrl:""},R=Qet[d],N=n&1,Q=n>>1&1,V=n>>2&1,W=(R**o-1)/(R-1);let et=Wh(e.mortonIndex,n),ct=W+et,dt=Wh(e.x,N),gt=Wh(e.y,Q),ht=Wh(e.z,V),It=!1;o+1>f&&(It=B2(a.childSubtreeAvailability,et));const St=Wh(i.x,dt),ot=Wh(i.y,gt),at=Wh(i.z,ht),bt=o+i.level;if(It){const qt="".concat(B,"/").concat(x),te=C2(qt,bt,St,ot,at);a=await UA(te,wL),i.mortonIndex=et,i.x=dt,i.y=gt,i.z=ht,i.level=o,et=0,ct=0,dt=0,gt=0,ht=0,o=0}if(!B2(a.tileAvailability,ct)||o>_)return P;B2(a.contentAvailability,ct)&&(P.contentUrl=C2(w,bt,St,ot,at));const Wt=o+1,Jt={mortonIndex:et,x:dt,y:gt,z:ht};for(let qt=0;qt<R;qt++){const te=zet(s,qt,d),Yt=await VL({subtree:a,options:t,parentData:Jt,childIndex:qt,level:Wt,globalData:i,s2VolumeBox:te});if(Yt.contentUrl||Yt.children.length){const be=bt+1,wt=Het(Yt,be,{childTileX:dt,childTileY:gt,childTileZ:ht},t,s);P.children.push(wt)}}return P}function B2(r,t){return"constant"in r?!!r.constant:r.explicitBitstream?jet(t,r.explicitBitstream):!1}function Het(r,t,e,n,i){const{basePath:s,refine:a,getRefine:o,lodMetricType:d,getTileType:f,rootLodMetricValue:_,rootBoundingVolume:w}=n,x=r.contentUrl&&r.contentUrl.replace("".concat(s,"/"),""),B=_/2**t,P=i!=null&&i.box?{box:i.box}:w,R=Vet(t,P,e);return{children:r.children,contentUrl:r.contentUrl,content:{uri:x},id:r.contentUrl,refine:o(a),type:f(r),lodMetricType:d,lodMetricValue:B,geometricError:B,transform:r.transform,boundingVolume:R}}function Vet(r,t,e){if(t.region){const{childTileX:n,childTileY:i,childTileZ:s}=e,[a,o,d,f,_,w]=t.region,x=2**r,B=(d-a)/x,P=(f-o)/x,R=(w-_)/x,[N,Q]=[a+B*n,a+B*(n+1)],[V,W]=[o+P*i,o+P*(i+1)],[et,ct]=[_+R*s,_+R*(s+1)];return{region:[N,V,Q,W,et,ct]}}if(t.box)return t;throw new Error("Unsupported bounding volume type ".concat(t))}function Wh(r,t){return parseInt(r.toString(2)+t.toString(2),2)}function C2(r,t,e,n,i){const s=Get({level:t,x:e,y:n,z:i});return r.replace(/{level}|{x}|{y}|{z}/gi,a=>s[a])}function Get(r){const t={};for(const e in r)t["{".concat(e,"}")]=r[e];return t}function jet(r,t){const e=Math.floor(r/8),n=r%8;return(t[e]>>n&1)===1}function E2(r){if(!r.contentUrl)return Cf.EMPTY;const e=r.contentUrl.split("?")[0].split(".").pop();switch(e){case"pnts":return Cf.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return Cf.SCENEGRAPH;default:return e}}function S2(r){switch(r){case"REPLACE":case"replace":return qu.REPLACE;case"ADD":case"add":return qu.ADD;default:return r}}function T2(r,t){if(/^[a-z][0-9a-z+.-]*:/i.test(t)){const n=new URL(r,"".concat(t,"/"));return decodeURI(n.toString())}else if(r.startsWith("/"))return r;return"".concat(t,"/").concat(r)}function jL(r,t){if(!r)return null;if(r.content){const e=r.content.uri||r.content.url;r.contentUrl=T2(e,t.basePath)}return r.id=r.contentUrl,r.lodMetricType=Ty.GEOMETRIC_ERROR,r.lodMetricValue=r.geometricError,r.transformMatrix=r.transform,r.type=E2(r),r.refine=S2(r.refine),r}async function qet(r,t){const e=r.basePath;let n;const i=KL(r==null?void 0:r.root);i&&r.root?n=await qL(r.root,r,i,t):n=jL(r.root,r);const s=[];for(s.push(n);s.length>0;){const o=(s.pop()||{}).children||[];for(let d of o){const f=KL(d);f?d=await qL(d,r,f,t):jL(d,{basePath:e}),s.push(d)}}return n}async function qL(r,t,e,n){var i,s;const a=t.basePath,{subdivisionScheme:o,maximumLevel:d,subtreeLevels:f,subtrees:{uri:_}}=e,w=C2(_,0,0,0,0),x=T2(w,a),B=await UA(x,wL,n),P=T2(r.content.uri,a),R=t==null||(i=t.root)===null||i===void 0?void 0:i.refine,N=r.geometricError,Q=(s=r.boundingVolume.extensions)===null||s===void 0?void 0:s["3DTILES_bounding_volume_S2"];if(Q){const ct={box:HL(Q),s2VolumeInfo:Q};r.boundingVolume=ct}const V=r.boundingVolume,W={contentUrlTemplate:P,subtreesUriTemplate:_,subdivisionScheme:o,subtreeLevels:f,maximumLevel:d,refine:R,basePath:a,lodMetricType:Ty.GEOMETRIC_ERROR,rootLodMetricValue:N,rootBoundingVolume:V,getTileType:E2,getRefine:S2};return await Ket(r,B,W)}async function Ket(r,t,e){if(!r)return null;r.lodMetricType=Ty.GEOMETRIC_ERROR,r.lodMetricValue=r.geometricError,r.transformMatrix=r.transform;const{children:n,contentUrl:i}=await VL({subtree:t,options:e,s2VolumeBox:r});return i&&(r.contentUrl=i,r.content={uri:i.replace("".concat(e.basePath,"/"),"")}),r.refine=S2(r.refine),r.type=E2(r),r.children=n,r.id=r.contentUrl,r}function KL(r){var t;return(r==null||(t=r.extensions)===null||t===void 0?void 0:t["3DTILES_implicit_tiling"])||(r==null?void 0:r.implicitTiling)}const I2={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:cL,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:Jet,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};function $et(r){return Hv(r.url)}async function Wet(r,t,e){const n={content:{featureIds:null}};return await vL(r,0,t,e,n.content),n.content}async function Xet(r,t,e){var n;const i=JSON.parse(new TextDecoder().decode(r));return i.loader=t.loader||I2,i.url=e.url,i.queryString=e.queryString,i.basePath=$et(i),i.root=await qet(i,t),i.type=ml.TILES3D,i.lodMetricType=Ty.GEOMETRIC_ERROR,i.lodMetricValue=((n=i.root)===null||n===void 0?void 0:n.lodMetricValue)||0,i}async function Jet(r,t,e){const n=t["3d-tiles"]||{};let i;return n.isTileset==="auto"?i=e.url&&e.url.indexOf(".json")!==-1:i=n.isTileset,i?r=await Xet(r,t,e):r=await Wet(r,t,e),r}const $L=[0],Yet={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:"",loader:I2,onTilesetLoad:{type:"function",value:r=>{}},onTileLoad:{type:"function",value:r=>{}},onTileUnload:{type:"function",value:r=>{}},onTileError:{type:"function",value:(r,t,e)=>{}},_getMeshColor:{type:"function",value:r=>[255,255,255]}};class F2 extends M3{constructor(){super(...arguments),j(this,"state",void 0)}initializeState(){"onTileLoadFail"in this.props&&Tn.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){var t,e;return!!(!((t=this.state)===null||t===void 0||(e=t.tileset3d)===null||e===void 0)&&e.isLoaded()&&super.isLoaded)}shouldUpdateState(t){let{changeFlags:e}=t;return e.somethingChanged}updateState(t){let{props:e,oldProps:n,changeFlags:i}=t;if(e.data&&e.data!==n.data&&this._loadTileset(e.data),i.viewportChanged){const{activeViewports:s}=this.state;Object.keys(s).length&&(this._updateTileset(s),this.state.lastUpdatedViewports=s,this.state.activeViewports={})}if(i.propsChanged){const{layerMap:s}=this.state;for(const a in s)s[a].needsUpdate=!0}}activateViewport(t){const{activeViewports:e,lastUpdatedViewports:n}=this.state;this.internalState.viewport=t,e[t.id]=t;const i=n==null?void 0:n[t.id];(!i||!t.equals(i))&&(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo(t){let{info:e,sourceLayer:n}=t;const i=n&&n.props.tile;return e.picked&&(e.object=i),e.sourceTile=i,e}filterSubLayer(t){let{layer:e,viewport:n}=t;const{tile:i}=e.props,{id:s}=n;return i.selected&&i.viewportIds.includes(s)}_updateAutoHighlight(t){const e=t.sourceTile,n=this.state.layerMap[e==null?void 0:e.id];n&&n.layer&&n.layer.updateAutoHighlight(t)}async _loadTileset(t){const{loadOptions:e={}}=this.props;let n=this.props.loader||this.props.loaders;Array.isArray(n)&&(n=n[0]);const i={loadOptions:{...e}};let s=t;if(n.preload){const d=await n.preload(t,e);d.url&&(s=d.url),d.headers&&(i.loadOptions.fetch={...i.loadOptions.fetch,headers:d.headers}),Object.assign(i,d)}const a=await UA(s,n,i.loadOptions),o=new Ptt(a,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError,...i});this.setState({tileset3d:o,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(o)}_onTileLoad(t){const{lastUpdatedViewports:e}=this.state;this.props.onTileLoad(t),this._updateTileset(e),this.setNeedsUpdate()}_onTileUnload(t){delete this.state.layerMap[t.id],this.props.onTileUnload(t)}_updateTileset(t){if(!t)return;const{tileset3d:e}=this.state,{timeline:n}=this.context,i=Object.keys(t).length;!n||!i||!e||e.selectTiles(Object.values(t)).then(s=>{this.state.frameNumber!==s&&this.setState({frameNumber:s})})}_getSubLayer(t,e){if(!t.content)return null;switch(t.type){case Cf.POINTCLOUD:return this._makePointCloudLayer(t,e);case Cf.SCENEGRAPH:return this._make3DModelLayer(t);case Cf.MESH:return this._makeSimpleMeshLayer(t,e);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(t.content.type))}}_makePointCloudLayer(t,e){const{attributes:n,pointCount:i,constantRGBA:s,cartographicOrigin:a,modelMatrix:o}=t.content,{positions:d,normals:f,colors:_}=n;if(!d)return null;const w=e&&e.props.data||{header:{vertexCount:i},attributes:{POSITION:d,NORMAL:f,COLOR_0:_}},{pointSize:x,getPointColor:B}=this.props,P=this.getSubLayerClass("pointcloud",Rw);return new P({pointSize:x},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(t.id),tile:t,data:w,coordinateSystem:Sn.METER_OFFSETS,coordinateOrigin:a,modelMatrix:o,getColor:s||B,_offset:0})}_make3DModelLayer(t){const{gltf:e,instances:n,cartographicOrigin:i,modelMatrix:s}=t.content,a=this.getSubLayerClass("scenegraph",Zw);return new a({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(t.id),tile:t,data:n||$L,scenegraph:e,coordinateSystem:Sn.METER_OFFSETS,coordinateOrigin:i,modelMatrix:s,getTransformMatrix:o=>o.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(t,e){const n=t.content,{attributes:i,indices:s,modelMatrix:a,cartographicOrigin:o,coordinateSystem:d=Sn.METER_OFFSETS,material:f,featureIds:_}=n,{_getMeshColor:w}=this.props,x=e&&e.props.mesh||new wg({drawMode:4,attributes:Zet(i),indices:s}),B=this.getSubLayerClass("mesh",t2);return new B(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(t.id),tile:t,mesh:x,data:$L,getColor:w(t),pbrMaterial:f,modelMatrix:a,coordinateOrigin:o,coordinateSystem:d,featureIds:_,_offset:0})}renderLayers(){const{tileset3d:t,layerMap:e}=this.state;return t?t.tiles.map(n=>{const i=e[n.id]=e[n.id]||{tile:n};let{layer:s}=i;return n.selected&&(s?i.needsUpdate&&(s=this._getSubLayer(n,s),i.needsUpdate=!1):s=this._getSubLayer(n)),i.layer=s,s}).filter(Boolean):null}}j(F2,"defaultProps",Yet),j(F2,"layerName","Tile3DLayer");function Zet(r){const t={};return t.positions={...r.positions,value:new Float32Array(r.positions.value)},r.normals&&(t.normals=r.normals),r.texCoords&&(t.texCoords=r.texCoords),r.colors&&(t.colors=r.colors),r.uvRegions&&(t.uvRegions=r.uvRegions),t}var trt=Object.defineProperty,ert=(r,t,e)=>t in r?trt(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Rn=(r,t,e)=>(ert(r,typeof t!="symbol"?t+"":t,e),e);let rrt=class{constructor(t){Rn(this,"map"),Rn(this,"width"),Rn(this,"height"),Rn(this,"svgCanvas"),Rn(this,"xLine"),Rn(this,"yLine"),Rn(this,"color","#535353"),this.map=t,this.mapResize=this.mapResize.bind(this)}create(){this.updateValues(),this.map!==void 0?(this.map.on("resize",this.mapResize),this.createCanvas(this.map.getCanvasContainer())):console.error("map object is null")}updateValues(){var t,e;this.width=(t=this.map)==null?void 0:t.getCanvas().clientWidth,this.height=(e=this.map)==null?void 0:e.getCanvas().clientHeight}mapResize(){this.updateValues(),this.updateCanvas()}updateCanvas(){if(this.svgCanvas!==void 0&&this.yLine!==void 0&&this.xLine!==void 0&&this.width!==void 0&&this.height!==void 0){this.svgCanvas.setAttribute("width",`${this.width}px`),this.svgCanvas.setAttribute("height",`${this.height}px`);const t=this.width/2,e=this.height/2;this.yLine.setAttribute("x1",`${t}px`),this.yLine.setAttribute("y1","0px"),this.yLine.setAttribute("x2",`${t}px`),this.yLine.setAttribute("y2",`${this.height}px`),this.xLine.setAttribute("x1","0px"),this.xLine.setAttribute("y1",`${e}px`),this.xLine.setAttribute("x2",`${this.width}px`),this.xLine.setAttribute("y2",`${e}px`)}else console.error("element value is null")}createCanvas(t){if(this.width!==void 0&&this.height!==void 0){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.style.position="relative",e.setAttribute("width",`${this.width}px`),e.setAttribute("height",`${this.height}px`);const n=this.width/2,i=this.height/2;this.yLine=e.appendChild(this.createLine(n,0,n,this.height,this.color,"2px")),this.xLine=e.appendChild(this.createLine(0,i,this.width,i,this.color,"2px")),t==null||t.appendChild(e),this.svgCanvas=e}}createLine(t,e,n,i,s,a){const o=document.createElementNS("http://www.w3.org/2000/svg","line");return o.setAttribute("x1",t),o.setAttribute("y1",e),o.setAttribute("x2",n),o.setAttribute("y2",i),o.setAttribute("stroke-dasharray","5,5"),o.setAttribute("stroke",s),o.setAttribute("stroke-width",a),o}destroy(){this.xLine!==void 0&&(this.xLine.remove(),this.xLine=void 0),this.yLine!==void 0&&(this.yLine.remove(),this.yLine=void 0),this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map.off("resize",this.mapResize),this.map=void 0)}};const L2={72:72,96:96,200:200,300:300,400:400},$u={JPEG:"jpg",PNG:"png",PDF:"pdf",SVG:"svg"},Vg={Landscape:"landscape",Portrait:"portrait"},Xh={LETTER:[279,216],A2:[594,420],A3:[420,297],A4:[297,210],A5:[210,148],A6:[148,105],B2:[707,500],B3:[500,353],B4:[353,250],B5:[250,176],B6:[176,125]},If={in:"in",mm:"mm"};let nrt=class{constructor(t){Rn(this,"map"),Rn(this,"width"),Rn(this,"height"),Rn(this,"unit"),Rn(this,"svgCanvas"),Rn(this,"svgPath");var e,n,i;if(this.map=t,this.map===void 0)return;this.mapResize=this.mapResize.bind(this),this.map.on("resize",this.mapResize);const s=(e=this.map)==null?void 0:e.getCanvas().clientWidth,a=(n=this.map)==null?void 0:n.getCanvas().clientHeight,o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.style.position="absolute",o.style.top="0px",o.style.left="0px",o.setAttribute("width",`${s}px`),o.setAttribute("height",`${a}px`);const d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("style","fill:#888888;stroke-width:0"),d.setAttribute("fill-opacity","0.5"),o.append(d),(i=this.map)==null||i.getCanvasContainer().appendChild(o),this.svgCanvas=o,this.svgPath=d}mapResize(){this.generateCutOut()}updateArea(t,e){this.width=t,this.height=e,this.unit=If.mm,this.generateCutOut()}generateCutOut(){var t,e;if(this.map===void 0||this.svgCanvas===void 0||this.svgPath===void 0)return;const n=this.toPixels(this.width),i=this.toPixels(this.height),s=(t=this.map)==null?void 0:t.getCanvas().clientWidth,a=(e=this.map)==null?void 0:e.getCanvas().clientHeight,o=s/2-n/2,d=o+n,f=a/2-i/2,_=f+i;this.svgCanvas.setAttribute("width",`${s}px`),this.svgCanvas.setAttribute("height",`${a}px`),this.svgPath.setAttribute("d",`M 0 0 L ${s} 0 L ${s} ${a} L 0 ${a} M ${o} ${f} L ${o} ${_} L ${d} ${_} L ${d} ${f}`)}destroy(){this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map=void 0)}toPixels(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:96;return this.unit===If.mm&&(e/=25.4),e*t}};const WL={PageSize:"Page Size",PageOrientation:"Page Orientation",Format:"Format",DPI:"DPI",Generate:"Generate",LanguageName:"English",LanguageCode:"en"},irt={PageSize:"Taille de page",PageOrientation:"Orientation de la page",Format:"Format",DPI:"DPI",Generate:"Gnrer",LanguageName:"Franais",LanguageCode:"fr"},srt={PageSize:"Sivukoko",PageOrientation:"Sivun suunta",Format:"Muoto",DPI:"DPI",Generate:"Generoi",LanguageName:"Suomalainen",LanguageCode:"fi"},ort={PageSize:"Papierformat",PageOrientation:"Papierausrichtung",Format:"Dateiformat",DPI:"Druckauflsung",Generate:"Erstellen",LanguageName:"Deutsch",LanguageCode:"de"},art={PageSize:"Sidstorlek",PageOrientation:"Sidorientering",Format:"Format",DPI:"DPI",Generate:"Generera",LanguageName:"Svenska",LanguageCode:"sv"},lrt={PageSize:"Tamao de pgina",PageOrientation:"Orientacin de pgina",Format:"Formato",DPI:"DPI",Generate:"Generar",LanguageName:"Espaola",LanguageCode:"es"},crt={PageSize:"Mida",PageOrientation:"Orientaci",Format:"Format",DPI:"DPI",Generate:"Genera",LanguageName:"Catalan",LanguageCode:"ca"},urt={PageSize:"Kch thc trang",PageOrientation:"Loi trang",Format:"nh dng",DPI:"Mt  im nh (DPI)",Generate:"To",LanguageName:"Ting Vit",LanguageCode:"vi"},Art={PageSize:" ",PageOrientation:" ",Format:"",DPI:"DPI",Generate:"",LanguageName:"",LanguageCode:"uk"},hrt={PageSize:"",PageOrientation:"",Format:"",DPI:"",Generate:"",LanguageName:"",LanguageCode:"zhHans"},drt={PageSize:"",PageOrientation:"",Format:"",DPI:"",Generate:"",LanguageName:"",LanguageCode:"zhHant"},frt={PageSize:"",PageOrientation:"",Format:"",DPI:"DPI",Generate:"",LanguageName:"",LanguageCode:"ja"},prt={PageSize:"Tamanho da pgina",PageOrientation:"Orientao da pgina",Format:"Formato",DPI:"DPI",Generate:"Gerar",LanguageName:"Portugus",LanguageCode:"pt"},grt=[WL,irt,srt,ort,art,lrt,crt,urt,Art,hrt,drt,frt,prt],mrt=r=>grt.find(t=>t.LanguageCode===r)??WL;(function(r){var t={};function e(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return r[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=r,e.c=t,e.d=function(n,i,s){e.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:s})},e.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,i){if(1&i&&(n=e(n)),8&i||4&i&&typeof n=="object"&&n&&n.__esModule)return n;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:n}),2&i&&typeof n!="string")for(var a in n)e.d(s,a,(function(o){return n[o]}).bind(null,a));return s},e.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(i,"a",i),i},e.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)},e.p="",e(e.s=0)})([function(r,t,e){r.exports=e(1)},function(r,t){function e(i,s){for(var a=0;a<s.length;a++){var o=s[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(i,o.key,o)}}var n=function(){function i(){(function(o,d){if(!(o instanceof d))throw new TypeError("Cannot call a class as a function")})(this,i),this.options={overlayBackgroundColor:"#666666",overlayOpacity:.6,spinnerIcon:"ball-circus",spinnerColor:"#000",spinnerSize:"3x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetY:0,offsetX:0,lockScroll:!1,containerID:null,spinnerZIndex:99999,overlayZIndex:99998},this.stylesheetBaseURL="https://cdn.jsdelivr.net/npm/load-awesome@1.1.0/css/",this.spinner=null,this.spinnerStylesheetURL=null,this.numberOfEmptyDivForSpinner={"ball-8bits":16,"ball-atom":4,"ball-beat":3,"ball-circus":5,"ball-climbing-dot":1,"ball-clip-rotate":1,"ball-clip-rotate-multiple":2,"ball-clip-rotate-pulse":2,"ball-elastic-dots":5,"ball-fall":3,"ball-fussion":4,"ball-grid-beat":9,"ball-grid-pulse":9,"ball-newton-cradle":4,"ball-pulse":3,"ball-pulse-rise":5,"ball-pulse-sync":3,"ball-rotate":1,"ball-running-dots":5,"ball-scale":1,"ball-scale-multiple":3,"ball-scale-pulse":2,"ball-scale-ripple":1,"ball-scale-ripple-multiple":3,"ball-spin":8,"ball-spin-clockwise":8,"ball-spin-clockwise-fade":8,"ball-spin-clockwise-fade-rotating":8,"ball-spin-fade":8,"ball-spin-fade-rotating":8,"ball-spin-rotate":2,"ball-square-clockwise-spin":8,"ball-square-spin":8,"ball-triangle-path":3,"ball-zig-zag":2,"ball-zig-zag-deflect":2,cog:1,"cube-transition":2,fire:3,"line-scale":5,"line-scale-party":5,"line-scale-pulse-out":5,"line-scale-pulse-out-rapid":5,"line-spin-clockwise-fade":8,"line-spin-clockwise-fade-rotating":8,"line-spin-fade":8,"line-spin-fade-rotating":8,pacman:6,"square-jelly-box":2,"square-loader":1,"square-spin":1,timer:1,"triangle-skew-spin":1}}var s,a;return s=i,(a=[{key:"show",value:function(o){this.setOptions(o),this.addSpinnerStylesheet(),this.generateSpinnerElement(),this.options.lockScroll&&(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"),this.generateAndAddOverlayElement()}},{key:"hide",value:function(){this.options.lockScroll&&(document.body.style.overflow="",document.documentElement.style.overflow="");var o=document.getElementById("loading-overlay-stylesheet");o&&(o.disabled=!0,o.parentNode.removeChild(o),document.getElementById(this.options.overlayIDName).remove(),document.getElementById(this.options.spinnerIDName).remove())}},{key:"setOptions",value:function(o){if(o!==void 0)for(var d in o)this.options[d]=o[d]}},{key:"generateAndAddOverlayElement",value:function(){var o="50%";this.options.offsetX!==0&&(o="calc(50% + "+this.options.offsetX+")");var d="50%";if(this.options.offsetY!==0&&(d="calc(50% + "+this.options.offsetY+")"),this.options.containerID&&document.body.contains(document.getElementById(this.options.containerID))){var f='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: absolute; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,'; z-index: 50; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: absolute; top: ').concat(d,"; left: ").concat(o,'; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: 9999;">').concat(this.spinner,"</div>"),_=document.getElementById(this.options.containerID);return _.style.position="relative",void _.insertAdjacentHTML("beforeend",f)}var w='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: fixed; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,"; z-index: ").concat(this.options.overlayZIndex,'; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: fixed; top: ').concat(d,"; left: ").concat(o,"; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: ").concat(this.options.spinnerZIndex,';">').concat(this.spinner,"</div>");document.body.insertAdjacentHTML("beforeend",w)}},{key:"generateSpinnerElement",value:function(){var o=this,d=Object.keys(this.numberOfEmptyDivForSpinner).find(function(_){return _===o.options.spinnerIcon}),f=this.generateEmptyDivElement(this.numberOfEmptyDivForSpinner[d]);this.spinner='<div style="color: '.concat(this.options.spinnerColor,'" class="la-').concat(this.options.spinnerIcon," la-").concat(this.options.spinnerSize,'">').concat(f,"</div>")}},{key:"addSpinnerStylesheet",value:function(){this.setSpinnerStylesheetURL();var o=document.createElement("link");o.setAttribute("id","loading-overlay-stylesheet"),o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",this.spinnerStylesheetURL),document.getElementsByTagName("head")[0].appendChild(o)}},{key:"setSpinnerStylesheetURL",value:function(){this.spinnerStylesheetURL=this.stylesheetBaseURL+this.options.spinnerIcon+".min.css"}},{key:"generateEmptyDivElement",value:function(o){for(var d="",f=1;f<=o;f++)d+="<div></div>";return d}}])&&e(s.prototype,a),i}();window.JsLoadingOverlay=new n,r.exports=JsLoadingOverlay}]);function Un(r){"@babel/helpers - typeof";return Un=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Un(r)}var da=Uint8Array,zo=Uint16Array,Gg=Uint32Array,Uy=new da([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Oy=new da([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),P2=new da([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),XL=function(r,t){for(var e=new zo(31),n=0;n<31;++n)e[n]=t+=1<<r[n-1];for(var i=new Gg(e[30]),n=1;n<30;++n)for(var s=e[n];s<e[n+1];++s)i[s]=s-e[n]<<5|n;return[e,i]},JL=XL(Uy,2),YL=JL[0],M2=JL[1];YL[28]=258,M2[258]=28;for(var ZL=XL(Oy,0),yrt=ZL[0],tP=ZL[1],R2=new zo(32768),vi=0;vi<32768;++vi){var $A=(vi&43690)>>>1|(vi&21845)<<1;$A=($A&52428)>>>2|($A&13107)<<2,$A=($A&61680)>>>4|($A&3855)<<4,R2[vi]=(($A&65280)>>>8|($A&255)<<8)>>>1}for(var Gc=function(r,t,e){for(var n=r.length,i=0,s=new zo(t);i<n;++i)++s[r[i]-1];var a=new zo(t);for(i=0;i<t;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(e){o=new zo(1<<t);var d=15-t;for(i=0;i<n;++i)if(r[i])for(var f=i<<4|r[i],_=t-r[i],w=a[r[i]-1]++<<_,x=w|(1<<_)-1;w<=x;++w)o[R2[w]>>>d]=f}else for(o=new zo(n),i=0;i<n;++i)o[i]=R2[a[r[i]-1]++]>>>15-r[i];return o},WA=new da(288),vi=0;vi<144;++vi)WA[vi]=8;for(var vi=144;vi<256;++vi)WA[vi]=9;for(var vi=256;vi<280;++vi)WA[vi]=7;for(var vi=280;vi<288;++vi)WA[vi]=8;for(var jg=new da(32),vi=0;vi<32;++vi)jg[vi]=5;var _rt=Gc(WA,9,0),vrt=Gc(WA,9,1),brt=Gc(jg,5,0),wrt=Gc(jg,5,1),U2=function(r){for(var t=r[0],e=1;e<r.length;++e)r[e]>t&&(t=r[e]);return t},ec=function(r,t,e){var n=t/8>>0;return(r[n]|r[n+1]<<8)>>>(t&7)&e},O2=function(r,t){var e=t/8>>0;return(r[e]|r[e+1]<<8|r[e+2]<<16)>>>(t&7)},D2=function(r){return(r/8>>0)+(r&7&&1)},eP=function(r,t,e){(e==null||e>r.length)&&(e=r.length);var n=new(r instanceof zo?zo:r instanceof Gg?Gg:da)(e-t);return n.set(r.subarray(t,e)),n},xrt=function(r,t,e){var n=r.length,i=!t||e,s=!e||e.i;e||(e={}),t||(t=new da(n*3));var a=function(jt){var Vt=t.length;if(jt>Vt){var re=new da(Math.max(Vt*2,jt));re.set(t),t=re}},o=e.f||0,d=e.p||0,f=e.b||0,_=e.l,w=e.d,x=e.m,B=e.n,P=n*8;do{if(!_){e.f=o=ec(r,d,1);var R=ec(r,d+1,3);if(d+=3,R)if(R==1)_=vrt,w=wrt,x=9,B=5;else if(R==2){var N=ec(r,d,31)+257,Q=ec(r,d+10,15)+4,V=N+ec(r,d+5,31)+1;d+=14;for(var W=new da(V),et=new da(19),ct=0;ct<Q;++ct)et[P2[ct]]=ec(r,d+ct*3,7);d+=Q*3;var dt=U2(et),gt=(1<<dt)-1;if(!s&&d+V*(dt+7)>P)break;for(var ht=Gc(et,dt,1),ct=0;ct<V;){var It=ht[ec(r,d,gt)];d+=It&15;var St=It>>>4;if(St<16)W[ct++]=St;else{var ot=0,at=0;for(St==16?(at=3+ec(r,d,3),d+=2,ot=W[ct-1]):St==17?(at=3+ec(r,d,7),d+=3):St==18&&(at=11+ec(r,d,127),d+=7);at--;)W[ct++]=ot}}var bt=W.subarray(0,N),vt=W.subarray(N);x=U2(bt),B=U2(vt),_=Gc(bt,x,1),w=Gc(vt,B,1)}else throw"invalid block type";else{var St=D2(d)+4,$t=r[St-4]|r[St-3]<<8,Wt=St+$t;if(Wt>n){if(s)throw"unexpected EOF";break}i&&a(f+$t),t.set(r.subarray(St,Wt),f),e.b=f+=$t,e.p=d=Wt*8;continue}if(d>P)throw"unexpected EOF"}i&&a(f+131072);for(var Jt=(1<<x)-1,qt=(1<<B)-1,te=x+B+18;s||d+te<P;){var ot=_[O2(r,d)&Jt],Yt=ot>>>4;if(d+=ot&15,d>P)throw"unexpected EOF";if(!ot)throw"invalid length/literal";if(Yt<256)t[f++]=Yt;else if(Yt==256){_=null;break}else{var be=Yt-254;if(Yt>264){var ct=Yt-257,it=Uy[ct];be=ec(r,d,(1<<it)-1)+YL[ct],d+=it}var wt=w[O2(r,d)&qt],Ft=wt>>>4;if(!wt)throw"invalid distance";d+=wt&15;var vt=yrt[Ft];if(Ft>3){var it=Oy[Ft];vt+=O2(r,d)&(1<<it)-1,d+=it}if(d>P)throw"unexpected EOF";i&&a(f+131072);for(var Ut=f+be;f<Ut;f+=4)t[f]=t[f-vt],t[f+1]=t[f+1-vt],t[f+2]=t[f+2-vt],t[f+3]=t[f+3-vt];f=Ut}}e.l=_,e.p=d,e.b=f,_&&(o=1,e.m=x,e.d=w,e.n=B)}while(!o);return f==t.length?t:eP(t,0,f)},Wu=function(r,t,e){e<<=t&7;var n=t/8>>0;r[n]|=e,r[n+1]|=e>>>8},qg=function(r,t,e){e<<=t&7;var n=t/8>>0;r[n]|=e,r[n+1]|=e>>>8,r[n+2]|=e>>>16},N2=function(r,t){for(var e=[],n=0;n<r.length;++n)r[n]&&e.push({s:n,f:r[n]});var i=e.length,s=e.slice();if(!i)return[new da(0),0];if(i==1){var a=new da(e[0].s+1);return a[e[0].s]=1,[a,1]}e.sort(function(ct,dt){return ct.f-dt.f}),e.push({s:-1,f:25001});var o=e[0],d=e[1],f=0,_=1,w=2;for(e[0]={s:-1,f:o.f+d.f,l:o,r:d};_!=i-1;)o=e[e[f].f<e[w].f?f++:w++],d=e[f!=_&&e[f].f<e[w].f?f++:w++],e[_++]={s:-1,f:o.f+d.f,l:o,r:d};for(var x=s[0].s,n=1;n<i;++n)s[n].s>x&&(x=s[n].s);var B=new zo(x+1),P=k2(e[_-1],B,0);if(P>t){var n=0,R=0,N=P-t,Q=1<<N;for(s.sort(function(dt,gt){return B[gt.s]-B[dt.s]||dt.f-gt.f});n<i;++n){var V=s[n].s;if(B[V]>t)R+=Q-(1<<P-B[V]),B[V]=t;else break}for(R>>>=N;R>0;){var W=s[n].s;B[W]<t?R-=1<<t-B[W]++-1:++n}for(;n>=0&&R;--n){var et=s[n].s;B[et]==t&&(--B[et],++R)}P=t}return[new da(B),P]},k2=function(r,t,e){return r.s==-1?Math.max(k2(r.l,t,e+1),k2(r.r,t,e+1)):t[r.s]=e},rP=function(r){for(var t=r.length;t&&!r[--t];);for(var e=new zo(++t),n=0,i=r[0],s=1,a=function(d){e[n++]=d},o=1;o<=t;++o)if(r[o]==i&&o!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=r[o]}return[e.subarray(0,n),t]},Kg=function(r,t){for(var e=0,n=0;n<t.length;++n)e+=r[n]*t[n];return e},Q2=function(r,t,e){var n=e.length,i=D2(t+2);r[i]=n&255,r[i+1]=n>>>8,r[i+2]=r[i]^255,r[i+3]=r[i+1]^255;for(var s=0;s<n;++s)r[i+s+4]=e[s];return(i+4+n)*8},nP=function(r,t,e,n,i,s,a,o,d,f,_){Wu(t,_++,e),++i[256];for(var w=N2(i,15),x=w[0],B=w[1],P=N2(s,15),R=P[0],N=P[1],Q=rP(x),V=Q[0],W=Q[1],et=rP(R),ct=et[0],dt=et[1],gt=new zo(19),ht=0;ht<V.length;++ht)gt[V[ht]&31]++;for(var ht=0;ht<ct.length;++ht)gt[ct[ht]&31]++;for(var It=N2(gt,7),St=It[0],ot=It[1],at=19;at>4&&!St[P2[at-1]];--at);var bt=f+5<<3,vt=Kg(i,WA)+Kg(s,jg)+a,$t=Kg(i,x)+Kg(s,R)+a+14+3*at+Kg(gt,St)+(2*gt[16]+3*gt[17]+7*gt[18]);if(bt<=vt&&bt<=$t)return Q2(t,_,r.subarray(d,d+f));var Wt,Jt,qt,te;if(Wu(t,_,1+($t<vt)),_+=2,$t<vt){Wt=Gc(x,B,0),Jt=x,qt=Gc(R,N,0),te=R;var Yt=Gc(St,ot,0);Wu(t,_,W-257),Wu(t,_+5,dt-1),Wu(t,_+10,at-4),_+=14;for(var ht=0;ht<at;++ht)Wu(t,_+3*ht,St[P2[ht]]);_+=3*at;for(var be=[V,ct],it=0;it<2;++it)for(var wt=be[it],ht=0;ht<wt.length;++ht){var Ft=wt[ht]&31;Wu(t,_,Yt[Ft]),_+=St[Ft],Ft>15&&(Wu(t,_,wt[ht]>>>5&127),_+=wt[ht]>>>12)}}else Wt=_rt,Jt=WA,qt=brt,te=jg;for(var ht=0;ht<o;++ht)if(n[ht]>255){var Ft=n[ht]>>>18&31;qg(t,_,Wt[Ft+257]),_+=Jt[Ft+257],Ft>7&&(Wu(t,_,n[ht]>>>23&31),_+=Uy[Ft]);var Ut=n[ht]&31;qg(t,_,qt[Ut]),_+=te[Ut],Ut>3&&(qg(t,_,n[ht]>>>5&8191),_+=Oy[Ut])}else qg(t,_,Wt[n[ht]]),_+=Jt[n[ht]];return qg(t,_,Wt[256]),_+Jt[256]},Brt=new Gg([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Crt=function(r,t,e,n,i,s){var a=r.length,o=new da(n+a+5*(1+Math.floor(a/7e3))+i),d=o.subarray(n,o.length-i),f=0;if(!t||a<8)for(var _=0;_<=a;_+=65535){var w=_+65535;w<a?f=Q2(d,f,r.subarray(_,w)):(d[_]=s,f=Q2(d,f,r.subarray(_,a)))}else{for(var x=Brt[t-1],B=x>>>13,P=x&8191,R=(1<<e)-1,N=new zo(32768),Q=new zo(R+1),V=Math.ceil(e/3),W=2*V,et=function(Ke){return(r[Ke]^r[Ke+1]<<V^r[Ke+2]<<W)&R},ct=new Gg(25e3),dt=new zo(288),gt=new zo(32),ht=0,It=0,_=0,St=0,ot=0,at=0;_<a;++_){var bt=et(_),vt=_&32767,$t=Q[bt];if(N[vt]=$t,Q[bt]=vt,ot<=_){var Wt=a-_;if((ht>7e3||St>24576)&&Wt>423){f=nP(r,d,0,ct,dt,gt,It,St,at,_-at,f),St=ht=It=0,at=_;for(var Jt=0;Jt<286;++Jt)dt[Jt]=0;for(var Jt=0;Jt<30;++Jt)gt[Jt]=0}var qt=2,te=0,Yt=P,be=vt-$t&32767;if(Wt>2&&bt==et(_-be))for(var it=Math.min(B,Wt)-1,wt=Math.min(32767,_),Ft=Math.min(258,Wt);be<=wt&&--Yt&&vt!=$t;){if(r[_+qt]==r[_+qt-be]){for(var Ut=0;Ut<Ft&&r[_+Ut]==r[_+Ut-be];++Ut);if(Ut>qt){if(qt=Ut,te=be,Ut>it)break;for(var jt=Math.min(be,Ut-2),Vt=0,Jt=0;Jt<jt;++Jt){var re=_-be+Jt+32768&32767,Zt=N[re],Be=re-Zt+32768&32767;Be>Vt&&(Vt=Be,$t=re)}}}vt=$t,$t=N[vt],be+=vt-$t+32768&32767}if(te){ct[St++]=268435456|M2[qt]<<18|tP[te];var Ie=M2[qt]&31,ke=tP[te]&31;It+=Uy[Ie]+Oy[ke],++dt[257+Ie],++gt[ke],ot=_+qt,++ht}else ct[St++]=r[_],++dt[r[_]]}}f=nP(r,d,s,ct,dt,gt,It,St,at,_-at,f)}return eP(o,0,n+D2(f)+i)},Ert=function(){var r=1,t=0;return{p:function(e){for(var n=r,i=t,s=e.length,a=0;a!=s;){for(var o=Math.min(a+5552,s);a<o;++a)n+=e[a],i+=n;n%=65521,i%=65521}r=n,t=i},d:function(){return(r>>>8<<16|(t&255)<<8|t>>>8)+((r&255)<<23)*2}}},Srt=function(r,t,e,n,i){return Crt(r,t.level==null?6:t.level,t.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):12+t.mem,e,n,!i)},Trt=function(r,t,e){for(;e;++t)r[t]=e,e>>>=8},Irt=function(r,t){var e=t.level,n=e==0?0:e<6?1:e==9?3:2;r[0]=120,r[1]=n<<6|(n?32-2*n:1)},Frt=function(r){if((r[0]&15)!=8||r[0]>>>4>7||(r[0]<<8|r[1])%31)throw"invalid zlib data";if(r[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function z2(r,t){t===void 0&&(t={});var e=Ert();e.p(r);var n=Srt(r,t,2,4);return Irt(n,t),Trt(n,n.length-4,e.d()),n}function Lrt(r,t){return xrt((Frt(r),r.subarray(2,-4)),t)}/** @license
*
* jsPDF - PDF Document creation from JavaScript
* Version 2.5.1 Built on 2022-01-28T15:37:57.791Z
*                      CommitID 00000000
*
* Copyright (c) 2010-2021 James Hall <james@parall.ax>, https://github.com/MrRio/jsPDF
*               2015-2021 yWorks GmbH, http://www.yworks.com
*               2015-2021 Lukas Hollnder <lukas.hollaender@yworks.com>, https://github.com/HackbrettXXX
*               2016-2018 Aras Abbasi <aras.abbasi@gmail.com>
*               2010 Aaron Spike, https://github.com/acspike
*               2012 Willow Systems Corporation, https://github.com/willowsystems
*               2012 Pablo Hess, https://github.com/pablohess
*               2012 Florian Jenett, https://github.com/fjenett
*               2013 Warren Weckesser, https://github.com/warrenweckesser
*               2013 Youssef Beddad, https://github.com/lifof
*               2013 Lee Driscoll, https://github.com/lsdriscoll
*               2013 Stefan Slonevskiy, https://github.com/stefslon
*               2013 Jeremy Morel, https://github.com/jmorel
*               2013 Christoph Hartmann, https://github.com/chris-rock
*               2014 Juan Pablo Gaviria, https://github.com/juanpgaviria
*               2014 James Makes, https://github.com/dollaruw
*               2014 Diego Casorran, https://github.com/diegocr
*               2014 Steven Spungin, https://github.com/Flamenco
*               2014 Kenneth Glassey, https://github.com/Gavvers
*
* Permission is hereby granted, free of charge, to any person obtaining
* a copy of this software and associated documentation files (the
* "Software"), to deal in the Software without restriction, including
* without limitation the rights to use, copy, modify, merge, publish,
* distribute, sublicense, and/or sell copies of the Software, and to
* permit persons to whom the Software is furnished to do so, subject to
* the following conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
* LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
* OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
* WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*
* Contributor(s):
*    siefkenj, ahwolf, rickygu, Midnith, saintclair, eaparango,
*    kim3er, mfo, alnorth, Flamenco
*/var Vr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function H2(){Vr.console&&typeof Vr.console.log=="function"&&Vr.console.log.apply(Vr.console,arguments)}var ui={log:H2,warn:function(r){Vr.console&&(typeof Vr.console.warn=="function"?Vr.console.warn.apply(Vr.console,arguments):H2.call(null,arguments))},error:function(r){Vr.console&&(typeof Vr.console.error=="function"?Vr.console.error.apply(Vr.console,arguments):H2(r))}};function V2(r,t,e){var n=new XMLHttpRequest;n.open("GET",r),n.responseType="blob",n.onload=function(){Jh(n.response,t,e)},n.onerror=function(){ui.error("could not download file")},n.send()}function iP(r){var t=new XMLHttpRequest;t.open("HEAD",r,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Dy(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(t)}}var $g,G2,Jh=Vr.saveAs||((typeof window>"u"?"undefined":Un(window))!=="object"||window!==Vr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,t,e){var n=Vr.URL||Vr.webkitURL,i=document.createElement("a");t=t||r.name||"download",i.download=t,i.rel="noopener",typeof r=="string"?(i.href=r,i.origin!==location.origin?iP(i.href)?V2(r,t,e):Dy(i,i.target="_blank"):Dy(i)):(i.href=n.createObjectURL(r),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){Dy(i)},0))}:"msSaveOrOpenBlob"in navigator?function(r,t,e){if(t=t||r.name||"download",typeof r=="string")if(iP(r))V2(r,t,e);else{var n=document.createElement("a");n.href=r,n.target="_blank",setTimeout(function(){Dy(n)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:Un(s)!=="object"&&(ui.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(r,e),t)}:function(r,t,e,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof r=="string")return V2(r,t,e);var i=r.type==="application/octet-stream",s=/constructor/i.test(Vr.HTMLElement)||Vr.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||i&&s)&&(typeof FileReader>"u"?"undefined":Un(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var _=o.result;_=a?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=_:location=_,n=null},o.readAsDataURL(r)}else{var d=Vr.URL||Vr.webkitURL,f=d.createObjectURL(r);n?n.location=f:location.href=f,n=null,setTimeout(function(){d.revokeObjectURL(f)},4e4)}});/**
* A class to parse color values
* @author Stoyan Stefanov <sstoo@gmail.com>
* {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
* @license Use it if you like it
*/function sP(r){var t;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<e.length;n++){var i=e[n].re,s=e[n].process,a=i.exec(r);a&&(t=s(a),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),d=this.g.toString(16),f=this.b.toString(16);return o.length==1&&(o="0"+o),d.length==1&&(d="0"+d),f.length==1&&(f="0"+f),"#"+o+d+f}}/**
* @license
* Joseph Myers does not specify a particular license for his work.
*
* Author: Joseph Myers
* Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
*
* Modified by: Owen Leong
*/function j2(r,t){var e=r[0],n=r[1],i=r[2],s=r[3];e=go(e,n,i,s,t[0],7,-680876936),s=go(s,e,n,i,t[1],12,-389564586),i=go(i,s,e,n,t[2],17,606105819),n=go(n,i,s,e,t[3],22,-1044525330),e=go(e,n,i,s,t[4],7,-176418897),s=go(s,e,n,i,t[5],12,1200080426),i=go(i,s,e,n,t[6],17,-1473231341),n=go(n,i,s,e,t[7],22,-45705983),e=go(e,n,i,s,t[8],7,1770035416),s=go(s,e,n,i,t[9],12,-1958414417),i=go(i,s,e,n,t[10],17,-42063),n=go(n,i,s,e,t[11],22,-1990404162),e=go(e,n,i,s,t[12],7,1804603682),s=go(s,e,n,i,t[13],12,-40341101),i=go(i,s,e,n,t[14],17,-1502002290),e=mo(e,n=go(n,i,s,e,t[15],22,1236535329),i,s,t[1],5,-165796510),s=mo(s,e,n,i,t[6],9,-1069501632),i=mo(i,s,e,n,t[11],14,643717713),n=mo(n,i,s,e,t[0],20,-373897302),e=mo(e,n,i,s,t[5],5,-701558691),s=mo(s,e,n,i,t[10],9,38016083),i=mo(i,s,e,n,t[15],14,-660478335),n=mo(n,i,s,e,t[4],20,-405537848),e=mo(e,n,i,s,t[9],5,568446438),s=mo(s,e,n,i,t[14],9,-1019803690),i=mo(i,s,e,n,t[3],14,-187363961),n=mo(n,i,s,e,t[8],20,1163531501),e=mo(e,n,i,s,t[13],5,-1444681467),s=mo(s,e,n,i,t[2],9,-51403784),i=mo(i,s,e,n,t[7],14,1735328473),e=yo(e,n=mo(n,i,s,e,t[12],20,-1926607734),i,s,t[5],4,-378558),s=yo(s,e,n,i,t[8],11,-2022574463),i=yo(i,s,e,n,t[11],16,1839030562),n=yo(n,i,s,e,t[14],23,-35309556),e=yo(e,n,i,s,t[1],4,-1530992060),s=yo(s,e,n,i,t[4],11,1272893353),i=yo(i,s,e,n,t[7],16,-155497632),n=yo(n,i,s,e,t[10],23,-1094730640),e=yo(e,n,i,s,t[13],4,681279174),s=yo(s,e,n,i,t[0],11,-358537222),i=yo(i,s,e,n,t[3],16,-722521979),n=yo(n,i,s,e,t[6],23,76029189),e=yo(e,n,i,s,t[9],4,-640364487),s=yo(s,e,n,i,t[12],11,-421815835),i=yo(i,s,e,n,t[15],16,530742520),e=_o(e,n=yo(n,i,s,e,t[2],23,-995338651),i,s,t[0],6,-198630844),s=_o(s,e,n,i,t[7],10,1126891415),i=_o(i,s,e,n,t[14],15,-1416354905),n=_o(n,i,s,e,t[5],21,-57434055),e=_o(e,n,i,s,t[12],6,1700485571),s=_o(s,e,n,i,t[3],10,-1894986606),i=_o(i,s,e,n,t[10],15,-1051523),n=_o(n,i,s,e,t[1],21,-2054922799),e=_o(e,n,i,s,t[8],6,1873313359),s=_o(s,e,n,i,t[15],10,-30611744),i=_o(i,s,e,n,t[6],15,-1560198380),n=_o(n,i,s,e,t[13],21,1309151649),e=_o(e,n,i,s,t[4],6,-145523070),s=_o(s,e,n,i,t[11],10,-1120210379),i=_o(i,s,e,n,t[2],15,718787259),n=_o(n,i,s,e,t[9],21,-343485551),r[0]=XA(e,r[0]),r[1]=XA(n,r[1]),r[2]=XA(i,r[2]),r[3]=XA(s,r[3])}function Ny(r,t,e,n,i,s){return t=XA(XA(t,r),XA(n,s)),XA(t<<i|t>>>32-i,e)}function go(r,t,e,n,i,s,a){return Ny(t&e|~t&n,r,t,i,s,a)}function mo(r,t,e,n,i,s,a){return Ny(t&n|e&~n,r,t,i,s,a)}function yo(r,t,e,n,i,s,a){return Ny(t^e^n,r,t,i,s,a)}function _o(r,t,e,n,i,s,a){return Ny(e^(t|~n),r,t,i,s,a)}function oP(r){var t,e=r.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=r.length;t+=64)j2(n,Prt(r.substring(t-64,t)));r=r.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<r.length;t++)i[t>>2]|=r.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(j2(n,i),t=0;t<16;t++)i[t]=0;return i[14]=8*e,j2(n,i),n}function Prt(r){var t,e=[];for(t=0;t<64;t+=4)e[t>>2]=r.charCodeAt(t)+(r.charCodeAt(t+1)<<8)+(r.charCodeAt(t+2)<<16)+(r.charCodeAt(t+3)<<24);return e}$g=Vr.atob.bind(Vr),G2=Vr.btoa.bind(Vr);var aP="0123456789abcdef".split("");function Mrt(r){for(var t="",e=0;e<4;e++)t+=aP[r>>8*e+4&15]+aP[r>>8*e&15];return t}function Rrt(r){return String.fromCharCode((255&r)>>0,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function q2(r){return oP(r).map(Rrt).join("")}var Urt=function(r){for(var t=0;t<r.length;t++)r[t]=Mrt(r[t]);return r.join("")}(oP("hello"))!="5d41402abc4b2a76b9719d911017c592";function XA(r,t){if(Urt){var e=(65535&r)+(65535&t);return(r>>16)+(t>>16)+(e>>16)<<16|65535&e}return r+t&4294967295}/**
* @license
* FPDF is released under a permissive license: there is no usage restriction.
* You may embed it freely in your application (commercial or not), with or
* without modifications.
*
* Reference: http://www.fpdf.org/en/script/script37.php
*/function K2(r,t){var e,n,i,s;if(r!==e){for(var a=(i=r,s=1+(256/r.length>>0),new Array(s+1).join(i)),o=[],d=0;d<256;d++)o[d]=d;var f=0;for(d=0;d<256;d++){var _=o[d];f=(f+_+a.charCodeAt(d))%256,o[d]=o[f],o[f]=_}e=r,n=o}else o=n;var w=t.length,x=0,B=0,P="";for(d=0;d<w;d++)B=(B+(_=o[x=(x+1)%256]))%256,o[x]=o[B],o[B]=_,a=o[(o[x]+o[B])%256],P+=String.fromCharCode(t.charCodeAt(d)^a);return P}/**
* @license
* Licensed under the MIT License.
* http://opensource.org/licenses/mit-license
* Author: Owen Leong (@owenl131)
* Date: 15 Oct 2020
* References:
* https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
* https://github.com/foliojs/pdfkit/blob/master/lib/security.js
* http://www.fpdf.org/en/script/script37.php
*/var lP={print:4,modify:8,copy:16,"annot-forms":32};function Ff(r,t,e,n){this.v=1,this.r=2;var i=192;r.forEach(function(o){if(lP.perm!==void 0)throw new Error("Invalid permission: "+o);i+=lP[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(t+this.padding).substr(0,32),a=(e+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,a),this.P=-(1+(255^i)),this.encryptionKey=q2(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=K2(this.encryptionKey,this.padding)}function Lf(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var t="",e=r.length,n=0;n<e;n++){var i=r.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?t+="#"+("0"+i.toString(16)).slice(-2):t+=r[n]}return t}function cP(r){if(Un(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,n,i){if(i=i||!1,typeof e!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var s=Math.random().toString(35);return t[e][s]=[n,!!i],s},this.unsubscribe=function(e){for(var n in t)if(t[n][e])return delete t[n][e],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(e){if(t.hasOwnProperty(e)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var s in t[e]){var a=t[e][s];try{a[0].apply(r,n)}catch(o){Vr.console&&ui.error("jsPDF PubSub Error",o.message,o)}a[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function ky(r){if(!(this instanceof ky))return new ky(r);var t="opacity,stroke-opacity".split(",");for(var e in r)r.hasOwnProperty(e)&&t.indexOf(e)>=0&&(this[e]=r[e]);this.id="",this.objectNumber=-1}function uP(r,t){this.gState=r,this.matrix=t,this.id="",this.objectNumber=-1}function Yh(r,t,e,n,i){if(!(this instanceof Yh))return new Yh(r,t,e,n,i);this.type=r==="axial"?2:3,this.coords=t,this.colors=e,uP.call(this,n,i)}function Pf(r,t,e,n,i){if(!(this instanceof Pf))return new Pf(r,t,e,n,i);this.boundingBox=r,this.xStep=t,this.yStep=e,this.stream="",this.cloneIndex=0,uP.call(this,n,i)}function Gr(r){var t,e=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],s=arguments[3],a=[],o=1,d=16,f="S",_=null;Un(r=r||{})==="object"&&(e=r.orientation,n=r.unit||n,i=r.format||i,s=r.compress||r.compressPdf||s,(_=r.encryption||null)!==null&&(_.userPassword=_.userPassword||"",_.ownerPassword=_.ownerPassword||"",_.userPermissions=_.userPermissions||[]),o=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(t=r.precision),r.floatPrecision!==void 0&&(d=r.floatPrecision),f=r.defaultPathOperation||"S"),a=r.filters||(s===!0?["FlateEncode"]:a),n=n||"mm",e=(""+(e||"P")).toLowerCase();var w=r.putOnlyUsedFonts||!1,x={},B={internal:{},__private__:{}};B.__private__.PubSub=cP;var P="1.3",R=B.__private__.getPdfVersion=function(){return P};B.__private__.setPdfVersion=function(O){P=O};var N={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};B.__private__.getPageFormats=function(){return N};var Q=B.__private__.getPageFormat=function(O){return N[O]};i=i||"a4";var V={COMPAT:"compat",ADVANCED:"advanced"},W=V.COMPAT;function et(){this.saveGraphicsState(),st(new Nt(De,0,0,-De,0,Sl()*De).toString()+" cm"),this.setFontSize(this.getFontSize()/De),f="n",W=V.ADVANCED}function ct(){this.restoreGraphicsState(),f="S",W=V.COMPAT}var dt=B.__private__.combineFontStyleAndFontWeight=function(O,nt){if(O=="bold"&&nt=="normal"||O=="bold"&&nt==400||O=="normal"&&nt=="italic"||O=="bold"&&nt=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return nt&&(O=nt==400||nt==="normal"?O==="italic"?"italic":"normal":nt!=700&&nt!=="bold"||O!=="normal"?(nt==700?"bold":nt)+""+O:"bold"),O};B.advancedAPI=function(O){var nt=W===V.COMPAT;return nt&&et.call(this),typeof O!="function"||(O(this),nt&&ct.call(this)),this},B.compatAPI=function(O){var nt=W===V.ADVANCED;return nt&&ct.call(this),typeof O!="function"||(O(this),nt&&et.call(this)),this},B.isAdvancedAPI=function(){return W===V.ADVANCED};var gt,ht=function(O){if(W!==V.ADVANCED)throw new Error(O+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},It=B.roundToPrecision=B.__private__.roundToPrecision=function(O,nt){var Lt=t||nt;if(isNaN(O)||isNaN(Lt))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return O.toFixed(Lt).replace(/0+$/,"")};gt=B.hpf=B.__private__.hpf=typeof d=="number"?function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return It(O,d)}:d==="smart"?function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return It(O,O>-1&&O<1?16:5)}:function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return It(O,16)};var St=B.f2=B.__private__.f2=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.f2");return It(O,2)},ot=B.__private__.f3=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.f3");return It(O,3)},at=B.scale=B.__private__.scale=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.scale");return W===V.COMPAT?O*De:W===V.ADVANCED?O:void 0},bt=function(O){return W===V.COMPAT?Sl()-O:W===V.ADVANCED?O:void 0},vt=function(O){return at(bt(O))};B.__private__.setPrecision=B.setPrecision=function(O){typeof parseInt(O,10)=="number"&&(t=parseInt(O,10))};var $t,Wt="00000000000000000000000000000000",Jt=B.__private__.getFileId=function(){return Wt},qt=B.__private__.setFileId=function(O){return Wt=O!==void 0&&/^[a-fA-F0-9]{32}$/.test(O)?O.toUpperCase():Wt.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),_!==null&&(wn=new Ff(_.userPermissions,_.userPassword,_.ownerPassword,Wt)),Wt};B.setFileId=function(O){return qt(O),this},B.getFileId=function(){return Jt()};var te=B.__private__.convertDateToPDFDate=function(O){var nt=O.getTimezoneOffset(),Lt=nt<0?"+":"-",Ht=Math.floor(Math.abs(nt/60)),ee=Math.abs(nt%60),Ae=[Lt,Ft(Ht),"'",Ft(ee),"'"].join("");return["D:",O.getFullYear(),Ft(O.getMonth()+1),Ft(O.getDate()),Ft(O.getHours()),Ft(O.getMinutes()),Ft(O.getSeconds()),Ae].join("")},Yt=B.__private__.convertPDFDateToDate=function(O){var nt=parseInt(O.substr(2,4),10),Lt=parseInt(O.substr(6,2),10)-1,Ht=parseInt(O.substr(8,2),10),ee=parseInt(O.substr(10,2),10),Ae=parseInt(O.substr(12,2),10),Re=parseInt(O.substr(14,2),10);return new Date(nt,Lt,Ht,ee,Ae,Re,0)},be=B.__private__.setCreationDate=function(O){var nt;if(O===void 0&&(O=new Date),O instanceof Date)nt=te(O);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(O))throw new Error("Invalid argument passed to jsPDF.setCreationDate");nt=O}return $t=nt},it=B.__private__.getCreationDate=function(O){var nt=$t;return O==="jsDate"&&(nt=Yt($t)),nt};B.setCreationDate=function(O){return be(O),this},B.getCreationDate=function(O){return it(O)};var wt,Ft=B.__private__.padd2=function(O){return("0"+parseInt(O)).slice(-2)},Ut=B.__private__.padd2Hex=function(O){return("00"+(O=O.toString())).substr(O.length)},jt=0,Vt=[],re=[],Zt=0,Be=[],Ie=[],ke=!1,He=re,Ke=function(){jt=0,Zt=0,re=[],Vt=[],Be=[],Qr=we(),ir=we()};B.__private__.setCustomOutputDestination=function(O){ke=!0,He=O};var le=function(O){ke||(He=O)};B.__private__.resetCustomOutputDestination=function(){ke=!1,He=re};var st=B.__private__.out=function(O){return O=O.toString(),Zt+=O.length+1,He.push(O),He},pr=B.__private__.write=function(O){return st(arguments.length===1?O.toString():Array.prototype.join.call(arguments," "))},Ye=B.__private__.getArrayBuffer=function(O){for(var nt=O.length,Lt=new ArrayBuffer(nt),Ht=new Uint8Array(Lt);nt--;)Ht[nt]=O.charCodeAt(nt);return Lt},ue=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];B.__private__.getStandardFonts=function(){return ue};var ye=r.fontSize||16;B.__private__.setFontSize=B.setFontSize=function(O){return ye=W===V.ADVANCED?O/De:O,this};var Le,Oe=B.__private__.getFontSize=B.getFontSize=function(){return W===V.COMPAT?ye:ye*De},We=r.R2L||!1;B.__private__.setR2L=B.setR2L=function(O){return We=O,this},B.__private__.getR2L=B.getR2L=function(){return We};var cr,yr=B.__private__.setZoomMode=function(O){var nt=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(O))Le=O;else if(isNaN(O)){if(nt.indexOf(O)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+O+'" is not recognized.');Le=O}else Le=parseInt(O,10)};B.__private__.getZoomMode=function(){return Le};var Fr,Ur=B.__private__.setPageMode=function(O){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(O)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+O+'" is not recognized.');cr=O};B.__private__.getPageMode=function(){return cr};var de=B.__private__.setLayoutMode=function(O){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(O)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+O+'" is not recognized.');Fr=O};B.__private__.getLayoutMode=function(){return Fr},B.__private__.setDisplayMode=B.setDisplayMode=function(O,nt,Lt){return yr(O),de(nt),Ur(Lt),this};var ur={title:"",subject:"",author:"",keywords:"",creator:""};B.__private__.getDocumentProperty=function(O){if(Object.keys(ur).indexOf(O)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ur[O]},B.__private__.getDocumentProperties=function(){return ur},B.__private__.setDocumentProperties=B.setProperties=B.setDocumentProperties=function(O){for(var nt in ur)ur.hasOwnProperty(nt)&&O[nt]&&(ur[nt]=O[nt]);return this},B.__private__.setDocumentProperty=function(O,nt){if(Object.keys(ur).indexOf(O)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ur[O]=nt};var _r,De,gn,pe,gr,Qe={},Mr={},_n=[],ze={},Nn={},sn={},vn={},cn=null,Ct=0,X=[],Z=new cP(B),ft=r.hotfixes||[],Bt={},Qt={},Gt=[],Nt=function O(nt,Lt,Ht,ee,Ae,Re){if(!(this instanceof O))return new O(nt,Lt,Ht,ee,Ae,Re);isNaN(nt)&&(nt=1),isNaN(Lt)&&(Lt=0),isNaN(Ht)&&(Ht=0),isNaN(ee)&&(ee=1),isNaN(Ae)&&(Ae=0),isNaN(Re)&&(Re=0),this._matrix=[nt,Lt,Ht,ee,Ae,Re]};Object.defineProperty(Nt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(O){this._matrix[0]=O}}),Object.defineProperty(Nt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(O){this._matrix[1]=O}}),Object.defineProperty(Nt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(O){this._matrix[2]=O}}),Object.defineProperty(Nt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(O){this._matrix[3]=O}}),Object.defineProperty(Nt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(O){this._matrix[4]=O}}),Object.defineProperty(Nt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(O){this._matrix[5]=O}}),Object.defineProperty(Nt.prototype,"a",{get:function(){return this._matrix[0]},set:function(O){this._matrix[0]=O}}),Object.defineProperty(Nt.prototype,"b",{get:function(){return this._matrix[1]},set:function(O){this._matrix[1]=O}}),Object.defineProperty(Nt.prototype,"c",{get:function(){return this._matrix[2]},set:function(O){this._matrix[2]=O}}),Object.defineProperty(Nt.prototype,"d",{get:function(){return this._matrix[3]},set:function(O){this._matrix[3]=O}}),Object.defineProperty(Nt.prototype,"e",{get:function(){return this._matrix[4]},set:function(O){this._matrix[4]=O}}),Object.defineProperty(Nt.prototype,"f",{get:function(){return this._matrix[5]},set:function(O){this._matrix[5]=O}}),Object.defineProperty(Nt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Nt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Nt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Nt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Nt.prototype.join=function(O){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(gt).join(O)},Nt.prototype.multiply=function(O){var nt=O.sx*this.sx+O.shy*this.shx,Lt=O.sx*this.shy+O.shy*this.sy,Ht=O.shx*this.sx+O.sy*this.shx,ee=O.shx*this.shy+O.sy*this.sy,Ae=O.tx*this.sx+O.ty*this.shx+this.tx,Re=O.tx*this.shy+O.ty*this.sy+this.ty;return new Nt(nt,Lt,Ht,ee,Ae,Re)},Nt.prototype.decompose=function(){var O=this.sx,nt=this.shy,Lt=this.shx,Ht=this.sy,ee=this.tx,Ae=this.ty,Re=Math.sqrt(O*O+nt*nt),er=(O/=Re)*Lt+(nt/=Re)*Ht;Lt-=O*er,Ht-=nt*er;var Tr=Math.sqrt(Lt*Lt+Ht*Ht);return er/=Tr,O*(Ht/=Tr)<nt*(Lt/=Tr)&&(O=-O,nt=-nt,er=-er,Re=-Re),{scale:new Nt(Re,0,0,Tr,0,0),translate:new Nt(1,0,0,1,ee,Ae),rotate:new Nt(O,nt,-nt,O,0,0),skew:new Nt(1,0,er,1,0,0)}},Nt.prototype.toString=function(O){return this.join(" ")},Nt.prototype.inversed=function(){var O=this.sx,nt=this.shy,Lt=this.shx,Ht=this.sy,ee=this.tx,Ae=this.ty,Re=1/(O*Ht-nt*Lt),er=Ht*Re,Tr=-nt*Re,Hr=-Lt*Re,Wr=O*Re;return new Nt(er,Tr,Hr,Wr,-er*ee-Hr*Ae,-Tr*ee-Wr*Ae)},Nt.prototype.applyToPoint=function(O){var nt=O.x*this.sx+O.y*this.shx+this.tx,Lt=O.x*this.shy+O.y*this.sy+this.ty;return new Bo(nt,Lt)},Nt.prototype.applyToRectangle=function(O){var nt=this.applyToPoint(O),Lt=this.applyToPoint(new Bo(O.x+O.w,O.y+O.h));return new uu(nt.x,nt.y,Lt.x-nt.x,Lt.y-nt.y)},Nt.prototype.clone=function(){var O=this.sx,nt=this.shy,Lt=this.shx,Ht=this.sy,ee=this.tx,Ae=this.ty;return new Nt(O,nt,Lt,Ht,ee,Ae)},B.Matrix=Nt;var Pt=B.matrixMult=function(O,nt){return nt.multiply(O)},se=new Nt(1,0,0,1,0,0);B.unitMatrix=B.identityMatrix=se;var he=function(O,nt){if(!Nn[O]){var Lt=(nt instanceof Yh?"Sh":"P")+(Object.keys(ze).length+1).toString(10);nt.id=Lt,Nn[O]=Lt,ze[Lt]=nt,Z.publish("addPattern",nt)}};B.ShadingPattern=Yh,B.TilingPattern=Pf,B.addShadingPattern=function(O,nt){return ht("addShadingPattern()"),he(O,nt),this},B.beginTilingPattern=function(O){ht("beginTilingPattern()"),AA(O.boundingBox[0],O.boundingBox[1],O.boundingBox[2]-O.boundingBox[0],O.boundingBox[3]-O.boundingBox[1],O.matrix)},B.endTilingPattern=function(O,nt){ht("endTilingPattern()"),nt.stream=Ie[wt].join(`
`),he(O,nt),Z.publish("endTilingPattern",nt),Gt.pop().restore()};var Xt=B.__private__.newObject=function(){var O=we();return je(O,!0),O},we=B.__private__.newObjectDeferred=function(){return jt++,Vt[jt]=function(){return Zt},jt},je=function(O,nt){return nt=typeof nt=="boolean"&&nt,Vt[O]=Zt,nt&&st(O+" 0 obj"),O},tr=B.__private__.newAdditionalObject=function(){var O={objId:we(),content:""};return Be.push(O),O},Qr=we(),ir=we(),Or=B.__private__.decodeColorString=function(O){var nt=O.split(" ");if(nt.length!==2||nt[1]!=="g"&&nt[1]!=="G")nt.length===5&&(nt[4]==="k"||nt[4]==="K")&&(nt=[(1-nt[0])*(1-nt[3]),(1-nt[1])*(1-nt[3]),(1-nt[2])*(1-nt[3]),"r"]);else{var Lt=parseFloat(nt[0]);nt=[Lt,Lt,Lt,"r"]}for(var Ht="#",ee=0;ee<3;ee++)Ht+=("0"+Math.floor(255*parseFloat(nt[ee])).toString(16)).slice(-2);return Ht},xr=B.__private__.encodeColorString=function(O){var nt;typeof O=="string"&&(O={ch1:O});var Lt=O.ch1,Ht=O.ch2,ee=O.ch3,Ae=O.ch4,Re=O.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Lt=="string"&&Lt.charAt(0)!=="#"){var er=new sP(Lt);if(er.ok)Lt=er.toHex();else if(!/^\d*\.?\d*$/.test(Lt))throw new Error('Invalid color "'+Lt+'" passed to jsPDF.encodeColorString.')}if(typeof Lt=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Lt)&&(Lt="#"+Lt[1]+Lt[1]+Lt[2]+Lt[2]+Lt[3]+Lt[3]),typeof Lt=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Lt)){var Tr=parseInt(Lt.substr(1),16);Lt=Tr>>16&255,Ht=Tr>>8&255,ee=255&Tr}if(Ht===void 0||Ae===void 0&&Lt===Ht&&Ht===ee)if(typeof Lt=="string")nt=Lt+" "+Re[0];else switch(O.precision){case 2:nt=St(Lt/255)+" "+Re[0];break;case 3:default:nt=ot(Lt/255)+" "+Re[0]}else if(Ae===void 0||Un(Ae)==="object"){if(Ae&&!isNaN(Ae.a)&&Ae.a===0)return nt=["1.","1.","1.",Re[1]].join(" ");if(typeof Lt=="string")nt=[Lt,Ht,ee,Re[1]].join(" ");else switch(O.precision){case 2:nt=[St(Lt/255),St(Ht/255),St(ee/255),Re[1]].join(" ");break;default:case 3:nt=[ot(Lt/255),ot(Ht/255),ot(ee/255),Re[1]].join(" ")}}else if(typeof Lt=="string")nt=[Lt,Ht,ee,Ae,Re[2]].join(" ");else switch(O.precision){case 2:nt=[St(Lt),St(Ht),St(ee),St(Ae),Re[2]].join(" ");break;case 3:default:nt=[ot(Lt),ot(Ht),ot(ee),ot(Ae),Re[2]].join(" ")}return nt},$r=B.__private__.getFilters=function(){return a},Xr=B.__private__.putStream=function(O){var nt=(O=O||{}).data||"",Lt=O.filters||$r(),Ht=O.alreadyAppliedFilters||[],ee=O.addLength1||!1,Ae=nt.length,Re=O.objectId,er=function(ls){return ls};if(_!==null&&Re===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");_!==null&&(er=wn.encryptor(Re,0));var Tr={};Lt===!0&&(Lt=["FlateEncode"]);var Hr=O.additionalKeyValues||[],Wr=(Tr=Gr.API.processDataByFilters!==void 0?Gr.API.processDataByFilters(nt,Lt):{data:nt,reverseChain:[]}).reverseChain+(Array.isArray(Ht)?Ht.join(" "):Ht.toString());if(Tr.data.length!==0&&(Hr.push({key:"Length",value:Tr.data.length}),ee===!0&&Hr.push({key:"Length1",value:Ae})),Wr.length!=0)if(Wr.split("/").length-1==1)Hr.push({key:"Filter",value:Wr});else{Hr.push({key:"Filter",value:"["+Wr+"]"});for(var rn=0;rn<Hr.length;rn+=1)if(Hr[rn].key==="DecodeParms"){for(var Yn=[],bi=0;bi<Tr.reverseChain.split("/").length-1;bi+=1)Yn.push("null");Yn.push(Hr[rn].value),Hr[rn].value="["+Yn.join(" ")+"]"}}st("<<");for(var Jr=0;Jr<Hr.length;Jr++)st("/"+Hr[Jr].key+" "+Hr[Jr].value);st(">>"),Tr.data.length!==0&&(st("stream"),st(er(Tr.data)),st("endstream"))},vr=B.__private__.putPage=function(O){var nt=O.number,Lt=O.data,Ht=O.objId,ee=O.contentsObjId;je(Ht,!0),st("<</Type /Page"),st("/Parent "+O.rootDictionaryObjId+" 0 R"),st("/Resources "+O.resourceDictionaryObjId+" 0 R"),st("/MediaBox ["+parseFloat(gt(O.mediaBox.bottomLeftX))+" "+parseFloat(gt(O.mediaBox.bottomLeftY))+" "+gt(O.mediaBox.topRightX)+" "+gt(O.mediaBox.topRightY)+"]"),O.cropBox!==null&&st("/CropBox ["+gt(O.cropBox.bottomLeftX)+" "+gt(O.cropBox.bottomLeftY)+" "+gt(O.cropBox.topRightX)+" "+gt(O.cropBox.topRightY)+"]"),O.bleedBox!==null&&st("/BleedBox ["+gt(O.bleedBox.bottomLeftX)+" "+gt(O.bleedBox.bottomLeftY)+" "+gt(O.bleedBox.topRightX)+" "+gt(O.bleedBox.topRightY)+"]"),O.trimBox!==null&&st("/TrimBox ["+gt(O.trimBox.bottomLeftX)+" "+gt(O.trimBox.bottomLeftY)+" "+gt(O.trimBox.topRightX)+" "+gt(O.trimBox.topRightY)+"]"),O.artBox!==null&&st("/ArtBox ["+gt(O.artBox.bottomLeftX)+" "+gt(O.artBox.bottomLeftY)+" "+gt(O.artBox.topRightX)+" "+gt(O.artBox.topRightY)+"]"),typeof O.userUnit=="number"&&O.userUnit!==1&&st("/UserUnit "+O.userUnit),Z.publish("putPage",{objId:Ht,pageContext:X[nt],pageNumber:nt,page:Lt}),st("/Contents "+ee+" 0 R"),st(">>"),st("endobj");var Ae=Lt.join(`
`);return W===V.ADVANCED&&(Ae+=`
Q`),je(ee,!0),Xr({data:Ae,filters:$r(),objectId:ee}),st("endobj"),Ht},jr=B.__private__.putPages=function(){var O,nt,Lt=[];for(O=1;O<=Ct;O++)X[O].objId=we(),X[O].contentsObjId=we();for(O=1;O<=Ct;O++)Lt.push(vr({number:O,data:Ie[O],objId:X[O].objId,contentsObjId:X[O].contentsObjId,mediaBox:X[O].mediaBox,cropBox:X[O].cropBox,bleedBox:X[O].bleedBox,trimBox:X[O].trimBox,artBox:X[O].artBox,userUnit:X[O].userUnit,rootDictionaryObjId:Qr,resourceDictionaryObjId:ir}));je(Qr,!0),st("<</Type /Pages");var Ht="/Kids [";for(nt=0;nt<Ct;nt++)Ht+=Lt[nt]+" 0 R ";st(Ht+"]"),st("/Count "+Ct),st(">>"),st("endobj"),Z.publish("postPutPages")},on=function(O){Z.publish("putFont",{font:O,out:st,newObject:Xt,putStream:Xr}),O.isAlreadyPutted!==!0&&(O.objectNumber=Xt(),st("<<"),st("/Type /Font"),st("/BaseFont /"+Lf(O.postScriptName)),st("/Subtype /Type1"),typeof O.encoding=="string"&&st("/Encoding /"+O.encoding),st("/FirstChar 32"),st("/LastChar 255"),st(">>"),st("endobj"))},In=function(){for(var O in Qe)Qe.hasOwnProperty(O)&&(w===!1||w===!0&&x.hasOwnProperty(O))&&on(Qe[O])},Mt=function(O){O.objectNumber=Xt();var nt=[];nt.push({key:"Type",value:"/XObject"}),nt.push({key:"Subtype",value:"/Form"}),nt.push({key:"BBox",value:"["+[gt(O.x),gt(O.y),gt(O.x+O.width),gt(O.y+O.height)].join(" ")+"]"}),nt.push({key:"Matrix",value:"["+O.matrix.toString()+"]"});var Lt=O.pages[1].join(`
`);Xr({data:Lt,additionalKeyValues:nt,objectId:O.objectNumber}),st("endobj")},Ne=function(){for(var O in Bt)Bt.hasOwnProperty(O)&&Mt(Bt[O])},Ee=function(O,nt){var Lt,Ht=[],ee=1/(nt-1);for(Lt=0;Lt<1;Lt+=ee)Ht.push(Lt);if(Ht.push(1),O[0].offset!=0){var Ae={offset:0,color:O[0].color};O.unshift(Ae)}if(O[O.length-1].offset!=1){var Re={offset:1,color:O[O.length-1].color};O.push(Re)}for(var er="",Tr=0,Hr=0;Hr<Ht.length;Hr++){for(Lt=Ht[Hr];Lt>O[Tr+1].offset;)Tr++;var Wr=O[Tr].offset,rn=(Lt-Wr)/(O[Tr+1].offset-Wr),Yn=O[Tr].color,bi=O[Tr+1].color;er+=Ut(Math.round((1-rn)*Yn[0]+rn*bi[0]).toString(16))+Ut(Math.round((1-rn)*Yn[1]+rn*bi[1]).toString(16))+Ut(Math.round((1-rn)*Yn[2]+rn*bi[2]).toString(16))}return er.trim()},or=function(O,nt){nt||(nt=21);var Lt=Xt(),Ht=Ee(O.colors,nt),ee=[];ee.push({key:"FunctionType",value:"0"}),ee.push({key:"Domain",value:"[0.0 1.0]"}),ee.push({key:"Size",value:"["+nt+"]"}),ee.push({key:"BitsPerSample",value:"8"}),ee.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ee.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Xr({data:Ht,additionalKeyValues:ee,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Lt}),st("endobj"),O.objectNumber=Xt(),st("<< /ShadingType "+O.type),st("/ColorSpace /DeviceRGB");var Ae="/Coords ["+gt(parseFloat(O.coords[0]))+" "+gt(parseFloat(O.coords[1]))+" ";O.type===2?Ae+=gt(parseFloat(O.coords[2]))+" "+gt(parseFloat(O.coords[3])):Ae+=gt(parseFloat(O.coords[2]))+" "+gt(parseFloat(O.coords[3]))+" "+gt(parseFloat(O.coords[4]))+" "+gt(parseFloat(O.coords[5])),st(Ae+="]"),O.matrix&&st("/Matrix ["+O.matrix.toString()+"]"),st("/Function "+Lt+" 0 R"),st("/Extend [true true]"),st(">>"),st("endobj")},Lr=function(O,nt){var Lt=we(),Ht=Xt();nt.push({resourcesOid:Lt,objectOid:Ht}),O.objectNumber=Ht;var ee=[];ee.push({key:"Type",value:"/Pattern"}),ee.push({key:"PatternType",value:"1"}),ee.push({key:"PaintType",value:"1"}),ee.push({key:"TilingType",value:"1"}),ee.push({key:"BBox",value:"["+O.boundingBox.map(gt).join(" ")+"]"}),ee.push({key:"XStep",value:gt(O.xStep)}),ee.push({key:"YStep",value:gt(O.yStep)}),ee.push({key:"Resources",value:Lt+" 0 R"}),O.matrix&&ee.push({key:"Matrix",value:"["+O.matrix.toString()+"]"}),Xr({data:O.stream,additionalKeyValues:ee,objectId:O.objectNumber}),st("endobj")},Pn=function(O){var nt;for(nt in ze)ze.hasOwnProperty(nt)&&(ze[nt]instanceof Yh?or(ze[nt]):ze[nt]instanceof Pf&&Lr(ze[nt],O))},qr=function(O){for(var nt in O.objectNumber=Xt(),st("<<"),O)switch(nt){case"opacity":st("/ca "+St(O[nt]));break;case"stroke-opacity":st("/CA "+St(O[nt]))}st(">>"),st("endobj")},yn=function(){var O;for(O in sn)sn.hasOwnProperty(O)&&qr(sn[O])},mi=function(){for(var O in st("/XObject <<"),Bt)Bt.hasOwnProperty(O)&&Bt[O].objectNumber>=0&&st("/"+O+" "+Bt[O].objectNumber+" 0 R");Z.publish("putXobjectDict"),st(">>")},bn=function(){wn.oid=Xt(),st("<<"),st("/Filter /Standard"),st("/V "+wn.v),st("/R "+wn.r),st("/U <"+wn.toHexString(wn.U)+">"),st("/O <"+wn.toHexString(wn.O)+">"),st("/P "+wn.P),st(">>"),st("endobj")},tn=function(){for(var O in st("/Font <<"),Qe)Qe.hasOwnProperty(O)&&(w===!1||w===!0&&x.hasOwnProperty(O))&&st("/"+O+" "+Qe[O].objectNumber+" 0 R");st(">>")},$o=function(){if(Object.keys(ze).length>0){for(var O in st("/Shading <<"),ze)ze.hasOwnProperty(O)&&ze[O]instanceof Yh&&ze[O].objectNumber>=0&&st("/"+O+" "+ze[O].objectNumber+" 0 R");Z.publish("putShadingPatternDict"),st(">>")}},ws=function(O){if(Object.keys(ze).length>0){for(var nt in st("/Pattern <<"),ze)ze.hasOwnProperty(nt)&&ze[nt]instanceof B.TilingPattern&&ze[nt].objectNumber>=0&&ze[nt].objectNumber<O&&st("/"+nt+" "+ze[nt].objectNumber+" 0 R");Z.publish("putTilingPatternDict"),st(">>")}},kn=function(){if(Object.keys(sn).length>0){var O;for(O in st("/ExtGState <<"),sn)sn.hasOwnProperty(O)&&sn[O].objectNumber>=0&&st("/"+O+" "+sn[O].objectNumber+" 0 R");Z.publish("putGStateDict"),st(">>")}},hn=function(O){je(O.resourcesOid,!0),st("<<"),st("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),tn(),$o(),ws(O.objectOid),kn(),mi(),st(">>"),st("endobj")},Li=function(){var O=[];In(),yn(),Ne(),Pn(O),Z.publish("putResources"),O.forEach(hn),hn({resourcesOid:ir,objectOid:Number.MAX_SAFE_INTEGER}),Z.publish("postPutResources")},On=function(){Z.publish("putAdditionalObjects");for(var O=0;O<Be.length;O++){var nt=Be[O];je(nt.objId,!0),st(nt.content),st("endobj")}Z.publish("postPutAdditionalObjects")},Wo=function(O){Mr[O.fontName]=Mr[O.fontName]||{},Mr[O.fontName][O.fontStyle]=O.id},Pi=function(O,nt,Lt,Ht,ee){var Ae={id:"F"+(Object.keys(Qe).length+1).toString(10),postScriptName:O,fontName:nt,fontStyle:Lt,encoding:Ht,isStandardFont:ee||!1,metadata:{}};return Z.publish("addFont",{font:Ae,instance:this}),Qe[Ae.id]=Ae,Wo(Ae),Ae.id},$a=function(O){for(var nt=0,Lt=ue.length;nt<Lt;nt++){var Ht=Pi.call(this,O[nt][0],O[nt][1],O[nt][2],ue[nt][3],!0);w===!1&&(x[Ht]=!0);var ee=O[nt][0].split("-");Wo({id:Ht,fontName:ee[0],fontStyle:ee[1]||""})}Z.publish("addFonts",{fonts:Qe,dictionary:Mr})},qn=function(O){return O.foo=function(){try{return O.apply(this,arguments)}catch(Ht){var nt=Ht.stack||"";~nt.indexOf(" at ")&&(nt=nt.split(" at ")[1]);var Lt="Error in function "+nt.split(`
`)[0].split("<")[0]+": "+Ht.message;if(!Vr.console)throw new Error(Lt);Vr.console.error(Lt,Ht),Vr.alert&&alert(Lt)}},O.foo.bar=O,O.foo},xs=function(O,nt){var Lt,Ht,ee,Ae,Re,er,Tr,Hr,Wr;if(ee=(nt=nt||{}).sourceEncoding||"Unicode",Re=nt.outputEncoding,(nt.autoencode||Re)&&Qe[_r].metadata&&Qe[_r].metadata[ee]&&Qe[_r].metadata[ee].encoding&&(Ae=Qe[_r].metadata[ee].encoding,!Re&&Qe[_r].encoding&&(Re=Qe[_r].encoding),!Re&&Ae.codePages&&(Re=Ae.codePages[0]),typeof Re=="string"&&(Re=Ae[Re]),Re)){for(Tr=!1,er=[],Lt=0,Ht=O.length;Lt<Ht;Lt++)(Hr=Re[O.charCodeAt(Lt)])?er.push(String.fromCharCode(Hr)):er.push(O[Lt]),er[Lt].charCodeAt(0)>>8&&(Tr=!0);O=er.join("")}for(Lt=O.length;Tr===void 0&&Lt!==0;)O.charCodeAt(Lt-1)>>8&&(Tr=!0),Lt--;if(!Tr)return O;for(er=nt.noBOM?[]:[254,255],Lt=0,Ht=O.length;Lt<Ht;Lt++){if((Wr=(Hr=O.charCodeAt(Lt))>>8)>>8)throw new Error("Character at position "+Lt+" of string '"+O+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");er.push(Wr),er.push(Hr-(Wr<<8))}return String.fromCharCode.apply(void 0,er)},Mi=B.__private__.pdfEscape=B.pdfEscape=function(O,nt){return xs(O,nt).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Qs=B.__private__.beginPage=function(O){Ie[++Ct]=[],X[Ct]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(O[0]),topRightY:Number(O[1])}},Cl(Ct),le(Ie[wt])},Bs=function(O,nt){var Lt,Ht,ee;switch(e=nt||e,typeof O=="string"&&(Lt=Q(O.toLowerCase()),Array.isArray(Lt)&&(Ht=Lt[0],ee=Lt[1])),Array.isArray(O)&&(Ht=O[0]*De,ee=O[1]*De),isNaN(Ht)&&(Ht=i[0],ee=i[1]),(Ht>14400||ee>14400)&&(ui.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ht=Math.min(14400,Ht),ee=Math.min(14400,ee)),i=[Ht,ee],e.substr(0,1)){case"l":ee>Ht&&(i=[ee,Ht]);break;case"p":Ht>ee&&(i=[ee,Ht])}Qs(i),fh(_c),st(Zo),lu!==0&&st(lu+" J"),cu!==0&&st(cu+" j"),Z.publish("addPage",{pageNumber:Ct})},un=function(O){O>0&&O<=Ct&&(Ie.splice(O,1),X.splice(O,1),Ct--,wt>Ct&&(wt=Ct),this.setPage(wt))},Cl=function(O){O>0&&O<=Ct&&(wt=O)},mc=B.__private__.getNumberOfPages=B.getNumberOfPages=function(){return Ie.length-1},ut=function(O,nt,Lt){var Ht,ee=void 0;return Lt=Lt||{},O=O!==void 0?O:Qe[_r].fontName,nt=nt!==void 0?nt:Qe[_r].fontStyle,Ht=O.toLowerCase(),Mr[Ht]!==void 0&&Mr[Ht][nt]!==void 0?ee=Mr[Ht][nt]:Mr[O]!==void 0&&Mr[O][nt]!==void 0?ee=Mr[O][nt]:Lt.disableWarning===!1&&ui.warn("Unable to look up font label for font '"+O+"', '"+nt+"'. Refer to getFontList() for available fonts."),ee||Lt.noFallback||(ee=Mr.times[nt])==null&&(ee=Mr.times.normal),ee},xt=B.__private__.putInfo=function(){var O=Xt(),nt=function(Ht){return Ht};for(var Lt in _!==null&&(nt=wn.encryptor(O,0)),st("<<"),st("/Producer ("+Mi(nt("jsPDF "+Gr.version))+")"),ur)ur.hasOwnProperty(Lt)&&ur[Lt]&&st("/"+Lt.substr(0,1).toUpperCase()+Lt.substr(1)+" ("+Mi(nt(ur[Lt]))+")");st("/CreationDate ("+Mi(nt($t))+")"),st(">>"),st("endobj")},kt=B.__private__.putCatalog=function(O){var nt=(O=O||{}).rootDictionaryObjId||Qr;switch(Xt(),st("<<"),st("/Type /Catalog"),st("/Pages "+nt+" 0 R"),Le||(Le="fullwidth"),Le){case"fullwidth":st("/OpenAction [3 0 R /FitH null]");break;case"fullheight":st("/OpenAction [3 0 R /FitV null]");break;case"fullpage":st("/OpenAction [3 0 R /Fit]");break;case"original":st("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Lt=""+Le;Lt.substr(Lt.length-1)==="%"&&(Le=parseInt(Le)/100),typeof Le=="number"&&st("/OpenAction [3 0 R /XYZ null null "+St(Le)+"]")}switch(Fr||(Fr="continuous"),Fr){case"continuous":st("/PageLayout /OneColumn");break;case"single":st("/PageLayout /SinglePage");break;case"two":case"twoleft":st("/PageLayout /TwoColumnLeft");break;case"tworight":st("/PageLayout /TwoColumnRight")}cr&&st("/PageMode /"+cr),Z.publish("putCatalog"),st(">>"),st("endobj")},ae=B.__private__.putTrailer=function(){st("trailer"),st("<<"),st("/Size "+(jt+1)),st("/Root "+jt+" 0 R"),st("/Info "+(jt-1)+" 0 R"),_!==null&&st("/Encrypt "+wn.oid+" 0 R"),st("/ID [ <"+Wt+"> <"+Wt+"> ]"),st(">>")},Fe=B.__private__.putHeader=function(){st("%PDF-"+P),st("%")},Xe=B.__private__.putXRef=function(){var O="0000000000";st("xref"),st("0 "+(jt+1)),st("0000000000 65535 f ");for(var nt=1;nt<=jt;nt++)typeof Vt[nt]=="function"?st((O+Vt[nt]()).slice(-10)+" 00000 n "):Vt[nt]!==void 0?st((O+Vt[nt]).slice(-10)+" 00000 n "):st("0000000000 00000 n ")},zr=B.__private__.buildDocument=function(){Ke(),le(re),Z.publish("buildDocument"),Fe(),jr(),On(),Li(),_!==null&&bn(),xt(),kt();var O=Zt;return Xe(),ae(),st("startxref"),st(""+O),st("%%EOF"),le(Ie[wt]),re.join(`
`)},Xn=B.__private__.getBlob=function(O){return new Blob([Ye(O)],{type:"application/pdf"})},Jn=B.output=B.__private__.output=qn(function(O,nt){switch(typeof(nt=nt||{})=="string"?nt={filename:nt}:nt.filename=nt.filename||"generated.pdf",O){case void 0:return zr();case"save":B.save(nt.filename);break;case"arraybuffer":return Ye(zr());case"blob":return Xn(zr());case"bloburi":case"bloburl":if(Vr.URL!==void 0&&typeof Vr.URL.createObjectURL=="function")return Vr.URL&&Vr.URL.createObjectURL(Xn(zr()))||void 0;ui.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Lt="",Ht=zr();try{Lt=G2(Ht)}catch{Lt=G2(unescape(encodeURIComponent(Ht)))}return"data:application/pdf;filename="+nt.filename+";base64,"+Lt;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Vr)==="[object Window]"){var ee="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ae=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';nt.pdfObjectUrl&&(ee=nt.pdfObjectUrl,Ae="");var Re='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ee+'"'+Ae+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(nt)+");<\/script></body></html>",er=Vr.open();return er!==null&&er.document.write(Re),er}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Vr)==="[object Window]"){var Tr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(nt.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+nt.filename+'" width="500px" height="400px" /></body></html>',Hr=Vr.open();if(Hr!==null){Hr.document.write(Tr);var Wr=this;Hr.document.documentElement.querySelector("#pdfViewer").onload=function(){Hr.document.title=nt.filename,Hr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Wr.output("bloburl"))}}return Hr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Vr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var rn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",nt)+'"></iframe></body></html>',Yn=Vr.open();if(Yn!==null&&(Yn.document.write(rn),Yn.document.title=nt.filename),Yn||typeof safari>"u")return Yn;break;case"datauri":case"dataurl":return Vr.document.location.href=this.output("datauristring",nt);default:return null}}),Si=function(O){return Array.isArray(ft)===!0&&ft.indexOf(O)>-1};switch(n){case"pt":De=1;break;case"mm":De=72/25.4;break;case"cm":De=72/2.54;break;case"in":De=72;break;case"px":De=Si("px_scaling")==1?.75:96/72;break;case"pc":case"em":De=12;break;case"ex":De=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);De=n}var wn=null;be(),qt();var yc=function(O){return _!==null?wn.encryptor(O,0):function(nt){return nt}},Zi=B.__private__.getPageInfo=B.getPageInfo=function(O){if(isNaN(O)||O%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:X[O].objId,pageNumber:O,pageContext:X[O]}},Br=B.__private__.getPageInfoByObjId=function(O){if(isNaN(O)||O%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var nt in X)if(X[nt].objId===O)break;return Zi(nt)},tu=B.__private__.getCurrentPageInfo=B.getCurrentPageInfo=function(){return{objId:X[wt].objId,pageNumber:wt,pageContext:X[wt]}};B.addPage=function(){return Bs.apply(this,arguments),this},B.setPage=function(){return Cl.apply(this,arguments),le.call(this,Ie[wt]),this},B.insertPage=function(O){return this.addPage(),this.movePage(wt,O),this},B.movePage=function(O,nt){var Lt,Ht;if(O>nt){Lt=Ie[O],Ht=X[O];for(var ee=O;ee>nt;ee--)Ie[ee]=Ie[ee-1],X[ee]=X[ee-1];Ie[nt]=Lt,X[nt]=Ht,this.setPage(nt)}else if(O<nt){Lt=Ie[O],Ht=X[O];for(var Ae=O;Ae<nt;Ae++)Ie[Ae]=Ie[Ae+1],X[Ae]=X[Ae+1];Ie[nt]=Lt,X[nt]=Ht,this.setPage(nt)}return this},B.deletePage=function(){return un.apply(this,arguments),this},B.__private__.text=B.text=function(O,nt,Lt,Ht,ee){var Ae,Re,er,Tr,Hr,Wr,rn,Yn,bi,Jr=(Ht=Ht||{}).scope||this;if(typeof O=="number"&&typeof nt=="number"&&(typeof Lt=="string"||Array.isArray(Lt))){var ls=Lt;Lt=nt,nt=O,O=ls}if(arguments[3]instanceof Nt?(ht("The transform parameter of text() with a Matrix value"),bi=ee):(er=arguments[4],Tr=arguments[5],Un(rn=arguments[3])==="object"&&rn!==null||(typeof er=="string"&&(Tr=er,er=null),typeof rn=="string"&&(Tr=rn,rn=null),typeof rn=="number"&&(er=rn,rn=null),Ht={flags:rn,angle:er,align:Tr})),isNaN(nt)||isNaN(Lt)||O==null)throw new Error("Invalid arguments passed to jsPDF.text");if(O.length===0)return Jr;var Cr="",zs=!1,An=typeof Ht.lineHeightFactor=="number"?Ht.lineHeightFactor:Xa,dn=Jr.internal.scaleFactor;function wa(Kn){return Kn=Kn.split("	").join(Array(Ht.TabLen||9).join(" ")),Mi(Kn,rn)}function Ja(Kn){for(var Qn,oi=Kn.concat(),wi=[],ro=oi.length;ro--;)typeof(Qn=oi.shift())=="string"?wi.push(Qn):Array.isArray(Kn)&&(Qn.length===1||Qn[1]===void 0&&Qn[2]===void 0)?wi.push(Qn[0]):wi.push([Qn[0],Qn[1],Qn[2]]);return wi}function Ya(Kn,Qn){var oi;if(typeof Kn=="string")oi=Qn(Kn)[0];else if(Array.isArray(Kn)){for(var wi,ro,Fo=Kn.concat(),xi=[],Ea=Fo.length;Ea--;)typeof(wi=Fo.shift())=="string"?xi.push(Qn(wi)[0]):Array.isArray(wi)&&typeof wi[0]=="string"&&(ro=Qn(wi[0],wi[1],wi[2]),xi.push([ro[0],ro[1],ro[2]]));oi=xi}return oi}var Tl=!1,ta=!0;if(typeof O=="string")Tl=!0;else if(Array.isArray(O)){var xa=O.concat();Re=[];for(var ts,cs=xa.length;cs--;)(typeof(ts=xa.shift())!="string"||Array.isArray(ts)&&typeof ts[0]!="string")&&(ta=!1);Tl=ta}if(Tl===!1)throw new Error('Type of text must be string or Array. "'+O+'" is not recognized.');typeof O=="string"&&(O=O.match(/[\r?\n]/)?O.split(/\r\n|\r|\n/g):[O]);var Il=ye/Jr.internal.scaleFactor,Fl=Il*(An-1);switch(Ht.baseline){case"bottom":Lt-=Fl;break;case"top":Lt+=Il-Fl;break;case"hanging":Lt+=Il-2*Fl;break;case"middle":Lt+=Il/2-Fl}if((Wr=Ht.maxWidth||0)>0&&(typeof O=="string"?O=Jr.splitTextToSize(O,Wr):Object.prototype.toString.call(O)==="[object Array]"&&(O=O.reduce(function(Kn,Qn){return Kn.concat(Jr.splitTextToSize(Qn,Wr))},[]))),Ae={text:O,x:nt,y:Lt,options:Ht,mutex:{pdfEscape:Mi,activeFontKey:_r,fonts:Qe,activeFontSize:ye}},Z.publish("preProcessText",Ae),O=Ae.text,er=(Ht=Ae.options).angle,!(bi instanceof Nt)&&er&&typeof er=="number"){er*=Math.PI/180,Ht.rotationDirection===0&&(er=-er),W===V.ADVANCED&&(er=-er);var Co=Math.cos(er),Za=Math.sin(er);bi=new Nt(Co,Za,-Za,Co,0,0)}else er&&er instanceof Nt&&(bi=er);W!==V.ADVANCED||bi||(bi=se),(Hr=Ht.charSpace||El)!==void 0&&(Cr+=gt(at(Hr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Yn=Ht.horizontalScale)!==void 0&&(Cr+=gt(100*Yn)+` Tz
`),Ht.lang;var zi=-1,Ll=Ht.renderingMode!==void 0?Ht.renderingMode:Ht.stroke,tl=Jr.internal.getCurrentPageInfo().pageContext;switch(Ll){case 0:case!1:case"fill":zi=0;break;case 1:case!0:case"stroke":zi=1;break;case 2:case"fillThenStroke":zi=2;break;case 3:case"invisible":zi=3;break;case 4:case"fillAndAddForClipping":zi=4;break;case 5:case"strokeAndAddPathForClipping":zi=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":zi=6;break;case 7:case"addToPathForClipping":zi=7}var wc=tl.usedRenderingMode!==void 0?tl.usedRenderingMode:-1;zi!==-1?Cr+=zi+` Tr
`:wc!==-1&&(Cr+=`0 Tr
`),zi!==-1&&(tl.usedRenderingMode=zi),Tr=Ht.align||"left";var us,Ba=ye*An,mh=Jr.internal.pageSize.getWidth(),dA=Qe[_r];Hr=Ht.charSpace||El,Wr=Ht.maxWidth||0,rn=Object.assign({autoencode:!0,noBOM:!0},Ht.flags);var Yr=[];if(Object.prototype.toString.call(O)==="[object Array]"){var Es;Re=Ja(O),Tr!=="left"&&(us=Re.map(function(Kn){return Jr.getStringUnitWidth(Kn,{font:dA,charSpace:Hr,fontSize:ye,doKerning:!1})*ye/dn}));var ea,el=0;if(Tr==="right"){nt-=us[0],O=[],cs=Re.length;for(var Ss=0;Ss<cs;Ss++)Ss===0?(ea=en(nt),Es=Yo(Lt)):(ea=at(el-us[Ss]),Es=-Ba),O.push([Re[Ss],ea,Es]),el=us[Ss]}else if(Tr==="center"){nt-=us[0]/2,O=[],cs=Re.length;for(var Ca=0;Ca<cs;Ca++)Ca===0?(ea=en(nt),Es=Yo(Lt)):(ea=at((el-us[Ca])/2),Es=-Ba),O.push([Re[Ca],ea,Es]),el=us[Ca]}else if(Tr==="left"){O=[],cs=Re.length;for(var rl=0;rl<cs;rl++)O.push(Re[rl])}else{if(Tr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');O=[],cs=Re.length,Wr=Wr!==0?Wr:mh;for(var Eo=0;Eo<cs;Eo++)Es=Eo===0?Yo(Lt):-Ba,ea=Eo===0?en(nt):0,Eo<cs-1?Yr.push(gt(at((Wr-us[Eo])/(Re[Eo].split(" ").length-1)))):Yr.push(0),O.push([Re[Eo],ea,Es])}}var xc=typeof Ht.R2L=="boolean"?Ht.R2L:We;xc===!0&&(O=Ya(O,function(Kn,Qn,oi){return[Kn.split("").reverse().join(""),Qn,oi]})),Ae={text:O,x:nt,y:Lt,options:Ht,mutex:{pdfEscape:Mi,activeFontKey:_r,fonts:Qe,activeFontSize:ye}},Z.publish("postProcessText",Ae),O=Ae.text,zs=Ae.mutex.isHex||!1;var Pl=Qe[_r].encoding;Pl!=="WinAnsiEncoding"&&Pl!=="StandardEncoding"||(O=Ya(O,function(Kn,Qn,oi){return[wa(Kn),Qn,oi]})),Re=Ja(O),O=[];for(var ra,As,Hs,So=0,Ml=1,To=Array.isArray(Re[0])?Ml:So,Io="",Rl=function(Kn,Qn,oi){var wi="";return oi instanceof Nt?(oi=typeof Ht.angle=="number"?Pt(oi,new Nt(1,0,0,1,Kn,Qn)):Pt(new Nt(1,0,0,1,Kn,Qn),oi),W===V.ADVANCED&&(oi=Pt(new Nt(1,0,0,-1,0,0),oi)),wi=oi.join(" ")+` Tm
`):wi=gt(Kn)+" "+gt(Qn)+` Td
`,wi},Ts=0;Ts<Re.length;Ts++){switch(Io="",To){case Ml:Hs=(zs?"<":"(")+Re[Ts][0]+(zs?">":")"),ra=parseFloat(Re[Ts][1]),As=parseFloat(Re[Ts][2]);break;case So:Hs=(zs?"<":"(")+Re[Ts]+(zs?">":")"),ra=en(nt),As=Yo(Lt)}Yr!==void 0&&Yr[Ts]!==void 0&&(Io=Yr[Ts]+` Tw
`),Ts===0?O.push(Io+Rl(ra,As,bi)+Hs):To===So?O.push(Io+Hs):To===Ml&&O.push(Io+Rl(ra,As,bi)+Hs)}O=To===So?O.join(` Tj
T* `):O.join(` Tj
`),O+=` Tj
`;var na=`BT
/`;return na+=_r+" "+ye+` Tf
`,na+=gt(ye*An)+` TL
`,na+=vc+`
`,na+=Cr,na+=O,st(na+="ET"),x[_r]=!0,Jr};var eu=B.__private__.clip=B.clip=function(O){return st(O==="evenodd"?"W*":"W"),this};B.clipEvenOdd=function(){return eu("evenodd")},B.__private__.discardPath=B.discardPath=function(){return st("n"),this};var to=B.__private__.isValidStyle=function(O){var nt=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(O)!==-1&&(nt=!0),nt};B.__private__.setDefaultPathOperation=B.setDefaultPathOperation=function(O){return to(O)&&(f=O),this};var lA=B.__private__.getStyle=B.getStyle=function(O){var nt=f;switch(O){case"D":case"S":nt="S";break;case"F":nt="f";break;case"FD":case"DF":nt="B";break;case"f":case"f*":case"B":case"B*":nt=O}return nt},Wa=B.close=function(){return st("h"),this};B.stroke=function(){return st("S"),this},B.fill=function(O){return ru("f",O),this},B.fillEvenOdd=function(O){return ru("f*",O),this},B.fillStroke=function(O){return ru("B",O),this},B.fillStrokeEvenOdd=function(O){return ru("B*",O),this};var ru=function(O,nt){Un(nt)==="object"?Cd(nt,O):st(O)},nu=function(O){O===null||W===V.ADVANCED&&O===void 0||(O=lA(O),st(O))};function dh(O,nt,Lt,Ht,ee){var Ae=new Pf(nt||this.boundingBox,Lt||this.xStep,Ht||this.yStep,this.gState,ee||this.matrix);Ae.stream=this.stream;var Re=O+"$$"+this.cloneIndex+++"$$";return he(Re,Ae),Ae}var Cd=function(O,nt){var Lt=Nn[O.key],Ht=ze[Lt];if(Ht instanceof Yh)st("q"),st(Ed(nt)),Ht.gState&&B.setGState(Ht.gState),st(O.matrix.toString()+" cm"),st("/"+Lt+" sh"),st("Q");else if(Ht instanceof Pf){var ee=new Nt(1,0,0,-1,0,Sl());O.matrix&&(ee=ee.multiply(O.matrix||se),Lt=dh.call(Ht,O.key,O.boundingBox,O.xStep,O.yStep,ee).id),st("q"),st("/Pattern cs"),st("/"+Lt+" scn"),Ht.gState&&B.setGState(Ht.gState),st(nt),st("Q")}},Ed=function(O){switch(O){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},iu=B.moveTo=function(O,nt){return st(gt(at(O))+" "+gt(vt(nt))+" m"),this},Xo=B.lineTo=function(O,nt){return st(gt(at(O))+" "+gt(vt(nt))+" l"),this},_a=B.curveTo=function(O,nt,Lt,Ht,ee,Ae){return st([gt(at(O)),gt(vt(nt)),gt(at(Lt)),gt(vt(Ht)),gt(at(ee)),gt(vt(Ae)),"c"].join(" ")),this};B.__private__.line=B.line=function(O,nt,Lt,Ht,ee){if(isNaN(O)||isNaN(nt)||isNaN(Lt)||isNaN(Ht)||!to(ee))throw new Error("Invalid arguments passed to jsPDF.line");return W===V.COMPAT?this.lines([[Lt-O,Ht-nt]],O,nt,[1,1],ee||"S"):this.lines([[Lt-O,Ht-nt]],O,nt,[1,1]).stroke()},B.__private__.lines=B.lines=function(O,nt,Lt,Ht,ee,Ae){var Re,er,Tr,Hr,Wr,rn,Yn,bi,Jr,ls,Cr,zs;if(typeof O=="number"&&(zs=Lt,Lt=nt,nt=O,O=zs),Ht=Ht||[1,1],Ae=Ae||!1,isNaN(nt)||isNaN(Lt)||!Array.isArray(O)||!Array.isArray(Ht)||!to(ee)||typeof Ae!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(iu(nt,Lt),Re=Ht[0],er=Ht[1],Hr=O.length,ls=nt,Cr=Lt,Tr=0;Tr<Hr;Tr++)(Wr=O[Tr]).length===2?(ls=Wr[0]*Re+ls,Cr=Wr[1]*er+Cr,Xo(ls,Cr)):(rn=Wr[0]*Re+ls,Yn=Wr[1]*er+Cr,bi=Wr[2]*Re+ls,Jr=Wr[3]*er+Cr,ls=Wr[4]*Re+ls,Cr=Wr[5]*er+Cr,_a(rn,Yn,bi,Jr,ls,Cr));return Ae&&Wa(),nu(ee),this},B.path=function(O){for(var nt=0;nt<O.length;nt++){var Lt=O[nt],Ht=Lt.c;switch(Lt.op){case"m":iu(Ht[0],Ht[1]);break;case"l":Xo(Ht[0],Ht[1]);break;case"c":_a.apply(this,Ht);break;case"h":Wa()}}return this},B.__private__.rect=B.rect=function(O,nt,Lt,Ht,ee){if(isNaN(O)||isNaN(nt)||isNaN(Lt)||isNaN(Ht)||!to(ee))throw new Error("Invalid arguments passed to jsPDF.rect");return W===V.COMPAT&&(Ht=-Ht),st([gt(at(O)),gt(vt(nt)),gt(at(Lt)),gt(at(Ht)),"re"].join(" ")),nu(ee),this},B.__private__.triangle=B.triangle=function(O,nt,Lt,Ht,ee,Ae,Re){if(isNaN(O)||isNaN(nt)||isNaN(Lt)||isNaN(Ht)||isNaN(ee)||isNaN(Ae)||!to(Re))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Lt-O,Ht-nt],[ee-Lt,Ae-Ht],[O-ee,nt-Ae]],O,nt,[1,1],Re,!0),this},B.__private__.roundedRect=B.roundedRect=function(O,nt,Lt,Ht,ee,Ae,Re){if(isNaN(O)||isNaN(nt)||isNaN(Lt)||isNaN(Ht)||isNaN(ee)||isNaN(Ae)||!to(Re))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var er=4/3*(Math.SQRT2-1);return ee=Math.min(ee,.5*Lt),Ae=Math.min(Ae,.5*Ht),this.lines([[Lt-2*ee,0],[ee*er,0,ee,Ae-Ae*er,ee,Ae],[0,Ht-2*Ae],[0,Ae*er,-ee*er,Ae,-ee,Ae],[2*ee-Lt,0],[-ee*er,0,-ee,-Ae*er,-ee,-Ae],[0,2*Ae-Ht],[0,-Ae*er,ee*er,-Ae,ee,-Ae]],O+ee,nt,[1,1],Re,!0),this},B.__private__.ellipse=B.ellipse=function(O,nt,Lt,Ht,ee){if(isNaN(O)||isNaN(nt)||isNaN(Lt)||isNaN(Ht)||!to(ee))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ae=4/3*(Math.SQRT2-1)*Lt,Re=4/3*(Math.SQRT2-1)*Ht;return iu(O+Lt,nt),_a(O+Lt,nt-Re,O+Ae,nt-Ht,O,nt-Ht),_a(O-Ae,nt-Ht,O-Lt,nt-Re,O-Lt,nt),_a(O-Lt,nt+Re,O-Ae,nt+Ht,O,nt+Ht),_a(O+Ae,nt+Ht,O+Lt,nt+Re,O+Lt,nt),nu(ee),this},B.__private__.circle=B.circle=function(O,nt,Lt,Ht){if(isNaN(O)||isNaN(nt)||isNaN(Lt)||!to(Ht))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(O,nt,Lt,Lt,Ht)},B.setFont=function(O,nt,Lt){return Lt&&(nt=dt(nt,Lt)),_r=ut(O,nt,{disableWarning:!1}),this};var su=B.__private__.getFont=B.getFont=function(){return Qe[ut.apply(B,arguments)]};B.__private__.getFontList=B.getFontList=function(){var O,nt,Lt={};for(O in Mr)if(Mr.hasOwnProperty(O))for(nt in Lt[O]=[],Mr[O])Mr[O].hasOwnProperty(nt)&&Lt[O].push(nt);return Lt},B.addFont=function(O,nt,Lt,Ht,ee){var Ae=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ae.indexOf(arguments[3])!==-1?ee=arguments[3]:arguments[3]&&Ae.indexOf(arguments[3])==-1&&(Lt=dt(Lt,Ht)),ee=ee||"Identity-H",Pi.call(this,O,nt,Lt,ee)};var Xa,_c=r.lineWidth||.200025,Cs=B.__private__.getLineWidth=B.getLineWidth=function(){return _c},fh=B.__private__.setLineWidth=B.setLineWidth=function(O){return _c=O,st(gt(at(O))+" w"),this};B.__private__.setLineDash=Gr.API.setLineDash=Gr.API.setLineDashPattern=function(O,nt){if(O=O||[],nt=nt||0,isNaN(nt)||!Array.isArray(O))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return O=O.map(function(Lt){return gt(at(Lt))}).join(" "),nt=gt(at(nt)),st("["+O+"] "+nt+" d"),this};var ou=B.__private__.getLineHeight=B.getLineHeight=function(){return ye*Xa};B.__private__.getLineHeight=B.getLineHeight=function(){return ye*Xa};var va=B.__private__.setLineHeightFactor=B.setLineHeightFactor=function(O){return typeof(O=O||1.15)=="number"&&(Xa=O),this},Jo=B.__private__.getLineHeightFactor=B.getLineHeightFactor=function(){return Xa};va(r.lineHeight);var en=B.__private__.getHorizontalCoordinate=function(O){return at(O)},Yo=B.__private__.getVerticalCoordinate=function(O){return W===V.ADVANCED?O:X[wt].mediaBox.topRightY-X[wt].mediaBox.bottomLeftY-at(O)},Sd=B.__private__.getHorizontalCoordinateString=B.getHorizontalCoordinateString=function(O){return gt(en(O))},eo=B.__private__.getVerticalCoordinateString=B.getVerticalCoordinateString=function(O){return gt(Yo(O))},Zo=r.strokeColor||"0 G";B.__private__.getStrokeColor=B.getDrawColor=function(){return Or(Zo)},B.__private__.setStrokeColor=B.setDrawColor=function(O,nt,Lt,Ht){return Zo=xr({ch1:O,ch2:nt,ch3:Lt,ch4:Ht,pdfColorType:"draw",precision:2}),st(Zo),this};var au=r.fillColor||"0 g";B.__private__.getFillColor=B.getFillColor=function(){return Or(au)},B.__private__.setFillColor=B.setFillColor=function(O,nt,Lt,Ht){return au=xr({ch1:O,ch2:nt,ch3:Lt,ch4:Ht,pdfColorType:"fill",precision:2}),st(au),this};var vc=r.textColor||"0 g",ph=B.__private__.getTextColor=B.getTextColor=function(){return Or(vc)};B.__private__.setTextColor=B.setTextColor=function(O,nt,Lt,Ht){return vc=xr({ch1:O,ch2:nt,ch3:Lt,ch4:Ht,pdfColorType:"text",precision:3}),this};var El=r.charSpace,gh=B.__private__.getCharSpace=B.getCharSpace=function(){return parseFloat(El||0)};B.__private__.setCharSpace=B.setCharSpace=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return El=O,this};var lu=0;B.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},B.__private__.setLineCap=B.setLineCap=function(O){var nt=B.CapJoinStyles[O];if(nt===void 0)throw new Error("Line cap style of '"+O+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return lu=nt,st(nt+" J"),this};var cu=0;B.__private__.setLineJoin=B.setLineJoin=function(O){var nt=B.CapJoinStyles[O];if(nt===void 0)throw new Error("Line join style of '"+O+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return cu=nt,st(nt+" j"),this},B.__private__.setLineMiterLimit=B.__private__.setMiterLimit=B.setLineMiterLimit=B.setMiterLimit=function(O){if(O=O||0,isNaN(O))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return st(gt(at(O))+" M"),this},B.GState=ky,B.setGState=function(O){(O=typeof O=="string"?sn[vn[O]]:cA(null,O)).equals(cn)||(st("/"+O.id+" gs"),cn=O)};var cA=function(O,nt){if(!O||!vn[O]){var Lt=!1;for(var Ht in sn)if(sn.hasOwnProperty(Ht)&&sn[Ht].equals(nt)){Lt=!0;break}if(Lt)nt=sn[Ht];else{var ee="GS"+(Object.keys(sn).length+1).toString(10);sn[ee]=nt,nt.id=ee}return O&&(vn[O]=nt.id),Z.publish("addGState",nt),nt}};B.addGState=function(O,nt){return cA(O,nt),this},B.saveGraphicsState=function(){return st("q"),_n.push({key:_r,size:ye,color:vc}),this},B.restoreGraphicsState=function(){st("Q");var O=_n.pop();return _r=O.key,ye=O.size,vc=O.color,cn=null,this},B.setCurrentTransformationMatrix=function(O){return st(O.toString()+" cm"),this},B.comment=function(O){return st("#"+O),this};var Bo=function(O,nt){var Lt=O||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Lt},set:function(Ae){isNaN(Ae)||(Lt=parseFloat(Ae))}});var Ht=nt||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ht},set:function(Ae){isNaN(Ae)||(Ht=parseFloat(Ae))}});var ee="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ee},set:function(Ae){ee=Ae.toString()}}),this},uu=function(O,nt,Lt,Ht){Bo.call(this,O,nt),this.type="rect";var ee=Lt||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ee},set:function(Re){isNaN(Re)||(ee=parseFloat(Re))}});var Ae=Ht||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ae},set:function(Re){isNaN(Re)||(Ae=parseFloat(Re))}}),this},uA=function(){this.page=Ct,this.currentPage=wt,this.pages=Ie.slice(0),this.pagesContext=X.slice(0),this.x=gn,this.y=pe,this.matrix=gr,this.width=ba(wt),this.height=Sl(wt),this.outputDestination=He,this.id="",this.objectNumber=-1};uA.prototype.restore=function(){Ct=this.page,wt=this.currentPage,X=this.pagesContext,Ie=this.pages,gn=this.x,pe=this.y,gr=this.matrix,hA(wt,this.width),hu(wt,this.height),He=this.outputDestination};var AA=function(O,nt,Lt,Ht,ee){Gt.push(new uA),Ct=wt=0,Ie=[],gn=O,pe=nt,gr=ee,Qs([Lt,Ht])},bc=function(O){if(Qt[O])Gt.pop().restore();else{var nt=new uA,Lt="Xo"+(Object.keys(Bt).length+1).toString(10);nt.id=Lt,Qt[O]=Lt,Bt[Lt]=nt,Z.publish("addFormObject",nt),Gt.pop().restore()}};for(var Au in B.beginFormObject=function(O,nt,Lt,Ht,ee){return AA(O,nt,Lt,Ht,ee),this},B.endFormObject=function(O){return bc(O),this},B.doFormObject=function(O,nt){var Lt=Bt[Qt[O]];return st("q"),st(nt.toString()+" cm"),st("/"+Lt.id+" Do"),st("Q"),this},B.getFormObject=function(O){var nt=Bt[Qt[O]];return{x:nt.x,y:nt.y,width:nt.width,height:nt.height,matrix:nt.matrix}},B.save=function(O,nt){return O=O||"generated.pdf",(nt=nt||{}).returnPromise=nt.returnPromise||!1,nt.returnPromise===!1?(Jh(Xn(zr()),O),typeof Jh.unload=="function"&&Vr.setTimeout&&setTimeout(Jh.unload,911),this):new Promise(function(Lt,Ht){try{var ee=Jh(Xn(zr()),O);typeof Jh.unload=="function"&&Vr.setTimeout&&setTimeout(Jh.unload,911),Lt(ee)}catch(Ae){Ht(Ae.message)}})},Gr.API)Gr.API.hasOwnProperty(Au)&&(Au==="events"&&Gr.API.events.length?function(O,nt){var Lt,Ht,ee;for(ee=nt.length-1;ee!==-1;ee--)Lt=nt[ee][0],Ht=nt[ee][1],O.subscribe.apply(O,[Lt].concat(typeof Ht=="function"?[Ht]:Ht))}(Z,Gr.API.events):B[Au]=Gr.API[Au]);var ba=B.getPageWidth=function(O){return(X[O=O||wt].mediaBox.topRightX-X[O].mediaBox.bottomLeftX)/De},hA=B.setPageWidth=function(O,nt){X[O].mediaBox.topRightX=nt*De+X[O].mediaBox.bottomLeftX},Sl=B.getPageHeight=function(O){return(X[O=O||wt].mediaBox.topRightY-X[O].mediaBox.bottomLeftY)/De},hu=B.setPageHeight=function(O,nt){X[O].mediaBox.topRightY=nt*De+X[O].mediaBox.bottomLeftY};return B.internal={pdfEscape:Mi,getStyle:lA,getFont:su,getFontSize:Oe,getCharSpace:gh,getTextColor:ph,getLineHeight:ou,getLineHeightFactor:Jo,getLineWidth:Cs,write:pr,getHorizontalCoordinate:en,getVerticalCoordinate:Yo,getCoordinateString:Sd,getVerticalCoordinateString:eo,collections:{},newObject:Xt,newAdditionalObject:tr,newObjectDeferred:we,newObjectDeferredBegin:je,getFilters:$r,putStream:Xr,events:Z,scaleFactor:De,pageSize:{getWidth:function(){return ba(wt)},setWidth:function(O){hA(wt,O)},getHeight:function(){return Sl(wt)},setHeight:function(O){hu(wt,O)}},encryptionOptions:_,encryption:wn,getEncryptor:yc,output:Jn,getNumberOfPages:mc,pages:Ie,out:st,f2:St,f3:ot,getPageInfo:Zi,getPageInfoByObjId:Br,getCurrentPageInfo:tu,getPDFVersion:R,Point:Bo,Rectangle:uu,Matrix:Nt,hasHotfix:Si},Object.defineProperty(B.internal.pageSize,"width",{get:function(){return ba(wt)},set:function(O){hA(wt,O)},enumerable:!0,configurable:!0}),Object.defineProperty(B.internal.pageSize,"height",{get:function(){return Sl(wt)},set:function(O){hu(wt,O)},enumerable:!0,configurable:!0}),$a.call(B,ue),_r="F1",Bs(i,e),Z.publish("initialized"),B}Ff.prototype.lsbFirstWord=function(r){return String.fromCharCode(r>>0&255,r>>8&255,r>>16&255,r>>24&255)},Ff.prototype.toHexString=function(r){return r.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Ff.prototype.hexToBytes=function(r){for(var t=[],e=0;e<r.length;e+=2)t.push(String.fromCharCode(parseInt(r.substr(e,2),16)));return t.join("")},Ff.prototype.processOwnerPassword=function(r,t){return K2(q2(t).substr(0,5),r)},Ff.prototype.encryptor=function(r,t){var e=q2(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return K2(e,n)}},ky.prototype.equals=function(r){var t,e="id,objectNumber,equals";if(!r||Un(r)!==Un(this))return!1;var n=0;for(t in this)if(!(e.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!r.hasOwnProperty(t)||this[t]!==r[t])return!1;n++}for(t in r)r.hasOwnProperty(t)&&e.indexOf(t)<0&&n--;return n===0},Gr.API={events:[]},Gr.version="2.5.1";var Ni=Gr.API,$2=1,Zh=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Mf=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Zr=function(r){return r.toFixed(2)},JA=function(r){return r.toFixed(5)};Ni.__acroform__={};var fa=function(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r},AP=function(r){return r*$2},jc=function(r){var t=new dP,e=wr.internal.getHeight(r)||0,n=wr.internal.getWidth(r)||0;return t.BBox=[0,0,Number(Zr(n)),Number(Zr(e))],t},Ort=Ni.__acroform__.setBit=function(r,t){if(r=r||0,t=t||0,isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|=1<<t},Drt=Ni.__acroform__.clearBit=function(r,t){if(r=r||0,t=t||0,isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&=~(1<<t)},Nrt=Ni.__acroform__.getBit=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return r&1<<t?1:0},Gi=Ni.__acroform__.getBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Nrt(r,t-1)},ji=Ni.__acroform__.setBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Ort(r,t-1)},qi=Ni.__acroform__.clearBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Drt(r,t-1)},krt=Ni.__acroform__.calculateCoordinates=function(r,t){var e=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,i=r[0],s=r[1],a=r[2],o=r[3],d={};return d.lowerLeft_X=e(i)||0,d.lowerLeft_Y=n(s+o)||0,d.upperRight_X=e(i+a)||0,d.upperRight_Y=n(s)||0,[Number(Zr(d.lowerLeft_X)),Number(Zr(d.lowerLeft_Y)),Number(Zr(d.upperRight_X)),Number(Zr(d.upperRight_Y))]},Qrt=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var t=[],e=r._V||r.DV,n=W2(r,e),i=r.scope.internal.getFont(r.fontName,r.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(r.scope.__private__.encodeColorString(r.color)),t.push("/"+i+" "+Zr(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=jc(r);return s.scope=r.scope,s.stream=t.join(`
`),s}},W2=function(r,t){var e=r.fontSize===0?r.maxFontSize:r.fontSize,n={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=r.multiline?i.map(function(ot){return ot.split(`
`)}):i.map(function(ot){return[ot]});var s=e,a=wr.internal.getHeight(r)||0;a=a<0?-a:a;var o=wr.internal.getWidth(r)||0;o=o<0?-o:o;var d=function(ot,at,bt){if(ot+1<i.length){var vt=at+" "+i[ot+1][0];return Qy(vt,r,bt).width<=o-4}return!1};s++;t:for(;s>0;){t="",s--;var f,_,w=Qy("3",r,s).height,x=r.multiline?a-s:(a-w)/2,B=x+=2,P=0,R=0,N=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+Qy(t,r,s=12).width+", FieldWidth:"+o+`
`;break}for(var Q="",V=0,W=0;W<i.length;W++)if(i.hasOwnProperty(W)){var et=!1;if(i[W].length!==1&&N!==i[W].length-1){if((w+2)*(V+2)+2>a)continue t;Q+=i[W][N],et=!0,R=W,W--}else{Q=(Q+=i[W][N]+" ").substr(Q.length-1)==" "?Q.substr(0,Q.length-1):Q;var ct=parseInt(W),dt=d(ct,Q,s),gt=W>=i.length-1;if(dt&&!gt){Q+=" ",N=0;continue}if(dt||gt){if(gt)R=ct;else if(r.multiline&&(w+2)*(V+2)+2>a)continue t}else{if(!r.multiline||(w+2)*(V+2)+2>a)continue t;R=ct}}for(var ht="",It=P;It<=R;It++){var St=i[It];if(r.multiline){if(It===R){ht+=St[N]+" ",N=(N+1)%St.length;continue}if(It===P){ht+=St[St.length-1]+" ";continue}}ht+=St[0]+" "}switch(ht=ht.substr(ht.length-1)==" "?ht.substr(0,ht.length-1):ht,_=Qy(ht,r,s).width,r.textAlign){case"right":f=o-_-2;break;case"center":f=(o-_)/2;break;case"left":default:f=2}t+=Zr(f)+" "+Zr(B)+` Td
`,t+="("+Zh(ht)+`) Tj
`,t+=-Zr(f)+` 0 Td
`,B=-(s+2),_=0,P=et?R:R+1,V++,Q=""}break}return n.text=t,n.fontSize=s,n},Qy=function(r,t,e){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(r,{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e)*1.5,width:i}},zrt={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Hrt=function(r,t){var e={type:"reference",object:r};t.internal.getPageInfo(r.page).pageContext.annotations.find(function(n){return n.type===e.type&&n.object===e.object})===void 0&&t.internal.getPageInfo(r.page).pageContext.annotations.push(e)},Vrt=function(r,t){for(var e in r)if(r.hasOwnProperty(e)){var n=e,i=r[e];t.internal.newObjectDeferredBegin(i.objId,!0),Un(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete r[n]}},Grt=function(r,t){if(t.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(rc.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(zrt)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");$2=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new fP,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(e){e.internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var s=n[i];s.objId=void 0,s.hasAnnotation&&Hrt(s,e)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(e){if(e.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(e){(function(n,i){var s=!n;for(var a in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(a)){var o=n[a],d=[],f=o.Rect;if(o.Rect&&(o.Rect=krt(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=wr.createDefaultAppearanceStream(o),Un(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(d=o.getKeyValueListForStream()),o.Rect=f,o.hasAppearanceStream&&!o.appearanceStreamContent){var _=Qrt(o);d.push({key:"AP",value:"<</N "+_+">>"}),i.internal.acroformPlugin.xForms.push(_)}if(o.appearanceStreamContent){var w="";for(var x in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(x)){var B=o.appearanceStreamContent[x];if(w+="/"+x+" ",w+="<<",Object.keys(B).length>=1||Array.isArray(B)){for(var a in B)if(B.hasOwnProperty(a)){var P=B[a];typeof P=="function"&&(P=P.call(i,o)),w+="/"+a+" "+P+" ",i.internal.acroformPlugin.xForms.indexOf(P)>=0||i.internal.acroformPlugin.xForms.push(P)}}else typeof(P=B)=="function"&&(P=P.call(i,o)),w+="/"+a+" "+P,i.internal.acroformPlugin.xForms.indexOf(P)>=0||i.internal.acroformPlugin.xForms.push(P);w+=">>"}d.push({key:"AP",value:`<<
`+w+">>"})}i.internal.putStream({additionalKeyValues:d,objectId:o.objId}),i.internal.out("endobj")}s&&Vrt(i.internal.acroformPlugin.xForms,i)})(e,r)}),r.internal.acroformPlugin.isInitialized=!0}},hP=Ni.__acroform__.arrayToPdfArray=function(r,t,e){var n=function(a){return a};if(Array.isArray(r)){for(var i="[",s=0;s<r.length;s++)switch(s!==0&&(i+=" "),Un(r[s])){case"boolean":case"number":case"object":i+=r[s].toString();break;case"string":r[s].substr(0,1)!=="/"?(t!==void 0&&e&&(n=e.internal.getEncryptor(t)),i+="("+Zh(n(r[s].toString()))+")"):i+=r[s].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},X2=function(r,t,e){var n=function(i){return i};return t!==void 0&&e&&(n=e.internal.getEncryptor(t)),(r=r||"").toString(),r="("+Zh(n(r))+")"},qc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};qc.prototype.toString=function(){return this.objId+" 0 R"},qc.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},qc.prototype.getKeyValueListForStream=function(){var r=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var e in t)if(Object.getOwnPropertyDescriptor(this,t[e]).configurable===!1){var n=t[e],i=this[n];i&&(Array.isArray(i)?r.push({key:n,value:hP(i,this.objId,this.scope)}):i instanceof qc?(i.scope=this.scope,r.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&r.push({key:n,value:i}))}return r};var dP=function(){qc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){r=e.trim()},get:function(){return r||null}})};fa(dP,qc);var fP=function(){qc.call(this);var r,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var e=function(n){return n};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+Zh(e(r))+")"}},set:function(e){r=e}})};fa(fP,qc);var rc=function r(){qc.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(Q){if(isNaN(Q))throw new Error('Invalid value "'+Q+'" for attribute F supplied.');t=Q}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Gi(t,3)},set:function(Q){Q?this.F=ji(t,3):this.F=qi(t,3)}});var e=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return e},set:function(Q){if(isNaN(Q))throw new Error('Invalid value "'+Q+'" for attribute Ff supplied.');e=Q}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(Q){n=Q!==void 0?Q:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(Q){n[0]=Q}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(Q){n[1]=Q}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(Q){n[2]=Q}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(Q){n[3]=Q}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(Q){switch(Q){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=Q;break;default:throw new Error('Invalid value "'+Q+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Vy)return;s="FieldObject"+r.FieldNum++}var Q=function(V){return V};return this.scope&&(Q=this.scope.internal.getEncryptor(this.objId)),"("+Zh(Q(s))+")"},set:function(Q){s=Q.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(Q){s=Q}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(Q){a=Q}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(Q){o=Q}});var d=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return d},set:function(Q){d=Q}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/$2:f},set:function(Q){f=Q}});var _="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return _},set:function(Q){_=Q}});var w="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!w||this instanceof Vy||this instanceof td))return X2(w,this.objId,this.scope)},set:function(Q){Q=Q.toString(),w=Q}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof Ds?x:X2(x,this.objId,this.scope)},set:function(Q){Q=Q.toString(),x=this instanceof Ds?Q:Q.substr(0,1)==="("?Mf(Q.substr(1,Q.length-2)):Mf(Q)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ds?Mf(x.substr(1,x.length-1)):x},set:function(Q){Q=Q.toString(),x=this instanceof Ds?"/"+Q:Q}});var B=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(B)return B},set:function(Q){this.V=Q}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(B)return this instanceof Ds?B:X2(B,this.objId,this.scope)},set:function(Q){Q=Q.toString(),B=this instanceof Ds?Q:Q.substr(0,1)==="("?Mf(Q.substr(1,Q.length-2)):Mf(Q)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ds?Mf(B.substr(1,B.length-1)):B},set:function(Q){Q=Q.toString(),B=this instanceof Ds?"/"+Q:Q}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var P,R=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return R},set:function(Q){Q=!!Q,R=Q}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(P)return P},set:function(Q){P=Q}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,1)},set:function(Q){Q?this.Ff=ji(this.Ff,1):this.Ff=qi(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,2)},set:function(Q){Q?this.Ff=ji(this.Ff,2):this.Ff=qi(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,3)},set:function(Q){Q?this.Ff=ji(this.Ff,3):this.Ff=qi(this.Ff,3)}});var N=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(N!==null)return N},set:function(Q){if([0,1,2].indexOf(Q)===-1)throw new Error('Invalid value "'+Q+'" for attribute Q supplied.');N=Q}}),Object.defineProperty(this,"textAlign",{get:function(){var Q;switch(N){case 0:default:Q="left";break;case 1:Q="center";break;case 2:Q="right"}return Q},configurable:!0,enumerable:!0,set:function(Q){switch(Q){case"right":case 2:N=2;break;case"center":case 1:N=1;break;case"left":case 0:default:N=0}}})};fa(rc,qc);var Rf=function(){rc.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){r=e}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return hP(t,this.objId,this.scope)},set:function(e){var n,i;i=[],typeof(n=e)=="string"&&(i=function(s,a,o){o||(o=1);for(var d,f=[];d=a.exec(s);)f.push(d[o]);return f}(n,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,n){for(n=n||!1,e=(e=e||"").toString();t.indexOf(e)!==-1&&(t.splice(t.indexOf(e),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,18)},set:function(e){e?this.Ff=ji(this.Ff,18):this.Ff=qi(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,19)},set:function(e){this.combo===!0&&(e?this.Ff=ji(this.Ff,19):this.Ff=qi(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,20)},set:function(e){e?(this.Ff=ji(this.Ff,20),t.sort()):this.Ff=qi(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,22)},set:function(e){e?this.Ff=ji(this.Ff,22):this.Ff=qi(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,23)},set:function(e){e?this.Ff=ji(this.Ff,23):this.Ff=qi(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,27)},set:function(e){e?this.Ff=ji(this.Ff,27):this.Ff=qi(this.Ff,27)}}),this.hasAppearanceStream=!1};fa(Rf,rc);var Uf=function(){Rf.call(this),this.fontName="helvetica",this.combo=!1};fa(Uf,Rf);var Of=function(){Uf.call(this),this.combo=!0};fa(Of,Uf);var zy=function(){Of.call(this),this.edit=!0};fa(zy,Of);var Ds=function(){rc.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,15)},set:function(e){e?this.Ff=ji(this.Ff,15):this.Ff=qi(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,16)},set:function(e){e?this.Ff=ji(this.Ff,16):this.Ff=qi(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,17)},set:function(e){e?this.Ff=ji(this.Ff,17):this.Ff=qi(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,26)},set:function(e){e?this.Ff=ji(this.Ff,26):this.Ff=qi(this.Ff,26)}});var r,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(s){return s};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,i=[];for(n in i.push("<<"),t)i.push("/"+n+" ("+Zh(e(t[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(e){Un(e)==="object"&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){typeof e=="string"&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(e){r="/"+e}})};fa(Ds,rc);var Hy=function(){Ds.call(this),this.pushButton=!0};fa(Hy,Ds);var Df=function(){Ds.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t!==void 0?t:[]}})};fa(Df,Ds);var Vy=function(){var r,t;rc.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var e,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,a=[];for(s in a.push("<<"),n)a.push("/"+s+" ("+Zh(i(n[s]))+")");return a.push(">>"),a.join(`
`)},set:function(i){Un(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(i){e="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=wr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};fa(Vy,rc),Df.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var e=this.Kids[t];e.appearanceStreamContent=r.createAppearanceStream(e.optionName),e.caption=r.getCA()}},Df.prototype.createOption=function(r){var t=new Vy;return t.Parent=this,t.optionName=r,this.Kids.push(t),jrt.call(this.scope,t),t};var Gy=function(){Ds.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=wr.CheckBox.createAppearanceStream()};fa(Gy,Ds);var td=function(){rc.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,13)},set:function(t){t?this.Ff=ji(this.Ff,13):this.Ff=qi(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,21)},set:function(t){t?this.Ff=ji(this.Ff,21):this.Ff=qi(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,23)},set:function(t){t?this.Ff=ji(this.Ff,23):this.Ff=qi(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,24)},set:function(t){t?this.Ff=ji(this.Ff,24):this.Ff=qi(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,25)},set:function(t){t?this.Ff=ji(this.Ff,25):this.Ff=qi(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,26)},set:function(t){t?this.Ff=ji(this.Ff,26):this.Ff=qi(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){Number.isInteger(t)&&(r=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};fa(td,rc);var jy=function(){td.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Gi(this.Ff,14)},set:function(r){r?this.Ff=ji(this.Ff,14):this.Ff=qi(this.Ff,14)}}),this.password=!0};fa(jy,td);var wr={CheckBox:{createAppearanceStream:function(){return{N:{On:wr.CheckBox.YesNormal},D:{On:wr.CheckBox.YesPushDown,Off:wr.CheckBox.OffPushDown}}},YesPushDown:function(r){var t=jc(r);t.scope=r.scope;var e=[],n=r.scope.internal.getFont(r.fontName,r.fontStyle).id,i=r.scope.__private__.encodeColorString(r.color),s=W2(r,r.caption);return e.push("0.749023 g"),e.push("0 0 "+Zr(wr.internal.getWidth(r))+" "+Zr(wr.internal.getHeight(r))+" re"),e.push("f"),e.push("BMC"),e.push("q"),e.push("0 0 1 rg"),e.push("/"+n+" "+Zr(s.fontSize)+" Tf "+i),e.push("BT"),e.push(s.text),e.push("ET"),e.push("Q"),e.push("EMC"),t.stream=e.join(`
`),t},YesNormal:function(r){var t=jc(r);t.scope=r.scope;var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),i=[],s=wr.internal.getHeight(r),a=wr.internal.getWidth(r),o=W2(r,r.caption);return i.push("1 g"),i.push("0 0 "+Zr(a)+" "+Zr(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Zr(a-1)+" "+Zr(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+e+" "+Zr(o.fontSize)+" Tf "+n),i.push(o.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(r){var t=jc(r);t.scope=r.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+Zr(wr.internal.getWidth(r))+" "+Zr(wr.internal.getHeight(r))+" re"),e.push("f"),t.stream=e.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(r){var t={D:{Off:wr.RadioButton.Circle.OffPushDown},N:{}};return t.N[r]=wr.RadioButton.Circle.YesNormal,t.D[r]=wr.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(r){var t=jc(r);t.scope=r.scope;var e=[],n=wr.internal.getWidth(r)<=wr.internal.getHeight(r)?wr.internal.getWidth(r)/4:wr.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var i=wr.internal.Bezier_C,s=Number((n*i).toFixed(5));return e.push("q"),e.push("1 0 0 1 "+JA(wr.internal.getWidth(r)/2)+" "+JA(wr.internal.getHeight(r)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),e.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),e.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),e.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(r){var t=jc(r);t.scope=r.scope;var e=[],n=wr.internal.getWidth(r)<=wr.internal.getHeight(r)?wr.internal.getWidth(r)/4:wr.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*wr.internal.Bezier_C).toFixed(5)),a=Number((n*wr.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+JA(wr.internal.getWidth(r)/2)+" "+JA(wr.internal.getHeight(r)/2)+" cm"),e.push(i+" 0 m"),e.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),e.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),e.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),e.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),e.push("f"),e.push("Q"),e.push("0 g"),e.push("q"),e.push("1 0 0 1 "+JA(wr.internal.getWidth(r)/2)+" "+JA(wr.internal.getHeight(r)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),e.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),e.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),e.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},OffPushDown:function(r){var t=jc(r);t.scope=r.scope;var e=[],n=wr.internal.getWidth(r)<=wr.internal.getHeight(r)?wr.internal.getWidth(r)/4:wr.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*wr.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+JA(wr.internal.getWidth(r)/2)+" "+JA(wr.internal.getHeight(r)/2)+" cm"),e.push(i+" 0 m"),e.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),e.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),e.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),e.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t}},Cross:{createAppearanceStream:function(r){var t={D:{Off:wr.RadioButton.Cross.OffPushDown},N:{}};return t.N[r]=wr.RadioButton.Cross.YesNormal,t.D[r]=wr.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(r){var t=jc(r);t.scope=r.scope;var e=[],n=wr.internal.calculateCross(r);return e.push("q"),e.push("1 1 "+Zr(wr.internal.getWidth(r)-2)+" "+Zr(wr.internal.getHeight(r)-2)+" re"),e.push("W"),e.push("n"),e.push(Zr(n.x1.x)+" "+Zr(n.x1.y)+" m"),e.push(Zr(n.x2.x)+" "+Zr(n.x2.y)+" l"),e.push(Zr(n.x4.x)+" "+Zr(n.x4.y)+" m"),e.push(Zr(n.x3.x)+" "+Zr(n.x3.y)+" l"),e.push("s"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(r){var t=jc(r);t.scope=r.scope;var e=wr.internal.calculateCross(r),n=[];return n.push("0.749023 g"),n.push("0 0 "+Zr(wr.internal.getWidth(r))+" "+Zr(wr.internal.getHeight(r))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Zr(wr.internal.getWidth(r)-2)+" "+Zr(wr.internal.getHeight(r)-2)+" re"),n.push("W"),n.push("n"),n.push(Zr(e.x1.x)+" "+Zr(e.x1.y)+" m"),n.push(Zr(e.x2.x)+" "+Zr(e.x2.y)+" l"),n.push(Zr(e.x4.x)+" "+Zr(e.x4.y)+" m"),n.push(Zr(e.x3.x)+" "+Zr(e.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(r){var t=jc(r);t.scope=r.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+Zr(wr.internal.getWidth(r))+" "+Zr(wr.internal.getHeight(r))+" re"),e.push("f"),t.stream=e.join(`
`),t}}},createDefaultAppearanceStream:function(r){var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,e=r.scope.__private__.encodeColorString(r.color);return"/"+t+" "+r.fontSize+" Tf "+e}};wr.internal={Bezier_C:.551915024494,calculateCross:function(r){var t=wr.internal.getWidth(r),e=wr.internal.getHeight(r),n=Math.min(t,e);return{x1:{x:(t-n)/2,y:(e-n)/2+n},x2:{x:(t-n)/2+n,y:(e-n)/2},x3:{x:(t-n)/2,y:(e-n)/2},x4:{x:(t-n)/2+n,y:(e-n)/2+n}}}},wr.internal.getWidth=function(r){var t=0;return Un(r)==="object"&&(t=AP(r.Rect[2])),t},wr.internal.getHeight=function(r){var t=0;return Un(r)==="object"&&(t=AP(r.Rect[3])),t};var jrt=Ni.addField=function(r){if(Grt(this,r),!(r instanceof rc))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=r).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};Ni.AcroFormChoiceField=Rf,Ni.AcroFormListBox=Uf,Ni.AcroFormComboBox=Of,Ni.AcroFormEditBox=zy,Ni.AcroFormButton=Ds,Ni.AcroFormPushButton=Hy,Ni.AcroFormRadioButton=Df,Ni.AcroFormCheckBox=Gy,Ni.AcroFormTextField=td,Ni.AcroFormPasswordField=jy,Ni.AcroFormAppearance=wr,Ni.AcroForm={ChoiceField:Rf,ListBox:Uf,ComboBox:Of,EditBox:zy,Button:Ds,PushButton:Hy,RadioButton:Df,CheckBox:Gy,TextField:td,PasswordField:jy,Appearance:wr},Gr.AcroForm={ChoiceField:Rf,ListBox:Uf,ComboBox:Of,EditBox:zy,Button:Ds,PushButton:Hy,RadioButton:Df,CheckBox:Gy,TextField:td,PasswordField:jy,Appearance:wr};function pP(r){return r.reduce(function(t,e,n){return t[e]=n,t},{})}(function(r){r.__addimage__={};var t="UNKNOWN",e={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=r.__addimage__.getImageFileTypeByImageData=function(ot,at){var bt,vt,$t,Wt,Jt,qt=t;if((at=at||t)==="RGBA"||ot.data!==void 0&&ot.data instanceof Uint8ClampedArray&&"height"in ot&&"width"in ot)return"RGBA";if(dt(ot))for(Jt in e)for($t=e[Jt],bt=0;bt<$t.length;bt+=1){for(Wt=!0,vt=0;vt<$t[bt].length;vt+=1)if($t[bt][vt]!==void 0&&$t[bt][vt]!==ot[vt]){Wt=!1;break}if(Wt===!0){qt=Jt;break}}else for(Jt in e)for($t=e[Jt],bt=0;bt<$t.length;bt+=1){for(Wt=!0,vt=0;vt<$t[bt].length;vt+=1)if($t[bt][vt]!==void 0&&$t[bt][vt]!==ot.charCodeAt(vt)){Wt=!1;break}if(Wt===!0){qt=Jt;break}}return qt===t&&at!==t&&(qt=at),qt},i=function ot(at){for(var bt=this.internal.write,vt=this.internal.putStream,$t=(0,this.internal.getFilters)();$t.indexOf("FlateEncode")!==-1;)$t.splice($t.indexOf("FlateEncode"),1);at.objectId=this.internal.newObject();var Wt=[];if(Wt.push({key:"Type",value:"/XObject"}),Wt.push({key:"Subtype",value:"/Image"}),Wt.push({key:"Width",value:at.width}),Wt.push({key:"Height",value:at.height}),at.colorSpace===N.INDEXED?Wt.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(at.palette.length/3-1)+" "+("sMask"in at&&at.sMask!==void 0?at.objectId+2:at.objectId+1)+" 0 R]"}):(Wt.push({key:"ColorSpace",value:"/"+at.colorSpace}),at.colorSpace===N.DEVICE_CMYK&&Wt.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Wt.push({key:"BitsPerComponent",value:at.bitsPerComponent}),"decodeParameters"in at&&at.decodeParameters!==void 0&&Wt.push({key:"DecodeParms",value:"<<"+at.decodeParameters+">>"}),"transparency"in at&&Array.isArray(at.transparency)){for(var Jt="",qt=0,te=at.transparency.length;qt<te;qt++)Jt+=at.transparency[qt]+" "+at.transparency[qt]+" ";Wt.push({key:"Mask",value:"["+Jt+"]"})}at.sMask!==void 0&&Wt.push({key:"SMask",value:at.objectId+1+" 0 R"});var Yt=at.filter!==void 0?["/"+at.filter]:void 0;if(vt({data:at.data,additionalKeyValues:Wt,alreadyAppliedFilters:Yt,objectId:at.objectId}),bt("endobj"),"sMask"in at&&at.sMask!==void 0){var be="/Predictor "+at.predictor+" /Colors 1 /BitsPerComponent "+at.bitsPerComponent+" /Columns "+at.width,it={width:at.width,height:at.height,colorSpace:"DeviceGray",bitsPerComponent:at.bitsPerComponent,decodeParameters:be,data:at.sMask};"filter"in at&&(it.filter=at.filter),ot.call(this,it)}if(at.colorSpace===N.INDEXED){var wt=this.internal.newObject();vt({data:ht(new Uint8Array(at.palette)),objectId:wt}),bt("endobj")}},s=function(){var ot=this.internal.collections.addImage_images;for(var at in ot)i.call(this,ot[at])},a=function(){var ot,at=this.internal.collections.addImage_images,bt=this.internal.write;for(var vt in at)bt("/I"+(ot=at[vt]).index,ot.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",a))},d=function(){var ot=this.internal.collections.addImage_images;return o.call(this),ot},f=function(){return Object.keys(this.internal.collections.addImage_images).length},_=function(ot){return typeof r["process"+ot.toUpperCase()]=="function"},w=function(ot){return Un(ot)==="object"&&ot.nodeType===1},x=function(ot,at){if(ot.nodeName==="IMG"&&ot.hasAttribute("src")){var bt=""+ot.getAttribute("src");if(bt.indexOf("data:image/")===0)return $g(unescape(bt).split("base64,").pop());var vt=r.loadFile(bt,!0);if(vt!==void 0)return vt}if(ot.nodeName==="CANVAS"){if(ot.width===0||ot.height===0)throw new Error("Given canvas must have data. Canvas width: "+ot.width+", height: "+ot.height);var $t;switch(at){case"PNG":$t="image/png";break;case"WEBP":$t="image/webp";break;case"JPEG":case"JPG":default:$t="image/jpeg"}return $g(ot.toDataURL($t,1).split("base64,").pop())}},B=function(ot){var at=this.internal.collections.addImage_images;if(at){for(var bt in at)if(ot===at[bt].alias)return at[bt]}},P=function(ot,at,bt){return ot||at||(ot=-96,at=-96),ot<0&&(ot=-1*bt.width*72/ot/this.internal.scaleFactor),at<0&&(at=-1*bt.height*72/at/this.internal.scaleFactor),ot===0&&(ot=at*bt.width/bt.height),at===0&&(at=ot*bt.height/bt.width),[ot,at]},R=function(ot,at,bt,vt,$t,Wt){var Jt=P.call(this,bt,vt,$t),qt=this.internal.getCoordinateString,te=this.internal.getVerticalCoordinateString,Yt=d.call(this);if(bt=Jt[0],vt=Jt[1],Yt[$t.index]=$t,Wt){Wt*=Math.PI/180;var be=Math.cos(Wt),it=Math.sin(Wt),wt=function(Ut){return Ut.toFixed(4)},Ft=[wt(be),wt(it),wt(-1*it),wt(be),0,0,"cm"]}this.internal.write("q"),Wt?(this.internal.write([1,"0","0",1,qt(ot),te(at+vt),"cm"].join(" ")),this.internal.write(Ft.join(" ")),this.internal.write([qt(bt),"0","0",qt(vt),"0","0","cm"].join(" "))):this.internal.write([qt(bt),"0","0",qt(vt),qt(ot),te(at+vt),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+$t.index+" Do"),this.internal.write("Q")},N=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var Q=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},V=r.__addimage__.sHashCode=function(ot){var at,bt,vt=0;if(typeof ot=="string")for(bt=ot.length,at=0;at<bt;at++)vt=(vt<<5)-vt+ot.charCodeAt(at),vt|=0;else if(dt(ot))for(bt=ot.byteLength/2,at=0;at<bt;at++)vt=(vt<<5)-vt+ot[at],vt|=0;return vt},W=r.__addimage__.validateStringAsBase64=function(ot){(ot=ot||"").toString().trim();var at=!0;return ot.length===0&&(at=!1),ot.length%4!=0&&(at=!1),/^[A-Za-z0-9+/]+$/.test(ot.substr(0,ot.length-2))===!1&&(at=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(ot.substr(-2))===!1&&(at=!1),at},et=r.__addimage__.extractImageFromDataUrl=function(ot){var at=(ot=ot||"").split("base64,"),bt=null;if(at.length===2){var vt=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(at[0]);Array.isArray(vt)&&(bt={mimeType:vt[1],charset:vt[2],data:at[1]})}return bt},ct=r.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};r.__addimage__.isArrayBuffer=function(ot){return ct()&&ot instanceof ArrayBuffer};var dt=r.__addimage__.isArrayBufferView=function(ot){return ct()&&typeof Uint32Array<"u"&&(ot instanceof Int8Array||ot instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&ot instanceof Uint8ClampedArray||ot instanceof Int16Array||ot instanceof Uint16Array||ot instanceof Int32Array||ot instanceof Uint32Array||ot instanceof Float32Array||ot instanceof Float64Array)},gt=r.__addimage__.binaryStringToUint8Array=function(ot){for(var at=ot.length,bt=new Uint8Array(at),vt=0;vt<at;vt++)bt[vt]=ot.charCodeAt(vt);return bt},ht=r.__addimage__.arrayBufferToBinaryString=function(ot){for(var at="",bt=dt(ot)?ot:new Uint8Array(ot),vt=0;vt<bt.length;vt+=8192)at+=String.fromCharCode.apply(null,bt.subarray(vt,vt+8192));return at};r.addImage=function(){var ot,at,bt,vt,$t,Wt,Jt,qt,te;if(typeof arguments[1]=="number"?(at=t,bt=arguments[1],vt=arguments[2],$t=arguments[3],Wt=arguments[4],Jt=arguments[5],qt=arguments[6],te=arguments[7]):(at=arguments[1],bt=arguments[2],vt=arguments[3],$t=arguments[4],Wt=arguments[5],Jt=arguments[6],qt=arguments[7],te=arguments[8]),Un(ot=arguments[0])==="object"&&!w(ot)&&"imageData"in ot){var Yt=ot;ot=Yt.imageData,at=Yt.format||at||t,bt=Yt.x||bt||0,vt=Yt.y||vt||0,$t=Yt.w||Yt.width||$t,Wt=Yt.h||Yt.height||Wt,Jt=Yt.alias||Jt,qt=Yt.compression||qt,te=Yt.rotation||Yt.angle||te}var be=this.internal.getFilters();if(qt===void 0&&be.indexOf("FlateEncode")!==-1&&(qt="SLOW"),isNaN(bt)||isNaN(vt))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var it=It.call(this,ot,at,Jt,qt);return R.call(this,bt,vt,$t,Wt,it,te),this};var It=function(ot,at,bt,vt){var $t,Wt,Jt;if(typeof ot=="string"&&n(ot)===t){ot=unescape(ot);var qt=St(ot,!1);(qt!==""||(qt=r.loadFile(ot,!0))!==void 0)&&(ot=qt)}if(w(ot)&&(ot=x(ot,at)),at=n(ot,at),!_(at))throw new Error("addImage does not support files of type '"+at+"', please ensure that a plugin for '"+at+"' support is added.");if(((Jt=bt)==null||Jt.length===0)&&(bt=function(te){return typeof te=="string"||dt(te)?V(te):dt(te.data)?V(te.data):null}(ot)),($t=B.call(this,bt))||(ct()&&(ot instanceof Uint8Array||at==="RGBA"||(Wt=ot,ot=gt(ot))),$t=this["process"+at.toUpperCase()](ot,f.call(this),bt,function(te){return te&&typeof te=="string"&&(te=te.toUpperCase()),te in r.image_compression?te:Q.NONE}(vt),Wt)),!$t)throw new Error("An unknown error occurred whilst processing the image.");return $t},St=r.__addimage__.convertBase64ToBinaryString=function(ot,at){var bt;at=typeof at!="boolean"||at;var vt,$t="";if(typeof ot=="string"){vt=(bt=et(ot))!==null?bt.data:ot;try{$t=$g(vt)}catch(Wt){if(at)throw W(vt)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Wt.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return $t};r.getImageProperties=function(ot){var at,bt,vt="";if(w(ot)&&(ot=x(ot)),typeof ot=="string"&&n(ot)===t&&((vt=St(ot,!1))===""&&(vt=r.loadFile(ot)||""),ot=vt),bt=n(ot),!_(bt))throw new Error("addImage does not support files of type '"+bt+"', please ensure that a plugin for '"+bt+"' support is added.");if(!ct()||ot instanceof Uint8Array||(ot=gt(ot)),!(at=this["process"+bt.toUpperCase()](ot)))throw new Error("An unknown error occurred whilst processing the image");return at.fileType=bt,at}})(Gr.API),function(r){var t=function(e){if(e!==void 0&&e!="")return!0};Gr.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(e){for(var n,i,s,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,d=this.internal.getPageInfoByObjId(e.objId),f=e.pageContext.annotations,_=!1,w=0;w<f.length&&!_;w++)switch((n=f[w]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(_=!0);break;case"reference":case"text":case"freetext":_=!0}if(_!=0){this.internal.write("/Annots [");for(var x=0;x<f.length;x++){n=f[x];var B=this.internal.pdfEscape,P=this.internal.getEncryptor(e.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var R=this.internal.newAdditionalObject(),N=this.internal.newAdditionalObject(),Q=this.internal.getEncryptor(R.objId),V=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+B(Q(n.contents))+")",s+=" /Popup "+N.objId+" 0 R",s+=" /P "+d.objId+" 0 R",s+=" /T ("+B(Q(V))+") >>",R.content=s;var W=R.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+a(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+W,n.open&&(s+=" /Open true"),s+=" >>",N.content=s,this.internal.write(R.objId,"0 R",N.objId,"0 R");break;case"freetext":i="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var et=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+B(P(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+et+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var ct=this.annotations._nameMap[n.options.name];n.options.pageNumber=ct.page,n.options.top=ct.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+B(P(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var dt=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+dt+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),r.createAnnotation=function(e){var n=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":n.pageContext.annotations.push(e)}},r.link=function(e,n,i,s,a){var o=this.internal.getCurrentPageInfo(),d=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:d(e),y:f(n),w:d(e+i),h:f(n+s)},options:a,type:"link"})},r.textWithLink=function(e,n,i,s){var a,o,d=this.getTextWidth(e),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){o=s.maxWidth;var _=this.splitTextToSize(e,o).length;a=Math.ceil(f*_)}else o=d,a=f;return this.text(e,n,i,s),i+=.2*f,s.align==="center"&&(n-=d/2),s.align==="right"&&(n-=d),this.link(n,i-f,o,a,s),d},r.getTextWidth=function(e){var n=this.internal.getFontSize();return this.getStringUnitWidth(e)*n/this.internal.scaleFactor}}(Gr.API),function(r){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},e={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];r.__arabicParser__={};var s=r.__arabicParser__.isInArabicSubstitutionA=function(R){return t[R.charCodeAt(0)]!==void 0},a=r.__arabicParser__.isArabicLetter=function(R){return typeof R=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(R)},o=r.__arabicParser__.isArabicEndLetter=function(R){return a(R)&&s(R)&&t[R.charCodeAt(0)].length<=2},d=r.__arabicParser__.isArabicAlfLetter=function(R){return a(R)&&i.indexOf(R.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(R){return a(R)&&s(R)&&t[R.charCodeAt(0)].length>=1};var f=r.__arabicParser__.arabicLetterHasFinalForm=function(R){return a(R)&&s(R)&&t[R.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(R){return a(R)&&s(R)&&t[R.charCodeAt(0)].length>=3};var _=r.__arabicParser__.arabicLetterHasMedialForm=function(R){return a(R)&&s(R)&&t[R.charCodeAt(0)].length==4},w=r.__arabicParser__.resolveLigatures=function(R){var N=0,Q=e,V="",W=0;for(N=0;N<R.length;N+=1)Q[R.charCodeAt(N)]!==void 0?(W++,typeof(Q=Q[R.charCodeAt(N)])=="number"&&(V+=String.fromCharCode(Q),Q=e,W=0),N===R.length-1&&(Q=e,V+=R.charAt(N-(W-1)),N-=W-1,W=0)):(Q=e,V+=R.charAt(N-W),N-=W,W=0);return V};r.__arabicParser__.isArabicDiacritic=function(R){return R!==void 0&&n[R.charCodeAt(0)]!==void 0};var x=r.__arabicParser__.getCorrectForm=function(R,N,Q){return a(R)?s(R)===!1?-1:!f(R)||!a(N)&&!a(Q)||!a(Q)&&o(N)||o(R)&&!a(N)||o(R)&&d(N)||o(R)&&o(N)?0:_(R)&&a(N)&&!o(N)&&a(Q)&&f(Q)?3:o(R)||!a(Q)?1:2:-1},B=function(R){var N=0,Q=0,V=0,W="",et="",ct="",dt=(R=R||"").split("\\s+"),gt=[];for(N=0;N<dt.length;N+=1){for(gt.push(""),Q=0;Q<dt[N].length;Q+=1)W=dt[N][Q],et=dt[N][Q-1],ct=dt[N][Q+1],a(W)?(V=x(W,et,ct),gt[N]+=V!==-1?String.fromCharCode(t[W.charCodeAt(0)][V]):W):gt[N]+=W;gt[N]=w(gt[N])}return gt.join(" ")},P=r.__arabicParser__.processArabic=r.processArabic=function(){var R,N=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,Q=[];if(Array.isArray(N)){var V=0;for(Q=[],V=0;V<N.length;V+=1)Array.isArray(N[V])?Q.push([B(N[V][0]),N[V][1],N[V][2]]):Q.push([B(N[V])]);R=Q}else R=B(N);return typeof arguments[0]=="string"?R:(arguments[0].text=R,arguments[0])};r.events.push(["preProcessText",P])}(Gr.API),Gr.API.autoPrint=function(r){var t;switch((r=r||{}).variant=r.variant||"non-conform",r.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(r){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(o){e=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(o){s=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,n){var i;if((e=e||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Gr.API),function(r){var t={left:0,top:0,bottom:0,right:0},e=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var d=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return d},set:function(R){d=R}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function(R){f=R}});var _=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return _},set:function(R){_=R}});var w=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return w},set:function(R){w=R}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(R){x=R}});var B=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return B},set:function(R){B=R}});var P=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return P},set:function(R){P=R}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(d){return n.call(this),this.internal.__cell__.headerFunction=typeof d=="function"?d:void 0,this},r.getTextDimensions=function(d,f){n.call(this);var _=(f=f||{}).fontSize||this.getFontSize(),w=f.font||this.getFont(),x=f.scaleFactor||this.internal.scaleFactor,B=0,P=0,R=0,N=this;if(!Array.isArray(d)&&typeof d!="string"){if(typeof d!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");d=String(d)}var Q=f.maxWidth;Q>0?typeof d=="string"?d=this.splitTextToSize(d,Q):Object.prototype.toString.call(d)==="[object Array]"&&(d=d.reduce(function(W,et){return W.concat(N.splitTextToSize(et,Q))},[])):d=Array.isArray(d)?d:[d];for(var V=0;V<d.length;V++)B<(R=this.getStringUnitWidth(d[V],{font:w})*_)&&(B=R);return B!==0&&(P=d.length),{w:B/=x,h:Math.max((P*_*this.getLineHeightFactor()-_*(this.getLineHeightFactor()-1))/x,0)}},r.cellAddPage=function(){n.call(this),this.addPage();var d=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(d.left,d.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=r.cell=function(){var d;d=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var f=this.internal.__cell__.lastCell,_=this.internal.__cell__.padding,w=this.internal.__cell__.margins||t,x=this.internal.__cell__.tableHeaderRow,B=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===d.lineNumber?(d.x=(f.x||0)+(f.width||0),d.y=f.y||0):f.y+f.height+d.height+w.bottom>this.getPageHeight()?(this.cellAddPage(),d.y=w.top,B&&x&&(this.printHeaderRow(d.lineNumber,!0),d.y+=x[0].height)):d.y=f.y+f.height||d.y),d.text[0]!==void 0&&(this.rect(d.x,d.y,d.width,d.height,e===!0?"FD":void 0),d.align==="right"?this.text(d.text,d.x+d.width-_,d.y+_,{align:"right",baseline:"top"}):d.align==="center"?this.text(d.text,d.x+d.width/2,d.y+_,{align:"center",baseline:"top",maxWidth:d.width-_-_}):this.text(d.text,d.x+_,d.y+_,{align:"left",baseline:"top",maxWidth:d.width-_-_})),this.internal.__cell__.lastCell=d,this};r.table=function(d,f,_,w,x){if(n.call(this),!_)throw new Error("No data for PDF table.");var B,P,R,N,Q=[],V=[],W=[],et={},ct={},dt=[],gt=[],ht=(x=x||{}).autoSize||!1,It=x.printHeaders!==!1,St=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,ot=x.margins||Object.assign({width:this.getPageWidth()},t),at=typeof x.padding=="number"?x.padding:3,bt=x.headerBackgroundColor||"#c8c8c8",vt=x.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=It,this.internal.__cell__.margins=ot,this.internal.__cell__.table_font_size=St,this.internal.__cell__.padding=at,this.internal.__cell__.headerBackgroundColor=bt,this.internal.__cell__.headerTextColor=vt,this.setFontSize(St),w==null)V=Q=Object.keys(_[0]),W=Q.map(function(){return"left"});else if(Array.isArray(w)&&Un(w[0])==="object")for(Q=w.map(function(Yt){return Yt.name}),V=w.map(function(Yt){return Yt.prompt||Yt.name||""}),W=w.map(function(Yt){return Yt.align||"left"}),B=0;B<w.length;B+=1)ct[w[B].name]=w[B].width*(19.049976/25.4);else Array.isArray(w)&&typeof w[0]=="string"&&(V=Q=w,W=Q.map(function(){return"left"}));if(ht||Array.isArray(w)&&typeof w[0]=="string")for(B=0;B<Q.length;B+=1){for(et[N=Q[B]]=_.map(function(Yt){return Yt[N]}),this.setFont(void 0,"bold"),dt.push(this.getTextDimensions(V[B],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),P=et[N],this.setFont(void 0,"normal"),R=0;R<P.length;R+=1)dt.push(this.getTextDimensions(P[R],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);ct[N]=Math.max.apply(null,dt)+at+at,dt=[]}if(It){var $t={};for(B=0;B<Q.length;B+=1)$t[Q[B]]={},$t[Q[B]].text=V[B],$t[Q[B]].align=W[B];var Wt=o.call(this,$t,ct);gt=Q.map(function(Yt){return new s(d,f,ct[Yt],Wt,$t[Yt].text,void 0,$t[Yt].align)}),this.setTableHeaderRow(gt),this.printHeaderRow(1,!1)}var Jt=w.reduce(function(Yt,be){return Yt[be.name]=be.align,Yt},{});for(B=0;B<_.length;B+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:B,data:_[B]},this);var qt=o.call(this,_[B],ct);for(R=0;R<Q.length;R+=1){var te=_[B][Q[R]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:B,col:R,data:te},this),a.call(this,new s(d,f,ct[Q[R]],qt,te,B+2,Jt[Q[R]]))}}return this.internal.__cell__.table_x=d,this.internal.__cell__.table_y=f,this};var o=function(d,f){var _=this.internal.__cell__.padding,w=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(d).map(function(B){var P=d[B];return this.splitTextToSize(P.hasOwnProperty("text")?P.text:P,f[B]-_-_)},this).map(function(B){return this.getLineHeightFactor()*B.length*w/x+_+_},this).reduce(function(B,P){return Math.max(B,P)},0)};r.setTableHeaderRow=function(d){n.call(this),this.internal.__cell__.tableHeaderRow=d},r.printHeaderRow=function(d,f){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var _;if(e=!0,typeof this.internal.__cell__.headerFunction=="function"){var w=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(w[0],w[1],w[2],w[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],B=0;B<this.internal.__cell__.tableHeaderRow.length;B+=1){_=this.internal.__cell__.tableHeaderRow[B].clone(),f&&(_.y=this.internal.__cell__.margins.top||0,x.push(_)),_.lineNumber=d;var P=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,_),this.setTextColor(P)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),e=!1}}(Gr.API);var gP={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},mP=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],J2=pP(mP),yP=[100,200,300,400,500,600,700,800,900],qrt=pP(yP);function Y2(r){var t=r.family.replace(/"|'/g,"").toLowerCase(),e=function(s){return gP[s=s||"normal"]?s:"normal"}(r.style),n=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(r.weight),i=function(s){return typeof J2[s=s||"normal"]=="number"?s:"normal"}(r.stretch);return{family:t,style:e,weight:n,stretch:i,src:r.src||[],ref:r.ref||{name:t,style:[i,e,n].join(" ")}}}function _P(r,t,e,n){var i;for(i=e;i>=0&&i<t.length;i+=n)if(r[t[i]])return r[t[i]];for(i=e;i>=0&&i<t.length;i-=n)if(r[t[i]])return r[t[i]]}var Krt={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},vP={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function bP(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function $rt(r,t,e){for(var n=(e=e||{}).defaultFontFamily||"times",i=Object.assign({},Krt,e.genericFontFamilies||{}),s=null,a=null,o=0;o<t.length;++o)if(i[(s=Y2(t[o])).family]&&(s.family=i[s.family]),r.hasOwnProperty(s.family)){a=r[s.family];break}if(!(a=a||r[n]))throw new Error("Could not find a font-family for the rule '"+bP(s)+"' and default family '"+n+"'.");if(a=function(d,f){if(f[d])return f[d];var _=J2[d],w=_<=J2.normal?-1:1,x=_P(f,mP,_,w);if(!x)throw new Error("Could not find a matching font-stretch value for "+d);return x}(s.stretch,a),a=function(d,f){if(f[d])return f[d];for(var _=gP[d],w=0;w<_.length;++w)if(f[_[w]])return f[_[w]];throw new Error("Could not find a matching font-style for "+d)}(s.style,a),!(a=function(d,f){if(f[d])return f[d];if(d===400&&f[500])return f[500];if(d===500&&f[400])return f[400];var _=qrt[d],w=_P(f,yP,_,d<400?-1:1);if(!w)throw new Error("Could not find a matching font-weight for value "+d);return w}(s.weight,a)))throw new Error("Failed to resolve a font for the rule '"+bP(s)+"'.");return a}function wP(r){return r.trimLeft()}function Wrt(r,t){for(var e=0;e<r.length;){if(r.charAt(e)===t)return[r.substring(0,e),r.substring(e+1)];e+=1}return null}function Xrt(r){var t=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],r.substring(t[0].length)]}var qy,xP,BP,CP=["times"];(function(r){var t,e,n,i,s,a,o,d,f,_=function(it){return it=it||{},this.isStrokeTransparent=it.isStrokeTransparent||!1,this.strokeOpacity=it.strokeOpacity||1,this.strokeStyle=it.strokeStyle||"#000000",this.fillStyle=it.fillStyle||"#000000",this.isFillTransparent=it.isFillTransparent||!1,this.fillOpacity=it.fillOpacity||1,this.font=it.font||"10px sans-serif",this.textBaseline=it.textBaseline||"alphabetic",this.textAlign=it.textAlign||"left",this.lineWidth=it.lineWidth||1,this.lineJoin=it.lineJoin||"miter",this.lineCap=it.lineCap||"butt",this.path=it.path||[],this.transform=it.transform!==void 0?it.transform.clone():new d,this.globalCompositeOperation=it.globalCompositeOperation||"normal",this.globalAlpha=it.globalAlpha||1,this.clip_path=it.clip_path||[],this.currentPoint=it.currentPoint||new a,this.miterLimit=it.miterLimit||10,this.lastPoint=it.lastPoint||new a,this.lineDashOffset=it.lineDashOffset||0,this.lineDash=it.lineDash||[],this.margin=it.margin||[0,0,0,0],this.prevPageLastElemOffset=it.prevPageLastElemOffset||0,this.ignoreClearRect=typeof it.ignoreClearRect!="boolean"||it.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new w(this),t=this.internal.f2,e=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,d=this.internal.Matrix,f=new _}]);var w=function(it){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var wt=it;Object.defineProperty(this,"pdf",{get:function(){return wt}});var Ft=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Ft},set:function(le){Ft=!!le}});var Ut=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Ut},set:function(le){Ut=!!le}});var jt=0;Object.defineProperty(this,"posX",{get:function(){return jt},set:function(le){isNaN(le)||(jt=le)}});var Vt=0;Object.defineProperty(this,"posY",{get:function(){return Vt},set:function(le){isNaN(le)||(Vt=le)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(le){var st;typeof le=="number"?st=[le,le,le,le]:((st=new Array(4))[0]=le[0],st[1]=le.length>=2?le[1]:st[0],st[2]=le.length>=3?le[2]:st[0],st[3]=le.length>=4?le[3]:st[1]),f.margin=st}});var re=!1;Object.defineProperty(this,"autoPaging",{get:function(){return re},set:function(le){re=le}});var Zt=0;Object.defineProperty(this,"lastBreak",{get:function(){return Zt},set:function(le){Zt=le}});var Be=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Be},set:function(le){Be=le}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(le){le instanceof _&&(f=le)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(le){f.path=le}});var Ie=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ie},set:function(le){Ie=le}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(le){var st;st=x(le),this.ctx.fillStyle=st.style,this.ctx.isFillTransparent=st.a===0,this.ctx.fillOpacity=st.a,this.pdf.setFillColor(st.r,st.g,st.b,{a:st.a}),this.pdf.setTextColor(st.r,st.g,st.b,{a:st.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(le){var st=x(le);this.ctx.strokeStyle=st.style,this.ctx.isStrokeTransparent=st.a===0,this.ctx.strokeOpacity=st.a,st.a===0?this.pdf.setDrawColor(255,255,255):(st.a,this.pdf.setDrawColor(st.r,st.g,st.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(le){["butt","round","square"].indexOf(le)!==-1&&(this.ctx.lineCap=le,this.pdf.setLineCap(le))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(le){isNaN(le)||(this.ctx.lineWidth=le,this.pdf.setLineWidth(le))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(le){["bevel","round","miter"].indexOf(le)!==-1&&(this.ctx.lineJoin=le,this.pdf.setLineJoin(le))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(le){isNaN(le)||(this.ctx.miterLimit=le,this.pdf.setMiterLimit(le))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(le){this.ctx.textBaseline=le}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(le){["right","end","center","left","start"].indexOf(le)!==-1&&(this.ctx.textAlign=le)}});var ke=null;function He(le,st){if(ke===null){var pr=function(Ye){var ue=[];return Object.keys(Ye).forEach(function(ye){Ye[ye].forEach(function(Le){var Oe=null;switch(Le){case"bold":Oe={family:ye,weight:"bold"};break;case"italic":Oe={family:ye,style:"italic"};break;case"bolditalic":Oe={family:ye,weight:"bold",style:"italic"};break;case"":case"normal":Oe={family:ye}}Oe!==null&&(Oe.ref={name:ye,style:Le},ue.push(Oe))})}),ue}(le.getFontList());ke=function(Ye){for(var ue={},ye=0;ye<Ye.length;++ye){var Le=Y2(Ye[ye]),Oe=Le.family,We=Le.stretch,cr=Le.style,yr=Le.weight;ue[Oe]=ue[Oe]||{},ue[Oe][We]=ue[Oe][We]||{},ue[Oe][We][cr]=ue[Oe][We][cr]||{},ue[Oe][We][cr][yr]=Le}return ue}(pr.concat(st))}return ke}var Ke=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ke},set:function(le){ke=null,Ke=le}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(le){var st;if(this.ctx.font=le,(st=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(le))!==null){var pr=st[1],Ye=(st[2],st[3]),ue=st[4],ye=(st[5],st[6]),Le=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ue)[2];ue=Math.floor(Le==="px"?parseFloat(ue)*this.pdf.internal.scaleFactor:Le==="em"?parseFloat(ue)*this.pdf.getFontSize():parseFloat(ue)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ue);var Oe=function(ur){var _r,De,gn=[],pe=ur.trim();if(pe==="")return CP;if(pe in vP)return[vP[pe]];for(;pe!=="";){switch(De=null,_r=(pe=wP(pe)).charAt(0)){case'"':case"'":De=Wrt(pe.substring(1),_r);break;default:De=Xrt(pe)}if(De===null||(gn.push(De[0]),(pe=wP(De[1]))!==""&&pe.charAt(0)!==","))return CP;pe=pe.replace(/^,/,"")}return gn}(ye);if(this.fontFaces){var We=$rt(He(this.pdf,this.fontFaces),Oe.map(function(ur){return{family:ur,stretch:"normal",weight:Ye,style:pr}}));this.pdf.setFont(We.ref.name,We.ref.style)}else{var cr="";(Ye==="bold"||parseInt(Ye,10)>=700||pr==="bold")&&(cr="bold"),pr==="italic"&&(cr+="italic"),cr.length===0&&(cr="normal");for(var yr="",Fr={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ur=0;Ur<Oe.length;Ur++){if(this.pdf.internal.getFont(Oe[Ur],cr,{noFallback:!0,disableWarning:!0})!==void 0){yr=Oe[Ur];break}if(cr==="bolditalic"&&this.pdf.internal.getFont(Oe[Ur],"bold",{noFallback:!0,disableWarning:!0})!==void 0)yr=Oe[Ur],cr="bold";else if(this.pdf.internal.getFont(Oe[Ur],"normal",{noFallback:!0,disableWarning:!0})!==void 0){yr=Oe[Ur],cr="normal";break}}if(yr===""){for(var de=0;de<Oe.length;de++)if(Fr[Oe[de]]){yr=Fr[Oe[de]];break}}yr=yr===""?"Times":yr,this.pdf.setFont(yr,cr)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(le){this.ctx.globalCompositeOperation=le}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(le){this.ctx.globalAlpha=le}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(le){this.ctx.lineDashOffset=le,be.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(le){this.ctx.lineDash=le,be.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(le){this.ctx.ignoreClearRect=!!le}})};w.prototype.setLineDash=function(it){this.lineDash=it},w.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},w.prototype.fill=function(){et.call(this,"fill",!1)},w.prototype.stroke=function(){et.call(this,"stroke",!1)},w.prototype.beginPath=function(){this.path=[{type:"begin"}]},w.prototype.moveTo=function(it,wt){if(isNaN(it)||isNaN(wt))throw ui.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Ft=this.ctx.transform.applyToPoint(new a(it,wt));this.path.push({type:"mt",x:Ft.x,y:Ft.y}),this.ctx.lastPoint=new a(it,wt)},w.prototype.closePath=function(){var it=new a(0,0),wt=0;for(wt=this.path.length-1;wt!==-1;wt--)if(this.path[wt].type==="begin"&&Un(this.path[wt+1])==="object"&&typeof this.path[wt+1].x=="number"){it=new a(this.path[wt+1].x,this.path[wt+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(it.x,it.y)},w.prototype.lineTo=function(it,wt){if(isNaN(it)||isNaN(wt))throw ui.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Ft=this.ctx.transform.applyToPoint(new a(it,wt));this.path.push({type:"lt",x:Ft.x,y:Ft.y}),this.ctx.lastPoint=new a(Ft.x,Ft.y)},w.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),et.call(this,null,!0)},w.prototype.quadraticCurveTo=function(it,wt,Ft,Ut){if(isNaN(Ft)||isNaN(Ut)||isNaN(it)||isNaN(wt))throw ui.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var jt=this.ctx.transform.applyToPoint(new a(Ft,Ut)),Vt=this.ctx.transform.applyToPoint(new a(it,wt));this.path.push({type:"qct",x1:Vt.x,y1:Vt.y,x:jt.x,y:jt.y}),this.ctx.lastPoint=new a(jt.x,jt.y)},w.prototype.bezierCurveTo=function(it,wt,Ft,Ut,jt,Vt){if(isNaN(jt)||isNaN(Vt)||isNaN(it)||isNaN(wt)||isNaN(Ft)||isNaN(Ut))throw ui.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var re=this.ctx.transform.applyToPoint(new a(jt,Vt)),Zt=this.ctx.transform.applyToPoint(new a(it,wt)),Be=this.ctx.transform.applyToPoint(new a(Ft,Ut));this.path.push({type:"bct",x1:Zt.x,y1:Zt.y,x2:Be.x,y2:Be.y,x:re.x,y:re.y}),this.ctx.lastPoint=new a(re.x,re.y)},w.prototype.arc=function(it,wt,Ft,Ut,jt,Vt){if(isNaN(it)||isNaN(wt)||isNaN(Ft)||isNaN(Ut)||isNaN(jt))throw ui.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Vt=!!Vt,!this.ctx.transform.isIdentity){var re=this.ctx.transform.applyToPoint(new a(it,wt));it=re.x,wt=re.y;var Zt=this.ctx.transform.applyToPoint(new a(0,Ft)),Be=this.ctx.transform.applyToPoint(new a(0,0));Ft=Math.sqrt(Math.pow(Zt.x-Be.x,2)+Math.pow(Zt.y-Be.y,2))}Math.abs(jt-Ut)>=2*Math.PI&&(Ut=0,jt=2*Math.PI),this.path.push({type:"arc",x:it,y:wt,radius:Ft,startAngle:Ut,endAngle:jt,counterclockwise:Vt})},w.prototype.arcTo=function(it,wt,Ft,Ut,jt){throw new Error("arcTo not implemented.")},w.prototype.rect=function(it,wt,Ft,Ut){if(isNaN(it)||isNaN(wt)||isNaN(Ft)||isNaN(Ut))throw ui.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(it,wt),this.lineTo(it+Ft,wt),this.lineTo(it+Ft,wt+Ut),this.lineTo(it,wt+Ut),this.lineTo(it,wt),this.lineTo(it+Ft,wt),this.lineTo(it,wt)},w.prototype.fillRect=function(it,wt,Ft,Ut){if(isNaN(it)||isNaN(wt)||isNaN(Ft)||isNaN(Ut))throw ui.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!B.call(this)){var jt={};this.lineCap!=="butt"&&(jt.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(jt.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(it,wt,Ft,Ut),this.fill(),jt.hasOwnProperty("lineCap")&&(this.lineCap=jt.lineCap),jt.hasOwnProperty("lineJoin")&&(this.lineJoin=jt.lineJoin)}},w.prototype.strokeRect=function(it,wt,Ft,Ut){if(isNaN(it)||isNaN(wt)||isNaN(Ft)||isNaN(Ut))throw ui.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");P.call(this)||(this.beginPath(),this.rect(it,wt,Ft,Ut),this.stroke())},w.prototype.clearRect=function(it,wt,Ft,Ut){if(isNaN(it)||isNaN(wt)||isNaN(Ft)||isNaN(Ut))throw ui.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(it,wt,Ft,Ut))},w.prototype.save=function(it){it=typeof it!="boolean"||it;for(var wt=this.pdf.internal.getCurrentPageInfo().pageNumber,Ft=0;Ft<this.pdf.internal.getNumberOfPages();Ft++)this.pdf.setPage(Ft+1),this.pdf.internal.out("q");if(this.pdf.setPage(wt),it){this.ctx.fontSize=this.pdf.internal.getFontSize();var Ut=new _(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Ut}},w.prototype.restore=function(it){it=typeof it!="boolean"||it;for(var wt=this.pdf.internal.getCurrentPageInfo().pageNumber,Ft=0;Ft<this.pdf.internal.getNumberOfPages();Ft++)this.pdf.setPage(Ft+1),this.pdf.internal.out("Q");this.pdf.setPage(wt),it&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},w.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(it){var wt,Ft,Ut,jt;if(it.isCanvasGradient===!0&&(it=it.getColor()),!it)return{r:0,g:0,b:0,a:0,style:it};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(it))wt=0,Ft=0,Ut=0,jt=0;else{var Vt=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(it);if(Vt!==null)wt=parseInt(Vt[1]),Ft=parseInt(Vt[2]),Ut=parseInt(Vt[3]),jt=1;else if((Vt=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(it))!==null)wt=parseInt(Vt[1]),Ft=parseInt(Vt[2]),Ut=parseInt(Vt[3]),jt=parseFloat(Vt[4]);else{if(jt=1,typeof it=="string"&&it.charAt(0)!=="#"){var re=new sP(it);it=re.ok?re.toHex():"#000000"}it.length===4?(wt=it.substring(1,2),wt+=wt,Ft=it.substring(2,3),Ft+=Ft,Ut=it.substring(3,4),Ut+=Ut):(wt=it.substring(1,3),Ft=it.substring(3,5),Ut=it.substring(5,7)),wt=parseInt(wt,16),Ft=parseInt(Ft,16),Ut=parseInt(Ut,16)}}return{r:wt,g:Ft,b:Ut,a:jt,style:it}},B=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},P=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};w.prototype.fillText=function(it,wt,Ft,Ut){if(isNaN(wt)||isNaN(Ft)||typeof it!="string")throw ui.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Ut=isNaN(Ut)?void 0:Ut,!B.call(this)){var jt=qt(this.ctx.transform.rotation),Vt=this.ctx.transform.scaleX;at.call(this,{text:it,x:wt,y:Ft,scale:Vt,angle:jt,align:this.textAlign,maxWidth:Ut})}},w.prototype.strokeText=function(it,wt,Ft,Ut){if(isNaN(wt)||isNaN(Ft)||typeof it!="string")throw ui.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!P.call(this)){Ut=isNaN(Ut)?void 0:Ut;var jt=qt(this.ctx.transform.rotation),Vt=this.ctx.transform.scaleX;at.call(this,{text:it,x:wt,y:Ft,scale:Vt,renderingMode:"stroke",angle:jt,align:this.textAlign,maxWidth:Ut})}},w.prototype.measureText=function(it){if(typeof it!="string")throw ui.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var wt=this.pdf,Ft=this.pdf.internal.scaleFactor,Ut=wt.internal.getFontSize(),jt=wt.getStringUnitWidth(it)*Ut/wt.internal.scaleFactor,Vt=function(re){var Zt=(re=re||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Zt}}),this};return new Vt({width:jt*=Math.round(96*Ft/72*1e4)/1e4})},w.prototype.scale=function(it,wt){if(isNaN(it)||isNaN(wt))throw ui.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Ft=new d(it,0,0,wt,0,0);this.ctx.transform=this.ctx.transform.multiply(Ft)},w.prototype.rotate=function(it){if(isNaN(it))throw ui.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var wt=new d(Math.cos(it),Math.sin(it),-Math.sin(it),Math.cos(it),0,0);this.ctx.transform=this.ctx.transform.multiply(wt)},w.prototype.translate=function(it,wt){if(isNaN(it)||isNaN(wt))throw ui.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Ft=new d(1,0,0,1,it,wt);this.ctx.transform=this.ctx.transform.multiply(Ft)},w.prototype.transform=function(it,wt,Ft,Ut,jt,Vt){if(isNaN(it)||isNaN(wt)||isNaN(Ft)||isNaN(Ut)||isNaN(jt)||isNaN(Vt))throw ui.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var re=new d(it,wt,Ft,Ut,jt,Vt);this.ctx.transform=this.ctx.transform.multiply(re)},w.prototype.setTransform=function(it,wt,Ft,Ut,jt,Vt){it=isNaN(it)?1:it,wt=isNaN(wt)?0:wt,Ft=isNaN(Ft)?0:Ft,Ut=isNaN(Ut)?1:Ut,jt=isNaN(jt)?0:jt,Vt=isNaN(Vt)?0:Vt,this.ctx.transform=new d(it,wt,Ft,Ut,jt,Vt)};var R=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};w.prototype.drawImage=function(it,wt,Ft,Ut,jt,Vt,re,Zt,Be){var Ie=this.pdf.getImageProperties(it),ke=1,He=1,Ke=1,le=1;Ut!==void 0&&Zt!==void 0&&(Ke=Zt/Ut,le=Be/jt,ke=Ie.width/Ut*Zt/Ut,He=Ie.height/jt*Be/jt),Vt===void 0&&(Vt=wt,re=Ft,wt=0,Ft=0),Ut!==void 0&&Zt===void 0&&(Zt=Ut,Be=jt),Ut===void 0&&Zt===void 0&&(Zt=Ie.width,Be=Ie.height);for(var st,pr=this.ctx.transform.decompose(),Ye=qt(pr.rotate.shx),ue=new d,ye=(ue=(ue=(ue=ue.multiply(pr.translate)).multiply(pr.skew)).multiply(pr.scale)).applyToRectangle(new o(Vt-wt*Ke,re-Ft*le,Ut*ke,jt*He)),Le=N.call(this,ye),Oe=[],We=0;We<Le.length;We+=1)Oe.indexOf(Le[We])===-1&&Oe.push(Le[We]);if(W(Oe),this.autoPaging)for(var cr=Oe[0],yr=Oe[Oe.length-1],Fr=cr;Fr<yr+1;Fr++){this.pdf.setPage(Fr);var Ur=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],de=Fr===1?this.posY+this.margin[0]:this.margin[0],ur=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_r=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],De=Fr===1?0:ur+(Fr-2)*_r;if(this.ctx.clip_path.length!==0){var gn=this.path;st=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=V(st,this.posX+this.margin[3],-De+de+this.ctx.prevPageLastElemOffset),ct.call(this,"fill",!0),this.path=gn}var pe=JSON.parse(JSON.stringify(ye));pe=V([pe],this.posX+this.margin[3],-De+de+this.ctx.prevPageLastElemOffset)[0];var gr=(Fr>cr||Fr<yr)&&R.call(this);gr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ur,_r,null).clip().discardPath()),this.pdf.addImage(it,"JPEG",pe.x,pe.y,pe.w,pe.h,null,null,Ye),gr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(it,"JPEG",ye.x,ye.y,ye.w,ye.h,null,null,Ye)};var N=function(it,wt,Ft){var Ut=[];wt=wt||this.pdf.internal.pageSize.width,Ft=Ft||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var jt=this.posY+this.ctx.prevPageLastElemOffset;switch(it.type){default:case"mt":case"lt":Ut.push(Math.floor((it.y+jt)/Ft)+1);break;case"arc":Ut.push(Math.floor((it.y+jt-it.radius)/Ft)+1),Ut.push(Math.floor((it.y+jt+it.radius)/Ft)+1);break;case"qct":var Vt=te(this.ctx.lastPoint.x,this.ctx.lastPoint.y,it.x1,it.y1,it.x,it.y);Ut.push(Math.floor((Vt.y+jt)/Ft)+1),Ut.push(Math.floor((Vt.y+Vt.h+jt)/Ft)+1);break;case"bct":var re=Yt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,it.x1,it.y1,it.x2,it.y2,it.x,it.y);Ut.push(Math.floor((re.y+jt)/Ft)+1),Ut.push(Math.floor((re.y+re.h+jt)/Ft)+1);break;case"rect":Ut.push(Math.floor((it.y+jt)/Ft)+1),Ut.push(Math.floor((it.y+it.h+jt)/Ft)+1)}for(var Zt=0;Zt<Ut.length;Zt+=1)for(;this.pdf.internal.getNumberOfPages()<Ut[Zt];)Q.call(this);return Ut},Q=function(){var it=this.fillStyle,wt=this.strokeStyle,Ft=this.font,Ut=this.lineCap,jt=this.lineWidth,Vt=this.lineJoin;this.pdf.addPage(),this.fillStyle=it,this.strokeStyle=wt,this.font=Ft,this.lineCap=Ut,this.lineWidth=jt,this.lineJoin=Vt},V=function(it,wt,Ft){for(var Ut=0;Ut<it.length;Ut++)switch(it[Ut].type){case"bct":it[Ut].x2+=wt,it[Ut].y2+=Ft;case"qct":it[Ut].x1+=wt,it[Ut].y1+=Ft;case"mt":case"lt":case"arc":default:it[Ut].x+=wt,it[Ut].y+=Ft}return it},W=function(it){return it.sort(function(wt,Ft){return wt-Ft})},et=function(it,wt){for(var Ft,Ut,jt=this.fillStyle,Vt=this.strokeStyle,re=this.lineCap,Zt=this.lineWidth,Be=Math.abs(Zt*this.ctx.transform.scaleX),Ie=this.lineJoin,ke=JSON.parse(JSON.stringify(this.path)),He=JSON.parse(JSON.stringify(this.path)),Ke=[],le=0;le<He.length;le++)if(He[le].x!==void 0)for(var st=N.call(this,He[le]),pr=0;pr<st.length;pr+=1)Ke.indexOf(st[pr])===-1&&Ke.push(st[pr]);for(var Ye=0;Ye<Ke.length;Ye++)for(;this.pdf.internal.getNumberOfPages()<Ke[Ye];)Q.call(this);if(W(Ke),this.autoPaging)for(var ue=Ke[0],ye=Ke[Ke.length-1],Le=ue;Le<ye+1;Le++){this.pdf.setPage(Le),this.fillStyle=jt,this.strokeStyle=Vt,this.lineCap=re,this.lineWidth=Be,this.lineJoin=Ie;var Oe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],We=Le===1?this.posY+this.margin[0]:this.margin[0],cr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],yr=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Fr=Le===1?0:cr+(Le-2)*yr;if(this.ctx.clip_path.length!==0){var Ur=this.path;Ft=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=V(Ft,this.posX+this.margin[3],-Fr+We+this.ctx.prevPageLastElemOffset),ct.call(this,it,!0),this.path=Ur}if(Ut=JSON.parse(JSON.stringify(ke)),this.path=V(Ut,this.posX+this.margin[3],-Fr+We+this.ctx.prevPageLastElemOffset),wt===!1||Le===0){var de=(Le>ue||Le<ye)&&R.call(this);de&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Oe,yr,null).clip().discardPath()),ct.call(this,it,wt),de&&this.pdf.restoreGraphicsState()}this.lineWidth=Zt}else this.lineWidth=Be,ct.call(this,it,wt),this.lineWidth=Zt;this.path=ke},ct=function(it,wt){if((it!=="stroke"||wt||!P.call(this))&&(it==="stroke"||wt||!B.call(this))){for(var Ft,Ut,jt=[],Vt=this.path,re=0;re<Vt.length;re++){var Zt=Vt[re];switch(Zt.type){case"begin":jt.push({begin:!0});break;case"close":jt.push({close:!0});break;case"mt":jt.push({start:Zt,deltas:[],abs:[]});break;case"lt":var Be=jt.length;if(Vt[re-1]&&!isNaN(Vt[re-1].x)&&(Ft=[Zt.x-Vt[re-1].x,Zt.y-Vt[re-1].y],Be>0)){for(;Be>=0;Be--)if(jt[Be-1].close!==!0&&jt[Be-1].begin!==!0){jt[Be-1].deltas.push(Ft),jt[Be-1].abs.push(Zt);break}}break;case"bct":Ft=[Zt.x1-Vt[re-1].x,Zt.y1-Vt[re-1].y,Zt.x2-Vt[re-1].x,Zt.y2-Vt[re-1].y,Zt.x-Vt[re-1].x,Zt.y-Vt[re-1].y],jt[jt.length-1].deltas.push(Ft);break;case"qct":var Ie=Vt[re-1].x+2/3*(Zt.x1-Vt[re-1].x),ke=Vt[re-1].y+2/3*(Zt.y1-Vt[re-1].y),He=Zt.x+2/3*(Zt.x1-Zt.x),Ke=Zt.y+2/3*(Zt.y1-Zt.y),le=Zt.x,st=Zt.y;Ft=[Ie-Vt[re-1].x,ke-Vt[re-1].y,He-Vt[re-1].x,Ke-Vt[re-1].y,le-Vt[re-1].x,st-Vt[re-1].y],jt[jt.length-1].deltas.push(Ft);break;case"arc":jt.push({deltas:[],abs:[],arc:!0}),Array.isArray(jt[jt.length-1].abs)&&jt[jt.length-1].abs.push(Zt)}}Ut=wt?null:it==="stroke"?"stroke":"fill";for(var pr=!1,Ye=0;Ye<jt.length;Ye++)if(jt[Ye].arc)for(var ue=jt[Ye].abs,ye=0;ye<ue.length;ye++){var Le=ue[ye];Le.type==="arc"?ht.call(this,Le.x,Le.y,Le.radius,Le.startAngle,Le.endAngle,Le.counterclockwise,void 0,wt,!pr):bt.call(this,Le.x,Le.y),pr=!0}else if(jt[Ye].close===!0)this.pdf.internal.out("h"),pr=!1;else if(jt[Ye].begin!==!0){var Oe=jt[Ye].start.x,We=jt[Ye].start.y;vt.call(this,jt[Ye].deltas,Oe,We),pr=!0}Ut&&It.call(this,Ut),wt&&St.call(this)}},dt=function(it){var wt=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Ft=wt*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return it-Ft;case"top":return it+wt-Ft;case"hanging":return it+wt-2*Ft;case"middle":return it+wt/2-Ft;case"ideographic":return it;case"alphabetic":default:return it}},gt=function(it){return it+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};w.prototype.createLinearGradient=function(){var it=function(){};return it.colorStops=[],it.addColorStop=function(wt,Ft){this.colorStops.push([wt,Ft])},it.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},it.isCanvasGradient=!0,it},w.prototype.createPattern=function(){return this.createLinearGradient()},w.prototype.createRadialGradient=function(){return this.createLinearGradient()};var ht=function(it,wt,Ft,Ut,jt,Vt,re,Zt,Be){for(var Ie=Wt.call(this,Ft,Ut,jt,Vt),ke=0;ke<Ie.length;ke++){var He=Ie[ke];ke===0&&(Be?ot.call(this,He.x1+it,He.y1+wt):bt.call(this,He.x1+it,He.y1+wt)),$t.call(this,it,wt,He.x2,He.y2,He.x3,He.y3,He.x4,He.y4)}Zt?St.call(this):It.call(this,re)},It=function(it){switch(it){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},St=function(){this.pdf.clip(),this.pdf.discardPath()},ot=function(it,wt){this.pdf.internal.out(e(it)+" "+n(wt)+" m")},at=function(it){var wt;switch(it.align){case"right":case"end":wt="right";break;case"center":wt="center";break;case"left":case"start":default:wt="left"}var Ft=this.pdf.getTextDimensions(it.text),Ut=dt.call(this,it.y),jt=gt.call(this,Ut)-Ft.h,Vt=this.ctx.transform.applyToPoint(new a(it.x,Ut)),re=this.ctx.transform.decompose(),Zt=new d;Zt=(Zt=(Zt=Zt.multiply(re.translate)).multiply(re.skew)).multiply(re.scale);for(var Be,Ie,ke,He=this.ctx.transform.applyToRectangle(new o(it.x,Ut,Ft.w,Ft.h)),Ke=Zt.applyToRectangle(new o(it.x,jt,Ft.w,Ft.h)),le=N.call(this,Ke),st=[],pr=0;pr<le.length;pr+=1)st.indexOf(le[pr])===-1&&st.push(le[pr]);if(W(st),this.autoPaging)for(var Ye=st[0],ue=st[st.length-1],ye=Ye;ye<ue+1;ye++){this.pdf.setPage(ye);var Le=ye===1?this.posY+this.margin[0]:this.margin[0],Oe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],We=this.pdf.internal.pageSize.height-this.margin[2],cr=We-this.margin[0],yr=this.pdf.internal.pageSize.width-this.margin[1],Fr=yr-this.margin[3],Ur=ye===1?0:Oe+(ye-2)*cr;if(this.ctx.clip_path.length!==0){var de=this.path;Be=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=V(Be,this.posX+this.margin[3],-1*Ur+Le),ct.call(this,"fill",!0),this.path=de}var ur=V([JSON.parse(JSON.stringify(Ke))],this.posX+this.margin[3],-Ur+Le+this.ctx.prevPageLastElemOffset)[0];it.scale>=.01&&(Ie=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ie*it.scale),ke=this.lineWidth,this.lineWidth=ke*it.scale);var _r=this.autoPaging!=="text";if(_r||ur.y+ur.h<=We){if(_r||ur.y>=Le&&ur.x<=yr){var De=_r?it.text:this.pdf.splitTextToSize(it.text,it.maxWidth||yr-ur.x)[0],gn=V([JSON.parse(JSON.stringify(He))],this.posX+this.margin[3],-Ur+Le+this.ctx.prevPageLastElemOffset)[0],pe=_r&&(ye>Ye||ye<ue)&&R.call(this);pe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Fr,cr,null).clip().discardPath()),this.pdf.text(De,gn.x,gn.y,{angle:it.angle,align:wt,renderingMode:it.renderingMode}),pe&&this.pdf.restoreGraphicsState()}}else ur.y<We&&(this.ctx.prevPageLastElemOffset+=We-ur.y);it.scale>=.01&&(this.pdf.setFontSize(Ie),this.lineWidth=ke)}else it.scale>=.01&&(Ie=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ie*it.scale),ke=this.lineWidth,this.lineWidth=ke*it.scale),this.pdf.text(it.text,Vt.x+this.posX,Vt.y+this.posY,{angle:it.angle,align:wt,renderingMode:it.renderingMode,maxWidth:it.maxWidth}),it.scale>=.01&&(this.pdf.setFontSize(Ie),this.lineWidth=ke)},bt=function(it,wt,Ft,Ut){Ft=Ft||0,Ut=Ut||0,this.pdf.internal.out(e(it+Ft)+" "+n(wt+Ut)+" l")},vt=function(it,wt,Ft){return this.pdf.lines(it,wt,Ft,null,null)},$t=function(it,wt,Ft,Ut,jt,Vt,re,Zt){this.pdf.internal.out([t(i(Ft+it)),t(s(Ut+wt)),t(i(jt+it)),t(s(Vt+wt)),t(i(re+it)),t(s(Zt+wt)),"c"].join(" "))},Wt=function(it,wt,Ft,Ut){for(var jt=2*Math.PI,Vt=Math.PI/2;wt>Ft;)wt-=jt;var re=Math.abs(Ft-wt);re<jt&&Ut&&(re=jt-re);for(var Zt=[],Be=Ut?-1:1,Ie=wt;re>1e-5;){var ke=Ie+Be*Math.min(re,Vt);Zt.push(Jt.call(this,it,Ie,ke)),re-=Math.abs(ke-Ie),Ie=ke}return Zt},Jt=function(it,wt,Ft){var Ut=(Ft-wt)/2,jt=it*Math.cos(Ut),Vt=it*Math.sin(Ut),re=jt,Zt=-Vt,Be=re*re+Zt*Zt,Ie=Be+re*jt+Zt*Vt,ke=4/3*(Math.sqrt(2*Be*Ie)-Ie)/(re*Vt-Zt*jt),He=re-ke*Zt,Ke=Zt+ke*re,le=He,st=-Ke,pr=Ut+wt,Ye=Math.cos(pr),ue=Math.sin(pr);return{x1:it*Math.cos(wt),y1:it*Math.sin(wt),x2:He*Ye-Ke*ue,y2:He*ue+Ke*Ye,x3:le*Ye-st*ue,y3:le*ue+st*Ye,x4:it*Math.cos(Ft),y4:it*Math.sin(Ft)}},qt=function(it){return 180*it/Math.PI},te=function(it,wt,Ft,Ut,jt,Vt){var re=it+.5*(Ft-it),Zt=wt+.5*(Ut-wt),Be=jt+.5*(Ft-jt),Ie=Vt+.5*(Ut-Vt),ke=Math.min(it,jt,re,Be),He=Math.max(it,jt,re,Be),Ke=Math.min(wt,Vt,Zt,Ie),le=Math.max(wt,Vt,Zt,Ie);return new o(ke,Ke,He-ke,le-Ke)},Yt=function(it,wt,Ft,Ut,jt,Vt,re,Zt){var Be,Ie,ke,He,Ke,le,st,pr,Ye,ue,ye,Le,Oe,We,cr=Ft-it,yr=Ut-wt,Fr=jt-Ft,Ur=Vt-Ut,de=re-jt,ur=Zt-Vt;for(Ie=0;Ie<41;Ie++)Ye=(st=(ke=it+(Be=Ie/40)*cr)+Be*((Ke=Ft+Be*Fr)-ke))+Be*(Ke+Be*(jt+Be*de-Ke)-st),ue=(pr=(He=wt+Be*yr)+Be*((le=Ut+Be*Ur)-He))+Be*(le+Be*(Vt+Be*ur-le)-pr),Ie==0?(ye=Ye,Le=ue,Oe=Ye,We=ue):(ye=Math.min(ye,Ye),Le=Math.min(Le,ue),Oe=Math.max(Oe,Ye),We=Math.max(We,ue));return new o(Math.round(ye),Math.round(Le),Math.round(Oe-ye),Math.round(We-Le))},be=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var it,wt,Ft=(it=this.ctx.lineDash,wt=this.ctx.lineDashOffset,JSON.stringify({lineDash:it,lineDashOffset:wt}));this.prevLineDash!==Ft&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Ft)}}})(Gr.API),function(r){var t=function(s){var a,o,d,f,_,w,x,B,P,R;for(o=[],d=0,f=(s+=a="\0\0\0\0".slice(s.length%4||4)).length;f>d;d+=4)(_=(s.charCodeAt(d)<<24)+(s.charCodeAt(d+1)<<16)+(s.charCodeAt(d+2)<<8)+s.charCodeAt(d+3))!==0?(w=(_=((_=((_=((_=(_-(R=_%85))/85)-(P=_%85))/85)-(B=_%85))/85)-(x=_%85))/85)%85,o.push(w+33,x+33,B+33,P+33,R+33)):o.push(122);return function(N,Q){for(var V=Q;V>0;V--)N.pop()}(o,a.length),String.fromCharCode.apply(String,o)+"~>"},e=function(s){var a,o,d,f,_,w=String,x="length",B=255,P="charCodeAt",R="slice",N="replace";for(s[R](-2),s=s[R](0,-2)[N](/\s/g,"")[N]("z","!!!!!"),d=[],f=0,_=(s+=a="uuuuu"[R](s[x]%5||5))[x];_>f;f+=5)o=52200625*(s[P](f)-33)+614125*(s[P](f+1)-33)+7225*(s[P](f+2)-33)+85*(s[P](f+3)-33)+(s[P](f+4)-33),d.push(B&o>>24,B&o>>16,B&o>>8,B&o);return function(Q,V){for(var W=V;W>0;W--)Q.pop()}(d,a[x]),w.fromCharCode.apply(w,d)},n=function(s){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),a.test(s)===!1)return"";for(var o="",d=0;d<s.length;d+=2)o+=String.fromCharCode("0x"+(s[d]+s[d+1]));return o},i=function(s){for(var a=new Uint8Array(s.length),o=s.length;o--;)a[o]=s.charCodeAt(o);return s=(a=z2(a)).reduce(function(d,f){return d+String.fromCharCode(f)},"")};r.processDataByFilters=function(s,a){var o=0,d=s||"",f=[];for(typeof(a=a||[])=="string"&&(a=[a]),o=0;o<a.length;o+=1)switch(a[o]){case"ASCII85Decode":case"/ASCII85Decode":d=e(d),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=t(d),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=n(d),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=d.split("").map(function(_){return("0"+_.charCodeAt().toString(16)).slice(-2)}).join("")+">",f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=i(d),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[o]+'" is not implemented')}return{data:d,reverseChain:f.reverse().join(" ")}}}(Gr.API),function(r){r.loadFile=function(t,e,n){return function(i,s,a){s=s!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=function(d,f,_){var w=new XMLHttpRequest,x=0,B=function(P){var R=P.length,N=[],Q=String.fromCharCode;for(x=0;x<R;x+=1)N.push(Q(255&P.charCodeAt(x)));return N.join("")};if(w.open("GET",d,!f),w.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(w.onload=function(){w.status===200?_(B(this.responseText)):_(void 0)}),w.send(null),f&&w.status===200)return B(w.responseText)}(i,s,a)}catch{}return o}(t,e,n)},r.loadImageFile=r.loadFile}(Gr.API),function(r){function t(){return(Vr.html2canvas?Promise.resolve(Vr.html2canvas):Promise.resolve().then(()=>mAt)).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function e(){return(Vr.DOMPurify?Promise.resolve(Vr.DOMPurify):Promise.resolve().then(()=>KAt)).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var n=function(a){var o=Un(a);return o==="undefined"?"undefined":o==="string"||a instanceof String?"string":o==="number"||a instanceof Number?"number":o==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":o==="object"?"object":"unknown"},i=function(a,o){var d=document.createElement(a);for(var f in o.className&&(d.className=o.className),o.innerHTML&&o.dompurify&&(d.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)d.style[f]=o.style[f];return d},s=function a(o){var d=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),f=a.convert(Promise.resolve(),d);return f=(f=f.setProgress(1,a,1,[a])).set(o)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(a,o){return a.__proto__=o||s.prototype,a},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(a,o){return this.then(function(){switch(o=o||function(d){switch(n(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(a)){case"string":return this.then(e).then(function(d){return this.set({src:i("div",{innerHTML:a,dompurify:d})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},s.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function d(f,_){for(var w=f.nodeType===3?document.createTextNode(f.nodeValue):f.cloneNode(!1),x=f.firstChild;x;x=x.nextSibling)_!==!0&&x.nodeType===1&&x.nodeName==="SCRIPT"||w.appendChild(d(x,_));return f.nodeType===1&&(f.nodeName==="CANVAS"?(w.width=f.width,w.height=f.height,w.getContext("2d").drawImage(f,0,0)):f.nodeName!=="TEXTAREA"&&f.nodeName!=="SELECT"||(w.value=f.value),w.addEventListener("load",function(){w.scrollTop=f.scrollTop,w.scrollLeft=f.scrollLeft},!0)),w}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(o){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,o(this.prop.container,d)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(o){var d=this.opt.jsPDF,f=this.opt.fontFaces,_=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,w=Object.assign({async:!0,allowTaint:!0,scale:_,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete w.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=f,f)for(var x=0;x<f.length;++x){var B=f[x],P=B.src.find(function(R){return R.format==="truetype"});P&&d.addFont(P.url,B.ref.name,B.ref.style)}return w.windowHeight=w.windowHeight||0,w.windowHeight=w.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):w.windowHeight,d.context2d.save(!0),o(this.prop.container,w)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(a,o,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(a,o):this.outputPdf(a,o)},s.prototype.outputPdf=function(a,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,o)})},s.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},s.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(a){if(n(a)!=="object")return this;var o=Object.keys(a||{}).map(function(d){if(d in s.template.prop)return function(){this.prop[d]=a[d]};switch(d){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[d]=a[d]}}},this);return this.then(function(){return this.thenList(o)})},s.prototype.get=function(a,o){return this.then(function(){var d=a in s.template.prop?this.prop[a]:this.opt[a];return o?o(d):d})},s.prototype.setMargin=function(a){return this.then(function(){switch(n(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},s.prototype.setPageSize=function(a){function o(d,f){return Math.floor(d*f/72*96)}return this.then(function(){(a=a||Gr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:o(a.inner.width,a.k),height:o(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},s.prototype.setProgress=function(a,o,d,f){return a!=null&&(this.progress.val=a),o!=null&&(this.progress.state=o),d!=null&&(this.progress.n=d),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(a,o,d,f){return this.setProgress(a?this.progress.val+a:null,o||null,d?this.progress.n+d:null,f?this.progress.stack.concat(f):null)},s.prototype.then=function(a,o){var d=this;return this.thenCore(a,o,function(f,_){return d.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(w){return d.updateProgress(null,f),w}).then(f,_).then(function(w){return d.updateProgress(1),w})})},s.prototype.thenCore=function(a,o,d){d=d||Promise.prototype.then,a&&(a=a.bind(this)),o&&(o=o.bind(this));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),_=d.call(f,a,o);return s.convert(_,this.__proto__)},s.prototype.thenExternal=function(a,o){return Promise.prototype.then.call(this,a,o)},s.prototype.thenList=function(a){var o=this;return a.forEach(function(d){o=o.thenCore(d)}),o},s.prototype.catch=function(a){a&&(a=a.bind(this));var o=Promise.prototype.catch.call(this,a);return s.convert(o,this)},s.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},s.prototype.error=function(a){return this.then(function(){throw new Error(a)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,Gr.getPageSize=function(a,o,d){if(Un(a)==="object"){var f=a;a=f.orientation,o=f.unit||o,d=f.format||d}o=o||"mm",d=d||"a4",a=(""+(a||"P")).toLowerCase();var _,w=(""+d).toLowerCase(),x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":_=1;break;case"mm":_=72/25.4;break;case"cm":_=72/2.54;break;case"in":_=72;break;case"px":_=.75;break;case"pc":case"em":_=12;break;case"ex":_=6;break;default:throw"Invalid unit: "+o}var B,P=0,R=0;if(x.hasOwnProperty(w))P=x[w][1]/_,R=x[w][0]/_;else try{P=d[1],R=d[0]}catch{throw new Error("Invalid format: "+d)}if(a==="p"||a==="portrait")a="p",R>P&&(B=R,R=P,P=B);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",P>R&&(B=R,R=P,P=B)}return{width:R,height:P,unit:o,k:_,orientation:a}},r.html=function(a,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(Y2):null;var d=new s(o);return o.worker?d:d.from(a).doCallback()}}(Gr.API),Gr.API.addJS=function(r){return BP=r,this.internal.events.subscribe("postPutResources",function(){qy=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(qy+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),xP=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+BP+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){qy!==void 0&&xP!==void 0&&this.internal.out("/Names <</JavaScript "+qy+" 0 R>>")}),this},function(r){var t;r.events.push(["postPutResources",function(){var e=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=e.outline.render().split(/\r\n/),s=0;s<i.length;s++){var a=i[s],o=n.exec(a);if(o!=null){var d=o[1];e.internal.newObjectDeferredBegin(d,!1)}e.internal.write(a)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,_=[];for(s=0;s<f;s++){var w=e.internal.newObject();_.push(w);var x=e.internal.getPageInfo(s+1);e.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var B=e.internal.newObject();for(e.internal.write("<< /Names [ "),s=0;s<_.length;s++)e.internal.write("(page_"+(s+1)+")"+_[s]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+B+" 0 R"),e.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),r.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(n,i,s){var a={title:i,options:s,children:[]};return n==null&&(n=this.root),n.children.push(a),a},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(n){n.id=e.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},e.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},e.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var a=n.children[s];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var d=e.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+d.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var f=0;f<n.children.length;f++)this.renderItems(n.children[f])},e.outline.line=function(n){this.ctx.val+=n+`\r
`},e.outline.makeRef=function(n){return n.id+" 0 R"},e.outline.makeString=function(n){return"("+e.internal.pdfEscape(n)+")"},e.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},e.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},e.outline.count_r=function(n,i){for(var s=0;s<i.children.length;s++)n.count++,this.count_r(n,i.children[s]);return n.count}}])}(Gr.API),function(r){var t=[192,193,194,195,196,197,198,199];r.processJPEG=function(e,n,i,s,a,o){var d,f=this.decode.DCT_DECODE,_=null;if(typeof e=="string"||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=a||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,(d=function(w){for(var x,B=256*w.charCodeAt(4)+w.charCodeAt(5),P=w.length,R={width:0,height:0,numcomponents:1},N=4;N<P;N+=2){if(N+=B,t.indexOf(w.charCodeAt(N+1))!==-1){x=256*w.charCodeAt(N+5)+w.charCodeAt(N+6),R={width:256*w.charCodeAt(N+7)+w.charCodeAt(N+8),height:x,numcomponents:w.charCodeAt(N+9)};break}B=256*w.charCodeAt(N+2)+w.charCodeAt(N+3)}return R}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}_={data:e,width:d.width,height:d.height,colorSpace:o,bitsPerComponent:8,filter:f,index:n,alias:i}}return _}}(Gr.API);var Nf,Ky,EP,SP,TP,Jrt=function(){var r,t,e;function n(s){var a,o,d,f,_,w,x,B,P,R,N,Q,V,W;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},w=null;;){switch(a=this.readUInt32(),P=(function(){var et,ct;for(ct=[],et=0;et<4;++et)ct.push(String.fromCharCode(this.data[this.pos++]));return ct}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(a);break;case"fcTL":w&&this.animation.frames.push(w),this.pos+=4,w={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},_=this.readUInt16(),f=this.readUInt16()||100,w.delay=1e3*_/f,w.disposeOp=this.data[this.pos++],w.blendOp=this.data[this.pos++],w.data=[];break;case"IDAT":case"fdAT":for(P==="fdAT"&&(this.pos+=4,a-=4),s=(w!=null?w.data:void 0)||this.imgData,Q=0;0<=a?Q<a:Q>a;0<=a?++Q:--Q)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(d=this.palette.length/3,this.transparency.indexed=this.read(a),this.transparency.indexed.length>d)throw new Error("More transparent colors than palette size");if((R=d-this.transparency.indexed.length)>0)for(V=0;0<=R?V<R:V>R;0<=R?++V:--V)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(a)[0];break;case 2:this.transparency.rgb=this.read(a)}break;case"tEXt":x=(N=this.read(a)).indexOf(0),B=String.fromCharCode.apply(String,N.slice(0,x)),this.text[B]=String.fromCharCode.apply(String,N.slice(x+1));break;case"IEND":return w&&this.animation.frames.push(w),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(W=this.colorType)===4||W===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=a}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(s){var a,o;for(o=[],a=0;0<=s?a<s:a>s;0<=s?++a:--a)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(s){var a=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*a),d=0,f=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function _(w,x,B,P){var R,N,Q,V,W,et,ct,dt,gt,ht,It,St,ot,at,bt,vt,$t,Wt,Jt,qt,te,Yt=Math.ceil((f.width-w)/B),be=Math.ceil((f.height-x)/P),it=f.width==Yt&&f.height==be;for(at=a*Yt,St=it?o:new Uint8Array(at*be),et=s.length,ot=0,N=0;ot<be&&d<et;){switch(s[d++]){case 0:for(V=$t=0;$t<at;V=$t+=1)St[N++]=s[d++];break;case 1:for(V=Wt=0;Wt<at;V=Wt+=1)R=s[d++],W=V<a?0:St[N-a],St[N++]=(R+W)%256;break;case 2:for(V=Jt=0;Jt<at;V=Jt+=1)R=s[d++],Q=(V-V%a)/a,bt=ot&&St[(ot-1)*at+Q*a+V%a],St[N++]=(bt+R)%256;break;case 3:for(V=qt=0;qt<at;V=qt+=1)R=s[d++],Q=(V-V%a)/a,W=V<a?0:St[N-a],bt=ot&&St[(ot-1)*at+Q*a+V%a],St[N++]=(R+Math.floor((W+bt)/2))%256;break;case 4:for(V=te=0;te<at;V=te+=1)R=s[d++],Q=(V-V%a)/a,W=V<a?0:St[N-a],ot===0?bt=vt=0:(bt=St[(ot-1)*at+Q*a+V%a],vt=Q&&St[(ot-1)*at+(Q-1)*a+V%a]),ct=W+bt-vt,dt=Math.abs(ct-W),ht=Math.abs(ct-bt),It=Math.abs(ct-vt),gt=dt<=ht&&dt<=It?W:ht<=It?bt:vt,St[N++]=(R+gt)%256;break;default:throw new Error("Invalid filter algorithm: "+s[d-1])}if(!it){var wt=((x+ot*P)*f.width+w)*a,Ft=ot*at;for(V=0;V<Yt;V+=1){for(var Ut=0;Ut<a;Ut+=1)o[wt++]=St[Ft++];wt+=(B-1)*a}}ot++}}return s=Lrt(s),f.interlaceMethod==1?(_(0,0,8,8),_(4,0,8,8),_(0,4,4,8),_(2,0,4,4),_(0,2,2,4),_(1,0,2,2),_(0,1,1,2)):_(0,0,1,1),o},n.prototype.decodePalette=function(){var s,a,o,d,f,_,w,x,B;for(o=this.palette,_=this.transparency.indexed||[],f=new Uint8Array((_.length||0)+o.length),d=0,s=0,a=w=0,x=o.length;w<x;a=w+=3)f[d++]=o[a],f[d++]=o[a+1],f[d++]=o[a+2],f[d++]=(B=_[s++])!=null?B:255;return f},n.prototype.copyToImageData=function(s,a){var o,d,f,_,w,x,B,P,R,N,Q;if(d=this.colors,R=null,o=this.hasAlphaChannel,this.palette.length&&(R=(Q=this._decodedPalette)!=null?Q:this._decodedPalette=this.decodePalette(),d=4,o=!0),P=(f=s.data||s).length,w=R||a,_=x=0,d===1)for(;_<P;)B=R?4*a[_/4]:x,N=w[B++],f[_++]=N,f[_++]=N,f[_++]=N,f[_++]=o?w[B++]:255,x=B;else for(;_<P;)B=R?4*a[_/4]:x,f[_++]=w[B++],f[_++]=w[B++],f[_++]=w[B++],f[_++]=o?w[B++]:255,x=B},n.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var i=function(){if(Object.prototype.toString.call(Vr)==="[object Window]"){try{t=Vr.document.createElement("canvas"),e=t.getContext("2d")}catch{return!1}return!0}return!1};return i(),r=function(s){var a;if(i()===!0)return e.width=s.width,e.height=s.height,e.clearRect(0,0,s.width,s.height),e.putImageData(s,0,0),(a=new Image).src=t.toDataURL(),a;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(s){var a,o,d,f,_,w,x,B;if(this.animation){for(B=[],o=_=0,w=(x=this.animation.frames).length;_<w;o=++_)a=x[o],d=s.createImageData(a.width,a.height),f=this.decodePixels(new Uint8Array(a.data)),this.copyToImageData(d,f),a.imageData=d,B.push(a.image=r(d));return B}},n.prototype.renderFrame=function(s,a){var o,d,f;return o=(d=this.animation.frames)[a],f=d[a-1],a===0&&s.clearRect(0,0,this.width,this.height),(f!=null?f.disposeOp:void 0)===1?s.clearRect(f.xOffset,f.yOffset,f.width,f.height):(f!=null?f.disposeOp:void 0)===2&&s.putImageData(f.imageData,f.xOffset,f.yOffset),o.blendOp===0&&s.clearRect(o.xOffset,o.yOffset,o.width,o.height),s.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(s){var a,o,d,f,_,w,x=this;return o=0,w=this.animation,f=w.numFrames,d=w.frames,_=w.numPlays,(a=function(){var B,P;if(B=o++%f,P=d[B],x.renderFrame(s,B),f>1&&o/f<_)return x.animation._timeout=setTimeout(a,P.delay)})()},n.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},n.prototype.render=function(s){var a,o;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,a=s.getContext("2d"),this.animation?(this.decodeFrames(a),this.animate(a)):(o=a.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),a.putImageData(o,0,0))},n}();/**
* @license
*
* Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
*
* Permission is hereby granted, free of charge, to any person obtaining
* a copy of this software and associated documentation files (the
* "Software"), to deal in the Software without restriction, including
* without limitation the rights to use, copy, modify, merge, publish,
* distribute, sublicense, and/or sell copies of the Software, and to
* permit persons to whom the Software is furnished to do so, subject to
* the following conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
* LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
* OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
* WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
* ====================================================================
*//**
* @license
* (c) Dean McNamee <dean@gmail.com>, 2013.
*
* https://github.com/deanm/omggif
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to
* deal in the Software without restriction, including without limitation the
* rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
* sell copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in
* all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
* IN THE SOFTWARE.
*
* omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
* including animation and compression.  It does not rely on any specific
* underlying system, so should run in the browser, Node, or Plask.
*/function Yrt(r){var t=0;if(r[t++]!==71||r[t++]!==73||r[t++]!==70||r[t++]!==56||(r[t++]+1&253)!=56||r[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var e=r[t++]|r[t++]<<8,n=r[t++]|r[t++]<<8,i=r[t++],s=i>>7,a=1<<(7&i)+1;r[t++],r[t++];var o=null,d=null;s&&(o=t,d=a,t+=3*a);var f=!0,_=[],w=0,x=null,B=0,P=null;for(this.width=e,this.height=n;f&&t<r.length;)switch(r[t++]){case 33:switch(r[t++]){case 255:if(r[t]!==11||r[t+1]==78&&r[t+2]==69&&r[t+3]==84&&r[t+4]==83&&r[t+5]==67&&r[t+6]==65&&r[t+7]==80&&r[t+8]==69&&r[t+9]==50&&r[t+10]==46&&r[t+11]==48&&r[t+12]==3&&r[t+13]==1&&r[t+16]==0)t+=14,P=r[t++]|r[t++]<<8,t++;else for(t+=12;;){if(!((ot=r[t++])>=0))throw Error("Invalid block size");if(ot===0)break;t+=ot}break;case 249:if(r[t++]!==4||r[t+4]!==0)throw new Error("Invalid graphics extension block.");var R=r[t++];w=r[t++]|r[t++]<<8,x=r[t++],!(1&R)&&(x=null),B=R>>2&7,t++;break;case 254:for(;;){if(!((ot=r[t++])>=0))throw Error("Invalid block size");if(ot===0)break;t+=ot}break;default:throw new Error("Unknown graphic control label: 0x"+r[t-1].toString(16))}break;case 44:var N=r[t++]|r[t++]<<8,Q=r[t++]|r[t++]<<8,V=r[t++]|r[t++]<<8,W=r[t++]|r[t++]<<8,et=r[t++],ct=et>>6&1,dt=1<<(7&et)+1,gt=o,ht=d,It=!1;et>>7&&(It=!0,gt=t,ht=dt,t+=3*dt);var St=t;for(t++;;){var ot;if(!((ot=r[t++])>=0))throw Error("Invalid block size");if(ot===0)break;t+=ot}_.push({x:N,y:Q,width:V,height:W,has_local_palette:It,palette_offset:gt,palette_size:ht,data_offset:St,data_length:t-St,transparent_index:x,interlaced:!!ct,delay:w,disposal:B});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+r[t-1].toString(16))}this.numFrames=function(){return _.length},this.loopCount=function(){return P},this.frameInfo=function(at){if(at<0||at>=_.length)throw new Error("Frame index out of range.");return _[at]},this.decodeAndBlitFrameBGRA=function(at,bt){var vt=this.frameInfo(at),$t=vt.width*vt.height,Wt=new Uint8Array($t);IP(r,vt.data_offset,Wt,$t);var Jt=vt.palette_offset,qt=vt.transparent_index;qt===null&&(qt=256);var te=vt.width,Yt=e-te,be=te,it=4*(vt.y*e+vt.x),wt=4*((vt.y+vt.height)*e+vt.x),Ft=it,Ut=4*Yt;vt.interlaced===!0&&(Ut+=4*e*7);for(var jt=8,Vt=0,re=Wt.length;Vt<re;++Vt){var Zt=Wt[Vt];if(be===0&&(be=te,(Ft+=Ut)>=wt&&(Ut=4*Yt+4*e*(jt-1),Ft=it+(te+Yt)*(jt<<1),jt>>=1)),Zt===qt)Ft+=4;else{var Be=r[Jt+3*Zt],Ie=r[Jt+3*Zt+1],ke=r[Jt+3*Zt+2];bt[Ft++]=ke,bt[Ft++]=Ie,bt[Ft++]=Be,bt[Ft++]=255}--be}},this.decodeAndBlitFrameRGBA=function(at,bt){var vt=this.frameInfo(at),$t=vt.width*vt.height,Wt=new Uint8Array($t);IP(r,vt.data_offset,Wt,$t);var Jt=vt.palette_offset,qt=vt.transparent_index;qt===null&&(qt=256);var te=vt.width,Yt=e-te,be=te,it=4*(vt.y*e+vt.x),wt=4*((vt.y+vt.height)*e+vt.x),Ft=it,Ut=4*Yt;vt.interlaced===!0&&(Ut+=4*e*7);for(var jt=8,Vt=0,re=Wt.length;Vt<re;++Vt){var Zt=Wt[Vt];if(be===0&&(be=te,(Ft+=Ut)>=wt&&(Ut=4*Yt+4*e*(jt-1),Ft=it+(te+Yt)*(jt<<1),jt>>=1)),Zt===qt)Ft+=4;else{var Be=r[Jt+3*Zt],Ie=r[Jt+3*Zt+1],ke=r[Jt+3*Zt+2];bt[Ft++]=Be,bt[Ft++]=Ie,bt[Ft++]=ke,bt[Ft++]=255}--be}}}function IP(r,t,e,n){for(var i=r[t++],s=1<<i,a=s+1,o=a+1,d=i+1,f=(1<<d)-1,_=0,w=0,x=0,B=r[t++],P=new Int32Array(4096),R=null;;){for(;_<16&&B!==0;)w|=r[t++]<<_,_+=8,B===1?B=r[t++]:--B;if(_<d)break;var N=w&f;if(w>>=d,_-=d,N!==s){if(N===a)break;for(var Q=N<o?N:R,V=0,W=Q;W>s;)W=P[W]>>8,++V;var et=W;if(x+V+(Q!==N?1:0)>n)return void ui.log("Warning, gif stream longer than expected.");e[x++]=et;var ct=x+=V;for(Q!==N&&(e[x++]=et),W=Q;V--;)W=P[W],e[--ct]=255&W,W>>=8;R!==null&&o<4096&&(P[o++]=R<<8|et,o>=f+1&&d<12&&(++d,f=f<<1|1)),R=N}else o=a+1,f=(1<<(d=i+1))-1,R=null}return x!==n&&ui.log("Warning, gif stream shorter than expected."),e}/**
	 * @license
	  Copyright (c) 2008, Adobe Systems Incorporated
	  All rights reserved.

	  Redistribution and use in source and binary forms, with or without 
	  modification, are permitted provided that the following conditions are
	  met:

	  * Redistributions of source code must retain the above copyright notice, 
	    this list of conditions and the following disclaimer.
	  
	  * Redistributions in binary form must reproduce the above copyright
	    notice, this list of conditions and the following disclaimer in the 
	    documentation and/or other materials provided with the distribution.
	  
	  * Neither the name of Adobe Systems Incorporated nor the names of its 
	    contributors may be used to endorse or promote products derived from 
	    this software without specific prior written permission.

	  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
	  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
	  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
	  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
	  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
	  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
	  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
	  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
	  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
	  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
	  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	*/function Z2(r){var t,e,n,i,s,a=Math.floor,o=new Array(64),d=new Array(64),f=new Array(64),_=new Array(64),w=new Array(65535),x=new Array(65535),B=new Array(64),P=new Array(64),R=[],N=0,Q=7,V=new Array(64),W=new Array(64),et=new Array(64),ct=new Array(256),dt=new Array(2048),gt=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],ht=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],It=[0,1,2,3,4,5,6,7,8,9,10,11],St=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],ot=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],at=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],bt=[0,1,2,3,4,5,6,7,8,9,10,11],vt=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],$t=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Wt(it,wt){for(var Ft=0,Ut=0,jt=new Array,Vt=1;Vt<=16;Vt++){for(var re=1;re<=it[Vt];re++)jt[wt[Ut]]=[],jt[wt[Ut]][0]=Ft,jt[wt[Ut]][1]=Vt,Ut++,Ft++;Ft*=2}return jt}function Jt(it){for(var wt=it[0],Ft=it[1]-1;Ft>=0;)wt&1<<Ft&&(N|=1<<Q),Ft--,--Q<0&&(N==255?(qt(255),qt(0)):qt(N),Q=7,N=0)}function qt(it){R.push(it)}function te(it){qt(it>>8&255),qt(255&it)}function Yt(it,wt,Ft,Ut,jt){for(var Vt,re=jt[0],Zt=jt[240],Be=function(ue,ye){var Le,Oe,We,cr,yr,Fr,Ur,de,ur,_r,De=0;for(ur=0;ur<8;++ur){Le=ue[De],Oe=ue[De+1],We=ue[De+2],cr=ue[De+3],yr=ue[De+4],Fr=ue[De+5],Ur=ue[De+6];var gn=Le+(de=ue[De+7]),pe=Le-de,gr=Oe+Ur,Qe=Oe-Ur,Mr=We+Fr,_n=We-Fr,ze=cr+yr,Nn=cr-yr,sn=gn+ze,vn=gn-ze,cn=gr+Mr,Ct=gr-Mr;ue[De]=sn+cn,ue[De+4]=sn-cn;var X=.707106781*(Ct+vn);ue[De+2]=vn+X,ue[De+6]=vn-X;var Z=.382683433*((sn=Nn+_n)-(Ct=Qe+pe)),ft=.5411961*sn+Z,Bt=1.306562965*Ct+Z,Qt=.707106781*(cn=_n+Qe),Gt=pe+Qt,Nt=pe-Qt;ue[De+5]=Nt+ft,ue[De+3]=Nt-ft,ue[De+1]=Gt+Bt,ue[De+7]=Gt-Bt,De+=8}for(De=0,ur=0;ur<8;++ur){Le=ue[De],Oe=ue[De+8],We=ue[De+16],cr=ue[De+24],yr=ue[De+32],Fr=ue[De+40],Ur=ue[De+48];var Pt=Le+(de=ue[De+56]),se=Le-de,he=Oe+Ur,Xt=Oe-Ur,we=We+Fr,je=We-Fr,tr=cr+yr,Qr=cr-yr,ir=Pt+tr,Or=Pt-tr,xr=he+we,$r=he-we;ue[De]=ir+xr,ue[De+32]=ir-xr;var Xr=.707106781*($r+Or);ue[De+16]=Or+Xr,ue[De+48]=Or-Xr;var vr=.382683433*((ir=Qr+je)-($r=Xt+se)),jr=.5411961*ir+vr,on=1.306562965*$r+vr,In=.707106781*(xr=je+Xt),Mt=se+In,Ne=se-In;ue[De+40]=Ne+jr,ue[De+24]=Ne-jr,ue[De+8]=Mt+on,ue[De+56]=Mt-on,De++}for(ur=0;ur<64;++ur)_r=ue[ur]*ye[ur],B[ur]=_r>0?_r+.5|0:_r-.5|0;return B}(it,wt),Ie=0;Ie<64;++Ie)P[gt[Ie]]=Be[Ie];var ke=P[0]-Ft;Ft=P[0],ke==0?Jt(Ut[0]):(Jt(Ut[x[Vt=32767+ke]]),Jt(w[Vt]));for(var He=63;He>0&&P[He]==0;)He--;if(He==0)return Jt(re),Ft;for(var Ke,le=1;le<=He;){for(var st=le;P[le]==0&&le<=He;)++le;var pr=le-st;if(pr>=16){Ke=pr>>4;for(var Ye=1;Ye<=Ke;++Ye)Jt(Zt);pr&=15}Vt=32767+P[le],Jt(jt[(pr<<4)+x[Vt]]),Jt(w[Vt]),le++}return He!=63&&Jt(re),Ft}function be(it){it=Math.min(Math.max(it,1),100),s!=it&&(function(wt){for(var Ft=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Ut=0;Ut<64;Ut++){var jt=a((Ft[Ut]*wt+50)/100);jt=Math.min(Math.max(jt,1),255),o[gt[Ut]]=jt}for(var Vt=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],re=0;re<64;re++){var Zt=a((Vt[re]*wt+50)/100);Zt=Math.min(Math.max(Zt,1),255),d[gt[re]]=Zt}for(var Be=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ie=0,ke=0;ke<8;ke++)for(var He=0;He<8;He++)f[Ie]=1/(o[gt[Ie]]*Be[ke]*Be[He]*8),_[Ie]=1/(d[gt[Ie]]*Be[ke]*Be[He]*8),Ie++}(it<50?Math.floor(5e3/it):Math.floor(200-2*it)),s=it)}this.encode=function(it,wt){wt&&be(wt),R=new Array,N=0,Q=7,te(65496),te(65504),te(16),qt(74),qt(70),qt(73),qt(70),qt(0),qt(1),qt(1),qt(0),te(1),te(1),qt(0),qt(0),function(){te(65499),te(132),qt(0);for(var Oe=0;Oe<64;Oe++)qt(o[Oe]);qt(1);for(var We=0;We<64;We++)qt(d[We])}(),function(Oe,We){te(65472),te(17),qt(8),te(We),te(Oe),qt(3),qt(1),qt(17),qt(0),qt(2),qt(17),qt(1),qt(3),qt(17),qt(1)}(it.width,it.height),function(){te(65476),te(418),qt(0);for(var Oe=0;Oe<16;Oe++)qt(ht[Oe+1]);for(var We=0;We<=11;We++)qt(It[We]);qt(16);for(var cr=0;cr<16;cr++)qt(St[cr+1]);for(var yr=0;yr<=161;yr++)qt(ot[yr]);qt(1);for(var Fr=0;Fr<16;Fr++)qt(at[Fr+1]);for(var Ur=0;Ur<=11;Ur++)qt(bt[Ur]);qt(17);for(var de=0;de<16;de++)qt(vt[de+1]);for(var ur=0;ur<=161;ur++)qt($t[ur])}(),te(65498),te(12),qt(3),qt(1),qt(0),qt(2),qt(17),qt(3),qt(17),qt(0),qt(63),qt(0);var Ft=0,Ut=0,jt=0;N=0,Q=7,this.encode.displayName="_encode_";for(var Vt,re,Zt,Be,Ie,ke,He,Ke,le,st=it.data,pr=it.width,Ye=it.height,ue=4*pr,ye=0;ye<Ye;){for(Vt=0;Vt<ue;){for(Ie=ue*ye+Vt,He=-1,Ke=0,le=0;le<64;le++)ke=Ie+(Ke=le>>3)*ue+(He=4*(7&le)),ye+Ke>=Ye&&(ke-=ue*(ye+1+Ke-Ye)),Vt+He>=ue&&(ke-=Vt+He-ue+4),re=st[ke++],Zt=st[ke++],Be=st[ke++],V[le]=(dt[re]+dt[Zt+256>>0]+dt[Be+512>>0]>>16)-128,W[le]=(dt[re+768>>0]+dt[Zt+1024>>0]+dt[Be+1280>>0]>>16)-128,et[le]=(dt[re+1280>>0]+dt[Zt+1536>>0]+dt[Be+1792>>0]>>16)-128;Ft=Yt(V,f,Ft,t,n),Ut=Yt(W,_,Ut,e,i),jt=Yt(et,_,jt,e,i),Vt+=32}ye+=8}if(Q>=0){var Le=[];Le[1]=Q+1,Le[0]=(1<<Q+1)-1,Jt(Le)}return te(65497),new Uint8Array(R)},r=r||50,function(){for(var it=String.fromCharCode,wt=0;wt<256;wt++)ct[wt]=it(wt)}(),t=Wt(ht,It),e=Wt(at,bt),n=Wt(St,ot),i=Wt(vt,$t),function(){for(var it=1,wt=2,Ft=1;Ft<=15;Ft++){for(var Ut=it;Ut<wt;Ut++)x[32767+Ut]=Ft,w[32767+Ut]=[],w[32767+Ut][1]=Ft,w[32767+Ut][0]=Ut;for(var jt=-(wt-1);jt<=-it;jt++)x[32767+jt]=Ft,w[32767+jt]=[],w[32767+jt][1]=Ft,w[32767+jt][0]=wt-1+jt;it<<=1,wt<<=1}}(),function(){for(var it=0;it<256;it++)dt[it]=19595*it,dt[it+256>>0]=38470*it,dt[it+512>>0]=7471*it+32768,dt[it+768>>0]=-11059*it,dt[it+1024>>0]=-21709*it,dt[it+1280>>0]=32768*it+8421375,dt[it+1536>>0]=-27439*it,dt[it+1792>>0]=-5329*it}(),be(r)}/**
* @license
* Copyright (c) 2017 Aras Abbasi
*
* Licensed under the MIT License.
* http://opensource.org/licenses/mit-license
*/function nc(r,t){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function FP(r){function t(ht){if(!ht)throw Error("assert :P")}function e(ht,It,St){for(var ot=0;4>ot;ot++)if(ht[It+ot]!=St.charCodeAt(ot))return!0;return!1}function n(ht,It,St,ot,at){for(var bt=0;bt<at;bt++)ht[It+bt]=St[ot+bt]}function i(ht,It,St,ot){for(var at=0;at<ot;at++)ht[It+at]=St}function s(ht){return new Int32Array(ht)}function a(ht,It){for(var St=[],ot=0;ot<ht;ot++)St.push(new It);return St}function o(ht,It){var St=[];return function ot(at,bt,vt){for(var $t=vt[bt],Wt=0;Wt<$t&&(at.push(vt.length>bt+1?[]:new It),!(vt.length<bt+1));Wt++)ot(at[Wt],bt+1,vt)}(St,0,ht),St}var d=function(){var ht=this;function It(E,L){for(var m=1<<L-1>>>0;E&m;)m>>>=1;return m?(E&m-1)+m:E}function St(E,L,m,l,A){t(!(l%m));do E[L+(l-=m)]=A;while(0<l)}function ot(E,L,m,l,A){if(t(2328>=A),512>=A)var p=s(512);else if((p=s(A))==null)return 0;return function(y,v,S,I,M,D){var H,z,$=v,J=1<<S,K=s(16),tt=s(16);for(t(M!=0),t(I!=null),t(y!=null),t(0<S),z=0;z<M;++z){if(15<I[z])return 0;++K[I[z]]}if(K[0]==M)return 0;for(tt[1]=0,H=1;15>H;++H){if(K[H]>1<<H)return 0;tt[H+1]=tt[H]+K[H]}for(z=0;z<M;++z)H=I[z],0<I[z]&&(D[tt[H]++]=z);if(tt[15]==1)return(I=new at).g=0,I.value=D[0],St(y,$,1,J,I),J;var At,pt=-1,_t=J-1,mt=0,Et=1,Dt=1,Rt=1<<S;for(z=0,H=1,M=2;H<=S;++H,M<<=1){if(Et+=Dt<<=1,0>(Dt-=K[H]))return 0;for(;0<K[H];--K[H])(I=new at).g=H,I.value=D[z++],St(y,$+mt,M,Rt,I),mt=It(mt,H)}for(H=S+1,M=2;15>=H;++H,M<<=1){if(Et+=Dt<<=1,0>(Dt-=K[H]))return 0;for(;0<K[H];--K[H]){if(I=new at,(mt&_t)!=pt){for($+=Rt,At=1<<(pt=H)-S;15>pt&&!(0>=(At-=K[pt]));)++pt,At<<=1;J+=Rt=1<<(At=pt-S),y[v+(pt=mt&_t)].g=At+S,y[v+pt].value=$-v-pt}I.g=H-S,I.value=D[z++],St(y,$+(mt>>S),M,Rt,I),mt=It(mt,H)}}return Et!=2*tt[15]-1?0:J}(E,L,m,l,A,p)}function at(){this.value=this.g=0}function bt(){this.value=this.g=0}function vt(){this.G=a(5,at),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(cs,bt)}function $t(E,L,m,l){t(E!=null),t(L!=null),t(2147483648>l),E.Ca=254,E.I=0,E.b=-8,E.Ka=0,E.oa=L,E.pa=m,E.Jd=L,E.Yc=m+l,E.Zc=4<=l?m+l-4+1:m,Vt(E)}function Wt(E,L){for(var m=0;0<L--;)m|=Zt(E,128)<<L;return m}function Jt(E,L){var m=Wt(E,L);return re(E)?-m:m}function qt(E,L,m,l){var A,p=0;for(t(E!=null),t(L!=null),t(4294967288>l),E.Sb=l,E.Ra=0,E.u=0,E.h=0,4<l&&(l=4),A=0;A<l;++A)p+=L[m+A]<<8*A;E.Ra=p,E.bb=l,E.oa=L,E.pa=m}function te(E){for(;8<=E.u&&E.bb<E.Sb;)E.Ra>>>=8,E.Ra+=E.oa[E.pa+E.bb]<<Co-8>>>0,++E.bb,E.u-=8;Ft(E)&&(E.h=1,E.u=0)}function Yt(E,L){if(t(0<=L),!E.h&&L<=Fl){var m=wt(E)&Il[L];return E.u+=L,te(E),m}return E.h=1,E.u=0}function be(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function it(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function wt(E){return E.Ra>>>(E.u&Co-1)>>>0}function Ft(E){return t(E.bb<=E.Sb),E.h||E.bb==E.Sb&&E.u>Co}function Ut(E,L){E.u=L,E.h=Ft(E)}function jt(E){E.u>=Za&&(t(E.u>=Za),te(E))}function Vt(E){t(E!=null&&E.oa!=null),E.pa<E.Zc?(E.I=(E.oa[E.pa++]|E.I<<8)>>>0,E.b+=8):(t(E!=null&&E.oa!=null),E.pa<E.Yc?(E.b+=8,E.I=E.oa[E.pa++]|E.I<<8):E.Ka?E.b=0:(E.I<<=8,E.b+=8,E.Ka=1))}function re(E){return Wt(E,1)}function Zt(E,L){var m=E.Ca;0>E.b&&Vt(E);var l=E.b,A=m*L>>>8,p=(E.I>>>l>A)+0;for(p?(m-=A,E.I-=A+1<<l>>>0):m=A+1,l=m,A=0;256<=l;)A+=8,l>>=8;return l=7^A+zi[l],E.b-=l,E.Ca=(m<<l)-1,p}function Be(E,L,m){E[L+0]=m>>24&255,E[L+1]=m>>16&255,E[L+2]=m>>8&255,E[L+3]=m>>0&255}function Ie(E,L){return E[L+0]<<0|E[L+1]<<8}function ke(E,L){return Ie(E,L)|E[L+2]<<16}function He(E,L){return Ie(E,L)|Ie(E,L+2)<<16}function Ke(E,L){var m=1<<L;return t(E!=null),t(0<L),E.X=s(m),E.X==null?0:(E.Mb=32-L,E.Xa=L,1)}function le(E,L){t(E!=null),t(L!=null),t(E.Xa==L.Xa),n(L.X,0,E.X,0,1<<L.Xa)}function st(){this.X=[],this.Xa=this.Mb=0}function pr(E,L,m,l){t(m!=null),t(l!=null);var A=m[0],p=l[0];return A==0&&(A=(E*p+L/2)/L),p==0&&(p=(L*A+E/2)/E),0>=A||0>=p?0:(m[0]=A,l[0]=p,1)}function Ye(E,L){return E+(1<<L)-1>>>L}function ue(E,L){return((4278255360&E)+(4278255360&L)>>>0&4278255360)+((16711935&E)+(16711935&L)>>>0&16711935)>>>0}function ye(E,L){ht[L]=function(m,l,A,p,y,v,S){var I;for(I=0;I<y;++I){var M=ht[E](v[S+I-1],A,p+I);v[S+I]=ue(m[l+I],M)}}}function Le(){this.ud=this.hd=this.jd=0}function Oe(E,L){return((4278124286&(E^L))>>>1)+(E&L)>>>0}function We(E){return 0<=E&&256>E?E:0>E?0:255<E?255:void 0}function cr(E,L){return We(E+(E-L+.5>>1))}function yr(E,L,m){return Math.abs(L-m)-Math.abs(E-m)}function Fr(E,L,m,l,A,p,y){for(l=p[y-1],m=0;m<A;++m)p[y+m]=l=ue(E[L+m],l)}function Ur(E,L,m,l,A){var p;for(p=0;p<m;++p){var y=E[L+p],v=y>>8&255,S=16711935&(S=(S=16711935&y)+((v<<16)+v));l[A+p]=(4278255360&y)+S>>>0}}function de(E,L){L.jd=E>>0&255,L.hd=E>>8&255,L.ud=E>>16&255}function ur(E,L,m,l,A,p){var y;for(y=0;y<l;++y){var v=L[m+y],S=v>>>8,I=v,M=255&(M=(M=v>>>16)+((E.jd<<24>>24)*(S<<24>>24)>>>5));I=255&(I=(I=I+((E.hd<<24>>24)*(S<<24>>24)>>>5))+((E.ud<<24>>24)*(M<<24>>24)>>>5)),A[p+y]=(4278255360&v)+(M<<16)+I}}function _r(E,L,m,l,A){ht[L]=function(p,y,v,S,I,M,D,H,z){for(S=D;S<H;++S)for(D=0;D<z;++D)I[M++]=A(v[l(p[y++])])},ht[E]=function(p,y,v,S,I,M,D){var H=8>>p.b,z=p.Ea,$=p.K[0],J=p.w;if(8>H)for(p=(1<<p.b)-1,J=(1<<H)-1;y<v;++y){var K,tt=0;for(K=0;K<z;++K)K&p||(tt=l(S[I++])),M[D++]=A($[tt&J]),tt>>=H}else ht["VP8LMapColor"+m](S,I,$,J,M,D,y,v,z)}}function De(E,L,m,l,A){for(m=L+m;L<m;){var p=E[L++];l[A++]=p>>16&255,l[A++]=p>>8&255,l[A++]=p>>0&255}}function gn(E,L,m,l,A){for(m=L+m;L<m;){var p=E[L++];l[A++]=p>>16&255,l[A++]=p>>8&255,l[A++]=p>>0&255,l[A++]=p>>24&255}}function pe(E,L,m,l,A){for(m=L+m;L<m;){var p=(y=E[L++])>>16&240|y>>12&15,y=y>>0&240|y>>28&15;l[A++]=p,l[A++]=y}}function gr(E,L,m,l,A){for(m=L+m;L<m;){var p=(y=E[L++])>>16&248|y>>13&7,y=y>>5&224|y>>3&31;l[A++]=p,l[A++]=y}}function Qe(E,L,m,l,A){for(m=L+m;L<m;){var p=E[L++];l[A++]=p>>0&255,l[A++]=p>>8&255,l[A++]=p>>16&255}}function Mr(E,L,m,l,A,p){if(p==0)for(m=L+m;L<m;)Be(l,((p=E[L++])[0]>>24|p[1]>>8&65280|p[2]<<8&16711680|p[3]<<24)>>>0),A+=32;else n(l,A,E,L,m)}function _n(E,L){ht[L][0]=ht[E+"0"],ht[L][1]=ht[E+"1"],ht[L][2]=ht[E+"2"],ht[L][3]=ht[E+"3"],ht[L][4]=ht[E+"4"],ht[L][5]=ht[E+"5"],ht[L][6]=ht[E+"6"],ht[L][7]=ht[E+"7"],ht[L][8]=ht[E+"8"],ht[L][9]=ht[E+"9"],ht[L][10]=ht[E+"10"],ht[L][11]=ht[E+"11"],ht[L][12]=ht[E+"12"],ht[L][13]=ht[E+"13"],ht[L][14]=ht[E+"0"],ht[L][15]=ht[E+"0"]}function ze(E){return E==gu||E==Sc||E==mu||E==gA}function Nn(){this.eb=[],this.size=this.A=this.fb=0}function sn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function vn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Nn,this.f.kb=new sn,this.sd=null}function cn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ct(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function X(E){return alert("todo:WebPSamplerProcessPlane"),E.T}function Z(E,L){var m=E.T,l=L.ba.f.RGBA,A=l.eb,p=l.fb+E.ka*l.A,y=kr[L.ba.S],v=E.y,S=E.O,I=E.f,M=E.N,D=E.ea,H=E.W,z=L.cc,$=L.dc,J=L.Mc,K=L.Nc,tt=E.ka,At=E.ka+E.T,pt=E.U,_t=pt+1>>1;for(tt==0?y(v,S,null,null,I,M,D,H,I,M,D,H,A,p,null,null,pt):(y(L.ec,L.fc,v,S,z,$,J,K,I,M,D,H,A,p-l.A,A,p,pt),++m);tt+2<At;tt+=2)z=I,$=M,J=D,K=H,M+=E.Rc,H+=E.Rc,p+=2*l.A,y(v,(S+=2*E.fa)-E.fa,v,S,z,$,J,K,I,M,D,H,A,p-l.A,A,p,pt);return S+=E.fa,E.j+At<E.o?(n(L.ec,L.fc,v,S,pt),n(L.cc,L.dc,I,M,_t),n(L.Mc,L.Nc,D,H,_t),m--):1&At||y(v,S,null,null,I,M,D,H,I,M,D,H,A,p+l.A,null,null,pt),m}function ft(E,L,m){var l=E.F,A=[E.J];if(l!=null){var p=E.U,y=L.ba.S,v=y==pu||y==mu;L=L.ba.f.RGBA;var S=[0],I=E.ka;S[0]=E.T,E.Kb&&(I==0?--S[0]:(--I,A[0]-=E.width),E.j+E.ka+E.T==E.o&&(S[0]=E.o-E.j-I));var M=L.eb;I=L.fb+I*L.A,E=Ea(l,A[0],E.width,p,S,M,I+(v?0:3),L.A),t(m==S),E&&ze(y)&&Fo(M,I,v,p,S,L.A)}return 0}function Bt(E){var L=E.ma,m=L.ba.S,l=11>m,A=m==Cc||m==Ec||m==pu||m==pA||m==12||ze(m);if(L.memory=null,L.Ib=null,L.Jb=null,L.Nd=null,!ta(L.Oa,E,A?11:12))return 0;if(A&&ze(m)&&Re(),E.da)alert("todo:use_scaling");else{if(l){if(L.Ib=X,E.Kb){if(m=E.U+1>>1,L.memory=s(E.U+2*m),L.memory==null)return 0;L.ec=L.memory,L.fc=0,L.cc=L.ec,L.dc=L.fc+E.U,L.Mc=L.cc,L.Nc=L.dc+m,L.Ib=Z,Re()}}else alert("todo:EmitYUV");A&&(L.Jb=ft,l&&ee())}if(l&&!zn){for(E=0;256>E;++E)bu[E]=89858*(E-128)+vh>>_A,Bp[E]=-22014*(E-128)+vh,wh[E]=-45773*(E-128),bh[E]=113618*(E-128)+vh>>_A;for(E=Fc;E<Nd;++E)L=76283*(E-16)+vh>>_A,vA[E-Fc]=An(L,255),bA[E-Fc]=An(L+8>>4,15);zn=1}return 1}function Qt(E){var L=E.ma,m=E.U,l=E.T;return t(!(1&E.ka)),0>=m||0>=l?0:(m=L.Ib(E,L),L.Jb!=null&&L.Jb(E,L,m),L.Dc+=m,1)}function Gt(E){E.ma.memory=null}function Nt(E,L,m,l){return Yt(E,8)!=47?0:(L[0]=Yt(E,14)+1,m[0]=Yt(E,14)+1,l[0]=Yt(E,1),Yt(E,3)!=0?0:!E.h)}function Pt(E,L){if(4>E)return E+1;var m=E-2>>1;return(2+(1&E)<<m)+Yt(L,m)+1}function se(E,L){return 120<L?L-120:1<=(m=((m=Po[L-1])>>4)*E+(8-(15&m)))?m:1;var m}function he(E,L,m){var l=wt(m),A=E[L+=255&l].g-8;return 0<A&&(Ut(m,m.u+8),l=wt(m),L+=E[L].value,L+=l&(1<<A)-1),Ut(m,m.u+E[L].g),E[L].value}function Xt(E,L,m){return m.g+=E.g,m.value+=E.value<<L>>>0,t(8>=m.g),E.g}function we(E,L,m){var l=E.xc;return t((L=l==0?0:E.vc[E.md*(m>>l)+(L>>l)])<E.Wb),E.Ya[L]}function je(E,L,m,l){var A=E.ab,p=E.c*L,y=E.C;L=y+L;var v=m,S=l;for(l=E.Ta,m=E.Ua;0<A--;){var I=E.gc[A],M=y,D=L,H=v,z=S,$=(S=l,v=m,I.Ea);switch(t(M<D),t(D<=I.nc),I.hc){case 2:wc(H,z,(D-M)*$,S,v);break;case 0:var J=M,K=D,tt=S,At=v,pt=(Rt=I).Ea;J==0&&(Ll(H,z,null,null,1,tt,At),Fr(H,z+1,0,0,pt-1,tt,At+1),z+=pt,At+=pt,++J);for(var _t=1<<Rt.b,mt=_t-1,Et=Ye(pt,Rt.b),Dt=Rt.K,Rt=Rt.w+(J>>Rt.b)*Et;J<K;){var oe=Dt,ge=Rt,_e=1;for(tl(H,z,tt,At-pt,1,tt,At);_e<pt;){var Ce=(_e&~mt)+_t;Ce>pt&&(Ce=pt),(0,Yr[oe[ge++]>>8&15])(H,z+ +_e,tt,At+_e-pt,Ce-_e,tt,At+_e),_e=Ce}z+=pt,At+=pt,++J&mt||(Rt+=Et)}D!=I.nc&&n(S,v-$,S,v+(D-M-1)*$,$);break;case 1:for($=H,K=z,pt=(H=I.Ea)-(At=H&~(tt=(z=1<<I.b)-1)),J=Ye(H,I.b),_t=I.K,I=I.w+(M>>I.b)*J;M<D;){for(mt=_t,Et=I,Dt=new Le,Rt=K+At,oe=K+H;K<Rt;)de(mt[Et++],Dt),Es(Dt,$,K,z,S,v),K+=z,v+=z;K<oe&&(de(mt[Et++],Dt),Es(Dt,$,K,pt,S,v),K+=pt,v+=pt),++M&tt||(I+=J)}break;case 3:if(H==S&&z==v&&0<I.b){for(K=S,H=$=v+(D-M)*$-(At=(D-M)*Ye(I.Ea,I.b)),z=S,tt=v,J=[],At=(pt=At)-1;0<=At;--At)J[At]=z[tt+At];for(At=pt-1;0<=At;--At)K[H+At]=J[At];us(I,M,D,S,$,S,v)}else us(I,M,D,H,z,S,v)}v=l,S=m}S!=m&&n(l,m,v,S,p)}function tr(E,L){var m=E.V,l=E.Ba+E.c*E.C,A=L-E.C;if(t(L<=E.l.o),t(16>=A),0<A){var p=E.l,y=E.Ta,v=E.Ua,S=p.width;if(je(E,A,m,l),A=v=[v],t((m=E.C)<(l=L)),t(p.v<p.va),l>p.o&&(l=p.o),m<p.j){var I=p.j-m;m=p.j,A[0]+=I*S}if(m>=l?m=0:(A[0]+=4*p.v,p.ka=m-p.j,p.U=p.va-p.v,p.T=l-m,m=1),m){if(v=v[0],11>(m=E.ca).S){var M=m.f.RGBA,D=(l=m.S,A=p.U,p=p.T,I=M.eb,M.A),H=p;for(M=M.fb+E.Ma*M.A;0<H--;){var z=y,$=v,J=A,K=I,tt=M;switch(l){case fu:ea(z,$,J,K,tt);break;case Cc:el(z,$,J,K,tt);break;case gu:el(z,$,J,K,tt),Fo(K,tt,0,J,1,0);break;case yh:rl(z,$,J,K,tt);break;case Ec:Mr(z,$,J,K,tt,1);break;case Sc:Mr(z,$,J,K,tt,1),Fo(K,tt,0,J,1,0);break;case pu:Mr(z,$,J,K,tt,0);break;case mu:Mr(z,$,J,K,tt,0),Fo(K,tt,1,J,1,0);break;case pA:Ss(z,$,J,K,tt);break;case gA:Ss(z,$,J,K,tt),xi(K,tt,J,1,0);break;case Ul:Ca(z,$,J,K,tt);break;default:t(0)}v+=S,M+=D}E.Ma+=p}else alert("todo:EmitRescaledRowsYUVA");t(E.Ma<=m.height)}}E.C=L,t(E.C<=E.i)}function Qr(E){var L;if(0<E.ua)return 0;for(L=0;L<E.Wb;++L){var m=E.Ya[L].G,l=E.Ya[L].H;if(0<m[1][l[1]+0].g||0<m[2][l[2]+0].g||0<m[3][l[3]+0].g)return 0}return 1}function ir(E,L,m,l,A,p){if(E.Z!=0){var y=E.qd,v=E.rd;for(t(Ia[E.Z]!=null);L<m;++L)Ia[E.Z](y,v,l,A,l,A,p),y=l,v=A,A+=p;E.qd=y,E.rd=v}}function Or(E,L){var m=E.l.ma,l=m.Z==0||m.Z==1?E.l.j:E.C;if(l=E.C<l?l:E.C,t(L<=E.l.o),L>l){var A=E.l.width,p=m.ca,y=m.tb+A*l,v=E.V,S=E.Ba+E.c*l,I=E.gc;t(E.ab==1),t(I[0].hc==3),mh(I[0],l,L,v,S,p,y),ir(m,l,L,p,y,A)}E.C=E.Ma=L}function xr(E,L,m,l,A,p,y){var v=E.$/l,S=E.$%l,I=E.m,M=E.s,D=m+E.$,H=D;A=m+l*A;var z=m+l*p,$=280+M.ua,J=E.Pb?v:16777216,K=0<M.ua?M.Wa:null,tt=M.wc,At=D<z?we(M,S,v):null;t(E.C<p),t(z<=A);var pt=!1;t:for(;;){for(;pt||D<z;){var _t=0;if(v>=J){var mt=D-m;t((J=E).Pb),J.wd=J.m,J.xd=mt,0<J.s.ua&&le(J.s.Wa,J.s.vb),J=v+Pd}if(S&tt||(At=we(M,S,v)),t(At!=null),At.Qb&&(L[D]=At.qb,pt=!0),!pt)if(jt(I),At.jc){_t=I,mt=L;var Et=D,Dt=At.pd[wt(_t)&cs-1];t(At.jc),256>Dt.g?(Ut(_t,_t.u+Dt.g),mt[Et]=Dt.value,_t=0):(Ut(_t,_t.u+Dt.g-256),t(256<=Dt.value),_t=Dt.value),_t==0&&(pt=!0)}else _t=he(At.G[0],At.H[0],I);if(I.h)break;if(pt||256>_t){if(!pt)if(At.nd)L[D]=(At.qb|_t<<8)>>>0;else{if(jt(I),pt=he(At.G[1],At.H[1],I),jt(I),mt=he(At.G[2],At.H[2],I),Et=he(At.G[3],At.H[3],I),I.h)break;L[D]=(Et<<24|pt<<16|_t<<8|mt)>>>0}if(pt=!1,++D,++S>=l&&(S=0,++v,y!=null&&v<=p&&!(v%16)&&y(E,v),K!=null))for(;H<D;)_t=L[H++],K.X[(506832829*_t&4294967295)>>>K.Mb]=_t}else if(280>_t){if(_t=Pt(_t-256,I),mt=he(At.G[4],At.H[4],I),jt(I),mt=se(l,mt=Pt(mt,I)),I.h)break;if(D-m<mt||A-D<_t)break t;for(Et=0;Et<_t;++Et)L[D+Et]=L[D+Et-mt];for(D+=_t,S+=_t;S>=l;)S-=l,++v,y!=null&&v<=p&&!(v%16)&&y(E,v);if(t(D<=A),S&tt&&(At=we(M,S,v)),K!=null)for(;H<D;)_t=L[H++],K.X[(506832829*_t&4294967295)>>>K.Mb]=_t}else{if(!(_t<$))break t;for(pt=_t-280,t(K!=null);H<D;)_t=L[H++],K.X[(506832829*_t&4294967295)>>>K.Mb]=_t;_t=D,t(!(pt>>>(mt=K).Xa)),L[_t]=mt.X[pt],pt=!0}pt||t(I.h==Ft(I))}if(E.Pb&&I.h&&D<A)t(E.m.h),E.a=5,E.m=E.wd,E.$=E.xd,0<E.s.ua&&le(E.s.vb,E.s.Wa);else{if(I.h)break t;y!=null&&y(E,v>p?p:v),E.a=0,E.$=D-m}return 1}return E.a=3,0}function $r(E){t(E!=null),E.vc=null,E.yc=null,E.Ya=null;var L=E.Wa;L!=null&&(L.X=null),E.vb=null,t(E!=null)}function Xr(){var E=new bc;return E==null?null:(E.a=0,E.xb=Tc,_n("Predictor","VP8LPredictors"),_n("Predictor","VP8LPredictors_C"),_n("PredictorAdd","VP8LPredictorsAdd"),_n("PredictorAdd","VP8LPredictorsAdd_C"),wc=Ur,Es=ur,ea=De,el=gn,Ss=pe,Ca=gr,rl=Qe,ht.VP8LMapColor32b=Ba,ht.VP8LMapColor8b=dA,E)}function vr(E,L,m,l,A){var p=1,y=[E],v=[L],S=l.m,I=l.s,M=null,D=0;t:for(;;){if(m)for(;p&&Yt(S,1);){var H=y,z=v,$=l,J=1,K=$.m,tt=$.gc[$.ab],At=Yt(K,2);if($.Oc&1<<At)p=0;else{switch($.Oc|=1<<At,tt.hc=At,tt.Ea=H[0],tt.nc=z[0],tt.K=[null],++$.ab,t(4>=$.ab),At){case 0:case 1:tt.b=Yt(K,3)+2,J=vr(Ye(tt.Ea,tt.b),Ye(tt.nc,tt.b),0,$,tt.K),tt.K=tt.K[0];break;case 3:var pt,_t=Yt(K,8)+1,mt=16<_t?0:4<_t?1:2<_t?2:3;if(H[0]=Ye(tt.Ea,mt),tt.b=mt,pt=J=vr(_t,1,0,$,tt.K)){var Et,Dt=_t,Rt=tt,oe=1<<(8>>Rt.b),ge=s(oe);if(ge==null)pt=0;else{var _e=Rt.K[0],Ce=Rt.w;for(ge[0]=Rt.K[0][0],Et=1;Et<1*Dt;++Et)ge[Et]=ue(_e[Ce+Et],ge[Et-1]);for(;Et<4*oe;++Et)ge[Et]=0;Rt.K[0]=null,Rt.K[0]=ge,pt=1}}J=pt;break;case 2:break;default:t(0)}p=J}}if(y=y[0],v=v[0],p&&Yt(S,1)&&!(p=1<=(D=Yt(S,4))&&11>=D)){l.a=3;break t}var xe;if(xe=p)e:{var ve,Se,sr,Pe=l,Me=y,dr=v,Pr=D,Ir=m,Dr=Pe.m,Kr=Pe.s,Bn=[null],Zn=1,fn=0,hi=Sa[Pr];r:for(;;){if(Ir&&Yt(Dr,1)){var Cn=Yt(Dr,3)+2,ai=Ye(Me,Cn),Bi=Ye(dr,Cn),Is=ai*Bi;if(!vr(ai,Bi,0,Pe,Bn))break r;for(Bn=Bn[0],Kr.xc=Cn,ve=0;ve<Is;++ve){var oo=Bn[ve]>>8&65535;Bn[ve]=oo,oo>=Zn&&(Zn=oo+1)}}if(Dr.h)break r;for(Se=0;5>Se;++Se){var ti=mA[Se];!Se&&0<Pr&&(ti+=1<<Pr),fn<ti&&(fn=ti)}var Dl=a(Zn*hi,at),ao=Zn,xA=a(ao,vt);if(xA==null)var wu=null;else t(65536>=ao),wu=xA;var hs=s(fn);if(wu==null||hs==null||Dl==null){Pe.a=1;break r}var Fs=Dl;for(ve=sr=0;ve<Zn;++ve){var Vi=wu[ve],ds=Vi.G,yi=Vi.H,es=0,fs=1,an=0;for(Se=0;5>Se;++Se){ti=mA[Se],ds[Se]=Fs,yi[Se]=sr,!Se&&0<Pr&&(ti+=1<<Pr);i:{var Fa,Nl=ti,il=Pe,xu=hs,Km=Fs,Cp=sr,La=0,sl=il.m,xh=Yt(sl,1);if(i(xu,0,0,Nl),xh){var BA=Yt(sl,1)+1,Bh=Yt(sl,1),CA=Yt(sl,Bh==0?1:8);xu[CA]=1,BA==2&&(xu[CA=Yt(sl,8)]=1);var ol=1}else{var Bu=s(19),kd=Yt(sl,4)+4;if(19<kd){il.a=3;var Qd=0;break i}for(Fa=0;Fa<kd;++Fa)Bu[vp[Fa]]=Yt(sl,3);var Ep=void 0,zd=void 0,Sp=il,Hd=Bu,Lc=Nl,kl=xu,oa=0,lo=Sp.m,$m=8,Cu=a(128,at);n:for(;ot(Cu,0,7,Hd,19);){if(Yt(lo,1)){var KE=2+2*Yt(lo,3);if((Ep=2+Yt(lo,KE))>Lc)break n}else Ep=Lc;for(zd=0;zd<Lc&&Ep--;){jt(lo);var Wm=Cu[0+(127&wt(lo))];Ut(lo,lo.u+Wm.g);var ei=Wm.value;if(16>ei)kl[zd++]=ei,ei!=0&&($m=ei);else{var Xm=ei==16,Jm=ei-16,EA=Ld[Jm],Eu=Yt(lo,Fd[Jm])+EA;if(zd+Eu>Lc)break n;for(var Tp=Xm?$m:0;0<Eu--;)kl[zd++]=Tp}}oa=1;break n}oa||(Sp.a=3),ol=oa}(ol=ol&&!sl.h)&&(La=ot(Km,Cp,8,xu,Nl)),ol&&La!=0?Qd=La:(il.a=3,Qd=0)}if(Qd==0)break r;if(fs&&yu[Se]==1&&(fs=Fs[sr].g==0),es+=Fs[sr].g,sr+=Qd,3>=Se){var SA,Ip=hs[0];for(SA=1;SA<ti;++SA)hs[SA]>Ip&&(Ip=hs[SA]);an+=Ip}}if(Vi.nd=fs,Vi.Qb=0,fs&&(Vi.qb=(ds[3][yi[3]+0].value<<24|ds[1][yi[1]+0].value<<16|ds[2][yi[2]+0].value)>>>0,es==0&&256>ds[0][yi[0]+0].value&&(Vi.Qb=1,Vi.qb+=ds[0][yi[0]+0].value<<8)),Vi.jc=!Vi.Qb&&6>an,Vi.jc){var Fp,Ql=Vi;for(Fp=0;Fp<cs;++Fp){var Su=Fp,zl=Ql.pd[Su],Lp=Ql.G[0][Ql.H[0]+Su];256<=Lp.value?(zl.g=Lp.g+256,zl.value=Lp.value):(zl.g=0,zl.value=0,Su>>=Xt(Lp,8,zl),Su>>=Xt(Ql.G[1][Ql.H[1]+Su],16,zl),Su>>=Xt(Ql.G[2][Ql.H[2]+Su],0,zl),Xt(Ql.G[3][Ql.H[3]+Su],24,zl))}}}Kr.vc=Bn,Kr.Wb=Zn,Kr.Ya=wu,Kr.yc=Dl,xe=1;break e}xe=0}if(!(p=xe)){l.a=3;break t}if(0<D){if(I.ua=1<<D,!Ke(I.Wa,D)){l.a=1,p=0;break t}}else I.ua=0;var Vd=l,Ym=y,ev=v,Tu=Vd.s,Zm=Tu.xc;if(Vd.c=Ym,Vd.i=ev,Tu.md=Ye(Ym,Zm),Tu.wc=Zm==0?-1:(1<<Zm)-1,m){l.xb=vu;break t}if((M=s(y*v))==null){l.a=1,p=0;break t}p=(p=xr(l,M,0,y,v,v,null))&&!S.h;break t}return p?(A!=null?A[0]=M:(t(M==null),t(m)),l.$=0,m||$r(I)):$r(I),p}function jr(E,L){var m=E.c*E.i,l=m+L+16*L;return t(E.c<=L),E.V=s(l),E.V==null?(E.Ta=null,E.Ua=0,E.a=1,0):(E.Ta=E.V,E.Ua=E.Ba+m+L,1)}function on(E,L){var m=E.C,l=L-m,A=E.V,p=E.Ba+E.c*m;for(t(L<=E.l.o);0<l;){var y=16<l?16:l,v=E.l.ma,S=E.l.width,I=S*y,M=v.ca,D=v.tb+S*m,H=E.Ta,z=E.Ua;je(E,y,A,p),Td(H,z,M,D,I),ir(v,m,m+y,M,D,S),l-=y,A+=y*E.c,m+=y}t(m==L),E.C=E.Ma=L}function In(){this.ub=this.yd=this.td=this.Rb=0}function Mt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ne(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Ee(){this.Yb=function(){var E=[];return function L(m,l,A){for(var p=A[l],y=0;y<p&&(m.push(A.length>l+1?[]:0),!(A.length<l+1));y++)L(m[y],l+1,A)}(E,0,[3,11]),E}()}function or(){this.jb=s(3),this.Wc=o([4,8],Ee),this.Xc=o([4,17],Ee)}function Lr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Pn(){this.ld=this.La=this.dd=this.tc=0}function qr(){this.Na=this.la=0}function yn(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function mi(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function bn(){this.uc=this.M=this.Nb=0,this.wa=Array(new Pn),this.Y=0,this.ya=Array(new mi),this.aa=0,this.l=new ws}function tn(){this.y=s(16),this.f=s(8),this.ea=s(8)}function $o(){this.cb=this.a=0,this.sc="",this.m=new be,this.Od=new In,this.Kc=new Mt,this.ed=new Lr,this.Qa=new Ne,this.Ic=this.$c=this.Aa=0,this.D=new bn,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,be),this.ia=0,this.pb=a(4,yn),this.Pa=new or,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new tn),this.Hd=0,this.rb=Array(new qr),this.sb=0,this.wa=Array(new Pn),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new mi),this.L=this.aa=0,this.gd=o([4,2],Pn),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ws(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function kn(){var E=new $o;return E!=null&&(E.a=0,E.sc="OK",E.cb=0,E.Xb=0,yA||(yA=Wo)),E}function hn(E,L,m){return E.a==0&&(E.a=L,E.sc=m,E.cb=0),0}function Li(E,L,m){return 3<=m&&E[L+0]==157&&E[L+1]==1&&E[L+2]==42}function On(E,L){if(E==null)return 0;if(E.a=0,E.sc="OK",L==null)return hn(E,2,"null VP8Io passed to VP8GetHeaders()");var m=L.data,l=L.w,A=L.ha;if(4>A)return hn(E,7,"Truncated header.");var p=m[l+0]|m[l+1]<<8|m[l+2]<<16,y=E.Od;if(y.Rb=!(1&p),y.td=p>>1&7,y.yd=p>>4&1,y.ub=p>>5,3<y.td)return hn(E,3,"Incorrect keyframe parameters.");if(!y.yd)return hn(E,4,"Frame not displayable.");l+=3,A-=3;var v=E.Kc;if(y.Rb){if(7>A)return hn(E,7,"cannot parse picture header");if(!Li(m,l,A))return hn(E,3,"Bad code word");v.c=16383&(m[l+4]<<8|m[l+3]),v.Td=m[l+4]>>6,v.i=16383&(m[l+6]<<8|m[l+5]),v.Ud=m[l+6]>>6,l+=7,A-=7,E.za=v.c+15>>4,E.Ub=v.i+15>>4,L.width=v.c,L.height=v.i,L.Da=0,L.j=0,L.v=0,L.va=L.width,L.o=L.height,L.da=0,L.ib=L.width,L.hb=L.height,L.U=L.width,L.T=L.height,i((p=E.Pa).jb,0,255,p.jb.length),t((p=E.Qa)!=null),p.Cb=0,p.Bb=0,p.Fb=1,i(p.Zb,0,0,p.Zb.length),i(p.Lb,0,0,p.Lb)}if(y.ub>A)return hn(E,7,"bad partition length");$t(p=E.m,m,l,y.ub),l+=y.ub,A-=y.ub,y.Rb&&(v.Ld=re(p),v.Kd=re(p)),v=E.Qa;var S,I=E.Pa;if(t(p!=null),t(v!=null),v.Cb=re(p),v.Cb){if(v.Bb=re(p),re(p)){for(v.Fb=re(p),S=0;4>S;++S)v.Zb[S]=re(p)?Jt(p,7):0;for(S=0;4>S;++S)v.Lb[S]=re(p)?Jt(p,6):0}if(v.Bb)for(S=0;3>S;++S)I.jb[S]=re(p)?Wt(p,8):255}else v.Bb=0;if(p.Ka)return hn(E,3,"cannot parse segment header");if((v=E.ed).zd=re(p),v.Tb=Wt(p,6),v.wb=Wt(p,3),v.Pc=re(p),v.Pc&&re(p)){for(I=0;4>I;++I)re(p)&&(v.vd[I]=Jt(p,6));for(I=0;4>I;++I)re(p)&&(v.od[I]=Jt(p,6))}if(E.L=v.Tb==0?0:v.zd?1:2,p.Ka)return hn(E,3,"cannot parse filter header");var M=A;if(A=S=l,l=S+M,v=M,E.Xb=(1<<Wt(E.m,2))-1,M<3*(I=E.Xb))m=7;else{for(S+=3*I,v-=3*I,M=0;M<I;++M){var D=m[A+0]|m[A+1]<<8|m[A+2]<<16;D>v&&(D=v),$t(E.Jc[+M],m,S,D),S+=D,v-=D,A+=3}$t(E.Jc[+I],m,S,v),m=S<l?0:5}if(m!=0)return hn(E,m,"cannot parse partitions");for(m=Wt(S=E.m,7),A=re(S)?Jt(S,4):0,l=re(S)?Jt(S,4):0,v=re(S)?Jt(S,4):0,I=re(S)?Jt(S,4):0,S=re(S)?Jt(S,4):0,M=E.Qa,D=0;4>D;++D){if(M.Cb){var H=M.Zb[D];M.Fb||(H+=m)}else{if(0<D){E.pb[D]=E.pb[0];continue}H=m}var z=E.pb[D];z.Sc[0]=no[An(H+A,127)],z.Sc[1]=nl[An(H+0,127)],z.Eb[0]=2*no[An(H+l,127)],z.Eb[1]=101581*nl[An(H+v,127)]>>16,8>z.Eb[1]&&(z.Eb[1]=8),z.Qc[0]=no[An(H+I,117)],z.Qc[1]=nl[An(H+S,127)],z.lc=H+S}if(!y.Rb)return hn(E,4,"Not a key frame.");for(re(p),y=E.Pa,m=0;4>m;++m){for(A=0;8>A;++A)for(l=0;3>l;++l)for(v=0;11>v;++v)I=Zt(p,Mo[m][A][l][v])?Wt(p,8):Rd[m][A][l][v],y.Wc[m][A].Yb[l][v]=I;for(A=0;17>A;++A)y.Xc[m][A]=y.Wc[m][Je[A]]}return E.kc=re(p),E.kc&&(E.Bd=Wt(p,8)),E.cb=1}function Wo(E,L,m,l,A,p,y){var v=L[A].Yb[m];for(m=0;16>A;++A){if(!Zt(E,v[m+0]))return A;for(;!Zt(E,v[m+1]);)if(v=L[++A].Yb[0],m=0,A==16)return 16;var S=L[A+1].Yb;if(Zt(E,v[m+2])){var I=E,M=0;if(Zt(I,(H=v)[(D=m)+3]))if(Zt(I,H[D+6])){for(v=0,D=2*(M=Zt(I,H[D+8]))+(H=Zt(I,H[D+9+M])),M=0,H=jm[D];H[v];++v)M+=M+Zt(I,H[v]);M+=3+(8<<D)}else Zt(I,H[D+7])?(M=7+2*Zt(I,165),M+=Zt(I,145)):M=5+Zt(I,159);else M=Zt(I,H[D+4])?3+Zt(I,H[D+5]):2;v=S[2]}else M=1,v=S[1];S=y+bp[A],0>(I=E).b&&Vt(I);var D,H=I.b,z=(D=I.Ca>>1)-(I.I>>H)>>31;--I.b,I.Ca+=z,I.Ca|=1,I.I-=(D+1&z)<<H,p[S]=((M^z)-z)*l[(0<A)+0]}return 16}function Pi(E){var L=E.rb[E.sb-1];L.la=0,L.Na=0,i(E.zc,0,0,E.zc.length),E.ja=0}function $a(E,L){if(E==null)return 0;if(L==null)return hn(E,2,"NULL VP8Io parameter in VP8Decode().");if(!E.cb&&!On(E,L))return 0;if(t(E.cb),L.ac==null||L.ac(L)){L.ob&&(E.L=0);var m=Ol[E.L];if(E.L==2?(E.yb=0,E.zb=0):(E.yb=L.v-m>>4,E.zb=L.j-m>>4,0>E.yb&&(E.yb=0),0>E.zb&&(E.zb=0)),E.Va=L.o+15+m>>4,E.Hb=L.va+15+m>>4,E.Hb>E.za&&(E.Hb=E.za),E.Va>E.Ub&&(E.Va=E.Ub),0<E.L){var l=E.ed;for(m=0;4>m;++m){var A;if(E.Qa.Cb){var p=E.Qa.Lb[m];E.Qa.Fb||(p+=l.Tb)}else p=l.Tb;for(A=0;1>=A;++A){var y=E.gd[m][A],v=p;if(l.Pc&&(v+=l.vd[0],A&&(v+=l.od[0])),0<(v=0>v?0:63<v?63:v)){var S=v;0<l.wb&&(S=4<l.wb?S>>2:S>>1)>9-l.wb&&(S=9-l.wb),1>S&&(S=1),y.dd=S,y.tc=2*v+S,y.ld=40<=v?2:15<=v?1:0}else y.tc=0;y.La=A}}}m=0}else hn(E,6,"Frame setup failed"),m=E.a;if(m=m==0){if(m){E.$c=0,0<E.Aa||(E.Ic=Er);t:{m=E.Ic,l=4*(S=E.za);var I=32*S,M=S+1,D=0<E.L?S*(0<E.Aa?2:1):0,H=(E.Aa==2?2:1)*S;if((y=l+832+(A=3*(16*m+Ol[E.L])/2*I)+(p=E.Fa!=null&&0<E.Fa.length?E.Kc.c*E.Kc.i:0))!=y)m=0;else{if(y>E.Vb){if(E.Vb=0,E.Ec=s(y),E.Fc=0,E.Ec==null){m=hn(E,1,"no memory during frame initialization.");break t}E.Vb=y}y=E.Ec,v=E.Fc,E.Ac=y,E.Bc=v,v+=l,E.Gd=a(I,tn),E.Hd=0,E.rb=a(M+1,qr),E.sb=1,E.wa=D?a(D,Pn):null,E.Y=0,E.D.Nb=0,E.D.wa=E.wa,E.D.Y=E.Y,0<E.Aa&&(E.D.Y+=S),t(!0),E.oc=y,E.pc=v,v+=832,E.ya=a(H,mi),E.aa=0,E.D.ya=E.ya,E.D.aa=E.aa,E.Aa==2&&(E.D.aa+=S),E.R=16*S,E.B=8*S,S=(I=Ol[E.L])*E.R,I=I/2*E.B,E.sa=y,E.ta=v+S,E.qa=E.sa,E.ra=E.ta+16*m*E.R+I,E.Ha=E.qa,E.Ia=E.ra+8*m*E.B+I,E.$c=0,v+=A,E.mb=p?y:null,E.nb=p?v:null,t(v+p<=E.Fc+E.Vb),Pi(E),i(E.Ac,E.Bc,0,l),m=1}}if(m){if(L.ka=0,L.y=E.sa,L.O=E.ta,L.f=E.qa,L.N=E.ra,L.ea=E.Ha,L.Vd=E.Ia,L.fa=E.R,L.Rc=E.B,L.F=null,L.J=0,!du){for(m=-255;255>=m;++m)Id[255+m]=0>m?-m:m;for(m=-1020;1020>=m;++m)Ai[1020+m]=-128>m?-128:127<m?127:m;for(m=-112;112>=m;++m)Lo[112+m]=-16>m?-16:15<m?15:m;for(m=-255;510>=m;++m)Vs[255+m]=0>m?0:255<m?255:m;du=1}Eo=xt,xc=un,ra=Cl,As=mc,Hs=ut,Pl=Bs,So=au,Ml=vc,To=gh,Io=lu,Rl=ph,Ts=El,na=cu,Kn=cA,Qn=Jo,oi=en,wi=Yo,ro=Sd,io[0]=to,io[1]=ae,io[2]=tu,io[3]=eu,io[4]=lA,io[5]=ru,io[6]=Wa,io[7]=nu,io[8]=Cd,io[9]=dh,ia[0]=Si,ia[1]=Xe,ia[2]=zr,ia[3]=Xn,ia[4]=wn,ia[5]=yc,ia[6]=Zi,Ta[0]=_a,Ta[1]=Fe,Ta[2]=Ed,Ta[3]=iu,Ta[4]=Xa,Ta[5]=su,Ta[6]=_c,m=1}else m=0}m&&(m=function(z,$){for(z.M=0;z.M<z.Va;++z.M){var J,K=z.Jc[z.M&z.Xb],tt=z.m,At=z;for(J=0;J<At.za;++J){var pt=tt,_t=At,mt=_t.Ac,Et=_t.Bc+4*J,Dt=_t.zc,Rt=_t.ya[_t.aa+J];if(_t.Qa.Bb?Rt.$b=Zt(pt,_t.Pa.jb[0])?2+Zt(pt,_t.Pa.jb[2]):Zt(pt,_t.Pa.jb[1]):Rt.$b=0,_t.kc&&(Rt.Ad=Zt(pt,_t.Bd)),Rt.Za=!Zt(pt,145)+0,Rt.Za){var oe=Rt.Ob,ge=0;for(_t=0;4>_t;++_t){var _e,Ce=Dt[0+_t];for(_e=0;4>_e;++_e){Ce=_u[mt[Et+_e]][Ce];for(var xe=Md[Zt(pt,Ce[0])];0<xe;)xe=Md[2*xe+Zt(pt,Ce[xe])];Ce=-xe,mt[Et+_e]=Ce}n(oe,ge,mt,Et,4),ge+=4,Dt[0+_t]=Ce}}else Ce=Zt(pt,156)?Zt(pt,128)?1:3:Zt(pt,163)?2:0,Rt.Ob[0]=Ce,i(mt,Et,Ce,4),i(Dt,0,Ce,4);Rt.Dd=Zt(pt,142)?Zt(pt,114)?Zt(pt,183)?1:3:2:0}if(At.m.Ka)return hn(z,7,"Premature end-of-partition0 encountered.");for(;z.ja<z.za;++z.ja){if(At=K,pt=(tt=z).rb[tt.sb-1],mt=tt.rb[tt.sb+tt.ja],J=tt.ya[tt.aa+tt.ja],Et=tt.kc?J.Ad:0)pt.la=mt.la=0,J.Za||(pt.Na=mt.Na=0),J.Hc=0,J.Gc=0,J.ia=0;else{var ve,Se;if(pt=mt,mt=At,Et=tt.Pa.Xc,Dt=tt.ya[tt.aa+tt.ja],Rt=tt.pb[Dt.$b],_t=Dt.ad,oe=0,ge=tt.rb[tt.sb-1],Ce=_e=0,i(_t,oe,0,384),Dt.Za)var sr=0,Pe=Et[3];else{xe=s(16);var Me=pt.Na+ge.Na;if(Me=yA(mt,Et[1],Me,Rt.Eb,0,xe,0),pt.Na=ge.Na=(0<Me)+0,1<Me)Eo(xe,0,_t,oe);else{var dr=xe[0]+3>>3;for(xe=0;256>xe;xe+=16)_t[oe+xe]=dr}sr=1,Pe=Et[0]}var Pr=15&pt.la,Ir=15&ge.la;for(xe=0;4>xe;++xe){var Dr=1&Ir;for(dr=Se=0;4>dr;++dr)Pr=Pr>>1|(Dr=(Me=yA(mt,Pe,Me=Dr+(1&Pr),Rt.Sc,sr,_t,oe))>sr)<<7,Se=Se<<2|(3<Me?3:1<Me?2:_t[oe+0]!=0),oe+=16;Pr>>=4,Ir=Ir>>1|Dr<<7,_e=(_e<<8|Se)>>>0}for(Pe=Pr,sr=Ir>>4,ve=0;4>ve;ve+=2){for(Se=0,Pr=pt.la>>4+ve,Ir=ge.la>>4+ve,xe=0;2>xe;++xe){for(Dr=1&Ir,dr=0;2>dr;++dr)Me=Dr+(1&Pr),Pr=Pr>>1|(Dr=0<(Me=yA(mt,Et[2],Me,Rt.Qc,0,_t,oe)))<<3,Se=Se<<2|(3<Me?3:1<Me?2:_t[oe+0]!=0),oe+=16;Pr>>=2,Ir=Ir>>1|Dr<<5}Ce|=Se<<4*ve,Pe|=Pr<<4<<ve,sr|=(240&Ir)<<ve}pt.la=Pe,ge.la=sr,Dt.Hc=_e,Dt.Gc=Ce,Dt.ia=43690&Ce?0:Rt.ia,Et=!(_e|Ce)}if(0<tt.L&&(tt.wa[tt.Y+tt.ja]=tt.gd[J.$b][J.Za],tt.wa[tt.Y+tt.ja].La|=!Et),At.Ka)return hn(z,7,"Premature end-of-file encountered.")}if(Pi(z),tt=$,At=1,J=(K=z).D,pt=0<K.L&&K.M>=K.zb&&K.M<=K.Va,K.Aa==0)t:{if(J.M=K.M,J.uc=pt,Ya(K,J),At=1,J=(Se=K.D).Nb,pt=(Ce=Ol[K.L])*K.R,mt=Ce/2*K.B,xe=16*J*K.R,dr=8*J*K.B,Et=K.sa,Dt=K.ta-pt+xe,Rt=K.qa,_t=K.ra-mt+dr,oe=K.Ha,ge=K.Ia-mt+dr,Ir=(Pr=Se.M)==0,_e=Pr>=K.Va-1,K.Aa==2&&Ya(K,Se),Se.uc)for(Dr=(Me=K).D.M,t(Me.D.uc),Se=Me.yb;Se<Me.Hb;++Se){sr=Se,Pe=Dr;var Kr=(Bn=(ti=Me).D).Nb;ve=ti.R;var Bn=Bn.wa[Bn.Y+sr],Zn=ti.sa,fn=ti.ta+16*Kr*ve+16*sr,hi=Bn.dd,Cn=Bn.tc;if(Cn!=0)if(t(3<=Cn),ti.L==1)0<sr&&oi(Zn,fn,ve,Cn+4),Bn.La&&ro(Zn,fn,ve,Cn),0<Pe&&Qn(Zn,fn,ve,Cn+4),Bn.La&&wi(Zn,fn,ve,Cn);else{var ai=ti.B,Bi=ti.qa,Is=ti.ra+8*Kr*ai+8*sr,oo=ti.Ha,ti=ti.Ia+8*Kr*ai+8*sr;Kr=Bn.ld,0<sr&&(Ml(Zn,fn,ve,Cn+4,hi,Kr),Io(Bi,Is,oo,ti,ai,Cn+4,hi,Kr)),Bn.La&&(Ts(Zn,fn,ve,Cn,hi,Kr),Kn(Bi,Is,oo,ti,ai,Cn,hi,Kr)),0<Pe&&(So(Zn,fn,ve,Cn+4,hi,Kr),To(Bi,Is,oo,ti,ai,Cn+4,hi,Kr)),Bn.La&&(Rl(Zn,fn,ve,Cn,hi,Kr),na(Bi,Is,oo,ti,ai,Cn,hi,Kr))}}if(K.ia&&alert("todo:DitherRow"),tt.put!=null){if(Se=16*Pr,Pr=16*(Pr+1),Ir?(tt.y=K.sa,tt.O=K.ta+xe,tt.f=K.qa,tt.N=K.ra+dr,tt.ea=K.Ha,tt.W=K.Ia+dr):(Se-=Ce,tt.y=Et,tt.O=Dt,tt.f=Rt,tt.N=_t,tt.ea=oe,tt.W=ge),_e||(Pr-=Ce),Pr>tt.o&&(Pr=tt.o),tt.F=null,tt.J=null,K.Fa!=null&&0<K.Fa.length&&Se<Pr&&(tt.J=hu(K,tt,Se,Pr-Se),tt.F=K.mb,tt.F==null&&tt.F.length==0)){At=hn(K,3,"Could not decode alpha data.");break t}Se<tt.j&&(Ce=tt.j-Se,Se=tt.j,t(!(1&Ce)),tt.O+=K.R*Ce,tt.N+=K.B*(Ce>>1),tt.W+=K.B*(Ce>>1),tt.F!=null&&(tt.J+=tt.width*Ce)),Se<Pr&&(tt.O+=tt.v,tt.N+=tt.v>>1,tt.W+=tt.v>>1,tt.F!=null&&(tt.J+=tt.v),tt.ka=Se-tt.j,tt.U=tt.va-tt.v,tt.T=Pr-Se,At=tt.put(tt))}J+1!=K.Ic||_e||(n(K.sa,K.ta-pt,Et,Dt+16*K.R,pt),n(K.qa,K.ra-mt,Rt,_t+8*K.B,mt),n(K.Ha,K.Ia-mt,oe,ge+8*K.B,mt))}if(!At)return hn(z,6,"Output aborted.")}return 1}(E,L)),L.bc!=null&&L.bc(L),m&=1}return m?(E.cb=0,m):0}function qn(E,L,m,l,A){A=E[L+m+32*l]+(A>>3),E[L+m+32*l]=-256&A?0>A?0:255:A}function xs(E,L,m,l,A,p){qn(E,L,0,m,l+A),qn(E,L,1,m,l+p),qn(E,L,2,m,l-p),qn(E,L,3,m,l-A)}function Mi(E){return(20091*E>>16)+E}function Qs(E,L,m,l){var A,p=0,y=s(16);for(A=0;4>A;++A){var v=E[L+0]+E[L+8],S=E[L+0]-E[L+8],I=(35468*E[L+4]>>16)-Mi(E[L+12]),M=Mi(E[L+4])+(35468*E[L+12]>>16);y[p+0]=v+M,y[p+1]=S+I,y[p+2]=S-I,y[p+3]=v-M,p+=4,L++}for(A=p=0;4>A;++A)v=(E=y[p+0]+4)+y[p+8],S=E-y[p+8],I=(35468*y[p+4]>>16)-Mi(y[p+12]),qn(m,l,0,0,v+(M=Mi(y[p+4])+(35468*y[p+12]>>16))),qn(m,l,1,0,S+I),qn(m,l,2,0,S-I),qn(m,l,3,0,v-M),p++,l+=32}function Bs(E,L,m,l){var A=E[L+0]+4,p=35468*E[L+4]>>16,y=Mi(E[L+4]),v=35468*E[L+1]>>16;xs(m,l,0,A+y,E=Mi(E[L+1]),v),xs(m,l,1,A+p,E,v),xs(m,l,2,A-p,E,v),xs(m,l,3,A-y,E,v)}function un(E,L,m,l,A){Qs(E,L,m,l),A&&Qs(E,L+16,m,l+4)}function Cl(E,L,m,l){xc(E,L+0,m,l,1),xc(E,L+32,m,l+128,1)}function mc(E,L,m,l){var A;for(E=E[L+0]+4,A=0;4>A;++A)for(L=0;4>L;++L)qn(m,l,L,A,E)}function ut(E,L,m,l){E[L+0]&&As(E,L+0,m,l),E[L+16]&&As(E,L+16,m,l+4),E[L+32]&&As(E,L+32,m,l+128),E[L+48]&&As(E,L+48,m,l+128+4)}function xt(E,L,m,l){var A,p=s(16);for(A=0;4>A;++A){var y=E[L+0+A]+E[L+12+A],v=E[L+4+A]+E[L+8+A],S=E[L+4+A]-E[L+8+A],I=E[L+0+A]-E[L+12+A];p[0+A]=y+v,p[8+A]=y-v,p[4+A]=I+S,p[12+A]=I-S}for(A=0;4>A;++A)y=(E=p[0+4*A]+3)+p[3+4*A],v=p[1+4*A]+p[2+4*A],S=p[1+4*A]-p[2+4*A],I=E-p[3+4*A],m[l+0]=y+v>>3,m[l+16]=I+S>>3,m[l+32]=y-v>>3,m[l+48]=I-S>>3,l+=64}function kt(E,L,m){var l,A=L-32,p=Hi,y=255-E[A-1];for(l=0;l<m;++l){var v,S=p,I=y+E[L-1];for(v=0;v<m;++v)E[L+v]=S[I+E[A+v]];L+=32}}function ae(E,L){kt(E,L,4)}function Fe(E,L){kt(E,L,8)}function Xe(E,L){kt(E,L,16)}function zr(E,L){var m;for(m=0;16>m;++m)n(E,L+32*m,E,L-32,16)}function Xn(E,L){var m;for(m=16;0<m;--m)i(E,L,E[L-1],16),L+=32}function Jn(E,L,m){var l;for(l=0;16>l;++l)i(L,m+32*l,E,16)}function Si(E,L){var m,l=16;for(m=0;16>m;++m)l+=E[L-1+32*m]+E[L+m-32];Jn(l>>5,E,L)}function wn(E,L){var m,l=8;for(m=0;16>m;++m)l+=E[L-1+32*m];Jn(l>>4,E,L)}function yc(E,L){var m,l=8;for(m=0;16>m;++m)l+=E[L+m-32];Jn(l>>4,E,L)}function Zi(E,L){Jn(128,E,L)}function Br(E,L,m){return E+2*L+m+2>>2}function tu(E,L){var m,l=L-32;for(l=new Uint8Array([Br(E[l-1],E[l+0],E[l+1]),Br(E[l+0],E[l+1],E[l+2]),Br(E[l+1],E[l+2],E[l+3]),Br(E[l+2],E[l+3],E[l+4])]),m=0;4>m;++m)n(E,L+32*m,l,0,l.length)}function eu(E,L){var m=E[L-1],l=E[L-1+32],A=E[L-1+64],p=E[L-1+96];Be(E,L+0,16843009*Br(E[L-1-32],m,l)),Be(E,L+32,16843009*Br(m,l,A)),Be(E,L+64,16843009*Br(l,A,p)),Be(E,L+96,16843009*Br(A,p,p))}function to(E,L){var m,l=4;for(m=0;4>m;++m)l+=E[L+m-32]+E[L-1+32*m];for(l>>=3,m=0;4>m;++m)i(E,L+32*m,l,4)}function lA(E,L){var m=E[L-1+0],l=E[L-1+32],A=E[L-1+64],p=E[L-1-32],y=E[L+0-32],v=E[L+1-32],S=E[L+2-32],I=E[L+3-32];E[L+0+96]=Br(l,A,E[L-1+96]),E[L+1+96]=E[L+0+64]=Br(m,l,A),E[L+2+96]=E[L+1+64]=E[L+0+32]=Br(p,m,l),E[L+3+96]=E[L+2+64]=E[L+1+32]=E[L+0+0]=Br(y,p,m),E[L+3+64]=E[L+2+32]=E[L+1+0]=Br(v,y,p),E[L+3+32]=E[L+2+0]=Br(S,v,y),E[L+3+0]=Br(I,S,v)}function Wa(E,L){var m=E[L+1-32],l=E[L+2-32],A=E[L+3-32],p=E[L+4-32],y=E[L+5-32],v=E[L+6-32],S=E[L+7-32];E[L+0+0]=Br(E[L+0-32],m,l),E[L+1+0]=E[L+0+32]=Br(m,l,A),E[L+2+0]=E[L+1+32]=E[L+0+64]=Br(l,A,p),E[L+3+0]=E[L+2+32]=E[L+1+64]=E[L+0+96]=Br(A,p,y),E[L+3+32]=E[L+2+64]=E[L+1+96]=Br(p,y,v),E[L+3+64]=E[L+2+96]=Br(y,v,S),E[L+3+96]=Br(v,S,S)}function ru(E,L){var m=E[L-1+0],l=E[L-1+32],A=E[L-1+64],p=E[L-1-32],y=E[L+0-32],v=E[L+1-32],S=E[L+2-32],I=E[L+3-32];E[L+0+0]=E[L+1+64]=p+y+1>>1,E[L+1+0]=E[L+2+64]=y+v+1>>1,E[L+2+0]=E[L+3+64]=v+S+1>>1,E[L+3+0]=S+I+1>>1,E[L+0+96]=Br(A,l,m),E[L+0+64]=Br(l,m,p),E[L+0+32]=E[L+1+96]=Br(m,p,y),E[L+1+32]=E[L+2+96]=Br(p,y,v),E[L+2+32]=E[L+3+96]=Br(y,v,S),E[L+3+32]=Br(v,S,I)}function nu(E,L){var m=E[L+0-32],l=E[L+1-32],A=E[L+2-32],p=E[L+3-32],y=E[L+4-32],v=E[L+5-32],S=E[L+6-32],I=E[L+7-32];E[L+0+0]=m+l+1>>1,E[L+1+0]=E[L+0+64]=l+A+1>>1,E[L+2+0]=E[L+1+64]=A+p+1>>1,E[L+3+0]=E[L+2+64]=p+y+1>>1,E[L+0+32]=Br(m,l,A),E[L+1+32]=E[L+0+96]=Br(l,A,p),E[L+2+32]=E[L+1+96]=Br(A,p,y),E[L+3+32]=E[L+2+96]=Br(p,y,v),E[L+3+64]=Br(y,v,S),E[L+3+96]=Br(v,S,I)}function dh(E,L){var m=E[L-1+0],l=E[L-1+32],A=E[L-1+64],p=E[L-1+96];E[L+0+0]=m+l+1>>1,E[L+2+0]=E[L+0+32]=l+A+1>>1,E[L+2+32]=E[L+0+64]=A+p+1>>1,E[L+1+0]=Br(m,l,A),E[L+3+0]=E[L+1+32]=Br(l,A,p),E[L+3+32]=E[L+1+64]=Br(A,p,p),E[L+3+64]=E[L+2+64]=E[L+0+96]=E[L+1+96]=E[L+2+96]=E[L+3+96]=p}function Cd(E,L){var m=E[L-1+0],l=E[L-1+32],A=E[L-1+64],p=E[L-1+96],y=E[L-1-32],v=E[L+0-32],S=E[L+1-32],I=E[L+2-32];E[L+0+0]=E[L+2+32]=m+y+1>>1,E[L+0+32]=E[L+2+64]=l+m+1>>1,E[L+0+64]=E[L+2+96]=A+l+1>>1,E[L+0+96]=p+A+1>>1,E[L+3+0]=Br(v,S,I),E[L+2+0]=Br(y,v,S),E[L+1+0]=E[L+3+32]=Br(m,y,v),E[L+1+32]=E[L+3+64]=Br(l,m,y),E[L+1+64]=E[L+3+96]=Br(A,l,m),E[L+1+96]=Br(p,A,l)}function Ed(E,L){var m;for(m=0;8>m;++m)n(E,L+32*m,E,L-32,8)}function iu(E,L){var m;for(m=0;8>m;++m)i(E,L,E[L-1],8),L+=32}function Xo(E,L,m){var l;for(l=0;8>l;++l)i(L,m+32*l,E,8)}function _a(E,L){var m,l=8;for(m=0;8>m;++m)l+=E[L+m-32]+E[L-1+32*m];Xo(l>>4,E,L)}function su(E,L){var m,l=4;for(m=0;8>m;++m)l+=E[L+m-32];Xo(l>>3,E,L)}function Xa(E,L){var m,l=4;for(m=0;8>m;++m)l+=E[L-1+32*m];Xo(l>>3,E,L)}function _c(E,L){Xo(128,E,L)}function Cs(E,L,m){var l=E[L-m],A=E[L+0],p=3*(A-l)+fA[1020+E[L-2*m]-E[L+m]],y=Bc[112+(p+4>>3)];E[L-m]=Hi[255+l+Bc[112+(p+3>>3)]],E[L+0]=Hi[255+A-y]}function fh(E,L,m,l){var A=E[L+0],p=E[L+m];return Ti[255+E[L-2*m]-E[L-m]]>l||Ti[255+p-A]>l}function ou(E,L,m,l){return 4*Ti[255+E[L-m]-E[L+0]]+Ti[255+E[L-2*m]-E[L+m]]<=l}function va(E,L,m,l,A){var p=E[L-3*m],y=E[L-2*m],v=E[L-m],S=E[L+0],I=E[L+m],M=E[L+2*m],D=E[L+3*m];return 4*Ti[255+v-S]+Ti[255+y-I]>l?0:Ti[255+E[L-4*m]-p]<=A&&Ti[255+p-y]<=A&&Ti[255+y-v]<=A&&Ti[255+D-M]<=A&&Ti[255+M-I]<=A&&Ti[255+I-S]<=A}function Jo(E,L,m,l){var A=2*l+1;for(l=0;16>l;++l)ou(E,L+l,m,A)&&Cs(E,L+l,m)}function en(E,L,m,l){var A=2*l+1;for(l=0;16>l;++l)ou(E,L+l*m,1,A)&&Cs(E,L+l*m,1)}function Yo(E,L,m,l){var A;for(A=3;0<A;--A)Jo(E,L+=4*m,m,l)}function Sd(E,L,m,l){var A;for(A=3;0<A;--A)en(E,L+=4,m,l)}function eo(E,L,m,l,A,p,y,v){for(p=2*p+1;0<A--;){if(va(E,L,m,p,y))if(fh(E,L,m,v))Cs(E,L,m);else{var S=E,I=L,M=m,D=S[I-2*M],H=S[I-M],z=S[I+0],$=S[I+M],J=S[I+2*M],K=27*(At=fA[1020+3*(z-H)+fA[1020+D-$]])+63>>7,tt=18*At+63>>7,At=9*At+63>>7;S[I-3*M]=Hi[255+S[I-3*M]+At],S[I-2*M]=Hi[255+D+tt],S[I-M]=Hi[255+H+K],S[I+0]=Hi[255+z-K],S[I+M]=Hi[255+$-tt],S[I+2*M]=Hi[255+J-At]}L+=l}}function Zo(E,L,m,l,A,p,y,v){for(p=2*p+1;0<A--;){if(va(E,L,m,p,y))if(fh(E,L,m,v))Cs(E,L,m);else{var S=E,I=L,M=m,D=S[I-M],H=S[I+0],z=S[I+M],$=Bc[112+((J=3*(H-D))+4>>3)],J=Bc[112+(J+3>>3)],K=$+1>>1;S[I-2*M]=Hi[255+S[I-2*M]+K],S[I-M]=Hi[255+D+J],S[I+0]=Hi[255+H-$],S[I+M]=Hi[255+z-K]}L+=l}}function au(E,L,m,l,A,p){eo(E,L,m,1,16,l,A,p)}function vc(E,L,m,l,A,p){eo(E,L,1,m,16,l,A,p)}function ph(E,L,m,l,A,p){var y;for(y=3;0<y;--y)Zo(E,L+=4*m,m,1,16,l,A,p)}function El(E,L,m,l,A,p){var y;for(y=3;0<y;--y)Zo(E,L+=4,1,m,16,l,A,p)}function gh(E,L,m,l,A,p,y,v){eo(E,L,A,1,8,p,y,v),eo(m,l,A,1,8,p,y,v)}function lu(E,L,m,l,A,p,y,v){eo(E,L,1,A,8,p,y,v),eo(m,l,1,A,8,p,y,v)}function cu(E,L,m,l,A,p,y,v){Zo(E,L+4*A,A,1,8,p,y,v),Zo(m,l+4*A,A,1,8,p,y,v)}function cA(E,L,m,l,A,p,y,v){Zo(E,L+4,1,A,8,p,y,v),Zo(m,l+4,1,A,8,p,y,v)}function Bo(){this.ba=new vn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ct,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function uu(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function uA(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function AA(){this.ua=0,this.Wa=new st,this.vb=new st,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new vt,this.yc=new at}function bc(){this.xb=this.a=0,this.l=new ws,this.ca=new vn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new it,this.Pb=0,this.wd=new it,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new AA,this.ab=0,this.gc=a(4,uA),this.Oc=0}function Au(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ws,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ba(E,L,m,l,A,p,y){for(E=E==null?0:E[L+0],L=0;L<y;++L)A[p+L]=E+m[l+L]&255,E=A[p+L]}function hA(E,L,m,l,A,p,y){var v;if(E==null)ba(null,null,m,l,A,p,y);else for(v=0;v<y;++v)A[p+v]=E[L+v]+m[l+v]&255}function Sl(E,L,m,l,A,p,y){if(E==null)ba(null,null,m,l,A,p,y);else{var v,S=E[L+0],I=S,M=S;for(v=0;v<y;++v)I=M+(S=E[L+v])-I,M=m[l+v]+(-256&I?0>I?0:255:I)&255,I=S,A[p+v]=M}}function hu(E,L,m,l){var A=L.width,p=L.o;if(t(E!=null&&L!=null),0>m||0>=l||m+l>p)return null;if(!E.Cc){if(E.ga==null){var y;if(E.ga=new Au,(y=E.ga==null)||(y=L.width*L.o,t(E.Gb.length==0),E.Gb=s(y),E.Uc=0,E.Gb==null?y=0:(E.mb=E.Gb,E.nb=E.Uc,E.rc=null,y=1),y=!y),!y){y=E.ga;var v=E.Fa,S=E.P,I=E.qc,M=E.mb,D=E.nb,H=S+1,z=I-1,$=y.l;if(t(v!=null&&M!=null&&L!=null),Ia[0]=null,Ia[1]=ba,Ia[2]=hA,Ia[3]=Sl,y.ca=M,y.tb=D,y.c=L.width,y.i=L.height,t(0<y.c&&0<y.i),1>=I)L=0;else if(y.$a=v[S+0]>>0&3,y.Z=v[S+0]>>2&3,y.Lc=v[S+0]>>4&3,S=v[S+0]>>6&3,0>y.$a||1<y.$a||4<=y.Z||1<y.Lc||S)L=0;else if($.put=Qt,$.ac=Bt,$.bc=Gt,$.ma=y,$.width=L.width,$.height=L.height,$.Da=L.Da,$.v=L.v,$.va=L.va,$.j=L.j,$.o=L.o,y.$a)t:{t(y.$a==1),L=Xr();e:for(;;){if(L==null){L=0;break t}if(t(y!=null),y.mc=L,L.c=y.c,L.i=y.i,L.l=y.l,L.l.ma=y,L.l.width=y.c,L.l.height=y.i,L.a=0,qt(L.m,v,H,z),!vr(y.c,y.i,1,L,null)||(L.ab==1&&L.gc[0].hc==3&&Qr(L.s)?(y.ic=1,v=L.c*L.i,L.Ta=null,L.Ua=0,L.V=s(v),L.Ba=0,L.V==null?(L.a=1,L=0):L=1):(y.ic=0,L=jr(L,y.c)),!L))break e;L=1;break t}y.mc=null,L=0}else L=z>=y.c*y.i;y=!L}if(y)return null;E.ga.Lc!=1?E.Ga=0:l=p-m}t(E.ga!=null),t(m+l<=p);t:{if(L=(v=E.ga).c,p=v.l.o,v.$a==0){if(H=E.rc,z=E.Vc,$=E.Fa,S=E.P+1+m*L,I=E.mb,M=E.nb+m*L,t(S<=E.P+E.qc),v.Z!=0)for(t(Ia[v.Z]!=null),y=0;y<l;++y)Ia[v.Z](H,z,$,S,I,M,L),H=I,z=M,M+=L,S+=L;else for(y=0;y<l;++y)n(I,M,$,S,L),H=I,z=M,M+=L,S+=L;E.rc=H,E.Vc=z}else{if(t(v.mc!=null),L=m+l,t((y=v.mc)!=null),t(L<=y.i),y.C>=L)L=1;else if(v.ic||ee(),v.ic){v=y.V,H=y.Ba,z=y.c;var J=y.i,K=($=1,S=y.$/z,I=y.$%z,M=y.m,D=y.s,y.$),tt=z*J,At=z*L,pt=D.wc,_t=K<At?we(D,I,S):null;t(K<=tt),t(L<=J),t(Qr(D));e:for(;;){for(;!M.h&&K<At;){if(I&pt||(_t=we(D,I,S)),t(_t!=null),jt(M),256>(J=he(_t.G[0],_t.H[0],M)))v[H+K]=J,++K,++I>=z&&(I=0,++S<=L&&!(S%16)&&Or(y,S));else{if(!(280>J)){$=0;break e}J=Pt(J-256,M);var mt,Et=he(_t.G[4],_t.H[4],M);if(jt(M),!(K>=(Et=se(z,Et=Pt(Et,M)))&&tt-K>=J)){$=0;break e}for(mt=0;mt<J;++mt)v[H+K+mt]=v[H+K+mt-Et];for(K+=J,I+=J;I>=z;)I-=z,++S<=L&&!(S%16)&&Or(y,S);K<At&&I&pt&&(_t=we(D,I,S))}t(M.h==Ft(M))}Or(y,S>L?L:S);break e}!$||M.h&&K<tt?($=0,y.a=M.h?5:3):y.$=K,L=$}else L=xr(y,y.V,y.Ba,y.c,y.i,L,on);if(!L){l=0;break t}}m+l>=p&&(E.Cc=1),l=1}if(!l)return null;if(E.Cc&&((l=E.ga)!=null&&(l.mc=null),E.ga=null,0<E.Ga))return alert("todo:WebPDequantizeLevels"),null}return E.nb+m*A}function O(E,L,m,l,A,p){for(;0<A--;){var y,v=E,S=L+(m?1:0),I=E,M=L+(m?0:3);for(y=0;y<l;++y){var D=I[M+4*y];D!=255&&(D*=32897,v[S+4*y+0]=v[S+4*y+0]*D>>23,v[S+4*y+1]=v[S+4*y+1]*D>>23,v[S+4*y+2]=v[S+4*y+2]*D>>23)}L+=p}}function nt(E,L,m,l,A){for(;0<l--;){var p;for(p=0;p<m;++p){var y=E[L+2*p+0],v=15&(I=E[L+2*p+1]),S=4369*v,I=(240&I|I>>4)*S>>16;E[L+2*p+0]=(240&y|y>>4)*S>>16&240|(15&y|y<<4)*S>>16>>4&15,E[L+2*p+1]=240&I|v}L+=A}}function Lt(E,L,m,l,A,p,y,v){var S,I,M=255;for(I=0;I<A;++I){for(S=0;S<l;++S){var D=E[L+S];p[y+4*S]=D,M&=D}L+=m,y+=v}return M!=255}function Ht(E,L,m,l,A){var p;for(p=0;p<A;++p)m[l+p]=E[L+p]>>8}function ee(){Fo=O,xi=nt,Ea=Lt,Td=Ht}function Ae(E,L,m){ht[E]=function(l,A,p,y,v,S,I,M,D,H,z,$,J,K,tt,At,pt){var _t,mt=pt-1>>1,Et=v[S+0]|I[M+0]<<16,Dt=D[H+0]|z[$+0]<<16;t(l!=null);var Rt=3*Et+Dt+131074>>2;for(L(l[A+0],255&Rt,Rt>>16,J,K),p!=null&&(Rt=3*Dt+Et+131074>>2,L(p[y+0],255&Rt,Rt>>16,tt,At)),_t=1;_t<=mt;++_t){var oe=v[S+_t]|I[M+_t]<<16,ge=D[H+_t]|z[$+_t]<<16,_e=Et+oe+Dt+ge+524296,Ce=_e+2*(oe+Dt)>>3;Rt=Ce+Et>>1,Et=(_e=_e+2*(Et+ge)>>3)+oe>>1,L(l[A+2*_t-1],255&Rt,Rt>>16,J,K+(2*_t-1)*m),L(l[A+2*_t-0],255&Et,Et>>16,J,K+(2*_t-0)*m),p!=null&&(Rt=_e+Dt>>1,Et=Ce+ge>>1,L(p[y+2*_t-1],255&Rt,Rt>>16,tt,At+(2*_t-1)*m),L(p[y+2*_t+0],255&Et,Et>>16,tt,At+(2*_t+0)*m)),Et=oe,Dt=ge}1&pt||(Rt=3*Et+Dt+131074>>2,L(l[A+pt-1],255&Rt,Rt>>16,J,K+(pt-1)*m),p!=null&&(Rt=3*Dt+Et+131074>>2,L(p[y+pt-1],255&Rt,Rt>>16,tt,At+(pt-1)*m)))}}function Re(){kr[fu]=Ud,kr[Cc]=_h,kr[yh]=qm,kr[Ec]=wp,kr[pu]=Ic,kr[pA]=Od,kr[Ul]=Dd,kr[gu]=_h,kr[Sc]=wp,kr[mu]=Ic,kr[gA]=Od}function er(E){return E&~so?0>E?0:255:E>>xp}function Tr(E,L){return er((19077*E>>8)+(26149*L>>8)-14234)}function Hr(E,L,m){return er((19077*E>>8)-(6419*L>>8)-(13320*m>>8)+8708)}function Wr(E,L){return er((19077*E>>8)+(33050*L>>8)-17685)}function rn(E,L,m,l,A){l[A+0]=Tr(E,m),l[A+1]=Hr(E,L,m),l[A+2]=Wr(E,L)}function Yn(E,L,m,l,A){l[A+0]=Wr(E,L),l[A+1]=Hr(E,L,m),l[A+2]=Tr(E,m)}function bi(E,L,m,l,A){var p=Hr(E,L,m);L=p<<3&224|Wr(E,L)>>3,l[A+0]=248&Tr(E,m)|p>>5,l[A+1]=L}function Jr(E,L,m,l,A){var p=240&Wr(E,L)|15;l[A+0]=240&Tr(E,m)|Hr(E,L,m)>>4,l[A+1]=p}function ls(E,L,m,l,A){l[A+0]=255,rn(E,L,m,l,A+1)}function Cr(E,L,m,l,A){Yn(E,L,m,l,A),l[A+3]=255}function zs(E,L,m,l,A){rn(E,L,m,l,A),l[A+3]=255}function An(E,L){return 0>E?0:E>L?L:E}function dn(E,L,m){ht[E]=function(l,A,p,y,v,S,I,M,D){for(var H=M+(-2&D)*m;M!=H;)L(l[A+0],p[y+0],v[S+0],I,M),L(l[A+1],p[y+0],v[S+0],I,M+m),A+=2,++y,++S,M+=2*m;1&D&&L(l[A+0],p[y+0],v[S+0],I,M)}}function wa(E,L,m){return m==0?E==0?L==0?6:5:L==0?4:0:m}function Ja(E,L,m,l,A){switch(E>>>30){case 3:xc(L,m,l,A,0);break;case 2:Pl(L,m,l,A);break;case 1:As(L,m,l,A)}}function Ya(E,L){var m,l,A=L.M,p=L.Nb,y=E.oc,v=E.pc+40,S=E.oc,I=E.pc+584,M=E.oc,D=E.pc+600;for(m=0;16>m;++m)y[v+32*m-1]=129;for(m=0;8>m;++m)S[I+32*m-1]=129,M[D+32*m-1]=129;for(0<A?y[v-1-32]=S[I-1-32]=M[D-1-32]=129:(i(y,v-32-1,127,21),i(S,I-32-1,127,9),i(M,D-32-1,127,9)),l=0;l<E.za;++l){var H=L.ya[L.aa+l];if(0<l){for(m=-1;16>m;++m)n(y,v+32*m-4,y,v+32*m+12,4);for(m=-1;8>m;++m)n(S,I+32*m-4,S,I+32*m+4,4),n(M,D+32*m-4,M,D+32*m+4,4)}var z=E.Gd,$=E.Hd+l,J=H.ad,K=H.Hc;if(0<A&&(n(y,v-32,z[$].y,0,16),n(S,I-32,z[$].f,0,8),n(M,D-32,z[$].ea,0,8)),H.Za){var tt=y,At=v-32+16;for(0<A&&(l>=E.za-1?i(tt,At,z[$].y[15],4):n(tt,At,z[$+1].y,0,4)),m=0;4>m;m++)tt[At+128+m]=tt[At+256+m]=tt[At+384+m]=tt[At+0+m];for(m=0;16>m;++m,K<<=2)tt=y,At=v+sa[m],io[H.Ob[m]](tt,At),Ja(K,J,16*+m,tt,At)}else if(tt=wa(l,A,H.Ob[0]),ia[tt](y,v),K!=0)for(m=0;16>m;++m,K<<=2)Ja(K,J,16*+m,y,v+sa[m]);for(m=H.Gc,tt=wa(l,A,H.Dd),Ta[tt](S,I),Ta[tt](M,D),K=J,tt=S,At=I,255&(H=m>>0)&&(170&H?ra(K,256,tt,At):Hs(K,256,tt,At)),H=M,K=D,255&(m>>=8)&&(170&m?ra(J,320,H,K):Hs(J,320,H,K)),A<E.Ub-1&&(n(z[$].y,0,y,v+480,16),n(z[$].f,0,S,I+224,8),n(z[$].ea,0,M,D+224,8)),m=8*p*E.B,z=E.sa,$=E.ta+16*l+16*p*E.R,J=E.qa,H=E.ra+8*l+m,K=E.Ha,tt=E.Ia+8*l+m,m=0;16>m;++m)n(z,$+m*E.R,y,v+32*m,16);for(m=0;8>m;++m)n(J,H+m*E.B,S,I+32*m,8),n(K,tt+m*E.B,M,D+32*m,8)}}function Tl(E,L,m,l,A,p,y,v,S){var I=[0],M=[0],D=0,H=S!=null?S.kd:0,z=S??new uu;if(E==null||12>m)return 7;z.data=E,z.w=L,z.ha=m,L=[L],m=[m],z.gb=[z.gb];t:{var $=L,J=m,K=z.gb;if(t(E!=null),t(J!=null),t(K!=null),K[0]=0,12<=J[0]&&!e(E,$[0],"RIFF")){if(e(E,$[0]+8,"WEBP")){K=3;break t}var tt=He(E,$[0]+4);if(12>tt||4294967286<tt){K=3;break t}if(H&&tt>J[0]-8){K=7;break t}K[0]=tt,$[0]+=12,J[0]-=12}K=0}if(K!=0)return K;for(tt=0<z.gb[0],m=m[0];;){t:{var At=E;J=L,K=m;var pt=I,_t=M,mt=$=[0];if((Rt=D=[D])[0]=0,8>K[0])K=7;else{if(!e(At,J[0],"VP8X")){if(He(At,J[0]+4)!=10){K=3;break t}if(18>K[0]){K=7;break t}var Et=He(At,J[0]+8),Dt=1+ke(At,J[0]+12);if(2147483648<=Dt*(At=1+ke(At,J[0]+15))){K=3;break t}mt!=null&&(mt[0]=Et),pt!=null&&(pt[0]=Dt),_t!=null&&(_t[0]=At),J[0]+=18,K[0]-=18,Rt[0]=1}K=0}}if(D=D[0],$=$[0],K!=0)return K;if(J=!!(2&$),!tt&&D)return 3;if(p!=null&&(p[0]=!!(16&$)),y!=null&&(y[0]=J),v!=null&&(v[0]=0),y=I[0],$=M[0],D&&J&&S==null){K=0;break}if(4>m){K=7;break}if(tt&&D||!tt&&!D&&!e(E,L[0],"ALPH")){m=[m],z.na=[z.na],z.P=[z.P],z.Sa=[z.Sa];t:{Et=E,K=L,tt=m;var Rt=z.gb;pt=z.na,_t=z.P,mt=z.Sa,Dt=22,t(Et!=null),t(tt!=null),At=K[0];var oe=tt[0];for(t(pt!=null),t(mt!=null),pt[0]=null,_t[0]=null,mt[0]=0;;){if(K[0]=At,tt[0]=oe,8>oe){K=7;break t}var ge=He(Et,At+4);if(4294967286<ge){K=3;break t}var _e=8+ge+1&-2;if(Dt+=_e,0<Rt&&Dt>Rt){K=3;break t}if(!e(Et,At,"VP8 ")||!e(Et,At,"VP8L")){K=0;break t}if(oe[0]<_e){K=7;break t}e(Et,At,"ALPH")||(pt[0]=Et,_t[0]=At+8,mt[0]=ge),At+=_e,oe-=_e}}if(m=m[0],z.na=z.na[0],z.P=z.P[0],z.Sa=z.Sa[0],K!=0)break}m=[m],z.Ja=[z.Ja],z.xa=[z.xa];t:if(Rt=E,K=L,tt=m,pt=z.gb[0],_t=z.Ja,mt=z.xa,Et=K[0],At=!e(Rt,Et,"VP8 "),Dt=!e(Rt,Et,"VP8L"),t(Rt!=null),t(tt!=null),t(_t!=null),t(mt!=null),8>tt[0])K=7;else{if(At||Dt){if(Rt=He(Rt,Et+4),12<=pt&&Rt>pt-12){K=3;break t}if(H&&Rt>tt[0]-8){K=7;break t}_t[0]=Rt,K[0]+=8,tt[0]-=8,mt[0]=Dt}else mt[0]=5<=tt[0]&&Rt[Et+0]==47&&!(Rt[Et+4]>>5),_t[0]=tt[0];K=0}if(m=m[0],z.Ja=z.Ja[0],z.xa=z.xa[0],L=L[0],K!=0)break;if(4294967286<z.Ja)return 3;if(v==null||J||(v[0]=z.xa?2:1),y=[y],$=[$],z.xa){if(5>m){K=7;break}v=y,H=$,J=p,E==null||5>m?E=0:5<=m&&E[L+0]==47&&!(E[L+4]>>5)?(tt=[0],Rt=[0],pt=[0],qt(_t=new it,E,L,m),Nt(_t,tt,Rt,pt)?(v!=null&&(v[0]=tt[0]),H!=null&&(H[0]=Rt[0]),J!=null&&(J[0]=pt[0]),E=1):E=0):E=0}else{if(10>m){K=7;break}v=$,E==null||10>m||!Li(E,L+3,m-3)?E=0:(H=E[L+0]|E[L+1]<<8|E[L+2]<<16,J=16383&(E[L+7]<<8|E[L+6]),E=16383&(E[L+9]<<8|E[L+8]),1&H||3<(H>>1&7)||!(H>>4&1)||H>>5>=z.Ja||!J||!E?E=0:(y&&(y[0]=J),v&&(v[0]=E),E=1))}if(!E||(y=y[0],$=$[0],D&&(I[0]!=y||M[0]!=$)))return 3;S!=null&&(S[0]=z,S.offset=L-S.w,t(4294967286>L-S.w),t(S.offset==S.ha-m));break}return K==0||K==7&&D&&S==null?(p!=null&&(p[0]|=z.na!=null&&0<z.na.length),l!=null&&(l[0]=y),A!=null&&(A[0]=$),0):K}function ta(E,L,m){var l=L.width,A=L.height,p=0,y=0,v=l,S=A;if(L.Da=E!=null&&0<E.Da,L.Da&&(v=E.cd,S=E.bd,p=E.v,y=E.j,11>m||(p&=-2,y&=-2),0>p||0>y||0>=v||0>=S||p+v>l||y+S>A))return 0;if(L.v=p,L.j=y,L.va=p+v,L.o=y+S,L.U=v,L.T=S,L.da=E!=null&&0<E.da,L.da){if(!pr(v,S,m=[E.ib],p=[E.hb]))return 0;L.ib=m[0],L.hb=p[0]}return L.ob=E!=null&&E.ob,L.Kb=E==null||!E.Sd,L.da&&(L.ob=L.ib<3*l/4&&L.hb<3*A/4,L.Kb=0),1}function xa(E){if(E==null)return 2;if(11>E.S){var L=E.f.RGBA;L.fb+=(E.height-1)*L.A,L.A=-L.A}else L=E.f.kb,E=E.height,L.O+=(E-1)*L.fa,L.fa=-L.fa,L.N+=(E-1>>1)*L.Ab,L.Ab=-L.Ab,L.W+=(E-1>>1)*L.Db,L.Db=-L.Db,L.F!=null&&(L.J+=(E-1)*L.lb,L.lb=-L.lb);return 0}function ts(E,L,m,l){if(l==null||0>=E||0>=L)return 2;if(m!=null){if(m.Da){var A=m.cd,p=m.bd,y=-2&m.v,v=-2&m.j;if(0>y||0>v||0>=A||0>=p||y+A>E||v+p>L)return 2;E=A,L=p}if(m.da){if(!pr(E,L,A=[m.ib],p=[m.hb]))return 2;E=A[0],L=p[0]}}l.width=E,l.height=L;t:{var S=l.width,I=l.height;if(E=l.S,0>=S||0>=I||!(E>=fu&&13>E))E=2;else{if(0>=l.Rd&&l.sd==null){y=p=A=L=0;var M=(v=S*wA[E])*I;if(11>E||(p=(I+1)/2*(L=(S+1)/2),E==12&&(y=(A=S)*I)),(I=s(M+2*p+y))==null){E=1;break t}l.sd=I,11>E?((S=l.f.RGBA).eb=I,S.fb=0,S.A=v,S.size=M):((S=l.f.kb).y=I,S.O=0,S.fa=v,S.Fd=M,S.f=I,S.N=0+M,S.Ab=L,S.Cd=p,S.ea=I,S.W=0+M+p,S.Db=L,S.Ed=p,E==12&&(S.F=I,S.J=0+M+2*p),S.Tc=y,S.lb=A)}if(L=1,A=l.S,p=l.width,y=l.height,A>=fu&&13>A)if(11>A)E=l.f.RGBA,L&=(v=Math.abs(E.A))*(y-1)+p<=E.size,L&=v>=p*wA[A],L&=E.eb!=null;else{E=l.f.kb,v=(p+1)/2,M=(y+1)/2,S=Math.abs(E.fa),I=Math.abs(E.Ab);var D=Math.abs(E.Db),H=Math.abs(E.lb),z=H*(y-1)+p;L&=S*(y-1)+p<=E.Fd,L&=I*(M-1)+v<=E.Cd,L=(L&=D*(M-1)+v<=E.Ed)&S>=p&I>=v&D>=v,L&=E.y!=null,L&=E.f!=null,L&=E.ea!=null,A==12&&(L&=H>=p,L&=z<=E.Tc,L&=E.F!=null)}else L=0;E=L?0:2}}return E!=0||m!=null&&m.fd&&(E=xa(l)),E}var cs=64,Il=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Fl=24,Co=32,Za=8,zi=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ye("Predictor0","PredictorAdd0"),ht.Predictor0=function(){return 4278190080},ht.Predictor1=function(E){return E},ht.Predictor2=function(E,L,m){return L[m+0]},ht.Predictor3=function(E,L,m){return L[m+1]},ht.Predictor4=function(E,L,m){return L[m-1]},ht.Predictor5=function(E,L,m){return Oe(Oe(E,L[m+1]),L[m+0])},ht.Predictor6=function(E,L,m){return Oe(E,L[m-1])},ht.Predictor7=function(E,L,m){return Oe(E,L[m+0])},ht.Predictor8=function(E,L,m){return Oe(L[m-1],L[m+0])},ht.Predictor9=function(E,L,m){return Oe(L[m+0],L[m+1])},ht.Predictor10=function(E,L,m){return Oe(Oe(E,L[m-1]),Oe(L[m+0],L[m+1]))},ht.Predictor11=function(E,L,m){var l=L[m+0];return 0>=yr(l>>24&255,E>>24&255,(L=L[m-1])>>24&255)+yr(l>>16&255,E>>16&255,L>>16&255)+yr(l>>8&255,E>>8&255,L>>8&255)+yr(255&l,255&E,255&L)?l:E},ht.Predictor12=function(E,L,m){var l=L[m+0];return(We((E>>24&255)+(l>>24&255)-((L=L[m-1])>>24&255))<<24|We((E>>16&255)+(l>>16&255)-(L>>16&255))<<16|We((E>>8&255)+(l>>8&255)-(L>>8&255))<<8|We((255&E)+(255&l)-(255&L)))>>>0},ht.Predictor13=function(E,L,m){var l=L[m-1];return(cr((E=Oe(E,L[m+0]))>>24&255,l>>24&255)<<24|cr(E>>16&255,l>>16&255)<<16|cr(E>>8&255,l>>8&255)<<8|cr(E>>0&255,l>>0&255))>>>0};var Ll=ht.PredictorAdd0;ht.PredictorAdd1=Fr,ye("Predictor2","PredictorAdd2"),ye("Predictor3","PredictorAdd3"),ye("Predictor4","PredictorAdd4"),ye("Predictor5","PredictorAdd5"),ye("Predictor6","PredictorAdd6"),ye("Predictor7","PredictorAdd7"),ye("Predictor8","PredictorAdd8"),ye("Predictor9","PredictorAdd9"),ye("Predictor10","PredictorAdd10"),ye("Predictor11","PredictorAdd11"),ye("Predictor12","PredictorAdd12"),ye("Predictor13","PredictorAdd13");var tl=ht.PredictorAdd2;_r("ColorIndexInverseTransform","MapARGB","32b",function(E){return E>>8&255},function(E){return E}),_r("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(E){return E},function(E){return E>>8&255});var wc,us=ht.ColorIndexInverseTransform,Ba=ht.MapARGB,mh=ht.VP8LColorIndexInverseTransformAlpha,dA=ht.MapAlpha,Yr=ht.VP8LPredictorsAdd=[];Yr.length=16,(ht.VP8LPredictors=[]).length=16,(ht.VP8LPredictorsAdd_C=[]).length=16,(ht.VP8LPredictors_C=[]).length=16;var Es,ea,el,Ss,Ca,rl,Eo,xc,Pl,ra,As,Hs,So,Ml,To,Io,Rl,Ts,na,Kn,Qn,oi,wi,ro,Fo,xi,Ea,Td,Id=s(511),Ai=s(2041),Lo=s(225),Vs=s(767),du=0,fA=Ai,Bc=Lo,Hi=Vs,Ti=Id,fu=0,Cc=1,yh=2,Ec=3,pu=4,pA=5,Ul=6,gu=7,Sc=8,mu=9,gA=10,Fd=[2,3,7],Ld=[3,3,11],mA=[280,256,256,256,40],yu=[0,1,1,1,0],vp=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Po=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Sa=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Pd=8,no=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],nl=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],yA=null,jm=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],bp=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Md=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Rd=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],_u=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Mo=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Je=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ia=[],io=[],Ta=[],vu=1,Tc=2,Ia=[],kr=[];Ae("UpsampleRgbLinePair",rn,3),Ae("UpsampleBgrLinePair",Yn,3),Ae("UpsampleRgbaLinePair",zs,4),Ae("UpsampleBgraLinePair",Cr,4),Ae("UpsampleArgbLinePair",ls,4),Ae("UpsampleRgba4444LinePair",Jr,2),Ae("UpsampleRgb565LinePair",bi,2);var Ud=ht.UpsampleRgbLinePair,qm=ht.UpsampleBgrLinePair,_h=ht.UpsampleRgbaLinePair,wp=ht.UpsampleBgraLinePair,Ic=ht.UpsampleArgbLinePair,Od=ht.UpsampleRgba4444LinePair,Dd=ht.UpsampleRgb565LinePair,_A=16,vh=1<<_A-1,Fc=-227,Nd=482,xp=6,so=(256<<xp)-1,zn=0,bu=s(256),bh=s(256),wh=s(256),Bp=s(256),vA=s(Nd-Fc),bA=s(Nd-Fc);dn("YuvToRgbRow",rn,3),dn("YuvToBgrRow",Yn,3),dn("YuvToRgbaRow",zs,4),dn("YuvToBgraRow",Cr,4),dn("YuvToArgbRow",ls,4),dn("YuvToRgba4444Row",Jr,2),dn("YuvToRgb565Row",bi,2);var sa=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ol=[0,2,8],ar=[8,7,6,4,4,2,2,2,1,1,1,1],Er=1;this.WebPDecodeRGBA=function(E,L,m,l,A){var p=Cc,y=new Bo,v=new vn;y.ba=v,v.S=p,v.width=[v.width],v.height=[v.height];var S=v.width,I=v.height,M=new cn;if(M==null||E==null)var D=2;else t(M!=null),D=Tl(E,L,m,M.width,M.height,M.Pd,M.Qd,M.format,null);if(D!=0?S=0:(S!=null&&(S[0]=M.width[0]),I!=null&&(I[0]=M.height[0]),S=1),S){v.width=v.width[0],v.height=v.height[0],l!=null&&(l[0]=v.width),A!=null&&(A[0]=v.height);t:{if(l=new ws,(A=new uu).data=E,A.w=L,A.ha=m,A.kd=1,L=[0],t(A!=null),((E=Tl(A.data,A.w,A.ha,null,null,null,L,null,A))==0||E==7)&&L[0]&&(E=4),(L=E)==0){if(t(y!=null),l.data=A.data,l.w=A.w+A.offset,l.ha=A.ha-A.offset,l.put=Qt,l.ac=Bt,l.bc=Gt,l.ma=y,A.xa){if((E=Xr())==null){y=1;break t}if(function(H,z){var $=[0],J=[0],K=[0];e:for(;;){if(H==null)return 0;if(z==null)return H.a=2,0;if(H.l=z,H.a=0,qt(H.m,z.data,z.w,z.ha),!Nt(H.m,$,J,K)){H.a=3;break e}if(H.xb=Tc,z.width=$[0],z.height=J[0],!vr($[0],J[0],1,H,null))break e;return 1}return t(H.a!=0),0}(E,l)){if(l=(L=ts(l.width,l.height,y.Oa,y.ba))==0){e:{l=E;r:for(;;){if(l==null){l=0;break e}if(t(l.s.yc!=null),t(l.s.Ya!=null),t(0<l.s.Wb),t((m=l.l)!=null),t((A=m.ma)!=null),l.xb!=0){if(l.ca=A.ba,l.tb=A.tb,t(l.ca!=null),!ta(A.Oa,m,Ec)){l.a=2;break r}if(!jr(l,m.width)||m.da)break r;if((m.da||ze(l.ca.S))&&ee(),11>l.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),l.ca.f.kb.F!=null&&ee()),l.Pb&&0<l.s.ua&&l.s.vb.X==null&&!Ke(l.s.vb,l.s.Wa.Xa)){l.a=1;break r}l.xb=0}if(!xr(l,l.V,l.Ba,l.c,l.i,m.o,tr))break r;A.Dc=l.Ma,l=1;break e}t(l.a!=0),l=0}l=!l}l&&(L=E.a)}else L=E.a}else{if((E=new kn)==null){y=1;break t}if(E.Fa=A.na,E.P=A.P,E.qc=A.Sa,On(E,l)){if((L=ts(l.width,l.height,y.Oa,y.ba))==0){if(E.Aa=0,m=y.Oa,t((A=E)!=null),m!=null){if(0<(S=0>(S=m.Md)?0:100<S?255:255*S/100)){for(I=M=0;4>I;++I)12>(D=A.pb[I]).lc&&(D.ia=S*ar[0>D.lc?0:D.lc]>>3),M|=D.ia;M&&(alert("todo:VP8InitRandom"),A.ia=1)}A.Ga=m.Id,100<A.Ga?A.Ga=100:0>A.Ga&&(A.Ga=0)}$a(E,l)||(L=E.a)}}else L=E.a}L==0&&y.Oa!=null&&y.Oa.fd&&(L=xa(y.ba))}y=L}p=y!=0?null:11>p?v.f.RGBA.eb:v.f.kb.y}else p=null;return p};var wA=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(ht,It){for(var St="",ot=0;ot<4;ot++)St+=String.fromCharCode(ht[It++]);return St}function _(ht,It){return(ht[It+0]<<0|ht[It+1]<<8|ht[It+2]<<16)>>>0}function w(ht,It){return(ht[It+0]<<0|ht[It+1]<<8|ht[It+2]<<16|ht[It+3]<<24)>>>0}new d;var x=[0],B=[0],P=[],R=new d,N=r,Q=function(ht,It){var St={},ot=0,at=!1,bt=0,vt=0;if(St.frames=[],!function(wt,Ft,Ut,jt){for(var Vt=0;Vt<jt;Vt++)if(wt[Ft+Vt]!=Ut.charCodeAt(Vt))return!0;return!1}(ht,It,"RIFF",4)){var $t,Wt;for(w(ht,It+=4),It+=8;It<ht.length;){var Jt=f(ht,It),qt=w(ht,It+=4);It+=4;var te=qt+(1&qt);switch(Jt){case"VP8 ":case"VP8L":St.frames[ot]===void 0&&(St.frames[ot]={}),(it=St.frames[ot]).src_off=at?vt:It-8,it.src_size=bt+qt+8,ot++,at&&(at=!1,bt=0,vt=0);break;case"VP8X":(it=St.header={}).feature_flags=ht[It];var Yt=It+4;it.canvas_width=1+_(ht,Yt),Yt+=3,it.canvas_height=1+_(ht,Yt),Yt+=3;break;case"ALPH":at=!0,bt=te+8,vt=It-8;break;case"ANIM":(it=St.header).bgcolor=w(ht,It),Yt=It+4,it.loop_count=($t=ht)[(Wt=Yt)+0]<<0|$t[Wt+1]<<8,Yt+=2;break;case"ANMF":var be,it;(it=St.frames[ot]={}).offset_x=2*_(ht,It),It+=3,it.offset_y=2*_(ht,It),It+=3,it.width=1+_(ht,It),It+=3,it.height=1+_(ht,It),It+=3,it.duration=_(ht,It),It+=3,be=ht[It++],it.dispose=1&be,it.blend=be>>1&1}Jt!="ANMF"&&(It+=te)}return St}}(N,0);Q.response=N,Q.rgbaoutput=!0,Q.dataurl=!1;var V=Q.header?Q.header:null,W=Q.frames?Q.frames:null;if(V){V.loop_counter=V.loop_count,x=[V.canvas_height],B=[V.canvas_width];for(var et=0;et<W.length&&W[et].blend!=0;et++);}var ct=W[0],dt=R.WebPDecodeRGBA(N,ct.src_off,ct.src_size,B,x);ct.rgba=dt,ct.imgwidth=B[0],ct.imgheight=x[0];for(var gt=0;gt<B[0]*x[0]*4;gt++)P[gt]=dt[gt];return this.width=B,this.height=x,this.data=P,this}(function(r){var t=function(){return typeof z2=="function"},e=function(x,B,P,R){var N=4,Q=a;switch(R){case r.image_compression.FAST:N=1,Q=s;break;case r.image_compression.MEDIUM:N=6,Q=o;break;case r.image_compression.SLOW:N=9,Q=d}x=n(x,B,P,Q);var V=z2(x,{level:N});return r.__addimage__.arrayBufferToBinaryString(V)},n=function(x,B,P,R){for(var N,Q,V,W=x.length/B,et=new Uint8Array(x.length+W),ct=_(),dt=0;dt<W;dt+=1){if(V=dt*B,N=x.subarray(V,V+B),R)et.set(R(N,P,Q),V+dt);else{for(var gt,ht=ct.length,It=[];gt<ht;gt+=1)It[gt]=ct[gt](N,P,Q);var St=w(It.concat());et.set(It[St],V+dt)}Q=N}return et},i=function(x){var B=Array.apply([],x);return B.unshift(0),B},s=function(x,B){var P,R=[],N=x.length;R[0]=1;for(var Q=0;Q<N;Q+=1)P=x[Q-B]||0,R[Q+1]=x[Q]-P+256&255;return R},a=function(x,B,P){var R,N=[],Q=x.length;N[0]=2;for(var V=0;V<Q;V+=1)R=P&&P[V]||0,N[V+1]=x[V]-R+256&255;return N},o=function(x,B,P){var R,N,Q=[],V=x.length;Q[0]=3;for(var W=0;W<V;W+=1)R=x[W-B]||0,N=P&&P[W]||0,Q[W+1]=x[W]+256-(R+N>>>1)&255;return Q},d=function(x,B,P){var R,N,Q,V,W=[],et=x.length;W[0]=4;for(var ct=0;ct<et;ct+=1)R=x[ct-B]||0,N=P&&P[ct]||0,Q=P&&P[ct-B]||0,V=f(R,N,Q),W[ct+1]=x[ct]-V+256&255;return W},f=function(x,B,P){if(x===B&&B===P)return x;var R=Math.abs(B-P),N=Math.abs(x-P),Q=Math.abs(x+B-P-P);return R<=N&&R<=Q?x:N<=Q?B:P},_=function(){return[i,s,a,o,d]},w=function(x){var B=x.map(function(P){return P.reduce(function(R,N){return R+Math.abs(N)},0)});return B.indexOf(Math.min.apply(null,B))};r.processPNG=function(x,B,P,R){var N,Q,V,W,et,ct,dt,gt,ht,It,St,ot,at,bt,vt,$t=this.decode.FLATE_DECODE,Wt="";if(this.__addimage__.isArrayBuffer(x)&&(x=new Uint8Array(x)),this.__addimage__.isArrayBufferView(x)){if(x=(V=new Jrt(x)).imgData,Q=V.bits,N=V.colorSpace,et=V.colors,[4,6].indexOf(V.colorType)!==-1){if(V.bits===8){ht=(gt=V.pixelBitlength==32?new Uint32Array(V.decodePixels().buffer):V.pixelBitlength==16?new Uint16Array(V.decodePixels().buffer):new Uint8Array(V.decodePixels().buffer)).length,St=new Uint8Array(ht*V.colors),It=new Uint8Array(ht);var Jt,qt=V.pixelBitlength-V.bits;for(bt=0,vt=0;bt<ht;bt++){for(at=gt[bt],Jt=0;Jt<qt;)St[vt++]=at>>>Jt&255,Jt+=V.bits;It[bt]=at>>>Jt&255}}if(V.bits===16){ht=(gt=new Uint32Array(V.decodePixels().buffer)).length,St=new Uint8Array(ht*(32/V.pixelBitlength)*V.colors),It=new Uint8Array(ht*(32/V.pixelBitlength)),ot=V.colors>1,bt=0,vt=0;for(var te=0;bt<ht;)at=gt[bt++],St[vt++]=at>>>0&255,ot&&(St[vt++]=at>>>16&255,at=gt[bt++],St[vt++]=at>>>0&255),It[te++]=at>>>16&255;Q=8}R!==r.image_compression.NONE&&t()?(x=e(St,V.width*V.colors,V.colors,R),dt=e(It,V.width,1,R)):(x=St,dt=It,$t=void 0)}if(V.colorType===3&&(N=this.color_spaces.INDEXED,ct=V.palette,V.transparency.indexed)){var Yt=V.transparency.indexed,be=0;for(bt=0,ht=Yt.length;bt<ht;++bt)be+=Yt[bt];if((be/=255)===ht-1&&Yt.indexOf(0)!==-1)W=[Yt.indexOf(0)];else if(be!==ht){for(gt=V.decodePixels(),It=new Uint8Array(gt.length),bt=0,ht=gt.length;bt<ht;bt++)It[bt]=Yt[gt[bt]];dt=e(It,V.width,1)}}var it=function(wt){var Ft;switch(wt){case r.image_compression.FAST:Ft=11;break;case r.image_compression.MEDIUM:Ft=13;break;case r.image_compression.SLOW:Ft=14;break;default:Ft=12}return Ft}(R);return $t===this.decode.FLATE_DECODE&&(Wt="/Predictor "+it+" "),Wt+="/Colors "+et+" /BitsPerComponent "+Q+" /Columns "+V.width,(this.__addimage__.isArrayBuffer(x)||this.__addimage__.isArrayBufferView(x))&&(x=this.__addimage__.arrayBufferToBinaryString(x)),(dt&&this.__addimage__.isArrayBuffer(dt)||this.__addimage__.isArrayBufferView(dt))&&(dt=this.__addimage__.arrayBufferToBinaryString(dt)),{alias:P,data:x,index:B,filter:$t,decodeParameters:Wt,transparency:W,palette:ct,sMask:dt,predictor:it,width:V.width,height:V.height,bitsPerComponent:Q,colorSpace:N}}}})(Gr.API),function(r){r.processGIF89A=function(t,e,n,i){var s=new Yrt(t),a=s.width,o=s.height,d=[];s.decodeAndBlitFrameRGBA(0,d);var f={data:d,width:a,height:o},_=new Z2(100).encode(f,100);return r.processJPEG.call(this,_,e,n,i)},r.processGIF87A=r.processGIF89A}(Gr.API),nc.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var t=0;t<r;t++){var e=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:n,blue:e,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},nc.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[r]()}catch(e){ui.log("bit decode error:"+e)}},nc.prototype.bit1=function(){var r,t=Math.ceil(this.width/8),e=t%4;for(r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++)for(var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var d=this.palette[s>>7-o&1];this.data[a+4*o]=d.blue,this.data[a+4*o+1]=d.green,this.data[a+4*o+2]=d.red,this.data[a+4*o+3]=255}e!==0&&(this.pos+=4-e)}},nc.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),t=r%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<r;i++){var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+2*i*4,o=s>>4,d=15&s,f=this.palette[o];if(this.data[a]=f.blue,this.data[a+1]=f.green,this.data[a+2]=f.red,this.data[a+3]=255,2*i+1>=this.width)break;f=this.palette[d],this.data[a+4]=f.blue,this.data[a+4+1]=f.green,this.data[a+4+2]=f.red,this.data[a+4+3]=255}t!==0&&(this.pos+=4-t)}},nc.prototype.bit8=function(){for(var r=this.width%4,t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*n;if(i<this.palette.length){var a=this.palette[i];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}r!==0&&(this.pos+=4-r)}},nc.prototype.bit15=function(){for(var r=this.width%3,t=parseInt("11111",2),e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&t)/t*255|0,o=(s>>5&t)/t*255|0,d=(s>>10&t)/t*255|0,f=s>>15?255:0,_=n*this.width*4+4*i;this.data[_]=d,this.data[_+1]=o,this.data[_+2]=a,this.data[_+3]=f}this.pos+=r}},nc.prototype.bit16=function(){for(var r=this.width%3,t=parseInt("11111",2),e=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&t)/t*255|0,d=(a>>5&e)/e*255|0,f=(a>>11)/t*255|0,_=i*this.width*4+4*s;this.data[_]=f,this.data[_+1]=d,this.data[_+2]=o,this.data[_+3]=255}this.pos+=r}},nc.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var t=this.bottom_up?r:this.height-1-r,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*e;this.data[a]=s,this.data[a+1]=i,this.data[a+2]=n,this.data[a+3]=255}this.pos+=this.width%4}},nc.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var t=this.bottom_up?r:this.height-1-r,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*e;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=a}},nc.prototype.getData=function(){return this.data},function(r){r.processBMP=function(t,e,n,i){var s=new nc(t,!1),a=s.width,o=s.height,d={data:s.getData(),width:a,height:o},f=new Z2(100).encode(d,100);return r.processJPEG.call(this,f,e,n,i)}}(Gr.API),FP.prototype.getData=function(){return this.data},function(r){r.processWEBP=function(t,e,n,i){var s=new FP(t),a=s.width,o=s.height,d={data:s.getData(),width:a,height:o},f=new Z2(100).encode(d,100);return r.processJPEG.call(this,f,e,n,i)}}(Gr.API),Gr.API.processRGBA=function(r,t,e){for(var n=r.data,i=n.length,s=new Uint8Array(i/4*3),a=new Uint8Array(i/4),o=0,d=0,f=0;f<i;f+=4){var _=n[f],w=n[f+1],x=n[f+2],B=n[f+3];s[o++]=_,s[o++]=w,s[o++]=x,a[d++]=B}var P=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:P,index:t,alias:e,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},Gr.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Nf=Gr.API,Ky=Nf.getCharWidthsArray=function(r,t){var e,n,i=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),a=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:i.metadata.Unicode.widths,d=o.fof?o.fof:1,f=t.kerning?t.kerning:i.metadata.Unicode.kerning,_=f.fof?f.fof:1,w=t.doKerning!==!1,x=0,B=r.length,P=0,R=o[0]||d,N=[];for(e=0;e<B;e++)n=r.charCodeAt(e),typeof i.metadata.widthOfString=="function"?N.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+a*(1e3/s)||0)/1e3):(x=w&&Un(f[n])==="object"&&!isNaN(parseInt(f[n][P],10))?f[n][P]/_:0,N.push((o[n]||R)/d+x)),P=n;return N},EP=Nf.getStringUnitWidth=function(r,t){var e=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return Nf.processArabic&&(r=Nf.processArabic(r)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(r,e,i)/e:Ky.apply(this,arguments).reduce(function(s,a){return s+a},0)},SP=function(r,t,e,n){for(var i=[],s=0,a=r.length,o=0;s!==a&&o+t[s]<e;)o+=t[s],s++;i.push(r.slice(0,s));var d=s;for(o=0;s!==a;)o+t[s]>n&&(i.push(r.slice(d,s)),o=0,d=s),o+=t[s],s++;return d!==s&&i.push(r.slice(d,s)),i},TP=function(r,t,e){e||(e={});var n,i,s,a,o,d,f,_=[],w=[_],x=e.textIndent||0,B=0,P=0,R=r.split(" "),N=Ky.apply(this,[" ",e])[0];if(d=e.lineIndent===-1?R[0].length+2:e.lineIndent||0){var Q=Array(d).join(" "),V=[];R.map(function(et){(et=et.split(/\s*\n/)).length>1?V=V.concat(et.map(function(ct,dt){return(dt&&ct.length?`
`:"")+ct})):V.push(et[0])}),R=V,d=EP.apply(this,[Q,e])}for(s=0,a=R.length;s<a;s++){var W=0;if(n=R[s],d&&n[0]==`
`&&(n=n.substr(1),W=1),x+B+(P=(i=Ky.apply(this,[n,e])).reduce(function(et,ct){return et+ct},0))>t||W){if(P>t){for(o=SP.apply(this,[n,i,t-(x+B),t]),_.push(o.shift()),_=[o.pop()];o.length;)w.push([o.shift()]);P=i.slice(n.length-(_[0]?_[0].length:0)).reduce(function(et,ct){return et+ct},0)}else _=[n];w.push(_),x=P+d,B=N}else _.push(n),x+=B+P,B=N}return f=d?function(et,ct){return(ct?Q:"")+et.join(" ")}:function(et){return et.join(" ")},w.map(f)},Nf.splitTextToSize=function(r,t,e){var n,i=(e=e||{}).fontSize||this.internal.getFontSize(),s=(function(_){if(_.widths&&_.kerning)return{widths:_.widths,kerning:_.kerning};var w=this.internal.getFont(_.fontName,_.fontStyle);return w.metadata.Unicode?{widths:w.metadata.Unicode.widths||{0:1},kerning:w.metadata.Unicode.kerning||{}}:{font:w.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,e);n=Array.isArray(r)?r:String(r).split(/\r?\n/);var a=1*this.internal.scaleFactor*t/i;s.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=e.lineIndent;var o,d,f=[];for(o=0,d=n.length;o<d;o++)f=f.concat(TP.apply(this,[n[o],a,s]));return f},function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",e={},n={},i=0;i<t.length;i++)e[t[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=t[i];var s=function(w){return"0x"+parseInt(w,10).toString(16)},a=r.__fontmetrics__.compress=function(w){var x,B,P,R,N=["{"];for(var Q in w){if(x=w[Q],isNaN(parseInt(Q,10))?B="'"+Q+"'":(Q=parseInt(Q,10),B=(B=s(Q).slice(2)).slice(0,-1)+n[B.slice(-1)]),typeof x=="number")x<0?(P=s(x).slice(3),R="-"):(P=s(x).slice(2),R=""),P=R+P.slice(0,-1)+n[P.slice(-1)];else{if(Un(x)!=="object")throw new Error("Don't know what to do with value type "+Un(x)+".");P=a(x)}N.push(B+P)}return N.push("}"),N.join("")},o=r.__fontmetrics__.uncompress=function(w){if(typeof w!="string")throw new Error("Invalid argument passed to uncompress.");for(var x,B,P,R,N={},Q=1,V=N,W=[],et="",ct="",dt=w.length-1,gt=1;gt<dt;gt+=1)(R=w[gt])=="'"?x?(P=x.join(""),x=void 0):x=[]:x?x.push(R):R=="{"?(W.push([V,P]),V={},P=void 0):R=="}"?((B=W.pop())[0][B[1]]=V,P=void 0,V=B[0]):R=="-"?Q=-1:P===void 0?e.hasOwnProperty(R)?(et+=e[R],P=parseInt(et,16)*Q,Q=1,et=""):et+=R:e.hasOwnProperty(R)?(ct+=e[R],V[P]=parseInt(ct,16)*Q,Q=1,P=void 0,ct=""):ct+=R;return N},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},_={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(w){var x=w.font,B=_.Unicode[x.postScriptName];B&&(x.metadata.Unicode={},x.metadata.Unicode.widths=B.widths,x.metadata.Unicode.kerning=B.kerning);var P=f.Unicode[x.postScriptName];P&&(x.metadata.Unicode.encoding=P,x.encoding=P.codePages[0])}])}(Gr.API),function(r){var t=function(e){for(var n=e.length,i=new Uint8Array(n),s=0;s<n;s++)i[s]=e.charCodeAt(s);return i};r.API.events.push(["addFont",function(e){var n=void 0,i=e.font,s=e.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t($g(o)),a.metadata=r.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(i,n)}}])}(Gr),function(r){function t(){return(Vr.canvg?Promise.resolve(Vr.canvg):Promise.resolve().then(()=>zbt)).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e})}Gr.API.addSvgAsImage=function(e,n,i,s,a,o,d,f){if(isNaN(n)||isNaN(i))throw ui.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(a))throw ui.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var _=document.createElement("canvas");_.width=s,_.height=a;var w=_.getContext("2d");w.fillStyle="#fff",w.fillRect(0,0,_.width,_.height);var x={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},B=this;return t().then(function(P){return P.fromString(w,e,x)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(P){return P.render(x)}).then(function(){B.addImage(_.toDataURL("image/jpeg",1),n,i,s,a,d,f)})}}(),Gr.API.putTotalPages=function(r){var t,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(r,"g"),e=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(t,e);return this},Gr.API.viewerPreferences=function(r,t){var e;r=r||{},t=t||!1;var n,i,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),d=[],f=0,_=0,w=0;function x(P,R){var N,Q=!1;for(N=0;N<P.length;N+=1)P[N]===R&&(Q=!0);return Q}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,r==="reset"||t===!0){var B=o.length;for(w=0;w<B;w+=1)e[o[w]].value=e[o[w]].defaultValue,e[o[w]].explicitSet=!1}if(Un(r)==="object"){for(i in r)if(s=r[i],x(o,i)&&s!==void 0){if(e[i].type==="boolean"&&typeof s=="boolean")e[i].value=s;else if(e[i].type==="name"&&x(e[i].valueSet,s))e[i].value=s;else if(e[i].type==="integer"&&Number.isInteger(s))e[i].value=s;else if(e[i].type==="array"){for(f=0;f<s.length;f+=1)if(n=!0,s[f].length===1&&typeof s[f][0]=="number")d.push(String(s[f]-1));else if(s[f].length>1){for(_=0;_<s[f].length;_+=1)typeof s[f][_]!="number"&&(n=!1);n===!0&&d.push([s[f][0]-1,s[f][1]-1].join(" "))}e[i].value="["+d.join(" ")+"]"}else e[i].value=e[i].defaultValue;e[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var P,R=[];for(P in e)e[P].explicitSet===!0&&(e[P].type==="name"?R.push("/"+P+" /"+e[P].value):R.push("/"+P+" "+e[P].value));R.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+R.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=e,this},function(r){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),d=unescape(encodeURIComponent("</x:xmpmeta>")),f=s.length+a.length+o.length+i.length+d.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+f+" >>"),this.internal.write("stream"),this.internal.write(i+s+a+o+d),this.internal.write("endstream"),this.internal.write("endobj")},e=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",e),this.internal.events.subscribe("postPutResources",t)),this}}(Gr.API),function(r){var t=r.API,e=t.pdfEscape16=function(s,a){for(var o,d=a.metadata.Unicode.widths,f=["","0","00","000","0000"],_=[""],w=0,x=s.length;w<x;++w){if(o=a.metadata.characterToGlyph(s.charCodeAt(w)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=s.charCodeAt(w),d.indexOf(o)==-1&&(d.push(o),d.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return _.join("");o=o.toString(16),_.push(f[4-o.length],o)}return _.join("")},n=function(s){var a,o,d,f,_,w,x;for(_=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,d=[],w=0,x=(o=Object.keys(s).sort(function(B,P){return B-P})).length;w<x;w++)a=o[w],d.length>=100&&(_+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar`,d=[]),s[a]!==void 0&&s[a]!==null&&typeof s[a].toString=="function"&&(f=("0000"+s[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),d.push("<"+a+"><"+f+">"));return d.length&&(_+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar
`),_+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(a){var o=a.font,d=a.out,f=a.newObject,_=a.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="Identity-H"){for(var w=o.metadata.Unicode.widths,x=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),B="",P=0;P<x.length;P++)B+=String.fromCharCode(x[P]);var R=f();_({data:B,addLength1:!0,objectId:R}),d("endobj");var N=f();_({data:n(o.metadata.toUnicode),addLength1:!0,objectId:N}),d("endobj");var Q=f();d("<<"),d("/Type /FontDescriptor"),d("/FontName /"+Lf(o.fontName)),d("/FontFile2 "+R+" 0 R"),d("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),d("/Flags "+o.metadata.flags),d("/StemV "+o.metadata.stemV),d("/ItalicAngle "+o.metadata.italicAngle),d("/Ascent "+o.metadata.ascender),d("/Descent "+o.metadata.decender),d("/CapHeight "+o.metadata.capHeight),d(">>"),d("endobj");var V=f();d("<<"),d("/Type /Font"),d("/BaseFont /"+Lf(o.fontName)),d("/FontDescriptor "+Q+" 0 R"),d("/W "+r.API.PDFObject.convert(w)),d("/CIDToGIDMap /Identity"),d("/DW 1000"),d("/Subtype /CIDFontType2"),d("/CIDSystemInfo"),d("<<"),d("/Supplement 0"),d("/Registry (Adobe)"),d("/Ordering ("+o.encoding+")"),d(">>"),d(">>"),d("endobj"),o.objectNumber=f(),d("<<"),d("/Type /Font"),d("/Subtype /Type0"),d("/ToUnicode "+N+" 0 R"),d("/BaseFont /"+Lf(o.fontName)),d("/Encoding /"+o.encoding),d("/DescendantFonts ["+V+" 0 R]"),d(">>"),d("endobj"),o.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(a){var o=a.font,d=a.out,f=a.newObject,_=a.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var w=o.metadata.rawData,x="",B=0;B<w.length;B++)x+=String.fromCharCode(w[B]);var P=f();_({data:x,addLength1:!0,objectId:P}),d("endobj");var R=f();_({data:n(o.metadata.toUnicode),addLength1:!0,objectId:R}),d("endobj");var N=f();d("<<"),d("/Descent "+o.metadata.decender),d("/CapHeight "+o.metadata.capHeight),d("/StemV "+o.metadata.stemV),d("/Type /FontDescriptor"),d("/FontFile2 "+P+" 0 R"),d("/Flags 96"),d("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),d("/FontName /"+Lf(o.fontName)),d("/ItalicAngle "+o.metadata.italicAngle),d("/Ascent "+o.metadata.ascender),d(">>"),d("endobj"),o.objectNumber=f();for(var Q=0;Q<o.metadata.hmtx.widths.length;Q++)o.metadata.hmtx.widths[Q]=parseInt(o.metadata.hmtx.widths[Q]*(1e3/o.metadata.head.unitsPerEm));d("<</Subtype/TrueType/Type/Font/ToUnicode "+R+" 0 R/BaseFont/"+Lf(o.fontName)+"/FontDescriptor "+N+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),d("endobj"),o.isAlreadyPutted=!0}})(s)}]);var i=function(s){var a,o=s.text||"",d=s.x,f=s.y,_=s.options||{},w=s.mutex||{},x=w.pdfEscape,B=w.activeFontKey,P=w.fonts,R=B,N="",Q=0,V="",W=P[R].encoding;if(P[R].encoding!=="Identity-H")return{text:o,x:d,y:f,options:_,mutex:w};for(V=o,R=B,Array.isArray(o)&&(V=o[0]),Q=0;Q<V.length;Q+=1)P[R].metadata.hasOwnProperty("cmap")&&(a=P[R].metadata.cmap.unicode.codeMap[V[Q].charCodeAt(0)]),a||V[Q].charCodeAt(0)<256&&P[R].metadata.hasOwnProperty("Unicode")?N+=V[Q]:N+="";var et="";return parseInt(R.slice(1))<14||W==="WinAnsiEncoding"?et=x(N,R).split("").map(function(ct){return ct.charCodeAt(0).toString(16)}).join(""):W==="Identity-H"&&(et=e(N,P[R])),w.isHex=!0,{text:et,x:d,y:f,options:_,mutex:w}};t.events.push(["postProcessText",function(s){var a=s.text||"",o=[],d={text:a,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(a)){var f=0;for(f=0;f<a.length;f+=1)Array.isArray(a[f])&&a[f].length===3?o.push([i(Object.assign({},d,{text:a[f][0]})).text,a[f][1],a[f][2]]):o.push(i(Object.assign({},d,{text:a[f]})).text);s.text=o}else s.text=i(Object.assign({},d,{text:a})).text}])}(Gr),function(r){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0},r.addFileToVFS=function(e,n){return t.call(this),this.internal.vFS[e]=n,this},r.getFileFromVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0?this.internal.vFS[e]:null}}(Gr.API),function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(n){var i,s,a,o,d,f,_,w=t,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],B=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],P={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},R={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},N=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Q=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),V=!1,W=0;this.__bidiEngine__={};var et=function(ot){var at=ot.charCodeAt(),bt=at>>8,vt=R[bt];return vt!==void 0?w[256*vt+(255&at)]:bt===252||bt===253?"AL":Q.test(bt)?"L":bt===8?"R":"N"},ct=function(ot){for(var at,bt=0;bt<ot.length;bt++){if((at=et(ot.charAt(bt)))==="L")return!1;if(at==="R")return!0}return!1},dt=function(ot,at,bt,vt){var $t,Wt,Jt,qt,te=at[vt];switch(te){case"L":case"R":V=!1;break;case"N":case"AN":break;case"EN":V&&(te="AN");break;case"AL":V=!0,te="R";break;case"WS":te="N";break;case"CS":vt<1||vt+1>=at.length||($t=bt[vt-1])!=="EN"&&$t!=="AN"||(Wt=at[vt+1])!=="EN"&&Wt!=="AN"?te="N":V&&(Wt="AN"),te=Wt===$t?Wt:"N";break;case"ES":te=($t=vt>0?bt[vt-1]:"B")==="EN"&&vt+1<at.length&&at[vt+1]==="EN"?"EN":"N";break;case"ET":if(vt>0&&bt[vt-1]==="EN"){te="EN";break}if(V){te="N";break}for(Jt=vt+1,qt=at.length;Jt<qt&&at[Jt]==="ET";)Jt++;te=Jt<qt&&at[Jt]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(qt=at.length,Jt=vt+1;Jt<qt&&at[Jt]==="NSM";)Jt++;if(Jt<qt){var Yt=ot[vt],be=Yt>=1425&&Yt<=2303||Yt===64286;if($t=at[Jt],be&&($t==="R"||$t==="AL")){te="R";break}}}te=vt<1||($t=at[vt-1])==="B"?"N":bt[vt-1];break;case"B":V=!1,i=!0,te=W;break;case"S":s=!0,te="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":V=!1;break;case"BN":te="N"}return te},gt=function(ot,at,bt){var vt=ot.split("");return bt&&ht(vt,bt,{hiLevel:W}),vt.reverse(),at&&at.reverse(),vt.join("")},ht=function(ot,at,bt){var vt,$t,Wt,Jt,qt,te=-1,Yt=ot.length,be=0,it=[],wt=W?B:x,Ft=[];for(V=!1,i=!1,s=!1,$t=0;$t<Yt;$t++)Ft[$t]=et(ot[$t]);for(Wt=0;Wt<Yt;Wt++){if(qt=be,it[Wt]=dt(ot,Ft,it,Wt),vt=240&(be=wt[qt][P[it[Wt]]]),be&=15,at[Wt]=Jt=wt[be][5],vt>0)if(vt===16){for($t=te;$t<Wt;$t++)at[$t]=1;te=-1}else te=-1;if(wt[be][6])te===-1&&(te=Wt);else if(te>-1){for($t=te;$t<Wt;$t++)at[$t]=Jt;te=-1}Ft[Wt]==="B"&&(at[Wt]=0),bt.hiLevel|=Jt}s&&function(Ut,jt,Vt){for(var re=0;re<Vt;re++)if(Ut[re]==="S"){jt[re]=W;for(var Zt=re-1;Zt>=0&&Ut[Zt]==="WS";Zt--)jt[Zt]=W}}(Ft,at,Yt)},It=function(ot,at,bt,vt,$t){if(!($t.hiLevel<ot)){if(ot===1&&W===1&&!i)return at.reverse(),void(bt&&bt.reverse());for(var Wt,Jt,qt,te,Yt=at.length,be=0;be<Yt;){if(vt[be]>=ot){for(qt=be+1;qt<Yt&&vt[qt]>=ot;)qt++;for(te=be,Jt=qt-1;te<Jt;te++,Jt--)Wt=at[te],at[te]=at[Jt],at[Jt]=Wt,bt&&(Wt=bt[te],bt[te]=bt[Jt],bt[Jt]=Wt);be=qt}be++}}},St=function(ot,at,bt){var vt=ot.split(""),$t={hiLevel:W};return bt||(bt=[]),ht(vt,bt,$t),function(Wt,Jt,qt){if(qt.hiLevel!==0&&_)for(var te,Yt=0;Yt<Wt.length;Yt++)Jt[Yt]===1&&(te=N.indexOf(Wt[Yt]))>=0&&(Wt[Yt]=N[te+1])}(vt,bt,$t),It(2,vt,at,bt,$t),It(1,vt,at,bt,$t),vt.join("")};return this.__bidiEngine__.doBidiReorder=function(ot,at,bt){if(function($t,Wt){if(Wt)for(var Jt=0;Jt<$t.length;Jt++)Wt[Jt]=Jt;o===void 0&&(o=ct($t)),f===void 0&&(f=ct($t))}(ot,at),a||!d||f)if(a&&d&&o^f)W=o?1:0,ot=gt(ot,at,bt);else if(!a&&d&&f)W=o?1:0,ot=St(ot,at,bt),ot=gt(ot,at);else if(!a||o||d||f){if(a&&!d&&o^f)ot=gt(ot,at),o?(W=0,ot=St(ot,at,bt)):(W=1,ot=St(ot,at,bt),ot=gt(ot,at));else if(a&&o&&!d&&f)W=1,ot=St(ot,at,bt),ot=gt(ot,at);else if(!a&&!d&&o^f){var vt=_;o?(W=1,ot=St(ot,at,bt),W=0,_=!1,ot=St(ot,at,bt),_=vt):(W=0,ot=St(ot,at,bt),ot=gt(ot,at),W=1,_=!1,ot=St(ot,at,bt),_=vt,ot=gt(ot,at))}}else W=0,ot=St(ot,at,bt);else W=o?1:0,ot=St(ot,at,bt);return ot},this.__bidiEngine__.setOptions=function(ot){ot&&(a=ot.isInputVisual,d=ot.isOutputVisual,o=ot.isInputRtl,f=ot.isOutputRtl,_=ot.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],e=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(n){var i=n.text,s=(n.x,n.y,n.options||{}),a=(n.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,e.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(a=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?a.push([e.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):a.push([e.doBidiReorder(i[o])]);n.text=a}else n.text=e.doBidiReorder(i);e.setOptions({isInputVisual:!0})}])}(Gr),Gr.API.TTFFont=function(){function r(t){var e;if(this.rawData=t,e=this.contents=new YA(t),this.contents.pos=4,e.readString(4)==="ttcf")throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new dnt(this),this.registerTTF()}return r.open=function(t){return new r(t)},r.prototype.parse=function(){return this.directory=new Zrt(this.contents),this.head=new ent(this),this.name=new ont(this),this.cmap=new PP(this),this.toUnicode={},this.hhea=new rnt(this),this.maxp=new ant(this),this.hmtx=new lnt(this),this.post=new int(this),this.os2=new nnt(this),this.loca=new hnt(this),this.glyf=new cnt(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var t,e,n,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,o,d,f;for(f=[],a=0,o=(d=this.bbox).length;a<o;a++)t=d[a],f.push(Math.round(t*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(e=i>>16)&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(t){var e;return((e=this.cmap.unicode)!=null?e.codeMap[t]:void 0)||0},r.prototype.widthOfGlyph=function(t){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*e},r.prototype.widthOfString=function(t,e,n){var i,s,a,o;for(a=0,s=0,o=(t=""+t).length;0<=o?s<o:s>o;s=0<=o?++s:--s)i=t.charCodeAt(s),a+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/e)||0;return a*(e/1e3)},r.prototype.lineHeight=function(t,e){var n;return e==null&&(e=!1),n=e?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},r}();var ic,YA=function(){function r(t){this.data=t??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(t){return this.data[this.pos++]=t},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},r.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},r.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},r.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},r.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},r.prototype.readString=function(t){var e,n;for(n=[],e=0;0<=t?e<t:e>t;e=0<=t?++e:--e)n[e]=String.fromCharCode(this.readByte());return n.join("")},r.prototype.writeString=function(t){var e,n,i;for(i=[],e=0,n=t.length;0<=n?e<n:e>n;e=0<=n?++e:--e)i.push(this.writeByte(t.charCodeAt(e)));return i},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(t){return this.writeInt16(t)},r.prototype.readLongLong=function(){var t,e,n,i,s,a,o,d;return t=this.readByte(),e=this.readByte(),n=this.readByte(),i=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),d=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^s)+65536*(255^a)+256*(255^o)+(255^d)+1):72057594037927940*t+281474976710656*e+1099511627776*n+4294967296*i+16777216*s+65536*a+256*o+d},r.prototype.writeLongLong=function(t){var e,n;return e=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(t){return this.writeInt32(t)},r.prototype.read=function(t){var e,n;for(e=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)e.push(this.readByte());return e},r.prototype.write=function(t){var e,n,i,s;for(s=[],n=0,i=t.length;n<i;n++)e=t[n],s.push(this.writeByte(e));return s},r}(),Zrt=function(){var r;function t(e){var n,i,s;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)n={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(e){var n,i,s,a,o,d,f,_,w,x,B,P,R;for(R in B=Object.keys(e).length,d=Math.log(2),w=16*Math.floor(Math.log(B)/d),a=Math.floor(w/d),_=16*B-w,(i=new YA).writeInt(this.scalarType),i.writeShort(B),i.writeShort(w),i.writeShort(a),i.writeShort(_),s=16*B,f=i.pos+s,o=null,P=[],e)for(x=e[R],i.writeString(R),i.writeInt(r(x)),i.writeInt(f),i.writeInt(x.length),P=P.concat(x),R==="head"&&(o=f),f+=x.length;f%4;)P.push(0),f++;return i.write(P),n=2981146554-r(i.data),i.pos=o+8,i.writeUInt32(n),i.data},r=function(e){var n,i,s,a;for(e=MP.call(e);e.length%4;)e.push(0);for(s=new YA(e),i=0,n=0,a=e.length;n<a;n=n+=4)i+=s.readUInt32();return 4294967295&i},t}(),tnt={}.hasOwnProperty,Kc=function(r,t){for(var e in t)tnt.call(t,e)&&(r[e]=t[e]);function n(){this.constructor=r}return n.prototype=t.prototype,r.prototype=new n,r.__super__=t.prototype,r};ic=function(){function r(t){var e;this.file=t,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r}();var ent=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Kc(t,ic),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new YA).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t}(),LP=function(){function r(t,e){var n,i,s,a,o,d,f,_,w,x,B,P,R,N,Q,V,W;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=e+t.readInt(),w=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(d=0;d<256;++d)this.codeMap[d]=t.readByte();break;case 4:for(B=t.readUInt16(),x=B/2,t.pos+=6,s=function(){var et,ct;for(ct=[],d=et=0;0<=x?et<x:et>x;d=0<=x?++et:--et)ct.push(t.readUInt16());return ct}(),t.pos+=2,R=function(){var et,ct;for(ct=[],d=et=0;0<=x?et<x:et>x;d=0<=x?++et:--et)ct.push(t.readUInt16());return ct}(),f=function(){var et,ct;for(ct=[],d=et=0;0<=x?et<x:et>x;d=0<=x?++et:--et)ct.push(t.readUInt16());return ct}(),_=function(){var et,ct;for(ct=[],d=et=0;0<=x?et<x:et>x;d=0<=x?++et:--et)ct.push(t.readUInt16());return ct}(),i=(this.length-t.pos+this.offset)/2,o=function(){var et,ct;for(ct=[],d=et=0;0<=i?et<i:et>i;d=0<=i?++et:--et)ct.push(t.readUInt16());return ct}(),d=Q=0,W=s.length;Q<W;d=++Q)for(N=s[d],n=V=P=R[d];P<=N?V<=N:V>=N;n=P<=N?++V:--V)_[d]===0?a=n+f[d]:(a=o[_[d]/2+(n-P)-(x-d)]||0)!==0&&(a+=f[d]),this.codeMap[n]=65535&a}t.pos=w}return r.encode=function(t,e){var n,i,s,a,o,d,f,_,w,x,B,P,R,N,Q,V,W,et,ct,dt,gt,ht,It,St,ot,at,bt,vt,$t,Wt,Jt,qt,te,Yt,be,it,wt,Ft,Ut,jt,Vt,re,Zt,Be,Ie,ke;switch(vt=new YA,a=Object.keys(t).sort(function(He,Ke){return He-Ke}),e){case"macroman":for(R=0,N=function(){var He=[];for(P=0;P<256;++P)He.push(0);return He}(),V={0:0},s={},$t=0,te=a.length;$t<te;$t++)V[Zt=t[i=a[$t]]]==null&&(V[Zt]=++R),s[i]={old:t[i],new:V[t[i]]},N[i]=V[t[i]];return vt.writeUInt16(1),vt.writeUInt16(0),vt.writeUInt32(12),vt.writeUInt16(0),vt.writeUInt16(262),vt.writeUInt16(0),vt.write(N),{charMap:s,subtable:vt.data,maxGlyphID:R+1};case"unicode":for(at=[],w=[],W=0,V={},n={},Q=f=null,Wt=0,Yt=a.length;Wt<Yt;Wt++)V[ct=t[i=a[Wt]]]==null&&(V[ct]=++W),n[i]={old:ct,new:V[ct]},o=V[ct]-i,Q!=null&&o===f||(Q&&w.push(Q),at.push(i),f=o),Q=i;for(Q&&w.push(Q),w.push(65535),at.push(65535),St=2*(It=at.length),ht=2*Math.pow(Math.log(It)/Math.LN2,2),x=Math.log(ht/2)/Math.LN2,gt=2*It-ht,d=[],dt=[],B=[],P=Jt=0,be=at.length;Jt<be;P=++Jt){if(ot=at[P],_=w[P],ot===65535){d.push(0),dt.push(0);break}if(ot-(bt=n[ot].new)>=32768)for(d.push(0),dt.push(2*(B.length+It-P)),i=qt=ot;ot<=_?qt<=_:qt>=_;i=ot<=_?++qt:--qt)B.push(n[i].new);else d.push(bt-ot),dt.push(0)}for(vt.writeUInt16(3),vt.writeUInt16(1),vt.writeUInt32(12),vt.writeUInt16(4),vt.writeUInt16(16+8*It+2*B.length),vt.writeUInt16(0),vt.writeUInt16(St),vt.writeUInt16(ht),vt.writeUInt16(x),vt.writeUInt16(gt),Vt=0,it=w.length;Vt<it;Vt++)i=w[Vt],vt.writeUInt16(i);for(vt.writeUInt16(0),re=0,wt=at.length;re<wt;re++)i=at[re],vt.writeUInt16(i);for(Be=0,Ft=d.length;Be<Ft;Be++)o=d[Be],vt.writeUInt16(o);for(Ie=0,Ut=dt.length;Ie<Ut;Ie++)et=dt[Ie],vt.writeUInt16(et);for(ke=0,jt=B.length;ke<jt;ke++)R=B[ke],vt.writeUInt16(R);return{charMap:n,subtable:vt.data,maxGlyphID:W+1}}},r}(),PP=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Kc(t,ic),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,i,s;for(e.pos=this.offset,this.version=e.readUInt16(),s=e.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=s?i<s:i>s;i=0<=s?++i:--i)n=new LP(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var i,s;return n==null&&(n="macroman"),i=LP.encode(e,n),(s=new YA).writeUInt16(0),s.writeUInt16(1),i.table=s.data.concat(i.subtable),i},t}(),rnt=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Kc(t,ic),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),nnt=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Kc(t,ic),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(e.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(e.readInt());return i}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(e.readInt());return i}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),int=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Kc(t,ic),t.prototype.tag="post",t.prototype.parse=function(e){var n,i,s;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:break;case 131072:var a;for(i=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],s=[];e.pos<this.offset+this.length;)n=e.readByte(),s.push(this.names.push(e.readString(n)));return s;case 151552:return i=e.readUInt16(),this.offsets=e.read(i);case 196608:break;case 262144:return this.map=(function(){var o,d,f;for(f=[],a=o=0,d=this.file.maxp.numGlyphs;0<=d?o<d:o>d;a=0<=d?++o:--o)f.push(e.readUInt32());return f}).call(this)}},t}(),snt=function(r,t){this.raw=r,this.length=r.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},ont=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Kc(t,ic),t.prototype.tag="name",t.prototype.parse=function(e){var n,i,s,a,o,d,f,_,w,x,B;for(e.pos=this.offset,e.readShort(),n=e.readShort(),d=e.readShort(),i=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)i.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+d+e.readShort()});for(f={},a=w=0,x=i.length;w<x;a=++w)s=i[a],e.pos=s.offset,_=e.readString(s.length),o=new snt(_,s),f[B=s.nameID]==null&&(f[B]=[]),f[s.nameID].push(o);this.strings=f,this.copyright=f[0],this.fontFamily=f[1],this.fontSubfamily=f[2],this.uniqueSubfamily=f[3],this.fontName=f[4],this.version=f[5];try{this.postscriptName=f[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=f[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=f[7],this.manufacturer=f[8],this.designer=f[9],this.description=f[10],this.vendorUrl=f[11],this.designerUrl=f[12],this.license=f[13],this.licenseUrl=f[14],this.preferredFamily=f[15],this.preferredSubfamily=f[17],this.compatibleFull=f[18],this.sampleText=f[19]},t}(),ant=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Kc(t,ic),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),lnt=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Kc(t,ic),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,i,s,a,o,d,f;for(e.pos=this.offset,this.metrics=[],n=0,d=this.file.hhea.numberOfMetrics;0<=d?n<d:n>d;n=0<=d?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var _,w;for(w=[],n=_=0;0<=s?_<s:_>s;n=0<=s?++_:--_)w.push(e.readInt16());return w}(),this.widths=(function(){var _,w,x,B;for(B=[],_=0,w=(x=this.metrics).length;_<w;_++)a=x[_],B.push(a.advance);return B}).call(this),i=this.widths[this.widths.length-1],f=[],n=o=0;0<=s?o<s:o>s;n=0<=s?++o:--o)f.push(this.widths.push(i));return f},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),MP=[].slice,cnt=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Kc(t,ic),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,i,s,a,o,d,f,_,w,x;return e in this.cache?this.cache[e]:(a=this.file.loca,n=this.file.contents,i=a.indexOf(e),(s=a.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+i,o=(d=new YA(n.read(s))).readShort(),_=d.readShort(),x=d.readShort(),f=d.readShort(),w=d.readShort(),this.cache[e]=o===-1?new Ant(d,_,x,f,w):new unt(d,o,_,x,f,w),this.cache[e]))},t.prototype.encode=function(e,n,i){var s,a,o,d,f;for(o=[],a=[],d=0,f=n.length;d<f;d++)s=e[n[d]],a.push(o.length),s&&(o=o.concat(s.encode(i)));return a.push(o.length),{table:o,offsets:a}},t}(),unt=function(){function r(t,e,n,i,s,a){this.raw=t,this.numberOfContours=e,this.xMin=n,this.yMin=i,this.xMax=s,this.yMax=a,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r}(),Ant=function(){function r(t,e,n,i,s){var a,o;for(this.raw=t,this.xMin=e,this.yMin=n,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return r.prototype.encode=function(){var t,e,n;for(e=new YA(MP.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)e.pos=this.glyphOffsets[t];return e.data},r}(),hnt=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Kc(t,ic),t.prototype.tag="loca",t.prototype.parse=function(e){var n,i;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var s,a;for(a=[],i=0,s=this.length;i<s;i+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],i=0,s=this.length;i<s;i+=4)a.push(e.readUInt32());return a}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var i=new Uint32Array(this.offsets.length),s=0,a=0,o=0;o<i.length;++o)if(i[o]=s,a<n.length&&n[a]==o){++a,i[o]=s;var d=this.offsets[o],f=this.offsets[o+1]-d;f>0&&(s+=f)}for(var _=new Array(4*i.length),w=0;w<i.length;++w)_[4*w+3]=255&i[w],_[4*w+2]=(65280&i[w])>>8,_[4*w+1]=(16711680&i[w])>>16,_[4*w]=(4278190080&i[w])>>24;return _},t}(),dnt=function(){function r(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var t,e,n,i,s;for(e in i=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[e],t[e]=i[n];return t},r.prototype.glyphsFor=function(t){var e,n,i,s,a,o,d;for(i={},a=0,o=t.length;a<o;a++)i[s=t[a]]=this.font.glyf.glyphFor(s);for(s in e=[],i)(n=i[s])!=null&&n.compound&&e.push.apply(e,n.glyphIDs);if(e.length>0)for(s in d=this.glyphsFor(e))n=d[s],i[s]=n;return i},r.prototype.encode=function(t,e){var n,i,s,a,o,d,f,_,w,x,B,P,R,N,Q;for(i in n=PP.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(t),B={0:0},Q=n.charMap)B[(d=Q[i]).old]=d.new;for(P in x=n.maxGlyphID,a)P in B||(B[P]=x++);return _=function(V){var W,et;for(W in et={},V)et[V[W]]=W;return et}(B),w=Object.keys(_).sort(function(V,W){return V-W}),R=function(){var V,W,et;for(et=[],V=0,W=w.length;V<W;V++)o=w[V],et.push(_[o]);return et}(),s=this.font.glyf.encode(a,R,B),f=this.font.loca.encode(s.offsets,R),N={cmap:this.font.cmap.raw(),glyf:s.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(N["OS/2"]=this.font.os2.raw()),this.font.directory.encode(N)},r}();Gr.API.PDFObject=function(){var r;function t(){}return r=function(e,n){return(Array(n+1).join("0")+e).slice(-n)},t.convert=function(e){var n,i,s,a;if(Array.isArray(e))return"["+function(){var o,d,f;for(f=[],o=0,d=e.length;o<d;o++)n=e[o],f.push(t.convert(n));return f}().join(" ")+"]";if(typeof e=="string")return"/"+e;if(e!=null&&e.isString)return"("+e+")";if(e instanceof Date)return"(D:"+r(e.getUTCFullYear(),4)+r(e.getUTCMonth(),2)+r(e.getUTCDate(),2)+r(e.getUTCHours(),2)+r(e.getUTCMinutes(),2)+r(e.getUTCSeconds(),2)+"Z)";if({}.toString.call(e)==="[object Object]"){for(i in s=["<<"],e)a=e[i],s.push("/"+i+" "+t.convert(a));return s.push(">>"),s.join(`
`)}return""+e},t}();const tx={"circle-radius":8,"circle-color":"red","circle-stroke-width":1,"circle-stroke-color":"black"},ex={textSize:16,textHaloColor:"#FFFFFF",textHaloWidth:.8,textColor:"#000000",fallbackTextFont:["Open Sans Regular"]};let fnt=class{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xh.A4,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:300,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:$u.PNG,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:If.mm,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"map",o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:"maplibregl-marker",d=arguments.length>7&&arguments[7]!==void 0?arguments[7]:tx,f=arguments.length>8&&arguments[8]!==void 0?arguments[8]:"maplibregl-ctrl-attrib-inner",_=arguments.length>9&&arguments[9]!==void 0?arguments[9]:ex;Rn(this,"map"),Rn(this,"width"),Rn(this,"height"),Rn(this,"dpi"),Rn(this,"format"),Rn(this,"unit"),Rn(this,"fileName"),Rn(this,"markerClassName"),Rn(this,"markerCirclePaint"),Rn(this,"attributionClassName"),Rn(this,"attributionStyle"),this.map=t,this.width=e[0],this.height=e[1],this.dpi=n,this.format=i,this.unit=s,this.fileName=a,this.markerClassName=o,this.markerCirclePaint=d,this.attributionClassName=f,this.attributionStyle=_}renderMapPost(t){return t}getMarkers(){return this.map.getCanvasContainer().getElementsByClassName(this.markerClassName)}renderMarkers(t){const e=this.getMarkers();for(let n=0;n<e.length;n++){const i=e.item(n);if(!i)continue;const s=i.getAttribute("style");if(!s)continue;const a=/translate\(([^,]+)px,\s*([^,]+)px\)/,o=s.match(a);if(!o)continue;const d=parseInt(o[1]),f=parseInt(o[2]),_=this.map.unproject([d,f]),w=`point${n}`;t.addSource(w,{type:"geojson",data:{type:"Point",coordinates:[_.lng,_.lat]}}),t.addLayer({id:w,source:w,type:"circle",paint:this.markerCirclePaint})}return t}generate(){const t=this;JsLoadingOverlay.show({overlayBackgroundColor:"#5D5959",overlayOpacity:"0.6",spinnerIcon:"ball-spin",spinnerColor:"#2400FD",spinnerSize:"2x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetX:0,offsetY:0,containerID:null,lockScroll:!1,overlayZIndex:9998,spinnerZIndex:9999});const e=window.devicePixelRatio;Object.defineProperty(window,"devicePixelRatio",{get(){return t.dpi/96}});const n=document.createElement("div");n.className="hidden-map",document.body.appendChild(n);const i=document.createElement("div");i.style.width=this.toPixels(this.width),i.style.height=this.toPixels(this.height),n.appendChild(i);const s=this.map.getStyle();if(s&&s.sources){const o=s.sources;Object.keys(o).forEach(d=>{const f=o[d];Object.keys(f).forEach(_=>{f[_]||delete f[_]})})}let a=this.getRenderedMap(i,s);a.once("idle",()=>{this.addAttributions(a)?a.once("idle",()=>{a=this.renderMapPost(a),this.getMarkers().length===0?this.exportImage(a,n,e):(a=this.renderMarkers(a),a.once("idle",()=>{this.exportImage(a,n,e)}))}):(a=this.renderMapPost(a),this.getMarkers().length===0?this.exportImage(a,n,e):(a=this.renderMarkers(a),a.once("idle",()=>{this.exportImage(a,n,e)})))})}stripHtml(t){const e=document.createElement("div");return e.innerHTML=t,e.textContent||e.innerText||""}addAttributions(t){if(!this.map.getStyle().glyphs)return!1;const e=t.getContainer(),n=parseInt(e.style.width.replace("px",""))-5,i=parseInt(e.style.height.replace("px",""))-5,s=[n,i],a=t.unproject(s),o=e.getElementsByClassName(this.attributionClassName),d=[];if((o==null?void 0:o.length)>0){const B=o.item(0);if(B)for(let P=0;P<B.children.length;P++){const R=B.children.item(P);R&&d.push(this.stripHtml(R.outerHTML))}}else{const B=this.map.getStyle().sources;Object.keys(B).forEach(P=>{const R=B[P];if("attribution"in R){const N=R.attribution;d.push(this.stripHtml(N))}})}if(d.length===0)return!1;const f=d.join(" | "),_="attribution";t.addSource(_,{type:"geojson",data:{type:"Feature",geometry:{type:"Point",coordinates:[a.lng,a.lat]},properties:{attribution:f}}});const w=this.map.getStyle().layers.filter(B=>B.type==="symbol"&&B.layout&&"text-font"in B.layout),x=w.length>0&&w[0].layout?w[0].layout["text-font"]:this.attributionStyle.fallbackTextFont;return t.addLayer({id:_,source:_,type:"symbol",layout:{"text-field":["get","attribution"],"text-font":x,"text-max-width":parseInt(`${n/this.attributionStyle.textSize}`),"text-anchor":"bottom-right","text-justify":"right","text-size":this.attributionStyle.textSize},paint:{"text-halo-color":this.attributionStyle.textHaloColor,"text-halo-width":this.attributionStyle.textHaloWidth,"text-color":this.attributionStyle.textColor}}),!0}exportImage(t,e,n){var i;const s=t.getCanvas(),a=`${this.fileName}.${this.format}`;switch(this.format){case $u.PNG:this.toPNG(s,a);break;case $u.JPEG:this.toJPEG(s,a);break;case $u.PDF:this.toPDF(t,a);break;case $u.SVG:this.toSVG(s,a);break;default:console.error(`Invalid file format: ${this.format}`);break}t.remove(),(i=e.parentNode)==null||i.removeChild(e),Object.defineProperty(window,"devicePixelRatio",{get(){return n}}),e.remove(),JsLoadingOverlay.hide()}toPNG(t,e){const n=document.createElement("a");n.href=t.toDataURL(),n.download=e,n.click(),n.remove()}toJPEG(t,e){const n=t.toDataURL("image/jpeg",.85),i=document.createElement("a");i.href=n,i.download=e,i.click(),i.remove()}toPDF(t,e){const n=t.getCanvas(),i=new Gr({orientation:this.width>this.height?"l":"p",unit:this.unit,compress:!0,format:[this.width,this.height]});i.addImage(n.toDataURL("image/png"),"png",0,0,this.width,this.height,void 0,"FAST");const{lng:s,lat:a}=t.getCenter();i.setProperties({title:t.getStyle().name,subject:`center: [${s}, ${a}], zoom: ${t.getZoom()}`,creator:"Mapbox GL Export Plugin",author:"(c)Mapbox, (c)OpenStreetMap"}),i.save(e)}toSVG(t,e){const n=t.toDataURL("image/png"),i=Number(this.toPixels(this.width,this.dpi).replace("px","")),s=Number(this.toPixels(this.height,this.dpi).replace("px","")),a=`
    <svg xmlns="http://www.w3.org/2000/svg" 
      xmlns:xlink="http://www.w3.org/1999/xlink" 
      version="1.1" 
      width="${i}" 
      height="${s}" 
      viewBox="0 0 ${i} ${s}" 
      xml:space="preserve">
        <image style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(0,0,0); fill-rule: nonzero; opacity: 1;"  
      xlink:href="${n}" width="${i}" height="${s}"></image>
    </svg>`,o=document.createElement("a");o.href=`data:application/xml,${encodeURIComponent(a)}`,o.download=e,o.click(),o.remove()}toPixels(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:96;return this.unit===If.mm&&(e/=25.4),`${e*t}px`}},pnt=class extends fnt{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xh.A4,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:300,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:$u.PNG,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:If.mm,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"map",o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:tx,d=arguments.length>7&&arguments[7]!==void 0?arguments[7]:ex;super(t,e,n,i,s,a,"maplibregl-marker",o,"maplibregl-ctrl-attrib-inner",d)}getRenderedMap(t,e){const n=new PS.Map({container:t,style:e,center:this.map.getCenter(),zoom:this.map.getZoom(),bearing:this.map.getBearing(),pitch:this.map.getPitch(),interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,transformRequest:this.map._requestManager._transformRequestFn});this.map.getTerrain()&&(n.setMaxPitch(85),n.setPitch(this.map.getPitch()));const i=(this.map.style.imageManager||{}).images||[];return Object.keys(i).forEach(s=>{n.addImage(s,i[s].data)}),n}renderMapPost(t){const e=this.map.getTerrain();return e&&t.setTerrain({source:e.source,exaggeration:e.exaggeration}),t}},gnt=class{constructor(t){Rn(this,"controlContainer"),Rn(this,"exportContainer"),Rn(this,"crosshair"),Rn(this,"printableArea"),Rn(this,"map"),Rn(this,"exportButton"),Rn(this,"options",{PageSize:Xh.A4,PageOrientation:Vg.Landscape,Format:$u.PDF,DPI:L2[300],Crosshair:!1,PrintableArea:!1,Local:"en",AllowedSizes:Object.keys(Xh),Filename:"map",markerCirclePaint:tx,attributionStyle:ex}),Rn(this,"MAPLIB_CSS_PREFIX","maplibregl"),t&&(this.options=Object.assign(this.options,t)),this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}getTranslation(){const t=this.options.Local??"en";return mrt(t)}onAdd(t){var e;this.map=t,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add(`${this.MAPLIB_CSS_PREFIX}-ctrl`),this.controlContainer.classList.add(`${this.MAPLIB_CSS_PREFIX}-ctrl-group`),this.exportContainer=document.createElement("div"),this.exportContainer.classList.add(`${this.MAPLIB_CSS_PREFIX}-export-list`),this.exportButton=document.createElement("button"),this.exportButton.classList.add(`${this.MAPLIB_CSS_PREFIX}-ctrl-icon`),this.exportButton.classList.add(`${this.MAPLIB_CSS_PREFIX}-export-control`),this.exportButton.type="button",this.exportButton.addEventListener("click",()=>{this.exportButton.style.display="none",this.exportContainer.style.display="block",this.toggleCrosshair(!0),this.togglePrintableArea(!0)}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.exportButton),this.controlContainer.appendChild(this.exportContainer);const n=document.createElement("TABLE");n.className="print-table";const i={};(e=this.options.AllowedSizes)==null||e.forEach(_=>{Xh[_]&&(i[_]=Xh[_])});const s=this.createSelection(i,this.getTranslation().PageSize,"page-size",this.options.PageSize,(_,w)=>JSON.stringify(_[w]));n.appendChild(s);const a=this.createSelection(Vg,this.getTranslation().PageOrientation,"page-orientation",this.options.PageOrientation,(_,w)=>_[w]);n.appendChild(a);const o=this.createSelection($u,this.getTranslation().Format,"format-type",this.options.Format,(_,w)=>_[w]);n.appendChild(o);const d=this.createSelection(L2,this.getTranslation().DPI,"dpi-type",this.options.DPI,(_,w)=>_[w]);n.appendChild(d),this.exportContainer.appendChild(n);const f=document.createElement("button");return f.type="button",f.textContent=this.getTranslation().Generate,f.classList.add("generate-button"),f.addEventListener("click",()=>{const _=document.getElementById("mapbox-gl-export-page-size"),w=document.getElementById("mapbox-gl-export-page-orientation"),x=document.getElementById("mapbox-gl-export-format-type"),B=document.getElementById("mapbox-gl-export-dpi-type"),P=w.value;let R=JSON.parse(_.value);P===Vg.Portrait&&(R=R.reverse()),this.generateMap(t,R,Number(B.value),x.value,If.mm,this.options.Filename)}),this.exportContainer.appendChild(f),this.controlContainer}generateMap(t,e,n,i,s,a){new pnt(t,e,n,i,s,a,this.options.markerCirclePaint,this.options.attributionStyle).generate()}createSelection(t,e,n,i,s){const a=document.createElement("label");a.textContent=e;const o=document.createElement("select");o.setAttribute("id",`mapbox-gl-export-${n}`),o.style.width="100%",Object.keys(t).forEach(w=>{const x=document.createElement("option");x.setAttribute("value",s(t,w)),x.appendChild(document.createTextNode(w)),x.setAttribute("name",n),i===t[w]&&(x.selected=!0),o.appendChild(x)}),o.addEventListener("change",()=>{this.updatePrintableArea()});const d=document.createElement("TR"),f=document.createElement("TD"),_=document.createElement("TD");return f.appendChild(a),_.appendChild(o),d.appendChild(f),d.appendChild(_),d}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.exportButton||(this.exportButton.removeEventListener("click",this.onDocumentClick),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0),this.printableArea!==void 0&&(this.printableArea.destroy(),this.printableArea=void 0),this.map=void 0)}onDocumentClick(t){this.controlContainer&&!this.controlContainer.contains(t.target)&&this.exportContainer&&this.exportButton&&(this.exportContainer.style.display="none",this.exportButton.style.display="block",this.toggleCrosshair(!1),this.togglePrintableArea(!1))}toggleCrosshair(t){this.options.Crosshair===!0&&(t===!1?this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0):(this.crosshair=new rrt(this.map),this.crosshair.create()))}togglePrintableArea(t){this.options.PrintableArea===!0&&(t===!1?this.printableArea!==void 0&&(this.printableArea.destroy(),this.printableArea=void 0):(this.printableArea=new nrt(this.map),this.updatePrintableArea()))}updatePrintableArea(){if(this.printableArea===void 0)return;const t=document.getElementById("mapbox-gl-export-page-size"),e=document.getElementById("mapbox-gl-export-page-orientation").value;let n=JSON.parse(t.value);e===Vg.Portrait&&(n=n.reverse()),this.printableArea.updateArea(n[0],n[1])}};var RP=ynt,mnt=Object.prototype.hasOwnProperty;function ynt(){for(var r={},t=0;t<arguments.length;t++){var e=arguments[t];for(var n in e)mnt.call(e,n)&&(r[n]=e[n])}return r}var UP={exports:{}};(function(r,t){(function(){var e={};r.exports=e,e.simpleFilter=function(n,i){return i.filter(function(s){return e.test(n,s)})},e.test=function(n,i){return e.match(n,i)!==null},e.match=function(n,i,s){s=s||{};var a=0,o=[],d=i.length,f=0,_=0,w=s.pre||"",x=s.post||"",B=s.caseSensitive&&i||i.toLowerCase(),P;n=s.caseSensitive&&n||n.toLowerCase();for(var R=0;R<d;R++)P=i[R],B[R]===n[a]?(P=w+P+x,a+=1,_+=1+_):_=0,f+=_,o[o.length]=P;return a===n.length?(f=B===n?1/0:f,{rendered:o.join(""),score:f}):null},e.filter=function(n,i,s){return!i||i.length===0?[]:typeof n!="string"?i:(s=s||{},i.reduce(function(a,o,d,f){var _=o;s.extract&&(_=s.extract(o));var w=e.match(n,_,s);return w!=null&&(a[a.length]={string:w.rendered,score:w.score,index:d,original:o}),a},[]).sort(function(a,o){var d=o.score-a.score;return d||a.index-o.index}))}})()})(UP);var _nt=UP.exports,pa=function(r){return this.component=r,this.items=[],this.active=r.options.noInitialSelection?-1:0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,r.el.parentNode.insertBefore(this.wrapper,r.el.nextSibling),this};pa.prototype.show=function(){this.element.style.display="block"},pa.prototype.hide=function(){this.element.style.display="none"},pa.prototype.add=function(r){this.items.push(r)},pa.prototype.clear=function(){this.items=[],this.active=this.component.options.noInitialSelection?-1:0},pa.prototype.isEmpty=function(){return!this.items.length},pa.prototype.isVisible=function(){return this.element.style.display==="block"},pa.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var r=0;r<this.items.length;r++)this.drawItem(this.items[r],this.active===r);this.show()},pa.prototype.drawItem=function(r,t){var e=document.createElement("li"),n=document.createElement("a");t&&(e.className+=" active"),n.innerHTML=r.string,e.appendChild(n),this.element.appendChild(e),e.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),e.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,r)}).bind(this))},pa.prototype.handleMouseUp=function(r){this.selectingListItem=!1,this.component.value(r.original),this.clear(),this.draw()},pa.prototype.move=function(r){this.active=r,this.draw()},pa.prototype.previous=function(){this.move(this.active<=0?this.items.length-1:this.active-1)},pa.prototype.next=function(){this.move(this.active>=this.items.length-1?0:this.active+1)},pa.prototype.drawError=function(r){var t=document.createElement("li");t.innerHTML=r,this.element.appendChild(t),this.show()};var vnt=pa,bnt=RP,wnt=_nt,xnt=vnt,vo=function(r,t,e){return e=e||{},this.options=bnt({minLength:2,limit:5,filter:!0,hideOnBlur:!0,noInitialSelection:!0},e),this.el=r,this.data=t||[],this.list=new xnt(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(n){this.handleKeyUp(n.keyCode,n)}).bind(this),!1),this.el.addEventListener("keydown",(function(n){this.handleKeyDown(n)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(n){this.handlePaste(n)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};vo.prototype.handleKeyUp=function(r,t){if(!(r===40||r===38||r===27||r===9)){if(r===13){this.list.items[this.list.active]&&(this.list.handleMouseUp(this.list.items[this.list.active]),t.stopPropagation());return}this.handleInputChange(this.el.value)}},vo.prototype.handleKeyDown=function(r){switch(r.keyCode){case 13:this.list.active>=0&&(this.list.selectingListItem=!0);break;case 9:this.list.isEmpty()||(this.list.isVisible()&&r.preventDefault(),this.value(this.list.active>=0?this.list.items[this.list.active].original:null),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}},vo.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},vo.prototype.handlePaste=function(r){if(r.clipboardData)this.handleInputChange(r.clipboardData.getData("Text"));else{var t=this;setTimeout(function(){t.handleInputChange(r.target.value)},100)}},vo.prototype.handleInputChange=function(r){if(this.query=this.normalize(r),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(t){for(var e=0;e<t.length&&(this.list.add(t[e]),e!==this.options.limit-1);e++);this.list.draw()}).bind(this))},vo.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},vo.prototype.update=function(r){this.data=r,this.handleKeyUp()},vo.prototype.clear=function(){this.data=[],this.list.clear()},vo.prototype.normalize=function(r){return r=r.toLowerCase(),r},vo.prototype.match=function(r,t){return r.indexOf(t)>-1},vo.prototype.value=function(r){if(this.selected=r,this.el.value=this.getItemValue(r||{place_name:this.query}),document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this.el.dispatchEvent(t)}else this.el.fireEvent("onchange")},vo.prototype.getCandidates=function(r){var t={pre:"<strong>",post:"</strong>",extract:(function(n){return this.getItemValue(n)}).bind(this)},e;this.options.filter?(e=wnt.filter(this.query,this.data,t),e=e.map((function(n){return{original:n.original,string:this.render(n.original,n.string)}}).bind(this))):e=this.data.map((function(n){var i=this.render(n);return{original:n,string:i}}).bind(this)),r(e)},vo.prototype.getItemValue=function(r){return r},vo.prototype.render=function(r,t){if(t)return t;for(var e=r.original?this.getItemValue(r.original):this.getItemValue(r),n=this.normalize(e),i=n.lastIndexOf(this.query);i>-1;){var s=i+this.query.length;e=e.slice(0,i)+"<strong>"+e.slice(i,s)+"</strong>"+e.slice(s),i=n.slice(0,i).lastIndexOf(this.query)}return e},vo.prototype.renderError=function(r){this.list.drawError(r)};var Bnt=vo,OP=Bnt,Cnt=OP;typeof window<"u"&&(window.Suggestions=OP);var Ent="Expected a function",DP=NaN,Snt="[object Symbol]",Tnt=/^\s+|\s+$/g,Int=/^[-+]0x[0-9a-f]+$/i,Fnt=/^0b[01]+$/i,Lnt=/^0o[0-7]+$/i,Pnt=parseInt,Mnt=typeof Kd=="object"&&Kd&&Kd.Object===Object&&Kd,Rnt=typeof self=="object"&&self&&self.Object===Object&&self,Unt=Mnt||Rnt||Function("return this")(),Ont=Object.prototype,Dnt=Ont.toString,Nnt=Math.max,knt=Math.min,rx=function(){return Unt.Date.now()};function Qnt(r,t,e){var n,i,s,a,o,d,f=0,_=!1,w=!1,x=!0;if(typeof r!="function")throw new TypeError(Ent);t=NP(t)||0,nx(e)&&(_=!!e.leading,w="maxWait"in e,s=w?Nnt(NP(e.maxWait)||0,t):s,x="trailing"in e?!!e.trailing:x);function B(dt){var gt=n,ht=i;return n=i=void 0,f=dt,a=r.apply(ht,gt),a}function P(dt){return f=dt,o=setTimeout(Q,t),_?B(dt):a}function R(dt){var gt=dt-d,ht=dt-f,It=t-gt;return w?knt(It,s-ht):It}function N(dt){var gt=dt-d,ht=dt-f;return d===void 0||gt>=t||gt<0||w&&ht>=s}function Q(){var dt=rx();if(N(dt))return V(dt);o=setTimeout(Q,R(dt))}function V(dt){return o=void 0,x&&n?B(dt):(n=i=void 0,a)}function W(){o!==void 0&&clearTimeout(o),f=0,n=d=i=o=void 0}function et(){return o===void 0?a:V(rx())}function ct(){var dt=rx(),gt=N(dt);if(n=arguments,i=this,d=dt,gt){if(o===void 0)return P(d);if(w)return o=setTimeout(Q,t),B(d)}return o===void 0&&(o=setTimeout(Q,t)),a}return ct.cancel=W,ct.flush=et,ct}function nx(r){var t=typeof r;return!!r&&(t=="object"||t=="function")}function znt(r){return!!r&&typeof r=="object"}function Hnt(r){return typeof r=="symbol"||znt(r)&&Dnt.call(r)==Snt}function NP(r){if(typeof r=="number")return r;if(Hnt(r))return DP;if(nx(r)){var t=typeof r.valueOf=="function"?r.valueOf():r;r=nx(t)?t+"":t}if(typeof r!="string")return r===0?r:+r;r=r.replace(Tnt,"");var e=Fnt.test(r);return e||Lnt.test(r)?Pnt(r.slice(2),e?2:8):Int.test(r)?DP:+r}var Vnt=Qnt,ix={exports:{}},kf=typeof Reflect=="object"?Reflect:null,kP=kf&&typeof kf.apply=="function"?kf.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)},$y;kf&&typeof kf.ownKeys=="function"?$y=kf.ownKeys:Object.getOwnPropertySymbols?$y=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:$y=function(t){return Object.getOwnPropertyNames(t)};function Gnt(r){console&&console.warn&&console.warn(r)}var QP=Number.isNaN||function(t){return t!==t};function ii(){ii.init.call(this)}ix.exports=ii,ix.exports.once=$nt,ii.EventEmitter=ii,ii.prototype._events=void 0,ii.prototype._eventsCount=0,ii.prototype._maxListeners=void 0;var zP=10;function Wy(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(ii,"defaultMaxListeners",{enumerable:!0,get:function(){return zP},set:function(r){if(typeof r!="number"||r<0||QP(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");zP=r}}),ii.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ii.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||QP(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function HP(r){return r._maxListeners===void 0?ii.defaultMaxListeners:r._maxListeners}ii.prototype.getMaxListeners=function(){return HP(this)},ii.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var d=s[t];if(d===void 0)return!1;if(typeof d=="function")kP(d,this,e);else for(var f=d.length,_=KP(d,f),n=0;n<f;++n)kP(_[n],this,e);return!0};function VP(r,t,e,n){var i,s,a;if(Wy(e),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",t,e.listener?e.listener:e),s=r._events),a=s[t]),a===void 0)a=s[t]=e,++r._eventsCount;else if(typeof a=="function"?a=s[t]=n?[e,a]:[a,e]:n?a.unshift(e):a.push(e),i=HP(r),i>0&&a.length>i&&!a.warned){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=r,o.type=t,o.count=a.length,Gnt(o)}return r}ii.prototype.addListener=function(t,e){return VP(this,t,e,!1)},ii.prototype.on=ii.prototype.addListener,ii.prototype.prependListener=function(t,e){return VP(this,t,e,!0)};function jnt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function GP(r,t,e){var n={fired:!1,wrapFn:void 0,target:r,type:t,listener:e},i=jnt.bind(n);return i.listener=e,n.wrapFn=i,i}ii.prototype.once=function(t,e){return Wy(e),this.on(t,GP(this,t,e)),this},ii.prototype.prependOnceListener=function(t,e){return Wy(e),this.prependListener(t,GP(this,t,e)),this},ii.prototype.removeListener=function(t,e){var n,i,s,a,o;if(Wy(e),i=this._events,i===void 0)return this;if(n=i[t],n===void 0)return this;if(n===e||n.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if(typeof n!="function"){for(s=-1,a=n.length-1;a>=0;a--)if(n[a]===e||n[a].listener===e){o=n[a].listener,s=a;break}if(s<0)return this;s===0?n.shift():qnt(n,s),n.length===1&&(i[t]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",t,o||e)}return this},ii.prototype.off=ii.prototype.removeListener,ii.prototype.removeAllListeners=function(t){var e,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var s=Object.keys(n),a;for(i=0;i<s.length;++i)a=s[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=n[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this};function jP(r,t,e){var n=r._events;if(n===void 0)return[];var i=n[t];return i===void 0?[]:typeof i=="function"?e?[i.listener||i]:[i]:e?Knt(i):KP(i,i.length)}ii.prototype.listeners=function(t){return jP(this,t,!0)},ii.prototype.rawListeners=function(t){return jP(this,t,!1)},ii.listenerCount=function(r,t){return typeof r.listenerCount=="function"?r.listenerCount(t):qP.call(r,t)},ii.prototype.listenerCount=qP;function qP(r){var t=this._events;if(t!==void 0){var e=t[r];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}ii.prototype.eventNames=function(){return this._eventsCount>0?$y(this._events):[]};function KP(r,t){for(var e=new Array(t),n=0;n<t;++n)e[n]=r[n];return e}function qnt(r,t){for(;t+1<r.length;t++)r[t]=r[t+1];r.pop()}function Knt(r){for(var t=new Array(r.length),e=0;e<t.length;++e)t[e]=r[e].listener||r[e];return t}function $nt(r,t){return new Promise(function(e,n){function i(a){r.removeListener(t,s),n(a)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",i),e([].slice.call(arguments))}$P(r,t,s,{once:!0}),t!=="error"&&Wnt(r,i,{once:!0})})}function Wnt(r,t,e){typeof r.on=="function"&&$P(r,"error",t,e)}function $P(r,t,e,n){if(typeof r.on=="function")n.once?r.once(t,e):r.on(t,e);else if(typeof r.addEventListener=="function")r.addEventListener(t,function i(s){n.once&&r.removeEventListener(t,i),e(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var WP=ix.exports,Xnt={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}},Jnt={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"",ja:"",lv:"Meklt",pt:"Procurar",sr:"",zh:"",cs:"Vyhledvn",hu:"Keress",ka:"",nb:"Ske",sk:"Vyhadvanie",th:"",fi:"Hae",is:"Leita",ko:"",pl:"Szukaj",sl:"Iskanje",fa:"",ru:""},Ynt={placeholder:Jnt},XP={exports:{}};(function(r){(function(t,e,n){r.exports?r.exports=n():t[e]=n()})(Kd,"subtag",function(){var t="",e=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function n(d){return d.match(e)||[]}function i(d){return n(d).filter(function(f,_){return f&&_})}function s(d){return d=n(d),{language:d[1]||t,extlang:d[2]||t,script:d[3]||t,region:d[4]||t}}function a(d,f,_){Object.defineProperty(d,f,{value:_,enumerable:!0})}function o(d,f,_){function w(x){return n(x)[d]||t}a(w,"pattern",f),a(s,_,w)}return o(1,/^[a-zA-Z]{2,3}$/,"language"),o(2,/^[a-zA-Z]{3}$/,"extlang"),o(3,/^[a-zA-Z]{4}$/,"script"),o(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),a(s,"split",i),s})})(XP);var Znt=XP.exports,tit=Cnt,eit=Vnt,Va=RP,rit=WP.EventEmitter,JP=Xnt,nit=Ynt,iit=Znt;function YP(r,t){this._eventEmitter=new rit,this.options=Va({},this.options,t),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geocoderApi=r}YP.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,showResultsWhileTyping:!1,minLength:2,reverseGeocode:!1,limit:5,enableEventLogging:!0,marker:!0,popup:!1,maplibregl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,getItemValue:function(r){return r.text!==void 0?r.text:r.place_name},render:function(r){if(r.geometry){var o=r.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--result maplibregl-ctrl-geocoder--result"><svg class="mapboxgl-ctrl-geocoder--result-icon maplibre-ctrl-geocoder--result-icon" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36571 0 0 5.38676 0 12.0471C0 21.0824 12 32 12 32C12 32 24 21.0824 24 12.0471C24 5.38676 18.6343 0 12 0ZM12 16.3496C9.63428 16.3496 7.71429 14.4221 7.71429 12.0471C7.71429 9.67207 9.63428 7.74454 12 7.74454C14.3657 7.74454 16.2857 9.67207 16.2857 12.0471C16.2857 14.4221 14.3657 16.3496 12 16.3496Z" fill="#687078"/></svg><div><div class="mapboxgl-ctrl-geocoder--result-title maplibregl-ctrl-geocoder--result-title">'+o[0]+'</div><div class="mapboxgl-ctrl-geocoder--result-address maplibregl-ctrl-geocoder--result-address">'+o.splice(1,o.length).join(",")+"</div></div></div>"}else{var t=r.text,e=t.toLowerCase().indexOf(this.query.toLowerCase()),n=this.query.length,i=t.substring(0,e),s=t.substring(e,e+n),a=t.substring(e+n);return'<div class="mapboxgl-ctrl-geocoder--suggestion maplibregl-ctrl-geocoder--suggestion"><svg class="mapboxgl-ctrl-geocoder--suggestion-icon maplibre-ctrl-geocoder--suggestion-icon" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22.8702 20.1258H21.4248L20.9125 19.6318C22.7055 17.546 23.785 14.8382 23.785 11.8925C23.785 5.32419 18.4608 0 11.8925 0C5.32419 0 0 5.32419 0 11.8925C0 18.4608 5.32419 23.785 11.8925 23.785C14.8382 23.785 17.546 22.7055 19.6318 20.9125L20.1258 21.4248V22.8702L29.2739 32L32 29.2739L22.8702 20.1258ZM11.8925 20.1258C7.33676 20.1258 3.65923 16.4483 3.65923 11.8925C3.65923 7.33676 7.33676 3.65923 11.8925 3.65923C16.4483 3.65923 20.1258 7.33676 20.1258 11.8925C20.1258 16.4483 16.4483 20.1258 11.8925 20.1258Z" fill="#687078"/></svg><div class="mapboxgl-ctrl-geocoder--suggestion-info maplibregl-ctrl-geocoder--suggestion-info"><div class="mapboxgl-ctrl-geocoder--suggestion-title maplibregl-ctrl-geocoder--suggestion-title">'+i+'<span class="mapboxgl-ctrl-geocoder--suggestion-match maplibregl-ctrl-geocoder--suggestion-match">'+s+"</span>"+a+"</div></div></div>"}},popupRender:function(r){var t=r.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion maplibre-ctrl-geocoder--suggestion popup-suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title maplibre-ctrl-geocoder--suggestion-title popup-suggestion-title">'+t[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address maplibre-ctrl-geocoder--suggestion-address popup-suggestion-address">'+t.splice(1,t.length).join(",")+"</div></div>"},showResultMarkers:!0,debounceSearch:200},addTo:function(r){function t(n,i){if(!document.body.contains(i))throw new Error("Element provided to #addTo() exists, but is not in the DOM");var s=n.onAdd();i.appendChild(s)}if(r._controlContainer)r.addControl(this);else if(r instanceof HTMLElement)t(this,r);else if(typeof r=="string"){var e=document.querySelectorAll(r);if(e.length===0)throw new Error("Element ",r,"not found.");if(e.length>1)throw new Error("Geocoder can only be added to a single html element");t(this,e[0])}else throw new Error("Error: addTo must be a maplibre-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(r){if(r&&typeof r!="string"&&(this._map=r),this.setLanguage(),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this);var t=this.container=document.createElement("div");t.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl";var e=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input maplibregl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",eit(this._onKeyDown,this.options.debounceSearch)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton);var n=document.createElement("div");n.classList.add("mapboxgl-ctrl-geocoder--pin-right","maplibregl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button maplibregl-ctrl-geocoder--button";var i=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');return this._clearEl.appendChild(i),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),n.appendChild(this._clearEl),n.appendChild(this._loadingEl),t.appendChild(e),t.appendChild(this._inputEl),t.appendChild(n),this._typeahead=new tit(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit,noInitialSelection:!0}),this.setRenderFunction(this.options.render),this._typeahead.getItemValue=this.options.getItemValue,this.mapMarker=null,this.resultMarkers=[],this._handleMarker=this._handleMarker.bind(this),this._handleResultMarkers=this._handleResultMarkers.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._maplibregl=this.options.maplibregl,!this._maplibregl&&this.options.marker&&(console.error("No maplibregl detected in options. Map markers are disabled. Please set options.maplibregl."),this.options.marker=!1)),t},createIcon:function(r,t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+r+" maplibregl-ctrl-geocoder--icon maplibregl-ctrl-geocoder--icon-"+r),e.setAttribute("viewBox","0 0 18 18"),e.setAttribute("xml:space","preserve"),e.setAttribute("width",18),e.setAttribute("height",18),"innerHTML"in e)e.innerHTML=t;else{var n=document.createElement("div");n.innerHTML="<svg>"+t.valueOf().toString()+"</svg>";var i=n.firstChild,s=i.firstChild;e.appendChild(s)}return e},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_onPaste:function(r){var t=(r.clipboardData||window.clipboardData).getData("text");t.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(t)},_onKeyDown:function(r){var t=27,e=9;if(r.keyCode===t&&this.options.clearAndBlurOnEsc)return this._clear(r),this._inputEl.blur();var n=r.target&&r.target.shadowRoot?r.target.shadowRoot.activeElement:r.target,i=n?n.value:"";if(!i)return this.fresh=!0,r.keyCode!==e&&this.clear(r),this._clearEl.style.display="none";if(!(r.metaKey||[e,t,37,39,38,40].indexOf(r.keyCode)!==-1)){if(r.keyCode===13)if(!this.options.showResultsWhileTyping)this._typeahead.selected||this._geocode(n.value);else{this._typeahead.selected==null&&this.geocoderApi.getSuggestions?this._geocode(n.value,!0):this._typeahead.selected==null&&this.options.showResultMarkers&&this._fitBoundsForMarkers();return}n.value.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(n.value)}},_showButton:function(){this._inputEl.value.length>0&&(this._clearEl.style.display="block")},_hideButton:function(){this._typeahead.selected&&(this._clearEl.style.display="none")},_onBlur:function(r){this.options.clearOnBlur&&this._clearOnBlur(r),this.options.collapsed&&this._collapse()},_onChange:function(){var r=this._typeahead.selected;if(r&&!r.geometry)r.placeId?this._geocode(r.placeId,!0,!0):this._geocode(r.text,!0);else if(r&&JSON.stringify(r)!==this.lastSelected){if(this._clearEl.style.display="none",this.options.flyTo){var t;if(this._removeResultMarkers(),r.properties&&JP[r.properties.short_code])t=Va({},this.options.flyTo),this._map&&this._map.fitBounds(JP[r.properties.short_code].bbox,t);else if(r.bbox){var e=r.bbox;t=Va({},this.options.flyTo),this._map&&this._map.fitBounds([[e[0],e[1]],[e[2],e[3]]],t)}else{var n={zoom:this.options.zoom};t=Va({},n,this.options.flyTo),r.center?t.center=r.center:r.geometry&&r.geometry.type&&r.geometry.type==="Point"&&r.geometry.coordinates&&(t.center=r.geometry.coordinates),this._map&&this._map.flyTo(t)}}this.options.marker&&this._maplibregl&&this._handleMarker(r),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(r),this._typeahead.selected=null,this._eventEmitter.emit("result",{result:r})}},_getConfigForRequest:function(){var r=["bbox","limit","proximity","countries","types","language","reverseMode"],t=this,e=r.reduce(function(n,i){return t.options[i]&&(["countries","types","language"].indexOf(i)>-1?n[i]=t.options[i].split(/[\s,]+/):n[i]=t.options[i],i==="proximity"&&t.options[i]&&typeof t.options[i].longitude=="number"&&typeof t.options[i].latitude=="number"&&(n[i]=[t.options[i].longitude,t.options[i].latitude])),n},{});return e},_geocode:function(r,t,e){this._loadingEl.style.display="block",this._eventEmitter.emit("loading",{query:r}),this.inputString=r;var n=null,i=this._getConfigForRequest(),s;if(this.options.localGeocoderOnly)s=Promise.resolve();else if(this.options.reverseGeocode&&/(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/.test(r)){var a=r.split(/[\s(,)?]+/).map(function(f){return parseFloat(f,10)}).reverse();i.types&&i.types[0],i=Va(i,{query:a,limit:1}),"proximity"in i&&delete i.proximity,s=this.geocoderApi.reverseGeocode(i)}else i=Va(i,{query:r}),this.geocoderApi.getSuggestions?t?this.geocoderApi.searchByPlaceId&&e?s=this.geocoderApi.searchByPlaceId(i):s=this.geocoderApi.forwardGeocode(i):s=this.geocoderApi.getSuggestions(i):s=this.geocoderApi.forwardGeocode(i);var o=[];this.options.localGeocoder&&(o=this.options.localGeocoder(r),o||(o=[]));var d=[];return s.catch((function(f){n=f}).bind(this)).then((function(f){this._loadingEl.style.display="none";var _={};return f?_=f:_={type:"FeatureCollection",features:[]},_.config=i,this.fresh&&(this.fresh=!1),_.features=_.features?o.concat(_.features):o,this.options.externalGeocoder?(d=this.options.externalGeocoder(r,_.features,i)||[],d.then(function(w){return _.features=_.features?w.concat(_.features):w,_},function(){return _})):_}).bind(this)).then((function(f){if(n)throw n;this.options.filter&&f.features.length&&(f.features=f.features.filter(this.options.filter));var _=[];f.suggestions?_=f.suggestions:f.place?_=[f.place]:_=f.features,_.length?(this._clearEl.style.display="block",this._typeahead.update(_),(!this.options.showResultsWhileTyping||t)&&this.options.showResultMarkers&&(f.features.length>0||f.place)&&this._fitBoundsForMarkers(),this._eventEmitter.emit("results",f)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",f))}).bind(this)).catch((function(f){this._loadingEl.style.display="none",o.length&&this.options.localGeocoder||d.length&&this.options.externalGeocoder?(this._clearEl.style.display="block",this._typeahead.update(o)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:o}),this._eventEmitter.emit("error",{error:f})}).bind(this)),s},_clear:function(r){r&&r.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._clearEl.style.display="none",this._removeMarker(),this._removeResultMarkers(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(r){this._clear(r),this._inputEl.focus()},_clearOnBlur:function(r){var t=this;r.relatedTarget&&t._clear(r)},_onQueryResult:function(r){var t=r;if(t.features.length){var e=t.features[0];this._typeahead.selected=e,this._inputEl.value=e.place_name,this._onChange()}},_updateProximity:function(){if(this._map)if(this._map.getZoom()>9){var r=this._map.getCenter().wrap();this.setProximity({longitude:r.lng,latitude:r.lat})}else this.setProximity(null)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed","maplibregl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed","maplibregl-ctrl-geocoder--collapsed")},query:function(r){return this._geocode(r).then(this._onQueryResult),this},_renderError:function(){var r="<div class='mapbox-gl-geocoder--error maplibre-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(r)},_renderNoResults:function(){var r="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results maplibre-gl-geocoder--error maplibre-gl-geocoder--no-results'>No results found</div>";this._renderMessage(r)},_renderMessage:function(r){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(r)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var r=this.options.language.split(",")[0],t=iit.language(r),e=nit.placeholder[t];if(e)return e}return"Search"},_fitBoundsForMarkers:function(){if(!(this._typeahead.data.length<1)){var r=this._typeahead.data.filter(function(i){return typeof i!="string"}).slice(0,this.options.limit);if(this._clearEl.style.display="none",this.options.flyTo&&this._maplibregl&&this._map){var t={padding:100},e=Va({},t,this.options.flyTo),n=new this._maplibregl.LngLatBounds;r.forEach(function(i){n.extend(i.geometry.coordinates)}),this._map.fitBounds(n.toArray(),e)}return r.length>0&&this._maplibregl&&this._handleResultMarkers(r),this}},setInput:function(r){return this._inputEl.value=r,this._typeahead.selected=null,this._typeahead.clear(),r.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(r),this},setProximity:function(r){return this.options.proximity=r,this},getProximity:function(){return this.options.proximity},setRenderFunction:function(r){return r&&typeof r=="function"&&(this._typeahead.render=r),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(r){var t=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=r||this.options.language||t,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(r){return this.options.zoom=r,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(r){return this.options.flyTo=r,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(r){return this.placeholder=r||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(r){return this.options.bbox=r,this},getCountries:function(){return this.options.countries},setCountries:function(r){return this.options.countries=r,this},getTypes:function(){return this.options.types},setTypes:function(r){return this.options.types=r,this},getMinLength:function(){return this.options.minLength},setMinLength:function(r){return this.options.minLength=r,this._typeahead&&(this._typeahead.options.minLength=r),this},getLimit:function(){return this.options.limit},setLimit:function(r){return this.options.limit=r,this._typeahead&&(this._typeahead.options.limit=r),this},getFilter:function(){return this.options.filter},setFilter:function(r){return this.options.filter=r,this},setGeocoderApi:function(r){return this.geocoderApi=r,this},getGeocoderApi:function(){return this.geocoderApi},_handleMarker:function(r){if(this._map){this._removeMarker();var t={color:"#4668F2"},e=Va({},t,this.options.marker);this.mapMarker=new this._maplibregl.Marker(e);var n;if(this.options.popup){var i={},s=Va({},i,this.options.popup);n=new this._maplibregl.Popup(s).setHTML(this.options.popupRender(r))}return r.center?(this.mapMarker.setLngLat(r.center).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(n)):r.geometry&&r.geometry.type&&r.geometry.type==="Point"&&r.geometry.coordinates&&(this.mapMarker.setLngLat(r.geometry.coordinates).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(n)),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},_handleResultMarkers:function(r){if(this._map){this._removeResultMarkers();var t={color:"#4668F2"},e=Va({},t,this.options.showResultMarkers);return r.forEach((function(n){if(this.options.showResultMarkers&&this.options.showResultMarkers.element){var i=this.options.showResultMarkers.element.cloneNode(!0);e=Va(e,{element:i})}var s=new this._maplibregl.Marker(Va({},e,{element:i})),a;if(this.options.popup){var o={},d=Va({},o,this.options.popup);a=new this._maplibregl.Popup(d).setHTML(this.options.popupRender(n))}n.center?(s.setLngLat(n.center).addTo(this._map),this.options.popup&&s.setPopup(a)):n.geometry&&n.geometry.type&&n.geometry.type==="Point"&&n.geometry.coordinates&&(s.setLngLat(n.geometry.coordinates).addTo(this._map),this.options.popup&&s.setPopup(a)),this.resultMarkers.push(s)}).bind(this)),this}},_removeResultMarkers:function(){this.resultMarkers&&this.resultMarkers.length>0&&(this.resultMarkers.forEach(function(r){r.remove()}),this.resultMarkers=[])},on:function(r,t){return this._eventEmitter.on(r,t),this},off:function(r,t){return this._eventEmitter.removeListener(r,t),this}};var sit=YP;const oit=Vp(sit),ed={defaultOptions:{limitsUrl:"https://tilemaps.icgc.cat/vt/limits-tilejsonV3.json",geocoder:{peliasUrl1:"https://eines.icgc.cat/geocodificador/autocompletar?text=",peliasUrl2:"&layers=topo1%2Ctopo2%2Caddress&size=5"},mapOptions:{container:"map",center:{0:1.537786,1:41.837539},zoom:7.5,bearing:0,pitch:0,hash:!1,style:"https://geoserveis.icgc.cat/styles/icgc_mapa_base_gris.json.json",maxZoom:18,maxPitch:85},logoIcgcOptions:{logoUrlColor:"https://eines.icgc.cat/recursos/logos/icgc_logo_color.png",logoUrlWhite:"https://eines.icgc.cat/recursos/logos/icgc_logo_blanc.svg",logoLink:"https://www.icgc.cat",logoTitle:"Institut Cartogrfic i Geolgic de Catalunya",logoWidth:100,logoOpacity:.6},logoGencatOptions:{logoUrlColor:"https://eines.icgc.cat/recursos/logos/gencat_logo_color.png",logoUrlWhite:"https://eines.icgc.cat/recursos/logos/gencat_logo_blanc.png",logoLink:"https://web.gencat.cat/",logoTitle:"Generalitat de Catalunya",logoWidth:100,logoOpacity:.6},map3dOptions:{spaceErrorFactor:2,exaggeration:1,zfactor:48,minZoomRange:15.5,maxZoomRange:22,urlTilesetCities:"https://geoserveis.icgc.cat/servei/catalunya/ciutats/3dtiles/v1/tilesetV1.0.json",layerIdOrder:"place-isolated",sourceLayerFilterId:"place",minZoomFilter:14,layerId3d:"edificisMapboxLayer",terrainSource:"ICGC5M",style3dName:"orto3d",imageIcon:"https://eines.icgc.cat/recursos//images/stick.png"},baseStyles:[{key:"TOPO",url:"https://geoserveis.icgc.cat/styles/icgc_mapa_base_topografic.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_estandard.png"},{key:"ORTO",url:"https://geoserveis.icgc.cat/styles/icgc_orto_estandard.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_orto_estandard.png"},{key:"ORTO3D",url:"https://eines.icgc.cat/recursos//styles/icgc_orto_3d.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_orto_estandard.png"},{key:"ORTOHYBRID",url:"https://geoserveis.icgc.cat/styles/icgc_orto_hibrida.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_orto_hibrida.png"},{key:"ADMIN",url:"https://geoserveis.icgc.cat/styles/icgc_limits_administratius_gris.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_delimitacio_limits_administratius.png"},{key:"DARK",url:"https://geoserveis.icgc.cat/styles/icgc_mapa_base_fosc.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_base_fosc.png"},{key:"LIGHT",url:"https://geoserveis.icgc.cat/styles/icgc_mapa_base_gris.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_base_gris.png"},{key:"GEOLOGY",url:"https://geoserveis.icgc.cat/styles/icgc_geologic_informacio.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_geologic_informacio.png"},{key:"RASTER",substyles:{TOPO:{url:"https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/topografic/MON3857NW/{z}/{x}/{y}.png",image:"https://icgc-web-pro.s3.eu-central-1.amazonaws.com/produccio/s3fs-public/2024-10/mapabase_topo.jpg"},ADMIN:{url:"https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/administratiu/MON3857NW/{z}/{x}/{y}.png",image:"https://icgc-web-pro.s3.eu-central-1.amazonaws.com/produccio/s3fs-public/2024-10/mapabase_administratiu.jpg"},LIGHT:{url:"https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/topografic-gris/MON3857NW/{z}/{x}/{y}.png",image:"https://icgc-web-pro.s3.eu-central-1.amazonaws.com/produccio/s3fs-public/2024-10/mapabase_topo_gris.jpg"},STANDARD:{url:"https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/estandard/MON3857NW/{z}/{x}/{y}.png",image:"https://icgc-web-pro.s3.eu-central-1.amazonaws.com/produccio/s3fs-public/2024-10/mapabase_estandard_0.jpg"},Simplified:{url:"https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/simplificat/MON3857NW/{z}/{x}/{y}.png",image:"https://icgc-web-pro.s3.eu-central-1.amazonaws.com/produccio/s3fs-public/2024-10/mapabase_simplificat.jpg"},ORTO:{url:"https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/orto/MON3857NW/{z}/{x}/{y}.png",image:"https://icgc-web-pro.s3.eu-central-1.amazonaws.com/produccio/s3fs-public/2024-10/mapabase_orto.jpg"},ORTOGREY:{url:"https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/orto-gris/MON3857NW/{z}/{x}/{y}.png",image:"https://icgc-web-pro.s3.eu-central-1.amazonaws.com/produccio/s3fs-public/2024-10/mapabase_orto_gris.jpg"},ORTOHYBRID:{url:"https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/orto-hibrida/MON3857NW/{z}/{x}/{y}.png",image:"https://icgc-web-pro.s3.eu-central-1.amazonaws.com/produccio/s3fs-public/2024-10/mapabase_orto_hibida.jpg"}}}],urlTerrainICGC:[{name:"ICGC5M",url:"https://tilemaps.icgc.cat/tileserver/tileserver/terreny-5m-30m-rgb-extent/{z}/{x}/{y}.png"},{name:"WORLD30M",url:"https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png",encoding:"terrarium"}],ortoLayersICGC:[{name:"ortofotoColorProvisional",key:"ortofoto_color_provisional",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_provisional"},{name:"ortofotoColor2023",key:"ortofoto_color_2023",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2023"},{name:"ortofotoColor2022",key:"ortofoto_color_2022",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2022"},{name:"ortofotoColor2021",key:"ortofoto_color_2021",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2021"},{name:"ortofotoColor2020",key:"ortofoto_color_2020",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2020"},{name:"ortofotoColor2019",key:"ortofoto_color_2019",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2019"},{name:"ortofotoColor2018",key:"ortofoto_color_2018",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2018"},{name:"ortofotoColor2017",key:"ortofoto_color_2017",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2017"},{name:"ortofotoColor2016",key:"ortofoto_color_2016",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2016"},{name:"ortofotoColor2015",key:"ortofoto_color_2015",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2015"},{name:"ortofotoColor2014",key:"ortofoto_color_2014",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2014"},{name:"ortofotoColor2013",key:"ortofoto_color_2013",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2013"},{name:"ortofotoColor2012",key:"ortofoto_color_2012",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2012"},{name:"ortofotoColor2011",key:"ortofoto_color_2011",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2011"},{name:"ortofotoColor2010",key:"ortofoto_color_2010",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2010"},{name:"ortofotoColor2009",key:"ortofoto_color_2009",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2009"},{name:"ortofotoColor2008",key:"ortofoto_color_2008",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2008"},{name:"ortofotoColor20062007",key:"ortofoto_color_2006-2007",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2006-2007"},{name:"ortofotoColor20042005",key:"ortofoto_color_2004-2005",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2004-2005"},{name:"ortofotoColor20002003",key:"ortofoto_color_2000-2003",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2000-2003"},{name:"ortofotoBlancINegre1998",key:"ortofoto_blanc_i_negre_1998",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1998"},{name:"ortofotoBlancINegre19941997",key:"ortofoto_blanc_i_negre_1994-1997",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1994-1997"},{name:"ortofotoColor1993",key:"ortofoto_color_1993",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_1993"},{name:"ortofotoBlancINegre19831992",key:"ortofoto_blanc_i_negre_1983-1992",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1983-1992"},{name:"ortofotoBlancINegre19701977",key:"ortofoto_blanc_i_negre_1970-1977",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1970-1977"},{name:"ortofotoBlancINegre1956",key:"ortofoto_blanc_i_negre_1956",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1956"},{name:"ortofotoBlancINegre1945",key:"ortofoto_blanc_i_negre_1945",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1945"},{name:"ortofotoColorSerieAnual",key:"ortofoto_color_serie_anual",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_serie_anual"},{name:"ortofotoInfraroigProvisional",key:"ortofoto_infraroig_provisional",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_provisional"},{name:"ortofotoInfraroig2023",key:"ortofoto_infraroig_2023",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2023"},{name:"ortofotoInfraroig2022",key:"ortofoto_infraroig_2022",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2022"},{name:"ortofotoInfraroig2021",key:"ortofoto_infraroig_2021",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2021"},{name:"ortofotoInfraroig2020",key:"ortofoto_infraroig_2020",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2020"},{name:"ortofotoInfraroig2019",key:"ortofoto_infraroig_2019",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2019"},{name:"ortofotoInfraroig2018",key:"ortofoto_infraroig_2018",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2018"},{name:"ortofotoInfraroig2017",key:"ortofoto_infraroig_2017",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2017"},{name:"ortofotoInfraroig2016",key:"ortofoto_infraroig_2016",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2016"},{name:"ortofotoInfraroig2015",key:"ortofoto_infraroig_2015",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2015"},{name:"ortofotoInfraroig2014",key:"ortofoto_infraroig_2014",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2014"},{name:"ortofotoInfraroig2013",key:"ortofoto_infraroig_2013",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2013"},{name:"ortofotoInfraroig2012",key:"ortofoto_infraroig_2012",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2012"},{name:"ortofotoInfraroig2011",key:"ortofoto_infraroig_2011",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2011"},{name:"ortofotoInfraroig2010",key:"ortofoto_infraroig_2010",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2010"},{name:"ortofotoInfraroig2009",key:"ortofoto_infraroig_2009",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2009"},{name:"ortofotoInfraroig2008",key:"ortofoto_infraroig_2008",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2008"},{name:"ortofotoInfraroig20062007",key:"ortofoto_infraroig_2006-2007",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2006-2007"},{name:"ortofotoInfraroig19961997",key:"ortofoto_infraroig_1996-1997",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_1996-1997"},{name:"ortofotoInfraroigSerieAnual",key:"ortofoto_infraroig_serie_anual",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_serie_anual"}],vectorLayersICGC:[{name:"agrupacionsCensals2015",key:"agrupacions_censals_2015"},{name:"agrupacionsCensals2016",key:"agrupacions_censals_2016"},{name:"agrupacionsCensals2017",key:"agrupacions_censals_2017"},{name:"agrupacionsCensals2018",key:"agrupacions_censals_2018"},{name:"agrupacionsCensals2019",key:"agrupacions_censals_2019"},{name:"agrupacionsCensals2020",key:"agrupacions_censals_2020"},{name:"agrupacionsCensals2021",key:"agrupacions_censals_2021"},{name:"agrupacionsCensalsVigent",key:"agrupacions_censals_vigent"},{name:"agrupacionsCensalsVigentText",key:"agrupacions_censals_vigent_text"},{name:"areesBasiquesPolicials2019",key:"arees_basiques_policials_2019"},{name:"areesBasiquesPolicials2020",key:"arees_basiques_policials_2020"},{name:"areesBasiquesPolicials2022",key:"arees_basiques_policials_2022"},{name:"areesBasiquesPolicialsVigent",key:"arees_basiques_policials_vigent"},{name:"areesBasiquesPolicialsVigentText",key:"arees_basiques_policials_vigent_text"},{name:"areesBasiquesSalutVigent",key:"arees_basiques_salut_vigent"},{name:"areesBasiquesServeisSocialsVigent",key:"arees_basiques_serveis_socials_vigent"},{name:"areesBasiquesServeisSocialsVigentText",key:"arees_basiques_serveis_socials_vigent_text"},{name:"areesGestioAssistencialVigent",key:"arees_gestio_assistencial_vigent"},{name:"areesHidrogeologiquesAquifersVigent",key:"arees_hidrogeologiques_aquifers_vigent"},{name:"catalunyaVigent",key:"catalunya_vigent"},{name:"catalunyaVigentText",key:"catalunya_vigent_text"},{name:"comarques2022",key:"comarques_2022"},{name:"comarquesVigent",key:"comarques_vigent"},{name:"comarquesVigentText",key:"comarques_vigent_text"},{name:"districtesCensals2015",key:"districtes_censals_2015"},{name:"districtesCensals2016",key:"districtes_censals_2016"},{name:"districtesCensals2017",key:"districtes_censals_2017"},{name:"districtesCensals2018",key:"districtes_censals_2018"},{name:"districtesCensals2019",key:"districtes_censals_2019"},{name:"districtesCensals2020",key:"districtes_censals_2020"},{name:"districtesCensals2021",key:"districtes_censals_2021"},{name:"districtesCensals2022",key:"districtes_censals_2022"},{name:"districtesCensals2023",key:"districtes_censals_2023"},{name:"districtesCensalsVigent",key:"districtes_censals_vigent"},{name:"districtesCensalsVigentText",key:"districtes_censals_vigent_text"},{name:"incendisForestalsVigent",key:"incendis_forestals_vigent"},{name:"incendisForestalsVigentText",key:"incendis_forestals_vigent_text"},{name:"municipis2022",key:"municipis_2022"},{name:"municipis2022Text",key:"municipis_2022_text"},{name:"municipisVigent",key:"municipis_vigent"},{name:"municipisVigentText",key:"municipis_vigent_text"},{name:"partitsJudicialsVigent",key:"partits_judicials_vigent"},{name:"partitsJudicialsVigentText",key:"partits_judicials_vigent_text"},{name:"plaTerritorial2015",key:"pla_territorial_2015"},{name:"plaTerritorialVigent",key:"pla_territorial_vigent"},{name:"plaTerritorialVigentText",key:"pla_territorial_vigent_text"},{name:"provinciesVigent",key:"provincies_vigent"},{name:"provinciesVigentText",key:"provincies_vigent_text"},{name:"regionsPolicialsVigent",key:"regions_policials_vigent"},{name:"regionsPolicialsVigentText",key:"regions_policials_vigent_text"},{name:"regionsSanitariesVigent",key:"regions_sanitaries_vigent"},{name:"regionsSanitariesVigentText",key:"regions_sanitaries_vigent_text"},{name:"seccionsCensals2015",key:"seccions_censals_2015"},{name:"seccionsCensals2016",key:"seccions_censals_2016"},{name:"seccionsCensals2017",key:"seccions_censals_2017"},{name:"seccionsCensals2018",key:"seccions_censals_2018"},{name:"seccionsCensals2019",key:"seccions_censals_2019"},{name:"seccionsCensals2020",key:"seccions_censals_2020"},{name:"seccionsCensals2021",key:"seccions_censals_2021"},{name:"seccionsCensals2022",key:"seccions_censals_2022"},{name:"seccionsCensals2023",key:"seccions_censals_2023"},{name:"seccionsCensalsVigent",key:"seccions_censals_vigent"},{name:"seccionsCensalsVigentText",key:"seccions_censals_vigent_text"},{name:"sectorsSanitarisVigent",key:"sectors_sanitaris_vigent"},{name:"vegueriesVigent",key:"vegueries_vigent"},{name:"vegueriesVigentText",key:"vegueries_vigent_text"}],vectorLayers:[{key:"cobertes2018",url:"https://tilemaps.icgc.cat/tileserver/cobertes_tilejson.json",legend:"https://eines.icgc.cat/recursos//images/llegendaCobertesSol2018.jpg"}],wmsLayers:[{key:"espaisInteresGeologic",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/espais-interes-geologic/wms/service?&service=WMS&request=GetMap&layers=espais-interes-geologic&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},{key:"gravimetriaBouguer500000",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/gravimetria/wms/service?&service=WMS&request=GetMap&layers=anomalia_bouguer_500000&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},{key:"cobertesSol2018",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms/service?&service=WMS&request=GetMap&layers=cobertes_2018&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},{key:"administratiu",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/administratiu/MON3857NW/{z}/{x}/{y}.png"},{key:"simplificat",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/simplificat/MON3857NW/{z}/{x}/{y}.png"},{key:"cims",layer:"",url:"https://geoserveis.icgc.cat/icc_100cims/wms/service?REQUEST=GetMap&SERVICE=WMS&VERSION=1.1.1&LAYERS=0&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&SRS=EPSG:25831&BBOX=137118.923076923,4488408.75,650959.076923077,4749634.75&WIDTH=895&HEIGHT=455"},{key:"cobertesSol",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms?REQUEST=GetMap&SERVICE=WMS&VERSION=1.3.0&LAYERS=cobertes_2009&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&CRS=EPSG:25831&BBOX=374110.828167253,4639230.79853085,452621.120632226,4703578.45000215&WIDTH=1020&HEIGHT=836"}],fgbLayers:[{name:"agrupacionsCensalsVigent",key:"agrupacions_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent.fgb"},{name:"agrupacionsCensalsVigentText",key:"agrupacions_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent_text.fgb"},{name:"areesBasiquesPolicialsVigent",key:"arees_basiques_policials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent.fgb"},{name:"areesBasiquesPolicialsVigentText",key:"arees_basiques_policials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent_text.fgb"},{name:"areesBasiquesSalutVigent",key:"arees_basiques_salut_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_salut_vigent.fgb"},{name:"areesBasiquesServeisSocialsVigent",key:"arees_basiques_serveis_socials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent.fgb"},{name:"areesBasiquesServeisSocialsVigentText",key:"arees_basiques_serveis_socials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent_text.fgb"},{name:"areesGestioAssistencialVigent",key:"arees_gestio_assistencial_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_gestio_assistencial_vigent.fgb"},{name:"areesHidrogeologiquesAquifersVigent",key:"arees_hidrogeologiques_aquifers_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_hidrogeologiques_aquifers_vigent.fgb"},{name:"catalunyaVigent",key:"catalunya_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent.fgb"},{name:"catalunyaVigentText",key:"catalunya_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent_text.fgb"},{name:"comarquesVigent",key:"comarques_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent.fgb"},{name:"comarquesVigentText",key:"comarques_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent_text.fgb"},{name:"districtesCensalsVigent",key:"districtes_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent.fgb"},{name:"districtesCensalsVigentText",key:"districtes_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent_text.fgb"},{name:"incendisForestalsVigent",key:"incendis_forestals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent.fgb"},{name:"incendisForestalsVigentText",key:"incendis_forestals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent_text.fgb"},{name:"municipisVigent",key:"municipis_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent.fgb"},{name:"municipisVigentText",key:"municipis_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent_text.fgb"},{name:"partitsJudicialsVigent",key:"partits_judicials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent.fgb"},{name:"partitsJudicialsVigentText",key:"partits_judicials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent_text.fgb"},{name:"plaTerritorialVigent",key:"pla_territorial_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent.fgb"},{name:"plaTerritorialVigentText",key:"pla_territorial_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent_text.fgb"},{name:"provinciesVigent",key:"provincies_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent.fgb"},{name:"provinciesVigentText",key:"provincies_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent_text.fgb"},{name:"regionsPolicialsVigent",key:"regions_policials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent.fgb"},{name:"regionsPolicialsVigentText",key:"regions_policials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent_text.fgb"},{name:"regionsSanitariesVigent",key:"regions_sanitaries_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent.fgb"},{name:"regionsSanitariesVigentText",key:"regions_sanitaries_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent_text.fgb"},{name:"seccionsCensalsVigent",key:"seccions_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent.fgb"},{name:"seccionsCensalsVigentText",key:"seccions_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent_text.fgb"},{name:"sectorsSanitarisVigent",key:"sectors_sanitaris_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/sectors_sanitaris_vigent.fgb"},{name:"vegueriesVigent",key:"vegueries_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent.fgb"},{name:"vegueriesVigentText",key:"vegueries_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent_text.fgb"}]},Styles:{TOPO:"https://geoserveis.icgc.cat/styles/icgc_mapa_base_topografic.json",ORTO:"https://geoserveis.icgc.cat/styles/icgc_orto_estandard.json",ORTO3D:"https://eines.icgc.cat/recursos//styles/icgc_orto_3d.json",ORTOHYBRID:"https://geoserveis.icgc.cat/styles/icgc_orto_hibrida.json",ADMIN:"https://geoserveis.icgc.cat/styles/icgc_limits_administratius_gris.json",DARK:"https://geoserveis.icgc.cat/styles/icgc_mapa_base_fosc.json",LIGHT:"https://geoserveis.icgc.cat/styles/icgc_mapa_base_gris.json",GEOLOGY:"https://geoserveis.icgc.cat/styles/icgc_geologic_informacio.json",RASTER:{TOPO:"https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/topografic/MON3857NW/{z}/{x}/{y}.png",ADMIN:"https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/administratiu/MON3857NW/{z}/{x}/{y}.png",LIGHT:"https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/topografic-gris/MON3857NW/{z}/{x}/{y}.png",STANDARD:"https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/estandard/MON3857NW/{z}/{x}/{y}.png",SIMPLIFIED:"https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/simplificat/MON3857NW/{z}/{x}/{y}.png",ORTO:"https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/orto/MON3857NW/{z}/{x}/{y}.png",ORTOGREY:"https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/orto-gris/MON3857NW/{z}/{x}/{y}.png",ORTOHYBRID:"https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/orto-hibrida/MON3857NW/{z}/{x}/{y}.png"}},Terrains:{ICGC5M:"https://tilemaps.icgc.cat/tileserver/tileserver/terreny-5m-30m-rgb-extent/{z}/{x}/{y}.png",WORLD30M:"https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png"},Layers:{Orto:{ortofotoColorProvisional:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_provisional",ortofotoColor2023:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2023",ortofotoColor2022:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2022",ortofotoColor2021:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2021",ortofotoColor2020:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2020",ortofotoColor2019:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2019",ortofotoColor2018:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2018",ortofotoColor2017:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2017",ortofotoColor2016:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2016",ortofotoColor2015:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2015",ortofotoColor2014:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2014",ortofotoColor2013:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2013",ortofotoColor2012:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2012",ortofotoColor2011:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2011",ortofotoColor2010:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2010",ortofotoColor2009:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2009",ortofotoColor2008:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2008",ortofotoColor20062007:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2006-2007",ortofotoColor20042005:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2004-2005",ortofotoColor20002003:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2000-2003",ortofotoBlancINegre1998:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1998",ortofotoBlancINegre19941997:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1994-1997",ortofotoColor1993:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_1993",ortofotoBlancINegre19831992:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1983-1992",ortofotoBlancINegre19701977:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1970-1977",ortofotoBlancINegre1956:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1956",ortofotoBlancINegre1945:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1945",ortofotoColorSerieAnual:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_serie_anual",ortofotoInfraroigProvisional:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_provisional",ortofotoInfraroig2023:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2023",ortofotoInfraroig2022:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2022",ortofotoInfraroig2021:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2021",ortofotoInfraroig2020:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2020",ortofotoInfraroig2019:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2019",ortofotoInfraroig2018:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2018",ortofotoInfraroig2017:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2017",ortofotoInfraroig2016:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2016",ortofotoInfraroig2015:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2015",ortofotoInfraroig2014:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2014",ortofotoInfraroig2013:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2013",ortofotoInfraroig2012:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2012",ortofotoInfraroig2011:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2011",ortofotoInfraroig2010:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2010",ortofotoInfraroig2009:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2009",ortofotoInfraroig2008:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2008",ortofotoInfraroig20062007:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2006-2007",ortofotoInfraroig19961997:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_1996-1997",ortofotoInfraroigSerieAnual:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_serie_anual"},VectorAdmin:{agrupacionsCensals2015:"agrupacions_censals_2015",agrupacionsCensals2016:"agrupacions_censals_2016",agrupacionsCensals2017:"agrupacions_censals_2017",agrupacionsCensals2018:"agrupacions_censals_2018",agrupacionsCensals2019:"agrupacions_censals_2019",agrupacionsCensals2020:"agrupacions_censals_2020",agrupacionsCensals2021:"agrupacions_censals_2021",agrupacionsCensalsVigent:"agrupacions_censals_vigent",agrupacionsCensalsVigentText:"agrupacions_censals_vigent_text",areesBasiquesPolicials2019:"arees_basiques_policials_2019",areesBasiquesPolicials2020:"arees_basiques_policials_2020",areesBasiquesPolicials2022:"arees_basiques_policials_2022",areesBasiquesPolicialsVigent:"arees_basiques_policials_vigent",areesBasiquesPolicialsVigentText:"arees_basiques_policials_vigent_text",areesBasiquesSalutVigent:"arees_basiques_salut_vigent",areesBasiquesServeisSocialsVigent:"arees_basiques_serveis_socials_vigent",areesBasiquesServeisSocialsVigentText:"arees_basiques_serveis_socials_vigent_text",areesGestioAssistencialVigent:"arees_gestio_assistencial_vigent",areesHidrogeologiquesAquifersVigent:"arees_hidrogeologiques_aquifers_vigent",catalunyaVigent:"catalunya_vigent",catalunyaVigentText:"catalunya_vigent_text",comarques2022:"comarques_2022",comarquesVigent:"comarques_vigent",comarquesVigentText:"comarques_vigent_text",districtesCensals2015:"districtes_censals_2015",districtesCensals2016:"districtes_censals_2016",districtesCensals2017:"districtes_censals_2017",districtesCensals2018:"districtes_censals_2018",districtesCensals2019:"districtes_censals_2019",districtesCensals2020:"districtes_censals_2020",districtesCensals2021:"districtes_censals_2021",districtesCensals2022:"districtes_censals_2022",districtesCensals2023:"districtes_censals_2023",districtesCensalsVigent:"districtes_censals_vigent",districtesCensalsVigentText:"districtes_censals_vigent_text",incendisForestalsVigent:"incendis_forestals_vigent",incendisForestalsVigentText:"incendis_forestals_vigent_text",municipis2022:"municipis_2022",municipis2022Text:"municipis_2022_text",municipisVigent:"municipis_vigent",municipisVigentText:"municipis_vigent_text",partitsJudicialsVigent:"partits_judicials_vigent",partitsJudicialsVigentText:"partits_judicials_vigent_text",plaTerritorial2015:"pla_territorial_2015",plaTerritorialVigent:"pla_territorial_vigent",plaTerritorialVigentText:"pla_territorial_vigent_text",provinciesVigent:"provincies_vigent",provinciesVigentText:"provincies_vigent_text",regionsPolicialsVigent:"regions_policials_vigent",regionsPolicialsVigentText:"regions_policials_vigent_text",regionsSanitariesVigent:"regions_sanitaries_vigent",regionsSanitariesVigentText:"regions_sanitaries_vigent_text",seccionsCensals2015:"seccions_censals_2015",seccionsCensals2016:"seccions_censals_2016",seccionsCensals2017:"seccions_censals_2017",seccionsCensals2018:"seccions_censals_2018",seccionsCensals2019:"seccions_censals_2019",seccionsCensals2020:"seccions_censals_2020",seccionsCensals2021:"seccions_censals_2021",seccionsCensals2022:"seccions_censals_2022",seccionsCensals2023:"seccions_censals_2023",seccionsCensalsVigent:"seccions_censals_vigent",seccionsCensalsVigentText:"seccions_censals_vigent_text",sectorsSanitarisVigent:"sectors_sanitaris_vigent",vegueriesVigent:"vegueries_vigent",vegueriesVigentText:"vegueries_vigent_text"},FGBAdmin:{agrupacionsCensalsVigent:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent.fgb",agrupacionsCensalsVigentText:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent_text.fgb",areesBasiquesPolicialsVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent.fgb",areesBasiquesPolicialsVigentText:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent_text.fgb",areesBasiquesSalutVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_salut_vigent.fgb",areesBasiquesServeisSocialsVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent.fgb",areesBasiquesServeisSocialsVigentText:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent_text.fgb",areesGestioAssistencialVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_gestio_assistencial_vigent.fgb",areesHidrogeologiquesAquifersVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_hidrogeologiques_aquifers_vigent.fgb",catalunyaVigent:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent.fgb",catalunyaVigentText:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent_text.fgb",comarquesVigent:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent.fgb",comarquesVigentText:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent_text.fgb",districtesCensalsVigent:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent.fgb",districtesCensalsVigentText:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent_text.fgb",incendisForestalsVigent:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent.fgb",incendisForestalsVigentText:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent_text.fgb",municipisVigent:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent.fgb",municipisVigentText:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent_text.fgb",partitsJudicialsVigent:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent.fgb",partitsJudicialsVigentText:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent_text.fgb",plaTerritorialVigent:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent.fgb",plaTerritorialVigentText:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent_text.fgb",provinciesVigent:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent.fgb",provinciesVigentText:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent_text.fgb",regionsPolicialsVigent:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent.fgb",regionsPolicialsVigentText:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent_text.fgb",regionsSanitariesVigent:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent.fgb",regionsSanitariesVigentText:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent_text.fgb",seccionsCensalsVigent:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent.fgb",seccionsCensalsVigentText:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent_text.fgb",sectorsSanitarisVigent:"https://tilemaps.icgc.cat/vector/fgb/sectors_sanitaris_vigent.fgb",vegueriesVigent:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent.fgb",vegueriesVigentText:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent_text.fgb"},Vector:{cobertes2018:"https://tilemaps.icgc.cat/tileserver/cobertes_tilejson.json"},WMS:{espaisInteresGeologic:"https://geoserveis.icgc.cat/servei/catalunya/espais-interes-geologic/wms/service?&service=WMS&request=GetMap&layers=espais-interes-geologic&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}",gravimetriaBouguer500000:"https://geoserveis.icgc.cat/servei/catalunya/gravimetria/wms/service?&service=WMS&request=GetMap&layers=anomalia_bouguer_500000&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}",cobertesSol2018:"https://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms/service?&service=WMS&request=GetMap&layers=cobertes_2018&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}",administratiu:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/administratiu/MON3857NW/{z}/{x}/{y}.png",simplificat:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/simplificat/MON3857NW/{z}/{x}/{y}.png",cims:"https://geoserveis.icgc.cat/icc_100cims/wms/service?REQUEST=GetMap&SERVICE=WMS&VERSION=1.1.1&LAYERS=0&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&SRS=EPSG:25831&BBOX=137118.923076923,4488408.75,650959.076923077,4749634.75&WIDTH=895&HEIGHT=455",cobertesSol:"http://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms?REQUEST=GetMap&SERVICE=WMS&VERSION=1.3.0&LAYERS=cobertes_2009&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&CRS=EPSG:25831&BBOX=374110.828167253,4639230.79853085,452621.120632226,4703578.45000215&WIDTH=1020&HEIGHT=836"}}};class ait{constructor(t){this.options=t||{}}onAdd(t){let e=ed.defaultOptions;return this._map=t,this._img1=document.createElement("img"),this._img1.className="maplibregl-ctrl",this._img1.src=this.options.color?e.logoIcgcOptions.logoUrlColor:e.logoIcgcOptions.logoUrlWhite,this._img1.width=e.logoIcgcOptions.logoWidth,this._img1.title=e.logoIcgcOptions.logoTitle,this._img1.style.opacity=e.logoIcgcOptions.logoOpacity,this.link1=document.createElement("a"),this.link1.href=e.logoIcgcOptions.logoLink,this.link1.target="_blank",this.link1.appendChild(this._img1),this._container1=document.createElement("div"),this._container1.className="maplibregl-ctrl",this._container1.style.width=`${e.logoIcgcOptions.logoWidth}px`,this._container1.appendChild(this.link1),this._img2=document.createElement("img"),this._img2.className="maplibregl-ctrl",this._img2.src=this.options.color?e.logoGencatOptions.logoUrlColor:e.logoGencatOptions.logoUrlWhite,this._img2.width=e.logoGencatOptions.logoWidth,this._img2.title=e.logoGencatOptions.logoTitle,this._img2.style.opacity=e.logoGencatOptions.logoOpacity,this.link2=document.createElement("a"),this.link2.href=e.logoGencatOptions.logoLink,this.link2.target="_blank",this.link2.appendChild(this._img2),this._container2=document.createElement("div"),this._container2.className="maplibregl-ctrl",this._container2.style.width=`${e.logoGencatOptions.logoWidth}px`,this._container2.appendChild(this.link2),this._mainContainer=document.createElement("div"),this._mainContainer.className="divLogos",this._mainContainer.style="display: flex",this._mainContainer.appendChild(this._container1),this._mainContainer.appendChild(this._container2),this._mainContainer}}class lit{constructor(t){this.options=t||{}}onAdd(t){this._map=t,this._img1=document.createElement("img"),this._img1.src=this.options.url,this._img1.width=150,this._img1.title=300,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("maplibregl-ctrl"),this.controlContainer.classList.add("maplibregl-ctrl-group"),this.legendContainer=document.createElement("div"),this.legendContainer.classList.add("maplibregl-legend-list"),this.legendButton=document.createElement("button"),this.legendButton.classList.add("maplibregl-ctrl-icon"),this.legendButton.classList.add("maplibregl-legend-switcher"),this.legendButton.addEventListener("click",()=>{this.legendButton.style.display="none",this.legendContainer.style.display="block"}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.legendButton),this.controlContainer.appendChild(this.legendContainer),this.closeButton=document.createElement("button"),this.closeButton.textContent="x",this.closeButton.classList.add("maplibregl-legend-close-button"),this.closeButton.addEventListener("click",()=>{this.legendButton.style.display="block",this.legendContainer.style.display="none"}),this.legendContainer.appendChild(this.closeButton);const e=document.createElement("label");return e.classList.add("maplibregl-legend-title-label"),e.textContent=this.options.idLayer||"Llegenda",this.legendContainer.appendChild(e),this.legendContainer.appendChild(document.createElement("br")),this.legendContainer.appendChild(this._img1),this.controlContainer}}var Qf=ZP.prototype,sx="WGS 84";function ZP(r){r!==void 0&&(sx=r),this.setEllipsoid(sx)}Qf.convertLatLngToUtm=function(r,t,e){var n;if(this.status)return"No ecclipsoid data associated with unknown datum: "+sx;if(!Number.isInteger(e))return"Precision is not integer number.";r=parseFloat(r),t=parseFloat(t);var i=t,s=this.toRadians(r),a=this.toRadians(i);i>=8&&i<=13&&r>54.5&&r<58||r>=56&&r<64&&i>=3&&i<12?n=32:(n=(i+180)/6+1,r>=72&&r<84&&(i>=0&&i<9?n=31:i>=9&&i<21?n=33:i>=21&&i<33?n=35:i>=33&&i<42&&(n=37))),n=parseInt(n);var o=(n-1)*6-180+3,d=this.toRadians(o),f=this.getUtmLetterDesignator(r),_=this.eccSquared/(1-this.eccSquared),w=this.a/Math.sqrt(1-this.eccSquared*Math.sin(s)*Math.sin(s)),x=Math.tan(s)*Math.tan(s),B=_*Math.cos(s)*Math.cos(s),P=Math.cos(s)*(a-d),R=this.a*((1-this.eccSquared/4-3*this.eccSquared*this.eccSquared/64-5*this.eccSquared*this.eccSquared*this.eccSquared/256)*s-(3*this.eccSquared/8+3*this.eccSquared*this.eccSquared/32+45*this.eccSquared*this.eccSquared*this.eccSquared/1024)*Math.sin(2*s)+(15*this.eccSquared*this.eccSquared/256+45*this.eccSquared*this.eccSquared*this.eccSquared/1024)*Math.sin(4*s)-35*this.eccSquared*this.eccSquared*this.eccSquared/3072*Math.sin(6*s)),N=parseFloat(.9996*w*(P+(1-x+B)*P*P*P/6+(5-18*x+x*x+72*B-58*_)*P*P*P*P*P/120)+5e5),Q=parseFloat(.9996*(R+w*Math.tan(s)*(P*P/2+(5-x+9*B+4*B*B)*P*P*P*P/24+(61-58*x+x*x+600*B-330*_)*P*P*P*P*P*P/720)));return r<0&&(Q+=1e7),Q=tM(Q,e),N=tM(N,e),{Easting:N,Northing:Q,ZoneNumber:parseInt(n),ZoneLetter:f}},Qf.convertUtmToLatLng=function(r,t,e,n){var i=(1-Math.sqrt(1-this.eccSquared))/(1+Math.sqrt(1-this.eccSquared)),s=r-5e5,a=t,o=e,d=n;if(r===void 0)return"Please pass the UTMEasting!";if(t===void 0)return"Please pass the UTMNorthing!";if(e===void 0)return"Please pass the UTMZoneNumber!";if(n===void 0)return"Please pass the UTMZoneLetter!";["N","P","Q","R","S","T","U","V","W","X","Y","Z"].indexOf(d)!==-1||(a-=1e7);var f=(o-1)*6-180+3,_=this.eccSquared/(1-this.eccSquared),w=a/.9996,x=w/(this.a*(1-this.eccSquared/4-3*this.eccSquared*this.eccSquared/64-5*this.eccSquared*this.eccSquared*this.eccSquared/256)),B=x+(3*i/2-27*i*i*i/32)*Math.sin(2*x)+(21*i*i/16-55*i*i*i*i/32)*Math.sin(4*x)+151*i*i*i/96*Math.sin(6*x);this.toDegrees(B);var P=this.a/Math.sqrt(1-this.eccSquared*Math.sin(B)*Math.sin(B)),R=Math.tan(B)*Math.tan(B),N=_*Math.cos(B)*Math.cos(B),Q=this.a*(1-this.eccSquared)/Math.pow(1-this.eccSquared*Math.sin(B)*Math.sin(B),1.5),V=s/(P*.9996),W=B-P*Math.tan(B)/Q*(V*V/2-(5+3*R+10*N-4*N*N-9*_)*V*V*V*V/24+(61+90*R+298*N+45*R*R-252*_-3*N*N)*V*V*V*V*V*V/720);W=this.toDegrees(W);var et=(V-(1+2*R+N)*V*V*V/6+(5-2*N+28*R-3*N*N+8*_+24*R*R)*V*V*V*V*V/120)/Math.cos(B);return et=f+this.toDegrees(et),{lat:W,lng:et}},Qf.getUtmLetterDesignator=function(r){return r=parseFloat(r),84>=r&&r>=72?"X":72>r&&r>=64?"W":64>r&&r>=56?"V":56>r&&r>=48?"U":48>r&&r>=40?"T":40>r&&r>=32?"S":32>r&&r>=24?"R":24>r&&r>=16?"Q":16>r&&r>=8?"P":8>r&&r>=0?"N":0>r&&r>=-8?"M":-8>r&&r>=-16?"L":-16>r&&r>=-24?"K":-24>r&&r>=-32?"J":-32>r&&r>=-40?"H":-40>r&&r>=-48?"G":-48>r&&r>=-56?"F":-56>r&&r>=-64?"E":-64>r&&r>=-72?"D":-72>r&&r>=-80?"C":"Z"},Qf.setEllipsoid=function(r){switch(r){case"Airy":this.a=6377563,this.eccSquared=.00667054;break;case"Australian National":this.a=6378160,this.eccSquared=.006694542;break;case"Bessel 1841":this.a=6377397,this.eccSquared=.006674372;break;case"Bessel 1841 Nambia":this.a=6377484,this.eccSquared=.006674372;break;case"Clarke 1866":this.a=6378206,this.eccSquared=.006768658;break;case"Clarke 1880":this.a=6378249,this.eccSquared=.006803511;break;case"Everest":this.a=6377276,this.eccSquared=.006637847;break;case"Fischer 1960 Mercury":this.a=6378166,this.eccSquared=.006693422;break;case"Fischer 1968":this.a=6378150,this.eccSquared=.006693422;break;case"GRS 1967":this.a=6378160,this.eccSquared=.006694605;break;case"GRS 1980":this.a=6378137,this.eccSquared=.00669438;break;case"Helmert 1906":this.a=6378200,this.eccSquared=.006693422;break;case"Hough":this.a=6378270,this.eccSquared=.00672267;break;case"International":this.a=6378388,this.eccSquared=.00672267;break;case"Krassovsky":this.a=6378245,this.eccSquared=.006693422;break;case"Modified Airy":this.a=6377340,this.eccSquared=.00667054;break;case"Modified Everest":this.a=6377304,this.eccSquared=.006637847;break;case"Modified Fischer 1960":this.a=6378155,this.eccSquared=.006693422;break;case"South American 1969":this.a=6378160,this.eccSquared=.006694542;break;case"WGS 60":this.a=6378165,this.eccSquared=.006693422;break;case"WGS 66":this.a=6378145,this.eccSquared=.006694542;break;case"WGS 72":this.a=6378135,this.eccSquared=.006694318;break;case"ED50":this.a=6378388,this.eccSquared=.00672267;break;case"WGS 84":case"EUREF89":case"ETRS89":this.a=6378137,this.eccSquared=.00669438;break;default:this.status=!0}},Qf.toDegrees=function(r){return r/Math.PI*180},Qf.toRadians=function(r){return r*Math.PI/180};function tM(r,t){var e=Math.pow(10,t);return Math.round(r*e)/e}var cit=ZP;const uit=Vp(cit);class Ait{constructor(t){this.options=t||{},this.options.utm=this.options.hasOwnProperty("utm")?this.options.utm:!0,this.options.lonlat=this.options.hasOwnProperty("lonlat")?this.options.lonlat:!0}onAdd(t){const e=new uit;return this._map=t,this._container=document.createElement("div"),this._container.className="maplibregl-ctrl coordControl",this._container.style.width=`${this.options.width||"225px"}`,this._map.on("mousemove",n=>{const i=n.lngLat.lat,s=n.lngLat.lng;let a="",o="";const d=e.convertLatLngToUtm(i,s,2),f=i>0?"N":"S";this.options.utm&&(a=`ETRS89 UTM ${d.ZoneNumber}${f} X:<b> ${d.Easting}</b> Y:<b> ${d.Northing}</b> <br>`),this.options.lonlat&&(o=`WGS 84 Lon:<b> ${s.toFixed(5)}</b>  Lat:<b> ${i.toFixed(5)}</b>`);const _=`${a}${o}`;this._container.innerHTML=_}),this._container}_lookUTM31(t,e){var n=0,i=0,s=6,a=84;return t>=n&&t<=s&&e>=i&&e<=a}onRemove(){this._container.parentNode.removeChild(this._container),this._map=void 0}}function eM(r,t){return function(){return r.apply(t,arguments)}}const{toString:hit}=Object.prototype,{getPrototypeOf:ox}=Object,Xy=(r=>t=>{const e=hit.call(t);return r[e]||(r[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),sc=r=>(r=r.toLowerCase(),t=>Xy(t)===r),Jy=r=>t=>typeof t===r,{isArray:zf}=Array,Wg=Jy("undefined");function dit(r){return r!==null&&!Wg(r)&&r.constructor!==null&&!Wg(r.constructor)&&Ga(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const rM=sc("ArrayBuffer");function fit(r){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(r):t=r&&r.buffer&&rM(r.buffer),t}const pit=Jy("string"),Ga=Jy("function"),nM=Jy("number"),Yy=r=>r!==null&&typeof r=="object",git=r=>r===!0||r===!1,Zy=r=>{if(Xy(r)!=="object")return!1;const t=ox(r);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},mit=sc("Date"),yit=sc("File"),_it=sc("Blob"),vit=sc("FileList"),bit=r=>Yy(r)&&Ga(r.pipe),wit=r=>{let t;return r&&(typeof FormData=="function"&&r instanceof FormData||Ga(r.append)&&((t=Xy(r))==="formdata"||t==="object"&&Ga(r.toString)&&r.toString()==="[object FormData]"))},xit=sc("URLSearchParams"),[Bit,Cit,Eit,Sit]=["ReadableStream","Request","Response","Headers"].map(sc),Tit=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Xg(r,t){let{allOwnKeys:e=!1}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(r===null||typeof r>"u")return;let n,i;if(typeof r!="object"&&(r=[r]),zf(r))for(n=0,i=r.length;n<i;n++)t.call(null,r[n],n,r);else{const s=e?Object.getOwnPropertyNames(r):Object.keys(r),a=s.length;let o;for(n=0;n<a;n++)o=s[n],t.call(null,r[o],o,r)}}function iM(r,t){t=t.toLowerCase();const e=Object.keys(r);let n=e.length,i;for(;n-- >0;)if(i=e[n],t===i.toLowerCase())return i;return null}const rd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,sM=r=>!Wg(r)&&r!==rd;function ax(){const{caseless:r}=sM(this)&&this||{},t={},e=(n,i)=>{const s=r&&iM(t,i)||i;Zy(t[s])&&Zy(n)?t[s]=ax(t[s],n):Zy(n)?t[s]=ax({},n):zf(n)?t[s]=n.slice():t[s]=n};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&Xg(arguments[n],e);return t}const Iit=function(r,t,e){let{allOwnKeys:n}=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Xg(t,(i,s)=>{e&&Ga(i)?r[s]=eM(i,e):r[s]=i},{allOwnKeys:n}),r},Fit=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),Lit=(r,t,e,n)=>{r.prototype=Object.create(t.prototype,n),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:t.prototype}),e&&Object.assign(r.prototype,e)},Pit=(r,t,e,n)=>{let i,s,a;const o={};if(t=t||{},r==null)return t;do{for(i=Object.getOwnPropertyNames(r),s=i.length;s-- >0;)a=i[s],(!n||n(a,r,t))&&!o[a]&&(t[a]=r[a],o[a]=!0);r=e!==!1&&ox(r)}while(r&&(!e||e(r,t))&&r!==Object.prototype);return t},Mit=(r,t,e)=>{r=String(r),(e===void 0||e>r.length)&&(e=r.length),e-=t.length;const n=r.indexOf(t,e);return n!==-1&&n===e},Rit=r=>{if(!r)return null;if(zf(r))return r;let t=r.length;if(!nM(t))return null;const e=new Array(t);for(;t-- >0;)e[t]=r[t];return e},Uit=(r=>t=>r&&t instanceof r)(typeof Uint8Array<"u"&&ox(Uint8Array)),Oit=(r,t)=>{const n=(r&&r[Symbol.iterator]).call(r);let i;for(;(i=n.next())&&!i.done;){const s=i.value;t.call(r,s[0],s[1])}},Dit=(r,t)=>{let e;const n=[];for(;(e=r.exec(t))!==null;)n.push(e);return n},Nit=sc("HTMLFormElement"),kit=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,n,i){return n.toUpperCase()+i}),oM=(r=>{let{hasOwnProperty:t}=r;return(e,n)=>t.call(e,n)})(Object.prototype),Qit=sc("RegExp"),aM=(r,t)=>{const e=Object.getOwnPropertyDescriptors(r),n={};Xg(e,(i,s)=>{let a;(a=t(i,s,r))!==!1&&(n[s]=a||i)}),Object.defineProperties(r,n)},zit=r=>{aM(r,(t,e)=>{if(Ga(r)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const n=r[e];if(Ga(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},Hit=(r,t)=>{const e={},n=i=>{i.forEach(s=>{e[s]=!0})};return zf(r)?n(r):n(String(r).split(t)),e},Vit=()=>{},Git=(r,t)=>r!=null&&Number.isFinite(r=+r)?r:t,lx="abcdefghijklmnopqrstuvwxyz",lM="0123456789",cM={DIGIT:lM,ALPHA:lx,ALPHA_DIGIT:lx+lx.toUpperCase()+lM},jit=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cM.ALPHA_DIGIT,e="";const{length:n}=t;for(;r--;)e+=t[Math.random()*n|0];return e};function qit(r){return!!(r&&Ga(r.append)&&r[Symbol.toStringTag]==="FormData"&&r[Symbol.iterator])}const Kit=r=>{const t=new Array(10),e=(n,i)=>{if(Yy(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[i]=n;const s=zf(n)?[]:{};return Xg(n,(a,o)=>{const d=e(a,i+1);!Wg(d)&&(s[o]=d)}),t[i]=void 0,s}}return n};return e(r,0)},$it=sc("AsyncFunction"),Wit=r=>r&&(Yy(r)||Ga(r))&&Ga(r.then)&&Ga(r.catch),uM=((r,t)=>r?setImmediate:t?((e,n)=>(rd.addEventListener("message",i=>{let{source:s,data:a}=i;s===rd&&a===e&&n.length&&n.shift()()},!1),i=>{n.push(i),rd.postMessage(e,"*")}))(`axios@${Math.random()}`,[]):e=>setTimeout(e))(typeof setImmediate=="function",Ga(rd.postMessage)),Xit=typeof queueMicrotask<"u"?queueMicrotask.bind(rd):typeof process<"u"&&process.nextTick||uM,fe={isArray:zf,isArrayBuffer:rM,isBuffer:dit,isFormData:wit,isArrayBufferView:fit,isString:pit,isNumber:nM,isBoolean:git,isObject:Yy,isPlainObject:Zy,isReadableStream:Bit,isRequest:Cit,isResponse:Eit,isHeaders:Sit,isUndefined:Wg,isDate:mit,isFile:yit,isBlob:_it,isRegExp:Qit,isFunction:Ga,isStream:bit,isURLSearchParams:xit,isTypedArray:Uit,isFileList:vit,forEach:Xg,merge:ax,extend:Iit,trim:Tit,stripBOM:Fit,inherits:Lit,toFlatObject:Pit,kindOf:Xy,kindOfTest:sc,endsWith:Mit,toArray:Rit,forEachEntry:Oit,matchAll:Dit,isHTMLForm:Nit,hasOwnProperty:oM,hasOwnProp:oM,reduceDescriptors:aM,freezeMethods:zit,toObjectSet:Hit,toCamelCase:kit,noop:Vit,toFiniteNumber:Git,findKey:iM,global:rd,isContextDefined:sM,ALPHABET:cM,generateString:jit,isSpecCompliantForm:qit,toJSONObject:Kit,isAsyncFn:$it,isThenable:Wit,setImmediate:uM,asap:Xit};function ln(r,t,e,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",t&&(this.code=t),e&&(this.config=e),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}fe.inherits(ln,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:fe.toJSONObject(this.config),code:this.code,status:this.status}}});const AM=ln.prototype,hM={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{hM[r]={value:r}}),Object.defineProperties(ln,hM),Object.defineProperty(AM,"isAxiosError",{value:!0}),ln.from=(r,t,e,n,i,s)=>{const a=Object.create(AM);return fe.toFlatObject(r,a,function(d){return d!==Error.prototype},o=>o!=="isAxiosError"),ln.call(a,r.message,t,e,n,i),a.cause=r,a.name=r.name,s&&Object.assign(a,s),a};const Jit=null;function cx(r){return fe.isPlainObject(r)||fe.isArray(r)}function dM(r){return fe.endsWith(r,"[]")?r.slice(0,-2):r}function fM(r,t,e){return r?r.concat(t).map(function(i,s){return i=dM(i),!e&&s?"["+i+"]":i}).join(e?".":""):t}function Yit(r){return fe.isArray(r)&&!r.some(cx)}const Zit=fe.toFlatObject(fe,{},null,function(t){return/^is[A-Z]/.test(t)});function t1(r,t,e){if(!fe.isObject(r))throw new TypeError("target must be an object");t=t||new FormData,e=fe.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(R,N){return!fe.isUndefined(N[R])});const n=e.metaTokens,i=e.visitor||_,s=e.dots,a=e.indexes,d=(e.Blob||typeof Blob<"u"&&Blob)&&fe.isSpecCompliantForm(t);if(!fe.isFunction(i))throw new TypeError("visitor must be a function");function f(P){if(P===null)return"";if(fe.isDate(P))return P.toISOString();if(!d&&fe.isBlob(P))throw new ln("Blob is not supported. Use a Buffer instead.");return fe.isArrayBuffer(P)||fe.isTypedArray(P)?d&&typeof Blob=="function"?new Blob([P]):Buffer.from(P):P}function _(P,R,N){let Q=P;if(P&&!N&&typeof P=="object"){if(fe.endsWith(R,"{}"))R=n?R:R.slice(0,-2),P=JSON.stringify(P);else if(fe.isArray(P)&&Yit(P)||(fe.isFileList(P)||fe.endsWith(R,"[]"))&&(Q=fe.toArray(P)))return R=dM(R),Q.forEach(function(W,et){!(fe.isUndefined(W)||W===null)&&t.append(a===!0?fM([R],et,s):a===null?R:R+"[]",f(W))}),!1}return cx(P)?!0:(t.append(fM(N,R,s),f(P)),!1)}const w=[],x=Object.assign(Zit,{defaultVisitor:_,convertValue:f,isVisitable:cx});function B(P,R){if(!fe.isUndefined(P)){if(w.indexOf(P)!==-1)throw Error("Circular reference detected in "+R.join("."));w.push(P),fe.forEach(P,function(Q,V){(!(fe.isUndefined(Q)||Q===null)&&i.call(t,Q,fe.isString(V)?V.trim():V,R,x))===!0&&B(Q,R?R.concat(V):[V])}),w.pop()}}if(!fe.isObject(r))throw new TypeError("data must be an object");return B(r),t}function pM(r){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function ux(r,t){this._pairs=[],r&&t1(r,this,t)}const gM=ux.prototype;gM.append=function(t,e){this._pairs.push([t,e])},gM.toString=function(t){const e=t?function(n){return t.call(this,n,pM)}:pM;return this._pairs.map(function(i){return e(i[0])+"="+e(i[1])},"").join("&")};function tst(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function mM(r,t,e){if(!t)return r;const n=e&&e.encode||tst;fe.isFunction(e)&&(e={serialize:e});const i=e&&e.serialize;let s;if(i?s=i(t,e):s=fe.isURLSearchParams(t)?t.toString():new ux(t,e).toString(n),s){const a=r.indexOf("#");a!==-1&&(r=r.slice(0,a)),r+=(r.indexOf("?")===-1?"?":"&")+s}return r}class yM{constructor(){this.handlers=[]}use(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){fe.forEach(this.handlers,function(n){n!==null&&t(n)})}}const _M={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},est={isBrowser:!0,classes:{URLSearchParams:typeof URLSearchParams<"u"?URLSearchParams:ux,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]},Ax=typeof window<"u"&&typeof document<"u",hx=typeof navigator=="object"&&navigator||void 0,rst=Ax&&(!hx||["ReactNative","NativeScript","NS"].indexOf(hx.product)<0),nst=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ist=Ax&&window.location.href||"http://localhost",bo={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ax,hasStandardBrowserEnv:rst,hasStandardBrowserWebWorkerEnv:nst,navigator:hx,origin:ist},Symbol.toStringTag,{value:"Module"})),...est};function sst(r,t){return t1(r,new bo.classes.URLSearchParams,Object.assign({visitor:function(e,n,i,s){return bo.isNode&&fe.isBuffer(e)?(this.append(n,e.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function ost(r){return fe.matchAll(/\w+|\[(\w*)]/g,r).map(t=>t[0]==="[]"?"":t[1]||t[0])}function ast(r){const t={},e=Object.keys(r);let n;const i=e.length;let s;for(n=0;n<i;n++)s=e[n],t[s]=r[s];return t}function vM(r){function t(e,n,i,s){let a=e[s++];if(a==="__proto__")return!0;const o=Number.isFinite(+a),d=s>=e.length;return a=!a&&fe.isArray(i)?i.length:a,d?(fe.hasOwnProp(i,a)?i[a]=[i[a],n]:i[a]=n,!o):((!i[a]||!fe.isObject(i[a]))&&(i[a]=[]),t(e,n,i[a],s)&&fe.isArray(i[a])&&(i[a]=ast(i[a])),!o)}if(fe.isFormData(r)&&fe.isFunction(r.entries)){const e={};return fe.forEachEntry(r,(n,i)=>{t(ost(n),i,e,0)}),e}return null}function lst(r,t,e){if(fe.isString(r))try{return(t||JSON.parse)(r),fe.trim(r)}catch(n){if(n.name!=="SyntaxError")throw n}return(0,JSON.stringify)(r)}const Jg={transitional:_M,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const n=e.getContentType()||"",i=n.indexOf("application/json")>-1,s=fe.isObject(t);if(s&&fe.isHTMLForm(t)&&(t=new FormData(t)),fe.isFormData(t))return i?JSON.stringify(vM(t)):t;if(fe.isArrayBuffer(t)||fe.isBuffer(t)||fe.isStream(t)||fe.isFile(t)||fe.isBlob(t)||fe.isReadableStream(t))return t;if(fe.isArrayBufferView(t))return t.buffer;if(fe.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return sst(t,this.formSerializer).toString();if((o=fe.isFileList(t))||n.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return t1(o?{"files[]":t}:t,d&&new d,this.formSerializer)}}return s||i?(e.setContentType("application/json",!1),lst(t)):t}],transformResponse:[function(t){const e=this.transitional||Jg.transitional,n=e&&e.forcedJSONParsing,i=this.responseType==="json";if(fe.isResponse(t)||fe.isReadableStream(t))return t;if(t&&fe.isString(t)&&(n&&!this.responseType||i)){const a=!(e&&e.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(o){if(a)throw o.name==="SyntaxError"?ln.from(o,ln.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:bo.classes.FormData,Blob:bo.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};fe.forEach(["delete","get","head","post","put","patch"],r=>{Jg.headers[r]={}});const cst=fe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ust=r=>{const t={};let e,n,i;return r&&r.split(`
`).forEach(function(a){i=a.indexOf(":"),e=a.substring(0,i).trim().toLowerCase(),n=a.substring(i+1).trim(),!(!e||t[e]&&cst[e])&&(e==="set-cookie"?t[e]?t[e].push(n):t[e]=[n]:t[e]=t[e]?t[e]+", "+n:n)}),t},bM=Symbol("internals");function Yg(r){return r&&String(r).trim().toLowerCase()}function e1(r){return r===!1||r==null?r:fe.isArray(r)?r.map(e1):String(r)}function Ast(r){const t=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=e.exec(r);)t[n[1]]=n[2];return t}const hst=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function dx(r,t,e,n,i){if(fe.isFunction(n))return n.call(this,t,e);if(i&&(t=e),!!fe.isString(t)){if(fe.isString(n))return t.indexOf(n)!==-1;if(fe.isRegExp(n))return n.test(t)}}function dst(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,n)=>e.toUpperCase()+n)}function fst(r,t){const e=fe.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(r,n+e,{value:function(i,s,a){return this[n].call(this,t,i,s,a)},configurable:!0})})}class ga{constructor(t){t&&this.set(t)}set(t,e,n){const i=this;function s(o,d,f){const _=Yg(d);if(!_)throw new Error("header name must be a non-empty string");const w=fe.findKey(i,_);(!w||i[w]===void 0||f===!0||f===void 0&&i[w]!==!1)&&(i[w||d]=e1(o))}const a=(o,d)=>fe.forEach(o,(f,_)=>s(f,_,d));if(fe.isPlainObject(t)||t instanceof this.constructor)a(t,e);else if(fe.isString(t)&&(t=t.trim())&&!hst(t))a(ust(t),e);else if(fe.isHeaders(t))for(const[o,d]of t.entries())s(d,o,n);else t!=null&&s(e,t,n);return this}get(t,e){if(t=Yg(t),t){const n=fe.findKey(this,t);if(n){const i=this[n];if(!e)return i;if(e===!0)return Ast(i);if(fe.isFunction(e))return e.call(this,i,n);if(fe.isRegExp(e))return e.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=Yg(t),t){const n=fe.findKey(this,t);return!!(n&&this[n]!==void 0&&(!e||dx(this,this[n],n,e)))}return!1}delete(t,e){const n=this;let i=!1;function s(a){if(a=Yg(a),a){const o=fe.findKey(n,a);o&&(!e||dx(n,n[o],o,e))&&(delete n[o],i=!0)}}return fe.isArray(t)?t.forEach(s):s(t),i}clear(t){const e=Object.keys(this);let n=e.length,i=!1;for(;n--;){const s=e[n];(!t||dx(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const e=this,n={};return fe.forEach(this,(i,s)=>{const a=fe.findKey(n,s);if(a){e[a]=e1(i),delete e[s];return}const o=t?dst(s):String(s).trim();o!==s&&delete e[s],e[o]=e1(i),n[o]=!0}),this}concat(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.constructor.concat(this,...e)}toJSON(t){const e=Object.create(null);return fe.forEach(this,(n,i)=>{n!=null&&n!==!1&&(e[i]=t&&fe.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(t=>{let[e,n]=t;return e+": "+n}).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t){const e=new this(t);for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return i.forEach(a=>e.set(a)),e}static accessor(t){const n=(this[bM]=this[bM]={accessors:{}}).accessors,i=this.prototype;function s(a){const o=Yg(a);n[o]||(fst(i,a),n[o]=!0)}return fe.isArray(t)?t.forEach(s):s(t),this}}ga.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),fe.reduceDescriptors(ga.prototype,(r,t)=>{let{value:e}=r,n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[n]=i}}}),fe.freezeMethods(ga);function fx(r,t){const e=this||Jg,n=t||e,i=ga.from(n.headers);let s=n.data;return fe.forEach(r,function(o){s=o.call(e,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function wM(r){return!!(r&&r.__CANCEL__)}function Hf(r,t,e){ln.call(this,r??"canceled",ln.ERR_CANCELED,t,e),this.name="CanceledError"}fe.inherits(Hf,ln,{__CANCEL__:!0});function xM(r,t,e){const n=e.config.validateStatus;!e.status||!n||n(e.status)?r(e):t(new ln("Request failed with status code "+e.status,[ln.ERR_BAD_REQUEST,ln.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}function pst(r){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return t&&t[1]||""}function gst(r,t){r=r||10;const e=new Array(r),n=new Array(r);let i=0,s=0,a;return t=t!==void 0?t:1e3,function(d){const f=Date.now(),_=n[s];a||(a=f),e[i]=d,n[i]=f;let w=s,x=0;for(;w!==i;)x+=e[w++],w=w%r;if(i=(i+1)%r,i===s&&(s=(s+1)%r),f-a<t)return;const B=_&&f-_;return B?Math.round(x*1e3/B):void 0}}function mst(r,t){let e=0,n=1e3/t,i,s;const a=function(f){e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Date.now(),i=null,s&&(clearTimeout(s),s=null),r.apply(null,f)};return[function(){const f=Date.now(),_=f-e;for(var w=arguments.length,x=new Array(w),B=0;B<w;B++)x[B]=arguments[B];_>=n?a(x,f):(i=x,s||(s=setTimeout(()=>{s=null,a(i)},n-_)))},()=>i&&a(i)]}const r1=function(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,n=0;const i=gst(50,250);return mst(s=>{const a=s.loaded,o=s.lengthComputable?s.total:void 0,d=a-n,f=i(d),_=a<=o;n=a;const w={loaded:a,total:o,progress:o?a/o:void 0,bytes:d,rate:f||void 0,estimated:f&&o&&_?(o-a)/f:void 0,event:s,lengthComputable:o!=null,[t?"download":"upload"]:!0};r(w)},e)},BM=(r,t)=>{const e=r!=null;return[n=>t[0]({lengthComputable:e,total:r,loaded:n}),t[1]]},CM=r=>function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return fe.asap(()=>r(...e))},yst=bo.hasStandardBrowserEnv?((r,t)=>e=>(e=new URL(e,bo.origin),r.protocol===e.protocol&&r.host===e.host&&(t||r.port===e.port)))(new URL(bo.origin),bo.navigator&&/(msie|trident)/i.test(bo.navigator.userAgent)):()=>!0,_st=bo.hasStandardBrowserEnv?{write(r,t,e,n,i,s){const a=[r+"="+encodeURIComponent(t)];fe.isNumber(e)&&a.push("expires="+new Date(e).toGMTString()),fe.isString(n)&&a.push("path="+n),fe.isString(i)&&a.push("domain="+i),s===!0&&a.push("secure"),document.cookie=a.join("; ")},read(r){const t=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function vst(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function bst(r,t){return t?r.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):r}function EM(r,t){return r&&!vst(t)?bst(r,t):t}const SM=r=>r instanceof ga?{...r}:r;function nd(r,t){t=t||{};const e={};function n(f,_,w,x){return fe.isPlainObject(f)&&fe.isPlainObject(_)?fe.merge.call({caseless:x},f,_):fe.isPlainObject(_)?fe.merge({},_):fe.isArray(_)?_.slice():_}function i(f,_,w,x){if(fe.isUndefined(_)){if(!fe.isUndefined(f))return n(void 0,f,w,x)}else return n(f,_,w,x)}function s(f,_){if(!fe.isUndefined(_))return n(void 0,_)}function a(f,_){if(fe.isUndefined(_)){if(!fe.isUndefined(f))return n(void 0,f)}else return n(void 0,_)}function o(f,_,w){if(w in t)return n(f,_);if(w in r)return n(void 0,f)}const d={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(f,_,w)=>i(SM(f),SM(_),w,!0)};return fe.forEach(Object.keys(Object.assign({},r,t)),function(_){const w=d[_]||i,x=w(r[_],t[_],_);fe.isUndefined(x)&&w!==o||(e[_]=x)}),e}const TM=r=>{const t=nd({},r);let{data:e,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:s,headers:a,auth:o}=t;t.headers=a=ga.from(a),t.url=mM(EM(t.baseURL,t.url),r.params,r.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let d;if(fe.isFormData(e)){if(bo.hasStandardBrowserEnv||bo.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((d=a.getContentType())!==!1){const[f,..._]=d?d.split(";").map(w=>w.trim()).filter(Boolean):[];a.setContentType([f||"multipart/form-data",..._].join("; "))}}if(bo.hasStandardBrowserEnv&&(n&&fe.isFunction(n)&&(n=n(t)),n||n!==!1&&yst(t.url))){const f=i&&s&&_st.read(s);f&&a.set(i,f)}return t},wst=typeof XMLHttpRequest<"u"&&function(r){return new Promise(function(e,n){const i=TM(r);let s=i.data;const a=ga.from(i.headers).normalize();let{responseType:o,onUploadProgress:d,onDownloadProgress:f}=i,_,w,x,B,P;function R(){B&&B(),P&&P(),i.cancelToken&&i.cancelToken.unsubscribe(_),i.signal&&i.signal.removeEventListener("abort",_)}let N=new XMLHttpRequest;N.open(i.method.toUpperCase(),i.url,!0),N.timeout=i.timeout;function Q(){if(!N)return;const W=ga.from("getAllResponseHeaders"in N&&N.getAllResponseHeaders()),ct={data:!o||o==="text"||o==="json"?N.responseText:N.response,status:N.status,statusText:N.statusText,headers:W,config:r,request:N};xM(function(gt){e(gt),R()},function(gt){n(gt),R()},ct),N=null}"onloadend"in N?N.onloadend=Q:N.onreadystatechange=function(){!N||N.readyState!==4||N.status===0&&!(N.responseURL&&N.responseURL.indexOf("file:")===0)||setTimeout(Q)},N.onabort=function(){N&&(n(new ln("Request aborted",ln.ECONNABORTED,r,N)),N=null)},N.onerror=function(){n(new ln("Network Error",ln.ERR_NETWORK,r,N)),N=null},N.ontimeout=function(){let et=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const ct=i.transitional||_M;i.timeoutErrorMessage&&(et=i.timeoutErrorMessage),n(new ln(et,ct.clarifyTimeoutError?ln.ETIMEDOUT:ln.ECONNABORTED,r,N)),N=null},s===void 0&&a.setContentType(null),"setRequestHeader"in N&&fe.forEach(a.toJSON(),function(et,ct){N.setRequestHeader(ct,et)}),fe.isUndefined(i.withCredentials)||(N.withCredentials=!!i.withCredentials),o&&o!=="json"&&(N.responseType=i.responseType),f&&([x,P]=r1(f,!0),N.addEventListener("progress",x)),d&&N.upload&&([w,B]=r1(d),N.upload.addEventListener("progress",w),N.upload.addEventListener("loadend",B)),(i.cancelToken||i.signal)&&(_=W=>{N&&(n(!W||W.type?new Hf(null,r,N):W),N.abort(),N=null)},i.cancelToken&&i.cancelToken.subscribe(_),i.signal&&(i.signal.aborted?_():i.signal.addEventListener("abort",_)));const V=pst(i.url);if(V&&bo.protocols.indexOf(V)===-1){n(new ln("Unsupported protocol "+V+":",ln.ERR_BAD_REQUEST,r));return}N.send(s||null)})},xst=(r,t)=>{const{length:e}=r=r?r.filter(Boolean):[];if(t||e){let n=new AbortController,i;const s=function(f){if(!i){i=!0,o();const _=f instanceof Error?f:this.reason;n.abort(_ instanceof ln?_:new Hf(_ instanceof Error?_.message:_))}};let a=t&&setTimeout(()=>{a=null,s(new ln(`timeout ${t} of ms exceeded`,ln.ETIMEDOUT))},t);const o=()=>{r&&(a&&clearTimeout(a),a=null,r.forEach(f=>{f.unsubscribe?f.unsubscribe(s):f.removeEventListener("abort",s)}),r=null)};r.forEach(f=>f.addEventListener("abort",s));const{signal:d}=n;return d.unsubscribe=()=>fe.asap(o),d}},Bst=function*(r,t){let e=r.byteLength;if(e<t){yield r;return}let n=0,i;for(;n<e;)i=n+t,yield r.slice(n,i),n=i},Cst=async function*(r,t){for await(const e of Est(r))yield*Bst(e,t)},Est=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const t=r.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;yield n}}finally{await t.cancel()}},IM=(r,t,e,n)=>{const i=Cst(r,t);let s=0,a,o=d=>{a||(a=!0,n&&n(d))};return new ReadableStream({async pull(d){try{const{done:f,value:_}=await i.next();if(f){o(),d.close();return}let w=_.byteLength;if(e){let x=s+=w;e(x)}d.enqueue(new Uint8Array(_))}catch(f){throw o(f),f}},cancel(d){return o(d),i.return()}},{highWaterMark:2})},n1=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",FM=n1&&typeof ReadableStream=="function",Sst=n1&&(typeof TextEncoder=="function"?(r=>t=>r.encode(t))(new TextEncoder):async r=>new Uint8Array(await new Response(r).arrayBuffer())),LM=function(r){try{for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];return!!r(...e)}catch{return!1}},Tst=FM&&LM(()=>{let r=!1;const t=new Request(bo.origin,{body:new ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type");return r&&!t}),PM=64*1024,px=FM&&LM(()=>fe.isReadableStream(new Response("").body)),i1={stream:px&&(r=>r.body)};n1&&(r=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!i1[t]&&(i1[t]=fe.isFunction(r[t])?e=>e[t]():(e,n)=>{throw new ln(`Response type '${t}' is not supported`,ln.ERR_NOT_SUPPORT,n)})})})(new Response);const Ist=async r=>{if(r==null)return 0;if(fe.isBlob(r))return r.size;if(fe.isSpecCompliantForm(r))return(await new Request(bo.origin,{method:"POST",body:r}).arrayBuffer()).byteLength;if(fe.isArrayBufferView(r)||fe.isArrayBuffer(r))return r.byteLength;if(fe.isURLSearchParams(r)&&(r=r+""),fe.isString(r))return(await Sst(r)).byteLength},Fst=async(r,t)=>{const e=fe.toFiniteNumber(r.getContentLength());return e??Ist(t)},gx={http:Jit,xhr:wst,fetch:n1&&(async r=>{let{url:t,method:e,data:n,signal:i,cancelToken:s,timeout:a,onDownloadProgress:o,onUploadProgress:d,responseType:f,headers:_,withCredentials:w="same-origin",fetchOptions:x}=TM(r);f=f?(f+"").toLowerCase():"text";let B=xst([i,s&&s.toAbortSignal()],a),P;const R=B&&B.unsubscribe&&(()=>{B.unsubscribe()});let N;try{if(d&&Tst&&e!=="get"&&e!=="head"&&(N=await Fst(_,n))!==0){let ct=new Request(t,{method:"POST",body:n,duplex:"half"}),dt;if(fe.isFormData(n)&&(dt=ct.headers.get("content-type"))&&_.setContentType(dt),ct.body){const[gt,ht]=BM(N,r1(CM(d)));n=IM(ct.body,PM,gt,ht)}}fe.isString(w)||(w=w?"include":"omit");const Q="credentials"in Request.prototype;P=new Request(t,{...x,signal:B,method:e.toUpperCase(),headers:_.normalize().toJSON(),body:n,duplex:"half",credentials:Q?w:void 0});let V=await fetch(P);const W=px&&(f==="stream"||f==="response");if(px&&(o||W&&R)){const ct={};["status","statusText","headers"].forEach(It=>{ct[It]=V[It]});const dt=fe.toFiniteNumber(V.headers.get("content-length")),[gt,ht]=o&&BM(dt,r1(CM(o),!0))||[];V=new Response(IM(V.body,PM,gt,()=>{ht&&ht(),R&&R()}),ct)}f=f||"text";let et=await i1[fe.findKey(i1,f)||"text"](V,r);return!W&&R&&R(),await new Promise((ct,dt)=>{xM(ct,dt,{data:et,headers:ga.from(V.headers),status:V.status,statusText:V.statusText,config:r,request:P})})}catch(Q){throw R&&R(),Q&&Q.name==="TypeError"&&/fetch/i.test(Q.message)?Object.assign(new ln("Network Error",ln.ERR_NETWORK,r,P),{cause:Q.cause||Q}):ln.from(Q,Q&&Q.code,r,P)}})};fe.forEach(gx,(r,t)=>{if(r){try{Object.defineProperty(r,"name",{value:t})}catch{}Object.defineProperty(r,"adapterName",{value:t})}});const MM=r=>`- ${r}`,Lst=r=>fe.isFunction(r)||r===null||r===!1,RM={getAdapter:r=>{r=fe.isArray(r)?r:[r];const{length:t}=r;let e,n;const i={};for(let s=0;s<t;s++){e=r[s];let a;if(n=e,!Lst(e)&&(n=gx[(a=String(e)).toLowerCase()],n===void 0))throw new ln(`Unknown adapter '${a}'`);if(n)break;i[a||"#"+s]=n}if(!n){const s=Object.entries(i).map(o=>{let[d,f]=o;return`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build")});let a=t?s.length>1?`since :
`+s.map(MM).join(`
`):" "+MM(s[0]):"as no adapter specified";throw new ln("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return n},adapters:gx};function mx(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new Hf(null,r)}function UM(r){return mx(r),r.headers=ga.from(r.headers),r.data=fx.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),RM.getAdapter(r.adapter||Jg.adapter)(r).then(function(n){return mx(r),n.data=fx.call(r,r.transformResponse,n),n.headers=ga.from(n.headers),n},function(n){return wM(n)||(mx(r),n&&n.response&&(n.response.data=fx.call(r,r.transformResponse,n.response),n.response.headers=ga.from(n.response.headers))),Promise.reject(n)})}const OM="1.7.9",s1={};["object","boolean","number","function","string","symbol"].forEach((r,t)=>{s1[r]=function(n){return typeof n===r||"a"+(t<1?"n ":" ")+r}});const DM={};s1.transitional=function(t,e,n){function i(s,a){return"[Axios v"+OM+"] Transitional option '"+s+"'"+a+(n?". "+n:"")}return(s,a,o)=>{if(t===!1)throw new ln(i(a," has been removed"+(e?" in "+e:"")),ln.ERR_DEPRECATED);return e&&!DM[a]&&(DM[a]=!0,console.warn(i(a," has been deprecated since v"+e+" and will be removed in the near future"))),t?t(s,a,o):!0}},s1.spelling=function(t){return(e,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function Pst(r,t,e){if(typeof r!="object")throw new ln("options must be an object",ln.ERR_BAD_OPTION_VALUE);const n=Object.keys(r);let i=n.length;for(;i-- >0;){const s=n[i],a=t[s];if(a){const o=r[s],d=o===void 0||a(o,s,r);if(d!==!0)throw new ln("option "+s+" must be "+d,ln.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new ln("Unknown option "+s,ln.ERR_BAD_OPTION)}}const o1={assertOptions:Pst,validators:s1},$c=o1.validators;class id{constructor(t){this.defaults=t,this.interceptors={request:new yM,response:new yM}}async request(t,e){try{return await this._request(t,e)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(t,e){typeof t=="string"?(e=e||{},e.url=t):e=t||{},e=nd(this.defaults,e);const{transitional:n,paramsSerializer:i,headers:s}=e;n!==void 0&&o1.assertOptions(n,{silentJSONParsing:$c.transitional($c.boolean),forcedJSONParsing:$c.transitional($c.boolean),clarifyTimeoutError:$c.transitional($c.boolean)},!1),i!=null&&(fe.isFunction(i)?e.paramsSerializer={serialize:i}:o1.assertOptions(i,{encode:$c.function,serialize:$c.function},!0)),o1.assertOptions(e,{baseUrl:$c.spelling("baseURL"),withXsrfToken:$c.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let a=s&&fe.merge(s.common,s[e.method]);s&&fe.forEach(["delete","get","head","post","put","patch","common"],P=>{delete s[P]}),e.headers=ga.concat(a,s);const o=[];let d=!0;this.interceptors.request.forEach(function(R){typeof R.runWhen=="function"&&R.runWhen(e)===!1||(d=d&&R.synchronous,o.unshift(R.fulfilled,R.rejected))});const f=[];this.interceptors.response.forEach(function(R){f.push(R.fulfilled,R.rejected)});let _,w=0,x;if(!d){const P=[UM.bind(this),void 0];for(P.unshift.apply(P,o),P.push.apply(P,f),x=P.length,_=Promise.resolve(e);w<x;)_=_.then(P[w++],P[w++]);return _}x=o.length;let B=e;for(w=0;w<x;){const P=o[w++],R=o[w++];try{B=P(B)}catch(N){R.call(this,N);break}}try{_=UM.call(this,B)}catch(P){return Promise.reject(P)}for(w=0,x=f.length;w<x;)_=_.then(f[w++],f[w++]);return _}getUri(t){t=nd(this.defaults,t);const e=EM(t.baseURL,t.url);return mM(e,t.params,t.paramsSerializer)}}fe.forEach(["delete","get","head","options"],function(t){id.prototype[t]=function(e,n){return this.request(nd(n||{},{method:t,url:e,data:(n||{}).data}))}}),fe.forEach(["post","put","patch"],function(t){function e(n){return function(s,a,o){return this.request(nd(o||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}id.prototype[t]=e(),id.prototype[t+"Form"]=e(!0)});class yx{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(s){e=s});const n=this;this.promise.then(i=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](i);n._listeners=null}),this.promise.then=i=>{let s;const a=new Promise(o=>{n.subscribe(o),s=o}).then(i);return a.cancel=function(){n.unsubscribe(s)},a},t(function(s,a,o){n.reason||(n.reason=new Hf(s,a,o),e(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);e!==-1&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=n=>{t.abort(n)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;return{token:new yx(function(i){t=i}),cancel:t}}}function Mst(r){return function(e){return r.apply(null,e)}}function Rst(r){return fe.isObject(r)&&r.isAxiosError===!0}const _x={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(_x).forEach(r=>{let[t,e]=r;_x[e]=t});function NM(r){const t=new id(r),e=eM(id.prototype.request,t);return fe.extend(e,id.prototype,t,{allOwnKeys:!0}),fe.extend(e,t,null,{allOwnKeys:!0}),e.create=function(i){return NM(nd(r,i))},e}const is=NM(Jg);is.Axios=id,is.CanceledError=Hf,is.CancelToken=yx,is.isCancel=wM,is.VERSION=OM,is.toFormData=t1,is.AxiosError=ln,is.Cancel=is.CanceledError,is.all=function(t){return Promise.all(t)},is.spread=Mst,is.isAxiosError=Rst,is.mergeConfig=nd,is.AxiosHeaders=ga,is.formToJSON=r=>vM(fe.isHTMLForm(r)?new FormData(r):r),is.getAdapter=RM.getAdapter,is.HttpStatusCode=_x,is.default=is;const Ust="https://eines.icgc.cat/recursos/mapicgc-gl-js/mapicgc-config.json",Ost=5e3;class kM{static async getConfigICGC(){try{const t=await is.get(Ust,{timeout:Ost});return t.data?t.data:(console.log("Resposta sense dades:",t),ed)}catch(t){return t.response?(console.error("Error de resposta:",t.response.data),console.error("Codi d'estat:",t.response.status)):t.request?console.error("No s'ha rebut resposta del servidor:",t.request):console.error("Error:",t.message),ed}}}const Dst={cobertesSol:{"fill-opacity":["interpolate",["exponential",.5],["zoom"],13.5,1,18,.4],"fill-outline-color":"rgba(0,0, 0, 0)","fill-color":["interpolate",["cubic-bezier",.5,1,1,1],["get","nivell_2"],0,"#ffffff",111,"#ffff00",112,"#ccff33",113,"#af5b15",114,"#808000",115,"#cdcd00",116,"#ffffcc",221,"#33cc33",222,"#66ff33",223,"#689018",224,"#967d5f",225,"#19e61e",226,"#b4ff9b",227,"#aaa500",228,"#c3c3a0",229,"#00ff9b",230,"#ff9632",231,"#282828",232,"#79797a",233,"#f5df78",234,"#3296ff",341,"#ff007d",342,"#ff53cd",343,"#ffa4e2",344,"#ffc8e2",345,"#ffb4b4",346,"#0f3700",347,"#730055",348,"#6200c4",349,"#4a9595",350,"#ff00f0",351,"#adaaca",352,"#ffe6e6",353,"#67629a",354,"#4a466e",355,"#2f2d46",461,"#6f6fff",462,"#0000dc",463,"#000064",464,"#185f94",465,"#12466d",466,"#000080"]}},Nst="lines",a1="labels";let sd,Zg,ki,Ln,kst=class{constructor(t){kM.getConfigICGC().then(e=>{sd={...e.Styles},ki={...e.Layers},Zg={...e.Terrains},Ln={...e.defaultOptions},this.initTheMap(t)}).catch(e=>{console.info("Configuracio per defecte",e),sd={...ed.Styles},ki={...ed.Layers},Zg={...ed.Terrains},Ln={...ed.defaultOptions},this.initTheMap(t)})}initTheMap(t){if(!t)t=Ln.mapOptions;else for(const n in Ln.mapOptions){let i=[Ln.mapOptions.center[0],Ln.mapOptions.center[1]];Ln.mapOptions.center=i,t.hasOwnProperty(n)||(t[n]=Ln.mapOptions[n])}t.maxPitch=85,t.maplibreLogo=!1,t.attributionControl=!1;const e=t.style.includes("https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/");e?(this.map=new Ps.Map({container:t.container,center:t.center,zoom:t.zoom,pitch:t.pitch||0,hash:t.hash||!1,style:{version:8,sources:{},layers:[]}}),this.map.on("load",()=>{this.map.addSource("raster-source",{type:"raster",tiles:[t.style],tileSize:256}),this.map.addLayer({id:"raster-layer",type:"raster",source:"raster-source"})})):this.map=new Ps.Map(t),this.map.on("load",()=>{if(!e){const n=this.map.getStyle().name,i=t.style;this.map.addControl(new ait({color:i.indexOf("orto")===-1,defaultOptions:Ln}),"bottom-left"),this._dealOrto3dStyle(n)}})}addGeocoderICGC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"top-right";try{t={...{collapsed:!0,marker:!0,zoom:16,popup:!0,showResultMarkers:!0,maplibregl:Ps,showResultsWhileTyping:!0,minLength:2},...t};const i={forwardGeocode:async a=>{const o=[];try{const d=Ln.geocoder.peliasUrl1+encodeURIComponent(a.query)+Ln.geocoder.peliasUrl2,_=await(await fetch(d)).json();for(const w of _.features){const x=w.geometry.coordinates,B={type:"Feature",geometry:{type:"Point",coordinates:x},place_name:w.properties.etiqueta,properties:w.properties,text:w.properties.etiqueta,place_type:["place"],center:x};o.push(B)}}catch(d){console.error(`Failed to forwardGeocode with error: ${d}`)}return{features:o}}};this.map.addControl(new oit(i,t),e);let s=document.getElementsByClassName("maplibregl-ctrl-geocoder--input");s[0].attributes[2].nodeValue="Cerca...",s[0].addEventListener("input",function(a){a.target.value.length>3})}catch(n){console.error(`Error adding ICGC geocoder: ${n.message}`)}}async loadImage(t){try{return this.map.loadImage(t)}catch(e){console.error(`Error getting loadImage: ${e.message}`)}}getConfigStyles(){try{let t=[];for(const e of sd)t.push(e.name);return t}catch(t){console.error(`Error retrieving base styles: ${t.message}`)}}getConfigWMSLayers(){try{let t=[];for(const e in ki.WMS)ki.WMS.hasOwnProperty(e)&&t.push(e);return t}catch(t){console.error(`Error retrieving WMS layers: ${t.message}`)}}getConfigOrtoLayers(){try{let t=[];for(const e in ki.Orto)ki.Orto.hasOwnProperty(e)&&t.push(e);return t}catch(t){console.error(`Error retrieving orto image layers: ${t.message}`)}}getConfigVectorLayers(){try{let t=[];for(const e in ki.Vector)ki.Vector.hasOwnProperty(e)&&t.push(e);return t}catch(t){console.error(`Error retrieving vector layers: ${t.message}`)}}getConfigVectorAdminLayers(){try{let t=[];for(const e in ki.VectorAdmin)ki.VectorAdmin.hasOwnProperty(e)&&t.push(e);return t}catch(t){console.error(`Error retrieving vectorAdmin layers: ${t.message}`)}}getConfigFGBAdminLayers(){try{let t=[];for(const e in ki.FGBAdmin)ki.FGBAdmin.hasOwnProperty(e)&&t.push(e);return t}catch(t){console.error(`Error retrieving FGBAdmin layers: ${t.message}`)}}async fetchData(t,e,n){try{(!n||n===void 0)&&(n={type:"line",layout:{visibility:"visible"},paint:{"line-color":"grey","line-width":2},layerPosition:"top"});let i=n.layerPosition;if(t.includes(".fgb"))this.addFGBLayerICGC(t,e,n);else{const a=await(await fetch(t)).json();let o=e,d=this._dealOrderLayer(i),f=a.features[0].geometry.type;f.includes("ine")&&(n!==void 0?this.map.addLayer({id:o,type:"line",source:{type:"geojson",data:a},layout:n.layout||{},paint:n.paint||{}},d):this.map.addLayer({id:o,type:"line",source:{type:"geojson",data:a},layout:{visibility:"visible"},paint:{"line-color":"black","line-width":2,"line-opacity":1}},d)),f.includes("olygon")&&(n!==void 0?this.map.addLayer({id:o,type:"fill",source:{type:"geojson",data:a},layout:n.layout,paint:n.paint},d):this.map.addLayer({id:o,type:"fill",source:{type:"geojson",data:a},layout:{visibility:"visible"},paint:{"fill-color":"blue","fill-opacity":.6}},d)),f.includes("oint")&&(n!==void 0?this.map.addLayer({id:o,type:"circle",source:{type:"geojson",data:a},layout:n.layout,paint:n.paint},d):this.map.addLayer({id:o,type:"circle",source:{type:"geojson",data:a},layout:{visibility:"visible"},paint:{"circle-color":"red","circle-opacity":.85}},d))}}catch(i){console.error(`Error fetching data: ${i.message}`)}}async fetchDataAndMenu(t,e,n,i){try{let s;i!==null?s=i.layerPosition:s=a1;let a,o=document.getElementById("map");if(document.getElementById("menu-group")?a=document.getElementById("menu-group"):(a=document.createElement("nav"),a.id="menu-group",a.classList.add="filter-group",o.appendChild(a)),a!==null){let d="visible",f=this._dealOrderLayer(s),_;if(t.includes(".fgb")){let x=this._getKeyByUrlFGB(t);x===null&&(x="userFGB");const B=await fetch(t),P={type:"FeatureCollection",features:[]};for await(const N of HS(B.body))P.features.push(N);_=P;let R=e;if(this.map.addSource(R,{type:"geojson",data:P}),t.includes("text"))i!==void 0?this.map.addLayer({id:e,type:"symbol",source:R,layout:i.layout,paint:i.paint},f):this.map.addLayer({id:e,type:"symbol",source:R,layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[8,0],[12,14],[15,15]]},"text-font":["FiraSans-Regular"],"text-field":["get","NOM_AC"],"text-transform":"none","text-max-width":25,visibility:d,"text-justify":"right","text-anchor":"top","text-allow-overlap":!1,"symbol-spacing":2,"text-line-height":1},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},f);else{let N=e+"Text";this.map.addLayer({id:N,type:"symbol",source:R,layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[8,0],[12,14],[15,15]]},"text-font":["FiraSans-Regular"],"text-field":["get","NOM_AC"],"text-transform":"none","text-max-width":25,visibility:d,"text-justify":"right","text-anchor":"top","text-allow-overlap":!1,"symbol-spacing":2,"text-line-height":1},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},f)}}else _=await(await fetch(t)).json();if(n!=="all"){const x=document.createElement("div");x.id="titleDivMenu",x.textContent=e,a.appendChild(x);const B=document.createElement("div");B.id="titleDivMenuSub",B.textContent=` ${n}`,a.appendChild(B)}let w;if(i.type?w=i.type:w=_.features[0].geometry.type,n==="all")w.includes("ine")&&(i!==void 0?this.map.addLayer({id:e,type:"line",source:{type:"geojson",data:_},layout:i.layout,paint:i.paint},f):this.map.addLayer({id:e,type:"line",source:{type:"geojson",data:_},layout:{visibility:"visible"},paint:{"line-color":"black","line-width":2,"line-opacity":1}},f)),w.includes("olygon")&&(i!==void 0?this.map.addLayer({id:e,type:"fill",source:{type:"geojson",data:_},layout:i.layout,paint:i.paint},f):this.map.addLayer({id:e,type:"fill",source:{type:"geojson",data:_},layout:{visibility:"visible"},paint:{"fill-color":"#0000FF","fill-opacity":0}},f)),w.includes("oint")&&(i!==void 0?this.map.addLayer({id:e,type:"circle",source:{type:"geojson",data:_},layout:i.layout,paint:i.paint},f):this.map.addLayer({id:e,type:"circle",source:{type:"geojson",data:_},layout:{visibility:"visible"},paint:{"circle-color":"red","circle-opacity":.85}},f)),w.includes("ymbol")&&(i!==void 0?this.map.addLayer({id:e,type:"symbol",source:{type:"geojson",data:_},layout:i.layout,paint:i.paint},f):this.map.addLayer({id:e,type:"symbol",source:{type:"geojson",data:_},layout:{visibility:"visible"},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},f)),this.addMenuItem(e);else{let x=n;const B={};_.features.forEach(P=>{const R=P.properties[x],N=R+"-userFieldFilter-"+e;R!==null&&(B[N]||(w.includes("ine")&&(i!==void 0?this.map.addLayer({id:N,type:"line",source:{type:"geojson",data:_},layout:i.layout,paint:i.paint,filter:["==",`${x}`,R]},f):this.map.addLayer({id:N,type:"line",source:{type:"geojson",data:_},layout:{visibility:"visible"},filter:["==",`${x}`,R],paint:{"line-color":"black","line-width":2,"line-opacity":1}},f)),w.includes("olygon")&&(i!==void 0?this.map.addLayer({id:N,type:"fill",source:{type:"geojson",data:_},filter:["==",`${x}`,R],layout:i.layout,paint:i.paint},f):this.map.addLayer({id:N,type:"fill",source:{type:"geojson",data:_},layout:{visibility:"visible"},filter:["==",`${x}`,R],paint:{"fill-color":"blue","fill-opacity":.6}},f)),w.includes("oint")&&(i!==void 0?this.map.addLayer({id:N,type:"circle",source:{type:"geojson",data:_},filter:["==",`${x}`,R],layout:i.layout,paint:i.paint},f):this.map.addLayer({id:N,type:"circle",source:{type:"geojson",data:_},layout:{visibility:"visible"},filter:["==",`${x}`,R],paint:{"circle-color":"red","circle-opacity":.85}},f)),B[N]=!0,this.addMenuItem(N)))})}}}catch(s){console.error(`Error fetching data: ${s.message}`)}}on(t,e){setTimeout(()=>{try{return this.map.on(t,e)}catch(n){console.error(`Error adding event ON listener: ${n.message}`)}},100)}setStyle(t,e){try{e!==void 0?this.map.setStyle(t,e):this.map.setStyle(t),this.map.on("styledata",()=>{if(window.document.querySelector(".maplibregl-compact-show")){var n=window.document.querySelector(".maplibregl-compact-show");n.classList.remove("maplibregl-compact-show")}this._dealOrto3dStyle(this.map.getStyle().name)})}catch(n){console.error(`Error setting style: ${n.message}`)}}addControl(t,e){try{e===void 0&&(e="top-right"),this.map.addControl(t,e)}catch(n){console.error(`Error adding control: ${n.message}`)}}setSky(t){try{t===void 0&&(this.map.style.stylesheet.id.includes("orto")?t={"sky-color":"#86bbd5","sky-horizon-blend":.3,"horizon-color":"#ffffff33","horizon-fog-blend":.1,"fog-ground-blend":.75,"fog-color":"#c5d6d6"}:this.map.style.stylesheet.id.includes("mapa_estandard_general")?t={"sky-color":"#a5f0f0","sky-horizon-blend":.3,"horizon-color":"#e1e3e3","horizon-fog-blend":.9,"fog-ground-blend":.85,"fog-color":"#c5d6d6"}:this.map.style.stylesheet.id.includes("icgc_mapa_vissir")?t={"sky-color":"#a5f0f0","sky-horizon-blend":.3,"horizon-color":"#e1e3e3","horizon-fog-blend":.9,"fog-ground-blend":.85,"fog-color":"#c5d6d6"}:this.map.style.stylesheet.id.includes("fosc")?t={"sky-color":"#232423","sky-horizon-blend":.3,"horizon-color":"#969996","horizon-fog-blend":.9,"fog-ground-blend":.85,"fog-color":"#383838"}:t={"sky-color":"#86bbd5","sky-horizon-blend":.3,"horizon-color":"#ffffff33","horizon-fog-blend":.1,"fog-ground-blend":.75,"fog-color":"#c5d6d6"}),this.map.setSky(t)}catch(e){console.error(`Error setting sky properties: ${e.message}`)}}addMouseCoordControl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"bottom-left";try{this.map.addControl(new Ait(t),e)}catch(n){console.error(`Error adding mouse coordinate control: ${n.message}`)}}addGeolocateControl(t,e){try{e===void 0&&(e="top-right"),t===void 0?this.map.addControl(new Ps.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),e):this.map.addControl(new Ps.GeolocateControl(t),e)}catch(n){console.error(`Error adding geolocate control: ${n.message}`)}}addFullscreenControl(t,e){try{e===void 0&&(e="top-right"),t===void 0?this.map.addControl(new Ps.FullscreenControl({container:HTMLElement}),e):this.map.addControl(new Ps.FullscreenControl(t),e)}catch(n){console.error(`Error adding fullscreen control: ${n.message}`)}}addLayer(t,e){try{this.map.addLayer(t,e)}catch(n){console.error(`Error adding layer: ${n.message}`)}}addImage(t,e,n){try{this.map.addImage(t,e,n)}catch(i){console.error(`Error adding image: ${i.message}`)}return this}addSource(t,e){try{this.map.addSource(t,e)}catch(n){console.error(`Error adding source: ${n.message}`)}return this}addSprite(t,e,n){try{this.map.addSprite(t,e,n)}catch(i){console.error(`Error adding sprite: ${i.message}`)}return this}areTilesLoaded(){return this.map.areTilesLoaded()}cameraForBounds(t,e){return this.map.cameraForBounds(t,e)}easeTo(t,e){return this.map.easeTo(t,e),this}fitBounds(t,e,n){return this.map.fitBounds(t,e,n),this}fitScreenCoordinates(t,e,n,i,s){return this.map.fitScreenCoordinates(t,e,n,i,s),this}flyTo(t,e){return this.map.flyTo(t,e),this}getBearing(){return this.map.getBearing()}getBounds(){return this.map.getBounds()}getCameraTargetElevation(){return this.map.getCameraTargetElevation()}getCanvas(){return this.map.getCanvas()}getCanvasContainer(){return this.map.getCanvasContainer()}getCenter(){return this.map.getCenter()}getContainer(){return this.map.getContainer()}getFeatureState(t){return this.map.getFeatureState(t)}getFilter(t){return this.map.getFilter(t)}getGlyphs(){return this.map.getGlyphs()}getImage(t){return this.map.getImage(t)}getLayer(t){return this.map.getLayer(t)}getLayersOrder(){return this.map.getLayersOrder()}getLayoutProperty(t,e){return this.map.getLayoutProperty(t,e)}getLight(){return this.map.getLight()}getMaxBounds(){return this.map.getMaxBounds()}getMaxPitch(){return this.map.getMaxPitch()}getMaxZoom(){return this.map.getMaxZoom()}getMinPitch(){return this.map.getMinPitch()}getMinZoom(){return this.map.getMinZoom()}getPadding(){return this.map.getPadding()}getPaintProperty(t,e){return this.map.getPaintProperty(t,e)}getPitch(){return this.map.getPitch()}getPixelRatio(){return this.map.getPixelRatio()}getRenderWorldCopies(){return this.map.getRenderWorldCopies()}getSource(t){return this.map.getSource(t)}getSprite(){return this.map.getSprite()}getStyle(){return this.map.getStyle()}getTerrain(){return this.map.getTerrain()}getZoom(){return this.map.getZoom()}hasControl(t){return this.map.hasControl(t)}hasImage(t){return this.map.hasImage(t)}isMoving(){return this.map.isMoving()}isRotating(){return this.map.isRotating()}isSourceLoaded(t){return this.map.isSourceLoaded(t)}isStyleLoaded(){return this.map.isStyleLoaded()}isZooming(){return this.map.isZooming()}jumpTo(t,e){return this.map.jumpTo(t,e)}listImages(){return this.map.listImages()}listens(t){return this.map.listens(t)}loadImage(t){return this.map.loadImage(t)}loaded(){return this.map.loaded()}LngLatBounds(t,e){return new Ps.LngLatBounds(t,e)}addProtocol(t,e){return this.map.addProtocol(t,e)}moveLayer(t,e){return this.map.moveLayer(t,e)}panBy(t,e,n){return this.map.panBy(t,e,n)}panTo(t,e,n){return this.map.panTo(t,e,n)}project(t){return this.map.project(t)}queryRenderedFeatures(t,e){return this.map.queryRenderedFeatures(t,e)}querySourceFeatures(t,e){return this.map.querySourceFeatures(t,e)}queryTerrainElevation(t){return this.map.queryTerrainElevation(t)}redraw(){return this.map.redraw()}remove(){return this.map.remove()}removeControl(t){return this.map.removeControl(t)}removeFeatureState(t,e){return this.map.removeFeatureState(t,e)}removeImage(t){return this.map.removeImage(t)}removeLayer(t){try{this.map.removeLayer(t)}catch(e){console.error(`Error removing layer: ${e.message}`)}}removeSource(t){try{this.map.removeSource(t)}catch(e){console.error(`Error removing source: ${e.message}`)}}removeSprite(t){return this.map.removeSprite(t)}resetNorth(t,e){return this.map.resetNorth(t,e)}resetNorthPitch(t,e){return this.map.resetNorthPitch(t,e)}resize(t){return this.map.resize(t)}rotateTo(t,e,n){return this.map.rotateTo(t,e,n)}setBearing(t,e){return this.map.setBearing(t,e)}setCenter(t,e){return this.map.setCenter(t,e)}setEventedParent(t,e){return this.map.setEventedParent(t,e)}setFeatureState(t,e){return this.map.setFeatureState(t,e)}setFilter(t,e,n){return this.map.setFilter(t,e,n)}setGlyphs(t,e){return this.map.setGlyphs(t,e)}setLayerZoomRange(t,e,n){return this.map.setLayerZoomRange(t,e,n)}setLayoutProperty(t,e,n,i){return this.map.setLayoutProperty(t,e,n,i)}setLight(t,e){return this.map.setLight(t,e)}setMaxBounds(t){return this.map.setMaxBounds(t)}setMaxPitch(t){return this.map.setMaxPitch(t)}setMaxZoom(t){return this.map.setMaxZoom(t)}setMinPitch(t){return this.map.setMinPitch(t)}setMinZoom(t){return this.map.setMinZoom(t)}setPadding(t,e){return this.map.setPadding(t,e)}setPaintProperty(t,e,n,i){return this.map.setPaintProperty(t,e,n,i)}setPitch(t,e){return this.map.setPitch(t,e)}setPixelRatio(t){return this.map.setPixelRatio(t)}setRenderWorldCopies(t){return this.map.setRenderWorldCopies(t)}setSprite(t,e){return this.map.setSprite(t,e)}setTerrain(t){return this.map.setTerrain(t)}setTransformRequest(t){return this.map.setTransformRequest(t)}setZoom(t,e){return this.map.setZoom(t,e)}snapToNorth(t,e){return this.map.snapToNorth(t,e)}stop(){return this.map.stop()}triggerRepaint(){return this.map.triggerRepaint()}unproject(t){return this.map.unproject(t)}updateImage(t,e){return this.map.updateImage(t,e)}zoomIn(t,e){return this.map.zoomIn(t,e)}zoomOut(t,e){return this.map.zoomOut(t,e)}zoomTo(t,e,n){return this.map.zoomTo(t,e,n)}addLayerGeoJSON(t,e){try{let n=this._dealOrderLayer(e);this.map.addSource(`${t.id}`,{type:"geojson",data:t.data}),this.map.addLayer({id:`${t.id}-layerIcgcMap`,type:t.type,source:`${t.id}`,layout:t.layout,paint:t.paint},n)}catch(n){console.error(`Error adding GeoJSON layer: ${n.message}`)}}addLayerWMS(t,e,n){try{let i=this._dealOrderLayer(n.layerPosition);n?(this.map.addSource(`${e}`,{type:"raster",tiles:[t],tileSize:256},i),this.map.addLayer({id:e,type:"raster",source:e,layout:n.layout,paint:n.paint},i)):(this.map.addSource(`${e}`,{type:"raster",tiles:[t],tileSize:256},i),this.map.addLayer({id:e,type:"raster",source:e,paint:{}},i))}catch(i){console.error(`Error adding WMS layer: ${i.message}`)}}addLogo(t){try{let e=document.getElementById("map"),n;n=document.createElement("div"),n.id="logos",e.appendChild(n);const i=document.createElement("img");i.src=t.url,i.style.height=t.height;const s=document.getElementById("logos"),a=document.createElement("a");a.id=t.id,a.href=t.href,a.target="_blank",a.style.position="relative",a.style.bottom="1px",a.appendChild(i),s.appendChild(a)}catch(e){console.error(`Error adding logo: ${e.message}`)}}addBasemapsICGC(t){try{const e=a=>{this.map.setStyle(a)};let n=document.getElementById("map"),i;i=document.createElement("div"),i.id="basemap-group",i.classList.add="filter-group",n.appendChild(i);const s=document.getElementById("basemap-group");for(const a of t)for(const o of Object.keys(Ln.baseStyles)){const d=Ln.baseStyles[o];if(a===d.url){const f=document.createElement("div");f.className="basemap-item",f.title=d.key,f.style.backgroundImage=`url('${d.image}')`,s.appendChild(f),f.addEventListener("click",()=>e(d.url))}}}catch(e){console.error(`Error adding basemaps: ${e.message}`)}}addBasemaps(t){try{const e=a=>{map.setStyle(a.url)};let n=document.getElementById("map"),i;i=document.createElement("div"),i.id="basemap-group",i.classList.add="basemap-group",n.appendChild(i);const s=document.getElementById("basemap-group");t.forEach(a=>{const o=document.createElement("div");o.className="basemap-item",o.title=a.label,o.style.backgroundImage=`url('${a.image}')`,s.appendChild(o),o.addEventListener("click",()=>e(a))})}catch(e){console.error(`Error adding basemaps: ${e.message}`)}}addFeatureQuery(t,e,n){try{let i;this.map.on("mouseenter",t,()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave",t,()=>{this.map.getCanvas().style.cursor=""}),this.map.on("click",s=>{let a=this.map.queryRenderedFeatures(s.point);if(a&&a[0].source.includes(t)){let o=[s.lngLat.lng,s.lngLat.lat];if(e!==void 0&&e.length>0&&e!=="all"){if(e!==null){let d="";e.forEach(f=>{let _=a[0].properties[f];d=d+`<h4>${_}</h4>`}),i=d,this.addPopup(o,i,n)}}else{let d="";for(const f in a[0].properties)d+="<b>"+f+"</b>:"+a[0].properties[f]+"<br>";i=d,this.addPopup(o,i,n)}}})}catch(i){console.error(`Error adding feature query: ${i.message}`)}}addScaleControl(t,e){try{var n=new Ps.ScaleControl(t);this.map.addControl(n,e)}catch(i){console.error(`Error adding scale: ${i.message}`)}}addExportControl(t,e){try{typeof t=="string"&&(e=t,t=void 0),t===void 0&&(t={PageSize:Xh.A4,PageOrientation:Vg.Landscape,Format:$u.PNG,DPI:L2[300],Crosshair:!0,PrintableArea:!0,Local:"ca"},e="top-right"),this.map.addControl(new gnt(t),e)}catch(n){console.error(`Error adding export control: ${n.message}`)}}addMarker(t){try{let e,n;return t.text===void 0?e=new Ps.Marker(t.options).setLngLat(t.coord).addTo(this.map):(n=new Ps.Popup({offset:t.textOffset}).setHTML(t.text),e=new Ps.Marker(t.options).setLngLat(t.coord).setPopup(n).addTo(this.map)),e}catch(e){return console.error(`Error adding marker: ${e.message}`),null}}addPopup(t,e,n){try{return n.image===void 0?new Ps.Popup().setLngLat(t).setHTML(`
        <div class="popupBody">
          <div class="popupTop">
          ${n.title}
          </div>
          <div class="popupBottom">
          <div class="popupBottomUp">
 ${e}
          </div>
          <div class="popupBottomDown">
          </div>
          </div>
        </div>
      `).addTo(this.map):new Ps.Popup().setLngLat(t).setHTML(`
        <div class="popupBody">
          <div class="popupTop">
          ${n.title}
          </div>
          <div class="popupBottom">
          <div class="popupBottomUp">
          ${e}
          </div>
          <div class="popupBottomDown">
             <img style="  padding: 8px;  width: 50%;" src=${n.image} />
          </div>
          </div>
        </div>
      `).addTo(this.map)}catch(i){return console.error(`Error adding popup: ${i.message}`),null}}addFullScreen(t){try{t===void 0&&(t="top-right"),this.map.addControl(new Ps.FullscreenControl,t)}catch(e){console.error(`Error adding fullscreen control: ${e.message}`)}}addMenuItem(t){try{let e;if(t.includes("-userFieldFilter-")?e=t.split("-userFieldFilter-")[0]:e=t,t.length>0){const n=document.getElementById("menu-group"),i=document.createElement("input");i.type="checkbox",i.id=t,i.checked=!0,n.appendChild(i);const s=document.createElement("label");s.setAttribute("for",t),s.textContent=e,n.appendChild(s),i.addEventListener("change",a=>{this.map.setLayoutProperty(t,"visibility",a.target.checked?"visible":"none")})}}catch(e){console.error(`Error adding menu item: ${e.message}`)}}addLayerTree(t){try{let e=t.features,n=document.getElementById("map"),i=document.createElement("nav");i.id="filter-group",n.appendChild(i);const s=document.getElementById("filter-group");this.map.addSource(`${t.id}`,{type:t.type,data:e}),e.features.forEach(a=>{const o=a.properties.icon,d=`poi-${o}`;if(!this.map.getLayer(d)){this.map.addLayer({id:d,type:"circle",source:`${t.id}`,paint:{"circle-radius":6,"circle-color":"#B42222"},filter:["==","icon",o]},this._firstSymbolLayer());const f=document.createElement("input");f.type="checkbox",f.id=d,f.checked=!0,s.appendChild(f);const _=document.createElement("label");_.setAttribute("for",d),_.textContent=o,s.appendChild(_),f.addEventListener("change",w=>{this.map.setLayoutProperty(d,"visibility",w.target.checked?"visible":"none")})}})}catch(e){console.error(`Error adding layer tree: ${e.message}`)}}createNavigationControl(t,e){try{e===void 0&&(e="top-right"),this.map.addControl(new Ps.NavigationControl(t),e)}catch(n){return console.error(`Error creating navigation control: ${n.message}`),null}}addNavigationControl(t,e){try{e===void 0&&(e="top-right"),this.map.addControl(new Ps.NavigationControl(t),e)}catch(n){console.error(`Error adding navigation control: ${n.message}`)}}addAttributionControl(t,e){try{this.map.addControl(new Ps.AttributionControl(t),e)}catch(n){console.error(`Error adding attribution control: ${n.message}`)}}addImageLayerICGC(t,e,n){try{let i=null,s,a;n?(a=n,s=n.layerPosition):a={type:"raster",layout:{visibility:"visible"},paint:{"raster-opacity":1},layerPosition:a1},i=this._findImageType(t,ki.Orto,ki.VectorAdmin,ki.WMS,ki.Vector),i||console.log(" %c The layer: %c%s%c does not exist in the ICGC DB. Consult the documentation.","font-weight: bold; font-style: italic;","font-weight: normal; font-style: normal; color: red;",t,"font-weight: bold; font-style: italic;");let o={id:e,tiles:t};this.addLayerWMS(t,e,a)}catch(i){console.error(`Error adding ICGC image layer: ${i.message}`)}}async addVectorLayerICGC(t,e,n){try{let{type:i="line",layerPosition:s=a1,layoutOptions:a={visibility:"visible"},paintOption:o}=n||{},d=this._dealOrderLayer(s);if(!t){console.log(" %c The layer: %c%s%c does not exist in the ICGC DB. Consult the documentation.","font-weight: bold; font-style: italic;","font-weight: normal; font-style: normal; color: red;",t,"font-weight: bold; font-style: italic;");return}if(t.includes("https")){let f=this._getKeyByUrlVector(t);this.map.addSource(f,{type:"vector",url:t});let _={id:f,type:"fill",source:f,"source-layer":"cobertes",maxzoom:18,layout:n.layout,paint:Dst.cobertesSol};if(f==="cobertes2018"&&this.map.addLayer(_,d),a.visibility==="visible"){let w=this._getLegendByName(f);this.addLegend(w,f)}}else{let f=e;this.map.addSource(f,{type:"vector",url:Ln.limitsUrl});let _={id:e,type:i,source:f,"source-layer":t,layout:n.layout,paint:n.paint||{}};i==="fill"||i==="polygon"?_.paint=o||{"fill-color":"#0000FF","fill-opacity":0}:i==="line"&&(_.paint=o||{"line-color":"#4832a8","line-opacity":1,"line-width":1}),this.map.addLayer(_,d)}}catch(i){console.error(`Error adding ICGC vector layer: ${i.message}`)}}async addFGBLayerICGC(t,e,n){try{n||(n.layout={visibility:!0},n.paint={"line-color":"#4832a8","line-opacity":1,"line-width":1},n.type="lines",n.layerPosition="labels");let i=this._dealOrderLayer(n.layerPosition);const s=await fetch(t),a={type:"FeatureCollection",features:[]};for await(const d of HS(s.body))a.features.push(d);let o=e;this.map.addSource(o,{type:"geojson",data:a}),t.includes("text")?this.map.addLayer({id:e,type:"symbol",source:o,layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[8,0],[12,14],[15,15]]},"text-font":["FiraSans-Regular"],"text-field":["get","NOM_AC"],"text-transform":"none","text-max-width":25,visibility:n.layout.visibility,"text-justify":"right","text-anchor":"top","text-allow-overlap":!1,"symbol-spacing":2,"text-line-height":1},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},i):this.map.addLayer({id:e,type:n.type,source:o,layout:n.layout,paint:n.paint},i)}catch(i){console.error(`Error adding ICGC FGB layer: ${i.message}`)}}addTerrainICGC(t,e){try{let n;for(const s in Zg)if(Zg.hasOwnProperty(s)){const a=Zg[s];a===t&&(n=a)}let i=n;this.getSource("terrainICGC")!==void 0&&(this.getStyle().layers.forEach(a=>{a.source==="terrainICGC"&&this.removeLayer(a.id)}),this.removeSource("terrainICGC")),this.getSource("terrainICGC")===void 0&&(t.includes("terrarium")?this.map.addSource("terrainICGC",{type:"raster-dem",tiles:[i],tileSize:512,encoding:"terrarium",maxzoom:16}):this.map.addSource("terrainICGC",{type:"raster-dem",tiles:[i],tileSize:512,maxzoom:16})),this.map.setTerrain({source:"terrainICGC",exaggeration:1.5}),e==null||this.map.addControl(new P8({pitch:90,bearing:null,minpitchzoom:null}),e)}catch(n){console.error(`Error adding 3D terrain: ${n.message}`)}}addLegend(t,e){try{this.map.addControl(new lit({url:t,idLayer:e}))}catch(n){console.error(`Error adding legend: ${n.message}`)}}_findImageType(t,e,n,i,s){const a=[e,n,i,s];for(const o of a)for(const[d,f]of Object.entries(o))if(f===t)return d;return null}_getKeyByUrlFGB(t){for(const e in ki.FGBAdmin)if(ki.FGBAdmin.hasOwnProperty(e)&&ki.FGBAdmin[e]===t)return e;return null}_getLegendByName(t){for(const e in Ln.vectorLayers){const n=Ln.vectorLayers[e];if(n.key===t)return n.legend}return null}_getKeyByUrlVector(t){for(const e in ki.Vector)if(ki.Vector.hasOwnProperty(e)&&ki.Vector[e]===t)return e;return null}async _raiseText3DStyle(){try{const t=await this.map.loadImage(Ln.map3dOptions.imageIcon);this.map.addImage("stick",t.data),this.map.getStyle().layers.forEach(e=>{if(e["source-layer"]===Ln.map3dOptions.sourceLayerFilterId&&e.minzoom>=Ln.map3dOptions.minZoomFilter&&t){const n=e.id;this.map.setLayoutProperty(n,"icon-image","stick"),this.map.setLayoutProperty(n,"text-offset",[0,-9]),this.map.setLayoutProperty(n,"symbol-placement","point"),this.map.setLayoutProperty(n,"symbol-avoid-edges",!1),this.map.setLayoutProperty(n,"text-allow-overlap",!0),this.map.setLayoutProperty(n,"text-ignore-placement",!1),this.map.setLayoutProperty(n,"text-pitch-alignment","auto"),this.map.setLayoutProperty(n,"text-rotation-alignment","auto"),this.map.setLayoutProperty(n,"text-justify","center"),this.map.setLayoutProperty(n,"text-anchor","bottom"),this.map.setLayoutProperty(n,"icon-anchor","bottom"),this.map.setPaintProperty(n,"text-color","#ffffff"),this.map.setPaintProperty(n,"text-halo-color","#000000"),this.map.setPaintProperty(n,"text-halo-width",2)}})}catch(t){return console.error(`Error dealing orto 3D: ${t.message}`),null}}_dealStyleMaps(t){try{if(t&&t.indexOf("icgc.cat")!=-1){for(const e in sd)if(sd.hasOwnProperty(e)){const n=sd[e];if(e===t)return n}return sd[0]}else return t}catch(e){return console.error(`Error dealing with map styles: ${e.message}`),null}}_dealOrto3dStyle(t){try{if(t=="orto3d"){this.map.setMaxZoom(18.8),this.map.easeTo({pitch:45});const e=new BI({intensity:4}),n=new ow({ambientLight:e});this.map.setTerrain({source:Ln.map3dOptions.terrainSource,exaggeration:Ln.map3dOptions.exaggeration});const i=this._createCitiesMapboxLayer();this.map.getLayer(Ln.map3dOptions.layerId3d)||(this.map.addLayer(i,Ln.map3dOptions.layerIdOrder),this.map.setLayerZoomRange(Ln.map3dOptions.layerId3d,Ln.map3dOptions.minZoomRange,Ln.map3dOptions.maxZoomRange),i.deck.setProps({effects:[n]}),this._raiseText3DStyle()),this.map.setSky({"sky-color":"#86bbd5","sky-horizon-blend":.3,"horizon-color":"#ffffff33","horizon-fog-blend":.1,"fog-ground-blend":.75,"fog-color":"#c5d6d6"})}else this.map.getLayer(Ln.map3dOptions.layerId3d)&&(this.map.removeLayer(Ln.map3dOptions.layerId3d),this.map.setTerrain(null))}catch(e){return console.error(`Error dealing orto 3D: ${e.message}`),null}}_dealOrderLayer(t){return t===a1?this._firstSymbolLayer():t===Nst?this._firstLineLayer():""}_firstSymbolLayer(){try{const t=this.map.getStyle().layers;let e;for(let n=0;n<t.length;n++)if(t[n].type==="symbol"&&t[n].id.indexOf("contour")===-1&&t[n].id.indexOf("water")===-1){e=t[n].id;break}return e}catch(t){console.error(`Error getting first symbol layer: ${t.message}`)}}_firstLineLayer(){try{const t=this.map.getStyle().layers;let e;for(let n=0;n<t.length;n++)if(t[n].type==="line"){e=t[n].id;break}return e}catch(t){console.error(`Error getting first symbol layer: ${t.message}`)}}_createCitiesMapboxLayer(){try{return new WW({id:Ln.map3dOptions.layerId3d,type:F2,data:Ln.map3dOptions.urlTilesetCities,loader:I2,loadOptions:{tileset:{viewDistanceScale:1,updateTransforms:!0,maximumScreenSpaceError:Ln.map3dOptions.spaceErrorFactor}},onTilesetLoad:e=>{e.options.maximumScreenSpaceError=Ln.map3dOptions.spaceErrorFactor},onTileLoad:e=>{e.content.cartographicOrigin.z-=Ln.map3dOptions.zfactor},operation:"terrain+draw"})}catch(t){return console.error(`Error adding MapboxLayer: ${t.message}`),null}}};var QM={exports:{}};function Qst(r,t){var e=r.getCenter(),n=r.getZoom(),i=r.getBearing(),s=r.getPitch();t.forEach(function(a){a.jumpTo({center:e,zoom:n,bearing:i,pitch:s})})}function zst(){var r,t=arguments.length;if(t===1)r=arguments[0];else{r=[];for(var e=0;e<t;e++)r.push(arguments[e])}var n=[];r.forEach(function(o,d){n[d]=a.bind(null,o,r.filter(function(f,_){return _!==d}))});function i(){r.forEach(function(o,d){o.on("move",n[d])})}function s(){r.forEach(function(o,d){o.off("move",n[d])})}function a(o,d){s(),Qst(o,d),i()}return i(),function(){s(),n=[],r=[]}}var Hst=zst;(function(r){var t=Hst,e=WP.EventEmitter;function n(i,s,a,o){if(this.options=o||{},this._mapA=i,this._mapB=s,this._horizontal=this.options.orientation==="horizontal",this._onDown=this._onDown.bind(this),this._onMove=this._onMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._ev=new e,this._swiper=document.createElement("div"),this._swiper.className=this._horizontal?"compare-swiper-horizontal":"compare-swiper-vertical",this._controlContainer=document.createElement("div"),this._controlContainer.className=this._horizontal?"maplibregl-compare maplibregl-compare-horizontal":"maplibregl-compare",this._controlContainer.className=this._controlContainer.className,this._controlContainer.appendChild(this._swiper),typeof a=="string"&&document.body.querySelectorAll){var d=document.body.querySelectorAll(a)[0];if(!d)throw new Error("Cannot find element with specified container selector.");d.appendChild(this._controlContainer)}else if(a instanceof Element&&a.appendChild)a.appendChild(this._controlContainer);else throw new Error("Invalid container specified. Must be CSS selector or HTML element.");this._bounds=s.getContainer().getBoundingClientRect();var f=(this._horizontal?this._bounds.height:this._bounds.width)/2;this._setPosition(f),this._clearSync=t(i,s),this._onResize=(function(){this._bounds=s.getContainer().getBoundingClientRect(),this.currentPosition&&this._setPosition(this.currentPosition)}).bind(this),s.on("resize",this._onResize),this.options&&this.options.mousemove&&(i.getContainer().addEventListener("mousemove",this._onMove),s.getContainer().addEventListener("mousemove",this._onMove)),this._swiper.addEventListener("mousedown",this._onDown),this._swiper.addEventListener("touchstart",this._onDown)}n.prototype={_setPointerEvents:function(i){this._controlContainer.style.pointerEvents=i,this._swiper.style.pointerEvents=i},_onDown:function(i){i.touches?(document.addEventListener("touchmove",this._onMove),document.addEventListener("touchend",this._onTouchEnd)):(document.addEventListener("mousemove",this._onMove),document.addEventListener("mouseup",this._onMouseUp))},_setPosition:function(i){i=Math.min(i,this._horizontal?this._bounds.height:this._bounds.width);var s=this._horizontal?"translate(0, "+i+"px)":"translate("+i+"px, 0)";this._controlContainer.style.transform=s,this._controlContainer.style.WebkitTransform=s;var a=this._horizontal?"rect(0, 999em, "+i+"px, 0)":"rect(0, "+i+"px, "+this._bounds.height+"px, 0)",o=this._horizontal?"rect("+i+"px, 999em, "+this._bounds.height+"px,0)":"rect(0, 999em, "+this._bounds.height+"px,"+i+"px)";this._mapA.getContainer().style.clip=a,this._mapB.getContainer().style.clip=o,this.currentPosition=i},_onMove:function(i){this.options&&this.options.mousemove&&this._setPointerEvents(i.touches?"auto":"none"),this._horizontal?this._setPosition(this._getY(i)):this._setPosition(this._getX(i))},_onMouseUp:function(){document.removeEventListener("mousemove",this._onMove),document.removeEventListener("mouseup",this._onMouseUp),this.fire("slideend",{currentPosition:this.currentPosition})},_onTouchEnd:function(){document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onTouchEnd),this.fire("slideend",{currentPosition:this.currentPosition})},_getX:function(i){i=i.touches?i.touches[0]:i;var s=i.clientX-this._bounds.left;return s<0&&(s=0),s>this._bounds.width&&(s=this._bounds.width),s},_getY:function(i){i=i.touches?i.touches[0]:i;var s=i.clientY-this._bounds.top;return s<0&&(s=0),s>this._bounds.height&&(s=this._bounds.height),s},setSlider:function(i){this._setPosition(i)},on:function(i,s){return this._ev.on(i,s),this},fire:function(i,s){return this._ev.emit(i,s),this},off:function(i,s){return this._ev.removeListener(i,s),this},remove:function(){this._clearSync(),this._mapB.off("resize",this._onResize);var i=this._mapA.getContainer();i&&(i.style.clip=null,i.removeEventListener("mousemove",this._onMove));var s=this._mapB.getContainer();s&&(s.style.clip=null,s.removeEventListener("mousemove",this._onMove)),this._swiper.removeEventListener("mousedown",this._onDown),this._swiper.removeEventListener("touchstart",this._onDown),this._controlContainer.remove()}},window.maplibregl?maplibregl.Compare=n:r.exports=n})(QM);var Vst=QM.exports;const Gst=Vp(Vst);class jst{constructor(t,e,n,i){const s=this;setTimeout(function(){s.mapCompare=new Gst(t.map,e.map,n,{})},1e3)}}/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var vx=function(r,t){return vx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])},vx(r,t)};function oc(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");vx(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var bx=function(){return bx=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},bx.apply(this,arguments)};function Ho(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(_){try{f(n.next(_))}catch(w){a(w)}}function d(_){try{f(n.throw(_))}catch(w){a(w)}}function f(_){_.done?s(_.value):i(_.value).then(o,d)}f((n=n.apply(r,[])).next())})}function wo(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(f){return function(_){return d([f,_])}}function d(f){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return e.label++,{value:f[1],done:!1};case 5:e.label++,i=f[1],f=[0];continue;case 7:f=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){e=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){e.label=f[1];break}if(f[0]===6&&e.label<s[1]){e.label=s[1],s=f;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(f);break}s[2]&&e.ops.pop(),e.trys.pop();continue}f=t.call(r,e)}catch(_){f=[6,_],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function l1(r,t,e){if(arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return r.concat(s||t)}for(var Xu=function(){function r(t,e,n,i){this.left=t,this.top=e,this.width=n,this.height=i}return r.prototype.add=function(t,e,n,i){return new r(this.left+t,this.top+e,this.width+n,this.height+i)},r.fromClientRect=function(t,e){return new r(e.left+t.windowBounds.left,e.top+t.windowBounds.top,e.width,e.height)},r.fromDOMRectList=function(t,e){var n=Array.from(e).find(function(i){return i.width!==0});return n?new r(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height):r.EMPTY},r.EMPTY=new r(0,0,0,0),r}(),c1=function(r,t){return Xu.fromClientRect(r,t.getBoundingClientRect())},qst=function(r){var t=r.body,e=r.documentElement;if(!t||!e)throw new Error("Unable to get document size");var n=Math.max(Math.max(t.scrollWidth,e.scrollWidth),Math.max(t.offsetWidth,e.offsetWidth),Math.max(t.clientWidth,e.clientWidth)),i=Math.max(Math.max(t.scrollHeight,e.scrollHeight),Math.max(t.offsetHeight,e.offsetHeight),Math.max(t.clientHeight,e.clientHeight));return new Xu(0,0,n,i)},u1=function(r){for(var t=[],e=0,n=r.length;e<n;){var i=r.charCodeAt(e++);if(i>=55296&&i<=56319&&e<n){var s=r.charCodeAt(e++);(s&64512)===56320?t.push(((i&1023)<<10)+(s&1023)+65536):(t.push(i),e--)}else t.push(i)}return t},Ki=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,r);var e=r.length;if(!e)return"";for(var n=[],i=-1,s="";++i<e;){var a=r[i];a<=65535?n.push(a):(a-=65536,n.push((a>>10)+55296,a%1024+56320)),(i+1===e||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},zM="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Kst=typeof Uint8Array>"u"?[]:new Uint8Array(256),A1=0;A1<zM.length;A1++)Kst[zM.charCodeAt(A1)]=A1;for(var HM="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",tm=typeof Uint8Array>"u"?[]:new Uint8Array(256),h1=0;h1<HM.length;h1++)tm[HM.charCodeAt(h1)]=h1;for(var $st=function(r){var t=r.length*.75,e=r.length,n,i=0,s,a,o,d;r[r.length-1]==="="&&(t--,r[r.length-2]==="="&&t--);var f=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),_=Array.isArray(f)?f:new Uint8Array(f);for(n=0;n<e;n+=4)s=tm[r.charCodeAt(n)],a=tm[r.charCodeAt(n+1)],o=tm[r.charCodeAt(n+2)],d=tm[r.charCodeAt(n+3)],_[i++]=s<<2|a>>4,_[i++]=(a&15)<<4|o>>2,_[i++]=(o&3)<<6|d&63;return f},Wst=function(r){for(var t=r.length,e=[],n=0;n<t;n+=2)e.push(r[n+1]<<8|r[n]);return e},Xst=function(r){for(var t=r.length,e=[],n=0;n<t;n+=4)e.push(r[n+3]<<24|r[n+2]<<16|r[n+1]<<8|r[n]);return e},od=5,wx=11,xx=2,Jst=wx-od,VM=65536>>od,Yst=1<<od,Bx=Yst-1,Zst=1024>>od,tot=VM+Zst,eot=tot,rot=32,not=eot+rot,iot=65536>>wx,sot=1<<Jst,oot=sot-1,GM=function(r,t,e){return r.slice?r.slice(t,e):new Uint16Array(Array.prototype.slice.call(r,t,e))},aot=function(r,t,e){return r.slice?r.slice(t,e):new Uint32Array(Array.prototype.slice.call(r,t,e))},lot=function(r,t){var e=$st(r),n=Array.isArray(e)?Xst(e):new Uint32Array(e),i=Array.isArray(e)?Wst(e):new Uint16Array(e),s=24,a=GM(i,s/2,n[4]/2),o=n[5]===2?GM(i,(s+n[4])/2):aot(n,Math.ceil((s+n[4])/4));return new cot(n[0],n[1],n[2],n[3],a,o)},cot=function(){function r(t,e,n,i,s,a){this.initialValue=t,this.errorValue=e,this.highStart=n,this.highValueIndex=i,this.index=s,this.data=a}return r.prototype.get=function(t){var e;if(t>=0){if(t<55296||t>56319&&t<=65535)return e=this.index[t>>od],e=(e<<xx)+(t&Bx),this.data[e];if(t<=65535)return e=this.index[VM+(t-55296>>od)],e=(e<<xx)+(t&Bx),this.data[e];if(t<this.highStart)return e=not-iot+(t>>wx),e=this.index[e],e+=t>>od&oot,e=this.index[e],e=(e<<xx)+(t&Bx),this.data[e];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},r}(),jM="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",uot=typeof Uint8Array>"u"?[]:new Uint8Array(256),d1=0;d1<jM.length;d1++)uot[jM.charCodeAt(d1)]=d1;var Aot="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",qM=50,hot=1,KM=2,$M=3,dot=4,fot=5,WM=7,XM=8,JM=9,ZA=10,Cx=11,YM=12,Ex=13,pot=14,em=15,Sx=16,f1=17,rm=18,got=19,ZM=20,Tx=21,nm=22,Ix=23,Vf=24,ja=25,im=26,sm=27,Gf=28,mot=29,jf=30,yot=31,p1=32,g1=33,Fx=34,Lx=35,Px=36,om=37,Mx=38,m1=39,y1=40,Rx=41,t4=42,_ot=43,vot=[9001,65288],e4="!",Vo="",_1="",Ux=lot(Aot),Ju=[jf,Px],Ox=[hot,KM,$M,fot],r4=[ZA,XM],n4=[sm,im],bot=Ox.concat(r4),i4=[Mx,m1,y1,Fx,Lx],wot=[em,Ex],xot=function(r,t){t===void 0&&(t="strict");var e=[],n=[],i=[];return r.forEach(function(s,a){var o=Ux.get(s);if(o>qM?(i.push(!0),o-=qM):i.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return n.push(a),e.push(Sx);if(o===dot||o===Cx){if(a===0)return n.push(a),e.push(jf);var d=e[a-1];return bot.indexOf(d)===-1?(n.push(n[a-1]),e.push(d)):(n.push(a),e.push(jf))}if(n.push(a),o===yot)return e.push(t==="strict"?Tx:om);if(o===t4||o===mot)return e.push(jf);if(o===_ot)return s>=131072&&s<=196605||s>=196608&&s<=262141?e.push(om):e.push(jf);e.push(o)}),[n,e,i]},Dx=function(r,t,e,n){var i=n[e];if(Array.isArray(r)?r.indexOf(i)!==-1:r===i)for(var s=e;s<=n.length;){s++;var a=n[s];if(a===t)return!0;if(a!==ZA)break}if(i===ZA)for(var s=e;s>0;){s--;var o=n[s];if(Array.isArray(r)?r.indexOf(o)!==-1:r===o)for(var d=e;d<=n.length;){d++;var a=n[d];if(a===t)return!0;if(a!==ZA)break}if(o!==ZA)break}return!1},s4=function(r,t){for(var e=r;e>=0;){var n=t[e];if(n===ZA)e--;else return n}return 0},Bot=function(r,t,e,n,i){if(e[n]===0)return Vo;var s=n-1;if(Array.isArray(i)&&i[s]===!0)return Vo;var a=s-1,o=s+1,d=t[s],f=a>=0?t[a]:0,_=t[o];if(d===KM&&_===$M)return Vo;if(Ox.indexOf(d)!==-1)return e4;if(Ox.indexOf(_)!==-1||r4.indexOf(_)!==-1)return Vo;if(s4(s,t)===XM)return _1;if(Ux.get(r[s])===Cx||(d===p1||d===g1)&&Ux.get(r[o])===Cx||d===WM||_===WM||d===JM||[ZA,Ex,em].indexOf(d)===-1&&_===JM||[f1,rm,got,Vf,Gf].indexOf(_)!==-1||s4(s,t)===nm||Dx(Ix,nm,s,t)||Dx([f1,rm],Tx,s,t)||Dx(YM,YM,s,t))return Vo;if(d===ZA)return _1;if(d===Ix||_===Ix)return Vo;if(_===Sx||d===Sx)return _1;if([Ex,em,Tx].indexOf(_)!==-1||d===pot||f===Px&&wot.indexOf(d)!==-1||d===Gf&&_===Px||_===ZM||Ju.indexOf(_)!==-1&&d===ja||Ju.indexOf(d)!==-1&&_===ja||d===sm&&[om,p1,g1].indexOf(_)!==-1||[om,p1,g1].indexOf(d)!==-1&&_===im||Ju.indexOf(d)!==-1&&n4.indexOf(_)!==-1||n4.indexOf(d)!==-1&&Ju.indexOf(_)!==-1||[sm,im].indexOf(d)!==-1&&(_===ja||[nm,em].indexOf(_)!==-1&&t[o+1]===ja)||[nm,em].indexOf(d)!==-1&&_===ja||d===ja&&[ja,Gf,Vf].indexOf(_)!==-1)return Vo;if([ja,Gf,Vf,f1,rm].indexOf(_)!==-1)for(var w=s;w>=0;){var x=t[w];if(x===ja)return Vo;if([Gf,Vf].indexOf(x)!==-1)w--;else break}if([sm,im].indexOf(_)!==-1)for(var w=[f1,rm].indexOf(d)!==-1?a:s;w>=0;){var x=t[w];if(x===ja)return Vo;if([Gf,Vf].indexOf(x)!==-1)w--;else break}if(Mx===d&&[Mx,m1,Fx,Lx].indexOf(_)!==-1||[m1,Fx].indexOf(d)!==-1&&[m1,y1].indexOf(_)!==-1||[y1,Lx].indexOf(d)!==-1&&_===y1||i4.indexOf(d)!==-1&&[ZM,im].indexOf(_)!==-1||i4.indexOf(_)!==-1&&d===sm||Ju.indexOf(d)!==-1&&Ju.indexOf(_)!==-1||d===Vf&&Ju.indexOf(_)!==-1||Ju.concat(ja).indexOf(d)!==-1&&_===nm&&vot.indexOf(r[o])===-1||Ju.concat(ja).indexOf(_)!==-1&&d===rm)return Vo;if(d===Rx&&_===Rx){for(var B=e[s],P=1;B>0&&(B--,t[B]===Rx);)P++;if(P%2!==0)return Vo}return d===p1&&_===g1?Vo:_1},Cot=function(r,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var e=xot(r,t.lineBreak),n=e[0],i=e[1],s=e[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(i=i.map(function(o){return[ja,jf,t4].indexOf(o)!==-1?om:o}));var a=t.wordBreak==="keep-all"?s.map(function(o,d){return o&&r[d]>=19968&&r[d]<=40959}):void 0;return[n,i,a]},Eot=function(){function r(t,e,n,i){this.codePoints=t,this.required=e===e4,this.start=n,this.end=i}return r.prototype.slice=function(){return Ki.apply(void 0,this.codePoints.slice(this.start,this.end))},r}(),Sot=function(r,t){var e=u1(r),n=Cot(e,t),i=n[0],s=n[1],a=n[2],o=e.length,d=0,f=0;return{next:function(){if(f>=o)return{done:!0,value:null};for(var _=Vo;f<o&&(_=Bot(e,s,i,++f,a))===Vo;);if(_!==Vo||f===o){var w=new Eot(e,_,d,f);return d=f,{value:w,done:!1}}return{done:!0,value:null}}}},Tot=1,Iot=2,am=4,o4=8,v1=10,a4=47,lm=92,Fot=9,Lot=32,b1=34,cm=61,Pot=35,Mot=36,Rot=37,w1=39,x1=40,um=41,Uot=95,ma=45,Oot=33,Dot=60,Not=62,kot=64,Qot=91,zot=93,Hot=61,Vot=123,B1=63,Got=125,l4=124,jot=126,qot=128,c4=65533,Nx=42,ad=43,Kot=44,$ot=58,Wot=59,Am=46,Xot=0,Jot=8,Yot=11,Zot=14,tat=31,eat=127,Wc=-1,u4=48,A4=97,h4=101,rat=102,nat=117,iat=122,d4=65,f4=69,p4=70,sat=85,oat=90,Go=function(r){return r>=u4&&r<=57},aat=function(r){return r>=55296&&r<=57343},qf=function(r){return Go(r)||r>=d4&&r<=p4||r>=A4&&r<=rat},lat=function(r){return r>=A4&&r<=iat},cat=function(r){return r>=d4&&r<=oat},uat=function(r){return lat(r)||cat(r)},Aat=function(r){return r>=qot},C1=function(r){return r===v1||r===Fot||r===Lot},E1=function(r){return uat(r)||Aat(r)||r===Uot},g4=function(r){return E1(r)||Go(r)||r===ma},hat=function(r){return r>=Xot&&r<=Jot||r===Yot||r>=Zot&&r<=tat||r===eat},th=function(r,t){return r!==lm?!1:t!==v1},S1=function(r,t,e){return r===ma?E1(t)||th(t,e):E1(r)?!0:!!(r===lm&&th(r,t))},kx=function(r,t,e){return r===ad||r===ma?Go(t)?!0:t===Am&&Go(e):Go(r===Am?t:r)},dat=function(r){var t=0,e=1;(r[t]===ad||r[t]===ma)&&(r[t]===ma&&(e=-1),t++);for(var n=[];Go(r[t]);)n.push(r[t++]);var i=n.length?parseInt(Ki.apply(void 0,n),10):0;r[t]===Am&&t++;for(var s=[];Go(r[t]);)s.push(r[t++]);var a=s.length,o=a?parseInt(Ki.apply(void 0,s),10):0;(r[t]===f4||r[t]===h4)&&t++;var d=1;(r[t]===ad||r[t]===ma)&&(r[t]===ma&&(d=-1),t++);for(var f=[];Go(r[t]);)f.push(r[t++]);var _=f.length?parseInt(Ki.apply(void 0,f),10):0;return e*(i+o*Math.pow(10,-a))*Math.pow(10,d*_)},fat={type:2},pat={type:3},gat={type:4},mat={type:13},yat={type:8},_at={type:21},vat={type:9},bat={type:10},wat={type:11},xat={type:12},Bat={type:14},T1={type:23},Cat={type:1},Eat={type:25},Sat={type:24},Tat={type:26},Iat={type:27},Fat={type:28},Lat={type:29},Pat={type:31},Qx={type:32},m4=function(){function r(){this._value=[]}return r.prototype.write=function(t){this._value=this._value.concat(u1(t))},r.prototype.read=function(){for(var t=[],e=this.consumeToken();e!==Qx;)t.push(e),e=this.consumeToken();return t},r.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case b1:return this.consumeStringToken(b1);case Pot:var e=this.peekCodePoint(0),n=this.peekCodePoint(1),i=this.peekCodePoint(2);if(g4(e)||th(n,i)){var s=S1(e,n,i)?Iot:Tot,a=this.consumeName();return{type:5,value:a,flags:s}}break;case Mot:if(this.peekCodePoint(0)===cm)return this.consumeCodePoint(),mat;break;case w1:return this.consumeStringToken(w1);case x1:return fat;case um:return pat;case Nx:if(this.peekCodePoint(0)===cm)return this.consumeCodePoint(),Bat;break;case ad:if(kx(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case Kot:return gat;case ma:var o=t,d=this.peekCodePoint(0),f=this.peekCodePoint(1);if(kx(o,d,f))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(S1(o,d,f))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(d===ma&&f===Not)return this.consumeCodePoint(),this.consumeCodePoint(),Sat;break;case Am:if(kx(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case a4:if(this.peekCodePoint(0)===Nx)for(this.consumeCodePoint();;){var _=this.consumeCodePoint();if(_===Nx&&(_=this.consumeCodePoint(),_===a4))return this.consumeToken();if(_===Wc)return this.consumeToken()}break;case $ot:return Tat;case Wot:return Iat;case Dot:if(this.peekCodePoint(0)===Oot&&this.peekCodePoint(1)===ma&&this.peekCodePoint(2)===ma)return this.consumeCodePoint(),this.consumeCodePoint(),Eat;break;case kot:var w=this.peekCodePoint(0),x=this.peekCodePoint(1),B=this.peekCodePoint(2);if(S1(w,x,B)){var a=this.consumeName();return{type:7,value:a}}break;case Qot:return Fat;case lm:if(th(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case zot:return Lat;case Hot:if(this.peekCodePoint(0)===cm)return this.consumeCodePoint(),yat;break;case Vot:return wat;case Got:return xat;case nat:case sat:var P=this.peekCodePoint(0),R=this.peekCodePoint(1);return P===ad&&(qf(R)||R===B1)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case l4:if(this.peekCodePoint(0)===cm)return this.consumeCodePoint(),vat;if(this.peekCodePoint(0)===l4)return this.consumeCodePoint(),_at;break;case jot:if(this.peekCodePoint(0)===cm)return this.consumeCodePoint(),bat;break;case Wc:return Qx}return C1(t)?(this.consumeWhiteSpace(),Pat):Go(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):E1(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:Ki(t)}},r.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},r.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},r.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},r.prototype.consumeUnicodeRangeToken=function(){for(var t=[],e=this.consumeCodePoint();qf(e)&&t.length<6;)t.push(e),e=this.consumeCodePoint();for(var n=!1;e===B1&&t.length<6;)t.push(e),e=this.consumeCodePoint(),n=!0;if(n){var i=parseInt(Ki.apply(void 0,t.map(function(d){return d===B1?u4:d})),16),s=parseInt(Ki.apply(void 0,t.map(function(d){return d===B1?p4:d})),16);return{type:30,start:i,end:s}}var a=parseInt(Ki.apply(void 0,t),16);if(this.peekCodePoint(0)===ma&&qf(this.peekCodePoint(1))){this.consumeCodePoint(),e=this.consumeCodePoint();for(var o=[];qf(e)&&o.length<6;)o.push(e),e=this.consumeCodePoint();var s=parseInt(Ki.apply(void 0,o),16);return{type:30,start:a,end:s}}else return{type:30,start:a,end:a}},r.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===x1?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===x1?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},r.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Wc)return{type:22,value:""};var e=this.peekCodePoint(0);if(e===w1||e===b1){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Wc||this.peekCodePoint(0)===um)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),T1)}for(;;){var i=this.consumeCodePoint();if(i===Wc||i===um)return{type:22,value:Ki.apply(void 0,t)};if(C1(i))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Wc||this.peekCodePoint(0)===um?(this.consumeCodePoint(),{type:22,value:Ki.apply(void 0,t)}):(this.consumeBadUrlRemnants(),T1);if(i===b1||i===w1||i===x1||hat(i))return this.consumeBadUrlRemnants(),T1;if(i===lm)if(th(i,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),T1;else t.push(i)}},r.prototype.consumeWhiteSpace=function(){for(;C1(this.peekCodePoint(0));)this.consumeCodePoint()},r.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===um||t===Wc)return;th(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},r.prototype.consumeStringSlice=function(t){for(var e=5e4,n="";t>0;){var i=Math.min(e,t);n+=Ki.apply(void 0,this._value.splice(0,i)),t-=i}return this._value.shift(),n},r.prototype.consumeStringToken=function(t){var e="",n=0;do{var i=this._value[n];if(i===Wc||i===void 0||i===t)return e+=this.consumeStringSlice(n),{type:0,value:e};if(i===v1)return this._value.splice(0,n),Cat;if(i===lm){var s=this._value[n+1];s!==Wc&&s!==void 0&&(s===v1?(e+=this.consumeStringSlice(n),n=-1,this._value.shift()):th(i,s)&&(e+=this.consumeStringSlice(n),e+=Ki(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},r.prototype.consumeNumber=function(){var t=[],e=am,n=this.peekCodePoint(0);for((n===ad||n===ma)&&t.push(this.consumeCodePoint());Go(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0);var i=this.peekCodePoint(1);if(n===Am&&Go(i))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),e=o4;Go(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0),i=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((n===f4||n===h4)&&((i===ad||i===ma)&&Go(s)||Go(i)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),e=o4;Go(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[dat(t),e]},r.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),e=t[0],n=t[1],i=this.peekCodePoint(0),s=this.peekCodePoint(1),a=this.peekCodePoint(2);if(S1(i,s,a)){var o=this.consumeName();return{type:15,number:e,flags:n,unit:o}}return i===Rot?(this.consumeCodePoint(),{type:16,number:e,flags:n}):{type:17,number:e,flags:n}},r.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(qf(t)){for(var e=Ki(t);qf(this.peekCodePoint(0))&&e.length<6;)e+=Ki(this.consumeCodePoint());C1(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(e,16);return n===0||aat(n)||n>1114111?c4:n}return t===Wc?c4:t},r.prototype.consumeName=function(){for(var t="";;){var e=this.consumeCodePoint();if(g4(e))t+=Ki(e);else if(th(e,this.peekCodePoint(0)))t+=Ki(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(e),t}},r}(),y4=function(){function r(t){this._tokens=t}return r.create=function(t){var e=new m4;return e.write(t),new r(e.read())},r.parseValue=function(t){return r.create(t).parseComponentValue()},r.parseValues=function(t){return r.create(t).parseComponentValues()},r.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var e=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return e;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},r.prototype.parseComponentValues=function(){for(var t=[];;){var e=this.consumeComponentValue();if(e.type===32)return t;t.push(e),t.push()}},r.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},r.prototype.consumeSimpleBlock=function(t){for(var e={type:t,values:[]},n=this.consumeToken();;){if(n.type===32||Rat(n,t))return e;this.reconsumeToken(n),e.values.push(this.consumeComponentValue()),n=this.consumeToken()}},r.prototype.consumeFunction=function(t){for(var e={name:t.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return e;this.reconsumeToken(n),e.values.push(this.consumeComponentValue())}},r.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?Qx:t},r.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},r}(),hm=function(r){return r.type===15},Kf=function(r){return r.type===17},si=function(r){return r.type===20},Mat=function(r){return r.type===0},zx=function(r,t){return si(r)&&r.value===t},_4=function(r){return r.type!==31},$f=function(r){return r.type!==31&&r.type!==4},Xc=function(r){var t=[],e=[];return r.forEach(function(n){if(n.type===4){if(e.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(e),e=[];return}n.type!==31&&e.push(n)}),e.length&&t.push(e),t},Rat=function(r,t){return t===11&&r.type===12||t===28&&r.type===29?!0:t===2&&r.type===3},eh=function(r){return r.type===17||r.type===15},ss=function(r){return r.type===16||eh(r)},v4=function(r){return r.length>1?[r[0],r[1]]:[r[0]]},Xs={type:17,number:0,flags:am},Hx={type:16,number:50,flags:am},rh={type:16,number:100,flags:am},dm=function(r,t,e){var n=r[0],i=r[1];return[pi(n,t),pi(typeof i<"u"?i:n,e)]},pi=function(r,t){if(r.type===16)return r.number/100*t;if(hm(r))switch(r.unit){case"rem":case"em":return 16*r.number;case"px":default:return r.number}return r.number},b4="deg",w4="grad",x4="rad",B4="turn",I1={name:"angle",parse:function(r,t){if(t.type===15)switch(t.unit){case b4:return Math.PI*t.number/180;case w4:return Math.PI/200*t.number;case x4:return t.number;case B4:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},C4=function(r){return r.type===15&&(r.unit===b4||r.unit===w4||r.unit===x4||r.unit===B4)},E4=function(r){var t=r.filter(si).map(function(e){return e.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Xs,Xs];case"to top":case"bottom":return vl(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Xs,rh];case"to right":case"left":return vl(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[rh,rh];case"to bottom":case"top":return vl(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[rh,Xs];case"to left":case"right":return vl(270)}return 0},vl=function(r){return Math.PI*r/180},nh={name:"color",parse:function(r,t){if(t.type===18){var e=Uat[t.name];if(typeof e>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return e(r,t.values)}if(t.type===5){if(t.value.length===3){var n=t.value.substring(0,1),i=t.value.substring(1,2),s=t.value.substring(2,3);return sh(parseInt(n+n,16),parseInt(i+i,16),parseInt(s+s,16),1)}if(t.value.length===4){var n=t.value.substring(0,1),i=t.value.substring(1,2),s=t.value.substring(2,3),a=t.value.substring(3,4);return sh(parseInt(n+n,16),parseInt(i+i,16),parseInt(s+s,16),parseInt(a+a,16)/255)}if(t.value.length===6){var n=t.value.substring(0,2),i=t.value.substring(2,4),s=t.value.substring(4,6);return sh(parseInt(n,16),parseInt(i,16),parseInt(s,16),1)}if(t.value.length===8){var n=t.value.substring(0,2),i=t.value.substring(2,4),s=t.value.substring(4,6),a=t.value.substring(6,8);return sh(parseInt(n,16),parseInt(i,16),parseInt(s,16),parseInt(a,16)/255)}}if(t.type===20){var o=Yu[t.value.toUpperCase()];if(typeof o<"u")return o}return Yu.TRANSPARENT}},ih=function(r){return(255&r)===0},Ns=function(r){var t=255&r,e=255&r>>8,n=255&r>>16,i=255&r>>24;return t<255?"rgba("+i+","+n+","+e+","+t/255+")":"rgb("+i+","+n+","+e+")"},sh=function(r,t,e,n){return(r<<24|t<<16|e<<8|Math.round(n*255)<<0)>>>0},S4=function(r,t){if(r.type===17)return r.number;if(r.type===16){var e=t===3?1:255;return t===3?r.number/100*e:Math.round(r.number/100*e)}return 0},T4=function(r,t){var e=t.filter($f);if(e.length===3){var n=e.map(S4),i=n[0],s=n[1],a=n[2];return sh(i,s,a,1)}if(e.length===4){var o=e.map(S4),i=o[0],s=o[1],a=o[2],d=o[3];return sh(i,s,a,d)}return 0};function Vx(r,t,e){return e<0&&(e+=1),e>=1&&(e-=1),e<1/6?(t-r)*e*6+r:e<1/2?t:e<2/3?(t-r)*6*(2/3-e)+r:r}var I4=function(r,t){var e=t.filter($f),n=e[0],i=e[1],s=e[2],a=e[3],o=(n.type===17?vl(n.number):I1.parse(r,n))/(Math.PI*2),d=ss(i)?i.number/100:0,f=ss(s)?s.number/100:0,_=typeof a<"u"&&ss(a)?pi(a,1):1;if(d===0)return sh(f*255,f*255,f*255,1);var w=f<=.5?f*(d+1):f+d-f*d,x=f*2-w,B=Vx(x,w,o+1/3),P=Vx(x,w,o),R=Vx(x,w,o-1/3);return sh(B*255,P*255,R*255,_)},Uat={hsl:I4,hsla:I4,rgb:T4,rgba:T4},fm=function(r,t){return nh.parse(r,y4.create(t).parseComponentValue())},Yu={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Oat={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(r,t){return t.map(function(e){if(si(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Dat={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},F1=function(r,t){var e=nh.parse(r,t[0]),n=t[1];return n&&ss(n)?{color:e,stop:n}:{color:e,stop:null}},F4=function(r,t){var e=r[0],n=r[r.length-1];e.stop===null&&(e.stop=Xs),n.stop===null&&(n.stop=rh);for(var i=[],s=0,a=0;a<r.length;a++){var o=r[a].stop;if(o!==null){var d=pi(o,t);d>s?i.push(d):i.push(s),s=d}else i.push(null)}for(var f=null,a=0;a<i.length;a++){var _=i[a];if(_===null)f===null&&(f=a);else if(f!==null){for(var w=a-f,x=i[f-1],B=(_-x)/(w+1),P=1;P<=w;P++)i[f+P-1]=B*P;f=null}}return r.map(function(R,N){var Q=R.color;return{color:Q,stop:Math.max(Math.min(1,i[N]/t),0)}})},Nat=function(r,t,e){var n=t/2,i=e/2,s=pi(r[0],t)-n,a=i-pi(r[1],e);return(Math.atan2(a,s)+Math.PI*2)%(Math.PI*2)},kat=function(r,t,e){var n=typeof r=="number"?r:Nat(r,t,e),i=Math.abs(t*Math.sin(n))+Math.abs(e*Math.cos(n)),s=t/2,a=e/2,o=i/2,d=Math.sin(n-Math.PI/2)*o,f=Math.cos(n-Math.PI/2)*o;return[i,s-f,s+f,a-d,a+d]},ac=function(r,t){return Math.sqrt(r*r+t*t)},L4=function(r,t,e,n,i){var s=[[0,0],[0,t],[r,0],[r,t]];return s.reduce(function(a,o){var d=o[0],f=o[1],_=ac(e-d,n-f);return(i?_<a.optimumDistance:_>a.optimumDistance)?{optimumCorner:o,optimumDistance:_}:a},{optimumDistance:i?1/0:-1/0,optimumCorner:null}).optimumCorner},Qat=function(r,t,e,n,i){var s=0,a=0;switch(r.size){case 0:r.shape===0?s=a=Math.min(Math.abs(t),Math.abs(t-n),Math.abs(e),Math.abs(e-i)):r.shape===1&&(s=Math.min(Math.abs(t),Math.abs(t-n)),a=Math.min(Math.abs(e),Math.abs(e-i)));break;case 2:if(r.shape===0)s=a=Math.min(ac(t,e),ac(t,e-i),ac(t-n,e),ac(t-n,e-i));else if(r.shape===1){var o=Math.min(Math.abs(e),Math.abs(e-i))/Math.min(Math.abs(t),Math.abs(t-n)),d=L4(n,i,t,e,!0),f=d[0],_=d[1];s=ac(f-t,(_-e)/o),a=o*s}break;case 1:r.shape===0?s=a=Math.max(Math.abs(t),Math.abs(t-n),Math.abs(e),Math.abs(e-i)):r.shape===1&&(s=Math.max(Math.abs(t),Math.abs(t-n)),a=Math.max(Math.abs(e),Math.abs(e-i)));break;case 3:if(r.shape===0)s=a=Math.max(ac(t,e),ac(t,e-i),ac(t-n,e),ac(t-n,e-i));else if(r.shape===1){var o=Math.max(Math.abs(e),Math.abs(e-i))/Math.max(Math.abs(t),Math.abs(t-n)),w=L4(n,i,t,e,!1),f=w[0],_=w[1];s=ac(f-t,(_-e)/o),a=o*s}break}return Array.isArray(r.size)&&(s=pi(r.size[0],n),a=r.size.length===2?pi(r.size[1],i):s),[s,a]},zat=function(r,t){var e=vl(180),n=[];return Xc(t).forEach(function(i,s){if(s===0){var a=i[0];if(a.type===20&&a.value==="to"){e=E4(i);return}else if(C4(a)){e=I1.parse(r,a);return}}var o=F1(r,i);n.push(o)}),{angle:e,stops:n,type:1}},L1=function(r,t){var e=vl(180),n=[];return Xc(t).forEach(function(i,s){if(s===0){var a=i[0];if(a.type===20&&["top","left","right","bottom"].indexOf(a.value)!==-1){e=E4(i);return}else if(C4(a)){e=(I1.parse(r,a)+vl(270))%vl(360);return}}var o=F1(r,i);n.push(o)}),{angle:e,stops:n,type:1}},Hat=function(r,t){var e=vl(180),n=[],i=1,s=0,a=3,o=[];return Xc(t).forEach(function(d,f){var _=d[0];if(f===0){if(si(_)&&_.value==="linear"){i=1;return}else if(si(_)&&_.value==="radial"){i=2;return}}if(_.type===18){if(_.name==="from"){var w=nh.parse(r,_.values[0]);n.push({stop:Xs,color:w})}else if(_.name==="to"){var w=nh.parse(r,_.values[0]);n.push({stop:rh,color:w})}else if(_.name==="color-stop"){var x=_.values.filter($f);if(x.length===2){var w=nh.parse(r,x[1]),B=x[0];Kf(B)&&n.push({stop:{type:16,number:B.number*100,flags:B.flags},color:w})}}}}),i===1?{angle:(e+vl(180))%vl(360),stops:n,type:i}:{size:a,shape:s,stops:n,position:o,type:i}},P4="closest-side",M4="farthest-side",R4="closest-corner",U4="farthest-corner",O4="circle",D4="ellipse",N4="cover",k4="contain",Vat=function(r,t){var e=0,n=3,i=[],s=[];return Xc(t).forEach(function(a,o){var d=!0;if(o===0){var f=!1;d=a.reduce(function(w,x){if(f)if(si(x))switch(x.value){case"center":return s.push(Hx),w;case"top":case"left":return s.push(Xs),w;case"right":case"bottom":return s.push(rh),w}else(ss(x)||eh(x))&&s.push(x);else if(si(x))switch(x.value){case O4:return e=0,!1;case D4:return e=1,!1;case"at":return f=!0,!1;case P4:return n=0,!1;case N4:case M4:return n=1,!1;case k4:case R4:return n=2,!1;case U4:return n=3,!1}else if(eh(x)||ss(x))return Array.isArray(n)||(n=[]),n.push(x),!1;return w},d)}if(d){var _=F1(r,a);i.push(_)}}),{size:n,shape:e,stops:i,position:s,type:2}},P1=function(r,t){var e=0,n=3,i=[],s=[];return Xc(t).forEach(function(a,o){var d=!0;if(o===0?d=a.reduce(function(_,w){if(si(w))switch(w.value){case"center":return s.push(Hx),!1;case"top":case"left":return s.push(Xs),!1;case"right":case"bottom":return s.push(rh),!1}else if(ss(w)||eh(w))return s.push(w),!1;return _},d):o===1&&(d=a.reduce(function(_,w){if(si(w))switch(w.value){case O4:return e=0,!1;case D4:return e=1,!1;case k4:case P4:return n=0,!1;case M4:return n=1,!1;case R4:return n=2,!1;case N4:case U4:return n=3,!1}else if(eh(w)||ss(w))return Array.isArray(n)||(n=[]),n.push(w),!1;return _},d)),d){var f=F1(r,a);i.push(f)}}),{size:n,shape:e,stops:i,position:s,type:2}},Gat=function(r){return r.type===1},jat=function(r){return r.type===2},Gx={name:"image",parse:function(r,t){if(t.type===22){var e={url:t.value,type:0};return r.cache.addImage(t.value),e}if(t.type===18){var n=Q4[t.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return n(r,t.values)}throw new Error("Unsupported image type "+t.type)}};function qat(r){return!(r.type===20&&r.value==="none")&&(r.type!==18||!!Q4[r.name])}var Q4={"linear-gradient":zat,"-moz-linear-gradient":L1,"-ms-linear-gradient":L1,"-o-linear-gradient":L1,"-webkit-linear-gradient":L1,"radial-gradient":Vat,"-moz-radial-gradient":P1,"-ms-radial-gradient":P1,"-o-radial-gradient":P1,"-webkit-radial-gradient":P1,"-webkit-gradient":Hat},Kat={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(r,t){if(t.length===0)return[];var e=t[0];return e.type===20&&e.value==="none"?[]:t.filter(function(n){return $f(n)&&qat(n)}).map(function(n){return Gx.parse(r,n)})}},$at={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(r,t){return t.map(function(e){if(si(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Wat={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(r,t){return Xc(t).map(function(e){return e.filter(ss)}).map(v4)}},Xat={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(r,t){return Xc(t).map(function(e){return e.filter(si).map(function(n){return n.value}).join(" ")}).map(Jat)}},Jat=function(r){switch(r){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},Wf;(function(r){r.AUTO="auto",r.CONTAIN="contain",r.COVER="cover"})(Wf||(Wf={}));var Yat={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(r,t){return Xc(t).map(function(e){return e.filter(Zat)})}},Zat=function(r){return si(r)||ss(r)},M1=function(r){return{name:"border-"+r+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},tlt=M1("top"),elt=M1("right"),rlt=M1("bottom"),nlt=M1("left"),R1=function(r){return{name:"border-radius-"+r,initialValue:"0 0",prefix:!1,type:1,parse:function(t,e){return v4(e.filter(ss))}}},ilt=R1("top-left"),slt=R1("top-right"),olt=R1("bottom-right"),alt=R1("bottom-left"),U1=function(r){return{name:"border-"+r+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,e){switch(e){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},llt=U1("top"),clt=U1("right"),ult=U1("bottom"),Alt=U1("left"),O1=function(r){return{name:"border-"+r+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return hm(e)?e.number:0}}},hlt=O1("top"),dlt=O1("right"),flt=O1("bottom"),plt=O1("left"),glt={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},mlt={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(r,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},ylt={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(r,t){return t.filter(si).reduce(function(e,n){return e|_lt(n.value)},0)}},_lt=function(r){switch(r){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},vlt={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(r,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},blt={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(r,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},D1;(function(r){r.NORMAL="normal",r.STRICT="strict"})(D1||(D1={}));var wlt={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(r,t){switch(t){case"strict":return D1.STRICT;case"normal":default:return D1.NORMAL}}},xlt={name:"line-height",initialValue:"normal",prefix:!1,type:4},z4=function(r,t){return si(r)&&r.value==="normal"?1.2*t:r.type===17?t*r.number:ss(r)?pi(r,t):t},Blt={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(r,t){return t.type===20&&t.value==="none"?null:Gx.parse(r,t)}},Clt={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(r,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},jx={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(r,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},N1=function(r){return{name:"margin-"+r,initialValue:"0",prefix:!1,type:4}},Elt=N1("top"),Slt=N1("right"),Tlt=N1("bottom"),Ilt=N1("left"),Flt={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(r,t){return t.filter(si).map(function(e){switch(e.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},Llt={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(r,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},k1=function(r){return{name:"padding-"+r,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Plt=k1("top"),Mlt=k1("right"),Rlt=k1("bottom"),Ult=k1("left"),Olt={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(r,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},Dlt={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(r,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},Nlt={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(r,t){return t.length===1&&zx(t[0],"none")?[]:Xc(t).map(function(e){for(var n={color:Yu.TRANSPARENT,offsetX:Xs,offsetY:Xs,blur:Xs},i=0,s=0;s<e.length;s++){var a=e[s];eh(a)?(i===0?n.offsetX=a:i===1?n.offsetY=a:n.blur=a,i++):n.color=nh.parse(r,a)}return n})}},klt={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(r,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},Qlt={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(r,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var e=Vlt[t.name];if(typeof e>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return e(t.values)}return null}},zlt=function(r){var t=r.filter(function(e){return e.type===17}).map(function(e){return e.number});return t.length===6?t:null},Hlt=function(r){var t=r.filter(function(d){return d.type===17}).map(function(d){return d.number}),e=t[0],n=t[1];t[2],t[3];var i=t[4],s=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var a=t[12],o=t[13];return t[14],t[15],t.length===16?[e,n,i,s,a,o]:null},Vlt={matrix:zlt,matrix3d:Hlt},H4={type:16,number:50,flags:am},Glt=[H4,H4],jlt={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(r,t){var e=t.filter(ss);return e.length!==2?Glt:[e[0],e[1]]}},qlt={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(r,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},pm;(function(r){r.NORMAL="normal",r.BREAK_ALL="break-all",r.KEEP_ALL="keep-all"})(pm||(pm={}));for(var Klt={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(r,t){switch(t){case"break-all":return pm.BREAK_ALL;case"keep-all":return pm.KEEP_ALL;case"normal":default:return pm.NORMAL}}},$lt={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(r,t){if(t.type===20)return{auto:!0,order:0};if(Kf(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},V4={name:"time",parse:function(r,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},Wlt={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(r,t){return Kf(t)?t.number:1}},Xlt={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Jlt={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(r,t){return t.filter(si).map(function(e){switch(e.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(e){return e!==0})}},Ylt={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(r,t){var e=[],n=[];return t.forEach(function(i){switch(i.type){case 20:case 0:e.push(i.value);break;case 17:e.push(i.number.toString());break;case 4:n.push(e.join(" ")),e.length=0;break}}),e.length&&n.push(e.join(" ")),n.map(function(i){return i.indexOf(" ")===-1?i:"'"+i+"'"})}},Zlt={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},tct={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(r,t){if(Kf(t))return t.number;if(si(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},ect={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(r,t){return t.filter(si).map(function(e){return e.value})}},rct={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(r,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},bs=function(r,t){return(r&t)!==0},nct={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(r,t){if(t.length===0)return[];var e=t[0];return e.type===20&&e.value==="none"?[]:t}},ict={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(r,t){if(t.length===0)return null;var e=t[0];if(e.type===20&&e.value==="none")return null;for(var n=[],i=t.filter(_4),s=0;s<i.length;s++){var a=i[s],o=i[s+1];if(a.type===20){var d=o&&Kf(o)?o.number:1;n.push({counter:a.value,increment:d})}}return n}},sct={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(r,t){if(t.length===0)return[];for(var e=[],n=t.filter(_4),i=0;i<n.length;i++){var s=n[i],a=n[i+1];if(si(s)&&s.value!=="none"){var o=a&&Kf(a)?a.number:0;e.push({counter:s.value,reset:o})}}return e}},oct={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(r,t){return t.filter(hm).map(function(e){return V4.parse(r,e)})}},act={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(r,t){if(t.length===0)return null;var e=t[0];if(e.type===20&&e.value==="none")return null;var n=[],i=t.filter(Mat);if(i.length%2!==0)return null;for(var s=0;s<i.length;s+=2){var a=i[s].value,o=i[s+1].value;n.push({open:a,close:o})}return n}},G4=function(r,t,e){if(!r)return"";var n=r[Math.min(t,r.length-1)];return n?e?n.open:n.close:""},lct={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(r,t){return t.length===1&&zx(t[0],"none")?[]:Xc(t).map(function(e){for(var n={color:255,offsetX:Xs,offsetY:Xs,blur:Xs,spread:Xs,inset:!1},i=0,s=0;s<e.length;s++){var a=e[s];zx(a,"inset")?n.inset=!0:eh(a)?(i===0?n.offsetX=a:i===1?n.offsetY=a:i===2?n.blur=a:n.spread=a,i++):n.color=nh.parse(r,a)}return n})}},cct={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(r,t){var e=[0,1,2],n=[];return t.filter(si).forEach(function(i){switch(i.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),e.forEach(function(i){n.indexOf(i)===-1&&n.push(i)}),n}},uct={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},Act={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(r,t){return hm(t)?t.number:0}},hct=function(){function r(t,e){var n,i;this.animationDuration=hr(t,oct,e.animationDuration),this.backgroundClip=hr(t,Oat,e.backgroundClip),this.backgroundColor=hr(t,Dat,e.backgroundColor),this.backgroundImage=hr(t,Kat,e.backgroundImage),this.backgroundOrigin=hr(t,$at,e.backgroundOrigin),this.backgroundPosition=hr(t,Wat,e.backgroundPosition),this.backgroundRepeat=hr(t,Xat,e.backgroundRepeat),this.backgroundSize=hr(t,Yat,e.backgroundSize),this.borderTopColor=hr(t,tlt,e.borderTopColor),this.borderRightColor=hr(t,elt,e.borderRightColor),this.borderBottomColor=hr(t,rlt,e.borderBottomColor),this.borderLeftColor=hr(t,nlt,e.borderLeftColor),this.borderTopLeftRadius=hr(t,ilt,e.borderTopLeftRadius),this.borderTopRightRadius=hr(t,slt,e.borderTopRightRadius),this.borderBottomRightRadius=hr(t,olt,e.borderBottomRightRadius),this.borderBottomLeftRadius=hr(t,alt,e.borderBottomLeftRadius),this.borderTopStyle=hr(t,llt,e.borderTopStyle),this.borderRightStyle=hr(t,clt,e.borderRightStyle),this.borderBottomStyle=hr(t,ult,e.borderBottomStyle),this.borderLeftStyle=hr(t,Alt,e.borderLeftStyle),this.borderTopWidth=hr(t,hlt,e.borderTopWidth),this.borderRightWidth=hr(t,dlt,e.borderRightWidth),this.borderBottomWidth=hr(t,flt,e.borderBottomWidth),this.borderLeftWidth=hr(t,plt,e.borderLeftWidth),this.boxShadow=hr(t,lct,e.boxShadow),this.color=hr(t,glt,e.color),this.direction=hr(t,mlt,e.direction),this.display=hr(t,ylt,e.display),this.float=hr(t,vlt,e.cssFloat),this.fontFamily=hr(t,Ylt,e.fontFamily),this.fontSize=hr(t,Zlt,e.fontSize),this.fontStyle=hr(t,rct,e.fontStyle),this.fontVariant=hr(t,ect,e.fontVariant),this.fontWeight=hr(t,tct,e.fontWeight),this.letterSpacing=hr(t,blt,e.letterSpacing),this.lineBreak=hr(t,wlt,e.lineBreak),this.lineHeight=hr(t,xlt,e.lineHeight),this.listStyleImage=hr(t,Blt,e.listStyleImage),this.listStylePosition=hr(t,Clt,e.listStylePosition),this.listStyleType=hr(t,jx,e.listStyleType),this.marginTop=hr(t,Elt,e.marginTop),this.marginRight=hr(t,Slt,e.marginRight),this.marginBottom=hr(t,Tlt,e.marginBottom),this.marginLeft=hr(t,Ilt,e.marginLeft),this.opacity=hr(t,Wlt,e.opacity);var s=hr(t,Flt,e.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=hr(t,Llt,e.overflowWrap),this.paddingTop=hr(t,Plt,e.paddingTop),this.paddingRight=hr(t,Mlt,e.paddingRight),this.paddingBottom=hr(t,Rlt,e.paddingBottom),this.paddingLeft=hr(t,Ult,e.paddingLeft),this.paintOrder=hr(t,cct,e.paintOrder),this.position=hr(t,Dlt,e.position),this.textAlign=hr(t,Olt,e.textAlign),this.textDecorationColor=hr(t,Xlt,(n=e.textDecorationColor)!==null&&n!==void 0?n:e.color),this.textDecorationLine=hr(t,Jlt,(i=e.textDecorationLine)!==null&&i!==void 0?i:e.textDecoration),this.textShadow=hr(t,Nlt,e.textShadow),this.textTransform=hr(t,klt,e.textTransform),this.transform=hr(t,Qlt,e.transform),this.transformOrigin=hr(t,jlt,e.transformOrigin),this.visibility=hr(t,qlt,e.visibility),this.webkitTextStrokeColor=hr(t,uct,e.webkitTextStrokeColor),this.webkitTextStrokeWidth=hr(t,Act,e.webkitTextStrokeWidth),this.wordBreak=hr(t,Klt,e.wordBreak),this.zIndex=hr(t,$lt,e.zIndex)}return r.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},r.prototype.isTransparent=function(){return ih(this.backgroundColor)},r.prototype.isTransformed=function(){return this.transform!==null},r.prototype.isPositioned=function(){return this.position!==0},r.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},r.prototype.isFloating=function(){return this.float!==0},r.prototype.isInlineLevel=function(){return bs(this.display,4)||bs(this.display,33554432)||bs(this.display,268435456)||bs(this.display,536870912)||bs(this.display,67108864)||bs(this.display,134217728)},r}(),dct=function(){function r(t,e){this.content=hr(t,nct,e.content),this.quotes=hr(t,act,e.quotes)}return r}(),j4=function(){function r(t,e){this.counterIncrement=hr(t,ict,e.counterIncrement),this.counterReset=hr(t,sct,e.counterReset)}return r}(),hr=function(r,t,e){var n=new m4,i=e!==null&&typeof e<"u"?e.toString():t.initialValue;n.write(i);var s=new y4(n.read());switch(t.type){case 2:var a=s.parseComponentValue();return t.parse(r,si(a)?a.value:t.initialValue);case 0:return t.parse(r,s.parseComponentValue());case 1:return t.parse(r,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(t.format){case"angle":return I1.parse(r,s.parseComponentValue());case"color":return nh.parse(r,s.parseComponentValue());case"image":return Gx.parse(r,s.parseComponentValue());case"length":var o=s.parseComponentValue();return eh(o)?o:Xs;case"length-percentage":var d=s.parseComponentValue();return ss(d)?d:Xs;case"time":return V4.parse(r,s.parseComponentValue())}break}},fct="data-html2canvas-debug",pct=function(r){var t=r.getAttribute(fct);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},qx=function(r,t){var e=pct(r);return e===1||t===e},Jc=function(){function r(t,e){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,qx(e,3))debugger;this.styles=new hct(t,window.getComputedStyle(e,null)),sB(e)&&(this.styles.animationDuration.some(function(n){return n>0})&&(e.style.animationDuration="0s"),this.styles.transform!==null&&(e.style.transform="none")),this.bounds=c1(this.context,e),qx(e,4)&&(this.flags|=16)}return r}(),gct="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",q4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",gm=typeof Uint8Array>"u"?[]:new Uint8Array(256),Q1=0;Q1<q4.length;Q1++)gm[q4.charCodeAt(Q1)]=Q1;for(var mct=function(r){var t=r.length*.75,e=r.length,n,i=0,s,a,o,d;r[r.length-1]==="="&&(t--,r[r.length-2]==="="&&t--);var f=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),_=Array.isArray(f)?f:new Uint8Array(f);for(n=0;n<e;n+=4)s=gm[r.charCodeAt(n)],a=gm[r.charCodeAt(n+1)],o=gm[r.charCodeAt(n+2)],d=gm[r.charCodeAt(n+3)],_[i++]=s<<2|a>>4,_[i++]=(a&15)<<4|o>>2,_[i++]=(o&3)<<6|d&63;return f},yct=function(r){for(var t=r.length,e=[],n=0;n<t;n+=2)e.push(r[n+1]<<8|r[n]);return e},_ct=function(r){for(var t=r.length,e=[],n=0;n<t;n+=4)e.push(r[n+3]<<24|r[n+2]<<16|r[n+1]<<8|r[n]);return e},ld=5,Kx=11,$x=2,vct=Kx-ld,K4=65536>>ld,bct=1<<ld,Wx=bct-1,wct=1024>>ld,xct=K4+wct,Bct=xct,Cct=32,Ect=Bct+Cct,Sct=65536>>Kx,Tct=1<<vct,Ict=Tct-1,$4=function(r,t,e){return r.slice?r.slice(t,e):new Uint16Array(Array.prototype.slice.call(r,t,e))},Fct=function(r,t,e){return r.slice?r.slice(t,e):new Uint32Array(Array.prototype.slice.call(r,t,e))},Lct=function(r,t){var e=mct(r),n=Array.isArray(e)?_ct(e):new Uint32Array(e),i=Array.isArray(e)?yct(e):new Uint16Array(e),s=24,a=$4(i,s/2,n[4]/2),o=n[5]===2?$4(i,(s+n[4])/2):Fct(n,Math.ceil((s+n[4])/4));return new Pct(n[0],n[1],n[2],n[3],a,o)},Pct=function(){function r(t,e,n,i,s,a){this.initialValue=t,this.errorValue=e,this.highStart=n,this.highValueIndex=i,this.index=s,this.data=a}return r.prototype.get=function(t){var e;if(t>=0){if(t<55296||t>56319&&t<=65535)return e=this.index[t>>ld],e=(e<<$x)+(t&Wx),this.data[e];if(t<=65535)return e=this.index[K4+(t-55296>>ld)],e=(e<<$x)+(t&Wx),this.data[e];if(t<this.highStart)return e=Ect-Sct+(t>>Kx),e=this.index[e],e+=t>>ld&Ict,e=this.index[e],e=(e<<$x)+(t&Wx),this.data[e];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},r}(),W4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Mct=typeof Uint8Array>"u"?[]:new Uint8Array(256),z1=0;z1<W4.length;z1++)Mct[W4.charCodeAt(z1)]=z1;var Rct=1,Xx=2,Jx=3,X4=4,J4=5,Uct=7,Y4=8,Yx=9,Zx=10,Z4=11,tR=12,eR=13,rR=14,tB=15,Oct=function(r){for(var t=[],e=0,n=r.length;e<n;){var i=r.charCodeAt(e++);if(i>=55296&&i<=56319&&e<n){var s=r.charCodeAt(e++);(s&64512)===56320?t.push(((i&1023)<<10)+(s&1023)+65536):(t.push(i),e--)}else t.push(i)}return t},Dct=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,r);var e=r.length;if(!e)return"";for(var n=[],i=-1,s="";++i<e;){var a=r[i];a<=65535?n.push(a):(a-=65536,n.push((a>>10)+55296,a%1024+56320)),(i+1===e||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},Nct=Lct(gct),cd="",nR="",kct=function(r){return Nct.get(r)},Qct=function(r,t,e){var n=e-2,i=t[n],s=t[e-1],a=t[e];if(s===Xx&&a===Jx)return cd;if(s===Xx||s===Jx||s===X4||a===Xx||a===Jx||a===X4)return nR;if(s===Y4&&[Y4,Yx,Z4,tR].indexOf(a)!==-1||(s===Z4||s===Yx)&&(a===Yx||a===Zx)||(s===tR||s===Zx)&&a===Zx||a===eR||a===J4||a===Uct||s===Rct)return cd;if(s===eR&&a===rR){for(;i===J4;)i=t[--n];if(i===rR)return cd}if(s===tB&&a===tB){for(var o=0;i===tB;)o++,i=t[--n];if(o%2===0)return cd}return nR},zct=function(r){var t=Oct(r),e=t.length,n=0,i=0,s=t.map(kct);return{next:function(){if(n>=e)return{done:!0,value:null};for(var a=cd;n<e&&(a=Qct(t,s,++n))===cd;);if(a!==cd||n===e){var o=Dct.apply(null,t.slice(i,n));return i=n,{value:o,done:!1}}return{done:!0,value:null}}}},Hct=function(r){for(var t=zct(r),e=[],n;!(n=t.next()).done;)n.value&&e.push(n.value.slice());return e},Vct=function(r){var t=123;if(r.createRange){var e=r.createRange();if(e.getBoundingClientRect){var n=r.createElement("boundtest");n.style.height=t+"px",n.style.display="block",r.body.appendChild(n),e.selectNode(n);var i=e.getBoundingClientRect(),s=Math.round(i.height);if(r.body.removeChild(n),s===t)return!0}}return!1},Gct=function(r){var t=r.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",r.body.appendChild(t);var e=r.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=t.firstChild,i=u1(n.data).map(function(d){return Ki(d)}),s=0,a={},o=i.every(function(d,f){e.setStart(n,s),e.setEnd(n,s+d.length);var _=e.getBoundingClientRect();s+=d.length;var w=_.x>a.x||_.y>a.y;return a=_,f===0?!0:w});return r.body.removeChild(t),o},jct=function(){return typeof new Image().crossOrigin<"u"},qct=function(){return typeof new XMLHttpRequest().responseType=="string"},Kct=function(r){var t=new Image,e=r.createElement("canvas"),n=e.getContext("2d");if(!n)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),e.toDataURL()}catch{return!1}return!0},iR=function(r){return r[0]===0&&r[1]===255&&r[2]===0&&r[3]===255},$ct=function(r){var t=r.createElement("canvas"),e=100;t.width=e,t.height=e;var n=t.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,e,e);var i=new Image,s=t.toDataURL();i.src=s;var a=eB(e,e,0,0,i);return n.fillStyle="red",n.fillRect(0,0,e,e),sR(a).then(function(o){n.drawImage(o,0,0);var d=n.getImageData(0,0,e,e).data;n.fillStyle="red",n.fillRect(0,0,e,e);var f=r.createElement("div");return f.style.backgroundImage="url("+s+")",f.style.height=e+"px",iR(d)?sR(eB(e,e,0,0,f)):Promise.reject(!1)}).then(function(o){return n.drawImage(o,0,0),iR(n.getImageData(0,0,e,e).data)}).catch(function(){return!1})},eB=function(r,t,e,n,i){var s="http://www.w3.org/2000/svg",a=document.createElementNS(s,"svg"),o=document.createElementNS(s,"foreignObject");return a.setAttributeNS(null,"width",r.toString()),a.setAttributeNS(null,"height",t.toString()),o.setAttributeNS(null,"width","100%"),o.setAttributeNS(null,"height","100%"),o.setAttributeNS(null,"x",e.toString()),o.setAttributeNS(null,"y",n.toString()),o.setAttributeNS(null,"externalResourcesRequired","true"),a.appendChild(o),o.appendChild(i),a},sR=function(r){return new Promise(function(t,e){var n=new Image;n.onload=function(){return t(n)},n.onerror=e,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(r))})},Js={get SUPPORT_RANGE_BOUNDS(){var r=Vct(document);return Object.defineProperty(Js,"SUPPORT_RANGE_BOUNDS",{value:r}),r},get SUPPORT_WORD_BREAKING(){var r=Js.SUPPORT_RANGE_BOUNDS&&Gct(document);return Object.defineProperty(Js,"SUPPORT_WORD_BREAKING",{value:r}),r},get SUPPORT_SVG_DRAWING(){var r=Kct(document);return Object.defineProperty(Js,"SUPPORT_SVG_DRAWING",{value:r}),r},get SUPPORT_FOREIGNOBJECT_DRAWING(){var r=typeof Array.from=="function"&&typeof window.fetch=="function"?$ct(document):Promise.resolve(!1);return Object.defineProperty(Js,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:r}),r},get SUPPORT_CORS_IMAGES(){var r=jct();return Object.defineProperty(Js,"SUPPORT_CORS_IMAGES",{value:r}),r},get SUPPORT_RESPONSE_TYPE(){var r=qct();return Object.defineProperty(Js,"SUPPORT_RESPONSE_TYPE",{value:r}),r},get SUPPORT_CORS_XHR(){var r="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Js,"SUPPORT_CORS_XHR",{value:r}),r},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var r=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Js,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:r}),r}},mm=function(){function r(t,e){this.text=t,this.bounds=e}return r}(),Wct=function(r,t,e,n){var i=Yct(t,e),s=[],a=0;return i.forEach(function(o){if(e.textDecorationLine.length||o.trim().length>0)if(Js.SUPPORT_RANGE_BOUNDS){var d=oR(n,a,o.length).getClientRects();if(d.length>1){var f=rB(o),_=0;f.forEach(function(x){s.push(new mm(x,Xu.fromDOMRectList(r,oR(n,_+a,x.length).getClientRects()))),_+=x.length})}else s.push(new mm(o,Xu.fromDOMRectList(r,d)))}else{var w=n.splitText(o.length);s.push(new mm(o,Xct(r,n))),n=w}else Js.SUPPORT_RANGE_BOUNDS||(n=n.splitText(o.length));a+=o.length}),s},Xct=function(r,t){var e=t.ownerDocument;if(e){var n=e.createElement("html2canvaswrapper");n.appendChild(t.cloneNode(!0));var i=t.parentNode;if(i){i.replaceChild(n,t);var s=c1(r,n);return n.firstChild&&i.replaceChild(n.firstChild,n),s}}return Xu.EMPTY},oR=function(r,t,e){var n=r.ownerDocument;if(!n)throw new Error("Node has no owner document");var i=n.createRange();return i.setStart(r,t),i.setEnd(r,t+e),i},rB=function(r){if(Js.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(r)).map(function(e){return e.segment})}return Hct(r)},Jct=function(r,t){if(Js.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(e.segment(r)).map(function(n){return n.segment})}return tut(r,t)},Yct=function(r,t){return t.letterSpacing!==0?rB(r):Jct(r,t)},Zct=[32,160,4961,65792,65793,4153,4241],tut=function(r,t){for(var e=Sot(r,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),n=[],i,s=function(){if(i.value){var a=i.value.slice(),o=u1(a),d="";o.forEach(function(f){Zct.indexOf(f)===-1?d+=Ki(f):(d.length&&n.push(d),n.push(Ki(f)),d="")}),d.length&&n.push(d)}};!(i=e.next()).done;)s();return n},eut=function(){function r(t,e,n){this.text=rut(e.data,n.textTransform),this.textBounds=Wct(t,this.text,n,e)}return r}(),rut=function(r,t){switch(t){case 1:return r.toLowerCase();case 3:return r.replace(nut,iut);case 2:return r.toUpperCase();default:return r}},nut=/(^|\s|:|-|\(|\))([a-z])/g,iut=function(r,t,e){return r.length>0?t+e.toUpperCase():r},aR=function(r){oc(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.src=n.currentSrc||n.src,i.intrinsicWidth=n.naturalWidth,i.intrinsicHeight=n.naturalHeight,i.context.cache.addImage(i.src),i}return t}(Jc),lR=function(r){oc(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.canvas=n,i.intrinsicWidth=n.width,i.intrinsicHeight=n.height,i}return t}(Jc),cR=function(r){oc(t,r);function t(e,n){var i=r.call(this,e,n)||this,s=new XMLSerializer,a=c1(e,n);return n.setAttribute("width",a.width+"px"),n.setAttribute("height",a.height+"px"),i.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(n)),i.intrinsicWidth=n.width.baseVal.value,i.intrinsicHeight=n.height.baseVal.value,i.context.cache.addImage(i.svg),i}return t}(Jc),uR=function(r){oc(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.value=n.value,i}return t}(Jc),nB=function(r){oc(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.start=n.start,i.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,i}return t}(Jc),sut=[{type:15,flags:0,unit:"px",number:3}],out=[{type:16,flags:0,number:50}],aut=function(r){return r.width>r.height?new Xu(r.left+(r.width-r.height)/2,r.top,r.height,r.height):r.width<r.height?new Xu(r.left,r.top+(r.height-r.width)/2,r.width,r.width):r},lut=function(r){var t=r.type===cut?new Array(r.value.length+1).join(""):r.value;return t.length===0?r.placeholder||"":t},H1="checkbox",V1="radio",cut="password",AR=707406591,iB=function(r){oc(t,r);function t(e,n){var i=r.call(this,e,n)||this;switch(i.type=n.type.toLowerCase(),i.checked=n.checked,i.value=lut(n),(i.type===H1||i.type===V1)&&(i.styles.backgroundColor=3739148031,i.styles.borderTopColor=i.styles.borderRightColor=i.styles.borderBottomColor=i.styles.borderLeftColor=2779096575,i.styles.borderTopWidth=i.styles.borderRightWidth=i.styles.borderBottomWidth=i.styles.borderLeftWidth=1,i.styles.borderTopStyle=i.styles.borderRightStyle=i.styles.borderBottomStyle=i.styles.borderLeftStyle=1,i.styles.backgroundClip=[0],i.styles.backgroundOrigin=[0],i.bounds=aut(i.bounds)),i.type){case H1:i.styles.borderTopRightRadius=i.styles.borderTopLeftRadius=i.styles.borderBottomRightRadius=i.styles.borderBottomLeftRadius=sut;break;case V1:i.styles.borderTopRightRadius=i.styles.borderTopLeftRadius=i.styles.borderBottomRightRadius=i.styles.borderBottomLeftRadius=out;break}return i}return t}(Jc),hR=function(r){oc(t,r);function t(e,n){var i=r.call(this,e,n)||this,s=n.options[n.selectedIndex||0];return i.value=s&&s.text||"",i}return t}(Jc),dR=function(r){oc(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.value=n.value,i}return t}(Jc),fR=function(r){oc(t,r);function t(e,n){var i=r.call(this,e,n)||this;i.src=n.src,i.width=parseInt(n.width,10)||0,i.height=parseInt(n.height,10)||0,i.backgroundColor=i.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){i.tree=gR(e,n.contentWindow.document.documentElement);var s=n.contentWindow.document.documentElement?fm(e,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):Yu.TRANSPARENT,a=n.contentWindow.document.body?fm(e,getComputedStyle(n.contentWindow.document.body).backgroundColor):Yu.TRANSPARENT;i.backgroundColor=ih(s)?ih(a)?i.styles.backgroundColor:a:s}}catch{}return i}return t}(Jc),uut=["OL","UL","MENU"],G1=function(r,t,e,n){for(var i=t.firstChild,s=void 0;i;i=s)if(s=i.nextSibling,mR(i)&&i.data.trim().length>0)e.textNodes.push(new eut(r,i,e.styles));else if(Xf(i))if(xR(i)&&i.assignedNodes)i.assignedNodes().forEach(function(o){return G1(r,o,e,n)});else{var a=pR(r,i);a.styles.isVisible()&&(Aut(i,a,n)?a.flags|=4:hut(a.styles)&&(a.flags|=2),uut.indexOf(i.tagName)!==-1&&(a.flags|=8),e.elements.push(a),i.slot,i.shadowRoot?G1(r,i.shadowRoot,a,n):!q1(i)&&!yR(i)&&!K1(i)&&G1(r,i,a,n))}},pR=function(r,t){return aB(t)?new aR(r,t):_R(t)?new lR(r,t):yR(t)?new cR(r,t):dut(t)?new uR(r,t):fut(t)?new nB(r,t):put(t)?new iB(r,t):K1(t)?new hR(r,t):q1(t)?new dR(r,t):bR(t)?new fR(r,t):new Jc(r,t)},gR=function(r,t){var e=pR(r,t);return e.flags|=4,G1(r,t,e,e),e},Aut=function(r,t,e){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||oB(r)&&e.styles.isTransparent()},hut=function(r){return r.isPositioned()||r.isFloating()},mR=function(r){return r.nodeType===Node.TEXT_NODE},Xf=function(r){return r.nodeType===Node.ELEMENT_NODE},sB=function(r){return Xf(r)&&typeof r.style<"u"&&!j1(r)},j1=function(r){return typeof r.className=="object"},dut=function(r){return r.tagName==="LI"},fut=function(r){return r.tagName==="OL"},put=function(r){return r.tagName==="INPUT"},gut=function(r){return r.tagName==="HTML"},yR=function(r){return r.tagName==="svg"},oB=function(r){return r.tagName==="BODY"},_R=function(r){return r.tagName==="CANVAS"},vR=function(r){return r.tagName==="VIDEO"},aB=function(r){return r.tagName==="IMG"},bR=function(r){return r.tagName==="IFRAME"},wR=function(r){return r.tagName==="STYLE"},mut=function(r){return r.tagName==="SCRIPT"},q1=function(r){return r.tagName==="TEXTAREA"},K1=function(r){return r.tagName==="SELECT"},xR=function(r){return r.tagName==="SLOT"},BR=function(r){return r.tagName.indexOf("-")>0},yut=function(){function r(){this.counters={}}return r.prototype.getCounterValue=function(t){var e=this.counters[t];return e&&e.length?e[e.length-1]:1},r.prototype.getCounterValues=function(t){var e=this.counters[t];return e||[]},r.prototype.pop=function(t){var e=this;t.forEach(function(n){return e.counters[n].pop()})},r.prototype.parse=function(t){var e=this,n=t.counterIncrement,i=t.counterReset,s=!0;n!==null&&n.forEach(function(o){var d=e.counters[o.counter];d&&o.increment!==0&&(s=!1,d.length||d.push(1),d[Math.max(0,d.length-1)]+=o.increment)});var a=[];return s&&i.forEach(function(o){var d=e.counters[o.counter];a.push(o.counter),d||(d=e.counters[o.counter]=[]),d.push(o.reset)}),a},r}(),CR={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},ER={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},_ut={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},vut={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Jf=function(r,t,e,n,i,s){return r<t||r>e?_m(r,i,s.length>0):n.integers.reduce(function(a,o,d){for(;r>=o;)r-=o,a+=n.values[d];return a},"")+s},SR=function(r,t,e,n){var i="";do e||r--,i=n(r)+i,r/=t;while(r*t>=t);return i},$i=function(r,t,e,n,i){var s=e-t+1;return(r<0?"-":"")+(SR(Math.abs(r),s,n,function(a){return Ki(Math.floor(a%s)+t)})+i)},ud=function(r,t,e){e===void 0&&(e=". ");var n=t.length;return SR(Math.abs(r),n,!1,function(i){return t[Math.floor(i%n)]})+e},Yf=1,oh=2,ah=4,ym=8,Zu=function(r,t,e,n,i,s){if(r<-9999||r>9999)return _m(r,4,i.length>0);var a=Math.abs(r),o=i;if(a===0)return t[0]+o;for(var d=0;a>0&&d<=4;d++){var f=a%10;f===0&&bs(s,Yf)&&o!==""?o=t[f]+o:f>1||f===1&&d===0||f===1&&d===1&&bs(s,oh)||f===1&&d===1&&bs(s,ah)&&r>100||f===1&&d>1&&bs(s,ym)?o=t[f]+(d>0?e[d-1]:"")+o:f===1&&d>0&&(o=e[d-1]+o),a=Math.floor(a/10)}return(r<0?n:"")+o},TR="",IR="",FR="",lB="",_m=function(r,t,e){var n=e?". ":"",i=e?"":"",s=e?", ":"",a=e?" ":"";switch(t){case 0:return""+a;case 1:return""+a;case 2:return""+a;case 5:var o=$i(r,48,57,!0,n);return o.length<4?"0"+o:o;case 4:return ud(r,"",i);case 6:return Jf(r,1,3999,CR,3,n).toLowerCase();case 7:return Jf(r,1,3999,CR,3,n);case 8:return $i(r,945,969,!1,n);case 9:return $i(r,97,122,!1,n);case 10:return $i(r,65,90,!1,n);case 11:return $i(r,1632,1641,!0,n);case 12:case 49:return Jf(r,1,9999,ER,3,n);case 35:return Jf(r,1,9999,ER,3,n).toLowerCase();case 13:return $i(r,2534,2543,!0,n);case 14:case 30:return $i(r,6112,6121,!0,n);case 15:return ud(r,"",i);case 16:return ud(r,"",i);case 17:case 48:return Zu(r,"",TR,"",i,oh|ah|ym);case 47:return Zu(r,"",IR,"",i,Yf|oh|ah|ym);case 42:return Zu(r,"",TR,"",i,oh|ah|ym);case 41:return Zu(r,"",IR,"",i,Yf|oh|ah|ym);case 26:return Zu(r,"","",FR,i,0);case 25:return Zu(r,"","",FR,i,Yf|oh|ah);case 31:return Zu(r,"","",lB,s,Yf|oh|ah);case 33:return Zu(r,"","",lB,s,0);case 32:return Zu(r,"","",lB,s,Yf|oh|ah);case 18:return $i(r,2406,2415,!0,n);case 20:return Jf(r,1,19999,vut,3,n);case 21:return $i(r,2790,2799,!0,n);case 22:return $i(r,2662,2671,!0,n);case 22:return Jf(r,1,10999,_ut,3,n);case 23:return ud(r,"");case 24:return ud(r,"");case 27:return $i(r,3302,3311,!0,n);case 28:return ud(r,"",i);case 29:return ud(r,"",i);case 34:return $i(r,3792,3801,!0,n);case 37:return $i(r,6160,6169,!0,n);case 38:return $i(r,4160,4169,!0,n);case 39:return $i(r,2918,2927,!0,n);case 40:return $i(r,1776,1785,!0,n);case 43:return $i(r,3046,3055,!0,n);case 44:return $i(r,3174,3183,!0,n);case 45:return $i(r,3664,3673,!0,n);case 46:return $i(r,3872,3881,!0,n);case 3:default:return $i(r,48,57,!0,n)}},LR="data-html2canvas-ignore",PR=function(){function r(t,e,n){if(this.context=t,this.options=n,this.scrolledElements=[],this.referenceElement=e,this.counters=new yut,this.quoteDepth=0,!e.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(e.ownerDocument.documentElement,!1)}return r.prototype.toIFrame=function(t,e){var n=this,i=but(t,e);if(!i.contentWindow)return Promise.reject("Unable to find iframe window");var s=t.defaultView.pageXOffset,a=t.defaultView.pageYOffset,o=i.contentWindow,d=o.document,f=But(i).then(function(){return Ho(n,void 0,void 0,function(){var _,w;return wo(this,function(x){switch(x.label){case 0:return this.scrolledElements.forEach(Tut),o&&(o.scrollTo(e.left,e.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(o.scrollY!==e.top||o.scrollX!==e.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(o.scrollX-e.left,o.scrollY-e.top,0,0))),_=this.options.onclone,w=this.clonedReferenceElement,typeof w>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:d.fonts&&d.fonts.ready?[4,d.fonts.ready]:[3,2];case 1:x.sent(),x.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,xut(d)]:[3,4];case 3:x.sent(),x.label=4;case 4:return typeof _=="function"?[2,Promise.resolve().then(function(){return _(d,w)}).then(function(){return i})]:[2,i]}})})});return d.open(),d.write(Eut(document.doctype)+"<html></html>"),Sut(this.referenceElement.ownerDocument,s,a),d.replaceChild(d.adoptNode(this.documentElement),d.documentElement),d.close(),f},r.prototype.createElementClone=function(t){if(qx(t,2))debugger;if(_R(t))return this.createCanvasClone(t);if(vR(t))return this.createVideoClone(t);if(wR(t))return this.createStyleClone(t);var e=t.cloneNode(!1);return aB(e)&&(aB(t)&&t.currentSrc&&t.currentSrc!==t.src&&(e.src=t.currentSrc,e.srcset=""),e.loading==="lazy"&&(e.loading="eager")),BR(e)?this.createCustomElementClone(e):e},r.prototype.createCustomElementClone=function(t){var e=document.createElement("html2canvascustomelement");return cB(t.style,e),e},r.prototype.createStyleClone=function(t){try{var e=t.sheet;if(e&&e.cssRules){var n=[].slice.call(e.cssRules,0).reduce(function(s,a){return a&&typeof a.cssText=="string"?s+a.cssText:s},""),i=t.cloneNode(!1);return i.textContent=n,i}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return t.cloneNode(!1)},r.prototype.createCanvasClone=function(t){var e;if(this.options.inlineImages&&t.ownerDocument){var n=t.ownerDocument.createElement("img");try{return n.src=t.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var i=t.cloneNode(!1);try{i.width=t.width,i.height=t.height;var s=t.getContext("2d"),a=i.getContext("2d");if(a)if(!this.options.allowTaint&&s)a.putImageData(s.getImageData(0,0,t.width,t.height),0,0);else{var o=(e=t.getContext("webgl2"))!==null&&e!==void 0?e:t.getContext("webgl");if(o){var d=o.getContextAttributes();(d==null?void 0:d.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}a.drawImage(t,0,0)}return i}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return i},r.prototype.createVideoClone=function(t){var e=t.ownerDocument.createElement("canvas");e.width=t.offsetWidth,e.height=t.offsetHeight;var n=e.getContext("2d");try{return n&&(n.drawImage(t,0,0,e.width,e.height),this.options.allowTaint||n.getImageData(0,0,e.width,e.height)),e}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var i=t.ownerDocument.createElement("canvas");return i.width=t.offsetWidth,i.height=t.offsetHeight,i},r.prototype.appendChildNode=function(t,e,n){(!Xf(e)||!mut(e)&&!e.hasAttribute(LR)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(e)))&&(!this.options.copyStyles||!Xf(e)||!wR(e))&&t.appendChild(this.cloneNode(e,n))},r.prototype.cloneChildNodes=function(t,e,n){for(var i=this,s=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;s;s=s.nextSibling)if(Xf(s)&&xR(s)&&typeof s.assignedNodes=="function"){var a=s.assignedNodes();a.length&&a.forEach(function(o){return i.appendChildNode(e,o,n)})}else this.appendChildNode(e,s,n)},r.prototype.cloneNode=function(t,e){if(mR(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var n=t.ownerDocument.defaultView;if(n&&Xf(t)&&(sB(t)||j1(t))){var i=this.createElementClone(t);i.style.transitionProperty="none";var s=n.getComputedStyle(t),a=n.getComputedStyle(t,":before"),o=n.getComputedStyle(t,":after");this.referenceElement===t&&sB(i)&&(this.clonedReferenceElement=i),oB(i)&&Lut(i);var d=this.counters.parse(new j4(this.context,s)),f=this.resolvePseudoContent(t,i,a,vm.BEFORE);BR(t)&&(e=!0),vR(t)||this.cloneChildNodes(t,i,e),f&&i.insertBefore(f,i.firstChild);var _=this.resolvePseudoContent(t,i,o,vm.AFTER);return _&&i.appendChild(_),this.counters.pop(d),(s&&(this.options.copyStyles||j1(t))&&!bR(t)||e)&&cB(s,i),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([i,t.scrollLeft,t.scrollTop]),(q1(t)||K1(t))&&(q1(i)||K1(i))&&(i.value=t.value),i}return t.cloneNode(!1)},r.prototype.resolvePseudoContent=function(t,e,n,i){var s=this;if(n){var a=n.content,o=e.ownerDocument;if(!(!o||!a||a==="none"||a==="-moz-alt-content"||n.display==="none")){this.counters.parse(new j4(this.context,n));var d=new dct(this.context,n),f=o.createElement("html2canvaspseudoelement");cB(n,f),d.content.forEach(function(w){if(w.type===0)f.appendChild(o.createTextNode(w.value));else if(w.type===22){var x=o.createElement("img");x.src=w.value,x.style.opacity="1",f.appendChild(x)}else if(w.type===18){if(w.name==="attr"){var B=w.values.filter(si);B.length&&f.appendChild(o.createTextNode(t.getAttribute(B[0].value)||""))}else if(w.name==="counter"){var P=w.values.filter($f),R=P[0],N=P[1];if(R&&si(R)){var Q=s.counters.getCounterValue(R.value),V=N&&si(N)?jx.parse(s.context,N.value):3;f.appendChild(o.createTextNode(_m(Q,V,!1)))}}else if(w.name==="counters"){var W=w.values.filter($f),R=W[0],et=W[1],N=W[2];if(R&&si(R)){var ct=s.counters.getCounterValues(R.value),dt=N&&si(N)?jx.parse(s.context,N.value):3,gt=et&&et.type===0?et.value:"",ht=ct.map(function(ot){return _m(ot,dt,!1)}).join(gt);f.appendChild(o.createTextNode(ht))}}}else if(w.type===20)switch(w.value){case"open-quote":f.appendChild(o.createTextNode(G4(d.quotes,s.quoteDepth++,!0)));break;case"close-quote":f.appendChild(o.createTextNode(G4(d.quotes,--s.quoteDepth,!1)));break;default:f.appendChild(o.createTextNode(w.value))}}),f.className=uB+" "+AB;var _=i===vm.BEFORE?" "+uB:" "+AB;return j1(e)?e.className.baseValue+=_:e.className+=_,f}}},r.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},r}(),vm;(function(r){r[r.BEFORE=0]="BEFORE",r[r.AFTER=1]="AFTER"})(vm||(vm={}));var but=function(r,t){var e=r.createElement("iframe");return e.className="html2canvas-container",e.style.visibility="hidden",e.style.position="fixed",e.style.left="-10000px",e.style.top="0px",e.style.border="0",e.width=t.width.toString(),e.height=t.height.toString(),e.scrolling="no",e.setAttribute(LR,"true"),r.body.appendChild(e),e},wut=function(r){return new Promise(function(t){if(r.complete){t();return}if(!r.src){t();return}r.onload=t,r.onerror=t})},xut=function(r){return Promise.all([].slice.call(r.images,0).map(wut))},But=function(r){return new Promise(function(t,e){var n=r.contentWindow;if(!n)return e("No window assigned for iframe");var i=n.document;n.onload=r.onload=function(){n.onload=r.onload=null;var s=setInterval(function(){i.body.childNodes.length>0&&i.readyState==="complete"&&(clearInterval(s),t(r))},50)}})},Cut=["all","d","content"],cB=function(r,t){for(var e=r.length-1;e>=0;e--){var n=r.item(e);Cut.indexOf(n)===-1&&t.style.setProperty(n,r.getPropertyValue(n))}return t},Eut=function(r){var t="";return r&&(t+="<!DOCTYPE ",r.name&&(t+=r.name),r.internalSubset&&(t+=r.internalSubset),r.publicId&&(t+='"'+r.publicId+'"'),r.systemId&&(t+='"'+r.systemId+'"'),t+=">"),t},Sut=function(r,t,e){r&&r.defaultView&&(t!==r.defaultView.pageXOffset||e!==r.defaultView.pageYOffset)&&r.defaultView.scrollTo(t,e)},Tut=function(r){var t=r[0],e=r[1],n=r[2];t.scrollLeft=e,t.scrollTop=n},Iut=":before",Fut=":after",uB="___html2canvas___pseudoelement_before",AB="___html2canvas___pseudoelement_after",MR=`{
    content: "" !important;
    display: none !important;
}`,Lut=function(r){Put(r,"."+uB+Iut+MR+`
         .`+AB+Fut+MR)},Put=function(r,t){var e=r.ownerDocument;if(e){var n=e.createElement("style");n.textContent=t,r.appendChild(n)}},RR=function(){function r(){}return r.getOrigin=function(t){var e=r._link;return e?(e.href=t,e.href=e.href,e.protocol+e.hostname+e.port):"about:blank"},r.isSameOrigin=function(t){return r.getOrigin(t)===r._origin},r.setContext=function(t){r._link=t.document.createElement("a"),r._origin=r.getOrigin(t.location.href)},r._origin="about:blank",r}(),Mut=function(){function r(t,e){this.context=t,this._options=e,this._cache={}}return r.prototype.addImage=function(t){var e=Promise.resolve();return this.has(t)||(dB(t)||Dut(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),e},r.prototype.match=function(t){return this._cache[t]},r.prototype.loadImage=function(t){return Ho(this,void 0,void 0,function(){var e,n,i,s,a=this;return wo(this,function(o){switch(o.label){case 0:return e=RR.isSameOrigin(t),n=!hB(t)&&this._options.useCORS===!0&&Js.SUPPORT_CORS_IMAGES&&!e,i=!hB(t)&&!e&&!dB(t)&&typeof this._options.proxy=="string"&&Js.SUPPORT_CORS_XHR&&!n,!e&&this._options.allowTaint===!1&&!hB(t)&&!dB(t)&&!i&&!n?[2]:(s=t,i?[4,this.proxy(s)]:[3,2]);case 1:s=o.sent(),o.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(d,f){var _=new Image;_.onload=function(){return d(_)},_.onerror=f,(Nut(s)||n)&&(_.crossOrigin="anonymous"),_.src=s,_.complete===!0&&setTimeout(function(){return d(_)},500),a._options.imageTimeout>0&&setTimeout(function(){return f("Timed out ("+a._options.imageTimeout+"ms) loading image")},a._options.imageTimeout)})];case 3:return[2,o.sent()]}})})},r.prototype.has=function(t){return typeof this._cache[t]<"u"},r.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},r.prototype.proxy=function(t){var e=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var i=t.substring(0,256);return new Promise(function(s,a){var o=Js.SUPPORT_RESPONSE_TYPE?"blob":"text",d=new XMLHttpRequest;d.onload=function(){if(d.status===200)if(o==="text")s(d.response);else{var w=new FileReader;w.addEventListener("load",function(){return s(w.result)},!1),w.addEventListener("error",function(x){return a(x)},!1),w.readAsDataURL(d.response)}else a("Failed to proxy resource "+i+" with status code "+d.status)},d.onerror=a;var f=n.indexOf("?")>-1?"&":"?";if(d.open("GET",""+n+f+"url="+encodeURIComponent(t)+"&responseType="+o),o!=="text"&&d instanceof XMLHttpRequest&&(d.responseType=o),e._options.imageTimeout){var _=e._options.imageTimeout;d.timeout=_,d.ontimeout=function(){return a("Timed out ("+_+"ms) proxying "+i)}}d.send()})},r}(),Rut=/^data:image\/svg\+xml/i,Uut=/^data:image\/.*;base64,/i,Out=/^data:image\/.*/i,Dut=function(r){return Js.SUPPORT_SVG_DRAWING||!kut(r)},hB=function(r){return Out.test(r)},Nut=function(r){return Uut.test(r)},dB=function(r){return r.substr(0,4)==="blob"},kut=function(r){return r.substr(-3).toLowerCase()==="svg"||Rut.test(r)},lr=function(){function r(t,e){this.type=0,this.x=t,this.y=e}return r.prototype.add=function(t,e){return new r(this.x+t,this.y+e)},r}(),Zf=function(r,t,e){return new lr(r.x+(t.x-r.x)*e,r.y+(t.y-r.y)*e)},$1=function(){function r(t,e,n,i){this.type=1,this.start=t,this.startControl=e,this.endControl=n,this.end=i}return r.prototype.subdivide=function(t,e){var n=Zf(this.start,this.startControl,t),i=Zf(this.startControl,this.endControl,t),s=Zf(this.endControl,this.end,t),a=Zf(n,i,t),o=Zf(i,s,t),d=Zf(a,o,t);return e?new r(this.start,n,a,d):new r(d,o,s,this.end)},r.prototype.add=function(t,e){return new r(this.start.add(t,e),this.startControl.add(t,e),this.endControl.add(t,e),this.end.add(t,e))},r.prototype.reverse=function(){return new r(this.end,this.endControl,this.startControl,this.start)},r}(),bl=function(r){return r.type===1},Qut=function(){function r(t){var e=t.styles,n=t.bounds,i=dm(e.borderTopLeftRadius,n.width,n.height),s=i[0],a=i[1],o=dm(e.borderTopRightRadius,n.width,n.height),d=o[0],f=o[1],_=dm(e.borderBottomRightRadius,n.width,n.height),w=_[0],x=_[1],B=dm(e.borderBottomLeftRadius,n.width,n.height),P=B[0],R=B[1],N=[];N.push((s+d)/n.width),N.push((P+w)/n.width),N.push((a+R)/n.height),N.push((f+x)/n.height);var Q=Math.max.apply(Math,N);Q>1&&(s/=Q,a/=Q,d/=Q,f/=Q,w/=Q,x/=Q,P/=Q,R/=Q);var V=n.width-d,W=n.height-x,et=n.width-w,ct=n.height-R,dt=e.borderTopWidth,gt=e.borderRightWidth,ht=e.borderBottomWidth,It=e.borderLeftWidth,St=pi(e.paddingTop,t.bounds.width),ot=pi(e.paddingRight,t.bounds.width),at=pi(e.paddingBottom,t.bounds.width),bt=pi(e.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||a>0?Ei(n.left+It/3,n.top+dt/3,s-It/3,a-dt/3,Gn.TOP_LEFT):new lr(n.left+It/3,n.top+dt/3),this.topRightBorderDoubleOuterBox=s>0||a>0?Ei(n.left+V,n.top+dt/3,d-gt/3,f-dt/3,Gn.TOP_RIGHT):new lr(n.left+n.width-gt/3,n.top+dt/3),this.bottomRightBorderDoubleOuterBox=w>0||x>0?Ei(n.left+et,n.top+W,w-gt/3,x-ht/3,Gn.BOTTOM_RIGHT):new lr(n.left+n.width-gt/3,n.top+n.height-ht/3),this.bottomLeftBorderDoubleOuterBox=P>0||R>0?Ei(n.left+It/3,n.top+ct,P-It/3,R-ht/3,Gn.BOTTOM_LEFT):new lr(n.left+It/3,n.top+n.height-ht/3),this.topLeftBorderDoubleInnerBox=s>0||a>0?Ei(n.left+It*2/3,n.top+dt*2/3,s-It*2/3,a-dt*2/3,Gn.TOP_LEFT):new lr(n.left+It*2/3,n.top+dt*2/3),this.topRightBorderDoubleInnerBox=s>0||a>0?Ei(n.left+V,n.top+dt*2/3,d-gt*2/3,f-dt*2/3,Gn.TOP_RIGHT):new lr(n.left+n.width-gt*2/3,n.top+dt*2/3),this.bottomRightBorderDoubleInnerBox=w>0||x>0?Ei(n.left+et,n.top+W,w-gt*2/3,x-ht*2/3,Gn.BOTTOM_RIGHT):new lr(n.left+n.width-gt*2/3,n.top+n.height-ht*2/3),this.bottomLeftBorderDoubleInnerBox=P>0||R>0?Ei(n.left+It*2/3,n.top+ct,P-It*2/3,R-ht*2/3,Gn.BOTTOM_LEFT):new lr(n.left+It*2/3,n.top+n.height-ht*2/3),this.topLeftBorderStroke=s>0||a>0?Ei(n.left+It/2,n.top+dt/2,s-It/2,a-dt/2,Gn.TOP_LEFT):new lr(n.left+It/2,n.top+dt/2),this.topRightBorderStroke=s>0||a>0?Ei(n.left+V,n.top+dt/2,d-gt/2,f-dt/2,Gn.TOP_RIGHT):new lr(n.left+n.width-gt/2,n.top+dt/2),this.bottomRightBorderStroke=w>0||x>0?Ei(n.left+et,n.top+W,w-gt/2,x-ht/2,Gn.BOTTOM_RIGHT):new lr(n.left+n.width-gt/2,n.top+n.height-ht/2),this.bottomLeftBorderStroke=P>0||R>0?Ei(n.left+It/2,n.top+ct,P-It/2,R-ht/2,Gn.BOTTOM_LEFT):new lr(n.left+It/2,n.top+n.height-ht/2),this.topLeftBorderBox=s>0||a>0?Ei(n.left,n.top,s,a,Gn.TOP_LEFT):new lr(n.left,n.top),this.topRightBorderBox=d>0||f>0?Ei(n.left+V,n.top,d,f,Gn.TOP_RIGHT):new lr(n.left+n.width,n.top),this.bottomRightBorderBox=w>0||x>0?Ei(n.left+et,n.top+W,w,x,Gn.BOTTOM_RIGHT):new lr(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=P>0||R>0?Ei(n.left,n.top+ct,P,R,Gn.BOTTOM_LEFT):new lr(n.left,n.top+n.height),this.topLeftPaddingBox=s>0||a>0?Ei(n.left+It,n.top+dt,Math.max(0,s-It),Math.max(0,a-dt),Gn.TOP_LEFT):new lr(n.left+It,n.top+dt),this.topRightPaddingBox=d>0||f>0?Ei(n.left+Math.min(V,n.width-gt),n.top+dt,V>n.width+gt?0:Math.max(0,d-gt),Math.max(0,f-dt),Gn.TOP_RIGHT):new lr(n.left+n.width-gt,n.top+dt),this.bottomRightPaddingBox=w>0||x>0?Ei(n.left+Math.min(et,n.width-It),n.top+Math.min(W,n.height-ht),Math.max(0,w-gt),Math.max(0,x-ht),Gn.BOTTOM_RIGHT):new lr(n.left+n.width-gt,n.top+n.height-ht),this.bottomLeftPaddingBox=P>0||R>0?Ei(n.left+It,n.top+Math.min(ct,n.height-ht),Math.max(0,P-It),Math.max(0,R-ht),Gn.BOTTOM_LEFT):new lr(n.left+It,n.top+n.height-ht),this.topLeftContentBox=s>0||a>0?Ei(n.left+It+bt,n.top+dt+St,Math.max(0,s-(It+bt)),Math.max(0,a-(dt+St)),Gn.TOP_LEFT):new lr(n.left+It+bt,n.top+dt+St),this.topRightContentBox=d>0||f>0?Ei(n.left+Math.min(V,n.width+It+bt),n.top+dt+St,V>n.width+It+bt?0:d-It+bt,f-(dt+St),Gn.TOP_RIGHT):new lr(n.left+n.width-(gt+ot),n.top+dt+St),this.bottomRightContentBox=w>0||x>0?Ei(n.left+Math.min(et,n.width-(It+bt)),n.top+Math.min(W,n.height+dt+St),Math.max(0,w-(gt+ot)),x-(ht+at),Gn.BOTTOM_RIGHT):new lr(n.left+n.width-(gt+ot),n.top+n.height-(ht+at)),this.bottomLeftContentBox=P>0||R>0?Ei(n.left+It+bt,n.top+ct,Math.max(0,P-(It+bt)),R-(ht+at),Gn.BOTTOM_LEFT):new lr(n.left+It+bt,n.top+n.height-(ht+at))}return r}(),Gn;(function(r){r[r.TOP_LEFT=0]="TOP_LEFT",r[r.TOP_RIGHT=1]="TOP_RIGHT",r[r.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",r[r.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Gn||(Gn={}));var Ei=function(r,t,e,n,i){var s=4*((Math.sqrt(2)-1)/3),a=e*s,o=n*s,d=r+e,f=t+n;switch(i){case Gn.TOP_LEFT:return new $1(new lr(r,f),new lr(r,f-o),new lr(d-a,t),new lr(d,t));case Gn.TOP_RIGHT:return new $1(new lr(r,t),new lr(r+a,t),new lr(d,f-o),new lr(d,f));case Gn.BOTTOM_RIGHT:return new $1(new lr(d,t),new lr(d,t+o),new lr(r+a,f),new lr(r,f));case Gn.BOTTOM_LEFT:default:return new $1(new lr(d,f),new lr(d-a,f),new lr(r,t+o),new lr(r,t))}},W1=function(r){return[r.topLeftBorderBox,r.topRightBorderBox,r.bottomRightBorderBox,r.bottomLeftBorderBox]},zut=function(r){return[r.topLeftContentBox,r.topRightContentBox,r.bottomRightContentBox,r.bottomLeftContentBox]},X1=function(r){return[r.topLeftPaddingBox,r.topRightPaddingBox,r.bottomRightPaddingBox,r.bottomLeftPaddingBox]},Hut=function(){function r(t,e,n){this.offsetX=t,this.offsetY=e,this.matrix=n,this.type=0,this.target=6}return r}(),J1=function(){function r(t,e){this.path=t,this.target=e,this.type=1}return r}(),Vut=function(){function r(t){this.opacity=t,this.type=2,this.target=6}return r}(),Gut=function(r){return r.type===0},UR=function(r){return r.type===1},jut=function(r){return r.type===2},OR=function(r,t){return r.length===t.length?r.some(function(e,n){return e===t[n]}):!1},qut=function(r,t,e,n,i){return r.map(function(s,a){switch(a){case 0:return s.add(t,e);case 1:return s.add(t+n,e);case 2:return s.add(t+n,e+i);case 3:return s.add(t,e+i)}return s})},DR=function(){function r(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return r}(),NR=function(){function r(t,e){if(this.container=t,this.parent=e,this.effects=[],this.curves=new Qut(this.container),this.container.styles.opacity<1&&this.effects.push(new Vut(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,i=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new Hut(n,i,s))}if(this.container.styles.overflowX!==0){var a=W1(this.curves),o=X1(this.curves);OR(a,o)?this.effects.push(new J1(a,6)):(this.effects.push(new J1(a,2)),this.effects.push(new J1(o,4)))}}return r.prototype.getEffects=function(t){for(var e=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,i=this.effects.slice(0);n;){var s=n.effects.filter(function(d){return!UR(d)});if(e||n.container.styles.position!==0||!n.parent){if(i.unshift.apply(i,s),e=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var a=W1(n.curves),o=X1(n.curves);OR(a,o)||i.unshift(new J1(o,6))}}else i.unshift.apply(i,s);n=n.parent}return i.filter(function(d){return bs(d.target,t)})},r}(),fB=function(r,t,e,n){r.container.elements.forEach(function(i){var s=bs(i.flags,4),a=bs(i.flags,2),o=new NR(i,r);bs(i.styles.display,2048)&&n.push(o);var d=bs(i.flags,8)?[]:n;if(s||a){var f=s||i.styles.isPositioned()?e:t,_=new DR(o);if(i.styles.isPositioned()||i.styles.opacity<1||i.styles.isTransformed()){var w=i.styles.zIndex.order;if(w<0){var x=0;f.negativeZIndex.some(function(P,R){return w>P.element.container.styles.zIndex.order?(x=R,!1):x>0}),f.negativeZIndex.splice(x,0,_)}else if(w>0){var B=0;f.positiveZIndex.some(function(P,R){return w>=P.element.container.styles.zIndex.order?(B=R+1,!1):B>0}),f.positiveZIndex.splice(B,0,_)}else f.zeroOrAutoZIndexOrTransformedOrOpacity.push(_)}else i.styles.isFloating()?f.nonPositionedFloats.push(_):f.nonPositionedInlineLevel.push(_);fB(o,_,s?_:e,d)}else i.styles.isInlineLevel()?t.inlineLevel.push(o):t.nonInlineLevel.push(o),fB(o,t,e,d);bs(i.flags,8)&&kR(i,d)})},kR=function(r,t){for(var e=r instanceof nB?r.start:1,n=r instanceof nB?r.reversed:!1,i=0;i<t.length;i++){var s=t[i];s.container instanceof uR&&typeof s.container.value=="number"&&s.container.value!==0&&(e=s.container.value),s.listValue=_m(e,s.container.styles.listStyleType,!0),e+=n?-1:1}},Kut=function(r){var t=new NR(r,null),e=new DR(t),n=[];return fB(t,e,e,n),kR(t.container,n),e},QR=function(r,t){switch(t){case 0:return wl(r.topLeftBorderBox,r.topLeftPaddingBox,r.topRightBorderBox,r.topRightPaddingBox);case 1:return wl(r.topRightBorderBox,r.topRightPaddingBox,r.bottomRightBorderBox,r.bottomRightPaddingBox);case 2:return wl(r.bottomRightBorderBox,r.bottomRightPaddingBox,r.bottomLeftBorderBox,r.bottomLeftPaddingBox);case 3:default:return wl(r.bottomLeftBorderBox,r.bottomLeftPaddingBox,r.topLeftBorderBox,r.topLeftPaddingBox)}},$ut=function(r,t){switch(t){case 0:return wl(r.topLeftBorderBox,r.topLeftBorderDoubleOuterBox,r.topRightBorderBox,r.topRightBorderDoubleOuterBox);case 1:return wl(r.topRightBorderBox,r.topRightBorderDoubleOuterBox,r.bottomRightBorderBox,r.bottomRightBorderDoubleOuterBox);case 2:return wl(r.bottomRightBorderBox,r.bottomRightBorderDoubleOuterBox,r.bottomLeftBorderBox,r.bottomLeftBorderDoubleOuterBox);case 3:default:return wl(r.bottomLeftBorderBox,r.bottomLeftBorderDoubleOuterBox,r.topLeftBorderBox,r.topLeftBorderDoubleOuterBox)}},Wut=function(r,t){switch(t){case 0:return wl(r.topLeftBorderDoubleInnerBox,r.topLeftPaddingBox,r.topRightBorderDoubleInnerBox,r.topRightPaddingBox);case 1:return wl(r.topRightBorderDoubleInnerBox,r.topRightPaddingBox,r.bottomRightBorderDoubleInnerBox,r.bottomRightPaddingBox);case 2:return wl(r.bottomRightBorderDoubleInnerBox,r.bottomRightPaddingBox,r.bottomLeftBorderDoubleInnerBox,r.bottomLeftPaddingBox);case 3:default:return wl(r.bottomLeftBorderDoubleInnerBox,r.bottomLeftPaddingBox,r.topLeftBorderDoubleInnerBox,r.topLeftPaddingBox)}},Xut=function(r,t){switch(t){case 0:return Y1(r.topLeftBorderStroke,r.topRightBorderStroke);case 1:return Y1(r.topRightBorderStroke,r.bottomRightBorderStroke);case 2:return Y1(r.bottomRightBorderStroke,r.bottomLeftBorderStroke);case 3:default:return Y1(r.bottomLeftBorderStroke,r.topLeftBorderStroke)}},Y1=function(r,t){var e=[];return bl(r)?e.push(r.subdivide(.5,!1)):e.push(r),bl(t)?e.push(t.subdivide(.5,!0)):e.push(t),e},wl=function(r,t,e,n){var i=[];return bl(r)?i.push(r.subdivide(.5,!1)):i.push(r),bl(e)?i.push(e.subdivide(.5,!0)):i.push(e),bl(n)?i.push(n.subdivide(.5,!0).reverse()):i.push(n),bl(t)?i.push(t.subdivide(.5,!1).reverse()):i.push(t),i},zR=function(r){var t=r.bounds,e=r.styles;return t.add(e.borderLeftWidth,e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth),-(e.borderTopWidth+e.borderBottomWidth))},Z1=function(r){var t=r.styles,e=r.bounds,n=pi(t.paddingLeft,e.width),i=pi(t.paddingRight,e.width),s=pi(t.paddingTop,e.width),a=pi(t.paddingBottom,e.width);return e.add(n+t.borderLeftWidth,s+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+n+i),-(t.borderTopWidth+t.borderBottomWidth+s+a))},Jut=function(r,t){return r===0?t.bounds:r===2?Z1(t):zR(t)},Yut=function(r,t){return r===0?t.bounds:r===2?Z1(t):zR(t)},pB=function(r,t,e){var n=Jut(ep(r.styles.backgroundOrigin,t),r),i=Yut(ep(r.styles.backgroundClip,t),r),s=Zut(ep(r.styles.backgroundSize,t),e,n),a=s[0],o=s[1],d=dm(ep(r.styles.backgroundPosition,t),n.width-a,n.height-o),f=tAt(ep(r.styles.backgroundRepeat,t),d,s,n,i),_=Math.round(n.left+d[0]),w=Math.round(n.top+d[1]);return[f,_,w,a,o]},tp=function(r){return si(r)&&r.value===Wf.AUTO},t_=function(r){return typeof r=="number"},Zut=function(r,t,e){var n=t[0],i=t[1],s=t[2],a=r[0],o=r[1];if(!a)return[0,0];if(ss(a)&&o&&ss(o))return[pi(a,e.width),pi(o,e.height)];var d=t_(s);if(si(a)&&(a.value===Wf.CONTAIN||a.value===Wf.COVER)){if(t_(s)){var f=e.width/e.height;return f<s!=(a.value===Wf.COVER)?[e.width,e.width/s]:[e.height*s,e.height]}return[e.width,e.height]}var _=t_(n),w=t_(i),x=_||w;if(tp(a)&&(!o||tp(o))){if(_&&w)return[n,i];if(!d&&!x)return[e.width,e.height];if(x&&d){var B=_?n:i*s,P=w?i:n/s;return[B,P]}var R=_?n:e.width,N=w?i:e.height;return[R,N]}if(d){var Q=0,V=0;return ss(a)?Q=pi(a,e.width):ss(o)&&(V=pi(o,e.height)),tp(a)?Q=V*s:(!o||tp(o))&&(V=Q/s),[Q,V]}var W=null,et=null;if(ss(a)?W=pi(a,e.width):o&&ss(o)&&(et=pi(o,e.height)),W!==null&&(!o||tp(o))&&(et=_&&w?W/n*i:e.height),et!==null&&tp(a)&&(W=_&&w?et/i*n:e.width),W!==null&&et!==null)return[W,et];throw new Error("Unable to calculate background-size for element")},ep=function(r,t){var e=r[t];return typeof e>"u"?r[0]:e},tAt=function(r,t,e,n,i){var s=t[0],a=t[1],o=e[0],d=e[1];switch(r){case 2:return[new lr(Math.round(n.left),Math.round(n.top+a)),new lr(Math.round(n.left+n.width),Math.round(n.top+a)),new lr(Math.round(n.left+n.width),Math.round(d+n.top+a)),new lr(Math.round(n.left),Math.round(d+n.top+a))];case 3:return[new lr(Math.round(n.left+s),Math.round(n.top)),new lr(Math.round(n.left+s+o),Math.round(n.top)),new lr(Math.round(n.left+s+o),Math.round(n.height+n.top)),new lr(Math.round(n.left+s),Math.round(n.height+n.top))];case 1:return[new lr(Math.round(n.left+s),Math.round(n.top+a)),new lr(Math.round(n.left+s+o),Math.round(n.top+a)),new lr(Math.round(n.left+s+o),Math.round(n.top+a+d)),new lr(Math.round(n.left+s),Math.round(n.top+a+d))];default:return[new lr(Math.round(i.left),Math.round(i.top)),new lr(Math.round(i.left+i.width),Math.round(i.top)),new lr(Math.round(i.left+i.width),Math.round(i.height+i.top)),new lr(Math.round(i.left),Math.round(i.height+i.top))]}},eAt="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",HR="Hidden Text",rAt=function(){function r(t){this._data={},this._document=t}return r.prototype.parseMetrics=function(t,e){var n=this._document.createElement("div"),i=this._document.createElement("img"),s=this._document.createElement("span"),a=this._document.body;n.style.visibility="hidden",n.style.fontFamily=t,n.style.fontSize=e,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",a.appendChild(n),i.src=eAt,i.width=1,i.height=1,i.style.margin="0",i.style.padding="0",i.style.verticalAlign="baseline",s.style.fontFamily=t,s.style.fontSize=e,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(HR)),n.appendChild(s),n.appendChild(i);var o=i.offsetTop-s.offsetTop+2;n.removeChild(s),n.appendChild(this._document.createTextNode(HR)),n.style.lineHeight="normal",i.style.verticalAlign="super";var d=i.offsetTop-n.offsetTop+2;return a.removeChild(n),{baseline:o,middle:d}},r.prototype.getMetrics=function(t,e){var n=t+" "+e;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(t,e)),this._data[n]},r}(),VR=function(){function r(t,e){this.context=t,this.options=e}return r}(),nAt=1e4,iAt=function(r){oc(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i._activeEffects=[],i.canvas=n.canvas?n.canvas:document.createElement("canvas"),i.ctx=i.canvas.getContext("2d"),n.canvas||(i.canvas.width=Math.floor(n.width*n.scale),i.canvas.height=Math.floor(n.height*n.scale),i.canvas.style.width=n.width+"px",i.canvas.style.height=n.height+"px"),i.fontMetrics=new rAt(document),i.ctx.scale(i.options.scale,i.options.scale),i.ctx.translate(-n.x,-n.y),i.ctx.textBaseline="bottom",i._activeEffects=[],i.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),i}return t.prototype.applyEffects=function(e){for(var n=this;this._activeEffects.length;)this.popEffect();e.forEach(function(i){return n.applyEffect(i)})},t.prototype.applyEffect=function(e){this.ctx.save(),jut(e)&&(this.ctx.globalAlpha=e.opacity),Gut(e)&&(this.ctx.translate(e.offsetX,e.offsetY),this.ctx.transform(e.matrix[0],e.matrix[1],e.matrix[2],e.matrix[3],e.matrix[4],e.matrix[5]),this.ctx.translate(-e.offsetX,-e.offsetY)),UR(e)&&(this.path(e.path),this.ctx.clip()),this._activeEffects.push(e)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(e){return Ho(this,void 0,void 0,function(){var n;return wo(this,function(i){switch(i.label){case 0:return n=e.element.container.styles,n.isVisible()?[4,this.renderStackContent(e)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(e){return Ho(this,void 0,void 0,function(){return wo(this,function(n){switch(n.label){case 0:if(bs(e.container.flags,16))debugger;return e.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(e)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(e)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(e,n,i){var s=this;if(n===0)this.ctx.fillText(e.text,e.bounds.left,e.bounds.top+i);else{var a=rB(e.text);a.reduce(function(o,d){return s.ctx.fillText(d,o,e.bounds.top+i),o+s.ctx.measureText(d).width},e.bounds.left)}},t.prototype.createFontStyle=function(e){var n=e.fontVariant.filter(function(a){return a==="normal"||a==="small-caps"}).join(""),i=cAt(e.fontFamily).join(", "),s=hm(e.fontSize)?""+e.fontSize.number+e.fontSize.unit:e.fontSize.number+"px";return[[e.fontStyle,n,e.fontWeight,s,i].join(" "),i,s]},t.prototype.renderTextNode=function(e,n){return Ho(this,void 0,void 0,function(){var i,s,a,o,d,f,_,w,x=this;return wo(this,function(B){return i=this.createFontStyle(n),s=i[0],a=i[1],o=i[2],this.ctx.font=s,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",d=this.fontMetrics.getMetrics(a,o),f=d.baseline,_=d.middle,w=n.paintOrder,e.textBounds.forEach(function(P){w.forEach(function(R){switch(R){case 0:x.ctx.fillStyle=Ns(n.color),x.renderTextWithLetterSpacing(P,n.letterSpacing,f);var N=n.textShadow;N.length&&P.text.trim().length&&(N.slice(0).reverse().forEach(function(Q){x.ctx.shadowColor=Ns(Q.color),x.ctx.shadowOffsetX=Q.offsetX.number*x.options.scale,x.ctx.shadowOffsetY=Q.offsetY.number*x.options.scale,x.ctx.shadowBlur=Q.blur.number,x.renderTextWithLetterSpacing(P,n.letterSpacing,f)}),x.ctx.shadowColor="",x.ctx.shadowOffsetX=0,x.ctx.shadowOffsetY=0,x.ctx.shadowBlur=0),n.textDecorationLine.length&&(x.ctx.fillStyle=Ns(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(Q){switch(Q){case 1:x.ctx.fillRect(P.bounds.left,Math.round(P.bounds.top+f),P.bounds.width,1);break;case 2:x.ctx.fillRect(P.bounds.left,Math.round(P.bounds.top),P.bounds.width,1);break;case 3:x.ctx.fillRect(P.bounds.left,Math.ceil(P.bounds.top+_),P.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&P.text.trim().length&&(x.ctx.strokeStyle=Ns(n.webkitTextStrokeColor),x.ctx.lineWidth=n.webkitTextStrokeWidth,x.ctx.lineJoin=window.chrome?"miter":"round",x.ctx.strokeText(P.text,P.bounds.left,P.bounds.top+f)),x.ctx.strokeStyle="",x.ctx.lineWidth=0,x.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(e,n,i){if(i&&e.intrinsicWidth>0&&e.intrinsicHeight>0){var s=Z1(e),a=X1(n);this.path(a),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(i,0,0,e.intrinsicWidth,e.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(e){return Ho(this,void 0,void 0,function(){var n,i,s,a,o,d,V,V,f,_,w,x,et,B,P,ct,R,N,Q,V,W,et,ct;return wo(this,function(dt){switch(dt.label){case 0:this.applyEffects(e.getEffects(4)),n=e.container,i=e.curves,s=n.styles,a=0,o=n.textNodes,dt.label=1;case 1:return a<o.length?(d=o[a],[4,this.renderTextNode(d,s)]):[3,4];case 2:dt.sent(),dt.label=3;case 3:return a++,[3,1];case 4:if(!(n instanceof aR))return[3,8];dt.label=5;case 5:return dt.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return V=dt.sent(),this.renderReplacedElement(n,i,V),[3,8];case 7:return dt.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof lR&&this.renderReplacedElement(n,i,n.canvas),!(n instanceof cR))return[3,12];dt.label=9;case 9:return dt.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return V=dt.sent(),this.renderReplacedElement(n,i,V),[3,12];case 11:return dt.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof fR&&n.tree?(f=new t(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,f.render(n.tree)]):[3,14];case 13:_=dt.sent(),n.width&&n.height&&this.ctx.drawImage(_,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),dt.label=14;case 14:if(n instanceof iB&&(w=Math.min(n.bounds.width,n.bounds.height),n.type===H1?n.checked&&(this.ctx.save(),this.path([new lr(n.bounds.left+w*.39363,n.bounds.top+w*.79),new lr(n.bounds.left+w*.16,n.bounds.top+w*.5549),new lr(n.bounds.left+w*.27347,n.bounds.top+w*.44071),new lr(n.bounds.left+w*.39694,n.bounds.top+w*.5649),new lr(n.bounds.left+w*.72983,n.bounds.top+w*.23),new lr(n.bounds.left+w*.84,n.bounds.top+w*.34085),new lr(n.bounds.left+w*.39363,n.bounds.top+w*.79)]),this.ctx.fillStyle=Ns(AR),this.ctx.fill(),this.ctx.restore()):n.type===V1&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+w/2,n.bounds.top+w/2,w/4,0,Math.PI*2,!0),this.ctx.fillStyle=Ns(AR),this.ctx.fill(),this.ctx.restore())),sAt(n)&&n.value.length){switch(x=this.createFontStyle(s),et=x[0],B=x[1],P=this.fontMetrics.getMetrics(et,B).baseline,this.ctx.font=et,this.ctx.fillStyle=Ns(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=aAt(n.styles.textAlign),ct=Z1(n),R=0,n.styles.textAlign){case 1:R+=ct.width/2;break;case 2:R+=ct.width;break}N=ct.add(R,0,0,-ct.height/2+1),this.ctx.save(),this.path([new lr(ct.left,ct.top),new lr(ct.left+ct.width,ct.top),new lr(ct.left+ct.width,ct.top+ct.height),new lr(ct.left,ct.top+ct.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new mm(n.value,N),s.letterSpacing,P),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!bs(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(Q=n.styles.listStyleImage,Q.type!==0)return[3,18];V=void 0,W=Q.url,dt.label=15;case 15:return dt.trys.push([15,17,,18]),[4,this.context.cache.match(W)];case 16:return V=dt.sent(),this.ctx.drawImage(V,n.bounds.left-(V.width+10),n.bounds.top),[3,18];case 17:return dt.sent(),this.context.logger.error("Error loading list-style-image "+W),[3,18];case 18:return[3,20];case 19:e.listValue&&n.styles.listStyleType!==-1&&(et=this.createFontStyle(s)[0],this.ctx.font=et,this.ctx.fillStyle=Ns(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",ct=new Xu(n.bounds.left,n.bounds.top+pi(n.styles.paddingTop,n.bounds.width),n.bounds.width,z4(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new mm(e.listValue,ct),s.letterSpacing,z4(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),dt.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(e){return Ho(this,void 0,void 0,function(){var n,i,Q,s,a,Q,o,d,Q,f,_,Q,w,x,Q,B,P,Q,R,N,Q;return wo(this,function(V){switch(V.label){case 0:if(bs(e.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(e.element)];case 1:V.sent(),n=0,i=e.negativeZIndex,V.label=2;case 2:return n<i.length?(Q=i[n],[4,this.renderStack(Q)]):[3,5];case 3:V.sent(),V.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(e.element)];case 6:V.sent(),s=0,a=e.nonInlineLevel,V.label=7;case 7:return s<a.length?(Q=a[s],[4,this.renderNode(Q)]):[3,10];case 8:V.sent(),V.label=9;case 9:return s++,[3,7];case 10:o=0,d=e.nonPositionedFloats,V.label=11;case 11:return o<d.length?(Q=d[o],[4,this.renderStack(Q)]):[3,14];case 12:V.sent(),V.label=13;case 13:return o++,[3,11];case 14:f=0,_=e.nonPositionedInlineLevel,V.label=15;case 15:return f<_.length?(Q=_[f],[4,this.renderStack(Q)]):[3,18];case 16:V.sent(),V.label=17;case 17:return f++,[3,15];case 18:w=0,x=e.inlineLevel,V.label=19;case 19:return w<x.length?(Q=x[w],[4,this.renderNode(Q)]):[3,22];case 20:V.sent(),V.label=21;case 21:return w++,[3,19];case 22:B=0,P=e.zeroOrAutoZIndexOrTransformedOrOpacity,V.label=23;case 23:return B<P.length?(Q=P[B],[4,this.renderStack(Q)]):[3,26];case 24:V.sent(),V.label=25;case 25:return B++,[3,23];case 26:R=0,N=e.positiveZIndex,V.label=27;case 27:return R<N.length?(Q=N[R],[4,this.renderStack(Q)]):[3,30];case 28:V.sent(),V.label=29;case 29:return R++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(e){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(e.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(e){this.ctx.beginPath(),this.formatPath(e),this.ctx.closePath()},t.prototype.formatPath=function(e){var n=this;e.forEach(function(i,s){var a=bl(i)?i.start:i;s===0?n.ctx.moveTo(a.x,a.y):n.ctx.lineTo(a.x,a.y),bl(i)&&n.ctx.bezierCurveTo(i.startControl.x,i.startControl.y,i.endControl.x,i.endControl.y,i.end.x,i.end.y)})},t.prototype.renderRepeat=function(e,n,i,s){this.path(e),this.ctx.fillStyle=n,this.ctx.translate(i,s),this.ctx.fill(),this.ctx.translate(-i,-s)},t.prototype.resizeImage=function(e,n,i){var s;if(e.width===n&&e.height===i)return e;var a=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,o=a.createElement("canvas");o.width=Math.max(1,n),o.height=Math.max(1,i);var d=o.getContext("2d");return d.drawImage(e,0,0,e.width,e.height,0,0,n,i),o},t.prototype.renderBackgroundImage=function(e){return Ho(this,void 0,void 0,function(){var n,i,s,a,o,d;return wo(this,function(f){switch(f.label){case 0:n=e.styles.backgroundImage.length-1,i=function(_){var w,x,B,St,Wt,Jt,bt,vt,ht,P,St,Wt,Jt,bt,vt,R,N,Q,V,W,et,ct,dt,gt,ht,It,St,ot,at,bt,vt,$t,Wt,Jt,qt,te,Yt,be,it,wt,Ft,Ut;return wo(this,function(jt){switch(jt.label){case 0:if(_.type!==0)return[3,5];w=void 0,x=_.url,jt.label=1;case 1:return jt.trys.push([1,3,,4]),[4,s.context.cache.match(x)];case 2:return w=jt.sent(),[3,4];case 3:return jt.sent(),s.context.logger.error("Error loading background-image "+x),[3,4];case 4:return w&&(B=pB(e,n,[w.width,w.height,w.width/w.height]),St=B[0],Wt=B[1],Jt=B[2],bt=B[3],vt=B[4],ht=s.ctx.createPattern(s.resizeImage(w,bt,vt),"repeat"),s.renderRepeat(St,ht,Wt,Jt)),[3,6];case 5:Gat(_)?(P=pB(e,n,[null,null,null]),St=P[0],Wt=P[1],Jt=P[2],bt=P[3],vt=P[4],R=kat(_.angle,bt,vt),N=R[0],Q=R[1],V=R[2],W=R[3],et=R[4],ct=document.createElement("canvas"),ct.width=bt,ct.height=vt,dt=ct.getContext("2d"),gt=dt.createLinearGradient(Q,W,V,et),F4(_.stops,N).forEach(function(Vt){return gt.addColorStop(Vt.stop,Ns(Vt.color))}),dt.fillStyle=gt,dt.fillRect(0,0,bt,vt),bt>0&&vt>0&&(ht=s.ctx.createPattern(ct,"repeat"),s.renderRepeat(St,ht,Wt,Jt))):jat(_)&&(It=pB(e,n,[null,null,null]),St=It[0],ot=It[1],at=It[2],bt=It[3],vt=It[4],$t=_.position.length===0?[Hx]:_.position,Wt=pi($t[0],bt),Jt=pi($t[$t.length-1],vt),qt=Qat(_,Wt,Jt,bt,vt),te=qt[0],Yt=qt[1],te>0&&Yt>0&&(be=s.ctx.createRadialGradient(ot+Wt,at+Jt,0,ot+Wt,at+Jt,te),F4(_.stops,te*2).forEach(function(Vt){return be.addColorStop(Vt.stop,Ns(Vt.color))}),s.path(St),s.ctx.fillStyle=be,te!==Yt?(it=e.bounds.left+.5*e.bounds.width,wt=e.bounds.top+.5*e.bounds.height,Ft=Yt/te,Ut=1/Ft,s.ctx.save(),s.ctx.translate(it,wt),s.ctx.transform(1,0,0,Ft,0,0),s.ctx.translate(-it,-wt),s.ctx.fillRect(ot,Ut*(at-wt)+wt,bt,vt*Ut),s.ctx.restore()):s.ctx.fill())),jt.label=6;case 6:return n--,[2]}})},s=this,a=0,o=e.styles.backgroundImage.slice(0).reverse(),f.label=1;case 1:return a<o.length?(d=o[a],[5,i(d)]):[3,4];case 2:f.sent(),f.label=3;case 3:return a++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(e,n,i){return Ho(this,void 0,void 0,function(){return wo(this,function(s){return this.path(QR(i,n)),this.ctx.fillStyle=Ns(e),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(e,n,i,s){return Ho(this,void 0,void 0,function(){var a,o;return wo(this,function(d){switch(d.label){case 0:return n<3?[4,this.renderSolidBorder(e,i,s)]:[3,2];case 1:return d.sent(),[2];case 2:return a=$ut(s,i),this.path(a),this.ctx.fillStyle=Ns(e),this.ctx.fill(),o=Wut(s,i),this.path(o),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(e){return Ho(this,void 0,void 0,function(){var n,i,s,a,o,d,f,_,w=this;return wo(this,function(x){switch(x.label){case 0:return this.applyEffects(e.getEffects(2)),n=e.container.styles,i=!ih(n.backgroundColor)||n.backgroundImage.length,s=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],a=oAt(ep(n.backgroundClip,0),e.curves),i||n.boxShadow.length?(this.ctx.save(),this.path(a),this.ctx.clip(),ih(n.backgroundColor)||(this.ctx.fillStyle=Ns(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(e.container)]):[3,2];case 1:x.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(B){w.ctx.save();var P=W1(e.curves),R=B.inset?0:nAt,N=qut(P,-R+(B.inset?1:-1)*B.spread.number,(B.inset?1:-1)*B.spread.number,B.spread.number*(B.inset?-2:2),B.spread.number*(B.inset?-2:2));B.inset?(w.path(P),w.ctx.clip(),w.mask(N)):(w.mask(P),w.ctx.clip(),w.path(N)),w.ctx.shadowOffsetX=B.offsetX.number+R,w.ctx.shadowOffsetY=B.offsetY.number,w.ctx.shadowColor=Ns(B.color),w.ctx.shadowBlur=B.blur.number,w.ctx.fillStyle=B.inset?Ns(B.color):"rgba(0,0,0,1)",w.ctx.fill(),w.ctx.restore()}),x.label=2;case 2:o=0,d=0,f=s,x.label=3;case 3:return d<f.length?(_=f[d],_.style!==0&&!ih(_.color)&&_.width>0?_.style!==2?[3,5]:[4,this.renderDashedDottedBorder(_.color,_.width,o,e.curves,2)]:[3,11]):[3,13];case 4:return x.sent(),[3,11];case 5:return _.style!==3?[3,7]:[4,this.renderDashedDottedBorder(_.color,_.width,o,e.curves,3)];case 6:return x.sent(),[3,11];case 7:return _.style!==4?[3,9]:[4,this.renderDoubleBorder(_.color,_.width,o,e.curves)];case 8:return x.sent(),[3,11];case 9:return[4,this.renderSolidBorder(_.color,o,e.curves)];case 10:x.sent(),x.label=11;case 11:o++,x.label=12;case 12:return d++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(e,n,i,s,a){return Ho(this,void 0,void 0,function(){var o,d,f,_,w,x,B,P,R,N,Q,V,W,et,ct,dt,ct,dt;return wo(this,function(gt){return this.ctx.save(),o=Xut(s,i),d=QR(s,i),a===2&&(this.path(d),this.ctx.clip()),bl(d[0])?(f=d[0].start.x,_=d[0].start.y):(f=d[0].x,_=d[0].y),bl(d[1])?(w=d[1].end.x,x=d[1].end.y):(w=d[1].x,x=d[1].y),i===0||i===2?B=Math.abs(f-w):B=Math.abs(_-x),this.ctx.beginPath(),a===3?this.formatPath(o):this.formatPath(d.slice(0,2)),P=n<3?n*3:n*2,R=n<3?n*2:n,a===3&&(P=n,R=n),N=!0,B<=P*2?N=!1:B<=P*2+R?(Q=B/(2*P+R),P*=Q,R*=Q):(V=Math.floor((B+R)/(P+R)),W=(B-V*P)/(V-1),et=(B-(V+1)*P)/V,R=et<=0||Math.abs(R-W)<Math.abs(R-et)?W:et),N&&(a===3?this.ctx.setLineDash([0,P+R]):this.ctx.setLineDash([P,R])),a===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=Ns(e),this.ctx.stroke(),this.ctx.setLineDash([]),a===2&&(bl(d[0])&&(ct=d[3],dt=d[0],this.ctx.beginPath(),this.formatPath([new lr(ct.end.x,ct.end.y),new lr(dt.start.x,dt.start.y)]),this.ctx.stroke()),bl(d[1])&&(ct=d[1],dt=d[2],this.ctx.beginPath(),this.formatPath([new lr(ct.end.x,ct.end.y),new lr(dt.start.x,dt.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(e){return Ho(this,void 0,void 0,function(){var n;return wo(this,function(i){switch(i.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Ns(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=Kut(e),[4,this.renderStack(n)];case 1:return i.sent(),this.applyEffects([]),[2,this.canvas]}})})},t}(VR),sAt=function(r){return r instanceof dR||r instanceof hR?!0:r instanceof iB&&r.type!==V1&&r.type!==H1},oAt=function(r,t){switch(r){case 0:return W1(t);case 2:return zut(t);case 1:default:return X1(t)}},aAt=function(r){switch(r){case 1:return"center";case 2:return"right";case 0:default:return"left"}},lAt=["-apple-system","system-ui"],cAt=function(r){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?r.filter(function(t){return lAt.indexOf(t)===-1}):r},uAt=function(r){oc(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.canvas=n.canvas?n.canvas:document.createElement("canvas"),i.ctx=i.canvas.getContext("2d"),i.options=n,i.canvas.width=Math.floor(n.width*n.scale),i.canvas.height=Math.floor(n.height*n.scale),i.canvas.style.width=n.width+"px",i.canvas.style.height=n.height+"px",i.ctx.scale(i.options.scale,i.options.scale),i.ctx.translate(-n.x,-n.y),i.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),i}return t.prototype.render=function(e){return Ho(this,void 0,void 0,function(){var n,i;return wo(this,function(s){switch(s.label){case 0:return n=eB(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,e),[4,AAt(n)];case 1:return i=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Ns(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(i,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t}(VR),AAt=function(r){return new Promise(function(t,e){var n=new Image;n.onload=function(){t(n)},n.onerror=e,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(r))})},hAt=function(){function r(t){var e=t.id,n=t.enabled;this.id=e,this.enabled=n,this.start=Date.now()}return r.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,l1([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},r.prototype.getTime=function(){return Date.now()-this.start},r.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,l1([this.id,this.getTime()+"ms"],t))},r.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,l1([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},r.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,l1([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},r.instances={},r}(),dAt=function(){function r(t,e){var n;this.windowBounds=e,this.instanceName="#"+r.instanceCount++,this.logger=new hAt({id:this.instanceName,enabled:t.logging}),this.cache=(n=t.cache)!==null&&n!==void 0?n:new Mut(this,t)}return r.instanceCount=1,r}(),fAt=function(r,t){return t===void 0&&(t={}),pAt(r,t)};typeof window<"u"&&RR.setContext(window);var pAt=function(r,t){return Ho(void 0,void 0,void 0,function(){var e,n,i,s,a,o,d,f,_,w,x,B,P,R,N,Q,V,W,et,ct,gt,dt,gt,ht,It,St,ot,at,bt,vt,$t,Wt,Jt,qt,te,Yt,be,it,wt,Ft;return wo(this,function(Ut){switch(Ut.label){case 0:if(!r||typeof r!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(e=r.ownerDocument,!e)throw new Error("Element is not attached to a Document");if(n=e.defaultView,!n)throw new Error("Document is not attached to a Window");return i={allowTaint:(ht=t.allowTaint)!==null&&ht!==void 0?ht:!1,imageTimeout:(It=t.imageTimeout)!==null&&It!==void 0?It:15e3,proxy:t.proxy,useCORS:(St=t.useCORS)!==null&&St!==void 0?St:!1},s=bx({logging:(ot=t.logging)!==null&&ot!==void 0?ot:!0,cache:t.cache},i),a={windowWidth:(at=t.windowWidth)!==null&&at!==void 0?at:n.innerWidth,windowHeight:(bt=t.windowHeight)!==null&&bt!==void 0?bt:n.innerHeight,scrollX:(vt=t.scrollX)!==null&&vt!==void 0?vt:n.pageXOffset,scrollY:($t=t.scrollY)!==null&&$t!==void 0?$t:n.pageYOffset},o=new Xu(a.scrollX,a.scrollY,a.windowWidth,a.windowHeight),d=new dAt(s,o),f=(Wt=t.foreignObjectRendering)!==null&&Wt!==void 0?Wt:!1,_={allowTaint:(Jt=t.allowTaint)!==null&&Jt!==void 0?Jt:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:f,copyStyles:f},d.logger.debug("Starting document clone with size "+o.width+"x"+o.height+" scrolled to "+-o.left+","+-o.top),w=new PR(d,r,_),x=w.clonedReferenceElement,x?[4,w.toIFrame(e,o)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return B=Ut.sent(),P=oB(x)||gut(x)?qst(x.ownerDocument):c1(d,x),R=P.width,N=P.height,Q=P.left,V=P.top,W=gAt(d,x,t.backgroundColor),et={canvas:t.canvas,backgroundColor:W,scale:(te=(qt=t.scale)!==null&&qt!==void 0?qt:n.devicePixelRatio)!==null&&te!==void 0?te:1,x:((Yt=t.x)!==null&&Yt!==void 0?Yt:0)+Q,y:((be=t.y)!==null&&be!==void 0?be:0)+V,width:(it=t.width)!==null&&it!==void 0?it:Math.ceil(R),height:(wt=t.height)!==null&&wt!==void 0?wt:Math.ceil(N)},f?(d.logger.debug("Document cloned, using foreign object rendering"),gt=new uAt(d,et),[4,gt.render(x)]):[3,3];case 2:return ct=Ut.sent(),[3,5];case 3:return d.logger.debug("Document cloned, element located at "+Q+","+V+" with size "+R+"x"+N+" using computed rendering"),d.logger.debug("Starting DOM parsing"),dt=gR(d,x),W===dt.styles.backgroundColor&&(dt.styles.backgroundColor=Yu.TRANSPARENT),d.logger.debug("Starting renderer for element at "+et.x+","+et.y+" with size "+et.width+"x"+et.height),gt=new iAt(d,et),[4,gt.render(dt)];case 4:ct=Ut.sent(),Ut.label=5;case 5:return(!((Ft=t.removeContainer)!==null&&Ft!==void 0)||Ft)&&(PR.destroy(B)||d.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),d.logger.debug("Finished rendering"),[2,ct]}})})},gAt=function(r,t,e){var n=t.ownerDocument,i=n.documentElement?fm(r,getComputedStyle(n.documentElement).backgroundColor):Yu.TRANSPARENT,s=n.body?fm(r,getComputedStyle(n.body).backgroundColor):Yu.TRANSPARENT,a=typeof e=="string"?fm(r,e):e===null?Yu.TRANSPARENT:4294967295;return t===n.documentElement?ih(i)?ih(s)?a:s:i:a};const mAt=Object.freeze(Object.defineProperty({__proto__:null,default:fAt},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.5.3 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.3/LICENSE */function lh(r){"@babel/helpers - typeof";return lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lh(r)}function gB(r,t){return gB=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},gB(r,t)}function yAt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function e_(r,t,e){return yAt()?e_=Reflect.construct:e_=function(n,i,s){var a=[null];a.push.apply(a,i);var o=Function.bind.apply(n,a),d=new o;return s&&gB(d,s.prototype),d},e_.apply(null,arguments)}function lc(r){return _At(r)||vAt(r)||bAt(r)||wAt()}function _At(r){if(Array.isArray(r))return mB(r)}function vAt(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function bAt(r,t){if(r){if(typeof r=="string")return mB(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return mB(r,t)}}function mB(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function wAt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var xAt=Object.hasOwnProperty,GR=Object.setPrototypeOf,BAt=Object.isFrozen,CAt=Object.getPrototypeOf,EAt=Object.getOwnPropertyDescriptor,jo=Object.freeze,xl=Object.seal,SAt=Object.create,jR=typeof Reflect<"u"&&Reflect,r_=jR.apply,yB=jR.construct;r_||(r_=function(r,t,e){return r.apply(t,e)}),jo||(jo=function(r){return r}),xl||(xl=function(r){return r}),yB||(yB=function(r,t){return e_(r,lc(t))});var TAt=qa(Array.prototype.forEach),qR=qa(Array.prototype.pop),bm=qa(Array.prototype.push),n_=qa(String.prototype.toLowerCase),_B=qa(String.prototype.toString),KR=qa(String.prototype.match),cc=qa(String.prototype.replace),IAt=qa(String.prototype.indexOf),FAt=qa(String.prototype.trim),Ys=qa(RegExp.prototype.test),vB=LAt(TypeError),$R=qa(Number.isNaN);function qa(r){return function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return r_(r,t,n)}}function LAt(r){return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return yB(r,e)}}function pn(r,t,e){var n;e=(n=e)!==null&&n!==void 0?n:n_,GR&&GR(r,null);for(var i=t.length;i--;){var s=t[i];if(typeof s=="string"){var a=e(s);a!==s&&(BAt(t)||(t[i]=a),s=a)}r[s]=!0}return r}function Ad(r){var t=SAt(null),e;for(e in r)r_(xAt,r,[e])===!0&&(t[e]=r[e]);return t}function i_(r,t){for(;r!==null;){var e=EAt(r,t);if(e){if(e.get)return qa(e.get);if(typeof e.value=="function")return qa(e.value)}r=CAt(r)}function n(i){return console.warn("fallback value for",i),null}return n}var WR=jo(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),bB=jo(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),wB=jo(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),PAt=jo(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),xB=jo(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),MAt=jo(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),XR=jo(["#text"]),JR=jo(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),BB=jo(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),YR=jo(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),s_=jo(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),RAt=xl(/\{\{[\w\W]*|[\w\W]*\}\}/gm),UAt=xl(/<%[\w\W]*|[\w\W]*%>/gm),OAt=xl(/\${[\w\W]*}/gm),DAt=xl(/^data-[\-\w.\u00B7-\uFFFF]/),NAt=xl(/^aria-[\-\w]+$/),kAt=xl(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),QAt=xl(/^(?:\w+script|data):/i),zAt=xl(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),HAt=xl(/^html$/i),VAt=xl(/^[a-z][.\w]*(-[.\w]+)+$/i),GAt=function(){return typeof window>"u"?null:window},jAt=function(r,t){if(lh(r)!=="object"||typeof r.createPolicy!="function")return null;var e=null,n="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(n)&&(e=t.currentScript.getAttribute(n));var i="dompurify"+(e?"#"+e:"");try{return r.createPolicy(i,{createHTML:function(s){return s},createScriptURL:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function ZR(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:GAt(),t=function(Mt){return ZR(Mt)};if(t.version="2.5.3",t.removed=[],!r||!r.document||r.document.nodeType!==9)return t.isSupported=!1,t;var e=r.document,n=r.document,i=r.DocumentFragment,s=r.HTMLTemplateElement,a=r.Node,o=r.Element,d=r.NodeFilter,f=r.NamedNodeMap,_=f===void 0?r.NamedNodeMap||r.MozNamedAttrMap:f,w=r.HTMLFormElement,x=r.DOMParser,B=r.trustedTypes,P=o.prototype,R=i_(P,"cloneNode"),N=i_(P,"nextSibling"),Q=i_(P,"childNodes"),V=i_(P,"parentNode");if(typeof s=="function"){var W=n.createElement("template");W.content&&W.content.ownerDocument&&(n=W.content.ownerDocument)}var et=jAt(B,e),ct=et?et.createHTML(""):"",dt=n,gt=dt.implementation,ht=dt.createNodeIterator,It=dt.createDocumentFragment,St=dt.getElementsByTagName,ot=e.importNode,at={};try{at=Ad(n).documentMode?n.documentMode:{}}catch{}var bt={};t.isSupported=typeof V=="function"&&gt&&gt.createHTMLDocument!==void 0&&at!==9;var vt=RAt,$t=UAt,Wt=OAt,Jt=DAt,qt=NAt,te=QAt,Yt=zAt,be=VAt,it=kAt,wt=null,Ft=pn({},[].concat(lc(WR),lc(bB),lc(wB),lc(xB),lc(XR))),Ut=null,jt=pn({},[].concat(lc(JR),lc(BB),lc(YR),lc(s_))),Vt=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),re=null,Zt=null,Be=!0,Ie=!0,ke=!1,He=!0,Ke=!1,le=!0,st=!1,pr=!1,Ye=!1,ue=!1,ye=!1,Le=!1,Oe=!0,We=!1,cr="user-content-",yr=!0,Fr=!1,Ur={},de=null,ur=pn({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),_r=null,De=pn({},["audio","video","img","source","image","track"]),gn=null,pe=pn({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),gr="http://www.w3.org/1998/Math/MathML",Qe="http://www.w3.org/2000/svg",Mr="http://www.w3.org/1999/xhtml",_n=Mr,ze=!1,Nn=null,sn=pn({},[gr,Qe,Mr],_B),vn,cn=["application/xhtml+xml","text/html"],Ct="text/html",X,Z=null,ft=255,Bt=n.createElement("form"),Qt=function(Mt){return Mt instanceof RegExp||Mt instanceof Function},Gt=function(Mt){Z&&Z===Mt||((!Mt||lh(Mt)!=="object")&&(Mt={}),Mt=Ad(Mt),vn=cn.indexOf(Mt.PARSER_MEDIA_TYPE)===-1?vn=Ct:vn=Mt.PARSER_MEDIA_TYPE,X=vn==="application/xhtml+xml"?_B:n_,wt="ALLOWED_TAGS"in Mt?pn({},Mt.ALLOWED_TAGS,X):Ft,Ut="ALLOWED_ATTR"in Mt?pn({},Mt.ALLOWED_ATTR,X):jt,Nn="ALLOWED_NAMESPACES"in Mt?pn({},Mt.ALLOWED_NAMESPACES,_B):sn,gn="ADD_URI_SAFE_ATTR"in Mt?pn(Ad(pe),Mt.ADD_URI_SAFE_ATTR,X):pe,_r="ADD_DATA_URI_TAGS"in Mt?pn(Ad(De),Mt.ADD_DATA_URI_TAGS,X):De,de="FORBID_CONTENTS"in Mt?pn({},Mt.FORBID_CONTENTS,X):ur,re="FORBID_TAGS"in Mt?pn({},Mt.FORBID_TAGS,X):{},Zt="FORBID_ATTR"in Mt?pn({},Mt.FORBID_ATTR,X):{},Ur="USE_PROFILES"in Mt?Mt.USE_PROFILES:!1,Be=Mt.ALLOW_ARIA_ATTR!==!1,Ie=Mt.ALLOW_DATA_ATTR!==!1,ke=Mt.ALLOW_UNKNOWN_PROTOCOLS||!1,He=Mt.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ke=Mt.SAFE_FOR_TEMPLATES||!1,le=Mt.SAFE_FOR_XML!==!1,st=Mt.WHOLE_DOCUMENT||!1,ue=Mt.RETURN_DOM||!1,ye=Mt.RETURN_DOM_FRAGMENT||!1,Le=Mt.RETURN_TRUSTED_TYPE||!1,Ye=Mt.FORCE_BODY||!1,Oe=Mt.SANITIZE_DOM!==!1,We=Mt.SANITIZE_NAMED_PROPS||!1,yr=Mt.KEEP_CONTENT!==!1,Fr=Mt.IN_PLACE||!1,it=Mt.ALLOWED_URI_REGEXP||it,_n=Mt.NAMESPACE||Mr,Vt=Mt.CUSTOM_ELEMENT_HANDLING||{},Mt.CUSTOM_ELEMENT_HANDLING&&Qt(Mt.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Vt.tagNameCheck=Mt.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Mt.CUSTOM_ELEMENT_HANDLING&&Qt(Mt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Vt.attributeNameCheck=Mt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Mt.CUSTOM_ELEMENT_HANDLING&&typeof Mt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Vt.allowCustomizedBuiltInElements=Mt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ke&&(Ie=!1),ye&&(ue=!0),Ur&&(wt=pn({},lc(XR)),Ut=[],Ur.html===!0&&(pn(wt,WR),pn(Ut,JR)),Ur.svg===!0&&(pn(wt,bB),pn(Ut,BB),pn(Ut,s_)),Ur.svgFilters===!0&&(pn(wt,wB),pn(Ut,BB),pn(Ut,s_)),Ur.mathMl===!0&&(pn(wt,xB),pn(Ut,YR),pn(Ut,s_))),Mt.ADD_TAGS&&(wt===Ft&&(wt=Ad(wt)),pn(wt,Mt.ADD_TAGS,X)),Mt.ADD_ATTR&&(Ut===jt&&(Ut=Ad(Ut)),pn(Ut,Mt.ADD_ATTR,X)),Mt.ADD_URI_SAFE_ATTR&&pn(gn,Mt.ADD_URI_SAFE_ATTR,X),Mt.FORBID_CONTENTS&&(de===ur&&(de=Ad(de)),pn(de,Mt.FORBID_CONTENTS,X)),yr&&(wt["#text"]=!0),st&&pn(wt,["html","head","body"]),wt.table&&(pn(wt,["tbody"]),delete re.tbody),jo&&jo(Mt),Z=Mt)},Nt=pn({},["mi","mo","mn","ms","mtext"]),Pt=pn({},["foreignobject","annotation-xml"]),se=pn({},["title","style","font","a","script"]),he=pn({},bB);pn(he,wB),pn(he,PAt);var Xt=pn({},xB);pn(Xt,MAt);var we=function(Mt){var Ne=V(Mt);(!Ne||!Ne.tagName)&&(Ne={namespaceURI:_n,tagName:"template"});var Ee=n_(Mt.tagName),or=n_(Ne.tagName);return Nn[Mt.namespaceURI]?Mt.namespaceURI===Qe?Ne.namespaceURI===Mr?Ee==="svg":Ne.namespaceURI===gr?Ee==="svg"&&(or==="annotation-xml"||Nt[or]):!!he[Ee]:Mt.namespaceURI===gr?Ne.namespaceURI===Mr?Ee==="math":Ne.namespaceURI===Qe?Ee==="math"&&Pt[or]:!!Xt[Ee]:Mt.namespaceURI===Mr?Ne.namespaceURI===Qe&&!Pt[or]||Ne.namespaceURI===gr&&!Nt[or]?!1:!Xt[Ee]&&(se[Ee]||!he[Ee]):!!(vn==="application/xhtml+xml"&&Nn[Mt.namespaceURI]):!1},je=function(Mt){bm(t.removed,{element:Mt});try{Mt.parentNode.removeChild(Mt)}catch{try{Mt.outerHTML=ct}catch{Mt.remove()}}},tr=function(Mt,Ne){try{bm(t.removed,{attribute:Ne.getAttributeNode(Mt),from:Ne})}catch{bm(t.removed,{attribute:null,from:Ne})}if(Ne.removeAttribute(Mt),Mt==="is"&&!Ut[Mt])if(ue||ye)try{je(Ne)}catch{}else try{Ne.setAttribute(Mt,"")}catch{}},Qr=function(Mt){var Ne,Ee;if(Ye)Mt="<remove></remove>"+Mt;else{var or=KR(Mt,/^[\r\n\t ]+/);Ee=or&&or[0]}vn==="application/xhtml+xml"&&_n===Mr&&(Mt='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Mt+"</body></html>");var Lr=et?et.createHTML(Mt):Mt;if(_n===Mr)try{Ne=new x().parseFromString(Lr,vn)}catch{}if(!Ne||!Ne.documentElement){Ne=gt.createDocument(_n,"template",null);try{Ne.documentElement.innerHTML=ze?ct:Lr}catch{}}var Pn=Ne.body||Ne.documentElement;return Mt&&Ee&&Pn.insertBefore(n.createTextNode(Ee),Pn.childNodes[0]||null),_n===Mr?St.call(Ne,st?"html":"body")[0]:st?Ne.documentElement:Pn},ir=function(Mt){return ht.call(Mt.ownerDocument||Mt,Mt,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null,!1)},Or=function(Mt){return Mt instanceof w&&(typeof Mt.__depth<"u"&&typeof Mt.__depth!="number"||typeof Mt.__removalCount<"u"&&typeof Mt.__removalCount!="number"||typeof Mt.nodeName!="string"||typeof Mt.textContent!="string"||typeof Mt.removeChild!="function"||!(Mt.attributes instanceof _)||typeof Mt.removeAttribute!="function"||typeof Mt.setAttribute!="function"||typeof Mt.namespaceURI!="string"||typeof Mt.insertBefore!="function"||typeof Mt.hasChildNodes!="function")},xr=function(Mt){return lh(a)==="object"?Mt instanceof a:Mt&&lh(Mt)==="object"&&typeof Mt.nodeType=="number"&&typeof Mt.nodeName=="string"},$r=function(Mt,Ne,Ee){bt[Mt]&&TAt(bt[Mt],function(or){or.call(t,Ne,Ee,Z)})},Xr=function(Mt){var Ne;if($r("beforeSanitizeElements",Mt,null),Or(Mt)||Ys(/[\u0080-\uFFFF]/,Mt.nodeName))return je(Mt),!0;var Ee=X(Mt.nodeName);if($r("uponSanitizeElement",Mt,{tagName:Ee,allowedTags:wt}),Mt.hasChildNodes()&&!xr(Mt.firstElementChild)&&(!xr(Mt.content)||!xr(Mt.content.firstElementChild))&&Ys(/<[/\w]/g,Mt.innerHTML)&&Ys(/<[/\w]/g,Mt.textContent)||Ee==="select"&&Ys(/<template/i,Mt.innerHTML)||Mt.nodeType===7||le&&Mt.nodeType===8&&Ys(/<[/\w]/g,Mt.data))return je(Mt),!0;if(!wt[Ee]||re[Ee]){if(!re[Ee]&&jr(Ee)&&(Vt.tagNameCheck instanceof RegExp&&Ys(Vt.tagNameCheck,Ee)||Vt.tagNameCheck instanceof Function&&Vt.tagNameCheck(Ee)))return!1;if(yr&&!de[Ee]){var or=V(Mt)||Mt.parentNode,Lr=Q(Mt)||Mt.childNodes;if(Lr&&or)for(var Pn=Lr.length,qr=Pn-1;qr>=0;--qr){var yn=R(Lr[qr],!0);yn.__removalCount=(Mt.__removalCount||0)+1,or.insertBefore(yn,N(Mt))}}return je(Mt),!0}return Mt instanceof o&&!we(Mt)||(Ee==="noscript"||Ee==="noembed"||Ee==="noframes")&&Ys(/<\/no(script|embed|frames)/i,Mt.innerHTML)?(je(Mt),!0):(Ke&&Mt.nodeType===3&&(Ne=Mt.textContent,Ne=cc(Ne,vt," "),Ne=cc(Ne,$t," "),Ne=cc(Ne,Wt," "),Mt.textContent!==Ne&&(bm(t.removed,{element:Mt.cloneNode()}),Mt.textContent=Ne)),$r("afterSanitizeElements",Mt,null),!1)},vr=function(Mt,Ne,Ee){if(Oe&&(Ne==="id"||Ne==="name")&&(Ee in n||Ee in Bt||Ee==="__depth"||Ee==="__removalCount"))return!1;if(!(Ie&&!Zt[Ne]&&Ys(Jt,Ne))&&!(Be&&Ys(qt,Ne))){if(!Ut[Ne]||Zt[Ne]){if(!(jr(Mt)&&(Vt.tagNameCheck instanceof RegExp&&Ys(Vt.tagNameCheck,Mt)||Vt.tagNameCheck instanceof Function&&Vt.tagNameCheck(Mt))&&(Vt.attributeNameCheck instanceof RegExp&&Ys(Vt.attributeNameCheck,Ne)||Vt.attributeNameCheck instanceof Function&&Vt.attributeNameCheck(Ne))||Ne==="is"&&Vt.allowCustomizedBuiltInElements&&(Vt.tagNameCheck instanceof RegExp&&Ys(Vt.tagNameCheck,Ee)||Vt.tagNameCheck instanceof Function&&Vt.tagNameCheck(Ee))))return!1}else if(!gn[Ne]&&!Ys(it,cc(Ee,Yt,""))&&!((Ne==="src"||Ne==="xlink:href"||Ne==="href")&&Mt!=="script"&&IAt(Ee,"data:")===0&&_r[Mt])&&!(ke&&!Ys(te,cc(Ee,Yt,"")))&&Ee)return!1}return!0},jr=function(Mt){return Mt!=="annotation-xml"&&KR(Mt,be)},on=function(Mt){var Ne,Ee,or,Lr;$r("beforeSanitizeAttributes",Mt,null);var Pn=Mt.attributes;if(Pn){var qr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ut};for(Lr=Pn.length;Lr--;){Ne=Pn[Lr];var yn=Ne,mi=yn.name,bn=yn.namespaceURI;if(Ee=mi==="value"?Ne.value:FAt(Ne.value),or=X(mi),qr.attrName=or,qr.attrValue=Ee,qr.keepAttr=!0,qr.forceKeepAttr=void 0,$r("uponSanitizeAttribute",Mt,qr),Ee=qr.attrValue,!qr.forceKeepAttr&&(tr(mi,Mt),!!qr.keepAttr)){if(!He&&Ys(/\/>/i,Ee)){tr(mi,Mt);continue}if(le&&Ys(/((--!?|])>)|<\/(style|title)/i,Ee)){tr(mi,Mt);continue}Ke&&(Ee=cc(Ee,vt," "),Ee=cc(Ee,$t," "),Ee=cc(Ee,Wt," "));var tn=X(Mt.nodeName);if(vr(tn,or,Ee)){if(We&&(or==="id"||or==="name")&&(tr(mi,Mt),Ee=cr+Ee),et&&lh(B)==="object"&&typeof B.getAttributeType=="function"&&!bn)switch(B.getAttributeType(tn,or)){case"TrustedHTML":{Ee=et.createHTML(Ee);break}case"TrustedScriptURL":{Ee=et.createScriptURL(Ee);break}}try{bn?Mt.setAttributeNS(bn,mi,Ee):Mt.setAttribute(mi,Ee),Or(Mt)?je(Mt):qR(t.removed)}catch{}}}}$r("afterSanitizeAttributes",Mt,null)}},In=function Mt(Ne){var Ee,or=ir(Ne);for($r("beforeSanitizeShadowDOM",Ne,null);Ee=or.nextNode();)if($r("uponSanitizeShadowNode",Ee,null),!Xr(Ee)){var Lr=V(Ee);Ee.nodeType===1&&(Lr&&Lr.__depth?Ee.__depth=(Ee.__removalCount||0)+Lr.__depth+1:Ee.__depth=1),(Ee.__depth>=ft||$R(Ee.__depth))&&je(Ee),Ee.content instanceof i&&(Ee.content.__depth=Ee.__depth,Mt(Ee.content)),on(Ee)}$r("afterSanitizeShadowDOM",Ne,null)};return t.sanitize=function(Mt){var Ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ee,or,Lr,Pn,qr;if(ze=!Mt,ze&&(Mt="<!-->"),typeof Mt!="string"&&!xr(Mt))if(typeof Mt.toString=="function"){if(Mt=Mt.toString(),typeof Mt!="string")throw vB("dirty is not a string, aborting")}else throw vB("toString is not a function");if(!t.isSupported){if(lh(r.toStaticHTML)==="object"||typeof r.toStaticHTML=="function"){if(typeof Mt=="string")return r.toStaticHTML(Mt);if(xr(Mt))return r.toStaticHTML(Mt.outerHTML)}return Mt}if(pr||Gt(Ne),t.removed=[],typeof Mt=="string"&&(Fr=!1),Fr){if(Mt.nodeName){var yn=X(Mt.nodeName);if(!wt[yn]||re[yn])throw vB("root node is forbidden and cannot be sanitized in-place")}}else if(Mt instanceof a)Ee=Qr("<!---->"),or=Ee.ownerDocument.importNode(Mt,!0),or.nodeType===1&&or.nodeName==="BODY"||or.nodeName==="HTML"?Ee=or:Ee.appendChild(or);else{if(!ue&&!Ke&&!st&&Mt.indexOf("<")===-1)return et&&Le?et.createHTML(Mt):Mt;if(Ee=Qr(Mt),!Ee)return ue?null:Le?ct:""}Ee&&Ye&&je(Ee.firstChild);for(var mi=ir(Fr?Mt:Ee);Lr=mi.nextNode();)if(!(Lr.nodeType===3&&Lr===Pn)&&!Xr(Lr)){var bn=V(Lr);Lr.nodeType===1&&(bn&&bn.__depth?Lr.__depth=(Lr.__removalCount||0)+bn.__depth+1:Lr.__depth=1),(Lr.__depth>=ft||$R(Lr.__depth))&&je(Lr),Lr.content instanceof i&&(Lr.content.__depth=Lr.__depth,In(Lr.content)),on(Lr),Pn=Lr}if(Pn=null,Fr)return Mt;if(ue){if(ye)for(qr=It.call(Ee.ownerDocument);Ee.firstChild;)qr.appendChild(Ee.firstChild);else qr=Ee;return(Ut.shadowroot||Ut.shadowrootmod)&&(qr=ot.call(e,qr,!0)),qr}var tn=st?Ee.outerHTML:Ee.innerHTML;return st&&wt["!doctype"]&&Ee.ownerDocument&&Ee.ownerDocument.doctype&&Ee.ownerDocument.doctype.name&&Ys(HAt,Ee.ownerDocument.doctype.name)&&(tn="<!DOCTYPE "+Ee.ownerDocument.doctype.name+`>
`+tn),Ke&&(tn=cc(tn,vt," "),tn=cc(tn,$t," "),tn=cc(tn,Wt," ")),et&&Le?et.createHTML(tn):tn},t.setConfig=function(Mt){Gt(Mt),pr=!0},t.clearConfig=function(){Z=null,pr=!1},t.isValidAttribute=function(Mt,Ne,Ee){Z||Gt({});var or=X(Mt),Lr=X(Ne);return vr(or,Lr,Ee)},t.addHook=function(Mt,Ne){typeof Ne=="function"&&(bt[Mt]=bt[Mt]||[],bm(bt[Mt],Ne))},t.removeHook=function(Mt){if(bt[Mt])return qR(bt[Mt])},t.removeHooks=function(Mt){bt[Mt]&&(bt[Mt]=[])},t.removeAllHooks=function(){bt={}},t}var qAt=ZR();const KAt=Object.freeze(Object.defineProperty({__proto__:null,default:qAt},Symbol.toStringTag,{value:"Module"}));var rp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tU(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var wm=function(r){return r&&r.Math===Math&&r},Wi=wm(typeof globalThis=="object"&&globalThis)||wm(typeof window=="object"&&window)||wm(typeof self=="object"&&self)||wm(typeof rp=="object"&&rp)||wm(typeof rp=="object"&&rp)||function(){return this}()||Function("return this")(),xm={},Xi=function(r){try{return!!r()}catch{return!0}},$At=Xi,uc=!$At(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),WAt=Xi,o_=!WAt(function(){var r=(function(){}).bind();return typeof r!="function"||r.hasOwnProperty("prototype")}),XAt=o_,a_=Function.prototype.call,Zs=XAt?a_.bind(a_):function(){return a_.apply(a_,arguments)},eU={},rU={}.propertyIsEnumerable,nU=Object.getOwnPropertyDescriptor,JAt=nU&&!rU.call({1:2},1);eU.f=JAt?function(r){var t=nU(this,r);return!!t&&t.enumerable}:rU;var CB=function(r,t){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:t}},iU=o_,sU=Function.prototype,EB=sU.call,YAt=iU&&sU.bind.bind(EB,EB),Ji=iU?YAt:function(r){return function(){return EB.apply(r,arguments)}},oU=Ji,ZAt=oU({}.toString),tht=oU("".slice),hd=function(r){return tht(ZAt(r),8,-1)},eht=Ji,rht=Xi,nht=hd,SB=Object,iht=eht("".split),aU=rht(function(){return!SB("z").propertyIsEnumerable(0)})?function(r){return nht(r)==="String"?iht(r,""):SB(r)}:SB,dd=function(r){return r==null},sht=dd,oht=TypeError,Ac=function(r){if(sht(r))throw new oht("Can't call method on "+r);return r},aht=aU,lht=Ac,Bm=function(r){return aht(lht(r))},TB=typeof document=="object"&&document.all,Yi=typeof TB>"u"&&TB!==void 0?function(r){return typeof r=="function"||r===TB}:function(r){return typeof r=="function"},cht=Yi,hc=function(r){return typeof r=="object"?r!==null:cht(r)},IB=Wi,uht=Yi,Aht=function(r){return uht(r)?r:void 0},fd=function(r,t){return arguments.length<2?Aht(IB[r]):IB[r]&&IB[r][t]},hht=Ji,l_=hht({}.isPrototypeOf),c_=typeof navigator<"u"&&String(navigator.userAgent)||"",lU=Wi,FB=c_,cU=lU.process,uU=lU.Deno,AU=cU&&cU.versions||uU&&uU.version,hU=AU&&AU.v8,dc,u_;hU&&(dc=hU.split("."),u_=dc[0]>0&&dc[0]<4?1:+(dc[0]+dc[1])),!u_&&FB&&(dc=FB.match(/Edge\/(\d+)/),(!dc||dc[1]>=74)&&(dc=FB.match(/Chrome\/(\d+)/),dc&&(u_=+dc[1])));var LB=u_,dU=LB,dht=Xi,fht=Wi,pht=fht.String,fU=!!Object.getOwnPropertySymbols&&!dht(function(){var r=Symbol("symbol detection");return!pht(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&dU&&dU<41}),ght=fU,pU=ght&&!Symbol.sham&&typeof Symbol.iterator=="symbol",mht=fd,yht=Yi,_ht=l_,vht=pU,bht=Object,gU=vht?function(r){return typeof r=="symbol"}:function(r){var t=mht("Symbol");return yht(t)&&_ht(t.prototype,bht(r))},wht=String,A_=function(r){try{return wht(r)}catch{return"Object"}},xht=Yi,Bht=A_,Cht=TypeError,tA=function(r){if(xht(r))return r;throw new Cht(Bht(r)+" is not a function")},Eht=tA,Sht=dd,np=function(r,t){var e=r[t];return Sht(e)?void 0:Eht(e)},PB=Zs,MB=Yi,RB=hc,Tht=TypeError,Iht=function(r,t){var e,n;if(t==="string"&&MB(e=r.toString)&&!RB(n=PB(e,r))||MB(e=r.valueOf)&&!RB(n=PB(e,r))||t!=="string"&&MB(e=r.toString)&&!RB(n=PB(e,r)))return n;throw new Tht("Can't convert object to primitive value")},mU={exports:{}},yU=Wi,Fht=Object.defineProperty,UB=function(r,t){try{Fht(yU,r,{value:t,configurable:!0,writable:!0})}catch{yU[r]=t}return t},Lht=Wi,Pht=UB,_U="__core-js_shared__",vU=mU.exports=Lht[_U]||Pht(_U,{});(vU.versions||(vU.versions=[])).push({version:"3.37.0",mode:"global",copyright:" 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.0/LICENSE",source:"https://github.com/zloirock/core-js"});var OB=mU.exports,bU=OB,DB=function(r,t){return bU[r]||(bU[r]=t||{})},Mht=Ac,Rht=Object,h_=function(r){return Rht(Mht(r))},Uht=Ji,Oht=h_,Dht=Uht({}.hasOwnProperty),fc=Object.hasOwn||function(r,t){return Dht(Oht(r),t)},Nht=Ji,kht=0,Qht=Math.random(),zht=Nht(1 .toString),wU=function(r){return"Symbol("+(r===void 0?"":r)+")_"+zht(++kht+Qht,36)},Hht=Wi,Vht=DB,xU=fc,Ght=wU,jht=fU,qht=pU,ip=Hht.Symbol,NB=Vht("wks"),Kht=qht?ip.for||ip:ip&&ip.withoutSetter||Ght,ks=function(r){return xU(NB,r)||(NB[r]=jht&&xU(ip,r)?ip[r]:Kht("Symbol."+r)),NB[r]},$ht=Zs,BU=hc,CU=gU,Wht=np,Xht=Iht,Jht=ks,Yht=TypeError,Zht=Jht("toPrimitive"),tdt=function(r,t){if(!BU(r)||CU(r))return r;var e=Wht(r,Zht),n;if(e){if(t===void 0&&(t="default"),n=$ht(e,r,t),!BU(n)||CU(n))return n;throw new Yht("Can't convert object to primitive value")}return t===void 0&&(t="number"),Xht(r,t)},edt=tdt,rdt=gU,EU=function(r){var t=edt(r,"string");return rdt(t)?t:t+""},ndt=Wi,SU=hc,kB=ndt.document,idt=SU(kB)&&SU(kB.createElement),d_=function(r){return idt?kB.createElement(r):{}},sdt=uc,odt=Xi,adt=d_,TU=!sdt&&!odt(function(){return Object.defineProperty(adt("div"),"a",{get:function(){return 7}}).a!==7}),ldt=uc,cdt=Zs,udt=eU,Adt=CB,hdt=Bm,ddt=EU,fdt=fc,pdt=TU,IU=Object.getOwnPropertyDescriptor;xm.f=ldt?IU:function(r,t){if(r=hdt(r),t=ddt(t),pdt)try{return IU(r,t)}catch{}if(fdt(r,t))return Adt(!cdt(udt.f,r,t),r[t])};var eA={},gdt=uc,mdt=Xi,FU=gdt&&mdt(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),ydt=hc,_dt=String,vdt=TypeError,qo=function(r){if(ydt(r))return r;throw new vdt(_dt(r)+" is not an object")},bdt=uc,wdt=TU,xdt=FU,f_=qo,LU=EU,Bdt=TypeError,QB=Object.defineProperty,Cdt=Object.getOwnPropertyDescriptor,zB="enumerable",HB="configurable",VB="writable";eA.f=bdt?xdt?function(r,t,e){if(f_(r),t=LU(t),f_(e),typeof r=="function"&&t==="prototype"&&"value"in e&&VB in e&&!e[VB]){var n=Cdt(r,t);n&&n[VB]&&(r[t]=e.value,e={configurable:HB in e?e[HB]:n[HB],enumerable:zB in e?e[zB]:n[zB],writable:!1})}return QB(r,t,e)}:QB:function(r,t,e){if(f_(r),t=LU(t),f_(e),wdt)try{return QB(r,t,e)}catch{}if("get"in e||"set"in e)throw new Bdt("Accessors not supported");return"value"in e&&(r[t]=e.value),r};var Edt=uc,Sdt=eA,Tdt=CB,Cm=Edt?function(r,t,e){return Sdt.f(r,t,Tdt(1,e))}:function(r,t,e){return r[t]=e,r},PU={exports:{}},GB=uc,Idt=fc,MU=Function.prototype,Fdt=GB&&Object.getOwnPropertyDescriptor,jB=Idt(MU,"name"),Ldt=jB&&(function(){}).name==="something",Pdt=jB&&(!GB||GB&&Fdt(MU,"name").configurable),p_={EXISTS:jB,PROPER:Ldt,CONFIGURABLE:Pdt},Mdt=Ji,Rdt=Yi,qB=OB,Udt=Mdt(Function.toString);Rdt(qB.inspectSource)||(qB.inspectSource=function(r){return Udt(r)});var KB=qB.inspectSource,Odt=Wi,Ddt=Yi,RU=Odt.WeakMap,Ndt=Ddt(RU)&&/native code/.test(String(RU)),kdt=DB,Qdt=wU,UU=kdt("keys"),$B=function(r){return UU[r]||(UU[r]=Qdt(r))},WB={},zdt=Ndt,OU=Wi,Hdt=hc,Vdt=Cm,XB=fc,JB=OB,Gdt=$B,jdt=WB,DU="Object already initialized",YB=OU.TypeError,qdt=OU.WeakMap,g_,Em,m_,Kdt=function(r){return m_(r)?Em(r):g_(r,{})},$dt=function(r){return function(t){var e;if(!Hdt(t)||(e=Em(t)).type!==r)throw new YB("Incompatible receiver, "+r+" required");return e}};if(zdt||JB.state){var Yc=JB.state||(JB.state=new qdt);Yc.get=Yc.get,Yc.has=Yc.has,Yc.set=Yc.set,g_=function(r,t){if(Yc.has(r))throw new YB(DU);return t.facade=r,Yc.set(r,t),t},Em=function(r){return Yc.get(r)||{}},m_=function(r){return Yc.has(r)}}else{var sp=Gdt("state");jdt[sp]=!0,g_=function(r,t){if(XB(r,sp))throw new YB(DU);return t.facade=r,Vdt(r,sp,t),t},Em=function(r){return XB(r,sp)?r[sp]:{}},m_=function(r){return XB(r,sp)}}var y_={set:g_,get:Em,has:m_,enforce:Kdt,getterFor:$dt},ZB=Ji,Wdt=Xi,Xdt=Yi,__=fc,tC=uc,Jdt=p_.CONFIGURABLE,Ydt=KB,NU=y_,Zdt=NU.enforce,tft=NU.get,kU=String,v_=Object.defineProperty,eft=ZB("".slice),rft=ZB("".replace),nft=ZB([].join),ift=tC&&!Wdt(function(){return v_(function(){},"length",{value:8}).length!==8}),sft=String(String).split("String"),oft=PU.exports=function(r,t,e){eft(kU(t),0,7)==="Symbol("&&(t="["+rft(kU(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),e&&e.getter&&(t="get "+t),e&&e.setter&&(t="set "+t),(!__(r,"name")||Jdt&&r.name!==t)&&(tC?v_(r,"name",{value:t,configurable:!0}):r.name=t),ift&&e&&__(e,"arity")&&r.length!==e.arity&&v_(r,"length",{value:e.arity});try{e&&__(e,"constructor")&&e.constructor?tC&&v_(r,"prototype",{writable:!1}):r.prototype&&(r.prototype=void 0)}catch{}var n=Zdt(r);return __(n,"source")||(n.source=nft(sft,typeof t=="string"?t:"")),r};Function.prototype.toString=oft(function(){return Xdt(this)&&tft(this).source||Ydt(this)},"toString");var QU=PU.exports,aft=Yi,lft=eA,cft=QU,uft=UB,pd=function(r,t,e,n){n||(n={});var i=n.enumerable,s=n.name!==void 0?n.name:t;if(aft(e)&&cft(e,s,n),n.global)i?r[t]=e:uft(t,e);else{try{n.unsafe?r[t]&&(i=!0):delete r[t]}catch{}i?r[t]=e:lft.f(r,t,{value:e,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return r},zU={},Aft=Math.ceil,hft=Math.floor,dft=Math.trunc||function(r){var t=+r;return(t>0?hft:Aft)(t)},fft=dft,b_=function(r){var t=+r;return t!==t||t===0?0:fft(t)},pft=b_,gft=Math.max,mft=Math.min,yft=function(r,t){var e=pft(r);return e<0?gft(e+t,0):mft(e,t)},_ft=b_,vft=Math.min,op=function(r){var t=_ft(r);return t>0?vft(t,9007199254740991):0},bft=op,eC=function(r){return bft(r.length)},wft=Bm,xft=yft,Bft=eC,HU=function(r){return function(t,e,n){var i=wft(t),s=Bft(i);if(s===0)return!r&&-1;var a=xft(n,s),o;if(r&&e!==e){for(;s>a;)if(o=i[a++],o!==o)return!0}else for(;s>a;a++)if((r||a in i)&&i[a]===e)return r||a||0;return!r&&-1}},VU={includes:HU(!0),indexOf:HU(!1)},Cft=Ji,rC=fc,Eft=Bm,Sft=VU.indexOf,Tft=WB,GU=Cft([].push),jU=function(r,t){var e=Eft(r),n=0,i=[],s;for(s in e)!rC(Tft,s)&&rC(e,s)&&GU(i,s);for(;t.length>n;)rC(e,s=t[n++])&&(~Sft(i,s)||GU(i,s));return i},nC=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ift=jU,Fft=nC,Lft=Fft.concat("length","prototype");zU.f=Object.getOwnPropertyNames||function(r){return Ift(r,Lft)};var qU={};qU.f=Object.getOwnPropertySymbols;var Pft=fd,Mft=Ji,Rft=zU,Uft=qU,Oft=qo,Dft=Mft([].concat),Nft=Pft("Reflect","ownKeys")||function(r){var t=Rft.f(Oft(r)),e=Uft.f;return e?Dft(t,e(r)):t},KU=fc,kft=Nft,Qft=xm,zft=eA,Hft=function(r,t,e){for(var n=kft(t),i=zft.f,s=Qft.f,a=0;a<n.length;a++){var o=n[a];!KU(r,o)&&!(e&&KU(e,o))&&i(r,o,s(t,o))}},Vft=Xi,Gft=Yi,jft=/#|\.prototype\./,Sm=function(r,t){var e=Kft[qft(r)];return e===Wft?!0:e===$ft?!1:Gft(t)?Vft(t):!!t},qft=Sm.normalize=function(r){return String(r).replace(jft,".").toLowerCase()},Kft=Sm.data={},$ft=Sm.NATIVE="N",Wft=Sm.POLYFILL="P",$U=Sm,w_=Wi,Xft=xm.f,Jft=Cm,Yft=pd,Zft=UB,tpt=Hft,ept=$U,Ko=function(r,t){var e=r.target,n=r.global,i=r.stat,s,a,o,d,f,_;if(n?a=w_:i?a=w_[e]||Zft(e,{}):a=w_[e]&&w_[e].prototype,a)for(o in t){if(f=t[o],r.dontCallGetSet?(_=Xft(a,o),d=_&&_.value):d=a[o],s=ept(n?o:e+(i?".":"#")+o,r.forced),!s&&d!==void 0){if(typeof f==typeof d)continue;tpt(f,d)}(r.sham||d&&d.sham)&&Jft(f,"sham",!0),Yft(a,o,f,r)}},rpt=Wi,npt=hd,Tm=npt(rpt.process)==="process",ipt=Ji,spt=tA,opt=function(r,t,e){try{return ipt(spt(Object.getOwnPropertyDescriptor(r,t)[e]))}catch{}},apt=hc,lpt=function(r){return apt(r)||r===null},cpt=lpt,upt=String,Apt=TypeError,hpt=function(r){if(cpt(r))return r;throw new Apt("Can't set "+upt(r)+" as a prototype")},dpt=opt,fpt=hc,ppt=Ac,gpt=hpt,WU=Object.setPrototypeOf||("__proto__"in{}?function(){var r=!1,t={},e;try{e=dpt(Object.prototype,"__proto__","set"),e(t,[]),r=t instanceof Array}catch{}return function(n,i){return ppt(n),gpt(i),fpt(n)&&(r?e(n,i):n.__proto__=i),n}}():void 0),mpt=eA.f,ypt=fc,_pt=ks,XU=_pt("toStringTag"),x_=function(r,t,e){r&&!e&&(r=r.prototype),r&&!ypt(r,XU)&&mpt(r,XU,{configurable:!0,value:t})},JU=QU,vpt=eA,bpt=function(r,t,e){return e.get&&JU(e.get,t,{getter:!0}),e.set&&JU(e.set,t,{setter:!0}),vpt.f(r,t,e)},wpt=fd,xpt=bpt,Bpt=ks,Cpt=uc,YU=Bpt("species"),Ept=function(r){var t=wpt(r);Cpt&&t&&!t[YU]&&xpt(t,YU,{configurable:!0,get:function(){return this}})},Spt=l_,Tpt=TypeError,Ipt=function(r,t){if(Spt(t,r))return r;throw new Tpt("Incorrect invocation")},Fpt=ks,Lpt=Fpt("toStringTag"),ZU={};ZU[Lpt]="z";var Ppt=String(ZU)==="[object z]",Mpt=Ppt,Rpt=Yi,B_=hd,Upt=ks,Opt=Upt("toStringTag"),Dpt=Object,Npt=B_(function(){return arguments}())==="Arguments",kpt=function(r,t){try{return r[t]}catch{}},iC=Mpt?B_:function(r){var t,e,n;return r===void 0?"Undefined":r===null?"Null":typeof(e=kpt(t=Dpt(r),Opt))=="string"?e:Npt?B_(t):(n=B_(t))==="Object"&&Rpt(t.callee)?"Arguments":n},Qpt=Ji,zpt=Xi,tO=Yi,Hpt=iC,Vpt=fd,Gpt=KB,eO=function(){},rO=Vpt("Reflect","construct"),sC=/^\s*(?:class|function)\b/,jpt=Qpt(sC.exec),qpt=!sC.test(eO),Im=function(r){if(!tO(r))return!1;try{return rO(eO,[],r),!0}catch{return!1}},nO=function(r){if(!tO(r))return!1;switch(Hpt(r)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return qpt||!!jpt(sC,Gpt(r))}catch{return!0}};nO.sham=!0;var Kpt=!rO||zpt(function(){var r;return Im(Im.call)||!Im(Object)||!Im(function(){r=!0})||r})?nO:Im,$pt=Kpt,Wpt=A_,Xpt=TypeError,Jpt=function(r){if($pt(r))return r;throw new Xpt(Wpt(r)+" is not a constructor")},iO=qo,Ypt=Jpt,Zpt=dd,tgt=ks,egt=tgt("species"),sO=function(r,t){var e=iO(r).constructor,n;return e===void 0||Zpt(n=iO(e)[egt])?t:Ypt(n)},rgt=o_,oO=Function.prototype,aO=oO.apply,lO=oO.call,cO=typeof Reflect=="object"&&Reflect.apply||(rgt?lO.bind(aO):function(){return lO.apply(aO,arguments)}),ngt=hd,igt=Ji,C_=function(r){if(ngt(r)==="Function")return igt(r)},uO=C_,sgt=tA,ogt=o_,agt=uO(uO.bind),oC=function(r,t){return sgt(r),t===void 0?r:ogt?agt(r,t):function(){return r.apply(t,arguments)}},lgt=fd,AO=lgt("document","documentElement"),cgt=Ji,ugt=cgt([].slice),Agt=TypeError,hgt=function(r,t){if(r<t)throw new Agt("Not enough arguments");return r},dgt=c_,hO=/(?:ipad|iphone|ipod).*applewebkit/i.test(dgt),Ka=Wi,fgt=cO,pgt=oC,dO=Yi,ggt=fc,fO=Xi,pO=AO,mgt=ugt,gO=d_,ygt=hgt,_gt=hO,vgt=Tm,aC=Ka.setImmediate,lC=Ka.clearImmediate,bgt=Ka.process,cC=Ka.Dispatch,wgt=Ka.Function,mO=Ka.MessageChannel,xgt=Ka.String,uC=0,Fm={},yO="onreadystatechange",Lm,gd,AC,hC;fO(function(){Lm=Ka.location});var dC=function(r){if(ggt(Fm,r)){var t=Fm[r];delete Fm[r],t()}},fC=function(r){return function(){dC(r)}},_O=function(r){dC(r.data)},vO=function(r){Ka.postMessage(xgt(r),Lm.protocol+"//"+Lm.host)};(!aC||!lC)&&(aC=function(r){ygt(arguments.length,1);var t=dO(r)?r:wgt(r),e=mgt(arguments,1);return Fm[++uC]=function(){fgt(t,void 0,e)},gd(uC),uC},lC=function(r){delete Fm[r]},vgt?gd=function(r){bgt.nextTick(fC(r))}:cC&&cC.now?gd=function(r){cC.now(fC(r))}:mO&&!_gt?(AC=new mO,hC=AC.port2,AC.port1.onmessage=_O,gd=pgt(hC.postMessage,hC)):Ka.addEventListener&&dO(Ka.postMessage)&&!Ka.importScripts&&Lm&&Lm.protocol!=="file:"&&!fO(vO)?(gd=vO,Ka.addEventListener("message",_O,!1)):yO in gO("script")?gd=function(r){pO.appendChild(gO("script"))[yO]=function(){pO.removeChild(this),dC(r)}}:gd=function(r){setTimeout(fC(r),0)});var bO={set:aC,clear:lC},wO=Wi,Bgt=uc,Cgt=Object.getOwnPropertyDescriptor,Egt=function(r){if(!Bgt)return wO[r];var t=Cgt(wO,r);return t&&t.value},xO=function(){this.head=null,this.tail=null};xO.prototype={add:function(r){var t={item:r,next:null},e=this.tail;e?e.next=t:this.head=t,this.tail=t},get:function(){var r=this.head;if(r){var t=this.head=r.next;return t===null&&(this.tail=null),r.item}}};var BO=xO,Sgt=c_,Tgt=/ipad|iphone|ipod/i.test(Sgt)&&typeof Pebble<"u",Igt=c_,Fgt=/web0s(?!.*chrome)/i.test(Igt),ap=Wi,Lgt=Egt,CO=oC,pC=bO.set,Pgt=BO,Mgt=hO,Rgt=Tgt,Ugt=Fgt,gC=Tm,EO=ap.MutationObserver||ap.WebKitMutationObserver,SO=ap.document,TO=ap.process,E_=ap.Promise,mC=Lgt("queueMicrotask"),lp,yC,_C,S_,IO;if(!mC){var T_=new Pgt,I_=function(){var r,t;for(gC&&(r=TO.domain)&&r.exit();t=T_.get();)try{t()}catch(e){throw T_.head&&lp(),e}r&&r.enter()};!Mgt&&!gC&&!Ugt&&EO&&SO?(yC=!0,_C=SO.createTextNode(""),new EO(I_).observe(_C,{characterData:!0}),lp=function(){_C.data=yC=!yC}):!Rgt&&E_&&E_.resolve?(S_=E_.resolve(void 0),S_.constructor=E_,IO=CO(S_.then,S_),lp=function(){IO(I_)}):gC?lp=function(){TO.nextTick(I_)}:(pC=CO(pC,ap),lp=function(){pC(I_)}),mC=function(r){T_.head||lp(),T_.add(r)}}var Ogt=mC,Dgt=function(r,t){try{arguments.length===1?console.error(r):console.error(r,t)}catch{}},vC=function(r){try{return{error:!1,value:r()}}catch(t){return{error:!0,value:t}}},Ngt=Wi,F_=Ngt.Promise,FO=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",kgt=FO,Qgt=Tm,zgt=!kgt&&!Qgt&&typeof window=="object"&&typeof document=="object",Hgt=Wi,Pm=F_,Vgt=Yi,Ggt=$U,jgt=KB,qgt=ks,Kgt=zgt,$gt=FO,bC=LB;Pm&&Pm.prototype;var Wgt=qgt("species"),wC=!1,LO=Vgt(Hgt.PromiseRejectionEvent),Xgt=Ggt("Promise",function(){var r=jgt(Pm),t=r!==String(Pm);if(!t&&bC===66)return!0;if(!bC||bC<51||!/native code/.test(r)){var e=new Pm(function(s){s(1)}),n=function(s){s(function(){},function(){})},i=e.constructor={};if(i[Wgt]=n,wC=e.then(function(){})instanceof n,!wC)return!0}return!t&&(Kgt||$gt)&&!LO}),Mm={CONSTRUCTOR:Xgt,REJECTION_EVENT:LO,SUBCLASSING:wC},cp={},PO=tA,Jgt=TypeError,Ygt=function(r){var t,e;this.promise=new r(function(n,i){if(t!==void 0||e!==void 0)throw new Jgt("Bad Promise constructor");t=n,e=i}),this.resolve=PO(t),this.reject=PO(e)};cp.f=function(r){return new Ygt(r)};var Zgt=Ko,L_=Tm,ch=Wi,up=Zs,MO=pd,RO=WU,tmt=x_,emt=Ept,rmt=tA,P_=Yi,nmt=hc,imt=Ipt,smt=sO,UO=bO.set,xC=Ogt,omt=Dgt,amt=vC,lmt=BO,OO=y_,M_=F_,BC=Mm,DO=cp,R_="Promise",NO=BC.CONSTRUCTOR,cmt=BC.REJECTION_EVENT,umt=BC.SUBCLASSING,CC=OO.getterFor(R_),Amt=OO.set,Ap=M_&&M_.prototype,md=M_,U_=Ap,kO=ch.TypeError,EC=ch.document,SC=ch.process,TC=DO.f,hmt=TC,dmt=!!(EC&&EC.createEvent&&ch.dispatchEvent),QO="unhandledrejection",fmt="rejectionhandled",zO=0,HO=1,pmt=2,IC=1,VO=2,O_,GO,gmt,jO,qO=function(r){var t;return nmt(r)&&P_(t=r.then)?t:!1},KO=function(r,t){var e=t.value,n=t.state===HO,i=n?r.ok:r.fail,s=r.resolve,a=r.reject,o=r.domain,d,f,_;try{i?(n||(t.rejection===VO&&ymt(t),t.rejection=IC),i===!0?d=e:(o&&o.enter(),d=i(e),o&&(o.exit(),_=!0)),d===r.promise?a(new kO("Promise-chain cycle")):(f=qO(d))?up(f,d,s,a):s(d)):a(e)}catch(w){o&&!_&&o.exit(),a(w)}},$O=function(r,t){r.notified||(r.notified=!0,xC(function(){for(var e=r.reactions,n;n=e.get();)KO(n,r);r.notified=!1,t&&!r.rejection&&mmt(r)}))},WO=function(r,t,e){var n,i;dmt?(n=EC.createEvent("Event"),n.promise=t,n.reason=e,n.initEvent(r,!1,!0),ch.dispatchEvent(n)):n={promise:t,reason:e},!cmt&&(i=ch["on"+r])?i(n):r===QO&&omt("Unhandled promise rejection",e)},mmt=function(r){up(UO,ch,function(){var t=r.facade,e=r.value,n=XO(r),i;if(n&&(i=amt(function(){L_?SC.emit("unhandledRejection",e,t):WO(QO,t,e)}),r.rejection=L_||XO(r)?VO:IC,i.error))throw i.value})},XO=function(r){return r.rejection!==IC&&!r.parent},ymt=function(r){up(UO,ch,function(){var t=r.facade;L_?SC.emit("rejectionHandled",t):WO(fmt,t,r.value)})},hp=function(r,t,e){return function(n){r(t,n,e)}},dp=function(r,t,e){r.done||(r.done=!0,e&&(r=e),r.value=t,r.state=pmt,$O(r,!0))},FC=function(r,t,e){if(!r.done){r.done=!0,e&&(r=e);try{if(r.facade===t)throw new kO("Promise can't be resolved itself");var n=qO(t);n?xC(function(){var i={done:!1};try{up(n,t,hp(FC,i,r),hp(dp,i,r))}catch(s){dp(i,s,r)}}):(r.value=t,r.state=HO,$O(r,!1))}catch(i){dp({done:!1},i,r)}}};if(NO&&(md=function(r){imt(this,U_),rmt(r),up(O_,this);var t=CC(this);try{r(hp(FC,t),hp(dp,t))}catch(e){dp(t,e)}},U_=md.prototype,O_=function(r){Amt(this,{type:R_,done:!1,notified:!1,parent:!1,reactions:new lmt,rejection:!1,state:zO,value:void 0})},O_.prototype=MO(U_,"then",function(r,t){var e=CC(this),n=TC(smt(this,md));return e.parent=!0,n.ok=P_(r)?r:!0,n.fail=P_(t)&&t,n.domain=L_?SC.domain:void 0,e.state===zO?e.reactions.add(n):xC(function(){KO(n,e)}),n.promise}),GO=function(){var r=new O_,t=CC(r);this.promise=r,this.resolve=hp(FC,t),this.reject=hp(dp,t)},DO.f=TC=function(r){return r===md||r===gmt?new GO(r):hmt(r)},P_(M_)&&Ap!==Object.prototype)){jO=Ap.then,umt||MO(Ap,"then",function(r,t){var e=this;return new md(function(n,i){up(jO,e,n,i)}).then(r,t)},{unsafe:!0});try{delete Ap.constructor}catch{}RO&&RO(Ap,U_)}Zgt({global:!0,constructor:!0,wrap:!0,forced:NO},{Promise:md}),tmt(md,R_,!1),emt(R_);var Rm={},_mt=ks,vmt=Rm,bmt=_mt("iterator"),wmt=Array.prototype,xmt=function(r){return r!==void 0&&(vmt.Array===r||wmt[bmt]===r)},Bmt=iC,JO=np,Cmt=dd,Emt=Rm,Smt=ks,Tmt=Smt("iterator"),YO=function(r){if(!Cmt(r))return JO(r,Tmt)||JO(r,"@@iterator")||Emt[Bmt(r)]},Imt=Zs,Fmt=tA,Lmt=qo,Pmt=A_,Mmt=YO,Rmt=TypeError,Umt=function(r,t){var e=arguments.length<2?Mmt(r):t;if(Fmt(e))return Lmt(Imt(e,r));throw new Rmt(Pmt(r)+" is not iterable")},Omt=Zs,ZO=qo,Dmt=np,Nmt=function(r,t,e){var n,i;ZO(r);try{if(n=Dmt(r,"return"),!n){if(t==="throw")throw e;return e}n=Omt(n,r)}catch(s){i=!0,n=s}if(t==="throw")throw e;if(i)throw n;return ZO(n),e},kmt=oC,Qmt=Zs,zmt=qo,Hmt=A_,Vmt=xmt,Gmt=eC,tD=l_,jmt=Umt,qmt=YO,eD=Nmt,Kmt=TypeError,D_=function(r,t){this.stopped=r,this.result=t},rD=D_.prototype,nD=function(r,t,e){var n=e&&e.that,i=!!(e&&e.AS_ENTRIES),s=!!(e&&e.IS_RECORD),a=!!(e&&e.IS_ITERATOR),o=!!(e&&e.INTERRUPTED),d=kmt(t,n),f,_,w,x,B,P,R,N=function(V){return f&&eD(f,"normal",V),new D_(!0,V)},Q=function(V){return i?(zmt(V),o?d(V[0],V[1],N):d(V[0],V[1])):o?d(V,N):d(V)};if(s)f=r.iterator;else if(a)f=r;else{if(_=qmt(r),!_)throw new Kmt(Hmt(r)+" is not iterable");if(Vmt(_)){for(w=0,x=Gmt(r);x>w;w++)if(B=Q(r[w]),B&&tD(rD,B))return B;return new D_(!1)}f=jmt(r,_)}for(P=s?r.next:f.next;!(R=Qmt(P,f)).done;){try{B=Q(R.value)}catch(V){eD(f,"throw",V)}if(typeof B=="object"&&B&&tD(rD,B))return B}return new D_(!1)},$mt=ks,iD=$mt("iterator"),sD=!1;try{var Wmt=0,oD={next:function(){return{done:!!Wmt++}},return:function(){sD=!0}};oD[iD]=function(){return this},Array.from(oD,function(){throw 2})}catch{}var Xmt=function(r,t){try{if(!t&&!sD)return!1}catch{return!1}var e=!1;try{var n={};n[iD]=function(){return{next:function(){return{done:e=!0}}}},r(n)}catch{}return e},Jmt=F_,Ymt=Xmt,Zmt=Mm.CONSTRUCTOR,aD=Zmt||!Ymt(function(r){Jmt.all(r).then(void 0,function(){})}),t0t=Ko,e0t=Zs,r0t=tA,n0t=cp,i0t=vC,s0t=nD,o0t=aD;t0t({target:"Promise",stat:!0,forced:o0t},{all:function(r){var t=this,e=n0t.f(t),n=e.resolve,i=e.reject,s=i0t(function(){var a=r0t(t.resolve),o=[],d=0,f=1;s0t(r,function(_){var w=d++,x=!1;f++,e0t(a,t,_).then(function(B){x||(x=!0,o[w]=B,--f||n(o))},i)}),--f||n(o)});return s.error&&i(s.value),e.promise}});var a0t=Ko,l0t=Mm.CONSTRUCTOR,LC=F_,c0t=fd,u0t=Yi,A0t=pd,lD=LC&&LC.prototype;if(a0t({target:"Promise",proto:!0,forced:l0t,real:!0},{catch:function(r){return this.then(void 0,r)}}),u0t(LC)){var cD=c0t("Promise").prototype.catch;lD.catch!==cD&&A0t(lD,"catch",cD,{unsafe:!0})}var h0t=Ko,d0t=Zs,f0t=tA,p0t=cp,g0t=vC,m0t=nD,y0t=aD;h0t({target:"Promise",stat:!0,forced:y0t},{race:function(r){var t=this,e=p0t.f(t),n=e.reject,i=g0t(function(){var s=f0t(t.resolve);m0t(r,function(a){d0t(s,t,a).then(e.resolve,n)})});return i.error&&n(i.value),e.promise}});var _0t=Ko,v0t=cp,b0t=Mm.CONSTRUCTOR;_0t({target:"Promise",stat:!0,forced:b0t},{reject:function(r){var t=v0t.f(this),e=t.reject;return e(r),t.promise}});var w0t=qo,x0t=hc,B0t=cp,C0t=function(r,t){if(w0t(r),x0t(t)&&t.constructor===r)return t;var e=B0t.f(r),n=e.resolve;return n(t),e.promise},E0t=Ko,S0t=fd,T0t=Mm.CONSTRUCTOR,I0t=C0t;S0t("Promise"),E0t({target:"Promise",stat:!0,forced:T0t},{resolve:function(r){return I0t(this,r)}});function uD(r,t,e,n,i,s,a){try{var o=r[s](a),d=o.value}catch(f){e(f);return}o.done?t(d):Promise.resolve(d).then(n,i)}function rA(r){return function(){var t=this,e=arguments;return new Promise(function(n,i){var s=r.apply(t,e);function a(d){uD(s,n,i,a,o,"next",d)}function o(d){uD(s,n,i,a,o,"throw",d)}a(void 0)})}}var F0t=iC,L0t=String,Zc=function(r){if(F0t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return L0t(r)},P0t=qo,AD=function(){var r=P0t(this),t="";return r.hasIndices&&(t+="d"),r.global&&(t+="g"),r.ignoreCase&&(t+="i"),r.multiline&&(t+="m"),r.dotAll&&(t+="s"),r.unicode&&(t+="u"),r.unicodeSets&&(t+="v"),r.sticky&&(t+="y"),t},PC=Xi,M0t=Wi,MC=M0t.RegExp,RC=PC(function(){var r=MC("a","y");return r.lastIndex=2,r.exec("abcd")!==null}),R0t=RC||PC(function(){return!MC("a","y").sticky}),U0t=RC||PC(function(){var r=MC("^r","gy");return r.lastIndex=2,r.exec("str")!==null}),hD={BROKEN_CARET:U0t,MISSED_STICKY:R0t,UNSUPPORTED_Y:RC},dD={},O0t=jU,D0t=nC,N0t=Object.keys||function(r){return O0t(r,D0t)},k0t=uc,Q0t=FU,z0t=eA,H0t=qo,V0t=Bm,G0t=N0t;dD.f=k0t&&!Q0t?Object.defineProperties:function(r,t){H0t(r);for(var e=V0t(t),n=G0t(t),i=n.length,s=0,a;i>s;)z0t.f(r,a=n[s++],e[a]);return r};var j0t=qo,q0t=dD,fD=nC,K0t=WB,$0t=AO,W0t=d_,X0t=$B,pD=">",gD="<",UC="prototype",OC="script",mD=X0t("IE_PROTO"),DC=function(){},yD=function(r){return gD+OC+pD+r+gD+"/"+OC+pD},_D=function(r){r.write(yD("")),r.close();var t=r.parentWindow.Object;return r=null,t},J0t=function(){var r=W0t("iframe"),t="java"+OC+":",e;return r.style.display="none",$0t.appendChild(r),r.src=String(t),e=r.contentWindow.document,e.open(),e.write(yD("document.F=Object")),e.close(),e.F},N_,k_=function(){try{N_=new ActiveXObject("htmlfile")}catch{}k_=typeof document<"u"?document.domain&&N_?_D(N_):J0t():_D(N_);for(var r=fD.length;r--;)delete k_[UC][fD[r]];return k_()};K0t[mD]=!0;var NC=Object.create||function(r,t){var e;return r!==null?(DC[UC]=j0t(r),e=new DC,DC[UC]=null,e[mD]=r):e=k_(),t===void 0?e:q0t.f(e,t)},Y0t=Xi,Z0t=Wi,tyt=Z0t.RegExp,eyt=Y0t(function(){var r=tyt(".","s");return!(r.dotAll&&r.test(`
`)&&r.flags==="s")}),ryt=Xi,nyt=Wi,iyt=nyt.RegExp,syt=ryt(function(){var r=iyt("(?<a>b)","g");return r.exec("b").groups.a!=="b"||"b".replace(r,"$<a>c")!=="bc"}),fp=Zs,Q_=Ji,oyt=Zc,ayt=AD,lyt=hD,cyt=DB,uyt=NC,Ayt=y_.get,hyt=eyt,dyt=syt,fyt=cyt("native-string-replace",String.prototype.replace),z_=RegExp.prototype.exec,kC=z_,pyt=Q_("".charAt),gyt=Q_("".indexOf),myt=Q_("".replace),QC=Q_("".slice),zC=function(){var r=/a/,t=/b*/g;return fp(z_,r,"a"),fp(z_,t,"a"),r.lastIndex!==0||t.lastIndex!==0}(),vD=lyt.BROKEN_CARET,HC=/()??/.exec("")[1]!==void 0,yyt=zC||HC||vD||hyt||dyt;yyt&&(kC=function(r){var t=this,e=Ayt(t),n=oyt(r),i=e.raw,s,a,o,d,f,_,w;if(i)return i.lastIndex=t.lastIndex,s=fp(kC,i,n),t.lastIndex=i.lastIndex,s;var x=e.groups,B=vD&&t.sticky,P=fp(ayt,t),R=t.source,N=0,Q=n;if(B&&(P=myt(P,"y",""),gyt(P,"g")===-1&&(P+="g"),Q=QC(n,t.lastIndex),t.lastIndex>0&&(!t.multiline||t.multiline&&pyt(n,t.lastIndex-1)!==`
`)&&(R="(?: "+R+")",Q=" "+Q,N++),a=new RegExp("^(?:"+R+")",P)),HC&&(a=new RegExp("^"+R+"$(?!\\s)",P)),zC&&(o=t.lastIndex),d=fp(z_,B?a:t,Q),B?d?(d.input=QC(d.input,N),d[0]=QC(d[0],N),d.index=t.lastIndex,t.lastIndex+=d[0].length):t.lastIndex=0:zC&&d&&(t.lastIndex=t.global?d.index+d[0].length:o),HC&&d&&d.length>1&&fp(fyt,d[0],a,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(d[f]=void 0)}),d&&x)for(d.groups=_=uyt(null),f=0;f<x.length;f++)w=x[f],_[w[0]]=d[w[1]];return d});var VC=kC,_yt=Ko,bD=VC;_yt({target:"RegExp",proto:!0,forced:/./.exec!==bD},{exec:bD});var wD=Zs,xD=pd,vyt=VC,BD=Xi,CD=ks,byt=Cm,wyt=CD("species"),GC=RegExp.prototype,jC=function(r,t,e,n){var i=CD(r),s=!BD(function(){var f={};return f[i]=function(){return 7},""[r](f)!==7}),a=s&&!BD(function(){var f=!1,_=/a/;return r==="split"&&(_={},_.constructor={},_.constructor[wyt]=function(){return _},_.flags="",_[i]=/./[i]),_.exec=function(){return f=!0,null},_[i](""),!f});if(!s||!a||e){var o=/./[i],d=t(i,""[r],function(f,_,w,x,B){var P=_.exec;return P===vyt||P===GC.exec?s&&!B?{done:!0,value:wD(o,_,w,x)}:{done:!0,value:wD(f,w,_,x)}:{done:!1}});xD(String.prototype,r,d[0]),xD(GC,i,d[1])}n&&byt(GC[i],"sham",!0)},qC=Ji,xyt=b_,Byt=Zc,Cyt=Ac,Eyt=qC("".charAt),ED=qC("".charCodeAt),Syt=qC("".slice),SD=function(r){return function(t,e){var n=Byt(Cyt(t)),i=xyt(e),s=n.length,a,o;return i<0||i>=s?r?"":void 0:(a=ED(n,i),a<55296||a>56319||i+1===s||(o=ED(n,i+1))<56320||o>57343?r?Eyt(n,i):a:r?Syt(n,i,i+2):(a-55296<<10)+(o-56320)+65536)}},Tyt={codeAt:SD(!1),charAt:SD(!0)},Iyt=Tyt.charAt,KC=function(r,t,e){return t+(e?Iyt(r,t).length:1)},TD=Zs,Fyt=qo,Lyt=Yi,Pyt=hd,Myt=VC,Ryt=TypeError,$C=function(r,t){var e=r.exec;if(Lyt(e)){var n=TD(e,r,t);return n!==null&&Fyt(n),n}if(Pyt(r)==="RegExp")return TD(Myt,r,t);throw new Ryt("RegExp#exec called on incompatible receiver")},Uyt=Zs,Oyt=jC,Dyt=qo,Nyt=dd,kyt=op,WC=Zc,Qyt=Ac,zyt=np,Hyt=KC,ID=$C;Oyt("match",function(r,t,e){return[function(n){var i=Qyt(this),s=Nyt(n)?void 0:zyt(n,r);return s?Uyt(s,n,i):new RegExp(n)[r](WC(i))},function(n){var i=Dyt(this),s=WC(n),a=e(t,i,s);if(a.done)return a.value;if(!i.global)return ID(i,s);var o=i.unicode;i.lastIndex=0;for(var d=[],f=0,_;(_=ID(i,s))!==null;){var w=WC(_[0]);d[f]=w,w===""&&(i.lastIndex=Hyt(s,kyt(i.lastIndex),o)),f++}return f===0?null:d}]});var XC=Ji,Vyt=h_,Gyt=Math.floor,JC=XC("".charAt),jyt=XC("".replace),YC=XC("".slice),qyt=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Kyt=/\$([$&'`]|\d{1,2})/g,$yt=function(r,t,e,n,i,s){var a=e+r.length,o=n.length,d=Kyt;return i!==void 0&&(i=Vyt(i),d=qyt),jyt(s,d,function(f,_){var w;switch(JC(_,0)){case"$":return"$";case"&":return r;case"`":return YC(t,0,e);case"'":return YC(t,a);case"<":w=i[YC(_,1,-1)];break;default:var x=+_;if(x===0)return f;if(x>o){var B=Gyt(x/10);return B===0?f:B<=o?n[B-1]===void 0?JC(_,1):n[B-1]+JC(_,1):f}w=n[x-1]}return w===void 0?"":w})},Wyt=cO,FD=Zs,H_=Ji,Xyt=jC,Jyt=Xi,Yyt=qo,Zyt=Yi,t1t=dd,e1t=b_,r1t=op,pp=Zc,n1t=Ac,i1t=KC,s1t=np,o1t=$yt,a1t=$C,l1t=ks,ZC=l1t("replace"),c1t=Math.max,u1t=Math.min,A1t=H_([].concat),tE=H_([].push),LD=H_("".indexOf),PD=H_("".slice),h1t=function(r){return r===void 0?r:String(r)},d1t=function(){return"a".replace(/./,"$0")==="$0"}(),MD=function(){return/./[ZC]?/./[ZC]("a","$0")==="":!1}(),f1t=!Jyt(function(){var r=/./;return r.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(r,"$<a>")!=="7"});Xyt("replace",function(r,t,e){var n=MD?"$":"$0";return[function(i,s){var a=n1t(this),o=t1t(i)?void 0:s1t(i,ZC);return o?FD(o,i,a,s):FD(t,pp(a),i,s)},function(i,s){var a=Yyt(this),o=pp(i);if(typeof s=="string"&&LD(s,n)===-1&&LD(s,"$<")===-1){var d=e(t,a,o,s);if(d.done)return d.value}var f=Zyt(s);f||(s=pp(s));var _=a.global,w;_&&(w=a.unicode,a.lastIndex=0);for(var x=[],B;B=a1t(a,o),!(B===null||(tE(x,B),!_));){var P=pp(B[0]);P===""&&(a.lastIndex=i1t(o,r1t(a.lastIndex),w))}for(var R="",N=0,Q=0;Q<x.length;Q++){B=x[Q];for(var V=pp(B[0]),W=c1t(u1t(e1t(B.index),o.length),0),et=[],ct,dt=1;dt<B.length;dt++)tE(et,h1t(B[dt]));var gt=B.groups;if(f){var ht=A1t([V],et,W,o);gt!==void 0&&tE(ht,gt),ct=pp(Wyt(s,void 0,ht))}else ct=o1t(V,o,W,et,gt,s);W>=N&&(R+=PD(o,N,W)+ct,N=W+V.length)}return R+PD(o,N)}]},!f1t||!d1t||MD);var p1t=hc,g1t=hd,m1t=ks,y1t=m1t("match"),_1t=function(r){var t;return p1t(r)&&((t=r[y1t])!==void 0?!!t:g1t(r)==="RegExp")},v1t=_1t,b1t=TypeError,eE=function(r){if(v1t(r))throw new b1t("The method doesn't accept regular expressions");return r},w1t=ks,x1t=w1t("match"),rE=function(r){var t=/./;try{"/./"[r](t)}catch{try{return t[x1t]=!1,"/./"[r](t)}catch{}}return!1},B1t=Ko,C1t=C_,E1t=xm.f,S1t=op,RD=Zc,T1t=eE,I1t=Ac,F1t=rE,L1t=C1t("".slice),P1t=Math.min,UD=F1t("startsWith"),M1t=!UD&&!!function(){var r=E1t(String.prototype,"startsWith");return r&&!r.writable}();B1t({target:"String",proto:!0,forced:!M1t&&!UD},{startsWith:function(r){var t=RD(I1t(this));T1t(r);var e=S1t(P1t(arguments.length>1?arguments[1]:void 0,t.length)),n=RD(r);return L1t(t,e,e+n.length)===n}});var R1t=ks,U1t=NC,O1t=eA.f,nE=R1t("unscopables"),iE=Array.prototype;iE[nE]===void 0&&O1t(iE,nE,{configurable:!0,value:U1t(null)});var D1t=function(r){iE[nE][r]=!0},N1t=Xi,k1t=!N1t(function(){function r(){}return r.prototype.constructor=null,Object.getPrototypeOf(new r)!==r.prototype}),Q1t=fc,z1t=Yi,H1t=h_,V1t=$B,G1t=k1t,OD=V1t("IE_PROTO"),sE=Object,j1t=sE.prototype,DD=G1t?sE.getPrototypeOf:function(r){var t=H1t(r);if(Q1t(t,OD))return t[OD];var e=t.constructor;return z1t(e)&&t instanceof e?e.prototype:t instanceof sE?j1t:null},q1t=Xi,K1t=Yi,$1t=hc,ND=DD,W1t=pd,X1t=ks,oE=X1t("iterator"),kD=!1,yd,aE,lE;[].keys&&(lE=[].keys(),"next"in lE?(aE=ND(ND(lE)),aE!==Object.prototype&&(yd=aE)):kD=!0);var J1t=!$1t(yd)||q1t(function(){var r={};return yd[oE].call(r)!==r});J1t&&(yd={}),K1t(yd[oE])||W1t(yd,oE,function(){return this});var QD={IteratorPrototype:yd,BUGGY_SAFARI_ITERATORS:kD},Y1t=QD.IteratorPrototype,Z1t=NC,t_t=CB,e_t=x_,r_t=Rm,n_t=function(){return this},i_t=function(r,t,e,n){var i=t+" Iterator";return r.prototype=Z1t(Y1t,{next:t_t(+!n,e)}),e_t(r,i,!1),r_t[i]=n_t,r},s_t=Ko,o_t=Zs,zD=p_,a_t=Yi,l_t=i_t,HD=DD,VD=WU,c_t=x_,u_t=Cm,cE=pd,A_t=ks,h_t=Rm,GD=QD,d_t=zD.PROPER,f_t=zD.CONFIGURABLE,jD=GD.IteratorPrototype,V_=GD.BUGGY_SAFARI_ITERATORS,Um=A_t("iterator"),qD="keys",Om="values",KD="entries",p_t=function(){return this},g_t=function(r,t,e,n,i,s,a){l_t(e,t,n);var o=function(Q){if(Q===i&&x)return x;if(!V_&&Q&&Q in _)return _[Q];switch(Q){case qD:return function(){return new e(this,Q)};case Om:return function(){return new e(this,Q)};case KD:return function(){return new e(this,Q)}}return function(){return new e(this)}},d=t+" Iterator",f=!1,_=r.prototype,w=_[Um]||_["@@iterator"]||i&&_[i],x=!V_&&w||o(i),B=t==="Array"&&_.entries||w,P,R,N;if(B&&(P=HD(B.call(new r)),P!==Object.prototype&&P.next&&(HD(P)!==jD&&(VD?VD(P,jD):a_t(P[Um])||cE(P,Um,p_t)),c_t(P,d,!0))),d_t&&i===Om&&w&&w.name!==Om&&(f_t?u_t(_,"name",Om):(f=!0,x=function(){return o_t(w,this)})),i)if(R={values:o(Om),keys:s?x:o(qD),entries:o(KD)},a)for(N in R)(V_||f||!(N in _))&&cE(_,N,R[N]);else s_t({target:t,proto:!0,forced:V_||f},R);return _[Um]!==x&&cE(_,Um,x,{name:i}),h_t[t]=x,R},m_t=function(r,t){return{value:r,done:t}},y_t=Bm,uE=D1t,$D=Rm,WD=y_,__t=eA.f,v_t=g_t,G_=m_t,b_t=uc,XD="Array Iterator",w_t=WD.set,x_t=WD.getterFor(XD),B_t=v_t(Array,"Array",function(r,t){w_t(this,{type:XD,target:y_t(r),index:0,kind:t})},function(){var r=x_t(this),t=r.target,e=r.index++;if(!t||e>=t.length)return r.target=void 0,G_(void 0,!0);switch(r.kind){case"keys":return G_(e,!1);case"values":return G_(t[e],!1)}return G_([e,t[e]],!1)},"values"),JD=$D.Arguments=$D.Array;if(uE("keys"),uE("values"),uE("entries"),b_t&&JD.name!=="values")try{__t(JD,"name",{value:"values"})}catch{}var C_t={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},E_t=d_,AE=E_t("span").classList,YD=AE&&AE.constructor&&AE.constructor.prototype,S_t=YD===Object.prototype?void 0:YD,ZD=Wi,t6=C_t,T_t=S_t,Dm=B_t,e6=Cm,I_t=x_,F_t=ks,hE=F_t("iterator"),dE=Dm.values,r6=function(r,t){if(r){if(r[hE]!==dE)try{e6(r,hE,dE)}catch{r[hE]=dE}if(I_t(r,t,!0),t6[t]){for(var e in Dm)if(r[e]!==Dm[e])try{e6(r,e,Dm[e])}catch{r[e]=Dm[e]}}}};for(var fE in t6)r6(ZD[fE]&&ZD[fE].prototype,fE);r6(T_t,"DOMTokenList");function L_t(r,t){if(Un(r)!="object"||!r)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var n=e.call(r,t||"default");if(Un(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function P_t(r){var t=L_t(r,"string");return Un(t)=="symbol"?t:t+""}function pE(r,t,e){return t=P_t(t),t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}var M_t=tA,R_t=h_,U_t=aU,O_t=eC,n6=TypeError,i6="Reduce of empty array with no initial value",s6=function(r){return function(t,e,n,i){var s=R_t(t),a=U_t(s),o=O_t(s);if(M_t(e),o===0&&n<2)throw new n6(i6);var d=r?o-1:0,f=r?-1:1;if(n<2)for(;;){if(d in a){i=a[d],d+=f;break}if(d+=f,r?d<0:o<=d)throw new n6(i6)}for(;r?d>=0:o>d;d+=f)d in a&&(i=e(i,a[d],d,s));return i}},D_t={left:s6(!1),right:s6(!0)},N_t=Xi,o6=function(r,t){var e=[][r];return!!e&&N_t(function(){e.call(null,t||function(){return 1},1)})},k_t=Ko,Q_t=D_t.left,z_t=o6,a6=LB,H_t=Tm,V_t=!H_t&&a6>79&&a6<83,G_t=V_t||!z_t("reduce");k_t({target:"Array",proto:!0,forced:G_t},{reduce:function(r){var t=arguments.length;return Q_t(this,r,t,t>1?arguments[1]:void 0)}});var j_t=Ko,q_t=C_,K_t=xm.f,$_t=op,l6=Zc,W_t=eE,X_t=Ac,J_t=rE,Y_t=q_t("".slice),Z_t=Math.min,c6=J_t("endsWith"),tvt=!c6&&!!function(){var r=K_t(String.prototype,"endsWith");return r&&!r.writable}();j_t({target:"String",proto:!0,forced:!tvt&&!c6},{endsWith:function(r){var t=l6(X_t(this));W_t(r);var e=arguments.length>1?arguments[1]:void 0,n=t.length,i=e===void 0?n:Z_t($_t(e),n),s=l6(r);return Y_t(t,i-s.length,i)===s}});var gE=Zs,u6=Ji,evt=jC,rvt=qo,nvt=dd,ivt=Ac,svt=sO,ovt=KC,avt=op,A6=Zc,lvt=np,h6=$C,cvt=hD,uvt=Xi,gp=cvt.UNSUPPORTED_Y,Avt=4294967295,hvt=Math.min,mE=u6([].push),yE=u6("".slice),dvt=!uvt(function(){var r=/(?:)/,t=r.exec;r.exec=function(){return t.apply(this,arguments)};var e="ab".split(r);return e.length!==2||e[0]!=="a"||e[1]!=="b"}),d6="abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length;evt("split",function(r,t,e){var n="0".split(void 0,0).length?function(i,s){return i===void 0&&s===0?[]:gE(t,this,i,s)}:t;return[function(i,s){var a=ivt(this),o=nvt(i)?void 0:lvt(i,r);return o?gE(o,i,a,s):gE(n,A6(a),i,s)},function(i,s){var a=rvt(this),o=A6(i);if(!d6){var d=e(n,a,o,s,n!==t);if(d.done)return d.value}var f=svt(a,RegExp),_=a.unicode,w=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(gp?"g":"y"),x=new f(gp?"^(?:"+a.source+")":a,w),B=s===void 0?Avt:s>>>0;if(B===0)return[];if(o.length===0)return h6(x,o)===null?[o]:[];for(var P=0,R=0,N=[];R<o.length;){x.lastIndex=gp?0:R;var Q=h6(x,gp?yE(o,R):o),V;if(Q===null||(V=hvt(avt(x.lastIndex+(gp?R:0)),o.length))===P)R=ovt(o,R,_);else{if(mE(N,yE(o,P,R)),N.length===B)return N;for(var W=1;W<=Q.length-1;W++)if(mE(N,Q[W]),N.length===B)return N;R=P=V}}return mE(N,yE(o,P)),N}]},d6||!dvt,gp);var j_={exports:{}},Nm={exports:{}};(function(){var r,t,e,n,i,s;typeof performance<"u"&&performance!==null&&performance.now?Nm.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(Nm.exports=function(){return(r()-i)/1e6},t=process.hrtime,r=function(){var a;return a=t(),a[0]*1e9+a[1]},n=r(),s=process.uptime()*1e9,i=n-s):Date.now?(Nm.exports=function(){return Date.now()-e},e=Date.now()):(Nm.exports=function(){return new Date().getTime()-e},e=new Date().getTime())}).call(rp);for(var fvt=Nm.exports,pvt=fvt,nA=typeof window>"u"?rp:window,q_=["moz","webkit"],mp="AnimationFrame",yp=nA["request"+mp],km=nA["cancel"+mp]||nA["cancelRequest"+mp],Qm=0;!yp&&Qm<q_.length;Qm++)yp=nA[q_[Qm]+"Request"+mp],km=nA[q_[Qm]+"Cancel"+mp]||nA[q_[Qm]+"CancelRequest"+mp];if(!yp||!km){var _E=0,f6=0,_d=[],gvt=1e3/60;yp=function(r){if(_d.length===0){var t=pvt(),e=Math.max(0,gvt-(t-_E));_E=e+t,setTimeout(function(){var n=_d.slice(0);_d.length=0;for(var i=0;i<n.length;i++)if(!n[i].cancelled)try{n[i].callback(_E)}catch(s){setTimeout(function(){throw s},0)}},Math.round(e))}return _d.push({handle:++f6,callback:r,cancelled:!1}),f6},km=function(r){for(var t=0;t<_d.length;t++)_d[t].handle===r&&(_d[t].cancelled=!0)}}j_.exports=function(r){return yp.call(nA,r)},j_.exports.cancel=function(){km.apply(nA,arguments)},j_.exports.polyfill=function(r){r||(r=nA),r.requestAnimationFrame=yp,r.cancelAnimationFrame=km};var mvt=j_.exports;const vE=tU(mvt);var p6=`	
\v\f\r \u2028\u2029\uFEFF`,yvt=Ji,_vt=Ac,vvt=Zc,bE=p6,g6=yvt("".replace),bvt=RegExp("^["+bE+"]+"),wvt=RegExp("(^|[^"+bE+"])["+bE+"]+$"),wE=function(r){return function(t){var e=vvt(_vt(t));return r&1&&(e=g6(e,bvt,"")),r&2&&(e=g6(e,wvt,"$1")),e}},xvt={start:wE(1),end:wE(2),trim:wE(3)},Bvt=p_.PROPER,Cvt=Xi,m6=p6,y6="",Evt=function(r){return Cvt(function(){return!!m6[r]()||y6[r]()!==y6||Bvt&&m6[r].name!==r})},Svt=Ko,Tvt=xvt.trim,Ivt=Evt;Svt({target:"String",proto:!0,forced:Ivt("trim")},{trim:function(){return Tvt(this)}});var Fvt=function(r){this.ok=!1,this.alpha=1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r=r.replace(/ /g,""),r=r.toLowerCase();var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};r=t[r]||r;for(var e=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(d){return[parseInt(d[1]),parseInt(d[2]),parseInt(d[3]),parseFloat(d[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(d){return[parseInt(d[1]),parseInt(d[2]),parseInt(d[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(d){return[parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(d){return[parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16)]}}],n=0;n<e.length;n++){var i=e[n].re,s=e[n].process,a=i.exec(r);if(a){var o=s(a);this.r=o[0],this.g=o[1],this.b=o[2],o.length>3&&(this.alpha=o[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var d=this.r.toString(16),f=this.g.toString(16),_=this.b.toString(16);return d.length==1&&(d="0"+d),f.length==1&&(f="0"+f),_.length==1&&(_="0"+_),"#"+d+f+_},this.getHelpXML=function(){for(var d=new Array,f=0;f<e.length;f++)for(var _=e[f].example,w=0;w<_.length;w++)d[d.length]=_[w];for(var x in t)d[d.length]=x;var B=document.createElement("ul");B.setAttribute("id","rgbcolor-examples");for(var f=0;f<d.length;f++)try{var P=document.createElement("li"),R=new RGBColor(d[f]),N=document.createElement("div");N.style.cssText="margin: 3px; border: 1px solid black; background:"+R.toHex()+"; color:"+R.toHex(),N.appendChild(document.createTextNode("test"));var Q=document.createTextNode(" "+d[f]+" -> "+R.toRGB()+" -> "+R.toHex());P.appendChild(N),P.appendChild(Q),B.appendChild(P)}catch{}return B}};const xE=tU(Fvt);var Lvt=Ko,Pvt=C_,Mvt=VU.indexOf,Rvt=o6,BE=Pvt([].indexOf),_6=!!BE&&1/BE([1],1,-0)<0,Uvt=_6||!Rvt("indexOf");Lvt({target:"Array",proto:!0,forced:Uvt},{indexOf:function(r){var t=arguments.length>1?arguments[1]:void 0;return _6?BE(this,r,t)||0:Mvt(this,r,t)}});var Ovt=Ko,Dvt=Ji,Nvt=eE,kvt=Ac,v6=Zc,Qvt=rE,zvt=Dvt("".indexOf);Ovt({target:"String",proto:!0,forced:!Qvt("includes")},{includes:function(r){return!!~zvt(v6(kvt(this)),v6(Nvt(r)),arguments.length>1?arguments[1]:void 0)}});var Hvt=hd,Vvt=Array.isArray||function(r){return Hvt(r)==="Array"},Gvt=Ko,jvt=Ji,qvt=Vvt,Kvt=jvt([].reverse),b6=[1,2];Gvt({target:"Array",proto:!0,forced:String(b6)===String(b6.reverse())},{reverse:function(){return qvt(this)&&(this.length=this.length),Kvt(this)}});/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var w6=function(r,t){return(w6=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])})(r,t)};function x6(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=r}w6(r,t),r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function $vt(r){var t="";Array.isArray(r)||(r=[r]);for(var e=0;e<r.length;e++){var n=r[e];if(n.type===Ue.CLOSE_PATH)t+="z";else if(n.type===Ue.HORIZ_LINE_TO)t+=(n.relative?"h":"H")+n.x;else if(n.type===Ue.VERT_LINE_TO)t+=(n.relative?"v":"V")+n.y;else if(n.type===Ue.MOVE_TO)t+=(n.relative?"m":"M")+n.x+" "+n.y;else if(n.type===Ue.LINE_TO)t+=(n.relative?"l":"L")+n.x+" "+n.y;else if(n.type===Ue.CURVE_TO)t+=(n.relative?"c":"C")+n.x1+" "+n.y1+" "+n.x2+" "+n.y2+" "+n.x+" "+n.y;else if(n.type===Ue.SMOOTH_CURVE_TO)t+=(n.relative?"s":"S")+n.x2+" "+n.y2+" "+n.x+" "+n.y;else if(n.type===Ue.QUAD_TO)t+=(n.relative?"q":"Q")+n.x1+" "+n.y1+" "+n.x+" "+n.y;else if(n.type===Ue.SMOOTH_QUAD_TO)t+=(n.relative?"t":"T")+n.x+" "+n.y;else{if(n.type!==Ue.ARC)throw new Error('Unexpected command type "'+n.type+'" at index '+e+".");t+=(n.relative?"a":"A")+n.rX+" "+n.rY+" "+n.xRot+" "+ +n.lArcFlag+" "+ +n.sweepFlag+" "+n.x+" "+n.y}}return t}function CE(r,t){var e=r[0],n=r[1];return[e*Math.cos(t)-n*Math.sin(t),e*Math.sin(t)+n*Math.cos(t)]}function pc(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];for(var e=0;e<r.length;e++)if(typeof r[e]!="number")throw new Error("assertNumbers arguments["+e+"] is not a number. "+typeof r[e]+" == typeof "+r[e]);return!0}var uh=Math.PI;function EE(r,t,e){r.lArcFlag=r.lArcFlag===0?0:1,r.sweepFlag=r.sweepFlag===0?0:1;var n=r.rX,i=r.rY,s=r.x,a=r.y;n=Math.abs(r.rX),i=Math.abs(r.rY);var o=CE([(t-s)/2,(e-a)/2],-r.xRot/180*uh),d=o[0],f=o[1],_=Math.pow(d,2)/Math.pow(n,2)+Math.pow(f,2)/Math.pow(i,2);1<_&&(n*=Math.sqrt(_),i*=Math.sqrt(_)),r.rX=n,r.rY=i;var w=Math.pow(n,2)*Math.pow(f,2)+Math.pow(i,2)*Math.pow(d,2),x=(r.lArcFlag!==r.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(n,2)*Math.pow(i,2)-w)/w)),B=n*f/i*x,P=-i*d/n*x,R=CE([B,P],r.xRot/180*uh);r.cX=R[0]+(t+s)/2,r.cY=R[1]+(e+a)/2,r.phi1=Math.atan2((f-P)/i,(d-B)/n),r.phi2=Math.atan2((-f-P)/i,(-d-B)/n),r.sweepFlag===0&&r.phi2>r.phi1&&(r.phi2-=2*uh),r.sweepFlag===1&&r.phi2<r.phi1&&(r.phi2+=2*uh),r.phi1*=180/uh,r.phi2*=180/uh}function B6(r,t,e){pc(r,t,e);var n=r*r+t*t-e*e;if(0>n)return[];if(n===0)return[[r*e/(r*r+t*t),t*e/(r*r+t*t)]];var i=Math.sqrt(n);return[[(r*e+t*i)/(r*r+t*t),(t*e-r*i)/(r*r+t*t)],[(r*e-t*i)/(r*r+t*t),(t*e+r*i)/(r*r+t*t)]]}var os,iA=Math.PI/180;function C6(r,t,e){return(1-e)*r+e*t}function E6(r,t,e,n){return r+Math.cos(n/180*uh)*t+Math.sin(n/180*uh)*e}function S6(r,t,e,n){var i=1e-6,s=t-r,a=e-t,o=3*s+3*(n-e)-6*a,d=6*(a-s),f=3*s;return Math.abs(o)<i?[-f/d]:function(_,w,x){var B=_*_/4-w;if(B<-x)return[];if(B<=x)return[-_/2];var P=Math.sqrt(B);return[-_/2-P,-_/2+P]}(d/o,f/o,i)}function T6(r,t,e,n,i){var s=1-i;return r*(s*s*s)+t*(3*s*s*i)+e*(3*s*i*i)+n*(i*i*i)}(function(r){function t(){return i(function(o,d,f){return o.relative&&(o.x1!==void 0&&(o.x1+=d),o.y1!==void 0&&(o.y1+=f),o.x2!==void 0&&(o.x2+=d),o.y2!==void 0&&(o.y2+=f),o.x!==void 0&&(o.x+=d),o.y!==void 0&&(o.y+=f),o.relative=!1),o})}function e(){var o=NaN,d=NaN,f=NaN,_=NaN;return i(function(w,x,B){return w.type&Ue.SMOOTH_CURVE_TO&&(w.type=Ue.CURVE_TO,o=isNaN(o)?x:o,d=isNaN(d)?B:d,w.x1=w.relative?x-o:2*x-o,w.y1=w.relative?B-d:2*B-d),w.type&Ue.CURVE_TO?(o=w.relative?x+w.x2:w.x2,d=w.relative?B+w.y2:w.y2):(o=NaN,d=NaN),w.type&Ue.SMOOTH_QUAD_TO&&(w.type=Ue.QUAD_TO,f=isNaN(f)?x:f,_=isNaN(_)?B:_,w.x1=w.relative?x-f:2*x-f,w.y1=w.relative?B-_:2*B-_),w.type&Ue.QUAD_TO?(f=w.relative?x+w.x1:w.x1,_=w.relative?B+w.y1:w.y1):(f=NaN,_=NaN),w})}function n(){var o=NaN,d=NaN;return i(function(f,_,w){if(f.type&Ue.SMOOTH_QUAD_TO&&(f.type=Ue.QUAD_TO,o=isNaN(o)?_:o,d=isNaN(d)?w:d,f.x1=f.relative?_-o:2*_-o,f.y1=f.relative?w-d:2*w-d),f.type&Ue.QUAD_TO){o=f.relative?_+f.x1:f.x1,d=f.relative?w+f.y1:f.y1;var x=f.x1,B=f.y1;f.type=Ue.CURVE_TO,f.x1=((f.relative?0:_)+2*x)/3,f.y1=((f.relative?0:w)+2*B)/3,f.x2=(f.x+2*x)/3,f.y2=(f.y+2*B)/3}else o=NaN,d=NaN;return f})}function i(o){var d=0,f=0,_=NaN,w=NaN;return function(x){if(isNaN(_)&&!(x.type&Ue.MOVE_TO))throw new Error("path must start with moveto");var B=o(x,d,f,_,w);return x.type&Ue.CLOSE_PATH&&(d=_,f=w),x.x!==void 0&&(d=x.relative?d+x.x:x.x),x.y!==void 0&&(f=x.relative?f+x.y:x.y),x.type&Ue.MOVE_TO&&(_=d,w=f),B}}function s(o,d,f,_,w,x){return pc(o,d,f,_,w,x),i(function(B,P,R,N){var Q=B.x1,V=B.x2,W=B.relative&&!isNaN(N),et=B.x!==void 0?B.x:W?0:P,ct=B.y!==void 0?B.y:W?0:R;function dt(it){return it*it}B.type&Ue.HORIZ_LINE_TO&&d!==0&&(B.type=Ue.LINE_TO,B.y=B.relative?0:R),B.type&Ue.VERT_LINE_TO&&f!==0&&(B.type=Ue.LINE_TO,B.x=B.relative?0:P),B.x!==void 0&&(B.x=B.x*o+ct*f+(W?0:w)),B.y!==void 0&&(B.y=et*d+B.y*_+(W?0:x)),B.x1!==void 0&&(B.x1=B.x1*o+B.y1*f+(W?0:w)),B.y1!==void 0&&(B.y1=Q*d+B.y1*_+(W?0:x)),B.x2!==void 0&&(B.x2=B.x2*o+B.y2*f+(W?0:w)),B.y2!==void 0&&(B.y2=V*d+B.y2*_+(W?0:x));var gt=o*_-d*f;if(B.xRot!==void 0&&(o!==1||d!==0||f!==0||_!==1))if(gt===0)delete B.rX,delete B.rY,delete B.xRot,delete B.lArcFlag,delete B.sweepFlag,B.type=Ue.LINE_TO;else{var ht=B.xRot*Math.PI/180,It=Math.sin(ht),St=Math.cos(ht),ot=1/dt(B.rX),at=1/dt(B.rY),bt=dt(St)*ot+dt(It)*at,vt=2*It*St*(ot-at),$t=dt(It)*ot+dt(St)*at,Wt=bt*_*_-vt*d*_+$t*d*d,Jt=vt*(o*_+d*f)-2*(bt*f*_+$t*o*d),qt=bt*f*f-vt*o*f+$t*o*o,te=(Math.atan2(Jt,Wt-qt)+Math.PI)%Math.PI/2,Yt=Math.sin(te),be=Math.cos(te);B.rX=Math.abs(gt)/Math.sqrt(Wt*dt(be)+Jt*Yt*be+qt*dt(Yt)),B.rY=Math.abs(gt)/Math.sqrt(Wt*dt(Yt)-Jt*Yt*be+qt*dt(be)),B.xRot=180*te/Math.PI}return B.sweepFlag!==void 0&&0>gt&&(B.sweepFlag=+!B.sweepFlag),B})}function a(){return function(o){var d={};for(var f in o)d[f]=o[f];return d}}r.ROUND=function(o){function d(f){return Math.round(f*o)/o}return o===void 0&&(o=1e13),pc(o),function(f){return f.x1!==void 0&&(f.x1=d(f.x1)),f.y1!==void 0&&(f.y1=d(f.y1)),f.x2!==void 0&&(f.x2=d(f.x2)),f.y2!==void 0&&(f.y2=d(f.y2)),f.x!==void 0&&(f.x=d(f.x)),f.y!==void 0&&(f.y=d(f.y)),f.rX!==void 0&&(f.rX=d(f.rX)),f.rY!==void 0&&(f.rY=d(f.rY)),f}},r.TO_ABS=t,r.TO_REL=function(){return i(function(o,d,f){return o.relative||(o.x1!==void 0&&(o.x1-=d),o.y1!==void 0&&(o.y1-=f),o.x2!==void 0&&(o.x2-=d),o.y2!==void 0&&(o.y2-=f),o.x!==void 0&&(o.x-=d),o.y!==void 0&&(o.y-=f),o.relative=!0),o})},r.NORMALIZE_HVZ=function(o,d,f){return o===void 0&&(o=!0),d===void 0&&(d=!0),f===void 0&&(f=!0),i(function(_,w,x,B,P){if(isNaN(B)&&!(_.type&Ue.MOVE_TO))throw new Error("path must start with moveto");return d&&_.type&Ue.HORIZ_LINE_TO&&(_.type=Ue.LINE_TO,_.y=_.relative?0:x),f&&_.type&Ue.VERT_LINE_TO&&(_.type=Ue.LINE_TO,_.x=_.relative?0:w),o&&_.type&Ue.CLOSE_PATH&&(_.type=Ue.LINE_TO,_.x=_.relative?B-w:B,_.y=_.relative?P-x:P),_.type&Ue.ARC&&(_.rX===0||_.rY===0)&&(_.type=Ue.LINE_TO,delete _.rX,delete _.rY,delete _.xRot,delete _.lArcFlag,delete _.sweepFlag),_})},r.NORMALIZE_ST=e,r.QT_TO_C=n,r.INFO=i,r.SANITIZE=function(o){o===void 0&&(o=0),pc(o);var d=NaN,f=NaN,_=NaN,w=NaN;return i(function(x,B,P,R,N){var Q=Math.abs,V=!1,W=0,et=0;if(x.type&Ue.SMOOTH_CURVE_TO&&(W=isNaN(d)?0:B-d,et=isNaN(f)?0:P-f),x.type&(Ue.CURVE_TO|Ue.SMOOTH_CURVE_TO)?(d=x.relative?B+x.x2:x.x2,f=x.relative?P+x.y2:x.y2):(d=NaN,f=NaN),x.type&Ue.SMOOTH_QUAD_TO?(_=isNaN(_)?B:2*B-_,w=isNaN(w)?P:2*P-w):x.type&Ue.QUAD_TO?(_=x.relative?B+x.x1:x.x1,w=x.relative?P+x.y1:x.y2):(_=NaN,w=NaN),x.type&Ue.LINE_COMMANDS||x.type&Ue.ARC&&(x.rX===0||x.rY===0||!x.lArcFlag)||x.type&Ue.CURVE_TO||x.type&Ue.SMOOTH_CURVE_TO||x.type&Ue.QUAD_TO||x.type&Ue.SMOOTH_QUAD_TO){var ct=x.x===void 0?0:x.relative?x.x:x.x-B,dt=x.y===void 0?0:x.relative?x.y:x.y-P;W=isNaN(_)?x.x1===void 0?W:x.relative?x.x:x.x1-B:_-B,et=isNaN(w)?x.y1===void 0?et:x.relative?x.y:x.y1-P:w-P;var gt=x.x2===void 0?0:x.relative?x.x:x.x2-B,ht=x.y2===void 0?0:x.relative?x.y:x.y2-P;Q(ct)<=o&&Q(dt)<=o&&Q(W)<=o&&Q(et)<=o&&Q(gt)<=o&&Q(ht)<=o&&(V=!0)}return x.type&Ue.CLOSE_PATH&&Q(B-R)<=o&&Q(P-N)<=o&&(V=!0),V?[]:x})},r.MATRIX=s,r.ROTATE=function(o,d,f){d===void 0&&(d=0),f===void 0&&(f=0),pc(o,d,f);var _=Math.sin(o),w=Math.cos(o);return s(w,_,-_,w,d-d*w+f*_,f-d*_-f*w)},r.TRANSLATE=function(o,d){return d===void 0&&(d=0),pc(o,d),s(1,0,0,1,o,d)},r.SCALE=function(o,d){return d===void 0&&(d=o),pc(o,d),s(o,0,0,d,0,0)},r.SKEW_X=function(o){return pc(o),s(1,0,Math.atan(o),1,0,0)},r.SKEW_Y=function(o){return pc(o),s(1,Math.atan(o),0,1,0,0)},r.X_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),pc(o),s(-1,0,0,1,o,0)},r.Y_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),pc(o),s(1,0,0,-1,0,o)},r.A_TO_C=function(){return i(function(o,d,f){return Ue.ARC===o.type?function(_,w,x){var B,P,R,N;_.cX||EE(_,w,x);for(var Q=Math.min(_.phi1,_.phi2),V=Math.max(_.phi1,_.phi2)-Q,W=Math.ceil(V/90),et=new Array(W),ct=w,dt=x,gt=0;gt<W;gt++){var ht=C6(_.phi1,_.phi2,gt/W),It=C6(_.phi1,_.phi2,(gt+1)/W),St=It-ht,ot=4/3*Math.tan(St*iA/4),at=[Math.cos(ht*iA)-ot*Math.sin(ht*iA),Math.sin(ht*iA)+ot*Math.cos(ht*iA)],bt=at[0],vt=at[1],$t=[Math.cos(It*iA),Math.sin(It*iA)],Wt=$t[0],Jt=$t[1],qt=[Wt+ot*Math.sin(It*iA),Jt-ot*Math.cos(It*iA)],te=qt[0],Yt=qt[1];et[gt]={relative:_.relative,type:Ue.CURVE_TO};var be=function(it,wt){var Ft=CE([it*_.rX,wt*_.rY],_.xRot),Ut=Ft[0],jt=Ft[1];return[_.cX+Ut,_.cY+jt]};B=be(bt,vt),et[gt].x1=B[0],et[gt].y1=B[1],P=be(te,Yt),et[gt].x2=P[0],et[gt].y2=P[1],R=be(Wt,Jt),et[gt].x=R[0],et[gt].y=R[1],_.relative&&(et[gt].x1-=ct,et[gt].y1-=dt,et[gt].x2-=ct,et[gt].y2-=dt,et[gt].x-=ct,et[gt].y-=dt),ct=(N=[et[gt].x,et[gt].y])[0],dt=N[1]}return et}(o,o.relative?0:d,o.relative?0:f):o})},r.ANNOTATE_ARCS=function(){return i(function(o,d,f){return o.relative&&(d=0,f=0),Ue.ARC===o.type&&EE(o,d,f),o})},r.CLONE=a,r.CALCULATE_BOUNDS=function(){var o=function(x){var B={};for(var P in x)B[P]=x[P];return B},d=t(),f=n(),_=e(),w=i(function(x,B,P){var R=_(f(d(o(x))));function N(Yt){Yt>w.maxX&&(w.maxX=Yt),Yt<w.minX&&(w.minX=Yt)}function Q(Yt){Yt>w.maxY&&(w.maxY=Yt),Yt<w.minY&&(w.minY=Yt)}if(R.type&Ue.DRAWING_COMMANDS&&(N(B),Q(P)),R.type&Ue.HORIZ_LINE_TO&&N(R.x),R.type&Ue.VERT_LINE_TO&&Q(R.y),R.type&Ue.LINE_TO&&(N(R.x),Q(R.y)),R.type&Ue.CURVE_TO){N(R.x),Q(R.y);for(var V=0,W=S6(B,R.x1,R.x2,R.x);V<W.length;V++)0<(te=W[V])&&1>te&&N(T6(B,R.x1,R.x2,R.x,te));for(var et=0,ct=S6(P,R.y1,R.y2,R.y);et<ct.length;et++)0<(te=ct[et])&&1>te&&Q(T6(P,R.y1,R.y2,R.y,te))}if(R.type&Ue.ARC){N(R.x),Q(R.y),EE(R,B,P);for(var dt=R.xRot/180*Math.PI,gt=Math.cos(dt)*R.rX,ht=Math.sin(dt)*R.rX,It=-Math.sin(dt)*R.rY,St=Math.cos(dt)*R.rY,ot=R.phi1<R.phi2?[R.phi1,R.phi2]:-180>R.phi2?[R.phi2+360,R.phi1+360]:[R.phi2,R.phi1],at=ot[0],bt=ot[1],vt=function(Yt){var be=Yt[0],it=Yt[1],wt=180*Math.atan2(it,be)/Math.PI;return wt<at?wt+360:wt},$t=0,Wt=B6(It,-gt,0).map(vt);$t<Wt.length;$t++)(te=Wt[$t])>at&&te<bt&&N(E6(R.cX,gt,It,te));for(var Jt=0,qt=B6(St,-ht,0).map(vt);Jt<qt.length;Jt++){var te;(te=qt[Jt])>at&&te<bt&&Q(E6(R.cY,ht,St,te))}}return x});return w.minX=1/0,w.maxX=-1/0,w.minY=1/0,w.maxY=-1/0,w}})(os||(os={}));var gc,I6=function(){function r(){}return r.prototype.round=function(t){return this.transform(os.ROUND(t))},r.prototype.toAbs=function(){return this.transform(os.TO_ABS())},r.prototype.toRel=function(){return this.transform(os.TO_REL())},r.prototype.normalizeHVZ=function(t,e,n){return this.transform(os.NORMALIZE_HVZ(t,e,n))},r.prototype.normalizeST=function(){return this.transform(os.NORMALIZE_ST())},r.prototype.qtToC=function(){return this.transform(os.QT_TO_C())},r.prototype.aToC=function(){return this.transform(os.A_TO_C())},r.prototype.sanitize=function(t){return this.transform(os.SANITIZE(t))},r.prototype.translate=function(t,e){return this.transform(os.TRANSLATE(t,e))},r.prototype.scale=function(t,e){return this.transform(os.SCALE(t,e))},r.prototype.rotate=function(t,e,n){return this.transform(os.ROTATE(t,e,n))},r.prototype.matrix=function(t,e,n,i,s,a){return this.transform(os.MATRIX(t,e,n,i,s,a))},r.prototype.skewX=function(t){return this.transform(os.SKEW_X(t))},r.prototype.skewY=function(t){return this.transform(os.SKEW_Y(t))},r.prototype.xSymmetry=function(t){return this.transform(os.X_AXIS_SYMMETRY(t))},r.prototype.ySymmetry=function(t){return this.transform(os.Y_AXIS_SYMMETRY(t))},r.prototype.annotateArcs=function(){return this.transform(os.ANNOTATE_ARCS())},r}(),Wvt=function(r){return r===" "||r==="	"||r==="\r"||r===`
`},F6=function(r){return 48<=r.charCodeAt(0)&&r.charCodeAt(0)<=57},Xvt=function(r){function t(){var e=r.call(this)||this;return e.curNumber="",e.curCommandType=-1,e.curCommandRelative=!1,e.canParseCommandOrComma=!0,e.curNumberHasExp=!1,e.curNumberHasExpDigits=!1,e.curNumberHasDecimal=!1,e.curArgs=[],e}return x6(t,r),t.prototype.finish=function(e){if(e===void 0&&(e=[]),this.parse(" ",e),this.curArgs.length!==0||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return e},t.prototype.parse=function(e,n){var i=this;n===void 0&&(n=[]);for(var s=function(w){n.push(w),i.curArgs.length=0,i.canParseCommandOrComma=!0},a=0;a<e.length;a++){var o=e[a],d=!(this.curCommandType!==Ue.ARC||this.curArgs.length!==3&&this.curArgs.length!==4||this.curNumber.length!==1||this.curNumber!=="0"&&this.curNumber!=="1"),f=F6(o)&&(this.curNumber==="0"&&o==="0"||d);if(!F6(o)||f)if(o!=="e"&&o!=="E")if(o!=="-"&&o!=="+"||!this.curNumberHasExp||this.curNumberHasExpDigits)if(o!=="."||this.curNumberHasExp||this.curNumberHasDecimal||d){if(this.curNumber&&this.curCommandType!==-1){var _=Number(this.curNumber);if(isNaN(_))throw new SyntaxError("Invalid number ending at "+a);if(this.curCommandType===Ue.ARC){if(this.curArgs.length===0||this.curArgs.length===1){if(0>_)throw new SyntaxError('Expected positive number, got "'+_+'" at index "'+a+'"')}else if((this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber!=="0"&&this.curNumber!=="1")throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+a+'"')}this.curArgs.push(_),this.curArgs.length===Jvt[this.curCommandType]&&(Ue.HORIZ_LINE_TO===this.curCommandType?s({type:Ue.HORIZ_LINE_TO,relative:this.curCommandRelative,x:_}):Ue.VERT_LINE_TO===this.curCommandType?s({type:Ue.VERT_LINE_TO,relative:this.curCommandRelative,y:_}):this.curCommandType===Ue.MOVE_TO||this.curCommandType===Ue.LINE_TO||this.curCommandType===Ue.SMOOTH_QUAD_TO?(s({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),Ue.MOVE_TO===this.curCommandType&&(this.curCommandType=Ue.LINE_TO)):this.curCommandType===Ue.CURVE_TO?s({type:Ue.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===Ue.SMOOTH_CURVE_TO?s({type:Ue.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===Ue.QUAD_TO?s({type:Ue.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===Ue.ARC&&s({type:Ue.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!Wvt(o))if(o===","&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if(o!=="+"&&o!=="-"&&o!==".")if(f)this.curNumber=o,this.curNumberHasDecimal=!1;else{if(this.curArgs.length!==0)throw new SyntaxError("Unterminated command at index "+a+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+o+'" at index '+a+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,o!=="z"&&o!=="Z")if(o==="h"||o==="H")this.curCommandType=Ue.HORIZ_LINE_TO,this.curCommandRelative=o==="h";else if(o==="v"||o==="V")this.curCommandType=Ue.VERT_LINE_TO,this.curCommandRelative=o==="v";else if(o==="m"||o==="M")this.curCommandType=Ue.MOVE_TO,this.curCommandRelative=o==="m";else if(o==="l"||o==="L")this.curCommandType=Ue.LINE_TO,this.curCommandRelative=o==="l";else if(o==="c"||o==="C")this.curCommandType=Ue.CURVE_TO,this.curCommandRelative=o==="c";else if(o==="s"||o==="S")this.curCommandType=Ue.SMOOTH_CURVE_TO,this.curCommandRelative=o==="s";else if(o==="q"||o==="Q")this.curCommandType=Ue.QUAD_TO,this.curCommandRelative=o==="q";else if(o==="t"||o==="T")this.curCommandType=Ue.SMOOTH_QUAD_TO,this.curCommandRelative=o==="t";else{if(o!=="a"&&o!=="A")throw new SyntaxError('Unexpected character "'+o+'" at index '+a+".");this.curCommandType=Ue.ARC,this.curCommandRelative=o==="a"}else n.push({type:Ue.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=o,this.curNumberHasDecimal=o==="."}else this.curNumber+=o,this.curNumberHasDecimal=!0;else this.curNumber+=o;else this.curNumber+=o,this.curNumberHasExp=!0;else this.curNumber+=o,this.curNumberHasExpDigits=this.curNumberHasExp}return n},t.prototype.transform=function(e){return Object.create(this,{parse:{value:function(n,i){i===void 0&&(i=[]);for(var s=0,a=Object.getPrototypeOf(this).parse.call(this,n);s<a.length;s++){var o=a[s],d=e(o);Array.isArray(d)?i.push.apply(i,d):i.push(d)}return i}}})},t}(I6),Ue=function(r){function t(e){var n=r.call(this)||this;return n.commands=typeof e=="string"?t.parse(e):e,n}return x6(t,r),t.prototype.encode=function(){return t.encode(this.commands)},t.prototype.getBounds=function(){var e=os.CALCULATE_BOUNDS();return this.transform(e),e},t.prototype.transform=function(e){for(var n=[],i=0,s=this.commands;i<s.length;i++){var a=e(s[i]);Array.isArray(a)?n.push.apply(n,a):n.push(a)}return this.commands=n,this},t.encode=function(e){return $vt(e)},t.parse=function(e){var n=new Xvt,i=[];return n.parse(e,i),n.finish(i),i},t.CLOSE_PATH=1,t.MOVE_TO=2,t.HORIZ_LINE_TO=4,t.VERT_LINE_TO=8,t.LINE_TO=16,t.CURVE_TO=32,t.SMOOTH_CURVE_TO=64,t.QUAD_TO=128,t.SMOOTH_QUAD_TO=256,t.ARC=512,t.LINE_COMMANDS=t.LINE_TO|t.HORIZ_LINE_TO|t.VERT_LINE_TO,t.DRAWING_COMMANDS=t.HORIZ_LINE_TO|t.VERT_LINE_TO|t.LINE_TO|t.CURVE_TO|t.SMOOTH_CURVE_TO|t.QUAD_TO|t.SMOOTH_QUAD_TO|t.ARC,t}(I6),Jvt=((gc={})[Ue.MOVE_TO]=2,gc[Ue.LINE_TO]=2,gc[Ue.HORIZ_LINE_TO]=1,gc[Ue.VERT_LINE_TO]=1,gc[Ue.CLOSE_PATH]=0,gc[Ue.QUAD_TO]=4,gc[Ue.SMOOTH_QUAD_TO]=2,gc[Ue.CURVE_TO]=6,gc[Ue.SMOOTH_CURVE_TO]=4,gc[Ue.ARC]=7,gc),Yvt=Zs,Zvt=fc,tbt=l_,ebt=AD,L6=RegExp.prototype,rbt=function(r){var t=r.flags;return t===void 0&&!("flags"in L6)&&!Zvt(r,"flags")&&tbt(L6,r)?Yvt(ebt,r):t},nbt=p_.PROPER,ibt=pd,sbt=qo,P6=Zc,obt=Xi,abt=rbt,SE="toString",M6=RegExp.prototype,R6=M6[SE],lbt=obt(function(){return R6.call({source:"a",flags:"b"})!=="/a/b"}),cbt=nbt&&R6.name!==SE;(lbt||cbt)&&ibt(M6,SE,function(){var r=sbt(this),t=P6(r.source),e=P6(abt(r));return"/"+t+"/"+e},{unsafe:!0});function K_(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?K_=function(t){return typeof t}:K_=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K_(r)}function ubt(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Abt=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],hbt=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function dbt(r,t,e,n,i){if(typeof r=="string"&&(r=document.getElementById(r)),!r||K_(r)!=="object"||!("getContext"in r))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var s=r.getContext("2d");try{return s.getImageData(t,e,n,i)}catch(a){throw new Error("unable to access image data: "+a)}}function fbt(r,t,e,n,i,s){if(!(isNaN(s)||s<1)){s|=0;var a=dbt(r,t,e,n,i);a=pbt(a,t,e,n,i,s),r.getContext("2d").putImageData(a,t,e)}}function pbt(r,t,e,n,i,s){for(var a=r.data,o=2*s+1,d=n-1,f=i-1,_=s+1,w=_*(_+1)/2,x=new U6,B=x,P,R=1;R<o;R++)B=B.next=new U6,R===_&&(P=B);B.next=x;for(var N=null,Q=null,V=0,W=0,et=Abt[s],ct=hbt[s],dt=0;dt<i;dt++){B=x;for(var gt=a[W],ht=a[W+1],It=a[W+2],St=a[W+3],ot=0;ot<_;ot++)B.r=gt,B.g=ht,B.b=It,B.a=St,B=B.next;for(var at=0,bt=0,vt=0,$t=0,Wt=_*gt,Jt=_*ht,qt=_*It,te=_*St,Yt=w*gt,be=w*ht,it=w*It,wt=w*St,Ft=1;Ft<_;Ft++){var Ut=W+((d<Ft?d:Ft)<<2),jt=a[Ut],Vt=a[Ut+1],re=a[Ut+2],Zt=a[Ut+3],Be=_-Ft;Yt+=(B.r=jt)*Be,be+=(B.g=Vt)*Be,it+=(B.b=re)*Be,wt+=(B.a=Zt)*Be,at+=jt,bt+=Vt,vt+=re,$t+=Zt,B=B.next}N=x,Q=P;for(var Ie=0;Ie<n;Ie++){var ke=wt*et>>>ct;if(a[W+3]=ke,ke!==0){var He=255/ke;a[W]=(Yt*et>>>ct)*He,a[W+1]=(be*et>>>ct)*He,a[W+2]=(it*et>>>ct)*He}else a[W]=a[W+1]=a[W+2]=0;Yt-=Wt,be-=Jt,it-=qt,wt-=te,Wt-=N.r,Jt-=N.g,qt-=N.b,te-=N.a;var Ke=Ie+s+1;Ke=V+(Ke<d?Ke:d)<<2,at+=N.r=a[Ke],bt+=N.g=a[Ke+1],vt+=N.b=a[Ke+2],$t+=N.a=a[Ke+3],Yt+=at,be+=bt,it+=vt,wt+=$t,N=N.next;var le=Q,st=le.r,pr=le.g,Ye=le.b,ue=le.a;Wt+=st,Jt+=pr,qt+=Ye,te+=ue,at-=st,bt-=pr,vt-=Ye,$t-=ue,Q=Q.next,W+=4}V+=n}for(var ye=0;ye<n;ye++){W=ye<<2;var Le=a[W],Oe=a[W+1],We=a[W+2],cr=a[W+3],yr=_*Le,Fr=_*Oe,Ur=_*We,de=_*cr,ur=w*Le,_r=w*Oe,De=w*We,gn=w*cr;B=x;for(var pe=0;pe<_;pe++)B.r=Le,B.g=Oe,B.b=We,B.a=cr,B=B.next;for(var gr=n,Qe=0,Mr=0,_n=0,ze=0,Nn=1;Nn<=s;Nn++){W=gr+ye<<2;var sn=_-Nn;ur+=(B.r=Le=a[W])*sn,_r+=(B.g=Oe=a[W+1])*sn,De+=(B.b=We=a[W+2])*sn,gn+=(B.a=cr=a[W+3])*sn,ze+=Le,Qe+=Oe,Mr+=We,_n+=cr,B=B.next,Nn<f&&(gr+=n)}W=ye,N=x,Q=P;for(var vn=0;vn<i;vn++){var cn=W<<2;a[cn+3]=cr=gn*et>>>ct,cr>0?(cr=255/cr,a[cn]=(ur*et>>>ct)*cr,a[cn+1]=(_r*et>>>ct)*cr,a[cn+2]=(De*et>>>ct)*cr):a[cn]=a[cn+1]=a[cn+2]=0,ur-=yr,_r-=Fr,De-=Ur,gn-=de,yr-=N.r,Fr-=N.g,Ur-=N.b,de-=N.a,cn=ye+((cn=vn+_)<f?cn:f)*n<<2,ur+=ze+=N.r=a[cn],_r+=Qe+=N.g=a[cn+1],De+=Mr+=N.b=a[cn+2],gn+=_n+=N.a=a[cn+3],N=N.next,yr+=Le=Q.r,Fr+=Oe=Q.g,Ur+=We=Q.b,de+=cr=Q.a,ze-=Le,Qe-=Oe,Mr-=We,_n-=cr,Q=Q.next,W+=n}}return r}var U6=function r(){ubt(this,r),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};function gbt(){var{DOMParser:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:r,createCanvas(e,n){return new OffscreenCanvas(e,n)},createImage(e){return rA(function*(){var n=yield fetch(e),i=yield n.blob(),s=yield createImageBitmap(i);return s})()}};return(typeof DOMParser<"u"||typeof r>"u")&&Reflect.deleteProperty(t,"DOMParser"),t}function mbt(r){var{DOMParser:t,canvas:e,fetch:n}=r;return{window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:t,fetch:n,createCanvas:e.createCanvas,createImage:e.loadImage}}var ybt=Object.freeze({__proto__:null,offscreen:gbt,node:mbt});function vd(r){return r.replace(/(?!\u3000)\s+/gm," ")}function O6(r){return r.replace(/^[\n \t]+/,"")}function D6(r){return r.replace(/[\n \t]+$/,"")}function ya(r){var t=(r||"").match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm)||[];return t.map(parseFloat)}var _bt=/^[A-Z-]+$/;function N6(r){return _bt.test(r)?r.toLowerCase():r}function TE(r){var t=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(r)||[];return t[2]||t[3]||t[4]}function k6(r){if(!r.startsWith("rgb"))return r;var t=3,e=r.replace(/\d+(\.\d+)?/g,(n,i)=>t--&&i?String(Math.round(parseFloat(n))):n);return e}var vbt=/(\[[^\]]+\])/g,bbt=/(#[^\s+>~.[:]+)/g,wbt=/(\.[^\s+>~.[:]+)/g,xbt=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,Bbt=/(:[\w-]+\([^)]*\))/gi,Cbt=/(:[^\s+>~.[:]+)/g,Ebt=/([^\s+>~.[:]+)/g;function bd(r,t){var e=t.exec(r);return e?[r.replace(t," "),e.length]:[r,0]}function Q6(r){var t=[0,0,0],e=r.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),n=0;return[e,n]=bd(e,vbt),t[1]+=n,[e,n]=bd(e,bbt),t[0]+=n,[e,n]=bd(e,wbt),t[1]+=n,[e,n]=bd(e,xbt),t[2]+=n,[e,n]=bd(e,Bbt),t[1]+=n,[e,n]=bd(e,Cbt),t[1]+=n,e=e.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),[e,n]=bd(e,Ebt),t[2]+=n,t.join("")}var wd=1e-8;function IE(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2))}function $_(r,t){return(r[0]*t[0]+r[1]*t[1])/(IE(r)*IE(t))}function FE(r,t){return(r[0]*t[1]<r[1]*t[0]?-1:1)*Math.acos($_(r,t))}function LE(r){return r*r*r}function PE(r){return 3*r*r*(1-r)}function ME(r){return 3*r*(1-r)*(1-r)}function RE(r){return(1-r)*(1-r)*(1-r)}function UE(r){return r*r}function OE(r){return 2*r*(1-r)}function DE(r){return(1-r)*(1-r)}class Rr{constructor(t,e,n){this.document=t,this.name=e,this.value=n,this.isNormalizedColor=!1}static empty(t){return new Rr(t,"EMPTY","")}split(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:" ",{document:e,name:n}=this;return vd(this.getString()).trim().split(t).map(i=>new Rr(e,n,i))}hasValue(t){var{value:e}=this;return e!==null&&e!==""&&(t||e!==0)&&typeof e<"u"}isString(t){var{value:e}=this,n=typeof e=="string";return!n||!t?n:t.test(e)}isUrlDefinition(){return this.isString(/^url\(/)}isPixels(){if(!this.hasValue())return!1;var t=this.getString();switch(!0){case t.endsWith("px"):case/^[0-9]+$/.test(t):return!0;default:return!1}}setValue(t){return this.value=t,this}getValue(t){return typeof t>"u"||this.hasValue()?this.value:t}getNumber(t){if(!this.hasValue())return typeof t>"u"?0:parseFloat(t);var{value:e}=this,n=parseFloat(e);return this.isString(/%$/)&&(n/=100),n}getString(t){return typeof t>"u"||this.hasValue()?typeof this.value>"u"?"":String(this.value):String(t)}getColor(t){var e=this.getString(t);return this.isNormalizedColor||(this.isNormalizedColor=!0,e=k6(e),this.value=e),e}getDpi(){return 96}getRem(){return this.document.rootEmSize}getEm(){return this.document.emSize}getUnits(){return this.getString().replace(/[0-9.-]/g,"")}getPixels(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!this.hasValue())return 0;var[n,i]=typeof t=="boolean"?[void 0,t]:[t],{viewPort:s}=this.document.screen;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(s.computeSize("x"),s.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(s.computeSize("x"),s.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*s.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*s.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return this.getNumber()*15;case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case(this.isString(/%$/)&&i):return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*s.computeSize(n);default:{var a=this.getNumber();return e&&a<1?a*s.computeSize(n):a}}}getMilliseconds(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():this.getNumber()*1e3:0}getRadians(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}getDefinition(){var t=this.getString(),e=/#([^)'"]+)/.exec(t);return e&&(e=e[1]),e||(e=t),this.document.definitions[e]}getFillStyleDefinition(t,e){var n=this.getDefinition();if(!n)return null;if(typeof n.createGradient=="function")return n.createGradient(this.document.ctx,t,e);if(typeof n.createPattern=="function"){if(n.getHrefAttribute().hasValue()){var i=n.getAttribute("patternTransform");n=n.getHrefAttribute().getDefinition(),i.hasValue()&&n.getAttribute("patternTransform",!0).setValue(i.value)}return n.createPattern(this.document.ctx,t,e)}return null}getTextBaseline(){return this.hasValue()?Rr.textBaselineMapping[this.getString()]:null}addOpacity(t){for(var e=this.getColor(),n=e.length,i=0,s=0;s<n&&(e[s]===","&&i++,i!==3);s++);if(t.hasValue()&&this.isString()&&i!==3){var a=new xE(e);a.ok&&(a.alpha=t.getNumber(),e=a.toRGBA())}return new Rr(this.document,this.name,e)}}Rr.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};class z6{constructor(){this.viewPorts=[]}clear(){this.viewPorts=[]}setCurrent(t,e){this.viewPorts.push({width:t,height:e})}removeCurrent(){this.viewPorts.pop()}getCurrent(){var{viewPorts:t}=this;return t[t.length-1]}get width(){return this.getCurrent().width}get height(){return this.getCurrent().height}computeSize(t){return typeof t=="number"?t:t==="x"?this.width:t==="y"?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}}class Qi{constructor(t,e){this.x=t,this.y=e}static parse(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,[n=e,i=e]=ya(t);return new Qi(n,i)}static parseScale(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,[n=e,i=n]=ya(t);return new Qi(n,i)}static parsePath(t){for(var e=ya(t),n=e.length,i=[],s=0;s<n;s+=2)i.push(new Qi(e[s],e[s+1]));return i}angleTo(t){return Math.atan2(t.y-this.y,t.x-this.x)}applyTransform(t){var{x:e,y:n}=this,i=e*t[0]+n*t[2]+t[4],s=e*t[1]+n*t[3]+t[5];this.x=i,this.y=s}}class H6{constructor(t){this.screen=t,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}isWorking(){return this.working}start(){if(!this.working){var{screen:t,onClick:e,onMouseMove:n}=this,i=t.ctx.canvas;i.onclick=e,i.onmousemove=n,this.working=!0}}stop(){if(this.working){var t=this.screen.ctx.canvas;this.working=!1,t.onclick=null,t.onmousemove=null}}hasEvents(){return this.working&&this.events.length>0}runEvents(){if(this.working){var{screen:t,events:e,eventElements:n}=this,{style:i}=t.ctx.canvas;i&&(i.cursor=""),e.forEach((s,a)=>{for(var{run:o}=s,d=n[a];d;)o(d),d=d.parent}),this.events=[],this.eventElements=[]}}checkPath(t,e){if(!(!this.working||!e)){var{events:n,eventElements:i}=this;n.forEach((s,a)=>{var{x:o,y:d}=s;!i[a]&&e.isPointInPath&&e.isPointInPath(o,d)&&(i[a]=t)})}}checkBoundingBox(t,e){if(!(!this.working||!e)){var{events:n,eventElements:i}=this;n.forEach((s,a)=>{var{x:o,y:d}=s;!i[a]&&e.isPointInBox(o,d)&&(i[a]=t)})}}mapXY(t,e){for(var{window:n,ctx:i}=this.screen,s=new Qi(t,e),a=i.canvas;a;)s.x-=a.offsetLeft,s.y-=a.offsetTop,a=a.offsetParent;return n.scrollX&&(s.x+=n.scrollX),n.scrollY&&(s.y+=n.scrollY),s}onClick(t){var{x:e,y:n}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onclick",x:e,y:n,run(i){i.onClick&&i.onClick()}})}onMouseMove(t){var{x:e,y:n}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onmousemove",x:e,y:n,run(i){i.onMouseMove&&i.onMouseMove()}})}}var V6=typeof window<"u"?window:null,G6=typeof fetch<"u"?fetch.bind(void 0):null;class zm{constructor(t){var{fetch:e=G6,window:n=V6}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.ctx=t,this.FRAMERATE=30,this.MAX_VIRTUAL_PIXELS=3e4,this.CLIENT_WIDTH=800,this.CLIENT_HEIGHT=600,this.viewPort=new z6,this.mouse=new H6(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=n,this.fetch=e}wait(t){this.waits.push(t)}ready(){return this.readyPromise?this.readyPromise:Promise.resolve()}isReady(){if(this.isReadyLock)return!0;var t=this.waits.every(e=>e());return t&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=t,t}setDefaults(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4}setViewBox(t){var{document:e,ctx:n,aspectRatio:i,width:s,desiredWidth:a,height:o,desiredHeight:d,minX:f=0,minY:_=0,refX:w,refY:x,clip:B=!1,clipX:P=0,clipY:R=0}=t,N=vd(i).replace(/^defer\s/,""),[Q,V]=N.split(" "),W=Q||"xMidYMid",et=V||"meet",ct=s/a,dt=o/d,gt=Math.min(ct,dt),ht=Math.max(ct,dt),It=a,St=d;et==="meet"&&(It*=gt,St*=gt),et==="slice"&&(It*=ht,St*=ht);var ot=new Rr(e,"refX",w),at=new Rr(e,"refY",x),bt=ot.hasValue()&&at.hasValue();if(bt&&n.translate(-gt*ot.getPixels("x"),-gt*at.getPixels("y")),B){var vt=gt*P,$t=gt*R;n.beginPath(),n.moveTo(vt,$t),n.lineTo(s,$t),n.lineTo(s,o),n.lineTo(vt,o),n.closePath(),n.clip()}if(!bt){var Wt=et==="meet"&&gt===dt,Jt=et==="slice"&&ht===dt,qt=et==="meet"&&gt===ct,te=et==="slice"&&ht===ct;W.startsWith("xMid")&&(Wt||Jt)&&n.translate(s/2-It/2,0),W.endsWith("YMid")&&(qt||te)&&n.translate(0,o/2-St/2),W.startsWith("xMax")&&(Wt||Jt)&&n.translate(s-It,0),W.endsWith("YMax")&&(qt||te)&&n.translate(0,o-St)}switch(!0){case W==="none":n.scale(ct,dt);break;case et==="meet":n.scale(gt,gt);break;case et==="slice":n.scale(ht,ht);break}n.translate(-f,-_)}start(t){var{enableRedraw:e=!1,ignoreMouse:n=!1,ignoreAnimation:i=!1,ignoreDimensions:s=!1,ignoreClear:a=!1,forceRedraw:o,scaleWidth:d,scaleHeight:f,offsetX:_,offsetY:w}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{FRAMERATE:x,mouse:B}=this,P=1e3/x;if(this.frameDuration=P,this.readyPromise=new Promise(W=>{this.resolveReady=W}),this.isReady()&&this.render(t,s,a,d,f,_,w),!!e){var R=Date.now(),N=R,Q=0,V=()=>{R=Date.now(),Q=R-N,Q>=P&&(N=R-Q%P,this.shouldUpdate(i,o)&&(this.render(t,s,a,d,f,_,w),B.runEvents())),this.intervalId=vE(V)};n||B.start(),this.intervalId=vE(V)}}stop(){this.intervalId&&(vE.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}shouldUpdate(t,e){if(!t){var{frameDuration:n}=this,i=this.animations.reduce((s,a)=>a.update(n)||s,!1);if(i)return!0}return!!(typeof e=="function"&&e()||!this.isReadyLock&&this.isReady()||this.mouse.hasEvents())}render(t,e,n,i,s,a,o){var{CLIENT_WIDTH:d,CLIENT_HEIGHT:f,viewPort:_,ctx:w,isFirstRender:x}=this,B=w.canvas;_.clear(),B.width&&B.height?_.setCurrent(B.width,B.height):_.setCurrent(d,f);var P=t.getStyle("width"),R=t.getStyle("height");!e&&(x||typeof i!="number"&&typeof s!="number")&&(P.hasValue()&&(B.width=P.getPixels("x"),B.style&&(B.style.width="".concat(B.width,"px"))),R.hasValue()&&(B.height=R.getPixels("y"),B.style&&(B.style.height="".concat(B.height,"px"))));var N=B.clientWidth||B.width,Q=B.clientHeight||B.height;if(e&&P.hasValue()&&R.hasValue()&&(N=P.getPixels("x"),Q=R.getPixels("y")),_.setCurrent(N,Q),typeof a=="number"&&t.getAttribute("x",!0).setValue(a),typeof o=="number"&&t.getAttribute("y",!0).setValue(o),typeof i=="number"||typeof s=="number"){var V=ya(t.getAttribute("viewBox").getString()),W=0,et=0;if(typeof i=="number"){var ct=t.getStyle("width");ct.hasValue()?W=ct.getPixels("x")/i:isNaN(V[2])||(W=V[2]/i)}if(typeof s=="number"){var dt=t.getStyle("height");dt.hasValue()?et=dt.getPixels("y")/s:isNaN(V[3])||(et=V[3]/s)}W||(W=et),et||(et=W),t.getAttribute("width",!0).setValue(i),t.getAttribute("height",!0).setValue(s);var gt=t.getStyle("transform",!0,!0);gt.setValue("".concat(gt.getString()," scale(").concat(1/W,", ").concat(1/et,")"))}n||w.clearRect(0,0,N,Q),t.render(w),x&&(this.isFirstRender=!1)}}zm.defaultWindow=V6,zm.defaultFetch=G6;var{defaultFetch:Sbt}=zm,Tbt=typeof DOMParser<"u"?DOMParser:null;class W_{constructor(){var{fetch:t=Sbt,DOMParser:e=Tbt}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fetch=t,this.DOMParser=e}parse(t){var e=this;return rA(function*(){return t.startsWith("<")?e.parseFromString(t):e.load(t)})()}parseFromString(t){var e=new this.DOMParser;try{return this.checkDocument(e.parseFromString(t,"image/svg+xml"))}catch{return this.checkDocument(e.parseFromString(t,"text/xml"))}}checkDocument(t){var e=t.getElementsByTagName("parsererror")[0];if(e)throw new Error(e.textContent);return t}load(t){var e=this;return rA(function*(){var n=yield e.fetch(t),i=yield n.text();return e.parseFromString(i)})()}}class j6{constructor(t,e){this.type="translate",this.point=null,this.point=Qi.parse(e)}apply(t){var{x:e,y:n}=this.point;t.translate(e||0,n||0)}unapply(t){var{x:e,y:n}=this.point;t.translate(-1*e||0,-1*n||0)}applyToPoint(t){var{x:e,y:n}=this.point;t.applyTransform([1,0,0,1,e||0,n||0])}}class q6{constructor(t,e,n){this.type="rotate",this.angle=null,this.originX=null,this.originY=null,this.cx=0,this.cy=0;var i=ya(e);this.angle=new Rr(t,"angle",i[0]),this.originX=n[0],this.originY=n[1],this.cx=i[1]||0,this.cy=i[2]||0}apply(t){var{cx:e,cy:n,originX:i,originY:s,angle:a}=this,o=e+i.getPixels("x"),d=n+s.getPixels("y");t.translate(o,d),t.rotate(a.getRadians()),t.translate(-o,-d)}unapply(t){var{cx:e,cy:n,originX:i,originY:s,angle:a}=this,o=e+i.getPixels("x"),d=n+s.getPixels("y");t.translate(o,d),t.rotate(-1*a.getRadians()),t.translate(-o,-d)}applyToPoint(t){var{cx:e,cy:n,angle:i}=this,s=i.getRadians();t.applyTransform([1,0,0,1,e||0,n||0]),t.applyTransform([Math.cos(s),Math.sin(s),-Math.sin(s),Math.cos(s),0,0]),t.applyTransform([1,0,0,1,-e||0,-n||0])}}class K6{constructor(t,e,n){this.type="scale",this.scale=null,this.originX=null,this.originY=null;var i=Qi.parseScale(e);(i.x===0||i.y===0)&&(i.x=wd,i.y=wd),this.scale=i,this.originX=n[0],this.originY=n[1]}apply(t){var{scale:{x:e,y:n},originX:i,originY:s}=this,a=i.getPixels("x"),o=s.getPixels("y");t.translate(a,o),t.scale(e,n||e),t.translate(-a,-o)}unapply(t){var{scale:{x:e,y:n},originX:i,originY:s}=this,a=i.getPixels("x"),o=s.getPixels("y");t.translate(a,o),t.scale(1/e,1/n||e),t.translate(-a,-o)}applyToPoint(t){var{x:e,y:n}=this.scale;t.applyTransform([e||0,0,0,n||0,0,0])}}class NE{constructor(t,e,n){this.type="matrix",this.matrix=[],this.originX=null,this.originY=null,this.matrix=ya(e),this.originX=n[0],this.originY=n[1]}apply(t){var{originX:e,originY:n,matrix:i}=this,s=e.getPixels("x"),a=n.getPixels("y");t.translate(s,a),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),t.translate(-s,-a)}unapply(t){var{originX:e,originY:n,matrix:i}=this,s=i[0],a=i[2],o=i[4],d=i[1],f=i[3],_=i[5],w=0,x=0,B=1,P=1/(s*(f*B-_*x)-a*(d*B-_*w)+o*(d*x-f*w)),R=e.getPixels("x"),N=n.getPixels("y");t.translate(R,N),t.transform(P*(f*B-_*x),P*(_*w-d*B),P*(o*x-a*B),P*(s*B-o*w),P*(a*_-o*f),P*(o*d-s*_)),t.translate(-R,-N)}applyToPoint(t){t.applyTransform(this.matrix)}}class kE extends NE{constructor(t,e,n){super(t,e,n),this.type="skew",this.angle=null,this.angle=new Rr(t,"angle",e)}}class $6 extends kE{constructor(t,e,n){super(t,e,n),this.type="skewX",this.matrix=[1,0,Math.tan(this.angle.getRadians()),1,0,0]}}class W6 extends kE{constructor(t,e,n){super(t,e,n),this.type="skewY",this.matrix=[1,Math.tan(this.angle.getRadians()),0,1,0,0]}}function Ibt(r){return vd(r).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)}function Fbt(r){var[t,e]=r.split("(");return[t.trim(),e.trim().replace(")","")]}class Ah{constructor(t,e,n){this.document=t,this.transforms=[];var i=Ibt(e);i.forEach(s=>{if(s!=="none"){var[a,o]=Fbt(s),d=Ah.transformTypes[a];typeof d<"u"&&this.transforms.push(new d(this.document,o,n))}})}static fromElement(t,e){var n=e.getStyle("transform",!1,!0),[i,s=i]=e.getStyle("transform-origin",!1,!0).split(),a=[i,s];return n.hasValue()?new Ah(t,n.getString(),a):null}apply(t){for(var{transforms:e}=this,n=e.length,i=0;i<n;i++)e[i].apply(t)}unapply(t){for(var{transforms:e}=this,n=e.length,i=n-1;i>=0;i--)e[i].unapply(t)}applyToPoint(t){for(var{transforms:e}=this,n=e.length,i=0;i<n;i++)e[i].applyToPoint(t)}}Ah.transformTypes={translate:j6,rotate:q6,scale:K6,matrix:NE,skewX:$6,skewY:W6};class gi{constructor(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.document=t,this.node=e,this.captureTextNodes=n,this.attributes={},this.styles={},this.stylesSpecificity={},this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],!(!e||e.nodeType!==1)){if(Array.from(e.attributes).forEach(o=>{var d=N6(o.nodeName);this.attributes[d]=new Rr(t,d,o.value)}),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()){var i=this.getAttribute("style").getString().split(";").map(o=>o.trim());i.forEach(o=>{if(o){var[d,f]=o.split(":").map(_=>_.trim());this.styles[d]=new Rr(t,d,f)}})}var{definitions:s}=t,a=this.getAttribute("id");a.hasValue()&&(s[a.getString()]||(s[a.getString()]=this)),Array.from(e.childNodes).forEach(o=>{if(o.nodeType===1)this.addChild(o);else if(n&&(o.nodeType===3||o.nodeType===4)){var d=t.createTextNode(o);d.getText().length>0&&this.addChild(d)}})}}getAttribute(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this.attributes[t];if(!n&&e){var i=new Rr(this.document,t,"");return this.attributes[t]=i,i}return n||Rr.empty(this.document)}getHrefAttribute(){for(var t in this.attributes)if(t==="href"||t.endsWith(":href"))return this.attributes[t];return Rr.empty(this.document)}getStyle(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.styles[t];if(i)return i;var s=this.getAttribute(t);if(s!=null&&s.hasValue())return this.styles[t]=s,s;if(!n){var{parent:a}=this;if(a){var o=a.getStyle(t);if(o!=null&&o.hasValue())return o}}if(e){var d=new Rr(this.document,t,"");return this.styles[t]=d,d}return i||Rr.empty(this.document)}render(t){if(!(this.getStyle("display").getString()==="none"||this.getStyle("visibility").getString()==="hidden")){if(t.save(),this.getStyle("mask").hasValue()){var e=this.getStyle("mask").getDefinition();e&&(this.applyEffects(t),e.apply(t,this))}else if(this.getStyle("filter").getValue("none")!=="none"){var n=this.getStyle("filter").getDefinition();n&&(this.applyEffects(t),n.apply(t,this))}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}}setContext(t){}applyEffects(t){var e=Ah.fromElement(this.document,this);e&&e.apply(t);var n=this.getStyle("clip-path",!1,!0);if(n.hasValue()){var i=n.getDefinition();i&&i.apply(t)}}clearContext(t){}renderChildren(t){this.children.forEach(e=>{e.render(t)})}addChild(t){var e=t instanceof gi?t:this.document.createElement(t);e.parent=this,gi.ignoreChildTypes.includes(e.type)||this.children.push(e)}matchesSelector(t){var e,{node:n}=this;if(typeof n.matches=="function")return n.matches(t);var i=(e=n.getAttribute)===null||e===void 0?void 0:e.call(n,"class");return!i||i===""?!1:i.split(" ").some(s=>".".concat(s)===t)}addStylesFromStyleDefinition(){var{styles:t,stylesSpecificity:e}=this.document;for(var n in t)if(!n.startsWith("@")&&this.matchesSelector(n)){var i=t[n],s=e[n];if(i)for(var a in i){var o=this.stylesSpecificity[a];typeof o>"u"&&(o="000"),s>=o&&(this.styles[a]=i[a],this.stylesSpecificity[a]=s)}}}removeStyles(t,e){var n=e.reduce((i,s)=>{var a=t.getStyle(s);if(!a.hasValue())return i;var o=a.getString();return a.setValue(""),[...i,[s,o]]},[]);return n}restoreStyles(t,e){e.forEach(n=>{var[i,s]=n;t.getStyle(i,!0).setValue(s)})}isFirstChild(){var t;return((t=this.parent)===null||t===void 0?void 0:t.children.indexOf(this))===0}}gi.ignoreChildTypes=["title"];class X6 extends gi{constructor(t,e,n){super(t,e,n)}}function Lbt(r){var t=r.trim();return/^('|")/.test(t)?t:'"'.concat(t,'"')}function Pbt(r){return typeof process>"u"?r:r.trim().split(",").map(Lbt).join(",")}function Mbt(r){if(!r)return"";var t=r.trim().toLowerCase();switch(t){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return t;default:return/^oblique\s+(-|)\d+deg$/.test(t)?t:""}}function Rbt(r){if(!r)return"";var t=r.trim().toLowerCase();switch(t){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return t;default:return/^[\d.]+$/.test(t)?t:""}}class xo{constructor(t,e,n,i,s,a){var o=a?typeof a=="string"?xo.parse(a):a:{};this.fontFamily=s||o.fontFamily,this.fontSize=i||o.fontSize,this.fontStyle=t||o.fontStyle,this.fontWeight=n||o.fontWeight,this.fontVariant=e||o.fontVariant}static parse(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n="",i="",s="",a="",o="",d=vd(t).trim().split(" "),f={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return d.forEach(_=>{switch(!0){case(!f.fontStyle&&xo.styles.includes(_)):_!=="inherit"&&(n=_),f.fontStyle=!0;break;case(!f.fontVariant&&xo.variants.includes(_)):_!=="inherit"&&(i=_),f.fontStyle=!0,f.fontVariant=!0;break;case(!f.fontWeight&&xo.weights.includes(_)):_!=="inherit"&&(s=_),f.fontStyle=!0,f.fontVariant=!0,f.fontWeight=!0;break;case!f.fontSize:_!=="inherit"&&([a]=_.split("/")),f.fontStyle=!0,f.fontVariant=!0,f.fontWeight=!0,f.fontSize=!0;break;default:_!=="inherit"&&(o+=_)}}),new xo(n,i,s,a,o,e)}toString(){return[Mbt(this.fontStyle),this.fontVariant,Rbt(this.fontWeight),this.fontSize,Pbt(this.fontFamily)].join(" ").trim()}}xo.styles="normal|italic|oblique|inherit",xo.variants="normal|small-caps|inherit",xo.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";class Bl{constructor(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.NaN,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.NaN,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Number.NaN,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Number.NaN;this.x1=t,this.y1=e,this.x2=n,this.y2=i,this.addPoint(t,e),this.addPoint(n,i)}get x(){return this.x1}get y(){return this.y1}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}addPoint(t,e){typeof t<"u"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),typeof e<"u"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))}addX(t){this.addPoint(t,null)}addY(t){this.addPoint(null,t)}addBoundingBox(t){if(t){var{x1:e,y1:n,x2:i,y2:s}=t;this.addPoint(e,n),this.addPoint(i,s)}}sumCubic(t,e,n,i,s){return Math.pow(1-t,3)*e+3*Math.pow(1-t,2)*t*n+3*(1-t)*Math.pow(t,2)*i+Math.pow(t,3)*s}bezierCurveAdd(t,e,n,i,s){var a=6*e-12*n+6*i,o=-3*e+9*n-9*i+3*s,d=3*n-3*e;if(o===0){if(a===0)return;var f=-d/a;0<f&&f<1&&(t?this.addX(this.sumCubic(f,e,n,i,s)):this.addY(this.sumCubic(f,e,n,i,s)));return}var _=Math.pow(a,2)-4*d*o;if(!(_<0)){var w=(-a+Math.sqrt(_))/(2*o);0<w&&w<1&&(t?this.addX(this.sumCubic(w,e,n,i,s)):this.addY(this.sumCubic(w,e,n,i,s)));var x=(-a-Math.sqrt(_))/(2*o);0<x&&x<1&&(t?this.addX(this.sumCubic(x,e,n,i,s)):this.addY(this.sumCubic(x,e,n,i,s)))}}addBezierCurve(t,e,n,i,s,a,o,d){this.addPoint(t,e),this.addPoint(o,d),this.bezierCurveAdd(!0,t,n,s,o),this.bezierCurveAdd(!1,e,i,a,d)}addQuadraticCurve(t,e,n,i,s,a){var o=t+.6666666666666666*(n-t),d=e+2/3*(i-e),f=o+1/3*(s-t),_=d+1/3*(a-e);this.addBezierCurve(t,e,o,f,d,_,s,a)}isPointInBox(t,e){var{x1:n,y1:i,x2:s,y2:a}=this;return n<=t&&t<=s&&i<=e&&e<=a}}class nn extends Ue{constructor(t){super(t.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,"")),this.control=null,this.start=null,this.current=null,this.command=null,this.commands=this.commands,this.i=-1,this.previousCommand=null,this.points=[],this.angles=[]}reset(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new Qi(0,0),this.control=new Qi(0,0),this.current=new Qi(0,0),this.points=[],this.angles=[]}isEnd(){var{i:t,commands:e}=this;return t>=e.length-1}next(){var t=this.commands[++this.i];return this.previousCommand=this.command,this.command=t,t}getPoint(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"x",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"y",n=new Qi(this.command[t],this.command[e]);return this.makeAbsolute(n)}getAsControlPoint(t,e){var n=this.getPoint(t,e);return this.control=n,n}getAsCurrentPoint(t,e){var n=this.getPoint(t,e);return this.current=n,n}getReflectedControlPoint(){var t=this.previousCommand.type;if(t!==Ue.CURVE_TO&&t!==Ue.SMOOTH_CURVE_TO&&t!==Ue.QUAD_TO&&t!==Ue.SMOOTH_QUAD_TO)return this.current;var{current:{x:e,y:n},control:{x:i,y:s}}=this,a=new Qi(2*e-i,2*n-s);return a}makeAbsolute(t){if(this.command.relative){var{x:e,y:n}=this.current;t.x+=e,t.y+=n}return t}addMarker(t,e,n){var{points:i,angles:s}=this;n&&s.length>0&&!s[s.length-1]&&(s[s.length-1]=i[i.length-1].angleTo(n)),this.addMarkerAngle(t,e?e.angleTo(t):null)}addMarkerAngle(t,e){this.points.push(t),this.angles.push(e)}getMarkerPoints(){return this.points}getMarkerAngles(){for(var{angles:t}=this,e=t.length,n=0;n<e;n++)if(!t[n]){for(var i=n+1;i<e;i++)if(t[i]){t[n]=t[i];break}}return t}}class hh extends gi{constructor(){super(...arguments),this.modifiedEmSizeStack=!1}calculateOpacity(){for(var t=1,e=this;e;){var n=e.getStyle("opacity",!1,!0);n.hasValue(!0)&&(t*=n.getNumber()),e=e.parent}return t}setContext(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!e){var n=this.getStyle("fill"),i=this.getStyle("fill-opacity"),s=this.getStyle("stroke"),a=this.getStyle("stroke-opacity");if(n.isUrlDefinition()){var o=n.getFillStyleDefinition(this,i);o&&(t.fillStyle=o)}else if(n.hasValue()){n.getString()==="currentColor"&&n.setValue(this.getStyle("color").getColor());var d=n.getColor();d!=="inherit"&&(t.fillStyle=d==="none"?"rgba(0,0,0,0)":d)}if(i.hasValue()){var f=new Rr(this.document,"fill",t.fillStyle).addOpacity(i).getColor();t.fillStyle=f}if(s.isUrlDefinition()){var _=s.getFillStyleDefinition(this,a);_&&(t.strokeStyle=_)}else if(s.hasValue()){s.getString()==="currentColor"&&s.setValue(this.getStyle("color").getColor());var w=s.getString();w!=="inherit"&&(t.strokeStyle=w==="none"?"rgba(0,0,0,0)":w)}if(a.hasValue()){var x=new Rr(this.document,"stroke",t.strokeStyle).addOpacity(a).getString();t.strokeStyle=x}var B=this.getStyle("stroke-width");if(B.hasValue()){var P=B.getPixels();t.lineWidth=P||wd}var R=this.getStyle("stroke-linecap"),N=this.getStyle("stroke-linejoin"),Q=this.getStyle("stroke-miterlimit"),V=this.getStyle("stroke-dasharray"),W=this.getStyle("stroke-dashoffset");if(R.hasValue()&&(t.lineCap=R.getString()),N.hasValue()&&(t.lineJoin=N.getString()),Q.hasValue()&&(t.miterLimit=Q.getNumber()),V.hasValue()&&V.getString()!=="none"){var et=ya(V.getString());typeof t.setLineDash<"u"?t.setLineDash(et):typeof t.webkitLineDash<"u"?t.webkitLineDash=et:typeof t.mozDash<"u"&&!(et.length===1&&et[0]===0)&&(t.mozDash=et);var ct=W.getPixels();typeof t.lineDashOffset<"u"?t.lineDashOffset=ct:typeof t.webkitLineDashOffset<"u"?t.webkitLineDashOffset=ct:typeof t.mozDashOffset<"u"&&(t.mozDashOffset=ct)}}if(this.modifiedEmSizeStack=!1,typeof t.font<"u"){var dt=this.getStyle("font"),gt=this.getStyle("font-style"),ht=this.getStyle("font-variant"),It=this.getStyle("font-weight"),St=this.getStyle("font-size"),ot=this.getStyle("font-family"),at=new xo(gt.getString(),ht.getString(),It.getString(),St.hasValue()?"".concat(St.getPixels(!0),"px"):"",ot.getString(),xo.parse(dt.getString(),t.font));gt.setValue(at.fontStyle),ht.setValue(at.fontVariant),It.setValue(at.fontWeight),St.setValue(at.fontSize),ot.setValue(at.fontFamily),t.font=at.toString(),St.isPixels()&&(this.document.emSize=St.getPixels(),this.modifiedEmSizeStack=!0)}e||(this.applyEffects(t),t.globalAlpha=this.calculateOpacity())}clearContext(t){super.clearContext(t),this.modifiedEmSizeStack&&this.document.popEmSize()}}class jn extends hh{constructor(t,e,n){super(t,e,n),this.type="path",this.pathParser=null,this.pathParser=new nn(this.getAttribute("d").getString())}path(t){var{pathParser:e}=this,n=new Bl;for(e.reset(),t&&t.beginPath();!e.isEnd();)switch(e.next().type){case nn.MOVE_TO:this.pathM(t,n);break;case nn.LINE_TO:this.pathL(t,n);break;case nn.HORIZ_LINE_TO:this.pathH(t,n);break;case nn.VERT_LINE_TO:this.pathV(t,n);break;case nn.CURVE_TO:this.pathC(t,n);break;case nn.SMOOTH_CURVE_TO:this.pathS(t,n);break;case nn.QUAD_TO:this.pathQ(t,n);break;case nn.SMOOTH_QUAD_TO:this.pathT(t,n);break;case nn.ARC:this.pathA(t,n);break;case nn.CLOSE_PATH:this.pathZ(t,n);break}return n}getBoundingBox(t){return this.path()}getMarkers(){var{pathParser:t}=this,e=t.getMarkerPoints(),n=t.getMarkerAngles(),i=e.map((s,a)=>[s,n[a]]);return i}renderChildren(t){this.path(t),this.document.screen.mouse.checkPath(this,t);var e=this.getStyle("fill-rule");t.fillStyle!==""&&(e.getString("inherit")!=="inherit"?t.fill(e.getString()):t.fill()),t.strokeStyle!==""&&(this.getAttribute("vector-effect").getString()==="non-scaling-stroke"?(t.save(),t.setTransform(1,0,0,1,0,0),t.stroke(),t.restore()):t.stroke());var n=this.getMarkers();if(n){var i=n.length-1,s=this.getStyle("marker-start"),a=this.getStyle("marker-mid"),o=this.getStyle("marker-end");if(s.isUrlDefinition()){var d=s.getDefinition(),[f,_]=n[0];d.render(t,f,_)}if(a.isUrlDefinition())for(var w=a.getDefinition(),x=1;x<i;x++){var[B,P]=n[x];w.render(t,B,P)}if(o.isUrlDefinition()){var R=o.getDefinition(),[N,Q]=n[i];R.render(t,N,Q)}}}static pathM(t){var e=t.getAsCurrentPoint();return t.start=t.current,{point:e}}pathM(t,e){var{pathParser:n}=this,{point:i}=jn.pathM(n),{x:s,y:a}=i;n.addMarker(i),e.addPoint(s,a),t&&t.moveTo(s,a)}static pathL(t){var{current:e}=t,n=t.getAsCurrentPoint();return{current:e,point:n}}pathL(t,e){var{pathParser:n}=this,{current:i,point:s}=jn.pathL(n),{x:a,y:o}=s;n.addMarker(s,i),e.addPoint(a,o),t&&t.lineTo(a,o)}static pathH(t){var{current:e,command:n}=t,i=new Qi((n.relative?e.x:0)+n.x,e.y);return t.current=i,{current:e,point:i}}pathH(t,e){var{pathParser:n}=this,{current:i,point:s}=jn.pathH(n),{x:a,y:o}=s;n.addMarker(s,i),e.addPoint(a,o),t&&t.lineTo(a,o)}static pathV(t){var{current:e,command:n}=t,i=new Qi(e.x,(n.relative?e.y:0)+n.y);return t.current=i,{current:e,point:i}}pathV(t,e){var{pathParser:n}=this,{current:i,point:s}=jn.pathV(n),{x:a,y:o}=s;n.addMarker(s,i),e.addPoint(a,o),t&&t.lineTo(a,o)}static pathC(t){var{current:e}=t,n=t.getPoint("x1","y1"),i=t.getAsControlPoint("x2","y2"),s=t.getAsCurrentPoint();return{current:e,point:n,controlPoint:i,currentPoint:s}}pathC(t,e){var{pathParser:n}=this,{current:i,point:s,controlPoint:a,currentPoint:o}=jn.pathC(n);n.addMarker(o,a,s),e.addBezierCurve(i.x,i.y,s.x,s.y,a.x,a.y,o.x,o.y),t&&t.bezierCurveTo(s.x,s.y,a.x,a.y,o.x,o.y)}static pathS(t){var{current:e}=t,n=t.getReflectedControlPoint(),i=t.getAsControlPoint("x2","y2"),s=t.getAsCurrentPoint();return{current:e,point:n,controlPoint:i,currentPoint:s}}pathS(t,e){var{pathParser:n}=this,{current:i,point:s,controlPoint:a,currentPoint:o}=jn.pathS(n);n.addMarker(o,a,s),e.addBezierCurve(i.x,i.y,s.x,s.y,a.x,a.y,o.x,o.y),t&&t.bezierCurveTo(s.x,s.y,a.x,a.y,o.x,o.y)}static pathQ(t){var{current:e}=t,n=t.getAsControlPoint("x1","y1"),i=t.getAsCurrentPoint();return{current:e,controlPoint:n,currentPoint:i}}pathQ(t,e){var{pathParser:n}=this,{current:i,controlPoint:s,currentPoint:a}=jn.pathQ(n);n.addMarker(a,s,s),e.addQuadraticCurve(i.x,i.y,s.x,s.y,a.x,a.y),t&&t.quadraticCurveTo(s.x,s.y,a.x,a.y)}static pathT(t){var{current:e}=t,n=t.getReflectedControlPoint();t.control=n;var i=t.getAsCurrentPoint();return{current:e,controlPoint:n,currentPoint:i}}pathT(t,e){var{pathParser:n}=this,{current:i,controlPoint:s,currentPoint:a}=jn.pathT(n);n.addMarker(a,s,s),e.addQuadraticCurve(i.x,i.y,s.x,s.y,a.x,a.y),t&&t.quadraticCurveTo(s.x,s.y,a.x,a.y)}static pathA(t){var{current:e,command:n}=t,{rX:i,rY:s,xRot:a,lArcFlag:o,sweepFlag:d}=n,f=a*(Math.PI/180),_=t.getAsCurrentPoint(),w=new Qi(Math.cos(f)*(e.x-_.x)/2+Math.sin(f)*(e.y-_.y)/2,-Math.sin(f)*(e.x-_.x)/2+Math.cos(f)*(e.y-_.y)/2),x=Math.pow(w.x,2)/Math.pow(i,2)+Math.pow(w.y,2)/Math.pow(s,2);x>1&&(i*=Math.sqrt(x),s*=Math.sqrt(x));var B=(o===d?-1:1)*Math.sqrt((Math.pow(i,2)*Math.pow(s,2)-Math.pow(i,2)*Math.pow(w.y,2)-Math.pow(s,2)*Math.pow(w.x,2))/(Math.pow(i,2)*Math.pow(w.y,2)+Math.pow(s,2)*Math.pow(w.x,2)));isNaN(B)&&(B=0);var P=new Qi(B*i*w.y/s,B*-s*w.x/i),R=new Qi((e.x+_.x)/2+Math.cos(f)*P.x-Math.sin(f)*P.y,(e.y+_.y)/2+Math.sin(f)*P.x+Math.cos(f)*P.y),N=FE([1,0],[(w.x-P.x)/i,(w.y-P.y)/s]),Q=[(w.x-P.x)/i,(w.y-P.y)/s],V=[(-w.x-P.x)/i,(-w.y-P.y)/s],W=FE(Q,V);return $_(Q,V)<=-1&&(W=Math.PI),$_(Q,V)>=1&&(W=0),{currentPoint:_,rX:i,rY:s,sweepFlag:d,xAxisRotation:f,centp:R,a1:N,ad:W}}pathA(t,e){var{pathParser:n}=this,{currentPoint:i,rX:s,rY:a,sweepFlag:o,xAxisRotation:d,centp:f,a1:_,ad:w}=jn.pathA(n),x=1-o?1:-1,B=_+x*(w/2),P=new Qi(f.x+s*Math.cos(B),f.y+a*Math.sin(B));if(n.addMarkerAngle(P,B-x*Math.PI/2),n.addMarkerAngle(i,B-x*Math.PI),e.addPoint(i.x,i.y),t&&!isNaN(_)&&!isNaN(w)){var R=s>a?s:a,N=s>a?1:s/a,Q=s>a?a/s:1;t.translate(f.x,f.y),t.rotate(d),t.scale(N,Q),t.arc(0,0,R,_,_+w,!!(1-o)),t.scale(1/N,1/Q),t.rotate(-d),t.translate(-f.x,-f.y)}}static pathZ(t){t.current=t.start}pathZ(t,e){jn.pathZ(this.pathParser),t&&e.x1!==e.x2&&e.y1!==e.y2&&t.closePath()}}class QE extends jn{constructor(t,e,n){super(t,e,n),this.type="glyph",this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber(),this.unicode=this.getAttribute("unicode").getString(),this.arabicForm=this.getAttribute("arabic-form").getString()}}class sA extends hh{constructor(t,e,n){super(t,e,new.target===sA?!0:n),this.type="text",this.x=0,this.y=0,this.measureCache=-1}setContext(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.setContext(t,e);var n=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();n&&(t.textBaseline=n)}initializeCoordinates(){this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY}getBoundingBox(t){if(this.type!=="text")return this.getTElementBoundingBox(t);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t);var e=null;return this.children.forEach((n,i)=>{var s=this.getChildBoundingBox(t,this,this,i);e?e.addBoundingBox(s):e=s}),e}getFontSize(){var{document:t,parent:e}=this,n=xo.parse(t.ctx.font).fontSize,i=e.getStyle("font-size").getNumber(n);return i}getTElementBoundingBox(t){var e=this.getFontSize();return new Bl(this.x,this.y-e,this.x+this.measureText(t),this.y)}getGlyph(t,e,n){var i=e[n],s=null;if(t.isArabic){var a=e.length,o=e[n-1],d=e[n+1],f="isolated";if((n===0||o===" ")&&n<a-1&&d!==" "&&(f="terminal"),n>0&&o!==" "&&n<a-1&&d!==" "&&(f="medial"),n>0&&o!==" "&&(n===a-1||d===" ")&&(f="initial"),typeof t.glyphs[i]<"u"){var _=t.glyphs[i];s=_ instanceof QE?_:_[f]}}else s=t.glyphs[i];return s||(s=t.missingGlyph),s}getText(){return""}getTextFromNode(t){var e=t||this.node,n=Array.from(e.parentNode.childNodes),i=n.indexOf(e),s=n.length-1,a=vd(e.textContent||"");return i===0&&(a=O6(a)),i===s&&(a=D6(a)),a}renderChildren(t){if(this.type!=="text"){this.renderTElementChildren(t);return}this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t),this.children.forEach((n,i)=>{this.renderChild(t,this,this,i)});var{mouse:e}=this.document.screen;e.isWorking()&&e.checkBoundingBox(this,this.getBoundingBox(t))}renderTElementChildren(t){var{document:e,parent:n}=this,i=this.getText(),s=n.getStyle("font-family").getDefinition();if(s){for(var{unitsPerEm:a}=s.fontFace,o=xo.parse(e.ctx.font),d=n.getStyle("font-size").getNumber(o.fontSize),f=n.getStyle("font-style").getString(o.fontStyle),_=d/a,w=s.isRTL?i.split("").reverse().join(""):i,x=ya(n.getAttribute("dx").getString()),B=w.length,P=0;P<B;P++){var R=this.getGlyph(s,w,P);t.translate(this.x,this.y),t.scale(_,-_);var N=t.lineWidth;t.lineWidth=t.lineWidth*a/d,f==="italic"&&t.transform(1,0,.4,1,0,0),R.render(t),f==="italic"&&t.transform(1,0,-.4,1,0,0),t.lineWidth=N,t.scale(1/_,-1/_),t.translate(-this.x,-this.y),this.x+=d*(R.horizAdvX||s.horizAdvX)/a,typeof x[P]<"u"&&!isNaN(x[P])&&(this.x+=x[P])}return}var{x:Q,y:V}=this;t.fillStyle&&t.fillText(i,Q,V),t.strokeStyle&&t.strokeText(i,Q,V)}applyAnchoring(){if(!(this.textChunkStart>=this.leafTexts.length)){var t=this.leafTexts[this.textChunkStart],e=t.getStyle("text-anchor").getString("start"),n=!1,i=0;e==="start"&&!n||e==="end"&&n?i=t.x-this.minX:e==="end"&&!n||e==="start"&&n?i=t.x-this.maxX:i=t.x-(this.minX+this.maxX)/2;for(var s=this.textChunkStart;s<this.leafTexts.length;s++)this.leafTexts[s].x+=i;this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.textChunkStart=this.leafTexts.length}}adjustChildCoordinatesRecursive(t){this.children.forEach((e,n)=>{this.adjustChildCoordinatesRecursiveCore(t,this,this,n)}),this.applyAnchoring()}adjustChildCoordinatesRecursiveCore(t,e,n,i){var s=n.children[i];s.children.length>0?s.children.forEach((a,o)=>{e.adjustChildCoordinatesRecursiveCore(t,e,s,o)}):this.adjustChildCoordinates(t,e,n,i)}adjustChildCoordinates(t,e,n,i){var s=n.children[i];if(typeof s.measureText!="function")return s;t.save(),s.setContext(t,!0);var a=s.getAttribute("x"),o=s.getAttribute("y"),d=s.getAttribute("dx"),f=s.getAttribute("dy"),_=s.getStyle("font-family").getDefinition(),w=!!_&&_.isRTL;i===0&&(a.hasValue()||a.setValue(s.getInheritedAttribute("x")),o.hasValue()||o.setValue(s.getInheritedAttribute("y")),d.hasValue()||d.setValue(s.getInheritedAttribute("dx")),f.hasValue()||f.setValue(s.getInheritedAttribute("dy")));var x=s.measureText(t);return w&&(e.x-=x),a.hasValue()?(e.applyAnchoring(),s.x=a.getPixels("x"),d.hasValue()&&(s.x+=d.getPixels("x"))):(d.hasValue()&&(e.x+=d.getPixels("x")),s.x=e.x),e.x=s.x,w||(e.x+=x),o.hasValue()?(s.y=o.getPixels("y"),f.hasValue()&&(s.y+=f.getPixels("y"))):(f.hasValue()&&(e.y+=f.getPixels("y")),s.y=e.y),e.y=s.y,e.leafTexts.push(s),e.minX=Math.min(e.minX,s.x,s.x+x),e.maxX=Math.max(e.maxX,s.x,s.x+x),s.clearContext(t),t.restore(),s}getChildBoundingBox(t,e,n,i){var s=n.children[i];if(typeof s.getBoundingBox!="function")return null;var a=s.getBoundingBox(t);return a?(s.children.forEach((o,d)=>{var f=e.getChildBoundingBox(t,e,s,d);a.addBoundingBox(f)}),a):null}renderChild(t,e,n,i){var s=n.children[i];s.render(t),s.children.forEach((a,o)=>{e.renderChild(t,e,s,o)})}measureText(t){var{measureCache:e}=this;if(~e)return e;var n=this.getText(),i=this.measureTargetText(t,n);return this.measureCache=i,i}measureTargetText(t,e){if(!e.length)return 0;var{parent:n}=this,i=n.getStyle("font-family").getDefinition();if(i){for(var s=this.getFontSize(),a=i.isRTL?e.split("").reverse().join(""):e,o=ya(n.getAttribute("dx").getString()),d=a.length,f=0,_=0;_<d;_++){var w=this.getGlyph(i,a,_);f+=(w.horizAdvX||i.horizAdvX)*s/i.fontFace.unitsPerEm,typeof o[_]<"u"&&!isNaN(o[_])&&(f+=o[_])}return f}if(!t.measureText)return e.length*10;t.save(),this.setContext(t,!0);var{width:x}=t.measureText(e);return this.clearContext(t),t.restore(),x}getInheritedAttribute(t){for(var e=this;e instanceof sA&&e.isFirstChild();){var n=e.parent.getAttribute(t);if(n.hasValue(!0))return n.getValue("0");e=e.parent}return null}}class Hm extends sA{constructor(t,e,n){super(t,e,new.target===Hm?!0:n),this.type="tspan",this.text=this.children.length>0?"":this.getTextFromNode()}getText(){return this.text}}class Ubt extends Hm{constructor(){super(...arguments),this.type="textNode"}}class _p extends hh{constructor(){super(...arguments),this.type="svg",this.root=!1}setContext(t){var e,{document:n}=this,{screen:i,window:s}=n,a=t.canvas;if(i.setDefaults(t),a.style&&typeof t.font<"u"&&s&&typeof s.getComputedStyle<"u"){t.font=s.getComputedStyle(a).getPropertyValue("font");var o=new Rr(n,"fontSize",xo.parse(t.font).fontSize);o.hasValue()&&(n.rootEmSize=o.getPixels("y"),n.emSize=n.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);var{width:d,height:f}=i.viewPort;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");var _=this.getAttribute("refX"),w=this.getAttribute("refY"),x=this.getAttribute("viewBox"),B=x.hasValue()?ya(x.getString()):null,P=!this.root&&this.getStyle("overflow").getValue("hidden")!=="visible",R=0,N=0,Q=0,V=0;B&&(R=B[0],N=B[1]),this.root||(d=this.getStyle("width").getPixels("x"),f=this.getStyle("height").getPixels("y"),this.type==="marker"&&(Q=R,V=N,R=0,N=0)),i.viewPort.setCurrent(d,f),this.node&&(!this.parent||((e=this.node.parentNode)===null||e===void 0?void 0:e.nodeName)==="foreignObject")&&this.getStyle("transform",!1,!0).hasValue()&&!this.getStyle("transform-origin",!1,!0).hasValue()&&this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),super.setContext(t),t.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),B&&(d=B[2],f=B[3]),n.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:i.viewPort.width,desiredWidth:d,height:i.viewPort.height,desiredHeight:f,minX:R,minY:N,refX:_.getValue(),refY:w.getValue(),clip:P,clipX:Q,clipY:V}),B&&(i.viewPort.removeCurrent(),i.viewPort.setCurrent(d,f))}clearContext(t){super.clearContext(t),this.document.screen.viewPort.removeCurrent()}resize(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getAttribute("width",!0),s=this.getAttribute("height",!0),a=this.getAttribute("viewBox"),o=this.getAttribute("style"),d=i.getNumber(0),f=s.getNumber(0);if(n)if(typeof n=="string")this.getAttribute("preserveAspectRatio",!0).setValue(n);else{var _=this.getAttribute("preserveAspectRatio");_.hasValue()&&_.setValue(_.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(i.setValue(t),s.setValue(e),a.hasValue()||a.setValue("0 0 ".concat(d||t," ").concat(f||e)),o.hasValue()){var w=this.getStyle("width"),x=this.getStyle("height");w.hasValue()&&w.setValue("".concat(t,"px")),x.hasValue()&&x.setValue("".concat(e,"px"))}}}class zE extends jn{constructor(){super(...arguments),this.type="rect"}path(t){var e=this.getAttribute("x").getPixels("x"),n=this.getAttribute("y").getPixels("y"),i=this.getStyle("width",!1,!0).getPixels("x"),s=this.getStyle("height",!1,!0).getPixels("y"),a=this.getAttribute("rx"),o=this.getAttribute("ry"),d=a.getPixels("x"),f=o.getPixels("y");if(a.hasValue()&&!o.hasValue()&&(f=d),o.hasValue()&&!a.hasValue()&&(d=f),d=Math.min(d,i/2),f=Math.min(f,s/2),t){var _=4*((Math.sqrt(2)-1)/3);t.beginPath(),s>0&&i>0&&(t.moveTo(e+d,n),t.lineTo(e+i-d,n),t.bezierCurveTo(e+i-d+_*d,n,e+i,n+f-_*f,e+i,n+f),t.lineTo(e+i,n+s-f),t.bezierCurveTo(e+i,n+s-f+_*f,e+i-d+_*d,n+s,e+i-d,n+s),t.lineTo(e+d,n+s),t.bezierCurveTo(e+d-_*d,n+s,e,n+s-f+_*f,e,n+s-f),t.lineTo(e,n+f),t.bezierCurveTo(e,n+f-_*f,e+d-_*d,n,e+d,n),t.closePath())}return new Bl(e,n,e+i,n+s)}getMarkers(){return null}}class J6 extends jn{constructor(){super(...arguments),this.type="circle"}path(t){var e=this.getAttribute("cx").getPixels("x"),n=this.getAttribute("cy").getPixels("y"),i=this.getAttribute("r").getPixels();return t&&i>0&&(t.beginPath(),t.arc(e,n,i,0,Math.PI*2,!1),t.closePath()),new Bl(e-i,n-i,e+i,n+i)}getMarkers(){return null}}class Y6 extends jn{constructor(){super(...arguments),this.type="ellipse"}path(t){var e=4*((Math.sqrt(2)-1)/3),n=this.getAttribute("rx").getPixels("x"),i=this.getAttribute("ry").getPixels("y"),s=this.getAttribute("cx").getPixels("x"),a=this.getAttribute("cy").getPixels("y");return t&&n>0&&i>0&&(t.beginPath(),t.moveTo(s+n,a),t.bezierCurveTo(s+n,a+e*i,s+e*n,a+i,s,a+i),t.bezierCurveTo(s-e*n,a+i,s-n,a+e*i,s-n,a),t.bezierCurveTo(s-n,a-e*i,s-e*n,a-i,s,a-i),t.bezierCurveTo(s+e*n,a-i,s+n,a-e*i,s+n,a),t.closePath()),new Bl(s-n,a-i,s+n,a+i)}getMarkers(){return null}}class Z6 extends jn{constructor(){super(...arguments),this.type="line"}getPoints(){return[new Qi(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new Qi(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}path(t){var[{x:e,y:n},{x:i,y:s}]=this.getPoints();return t&&(t.beginPath(),t.moveTo(e,n),t.lineTo(i,s)),new Bl(e,n,i,s)}getMarkers(){var[t,e]=this.getPoints(),n=t.angleTo(e);return[[t,n],[e,n]]}}class HE extends jn{constructor(t,e,n){super(t,e,n),this.type="polyline",this.points=[],this.points=Qi.parsePath(this.getAttribute("points").getString())}path(t){var{points:e}=this,[{x:n,y:i}]=e,s=new Bl(n,i);return t&&(t.beginPath(),t.moveTo(n,i)),e.forEach(a=>{var{x:o,y:d}=a;s.addPoint(o,d),t&&t.lineTo(o,d)}),s}getMarkers(){var{points:t}=this,e=t.length-1,n=[];return t.forEach((i,s)=>{s!==e&&n.push([i,i.angleTo(t[s+1])])}),n.length>0&&n.push([t[t.length-1],n[n.length-1][1]]),n}}class tN extends HE{constructor(){super(...arguments),this.type="polygon"}path(t){var e=super.path(t),[{x:n,y:i}]=this.points;return t&&(t.lineTo(n,i),t.closePath()),e}}class eN extends gi{constructor(){super(...arguments),this.type="pattern"}createPattern(t,e,n){var i=this.getStyle("width").getPixels("x",!0),s=this.getStyle("height").getPixels("y",!0),a=new _p(this.document,null);a.attributes.viewBox=new Rr(this.document,"viewBox",this.getAttribute("viewBox").getValue()),a.attributes.width=new Rr(this.document,"width","".concat(i,"px")),a.attributes.height=new Rr(this.document,"height","".concat(s,"px")),a.attributes.transform=new Rr(this.document,"transform",this.getAttribute("patternTransform").getValue()),a.children=this.children;var o=this.document.createCanvas(i,s),d=o.getContext("2d"),f=this.getAttribute("x"),_=this.getAttribute("y");f.hasValue()&&_.hasValue()&&d.translate(f.getPixels("x",!0),_.getPixels("y",!0)),n.hasValue()?this.styles["fill-opacity"]=n:Reflect.deleteProperty(this.styles,"fill-opacity");for(var w=-1;w<=1;w++)for(var x=-1;x<=1;x++)d.save(),a.attributes.x=new Rr(this.document,"x",w*o.width),a.attributes.y=new Rr(this.document,"y",x*o.height),a.render(d),d.restore();var B=t.createPattern(o,"repeat");return B}}class rN extends gi{constructor(){super(...arguments),this.type="marker"}render(t,e,n){if(e){var{x:i,y:s}=e,a=this.getAttribute("orient").getString("auto"),o=this.getAttribute("markerUnits").getString("strokeWidth");t.translate(i,s),a==="auto"&&t.rotate(n),o==="strokeWidth"&&t.scale(t.lineWidth,t.lineWidth),t.save();var d=new _p(this.document,null);d.type=this.type,d.attributes.viewBox=new Rr(this.document,"viewBox",this.getAttribute("viewBox").getValue()),d.attributes.refX=new Rr(this.document,"refX",this.getAttribute("refX").getValue()),d.attributes.refY=new Rr(this.document,"refY",this.getAttribute("refY").getValue()),d.attributes.width=new Rr(this.document,"width",this.getAttribute("markerWidth").getValue()),d.attributes.height=new Rr(this.document,"height",this.getAttribute("markerHeight").getValue()),d.attributes.overflow=new Rr(this.document,"overflow",this.getAttribute("overflow").getValue()),d.attributes.fill=new Rr(this.document,"fill",this.getAttribute("fill").getColor("black")),d.attributes.stroke=new Rr(this.document,"stroke",this.getAttribute("stroke").getValue("none")),d.children=this.children,d.render(t),t.restore(),o==="strokeWidth"&&t.scale(1/t.lineWidth,1/t.lineWidth),a==="auto"&&t.rotate(-n),t.translate(-i,-s)}}}class nN extends gi{constructor(){super(...arguments),this.type="defs"}render(){}}class X_ extends hh{constructor(){super(...arguments),this.type="g"}getBoundingBox(t){var e=new Bl;return this.children.forEach(n=>{e.addBoundingBox(n.getBoundingBox(t))}),e}}class VE extends gi{constructor(t,e,n){super(t,e,n),this.attributesToInherit=["gradientUnits"],this.stops=[];var{stops:i,children:s}=this;s.forEach(a=>{a.type==="stop"&&i.push(a)})}getGradientUnits(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}createGradient(t,e,n){var i=this;this.getHrefAttribute().hasValue()&&(i=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(i));var{stops:s}=i,a=this.getGradient(t,e);if(!a)return this.addParentOpacity(n,s[s.length-1].color);if(s.forEach(N=>{a.addColorStop(N.offset,this.addParentOpacity(n,N.color))}),this.getAttribute("gradientTransform").hasValue()){var{document:o}=this,{MAX_VIRTUAL_PIXELS:d,viewPort:f}=o.screen,[_]=f.viewPorts,w=new zE(o,null);w.attributes.x=new Rr(o,"x",-d/3),w.attributes.y=new Rr(o,"y",-d/3),w.attributes.width=new Rr(o,"width",d),w.attributes.height=new Rr(o,"height",d);var x=new X_(o,null);x.attributes.transform=new Rr(o,"transform",this.getAttribute("gradientTransform").getValue()),x.children=[w];var B=new _p(o,null);B.attributes.x=new Rr(o,"x",0),B.attributes.y=new Rr(o,"y",0),B.attributes.width=new Rr(o,"width",_.width),B.attributes.height=new Rr(o,"height",_.height),B.children=[x];var P=o.createCanvas(_.width,_.height),R=P.getContext("2d");return R.fillStyle=a,B.render(R),R.createPattern(P,"no-repeat")}return a}inheritStopContainer(t){this.attributesToInherit.forEach(e=>{!this.getAttribute(e).hasValue()&&t.getAttribute(e).hasValue()&&this.getAttribute(e,!0).setValue(t.getAttribute(e).getValue())})}addParentOpacity(t,e){if(t.hasValue()){var n=new Rr(this.document,"color",e);return n.addOpacity(t).getColor()}return e}}class iN extends VE{constructor(t,e,n){super(t,e,n),this.type="linearGradient",this.attributesToInherit.push("x1","y1","x2","y2")}getGradient(t,e){var n=this.getGradientUnits()==="objectBoundingBox",i=n?e.getBoundingBox(t):null;if(n&&!i)return null;!this.getAttribute("x1").hasValue()&&!this.getAttribute("y1").hasValue()&&!this.getAttribute("x2").hasValue()&&!this.getAttribute("y2").hasValue()&&(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));var s=n?i.x+i.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),a=n?i.y+i.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),o=n?i.x+i.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),d=n?i.y+i.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return s===o&&a===d?null:t.createLinearGradient(s,a,o,d)}}class sN extends VE{constructor(t,e,n){super(t,e,n),this.type="radialGradient",this.attributesToInherit.push("cx","cy","r","fx","fy","fr")}getGradient(t,e){var n=this.getGradientUnits()==="objectBoundingBox",i=e.getBoundingBox(t);if(n&&!i)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");var s=n?i.x+i.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),a=n?i.y+i.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y"),o=s,d=a;this.getAttribute("fx").hasValue()&&(o=n?i.x+i.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(d=n?i.y+i.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));var f=n?(i.width+i.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),_=this.getAttribute("fr").getPixels();return t.createRadialGradient(o,d,_,s,a,f)}}class oN extends gi{constructor(t,e,n){super(t,e,n),this.type="stop";var i=Math.max(0,Math.min(1,this.getAttribute("offset").getNumber())),s=this.getStyle("stop-opacity"),a=this.getStyle("stop-color",!0);a.getString()===""&&a.setValue("#000"),s.hasValue()&&(a=a.addOpacity(s)),this.offset=i,this.color=a.getColor()}}class J_ extends gi{constructor(t,e,n){super(t,e,n),this.type="animate",this.duration=0,this.initialValue=null,this.initialUnits="",this.removed=!1,this.frozen=!1,t.screen.animations.push(this),this.begin=this.getAttribute("begin").getMilliseconds(),this.maxDuration=this.begin+this.getAttribute("dur").getMilliseconds(),this.from=this.getAttribute("from"),this.to=this.getAttribute("to"),this.values=new Rr(t,"values",null);var i=this.getAttribute("values");i.hasValue()&&this.values.setValue(i.getString().split(";"))}getProperty(){var t=this.getAttribute("attributeType").getString(),e=this.getAttribute("attributeName").getString();return t==="CSS"?this.parent.getStyle(e,!0):this.parent.getAttribute(e,!0)}calcValue(){var{initialUnits:t}=this,{progress:e,from:n,to:i}=this.getProgress(),s=n.getNumber()+(i.getNumber()-n.getNumber())*e;return t==="%"&&(s*=100),"".concat(s).concat(t)}update(t){var{parent:e}=this,n=this.getProperty();if(this.initialValue||(this.initialValue=n.getString(),this.initialUnits=n.getUnits()),this.duration>this.maxDuration){var i=this.getAttribute("fill").getString("remove");if(this.getAttribute("repeatCount").getString()==="indefinite"||this.getAttribute("repeatDur").getString()==="indefinite")this.duration=0;else if(i==="freeze"&&!this.frozen)this.frozen=!0,e.animationFrozen=!0,e.animationFrozenValue=n.getString();else if(i==="remove"&&!this.removed)return this.removed=!0,n.setValue(e.animationFrozen?e.animationFrozenValue:this.initialValue),!0;return!1}this.duration+=t;var s=!1;if(this.begin<this.duration){var a=this.calcValue(),o=this.getAttribute("type");if(o.hasValue()){var d=o.getString();a="".concat(d,"(").concat(a,")")}n.setValue(a),s=!0}return s}getProgress(){var{document:t,values:e}=this,n={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(e.hasValue()){var i=n.progress*(e.getValue().length-1),s=Math.floor(i),a=Math.ceil(i);n.from=new Rr(t,"from",parseFloat(e.getValue()[s])),n.to=new Rr(t,"to",parseFloat(e.getValue()[a])),n.progress=(i-s)/(a-s)}else n.from=this.from,n.to=this.to;return n}}class aN extends J_{constructor(){super(...arguments),this.type="animateColor"}calcValue(){var{progress:t,from:e,to:n}=this.getProgress(),i=new xE(e.getColor()),s=new xE(n.getColor());if(i.ok&&s.ok){var a=i.r+(s.r-i.r)*t,o=i.g+(s.g-i.g)*t,d=i.b+(s.b-i.b)*t;return"rgb(".concat(Math.floor(a),", ").concat(Math.floor(o),", ").concat(Math.floor(d),")")}return this.getAttribute("from").getColor()}}class lN extends J_{constructor(){super(...arguments),this.type="animateTransform"}calcValue(){var{progress:t,from:e,to:n}=this.getProgress(),i=ya(e.getString()),s=ya(n.getString()),a=i.map((o,d)=>{var f=s[d];return o+(f-o)*t}).join(" ");return a}}class cN extends gi{constructor(t,e,n){super(t,e,n),this.type="font",this.glyphs={},this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber();var{definitions:i}=t,{children:s}=this;for(var a of s)switch(a.type){case"font-face":{this.fontFace=a;var o=a.getStyle("font-family");o.hasValue()&&(i[o.getString()]=this);break}case"missing-glyph":this.missingGlyph=a;break;case"glyph":{var d=a;d.arabicForm?(this.isRTL=!0,this.isArabic=!0,typeof this.glyphs[d.unicode]>"u"&&(this.glyphs[d.unicode]={}),this.glyphs[d.unicode][d.arabicForm]=d):this.glyphs[d.unicode]=d;break}}}render(){}}class uN extends gi{constructor(t,e,n){super(t,e,n),this.type="font-face",this.ascent=this.getAttribute("ascent").getNumber(),this.descent=this.getAttribute("descent").getNumber(),this.unitsPerEm=this.getAttribute("units-per-em").getNumber()}}class AN extends jn{constructor(){super(...arguments),this.type="missing-glyph",this.horizAdvX=0}}class hN extends sA{constructor(){super(...arguments),this.type="tref"}getText(){var t=this.getHrefAttribute().getDefinition();if(t){var e=t.children[0];if(e)return e.getText()}return""}}class dN extends sA{constructor(t,e,n){super(t,e,n),this.type="a";var{childNodes:i}=e,s=i[0],a=i.length>0&&Array.from(i).every(o=>o.nodeType===3);this.hasText=a,this.text=a?this.getTextFromNode(s):""}getText(){return this.text}renderChildren(t){if(this.hasText){super.renderChildren(t);var{document:e,x:n,y:i}=this,{mouse:s}=e.screen,a=new Rr(e,"fontSize",xo.parse(e.ctx.font).fontSize);s.isWorking()&&s.checkBoundingBox(this,new Bl(n,i-a.getPixels("y"),n+this.measureText(t),i))}else if(this.children.length>0){var o=new X_(this.document,null);o.children=this.children,o.parent=this,o.render(t)}}onClick(){var{window:t}=this.document;t&&t.open(this.getHrefAttribute().getString())}onMouseMove(){var t=this.document.ctx;t.canvas.style.cursor="pointer"}}function fN(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),e.push.apply(e,n)}return e}function Y_(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?fN(Object(e),!0).forEach(function(n){pE(r,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):fN(Object(e)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))})}return r}class pN extends sA{constructor(t,e,n){super(t,e,n),this.type="textPath",this.textWidth=0,this.textHeight=0,this.pathLength=-1,this.glyphInfo=null,this.letterSpacingCache=[],this.measuresCache=new Map([["",0]]);var i=this.getHrefAttribute().getDefinition();this.text=this.getTextFromNode(),this.dataArray=this.parsePathData(i)}getText(){return this.text}path(t){var{dataArray:e}=this;t&&t.beginPath(),e.forEach(n=>{var{type:i,points:s}=n;switch(i){case nn.LINE_TO:t&&t.lineTo(s[0],s[1]);break;case nn.MOVE_TO:t&&t.moveTo(s[0],s[1]);break;case nn.CURVE_TO:t&&t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case nn.QUAD_TO:t&&t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case nn.ARC:{var[a,o,d,f,_,w,x,B]=s,P=d>f?d:f,R=d>f?1:d/f,N=d>f?f/d:1;t&&(t.translate(a,o),t.rotate(x),t.scale(R,N),t.arc(0,0,P,_,_+w,!!(1-B)),t.scale(1/R,1/N),t.rotate(-x),t.translate(-a,-o));break}case nn.CLOSE_PATH:t&&t.closePath();break}})}renderChildren(t){this.setTextData(t),t.save();var e=this.parent.getStyle("text-decoration").getString(),n=this.getFontSize(),{glyphInfo:i}=this,s=t.fillStyle;e==="underline"&&t.beginPath(),i.forEach((a,o)=>{var{p0:d,p1:f,rotation:_,text:w}=a;t.save(),t.translate(d.x,d.y),t.rotate(_),t.fillStyle&&t.fillText(w,0,0),t.strokeStyle&&t.strokeText(w,0,0),t.restore(),e==="underline"&&(o===0&&t.moveTo(d.x,d.y+n/8),t.lineTo(f.x,f.y+n/5))}),e==="underline"&&(t.lineWidth=n/20,t.strokeStyle=s,t.stroke(),t.closePath()),t.restore()}getLetterSpacingAt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.letterSpacingCache[t]||0}findSegmentToFitChar(t,e,n,i,s,a,o,d,f){var _=a,w=this.measureText(t,d);d===" "&&e==="justify"&&n<i&&(w+=(i-n)/s),f>-1&&(_+=this.getLetterSpacingAt(f));var x=this.textHeight/20,B=this.getEquidistantPointOnPath(_,x,0),P=this.getEquidistantPointOnPath(_+w,x,0),R={p0:B,p1:P},N=B&&P?Math.atan2(P.y-B.y,P.x-B.x):0;if(o){var Q=Math.cos(Math.PI/2+N)*o,V=Math.cos(-N)*o;R.p0=Y_(Y_({},B),{},{x:B.x+Q,y:B.y+V}),R.p1=Y_(Y_({},P),{},{x:P.x+Q,y:P.y+V})}return _+=w,{offset:_,segment:R,rotation:N}}measureText(t,e){var{measuresCache:n}=this,i=e||this.getText();if(n.has(i))return n.get(i);var s=this.measureTargetText(t,i);return n.set(i,s),s}setTextData(t){if(!this.glyphInfo){var e=this.getText(),n=e.split(""),i=e.split(" ").length-1,s=this.parent.getAttribute("dx").split().map(et=>et.getPixels("x")),a=this.parent.getAttribute("dy").getPixels("y"),o=this.parent.getStyle("text-anchor").getString("start"),d=this.getStyle("letter-spacing"),f=this.parent.getStyle("letter-spacing"),_=0;!d.hasValue()||d.getValue()==="inherit"?_=f.getPixels():d.hasValue()&&d.getValue()!=="initial"&&d.getValue()!=="unset"&&(_=d.getPixels());var w=[],x=e.length;this.letterSpacingCache=w;for(var B=0;B<x;B++)w.push(typeof s[B]<"u"?s[B]:_);var P=w.reduce((et,ct,dt)=>dt===0?0:et+ct||0,0),R=this.measureText(t),N=Math.max(R+P,0);this.textWidth=R,this.textHeight=this.getFontSize(),this.glyphInfo=[];var Q=this.getPathLength(),V=this.getStyle("startOffset").getNumber(0)*Q,W=0;(o==="middle"||o==="center")&&(W=-N/2),(o==="end"||o==="right")&&(W=-N),W+=V,n.forEach((et,ct)=>{var{offset:dt,segment:gt,rotation:ht}=this.findSegmentToFitChar(t,o,N,Q,i,W,a,et,ct);W=dt,!(!gt.p0||!gt.p1)&&this.glyphInfo.push({text:n[ct],p0:gt.p0,p1:gt.p1,rotation:ht})})}}parsePathData(t){if(this.pathLength=-1,!t)return[];var e=[],{pathParser:n}=t;for(n.reset();!n.isEnd();){var{current:i}=n,s=i?i.x:0,a=i?i.y:0,o=n.next(),d=o.type,f=[];switch(o.type){case nn.MOVE_TO:this.pathM(n,f);break;case nn.LINE_TO:d=this.pathL(n,f);break;case nn.HORIZ_LINE_TO:d=this.pathH(n,f);break;case nn.VERT_LINE_TO:d=this.pathV(n,f);break;case nn.CURVE_TO:this.pathC(n,f);break;case nn.SMOOTH_CURVE_TO:d=this.pathS(n,f);break;case nn.QUAD_TO:this.pathQ(n,f);break;case nn.SMOOTH_QUAD_TO:d=this.pathT(n,f);break;case nn.ARC:f=this.pathA(n);break;case nn.CLOSE_PATH:jn.pathZ(n);break}o.type!==nn.CLOSE_PATH?e.push({type:d,points:f,start:{x:s,y:a},pathLength:this.calcLength(s,a,d,f)}):e.push({type:nn.CLOSE_PATH,points:[],pathLength:0})}return e}pathM(t,e){var{x:n,y:i}=jn.pathM(t).point;e.push(n,i)}pathL(t,e){var{x:n,y:i}=jn.pathL(t).point;return e.push(n,i),nn.LINE_TO}pathH(t,e){var{x:n,y:i}=jn.pathH(t).point;return e.push(n,i),nn.LINE_TO}pathV(t,e){var{x:n,y:i}=jn.pathV(t).point;return e.push(n,i),nn.LINE_TO}pathC(t,e){var{point:n,controlPoint:i,currentPoint:s}=jn.pathC(t);e.push(n.x,n.y,i.x,i.y,s.x,s.y)}pathS(t,e){var{point:n,controlPoint:i,currentPoint:s}=jn.pathS(t);return e.push(n.x,n.y,i.x,i.y,s.x,s.y),nn.CURVE_TO}pathQ(t,e){var{controlPoint:n,currentPoint:i}=jn.pathQ(t);e.push(n.x,n.y,i.x,i.y)}pathT(t,e){var{controlPoint:n,currentPoint:i}=jn.pathT(t);return e.push(n.x,n.y,i.x,i.y),nn.QUAD_TO}pathA(t){var{rX:e,rY:n,sweepFlag:i,xAxisRotation:s,centp:a,a1:o,ad:d}=jn.pathA(t);return i===0&&d>0&&(d-=2*Math.PI),i===1&&d<0&&(d+=2*Math.PI),[a.x,a.y,e,n,o,d,s,i]}calcLength(t,e,n,i){var s=0,a=null,o=null,d=0;switch(n){case nn.LINE_TO:return this.getLineLength(t,e,i[0],i[1]);case nn.CURVE_TO:for(s=0,a=this.getPointOnCubicBezier(0,t,e,i[0],i[1],i[2],i[3],i[4],i[5]),d=.01;d<=1;d+=.01)o=this.getPointOnCubicBezier(d,t,e,i[0],i[1],i[2],i[3],i[4],i[5]),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return s;case nn.QUAD_TO:for(s=0,a=this.getPointOnQuadraticBezier(0,t,e,i[0],i[1],i[2],i[3]),d=.01;d<=1;d+=.01)o=this.getPointOnQuadraticBezier(d,t,e,i[0],i[1],i[2],i[3]),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return s;case nn.ARC:{s=0;var f=i[4],_=i[5],w=i[4]+_,x=Math.PI/180;if(Math.abs(f-w)<x&&(x=Math.abs(f-w)),a=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],f,0),_<0)for(d=f-x;d>w;d-=x)o=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],d,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;else for(d=f+x;d<w;d+=x)o=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],d,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return o=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],w,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),s}}return 0}getPointOnLine(t,e,n,i,s){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:e,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:n,d=(s-n)/(i-e+wd),f=Math.sqrt(t*t/(1+d*d));i<e&&(f*=-1);var _=d*f,w=null;if(i===e)w={x:a,y:o+_};else if((o-n)/(a-e+wd)===d)w={x:a+f,y:o+_};else{var x=0,B=0,P=this.getLineLength(e,n,i,s);if(P<wd)return null;var R=(a-e)*(i-e)+(o-n)*(s-n);R/=P*P,x=e+R*(i-e),B=n+R*(s-n);var N=this.getLineLength(a,o,x,B),Q=Math.sqrt(t*t-N*N);f=Math.sqrt(Q*Q/(1+d*d)),i<e&&(f*=-1),_=d*f,w={x:x+f,y:B+_}}return w}getPointOnPath(t){var e=this.getPathLength(),n=0,i=null;if(t<-5e-5||t-5e-5>e)return null;var{dataArray:s}=this;for(var a of s){if(a&&(a.pathLength<5e-5||n+a.pathLength+5e-5<t)){n+=a.pathLength;continue}var o=t-n,d=0;switch(a.type){case nn.LINE_TO:i=this.getPointOnLine(o,a.start.x,a.start.y,a.points[0],a.points[1],a.start.x,a.start.y);break;case nn.ARC:{var f=a.points[4],_=a.points[5],w=a.points[4]+_;if(d=f+o/a.pathLength*_,_<0&&d<w||_>=0&&d>w)break;i=this.getPointOnEllipticalArc(a.points[0],a.points[1],a.points[2],a.points[3],d,a.points[6]);break}case nn.CURVE_TO:d=o/a.pathLength,d>1&&(d=1),i=this.getPointOnCubicBezier(d,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3],a.points[4],a.points[5]);break;case nn.QUAD_TO:d=o/a.pathLength,d>1&&(d=1),i=this.getPointOnQuadraticBezier(d,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3]);break}if(i)return i;break}return null}getLineLength(t,e,n,i){return Math.sqrt((n-t)*(n-t)+(i-e)*(i-e))}getPathLength(){return this.pathLength===-1&&(this.pathLength=this.dataArray.reduce((t,e)=>e.pathLength>0?t+e.pathLength:t,0)),this.pathLength}getPointOnCubicBezier(t,e,n,i,s,a,o,d,f){var _=d*LE(t)+a*PE(t)+i*ME(t)+e*RE(t),w=f*LE(t)+o*PE(t)+s*ME(t)+n*RE(t);return{x:_,y:w}}getPointOnQuadraticBezier(t,e,n,i,s,a,o){var d=a*UE(t)+i*OE(t)+e*DE(t),f=o*UE(t)+s*OE(t)+n*DE(t);return{x:d,y:f}}getPointOnEllipticalArc(t,e,n,i,s,a){var o=Math.cos(a),d=Math.sin(a),f={x:n*Math.cos(s),y:i*Math.sin(s)};return{x:t+(f.x*o-f.y*d),y:e+(f.x*d+f.y*o)}}buildEquidistantCache(t,e){var n=this.getPathLength(),i=e||.25,s=t||n/100;if(!this.equidistantCache||this.equidistantCache.step!==s||this.equidistantCache.precision!==i){this.equidistantCache={step:s,precision:i,points:[]};for(var a=0,o=0;o<=n;o+=i){var d=this.getPointOnPath(o),f=this.getPointOnPath(o+i);!d||!f||(a+=this.getLineLength(d.x,d.y,f.x,f.y),a>=s&&(this.equidistantCache.points.push({x:d.x,y:d.y,distance:o}),a-=s))}}}getEquidistantPointOnPath(t,e,n){if(this.buildEquidistantCache(e,n),t<0||t-this.getPathLength()>5e-5)return null;var i=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[i]||null}}var Obt=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i;class gN extends hh{constructor(t,e,n){super(t,e,n),this.type="image",this.loaded=!1;var i=this.getHrefAttribute().getString();if(i){var s=i.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(i);t.images.push(this),s?this.loadSvg(i):this.loadImage(i),this.isSvg=s}}loadImage(t){var e=this;return rA(function*(){try{var n=yield e.document.createImage(t);e.image=n}catch(i){console.error('Error while loading image "'.concat(t,'":'),i)}e.loaded=!0})()}loadSvg(t){var e=this;return rA(function*(){var n=Obt.exec(t);if(n){var i=n[5];n[4]==="base64"?e.image=atob(i):e.image=decodeURIComponent(i)}else try{var s=yield e.document.fetch(t),a=yield s.text();e.image=a}catch(o){console.error('Error while loading image "'.concat(t,'":'),o)}e.loaded=!0})()}renderChildren(t){var{document:e,image:n,loaded:i}=this,s=this.getAttribute("x").getPixels("x"),a=this.getAttribute("y").getPixels("y"),o=this.getStyle("width").getPixels("x"),d=this.getStyle("height").getPixels("y");if(!(!i||!n||!o||!d)){if(t.save(),t.translate(s,a),this.isSvg){var f=e.canvg.forkString(t,this.image,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:o,scaleHeight:d});f.document.documentElement.parent=this,f.render()}else{var _=this.image;e.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:o,desiredWidth:_.width,height:d,desiredHeight:_.height}),this.loaded&&(typeof _.complete>"u"||_.complete)&&t.drawImage(_,0,0)}t.restore()}}getBoundingBox(){var t=this.getAttribute("x").getPixels("x"),e=this.getAttribute("y").getPixels("y"),n=this.getStyle("width").getPixels("x"),i=this.getStyle("height").getPixels("y");return new Bl(t,e,t+n,e+i)}}class mN extends hh{constructor(){super(...arguments),this.type="symbol"}render(t){}}class yN{constructor(t){this.document=t,this.loaded=!1,t.fonts.push(this)}load(t,e){var n=this;return rA(function*(){try{var{document:i}=n,s=yield i.canvg.parser.load(e),a=s.getElementsByTagName("font");Array.from(a).forEach(o=>{var d=i.createElement(o);i.definitions[t]=d})}catch(o){console.error('Error while loading font "'.concat(e,'":'),o)}n.loaded=!0})()}}class GE extends gi{constructor(t,e,n){super(t,e,n),this.type="style";var i=vd(Array.from(e.childNodes).map(a=>a.textContent).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,"")),s=i.split("}");s.forEach(a=>{var o=a.trim();if(o){var d=o.split("{"),f=d[0].split(","),_=d[1].split(";");f.forEach(w=>{var x=w.trim();if(x){var B=t.styles[x]||{};if(_.forEach(N=>{var Q=N.indexOf(":"),V=N.substr(0,Q).trim(),W=N.substr(Q+1,N.length-Q).trim();V&&W&&(B[V]=new Rr(t,V,W))}),t.styles[x]=B,t.stylesSpecificity[x]=Q6(x),x==="@font-face"){var P=B["font-family"].getString().replace(/"|'/g,""),R=B.src.getString().split(",");R.forEach(N=>{if(N.indexOf('format("svg")')>0){var Q=TE(N);Q&&new yN(t).load(P,Q)}})}}})}})}}GE.parseExternalUrl=TE;class _N extends hh{constructor(){super(...arguments),this.type="use"}setContext(t){super.setContext(t);var e=this.getAttribute("x"),n=this.getAttribute("y");e.hasValue()&&t.translate(e.getPixels("x"),0),n.hasValue()&&t.translate(0,n.getPixels("y"))}path(t){var{element:e}=this;e&&e.path(t)}renderChildren(t){var{document:e,element:n}=this;if(n){var i=n;if(n.type==="symbol"&&(i=new _p(e,null),i.attributes.viewBox=new Rr(e,"viewBox",n.getAttribute("viewBox").getString()),i.attributes.preserveAspectRatio=new Rr(e,"preserveAspectRatio",n.getAttribute("preserveAspectRatio").getString()),i.attributes.overflow=new Rr(e,"overflow",n.getAttribute("overflow").getString()),i.children=n.children,n.styles.opacity=new Rr(e,"opacity",this.calculateOpacity())),i.type==="svg"){var s=this.getStyle("width",!1,!0),a=this.getStyle("height",!1,!0);s.hasValue()&&(i.attributes.width=new Rr(e,"width",s.getString())),a.hasValue()&&(i.attributes.height=new Rr(e,"height",a.getString()))}var o=i.parent;i.parent=this,i.render(t),i.parent=o}}getBoundingBox(t){var{element:e}=this;return e?e.getBoundingBox(t):null}elementTransform(){var{document:t,element:e}=this;return Ah.fromElement(t,e)}get element(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}}function Z_(r,t,e,n,i,s){return r[e*n*4+t*4+s]}function tv(r,t,e,n,i,s,a){r[e*n*4+t*4+s]=a}function as(r,t,e){var n=r[t];return n*e}function oA(r,t,e,n){return t+Math.cos(r)*e+Math.sin(r)*n}class jE extends gi{constructor(t,e,n){super(t,e,n),this.type="feColorMatrix";var i=ya(this.getAttribute("values").getString());switch(this.getAttribute("type").getString("matrix")){case"saturate":{var s=i[0];i=[.213+.787*s,.715-.715*s,.072-.072*s,0,0,.213-.213*s,.715+.285*s,.072-.072*s,0,0,.213-.213*s,.715-.715*s,.072+.928*s,0,0,0,0,0,1,0,0,0,0,0,1];break}case"hueRotate":{var a=i[0]*Math.PI/180;i=[oA(a,.213,.787,-.213),oA(a,.715,-.715,-.715),oA(a,.072,-.072,.928),0,0,oA(a,.213,-.213,.143),oA(a,.715,.285,.14),oA(a,.072,-.072,-.283),0,0,oA(a,.213,-.213,-.787),oA(a,.715,-.715,.715),oA(a,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break}case"luminanceToAlpha":i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1];break}this.matrix=i,this.includeOpacity=this.getAttribute("includeOpacity").hasValue()}apply(t,e,n,i,s){for(var{includeOpacity:a,matrix:o}=this,d=t.getImageData(0,0,i,s),f=0;f<s;f++)for(var _=0;_<i;_++){var w=Z_(d.data,_,f,i,s,0),x=Z_(d.data,_,f,i,s,1),B=Z_(d.data,_,f,i,s,2),P=Z_(d.data,_,f,i,s,3),R=as(o,0,w)+as(o,1,x)+as(o,2,B)+as(o,3,P)+as(o,4,1),N=as(o,5,w)+as(o,6,x)+as(o,7,B)+as(o,8,P)+as(o,9,1),Q=as(o,10,w)+as(o,11,x)+as(o,12,B)+as(o,13,P)+as(o,14,1),V=as(o,15,w)+as(o,16,x)+as(o,17,B)+as(o,18,P)+as(o,19,1);a&&(R=0,N=0,Q=0,V*=P/255),tv(d.data,_,f,i,s,0,R),tv(d.data,_,f,i,s,1,N),tv(d.data,_,f,i,s,2,Q),tv(d.data,_,f,i,s,3,V)}t.clearRect(0,0,i,s),t.putImageData(d,0,0)}}class Vm extends gi{constructor(){super(...arguments),this.type="mask"}apply(t,e){var{document:n}=this,i=this.getAttribute("x").getPixels("x"),s=this.getAttribute("y").getPixels("y"),a=this.getStyle("width").getPixels("x"),o=this.getStyle("height").getPixels("y");if(!a&&!o){var d=new Bl;this.children.forEach(P=>{d.addBoundingBox(P.getBoundingBox(t))}),i=Math.floor(d.x1),s=Math.floor(d.y1),a=Math.floor(d.width),o=Math.floor(d.height)}var f=this.removeStyles(e,Vm.ignoreStyles),_=n.createCanvas(i+a,s+o),w=_.getContext("2d");n.screen.setDefaults(w),this.renderChildren(w),new jE(n,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(w,0,0,i+a,s+o);var x=n.createCanvas(i+a,s+o),B=x.getContext("2d");n.screen.setDefaults(B),e.render(B),B.globalCompositeOperation="destination-in",B.fillStyle=w.createPattern(_,"no-repeat"),B.fillRect(0,0,i+a,s+o),t.fillStyle=B.createPattern(x,"no-repeat"),t.fillRect(0,0,i+a,s+o),this.restoreStyles(e,f)}render(t){}}Vm.ignoreStyles=["mask","transform","clip-path"];var vN=()=>{};class bN extends gi{constructor(){super(...arguments),this.type="clipPath"}apply(t){var{document:e}=this,n=Reflect.getPrototypeOf(t),{beginPath:i,closePath:s}=t;n&&(n.beginPath=vN,n.closePath=vN),Reflect.apply(i,t,[]),this.children.forEach(a=>{if(!(typeof a.path>"u")){var o=typeof a.elementTransform<"u"?a.elementTransform():null;o||(o=Ah.fromElement(e,a)),o&&o.apply(t),a.path(t),n&&(n.closePath=s),o&&o.unapply(t)}}),Reflect.apply(s,t,[]),t.clip(),n&&(n.beginPath=i,n.closePath=s)}render(t){}}class Gm extends gi{constructor(){super(...arguments),this.type="filter"}apply(t,e){var{document:n,children:i}=this,s=e.getBoundingBox(t);if(s){var a=0,o=0;i.forEach(Q=>{var V=Q.extraFilterDistance||0;a=Math.max(a,V),o=Math.max(o,V)});var d=Math.floor(s.width),f=Math.floor(s.height),_=d+2*a,w=f+2*o;if(!(_<1||w<1)){var x=Math.floor(s.x),B=Math.floor(s.y),P=this.removeStyles(e,Gm.ignoreStyles),R=n.createCanvas(_,w),N=R.getContext("2d");n.screen.setDefaults(N),N.translate(-x+a,-B+o),e.render(N),i.forEach(Q=>{typeof Q.apply=="function"&&Q.apply(N,0,0,_,w)}),t.drawImage(R,0,0,_,w,x-a,B-o,_,w),this.restoreStyles(e,P)}}}render(t){}}Gm.ignoreStyles=["filter","transform","clip-path"];class wN extends gi{constructor(t,e,n){super(t,e,n),this.type="feDropShadow",this.addStylesFromStyleDefinition()}apply(t,e,n,i,s){}}class xN extends gi{constructor(){super(...arguments),this.type="feMorphology"}apply(t,e,n,i,s){}}class BN extends gi{constructor(){super(...arguments),this.type="feComposite"}apply(t,e,n,i,s){}}class CN extends gi{constructor(t,e,n){super(t,e,n),this.type="feGaussianBlur",this.blurRadius=Math.floor(this.getAttribute("stdDeviation").getNumber()),this.extraFilterDistance=this.blurRadius}apply(t,e,n,i,s){var{document:a,blurRadius:o}=this,d=a.window?a.window.document.body:null,f=t.canvas;f.id=a.getUniqueId(),d&&(f.style.display="none",d.appendChild(f)),fbt(f,e,n,i,s,o),d&&d.removeChild(f)}}class EN extends gi{constructor(){super(...arguments),this.type="title"}}class SN extends gi{constructor(){super(...arguments),this.type="desc"}}var Dbt={svg:_p,rect:zE,circle:J6,ellipse:Y6,line:Z6,polyline:HE,polygon:tN,path:jn,pattern:eN,marker:rN,defs:nN,linearGradient:iN,radialGradient:sN,stop:oN,animate:J_,animateColor:aN,animateTransform:lN,font:cN,"font-face":uN,"missing-glyph":AN,glyph:QE,text:sA,tspan:Hm,tref:hN,a:dN,textPath:pN,image:gN,g:X_,symbol:mN,style:GE,use:_N,mask:Vm,clipPath:bN,filter:Gm,feDropShadow:wN,feMorphology:xN,feComposite:BN,feColorMatrix:jE,feGaussianBlur:CN,title:EN,desc:SN};function TN(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),e.push.apply(e,n)}return e}function Nbt(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?TN(Object(e),!0).forEach(function(n){pE(r,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):TN(Object(e)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))})}return r}function kbt(r,t){var e=document.createElement("canvas");return e.width=r,e.height=t,e}function Qbt(r){return qE.apply(this,arguments)}function qE(){return qE=rA(function*(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,e=document.createElement("img");return t&&(e.crossOrigin="Anonymous"),new Promise((n,i)=>{e.onload=()=>{n(e)},e.onerror=(s,a,o,d,f)=>{i(f)},e.src=r})}),qE.apply(this,arguments)}class aA{constructor(t){var{rootEmSize:e=12,emSize:n=12,createCanvas:i=aA.createCanvas,createImage:s=aA.createImage,anonymousCrossOrigin:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.canvg=t,this.definitions={},this.styles={},this.stylesSpecificity={},this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=t.screen,this.rootEmSize=e,this.emSize=n,this.createCanvas=i,this.createImage=this.bindCreateImage(s,a),this.screen.wait(this.isImagesLoaded.bind(this)),this.screen.wait(this.isFontsLoaded.bind(this))}bindCreateImage(t,e){return typeof e=="boolean"?(n,i)=>t(n,typeof i=="boolean"?i:e):t}get window(){return this.screen.window}get fetch(){return this.screen.fetch}get ctx(){return this.screen.ctx}get emSize(){var{emSizeStack:t}=this;return t[t.length-1]}set emSize(t){var{emSizeStack:e}=this;e.push(t)}popEmSize(){var{emSizeStack:t}=this;t.pop()}getUniqueId(){return"canvg".concat(++this.uniqueId)}isImagesLoaded(){return this.images.every(t=>t.loaded)}isFontsLoaded(){return this.fonts.every(t=>t.loaded)}createDocumentElement(t){var e=this.createElement(t.documentElement);return e.root=!0,e.addStylesFromStyleDefinition(),this.documentElement=e,e}createElement(t){var e=t.nodeName.replace(/^[^:]+:/,""),n=aA.elementTypes[e];return typeof n<"u"?new n(this,t):new X6(this,t)}createTextNode(t){return new Ubt(this,t)}setViewBox(t){this.screen.setViewBox(Nbt({document:this},t))}}aA.createCanvas=kbt,aA.createImage=Qbt,aA.elementTypes=Dbt;function IN(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),e.push.apply(e,n)}return e}function xd(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?IN(Object(e),!0).forEach(function(n){pE(r,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):IN(Object(e)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))})}return r}class Bd{constructor(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.parser=new W_(n),this.screen=new zm(t,n),this.options=n;var i=new aA(this,n),s=i.createDocumentElement(e);this.document=i,this.documentElement=s}static from(t,e){var n=arguments;return rA(function*(){var i=n.length>2&&n[2]!==void 0?n[2]:{},s=new W_(i),a=yield s.parse(e);return new Bd(t,a,i)})()}static fromString(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=new W_(n),s=i.parseFromString(e);return new Bd(t,s,n)}fork(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Bd.from(t,e,xd(xd({},this.options),n))}forkString(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Bd.fromString(t,e,xd(xd({},this.options),n))}ready(){return this.screen.ready()}isReady(){return this.screen.isReady()}render(){var t=arguments,e=this;return rA(function*(){var n=t.length>0&&t[0]!==void 0?t[0]:{};e.start(xd({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0},n)),yield e.ready(),e.stop()})()}start(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{documentElement:e,screen:n,options:i}=this;n.start(e,xd(xd({enableRedraw:!0},i),t))}stop(){this.screen.stop()}resize(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.documentElement.resize(t,e,n)}}const zbt=Object.freeze(Object.defineProperty({__proto__:null,AElement:dN,AnimateColorElement:aN,AnimateElement:J_,AnimateTransformElement:lN,BoundingBox:Bl,CB1:LE,CB2:PE,CB3:ME,CB4:RE,Canvg:Bd,CircleElement:J6,ClipPathElement:bN,DefsElement:nN,DescElement:SN,Document:aA,Element:gi,EllipseElement:Y6,FeColorMatrixElement:jE,FeCompositeElement:BN,FeDropShadowElement:wN,FeGaussianBlurElement:CN,FeMorphologyElement:xN,FilterElement:Gm,Font:xo,FontElement:cN,FontFaceElement:uN,GElement:X_,GlyphElement:QE,GradientElement:VE,ImageElement:gN,LineElement:Z6,LinearGradientElement:iN,MarkerElement:rN,MaskElement:Vm,Matrix:NE,MissingGlyphElement:AN,Mouse:H6,PSEUDO_ZERO:wd,Parser:W_,PathElement:jn,PathParser:nn,PatternElement:eN,Point:Qi,PolygonElement:tN,PolylineElement:HE,Property:Rr,QB1:UE,QB2:OE,QB3:DE,RadialGradientElement:sN,RectElement:zE,RenderedElement:hh,Rotate:q6,SVGElement:_p,SVGFontLoader:yN,Scale:K6,Screen:zm,Skew:kE,SkewX:$6,SkewY:W6,StopElement:oN,StyleElement:GE,SymbolElement:mN,TRefElement:hN,TSpanElement:Hm,TextElement:sA,TextPathElement:pN,TitleElement:EN,Transform:Ah,Translate:j6,UnknownElement:X6,UseElement:_N,ViewPort:z6,compressSpaces:vd,default:Bd,getSelectorSpecificity:Q6,normalizeAttributeName:N6,normalizeColor:k6,parseExternalUrl:TE,presets:ybt,toNumbers:ya,trimLeft:O6,trimRight:D6,vectorMagnitude:IE,vectorsAngle:FE,vectorsRatio:$_},Symbol.toStringTag,{value:"Module"}));LA.CompareMaps=jst,LA.Config=kM,LA.Map=kst,Object.defineProperty(LA,Symbol.toStringTag,{value:"Module"})});
