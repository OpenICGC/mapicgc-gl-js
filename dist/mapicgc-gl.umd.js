(function(Rl,xp){typeof exports=="object"&&typeof module<"u"?xp(exports):typeof define=="function"&&define.amd?define(["exports"],xp):(Rl=typeof globalThis<"u"?globalThis:Rl||self,xp(Rl.mapicgcgl={}))})(this,function(Rl){"use strict";function xp(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in r)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(r,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}var Fd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bp(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var HE={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(Fd,function(){var t={},n={};function i(a,o,A){if(n[a]=A,a==="index"){var f="var sharedModule = {}; ("+n.shared+")(sharedModule); ("+n.worker+")(sharedModule);",m={};return n.shared(m),n.index(t,m),typeof window<"u"&&t.setWorkerUrl(window.URL.createObjectURL(new Blob([f],{type:"text/javascript"}))),t}}i("shared",["exports"],function(a){function o(u,c,h,p){return new(h||(h=Promise))(function(b,S){function I(G){try{O(p.next(G))}catch(K){S(K)}}function F(G){try{O(p.throw(G))}catch(K){S(K)}}function O(G){var K;G.done?b(G.value):(K=G.value,K instanceof h?K:new h(function(J){J(K)})).then(I,F)}O((p=p.apply(u,c||[])).next())})}function A(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}typeof SuppressedError=="function"&&SuppressedError;var f=m;function m(u,c){this.x=u,this.y=c}m.prototype={clone:function(){return new m(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,c){return this.clone()._rotateAround(u,c)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var c=u.x-this.x,h=u.y-this.y;return c*c+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,c){return Math.atan2(this.x*c-this.y*u,this.x*u+this.y*c)},_matMult:function(u){var c=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=c,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var c=Math.cos(u),h=Math.sin(u),p=h*this.x+c*this.y;return this.x=c*this.x-h*this.y,this.y=p,this},_rotateAround:function(u,c){var h=Math.cos(u),p=Math.sin(u),b=c.y+p*(this.x-c.x)+h*(this.y-c.y);return this.x=c.x+h*(this.x-c.x)-p*(this.y-c.y),this.y=b,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},m.convert=function(u){return u instanceof m?u:Array.isArray(u)?new m(u[0],u[1]):u};var v=A(f),x=B;function B(u,c,h,p){this.cx=3*u,this.bx=3*(h-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(p-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=c,this.p2x=h,this.p2y=p}B.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,c){if(c===void 0&&(c=1e-6),u<0)return 0;if(u>1)return 1;for(var h=u,p=0;p<8;p++){var b=this.sampleCurveX(h)-u;if(Math.abs(b)<c)return h;var S=this.sampleCurveDerivativeX(h);if(Math.abs(S)<1e-6)break;h-=b/S}var I=0,F=1;for(h=u,p=0;p<20&&(b=this.sampleCurveX(h),!(Math.abs(b-u)<c));p++)u>b?I=h:F=h,h=.5*(F-I)+I;return h},solve:function(u,c){return this.sampleCurveY(this.solveCurveX(u,c))}};var M=A(x);let U,N;function Q(){return U==null&&(U=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),U}function q(){if(N==null&&(N=!1,Q())){const c=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(c){for(let p=0;p<5*5;p++){const b=4*p;c.fillStyle=`rgb(${b},${b+1},${b+2})`,c.fillRect(p%5,Math.floor(p/5),1,1)}const h=c.getImageData(0,0,5,5).data;for(let p=0;p<5*5*4;p++)if(p%4!=3&&h[p]!==p){N=!0;break}}}return N||!1}function Y(u,c,h,p){const b=new M(u,c,h,p);return function(S){return b.solve(S)}}const te=Y(.25,.1,.25,1);function pe(u,c,h){return Math.min(h,Math.max(c,u))}function ge(u,c,h){const p=h-c,b=((u-c)%p+p)%p+c;return b===c?h:b}function ye(u){for(var c=arguments.length,h=new Array(c>1?c-1:0),p=1;p<c;p++)h[p-1]=arguments[p];for(const b of h)for(const S in b)u[S]=b[S];return u}let fe=1;function Oe(u,c,h){const p={};for(const b in u)p[b]=c.call(h||this,u[b],b,u);return p}function Fe(u,c,h){const p={};for(const b in u)c.call(h||this,u[b],b,u)&&(p[b]=u[b]);return p}function oe(u){return Array.isArray(u)?u.map(oe):typeof u=="object"&&u?Oe(u,oe):u}const le={};function xe(u){le[u]||(typeof console<"u"&&console.warn(u),le[u]=!0)}function _e(u,c,h){return(h.y-u.y)*(c.x-u.x)>(c.y-u.y)*(h.x-u.x)}function tt(u){let c=0;for(let h,p,b=0,S=u.length,I=S-1;b<S;I=b++)h=u[b],p=u[I],c+=(p.x-h.x)*(h.y+p.y);return c}function et(u){return typeof WorkerGlobalScope<"u"&&u!==void 0&&u instanceof WorkerGlobalScope}let nt=null;function Je(u){return typeof ImageBitmap<"u"&&u instanceof ImageBitmap}const it="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function ot(u,c,h,p,b){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const S=new VideoFrame(u,{timestamp:0});try{const I=S==null?void 0:S.format;if(!I||!I.startsWith("BGR")&&!I.startsWith("RGB"))throw new Error(`Unrecognized format ${I}`);const F=I.startsWith("BGR"),O=new Uint8ClampedArray(p*b*4);if(yield S.copyTo(O,function(G,K,J,ie,ce){const Ae=4*Math.max(-K,0),Ce=(Math.max(0,J)-J)*ie*4+Ae,Le=4*ie,Ne=Math.max(0,K),rt=Math.max(0,J);return{rect:{x:Ne,y:rt,width:Math.min(G.width,K+ie)-Ne,height:Math.min(G.height,J+ce)-rt},layout:[{offset:Ce,stride:Le}]}}(u,c,h,p,b)),F)for(let G=0;G<O.length;G+=4){const K=O[G];O[G]=O[G+2],O[G+2]=K}return O}finally{S.close()}})}let xt,se;const be="AbortError";function Me(){return new Error(be)}const De={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function $e(u){return De.REGISTERED_PROTOCOLS[u.substring(0,u.indexOf("://"))]}const qe="global-dispatcher";class ct extends Error{constructor(c,h,p,b){super(`AJAXError: ${h} (${c}): ${p}`),this.status=c,this.statusText=h,this.url=p,this.body=b}}const st=()=>et(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ct=function(u,c){if(/:\/\//.test(u.url)&&!/^https?:|^file:/.test(u.url)){const p=$e(u.url);if(p)return p(u,c);if(et(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:u,targetMapId:qe},c)}if(!(/^file:/.test(h=u.url)||/^file:/.test(st())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(p,b){return o(this,void 0,void 0,function*(){const S=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,cache:p.cache,referrer:st(),signal:b.signal});p.type==="json"&&S.headers.set("Accept","application/json");const I=yield fetch(S);if(!I.ok){const G=yield I.blob();throw new ct(I.status,I.statusText,p.url,G)}let F;F=p.type==="arrayBuffer"||p.type==="image"?I.arrayBuffer():p.type==="json"?I.json():I.text();const O=yield F;if(b.signal.aborted)throw Me();return{data:O,cacheControl:I.headers.get("Cache-Control"),expires:I.headers.get("Expires")}})}(u,c);if(et(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:u,mustQueue:!0,targetMapId:qe},c)}var h;return function(p,b){return new Promise((S,I)=>{const F=new XMLHttpRequest;F.open(p.method||"GET",p.url,!0),p.type!=="arrayBuffer"&&p.type!=="image"||(F.responseType="arraybuffer");for(const O in p.headers)F.setRequestHeader(O,p.headers[O]);p.type==="json"&&(F.responseType="text",F.setRequestHeader("Accept","application/json")),F.withCredentials=p.credentials==="include",F.onerror=()=>{I(new Error(F.statusText))},F.onload=()=>{if(!b.signal.aborted)if((F.status>=200&&F.status<300||F.status===0)&&F.response!==null){let O=F.response;if(p.type==="json")try{O=JSON.parse(F.response)}catch(G){return void I(G)}S({data:O,cacheControl:F.getResponseHeader("Cache-Control"),expires:F.getResponseHeader("Expires")})}else{const O=new Blob([F.response],{type:F.getResponseHeader("Content-Type")});I(new ct(F.status,F.statusText,p.url,O))}},b.signal.addEventListener("abort",()=>{F.abort(),I(Me())}),F.send(p.body)})}(u,c)};function It(u){if(!u||u.indexOf("://")<=0||u.indexOf("data:image/")===0||u.indexOf("blob:")===0)return!0;const c=new URL(u),h=window.location;return c.protocol===h.protocol&&c.host===h.host}function Qt(u,c,h){h[u]&&h[u].indexOf(c)!==-1||(h[u]=h[u]||[],h[u].push(c))}function Ht(u,c,h){if(h&&h[u]){const p=h[u].indexOf(c);p!==-1&&h[u].splice(p,1)}}class zt{constructor(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ye(this,h),this.type=c}}class mt extends zt{constructor(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super("error",ye({error:c},h))}}class Re{on(c,h){return this._listeners=this._listeners||{},Qt(c,h,this._listeners),this}off(c,h){return Ht(c,h,this._listeners),Ht(c,h,this._oneTimeListeners),this}once(c,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},Qt(c,h,this._oneTimeListeners),this):new Promise(p=>this.once(c,p))}fire(c,h){typeof c=="string"&&(c=new zt(c,h||{}));const p=c.type;if(this.listens(p)){c.target=this;const b=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const F of b)F.call(this,c);const S=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const F of S)Ht(p,F,this._oneTimeListeners),F.call(this,c);const I=this._eventedParent;I&&(ye(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),I.fire(c))}else c instanceof mt&&console.error(c.error);return this}listens(c){return this._listeners&&this._listeners[c]&&this._listeners[c].length>0||this._oneTimeListeners&&this._oneTimeListeners[c]&&this._oneTimeListeners[c].length>0||this._eventedParent&&this._eventedParent.listens(c)}setEventedParent(c,h){return this._eventedParent=c,this._eventedParentData=h,this}}var Ye={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const tr=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function St(u,c){const h={};for(const p in u)p!=="ref"&&(h[p]=u[p]);return tr.forEach(p=>{p in c&&(h[p]=c[p])}),h}function vt(u,c){if(Array.isArray(u)){if(!Array.isArray(c)||u.length!==c.length)return!1;for(let h=0;h<u.length;h++)if(!vt(u[h],c[h]))return!1;return!0}if(typeof u=="object"&&u!==null&&c!==null){if(typeof c!="object"||Object.keys(u).length!==Object.keys(c).length)return!1;for(const h in u)if(!vt(u[h],c[h]))return!1;return!0}return u===c}function Bt(u,c){u.push(c)}function kt(u,c,h){Bt(h,{command:"addSource",args:[u,c[u]]})}function ir(u,c,h){Bt(c,{command:"removeSource",args:[u]}),h[u]=!0}function Ar(u,c,h,p){ir(u,h,p),kt(u,c,h)}function Lr(u,c,h){let p;for(p in u[h])if(Object.prototype.hasOwnProperty.call(u[h],p)&&p!=="data"&&!vt(u[h][p],c[h][p]))return!1;for(p in c[h])if(Object.prototype.hasOwnProperty.call(c[h],p)&&p!=="data"&&!vt(u[h][p],c[h][p]))return!1;return!0}function Tr(u,c,h,p,b,S){u=u||{},c=c||{};for(const I in u)Object.prototype.hasOwnProperty.call(u,I)&&(vt(u[I],c[I])||h.push({command:S,args:[p,I,c[I],b]}));for(const I in c)Object.prototype.hasOwnProperty.call(c,I)&&!Object.prototype.hasOwnProperty.call(u,I)&&(vt(u[I],c[I])||h.push({command:S,args:[p,I,c[I],b]}))}function kr(u){return u.id}function Qr(u,c){return u[c.id]=c,u}class pt{constructor(c,h,p,b){this.message=(c?`${c}: `:"")+p,b&&(this.identifier=b),h!=null&&h.__line__&&(this.line=h.__line__)}}function Ir(u){for(var c=arguments.length,h=new Array(c>1?c-1:0),p=1;p<c;p++)h[p-1]=arguments[p];for(const b of h)for(const S in b)u[S]=b[S];return u}class Dt extends Error{constructor(c,h){super(h),this.message=h,this.key=c}}class xn{constructor(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.parent=c,this.bindings={};for(const[p,b]of h)this.bindings[p]=b}concat(c){return new xn(this,c)}get(c){if(this.bindings[c])return this.bindings[c];if(this.parent)return this.parent.get(c);throw new Error(`${c} not found in scope.`)}has(c){return!!this.bindings[c]||!!this.parent&&this.parent.has(c)}}const Mr={kind:"null"},Tt={kind:"number"},Jt={kind:"string"},Kt={kind:"boolean"},Yr={kind:"color"},Or={kind:"object"},gr={kind:"value"},an={kind:"collator"},Wr={kind:"formatted"},Ee={kind:"padding"},ee={kind:"resolvedImage"},Z={kind:"variableAnchorOffsetCollection"};function ae(u,c){return{kind:"array",itemType:u,N:c}}function Se(u){if(u.kind==="array"){const c=Se(u.itemType);return typeof u.N=="number"?`array<${c}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${c}>`}return u.kind}const Qe=[Mr,Tt,Jt,Kt,Yr,Wr,Or,ae(gr),Ee,ee,Z];function Ge(u,c){if(c.kind==="error")return null;if(u.kind==="array"){if(c.kind==="array"&&(c.N===0&&c.itemType.kind==="value"||!Ge(u.itemType,c.itemType))&&(typeof u.N!="number"||u.N===c.N))return null}else{if(u.kind===c.kind)return null;if(u.kind==="value"){for(const h of Qe)if(!Ge(h,c))return null}}return`Expected ${Se(u)} but found ${Se(c)} instead.`}function Ke(u,c){return c.some(h=>h.kind===u.kind)}function Te(u,c){return c.some(h=>h==="null"?u===null:h==="array"?Array.isArray(u):h==="object"?u&&!Array.isArray(u)&&typeof u=="object":h===typeof u)}function Ze(u,c){return u.kind==="array"&&c.kind==="array"?u.itemType.kind===c.itemType.kind&&typeof u.N=="number":u.kind===c.kind}const yt=.96422,gt=.82521,ft=4/29,Vt=6/29,Yt=3*Vt*Vt,Er=Vt*Vt*Vt,lr=Math.PI/180,Ur=180/Math.PI;function Nr(u){return(u%=360)<0&&(u+=360),u}function Hr(u){let[c,h,p,b]=u,S,I;const F=mr((.2225045*(c=mn(c))+.7168786*(h=mn(h))+.0606169*(p=mn(p)))/1);c===h&&h===p?S=I=F:(S=mr((.4360747*c+.3850649*h+.1430804*p)/yt),I=mr((.0139322*c+.0971045*h+.7141733*p)/gt));const O=116*F-16;return[O<0?0:O,500*(S-F),200*(F-I),b]}function mn(u){return u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function mr(u){return u>Er?Math.pow(u,1/3):u/Yt+ft}function $r(u){let[c,h,p,b]=u,S=(c+16)/116,I=isNaN(h)?S:S+h/500,F=isNaN(p)?S:S-p/200;return S=1*kn(S),I=yt*kn(I),F=gt*kn(F),[bn(3.1338561*I-1.6168667*S-.4906146*F),bn(-.9787684*I+1.9161415*S+.033454*F),bn(.0719453*I-.2289914*S+1.4052427*F),b]}function bn(u){return(u=u<=.00304?12.92*u:1.055*Math.pow(u,1/2.4)-.055)<0?0:u>1?1:u}function kn(u){return u>Vt?u*u*u:Yt*(u-ft)}function ke(u){return parseInt(u.padEnd(2,u),16)/255}function Rt(u,c){return Lt(c?u/100:u,0,1)}function Lt(u,c,h){return Math.min(Math.max(c,u),h)}function nn(u){return!u.some(Number.isNaN)}const Pn={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Br{constructor(c,h,p){let b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;this.r=c,this.g=h,this.b=p,this.a=b,S||(this.r*=b,this.g*=b,this.b*=b,b||this.overwriteGetter("rgb",[c,h,p,b]))}static parse(c){if(c instanceof Br)return c;if(typeof c!="string")return;const h=function(p){if((p=p.toLowerCase().trim())==="transparent")return[0,0,0,0];const b=Pn[p];if(b){const[I,F,O]=b;return[I/255,F/255,O/255,1]}if(p.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(p)){const I=p.length<6?1:2;let F=1;return[ke(p.slice(F,F+=I)),ke(p.slice(F,F+=I)),ke(p.slice(F,F+=I)),ke(p.slice(F,F+I)||"ff")]}if(p.startsWith("rgb")){const I=p.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(I){const[F,O,G,K,J,ie,ce,Ae,Ce,Le,Ne,rt]=I,ze=[K||" ",ce||" ",Le].join("");if(ze==="  "||ze==="  /"||ze===",,"||ze===",,,"){const We=[G,ie,Ce].join(""),bt=We==="%%%"?100:We===""?255:0;if(bt){const wt=[Lt(+O/bt,0,1),Lt(+J/bt,0,1),Lt(+Ae/bt,0,1),Ne?Rt(+Ne,rt):1];if(nn(wt))return wt}}return}}const S=p.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(S){const[I,F,O,G,K,J,ie,ce,Ae]=S,Ce=[O||" ",K||" ",ie].join("");if(Ce==="  "||Ce==="  /"||Ce===",,"||Ce===",,,"){const Le=[+F,Lt(+G,0,100),Lt(+J,0,100),ce?Rt(+ce,Ae):1];if(nn(Le))return function(Ne){let[rt,ze,We,bt]=Ne;function wt(Zt){const hr=(Zt+rt/30)%12,Xt=ze*Math.min(We,1-We);return We-Xt*Math.max(-1,Math.min(hr-3,9-hr,1))}return rt=Nr(rt),ze/=100,We/=100,[wt(0),wt(8),wt(4),bt]}(Le)}}}(c);return h?new Br(...h,!1):void 0}get rgb(){const{r:c,g:h,b:p,a:b}=this,S=b||1/0;return this.overwriteGetter("rgb",[c/S,h/S,p/S,b])}get hcl(){return this.overwriteGetter("hcl",function(c){const[h,p,b,S]=Hr(c),I=Math.sqrt(p*p+b*b);return[Math.round(1e4*I)?Nr(Math.atan2(b,p)*Ur):NaN,I,h,S]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Hr(this.rgb))}overwriteGetter(c,h){return Object.defineProperty(this,c,{value:h}),h}toString(){const[c,h,p,b]=this.rgb;return`rgba(${[c,h,p].map(S=>Math.round(255*S)).join(",")},${b})`}}Br.black=new Br(0,0,0,1),Br.white=new Br(1,1,1,1),Br.transparent=new Br(0,0,0,0),Br.red=new Br(1,0,0,1);class yn{constructor(c,h,p){this.sensitivity=c?h?"variant":"case":h?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(c,h){return this.collator.compare(c,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class wi{constructor(c,h,p,b,S){this.text=c,this.image=h,this.scale=p,this.fontStack=b,this.textColor=S}}class _n{constructor(c){this.sections=c}static fromString(c){return new _n([new wi(c,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(c=>c.text.length!==0||c.image&&c.image.name.length!==0)}static factory(c){return c instanceof _n?c:_n.fromString(c)}toString(){return this.sections.length===0?"":this.sections.map(c=>c.text).join("")}}class sn{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof sn)return c;if(typeof c=="number")return new sn([c,c,c,c]);if(Array.isArray(c)&&!(c.length<1||c.length>4)){for(const h of c)if(typeof h!="number")return;switch(c.length){case 1:c=[c[0],c[0],c[0],c[0]];break;case 2:c=[c[0],c[1],c[0],c[1]];break;case 3:c=[c[0],c[1],c[2],c[1]]}return new sn(c)}}toString(){return JSON.stringify(this.values)}}const xi=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Jn{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof Jn)return c;if(Array.isArray(c)&&!(c.length<1)&&c.length%2==0){for(let h=0;h<c.length;h+=2){const p=c[h],b=c[h+1];if(typeof p!="string"||!xi.has(p)||!Array.isArray(b)||b.length!==2||typeof b[0]!="number"||typeof b[1]!="number")return}return new Jn(c)}}toString(){return JSON.stringify(this.values)}}class as{constructor(c){this.name=c.name,this.available=c.available}toString(){return this.name}static fromString(c){return c?new as({name:c,available:!1}):null}}function Os(u,c,h,p){return typeof u=="number"&&u>=0&&u<=255&&typeof c=="number"&&c>=0&&c<=255&&typeof h=="number"&&h>=0&&h<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[u,c,h,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[u,c,h,p]:[u,c,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function zo(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof Br||u instanceof yn||u instanceof _n||u instanceof sn||u instanceof Jn||u instanceof as)return!0;if(Array.isArray(u)){for(const c of u)if(!zo(c))return!1;return!0}if(typeof u=="object"){for(const c in u)if(!zo(u[c]))return!1;return!0}return!1}function Dr(u){if(u===null)return Mr;if(typeof u=="string")return Jt;if(typeof u=="boolean")return Kt;if(typeof u=="number")return Tt;if(u instanceof Br)return Yr;if(u instanceof yn)return an;if(u instanceof _n)return Wr;if(u instanceof sn)return Ee;if(u instanceof Jn)return Z;if(u instanceof as)return ee;if(Array.isArray(u)){const c=u.length;let h;for(const p of u){const b=Dr(p);if(h){if(h===b)continue;h=gr;break}h=b}return ae(h||gr,c)}return Or}function Js(u){const c=typeof u;return u===null?"":c==="string"||c==="number"||c==="boolean"?String(u):u instanceof Br||u instanceof _n||u instanceof sn||u instanceof Jn||u instanceof as?u.toString():JSON.stringify(u)}class Cs{constructor(c,h){this.type=c,this.value=h}static parse(c,h){if(c.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${c.length-1} instead.`);if(!zo(c[1]))return h.error("invalid value");const p=c[1];let b=Dr(p);const S=h.expectedType;return b.kind!=="array"||b.N!==0||!S||S.kind!=="array"||typeof S.N=="number"&&S.N!==0||(b=S),new Cs(b,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class In{constructor(c){this.name="ExpressionEvaluationError",this.message=c}toJSON(){return this.message}}const vo={string:Jt,number:Tt,boolean:Kt,object:Or};class Pi{constructor(c,h){this.type=c,this.args=h}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");let p,b=1;const S=c[0];if(S==="array"){let F,O;if(c.length>2){const G=c[1];if(typeof G!="string"||!(G in vo)||G==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);F=vo[G],b++}else F=gr;if(c.length>3){if(c[2]!==null&&(typeof c[2]!="number"||c[2]<0||c[2]!==Math.floor(c[2])))return h.error('The length argument to "array" must be a positive integer literal',2);O=c[2],b++}p=ae(F,O)}else{if(!vo[S])throw new Error(`Types doesn't contain name = ${S}`);p=vo[S]}const I=[];for(;b<c.length;b++){const F=h.parse(c[b],b,gr);if(!F)return null;I.push(F)}return new Pi(p,I)}evaluate(c){for(let h=0;h<this.args.length;h++){const p=this.args[h].evaluate(c);if(!Ge(this.type,Dr(p)))return p;if(h===this.args.length-1)throw new In(`Expected value to be of type ${Se(this.type)}, but found ${Se(Dr(p))} instead.`)}throw new Error}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}const Ui={"to-boolean":Kt,"to-color":Yr,"to-number":Tt,"to-string":Jt};class Yn{constructor(c,h){this.type=c,this.args=h}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");const p=c[0];if(!Ui[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p==="to-boolean"||p==="to-string")&&c.length!==2)return h.error("Expected one argument.");const b=Ui[p],S=[];for(let I=1;I<c.length;I++){const F=h.parse(c[I],I,gr);if(!F)return null;S.push(F)}return new Yn(b,S)}evaluate(c){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(c);case"color":{let h,p;for(const b of this.args){if(h=b.evaluate(c),p=null,h instanceof Br)return h;if(typeof h=="string"){const S=c.parseColor(h);if(S)return S}else if(Array.isArray(h)&&(p=h.length<3||h.length>4?`Invalid rbga value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:Os(h[0],h[1],h[2],h[3]),!p))return new Br(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new In(p||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const p of this.args){h=p.evaluate(c);const b=sn.parse(h);if(b)return b}throw new In(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const p of this.args){h=p.evaluate(c);const b=Jn.parse(h);if(b)return b}throw new In(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const p of this.args){if(h=p.evaluate(c),h===null)return 0;const b=Number(h);if(!isNaN(b))return b}throw new In(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return _n.fromString(Js(this.args[0].evaluate(c)));case"resolvedImage":return as.fromString(Js(this.args[0].evaluate(c)));default:return Js(this.args[0].evaluate(c))}}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}const Li=["Unknown","Point","LineString","Polygon"];class cn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Li[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(c){let h=this._parseColorCache[c];return h||(h=this._parseColorCache[c]=Br.parse(c)),h}}class Go{constructor(c,h){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],b=arguments.length>3?arguments[3]:void 0,S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:new xn,I=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[];this.registry=c,this.path=p,this.key=p.map(F=>`[${F}]`).join(""),this.scope=S,this.errors=I,this.expectedType=b,this._isConstant=h}parse(c,h,p,b){let S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};return h?this.concat(h,p,b)._parse(c,S):this._parse(c,S)}_parse(c,h){function p(b,S,I){return I==="assert"?new Pi(S,[b]):I==="coerce"?new Yn(S,[b]):b}if(c!==null&&typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"||(c=["literal",c]),Array.isArray(c)){if(c.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const b=c[0];if(typeof b!="string")return this.error(`Expression name must be a string, but found ${typeof b} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const S=this.registry[b];if(S){let I=S.parse(c,this);if(!I)return null;if(this.expectedType){const F=this.expectedType,O=I.type;if(F.kind!=="string"&&F.kind!=="number"&&F.kind!=="boolean"&&F.kind!=="object"&&F.kind!=="array"||O.kind!=="value")if(F.kind!=="color"&&F.kind!=="formatted"&&F.kind!=="resolvedImage"||O.kind!=="value"&&O.kind!=="string")if(F.kind!=="padding"||O.kind!=="value"&&O.kind!=="number"&&O.kind!=="array")if(F.kind!=="variableAnchorOffsetCollection"||O.kind!=="value"&&O.kind!=="array"){if(this.checkSubtype(F,O))return null}else I=p(I,F,h.typeAnnotation||"coerce");else I=p(I,F,h.typeAnnotation||"coerce");else I=p(I,F,h.typeAnnotation||"coerce");else I=p(I,F,h.typeAnnotation||"assert")}if(!(I instanceof Cs)&&I.type.kind!=="resolvedImage"&&this._isConstant(I)){const F=new cn;try{I=new Cs(I.type,I.evaluate(F))}catch(O){return this.error(O.message),null}}return I}return this.error(`Unknown expression "${b}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(c===void 0?"'undefined' value invalid. Use null instead.":typeof c=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof c} instead.`)}concat(c,h,p){const b=typeof c=="number"?this.path.concat(c):this.path,S=p?this.scope.concat(p):this.scope;return new Go(this.registry,this._isConstant,b,h||null,S,this.errors)}error(c){for(var h=arguments.length,p=new Array(h>1?h-1:0),b=1;b<h;b++)p[b-1]=arguments[b];const S=`${this.key}${p.map(I=>`[${I}]`).join("")}`;this.errors.push(new Dt(S,c))}checkSubtype(c,h){const p=Ge(c,h);return p&&this.error(p),p}}class Vo{constructor(c,h,p){this.type=an,this.locale=p,this.caseSensitive=c,this.diacriticSensitive=h}static parse(c,h){if(c.length!==2)return h.error("Expected one argument.");const p=c[1];if(typeof p!="object"||Array.isArray(p))return h.error("Collator options argument must be an object.");const b=h.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,Kt);if(!b)return null;const S=h.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,Kt);if(!S)return null;let I=null;return p.locale&&(I=h.parse(p.locale,1,Jt),!I)?null:new Vo(b,S,I)}evaluate(c){return new yn(this.caseSensitive.evaluate(c),this.diacriticSensitive.evaluate(c),this.locale?this.locale.evaluate(c):null)}eachChild(c){c(this.caseSensitive),c(this.diacriticSensitive),this.locale&&c(this.locale)}outputDefined(){return!1}}const Ys=8192;function fc(u,c){u[0]=Math.min(u[0],c[0]),u[1]=Math.min(u[1],c[1]),u[2]=Math.max(u[2],c[0]),u[3]=Math.max(u[3],c[1])}function he(u,c){return!(u[0]<=c[0]||u[2]>=c[2]||u[1]<=c[1]||u[3]>=c[3])}function Be(u,c){const h=(180+u[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,b=Math.pow(2,c.z);return[Math.round(h*b*Ys),Math.round(p*b*Ys)]}function He(u,c,h){const p=u[0]-c[0],b=u[1]-c[1],S=u[0]-h[0],I=u[1]-h[1];return p*I-S*b==0&&p*S<=0&&b*I<=0}function dt(u,c){let h=!1;for(let I=0,F=c.length;I<F;I++){const O=c[I];for(let G=0,K=O.length;G<K-1;G++){if(He(u,O[G],O[G+1]))return!1;(b=O[G])[1]>(p=u)[1]!=(S=O[G+1])[1]>p[1]&&p[0]<(S[0]-b[0])*(p[1]-b[1])/(S[1]-b[1])+b[0]&&(h=!h)}}var p,b,S;return h}function Mt(u,c){for(let h=0;h<c.length;h++)if(dt(u,c[h]))return!0;return!1}function sr(u,c,h,p){const b=p[0]-h[0],S=p[1]-h[1],I=(u[0]-h[0])*S-b*(u[1]-h[1]),F=(c[0]-h[0])*S-b*(c[1]-h[1]);return I>0&&F<0||I<0&&F>0}function zr(u,c,h){for(const G of h)for(let K=0;K<G.length-1;++K)if((F=[(I=G[K+1])[0]-(S=G[K])[0],I[1]-S[1]])[0]*(O=[(b=c)[0]-(p=u)[0],b[1]-p[1]])[1]-F[1]*O[0]!=0&&sr(p,b,S,I)&&sr(S,I,p,b))return!0;var p,b,S,I,F,O;return!1}function Wn(u,c){for(let h=0;h<u.length;++h)if(!dt(u[h],c))return!1;for(let h=0;h<u.length-1;++h)if(zr(u[h],u[h+1],c))return!1;return!0}function Zn(u,c){for(let h=0;h<c.length;h++)if(Wn(u,c[h]))return!0;return!1}function ui(u,c,h){const p=[];for(let b=0;b<u.length;b++){const S=[];for(let I=0;I<u[b].length;I++){const F=Be(u[b][I],h);fc(c,F),S.push(F)}p.push(S)}return p}function Nn(u,c,h){const p=[];for(let b=0;b<u.length;b++){const S=ui(u[b],c,h);p.push(S)}return p}function eh(u,c,h,p){if(u[0]<h[0]||u[0]>h[2]){const b=.5*p;let S=u[0]-h[0]>b?-p:h[0]-u[0]>b?p:0;S===0&&(S=u[0]-h[2]>b?-p:h[2]-u[0]>b?p:0),u[0]+=S}fc(c,u)}function al(u,c,h,p){const b=Math.pow(2,p.z)*Ys,S=[p.x*Ys,p.y*Ys],I=[];for(const F of u)for(const O of F){const G=[O.x+S[0],O.y+S[1]];eh(G,c,h,b),I.push(G)}return I}function Vr(u,c,h,p){const b=Math.pow(2,p.z)*Ys,S=[p.x*Ys,p.y*Ys],I=[];for(const O of u){const G=[];for(const K of O){const J=[K.x+S[0],K.y+S[1]];fc(c,J),G.push(J)}I.push(G)}if(c[2]-c[0]<=b/2){(F=c)[0]=F[1]=1/0,F[2]=F[3]=-1/0;for(const O of I)for(const G of O)eh(G,c,h,b)}var F;return I}class Qa{constructor(c,h){this.type=Kt,this.geojson=c,this.geometries=h}static parse(c,h){if(c.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${c.length-1} instead.`);if(zo(c[1])){const p=c[1];if(p.type==="FeatureCollection"){const b=[];for(const S of p.features){const{type:I,coordinates:F}=S.geometry;I==="Polygon"&&b.push(F),I==="MultiPolygon"&&b.push(...F)}if(b.length)return new Qa(p,{type:"MultiPolygon",coordinates:b})}else if(p.type==="Feature"){const b=p.geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new Qa(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Qa(p,p)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(h,p){const b=[1/0,1/0,-1/0,-1/0],S=[1/0,1/0,-1/0,-1/0],I=h.canonicalID();if(p.type==="Polygon"){const F=ui(p.coordinates,S,I),O=al(h.geometry(),b,S,I);if(!he(b,S))return!1;for(const G of O)if(!dt(G,F))return!1}if(p.type==="MultiPolygon"){const F=Nn(p.coordinates,S,I),O=al(h.geometry(),b,S,I);if(!he(b,S))return!1;for(const G of O)if(!Mt(G,F))return!1}return!0}(c,this.geometries);if(c.geometryType()==="LineString")return function(h,p){const b=[1/0,1/0,-1/0,-1/0],S=[1/0,1/0,-1/0,-1/0],I=h.canonicalID();if(p.type==="Polygon"){const F=ui(p.coordinates,S,I),O=Vr(h.geometry(),b,S,I);if(!he(b,S))return!1;for(const G of O)if(!Wn(G,F))return!1}if(p.type==="MultiPolygon"){const F=Nn(p.coordinates,S,I),O=Vr(h.geometry(),b,S,I);if(!he(b,S))return!1;for(const G of O)if(!Zn(G,F))return!1}return!0}(c,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class tu{constructor(c,h){this.type=h.type,this.name=c,this.boundExpression=h}static parse(c,h){if(c.length!==2||typeof c[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const p=c[1];return h.scope.has(p)?new tu(p,h.scope.get(p)):h.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(c){return this.boundExpression.evaluate(c)}eachChild(){}outputDefined(){return!1}}class _i{constructor(c,h,p,b){this.name=c,this.type=h,this._evaluate=p,this.args=b}evaluate(c){return this._evaluate(c,this.args)}eachChild(c){this.args.forEach(c)}outputDefined(){return!1}static parse(c,h){const p=c[0],b=_i.definitions[p];if(!b)return h.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const S=Array.isArray(b)?b[0]:b.type,I=Array.isArray(b)?[[b[1],b[2]]]:b.overloads,F=I.filter(G=>{let[K]=G;return!Array.isArray(K)||K.length===c.length-1});let O=null;for(const[G,K]of F){O=new Go(h.registry,pc,h.path,null,h.scope);const J=[];let ie=!1;for(let ce=1;ce<c.length;ce++){const Ae=c[ce],Ce=Array.isArray(G)?G[ce-1]:G.type,Le=O.parse(Ae,1+J.length,Ce);if(!Le){ie=!0;break}J.push(Le)}if(!ie)if(Array.isArray(G)&&G.length!==J.length)O.error(`Expected ${G.length} arguments, but found ${J.length} instead.`);else{for(let ce=0;ce<J.length;ce++){const Ae=Array.isArray(G)?G[ce]:G.type,Ce=J[ce];O.concat(ce+1).checkSubtype(Ae,Ce.type)}if(O.errors.length===0)return new _i(p,S,K,J)}}if(F.length===1)h.errors.push(...O.errors);else{const G=(F.length?F:I).map(J=>{let[ie]=J;return ce=ie,Array.isArray(ce)?`(${ce.map(Se).join(", ")})`:`(${Se(ce.type)}...)`;var ce}).join(" | "),K=[];for(let J=1;J<c.length;J++){const ie=h.parse(c[J],1+K.length);if(!ie)return null;K.push(Se(ie.type))}h.error(`Expected arguments of type ${G}, but found (${K.join(", ")}) instead.`)}return null}static register(c,h){_i.definitions=h;for(const p in h)c[p]=_i}}function pc(u){if(u instanceof tu)return pc(u.boundExpression);if(u instanceof _i&&u.name==="error"||u instanceof Vo||u instanceof Qa)return!1;const c=u instanceof Yn||u instanceof Pi;let h=!0;return u.eachChild(p=>{h=c?h&&pc(p):h&&p instanceof Cs}),!!h&&cl(u)&&Ha(u,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function cl(u){if(u instanceof _i&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof Qa)return!1;let c=!0;return u.eachChild(h=>{c&&!cl(h)&&(c=!1)}),c}function pa(u){if(u instanceof _i&&u.name==="feature-state")return!1;let c=!0;return u.eachChild(h=>{c&&!pa(h)&&(c=!1)}),c}function Ha(u,c){if(u instanceof _i&&c.indexOf(u.name)>=0)return!1;let h=!0;return u.eachChild(p=>{h&&!Ha(p,c)&&(h=!1)}),h}function ll(u,c){const h=u.length-1;let p,b,S=0,I=h,F=0;for(;S<=I;)if(F=Math.floor((S+I)/2),p=u[F],b=u[F+1],p<=c){if(F===h||c<b)return F;S=F+1}else{if(!(p>c))throw new In("Input is not a number.");I=F-1}return 0}class ul{constructor(c,h,p){this.type=c,this.input=h,this.labels=[],this.outputs=[];for(const[b,S]of p)this.labels.push(b),this.outputs.push(S)}static parse(c,h){if(c.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return h.error("Expected an even number of arguments.");const p=h.parse(c[1],1,Tt);if(!p)return null;const b=[];let S=null;h.expectedType&&h.expectedType.kind!=="value"&&(S=h.expectedType);for(let I=1;I<c.length;I+=2){const F=I===1?-1/0:c[I],O=c[I+1],G=I,K=I+1;if(typeof F!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(b.length&&b[b.length-1][0]>=F)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',G);const J=h.parse(O,K,S);if(!J)return null;S=S||J.type,b.push([F,J])}return new ul(S,p,b)}evaluate(c){const h=this.labels,p=this.outputs;if(h.length===1)return p[0].evaluate(c);const b=this.input.evaluate(c);if(b<=h[0])return p[0].evaluate(c);const S=h.length;return b>=h[S-1]?p[S-1].evaluate(c):p[ll(h,b)].evaluate(c)}eachChild(c){c(this.input);for(const h of this.outputs)c(h)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}}function Ad(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var $u=gc;function gc(u,c,h,p){this.cx=3*u,this.bx=3*(h-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(p-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=c,this.p2x=h,this.p2y=p}gc.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,c){if(c===void 0&&(c=1e-6),u<0)return 0;if(u>1)return 1;for(var h=u,p=0;p<8;p++){var b=this.sampleCurveX(h)-u;if(Math.abs(b)<c)return h;var S=this.sampleCurveDerivativeX(h);if(Math.abs(S)<1e-6)break;h-=b/S}var I=0,F=1;for(h=u,p=0;p<20&&(b=this.sampleCurveX(h),!(Math.abs(b-u)<c));p++)u>b?I=h:F=h,h=.5*(F-I)+I;return h},solve:function(u,c){return this.sampleCurveY(this.solveCurveX(u,c))}};var mc=Ad($u);function za(u,c,h){return u+h*(c-u)}function ga(u,c,h){return u.map((p,b)=>za(p,c[b],h))}const Ri={number:za,color:function(u,c,h){switch(arguments.length>3&&arguments[3]!==void 0?arguments[3]:"rgb"){case"rgb":{const[b,S,I,F]=ga(u.rgb,c.rgb,h);return new Br(b,S,I,F,!1)}case"hcl":{const[b,S,I,F]=u.hcl,[O,G,K,J]=c.hcl;let ie,ce;if(isNaN(b)||isNaN(O))isNaN(b)?isNaN(O)?ie=NaN:(ie=O,I!==1&&I!==0||(ce=G)):(ie=b,K!==1&&K!==0||(ce=S));else{let rt=O-b;O>b&&rt>180?rt-=360:O<b&&b-O>180&&(rt+=360),ie=b+h*rt}const[Ae,Ce,Le,Ne]=function(rt){let[ze,We,bt,wt]=rt;return ze=isNaN(ze)?0:ze*lr,$r([bt,Math.cos(ze)*We,Math.sin(ze)*We,wt])}([ie,ce??za(S,G,h),za(I,K,h),za(F,J,h)]);return new Br(Ae,Ce,Le,Ne,!1)}case"lab":{const[b,S,I,F]=$r(ga(u.lab,c.lab,h));return new Br(b,S,I,F,!1)}}},array:ga,padding:function(u,c,h){return new sn(ga(u.values,c.values,h))},variableAnchorOffsetCollection:function(u,c,h){const p=u.values,b=c.values;if(p.length!==b.length)throw new In(`Cannot interpolate values of different length. from: ${u.toString()}, to: ${c.toString()}`);const S=[];for(let I=0;I<p.length;I+=2){if(p[I]!==b[I])throw new In(`Cannot interpolate values containing mismatched anchors. from[${I}]: ${p[I]}, to[${I}]: ${b[I]}`);S.push(p[I]);const[F,O]=p[I+1],[G,K]=b[I+1];S.push([za(F,G,h),za(O,K,h)])}return new Jn(S)}};class Bi{constructor(c,h,p,b,S){this.type=c,this.operator=h,this.interpolation=p,this.input=b,this.labels=[],this.outputs=[];for(const[I,F]of S)this.labels.push(I),this.outputs.push(F)}static interpolationFactor(c,h,p,b){let S=0;if(c.name==="exponential")S=ln(h,c.base,p,b);else if(c.name==="linear")S=ln(h,1,p,b);else if(c.name==="cubic-bezier"){const I=c.controlPoints;S=new mc(I[0],I[1],I[2],I[3]).solve(ln(h,1,p,b))}return S}static parse(c,h){let[p,b,S,...I]=c;if(!Array.isArray(b)||b.length===0)return h.error("Expected an interpolation type expression.",1);if(b[0]==="linear")b={name:"linear"};else if(b[0]==="exponential"){const G=b[1];if(typeof G!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);b={name:"exponential",base:G}}else{if(b[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(b[0])}`,1,0);{const G=b.slice(1);if(G.length!==4||G.some(K=>typeof K!="number"||K<0||K>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);b={name:"cubic-bezier",controlPoints:G}}}if(c.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(S=h.parse(S,2,Tt),!S)return null;const F=[];let O=null;p==="interpolate-hcl"||p==="interpolate-lab"?O=Yr:h.expectedType&&h.expectedType.kind!=="value"&&(O=h.expectedType);for(let G=0;G<I.length;G+=2){const K=I[G],J=I[G+1],ie=G+3,ce=G+4;if(typeof K!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ie);if(F.length&&F[F.length-1][0]>=K)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ie);const Ae=h.parse(J,ce,O);if(!Ae)return null;O=O||Ae.type,F.push([K,Ae])}return Ze(O,Tt)||Ze(O,Yr)||Ze(O,Ee)||Ze(O,Z)||Ze(O,ae(Tt))?new Bi(O,p,b,S,F):h.error(`Type ${Se(O)} is not interpolatable.`)}evaluate(c){const h=this.labels,p=this.outputs;if(h.length===1)return p[0].evaluate(c);const b=this.input.evaluate(c);if(b<=h[0])return p[0].evaluate(c);const S=h.length;if(b>=h[S-1])return p[S-1].evaluate(c);const I=ll(h,b),F=Bi.interpolationFactor(this.interpolation,b,h[I],h[I+1]),O=p[I].evaluate(c),G=p[I+1].evaluate(c);switch(this.operator){case"interpolate":return Ri[this.type.kind](O,G,F);case"interpolate-hcl":return Ri.color(O,G,F,"hcl");case"interpolate-lab":return Ri.color(O,G,F,"lab")}}eachChild(c){c(this.input);for(const h of this.outputs)c(h)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}}function ln(u,c,h,p){const b=p-h,S=u-h;return b===0?0:c===1?S/b:(Math.pow(c,S)-1)/(Math.pow(c,b)-1)}class Al{constructor(c,h){this.type=c,this.args=h}static parse(c,h){if(c.length<2)return h.error("Expectected at least one argument.");let p=null;const b=h.expectedType;b&&b.kind!=="value"&&(p=b);const S=[];for(const F of c.slice(1)){const O=h.parse(F,1+S.length,p,void 0,{typeAnnotation:"omit"});if(!O)return null;p=p||O.type,S.push(O)}if(!p)throw new Error("No output type");const I=b&&S.some(F=>Ge(b,F.type));return new Al(I?gr:p,S)}evaluate(c){let h,p=null,b=0;for(const S of this.args)if(b++,p=S.evaluate(c),p&&p instanceof as&&!p.available&&(h||(h=p.name),p=null,b===this.args.length&&(p=h)),p!==null)break;return p}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}class hl{constructor(c,h){this.type=h.type,this.bindings=[].concat(c),this.result=h}evaluate(c){return this.result.evaluate(c)}eachChild(c){for(const h of this.bindings)c(h[1]);c(this.result)}static parse(c,h){if(c.length<4)return h.error(`Expected at least 3 arguments, but found ${c.length-1} instead.`);const p=[];for(let S=1;S<c.length-1;S+=2){const I=c[S];if(typeof I!="string")return h.error(`Expected string, but found ${typeof I} instead.`,S);if(/[^a-zA-Z0-9_]/.test(I))return h.error("Variable names must contain only alphanumeric characters or '_'.",S);const F=h.parse(c[S+1],S+1);if(!F)return null;p.push([I,F])}const b=h.parse(c[c.length-1],c.length-1,h.expectedType,p);return b?new hl(p,b):null}outputDefined(){return this.result.outputDefined()}}class ru{constructor(c,h,p){this.type=c,this.index=h,this.input=p}static parse(c,h){if(c.length!==3)return h.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const p=h.parse(c[1],1,Tt),b=h.parse(c[2],2,ae(h.expectedType||gr));return p&&b?new ru(b.type.itemType,p,b):null}evaluate(c){const h=this.index.evaluate(c),p=this.input.evaluate(c);if(h<0)throw new In(`Array index out of bounds: ${h} < 0.`);if(h>=p.length)throw new In(`Array index out of bounds: ${h} > ${p.length-1}.`);if(h!==Math.floor(h))throw new In(`Array index must be an integer, but found ${h} instead.`);return p[h]}eachChild(c){c(this.index),c(this.input)}outputDefined(){return!1}}class jo{constructor(c,h){this.type=Kt,this.needle=c,this.haystack=h}static parse(c,h){if(c.length!==3)return h.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const p=h.parse(c[1],1,gr),b=h.parse(c[2],2,gr);return p&&b?Ke(p.type,[Kt,Jt,Tt,Mr,gr])?new jo(p,b):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Se(p.type)} instead`):null}evaluate(c){const h=this.needle.evaluate(c),p=this.haystack.evaluate(c);if(!p)return!1;if(!Te(h,["boolean","string","number","null"]))throw new In(`Expected first argument to be of type boolean, string, number or null, but found ${Se(Dr(h))} instead.`);if(!Te(p,["string","array"]))throw new In(`Expected second argument to be of type array or string, but found ${Se(Dr(p))} instead.`);return p.indexOf(h)>=0}eachChild(c){c(this.needle),c(this.haystack)}outputDefined(){return!0}}class qo{constructor(c,h,p){this.type=Tt,this.needle=c,this.haystack=h,this.fromIndex=p}static parse(c,h){if(c.length<=2||c.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const p=h.parse(c[1],1,gr),b=h.parse(c[2],2,gr);if(!p||!b)return null;if(!Ke(p.type,[Kt,Jt,Tt,Mr,gr]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Se(p.type)} instead`);if(c.length===4){const S=h.parse(c[3],3,Tt);return S?new qo(p,b,S):null}return new qo(p,b)}evaluate(c){const h=this.needle.evaluate(c),p=this.haystack.evaluate(c);if(!Te(h,["boolean","string","number","null"]))throw new In(`Expected first argument to be of type boolean, string, number or null, but found ${Se(Dr(h))} instead.`);if(!Te(p,["string","array"]))throw new In(`Expected second argument to be of type array or string, but found ${Se(Dr(p))} instead.`);if(this.fromIndex){const b=this.fromIndex.evaluate(c);return p.indexOf(h,b)}return p.indexOf(h)}eachChild(c){c(this.needle),c(this.haystack),this.fromIndex&&c(this.fromIndex)}outputDefined(){return!1}}class Xu{constructor(c,h,p,b,S,I){this.inputType=c,this.type=h,this.input=p,this.cases=b,this.outputs=S,this.otherwise=I}static parse(c,h){if(c.length<5)return h.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if(c.length%2!=1)return h.error("Expected an even number of arguments.");let p,b;h.expectedType&&h.expectedType.kind!=="value"&&(b=h.expectedType);const S={},I=[];for(let G=2;G<c.length-1;G+=2){let K=c[G];const J=c[G+1];Array.isArray(K)||(K=[K]);const ie=h.concat(G);if(K.length===0)return ie.error("Expected at least one branch label.");for(const Ae of K){if(typeof Ae!="number"&&typeof Ae!="string")return ie.error("Branch labels must be numbers or strings.");if(typeof Ae=="number"&&Math.abs(Ae)>Number.MAX_SAFE_INTEGER)return ie.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Ae=="number"&&Math.floor(Ae)!==Ae)return ie.error("Numeric branch labels must be integer values.");if(p){if(ie.checkSubtype(p,Dr(Ae)))return null}else p=Dr(Ae);if(S[String(Ae)]!==void 0)return ie.error("Branch labels must be unique.");S[String(Ae)]=I.length}const ce=h.parse(J,G,b);if(!ce)return null;b=b||ce.type,I.push(ce)}const F=h.parse(c[1],1,gr);if(!F)return null;const O=h.parse(c[c.length-1],c.length-1,b);return O?F.type.kind!=="value"&&h.concat(1).checkSubtype(p,F.type)?null:new Xu(p,b,F,S,I,O):null}evaluate(c){const h=this.input.evaluate(c);return(Dr(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(c)}eachChild(c){c(this.input),this.outputs.forEach(c),c(this.otherwise)}outputDefined(){return this.outputs.every(c=>c.outputDefined())&&this.otherwise.outputDefined()}}class ma{constructor(c,h,p){this.type=c,this.branches=h,this.otherwise=p}static parse(c,h){if(c.length<4)return h.error(`Expected at least 3 arguments, but found only ${c.length-1}.`);if(c.length%2!=0)return h.error("Expected an odd number of arguments.");let p;h.expectedType&&h.expectedType.kind!=="value"&&(p=h.expectedType);const b=[];for(let I=1;I<c.length-1;I+=2){const F=h.parse(c[I],I,Kt);if(!F)return null;const O=h.parse(c[I+1],I+1,p);if(!O)return null;b.push([F,O]),p=p||O.type}const S=h.parse(c[c.length-1],c.length-1,p);if(!S)return null;if(!p)throw new Error("Can't infer output type");return new ma(p,b,S)}evaluate(c){for(const[h,p]of this.branches)if(h.evaluate(c))return p.evaluate(c);return this.otherwise.evaluate(c)}eachChild(c){for(const[h,p]of this.branches)c(h),c(p);c(this.otherwise)}outputDefined(){return this.branches.every(c=>{let[h,p]=c;return p.outputDefined()})&&this.otherwise.outputDefined()}}class Ds{constructor(c,h,p,b){this.type=c,this.input=h,this.beginIndex=p,this.endIndex=b}static parse(c,h){if(c.length<=2||c.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const p=h.parse(c[1],1,gr),b=h.parse(c[2],2,Tt);if(!p||!b)return null;if(!Ke(p.type,[ae(gr),Jt,gr]))return h.error(`Expected first argument to be of type array or string, but found ${Se(p.type)} instead`);if(c.length===4){const S=h.parse(c[3],3,Tt);return S?new Ds(p.type,p,b,S):null}return new Ds(p.type,p,b)}evaluate(c){const h=this.input.evaluate(c),p=this.beginIndex.evaluate(c);if(!Te(h,["string","array"]))throw new In(`Expected first argument to be of type array or string, but found ${Se(Dr(h))} instead.`);if(this.endIndex){const b=this.endIndex.evaluate(c);return h.slice(p,b)}return h.slice(p)}eachChild(c){c(this.input),c(this.beginIndex),this.endIndex&&c(this.endIndex)}outputDefined(){return!1}}function nu(u,c){return u==="=="||u==="!="?c.kind==="boolean"||c.kind==="string"||c.kind==="number"||c.kind==="null"||c.kind==="value":c.kind==="string"||c.kind==="number"||c.kind==="value"}function yc(u,c,h,p){return p.compare(c,h)===0}function _c(u,c,h){const p=u!=="=="&&u!=="!=";return class Sk{constructor(S,I,F){this.type=Kt,this.lhs=S,this.rhs=I,this.collator=F,this.hasUntypedArgument=S.type.kind==="value"||I.type.kind==="value"}static parse(S,I){if(S.length!==3&&S.length!==4)return I.error("Expected two or three arguments.");const F=S[0];let O=I.parse(S[1],1,gr);if(!O)return null;if(!nu(F,O.type))return I.concat(1).error(`"${F}" comparisons are not supported for type '${Se(O.type)}'.`);let G=I.parse(S[2],2,gr);if(!G)return null;if(!nu(F,G.type))return I.concat(2).error(`"${F}" comparisons are not supported for type '${Se(G.type)}'.`);if(O.type.kind!==G.type.kind&&O.type.kind!=="value"&&G.type.kind!=="value")return I.error(`Cannot compare types '${Se(O.type)}' and '${Se(G.type)}'.`);p&&(O.type.kind==="value"&&G.type.kind!=="value"?O=new Pi(G.type,[O]):O.type.kind!=="value"&&G.type.kind==="value"&&(G=new Pi(O.type,[G])));let K=null;if(S.length===4){if(O.type.kind!=="string"&&G.type.kind!=="string"&&O.type.kind!=="value"&&G.type.kind!=="value")return I.error("Cannot use collator to compare non-string types.");if(K=I.parse(S[3],3,an),!K)return null}return new Sk(O,G,K)}evaluate(S){const I=this.lhs.evaluate(S),F=this.rhs.evaluate(S);if(p&&this.hasUntypedArgument){const O=Dr(I),G=Dr(F);if(O.kind!==G.kind||O.kind!=="string"&&O.kind!=="number")throw new In(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${O.kind}, ${G.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const O=Dr(I),G=Dr(F);if(O.kind!=="string"||G.kind!=="string")return c(S,I,F)}return this.collator?h(S,I,F,this.collator.evaluate(S)):c(S,I,F)}eachChild(S){S(this.lhs),S(this.rhs),this.collator&&S(this.collator)}outputDefined(){return!0}}}const iu=_c("==",function(u,c,h){return c===h},yc),hd=_c("!=",function(u,c,h){return c!==h},function(u,c,h,p){return!yc(0,c,h,p)}),Ju=_c("<",function(u,c,h){return c<h},function(u,c,h,p){return p.compare(c,h)<0}),Yu=_c(">",function(u,c,h){return c>h},function(u,c,h,p){return p.compare(c,h)>0}),th=_c("<=",function(u,c,h){return c<=h},function(u,c,h,p){return p.compare(c,h)<=0}),su=_c(">=",function(u,c,h){return c>=h},function(u,c,h,p){return p.compare(c,h)>=0});class dl{constructor(c,h,p,b,S){this.type=Jt,this.number=c,this.locale=h,this.currency=p,this.minFractionDigits=b,this.maxFractionDigits=S}static parse(c,h){if(c.length!==3)return h.error("Expected two arguments.");const p=h.parse(c[1],1,Tt);if(!p)return null;const b=c[2];if(typeof b!="object"||Array.isArray(b))return h.error("NumberFormat options argument must be an object.");let S=null;if(b.locale&&(S=h.parse(b.locale,1,Jt),!S))return null;let I=null;if(b.currency&&(I=h.parse(b.currency,1,Jt),!I))return null;let F=null;if(b["min-fraction-digits"]&&(F=h.parse(b["min-fraction-digits"],1,Tt),!F))return null;let O=null;return b["max-fraction-digits"]&&(O=h.parse(b["max-fraction-digits"],1,Tt),!O)?null:new dl(p,S,I,F,O)}evaluate(c){return new Intl.NumberFormat(this.locale?this.locale.evaluate(c):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(c):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(c):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(c):void 0}).format(this.number.evaluate(c))}eachChild(c){c(this.number),this.locale&&c(this.locale),this.currency&&c(this.currency),this.minFractionDigits&&c(this.minFractionDigits),this.maxFractionDigits&&c(this.maxFractionDigits)}outputDefined(){return!1}}class vc{constructor(c){this.type=Wr,this.sections=c}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");const p=c[1];if(!Array.isArray(p)&&typeof p=="object")return h.error("First argument must be an image or text section.");const b=[];let S=!1;for(let I=1;I<=c.length-1;++I){const F=c[I];if(S&&typeof F=="object"&&!Array.isArray(F)){S=!1;let O=null;if(F["font-scale"]&&(O=h.parse(F["font-scale"],1,Tt),!O))return null;let G=null;if(F["text-font"]&&(G=h.parse(F["text-font"],1,ae(Jt)),!G))return null;let K=null;if(F["text-color"]&&(K=h.parse(F["text-color"],1,Yr),!K))return null;const J=b[b.length-1];J.scale=O,J.font=G,J.textColor=K}else{const O=h.parse(c[I],1,gr);if(!O)return null;const G=O.type.kind;if(G!=="string"&&G!=="value"&&G!=="null"&&G!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");S=!0,b.push({content:O,scale:null,font:null,textColor:null})}}return new vc(b)}evaluate(c){return new _n(this.sections.map(h=>{const p=h.content.evaluate(c);return Dr(p)===ee?new wi("",p,null,null,null):new wi(Js(p),null,h.scale?h.scale.evaluate(c):null,h.font?h.font.evaluate(c).join(","):null,h.textColor?h.textColor.evaluate(c):null)}))}eachChild(c){for(const h of this.sections)c(h.content),h.scale&&c(h.scale),h.font&&c(h.font),h.textColor&&c(h.textColor)}outputDefined(){return!1}}class ou{constructor(c){this.type=ee,this.input=c}static parse(c,h){if(c.length!==2)return h.error("Expected two arguments.");const p=h.parse(c[1],1,Jt);return p?new ou(p):h.error("No image name provided.")}evaluate(c){const h=this.input.evaluate(c),p=as.fromString(h);return p&&c.availableImages&&(p.available=c.availableImages.indexOf(h)>-1),p}eachChild(c){c(this.input)}outputDefined(){return!1}}class Zu{constructor(c){this.type=Tt,this.input=c}static parse(c,h){if(c.length!==2)return h.error(`Expected 1 argument, but found ${c.length-1} instead.`);const p=h.parse(c[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${Se(p.type)} instead.`):new Zu(p):null}evaluate(c){const h=this.input.evaluate(c);if(typeof h=="string"||Array.isArray(h))return h.length;throw new In(`Expected value to be of type string or array, but found ${Se(Dr(h))} instead.`)}eachChild(c){c(this.input)}outputDefined(){return!1}}const Ko={"==":iu,"!=":hd,">":Yu,"<":Ju,">=":su,"<=":th,array:Pi,at:ru,boolean:Pi,case:ma,coalesce:Al,collator:Vo,format:vc,image:ou,in:jo,"index-of":qo,interpolate:Bi,"interpolate-hcl":Bi,"interpolate-lab":Bi,length:Zu,let:hl,literal:Cs,match:Xu,number:Pi,"number-format":dl,object:Pi,slice:Ds,step:ul,string:Pi,"to-boolean":Yn,"to-color":Yn,"to-number":Yn,"to-string":Yn,var:tu,within:Qa};function bc(u,c){let[h,p,b,S]=c;h=h.evaluate(u),p=p.evaluate(u),b=b.evaluate(u);const I=S?S.evaluate(u):1,F=Os(h,p,b,I);if(F)throw new In(F);return new Br(h/255,p/255,b/255,I,!1)}function au(u,c){return u in c}function ya(u,c){const h=c[u];return h===void 0?null:h}function Wo(u){return{type:u}}function k(u){return{result:"success",value:u}}function re(u){return{result:"error",value:u}}function Pe(u){return u["property-type"]==="data-driven"||u["property-type"]==="cross-faded-data-driven"}function je(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function at(u){return!!u.expression&&u.expression.interpolated}function lt(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function Pt(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function cr(u){return u}function Pr(u,c){const h=c.type==="color",p=u.stops&&typeof u.stops[0][0]=="object",b=p||!(p||u.property!==void 0),S=u.type||(at(c)?"exponential":"interval");if(h||c.type==="padding"){const K=h?Br.parse:sn.parse;(u=Ir({},u)).stops&&(u.stops=u.stops.map(J=>[J[0],K(J[1])])),u.default=K(u.default?u.default:c.default)}if(u.colorSpace&&(I=u.colorSpace)!=="rgb"&&I!=="hcl"&&I!=="lab")throw new Error(`Unknown color space: "${u.colorSpace}"`);var I;let F,O,G;if(S==="exponential")F=br;else if(S==="interval")F=wn;else if(S==="categorical"){F=vr,O=Object.create(null);for(const K of u.stops)O[K[0]]=K[1];G=typeof u.stops[0][0]}else{if(S!=="identity")throw new Error(`Unknown function type "${S}"`);F=Ai}if(p){const K={},J=[];for(let Ae=0;Ae<u.stops.length;Ae++){const Ce=u.stops[Ae],Le=Ce[0].zoom;K[Le]===void 0&&(K[Le]={zoom:Le,type:u.type,property:u.property,default:u.default,stops:[]},J.push(Le)),K[Le].stops.push([Ce[0].value,Ce[1]])}const ie=[];for(const Ae of J)ie.push([K[Ae].zoom,Pr(K[Ae],c)]);const ce={name:"linear"};return{kind:"composite",interpolationType:ce,interpolationFactor:Bi.interpolationFactor.bind(void 0,ce),zoomStops:ie.map(Ae=>Ae[0]),evaluate:(Ae,Ce)=>{let{zoom:Le}=Ae;return br({stops:ie,base:u.base},c,Le).evaluate(Le,Ce)}}}if(b){const K=S==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:K,interpolationFactor:Bi.interpolationFactor.bind(void 0,K),zoomStops:u.stops.map(J=>J[0]),evaluate:J=>{let{zoom:ie}=J;return F(u,c,ie,O,G)}}}return{kind:"source",evaluate(K,J){const ie=J&&J.properties?J.properties[u.property]:void 0;return ie===void 0?Gr(u.default,c.default):F(u,c,ie,O,G)}}}function Gr(u,c,h){return u!==void 0?u:c!==void 0?c:h!==void 0?h:void 0}function vr(u,c,h,p,b){return Gr(typeof h===b?p[h]:void 0,u.default,c.default)}function wn(u,c,h){if(lt(h)!=="number")return Gr(u.default,c.default);const p=u.stops.length;if(p===1||h<=u.stops[0][0])return u.stops[0][1];if(h>=u.stops[p-1][0])return u.stops[p-1][1];const b=ll(u.stops.map(S=>S[0]),h);return u.stops[b][1]}function br(u,c,h){const p=u.base!==void 0?u.base:1;if(lt(h)!=="number")return Gr(u.default,c.default);const b=u.stops.length;if(b===1||h<=u.stops[0][0])return u.stops[0][1];if(h>=u.stops[b-1][0])return u.stops[b-1][1];const S=ll(u.stops.map(K=>K[0]),h),I=function(K,J,ie,ce){const Ae=ce-ie,Ce=K-ie;return Ae===0?0:J===1?Ce/Ae:(Math.pow(J,Ce)-1)/(Math.pow(J,Ae)-1)}(h,p,u.stops[S][0],u.stops[S+1][0]),F=u.stops[S][1],O=u.stops[S+1][1],G=Ri[c.type]||cr;return typeof F.evaluate=="function"?{evaluate(){for(var K=arguments.length,J=new Array(K),ie=0;ie<K;ie++)J[ie]=arguments[ie];const ce=F.evaluate.apply(void 0,J),Ae=O.evaluate.apply(void 0,J);if(ce!==void 0&&Ae!==void 0)return G(ce,Ae,I,u.colorSpace)}}:G(F,O,I,u.colorSpace)}function Ai(u,c,h){switch(c.type){case"color":h=Br.parse(h);break;case"formatted":h=_n.fromString(h.toString());break;case"resolvedImage":h=as.fromString(h.toString());break;case"padding":h=sn.parse(h);break;default:lt(h)===c.type||c.type==="enum"&&c.values[h]||(h=void 0)}return Gr(h,u.default,c.default)}_i.register(Ko,{error:[{kind:"error"},[Jt],(u,c)=>{let[h]=c;throw new In(h.evaluate(u))}],typeof:[Jt,[gr],(u,c)=>{let[h]=c;return Se(Dr(h.evaluate(u)))}],"to-rgba":[ae(Tt,4),[Yr],(u,c)=>{let[h]=c;const[p,b,S,I]=h.evaluate(u).rgb;return[255*p,255*b,255*S,I]}],rgb:[Yr,[Tt,Tt,Tt],bc],rgba:[Yr,[Tt,Tt,Tt,Tt],bc],has:{type:Kt,overloads:[[[Jt],(u,c)=>{let[h]=c;return au(h.evaluate(u),u.properties())}],[[Jt,Or],(u,c)=>{let[h,p]=c;return au(h.evaluate(u),p.evaluate(u))}]]},get:{type:gr,overloads:[[[Jt],(u,c)=>{let[h]=c;return ya(h.evaluate(u),u.properties())}],[[Jt,Or],(u,c)=>{let[h,p]=c;return ya(h.evaluate(u),p.evaluate(u))}]]},"feature-state":[gr,[Jt],(u,c)=>{let[h]=c;return ya(h.evaluate(u),u.featureState||{})}],properties:[Or,[],u=>u.properties()],"geometry-type":[Jt,[],u=>u.geometryType()],id:[gr,[],u=>u.id()],zoom:[Tt,[],u=>u.globals.zoom],"heatmap-density":[Tt,[],u=>u.globals.heatmapDensity||0],"line-progress":[Tt,[],u=>u.globals.lineProgress||0],accumulated:[gr,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[Tt,Wo(Tt),(u,c)=>{let h=0;for(const p of c)h+=p.evaluate(u);return h}],"*":[Tt,Wo(Tt),(u,c)=>{let h=1;for(const p of c)h*=p.evaluate(u);return h}],"-":{type:Tt,overloads:[[[Tt,Tt],(u,c)=>{let[h,p]=c;return h.evaluate(u)-p.evaluate(u)}],[[Tt],(u,c)=>{let[h]=c;return-h.evaluate(u)}]]},"/":[Tt,[Tt,Tt],(u,c)=>{let[h,p]=c;return h.evaluate(u)/p.evaluate(u)}],"%":[Tt,[Tt,Tt],(u,c)=>{let[h,p]=c;return h.evaluate(u)%p.evaluate(u)}],ln2:[Tt,[],()=>Math.LN2],pi:[Tt,[],()=>Math.PI],e:[Tt,[],()=>Math.E],"^":[Tt,[Tt,Tt],(u,c)=>{let[h,p]=c;return Math.pow(h.evaluate(u),p.evaluate(u))}],sqrt:[Tt,[Tt],(u,c)=>{let[h]=c;return Math.sqrt(h.evaluate(u))}],log10:[Tt,[Tt],(u,c)=>{let[h]=c;return Math.log(h.evaluate(u))/Math.LN10}],ln:[Tt,[Tt],(u,c)=>{let[h]=c;return Math.log(h.evaluate(u))}],log2:[Tt,[Tt],(u,c)=>{let[h]=c;return Math.log(h.evaluate(u))/Math.LN2}],sin:[Tt,[Tt],(u,c)=>{let[h]=c;return Math.sin(h.evaluate(u))}],cos:[Tt,[Tt],(u,c)=>{let[h]=c;return Math.cos(h.evaluate(u))}],tan:[Tt,[Tt],(u,c)=>{let[h]=c;return Math.tan(h.evaluate(u))}],asin:[Tt,[Tt],(u,c)=>{let[h]=c;return Math.asin(h.evaluate(u))}],acos:[Tt,[Tt],(u,c)=>{let[h]=c;return Math.acos(h.evaluate(u))}],atan:[Tt,[Tt],(u,c)=>{let[h]=c;return Math.atan(h.evaluate(u))}],min:[Tt,Wo(Tt),(u,c)=>Math.min(...c.map(h=>h.evaluate(u)))],max:[Tt,Wo(Tt),(u,c)=>Math.max(...c.map(h=>h.evaluate(u)))],abs:[Tt,[Tt],(u,c)=>{let[h]=c;return Math.abs(h.evaluate(u))}],round:[Tt,[Tt],(u,c)=>{let[h]=c;const p=h.evaluate(u);return p<0?-Math.round(-p):Math.round(p)}],floor:[Tt,[Tt],(u,c)=>{let[h]=c;return Math.floor(h.evaluate(u))}],ceil:[Tt,[Tt],(u,c)=>{let[h]=c;return Math.ceil(h.evaluate(u))}],"filter-==":[Kt,[Jt,gr],(u,c)=>{let[h,p]=c;return u.properties()[h.value]===p.value}],"filter-id-==":[Kt,[gr],(u,c)=>{let[h]=c;return u.id()===h.value}],"filter-type-==":[Kt,[Jt],(u,c)=>{let[h]=c;return u.geometryType()===h.value}],"filter-<":[Kt,[Jt,gr],(u,c)=>{let[h,p]=c;const b=u.properties()[h.value],S=p.value;return typeof b==typeof S&&b<S}],"filter-id-<":[Kt,[gr],(u,c)=>{let[h]=c;const p=u.id(),b=h.value;return typeof p==typeof b&&p<b}],"filter->":[Kt,[Jt,gr],(u,c)=>{let[h,p]=c;const b=u.properties()[h.value],S=p.value;return typeof b==typeof S&&b>S}],"filter-id->":[Kt,[gr],(u,c)=>{let[h]=c;const p=u.id(),b=h.value;return typeof p==typeof b&&p>b}],"filter-<=":[Kt,[Jt,gr],(u,c)=>{let[h,p]=c;const b=u.properties()[h.value],S=p.value;return typeof b==typeof S&&b<=S}],"filter-id-<=":[Kt,[gr],(u,c)=>{let[h]=c;const p=u.id(),b=h.value;return typeof p==typeof b&&p<=b}],"filter->=":[Kt,[Jt,gr],(u,c)=>{let[h,p]=c;const b=u.properties()[h.value],S=p.value;return typeof b==typeof S&&b>=S}],"filter-id->=":[Kt,[gr],(u,c)=>{let[h]=c;const p=u.id(),b=h.value;return typeof p==typeof b&&p>=b}],"filter-has":[Kt,[gr],(u,c)=>{let[h]=c;return h.value in u.properties()}],"filter-has-id":[Kt,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Kt,[ae(Jt)],(u,c)=>{let[h]=c;return h.value.indexOf(u.geometryType())>=0}],"filter-id-in":[Kt,[ae(gr)],(u,c)=>{let[h]=c;return h.value.indexOf(u.id())>=0}],"filter-in-small":[Kt,[Jt,ae(gr)],(u,c)=>{let[h,p]=c;return p.value.indexOf(u.properties()[h.value])>=0}],"filter-in-large":[Kt,[Jt,ae(gr)],(u,c)=>{let[h,p]=c;return function(b,S,I,F){for(;I<=F;){const O=I+F>>1;if(S[O]===b)return!0;S[O]>b?F=O-1:I=O+1}return!1}(u.properties()[h.value],p.value,0,p.value.length-1)}],all:{type:Kt,overloads:[[[Kt,Kt],(u,c)=>{let[h,p]=c;return h.evaluate(u)&&p.evaluate(u)}],[Wo(Kt),(u,c)=>{for(const h of c)if(!h.evaluate(u))return!1;return!0}]]},any:{type:Kt,overloads:[[[Kt,Kt],(u,c)=>{let[h,p]=c;return h.evaluate(u)||p.evaluate(u)}],[Wo(Kt),(u,c)=>{for(const h of c)if(h.evaluate(u))return!0;return!1}]]},"!":[Kt,[Kt],(u,c)=>{let[h]=c;return!h.evaluate(u)}],"is-supported-script":[Kt,[Jt],(u,c)=>{let[h]=c;const p=u.globals&&u.globals.isSupportedScript;return!p||p(h.evaluate(u))}],upcase:[Jt,[Jt],(u,c)=>{let[h]=c;return h.evaluate(u).toUpperCase()}],downcase:[Jt,[Jt],(u,c)=>{let[h]=c;return h.evaluate(u).toLowerCase()}],concat:[Jt,Wo(gr),(u,c)=>c.map(h=>Js(h.evaluate(u))).join("")],"resolved-locale":[Jt,[an],(u,c)=>{let[h]=c;return h.evaluate(u).resolvedLocale()}]});class Kr{constructor(c,h){var p;this.expression=c,this._warningHistory={},this._evaluator=new cn,this._defaultValue=h?(p=h).type==="color"&&Pt(p.default)?new Br(0,0,0,0):p.type==="color"?Br.parse(p.default)||null:p.type==="padding"?sn.parse(p.default)||null:p.type==="variableAnchorOffsetCollection"?Jn.parse(p.default)||null:p.default===void 0?null:p.default:null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(c,h,p,b,S,I){return this._evaluator.globals=c,this._evaluator.feature=h,this._evaluator.featureState=p,this._evaluator.canonical=b,this._evaluator.availableImages=S||null,this._evaluator.formattedSection=I,this.expression.evaluate(this._evaluator)}evaluate(c,h,p,b,S,I){this._evaluator.globals=c,this._evaluator.feature=h||null,this._evaluator.featureState=p||null,this._evaluator.canonical=b,this._evaluator.availableImages=S||null,this._evaluator.formattedSection=I||null;try{const F=this.expression.evaluate(this._evaluator);if(F==null||typeof F=="number"&&F!=F)return this._defaultValue;if(this._enumValues&&!(F in this._enumValues))throw new In(`Expected value to be one of ${Object.keys(this._enumValues).map(O=>JSON.stringify(O)).join(", ")}, but found ${JSON.stringify(F)} instead.`);return F}catch(F){return this._warningHistory[F.message]||(this._warningHistory[F.message]=!0,typeof console<"u"&&console.warn(F.message)),this._defaultValue}}}function Xr(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in Ko}function si(u,c){const h=new Go(Ko,pc,[],c?function(b){const S={color:Yr,string:Jt,number:Tt,enum:Jt,boolean:Kt,formatted:Wr,padding:Ee,resolvedImage:ee,variableAnchorOffsetCollection:Z};return b.type==="array"?ae(S[b.value]||gr,b.length):S[b.type]}(c):void 0),p=h.parse(u,void 0,void 0,void 0,c&&c.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?k(new Kr(p,c)):re(h.errors)}class ks{constructor(c,h){this.kind=c,this._styleExpression=h,this.isStateDependent=c!=="constant"&&!pa(h.expression)}evaluateWithoutErrorHandling(c,h,p,b,S,I){return this._styleExpression.evaluateWithoutErrorHandling(c,h,p,b,S,I)}evaluate(c,h,p,b,S,I){return this._styleExpression.evaluate(c,h,p,b,S,I)}}class Ns{constructor(c,h,p,b){this.kind=c,this.zoomStops=p,this._styleExpression=h,this.isStateDependent=c!=="camera"&&!pa(h.expression),this.interpolationType=b}evaluateWithoutErrorHandling(c,h,p,b,S,I){return this._styleExpression.evaluateWithoutErrorHandling(c,h,p,b,S,I)}evaluate(c,h,p,b,S,I){return this._styleExpression.evaluate(c,h,p,b,S,I)}interpolationFactor(c,h,p){return this.interpolationType?Bi.interpolationFactor(this.interpolationType,c,h,p):0}}function _a(u,c){const h=si(u,c);if(h.result==="error")return h;const p=h.value.expression,b=cl(p);if(!b&&!Pe(c))return re([new Dt("","data expressions not supported")]);const S=Ha(p,["zoom"]);if(!S&&!je(c))return re([new Dt("","zoom expressions not supported")]);const I=wc(p);return I||S?I instanceof Dt?re([I]):I instanceof Bi&&!at(c)?re([new Dt("",'"interpolate" expressions cannot be used with this property')]):k(I?new Ns(b?"camera":"composite",h.value,I.labels,I instanceof Bi?I.interpolation:void 0):new ks(b?"constant":"source",h.value)):re([new Dt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class fl{constructor(c,h){this._parameters=c,this._specification=h,Ir(this,Pr(this._parameters,this._specification))}static deserialize(c){return new fl(c._parameters,c._specification)}static serialize(c){return{_parameters:c._parameters,_specification:c._specification}}}function wc(u){let c=null;if(u instanceof hl)c=wc(u.result);else if(u instanceof Al){for(const h of u.args)if(c=wc(h),c)break}else(u instanceof ul||u instanceof Bi)&&u.input instanceof _i&&u.input.name==="zoom"&&(c=u);return c instanceof Dt||u.eachChild(h=>{const p=wc(h);p instanceof Dt?c=p:!c&&p?c=new Dt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):c&&p&&c!==p&&(c=new Dt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),c}function xc(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const c of u.slice(1))if(!xc(c)&&typeof c!="boolean")return!1;return!0;default:return!0}}const pl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Bc(u){if(u==null)return{filter:()=>!0,needGeometry:!1};xc(u)||(u=cs(u));const c=si(u,pl);if(c.result==="error")throw new Error(c.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,p,b)=>c.value.evaluate(h,p,{},b),needGeometry:Ga(u)}}function cu(u,c){return u<c?-1:u>c?1:0}function Ga(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(let c=1;c<u.length;c++)if(Ga(u[c]))return!0;return!1}function cs(u){if(!u)return!0;const c=u[0];return u.length<=1?c!=="any":c==="=="?Cc(u[1],u[2],"=="):c==="!="?Ec(Cc(u[1],u[2],"==")):c==="<"||c===">"||c==="<="||c===">="?Cc(u[1],u[2],c):c==="any"?(h=u.slice(1),["any"].concat(h.map(cs))):c==="all"?["all"].concat(u.slice(1).map(cs)):c==="none"?["all"].concat(u.slice(1).map(cs).map(Ec)):c==="in"?gl(u[1],u.slice(2)):c==="!in"?Ec(gl(u[1],u.slice(2))):c==="has"?ml(u[1]):c==="!has"?Ec(ml(u[1])):c!=="within"||u;var h}function Cc(u,c,h){switch(u){case"$type":return[`filter-type-${h}`,c];case"$id":return[`filter-id-${h}`,c];default:return[`filter-${h}`,u,c]}}function gl(u,c){if(c.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",c]];case"$id":return["filter-id-in",["literal",c]];default:return c.length>200&&!c.some(h=>typeof h!=typeof c[0])?["filter-in-large",u,["literal",c.sort(cu)]]:["filter-in-small",u,["literal",c]]}}function ml(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function Ec(u){return["!",u]}function vs(u){const c=typeof u;if(c==="number"||c==="boolean"||c==="string"||u==null)return JSON.stringify(u);if(Array.isArray(u)){let b="[";for(const S of u)b+=`${vs(S)},`;return`${b}]`}const h=Object.keys(u).sort();let p="{";for(let b=0;b<h.length;b++)p+=`${JSON.stringify(h[b])}:${vs(u[h[b]])},`;return`${p}}`}function dd(u){let c="";for(const h of tr)c+=`/${vs(u[h])}`;return c}function lu(u){const c=u.value;return c?[new pt(u.key,c,"constants have been deprecated as of v8")]:[]}function $n(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function qi(u){if(Array.isArray(u))return u.map(qi);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const c={};for(const h in u)c[h]=qi(u[h]);return c}return $n(u)}function Oi(u){const c=u.key,h=u.value,p=u.valueSpec||{},b=u.objectElementValidators||{},S=u.style,I=u.styleSpec,F=u.validateSpec;let O=[];const G=lt(h);if(G!=="object")return[new pt(c,h,`object expected, ${G} found`)];for(const K in h){const J=K.split(".")[0],ie=p[J]||p["*"];let ce;if(b[J])ce=b[J];else if(p[J])ce=F;else if(b["*"])ce=b["*"];else{if(!p["*"]){O.push(new pt(c,h[K],`unknown property "${K}"`));continue}ce=F}O=O.concat(ce({key:(c&&`${c}.`)+K,value:h[K],valueSpec:ie,style:S,styleSpec:I,object:h,objectKey:K,validateSpec:F},h))}for(const K in p)b[K]||p[K].required&&p[K].default===void 0&&h[K]===void 0&&O.push(new pt(c,h,`missing required property "${K}"`));return O}function eA(u){const c=u.value,h=u.valueSpec,p=u.style,b=u.styleSpec,S=u.key,I=u.arrayElementValidator||u.validateSpec;if(lt(c)!=="array")return[new pt(S,c,`array expected, ${lt(c)} found`)];if(h.length&&c.length!==h.length)return[new pt(S,c,`array length ${h.length} expected, length ${c.length} found`)];if(h["min-length"]&&c.length<h["min-length"])return[new pt(S,c,`array length at least ${h["min-length"]} expected, length ${c.length} found`)];let F={type:h.value,values:h.values};b.$version<7&&(F.function=h.function),lt(h.value)==="object"&&(F=h.value);let O=[];for(let G=0;G<c.length;G++)O=O.concat(I({array:c,arrayIndex:G,value:c[G],valueSpec:F,validateSpec:u.validateSpec,style:p,styleSpec:b,key:`${S}[${G}]`}));return O}function uu(u){const c=u.key,h=u.value,p=u.valueSpec;let b=lt(h);return b==="number"&&h!=h&&(b="NaN"),b!=="number"?[new pt(c,h,`number expected, ${b} found`)]:"minimum"in p&&h<p.minimum?[new pt(c,h,`${h} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&h>p.maximum?[new pt(c,h,`${h} is greater than the maximum value ${p.maximum}`)]:[]}function Va(u){const c=u.valueSpec,h=$n(u.value.type);let p,b,S,I={};const F=h!=="categorical"&&u.value.property===void 0,O=!F,G=lt(u.value.stops)==="array"&&lt(u.value.stops[0])==="array"&&lt(u.value.stops[0][0])==="object",K=Oi({key:u.key,value:u.value,valueSpec:u.styleSpec.function,validateSpec:u.validateSpec,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(ce){if(h==="identity")return[new pt(ce.key,ce.value,'identity function may not have a "stops" property')];let Ae=[];const Ce=ce.value;return Ae=Ae.concat(eA({key:ce.key,value:Ce,valueSpec:ce.valueSpec,validateSpec:ce.validateSpec,style:ce.style,styleSpec:ce.styleSpec,arrayElementValidator:J})),lt(Ce)==="array"&&Ce.length===0&&Ae.push(new pt(ce.key,Ce,"array must have at least one stop")),Ae},default:function(ce){return ce.validateSpec({key:ce.key,value:ce.value,valueSpec:c,validateSpec:ce.validateSpec,style:ce.style,styleSpec:ce.styleSpec})}}});return h==="identity"&&F&&K.push(new pt(u.key,u.value,'missing required property "property"')),h==="identity"||u.value.stops||K.push(new pt(u.key,u.value,'missing required property "stops"')),h==="exponential"&&u.valueSpec.expression&&!at(u.valueSpec)&&K.push(new pt(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(O&&!Pe(u.valueSpec)?K.push(new pt(u.key,u.value,"property functions not supported")):F&&!je(u.valueSpec)&&K.push(new pt(u.key,u.value,"zoom functions not supported"))),h!=="categorical"&&!G||u.value.property!==void 0||K.push(new pt(u.key,u.value,'"property" property is required')),K;function J(ce){let Ae=[];const Ce=ce.value,Le=ce.key;if(lt(Ce)!=="array")return[new pt(Le,Ce,`array expected, ${lt(Ce)} found`)];if(Ce.length!==2)return[new pt(Le,Ce,`array length 2 expected, length ${Ce.length} found`)];if(G){if(lt(Ce[0])!=="object")return[new pt(Le,Ce,`object expected, ${lt(Ce[0])} found`)];if(Ce[0].zoom===void 0)return[new pt(Le,Ce,"object stop key must have zoom")];if(Ce[0].value===void 0)return[new pt(Le,Ce,"object stop key must have value")];if(S&&S>$n(Ce[0].zoom))return[new pt(Le,Ce[0].zoom,"stop zoom values must appear in ascending order")];$n(Ce[0].zoom)!==S&&(S=$n(Ce[0].zoom),b=void 0,I={}),Ae=Ae.concat(Oi({key:`${Le}[0]`,value:Ce[0],valueSpec:{zoom:{}},validateSpec:ce.validateSpec,style:ce.style,styleSpec:ce.styleSpec,objectElementValidators:{zoom:uu,value:ie}}))}else Ae=Ae.concat(ie({key:`${Le}[0]`,value:Ce[0],valueSpec:{},validateSpec:ce.validateSpec,style:ce.style,styleSpec:ce.styleSpec},Ce));return Xr(qi(Ce[1]))?Ae.concat([new pt(`${Le}[1]`,Ce[1],"expressions are not allowed in function stops.")]):Ae.concat(ce.validateSpec({key:`${Le}[1]`,value:Ce[1],valueSpec:c,validateSpec:ce.validateSpec,style:ce.style,styleSpec:ce.styleSpec}))}function ie(ce,Ae){const Ce=lt(ce.value),Le=$n(ce.value),Ne=ce.value!==null?ce.value:Ae;if(p){if(Ce!==p)return[new pt(ce.key,Ne,`${Ce} stop domain type must match previous stop domain type ${p}`)]}else p=Ce;if(Ce!=="number"&&Ce!=="string"&&Ce!=="boolean")return[new pt(ce.key,Ne,"stop domain value must be a number, string, or boolean")];if(Ce!=="number"&&h!=="categorical"){let rt=`number expected, ${Ce} found`;return Pe(c)&&h===void 0&&(rt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new pt(ce.key,Ne,rt)]}return h!=="categorical"||Ce!=="number"||isFinite(Le)&&Math.floor(Le)===Le?h!=="categorical"&&Ce==="number"&&b!==void 0&&Le<b?[new pt(ce.key,Ne,"stop domain values must appear in ascending order")]:(b=Le,h==="categorical"&&Le in I?[new pt(ce.key,Ne,"stop domain values must be unique")]:(I[Le]=!0,[])):[new pt(ce.key,Ne,`integer expected, found ${Le}`)]}}function Di(u){const c=(u.expressionContext==="property"?_a:si)(qi(u.value),u.valueSpec);if(c.result==="error")return c.value.map(p=>new pt(`${u.key}${p.key}`,u.value,p.message));const h=c.value.expression||c.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!h.outputDefined())return[new pt(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!pa(h))return[new pt(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter"&&!pa(h))return[new pt(u.key,u.value,'"feature-state" data expressions are not supported with filters.')];if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!Ha(h,["zoom","feature-state"]))return[new pt(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!cl(h))return[new pt(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ki(u){const c=u.key,h=u.value,p=u.valueSpec,b=[];return Array.isArray(p.values)?p.values.indexOf($n(h))===-1&&b.push(new pt(c,h,`expected one of [${p.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(p.values).indexOf($n(h))===-1&&b.push(new pt(c,h,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(h)} found`)),b}function Zs(u){return xc(qi(u.value))?Di(Ir({},u,{expressionContext:"filter",valueSpec:{value:"boolean"}})):bo(u)}function bo(u){const c=u.value,h=u.key;if(lt(c)!=="array")return[new pt(h,c,`array expected, ${lt(c)} found`)];const p=u.styleSpec;let b,S=[];if(c.length<1)return[new pt(h,c,"filter array must have at least 1 element")];switch(S=S.concat(Ki({key:`${h}[0]`,value:c[0],valueSpec:p.filter_operator,style:u.style,styleSpec:u.styleSpec})),$n(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&$n(c[1])==="$type"&&S.push(new pt(h,c,`"$type" cannot be use with operator "${c[0]}"`));case"==":case"!=":c.length!==3&&S.push(new pt(h,c,`filter array for operator "${c[0]}" must have 3 elements`));case"in":case"!in":c.length>=2&&(b=lt(c[1]),b!=="string"&&S.push(new pt(`${h}[1]`,c[1],`string expected, ${b} found`)));for(let I=2;I<c.length;I++)b=lt(c[I]),$n(c[1])==="$type"?S=S.concat(Ki({key:`${h}[${I}]`,value:c[I],valueSpec:p.geometry_type,style:u.style,styleSpec:u.styleSpec})):b!=="string"&&b!=="number"&&b!=="boolean"&&S.push(new pt(`${h}[${I}]`,c[I],`string, number, or boolean expected, ${b} found`));break;case"any":case"all":case"none":for(let I=1;I<c.length;I++)S=S.concat(bo({key:`${h}[${I}]`,value:c[I],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":b=lt(c[1]),c.length!==2?S.push(new pt(h,c,`filter array for "${c[0]}" operator must have 2 elements`)):b!=="string"&&S.push(new pt(`${h}[1]`,c[1],`string expected, ${b} found`));break;case"within":b=lt(c[1]),c.length!==2?S.push(new pt(h,c,`filter array for "${c[0]}" operator must have 2 elements`)):b!=="object"&&S.push(new pt(`${h}[1]`,c[1],`object expected, ${b} found`))}return S}function wo(u,c){const h=u.key,p=u.validateSpec,b=u.style,S=u.styleSpec,I=u.value,F=u.objectKey,O=S[`${c}_${u.layerType}`];if(!O)return[];const G=F.match(/^(.*)-transition$/);if(c==="paint"&&G&&O[G[1]]&&O[G[1]].transition)return p({key:h,value:I,valueSpec:S.transition,style:b,styleSpec:S});const K=u.valueSpec||O[F];if(!K)return[new pt(h,I,`unknown property "${F}"`)];let J;if(lt(I)==="string"&&Pe(K)&&!K.tokens&&(J=/^{([^}]+)}$/.exec(I)))return[new pt(h,I,`"${F}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(J[1])} }\`.`)];const ie=[];return u.layerType==="symbol"&&(F==="text-field"&&b&&!b.glyphs&&ie.push(new pt(h,I,'use of "text-field" requires a style "glyphs" property')),F==="text-font"&&Pt(qi(I))&&$n(I.type)==="identity"&&ie.push(new pt(h,I,'"text-font" does not support identity functions'))),ie.concat(p({key:u.key,value:I,valueSpec:K,style:b,styleSpec:S,expressionContext:"property",propertyType:c,propertyKey:F}))}function Sc(u){return wo(u,"paint")}function eo(u){return wo(u,"layout")}function va(u){let c=[];const h=u.value,p=u.key,b=u.style,S=u.styleSpec;h.type||h.ref||c.push(new pt(p,h,'either "type" or "ref" is required'));let I=$n(h.type);const F=$n(h.ref);if(h.id){const O=$n(h.id);for(let G=0;G<u.arrayIndex;G++){const K=b.layers[G];$n(K.id)===O&&c.push(new pt(p,h.id,`duplicate layer id "${h.id}", previously used at line ${K.id.__line__}`))}}if("ref"in h){let O;["type","source","source-layer","filter","layout"].forEach(G=>{G in h&&c.push(new pt(p,h[G],`"${G}" is prohibited for ref layers`))}),b.layers.forEach(G=>{$n(G.id)===F&&(O=G)}),O?O.ref?c.push(new pt(p,h.ref,"ref cannot reference another ref layer")):I=$n(O.type):c.push(new pt(p,h.ref,`ref layer "${F}" not found`))}else if(I!=="background")if(h.source){const O=b.sources&&b.sources[h.source],G=O&&$n(O.type);O?G==="vector"&&I==="raster"?c.push(new pt(p,h.source,`layer "${h.id}" requires a raster source`)):G!=="raster-dem"&&I==="hillshade"?c.push(new pt(p,h.source,`layer "${h.id}" requires a raster-dem source`)):G==="raster"&&I!=="raster"?c.push(new pt(p,h.source,`layer "${h.id}" requires a vector source`)):G!=="vector"||h["source-layer"]?G==="raster-dem"&&I!=="hillshade"?c.push(new pt(p,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):I!=="line"||!h.paint||!h.paint["line-gradient"]||G==="geojson"&&O.lineMetrics||c.push(new pt(p,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):c.push(new pt(p,h,`layer "${h.id}" must specify a "source-layer"`)):c.push(new pt(p,h.source,`source "${h.source}" not found`))}else c.push(new pt(p,h,'missing required property "source"'));return c=c.concat(Oi({key:p,value:h,valueSpec:S.layer,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*":()=>[],type:()=>u.validateSpec({key:`${p}.type`,value:h.type,valueSpec:S.layer.type,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,object:h,objectKey:"type"}),filter:Zs,layout:O=>Oi({layer:h,key:O.key,value:O.value,style:O.style,styleSpec:O.styleSpec,validateSpec:O.validateSpec,objectElementValidators:{"*":G=>eo(Ir({layerType:I},G))}}),paint:O=>Oi({layer:h,key:O.key,value:O.value,style:O.style,styleSpec:O.styleSpec,validateSpec:O.validateSpec,objectElementValidators:{"*":G=>Sc(Ir({layerType:I},G))}})}})),c}function $o(u){const c=u.value,h=u.key,p=lt(c);return p!=="string"?[new pt(h,c,`string expected, ${p} found`)]:[]}const ja={promoteId:function(u){let{key:c,value:h}=u;if(lt(h)==="string")return $o({key:c,value:h});{const p=[];for(const b in h)p.push(...$o({key:`${c}.${b}`,value:h[b]}));return p}}};function xo(u){const c=u.value,h=u.key,p=u.styleSpec,b=u.style,S=u.validateSpec;if(!c.type)return[new pt(h,c,'"type" is required')];const I=$n(c.type);let F;switch(I){case"vector":case"raster":return F=Oi({key:h,value:c,valueSpec:p[`source_${I.replace("-","_")}`],style:u.style,styleSpec:p,objectElementValidators:ja,validateSpec:S}),F;case"raster-dem":return F=function(O){var G;const K=(G=O.sourceName)!==null&&G!==void 0?G:"",J=O.value,ie=O.styleSpec,ce=ie.source_raster_dem,Ae=O.style;let Ce=[];const Le=lt(J);if(J===void 0)return Ce;if(Le!=="object")return Ce.push(new pt("source_raster_dem",J,`object expected, ${Le} found`)),Ce;const Ne=$n(J.encoding)==="custom",rt=["redFactor","greenFactor","blueFactor","baseShift"],ze=O.value.encoding?`"${O.value.encoding}"`:"Default";for(const We in J)!Ne&&rt.includes(We)?Ce.push(new pt(We,J[We],`In "${K}": "${We}" is only valid when "encoding" is set to "custom". ${ze} encoding found`)):ce[We]?Ce=Ce.concat(O.validateSpec({key:We,value:J[We],valueSpec:ce[We],validateSpec:O.validateSpec,style:Ae,styleSpec:ie})):Ce.push(new pt(We,J[We],`unknown property "${We}"`));return Ce}({sourceName:h,value:c,style:u.style,styleSpec:p,validateSpec:S}),F;case"geojson":if(F=Oi({key:h,value:c,valueSpec:p.source_geojson,style:b,styleSpec:p,validateSpec:S,objectElementValidators:ja}),c.cluster)for(const O in c.clusterProperties){const[G,K]=c.clusterProperties[O],J=typeof G=="string"?[G,["accumulated"],["get",O]]:G;F.push(...Di({key:`${h}.${O}.map`,value:K,validateSpec:S,expressionContext:"cluster-map"})),F.push(...Di({key:`${h}.${O}.reduce`,value:J,validateSpec:S,expressionContext:"cluster-reduce"}))}return F;case"video":return Oi({key:h,value:c,valueSpec:p.source_video,style:b,validateSpec:S,styleSpec:p});case"image":return Oi({key:h,value:c,valueSpec:p.source_image,style:b,validateSpec:S,styleSpec:p});case"canvas":return[new pt(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ki({key:`${h}.type`,value:c.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:b,validateSpec:S,styleSpec:p})}}function ba(u){const c=u.value,h=u.styleSpec,p=h.light,b=u.style;let S=[];const I=lt(c);if(c===void 0)return S;if(I!=="object")return S=S.concat([new pt("light",c,`object expected, ${I} found`)]),S;for(const F in c){const O=F.match(/^(.*)-transition$/);S=S.concat(O&&p[O[1]]&&p[O[1]].transition?u.validateSpec({key:F,value:c[F],valueSpec:h.transition,validateSpec:u.validateSpec,style:b,styleSpec:h}):p[F]?u.validateSpec({key:F,value:c[F],valueSpec:p[F],validateSpec:u.validateSpec,style:b,styleSpec:h}):[new pt(F,c[F],`unknown property "${F}"`)])}return S}function Tc(u){const c=u.value,h=u.styleSpec,p=h.sky,b=u.style,S=lt(c);if(c===void 0)return[];if(S!=="object")return[new pt("sky",c,`object expected, ${S} found`)];let I=[];for(const F in c)I=I.concat(p[F]?Qs({key:F,value:c[F],valueSpec:p[F],style:b,styleSpec:h}):[new pt(F,c[F],`unknown property "${F}"`)]);return I}function wa(u){const c=u.value,h=u.styleSpec,p=h.terrain,b=u.style;let S=[];const I=lt(c);if(c===void 0)return S;if(I!=="object")return S=S.concat([new pt("terrain",c,`object expected, ${I} found`)]),S;for(const F in c)S=S.concat(p[F]?u.validateSpec({key:F,value:c[F],valueSpec:p[F],validateSpec:u.validateSpec,style:b,styleSpec:h}):[new pt(F,c[F],`unknown property "${F}"`)]);return S}function Xo(u){let c=[];const h=u.value,p=u.key;if(Array.isArray(h)){const b=[],S=[];for(const I in h)h[I].id&&b.includes(h[I].id)&&c.push(new pt(p,h,`all the sprites' ids must be unique, but ${h[I].id} is duplicated`)),b.push(h[I].id),h[I].url&&S.includes(h[I].url)&&c.push(new pt(p,h,`all the sprites' URLs must be unique, but ${h[I].url} is duplicated`)),S.push(h[I].url),c=c.concat(Oi({key:`${p}[${I}]`,value:h[I],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:u.validateSpec}));return c}return $o({key:p,value:h})}const Ci={"*":()=>[],array:eA,boolean:function(u){const c=u.value,h=u.key,p=lt(c);return p!=="boolean"?[new pt(h,c,`boolean expected, ${p} found`)]:[]},number:uu,color:function(u){const c=u.key,h=u.value,p=lt(h);return p!=="string"?[new pt(c,h,`color expected, ${p} found`)]:Br.parse(String(h))?[]:[new pt(c,h,`color expected, "${h}" found`)]},constants:lu,enum:Ki,filter:Zs,function:Va,layer:va,object:Oi,source:xo,light:ba,sky:Tc,terrain:wa,string:$o,formatted:function(u){return $o(u).length===0?[]:Di(u)},resolvedImage:function(u){return $o(u).length===0?[]:Di(u)},padding:function(u){const c=u.key,h=u.value;if(lt(h)==="array"){if(h.length<1||h.length>4)return[new pt(c,h,`padding requires 1 to 4 values; ${h.length} values found`)];const p={type:"number"};let b=[];for(let S=0;S<h.length;S++)b=b.concat(u.validateSpec({key:`${c}[${S}]`,value:h[S],validateSpec:u.validateSpec,valueSpec:p}));return b}return uu({key:c,value:h,valueSpec:{}})},variableAnchorOffsetCollection:function(u){const c=u.key,h=u.value,p=lt(h),b=u.styleSpec;if(p!=="array"||h.length<1||h.length%2!=0)return[new pt(c,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let S=[];for(let I=0;I<h.length;I+=2)S=S.concat(Ki({key:`${c}[${I}]`,value:h[I],valueSpec:b.layout_symbol["text-anchor"]})),S=S.concat(eA({key:`${c}[${I+1}]`,value:h[I+1],valueSpec:{length:2,value:"number"},validateSpec:u.validateSpec,style:u.style,styleSpec:b}));return S},sprite:Xo};function Qs(u){const c=u.value,h=u.valueSpec,p=u.styleSpec;return u.validateSpec=Qs,h.expression&&Pt($n(c))?Va(u):h.expression&&Xr(qi(c))?Di(u):h.type&&Ci[h.type]?Ci[h.type](u):Oi(Ir({},u,{valueSpec:h.type?p[h.type]:h}))}function Hs(u){const c=u.value,h=u.key,p=$o(u);return p.length||(c.indexOf("{fontstack}")===-1&&p.push(new pt(h,c,'"glyphs" url must include a "{fontstack}" token')),c.indexOf("{range}")===-1&&p.push(new pt(h,c,'"glyphs" url must include a "{range}" token'))),p}function ki(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ye,h=[];return h=h.concat(Qs({key:"",value:u,valueSpec:c.$root,styleSpec:c,style:u,validateSpec:Qs,objectElementValidators:{glyphs:Hs,"*":()=>[]}})),u.constants&&(h=h.concat(lu({key:"constants",value:u.constants,style:u,styleSpec:c,validateSpec:Qs}))),Ln(h)}function vn(u){return function(c){return u({...c,validateSpec:Qs})}}function Ln(u){return[].concat(u).sort((c,h)=>c.line-h.line)}function Fn(u){return function(){for(var c=arguments.length,h=new Array(c),p=0;p<c;p++)h[p]=arguments[p];return Ln(u.apply(this,h))}}ki.source=Fn(vn(xo)),ki.sprite=Fn(vn(Xo)),ki.glyphs=Fn(vn(Hs)),ki.light=Fn(vn(ba)),ki.sky=Fn(vn(Tc)),ki.terrain=Fn(vn(wa)),ki.layer=Fn(vn(va)),ki.filter=Fn(vn(Zs)),ki.paintProperty=Fn(vn(Sc)),ki.layoutProperty=Fn(vn(eo));const ei=ki,qa=ei.light,xa=ei.paintProperty,Au=ei.layoutProperty;function Ka(u,c){let h=!1;if(c&&c.length)for(const p of c)u.fire(new mt(new Error(p.message))),h=!0;return h}class hu{constructor(c,h,p){const b=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;const I=new Int32Array(this.arrayBuffer);c=I[0],this.d=(h=I[1])+2*(p=I[2]);for(let O=0;O<this.d*this.d;O++){const G=I[3+O],K=I[3+O+1];b.push(G===K?null:I.subarray(G,K))}const F=I[3+b.length+1];this.keys=I.subarray(I[3+b.length],F),this.bboxes=I.subarray(F),this.insert=this._insertReadonly}else{this.d=h+2*p;for(let I=0;I<this.d*this.d;I++)b.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=c,this.padding=p,this.scale=h/c,this.uid=0;const S=p/h*c;this.min=-S,this.max=c+S}insert(c,h,p,b,S){this._forEachCell(h,p,b,S,this._insertCell,this.uid++,void 0,void 0),this.keys.push(c),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(b),this.bboxes.push(S)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(c,h,p,b,S,I){this.cells[S].push(I)}query(c,h,p,b,S){const I=this.min,F=this.max;if(c<=I&&h<=I&&F<=p&&F<=b&&!S)return Array.prototype.slice.call(this.keys);{const O=[];return this._forEachCell(c,h,p,b,this._queryCell,O,{},S),O}}_queryCell(c,h,p,b,S,I,F,O){const G=this.cells[S];if(G!==null){const K=this.keys,J=this.bboxes;for(let ie=0;ie<G.length;ie++){const ce=G[ie];if(F[ce]===void 0){const Ae=4*ce;(O?O(J[Ae+0],J[Ae+1],J[Ae+2],J[Ae+3]):c<=J[Ae+2]&&h<=J[Ae+3]&&p>=J[Ae+0]&&b>=J[Ae+1])?(F[ce]=!0,I.push(K[ce])):F[ce]=!1}}}}_forEachCell(c,h,p,b,S,I,F,O){const G=this._convertToCellCoord(c),K=this._convertToCellCoord(h),J=this._convertToCellCoord(p),ie=this._convertToCellCoord(b);for(let ce=G;ce<=J;ce++)for(let Ae=K;Ae<=ie;Ae++){const Ce=this.d*Ae+ce;if((!O||O(this._convertFromCellCoord(ce),this._convertFromCellCoord(Ae),this._convertFromCellCoord(ce+1),this._convertFromCellCoord(Ae+1)))&&S.call(this,c,h,p,b,Ce,I,F,O))return}}_convertFromCellCoord(c){return(c-this.padding)/this.scale}_convertToCellCoord(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const c=this.cells,h=3+this.cells.length+1+1;let p=0;for(let I=0;I<this.cells.length;I++)p+=this.cells[I].length;const b=new Int32Array(h+p+this.keys.length+this.bboxes.length);b[0]=this.extent,b[1]=this.n,b[2]=this.padding;let S=h;for(let I=0;I<c.length;I++){const F=c[I];b[3+I]=S,b.set(F,S),S+=F.length}return b[3+c.length]=S,b.set(this.keys,S),S+=this.keys.length,b[3+c.length+1]=S,b.set(this.bboxes,S),S+=this.bboxes.length,b.buffer}static serialize(c,h){const p=c.toArrayBuffer();return h&&h.push(p),{buffer:p}}static deserialize(c){return new hu(c.buffer)}}const Jo={};function er(u,c){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Jo[u])throw new Error(`${u} is already registered.`);Object.defineProperty(c,"_classRegistryKey",{value:u,writeable:!1}),Jo[u]={klass:c,omit:h.omit||[],shallow:h.shallow||[]}}er("Object",Object),er("TransferableGridIndex",hu),er("Color",Br),er("Error",Error),er("AJAXError",ct),er("ResolvedImage",as),er("StylePropertyFunction",fl),er("StyleExpression",Kr,{omit:["_evaluator"]}),er("ZoomDependentExpression",Ns),er("ZoomConstantExpression",ks),er("CompoundExpression",_i,{omit:["_evaluate"]});for(const u in Ko)Ko[u]._classRegistryKey||er(`Expression_${u}`,Ko[u]);function tA(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function yl(u,c){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob||u instanceof Error)return u;if(tA(u)||Je(u))return c&&c.push(u),u;if(ArrayBuffer.isView(u)){const h=u;return c&&c.push(h.buffer),h}if(u instanceof ImageData)return c&&c.push(u.data.buffer),u;if(Array.isArray(u)){const h=[];for(const p of u)h.push(yl(p,c));return h}if(typeof u=="object"){const h=u.constructor,p=h._classRegistryKey;if(!p)throw new Error(`can't serialize object of unregistered class ${h.name}`);if(!Jo[p])throw new Error(`${p} is not registered.`);const b=h.serialize?h.serialize(u,c):{};if(h.serialize){if(c&&b===c[c.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const S in u){if(!u.hasOwnProperty(S)||Jo[p].omit.indexOf(S)>=0)continue;const I=u[S];b[S]=Jo[p].shallow.indexOf(S)>=0?I:yl(I,c)}u instanceof Error&&(b.message=u.message)}if(b.$name)throw new Error("$name property is reserved for worker serialization logic.");return p!=="Object"&&(b.$name=p),b}throw new Error("can't serialize object of type "+typeof u)}function _l(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob||u instanceof Error||tA(u)||Je(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(_l);if(typeof u=="object"){const c=u.$name||"Object";if(!Jo[c])throw new Error(`can't deserialize unregistered class ${c}`);const{klass:h}=Jo[c];if(!h)throw new Error(`can't deserialize unregistered class ${c}`);if(h.deserialize)return h.deserialize(u);const p=Object.create(h.prototype);for(const b of Object.keys(u)){if(b==="$name")continue;const S=u[b];p[b]=Jo[c].shallow.indexOf(b)>=0?S:_l(S)}return p}throw new Error("can't deserialize object of type "+typeof u)}class rh{constructor(){this.first=!0}update(c,h){const p=Math.floor(c);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=c,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=h),c!==this.lastZoom&&(this.lastZoom=c,this.lastFloorZoom=p,!0))}}const qt={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519};function Wi(u){for(const c of u)if(vl(c.charCodeAt(0)))return!0;return!1}function to(u){for(const c of u)if(!rA(c.charCodeAt(0)))return!1;return!0}function rA(u){return!(qt.Arabic(u)||qt["Arabic Supplement"](u)||qt["Arabic Extended-A"](u)||qt["Arabic Presentation Forms-A"](u)||qt["Arabic Presentation Forms-B"](u))}function vl(u){return!(u!==746&&u!==747&&(u<4352||!(qt["Bopomofo Extended"](u)||qt.Bopomofo(u)||qt["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||qt["CJK Compatibility Ideographs"](u)||qt["CJK Compatibility"](u)||qt["CJK Radicals Supplement"](u)||qt["CJK Strokes"](u)||!(!qt["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||qt["CJK Unified Ideographs Extension A"](u)||qt["CJK Unified Ideographs"](u)||qt["Enclosed CJK Letters and Months"](u)||qt["Hangul Compatibility Jamo"](u)||qt["Hangul Jamo Extended-A"](u)||qt["Hangul Jamo Extended-B"](u)||qt["Hangul Jamo"](u)||qt["Hangul Syllables"](u)||qt.Hiragana(u)||qt["Ideographic Description Characters"](u)||qt.Kanbun(u)||qt["Kangxi Radicals"](u)||qt["Katakana Phonetic Extensions"](u)||qt.Katakana(u)&&u!==12540||!(!qt["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!qt["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||qt["Unified Canadian Aboriginal Syllabics"](u)||qt["Unified Canadian Aboriginal Syllabics Extended"](u)||qt["Vertical Forms"](u)||qt["Yijing Hexagram Symbols"](u)||qt["Yi Syllables"](u)||qt["Yi Radicals"](u))))}function nh(u){return!(vl(u)||function(c){return!!(qt["Latin-1 Supplement"](c)&&(c===167||c===169||c===174||c===177||c===188||c===189||c===190||c===215||c===247)||qt["General Punctuation"](c)&&(c===8214||c===8224||c===8225||c===8240||c===8241||c===8251||c===8252||c===8258||c===8263||c===8264||c===8265||c===8273)||qt["Letterlike Symbols"](c)||qt["Number Forms"](c)||qt["Miscellaneous Technical"](c)&&(c>=8960&&c<=8967||c>=8972&&c<=8991||c>=8996&&c<=9e3||c===9003||c>=9085&&c<=9114||c>=9150&&c<=9165||c===9167||c>=9169&&c<=9179||c>=9186&&c<=9215)||qt["Control Pictures"](c)&&c!==9251||qt["Optical Character Recognition"](c)||qt["Enclosed Alphanumerics"](c)||qt["Geometric Shapes"](c)||qt["Miscellaneous Symbols"](c)&&!(c>=9754&&c<=9759)||qt["Miscellaneous Symbols and Arrows"](c)&&(c>=11026&&c<=11055||c>=11088&&c<=11097||c>=11192&&c<=11243)||qt["CJK Symbols and Punctuation"](c)||qt.Katakana(c)||qt["Private Use Area"](c)||qt["CJK Compatibility Forms"](c)||qt["Small Form Variants"](c)||qt["Halfwidth and Fullwidth Forms"](c)||c===8734||c===8756||c===8757||c>=9984&&c<=10087||c>=10102&&c<=10131||c===65532||c===65533)}(u))}function bl(u){return u>=1424&&u<=2303||qt["Arabic Presentation Forms-A"](u)||qt["Arabic Presentation Forms-B"](u)}function nA(u,c){return!(!c&&bl(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||qt.Khmer(u))}function fd(u){for(const c of u)if(bl(c.charCodeAt(0)))return!0;return!1}const Wa=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(u){this.pluginStatus=u.pluginStatus,this.pluginURL=u.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(u){this.applyArabicShaping=u.applyArabicShaping,this.processBidirectionalText=u.processBidirectionalText,this.processStyledBidirectionalText=u.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class zn{constructor(c,h){this.zoom=c,h?(this.now=h.now,this.fadeDuration=h.fadeDuration,this.zoomHistory=h.zoomHistory,this.transition=h.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new rh,this.transition={})}isSupportedScript(c){return function(h,p){for(const b of h)if(!nA(b.charCodeAt(0),p))return!1;return!0}(c,Wa.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const c=this.zoom,h=c-Math.floor(c),p=this.crossFadingFactor();return c>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*h}}}class wl{constructor(c,h){this.property=c,this.value=h,this.expression=function(p,b){if(Pt(p))return new fl(p,b);if(Xr(p)){const S=_a(p,b);if(S.result==="error")throw new Error(S.value.map(I=>`${I.key}: ${I.message}`).join(", "));return S.value}{let S=p;return b.type==="color"&&typeof p=="string"?S=Br.parse(p):b.type!=="padding"||typeof p!="number"&&!Array.isArray(p)?b.type==="variableAnchorOffsetCollection"&&Array.isArray(p)&&(S=Jn.parse(p)):S=sn.parse(p),{kind:"constant",evaluate:()=>S}}}(h===void 0?c.specification.default:h,c.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(c,h,p){return this.property.possiblyEvaluate(this,c,h,p)}}class xl{constructor(c){this.property=c,this.value=new wl(c,void 0)}transitioned(c,h){return new sp(this.property,this.value,h,ye({},c.transition,this.transition),c.now)}untransitioned(){return new sp(this.property,this.value,null,{},0)}}class iA{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitionablePropertyValues)}getValue(c){return oe(this._values[c].value.value)}setValue(c,h){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new xl(this._values[c].property)),this._values[c].value=new wl(this._values[c].property,h===null?void 0:oe(h))}getTransition(c){return oe(this._values[c].transition)}setTransition(c,h){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new xl(this._values[c].property)),this._values[c].transition=oe(h)||void 0}serialize(){const c={};for(const h of Object.keys(this._values)){const p=this.getValue(h);p!==void 0&&(c[h]=p);const b=this.getTransition(h);b!==void 0&&(c[`${h}-transition`]=b)}return c}transitioned(c,h){const p=new op(this._properties);for(const b of Object.keys(this._values))p._values[b]=this._values[b].transitioned(c,h._values[b]);return p}untransitioned(){const c=new op(this._properties);for(const h of Object.keys(this._values))c._values[h]=this._values[h].untransitioned();return c}}class sp{constructor(c,h,p,b,S){this.property=c,this.value=h,this.begin=S+b.delay||0,this.end=this.begin+b.duration||0,c.specification.transition&&(b.delay||b.duration)&&(this.prior=p)}possiblyEvaluate(c,h,p){const b=c.now||0,S=this.value.possiblyEvaluate(c,h,p),I=this.prior;if(I){if(b>this.end)return this.prior=null,S;if(this.value.isDataDriven())return this.prior=null,S;if(b<this.begin)return I.possiblyEvaluate(c,h,p);{const F=(b-this.begin)/(this.end-this.begin);return this.property.interpolate(I.possiblyEvaluate(c,h,p),S,function(O){if(O<=0)return 0;if(O>=1)return 1;const G=O*O,K=G*O;return 4*(O<.5?K:3*(O-G)+K-.75)}(F))}}return S}}class op{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitioningPropertyValues)}possiblyEvaluate(c,h,p){const b=new sA(this._properties);for(const S of Object.keys(this._values))b._values[S]=this._values[S].possiblyEvaluate(c,h,p);return b}hasTransition(){for(const c of Object.keys(this._values))if(this._values[c].prior)return!0;return!1}}class pd{constructor(c){this._properties=c,this._values=Object.create(c.defaultPropertyValues)}hasValue(c){return this._values[c].value!==void 0}getValue(c){return oe(this._values[c].value)}setValue(c,h){this._values[c]=new wl(this._values[c].property,h===null?void 0:oe(h))}serialize(){const c={};for(const h of Object.keys(this._values)){const p=this.getValue(h);p!==void 0&&(c[h]=p)}return c}possiblyEvaluate(c,h,p){const b=new sA(this._properties);for(const S of Object.keys(this._values))b._values[S]=this._values[S].possiblyEvaluate(c,h,p);return b}}class Yo{constructor(c,h,p){this.property=c,this.value=h,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(c){return this.value.kind==="constant"?this.value.value:c}evaluate(c,h,p,b){return this.property.evaluate(this.value,this.parameters,c,h,p,b)}}class sA{constructor(c){this._properties=c,this._values=Object.create(c.defaultPossiblyEvaluatedValues)}get(c){return this._values[c]}}class dr{constructor(c){this.specification=c}possiblyEvaluate(c,h){if(c.isDataDriven())throw new Error("Value should not be data driven");return c.expression.evaluate(h)}interpolate(c,h,p){const b=Ri[this.specification.type];return b?b(c,h,p):c}}class wr{constructor(c,h){this.specification=c,this.overrides=h}possiblyEvaluate(c,h,p,b){return new Yo(this,c.expression.kind==="constant"||c.expression.kind==="camera"?{kind:"constant",value:c.expression.evaluate(h,null,{},p,b)}:c.expression,h)}interpolate(c,h,p){if(c.value.kind!=="constant"||h.value.kind!=="constant")return c;if(c.value.value===void 0||h.value.value===void 0)return new Yo(this,{kind:"constant",value:void 0},c.parameters);const b=Ri[this.specification.type];if(b){const S=b(c.value.value,h.value.value,p);return new Yo(this,{kind:"constant",value:S},c.parameters)}return c}evaluate(c,h,p,b,S,I){return c.kind==="constant"?c.value:c.evaluate(h,p,b,S,I)}}class ih extends wr{possiblyEvaluate(c,h,p,b){if(c.value===void 0)return new Yo(this,{kind:"constant",value:void 0},h);if(c.expression.kind==="constant"){const S=c.expression.evaluate(h,null,{},p,b),I=c.property.specification.type==="resolvedImage"&&typeof S!="string"?S.name:S,F=this._calculate(I,I,I,h);return new Yo(this,{kind:"constant",value:F},h)}if(c.expression.kind==="camera"){const S=this._calculate(c.expression.evaluate({zoom:h.zoom-1}),c.expression.evaluate({zoom:h.zoom}),c.expression.evaluate({zoom:h.zoom+1}),h);return new Yo(this,{kind:"constant",value:S},h)}return new Yo(this,c.expression,h)}evaluate(c,h,p,b,S,I){if(c.kind==="source"){const F=c.evaluate(h,p,b,S,I);return this._calculate(F,F,F,h)}return c.kind==="composite"?this._calculate(c.evaluate({zoom:Math.floor(h.zoom)-1},p,b),c.evaluate({zoom:Math.floor(h.zoom)},p,b),c.evaluate({zoom:Math.floor(h.zoom)+1},p,b),h):c.value}_calculate(c,h,p,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:c,to:h}:{from:p,to:h}}interpolate(c){return c}}class Bl{constructor(c){this.specification=c}possiblyEvaluate(c,h,p,b){if(c.value!==void 0){if(c.expression.kind==="constant"){const S=c.expression.evaluate(h,null,{},p,b);return this._calculate(S,S,S,h)}return this._calculate(c.expression.evaluate(new zn(Math.floor(h.zoom-1),h)),c.expression.evaluate(new zn(Math.floor(h.zoom),h)),c.expression.evaluate(new zn(Math.floor(h.zoom+1),h)),h)}}_calculate(c,h,p,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:c,to:h}:{from:p,to:h}}interpolate(c){return c}}class oA{constructor(c){this.specification=c}possiblyEvaluate(c,h,p,b){return!!c.expression.evaluate(h,null,{},p,b)}interpolate(){return!1}}class $i{constructor(c){this.properties=c,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in c){const p=c[h];p.specification.overridable&&this.overridableProperties.push(h);const b=this.defaultPropertyValues[h]=new wl(p,void 0),S=this.defaultTransitionablePropertyValues[h]=new xl(p);this.defaultTransitioningPropertyValues[h]=S.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=b.possiblyEvaluate({})}}}er("DataDrivenProperty",wr),er("DataConstantProperty",dr),er("CrossFadedDataDrivenProperty",ih),er("CrossFadedProperty",Bl),er("ColorRampProperty",oA);const gd="-transition";class Zo extends Re{constructor(c,h){if(super(),this.id=c.id,this.type=c.type,this._featureFilter={filter:()=>!0,needGeometry:!1},c.type!=="custom"&&(this.metadata=c.metadata,this.minzoom=c.minzoom,this.maxzoom=c.maxzoom,c.type!=="background"&&(this.source=c.source,this.sourceLayer=c["source-layer"],this.filter=c.filter),h.layout&&(this._unevaluatedLayout=new pd(h.layout)),h.paint)){this._transitionablePaint=new iA(h.paint);for(const p in c.paint)this.setPaintProperty(p,c.paint[p],{validate:!1});for(const p in c.layout)this.setLayoutProperty(p,c.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new sA(h.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(c){return c==="visibility"?this.visibility:this._unevaluatedLayout.getValue(c)}setLayoutProperty(c,h){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};h!=null&&this._validate(Au,`layers.${this.id}.layout.${c}`,c,h,p)||(c!=="visibility"?this._unevaluatedLayout.setValue(c,h):this.visibility=h)}getPaintProperty(c){return c.endsWith(gd)?this._transitionablePaint.getTransition(c.slice(0,-11)):this._transitionablePaint.getValue(c)}setPaintProperty(c,h){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(h!=null&&this._validate(xa,`layers.${this.id}.paint.${c}`,c,h,p))return!1;if(c.endsWith(gd))return this._transitionablePaint.setTransition(c.slice(0,-11),h||void 0),!1;{const b=this._transitionablePaint._values[c],S=b.property.specification["property-type"]==="cross-faded-data-driven",I=b.value.isDataDriven(),F=b.value;this._transitionablePaint.setValue(c,h),this._handleSpecialPaintPropertyUpdate(c);const O=this._transitionablePaint._values[c].value;return O.isDataDriven()||I||S||this._handleOverridablePaintPropertyUpdate(c,F,O)}}_handleSpecialPaintPropertyUpdate(c){}_handleOverridablePaintPropertyUpdate(c,h,p){return!1}isHidden(c){return!!(this.minzoom&&c<this.minzoom)||!!(this.maxzoom&&c>=this.maxzoom)||this.visibility==="none"}updateTransitions(c){this._transitioningPaint=this._transitionablePaint.transitioned(c,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(c,h){c.getCrossfadeParameters&&(this._crossfadeParameters=c.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(c,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(c,void 0,h)}serialize(){const c={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(c.layout=c.layout||{},c.layout.visibility=this.visibility),Fe(c,(h,p)=>!(h===void 0||p==="layout"&&!Object.keys(h).length||p==="paint"&&!Object.keys(h).length))}_validate(c,h,p,b){let S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};return(!S||S.validate!==!1)&&Ka(this,c.call(ei,{key:h,layerType:this.type,objectKey:p,value:b,styleSpec:Ye,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const c in this.paint._values){const h=this.paint.get(c);if(h instanceof Yo&&Pe(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}const md={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class aA{constructor(c,h){this._structArray=c,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class hi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(c,h){return c._trim(),h&&(c.isTransferred=!0,h.push(c.arrayBuffer)),{length:c.length,arrayBuffer:c.arrayBuffer}}static deserialize(c){const h=Object.create(this.prototype);return h.arrayBuffer=c.arrayBuffer,h.length=c.length,h.capacity=c.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(c){this.reserve(c),this.length=c}reserve(c){if(c>this.capacity){this.capacity=Math.max(c,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ei(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,h=0,p=0;return{members:u.map(b=>{const S=md[b.type].BYTES_PER_ELEMENT,I=h=ap(h,Math.max(c,S)),F=b.components||1;return p=Math.max(p,S),h+=S*F,{name:b.name,type:b.type,components:F,offset:I}}),size:ap(h,Math.max(p,c)),alignment:c}}function ap(u,c){return Math.ceil(u/c)*c}class Bo extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h){const p=this.length;return this.resize(p+1),this.emplace(p,c,h)}emplace(c,h,p){const b=2*c;return this.int16[b+0]=h,this.int16[b+1]=p,c}}Bo.prototype.bytesPerElement=4,er("StructArrayLayout2i4",Bo);class Ni extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,p){const b=this.length;return this.resize(b+1),this.emplace(b,c,h,p)}emplace(c,h,p,b){const S=3*c;return this.int16[S+0]=h,this.int16[S+1]=p,this.int16[S+2]=b,c}}Ni.prototype.bytesPerElement=6,er("StructArrayLayout3i6",Ni);class ea extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,p,b){const S=this.length;return this.resize(S+1),this.emplace(S,c,h,p,b)}emplace(c,h,p,b,S){const I=4*c;return this.int16[I+0]=h,this.int16[I+1]=p,this.int16[I+2]=b,this.int16[I+3]=S,c}}ea.prototype.bytesPerElement=8,er("StructArrayLayout4i8",ea);class yd extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,p,b,S,I){const F=this.length;return this.resize(F+1),this.emplace(F,c,h,p,b,S,I)}emplace(c,h,p,b,S,I,F){const O=6*c;return this.int16[O+0]=h,this.int16[O+1]=p,this.int16[O+2]=b,this.int16[O+3]=S,this.int16[O+4]=I,this.int16[O+5]=F,c}}yd.prototype.bytesPerElement=12,er("StructArrayLayout2i4i12",yd);class sh extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,p,b,S,I){const F=this.length;return this.resize(F+1),this.emplace(F,c,h,p,b,S,I)}emplace(c,h,p,b,S,I,F){const O=4*c,G=8*c;return this.int16[O+0]=h,this.int16[O+1]=p,this.uint8[G+4]=b,this.uint8[G+5]=S,this.uint8[G+6]=I,this.uint8[G+7]=F,c}}sh.prototype.bytesPerElement=8,er("StructArrayLayout2i4ub8",sh);class Co extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h){const p=this.length;return this.resize(p+1),this.emplace(p,c,h)}emplace(c,h,p){const b=2*c;return this.float32[b+0]=h,this.float32[b+1]=p,c}}Co.prototype.bytesPerElement=8,er("StructArrayLayout2f8",Co);class Es extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,p,b,S,I,F,O,G,K){const J=this.length;return this.resize(J+1),this.emplace(J,c,h,p,b,S,I,F,O,G,K)}emplace(c,h,p,b,S,I,F,O,G,K,J){const ie=10*c;return this.uint16[ie+0]=h,this.uint16[ie+1]=p,this.uint16[ie+2]=b,this.uint16[ie+3]=S,this.uint16[ie+4]=I,this.uint16[ie+5]=F,this.uint16[ie+6]=O,this.uint16[ie+7]=G,this.uint16[ie+8]=K,this.uint16[ie+9]=J,c}}Es.prototype.bytesPerElement=20,er("StructArrayLayout10ui20",Es);class _d extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,p,b,S,I,F,O,G,K,J,ie){const ce=this.length;return this.resize(ce+1),this.emplace(ce,c,h,p,b,S,I,F,O,G,K,J,ie)}emplace(c,h,p,b,S,I,F,O,G,K,J,ie,ce){const Ae=12*c;return this.int16[Ae+0]=h,this.int16[Ae+1]=p,this.int16[Ae+2]=b,this.int16[Ae+3]=S,this.uint16[Ae+4]=I,this.uint16[Ae+5]=F,this.uint16[Ae+6]=O,this.uint16[Ae+7]=G,this.int16[Ae+8]=K,this.int16[Ae+9]=J,this.int16[Ae+10]=ie,this.int16[Ae+11]=ce,c}}_d.prototype.bytesPerElement=24,er("StructArrayLayout4i4ui4i24",_d);class vd extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,p){const b=this.length;return this.resize(b+1),this.emplace(b,c,h,p)}emplace(c,h,p,b){const S=3*c;return this.float32[S+0]=h,this.float32[S+1]=p,this.float32[S+2]=b,c}}vd.prototype.bytesPerElement=12,er("StructArrayLayout3f12",vd);class Ba extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c){const h=this.length;return this.resize(h+1),this.emplace(h,c)}emplace(c,h){return this.uint32[1*c+0]=h,c}}Ba.prototype.bytesPerElement=4,er("StructArrayLayout1ul4",Ba);class cA extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,p,b,S,I,F,O,G){const K=this.length;return this.resize(K+1),this.emplace(K,c,h,p,b,S,I,F,O,G)}emplace(c,h,p,b,S,I,F,O,G,K){const J=10*c,ie=5*c;return this.int16[J+0]=h,this.int16[J+1]=p,this.int16[J+2]=b,this.int16[J+3]=S,this.int16[J+4]=I,this.int16[J+5]=F,this.uint32[ie+3]=O,this.uint16[J+8]=G,this.uint16[J+9]=K,c}}cA.prototype.bytesPerElement=20,er("StructArrayLayout6i1ul2ui20",cA);class du extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,p,b,S,I){const F=this.length;return this.resize(F+1),this.emplace(F,c,h,p,b,S,I)}emplace(c,h,p,b,S,I,F){const O=6*c;return this.int16[O+0]=h,this.int16[O+1]=p,this.int16[O+2]=b,this.int16[O+3]=S,this.int16[O+4]=I,this.int16[O+5]=F,c}}du.prototype.bytesPerElement=12,er("StructArrayLayout2i2i2i12",du);class lA extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,p,b,S){const I=this.length;return this.resize(I+1),this.emplace(I,c,h,p,b,S)}emplace(c,h,p,b,S,I){const F=4*c,O=8*c;return this.float32[F+0]=h,this.float32[F+1]=p,this.float32[F+2]=b,this.int16[O+6]=S,this.int16[O+7]=I,c}}lA.prototype.bytesPerElement=16,er("StructArrayLayout2f1f2i16",lA);class uA extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,p,b){const S=this.length;return this.resize(S+1),this.emplace(S,c,h,p,b)}emplace(c,h,p,b,S){const I=12*c,F=3*c;return this.uint8[I+0]=h,this.uint8[I+1]=p,this.float32[F+1]=b,this.float32[F+2]=S,c}}uA.prototype.bytesPerElement=12,er("StructArrayLayout2ub2f12",uA);class Cl extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,p){const b=this.length;return this.resize(b+1),this.emplace(b,c,h,p)}emplace(c,h,p,b){const S=3*c;return this.uint16[S+0]=h,this.uint16[S+1]=p,this.uint16[S+2]=b,c}}Cl.prototype.bytesPerElement=6,er("StructArrayLayout3ui6",Cl);class $a extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,p,b,S,I,F,O,G,K,J,ie,ce,Ae,Ce,Le,Ne){const rt=this.length;return this.resize(rt+1),this.emplace(rt,c,h,p,b,S,I,F,O,G,K,J,ie,ce,Ae,Ce,Le,Ne)}emplace(c,h,p,b,S,I,F,O,G,K,J,ie,ce,Ae,Ce,Le,Ne,rt){const ze=24*c,We=12*c,bt=48*c;return this.int16[ze+0]=h,this.int16[ze+1]=p,this.uint16[ze+2]=b,this.uint16[ze+3]=S,this.uint32[We+2]=I,this.uint32[We+3]=F,this.uint32[We+4]=O,this.uint16[ze+10]=G,this.uint16[ze+11]=K,this.uint16[ze+12]=J,this.float32[We+7]=ie,this.float32[We+8]=ce,this.uint8[bt+36]=Ae,this.uint8[bt+37]=Ce,this.uint8[bt+38]=Le,this.uint32[We+10]=Ne,this.int16[ze+22]=rt,c}}$a.prototype.bytesPerElement=48,er("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",$a);class ta extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,p,b,S,I,F,O,G,K,J,ie,ce,Ae,Ce,Le,Ne,rt,ze,We,bt,wt,Zt,hr,Xt,Wt,Nt,or){const jt=this.length;return this.resize(jt+1),this.emplace(jt,c,h,p,b,S,I,F,O,G,K,J,ie,ce,Ae,Ce,Le,Ne,rt,ze,We,bt,wt,Zt,hr,Xt,Wt,Nt,or)}emplace(c,h,p,b,S,I,F,O,G,K,J,ie,ce,Ae,Ce,Le,Ne,rt,ze,We,bt,wt,Zt,hr,Xt,Wt,Nt,or,jt){const Ft=32*c,Cr=16*c;return this.int16[Ft+0]=h,this.int16[Ft+1]=p,this.int16[Ft+2]=b,this.int16[Ft+3]=S,this.int16[Ft+4]=I,this.int16[Ft+5]=F,this.int16[Ft+6]=O,this.int16[Ft+7]=G,this.uint16[Ft+8]=K,this.uint16[Ft+9]=J,this.uint16[Ft+10]=ie,this.uint16[Ft+11]=ce,this.uint16[Ft+12]=Ae,this.uint16[Ft+13]=Ce,this.uint16[Ft+14]=Le,this.uint16[Ft+15]=Ne,this.uint16[Ft+16]=rt,this.uint16[Ft+17]=ze,this.uint16[Ft+18]=We,this.uint16[Ft+19]=bt,this.uint16[Ft+20]=wt,this.uint16[Ft+21]=Zt,this.uint16[Ft+22]=hr,this.uint32[Cr+12]=Xt,this.float32[Cr+13]=Wt,this.float32[Cr+14]=Nt,this.uint16[Ft+30]=or,this.uint16[Ft+31]=jt,c}}ta.prototype.bytesPerElement=64,er("StructArrayLayout8i15ui1ul2f2ui64",ta);class fu extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c){const h=this.length;return this.resize(h+1),this.emplace(h,c)}emplace(c,h){return this.float32[1*c+0]=h,c}}fu.prototype.bytesPerElement=4,er("StructArrayLayout1f4",fu);class AA extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,p){const b=this.length;return this.resize(b+1),this.emplace(b,c,h,p)}emplace(c,h,p,b){const S=3*c;return this.uint16[6*c+0]=h,this.float32[S+1]=p,this.float32[S+2]=b,c}}AA.prototype.bytesPerElement=12,er("StructArrayLayout1ui2f12",AA);class El extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,p){const b=this.length;return this.resize(b+1),this.emplace(b,c,h,p)}emplace(c,h,p,b){const S=4*c;return this.uint32[2*c+0]=h,this.uint16[S+2]=p,this.uint16[S+3]=b,c}}El.prototype.bytesPerElement=8,er("StructArrayLayout1ul2ui8",El);class oh extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h){const p=this.length;return this.resize(p+1),this.emplace(p,c,h)}emplace(c,h,p){const b=2*c;return this.uint16[b+0]=h,this.uint16[b+1]=p,c}}oh.prototype.bytesPerElement=4,er("StructArrayLayout2ui4",oh);class bd extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c){const h=this.length;return this.resize(h+1),this.emplace(h,c)}emplace(c,h){return this.uint16[1*c+0]=h,c}}bd.prototype.bytesPerElement=2,er("StructArrayLayout1ui2",bd);class ah extends hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,p,b){const S=this.length;return this.resize(S+1),this.emplace(S,c,h,p,b)}emplace(c,h,p,b,S){const I=4*c;return this.float32[I+0]=h,this.float32[I+1]=p,this.float32[I+2]=b,this.float32[I+3]=S,c}}ah.prototype.bytesPerElement=16,er("StructArrayLayout4f16",ah);class cp extends aA{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new v(this.anchorPointX,this.anchorPointY)}}cp.prototype.size=20;class C extends cA{get(c){return new cp(this,c)}}er("CollisionBoxArray",C);class l extends aA{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(c){this._structArray.uint8[this._pos1+37]=c}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(c){this._structArray.uint8[this._pos1+38]=c}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(c){this._structArray.uint32[this._pos4+10]=c}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}l.prototype.size=48;class d extends $a{get(c){return new l(this,c)}}er("PlacedSymbolArray",d);class y extends aA{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(c){this._structArray.uint32[this._pos4+12]=c}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}y.prototype.size=64;class _ extends ta{get(c){return new y(this,c)}}er("SymbolInstanceArray",_);class E extends fu{getoffsetX(c){return this.float32[1*c+0]}}er("GlyphOffsetArray",E);class P extends Ni{getx(c){return this.int16[3*c+0]}gety(c){return this.int16[3*c+1]}gettileUnitDistanceFromAnchor(c){return this.int16[3*c+2]}}er("SymbolLineVertexArray",P);class R extends aA{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}R.prototype.size=12;class g extends AA{get(c){return new R(this,c)}}er("TextAnchorOffsetArray",g);class w extends aA{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}w.prototype.size=8;class T extends El{get(c){return new w(this,c)}}er("FeatureIndexArray",T);class L extends Bo{}class D extends Bo{}class H extends Bo{}class z extends yd{}class j extends sh{}class V extends Co{}class X extends Es{}class ue extends _d{}class ne extends vd{}class de extends Ba{}class me extends du{}class Ue extends uA{}class Ie extends Cl{}class ve extends oh{}const we=Ei([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ve}=we;class Xe{constructor(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.segments=c}prepareSegment(c,h,p,b){let S=this.segments[this.segments.length-1];return c>Xe.MAX_VERTEX_ARRAY_LENGTH&&xe(`Max vertices per segment is ${Xe.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${c}`),(!S||S.vertexLength+c>Xe.MAX_VERTEX_ARRAY_LENGTH||S.sortKey!==b)&&(S={vertexOffset:h.length,primitiveOffset:p.length,vertexLength:0,primitiveLength:0},b!==void 0&&(S.sortKey=b),this.segments.push(S)),S}get(){return this.segments}destroy(){for(const c of this.segments)for(const h in c.vaos)c.vaos[h].destroy()}static simpleSegment(c,h,p,b){return new Xe([{vertexOffset:c,primitiveOffset:h,vertexLength:p,primitiveLength:b,vaos:{},sortKey:0}])}}function At(u,c){return 256*(u=pe(Math.floor(u),0,255))+pe(Math.floor(c),0,255)}Xe.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,er("SegmentVector",Xe);const ht=Ei([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var _t={exports:{}},Ot={exports:{}};Ot.exports=function(u,c){var h,p,b,S,I,F,O,G;for(p=u.length-(h=3&u.length),b=c,I=3432918353,F=461845907,G=0;G<p;)O=255&u.charCodeAt(G)|(255&u.charCodeAt(++G))<<8|(255&u.charCodeAt(++G))<<16|(255&u.charCodeAt(++G))<<24,++G,b=27492+(65535&(S=5*(65535&(b=(b^=O=(65535&(O=(O=(65535&O)*I+(((O>>>16)*I&65535)<<16)&4294967295)<<15|O>>>17))*F+(((O>>>16)*F&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(O=0,h){case 3:O^=(255&u.charCodeAt(G+2))<<16;case 2:O^=(255&u.charCodeAt(G+1))<<8;case 1:b^=O=(65535&(O=(O=(65535&(O^=255&u.charCodeAt(G)))*I+(((O>>>16)*I&65535)<<16)&4294967295)<<15|O>>>17))*F+(((O>>>16)*F&65535)<<16)&4294967295}return b^=u.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0};var Et=Ot.exports,$t={exports:{}};$t.exports=function(u,c){for(var h,p=u.length,b=c^p,S=0;p>=4;)h=1540483477*(65535&(h=255&u.charCodeAt(S)|(255&u.charCodeAt(++S))<<8|(255&u.charCodeAt(++S))<<16|(255&u.charCodeAt(++S))<<24))+((1540483477*(h>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),p-=4,++S;switch(p){case 3:b^=(255&u.charCodeAt(S+2))<<16;case 2:b^=(255&u.charCodeAt(S+1))<<8;case 1:b=1540483477*(65535&(b^=255&u.charCodeAt(S)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0};var nr=Et,rr=$t.exports;_t.exports=nr,_t.exports.murmur3=nr,_t.exports.murmur2=rr;var Sr=A(_t.exports);class Fr{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(c,h,p,b){this.ids.push(en(c)),this.positions.push(h,p,b)}getPositions(c){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=en(c);let p=0,b=this.ids.length-1;for(;p<b;){const I=p+b>>1;this.ids[I]>=h?b=I:p=I+1}const S=[];for(;this.ids[p]===h;)S.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return S}static serialize(c,h){const p=new Float64Array(c.ids),b=new Uint32Array(c.positions);return xr(p,b,0,p.length-1),h&&h.push(p.buffer,b.buffer),{ids:p,positions:b}}static deserialize(c){const h=new Fr;return h.ids=c.ids,h.positions=c.positions,h.indexed=!0,h}}function en(u){const c=+u;return!isNaN(c)&&c<=Number.MAX_SAFE_INTEGER?c:Sr(String(u))}function xr(u,c,h,p){for(;h<p;){const b=u[h+p>>1];let S=h-1,I=p+1;for(;;){do S++;while(u[S]<b);do I--;while(u[I]>b);if(S>=I)break;Jr(u,S,I),Jr(c,3*S,3*I),Jr(c,3*S+1,3*I+1),Jr(c,3*S+2,3*I+2)}I-h<p-I?(xr(u,c,h,I),h=I+1):(xr(u,c,I+1,p),p=I)}}function Jr(u,c,h){const p=u[c];u[c]=u[h],u[h]=p}er("FeaturePositionMap",Fr);class Cn{constructor(c,h){this.gl=c.gl,this.location=h}}class En extends Cn{constructor(c,h){super(c,h),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class di extends Cn{constructor(c,h){super(c,h),this.current=[0,0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3]))}}class dn extends Cn{constructor(c,h){super(c,h),this.current=Br.transparent}set(c){c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a))}}const ls=new Float32Array(16);function Fi(u){return[At(255*u.r,255*u.g),At(255*u.b,255*u.a)]}class Gn{constructor(c,h,p){this.value=c,this.uniformNames=h.map(b=>`u_${b}`),this.type=p}setUniform(c,h,p){c.set(p.constantOr(this.value))}getBinding(c,h,p){return this.type==="color"?new dn(c,h):new En(c,h)}}class fn{constructor(c,h){this.uniformNames=h.map(p=>`u_${p}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(c,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=c.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=c.tlbr}setUniform(c,h,p,b){const S=b==="u_pattern_to"?this.patternTo:b==="u_pattern_from"?this.patternFrom:b==="u_pixel_ratio_to"?this.pixelRatioTo:b==="u_pixel_ratio_from"?this.pixelRatioFrom:null;S&&c.set(S)}getBinding(c,h,p){return p.substr(0,9)==="u_pattern"?new di(c,h):new En(c,h)}}class on{constructor(c,h,p,b){this.expression=c,this.type=p,this.maxValue=0,this.paintVertexAttributes=h.map(S=>({name:`a_${S}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new b}populatePaintArray(c,h,p,b,S){const I=this.paintVertexArray.length,F=this.expression.evaluate(new zn(0),h,{},b,[],S);this.paintVertexArray.resize(c),this._setPaintValue(I,c,F)}updatePaintArray(c,h,p,b){const S=this.expression.evaluate({zoom:0},p,b);this._setPaintValue(c,h,S)}_setPaintValue(c,h,p){if(this.type==="color"){const b=Fi(p);for(let S=c;S<h;S++)this.paintVertexArray.emplace(S,b[0],b[1])}else{for(let b=c;b<h;b++)this.paintVertexArray.emplace(b,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class pn{constructor(c,h,p,b,S,I){this.expression=c,this.uniformNames=h.map(F=>`u_${F}_t`),this.type=p,this.useIntegerZoom=b,this.zoom=S,this.maxValue=0,this.paintVertexAttributes=h.map(F=>({name:`a_${F}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new I}populatePaintArray(c,h,p,b,S){const I=this.expression.evaluate(new zn(this.zoom),h,{},b,[],S),F=this.expression.evaluate(new zn(this.zoom+1),h,{},b,[],S),O=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValue(O,c,I,F)}updatePaintArray(c,h,p,b){const S=this.expression.evaluate({zoom:this.zoom},p,b),I=this.expression.evaluate({zoom:this.zoom+1},p,b);this._setPaintValue(c,h,S,I)}_setPaintValue(c,h,p,b){if(this.type==="color"){const S=Fi(p),I=Fi(b);for(let F=c;F<h;F++)this.paintVertexArray.emplace(F,S[0],S[1],I[0],I[1])}else{for(let S=c;S<h;S++)this.paintVertexArray.emplace(S,p,b);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(b))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(c,h){const p=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,b=pe(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);c.set(b)}getBinding(c,h,p){return new En(c,h)}}class Si{constructor(c,h,p,b,S,I){this.expression=c,this.type=h,this.useIntegerZoom=p,this.zoom=b,this.layerId=I,this.zoomInPaintVertexArray=new S,this.zoomOutPaintVertexArray=new S}populatePaintArray(c,h,p){const b=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(c),this.zoomOutPaintVertexArray.resize(c),this._setPaintValues(b,c,h.patterns&&h.patterns[this.layerId],p)}updatePaintArray(c,h,p,b,S){this._setPaintValues(c,h,p.patterns&&p.patterns[this.layerId],S)}_setPaintValues(c,h,p,b){if(!b||!p)return;const{min:S,mid:I,max:F}=p,O=b[S],G=b[I],K=b[F];if(O&&G&&K)for(let J=c;J<h;J++)this.zoomInPaintVertexArray.emplace(J,G.tl[0],G.tl[1],G.br[0],G.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],G.pixelRatio,O.pixelRatio),this.zoomOutPaintVertexArray.emplace(J,G.tl[0],G.tl[1],G.br[0],G.br[1],K.tl[0],K.tl[1],K.br[0],K.br[1],G.pixelRatio,K.pixelRatio)}upload(c){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=c.createVertexBuffer(this.zoomInPaintVertexArray,ht.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=c.createVertexBuffer(this.zoomOutPaintVertexArray,ht.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class un{constructor(c,h,p){this.binders={},this._buffers=[];const b=[];for(const S in c.paint._values){if(!p(S))continue;const I=c.paint.get(S);if(!(I instanceof Yo&&Pe(I.property.specification)))continue;const F=Xi(S,c.type),O=I.value,G=I.property.specification.type,K=I.property.useIntegerZoom,J=I.property.specification["property-type"],ie=J==="cross-faded"||J==="cross-faded-data-driven";if(O.kind==="constant")this.binders[S]=ie?new fn(O.value,F):new Gn(O.value,F,G),b.push(`/u_${S}`);else if(O.kind==="source"||ie){const ce=ti(S,G,"source");this.binders[S]=ie?new Si(O,G,K,h,ce,c.id):new on(O,F,G,ce),b.push(`/a_${S}`)}else{const ce=ti(S,G,"composite");this.binders[S]=new pn(O,F,G,K,h,ce),b.push(`/z_${S}`)}}this.cacheKey=b.sort().join("")}getMaxValue(c){const h=this.binders[c];return h instanceof on||h instanceof pn?h.maxValue:0}populatePaintArrays(c,h,p,b,S){for(const I in this.binders){const F=this.binders[I];(F instanceof on||F instanceof pn||F instanceof Si)&&F.populatePaintArray(c,h,p,b,S)}}setConstantPatternPositions(c,h){for(const p in this.binders){const b=this.binders[p];b instanceof fn&&b.setConstantPatternPositions(c,h)}}updatePaintArrays(c,h,p,b,S){let I=!1;for(const F in c){const O=h.getPositions(F);for(const G of O){const K=p.feature(G.index);for(const J in this.binders){const ie=this.binders[J];if((ie instanceof on||ie instanceof pn||ie instanceof Si)&&ie.expression.isStateDependent===!0){const ce=b.paint.get(J);ie.expression=ce.value,ie.updatePaintArray(G.start,G.end,K,c[F],S),I=!0}}}}return I}defines(){const c=[];for(const h in this.binders){const p=this.binders[h];(p instanceof Gn||p instanceof fn)&&c.push(...p.uniformNames.map(b=>`#define HAS_UNIFORM_${b}`))}return c}getBinderAttributes(){const c=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof on||p instanceof pn)for(let b=0;b<p.paintVertexAttributes.length;b++)c.push(p.paintVertexAttributes[b].name);else if(p instanceof Si)for(let b=0;b<ht.members.length;b++)c.push(ht.members[b].name)}return c}getBinderUniforms(){const c=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof Gn||p instanceof fn||p instanceof pn)for(const b of p.uniformNames)c.push(b)}return c}getPaintVertexBuffers(){return this._buffers}getUniforms(c,h){const p=[];for(const b in this.binders){const S=this.binders[b];if(S instanceof Gn||S instanceof fn||S instanceof pn){for(const I of S.uniformNames)if(h[I]){const F=S.getBinding(c,h[I],I);p.push({name:I,property:b,binding:F})}}}return p}setUniforms(c,h,p,b){for(const{name:S,property:I,binding:F}of h)this.binders[I].setUniform(F,b,p.get(I),S)}updatePaintBuffers(c){this._buffers=[];for(const h in this.binders){const p=this.binders[h];if(c&&p instanceof Si){const b=c.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;b&&this._buffers.push(b)}else(p instanceof on||p instanceof pn)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(c){for(const h in this.binders){const p=this.binders[h];(p instanceof on||p instanceof pn||p instanceof Si)&&p.upload(c)}this.updatePaintBuffers()}destroy(){for(const c in this.binders){const h=this.binders[c];(h instanceof on||h instanceof pn||h instanceof Si)&&h.destroy()}}}class Sn{constructor(c,h){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>!0;this.programConfigurations={};for(const b of c)this.programConfigurations[b.id]=new un(b,h,p);this.needsUpload=!1,this._featureMap=new Fr,this._bufferOffset=0}populatePaintArrays(c,h,p,b,S,I){for(const F in this.programConfigurations)this.programConfigurations[F].populatePaintArrays(c,h,b,S,I);h.id!==void 0&&this._featureMap.add(h.id,p,this._bufferOffset,c),this._bufferOffset=c,this.needsUpload=!0}updatePaintArrays(c,h,p,b){for(const S of p)this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(c,this._featureMap,h,S,b)||this.needsUpload}get(c){return this.programConfigurations[c]}upload(c){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(c);this.needsUpload=!1}}destroy(){for(const c in this.programConfigurations)this.programConfigurations[c].destroy()}}function Xi(u,c){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[u]||[u.replace(`${c}-`,"").replace(/-/g,"_")]}function ti(u,c,h){const p={color:{source:Co,composite:ah},number:{source:fu,composite:Co}},b=function(S){return{"line-pattern":{source:X,composite:X},"fill-pattern":{source:X,composite:X},"fill-extrusion-pattern":{source:X,composite:X}}[S]}(u);return b&&b[h]||p[c][h]}er("ConstantBinder",Gn),er("CrossFadedConstantBinder",fn),er("SourceExpressionBinder",on),er("CrossFadedCompositeBinder",Si),er("CompositeExpressionBinder",pn),er("ProgramConfiguration",un,{omit:["_buffers"]}),er("ProgramConfigurationSet",Sn);const Rn=8192,oi=Math.pow(2,14)-1,ch=-oi-1;function Ic(u){const c=Rn/u.extent,h=u.loadGeometry();for(let p=0;p<h.length;p++){const b=h[p];for(let S=0;S<b.length;S++){const I=b[S],F=Math.round(I.x*c),O=Math.round(I.y*c);I.x=pe(F,ch,oi),I.y=pe(O,ch,oi),(F<I.x||F>I.x+1||O<I.y||O>I.y+1)&&xe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function Lc(u,c){return{type:u.type,id:u.id,properties:u.properties,geometry:c?Ic(u):[]}}function Sl(u,c,h,p,b){u.emplaceBack(2*c+(p+1)/2,2*h+(b+1)/2)}class Eo{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(h=>h.id),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new D,this.indexArray=new Ie,this.segments=new Xe,this.programConfigurations=new Sn(c.layers,c.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(c,h,p){const b=this.layers[0],S=[];let I=null,F=!1;b.type==="circle"&&(I=b.layout.get("circle-sort-key"),F=!I.isConstant());for(const{feature:O,id:G,index:K,sourceLayerIndex:J}of c){const ie=this.layers[0]._featureFilter.needGeometry,ce=Lc(O,ie);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),ce,p))continue;const Ae=F?I.evaluate(ce,{},p):void 0,Ce={id:G,properties:O.properties,type:O.type,sourceLayerIndex:J,index:K,geometry:ie?ce.geometry:Ic(O),patterns:{},sortKey:Ae};S.push(Ce)}F&&S.sort((O,G)=>O.sortKey-G.sortKey);for(const O of S){const{geometry:G,index:K,sourceLayerIndex:J}=O,ie=c[K].feature;this.addFeature(O,G,K,p),h.featureIndex.insert(ie,G,K,J,this.index)}}update(c,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,Ve),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(c,h,p,b){for(const S of h)for(const I of S){const F=I.x,O=I.y;if(F<0||F>=Rn||O<0||O>=Rn)continue;const G=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,c.sortKey),K=G.vertexLength;Sl(this.layoutVertexArray,F,O,-1,-1),Sl(this.layoutVertexArray,F,O,1,-1),Sl(this.layoutVertexArray,F,O,1,1),Sl(this.layoutVertexArray,F,O,-1,1),this.indexArray.emplaceBack(K,K+1,K+2),this.indexArray.emplaceBack(K,K+3,K+2),G.vertexLength+=4,G.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,p,{},b)}}function pu(u,c){for(let h=0;h<u.length;h++)if(Tl(c,u[h]))return!0;for(let h=0;h<c.length;h++)if(Tl(u,c[h]))return!0;return!!hA(u,c)}function So(u,c,h){return!!Tl(u,c)||!!lp(c,u,h)}function Fc(u,c){if(u.length===1)return up(c,u[0]);for(let h=0;h<c.length;h++){const p=c[h];for(let b=0;b<p.length;b++)if(Tl(u,p[b]))return!0}for(let h=0;h<u.length;h++)if(up(c,u[h]))return!0;for(let h=0;h<c.length;h++)if(hA(u,c[h]))return!0;return!1}function Mc(u,c,h){if(u.length>1){if(hA(u,c))return!0;for(let p=0;p<c.length;p++)if(lp(c[p],u,h))return!0}for(let p=0;p<u.length;p++)if(lp(u[p],c,h))return!0;return!1}function hA(u,c){if(u.length===0||c.length===0)return!1;for(let h=0;h<u.length-1;h++){const p=u[h],b=u[h+1];for(let S=0;S<c.length-1;S++)if(gu(p,b,c[S],c[S+1]))return!0}return!1}function gu(u,c,h,p){return _e(u,h,p)!==_e(c,h,p)&&_e(u,c,h)!==_e(u,c,p)}function lp(u,c,h){const p=h*h;if(c.length===1)return u.distSqr(c[0])<p;for(let b=1;b<c.length;b++)if(wd(u,c[b-1],c[b])<p)return!0;return!1}function wd(u,c,h){const p=c.distSqr(h);if(p===0)return u.distSqr(c);const b=((u.x-c.x)*(h.x-c.x)+(u.y-c.y)*(h.y-c.y))/p;return u.distSqr(b<0?c:b>1?h:h.sub(c)._mult(b)._add(c))}function up(u,c){let h,p,b,S=!1;for(let I=0;I<u.length;I++){h=u[I];for(let F=0,O=h.length-1;F<h.length;O=F++)p=h[F],b=h[O],p.y>c.y!=b.y>c.y&&c.x<(b.x-p.x)*(c.y-p.y)/(b.y-p.y)+p.x&&(S=!S)}return S}function Tl(u,c){let h=!1;for(let p=0,b=u.length-1;p<u.length;b=p++){const S=u[p],I=u[b];S.y>c.y!=I.y>c.y&&c.x<(I.x-S.x)*(c.y-S.y)/(I.y-S.y)+S.x&&(h=!h)}return h}function xd(u,c,h){const p=h[0],b=h[2];if(u.x<p.x&&c.x<p.x||u.x>b.x&&c.x>b.x||u.y<p.y&&c.y<p.y||u.y>b.y&&c.y>b.y)return!1;const S=_e(u,c,h[0]);return S!==_e(u,c,h[1])||S!==_e(u,c,h[2])||S!==_e(u,c,h[3])}function Bd(u,c,h){const p=c.paint.get(u).value;return p.kind==="constant"?p.value:h.programConfigurations.get(c.id).getMaxValue(u)}function Ap(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function lh(u,c,h,p,b){if(!c[0]&&!c[1])return u;const S=v.convert(c)._mult(b);h==="viewport"&&S._rotate(-p);const I=[];for(let F=0;F<u.length;F++)I.push(u[F].sub(S));return I}let Il,m_;er("CircleBucket",Eo,{omit:["layers"]});var rE={get paint(){return m_=m_||new $i({"circle-radius":new wr(Ye.paint_circle["circle-radius"]),"circle-color":new wr(Ye.paint_circle["circle-color"]),"circle-blur":new wr(Ye.paint_circle["circle-blur"]),"circle-opacity":new wr(Ye.paint_circle["circle-opacity"]),"circle-translate":new dr(Ye.paint_circle["circle-translate"]),"circle-translate-anchor":new dr(Ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new dr(Ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new dr(Ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new wr(Ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new wr(Ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new wr(Ye.paint_circle["circle-stroke-opacity"])})},get layout(){return Il=Il||new $i({"circle-sort-key":new wr(Ye.layout_circle["circle-sort-key"])})}},zs=1e-6,dA=typeof Float32Array<"u"?Float32Array:Array;function uh(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function bm(u,c,h){var p=c[0],b=c[1],S=c[2],I=c[3],F=c[4],O=c[5],G=c[6],K=c[7],J=c[8],ie=c[9],ce=c[10],Ae=c[11],Ce=c[12],Le=c[13],Ne=c[14],rt=c[15],ze=h[0],We=h[1],bt=h[2],wt=h[3];return u[0]=ze*p+We*F+bt*J+wt*Ce,u[1]=ze*b+We*O+bt*ie+wt*Le,u[2]=ze*S+We*G+bt*ce+wt*Ne,u[3]=ze*I+We*K+bt*Ae+wt*rt,u[4]=(ze=h[4])*p+(We=h[5])*F+(bt=h[6])*J+(wt=h[7])*Ce,u[5]=ze*b+We*O+bt*ie+wt*Le,u[6]=ze*S+We*G+bt*ce+wt*Ne,u[7]=ze*I+We*K+bt*Ae+wt*rt,u[8]=(ze=h[8])*p+(We=h[9])*F+(bt=h[10])*J+(wt=h[11])*Ce,u[9]=ze*b+We*O+bt*ie+wt*Le,u[10]=ze*S+We*G+bt*ce+wt*Ne,u[11]=ze*I+We*K+bt*Ae+wt*rt,u[12]=(ze=h[12])*p+(We=h[13])*F+(bt=h[14])*J+(wt=h[15])*Ce,u[13]=ze*b+We*O+bt*ie+wt*Le,u[14]=ze*S+We*G+bt*ce+wt*Ne,u[15]=ze*I+We*K+bt*Ae+wt*rt,u}Math.hypot||(Math.hypot=function(){for(var u=0,c=arguments.length;c--;)u+=arguments[c]*arguments[c];return Math.sqrt(u)});var Ah,hp=bm;function hh(u,c,h){var p=c[0],b=c[1],S=c[2],I=c[3];return u[0]=h[0]*p+h[4]*b+h[8]*S+h[12]*I,u[1]=h[1]*p+h[5]*b+h[9]*S+h[13]*I,u[2]=h[2]*p+h[6]*b+h[10]*S+h[14]*I,u[3]=h[3]*p+h[7]*b+h[11]*S+h[15]*I,u}Ah=new dA(4),dA!=Float32Array&&(Ah[0]=0,Ah[1]=0,Ah[2]=0,Ah[3]=0);class Cd extends Zo{constructor(c){super(c,rE)}createBucket(c){return new Eo(c)}queryRadius(c){const h=c;return Bd("circle-radius",this,h)+Bd("circle-stroke-width",this,h)+Ap(this.paint.get("circle-translate"))}queryIntersectsFeature(c,h,p,b,S,I,F,O){const G=lh(c,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),I.angle,F),K=this.paint.get("circle-radius").evaluate(h,p)+this.paint.get("circle-stroke-width").evaluate(h,p),J=this.paint.get("circle-pitch-alignment")==="map",ie=J?G:function(Ae,Ce){return Ae.map(Le=>wm(Le,Ce))}(G,O),ce=J?K*F:K;for(const Ae of b)for(const Ce of Ae){const Le=J?Ce:wm(Ce,O);let Ne=ce;const rt=hh([],[Ce.x,Ce.y,0,1],O);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ne*=rt[3]/I.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ne*=I.cameraToCenterDistance/rt[3]),So(ie,Le,Ne))return!0}return!1}}function wm(u,c){const h=hh([],[u.x,u.y,0,1],c);return new v(h[0]/h[3],h[1]/h[3])}class y_ extends Eo{}let Ed;er("HeatmapBucket",y_,{omit:["layers"]});var __={get paint(){return Ed=Ed||new $i({"heatmap-radius":new wr(Ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new wr(Ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new dr(Ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new oA(Ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new dr(Ye.paint_heatmap["heatmap-opacity"])})}};function Sd(u,c,h,p){let{width:b,height:S}=c;if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==b*S*h)throw new RangeError(`mismatched image size. expected: ${p.length} but got: ${b*S*h}`)}else p=new Uint8Array(b*S*h);return u.width=b,u.height=S,u.data=p,u}function Ll(u,c,h){let{width:p,height:b}=c;if(p===u.width&&b===u.height)return;const S=Sd({},{width:p,height:b},h);dp(u,S,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,p),height:Math.min(u.height,b)},h),u.width=p,u.height=b,u.data=S.data}function dp(u,c,h,p,b,S){if(b.width===0||b.height===0)return c;if(b.width>u.width||b.height>u.height||h.x>u.width-b.width||h.y>u.height-b.height)throw new RangeError("out of range source coordinates for image copy");if(b.width>c.width||b.height>c.height||p.x>c.width-b.width||p.y>c.height-b.height)throw new RangeError("out of range destination coordinates for image copy");const I=u.data,F=c.data;if(I===F)throw new Error("srcData equals dstData, so image is already copied");for(let O=0;O<b.height;O++){const G=((h.y+O)*u.width+h.x)*S,K=((p.y+O)*c.width+p.x)*S;for(let J=0;J<b.width*S;J++)F[K+J]=I[G+J]}return c}class dh{constructor(c,h){Sd(this,c,1,h)}resize(c){Ll(this,c,1)}clone(){return new dh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,h,p,b,S){dp(c,h,p,b,S,1)}}class ra{constructor(c,h){Sd(this,c,4,h)}resize(c){Ll(this,c,4)}replace(c,h){h?this.data.set(c):this.data=c instanceof Uint8ClampedArray?new Uint8Array(c.buffer):c}clone(){return new ra({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,h,p,b,S){dp(c,h,p,b,S,4)}}function xm(u){const c={},h=u.resolution||256,p=u.clips?u.clips.length:1,b=u.image||new ra({width:h,height:p});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const S=(I,F,O)=>{c[u.evaluationKey]=O;const G=u.expression.evaluate(c);b.data[I+F+0]=Math.floor(255*G.r/G.a),b.data[I+F+1]=Math.floor(255*G.g/G.a),b.data[I+F+2]=Math.floor(255*G.b/G.a),b.data[I+F+3]=Math.floor(255*G.a)};if(u.clips)for(let I=0,F=0;I<p;++I,F+=4*h)for(let O=0,G=0;O<h;O++,G+=4){const K=O/(h-1),{start:J,end:ie}=u.clips[I];S(F,G,J*(1-K)+ie*K)}else for(let I=0,F=0;I<h;I++,F+=4)S(0,F,I/(h-1));return b}er("AlphaImage",dh),er("RGBAImage",ra);class fh extends Zo{createBucket(c){return new y_(c)}constructor(c){super(c,__),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=xm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let v_;var b_={get paint(){return v_=v_||new $i({"hillshade-illumination-direction":new dr(Ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new dr(Ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new dr(Ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new dr(Ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new dr(Ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new dr(Ye.paint_hillshade["hillshade-accent-color"])})}};class nE extends Zo{constructor(c){super(c,b_)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const w_=Ei([{name:"a_pos",components:2,type:"Int16"}],4),{members:iE}=w_;var fA={exports:{}};function ph(u,c,h){h=h||2;var p,b,S,I,F,O,G,K=c&&c.length,J=K?c[0]*h:u.length,ie=Td(u,0,J,h,!0),ce=[];if(!ie||ie.next===ie.prev)return ce;if(K&&(ie=function(Ce,Le,Ne,rt){var ze,We,bt,wt=[];for(ze=0,We=Le.length;ze<We;ze++)(bt=Td(Ce,Le[ze]*rt,ze<We-1?Le[ze+1]*rt:Ce.length,rt,!1))===bt.next&&(bt.steiner=!0),wt.push(W1e(bt));for(wt.sort(sE),ze=0;ze<wt.length;ze++)Ne=Cm(wt[ze],Ne);return Ne}(u,c,ie,h)),u.length>80*h){p=S=u[0],b=I=u[1];for(var Ae=h;Ae<J;Ae+=h)(F=u[Ae])<p&&(p=F),(O=u[Ae+1])<b&&(b=O),F>S&&(S=F),O>I&&(I=O);G=(G=Math.max(S-p,I-b))!==0?32767/G:0}return Ca(ie,ce,h,p,b,G,0),ce}function Td(u,c,h,p,b){var S,I;if(b===cE(u,c,h,p)>0)for(S=c;S<h;S+=p)I=h6(S,u[S],u[S+1],I);else for(S=h-p;S>=c;S-=p)I=h6(S,u[S],u[S+1],I);return I&&B_(I,I.next)&&(Tm(I),I=I.next),I}function ro(u,c){if(!u)return u;c||(c=u);var h,p=u;do if(h=!1,p.steiner||!B_(p,p.next)&&Qi(p.prev,p,p.next)!==0)p=p.next;else{if(Tm(p),(p=c=p.prev)===p.next)break;h=!0}while(h||p!==c);return c}function Ca(u,c,h,p,b,S,I){if(u){!I&&S&&function(K,J,ie,ce){var Ae=K;do Ae.z===0&&(Ae.z=oE(Ae.x,Ae.y,J,ie,ce)),Ae.prevZ=Ae.prev,Ae.nextZ=Ae.next,Ae=Ae.next;while(Ae!==K);Ae.prevZ.nextZ=null,Ae.prevZ=null,function(Ce){var Le,Ne,rt,ze,We,bt,wt,Zt,hr=1;do{for(Ne=Ce,Ce=null,We=null,bt=0;Ne;){for(bt++,rt=Ne,wt=0,Le=0;Le<hr&&(wt++,rt=rt.nextZ);Le++);for(Zt=hr;wt>0||Zt>0&&rt;)wt!==0&&(Zt===0||!rt||Ne.z<=rt.z)?(ze=Ne,Ne=Ne.nextZ,wt--):(ze=rt,rt=rt.nextZ,Zt--),We?We.nextZ=ze:Ce=ze,ze.prevZ=We,We=ze;Ne=rt}We.nextZ=null,hr*=2}while(bt>1)}(Ae)}(u,p,b,S);for(var F,O,G=u;u.prev!==u.next;)if(F=u.prev,O=u.next,S?fp(u,p,b,S):mu(u))c.push(F.i/h|0),c.push(u.i/h|0),c.push(O.i/h|0),Tm(u),u=O.next,G=O.next;else if((u=O)===G){I?I===1?Ca(u=Bm(ro(u),c,h),c,h,p,b,S,2):I===2&&x_(u,c,h,p,b,S):Ca(ro(u),c,h,p,b,S,1);break}}}function mu(u){var c=u.prev,h=u,p=u.next;if(Qi(c,h,p)>=0)return!1;for(var b=c.x,S=h.x,I=p.x,F=c.y,O=h.y,G=p.y,K=b<S?b<I?b:I:S<I?S:I,J=F<O?F<G?F:G:O<G?O:G,ie=b>S?b>I?b:I:S>I?S:I,ce=F>O?F>G?F:G:O>G?O:G,Ae=p.next;Ae!==c;){if(Ae.x>=K&&Ae.x<=ie&&Ae.y>=J&&Ae.y<=ce&&pp(b,F,S,O,I,G,Ae.x,Ae.y)&&Qi(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.next}return!0}function fp(u,c,h,p){var b=u.prev,S=u,I=u.next;if(Qi(b,S,I)>=0)return!1;for(var F=b.x,O=S.x,G=I.x,K=b.y,J=S.y,ie=I.y,ce=F<O?F<G?F:G:O<G?O:G,Ae=K<J?K<ie?K:ie:J<ie?J:ie,Ce=F>O?F>G?F:G:O>G?O:G,Le=K>J?K>ie?K:ie:J>ie?J:ie,Ne=oE(ce,Ae,c,h,p),rt=oE(Ce,Le,c,h,p),ze=u.prevZ,We=u.nextZ;ze&&ze.z>=Ne&&We&&We.z<=rt;){if(ze.x>=ce&&ze.x<=Ce&&ze.y>=Ae&&ze.y<=Le&&ze!==b&&ze!==I&&pp(F,K,O,J,G,ie,ze.x,ze.y)&&Qi(ze.prev,ze,ze.next)>=0||(ze=ze.prevZ,We.x>=ce&&We.x<=Ce&&We.y>=Ae&&We.y<=Le&&We!==b&&We!==I&&pp(F,K,O,J,G,ie,We.x,We.y)&&Qi(We.prev,We,We.next)>=0))return!1;We=We.nextZ}for(;ze&&ze.z>=Ne;){if(ze.x>=ce&&ze.x<=Ce&&ze.y>=Ae&&ze.y<=Le&&ze!==b&&ze!==I&&pp(F,K,O,J,G,ie,ze.x,ze.y)&&Qi(ze.prev,ze,ze.next)>=0)return!1;ze=ze.prevZ}for(;We&&We.z<=rt;){if(We.x>=ce&&We.x<=Ce&&We.y>=Ae&&We.y<=Le&&We!==b&&We!==I&&pp(F,K,O,J,G,ie,We.x,We.y)&&Qi(We.prev,We,We.next)>=0)return!1;We=We.nextZ}return!0}function Bm(u,c,h){var p=u;do{var b=p.prev,S=p.next.next;!B_(b,S)&&u6(b,p,p.next,S)&&Sm(b,S)&&Sm(S,b)&&(c.push(b.i/h|0),c.push(p.i/h|0),c.push(S.i/h|0),Tm(p),Tm(p.next),p=u=S),p=p.next}while(p!==u);return ro(p)}function x_(u,c,h,p,b,S){var I=u;do{for(var F=I.next.next;F!==I.prev;){if(I.i!==F.i&&$1e(I,F)){var O=A6(I,F);return I=ro(I,I.next),O=ro(O,O.next),Ca(I,c,h,p,b,S,0),void Ca(O,c,h,p,b,S,0)}F=F.next}I=I.next}while(I!==u)}function sE(u,c){return u.x-c.x}function Cm(u,c){var h=function(b,S){var I,F=S,O=b.x,G=b.y,K=-1/0;do{if(G<=F.y&&G>=F.next.y&&F.next.y!==F.y){var J=F.x+(G-F.y)*(F.next.x-F.x)/(F.next.y-F.y);if(J<=O&&J>K&&(K=J,I=F.x<F.next.x?F:F.next,J===O))return I}F=F.next}while(F!==S);if(!I)return null;var ie,ce=I,Ae=I.x,Ce=I.y,Le=1/0;F=I;do O>=F.x&&F.x>=Ae&&O!==F.x&&pp(G<Ce?O:K,G,Ae,Ce,G<Ce?K:O,G,F.x,F.y)&&(ie=Math.abs(G-F.y)/(O-F.x),Sm(F,b)&&(ie<Le||ie===Le&&(F.x>I.x||F.x===I.x&&Em(I,F)))&&(I=F,Le=ie)),F=F.next;while(F!==ce);return I}(u,c);if(!h)return c;var p=A6(h,u);return ro(p,p.next),ro(h,h.next)}function Em(u,c){return Qi(u.prev,u,c.prev)<0&&Qi(c.next,u,u.next)<0}function oE(u,c,h,p,b){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-h)*b|0)|u<<8))|u<<4))|u<<2))|u<<1))|(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-p)*b|0)|c<<8))|c<<4))|c<<2))|c<<1))<<1}function W1e(u){var c=u,h=u;do(c.x<h.x||c.x===h.x&&c.y<h.y)&&(h=c),c=c.next;while(c!==u);return h}function pp(u,c,h,p,b,S,I,F){return(b-I)*(c-F)>=(u-I)*(S-F)&&(u-I)*(p-F)>=(h-I)*(c-F)&&(h-I)*(S-F)>=(b-I)*(p-F)}function $1e(u,c){return u.next.i!==c.i&&u.prev.i!==c.i&&!function(h,p){var b=h;do{if(b.i!==h.i&&b.next.i!==h.i&&b.i!==p.i&&b.next.i!==p.i&&u6(b,b.next,h,p))return!0;b=b.next}while(b!==h);return!1}(u,c)&&(Sm(u,c)&&Sm(c,u)&&function(h,p){var b=h,S=!1,I=(h.x+p.x)/2,F=(h.y+p.y)/2;do b.y>F!=b.next.y>F&&b.next.y!==b.y&&I<(b.next.x-b.x)*(F-b.y)/(b.next.y-b.y)+b.x&&(S=!S),b=b.next;while(b!==h);return S}(u,c)&&(Qi(u.prev,u,c.prev)||Qi(u,c.prev,c))||B_(u,c)&&Qi(u.prev,u,u.next)>0&&Qi(c.prev,c,c.next)>0)}function Qi(u,c,h){return(c.y-u.y)*(h.x-c.x)-(c.x-u.x)*(h.y-c.y)}function B_(u,c){return u.x===c.x&&u.y===c.y}function u6(u,c,h,p){var b=E_(Qi(u,c,h)),S=E_(Qi(u,c,p)),I=E_(Qi(h,p,u)),F=E_(Qi(h,p,c));return b!==S&&I!==F||!(b!==0||!C_(u,h,c))||!(S!==0||!C_(u,p,c))||!(I!==0||!C_(h,u,p))||!(F!==0||!C_(h,c,p))}function C_(u,c,h){return c.x<=Math.max(u.x,h.x)&&c.x>=Math.min(u.x,h.x)&&c.y<=Math.max(u.y,h.y)&&c.y>=Math.min(u.y,h.y)}function E_(u){return u>0?1:u<0?-1:0}function Sm(u,c){return Qi(u.prev,u,u.next)<0?Qi(u,c,u.next)>=0&&Qi(u,u.prev,c)>=0:Qi(u,c,u.prev)<0||Qi(u,u.next,c)<0}function A6(u,c){var h=new aE(u.i,u.x,u.y),p=new aE(c.i,c.x,c.y),b=u.next,S=c.prev;return u.next=c,c.prev=u,h.next=b,b.prev=h,p.next=h,h.prev=p,S.next=p,p.prev=S,p}function h6(u,c,h,p){var b=new aE(u,c,h);return p?(b.next=p.next,b.prev=p,p.next.prev=b,p.next=b):(b.prev=b,b.next=b),b}function Tm(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function aE(u,c,h){this.i=u,this.x=c,this.y=h,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function cE(u,c,h,p){for(var b=0,S=c,I=h-p;S<h;S+=p)b+=(u[I]-u[S])*(u[S+1]+u[I+1]),I=S;return b}fA.exports=ph,fA.exports.default=ph,ph.deviation=function(u,c,h,p){var b=c&&c.length,S=Math.abs(cE(u,0,b?c[0]*h:u.length,h));if(b)for(var I=0,F=c.length;I<F;I++)S-=Math.abs(cE(u,c[I]*h,I<F-1?c[I+1]*h:u.length,h));var O=0;for(I=0;I<p.length;I+=3){var G=p[I]*h,K=p[I+1]*h,J=p[I+2]*h;O+=Math.abs((u[G]-u[J])*(u[K+1]-u[G+1])-(u[G]-u[K])*(u[J+1]-u[G+1]))}return S===0&&O===0?0:Math.abs((O-S)/S)},ph.flatten=function(u){for(var c=u[0][0].length,h={vertices:[],holes:[],dimensions:c},p=0,b=0;b<u.length;b++){for(var S=0;S<u[b].length;S++)for(var I=0;I<c;I++)h.vertices.push(u[b][S][I]);b>0&&h.holes.push(p+=u[b-1].length)}return h};var d6=A(fA.exports);function X1e(u,c,h,p,b){f6(u,c,h||0,p||u.length-1,b||J1e)}function f6(u,c,h,p,b){for(;p>h;){if(p-h>600){var S=p-h+1,I=c-h+1,F=Math.log(S),O=.5*Math.exp(2*F/3),G=.5*Math.sqrt(F*O*(S-O)/S)*(I-S/2<0?-1:1);f6(u,c,Math.max(h,Math.floor(c-I*O/S+G)),Math.min(p,Math.floor(c+(S-I)*O/S+G)),b)}var K=u[c],J=h,ie=p;for(Im(u,h,c),b(u[p],K)>0&&Im(u,h,p);J<ie;){for(Im(u,J,ie),J++,ie--;b(u[J],K)<0;)J++;for(;b(u[ie],K)>0;)ie--}b(u[h],K)===0?Im(u,h,ie):Im(u,++ie,p),ie<=c&&(h=ie+1),c<=ie&&(p=ie-1)}}function Im(u,c,h){var p=u[c];u[c]=u[h],u[h]=p}function J1e(u,c){return u<c?-1:u>c?1:0}function lE(u,c){const h=u.length;if(h<=1)return[u];const p=[];let b,S;for(let I=0;I<h;I++){const F=tt(u[I]);F!==0&&(u[I].area=Math.abs(F),S===void 0&&(S=F<0),S===F<0?(b&&p.push(b),b=[u[I]]):b.push(u[I]))}if(b&&p.push(b),c>1)for(let I=0;I<p.length;I++)p[I].length<=c||(X1e(p[I],c,1,p[I].length-1,Y1e),p[I]=p[I].slice(0,c));return p}function Y1e(u,c){return c.area-u.area}function uE(u,c,h){const p=h.patternDependencies;let b=!1;for(const S of c){const I=S.paint.get(`${u}-pattern`);I.isConstant()||(b=!0);const F=I.constantOr(null);F&&(b=!0,p[F.to]=!0,p[F.from]=!0)}return b}function AE(u,c,h,p,b){const S=b.patternDependencies;for(const I of c){const F=I.paint.get(`${u}-pattern`).value;if(F.kind!=="constant"){let O=F.evaluate({zoom:p-1},h,{},b.availableImages),G=F.evaluate({zoom:p},h,{},b.availableImages),K=F.evaluate({zoom:p+1},h,{},b.availableImages);O=O&&O.name?O.name:O,G=G&&G.name?G.name:G,K=K&&K.name?K.name:K,S[O]=!0,S[G]=!0,S[K]=!0,h.patterns[I.id]={min:O,mid:G,max:K}}}return h}class hE{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(h=>h.id),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new H,this.indexArray=new Ie,this.indexArray2=new ve,this.programConfigurations=new Sn(c.layers,c.zoom),this.segments=new Xe,this.segments2=new Xe,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(c,h,p){this.hasPattern=uE("fill",this.layers,h);const b=this.layers[0].layout.get("fill-sort-key"),S=!b.isConstant(),I=[];for(const{feature:F,id:O,index:G,sourceLayerIndex:K}of c){const J=this.layers[0]._featureFilter.needGeometry,ie=Lc(F,J);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),ie,p))continue;const ce=S?b.evaluate(ie,{},p,h.availableImages):void 0,Ae={id:O,properties:F.properties,type:F.type,sourceLayerIndex:K,index:G,geometry:J?ie.geometry:Ic(F),patterns:{},sortKey:ce};I.push(Ae)}S&&I.sort((F,O)=>F.sortKey-O.sortKey);for(const F of I){const{geometry:O,index:G,sourceLayerIndex:K}=F;if(this.hasPattern){const J=AE("fill",this.layers,F,this.zoom,h);this.patternFeatures.push(J)}else this.addFeature(F,O,G,p,{});h.featureIndex.insert(c[G].feature,O,G,K,this.index)}}update(c,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,p)}addFeatures(c,h,p){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,h,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,iE),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.indexBuffer2=c.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(c,h,p,b,S){for(const I of lE(h,500)){let F=0;for(const ce of I)F+=ce.length;const O=this.segments.prepareSegment(F,this.layoutVertexArray,this.indexArray),G=O.vertexLength,K=[],J=[];for(const ce of I){if(ce.length===0)continue;ce!==I[0]&&J.push(K.length/2);const Ae=this.segments2.prepareSegment(ce.length,this.layoutVertexArray,this.indexArray2),Ce=Ae.vertexLength;this.layoutVertexArray.emplaceBack(ce[0].x,ce[0].y),this.indexArray2.emplaceBack(Ce+ce.length-1,Ce),K.push(ce[0].x),K.push(ce[0].y);for(let Le=1;Le<ce.length;Le++)this.layoutVertexArray.emplaceBack(ce[Le].x,ce[Le].y),this.indexArray2.emplaceBack(Ce+Le-1,Ce+Le),K.push(ce[Le].x),K.push(ce[Le].y);Ae.vertexLength+=ce.length,Ae.primitiveLength+=ce.length}const ie=d6(K,J);for(let ce=0;ce<ie.length;ce+=3)this.indexArray.emplaceBack(G+ie[ce],G+ie[ce+1],G+ie[ce+2]);O.vertexLength+=F,O.primitiveLength+=ie.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,p,S,b)}}let p6,g6;er("FillBucket",hE,{omit:["layers","patternFeatures"]});var Z1e={get paint(){return g6=g6||new $i({"fill-antialias":new dr(Ye.paint_fill["fill-antialias"]),"fill-opacity":new wr(Ye.paint_fill["fill-opacity"]),"fill-color":new wr(Ye.paint_fill["fill-color"]),"fill-outline-color":new wr(Ye.paint_fill["fill-outline-color"]),"fill-translate":new dr(Ye.paint_fill["fill-translate"]),"fill-translate-anchor":new dr(Ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new ih(Ye.paint_fill["fill-pattern"])})},get layout(){return p6=p6||new $i({"fill-sort-key":new wr(Ye.layout_fill["fill-sort-key"])})}};class e_e extends Zo{constructor(c){super(c,Z1e)}recalculate(c,h){super.recalculate(c,h);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new hE(c)}queryRadius(){return Ap(this.paint.get("fill-translate"))}queryIntersectsFeature(c,h,p,b,S,I,F){return Fc(lh(c,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),I.angle,F),b)}isTileClipped(){return!0}}const t_e=Ei([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),r_e=Ei([{name:"a_centroid",components:2,type:"Int16"}],4),{members:n_e}=t_e;var gh={},i_e=f,m6=gp;function gp(u,c,h,p,b){this.properties={},this.extent=h,this.type=0,this._pbf=u,this._geometry=-1,this._keys=p,this._values=b,u.readFields(s_e,this,c)}function s_e(u,c,h){u==1?c.id=h.readVarint():u==2?function(p,b){for(var S=p.readVarint()+p.pos;p.pos<S;){var I=b._keys[p.readVarint()],F=b._values[p.readVarint()];b.properties[I]=F}}(h,c):u==3?c.type=h.readVarint():u==4&&(c._geometry=h.pos)}function o_e(u){for(var c,h,p=0,b=0,S=u.length,I=S-1;b<S;I=b++)p+=((h=u[I]).x-(c=u[b]).x)*(c.y+h.y);return p}gp.types=["Unknown","Point","LineString","Polygon"],gp.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var c,h=u.readVarint()+u.pos,p=1,b=0,S=0,I=0,F=[];u.pos<h;){if(b<=0){var O=u.readVarint();p=7&O,b=O>>3}if(b--,p===1||p===2)S+=u.readSVarint(),I+=u.readSVarint(),p===1&&(c&&F.push(c),c=[]),c.push(new i_e(S,I));else{if(p!==7)throw new Error("unknown command "+p);c&&c.push(c[0].clone())}}return c&&F.push(c),F},gp.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var c=u.readVarint()+u.pos,h=1,p=0,b=0,S=0,I=1/0,F=-1/0,O=1/0,G=-1/0;u.pos<c;){if(p<=0){var K=u.readVarint();h=7&K,p=K>>3}if(p--,h===1||h===2)(b+=u.readSVarint())<I&&(I=b),b>F&&(F=b),(S+=u.readSVarint())<O&&(O=S),S>G&&(G=S);else if(h!==7)throw new Error("unknown command "+h)}return[I,O,F,G]},gp.prototype.toGeoJSON=function(u,c,h){var p,b,S=this.extent*Math.pow(2,h),I=this.extent*u,F=this.extent*c,O=this.loadGeometry(),G=gp.types[this.type];function K(ce){for(var Ae=0;Ae<ce.length;Ae++){var Ce=ce[Ae];ce[Ae]=[360*(Ce.x+I)/S-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ce.y+F)/S)*Math.PI/180))-90]}}switch(this.type){case 1:var J=[];for(p=0;p<O.length;p++)J[p]=O[p][0];K(O=J);break;case 2:for(p=0;p<O.length;p++)K(O[p]);break;case 3:for(O=function(ce){var Ae=ce.length;if(Ae<=1)return[ce];for(var Ce,Le,Ne=[],rt=0;rt<Ae;rt++){var ze=o_e(ce[rt]);ze!==0&&(Le===void 0&&(Le=ze<0),Le===ze<0?(Ce&&Ne.push(Ce),Ce=[ce[rt]]):Ce.push(ce[rt]))}return Ce&&Ne.push(Ce),Ne}(O),p=0;p<O.length;p++)for(b=0;b<O[p].length;b++)K(O[p][b])}O.length===1?O=O[0]:G="Multi"+G;var ie={type:"Feature",geometry:{type:G,coordinates:O},properties:this.properties};return"id"in this&&(ie.id=this.id),ie};var a_e=m6,y6=_6;function _6(u,c){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(c_e,this,c),this.length=this._features.length}function c_e(u,c,h){u===15?c.version=h.readVarint():u===1?c.name=h.readString():u===5?c.extent=h.readVarint():u===2?c._features.push(h.pos):u===3?c._keys.push(h.readString()):u===4&&c._values.push(function(p){for(var b=null,S=p.readVarint()+p.pos;p.pos<S;){var I=p.readVarint()>>3;b=I===1?p.readString():I===2?p.readFloat():I===3?p.readDouble():I===4?p.readVarint64():I===5?p.readVarint():I===6?p.readSVarint():I===7?p.readBoolean():null}return b}(h))}_6.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var c=this._pbf.readVarint()+this._pbf.pos;return new a_e(this._pbf,c,this.extent,this._keys,this._values)};var l_e=y6;function u_e(u,c,h){if(u===3){var p=new l_e(h,h.readVarint()+h.pos);p.length&&(c[p.name]=p)}}gh.VectorTile=function(u,c){this.layers=u.readFields(u_e,{},c)},gh.VectorTileFeature=m6,gh.VectorTileLayer=y6;const A_e=gh.VectorTileFeature.types,dE=Math.pow(2,13);function Lm(u,c,h,p,b,S,I,F){u.emplaceBack(c,h,2*Math.floor(p*dE)+I,b*dE*2,S*dE*2,Math.round(F))}class fE{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(h=>h.id),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new z,this.centroidVertexArray=new L,this.indexArray=new Ie,this.programConfigurations=new Sn(c.layers,c.zoom),this.segments=new Xe,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(c,h,p){this.features=[],this.hasPattern=uE("fill-extrusion",this.layers,h);for(const{feature:b,id:S,index:I,sourceLayerIndex:F}of c){const O=this.layers[0]._featureFilter.needGeometry,G=Lc(b,O);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),G,p))continue;const K={id:S,sourceLayerIndex:F,index:I,geometry:O?G.geometry:Ic(b),properties:b.properties,type:b.type,patterns:{}};this.hasPattern?this.features.push(AE("fill-extrusion",this.layers,K,this.zoom,h)):this.addFeature(K,K.geometry,I,p,{}),h.featureIndex.insert(b,K.geometry,I,F,this.index,!0)}}addFeatures(c,h,p){for(const b of this.features){const{geometry:S}=b;this.addFeature(b,S,b.index,h,p)}}update(c,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,n_e),this.centroidVertexBuffer=c.createVertexBuffer(this.centroidVertexArray,r_e.members,!0),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(c,h,p,b,S){const I={x:0,y:0,vertexCount:0};for(const F of lE(h,500)){let O=0;for(const Ae of F)O+=Ae.length;let G=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const Ae of F){if(Ae.length===0||d_e(Ae))continue;let Ce=0;for(let Le=0;Le<Ae.length;Le++){const Ne=Ae[Le];if(Le>=1){const rt=Ae[Le-1];if(!h_e(Ne,rt)){G.vertexLength+4>Xe.MAX_VERTEX_ARRAY_LENGTH&&(G=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ze=Ne.sub(rt)._perp()._unit(),We=rt.dist(Ne);Ce+We>32768&&(Ce=0),Lm(this.layoutVertexArray,Ne.x,Ne.y,ze.x,ze.y,0,0,Ce),Lm(this.layoutVertexArray,Ne.x,Ne.y,ze.x,ze.y,0,1,Ce),I.x+=2*Ne.x,I.y+=2*Ne.y,I.vertexCount+=2,Ce+=We,Lm(this.layoutVertexArray,rt.x,rt.y,ze.x,ze.y,0,0,Ce),Lm(this.layoutVertexArray,rt.x,rt.y,ze.x,ze.y,0,1,Ce),I.x+=2*rt.x,I.y+=2*rt.y,I.vertexCount+=2;const bt=G.vertexLength;this.indexArray.emplaceBack(bt,bt+2,bt+1),this.indexArray.emplaceBack(bt+1,bt+2,bt+3),G.vertexLength+=4,G.primitiveLength+=2}}}}if(G.vertexLength+O>Xe.MAX_VERTEX_ARRAY_LENGTH&&(G=this.segments.prepareSegment(O,this.layoutVertexArray,this.indexArray)),A_e[c.type]!=="Polygon")continue;const K=[],J=[],ie=G.vertexLength;for(const Ae of F)if(Ae.length!==0){Ae!==F[0]&&J.push(K.length/2);for(let Ce=0;Ce<Ae.length;Ce++){const Le=Ae[Ce];Lm(this.layoutVertexArray,Le.x,Le.y,0,0,1,1,0),I.x+=Le.x,I.y+=Le.y,I.vertexCount+=1,K.push(Le.x),K.push(Le.y)}}const ce=d6(K,J);for(let Ae=0;Ae<ce.length;Ae+=3)this.indexArray.emplaceBack(ie+ce[Ae],ie+ce[Ae+2],ie+ce[Ae+1]);G.primitiveLength+=ce.length/3,G.vertexLength+=O}for(let F=0;F<I.vertexCount;F++)this.centroidVertexArray.emplaceBack(Math.floor(I.x/I.vertexCount),Math.floor(I.y/I.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,p,S,b)}}function h_e(u,c){return u.x===c.x&&(u.x<0||u.x>Rn)||u.y===c.y&&(u.y<0||u.y>Rn)}function d_e(u){return u.every(c=>c.x<0)||u.every(c=>c.x>Rn)||u.every(c=>c.y<0)||u.every(c=>c.y>Rn)}let v6;er("FillExtrusionBucket",fE,{omit:["layers","features"]});var f_e={get paint(){return v6=v6||new $i({"fill-extrusion-opacity":new dr(Ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new wr(Ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new dr(Ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new dr(Ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ih(Ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new wr(Ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new wr(Ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new dr(Ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class p_e extends Zo{constructor(c){super(c,f_e)}createBucket(c){return new fE(c)}queryRadius(){return Ap(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(c,h,p,b,S,I,F,O){const G=lh(c,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),I.angle,F),K=this.paint.get("fill-extrusion-height").evaluate(h,p),J=this.paint.get("fill-extrusion-base").evaluate(h,p),ie=function(Ae,Ce,Le,Ne){const rt=[];for(const ze of Ae){const We=[ze.x,ze.y,0,1];hh(We,We,Ce),rt.push(new v(We[0]/We[3],We[1]/We[3]))}return rt}(G,O),ce=function(Ae,Ce,Le,Ne){const rt=[],ze=[],We=Ne[8]*Ce,bt=Ne[9]*Ce,wt=Ne[10]*Ce,Zt=Ne[11]*Ce,hr=Ne[8]*Le,Xt=Ne[9]*Le,Wt=Ne[10]*Le,Nt=Ne[11]*Le;for(const or of Ae){const jt=[],Ft=[];for(const Cr of or){const pr=Cr.x,tn=Cr.y,ai=Ne[0]*pr+Ne[4]*tn+Ne[12],fi=Ne[1]*pr+Ne[5]*tn+Ne[13],As=Ne[2]*pr+Ne[6]*tn+Ne[14],Ea=Ne[3]*pr+Ne[7]*tn+Ne[15],To=As+wt,Ji=Ea+Zt,Ss=ai+hr,Vs=fi+Xt,Io=As+Wt,Lo=Ea+Nt,hs=new v((ai+We)/Ji,(fi+bt)/Ji);hs.z=To/Ji,jt.push(hs);const ds=new v(Ss/Lo,Vs/Lo);ds.z=Io/Lo,Ft.push(ds)}rt.push(jt),ze.push(Ft)}return[rt,ze]}(b,J,K,O);return function(Ae,Ce,Le){let Ne=1/0;Fc(Le,Ce)&&(Ne=b6(Le,Ce[0]));for(let rt=0;rt<Ce.length;rt++){const ze=Ce[rt],We=Ae[rt];for(let bt=0;bt<ze.length-1;bt++){const wt=ze[bt],Zt=[wt,ze[bt+1],We[bt+1],We[bt],wt];pu(Le,Zt)&&(Ne=Math.min(Ne,b6(Le,Zt)))}}return Ne!==1/0&&Ne}(ce[0],ce[1],ie)}}function Fm(u,c){return u.x*c.x+u.y*c.y}function b6(u,c){if(u.length===1){let h=0;const p=c[h++];let b;for(;!b||p.equals(b);)if(b=c[h++],!b)return 1/0;for(;h<c.length;h++){const S=c[h],I=u[0],F=b.sub(p),O=S.sub(p),G=I.sub(p),K=Fm(F,F),J=Fm(F,O),ie=Fm(O,O),ce=Fm(G,F),Ae=Fm(G,O),Ce=K*ie-J*J,Le=(ie*ce-J*Ae)/Ce,Ne=(K*Ae-J*ce)/Ce,rt=p.z*(1-Le-Ne)+b.z*Le+S.z*Ne;if(isFinite(rt))return rt}return 1/0}{let h=1/0;for(const p of c)h=Math.min(h,p.z);return h}}const g_e=Ei([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:m_e}=g_e,y_e=Ei([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:__e}=y_e,v_e=gh.VectorTileFeature.types,b_e=Math.cos(Math.PI/180*37.5),w6=Math.pow(2,14)/.5;class pE{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(h=>h.id),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new j,this.layoutVertexArray2=new V,this.indexArray=new Ie,this.programConfigurations=new Sn(c.layers,c.zoom),this.segments=new Xe,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(c,h,p){this.hasPattern=uE("line",this.layers,h);const b=this.layers[0].layout.get("line-sort-key"),S=!b.isConstant(),I=[];for(const{feature:F,id:O,index:G,sourceLayerIndex:K}of c){const J=this.layers[0]._featureFilter.needGeometry,ie=Lc(F,J);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),ie,p))continue;const ce=S?b.evaluate(ie,{},p):void 0,Ae={id:O,properties:F.properties,type:F.type,sourceLayerIndex:K,index:G,geometry:J?ie.geometry:Ic(F),patterns:{},sortKey:ce};I.push(Ae)}S&&I.sort((F,O)=>F.sortKey-O.sortKey);for(const F of I){const{geometry:O,index:G,sourceLayerIndex:K}=F;if(this.hasPattern){const J=AE("line",this.layers,F,this.zoom,h);this.patternFeatures.push(J)}else this.addFeature(F,O,G,p,{});h.featureIndex.insert(c[G].feature,O,G,K,this.index)}}update(c,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,p)}addFeatures(c,h,p){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,h,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=c.createVertexBuffer(this.layoutVertexArray2,__e)),this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,m_e),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(c){if(c.properties&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_end"))return{start:+c.properties.mapbox_clip_start,end:+c.properties.mapbox_clip_end}}addFeature(c,h,p,b,S){const I=this.layers[0].layout,F=I.get("line-join").evaluate(c,{}),O=I.get("line-cap"),G=I.get("line-miter-limit"),K=I.get("line-round-limit");this.lineClips=this.lineFeatureClips(c);for(const J of h)this.addLine(J,c,F,O,G,K);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,p,S,b)}addLine(c,h,p,b,S,I){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ne=0;Ne<c.length-1;Ne++)this.totalDistance+=c[Ne].dist(c[Ne+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const F=v_e[h.type]==="Polygon";let O=c.length;for(;O>=2&&c[O-1].equals(c[O-2]);)O--;let G=0;for(;G<O-1&&c[G].equals(c[G+1]);)G++;if(O<(F?3:2))return;p==="bevel"&&(S=1.05);const K=this.overscaling<=16?15*Rn/(512*this.overscaling):0,J=this.segments.prepareSegment(10*O,this.layoutVertexArray,this.indexArray);let ie,ce,Ae,Ce,Le;this.e1=this.e2=-1,F&&(ie=c[O-2],Le=c[G].sub(ie)._unit()._perp());for(let Ne=G;Ne<O;Ne++){if(Ae=Ne===O-1?F?c[G+1]:void 0:c[Ne+1],Ae&&c[Ne].equals(Ae))continue;Le&&(Ce=Le),ie&&(ce=ie),ie=c[Ne],Le=Ae?Ae.sub(ie)._unit()._perp():Ce,Ce=Ce||Le;let rt=Ce.add(Le);rt.x===0&&rt.y===0||rt._unit();const ze=Ce.x*Le.x+Ce.y*Le.y,We=rt.x*Le.x+rt.y*Le.y,bt=We!==0?1/We:1/0,wt=2*Math.sqrt(2-2*We),Zt=We<b_e&&ce&&Ae,hr=Ce.x*Le.y-Ce.y*Le.x>0;if(Zt&&Ne>G){const Nt=ie.dist(ce);if(Nt>2*K){const or=ie.sub(ie.sub(ce)._mult(K/Nt)._round());this.updateDistance(ce,or),this.addCurrentVertex(or,Ce,0,0,J),ce=or}}const Xt=ce&&Ae;let Wt=Xt?p:F?"butt":b;if(Xt&&Wt==="round"&&(bt<I?Wt="miter":bt<=2&&(Wt="fakeround")),Wt==="miter"&&bt>S&&(Wt="bevel"),Wt==="bevel"&&(bt>2&&(Wt="flipbevel"),bt<S&&(Wt="miter")),ce&&this.updateDistance(ce,ie),Wt==="miter")rt._mult(bt),this.addCurrentVertex(ie,rt,0,0,J);else if(Wt==="flipbevel"){if(bt>100)rt=Le.mult(-1);else{const Nt=bt*Ce.add(Le).mag()/Ce.sub(Le).mag();rt._perp()._mult(Nt*(hr?-1:1))}this.addCurrentVertex(ie,rt,0,0,J),this.addCurrentVertex(ie,rt.mult(-1),0,0,J)}else if(Wt==="bevel"||Wt==="fakeround"){const Nt=-Math.sqrt(bt*bt-1),or=hr?Nt:0,jt=hr?0:Nt;if(ce&&this.addCurrentVertex(ie,Ce,or,jt,J),Wt==="fakeround"){const Ft=Math.round(180*wt/Math.PI/20);for(let Cr=1;Cr<Ft;Cr++){let pr=Cr/Ft;if(pr!==.5){const ai=pr-.5;pr+=pr*ai*(pr-1)*((1.0904+ze*(ze*(3.55645-1.43519*ze)-3.2452))*ai*ai+(.848013+ze*(.215638*ze-1.06021)))}const tn=Le.sub(Ce)._mult(pr)._add(Ce)._unit()._mult(hr?-1:1);this.addHalfVertex(ie,tn.x,tn.y,!1,hr,0,J)}}Ae&&this.addCurrentVertex(ie,Le,-or,-jt,J)}else if(Wt==="butt")this.addCurrentVertex(ie,rt,0,0,J);else if(Wt==="square"){const Nt=ce?1:-1;this.addCurrentVertex(ie,rt,Nt,Nt,J)}else Wt==="round"&&(ce&&(this.addCurrentVertex(ie,Ce,0,0,J),this.addCurrentVertex(ie,Ce,1,1,J,!0)),Ae&&(this.addCurrentVertex(ie,Le,-1,-1,J,!0),this.addCurrentVertex(ie,Le,0,0,J)));if(Zt&&Ne<O-1){const Nt=ie.dist(Ae);if(Nt>2*K){const or=ie.add(Ae.sub(ie)._mult(K/Nt)._round());this.updateDistance(ie,or),this.addCurrentVertex(or,Le,0,0,J),ie=or}}}}addCurrentVertex(c,h,p,b,S){let I=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;const F=h.y*b-h.x,O=-h.y-h.x*b;this.addHalfVertex(c,h.x+h.y*p,h.y-h.x*p,I,!1,p,S),this.addHalfVertex(c,F,O,I,!0,-b,S),this.distance>w6/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(c,h,p,b,S,I))}addHalfVertex(c,h,p,b,S,I,F){let{x:O,y:G}=c;const K=.5*(this.lineClips?this.scaledDistance*(w6-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((O<<1)+(b?1:0),(G<<1)+(S?1:0),Math.round(63*h)+128,Math.round(63*p)+128,1+(I===0?0:I<0?-1:1)|(63&K)<<2,K>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const J=F.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,J),F.primitiveLength++),S?this.e2=J:this.e1=J}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(c,h){this.distance+=c.dist(h),this.updateScaledDistance()}}let x6,B6;er("LineBucket",pE,{omit:["layers","patternFeatures"]});var C6={get paint(){return B6=B6||new $i({"line-opacity":new wr(Ye.paint_line["line-opacity"]),"line-color":new wr(Ye.paint_line["line-color"]),"line-translate":new dr(Ye.paint_line["line-translate"]),"line-translate-anchor":new dr(Ye.paint_line["line-translate-anchor"]),"line-width":new wr(Ye.paint_line["line-width"]),"line-gap-width":new wr(Ye.paint_line["line-gap-width"]),"line-offset":new wr(Ye.paint_line["line-offset"]),"line-blur":new wr(Ye.paint_line["line-blur"]),"line-dasharray":new Bl(Ye.paint_line["line-dasharray"]),"line-pattern":new ih(Ye.paint_line["line-pattern"]),"line-gradient":new oA(Ye.paint_line["line-gradient"])})},get layout(){return x6=x6||new $i({"line-cap":new dr(Ye.layout_line["line-cap"]),"line-join":new wr(Ye.layout_line["line-join"]),"line-miter-limit":new dr(Ye.layout_line["line-miter-limit"]),"line-round-limit":new dr(Ye.layout_line["line-round-limit"]),"line-sort-key":new wr(Ye.layout_line["line-sort-key"])})}};class w_e extends wr{possiblyEvaluate(c,h){return h=new zn(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(c,h)}evaluate(c,h,p,b){return h=ye({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(c,h,p,b)}}let S_;class x_e extends Zo{constructor(c){super(c,C6),this.gradientVersion=0,S_||(S_=new w_e(C6.paint.properties["line-width"].specification),S_.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const h=this.gradientExpression();this.stepInterpolant=!!function(p){return p._styleExpression!==void 0}(h)&&h._styleExpression.expression instanceof ul,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(c,h){super.recalculate(c,h),this.paint._values["line-floorwidth"]=S_.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new pE(c)}queryRadius(c){const h=c,p=E6(Bd("line-width",this,h),Bd("line-gap-width",this,h)),b=Bd("line-offset",this,h);return p/2+Math.abs(b)+Ap(this.paint.get("line-translate"))}queryIntersectsFeature(c,h,p,b,S,I,F){const O=lh(c,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),I.angle,F),G=F/2*E6(this.paint.get("line-width").evaluate(h,p),this.paint.get("line-gap-width").evaluate(h,p)),K=this.paint.get("line-offset").evaluate(h,p);return K&&(b=function(J,ie){const ce=[];for(let Ae=0;Ae<J.length;Ae++){const Ce=J[Ae],Le=[];for(let Ne=0;Ne<Ce.length;Ne++){const rt=Ce[Ne-1],ze=Ce[Ne],We=Ce[Ne+1],bt=Ne===0?new v(0,0):ze.sub(rt)._unit()._perp(),wt=Ne===Ce.length-1?new v(0,0):We.sub(ze)._unit()._perp(),Zt=bt._add(wt)._unit(),hr=Zt.x*wt.x+Zt.y*wt.y;hr!==0&&Zt._mult(1/hr),Le.push(Zt._mult(ie)._add(ze))}ce.push(Le)}return ce}(b,K*F)),function(J,ie,ce){for(let Ae=0;Ae<ie.length;Ae++){const Ce=ie[Ae];if(J.length>=3){for(let Le=0;Le<Ce.length;Le++)if(Tl(J,Ce[Le]))return!0}if(Mc(J,Ce,ce))return!0}return!1}(O,b,G)}isTileClipped(){return!0}}function E6(u,c){return c>0?c+2*u:u}const B_e=Ei([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),C_e=Ei([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ei([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const E_e=Ei([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Ei([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const S6=Ei([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),S_e=Ei([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function T_e(u,c,h){return u.sections.forEach(p=>{p.text=function(b,S,I){const F=S.layout.get("text-transform").evaluate(I,{});return F==="uppercase"?b=b.toLocaleUpperCase():F==="lowercase"&&(b=b.toLocaleLowerCase()),Wa.applyArabicShaping&&(b=Wa.applyArabicShaping(b)),b}(p.text,c,h)}),u}Ei([{name:"triangle",components:3,type:"Uint16"}]),Ei([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ei([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Ei([{type:"Float32",name:"offsetX"}]),Ei([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Ei([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Mm={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var us=24,T6=Vn,I6=function(u,c,h,p,b){var S,I,F=8*b-p-1,O=(1<<F)-1,G=O>>1,K=-7,J=h?b-1:0,ie=h?-1:1,ce=u[c+J];for(J+=ie,S=ce&(1<<-K)-1,ce>>=-K,K+=F;K>0;S=256*S+u[c+J],J+=ie,K-=8);for(I=S&(1<<-K)-1,S>>=-K,K+=p;K>0;I=256*I+u[c+J],J+=ie,K-=8);if(S===0)S=1-G;else{if(S===O)return I?NaN:1/0*(ce?-1:1);I+=Math.pow(2,p),S-=G}return(ce?-1:1)*I*Math.pow(2,S-p)},L6=function(u,c,h,p,b,S){var I,F,O,G=8*S-b-1,K=(1<<G)-1,J=K>>1,ie=b===23?Math.pow(2,-24)-Math.pow(2,-77):0,ce=p?0:S-1,Ae=p?1:-1,Ce=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(F=isNaN(c)?1:0,I=K):(I=Math.floor(Math.log(c)/Math.LN2),c*(O=Math.pow(2,-I))<1&&(I--,O*=2),(c+=I+J>=1?ie/O:ie*Math.pow(2,1-J))*O>=2&&(I++,O/=2),I+J>=K?(F=0,I=K):I+J>=1?(F=(c*O-1)*Math.pow(2,b),I+=J):(F=c*Math.pow(2,J-1)*Math.pow(2,b),I=0));b>=8;u[h+ce]=255&F,ce+=Ae,F/=256,b-=8);for(I=I<<b|F,G+=b;G>0;u[h+ce]=255&I,ce+=Ae,I/=256,G-=8);u[h+ce-Ae]|=128*Ce};function Vn(u){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(u)?u:new Uint8Array(u||0),this.pos=0,this.type=0,this.length=this.buf.length}Vn.Varint=0,Vn.Fixed64=1,Vn.Bytes=2,Vn.Fixed32=5;var gE=4294967296,F6=1/gE,M6=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function pA(u){return u.type===Vn.Bytes?u.readVarint()+u.pos:u.pos+1}function mp(u,c,h){return h?4294967296*c+(u>>>0):4294967296*(c>>>0)+(u>>>0)}function P6(u,c,h){var p=c<=16383?1:c<=2097151?2:c<=268435455?3:Math.floor(Math.log(c)/(7*Math.LN2));h.realloc(p);for(var b=h.pos-1;b>=u;b--)h.buf[b+p]=h.buf[b]}function I_e(u,c){for(var h=0;h<u.length;h++)c.writeVarint(u[h])}function L_e(u,c){for(var h=0;h<u.length;h++)c.writeSVarint(u[h])}function F_e(u,c){for(var h=0;h<u.length;h++)c.writeFloat(u[h])}function M_e(u,c){for(var h=0;h<u.length;h++)c.writeDouble(u[h])}function P_e(u,c){for(var h=0;h<u.length;h++)c.writeBoolean(u[h])}function U_e(u,c){for(var h=0;h<u.length;h++)c.writeFixed32(u[h])}function R_e(u,c){for(var h=0;h<u.length;h++)c.writeSFixed32(u[h])}function O_e(u,c){for(var h=0;h<u.length;h++)c.writeFixed64(u[h])}function D_e(u,c){for(var h=0;h<u.length;h++)c.writeSFixed64(u[h])}function T_(u,c){return(u[c]|u[c+1]<<8|u[c+2]<<16)+16777216*u[c+3]}function yp(u,c,h){u[h]=c,u[h+1]=c>>>8,u[h+2]=c>>>16,u[h+3]=c>>>24}function U6(u,c){return(u[c]|u[c+1]<<8|u[c+2]<<16)+(u[c+3]<<24)}Vn.prototype={destroy:function(){this.buf=null},readFields:function(u,c,h){for(h=h||this.length;this.pos<h;){var p=this.readVarint(),b=p>>3,S=this.pos;this.type=7&p,u(b,c,this),this.pos===S&&this.skip(p)}return c},readMessage:function(u,c){return this.readFields(u,c,this.readVarint()+this.pos)},readFixed32:function(){var u=T_(this.buf,this.pos);return this.pos+=4,u},readSFixed32:function(){var u=U6(this.buf,this.pos);return this.pos+=4,u},readFixed64:function(){var u=T_(this.buf,this.pos)+T_(this.buf,this.pos+4)*gE;return this.pos+=8,u},readSFixed64:function(){var u=T_(this.buf,this.pos)+U6(this.buf,this.pos+4)*gE;return this.pos+=8,u},readFloat:function(){var u=I6(this.buf,this.pos,!0,23,4);return this.pos+=4,u},readDouble:function(){var u=I6(this.buf,this.pos,!0,52,8);return this.pos+=8,u},readVarint:function(u){var c,h,p=this.buf;return c=127&(h=p[this.pos++]),h<128?c:(c|=(127&(h=p[this.pos++]))<<7,h<128?c:(c|=(127&(h=p[this.pos++]))<<14,h<128?c:(c|=(127&(h=p[this.pos++]))<<21,h<128?c:function(b,S,I){var F,O,G=I.buf;if(F=(112&(O=G[I.pos++]))>>4,O<128||(F|=(127&(O=G[I.pos++]))<<3,O<128)||(F|=(127&(O=G[I.pos++]))<<10,O<128)||(F|=(127&(O=G[I.pos++]))<<17,O<128)||(F|=(127&(O=G[I.pos++]))<<24,O<128)||(F|=(1&(O=G[I.pos++]))<<31,O<128))return mp(b,F,S);throw new Error("Expected varint not more than 10 bytes")}(c|=(15&(h=p[this.pos]))<<28,u,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var u=this.readVarint();return u%2==1?(u+1)/-2:u/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var u=this.readVarint()+this.pos,c=this.pos;return this.pos=u,u-c>=12&&M6?function(h,p,b){return M6.decode(h.subarray(p,b))}(this.buf,c,u):function(h,p,b){for(var S="",I=p;I<b;){var F,O,G,K=h[I],J=null,ie=K>239?4:K>223?3:K>191?2:1;if(I+ie>b)break;ie===1?K<128&&(J=K):ie===2?(192&(F=h[I+1]))==128&&(J=(31&K)<<6|63&F)<=127&&(J=null):ie===3?(O=h[I+2],(192&(F=h[I+1]))==128&&(192&O)==128&&((J=(15&K)<<12|(63&F)<<6|63&O)<=2047||J>=55296&&J<=57343)&&(J=null)):ie===4&&(O=h[I+2],G=h[I+3],(192&(F=h[I+1]))==128&&(192&O)==128&&(192&G)==128&&((J=(15&K)<<18|(63&F)<<12|(63&O)<<6|63&G)<=65535||J>=1114112)&&(J=null)),J===null?(J=65533,ie=1):J>65535&&(J-=65536,S+=String.fromCharCode(J>>>10&1023|55296),J=56320|1023&J),S+=String.fromCharCode(J),I+=ie}return S}(this.buf,c,u)},readBytes:function(){var u=this.readVarint()+this.pos,c=this.buf.subarray(this.pos,u);return this.pos=u,c},readPackedVarint:function(u,c){if(this.type!==Vn.Bytes)return u.push(this.readVarint(c));var h=pA(this);for(u=u||[];this.pos<h;)u.push(this.readVarint(c));return u},readPackedSVarint:function(u){if(this.type!==Vn.Bytes)return u.push(this.readSVarint());var c=pA(this);for(u=u||[];this.pos<c;)u.push(this.readSVarint());return u},readPackedBoolean:function(u){if(this.type!==Vn.Bytes)return u.push(this.readBoolean());var c=pA(this);for(u=u||[];this.pos<c;)u.push(this.readBoolean());return u},readPackedFloat:function(u){if(this.type!==Vn.Bytes)return u.push(this.readFloat());var c=pA(this);for(u=u||[];this.pos<c;)u.push(this.readFloat());return u},readPackedDouble:function(u){if(this.type!==Vn.Bytes)return u.push(this.readDouble());var c=pA(this);for(u=u||[];this.pos<c;)u.push(this.readDouble());return u},readPackedFixed32:function(u){if(this.type!==Vn.Bytes)return u.push(this.readFixed32());var c=pA(this);for(u=u||[];this.pos<c;)u.push(this.readFixed32());return u},readPackedSFixed32:function(u){if(this.type!==Vn.Bytes)return u.push(this.readSFixed32());var c=pA(this);for(u=u||[];this.pos<c;)u.push(this.readSFixed32());return u},readPackedFixed64:function(u){if(this.type!==Vn.Bytes)return u.push(this.readFixed64());var c=pA(this);for(u=u||[];this.pos<c;)u.push(this.readFixed64());return u},readPackedSFixed64:function(u){if(this.type!==Vn.Bytes)return u.push(this.readSFixed64());var c=pA(this);for(u=u||[];this.pos<c;)u.push(this.readSFixed64());return u},skip:function(u){var c=7&u;if(c===Vn.Varint)for(;this.buf[this.pos++]>127;);else if(c===Vn.Bytes)this.pos=this.readVarint()+this.pos;else if(c===Vn.Fixed32)this.pos+=4;else{if(c!==Vn.Fixed64)throw new Error("Unimplemented type: "+c);this.pos+=8}},writeTag:function(u,c){this.writeVarint(u<<3|c)},realloc:function(u){for(var c=this.length||16;c<this.pos+u;)c*=2;if(c!==this.length){var h=new Uint8Array(c);h.set(this.buf),this.buf=h,this.length=c}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(u){this.realloc(4),yp(this.buf,u,this.pos),this.pos+=4},writeSFixed32:function(u){this.realloc(4),yp(this.buf,u,this.pos),this.pos+=4},writeFixed64:function(u){this.realloc(8),yp(this.buf,-1&u,this.pos),yp(this.buf,Math.floor(u*F6),this.pos+4),this.pos+=8},writeSFixed64:function(u){this.realloc(8),yp(this.buf,-1&u,this.pos),yp(this.buf,Math.floor(u*F6),this.pos+4),this.pos+=8},writeVarint:function(u){(u=+u||0)>268435455||u<0?function(c,h){var p,b;if(c>=0?(p=c%4294967296|0,b=c/4294967296|0):(b=~(-c/4294967296),4294967295^(p=~(-c%4294967296))?p=p+1|0:(p=0,b=b+1|0)),c>=18446744073709552e3||c<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),function(S,I,F){F.buf[F.pos++]=127&S|128,S>>>=7,F.buf[F.pos++]=127&S|128,S>>>=7,F.buf[F.pos++]=127&S|128,S>>>=7,F.buf[F.pos++]=127&S|128,F.buf[F.pos]=127&(S>>>=7)}(p,0,h),function(S,I){var F=(7&S)<<4;I.buf[I.pos++]|=F|((S>>>=3)?128:0),S&&(I.buf[I.pos++]=127&S|((S>>>=7)?128:0),S&&(I.buf[I.pos++]=127&S|((S>>>=7)?128:0),S&&(I.buf[I.pos++]=127&S|((S>>>=7)?128:0),S&&(I.buf[I.pos++]=127&S|((S>>>=7)?128:0),S&&(I.buf[I.pos++]=127&S)))))}(b,h)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(u){this.writeVarint(u<0?2*-u-1:2*u)},writeBoolean:function(u){this.writeVarint(!!u)},writeString:function(u){u=String(u),this.realloc(4*u.length),this.pos++;var c=this.pos;this.pos=function(p,b,S){for(var I,F,O=0;O<b.length;O++){if((I=b.charCodeAt(O))>55295&&I<57344){if(!F){I>56319||O+1===b.length?(p[S++]=239,p[S++]=191,p[S++]=189):F=I;continue}if(I<56320){p[S++]=239,p[S++]=191,p[S++]=189,F=I;continue}I=F-55296<<10|I-56320|65536,F=null}else F&&(p[S++]=239,p[S++]=191,p[S++]=189,F=null);I<128?p[S++]=I:(I<2048?p[S++]=I>>6|192:(I<65536?p[S++]=I>>12|224:(p[S++]=I>>18|240,p[S++]=I>>12&63|128),p[S++]=I>>6&63|128),p[S++]=63&I|128)}return S}(this.buf,u,this.pos);var h=this.pos-c;h>=128&&P6(c,h,this),this.pos=c-1,this.writeVarint(h),this.pos+=h},writeFloat:function(u){this.realloc(4),L6(this.buf,u,this.pos,!0,23,4),this.pos+=4},writeDouble:function(u){this.realloc(8),L6(this.buf,u,this.pos,!0,52,8),this.pos+=8},writeBytes:function(u){var c=u.length;this.writeVarint(c),this.realloc(c);for(var h=0;h<c;h++)this.buf[this.pos++]=u[h]},writeRawMessage:function(u,c){this.pos++;var h=this.pos;u(c,this);var p=this.pos-h;p>=128&&P6(h,p,this),this.pos=h-1,this.writeVarint(p),this.pos+=p},writeMessage:function(u,c,h){this.writeTag(u,Vn.Bytes),this.writeRawMessage(c,h)},writePackedVarint:function(u,c){c.length&&this.writeMessage(u,I_e,c)},writePackedSVarint:function(u,c){c.length&&this.writeMessage(u,L_e,c)},writePackedBoolean:function(u,c){c.length&&this.writeMessage(u,P_e,c)},writePackedFloat:function(u,c){c.length&&this.writeMessage(u,F_e,c)},writePackedDouble:function(u,c){c.length&&this.writeMessage(u,M_e,c)},writePackedFixed32:function(u,c){c.length&&this.writeMessage(u,U_e,c)},writePackedSFixed32:function(u,c){c.length&&this.writeMessage(u,R_e,c)},writePackedFixed64:function(u,c){c.length&&this.writeMessage(u,O_e,c)},writePackedSFixed64:function(u,c){c.length&&this.writeMessage(u,D_e,c)},writeBytesField:function(u,c){this.writeTag(u,Vn.Bytes),this.writeBytes(c)},writeFixed32Field:function(u,c){this.writeTag(u,Vn.Fixed32),this.writeFixed32(c)},writeSFixed32Field:function(u,c){this.writeTag(u,Vn.Fixed32),this.writeSFixed32(c)},writeFixed64Field:function(u,c){this.writeTag(u,Vn.Fixed64),this.writeFixed64(c)},writeSFixed64Field:function(u,c){this.writeTag(u,Vn.Fixed64),this.writeSFixed64(c)},writeVarintField:function(u,c){this.writeTag(u,Vn.Varint),this.writeVarint(c)},writeSVarintField:function(u,c){this.writeTag(u,Vn.Varint),this.writeSVarint(c)},writeStringField:function(u,c){this.writeTag(u,Vn.Bytes),this.writeString(c)},writeFloatField:function(u,c){this.writeTag(u,Vn.Fixed32),this.writeFloat(c)},writeDoubleField:function(u,c){this.writeTag(u,Vn.Fixed64),this.writeDouble(c)},writeBooleanField:function(u,c){this.writeVarintField(u,!!c)}};var mE=A(T6);const yE=3;function k_e(u,c,h){u===1&&h.readMessage(N_e,c)}function N_e(u,c,h){if(u===3){const{id:p,bitmap:b,width:S,height:I,left:F,top:O,advance:G}=h.readMessage(Q_e,{});c.push({id:p,bitmap:new dh({width:S+2*yE,height:I+2*yE},b),metrics:{width:S,height:I,left:F,top:O,advance:G}})}}function Q_e(u,c,h){u===1?c.id=h.readVarint():u===2?c.bitmap=h.readBytes():u===3?c.width=h.readVarint():u===4?c.height=h.readVarint():u===5?c.left=h.readSVarint():u===6?c.top=h.readSVarint():u===7&&(c.advance=h.readVarint())}const R6=yE;function O6(u){let c=0,h=0;for(const I of u)c+=I.w*I.h,h=Math.max(h,I.w);u.sort((I,F)=>F.h-I.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(c/.95)),h),h:1/0}];let b=0,S=0;for(const I of u)for(let F=p.length-1;F>=0;F--){const O=p[F];if(!(I.w>O.w||I.h>O.h)){if(I.x=O.x,I.y=O.y,S=Math.max(S,I.y+I.h),b=Math.max(b,I.x+I.w),I.w===O.w&&I.h===O.h){const G=p.pop();F<p.length&&(p[F]=G)}else I.h===O.h?(O.x+=I.w,O.w-=I.w):I.w===O.w?(O.y+=I.h,O.h-=I.h):(p.push({x:O.x+I.w,y:O.y,w:O.w-I.w,h:I.h}),O.y+=I.h,O.h-=I.h);break}}return{w:b,h:S,fill:c/(b*S)||0}}const na=1;class _E{constructor(c,h){let{pixelRatio:p,version:b,stretchX:S,stretchY:I,content:F}=h;this.paddedRect=c,this.pixelRatio=p,this.stretchX=S,this.stretchY=I,this.content=F,this.version=b}get tl(){return[this.paddedRect.x+na,this.paddedRect.y+na]}get br(){return[this.paddedRect.x+this.paddedRect.w-na,this.paddedRect.y+this.paddedRect.h-na]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*na)/this.pixelRatio,(this.paddedRect.h-2*na)/this.pixelRatio]}}class D6{constructor(c,h){const p={},b={};this.haveRenderCallbacks=[];const S=[];this.addImages(c,p,S),this.addImages(h,b,S);const{w:I,h:F}=O6(S),O=new ra({width:I||1,height:F||1});for(const G in c){const K=c[G],J=p[G].paddedRect;ra.copy(K.data,O,{x:0,y:0},{x:J.x+na,y:J.y+na},K.data)}for(const G in h){const K=h[G],J=b[G].paddedRect,ie=J.x+na,ce=J.y+na,Ae=K.data.width,Ce=K.data.height;ra.copy(K.data,O,{x:0,y:0},{x:ie,y:ce},K.data),ra.copy(K.data,O,{x:0,y:Ce-1},{x:ie,y:ce-1},{width:Ae,height:1}),ra.copy(K.data,O,{x:0,y:0},{x:ie,y:ce+Ce},{width:Ae,height:1}),ra.copy(K.data,O,{x:Ae-1,y:0},{x:ie-1,y:ce},{width:1,height:Ce}),ra.copy(K.data,O,{x:0,y:0},{x:ie+Ae,y:ce},{width:1,height:Ce})}this.image=O,this.iconPositions=p,this.patternPositions=b}addImages(c,h,p){for(const b in c){const S=c[b],I={x:0,y:0,w:S.data.width+2*na,h:S.data.height+2*na};p.push(I),h[b]=new _E(I,S),S.hasRenderCallback&&this.haveRenderCallbacks.push(b)}}patchUpdatedImages(c,h){c.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in c.updatedImages)this.patchUpdatedImage(this.iconPositions[p],c.getImage(p),h),this.patchUpdatedImage(this.patternPositions[p],c.getImage(p),h)}patchUpdatedImage(c,h,p){if(!c||!h||c.version===h.version)return;c.version=h.version;const[b,S]=c.tl;p.update(h.data,void 0,{x:b,y:S})}}var mh;er("ImagePosition",_E),er("ImageAtlas",D6),a.ah=void 0,(mh=a.ah||(a.ah={}))[mh.none=0]="none",mh[mh.horizontal=1]="horizontal",mh[mh.vertical=2]="vertical",mh[mh.horizontalOnly=3]="horizontalOnly";const Pm=-17;class Um{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(c,h){const p=new Um;return p.scale=c||1,p.fontStack=h,p}static forImage(c){const h=new Um;return h.imageName=c,h}}class _p{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(c,h){const p=new _p;for(let b=0;b<c.sections.length;b++){const S=c.sections[b];S.image?p.addImageSection(S):p.addTextSection(S,h)}return p}length(){return this.text.length}getSection(c){return this.sections[this.sectionIndex[c]]}getSectionIndex(c){return this.sectionIndex[c]}getCharCode(c){return this.text.charCodeAt(c)}verticalizePunctuation(){this.text=function(c){let h="";for(let p=0;p<c.length;p++){const b=c.charCodeAt(p+1)||null,S=c.charCodeAt(p-1)||null;h+=b&&nh(b)&&!Mm[c[p+1]]||S&&nh(S)&&!Mm[c[p-1]]||!Mm[c[p]]?c[p]:Mm[c[p]]}return h}(this.text)}trim(){let c=0;for(let p=0;p<this.text.length&&L_[this.text.charCodeAt(p)];p++)c++;let h=this.text.length;for(let p=this.text.length-1;p>=0&&p>=c&&L_[this.text.charCodeAt(p)];p--)h--;this.text=this.text.substring(c,h),this.sectionIndex=this.sectionIndex.slice(c,h)}substring(c,h){const p=new _p;return p.text=this.text.substring(c,h),p.sectionIndex=this.sectionIndex.slice(c,h),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((c,h)=>Math.max(c,this.sections[h].scale),0)}addTextSection(c,h){this.text+=c.text,this.sections.push(Um.forText(c.scale,c.fontStack||h));const p=this.sections.length-1;for(let b=0;b<c.text.length;++b)this.sectionIndex.push(p)}addImageSection(c){const h=c.image?c.image.name:"";if(h.length===0)return void xe("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(Um.forImage(h)),this.sectionIndex.push(this.sections.length-1)):xe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function I_(u,c,h,p,b,S,I,F,O,G,K,J,ie,ce,Ae,Ce){const Le=_p.fromFeature(u,b);let Ne;J===a.ah.vertical&&Le.verticalizePunctuation();const{processBidirectionalText:rt,processStyledBidirectionalText:ze}=Wa;if(rt&&Le.sections.length===1){Ne=[];const wt=rt(Le.toString(),vE(Le,G,S,c,p,ce,Ae));for(const Zt of wt){const hr=new _p;hr.text=Zt,hr.sections=Le.sections;for(let Xt=0;Xt<Zt.length;Xt++)hr.sectionIndex.push(0);Ne.push(hr)}}else if(ze){Ne=[];const wt=ze(Le.text,Le.sectionIndex,vE(Le,G,S,c,p,ce,Ae));for(const Zt of wt){const hr=new _p;hr.text=Zt[0],hr.sectionIndex=Zt[1],hr.sections=Le.sections,Ne.push(hr)}}else Ne=function(wt,Zt){const hr=[],Xt=wt.text;let Wt=0;for(const Nt of Zt)hr.push(wt.substring(Wt,Nt)),Wt=Nt;return Wt<Xt.length&&hr.push(wt.substring(Wt,Xt.length)),hr}(Le,vE(Le,G,S,c,p,ce,Ae));const We=[],bt={positionedLines:We,text:Le.toString(),top:K[1],bottom:K[1],left:K[0],right:K[0],writingMode:J,iconsInText:!1,verticalizable:!1};return function(wt,Zt,hr,Xt,Wt,Nt,or,jt,Ft,Cr,pr,tn){let ai=0,fi=Pm,As=0,Ea=0;const To=jt==="right"?1:jt==="left"?0:.5;let Ji=0;for(const hs of Wt){hs.trim();const ds=hs.getMaxScale(),no=(ds-1)*us,Fo={positionedGlyphs:[],lineOffset:0};wt.positionedLines[Ji]=Fo;const io=Fo.positionedGlyphs;let ia=0;if(!hs.length()){fi+=Nt,++Ji;continue}for(let fs=0;fs<hs.length();fs++){const An=hs.getSection(fs),so=hs.getSectionIndex(fs),js=hs.getCharCode(fs);let ps=0,Pc=null,Fl=null,Ml=null,gA=us;const Uc=!(Ft===a.ah.horizontal||!pr&&!vl(js)||pr&&(L_[js]||(Ss=js,qt.Arabic(Ss)||qt["Arabic Supplement"](Ss)||qt["Arabic Extended-A"](Ss)||qt["Arabic Presentation Forms-A"](Ss)||qt["Arabic Presentation Forms-B"](Ss))));if(An.imageName){const Ja=Xt[An.imageName];if(!Ja)continue;Ml=An.imageName,wt.iconsInText=wt.iconsInText||!0,Fl=Ja.paddedRect;const oa=Ja.displaySize;An.scale=An.scale*us/tn,Pc={width:oa[0],height:oa[1],left:na,top:-R6,advance:Uc?oa[1]:oa[0]},ps=no+(us-oa[1]*An.scale),gA=Pc.advance;const mA=Uc?oa[0]*An.scale-us*ds:oa[1]*An.scale-us*ds;mA>0&&mA>ia&&(ia=mA)}else{const Ja=hr[An.fontStack],oa=Ja&&Ja[js];if(oa&&oa.rect)Fl=oa.rect,Pc=oa.metrics;else{const mA=Zt[An.fontStack],Nm=mA&&mA[js];if(!Nm)continue;Pc=Nm.metrics}ps=(ds-An.scale)*us}Uc?(wt.verticalizable=!0,io.push({glyph:js,imageName:Ml,x:ai,y:fi+ps,vertical:Uc,scale:An.scale,fontStack:An.fontStack,sectionIndex:so,metrics:Pc,rect:Fl}),ai+=gA*An.scale+Cr):(io.push({glyph:js,imageName:Ml,x:ai,y:fi+ps,vertical:Uc,scale:An.scale,fontStack:An.fontStack,sectionIndex:so,metrics:Pc,rect:Fl}),ai+=Pc.advance*An.scale+Cr)}io.length!==0&&(As=Math.max(ai-Cr,As),G_e(io,0,io.length-1,To,ia)),ai=0;const sa=Nt*ds+ia;Fo.lineOffset=Math.max(ia,no),fi+=sa,Ea=Math.max(sa,Ea),++Ji}var Ss;const Vs=fi-Pm,{horizontalAlign:Io,verticalAlign:Lo}=bE(or);(function(hs,ds,no,Fo,io,ia,sa,fs,An){const so=(ds-no)*io;let js=0;js=ia!==sa?-fs*Fo-Pm:(-Fo*An+.5)*sa;for(const ps of hs)for(const Pc of ps.positionedGlyphs)Pc.x+=so,Pc.y+=js})(wt.positionedLines,To,Io,Lo,As,Ea,Nt,Vs,Wt.length),wt.top+=-Lo*Vs,wt.bottom=wt.top+Vs,wt.left+=-Io*As,wt.right=wt.left+As}(bt,c,h,p,Ne,I,F,O,J,G,ie,Ce),!function(wt){for(const Zt of wt)if(Zt.positionedGlyphs.length!==0)return!1;return!0}(We)&&bt}const L_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},H_e={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function k6(u,c,h,p,b,S){if(c.imageName){const I=p[c.imageName];return I?I.displaySize[0]*c.scale*us/S+b:0}{const I=h[c.fontStack],F=I&&I[u];return F?F.metrics.advance*c.scale+b:0}}function N6(u,c,h,p){const b=Math.pow(u-c,2);return p?u<c?b/2:2*b:b+Math.abs(h)*h}function z_e(u,c,h){let p=0;return u===10&&(p-=1e4),h&&(p+=150),u!==40&&u!==65288||(p+=50),c!==41&&c!==65289||(p+=50),p}function Q6(u,c,h,p,b,S){let I=null,F=N6(c,h,b,S);for(const O of p){const G=N6(c-O.x,h,b,S)+O.badness;G<=F&&(I=O,F=G)}return{index:u,x:c,priorBreak:I,badness:F}}function H6(u){return u?H6(u.priorBreak).concat(u.index):[]}function vE(u,c,h,p,b,S,I){if(S!=="point")return[];if(!u)return[];const F=[],O=function(ie,ce,Ae,Ce,Le,Ne){let rt=0;for(let ze=0;ze<ie.length();ze++){const We=ie.getSection(ze);rt+=k6(ie.getCharCode(ze),We,Ce,Le,ce,Ne)}return rt/Math.max(1,Math.ceil(rt/Ae))}(u,c,h,p,b,I),G=u.text.indexOf("")>=0;let K=0;for(let ie=0;ie<u.length();ie++){const ce=u.getSection(ie),Ae=u.getCharCode(ie);if(L_[Ae]||(K+=k6(Ae,ce,p,b,c,I)),ie<u.length()-1){const Ce=!((J=Ae)<11904||!(qt["Bopomofo Extended"](J)||qt.Bopomofo(J)||qt["CJK Compatibility Forms"](J)||qt["CJK Compatibility Ideographs"](J)||qt["CJK Compatibility"](J)||qt["CJK Radicals Supplement"](J)||qt["CJK Strokes"](J)||qt["CJK Symbols and Punctuation"](J)||qt["CJK Unified Ideographs Extension A"](J)||qt["CJK Unified Ideographs"](J)||qt["Enclosed CJK Letters and Months"](J)||qt["Halfwidth and Fullwidth Forms"](J)||qt.Hiragana(J)||qt["Ideographic Description Characters"](J)||qt["Kangxi Radicals"](J)||qt["Katakana Phonetic Extensions"](J)||qt.Katakana(J)||qt["Vertical Forms"](J)||qt["Yi Radicals"](J)||qt["Yi Syllables"](J)));(H_e[Ae]||Ce||ce.imageName)&&F.push(Q6(ie+1,K,O,F,z_e(Ae,u.getCharCode(ie+1),Ce&&G),!1))}}var J;return H6(Q6(u.length(),K,O,F,0,!0))}function bE(u){let c=.5,h=.5;switch(u){case"right":case"top-right":case"bottom-right":c=1;break;case"left":case"top-left":case"bottom-left":c=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:c,verticalAlign:h}}function G_e(u,c,h,p,b){if(!p&&!b)return;const S=u[h],I=(u[h].x+S.metrics.advance*S.scale)*p;for(let F=c;F<=h;F++)u[F].x-=I,u[F].y+=b}function V_e(u,c,h){const{horizontalAlign:p,verticalAlign:b}=bE(h),S=c[0]-u.displaySize[0]*p,I=c[1]-u.displaySize[1]*b;return{image:u,top:I,bottom:I+u.displaySize[1],left:S,right:S+u.displaySize[0]}}function z6(u,c,h,p,b,S){const I=u.image;let F;if(I.content){const Le=I.content,Ne=I.pixelRatio||1;F=[Le[0]/Ne,Le[1]/Ne,I.displaySize[0]-Le[2]/Ne,I.displaySize[1]-Le[3]/Ne]}const O=c.left*S,G=c.right*S;let K,J,ie,ce;h==="width"||h==="both"?(ce=b[0]+O-p[3],J=b[0]+G+p[1]):(ce=b[0]+(O+G-I.displaySize[0])/2,J=ce+I.displaySize[0]);const Ae=c.top*S,Ce=c.bottom*S;return h==="height"||h==="both"?(K=b[1]+Ae-p[0],ie=b[1]+Ce+p[2]):(K=b[1]+(Ae+Ce-I.displaySize[1])/2,ie=K+I.displaySize[1]),{image:I,top:K,right:J,bottom:ie,left:ce,collisionPadding:F}}const Rm=255,yu=128,yh=Rm*yu;function G6(u,c){const{expression:h}=c;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new zn(u+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:b}=h;let S=0;for(;S<p.length&&p[S]<=u;)S++;S=Math.max(0,S-1);let I=S;for(;I<p.length&&p[I]<u+1;)I++;I=Math.min(p.length-1,I);const F=p[S],O=p[I];return h.kind==="composite"?{kind:"composite",minZoom:F,maxZoom:O,interpolationType:b}:{kind:"camera",minZoom:F,maxZoom:O,minSize:h.evaluate(new zn(F)),maxSize:h.evaluate(new zn(O)),interpolationType:b}}}function wE(u,c,h){let p="never";const b=u.get(c);return b?p=b:u.get(h)&&(p="always"),p}const j_e=gh.VectorTileFeature.types,q_e=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function F_(u,c,h,p,b,S,I,F,O,G,K,J,ie){const ce=F?Math.min(yh,Math.round(F[0])):0,Ae=F?Math.min(yh,Math.round(F[1])):0;u.emplaceBack(c,h,Math.round(32*p),Math.round(32*b),S,I,(ce<<1)+(O?1:0),Ae,16*G,16*K,256*J,256*ie)}function xE(u,c,h){u.emplaceBack(c.x,c.y,h),u.emplaceBack(c.x,c.y,h),u.emplaceBack(c.x,c.y,h),u.emplaceBack(c.x,c.y,h)}function K_e(u){for(const c of u.sections)if(fd(c.text))return!0;return!1}class BE{constructor(c){this.layoutVertexArray=new ue,this.indexArray=new Ie,this.programConfigurations=c,this.segments=new Xe,this.dynamicLayoutVertexArray=new ne,this.opacityVertexArray=new de,this.hasVisibleVertices=!1,this.placedSymbolArray=new d}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(c,h,p,b){this.isEmpty()||(p&&(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,B_e.members),this.indexBuffer=c.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=c.createVertexBuffer(this.dynamicLayoutVertexArray,C_e.members,!0),this.opacityVertexBuffer=c.createVertexBuffer(this.opacityVertexArray,q_e,!0),this.opacityVertexBuffer.itemSize=1),(p||b)&&this.programConfigurations.upload(c))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}er("SymbolBuffers",BE);class CE{constructor(c,h,p){this.layoutVertexArray=new c,this.layoutAttributes=h,this.indexArray=new p,this.segments=new Xe,this.collisionVertexArray=new Ue}upload(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=c.createVertexBuffer(this.collisionVertexArray,E_e.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}er("CollisionBuffers",CE);class vp{constructor(c){this.collisionBoxArray=c.collisionBoxArray,this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(I=>I.id),this.index=c.index,this.pixelRatio=c.pixelRatio,this.sourceLayerIndex=c.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=uh([]),this.placementViewportMatrix=uh([]);const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=G6(this.zoom,h["text-size"]),this.iconSizeData=G6(this.zoom,h["icon-size"]);const p=this.layers[0].layout,b=p.get("symbol-sort-key"),S=p.get("symbol-z-order");this.canOverlap=wE(p,"text-overlap","text-allow-overlap")!=="never"||wE(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=S!=="viewport-y"&&!b.isConstant(),this.sortFeaturesByY=(S==="viewport-y"||S==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map(I=>a.ah[I])),this.stateDependentLayerIds=this.layers.filter(I=>I.isStateDependent()).map(I=>I.id),this.sourceID=c.sourceID}createArrays(){this.text=new BE(new Sn(this.layers,this.zoom,c=>/^text/.test(c))),this.icon=new BE(new Sn(this.layers,this.zoom,c=>/^icon/.test(c))),this.glyphOffsetArray=new E,this.lineVertexArray=new P,this.symbolInstances=new _,this.textAnchorOffsets=new g}calculateGlyphDependencies(c,h,p,b,S){for(let I=0;I<c.length;I++)if(h[c.charCodeAt(I)]=!0,(p||b)&&S){const F=Mm[c.charAt(I)];F&&(h[F.charCodeAt(0)]=!0)}}populate(c,h,p){const b=this.layers[0],S=b.layout,I=S.get("text-font"),F=S.get("text-field"),O=S.get("icon-image"),G=(F.value.kind!=="constant"||F.value.value instanceof _n&&!F.value.value.isEmpty()||F.value.value.toString().length>0)&&(I.value.kind!=="constant"||I.value.value.length>0),K=O.value.kind!=="constant"||!!O.value.value||Object.keys(O.parameters).length>0,J=S.get("symbol-sort-key");if(this.features=[],!G&&!K)return;const ie=h.iconDependencies,ce=h.glyphDependencies,Ae=h.availableImages,Ce=new zn(this.zoom);for(const{feature:Le,id:Ne,index:rt,sourceLayerIndex:ze}of c){const We=b._featureFilter.needGeometry,bt=Lc(Le,We);if(!b._featureFilter.filter(Ce,bt,p))continue;let wt,Zt;if(We||(bt.geometry=Ic(Le)),G){const Xt=b.getValueAndResolveTokens("text-field",bt,p,Ae),Wt=_n.factory(Xt),Nt=this.hasRTLText=this.hasRTLText||K_e(Wt);(!Nt||Wa.getRTLTextPluginStatus()==="unavailable"||Nt&&Wa.isParsed())&&(wt=T_e(Wt,b,bt))}if(K){const Xt=b.getValueAndResolveTokens("icon-image",bt,p,Ae);Zt=Xt instanceof as?Xt:as.fromString(Xt)}if(!wt&&!Zt)continue;const hr=this.sortFeaturesByKey?J.evaluate(bt,{},p):void 0;if(this.features.push({id:Ne,text:wt,icon:Zt,index:rt,sourceLayerIndex:ze,geometry:bt.geometry,properties:Le.properties,type:j_e[Le.type],sortKey:hr}),Zt&&(ie[Zt.name]=!0),wt){const Xt=I.evaluate(bt,{},p).join(","),Wt=S.get("text-rotation-alignment")!=="viewport"&&S.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.ah.vertical)>=0;for(const Nt of wt.sections)if(Nt.image)ie[Nt.image.name]=!0;else{const or=Wi(wt.toString()),jt=Nt.fontStack||Xt,Ft=ce[jt]=ce[jt]||{};this.calculateGlyphDependencies(Nt.text,Ft,Wt,this.allowVerticalPlacement,or)}}}S.get("symbol-placement")==="line"&&(this.features=function(Le){const Ne={},rt={},ze=[];let We=0;function bt(Xt){ze.push(Le[Xt]),We++}function wt(Xt,Wt,Nt){const or=rt[Xt];return delete rt[Xt],rt[Wt]=or,ze[or].geometry[0].pop(),ze[or].geometry[0]=ze[or].geometry[0].concat(Nt[0]),or}function Zt(Xt,Wt,Nt){const or=Ne[Wt];return delete Ne[Wt],Ne[Xt]=or,ze[or].geometry[0].shift(),ze[or].geometry[0]=Nt[0].concat(ze[or].geometry[0]),or}function hr(Xt,Wt,Nt){const or=Nt?Wt[0][Wt[0].length-1]:Wt[0][0];return`${Xt}:${or.x}:${or.y}`}for(let Xt=0;Xt<Le.length;Xt++){const Wt=Le[Xt],Nt=Wt.geometry,or=Wt.text?Wt.text.toString():null;if(!or){bt(Xt);continue}const jt=hr(or,Nt),Ft=hr(or,Nt,!0);if(jt in rt&&Ft in Ne&&rt[jt]!==Ne[Ft]){const Cr=Zt(jt,Ft,Nt),pr=wt(jt,Ft,ze[Cr].geometry);delete Ne[jt],delete rt[Ft],rt[hr(or,ze[pr].geometry,!0)]=pr,ze[Cr].geometry=null}else jt in rt?wt(jt,Ft,Nt):Ft in Ne?Zt(jt,Ft,Nt):(bt(Xt),Ne[jt]=We-1,rt[Ft]=We-1)}return ze.filter(Xt=>Xt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Le,Ne)=>Le.sortKey-Ne.sortKey)}update(c,h,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(c,h,this.layers,p),this.icon.programConfigurations.updatePaintArrays(c,h,this.layers,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(c){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(c),this.iconCollisionBox.upload(c)),this.text.upload(c,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(c,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(c,h){const p=this.lineVertexArray.length;if(c.segment!==void 0){let b=c.dist(h[c.segment+1]),S=c.dist(h[c.segment]);const I={};for(let F=c.segment+1;F<h.length;F++)I[F]={x:h[F].x,y:h[F].y,tileUnitDistanceFromAnchor:b},F<h.length-1&&(b+=h[F+1].dist(h[F]));for(let F=c.segment||0;F>=0;F--)I[F]={x:h[F].x,y:h[F].y,tileUnitDistanceFromAnchor:S},F>0&&(S+=h[F-1].dist(h[F]));for(let F=0;F<h.length;F++){const O=I[F];this.lineVertexArray.emplaceBack(O.x,O.y,O.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(c,h,p,b,S,I,F,O,G,K,J,ie){const ce=c.indexArray,Ae=c.layoutVertexArray,Ce=c.segments.prepareSegment(4*h.length,Ae,ce,this.canOverlap?I.sortKey:void 0),Le=this.glyphOffsetArray.length,Ne=Ce.vertexLength,rt=this.allowVerticalPlacement&&F===a.ah.vertical?Math.PI/2:0,ze=I.text&&I.text.sections;for(let We=0;We<h.length;We++){const{tl:bt,tr:wt,bl:Zt,br:hr,tex:Xt,pixelOffsetTL:Wt,pixelOffsetBR:Nt,minFontScaleX:or,minFontScaleY:jt,glyphOffset:Ft,isSDF:Cr,sectionIndex:pr}=h[We],tn=Ce.vertexLength,ai=Ft[1];F_(Ae,O.x,O.y,bt.x,ai+bt.y,Xt.x,Xt.y,p,Cr,Wt.x,Wt.y,or,jt),F_(Ae,O.x,O.y,wt.x,ai+wt.y,Xt.x+Xt.w,Xt.y,p,Cr,Nt.x,Wt.y,or,jt),F_(Ae,O.x,O.y,Zt.x,ai+Zt.y,Xt.x,Xt.y+Xt.h,p,Cr,Wt.x,Nt.y,or,jt),F_(Ae,O.x,O.y,hr.x,ai+hr.y,Xt.x+Xt.w,Xt.y+Xt.h,p,Cr,Nt.x,Nt.y,or,jt),xE(c.dynamicLayoutVertexArray,O,rt),ce.emplaceBack(tn,tn+1,tn+2),ce.emplaceBack(tn+1,tn+2,tn+3),Ce.vertexLength+=4,Ce.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ft[0]),We!==h.length-1&&pr===h[We+1].sectionIndex||c.programConfigurations.populatePaintArrays(Ae.length,I,I.index,{},ie,ze&&ze[pr])}c.placedSymbolArray.emplaceBack(O.x,O.y,Le,this.glyphOffsetArray.length-Le,Ne,G,K,O.segment,p?p[0]:0,p?p[1]:0,b[0],b[1],F,0,!1,0,J)}_addCollisionDebugVertex(c,h,p,b,S,I){return h.emplaceBack(0,0),c.emplaceBack(p.x,p.y,b,S,Math.round(I.x),Math.round(I.y))}addCollisionDebugVertices(c,h,p,b,S,I,F){const O=S.segments.prepareSegment(4,S.layoutVertexArray,S.indexArray),G=O.vertexLength,K=S.layoutVertexArray,J=S.collisionVertexArray,ie=F.anchorX,ce=F.anchorY;this._addCollisionDebugVertex(K,J,I,ie,ce,new v(c,h)),this._addCollisionDebugVertex(K,J,I,ie,ce,new v(p,h)),this._addCollisionDebugVertex(K,J,I,ie,ce,new v(p,b)),this._addCollisionDebugVertex(K,J,I,ie,ce,new v(c,b)),O.vertexLength+=4;const Ae=S.indexArray;Ae.emplaceBack(G,G+1),Ae.emplaceBack(G+1,G+2),Ae.emplaceBack(G+2,G+3),Ae.emplaceBack(G+3,G),O.primitiveLength+=4}addDebugCollisionBoxes(c,h,p,b){for(let S=c;S<h;S++){const I=this.collisionBoxArray.get(S);this.addCollisionDebugVertices(I.x1,I.y1,I.x2,I.y2,b?this.textCollisionBox:this.iconCollisionBox,I.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new CE(me,S6.members,ve),this.iconCollisionBox=new CE(me,S6.members,ve);for(let c=0;c<this.symbolInstances.length;c++){const h=this.symbolInstances.get(c);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(c,h,p,b,S,I,F,O,G){const K={};for(let J=h;J<p;J++){const ie=c.get(J);K.textBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},K.textFeatureIndex=ie.featureIndex;break}for(let J=b;J<S;J++){const ie=c.get(J);K.verticalTextBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},K.verticalTextFeatureIndex=ie.featureIndex;break}for(let J=I;J<F;J++){const ie=c.get(J);K.iconBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},K.iconFeatureIndex=ie.featureIndex;break}for(let J=O;J<G;J++){const ie=c.get(J);K.verticalIconBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},K.verticalIconFeatureIndex=ie.featureIndex;break}return K}deserializeCollisionBoxes(c){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const p=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(c,h){const p=c.placedSymbolArray.get(h),b=p.vertexStartIndex+4*p.numGlyphs;for(let S=p.vertexStartIndex;S<b;S+=4)c.indexArray.emplaceBack(S,S+1,S+2),c.indexArray.emplaceBack(S+1,S+2,S+3)}getSortedSymbolIndexes(c){if(this.sortedAngle===c&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(c),p=Math.cos(c),b=[],S=[],I=[];for(let F=0;F<this.symbolInstances.length;++F){I.push(F);const O=this.symbolInstances.get(F);b.push(0|Math.round(h*O.anchorX+p*O.anchorY)),S.push(O.featureIndex)}return I.sort((F,O)=>b[F]-b[O]||S[O]-S[F]),I}addToSortKeyRanges(c,h){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===h?p.symbolInstanceEnd=c+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:c,symbolInstanceEnd:c+1})}sortFeatures(c){if(this.sortFeaturesByY&&this.sortedAngle!==c&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(c),this.sortedAngle=c,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const p=this.symbolInstances.get(h);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach((b,S,I)=>{b>=0&&I.indexOf(b)===S&&this.addIndicesForPlacedSymbol(this.text,b)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let V6,j6;er("SymbolBucket",vp,{omit:["layers","collisionBoxArray","features","compareText"]}),vp.MAX_GLYPHS=65535,vp.addDynamicAttributes=xE;var EE={get paint(){return j6=j6||new $i({"icon-opacity":new wr(Ye.paint_symbol["icon-opacity"]),"icon-color":new wr(Ye.paint_symbol["icon-color"]),"icon-halo-color":new wr(Ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new wr(Ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new wr(Ye.paint_symbol["icon-halo-blur"]),"icon-translate":new dr(Ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new dr(Ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new wr(Ye.paint_symbol["text-opacity"]),"text-color":new wr(Ye.paint_symbol["text-color"],{runtimeType:Yr,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new wr(Ye.paint_symbol["text-halo-color"]),"text-halo-width":new wr(Ye.paint_symbol["text-halo-width"]),"text-halo-blur":new wr(Ye.paint_symbol["text-halo-blur"]),"text-translate":new dr(Ye.paint_symbol["text-translate"]),"text-translate-anchor":new dr(Ye.paint_symbol["text-translate-anchor"])})},get layout(){return V6=V6||new $i({"symbol-placement":new dr(Ye.layout_symbol["symbol-placement"]),"symbol-spacing":new dr(Ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new dr(Ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new wr(Ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new dr(Ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new dr(Ye.layout_symbol["icon-allow-overlap"]),"icon-overlap":new dr(Ye.layout_symbol["icon-overlap"]),"icon-ignore-placement":new dr(Ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new dr(Ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new dr(Ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new wr(Ye.layout_symbol["icon-size"]),"icon-text-fit":new dr(Ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new dr(Ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new wr(Ye.layout_symbol["icon-image"]),"icon-rotate":new wr(Ye.layout_symbol["icon-rotate"]),"icon-padding":new wr(Ye.layout_symbol["icon-padding"]),"icon-keep-upright":new dr(Ye.layout_symbol["icon-keep-upright"]),"icon-offset":new wr(Ye.layout_symbol["icon-offset"]),"icon-anchor":new wr(Ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new dr(Ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new dr(Ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new dr(Ye.layout_symbol["text-rotation-alignment"]),"text-field":new wr(Ye.layout_symbol["text-field"]),"text-font":new wr(Ye.layout_symbol["text-font"]),"text-size":new wr(Ye.layout_symbol["text-size"]),"text-max-width":new wr(Ye.layout_symbol["text-max-width"]),"text-line-height":new dr(Ye.layout_symbol["text-line-height"]),"text-letter-spacing":new wr(Ye.layout_symbol["text-letter-spacing"]),"text-justify":new wr(Ye.layout_symbol["text-justify"]),"text-radial-offset":new wr(Ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new dr(Ye.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new wr(Ye.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new wr(Ye.layout_symbol["text-anchor"]),"text-max-angle":new dr(Ye.layout_symbol["text-max-angle"]),"text-writing-mode":new dr(Ye.layout_symbol["text-writing-mode"]),"text-rotate":new wr(Ye.layout_symbol["text-rotate"]),"text-padding":new dr(Ye.layout_symbol["text-padding"]),"text-keep-upright":new dr(Ye.layout_symbol["text-keep-upright"]),"text-transform":new wr(Ye.layout_symbol["text-transform"]),"text-offset":new wr(Ye.layout_symbol["text-offset"]),"text-allow-overlap":new dr(Ye.layout_symbol["text-allow-overlap"]),"text-overlap":new dr(Ye.layout_symbol["text-overlap"]),"text-ignore-placement":new dr(Ye.layout_symbol["text-ignore-placement"]),"text-optional":new dr(Ye.layout_symbol["text-optional"])})}};class q6{constructor(c){if(c.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=c.property.overrides?c.property.overrides.runtimeType:Mr,this.defaultValue=c}evaluate(c){if(c.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(c.formattedSection))return h.getOverride(c.formattedSection)}return c.feature&&c.featureState?this.defaultValue.evaluate(c.feature,c.featureState):this.defaultValue.property.specification.default}eachChild(c){this.defaultValue.isConstant()||c(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}er("FormatSectionOverride",q6,{omit:["defaultValue"]});class M_ extends Zo{constructor(c){super(c,EE)}recalculate(c,h){if(super.recalculate(c,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const b=[];for(const S of p)b.indexOf(S)<0&&b.push(S);this.layout._values["text-writing-mode"]=b}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(c,h,p,b){const S=this.layout.get(c).evaluate(h,{},p,b),I=this._unevaluatedLayout._values[c];return I.isDataDriven()||Xr(I.value)||!S?S:function(F,O){return O.replace(/{([^{}]+)}/g,(G,K)=>F&&K in F?String(F[K]):"")}(h.properties,S)}createBucket(c){return new vp(c)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const c of EE.paint.overridableProperties){if(!M_.hasPaintOverride(this.layout,c))continue;const h=this.paint.get(c),p=new q6(h),b=new Kr(p,h.property.specification);let S=null;S=h.value.kind==="constant"||h.value.kind==="source"?new ks("source",b):new Ns("composite",b,h.value.zoomStops),this.paint._values[c]=new Yo(h.property,S,h.parameters)}}_handleOverridablePaintPropertyUpdate(c,h,p){return!(!this.layout||h.isDataDriven()||p.isDataDriven())&&M_.hasPaintOverride(this.layout,c)}static hasPaintOverride(c,h){const p=c.get("text-field"),b=EE.paint.properties[h];let S=!1;const I=F=>{for(const O of F)if(b.overrides&&b.overrides.hasOverride(O))return void(S=!0)};if(p.value.kind==="constant"&&p.value.value instanceof _n)I(p.value.value.sections);else if(p.value.kind==="source"){const F=G=>{S||(G instanceof Cs&&Dr(G.value)===Wr?I(G.value.sections):G instanceof vc?I(G.sections):G.eachChild(F))},O=p.value;O._styleExpression&&F(O._styleExpression.expression)}return S}}let K6;var W_e={get paint(){return K6=K6||new $i({"background-color":new dr(Ye.paint_background["background-color"]),"background-pattern":new Bl(Ye.paint_background["background-pattern"]),"background-opacity":new dr(Ye.paint_background["background-opacity"])})}};class $_e extends Zo{constructor(c){super(c,W_e)}}let W6;var X_e={get paint(){return W6=W6||new $i({"raster-opacity":new dr(Ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new dr(Ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new dr(Ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new dr(Ye.paint_raster["raster-brightness-max"]),"raster-saturation":new dr(Ye.paint_raster["raster-saturation"]),"raster-contrast":new dr(Ye.paint_raster["raster-contrast"]),"raster-resampling":new dr(Ye.paint_raster["raster-resampling"]),"raster-fade-duration":new dr(Ye.paint_raster["raster-fade-duration"])})}};class J_e extends Zo{constructor(c){super(c,X_e)}}class Y_e extends Zo{constructor(c){super(c,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=c}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Z_e{constructor(c){this._methodToThrottle=c,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const SE=63710088e-1;class _h{constructor(c,h){if(isNaN(c)||isNaN(h))throw new Error(`Invalid LngLat object: (${c}, ${h})`);if(this.lng=+c,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new _h(ge(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(c){const h=Math.PI/180,p=this.lat*h,b=c.lat*h,S=Math.sin(p)*Math.sin(b)+Math.cos(p)*Math.cos(b)*Math.cos((c.lng-this.lng)*h);return SE*Math.acos(Math.min(S,1))}static convert(c){if(c instanceof _h)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new _h(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&typeof c=="object"&&c!==null)return new _h(Number("lng"in c?c.lng:c.lon),Number(c.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const $6=2*Math.PI*SE;function X6(u){return $6*Math.cos(u*Math.PI/180)}function J6(u){return(180+u)/360}function Y6(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function Z6(u,c){return u/X6(c)}function TE(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}class P_{constructor(c,h){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;this.x=+c,this.y=+h,this.z=+p}static fromLngLat(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const p=_h.convert(c);return new P_(J6(p.lng),Y6(p.lat),Z6(h,p.lat))}toLngLat(){return new _h(360*this.x-180,TE(this.y))}toAltitude(){return this.z*X6(TE(this.y))}meterInMercatorCoordinateUnits(){return 1/$6*(c=TE(this.y),1/Math.cos(c*Math.PI/180));var c}}function ek(u,c,h){var p=2*Math.PI*6378137/256/Math.pow(2,h);return[u*p-2*Math.PI*6378137/2,c*p-2*Math.PI*6378137/2]}class IE{constructor(c,h,p){if(c<0||c>25||p<0||p>=Math.pow(2,c)||h<0||h>=Math.pow(2,c))throw new Error(`x=${h}, y=${p}, z=${c} outside of bounds. 0<=x<${Math.pow(2,c)}, 0<=y<${Math.pow(2,c)} 0<=z<=25 `);this.z=c,this.x=h,this.y=p,this.key=Om(0,c,c,h,p)}equals(c){return this.z===c.z&&this.x===c.x&&this.y===c.y}url(c,h,p){const b=(I=this.y,F=this.z,O=ek(256*(S=this.x),256*(I=Math.pow(2,F)-I-1),F),G=ek(256*(S+1),256*(I+1),F),O[0]+","+O[1]+","+G[0]+","+G[1]);var S,I,F,O,G;const K=function(J,ie,ce){let Ae,Ce="";for(let Le=J;Le>0;Le--)Ae=1<<Le-1,Ce+=(ie&Ae?1:0)+(ce&Ae?2:0);return Ce}(this.z,this.x,this.y);return c[(this.x+this.y)%c.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,K).replace(/{bbox-epsg-3857}/g,b)}isChildOf(c){const h=this.z-c.z;return h>0&&c.x===this.x>>h&&c.y===this.y>>h}getTilePoint(c){const h=Math.pow(2,this.z);return new v((c.x*h-this.x)*Rn,(c.y*h-this.y)*Rn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class tk{constructor(c,h){this.wrap=c,this.canonical=h,this.key=Om(c,h.z,h.z,h.x,h.y)}}class Xa{constructor(c,h,p,b,S){if(c<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${c}; z = ${p}`);this.overscaledZ=c,this.wrap=h,this.canonical=new IE(p,+b,+S),this.key=Om(h,c,p,b,S)}clone(){return new Xa(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(c){return this.overscaledZ===c.overscaledZ&&this.wrap===c.wrap&&this.canonical.equals(c.canonical)}scaledTo(c){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-c;return c>this.canonical.z?new Xa(c,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Xa(c,this.wrap,c,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(c,h){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-c;return c>this.canonical.z?Om(this.wrap*+h,c,this.canonical.z,this.canonical.x,this.canonical.y):Om(this.wrap*+h,c,c,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(c){if(c.wrap!==this.wrap)return!1;const h=this.canonical.z-c.canonical.z;return c.overscaledZ===0||c.overscaledZ<this.overscaledZ&&c.canonical.x===this.canonical.x>>h&&c.canonical.y===this.canonical.y>>h}children(c){if(this.overscaledZ>=c)return[new Xa(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,p=2*this.canonical.x,b=2*this.canonical.y;return[new Xa(h,this.wrap,h,p,b),new Xa(h,this.wrap,h,p+1,b),new Xa(h,this.wrap,h,p,b+1),new Xa(h,this.wrap,h,p+1,b+1)]}isLessThan(c){return this.wrap<c.wrap||!(this.wrap>c.wrap)&&(this.overscaledZ<c.overscaledZ||!(this.overscaledZ>c.overscaledZ)&&(this.canonical.x<c.canonical.x||!(this.canonical.x>c.canonical.x)&&this.canonical.y<c.canonical.y))}wrapped(){return new Xa(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(c){return new Xa(this.overscaledZ,c,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new tk(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(c){return this.canonical.getTilePoint(new P_(c.x-this.wrap,c.y))}}function Om(u,c,h,p,b){(u*=2)<0&&(u=-1*u-1);const S=1<<h;return(S*S*u+S*b+p).toString(36)+h.toString(36)+c.toString(36)}er("CanonicalTileID",IE),er("OverscaledTileID",Xa,{omit:["posMatrix"]});class rk{constructor(c,h,p){let b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,I=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1,F=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0;if(this.uid=c,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(p&&!["mapbox","terrarium","custom"].includes(p))return void xe(`"${p}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;const O=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),p){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=b,this.greenFactor=S,this.blueFactor=I,this.baseShift=F;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let G=0;G<O;G++)this.data[this._idx(-1,G)]=this.data[this._idx(0,G)],this.data[this._idx(O,G)]=this.data[this._idx(O-1,G)],this.data[this._idx(G,-1)]=this.data[this._idx(G,0)],this.data[this._idx(G,O)]=this.data[this._idx(G,O-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(O,-1)]=this.data[this._idx(O-1,0)],this.data[this._idx(-1,O)]=this.data[this._idx(0,O-1)],this.data[this._idx(O,O)]=this.data[this._idx(O-1,O-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let G=0;G<O;G++)for(let K=0;K<O;K++){const J=this.get(G,K);J>this.max&&(this.max=J),J<this.min&&(this.min=J)}}get(c,h){const p=new Uint8Array(this.data.buffer),b=4*this._idx(c,h);return this.unpack(p[b],p[b+1],p[b+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(c,h){if(c<-1||c>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(c+1)}unpack(c,h,p){return c*this.redFactor+h*this.greenFactor+p*this.blueFactor-this.baseShift}getPixels(){return new ra({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(c,h,p){if(this.dim!==c.dim)throw new Error("dem dimension mismatch");let b=h*this.dim,S=h*this.dim+this.dim,I=p*this.dim,F=p*this.dim+this.dim;switch(h){case-1:b=S-1;break;case 1:S=b+1}switch(p){case-1:I=F-1;break;case 1:F=I+1}const O=-h*this.dim,G=-p*this.dim;for(let K=I;K<F;K++)for(let J=b;J<S;J++)this.data[this._idx(J,K)]=c.data[this._idx(J+O,K+G)]}}er("DEMData",rk);class nk{constructor(c){this._stringToNumber={},this._numberToString=[];for(let h=0;h<c.length;h++){const p=c[h];this._stringToNumber[p]=h,this._numberToString[h]=p}}encode(c){return this._stringToNumber[c]}decode(c){if(c>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${c} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[c]}}class ik{constructor(c,h,p,b,S){this.type="Feature",this._vectorTileFeature=c,c._z=h,c._x=p,c._y=b,this.properties=c.properties,this.id=S}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(c){this._geometry=c}toJSON(){const c={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(c[h]=this[h]);return c}}class sk{constructor(c,h){this.tileID=c,this.x=c.canonical.x,this.y=c.canonical.y,this.z=c.canonical.z,this.grid=new hu(Rn,16,0),this.grid3D=new hu(Rn,16,0),this.featureIndexArray=new T,this.promoteId=h}insert(c,h,p,b,S,I){const F=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,b,S);const O=I?this.grid3D:this.grid;for(let G=0;G<h.length;G++){const K=h[G],J=[1/0,1/0,-1/0,-1/0];for(let ie=0;ie<K.length;ie++){const ce=K[ie];J[0]=Math.min(J[0],ce.x),J[1]=Math.min(J[1],ce.y),J[2]=Math.max(J[2],ce.x),J[3]=Math.max(J[3],ce.y)}J[0]<Rn&&J[1]<Rn&&J[2]>=0&&J[3]>=0&&O.insert(F,J[0],J[1],J[2],J[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new gh.VectorTile(new mE(this.rawTileData)).layers,this.sourceLayerCoder=new nk(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(c,h,p,b){this.loadVTLayers();const S=c.params||{},I=Rn/c.tileSize/c.scale,F=Bc(S.filter),O=c.queryGeometry,G=c.queryPadding*I,K=ak(O),J=this.grid.query(K.minX-G,K.minY-G,K.maxX+G,K.maxY+G),ie=ak(c.cameraQueryGeometry),ce=this.grid3D.query(ie.minX-G,ie.minY-G,ie.maxX+G,ie.maxY+G,(Le,Ne,rt,ze)=>function(We,bt,wt,Zt,hr){for(const Wt of We)if(bt<=Wt.x&&wt<=Wt.y&&Zt>=Wt.x&&hr>=Wt.y)return!0;const Xt=[new v(bt,wt),new v(bt,hr),new v(Zt,hr),new v(Zt,wt)];if(We.length>2){for(const Wt of Xt)if(Tl(We,Wt))return!0}for(let Wt=0;Wt<We.length-1;Wt++)if(xd(We[Wt],We[Wt+1],Xt))return!0;return!1}(c.cameraQueryGeometry,Le-G,Ne-G,rt+G,ze+G));for(const Le of ce)J.push(Le);J.sort(eve);const Ae={};let Ce;for(let Le=0;Le<J.length;Le++){const Ne=J[Le];if(Ne===Ce)continue;Ce=Ne;const rt=this.featureIndexArray.get(Ne);let ze=null;this.loadMatchingFeature(Ae,rt.bucketIndex,rt.sourceLayerIndex,rt.featureIndex,F,S.layers,S.availableImages,h,p,b,(We,bt,wt)=>(ze||(ze=Ic(We)),bt.queryIntersectsFeature(O,We,wt,ze,this.z,c.transform,I,c.pixelPosMatrix)))}return Ae}loadMatchingFeature(c,h,p,b,S,I,F,O,G,K,J){const ie=this.bucketLayerIDs[h];if(I&&!function(Le,Ne){for(let rt=0;rt<Le.length;rt++)if(Ne.indexOf(Le[rt])>=0)return!0;return!1}(I,ie))return;const ce=this.sourceLayerCoder.decode(p),Ae=this.vtLayers[ce].feature(b);if(S.needGeometry){const Le=Lc(Ae,!0);if(!S.filter(new zn(this.tileID.overscaledZ),Le,this.tileID.canonical))return}else if(!S.filter(new zn(this.tileID.overscaledZ),Ae))return;const Ce=this.getId(Ae,ce);for(let Le=0;Le<ie.length;Le++){const Ne=ie[Le];if(I&&I.indexOf(Ne)<0)continue;const rt=O[Ne];if(!rt)continue;let ze={};Ce&&K&&(ze=K.getState(rt.sourceLayer||"_geojsonTileLayer",Ce));const We=ye({},G[Ne]);We.paint=ok(We.paint,rt.paint,Ae,ze,F),We.layout=ok(We.layout,rt.layout,Ae,ze,F);const bt=!J||J(Ae,rt,ze);if(!bt)continue;const wt=new ik(Ae,this.z,this.x,this.y,Ce);wt.layer=We;let Zt=c[Ne];Zt===void 0&&(Zt=c[Ne]=[]),Zt.push({featureIndex:b,feature:wt,intersectionZ:bt})}}lookupSymbolFeatures(c,h,p,b,S,I,F,O){const G={};this.loadVTLayers();const K=Bc(S);for(const J of c)this.loadMatchingFeature(G,p,b,J,K,I,F,O,h);return G}hasLayer(c){for(const h of this.bucketLayerIDs)for(const p of h)if(c===p)return!0;return!1}getId(c,h){let p=c.id;return this.promoteId&&(p=c.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof p=="boolean"&&(p=Number(p))),p}}function ok(u,c,h,p,b){return Oe(u,(S,I)=>{const F=c instanceof sA?c.get(I):null;return F&&F.evaluate?F.evaluate(h,p,b):F})}function ak(u){let c=1/0,h=1/0,p=-1/0,b=-1/0;for(const S of u)c=Math.min(c,S.x),h=Math.min(h,S.y),p=Math.max(p,S.x),b=Math.max(b,S.y);return{minX:c,minY:h,maxX:p,maxY:b}}function eve(u,c){return c-u}function ck(u,c,h,p,b){const S=[];for(let I=0;I<u.length;I++){const F=u[I];let O;for(let G=0;G<F.length-1;G++){let K=F[G],J=F[G+1];K.x<c&&J.x<c||(K.x<c?K=new v(c,K.y+(c-K.x)/(J.x-K.x)*(J.y-K.y))._round():J.x<c&&(J=new v(c,K.y+(c-K.x)/(J.x-K.x)*(J.y-K.y))._round()),K.y<h&&J.y<h||(K.y<h?K=new v(K.x+(h-K.y)/(J.y-K.y)*(J.x-K.x),h)._round():J.y<h&&(J=new v(K.x+(h-K.y)/(J.y-K.y)*(J.x-K.x),h)._round()),K.x>=p&&J.x>=p||(K.x>=p?K=new v(p,K.y+(p-K.x)/(J.x-K.x)*(J.y-K.y))._round():J.x>=p&&(J=new v(p,K.y+(p-K.x)/(J.x-K.x)*(J.y-K.y))._round()),K.y>=b&&J.y>=b||(K.y>=b?K=new v(K.x+(b-K.y)/(J.y-K.y)*(J.x-K.x),b)._round():J.y>=b&&(J=new v(K.x+(b-K.y)/(J.y-K.y)*(J.x-K.x),b)._round()),O&&K.equals(O[O.length-1])||(O=[K],S.push(O)),O.push(J)))))}}return S}er("FeatureIndex",sk,{omit:["rawTileData","sourceLayerCoder"]});class vh extends v{constructor(c,h,p,b){super(c,h),this.angle=p,b!==void 0&&(this.segment=b)}clone(){return new vh(this.x,this.y,this.angle,this.segment)}}function lk(u,c,h,p,b){if(c.segment===void 0||h===0)return!0;let S=c,I=c.segment+1,F=0;for(;F>-h/2;){if(I--,I<0)return!1;F-=u[I].dist(S),S=u[I]}F+=u[I].dist(u[I+1]),I++;const O=[];let G=0;for(;F<h/2;){const K=u[I],J=u[I+1];if(!J)return!1;let ie=u[I-1].angleTo(K)-K.angleTo(J);for(ie=Math.abs((ie+3*Math.PI)%(2*Math.PI)-Math.PI),O.push({distance:F,angleDelta:ie}),G+=ie;F-O[0].distance>p;)G-=O.shift().angleDelta;if(G>b)return!1;I++,F+=K.dist(J)}return!0}function uk(u){let c=0;for(let h=0;h<u.length-1;h++)c+=u[h].dist(u[h+1]);return c}function Ak(u,c,h){return u?.6*c*h:0}function hk(u,c){return Math.max(u?u.right-u.left:0,c?c.right-c.left:0)}function tve(u,c,h,p,b,S){const I=Ak(h,b,S),F=hk(h,p)*S;let O=0;const G=uk(u)/2;for(let K=0;K<u.length-1;K++){const J=u[K],ie=u[K+1],ce=J.dist(ie);if(O+ce>G){const Ae=(G-O)/ce,Ce=Ri.number(J.x,ie.x,Ae),Le=Ri.number(J.y,ie.y,Ae),Ne=new vh(Ce,Le,ie.angleTo(J),K);return Ne._round(),!I||lk(u,Ne,F,I,c)?Ne:void 0}O+=ce}}function rve(u,c,h,p,b,S,I,F,O){const G=Ak(p,S,I),K=hk(p,b),J=K*I,ie=u[0].x===0||u[0].x===O||u[0].y===0||u[0].y===O;return c-J<c/4&&(c=J+c/4),dk(u,ie?c/2*F%c:(K/2+2*S)*I*F%c,c,G,h,J,ie,!1,O)}function dk(u,c,h,p,b,S,I,F,O){const G=S/2,K=uk(u);let J=0,ie=c-h,ce=[];for(let Ae=0;Ae<u.length-1;Ae++){const Ce=u[Ae],Le=u[Ae+1],Ne=Ce.dist(Le),rt=Le.angleTo(Ce);for(;ie+h<J+Ne;){ie+=h;const ze=(ie-J)/Ne,We=Ri.number(Ce.x,Le.x,ze),bt=Ri.number(Ce.y,Le.y,ze);if(We>=0&&We<O&&bt>=0&&bt<O&&ie-G>=0&&ie+G<=K){const wt=new vh(We,bt,rt,Ae);wt._round(),p&&!lk(u,wt,S,p,b)||ce.push(wt)}}J+=Ne}return F||ce.length||I||(ce=dk(u,J/2,h,p,b,S,I,!0,O)),ce}er("Anchor",vh);const bp=na;function fk(u,c,h,p){const b=[],S=u.image,I=S.pixelRatio,F=S.paddedRect.w-2*bp,O=S.paddedRect.h-2*bp,G=u.right-u.left,K=u.bottom-u.top,J=S.stretchX||[[0,F]],ie=S.stretchY||[[0,O]],ce=(Nt,or)=>Nt+or[1]-or[0],Ae=J.reduce(ce,0),Ce=ie.reduce(ce,0),Le=F-Ae,Ne=O-Ce;let rt=0,ze=Ae,We=0,bt=Ce,wt=0,Zt=Le,hr=0,Xt=Ne;if(S.content&&p){const Nt=S.content;rt=U_(J,0,Nt[0]),We=U_(ie,0,Nt[1]),ze=U_(J,Nt[0],Nt[2]),bt=U_(ie,Nt[1],Nt[3]),wt=Nt[0]-rt,hr=Nt[1]-We,Zt=Nt[2]-Nt[0]-ze,Xt=Nt[3]-Nt[1]-bt}const Wt=(Nt,or,jt,Ft)=>{const Cr=R_(Nt.stretch-rt,ze,G,u.left),pr=O_(Nt.fixed-wt,Zt,Nt.stretch,Ae),tn=R_(or.stretch-We,bt,K,u.top),ai=O_(or.fixed-hr,Xt,or.stretch,Ce),fi=R_(jt.stretch-rt,ze,G,u.left),As=O_(jt.fixed-wt,Zt,jt.stretch,Ae),Ea=R_(Ft.stretch-We,bt,K,u.top),To=O_(Ft.fixed-hr,Xt,Ft.stretch,Ce),Ji=new v(Cr,tn),Ss=new v(fi,tn),Vs=new v(fi,Ea),Io=new v(Cr,Ea),Lo=new v(pr/I,ai/I),hs=new v(As/I,To/I),ds=c*Math.PI/180;if(ds){const io=Math.sin(ds),ia=Math.cos(ds),sa=[ia,-io,io,ia];Ji._matMult(sa),Ss._matMult(sa),Io._matMult(sa),Vs._matMult(sa)}const no=Nt.stretch+Nt.fixed,Fo=or.stretch+or.fixed;return{tl:Ji,tr:Ss,bl:Io,br:Vs,tex:{x:S.paddedRect.x+bp+no,y:S.paddedRect.y+bp+Fo,w:jt.stretch+jt.fixed-no,h:Ft.stretch+Ft.fixed-Fo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Lo,pixelOffsetBR:hs,minFontScaleX:Zt/I/G,minFontScaleY:Xt/I/K,isSDF:h}};if(p&&(S.stretchX||S.stretchY)){const Nt=pk(J,Le,Ae),or=pk(ie,Ne,Ce);for(let jt=0;jt<Nt.length-1;jt++){const Ft=Nt[jt],Cr=Nt[jt+1];for(let pr=0;pr<or.length-1;pr++)b.push(Wt(Ft,or[pr],Cr,or[pr+1]))}}else b.push(Wt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:F+1},{fixed:0,stretch:O+1}));return b}function U_(u,c,h){let p=0;for(const b of u)p+=Math.max(c,Math.min(h,b[1]))-Math.max(c,Math.min(h,b[0]));return p}function pk(u,c,h){const p=[{fixed:-bp,stretch:0}];for(const[b,S]of u){const I=p[p.length-1];p.push({fixed:b-I.stretch,stretch:I.stretch}),p.push({fixed:b-I.stretch,stretch:I.stretch+(S-b)})}return p.push({fixed:c+bp,stretch:h}),p}function R_(u,c,h,p){return u/c*h+p}function O_(u,c,h,p){return u-c*h/p}class D_{constructor(c,h,p,b,S,I,F,O,G,K){if(this.boxStartIndex=c.length,G){let J=I.top,ie=I.bottom;const ce=I.collisionPadding;ce&&(J-=ce[1],ie+=ce[3]);let Ae=ie-J;Ae>0&&(Ae=Math.max(10,Ae),this.circleDiameter=Ae)}else{let J=I.top*F-O[0],ie=I.bottom*F+O[2],ce=I.left*F-O[3],Ae=I.right*F+O[1];const Ce=I.collisionPadding;if(Ce&&(ce-=Ce[0]*F,J-=Ce[1]*F,Ae+=Ce[2]*F,ie+=Ce[3]*F),K){const Le=new v(ce,J),Ne=new v(Ae,J),rt=new v(ce,ie),ze=new v(Ae,ie),We=K*Math.PI/180;Le._rotate(We),Ne._rotate(We),rt._rotate(We),ze._rotate(We),ce=Math.min(Le.x,Ne.x,rt.x,ze.x),Ae=Math.max(Le.x,Ne.x,rt.x,ze.x),J=Math.min(Le.y,Ne.y,rt.y,ze.y),ie=Math.max(Le.y,Ne.y,rt.y,ze.y)}c.emplaceBack(h.x,h.y,ce,J,Ae,ie,p,b,S)}this.boxEndIndex=c.length}}class nve{constructor(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ive;if(this.data=c,this.length=this.data.length,this.compare=h,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(c){this.data.push(c),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const c=this.data[0],h=this.data.pop();return this.length--,this.length>0&&(this.data[0]=h,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:h,compare:p}=this,b=h[c];for(;c>0;){const S=c-1>>1,I=h[S];if(p(b,I)>=0)break;h[c]=I,c=S}h[c]=b}_down(c){const{data:h,compare:p}=this,b=this.length>>1,S=h[c];for(;c<b;){let I=1+(c<<1),F=h[I];const O=I+1;if(O<this.length&&p(h[O],F)<0&&(I=O,F=h[O]),p(F,S)>=0)break;h[c]=F,c=I}h[c]=S}}function ive(u,c){return u<c?-1:u>c?1:0}function sve(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,p=1/0,b=1/0,S=-1/0,I=-1/0;const F=u[0];for(let ce=0;ce<F.length;ce++){const Ae=F[ce];(!ce||Ae.x<p)&&(p=Ae.x),(!ce||Ae.y<b)&&(b=Ae.y),(!ce||Ae.x>S)&&(S=Ae.x),(!ce||Ae.y>I)&&(I=Ae.y)}const O=Math.min(S-p,I-b);let G=O/2;const K=new nve([],ove);if(O===0)return new v(p,b);for(let ce=p;ce<S;ce+=O)for(let Ae=b;Ae<I;Ae+=O)K.push(new wp(ce+G,Ae+G,G,u));let J=function(ce){let Ae=0,Ce=0,Le=0;const Ne=ce[0];for(let rt=0,ze=Ne.length,We=ze-1;rt<ze;We=rt++){const bt=Ne[rt],wt=Ne[We],Zt=bt.x*wt.y-wt.x*bt.y;Ce+=(bt.x+wt.x)*Zt,Le+=(bt.y+wt.y)*Zt,Ae+=3*Zt}return new wp(Ce/Ae,Le/Ae,0,ce)}(u),ie=K.length;for(;K.length;){const ce=K.pop();(ce.d>J.d||!J.d)&&(J=ce,h&&console.log("found best %d after %d probes",Math.round(1e4*ce.d)/1e4,ie)),ce.max-J.d<=c||(G=ce.h/2,K.push(new wp(ce.p.x-G,ce.p.y-G,G,u)),K.push(new wp(ce.p.x+G,ce.p.y-G,G,u)),K.push(new wp(ce.p.x-G,ce.p.y+G,G,u)),K.push(new wp(ce.p.x+G,ce.p.y+G,G,u)),ie+=4)}return h&&(console.log(`num probes: ${ie}`),console.log(`best distance: ${J.d}`)),J.p}function ove(u,c){return c.max-u.max}function wp(u,c,h,p){this.p=new v(u,c),this.h=h,this.d=function(b,S){let I=!1,F=1/0;for(let O=0;O<S.length;O++){const G=S[O];for(let K=0,J=G.length,ie=J-1;K<J;ie=K++){const ce=G[K],Ae=G[ie];ce.y>b.y!=Ae.y>b.y&&b.x<(Ae.x-ce.x)*(b.y-ce.y)/(Ae.y-ce.y)+ce.x&&(I=!I),F=Math.min(F,wd(b,ce,Ae))}}return(I?1:-1)*Math.sqrt(F)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}var Gs;a.ap=void 0,(Gs=a.ap||(a.ap={}))[Gs.center=1]="center",Gs[Gs.left=2]="left",Gs[Gs.right=3]="right",Gs[Gs.top=4]="top",Gs[Gs.bottom=5]="bottom",Gs[Gs["top-left"]=6]="top-left",Gs[Gs["top-right"]=7]="top-right",Gs[Gs["bottom-left"]=8]="bottom-left",Gs[Gs["bottom-right"]=9]="bottom-right";const bh=7,LE=Number.POSITIVE_INFINITY;function gk(u,c){return c[1]!==LE?function(h,p,b){let S=0,I=0;switch(p=Math.abs(p),b=Math.abs(b),h){case"top-right":case"top-left":case"top":I=b-bh;break;case"bottom-right":case"bottom-left":case"bottom":I=-b+bh}switch(h){case"top-right":case"bottom-right":case"right":S=-p;break;case"top-left":case"bottom-left":case"left":S=p}return[S,I]}(u,c[0],c[1]):function(h,p){let b=0,S=0;p<0&&(p=0);const I=p/Math.SQRT2;switch(h){case"top-right":case"top-left":S=I-bh;break;case"bottom-right":case"bottom-left":S=-I+bh;break;case"bottom":S=-p+bh;break;case"top":S=p-bh}switch(h){case"top-right":case"bottom-right":b=-I;break;case"top-left":case"bottom-left":b=I;break;case"left":b=p;break;case"right":b=-p}return[b,S]}(u,c[0])}function mk(u,c,h){var p;const b=u.layout,S=(p=b.get("text-variable-anchor-offset"))===null||p===void 0?void 0:p.evaluate(c,{},h);if(S){const F=S.values,O=[];for(let G=0;G<F.length;G+=2){const K=O[G]=F[G],J=F[G+1].map(ie=>ie*us);K.startsWith("top")?J[1]-=bh:K.startsWith("bottom")&&(J[1]+=bh),O[G+1]=J}return new Jn(O)}const I=b.get("text-variable-anchor");if(I){let F;F=u._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[b.get("text-radial-offset").evaluate(c,{},h)*us,LE]:b.get("text-offset").evaluate(c,{},h).map(G=>G*us);const O=[];for(const G of I)O.push(G,gk(G,F));return new Jn(O)}return null}function FE(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ave(u,c,h,p,b,S,I,F,O,G,K){let J=S.textMaxSize.evaluate(c,{});J===void 0&&(J=I);const ie=u.layers[0].layout,ce=ie.get("icon-offset").evaluate(c,{},K),Ae=_k(h.horizontal),Ce=I/24,Le=u.tilePixelRatio*Ce,Ne=u.tilePixelRatio*J/24,rt=u.tilePixelRatio*F,ze=u.tilePixelRatio*ie.get("symbol-spacing"),We=ie.get("text-padding")*u.tilePixelRatio,bt=function(Ft,Cr,pr){let tn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const ai=Ft.get("icon-padding").evaluate(Cr,{},pr),fi=ai&&ai.values;return[fi[0]*tn,fi[1]*tn,fi[2]*tn,fi[3]*tn]}(ie,c,K,u.tilePixelRatio),wt=ie.get("text-max-angle")/180*Math.PI,Zt=ie.get("text-rotation-alignment")!=="viewport"&&ie.get("symbol-placement")!=="point",hr=ie.get("icon-rotation-alignment")==="map"&&ie.get("symbol-placement")!=="point",Xt=ie.get("symbol-placement"),Wt=ze/2,Nt=ie.get("icon-text-fit");let or;p&&Nt!=="none"&&(u.allowVerticalPlacement&&h.vertical&&(or=z6(p,h.vertical,Nt,ie.get("icon-text-fit-padding"),ce,Ce)),Ae&&(p=z6(p,Ae,Nt,ie.get("icon-text-fit-padding"),ce,Ce)));const jt=(Ft,Cr)=>{Cr.x<0||Cr.x>=Rn||Cr.y<0||Cr.y>=Rn||function(pr,tn,ai,fi,As,Ea,To,Ji,Ss,Vs,Io,Lo,hs,ds,no,Fo,io,ia,sa,fs,An,so,js,ps,Pc){const Fl=pr.addToLineVertexArray(tn,ai);let Ml,gA,Uc,Ja,oa=0,mA=0,Nm=0,xk=0,NE=-1,QE=-1;const yA={};let Bk=Sr("");if(pr.allowVerticalPlacement&&fi.vertical){const oo=Ji.layout.get("text-rotate").evaluate(An,{},ps)+90;Uc=new D_(Ss,tn,Vs,Io,Lo,fi.vertical,hs,ds,no,oo),To&&(Ja=new D_(Ss,tn,Vs,Io,Lo,To,io,ia,no,oo))}if(As){const oo=Ji.layout.get("icon-rotate").evaluate(An,{}),Ya=Ji.layout.get("icon-text-fit")!=="none",Id=fk(As,oo,js,Ya),Ul=To?fk(To,oo,js,Ya):void 0;gA=new D_(Ss,tn,Vs,Io,Lo,As,io,ia,!1,oo),oa=4*Id.length;const Ld=pr.iconSizeData;let _u=null;Ld.kind==="source"?(_u=[yu*Ji.layout.get("icon-size").evaluate(An,{})],_u[0]>yh&&xe(`${pr.layerIds[0]}: Value for "icon-size" is >= ${Rm}. Reduce your "icon-size".`)):Ld.kind==="composite"&&(_u=[yu*so.compositeIconSizes[0].evaluate(An,{},ps),yu*so.compositeIconSizes[1].evaluate(An,{},ps)],(_u[0]>yh||_u[1]>yh)&&xe(`${pr.layerIds[0]}: Value for "icon-size" is >= ${Rm}. Reduce your "icon-size".`)),pr.addSymbols(pr.icon,Id,_u,fs,sa,An,a.ah.none,tn,Fl.lineStartIndex,Fl.lineLength,-1,ps),NE=pr.icon.placedSymbolArray.length-1,Ul&&(mA=4*Ul.length,pr.addSymbols(pr.icon,Ul,_u,fs,sa,An,a.ah.vertical,tn,Fl.lineStartIndex,Fl.lineLength,-1,ps),QE=pr.icon.placedSymbolArray.length-1)}const Ck=Object.keys(fi.horizontal);for(const oo of Ck){const Ya=fi.horizontal[oo];if(!Ml){Bk=Sr(Ya.text);const Ul=Ji.layout.get("text-rotate").evaluate(An,{},ps);Ml=new D_(Ss,tn,Vs,Io,Lo,Ya,hs,ds,no,Ul)}const Id=Ya.positionedLines.length===1;if(Nm+=yk(pr,tn,Ya,Ea,Ji,no,An,Fo,Fl,fi.vertical?a.ah.horizontal:a.ah.horizontalOnly,Id?Ck:[oo],yA,NE,so,ps),Id)break}fi.vertical&&(xk+=yk(pr,tn,fi.vertical,Ea,Ji,no,An,Fo,Fl,a.ah.vertical,["vertical"],yA,QE,so,ps));const uve=Ml?Ml.boxStartIndex:pr.collisionBoxArray.length,Ave=Ml?Ml.boxEndIndex:pr.collisionBoxArray.length,hve=Uc?Uc.boxStartIndex:pr.collisionBoxArray.length,dve=Uc?Uc.boxEndIndex:pr.collisionBoxArray.length,fve=gA?gA.boxStartIndex:pr.collisionBoxArray.length,pve=gA?gA.boxEndIndex:pr.collisionBoxArray.length,gve=Ja?Ja.boxStartIndex:pr.collisionBoxArray.length,mve=Ja?Ja.boxEndIndex:pr.collisionBoxArray.length;let Pl=-1;const N_=(oo,Ya)=>oo&&oo.circleDiameter?Math.max(oo.circleDiameter,Ya):Ya;Pl=N_(Ml,Pl),Pl=N_(Uc,Pl),Pl=N_(gA,Pl),Pl=N_(Ja,Pl);const Ek=Pl>-1?1:0;Ek&&(Pl*=Pc/us),pr.glyphOffsetArray.length>=vp.MAX_GLYPHS&&xe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),An.sortKey!==void 0&&pr.addToSortKeyRanges(pr.symbolInstances.length,An.sortKey);const yve=mk(Ji,An,ps),[_ve,vve]=function(oo,Ya){const Id=oo.length,Ul=Ya==null?void 0:Ya.values;if((Ul==null?void 0:Ul.length)>0)for(let Ld=0;Ld<Ul.length;Ld+=2){const _u=Ul[Ld+1];oo.emplaceBack(a.ap[Ul[Ld]],_u[0],_u[1])}return[Id,oo.length]}(pr.textAnchorOffsets,yve);pr.symbolInstances.emplaceBack(tn.x,tn.y,yA.right>=0?yA.right:-1,yA.center>=0?yA.center:-1,yA.left>=0?yA.left:-1,yA.vertical||-1,NE,QE,Bk,uve,Ave,hve,dve,fve,pve,gve,mve,Vs,Nm,xk,oa,mA,Ek,0,hs,Pl,_ve,vve)}(u,Cr,Ft,h,p,b,or,u.layers[0],u.collisionBoxArray,c.index,c.sourceLayerIndex,u.index,Le,[We,We,We,We],Zt,O,rt,bt,hr,ce,c,S,G,K,I)};if(Xt==="line")for(const Ft of ck(c.geometry,0,0,Rn,Rn)){const Cr=rve(Ft,ze,wt,h.vertical||Ae,p,24,Ne,u.overscaling,Rn);for(const pr of Cr)Ae&&cve(u,Ae.text,Wt,pr)||jt(Ft,pr)}else if(Xt==="line-center"){for(const Ft of c.geometry)if(Ft.length>1){const Cr=tve(Ft,wt,h.vertical||Ae,p,24,Ne);Cr&&jt(Ft,Cr)}}else if(c.type==="Polygon")for(const Ft of lE(c.geometry,0)){const Cr=sve(Ft,16);jt(Ft[0],new vh(Cr.x,Cr.y,0))}else if(c.type==="LineString")for(const Ft of c.geometry)jt(Ft,new vh(Ft[0].x,Ft[0].y,0));else if(c.type==="Point")for(const Ft of c.geometry)for(const Cr of Ft)jt([Cr],new vh(Cr.x,Cr.y,0))}function yk(u,c,h,p,b,S,I,F,O,G,K,J,ie,ce,Ae){const Ce=function(rt,ze,We,bt,wt,Zt,hr,Xt){const Wt=bt.layout.get("text-rotate").evaluate(Zt,{})*Math.PI/180,Nt=[];for(const or of ze.positionedLines)for(const jt of or.positionedGlyphs){if(!jt.rect)continue;const Ft=jt.rect||{};let Cr=R6+1,pr=!0,tn=1,ai=0;const fi=(wt||Xt)&&jt.vertical,As=jt.metrics.advance*jt.scale/2;if(Xt&&ze.verticalizable&&(ai=or.lineOffset/2-(jt.imageName?-(us-jt.metrics.width*jt.scale)/2:(jt.scale-1)*us)),jt.imageName){const fs=hr[jt.imageName];pr=fs.sdf,tn=fs.pixelRatio,Cr=na/tn}const Ea=wt?[jt.x+As,jt.y]:[0,0];let To=wt?[0,0]:[jt.x+As+We[0],jt.y+We[1]-ai],Ji=[0,0];fi&&(Ji=To,To=[0,0]);const Ss=jt.metrics.isDoubleResolution?2:1,Vs=(jt.metrics.left-Cr)*jt.scale-As+To[0],Io=(-jt.metrics.top-Cr)*jt.scale+To[1],Lo=Vs+Ft.w/Ss*jt.scale/tn,hs=Io+Ft.h/Ss*jt.scale/tn,ds=new v(Vs,Io),no=new v(Lo,Io),Fo=new v(Vs,hs),io=new v(Lo,hs);if(fi){const fs=new v(-As,As-Pm),An=-Math.PI/2,so=us/2-As,js=new v(5-Pm-so,-(jt.imageName?so:0)),ps=new v(...Ji);ds._rotateAround(An,fs)._add(js)._add(ps),no._rotateAround(An,fs)._add(js)._add(ps),Fo._rotateAround(An,fs)._add(js)._add(ps),io._rotateAround(An,fs)._add(js)._add(ps)}if(Wt){const fs=Math.sin(Wt),An=Math.cos(Wt),so=[An,-fs,fs,An];ds._matMult(so),no._matMult(so),Fo._matMult(so),io._matMult(so)}const ia=new v(0,0),sa=new v(0,0);Nt.push({tl:ds,tr:no,bl:Fo,br:io,tex:Ft,writingMode:ze.writingMode,glyphOffset:Ea,sectionIndex:jt.sectionIndex,isSDF:pr,pixelOffsetTL:ia,pixelOffsetBR:sa,minFontScaleX:0,minFontScaleY:0})}return Nt}(0,h,F,b,S,I,p,u.allowVerticalPlacement),Le=u.textSizeData;let Ne=null;Le.kind==="source"?(Ne=[yu*b.layout.get("text-size").evaluate(I,{})],Ne[0]>yh&&xe(`${u.layerIds[0]}: Value for "text-size" is >= ${Rm}. Reduce your "text-size".`)):Le.kind==="composite"&&(Ne=[yu*ce.compositeTextSizes[0].evaluate(I,{},Ae),yu*ce.compositeTextSizes[1].evaluate(I,{},Ae)],(Ne[0]>yh||Ne[1]>yh)&&xe(`${u.layerIds[0]}: Value for "text-size" is >= ${Rm}. Reduce your "text-size".`)),u.addSymbols(u.text,Ce,Ne,F,S,I,G,c,O.lineStartIndex,O.lineLength,ie,Ae);for(const rt of K)J[rt]=u.text.placedSymbolArray.length-1;return 4*Ce.length}function _k(u){for(const c in u)return u[c];return null}function cve(u,c,h,p){const b=u.compareText;if(c in b){const S=b[c];for(let I=S.length-1;I>=0;I--)if(p.dist(S[I])<h)return!0}else b[c]=[];return b[c].push(p),!1}const vk=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class ME{static from(c){if(!(c instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,p]=new Uint8Array(c,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const b=p>>4;if(b!==1)throw new Error(`Got v${b} data when expected v1.`);const S=vk[15&p];if(!S)throw new Error("Unrecognized array type.");const[I]=new Uint16Array(c,2,1),[F]=new Uint32Array(c,4,1);return new ME(F,I,S,c)}constructor(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,b=arguments.length>3?arguments[3]:void 0;if(isNaN(c)||c<0)throw new Error(`Unpexpected numItems value: ${c}.`);this.numItems=+c,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=p,this.IndexArrayType=c<65536?Uint16Array:Uint32Array;const S=vk.indexOf(this.ArrayType),I=2*c*this.ArrayType.BYTES_PER_ELEMENT,F=c*this.IndexArrayType.BYTES_PER_ELEMENT,O=(8-F%8)%8;if(S<0)throw new Error(`Unexpected typed array class: ${p}.`);b&&b instanceof ArrayBuffer?(this.data=b,this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+F+O,2*c),this._pos=2*c,this._finished=!0):(this.data=new ArrayBuffer(8+I+F+O),this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+F+O,2*c),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+S]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=c)}add(c,h){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=c,this.coords[this._pos++]=h,p}finish(){const c=this._pos>>1;if(c!==this.numItems)throw new Error(`Added ${c} items when expected ${this.numItems}.`);return PE(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(c,h,p,b){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:S,coords:I,nodeSize:F}=this,O=[0,S.length-1,0],G=[];for(;O.length;){const K=O.pop()||0,J=O.pop()||0,ie=O.pop()||0;if(J-ie<=F){for(let Le=ie;Le<=J;Le++){const Ne=I[2*Le],rt=I[2*Le+1];Ne>=c&&Ne<=p&&rt>=h&&rt<=b&&G.push(S[Le])}continue}const ce=ie+J>>1,Ae=I[2*ce],Ce=I[2*ce+1];Ae>=c&&Ae<=p&&Ce>=h&&Ce<=b&&G.push(S[ce]),(K===0?c<=Ae:h<=Ce)&&(O.push(ie),O.push(ce-1),O.push(1-K)),(K===0?p>=Ae:b>=Ce)&&(O.push(ce+1),O.push(J),O.push(1-K))}return G}within(c,h,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:S,nodeSize:I}=this,F=[0,b.length-1,0],O=[],G=p*p;for(;F.length;){const K=F.pop()||0,J=F.pop()||0,ie=F.pop()||0;if(J-ie<=I){for(let Le=ie;Le<=J;Le++)wk(S[2*Le],S[2*Le+1],c,h)<=G&&O.push(b[Le]);continue}const ce=ie+J>>1,Ae=S[2*ce],Ce=S[2*ce+1];wk(Ae,Ce,c,h)<=G&&O.push(b[ce]),(K===0?c-p<=Ae:h-p<=Ce)&&(F.push(ie),F.push(ce-1),F.push(1-K)),(K===0?c+p>=Ae:h+p>=Ce)&&(F.push(ce+1),F.push(J),F.push(1-K))}return O}}function PE(u,c,h,p,b,S){if(b-p<=h)return;const I=p+b>>1;bk(u,c,I,p,b,S),PE(u,c,h,p,I-1,1-S),PE(u,c,h,I+1,b,1-S)}function bk(u,c,h,p,b,S){for(;b>p;){if(b-p>600){const G=b-p+1,K=h-p+1,J=Math.log(G),ie=.5*Math.exp(2*J/3),ce=.5*Math.sqrt(J*ie*(G-ie)/G)*(K-G/2<0?-1:1);bk(u,c,h,Math.max(p,Math.floor(h-K*ie/G+ce)),Math.min(b,Math.floor(h+(G-K)*ie/G+ce)),S)}const I=c[2*h+S];let F=p,O=b;for(Dm(u,c,p,h),c[2*b+S]>I&&Dm(u,c,p,b);F<O;){for(Dm(u,c,F,O),F++,O--;c[2*F+S]<I;)F++;for(;c[2*O+S]>I;)O--}c[2*p+S]===I?Dm(u,c,p,O):(O++,Dm(u,c,O,b)),O<=h&&(p=O+1),h<=O&&(b=O-1)}}function Dm(u,c,h,p){UE(u,h,p),UE(c,2*h,2*p),UE(c,2*h+1,2*p+1)}function UE(u,c,h){const p=u[c];u[c]=u[h],u[h]=p}function wk(u,c,h,p){const b=u-h,S=c-p;return b*b+S*S}var RE;a.bd=void 0,(RE=a.bd||(a.bd={})).create="create",RE.load="load",RE.fullLoad="fullLoad";let k_=null,km=[];const OE=1e3/60,DE="loadTime",kE="fullLoadTime",lve={mark(u){performance.mark(u)},frame(u){const c=u;k_!=null&&km.push(c-k_),k_=c},clearMetrics(){k_=null,km=[],performance.clearMeasures(DE),performance.clearMeasures(kE);for(const u in a.bd)performance.clearMarks(a.bd[u])},getPerformanceMetrics(){performance.measure(DE,a.bd.create,a.bd.load),performance.measure(kE,a.bd.create,a.bd.fullLoad);const u=performance.getEntriesByName(DE)[0].duration,c=performance.getEntriesByName(kE)[0].duration,h=km.length,p=1/(km.reduce((S,I)=>S+I,0)/h/1e3),b=km.filter(S=>S>OE).reduce((S,I)=>S+(I-OE)/OE,0);return{loadTime:u,fullLoadTime:c,fps:p,percentDroppedFrames:b/(h+b)*100,totalFrames:h}}};a.$=Xe,a.A=dA,a.B=function(u){if(nt==null){const c=u.navigator?u.navigator.userAgent:null;nt=!!u.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return nt},a.C=class{constructor(u,c){this.target=u,this.mapId=c,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Z_e(()=>this.process()),this.subscription=function(h,p,b,S){return h.addEventListener(p,b,!1),{unsubscribe:()=>{h.removeEventListener(p,b,!1)}}}(this.target,"message",h=>this.receive(h)),this.globalScope=et(self)?u:window}registerMessageHandler(u,c){this.messageHandlers[u]=c}sendAsync(u,c){return new Promise((h,p)=>{const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[b]={resolve:h,reject:p},c&&c.signal.addEventListener("abort",()=>{delete this.resolveRejects[b];const F={id:b,type:"<cancel>",origin:location.origin,targetMapId:u.targetMapId,sourceMapId:this.mapId};this.target.postMessage(F)},{once:!0});const S=[],I=Object.assign(Object.assign({},u),{id:b,sourceMapId:this.mapId,origin:location.origin,data:yl(u.data,S)});this.target.postMessage(I,{transfer:S})})}receive(u){const c=u.data,h=c.id;if(!(c.origin!=="file://"&&location.origin!=="file://"&&c.origin!==location.origin||c.targetMapId&&this.mapId!==c.targetMapId)){if(c.type==="<cancel>"){delete this.tasks[h];const p=this.abortControllers[h];return delete this.abortControllers[h],void(p&&p.abort())}if(et(self)||c.mustQueue)return this.tasks[h]=c,this.taskQueue.push(h),void this.invoker.trigger();this.processTask(h,c)}}process(){if(this.taskQueue.length===0)return;const u=this.taskQueue.shift(),c=this.tasks[u];delete this.tasks[u],this.taskQueue.length>0&&this.invoker.trigger(),c&&this.processTask(u,c)}processTask(u,c){return o(this,void 0,void 0,function*(){if(c.type==="<response>"){const b=this.resolveRejects[u];return delete this.resolveRejects[u],b?void(c.error?b.reject(_l(c.error)):b.resolve(_l(c.data))):void 0}if(!this.messageHandlers[c.type])return void this.completeTask(u,new Error(`Could not find a registered handler for ${c.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const h=_l(c.data),p=new AbortController;this.abortControllers[u]=p;try{const b=yield this.messageHandlers[c.type](c.sourceMapId,h,p);this.completeTask(u,null,b)}catch(b){this.completeTask(u,b)}})}completeTask(u,c,h){const p=[];delete this.abortControllers[u];const b={id:u,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:c?yl(c):null,data:yl(h,p)};this.target.postMessage(b,{transfer:p})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},a.D=dr,a.E=Re,a.F=function(){var u=new dA(16);return dA!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},a.G=qe,a.H=function(u,c,h){var p,b,S,I,F,O,G,K,J,ie,ce,Ae,Ce=h[0],Le=h[1],Ne=h[2];return c===u?(u[12]=c[0]*Ce+c[4]*Le+c[8]*Ne+c[12],u[13]=c[1]*Ce+c[5]*Le+c[9]*Ne+c[13],u[14]=c[2]*Ce+c[6]*Le+c[10]*Ne+c[14],u[15]=c[3]*Ce+c[7]*Le+c[11]*Ne+c[15]):(b=c[1],S=c[2],I=c[3],F=c[4],O=c[5],G=c[6],K=c[7],J=c[8],ie=c[9],ce=c[10],Ae=c[11],u[0]=p=c[0],u[1]=b,u[2]=S,u[3]=I,u[4]=F,u[5]=O,u[6]=G,u[7]=K,u[8]=J,u[9]=ie,u[10]=ce,u[11]=Ae,u[12]=p*Ce+F*Le+J*Ne+c[12],u[13]=b*Ce+O*Le+ie*Ne+c[13],u[14]=S*Ce+G*Le+ce*Ne+c[14],u[15]=I*Ce+K*Le+Ae*Ne+c[15]),u},a.I=_E,a.J=function(u,c,h){var p=h[0],b=h[1],S=h[2];return u[0]=c[0]*p,u[1]=c[1]*p,u[2]=c[2]*p,u[3]=c[3]*p,u[4]=c[4]*b,u[5]=c[5]*b,u[6]=c[6]*b,u[7]=c[7]*b,u[8]=c[8]*S,u[9]=c[9]*S,u[10]=c[10]*S,u[11]=c[11]*S,u[12]=c[12],u[13]=c[13],u[14]=c[14],u[15]=c[15],u},a.K=bm,a.L=function(u,c){const h={};for(let p=0;p<c.length;p++){const b=c[p];b in u&&(h[b]=u[b])}return h},a.M=_h,a.N=J6,a.O=Y6,a.P=v,a.Q=Xa,a.R=ra,a.S=Q,a.T=iA,a.U=q,a.V=ot,a.W=Rn,a.X=Ei,a.Y=P_,a.Z=class extends ea{},a._=o,a.a=De,a.a$=function(u,c,h){return u[0]=c[0]*h[0],u[1]=c[1]*h[1],u[2]=c[2]*h[2],u[3]=c[3]*h[3],u},a.a0=IE,a.a1=pt,a.a2=u=>{const c=window.document.createElement("video");return c.muted=!0,new Promise(h=>{c.onloadstart=()=>{h(c)};for(const p of u){const b=window.document.createElement("source");It(p)||(c.crossOrigin="Anonymous"),b.src=p,c.appendChild(b)}})},a.a3=function(){return fe++},a.a4=C,a.a5=vp,a.a6=Bc,a.a7=Lc,a.a8=zn,a.a9=ik,a.aA=oe,a.aB=function(u,c){if(!u)return[{command:"setStyle",args:[c]}];let h=[];try{if(!vt(u.version,c.version))return[{command:"setStyle",args:[c]}];vt(u.center,c.center)||h.push({command:"setCenter",args:[c.center]}),vt(u.zoom,c.zoom)||h.push({command:"setZoom",args:[c.zoom]}),vt(u.bearing,c.bearing)||h.push({command:"setBearing",args:[c.bearing]}),vt(u.pitch,c.pitch)||h.push({command:"setPitch",args:[c.pitch]}),vt(u.sprite,c.sprite)||h.push({command:"setSprite",args:[c.sprite]}),vt(u.glyphs,c.glyphs)||h.push({command:"setGlyphs",args:[c.glyphs]}),vt(u.transition,c.transition)||h.push({command:"setTransition",args:[c.transition]}),vt(u.light,c.light)||h.push({command:"setLight",args:[c.light]}),vt(u.terrain,c.terrain)||h.push({command:"setTerrain",args:[c.terrain]}),vt(u.sky,c.sky)||h.push({command:"setSky",args:[c.sky]});const p={},b=[];(function(I,F,O,G){let K;for(K in F=F||{},I=I||{})Object.prototype.hasOwnProperty.call(I,K)&&(Object.prototype.hasOwnProperty.call(F,K)||ir(K,O,G));for(K in F)Object.prototype.hasOwnProperty.call(F,K)&&(Object.prototype.hasOwnProperty.call(I,K)?vt(I[K],F[K])||(I[K].type==="geojson"&&F[K].type==="geojson"&&Lr(I,F,K)?Bt(O,{command:"setGeoJSONSourceData",args:[K,F[K].data]}):Ar(K,F,O,G)):kt(K,F,O))})(u.sources,c.sources,b,p);const S=[];u.layers&&u.layers.forEach(I=>{"source"in I&&p[I.source]?h.push({command:"removeLayer",args:[I.id]}):S.push(I)}),h=h.concat(b),function(I,F,O){F=F||[];const G=(I=I||[]).map(kr),K=F.map(kr),J=I.reduce(Qr,{}),ie=F.reduce(Qr,{}),ce=G.slice(),Ae=Object.create(null);let Ce,Le,Ne,rt,ze;for(let We=0,bt=0;We<G.length;We++)Ce=G[We],Object.prototype.hasOwnProperty.call(ie,Ce)?bt++:(Bt(O,{command:"removeLayer",args:[Ce]}),ce.splice(ce.indexOf(Ce,bt),1));for(let We=0,bt=0;We<K.length;We++)Ce=K[K.length-1-We],ce[ce.length-1-We]!==Ce&&(Object.prototype.hasOwnProperty.call(J,Ce)?(Bt(O,{command:"removeLayer",args:[Ce]}),ce.splice(ce.lastIndexOf(Ce,ce.length-bt),1)):bt++,rt=ce[ce.length-We],Bt(O,{command:"addLayer",args:[ie[Ce],rt]}),ce.splice(ce.length-We,0,Ce),Ae[Ce]=!0);for(let We=0;We<K.length;We++)if(Ce=K[We],Le=J[Ce],Ne=ie[Ce],!Ae[Ce]&&!vt(Le,Ne))if(vt(Le.source,Ne.source)&&vt(Le["source-layer"],Ne["source-layer"])&&vt(Le.type,Ne.type)){for(ze in Tr(Le.layout,Ne.layout,O,Ce,null,"setLayoutProperty"),Tr(Le.paint,Ne.paint,O,Ce,null,"setPaintProperty"),vt(Le.filter,Ne.filter)||Bt(O,{command:"setFilter",args:[Ce,Ne.filter]}),vt(Le.minzoom,Ne.minzoom)&&vt(Le.maxzoom,Ne.maxzoom)||Bt(O,{command:"setLayerZoomRange",args:[Ce,Ne.minzoom,Ne.maxzoom]}),Le)Object.prototype.hasOwnProperty.call(Le,ze)&&ze!=="layout"&&ze!=="paint"&&ze!=="filter"&&ze!=="metadata"&&ze!=="minzoom"&&ze!=="maxzoom"&&(ze.indexOf("paint.")===0?Tr(Le[ze],Ne[ze],O,Ce,ze.slice(6),"setPaintProperty"):vt(Le[ze],Ne[ze])||Bt(O,{command:"setLayerProperty",args:[Ce,ze,Ne[ze]]}));for(ze in Ne)Object.prototype.hasOwnProperty.call(Ne,ze)&&!Object.prototype.hasOwnProperty.call(Le,ze)&&ze!=="layout"&&ze!=="paint"&&ze!=="filter"&&ze!=="metadata"&&ze!=="minzoom"&&ze!=="maxzoom"&&(ze.indexOf("paint.")===0?Tr(Le[ze],Ne[ze],O,Ce,ze.slice(6),"setPaintProperty"):vt(Le[ze],Ne[ze])||Bt(O,{command:"setLayerProperty",args:[Ce,ze,Ne[ze]]}))}else Bt(O,{command:"removeLayer",args:[Ce]}),rt=ce[ce.lastIndexOf(Ce)+1],Bt(O,{command:"addLayer",args:[Ne,rt]})}(S,c.layers,h)}catch(p){console.warn("Unable to compute style diff:",p),h=[{command:"setStyle",args:[c]}]}return h},a.aC=function(u){const c=[],h=u.id;return h===void 0&&c.push({message:`layers.${h}: missing required property "id"`}),u.render===void 0&&c.push({message:`layers.${h}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&c.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),c},a.aD=function u(c,h){if(Array.isArray(c)){if(!Array.isArray(h)||c.length!==h.length)return!1;for(let p=0;p<c.length;p++)if(!u(c[p],h[p]))return!1;return!0}if(typeof c=="object"&&c!==null&&h!==null){if(typeof h!="object"||Object.keys(c).length!==Object.keys(h).length)return!1;for(const p in c)if(!u(c[p],h[p]))return!1;return!0}return c===h},a.aE=Oe,a.aF=Fe,a.aG=class extends Cn{constructor(u,c){super(u,c),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},a.aH=En,a.aI=class extends Cn{constructor(u,c){super(u,c),this.current=ls}set(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let c=1;c<16;c++)if(u[c]!==this.current[c]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}},a.aJ=di,a.aK=class extends Cn{constructor(u,c){super(u,c),this.current=[0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))}},a.aL=class extends Cn{constructor(u,c){super(u,c),this.current=[0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))}},a.aM=dn,a.aN=function(u,c,h,p,b,S,I){var F=1/(c-h),O=1/(p-b),G=1/(S-I);return u[0]=-2*F,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*O,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*G,u[11]=0,u[12]=(c+h)*F,u[13]=(b+p)*O,u[14]=(I+S)*G,u[15]=1,u},a.aO=Br,a.aP=hp,a.aQ=class extends lA{},a.aR=S_e,a.aS=class extends Cl{},a.aT=function(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))},a.aU=xm,a.aV=L,a.aW=class extends bd{},a.aX=Ie,a.aY=function(u,c){return u[0]===c[0]&&u[1]===c[1]&&u[2]===c[2]&&u[3]===c[3]&&u[4]===c[4]&&u[5]===c[5]&&u[6]===c[6]&&u[7]===c[7]&&u[8]===c[8]&&u[9]===c[9]&&u[10]===c[10]&&u[11]===c[11]&&u[12]===c[12]&&u[13]===c[13]&&u[14]===c[14]&&u[15]===c[15]},a.aZ=function(u,c){var h=u[0],p=u[1],b=u[2],S=u[3],I=u[4],F=u[5],O=u[6],G=u[7],K=u[8],J=u[9],ie=u[10],ce=u[11],Ae=u[12],Ce=u[13],Le=u[14],Ne=u[15],rt=c[0],ze=c[1],We=c[2],bt=c[3],wt=c[4],Zt=c[5],hr=c[6],Xt=c[7],Wt=c[8],Nt=c[9],or=c[10],jt=c[11],Ft=c[12],Cr=c[13],pr=c[14],tn=c[15];return Math.abs(h-rt)<=zs*Math.max(1,Math.abs(h),Math.abs(rt))&&Math.abs(p-ze)<=zs*Math.max(1,Math.abs(p),Math.abs(ze))&&Math.abs(b-We)<=zs*Math.max(1,Math.abs(b),Math.abs(We))&&Math.abs(S-bt)<=zs*Math.max(1,Math.abs(S),Math.abs(bt))&&Math.abs(I-wt)<=zs*Math.max(1,Math.abs(I),Math.abs(wt))&&Math.abs(F-Zt)<=zs*Math.max(1,Math.abs(F),Math.abs(Zt))&&Math.abs(O-hr)<=zs*Math.max(1,Math.abs(O),Math.abs(hr))&&Math.abs(G-Xt)<=zs*Math.max(1,Math.abs(G),Math.abs(Xt))&&Math.abs(K-Wt)<=zs*Math.max(1,Math.abs(K),Math.abs(Wt))&&Math.abs(J-Nt)<=zs*Math.max(1,Math.abs(J),Math.abs(Nt))&&Math.abs(ie-or)<=zs*Math.max(1,Math.abs(ie),Math.abs(or))&&Math.abs(ce-jt)<=zs*Math.max(1,Math.abs(ce),Math.abs(jt))&&Math.abs(Ae-Ft)<=zs*Math.max(1,Math.abs(Ae),Math.abs(Ft))&&Math.abs(Ce-Cr)<=zs*Math.max(1,Math.abs(Ce),Math.abs(Cr))&&Math.abs(Le-pr)<=zs*Math.max(1,Math.abs(Le),Math.abs(pr))&&Math.abs(Ne-tn)<=zs*Math.max(1,Math.abs(Ne),Math.abs(tn))},a.a_=function(u,c){return u[0]=c[0],u[1]=c[1],u[2]=c[2],u[3]=c[3],u[4]=c[4],u[5]=c[5],u[6]=c[6],u[7]=c[7],u[8]=c[8],u[9]=c[9],u[10]=c[10],u[11]=c[11],u[12]=c[12],u[13]=c[13],u[14]=c[14],u[15]=c[15],u},a.aa=function(u){const c={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,p,b,S)=>{const I=b||S;return c[p]=!I||I.toLowerCase(),""}),c["max-age"]){const h=parseInt(c["max-age"],10);isNaN(h)?delete c["max-age"]:c["max-age"]=h}return c},a.ab=function(u,c){const h=[];for(const p in u)p in c||h.push(p);return h},a.ac=pe,a.ad=function(u,c,h){var p=Math.sin(h),b=Math.cos(h),S=c[0],I=c[1],F=c[2],O=c[3],G=c[4],K=c[5],J=c[6],ie=c[7];return c!==u&&(u[8]=c[8],u[9]=c[9],u[10]=c[10],u[11]=c[11],u[12]=c[12],u[13]=c[13],u[14]=c[14],u[15]=c[15]),u[0]=S*b+G*p,u[1]=I*b+K*p,u[2]=F*b+J*p,u[3]=O*b+ie*p,u[4]=G*b-S*p,u[5]=K*b-I*p,u[6]=J*b-F*p,u[7]=ie*b-O*p,u},a.ae=function(u){var c=new dA(16);return c[0]=u[0],c[1]=u[1],c[2]=u[2],c[3]=u[3],c[4]=u[4],c[5]=u[5],c[6]=u[6],c[7]=u[7],c[8]=u[8],c[9]=u[9],c[10]=u[10],c[11]=u[11],c[12]=u[12],c[13]=u[13],c[14]=u[14],c[15]=u[15],c},a.af=hh,a.ag=function(u,c){let h=0,p=0;if(u.kind==="constant")p=u.layoutSize;else if(u.kind!=="source"){const{interpolationType:b,minZoom:S,maxZoom:I}=u,F=b?pe(Bi.interpolationFactor(b,c,S,I),0,1):0;u.kind==="camera"?p=Ri.number(u.minSize,u.maxSize,F):h=F}return{uSizeT:h,uSize:p}},a.ai=function(u,c,h){let{uSize:p,uSizeT:b}=c,{lowerSize:S,upperSize:I}=h;return u.kind==="source"?S/yu:u.kind==="composite"?Ri.number(S/yu,I/yu,b):p},a.aj=xE,a.ak=function(u,c,h,p){const b=c.y-u.y,S=c.x-u.x,I=p.y-h.y,F=p.x-h.x,O=I*S-F*b;if(O===0)return null;const G=(F*(u.y-h.y)-I*(u.x-h.x))/O;return new v(u.x+G*S,u.y+G*b)},a.al=ck,a.am=pu,a.an=uh,a.ao=us,a.aq=wE,a.ar=function(u,c){var h=c[0],p=c[1],b=c[2],S=c[3],I=c[4],F=c[5],O=c[6],G=c[7],K=c[8],J=c[9],ie=c[10],ce=c[11],Ae=c[12],Ce=c[13],Le=c[14],Ne=c[15],rt=h*F-p*I,ze=h*O-b*I,We=h*G-S*I,bt=p*O-b*F,wt=p*G-S*F,Zt=b*G-S*O,hr=K*Ce-J*Ae,Xt=K*Le-ie*Ae,Wt=K*Ne-ce*Ae,Nt=J*Le-ie*Ce,or=J*Ne-ce*Ce,jt=ie*Ne-ce*Le,Ft=rt*jt-ze*or+We*Nt+bt*Wt-wt*Xt+Zt*hr;return Ft?(u[0]=(F*jt-O*or+G*Nt)*(Ft=1/Ft),u[1]=(b*or-p*jt-S*Nt)*Ft,u[2]=(Ce*Zt-Le*wt+Ne*bt)*Ft,u[3]=(ie*wt-J*Zt-ce*bt)*Ft,u[4]=(O*Wt-I*jt-G*Xt)*Ft,u[5]=(h*jt-b*Wt+S*Xt)*Ft,u[6]=(Le*We-Ae*Zt-Ne*ze)*Ft,u[7]=(K*Zt-ie*We+ce*ze)*Ft,u[8]=(I*or-F*Wt+G*hr)*Ft,u[9]=(p*Wt-h*or-S*hr)*Ft,u[10]=(Ae*wt-Ce*We+Ne*rt)*Ft,u[11]=(J*We-K*wt-ce*rt)*Ft,u[12]=(F*Xt-I*Nt-O*hr)*Ft,u[13]=(h*Nt-p*Xt+b*hr)*Ft,u[14]=(Ce*ze-Ae*bt-Le*rt)*Ft,u[15]=(K*bt-J*ze+ie*rt)*Ft,u):null},a.as=FE,a.at=bE,a.au=ME,a.av=function(){const u={},c=Ye.$version;for(const h in Ye.$root){const p=Ye.$root[h];if(p.required){let b=null;b=h==="version"?c:p.type==="array"?[]:{},b!=null&&(u[h]=b)}}return u},a.aw=rh,a.ax=st,a.ay=function(u){u=u.slice();const c=Object.create(null);for(let h=0;h<u.length;h++)c[u[h].id]=u[h];for(let h=0;h<u.length;h++)"ref"in u[h]&&(u[h]=St(u[h],c[u[h].ref]));return u},a.az=function(u){if(u.type==="custom")return new Y_e(u);switch(u.type){case"background":return new $_e(u);case"circle":return new Cd(u);case"fill":return new e_e(u);case"fill-extrusion":return new p_e(u);case"heatmap":return new fh(u);case"hillshade":return new nE(u);case"line":return new x_e(u);case"raster":return new J_e(u);case"symbol":return new M_(u)}},a.b=Je,a.b0=function(u,c){return u[0]*c[0]+u[1]*c[1]+u[2]*c[2]+u[3]*c[3]},a.b1=ge,a.b2=tk,a.b3=Z6,a.b4=function(u,c,h,p,b){var S,I=1/Math.tan(c/2);return u[0]=I/h,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=I,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,b!=null&&b!==1/0?(u[10]=(b+p)*(S=1/(p-b)),u[14]=2*b*p*S):(u[10]=-1,u[14]=-2*p),u},a.b5=function(u,c,h){var p=Math.sin(h),b=Math.cos(h),S=c[4],I=c[5],F=c[6],O=c[7],G=c[8],K=c[9],J=c[10],ie=c[11];return c!==u&&(u[0]=c[0],u[1]=c[1],u[2]=c[2],u[3]=c[3],u[12]=c[12],u[13]=c[13],u[14]=c[14],u[15]=c[15]),u[4]=S*b+G*p,u[5]=I*b+K*p,u[6]=F*b+J*p,u[7]=O*b+ie*p,u[8]=G*b-S*p,u[9]=K*b-I*p,u[10]=J*b-F*p,u[11]=ie*b-O*p,u},a.b6=Y,a.b7=te,a.b8=function(u){return u*Math.PI/180},a.b9=function(u,c){return u[0]=c[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=c[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=c[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},a.bA=Wa,a.ba=class extends Ni{},a.bb=SE,a.bc=lve,a.be=ct,a.bf=function(u,c){De.REGISTERED_PROTOCOLS[u]=c},a.bg=function(u){delete De.REGISTERED_PROTOCOLS[u]},a.bh=function(u,c){const h={};for(let b=0;b<u.length;b++){const S=c&&c[u[b].id]||dd(u[b]);c&&(c[u[b].id]=S);let I=h[S];I||(I=h[S]=[]),I.push(u[b])}const p=[];for(const b in h)p.push(h[b]);return p},a.bi=er,a.bj=nk,a.bk=sk,a.bl=D6,a.bm=function(u){u.bucket.createArrays(),u.bucket.tilePixelRatio=Rn/(512*u.bucket.overscaling),u.bucket.compareText={},u.bucket.iconsNeedLinear=!1;const c=u.bucket.layers[0],h=c.layout,p=c._unevaluatedLayout._values,b={layoutIconSize:p["icon-size"].possiblyEvaluate(new zn(u.bucket.zoom+1),u.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new zn(u.bucket.zoom+1),u.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new zn(18))};if(u.bucket.textSizeData.kind==="composite"){const{minZoom:G,maxZoom:K}=u.bucket.textSizeData;b.compositeTextSizes=[p["text-size"].possiblyEvaluate(new zn(G),u.canonical),p["text-size"].possiblyEvaluate(new zn(K),u.canonical)]}if(u.bucket.iconSizeData.kind==="composite"){const{minZoom:G,maxZoom:K}=u.bucket.iconSizeData;b.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new zn(G),u.canonical),p["icon-size"].possiblyEvaluate(new zn(K),u.canonical)]}const S=h.get("text-line-height")*us,I=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",F=h.get("text-keep-upright"),O=h.get("text-size");for(const G of u.bucket.features){const K=h.get("text-font").evaluate(G,{},u.canonical).join(","),J=O.evaluate(G,{},u.canonical),ie=b.layoutTextSize.evaluate(G,{},u.canonical),ce=b.layoutIconSize.evaluate(G,{},u.canonical),Ae={horizontal:{},vertical:void 0},Ce=G.text;let Le,Ne=[0,0];if(Ce){const We=Ce.toString(),bt=h.get("text-letter-spacing").evaluate(G,{},u.canonical)*us,wt=to(We)?bt:0,Zt=h.get("text-anchor").evaluate(G,{},u.canonical),hr=mk(c,G,u.canonical);if(!hr){const jt=h.get("text-radial-offset").evaluate(G,{},u.canonical);Ne=jt?gk(Zt,[jt*us,LE]):h.get("text-offset").evaluate(G,{},u.canonical).map(Ft=>Ft*us)}let Xt=I?"center":h.get("text-justify").evaluate(G,{},u.canonical);const Wt=h.get("symbol-placement"),Nt=Wt==="point"?h.get("text-max-width").evaluate(G,{},u.canonical)*us:0,or=()=>{u.bucket.allowVerticalPlacement&&Wi(We)&&(Ae.vertical=I_(Ce,u.glyphMap,u.glyphPositions,u.imagePositions,K,Nt,S,Zt,"left",wt,Ne,a.ah.vertical,!0,Wt,ie,J))};if(!I&&hr){const jt=new Set;if(Xt==="auto")for(let Cr=0;Cr<hr.values.length;Cr+=2)jt.add(FE(hr.values[Cr]));else jt.add(Xt);let Ft=!1;for(const Cr of jt)if(!Ae.horizontal[Cr])if(Ft)Ae.horizontal[Cr]=Ae.horizontal[0];else{const pr=I_(Ce,u.glyphMap,u.glyphPositions,u.imagePositions,K,Nt,S,"center",Cr,wt,Ne,a.ah.horizontal,!1,Wt,ie,J);pr&&(Ae.horizontal[Cr]=pr,Ft=pr.positionedLines.length===1)}or()}else{Xt==="auto"&&(Xt=FE(Zt));const jt=I_(Ce,u.glyphMap,u.glyphPositions,u.imagePositions,K,Nt,S,Zt,Xt,wt,Ne,a.ah.horizontal,!1,Wt,ie,J);jt&&(Ae.horizontal[Xt]=jt),or(),Wi(We)&&I&&F&&(Ae.vertical=I_(Ce,u.glyphMap,u.glyphPositions,u.imagePositions,K,Nt,S,Zt,Xt,wt,Ne,a.ah.vertical,!1,Wt,ie,J))}}let rt=!1;if(G.icon&&G.icon.name){const We=u.imageMap[G.icon.name];We&&(Le=V_e(u.imagePositions[G.icon.name],h.get("icon-offset").evaluate(G,{},u.canonical),h.get("icon-anchor").evaluate(G,{},u.canonical)),rt=!!We.sdf,u.bucket.sdfIcons===void 0?u.bucket.sdfIcons=rt:u.bucket.sdfIcons!==rt&&xe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(We.pixelRatio!==u.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(u.bucket.iconsNeedLinear=!0))}const ze=_k(Ae.horizontal)||Ae.vertical;u.bucket.iconsInText=!!ze&&ze.iconsInText,(ze||Le)&&ave(u.bucket,G,Ae,Le,u.imageMap,b,ie,ce,Ne,rt,u.canonical)}u.showCollisionBoxes&&u.bucket.generateCollisionDebugBuffers()},a.bn=pE,a.bo=hE,a.bp=fE,a.bq=gh,a.br=mE,a.bs=class{constructor(u){this._marks={start:[u.url,"start"].join("#"),end:[u.url,"end"].join("#"),measure:u.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let u=performance.getEntriesByName(this._marks.measure);return u.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),u=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),u}},a.bt=function(u,c,h,p,b){return o(this,void 0,void 0,function*(){if(q())try{return yield ot(u,c,h,p,b)}catch{}return function(S,I,F,O,G){const K=S.width,J=S.height;xt&&se||(xt=new OffscreenCanvas(K,J),se=xt.getContext("2d",{willReadFrequently:!0})),xt.width=K,xt.height=J,se.drawImage(S,0,0,K,J);const ie=se.getImageData(I,F,O,G);return se.clearRect(0,0,K,J),ie.data}(u,c,h,p,b)})},a.bu=rk,a.bv=A,a.bw=f,a.bx=T6,a.by=si,a.bz=function(u){return u.message===be},a.c=Me,a.d=u=>o(void 0,void 0,void 0,function*(){if(u.byteLength===0)return createImageBitmap(new ImageData(1,1));const c=new Blob([new Uint8Array(u)],{type:"image/png"});try{return createImageBitmap(c)}catch(h){throw new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),a.e=ye,a.f=u=>new Promise((c,h)=>{const p=new Image;p.onload=()=>{c(p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame(()=>{p.src=it})},p.onerror=()=>h(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const b=new Blob([new Uint8Array(u)],{type:"image/png"});p.src=u.byteLength?URL.createObjectURL(b):it}),a.g=$e,a.h=(u,c)=>Ct(ye(u,{type:"json"}),c),a.i=et,a.j=mt,a.k=zt,a.l=(u,c)=>Ct(ye(u,{type:"arrayBuffer"}),c),a.m=Ct,a.n=function(u){return new mE(u).readFields(k_e,[])},a.o=dh,a.p=O6,a.q=$i,a.r=qa,a.s=It,a.t=Ka,a.u=qt,a.v=Ye,a.w=xe,a.x=ei,a.y=function(u){let[c,h,p]=u;return h+=90,h*=Math.PI/180,p*=Math.PI/180,{x:c*Math.cos(h)*Math.sin(p),y:c*Math.sin(h)*Math.sin(p),z:c*Math.cos(p)}},a.z=Ri}),i("worker",["./shared"],function(a){class o{constructor(ee){this.keyCache={},ee&&this.replace(ee)}replace(ee){this._layerConfigs={},this._layers={},this.update(ee,[])}update(ee,Z){for(const Se of ee){this._layerConfigs[Se.id]=Se;const Qe=this._layers[Se.id]=a.az(Se);Qe._featureFilter=a.a6(Qe.filter),this.keyCache[Se.id]&&delete this.keyCache[Se.id]}for(const Se of Z)delete this.keyCache[Se],delete this._layerConfigs[Se],delete this._layers[Se];this.familiesBySource={};const ae=a.bh(Object.values(this._layerConfigs),this.keyCache);for(const Se of ae){const Qe=Se.map(gt=>this._layers[gt.id]),Ge=Qe[0];if(Ge.visibility==="none")continue;const Ke=Ge.source||"";let Te=this.familiesBySource[Ke];Te||(Te=this.familiesBySource[Ke]={});const Ze=Ge.sourceLayer||"_geojsonTileLayer";let yt=Te[Ze];yt||(yt=Te[Ze]=[]),yt.push(Qe)}}}class A{constructor(ee){const Z={},ae=[];for(const Ke in ee){const Te=ee[Ke],Ze=Z[Ke]={};for(const yt in Te){const gt=Te[+yt];if(!gt||gt.bitmap.width===0||gt.bitmap.height===0)continue;const ft={x:0,y:0,w:gt.bitmap.width+2,h:gt.bitmap.height+2};ae.push(ft),Ze[yt]={rect:ft,metrics:gt.metrics}}}const{w:Se,h:Qe}=a.p(ae),Ge=new a.o({width:Se||1,height:Qe||1});for(const Ke in ee){const Te=ee[Ke];for(const Ze in Te){const yt=Te[+Ze];if(!yt||yt.bitmap.width===0||yt.bitmap.height===0)continue;const gt=Z[Ke][Ze].rect;a.o.copy(yt.bitmap,Ge,{x:0,y:0},{x:gt.x+1,y:gt.y+1},yt.bitmap)}}this.image=Ge,this.positions=Z}}a.bi("GlyphAtlas",A);class f{constructor(ee){this.tileID=new a.Q(ee.tileID.overscaledZ,ee.tileID.wrap,ee.tileID.canonical.z,ee.tileID.canonical.x,ee.tileID.canonical.y),this.uid=ee.uid,this.zoom=ee.zoom,this.pixelRatio=ee.pixelRatio,this.tileSize=ee.tileSize,this.source=ee.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ee.showCollisionBoxes,this.collectResourceTiming=!!ee.collectResourceTiming,this.returnDependencies=!!ee.returnDependencies,this.promoteId=ee.promoteId,this.inFlightDependencies=[]}parse(ee,Z,ae,Se){return a._(this,void 0,void 0,function*(){this.status="parsing",this.data=ee,this.collisionBoxArray=new a.a4;const Qe=new a.bj(Object.keys(ee.layers).sort()),Ge=new a.bk(this.tileID,this.promoteId);Ge.bucketLayerIDs=[];const Ke={},Te={featureIndex:Ge,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ae},Ze=Z.familiesBySource[this.source];for(const mr in Ze){const $r=ee.layers[mr];if(!$r)continue;$r.version===1&&a.w(`Vector tile source "${this.source}" layer "${mr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const bn=Qe.encode(mr),kn=[];for(let ke=0;ke<$r.length;ke++){const Rt=$r.feature(ke),Lt=Ge.getId(Rt,mr);kn.push({feature:Rt,id:Lt,index:ke,sourceLayerIndex:bn})}for(const ke of Ze[mr]){const Rt=ke[0];Rt.source!==this.source&&a.w(`layer.source = ${Rt.source} does not equal this.source = ${this.source}`),Rt.minzoom&&this.zoom<Math.floor(Rt.minzoom)||Rt.maxzoom&&this.zoom>=Rt.maxzoom||Rt.visibility!=="none"&&(m(ke,this.zoom,ae),(Ke[Rt.id]=Rt.createBucket({index:Ge.bucketLayerIDs.length,layers:ke,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:bn,sourceID:this.source})).populate(kn,Te,this.tileID.canonical),Ge.bucketLayerIDs.push(ke.map(Lt=>Lt.id)))}}const yt=a.aE(Te.glyphDependencies,mr=>Object.keys(mr).map(Number));this.inFlightDependencies.forEach(mr=>mr==null?void 0:mr.abort()),this.inFlightDependencies=[];let gt=Promise.resolve({});if(Object.keys(yt).length){const mr=new AbortController;this.inFlightDependencies.push(mr),gt=Se.sendAsync({type:"GG",data:{stacks:yt,source:this.source,tileID:this.tileID,type:"glyphs"}},mr)}const ft=Object.keys(Te.iconDependencies);let Vt=Promise.resolve({});if(ft.length){const mr=new AbortController;this.inFlightDependencies.push(mr),Vt=Se.sendAsync({type:"GI",data:{icons:ft,source:this.source,tileID:this.tileID,type:"icons"}},mr)}const Yt=Object.keys(Te.patternDependencies);let Er=Promise.resolve({});if(Yt.length){const mr=new AbortController;this.inFlightDependencies.push(mr),Er=Se.sendAsync({type:"GI",data:{icons:Yt,source:this.source,tileID:this.tileID,type:"patterns"}},mr)}const[lr,Ur,Nr]=yield Promise.all([gt,Vt,Er]),Hr=new A(lr),mn=new a.bl(Ur,Nr);for(const mr in Ke){const $r=Ke[mr];$r instanceof a.a5?(m($r.layers,this.zoom,ae),a.bm({bucket:$r,glyphMap:lr,glyphPositions:Hr.positions,imageMap:Ur,imagePositions:mn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):$r.hasPattern&&($r instanceof a.bn||$r instanceof a.bo||$r instanceof a.bp)&&(m($r.layers,this.zoom,ae),$r.addFeatures(Te,this.tileID.canonical,mn.patternPositions))}return this.status="done",{buckets:Object.values(Ke).filter(mr=>!mr.isEmpty()),featureIndex:Ge,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Hr.image,imageAtlas:mn,glyphMap:this.returnDependencies?lr:null,iconMap:this.returnDependencies?Ur:null,glyphPositions:this.returnDependencies?Hr.positions:null}})}}function m(Ee,ee,Z){const ae=new a.a8(ee);for(const Se of Ee)Se.recalculate(ae,Z)}class v{constructor(ee,Z,ae){this.actor=ee,this.layerIndex=Z,this.availableImages=ae,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ee,Z){return a._(this,void 0,void 0,function*(){const ae=yield a.l(ee.request,Z);try{return{vectorTile:new a.bq.VectorTile(new a.br(ae.data)),rawData:ae.data,cacheControl:ae.cacheControl,expires:ae.expires}}catch(Se){const Qe=new Uint8Array(ae.data);let Ge=`Unable to parse the tile at ${ee.request.url}, `;throw Ge+=Qe[0]===31&&Qe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Se.messge}`,new Error(Ge)}})}loadTile(ee){return a._(this,void 0,void 0,function*(){const Z=ee.uid,ae=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new a.bs(ee.request),Se=new f(ee);this.loading[Z]=Se;const Qe=new AbortController;Se.abort=Qe;try{const Ge=yield this.loadVectorTile(ee,Qe);if(delete this.loading[Z],!Ge)return null;const Ke=Ge.rawData,Te={};Ge.expires&&(Te.expires=Ge.expires),Ge.cacheControl&&(Te.cacheControl=Ge.cacheControl);const Ze={};if(ae){const gt=ae.finish();gt&&(Ze.resourceTiming=JSON.parse(JSON.stringify(gt)))}Se.vectorTile=Ge.vectorTile;const yt=Se.parse(Ge.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[Z]=Se,this.fetching[Z]={rawTileData:Ke,cacheControl:Te,resourceTiming:Ze};try{const gt=yield yt;return a.e({rawTileData:Ke.slice(0)},gt,Te,Ze)}finally{delete this.fetching[Z]}}catch(Ge){throw delete this.loading[Z],Se.status="done",this.loaded[Z]=Se,Ge}})}reloadTile(ee){return a._(this,void 0,void 0,function*(){const Z=ee.uid;if(!this.loaded||!this.loaded[Z])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ae=this.loaded[Z];if(ae.showCollisionBoxes=ee.showCollisionBoxes,ae.status==="parsing"){const Se=yield ae.parse(ae.vectorTile,this.layerIndex,this.availableImages,this.actor);let Qe;if(this.fetching[Z]){const{rawTileData:Ge,cacheControl:Ke,resourceTiming:Te}=this.fetching[Z];delete this.fetching[Z],Qe=a.e({rawTileData:Ge.slice(0)},Se,Ke,Te)}else Qe=Se;return Qe}if(ae.status==="done"&&ae.vectorTile)return ae.parse(ae.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(ee){return a._(this,void 0,void 0,function*(){const Z=this.loading,ae=ee.uid;Z&&Z[ae]&&Z[ae].abort&&(Z[ae].abort.abort(),delete Z[ae])})}removeTile(ee){return a._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ee.uid]&&delete this.loaded[ee.uid]})}}class x{constructor(){this.loaded={}}loadTile(ee){return a._(this,void 0,void 0,function*(){const{uid:Z,encoding:ae,rawImageData:Se,redFactor:Qe,greenFactor:Ge,blueFactor:Ke,baseShift:Te}=ee,Ze=Se.width+2,yt=Se.height+2,gt=a.b(Se)?new a.R({width:Ze,height:yt},yield a.bt(Se,-1,-1,Ze,yt)):Se,ft=new a.bu(Z,gt,ae,Qe,Ge,Ke,Te);return this.loaded=this.loaded||{},this.loaded[Z]=ft,ft})}removeTile(ee){const Z=this.loaded,ae=ee.uid;Z&&Z[ae]&&delete Z[ae]}}function B(Ee,ee){if(Ee.length!==0){M(Ee[0],ee);for(var Z=1;Z<Ee.length;Z++)M(Ee[Z],!ee)}}function M(Ee,ee){for(var Z=0,ae=0,Se=0,Qe=Ee.length,Ge=Qe-1;Se<Qe;Ge=Se++){var Ke=(Ee[Se][0]-Ee[Ge][0])*(Ee[Ge][1]+Ee[Se][1]),Te=Z+Ke;ae+=Math.abs(Z)>=Math.abs(Ke)?Z-Te+Ke:Ke-Te+Z,Z=Te}Z+ae>=0!=!!ee&&Ee.reverse()}var U=a.bv(function Ee(ee,Z){var ae,Se=ee&&ee.type;if(Se==="FeatureCollection")for(ae=0;ae<ee.features.length;ae++)Ee(ee.features[ae],Z);else if(Se==="GeometryCollection")for(ae=0;ae<ee.geometries.length;ae++)Ee(ee.geometries[ae],Z);else if(Se==="Feature")Ee(ee.geometry,Z);else if(Se==="Polygon")B(ee.coordinates,Z);else if(Se==="MultiPolygon")for(ae=0;ae<ee.coordinates.length;ae++)B(ee.coordinates[ae],Z);return ee});const N=a.bq.VectorTileFeature.prototype.toGeoJSON;var Q={exports:{}},q=a.bw,Y=a.bq.VectorTileFeature,te=pe;function pe(Ee,ee){this.options=ee||{},this.features=Ee,this.length=Ee.length}function ge(Ee,ee){this.id=typeof Ee.id=="number"?Ee.id:void 0,this.type=Ee.type,this.rawGeometry=Ee.type===1?[Ee.geometry]:Ee.geometry,this.properties=Ee.tags,this.extent=ee||4096}pe.prototype.feature=function(Ee){return new ge(this.features[Ee],this.options.extent)},ge.prototype.loadGeometry=function(){var Ee=this.rawGeometry;this.geometry=[];for(var ee=0;ee<Ee.length;ee++){for(var Z=Ee[ee],ae=[],Se=0;Se<Z.length;Se++)ae.push(new q(Z[Se][0],Z[Se][1]));this.geometry.push(ae)}return this.geometry},ge.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ee=this.geometry,ee=1/0,Z=-1/0,ae=1/0,Se=-1/0,Qe=0;Qe<Ee.length;Qe++)for(var Ge=Ee[Qe],Ke=0;Ke<Ge.length;Ke++){var Te=Ge[Ke];ee=Math.min(ee,Te.x),Z=Math.max(Z,Te.x),ae=Math.min(ae,Te.y),Se=Math.max(Se,Te.y)}return[ee,ae,Z,Se]},ge.prototype.toGeoJSON=Y.prototype.toGeoJSON;var ye=a.bx,fe=te;function Oe(Ee){var ee=new ye;return function(Z,ae){for(var Se in Z.layers)ae.writeMessage(3,Fe,Z.layers[Se])}(Ee,ee),ee.finish()}function Fe(Ee,ee){var Z;ee.writeVarintField(15,Ee.version||1),ee.writeStringField(1,Ee.name||""),ee.writeVarintField(5,Ee.extent||4096);var ae={keys:[],values:[],keycache:{},valuecache:{}};for(Z=0;Z<Ee.length;Z++)ae.feature=Ee.feature(Z),ee.writeMessage(2,oe,ae);var Se=ae.keys;for(Z=0;Z<Se.length;Z++)ee.writeStringField(3,Se[Z]);var Qe=ae.values;for(Z=0;Z<Qe.length;Z++)ee.writeMessage(4,et,Qe[Z])}function oe(Ee,ee){var Z=Ee.feature;Z.id!==void 0&&ee.writeVarintField(1,Z.id),ee.writeMessage(2,le,Ee),ee.writeVarintField(3,Z.type),ee.writeMessage(4,tt,Z)}function le(Ee,ee){var Z=Ee.feature,ae=Ee.keys,Se=Ee.values,Qe=Ee.keycache,Ge=Ee.valuecache;for(var Ke in Z.properties){var Te=Z.properties[Ke],Ze=Qe[Ke];if(Te!==null){Ze===void 0&&(ae.push(Ke),Qe[Ke]=Ze=ae.length-1),ee.writeVarint(Ze);var yt=typeof Te;yt!=="string"&&yt!=="boolean"&&yt!=="number"&&(Te=JSON.stringify(Te));var gt=yt+":"+Te,ft=Ge[gt];ft===void 0&&(Se.push(Te),Ge[gt]=ft=Se.length-1),ee.writeVarint(ft)}}}function xe(Ee,ee){return(ee<<3)+(7&Ee)}function _e(Ee){return Ee<<1^Ee>>31}function tt(Ee,ee){for(var Z=Ee.loadGeometry(),ae=Ee.type,Se=0,Qe=0,Ge=Z.length,Ke=0;Ke<Ge;Ke++){var Te=Z[Ke],Ze=1;ae===1&&(Ze=Te.length),ee.writeVarint(xe(1,Ze));for(var yt=ae===3?Te.length-1:Te.length,gt=0;gt<yt;gt++){gt===1&&ae!==1&&ee.writeVarint(xe(2,yt-1));var ft=Te[gt].x-Se,Vt=Te[gt].y-Qe;ee.writeVarint(_e(ft)),ee.writeVarint(_e(Vt)),Se+=ft,Qe+=Vt}ae===3&&ee.writeVarint(xe(7,1))}}function et(Ee,ee){var Z=typeof Ee;Z==="string"?ee.writeStringField(1,Ee):Z==="boolean"?ee.writeBooleanField(7,Ee):Z==="number"&&(Ee%1!=0?ee.writeDoubleField(3,Ee):Ee<0?ee.writeSVarintField(6,Ee):ee.writeVarintField(5,Ee))}Q.exports=Oe,Q.exports.fromVectorTileJs=Oe,Q.exports.fromGeojsonVt=function(Ee,ee){ee=ee||{};var Z={};for(var ae in Ee)Z[ae]=new fe(Ee[ae].features,ee),Z[ae].name=ae,Z[ae].version=ee.version,Z[ae].extent=ee.extent;return Oe({layers:Z})},Q.exports.GeoJSONWrapper=fe;var nt=a.bv(Q.exports);const Je={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ee=>Ee},it=Math.fround||(ot=new Float32Array(1),Ee=>(ot[0]=+Ee,ot[0]));var ot;const xt=3,se=5,be=6;class Me{constructor(ee){this.options=Object.assign(Object.create(Je),ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ee){const{log:Z,minZoom:ae,maxZoom:Se}=this.options;Z&&console.time("total time");const Qe=`prepare ${ee.length} points`;Z&&console.time(Qe),this.points=ee;const Ge=[];for(let Te=0;Te<ee.length;Te++){const Ze=ee[Te];if(!Ze.geometry)continue;const[yt,gt]=Ze.geometry.coordinates,ft=it(qe(yt)),Vt=it(ct(gt));Ge.push(ft,Vt,1/0,Te,-1,1),this.options.reduce&&Ge.push(0)}let Ke=this.trees[Se+1]=this._createTree(Ge);Z&&console.timeEnd(Qe);for(let Te=Se;Te>=ae;Te--){const Ze=+Date.now();Ke=this.trees[Te]=this._createTree(this._cluster(Ke,Te)),Z&&console.log("z%d: %d clusters in %dms",Te,Ke.numItems,+Date.now()-Ze)}return Z&&console.timeEnd("total time"),this}getClusters(ee,Z){let ae=((ee[0]+180)%360+360)%360-180;const Se=Math.max(-90,Math.min(90,ee[1]));let Qe=ee[2]===180?180:((ee[2]+180)%360+360)%360-180;const Ge=Math.max(-90,Math.min(90,ee[3]));if(ee[2]-ee[0]>=360)ae=-180,Qe=180;else if(ae>Qe){const gt=this.getClusters([ae,Se,180,Ge],Z),ft=this.getClusters([-180,Se,Qe,Ge],Z);return gt.concat(ft)}const Ke=this.trees[this._limitZoom(Z)],Te=Ke.range(qe(ae),ct(Ge),qe(Qe),ct(Se)),Ze=Ke.data,yt=[];for(const gt of Te){const ft=this.stride*gt;yt.push(Ze[ft+se]>1?De(Ze,ft,this.clusterProps):this.points[Ze[ft+xt]])}return yt}getChildren(ee){const Z=this._getOriginId(ee),ae=this._getOriginZoom(ee),Se="No cluster with the specified id.",Qe=this.trees[ae];if(!Qe)throw new Error(Se);const Ge=Qe.data;if(Z*this.stride>=Ge.length)throw new Error(Se);const Ke=this.options.radius/(this.options.extent*Math.pow(2,ae-1)),Te=Qe.within(Ge[Z*this.stride],Ge[Z*this.stride+1],Ke),Ze=[];for(const yt of Te){const gt=yt*this.stride;Ge[gt+4]===ee&&Ze.push(Ge[gt+se]>1?De(Ge,gt,this.clusterProps):this.points[Ge[gt+xt]])}if(Ze.length===0)throw new Error(Se);return Ze}getLeaves(ee,Z,ae){const Se=[];return this._appendLeaves(Se,ee,Z=Z||10,ae=ae||0,0),Se}getTile(ee,Z,ae){const Se=this.trees[this._limitZoom(ee)],Qe=Math.pow(2,ee),{extent:Ge,radius:Ke}=this.options,Te=Ke/Ge,Ze=(ae-Te)/Qe,yt=(ae+1+Te)/Qe,gt={features:[]};return this._addTileFeatures(Se.range((Z-Te)/Qe,Ze,(Z+1+Te)/Qe,yt),Se.data,Z,ae,Qe,gt),Z===0&&this._addTileFeatures(Se.range(1-Te/Qe,Ze,1,yt),Se.data,Qe,ae,Qe,gt),Z===Qe-1&&this._addTileFeatures(Se.range(0,Ze,Te/Qe,yt),Se.data,-1,ae,Qe,gt),gt.features.length?gt:null}getClusterExpansionZoom(ee){let Z=this._getOriginZoom(ee)-1;for(;Z<=this.options.maxZoom;){const ae=this.getChildren(ee);if(Z++,ae.length!==1)break;ee=ae[0].properties.cluster_id}return Z}_appendLeaves(ee,Z,ae,Se,Qe){const Ge=this.getChildren(Z);for(const Ke of Ge){const Te=Ke.properties;if(Te&&Te.cluster?Qe+Te.point_count<=Se?Qe+=Te.point_count:Qe=this._appendLeaves(ee,Te.cluster_id,ae,Se,Qe):Qe<Se?Qe++:ee.push(Ke),ee.length===ae)break}return Qe}_createTree(ee){const Z=new a.au(ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ae=0;ae<ee.length;ae+=this.stride)Z.add(ee[ae],ee[ae+1]);return Z.finish(),Z.data=ee,Z}_addTileFeatures(ee,Z,ae,Se,Qe,Ge){for(const Ke of ee){const Te=Ke*this.stride,Ze=Z[Te+se]>1;let yt,gt,ft;if(Ze)yt=$e(Z,Te,this.clusterProps),gt=Z[Te],ft=Z[Te+1];else{const Er=this.points[Z[Te+xt]];yt=Er.properties;const[lr,Ur]=Er.geometry.coordinates;gt=qe(lr),ft=ct(Ur)}const Vt={type:1,geometry:[[Math.round(this.options.extent*(gt*Qe-ae)),Math.round(this.options.extent*(ft*Qe-Se))]],tags:yt};let Yt;Yt=Ze||this.options.generateId?Z[Te+xt]:this.points[Z[Te+xt]].id,Yt!==void 0&&(Vt.id=Yt),Ge.features.push(Vt)}}_limitZoom(ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+ee),this.options.maxZoom+1))}_cluster(ee,Z){const{radius:ae,extent:Se,reduce:Qe,minPoints:Ge}=this.options,Ke=ae/(Se*Math.pow(2,Z)),Te=ee.data,Ze=[],yt=this.stride;for(let gt=0;gt<Te.length;gt+=yt){if(Te[gt+2]<=Z)continue;Te[gt+2]=Z;const ft=Te[gt],Vt=Te[gt+1],Yt=ee.within(Te[gt],Te[gt+1],Ke),Er=Te[gt+se];let lr=Er;for(const Ur of Yt){const Nr=Ur*yt;Te[Nr+2]>Z&&(lr+=Te[Nr+se])}if(lr>Er&&lr>=Ge){let Ur,Nr=ft*Er,Hr=Vt*Er,mn=-1;const mr=((gt/yt|0)<<5)+(Z+1)+this.points.length;for(const $r of Yt){const bn=$r*yt;if(Te[bn+2]<=Z)continue;Te[bn+2]=Z;const kn=Te[bn+se];Nr+=Te[bn]*kn,Hr+=Te[bn+1]*kn,Te[bn+4]=mr,Qe&&(Ur||(Ur=this._map(Te,gt,!0),mn=this.clusterProps.length,this.clusterProps.push(Ur)),Qe(Ur,this._map(Te,bn)))}Te[gt+4]=mr,Ze.push(Nr/lr,Hr/lr,1/0,mr,-1,lr),Qe&&Ze.push(mn)}else{for(let Ur=0;Ur<yt;Ur++)Ze.push(Te[gt+Ur]);if(lr>1)for(const Ur of Yt){const Nr=Ur*yt;if(!(Te[Nr+2]<=Z)){Te[Nr+2]=Z;for(let Hr=0;Hr<yt;Hr++)Ze.push(Te[Nr+Hr])}}}}return Ze}_getOriginId(ee){return ee-this.points.length>>5}_getOriginZoom(ee){return(ee-this.points.length)%32}_map(ee,Z,ae){if(ee[Z+se]>1){const Ge=this.clusterProps[ee[Z+be]];return ae?Object.assign({},Ge):Ge}const Se=this.points[ee[Z+xt]].properties,Qe=this.options.map(Se);return ae&&Qe===Se?Object.assign({},Qe):Qe}}function De(Ee,ee,Z){return{type:"Feature",id:Ee[ee+xt],properties:$e(Ee,ee,Z),geometry:{type:"Point",coordinates:[(ae=Ee[ee],360*(ae-.5)),st(Ee[ee+1])]}};var ae}function $e(Ee,ee,Z){const ae=Ee[ee+se],Se=ae>=1e4?`${Math.round(ae/1e3)}k`:ae>=1e3?Math.round(ae/100)/10+"k":ae,Qe=Ee[ee+be],Ge=Qe===-1?{}:Object.assign({},Z[Qe]);return Object.assign(Ge,{cluster:!0,cluster_id:Ee[ee+xt],point_count:ae,point_count_abbreviated:Se})}function qe(Ee){return Ee/360+.5}function ct(Ee){const ee=Math.sin(Ee*Math.PI/180),Z=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return Z<0?0:Z>1?1:Z}function st(Ee){const ee=(180-360*Ee)*Math.PI/180;return 360*Math.atan(Math.exp(ee))/Math.PI-90}function Ct(Ee,ee,Z,ae){for(var Se,Qe=ae,Ge=Z-ee>>1,Ke=Z-ee,Te=Ee[ee],Ze=Ee[ee+1],yt=Ee[Z],gt=Ee[Z+1],ft=ee+3;ft<Z;ft+=3){var Vt=It(Ee[ft],Ee[ft+1],Te,Ze,yt,gt);if(Vt>Qe)Se=ft,Qe=Vt;else if(Vt===Qe){var Yt=Math.abs(ft-Ge);Yt<Ke&&(Se=ft,Ke=Yt)}}Qe>ae&&(Se-ee>3&&Ct(Ee,ee,Se,ae),Ee[Se+2]=Qe,Z-Se>3&&Ct(Ee,Se,Z,ae))}function It(Ee,ee,Z,ae,Se,Qe){var Ge=Se-Z,Ke=Qe-ae;if(Ge!==0||Ke!==0){var Te=((Ee-Z)*Ge+(ee-ae)*Ke)/(Ge*Ge+Ke*Ke);Te>1?(Z=Se,ae=Qe):Te>0&&(Z+=Ge*Te,ae+=Ke*Te)}return(Ge=Ee-Z)*Ge+(Ke=ee-ae)*Ke}function Qt(Ee,ee,Z,ae){var Se={id:Ee===void 0?null:Ee,type:ee,geometry:Z,tags:ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Qe){var Ge=Qe.geometry,Ke=Qe.type;if(Ke==="Point"||Ke==="MultiPoint"||Ke==="LineString")Ht(Qe,Ge);else if(Ke==="Polygon"||Ke==="MultiLineString")for(var Te=0;Te<Ge.length;Te++)Ht(Qe,Ge[Te]);else if(Ke==="MultiPolygon")for(Te=0;Te<Ge.length;Te++)for(var Ze=0;Ze<Ge[Te].length;Ze++)Ht(Qe,Ge[Te][Ze])}(Se),Se}function Ht(Ee,ee){for(var Z=0;Z<ee.length;Z+=3)Ee.minX=Math.min(Ee.minX,ee[Z]),Ee.minY=Math.min(Ee.minY,ee[Z+1]),Ee.maxX=Math.max(Ee.maxX,ee[Z]),Ee.maxY=Math.max(Ee.maxY,ee[Z+1])}function zt(Ee,ee,Z,ae){if(ee.geometry){var Se=ee.geometry.coordinates,Qe=ee.geometry.type,Ge=Math.pow(Z.tolerance/((1<<Z.maxZoom)*Z.extent),2),Ke=[],Te=ee.id;if(Z.promoteId?Te=ee.properties[Z.promoteId]:Z.generateId&&(Te=ae||0),Qe==="Point")mt(Se,Ke);else if(Qe==="MultiPoint")for(var Ze=0;Ze<Se.length;Ze++)mt(Se[Ze],Ke);else if(Qe==="LineString")Re(Se,Ke,Ge,!1);else if(Qe==="MultiLineString"){if(Z.lineMetrics){for(Ze=0;Ze<Se.length;Ze++)Re(Se[Ze],Ke=[],Ge,!1),Ee.push(Qt(Te,"LineString",Ke,ee.properties));return}Ye(Se,Ke,Ge,!1)}else if(Qe==="Polygon")Ye(Se,Ke,Ge,!0);else{if(Qe!=="MultiPolygon"){if(Qe==="GeometryCollection"){for(Ze=0;Ze<ee.geometry.geometries.length;Ze++)zt(Ee,{id:Te,geometry:ee.geometry.geometries[Ze],properties:ee.properties},Z,ae);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ze=0;Ze<Se.length;Ze++){var yt=[];Ye(Se[Ze],yt,Ge,!0),Ke.push(yt)}}Ee.push(Qt(Te,Qe,Ke,ee.properties))}}function mt(Ee,ee){ee.push(tr(Ee[0])),ee.push(St(Ee[1])),ee.push(0)}function Re(Ee,ee,Z,ae){for(var Se,Qe,Ge=0,Ke=0;Ke<Ee.length;Ke++){var Te=tr(Ee[Ke][0]),Ze=St(Ee[Ke][1]);ee.push(Te),ee.push(Ze),ee.push(0),Ke>0&&(Ge+=ae?(Se*Ze-Te*Qe)/2:Math.sqrt(Math.pow(Te-Se,2)+Math.pow(Ze-Qe,2))),Se=Te,Qe=Ze}var yt=ee.length-3;ee[2]=1,Ct(ee,0,yt,Z),ee[yt+2]=1,ee.size=Math.abs(Ge),ee.start=0,ee.end=ee.size}function Ye(Ee,ee,Z,ae){for(var Se=0;Se<Ee.length;Se++){var Qe=[];Re(Ee[Se],Qe,Z,ae),ee.push(Qe)}}function tr(Ee){return Ee/360+.5}function St(Ee){var ee=Math.sin(Ee*Math.PI/180),Z=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return Z<0?0:Z>1?1:Z}function vt(Ee,ee,Z,ae,Se,Qe,Ge,Ke){if(ae/=ee,Qe>=(Z/=ee)&&Ge<ae)return Ee;if(Ge<Z||Qe>=ae)return null;for(var Te=[],Ze=0;Ze<Ee.length;Ze++){var yt=Ee[Ze],gt=yt.geometry,ft=yt.type,Vt=Se===0?yt.minX:yt.minY,Yt=Se===0?yt.maxX:yt.maxY;if(Vt>=Z&&Yt<ae)Te.push(yt);else if(!(Yt<Z||Vt>=ae)){var Er=[];if(ft==="Point"||ft==="MultiPoint")Bt(gt,Er,Z,ae,Se);else if(ft==="LineString")kt(gt,Er,Z,ae,Se,!1,Ke.lineMetrics);else if(ft==="MultiLineString")Ar(gt,Er,Z,ae,Se,!1);else if(ft==="Polygon")Ar(gt,Er,Z,ae,Se,!0);else if(ft==="MultiPolygon")for(var lr=0;lr<gt.length;lr++){var Ur=[];Ar(gt[lr],Ur,Z,ae,Se,!0),Ur.length&&Er.push(Ur)}if(Er.length){if(Ke.lineMetrics&&ft==="LineString"){for(lr=0;lr<Er.length;lr++)Te.push(Qt(yt.id,ft,Er[lr],yt.tags));continue}ft!=="LineString"&&ft!=="MultiLineString"||(Er.length===1?(ft="LineString",Er=Er[0]):ft="MultiLineString"),ft!=="Point"&&ft!=="MultiPoint"||(ft=Er.length===3?"Point":"MultiPoint"),Te.push(Qt(yt.id,ft,Er,yt.tags))}}}return Te.length?Te:null}function Bt(Ee,ee,Z,ae,Se){for(var Qe=0;Qe<Ee.length;Qe+=3){var Ge=Ee[Qe+Se];Ge>=Z&&Ge<=ae&&(ee.push(Ee[Qe]),ee.push(Ee[Qe+1]),ee.push(Ee[Qe+2]))}}function kt(Ee,ee,Z,ae,Se,Qe,Ge){for(var Ke,Te,Ze=ir(Ee),yt=Se===0?Tr:kr,gt=Ee.start,ft=0;ft<Ee.length-3;ft+=3){var Vt=Ee[ft],Yt=Ee[ft+1],Er=Ee[ft+2],lr=Ee[ft+3],Ur=Ee[ft+4],Nr=Se===0?Vt:Yt,Hr=Se===0?lr:Ur,mn=!1;Ge&&(Ke=Math.sqrt(Math.pow(Vt-lr,2)+Math.pow(Yt-Ur,2))),Nr<Z?Hr>Z&&(Te=yt(Ze,Vt,Yt,lr,Ur,Z),Ge&&(Ze.start=gt+Ke*Te)):Nr>ae?Hr<ae&&(Te=yt(Ze,Vt,Yt,lr,Ur,ae),Ge&&(Ze.start=gt+Ke*Te)):Lr(Ze,Vt,Yt,Er),Hr<Z&&Nr>=Z&&(Te=yt(Ze,Vt,Yt,lr,Ur,Z),mn=!0),Hr>ae&&Nr<=ae&&(Te=yt(Ze,Vt,Yt,lr,Ur,ae),mn=!0),!Qe&&mn&&(Ge&&(Ze.end=gt+Ke*Te),ee.push(Ze),Ze=ir(Ee)),Ge&&(gt+=Ke)}var mr=Ee.length-3;Vt=Ee[mr],Yt=Ee[mr+1],Er=Ee[mr+2],(Nr=Se===0?Vt:Yt)>=Z&&Nr<=ae&&Lr(Ze,Vt,Yt,Er),mr=Ze.length-3,Qe&&mr>=3&&(Ze[mr]!==Ze[0]||Ze[mr+1]!==Ze[1])&&Lr(Ze,Ze[0],Ze[1],Ze[2]),Ze.length&&ee.push(Ze)}function ir(Ee){var ee=[];return ee.size=Ee.size,ee.start=Ee.start,ee.end=Ee.end,ee}function Ar(Ee,ee,Z,ae,Se,Qe){for(var Ge=0;Ge<Ee.length;Ge++)kt(Ee[Ge],ee,Z,ae,Se,Qe,!1)}function Lr(Ee,ee,Z,ae){Ee.push(ee),Ee.push(Z),Ee.push(ae)}function Tr(Ee,ee,Z,ae,Se,Qe){var Ge=(Qe-ee)/(ae-ee);return Ee.push(Qe),Ee.push(Z+(Se-Z)*Ge),Ee.push(1),Ge}function kr(Ee,ee,Z,ae,Se,Qe){var Ge=(Qe-Z)/(Se-Z);return Ee.push(ee+(ae-ee)*Ge),Ee.push(Qe),Ee.push(1),Ge}function Qr(Ee,ee){for(var Z=[],ae=0;ae<Ee.length;ae++){var Se,Qe=Ee[ae],Ge=Qe.type;if(Ge==="Point"||Ge==="MultiPoint"||Ge==="LineString")Se=pt(Qe.geometry,ee);else if(Ge==="MultiLineString"||Ge==="Polygon"){Se=[];for(var Ke=0;Ke<Qe.geometry.length;Ke++)Se.push(pt(Qe.geometry[Ke],ee))}else if(Ge==="MultiPolygon")for(Se=[],Ke=0;Ke<Qe.geometry.length;Ke++){for(var Te=[],Ze=0;Ze<Qe.geometry[Ke].length;Ze++)Te.push(pt(Qe.geometry[Ke][Ze],ee));Se.push(Te)}Z.push(Qt(Qe.id,Ge,Se,Qe.tags))}return Z}function pt(Ee,ee){var Z=[];Z.size=Ee.size,Ee.start!==void 0&&(Z.start=Ee.start,Z.end=Ee.end);for(var ae=0;ae<Ee.length;ae+=3)Z.push(Ee[ae]+ee,Ee[ae+1],Ee[ae+2]);return Z}function Ir(Ee,ee){if(Ee.transformed)return Ee;var Z,ae,Se,Qe=1<<Ee.z,Ge=Ee.x,Ke=Ee.y;for(Z=0;Z<Ee.features.length;Z++){var Te=Ee.features[Z],Ze=Te.geometry,yt=Te.type;if(Te.geometry=[],yt===1)for(ae=0;ae<Ze.length;ae+=2)Te.geometry.push(Dt(Ze[ae],Ze[ae+1],ee,Qe,Ge,Ke));else for(ae=0;ae<Ze.length;ae++){var gt=[];for(Se=0;Se<Ze[ae].length;Se+=2)gt.push(Dt(Ze[ae][Se],Ze[ae][Se+1],ee,Qe,Ge,Ke));Te.geometry.push(gt)}}return Ee.transformed=!0,Ee}function Dt(Ee,ee,Z,ae,Se,Qe){return[Math.round(Z*(Ee*ae-Se)),Math.round(Z*(ee*ae-Qe))]}function xn(Ee,ee,Z,ae,Se){for(var Qe=ee===Se.maxZoom?0:Se.tolerance/((1<<ee)*Se.extent),Ge={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Z,y:ae,z:ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ke=0;Ke<Ee.length;Ke++){Ge.numFeatures++,Mr(Ge,Ee[Ke],Qe,Se);var Te=Ee[Ke].minX,Ze=Ee[Ke].minY,yt=Ee[Ke].maxX,gt=Ee[Ke].maxY;Te<Ge.minX&&(Ge.minX=Te),Ze<Ge.minY&&(Ge.minY=Ze),yt>Ge.maxX&&(Ge.maxX=yt),gt>Ge.maxY&&(Ge.maxY=gt)}return Ge}function Mr(Ee,ee,Z,ae){var Se=ee.geometry,Qe=ee.type,Ge=[];if(Qe==="Point"||Qe==="MultiPoint")for(var Ke=0;Ke<Se.length;Ke+=3)Ge.push(Se[Ke]),Ge.push(Se[Ke+1]),Ee.numPoints++,Ee.numSimplified++;else if(Qe==="LineString")Tt(Ge,Se,Ee,Z,!1,!1);else if(Qe==="MultiLineString"||Qe==="Polygon")for(Ke=0;Ke<Se.length;Ke++)Tt(Ge,Se[Ke],Ee,Z,Qe==="Polygon",Ke===0);else if(Qe==="MultiPolygon")for(var Te=0;Te<Se.length;Te++){var Ze=Se[Te];for(Ke=0;Ke<Ze.length;Ke++)Tt(Ge,Ze[Ke],Ee,Z,!0,Ke===0)}if(Ge.length){var yt=ee.tags||null;if(Qe==="LineString"&&ae.lineMetrics){for(var gt in yt={},ee.tags)yt[gt]=ee.tags[gt];yt.mapbox_clip_start=Se.start/Se.size,yt.mapbox_clip_end=Se.end/Se.size}var ft={geometry:Ge,type:Qe==="Polygon"||Qe==="MultiPolygon"?3:Qe==="LineString"||Qe==="MultiLineString"?2:1,tags:yt};ee.id!==null&&(ft.id=ee.id),Ee.features.push(ft)}}function Tt(Ee,ee,Z,ae,Se,Qe){var Ge=ae*ae;if(ae>0&&ee.size<(Se?Ge:ae))Z.numPoints+=ee.length/3;else{for(var Ke=[],Te=0;Te<ee.length;Te+=3)(ae===0||ee[Te+2]>Ge)&&(Z.numSimplified++,Ke.push(ee[Te]),Ke.push(ee[Te+1])),Z.numPoints++;Se&&function(Ze,yt){for(var gt=0,ft=0,Vt=Ze.length,Yt=Vt-2;ft<Vt;Yt=ft,ft+=2)gt+=(Ze[ft]-Ze[Yt])*(Ze[ft+1]+Ze[Yt+1]);if(gt>0===yt)for(ft=0,Vt=Ze.length;ft<Vt/2;ft+=2){var Er=Ze[ft],lr=Ze[ft+1];Ze[ft]=Ze[Vt-2-ft],Ze[ft+1]=Ze[Vt-1-ft],Ze[Vt-2-ft]=Er,Ze[Vt-1-ft]=lr}}(Ke,Qe),Ee.push(Ke)}}function Jt(Ee,ee){var Z=(ee=this.options=function(Se,Qe){for(var Ge in Qe)Se[Ge]=Qe[Ge];return Se}(Object.create(this.options),ee)).debug;if(Z&&console.time("preprocess data"),ee.maxZoom<0||ee.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ee.promoteId&&ee.generateId)throw new Error("promoteId and generateId cannot be used together.");var ae=function(Se,Qe){var Ge=[];if(Se.type==="FeatureCollection")for(var Ke=0;Ke<Se.features.length;Ke++)zt(Ge,Se.features[Ke],Qe,Ke);else zt(Ge,Se.type==="Feature"?Se:{geometry:Se},Qe);return Ge}(Ee,ee);this.tiles={},this.tileCoords=[],Z&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ee.indexMaxZoom,ee.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ae=function(Se,Qe){var Ge=Qe.buffer/Qe.extent,Ke=Se,Te=vt(Se,1,-1-Ge,Ge,0,-1,2,Qe),Ze=vt(Se,1,1-Ge,2+Ge,0,-1,2,Qe);return(Te||Ze)&&(Ke=vt(Se,1,-Ge,1+Ge,0,-1,2,Qe)||[],Te&&(Ke=Qr(Te,1).concat(Ke)),Ze&&(Ke=Ke.concat(Qr(Ze,-1)))),Ke}(ae,ee),ae.length&&this.splitTile(ae,0,0,0),Z&&(ae.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Kt(Ee,ee,Z){return 32*((1<<Ee)*Z+ee)+Ee}function Yr(Ee,ee){return ee?Ee.properties[ee]:Ee.id}function Or(Ee,ee){if(Ee==null)return!0;if(Ee.type==="Feature")return Yr(Ee,ee)!=null;if(Ee.type==="FeatureCollection"){const Z=new Set;for(const ae of Ee.features){const Se=Yr(ae,ee);if(Se==null||Z.has(Se))return!1;Z.add(Se)}return!0}return!1}function gr(Ee,ee){const Z=new Map;if(Ee!=null)if(Ee.type==="Feature")Z.set(Yr(Ee,ee),Ee);else for(const ae of Ee.features)Z.set(Yr(ae,ee),ae);return Z}Jt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Jt.prototype.splitTile=function(Ee,ee,Z,ae,Se,Qe,Ge){for(var Ke=[Ee,ee,Z,ae],Te=this.options,Ze=Te.debug;Ke.length;){ae=Ke.pop(),Z=Ke.pop(),ee=Ke.pop(),Ee=Ke.pop();var yt=1<<ee,gt=Kt(ee,Z,ae),ft=this.tiles[gt];if(!ft&&(Ze>1&&console.time("creation"),ft=this.tiles[gt]=xn(Ee,ee,Z,ae,Te),this.tileCoords.push({z:ee,x:Z,y:ae}),Ze)){Ze>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ee,Z,ae,ft.numFeatures,ft.numPoints,ft.numSimplified),console.timeEnd("creation"));var Vt="z"+ee;this.stats[Vt]=(this.stats[Vt]||0)+1,this.total++}if(ft.source=Ee,Se){if(ee===Te.maxZoom||ee===Se)continue;var Yt=1<<Se-ee;if(Z!==Math.floor(Qe/Yt)||ae!==Math.floor(Ge/Yt))continue}else if(ee===Te.indexMaxZoom||ft.numPoints<=Te.indexMaxPoints)continue;if(ft.source=null,Ee.length!==0){Ze>1&&console.time("clipping");var Er,lr,Ur,Nr,Hr,mn,mr=.5*Te.buffer/Te.extent,$r=.5-mr,bn=.5+mr,kn=1+mr;Er=lr=Ur=Nr=null,Hr=vt(Ee,yt,Z-mr,Z+bn,0,ft.minX,ft.maxX,Te),mn=vt(Ee,yt,Z+$r,Z+kn,0,ft.minX,ft.maxX,Te),Ee=null,Hr&&(Er=vt(Hr,yt,ae-mr,ae+bn,1,ft.minY,ft.maxY,Te),lr=vt(Hr,yt,ae+$r,ae+kn,1,ft.minY,ft.maxY,Te),Hr=null),mn&&(Ur=vt(mn,yt,ae-mr,ae+bn,1,ft.minY,ft.maxY,Te),Nr=vt(mn,yt,ae+$r,ae+kn,1,ft.minY,ft.maxY,Te),mn=null),Ze>1&&console.timeEnd("clipping"),Ke.push(Er||[],ee+1,2*Z,2*ae),Ke.push(lr||[],ee+1,2*Z,2*ae+1),Ke.push(Ur||[],ee+1,2*Z+1,2*ae),Ke.push(Nr||[],ee+1,2*Z+1,2*ae+1)}}},Jt.prototype.getTile=function(Ee,ee,Z){var ae=this.options,Se=ae.extent,Qe=ae.debug;if(Ee<0||Ee>24)return null;var Ge=1<<Ee,Ke=Kt(Ee,ee=(ee%Ge+Ge)%Ge,Z);if(this.tiles[Ke])return Ir(this.tiles[Ke],Se);Qe>1&&console.log("drilling down to z%d-%d-%d",Ee,ee,Z);for(var Te,Ze=Ee,yt=ee,gt=Z;!Te&&Ze>0;)Ze--,yt=Math.floor(yt/2),gt=Math.floor(gt/2),Te=this.tiles[Kt(Ze,yt,gt)];return Te&&Te.source?(Qe>1&&console.log("found parent tile z%d-%d-%d",Ze,yt,gt),Qe>1&&console.time("drilling down"),this.splitTile(Te.source,Ze,yt,gt,Ee,ee,Z),Qe>1&&console.timeEnd("drilling down"),this.tiles[Ke]?Ir(this.tiles[Ke],Se):null):null};class an extends v{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ee,Z){return a._(this,void 0,void 0,function*(){const ae=ee.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Se=this._geoJSONIndex.getTile(ae.z,ae.x,ae.y);if(!Se)return null;const Qe=new class{constructor(Ke){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.W,this.length=Ke.length,this._features=Ke}feature(Ke){return new class{constructor(Te){this._feature=Te,this.extent=a.W,this.type=Te.type,this.properties=Te.tags,"id"in Te&&!isNaN(Te.id)&&(this.id=parseInt(Te.id,10))}loadGeometry(){if(this._feature.type===1){const Te=[];for(const Ze of this._feature.geometry)Te.push([new a.P(Ze[0],Ze[1])]);return Te}{const Te=[];for(const Ze of this._feature.geometry){const yt=[];for(const gt of Ze)yt.push(new a.P(gt[0],gt[1]));Te.push(yt)}return Te}}toGeoJSON(Te,Ze,yt){return N.call(this,Te,Ze,yt)}}(this._features[Ke])}}(Se.features);let Ge=nt(Qe);return Ge.byteOffset===0&&Ge.byteLength===Ge.buffer.byteLength||(Ge=new Uint8Array(Ge)),{vectorTile:Qe,rawData:Ge.buffer}})}loadData(ee){return a._(this,void 0,void 0,function*(){var Z;(Z=this._pendingRequest)===null||Z===void 0||Z.abort();const ae=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new a.bs(ee.request);this._pendingRequest=new AbortController;try{let Se=yield this.loadGeoJSON(ee,this._pendingRequest);if(delete this._pendingRequest,typeof Se!="object")throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(U(Se,!0),ee.filter){const Ge=a.by(ee.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ge.result==="error")throw new Error(Ge.value.map(Te=>`${Te.key}: ${Te.message}`).join(", "));Se={type:"FeatureCollection",features:Se.features.filter(Te=>Ge.value.evaluate({zoom:0},Te))}}this._geoJSONIndex=ee.cluster?new Me(function(Ge){let{superclusterOptions:Ke,clusterProperties:Te}=Ge;if(!Te||!Ke)return Ke;const Ze={},yt={},gt={accumulated:null,zoom:0},ft={properties:null},Vt=Object.keys(Te);for(const Yt of Vt){const[Er,lr]=Te[Yt],Ur=a.by(lr),Nr=a.by(typeof Er=="string"?[Er,["accumulated"],["get",Yt]]:Er);Ze[Yt]=Ur.value,yt[Yt]=Nr.value}return Ke.map=Yt=>{ft.properties=Yt;const Er={};for(const lr of Vt)Er[lr]=Ze[lr].evaluate(gt,ft);return Er},Ke.reduce=(Yt,Er)=>{ft.properties=Er;for(const lr of Vt)gt.accumulated=Yt[lr],Yt[lr]=yt[lr].evaluate(gt,ft)},Ke}(ee)).load(Se.features):function(Ge,Ke){return new Jt(Ge,Ke)}(Se,ee.geojsonVtOptions),this.loaded={};const Qe={};if(ae){const Ge=ae.finish();Ge&&(Qe.resourceTiming={},Qe.resourceTiming[ee.source]=JSON.parse(JSON.stringify(Ge)))}return Qe}catch(Se){if(delete this._pendingRequest,a.bz(Se))return{abandoned:!0};throw Se}})}reloadTile(ee){const Z=this.loaded;return Z&&Z[ee.uid]?super.reloadTile(ee):this.loadTile(ee)}loadGeoJSON(ee,Z){return a._(this,void 0,void 0,function*(){const{promoteId:ae}=ee;if(ee.request){const Se=yield a.h(ee.request,Z);return this._dataUpdateable=Or(Se.data,ae)?gr(Se.data,ae):void 0,Se.data}if(typeof ee.data=="string")try{const Se=JSON.parse(ee.data);return this._dataUpdateable=Or(Se,ae)?gr(Se,ae):void 0,Se}catch{throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`)}if(!ee.dataDiff)throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ee.source}`);return function(Se,Qe,Ge){var Ke,Te,Ze,yt;if(Qe.removeAll&&Se.clear(),Qe.remove)for(const gt of Qe.remove)Se.delete(gt);if(Qe.add)for(const gt of Qe.add){const ft=Yr(gt,Ge);ft!=null&&Se.set(ft,gt)}if(Qe.update)for(const gt of Qe.update){let ft=Se.get(gt.id);if(ft==null)continue;const Vt=!gt.removeAllProperties&&(((Ke=gt.removeProperties)===null||Ke===void 0?void 0:Ke.length)>0||((Te=gt.addOrUpdateProperties)===null||Te===void 0?void 0:Te.length)>0);if((gt.newGeometry||gt.removeAllProperties||Vt)&&(ft=Object.assign({},ft),Se.set(gt.id,ft),Vt&&(ft.properties=Object.assign({},ft.properties))),gt.newGeometry&&(ft.geometry=gt.newGeometry),gt.removeAllProperties)ft.properties={};else if(((Ze=gt.removeProperties)===null||Ze===void 0?void 0:Ze.length)>0)for(const Yt of gt.removeProperties)Object.prototype.hasOwnProperty.call(ft.properties,Yt)&&delete ft.properties[Yt];if(((yt=gt.addOrUpdateProperties)===null||yt===void 0?void 0:yt.length)>0)for(const{key:Yt,value:Er}of gt.addOrUpdateProperties)ft.properties[Yt]=Er}}(this._dataUpdateable,ee.dataDiff,ae),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ee){return a._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ee){return this._geoJSONIndex.getClusterExpansionZoom(ee.clusterId)}getClusterChildren(ee){return this._geoJSONIndex.getChildren(ee.clusterId)}getClusterLeaves(ee){return this._geoJSONIndex.getLeaves(ee.clusterId,ee.limit,ee.offset)}}class Wr{constructor(ee){this.self=ee,this.actor=new a.C(ee),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(Z,ae)=>{if(this.externalWorkerSourceTypes[Z])throw new Error(`Worker source with name "${Z}" already registered.`);this.externalWorkerSourceTypes[Z]=ae},this.self.addProtocol=a.bf,this.self.removeProtocol=a.bg,this.self.registerRTLTextPlugin=Z=>{if(a.bA.isParsed())throw new Error("RTL text plugin already registered.");a.bA.setMethods(Z)},this.actor.registerMessageHandler("LDT",(Z,ae)=>this._getDEMWorkerSource(Z,ae.source).loadTile(ae)),this.actor.registerMessageHandler("RDT",(Z,ae)=>a._(this,void 0,void 0,function*(){this._getDEMWorkerSource(Z,ae.source).removeTile(ae)})),this.actor.registerMessageHandler("GCEZ",(Z,ae)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(Z,ae.type,ae.source).getClusterExpansionZoom(ae)})),this.actor.registerMessageHandler("GCC",(Z,ae)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(Z,ae.type,ae.source).getClusterChildren(ae)})),this.actor.registerMessageHandler("GCL",(Z,ae)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(Z,ae.type,ae.source).getClusterLeaves(ae)})),this.actor.registerMessageHandler("LD",(Z,ae)=>this._getWorkerSource(Z,ae.type,ae.source).loadData(ae)),this.actor.registerMessageHandler("LT",(Z,ae)=>this._getWorkerSource(Z,ae.type,ae.source).loadTile(ae)),this.actor.registerMessageHandler("RT",(Z,ae)=>this._getWorkerSource(Z,ae.type,ae.source).reloadTile(ae)),this.actor.registerMessageHandler("AT",(Z,ae)=>this._getWorkerSource(Z,ae.type,ae.source).abortTile(ae)),this.actor.registerMessageHandler("RMT",(Z,ae)=>this._getWorkerSource(Z,ae.type,ae.source).removeTile(ae)),this.actor.registerMessageHandler("RS",(Z,ae)=>a._(this,void 0,void 0,function*(){if(!this.workerSources[Z]||!this.workerSources[Z][ae.type]||!this.workerSources[Z][ae.type][ae.source])return;const Se=this.workerSources[Z][ae.type][ae.source];delete this.workerSources[Z][ae.type][ae.source],Se.removeSource!==void 0&&Se.removeSource(ae)})),this.actor.registerMessageHandler("RM",Z=>a._(this,void 0,void 0,function*(){delete this.layerIndexes[Z],delete this.availableImages[Z],delete this.workerSources[Z],delete this.demWorkerSources[Z]})),this.actor.registerMessageHandler("SR",(Z,ae)=>a._(this,void 0,void 0,function*(){this.referrer=ae})),this.actor.registerMessageHandler("SRPS",(Z,ae)=>this._syncRTLPluginState(Z,ae)),this.actor.registerMessageHandler("IS",(Z,ae)=>a._(this,void 0,void 0,function*(){this.self.importScripts(ae)})),this.actor.registerMessageHandler("SI",(Z,ae)=>this._setImages(Z,ae)),this.actor.registerMessageHandler("UL",(Z,ae)=>a._(this,void 0,void 0,function*(){this._getLayerIndex(Z).update(ae.layers,ae.removedIds)})),this.actor.registerMessageHandler("SL",(Z,ae)=>a._(this,void 0,void 0,function*(){this._getLayerIndex(Z).replace(ae)}))}_setImages(ee,Z){return a._(this,void 0,void 0,function*(){this.availableImages[ee]=Z;for(const ae in this.workerSources[ee]){const Se=this.workerSources[ee][ae];for(const Qe in Se)Se[Qe].availableImages=Z}})}_syncRTLPluginState(ee,Z){return a._(this,void 0,void 0,function*(){if(a.bA.isParsed())return a.bA.getState();if(Z.pluginStatus!=="loading")return a.bA.setState(Z),Z;const ae=Z.pluginURL;if(this.self.importScripts(ae),a.bA.isParsed()){const Se={pluginStatus:"loaded",pluginURL:ae};return a.bA.setState(Se),Se}throw a.bA.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${ae}`)})}_getAvailableImages(ee){let Z=this.availableImages[ee];return Z||(Z=[]),Z}_getLayerIndex(ee){let Z=this.layerIndexes[ee];return Z||(Z=this.layerIndexes[ee]=new o),Z}_getWorkerSource(ee,Z,ae){if(this.workerSources[ee]||(this.workerSources[ee]={}),this.workerSources[ee][Z]||(this.workerSources[ee][Z]={}),!this.workerSources[ee][Z][ae]){const Se={sendAsync:(Qe,Ge)=>(Qe.targetMapId=ee,this.actor.sendAsync(Qe,Ge))};switch(Z){case"vector":this.workerSources[ee][Z][ae]=new v(Se,this._getLayerIndex(ee),this._getAvailableImages(ee));break;case"geojson":this.workerSources[ee][Z][ae]=new an(Se,this._getLayerIndex(ee),this._getAvailableImages(ee));break;default:this.workerSources[ee][Z][ae]=new this.externalWorkerSourceTypes[Z](Se,this._getLayerIndex(ee),this._getAvailableImages(ee))}}return this.workerSources[ee][Z][ae]}_getDEMWorkerSource(ee,Z){return this.demWorkerSources[ee]||(this.demWorkerSources[ee]={}),this.demWorkerSources[ee][Z]||(this.demWorkerSources[ee][Z]=new x),this.demWorkerSources[ee][Z]}}return a.i(self)&&(self.worker=new Wr(self)),Wr}),i("index",["exports","./shared"],function(a,o){var A="4.1.3";let f,m;const v={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:C=>new Promise((l,d)=>{const y=requestAnimationFrame(l);C.signal.addEventListener("abort",()=>{cancelAnimationFrame(y),d(o.c())})}),getImageData(C){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return this.getImageCanvasContext(C).getImageData(-l,-l,C.width+2*l,C.height+2*l)},getImageCanvasContext(C){const l=window.document.createElement("canvas"),d=l.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("failed to create canvas 2d context");return l.width=C.width,l.height=C.height,d.drawImage(C,0,0,C.width,C.height),d},resolveURL:C=>(f||(f=document.createElement("a")),f.href=C,f.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(m==null&&(m=matchMedia("(prefers-reduced-motion: reduce)")),m.matches)}};class x{static testProp(l){if(!x.docStyle)return l[0];for(let d=0;d<l.length;d++)if(l[d]in x.docStyle)return l[d];return l[0]}static create(l,d,y){const _=window.document.createElement(l);return d!==void 0&&(_.className=d),y&&y.appendChild(_),_}static createNS(l,d){return window.document.createElementNS(l,d)}static disableDrag(){x.docStyle&&x.selectProp&&(x.userSelect=x.docStyle[x.selectProp],x.docStyle[x.selectProp]="none")}static enableDrag(){x.docStyle&&x.selectProp&&(x.docStyle[x.selectProp]=x.userSelect)}static setTransform(l,d){l.style[x.transformProp]=d}static addEventListener(l,d,y){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};l.addEventListener(d,y,"passive"in _?_:_.capture)}static removeEventListener(l,d,y){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};l.removeEventListener(d,y,"passive"in _?_:_.capture)}static suppressClickInternal(l){l.preventDefault(),l.stopPropagation(),window.removeEventListener("click",x.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",x.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",x.suppressClickInternal,!0)},0)}static getScale(l){const d=l.getBoundingClientRect();return{x:d.width/l.offsetWidth||1,y:d.height/l.offsetHeight||1,boundingClientRect:d}}static getPoint(l,d,y){const _=d.boundingClientRect;return new o.P((y.clientX-_.left)/d.x-l.clientLeft,(y.clientY-_.top)/d.y-l.clientTop)}static mousePos(l,d){const y=x.getScale(l);return x.getPoint(l,y,d)}static touchPos(l,d){const y=[],_=x.getScale(l);for(let E=0;E<d.length;E++)y.push(x.getPoint(l,_,d[E]));return y}static mouseButton(l){return l.button}static remove(l){l.parentNode&&l.parentNode.removeChild(l)}}x.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,x.selectProp=x.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),x.transformProp=x.testProp(["transform","WebkitTransform"]);const B={supported:!1,testSupport:function(C){!N&&U&&(Q?q(C):M=C)}};let M,U,N=!1,Q=!1;function q(C){const l=C.createTexture();C.bindTexture(C.TEXTURE_2D,l);try{if(C.texImage2D(C.TEXTURE_2D,0,C.RGBA,C.RGBA,C.UNSIGNED_BYTE,U),C.isContextLost())return;B.supported=!0}catch{}C.deleteTexture(l),N=!0}var Y;typeof document<"u"&&(U=document.createElement("img"),U.onload=function(){M&&q(M),M=null,Q=!0},U.onerror=function(){N=!0,M=null},U.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(C){let l,d,y,_;C.resetRequestQueue=()=>{l=[],d=0,y=0,_={}},C.addThrottleControl=g=>{const w=y++;return _[w]=g,w},C.removeThrottleControl=g=>{delete _[g],P()},C.getImage=function(g,w){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return new Promise((L,D)=>{B.supported&&(g.headers||(g.headers={}),g.headers.accept="image/webp,*/*"),o.e(g,{type:"image"}),l.push({abortController:w,requestParameters:g,supportImageRefresh:T,state:"queued",onError:H=>{D(H)},onSuccess:H=>{L(H)}}),P()})};const E=g=>o._(this,void 0,void 0,function*(){g.state="running";const{requestParameters:w,supportImageRefresh:T,onError:L,onSuccess:D,abortController:H}=g,z=T===!1&&!o.i(self)&&!o.g(w.url)&&(!w.headers||Object.keys(w.headers).reduce((X,ue)=>X&&ue==="accept",!0));d++;const j=z?R(w,H):o.m(w,H);try{const X=yield j;delete g.abortController,g.state="completed",X.data instanceof HTMLImageElement||o.b(X.data)?D(X):X.data&&D({data:yield(V=X.data,typeof createImageBitmap=="function"?o.d(V):o.f(V)),cacheControl:X.cacheControl,expires:X.expires})}catch(X){delete g.abortController,L(X)}finally{d--,P()}var V}),P=()=>{const g=(()=>{for(const w of Object.keys(_))if(_[w]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let w=d;w<g&&l.length>0;w++){const T=l.shift();T.abortController.signal.aborted?w--:E(T)}},R=(g,w)=>new Promise((T,L)=>{const D=new Image,H=g.url,z=g.credentials;z&&z==="include"?D.crossOrigin="use-credentials":(z&&z==="same-origin"||!o.s(H))&&(D.crossOrigin="anonymous"),w.signal.addEventListener("abort",()=>{D.src="",L(o.c())}),D.fetchPriority="high",D.onload=()=>{D.onerror=D.onload=null,T({data:D})},D.onerror=()=>{D.onerror=D.onload=null,w.signal.aborted||L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},D.src=H})}(Y||(Y={})),Y.resetRequestQueue();class te{constructor(l){this._transformRequestFn=l}transformRequest(l,d){return this._transformRequestFn&&this._transformRequestFn(l,d)||{url:l}}normalizeSpriteURL(l,d,y){const _=function(E){const P=E.match(pe);if(!P)throw new Error(`Unable to parse URL "${E}"`);return{protocol:P[1],authority:P[2],path:P[3]||"/",params:P[4]?P[4].split("&"):[]}}(l);return _.path+=`${d}${y}`,function(E){const P=E.params.length?`?${E.params.join("&")}`:"";return`${E.protocol}://${E.authority}${E.path}${P}`}(_)}setTransformRequest(l){this._transformRequestFn=l}}const pe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ge(C){var l=new o.A(3);return l[0]=C[0],l[1]=C[1],l[2]=C[2],l}var ye,fe=function(C,l,d){return C[0]=l[0]-d[0],C[1]=l[1]-d[1],C[2]=l[2]-d[2],C};ye=new o.A(3),o.A!=Float32Array&&(ye[0]=0,ye[1]=0,ye[2]=0);var Oe=function(C){var l=C[0],d=C[1];return l*l+d*d};function Fe(C){const l=[];if(typeof C=="string")l.push({id:"default",url:C});else if(C&&C.length>0){const d=[];for(const{id:y,url:_}of C){const E=`${y}${_}`;d.indexOf(E)===-1&&(d.push(E),l.push({id:y,url:_}))}}return l}(function(){var C=new o.A(2);o.A!=Float32Array&&(C[0]=0,C[1]=0)})();class oe{constructor(l,d,y,_){this.context=l,this.format=y,this.texture=l.gl.createTexture(),this.update(d,_)}update(l,d,y){const{width:_,height:E}=l,P=!(this.size&&this.size[0]===_&&this.size[1]===E||y),{context:R}=this,{gl:g}=R;if(this.useMipmap=!!(d&&d.useMipmap),g.bindTexture(g.TEXTURE_2D,this.texture),R.pixelStoreUnpackFlipY.set(!1),R.pixelStoreUnpack.set(1),R.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA&&(!d||d.premultiply!==!1)),P)this.size=[_,E],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||o.b(l)?g.texImage2D(g.TEXTURE_2D,0,this.format,this.format,g.UNSIGNED_BYTE,l):g.texImage2D(g.TEXTURE_2D,0,this.format,_,E,0,this.format,g.UNSIGNED_BYTE,l.data);else{const{x:w,y:T}=y||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||o.b(l)?g.texSubImage2D(g.TEXTURE_2D,0,w,T,g.RGBA,g.UNSIGNED_BYTE,l):g.texSubImage2D(g.TEXTURE_2D,0,w,T,_,E,g.RGBA,g.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&g.generateMipmap(g.TEXTURE_2D)}bind(l,d,y){const{context:_}=this,{gl:E}=_;E.bindTexture(E.TEXTURE_2D,this.texture),y!==E.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(y=E.LINEAR),l!==this.filter&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,l),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,y||l),this.filter=l),d!==this.wrap&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,d),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}function le(C){const{userImage:l}=C;return!!(l&&l.render&&l.render())&&(C.data.replace(new Uint8Array(l.data.buffer)),!0)}class xe extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:d,promiseResolve:y}of this.requestors)y(this._getImagesForIds(d));this.requestors=[]}}getImage(l){const d=this.images[l];if(d&&!d.data&&d.spriteData){const y=d.spriteData;d.data=new o.R({width:y.width,height:y.height},y.context.getImageData(y.x,y.y,y.width,y.height).data),d.spriteData=null}return d}addImage(l,d){if(this.images[l])throw new Error(`Image id ${l} already exist, use updateImage instead`);this._validate(l,d)&&(this.images[l]=d)}_validate(l,d){let y=!0;const _=d.data||d.spriteData;return this._validateStretch(d.stretchX,_&&_.width)||(this.fire(new o.j(new Error(`Image "${l}" has invalid "stretchX" value`))),y=!1),this._validateStretch(d.stretchY,_&&_.height)||(this.fire(new o.j(new Error(`Image "${l}" has invalid "stretchY" value`))),y=!1),this._validateContent(d.content,d)||(this.fire(new o.j(new Error(`Image "${l}" has invalid "content" value`))),y=!1),y}_validateStretch(l,d){if(!l)return!0;let y=0;for(const _ of l){if(_[0]<y||_[1]<_[0]||d<_[1])return!1;y=_[1]}return!0}_validateContent(l,d){if(!l)return!0;if(l.length!==4)return!1;const y=d.spriteData,_=y&&y.width||d.data.width,E=y&&y.height||d.data.height;return!(l[0]<0||_<l[0]||l[1]<0||E<l[1]||l[2]<0||_<l[2]||l[3]<0||E<l[3]||l[2]<l[0]||l[3]<l[1])}updateImage(l,d){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const _=this.getImage(l);if(y&&(_.data.width!==d.data.width||_.data.height!==d.data.height))throw new Error(`size mismatch between old image (${_.data.width}x${_.data.height}) and new image (${d.data.width}x${d.data.height}).`);d.version=_.version+1,this.images[l]=d,this.updatedImages[l]=!0}removeImage(l){const d=this.images[l];delete this.images[l],delete this.patterns[l],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l){return new Promise((d,y)=>{let _=!0;if(!this.isLoaded())for(const E of l)this.images[E]||(_=!1);this.isLoaded()||_?d(this._getImagesForIds(l)):this.requestors.push({ids:l,promiseResolve:d})})}_getImagesForIds(l){const d={};for(const y of l){let _=this.getImage(y);_||(this.fire(new o.k("styleimagemissing",{id:y})),_=this.getImage(y)),_?d[y]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,hasRenderCallback:!!(_.userImage&&_.userImage.render)}:o.w(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return d}getPixelSize(){const{width:l,height:d}=this.atlasImage;return{width:l,height:d}}getPattern(l){const d=this.patterns[l],y=this.getImage(l);if(!y)return null;if(d&&d.position.version===y.version)return d.position;if(d)d.position.version=y.version;else{const _={w:y.data.width+2,h:y.data.height+2,x:0,y:0},E=new o.I(_,y);this.patterns[l]={bin:_,position:E}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const d=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new oe(l,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const E in this.patterns)l.push(this.patterns[E].bin);const{w:d,h:y}=o.p(l),_=this.atlasImage;_.resize({width:d||1,height:y||1});for(const E in this.patterns){const{bin:P}=this.patterns[E],R=P.x+1,g=P.y+1,w=this.getImage(E).data,T=w.width,L=w.height;o.R.copy(w,_,{x:0,y:0},{x:R,y:g},{width:T,height:L}),o.R.copy(w,_,{x:0,y:L-1},{x:R,y:g-1},{width:T,height:1}),o.R.copy(w,_,{x:0,y:0},{x:R,y:g+L},{width:T,height:1}),o.R.copy(w,_,{x:T-1,y:0},{x:R-1,y:g},{width:1,height:L}),o.R.copy(w,_,{x:0,y:0},{x:R+T,y:g},{width:1,height:L})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const d of l){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const y=this.getImage(d);y||o.w(`Image with ID: "${d}" was not found`),le(y)&&this.updateImage(d,y)}}}const _e=1e20;function tt(C,l,d,y,_,E,P,R,g){for(let w=l;w<l+y;w++)et(C,d*E+w,E,_,P,R,g);for(let w=d;w<d+_;w++)et(C,w*E+l,1,y,P,R,g)}function et(C,l,d,y,_,E,P){E[0]=0,P[0]=-_e,P[1]=_e,_[0]=C[l];for(let R=1,g=0,w=0;R<y;R++){_[R]=C[l+R*d];const T=R*R;do{const L=E[g];w=(_[R]-_[L]+T-L*L)/(R-L)/2}while(w<=P[g]&&--g>-1);g++,E[g]=R,P[g]=w,P[g+1]=_e}for(let R=0,g=0;R<y;R++){for(;P[g+1]<R;)g++;const w=E[g],T=R-w;C[l+R*d]=_[w]+T*T}}class nt{constructor(l,d){this.requestManager=l,this.localIdeographFontFamily=d,this.entries={}}setURL(l){this.url=l}getGlyphs(l){return o._(this,void 0,void 0,function*(){const d=[];for(const E in l)for(const P of l[E])d.push(this._getAndCacheGlyphsPromise(E,P));const y=yield Promise.all(d),_={};for(const{stack:E,id:P,glyph:R}of y)_[E]||(_[E]={}),_[E][P]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics};return _})}_getAndCacheGlyphsPromise(l,d){return o._(this,void 0,void 0,function*(){let y=this.entries[l];y||(y=this.entries[l]={glyphs:{},requests:{},ranges:{}});let _=y.glyphs[d];if(_!==void 0)return{stack:l,id:d,glyph:_};if(_=this._tinySDF(y,l,d),_)return y.glyphs[d]=_,{stack:l,id:d,glyph:_};const E=Math.floor(d/256);if(256*E>65535)throw new Error("glyphs > 65535 not supported");if(y.ranges[E])return{stack:l,id:d,glyph:_};if(!this.url)throw new Error("glyphsUrl is not set");if(!y.requests[E]){const R=nt.loadGlyphRange(l,E,this.url,this.requestManager);y.requests[E]=R}const P=yield y.requests[E];for(const R in P)this._doesCharSupportLocalGlyph(+R)||(y.glyphs[+R]=P[+R]);return y.ranges[E]=!0,{stack:l,id:d,glyph:P[d]||null}})}_doesCharSupportLocalGlyph(l){return!!this.localIdeographFontFamily&&(o.u["CJK Unified Ideographs"](l)||o.u["Hangul Syllables"](l)||o.u.Hiragana(l)||o.u.Katakana(l))}_tinySDF(l,d,y){const _=this.localIdeographFontFamily;if(!_||!this._doesCharSupportLocalGlyph(y))return;let E=l.tinySDF;if(!E){let R="400";/bold/i.test(d)?R="900":/medium/i.test(d)?R="500":/light/i.test(d)&&(R="200"),E=l.tinySDF=new nt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:_,fontWeight:R})}const P=E.draw(String.fromCharCode(y));return{id:y,bitmap:new o.o({width:P.width||60,height:P.height||60},P.data),metrics:{width:P.glyphWidth/2||24,height:P.glyphHeight/2||24,left:P.glyphLeft/2+.5||0,top:P.glyphTop/2-27.5||-8,advance:P.glyphAdvance/2||24,isDoubleResolution:!0}}}}nt.loadGlyphRange=function(C,l,d,y){return o._(this,void 0,void 0,function*(){const _=256*l,E=_+255,P=y.transformRequest(d.replace("{fontstack}",C).replace("{range}",`${_}-${E}`),"Glyphs"),R=yield o.l(P,new AbortController);if(!R||!R.data)throw new Error(`Could not load glyph range. range: ${l}, ${_}-${E}`);const g={};for(const w of o.n(R.data))g[w.id]=w;return g})},nt.TinySDF=class{constructor(){let{fontSize:C=24,buffer:l=3,radius:d=8,cutoff:y=.25,fontFamily:_="sans-serif",fontWeight:E="normal",fontStyle:P="normal"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.buffer=l,this.cutoff=y,this.radius=d;const R=this.size=C+4*l,g=this._createCanvas(R),w=this.ctx=g.getContext("2d",{willReadFrequently:!0});w.font=`${P} ${E} ${C}px ${_}`,w.textBaseline="alphabetic",w.textAlign="left",w.fillStyle="black",this.gridOuter=new Float64Array(R*R),this.gridInner=new Float64Array(R*R),this.f=new Float64Array(R),this.z=new Float64Array(R+1),this.v=new Uint16Array(R)}_createCanvas(C){const l=document.createElement("canvas");return l.width=l.height=C,l}draw(C){const{width:l,actualBoundingBoxAscent:d,actualBoundingBoxDescent:y,actualBoundingBoxLeft:_,actualBoundingBoxRight:E}=this.ctx.measureText(C),P=Math.ceil(d),R=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(E-_))),g=Math.min(this.size-this.buffer,P+Math.ceil(y)),w=R+2*this.buffer,T=g+2*this.buffer,L=Math.max(w*T,0),D=new Uint8ClampedArray(L),H={data:D,width:w,height:T,glyphWidth:R,glyphHeight:g,glyphTop:P,glyphLeft:0,glyphAdvance:l};if(R===0||g===0)return H;const{ctx:z,buffer:j,gridInner:V,gridOuter:X}=this;z.clearRect(j,j,R,g),z.fillText(C,j,j+P);const ue=z.getImageData(j,j,R,g);X.fill(_e,0,L),V.fill(0,0,L);for(let ne=0;ne<g;ne++)for(let de=0;de<R;de++){const me=ue.data[4*(ne*R+de)+3]/255;if(me===0)continue;const Ue=(ne+j)*w+de+j;if(me===1)X[Ue]=0,V[Ue]=_e;else{const Ie=.5-me;X[Ue]=Ie>0?Ie*Ie:0,V[Ue]=Ie<0?Ie*Ie:0}}tt(X,0,0,w,T,w,this.f,this.v,this.z),tt(V,j,j,R,g,w,this.f,this.v,this.z);for(let ne=0;ne<L;ne++){const de=Math.sqrt(X[ne])-Math.sqrt(V[ne]);D[ne]=Math.round(255-255*(de/this.radius+this.cutoff))}return H}};class Je{constructor(){this.specification=o.v.light.position}possiblyEvaluate(l,d){return o.y(l.expression.evaluate(d))}interpolate(l,d,y){return{x:o.z.number(l.x,d.x,y),y:o.z.number(l.y,d.y,y),z:o.z.number(l.z,d.z,y)}}}let it;class ot extends o.E{constructor(l){super(),it=it||new o.q({anchor:new o.D(o.v.light.anchor),position:new Je,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.T(it),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this._validate(o.r,l,d))for(const y in l){const _=l[y];y.endsWith("-transition")?this._transitionable.setTransition(y.slice(0,-11),_):this._transitionable.setValue(y,_)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,d,y){return(!y||y.validate!==!1)&&o.t(this,l.call(o.x,{value:d,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}class xt{constructor(l,d){this.width=l,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(l,d){const y=l.join(",")+String(d);return this.dashEntry[y]||(this.dashEntry[y]=this.addDash(l,d)),this.dashEntry[y]}getDashRanges(l,d,y){const _=[];let E=l.length%2==1?-l[l.length-1]*y:0,P=l[0]*y,R=!0;_.push({left:E,right:P,isDash:R,zeroLength:l[0]===0});let g=l[0];for(let w=1;w<l.length;w++){R=!R;const T=l[w];E=g*y,g+=T,P=g*y,_.push({left:E,right:P,isDash:R,zeroLength:T===0})}return _}addRoundDash(l,d,y){const _=d/2;for(let E=-y;E<=y;E++){const P=this.width*(this.nextRow+y+E);let R=0,g=l[R];for(let w=0;w<this.width;w++){w/g.right>1&&(g=l[++R]);const T=Math.abs(w-g.left),L=Math.abs(w-g.right),D=Math.min(T,L);let H;const z=E/y*(_+1);if(g.isDash){const j=_-Math.abs(z);H=Math.sqrt(D*D+j*j)}else H=_-Math.sqrt(D*D+z*z);this.data[P+w]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(l){for(let R=l.length-1;R>=0;--R){const g=l[R],w=l[R+1];g.zeroLength?l.splice(R,1):w&&w.isDash===g.isDash&&(w.left=g.left,l.splice(R,1))}const d=l[0],y=l[l.length-1];d.isDash===y.isDash&&(d.left=y.left-this.width,y.right=d.right+this.width);const _=this.width*this.nextRow;let E=0,P=l[E];for(let R=0;R<this.width;R++){R/P.right>1&&(P=l[++E]);const g=Math.abs(R-P.left),w=Math.abs(R-P.right),T=Math.min(g,w);this.data[_+R]=Math.max(0,Math.min(255,(P.isDash?T:-T)+128))}}addDash(l,d){const y=d?7:0,_=2*y+1;if(this.nextRow+_>this.height)return o.w("LineAtlas out of space"),null;let E=0;for(let R=0;R<l.length;R++)E+=l[R];if(E!==0){const R=this.width/E,g=this.getDashRanges(l,this.width,R);d?this.addRoundDash(g,R,y):this.addRegularDash(g)}const P={y:(this.nextRow+y+.5)/this.height,height:2*y/this.height,width:E};return this.nextRow+=_,this.dirty=!0,P}bind(l){const d=l.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}const se="maplibre_preloaded_worker_pool";class be{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<be.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[se]}numActive(){return Object.keys(this.active).length}}const Me=Math.floor(v.hardwareConcurrency/2);let De,$e;function qe(){return De||(De=new be),De}be.workerCount=o.B(globalThis)?Math.max(Math.min(Me,3),1):1;class ct{constructor(l,d){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=d;const y=this.workerPool.acquire(d);for(let _=0;_<y.length;_++){const E=new o.C(y[_],d);E.name=`Worker ${_}`,this.actors.push(E)}if(!this.actors.length)throw new Error("No actors found")}broadcast(l,d){const y=[];for(const _ of this.actors)y.push(_.sendAsync({type:l,data:d}));return Promise.all(y)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.actors.forEach(d=>{d.remove()}),this.actors=[],l&&this.workerPool.release(this.id)}registerMessageHandler(l,d){for(const y of this.actors)y.registerMessageHandler(l,d)}}function st(){return $e||($e=new ct(qe(),o.G),$e.registerMessageHandler("GR",(C,l,d)=>o.m(l,d))),$e}function Ct(C,l){const d=o.F();return o.H(d,d,[1,1,0]),o.J(d,d,[.5*C.width,.5*C.height,1]),o.K(d,d,C.calculatePosMatrix(l.toUnwrapped()))}function It(C,l,d,y,_,E){const P=function(L,D,H){if(L)for(const z of L){const j=D[z];if(j&&j.source===H&&j.type==="fill-extrusion")return!0}else for(const z in D){const j=D[z];if(j.source===H&&j.type==="fill-extrusion")return!0}return!1}(_&&_.layers,l,C.id),R=E.maxPitchScaleFactor(),g=C.tilesIn(y,R,P);g.sort(Qt);const w=[];for(const L of g)w.push({wrappedTileID:L.tileID.wrapped().key,queryResults:L.tile.queryRenderedFeatures(l,d,C._state,L.queryGeometry,L.cameraQueryGeometry,L.scale,_,E,R,Ct(C.transform,L.tileID))});const T=function(L){const D={},H={};for(const z of L){const j=z.queryResults,V=z.wrappedTileID,X=H[V]=H[V]||{};for(const ue in j){const ne=j[ue],de=X[ue]=X[ue]||{},me=D[ue]=D[ue]||[];for(const Ue of ne)de[Ue.featureIndex]||(de[Ue.featureIndex]=!0,me.push(Ue))}}return D}(w);for(const L in T)T[L].forEach(D=>{const H=D.feature,z=C.getFeatureState(H.layer["source-layer"],H.id);H.source=H.layer.source,H.layer["source-layer"]&&(H.sourceLayer=H.layer["source-layer"]),H.state=z});return T}function Qt(C,l){const d=C.tileID,y=l.tileID;return d.overscaledZ-y.overscaledZ||d.canonical.y-y.canonical.y||d.wrap-y.wrap||d.canonical.x-y.canonical.x}function Ht(C,l,d){return o._(this,void 0,void 0,function*(){let y=C;if(C.url?y=(yield o.h(l.transformRequest(C.url,"Source"),d)).data:yield v.frameAsync(d),!y)return null;const _=o.L(o.e(y,C),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in y&&y.vector_layers&&(_.vectorLayerIds=y.vector_layers.map(E=>E.id)),_})}class zt{constructor(l,d){l&&(d?this.setSouthWest(l).setNorthEast(d):Array.isArray(l)&&(l.length===4?this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]]):this.setSouthWest(l[0]).setNorthEast(l[1])))}setNorthEast(l){return this._ne=l instanceof o.M?new o.M(l.lng,l.lat):o.M.convert(l),this}setSouthWest(l){return this._sw=l instanceof o.M?new o.M(l.lng,l.lat):o.M.convert(l),this}extend(l){const d=this._sw,y=this._ne;let _,E;if(l instanceof o.M)_=l,E=l;else{if(!(l instanceof zt))return Array.isArray(l)?l.length===4||l.every(Array.isArray)?this.extend(zt.convert(l)):this.extend(o.M.convert(l)):l&&("lng"in l||"lon"in l)&&"lat"in l?this.extend(o.M.convert(l)):this;if(_=l._sw,E=l._ne,!_||!E)return this}return d||y?(d.lng=Math.min(_.lng,d.lng),d.lat=Math.min(_.lat,d.lat),y.lng=Math.max(E.lng,y.lng),y.lat=Math.max(E.lat,y.lat)):(this._sw=new o.M(_.lng,_.lat),this._ne=new o.M(E.lng,E.lat)),this}getCenter(){return new o.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.M(this.getWest(),this.getNorth())}getSouthEast(){return new o.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(l){const{lng:d,lat:y}=o.M.convert(l);let _=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=y&&y<=this._ne.lat&&_}static convert(l){return l instanceof zt?l:l&&new zt(l)}static fromLngLat(l){const y=360*(arguments.length>1&&arguments[1]!==void 0?arguments[1]:0)/40075017,_=y/Math.cos(Math.PI/180*l.lat);return new zt(new o.M(l.lng-_,l.lat-y),new o.M(l.lng+_,l.lat+y))}}class mt{constructor(l,d,y){this.bounds=zt.convert(this.validateBounds(l)),this.minzoom=d||0,this.maxzoom=y||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const d=Math.pow(2,l.z),y=Math.floor(o.N(this.bounds.getWest())*d),_=Math.floor(o.O(this.bounds.getNorth())*d),E=Math.ceil(o.N(this.bounds.getEast())*d),P=Math.ceil(o.O(this.bounds.getSouth())*d);return l.x>=y&&l.x<E&&l.y>=_&&l.y<P}}class Re extends o.E{constructor(l,d,y,_){if(super(),this.id=l,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.L(d,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield Ht(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),l&&(o.e(this,l),l.bounds&&(this.tileBounds=new mt(l.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(l){this._tileJSONRequest=null,this.fire(new o.j(l))}})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.abort(),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(l){return o._(this,void 0,void 0,function*(){const d=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),y={request:this.map._requestManager.transformRequest(d,"Tile"),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};y.request.collectResourceTiming=this._collectResourceTiming;let _="RT";if(l.actor&&l.state!=="expired"){if(l.state==="loading")return new Promise((E,P)=>{l.reloadPromise={resolve:E,reject:P}})}else l.actor=this.dispatcher.getActor(),_="LT";l.abortController=new AbortController;try{const E=yield l.actor.sendAsync({type:_,data:y},l.abortController);if(delete l.abortController,l.aborted)return;this._afterTileLoadWorkerResponse(l,E)}catch(E){if(delete l.abortController,l.aborted)return;if(E&&E.status!==404)throw E;this._afterTileLoadWorkerResponse(l,null)}})}_afterTileLoadWorkerResponse(l,d){if(d&&d.resourceTiming&&(l.resourceTiming=d.resourceTiming),d&&this.map._refreshExpiredTiles&&l.setExpiryData(d),l.loadVectorData(d,this.map.painter),l.reloadPromise){const y=l.reloadPromise;l.reloadPromise=null,this.loadTile(l).then(y.resolve).catch(y.reject)}}abortTile(l){return o._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.actor&&(yield l.actor.sendAsync({type:"AT",data:{uid:l.uid,type:this.type,source:this.id}}))})}unloadTile(l){return o._(this,void 0,void 0,function*(){l.unloadVectorData(),l.actor&&(yield l.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ye extends o.E{constructor(l,d,y,_){super(),this.id=l,this.dispatcher=y,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},d),o.e(this,o.L(d,["url","scheme","tileSize"]))}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield Ht(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,l&&(o.e(this,l),l.bounds&&(this.tileBounds=new mt(l.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(l){this._tileJSONRequest=null,this.fire(new o.j(l))}})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(l){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}serialize(){return o.e({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l){return o._(this,void 0,void 0,function*(){const d=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);l.abortController=new AbortController;try{const y=yield Y.getImage(this.map._requestManager.transformRequest(d,"Tile"),l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(y&&y.data){this.map._refreshExpiredTiles&&y.cacheControl&&y.expires&&l.setExpiryData({cacheControl:y.cacheControl,expires:y.expires});const _=this.map.painter.context,E=_.gl,P=y.data;l.texture=this.map.painter.getTileTexture(P.width),l.texture?l.texture.update(P,{useMipmap:!0}):(l.texture=new oe(_,P,E.RGBA,{useMipmap:!0}),l.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),_.extTextureFilterAnisotropic&&E.texParameterf(E.TEXTURE_2D,_.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,_.extTextureFilterAnisotropicMax)),l.state="loaded"}}catch(y){if(delete l.abortController,l.aborted)l.state="unloaded";else if(y)throw l.state="errored",y}})}abortTile(l){return o._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController)})}unloadTile(l){return o._(this,void 0,void 0,function*(){l.texture&&this.map.painter.saveTileTexture(l.texture)})}hasTransition(){return!1}}class tr extends Ye{constructor(l,d,y,_){super(l,d,y,_),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox",this.redFactor=d.redFactor,this.greenFactor=d.greenFactor,this.blueFactor=d.blueFactor,this.baseShift=d.baseShift}loadTile(l){return o._(this,void 0,void 0,function*(){const d=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),y=this.map._requestManager.transformRequest(d,"Tile");l.neighboringTiles=this._getNeighboringTiles(l.tileID),l.abortController=new AbortController;try{const _=yield Y.getImage(y,l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(_&&_.data){const E=_.data;this.map._refreshExpiredTiles&&_.cacheControl&&_.expires&&l.setExpiryData({cacheControl:_.cacheControl,expires:_.expires});const P=o.b(E)&&o.S()?E:yield this.readImageNow(E),R={type:this.type,uid:l.uid,source:this.id,rawImageData:P,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!l.actor||l.state==="expired"){l.actor=this.dispatcher.getActor();const g=yield l.actor.sendAsync({type:"LDT",data:R});l.dem=g,l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0,l.state="loaded"}}}catch(_){if(delete l.abortController,l.aborted)l.state="unloaded";else if(_)throw l.state="errored",_}})}readImageNow(l){return o._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&o.U()){const d=l.width+2,y=l.height+2;try{return new o.R({width:d,height:y},yield o.V(l,-1,-1,d,y))}catch{}}return v.getImageData(l,1)})}_getNeighboringTiles(l){const d=l.canonical,y=Math.pow(2,d.z),_=(d.x-1+y)%y,E=d.x===0?l.wrap-1:l.wrap,P=(d.x+1+y)%y,R=d.x+1===y?l.wrap+1:l.wrap,g={};return g[new o.Q(l.overscaledZ,E,d.z,_,d.y).key]={backfilled:!1},g[new o.Q(l.overscaledZ,R,d.z,P,d.y).key]={backfilled:!1},d.y>0&&(g[new o.Q(l.overscaledZ,E,d.z,_,d.y-1).key]={backfilled:!1},g[new o.Q(l.overscaledZ,l.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},g[new o.Q(l.overscaledZ,R,d.z,P,d.y-1).key]={backfilled:!1}),d.y+1<y&&(g[new o.Q(l.overscaledZ,E,d.z,_,d.y+1).key]={backfilled:!1},g[new o.Q(l.overscaledZ,l.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},g[new o.Q(l.overscaledZ,R,d.z,P,d.y+1).key]={backfilled:!1}),g}unloadTile(l){return o._(this,void 0,void 0,function*(){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&(yield l.actor.sendAsync({type:"RDT",data:{type:this.type,uid:l.uid,source:this.id}}))})}}class St extends o.E{constructor(l,d,y,_){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=y.getActor(),this.setEventedParent(_),this._data=d.data,this._options=o.e({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const E=o.W/this.tileSize;this.workerOptions=o.e({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*E,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*E,extent:o.W,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:o.W,radius:(d.clusterRadius||50)*E,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return o._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(l){this.map=l,this.load()}setData(l){return this._data=l,this._updateWorkerData(),this}updateData(l){return this._updateWorkerData(l),this}setClusterOptions(l){return this.workerOptions.cluster=l.cluster,l&&(l.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=l.clusterRadius),l.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=l.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(l){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:l,source:this.id}})}getClusterChildren(l){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:l,source:this.id}})}getClusterLeaves(l,d,y){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:l,limit:d,offset:y}})}_updateWorkerData(l){return o._(this,void 0,void 0,function*(){const d=o.e({type:this.type},this.workerOptions);l?d.dataDiff=l:typeof this._data=="string"?(d.request=this.map._requestManager.transformRequest(v.resolveURL(this._data),"Source"),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new o.k("dataloading",{dataType:"source"}));try{const y=yield this.actor.sendAsync({type:"LD",data:d});if(this._pendingLoads--,this._removed||y.abandoned)return void this.fire(new o.k("dataabort",{dataType:"source"}));let _=null;y.resourceTiming&&y.resourceTiming[this.id]&&(_=y.resourceTiming[this.id].slice(0));const E={dataType:"source"};this._collectResourceTiming&&_&&_.length>0&&o.e(E,{resourceTiming:_}),this.fire(new o.k("data",Object.assign(Object.assign({},E),{sourceDataType:"metadata"}))),this.fire(new o.k("data",Object.assign(Object.assign({},E),{sourceDataType:"content"})))}catch(y){if(this._pendingLoads--,this._removed)return void this.fire(new o.k("dataabort",{dataType:"source"}));this.fire(new o.j(y))}})}loaded(){return this._pendingLoads===0}loadTile(l){return o._(this,void 0,void 0,function*(){const d=l.actor?"RT":"LT";l.actor=this.actor;const y={type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};l.abortController=new AbortController;const _=yield this.actor.sendAsync({type:d,data:y},l.abortController);delete l.abortController,l.unloadVectorData(),l.aborted||l.loadVectorData(_,this.map.painter,d==="RT")})}abortTile(l){return o._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.aborted=!0})}unloadTile(l){return o._(this,void 0,void 0,function*(){l.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var vt=o.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Bt extends o.E{constructor(l,d,y,_){super(),this.id=l,this.dispatcher=y,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=d}load(l){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const d=yield Y.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,d&&d.data&&(this.image=d.data,l&&(this.coordinates=l),this._finishLoading())}catch(d){this._request=null,this._loaded=!0,this.fire(new o.j(d))}})}loaded(){return this._loaded}updateImage(l){return l.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=l.url,this.load(l.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(l){this.coordinates=l;const d=l.map(o.Y.fromLngLat);this.tileID=function(_){let E=1/0,P=1/0,R=-1/0,g=-1/0;for(const D of _)E=Math.min(E,D.x),P=Math.min(P,D.y),R=Math.max(R,D.x),g=Math.max(g,D.y);const w=Math.max(R-E,g-P),T=Math.max(0,Math.floor(-Math.log(w)/Math.LN2)),L=Math.pow(2,T);return new o.a0(T,Math.floor((E+R)/2*L),Math.floor((P+g)/2*L))}(d),this.minzoom=this.maxzoom=this.tileID.z;const y=d.map(_=>this.tileID.getTilePoint(_)._round());return this._boundsArray=new o.Z,this._boundsArray.emplaceBack(y[0].x,y[0].y,0,0),this._boundsArray.emplaceBack(y[1].x,y[1].y,o.W,0),this._boundsArray.emplaceBack(y[3].x,y[3].y,0,o.W),this._boundsArray.emplaceBack(y[2].x,y[2].y,o.W,o.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const l=this.map.painter.context,d=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,vt.members)),this.boundsSegments||(this.boundsSegments=o.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new oe(l,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let y=!1;for(const _ in this.tiles){const E=this.tiles[_];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,y=!0)}y&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(l){return o._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={}):l.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class kt extends Bt{constructor(l,d,y,_){super(l,d,y,_),this.roundZoom=!0,this.type="video",this.options=d}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1;const l=this.options;this.urls=[];for(const d of l.urls)this.urls.push(this.map._requestManager.transformRequest(d,"Source").url);try{const d=yield o.a2(this.urls);if(this._loaded=!0,!d)return;this.video=d,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(d){this.fire(new o.j(d))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const d=this.video.seekable;l<d.start(0)||l>d.end(0)?this.fire(new o.j(new o.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const l=this.map.painter.context,d=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,vt.members)),this.boundsSegments||(this.boundsSegments=o.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new oe(l,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let y=!1;for(const _ in this.tiles){const E=this.tiles[_];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,y=!0)}y&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ir extends Bt{constructor(l,d,y,_){super(l,d,y,_),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(E=>!Array.isArray(E)||E.length!==2||E.some(P=>typeof P!="number"))||this.fire(new o.j(new o.a1(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.j(new o.a1(`sources.${l}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new o.j(new o.a1(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof HTMLCanvasElement||this.fire(new o.j(new o.a1(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.j(new o.a1(`sources.${l}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}load(){return o._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const d=this.map.painter.context,y=d.gl;this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,vt.members)),this.boundsSegments||(this.boundsSegments=o.$.simpleSegment(0,0,4,2)),this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new oe(d,this.canvas,y.RGBA,{premultiply:!0});let _=!1;for(const E in this.tiles){const P=this.tiles[E];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture,_=!0)}_&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}}const Ar={},Lr=C=>{switch(C){case"geojson":return St;case"image":return Bt;case"raster":return Ye;case"raster-dem":return tr;case"vector":return Re;case"video":return kt;case"canvas":return ir}return Ar[C]},Tr="RTLPluginLoaded";class kr extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=st()}_syncState(l){return this.status=l,this.dispatcher.broadcast("SRPS",{pluginStatus:l,pluginURL:this.url}).catch(d=>{throw this.status="error",d})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(l){return o._(this,arguments,void 0,function(d){var y=this;let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(y.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(y.url=v.resolveURL(d),!y.url)throw new Error(`requested url ${d} is invalid`);if(y.status==="unavailable"){if(!_)return y._requestImport();y.status="deferred",y._syncState(y.status)}else if(y.status==="requested")return y._requestImport()}()})}_requestImport(){return o._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.k(Tr))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Qr=null;function pt(){return Qr||(Qr=new kr),Qr}class Ir{constructor(l,d){this.timeAdded=0,this.fadeEndTime=0,this.tileID=l,this.uid=o.a3(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(l){const d=l+this.timeAdded;d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(l){this.demTexture&&l.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(l,d,y){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(_,E){const P={};if(!E)return P;for(const R of _){const g=R.layerIds.map(w=>E.getLayer(w)).filter(Boolean);if(g.length!==0){R.layers=g,R.stateDependentLayerIds&&(R.stateDependentLayers=R.stateDependentLayerIds.map(w=>g.filter(T=>T.id===w)[0]));for(const w of g)P[w.id]=R}}return P}(l.buckets,d.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const E=this.buckets[_];if(E instanceof o.a5){if(this.hasSymbolBuckets=!0,!y)break;E.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const E=this.buckets[_];if(E instanceof o.a5&&E.hasRTLText){this.hasRTLText=!0,pt().lazyLoad();break}}this.queryPadding=0;for(const _ in this.buckets){const E=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(_).queryRadius(E))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage)}else this.collisionBoxArray=new o.a4}unloadVectorData(){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(l){return this.buckets[l.id]}upload(l){for(const y in this.buckets){const _=this.buckets[y];_.uploadPending()&&_.upload(l)}const d=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new oe(l,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new oe(l,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,d,y,_,E,P,R,g,w,T){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:E,scale:P,tileSize:this.tileSize,pixelPosMatrix:T,transform:g,params:R,queryPadding:this.queryPadding*w},l,d,y):{}}querySourceFeatures(l,d){const y=this.latestFeatureIndex;if(!y||!y.rawTileData)return;const _=y.loadVTLayers(),E=d&&d.sourceLayer?d.sourceLayer:"",P=_._geojsonTileLayer||_[E];if(!P)return;const R=o.a6(d&&d.filter),{z:g,x:w,y:T}=this.tileID.canonical,L={z:g,x:w,y:T};for(let D=0;D<P.length;D++){const H=P.feature(D);if(R.needGeometry){const V=o.a7(H,!0);if(!R.filter(new o.a8(this.tileID.overscaledZ),V,this.tileID.canonical))continue}else if(!R.filter(new o.a8(this.tileID.overscaledZ),H))continue;const z=y.getId(H,E),j=new o.a9(H,g,w,T,z);j.tile=L,l.push(j)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const d=this.expirationTime;if(l.cacheControl){const y=o.aa(l.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const y=Date.now();let _=!1;if(this.expirationTime>y)_=!1;else if(d)if(this.expirationTime<d)_=!0;else{const E=this.expirationTime-d;E?this.expirationTime=y+Math.max(E,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0)return;const y=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!d.style.hasLayer(_))continue;const E=this.buckets[_],P=E.layers[0].sourceLayer||"_geojsonTileLayer",R=y[P],g=l[P];if(!R||!g||Object.keys(g).length===0)continue;E.update(g,R,this.imageAtlas&&this.imageAtlas.patternPositions||{});const w=d&&d.style&&d.style.getLayer(_);w&&(this.queryPadding=Math.max(this.queryPadding,w.queryRadius(E)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<v.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=v.now()+l}setDependencies(l,d){const y={};for(const _ of d)y[_]=!0;this.dependencies[l]=y}hasDependency(l,d){for(const y of l){const _=this.dependencies[y];if(_){for(const E of d)if(_[E])return!0}}return!1}}class Dt{constructor(l,d){this.max=l,this.onRemove=d,this.reset()}reset(){for(const l in this.data)for(const d of this.data[l])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(l,d,y){const _=l.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const E={value:d,timeout:void 0};if(y!==void 0&&(E.timeout=setTimeout(()=>{this.remove(l,E)},y)),this.data[_].push(E),this.order.push(_),this.order.length>this.max){const P=this._getAndRemoveByKey(this.order[0]);P&&this.onRemove(P)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const d=this.data[l].shift();return d.timeout&&clearTimeout(d.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),d.value}getByKey(l){const d=this.data[l];return d?d[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,d){if(!this.has(l))return this;const y=l.wrapped().key,_=d===void 0?0:this.data[y].indexOf(d),E=this.data[y][_];return this.data[y].splice(_,1),E.timeout&&clearTimeout(E.timeout),this.data[y].length===0&&delete this.data[y],this.onRemove(E.value),this.order.splice(this.order.indexOf(y),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(l){const d=[];for(const y in this.data)for(const _ of this.data[y])l(_.value)||d.push(_);for(const y of d)this.remove(y.value.tileID,y)}}class xn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,d,y){const _=String(d);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][_]=this.stateChanges[l][_]||{},o.e(this.stateChanges[l][_],y),this.deletedStates[l]===null){this.deletedStates[l]={};for(const E in this.state[l])E!==_&&(this.deletedStates[l][E]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][_]===null){this.deletedStates[l][_]={};for(const E in this.state[l][_])y[E]||(this.deletedStates[l][_][E]=null)}else for(const E in y)this.deletedStates[l]&&this.deletedStates[l][_]&&this.deletedStates[l][_][E]===null&&delete this.deletedStates[l][_][E]}removeFeatureState(l,d,y){if(this.deletedStates[l]===null)return;const _=String(d);if(this.deletedStates[l]=this.deletedStates[l]||{},y&&d!==void 0)this.deletedStates[l][_]!==null&&(this.deletedStates[l][_]=this.deletedStates[l][_]||{},this.deletedStates[l][_][y]=null);else if(d!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][_])for(y in this.deletedStates[l][_]={},this.stateChanges[l][_])this.deletedStates[l][_][y]=null;else this.deletedStates[l][_]=null;else this.deletedStates[l]=null}getState(l,d){const y=String(d),_=o.e({},(this.state[l]||{})[y],(this.stateChanges[l]||{})[y]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){const E=this.deletedStates[l][d];if(E===null)return{};for(const P in E)delete _[P]}return _}initializeTileState(l,d){l.setFeatureState(this.state,d)}coalesceChanges(l,d){const y={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const E={};for(const P in this.stateChanges[_])this.state[_][P]||(this.state[_][P]={}),o.e(this.state[_][P],this.stateChanges[_][P]),E[P]=this.state[_][P];y[_]=E}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const E={};if(this.deletedStates[_]===null)for(const P in this.state[_])E[P]={},this.state[_][P]={};else for(const P in this.deletedStates[_]){if(this.deletedStates[_][P]===null)this.state[_][P]={};else for(const R of Object.keys(this.deletedStates[_][P]))delete this.state[_][P][R];E[P]=this.state[_][P]}y[_]=y[_]||{},o.e(y[_],E)}if(this.stateChanges={},this.deletedStates={},Object.keys(y).length!==0)for(const _ in l)l[_].setFeatureState(y,d)}}class Mr extends o.E{constructor(l,d,y){super(),this.id=l,this.dispatcher=y,this.on("data",_=>this._dataHandler(_)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((_,E,P,R)=>{const g=new(Lr(E.type))(_,E,P,R);if(g.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${g.id}`);return g})(l,d,y,this),this._tiles={},this._cache=new Dt(0,_=>this._unloadTile(_)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new xn,this._didEmitContent=!1,this._updated=!1}onAdd(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._maxTileCacheZoomLevels=l?l._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(l)}onRemove(l){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(l)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const l in this._tiles){const d=this._tiles[l];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(l,d,y){return o._(this,void 0,void 0,function*(){try{yield this._source.loadTile(l),this._tileLoaded(l,d,y)}catch(_){l.state="errored",_.status!==404?this._source.fire(new o.j(_,{tile:l})):this.update(this.transform,this.terrain)}})}_unloadTile(l){this._source.unloadTile&&this._source.unloadTile(l)}_abortTile(l){this._source.abortTile&&this._source.abortTile(l),this._source.fire(new o.k("dataabort",{tile:l,coord:l.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const y=this._tiles[d];y.upload(l),y.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(l=>l.tileID).sort(Tt).map(l=>l.key)}getRenderableIds(l){const d=[];for(const y in this._tiles)this._isIdRenderable(y,l)&&d.push(this._tiles[y]);return l?d.sort((y,_)=>{const E=y.tileID,P=_.tileID,R=new o.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle),g=new o.P(P.canonical.x,P.canonical.y)._rotate(this.transform.angle);return E.overscaledZ-P.overscaledZ||g.y-R.y||g.x-R.x}).map(y=>y.tileID.key):d.map(y=>y.tileID).sort(Tt).map(y=>y.key)}hasRenderableParent(l){const d=this.findLoadedParent(l,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(l,d){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(d||!this._tiles[l].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading")}}_reloadTile(l,d){return o._(this,void 0,void 0,function*(){const y=this._tiles[l];y&&(y.state!=="loading"&&(y.state=d),yield this._loadTile(y,l,d))})}_tileLoaded(l,d,y){l.timeAdded=v.now(),y==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(d,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),l.aborted||this._source.fire(new o.k("data",{dataType:"source",tile:l,coord:l.tileID}))}_backfillDEM(l){const d=this.getRenderableIds();for(let _=0;_<d.length;_++){const E=d[_];if(l.neighboringTiles&&l.neighboringTiles[E]){const P=this.getTileByID(E);y(l,P),y(P,l)}}function y(_,E){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let P=E.tileID.canonical.x-_.tileID.canonical.x;const R=E.tileID.canonical.y-_.tileID.canonical.y,g=Math.pow(2,_.tileID.canonical.z),w=E.tileID.key;P===0&&R===0||Math.abs(R)>1||(Math.abs(P)>1&&(Math.abs(P+g)===1?P+=g:Math.abs(P-g)===1&&(P-=g)),E.dem&&_.dem&&(_.dem.backfillBorder(E.dem,P,R),_.neighboringTiles&&_.neighboringTiles[w]&&(_.neighboringTiles[w].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,d,y,_){for(const E in this._tiles){let P=this._tiles[E];if(_[E]||!P.hasData()||P.tileID.overscaledZ<=d||P.tileID.overscaledZ>y)continue;let R=P.tileID;for(;P&&P.tileID.overscaledZ>d+1;){const w=P.tileID.scaledTo(P.tileID.overscaledZ-1);P=this._tiles[w.key],P&&P.hasData()&&(R=w)}let g=R;for(;g.overscaledZ>d;)if(g=g.scaledTo(g.overscaledZ-1),l[g.key]){_[R.key]=R;break}}}findLoadedParent(l,d){if(l.key in this._loadedParentTiles){const y=this._loadedParentTiles[l.key];return y&&y.tileID.overscaledZ>=d?y:null}for(let y=l.overscaledZ-1;y>=d;y--){const _=l.scaledTo(y),E=this._getLoadedTile(_);if(E)return E}}_getLoadedTile(l){const d=this._tiles[l.key];return d&&d.hasData()?d:this._cache.getByKey(l.wrapped().key)}updateCacheSize(l){const d=Math.ceil(l.width/this._source.tileSize)+1,y=Math.ceil(l.height/this._source.tileSize)+1,_=Math.floor(d*y*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),E=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(E)}handleWrapJump(l){const d=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,d){const y={};for(const _ in this._tiles){const E=this._tiles[_];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+d),y[E.tileID.key]=E}this._tiles=y;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(_,this._tiles[_])}}update(l,d){if(!this._sourceLoaded||this._paused)return;let y;this.transform=l,this.terrain=d,this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?y=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(T=>new o.Q(T.canonical.z,T.wrap,T.canonical.z,T.canonical.x,T.canonical.y)):(y=l.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:d}),this._source.hasTile&&(y=y.filter(T=>this._source.hasTile(T)))):y=[];const _=l.coveringZoomLevel(this._source),E=Math.max(_-Mr.maxOverzooming,this._source.minzoom),P=Math.max(_+Mr.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const T={};for(const L of y)if(L.canonical.z>this._source.minzoom){const D=L.scaledTo(L.canonical.z-1);T[D.key]=D;const H=L.scaledTo(Math.max(this._source.minzoom,Math.min(L.canonical.z,5)));T[H.key]=H}y=y.concat(Object.values(T))}const R=y.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,R&&this.fire(new o.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const g=this._updateRetainedTiles(y,_);if(Jt(this._source.type)){const T={},L={},D=Object.keys(g),H=v.now();for(const z of D){const j=g[z],V=this._tiles[z];if(!V||V.fadeEndTime!==0&&V.fadeEndTime<=H)continue;const X=this.findLoadedParent(j,E);X&&(this._addTile(X.tileID),T[X.tileID.key]=X.tileID),L[z]=j}this._retainLoadedChildren(L,_,P,g);for(const z in T)g[z]||(this._coveredTiles[z]=!0,g[z]=T[z]);if(d){const z={},j={};for(const V of y)this._tiles[V.key].hasData()?z[V.key]=V:j[V.key]=V;for(const V in j){const X=j[V].children(this._source.maxzoom);this._tiles[X[0].key]&&this._tiles[X[1].key]&&this._tiles[X[2].key]&&this._tiles[X[3].key]&&(z[X[0].key]=g[X[0].key]=X[0],z[X[1].key]=g[X[1].key]=X[1],z[X[2].key]=g[X[2].key]=X[2],z[X[3].key]=g[X[3].key]=X[3],delete j[V])}for(const V in j){const X=this.findLoadedParent(j[V],this._source.minzoom);if(X){z[X.tileID.key]=g[X.tileID.key]=X.tileID;for(const ue in z)z[ue].isChildOf(X.tileID)&&delete z[ue]}}for(const V in this._tiles)z[V]||(this._coveredTiles[V]=!0)}}for(const T in g)this._tiles[T].clearFadeHold();const w=o.ab(this._tiles,g);for(const T of w){const L=this._tiles[T];L.hasSymbolBuckets&&!L.holdingForFade()?L.setHoldDuration(this.map._fadeDuration):L.hasSymbolBuckets&&!L.symbolFadeFinished()||this._removeTile(T)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)}_updateRetainedTiles(l,d){const y={},_={},E=Math.max(d-Mr.maxOverzooming,this._source.minzoom),P=Math.max(d+Mr.maxUnderzooming,this._source.minzoom),R={};for(const g of l){const w=this._addTile(g);y[g.key]=g,w.hasData()||d<this._source.maxzoom&&(R[g.key]=g)}this._retainLoadedChildren(R,d,P,y);for(const g of l){let w=this._tiles[g.key];if(w.hasData())continue;if(d+1>this._source.maxzoom){const L=g.children(this._source.maxzoom)[0],D=this.getTile(L);if(D&&D.hasData()){y[L.key]=L;continue}}else{const L=g.children(this._source.maxzoom);if(y[L[0].key]&&y[L[1].key]&&y[L[2].key]&&y[L[3].key])continue}let T=w.wasRequested();for(let L=g.overscaledZ-1;L>=E;--L){const D=g.scaledTo(L);if(_[D.key])break;if(_[D.key]=!0,w=this.getTile(D),!w&&T&&(w=this._addTile(D)),w){const H=w.hasData();if((T||H)&&(y[D.key]=D),T=w.wasRequested(),H)break}}}return y}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const l in this._tiles){const d=[];let y,_=this._tiles[l].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){y=this._loadedParentTiles[_.key];break}d.push(_.key);const E=_.scaledTo(_.overscaledZ-1);if(y=this._getLoadedTile(E),y)break;_=E}for(const E of d)this._loadedParentTiles[E]=y}}_addTile(l){let d=this._tiles[l.key];if(d)return d;d=this._cache.getAndRemove(l),d&&(this._setTileReloadTimer(l.key,d),d.tileID=l,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,d)));const y=d;return d||(d=new Ir(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(d,l.key,d.state)),d.uses++,this._tiles[l.key]=d,y||this._source.fire(new o.k("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(l,d){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);const y=d.getExpiryTimeout();y&&(this._timers[l]=setTimeout(()=>{this._reloadTile(l,"expired"),delete this._timers[l]},y))}_removeTile(l){const d=this._tiles[l];d&&(d.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}_dataHandler(l){const d=l.sourceDataType;l.dataType==="source"&&d==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&l.dataType==="source"&&d==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(l);this._cache.reset()}tilesIn(l,d,y){const _=[],E=this.transform;if(!E)return _;const P=y?E.getCameraQueryGeometry(l):l,R=l.map(z=>E.pointCoordinate(z,this.terrain)),g=P.map(z=>E.pointCoordinate(z,this.terrain)),w=this.getIds();let T=1/0,L=1/0,D=-1/0,H=-1/0;for(const z of g)T=Math.min(T,z.x),L=Math.min(L,z.y),D=Math.max(D,z.x),H=Math.max(H,z.y);for(let z=0;z<w.length;z++){const j=this._tiles[w[z]];if(j.holdingForFade())continue;const V=j.tileID,X=Math.pow(2,E.zoom-j.tileID.overscaledZ),ue=d*j.queryPadding*o.W/j.tileSize/X,ne=[V.getTilePoint(new o.Y(T,L)),V.getTilePoint(new o.Y(D,H))];if(ne[0].x-ue<o.W&&ne[0].y-ue<o.W&&ne[1].x+ue>=0&&ne[1].y+ue>=0){const de=R.map(Ue=>V.getTilePoint(Ue)),me=g.map(Ue=>V.getTilePoint(Ue));_.push({tile:j,tileID:V,queryGeometry:de,cameraQueryGeometry:me,scale:X})}}return _}getVisibleCoordinates(l){const d=this.getRenderableIds(l).map(y=>this._tiles[y].tileID);for(const y of d)y.posMatrix=this.transform.calculatePosMatrix(y.toUnwrapped());return d}hasTransition(){if(this._source.hasTransition())return!0;if(Jt(this._source.type)){const l=v.now();for(const d in this._tiles)if(this._tiles[d].fadeEndTime>=l)return!0}return!1}setFeatureState(l,d,y){this._state.updateState(l=l||"_geojsonTileLayer",d,y)}removeFeatureState(l,d,y){this._state.removeFeatureState(l=l||"_geojsonTileLayer",d,y)}getFeatureState(l,d){return this._state.getState(l=l||"_geojsonTileLayer",d)}setDependencies(l,d,y){const _=this._tiles[l];_&&_.setDependencies(d,y)}reloadTilesForDependencies(l,d){for(const y in this._tiles)this._tiles[y].hasDependency(l,d)&&this._reloadTile(y,"reloading");this._cache.filter(y=>!y.hasDependency(l,d))}}function Tt(C,l){const d=Math.abs(2*C.wrap)-+(C.wrap<0),y=Math.abs(2*l.wrap)-+(l.wrap<0);return C.overscaledZ-l.overscaledZ||y-d||l.canonical.y-C.canonical.y||l.canonical.x-C.canonical.x}function Jt(C){return C==="raster"||C==="image"||C==="video"}Mr.maxOverzooming=10,Mr.maxUnderzooming=3;class Kt{constructor(l,d){this.reset(l,d)}reset(l,d){this.points=l||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=o.ac(l,0,1);let d=1,y=this._distances[d];const _=l*this.paddedLength+this.padding;for(;y<_&&d<this._distances.length;)y=this._distances[++d];const E=d-1,P=this._distances[E],R=y-P,g=R>0?(_-P)/R:0;return this.points[E].mult(1-g).add(this.points[d].mult(g))}}function Yr(C,l){let d=!0;return C==="always"||C!=="never"&&l!=="never"||(d=!1),d}class Or{constructor(l,d,y){const _=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(l/y),this.yCellCount=Math.ceil(d/y);for(let P=0;P<this.xCellCount*this.yCellCount;P++)_.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=d,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,d,y,_,E){this._forEachCell(d,y,_,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(d),this.bboxes.push(y),this.bboxes.push(_),this.bboxes.push(E)}insertCircle(l,d,y,_){this._forEachCell(d-_,y-_,d+_,y+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(d),this.circles.push(y),this.circles.push(_)}_insertBoxCell(l,d,y,_,E,P){this.boxCells[E].push(P)}_insertCircleCell(l,d,y,_,E,P){this.circleCells[E].push(P)}_query(l,d,y,_,E,P,R){if(y<0||l>this.width||_<0||d>this.height)return[];const g=[];if(l<=0&&d<=0&&this.width<=y&&this.height<=_){if(E)return[{key:null,x1:l,y1:d,x2:y,y2:_}];for(let w=0;w<this.boxKeys.length;w++)g.push({key:this.boxKeys[w],x1:this.bboxes[4*w],y1:this.bboxes[4*w+1],x2:this.bboxes[4*w+2],y2:this.bboxes[4*w+3]});for(let w=0;w<this.circleKeys.length;w++){const T=this.circles[3*w],L=this.circles[3*w+1],D=this.circles[3*w+2];g.push({key:this.circleKeys[w],x1:T-D,y1:L-D,x2:T+D,y2:L+D})}}else this._forEachCell(l,d,y,_,this._queryCell,g,{hitTest:E,overlapMode:P,seenUids:{box:{},circle:{}}},R);return g}query(l,d,y,_){return this._query(l,d,y,_,!1,null)}hitTest(l,d,y,_,E,P){return this._query(l,d,y,_,!0,E,P).length>0}hitTestCircle(l,d,y,_,E){const P=l-y,R=l+y,g=d-y,w=d+y;if(R<0||P>this.width||w<0||g>this.height)return!1;const T=[];return this._forEachCell(P,g,R,w,this._queryCellCircle,T,{hitTest:!0,overlapMode:_,circle:{x:l,y:d,radius:y},seenUids:{box:{},circle:{}}},E),T.length>0}_queryCell(l,d,y,_,E,P,R,g){const{seenUids:w,hitTest:T,overlapMode:L}=R,D=this.boxCells[E];if(D!==null){const z=this.bboxes;for(const j of D)if(!w.box[j]){w.box[j]=!0;const V=4*j,X=this.boxKeys[j];if(l<=z[V+2]&&d<=z[V+3]&&y>=z[V+0]&&_>=z[V+1]&&(!g||g(X))&&(!T||!Yr(L,X.overlapMode))&&(P.push({key:X,x1:z[V],y1:z[V+1],x2:z[V+2],y2:z[V+3]}),T))return!0}}const H=this.circleCells[E];if(H!==null){const z=this.circles;for(const j of H)if(!w.circle[j]){w.circle[j]=!0;const V=3*j,X=this.circleKeys[j];if(this._circleAndRectCollide(z[V],z[V+1],z[V+2],l,d,y,_)&&(!g||g(X))&&(!T||!Yr(L,X.overlapMode))){const ue=z[V],ne=z[V+1],de=z[V+2];if(P.push({key:X,x1:ue-de,y1:ne-de,x2:ue+de,y2:ne+de}),T)return!0}}}return!1}_queryCellCircle(l,d,y,_,E,P,R,g){const{circle:w,seenUids:T,overlapMode:L}=R,D=this.boxCells[E];if(D!==null){const z=this.bboxes;for(const j of D)if(!T.box[j]){T.box[j]=!0;const V=4*j,X=this.boxKeys[j];if(this._circleAndRectCollide(w.x,w.y,w.radius,z[V+0],z[V+1],z[V+2],z[V+3])&&(!g||g(X))&&!Yr(L,X.overlapMode))return P.push(!0),!0}}const H=this.circleCells[E];if(H!==null){const z=this.circles;for(const j of H)if(!T.circle[j]){T.circle[j]=!0;const V=3*j,X=this.circleKeys[j];if(this._circlesCollide(z[V],z[V+1],z[V+2],w.x,w.y,w.radius)&&(!g||g(X))&&!Yr(L,X.overlapMode))return P.push(!0),!0}}}_forEachCell(l,d,y,_,E,P,R,g){const w=this._convertToXCellCoord(l),T=this._convertToYCellCoord(d),L=this._convertToXCellCoord(y),D=this._convertToYCellCoord(_);for(let H=w;H<=L;H++)for(let z=T;z<=D;z++)if(E.call(this,l,d,y,_,this.xCellCount*z+H,P,R,g))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,d,y,_,E,P){const R=_-l,g=E-d,w=y+P;return w*w>R*R+g*g}_circleAndRectCollide(l,d,y,_,E,P,R){const g=(P-_)/2,w=Math.abs(l-(_+g));if(w>g+y)return!1;const T=(R-E)/2,L=Math.abs(d-(E+T));if(L>T+y)return!1;if(w<=g||L<=T)return!0;const D=w-g,H=L-T;return D*D+H*H<=y*y}}function gr(C,l,d,y,_){const E=o.F();return l?(o.J(E,E,[1/_,1/_,1]),d||o.ad(E,E,y.angle)):o.K(E,y.labelPlaneMatrix,C),E}function an(C,l,d,y,_){if(l){const E=o.ae(C);return o.J(E,E,[_,_,1]),d||o.ad(E,E,-y.angle),E}return y.glCoordMatrix}function Wr(C,l,d){let y;d?(y=[C.x,C.y,d(C.x,C.y),1],o.af(y,y,l)):(y=[C.x,C.y,0,1],Vt(y,y,l));const _=y[3];return{point:new o.P(y[0]/_,y[1]/_),signedDistanceFromCamera:_}}function Ee(C,l){return .5+C/l*.5}function ee(C,l){const d=C[0]/C[3],y=C[1]/C[3];return d>=-l[0]&&d<=l[0]&&y>=-l[1]&&y<=l[1]}function Z(C,l,d,y,_,E,P,R,g,w){const T=y?C.textSizeData:C.iconSizeData,L=o.ag(T,d.transform.zoom),D=[256/d.width*2+1,256/d.height*2+1],H=y?C.text.dynamicLayoutVertexArray:C.icon.dynamicLayoutVertexArray;H.clear();const z=C.lineVertexArray,j=y?C.text.placedSymbolArray:C.icon.placedSymbolArray,V=d.transform.width/d.transform.height;let X=!1;for(let ue=0;ue<j.length;ue++){const ne=j.get(ue);if(ne.hidden||ne.writingMode===o.ah.vertical&&!X){ft(ne.numGlyphs,H);continue}let de;if(X=!1,w?(de=[ne.anchorX,ne.anchorY,w(ne.anchorX,ne.anchorY),1],o.af(de,de,l)):(de=[ne.anchorX,ne.anchorY,0,1],Vt(de,de,l)),!ee(de,D)){ft(ne.numGlyphs,H);continue}const me=Ee(d.transform.cameraToCenterDistance,de[3]),Ue=o.ai(T,L,ne),Ie=P?Ue/me:Ue*me,ve=new o.P(ne.anchorX,ne.anchorY),we=Wr(ve,_,w).point,Ve={projections:{},offsets:{}},Xe=Qe(ne,Ie,!1,R,l,_,E,C.glyphOffsetArray,z,H,we,ve,Ve,V,g,w);X=Xe.useVertical,(Xe.notEnoughRoom||X||Xe.needsFlipping&&Qe(ne,Ie,!0,R,l,_,E,C.glyphOffsetArray,z,H,we,ve,Ve,V,g,w).notEnoughRoom)&&ft(ne.numGlyphs,H)}y?C.text.dynamicLayoutVertexBuffer.updateData(H):C.icon.dynamicLayoutVertexBuffer.updateData(H)}function ae(C,l,d,y,_,E,P,R,g,w,T,L,D){const H=R.glyphStartIndex+R.numGlyphs,z=R.lineStartIndex,j=R.lineStartIndex+R.lineLength,V=l.getoffsetX(R.glyphStartIndex),X=l.getoffsetX(H-1),ue=yt(C*V,d,y,_,E,P,R.segment,z,j,g,w,T,L,D);if(!ue)return null;const ne=yt(C*X,d,y,_,E,P,R.segment,z,j,g,w,T,L,D);return ne?{first:ue,last:ne}:null}function Se(C,l,d,y){return C===o.ah.horizontal&&Math.abs(d.y-l.y)>Math.abs(d.x-l.x)*y?{useVertical:!0}:(C===o.ah.vertical?l.y<d.y:l.x>d.x)?{needsFlipping:!0}:null}function Qe(C,l,d,y,_,E,P,R,g,w,T,L,D,H,z,j){const V=l/24,X=C.lineOffsetX*V,ue=C.lineOffsetY*V;let ne;if(C.numGlyphs>1){const de=C.glyphStartIndex+C.numGlyphs,me=C.lineStartIndex,Ue=C.lineStartIndex+C.lineLength,Ie=ae(V,R,X,ue,d,T,L,C,g,E,D,z,j);if(!Ie)return{notEnoughRoom:!0};const ve=Wr(Ie.first.point,P,j).point,we=Wr(Ie.last.point,P,j).point;if(y&&!d){const Ve=Se(C.writingMode,ve,we,H);if(Ve)return Ve}ne=[Ie.first];for(let Ve=C.glyphStartIndex+1;Ve<de-1;Ve++)ne.push(yt(V*R.getoffsetX(Ve),X,ue,d,T,L,C.segment,me,Ue,g,E,D,z,j));ne.push(Ie.last)}else{if(y&&!d){const me=Wr(L,_,j).point,Ue=C.lineStartIndex+C.segment+1,Ie=new o.P(g.getx(Ue),g.gety(Ue)),ve=Wr(Ie,_,j),we=ve.signedDistanceFromCamera>0?ve.point:Ge(L,Ie,me,1,_,j),Ve=Se(C.writingMode,me,we,H);if(Ve)return Ve}const de=yt(V*R.getoffsetX(C.glyphStartIndex),X,ue,d,T,L,C.segment,C.lineStartIndex,C.lineStartIndex+C.lineLength,g,E,D,z,j);if(!de)return{notEnoughRoom:!0};ne=[de]}for(const de of ne)o.aj(w,de.point,de.angle);return{}}function Ge(C,l,d,y,_,E){const P=Wr(C.add(C.sub(l)._unit()),_,E).point,R=d.sub(P);return d.add(R._mult(y/R.mag()))}function Ke(C,l){const{projectionCache:d,lineVertexArray:y,labelPlaneMatrix:_,tileAnchorPoint:E,distanceFromAnchor:P,getElevation:R,previousVertex:g,direction:w,absOffsetX:T}=l;if(d.projections[C])return d.projections[C];const L=new o.P(y.getx(C),y.gety(C)),D=Wr(L,_,R);if(D.signedDistanceFromCamera>0)return d.projections[C]=D.point,D.point;const H=C-w;return Ge(P===0?E:new o.P(y.getx(H),y.gety(H)),L,g,T-P+1,_,R)}function Te(C,l,d){return C._unit()._perp()._mult(l*d)}function Ze(C,l,d,y,_,E,P,R){const{projectionCache:g,direction:w}=R;if(g.offsets[C])return g.offsets[C];const T=d.add(l);if(C+w<y||C+w>=_)return g.offsets[C]=T,T;const L=Ke(C+w,R),D=Te(L.sub(d),P,w),H=d.add(D),z=L.add(D);return g.offsets[C]=o.ak(E,T,H,z)||T,g.offsets[C]}function yt(C,l,d,y,_,E,P,R,g,w,T,L,D,H){const z=y?C-l:C+l;let j=z>0?1:-1,V=0;y&&(j*=-1,V=Math.PI),j<0&&(V+=Math.PI);let X,ue,ne=j>0?R+P:R+P+1,de=_,me=_,Ue=0,Ie=0;const ve=Math.abs(z),we=[];let Ve;for(;Ue+Ie<=ve;){if(ne+=j,ne<R||ne>=g)return null;Ue+=Ie,me=de,ue=X;const ht={projectionCache:L,lineVertexArray:w,labelPlaneMatrix:T,tileAnchorPoint:E,distanceFromAnchor:Ue,getElevation:H,previousVertex:me,direction:j,absOffsetX:ve};if(de=Ke(ne,ht),d===0)we.push(me),Ve=de.sub(me);else{let _t;const Ot=de.sub(me);_t=Ot.mag()===0?Te(Ke(ne+j,ht).sub(de),d,j):Te(Ot,d,j),ue||(ue=me.add(_t)),X=Ze(ne,_t,de,R,g,ue,d,ht),we.push(ue),Ve=X.sub(ue)}Ie=Ve.mag()}const Xe=Ve._mult((ve-Ue)/Ie)._add(ue||me),At=V+Math.atan2(de.y-me.y,de.x-me.x);return we.push(Xe),{point:Xe,angle:D?At:0,path:we}}const gt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ft(C,l){for(let d=0;d<C;d++){const y=l.length;l.resize(y+4),l.float32.set(gt,3*y)}}function Vt(C,l,d){const y=l[0],_=l[1];return C[0]=d[0]*y+d[4]*_+d[12],C[1]=d[1]*y+d[5]*_+d[13],C[3]=d[3]*y+d[7]*_+d[15],C}const Yt=100;class Er{constructor(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Or(l.width+200,l.height+200,25),y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new Or(l.width+200,l.height+200,25);this.transform=l,this.grid=d,this.ignoredGrid=y,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Yt,this.screenBottomBoundary=l.height+Yt,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(l,d,y,_,E,P){const R=this.projectAndGetPerspectiveRatio(_,l.anchorPointX,l.anchorPointY,P),g=y*R.perspectiveRatio,w=l.x1*g+R.point.x,T=l.y1*g+R.point.y,L=l.x2*g+R.point.x,D=l.y2*g+R.point.y;return!this.isInsideGrid(w,T,L,D)||d!=="always"&&this.grid.hitTest(w,T,L,D,d,E)||R.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[w,T,L,D],offscreen:this.isOffscreen(w,T,L,D)}}placeCollisionCircles(l,d,y,_,E,P,R,g,w,T,L,D,H,z){const j=[],V=new o.P(d.anchorX,d.anchorY),X=Wr(V,P,z),ue=Ee(this.transform.cameraToCenterDistance,X.signedDistanceFromCamera),ne=(T?E/ue:E*ue)/o.ao,de=Wr(V,R,z).point,me=ae(ne,_,d.lineOffsetX*ne,d.lineOffsetY*ne,!1,de,V,d,y,R,{projections:{},offsets:{}},!1,z);let Ue=!1,Ie=!1,ve=!0;if(me){const we=.5*D*ue+H,Ve=new o.P(-100,-100),Xe=new o.P(this.screenRightBoundary,this.screenBottomBoundary),At=new Kt,ht=me.first,_t=me.last;let Ot=[];for(let nr=ht.path.length-1;nr>=1;nr--)Ot.push(ht.path[nr]);for(let nr=1;nr<_t.path.length;nr++)Ot.push(_t.path[nr]);const Et=2.5*we;if(g){const nr=Ot.map(rr=>Wr(rr,g,z));Ot=nr.some(rr=>rr.signedDistanceFromCamera<=0)?[]:nr.map(rr=>rr.point)}let $t=[];if(Ot.length>0){const nr=Ot[0].clone(),rr=Ot[0].clone();for(let Sr=1;Sr<Ot.length;Sr++)nr.x=Math.min(nr.x,Ot[Sr].x),nr.y=Math.min(nr.y,Ot[Sr].y),rr.x=Math.max(rr.x,Ot[Sr].x),rr.y=Math.max(rr.y,Ot[Sr].y);$t=nr.x>=Ve.x&&rr.x<=Xe.x&&nr.y>=Ve.y&&rr.y<=Xe.y?[Ot]:rr.x<Ve.x||nr.x>Xe.x||rr.y<Ve.y||nr.y>Xe.y?[]:o.al([Ot],Ve.x,Ve.y,Xe.x,Xe.y)}for(const nr of $t){At.reset(nr,.25*we);let rr=0;rr=At.length<=.5*we?1:Math.ceil(At.paddedLength/Et)+1;for(let Sr=0;Sr<rr;Sr++){const Fr=Sr/Math.max(rr-1,1),en=At.lerp(Fr),xr=en.x+Yt,Jr=en.y+Yt;j.push(xr,Jr,we,0);const Cn=xr-we,En=Jr-we,di=xr+we,dn=Jr+we;if(ve=ve&&this.isOffscreen(Cn,En,di,dn),Ie=Ie||this.isInsideGrid(Cn,En,di,dn),l!=="always"&&this.grid.hitTestCircle(xr,Jr,we,l,L)&&(Ue=!0,!w))return{circles:[],offscreen:!1,collisionDetected:Ue}}}}return{circles:!w&&Ue||!Ie||ue<this.perspectiveRatioCutoff?[]:j,offscreen:ve,collisionDetected:Ue}}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let y=1/0,_=1/0,E=-1/0,P=-1/0;for(const T of l){const L=new o.P(T.x+Yt,T.y+Yt);y=Math.min(y,L.x),_=Math.min(_,L.y),E=Math.max(E,L.x),P=Math.max(P,L.y),d.push(L)}const R=this.grid.query(y,_,E,P).concat(this.ignoredGrid.query(y,_,E,P)),g={},w={};for(const T of R){const L=T.key;if(g[L.bucketInstanceId]===void 0&&(g[L.bucketInstanceId]={}),g[L.bucketInstanceId][L.featureIndex])continue;const D=[new o.P(T.x1,T.y1),new o.P(T.x2,T.y1),new o.P(T.x2,T.y2),new o.P(T.x1,T.y2)];o.am(d,D)&&(g[L.bucketInstanceId][L.featureIndex]=!0,w[L.bucketInstanceId]===void 0&&(w[L.bucketInstanceId]=[]),w[L.bucketInstanceId].push(L.featureIndex))}return w}insertCollisionBox(l,d,y,_,E,P){(y?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:E,collisionGroupID:P,overlapMode:d},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,d,y,_,E,P){const R=y?this.ignoredGrid:this.grid,g={bucketInstanceId:_,featureIndex:E,collisionGroupID:P,overlapMode:d};for(let w=0;w<l.length;w+=4)R.insertCircle(g,l[w],l[w+1],l[w+2])}projectAndGetPerspectiveRatio(l,d,y,_){let E;return _?(E=[d,y,_(d,y),1],o.af(E,E,l)):(E=[d,y,0,1],Vt(E,E,l)),{point:new o.P((E[0]/E[3]+1)/2*this.transform.width+Yt,(-E[1]/E[3]+1)/2*this.transform.height+Yt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/E[3]*.5}}isOffscreen(l,d,y,_){return y<Yt||l>=this.screenRightBoundary||_<Yt||d>this.screenBottomBoundary}isInsideGrid(l,d,y,_){return y>=0&&l<this.gridRightBoundary&&_>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const l=o.an([]);return o.H(l,l,[-100,-100,0]),l}}function lr(C,l,d){return l*(o.W/(C.tileSize*Math.pow(2,d-C.tileID.overscaledZ)))}class Ur{constructor(l,d,y,_){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?d:-d))):_&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class Nr{constructor(l,d,y,_,E){this.text=new Ur(l?l.text:null,d,y,E),this.icon=new Ur(l?l.icon:null,d,_,E)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Hr{constructor(l,d,y){this.text=l,this.icon=d,this.skipFade=y}}class mn{constructor(){this.invProjMatrix=o.F(),this.viewportMatrix=o.F(),this.circles=[]}}class mr{constructor(l,d,y,_,E){this.bucketInstanceId=l,this.featureIndex=d,this.sourceLayerIndex=y,this.bucketIndex=_,this.tileID=E}}class $r{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const d=++this.maxGroupID;this.collisionGroups[l]={ID:d,predicate:y=>y.collisionGroupID===d}}return this.collisionGroups[l]}}function bn(C,l,d,y,_){const{horizontalAlign:E,verticalAlign:P}=o.at(C);return new o.P(-(E-.5)*l+y[0]*_,-(P-.5)*d+y[1]*_)}function kn(C,l,d,y,_,E){const{x1:P,x2:R,y1:g,y2:w,anchorPointX:T,anchorPointY:L}=C,D=new o.P(l,d);return y&&D._rotate(_?E:-E),{x1:P+D.x,y1:g+D.y,x2:R+D.x,y2:w+D.y,anchorPointX:T,anchorPointY:L}}class ke{constructor(l,d,y,_,E){this.transform=l.clone(),this.terrain=d,this.collisionIndex=new Er(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=y,this.retainedQueryData={},this.collisionGroups=new $r(_),this.collisionCircleArrays={},this.prevPlacement=E,E&&(E.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,d,y,_){const E=y.getBucket(d),P=y.latestFeatureIndex;if(!E||!P||d.id!==E.layerIds[0])return;const R=y.collisionBoxArray,g=E.layers[0].layout,w=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),T=y.tileSize/o.W,L=this.transform.calculatePosMatrix(y.tileID.toUnwrapped()),D=g.get("text-pitch-alignment")==="map",H=g.get("text-rotation-alignment")==="map",z=lr(y,1,this.transform.zoom),j=gr(L,D,H,this.transform,z);let V=null;if(D){const ue=an(L,D,H,this.transform,z);V=o.K([],this.transform.labelPlaneMatrix,ue)}this.retainedQueryData[E.bucketInstanceId]=new mr(E.bucketInstanceId,P,E.sourceLayerIndex,E.index,y.tileID);const X={bucket:E,layout:g,posMatrix:L,textLabelPlaneMatrix:j,labelToScreenMatrix:V,scale:w,textPixelRatio:T,holdingForFade:y.holdingForFade(),collisionBoxArray:R,partiallyEvaluatedTextSize:o.ag(E.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(_)for(const ue of E.sortKeyRanges){const{sortKey:ne,symbolInstanceStart:de,symbolInstanceEnd:me}=ue;l.push({sortKey:ne,symbolInstanceStart:de,symbolInstanceEnd:me,parameters:X})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:X})}attemptAnchorPlacement(l,d,y,_,E,P,R,g,w,T,L,D,H,z,j,V){const X=o.ap[l.textAnchor],ue=[l.textOffset0,l.textOffset1],ne=bn(X,y,_,ue,E),de=this.collisionIndex.placeCollisionBox(kn(d,ne.x,ne.y,P,R,this.transform.angle),L,g,w,T.predicate,V);if((!j||this.collisionIndex.placeCollisionBox(kn(j,ne.x,ne.y,P,R,this.transform.angle),L,g,w,T.predicate,V).box.length!==0)&&de.box.length>0){let me;if(this.prevPlacement&&this.prevPlacement.variableOffsets[D.crossTileID]&&this.prevPlacement.placements[D.crossTileID]&&this.prevPlacement.placements[D.crossTileID].text&&(me=this.prevPlacement.variableOffsets[D.crossTileID].anchor),D.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[D.crossTileID]={textOffset:ue,width:y,height:_,anchor:X,textBoxScale:E,prevAnchor:me},this.markUsedJustification(H,X,D,z),H.allowVerticalPlacement&&(this.markUsedOrientation(H,z,D),this.placedOrientations[D.crossTileID]=z),{shift:ne,placedGlyphBoxes:de}}}placeLayerBucketPart(l,d,y){const{bucket:_,layout:E,posMatrix:P,textLabelPlaneMatrix:R,labelToScreenMatrix:g,textPixelRatio:w,holdingForFade:T,collisionBoxArray:L,partiallyEvaluatedTextSize:D,collisionGroup:H}=l.parameters,z=E.get("text-optional"),j=E.get("icon-optional"),V=o.aq(E,"text-overlap","text-allow-overlap"),X=V==="always",ue=o.aq(E,"icon-overlap","icon-allow-overlap"),ne=ue==="always",de=E.get("text-rotation-alignment")==="map",me=E.get("text-pitch-alignment")==="map",Ue=E.get("icon-text-fit")!=="none",Ie=E.get("symbol-z-order")==="viewport-y",ve=X&&(ne||!_.hasIconData()||j),we=ne&&(X||!_.hasTextData()||z);!_.collisionArrays&&L&&_.deserializeCollisionBoxes(L);const Ve=this.retainedQueryData[_.bucketInstanceId].tileID,Xe=this.terrain?(ht,_t)=>this.terrain.getElevation(Ve,ht,_t):null,At=(ht,_t)=>{var Ot,Et;if(d[ht.crossTileID])return;if(T)return void(this.placements[ht.crossTileID]=new Hr(!1,!1,!1));let $t=!1,nr=!1,rr=!0,Sr=null,Fr={box:null,offscreen:null},en={box:null,offscreen:null},xr=null,Jr=null,Cn=null,En=0,di=0,dn=0;_t.textFeatureIndex?En=_t.textFeatureIndex:ht.useRuntimeCollisionCircles&&(En=ht.featureIndex),_t.verticalTextFeatureIndex&&(di=_t.verticalTextFeatureIndex);const ls=_t.textBox;if(ls){const fn=un=>{let Sn=o.ah.horizontal;if(_.allowVerticalPlacement&&!un&&this.prevPlacement){const Xi=this.prevPlacement.placedOrientations[ht.crossTileID];Xi&&(this.placedOrientations[ht.crossTileID]=Xi,Sn=Xi,this.markUsedOrientation(_,Sn,ht))}return Sn},on=(un,Sn)=>{if(_.allowVerticalPlacement&&ht.numVerticalGlyphVertices>0&&_t.verticalTextBox){for(const Xi of _.writingModes)if(Xi===o.ah.vertical?(Fr=Sn(),en=Fr):Fr=un(),Fr&&Fr.box&&Fr.box.length)break}else Fr=un()},pn=ht.textAnchorOffsetStartIndex,Si=ht.textAnchorOffsetEndIndex;if(Si===pn){const un=(Sn,Xi)=>{const ti=this.collisionIndex.placeCollisionBox(Sn,V,w,P,H.predicate,Xe);return ti&&ti.box&&ti.box.length&&(this.markUsedOrientation(_,Xi,ht),this.placedOrientations[ht.crossTileID]=Xi),ti};on(()=>un(ls,o.ah.horizontal),()=>{const Sn=_t.verticalTextBox;return _.allowVerticalPlacement&&ht.numVerticalGlyphVertices>0&&Sn?un(Sn,o.ah.vertical):{box:null,offscreen:null}}),fn(Fr&&Fr.box&&Fr.box.length)}else{let un=o.ap[(Et=(Ot=this.prevPlacement)===null||Ot===void 0?void 0:Ot.variableOffsets[ht.crossTileID])===null||Et===void 0?void 0:Et.anchor];const Sn=(ti,Rn,oi)=>{const ch=ti.x2-ti.x1,Ic=ti.y2-ti.y1,Lc=ht.textBoxScale,Sl=Ue&&ue==="never"?Rn:null;let Eo={box:[],offscreen:!1},pu=V==="never"?1:2,So="never";un&&pu++;for(let Fc=0;Fc<pu;Fc++){for(let Mc=pn;Mc<Si;Mc++){const hA=_.textAnchorOffsets.get(Mc);if(un&&hA.textAnchor!==un)continue;const gu=this.attemptAnchorPlacement(hA,ti,ch,Ic,Lc,de,me,w,P,H,So,ht,_,oi,Sl,Xe);if(gu&&(Eo=gu.placedGlyphBoxes,Eo&&Eo.box&&Eo.box.length))return $t=!0,Sr=gu.shift,Eo}un?un=null:So=V}return Eo};on(()=>Sn(ls,_t.iconBox,o.ah.horizontal),()=>{const ti=_t.verticalTextBox;return _.allowVerticalPlacement&&!(Fr&&Fr.box&&Fr.box.length)&&ht.numVerticalGlyphVertices>0&&ti?Sn(ti,_t.verticalIconBox,o.ah.vertical):{box:null,offscreen:null}}),Fr&&($t=Fr.box,rr=Fr.offscreen);const Xi=fn(Fr&&Fr.box);if(!$t&&this.prevPlacement){const ti=this.prevPlacement.variableOffsets[ht.crossTileID];ti&&(this.variableOffsets[ht.crossTileID]=ti,this.markUsedJustification(_,ti.anchor,ht,Xi))}}}if(xr=Fr,$t=xr&&xr.box&&xr.box.length>0,rr=xr&&xr.offscreen,ht.useRuntimeCollisionCircles){const fn=_.text.placedSymbolArray.get(ht.centerJustifiedTextSymbolIndex),on=o.ai(_.textSizeData,D,fn),pn=E.get("text-padding");Jr=this.collisionIndex.placeCollisionCircles(V,fn,_.lineVertexArray,_.glyphOffsetArray,on,P,R,g,y,me,H.predicate,ht.collisionCircleDiameter,pn,Xe),Jr.circles.length&&Jr.collisionDetected&&!y&&o.w("Collisions detected, but collision boxes are not shown"),$t=X||Jr.circles.length>0&&!Jr.collisionDetected,rr=rr&&Jr.offscreen}if(_t.iconFeatureIndex&&(dn=_t.iconFeatureIndex),_t.iconBox){const fn=on=>{const pn=Ue&&Sr?kn(on,Sr.x,Sr.y,de,me,this.transform.angle):on;return this.collisionIndex.placeCollisionBox(pn,ue,w,P,H.predicate,Xe)};en&&en.box&&en.box.length&&_t.verticalIconBox?(Cn=fn(_t.verticalIconBox),nr=Cn.box.length>0):(Cn=fn(_t.iconBox),nr=Cn.box.length>0),rr=rr&&Cn.offscreen}const Fi=z||ht.numHorizontalGlyphVertices===0&&ht.numVerticalGlyphVertices===0,Gn=j||ht.numIconVertices===0;if(Fi||Gn?Gn?Fi||(nr=nr&&$t):$t=nr&&$t:nr=$t=nr&&$t,$t&&xr&&xr.box&&this.collisionIndex.insertCollisionBox(xr.box,V,E.get("text-ignore-placement"),_.bucketInstanceId,en&&en.box&&di?di:En,H.ID),nr&&Cn&&this.collisionIndex.insertCollisionBox(Cn.box,ue,E.get("icon-ignore-placement"),_.bucketInstanceId,dn,H.ID),Jr&&($t&&this.collisionIndex.insertCollisionCircles(Jr.circles,V,E.get("text-ignore-placement"),_.bucketInstanceId,En,H.ID),y)){const fn=_.bucketInstanceId;let on=this.collisionCircleArrays[fn];on===void 0&&(on=this.collisionCircleArrays[fn]=new mn);for(let pn=0;pn<Jr.circles.length;pn+=4)on.circles.push(Jr.circles[pn+0]),on.circles.push(Jr.circles[pn+1]),on.circles.push(Jr.circles[pn+2]),on.circles.push(Jr.collisionDetected?1:0)}if(ht.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(_.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ht.crossTileID]=new Hr($t||ve,nr||we,rr||_.justReloaded),d[ht.crossTileID]=!0};if(Ie){if(l.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ht=_.getSortedSymbolIndexes(this.transform.angle);for(let _t=ht.length-1;_t>=0;--_t){const Ot=ht[_t];At(_.symbolInstances.get(Ot),_.collisionArrays[Ot])}}else for(let ht=l.symbolInstanceStart;ht<l.symbolInstanceEnd;ht++)At(_.symbolInstances.get(ht),_.collisionArrays[ht]);if(y&&_.bucketInstanceId in this.collisionCircleArrays){const ht=this.collisionCircleArrays[_.bucketInstanceId];o.ar(ht.invProjMatrix,P),ht.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1}markUsedJustification(l,d,y,_){let E;E=_===o.ah.vertical?y.verticalPlacedTextSymbolIndex:{left:y.leftJustifiedTextSymbolIndex,center:y.centerJustifiedTextSymbolIndex,right:y.rightJustifiedTextSymbolIndex}[o.as(d)];const P=[y.leftJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.rightJustifiedTextSymbolIndex,y.verticalPlacedTextSymbolIndex];for(const R of P)R>=0&&(l.text.placedSymbolArray.get(R).crossTileID=E>=0&&R!==E?0:y.crossTileID)}markUsedOrientation(l,d,y){const _=d===o.ah.horizontal||d===o.ah.horizontalOnly?d:0,E=d===o.ah.vertical?d:0,P=[y.leftJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.rightJustifiedTextSymbolIndex];for(const R of P)l.text.placedSymbolArray.get(R).placedOrientation=_;y.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(y.verticalPlacedTextSymbolIndex).placedOrientation=E)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let y=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const _=d?d.symbolFadeChange(l):1,E=d?d.opacities:{},P=d?d.variableOffsets:{},R=d?d.placedOrientations:{};for(const g in this.placements){const w=this.placements[g],T=E[g];T?(this.opacities[g]=new Nr(T,_,w.text,w.icon),y=y||w.text!==T.text.placed||w.icon!==T.icon.placed):(this.opacities[g]=new Nr(null,_,w.text,w.icon,w.skipFade),y=y||w.text||w.icon)}for(const g in E){const w=E[g];if(!this.opacities[g]){const T=new Nr(w,_,!1,!1);T.isHidden()||(this.opacities[g]=T,y=y||w.text.placed||w.icon.placed)}}for(const g in P)this.variableOffsets[g]||!this.opacities[g]||this.opacities[g].isHidden()||(this.variableOffsets[g]=P[g]);for(const g in R)this.placedOrientations[g]||!this.opacities[g]||this.opacities[g].isHidden()||(this.placedOrientations[g]=R[g]);if(d&&d.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");y?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:l)}updateLayerOpacities(l,d){const y={};for(const _ of d){const E=_.getBucket(l);E&&_.latestFeatureIndex&&l.id===E.layerIds[0]&&this.updateBucketOpacities(E,y,_.collisionBoxArray)}}updateBucketOpacities(l,d,y){l.hasTextData()&&(l.text.opacityVertexArray.clear(),l.text.hasVisibleVertices=!1),l.hasIconData()&&(l.icon.opacityVertexArray.clear(),l.icon.hasVisibleVertices=!1),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const _=l.layers[0],E=_.layout,P=new Nr(null,0,!1,!1,!0),R=E.get("text-allow-overlap"),g=E.get("icon-allow-overlap"),w=_._unevaluatedLayout.hasValue("text-variable-anchor")||_._unevaluatedLayout.hasValue("text-variable-anchor-offset"),T=E.get("text-rotation-alignment")==="map",L=E.get("text-pitch-alignment")==="map",D=E.get("icon-text-fit")!=="none",H=new Nr(null,0,R&&(g||!l.hasIconData()||E.get("icon-optional")),g&&(R||!l.hasTextData()||E.get("text-optional")),!0);!l.collisionArrays&&y&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(y);const z=(j,V,X)=>{for(let ue=0;ue<V/4;ue++)j.opacityVertexArray.emplaceBack(X);j.hasVisibleVertices=j.hasVisibleVertices||X!==xi};for(let j=0;j<l.symbolInstances.length;j++){const V=l.symbolInstances.get(j),{numHorizontalGlyphVertices:X,numVerticalGlyphVertices:ue,crossTileID:ne}=V;let de=this.opacities[ne];d[ne]?de=P:de||(de=H,this.opacities[ne]=de),d[ne]=!0;const me=V.numIconVertices>0,Ue=this.placedOrientations[V.crossTileID],Ie=Ue===o.ah.vertical,ve=Ue===o.ah.horizontal||Ue===o.ah.horizontalOnly;if(X>0||ue>0){const we=sn(de.text);z(l.text,X,Ie?xi:we),z(l.text,ue,ve?xi:we);const Ve=de.text.isHidden();[V.rightJustifiedTextSymbolIndex,V.centerJustifiedTextSymbolIndex,V.leftJustifiedTextSymbolIndex].forEach(ht=>{ht>=0&&(l.text.placedSymbolArray.get(ht).hidden=Ve||Ie?1:0)}),V.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(V.verticalPlacedTextSymbolIndex).hidden=Ve||ve?1:0);const Xe=this.variableOffsets[V.crossTileID];Xe&&this.markUsedJustification(l,Xe.anchor,V,Ue);const At=this.placedOrientations[V.crossTileID];At&&(this.markUsedJustification(l,"left",V,At),this.markUsedOrientation(l,At,V))}if(me){const we=sn(de.icon),Ve=!(D&&V.verticalPlacedIconSymbolIndex&&Ie);V.placedIconSymbolIndex>=0&&(z(l.icon,V.numIconVertices,Ve?we:xi),l.icon.placedSymbolArray.get(V.placedIconSymbolIndex).hidden=de.icon.isHidden()),V.verticalPlacedIconSymbolIndex>=0&&(z(l.icon,V.numVerticalIconVertices,Ve?xi:we),l.icon.placedSymbolArray.get(V.verticalPlacedIconSymbolIndex).hidden=de.icon.isHidden())}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const we=l.collisionArrays[j];if(we){let Ve=new o.P(0,0);if(we.textBox||we.verticalTextBox){let At=!0;if(w){const ht=this.variableOffsets[ne];ht?(Ve=bn(ht.anchor,ht.width,ht.height,ht.textOffset,ht.textBoxScale),T&&Ve._rotate(L?this.transform.angle:-this.transform.angle)):At=!1}we.textBox&&Rt(l.textCollisionBox.collisionVertexArray,de.text.placed,!At||Ie,Ve.x,Ve.y),we.verticalTextBox&&Rt(l.textCollisionBox.collisionVertexArray,de.text.placed,!At||ve,Ve.x,Ve.y)}const Xe=!!(!ve&&we.verticalIconBox);we.iconBox&&Rt(l.iconCollisionBox.collisionVertexArray,de.icon.placed,Xe,D?Ve.x:0,D?Ve.y:0),we.verticalIconBox&&Rt(l.iconCollisionBox.collisionVertexArray,de.icon.placed,!Xe,D?Ve.x:0,D?Ve.y:0)}}}if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.text.opacityVertexArray.length!==l.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${l.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${l.text.layoutVertexArray.length}) / 4`);if(l.icon.opacityVertexArray.length!==l.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${l.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${l.icon.layoutVertexArray.length}) / 4`);if(l.bucketInstanceId in this.collisionCircleArrays){const j=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=j.invProjMatrix,l.placementViewportMatrix=j.viewportMatrix,l.collisionCircleArray=j.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,d){const y=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*y>l}setStale(){this.stale=!0}}function Rt(C,l,d,y,_){C.emplaceBack(l?1:0,d?1:0,y||0,_||0),C.emplaceBack(l?1:0,d?1:0,y||0,_||0),C.emplaceBack(l?1:0,d?1:0,y||0,_||0),C.emplaceBack(l?1:0,d?1:0,y||0,_||0)}const Lt=Math.pow(2,25),nn=Math.pow(2,24),Pn=Math.pow(2,17),Br=Math.pow(2,16),yn=Math.pow(2,9),wi=Math.pow(2,8),_n=Math.pow(2,1);function sn(C){if(C.opacity===0&&!C.placed)return 0;if(C.opacity===1&&C.placed)return 4294967295;const l=C.placed?1:0,d=Math.floor(127*C.opacity);return d*Lt+l*nn+d*Pn+l*Br+d*yn+l*wi+d*_n+l}const xi=0;class Jn{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,d,y,_,E){const P=this._bucketParts;for(;this._currentTileIndex<l.length;)if(d.getBucketParts(P,_,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((R,g)=>R.sortKey-g.sortKey));this._currentPartIndex<P.length;)if(d.placeLayerBucketPart(P[this._currentPartIndex],this._seenCrossTileIDs,y),this._currentPartIndex++,E())return!0;return!1}}class as{constructor(l,d,y,_,E,P,R,g){this.placement=new ke(l,d,P,R,g),this._currentPlacementIndex=y.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=E,this._done=!1}isDone(){return this._done}continuePlacement(l,d,y){const _=v.now(),E=()=>!this._forceFullPlacement&&v.now()-_>2;for(;this._currentPlacementIndex>=0;){const P=d[l[this._currentPlacementIndex]],R=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=R)&&(!P.maxzoom||P.maxzoom>R)){if(this._inProgressLayer||(this._inProgressLayer=new Jn(P)),this._inProgressLayer.continuePlacement(y[P.source],this.placement,this._showCollisionBoxes,P,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const Os=512/o.W/2;class zo{constructor(l,d,y){this.tileID=l,this.bucketInstanceId=y,this._symbolsByKey={};const _=new Map;for(let E=0;E<d.length;E++){const P=d.get(E),R=P.key,g=_.get(R);g?g.push(P):_.set(R,[P])}for(const[E,P]of _){const R={positions:P.map(g=>({x:Math.floor(g.anchorX*Os),y:Math.floor(g.anchorY*Os)})),crossTileIDs:P.map(g=>g.crossTileID)};if(R.positions.length>128){const g=new o.au(R.positions.length,16,Uint16Array);for(const{x:w,y:T}of R.positions)g.add(w,T);g.finish(),delete R.positions,R.index=g}this._symbolsByKey[E]=R}}getScaledCoordinates(l,d){const{x:y,y:_,z:E}=this.tileID.canonical,{x:P,y:R,z:g}=d.canonical,w=Os/Math.pow(2,g-E),T=(R*o.W+l.anchorY)*w,L=_*o.W*Os;return{x:Math.floor((P*o.W+l.anchorX)*w-y*o.W*Os),y:Math.floor(T-L)}}findMatches(l,d,y){const _=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let E=0;E<l.length;E++){const P=l.get(E);if(P.crossTileID)continue;const R=this._symbolsByKey[P.key];if(!R)continue;const g=this.getScaledCoordinates(P,d);if(R.index){const w=R.index.range(g.x-_,g.y-_,g.x+_,g.y+_).sort();for(const T of w){const L=R.crossTileIDs[T];if(!y[L]){y[L]=!0,P.crossTileID=L;break}}}else if(R.positions)for(let w=0;w<R.positions.length;w++){const T=R.positions[w],L=R.crossTileIDs[w];if(Math.abs(T.x-g.x)<=_&&Math.abs(T.y-g.y)<=_&&!y[L]){y[L]=!0,P.crossTileID=L;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(l=>{let{crossTileIDs:d}=l;return d})}}class Dr{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Js{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const d=Math.round((l-this.lng)/360);if(d!==0)for(const y in this.indexes){const _=this.indexes[y],E={};for(const P in _){const R=_[P];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+d),E[R.tileID.key]=R}this.indexes[y]=E}this.lng=l}addBucket(l,d,y){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let E=0;E<d.symbolInstances.length;E++)d.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});const _=this.usedCrossTileIDs[l.overscaledZ];for(const E in this.indexes){const P=this.indexes[E];if(Number(E)>l.overscaledZ)for(const R in P){const g=P[R];g.tileID.isChildOf(l)&&g.findMatches(d.symbolInstances,l,_)}else{const R=P[l.scaledTo(Number(E)).key];R&&R.findMatches(d.symbolInstances,l,_)}}for(let E=0;E<d.symbolInstances.length;E++){const P=d.symbolInstances.get(E);P.crossTileID||(P.crossTileID=y.generate(),_[P.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new zo(l,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(l,d){for(const y of d.getCrossTileIDsLists())for(const _ of y)delete this.usedCrossTileIDs[l][_]}removeStaleBuckets(l){let d=!1;for(const y in this.indexes){const _=this.indexes[y];for(const E in _)l[_[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,_[E]),delete _[E],d=!0)}return d}}class Cs{constructor(){this.layerIndexes={},this.crossTileIDs=new Dr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,d,y){let _=this.layerIndexes[l.id];_===void 0&&(_=this.layerIndexes[l.id]=new Js);let E=!1;const P={};_.handleWrapJump(y);for(const R of d){const g=R.getBucket(l);g&&l.id===g.layerIds[0]&&(g.bucketInstanceId||(g.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(R.tileID,g,this.crossTileIDs)&&(E=!0),P[g.bucketInstanceId]=!0)}return _.removeStaleBuckets(P)&&(E=!0),E}pruneUnusedLayers(l){const d={};l.forEach(y=>{d[y]=!0});for(const y in this.layerIndexes)d[y]||delete this.layerIndexes[y]}}const In=(C,l)=>o.t(C,l&&l.filter(d=>d.identifier!=="source.canvas")),vo=o.av();class Pi extends o.E{constructor(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),this._rtlPluginLoaded=()=>{for(const y in this.sourceCaches){const _=this.sourceCaches[y].getSource().type;_!=="vector"&&_!=="geojson"||this.sourceCaches[y].reload()}},this.map=l,this.dispatcher=new ct(qe(),l._getMapId()),this.dispatcher.registerMessageHandler("GG",(y,_)=>this.getGlyphs(y,_)),this.dispatcher.registerMessageHandler("GI",(y,_)=>this.getImages(y,_)),this.imageManager=new xe,this.imageManager.setEventedParent(this),this.glyphManager=new nt(l._requestManager,d.localIdeographFontFamily),this.lineAtlas=new xt(256,512),this.crossTileSymbolIndex=new Cs,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.aw,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",o.ax()),pt().on(Tr,this._rtlPluginLoaded),this.on("data",y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;const _=this.sourceCaches[y.sourceId];if(!_)return;const E=_.getSource();if(E&&E.vectorLayerIds)for(const P in this._layers){const R=this._layers[P];R.source===E.id&&this._validateLayer(R)}})}loadURL(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=arguments.length>2?arguments[2]:void 0;this.fire(new o.k("dataloading",{dataType:"style"})),d.validate=typeof d.validate!="boolean"||d.validate;const _=this.map._requestManager.transformRequest(l,"Style");this._loadStyleRequest=new AbortController,o.h(_,this._loadStyleRequest).then(E=>{this._loadStyleRequest=null,this._load(E.data,d,y)}).catch(E=>{this._loadStyleRequest=null,E&&this.fire(new o.j(E))})}loadJSON(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=arguments.length>2?arguments[2]:void 0;this.fire(new o.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,v.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,d.validate=d.validate!==!1,this._load(l,d,y)}).catch(()=>{})}loadEmpty(){this.fire(new o.k("dataloading",{dataType:"style"})),this._load(vo,{validate:!1})}_load(l,d,y){var _;const E=d.transformStyle?d.transformStyle(y,l):l;if(!d.validate||!In(this,o.x(E))){this._loaded=!0,this.stylesheet=E;for(const P in E.sources)this.addSource(P,E.sources[P],{validate:!1});E.sprite?this._loadSprite(E.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(E.glyphs),this._createLayers(),this.light=new ot(this.stylesheet.light),this.map.setTerrain((_=this.stylesheet.terrain)!==null&&_!==void 0?_:null),this.fire(new o.k("data",{dataType:"style"})),this.fire(new o.k("style.load"))}}_createLayers(){const l=o.ay(this.stylesheet.layers);this.dispatcher.broadcast("SL",l),this._order=l.map(d=>d.id),this._layers={},this._serializedLayers=null;for(const d of l){const y=o.az(d);y.setEventedParent(this,{layer:{id:d.id}}),this._layers[d.id]=y}}_loadSprite(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,_;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(E,P,R,g){return o._(this,void 0,void 0,function*(){const w=Fe(E),T=R>1?"@2x":"",L={},D={};for(const{id:H,url:z}of w){const j=P.transformRequest(P.normalizeSpriteURL(z,T,".json"),"SpriteJSON");L[H]=o.h(j,g);const V=P.transformRequest(P.normalizeSpriteURL(z,T,".png"),"SpriteImage");D[H]=Y.getImage(V,g)}return yield Promise.all([...Object.values(L),...Object.values(D)]),function(H,z){return o._(this,void 0,void 0,function*(){const j={};for(const V in H){j[V]={};const X=v.getImageCanvasContext((yield z[V]).data),ue=(yield H[V]).data;for(const ne in ue){const{width:de,height:me,x:Ue,y:Ie,sdf:ve,pixelRatio:we,stretchX:Ve,stretchY:Xe,content:At}=ue[ne];j[V][ne]={data:null,pixelRatio:we,sdf:ve,stretchX:Ve,stretchY:Xe,content:At,spriteData:{width:de,height:me,x:Ue,y:Ie,context:X}}}}return j})}(L,D)})}(l,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(E=>{if(this._spriteRequest=null,E)for(const P in E){this._spritesImagesIds[P]=[];const R=this._spritesImagesIds[P]?this._spritesImagesIds[P].filter(g=>!(g in E)):[];for(const g of R)this.imageManager.removeImage(g),this._changedImages[g]=!0;for(const g in E[P]){const w=P==="default"?g:`${P}:${g}`;this._spritesImagesIds[P].push(w),w in this.imageManager.images?this.imageManager.updateImage(w,E[P][g],!1):this.imageManager.addImage(w,E[P][g]),d&&(this._changedImages[w]=!0)}}}).catch(E=>{this._spriteRequest=null,_=E,this.fire(new o.j(_))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),d&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"})),y&&y(_)})}_unloadSprite(){for(const l of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(l),this._changedImages[l]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}_validateLayer(l){const d=this.sourceCaches[l.source];if(!d)return;const y=l.sourceLayer;if(!y)return;const _=d.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(y)===-1)&&this.fire(new o.j(new Error(`Source layer "${y}" does not exist on source "${_.id}" as specified by style layer "${l.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(l){const d=this._serializedAllLayers();if(!l||l.length===0)return Object.values(d);const y=[];for(const _ of l)d[_]&&y.push(d[_]);return y}_serializedAllLayers(){let l=this._serializedLayers;if(l)return l;l=this._serializedLayers={};const d=Object.keys(this._layers);for(const y of d){const _=this._layers[y];_.type!=="custom"&&(l[y]=_.serialize())}return l}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const l in this.sourceCaches)if(this.sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(l){if(!this._loaded)return;const d=this._changed;if(d){const _=Object.keys(this._updatedLayers),E=Object.keys(this._removedLayers);(_.length||E.length)&&this._updateWorkerLayers(_,E);for(const P in this._updatedSources){const R=this._updatedSources[P];if(R==="reload")this._reloadSource(P);else{if(R!=="clear")throw new Error(`Invalid action ${R}`);this._clearSource(P)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(l);this.light.updateTransitions(l),this._resetUpdates()}const y={};for(const _ in this.sourceCaches){const E=this.sourceCaches[_];y[_]=E.used,E.used=!1}for(const _ of this._order){const E=this._layers[_];E.recalculate(l,this._availableImages),!E.isHidden(l.zoom)&&E.source&&(this.sourceCaches[E.source].used=!0)}for(const _ in y){const E=this.sourceCaches[_];!!y[_]!=!!E.used&&E.fire(new o.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(l),this.z=l.zoom,d&&this.fire(new o.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(l,d){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(l),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var y;this._checkLoaded();const _=this.serialize();if(l=d.transformStyle?d.transformStyle(_,l):l,((y=d.validate)===null||y===void 0||y)&&In(this,o.x(l)))return!1;(l=o.aA(l)).layers=o.ay(l.layers);const E=o.aB(_,l),P=this._getOperationsToPerform(E);if(P.unimplemented.length>0)throw new Error(`Unimplemented: ${P.unimplemented.join(", ")}.`);if(P.operations.length===0)return!1;for(const R of P.operations)R();return this.stylesheet=l,this._serializedLayers=null,!0}_getOperationsToPerform(l){const d=[],y=[];for(const _ of l)switch(_.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":d.push(()=>this.addLayer.apply(this,_.args));break;case"removeLayer":d.push(()=>this.removeLayer.apply(this,_.args));break;case"setPaintProperty":d.push(()=>this.setPaintProperty.apply(this,_.args));break;case"setLayoutProperty":d.push(()=>this.setLayoutProperty.apply(this,_.args));break;case"setFilter":d.push(()=>this.setFilter.apply(this,_.args));break;case"addSource":d.push(()=>this.addSource.apply(this,_.args));break;case"removeSource":d.push(()=>this.removeSource.apply(this,_.args));break;case"setLayerZoomRange":d.push(()=>this.setLayerZoomRange.apply(this,_.args));break;case"setLight":d.push(()=>this.setLight.apply(this,_.args));break;case"setGeoJSONSourceData":d.push(()=>this.setGeoJSONSourceData.apply(this,_.args));break;case"setGlyphs":d.push(()=>this.setGlyphs.apply(this,_.args));break;case"setSprite":d.push(()=>this.setSprite.apply(this,_.args));break;case"setTerrain":d.push(()=>this.map.setTerrain.apply(this,_.args));break;case"setTransition":d.push(()=>{});break;default:y.push(_.command)}return{operations:d,unimplemented:y}}addImage(l,d){if(this.getImage(l))return this.fire(new o.j(new Error(`An image named "${l}" already exists.`)));this.imageManager.addImage(l,d),this._afterImageUpdated(l)}updateImage(l,d){this.imageManager.updateImage(l,d)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new o.j(new Error(`An image named "${l}" does not exist.`)));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(l,d){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error(`Source "${l}" already exists.`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(o.x.source,`sources.${l}`,d,null,y))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const _=this.sourceCaches[l]=new Mr(l,d,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:_.loaded(),source:_.serialize(),sourceId:l})),_.onAdd(this.map),this._changed=!0}removeSource(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===l)return this.fire(new o.j(new Error(`Source "${l}" cannot be removed while layer "${y}" is using it.`)));const d=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],d.fire(new o.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),d.setEventedParent(null),d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,d){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error(`There is no source with this ID=${l}`);const y=this.sourceCaches[l].getSource();if(y.type!=="geojson")throw new Error(`geojsonSource.type is ${y.type}, which is !== 'geojson`);y.setData(d),this._changed=!0}getSource(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()}addLayer(l,d){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this._checkLoaded();const _=l.id;if(this.getLayer(_))return void this.fire(new o.j(new Error(`Layer "${_}" already exists on this map.`)));let E;if(l.type==="custom"){if(In(this,o.aC(l)))return;E=o.az(l)}else{if("source"in l&&typeof l.source=="object"&&(this.addSource(_,l.source),l=o.aA(l),l=o.e(l,{source:_})),this._validate(o.x.layer,`layers.${_}`,l,{arrayIndex:-1},y))return;E=o.az(l),this._validateLayer(E),E.setEventedParent(this,{layer:{id:_}})}const P=d?this._order.indexOf(d):this._order.length;if(d&&P===-1)this.fire(new o.j(new Error(`Cannot add layer "${_}" before non-existing layer "${d}".`)));else{if(this._order.splice(P,0,_),this._layerOrderChanged=!0,this._layers[_]=E,this._removedLayers[_]&&E.source&&E.type!=="custom"){const R=this._removedLayers[_];delete this._removedLayers[_],R.type!==E.type?this._updatedSources[E.source]="clear":(this._updatedSources[E.source]="reload",this.sourceCaches[E.source].pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map)}}moveLayer(l,d){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new o.j(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===d)return;const y=this._order.indexOf(l);this._order.splice(y,1);const _=d?this._order.indexOf(d):this._order.length;d&&_===-1?this.fire(new o.j(new Error(`Cannot move layer "${l}" before non-existing layer "${d}".`))):(this._order.splice(_,0,l),this._layerOrderChanged=!0)}removeLayer(l){this._checkLoaded();const d=this._layers[l];if(!d)return void this.fire(new o.j(new Error(`Cannot remove non-existing layer "${l}".`)));d.setEventedParent(null);const y=this._order.indexOf(l);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=d,delete this._layers[l],this._serializedLayers&&delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],d.onRemove&&d.onRemove(this.map)}getLayer(l){return this._layers[l]}getLayersOrder(){return[...this._order]}hasLayer(l){return l in this._layers}setLayerZoomRange(l,d,y){this._checkLoaded();const _=this.getLayer(l);_?_.minzoom===d&&_.maxzoom===y||(d!=null&&(_.minzoom=d),y!=null&&(_.maxzoom=y),this._updateLayer(_)):this.fire(new o.j(new Error(`Cannot set the zoom range of non-existing layer "${l}".`)))}setFilter(l,d){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this._checkLoaded();const _=this.getLayer(l);if(_){if(!o.aD(_.filter,d))return d==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(o.x.filter,`layers.${_.id}.filter`,d,null,y)||(_.filter=o.aA(d),this._updateLayer(_)))}else this.fire(new o.j(new Error(`Cannot filter non-existing layer "${l}".`)))}getFilter(l){return o.aA(this.getLayer(l).filter)}setLayoutProperty(l,d,y){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this._checkLoaded();const E=this.getLayer(l);E?o.aD(E.getLayoutProperty(d),y)||(E.setLayoutProperty(d,y,_),this._updateLayer(E)):this.fire(new o.j(new Error(`Cannot style non-existing layer "${l}".`)))}getLayoutProperty(l,d){const y=this.getLayer(l);if(y)return y.getLayoutProperty(d);this.fire(new o.j(new Error(`Cannot get style of non-existing layer "${l}".`)))}setPaintProperty(l,d,y){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this._checkLoaded();const E=this.getLayer(l);E?o.aD(E.getPaintProperty(d),y)||(E.setPaintProperty(d,y,_)&&this._updateLayer(E),this._changed=!0,this._updatedPaintProps[l]=!0,this._serializedLayers=null):this.fire(new o.j(new Error(`Cannot style non-existing layer "${l}".`)))}getPaintProperty(l,d){return this.getLayer(l).getPaintProperty(d)}setFeatureState(l,d){this._checkLoaded();const y=l.source,_=l.sourceLayer,E=this.sourceCaches[y];if(E===void 0)return void this.fire(new o.j(new Error(`The source '${y}' does not exist in the map's style.`)));const P=E.getSource().type;P==="geojson"&&_?this.fire(new o.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):P!=="vector"||_?(l.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),E.setFeatureState(_,l.id,d)):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(l,d){this._checkLoaded();const y=l.source,_=this.sourceCaches[y];if(_===void 0)return void this.fire(new o.j(new Error(`The source '${y}' does not exist in the map's style.`)));const E=_.getSource().type,P=E==="vector"?l.sourceLayer:void 0;E!=="vector"||P?d&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new o.j(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(P,l.id,d):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(l){this._checkLoaded();const d=l.source,y=l.sourceLayer,_=this.sourceCaches[d];if(_!==void 0)return _.getSource().type!=="vector"||y?(l.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),_.getFeatureState(y,l.id)):void this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.j(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const l=o.aE(this.sourceCaches,E=>E.serialize()),d=this._serializeByIds(this._order),y=this.map.getTerrain()||void 0,_=this.stylesheet;return o.aF({version:_.version,name:_.name,metadata:_.metadata,light:_.light,center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch,sprite:_.sprite,glyphs:_.glyphs,transition:_.transition,sources:l,layers:d,terrain:y},E=>E!==void 0)}_updateLayer(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(l){const d=P=>this._layers[P].type==="fill-extrusion",y={},_=[];for(let P=this._order.length-1;P>=0;P--){const R=this._order[P];if(d(R)){y[R]=P;for(const g of l){const w=g[R];if(w)for(const T of w)_.push(T)}}}_.sort((P,R)=>R.intersectionZ-P.intersectionZ);const E=[];for(let P=this._order.length-1;P>=0;P--){const R=this._order[P];if(d(R))for(let g=_.length-1;g>=0;g--){const w=_[g].feature;if(y[w.layer.id]<P)break;E.push(w),_.pop()}else for(const g of l){const w=g[R];if(w)for(const T of w)E.push(T.feature)}}return E}queryRenderedFeatures(l,d,y){d&&d.filter&&this._validate(o.x.filter,"queryRenderedFeatures.filter",d.filter,null,d);const _={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new o.j(new Error("parameters.layers must be an Array."))),[];for(const R of d.layers){const g=this._layers[R];if(!g)return this.fire(new o.j(new Error(`The layer '${R}' does not exist in the map's style and cannot be queried for features.`))),[];_[g.source]=!0}}const E=[];d.availableImages=this._availableImages;const P=this._serializedAllLayers();for(const R in this.sourceCaches)d.layers&&!_[R]||E.push(It(this.sourceCaches[R],this._layers,P,l,d,y));return this.placement&&E.push(function(R,g,w,T,L,D,H){const z={},j=D.queryRenderedSymbols(T),V=[];for(const X of Object.keys(j).map(Number))V.push(H[X]);V.sort(Qt);for(const X of V){const ue=X.featureIndex.lookupSymbolFeatures(j[X.bucketInstanceId],g,X.bucketIndex,X.sourceLayerIndex,L.filter,L.layers,L.availableImages,R);for(const ne in ue){const de=z[ne]=z[ne]||[],me=ue[ne];me.sort((Ue,Ie)=>{const ve=X.featureSortOrder;if(ve){const we=ve.indexOf(Ue.featureIndex);return ve.indexOf(Ie.featureIndex)-we}return Ie.featureIndex-Ue.featureIndex});for(const Ue of me)de.push(Ue)}}for(const X in z)z[X].forEach(ue=>{const ne=ue.feature,de=w[R[X].source].getFeatureState(ne.layer["source-layer"],ne.id);ne.source=ne.layer.source,ne.layer["source-layer"]&&(ne.sourceLayer=ne.layer["source-layer"]),ne.state=de});return z}(this._layers,P,this.sourceCaches,l,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(E)}querySourceFeatures(l,d){d&&d.filter&&this._validate(o.x.filter,"querySourceFeatures.filter",d.filter,null,d);const y=this.sourceCaches[l];return y?function(_,E){const P=_.getRenderableIds().map(w=>_.getTileByID(w)),R=[],g={};for(let w=0;w<P.length;w++){const T=P[w],L=T.tileID.canonical.key;g[L]||(g[L]=!0,T.querySourceFeatures(R,E))}return R}(y,d):[]}getLight(){return this.light.getLight()}setLight(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this._checkLoaded();const y=this.light.getLight();let _=!1;for(const P in l)if(!o.aD(l[P],y[P])){_=!0;break}if(!_)return;const E={now:v.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,d),this.light.updateTransitions(E)}_validate(l,d,y,_){let E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};return(!E||E.validate!==!1)&&In(this,l.call(o.x,o.e({key:d,style:this.serialize(),value:y,styleSpec:o.v},_)))}_remove(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),pt().off(Tr,this._rtlPluginLoaded);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this.sourceCaches){const y=this.sourceCaches[d];y.setEventedParent(null),y.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),l&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(l)}_clearSource(l){this.sourceCaches[l].clearTiles()}_reloadSource(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()}_updateSources(l){for(const d in this.sourceCaches)this.sourceCaches[d].update(l,this.map.terrain)}_generateCollisionBoxes(){for(const l in this.sourceCaches)this._reloadSource(l)}_updatePlacement(l,d,y,_){let E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,P=!1,R=!1;const g={};for(const w of this._order){const T=this._layers[w];if(T.type!=="symbol")continue;if(!g[T.source]){const D=this.sourceCaches[T.source];g[T.source]=D.getRenderableIds(!0).map(H=>D.getTileByID(H)).sort((H,z)=>z.tileID.overscaledZ-H.tileID.overscaledZ||(H.tileID.isLessThan(z.tileID)?-1:1))}const L=this.crossTileSymbolIndex.addLayer(T,g[T.source],l.center.lng);P=P||L}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((E=E||this._layerOrderChanged||y===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(v.now(),l.zoom))&&(this.pauseablePlacement=new as(l,this.map.terrain,this._order,E,d,y,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,g),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(v.now()),R=!0),P&&this.pauseablePlacement.placement.setStale()),R||P)for(const w of this._order){const T=this._layers[w];T.type==="symbol"&&this.placement.updateLayerOpacities(T,g[T.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(v.now())}_releaseSymbolFadeTiles(){for(const l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,d){return o._(this,void 0,void 0,function*(){const y=yield this.imageManager.getImages(d.icons);this._updateTilesForChangedImages();const _=this.sourceCaches[d.source];return _&&_.setDependencies(d.tileID.key,d.type,d.icons),y})}getGlyphs(l,d){return o._(this,void 0,void 0,function*(){const y=yield this.glyphManager.getGlyphs(d.stacks),_=this.sourceCaches[d.source];return _&&_.setDependencies(d.tileID.key,d.type,[""]),y})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this._checkLoaded(),l&&this._validate(o.x.glyphs,"glyphs",l,null,d)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=l,this.glyphManager.entries={},this.glyphManager.setURL(l))}addSprite(l,d){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},_=arguments.length>3?arguments[3]:void 0;this._checkLoaded();const E=[{id:l,url:d}],P=[...Fe(this.stylesheet.sprite),...E];this._validate(o.x.sprite,"sprite",P,null,y)||(this.stylesheet.sprite=P,this._loadSprite(E,!0,_))}removeSprite(l){this._checkLoaded();const d=Fe(this.stylesheet.sprite);if(d.find(y=>y.id===l)){if(this._spritesImagesIds[l])for(const y of this._spritesImagesIds[l])this.imageManager.removeImage(y),this._changedImages[y]=!0;d.splice(d.findIndex(y=>y.id===l),1),this.stylesheet.sprite=d.length>0?d:void 0,delete this._spritesImagesIds[l],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}else this.fire(new o.j(new Error(`Sprite "${l}" doesn't exists on this map.`)))}getSprite(){return Fe(this.stylesheet.sprite)}setSprite(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=arguments.length>2?arguments[2]:void 0;this._checkLoaded(),l&&this._validate(o.x.sprite,"sprite",l,null,d)||(this.stylesheet.sprite=l,l?this._loadSprite(l,!0,y):(this._unloadSprite(),y&&y(null)))}}var Ui=o.X([{name:"a_pos",type:"Int16",components:2}]),Yn="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Li={prelude:cn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:cn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:cn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:cn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:cn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:cn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:cn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:cn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:cn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:cn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:cn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:cn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:cn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:cn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:cn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:cn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:cn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:cn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:cn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:cn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:cn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:cn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:cn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:cn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:cn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:cn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:cn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Yn),terrainDepth:cn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Yn),terrainCoords:cn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Yn)};function cn(C,l){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,y=l.match(/attribute ([\w]+) ([\w]+)/g),_=C.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=E?E.concat(_):_,R={};return{fragmentSource:C=C.replace(d,(g,w,T,L,D)=>(R[D]=!0,w==="define"?`
#ifndef HAS_UNIFORM_u_${D}
varying ${T} ${L} ${D};
#else
uniform ${T} ${L} u_${D};
#endif
`:`
#ifdef HAS_UNIFORM_u_${D}
    ${T} ${L} ${D} = u_${D};
#endif
`)),vertexSource:l=l.replace(d,(g,w,T,L,D)=>{const H=L==="float"?"vec2":"vec4",z=D.match(/color/)?"color":H;return R[D]?w==="define"?`
#ifndef HAS_UNIFORM_u_${D}
uniform lowp float u_${D}_t;
attribute ${T} ${H} a_${D};
varying ${T} ${L} ${D};
#else
uniform ${T} ${L} u_${D};
#endif
`:z==="vec4"?`
#ifndef HAS_UNIFORM_u_${D}
    ${D} = a_${D};
#else
    ${T} ${L} ${D} = u_${D};
#endif
`:`
#ifndef HAS_UNIFORM_u_${D}
    ${D} = unpack_mix_${z}(a_${D}, u_${D}_t);
#else
    ${T} ${L} ${D} = u_${D};
#endif
`:w==="define"?`
#ifndef HAS_UNIFORM_u_${D}
uniform lowp float u_${D}_t;
attribute ${T} ${H} a_${D};
#else
uniform ${T} ${L} u_${D};
#endif
`:z==="vec4"?`
#ifndef HAS_UNIFORM_u_${D}
    ${T} ${L} ${D} = a_${D};
#else
    ${T} ${L} ${D} = u_${D};
#endif
`:`
#ifndef HAS_UNIFORM_u_${D}
    ${T} ${L} ${D} = unpack_mix_${z}(a_${D}, u_${D}_t);
#else
    ${T} ${L} ${D} = u_${D};
#endif
`}),staticAttributes:y,staticUniforms:P}}class Go{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,d,y,_,E,P,R,g,w){this.context=l;let T=this.boundPaintVertexBuffers.length!==_.length;for(let L=0;!T&&L<_.length;L++)this.boundPaintVertexBuffers[L]!==_[L]&&(T=!0);!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==y||T||this.boundIndexBuffer!==E||this.boundVertexOffset!==P||this.boundDynamicVertexBuffer!==R||this.boundDynamicVertexBuffer2!==g||this.boundDynamicVertexBuffer3!==w?this.freshBind(d,y,_,E,P,R,g,w):(l.bindVertexArray.set(this.vao),R&&R.bind(),E&&E.dynamicDraw&&E.bind(),g&&g.bind(),w&&w.bind())}freshBind(l,d,y,_,E,P,R,g){const w=l.numAttributes,T=this.context,L=T.gl;this.vao&&this.destroy(),this.vao=T.createVertexArray(),T.bindVertexArray.set(this.vao),this.boundProgram=l,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=_,this.boundVertexOffset=E,this.boundDynamicVertexBuffer=P,this.boundDynamicVertexBuffer2=R,this.boundDynamicVertexBuffer3=g,d.enableAttributes(L,l);for(const D of y)D.enableAttributes(L,l);P&&P.enableAttributes(L,l),R&&R.enableAttributes(L,l),g&&g.enableAttributes(L,l),d.bind(),d.setVertexAttribPointers(L,l,E);for(const D of y)D.bind(),D.setVertexAttribPointers(L,l,E);P&&(P.bind(),P.setVertexAttribPointers(L,l,E)),_&&_.bind(),R&&(R.bind(),R.setVertexAttribPointers(L,l,E)),g&&(g.bind(),g.setVertexAttribPointers(L,l,E)),T.currentNumAttributes=w}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Vo(C){const l=[];for(let d=0;d<C.length;d++){if(C[d]===null)continue;const y=C[d].split(" ");l.push(y.pop())}return l}class Ys{constructor(l,d,y,_,E,P){const R=l.gl;this.program=R.createProgram();const g=Vo(d.staticAttributes),w=y?y.getBinderAttributes():[],T=g.concat(w),L=Li.prelude.staticUniforms?Vo(Li.prelude.staticUniforms):[],D=d.staticUniforms?Vo(d.staticUniforms):[],H=y?y.getBinderUniforms():[],z=L.concat(D).concat(H),j=[];for(const Ue of z)j.indexOf(Ue)<0&&j.push(Ue);const V=y?y.defines():[];E&&V.push("#define OVERDRAW_INSPECTOR;"),P&&V.push("#define TERRAIN3D;");const X=V.concat(Li.prelude.fragmentSource,d.fragmentSource).join(`
`),ue=V.concat(Li.prelude.vertexSource,d.vertexSource).join(`
`),ne=R.createShader(R.FRAGMENT_SHADER);if(R.isContextLost())return void(this.failedToCreate=!0);if(R.shaderSource(ne,X),R.compileShader(ne),!R.getShaderParameter(ne,R.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${R.getShaderInfoLog(ne)}`);R.attachShader(this.program,ne);const de=R.createShader(R.VERTEX_SHADER);if(R.isContextLost())return void(this.failedToCreate=!0);if(R.shaderSource(de,ue),R.compileShader(de),!R.getShaderParameter(de,R.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${R.getShaderInfoLog(de)}`);R.attachShader(this.program,de),this.attributes={};const me={};this.numAttributes=T.length;for(let Ue=0;Ue<this.numAttributes;Ue++)T[Ue]&&(R.bindAttribLocation(this.program,Ue,T[Ue]),this.attributes[T[Ue]]=Ue);if(R.linkProgram(this.program),!R.getProgramParameter(this.program,R.LINK_STATUS))throw new Error(`Program failed to link: ${R.getProgramInfoLog(this.program)}`);R.deleteShader(de),R.deleteShader(ne);for(let Ue=0;Ue<j.length;Ue++){const Ie=j[Ue];if(Ie&&!me[Ie]){const ve=R.getUniformLocation(this.program,Ie);ve&&(me[Ie]=ve)}}this.fixedUniforms=_(l,me),this.terrainUniforms=((Ue,Ie)=>({u_depth:new o.aG(Ue,Ie.u_depth),u_terrain:new o.aG(Ue,Ie.u_terrain),u_terrain_dim:new o.aH(Ue,Ie.u_terrain_dim),u_terrain_matrix:new o.aI(Ue,Ie.u_terrain_matrix),u_terrain_unpack:new o.aJ(Ue,Ie.u_terrain_unpack),u_terrain_exaggeration:new o.aH(Ue,Ie.u_terrain_exaggeration)}))(l,me),this.binderUniforms=y?y.getUniforms(l,me):[]}draw(l,d,y,_,E,P,R,g,w,T,L,D,H,z,j,V,X,ue){const ne=l.gl;if(this.failedToCreate)return;if(l.program.set(this.program),l.setDepthMode(y),l.setStencilMode(_),l.setColorMode(E),l.setCullFace(P),g){l.activeTexture.set(ne.TEXTURE2),ne.bindTexture(ne.TEXTURE_2D,g.depthTexture),l.activeTexture.set(ne.TEXTURE3),ne.bindTexture(ne.TEXTURE_2D,g.texture);for(const me in this.terrainUniforms)this.terrainUniforms[me].set(g[me])}for(const me in this.fixedUniforms)this.fixedUniforms[me].set(R[me]);j&&j.setUniforms(l,this.binderUniforms,H,{zoom:z});let de=0;switch(d){case ne.LINES:de=2;break;case ne.TRIANGLES:de=3;break;case ne.LINE_STRIP:de=1}for(const me of D.get()){const Ue=me.vaos||(me.vaos={});(Ue[w]||(Ue[w]=new Go)).bind(l,this,T,j?j.getPaintVertexBuffers():[],L,me.vertexOffset,V,X,ue),ne.drawElements(d,me.primitiveLength*de,ne.UNSIGNED_SHORT,me.primitiveOffset*de*2)}}}function fc(C,l,d){const y=1/lr(d,1,l.transform.tileZoom),_=Math.pow(2,d.tileID.overscaledZ),E=d.tileSize*Math.pow(2,l.transform.tileZoom)/_,P=E*(d.tileID.canonical.x+d.tileID.wrap*_),R=E*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[y,C.fromScale,C.toScale],u_fade:C.t,u_pixel_coord_upper:[P>>16,R>>16],u_pixel_coord_lower:[65535&P,65535&R]}}const he=(C,l,d,y)=>{const _=l.style.light,E=_.properties.get("position"),P=[E.x,E.y,E.z],R=function(){var w=new o.A(9);return o.A!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[5]=0,w[6]=0,w[7]=0),w[0]=1,w[4]=1,w[8]=1,w}();_.properties.get("anchor")==="viewport"&&function(w,T){var L=Math.sin(T),D=Math.cos(T);w[0]=D,w[1]=L,w[2]=0,w[3]=-L,w[4]=D,w[5]=0,w[6]=0,w[7]=0,w[8]=1}(R,-l.transform.angle),function(w,T,L){var D=T[0],H=T[1],z=T[2];w[0]=D*L[0]+H*L[3]+z*L[6],w[1]=D*L[1]+H*L[4]+z*L[7],w[2]=D*L[2]+H*L[5]+z*L[8]}(P,P,R);const g=_.properties.get("color");return{u_matrix:C,u_lightpos:P,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[g.r,g.g,g.b],u_vertical_gradient:+d,u_opacity:y}},Be=(C,l,d,y,_,E,P)=>o.e(he(C,l,d,y),fc(E,l,P),{u_height_factor:-Math.pow(2,_.overscaledZ)/P.tileSize/8}),He=C=>({u_matrix:C}),dt=(C,l,d,y)=>o.e(He(C),fc(d,l,y)),Mt=(C,l)=>({u_matrix:C,u_world:l}),sr=(C,l,d,y,_)=>o.e(dt(C,l,d,y),{u_world:_}),zr=(C,l,d,y)=>{const _=C.transform;let E,P;if(y.paint.get("circle-pitch-alignment")==="map"){const R=lr(d,1,_.zoom);E=!0,P=[R,R]}else E=!1,P=_.pixelsToGLUnits;return{u_camera_to_center_distance:_.cameraToCenterDistance,u_scale_with_map:+(y.paint.get("circle-pitch-scale")==="map"),u_matrix:C.translatePosMatrix(l.posMatrix,d,y.paint.get("circle-translate"),y.paint.get("circle-translate-anchor")),u_pitch_with_map:+E,u_device_pixel_ratio:C.pixelRatio,u_extrude_scale:P}},Wn=(C,l,d)=>{const y=lr(d,1,l.zoom),_=Math.pow(2,l.zoom-d.tileID.overscaledZ),E=d.tileID.overscaleFactor();return{u_matrix:C,u_camera_to_center_distance:l.cameraToCenterDistance,u_pixels_to_tile_units:y,u_extrude_scale:[l.pixelsToGLUnits[0]/(y*_),l.pixelsToGLUnits[1]/(y*_)],u_overscale_factor:E}},Zn=function(C,l){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return{u_matrix:C,u_color:l,u_overlay:0,u_overlay_scale:d}},ui=C=>({u_matrix:C}),Nn=(C,l,d,y)=>({u_matrix:C,u_extrude_scale:lr(l,1,d),u_intensity:y});function eh(C,l){const d=Math.pow(2,l.canonical.z),y=l.canonical.y;return[new o.Y(0,y/d).toLngLat().lat,new o.Y(0,(y+1)/d).toLngLat().lat]}const al=(C,l,d,y)=>{const _=C.transform;return{u_matrix:pc(C,l,d,y),u_ratio:1/lr(l,1,_.zoom),u_device_pixel_ratio:C.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},Vr=(C,l,d,y,_)=>o.e(al(C,l,d,_),{u_image:0,u_image_height:y}),Qa=(C,l,d,y,_)=>{const E=C.transform,P=_i(l,E);return{u_matrix:pc(C,l,d,_),u_texsize:l.imageAtlasTexture.size,u_ratio:1/lr(l,1,E.zoom),u_device_pixel_ratio:C.pixelRatio,u_image:0,u_scale:[P,y.fromScale,y.toScale],u_fade:y.t,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]]}},tu=(C,l,d,y,_,E)=>{const P=C.lineAtlas,R=_i(l,C.transform),g=d.layout.get("line-cap")==="round",w=P.getDash(y.from,g),T=P.getDash(y.to,g),L=w.width*_.fromScale,D=T.width*_.toScale;return o.e(al(C,l,d,E),{u_patternscale_a:[R/L,-w.height/2],u_patternscale_b:[R/D,-T.height/2],u_sdfgamma:P.width/(256*Math.min(L,D)*C.pixelRatio)/2,u_image:0,u_tex_y_a:w.y,u_tex_y_b:T.y,u_mix:_.t})};function _i(C,l){return 1/lr(C,1,l.tileZoom)}function pc(C,l,d,y){return C.translatePosMatrix(y?y.posMatrix:l.tileID.posMatrix,l,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const cl=(C,l,d,y,_)=>{return{u_matrix:C,u_tl_parent:l,u_scale_parent:d,u_buffer_scale:1,u_fade_t:y.mix,u_opacity:y.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(P=_.paint.get("raster-saturation"),P>0?1-1/(1.001-P):-P),u_contrast_factor:(E=_.paint.get("raster-contrast"),E>0?1/(1-E):1+E),u_spin_weights:pa(_.paint.get("raster-hue-rotate"))};var E,P};function pa(C){C*=Math.PI/180;const l=Math.sin(C),d=Math.cos(C);return[(2*d+1)/3,(-Math.sqrt(3)*l-d+1)/3,(Math.sqrt(3)*l-d+1)/3]}const Ha=(C,l,d,y,_,E,P,R,g,w)=>{const T=_.transform;return{u_is_size_zoom_constant:+(C==="constant"||C==="source"),u_is_size_feature_constant:+(C==="constant"||C==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:T.cameraToCenterDistance,u_pitch:T.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:T.width/T.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:P,u_coord_matrix:R,u_is_text:+g,u_pitch_with_map:+y,u_texsize:w,u_texture:0}},ll=(C,l,d,y,_,E,P,R,g,w,T)=>{const L=_.transform;return o.e(Ha(C,l,d,y,_,E,P,R,g,w),{u_gamma_scale:y?Math.cos(L._pitch)*L.cameraToCenterDistance:1,u_device_pixel_ratio:_.pixelRatio,u_is_halo:+T})},ul=(C,l,d,y,_,E,P,R,g,w)=>o.e(ll(C,l,d,y,_,E,P,R,!0,g,!0),{u_texsize_icon:w,u_texture_icon:1}),Ad=(C,l,d)=>({u_matrix:C,u_opacity:l,u_color:d}),$u=(C,l,d,y,_,E)=>o.e(function(P,R,g,w){const T=g.imageManager.getPattern(P.from.toString()),L=g.imageManager.getPattern(P.to.toString()),{width:D,height:H}=g.imageManager.getPixelSize(),z=Math.pow(2,w.tileID.overscaledZ),j=w.tileSize*Math.pow(2,g.transform.tileZoom)/z,V=j*(w.tileID.canonical.x+w.tileID.wrap*z),X=j*w.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:T.tl,u_pattern_br_a:T.br,u_pattern_tl_b:L.tl,u_pattern_br_b:L.br,u_texsize:[D,H],u_mix:R.t,u_pattern_size_a:T.displaySize,u_pattern_size_b:L.displaySize,u_scale_a:R.fromScale,u_scale_b:R.toScale,u_tile_units_to_pixels:1/lr(w,1,g.transform.tileZoom),u_pixel_coord_upper:[V>>16,X>>16],u_pixel_coord_lower:[65535&V,65535&X]}}(y,E,d,_),{u_matrix:C,u_opacity:l}),gc={fillExtrusion:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_lightpos:new o.aK(C,l.u_lightpos),u_lightintensity:new o.aH(C,l.u_lightintensity),u_lightcolor:new o.aK(C,l.u_lightcolor),u_vertical_gradient:new o.aH(C,l.u_vertical_gradient),u_opacity:new o.aH(C,l.u_opacity)}),fillExtrusionPattern:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_lightpos:new o.aK(C,l.u_lightpos),u_lightintensity:new o.aH(C,l.u_lightintensity),u_lightcolor:new o.aK(C,l.u_lightcolor),u_vertical_gradient:new o.aH(C,l.u_vertical_gradient),u_height_factor:new o.aH(C,l.u_height_factor),u_image:new o.aG(C,l.u_image),u_texsize:new o.aL(C,l.u_texsize),u_pixel_coord_upper:new o.aL(C,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(C,l.u_pixel_coord_lower),u_scale:new o.aK(C,l.u_scale),u_fade:new o.aH(C,l.u_fade),u_opacity:new o.aH(C,l.u_opacity)}),fill:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix)}),fillPattern:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_image:new o.aG(C,l.u_image),u_texsize:new o.aL(C,l.u_texsize),u_pixel_coord_upper:new o.aL(C,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(C,l.u_pixel_coord_lower),u_scale:new o.aK(C,l.u_scale),u_fade:new o.aH(C,l.u_fade)}),fillOutline:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_world:new o.aL(C,l.u_world)}),fillOutlinePattern:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_world:new o.aL(C,l.u_world),u_image:new o.aG(C,l.u_image),u_texsize:new o.aL(C,l.u_texsize),u_pixel_coord_upper:new o.aL(C,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(C,l.u_pixel_coord_lower),u_scale:new o.aK(C,l.u_scale),u_fade:new o.aH(C,l.u_fade)}),circle:(C,l)=>({u_camera_to_center_distance:new o.aH(C,l.u_camera_to_center_distance),u_scale_with_map:new o.aG(C,l.u_scale_with_map),u_pitch_with_map:new o.aG(C,l.u_pitch_with_map),u_extrude_scale:new o.aL(C,l.u_extrude_scale),u_device_pixel_ratio:new o.aH(C,l.u_device_pixel_ratio),u_matrix:new o.aI(C,l.u_matrix)}),collisionBox:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_camera_to_center_distance:new o.aH(C,l.u_camera_to_center_distance),u_pixels_to_tile_units:new o.aH(C,l.u_pixels_to_tile_units),u_extrude_scale:new o.aL(C,l.u_extrude_scale),u_overscale_factor:new o.aH(C,l.u_overscale_factor)}),collisionCircle:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_inv_matrix:new o.aI(C,l.u_inv_matrix),u_camera_to_center_distance:new o.aH(C,l.u_camera_to_center_distance),u_viewport_size:new o.aL(C,l.u_viewport_size)}),debug:(C,l)=>({u_color:new o.aM(C,l.u_color),u_matrix:new o.aI(C,l.u_matrix),u_overlay:new o.aG(C,l.u_overlay),u_overlay_scale:new o.aH(C,l.u_overlay_scale)}),clippingMask:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix)}),heatmap:(C,l)=>({u_extrude_scale:new o.aH(C,l.u_extrude_scale),u_intensity:new o.aH(C,l.u_intensity),u_matrix:new o.aI(C,l.u_matrix)}),heatmapTexture:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_world:new o.aL(C,l.u_world),u_image:new o.aG(C,l.u_image),u_color_ramp:new o.aG(C,l.u_color_ramp),u_opacity:new o.aH(C,l.u_opacity)}),hillshade:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_image:new o.aG(C,l.u_image),u_latrange:new o.aL(C,l.u_latrange),u_light:new o.aL(C,l.u_light),u_shadow:new o.aM(C,l.u_shadow),u_highlight:new o.aM(C,l.u_highlight),u_accent:new o.aM(C,l.u_accent)}),hillshadePrepare:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_image:new o.aG(C,l.u_image),u_dimension:new o.aL(C,l.u_dimension),u_zoom:new o.aH(C,l.u_zoom),u_unpack:new o.aJ(C,l.u_unpack)}),line:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_ratio:new o.aH(C,l.u_ratio),u_device_pixel_ratio:new o.aH(C,l.u_device_pixel_ratio),u_units_to_pixels:new o.aL(C,l.u_units_to_pixels)}),lineGradient:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_ratio:new o.aH(C,l.u_ratio),u_device_pixel_ratio:new o.aH(C,l.u_device_pixel_ratio),u_units_to_pixels:new o.aL(C,l.u_units_to_pixels),u_image:new o.aG(C,l.u_image),u_image_height:new o.aH(C,l.u_image_height)}),linePattern:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_texsize:new o.aL(C,l.u_texsize),u_ratio:new o.aH(C,l.u_ratio),u_device_pixel_ratio:new o.aH(C,l.u_device_pixel_ratio),u_image:new o.aG(C,l.u_image),u_units_to_pixels:new o.aL(C,l.u_units_to_pixels),u_scale:new o.aK(C,l.u_scale),u_fade:new o.aH(C,l.u_fade)}),lineSDF:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_ratio:new o.aH(C,l.u_ratio),u_device_pixel_ratio:new o.aH(C,l.u_device_pixel_ratio),u_units_to_pixels:new o.aL(C,l.u_units_to_pixels),u_patternscale_a:new o.aL(C,l.u_patternscale_a),u_patternscale_b:new o.aL(C,l.u_patternscale_b),u_sdfgamma:new o.aH(C,l.u_sdfgamma),u_image:new o.aG(C,l.u_image),u_tex_y_a:new o.aH(C,l.u_tex_y_a),u_tex_y_b:new o.aH(C,l.u_tex_y_b),u_mix:new o.aH(C,l.u_mix)}),raster:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_tl_parent:new o.aL(C,l.u_tl_parent),u_scale_parent:new o.aH(C,l.u_scale_parent),u_buffer_scale:new o.aH(C,l.u_buffer_scale),u_fade_t:new o.aH(C,l.u_fade_t),u_opacity:new o.aH(C,l.u_opacity),u_image0:new o.aG(C,l.u_image0),u_image1:new o.aG(C,l.u_image1),u_brightness_low:new o.aH(C,l.u_brightness_low),u_brightness_high:new o.aH(C,l.u_brightness_high),u_saturation_factor:new o.aH(C,l.u_saturation_factor),u_contrast_factor:new o.aH(C,l.u_contrast_factor),u_spin_weights:new o.aK(C,l.u_spin_weights)}),symbolIcon:(C,l)=>({u_is_size_zoom_constant:new o.aG(C,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aG(C,l.u_is_size_feature_constant),u_size_t:new o.aH(C,l.u_size_t),u_size:new o.aH(C,l.u_size),u_camera_to_center_distance:new o.aH(C,l.u_camera_to_center_distance),u_pitch:new o.aH(C,l.u_pitch),u_rotate_symbol:new o.aG(C,l.u_rotate_symbol),u_aspect_ratio:new o.aH(C,l.u_aspect_ratio),u_fade_change:new o.aH(C,l.u_fade_change),u_matrix:new o.aI(C,l.u_matrix),u_label_plane_matrix:new o.aI(C,l.u_label_plane_matrix),u_coord_matrix:new o.aI(C,l.u_coord_matrix),u_is_text:new o.aG(C,l.u_is_text),u_pitch_with_map:new o.aG(C,l.u_pitch_with_map),u_texsize:new o.aL(C,l.u_texsize),u_texture:new o.aG(C,l.u_texture)}),symbolSDF:(C,l)=>({u_is_size_zoom_constant:new o.aG(C,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aG(C,l.u_is_size_feature_constant),u_size_t:new o.aH(C,l.u_size_t),u_size:new o.aH(C,l.u_size),u_camera_to_center_distance:new o.aH(C,l.u_camera_to_center_distance),u_pitch:new o.aH(C,l.u_pitch),u_rotate_symbol:new o.aG(C,l.u_rotate_symbol),u_aspect_ratio:new o.aH(C,l.u_aspect_ratio),u_fade_change:new o.aH(C,l.u_fade_change),u_matrix:new o.aI(C,l.u_matrix),u_label_plane_matrix:new o.aI(C,l.u_label_plane_matrix),u_coord_matrix:new o.aI(C,l.u_coord_matrix),u_is_text:new o.aG(C,l.u_is_text),u_pitch_with_map:new o.aG(C,l.u_pitch_with_map),u_texsize:new o.aL(C,l.u_texsize),u_texture:new o.aG(C,l.u_texture),u_gamma_scale:new o.aH(C,l.u_gamma_scale),u_device_pixel_ratio:new o.aH(C,l.u_device_pixel_ratio),u_is_halo:new o.aG(C,l.u_is_halo)}),symbolTextAndIcon:(C,l)=>({u_is_size_zoom_constant:new o.aG(C,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aG(C,l.u_is_size_feature_constant),u_size_t:new o.aH(C,l.u_size_t),u_size:new o.aH(C,l.u_size),u_camera_to_center_distance:new o.aH(C,l.u_camera_to_center_distance),u_pitch:new o.aH(C,l.u_pitch),u_rotate_symbol:new o.aG(C,l.u_rotate_symbol),u_aspect_ratio:new o.aH(C,l.u_aspect_ratio),u_fade_change:new o.aH(C,l.u_fade_change),u_matrix:new o.aI(C,l.u_matrix),u_label_plane_matrix:new o.aI(C,l.u_label_plane_matrix),u_coord_matrix:new o.aI(C,l.u_coord_matrix),u_is_text:new o.aG(C,l.u_is_text),u_pitch_with_map:new o.aG(C,l.u_pitch_with_map),u_texsize:new o.aL(C,l.u_texsize),u_texsize_icon:new o.aL(C,l.u_texsize_icon),u_texture:new o.aG(C,l.u_texture),u_texture_icon:new o.aG(C,l.u_texture_icon),u_gamma_scale:new o.aH(C,l.u_gamma_scale),u_device_pixel_ratio:new o.aH(C,l.u_device_pixel_ratio),u_is_halo:new o.aG(C,l.u_is_halo)}),background:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_opacity:new o.aH(C,l.u_opacity),u_color:new o.aM(C,l.u_color)}),backgroundPattern:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_opacity:new o.aH(C,l.u_opacity),u_image:new o.aG(C,l.u_image),u_pattern_tl_a:new o.aL(C,l.u_pattern_tl_a),u_pattern_br_a:new o.aL(C,l.u_pattern_br_a),u_pattern_tl_b:new o.aL(C,l.u_pattern_tl_b),u_pattern_br_b:new o.aL(C,l.u_pattern_br_b),u_texsize:new o.aL(C,l.u_texsize),u_mix:new o.aH(C,l.u_mix),u_pattern_size_a:new o.aL(C,l.u_pattern_size_a),u_pattern_size_b:new o.aL(C,l.u_pattern_size_b),u_scale_a:new o.aH(C,l.u_scale_a),u_scale_b:new o.aH(C,l.u_scale_b),u_pixel_coord_upper:new o.aL(C,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(C,l.u_pixel_coord_lower),u_tile_units_to_pixels:new o.aH(C,l.u_tile_units_to_pixels)}),terrain:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_texture:new o.aG(C,l.u_texture),u_ele_delta:new o.aH(C,l.u_ele_delta)}),terrainDepth:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_ele_delta:new o.aH(C,l.u_ele_delta)}),terrainCoords:(C,l)=>({u_matrix:new o.aI(C,l.u_matrix),u_texture:new o.aG(C,l.u_texture),u_terrain_coords_id:new o.aH(C,l.u_terrain_coords_id),u_ele_delta:new o.aH(C,l.u_ele_delta)})};class mc{constructor(l,d,y){this.context=l;const _=l.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const d=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const za={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ga{constructor(l,d,y,_){this.length=d.length,this.attributes=y,this.itemSize=d.bytesPerElement,this.dynamicDraw=_,this.context=l;const E=l.gl;this.buffer=E.createBuffer(),l.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){if(l.length!==this.length)throw new Error(`Length of new data is ${l.length}, which doesn't match current length of ${this.length}`);const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,d){for(let y=0;y<this.attributes.length;y++){const _=d.attributes[this.attributes[y].name];_!==void 0&&l.enableVertexAttribArray(_)}}setVertexAttribPointers(l,d,y){for(let _=0;_<this.attributes.length;_++){const E=this.attributes[_],P=d.attributes[E.name];P!==void 0&&l.vertexAttribPointer(P,E.components,l[za[E.type]],!1,this.itemSize,E.offset+this.itemSize*(y||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ri=new WeakMap;function Bi(C){var l;if(Ri.has(C))return Ri.get(C);{const d=(l=C.getParameter(C.VERSION))===null||l===void 0?void 0:l.startsWith("WebGL 2.0");return Ri.set(C,d),d}}class ln{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Al extends ln{getDefault(){return o.aO.transparent}set(l){const d=this.current;(l.r!==d.r||l.g!==d.g||l.b!==d.b||l.a!==d.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class hl extends ln{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class ru extends ln{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class jo extends ln{getDefault(){return[!0,!0,!0,!0]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class qo extends ln{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class Xu extends ln{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class ma extends ln{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const d=this.current;(l.func!==d.func||l.ref!==d.ref||l.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class Ds extends ln{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class nu extends ln{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=l,this.dirty=!1}}class yc extends ln{getDefault(){return[0,1]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class _c extends ln{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=l,this.dirty=!1}}class iu extends ln{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class hd extends ln{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.BLEND):d.disable(d.BLEND),this.current=l,this.dirty=!1}}class Ju extends ln{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class Yu extends ln{getDefault(){return o.aO.transparent}set(l){const d=this.current;(l.r!==d.r||l.g!==d.g||l.b!==d.b||l.a!==d.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class th extends ln{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class su extends ln{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=l,this.dirty=!1}}class dl extends ln{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class vc extends ln{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class ou extends ln{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class Zu extends ln{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class Ko extends ln{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class bc extends ln{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class au extends ln{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class ya extends ln{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class Wo extends ln{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class k extends ln{getDefault(){return null}set(l){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class re extends ln{getDefault(){return null}set(l){var d;if(l===this.current&&!this.dirty)return;const y=this.gl;Bi(y)?y.bindVertexArray(l):(d=y.getExtension("OES_vertex_array_object"))===null||d===void 0||d.bindVertexArrayOES(l),this.current=l,this.dirty=!1}}class Pe extends ln{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class je extends ln{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class at extends ln{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class lt extends ln{constructor(l,d){super(l),this.context=l,this.parent=d}getDefault(){return null}}class Pt extends lt{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class cr extends lt{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Pr extends lt{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Gr{constructor(l,d,y,_,E){this.context=l,this.width=d,this.height=y;const P=l.gl,R=this.framebuffer=P.createFramebuffer();if(this.colorAttachment=new Pt(l,R),_)this.depthAttachment=E?new Pr(l,R):new cr(l,R);else if(E)throw new Error("Stencil cannot be set without depth");if(P.checkFramebufferStatus(P.FRAMEBUFFER)!==P.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const l=this.context.gl,d=this.colorAttachment.get();if(d&&l.deleteTexture(d),this.depthAttachment){const y=this.depthAttachment.get();y&&l.deleteRenderbuffer(y)}l.deleteFramebuffer(this.framebuffer)}}class vr{constructor(l,d,y){this.blendFunction=l,this.blendColor=d,this.mask=y}}vr.Replace=[1,0],vr.disabled=new vr(vr.Replace,o.aO.transparent,[!1,!1,!1,!1]),vr.unblended=new vr(vr.Replace,o.aO.transparent,[!0,!0,!0,!0]),vr.alphaBlended=new vr([1,771],o.aO.transparent,[!0,!0,!0,!0]);class wn{constructor(l){var d,y;if(this.gl=l,this.clearColor=new Al(this),this.clearDepth=new hl(this),this.clearStencil=new ru(this),this.colorMask=new jo(this),this.depthMask=new qo(this),this.stencilMask=new Xu(this),this.stencilFunc=new ma(this),this.stencilOp=new Ds(this),this.stencilTest=new nu(this),this.depthRange=new yc(this),this.depthTest=new _c(this),this.depthFunc=new iu(this),this.blend=new hd(this),this.blendFunc=new Ju(this),this.blendColor=new Yu(this),this.blendEquation=new th(this),this.cullFace=new su(this),this.cullFaceSide=new dl(this),this.frontFace=new vc(this),this.program=new ou(this),this.activeTexture=new Zu(this),this.viewport=new Ko(this),this.bindFramebuffer=new bc(this),this.bindRenderbuffer=new au(this),this.bindTexture=new ya(this),this.bindVertexBuffer=new Wo(this),this.bindElementBuffer=new k(this),this.bindVertexArray=new re(this),this.pixelStoreUnpack=new Pe(this),this.pixelStoreUnpackPremultiplyAlpha=new je(this),this.pixelStoreUnpackFlipY=new at(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),Bi(l)){this.HALF_FLOAT=l.HALF_FLOAT;const _=l.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(d=l.RGBA16F)!==null&&d!==void 0?d:_==null?void 0:_.RGBA16F_EXT,this.RGB16F=(y=l.RGB16F)!==null&&y!==void 0?y:_==null?void 0:_.RGB16F_EXT,l.getExtension("EXT_color_buffer_float")}else{l.getExtension("EXT_color_buffer_half_float"),l.getExtension("OES_texture_half_float_linear");const _=l.getExtension("OES_texture_half_float");this.HALF_FLOAT=_==null?void 0:_.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,d){return new mc(this,l,d)}createVertexBuffer(l,d,y){return new ga(this,l,d,y)}createRenderbuffer(l,d,y){const _=this.gl,E=_.createRenderbuffer();return this.bindRenderbuffer.set(E),_.renderbufferStorage(_.RENDERBUFFER,l,d,y),this.bindRenderbuffer.set(null),E}createFramebuffer(l,d,y,_){return new Gr(this,l,d,y,_)}clear(l){let{color:d,depth:y,stencil:_}=l;const E=this.gl;let P=0;d&&(P|=E.COLOR_BUFFER_BIT,this.clearColor.set(d),this.colorMask.set([!0,!0,!0,!0])),y!==void 0&&(P|=E.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(y),this.depthMask.set(!0)),_!==void 0&&(P|=E.STENCIL_BUFFER_BIT,this.clearStencil.set(_),this.stencilMask.set(255)),E.clear(P)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){o.aD(l.blendFunction,vr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}createVertexArray(){var l;return Bi(this.gl)?this.gl.createVertexArray():(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.createVertexArrayOES()}deleteVertexArray(l){var d;return Bi(this.gl)?this.gl.deleteVertexArray(l):(d=this.gl.getExtension("OES_vertex_array_object"))===null||d===void 0?void 0:d.deleteVertexArrayOES(l)}unbindVAO(){this.bindVertexArray.set(null)}}class br{constructor(l,d,y){this.func=l,this.mask=d,this.range=y}}br.ReadOnly=!1,br.ReadWrite=!0,br.disabled=new br(519,br.ReadOnly,[0,1]);const Ai=7680;class Kr{constructor(l,d,y,_,E,P){this.test=l,this.ref=d,this.mask=y,this.fail=_,this.depthFail=E,this.pass=P}}Kr.disabled=new Kr({func:519,mask:0},0,0,Ai,Ai,Ai);class Xr{constructor(l,d,y){this.enable=l,this.mode=d,this.frontFace=y}}let si;function ks(C,l,d,y,_,E,P){const R=C.context,g=R.gl,w=C.useProgram("collisionBox"),T=[];let L=0,D=0;for(let ne=0;ne<y.length;ne++){const de=y[ne],me=l.getTile(de),Ue=me.getBucket(d);if(!Ue)continue;let Ie=de.posMatrix;_[0]===0&&_[1]===0||(Ie=C.translatePosMatrix(de.posMatrix,me,_,E));const ve=P?Ue.textCollisionBox:Ue.iconCollisionBox,we=Ue.collisionCircleArray;if(we.length>0){const Ve=o.F(),Xe=Ie;o.aP(Ve,Ue.placementInvProjMatrix,C.transform.glCoordMatrix),o.aP(Ve,Ve,Ue.placementViewportMatrix),T.push({circleArray:we,circleOffset:D,transform:Xe,invTransform:Ve,coord:de}),L+=we.length/4,D=L}ve&&w.draw(R,g.LINES,br.disabled,Kr.disabled,C.colorModeForRenderPass(),Xr.disabled,Wn(Ie,C.transform,me),C.style.map.terrain&&C.style.map.terrain.getTerrainData(de),d.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,null,C.transform.zoom,null,null,ve.collisionVertexBuffer)}if(!P||!T.length)return;const H=C.useProgram("collisionCircle"),z=new o.aQ;z.resize(4*L),z._trim();let j=0;for(const ne of T)for(let de=0;de<ne.circleArray.length/4;de++){const me=4*de,Ue=ne.circleArray[me+0],Ie=ne.circleArray[me+1],ve=ne.circleArray[me+2],we=ne.circleArray[me+3];z.emplace(j++,Ue,Ie,ve,we,0),z.emplace(j++,Ue,Ie,ve,we,1),z.emplace(j++,Ue,Ie,ve,we,2),z.emplace(j++,Ue,Ie,ve,we,3)}(!si||si.length<2*L)&&(si=function(ne){const de=2*ne,me=new o.aS;me.resize(de),me._trim();for(let Ue=0;Ue<de;Ue++){const Ie=6*Ue;me.uint16[Ie+0]=4*Ue+0,me.uint16[Ie+1]=4*Ue+1,me.uint16[Ie+2]=4*Ue+2,me.uint16[Ie+3]=4*Ue+2,me.uint16[Ie+4]=4*Ue+3,me.uint16[Ie+5]=4*Ue+0}return me}(L));const V=R.createIndexBuffer(si,!0),X=R.createVertexBuffer(z,o.aR.members,!0);for(const ne of T){const de={u_matrix:ne.transform,u_inv_matrix:ne.invTransform,u_camera_to_center_distance:(ue=C.transform).cameraToCenterDistance,u_viewport_size:[ue.width,ue.height]};H.draw(R,g.TRIANGLES,br.disabled,Kr.disabled,C.colorModeForRenderPass(),Xr.disabled,de,C.style.map.terrain&&C.style.map.terrain.getTerrainData(ne.coord),d.id,X,V,o.$.simpleSegment(0,2*ne.circleOffset,ne.circleArray.length,ne.circleArray.length/2),null,C.transform.zoom,null,null,null)}var ue;X.destroy(),V.destroy()}Xr.disabled=new Xr(!1,1029,2305),Xr.backCCW=new Xr(!0,1029,2305);const Ns=o.an(new Float32Array(16));function _a(C,l,d,y,_,E){const{horizontalAlign:P,verticalAlign:R}=o.at(C);return new o.P((-(P-.5)*l/_+y[0])*E,(-(R-.5)*d/_+y[1])*E)}function fl(C,l,d,y,_,E,P,R,g,w,T){const L=C.text.placedSymbolArray,D=C.text.dynamicLayoutVertexArray,H=C.icon.dynamicLayoutVertexArray,z={};D.clear();for(let j=0;j<L.length;j++){const V=L.get(j),X=V.hidden||!V.crossTileID||C.allowVerticalPlacement&&!V.placedOrientation?null:y[V.crossTileID];if(X){const ue=new o.P(V.anchorX,V.anchorY),ne=Wr(ue,d?P:E,T),de=Ee(_.cameraToCenterDistance,ne.signedDistanceFromCamera);let me=o.ai(C.textSizeData,g,V)*de/o.ao;d&&(me*=C.tilePixelRatio/R);const{width:Ue,height:Ie,anchor:ve,textOffset:we,textBoxScale:Ve}=X,Xe=_a(ve,Ue,Ie,we,Ve,me),At=d?Wr(ue.add(Xe),E,T).point:ne.point.add(l?Xe.rotate(-_.angle):Xe),ht=C.allowVerticalPlacement&&V.placedOrientation===o.ah.vertical?Math.PI/2:0;for(let _t=0;_t<V.numGlyphs;_t++)o.aj(D,At,ht);w&&V.associatedIconIndex>=0&&(z[V.associatedIconIndex]={shiftedAnchor:At,angle:ht})}else ft(V.numGlyphs,D)}if(w){H.clear();const j=C.icon.placedSymbolArray;for(let V=0;V<j.length;V++){const X=j.get(V);if(X.hidden)ft(X.numGlyphs,H);else{const ue=z[V];if(ue)for(let ne=0;ne<X.numGlyphs;ne++)o.aj(H,ue.shiftedAnchor,ue.angle);else ft(X.numGlyphs,H)}}C.icon.dynamicLayoutVertexBuffer.updateData(H)}C.text.dynamicLayoutVertexBuffer.updateData(D)}function wc(C,l,d){return d.iconsInText&&l?"symbolTextAndIcon":C?"symbolSDF":"symbolIcon"}function xc(C,l,d,y,_,E,P,R,g,w,T,L){const D=C.context,H=D.gl,z=C.transform,j=R==="map",V=g==="map",X=R!=="viewport"&&d.layout.get("symbol-placement")!=="point",ue=j&&!V&&!X,ne=!d.layout.get("symbol-sort-key").isConstant();let de=!1;const me=C.depthModeForSublayer(0,br.ReadOnly),Ue=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ie=[];for(const ve of y){const we=l.getTile(ve),Ve=we.getBucket(d);if(!Ve)continue;const Xe=_?Ve.text:Ve.icon;if(!Xe||!Xe.segments.get().length||!Xe.hasVisibleVertices)continue;const At=Xe.programConfigurations.get(d.id),ht=_||Ve.sdfIcons,_t=_?Ve.textSizeData:Ve.iconSizeData,Ot=V||z.pitch!==0,Et=C.useProgram(wc(ht,_,Ve),At),$t=o.ag(_t,z.zoom),nr=C.style.map.terrain&&C.style.map.terrain.getTerrainData(ve);let rr,Sr,Fr,en,xr=[0,0],Jr=null;if(_)Sr=we.glyphAtlasTexture,Fr=H.LINEAR,rr=we.glyphAtlasTexture.size,Ve.iconsInText&&(xr=we.imageAtlasTexture.size,Jr=we.imageAtlasTexture,en=Ot||C.options.rotating||C.options.zooming||_t.kind==="composite"||_t.kind==="camera"?H.LINEAR:H.NEAREST);else{const un=d.layout.get("icon-size").constantOr(0)!==1||Ve.iconsNeedLinear;Sr=we.imageAtlasTexture,Fr=ht||C.options.rotating||C.options.zooming||un||Ot?H.LINEAR:H.NEAREST,rr=we.imageAtlasTexture.size}const Cn=lr(we,1,C.transform.zoom),En=gr(ve.posMatrix,V,j,C.transform,Cn),di=an(ve.posMatrix,V,j,C.transform,Cn),dn=Ue&&Ve.hasTextData(),ls=d.layout.get("icon-text-fit")!=="none"&&dn&&Ve.hasIconData();if(X){const un=C.style.map.terrain?(Xi,ti)=>C.style.map.terrain.getElevation(ve,Xi,ti):null,Sn=d.layout.get("text-rotation-alignment")==="map";Z(Ve,ve.posMatrix,C,_,En,di,V,w,Sn,un)}const Fi=C.translatePosMatrix(ve.posMatrix,we,E,P),Gn=X||_&&Ue||ls?Ns:En,fn=C.translatePosMatrix(di,we,E,P,!0),on=ht&&d.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let pn;pn=ht?Ve.iconsInText?ul(_t.kind,$t,ue,V,C,Fi,Gn,fn,rr,xr):ll(_t.kind,$t,ue,V,C,Fi,Gn,fn,_,rr,!0):Ha(_t.kind,$t,ue,V,C,Fi,Gn,fn,_,rr);const Si={program:Et,buffers:Xe,uniformValues:pn,atlasTexture:Sr,atlasTextureIcon:Jr,atlasInterpolation:Fr,atlasInterpolationIcon:en,isSDF:ht,hasHalo:on};if(ne&&Ve.canOverlap){de=!0;const un=Xe.segments.get();for(const Sn of un)Ie.push({segments:new o.$([Sn]),sortKey:Sn.sortKey,state:Si,terrainData:nr})}else Ie.push({segments:Xe.segments,sortKey:0,state:Si,terrainData:nr})}de&&Ie.sort((ve,we)=>ve.sortKey-we.sortKey);for(const ve of Ie){const we=ve.state;if(D.activeTexture.set(H.TEXTURE0),we.atlasTexture.bind(we.atlasInterpolation,H.CLAMP_TO_EDGE),we.atlasTextureIcon&&(D.activeTexture.set(H.TEXTURE1),we.atlasTextureIcon&&we.atlasTextureIcon.bind(we.atlasInterpolationIcon,H.CLAMP_TO_EDGE)),we.isSDF){const Ve=we.uniformValues;we.hasHalo&&(Ve.u_is_halo=1,pl(we.buffers,ve.segments,d,C,we.program,me,T,L,Ve,ve.terrainData)),Ve.u_is_halo=0}pl(we.buffers,ve.segments,d,C,we.program,me,T,L,we.uniformValues,ve.terrainData)}}function pl(C,l,d,y,_,E,P,R,g,w){const T=y.context;_.draw(T,T.gl.TRIANGLES,E,P,R,Xr.disabled,g,w,d.id,C.layoutVertexBuffer,C.indexBuffer,l,d.paint,y.transform.zoom,C.programConfigurations.get(d.id),C.dynamicLayoutVertexBuffer,C.opacityVertexBuffer)}function Bc(C,l,d,y,_){if(!d||!y||!y.imageAtlas)return;const E=y.imageAtlas.patternPositions;let P=E[d.to.toString()],R=E[d.from.toString()];if(!P&&R&&(P=R),!R&&P&&(R=P),!P||!R){const g=_.getPaintProperty(l);P=E[g],R=E[g]}P&&R&&C.setConstantPatternPositions(P,R)}function cu(C,l,d,y,_,E,P){const R=C.context.gl,g="fill-pattern",w=d.paint.get(g),T=w&&w.constantOr(1),L=d.getCrossfadeParameters();let D,H,z,j,V;P?(H=T&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",D=R.LINES):(H=T?"fillPattern":"fill",D=R.TRIANGLES);const X=w.constantOr(null);for(const ue of y){const ne=l.getTile(ue);if(T&&!ne.patternsLoaded())continue;const de=ne.getBucket(d);if(!de)continue;const me=de.programConfigurations.get(d.id),Ue=C.useProgram(H,me),Ie=C.style.map.terrain&&C.style.map.terrain.getTerrainData(ue);T&&(C.context.activeTexture.set(R.TEXTURE0),ne.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),me.updatePaintBuffers(L)),Bc(me,g,X,ne,d);const ve=Ie?ue:null,we=C.translatePosMatrix(ve?ve.posMatrix:ue.posMatrix,ne,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(P){j=de.indexBuffer2,V=de.segments2;const Ve=[R.drawingBufferWidth,R.drawingBufferHeight];z=H==="fillOutlinePattern"&&T?sr(we,C,L,ne,Ve):Mt(we,Ve)}else j=de.indexBuffer,V=de.segments,z=T?dt(we,C,L,ne):He(we);Ue.draw(C.context,D,_,C.stencilModeForClipping(ue),E,Xr.disabled,z,Ie,d.id,de.layoutVertexBuffer,j,V,d.paint,C.transform.zoom,me)}}function Ga(C,l,d,y,_,E,P){const R=C.context,g=R.gl,w="fill-extrusion-pattern",T=d.paint.get(w),L=T.constantOr(1),D=d.getCrossfadeParameters(),H=d.paint.get("fill-extrusion-opacity"),z=T.constantOr(null);for(const j of y){const V=l.getTile(j),X=V.getBucket(d);if(!X)continue;const ue=C.style.map.terrain&&C.style.map.terrain.getTerrainData(j),ne=X.programConfigurations.get(d.id),de=C.useProgram(L?"fillExtrusionPattern":"fillExtrusion",ne);L&&(C.context.activeTexture.set(g.TEXTURE0),V.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),ne.updatePaintBuffers(D)),Bc(ne,w,z,V,d);const me=C.translatePosMatrix(j.posMatrix,V,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Ue=d.paint.get("fill-extrusion-vertical-gradient"),Ie=L?Be(me,C,Ue,H,j,D,V):he(me,C,Ue,H);de.draw(R,R.gl.TRIANGLES,_,E,P,Xr.backCCW,Ie,ue,d.id,X.layoutVertexBuffer,X.indexBuffer,X.segments,d.paint,C.transform.zoom,ne,C.style.map.terrain&&X.centroidVertexBuffer)}}function cs(C,l,d,y,_,E,P){const R=C.context,g=R.gl,w=d.fbo;if(!w)return;const T=C.useProgram("hillshade"),L=C.style.map.terrain&&C.style.map.terrain.getTerrainData(l);R.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,w.colorAttachment.get()),T.draw(R,g.TRIANGLES,_,E,P,Xr.disabled,((D,H,z,j)=>{const V=z.paint.get("hillshade-shadow-color"),X=z.paint.get("hillshade-highlight-color"),ue=z.paint.get("hillshade-accent-color");let ne=z.paint.get("hillshade-illumination-direction")*(Math.PI/180);z.paint.get("hillshade-illumination-anchor")==="viewport"&&(ne-=D.transform.angle);const de=!D.options.moving;return{u_matrix:j?j.posMatrix:D.transform.calculatePosMatrix(H.tileID.toUnwrapped(),de),u_image:0,u_latrange:eh(0,H.tileID),u_light:[z.paint.get("hillshade-exaggeration"),ne],u_shadow:V,u_highlight:X,u_accent:ue}})(C,d,y,L?l:null),L,y.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments)}function Cc(C,l,d,y,_,E){const P=C.context,R=P.gl,g=l.dem;if(g&&g.data){const w=g.dim,T=g.stride,L=g.getPixels();if(P.activeTexture.set(R.TEXTURE1),P.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||C.getTileTexture(T),l.demTexture){const H=l.demTexture;H.update(L,{premultiply:!1}),H.bind(R.NEAREST,R.CLAMP_TO_EDGE)}else l.demTexture=new oe(P,L,R.RGBA,{premultiply:!1}),l.demTexture.bind(R.NEAREST,R.CLAMP_TO_EDGE);P.activeTexture.set(R.TEXTURE0);let D=l.fbo;if(!D){const H=new oe(P,{width:w,height:w,data:null},R.RGBA);H.bind(R.LINEAR,R.CLAMP_TO_EDGE),D=l.fbo=P.createFramebuffer(w,w,!0,!1),D.colorAttachment.set(H.texture)}P.bindFramebuffer.set(D.framebuffer),P.viewport.set([0,0,w,w]),C.useProgram("hillshadePrepare").draw(P,R.TRIANGLES,y,_,E,Xr.disabled,((H,z)=>{const j=z.stride,V=o.F();return o.aN(V,0,o.W,-o.W,0,0,1),o.H(V,V,[0,-o.W,0]),{u_matrix:V,u_image:1,u_dimension:[j,j],u_zoom:H.overscaledZ,u_unpack:z.getUnpackVector()}})(l.tileID,g),null,d.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments),l.needsHillshadePrepare=!1}}function gl(C,l,d,y,_,E){const P=y.paint.get("raster-fade-duration");if(!E&&P>0){const R=v.now(),g=(R-C.timeAdded)/P,w=l?(R-l.timeAdded)/P:-1,T=d.getSource(),L=_.coveringZoomLevel({tileSize:T.tileSize,roundZoom:T.roundZoom}),D=!l||Math.abs(l.tileID.overscaledZ-L)>Math.abs(C.tileID.overscaledZ-L),H=D&&C.refreshedUponExpiration?1:o.ac(D?g:1-w,0,1);return C.refreshedUponExpiration&&g>=1&&(C.refreshedUponExpiration=!1),l?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}const ml=new o.aO(1,0,0,1),Ec=new o.aO(0,1,0,1),vs=new o.aO(0,0,1,1),dd=new o.aO(1,0,1,1),lu=new o.aO(0,1,1,1);function $n(C,l,d,y){Oi(C,0,l+d/2,C.transform.width,d,y)}function qi(C,l,d,y){Oi(C,l-d/2,0,d,C.transform.height,y)}function Oi(C,l,d,y,_,E){const P=C.context,R=P.gl;R.enable(R.SCISSOR_TEST),R.scissor(l*C.pixelRatio,d*C.pixelRatio,y*C.pixelRatio,_*C.pixelRatio),P.clear({color:E}),R.disable(R.SCISSOR_TEST)}function eA(C,l,d){const y=C.context,_=y.gl,E=d.posMatrix,P=C.useProgram("debug"),R=br.disabled,g=Kr.disabled,w=C.colorModeForRenderPass(),T="$debug",L=C.style.map.terrain&&C.style.map.terrain.getTerrainData(d);y.activeTexture.set(_.TEXTURE0);const D=l.getTileByID(d.key).latestRawTileData,H=Math.floor((D&&D.byteLength||0)/1024),z=l.getTile(d).tileSize,j=512/Math.min(z,512)*(d.overscaledZ/C.transform.zoom)*.5;let V=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(V+=` => ${d.overscaledZ}`),function(X,ue){X.initDebugOverlayCanvas();const ne=X.debugOverlayCanvas,de=X.context.gl,me=X.debugOverlayCanvas.getContext("2d");me.clearRect(0,0,ne.width,ne.height),me.shadowColor="white",me.shadowBlur=2,me.lineWidth=1.5,me.strokeStyle="white",me.textBaseline="top",me.font="bold 36px Open Sans, sans-serif",me.fillText(ue,5,5),me.strokeText(ue,5,5),X.debugOverlayTexture.update(ne),X.debugOverlayTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE)}(C,`${V} ${H}kB`),P.draw(y,_.TRIANGLES,R,g,vr.alphaBlended,Xr.disabled,Zn(E,o.aO.transparent,j),null,T,C.debugBuffer,C.quadTriangleIndexBuffer,C.debugSegments),P.draw(y,_.LINE_STRIP,R,g,w,Xr.disabled,Zn(E,o.aO.red),L,T,C.debugBuffer,C.tileBorderIndexBuffer,C.debugSegments)}function uu(C,l,d){const y=C.context,_=y.gl,E=C.colorModeForRenderPass(),P=new br(_.LEQUAL,br.ReadWrite,C.depthRangeFor3D),R=C.useProgram("terrain"),g=l.getTerrainMesh();y.bindFramebuffer.set(null),y.viewport.set([0,0,C.width,C.height]);for(const w of d){const T=C.renderToTexture.getTexture(w),L=l.getTerrainData(w.tileID);y.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,T.texture);const D={u_matrix:C.transform.calculatePosMatrix(w.tileID.toUnwrapped()),u_texture:0,u_ele_delta:l.getMeshFrameDelta(C.transform.zoom)};R.draw(y,_.TRIANGLES,P,Kr.disabled,E,Xr.backCCW,D,L,"terrain",g.vertexBuffer,g.indexBuffer,g.segments)}}class Va{constructor(l,d){this.context=new wn(l),this.transform=d,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Mr.maxUnderzooming+Mr.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Cs}resize(l,d,y){if(this.width=Math.floor(l*y),this.height=Math.floor(d*y),this.pixelRatio=y,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const l=this.context,d=new o.aV;d.emplaceBack(0,0),d.emplaceBack(o.W,0),d.emplaceBack(0,o.W),d.emplaceBack(o.W,o.W),this.tileExtentBuffer=l.createVertexBuffer(d,Ui.members),this.tileExtentSegments=o.$.simpleSegment(0,0,4,2);const y=new o.aV;y.emplaceBack(0,0),y.emplaceBack(o.W,0),y.emplaceBack(0,o.W),y.emplaceBack(o.W,o.W),this.debugBuffer=l.createVertexBuffer(y,Ui.members),this.debugSegments=o.$.simpleSegment(0,0,4,5);const _=new o.Z;_.emplaceBack(0,0,0,0),_.emplaceBack(o.W,0,o.W,0),_.emplaceBack(0,o.W,0,o.W),_.emplaceBack(o.W,o.W,o.W,o.W),this.rasterBoundsBuffer=l.createVertexBuffer(_,vt.members),this.rasterBoundsSegments=o.$.simpleSegment(0,0,4,2);const E=new o.aV;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(E,Ui.members),this.viewportSegments=o.$.simpleSegment(0,0,4,2);const P=new o.aW;P.emplaceBack(0),P.emplaceBack(1),P.emplaceBack(3),P.emplaceBack(2),P.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(P);const R=new o.aX;R.emplaceBack(0,1,2),R.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(R);const g=this.context.gl;this.stencilClearMode=new Kr({func:g.ALWAYS,mask:0},0,255,g.ZERO,g.ZERO,g.ZERO)}clearStencil(){const l=this.context,d=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const y=o.F();o.aN(y,0,this.width,this.height,0,0,1),o.J(y,y,[d.drawingBufferWidth,d.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,d.TRIANGLES,br.disabled,this.stencilClearMode,vr.disabled,Xr.disabled,ui(y),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,d){if(this.currentStencilSource===l.source||!l.isTileClipped()||!d||!d.length)return;this.currentStencilSource=l.source;const y=this.context,_=y.gl;this.nextStencilID+d.length>256&&this.clearStencil(),y.setColorMode(vr.disabled),y.setDepthMode(br.disabled);const E=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const P of d){const R=this._tileClippingMaskIDs[P.key]=this.nextStencilID++,g=this.style.map.terrain&&this.style.map.terrain.getTerrainData(P);E.draw(y,_.TRIANGLES,br.disabled,new Kr({func:_.ALWAYS,mask:0},R,255,_.KEEP,_.KEEP,_.REPLACE),vr.disabled,Xr.disabled,ui(P.posMatrix),g,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,d=this.context.gl;return new Kr({func:d.NOTEQUAL,mask:255},l,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(l){const d=this.context.gl;return new Kr({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(l){const d=this.context.gl,y=l.sort((P,R)=>R.overscaledZ-P.overscaledZ),_=y[y.length-1].overscaledZ,E=y[0].overscaledZ-_+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const P={};for(let R=0;R<E;R++)P[R+_]=new Kr({func:d.GEQUAL,mask:255},R+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=E,[P,y]}return[{[_]:Kr.disabled},y]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new vr([l.CONSTANT_COLOR,l.ONE],new o.aO(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?vr.unblended:vr.alphaBlended}depthModeForSublayer(l,d,y){if(!this.opaquePassEnabledForLayer())return br.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new br(y||this.context.gl.LEQUAL,d,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,d){this.style=l,this.options=d,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(v.now()),this.imageManager.beginFrame();const y=this.style._order,_=this.style.sourceCaches,E={},P={},R={};for(const g in _){const w=_[g];w.used&&w.prepare(this.context),E[g]=w.getVisibleCoordinates(),P[g]=E[g].slice().reverse(),R[g]=w.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let g=0;g<y.length;g++)if(this.style._layers[y[g]].is3D()){this.opaquePassCutoff=g;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const g of y){const w=this.style._layers[g];if(!w.hasOffscreenPass()||w.isHidden(this.transform.zoom))continue;const T=P[w.source];(w.type==="custom"||T.length)&&this.renderLayer(this,_[w.source],w,T)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?o.aO.black:o.aO.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const g=this.style._layers[y[this.currentLayer]],w=_[g.source],T=E[g.source];this._renderTileClippingMasks(g,T),this.renderLayer(this,w,g,T)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const g=this.style._layers[y[this.currentLayer]],w=_[g.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(g))continue;const T=(g.type==="symbol"?R:P)[g.source];this._renderTileClippingMasks(g,E[g.source]),this.renderLayer(this,w,g,T)}if(this.options.showTileBoundaries){const g=function(w,T){let L=null;const D=Object.values(w._layers).flatMap(V=>V.source&&!V.isHidden(T)?[w.sourceCaches[V.source]]:[]),H=D.filter(V=>V.getSource().type==="vector"),z=D.filter(V=>V.getSource().type!=="vector"),j=V=>{(!L||L.getSource().maxzoom<V.getSource().maxzoom)&&(L=V)};return H.forEach(V=>j(V)),L||z.forEach(V=>j(V)),L}(this.style,this.transform.zoom);g&&function(w,T,L){for(let D=0;D<L.length;D++)eA(w,T,L[D])}(this,g,g.getVisibleCoordinates())}this.options.showPadding&&function(g){const w=g.transform.padding;$n(g,g.transform.height-(w.top||0),3,ml),$n(g,w.bottom||0,3,Ec),qi(g,w.left||0,3,vs),qi(g,g.transform.width-(w.right||0),3,dd);const T=g.transform.centerPoint;(function(L,D,H,z){Oi(L,D-1,H-10,2,20,z),Oi(L,D-10,H-1,20,2,z)})(g,T.x,g.transform.height-T.y,lu)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(l){if(!this.style||!this.style.map||!this.style.map.terrain)return;const d=this.terrainFacilitator.matrix,y=this.transform.projMatrix;let _=this.terrainFacilitator.dirty;_||(_=l?!o.aY(d,y):!o.aZ(d,y)),_||(_=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),_&&(o.a_(d,y),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(E,P){const R=E.context,g=R.gl,w=vr.unblended,T=new br(g.LEQUAL,br.ReadWrite,[0,1]),L=P.getTerrainMesh(),D=P.sourceCache.getRenderableTiles(),H=E.useProgram("terrainDepth");R.bindFramebuffer.set(P.getFramebuffer("depth").framebuffer),R.viewport.set([0,0,E.width/devicePixelRatio,E.height/devicePixelRatio]),R.clear({color:o.aO.transparent,depth:1});for(const z of D){const j=P.getTerrainData(z.tileID),V={u_matrix:E.transform.calculatePosMatrix(z.tileID.toUnwrapped()),u_ele_delta:P.getMeshFrameDelta(E.transform.zoom)};H.draw(R,g.TRIANGLES,T,Kr.disabled,w,Xr.backCCW,V,j,"terrain",L.vertexBuffer,L.indexBuffer,L.segments)}R.bindFramebuffer.set(null),R.viewport.set([0,0,E.width,E.height])}(this,this.style.map.terrain),function(E,P){const R=E.context,g=R.gl,w=vr.unblended,T=new br(g.LEQUAL,br.ReadWrite,[0,1]),L=P.getTerrainMesh(),D=P.getCoordsTexture(),H=P.sourceCache.getRenderableTiles(),z=E.useProgram("terrainCoords");R.bindFramebuffer.set(P.getFramebuffer("coords").framebuffer),R.viewport.set([0,0,E.width/devicePixelRatio,E.height/devicePixelRatio]),R.clear({color:o.aO.transparent,depth:1}),P.coordsIndex=[];for(const j of H){const V=P.getTerrainData(j.tileID);R.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,D.texture);const X={u_matrix:E.transform.calculatePosMatrix(j.tileID.toUnwrapped()),u_terrain_coords_id:(255-P.coordsIndex.length)/255,u_texture:0,u_ele_delta:P.getMeshFrameDelta(E.transform.zoom)};z.draw(R,g.TRIANGLES,T,Kr.disabled,w,Xr.backCCW,X,V,"terrain",L.vertexBuffer,L.indexBuffer,L.segments),P.coordsIndex.push(j.tileID.key)}R.bindFramebuffer.set(null),R.viewport.set([0,0,E.width,E.height])}(this,this.style.map.terrain))}renderLayer(l,d,y,_){if(!y.isHidden(this.transform.zoom)&&(y.type==="background"||y.type==="custom"||(_||[]).length))switch(this.id=y.id,y.type){case"symbol":(function(E,P,R,g,w){if(E.renderPass!=="translucent")return;const T=Kr.disabled,L=E.colorModeForRenderPass();(R._unevaluatedLayout.hasValue("text-variable-anchor")||R._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(D,H,z,j,V,X,ue){const ne=H.transform,de=V==="map",me=X==="map";for(const Ue of D){const Ie=j.getTile(Ue),ve=Ie.getBucket(z);if(!ve||!ve.text||!ve.text.segments.get().length)continue;const we=o.ag(ve.textSizeData,ne.zoom),Ve=lr(Ie,1,H.transform.zoom),Xe=gr(Ue.posMatrix,me,de,H.transform,Ve),At=z.layout.get("icon-text-fit")!=="none"&&ve.hasIconData();if(we){const ht=Math.pow(2,ne.zoom-Ie.tileID.overscaledZ);fl(ve,de,me,ue,ne,Xe,Ue.posMatrix,ht,we,At,H.style.map.terrain?(_t,Ot)=>H.style.map.terrain.getElevation(Ue,_t,Ot):null)}}}(g,E,R,P,R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),w),R.paint.get("icon-opacity").constantOr(1)!==0&&xc(E,P,R,g,!1,R.paint.get("icon-translate"),R.paint.get("icon-translate-anchor"),R.layout.get("icon-rotation-alignment"),R.layout.get("icon-pitch-alignment"),R.layout.get("icon-keep-upright"),T,L),R.paint.get("text-opacity").constantOr(1)!==0&&xc(E,P,R,g,!0,R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),R.layout.get("text-keep-upright"),T,L),P.map.showCollisionBoxes&&(ks(E,P,R,g,R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),!0),ks(E,P,R,g,R.paint.get("icon-translate"),R.paint.get("icon-translate-anchor"),!1))})(l,d,y,_,this.style.placement.variableOffsets);break;case"circle":(function(E,P,R,g){if(E.renderPass!=="translucent")return;const w=R.paint.get("circle-opacity"),T=R.paint.get("circle-stroke-width"),L=R.paint.get("circle-stroke-opacity"),D=!R.layout.get("circle-sort-key").isConstant();if(w.constantOr(1)===0&&(T.constantOr(1)===0||L.constantOr(1)===0))return;const H=E.context,z=H.gl,j=E.depthModeForSublayer(0,br.ReadOnly),V=Kr.disabled,X=E.colorModeForRenderPass(),ue=[];for(let ne=0;ne<g.length;ne++){const de=g[ne],me=P.getTile(de),Ue=me.getBucket(R);if(!Ue)continue;const Ie=Ue.programConfigurations.get(R.id),ve=E.useProgram("circle",Ie),we=Ue.layoutVertexBuffer,Ve=Ue.indexBuffer,Xe=E.style.map.terrain&&E.style.map.terrain.getTerrainData(de),At={programConfiguration:Ie,program:ve,layoutVertexBuffer:we,indexBuffer:Ve,uniformValues:zr(E,de,me,R),terrainData:Xe};if(D){const ht=Ue.segments.get();for(const _t of ht)ue.push({segments:new o.$([_t]),sortKey:_t.sortKey,state:At})}else ue.push({segments:Ue.segments,sortKey:0,state:At})}D&&ue.sort((ne,de)=>ne.sortKey-de.sortKey);for(const ne of ue){const{programConfiguration:de,program:me,layoutVertexBuffer:Ue,indexBuffer:Ie,uniformValues:ve,terrainData:we}=ne.state;me.draw(H,z.TRIANGLES,j,V,X,Xr.disabled,ve,we,R.id,Ue,Ie,ne.segments,R.paint,E.transform.zoom,de)}})(l,d,y,_);break;case"heatmap":(function(E,P,R,g){if(R.paint.get("heatmap-opacity")!==0)if(E.renderPass==="offscreen"){const w=E.context,T=w.gl,L=Kr.disabled,D=new vr([T.ONE,T.ONE],o.aO.transparent,[!0,!0,!0,!0]);(function(H,z,j){const V=H.gl;H.activeTexture.set(V.TEXTURE1),H.viewport.set([0,0,z.width/4,z.height/4]);let X=j.heatmapFbo;if(X)V.bindTexture(V.TEXTURE_2D,X.colorAttachment.get()),H.bindFramebuffer.set(X.framebuffer);else{const ue=V.createTexture();V.bindTexture(V.TEXTURE_2D,ue),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_T,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,V.LINEAR),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,V.LINEAR),X=j.heatmapFbo=H.createFramebuffer(z.width/4,z.height/4,!1,!1),function(ne,de,me,Ue){var Ie,ve;const we=ne.gl,Ve=(Ie=ne.HALF_FLOAT)!==null&&Ie!==void 0?Ie:we.UNSIGNED_BYTE,Xe=(ve=ne.RGBA16F)!==null&&ve!==void 0?ve:we.RGBA;we.texImage2D(we.TEXTURE_2D,0,Xe,de.width/4,de.height/4,0,we.RGBA,Ve,null),Ue.colorAttachment.set(me)}(H,z,ue,X)}})(w,E,R),w.clear({color:o.aO.transparent});for(let H=0;H<g.length;H++){const z=g[H];if(P.hasRenderableParent(z))continue;const j=P.getTile(z),V=j.getBucket(R);if(!V)continue;const X=V.programConfigurations.get(R.id),ue=E.useProgram("heatmap",X),{zoom:ne}=E.transform;ue.draw(w,T.TRIANGLES,br.disabled,L,D,Xr.disabled,Nn(z.posMatrix,j,ne,R.paint.get("heatmap-intensity")),null,R.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,R.paint,E.transform.zoom,X)}w.viewport.set([0,0,E.width,E.height])}else E.renderPass==="translucent"&&(E.context.setColorMode(E.colorModeForRenderPass()),function(w,T){const L=w.context,D=L.gl,H=T.heatmapFbo;if(!H)return;L.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,H.colorAttachment.get()),L.activeTexture.set(D.TEXTURE1);let z=T.colorRampTexture;z||(z=T.colorRampTexture=new oe(L,T.colorRamp,D.RGBA)),z.bind(D.LINEAR,D.CLAMP_TO_EDGE),w.useProgram("heatmapTexture").draw(L,D.TRIANGLES,br.disabled,Kr.disabled,w.colorModeForRenderPass(),Xr.disabled,((j,V,X,ue)=>{const ne=o.F();o.aN(ne,0,j.width,j.height,0,0,1);const de=j.context.gl;return{u_matrix:ne,u_world:[de.drawingBufferWidth,de.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:V.paint.get("heatmap-opacity")}})(w,T),null,T.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,T.paint,w.transform.zoom)}(E,R))})(l,d,y,_);break;case"line":(function(E,P,R,g){if(E.renderPass!=="translucent")return;const w=R.paint.get("line-opacity"),T=R.paint.get("line-width");if(w.constantOr(1)===0||T.constantOr(1)===0)return;const L=E.depthModeForSublayer(0,br.ReadOnly),D=E.colorModeForRenderPass(),H=R.paint.get("line-dasharray"),z=R.paint.get("line-pattern"),j=z.constantOr(1),V=R.paint.get("line-gradient"),X=R.getCrossfadeParameters(),ue=j?"linePattern":H?"lineSDF":V?"lineGradient":"line",ne=E.context,de=ne.gl;let me=!0;for(const Ue of g){const Ie=P.getTile(Ue);if(j&&!Ie.patternsLoaded())continue;const ve=Ie.getBucket(R);if(!ve)continue;const we=ve.programConfigurations.get(R.id),Ve=E.context.program.get(),Xe=E.useProgram(ue,we),At=me||Xe.program!==Ve,ht=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ue),_t=z.constantOr(null);if(_t&&Ie.imageAtlas){const $t=Ie.imageAtlas,nr=$t.patternPositions[_t.to.toString()],rr=$t.patternPositions[_t.from.toString()];nr&&rr&&we.setConstantPatternPositions(nr,rr)}const Ot=ht?Ue:null,Et=j?Qa(E,Ie,R,X,Ot):H?tu(E,Ie,R,H,X,Ot):V?Vr(E,Ie,R,ve.lineClipsArray.length,Ot):al(E,Ie,R,Ot);if(j)ne.activeTexture.set(de.TEXTURE0),Ie.imageAtlasTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE),we.updatePaintBuffers(X);else if(H&&(At||E.lineAtlas.dirty))ne.activeTexture.set(de.TEXTURE0),E.lineAtlas.bind(ne);else if(V){const $t=ve.gradients[R.id];let nr=$t.texture;if(R.gradientVersion!==$t.version){let rr=256;if(R.stepInterpolant){const Sr=P.getSource().maxzoom,Fr=Ue.canonical.z===Sr?Math.ceil(1<<E.transform.maxZoom-Ue.canonical.z):1;rr=o.ac(o.aT(ve.maxLineLength/o.W*1024*Fr),256,ne.maxTextureSize)}$t.gradient=o.aU({expression:R.gradientExpression(),evaluationKey:"lineProgress",resolution:rr,image:$t.gradient||void 0,clips:ve.lineClipsArray}),$t.texture?$t.texture.update($t.gradient):$t.texture=new oe(ne,$t.gradient,de.RGBA),$t.version=R.gradientVersion,nr=$t.texture}ne.activeTexture.set(de.TEXTURE0),nr.bind(R.stepInterpolant?de.NEAREST:de.LINEAR,de.CLAMP_TO_EDGE)}Xe.draw(ne,de.TRIANGLES,L,E.stencilModeForClipping(Ue),D,Xr.disabled,Et,ht,R.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,R.paint,E.transform.zoom,we,ve.layoutVertexBuffer2),me=!1}})(l,d,y,_);break;case"fill":(function(E,P,R,g){const w=R.paint.get("fill-color"),T=R.paint.get("fill-opacity");if(T.constantOr(1)===0)return;const L=E.colorModeForRenderPass(),D=R.paint.get("fill-pattern"),H=E.opaquePassEnabledForLayer()&&!D.constantOr(1)&&w.constantOr(o.aO.transparent).a===1&&T.constantOr(0)===1?"opaque":"translucent";if(E.renderPass===H){const z=E.depthModeForSublayer(1,E.renderPass==="opaque"?br.ReadWrite:br.ReadOnly);cu(E,P,R,g,z,L,!1)}if(E.renderPass==="translucent"&&R.paint.get("fill-antialias")){const z=E.depthModeForSublayer(R.getPaintProperty("fill-outline-color")?2:0,br.ReadOnly);cu(E,P,R,g,z,L,!0)}})(l,d,y,_);break;case"fill-extrusion":(function(E,P,R,g){const w=R.paint.get("fill-extrusion-opacity");if(w!==0&&E.renderPass==="translucent"){const T=new br(E.context.gl.LEQUAL,br.ReadWrite,E.depthRangeFor3D);if(w!==1||R.paint.get("fill-extrusion-pattern").constantOr(1))Ga(E,P,R,g,T,Kr.disabled,vr.disabled),Ga(E,P,R,g,T,E.stencilModeFor3D(),E.colorModeForRenderPass());else{const L=E.colorModeForRenderPass();Ga(E,P,R,g,T,Kr.disabled,L)}}})(l,d,y,_);break;case"hillshade":(function(E,P,R,g){if(E.renderPass!=="offscreen"&&E.renderPass!=="translucent")return;const w=E.context,T=E.depthModeForSublayer(0,br.ReadOnly),L=E.colorModeForRenderPass(),[D,H]=E.renderPass==="translucent"?E.stencilConfigForOverlap(g):[{},g];for(const z of H){const j=P.getTile(z);j.needsHillshadePrepare!==void 0&&j.needsHillshadePrepare&&E.renderPass==="offscreen"?Cc(E,j,R,T,Kr.disabled,L):E.renderPass==="translucent"&&cs(E,z,j,R,T,D[z.overscaledZ],L)}w.viewport.set([0,0,E.width,E.height])})(l,d,y,_);break;case"raster":(function(E,P,R,g){if(E.renderPass!=="translucent"||R.paint.get("raster-opacity")===0||!g.length)return;const w=E.context,T=w.gl,L=P.getSource(),D=E.useProgram("raster"),H=E.colorModeForRenderPass(),[z,j]=L instanceof Bt?[{},g]:E.stencilConfigForOverlap(g),V=j[j.length-1].overscaledZ,X=!E.options.moving;for(const ue of j){const ne=E.depthModeForSublayer(ue.overscaledZ-V,R.paint.get("raster-opacity")===1?br.ReadWrite:br.ReadOnly,T.LESS),de=P.getTile(ue);de.registerFadeDuration(R.paint.get("raster-fade-duration"));const me=P.findLoadedParent(ue,0),Ue=gl(de,me,P,R,E.transform,E.style.map.terrain);let Ie,ve;const we=R.paint.get("raster-resampling")==="nearest"?T.NEAREST:T.LINEAR;w.activeTexture.set(T.TEXTURE0),de.texture.bind(we,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST),w.activeTexture.set(T.TEXTURE1),me?(me.texture.bind(we,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST),Ie=Math.pow(2,me.tileID.overscaledZ-de.tileID.overscaledZ),ve=[de.tileID.canonical.x*Ie%1,de.tileID.canonical.y*Ie%1]):de.texture.bind(we,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST);const Ve=E.style.map.terrain&&E.style.map.terrain.getTerrainData(ue),Xe=Ve?ue:null,At=Xe?Xe.posMatrix:E.transform.calculatePosMatrix(ue.toUnwrapped(),X),ht=cl(At,ve||[0,0],Ie||1,Ue,R);L instanceof Bt?D.draw(w,T.TRIANGLES,ne,Kr.disabled,H,Xr.disabled,ht,Ve,R.id,L.boundsBuffer,E.quadTriangleIndexBuffer,L.boundsSegments):D.draw(w,T.TRIANGLES,ne,z[ue.overscaledZ],H,Xr.disabled,ht,Ve,R.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments)}})(l,d,y,_);break;case"background":(function(E,P,R,g){const w=R.paint.get("background-color"),T=R.paint.get("background-opacity");if(T===0)return;const L=E.context,D=L.gl,H=E.transform,z=H.tileSize,j=R.paint.get("background-pattern");if(E.isPatternMissing(j))return;const V=!j&&w.a===1&&T===1&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass!==V)return;const X=Kr.disabled,ue=E.depthModeForSublayer(0,V==="opaque"?br.ReadWrite:br.ReadOnly),ne=E.colorModeForRenderPass(),de=E.useProgram(j?"backgroundPattern":"background"),me=g||H.coveringTiles({tileSize:z,terrain:E.style.map.terrain});j&&(L.activeTexture.set(D.TEXTURE0),E.imageManager.bind(E.context));const Ue=R.getCrossfadeParameters();for(const Ie of me){const ve=g?Ie.posMatrix:E.transform.calculatePosMatrix(Ie.toUnwrapped()),we=j?$u(ve,T,E,j,{tileID:Ie,tileSize:z},Ue):Ad(ve,T,w),Ve=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ie);de.draw(L,D.TRIANGLES,ue,X,ne,Xr.disabled,we,Ve,R.id,E.tileExtentBuffer,E.quadTriangleIndexBuffer,E.tileExtentSegments)}})(l,0,y,_);break;case"custom":(function(E,P,R){const g=E.context,w=R.implementation;if(E.renderPass==="offscreen"){const T=w.prerender;T&&(E.setCustomLayerDefaults(),g.setColorMode(E.colorModeForRenderPass()),T.call(w,g.gl,E.transform.customLayerMatrix()),g.setDirty(),E.setBaseState())}else if(E.renderPass==="translucent"){E.setCustomLayerDefaults(),g.setColorMode(E.colorModeForRenderPass()),g.setStencilMode(Kr.disabled);const T=w.renderingMode==="3d"?new br(E.context.gl.LEQUAL,br.ReadWrite,E.depthRangeFor3D):E.depthModeForSublayer(0,br.ReadOnly);g.setDepthMode(T),w.render(g.gl,E.transform.customLayerMatrix()),g.setDirty(),E.setBaseState(),g.bindFramebuffer.set(null)}})(l,0,y)}}translatePosMatrix(l,d,y,_,E){if(!y[0]&&!y[1])return l;const P=E?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(P){const w=Math.sin(P),T=Math.cos(P);y=[y[0]*T-y[1]*w,y[0]*w+y[1]*T]}const R=[E?y[0]:lr(d,y[0],this.transform.zoom),E?y[1]:lr(d,y[1],this.transform.zoom),0],g=new Float32Array(16);return o.H(g,l,R),g}saveTileTexture(l){const d=this._tileTextures[l.size[0]];d?d.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const d=this._tileTextures[l];return d&&d.length>0?d.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;const d=this.imageManager.getPattern(l.from.toString()),y=this.imageManager.getPattern(l.to.toString());return!d||!y}useProgram(l,d){this.cache=this.cache||{};const y=l+(d?d.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[y]||(this.cache[y]=new Ys(this.context,Li[l],d,gc[l],this._showOverdrawInspector,this.style.map.terrain)),this.cache[y]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new oe(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:l,drawingBufferHeight:d}=this.context.gl;return this.width!==l||this.height!==d}}class Di{constructor(l,d){this.points=l,this.planes=d}static fromInvProjectionMatrix(l,d,y){const _=Math.pow(2,y),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(R=>{const g=1/(R=o.af([],R,l))[3]/d*_;return o.a$(R,R,[g,g,1/R[3],g])}),P=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(R=>{const g=function(D,H){var z=H[0],j=H[1],V=H[2],X=z*z+j*j+V*V;return X>0&&(X=1/Math.sqrt(X)),D[0]=H[0]*X,D[1]=H[1]*X,D[2]=H[2]*X,D}([],function(D,H,z){var j=H[0],V=H[1],X=H[2],ue=z[0],ne=z[1],de=z[2];return D[0]=V*de-X*ne,D[1]=X*ue-j*de,D[2]=j*ne-V*ue,D}([],fe([],E[R[0]],E[R[1]]),fe([],E[R[2]],E[R[1]]))),w=-((T=g)[0]*(L=E[R[1]])[0]+T[1]*L[1]+T[2]*L[2]);var T,L;return g.concat(w)});return new Di(E,P)}}class Ki{constructor(l,d){this.min=l,this.max=d,this.center=function(y,_,E){return y[0]=.5*_[0],y[1]=.5*_[1],y[2]=.5*_[2],y}([],function(y,_,E){return y[0]=_[0]+E[0],y[1]=_[1]+E[1],y[2]=_[2]+E[2],y}([],this.min,this.max))}quadrant(l){const d=[l%2==0,l<2],y=ge(this.min),_=ge(this.max);for(let E=0;E<d.length;E++)y[E]=d[E]?this.min[E]:this.center[E],_[E]=d[E]?this.center[E]:this.max[E];return _[2]=this.max[2],new Ki(y,_)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}intersects(l){const d=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let y=!0;for(let _=0;_<l.planes.length;_++){const E=l.planes[_];let P=0;for(let R=0;R<d.length;R++)o.b0(E,d[R])>=0&&P++;if(P===0)return 0;P!==d.length&&(y=!1)}if(y)return 2;for(let _=0;_<3;_++){let E=Number.MAX_VALUE,P=-Number.MAX_VALUE;for(let R=0;R<l.points.length;R++){const g=l.points[R][_]-this.min[_];E=Math.min(E,g),P=Math.max(P,g)}if(P<0||E>this.max[_]-this.min[_])return 0}return 1}}class Zs{constructor(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,_=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(isNaN(l)||l<0||isNaN(d)||d<0||isNaN(y)||y<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=d,this.left=y,this.right=_}interpolate(l,d,y){return d.top!=null&&l.top!=null&&(this.top=o.z.number(l.top,d.top,y)),d.bottom!=null&&l.bottom!=null&&(this.bottom=o.z.number(l.bottom,d.bottom,y)),d.left!=null&&l.left!=null&&(this.left=o.z.number(l.left,d.left,y)),d.right!=null&&l.right!=null&&(this.right=o.z.number(l.right,d.right,y)),this}getCenter(l,d){const y=o.ac((this.left+l-this.right)/2,0,l),_=o.ac((this.top+d-this.bottom)/2,0,d);return new o.P(y,_)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new Zs(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const bo=85.051129;class wo{constructor(l,d,y,_,E){this.tileSize=512,this._renderWorldCopies=E===void 0||!!E,this._minZoom=l||0,this._maxZoom=d||22,this._minPitch=y??0,this._maxPitch=_??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Zs,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const l=new wo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.apply(this),l}apply(l){this.tileSize=l.tileSize,this.latRange=l.latRange,this.width=l.width,this.height=l.height,this._center=l._center,this._elevation=l._elevation,this.minElevationForCurrentTile=l.minElevationForCurrentTile,this.zoom=l.zoom,this.angle=l.angle,this._fov=l._fov,this._pitch=l._pitch,this._unmodified=l._unmodified,this._edgeInsets=l._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(l){const d=-o.b1(l,-180,180)*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=function(){var y=new o.A(4);return o.A!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y}(),function(y,_,E){var P=_[0],R=_[1],g=_[2],w=_[3],T=Math.sin(E),L=Math.cos(E);y[0]=P*L+g*T,y[1]=R*L+w*T,y[2]=P*-T+g*L,y[3]=R*-T+w*L}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const d=o.ac(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(l){const d=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.tileZoom=Math.max(0,Math.floor(d)),this.scale=this.zoomScale(d),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(l){l!==this._elevation&&(this._elevation=l,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,d,y){this._unmodified=!1,this._edgeInsets.interpolate(l,d,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const d=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(l){const d=[new o.b2(0,l)];if(this._renderWorldCopies){const y=this.pointCoordinate(new o.P(0,0)),_=this.pointCoordinate(new o.P(this.width,0)),E=this.pointCoordinate(new o.P(this.width,this.height)),P=this.pointCoordinate(new o.P(0,this.height)),R=Math.floor(Math.min(y.x,_.x,E.x,P.x)),g=Math.floor(Math.max(y.x,_.x,E.x,P.x)),w=1;for(let T=R-w;T<=g+w;T++)T!==0&&d.push(new o.b2(T,l))}return d}coveringTiles(l){var d,y;let _=this.coveringZoomLevel(l);const E=_;if(l.minzoom!==void 0&&_<l.minzoom)return[];l.maxzoom!==void 0&&_>l.maxzoom&&(_=l.maxzoom);const P=this.pointCoordinate(this.getCameraPoint()),R=o.Y.fromLngLat(this.center),g=Math.pow(2,_),w=[g*P.x,g*P.y,0],T=[g*R.x,g*R.y,0],L=Di.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,_);let D=l.minzoom||0;!l.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(D=_);const H=l.terrain?2/Math.min(this.tileSize,l.tileSize)*this.tileSize:3,z=ne=>({aabb:new Ki([ne*g,0,0],[(ne+1)*g,g,0]),zoom:0,x:0,y:0,wrap:ne,fullyVisible:!1}),j=[],V=[],X=_,ue=l.reparseOverscaled?E:_;if(this._renderWorldCopies)for(let ne=1;ne<=3;ne++)j.push(z(-ne)),j.push(z(ne));for(j.push(z(0));j.length>0;){const ne=j.pop(),de=ne.x,me=ne.y;let Ue=ne.fullyVisible;if(!Ue){const Xe=ne.aabb.intersects(L);if(Xe===0)continue;Ue=Xe===2}const Ie=l.terrain?w:T,ve=ne.aabb.distanceX(Ie),we=ne.aabb.distanceY(Ie),Ve=Math.max(Math.abs(ve),Math.abs(we));if(ne.zoom===X||Ve>H+(1<<X-ne.zoom)-2&&ne.zoom>=D){const Xe=X-ne.zoom,At=w[0]-.5-(de<<Xe),ht=w[1]-.5-(me<<Xe);V.push({tileID:new o.Q(ne.zoom===X?ue:ne.zoom,ne.wrap,ne.zoom,de,me),distanceSq:Oe([T[0]-.5-de,T[1]-.5-me]),tileDistanceToCamera:Math.sqrt(At*At+ht*ht)})}else for(let Xe=0;Xe<4;Xe++){const At=(de<<1)+Xe%2,ht=(me<<1)+(Xe>>1),_t=ne.zoom+1;let Ot=ne.aabb.quadrant(Xe);if(l.terrain){const Et=new o.Q(_t,ne.wrap,_t,At,ht),$t=l.terrain.getMinMaxElevation(Et),nr=(d=$t.minElevation)!==null&&d!==void 0?d:this.elevation,rr=(y=$t.maxElevation)!==null&&y!==void 0?y:this.elevation;Ot=new Ki([Ot.min[0],Ot.min[1],nr],[Ot.max[0],Ot.max[1],rr])}j.push({aabb:Ot,zoom:_t,x:At,y:ht,wrap:ne.wrap,fullyVisible:Ue})}}return V.sort((ne,de)=>ne.distanceSq-de.distanceSq).map(ne=>ne.tileID)}resize(l,d){this.width=l,this.height=d,this.pixelsToGLUnits=[2/l,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const d=o.ac(l.lat,-85.051129,bo);return new o.P(o.N(l.lng)*this.worldSize,o.O(d)*this.worldSize)}unproject(l){return new o.Y(l.x/this.worldSize,l.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(l){const d=this.elevation,y=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,_=this.pointLocation(this.centerPoint,l),E=l.getElevationForLngLatZoom(_,this.tileZoom);if(!(this.elevation-E))return;const P=y+d-E,R=Math.cos(this._pitch)*this.cameraToCenterDistance/P/o.b3(1,_.lat),g=this.scaleZoom(R/this.tileSize);this._elevation=E,this._center=_,this.zoom=g}setLocationAtPoint(l,d){const y=this.pointCoordinate(d),_=this.pointCoordinate(this.centerPoint),E=this.locationCoordinate(l),P=new o.Y(E.x-(y.x-_.x),E.y-(y.y-_.y));this.center=this.coordinateLocation(P),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(l,d){return d?this.coordinatePoint(this.locationCoordinate(l),d.getElevationForLngLatZoom(l,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(l))}pointLocation(l,d){return this.coordinateLocation(this.pointCoordinate(l,d))}locationCoordinate(l){return o.Y.fromLngLat(l)}coordinateLocation(l){return l&&l.toLngLat()}pointCoordinate(l,d){if(d){const D=d.pointCoordinate(l);if(D!=null)return D}const y=[l.x,l.y,0,1],_=[l.x,l.y,1,1];o.af(y,y,this.pixelMatrixInverse),o.af(_,_,this.pixelMatrixInverse);const E=y[3],P=_[3],R=y[1]/E,g=_[1]/P,w=y[2]/E,T=_[2]/P,L=w===T?0:(0-w)/(T-w);return new o.Y(o.z.number(y[0]/E,_[0]/P,L)/this.worldSize,o.z.number(R,g,L)/this.worldSize)}coordinatePoint(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.pixelMatrix;const _=[l.x*this.worldSize,l.y*this.worldSize,d,1];return o.af(_,_,y),new o.P(_[0]/_[3],_[1]/_[3])}getBounds(){const l=Math.max(0,this.height/2-this.getHorizon());return new zt().extend(this.pointLocation(new o.P(0,l))).extend(this.pointLocation(new o.P(this.width,l))).extend(this.pointLocation(new o.P(this.width,this.height))).extend(this.pointLocation(new o.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new zt([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,bo])}calculatePosMatrix(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=l.key,_=d?this._alignedPosMatrixCache:this._posMatrixCache;if(_[y])return _[y];const E=l.canonical,P=this.worldSize/this.zoomScale(E.z),R=E.x+Math.pow(2,E.z)*l.wrap,g=o.an(new Float64Array(16));return o.H(g,g,[R*P,E.y*P,0]),o.J(g,g,[P/o.W,P/o.W,1]),o.K(g,d?this.alignedProjMatrix:this.projMatrix,g),_[y]=new Float32Array(g),_[y]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(l,d){d=o.ac(+d,this.minZoom,this.maxZoom);const y={center:new o.M(l.lng,l.lat),zoom:d};let _=this.lngRange;if(!this._renderWorldCopies&&_===null){const ne=179.9999999999;_=[-ne,ne]}const E=this.tileSize*this.zoomScale(y.zoom);let P=0,R=E,g=0,w=E,T=0,L=0;const{x:D,y:H}=this.size;if(this.latRange){const ne=this.latRange;P=o.O(ne[1])*E,R=o.O(ne[0])*E,R-P<H&&(T=H/(R-P))}_&&(g=o.b1(o.N(_[0])*E,0,E),w=o.b1(o.N(_[1])*E,0,E),w<g&&(w+=E),w-g<D&&(L=D/(w-g)));const{x:z,y:j}=this.project.call({worldSize:E},l);let V,X;const ue=Math.max(L||0,T||0);if(ue){const ne=new o.P(L?(w+g)/2:z,T?(R+P)/2:j);return y.center=this.unproject.call({worldSize:E},ne).wrap(),y.zoom+=this.scaleZoom(ue),y}if(this.latRange){const ne=H/2;j-ne<P&&(X=P+ne),j+ne>R&&(X=R-ne)}if(_){const ne=(g+w)/2;let de=z;this._renderWorldCopies&&(de=o.b1(z,ne-E/2,ne+E/2));const me=D/2;de-me<g&&(V=g+me),de+me>w&&(V=w-me)}if(V!==void 0||X!==void 0){const ne=new o.P(V??z,X??j);y.center=this.unproject.call({worldSize:E},ne).wrap()}return y}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const l=this._unmodified,{center:d,zoom:y}=this.getConstrained(this.center,this.zoom);this.center=d,this.zoom=y,this._unmodified=l,this._constraining=!1}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,d=this.point.x,y=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=o.b3(1,this.center.lat)*this.worldSize;let _=o.an(new Float64Array(16));o.J(_,_,[this.width/2,-this.height/2,1]),o.H(_,_,[1,-1,0]),this.labelPlaneMatrix=_,_=o.an(new Float64Array(16)),o.J(_,_,[1,-1,1]),o.H(_,_,[-1,-1,0]),o.J(_,_,[2/this.width,2/this.height,1]),this.glCoordMatrix=_;const E=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),P=Math.min(this.elevation,this.minElevationForCurrentTile),R=E-P*this._pixelPerMeter/Math.cos(this._pitch),g=P<0?R:E,w=Math.PI/2+this._pitch,T=this._fov*(.5+l.y/this.height),L=Math.sin(T)*g/Math.sin(o.ac(Math.PI-w-T,.01,Math.PI-.01)),D=this.getHorizon(),H=2*Math.atan(D/this.cameraToCenterDistance)*(.5+l.y/(2*D)),z=Math.sin(H)*g/Math.sin(o.ac(Math.PI-w-H,.01,Math.PI-.01)),j=Math.min(L,z),V=1.01*(Math.cos(Math.PI/2-this._pitch)*j+g),X=this.height/50;_=new Float64Array(16),o.b4(_,this._fov,this.width/this.height,X,V),_[8]=2*-l.x/this.width,_[9]=2*l.y/this.height,o.J(_,_,[1,-1,1]),o.H(_,_,[0,0,-this.cameraToCenterDistance]),o.b5(_,_,this._pitch),o.ad(_,_,this.angle),o.H(_,_,[-d,-y,0]),this.mercatorMatrix=o.J([],_,[this.worldSize,this.worldSize,this.worldSize]),o.J(_,_,[1,1,this._pixelPerMeter]),this.pixelMatrix=o.K(new Float64Array(16),this.labelPlaneMatrix,_),o.H(_,_,[0,0,-this.elevation]),this.projMatrix=_,this.invProjMatrix=o.ar([],_),this.pixelMatrix3D=o.K(new Float64Array(16),this.labelPlaneMatrix,_);const ue=this.width%2/2,ne=this.height%2/2,de=Math.cos(this.angle),me=Math.sin(this.angle),Ue=d-Math.round(d)+de*ue+me*ne,Ie=y-Math.round(y)+de*ne+me*ue,ve=new Float64Array(_);if(o.H(ve,ve,[Ue>.5?Ue-1:Ue,Ie>.5?Ie-1:Ie,0]),this.alignedProjMatrix=ve,_=o.ar(new Float64Array(16),this.pixelMatrix),!_)throw new Error("failed to invert matrix");this.pixelMatrixInverse=_,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const l=this.pointCoordinate(new o.P(0,0)),d=[l.x*this.worldSize,l.y*this.worldSize,0,1];return o.af(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,l))}getCameraQueryGeometry(l){const d=this.getCameraPoint();if(l.length===1)return[l[0],d];{let y=d.x,_=d.y,E=d.x,P=d.y;for(const R of l)y=Math.min(y,R.x),_=Math.min(_,R.y),E=Math.max(E,R.x),P=Math.max(P,R.y);return[new o.P(y,_),new o.P(E,_),new o.P(E,P),new o.P(y,P),new o.P(y,_)]}}lngLatToCameraDepth(l,d){const y=this.locationCoordinate(l),_=[y.x*this.worldSize,y.y*this.worldSize,d,1];return o.af(_,_,this.projMatrix),_[2]/_[3]}}function Sc(C,l){var d=this;let y,_=!1,E=null,P=null;const R=()=>{E=null,_&&(C.apply(P,y),E=setTimeout(R,l),_=!1)};return function(){for(var g=arguments.length,w=new Array(g),T=0;T<g;T++)w[T]=arguments[T];return _=!0,P=d,y=w,E||R(),E}}class eo{constructor(l){this._getCurrentHash=()=>{const d=window.location.hash.replace("#","");if(this._hashName){let y;return d.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(y=_)}),(y&&y[1]||"").split("/")}return d.split("/")},this._onHashChange=()=>{const d=this._getCurrentHash();if(d.length>=3&&!d.some(y=>isNaN(y))){const y=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:y,pitch:+(d[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const d=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,d)}catch{}},this._updateHash=Sc(this._updateHashUnthrottled,300),this._hashName=l&&encodeURIComponent(l)}addTo(l){return this._map=l,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(l){const d=this._map.getCenter(),y=Math.round(100*this._map.getZoom())/100,_=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,_),P=Math.round(d.lng*E)/E,R=Math.round(d.lat*E)/E,g=this._map.getBearing(),w=this._map.getPitch();let T="";if(T+=l?`/${P}/${R}/${y}`:`${y}/${R}/${P}`,(g||w)&&(T+="/"+Math.round(10*g)/10),w&&(T+=`/${Math.round(w)}`),this._hashName){const L=this._hashName;let D=!1;const H=window.location.hash.slice(1).split("&").map(z=>{const j=z.split("=")[0];return j===L?(D=!0,`${j}=${T}`):z}).filter(z=>z);return D||H.push(`${L}=${T}`),`#${H.join("&")}`}return`#${T}`}}const va={linearity:.3,easing:o.b6(0,0,.3,1)},$o=o.e({deceleration:2500,maxSpeed:1400},va),ja=o.e({deceleration:20,maxSpeed:1400},va),xo=o.e({deceleration:1e3,maxSpeed:360},va),ba=o.e({deceleration:1e3,maxSpeed:90},va);class Tc{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:v.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,d=v.now();for(;l.length>0&&d-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)d.zoom+=E.zoomDelta||0,d.bearing+=E.bearingDelta||0,d.pitch+=E.pitchDelta||0,E.panDelta&&d.pan._add(E.panDelta),E.around&&(d.around=E.around),E.pinchAround&&(d.pinchAround=E.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(d.pan.mag()){const E=Xo(d.pan.mag(),y,o.e({},$o,l||{}));_.offset=d.pan.mult(E.amount/d.pan.mag()),_.center=this._map.transform.center,wa(_,E)}if(d.zoom){const E=Xo(d.zoom,y,ja);_.zoom=this._map.transform.zoom+E.amount,wa(_,E)}if(d.bearing){const E=Xo(d.bearing,y,xo);_.bearing=this._map.transform.bearing+o.ac(E.amount,-179,179),wa(_,E)}if(d.pitch){const E=Xo(d.pitch,y,ba);_.pitch=this._map.transform.pitch+E.amount,wa(_,E)}if(_.zoom||_.bearing){const E=d.pinchAround===void 0?d.around:d.pinchAround;_.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),o.e(_,{noMoveStart:!0})}}function wa(C,l){(!C.duration||C.duration<l.duration)&&(C.duration=l.duration,C.easing=l.easing)}function Xo(C,l,d){const{maxSpeed:y,linearity:_,deceleration:E}=d,P=o.ac(C*_/(l/1e3),-y,y),R=Math.abs(P)/(E*_);return{easing:d.easing,duration:1e3*R,amount:P*(R/2)}}class Ci extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,y){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const E=x.mousePos(d.getCanvas(),y),P=d.unproject(E);super(l,o.e({point:E,lngLat:P,originalEvent:y},_)),this._defaultPrevented=!1,this.target=d}}class Qs extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,y){const _=l==="touchend"?y.changedTouches:y.touches,E=x.touchPos(d.getCanvasContainer(),_),P=E.map(g=>d.unproject(g)),R=E.reduce((g,w,T,L)=>g.add(w.div(L.length)),new o.P(0,0));super(l,{points:E,point:R,lngLats:P,lngLat:d.unproject(R),originalEvent:y}),this._defaultPrevented=!1}}class Hs extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,y){super(l,{originalEvent:y}),this._defaultPrevented=!1}}class ki{constructor(l,d){this._map=l,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new Hs(l.type,this._map,l))}mousedown(l,d){return this._mousedownPos=d,this._firePreventable(new Ci(l.type,this._map,l))}mouseup(l){this._map.fire(new Ci(l.type,this._map,l))}click(l,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new Ci(l.type,this._map,l))}dblclick(l){return this._firePreventable(new Ci(l.type,this._map,l))}mouseover(l){this._map.fire(new Ci(l.type,this._map,l))}mouseout(l){this._map.fire(new Ci(l.type,this._map,l))}touchstart(l){return this._firePreventable(new Qs(l.type,this._map,l))}touchmove(l){this._map.fire(new Qs(l.type,this._map,l))}touchend(l){this._map.fire(new Qs(l.type,this._map,l))}touchcancel(l){this._map.fire(new Qs(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vn{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(l){this._map.fire(new Ci(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ci("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._ignoreContextMenu||this._map.fire(new Ci(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ln{constructor(l){this._map=l}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(l){return this.transform.pointLocation(o.P.convert(l),this._map.terrain)}}class Fn{constructor(l,d){this._map=l,this._tr=new Ln(l),this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,d){this.isEnabled()&&l.shiftKey&&l.button===0&&(x.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(l,d){if(!this._active)return;const y=d;if(this._lastPos.equals(y)||!this._box&&y.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=y,this._box||(this._box=x.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",l));const E=Math.min(_.x,y.x),P=Math.max(_.x,y.x),R=Math.min(_.y,y.y),g=Math.max(_.y,y.y);x.setTransform(this._box,`translate(${E}px,${R}px)`),this._box.style.width=P-E+"px",this._box.style.height=g-R+"px"}mouseupWindow(l,d){if(!this._active||l.button!==0)return;const y=this._startPos,_=d;if(this.reset(),x.suppressClick(),y.x!==_.x||y.y!==_.y)return this._map.fire(new o.k("boxzoomend",{originalEvent:l})),{cameraAnimation:E=>E.fitScreenCoordinates(y,_,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",l)}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(x.remove(this._box),this._box=null),x.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,d){return this._map.fire(new o.k(l,{originalEvent:d}))}}function ei(C,l){if(C.length!==l.length)throw new Error(`The number of touches and points are not equal - touches ${C.length}, points ${l.length}`);const d={};for(let y=0;y<C.length;y++)d[C[y].identifier]=l[y];return d}class qa{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,d,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),y.length===this.numTouches&&(this.centroid=function(_){const E=new o.P(0,0);for(const P of _)E._add(P);return E.div(_.length)}(d),this.touches=ei(y,d)))}touchmove(l,d,y){if(this.aborted||!this.centroid)return;const _=ei(y,d);for(const E in this.touches){const P=_[E];(!P||P.dist(this.touches[E])>30)&&(this.aborted=!0)}}touchend(l,d,y){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class xa{constructor(l){this.singleTap=new qa(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,d,y){this.singleTap.touchstart(l,d,y)}touchmove(l,d,y){this.singleTap.touchmove(l,d,y)}touchend(l,d,y){const _=this.singleTap.touchend(l,d,y);if(_){const E=l.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(_)<30;if(E&&P||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class Au{constructor(l){this._tr=new Ln(l),this._zoomIn=new xa({numTouches:1,numTaps:2}),this._zoomOut=new xa({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,d,y){this._zoomIn.touchstart(l,d,y),this._zoomOut.touchstart(l,d,y)}touchmove(l,d,y){this._zoomIn.touchmove(l,d,y),this._zoomOut.touchmove(l,d,y)}touchend(l,d,y){const _=this._zoomIn.touchend(l,d,y),E=this._zoomOut.touchend(l,d,y),P=this._tr;return _?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:P.zoom+1,around:P.unproject(_)},{originalEvent:l})}):E?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:P.zoom-1,around:P.unproject(E)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ka{constructor(l){this._enabled=!!l.enable,this._moveStateManager=l.moveStateManager,this._clickTolerance=l.clickTolerance||1,this._moveFunction=l.move,this._activateOnStart=!!l.activateOnStart,l.assignEvents(this),this.reset()}reset(l){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(l)}_move(){const l=this._moveFunction(...arguments);if(l.bearingDelta||l.pitchDelta||l.around||l.panDelta)return this._active=!0,l}dragStart(l,d){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(l)&&(this._moveStateManager.startMove(l),this._lastPoint=d.length?d[0]:d,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(l,d){if(!this.isEnabled())return;const y=this._lastPoint;if(!y)return;if(l.preventDefault(),!this._moveStateManager.isValidMoveEvent(l))return void this.reset(l);const _=d.length?d[0]:d;return!this._moved&&_.dist(y)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=_,this._move(y,_))}dragEnd(l){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(l)&&(this._moved&&x.suppressClick(),this.reset(l))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const hu={0:1,2:2};class Jo{constructor(l){this._correctEvent=l.checkCorrectEvent}startMove(l){const d=x.mouseButton(l);this._eventButton=d}endMove(l){delete this._eventButton}isValidStartEvent(l){return this._correctEvent(l)}isValidMoveEvent(l){return!function(d,y){const _=hu[y];return d.buttons===void 0||(d.buttons&_)!==_}(l,this._eventButton)}isValidEndEvent(l){return x.mouseButton(l)===this._eventButton}}class er{constructor(){this._firstTouch=void 0}_isOneFingerTouch(l){return l.targetTouches.length===1}_isSameTouchEvent(l){return l.targetTouches[0].identifier===this._firstTouch}startMove(l){this._firstTouch=l.targetTouches[0].identifier}endMove(l){delete this._firstTouch}isValidStartEvent(l){return this._isOneFingerTouch(l)}isValidMoveEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}isValidEndEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}}const tA=C=>{C.mousedown=C.dragStart,C.mousemoveWindow=C.dragMove,C.mouseup=C.dragEnd,C.contextmenu=function(l){l.preventDefault()}},yl=C=>{let{enable:l,clickTolerance:d,bearingDegreesPerPixelMoved:y=.8}=C;const _=new Jo({checkCorrectEvent:E=>x.mouseButton(E)===0&&E.ctrlKey||x.mouseButton(E)===2});return new Ka({clickTolerance:d,move:(E,P)=>({bearingDelta:(P.x-E.x)*y}),moveStateManager:_,enable:l,assignEvents:tA})},_l=C=>{let{enable:l,clickTolerance:d,pitchDegreesPerPixelMoved:y=-.5}=C;const _=new Jo({checkCorrectEvent:E=>x.mouseButton(E)===0&&E.ctrlKey||x.mouseButton(E)===2});return new Ka({clickTolerance:d,move:(E,P)=>({pitchDelta:(P.y-E.y)*y}),moveStateManager:_,enable:l,assignEvents:tA})};class rh{constructor(l,d){this._clickTolerance=l.clickTolerance||1,this._map=d,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(l,d,y){return this._calculateTransform(l,d,y)}touchmove(l,d,y){if(this._active&&!(y.length<this.minTouchs()))return l.preventDefault(),this._calculateTransform(l,d,y)}touchend(l,d,y){this._calculateTransform(l,d,y),this._active&&y.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,d,y){y.length>0&&(this._active=!0);const _=ei(y,d),E=new o.P(0,0),P=new o.P(0,0);let R=0;for(const w in _){const T=_[w],L=this._touches[w];L&&(E._add(T),P._add(T.sub(L)),R++,_[w]=T)}if(this._touches=_,R<this.minTouchs()||!P.mag())return;const g=P.div(R);return this._sum._add(g),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(R),panDelta:g}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qt{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(l,d,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([d[0],d[1]]))}touchmove(l,d,y){if(!this._firstTwoTouches)return;l.preventDefault();const[_,E]=this._firstTwoTouches,P=Wi(y,d,_),R=Wi(y,d,E);if(!P||!R)return;const g=this._aroundCenter?null:P.add(R).div(2);return this._move([P,R],g,l)}touchend(l,d,y){if(!this._firstTwoTouches)return;const[_,E]=this._firstTwoTouches,P=Wi(y,d,_),R=Wi(y,d,E);P&&R||(this._active&&x.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Wi(C,l,d){for(let y=0;y<C.length;y++)if(C[y].identifier===d)return l[y]}function to(C,l){return Math.log(C/l)/Math.LN2}class rA extends qt{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,d){const y=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(to(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:to(this._distance,y),pinchAround:d}}}function vl(C,l){return 180*C.angleWith(l)/Math.PI}class nh extends qt{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,d,y){const _=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:vl(this._vector,_),pinchAround:d}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const d=25/(Math.PI*this._minDiameter)*360,y=vl(l,this._startVector);return Math.abs(y)<d}}function bl(C){return Math.abs(C.y)>Math.abs(C.x)}class nA extends qt{constructor(l){super(),this._currentTouchCount=0,this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(l,d,y){super.touchstart(l,d,y),this._currentTouchCount=y.length}_start(l){this._lastPoints=l,bl(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,d,y){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const _=l[0].sub(this._lastPoints[0]),E=l[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,E,y.timeStamp),this._valid?(this._lastPoints=l,this._active=!0,{pitchDelta:(_.y+E.y)/2*-.5}):void 0}gestureBeginsVertically(l,d,y){if(this._valid!==void 0)return this._valid;const _=l.mag()>=2,E=d.mag()>=2;if(!_&&!E)return;if(!_||!E)return this._firstMove===void 0&&(this._firstMove=y),y-this._firstMove<100&&void 0;const P=l.y>0==d.y>0;return bl(l)&&bl(d)&&P}}const fd={panStep:100,bearingStep:15,pitchStep:10};class Wa{constructor(l){this._tr=new Ln(l);const d=fd;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let d=0,y=0,_=0,E=0,P=0;switch(l.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:l.shiftKey?y=-1:(l.preventDefault(),E=-1);break;case 39:l.shiftKey?y=1:(l.preventDefault(),E=1);break;case 38:l.shiftKey?_=1:(l.preventDefault(),P=-1);break;case 40:l.shiftKey?_=-1:(l.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(y=0,_=0),{cameraAnimation:R=>{const g=this._tr;R.easeTo({duration:300,easeId:"keyboardHandler",easing:zn,zoom:d?Math.round(g.zoom)+d*(l.shiftKey?2:1):g.zoom,bearing:g.bearing+y*this._bearingStep,pitch:g.pitch+_*this._pitchStep,offset:[-E*this._panStep,-P*this._panStep],center:g.center},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function zn(C){return C*(2-C)}const wl=4.000244140625;class xl{constructor(l,d){this._onTimeout=y=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(y)},this._map=l,this._tr=new Ln(l),this._triggerRenderFrame=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(l){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!l[this._map.cooperativeGestures._bypassKey])return;let d=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const y=v.now(),_=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,d!==0&&d%wl==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(_*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),l.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=l,this._delta-=d,this._active||this._start(l)),l.preventDefault()}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=x.mousePos(this._map.getCanvas(),l),y=this._tr;this._around=d.y>y.transform.height/2-y.transform.getHorizon()?o.M.convert(this._aroundCenter?y.center:y.unproject(d)):o.M.convert(y.center),this._aroundPoint=y.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._tr.transform;if(this._delta!==0){const R=this._type==="wheel"&&Math.abs(this._delta)>wl?this._wheelZoomRate:this._defaultZoomRate;let g=2/(1+Math.exp(-Math.abs(this._delta*R)));this._delta<0&&g!==0&&(g=1/g);const w=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):l.scale;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(w*g))),this._type==="wheel"&&(this._startZoom=l.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const d=typeof this._targetZoom=="number"?this._targetZoom:l.zoom,y=this._startZoom,_=this._easing;let E,P=!1;if(this._type==="wheel"&&y&&_){const R=Math.min((v.now()-this._lastWheelEventTime)/200,1),g=_(R);E=o.z.number(y,d,g),R<1?this._frameId||(this._frameId=!0):P=!0}else E=d,P=!0;return this._active=!0,P&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!P,zoomDelta:E-l.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let d=o.b7;if(this._prevEase){const y=this._prevEase,_=(v.now()-y.start)/y.duration,E=y.easing(_+.01)-y.easing(_),P=.27/Math.sqrt(E*E+1e-4)*.01,R=Math.sqrt(.0729-P*P);d=o.b6(P,R,.25,1)}return this._prevEase={start:v.now(),duration:l,easing:d},d}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class iA{constructor(l,d){this._clickZoom=l,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class sp{constructor(l){this._tr=new Ln(l),this.reset()}reset(){this._active=!1}dblclick(l,d){return l.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:this._tr.zoom+(l.shiftKey?-1:1),around:this._tr.unproject(d)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class op{constructor(){this._tap=new xa({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(l,d,y){if(!this._swipePoint)if(this._tapTime){const _=d[0],E=l.timeStamp-this._tapTime<500,P=this._tapPoint.dist(_)<30;E&&P?y.length>0&&(this._swipePoint=_,this._swipeTouch=y[0].identifier):this.reset()}else this._tap.touchstart(l,d,y)}touchmove(l,d,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const _=d[0],E=_.y-this._swipePoint.y;return this._swipePoint=_,l.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(l,d,y)}touchend(l,d,y){if(this._tapTime)this._swipePoint&&y.length===0&&this.reset();else{const _=this._tap.touchend(l,d,y);_&&(this._tapTime=l.timeStamp,this._tapPoint=_)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pd{constructor(l,d,y){this._el=l,this._mousePan=d,this._touchPan=y}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Yo{constructor(l,d,y){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=d,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class sA{constructor(l,d,y,_){this._el=l,this._touchZoom=d,this._touchRotate=y,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class dr{constructor(l,d){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=l,this._options=d,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const l=this._map.getCanvasContainer();l.classList.add("maplibregl-cooperative-gestures"),this._container=x.create("div","maplibregl-cooperative-gesture-screen",l);let d=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(d=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const y=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),_=document.createElement("div");_.className="maplibregl-desktop-message",_.textContent=d,this._container.appendChild(_);const E=document.createElement("div");E.className="maplibregl-mobile-message",E.textContent=y,this._container.appendChild(E),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(x.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(l){this._onCooperativeGesture(l.touches.length===1)}wheel(l){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!l[this._bypassKey])}_onCooperativeGesture(l){this._enabled&&l&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const wr=C=>C.zoom||C.drag||C.pitch||C.rotate;class ih extends o.k{}function Bl(C){return C.panDelta&&C.panDelta.mag()||C.zoomDelta||C.bearingDelta||C.pitchDelta}class oA{constructor(l,d){this.handleWindowEvent=_=>{this.handleEvent(_,`${_.type}Window`)},this.handleEvent=(_,E)=>{if(_.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const P=_.type==="renderFrame"?void 0:_,R={needsRenderFrame:!1},g={},w={},T=_.touches,L=T?this._getMapTouches(T):void 0,D=L?x.touchPos(this._map.getCanvas(),L):x.mousePos(this._map.getCanvas(),_);for(const{handlerName:j,handler:V,allowed:X}of this._handlers){if(!V.isEnabled())continue;let ue;this._blockedByActive(w,X,j)?V.reset():V[E||_.type]&&(ue=V[E||_.type](_,D,L),this.mergeHandlerResult(R,g,ue,j,P),ue&&ue.needsRenderFrame&&this._triggerRenderFrame()),(ue||V.isActive())&&(w[j]=V)}const H={};for(const j in this._previousActiveHandlers)w[j]||(H[j]=P);this._previousActiveHandlers=w,(Object.keys(H).length||Bl(R))&&(this._changes.push([R,g,H]),this._triggerRenderFrame()),(Object.keys(w).length||Bl(R))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:z}=R;z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],z(this._map))},this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Tc(l),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,E,P]of this._listeners)x.addEventListener(_,E,_===document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[l,d,y]of this._listeners)x.removeEventListener(l,d,l===document?this.handleWindowEvent:this.handleEvent,y)}_addDefaultHandlers(l){const d=this._map,y=d.getCanvasContainer();this._add("mapEvent",new ki(d,l));const _=d.boxZoom=new Fn(d,l);this._add("boxZoom",_),l.interactive&&l.boxZoom&&_.enable();const E=d.cooperativeGestures=new dr(d,l.cooperativeGestures);this._add("cooperativeGestures",E),l.cooperativeGestures&&E.enable();const P=new Au(d),R=new sp(d);d.doubleClickZoom=new iA(R,P),this._add("tapZoom",P),this._add("clickZoom",R),l.interactive&&l.doubleClickZoom&&d.doubleClickZoom.enable();const g=new op;this._add("tapDragZoom",g);const w=d.touchPitch=new nA(d);this._add("touchPitch",w),l.interactive&&l.touchPitch&&d.touchPitch.enable(l.touchPitch);const T=yl(l),L=_l(l);d.dragRotate=new Yo(l,T,L),this._add("mouseRotate",T,["mousePitch"]),this._add("mousePitch",L,["mouseRotate"]),l.interactive&&l.dragRotate&&d.dragRotate.enable();const D=(ue=>{let{enable:ne,clickTolerance:de}=ue;const me=new Jo({checkCorrectEvent:Ue=>x.mouseButton(Ue)===0&&!Ue.ctrlKey});return new Ka({clickTolerance:de,move:(Ue,Ie)=>({around:Ie,panDelta:Ie.sub(Ue)}),activateOnStart:!0,moveStateManager:me,enable:ne,assignEvents:tA})})(l),H=new rh(l,d);d.dragPan=new pd(y,D,H),this._add("mousePan",D),this._add("touchPan",H,["touchZoom","touchRotate"]),l.interactive&&l.dragPan&&d.dragPan.enable(l.dragPan);const z=new nh,j=new rA;d.touchZoomRotate=new sA(y,j,z,g),this._add("touchRotate",z,["touchPan","touchZoom"]),this._add("touchZoom",j,["touchPan","touchRotate"]),l.interactive&&l.touchZoomRotate&&d.touchZoomRotate.enable(l.touchZoomRotate);const V=d.scrollZoom=new xl(d,()=>this._triggerRenderFrame());this._add("scrollZoom",V,["mousePan"]),l.interactive&&l.scrollZoom&&d.scrollZoom.enable(l.scrollZoom);const X=d.keyboard=new Wa(d);this._add("keyboard",X),l.interactive&&l.keyboard&&d.keyboard.enable(),this._add("blockableMapEvent",new vn(d))}_add(l,d,y){this._handlers.push({handlerName:l,handler:d,allowed:y}),this._handlersById[l]=d}stop(l){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!wr(this._eventsInProgress)||this.isZooming()}_blockedByActive(l,d,y){for(const _ in l)if(_!==y&&(!d||d.indexOf(_)<0))return!0;return!1}_getMapTouches(l){const d=[];for(const y of l)this._el.contains(y.target)&&d.push(y);return d}mergeHandlerResult(l,d,y,_,E){if(!y)return;o.e(l,y);const P={handlerName:_,originalEvent:y.originalEvent||E};y.zoomDelta!==void 0&&(d.zoom=P),y.panDelta!==void 0&&(d.drag=P),y.pitchDelta!==void 0&&(d.pitch=P),y.bearingDelta!==void 0&&(d.rotate=P)}_applyChanges(){const l={},d={},y={};for(const[_,E,P]of this._changes)_.panDelta&&(l.panDelta=(l.panDelta||new o.P(0,0))._add(_.panDelta)),_.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(l.around=_.around),_.pinchAround!==void 0&&(l.pinchAround=_.pinchAround),_.noInertia&&(l.noInertia=_.noInertia),o.e(d,E),o.e(y,P);this._updateMapTransform(l,d,y),this._changes=[]}_updateMapTransform(l,d,y){const _=this._map,E=_._getTransformForUpdate(),P=_.terrain;if(!(Bl(l)||P&&this._terrainMovement))return this._fireEvents(d,y,!0);let{panDelta:R,zoomDelta:g,bearingDelta:w,pitchDelta:T,around:L,pinchAround:D}=l;D!==void 0&&(L=D),_._stop(!0),L=L||_.transform.centerPoint;const H=E.pointLocation(R?L.sub(R):L);w&&(E.bearing+=w),T&&(E.pitch+=T),g&&(E.zoom+=g),P?this._terrainMovement||!d.drag&&!d.zoom?d.drag&&this._terrainMovement?E.center=E.pointLocation(E.centerPoint.sub(R)):E.setLocationAtPoint(H,L):(this._terrainMovement=!0,this._map._elevationFreeze=!0,E.setLocationAtPoint(H,L),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,E.recalculateZoom(_.terrain)})):E.setLocationAtPoint(H,L),_._applyUpdatedTransform(E),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(d,y,!0)}_fireEvents(l,d,y){const _=wr(this._eventsInProgress),E=wr(l),P={};for(const T in l){const{originalEvent:L}=l[T];this._eventsInProgress[T]||(P[`${T}start`]=L),this._eventsInProgress[T]=l[T]}!_&&E&&this._fireEvent("movestart",E.originalEvent);for(const T in P)this._fireEvent(T,P[T]);E&&this._fireEvent("move",E.originalEvent);for(const T in l){const{originalEvent:L}=l[T];this._fireEvent(T,L)}const R={};let g;for(const T in this._eventsInProgress){const{handlerName:L,originalEvent:D}=this._eventsInProgress[T];this._handlersById[L].isActive()||(delete this._eventsInProgress[T],g=d[L]||D,R[`${T}end`]=g)}for(const T in R)this._fireEvent(T,R[T]);const w=wr(this._eventsInProgress);if(y&&(_||E)&&!w){this._updatingCamera=!0;const T=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),L=D=>D!==0&&-this._bearingSnap<D&&D<this._bearingSnap;!T||!T.essential&&v.prefersReducedMotion?(this._map.fire(new o.k("moveend",{originalEvent:g})),L(this._map.getBearing())&&this._map.resetNorth()):(L(T.bearing||this._map.getBearing())&&(T.bearing=0),T.freezeElevation=!0,this._map.easeTo(T,{originalEvent:g})),this._updatingCamera=!1}}_fireEvent(l,d){this._map.fire(new o.k(l,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{delete this._frameId,this.handleEvent(new ih("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class $i extends o.E{constructor(l,d){super(),this._renderFrameCallback=()=>{const y=Math.min((v.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(y)),y<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=d.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new o.M(this.transform.center.lng,this.transform.center.lat)}setCenter(l,d){return this.jumpTo({center:l},d)}panBy(l,d,y){return l=o.P.convert(l).mult(-1),this.panTo(this.transform.center,o.e({offset:l},d),y)}panTo(l,d,y){return this.easeTo(o.e({center:l},d),y)}getZoom(){return this.transform.zoom}setZoom(l,d){return this.jumpTo({zoom:l},d),this}zoomTo(l,d,y){return this.easeTo(o.e({zoom:l},d),y)}zoomIn(l,d){return this.zoomTo(this.getZoom()+1,l,d),this}zoomOut(l,d){return this.zoomTo(this.getZoom()-1,l,d),this}getBearing(){return this.transform.bearing}setBearing(l,d){return this.jumpTo({bearing:l},d),this}getPadding(){return this.transform.padding}setPadding(l,d){return this.jumpTo({padding:l},d),this}rotateTo(l,d,y){return this.easeTo(o.e({bearing:l},d),y)}resetNorth(l,d){return this.rotateTo(0,o.e({duration:1e3},l),d),this}resetNorthPitch(l,d){return this.easeTo(o.e({bearing:0,pitch:0,duration:1e3},l),d),this}snapToNorth(l,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,d):this}getPitch(){return this.transform.pitch}setPitch(l,d){return this.jumpTo({pitch:l},d),this}cameraForBounds(l,d){l=zt.convert(l);const y=d&&d.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),y,d)}_cameraForBoxAndBearing(l,d,y,_){const E={top:0,bottom:0,right:0,left:0};if(typeof(_=o.e({padding:E,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){const Xe=_.padding;_.padding={top:Xe,bottom:Xe,right:Xe,left:Xe}}_.padding=o.e(E,_.padding);const P=this.transform,R=P.padding,g=new zt(l,d),w=P.project(g.getNorthWest()),T=P.project(g.getNorthEast()),L=P.project(g.getSouthEast()),D=P.project(g.getSouthWest()),H=o.b8(-y),z=w.rotate(H),j=T.rotate(H),V=L.rotate(H),X=D.rotate(H),ue=new o.P(Math.max(z.x,j.x,X.x,V.x),Math.max(z.y,j.y,X.y,V.y)),ne=new o.P(Math.min(z.x,j.x,X.x,V.x),Math.min(z.y,j.y,X.y,V.y)),de=ue.sub(ne),me=(P.width-(R.left+R.right+_.padding.left+_.padding.right))/de.x,Ue=(P.height-(R.top+R.bottom+_.padding.top+_.padding.bottom))/de.y;if(Ue<0||me<0)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Ie=Math.min(P.scaleZoom(P.scale*Math.min(me,Ue)),_.maxZoom),ve=o.P.convert(_.offset),we=new o.P((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(o.b8(y)),Ve=ve.add(we).mult(P.scale/P.zoomScale(Ie));return{center:P.unproject(w.add(L).div(2).sub(Ve)),zoom:Ie,bearing:y}}fitBounds(l,d,y){return this._fitInternal(this.cameraForBounds(l,d),d,y)}fitScreenCoordinates(l,d,y,_,E){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.P.convert(l)),this.transform.pointLocation(o.P.convert(d)),y,_),_,E)}_fitInternal(l,d,y){return l?(delete(d=o.e(l,d)).padding,d.linear?this.easeTo(d,y):this.flyTo(d,y)):this}jumpTo(l,d){this.stop();const y=this._getTransformForUpdate();let _=!1,E=!1,P=!1;return"zoom"in l&&y.zoom!==+l.zoom&&(_=!0,y.zoom=+l.zoom),l.center!==void 0&&(y.center=o.M.convert(l.center)),"bearing"in l&&y.bearing!==+l.bearing&&(E=!0,y.bearing=+l.bearing),"pitch"in l&&y.pitch!==+l.pitch&&(P=!0,y.pitch=+l.pitch),l.padding==null||y.isPaddingEqual(l.padding)||(y.padding=l.padding),this._applyUpdatedTransform(y),this.fire(new o.k("movestart",d)).fire(new o.k("move",d)),_&&this.fire(new o.k("zoomstart",d)).fire(new o.k("zoom",d)).fire(new o.k("zoomend",d)),E&&this.fire(new o.k("rotatestart",d)).fire(new o.k("rotate",d)).fire(new o.k("rotateend",d)),P&&this.fire(new o.k("pitchstart",d)).fire(new o.k("pitch",d)).fire(new o.k("pitchend",d)),this.fire(new o.k("moveend",d))}calculateCameraOptionsFromTo(l,d,y){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const E=o.Y.fromLngLat(l,d),P=o.Y.fromLngLat(y,_),R=P.x-E.x,g=P.y-E.y,w=P.z-E.z,T=Math.hypot(R,g,w);if(T===0)throw new Error("Can't calculate camera options with same From and To");const L=Math.hypot(R,g),D=this.transform.scaleZoom(this.transform.cameraToCenterDistance/T/this.transform.tileSize),H=180*Math.atan2(R,-g)/Math.PI;let z=180*Math.acos(L/T)/Math.PI;return z=w<0?90-z:90+z,{center:P.toLngLat(),zoom:D,pitch:z,bearing:H}}easeTo(l,d){var y;this._stop(!1,l.easeId),((l=o.e({offset:[0,0],duration:500,easing:o.b7},l)).animate===!1||!l.essential&&v.prefersReducedMotion)&&(l.duration=0);const _=this._getTransformForUpdate(),E=this.getZoom(),P=this.getBearing(),R=this.getPitch(),g=this.getPadding(),w="bearing"in l?this._normalizeBearing(l.bearing,P):P,T="pitch"in l?+l.pitch:R,L="padding"in l?l.padding:_.padding,D=o.P.convert(l.offset);let H=_.centerPoint.add(D);const z=_.pointLocation(H),{center:j,zoom:V}=_.getConstrained(o.M.convert(l.center||z),(y=l.zoom)!==null&&y!==void 0?y:E);this._normalizeCenter(j);const X=_.project(z),ue=_.project(j).sub(X),ne=_.zoomScale(V-E);let de,me;l.around&&(de=o.M.convert(l.around),me=_.locationPoint(de));const Ue={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||V!==E,this._rotating=this._rotating||P!==w,this._pitching=this._pitching||T!==R,this._padding=!_.isPaddingEqual(L),this._easeId=l.easeId,this._prepareEase(d,l.noMoveStart,Ue),this.terrain&&this._prepareElevation(j),this._ease(Ie=>{if(this._zooming&&(_.zoom=o.z.number(E,V,Ie)),this._rotating&&(_.bearing=o.z.number(P,w,Ie)),this._pitching&&(_.pitch=o.z.number(R,T,Ie)),this._padding&&(_.interpolatePadding(g,L,Ie),H=_.centerPoint.add(D)),this.terrain&&!l.freezeElevation&&this._updateElevation(Ie),de)_.setLocationAtPoint(de,me);else{const ve=_.zoomScale(_.zoom-E),we=V>E?Math.min(2,ne):Math.max(.5,ne),Ve=Math.pow(we,1-Ie),Xe=_.unproject(X.add(ue.mult(Ie*Ve)).mult(ve));_.setLocationAtPoint(_.renderWorldCopies?Xe.wrap():Xe,H)}this._applyUpdatedTransform(_),this._fireMoveEvents(d)},Ie=>{this.terrain&&this._finalizeElevation(),this._afterEase(d,Ie)},l),this}_prepareEase(l,d){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this._moving=!0,d||y.moving||this.fire(new o.k("movestart",l)),this._zooming&&!y.zooming&&this.fire(new o.k("zoomstart",l)),this._rotating&&!y.rotating&&this.fire(new o.k("rotatestart",l)),this._pitching&&!y.pitching&&this.fire(new o.k("pitchstart",l))}_prepareElevation(l){this._elevationCenter=l,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(l){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const d=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(l<1&&d!==this._elevationTarget){const y=this._elevationTarget-this._elevationStart;this._elevationStart+=l*(y-(d-(y*l+this._elevationStart))/(1-l)),this._elevationTarget=d}this.transform.elevation=o.z.number(this._elevationStart,this._elevationTarget,l)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(l){if(!this.transformCameraUpdate)return;const d=l.clone(),{center:y,zoom:_,pitch:E,bearing:P,elevation:R}=this.transformCameraUpdate(d);y&&(d.center=y),_!==void 0&&(d.zoom=_),E!==void 0&&(d.pitch=E),P!==void 0&&(d.bearing=P),R!==void 0&&(d.elevation=R),this.transform.apply(d)}_fireMoveEvents(l){this.fire(new o.k("move",l)),this._zooming&&this.fire(new o.k("zoom",l)),this._rotating&&this.fire(new o.k("rotate",l)),this._pitching&&this.fire(new o.k("pitch",l))}_afterEase(l,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId;const y=this._zooming,_=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new o.k("zoomend",l)),_&&this.fire(new o.k("rotateend",l)),E&&this.fire(new o.k("pitchend",l)),this.fire(new o.k("moveend",l))}flyTo(l,d){var y;if(!l.essential&&v.prefersReducedMotion){const Et=o.L(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Et,d)}this.stop(),l=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.b7},l);const _=this._getTransformForUpdate(),E=this.getZoom(),P=this.getBearing(),R=this.getPitch(),g=this.getPadding(),w="bearing"in l?this._normalizeBearing(l.bearing,P):P,T="pitch"in l?+l.pitch:R,L="padding"in l?l.padding:_.padding,D=o.P.convert(l.offset);let H=_.centerPoint.add(D);const z=_.pointLocation(H),{center:j,zoom:V}=_.getConstrained(o.M.convert(l.center||z),(y=l.zoom)!==null&&y!==void 0?y:E);this._normalizeCenter(j);const X=_.zoomScale(V-E),ue=_.project(z),ne=_.project(j).sub(ue);let de=l.curve;const me=Math.max(_.width,_.height),Ue=me/X,Ie=ne.mag();if("minZoom"in l){const Et=o.ac(Math.min(l.minZoom,E,V),_.minZoom,_.maxZoom),$t=me/_.zoomScale(Et-E);de=Math.sqrt($t/Ie*2)}const ve=de*de;function we(Et){const $t=(Ue*Ue-me*me+(Et?-1:1)*ve*ve*Ie*Ie)/(2*(Et?Ue:me)*ve*Ie);return Math.log(Math.sqrt($t*$t+1)-$t)}function Ve(Et){return(Math.exp(Et)-Math.exp(-Et))/2}function Xe(Et){return(Math.exp(Et)+Math.exp(-Et))/2}const At=we(!1);let ht=function(Et){return Xe(At)/Xe(At+de*Et)},_t=function(Et){return me*((Xe(At)*(Ve($t=At+de*Et)/Xe($t))-Ve(At))/ve)/Ie;var $t},Ot=(we(!0)-At)/de;if(Math.abs(Ie)<1e-6||!isFinite(Ot)){if(Math.abs(me-Ue)<1e-6)return this.easeTo(l,d);const Et=Ue<me?-1:1;Ot=Math.abs(Math.log(Ue/me))/de,_t=function(){return 0},ht=function($t){return Math.exp(Et*de*$t)}}return l.duration="duration"in l?+l.duration:1e3*Ot/("screenSpeed"in l?+l.screenSpeed/de:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=P!==w,this._pitching=T!==R,this._padding=!_.isPaddingEqual(L),this._prepareEase(d,!1),this.terrain&&this._prepareElevation(j),this._ease(Et=>{const $t=Et*Ot,nr=1/ht($t);_.zoom=Et===1?V:E+_.scaleZoom(nr),this._rotating&&(_.bearing=o.z.number(P,w,Et)),this._pitching&&(_.pitch=o.z.number(R,T,Et)),this._padding&&(_.interpolatePadding(g,L,Et),H=_.centerPoint.add(D)),this.terrain&&!l.freezeElevation&&this._updateElevation(Et);const rr=Et===1?j:_.unproject(ue.add(ne.mult(_t($t))).mult(nr));_.setLocationAtPoint(_.renderWorldCopies?rr.wrap():rr,H),this._applyUpdatedTransform(_),this._fireMoveEvents(d)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(d)},l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,d)}if(!l){const y=this.handlers;y&&y.stop(!1)}return this}_ease(l,d,y){y.animate===!1||y.duration===0?(l(1),d()):(this._easeStart=v.now(),this._easeOptions=y,this._onEaseFrame=l,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(l,d){l=o.b1(l,-180,180);const y=Math.abs(l-d);return Math.abs(l-360-d)<y&&(l-=360),Math.abs(l+360-d)<y&&(l+=360),l}_normalizeCenter(l){const d=this.transform;if(!d.renderWorldCopies||d.lngRange)return;const y=l.lng-d.center.lng;l.lng+=y>180?-360:y<-180?360:0}queryTerrainElevation(l){return this.terrain?this.terrain.getElevationForLngLatZoom(o.M.convert(l),this.transform.tileZoom)-this.transform.elevation:null}}const gd={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Zo{constructor(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gd;this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=d=>{!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"&&d.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=l}getDefaultPosition(){return"bottom-right"}onAdd(l){return this._map=l,this._compact=this.options.compact,this._container=x.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=x.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=x.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){x.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(l,d){const y=this._map._getUIString(`AttributionControl.${d}`);l.title=y,l.setAttribute("aria-label",y)}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(_=>typeof _!="string"?"":_)):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const d=this._map.style.sourceCaches;for(const _ in d){const E=d[_];if(E.used||E.usedForTerrain){const P=E.getSource();P.attribution&&l.indexOf(P.attribution)<0&&l.push(P.attribution)}}l=l.filter(_=>String(_).trim()),l.sort((_,E)=>_.length-E.length),l=l.filter((_,E)=>{for(let P=E+1;P<l.length;P++)if(l[P].indexOf(_)>=0)return!1;return!0});const y=l.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,l.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class md{constructor(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._updateCompact=()=>{const d=this._container.children;if(d.length){const y=d[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&y.classList.add("maplibregl-compact"):y.classList.remove("maplibregl-compact")}},this.options=l}getDefaultPosition(){return"bottom-left"}onAdd(l){this._map=l,this._compact=this.options&&this.options.compact,this._container=x.create("div","maplibregl-ctrl");const d=x.create("a","maplibregl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){x.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class aA{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const d=++this._id;return this._queue.push({callback:l,id:d,cancelled:!1}),d}remove(l){const d=this._currentlyRunning,y=d?this._queue.concat(d):this._queue;for(const _ of y)if(_.id===l)return void(_.cancelled=!0)}run(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const d=this._currentlyRunning=this._queue;this._queue=[];for(const y of d)if(!y.cancelled&&(y.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var hi=o.X([{name:"a_pos3d",type:"Int16",components:3}]);class Ei extends o.E{constructor(l){super(),this.sourceCache=l,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,l.usedForTerrain=!0,l.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(l,d){this.sourceCache.update(l,d),this._renderableTilesKeys=[];const y={};for(const _ of l.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:d}))y[_.key]=!0,this._renderableTilesKeys.push(_.key),this._tiles[_.key]||(_.posMatrix=new Float64Array(16),o.aN(_.posMatrix,0,o.W,0,o.W,0,1),this._tiles[_.key]=new Ir(_,this.tileSize));for(const _ in this._tiles)y[_]||delete this._tiles[_]}freeRtt(l){for(const d in this._tiles){const y=this._tiles[d];(!l||y.tileID.equals(l)||y.tileID.isChildOf(l)||l.isChildOf(y.tileID))&&(y.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(l=>this.getTileByID(l))}getTileByID(l){return this._tiles[l]}getTerrainCoords(l){const d={};for(const y of this._renderableTilesKeys){const _=this._tiles[y].tileID;if(_.canonical.equals(l.canonical)){const E=l.clone();E.posMatrix=new Float64Array(16),o.aN(E.posMatrix,0,o.W,0,o.W,0,1),d[y]=E}else if(_.canonical.isChildOf(l.canonical)){const E=l.clone();E.posMatrix=new Float64Array(16);const P=_.canonical.z-l.canonical.z,R=_.canonical.x-(_.canonical.x>>P<<P),g=_.canonical.y-(_.canonical.y>>P<<P),w=o.W>>P;o.aN(E.posMatrix,0,w,0,w,0,1),o.H(E.posMatrix,E.posMatrix,[-R*w,-g*w,0]),d[y]=E}else if(l.canonical.isChildOf(_.canonical)){const E=l.clone();E.posMatrix=new Float64Array(16);const P=l.canonical.z-_.canonical.z,R=l.canonical.x-(l.canonical.x>>P<<P),g=l.canonical.y-(l.canonical.y>>P<<P),w=o.W>>P;o.aN(E.posMatrix,0,o.W,0,o.W,0,1),o.H(E.posMatrix,E.posMatrix,[R*w,g*w,0]),o.J(E.posMatrix,E.posMatrix,[1/2**P,1/2**P,0]),d[y]=E}}return d}getSourceTile(l,d){const y=this.sourceCache._source;let _=l.overscaledZ-this.deltaZoom;if(_>y.maxzoom&&(_=y.maxzoom),_<y.minzoom)return null;this._sourceTileCache[l.key]||(this._sourceTileCache[l.key]=l.scaledTo(_).key);let E=this.sourceCache.getTileByID(this._sourceTileCache[l.key]);if((!E||!E.dem)&&d)for(;_>=y.minzoom&&(!E||!E.dem);)E=this.sourceCache.getTileByID(l.scaledTo(_--).key);return E}tilesAfterTime(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Date.now();return Object.values(this._tiles).filter(d=>d.timeAdded>=l)}}class ap{constructor(l,d,y){this.painter=l,this.sourceCache=new Ei(d),this.options=y,this.exaggeration=typeof y.exaggeration=="number"?y.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(l,d,y){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:o.W;var E;if(!(d>=0&&d<_&&y>=0&&y<_))return 0;const P=this.getTerrainData(l),R=(E=P.tile)===null||E===void 0?void 0:E.dem;if(!R)return 0;const g=function(z,j,V){var X=j[0],ue=j[1];return z[0]=V[0]*X+V[4]*ue+V[12],z[1]=V[1]*X+V[5]*ue+V[13],z}([],[d/_*o.W,y/_*o.W],P.u_terrain_matrix),w=[g[0]*R.dim,g[1]*R.dim],T=Math.floor(w[0]),L=Math.floor(w[1]),D=w[0]-T,H=w[1]-L;return R.get(T,L)*(1-D)*(1-H)+R.get(T+1,L)*D*(1-H)+R.get(T,L+1)*(1-D)*H+R.get(T+1,L+1)*D*H}getElevationForLngLatZoom(l,d){const{tileID:y,mercatorX:_,mercatorY:E}=this._getOverscaledTileIDFromLngLatZoom(l,d);return this.getElevation(y,_%o.W,E%o.W,o.W)}getElevation(l,d,y){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:o.W;return this.getDEMElevation(l,d,y,_)*this.exaggeration}getTerrainData(l){if(!this._emptyDemTexture){const _=this.painter.context,E=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new oe(_,E,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new oe(_,new o.R({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.an([])}const d=this.sourceCache.getSourceTile(l,!0);if(d&&d.dem&&(!d.demTexture||d.needsTerrainPrepare)){const _=this.painter.context;d.demTexture=this.painter.getTileTexture(d.dem.stride),d.demTexture?d.demTexture.update(d.dem.getPixels(),{premultiply:!1}):d.demTexture=new oe(_,d.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),d.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),d.needsTerrainPrepare=!1}const y=d&&d+d.tileID.key+l.key;if(y&&!this._demMatrixCache[y]){const _=this.sourceCache.sourceCache._source.maxzoom;let E=l.canonical.z-d.tileID.canonical.z;l.overscaledZ>l.canonical.z&&(l.canonical.z>=_?E=l.canonical.z-_:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const P=l.canonical.x-(l.canonical.x>>E<<E),R=l.canonical.y-(l.canonical.y>>E<<E),g=o.b9(new Float64Array(16),[1/(o.W<<E),1/(o.W<<E),0]);o.H(g,g,[P*o.W,R*o.W,0]),this._demMatrixCache[l.key]={matrix:g,coord:l}}return{u_depth:2,u_terrain:3,u_terrain_dim:d&&d.dem&&d.dem.dim||1,u_terrain_matrix:y?this._demMatrixCache[l.key].matrix:this._emptyDemMatrix,u_terrain_unpack:d&&d.dem&&d.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(d&&d.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:d}}getFramebuffer(l){const d=this.painter,y=d.width/devicePixelRatio,_=d.height/devicePixelRatio;return!this._fbo||this._fbo.width===y&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new oe(d.context,{width:y,height:_,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new oe(d.context,{width:y,height:_,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=d.context.createFramebuffer(y,_,!0,!1),this._fbo.depthAttachment.set(d.context.createRenderbuffer(d.context.gl.DEPTH_COMPONENT16,y,_))),this._fbo.colorAttachment.set(l==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const l=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const d=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let E=0,P=0;E<this._coordsTextureSize;E++)for(let R=0;R<this._coordsTextureSize;R++,P+=4)d[P+0]=255&R,d[P+1]=255&E,d[P+2]=R>>8<<4|E>>8,d[P+3]=0;const y=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(d.buffer)),_=new oe(l,y,l.gl.RGBA,{premultiply:!1});return _.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(l){this.painter.maybeDrawDepthAndCoords(!0);const d=new Uint8Array(4),y=this.painter.context,_=y.gl,E=Math.round(l.x*this.painter.pixelRatio/devicePixelRatio),P=Math.round(l.y*this.painter.pixelRatio/devicePixelRatio),R=Math.round(this.painter.height/devicePixelRatio);y.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),_.readPixels(E,R-P-1,1,1,_.RGBA,_.UNSIGNED_BYTE,d),y.bindFramebuffer.set(null);const g=d[0]+(d[2]>>4<<8),w=d[1]+((15&d[2])<<8),T=this.coordsIndex[255-d[3]],L=T&&this.sourceCache.getTileByID(T);if(!L)return null;const D=this._coordsTextureSize,H=(1<<L.tileID.canonical.z)*D;return new o.Y((L.tileID.canonical.x*D+g)/H+L.tileID.wrap,(L.tileID.canonical.y*D+w)/H,this.getElevation(L.tileID,g,w,D))}depthAtPoint(l){const d=new Uint8Array(4),y=this.painter.context,_=y.gl;return y.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),_.readPixels(l.x,this.painter.height/devicePixelRatio-l.y-1,1,1,_.RGBA,_.UNSIGNED_BYTE,d),y.bindFramebuffer.set(null),(d[0]/16777216+d[1]/65536+d[2]/256+d[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const l=this.painter.context,d=new o.ba,y=new o.aX,_=this.meshSize,E=o.W/_,P=_*_;for(let L=0;L<=_;L++)for(let D=0;D<=_;D++)d.emplaceBack(D*E,L*E,0);for(let L=0;L<P;L+=_+1)for(let D=0;D<_;D++)y.emplaceBack(D+L,_+D+L+1,_+D+L+2),y.emplaceBack(D+L,_+D+L+2,D+L+1);const R=d.length,g=R+2*(_+1);for(const L of[0,1])for(let D=0;D<=_;D++)for(const H of[0,1])d.emplaceBack(D*E,L*o.W,H);for(let L=0;L<2*_;L+=2)y.emplaceBack(g+L,g+L+1,g+L+3),y.emplaceBack(g+L,g+L+3,g+L+2),y.emplaceBack(R+L,R+L+3,R+L+1),y.emplaceBack(R+L,R+L+2,R+L+3);const w=d.length,T=w+2*(_+1);for(const L of[0,1])for(let D=0;D<=_;D++)for(const H of[0,1])d.emplaceBack(L*o.W,D*E,H);for(let L=0;L<2*_;L+=2)y.emplaceBack(w+L,w+L+1,w+L+3),y.emplaceBack(w+L,w+L+3,w+L+2),y.emplaceBack(T+L,T+L+3,T+L+1),y.emplaceBack(T+L,T+L+2,T+L+3);return this._mesh={indexBuffer:l.createIndexBuffer(y),vertexBuffer:l.createVertexBuffer(d,hi.members),segments:o.$.simpleSegment(0,0,d.length,y.length)},this._mesh}getMeshFrameDelta(l){return 2*Math.PI*o.bb/Math.pow(2,l)/5}getMinTileElevationForLngLatZoom(l,d){var y;const{tileID:_}=this._getOverscaledTileIDFromLngLatZoom(l,d);return(y=this.getMinMaxElevation(_).minElevation)!==null&&y!==void 0?y:0}getMinMaxElevation(l){const d=this.getTerrainData(l).tile,y={minElevation:null,maxElevation:null};return d&&d.dem&&(y.minElevation=d.dem.min*this.exaggeration,y.maxElevation=d.dem.max*this.exaggeration),y}_getOverscaledTileIDFromLngLatZoom(l,d){const y=o.Y.fromLngLat(l.wrap()),_=(1<<d)*o.W,E=y.x*_,P=y.y*_,R=Math.floor(E/o.W),g=Math.floor(P/o.W);return{tileID:new o.Q(d,0,d,R,g),mercatorX:E,mercatorY:P}}}class Bo{constructor(l,d,y){this._context=l,this._size=d,this._tileSize=y,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const l of this._objects)l.texture.destroy(),l.fbo.destroy()}_createObject(l){const d=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),y=new oe(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return y.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),d.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),d.colorAttachment.set(y.texture),{id:l,fbo:d,texture:y,stamp:-1,inUse:!1}}getObjectForId(l){return this._objects[l]}useObject(l){l.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(d=>l.id!==d),this._recentlyUsed.push(l.id)}stampObject(l){l.stamp=++this._stamp}getOrCreateFreeObject(){for(const d of this._recentlyUsed)if(!this._objects[d].inUse)return this._objects[d];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const l=this._createObject(this._objects.length);return this._objects.push(l),l}freeObject(l){l.inUse=!1}freeAllObjects(){for(const l of this._objects)this.freeObject(l)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(l=>!l.inUse)===!1}}const Ni={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class ea{constructor(l,d){this.painter=l,this.terrain=d,this.pool=new Bo(l.context,30,d.sourceCache.tileSize*d.qualityFactor)}destruct(){this.pool.destruct()}getTexture(l){return this.pool.getObjectForId(l.rtt[this._stacks.length-1].id).texture}prepareForRender(l,d){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=l._order.filter(y=>!l._layers[y].isHidden(d)),this._coordsDescendingInv={};for(const y in l.sourceCaches){this._coordsDescendingInv[y]={};const _=l.sourceCaches[y].getVisibleCoordinates();for(const E of _){const P=this.terrain.sourceCache.getTerrainCoords(E);for(const R in P)this._coordsDescendingInv[y][R]||(this._coordsDescendingInv[y][R]=[]),this._coordsDescendingInv[y][R].push(P[R])}}this._coordsDescendingInvStr={};for(const y of l._order){const _=l._layers[y],E=_.source;if(Ni[_.type]&&!this._coordsDescendingInvStr[E]){this._coordsDescendingInvStr[E]={};for(const P in this._coordsDescendingInv[E])this._coordsDescendingInvStr[E][P]=this._coordsDescendingInv[E][P].map(R=>R.key).sort().join()}}for(const y of this._renderableTiles)for(const _ in this._coordsDescendingInvStr){const E=this._coordsDescendingInvStr[_][y.tileID.key];E&&E!==y.rttCoords[_]&&(y.rtt=[])}}renderLayer(l){if(l.isHidden(this.painter.transform.zoom))return!1;const d=l.type,y=this.painter,_=this._renderableLayerIds[this._renderableLayerIds.length-1]===l.id;if(Ni[d]&&(this._prevType&&Ni[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(l.id),!_))return!0;if(Ni[this._prevType]||Ni[d]&&_){this._prevType=d;const E=this._stacks.length-1,P=this._stacks[E]||[];for(const R of this._renderableTiles){if(this.pool.isFull()&&(uu(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(R),R.rtt[E]){const w=this.pool.getObjectForId(R.rtt[E].id);if(w.stamp===R.rtt[E].stamp){this.pool.useObject(w);continue}}const g=this.pool.getOrCreateFreeObject();this.pool.useObject(g),this.pool.stampObject(g),R.rtt[E]={id:g.id,stamp:g.stamp},y.context.bindFramebuffer.set(g.fbo.framebuffer),y.context.clear({color:o.aO.transparent,stencil:0}),y.currentStencilSource=void 0;for(let w=0;w<P.length;w++){const T=y.style._layers[P[w]],L=T.source?this._coordsDescendingInv[T.source][R.tileID.key]:[R.tileID];y.context.viewport.set([0,0,g.fbo.width,g.fbo.height]),y._renderTileClippingMasks(T,L),y.renderLayer(y,y.style.sourceCaches[T.source],T,L),T.source&&(R.rttCoords[T.source]=this._coordsDescendingInvStr[T.source][R.tileID.key])}}return uu(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Ni[d]}return!1}}const yd={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},sh=A,Co={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:gd,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Es=C=>{C.touchstart=C.dragStart,C.touchmoveWindow=C.dragMove,C.touchend=C.dragEnd},_d={showCompass:!0,showZoom:!0,visualizePitch:!1};class vd{constructor(l,d){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.mousedown=P=>{this.startMouse(o.e({},P,{ctrlKey:!0,preventDefault:()=>P.preventDefault()}),x.mousePos(this.element,P)),x.addEventListener(window,"mousemove",this.mousemove),x.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=P=>{this.moveMouse(P,x.mousePos(this.element,P))},this.mouseup=P=>{this.mouseRotate.dragEnd(P),this.mousePitch&&this.mousePitch.dragEnd(P),this.offTemp()},this.touchstart=P=>{P.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=x.touchPos(this.element,P.targetTouches)[0],this.startTouch(P,this._startPos),x.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),x.addEventListener(window,"touchend",this.touchend))},this.touchmove=P=>{P.targetTouches.length!==1?this.reset():(this._lastPos=x.touchPos(this.element,P.targetTouches)[0],this.moveTouch(P,this._lastPos))},this.touchend=P=>{P.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const _=l.dragRotate._mouseRotate.getClickTolerance(),E=l.dragRotate._mousePitch.getClickTolerance();this.element=d,this.mouseRotate=yl({clickTolerance:_,enable:!0}),this.touchRotate=(P=>{let{enable:R,clickTolerance:g,bearingDegreesPerPixelMoved:w=.8}=P;const T=new er;return new Ka({clickTolerance:g,move:(L,D)=>({bearingDelta:(D.x-L.x)*w}),moveStateManager:T,enable:R,assignEvents:Es})})({clickTolerance:_,enable:!0}),this.map=l,y&&(this.mousePitch=_l({clickTolerance:E,enable:!0}),this.touchPitch=(P=>{let{enable:R,clickTolerance:g,pitchDegreesPerPixelMoved:w=-.5}=P;const T=new er;return new Ka({clickTolerance:g,move:(L,D)=>({pitchDelta:(D.y-L.y)*w}),moveStateManager:T,enable:R,assignEvents:Es})})({clickTolerance:E,enable:!0})),x.addEventListener(d,"mousedown",this.mousedown),x.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),x.addEventListener(d,"touchcancel",this.reset)}startMouse(l,d){this.mouseRotate.dragStart(l,d),this.mousePitch&&this.mousePitch.dragStart(l,d),x.disableDrag()}startTouch(l,d){this.touchRotate.dragStart(l,d),this.touchPitch&&this.touchPitch.dragStart(l,d),x.disableDrag()}moveMouse(l,d){const y=this.map,{bearingDelta:_}=this.mouseRotate.dragMove(l,d)||{};if(_&&y.setBearing(y.getBearing()+_),this.mousePitch){const{pitchDelta:E}=this.mousePitch.dragMove(l,d)||{};E&&y.setPitch(y.getPitch()+E)}}moveTouch(l,d){const y=this.map,{bearingDelta:_}=this.touchRotate.dragMove(l,d)||{};if(_&&y.setBearing(y.getBearing()+_),this.touchPitch){const{pitchDelta:E}=this.touchPitch.dragMove(l,d)||{};E&&y.setPitch(y.getPitch()+E)}}off(){const l=this.element;x.removeEventListener(l,"mousedown",this.mousedown),x.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),x.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),x.removeEventListener(window,"touchend",this.touchend),x.removeEventListener(l,"touchcancel",this.reset),this.offTemp()}offTemp(){x.enableDrag(),x.removeEventListener(window,"mousemove",this.mousemove),x.removeEventListener(window,"mouseup",this.mouseup),x.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),x.removeEventListener(window,"touchend",this.touchend)}}let Ba;function cA(C,l,d){const y=new o.M(C.lng,C.lat);if(C=new o.M(C.lng,C.lat),l){const _=new o.M(C.lng-360,C.lat),E=new o.M(C.lng+360,C.lat),P=d.locationPoint(C).distSqr(l);d.locationPoint(_).distSqr(l)<P?C=_:d.locationPoint(E).distSqr(l)<P&&(C=E)}for(;Math.abs(C.lng-d.center.lng)>180;){const _=d.locationPoint(C);if(_.x>=0&&_.y>=0&&_.x<=d.width&&_.y<=d.height)break;C.lng>d.center.lng?C.lng-=360:C.lng+=360}return C.lng!==y.lng&&d.locationPoint(C).y>d.height/2-d.getHorizon()?C:y}const du={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function lA(C,l,d){const y=C.classList;for(const _ in du)y.remove(`maplibregl-${d}-anchor-${_}`);y.add(`maplibregl-${d}-anchor-${l}`)}class uA extends o.E{constructor(l){if(super(),this._onKeyPress=d=>{const y=d.code,_=d.charCode||d.keyCode;y!=="Space"&&y!=="Enter"&&_!==32&&_!==13||this.togglePopup()},this._onMapClick=d=>{const y=d.originalEvent.target,_=this._element;this._popup&&(y===_||_.contains(y))&&this.togglePopup()},this._update=d=>{var y;if(!this._map)return;const _=this._map.loaded()&&!this._map.isMoving();((d==null?void 0:d.type)==="terrain"||(d==null?void 0:d.type)==="render"&&!_)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?cA(this._lngLat,this._flatPos,this._map.transform):(y=this._lngLat)===null||y===void 0?void 0:y.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let E="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?E=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(E=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let P="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?P="rotateX(0deg)":this._pitchAlignment==="map"&&(P=`rotateX(${this._map.getPitch()}deg)`),d&&d.type!=="moveend"||(this._pos=this._pos.round()),x.setTransform(this._element,`${du[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${P} ${E}`),v.frameAsync(new AbortController).then(()=>{this._updateOpacity(d&&d.type==="moveend")}).catch(()=>{})},this._onMove=d=>{if(!this._isDragging){const y=this._clickTolerance||this._map._clickTolerance;this._isDragging=d.point.dist(this._pointerdownPos)>=y}this._isDragging&&(this._pos=d.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.k("dragstart"))),this.fire(new o.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.k("dragend")),this._state="inactive"},this._addDragHandler=d=>{this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(this._pos).add(this._offset),this._pointerdownPos=d.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(l==null?void 0:l.opacity,l==null?void 0:l.opacityWhenCovered),l&&l.element)this._element=l.element,this._offset=o.P.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=x.create("div"),this._element.setAttribute("aria-label","Map marker");const d=x.createNS("http://www.w3.org/2000/svg","svg"),y=41,_=27;d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height",`${y}px`),d.setAttributeNS(null,"width",`${_}px`),d.setAttributeNS(null,"viewBox",`0 0 ${_} ${y}`);const E=x.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"stroke","none"),E.setAttributeNS(null,"stroke-width","1"),E.setAttributeNS(null,"fill","none"),E.setAttributeNS(null,"fill-rule","evenodd");const P=x.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"fill-rule","nonzero");const R=x.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"transform","translate(3.0, 29.0)"),R.setAttributeNS(null,"fill","#000000");const g=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const X of g){const ue=x.createNS("http://www.w3.org/2000/svg","ellipse");ue.setAttributeNS(null,"opacity","0.04"),ue.setAttributeNS(null,"cx","10.5"),ue.setAttributeNS(null,"cy","5.80029008"),ue.setAttributeNS(null,"rx",X.rx),ue.setAttributeNS(null,"ry",X.ry),R.appendChild(ue)}const w=x.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill",this._color);const T=x.createNS("http://www.w3.org/2000/svg","path");T.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),w.appendChild(T);const L=x.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"opacity","0.25"),L.setAttributeNS(null,"fill","#000000");const D=x.createNS("http://www.w3.org/2000/svg","path");D.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),L.appendChild(D);const H=x.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(6.0, 7.0)"),H.setAttributeNS(null,"fill","#FFFFFF");const z=x.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"transform","translate(8.0, 8.0)");const j=x.createNS("http://www.w3.org/2000/svg","circle");j.setAttributeNS(null,"fill","#000000"),j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"cx","5.5"),j.setAttributeNS(null,"cy","5.5"),j.setAttributeNS(null,"r","5.4999962");const V=x.createNS("http://www.w3.org/2000/svg","circle");V.setAttributeNS(null,"fill","#FFFFFF"),V.setAttributeNS(null,"cx","5.5"),V.setAttributeNS(null,"cy","5.5"),V.setAttributeNS(null,"r","5.4999962"),z.appendChild(j),z.appendChild(V),P.appendChild(R),P.appendChild(w),P.appendChild(L),P.appendChild(H),P.appendChild(z),d.appendChild(P),d.setAttributeNS(null,"height",y*this._scale+"px"),d.setAttributeNS(null,"width",_*this._scale+"px"),this._element.appendChild(d),this._offset=o.P.convert(l&&l.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",d=>{d.preventDefault()}),this._element.addEventListener("mousedown",d=>{d.preventDefault()}),lA(this._element,this._anchor,"marker"),l&&l.className)for(const d of l.className.split(" "))this._element.classList.add(d);this._popup=null}addTo(l){return this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),l.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),x.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=o.M.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const _=Math.abs(13.5)/Math.SQRT2;l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const l=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:l?(l.isOpen()?l.remove():(l.setLngLat(this._lngLat),l.addTo(this._map)),this):this}_updateOpacity(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;var d,y;if(!(!((d=this._map)===null||d===void 0)&&d.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(l)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const _=this._map,E=_.terrain.depthAtPoint(this._pos),P=_.terrain.getElevationForLngLatZoom(this._lngLat,_.transform.tileZoom);if(_.transform.lngLatToCameraDepth(this._lngLat,P)-E<.006)return void(this._element.style.opacity=this._opacity);const R=-this._offset.y/_.transform._pixelPerMeter,g=Math.sin(_.getPitch()*Math.PI/180)*R,w=_.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),T=_.transform.lngLatToCameraDepth(this._lngLat,P+g)-w>.006;!((y=this._popup)===null||y===void 0)&&y.isOpen()&&T&&this._popup.remove(),this._element.style.opacity=T?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(l){return this._offset=o.P.convert(l),this._update(),this}addClassName(l){this._element.classList.add(l)}removeClassName(l){this._element.classList.remove(l)}toggleClassName(l){return this._element.classList.toggle(l)}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(l,d){return l===void 0&&d===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),l!==void 0&&(this._opacity=l),d!==void 0&&(this._opacityWhenCovered=d),this._map&&this._updateOpacity(!0),this}}const Cl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let $a=0,ta=!1;const fu={maxWidth:100,unit:"metric"};function AA(C,l,d){const y=d&&d.maxWidth||100,_=C._container.clientHeight/2,E=C.unproject([0,_]),P=C.unproject([y,_]),R=E.distanceTo(P);if(d&&d.unit==="imperial"){const g=3.2808*R;g>5280?El(l,y,g/5280,C._getUIString("ScaleControl.Miles")):El(l,y,g,C._getUIString("ScaleControl.Feet"))}else d&&d.unit==="nautical"?El(l,y,R/1852,C._getUIString("ScaleControl.NauticalMiles")):R>=1e3?El(l,y,R/1e3,C._getUIString("ScaleControl.Kilometers")):El(l,y,R,C._getUIString("ScaleControl.Meters"))}function El(C,l,d,y){const _=function(E){const P=Math.pow(10,`${Math.floor(E)}`.length-1);let R=E/P;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(g){const w=Math.pow(10,Math.ceil(-Math.log(g)/Math.LN10));return Math.round(g*w)/w}(R),P*R}(d);C.style.width=l*(_/d)+"px",C.innerHTML=`${_}&nbsp;${y}`}const oh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},bd=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ah(C){if(C){if(typeof C=="number"){const l=Math.round(Math.abs(C)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,C),"top-left":new o.P(l,l),"top-right":new o.P(-l,l),bottom:new o.P(0,-C),"bottom-left":new o.P(l,-l),"bottom-right":new o.P(-l,-l),left:new o.P(C,0),right:new o.P(-C,0)}}if(C instanceof o.P||Array.isArray(C)){const l=o.P.convert(C);return{center:l,top:l,"top-left":l,"top-right":l,bottom:l,"bottom-left":l,"bottom-right":l,left:l,right:l}}return{center:o.P.convert(C.center||[0,0]),top:o.P.convert(C.top||[0,0]),"top-left":o.P.convert(C["top-left"]||[0,0]),"top-right":o.P.convert(C["top-right"]||[0,0]),bottom:o.P.convert(C.bottom||[0,0]),"bottom-left":o.P.convert(C["bottom-left"]||[0,0]),"bottom-right":o.P.convert(C["bottom-right"]||[0,0]),left:o.P.convert(C.left||[0,0]),right:o.P.convert(C.right||[0,0])}}return ah(new o.P(0,0))}const cp=A;a.AJAXError=o.be,a.Evented=o.E,a.LngLat=o.M,a.MercatorCoordinate=o.Y,a.Point=o.P,a.addProtocol=o.bf,a.config=o.a,a.removeProtocol=o.bg,a.AttributionControl=Zo,a.BoxZoomHandler=Fn,a.CanvasSource=ir,a.CooperativeGesturesHandler=dr,a.DoubleClickZoomHandler=iA,a.DragPanHandler=pd,a.DragRotateHandler=Yo,a.EdgeInsets=Zs,a.FullscreenControl=class extends o.E{constructor(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this._onFullscreenChange=()=>{var l;let d=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((l=d==null?void 0:d.shadowRoot)===null||l===void 0)&&l.fullscreenElement;)d=d.shadowRoot.fullscreenElement;d===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,C&&C.container&&(C.container instanceof HTMLElement?this._container=C.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(C){return this._map=C,this._container||(this._container=this._map.getContainer()),this._controlContainer=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){x.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const C=this._fullscreenButton=x.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);x.create("span","maplibregl-ctrl-icon",C).setAttribute("aria-hidden","true"),C.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const C=this._getTitle();this._fullscreenButton.setAttribute("aria-label",C),this._fullscreenButton.title=C}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},a.GeoJSONSource=St,a.GeolocateControl=class extends o.E{constructor(C){super(),this._onSuccess=l=>{if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new o.k("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.k("geolocate",l)),this._finish()}},this._updateCamera=l=>{const d=new o.M(l.coords.longitude,l.coords.latitude),y=l.coords.accuracy,_=this._map.getBearing(),E=o.e({bearing:_},this.options.fitBoundsOptions),P=zt.fromLngLat(d,y);this._map.fitBounds(P,E,{geolocateSource:!0})},this._updateMarker=l=>{if(l){const d=new o.M(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=l.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=l=>{if(this._map){if(this.options.trackUserLocation)if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&ta)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.k("error",l)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=l=>{if(this._map){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=x.create("button","maplibregl-ctrl-geolocate",this._container),x.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",l===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=x.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new uA({element:this._dotElement}),this._circleElement=x.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new uA({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d.originalEvent&&d.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.k("trackuserlocationend")))})}},this.options=o.e({},Cl,C)}onAdd(C){return this._map=C,this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(){return o._(this,arguments,void 0,function(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return function*(){if(Ba!==void 0&&!l)return Ba;if(window.navigator.permissions===void 0)return Ba=!!window.navigator.geolocation,Ba;try{Ba=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Ba=!!window.navigator.geolocation}return Ba}()})}().then(l=>this._setupUI(l)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),x.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,$a=0,ta=!1}_isOutOfMapMaxBounds(C){const l=this._map.getMaxBounds(),d=C.coords;return l&&(d.longitude<l.getWest()||d.longitude>l.getEast()||d.latitude<l.getSouth()||d.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const C=this._map.getBounds(),l=C.getSouthEast(),d=C.getNorthEast(),y=l.distanceTo(d),_=Math.ceil(this._accuracy/(y/this._map._container.clientHeight)*2);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":$a--,ta=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let C;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),$a++,$a>1?(C={maximumAge:6e5,timeout:0},ta=!0):(C=this.options.positionOptions,ta=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,C)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},a.Hash=eo,a.ImageSource=Bt,a.KeyboardHandler=Wa,a.LngLatBounds=zt,a.LogoControl=md,a.Map=class extends $i{constructor(C){if(o.bc.mark(o.bd.create),(C=o.e({},Co,C)).minZoom!=null&&C.maxZoom!=null&&C.minZoom>C.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(C.minPitch!=null&&C.maxPitch!=null&&C.minPitch>C.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(C.minPitch!=null&&C.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(C.maxPitch!=null&&C.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new wo(C.minZoom,C.maxZoom,C.minPitch,C.maxPitch,C.renderWorldCopies),{bearingSnap:C.bearingSnap}),this._contextLost=l=>{l.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.k("webglcontextlost",{originalEvent:l}))},this._contextRestored=l=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.k("webglcontextrestored",{originalEvent:l}))},this._onMapScroll=l=>{if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=C.interactive,this._maxTileCacheSize=C.maxTileCacheSize,this._maxTileCacheZoomLevels=C.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=C.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=C.preserveDrawingBuffer,this._antialias=C.antialias,this._trackResize=C.trackResize,this._bearingSnap=C.bearingSnap,this._refreshExpiredTiles=C.refreshExpiredTiles,this._fadeDuration=C.fadeDuration,this._crossSourceCollisions=C.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=C.collectResourceTiming,this._renderTaskQueue=new aA,this._controls=[],this._mapId=o.a3(),this._locale=o.e({},yd,C.locale),this._clickTolerance=C.clickTolerance,this._overridePixelRatio=C.pixelRatio,this._maxCanvasSize=C.maxCanvasSize,this.transformCameraUpdate=C.transformCameraUpdate,this._imageQueueHandle=Y.addThrottleControl(()=>this.isMoving()),this._requestManager=new te(C.transformRequest),typeof C.container=="string"){if(this._container=document.getElementById(C.container),!this._container)throw new Error(`Container '${C.container}' not found.`)}else{if(!(C.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=C.container}if(C.maxBounds&&this.setMaxBounds(C.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let l=!1;const d=Sc(y=>{this._trackResize&&!this._removed&&this.resize(y)._update()},50);this._resizeObserver=new ResizeObserver(y=>{l?d(y):l=!0}),this._resizeObserver.observe(this._container)}this.handlers=new oA(this,C),this._hash=C.hash&&new eo(typeof C.hash=="string"&&C.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:C.center,zoom:C.zoom,bearing:C.bearing,pitch:C.pitch}),C.bounds&&(this.resize(),this.fitBounds(C.bounds,o.e({},C.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=C.localIdeographFontFamily,this._validateStyle=C.validateStyle,C.style&&this.setStyle(C.style,{localIdeographFontFamily:C.localIdeographFontFamily}),C.attributionControl&&this.addControl(new Zo(typeof C.attributionControl=="boolean"?void 0:C.attributionControl)),C.maplibreLogo&&this.addControl(new md,C.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new o.k(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new o.k(`${l.dataType}dataloading`,l))}),this.on("dataabort",l=>{this.fire(new o.k("sourcedataabort",l))})}_getMapId(){return this._mapId}addControl(C,l){if(l===void 0&&(l=C.getDefaultPosition?C.getDefaultPosition():"top-right"),!C||!C.onAdd)return this.fire(new o.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=C.onAdd(this);this._controls.push(C);const y=this._controlPositions[l];return l.indexOf("bottom")!==-1?y.insertBefore(d,y.firstChild):y.appendChild(d),this}removeControl(C){if(!C||!C.onRemove)return this.fire(new o.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(C);return l>-1&&this._controls.splice(l,1),C.onRemove(this),this}hasControl(C){return this._controls.indexOf(C)>-1}calculateCameraOptionsFromTo(C,l,d,y){return y==null&&this.terrain&&(y=this.terrain.getElevationForLngLatZoom(d,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(C,l,d,y)}resize(C){var l;const d=this._containerDimensions(),y=d[0],_=d[1],E=this._getClampedPixelRatio(y,_);if(this._resizeCanvas(y,_,E),this.painter.resize(y,_,E),this.painter.overLimit()){const R=this.painter.context.gl;this._maxCanvasSize=[R.drawingBufferWidth,R.drawingBufferHeight];const g=this._getClampedPixelRatio(y,_);this._resizeCanvas(y,_,g),this.painter.resize(y,_,g)}this.transform.resize(y,_),(l=this._requestedCameraState)===null||l===void 0||l.resize(y,_);const P=!this._moving;return P&&(this.stop(),this.fire(new o.k("movestart",C)).fire(new o.k("move",C))),this.fire(new o.k("resize",C)),P&&this.fire(new o.k("moveend",C)),this}_getClampedPixelRatio(C,l){const{0:d,1:y}=this._maxCanvasSize,_=this.getPixelRatio(),E=C*_,P=l*_;return Math.min(E>d?d/E:1,P>y?y/P:1)*_}getPixelRatio(){var C;return(C=this._overridePixelRatio)!==null&&C!==void 0?C:devicePixelRatio}setPixelRatio(C){this._overridePixelRatio=C,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(C){return this.transform.setMaxBounds(zt.convert(C)),this._update()}setMinZoom(C){if((C=C??-2)>=-2&&C<=this.transform.maxZoom)return this.transform.minZoom=C,this._update(),this.getZoom()<C&&this.setZoom(C),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(C){if((C=C??22)>=this.transform.minZoom)return this.transform.maxZoom=C,this._update(),this.getZoom()>C&&this.setZoom(C),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(C){if((C=C??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(C>=0&&C<=this.transform.maxPitch)return this.transform.minPitch=C,this._update(),this.getPitch()<C&&this.setPitch(C),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(C){if((C=C??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(C>=this.transform.minPitch)return this.transform.maxPitch=C,this._update(),this.getPitch()>C&&this.setPitch(C),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(C){return this.transform.renderWorldCopies=C,this._update()}project(C){return this.transform.locationPoint(o.M.convert(C),this.style&&this.terrain)}unproject(C){return this.transform.pointLocation(o.P.convert(C),this.terrain)}isMoving(){var C;return this._moving||((C=this.handlers)===null||C===void 0?void 0:C.isMoving())}isZooming(){var C;return this._zooming||((C=this.handlers)===null||C===void 0?void 0:C.isZooming())}isRotating(){var C;return this._rotating||((C=this.handlers)===null||C===void 0?void 0:C.isRotating())}_createDelegatedListener(C,l,d){if(C==="mouseenter"||C==="mouseover"){let y=!1;return{layer:l,listener:d,delegates:{mousemove:E=>{const P=this.getLayer(l)?this.queryRenderedFeatures(E.point,{layers:[l]}):[];P.length?y||(y=!0,d.call(this,new Ci(C,this,E.originalEvent,{features:P}))):y=!1},mouseout:()=>{y=!1}}}}if(C==="mouseleave"||C==="mouseout"){let y=!1;return{layer:l,listener:d,delegates:{mousemove:P=>{(this.getLayer(l)?this.queryRenderedFeatures(P.point,{layers:[l]}):[]).length?y=!0:y&&(y=!1,d.call(this,new Ci(C,this,P.originalEvent)))},mouseout:P=>{y&&(y=!1,d.call(this,new Ci(C,this,P.originalEvent)))}}}}{const y=_=>{const E=this.getLayer(l)?this.queryRenderedFeatures(_.point,{layers:[l]}):[];E.length&&(_.features=E,d.call(this,_),delete _.features)};return{layer:l,listener:d,delegates:{[C]:y}}}}on(C,l,d){if(d===void 0)return super.on(C,l);const y=this._createDelegatedListener(C,l,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[C]=this._delegatedListeners[C]||[],this._delegatedListeners[C].push(y);for(const _ in y.delegates)this.on(_,y.delegates[_]);return this}once(C,l,d){if(d===void 0)return super.once(C,l);const y=this._createDelegatedListener(C,l,d);for(const _ in y.delegates)this.once(_,y.delegates[_]);return this}off(C,l,d){return d===void 0?super.off(C,l):(this._delegatedListeners&&this._delegatedListeners[C]&&(y=>{const _=this._delegatedListeners[C];for(let E=0;E<_.length;E++){const P=_[E];if(P.layer===l&&P.listener===d){for(const R in P.delegates)this.off(R,P.delegates[R]);return _.splice(E,1),this}}})(),this)}queryRenderedFeatures(C,l){if(!this.style)return[];let d;const y=C instanceof o.P||Array.isArray(C),_=y?C:[[0,0],[this.transform.width,this.transform.height]];if(l=l||(y?{}:C)||{},_ instanceof o.P||typeof _[0]=="number")d=[o.P.convert(_)];else{const E=o.P.convert(_[0]),P=o.P.convert(_[1]);d=[E,new o.P(P.x,E.y),P,new o.P(E.x,P.y),E]}return this.style.queryRenderedFeatures(d,l,this.transform)}querySourceFeatures(C,l){return this.style.querySourceFeatures(C,l)}setStyle(C,l){return(l=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&C?(this._diffStyle(C,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._updateStyle(C,l))}setTransformRequest(C){return this._requestManager.setTransformRequest(C),this}_getUIString(C){const l=this._locale[C];if(l==null)throw new Error(`Missing UI string '${C}'`);return l}_updateStyle(C,l){if(l.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(C,l));const d=this.style&&l.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!C)),C?(this.style=new Pi(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof C=="string"?this.style.loadURL(C,l,d):this.style.loadJSON(C,l,d),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Pi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(C,l){if(typeof C=="string"){const d=this._requestManager.transformRequest(C,"Style");o.h(d,new AbortController).then(y=>{this._updateDiff(y.data,l)}).catch(y=>{y&&this.fire(new o.j(y))})}else typeof C=="object"&&this._updateDiff(C,l)}_updateDiff(C,l){try{this.style.setState(C,l)&&this._update(!0)}catch(d){o.w(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(C,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(C,l){return this._lazyInitEmptyStyle(),this.style.addSource(C,l),this._update(!0)}isSourceLoaded(C){const l=this.style&&this.style.sourceCaches[C];if(l!==void 0)return l.loaded();this.fire(new o.j(new Error(`There is no source with ID '${C}'`)))}setTerrain(C){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),C){const l=this.style.sourceCaches[C.source];if(!l)throw new Error(`cannot load terrain, because there exists no source with ID: ${C.source}`);this.terrain===null&&l.reload();for(const d in this.style._layers){const y=this.style._layers[d];y.type==="hillshade"&&y.source===C.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ap(this.painter,l,C),this.painter.renderToTexture=new ea(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=d=>{d.dataType==="style"?this.terrain.sourceCache.freeRtt():d.dataType==="source"&&d.tile&&(d.sourceId!==C.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(d.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new o.k("terrain",{terrain:C})),this}getTerrain(){var C,l;return(l=(C=this.terrain)===null||C===void 0?void 0:C.options)!==null&&l!==void 0?l:null}areTilesLoaded(){const C=this.style&&this.style.sourceCaches;for(const l in C){const d=C[l]._tiles;for(const y in d){const _=d[y];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}removeSource(C){return this.style.removeSource(C),this._update(!0)}getSource(C){return this.style.getSource(C)}addImage(C,l){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{pixelRatio:y=1,sdf:_=!1,stretchX:E,stretchY:P,content:R}=d;if(this._lazyInitEmptyStyle(),!(l instanceof HTMLImageElement||o.b(l))){if(l.width===void 0||l.height===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:g,height:w,data:T}=l,L=l;return this.style.addImage(C,{data:new o.R({width:g,height:w},new Uint8Array(T)),pixelRatio:y,stretchX:E,stretchY:P,content:R,sdf:_,version:0,userImage:L}),L.onAdd&&L.onAdd(this,C),this}}{const{width:g,height:w,data:T}=v.getImageData(l);this.style.addImage(C,{data:new o.R({width:g,height:w},T),pixelRatio:y,stretchX:E,stretchY:P,content:R,sdf:_,version:0})}}updateImage(C,l){const d=this.style.getImage(C);if(!d)return this.fire(new o.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=l instanceof HTMLImageElement||o.b(l)?v.getImageData(l):l,{width:_,height:E,data:P}=y;if(_===void 0||E===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==d.data.width||E!==d.data.height)return this.fire(new o.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const R=!(l instanceof HTMLImageElement||o.b(l));return d.data.replace(P,R),this.style.updateImage(C,d),this}getImage(C){return this.style.getImage(C)}hasImage(C){return C?!!this.style.getImage(C):(this.fire(new o.j(new Error("Missing required image id"))),!1)}removeImage(C){this.style.removeImage(C)}loadImage(C){return Y.getImage(this._requestManager.transformRequest(C,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(C,l){return this._lazyInitEmptyStyle(),this.style.addLayer(C,l),this._update(!0)}moveLayer(C,l){return this.style.moveLayer(C,l),this._update(!0)}removeLayer(C){return this.style.removeLayer(C),this._update(!0)}getLayer(C){return this.style.getLayer(C)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(C,l,d){return this.style.setLayerZoomRange(C,l,d),this._update(!0)}setFilter(C,l){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.style.setFilter(C,l,d),this._update(!0)}getFilter(C){return this.style.getFilter(C)}setPaintProperty(C,l,d){let y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.style.setPaintProperty(C,l,d,y),this._update(!0)}getPaintProperty(C,l){return this.style.getPaintProperty(C,l)}setLayoutProperty(C,l,d){let y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.style.setLayoutProperty(C,l,d,y),this._update(!0)}getLayoutProperty(C,l){return this.style.getLayoutProperty(C,l)}setGlyphs(C){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setGlyphs(C,l),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(C,l){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._lazyInitEmptyStyle(),this.style.addSprite(C,l,d,y=>{y||this._update(!0)}),this}removeSprite(C){return this._lazyInitEmptyStyle(),this.style.removeSprite(C),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(C){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setSprite(C,l,d=>{d||this._update(!0)}),this}setLight(C){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setLight(C,l),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(C,l){return this.style.setFeatureState(C,l),this._update()}removeFeatureState(C,l){return this.style.removeFeatureState(C,l),this._update()}getFeatureState(C){return this.style.getFeatureState(C)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let C=0,l=0;return this._container&&(C=this._container.clientWidth||400,l=this._container.clientHeight||300),[C,l]}_setupContainer(){const C=this._container;C.classList.add("maplibregl-map");const l=this._canvasContainer=x.create("div","maplibregl-canvas-container",C);this._interactive&&l.classList.add("maplibregl-interactive"),this._canvas=x.create("canvas","maplibregl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const d=this._containerDimensions(),y=this._getClampedPixelRatio(d[0],d[1]);this._resizeCanvas(d[0],d[1],y);const _=this._controlContainer=x.create("div","maplibregl-control-container",C),E=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(P=>{E[P]=x.create("div",`maplibregl-ctrl-${P} `,_)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(C,l,d){this._canvas.width=Math.floor(d*C),this._canvas.height=Math.floor(d*l),this._canvas.style.width=`${C}px`,this._canvas.style.height=`${l}px`}_setupPainter(){const C={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let l=null;this._canvas.addEventListener("webglcontextcreationerror",y=>{l={requestedAttributes:C},y&&(l.statusMessage=y.statusMessage,l.type=y.type)},{once:!0});const d=this._canvas.getContext("webgl2",C)||this._canvas.getContext("webgl",C);if(!d){const y="Failed to initialize WebGL";throw l?(l.message=y,new Error(JSON.stringify(l))):new Error(y)}this.painter=new Va(d,this.transform),B.testSupport(d)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(C){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||C,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(C){return this._update(),this._renderTaskQueue.add(C)}_cancelRenderFrame(C){this._renderTaskQueue.remove(C)}_render(C){const l=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(C),this._removed)return;let d=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const _=this.transform.zoom,E=v.now();this.style.zoomHistory.update(_,E);const P=new o.a8(_,{now:E,fadeDuration:l,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),R=P.crossFadingFactor();R===1&&R===this._crossFadingFactor||(d=!0,this._crossFadingFactor=R),this.style.update(P)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,l,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:l,showPadding:this.showPadding}),this.fire(new o.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.bc.mark(o.bd.load),this.fire(new o.k("load"))),this.style&&(this.style.hasTransitions()||d)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const y=this._sourcesDirty||this._styleDirty||this._placementDirty;return y||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.k("idle")),!this._loaded||this._fullyLoaded||y||(this._fullyLoaded=!0,o.bc.mark(o.bd.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var C;this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Y.removeThrottleControl(this._imageQueueHandle),(C=this._resizeObserver)===null||C===void 0||C.disconnect();const l=this.painter.context.gl.getExtension("WEBGL_lose_context");l&&l.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),x.remove(this._canvasContainer),x.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),o.bc.clearMetrics(),this._removed=!0,this.fire(new o.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,v.frameAsync(this._frameRequest).then(C=>{o.bc.frame(C),this._frameRequest=null,this._render(C)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(C){this._showTileBoundaries!==C&&(this._showTileBoundaries=C,this._update())}get showPadding(){return!!this._showPadding}set showPadding(C){this._showPadding!==C&&(this._showPadding=C,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(C){this._showCollisionBoxes!==C&&(this._showCollisionBoxes=C,C?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(C){this._showOverdrawInspector!==C&&(this._showOverdrawInspector=C,this._update())}get repaint(){return!!this._repaint}set repaint(C){this._repaint!==C&&(this._repaint=C,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(C){this._vertices=C,this._update()}get version(){return sh}getCameraTargetElevation(){return this.transform.elevation}},a.MapMouseEvent=Ci,a.MapTouchEvent=Qs,a.MapWheelEvent=Hs,a.Marker=uA,a.NavigationControl=class{constructor(C){this._updateZoomButtons=()=>{const l=this._map.getZoom(),d=l===this._map.getMaxZoom(),y=l===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())},this._rotateCompassArrow=()=>{const l=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=l},this._setButtonTitle=(l,d)=>{const y=this._map._getUIString(`NavigationControl.${d}`);l.title=y,l.setAttribute("aria-label",y)},this.options=o.e({},_d,C),this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",l=>this._map.zoomIn({},{originalEvent:l})),x.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",l=>this._map.zoomOut({},{originalEvent:l})),x.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})}),this._compassIcon=x.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(C){return this._map=C,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new vd(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){x.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(C,l){const d=x.create("button",C,this._container);return d.type="button",d.addEventListener("click",l),d}},a.Popup=class extends o.E{constructor(C){super(),this.remove=()=>(this._content&&x.remove(this._content),this._container&&(x.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.k("close"))),this),this._onMouseUp=l=>{this._update(l.point)},this._onMouseMove=l=>{this._update(l.point)},this._onDrag=l=>{this._update(l.point)},this._update=l=>{var d;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=x.create("div","maplibregl-popup",this._map.getContainer()),this._tip=x.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const R of this.options.className.split(" "))this._container.classList.add(R);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?cA(this._lngLat,this._flatPos,this._map.transform):(d=this._lngLat)===null||d===void 0?void 0:d.wrap(),this._trackPointer&&!l)return;const y=this._flatPos=this._pos=this._trackPointer&&l?l:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&l?l:this._map.transform.locationPoint(this._lngLat));let _=this.options.anchor;const E=ah(this.options.offset);if(!_){const R=this._container.offsetWidth,g=this._container.offsetHeight;let w;w=y.y+E.bottom.y<g?["top"]:y.y>this._map.transform.height-g?["bottom"]:[],y.x<R/2?w.push("left"):y.x>this._map.transform.width-R/2&&w.push("right"),_=w.length===0?"bottom":w.join("-")}let P=y.add(E[_]);this.options.subpixelPositioning||(P=P.round()),x.setTransform(this._container,`${du[_]} translate(${P.x}px,${P.y}px)`),lA(this._container,_,"popup")},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(oh),C)}addTo(C){return this._map&&this.remove(),this._map=C,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(C){return this._lngLat=o.M.convert(C),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(C){return this.setDOMContent(document.createTextNode(C))}setHTML(C){const l=document.createDocumentFragment(),d=document.createElement("body");let y;for(d.innerHTML=C;y=d.firstChild,y;)l.appendChild(y);return this.setDOMContent(l)}getMaxWidth(){var C;return(C=this._container)===null||C===void 0?void 0:C.style.maxWidth}setMaxWidth(C){return this.options.maxWidth=C,this._update(),this}setDOMContent(C){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=x.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(C),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(C){this._container&&this._container.classList.add(C)}removeClassName(C){this._container&&this._container.classList.remove(C)}setOffset(C){return this.options.offset=C,this._update(),this}toggleClassName(C){if(this._container)return this._container.classList.toggle(C)}setSubpixelPositioning(C){this.options.subpixelPositioning=C}_createCloseButton(){this.options.closeButton&&(this._closeButton=x.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const C=this._container.querySelector(bd);C&&C.focus()}},a.RasterDEMTileSource=tr,a.RasterTileSource=Ye,a.ScaleControl=class{constructor(C){this._onMove=()=>{AA(this._map,this._container,this.options)},this.setUnit=l=>{this.options.unit=l,AA(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},fu),C)}getDefaultPosition(){return"bottom-left"}onAdd(C){return this._map=C,this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-scale",C.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){x.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},a.ScrollZoomHandler=xl,a.Style=Pi,a.TerrainControl=class{constructor(C){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=C}onAdd(C){return this._map=C,this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=x.create("button","maplibregl-ctrl-terrain",this._container),x.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){x.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},a.TwoFingersTouchPitchHandler=nA,a.TwoFingersTouchRotateHandler=nh,a.TwoFingersTouchZoomHandler=rA,a.TwoFingersTouchZoomRotateHandler=sA,a.VectorTileSource=Re,a.VideoSource=kt,a.addSourceType=(C,l)=>o._(void 0,void 0,void 0,function*(){if(Lr(C))throw new Error(`A source type called "${C}" already exists.`);((d,y)=>{Ar[d]=y})(C,l)}),a.clearPrewarmedResources=function(){const C=De;C&&(C.isPreloaded()&&C.numActive()===1?(C.release(se),De=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},a.getRTLTextPluginStatus=function(){return pt().getRTLTextPluginStatus()},a.getVersion=function(){return cp},a.getWorkerCount=function(){return be.workerCount},a.getWorkerUrl=function(){return o.a.WORKER_URL},a.importScriptInWorkers=function(C){return st().broadcast("IS",C)},a.prewarm=function(){qe().acquire(se)},a.setMaxParallelImageRequests=function(C){o.a.MAX_PARALLEL_IMAGE_REQUESTS=C},a.setRTLTextPlugin=function(C,l){return pt().setRTLTextPlugin(C,l)},a.setWorkerCount=function(C){be.workerCount=C},a.setWorkerUrl=function(C){o.a.WORKER_URL=C}});var s=t;return s})})(HE);var zE=HE.exports;const Ts=Bp(zE);var Is;(function(r){r[r.Unknown=0]="Unknown",r[r.Point=1]="Point",r[r.LineString=2]="LineString",r[r.Polygon=3]="Polygon",r[r.MultiPoint=4]="MultiPoint",r[r.MultiLineString=5]="MultiLineString",r[r.MultiPolygon=6]="MultiPolygon",r[r.GeometryCollection=7]="GeometryCollection",r[r.CircularString=8]="CircularString",r[r.CompoundCurve=9]="CompoundCurve",r[r.CurvePolygon=10]="CurvePolygon",r[r.MultiCurve=11]="MultiCurve",r[r.MultiSurface=12]="MultiSurface",r[r.Curve=13]="Curve",r[r.Surface=14]="Surface",r[r.PolyhedralSurface=15]="PolyhedralSurface",r[r.TIN=16]="TIN",r[r.Triangle=17]="Triangle"})(Is||(Is={}));const Cp=4,Ep=4,Sp=4,_A=new Int32Array(2),GE=new Float32Array(_A.buffer),VE=new Float64Array(_A.buffer),Qm=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var Q_;(function(r){r[r.UTF8_BYTES=1]="UTF8_BYTES",r[r.UTF16_STRING=2]="UTF16_STRING"})(Q_||(Q_={}));class vu{constructor(e){this.bytes_=e,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(e){return new vu(new Uint8Array(e))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(e){this.position_=e}capacity(){return this.bytes_.length}readInt8(e){return this.readUint8(e)<<24>>24}readUint8(e){return this.bytes_[e]}readInt16(e){return this.readUint16(e)<<16>>16}readUint16(e){return this.bytes_[e]|this.bytes_[e+1]<<8}readInt32(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24}readUint32(e){return this.readInt32(e)>>>0}readInt64(e){return BigInt.asIntN(64,BigInt(this.readUint32(e))+(BigInt(this.readUint32(e+4))<<BigInt(32)))}readUint64(e){return BigInt.asUintN(64,BigInt(this.readUint32(e))+(BigInt(this.readUint32(e+4))<<BigInt(32)))}readFloat32(e){return _A[0]=this.readInt32(e),GE[0]}readFloat64(e){return _A[Qm?0:1]=this.readInt32(e),_A[Qm?1:0]=this.readInt32(e+4),VE[0]}writeInt8(e,t){this.bytes_[e]=t}writeUint8(e,t){this.bytes_[e]=t}writeInt16(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8}writeUint16(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8}writeInt32(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24}writeUint32(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24}writeInt64(e,t){this.writeInt32(e,Number(BigInt.asIntN(32,t))),this.writeInt32(e+4,Number(BigInt.asIntN(32,t>>BigInt(32))))}writeUint64(e,t){this.writeUint32(e,Number(BigInt.asUintN(32,t))),this.writeUint32(e+4,Number(BigInt.asUintN(32,t>>BigInt(32))))}writeFloat32(e,t){GE[0]=t,this.writeInt32(e,_A[0])}writeFloat64(e,t){VE[0]=t,this.writeInt32(e,_A[Qm?0:1]),this.writeInt32(e+4,_A[Qm?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+Cp+Ep)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let e="";for(let t=0;t<Ep;t++)e+=String.fromCharCode(this.readInt8(this.position_+Cp+t));return e}__offset(e,t){const n=e-this.readInt32(e);return t<this.readInt16(n)?this.readInt16(n+t):0}__union(e,t){return e.bb_pos=t+this.readInt32(t),e.bb=this,e}__string(e,t){e+=this.readInt32(e);const n=this.readInt32(e);e+=Cp;const i=this.bytes_.subarray(e,e+n);return t===Q_.UTF8_BYTES?i:this.text_decoder_.decode(i)}__union_with_string(e,t){return typeof e=="string"?this.__string(t):this.__union(e,t)}__indirect(e){return e+this.readInt32(e)}__vector(e){return e+this.readInt32(e)+Cp}__vector_len(e){return this.readInt32(e+this.readInt32(e))}__has_identifier(e){if(e.length!=Ep)throw new Error("FlatBuffers: file identifier must be length "+Ep);for(let t=0;t<Ep;t++)if(e.charCodeAt(t)!=this.readInt8(this.position()+Cp+t))return!1;return!0}createScalarList(e,t){const n=[];for(let i=0;i<t;++i){const s=e(i);s!==null&&n.push(s)}return n}createObjList(e,t){const n=[];for(let i=0;i<t;++i){const s=e(i);s!==null&&n.push(s.unpack())}return n}}let Tk=class Sa{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsGeometry(e,t){return(t||new Sa).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsGeometry(e,t){return e.setPosition(e.position()+Sp),(t||new Sa).__init(e.readInt32(e.position())+e.position(),e)}ends(e){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint32(this.bb.__vector(this.bb_pos+t)+e*4):0}endsLength(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}endsArray(){const e=this.bb.__offset(this.bb_pos,4);return e?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}xy(e){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readFloat64(this.bb.__vector(this.bb_pos+t)+e*8):0}xyLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}xyArray(){const e=this.bb.__offset(this.bb_pos,6);return e?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}z(e){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readFloat64(this.bb.__vector(this.bb_pos+t)+e*8):0}zLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}zArray(){const e=this.bb.__offset(this.bb_pos,8);return e?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}m(e){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readFloat64(this.bb.__vector(this.bb_pos+t)+e*8):0}mLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}mArray(){const e=this.bb.__offset(this.bb_pos,10);return e?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}t(e){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readFloat64(this.bb.__vector(this.bb_pos+t)+e*8):0}tLength(){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}tArray(){const e=this.bb.__offset(this.bb_pos,12);return e?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}tm(e){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readUint64(this.bb.__vector(this.bb_pos+t)+e*8):BigInt(0)}tmLength(){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}type(){const e=this.bb.__offset(this.bb_pos,16);return e?this.bb.readUint8(this.bb_pos+e):Is.Unknown}parts(e,t){const n=this.bb.__offset(this.bb_pos,18);return n?(t||new Sa).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+e*4),this.bb):null}partsLength(){const e=this.bb.__offset(this.bb_pos,18);return e?this.bb.__vector_len(this.bb_pos+e):0}static startGeometry(e){e.startObject(8)}static addEnds(e,t){e.addFieldOffset(0,t,0)}static createEndsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addInt32(t[n]);return e.endVector()}static startEndsVector(e,t){e.startVector(4,t,4)}static addXy(e,t){e.addFieldOffset(1,t,0)}static createXyVector(e,t){e.startVector(8,t.length,8);for(let n=t.length-1;n>=0;n--)e.addFloat64(t[n]);return e.endVector()}static startXyVector(e,t){e.startVector(8,t,8)}static addZ(e,t){e.addFieldOffset(2,t,0)}static createZVector(e,t){e.startVector(8,t.length,8);for(let n=t.length-1;n>=0;n--)e.addFloat64(t[n]);return e.endVector()}static startZVector(e,t){e.startVector(8,t,8)}static addM(e,t){e.addFieldOffset(3,t,0)}static createMVector(e,t){e.startVector(8,t.length,8);for(let n=t.length-1;n>=0;n--)e.addFloat64(t[n]);return e.endVector()}static startMVector(e,t){e.startVector(8,t,8)}static addT(e,t){e.addFieldOffset(4,t,0)}static createTVector(e,t){e.startVector(8,t.length,8);for(let n=t.length-1;n>=0;n--)e.addFloat64(t[n]);return e.endVector()}static startTVector(e,t){e.startVector(8,t,8)}static addTm(e,t){e.addFieldOffset(5,t,0)}static createTmVector(e,t){e.startVector(8,t.length,8);for(let n=t.length-1;n>=0;n--)e.addInt64(t[n]);return e.endVector()}static startTmVector(e,t){e.startVector(8,t,8)}static addType(e,t){e.addFieldInt8(6,t,Is.Unknown)}static addParts(e,t){e.addFieldOffset(7,t,0)}static createPartsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startPartsVector(e,t){e.startVector(4,t,4)}static endGeometry(e){return e.endObject()}static createGeometry(e,t,n,i,s,a,o,A,f){return Sa.startGeometry(e),Sa.addEnds(e,t),Sa.addXy(e,n),Sa.addZ(e,i),Sa.addM(e,s),Sa.addT(e,a),Sa.addTm(e,o),Sa.addType(e,A),Sa.addParts(e,f),Sa.endGeometry(e)}};function H_(r,e){const t=[];for(let n=0;n<r.length;n+=2){const i=[r[n],r[n+1]];e&&i.push(e[n>>1]),t.push(i)}return t}function jE(r,e,t){if(!t||t.length===0)return[H_(r,e)];let n=0;const i=Array.from(t).map(a=>r.slice(n,n=a<<1));let s;return e&&(n=0,s=Array.from(t).map(a=>e.slice(n,n=a))),i.map((a,o)=>H_(a,s?s[o]:void 0))}function Ik(r,e){const t=r.xyArray(),n=r.zArray();switch(e){case Is.Point:{const i=Array.from(t);return n&&i.push(n[0]),i}case Is.MultiPoint:case Is.LineString:return H_(t,n);case Is.MultiLineString:return jE(t,n,r.endsArray());case Is.Polygon:return jE(t,n,r.endsArray())}}function z_(r,e){let t=e;if(t===Is.Unknown&&(t=r.type()),t===Is.GeometryCollection){const i=[];for(let s=0;s<r.partsLength();s++){const a=r.parts(s),o=a.type();i.push(z_(a,o))}return{type:Is[t],geometries:i}}else if(t===Is.MultiPolygon){const i=[];for(let s=0;s<r.partsLength();s++)i.push(z_(r.parts(s),Is.Polygon));return{type:Is[t],coordinates:i.map(s=>s.coordinates)}}const n=Ik(r,t);return{type:Is[t],coordinates:n}}var Ls;(function(r){r[r.Byte=0]="Byte",r[r.UByte=1]="UByte",r[r.Bool=2]="Bool",r[r.Short=3]="Short",r[r.UShort=4]="UShort",r[r.Int=5]="Int",r[r.UInt=6]="UInt",r[r.Long=7]="Long",r[r.ULong=8]="ULong",r[r.Float=9]="Float",r[r.Double=10]="Double",r[r.String=11]="String",r[r.Json=12]="Json",r[r.DateTime=13]="DateTime",r[r.Binary=14]="Binary"})(Ls||(Ls={}));class Fs{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsColumn(e,t){return(t||new Fs).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsColumn(e,t){return e.setPosition(e.position()+Sp),(t||new Fs).__init(e.readInt32(e.position())+e.position(),e)}name(e){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}type(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb_pos+e):Ls.Byte}title(e){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}description(e){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__string(this.bb_pos+t,e):null}width(){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readInt32(this.bb_pos+e):-1}precision(){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readInt32(this.bb_pos+e):-1}scale(){const e=this.bb.__offset(this.bb_pos,16);return e?this.bb.readInt32(this.bb_pos+e):-1}nullable(){const e=this.bb.__offset(this.bb_pos,18);return e?!!this.bb.readInt8(this.bb_pos+e):!0}unique(){const e=this.bb.__offset(this.bb_pos,20);return e?!!this.bb.readInt8(this.bb_pos+e):!1}primaryKey(){const e=this.bb.__offset(this.bb_pos,22);return e?!!this.bb.readInt8(this.bb_pos+e):!1}metadata(e){const t=this.bb.__offset(this.bb_pos,24);return t?this.bb.__string(this.bb_pos+t,e):null}static startColumn(e){e.startObject(11)}static addName(e,t){e.addFieldOffset(0,t,0)}static addType(e,t){e.addFieldInt8(1,t,Ls.Byte)}static addTitle(e,t){e.addFieldOffset(2,t,0)}static addDescription(e,t){e.addFieldOffset(3,t,0)}static addWidth(e,t){e.addFieldInt32(4,t,-1)}static addPrecision(e,t){e.addFieldInt32(5,t,-1)}static addScale(e,t){e.addFieldInt32(6,t,-1)}static addNullable(e,t){e.addFieldInt8(7,+t,1)}static addUnique(e,t){e.addFieldInt8(8,+t,0)}static addPrimaryKey(e,t){e.addFieldInt8(9,+t,0)}static addMetadata(e,t){e.addFieldOffset(10,t,0)}static endColumn(e){const t=e.endObject();return e.requiredField(t,4),t}static createColumn(e,t,n,i,s,a,o,A,f,m,v,x){return Fs.startColumn(e),Fs.addName(e,t),Fs.addType(e,n),Fs.addTitle(e,i),Fs.addDescription(e,s),Fs.addWidth(e,a),Fs.addPrecision(e,o),Fs.addScale(e,A),Fs.addNullable(e,f),Fs.addUnique(e,m),Fs.addPrimaryKey(e,v),Fs.addMetadata(e,x),Fs.endColumn(e)}}class Rc{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFeature(e,t){return(t||new Rc).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFeature(e,t){return e.setPosition(e.position()+Sp),(t||new Rc).__init(e.readInt32(e.position())+e.position(),e)}geometry(e){const t=this.bb.__offset(this.bb_pos,4);return t?(e||new Tk).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}properties(e){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb.__vector(this.bb_pos+t)+e):0}propertiesLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}propertiesArray(){const e=this.bb.__offset(this.bb_pos,6);return e?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}columns(e,t){const n=this.bb.__offset(this.bb_pos,8);return n?(t||new Fs).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+e*4),this.bb):null}columnsLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}static startFeature(e){e.startObject(3)}static addGeometry(e,t){e.addFieldOffset(0,t,0)}static addProperties(e,t){e.addFieldOffset(1,t,0)}static createPropertiesVector(e,t){e.startVector(1,t.length,1);for(let n=t.length-1;n>=0;n--)e.addInt8(t[n]);return e.endVector()}static startPropertiesVector(e,t){e.startVector(1,t,1)}static addColumns(e,t){e.addFieldOffset(2,t,0)}static createColumnsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startColumnsVector(e,t){e.startVector(4,t,4)}static endFeature(e){return e.endObject()}static finishFeatureBuffer(e,t){e.finish(t)}static finishSizePrefixedFeatureBuffer(e,t){e.finish(t,void 0,!0)}static createFeature(e,t,n,i){return Rc.startFeature(e),Rc.addGeometry(e,t),Rc.addProperties(e,n),Rc.addColumns(e,i),Rc.endFeature(e)}}new TextEncoder;const qE=new TextDecoder;function Lk(r,e){const t={};if(!e||e.length===0)return t;const n=r.propertiesArray();if(!n)return t;const i=new DataView(n.buffer,n.byteOffset),s=r.propertiesLength();let a=0;for(;a<s;){const o=i.getUint16(a,!0);a+=2;const A=e[o],f=A.name;switch(A.type){case Ls.Bool:{t[f]=!!i.getUint8(a),a+=1;break}case Ls.Byte:{t[f]=i.getInt8(a),a+=1;break}case Ls.UByte:{t[f]=i.getUint8(a),a+=1;break}case Ls.Short:{t[f]=i.getInt16(a,!0),a+=2;break}case Ls.UShort:{t[f]=i.getUint16(a,!0),a+=2;break}case Ls.Int:{t[f]=i.getInt32(a,!0),a+=4;break}case Ls.UInt:{t[f]=i.getUint32(a,!0),a+=4;break}case Ls.Long:{t[f]=Number(i.getBigInt64(a,!0)),a+=8;break}case Ls.ULong:{t[f]=Number(i.getBigUint64(a,!0)),a+=8;break}case Ls.Float:{t[f]=i.getFloat32(a,!0),a+=4;break}case Ls.Double:{t[f]=i.getFloat64(a,!0),a+=8;break}case Ls.DateTime:case Ls.String:{const m=i.getUint32(a,!0);a+=4,t[f]=qE.decode(n.subarray(a,a+m)),a+=m;break}case Ls.Json:{const m=i.getUint32(a,!0);a+=4;const v=qE.decode(n.subarray(a,a+m));t[f]=JSON.parse(v),a+=m;break}default:throw new Error("Unknown type "+A.type)}}return t}function G_(r,e){const t=e.columns;return{type:"Feature",geometry:z_(r.geometry(),e.geometryType),properties:Lk(r,t)}}const V_=new Uint8Array(0);function Fk(){return this._source.cancel()}function Mk(r,e){if(!r.length)return e;if(!e.length)return r;var t=new Uint8Array(r.length+e.length);return t.set(r),t.set(e,r.length),t}function Pk(){var r=this,e=r._array.subarray(r._index);return r._source.read().then(function(t){return r._array=V_,r._index=0,t.done?e.length>0?{done:!1,value:e}:{done:!0,value:void 0}:{done:!1,value:Mk(e,t.value)}})}function Uk(r){if((r|=0)<0)throw new Error("invalid length");var e=this,t=this._array.length-this._index;if(this._index+r<=this._array.length)return Promise.resolve(this._array.subarray(this._index,this._index+=r));var n=new Uint8Array(r);return n.set(this._array.subarray(this._index)),function i(){return e._source.read().then(function(s){return s.done?(e._array=V_,e._index=0,t>0?n.subarray(0,t):null):t+s.value.length>=r?(e._array=s.value,e._index=r-t,n.set(s.value.subarray(0,r-t),t),n):(n.set(s.value,t),t+=s.value.length,i())})}()}function Rk(r){return typeof r.slice=="function"?r:new Hm(typeof r.read=="function"?r:r.getReader())}function Hm(r){this._source=r,this._array=V_,this._index=0}Hm.prototype.read=Pk,Hm.prototype.slice=Uk,Hm.prototype.cancel=Fk;class Za{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsCrs(e,t){return(t||new Za).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsCrs(e,t){return e.setPosition(e.position()+Sp),(t||new Za).__init(e.readInt32(e.position())+e.position(),e)}org(e){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}code(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):0}name(e){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}description(e){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__string(this.bb_pos+t,e):null}wkt(e){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__string(this.bb_pos+t,e):null}codeString(e){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__string(this.bb_pos+t,e):null}static startCrs(e){e.startObject(6)}static addOrg(e,t){e.addFieldOffset(0,t,0)}static addCode(e,t){e.addFieldInt32(1,t,0)}static addName(e,t){e.addFieldOffset(2,t,0)}static addDescription(e,t){e.addFieldOffset(3,t,0)}static addWkt(e,t){e.addFieldOffset(4,t,0)}static addCodeString(e,t){e.addFieldOffset(5,t,0)}static endCrs(e){return e.endObject()}static createCrs(e,t,n,i,s,a,o){return Za.startCrs(e),Za.addOrg(e,t),Za.addCode(e,n),Za.addName(e,i),Za.addDescription(e,s),Za.addWkt(e,a),Za.addCodeString(e,o),Za.endCrs(e)}}class zm{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsHeader(e,t){return(t||new zm).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsHeader(e,t){return e.setPosition(e.position()+Sp),(t||new zm).__init(e.readInt32(e.position())+e.position(),e)}name(e){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}envelope(e){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readFloat64(this.bb.__vector(this.bb_pos+t)+e*8):0}envelopeLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}envelopeArray(){const e=this.bb.__offset(this.bb_pos,6);return e?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}geometryType(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readUint8(this.bb_pos+e):Is.Unknown}hasZ(){const e=this.bb.__offset(this.bb_pos,10);return e?!!this.bb.readInt8(this.bb_pos+e):!1}hasM(){const e=this.bb.__offset(this.bb_pos,12);return e?!!this.bb.readInt8(this.bb_pos+e):!1}hasT(){const e=this.bb.__offset(this.bb_pos,14);return e?!!this.bb.readInt8(this.bb_pos+e):!1}hasTm(){const e=this.bb.__offset(this.bb_pos,16);return e?!!this.bb.readInt8(this.bb_pos+e):!1}columns(e,t){const n=this.bb.__offset(this.bb_pos,18);return n?(t||new Fs).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+e*4),this.bb):null}columnsLength(){const e=this.bb.__offset(this.bb_pos,18);return e?this.bb.__vector_len(this.bb_pos+e):0}featuresCount(){const e=this.bb.__offset(this.bb_pos,20);return e?this.bb.readUint64(this.bb_pos+e):BigInt("0")}indexNodeSize(){const e=this.bb.__offset(this.bb_pos,22);return e?this.bb.readUint16(this.bb_pos+e):16}crs(e){const t=this.bb.__offset(this.bb_pos,24);return t?(e||new Za).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}title(e){const t=this.bb.__offset(this.bb_pos,26);return t?this.bb.__string(this.bb_pos+t,e):null}description(e){const t=this.bb.__offset(this.bb_pos,28);return t?this.bb.__string(this.bb_pos+t,e):null}metadata(e){const t=this.bb.__offset(this.bb_pos,30);return t?this.bb.__string(this.bb_pos+t,e):null}static startHeader(e){e.startObject(14)}static addName(e,t){e.addFieldOffset(0,t,0)}static addEnvelope(e,t){e.addFieldOffset(1,t,0)}static createEnvelopeVector(e,t){e.startVector(8,t.length,8);for(let n=t.length-1;n>=0;n--)e.addFloat64(t[n]);return e.endVector()}static startEnvelopeVector(e,t){e.startVector(8,t,8)}static addGeometryType(e,t){e.addFieldInt8(2,t,Is.Unknown)}static addHasZ(e,t){e.addFieldInt8(3,+t,0)}static addHasM(e,t){e.addFieldInt8(4,+t,0)}static addHasT(e,t){e.addFieldInt8(5,+t,0)}static addHasTm(e,t){e.addFieldInt8(6,+t,0)}static addColumns(e,t){e.addFieldOffset(7,t,0)}static createColumnsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startColumnsVector(e,t){e.startVector(4,t,4)}static addFeaturesCount(e,t){e.addFieldInt64(8,t,BigInt("0"))}static addIndexNodeSize(e,t){e.addFieldInt16(9,t,16)}static addCrs(e,t){e.addFieldOffset(10,t,0)}static addTitle(e,t){e.addFieldOffset(11,t,0)}static addDescription(e,t){e.addFieldOffset(12,t,0)}static addMetadata(e,t){e.addFieldOffset(13,t,0)}static endHeader(e){return e.endObject()}static finishHeaderBuffer(e,t){e.finish(t)}static finishSizePrefixedHeaderBuffer(e,t){e.finish(t,void 0,!0)}}function j_(r){const e=zm.getRootAsHeader(r),t=e.featuresCount(),n=e.indexNodeSize(),i=[];for(let A=0;A<e.columnsLength();A++){const f=e.columns(A);if(!f)throw new Error("Column unexpectedly missing");if(!f.name())throw new Error("Column name unexpectedly missing");i.push({name:f.name(),type:f.type(),title:f.title(),description:f.description(),width:f.width(),precision:f.precision(),scale:f.scale(),nullable:f.nullable(),unique:f.unique(),primary_key:f.primaryKey()})}const s=e.crs(),a=s?{org:s.org(),code:s.code(),name:s.name(),description:s.description(),wkt:s.wkt(),code_string:s.codeString()}:null;return{geometryType:e.geometryType(),columns:i,envelope:null,featuresCount:Number(t),indexNodeSize:n,crs:a,title:e.title(),description:e.description(),metadata:e.metadata()}}/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var q_=function(r,e){return q_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])},q_(r,e)};function Ok(r,e){q_(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Md(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(m){try{f(n.next(m))}catch(v){a(v)}}function A(m){try{f(n.throw(m))}catch(v){a(v)}}function f(m){m.done?s(m.value):i(m.value).then(o,A)}f((n=n.apply(r,e||[])).next())})}function vA(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(f){return function(m){return A([f,m])}}function A(f){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return t.label++,{value:f[1],done:!1};case 5:t.label++,i=f[1],f=[0];continue;case 7:f=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){t=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){t.label=f[1];break}if(f[0]===6&&t.label<s[1]){t.label=s[1],s=f;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(f);break}s[2]&&t.ops.pop(),t.trys.pop();continue}f=e.call(r,t)}catch(m){f=[6,m],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Pd(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Tp(r){return this instanceof Tp?(this.v=r,this):new Tp(r)}function Dk(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(x){n[x]&&(i[x]=function(B){return new Promise(function(M,U){s.push([x,B,M,U])>1||o(x,B)})})}function o(x,B){try{A(n[x](B))}catch(M){v(s[0][3],M)}}function A(x){x.value instanceof Tp?Promise.resolve(x.value.v).then(f,m):v(s[0][2],x)}function f(x){o("next",x)}function m(x){o("throw",x)}function v(x,B){x(B),s.shift(),s.length&&o(s[0][0],s[0][1])}}var KE=function(r){Ok(e,r);function e(t){var n=r.call(this,t)||this;return Object.defineProperty(n,"name",{value:"RepeaterOverflowError",enumerable:!1}),typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(n,n.constructor.prototype):n.__proto__=n.constructor.prototype,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(n,n.constructor),n}return e}(Error);(function(){function r(e){if(e<0)throw new RangeError("Capacity may not be less than 0");this._c=e,this._q=[]}return Object.defineProperty(r.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"full",{get:function(){return this._q.length>=this._c},enumerable:!1,configurable:!0}),r.prototype.add=function(e){if(this.full)throw new Error("Buffer full");this._q.push(e)},r.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},r})(),function(){function r(e){if(e<1)throw new RangeError("Capacity may not be less than 1");this._c=e,this._q=[]}return Object.defineProperty(r.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"full",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.add=function(e){for(;this._q.length>=this._c;)this._q.shift();this._q.push(e)},r.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},r}(),function(){function r(e){if(e<1)throw new RangeError("Capacity may not be less than 1");this._c=e,this._q=[]}return Object.defineProperty(r.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"full",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.add=function(e){this._q.length<this._c&&this._q.push(e)},r.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},r}();function K_(r){r!=null&&typeof r.then=="function"&&r.then(jm,jm)}var W_=0,WE=1,wh=2,Gm=3,$_=4,Vm=1024,jm=function(){};function Ud(r){var e=r.err,t=Promise.resolve(r.execution).then(function(n){if(e!=null)throw e;return n});return r.err=void 0,r.execution=t.then(function(){},function(){}),r.pending===void 0?t:r.pending.then(function(){return t})}function xh(r,e){var t=r.state>=Gm;return Promise.resolve(e).then(function(n){return!t&&r.state>=$_?Ud(r).then(function(i){return{value:i,done:!0}}):{value:n,done:t}})}function X_(r,e){var t,n;if(!(r.state>=wh))if(r.state=wh,r.onnext(),r.onstop(),r.err==null&&(r.err=e),r.pushes.length===0&&(typeof r.buffer>"u"||r.buffer.empty))Ip(r);else try{for(var i=Pd(r.pushes),s=i.next();!s.done;s=i.next()){var a=s.value;a.resolve()}}catch(o){t={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}function Ip(r){var e,t;if(!(r.state>=Gm)){r.state<wh&&X_(r),r.state=Gm,r.buffer=void 0;try{for(var n=Pd(r.nexts),i=n.next();!i.done;i=n.next()){var s=i.value,a=r.pending===void 0?Ud(r):r.pending.then(function(){return Ud(r)});s.resolve(xh(r,a))}}catch(o){e={error:o}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}r.pushes=[],r.nexts=[]}}function $E(r){r.state>=$_||(r.state<Gm&&Ip(r),r.state=$_)}function kk(r,e){if(K_(e),r.pushes.length>=Vm)throw new KE("No more than "+Vm+" pending calls to push are allowed on a single repeater.");if(r.state>=wh)return Promise.resolve(void 0);var t=r.pending===void 0?Promise.resolve(e):r.pending.then(function(){return e});t=t.catch(function(A){r.state<wh&&(r.err=A),$E(r)});var n;if(r.nexts.length){var i=r.nexts.shift();i.resolve(xh(r,t)),r.nexts.length?n=Promise.resolve(r.nexts[0].value):n=new Promise(function(A){return r.onnext=A})}else typeof r.buffer<"u"&&!r.buffer.full?(r.buffer.add(t),n=Promise.resolve(void 0)):n=new Promise(function(A){return r.pushes.push({resolve:A,value:t})});var s=!0,a={},o=n.catch(function(A){if(s)throw A});return a.then=function(A,f){return s=!1,Promise.prototype.then.call(n,A,f)},a.catch=function(A){return s=!1,Promise.prototype.catch.call(n,A)},a.finally=n.finally.bind(n),r.pending=t.then(function(){return o}).catch(function(A){r.err=A,$E(r)}),a}function Nk(r){var e=X_.bind(null,r),t=new Promise(function(n){return r.onstop=n});return e.then=t.then.bind(t),e.catch=t.catch.bind(t),e.finally=t.finally.bind(t),e}function Qk(r){if(!(r.state>=WE)){r.state=WE;var e=kk.bind(null,r),t=Nk(r);r.execution=new Promise(function(n){return n(r.executor(e,t))}),r.execution.catch(function(){return X_(r)})}}var qm=new WeakMap,Lp=function(){function r(e,t){qm.set(this,{executor:e,buffer:t,err:void 0,state:W_,pushes:[],nexts:[],pending:void 0,execution:void 0,onnext:jm,onstop:jm})}return r.prototype.next=function(e){K_(e);var t=qm.get(this);if(t===void 0)throw new Error("WeakMap error");if(t.nexts.length>=Vm)throw new KE("No more than "+Vm+" pending calls to next are allowed on a single repeater.");if(t.state<=W_&&Qk(t),t.onnext(e),typeof t.buffer<"u"&&!t.buffer.empty){var n=xh(t,t.buffer.remove());if(t.pushes.length){var i=t.pushes.shift();t.buffer.add(i.value),t.onnext=i.resolve}return n}else if(t.pushes.length){var s=t.pushes.shift();return t.onnext=s.resolve,xh(t,s.value)}else if(t.state>=wh)return Ip(t),xh(t,Ud(t));return new Promise(function(a){return t.nexts.push({resolve:a,value:e})})},r.prototype.return=function(e){K_(e);var t=qm.get(this);if(t===void 0)throw new Error("WeakMap error");return Ip(t),t.execution=Promise.resolve(t.execution).then(function(){return e}),xh(t,Ud(t))},r.prototype.throw=function(e){var t=qm.get(this);if(t===void 0)throw new Error("WeakMap error");return t.state<=W_||t.state>=wh||typeof t.buffer<"u"&&!t.buffer.empty?(Ip(t),t.err==null&&(t.err=e),xh(t,Ud(t))):this.next(Promise.reject(e))},r.prototype[Symbol.asyncIterator]=function(){return this},r.race=Hk,r.merge=zk,r.zip=Gk,r.latest=Vk,r}();function Km(r,e){var t,n,i=[],s=function(f){f!=null&&typeof f[Symbol.asyncIterator]=="function"?i.push(f[Symbol.asyncIterator]()):f!=null&&typeof f[Symbol.iterator]=="function"?i.push(f[Symbol.iterator]()):i.push(function(){return Dk(this,arguments,function(){return vA(this,function(x){switch(x.label){case 0:return e.yieldValues?[4,Tp(f)]:[3,3];case 1:return[4,x.sent()];case 2:x.sent(),x.label=3;case 3:return e.returnValues?[4,Tp(f)]:[3,5];case 4:return[2,x.sent()];case 5:return[2]}})})}())};try{for(var a=Pd(r),o=a.next();!o.done;o=a.next()){var A=o.value;s(A)}}catch(f){t={error:f}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return i}function Hk(r){var e=this,t=Km(r,{returnValues:!0});return new Lp(function(n,i){return Md(e,void 0,void 0,function(){var s,a,o,A,f,m;return vA(this,function(v){switch(v.label){case 0:if(!t.length)return i(),[2];a=!1,i.then(function(){s(),a=!0}),v.label=1;case 1:v.trys.push([1,,5,7]),A=void 0,f=0,m=function(){var x,B,M,U,N,Q;return vA(this,function(q){switch(q.label){case 0:x=f;try{for(B=(N=void 0,Pd(t)),M=B.next();!M.done;M=B.next())U=M.value,Promise.resolve(U.next()).then(function(Y){Y.done?(i(),o===void 0&&(o=Y)):f===x&&(f++,s(Y))},function(Y){return i(Y)})}catch(Y){N={error:Y}}finally{try{M&&!M.done&&(Q=B.return)&&Q.call(B)}finally{if(N)throw N.error}}return[4,new Promise(function(Y){return s=Y})];case 1:return A=q.sent(),A===void 0?[3,3]:[4,n(A.value)];case 2:q.sent(),q.label=3;case 3:return[2]}})},v.label=2;case 2:return a?[3,4]:[5,m()];case 3:return v.sent(),[3,2];case 4:return[2,o&&o.value];case 5:return i(),[4,Promise.race(t.map(function(x){return x.return&&x.return()}))];case 6:return v.sent(),[7];case 7:return[2]}})})})}function zk(r){var e=this,t=Km(r,{yieldValues:!0});return new Lp(function(n,i){return Md(e,void 0,void 0,function(){var s,a,o,A=this;return vA(this,function(f){switch(f.label){case 0:if(!t.length)return i(),[2];s=[],a=!1,i.then(function(){var m,v;a=!0;try{for(var x=Pd(s),B=x.next();!B.done;B=x.next()){var M=B.value;M()}}catch(U){m={error:U}}finally{try{B&&!B.done&&(v=x.return)&&v.call(x)}finally{if(m)throw m.error}}}),f.label=1;case 1:return f.trys.push([1,,3,4]),[4,Promise.all(t.map(function(m,v){return Md(A,void 0,void 0,function(){var x,B;return vA(this,function(M){switch(M.label){case 0:M.trys.push([0,,6,9]),M.label=1;case 1:return a?[3,5]:(Promise.resolve(m.next()).then(function(U){return s[v](U)},function(U){return i(U)}),[4,new Promise(function(U){s[v]=U})]);case 2:return x=M.sent(),x===void 0?[3,4]:x.done?(o=x,[2]):[4,n(x.value)];case 3:M.sent(),M.label=4;case 4:return[3,1];case 5:return[3,9];case 6:return B=m.return,B?[4,m.return()]:[3,8];case 7:B=M.sent(),M.label=8;case 8:return[7];case 9:return[2]}})})}))];case 2:return f.sent(),[2,o&&o.value];case 3:return i(),[7];case 4:return[2]}})})})}function Gk(r){var e=this,t=Km(r,{returnValues:!0});return new Lp(function(n,i){return Md(e,void 0,void 0,function(){var s,a,o,A;return vA(this,function(f){switch(f.label){case 0:if(!t.length)return i(),[2,[]];a=!1,i.then(function(){s(),a=!0}),f.label=1;case 1:f.trys.push([1,,6,8]),f.label=2;case 2:return a?[3,5]:(Promise.all(t.map(function(m){return m.next()})).then(function(m){return s(m)},function(m){return i(m)}),[4,new Promise(function(m){return s=m})]);case 3:return o=f.sent(),o===void 0?[2]:(A=o.map(function(m){return m.value}),o.some(function(m){return m.done})?[2,A]:[4,n(A)]);case 4:return f.sent(),[3,2];case 5:return[3,8];case 6:return i(),[4,Promise.all(t.map(function(m){return m.return&&m.return()}))];case 7:return f.sent(),[7];case 8:return[2]}})})})}function Vk(r){var e=this,t=Km(r,{yieldValues:!0,returnValues:!0});return new Lp(function(n,i){return Md(e,void 0,void 0,function(){var s,a,o,A,f,m=this;return vA(this,function(v){switch(v.label){case 0:if(!t.length)return i(),[2,[]];a=[],o=!1,i.then(function(){var x,B;s();try{for(var M=Pd(a),U=M.next();!U.done;U=M.next()){var N=U.value;N()}}catch(Q){x={error:Q}}finally{try{U&&!U.done&&(B=M.return)&&B.call(M)}finally{if(x)throw x.error}}o=!0}),v.label=1;case 1:return v.trys.push([1,,5,7]),Promise.all(t.map(function(x){return x.next()})).then(function(x){return s(x)},function(x){return i(x)}),[4,new Promise(function(x){return s=x})];case 2:return A=v.sent(),A===void 0?[2]:(f=A.map(function(x){return x.value}),A.every(function(x){return x.done})?[2,f]:[4,n(f.slice())]);case 3:return v.sent(),[4,Promise.all(t.map(function(x,B){return Md(m,void 0,void 0,function(){var M;return vA(this,function(U){switch(U.label){case 0:if(A[B].done)return[2,A[B].value];U.label=1;case 1:return o?[3,4]:(Promise.resolve(x.next()).then(function(N){return a[B](N)},function(N){return i(N)}),[4,new Promise(function(N){return a[B]=N})]);case 2:return M=U.sent(),M===void 0?[2,A[B].value]:M.done?[2,M.value]:(f[B]=M.value,[4,n(f.slice())]);case 3:return U.sent(),[3,1];case 4:return[2]}})})}))];case 4:return[2,v.sent()];case 5:return i(),[4,Promise.all(t.map(function(x){return x.return&&x.return()}))];case 6:return v.sent(),[7];case 7:return[2]}})})})}class Wm{constructor(){this._extraRequestThreshold=256*1024}extraRequestThreshold(){return this._extraRequestThreshold}setExtraRequestThreshold(e){if(e<0)throw new Error("extraRequestThreshold cannot be negative");this._extraRequestThreshold=e}}Wm.global=new Wm;var Oc;(function(r){r[r.Debug=0]="Debug",r[r.Info=1]="Info",r[r.Warn=2]="Warn",r[r.Error=3]="Error"})(Oc||(Oc={}));class Ms{static debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log(Oc.Debug,...t)}static info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log(Oc.Info,...t)}static warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log(Oc.Warn,...t)}static error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log(Oc.Error,...t)}static log(e){if(!(this.logLevel>e)){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];switch(e){case Oc.Debug:{console.debug(...n);break}case Oc.Info:{console.info(...n);break}case Oc.Warn:{console.warn(...n);break}case Oc.Error:{console.error(...n);break}}}}}Ms.logLevel=Oc.Warn;const Bh=8*4+8,jk=16;function J_(r,e){e=Math.min(Math.max(+e,2),65535);let t=r,n=t;do t=Math.ceil(t/e),n+=t;while(t!==1);return n*Bh}function qk(r,e){if(e<2)throw new Error("Node size must be at least 2");if(r===0)throw new Error("Number of items must be greater than 0");let t=r,n=t;const i=[t];do t=Math.ceil(t/e),n+=t,i.push(t);while(t!==1);const s=[];t=n;for(const o of i)s.push(t-o),t-=o;const a=[];for(let o=0;o<i.length;o++)a.push([s[o],s[o]+i[o]]);return a}async function*Kk(r,e,t,n){class i{constructor(M,U){this._level=U,this.nodes=M}level(){return this._level}startNodeIdx(){return this.nodes[0]}endNodeIdx(){return this.nodes[1]}extendEndNodeIdx(M){console.assert(M>this.nodes[1]),this.nodes[1]=M}toString(){return`[NodeRange level: ${this._level}, nodes: ${this.nodes[0]}-${this.nodes[1]}]`}}const{minX:s,minY:a,maxX:o,maxY:A}=t;Ms.info(`tree items: ${r}, nodeSize: ${e}`);const f=qk(r,e),m=f[0][0],x=[(()=>{const B=[0,1],M=f.length-1;return new i(B,M)})()];for(Ms.debug(`starting stream search with queue: ${x}, numItems: ${r}, nodeSize: ${e}, levelBounds: ${f}`);x.length!=0;){const B=x.shift();Ms.debug(`popped node: ${B}, queueLength: ${x.length}`);const M=B.startNodeIdx(),U=M>=m,N=(()=>{const[,te]=f[B.level()],pe=Math.min(B.endNodeIdx()+e,te);return U&&pe<te?pe+1:pe})(),Q=N-M,q=await n(M*Bh,Q*Bh),Y=new DataView(q);for(let te=M;te<N;te++){const pe=te-M,ge=pe*Bh;if(o<Y.getFloat64(ge+0,!0)||A<Y.getFloat64(ge+8,!0)||s>Y.getFloat64(ge+16,!0)||a>Y.getFloat64(ge+24,!0))continue;const ye=Y.getBigUint64(ge+32,!0);if(U){const le=ye,xe=(()=>{if(te<r-1){const tt=(pe+1)*Bh;return Y.getBigUint64(tt+32,!0)-le}else return null})(),_e=te-m;yield[Number(le),_e,Number(xe)];continue}const fe=ye,Oe=Wm.global.extraRequestThreshold()/Bh,Fe=x[x.length-1];if(Fe!==void 0&&Fe.level()==B.level()-1&&fe<Fe.endNodeIdx()+Oe){Ms.debug(`Merging "nodeRange" request into existing range: ${Fe}, newEndNodeIdx: ${Fe.endNodeIdx()} -> ${fe}`),Fe.extendEndNodeIdx(Number(fe));continue}const oe=(()=>{const le=B.level()-1,xe=[Number(fe),Number(fe)+1];return new i(xe,le)})();Fe!==void 0&&Fe.level()==oe.level()?Ms.info(`Same level, but too far away. Pushing new request for nodeIdx: ${fe} rather than merging with distant ${Fe}`):Ms.info(`Pushing new level for ${oe} onto queue with nearestNodeRange: ${Fe} since there's not already a range for this level.`),x.push(oe)}}}const bA=new Uint8Array([102,103,98,3,102,103,98,0]),bu=4;class Y_{constructor(e,t,n,i){this.headerClient=e,this.header=t,this.headerLength=n,this.indexLength=i}static async open(e){const n=new XE(e),i=(()=>{const v=jk,x=3;let B=0,M;for(M=0;M<x;M++){const U=v**M*Bh;B+=U}return B})(),s=2024+i;Ms.debug(`fetching header. minReqLength: ${s} (assumedHeaderLength: 2024, assumedIndexLength: ${i})`);{const v=new Uint8Array(await n.getRange(0,8,s,"header"));if(!v.subarray(0,3).every((x,B)=>bA[B]===x))throw Ms.error(`bytes: ${v} != ${bA}`),new Error("Not a FlatGeobuf file");Ms.debug("magic bytes look good")}let a;{const v=await n.getRange(8,4,s,"header");a=new DataView(v).getUint32(0,!0);const x=1048576*10;if(a>x||a<8)throw new Error("Invalid header size");Ms.debug(`headerLength: ${a}`)}const o=await n.getRange(12,a,s,"header"),A=new vu(new Uint8Array(o)),f=j_(A),m=J_(f.featuresCount,f.indexNodeSize);return Ms.debug("completed: opening http reader"),new Y_(n,f,a,m)}async*selectBbox(e){const t=this.lengthBeforeTree(),n=this.headerClient,i=async function(A,f){return n.getRange(t+A,f,0,"index")},s=[];let a=[];for await(const A of Kk(this.header.featuresCount,this.header.indexNodeSize,e,i)){const[f,,]=A;let[,,m]=A;if(m||(Ms.info("final feature"),m=4),a.length==0){a.push([f,m]);continue}const v=a[a.length-1],x=f-(v[0]+v[1]);x>Wm.global.extraRequestThreshold()&&(Ms.info(`Pushing new feature batch, since gap ${x} was too large`),s.push(a),a=[]),a.push([f,m])}this.headerClient.logUsage("header+index"),a.length>0&&s.push(a);const o=s.flatMap(A=>this.readFeatureBatch(A));yield*Lp.merge(o)}lengthBeforeTree(){return bA.length+bu+this.headerLength}lengthBeforeFeatures(){return this.lengthBeforeTree()+this.indexLength}buildFeatureClient(){return new XE(this.headerClient.httpClient)}async*readFeatureBatch(e){const[t]=e[0],[n,i]=e[e.length-1],s=t,o=n+i-s,A=this.buildFeatureClient();let f=o;for(const[m]of e)yield await this.readFeature(A,m,f),f=0;A.logUsage("feature")}async readFeature(e,t,n){const i=t+this.lengthBeforeFeatures();let s;{const m=await e.getRange(i,4,n,"feature length");s=new DataView(m).getUint32(0,!0)}const a=await e.getRange(i+4,s,n,"feature data"),o=new Uint8Array(a),A=new Uint8Array(s+bu);A.set(o,bu);const f=new vu(A);return f.setPosition(bu),Rc.getRootAsFeature(f)}}class XE{constructor(e){if(this.bytesEverUsed=0,this.bytesEverFetched=0,this.buffer=new ArrayBuffer(0),this.head=0,typeof e=="string")this.httpClient=new JE(e);else if(e instanceof JE)this.httpClient=e;else throw new Error("Unknown source ")}async getRange(e,t,n,i){this.bytesEverUsed+=t;const s=e-this.head,a=s+t;if(s>=0&&a<=this.buffer.byteLength)return this.buffer.slice(s,a);const o=Math.max(t,n);return this.bytesEverFetched+=o,Ms.debug(`requesting for new Range: ${e}-${e+o-1}`),this.buffer=await this.httpClient.getRange(e,o,i),this.head=e,this.buffer.slice(0,t)}logUsage(e){const t=e.split(" ")[0],n=this.bytesEverUsed,i=this.bytesEverFetched,s=(100*n/i).toFixed(2);Ms.info(`${t} bytes used/requested: ${n} / ${i} = ${s}%`)}}class JE{constructor(e){this.requestsEverMade=0,this.bytesEverRequested=0,this.url=e}async getRange(e,t,n){this.requestsEverMade+=1,this.bytesEverRequested+=t;const i=`bytes=${e}-${e+t-1}`;return Ms.info(`request: #${this.requestsEverMade}, purpose: ${n}), bytes: (this_request: ${t}, ever: ${this.bytesEverRequested}), Range: ${i}`),(await fetch(this.url,{headers:{Range:i}})).arrayBuffer()}}function Wk(r,e,t){if(!r.subarray(0,3).every((m,v)=>bA[v]===m))throw new Error("Not a FlatGeobuf file");const n=new vu(r),i=n.readUint32(bA.length);n.setPosition(bA.length+bu);const s=j_(n);t&&t(s);let a=bA.length+bu+i;const{indexNodeSize:o,featuresCount:A}=s;o>0&&(a+=J_(A,o));const f=[];for(;a<n.capacity();){const m=n.readUint32(a);n.setPosition(a+bu);const v=Rc.getRootAsFeature(n);f.push(e(v,s)),a+=bu+m}return f}async function*$k(r,e,t){const n=Rk(r),i=async x=>await n.slice(x);let s=new Uint8Array(await i(8));if(!s.subarray(0,3).every((x,B)=>bA[B]===x))throw new Error("Not a FlatGeobuf file");s=new Uint8Array(await i(4));let a=new vu(s);const o=a.readUint32(0);s=new Uint8Array(await i(o)),a=new vu(s);const A=j_(a);t&&t(A);const{indexNodeSize:f,featuresCount:m}=A;if(f>0){const x=J_(m,f);await i(x)}let v;for(;v=await Jk(i,A,e);)yield v}async function*Xk(r,e,t,n){const i=await Y_.open(r);Ms.debug("opened reader"),n&&n(i.header);for await(const s of i.selectBbox(e))yield t(s,i.header)}async function Jk(r,e,t){let n=new Uint8Array(await r(4,"feature length"));if(n.byteLength===0)return;let i=new vu(n);const s=i.readUint32(0);n=new Uint8Array(await r(s,"feature data"));const a=new Uint8Array(s+4);a.set(n,4),i=new vu(a),i.setPosition(bu);const o=Rc.getRootAsFeature(i);return t(o,e)}function Yk(r,e){return{type:"FeatureCollection",features:Wk(r,G_,e)}}function Zk(r,e){return $k(r,G_,e)}function eN(r,e,t){return Xk(r,e,G_,t)}function YE(r,e,t){return r instanceof Uint8Array?Yk(r,t):r instanceof ReadableStream?Zk(r,t):eN(r,e,t)}class tN{constructor(){this._bearing=0,this._pitch=60,this._minpitchzoom=null}onAdd(e){this._map=e;let t=this;return this._btn=document.createElement("button"),this._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-3d",this._btn.id="bt3D",this._btn.type="button",this._btn["aria-label"]="Vista 3D",this._btn.onclick=function(){if(t._btn.className.indexOf("3d")!=-1){let f={pitch:t._pitch,bearing:t._bearing};t._minpitchzoom&&e.getZoom()>t._minpitchzoom&&(f.zoom=t._minpitchzoom);var n=0,i=38.5,s=6,a=62.33,{longitude:o,latitude:A}=e.getCenter();e.getZoom()<10?e.setTerrain({source:"terrainMapZen",exaggeration:1.5}):o>=n&&o<=s&&A>=i&&A<=a?e.setTerrain({source:"terrainICGC",exaggeration:1.2}):e.setTerrain({source:"terrainMapZen",exaggeration:1.5}),e.easeTo(f),t._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-2d"}else e.setTerrain(null),e.easeTo({pitch:0,bearing:0}),t._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-3d"},this._container=document.createElement("div"),this._container.className="maplibregl-ctrl maplibregl-ctrl-group",this._container.title="Vista 3D",this._container.appendChild(this._btn),this._container}onRemove(){this._container.parentNode.removeChild(this._container),this._map=void 0}}function Fp(r){"@babel/helpers - typeof";return Fp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fp(r)}function rN(r,e){if(Fp(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(Fp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function nN(r){var e=rN(r,"string");return Fp(e)=="symbol"?e:String(e)}function W(r,e,t){return e=nN(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function ci(r,e){if(!r)throw new Error(e||"loader assertion failed.")}const $m=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),ZE=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);ZE&&parseFloat(ZE[1]);const iN="3.4.14";function Ol(r,e){if(!r)throw new Error(e||"loaders.gl assertion failed.")}const Z_={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},sN=Z_.global||Z_.self||Z_.window||{},wu=typeof process!="object"||String(process)!=="[object process]"||process.browser,ev=typeof importScripts=="function",oN=typeof window<"u"&&typeof window.orientation<"u",eS=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);eS&&parseFloat(eS[1]);class aN{constructor(e,t){W(this,"name",void 0),W(this,"workerThread",void 0),W(this,"isRunning",!0),W(this,"result",void 0),W(this,"_resolve",()=>{}),W(this,"_reject",()=>{}),this.name=e,this.workerThread=t,this.result=new Promise((n,i)=>{this._resolve=n,this._reject=i})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){Ol(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Ol(this.isRunning),this.isRunning=!1,this._reject(e)}}let tv=class{terminate(){}};const rv=new Map;function cN(r){Ol(r.source&&!r.url||!r.source&&r.url);let e=rv.get(r.source||r.url);return e||(r.url&&(e=lN(r.url),rv.set(r.url,e)),r.source&&(e=tS(r.source),rv.set(r.source,e))),Ol(e),e}function lN(r){if(!r.startsWith("http"))return r;const e=uN(r);return tS(e)}function tS(r){const e=new Blob([r],{type:"application/javascript"});return URL.createObjectURL(e)}function uN(r){return`try {
  importScripts('`.concat(r,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function rS(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2?arguments[2]:void 0;const n=t||new Set;if(r){if(nS(r))n.add(r);else if(nS(r.buffer))n.add(r.buffer);else if(!ArrayBuffer.isView(r)){if(e&&typeof r=="object")for(const i in r)rS(r[i],e,n)}}return t===void 0?Array.from(n):[]}function nS(r){return r?r instanceof ArrayBuffer||typeof MessagePort<"u"&&r instanceof MessagePort||typeof ImageBitmap<"u"&&r instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas:!1}const nv=()=>{};class iv{static isSupported(){return typeof Worker<"u"&&wu||typeof tv<"u"&&!wu}constructor(e){W(this,"name",void 0),W(this,"source",void 0),W(this,"url",void 0),W(this,"terminated",!1),W(this,"worker",void 0),W(this,"onMessage",void 0),W(this,"onError",void 0),W(this,"_loadableURL","");const{name:t,source:n,url:i}=e;Ol(n||i),this.name=t,this.source=n,this.url=i,this.onMessage=nv,this.onError=s=>console.log(s),this.worker=wu?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=nv,this.onError=nv,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,t){t=t||rS(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(t+="".concat(e.message," in ")),e.lineno&&(t+=":".concat(e.lineno,":").concat(e.colno)),new Error(t)}_createBrowserWorker(){this._loadableURL=cN({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}_createNodeWorker(){let e;if(this.url){const n=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new tv(n,{eval:!1})}else if(this.source)e=new tv(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",t=>{this.onMessage(t)}),e.on("error",t=>{this.onError(t)}),e.on("exit",t=>{}),e}}class AN{static isSupported(){return iv.isSupported()}constructor(e){W(this,"name","unnamed"),W(this,"source",void 0),W(this,"url",void 0),W(this,"maxConcurrency",1),W(this,"maxMobileConcurrency",1),W(this,"onDebug",()=>{}),W(this,"reuseWorkers",!0),W(this,"props",{}),W(this,"jobQueue",[]),W(this,"idleQueue",[]),W(this,"count",0),W(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,a,o)=>s.done(o),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,a)=>s.error(a);const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:t,onError:n,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const n=new aN(t.name,e);e.onMessage=i=>t.onMessage(n,i.type,i.payload),e.onError=i=>t.onError(n,i),t.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new iv({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return oN?this.maxMobileConcurrency:this.maxConcurrency}}const hN={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class xu{static isSupported(){return iv.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return xu._workerFarm=xu._workerFarm||new xu({}),xu._workerFarm.setProps(e),xu._workerFarm}constructor(e){W(this,"props",void 0),W(this,"workerPools",new Map),this.props={...hN},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:n,url:i}=e;let s=this.workerPools.get(t);return s||(s=new AN({name:t,source:n,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}W(xu,"_workerFarm",void 0);const dN="latest";function fN(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=e[r.id]||{},n="".concat(r.id,"-worker.js");let i=t.workerUrl;if(!i&&r.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(r.module,"/dist/").concat(n)),!i){let s=r.version;s==="latest"&&(s=dN);const a=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(r.module).concat(a,"/dist/").concat(n)}return Ol(i),i}function pN(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:iN;Ol(r,"no worker provided");const t=r.version;return!(!e||!t)}const gN=null,mN=null,sv=null,iS=null,yN=Object.freeze(Object.defineProperty({__proto__:null,readFileAsArrayBuffer:gN,readFileAsText:mN,requireFromFile:sv,requireFromString:iS},Symbol.toStringTag,{value:"Module"})),_N="3.4.14",ov={};async function Ch(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return e&&(r=vN(r,e,t)),ov[r]=ov[r]||bN(r),await ov[r]}function vN(r,e,t){if(r.startsWith("http"))return r;const n=t.modules||{};return n[r]?n[r]:wu?t.CDN?(Ol(t.CDN.startsWith("http")),"".concat(t.CDN,"/").concat(e,"@").concat(_N,"/dist/libs/").concat(r)):ev?"../src/libs/".concat(r):"modules/".concat(e,"/src/libs/").concat(r):"modules/".concat(e,"/dist/libs/").concat(r)}async function bN(r){if(r.endsWith("wasm"))return await(await fetch(r)).arrayBuffer();if(!wu)try{return yN&&sv&&await sv(r)}catch{return null}if(ev)return importScripts(r);const t=await(await fetch(r)).text();return wN(t,r)}function wN(r,e){if(!wu)return iS;if(ev)return eval.call(sN,r),null;const t=document.createElement("script");t.id=e;try{t.appendChild(document.createTextNode(r))}catch{t.text=r}return document.body.appendChild(t),null}function xN(r,e){return!xu.isSupported()||!wu&&!(e!=null&&e._nodeWorkers)?!1:r.worker&&(e==null?void 0:e.worker)}async function BN(r,e,t,n,i){const s=r.id,a=fN(r,t),A=xu.getWorkerFarm(t).getWorkerPool({name:s,url:a});t=JSON.parse(JSON.stringify(t)),n=JSON.parse(JSON.stringify(n||{}));const f=await A.startJob("process-on-worker",CN.bind(null,i));return f.postMessage("process",{input:e,options:t,context:n}),await(await f.result).result}async function CN(r,e,t,n){switch(t){case"done":e.done(n);break;case"error":e.error(new Error(n.error));break;case"process":const{id:i,input:s,options:a}=n;try{const o=await r(s,a);e.postMessage("done",{id:i,result:o})}catch(o){const A=o instanceof Error?o.message:"unknown error";e.postMessage("error",{id:i,error:A})}break;default:console.warn("parse-with-worker unknown message ".concat(t))}}function EN(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof r=="string"?r.slice(0,e):ArrayBuffer.isView(r)?sS(r.buffer,r.byteOffset,e):r instanceof ArrayBuffer?sS(r,0,e):""}function sS(r,e,t){if(r.byteLength<=e+t)return"";const n=new DataView(r);let i="";for(let s=0;s<t;s++)i+=String.fromCharCode(n.getUint8(e+s));return i}function SN(r){try{return JSON.parse(r)}catch{throw new Error('Failed to parse JSON from data starting with "'.concat(EN(r),'"'))}}function TN(r,e,t){if(t=t||r.byteLength,r.byteLength<t||e.byteLength<t)return!1;const n=new Uint8Array(r),i=new Uint8Array(e);for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}function IN(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];const n=e.map(o=>o instanceof ArrayBuffer?new Uint8Array(o):o),i=n.reduce((o,A)=>o+A.byteLength,0),s=new Uint8Array(i);let a=0;for(const o of n)s.set(o,a),a+=o.byteLength;return s.buffer}function av(r,e,t){const n=t!==void 0?new Uint8Array(r).subarray(e,e+t):new Uint8Array(r).subarray(e);return new Uint8Array(n).buffer}function Mp(r,e){return ci(r>=0),ci(e>0),r+(e-1)&~(e-1)}function LN(r,e,t){let n;if(r instanceof ArrayBuffer)n=new Uint8Array(r);else{const i=r.byteOffset,s=r.byteLength;n=new Uint8Array(r.buffer||r.arrayBuffer,i,s)}return e.set(n,t),t+Mp(n.byteLength,4)}async function FN(r){const e=[];for await(const t of r)e.push(t);return IN(...e)}function oS(){let r;if(typeof window<"u"&&window.performance)r=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();r=e[0]*1e3+e[1]/1e6}else r=Date.now();return r}let aS=class{constructor(e,t){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=oS(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(oS()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},MN=class{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const t of Object.values(this.stats))e(t)}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(t=>this._getOrCreate(t))}_getOrCreate(e){const{name:t,type:n}=e;let i=this.stats[t];return i||(e instanceof aS?i=e:i=new aS(t,n),this.stats[t]=i),i}};const PN="Queued Requests",UN="Active Requests",RN="Cancelled Requests",ON="Queued Requests Ever",DN="Active Requests Ever",kN={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class NN{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W(this,"props",void 0),W(this,"stats",void 0),W(this,"activeRequestCount",0),W(this,"requestQueue",[]),W(this,"requestMap",new Map),W(this,"deferredUpdate",null),this.props={...kN,...e},this.stats=new MN({id:this.props.id}),this.stats.get(PN),this.stats.get(UN),this.stats.get(RN),this.stats.get(ON),this.stats.get(DN)}scheduleRequest(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const n={handle:e,priority:0,getPriority:t},i=new Promise(s=>(n.resolve=s,n));return this.requestQueue.push(n),this.requestMap.set(e,i),this._issueNewRequests(),i}_issueRequest(e){const{handle:t,resolve:n}=e;let i=!1;const s=()=>{i||(i=!0,this.requestMap.delete(t),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let t=0;t<e;++t){const n=this.requestQueue.shift();n&&this._issueRequest(n)}}}_updateAllRequests(){const e=this.requestQueue;for(let t=0;t<e.length;++t){const n=e[t];this._updateRequest(n)||(e.splice(t,1),this.requestMap.delete(n.handle),t--)}e.sort((t,n)=>t.priority-n.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let QN="";const cS={};function HN(r){for(const e in cS)if(r.startsWith(e)){const t=cS[e];r=r.replace(e,t)}return!r.startsWith("http://")&&!r.startsWith("https://")&&(r="".concat(QN).concat(r)),r}function bve(r){return r}function zN(r){return r&&typeof r=="object"&&r.isBuffer}function lS(r){if(zN(r))return r;if(r instanceof ArrayBuffer)return r;if(ArrayBuffer.isView(r))return r.byteOffset===0&&r.byteLength===r.buffer.byteLength?r.buffer:r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength);if(typeof r=="string"){const e=r;return new TextEncoder().encode(e).buffer}if(r&&typeof r=="object"&&r._toArrayBuffer)return r._toArrayBuffer();throw new Error("toArrayBuffer")}function uS(r){const e=r?r.lastIndexOf("/"):-1;return e>=0?r.substr(e+1):""}function cv(r){const e=r?r.lastIndexOf("/"):-1;return e>=0?r.substr(0,e):""}const GN=r=>typeof r=="boolean",Pp=r=>typeof r=="function",Up=r=>r!==null&&typeof r=="object",AS=r=>Up(r)&&r.constructor==={}.constructor,VN=r=>r&&typeof r[Symbol.iterator]=="function",jN=r=>r&&typeof r[Symbol.asyncIterator]=="function",Eh=r=>typeof Response<"u"&&r instanceof Response||r&&r.arrayBuffer&&r.text&&r.json,Sh=r=>typeof Blob<"u"&&r instanceof Blob,qN=r=>r&&typeof r=="object"&&r.isBuffer,KN=r=>typeof ReadableStream<"u"&&r instanceof ReadableStream||Up(r)&&Pp(r.tee)&&Pp(r.cancel)&&Pp(r.getReader),WN=r=>Up(r)&&Pp(r.read)&&Pp(r.pipe)&&GN(r.readable),hS=r=>KN(r)||WN(r),$N=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,XN=/^([-\w.]+\/[-\w.+]+)/;function JN(r){const e=XN.exec(r);return e?e[1]:r}function dS(r){const e=$N.exec(r);return e?e[1]:""}const fS=/\?.*/;function YN(r){const e=r.match(fS);return e&&e[0]}function lv(r){return r.replace(fS,"")}function Xm(r){return Eh(r)?r.url:Sh(r)?r.name||"":typeof r=="string"?r:""}function uv(r){if(Eh(r)){const e=r,t=e.headers.get("content-type")||"",n=lv(e.url);return JN(t)||dS(n)}return Sh(r)?r.type||"":typeof r=="string"?dS(r):""}function ZN(r){return Eh(r)?r.headers["content-length"]||-1:Sh(r)?r.size:typeof r=="string"?r.length:r instanceof ArrayBuffer||ArrayBuffer.isView(r)?r.byteLength:-1}async function pS(r){if(Eh(r))return r;const e={},t=ZN(r);t>=0&&(e["content-length"]=String(t));const n=Xm(r),i=uv(r);i&&(e["content-type"]=i);const s=await r8(r);s&&(e["x-first-bytes"]=s),typeof r=="string"&&(r=new TextEncoder().encode(r));const a=new Response(r,{headers:e});return Object.defineProperty(a,"url",{value:n}),a}async function e8(r){if(!r.ok){const e=await t8(r);throw new Error(e)}}async function t8(r){let e="Failed to fetch resource ".concat(r.url," (").concat(r.status,"): ");try{const t=r.headers.get("Content-Type");let n=r.statusText;t.includes("application/json")&&(n+=" ".concat(await r.text())),e+=n,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function r8(r){if(typeof r=="string")return"data:,".concat(r.slice(0,5));if(r instanceof Blob){const t=r.slice(0,5);return await new Promise(n=>{const i=new FileReader;i.onload=s=>{var a;return n(s==null||(a=s.target)===null||a===void 0?void 0:a.result)},i.readAsDataURL(t)})}if(r instanceof ArrayBuffer){const t=r.slice(0,5),n=n8(t);return"data:base64,".concat(n)}return null}function n8(r){let e="";const t=new Uint8Array(r);for(let n=0;n<t.byteLength;n++)e+=String.fromCharCode(t[n]);return btoa(e)}async function gS(r,e){if(typeof r=="string"){r=HN(r);let t=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(t=e.fetch),await fetch(r,t)}return await pS(r)}function i8(r){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,t=r||e;return!!(t&&t.indexOf("Electron")>=0)}function Rp(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||i8()}const Jm=globalThis.window||globalThis.self||globalThis.global,Op=globalThis.process||{},mS=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Rp();function s8(r){try{const e=window[r],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch{return null}}let o8=class{constructor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=s8(n),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}};function a8(r){let e;return r<10?e=`${r.toFixed(2)}ms`:r<100?e=`${r.toFixed(1)}ms`:r<1e3?e=`${r.toFixed(0)}ms`:e=`${(r/1e3).toFixed(2)}s`,e}function c8(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const t=Math.max(e-r.length,0);return`${" ".repeat(t)}${r}`}function Av(r,e,t){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=r.src.replace(/\(/g,"%28").replace(/\)/g,"%29");r.width>n&&(t=Math.min(t,n/r.width));const s=r.width*t,a=r.height*t,o=["font-size:1px;",`padding:${Math.floor(a/2)}px ${Math.floor(s/2)}px;`,`line-height:${a}px;`,`background:url(${i});`,`background-size:${s}px ${a}px;`,"color:transparent;"].join("");return[`${e} %c+`,o]}let Ym;(function(r){r[r.BLACK=30]="BLACK",r[r.RED=31]="RED",r[r.GREEN=32]="GREEN",r[r.YELLOW=33]="YELLOW",r[r.BLUE=34]="BLUE",r[r.MAGENTA=35]="MAGENTA",r[r.CYAN=36]="CYAN",r[r.WHITE=37]="WHITE",r[r.BRIGHT_BLACK=90]="BRIGHT_BLACK",r[r.BRIGHT_RED=91]="BRIGHT_RED",r[r.BRIGHT_GREEN=92]="BRIGHT_GREEN",r[r.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",r[r.BRIGHT_BLUE=94]="BRIGHT_BLUE",r[r.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",r[r.BRIGHT_CYAN=96]="BRIGHT_CYAN",r[r.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Ym||(Ym={}));const l8=10;function yS(r){return typeof r!="string"?r:(r=r.toUpperCase(),Ym[r]||Ym.WHITE)}function u8(r,e,t){return!Rp&&typeof r=="string"&&(e&&(r=`\x1B[${yS(e)}m${r}\x1B[39m`),t&&(r=`\x1B[${yS(t)+l8}m${r}\x1B[49m`)),r}function A8(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const t=Object.getPrototypeOf(r),n=Object.getOwnPropertyNames(t),i=r;for(const s of n){const a=i[s];typeof a=="function"&&(e.find(o=>s===o)||(i[s]=a.bind(r)))}}function Zm(r,e){if(!r)throw new Error(e||"Assertion failed")}function Rd(){let r;if(Rp()&&Jm.performance){var e,t;r=Jm==null||(e=Jm.performance)===null||e===void 0||(t=e.now)===null||t===void 0?void 0:t.call(e)}else if("hrtime"in Op){var n;const i=Op==null||(n=Op.hrtime)===null||n===void 0?void 0:n.call(Op);r=i[0]*1e3+i[1]/1e6}else r=Date.now();return r}const Od={debug:Rp()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},h8={enabled:!0,level:0};function ec(){}const _S={},vS={once:!0};let hv=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=mS,this._startTs=Rd(),this._deltaTs=Rd(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new o8(`__probe-${this.id}__`,h8),this.timeStamp(`${this.id} started`),A8(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Rd()-this._startTs).toPrecision(10))}getDelta(){return Number((Rd()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){Zm(e,t)}warn(e){return this._getLogFunction(0,e,Od.warn,arguments,vS)}error(e){return this._getLogFunction(0,e,Od.error,arguments)}deprecated(e,t){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${t}\` instead`)}removed(e,t){return this.error(`\`${e}\` has been removed. Use \`${t}\` instead`)}probe(e,t){return this._getLogFunction(e,t,Od.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,Od.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,Od.debug||Od.info,arguments,vS)}table(e,t,n){return t?this._getLogFunction(e,t,console.table||ec,n&&[n],{tag:g8(t)}):ec}image(e){let{logLevel:t,priority:n,image:i,message:s="",scale:a=1}=e;return this._shouldLog(t||n)?Rp()?p8({image:i,message:s,scale:a}):f8():ec}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||ec)}group(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=wS({logLevel:e,message:t,opts:n}),{collapsed:s}=n;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,t,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||ec)}withGroup(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=bS(e)}_getLogFunction(e,t,n,i,s){if(this._shouldLog(e)){s=wS({logLevel:e,message:t,args:i,opts:s}),n=n||s.method,Zm(n),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Rd();const a=s.tag||s.message;if(s.once&&a)if(!_S[a])_S[a]=Rd();else return ec;return t=d8(this.id,s.message,s),n.bind(console,t,...s.args)}return ec}};hv.VERSION=mS;function bS(r){if(!r)return 0;let e;switch(typeof r){case"number":e=r;break;case"object":e=r.logLevel||r.priority||0;break;default:return 0}return Zm(Number.isFinite(e)&&e>=0),e}function wS(r){const{logLevel:e,message:t}=r;r.logLevel=bS(e);const n=r.args?Array.from(r.args):[];for(;n.length&&n.shift()!==t;);switch(typeof e){case"string":case"function":t!==void 0&&n.unshift(t),r.message=e;break;case"object":Object.assign(r,e);break}typeof r.message=="function"&&(r.message=r.message());const i=typeof r.message;return Zm(i==="string"||i==="object"),Object.assign(r,{args:n},r.opts)}function d8(r,e,t){if(typeof e=="string"){const n=t.time?c8(a8(t.total)):"";e=t.time?`${r}: ${n}  ${e}`:`${r}: ${e}`,e=u8(e,t.color,t.background)}return e}function f8(r){return console.warn("removed"),ec}function p8(r){let{image:e,message:t="",scale:n=1}=r;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const a=Av(s,t,n);console.log(...a)},s.src=e,ec}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...Av(e,t,n)),ec;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...Av(s,t,n)),s.src=e.toDataURL(),ec}return ec}function g8(r){for(const e in r)for(const t in r[e])return t||"untitled";return"empty"}const xS=new hv({id:"loaders.gl"});class m8{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class y8{constructor(){W(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.log.bind(this.console,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.info.bind(this.console,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.warn.bind(this.console,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.error.bind(this.console,...t)}}const BS={fetch:null,mimeType:void 0,nothrow:!1,log:new y8,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:$m,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},_8={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function CS(){globalThis.loaders=globalThis.loaders||{};const{loaders:r}=globalThis;return r._state=r._state||{},r._state}const ES=()=>{const r=CS();return r.globalOptions=r.globalOptions||{...BS},r.globalOptions};function v8(r,e,t,n){return t=t||[],t=Array.isArray(t)?t:[t],b8(r,t),x8(e,r,n)}function b8(r,e){SS(r,null,BS,_8,e);for(const t of e){const n=r&&r[t.id]||{},i=t.options&&t.options[t.id]||{},s=t.deprecatedOptions&&t.deprecatedOptions[t.id]||{};SS(n,t.id,i,s,e)}}function SS(r,e,t,n,i){const s=e||"Top level",a=e?"".concat(e,"."):"";for(const o in r){const A=!e&&Up(r[o]),f=o==="baseUri"&&!e,m=o==="workerUrl"&&e;if(!(o in t)&&!f&&!m){if(o in n)xS.warn("".concat(s," loader option '").concat(a).concat(o,"' no longer supported, use '").concat(n[o],"'"))();else if(!A){const v=w8(o,i);xS.warn("".concat(s," loader option '").concat(a).concat(o,"' not recognized. ").concat(v))()}}}}function w8(r,e){const t=r.toLowerCase();let n="";for(const i of e)for(const s in i.options){if(r===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const a=s.toLowerCase();(t.startsWith(a)||a.startsWith(t))&&(n=n||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return n}function x8(r,e,t){const i={...r.options||{}};return B8(i,t),i.log===null&&(i.log=new m8),TS(i,ES()),TS(i,e),i}function TS(r,e){for(const t in e)if(t in e){const n=e[t];AS(n)&&AS(r[t])?r[t]={...r[t],...e[t]}:r[t]=e[t]}}function B8(r,e){e&&!("baseUri"in r)&&(r.baseUri=e)}function dv(r){var e;return r?(Array.isArray(r)&&(r=r[0]),Array.isArray((e=r)===null||e===void 0?void 0:e.extensions)):!1}function fv(r){var e,t;ci(r,"null loader"),ci(dv(r),"invalid loader");let n;return Array.isArray(r)&&(n=r[1],r=r[0],r={...r,options:{...r.options,...n}}),((e=r)!==null&&e!==void 0&&e.parseTextSync||(t=r)!==null&&t!==void 0&&t.parseText)&&(r.text=!0),r.text||(r.binary=!0),r}const IS=()=>{const r=CS();return r.loaderRegistry=r.loaderRegistry||[],r.loaderRegistry};function C8(r){const e=IS();r=Array.isArray(r)?r:[r];for(const t of r){const n=fv(t);e.find(i=>n===i)||e.unshift(n)}}function E8(){return IS()}const S8=new hv({id:"loaders.gl"}),T8=/\.([^.]+)$/;async function I8(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!FS(r))return null;let i=LS(r,e,{...t,nothrow:!0},n);if(i)return i;if(Sh(r)&&(r=await r.slice(0,10).arrayBuffer(),i=LS(r,e,t,n)),!i&&!(t!=null&&t.nothrow))throw new Error(MS(r));return i}function LS(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!FS(r))return null;if(e&&!Array.isArray(e))return fv(e);let i=[];e&&(i=i.concat(e)),t!=null&&t.ignoreRegisteredLoaders||i.push(...E8()),F8(i);const s=L8(r,i,t,n);if(!s&&!(t!=null&&t.nothrow))throw new Error(MS(r));return s}function L8(r,e,t,n){const i=Xm(r),s=uv(r),a=lv(i)||(n==null?void 0:n.url);let o=null,A="";if(t!=null&&t.mimeType&&(o=pv(e,t==null?void 0:t.mimeType),A="match forced by supplied MIME type ".concat(t==null?void 0:t.mimeType)),o=o||M8(e,a),A=A||(o?"matched url ".concat(a):""),o=o||pv(e,s),A=A||(o?"matched MIME type ".concat(s):""),o=o||U8(e,r),A=A||(o?"matched initial data ".concat(US(r)):""),o=o||pv(e,t==null?void 0:t.fallbackMimeType),A=A||(o?"matched fallback MIME type ".concat(s):""),A){var f;S8.log(1,"selectLoader selected ".concat((f=o)===null||f===void 0?void 0:f.name,": ").concat(A,"."))}return o}function FS(r){return!(r instanceof Response&&r.status===204)}function MS(r){const e=Xm(r),t=uv(r);let n="No valid loader found (";n+=e?"".concat(uS(e),", "):"no url provided, ",n+="MIME type: ".concat(t?'"'.concat(t,'"'):"not provided",", ");const i=r?US(r):"";return n+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",n+=")",n}function F8(r){for(const e of r)fv(e)}function M8(r,e){const t=e&&T8.exec(e),n=t&&t[1];return n?P8(r,n):null}function P8(r,e){e=e.toLowerCase();for(const t of r)for(const n of t.extensions)if(n.toLowerCase()===e)return t;return null}function pv(r,e){for(const t of r)if(t.mimeTypes&&t.mimeTypes.includes(e)||e==="application/x.".concat(t.id))return t;return null}function U8(r,e){if(!e)return null;for(const t of r)if(typeof e=="string"){if(R8(e,t))return t}else if(ArrayBuffer.isView(e)){if(PS(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&PS(e,0,t))return t;return null}function R8(r,e){return e.testText?e.testText(r):(Array.isArray(e.tests)?e.tests:[e.tests]).some(n=>r.startsWith(n))}function PS(r,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(i=>O8(r,e,t,i))}function O8(r,e,t,n){if(n instanceof ArrayBuffer)return TN(n,r,n.byteLength);switch(typeof n){case"function":return n(r,t);case"string":const i=gv(r,e,n.length);return n===i;default:return!1}}function US(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof r=="string"?r.slice(0,e):ArrayBuffer.isView(r)?gv(r.buffer,r.byteOffset,e):r instanceof ArrayBuffer?gv(r,0,e):""}function gv(r,e,t){if(r.byteLength<e+t)return"";const n=new DataView(r);let i="";for(let s=0;s<t;s++)i+=String.fromCharCode(n.getUint8(e+s));return i}const D8=256*1024;function*k8(r,e){const t=(e==null?void 0:e.chunkSize)||D8;let n=0;const i=new TextEncoder;for(;n<r.length;){const s=Math.min(r.length-n,t),a=r.slice(n,n+s);n+=s,yield i.encode(a)}}const N8=256*1024;function Q8(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:t=N8}=e;let n=0;for(;n<r.byteLength;){const i=Math.min(r.byteLength-n,t),s=new ArrayBuffer(i),a=new Uint8Array(r,n,i);new Uint8Array(s).set(a),n+=i,yield s}}()}const H8=1024*1024;async function*z8(r,e){const t=(e==null?void 0:e.chunkSize)||H8;let n=0;for(;n<r.size;){const i=n+t,s=await r.slice(n,i).arrayBuffer();n=i,yield s}}function RS(r,e){return $m?G8(r,e):V8(r)}async function*G8(r,e){const t=r.getReader();let n;try{for(;;){const i=n||t.read();e!=null&&e._streamReadAhead&&(n=t.read());const{done:s,value:a}=await i;if(s)return;yield lS(a)}}catch{t.releaseLock()}}async function*V8(r,e){for await(const t of r)yield lS(t)}function j8(r,e){if(typeof r=="string")return k8(r,e);if(r instanceof ArrayBuffer)return Q8(r,e);if(Sh(r))return z8(r,e);if(hS(r))return RS(r,e);if(Eh(r))return RS(r.body,e);throw new Error("makeIterator")}const OS="Cannot convert supplied data type";function q8(r,e,t){if(e.text&&typeof r=="string")return r;if(qN(r)&&(r=r.buffer),r instanceof ArrayBuffer){const n=r;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(r)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(r);let n=r.buffer;const i=r.byteLength||r.length;return(r.byteOffset!==0||i!==n.byteLength)&&(n=n.slice(r.byteOffset,r.byteOffset+i)),n}throw new Error(OS)}async function K8(r,e,t){const n=r instanceof ArrayBuffer||ArrayBuffer.isView(r);if(typeof r=="string"||n)return q8(r,e);if(Sh(r)&&(r=await pS(r)),Eh(r)){const i=r;return await e8(i),e.binary?await i.arrayBuffer():await i.text()}if(hS(r)&&(r=j8(r,t)),VN(r)||jN(r))return FN(r);throw new Error(OS)}function DS(r,e){const t=ES(),n=r||t;return typeof n.fetch=="function"?n.fetch:Up(n.fetch)?i=>gS(i,n):e!=null&&e.fetch?e==null?void 0:e.fetch:gS}function W8(r,e,t){if(t)return t;const n={fetch:DS(e,r),...r};if(n.url){const i=lv(n.url);n.baseUrl=i,n.queryString=YN(n.url),n.filename=uS(i),n.baseUrl=cv(i)}return Array.isArray(n.loaders)||(n.loaders=null),n}function $8(r,e){if(!e&&r&&!Array.isArray(r))return r;let t;if(r&&(t=Array.isArray(r)?r:[r]),e&&e.loaders){const n=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...n]:n}return t&&t.length?t:null}async function mv(r,e,t,n){Ol(!n||typeof n=="object"),e&&!Array.isArray(e)&&!dv(e)&&(n=void 0,t=e,e=void 0),r=await r,t=t||{};const i=Xm(r),a=$8(e,n),o=await I8(r,a,t);return o?(t=v8(t,o,a,i),n=W8({url:i,parse:mv,loaders:a},t,n||null),await X8(o,r,t,n)):null}async function X8(r,e,t,n){if(pN(r),Eh(e)){const i=e,{ok:s,redirected:a,status:o,statusText:A,type:f,url:m}=i,v=Object.fromEntries(i.headers.entries());n.response={headers:v,ok:s,redirected:a,status:o,statusText:A,type:f,url:m}}if(e=await K8(e,r,t),r.parseTextSync&&typeof e=="string")return t.dataType="text",r.parseTextSync(e,t,n,r);if(xN(r,t))return await BN(r,e,t,n,mv);if(r.parseText&&typeof e=="string")return await r.parseText(e,t,n,r);if(r.parse)return await r.parse(e,t,n,r);throw Ol(!r.parseSync),new Error("".concat(r.id," loader - no parser found and worker is disabled"))}async function wA(r,e,t,n){!Array.isArray(e)&&!dv(e)&&(t=e,e=void 0);const i=DS(t);let s=r;return typeof r=="string"&&(s=await i(r)),Sh(r)&&(s=await i(r)),await mv(s,e,t)}const J8="3.4.14",{_parseImageNode:Y8}=globalThis,yv=typeof Image<"u",_v=typeof ImageBitmap<"u",vv=$m?!0:!!Y8;function Z8(r){switch(r){case"auto":return _v||yv||vv;case"imagebitmap":return _v;case"image":return yv;case"data":return vv;default:throw new Error("@loaders.gl/images: image ".concat(r," not supported in this environment"))}}function eQ(){if(_v)return"imagebitmap";if(yv)return"image";if(vv)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function tQ(r){const e=nQ(r);if(!e)throw new Error("Not an image");return e}function rQ(r){switch(tQ(r)){case"data":return r;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=r.width,e.height=r.height,t.drawImage(r,0,0),t.getImageData(0,0,r.width,r.height);default:throw new Error("getImageData")}}function nQ(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&r instanceof Image?"image":r&&typeof r=="object"&&r.data&&r.width&&r.height?"data":null}const iQ=/^data:image\/svg\+xml/,sQ=/\.svg((\?|#).*)?$/;function bv(r){return r&&(iQ.test(r)||sQ.test(r))}function oQ(r,e){if(bv(e)){let n=new TextDecoder().decode(r);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(n=unescape(encodeURIComponent(n)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(n))}return kS(r,e)}function kS(r,e){if(bv(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(r)])}async function NS(r,e,t){const n=oQ(r,t),i=self.URL||self.webkitURL,s=typeof n!="string"&&i.createObjectURL(n);try{return await aQ(s||n,e)}finally{s&&i.revokeObjectURL(s)}}async function aQ(r,e){const t=new Image;return t.src=r,e.image&&e.image.decode&&t.decode?(await t.decode(),t):await new Promise((n,i)=>{try{t.onload=()=>n(t),t.onerror=s=>i(new Error("Could not load image ".concat(r,": ").concat(s)))}catch(s){i(s)}})}const cQ={};let QS=!0;async function lQ(r,e,t){let n;bv(t)?n=await NS(r,e,t):n=kS(r,t);const i=e&&e.imagebitmap;return await uQ(n,i)}async function uQ(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((AQ(e)||!QS)&&(e=null),e)try{return await createImageBitmap(r,e)}catch(t){console.warn(t),QS=!1}return await createImageBitmap(r)}function AQ(r){for(const e in r||cQ)return!1;return!0}function hQ(r){return!gQ(r,"ftyp",4)||!(r[8]&96)?null:dQ(r)}function dQ(r){switch(fQ(r,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function fQ(r,e,t){return String.fromCharCode(...r.slice(e,t))}function pQ(r){return[...r].map(e=>e.charCodeAt(0))}function gQ(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const n=pQ(e);for(let i=0;i<n.length;++i)if(n[i]!==r[i+t])return!1;return!0}const Dl=!1,Dp=!0;function wv(r){const e=kp(r);return yQ(e)||bQ(e)||_Q(e)||vQ(e)||mQ(e)}function mQ(r){const e=new Uint8Array(r instanceof DataView?r.buffer:r),t=hQ(e);return t?{mimeType:t.mimeType,width:0,height:0}:null}function yQ(r){const e=kp(r);return e.byteLength>=24&&e.getUint32(0,Dl)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Dl),height:e.getUint32(20,Dl)}:null}function _Q(r){const e=kp(r);return e.byteLength>=10&&e.getUint32(0,Dl)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Dp),height:e.getUint16(8,Dp)}:null}function vQ(r){const e=kp(r);return e.byteLength>=14&&e.getUint16(0,Dl)===16973&&e.getUint32(2,Dp)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Dp),height:e.getUint32(22,Dp)}:null}function bQ(r){const e=kp(r);if(!(e.byteLength>=3&&e.getUint16(0,Dl)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:n,sofMarkers:i}=wQ();let s=2;for(;s+9<e.byteLength;){const a=e.getUint16(s,Dl);if(i.has(a))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Dl),width:e.getUint16(s+7,Dl)};if(!n.has(a))return null;s+=2,s+=e.getUint16(s,Dl)}return null}function wQ(){const r=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)r.add(t);return{tableMarkers:r,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function kp(r){if(r instanceof DataView)return r;if(ArrayBuffer.isView(r))return new DataView(r.buffer);if(r instanceof ArrayBuffer)return new DataView(r);throw new Error("toDataView")}async function xQ(r,e){const{mimeType:t}=wv(r)||{},n=globalThis._parseImageNode;return ci(n),await n(r,t)}async function BQ(r,e,t){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=t||{},a=CQ(i);let o;switch(a){case"imagebitmap":o=await lQ(r,e,s);break;case"image":o=await NS(r,e,s);break;case"data":o=await xQ(r);break;default:ci(!1)}return i==="data"&&(o=rQ(o)),o}function CQ(r){switch(r){case"auto":case"data":return eQ();default:return Z8(r),r}}const HS={id:"image",module:"images",name:"Images",version:J8,mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:BQ,tests:[r=>!!wv(new DataView(r))],options:{image:{type:"auto",decode:!0}}},xv={};function EQ(r){if(xv[r]===void 0){const e=$m?TQ(r):SQ(r);xv[r]=e}return xv[r]}function SQ(r){const e=["image/png","image/jpeg","image/gif"],{_parseImageNode:t,_imageFormatsNode:n=e}=globalThis;return!!t&&n.includes(r)}function TQ(r){switch(r){case"image/avif":case"image/webp":return IQ(r);default:return!0}}function IQ(r){try{return document.createElement("canvas").toDataURL(r).indexOf("data:".concat(r))===0}catch{return!1}}function zS(r){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,t=r||e;return!!(t&&t.indexOf("Electron")>=0)}function Bu(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||zS()}const e0={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},t0=e0.window||e0.self||e0.global,Np=e0.process||{},GS=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Bu();const Bv=globalThis;function VS(r){if(!r&&!Bu())return"Node";if(zS(r))return"Electron";const t=r||(typeof navigator<"u"?navigator:{}).userAgent||"";if(t.indexOf("Edge")>-1)return"Edge";const n=t.indexOf("MSIE ")!==-1,i=t.indexOf("Trident/")!==-1;return n||i?"IE":Bv.chrome?"Chrome":Bv.safari?"Safari":Bv.mozInnerScreenX?"Firefox":"Unknown"}function LQ(r){try{const e=window[r],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch{return null}}class FQ{constructor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";W(this,"storage",void 0),W(this,"id",void 0),W(this,"config",void 0),this.storage=LQ(n),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function MQ(r){let e;return r<10?e="".concat(r.toFixed(2),"ms"):r<100?e="".concat(r.toFixed(1),"ms"):r<1e3?e="".concat(r.toFixed(0),"ms"):e="".concat((r/1e3).toFixed(2),"s"),e}function PQ(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const t=Math.max(e-r.length,0);return"".concat(" ".repeat(t)).concat(r)}function Cv(r,e,t){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=r.src.replace(/\(/g,"%28").replace(/\)/g,"%29");r.width>n&&(t=Math.min(t,n/r.width));const s=r.width*t,a=r.height*t,o=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let r0;(function(r){r[r.BLACK=30]="BLACK",r[r.RED=31]="RED",r[r.GREEN=32]="GREEN",r[r.YELLOW=33]="YELLOW",r[r.BLUE=34]="BLUE",r[r.MAGENTA=35]="MAGENTA",r[r.CYAN=36]="CYAN",r[r.WHITE=37]="WHITE",r[r.BRIGHT_BLACK=90]="BRIGHT_BLACK",r[r.BRIGHT_RED=91]="BRIGHT_RED",r[r.BRIGHT_GREEN=92]="BRIGHT_GREEN",r[r.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",r[r.BRIGHT_BLUE=94]="BRIGHT_BLUE",r[r.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",r[r.BRIGHT_CYAN=96]="BRIGHT_CYAN",r[r.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(r0||(r0={}));function jS(r){return typeof r=="string"?r0[r.toUpperCase()]||r0.WHITE:r}function UQ(r,e,t){return!Bu&&typeof r=="string"&&(e&&(e=jS(e),r="\x1B[".concat(e,"m").concat(r,"\x1B[39m")),t&&(e=jS(t),r="\x1B[".concat(t+10,"m").concat(r,"\x1B[49m"))),r}function RQ(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const t=Object.getPrototypeOf(r),n=Object.getOwnPropertyNames(t);for(const i of n)typeof r[i]=="function"&&(e.find(s=>i===s)||(r[i]=r[i].bind(r)))}function n0(r,e){if(!r)throw new Error(e||"Assertion failed")}function Dd(){let r;if(Bu&&"performance"in t0){var e,t;r=t0==null||(e=t0.performance)===null||e===void 0||(t=e.now)===null||t===void 0?void 0:t.call(e)}else if("hrtime"in Np){var n;const i=Np==null||(n=Np.hrtime)===null||n===void 0?void 0:n.call(Np);r=i[0]*1e3+i[1]/1e6}else r=Date.now();return r}const kd={debug:Bu&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},OQ={enabled:!0,level:0};function tc(){}const qS={},KS={once:!0};class Ev{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};W(this,"id",void 0),W(this,"VERSION",GS),W(this,"_startTs",Dd()),W(this,"_deltaTs",Dd()),W(this,"_storage",void 0),W(this,"userData",{}),W(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new FQ("__probe-".concat(this.id,"__"),OQ),this.timeStamp("".concat(this.id," started")),RQ(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Dd()-this._startTs).toPrecision(10))}getDelta(){return Number((Dd()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){n0(e,t)}warn(e){return this._getLogFunction(0,e,kd.warn,arguments,KS)}error(e){return this._getLogFunction(0,e,kd.error,arguments)}deprecated(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}removed(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}probe(e,t){return this._getLogFunction(e,t,kd.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,kd.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];return this._getLogFunction(e,t,kd.debug||kd.info,arguments,KS)}table(e,t,n){return t?this._getLogFunction(e,t,console.table||tc,n&&[n],{tag:QQ(t)}):tc}image(e){let{logLevel:t,priority:n,image:i,message:s="",scale:a=1}=e;return this._shouldLog(t||n)?Bu?NQ({image:i,message:s,scale:a}):kQ():tc}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||tc)}group(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=$S({logLevel:e,message:t,opts:n}),{collapsed:s}=n;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,t,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||tc)}withGroup(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=WS(e)}_getLogFunction(e,t,n,i,s){if(this._shouldLog(e)){s=$S({logLevel:e,message:t,args:i,opts:s}),n=n||s.method,n0(n),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Dd();const a=s.tag||s.message;if(s.once)if(!qS[a])qS[a]=Dd();else return tc;return t=DQ(this.id,s.message,s),n.bind(console,t,...s.args)}return tc}}W(Ev,"VERSION",GS);function WS(r){if(!r)return 0;let e;switch(typeof r){case"number":e=r;break;case"object":e=r.logLevel||r.priority||0;break;default:return 0}return n0(Number.isFinite(e)&&e>=0),e}function $S(r){const{logLevel:e,message:t}=r;r.logLevel=WS(e);const n=r.args?Array.from(r.args):[];for(;n.length&&n.shift()!==t;);switch(typeof e){case"string":case"function":t!==void 0&&n.unshift(t),r.message=e;break;case"object":Object.assign(r,e);break}typeof r.message=="function"&&(r.message=r.message());const i=typeof r.message;return n0(i==="string"||i==="object"),Object.assign(r,{args:n},r.opts)}function DQ(r,e,t){if(typeof e=="string"){const n=t.time?PQ(MQ(t.total)):"";e=t.time?"".concat(r,": ").concat(n,"  ").concat(e):"".concat(r,": ").concat(e),e=UQ(e,t.color,t.background)}return e}function kQ(r){return console.warn("removed"),tc}function NQ(r){let{image:e,message:t="",scale:n=1}=r;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const a=Cv(s,t,n);console.log(...a)},s.src=e,tc}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...Cv(e,t,n)),tc;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...Cv(s,t,n)),s.src=e.toDataURL(),tc}return tc}function QQ(r){for(const e in r)for(const t in r[e])return t||"untitled";return"empty"}const Mn=new Ev({id:"deck"}),xA={attributeUpdateStart:-1,attributeManagerUpdateStart:-1,attributeUpdateMessages:[]},Sv=1,Qp=2,Tv=3,Iv=4,HQ=2,zQ=r=>({"layer.changeFlag":(e,t,n)=>{r.log(Tv,"".concat(e.id," ").concat(t,": "),n[t])()},"layer.initialize":e=>{r.log(Sv,"Initializing ".concat(e))()},"layer.update":(e,t)=>{if(t){const n=e.getChangeFlags();r.log(Qp,"Updating ".concat(e," because: ").concat(Object.keys(n).filter(i=>n[i]).join(", ")))()}else r.log(Iv,"".concat(e," does not need update"))()},"layer.matched":(e,t)=>{t&&r.log(Iv,"Matched ".concat(e,", state transfered"))()},"layer.finalize":e=>{r.log(Sv,"Finalizing ".concat(e))()},"compositeLayer.renderLayers":(e,t,n)=>{t?r.log(Qp,"Composite layer rendered new subLayers ".concat(e),n)():r.log(Iv,"Composite layer reused subLayers ".concat(e),n)()},"layerManager.setLayers":(e,t,n)=>{t&&r.log(Qp,"Updating ".concat(n.length," deck layers"))()},"layerManager.activateViewport":(e,t)=>{r.log(Tv,"Viewport changed",t)()},"attributeManager.invalidate":(e,t,n)=>{r.log(Sv,n?"invalidated attributes ".concat(n," (").concat(t,") for ").concat(e.id):"invalidated all attributes for ".concat(e.id))()},"attributeManager.updateStart":e=>{xA.attributeUpdateMessages.length=0,xA.attributeManagerUpdateStart=Date.now()},"attributeManager.updateEnd":(e,t)=>{const n=Math.round(Date.now()-xA.attributeManagerUpdateStart);r.groupCollapsed(Qp,"Updated attributes for ".concat(t," instances in ").concat(e.id," in ").concat(n,"ms"))();for(const i of xA.attributeUpdateMessages)r.log(Tv,i)();r.groupEnd(Qp)()},"attribute.updateStart":e=>{xA.attributeUpdateStart=Date.now()},"attribute.allocate":(e,t)=>{const n="".concat(e.id," allocated ").concat(t);xA.attributeUpdateMessages.push(n)},"attribute.updateEnd":(e,t)=>{const n=Math.round(Date.now()-xA.attributeUpdateStart),i="".concat(e.id," updated ").concat(t," in ").concat(n,"ms");xA.attributeUpdateMessages.push(i)},"deckRenderer.renderLayers":(e,t,n)=>{const{pass:i,redrawReason:s,stats:a}=n;for(const o of t){const{totalCount:A,visibleCount:f,compositeCount:m,pickableCount:v}=o,B=A-m-f;r.log(HQ,"RENDER #".concat(e.renderCount,"   ").concat(f," (of ").concat(A," layers) to ").concat(i," because ").concat(s,"   (").concat(B," hidden, ").concat(m," composite ").concat(v," pickable)"))(),a&&a.get("Redraw Layers").add(f)}}});var GQ={};let i0={};GQ.NODE_ENV!=="production"&&(i0=zQ(Mn));function VQ(r){i0=r}function ao(r,e,t,n){Mn.level>0&&i0[r]&&i0[r].call(null,e,t,n)}function jQ(r){const e=r[0],t=r[r.length-1];return e==="{"&&t==="}"||e==="["&&t==="]"}const qQ={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:jQ,parseTextSync:JSON.parse};function KQ(){const r="8.9.35",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==r)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(r));return e||(Mn.log(1,"deck.gl ".concat(r))(),globalThis.deck={...globalThis.deck,VERSION:r,version:r,log:Mn,_registerLoggers:VQ},C8([qQ,[HS,{imagebitmap:{premultiplyAlpha:"none"}}]])),r}const WQ=KQ(),Tn={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Tn,"IDENTITY",{get:()=>(Mn.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const kl={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Lv={common:0,meters:1,pixels:2},XS={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},yr=new Ev({id:"luma.gl"});function Mo(r,e){if(!r)throw new Error(e||"luma.gl: assertion failed.")}const $Q="Invalid WebGLRenderingContext",XQ="Requires WebGL2";function s0(r){return typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?!0:!!(r&&Number.isFinite(r._version))}function gn(r){return typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?!0:!!(r&&r._version===2)}function JQ(r){return gn(r)?r:null}function o0(r){return Mo(s0(r),$Q),r}function Po(r){return Mo(gn(r),XQ),r}const Hp={};function YQ(r){globalThis.console&&globalThis.console.error&&globalThis.console.error(r)}function ZQ(r){globalThis.console&&globalThis.console.log&&globalThis.console.log(r)}function e7(r,e){Hp[r]=!0,e!==void 0&&YQ(e)}function t7(r){const e=r.getError;r.getError=function(){let n;do n=e.apply(r),n!==0&&(Hp[n]=!0);while(n!==0);for(n in Hp)if(Hp[n])return delete Hp[n],parseInt(n,10);return 0}}const zp=function r(e){const t=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let n=0;n<this.attribs.length;n++){const i=new r.VertexAttrib(t);this.attribs[n]=i}this.maxAttrib=0};zp.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()},zp.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Th=function(e){const t=this;this.gl=e,t7(e);const n=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:n.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const a=t.currentVertexArrayObject;a.maxAttrib=Math.max(a.maxAttrib,s);const o=a.attribs[s];return o.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const a=t.currentVertexArrayObject;a.maxAttrib=Math.max(a.maxAttrib,s);const o=a.attribs[s];return o.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,a){switch(s){case 34962:t.currentArrayBuffer=a;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=a;break}return n.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,a){const A=t.currentVertexArrayObject.attribs[s];switch(a){case 34975:return A.buffer;case 34338:return A.enabled;case 34339:return A.size;case 34340:return A.stride;case 34341:return A.type;case 34922:return A.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,a,o,A,f,m){const v=t.currentVertexArrayObject;v.maxAttrib=Math.max(v.maxAttrib,s);const x=v.attribs[s];return x.buffer=t.currentArrayBuffer,x.size=a,x.type=o,x.normalized=A,x.stride=f,x.offset=m,x.recache(),n.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{ZQ("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};Th.prototype.VERTEX_ARRAY_BINDING_OES=34229,Th.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let n=0;n<this.vertexArrayObjects.length;++n)this.vertexArrayObjects.isAlive=!1;const t=this.gl;this.maxVertexAttribs=t.getParameter(34921),this.defaultVertexArrayObject=new zp(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},Th.prototype.createVertexArrayOES=function(){const e=new zp(this);return this.vertexArrayObjects.push(e),e},Th.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},Th.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof zp&&e.hasBeenBound&&e.ext===this)},Th.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive){e7(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const n=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&n.bindBuffer.call(t,34963,s.elementArrayBuffer);let a=this.currentArrayBuffer;const o=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let A=0;A<=o;A++){const f=s.attribs[A],m=i?i.attribs[A]:null;if((!i||f.enabled!==m.enabled)&&(f.enabled?n.enableVertexAttribArray.call(t,A):n.disableVertexAttribArray.call(t,A)),f.enabled){let v=!1;(!i||f.buffer!==m.buffer)&&(a!==f.buffer&&(n.bindBuffer.call(t,34962,f.buffer),a=f.buffer),v=!0),(v||f.cached!==m.cached)&&n.vertexAttribPointer.call(t,A,f.size,f.type,f.normalized,f.stride,f.offset)}}this.currentArrayBuffer!==a&&n.bindBuffer.call(t,34962,this.currentArrayBuffer)};function r7(r){if(typeof r.createVertexArray=="function")return;const e=r.getSupportedExtensions;r.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const t=r.getExtension;r.getExtension=function(i){const s=t.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(r.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Th(this)),this.__OESVertexArrayObject))}}const JS="OES_element_index",YS="WEBGL_draw_buffers",n7="EXT_disjoint_timer_query",i7="EXT_disjoint_timer_query_webgl2",s7="EXT_texture_filter_anisotropic",ZS="WEBGL_debug_renderer_info",o7=35723,a7=4352,c7=36795,l7=34047,u7=37445,A7=37446,pi=r=>gn(r)?void 0:0,h7={3074:r=>gn(r)?void 0:36064,[o7]:r=>gn(r)?void 0:a7,35977:pi,32937:pi,[c7]:(r,e)=>{const t=gn(r)?r.getExtension(i7):r.getExtension(n7);return t&&t.GPU_DISJOINT_EXT?e(t.GPU_DISJOINT_EXT):0},[u7]:(r,e)=>{const t=r.getExtension(ZS);return e(t&&t.UNMASKED_VENDOR_WEBGL||7936)},[A7]:(r,e)=>{const t=r.getExtension(ZS);return e(t&&t.UNMASKED_RENDERER_WEBGL||7937)},[l7]:(r,e)=>{const t=r.luma.extensions[s7];return t?e(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:pi,35071:pi,37447:pi,36063:(r,e)=>{if(!gn(r)){const t=r.getExtension(YS);return t?e(t.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:pi,35374:pi,35377:pi,34852:r=>{if(!gn(r)){const e=r.getExtension(YS);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:r=>r.getExtension(JS)?2147483647:65535,33001:r=>r.getExtension(JS)?16777216:65535,33e3:r=>16777216,37157:pi,35373:pi,35657:pi,36183:pi,37137:pi,34045:pi,35978:pi,35979:pi,35968:pi,35376:pi,35375:pi,35659:pi,37154:pi,35371:pi,35658:pi,35076:pi,35077:pi,35380:pi};function d7(r,e,t){const n=h7[t],i=typeof n=="function"?n(r,e,t):n;return i!==void 0?i:e(t)}const f7="OES_vertex_array_object",e5="ANGLE_instanced_arrays",p7="WEBGL_draw_buffers",g7="EXT_disjoint_timer_query",m7="EXT_texture_filter_anisotropic",y7="VertexArray requires WebGL2 or OES_vertex_array_object extension";function _7(r,e){return{webgl2:gn(r),ext:r.getExtension(e)}}const t5={[f7]:{meta:{suffix:"OES"},createVertexArray:()=>{Mo(!1,y7)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[e5]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(r,e){Mo(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[p7]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Mo(!1)}},[g7]:{meta:{suffix:"EXT"},createQuery:()=>{Mo(!1)},deleteQuery:()=>{Mo(!1)},beginQuery:()=>{Mo(!1)},endQuery:()=>{},getQuery(r,e){return this.getQueryObject(r,e)},getQueryParameter(r,e){return this.getQueryObject(r,e)},getQueryObject:()=>{}}},Fv={readBuffer:(r,e,t)=>{gn(r)&&e(t)},getVertexAttrib:(r,e,t,n)=>{const{webgl2:i,ext:s}=_7(r,e5);let a;switch(n){case 35069:a=i?void 0:!1;break;case 35070:a=!i&&!s?0:void 0;break}return a!==void 0?a:e(t,n)},getProgramParameter:(r,e,t,n)=>{if(!gn(r))switch(n){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(t,n)},getInternalformatParameter:(r,e,t,n,i)=>{if(!gn(r))switch(i){case 32937:return new Int32Array([0])}return r.getInternalformatParameter(t,n,i)},getTexParameter(r,e,t,n){switch(n){case 34046:const{extensions:i}=r.luma,s=i[m7];n=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(t,n)},getParameter:d7,hint(r,e,t,n){return e(t,n)}};function v7(r){r.luma=r.luma||{};const{luma:e}=r;return e.polyfilled||(r7(r),b7(r),x7(r,t5),w7(r,{target:e,target2:r}),e.polyfilled=!0),r}globalThis.polyfillContext=v7;function b7(r){r.luma.extensions={};const e=r.getSupportedExtensions()||[];for(const t of e)r.luma[t]=r.getExtension(t)}function w7(r,e){let{target:t,target2:n}=e;Object.keys(Fv).forEach(i=>{if(typeof Fv[i]=="function"){const s=r[i]?r[i].bind(r):()=>{},a=Fv[i].bind(null,r,s);t[i]=a,n[i]=a}})}function x7(r,e){for(const t of Object.getOwnPropertyNames(e))t!=="overrides"&&B7(r,{extension:t,target:r.luma,target2:r})}function B7(r,e){let{extension:t,target:n,target2:i}=e;const s=t5[t];Mo(s);const{meta:a={}}=s,{suffix:o=""}=a,A=r.getExtension(t);for(const f of Object.keys(s)){const m="".concat(f).concat(o);let v=null;f==="meta"||typeof r[f]=="function"||(A&&typeof A[m]=="function"?v=function(){return A[m](...arguments)}:typeof s[f]=="function"&&(v=s[f].bind(n))),v&&(n[f]=v,i[f]=v)}}const Mv={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},BA=(r,e,t)=>e?r.enable(t):r.disable(t),r5=(r,e,t)=>r.hint(t,e),Ta=(r,e,t)=>r.pixelStorei(t,e),C7=(r,e)=>{const t=gn(r)?36009:36160;return r.bindFramebuffer(t,e)},E7=(r,e)=>r.bindFramebuffer(36008,e);function Gp(r){return Array.isArray(r)||ArrayBuffer.isView(r)}const S7={3042:BA,32773:(r,e)=>r.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(r,e)=>r.clearColor(...e),3107:(r,e)=>r.colorMask(...e),2884:BA,2885:(r,e)=>r.cullFace(e),2929:BA,2931:(r,e)=>r.clearDepth(e),2932:(r,e)=>r.depthFunc(e),2928:(r,e)=>r.depthRange(...e),2930:(r,e)=>r.depthMask(e),3024:BA,35723:r5,36006:C7,2886:(r,e)=>r.frontFace(e),33170:r5,2849:(r,e)=>r.lineWidth(e),32823:BA,32824:"polygonOffset",10752:"polygonOffset",35977:BA,32938:"sampleCoverage",32939:"sampleCoverage",3089:BA,3088:(r,e)=>r.scissor(...e),2960:BA,2961:(r,e)=>r.clearStencil(e),2968:(r,e)=>r.stencilMaskSeparate(1028,e),36005:(r,e)=>r.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(r,e)=>r.viewport(...e),3333:Ta,3317:Ta,37440:Ta,37441:Ta,37443:Ta,3330:Ta,3332:Ta,3331:Ta,36010:E7,3314:Ta,32878:Ta,3316:Ta,3315:Ta,32877:Ta,framebuffer:(r,e)=>{const t=e&&"handle"in e?e.handle:e;return r.bindFramebuffer(36160,t)},blend:(r,e)=>e?r.enable(3042):r.disable(3042),blendColor:(r,e)=>r.blendColor(...e),blendEquation:(r,e)=>{e=Gp(e)?e:[e,e],r.blendEquationSeparate(...e)},blendFunc:(r,e)=>{e=Gp(e)&&e.length===2?[...e,...e]:e,r.blendFuncSeparate(...e)},clearColor:(r,e)=>r.clearColor(...e),clearDepth:(r,e)=>r.clearDepth(e),clearStencil:(r,e)=>r.clearStencil(e),colorMask:(r,e)=>r.colorMask(...e),cull:(r,e)=>e?r.enable(2884):r.disable(2884),cullFace:(r,e)=>r.cullFace(e),depthTest:(r,e)=>e?r.enable(2929):r.disable(2929),depthFunc:(r,e)=>r.depthFunc(e),depthMask:(r,e)=>r.depthMask(e),depthRange:(r,e)=>r.depthRange(...e),dither:(r,e)=>e?r.enable(3024):r.disable(3024),derivativeHint:(r,e)=>{r.hint(35723,e)},frontFace:(r,e)=>r.frontFace(e),mipmapHint:(r,e)=>r.hint(33170,e),lineWidth:(r,e)=>r.lineWidth(e),polygonOffsetFill:(r,e)=>e?r.enable(32823):r.disable(32823),polygonOffset:(r,e)=>r.polygonOffset(...e),sampleCoverage:(r,e)=>r.sampleCoverage(...e),scissorTest:(r,e)=>e?r.enable(3089):r.disable(3089),scissor:(r,e)=>r.scissor(...e),stencilTest:(r,e)=>e?r.enable(2960):r.disable(2960),stencilMask:(r,e)=>{e=Gp(e)?e:[e,e];const[t,n]=e;r.stencilMaskSeparate(1028,t),r.stencilMaskSeparate(1029,n)},stencilFunc:(r,e)=>{e=Gp(e)&&e.length===3?[...e,...e]:e;const[t,n,i,s,a,o]=e;r.stencilFuncSeparate(1028,t,n,i),r.stencilFuncSeparate(1029,s,a,o)},stencilOp:(r,e)=>{e=Gp(e)&&e.length===3?[...e,...e]:e;const[t,n,i,s,a,o]=e;r.stencilOpSeparate(1028,t,n,i),r.stencilOpSeparate(1029,s,a,o)},viewport:(r,e)=>r.viewport(...e)};function Hi(r,e,t){return e[r]!==void 0?e[r]:t[r]}const T7={blendEquation:(r,e,t)=>r.blendEquationSeparate(Hi(32777,e,t),Hi(34877,e,t)),blendFunc:(r,e,t)=>r.blendFuncSeparate(Hi(32969,e,t),Hi(32968,e,t),Hi(32971,e,t),Hi(32970,e,t)),polygonOffset:(r,e,t)=>r.polygonOffset(Hi(32824,e,t),Hi(10752,e,t)),sampleCoverage:(r,e,t)=>r.sampleCoverage(Hi(32938,e,t),Hi(32939,e,t)),stencilFuncFront:(r,e,t)=>r.stencilFuncSeparate(1028,Hi(2962,e,t),Hi(2967,e,t),Hi(2963,e,t)),stencilFuncBack:(r,e,t)=>r.stencilFuncSeparate(1029,Hi(34816,e,t),Hi(36003,e,t),Hi(36004,e,t)),stencilOpFront:(r,e,t)=>r.stencilOpSeparate(1028,Hi(2964,e,t),Hi(2965,e,t),Hi(2966,e,t)),stencilOpBack:(r,e,t)=>r.stencilOpSeparate(1029,Hi(34817,e,t),Hi(34818,e,t),Hi(34819,e,t))},n5={enable:(r,e)=>r({[e]:!0}),disable:(r,e)=>r({[e]:!1}),pixelStorei:(r,e,t)=>r({[e]:t}),hint:(r,e,t)=>r({[e]:t}),bindFramebuffer:(r,e,t)=>{switch(e){case 36160:return r({36006:t,36010:t});case 36009:return r({36006:t});case 36008:return r({36010:t});default:return null}},blendColor:(r,e,t,n,i)=>r({32773:new Float32Array([e,t,n,i])}),blendEquation:(r,e)=>r({32777:e,34877:e}),blendEquationSeparate:(r,e,t)=>r({32777:e,34877:t}),blendFunc:(r,e,t)=>r({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(r,e,t,n,i)=>r({32969:e,32968:t,32971:n,32970:i}),clearColor:(r,e,t,n,i)=>r({3106:new Float32Array([e,t,n,i])}),clearDepth:(r,e)=>r({2931:e}),clearStencil:(r,e)=>r({2961:e}),colorMask:(r,e,t,n,i)=>r({3107:[e,t,n,i]}),cullFace:(r,e)=>r({2885:e}),depthFunc:(r,e)=>r({2932:e}),depthRange:(r,e,t)=>r({2928:new Float32Array([e,t])}),depthMask:(r,e)=>r({2930:e}),frontFace:(r,e)=>r({2886:e}),lineWidth:(r,e)=>r({2849:e}),polygonOffset:(r,e,t)=>r({32824:e,10752:t}),sampleCoverage:(r,e,t)=>r({32938:e,32939:t}),scissor:(r,e,t,n,i)=>r({3088:new Int32Array([e,t,n,i])}),stencilMask:(r,e)=>r({2968:e,36005:e}),stencilMaskSeparate:(r,e,t)=>r({[e===1028?2968:36005]:t}),stencilFunc:(r,e,t,n)=>r({2962:e,2967:t,2963:n,34816:e,36003:t,36004:n}),stencilFuncSeparate:(r,e,t,n,i)=>r({[e===1028?2962:34816]:t,[e===1028?2967:36003]:n,[e===1028?2963:36004]:i}),stencilOp:(r,e,t,n)=>r({2964:e,2965:t,2966:n,34817:e,34818:t,34819:n}),stencilOpSeparate:(r,e,t,n,i)=>r({[e===1028?2964:34817]:t,[e===1028?2965:34818]:n,[e===1028?2966:34819]:i}),viewport:(r,e,t,n,i)=>r({2978:[e,t,n,i]})},Nl=(r,e)=>r.isEnabled(e),i5={3042:Nl,2884:Nl,2929:Nl,3024:Nl,32823:Nl,32926:Nl,32928:Nl,3089:Nl,2960:Nl,35977:Nl};function s5(r){for(const e in r)return!1;return!0}function I7(r,e){if(r===e)return!0;const t=Array.isArray(r)||ArrayBuffer.isView(r),n=Array.isArray(e)||ArrayBuffer.isView(e);if(t&&n&&r.length===e.length){for(let i=0;i<r.length;++i)if(r[i]!==e[i])return!1;return!0}return!1}function o5(r,e){const t=r[e].bind(r);r[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in r.state.cache?r.state.enable?r.state.cache[i]:t(...arguments):t(...arguments)},Object.defineProperty(r[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function L7(r,e,t){const n=r[e].bind(r);r[e]=function(){for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];const{valueChanged:A,oldValue:f}=t(r.state._updateCache,...a);return A&&n(...a),f},Object.defineProperty(r[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function F7(r){const e=r.useProgram.bind(r);r.useProgram=function(n){r.state.program!==n&&(e(n),r.state.program=n)}}class M7{constructor(e){let{copyState:t=!1,log:n=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?U7(e):Object.assign({},Mv),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Mo(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];Cu(this.gl,e),this.stateStack.pop()}_updateCache(e){let t=!1,n;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Mo(s!==void 0);const a=e[s],o=this.cache[s];I7(a,o)||(t=!0,n=o,i&&!(s in i)&&(i[s]=o),this.cache[s]=a)}return{valueChanged:t,oldValue:n}}}function a5(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:t=!0,copyState:n}=e;if(Mo(n!==void 0),!r.state){const{polyfillContext:i}=globalThis;i&&i(r),r.state=new M7(r,{copyState:n}),F7(r);for(const s in n5){const a=n5[s];L7(r,s,a)}o5(r,"getParameter"),o5(r,"isEnabled")}return r.state.enable=t,r}function P7(r){r.state||a5(r,{copyState:!1}),r.state.push()}function c5(r){Mo(r.state),r.state.pop()}function Cu(r,e){if(Mo(s0(r),"setParameters requires a WebGL context"),s5(e))return;const t={};for(const i in e){const s=Number(i),a=S7[i];a&&(typeof a=="string"?t[a]=!0:a(r,e[i],s))}const n=r.state&&r.state.cache;if(n)for(const i in t){const s=T7[i];s(r,e,n)}}function U7(r,e){if(e=e||Mv,typeof e=="number"){const i=e,s=i5[i];return s?s(r,i):r.getParameter(i)}const t=Array.isArray(e)?e:Object.keys(e),n={};for(const i of t){const s=i5[i];n[i]=s?s(r,Number(i)):r.getParameter(Number(i))}return n}function R7(r){Cu(r,Mv)}function Dc(r,e,t){if(s5(e))return t(r);const{nocatch:n=!0}=e;P7(r),Cu(r,e);let i;if(n)i=t(r),c5(r);else try{i=t(r)}finally{c5(r)}return i}function Nd(r){const{luma:e}=r;if(r.canvas&&e){const t=e.canvasSizeInfo,n="clientWidth"in t?t.clientWidth:r.canvas.clientWidth;return n?r.drawingBufferWidth/n:1}return 1}function Pv(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=Nd(r),i=r.drawingBufferWidth,s=r.drawingBufferHeight;return D7(e,n,i,s,t)}function O7(r){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(r)?r<=0?1:r:r?e:1}function D7(r,e,t,n,i){const s=l5(r[0],e,t);let a=u5(r[1],e,n,i),o=l5(r[0]+1,e,t);const A=o===t-1?o:o-1;o=u5(r[1]+1,e,n,i);let f;return i?(o=o===0?o:o+1,f=a,a=o):f=o===n-1?o:o-1,{x:s,y:a,width:Math.max(A-s+1,1),height:Math.max(f-a+1,1)}}function l5(r,e,t){return Math.min(Math.round(r*e),t-1)}function u5(r,e,t,n){return n?Math.max(0,t-1-Math.round(r*e)):Math.min(Math.round(r*e),t-1)}const Uv=Bu(),k7=Uv&&typeof document<"u",A5={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function h5(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Mo(Uv,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),r=Object.assign({},A5,r);const{width:e,height:t}=r;function n(o){if(r.throwOnError)throw new Error(o);return console.error(o),null}r.onError=n;let i;const{canvas:s}=r,a=z7({canvas:s,width:e,height:t,onError:n});return i=H7(a,r),i?(i=Rv(i,r),G7(i),i):null}function Rv(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!r||r._instrumented)return r;r._version=r._version||V7(r),r.luma=r.luma||{},r.luma.canvasSizeInfo=r.luma.canvasSizeInfo||{},e=Object.assign({},A5,e);const{manageState:t,debug:n}=e;return t&&a5(r,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return yr.log(1,...s)()}}),Uv&&n&&(globalThis.makeDebugContext?(r=globalThis.makeDebugContext(r,e),yr.level=Math.max(yr.level,1)):yr.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),r._instrumented=!0,r}function N7(r){const e=r.getParameter(7936),t=r.getParameter(7937),n=r.getExtension("WEBGL_debug_renderer_info"),i=n&&r.getParameter(n.UNMASKED_VENDOR_WEBGL||7936),s=n&&r.getParameter(n.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||t,vendorMasked:e,rendererMasked:t,version:r.getParameter(7938),shadingLanguageVersion:r.getParameter(35724)}}function Q7(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r.canvas){const n=O7(e.useDevicePixels);j7(r,n,e);return}const t=r.getExtension("STACKGL_resize_drawingbuffer");t&&"width"in e&&"height"in e&&t.resize(e.width,e.height)}function H7(r,e){const{onError:t}=e;let n=null;const i=A=>n=A.statusMessage||n;r.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:a=!0}=e;let o=null;return a&&(o=o||r.getContext("webgl2",e),o=o||r.getContext("experimental-webgl2",e)),s&&(o=o||r.getContext("webgl",e),o=o||r.getContext("experimental-webgl",e)),r.removeEventListener("webglcontextcreationerror",i,!1),o?(e.onContextLost&&r.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&r.addEventListener("webglcontextrestored",e.onContextRestored,!1),o):t("Failed to create ".concat(a&&!s?"WebGL2":"WebGL"," context: ").concat(n||"Unknown error"))}function z7(r){let{canvas:e,width:t=800,height:n=600,onError:i}=r,s;return typeof e=="string"?(k7&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(t)?"".concat(t,"px"):"100%",s.style.height=Number.isFinite(n)?"".concat(n,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function G7(r){const e=gn(r)?"WebGL2":"WebGL1",t=N7(r),n=t?"(".concat(t.vendor,",").concat(t.renderer,")"):"",i=r.debug?" debug":"";yr.info(1,"".concat(e).concat(i," context ").concat(n))()}function V7(r){return typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?2:1}function j7(r,e,t){let n="width"in t?t.width:r.canvas.clientWidth,i="height"in t?t.height:r.canvas.clientHeight;(!n||!i)&&(yr.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,n=r.canvas.width||1,i=r.canvas.height||1),r.luma=r.luma||{},r.luma.canvasSizeInfo=r.luma.canvasSizeInfo||{};const s=r.luma.canvasSizeInfo;if(s.clientWidth!==n||s.clientHeight!==i||s.devicePixelRatio!==e){let a=e;const o=Math.floor(n*a),A=Math.floor(i*a);r.canvas.width=o,r.canvas.height=A,(r.drawingBufferWidth!==o||r.drawingBufferHeight!==A)&&(yr.warn("Device pixel ratio clamped")(),a=Math.min(r.drawingBufferWidth/n,r.drawingBufferHeight/i),r.canvas.width=Math.floor(n*a),r.canvas.height=Math.floor(i*a)),Object.assign(r.luma.canvasSizeInfo,{clientWidth:n,clientHeight:i,devicePixelRatio:e})}}function d5(){let r;if(typeof window<"u"&&window.performance)r=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();r=e[0]*1e3+e[1]/1e6}else r=Date.now();return r}let f5=class{constructor(e,t){W(this,"name",void 0),W(this,"type",void 0),W(this,"sampleSize",1),W(this,"time",void 0),W(this,"count",void 0),W(this,"samples",void 0),W(this,"lastTiming",void 0),W(this,"lastSampleTime",void 0),W(this,"lastSampleCount",void 0),W(this,"_count",0),W(this,"_time",0),W(this,"_samples",0),W(this,"_startTime",0),W(this,"_timerPending",!1),this.name=e,this.type=t,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=d5(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(d5()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},Ov=class{constructor(e){W(this,"id",void 0),W(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(t=>this._getOrCreate(t))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:n}=e;return this.stats[t]||(e instanceof f5?this.stats[t]=e:this.stats[t]=new f5(t,n)),this.stats[t]}};const Vp="8.5.21",q7="set luma.log.level=1 (or higher) to trace rendering";class K7{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new Ov({id:e})),this.stats.get(e)}}const Ih=new K7;if(globalThis.luma&&globalThis.luma.VERSION!==Vp)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Vp));globalThis.luma||(Bu()&&yr.log(1,"luma.gl ".concat(Vp," - ").concat(q7))(),globalThis.luma=globalThis.luma||{VERSION:Vp,version:Vp,log:yr,stats:Ih,globals:{modules:{},nodeIO:{}}});function W7(r){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(r):setTimeout(r,1e3/60)}function $7(r){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(r):clearTimeout(r)}function ar(r,e){if(!r)throw new Error(e||"luma.gl: assertion failed.")}function Dv(r,e){if(typeof e!="string")return e;const t=Number(e);if(!isNaN(t))return t;e=e.replace(/^.*\./,"");const n=r[e];return ar(n!==void 0,"Accessing undefined constant GL.".concat(e)),n}function CA(r,e){e=Number(e);for(const t in r)if(r[t]===e)return"GL.".concat(t);return String(e)}const kv={};function Eu(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";kv[r]=kv[r]||1;const e=kv[r]++;return"".concat(r,"-").concat(e)}function p5(r){return ar(typeof r=="number","Input must be a number"),r&&(r&r-1)===0}function Qd(r){let e=!0;for(const t in r){e=!1;break}return e}function g5(r,e,t,n){const i="See luma.gl ".concat(t," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(r);n.forEach(a=>{s.methodName||(s[a]=()=>{throw yr.removed("Calling removed method ".concat(e,".").concat(a,": "),i)(),new Error(a)})})}const Hd="Resource subclass must define virtual methods";let Su=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};o0(e);const{id:n,userData:i={}}=t;this.gl=e,this.gl2=e,this.id=n||Eu(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=t.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach(n=>n.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let t;return this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t}unbind(){this.bind(null)}getParameter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=Dv(this.gl,e),ar(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=gn(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const o=i.webgl1,A="webgl2"in i?i.webgl2:i.webgl1;return s?A:o}}return this._getParameter(e,t)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:t,keys:n}=e,i=this.constructor.PARAMETERS||{},s=gn(this.gl),a={},o=t||Object.keys(i);for(const A of o){const f=i[A];if(f&&(!("webgl2"in f)||s)&&(!("extension"in f)||this.gl.getExtension(f.extension))){const v=n?CA(this.gl,A):A;a[v]=this.getParameter(A,e),n&&f.type==="GLenum"&&(a[v]=CA(this.gl,a[v]))}}return a}setParameter(e,t){e=Dv(this.gl,e),ar(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=gn(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(t=Dv(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,n){return g5(this,e,t,n)}initialize(e){}_createHandle(){throw new Error(Hd)}_deleteHandle(){throw new Error(Hd)}_bindHandle(e){throw new Error(Hd)}_getOptsFromHandle(){throw new Error(Hd)}_getParameter(e,t){throw new Error(Hd)}_setParameter(e,t){throw new Error(Hd)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],t=Ih.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get("".concat(e,"s Created")).incrementCount(),t.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Ih.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,t),this._trackAllocatedMemoryForContext(e,t,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=Ih.get("Memory Usage".concat(n));i.get("GPU Memory").addCount(e),i.get("".concat(t," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=Ih.get("Memory Usage".concat(t));n.get("GPU Memory").subtractCount(this.byteLength),n.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const X7="Failed to deduce GL constant from typed array";function Nv(r){switch(ArrayBuffer.isView(r)?r.constructor:r){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(X7)}}function jp(r){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(r){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function J7(r){let{data:e,width:t,height:n,bytesPerPixel:i=4,temp:s}=r;const a=t*i;s=s||new Uint8Array(a);for(let o=0;o<n/2;++o){const A=o*a,f=(n-o-1)*a;s.set(e.subarray(A,A+a)),e.copyWithin(A,f,f+a),e.set(s,f)}}function Y7(r){let{data:e,width:t,height:n}=r;const i=Math.round(t/2),s=Math.round(n/2),a=new Uint8Array(i*s*4);for(let o=0;o<s;o++)for(let A=0;A<i;A++)for(let f=0;f<4;f++)a[(o*i+A)*4+f]=e[(o*2*t+A*2)*4+f];return{data:a,width:i,height:s}}function Qv(r,e,t){const{removedProps:n={},deprecatedProps:i={},replacedProps:s={}}=t;for(const o in n)if(o in e){const f=n[o]?"".concat(r,".").concat(n[o]):"N/A";yr.removed("".concat(r,".").concat(o),f)()}for(const o in i)if(o in e){const A=i[o];yr.deprecated("".concat(r,".").concat(o),"".concat(r,".").concat(A))()}let a=null;for(const o in s)if(o in e){const A=s[o];yr.deprecated("".concat(r,".").concat(o),"".concat(r,".").concat(A))(),a=a||Object.assign({},e),a[A]=e[o],delete a[o]}return a||e}const Z7={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},eH={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class aa{static getBytesPerElement(e){return jp(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return ar(e.size),jp(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new aa(Z7,...t)}constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return aa.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return aa.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=Qv("Accessor",e,eH),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const m5=10,y5={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},tH={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:y5},rH={removedProps:y5};class ri extends Su{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/aa.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/aa.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=Qv("Buffer",e,tH),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=Qv("Buffer",e,rH),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new aa(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:n=0,srcOffset:i=0}=e,s=e.byteLength||e.length;ar(t);const a=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(a,this.handle),i!==0||s!==void 0?(Po(this.gl),this.gl.bufferSubData(this.target,n,t,i,s)):this.gl.bufferSubData(a,n,t),this.gl.bindBuffer(a,null),this.debugData=null,this._inferType(t),this}copyData(e){let{sourceBuffer:t,readOffset:n=0,writeOffset:i=0,size:s}=e;const{gl:a}=this;return Po(a),a.bindBuffer(36662,t.handle),a.bindBuffer(36663,this.handle),a.copyBufferSubData(36662,36663,n,i,s),a.bindBuffer(36662,null),a.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:t=0,dstOffset:n=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Po(this.gl);const s=jp(this.accessor.type||5126,{clamped:!1}),a=this._getAvailableElementCount(t),o=n;let A,f;e?(f=e.length,A=f-o):(A=Math.min(a,i||a),f=o+A);const m=Math.min(a,A);return i=i||m,ar(i<=m),e=e||new s(f),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,n,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:n=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,t,this.handle,n,i):(ar(n===0),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:t=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(m5,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+t;ar(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.usage),this.gl.bufferSubData(i,t,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,m5),this.bytesUsed=n,this._trackAllocatedMemory(n);const s=Nv(e);return ar(s),this.setAccessor(new aa(this.accessor,{type:s})),this}_setByteLength(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;ar(e>=0),this._trackDeallocatedMemory();let n=e;e===0&&(n=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,t),this.gl.bindBuffer(i,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const t=jp(this.accessor.type||5126,{clamped:!1}),n=e/t.BYTES_PER_ELEMENT;return this.getElementCount()-n}_inferType(e){this.accessor.type||this.setAccessor(new aa(this.accessor,{type:Nv(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return yr.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return yr.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return yr.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return yr.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new aa(this.accessor,e),this}}const Hv={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},_5={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},v5={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function nH(r,e){const t=Hv[e];if(!t)return!1;if(t.gl1===void 0&&t.gl2===void 0)return!0;const n=gn(r)&&t.gl2||t.gl1;return typeof n=="string"?r.getExtension(n):n}function iH(r,e){const t=Hv[e];switch(t&&t.types[0]){case 5126:return r.getExtension("OES_texture_float_linear");case 5131:return r.getExtension("OES_texture_half_float_linear");default:return!0}}const sH=[9729,9728],b5=globalThis.WebGLBuffer||function(){};class zd extends Su{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:n,linearFiltering:i}=t;let s=!0;return n&&(s=s&&nH(e,n),s=s&&(!i||iH(e,n))),s}constructor(e,t){const{id:n=Eu("texture"),handle:i,target:s}=t;super(e,{id:n,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.data;if(t instanceof Promise)return t.then(q=>this.initialize(Object.assign({},e,{pixels:q,data:q}))),this;const n=typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement;if(n&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:a=0,recreate:o=!1,parameters:A={},pixelStore:f={},textureUnit:m=void 0}=e;t||(t=i);let{width:v,height:x,dataFormat:B,type:M,compressed:U=!1,mipmaps:N=!0}=e;const{depth:Q=0}=e;return{width:v,height:x,compressed:U,dataFormat:B,type:M}=this._deduceParameters({format:s,type:M,dataFormat:B,compressed:U,data:t,width:v,height:x}),this.width=v,this.height=x,this.depth=Q,this.format=s,this.type=M,this.dataFormat=B,this.border=a,this.textureUnit=m,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),N&&this._isNPOT()&&(yr.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),N=!1,this._updateForNPOT(A)),this.mipmaps=N,this.setImageData({data:t,width:v,height:x,depth:Q,format:s,type:M,dataFormat:B,border:a,mipmaps:N,parameters:f,compressed:U}),N&&this.generateMipmap(),this.setParameters(A),o&&(this.data=t),n&&(this._video={video:t,parameters:A,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:n}=this._video;if(n===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:t,width:n,mipmaps:i=!1}=e;return n!==this.width||t!==this.height?this.initialize({width:n,height:t,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(yr.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Dc(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:n=null,level:i=0,format:s=this.format,border:a=this.border,offset:o=0,parameters:A={}}=e;let{data:f=null,type:m=this.type,width:v=this.width,height:x=this.height,dataFormat:B=this.dataFormat,compressed:M=!1}=e;f||(f=n),{type:m,dataFormat:B,compressed:M,width:v,height:x}=this._deduceParameters({format:s,type:m,dataFormat:B,compressed:M,data:f,width:v,height:x});const{gl:U}=this;U.bindTexture(this.target,this.handle);let N=null;({data:f,dataType:N}=this._getDataType({data:f,compressed:M}));let Q,q=0;if(Dc(this.gl,A,()=>{switch(N){case"null":U.texImage2D(t,i,s,v,x,a,B,m,f);break;case"typed-array":U.texImage2D(t,i,s,v,x,a,B,m,f,o);break;case"buffer":Q=Po(U),Q.bindBuffer(35052,f.handle||f),Q.texImage2D(t,i,s,v,x,a,B,m,o),Q.bindBuffer(35052,null);break;case"browser-object":gn(U)?U.texImage2D(t,i,s,v,x,a,B,m,f):U.texImage2D(t,i,s,B,m,f);break;case"compressed":for(const[Y,te]of f.entries())U.compressedTexImage2D(t,Y,te.format,te.width,te.height,a,te.data),q+=te.levelSize;break;default:ar(!1,"Unknown image data type")}}),N==="compressed")this._trackAllocatedMemory(q,"Texture");else if(f&&f.byteLength)this._trackAllocatedMemory(f.byteLength,"Texture");else{const Y=_5[this.dataFormat]||4,te=v5[this.type]||1;this._trackAllocatedMemory(this.width*this.height*Y*te,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:t=this.target,pixels:n=null,data:i=null,x:s=0,y:a=0,width:o=this.width,height:A=this.height,level:f=0,format:m=this.format,type:v=this.type,dataFormat:x=this.dataFormat,compressed:B=!1,offset:M=0,border:U=this.border,parameters:N={}}=e;if({type:v,dataFormat:x,compressed:B,width:o,height:A}=this._deduceParameters({format:m,type:v,dataFormat:x,compressed:B,data:i,width:o,height:A}),ar(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=n),i&&i.data){const Q=i;i=Q.data,o=Q.shape[0],A=Q.shape[1]}i instanceof ri&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Dc(this.gl,N,()=>{if(B)this.gl.compressedTexSubImage2D(t,f,s,a,o,A,m,i);else if(i===null)this.gl.texSubImage2D(t,f,s,a,o,A,x,v,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(t,f,s,a,o,A,x,v,i,M);else if(i instanceof b5){const Q=Po(this.gl);Q.bindBuffer(35052,i),Q.texSubImage2D(t,f,s,a,o,A,x,v,M),Q.bindBuffer(35052,null)}else gn(this.gl)?Po(this.gl).texSubImage2D(t,f,s,a,o,A,x,v,i):this.gl.texSubImage2D(t,f,s,a,x,v,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return yr.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:t}=this;return e!==void 0&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:t}=this;return e!==void 0&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType(e){let{data:t,compressed:n=!1}=e;return n?{data:t,dataType:"compressed"}:t===null?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof ri?{data:t.handle,dataType:"buffer"}:t instanceof b5?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:n}=e;let{width:i,height:s,dataFormat:a,type:o,compressed:A}=e;const f=Hv[t];return a=a||f&&f.dataFormat,o=o||f&&f.types[0],A=A||f&&f.compressed,{width:i,height:s}=this._deduceImageSize(n,i,s),{dataFormat:a,type:o,compressed:A,width:i,height:s,format:t,data:n}}_deduceImageSize(e,t,n){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:t,height:n}:i={width:t>=0?t:1,height:n>=0?n:1},ar(i,"Could not deduced texture size"),ar(t===void 0||i.width===t,"Deduced texture width does not match supplied width"),ar(n===void 0||i.height===n,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:ar(!1);break;default:this.gl.texParameteri(this.target,e,t);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return gn(this.gl)||!this.width||!this.height?!1:!p5(this.width)||!p5(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:sH.indexOf(t)===-1&&(t=9729);break;case 10242:case 10243:t!==33071&&(t=33071);break}return t}}let oH="";function aH(r,e){return ar(typeof r=="string"),r=oH+r,new Promise((t,n)=>{try{const i=new Image;i.onload=()=>t(i),i.onerror=()=>n(new Error("Could not load image ".concat(r,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=r}catch(i){n(i)}})}class Ia extends zd{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,t){return zd.isSupported(e,t)}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};o0(e),(t instanceof Promise||typeof t=="string")&&(t={data:t}),typeof t.data=="string"&&(t=Object.assign({},t,{data:aH(t.data)})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const zv=[34069,34070,34071,34072,34073,34074];class w5 extends zd{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};o0(e),super(e,Object.assign({},t,{target:34067})),this.initialize(t),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:t=!0,parameters:n={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,t&&this.generateMipmap(e),this.setParameters(n)}),this}subImage(e){let{face:t,data:n,x:i=0,y:s=0,mipmapLevel:a=0}=e;return this._subImage({target:t,data:n,x:i,y:s,mipmapLevel:a})}async setCubeMapImageData(e){let{width:t,height:n,pixels:i,data:s,border:a=0,format:o=6408,type:A=5121}=e;const{gl:f}=this,m=i||s,v=await Promise.all(zv.map(x=>{const B=m[x];return Promise.all(Array.isArray(B)?B:[B])}));this.bind(),zv.forEach((x,B)=>{v[B].length>1&&this.opts.mipmaps!==!1&&yr.warn("".concat(this.id," has mipmap and multiple LODs."))(),v[B].forEach((M,U)=>{t&&n?f.texImage2D(x,U,o,t,n,a,o,A,M):f.texImage2D(x,U,o,o,A,M)})}),this.unbind()}setImageDataForFace(e){const{face:t,width:n,height:i,pixels:s,data:a,border:o=0,format:A=6408,type:f=5121}=e,{gl:m}=this,v=s||a;return this.bind(),v instanceof Promise?v.then(x=>this.setImageDataForFace(Object.assign({},e,{face:t,data:x,pixels:x}))):this.width||this.height?m.texImage2D(t,0,A,n,i,o,A,f,v):m.texImage2D(t,0,A,A,f,v),this}}w5.FACES=zv;class cH extends zd{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return gn(e)}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Po(e),t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1}),super(e,t),this.initialize(t),Object.seal(this)}setImageData(e){let{level:t=0,dataFormat:n=6408,width:i,height:s,depth:a=1,border:o=0,format:A,type:f=5121,offset:m=0,data:v,parameters:x={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Dc(this.gl,x,()=>{ArrayBuffer.isView(v)&&this.gl.texImage3D(this.target,t,n,i,s,a,o,A,f,v),v instanceof ri&&(this.gl.bindBuffer(35052,v.handle),this.gl.texImage3D(this.target,t,n,i,s,a,o,A,f,m))}),v&&v.byteLength)this._trackAllocatedMemory(v.byteLength,"Texture");else{const B=_5[this.dataFormat]||4,M=v5[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*B*M,"Texture")}return this.loaded=!0,this}}const Lh="EXT_color_buffer_float",x5={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Lh,bpp:2},33327:{gl2:Lh,bpp:4},34842:{gl2:Lh,bpp:8},33326:{gl2:Lh,bpp:4},33328:{gl2:Lh,bpp:8},34836:{gl2:Lh,bpp:16},35898:{gl2:Lh,bpp:4}};function lH(r,e,t){const n=t[e];if(!n)return!1;const i=gn(r)&&n.gl2||n.gl1;return typeof i=="string"?r.getExtension(i):i}class Gd extends Su{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!t||lH(e,t,x5)}static getSamplesForFormat(e,t){let{format:n}=t;return e.getInternalformatParameter(36161,n,32937)}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,t),this.initialize(t),Object.seal(this)}initialize(e){let{format:t,width:n=1,height:i=1,samples:s=0}=e;return ar(t,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&gn(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,t,n,i):this.gl.renderbufferStorage(36161,t,n,i),this.format=t,this.width=n,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*x5[this.format].bpp),this}resize(e){let{width:t,height:n}=e;return t!==this.width||n!==this.height?this.initialize({width:t,height:n,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const uH=256,AH=1024,hH=16384,B5=6144,C5=6145,E5=6146,S5=34041,T5="clear: bad arguments";function Gv(r){let{framebuffer:e=null,color:t=null,depth:n=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let a=0;t&&(a|=hH,t!==!0&&(s.clearColor=t)),n&&(a|=uH,n!==!0&&(s.clearDepth=n)),i&&(a|=AH,n!==!0&&(s.clearStencil=n)),ar(a!==0,T5),Dc(r,s,()=>{r.clear(a)})}function dH(r){let{framebuffer:e=null,buffer:t=B5,drawBuffer:n=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Po(r),Dc(r,{framebuffer:e},()=>{switch(t){case B5:switch(i.constructor){case Int32Array:r.clearBufferiv(t,n,i);break;case Uint32Array:r.clearBufferuiv(t,n,i);break;case Float32Array:default:r.clearBufferfv(t,n,i)}break;case C5:r.clearBufferfv(C5,0,[i]);break;case E5:r.clearBufferiv(E5,0,[i]);break;case S5:const[s,a]=i;r.clearBufferfi(S5,0,s,a);break;default:ar(!1,T5)}})}function fH(r){switch(r){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return ar(!1),0}}function a0(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:t=0,sourceY:n=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:a=null,sourceWidth:o,sourceHeight:A,sourceType:f}=e;const{framebuffer:m,deleteFramebuffer:v}=pH(r);ar(m);const{gl:x,handle:B,attachments:M}=m;o=o||m.width,A=A||m.height,s===36064&&B===null&&(s=1028),ar(M[s]),f=f||M[s].type,a=gH(a,f,i,o,A),f=f||Nv(a);const U=x.bindFramebuffer(36160,B);return x.readPixels(t,n,o,A,i,f,a),x.bindFramebuffer(36160,U||null),v&&m.delete(),a}function I5(r){let{sourceAttachment:e=36064,targetMaxHeight:t=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=a0(r,{sourceAttachment:e}),{width:i,height:s}=r;for(;s>t;)({data:n,width:i,height:s}=Y7({data:n,width:i,height:s}));J7({data:n,width:i,height:s});const a=document.createElement("canvas");a.width=i,a.height=s;const o=a.getContext("2d"),A=o.createImageData(i,s);return A.data.set(n),o.putImageData(A,0,0),a.toDataURL()}function pH(r){return r instanceof bs?{framebuffer:r,deleteFramebuffer:!1}:{framebuffer:CH(r),deleteFramebuffer:!0}}function gH(r,e,t,n,i){if(r)return r;e=e||5121;const s=jp(e,{clamped:!1}),a=fH(t);return new s(n*i*a)}const gi={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function mH(r){const e=new Ia(r,{format:6408,type:5126,dataFormat:6408}),t=new bs(r,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),n=t.getStatus();return e.delete(),t.delete(),n===36053}const L5={[gi.WEBGL2]:[!1,!0],[gi.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[gi.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[gi.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[gi.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[gi.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[gi.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[gi.FLOAT_BLEND]:["EXT_float_blend"],[gi.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[gi.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[gi.TEXTURE_FLOAT]:["OES_texture_float",!0],[gi.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[gi.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[gi.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[gi.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[gi.COLOR_ATTACHMENT_RGBA32F]:[mH,"EXT_color_buffer_float"],[gi.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[gi.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[gi.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[gi.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[gi.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[gi.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},yH=2;function Vv(r,e){return F5(r,e)}function F5(r,e){return e=Array.isArray(e)?e:[e],e.every(t=>M5(r,t))}function _H(r){r.luma=r.luma||{},r.luma.caps=r.luma.caps||{};for(const e in L5)r.luma.caps[e]===void 0&&(r.luma.caps[e]=M5(r,e));return r.luma.caps}function M5(r,e){return r.luma=r.luma||{},r.luma.caps=r.luma.caps||{},r.luma.caps[e]===void 0&&(r.luma.caps[e]=vH(r,e)),r.luma.caps[e]||yr.log(yH,"Feature: ".concat(e," not supported"))(),r.luma.caps[e]}function vH(r,e){const t=L5[e];ar(t,e);let n;const i=gn(r)&&t[1]||t[0];if(typeof i=="function")n=i(r);else if(Array.isArray(i)){n=!0;for(const s of i)n=n&&!!r.getExtension(s)}else typeof i=="string"?n=!!r.getExtension(i):typeof i=="boolean"?n=i:ar(!1);return n}const P5="Multiple render targets not supported";class bs extends Su{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:n,colorBufferHalfFloat:i}=t;let s=!0;return n&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new bs(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Po(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Po(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:t=1,height:n=1,attachments:i=null,color:s=!0,depth:a=!0,stencil:o=!1,check:A=!0,readBuffer:f=void 0,drawBuffers:m=void 0}=e;if(ar(t>=0&&n>=0,"Width and height need to be integers"),this.width=t,this.height=n,i)for(const v in i){const x=i[v];(Array.isArray(x)?x[0]:x).resize({width:t,height:n})}else i=this._createDefaultAttachments(s,a,o,t,n);this.update({clearAttachments:!0,attachments:i,readBuffer:f,drawBuffers:m}),i&&A&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:t={},readBuffer:n,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:a=!0}=e;this.attach(t,{clearAttachments:s,resizeAttachments:a});const{gl:o}=this,A=o.bindFramebuffer(36160,this.handle);return n&&this._setReadBuffer(n),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,A||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:t,height:n}=e;if(this.handle===null)return ar(t===void 0&&n===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;t===void 0&&(t=this.gl.drawingBufferWidth),n===void 0&&(n=this.gl.drawingBufferHeight),t!==this.width&&n!==this.height&&yr.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(t,"x").concat(n))();for(const i in this.attachments)this.attachments[i].resize({width:t,height:n});return this.width=t,this.height=n,this}attach(e){let{clearAttachments:t=!1,resizeAttachments:n=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};t&&Object.keys(this.attachments).forEach(a=>{i[a]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const a in i){ar(a!==void 0,"Misspelled framebuffer binding point?");const o=Number(a),A=i[o];let f=A;if(!f)this._unattach(o);else if(f instanceof Gd)this._attachRenderbuffer({attachment:o,renderbuffer:f});else if(Array.isArray(A)){const[m,v=0,x=0]=A;f=m,this._attachTexture({attachment:o,texture:m,layer:v,level:x})}else this._attachTexture({attachment:o,texture:f,layer:0,level:0});n&&f&&f.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(a=>!this.attachments[a]).forEach(a=>{delete this.attachments[a]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(wH(e));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),n=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),n}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:t,depth:n,stencil:i,drawBuffers:s=[]}=e,a=this.gl.bindFramebuffer(36160,this.handle);return(t||n||i)&&Gv(this.gl,{color:t,depth:n,stencil:i}),s.forEach((o,A)=>{dH(this.gl,{drawBuffer:A,value:o})}),this.gl.bindFramebuffer(36160,a||null),this}readPixels(){return yr.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return yr.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return yr.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return yr.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return yr.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return yr.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:t=[],x:n=0,y:i=0,width:s,height:a}=e;const o=Po(this.gl),A=o.bindFramebuffer(36008,this.handle);return n===0&&i===0&&s===void 0&&a===void 0?o.invalidateFramebuffer(36008,t):o.invalidateFramebuffer(36008,t,n,i,s,a),o.bindFramebuffer(36008,A),this}getAttachmentParameter(e,t,n){let i=this._getAttachmentParameterFallback(t);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),n&&i>1e3&&(i=CA(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of n){const a=t?CA(this.gl,s):s;i[a]=this.getAttachmentParameter(e,s,t)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const t=Object.keys(this.attachments),n={};for(const i of t){const s=Number(i),a=e?CA(this.gl,s):s;n[a]=this.getAttachmentParameters(s,e)}return n}show(){return typeof window<"u"&&window.open(I5(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>yr.level||typeof window>"u")return this;t=t||"Framebuffer ".concat(this.id);const n=I5(this,{targetMaxHeight:100});return yr.image({logLevel:e,message:t,image:n},t)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,n,i,s){let a=null;return e&&(a=a||{},a[36064]=new Ia(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(a[36064])),t&&n?(a=a||{},a[33306]=new Gd(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(a[33306])):t?(a=a||{},a[36096]=new Gd(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(a[36096])):n&&ar(!1),a}_unattach(e){const t=this.attachments[e];t&&(t instanceof Gd?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:t=36064,renderbuffer:n}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,t,36161,n.handle),this.attachments[t]=n}_attachTexture(e){let{attachment:t=36064,texture:n,layer:i,level:s}=e;const{gl:a}=this;switch(a.bindTexture(n.target,n.handle),n.target){case 35866:case 32879:Po(a).framebufferTextureLayer(36160,t,n.target,s,i);break;case 34067:const A=bH(i);a.framebufferTexture2D(36160,t,A,n.handle,s);break;case 3553:a.framebufferTexture2D(36160,t,3553,n.handle,s);break;default:ar(!1,"Illegal texture type")}a.bindTexture(n.target,null),this.attachments[t]=n}_setReadBuffer(e){const t=JQ(this.gl);t?t.readBuffer(e):ar(e===36064||e===1029,P5),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,n=Po(t);if(n)n.drawBuffers(e);else{const i=t.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):ar(e.length===1&&(e[0]===36064||e[0]===1029),P5)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=_H(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return!t.WEBGL2&&!t.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function bH(r){return r<34069?r+34069:r}function wH(r){return(bs.STATUS||{})[r]||"Framebuffer error ".concat(r)}const xH=[36049,36048,33296,33298,33299,33300,33301,33302,33303];bs.ATTACHMENT_PARAMETERS=xH;function BH(r,e){ar(r instanceof Ia||r instanceof w5||r instanceof cH);const t=r.constructor,{gl:n,width:i,height:s,format:a,type:o,dataFormat:A,border:f,mipmaps:m}=r,v=Object.assign({width:i,height:s,format:a,type:o,dataFormat:A,border:f,mipmaps:m},e);return new t(n,v)}function CH(r,e){const{gl:t,width:n,height:i,id:s}=r;return new bs(t,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:n,height:i,attachments:{36064:r}}))}function c0(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const t=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,n=r.match(t);return n?n[1]:e}const EH=35632,SH=35633;function TH(r){switch(r){case EH:return"fragment";case SH:return"vertex";default:return"unknown type"}}function IH(r,e,t,n){const i=r.split(/\r?\n/),s={},a={},o=n||c0(e)||"(unnamed)",A="".concat(TH(t)," shader ").concat(o);for(let m=0;m<i.length;m++){const v=i[m];if(v.length<=1)continue;const x=v.split(":"),B=x[0],M=parseInt(x[2],10);if(isNaN(M))throw new Error("GLSL compilation error in ".concat(A,": ").concat(r));B!=="WARNING"?s[M]=v:a[M]=v}const f=LH(e);return{shaderName:A,errors:U5(s,f),warnings:U5(a,f)}}function U5(r,e){let t="";for(let n=0;n<e.length;n++){const i=e[n];if(!(!r[n+3]&&!r[n+2]&&!r[n+1])&&(t+="".concat(i,`
`),r[n+1])){const s=r[n+1],a=s.split(":",3),o=a[0],A=parseInt(a[1],10)||0,f=s.substring(a.join(":").length+1).trim();t+=R5("^^^ ".concat(o,": ").concat(f,`

`),A)}}return t}function LH(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const n=r.split(/\r?\n/),i=String(n.length+e-1).length;return n.map((s,a)=>{const o=String(a+e),A=o.length;return R5(o,i-A)+t+s})}function R5(r,e){let t="";for(let n=0;n<e;++n)t+=" ";return"".concat(t).concat(r)}function O5(r){let e=100;const t=r.match(/[^\s]+/g);if(t.length>=2&&t[0]==="#version"){const n=parseInt(t[1],10);Number.isFinite(n)&&(e=n)}return e}const FH="Shader: GLSL source code must be a JavaScript string";class qp extends Su{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return ar(!1),"unknown"}}constructor(e,t){o0(e),ar(typeof t.source=="string",FH);const n=c0(t.source,null)||t.id||Eu("unnamed ".concat(qp.getTypeName(t.shaderType)));super(e,{id:n}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize(e){let{source:t}=e;const n=c0(t,null);n&&(this.id=Eu(n)),this._compile(t)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(qp.getTypeName(this.shaderType),":").concat(this.id)}getName(){return c0(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const n=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:a}=IH(n,this.source,this.shaderType,this.id);throw yr.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),yr.warn("GLSL compilation warnings in ".concat(i,`
`).concat(a))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class jv extends qp{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,t){typeof t=="string"&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class qv extends qp{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,t){typeof t=="string"&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const MH={5126:vi.bind(null,"uniform1fv",La,1,co),35664:vi.bind(null,"uniform2fv",La,2,co),35665:vi.bind(null,"uniform3fv",La,3,co),35666:vi.bind(null,"uniform4fv",La,4,co),5124:vi.bind(null,"uniform1iv",EA,1,co),35667:vi.bind(null,"uniform2iv",EA,2,co),35668:vi.bind(null,"uniform3iv",EA,3,co),35669:vi.bind(null,"uniform4iv",EA,4,co),35670:vi.bind(null,"uniform1iv",EA,1,co),35671:vi.bind(null,"uniform2iv",EA,2,co),35672:vi.bind(null,"uniform3iv",EA,3,co),35673:vi.bind(null,"uniform4iv",EA,4,co),35674:vi.bind(null,"uniformMatrix2fv",La,4,Tu),35675:vi.bind(null,"uniformMatrix3fv",La,9,Tu),35676:vi.bind(null,"uniformMatrix4fv",La,16,Tu),35678:qs,35680:qs,5125:vi.bind(null,"uniform1uiv",l0,1,co),36294:vi.bind(null,"uniform2uiv",l0,2,co),36295:vi.bind(null,"uniform3uiv",l0,3,co),36296:vi.bind(null,"uniform4uiv",l0,4,co),35685:vi.bind(null,"uniformMatrix2x3fv",La,6,Tu),35686:vi.bind(null,"uniformMatrix2x4fv",La,8,Tu),35687:vi.bind(null,"uniformMatrix3x2fv",La,6,Tu),35688:vi.bind(null,"uniformMatrix3x4fv",La,12,Tu),35689:vi.bind(null,"uniformMatrix4x2fv",La,8,Tu),35690:vi.bind(null,"uniformMatrix4x3fv",La,12,Tu),35678:qs,35680:qs,35679:qs,35682:qs,36289:qs,36292:qs,36293:qs,36298:qs,36299:qs,36300:qs,36303:qs,36306:qs,36307:qs,36308:qs,36311:qs},PH={},UH={},RH={},D5=[0];function Kv(r,e,t,n){e===1&&typeof r=="boolean"&&(r=r?1:0),Number.isFinite(r)&&(D5[0]=r,r=D5);const i=r.length;if(i%e&&yr.warn("Uniform size should be multiples of ".concat(e),r)(),r instanceof t)return r;let s=n[i];s||(s=new t(i),n[i]=s);for(let a=0;a<i;a++)s[a]=r[a];return s}function La(r,e){return Kv(r,e,Float32Array,PH)}function EA(r,e){return Kv(r,e,Int32Array,UH)}function l0(r,e){return Kv(r,e,Uint32Array,RH)}function k5(r,e,t){const n=MH[t.type];if(!n)throw new Error("Unknown GLSL uniform type ".concat(t.type));return n().bind(null,r,e)}function OH(r){if(r[r.length-1]!=="]")return{name:r,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,t=r.match(e);if(!t||t.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(r));return{name:t[1],length:t[2]||1,isArray:!!t[2]}}function DH(r,e,t){for(const n in r){const i=r[n];if((!t||!!t[n])&&!kH(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(n),i),new Error("".concat(e," Bad uniform ").concat(n))}return!0}function kH(r){return Array.isArray(r)||ArrayBuffer.isView(r)?QH(r):isFinite(r)||r===!0||r===!1||r instanceof zd||r instanceof Gd?!0:r instanceof bs?!!r.texture:!1}function NH(r,e,t){if(Array.isArray(t)||ArrayBuffer.isView(t))if(r[e]){const n=r[e];for(let i=0,s=t.length;i<s;++i)n[i]=t[i]}else r[e]=t.slice();else r[e]=t}function QH(r){if(r.length===0)return!1;const e=Math.min(r.length,16);for(let t=0;t<e;++t)if(!Number.isFinite(r[t]))return!1;return!0}function qs(){let r=null;return(e,t,n)=>{const i=r!==n;return i&&(e.uniform1i(t,n),r=n),i}}function vi(r,e,t,n){let i=null,s=null;return(a,o,A)=>{const f=e(A,t),m=f.length;let v=!1;if(i===null)i=new Float32Array(m),s=m,v=!0;else{ar(s===m,"Uniform length cannot change.");for(let x=0;x<m;++x)if(f[x]!==i[x]){v=!0;break}}return v&&(n(a,r,o,f),i.set(f)),v}}function co(r,e,t,n){r[e](t,n)}function Tu(r,e,t,n){r[e](t,!1,n)}const HH=5120,zH=5121,GH=5122,VH=5123,N5=0,u0=1,jH=2,qH=3,A0=4,KH=5,WH=6,ws=5126,$H=35664,XH=35665,JH=35666,Kp=5124,YH=35667,ZH=35668,ez=35669,Wp=5125,tz=36294,rz=36295,nz=36296,iz=35670,sz=35671,oz=35672,az=35673,cz=35674,lz=35675,uz=35676,Az=35685,hz=35686,dz=35687,fz=35688,pz=35689,gz=35690,Wv={[ws]:[ws,1,"float"],[$H]:[ws,2,"vec2"],[XH]:[ws,3,"vec3"],[JH]:[ws,4,"vec4"],[Kp]:[Kp,1,"int"],[YH]:[Kp,2,"ivec2"],[ZH]:[Kp,3,"ivec3"],[ez]:[Kp,4,"ivec4"],[Wp]:[Wp,1,"uint"],[tz]:[Wp,2,"uvec2"],[rz]:[Wp,3,"uvec3"],[nz]:[Wp,4,"uvec4"],[iz]:[ws,1,"bool"],[sz]:[ws,2,"bvec2"],[oz]:[ws,3,"bvec3"],[az]:[ws,4,"bvec4"],[cz]:[ws,8,"mat2"],[Az]:[ws,8,"mat2x3"],[hz]:[ws,8,"mat2x4"],[lz]:[ws,12,"mat3"],[dz]:[ws,12,"mat3x2"],[fz]:[ws,12,"mat3x4"],[uz]:[ws,16,"mat4"],[pz]:[ws,16,"mat4x2"],[gz]:[ws,16,"mat4x3"]};function mz(r){switch(r){case N5:return N5;case u0:return u0;case qH:return u0;case jH:return u0;case A0:return A0;case KH:return A0;case WH:return A0;default:return ar(!1),0}}function Q5(r){const e=Wv[r];if(!e)return null;const[t,n]=e;return{type:t,components:n}}function H5(r,e){switch(r){case HH:case zH:case GH:case VH:r=ws;break}for(const t in Wv){const[n,i,s]=Wv[t];if(n===r&&i===e)return{glType:t,name:s}}return null}class yz{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,n=t.getProgramParameter(e.handle,35721);for(let i=0;i<n;i++){const{name:s,type:a,size:o}=t.getActiveAttrib(e.handle,i),A=t.getAttribLocation(e.handle,s);A>=0&&this._addAttribute(A,s,a,o)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:t}=e;if(!gn(t))return;const n=t.getProgramParameter(e.handle,35971);for(let i=0;i<n;i++){const{name:s,type:a,size:o}=t.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,a,o)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,t,n,i){const{type:s,components:a}=Q5(n),o={type:s,size:i*a};this._inferProperties(e,t,o);const A={location:e,name:t,accessor:new aa(o)};this.attributeInfos.push(A),this.attributeInfosByLocation[e]=A,this.attributeInfosByName[A.name]=A}_inferProperties(e,t,n){/instance/i.test(t)&&(n.divisor=1)}_addVarying(e,t,n,i){const{type:s,components:a}=Q5(n),o=new aa({type:s,size:i*a}),A={location:e,name:t,accessor:o};this.varyingInfos.push(A),this.varyingInfosByName[A.name]=A}}const z5=4,_z=35981,vz=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class G5 extends Su{get[Symbol.toStringTag](){return"Program"}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,t),this.stubRemovedMethods("Program","v6.0",vz),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:t,vs:n,fs:i,varyings:s,bufferMode:a=_z}=e;return this.hash=t||"",this.vs=typeof n=="string"?new jv(this.gl,{id:"".concat(e.id,"-vs"),source:n}):n,this.fs=typeof i=="string"?new qv(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,ar(this.vs instanceof jv),ar(this.fs instanceof qv),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Po(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,a)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new yz(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:t,drawMode:n=4,vertexCount:i,offset:s=0,start:a,end:o,isIndexed:A=!1,indexType:f=5123,instanceCount:m=0,isInstanced:v=m>0,vertexArray:x=null,transformFeedback:B,framebuffer:M,parameters:U={},uniforms:N,samplers:Q}=e;if((N||Q)&&(yr.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(N||{})),yr.priority>=t){const q=M?M.id:"default",Y="mode=".concat(CA(this.gl,n)," verts=").concat(i," ")+"instances=".concat(m," indexType=").concat(CA(this.gl,f)," ")+"isInstanced=".concat(v," isIndexed=").concat(A," ")+"Framebuffer=".concat(q);yr.log(t,Y)()}return ar(x),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||v&&m===0?!1:(x.bindForDraw(i,m,()=>{if(M!==void 0&&(U=Object.assign({},U,{framebuffer:M})),B){const q=mz(n);B.begin(q)}this._bindTextures(),Dc(this.gl,U,()=>{A&&v?this.gl2.drawElementsInstanced(n,i,f,s,m):A&&gn(this.gl)&&!isNaN(a)&&!isNaN(o)?this.gl2.drawRangeElements(n,a,o,i,f,s):A?this.gl.drawElements(n,i,f,s):v?this.gl2.drawArraysInstanced(n,s,i,m):this.gl.drawArrays(n,s,i)}),B&&B.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};yr.priority>=2&&DH(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const n=e[t],i=this._uniformSetters[t];if(i){let s=n,a=!1;if(s instanceof bs&&(s=s.texture),s instanceof zd)if(a=this.uniforms[t]!==n,a){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const o=s,{textureIndex:A}=i;o.bind(A),s=A,this._textureUniforms[t]=o}else s=i.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(i(s)||a)&&NH(this.uniforms,t,n)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const n=this._textureUniforms[t];n.update(),e=e&&n.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const t=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(t)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),n={};for(const i of t)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new jv({handle:i});break;case 35632:n.fs=new qv({handle:i});break}return n}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const t=this._getName();this.id=Eu(t)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),yr.time(z5,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),yr.timeEnd(z5,"linkProgram for ".concat(this._getName()))(),e.debug||yr.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const n=this.gl.getActiveUniform(this.handle,t),{name:i}=OH(n.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=k5(e,s,n),n.size>1)for(let a=0;a<n.size;a++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(a,"]")),this._uniformSetters["".concat(i,"[").concat(a,"]")]=k5(e,s,n)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}const bz=34918,wz=34919,xz=35007,Bz=36795,Cz=35976,Ez=35887,Sz=36202;class h0 extends Su{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=gn(e),i=F5(e,gi.TIMER_QUERY);let s=n||i;for(const a of t)switch(a){case"queries":s=s&&n;break;case"timers":s=s&&i;break;default:ar(!1)}return s}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,t),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(xz)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?Sz:Ez)}beginTransformFeedbackQuery(){return this.begin(Cz)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,wz);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(Bz)}getResult(){return this.gl2.getQueryParameter(this.handle,bz)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((n,i)=>{const s=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):t++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return h0.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class V5 extends Su{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return gn(e)}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Po(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Qd(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(e,t){const n=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:a}=this._getBufferParams(t);return n<0?(this.unused[e]=i,yr.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[n]=t,this.bindOnUse||this._bindBuffer(n,i,a,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,n,i;return e instanceof ri?i=e:(i=e.buffer,n=e.byteSize,t=e.byteOffset),(t!==void 0||n!==void 0)&&(t=t||0,n=n||i.byteLength-t),{buffer:i,byteOffset:t,byteSize:n}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:n,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,i,n)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=t&&t.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,n,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let d0=null;function Tz(r){return(!d0||d0.byteLength<r)&&(d0=new ArrayBuffer(r)),d0}function Iz(r,e){const t=Tz(r.BYTES_PER_ELEMENT*e);return new r(t,0,e)}function Lz(r){let{target:e,source:t,start:n=0,count:i=1}=r;const s=t.length,a=i*s;let o=0;for(let A=n;o<s;o++)e[A++]=t[o];for(;o<a;)o<a-o?(e.copyWithin(n+o,n,n+o),o*=2):(e.copyWithin(n+o,n,n+a-o),o=a);return e}const Fz="elements must be GL.ELEMENT_ARRAY_BUFFER";class Fa extends Su{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?gn(e)||VS()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Fa(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Fa.MAX_ATTRIBUTES=Fa.MAX_ATTRIBUTES||e.getParameter(34921),Fa.MAX_ATTRIBUTES}static setConstant(e,t,n){switch(n.constructor){case Float32Array:Fa._setConstantFloatArray(e,t,n);break;case Int32Array:Fa._setConstantIntArray(e,t,n);break;case Uint32Array:Fa._setConstantUintArray(e,t,n);break;default:ar(!1)}}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.id||t.program&&t.program.id;super(e,Object.assign({},t,{id:n})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Fa.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return ar(!e||e.target===34963,Fz),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,t,n){if(t.target===34963)return this.setElementBuffer(t,n);const{size:i,type:s,stride:a,offset:o,normalized:A,integer:f,divisor:m}=n,{gl:v,gl2:x}=this;return e=Number(e),this.bind(()=>{v.bindBuffer(34962,t.handle),f?(ar(gn(v)),x.vertexAttribIPointer(e,i,s,a,o)):v.vertexAttribPointer(e,i,s,A,a,o),v.enableVertexAttribArray(e),x.vertexAttribDivisor(e,m||0)}),this}enable(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!t&&e===0&&!Fa.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,t){const n=this._normalizeConstantArrayValue(t),i=n.byteLength*e,s=n.length*e;let a=!this.buffer;if(this.buffer=this.buffer||new ri(this.gl,i),a=a||this.buffer.reallocate(i),a=a||!this._compareConstantArrayValues(n,this.bufferValue),a){const o=Iz(t.constructor,s);Lz({target:o,source:n,start:0,count:s}),this.buffer.subData(o),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}static _setConstantFloatArray(e,t,n){switch(n.length){case 1:e.vertexAttrib1fv(t,n);break;case 2:e.vertexAttrib2fv(t,n);break;case 3:e.vertexAttrib3fv(t,n);break;case 4:e.vertexAttrib4fv(t,n);break;default:ar(!1)}}static _setConstantIntArray(e,t,n){switch(ar(gn(e)),n.length){case 1:e.vertexAttribI1iv(t,n);break;case 2:e.vertexAttribI2iv(t,n);break;case 3:e.vertexAttribI3iv(t,n);break;case 4:e.vertexAttribI4iv(t,n);break;default:ar(!1)}}static _setConstantUintArray(e,t,n){switch(ar(gn(e)),n.length){case 1:e.vertexAttribI1uiv(t,n);break;case 2:e.vertexAttribI2uiv(t,n);break;case 3:e.vertexAttribI3uiv(t,n);break;case 4:e.vertexAttribI4uiv(t,n);break;default:ar(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,t){let{location:n}=t;return ar(Number.isFinite(n)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(n,e);default:return this.gl.getVertexAttrib(n,e)}})}}const Mz="VertexArray: attributes must be Buffers or constants (i.e. typed array)",Pz=/^(.+)__LOCATION_([0-9]+)$/,Uz=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Rz{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.id||t.program&&t.program.id;this.id=n,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Fa(e),g5(this,"VertexArray","v6.0",Uz),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const t in e){const n=e[t];this._setAttribute(t,n)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(t.target===34963)return this.setElementBuffer(t,n);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,t,t.accessor,n);return i>=0&&(this.values[i]=t,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,t,s)),this}setConstant(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},n));return i>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[i]=t,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ri(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof ri&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof ri&&this.setBuffer(e,t)}}),this}bindForDraw(e,t,n){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,t),i=n()}),i}_resolveLocationAndAccessor(e,t,n,i){const s={location:-1,accessor:null},{location:a,name:o}=this._getAttributeIndex(e);if(!Number.isFinite(a)||a<0)return this.unused[e]=t,yr.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const A=this._getAttributeInfo(o||a);if(!A)return s;const f=this.accessors[a]||{},m=aa.resolve(A.accessor,f,n,i),{size:v,type:x}=m;return ar(Number.isFinite(v)&&Number.isFinite(x)),{location:a,accessor:m}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const n=Pz.exec(e),i=n?n[1]:e,s=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,t){if(t instanceof ri)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof ri){const n=t[0],i=t[1];this.setBuffer(e,n,i)}else if(ArrayBuffer.isView(t)||Array.isArray(t)){const n=t;this.setConstant(e,n)}else if(t.buffer instanceof ri){const n=t;this.setBuffer(e,n.buffer,n)}else throw new Error(Mz)}_setConstantAttributes(e,t){const n=Math.max(e|0,t|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,n);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,t){if(Fa.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const n=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(e,t){Fa.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const n=this.values[t],i=this.accessors[t];if(!n)return;const{divisor:s}=i,a=s>0;if(e.isInstanced=e.isInstanced||a,n instanceof ri){const o=n;if(a){const A=o.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,A)}else{const A=o.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,A)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return yr.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function Oz(r,e){const{maxElts:t=16,size:n=1}=e;let i="[";for(let a=0;a<r.length&&a<t;++a)a>0&&(i+=",".concat(a%n===0?" ":"")),i+=$p(r[a],e);const s=r.length>t?"...":"]";return"".concat(i).concat(s)}function $p(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=1e-16,{isInteger:n=!1}=e;if(Array.isArray(r)||ArrayBuffer.isView(r))return Oz(r,e);if(!Number.isFinite(r))return String(r);if(Math.abs(r)<t)return n?"0":"0.";if(n||Math.abs(r)>100&&Math.abs(r)<1e4)return r.toFixed(0);const i=r.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function j5(r){let{header:e="Uniforms",program:t,uniforms:n,undefinedOnly:i=!1}=r;ar(t);const s=".*_.*",a=".*Matrix",o=t._uniformSetters,A={},f=Object.keys(o).sort();let m=0;for(const B of f)!B.match(s)&&!B.match(a)&&$v({table:A,header:e,uniforms:n,uniformName:B,undefinedOnly:i})&&m++;for(const B of f)B.match(a)&&$v({table:A,header:e,uniforms:n,uniformName:B,undefinedOnly:i})&&m++;for(const B of f)A[B]||$v({table:A,header:e,uniforms:n,uniformName:B,undefinedOnly:i})&&m++;let v=0;const x={};if(!i)for(const B in n){const M=n[B];A[B]||(v++,x[B]={Type:"NOT USED: ".concat(M),[e]:$p(M)})}return{table:A,count:m,unusedTable:x,unusedCount:v}}function $v(r){let{table:e,header:t,uniforms:n,uniformName:i,undefinedOnly:s}=r;const a=n[i],o=Dz(a);return!s||!o?(e[i]={[t]:o?$p(a):"N/A","Uniform Type":o?a:"NOT PROVIDED"},!0):!1}function Dz(r){return r!=null}function kz(r){let{vertexArray:e,header:t="Attributes"}=r;if(!e.configuration)return{};const n={};e.elements&&(n.ELEMENT_ARRAY_BUFFER=q5(e,e.elements,null,t));const i=e.values;for(const s in i){const a=e._getAttributeInfo(s);if(a){let o="".concat(s,": ").concat(a.name);const A=e.accessors[a.location];A&&(o="".concat(s,": ").concat(Nz(a.name,A))),n[o]=q5(e,i[s],A,t)}}return n}function q5(r,e,t,n){const{gl:i}=r;if(!e)return{[n]:"null","Format ":"N/A"};let s="NOT PROVIDED",a=1,o=0,A=0,f,m,v;if(t&&(s=t.type,a=t.size,s=String(s).replace("Array",""),f=s.indexOf("nt")!==-1),e instanceof ri){const x=e,{data:B,changed:M}=x.getDebugData();m=M?"*":"",v=B,A=x.byteLength,o=A/B.BYTES_PER_ELEMENT/a;let U;if(t){const N=t.divisor>0;U="".concat(N?"I ":"P "," ").concat(o," (x").concat(a,"=").concat(A," bytes ").concat(CA(i,s),")")}else f=!0,U="".concat(A," bytes");return{[n]:"".concat(m).concat($p(v,{size:a,isInteger:f})),"Format ":U}}return v=e,a=e.length,s=String(e.constructor.name).replace("Array",""),f=s.indexOf("nt")!==-1,{[n]:"".concat($p(v,{size:a,isInteger:f})," (constant)"),"Format ":"".concat(a,"x").concat(s," (constant)")}}function Nz(r,e){const{type:t,size:n}=e,i=H5(t,n);return i?"".concat(r," (").concat(i.name,")"):r}function Qz(r){const e={},t="Accessors for ".concat(r.id);for(const n of r.attributeInfos)if(n){const i=K5(n);e["in ".concat(i)]={[t]:JSON.stringify(n.accessor)}}for(const n of r.varyingInfos)if(n){const i=K5(n);e["out ".concat(i)]={[t]:JSON.stringify(n.accessor)}}return e}function K5(r){const{type:e,size:t}=r.accessor,n=H5(e,t);return n?"".concat(n.name," ").concat(r.name):r.name}const W5=Bu()&&typeof document<"u";let Hz=0;class zz{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:t=N=>h5(N),onAddHTML:n=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:a=()=>{},onError:o,gl:A=null,glOptions:f={},debug:m=!1,createFramebuffer:v=!1,autoResizeViewport:x=!0,autoResizeDrawingBuffer:B=!0,stats:M=Ih.get("animation-loop-".concat(Hz++))}=e;let{useDevicePixels:U=!0}=e;"useDevicePixelRatio"in e&&(yr.deprecated("useDevicePixelRatio","useDevicePixels")(),U=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:n,onInitialize:i,onRender:s,onFinalize:a,onError:o,gl:A,glOptions:f,debug:m,createFramebuffer:v},this.gl=A,this.needsRedraw=null,this.timeline=null,this.stats=M,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:x,autoResizeDrawingBuffer:B,useDevicePixels:U}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return ar(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=h0.isSupported(this.gl,["timers"])?new h0(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(n=>{this._running&&(this._addCallbackData(n||{}),n!==!1&&this._startLoop())});return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const n=document.getElementById(e);return n?Number(n.value):t}setViewParameters(){return yr.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=W5?new Promise((e,t)=>{if(W5&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):$7(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):W7(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:n}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?Rv(this.props.gl,e):this.onCreateContext(e),!s0(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");R7(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const n=this.props.onAddHTML(t);n&&(t.innerHTML=n)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let n=1;const{canvas:i}=this.gl;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:e>0&&t>0&&(n=e/t),{width:e,height:t,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&Q7(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new bs(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Xp="vs",Xv="fs";function Ma(r,e){if(!r)throw new Error(e||"shadertools: assertion failed.")}const Jv={number:{validate(r,e){return Number.isFinite(r)&&(!("max"in e)||r<=e.max)&&(!("min"in e)||r>=e.min)}},array:{validate(r,e){return Array.isArray(r)||ArrayBuffer.isView(r)}}};function Gz(r){const e={};for(const t in r){const n=r[t],i=Vz(n);e[t]=i}return e}function Vz(r){let e=$5(r);return e==="object"?r?"type"in r?Object.assign({},r,Jv[r.type]):"value"in r?(e=$5(r.value),Object.assign({type:e},r,Jv[e])):{type:"object",value:r}:{type:"object",value:null}:Object.assign({type:e,value:r},Jv[e])}function $5(r){return Array.isArray(r)||ArrayBuffer.isView(r)?"array":typeof r}const jz="vs",qz="fs";class X5{constructor(e){let{name:t,vs:n,fs:i,dependencies:s=[],uniforms:a,getUniforms:o,deprecations:A=[],defines:f={},inject:m={},vertexShader:v,fragmentShader:x}=e;Ma(typeof t=="string"),this.name=t,this.vs=n||v,this.fs=i||x,this.getModuleUniforms=o,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(A),this.defines=f,this.injections=Kz(m),a&&(this.uniforms=Gz(a))}getModuleSource(e){let t;switch(e){case jz:t=this.vs||"";break;case qz:t=this.fs||"";break;default:Ma(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(t,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(n=>{n.regex.test(e)&&(n.deprecated?t.deprecated(n.old,n.new)():t.removed(n.old,n.new)())})}_parseDeprecationDefinitions(e){return e.forEach(t=>{switch(t.type){case"function":t.regex=new RegExp("\\b".concat(t.old,"\\("));break;default:t.regex=new RegExp("".concat(t.type," ").concat(t.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t={},n=this.uniforms;for(const i in n){const s=n[i];i in e&&!s.private?(s.validate&&Ma(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),t[i]=e[i]):t[i]=s.value}return t}}function Kz(r){const e={vs:{},fs:{}};for(const t in r){let n=r[t];const i=t.slice(0,2);typeof n=="string"&&(n={order:0,injection:n}),e[i][t]=n}return e}function Wz(r){return $z(Y5(r))}function $z(r){const e={},t={};return J5({modules:r,level:0,moduleMap:e,moduleDepth:t}),Object.keys(t).sort((n,i)=>t[i]-t[n]).map(n=>e[n])}function J5(r){let{modules:e,level:t,moduleMap:n,moduleDepth:i}=r;if(t>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)n[s.name]=s,(i[s.name]===void 0||i[s.name]<t)&&(i[s.name]=t);for(const s of e)s.dependencies&&J5({modules:s.dependencies,level:t+1,moduleMap:n,moduleDepth:i})}function Y5(r,e){return r.map(t=>(t instanceof X5||(Ma(typeof t!="string","Shader module use by name is deprecated. Import shader module '".concat(t,"' and use it directly.")),Ma(t.name,"shader module has no name"),t=new X5(t),t.dependencies=Y5(t.dependencies)),t))}function Xz(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},t=r.userAgent||e.userAgent||"",n=t.indexOf("MSIE ")!==-1,i=t.indexOf("Trident/")!==-1;return n||i}const Jz=7936,Yz=7937,Zz=7938,e9=35724,Yv={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Fh={};Object.keys(Yv).forEach(r=>{Fh[r]=r});function t9(r){return typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?!0:!!(r&&r._version===2)}function r9(r){const e=r.getExtension("WEBGL_debug_renderer_info"),t=r.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||Jz),n=r.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||Yz);return{gpuVendor:n9(t,n),vendor:t,renderer:n,version:r.getParameter(Zz),shadingLanguageVersion:r.getParameter(e9)}}function n9(r,e){return r.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":r.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":r.match(/AMD/i)||e.match(/AMD/i)||r.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const Zv={};function Z5(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=Yv[e];if(Ma(n,e),!Xz(t))return!0;if(e in Zv)return Zv[e];const i=n[0],s=t.behavior||"enable",a="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),o=r.createShader(35633);r.shaderSource(o,a),r.compileShader(o);const A=r.getShaderParameter(o,35713);return r.deleteShader(o),Zv[e]=A,A}function i9(r,e){const t=Yv[e];Ma(t,e);const n=t9(r)&&t[1]||t[0],i=typeof n=="string"?!!r.getExtension(n):n;return Ma(i===!1||i===!0),i}function f0(r,e){return e=Array.isArray(e)?e:[e],e.every(t=>i9(r,t))}function s9(r){switch(r9(r).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function o9(r,e,t){let n=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return f0(r,Fh.GLSL_FRAG_DEPTH)&&(n+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),f0(r,Fh.GLSL_DERIVATIVES)&&Z5(r,Fh.GLSL_DERIVATIVES)&&(n+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),f0(r,Fh.GLSL_FRAG_DATA)&&Z5(r,Fh.GLSL_FRAG_DATA,{behavior:"require"})&&(n+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),f0(r,Fh.GLSL_TEXTURE_LOD)&&(n+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),n}const a9=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,c9=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,l9={[Xp]:a9,[Xv]:c9},p0="__LUMA_INJECT_DECLARATIONS__",eT=/void\s+main\s*\([^)]*\)\s*\{\n?/,tT=/}\n?[^{}]*$/,eb=[];function rT(r,e,t){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===Xp;for(const s in t){const a=t[s];a.sort((A,f)=>A.order-f.order),eb.length=a.length;for(let A=0,f=a.length;A<f;++A)eb[A]=a[A].injection;const o="".concat(eb.join(`
`),`
`);switch(s){case"vs:#decl":i&&(r=r.replace(p0,o));break;case"vs:#main-start":i&&(r=r.replace(eT,A=>A+o));break;case"vs:#main-end":i&&(r=r.replace(tT,A=>o+A));break;case"fs:#decl":i||(r=r.replace(p0,o));break;case"fs:#main-start":i||(r=r.replace(eT,A=>A+o));break;case"fs:#main-end":i||(r=r.replace(tT,A=>o+A));break;default:r=r.replace(s,A=>A+o)}}return r=r.replace(p0,""),n&&(r=r.replace(/\}\s*$/,s=>s+l9[e])),r}function tb(r){const e={};return Ma(Array.isArray(r)&&r.length>1),r.forEach(t=>{for(const n in t)e[n]=e[n]?"".concat(e[n],`
`).concat(t[n]):t[n]}),e}function Vd(r){return new RegExp("\\b".concat(r,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const nT=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],u9=[...nT,[Vd("attribute"),"in $1"],[Vd("varying"),"out $1"]],A9=[...nT,[Vd("varying"),"in $1"]],iT=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],h9=[...iT,[Vd("in"),"attribute $1"],[Vd("out"),"varying $1"]],d9=[...iT,[Vd("in"),"varying $1"]],rb="gl_FragColor",nb=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,f9=/void\s+main\s*\([^)]*\)\s*\{\n?/;function p9(r,e,t){switch(e){case 300:return t?g0(r,u9):g9(r);case 100:return t?g0(r,h9):m9(r);default:throw new Error("unknown GLSL version ".concat(e))}}function g0(r,e){for(const[t,n]of e)r=r.replace(t,n);return r}function g9(r){r=g0(r,A9);const e=r.match(nb);if(e){const t=e[1];r=r.replace(new RegExp("\\b".concat(rb,"\\b"),"g"),t)}else{const t="fragmentColor";r=r.replace(f9,n=>"out vec4 ".concat(t,`;
`).concat(n)).replace(new RegExp("\\b".concat(rb,"\\b"),"g"),t)}return r}function m9(r){r=g0(r,d9);const e=r.match(nb);if(e){const t=e[1];r=r.replace(nb,"").replace(new RegExp("\\b".concat(t,"\\b"),"g"),rb)}return r}const y9=`

`.concat(p0,`

`),sT={[Xp]:"vertex",[Xv]:"fragment"},_9=`precision highp float;

`;function v9(r,e){const{vs:t,fs:n}=e,i=Wz(e.modules||[]);return{gl:r,vs:oT(r,Object.assign({},e,{source:t,type:Xp,modules:i})),fs:oT(r,Object.assign({},e,{source:n,type:Xv,modules:i})),getUniforms:b9(i)}}function oT(r,e){let{id:t,source:n,type:i,modules:s,defines:a={},hookFunctions:o=[],inject:A={},transpileToGLSL100:f=!1,prologue:m=!0,log:v}=e;Ma(typeof n=="string","shader source must be a string");const x=i===Xp,B=n.split(`
`);let M=100,U="",N=n;B[0].indexOf("#version ")===0?(M=300,U=B[0],N=B.slice(1).join(`
`)):U="#version ".concat(M);const Q={};s.forEach(ye=>{Object.assign(Q,ye.getDefines())}),Object.assign(Q,a);let q=m?"".concat(U,`
`).concat(x9({id:t,source:n,type:i}),`
`).concat(w9({type:i}),`
`).concat(s9(r),`
`).concat(o9(r),`
`).concat(B9(Q),`
`).concat(x?"":_9,`
`):"".concat(U,`
`);const Y=E9(o),te={},pe={},ge={};for(const ye in A){const fe=typeof A[ye]=="string"?{injection:A[ye],order:0}:A[ye],Oe=ye.match(/^(v|f)s:(#)?([\w-]+)$/);if(Oe){const Fe=Oe[2],oe=Oe[3];Fe?oe==="decl"?pe[ye]=[fe]:ge[ye]=[fe]:te[ye]=[fe]}else ge[ye]=[fe]}for(const ye of s){v&&ye.checkDeprecations(N,v);const fe=ye.getModuleSource(i,M);q+=fe;const Oe=ye.injections[i];for(const Fe in Oe){const oe=Fe.match(/^(v|f)s:#([\w-]+)$/);if(oe){const xe=oe[2]==="decl"?pe:ge;xe[Fe]=xe[Fe]||[],xe[Fe].push(Oe[Fe])}else te[Fe]=te[Fe]||[],te[Fe].push(Oe[Fe])}}return q+=y9,q=rT(q,i,pe),q+=C9(Y[i],te),q+=N,q=rT(q,i,ge),q=p9(q,f?100:M,x),q}function b9(r){return function(t){const n={};for(const i of r){const s=i.getUniforms(t,n);Object.assign(n,s)}return n}}function w9(r){let{type:e}=r;return`
#define SHADER_TYPE_`.concat(sT[e].toUpperCase(),`
`)}function x9(r){let{id:e,source:t,type:n}=r;return e&&typeof e=="string"&&t.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(sT[n],`

`):""}function B9(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,t="";for(const n in r){e===0&&(t+=`
// APPLICATION DEFINES
`),e++;const i=r[n];(i||Number.isFinite(i))&&(t+="#define ".concat(n.toUpperCase()," ").concat(r[n],`
`))}return e===0&&(t+=`
`),t}function C9(r,e){let t="";for(const n in r){const i=r[n];if(t+="void ".concat(i.signature,` {
`),i.header&&(t+="  ".concat(i.header)),e[n]){const s=e[n];s.sort((a,o)=>a.order-o.order);for(const a of s)t+="  ".concat(a.injection,`
`)}i.footer&&(t+="  ".concat(i.footer)),t+=`}
`}return t}function E9(r){const e={vs:{},fs:{}};return r.forEach(t=>{let n;typeof t!="string"?(n=t,t=n.hook):n={},t=t.trim();const[i,s]=t.split(":"),a=t.replace(/\(.+/,"");e[i][a]=Object.assign(n,{signature:s})}),e}const S9="void main() {gl_FragColor = vec4(0);}",aT=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,T9=`#version 300 es
`.concat(aT);function cT(r,e){e=Array.isArray(e)?e:[e];const t=r.replace(/^\s+/,"").split(/\s+/),[n,i,s]=t;if(!e.includes(n)||!i||!s)return null;const a=s.split(";")[0];return{qualifier:n,type:i,name:a}}function lT(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:t,inputType:n,output:i}=r;if(!t)return e===300?T9:e>300?"#version ".concat(e,`
`).concat(aT):S9;const s=F9(t,n);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(n," ").concat(t,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(n," ").concat(t,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function I9(r){switch(r){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Ma(!1),null}}function L9(r){switch(r){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Ma(!1),null}}function F9(r,e){switch(e){case"float":return"vec4(".concat(r,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(r,", 0.0, 1.0)");case"vec3":return"vec4(".concat(r,", 1.0)");case"vec4":return r;default:return Ma(!1),null}}const M9={name:"fp32",vs:`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,fs:null};function kc(r,e){if(!r)throw new Error("math.gl assertion ".concat(e))}const P9=1/Math.PI*180,U9=1/180*Math.PI,xs={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function R9(r){let{precision:e=xs.precision}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return r=N9(r),"".concat(parseFloat(r.toPrecision(e)))}function SA(r){return Array.isArray(r)||ArrayBuffer.isView(r)&&!(r instanceof DataView)}function O9(r){return k9(r)}function D9(r){return Iu(r)}function k9(r,e){return ib(r,t=>t*U9,e)}function Iu(r,e){return ib(r,t=>t*P9,e)}function Lu(r,e,t){return ib(r,n=>Math.max(e,Math.min(t,n)))}function m0(r,e,t){return SA(r)?r.map((n,i)=>m0(n,e[i],t)):t*e+(1-t)*r}function Nc(r,e,t){const n=xs.EPSILON;t&&(xs.EPSILON=t);try{if(r===e)return!0;if(SA(r)&&SA(e)){if(r.length!==e.length)return!1;for(let i=0;i<r.length;++i)if(!Nc(r[i],e[i]))return!1;return!0}return r&&r.equals?r.equals(e):e&&e.equals?e.equals(r):typeof r=="number"&&typeof e=="number"?Math.abs(r-e)<=xs.EPSILON*Math.max(1,Math.abs(r),Math.abs(e)):!1}finally{xs.EPSILON=n}}function N9(r){return Math.round(r/xs.EPSILON)*xs.EPSILON}function Q9(r){return r.clone?r.clone():new Array(r.length)}function ib(r,e,t){if(SA(r)){const n=r;t=t||Q9(n);for(let i=0;i<t.length&&i<n.length;++i)t[i]=e(r[i],i,t);return t}return e(r)}function H9(r){function e(){var t=Reflect.construct(r,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(r.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r,e}class sb extends H9(Array){clone(){return new this.constructor().copy(this)}fromArray(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+t];return this.check()}toArray(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)e[t+n]=this[n];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:SA(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(xs)}formatString(e){let t="";for(let n=0;n<this.ELEMENTS;++n)t+=(n>0?", ":"")+R9(this[n],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!Nc(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,n){if(n===void 0)return this.lerp(this,e,t);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+n*(t[i]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),t[n]);return this.check()}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const i of t)for(let s=0;s<this.ELEMENTS;++s)this[s]+=i[s];return this.check()}subtract(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const i of t)for(let s=0;s<this.ELEMENTS;++s)this[s]-=i[s];return this.check()}scale(e){if(typeof e=="number")for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(xs.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),t);return this.check()}get elements(){return this}}function z9(r,e){if(r.length!==e)return!1;for(let t=0;t<r.length;++t)if(!Number.isFinite(r[t]))return!1;return!0}function Qn(r){if(!Number.isFinite(r))throw new Error("Invalid number ".concat(r));return r}function Jp(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(xs.debug&&!z9(r,e))throw new Error("math.gl: ".concat(t," some fields set to invalid numbers'"));return r}class ob extends sb{get x(){return this[0]}set x(e){this[0]=Qn(e)}get y(){return this[1]}set y(e){this[1]=Qn(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-e[n];t+=i*i}return Qn(t)}dot(e){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*e[n];return Qn(t)}normalize(){const e=this.magnitude();if(e!==0)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const i of t)for(let s=0;s<this.ELEMENTS;++s)this[s]*=i[s];return this.check()}divide(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const i of t)for(let s=0;s<this.ELEMENTS;++s)this[s]/=i[s];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return kc(e>=0&&e<this.ELEMENTS,"index is out of range"),Qn(this[e])}setComponent(e,t){return kc(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var Yp=1e-6,Qc=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});function G9(){var r=new Qc(2);return Qc!=Float32Array&&(r[0]=0,r[1]=0),r}function uT(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r}function V9(r,e){return r[0]=-e[0],r[1]=-e[1],r}function AT(r,e,t,n){var i=e[0],s=e[1];return r[0]=i+n*(t[0]-i),r[1]=s+n*(t[1]-s),r}function j9(r,e,t){var n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i,r[1]=t[1]*n+t[3]*i,r}function q9(r,e,t){var n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i+t[4],r[1]=t[1]*n+t[3]*i+t[5],r}function hT(r,e,t){var n=e[0],i=e[1];return r[0]=t[0]*n+t[3]*i+t[6],r[1]=t[1]*n+t[4]*i+t[7],r}function dT(r,e,t){var n=e[0],i=e[1];return r[0]=t[0]*n+t[4]*i+t[12],r[1]=t[1]*n+t[5]*i+t[13],r}(function(){var r=G9();return function(e,t,n,i,s,a){var o,A;for(t||(t=2),n||(n=0),i?A=Math.min(i*t+n,e.length):A=e.length,o=n;o<A;o+=t)r[0]=e[o],r[1]=e[o+1],s(r,r,a),e[o]=r[0],e[o+1]=r[1];return e}})();function fT(r,e,t){const n=e[0],i=e[1],s=t[3]*n+t[7]*i||1;return r[0]=(t[0]*n+t[4]*i)/s,r[1]=(t[1]*n+t[5]*i)/s,r}function pT(r,e,t){const n=e[0],i=e[1],s=e[2],a=t[3]*n+t[7]*i+t[11]*s||1;return r[0]=(t[0]*n+t[4]*i+t[8]*s)/a,r[1]=(t[1]*n+t[5]*i+t[9]*s)/a,r[2]=(t[2]*n+t[6]*i+t[10]*s)/a,r}function K9(r,e,t){const n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i,r[1]=t[1]*n+t[3]*i,r[2]=e[2],r}function W9(r,e,t){const n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i,r[1]=t[1]*n+t[3]*i,r[2]=e[2],r[3]=e[3],r}function gT(r,e,t){const n=e[0],i=e[1],s=e[2];return r[0]=t[0]*n+t[3]*i+t[6]*s,r[1]=t[1]*n+t[4]*i+t[7]*s,r[2]=t[2]*n+t[5]*i+t[8]*s,r[3]=e[3],r}class ab extends ob{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;super(2),SA(e)&&arguments.length===1?this.copy(e):(xs.debug&&(Qn(e),Qn(t)),this[0]=e,this[1]=t)}set(e,t){return this[0]=e,this[1]=t,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this.check()}fromObject(e){return xs.debug&&(Qn(e.x),Qn(e.y)),this[0]=e.x,this[1]=e.y,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return dT(this,this,e),this.check()}transformAsVector(e){return fT(this,this,e),this.check()}transformByMatrix3(e){return hT(this,this,e),this.check()}transformByMatrix2x3(e){return q9(this,this,e),this.check()}transformByMatrix2(e){return j9(this,this,e),this.check()}}function mT(){var r=new Qc(3);return Qc!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function yT(r){var e=r[0],t=r[1],n=r[2];return Math.hypot(e,t,n)}function _T(r,e,t){var n=new Qc(3);return n[0]=r,n[1]=e,n[2]=t,n}function $9(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r}function X9(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r}function J9(r,e){var t=e[0],n=e[1],i=e[2],s=t*t+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),r[0]=e[0]*s,r[1]=e[1]*s,r[2]=e[2]*s,r}function cb(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function y0(r,e,t){var n=e[0],i=e[1],s=e[2],a=t[0],o=t[1],A=t[2];return r[0]=i*A-s*o,r[1]=s*a-n*A,r[2]=n*o-i*a,r}function lb(r,e,t){var n=e[0],i=e[1],s=e[2],a=t[3]*n+t[7]*i+t[11]*s+t[15];return a=a||1,r[0]=(t[0]*n+t[4]*i+t[8]*s+t[12])/a,r[1]=(t[1]*n+t[5]*i+t[9]*s+t[13])/a,r[2]=(t[2]*n+t[6]*i+t[10]*s+t[14])/a,r}function vT(r,e,t){var n=e[0],i=e[1],s=e[2];return r[0]=n*t[0]+i*t[3]+s*t[6],r[1]=n*t[1]+i*t[4]+s*t[7],r[2]=n*t[2]+i*t[5]+s*t[8],r}function bT(r,e,t){var n=t[0],i=t[1],s=t[2],a=t[3],o=e[0],A=e[1],f=e[2],m=i*f-s*A,v=s*o-n*f,x=n*A-i*o,B=i*x-s*v,M=s*m-n*x,U=n*v-i*m,N=a*2;return m*=N,v*=N,x*=N,B*=2,M*=2,U*=2,r[0]=o+m+B,r[1]=A+v+M,r[2]=f+x+U,r}function Y9(r,e,t,n){var i=[],s=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],s[0]=i[0],s[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),s[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),r[0]=s[0]+t[0],r[1]=s[1]+t[1],r[2]=s[2]+t[2],r}function Z9(r,e,t,n){var i=[],s=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],s[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),s[1]=i[1],s[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),r[0]=s[0]+t[0],r[1]=s[1]+t[1],r[2]=s[2]+t[2],r}function eG(r,e,t,n){var i=[],s=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],s[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),s[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),s[2]=i[2],r[0]=s[0]+t[0],r[1]=s[1]+t[1],r[2]=s[2]+t[2],r}function tG(r,e){var t=r[0],n=r[1],i=r[2],s=e[0],a=e[1],o=e[2],A=Math.sqrt(t*t+n*n+i*i),f=Math.sqrt(s*s+a*a+o*o),m=A*f,v=m&&cb(r,e)/m;return Math.acos(Math.min(Math.max(v,-1),1))}var rG=$9,nG=yT;(function(){var r=mT();return function(e,t,n,i,s,a){var o,A;for(t||(t=3),n||(n=0),i?A=Math.min(i*t+n,e.length):A=e.length,o=n;o<A;o+=t)r[0]=e[o],r[1]=e[o+1],r[2]=e[o+2],s(r,r,a),e[o]=r[0],e[o+1]=r[1],e[o+2]=r[2];return e}})();const ub=[0,0,0];let _0;class ut extends ob{static get ZERO(){return _0||(_0=new ut(0,0,0),Object.freeze(_0)),_0}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;super(-0,-0,-0),arguments.length===1&&SA(e)?this.copy(e):(xs.debug&&(Qn(e),Qn(t),Qn(n)),this[0]=e,this[1]=t,this[2]=n)}set(e,t,n){return this[0]=e,this[1]=t,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return xs.debug&&(Qn(e.x),Qn(e.y),Qn(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Qn(e)}angle(e){return tG(this,e)}cross(e){return y0(this,this,e),this.check()}rotateX(e){let{radians:t,origin:n=ub}=e;return Y9(this,this,n,t),this.check()}rotateY(e){let{radians:t,origin:n=ub}=e;return Z9(this,this,n,t),this.check()}rotateZ(e){let{radians:t,origin:n=ub}=e;return eG(this,this,n,t),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return lb(this,this,e),this.check()}transformAsVector(e){return pT(this,this,e),this.check()}transformByMatrix3(e){return vT(this,this,e),this.check()}transformByMatrix2(e){return K9(this,this,e),this.check()}transformByQuaternion(e){return bT(this,this,e),this.check()}}let v0;class Ab extends ob{static get ZERO(){return v0||(v0=new Ab(0,0,0,0),Object.freeze(v0)),v0}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;super(-0,-0,-0,-0),SA(e)&&arguments.length===1?this.copy(e):(xs.debug&&(Qn(e),Qn(t),Qn(n),Qn(i)),this[0]=e,this[1]=t,this[2]=n,this[3]=i)}set(e,t,n,i){return this[0]=e,this[1]=t,this[2]=n,this[3]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return xs.debug&&(Qn(e.x),Qn(e.y),Qn(e.z),Qn(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=Qn(e)}get w(){return this[3]}set w(e){this[3]=Qn(e)}transform(e){return lb(this,this,e),this.check()}transformByMatrix3(e){return gT(this,this,e),this.check()}transformByMatrix2(e){return W9(this,this,e),this.check()}transformByQuaternion(e){return bT(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class wT extends sb{toString(){let e="[";if(xs.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let n=0;n<this.RANK;++n)e+=" ".concat(this[n*this.RANK+t])}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=" ".concat(this[t])}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,n){return this[t*this.RANK+e]=Qn(n),this}getColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Array(this.RANK).fill(-0);const n=e*this.RANK;for(let i=0;i<this.RANK;++i)t[i]=this[n+i];return t}setColumn(e,t){const n=e*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=t[i];return this}}function iG(){var r=new Qc(9);return Qc!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function sG(r,e){if(r===e){var t=e[1],n=e[2],i=e[5];r[1]=e[3],r[2]=e[6],r[3]=t,r[5]=e[7],r[6]=n,r[7]=i}else r[0]=e[0],r[1]=e[3],r[2]=e[6],r[3]=e[1],r[4]=e[4],r[5]=e[7],r[6]=e[2],r[7]=e[5],r[8]=e[8];return r}function oG(r,e){var t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],A=e[6],f=e[7],m=e[8],v=m*a-o*f,x=-m*s+o*A,B=f*s-a*A,M=t*v+n*x+i*B;return M?(M=1/M,r[0]=v*M,r[1]=(-m*n+i*f)*M,r[2]=(o*n-i*a)*M,r[3]=x*M,r[4]=(m*t-i*A)*M,r[5]=(-o*t+i*s)*M,r[6]=B*M,r[7]=(-f*t+n*A)*M,r[8]=(a*t-n*s)*M,r):null}function aG(r){var e=r[0],t=r[1],n=r[2],i=r[3],s=r[4],a=r[5],o=r[6],A=r[7],f=r[8];return e*(f*s-a*A)+t*(-f*i+a*o)+n*(A*i-s*o)}function xT(r,e,t){var n=e[0],i=e[1],s=e[2],a=e[3],o=e[4],A=e[5],f=e[6],m=e[7],v=e[8],x=t[0],B=t[1],M=t[2],U=t[3],N=t[4],Q=t[5],q=t[6],Y=t[7],te=t[8];return r[0]=x*n+B*a+M*f,r[1]=x*i+B*o+M*m,r[2]=x*s+B*A+M*v,r[3]=U*n+N*a+Q*f,r[4]=U*i+N*o+Q*m,r[5]=U*s+N*A+Q*v,r[6]=q*n+Y*a+te*f,r[7]=q*i+Y*o+te*m,r[8]=q*s+Y*A+te*v,r}function cG(r,e,t){var n=e[0],i=e[1],s=e[2],a=e[3],o=e[4],A=e[5],f=e[6],m=e[7],v=e[8],x=t[0],B=t[1];return r[0]=n,r[1]=i,r[2]=s,r[3]=a,r[4]=o,r[5]=A,r[6]=x*n+B*a+f,r[7]=x*i+B*o+m,r[8]=x*s+B*A+v,r}function lG(r,e,t){var n=e[0],i=e[1],s=e[2],a=e[3],o=e[4],A=e[5],f=e[6],m=e[7],v=e[8],x=Math.sin(t),B=Math.cos(t);return r[0]=B*n+x*a,r[1]=B*i+x*o,r[2]=B*s+x*A,r[3]=B*a-x*n,r[4]=B*o-x*i,r[5]=B*A-x*s,r[6]=f,r[7]=m,r[8]=v,r}function BT(r,e,t){var n=t[0],i=t[1];return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=i*e[3],r[4]=i*e[4],r[5]=i*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function uG(r,e){var t=e[0],n=e[1],i=e[2],s=e[3],a=t+t,o=n+n,A=i+i,f=t*a,m=n*a,v=n*o,x=i*a,B=i*o,M=i*A,U=s*a,N=s*o,Q=s*A;return r[0]=1-v-M,r[3]=m-Q,r[6]=x+N,r[1]=m+Q,r[4]=1-f-M,r[7]=B-U,r[2]=x-N,r[5]=B+U,r[8]=1-f-v,r}var hb;(function(r){r[r.COL0ROW0=0]="COL0ROW0",r[r.COL0ROW1=1]="COL0ROW1",r[r.COL0ROW2=2]="COL0ROW2",r[r.COL1ROW0=3]="COL1ROW0",r[r.COL1ROW1=4]="COL1ROW1",r[r.COL1ROW2=5]="COL1ROW2",r[r.COL2ROW0=6]="COL2ROW0",r[r.COL2ROW1=7]="COL2ROW1",r[r.COL2ROW2=8]="COL2ROW2"})(hb||(hb={}));const AG=Object.freeze([1,0,0,0,1,0,0,0,1]);class zi extends wT{static get IDENTITY(){return dG()}static get ZERO(){return hG()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return hb}constructor(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(AG)}fromObject(e){return this.check()}fromQuaternion(e){return uG(this,e),this.check()}set(e,t,n,i,s,a,o,A,f){return this[0]=e,this[1]=t,this[2]=n,this[3]=i,this[4]=s,this[5]=a,this[6]=o,this[7]=A,this[8]=f,this.check()}setRowMajor(e,t,n,i,s,a,o,A,f){return this[0]=e,this[1]=i,this[2]=o,this[3]=t,this[4]=s,this[5]=A,this[6]=n,this[7]=a,this[8]=f,this.check()}determinant(){return aG(this)}transpose(){return sG(this,this),this.check()}invert(){return oG(this,this),this.check()}multiplyLeft(e){return xT(this,e,this),this.check()}multiplyRight(e){return xT(this,this,e),this.check()}rotate(e){return lG(this,this,e),this.check()}scale(e){return Array.isArray(e)?BT(this,this,e):BT(this,this,[e,e]),this.check()}translate(e){return cG(this,this,e),this.check()}transform(e,t){let n;switch(e.length){case 2:n=hT(t||[-0,-0],e,this);break;case 3:n=vT(t||[-0,-0,-0],e,this);break;case 4:n=gT(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Jp(n,e.length),n}transformVector(e,t){return this.transform(e,t)}transformVector2(e,t){return this.transform(e,t)}transformVector3(e,t){return this.transform(e,t)}}let b0,w0;function hG(){return b0||(b0=new zi([0,0,0,0,0,0,0,0,0]),Object.freeze(b0)),b0}function dG(){return w0||(w0=new zi,Object.freeze(w0)),w0}function fG(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function pG(r,e){if(r===e){var t=e[1],n=e[2],i=e[3],s=e[6],a=e[7],o=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=t,r[6]=e[9],r[7]=e[13],r[8]=n,r[9]=s,r[11]=e[14],r[12]=i,r[13]=a,r[14]=o}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r}function db(r,e){var t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],A=e[6],f=e[7],m=e[8],v=e[9],x=e[10],B=e[11],M=e[12],U=e[13],N=e[14],Q=e[15],q=t*o-n*a,Y=t*A-i*a,te=t*f-s*a,pe=n*A-i*o,ge=n*f-s*o,ye=i*f-s*A,fe=m*U-v*M,Oe=m*N-x*M,Fe=m*Q-B*M,oe=v*N-x*U,le=v*Q-B*U,xe=x*Q-B*N,_e=q*xe-Y*le+te*oe+pe*Fe-ge*Oe+ye*fe;return _e?(_e=1/_e,r[0]=(o*xe-A*le+f*oe)*_e,r[1]=(i*le-n*xe-s*oe)*_e,r[2]=(U*ye-N*ge+Q*pe)*_e,r[3]=(x*ge-v*ye-B*pe)*_e,r[4]=(A*Fe-a*xe-f*Oe)*_e,r[5]=(t*xe-i*Fe+s*Oe)*_e,r[6]=(N*te-M*ye-Q*Y)*_e,r[7]=(m*ye-x*te+B*Y)*_e,r[8]=(a*le-o*Fe+f*fe)*_e,r[9]=(n*Fe-t*le-s*fe)*_e,r[10]=(M*ge-U*te+Q*q)*_e,r[11]=(v*te-m*ge-B*q)*_e,r[12]=(o*Oe-a*oe-A*fe)*_e,r[13]=(t*oe-n*Oe+i*fe)*_e,r[14]=(U*Y-M*pe-N*q)*_e,r[15]=(m*pe-v*Y+x*q)*_e,r):null}function gG(r){var e=r[0],t=r[1],n=r[2],i=r[3],s=r[4],a=r[5],o=r[6],A=r[7],f=r[8],m=r[9],v=r[10],x=r[11],B=r[12],M=r[13],U=r[14],N=r[15],Q=e*a-t*s,q=e*o-n*s,Y=e*A-i*s,te=t*o-n*a,pe=t*A-i*a,ge=n*A-i*o,ye=f*M-m*B,fe=f*U-v*B,Oe=f*N-x*B,Fe=m*U-v*M,oe=m*N-x*M,le=v*N-x*U;return Q*le-q*oe+Y*Fe+te*Oe-pe*fe+ge*ye}function Mh(r,e,t){var n=e[0],i=e[1],s=e[2],a=e[3],o=e[4],A=e[5],f=e[6],m=e[7],v=e[8],x=e[9],B=e[10],M=e[11],U=e[12],N=e[13],Q=e[14],q=e[15],Y=t[0],te=t[1],pe=t[2],ge=t[3];return r[0]=Y*n+te*o+pe*v+ge*U,r[1]=Y*i+te*A+pe*x+ge*N,r[2]=Y*s+te*f+pe*B+ge*Q,r[3]=Y*a+te*m+pe*M+ge*q,Y=t[4],te=t[5],pe=t[6],ge=t[7],r[4]=Y*n+te*o+pe*v+ge*U,r[5]=Y*i+te*A+pe*x+ge*N,r[6]=Y*s+te*f+pe*B+ge*Q,r[7]=Y*a+te*m+pe*M+ge*q,Y=t[8],te=t[9],pe=t[10],ge=t[11],r[8]=Y*n+te*o+pe*v+ge*U,r[9]=Y*i+te*A+pe*x+ge*N,r[10]=Y*s+te*f+pe*B+ge*Q,r[11]=Y*a+te*m+pe*M+ge*q,Y=t[12],te=t[13],pe=t[14],ge=t[15],r[12]=Y*n+te*o+pe*v+ge*U,r[13]=Y*i+te*A+pe*x+ge*N,r[14]=Y*s+te*f+pe*B+ge*Q,r[15]=Y*a+te*m+pe*M+ge*q,r}function x0(r,e,t){var n=t[0],i=t[1],s=t[2],a,o,A,f,m,v,x,B,M,U,N,Q;return e===r?(r[12]=e[0]*n+e[4]*i+e[8]*s+e[12],r[13]=e[1]*n+e[5]*i+e[9]*s+e[13],r[14]=e[2]*n+e[6]*i+e[10]*s+e[14],r[15]=e[3]*n+e[7]*i+e[11]*s+e[15]):(a=e[0],o=e[1],A=e[2],f=e[3],m=e[4],v=e[5],x=e[6],B=e[7],M=e[8],U=e[9],N=e[10],Q=e[11],r[0]=a,r[1]=o,r[2]=A,r[3]=f,r[4]=m,r[5]=v,r[6]=x,r[7]=B,r[8]=M,r[9]=U,r[10]=N,r[11]=Q,r[12]=a*n+m*i+M*s+e[12],r[13]=o*n+v*i+U*s+e[13],r[14]=A*n+x*i+N*s+e[14],r[15]=f*n+B*i+Q*s+e[15]),r}function fb(r,e,t){var n=t[0],i=t[1],s=t[2];return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*i,r[5]=e[5]*i,r[6]=e[6]*i,r[7]=e[7]*i,r[8]=e[8]*s,r[9]=e[9]*s,r[10]=e[10]*s,r[11]=e[11]*s,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function mG(r,e,t,n){var i=n[0],s=n[1],a=n[2],o=Math.hypot(i,s,a),A,f,m,v,x,B,M,U,N,Q,q,Y,te,pe,ge,ye,fe,Oe,Fe,oe,le,xe,_e,tt;return o<Yp?null:(o=1/o,i*=o,s*=o,a*=o,A=Math.sin(t),f=Math.cos(t),m=1-f,v=e[0],x=e[1],B=e[2],M=e[3],U=e[4],N=e[5],Q=e[6],q=e[7],Y=e[8],te=e[9],pe=e[10],ge=e[11],ye=i*i*m+f,fe=s*i*m+a*A,Oe=a*i*m-s*A,Fe=i*s*m-a*A,oe=s*s*m+f,le=a*s*m+i*A,xe=i*a*m+s*A,_e=s*a*m-i*A,tt=a*a*m+f,r[0]=v*ye+U*fe+Y*Oe,r[1]=x*ye+N*fe+te*Oe,r[2]=B*ye+Q*fe+pe*Oe,r[3]=M*ye+q*fe+ge*Oe,r[4]=v*Fe+U*oe+Y*le,r[5]=x*Fe+N*oe+te*le,r[6]=B*Fe+Q*oe+pe*le,r[7]=M*Fe+q*oe+ge*le,r[8]=v*xe+U*_e+Y*tt,r[9]=x*xe+N*_e+te*tt,r[10]=B*xe+Q*_e+pe*tt,r[11]=M*xe+q*_e+ge*tt,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)}function CT(r,e,t){var n=Math.sin(t),i=Math.cos(t),s=e[4],a=e[5],o=e[6],A=e[7],f=e[8],m=e[9],v=e[10],x=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=s*i+f*n,r[5]=a*i+m*n,r[6]=o*i+v*n,r[7]=A*i+x*n,r[8]=f*i-s*n,r[9]=m*i-a*n,r[10]=v*i-o*n,r[11]=x*i-A*n,r}function yG(r,e,t){var n=Math.sin(t),i=Math.cos(t),s=e[0],a=e[1],o=e[2],A=e[3],f=e[8],m=e[9],v=e[10],x=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=s*i-f*n,r[1]=a*i-m*n,r[2]=o*i-v*n,r[3]=A*i-x*n,r[8]=s*n+f*i,r[9]=a*n+m*i,r[10]=o*n+v*i,r[11]=A*n+x*i,r}function ET(r,e,t){var n=Math.sin(t),i=Math.cos(t),s=e[0],a=e[1],o=e[2],A=e[3],f=e[4],m=e[5],v=e[6],x=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=s*i+f*n,r[1]=a*i+m*n,r[2]=o*i+v*n,r[3]=A*i+x*n,r[4]=f*i-s*n,r[5]=m*i-a*n,r[6]=v*i-o*n,r[7]=x*i-A*n,r}function _G(r,e){var t=e[0],n=e[1],i=e[2],s=e[4],a=e[5],o=e[6],A=e[8],f=e[9],m=e[10];return r[0]=Math.hypot(t,n,i),r[1]=Math.hypot(s,a,o),r[2]=Math.hypot(A,f,m),r}function vG(r,e){var t=e[0],n=e[1],i=e[2],s=e[3],a=t+t,o=n+n,A=i+i,f=t*a,m=n*a,v=n*o,x=i*a,B=i*o,M=i*A,U=s*a,N=s*o,Q=s*A;return r[0]=1-v-M,r[1]=m+Q,r[2]=x-N,r[3]=0,r[4]=m-Q,r[5]=1-f-M,r[6]=B+U,r[7]=0,r[8]=x+N,r[9]=B-U,r[10]=1-f-v,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function bG(r,e,t,n,i,s,a){var o=1/(t-e),A=1/(i-n),f=1/(s-a);return r[0]=s*2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s*2*A,r[6]=0,r[7]=0,r[8]=(t+e)*o,r[9]=(i+n)*A,r[10]=(a+s)*f,r[11]=-1,r[12]=0,r[13]=0,r[14]=a*s*2*f,r[15]=0,r}function wG(r,e,t,n,i){var s=1/Math.tan(e/2),a;return r[0]=s/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0?(a=1/(n-i),r[10]=(i+n)*a,r[14]=2*i*n*a):(r[10]=-1,r[14]=-2*n),r}var xG=wG;function BG(r,e,t,n,i,s,a){var o=1/(e-t),A=1/(n-i),f=1/(s-a);return r[0]=-2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*A,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*f,r[11]=0,r[12]=(e+t)*o,r[13]=(i+n)*A,r[14]=(a+s)*f,r[15]=1,r}var CG=BG;function EG(r,e,t,n){var i,s,a,o,A,f,m,v,x,B,M=e[0],U=e[1],N=e[2],Q=n[0],q=n[1],Y=n[2],te=t[0],pe=t[1],ge=t[2];return Math.abs(M-te)<Yp&&Math.abs(U-pe)<Yp&&Math.abs(N-ge)<Yp?fG(r):(m=M-te,v=U-pe,x=N-ge,B=1/Math.hypot(m,v,x),m*=B,v*=B,x*=B,i=q*x-Y*v,s=Y*m-Q*x,a=Q*v-q*m,B=Math.hypot(i,s,a),B?(B=1/B,i*=B,s*=B,a*=B):(i=0,s=0,a=0),o=v*a-x*s,A=x*i-m*a,f=m*s-v*i,B=Math.hypot(o,A,f),B?(B=1/B,o*=B,A*=B,f*=B):(o=0,A=0,f=0),r[0]=i,r[1]=o,r[2]=m,r[3]=0,r[4]=s,r[5]=A,r[6]=v,r[7]=0,r[8]=a,r[9]=f,r[10]=x,r[11]=0,r[12]=-(i*M+s*U+a*N),r[13]=-(o*M+A*U+f*N),r[14]=-(m*M+v*U+x*N),r[15]=1,r)}function SG(){var r=new Qc(4);return Qc!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function TG(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r}function ST(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r}function IG(r){var e=r[0],t=r[1],n=r[2],i=r[3];return Math.hypot(e,t,n,i)}function LG(r){var e=r[0],t=r[1],n=r[2],i=r[3];return e*e+t*t+n*n+i*i}function FG(r,e){var t=e[0],n=e[1],i=e[2],s=e[3],a=t*t+n*n+i*i+s*s;return a>0&&(a=1/Math.sqrt(a)),r[0]=t*a,r[1]=n*a,r[2]=i*a,r[3]=s*a,r}function MG(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3]}function PG(r,e,t,n){var i=e[0],s=e[1],a=e[2],o=e[3];return r[0]=i+n*(t[0]-i),r[1]=s+n*(t[1]-s),r[2]=a+n*(t[2]-a),r[3]=o+n*(t[3]-o),r}function Zp(r,e,t){var n=e[0],i=e[1],s=e[2],a=e[3];return r[0]=t[0]*n+t[4]*i+t[8]*s+t[12]*a,r[1]=t[1]*n+t[5]*i+t[9]*s+t[13]*a,r[2]=t[2]*n+t[6]*i+t[10]*s+t[14]*a,r[3]=t[3]*n+t[7]*i+t[11]*s+t[15]*a,r}function UG(r,e,t){var n=e[0],i=e[1],s=e[2],a=t[0],o=t[1],A=t[2],f=t[3],m=f*n+o*s-A*i,v=f*i+A*n-a*s,x=f*s+a*i-o*n,B=-a*n-o*i-A*s;return r[0]=m*f+B*-a+v*-A-x*-o,r[1]=v*f+B*-o+x*-a-m*-A,r[2]=x*f+B*-A+m*-o-v*-a,r[3]=e[3],r}(function(){var r=SG();return function(e,t,n,i,s,a){var o,A;for(t||(t=4),n||(n=0),i?A=Math.min(i*t+n,e.length):A=e.length,o=n;o<A;o+=t)r[0]=e[o],r[1]=e[o+1],r[2]=e[o+2],r[3]=e[o+3],s(r,r,a),e[o]=r[0],e[o+1]=r[1],e[o+2]=r[2],e[o+3]=r[3];return e}})();var pb;(function(r){r[r.COL0ROW0=0]="COL0ROW0",r[r.COL0ROW1=1]="COL0ROW1",r[r.COL0ROW2=2]="COL0ROW2",r[r.COL0ROW3=3]="COL0ROW3",r[r.COL1ROW0=4]="COL1ROW0",r[r.COL1ROW1=5]="COL1ROW1",r[r.COL1ROW2=6]="COL1ROW2",r[r.COL1ROW3=7]="COL1ROW3",r[r.COL2ROW0=8]="COL2ROW0",r[r.COL2ROW1=9]="COL2ROW1",r[r.COL2ROW2=10]="COL2ROW2",r[r.COL2ROW3=11]="COL2ROW3",r[r.COL3ROW0=12]="COL3ROW0",r[r.COL3ROW1=13]="COL3ROW1",r[r.COL3ROW2=14]="COL3ROW2",r[r.COL3ROW3=15]="COL3ROW3"})(pb||(pb={}));const RG=45*Math.PI/180,OG=1,gb=.1,mb=500,DG=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Bn extends wT{static get IDENTITY(){return NG()}static get ZERO(){return kG()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return pb}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,n,i,s,a,o,A,f,m,v,x,B,M,U,N){return this[0]=e,this[1]=t,this[2]=n,this[3]=i,this[4]=s,this[5]=a,this[6]=o,this[7]=A,this[8]=f,this[9]=m,this[10]=v,this[11]=x,this[12]=B,this[13]=M,this[14]=U,this[15]=N,this.check()}setRowMajor(e,t,n,i,s,a,o,A,f,m,v,x,B,M,U,N){return this[0]=e,this[1]=s,this[2]=f,this[3]=B,this[4]=t,this[5]=a,this[6]=m,this[7]=M,this[8]=n,this[9]=o,this[10]=v,this[11]=U,this[12]=i,this[13]=A,this[14]=x,this[15]=N,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(DG)}fromObject(e){return this.check()}fromQuaternion(e){return vG(this,e),this.check()}frustum(e){const{left:t,right:n,bottom:i,top:s,near:a=gb,far:o=mb}=e;return o===1/0?QG(this,t,n,i,s,a):bG(this,t,n,i,s,a,o),this.check()}lookAt(e){const{eye:t,center:n=[0,0,0],up:i=[0,1,0]}=e;return EG(this,t,n,i),this.check()}ortho(e){const{left:t,right:n,bottom:i,top:s,near:a=gb,far:o=mb}=e;return CG(this,t,n,i,s,a,o),this.check()}orthographic(e){const{fovy:t=RG,aspect:n=OG,focalDistance:i=1,near:s=gb,far:a=mb}=e;TT(t);const o=t/2,A=i*Math.tan(o),f=A*n;return this.ortho({left:-f,right:f,bottom:-A,top:A,near:s,far:a})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:n=1,near:i=.1,far:s=500}=e;return TT(t),xG(this,t,n,i,s),this.check()}determinant(){return gG(this)}getScale(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[-0,-0,-0];return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[-0,-0,-0];return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),i=1/n[0],s=1/n[1],a=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*a,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*a,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),i=1/n[0],s=1/n[1],a=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*a,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*a,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*a,e}transpose(){return pG(this,this),this.check()}invert(){return db(this,this),this.check()}multiplyLeft(e){return Mh(this,e,this),this.check()}multiplyRight(e){return Mh(this,this,e),this.check()}rotateX(e){return CT(this,this,e),this.check()}rotateY(e){return yG(this,this,e),this.check()}rotateZ(e){return ET(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return mG(this,this,e,t),this.check()}scale(e){return fb(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return x0(this,this,e),this.check()}transform(e,t){return e.length===4?(t=Zp(t||[-0,-0,-0,-0],e,this),Jp(t,4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:n}=e;let i;switch(n){case 2:i=dT(t||[-0,-0],e,this);break;case 3:i=lb(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Jp(i,e.length),i}transformAsVector(e,t){let n;switch(e.length){case 2:n=fT(t||[-0,-0],e,this);break;case 3:n=pT(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Jp(n,e.length),n}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,n){return this.identity().translate([e,t,n])}}let B0,C0;function kG(){return B0||(B0=new Bn([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(B0)),B0}function NG(){return C0||(C0=new Bn,Object.freeze(C0)),C0}function TT(r){if(r>Math.PI*2)throw Error("expected radians")}function QG(r,e,t,n,i,s){const a=2*s/(t-e),o=2*s/(i-n),A=(t+e)/(t-e),f=(i+n)/(i-n),m=-1,v=-1,x=-2*s;return r[0]=a,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o,r[6]=0,r[7]=0,r[8]=A,r[9]=f,r[10]=m,r[11]=v,r[12]=0,r[13]=0,r[14]=x,r[15]=0,r}function IT(){var r=new Qc(4);return Qc!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function HG(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function LT(r,e,t){t=t*.5;var n=Math.sin(t);return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=Math.cos(t),r}function FT(r,e,t){var n=e[0],i=e[1],s=e[2],a=e[3],o=t[0],A=t[1],f=t[2],m=t[3];return r[0]=n*m+a*o+i*f-s*A,r[1]=i*m+a*A+s*o-n*f,r[2]=s*m+a*f+n*A-i*o,r[3]=a*m-n*o-i*A-s*f,r}function zG(r,e,t){t*=.5;var n=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(t),A=Math.cos(t);return r[0]=n*A+a*o,r[1]=i*A+s*o,r[2]=s*A-i*o,r[3]=a*A-n*o,r}function GG(r,e,t){t*=.5;var n=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(t),A=Math.cos(t);return r[0]=n*A-s*o,r[1]=i*A+a*o,r[2]=s*A+n*o,r[3]=a*A-i*o,r}function VG(r,e,t){t*=.5;var n=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(t),A=Math.cos(t);return r[0]=n*A+i*o,r[1]=i*A-n*o,r[2]=s*A+a*o,r[3]=a*A-s*o,r}function jG(r,e){var t=e[0],n=e[1],i=e[2];return r[0]=t,r[1]=n,r[2]=i,r[3]=Math.sqrt(Math.abs(1-t*t-n*n-i*i)),r}function E0(r,e,t,n){var i=e[0],s=e[1],a=e[2],o=e[3],A=t[0],f=t[1],m=t[2],v=t[3],x,B,M,U,N;return B=i*A+s*f+a*m+o*v,B<0&&(B=-B,A=-A,f=-f,m=-m,v=-v),1-B>Yp?(x=Math.acos(B),M=Math.sin(x),U=Math.sin((1-n)*x)/M,N=Math.sin(n*x)/M):(U=1-n,N=n),r[0]=U*i+N*A,r[1]=U*s+N*f,r[2]=U*a+N*m,r[3]=U*o+N*v,r}function qG(r,e){var t=e[0],n=e[1],i=e[2],s=e[3],a=t*t+n*n+i*i+s*s,o=a?1/a:0;return r[0]=-t*o,r[1]=-n*o,r[2]=-i*o,r[3]=s*o,r}function KG(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r}function MT(r,e){var t=e[0]+e[4]+e[8],n;if(t>0)n=Math.sqrt(t+1),r[3]=.5*n,n=.5/n,r[0]=(e[5]-e[7])*n,r[1]=(e[6]-e[2])*n,r[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var s=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[i*3+i]-e[s*3+s]-e[a*3+a]+1),r[i]=.5*n,n=.5/n,r[3]=(e[s*3+a]-e[a*3+s])*n,r[s]=(e[s*3+i]+e[i*3+s])*n,r[a]=(e[a*3+i]+e[i*3+a])*n}return r}var WG=TG,$G=ST,XG=MG,JG=PG,YG=IG,ZG=LG,PT=FG,eV=function(){var r=mT(),e=_T(1,0,0),t=_T(0,1,0);return function(n,i,s){var a=cb(i,s);return a<-.999999?(y0(r,e,i),nG(r)<1e-6&&y0(r,t,i),J9(r,r),LT(n,r,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(y0(r,i,s),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=1+a,PT(n,n))}}();(function(){var r=IT(),e=IT();return function(t,n,i,s,a,o){return E0(r,n,a,o),E0(e,i,s,o),E0(t,r,e,2*o*(1-o)),t}})(),function(){var r=iG();return function(e,t,n,i){return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=-t[0],r[5]=-t[1],r[8]=-t[2],PT(e,MT(e,r))}}();const tV=[0,0,0,1];class eg extends sb{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,t,n,i)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,n,i){return this[0]=e,this[1]=t,this[2]=n,this[3]=i,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return MT(this,e),this.check()}fromAxisRotation(e,t){return LT(this,e,t),this.check()}identity(){return HG(this),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Qn(e)}get y(){return this[1]}set y(e){this[1]=Qn(e)}get z(){return this[2]}set z(e){this[2]=Qn(e)}get w(){return this[3]}set w(e){this[3]=Qn(e)}len(){return YG(this)}lengthSquared(){return ZG(this)}dot(e){return XG(this,e)}rotationTo(e,t){return eV(this,e,t),this.check()}add(e){return WG(this,this,e),this.check()}calculateW(){return jG(this,this),this.check()}conjugate(){return KG(this,this),this.check()}invert(){return qG(this,this),this.check()}lerp(e,t,n){return n===void 0?this.lerp(this,e,t):(JG(this,e,t,n),this.check())}multiplyRight(e){return FT(this,this,e),this.check()}multiplyLeft(e){return FT(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,e===0&&(this[3]=1),this.check()}rotateX(e){return zG(this,this,e),this.check()}rotateY(e){return GG(this,this,e),this.check()}rotateZ(e){return VG(this,this,e),this.check()}scale(e){return $G(this,this,e),this.check()}slerp(e,t,n){let i,s,a;switch(arguments.length){case 1:({start:i=tV,target:s,ratio:a}=e);break;case 2:i=this,s=e,a=t;break;default:i=e,s=t,a=n}return E0(this,i,s,a),this.check()}transformVector4(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Ab;return UG(t,e,this),Jp(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const tg={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},UT=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,rV={lightSources:{}};function yb(){let{color:r=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return r.map(t=>t*e/255)}function nV(r){let{ambientLight:e,pointLights:t=[],directionalLights:n=[]}=r;const i={};return e?i["lighting_uAmbientLight.color"]=yb(e):i["lighting_uAmbientLight.color"]=[0,0,0],t.forEach((s,a)=>{i["lighting_uPointLight[".concat(a,"].color")]=yb(s),i["lighting_uPointLight[".concat(a,"].position")]=s.position,i["lighting_uPointLight[".concat(a,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=t.length,n.forEach((s,a)=>{i["lighting_uDirectionalLight[".concat(a,"].color")]=yb(s),i["lighting_uDirectionalLight[".concat(a,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=n.length,i}function RT(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rV;if("lightSources"in r){const{ambientLight:e,pointLights:t,directionalLights:n}=r.lightSources||{};return e||t&&t.length>0||n&&n.length>0?Object.assign({},nV({ambientLight:e,pointLights:t,directionalLights:n}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in r){const e={pointLights:[],directionalLights:[]};for(const t of r.lights||[])switch(t.type){case"ambient":e.ambientLight=t;break;case"directional":e.directionalLights.push(t);break;case"point":e.pointLights.push(t);break}return RT({lightSources:e})}return{}}const _b={name:"lights",vs:UT,fs:UT,getUniforms:RT,defines:{MAX_LIGHTS:3}},iV={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1};function sV(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:iV;const e={};if(r.pickingSelectedColor!==void 0)if(!r.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const t=r.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=t}if(r.pickingHighlightColor){const t=Array.from(r.pickingHighlightColor,n=>n/255);Number.isFinite(t[3])||(t[3]=1),e.picking_uHighlightColor=t}return r.pickingActive!==void 0&&(e.picking_uActive=!!r.pickingActive,e.picking_uAttribute=!!r.pickingAttribute),e}const oV={name:"picking",vs:`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,fs:`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,getUniforms:sV},OT=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,aV={};function cV(r){const{ambient:e=.35,diffuse:t=.6,shininess:n=32,specularColor:i=[30,30,30]}=r;return{lighting_uAmbient:e,lighting_uDiffuse:t,lighting_uShininess:n,lighting_uSpecularColor:i.map(s=>s/255)}}function DT(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:aV;if(!("material"in r))return{};const{material:e}=r;return e?cV(e):{lighting_uEnabled:!1}}const lV={name:"gouraud-lighting",dependencies:[_b],vs:OT,defines:{LIGHTING_VERTEX:1},getUniforms:DT},uV={name:"phong-lighting",dependencies:[_b],fs:OT,defines:{LIGHTING_FRAGMENT:1},getUniforms:DT},vb={name:"pbr",vs:`uniform mat4 u_MVPMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_NormalMatrix;

varying vec3 pbr_vPosition;
varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
# ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
# else
varying vec3 pbr_vNormal;
# endif
#endif

void pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)
{
  vec4 pos = u_ModelMatrix * position;
  pbr_vPosition = vec3(pos.xyz) / pos.w;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));
  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));
  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;
  pbr_vTBN = mat3(tangentW, bitangentW, normalW);
#else
  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));
#endif
#endif

#ifdef HAS_UV
  pbr_vUV = uv;
#else
  pbr_vUV = vec2(0.,0.);
#endif
}
`,fs:`#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)
# error PBR fragment shader: Texture LOD is not available
#endif

#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)
# error PBR fragment shader: Derivatives are not available
#endif


#if (__VERSION__ < 300)
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)
#else
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)
#endif

precision highp float;

uniform bool pbr_uUnlit;

#ifdef USE_IBL
uniform samplerCube u_DiffuseEnvSampler;
uniform samplerCube u_SpecularEnvSampler;
uniform sampler2D u_brdfLUT;
uniform vec2 u_ScaleIBLAmbient;
#endif

#ifdef HAS_BASECOLORMAP
uniform sampler2D u_BaseColorSampler;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D u_NormalSampler;
uniform float u_NormalScale;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D u_EmissiveSampler;
uniform vec3 u_EmissiveFactor;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D u_MetallicRoughnessSampler;
#endif
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D u_OcclusionSampler;
uniform float u_OcclusionStrength;
#endif

#ifdef ALPHA_CUTOFF
uniform float u_AlphaCutoff;
#endif

uniform vec2 u_MetallicRoughnessValues;
uniform vec4 u_BaseColorFactor;

uniform vec3 u_Camera;
#ifdef PBR_DEBUG
uniform vec4 u_ScaleDiffBaseMR;
uniform vec4 u_ScaleFGDSpec;
#endif

varying vec3 pbr_vPosition;

varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
#else
varying vec3 pbr_vNormal;
#endif
#endif


struct PBRInfo
{
  float NdotL;
  float NdotV;
  float NdotH;
  float LdotH;
  float VdotH;
  float perceptualRoughness;
  float metalness;
  vec3 reflectance0;
  vec3 reflectance90;
  float alphaRoughness;
  vec3 diffuseColor;
  vec3 specularColor;
  vec3 n;
  vec3 v;
};

const float M_PI = 3.141592653589793;
const float c_MinRoughness = 0.04;

vec4 SRGBtoLINEAR(vec4 srgbIn)
{
#ifdef MANUAL_SRGB
#ifdef SRGB_FAST_APPROXIMATION
  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));
#else
  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);
  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );
#endif
  return vec4(linOut,srgbIn.w);;
#else
  return srgbIn;
#endif
}

vec3 getNormal()
{
#ifndef HAS_TANGENTS
  vec3 pos_dx = dFdx(pbr_vPosition);
  vec3 pos_dy = dFdy(pbr_vPosition);
  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));
  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));
  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);

#ifdef HAS_NORMALS
  vec3 ng = normalize(pbr_vNormal);
#else
  vec3 ng = cross(pos_dx, pos_dy);
#endif

  t = normalize(t - ng * dot(ng, t));
  vec3 b = normalize(cross(ng, t));
  mat3 tbn = mat3(t, b, ng);
#else
  mat3 tbn = pbr_vTBN;
#endif

#ifdef HAS_NORMALMAP
  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;
  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));
#else
  vec3 n = normalize(tbn[2].xyz);
#endif

  return n;
}


#ifdef USE_IBL
vec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)
{
  float mipCount = 9.0;
  float lod = (pbrInputs.perceptualRoughness * mipCount);
  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,
    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;
  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;

#ifdef USE_TEX_LOD
  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;
#else
  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;
#endif

  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;
  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);
  diffuse *= u_ScaleIBLAmbient.x;
  specular *= u_ScaleIBLAmbient.y;

  return diffuse + specular;
}
#endif


vec3 diffuse(PBRInfo pbrInputs)
{
  return pbrInputs.diffuseColor / M_PI;
}

vec3 specularReflection(PBRInfo pbrInputs)
{
  return pbrInputs.reflectance0 +
    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *
    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);
}



float geometricOcclusion(PBRInfo pbrInputs)
{
  float NdotL = pbrInputs.NdotL;
  float NdotV = pbrInputs.NdotV;
  float r = pbrInputs.alphaRoughness;

  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));
  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));
  return attenuationL * attenuationV;
}





float microfacetDistribution(PBRInfo pbrInputs)
{
  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;
  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;
  return roughnessSq / (M_PI * f * f);
}

void PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {
  pbrInputs.NdotL = 1.0;
  pbrInputs.NdotH = 0.0;
  pbrInputs.LdotH = 0.0;
  pbrInputs.VdotH = 1.0;
}

void PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {
  vec3 n = pbrInputs.n;
  vec3 v = pbrInputs.v;
  vec3 l = normalize(lightDirection);
  vec3 h = normalize(l+v);

  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);
  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);
  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);
  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);
}

void PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {
  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);
  PBRInfo_setDirectionalLight(pbrInputs, light_direction);
}

vec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {
  vec3 F = specularReflection(pbrInputs);
  float G = geometricOcclusion(pbrInputs);
  float D = microfacetDistribution(pbrInputs);
  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);
  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);
  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);
}

vec4 pbr_filterColor(vec4 colorUnused)
{
#ifdef HAS_BASECOLORMAP
  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;
#else
  vec4 baseColor = u_BaseColorFactor;
#endif

#ifdef ALPHA_CUTOFF
  if (baseColor.a < u_AlphaCutoff) {
    discard;
  }
#endif

  vec3 color = vec3(0, 0, 0);

  if(pbr_uUnlit){
    color.rgb = baseColor.rgb;
  }
  else{


    float perceptualRoughness = u_MetallicRoughnessValues.y;
    float metallic = u_MetallicRoughnessValues.x;
#ifdef HAS_METALROUGHNESSMAP

    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);
    perceptualRoughness = mrSample.g * perceptualRoughness;
    metallic = mrSample.b * metallic;
#endif
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);
    metallic = clamp(metallic, 0.0, 1.0);

    float alphaRoughness = perceptualRoughness * perceptualRoughness;

    vec3 f0 = vec3(0.04);
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);
    diffuseColor *= 1.0 - metallic;
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);



    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);
    vec3 specularEnvironmentR0 = specularColor.rgb;
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;

    vec3 n = getNormal();
    vec3 v = normalize(u_Camera - pbr_vPosition);

    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);
    vec3 reflection = -normalize(reflect(v, n));

    PBRInfo pbrInputs = PBRInfo(
      0.0,
      NdotV,
      0.0,
      0.0,
      0.0,
      perceptualRoughness,
      metallic,
      specularEnvironmentR0,
      specularEnvironmentR90,
      alphaRoughness,
      diffuseColor,
      specularColor,
      n,
      v
    );

#ifdef USE_LIGHTS
    PBRInfo_setAmbientLight(pbrInputs);
    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {
      if (i < lighting_uDirectionalLightCount) {
        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);
        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);
      }
    }
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {
      if (i < lighting_uPointLightCount) {
        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);
        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));
        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);
      }
    }
#endif
#ifdef USE_IBL
    color += getIBLContribution(pbrInputs, n, reflection);
#endif
#ifdef HAS_OCCLUSIONMAP
    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;
    color = mix(color, color * ao, u_OcclusionStrength);
#endif

#ifdef HAS_EMISSIVEMAP
    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;
    color += emissive;
#endif

#ifdef PBR_DEBUG





    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);
    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);
    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);
#endif

  }

  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);
}
`,defines:{LIGHTING_FRAGMENT:1},dependencies:[_b]},AV={name:"transform",vs:`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,fs:null};class rg{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new rg(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(t=>t.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(n=>n.name!==t),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:t="",fs:n="",defines:i={},inject:s={},varyings:a=[],bufferMode:o=35981,transpileToGLSL100:A=!1}=e,f=this._getModuleList(e.modules),m=this._getHash(t),v=this._getHash(n),x=f.map(Y=>this._getHash(Y.name)).sort(),B=a.map(Y=>this._getHash(Y)),M=Object.keys(i).sort(),U=Object.keys(s).sort(),N=[],Q=[];for(const Y of M)N.push(this._getHash(Y)),N.push(this._getHash(i[Y]));for(const Y of U)Q.push(this._getHash(Y)),Q.push(this._getHash(s[Y]));const q="".concat(m,"/").concat(v,"D").concat(N.join("/"),"M").concat(x.join("/"),"I").concat(Q.join("/"),"V").concat(B.join("/"),"H").concat(this.stateHash,"B").concat(o).concat(A?"T":"");if(!this._programCache[q]){const Y=v9(this.gl,{vs:t,fs:n,modules:f,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:A});this._programCache[q]=new G5(this.gl,{hash:q,vs:Y.vs,fs:Y.fs,varyings:a,bufferMode:o}),this._getUniforms[q]=Y.getUniforms||(te=>{}),this._useCounts[q]=0}return this._useCounts[q]++,this._programCache[q]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,this._useCounts[t]===0&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=new Array(this._defaultModules.length+e.length),n={};let i=0;for(let s=0,a=this._defaultModules.length;s<a;++s){const o=this._defaultModules[s],A=o.name;t[i++]=o,n[A]=!0}for(let s=0,a=e.length;s<a;++s){const o=e[s],A=o.name;n[A]||(t[i++]=o,n[A]=!0)}return t.length=i,t}}const hV={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function dV(r,e,t){const n={};let i=e.indices;for(const s in e.attributes){const a=e.attributes[s],o=fV(s,t);if(s==="indices")i=a;else if(a.constant)n[o]=a.value;else{const A=a.value,f={...a};delete f.value,n[o]=[new ri(r,A),f],pV(s,f)}}if(i){const s=i.value||i;ar(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const a={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};n.indices=[new ri(r,{data:s,target:34963}),a]}return n}function fV(r,e){const{attributeMap:t=hV}=e||{};return t&&t[r]||r}function pV(r,e){let t;switch(r){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":t="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":t="vectors";break}switch(t){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}ar(Number.isFinite(e.size),"attribute ".concat(r," needs size"))}const jd=2,gV=1e4,mV="Model needs drawMode and vertexCount",kT=()=>{},yV={};class qd{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:n=Eu("model")}=t;ar(s0(e)),this.id=n,this.gl=e,this.id=t.id||Eu("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||rg.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:n,fs:i,modules:s,defines:a,inject:o,varyings:A,bufferMode:f,transpileToGLSL100:m}=e;this.programProps={program:t,vs:n,fs:i,modules:s,defines:a,inject:o,varyings:A,bufferMode:f,transpileToGLSL100:m},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},ar(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),mV)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:n,fs:i,modules:s,defines:a,inject:o,varyings:A,bufferMode:f,transpileToGLSL100:m}=e;this.programProps={program:t,vs:n,fs:i,modules:s,defines:a,inject:o,varyings:A,bufferMode:f,transpileToGLSL100:m},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return ar(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return ar(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=dV(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Qd(e))return this;const t={};for(const n in e){const i=e[n];t[n]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(t),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return Gv(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:t=null,framebuffer:n,uniforms:i={},attributes:s={},transformFeedback:a=this.transformFeedback,parameters:o={},vertexArray:A=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(t),this.setUniforms(i);let f;yr.priority>=jd&&(f=this._logDrawCallStart(jd));const m=this.vertexArray.getDrawParams(),{isIndexed:v=m.isIndexed,indexType:x=m.indexType,indexOffset:B=m.indexOffset,vertexArrayInstanced:M=m.isInstanced}=this.props;M&&!this.isInstanced&&yr.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:U,instanceCount:N}=this,{onBeforeRender:Q=kT,onAfterRender:q=kT}=this.props;Q(),this.program.setUniforms(this.uniforms);const Y=this.program.draw(Object.assign(yV,e,{logPriority:f,uniforms:null,framebuffer:n,parameters:o,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:A,transformFeedback:a,isIndexed:v,indexType:x,isInstanced:U,instanceCount:N,offset:v?B:0}));return q(),yr.priority>=jd&&this._logDrawCallEnd(f,A,n),Y}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:t=!0,feedbackBuffers:n,unbindModels:i=[]}=e;let{parameters:s}=e;n&&this._setFeedbackBuffers(n),t&&(s=Object.assign({},s,{35977:t})),i.forEach(a=>a.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(a=>a.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return yr.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:n,fs:i,modules:s,inject:a,defines:o,varyings:A,bufferMode:f,transpileToGLSL100:m}=this.programProps;t=this.programManager.get({vs:n,fs:i,modules:s,inject:a,defines:o,varyings:A,bufferMode:f,transpileToGLSL100:m}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}ar(t instanceof G5,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Rz(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof ri&&t.delete()}}_setAnimationProps(e){this.animated&&ar(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Qd(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new V5(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:gV;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),yr.group(jd,">>> DRAWING MODEL ".concat(this.id),{collapsed:yr.level<=2})(),e}_logDrawCallEnd(e,t,n,i){if(e===void 0)return;const s=kz({vertexArray:t,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:a,unusedTable:o,unusedCount:A}=j5({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:f,count:m}=j5({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});m>0&&yr.log("MISSING UNIFORMS",Object.keys(f))(),A>0&&yr.log("UNUSED UNIFORMS",Object.keys(o))();const v=Qz(this.vertexArray.configuration);yr.table(e,s)(),yr.table(e,a)(),yr.table(e+1,v)(),i&&i.log({logLevel:jd,message:"Rendered to ".concat(i.id)}),yr.groupEnd(jd)()}}class _V{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:i}=t;return{attributes:Object.assign({},n,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],n=e?t[e]:null;return n?n instanceof ri?n:n.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:t}=e,n=this.getBuffer(t);return n?n.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&ar(gn(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in t&&(n[s]=i)}Object.assign(n,e.feedbackBuffers);for(const i in n){const s=n[i];if(typeof s=="string"){const a=t[s],{byteLength:o,usage:A,accessor:f}=a;n[i]=this._createNewBuffer(i,{byteLength:o,usage:A,accessor:f})}}return n}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const n=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:n})}_setupTransformFeedback(e,t){let{model:n}=t;const{program:i}=n;e.transformFeedback=new V5(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:n}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:t,feedbackBuffers:n})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),n=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];t[i]=e.feedbackBuffers[s],n[s]=e.sourceBuffers[i],ar(n[s]instanceof ri)}return{sourceBuffers:t,feedbackBuffers:n}}_createNewBuffer(e,t){const n=new ri(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}const vV="transform_uSampler_",S0="transform_uSize_",NT="transform_position";function bV(r){let{vs:e,sourceTextureMap:t,targetTextureVarying:n,targetTexture:i}=r,a=Object.keys(t).length,o=null;const A={};let f=e,m={};if(a>0||n){const v=f.split(`
`),x=v.slice();if(v.forEach((B,M,U)=>{if(a>0){const N=EV(B,t);if(N){const{updatedLine:Q,inject:q}=N;x[M]=Q,m=tb([m,q]),Object.assign(A,N.samplerTextureMap),a--}}n&&!o&&(o=CV(B,n))}),n){ar(i);const B="".concat(S0).concat(n),M="uniform vec2 ".concat(B,`;
`),U="     vec2 ".concat(NT," = transform_getPos(").concat(B,`);
     gl_Position = vec4(`).concat(NT,`, 0, 1.);
`);m=tb([m,{"vs:#decl":M,"vs:#main-start":U}])}f=x.join(`
`)}return{vs:f,targetTextureType:o,inject:m,samplerTextureMap:A}}function wV(r){let{sourceTextureMap:e,targetTextureVarying:t,targetTexture:n}=r;const i={};let s,a;t&&({width:s,height:a}=n,i["".concat(S0).concat(t)]=[s,a]);for(const o in e)({width:s,height:a}=e[o]),i["".concat(S0).concat(o)]=[s,a];return i}function xV(r){return cT(r,["attribute","in"])}function BV(r){const e="".concat(vV).concat(r),t="".concat(S0).concat(r),n="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(t,";");return{samplerName:e,sizeName:t,uniformDeclerations:n}}function CV(r,e){const t=cT(r,["varying","out"]);return t&&t.name===e?t.type:null}function EV(r,e){const t={},n=xV(r);if(!n)return null;const{type:i,name:s}=n;if(s&&e[s]){const a="// ".concat(r," => Replaced by Transform with a sampler"),{samplerName:o,sizeName:A,uniformDeclerations:f}=BV(s),m=I9(i),v="  ".concat(i," ").concat(s," = transform_getInput(").concat(o,", ").concat(A,").").concat(m,`;
`);return t[o]=s,{updatedLine:a,inject:{"vs:#decl":f,"vs:#main-start":v},samplerTextureMap:t}}return null}const SV={10241:9728,10240:9728,10242:33071,10243:33071},TV="transform_output";class IV{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:t,sourceTextures:n,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],a=Object.assign({},t,e.attributes),o=Object.assign({},e.uniforms),A=Object.assign({},e.parameters);let f=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){a.transform_elementID=this.elementIDBuffer;for(const v in this.samplerTextureMap){const x=this.samplerTextureMap[v];o[v]=n[x]}this._setSourceTextureParameters();const m=wV({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(o,m)}return this.hasTargetTexture&&(f=!1,A.viewport=[0,0,i.width,i.height]),{attributes:a,framebuffer:i,uniforms:o,discard:f,parameters:A}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:t}=this.bindings[this.currentIndex],n=a0(t);if(!e)return n;const i=n.constructor,s=L9(this.targetTextureType),a=new i(n.length*s/4);let o=0;for(let A=0;A<n.length;A+=4)for(let f=0;f<s;f++)a[o++]=n[A+f];return a}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:t,_swapTexture:n}=e;this._swapTexture=n,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:n}=e;if(n instanceof Ia)return n;const i=t[n];return i?(this._targetRefTexName=n,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:t,_sourceTextures:n={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:n,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:n,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach((n,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new ri(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:t,targetTexture:n}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:t,targetTexture:n})}}_updateBinding(e,t){const{sourceBuffers:n,sourceTextures:i,targetTexture:s}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,n),s){e.targetTexture=s;const{width:a,height:o}=s,{framebuffer:A}=e;A?(A.update({attachments:{36064:s},resizeAttachments:!1}),A.resize({width:a,height:o})):e.framebuffer=new bs(this.gl,{id:"transform-framebuffer",width:a,height:o,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const n in t)t[n].setParameters(SV)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);t[this._swapTexture]=e.targetTexture;const n=e.sourceTextures[this._swapTexture];return{sourceTextures:t,targetTexture:n}}_createNewTexture(e){const t=BH(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:t,targetTexture:n}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:a,inject:o,samplerTextureMap:A}=bV({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),f=tb([e.inject||{},o]);this.targetTextureType=a,this.samplerTextureMap=A;const m=e._fs||lT({version:O5(i),input:this.targetTextureVarying,inputType:a,output:TV}),v=this.hasSourceTextures||this.targetTextureVarying?[AV].concat(e.modules||[]):e.modules;return{vs:i,fs:m,modules:v,uniforms:s,inject:f}}}class bb{static isSupported(e){return gn(e)}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:n}=this;e&&e.delete(),t&&t.delete(),n&&n.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:t=!0}=e,n=this._updateDrawOptions(e);t&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of t)e=e||n.swap();ar(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of t){const i=n.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of t)n.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new qd(t,Object.assign({},e,{fs:e.fs||lT({version:O5(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)t=i.updateModelProps(t);return t}_buildResourceTransforms(e,t){LV(t)&&(this.bufferTransform=new _V(e,t)),FV(t)&&(this.textureTransform=new IV(e,t)),ar(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)t=Object.assign(t,i.getDrawOptions(t));return t}}function LV(r){return!!(!Qd(r.feedbackBuffers)||!Qd(r.feedbackMap)||r.varyings&&r.varyings.length>0)}function FV(r){return!!(!Qd(r._sourceTextures)||r._targetTexture||r._targetTextureVarying)}const QT={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class ng{static get DRAW_MODE(){return QT}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:t=Eu("geometry"),drawMode:n=QT.TRIANGLES,attributes:i={},indices:s=null,vertexCount:a=null}=e;this.id=t,this.drawMode=n|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=a||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const n in e){let i=e[n];i=ArrayBuffer.isView(i)?{value:i}:i,ar(ArrayBuffer.isView(i.value),"".concat(this._print(n),": must be typed array or object with value as typed array")),(n==="POSITION"||n==="positions")&&!i.size&&(i.size=3),n==="indices"?(ar(!this.indices),this.indices=i):this.attributes[n]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let n=1/0;for(const i in e){const s=e[i],{value:a,size:o,constant:A}=s;!A&&a&&o>=1&&(n=Math.min(n,a.length/o))}return ar(Number.isFinite(n)),n}}let MV=1,PV=1;class HT{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,a=MV++,o={time:0,delay:t,duration:n,rate:i,repeat:s};return this._setChannelTime(o,this.time),this.channels.set(a,o),a}removeChannel(e){this.channels.delete(e);for(const[t,n]of this.animations)n.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return t===void 0?!1:this.time>=t.delay+t.duration*t.repeat}getTime(e){if(e===void 0)return this.time;const t=this.channels.get(e);return t===void 0?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const i of t)this._setChannelTime(i,this.time);const n=this.animations.values();for(const i of n){const{animation:s,channel:a}=i;s.setTime(this.getTime(a))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const n=PV++;return this.animations.set(n,{animation:e,channel:t}),e.setTime(this.getTime(t)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const n=t-e.delay,i=e.duration*e.repeat;n>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}const UV=[255,255,255],RV=1;let OV=0;class zT{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W(this,"id",void 0),W(this,"color",void 0),W(this,"intensity",void 0),W(this,"type","ambient");const{color:t=UV}=e,{intensity:n=RV}=e;this.id=e.id||"ambient-".concat(OV++),this.color=t,this.intensity=n}}const DV=[255,255,255],kV=1,NV=[0,0,-1];let QV=0;class GT{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W(this,"id",void 0),W(this,"color",void 0),W(this,"intensity",void 0),W(this,"type","directional"),W(this,"direction",void 0),W(this,"shadow",void 0);const{color:t=DV}=e,{intensity:n=kV}=e,{direction:i=NV}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(QV++),this.color=t,this.intensity=n,this.type="directional",this.direction=new ut(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class HV{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{id:"pass"};W(this,"id",void 0),W(this,"gl",void 0),W(this,"props",void 0);const{id:n}=t;this.id=n,this.gl=e,this.props={...t}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class wb extends HV{constructor(){super(...arguments),W(this,"_lastRenderIndex",-1)}render(e){const t=this.gl;return Cu(t,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:t,moduleParameters:n,viewports:i,views:s,onViewportActive:a,clearStack:o=!0,clearCanvas:A=!0}=e;e.pass=e.pass||"unknown";const f=this.gl;A&&GV(f,t),o&&(this._lastRenderIndex=-1);const m=[];for(const v of i){const x=s&&s[v.id];a==null||a(v);const B=this._getDrawLayerParams(v,e),M=v.subViewports||[v];for(const U of M){const N=this._drawLayersInViewport(f,{target:t,moduleParameters:n,viewport:U,view:x,pass:e.pass,layers:e.layers},B);m.push(N)}}return m}_getDrawLayerParams(e,t){let{layers:n,pass:i,isPicking:s=!1,layerFilter:a,cullRect:o,effects:A,moduleParameters:f}=t,m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const v=[],x=VT(this._lastRenderIndex+1),B={layer:n[0],viewport:e,isPicking:s,renderPass:i,cullRect:o},M={};for(let U=0;U<n.length;U++){const N=n[U],Q=this._shouldDrawLayer(N,B,a,M),q={shouldDrawLayer:Q};Q&&!m&&(q.layerRenderIndex=x(N,Q),q.moduleParameters=this._getModuleParameters(N,A,i,f),q.layerParameters=this.getLayerParameters(N,U,e)),v[U]=q}return v}_drawLayersInViewport(e,t,n){let{layers:i,moduleParameters:s,pass:a,target:o,viewport:A,view:f}=t;const m=zV(e,{moduleParameters:s,target:o,viewport:A});if(f&&f.props.clear){const x=f.props.clear===!0?{color:!0,depth:!0}:f.props.clear;Dc(e,{scissorTest:!0,scissor:m},()=>Gv(e,x))}const v={totalCount:i.length,visibleCount:0,compositeCount:0,pickableCount:0};Cu(e,{viewport:m});for(let x=0;x<i.length;x++){const B=i[x],{shouldDrawLayer:M,layerRenderIndex:U,moduleParameters:N,layerParameters:Q}=n[x];if(M&&B.props.pickable&&v.pickableCount++,B.isComposite)v.compositeCount++;else if(M){v.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,U),N.viewport=A;try{B._drawLayer({moduleParameters:N,uniforms:{layerIndex:U},parameters:Q})}catch(q){B.raiseError(q,"drawing ".concat(B," to ").concat(a))}}}return v}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t,n){return e.props.parameters}_shouldDrawLayer(e,t,n,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;t.layer=e;let a=e.parent;for(;a;){if(!a.props.visible||!a.filterSubLayer(t))return!1;t.layer=a,a=a.parent}if(n){const o=t.layer.id;if(o in i||(i[o]=n(t)),!i[o])return!1}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,n,i){var s;const a=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:Nd(this.gl)});if(t)for(const A of t){var o;Object.assign(a,(o=A.getModuleParameters)===null||o===void 0?void 0:o.call(A,e))}return Object.assign(a,this.getModuleParameters(e,t),i)}}function VT(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={},n=(i,s)=>{const a=i.props._offset,o=i.id,A=i.parent&&i.parent.id;let f;if(A&&!(A in e)&&n(i.parent,!1),A in t){const m=t[A]=t[A]||VT(e[A],e);f=m(i,s),t[o]=m}else Number.isFinite(a)?(f=a+(e[A]||0),t[o]=null):f=r;return s&&f>=r&&(r=f+1),e[o]=f,f};return n}function zV(r,e){let{moduleParameters:t,target:n,viewport:i}=e;const s=n&&n.id!=="default-framebuffer",a=t&&t.devicePixelRatio||Nd(r),o=s?n.height:r.drawingBufferHeight,A=i;return[A.x*a,o-(A.y+A.height)*a,A.width*a,A.height*a]}function GV(r,e){const t=e?e.width:r.drawingBufferWidth,n=e?e.height:r.drawingBufferHeight;Cu(r,{viewport:[0,0,t,n]}),r.clear(16640)}class VV extends wb{constructor(e,t){super(e,t),W(this,"shadowMap",void 0),W(this,"depthBuffer",void 0),W(this,"fbo",void 0),this.shadowMap=new Ia(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Gd(e,{format:33189,width:1,height:1}),this.fbo=new bs(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;Dc(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const n=e.viewports[0],i=Nd(this.gl),s=n.width*i,a=n.height*i;(s!==t.width||a!==t.height)&&t.resize({width:s,height:a}),super.render({...e,target:t,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const jT="#define SMOOTH_EDGE_RADIUS 0.5",jV=`
`.concat(jT,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),qV=`
`.concat(jT,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),KV={name:"geometry",vs:jV,fs:qV},WV=Object.keys(Tn).map(r=>"const int COORDINATE_SYSTEM_".concat(r," = ").concat(Tn[r],";")).join(""),$V=Object.keys(kl).map(r=>"const int PROJECTION_MODE_".concat(r," = ").concat(kl[r],";")).join(""),XV=Object.keys(Lv).map(r=>"const int UNIT_".concat(r.toUpperCase()," = ").concat(Lv[r],";")).join(""),JV="".concat(WV,`
`).concat($V,`
`).concat(XV,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function YV(r,e){if(r===e)return!0;if(Array.isArray(r)){const t=r.length;if(!e||e.length!==t)return!1;for(let n=0;n<t;n++)if(r[n]!==e[n])return!1;return!0}return!1}function ig(r){let e={},t;return n=>{for(const i in n)if(!YV(n[i],e[i])){t=r(n),e=n;break}return t}}const qT=[0,0,0,0],ZV=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],KT=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ej=[0,0,0],WT=[0,0,0],tj=ig(ij);function $T(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:WT;t.length<3&&(t=[t[0],t[1],0]);let n=t,i,s=!0;switch(e===Tn.LNGLAT_OFFSETS||e===Tn.METER_OFFSETS?i=t:i=r.isGeospatial?[Math.fround(r.longitude),Math.fround(r.latitude),0]:null,r.projectionMode){case kl.WEB_MERCATOR:(e===Tn.LNGLAT||e===Tn.CARTESIAN)&&(i=[0,0,0],s=!1);break;case kl.WEB_MERCATOR_AUTO_OFFSET:e===Tn.LNGLAT?n=i:e===Tn.CARTESIAN&&(n=[Math.fround(r.center[0]),Math.fround(r.center[1]),0],i=r.unprojectPosition(n),n[0]-=t[0],n[1]-=t[1],n[2]-=t[2]);break;case kl.IDENTITY:n=r.position.map(Math.fround),n[2]=n[2]||0;break;case kl.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:n,offsetMode:s}}function rj(r,e,t){const{viewMatrixUncentered:n,projectionMatrix:i}=r;let{viewMatrix:s,viewProjectionMatrix:a}=r,o=qT,A=qT,f=r.cameraPosition;const{geospatialOrigin:m,shaderCoordinateOrigin:v,offsetMode:x}=$T(r,e,t);return x&&(A=r.projectPosition(m||v),f=[f[0]-A[0],f[1]-A[1],f[2]-A[2]],A[3]=1,o=Zp([],A,a),s=n||s,a=Mh([],i,s),a=Mh([],a,ZV)),{viewMatrix:s,viewProjectionMatrix:a,projectionCenter:o,originCommon:A,cameraPosCommon:f,shaderCoordinateOrigin:v,geospatialOrigin:m}}function nj(r){let{viewport:e,devicePixelRatio:t=1,modelMatrix:n=null,coordinateSystem:i=Tn.DEFAULT,coordinateOrigin:s=WT,autoWrapLongitude:a=!1}=r;i===Tn.DEFAULT&&(i=e.isGeospatial?Tn.LNGLAT:Tn.CARTESIAN);const o=tj({viewport:e,devicePixelRatio:t,coordinateSystem:i,coordinateOrigin:s});return o.project_uWrapLongitude=a,o.project_uModelMatrix=n||KT,o}function ij(r){let{viewport:e,devicePixelRatio:t,coordinateSystem:n,coordinateOrigin:i}=r;const{projectionCenter:s,viewProjectionMatrix:a,originCommon:o,cameraPosCommon:A,shaderCoordinateOrigin:f,geospatialOrigin:m}=rj(e,n,i),v=e.getDistanceScales(),x=[e.width*t,e.height*t],B=Zp([],[0,0,-e.focalDistance,1],e.projectionMatrix)[3]||1,M={project_uCoordinateSystem:n,project_uProjectionMode:e.projectionMode,project_uCoordinateOrigin:f,project_uCommonOrigin:o.slice(0,3),project_uCenter:s,project_uPseudoMeters:!!e._pseudoMeters,project_uViewportSize:x,project_uDevicePixelRatio:t,project_uFocalDistance:B,project_uCommonUnitsPerMeter:v.unitsPerMeter,project_uCommonUnitsPerWorldUnit:v.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:ej,project_uScale:e.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:a,project_uModelMatrix:KT,project_uCameraPosition:A};if(m){const U=e.getDistanceScales(m);switch(n){case Tn.METER_OFFSETS:M.project_uCommonUnitsPerWorldUnit=U.unitsPerMeter,M.project_uCommonUnitsPerWorldUnit2=U.unitsPerMeter2;break;case Tn.LNGLAT:case Tn.LNGLAT_OFFSETS:e._pseudoMeters||(M.project_uCommonUnitsPerMeter=U.unitsPerMeter),M.project_uCommonUnitsPerWorldUnit=U.unitsPerDegree,M.project_uCommonUnitsPerWorldUnit2=U.unitsPerDegree2;break;case Tn.CARTESIAN:M.project_uCommonUnitsPerWorldUnit=[1,1,U.unitsPerMeter[2]],M.project_uCommonUnitsPerWorldUnit2=[0,0,U.unitsPerMeter2[2]];break}}return M}const sj={};function oj(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sj;return"viewport"in r?nj(r):{}}const xb={name:"project",dependencies:[M9,KV],vs:JV,getUniforms:oj};function aj(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Kd(r,e){const t=Zp([],e,r);return ST(t,t,1/t[3]),t}function XT(r,e){const t=r%e;return t<0?e+t:t}function Bb(r,e,t){return r<e?e:r>t?t:r}function cj(r){return Math.log(r)*Math.LOG2E}const Cb=Math.log2||cj;function Fu(r,e){if(!r)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Hc=Math.PI,JT=Hc/4,rc=Hc/180,Eb=180/Hc,Wd=512,T0=4003e4,I0=85.051129,lj=1.5;function uj(r){return Cb(r)}function sg(r){const[e,t]=r;Fu(Number.isFinite(e)),Fu(Number.isFinite(t)&&t>=-90&&t<=90,"invalid latitude");const n=e*rc,i=t*rc,s=Wd*(n+Hc)/(2*Hc),a=Wd*(Hc+Math.log(Math.tan(JT+i*.5)))/(2*Hc);return[s,a]}function $d(r){const[e,t]=r,n=e/Wd*(2*Hc)-Hc,i=2*(Math.atan(Math.exp(t/Wd*(2*Hc)-Hc))-JT);return[n*Eb,i*Eb]}function Aj(r){const{latitude:e}=r;Fu(Number.isFinite(e));const t=Math.cos(e*rc);return uj(T0*t)-9}function L0(r){const e=Math.cos(r*rc);return Wd/T0/e}function Sb(r){const{latitude:e,longitude:t,highPrecision:n=!1}=r;Fu(Number.isFinite(e)&&Number.isFinite(t));const i=Wd,s=Math.cos(e*rc),a=i/360,o=a/s,A=i/T0/s,f={unitsPerMeter:[A,A,A],metersPerUnit:[1/A,1/A,1/A],unitsPerDegree:[a,o,A],degreesPerUnit:[1/a,1/o,1/A]};if(n){const m=rc*Math.tan(e*rc)/s,v=a*m/2,x=i/T0*m,B=x/o*A;f.unitsPerDegree2=[0,v,x],f.unitsPerMeter2=[B,0,B]}return f}function YT(r,e){const[t,n,i]=r,[s,a,o]=e,{unitsPerMeter:A,unitsPerMeter2:f}=Sb({longitude:t,latitude:n,highPrecision:!0}),m=sg(r);m[0]+=s*(A[0]+f[0]*a),m[1]+=a*(A[1]+f[1]*a);const v=$d(m),x=(i||0)+(o||0);return Number.isFinite(i)||Number.isFinite(o)?[v[0],v[1],x]:v}function hj(r){const{height:e,pitch:t,bearing:n,altitude:i,scale:s,center:a}=r,o=aj();x0(o,o,[0,0,-i]),CT(o,o,-t*rc),ET(o,o,n*rc);const A=s/e;return fb(o,o,[A,A,A]),a&&x0(o,o,X9([],a)),o}function dj(r){const{width:e,height:t,altitude:n,pitch:i=0,offset:s,center:a,scale:o,nearZMultiplier:A=1,farZMultiplier:f=1}=r;let{fovy:m=F0(lj)}=r;n!==void 0&&(m=F0(n));const v=m*rc,x=i*rc,B=ZT(m);let M=B;a&&(M+=a[2]*o/Math.cos(x)/t);const U=v*(.5+(s?s[1]:0)/t),N=Math.sin(U)*M/Math.sin(Bb(Math.PI/2-x-U,.01,Math.PI-.01)),Q=Math.sin(x)*N+M,q=M*10,Y=Math.min(Q*f,q);return{fov:v,aspect:e/t,focalDistance:B,near:A,far:Y}}function F0(r){return 2*Math.atan(.5/r)*Eb}function ZT(r){return .5/Math.tan(.5*r*rc)}function e3(r,e){const[t,n,i=0]=r;return Fu(Number.isFinite(t)&&Number.isFinite(n)&&Number.isFinite(i)),Kd(e,[t,n,i,1])}function Tb(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const[n,i,s]=r;if(Fu(Number.isFinite(n)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return Kd(e,[n,i,s,1]);const a=Kd(e,[n,i,0,1]),o=Kd(e,[n,i,1,1]),A=a[2],f=o[2],m=A===f?0:((t||0)-A)/(f-A);return AT([],a,o,m)}function fj(r){const{width:e,height:t,bounds:n,minExtent:i=0,maxZoom:s=24,offset:a=[0,0]}=r,[[o,A],[f,m]]=n,v=pj(r.padding),x=sg([o,Bb(m,-I0,I0)]),B=sg([f,Bb(A,-I0,I0)]),M=[Math.max(Math.abs(B[0]-x[0]),i),Math.max(Math.abs(B[1]-x[1]),i)],U=[e-v.left-v.right-Math.abs(a[0])*2,t-v.top-v.bottom-Math.abs(a[1])*2];Fu(U[0]>0&&U[1]>0);const N=U[0]/M[0],Q=U[1]/M[1],q=(v.right-v.left)/2/N,Y=(v.top-v.bottom)/2/Q,te=[(B[0]+x[0])/2+q,(B[1]+x[1])/2+Y],pe=$d(te),ge=Math.min(s,Cb(Math.abs(Math.min(N,Q))));return Fu(Number.isFinite(ge)),{longitude:pe[0],latitude:pe[1],zoom:ge}}function pj(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return typeof r=="number"?{top:r,bottom:r,left:r,right:r}:(Fu(Number.isFinite(r.top)&&Number.isFinite(r.bottom)&&Number.isFinite(r.left)&&Number.isFinite(r.right)),r)}const t3=Math.PI/180;function gj(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const{width:t,height:n,unproject:i}=r,s={targetZ:e},a=i([0,n],s),o=i([t,n],s);let A,f;const m=r.fovy?.5*r.fovy*t3:Math.atan(.5/r.altitude),v=(90-r.pitch)*t3;return m>v-.01?(A=r3(r,0,e),f=r3(r,t,e)):(A=i([0,0],s),f=i([t,0],s)),[a,o,f,A]}function r3(r,e,t){const{pixelUnprojectionMatrix:n}=r,i=Kd(n,[e,0,1,1]),s=Kd(n,[e,r.height,1,1]),o=(t*r.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),A=AT([],i,s,o),f=$d(A);return f.push(t),f}const n3=512;function mj(r){const{width:e,height:t,pitch:n=0}=r;let{longitude:i,latitude:s,zoom:a,bearing:o=0}=r;(i<-180||i>180)&&(i=XT(i+180,360)-180),(o<-180||o>180)&&(o=XT(o+180,360)-180);const A=Cb(t/n3);if(a<=A)a=A,s=0;else{const f=t/2/Math.pow(2,a),m=$d([0,f])[1];if(s<m)s=m;else{const v=$d([0,n3-f])[1];s>v&&(s=v)}}return{width:e,height:t,longitude:i,latitude:s,zoom:a,pitch:n,bearing:o}}const yj=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,_j=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,vj=ig(Cj),bj=ig(Ej),wj=[0,0,0,1],xj=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function Bj(r,e){const[t,n,i]=r,s=Tb([t,n,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function Cj(r){let{viewport:e,center:t}=r;return new Bn(e.viewProjectionMatrix).invert().transform(t)}function Ej(r){let{viewport:e,shadowMatrices:t}=r;const n=[],i=e.pixelUnprojectionMatrix,s=e.isGeospatial?void 0:1,a=[[0,0,s],[e.width,0,s],[0,e.height,s],[e.width,e.height,s],[0,0,-1],[e.width,0,-1],[0,e.height,-1],[e.width,e.height,-1]].map(o=>Bj(o,i));for(const o of t){const A=o.clone().translate(new ut(e.center).negate()),f=a.map(v=>A.transform(v)),m=new Bn().ortho({left:Math.min(...f.map(v=>v[0])),right:Math.max(...f.map(v=>v[0])),bottom:Math.min(...f.map(v=>v[1])),top:Math.max(...f.map(v=>v[1])),near:Math.min(...f.map(v=>-v[2])),far:Math.max(...f.map(v=>-v[2]))});n.push(m.multiplyRight(o))}return n}function Sj(r,e){const{shadowEnabled:t=!0}=r;if(!t||!r.shadowMatrices||!r.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const n={shadow_uDrawShadowMap:!!r.drawToShadowMap,shadow_uUseShadowMap:r.shadowMaps?r.shadowMaps.length>0:!1,shadow_uColor:r.shadowColor||wj,shadow_uLightId:r.shadowLightId||0,shadow_uLightCount:r.shadowMatrices.length},i=vj({viewport:r.viewport,center:e.project_uCenter}),s=[],a=bj({shadowMatrices:r.shadowMatrices,viewport:r.viewport}).slice();for(let o=0;o<r.shadowMatrices.length;o++){const A=a[o],f=A.clone().translate(new ut(r.viewport.center).negate());e.project_uCoordinateSystem===Tn.LNGLAT&&e.project_uProjectionMode===kl.WEB_MERCATOR?(a[o]=f,s[o]=i):(a[o]=A.clone().multiplyRight(xj),s[o]=f.transform(i))}for(let o=0;o<a.length;o++)n["shadow_uViewProjectionMatrices[".concat(o,"]")]=a[o],n["shadow_uProjectCenters[".concat(o,"]")]=s[o],r.shadowMaps&&r.shadowMaps.length>0?n["shadow_uShadowMap".concat(o)]=r.shadowMaps[o]:n["shadow_uShadowMap".concat(o)]=r.dummyShadowMap;return n}const Ib={name:"shadow",dependencies:[xb],vs:yj,fs:_j,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"viewport"in r&&(r.drawToShadowMap||r.shadowMaps&&r.shadowMaps.length>0)?Sj(r,e):{}}},Tj={color:[255,255,255],intensity:1},i3=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Ij=[0,0,0,200/255];class Lb{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W(this,"id","lighting-effect"),W(this,"props",void 0),W(this,"shadowColor",Ij),W(this,"shadow",void 0),W(this,"ambientLight",void 0),W(this,"directionalLights",void 0),W(this,"pointLights",void 0),W(this,"shadowPasses",[]),W(this,"shadowMaps",[]),W(this,"dummyShadowMap",null),W(this,"programManager",void 0),W(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const t in e){const n=e[t];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow),this.props=e}preRender(e,t){let{layers:n,layerFilter:i,viewports:s,onViewportActive:a,views:o}=t;if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=rg.getDefaultProgramManager(e),Ib&&this.programManager.addDefaultModule(Ib)),this.dummyShadowMap||(this.dummyShadowMap=new Ia(e,{width:1,height:1}));for(let A=0;A<this.shadowPasses.length;A++)this.shadowPasses[A].render({layers:n,layerFilter:i,viewports:s,onViewportActive:a,views:o,moduleParameters:{shadowLightId:A,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(n=>n.getProjectedLight({layer:e})),pointLights:this.pointLights.map(n=>n.getProjectedLight({layer:e}))},t}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Ib),this.programManager=null)}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const n=new Bn().lookAt({eye:new ut(t.direction).negate()});e.push(n)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const n=new VV(e);this.shadowPasses[t]=n,this.shadowMaps[t]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:n}=this;!e&&t.length===0&&n.length===0&&(this.ambientLight=new zT(Tj),this.directionalLights.push(new GT(i3[0]),new GT(i3[1])))}}class Lj{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W(this,"_pool",[]),W(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,n){let{size:i=1,type:s,padding:a=0,copy:o=!1,initialize:A=!1,maxCount:f}=n;const m=s||e&&e.constructor||Float32Array,v=t*i+a;if(ArrayBuffer.isView(e)){if(v<=e.length)return e;if(v*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new m(e.buffer,0,v)}let x=1/0;f&&(x=f*i+a);const B=this._allocate(m,v,A,x);return e&&o?B.set(e):A||B.fill(0,0,4),this._release(e),B}release(e){this._release(e)}_allocate(e,t,n,i){let s=Math.max(Math.ceil(t*this.opts.overAlloc),1);s>i&&(s=i);const a=this._pool,o=e.BYTES_PER_ELEMENT*s,A=a.findIndex(f=>f.byteLength>=o);if(A>=0){const f=new e(a.splice(A,1)[0],0,s);return n&&f.fill(0),f}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:n}=e,{byteLength:i}=n,s=t.findIndex(a=>a.byteLength>=i);s<0?t.push(n):(s>0||t.length<this.opts.poolSize)&&t.splice(s,0,n),t.length>this.opts.poolSize&&t.shift()}}const og=new Lj;function ag(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Fj(r){return[r[12],r[13],r[14]]}function Mj(r){return{left:Xd(r[3]+r[0],r[7]+r[4],r[11]+r[8],r[15]+r[12]),right:Xd(r[3]-r[0],r[7]-r[4],r[11]-r[8],r[15]-r[12]),bottom:Xd(r[3]+r[1],r[7]+r[5],r[11]+r[9],r[15]+r[13]),top:Xd(r[3]-r[1],r[7]-r[5],r[11]-r[9],r[15]-r[13]),near:Xd(r[3]+r[2],r[7]+r[6],r[11]+r[10],r[15]+r[14]),far:Xd(r[3]-r[2],r[7]-r[6],r[11]-r[10],r[15]-r[14])}}const s3=new ut;function Xd(r,e,t,n){s3.set(r,e,t);const i=s3.len();return{distance:n/i,normal:new ut(-r/i,-e/i,-t/i)}}function Pj(r){return r-Math.fround(r)}let cg;function Fb(r,e){const{size:t=1,startIndex:n=0}=e,i=e.endIndex!==void 0?e.endIndex:r.length,s=(i-n)/t;cg=og.allocate(cg,s,{type:Float32Array,size:t*2});let a=n,o=0;for(;a<i;){for(let A=0;A<t;A++){const f=r[a++];cg[o+A]=f,cg[o+A+t]=Pj(f)}o+=t*2}return cg.subarray(0,s*t*2)}function Uj(r){let e=null,t=!1;for(const n of r)n&&(e?(t||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],t=!0),e[0][0]=Math.min(e[0][0],n[0][0]),e[0][1]=Math.min(e[0][1],n[0][1]),e[1][0]=Math.max(e[1][0],n[1][0]),e[1][1]=Math.max(e[1][1],n[1][1])):e=n);return e}const Rj=Math.PI/180,Oj=ag(),o3=[0,0,0],Dj={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function kj(r){let{width:e,height:t,orthographic:n,fovyRadians:i,focalDistance:s,padding:a,near:o,far:A}=r;const f=e/t,m=n?new Bn().orthographic({fovy:i,aspect:f,focalDistance:s,near:o,far:A}):new Bn().perspective({fovy:i,aspect:f,near:o,far:A});if(a){const{left:v=0,right:x=0,top:B=0,bottom:M=0}=a,U=Lu((v+e-x)/2,0,e)-e/2,N=Lu((B+t-M)/2,0,t)-t/2;m[8]-=U*2/e,m[9]+=N*2/t}return m}class Jd{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W(this,"id",void 0),W(this,"x",void 0),W(this,"y",void 0),W(this,"width",void 0),W(this,"height",void 0),W(this,"padding",void 0),W(this,"isGeospatial",void 0),W(this,"zoom",void 0),W(this,"focalDistance",void 0),W(this,"position",void 0),W(this,"modelMatrix",void 0),W(this,"distanceScales",void 0),W(this,"scale",void 0),W(this,"center",void 0),W(this,"cameraPosition",void 0),W(this,"projectionMatrix",void 0),W(this,"viewMatrix",void 0),W(this,"viewMatrixUncentered",void 0),W(this,"viewMatrixInverse",void 0),W(this,"viewProjectionMatrix",void 0),W(this,"pixelProjectionMatrix",void 0),W(this,"pixelUnprojectionMatrix",void 0),W(this,"resolution",void 0),W(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||Dj,this.focalDistance=e.focalDistance||1,this.position=e.position||o3,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:n}=e;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?kl.WEB_MERCATOR:kl.WEB_MERCATOR_AUTO_OFFSET:kl.IDENTITY}equals(e){return e instanceof Jd?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Nc(e.projectionMatrix,this.projectionMatrix)&&Nc(e.viewMatrix,this.viewMatrix):!1}project(e){let{topLeft:t=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=this.projectPosition(e),i=e3(n,this.pixelProjectionMatrix),[s,a]=i,o=t?a:this.height-a;return e.length===2?[s,o]:[s,o,i[2]]}unproject(e){let{topLeft:t=!0,targetZ:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const[i,s,a]=e,o=t?s:this.height-s,A=n&&n*this.distanceScales.unitsPerMeter[2],f=Tb([i,o,a],this.pixelUnprojectionMatrix,A),[m,v,x]=this.unprojectPosition(f);return Number.isFinite(a)?[m,v,x]:Number.isFinite(n)?[m,v,n]:[m,v]}projectPosition(e){const[t,n]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[t,n,i]}unprojectPosition(e){const[t,n]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[t,n,i]}projectFlat(e){if(this.isGeospatial){const t=sg(e);return t[1]=Lu(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?$d(e):e}getBounds(){const t={targetZ:(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).z||0},n=this.unproject([0,0],t),i=this.unproject([this.width,0],t),s=this.unproject([0,this.height],t),a=this.unproject([this.width,this.height],t);return[Math.min(n[0],i[0],s[0],a[0]),Math.min(n[1],i[1],s[1],a[1]),Math.max(n[0],i[0],s[0],a[0]),Math.max(n[1],i[1],s[1],a[1])]}getDistanceScales(e){return e?Sb({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel(e){let{x:t,y:n,width:i=1,height:s=1}=e;return t<this.x+this.width&&this.x<t+i&&n<this.y+this.height&&this.y<n+s}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,Mj(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,t){return null}_initProps(e){const t=e.longitude,n=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=Aj({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||Sb({latitude:n,longitude:t}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:a}=e;let o=o3;if(s&&(o=a?new Bn(a).transformAsVector(s,[]):s),this.isGeospatial){const A=this.projectPosition([t,n,0]);this.center=new ut(o).scale(this.distanceScales.unitsPerMeter).add(A)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:t=Oj,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:s,fovy:a=75,near:o=.1,far:A=1e3,padding:f=null,focalDistance:m=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=new Bn().multiplyRight(t).translate(new ut(this.center).negate()),this.projectionMatrix=n||kj({width:this.width,height:this.height,orthographic:i,fovyRadians:s||a*Rj,focalDistance:m,padding:f,near:o,far:A});const v=ag();Mh(v,v,this.projectionMatrix),Mh(v,v,this.viewMatrix),this.viewProjectionMatrix=v,this.viewMatrixInverse=db([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=Fj(this.viewMatrixInverse);const x=ag(),B=ag();fb(x,x,[this.width/2,-this.height/2,1]),x0(x,x,[1,-1,0]),Mh(B,x,this.viewProjectionMatrix),this.pixelProjectionMatrix=B,this.pixelUnprojectionMatrix=db(ag(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Mn.warn("Pixel project matrix not invertible")()}}W(Jd,"displayName","Viewport");class Ph extends Jd{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{latitude:t=0,longitude:n=0,zoom:i=0,pitch:s=0,bearing:a=0,nearZMultiplier:o=.1,farZMultiplier:A=1.01,nearZ:f,farZ:m,orthographic:v=!1,projectionMatrix:x,repeat:B=!1,worldOffset:M=0,position:U,padding:N,legacyMeterSizes:Q=!1}=e;let{width:q,height:Y,altitude:te=1.5}=e;const pe=Math.pow(2,i);q=q||1,Y=Y||1;let ge,ye=null;if(x)te=x[5]/2,ge=F0(te);else{e.fovy?(ge=e.fovy,te=ZT(ge)):ge=F0(te);let Oe;if(N){const{top:Fe=0,bottom:oe=0}=N;Oe=[0,Lu((Fe+Y-oe)/2,0,Y)-Y/2]}ye=dj({width:q,height:Y,scale:pe,center:U&&[0,0,U[2]*L0(t)],offset:Oe,pitch:s,fovy:ge,nearZMultiplier:o,farZMultiplier:A}),Number.isFinite(f)&&(ye.near=f),Number.isFinite(m)&&(ye.far=m)}let fe=hj({height:Y,pitch:s,bearing:a,scale:pe,altitude:te});M&&(fe=new Bn().translate([512*M,0,0]).multiplyLeft(fe)),super({...e,width:q,height:Y,viewMatrix:fe,longitude:n,latitude:t,zoom:i,...ye,fovy:ge,focalDistance:te}),W(this,"longitude",void 0),W(this,"latitude",void 0),W(this,"pitch",void 0),W(this,"bearing",void 0),W(this,"altitude",void 0),W(this,"fovy",void 0),W(this,"orthographic",void 0),W(this,"_subViewports",void 0),W(this,"_pseudoMeters",void 0),this.latitude=t,this.longitude=n,this.zoom=i,this.pitch=s,this.bearing=a,this.altitude=te,this.fovy=ge,this.orthographic=v,this._subViewports=B?[]:null,this._pseudoMeters=Q,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),n=Math.ceil((e[2]-180)/360);for(let i=t;i<=n;i++){const s=i?new Ph({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,n]=this.projectFlat(e),i=(e[2]||0)*L0(e[1]);return[t,n,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,n]=this.unprojectFlat(e),i=(e[2]||0)/L0(n);return[t,n,i]}addMetersToLngLat(e,t){return YT(e,t)}panByPosition(e,t){const n=Tb(t,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=uT([],i,V9([],n)),a=uT([],this.center,s),[o,A]=this.unprojectFlat(a);return{longitude:o,latitude:A}}getBounds(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=gj(this,e.z||0);return[Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),Math.min(t[0][1],t[1][1],t[2][1],t[3][1]),Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),Math.max(t[0][1],t[1][1],t[2][1],t[3][1])]}fitBounds(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{width:n,height:i}=this,{longitude:s,latitude:a,zoom:o}=fj({width:n,height:i,bounds:e,...t});return new Ph({width:n,height:i,longitude:s,latitude:a,zoom:o})}}W(Ph,"displayName","WebMercatorViewport");const a3=[0,0,0];function Mb(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const n=e.projectPosition(r);if(t&&e instanceof Ph){const[i,s,a=0]=r,o=e.getDistanceScales([i,s]);n[2]=a*o.unitsPerMeter[2]}return n}function Nj(r){const{viewport:e,modelMatrix:t,coordinateOrigin:n}=r;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:a}=r;return i===Tn.DEFAULT&&(i=e.isGeospatial?Tn.LNGLAT:Tn.CARTESIAN),s===void 0&&(s=i),a===void 0&&(a=n),{viewport:e,coordinateSystem:i,coordinateOrigin:n,modelMatrix:t,fromCoordinateSystem:s,fromCoordinateOrigin:a}}function c3(r,e){let{viewport:t,modelMatrix:n,coordinateSystem:i,coordinateOrigin:s,offsetMode:a}=e,[o,A,f=0]=r;switch(n&&([o,A,f]=Zp([],[o,A,f,1],n)),i){case Tn.LNGLAT:return Mb([o,A,f],t,a);case Tn.LNGLAT_OFFSETS:return Mb([o+s[0],A+s[1],f+(s[2]||0)],t,a);case Tn.METER_OFFSETS:return Mb(YT(s,[o,A,f]),t,a);case Tn.CARTESIAN:default:return t.isGeospatial?[o+s[0],A+s[1],f+s[2]]:t.projectPosition([o,A,f])}}function Qj(r,e){const{viewport:t,coordinateSystem:n,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:a,fromCoordinateOrigin:o}=Nj(e),{autoOffset:A=!0}=e,{geospatialOrigin:f=a3,shaderCoordinateOrigin:m=a3,offsetMode:v=!1}=A?$T(t,n,i):{},x=c3(r,{viewport:t,modelMatrix:s,coordinateSystem:a,coordinateOrigin:o,offsetMode:v});if(v){const B=t.projectPosition(f||m);rG(x,x,B)}return x}const l3={blendFunc:[1,0,32771,0],blendEquation:32774};class u3 extends wb{constructor(){super(...arguments),W(this,"pickZ",void 0),W(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer(e){let{layers:t,layerFilter:n,views:i,viewports:s,onViewportActive:a,pickingFBO:o,deviceRect:{x:A,y:f,width:m,height:v},cullRect:x,effects:B,pass:M="picking",pickZ:U,moduleParameters:N}=e;const Q=this.gl;this.pickZ=U;const q=this._resetColorEncoder(U),Y=Dc(Q,{scissorTest:!0,scissor:[A,f,m,v],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...l3,blend:!U},()=>super.render({target:o,layers:t,layerFilter:n,views:i,viewports:s,onViewportActive:a,cullRect:x,effects:B==null?void 0:B.filter(pe=>pe.useInPicking),pass:M,isPicking:!0,moduleParameters:N}));return this._colorEncoderState=null,{decodePickingColor:q&&zj.bind(null,q),stats:Y}}shouldDrawLayer(e){const{pickable:t,operation:n}=e.props;return t&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,t,n){const i={...e.props.parameters},{pickable:s,operation:a}=e.props;return this._colorEncoderState?s&&a.includes("draw")&&(Object.assign(i,l3),i.blend=!0,i.blendColor=Hj(this._colorEncoderState,e,n)):i.blend=!1,a.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function Hj(r,e,t){const{byLayer:n,byAlpha:i}=r;let s,a=n.get(e);return a?(a.viewports.push(t),s=a.a):(s=n.size+1,s<=255?(a={a:s,layer:e,viewports:[t]},n.set(e,a),i[s]=a):(Mn.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function zj(r,e){const t=r.byAlpha[e[3]];return t&&{pickedLayer:t.layer,pickedViewports:t.viewports,pickedObjectIndex:t.layer.decodePickingColor(e)}}const Yd={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},M0=Symbol.for("component"),TA=Symbol.for("propTypes"),Pb=Symbol.for("deprecatedProps"),Zd=Symbol.for("asyncPropDefaults"),Uh=Symbol.for("asyncPropOriginal"),IA=Symbol.for("asyncPropResolved");function P0(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return Array.isArray(r)?A3(r,e,[]):e(r)?[r]:[]}function A3(r,e,t){let n=-1;for(;++n<r.length;){const i=r[n];Array.isArray(i)?A3(i,e,t):e(i)&&t.push(i)}return t}function Gj(r){let{target:e,source:t,start:n=0,count:i=1}=r;const s=t.length,a=i*s;let o=0;for(let A=n;o<s;o++)e[A++]=t[o];for(;o<a;)o<a-o?(e.copyWithin(n+o,n,n+o),o*=2):(e.copyWithin(n+o,n,n+a-o),o=a);return e}class Vj{constructor(e,t,n){W(this,"id",void 0),W(this,"context",void 0),W(this,"isLoaded",void 0),W(this,"persistent",void 0),W(this,"_loadCount",0),W(this,"_subscribers",new Set),W(this,"_data",void 0),W(this,"_loader",void 0),W(this,"_error",void 0),W(this,"_content",void 0),this.id=e,this.context=n,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const n=++this._loadCount;let i=e;typeof e=="string"&&(i=wA(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===n&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class jj{constructor(e){let{gl:t,protocol:n}=e;W(this,"protocol",void 0),W(this,"_context",void 0),W(this,"_resources",void 0),W(this,"_consumers",void 0),W(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:t,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add(e){let{resourceId:t,data:n,forceUpdate:i=!1,persistent:s=!0}=e,a=this._resources[t];a?a.setData(n,i):(a=new Vj(t,n,this._context),this._resources[t]=a),a.persistent=s}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe(e){let{consumerId:t}=e;const n=this._consumers[t];if(n){for(const i in n){const s=n[i],a=this._resources[s.resourceId];a&&a.unsubscribe(s)}delete this._consumers[t],this.prune()}}subscribe(e){let{resourceId:t,onChange:n,consumerId:i,requestId:s="default"}=e;const{_resources:a,protocol:o}=this;t.startsWith(o)&&(t=t.replace(o,""),a[t]||this.add({resourceId:t,data:null,persistent:!1}));const A=a[t];if(this._track(i,s,A,n),A)return A.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,n,i){const s=this._consumers,a=s[e]=s[e]||{},o=a[t]||{},A=o.resourceId&&this._resources[o.resourceId];A&&(A.unsubscribe(o),this.prune()),n&&(a[t]=o,o.onChange=i,o.resourceId=n.id,n.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const Ub={name:"project32",dependencies:[xb],vs:`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`},Rb={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...oV},qj=[xb],Kj=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function Wj(r){const e=rg.getDefaultProgramManager(r);for(const t of qj)e.addDefaultModule(t);for(const t of Kj)e.addShaderHook(t);return e}const $j="layerManager.setLayers",Xj="layerManager.activateViewport";class Jj{constructor(e){let{deck:t,stats:n,viewport:i,timeline:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};W(this,"layers",void 0),W(this,"context",void 0),W(this,"resourceManager",void 0),W(this,"_lastRenderedLayers",[]),W(this,"_needsRedraw",!1),W(this,"_needsUpdate",!1),W(this,"_nextLayers",null),W(this,"_debug",!1),W(this,"activateViewport",a=>{ao(Xj,this,a),a&&(this.context.viewport=a)}),this.layers=[],this.resourceManager=new jj({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:t,programManager:e&&Wj(e),stats:n||new Ov({id:"deck.gl"}),viewport:i||new Jd({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new HT,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1},t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(e);t=t||i}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers(){let{layerIds:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e?this.layers.filter(t=>e.find(n=>t.id.indexOf(n)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){ao($j,this,t,e),this._lastRenderedLayers=e;const n=P0(e,Boolean);for(const i of n)i.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,t,n){n.raiseError(t,"".concat(e," of ").concat(n))}_updateLayers(e,t){const n={};for(const a of e)n[a.id]?Mn.warn("Multiple old layers with same id ".concat(a.id))():n[a.id]=a;const i=[];this._updateSublayersRecursively(t,n,i),this._finalizeOldLayers(n);let s=!1;for(const a of i)if(a.hasUniformTransition()){s="Uniform transition in ".concat(a);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,t,n){for(const i of e){i.context=this.context;const s=t[i.id];s===null&&Mn.warn("Multiple new layers with same id ".concat(i.id))(),t[i.id]=null;let a=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),a=i.isComposite?i.getSubLayers():null}catch(o){this._handleError("matching",o,i)}a&&this._updateSublayersRecursively(a,t,n)}}_finalizeOldLayers(e){for(const t in e){const n=e[t];n&&this._finalizeLayer(n)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Yd.INITIALIZED}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle=Yd.MATCHED,t!==e&&(e.lifecycle=Yd.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Yd.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Yd.FINALIZED}catch(t){this._handleError("finalization",t,e)}}}function Ql(r,e,t){if(r===e)return!0;if(!t||!r||!e)return!1;if(Array.isArray(r)){if(!Array.isArray(e)||r.length!==e.length)return!1;for(let n=0;n<r.length;n++)if(!Ql(r[n],e[n],t-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof r=="object"&&typeof e=="object"){const n=Object.keys(r),i=Object.keys(e);if(n.length!==i.length)return!1;for(const s of n)if(!e.hasOwnProperty(s)||!Ql(r[s],e[s],t-1))return!1;return!0}return!1}class Yj{constructor(e){W(this,"width",void 0),W(this,"height",void 0),W(this,"views",void 0),W(this,"viewState",void 0),W(this,"controllers",void 0),W(this,"timeline",void 0),W(this,"_viewports",void 0),W(this,"_viewportMap",void 0),W(this,"_isUpdating",void 0),W(this,"_needsRedraw",void 0),W(this,"_needsUpdate",void 0),W(this,"_eventManager",void 0),W(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return this.views.find(t=>t.id===e)}getViewState(e){const t=typeof e=="string"?this.getView(e):e,n=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(n):n}getViewport(e){return this._viewportMap[e]}unproject(e,t){const n=this.getViewports(),i={x:e[0],y:e[1]};for(let s=n.length-1;s>=0;--s){const a=n[s];if(a.containsPixel(i)){const o=e.slice();return o[0]-=a.x,o[1]-=a.y,a.unproject(o,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=P0(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Ql(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Mn.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,t){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...t,viewId:e})}_createController(e,t){const n=t.type;return new n({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var a;return(a=this.getView(e.id))===null||a===void 0?void 0:a.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,t,n,i){const s=e.controller;if(s&&n){const a={...t,...s,id:e.id,x:n.x,y:n.y,width:n.width,height:n.height};return(!i||i.constructor!==s.type)&&(i=this._createController(e,a)),i&&i.setProps(a),i}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=e.length;i--;){const s=e[i],a=this.getViewState(s),o=s.makeViewport({viewState:a,width:this.width,height:this.height});let A=t[s.id];const f=!!s.controller;f&&!A&&(n=!0),(n||!f)&&A&&(A.finalize(),A=null),this.controllers[s.id]=this._updateController(s,a,o,A),o&&this._viewports.unshift(o)}for(const i in t){const s=t[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length?!0:e.some((n,i)=>!e[i].equals(t[i]))}}const Zj=/([0-9]+\.?[0-9]*)(%|px)/;function LA(r){switch(typeof r){case"number":return{position:r,relative:!1};case"string":const e=Zj.exec(r);if(e&&e.length>=3){const t=e[2]==="%",n=parseFloat(e[1]);return{position:t?n/100:n,relative:t}}default:throw new Error("Could not parse position string ".concat(r))}}function FA(r,e){return r.relative?Math.round(r.position*e):r.position}function Ks(r,e){if(!r)throw new Error(e||"deck.gl: assertion failed.")}class eq{constructor(e){W(this,"id",void 0),W(this,"viewportInstance",void 0),W(this,"_x",void 0),W(this,"_y",void 0),W(this,"_width",void 0),W(this,"_height",void 0),W(this,"_padding",void 0),W(this,"props",void 0);const{id:t,x:n=0,y:i=0,width:s="100%",height:a="100%",padding:o=null,viewportInstance:A}=e||{};Ks(!A||A instanceof Jd),this.viewportInstance=A,this.id=t||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=LA(n),this._y=LA(i),this._width=LA(s),this._height=LA(a),this._padding=o&&{left:LA(o.left||0),right:LA(o.right||0),top:LA(o.top||0),bottom:LA(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&Ql(this.props,e.props,2)}makeViewport(e){let{width:t,height:n,viewState:i}=e;if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const s=this.getDimensions({width:t,height:n});return!s.height||!s.width?null:new this.ViewportType({...i,...this.props,...s})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const t={...e};for(const n in this.props.viewState)n!=="id"&&(t[n]=this.props.viewState[n]);return t}return e}getDimensions(e){let{width:t,height:n}=e;const i={x:FA(this._x,t),y:FA(this._y,n),width:FA(this._width,t),height:FA(this._height,n)};return this._padding&&(i.padding={left:FA(this._padding.left,t),top:FA(this._padding.top,n),right:FA(this._padding.right,t),bottom:FA(this._padding.bottom,n)}),i}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class lg{constructor(e){W(this,"_inProgress",void 0),W(this,"_handle",void 0),W(this,"_timeline",void 0),W(this,"time",void 0),W(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var t,n;this.cancel(),this.settings=e,this._inProgress=!0,(t=(n=this.settings).onStart)===null||t===void 0||t.call(n,this)}end(){if(this._inProgress){var e,t;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(t=this.settings).onEnd)===null||e===void 0||e.call(t,this)}}cancel(){if(this._inProgress){var e,t;(e=(t=this.settings).onInterrupt)===null||e===void 0||e.call(t,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,t;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:n,settings:i}=this;this._handle=n.addChannel({delay:n.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(t=this.settings).onUpdate)===null||e===void 0||e.call(t,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const h3=()=>{},Ob={BREAK:1,SNAP_TO_END:2,IGNORE:3},tq=r=>r,rq=Ob.BREAK;class nq{constructor(e){W(this,"getControllerState",void 0),W(this,"props",void 0),W(this,"propsInTransition",void 0),W(this,"transition",void 0),W(this,"onViewStateChange",void 0),W(this,"onStateChange",void 0),W(this,"_onTransitionUpdate",t=>{const{time:n,settings:{interpolator:i,startProps:s,endProps:a,duration:o,easing:A}}=t,f=A(n/o),m=i.interpolateProps(s,a,f);this.propsInTransition=this.getControllerState({...this.props,...m}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new lg(e.timeline),this.onViewStateChange=e.onViewStateChange||h3,this.onStateChange=e.onStateChange||h3}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const n=this.props;if(this.props=e,!n||this._shouldIgnoreViewportChange(n,e))return!1;if(this._isTransitionEnabled(e)){let i=n;if(this.transition.inProgress){const{interruption:s,endProps:a}=this.transition.settings;i={...n,...s===Ob.SNAP_TO_END?a:this.propsInTransition||n}}this._triggerTransition(i,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:n}=e;return(t>0||t==="auto")&&!!n}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?this.transition.settings.interruption===Ob.IGNORE||this._isUpdateDueToCurrentTransition(t):this._isTransitionEnabled(t)?t.transitionInterpolator.arePropsEqual(e,t):!0}_triggerTransition(e,t){const n=this.getControllerState(e),i=this.getControllerState(t).shortestPathFrom(n),s=t.transitionInterpolator,a=s.getDuration?s.getDuration(e,t):t.transitionDuration;if(a===0)return;const o=s.initializeProps(e,i);this.propsInTransition={};const A={duration:a,easing:t.transitionEasing||tq,interpolator:s,interruption:t.transitionInterruption||rq,startProps:o.start,endProps:o.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(A),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(t)}}}class iq{constructor(e){W(this,"_propsToCompare",void 0),W(this,"_propsToExtract",void 0),W(this,"_requiredProps",void 0);const{compare:t,extract:n,required:i}=e;this._propsToCompare=t,this._propsToExtract=n||t,this._requiredProps=i}arePropsEqual(e,t){for(const n of this._propsToCompare)if(!(n in e)||!(n in t)||!Nc(e[n],t[n]))return!1;return!0}initializeProps(e,t){const n={},i={};for(const s of this._propsToExtract)(s in e||s in t)&&(n[s]=e[s],i[s]=t[s]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(t=>{const n=e[t];Ks(Number.isFinite(n)||Array.isArray(n),"".concat(t," is required for transition"))})}}const sq=["longitude","latitude","zoom","bearing","pitch"],oq=["longitude","latitude","zoom"];class d3 extends iq{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=Array.isArray(e)?e:e.transitionProps,n=Array.isArray(e)?{}:e;n.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:sq,required:oq},super(n.transitionProps),W(this,"opts",void 0),this.opts=n}initializeProps(e,t){const n=super.initializeProps(e,t),{makeViewport:i,around:s}=this.opts;if(i&&s){const a=i(e),o=i(t),A=a.unproject(s);n.start.around=s,Object.assign(n.end,{around:o.project(A),aroundPosition:A,width:t.width,height:t.height})}return n}interpolateProps(e,t,n){const i={};for(const s of this._propsToExtract)i[s]=m0(e[s]||0,t[s]||0,n);if(t.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...t,...i});Object.assign(i,s.panByPosition(t.aroundPosition,m0(e.around,t.around,n)))}return i}}const MA={transitionDuration:0},aq=300,U0=r=>1-(1-r)*(1-r),ef={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Rh={};class cq{constructor(e){W(this,"props",void 0),W(this,"state",{}),W(this,"transitionManager",void 0),W(this,"eventManager",void 0),W(this,"onViewStateChange",void 0),W(this,"onStateChange",void 0),W(this,"makeViewport",void 0),W(this,"_controllerState",void 0),W(this,"_events",{}),W(this,"_interactionState",{isDragging:!1}),W(this,"_customEvents",[]),W(this,"_eventStartBlocked",null),W(this,"_panMove",!1),W(this,"invertPan",!1),W(this,"dragMode","rotate"),W(this,"inertia",0),W(this,"scrollZoom",!0),W(this,"dragPan",!0),W(this,"dragRotate",!0),W(this,"doubleClickZoom",!0),W(this,"touchZoom",!0),W(this,"touchRotate",!1),W(this,"keyboard",!0),this.transitionManager=new nq({...e,getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const t in this._events)if(this._events[t]){var e;(e=this.eventManager)===null||e===void 0||e.off(t,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return t?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return t?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return t?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:t,y:n}=this.props,{offsetCenter:i}=e;return[i.x-t,i.y-n]}isPointInBounds(e,t){const{width:n,height:i}=this.props;if(t&&t.handled)return!1;const s=e[0]>=0&&e[0]<=n&&e[1]>=0&&e[1]<=i;return s&&t&&t.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:t}=e;return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:t===!0?aq:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:a=!0,touchZoom:o=!0,touchRotate:A=!1,keyboard:f=!0}=e,m=!!this.onViewStateChange;this.toggleEvents(ef.WHEEL,m&&n),this.toggleEvents(ef.PAN,m),this.toggleEvents(ef.PINCH,m&&(o||A)),this.toggleEvents(ef.TRIPLE_PAN,m&&A),this.toggleEvents(ef.DOUBLE_TAP,m&&a),this.toggleEvents(ef.KEYBOARD,m&&f),this.scrollZoom=n,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=a,this.touchZoom=o,this.touchRotate=A,this.keyboard=f}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(n=>{this._events[n]!==t&&(this._events[n]=t,t?this.eventManager.on(n,this.handleEvent):this.eventManager.off(n,this.handleEvent))})}updateViewport(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i={...e.getViewportProps(),...t},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(n),s){const a=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:a})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let n=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:t});return this._panMove=n,this.updateViewport(i,MA,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),n=this.controllerState.pan({pos:t});return this.updateViewport(n,MA,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const n=this.getCenter(e),i=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:U0},{isDragging:!1,isPanning:!0})}else{const n=this.controllerState.panEnd();this.updateViewport(n,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),n=this.controllerState.rotate({pos:t});return this.updateViewport(n,MA,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const n=this.getCenter(e),i=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:U0},{isDragging:!1,isRotating:!0})}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;e.srcEvent.preventDefault();const{speed:n=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let a=2/(1+Math.exp(-Math.abs(s*n)));s<0&&a!==0&&(a=1/a);const o=this.controllerState.zoom({pos:t,scale:a});return this.updateViewport(o,{...this._getTransitionProps({around:t}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.rotateStart({pos:t});return this.updateViewport(n,MA,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const n=this.controllerState.rotate({pos:t});return this.updateViewport(n,MA,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const n=this.getCenter(e),i=[n[0],n[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:U0},{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return Rh._startPinchRotation=e.rotation,Rh._lastPinchEvent=e,this.updateViewport(n,MA,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:n}=e,i=this.getCenter(e);t=t.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=e;t=t.rotate({deltaAngleX:Rh._startPinchRotation-n})}return this.updateViewport(t,MA,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Rh._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:n}=Rh;if(this.touchZoom&&t&&n&&e.scale!==n.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const a=Math.log2(e.scale),o=(a-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),A=Math.pow(2,a+o*t/2);s=s.zoom({pos:i,scale:A}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:t,transitionEasing:U0},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Rh._startPinchRotation=null,Rh._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:t,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:a}=this.keyboard===!0?{}:this.keyboard,{controllerState:o}=this;let A;const f={};switch(e.srcEvent.code){case"Minus":A=t?o.zoomOut(n).zoomOut(n):o.zoomOut(n),f.isZooming=!0;break;case"Equal":A=t?o.zoomIn(n).zoomIn(n):o.zoomIn(n),f.isZooming=!0;break;case"ArrowLeft":t?(A=o.rotateLeft(s),f.isRotating=!0):(A=o.moveLeft(i),f.isPanning=!0);break;case"ArrowRight":t?(A=o.rotateRight(s),f.isRotating=!0):(A=o.moveRight(i),f.isPanning=!0);break;case"ArrowUp":t?(A=o.rotateUp(a),f.isRotating=!0):(A=o.moveUp(i),f.isPanning=!0);break;case"ArrowDown":t?(A=o.rotateDown(a),f.isRotating=!0):(A=o.moveDown(i),f.isPanning=!0);break;default:return!1}return this.updateViewport(A,this._getTransitionProps(),f),!0}_getTransitionProps(e){const{transition:t}=this;return!t||!t.transitionInterpolator?MA:e?{...t,transitionInterpolator:new d3({...e,...t.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:t}}class lq{constructor(e,t){W(this,"_viewportProps",void 0),W(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}const f3=5,uq=1.2;class Aq extends lq{constructor(e){const{width:t,height:n,latitude:i,longitude:s,zoom:a,bearing:o=0,pitch:A=0,altitude:f=1.5,position:m=[0,0,0],maxZoom:v=20,minZoom:x=0,maxPitch:B=60,minPitch:M=0,startPanLngLat:U,startZoomLngLat:N,startRotatePos:Q,startBearing:q,startPitch:Y,startZoom:te,normalize:pe=!0}=e;Ks(Number.isFinite(s)),Ks(Number.isFinite(i)),Ks(Number.isFinite(a)),super({width:t,height:n,latitude:i,longitude:s,zoom:a,bearing:o,pitch:A,altitude:f,maxZoom:v,minZoom:x,maxPitch:B,minPitch:M,normalize:pe,position:m},{startPanLngLat:U,startZoomLngLat:N,startRotatePos:Q,startBearing:q,startPitch:Y,startZoom:te}),W(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart(e){let{pos:t}=e;return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan(e){let{pos:t,startPos:n}=e;const i=this.getState().startPanLngLat||this._unproject(n);if(!i)return this;const a=this.makeViewport(this.getViewportProps()).panByPosition(i,t);return this._getUpdatedState(a)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart(e){let{pos:t}=e;return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate(e){let{pos:t,deltaAngleX:n=0,deltaAngleY:i=0}=e;const{startRotatePos:s,startBearing:a,startPitch:o}=this.getState();if(!s||a===void 0||o===void 0)return this;let A;return t?A=this._getNewRotation(t,s,o,a):A={bearing:a+n,pitch:o+i},this._getUpdatedState(A)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart(e){let{pos:t}=e;return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom(e){let{pos:t,startPos:n,scale:i}=e,{startZoom:s,startZoomLngLat:a}=this.getState();if(a||(s=this.getViewportProps().zoom,a=this._unproject(n)||this._unproject(t)),!a)return this;const{maxZoom:o,minZoom:A}=this.getViewportProps();let f=s+Math.log2(i);f=Lu(f,A,o);const m=this.makeViewport({...this.getViewportProps(),zoom:f});return this._getUpdatedState({zoom:f,...m.panByPosition(a,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2;return this._zoomFromCenter(e)}zoomOut(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2;return this._zoomFromCenter(1/e)}moveLeft(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return this._panFromCenter([e,0])}moveRight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return this._panFromCenter([-e,0])}moveUp(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return this._panFromCenter([0,e])}moveDown(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return this._panFromCenter([0,-e])}rotateLeft(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:s}=n;return Math.abs(i-t.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(s-t.longitude)>180&&(n.longitude=s<0?s+360:s-360),n}applyConstraints(e){const{maxZoom:t,minZoom:n,zoom:i}=e;e.zoom=Lu(i,n,t);const{maxPitch:s,minPitch:a,pitch:o}=e;e.pitch=Lu(o,a,s);const{normalize:A=!0}=e;return A&&Object.assign(e,mj(e)),e}_zoomFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.zoom({pos:[t/2,n/2],scale:e})}_panFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.pan({startPos:[t/2,n/2],pos:[t/2+e[0],n/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,n,i){const s=e[0]-t[0],a=e[1]-t[1],o=e[1],A=t[1],{width:f,height:m}=this.getViewportProps(),v=s/f;let x=0;a>0?Math.abs(m-A)>f3&&(x=a/(A-m)*uq):a<0&&A>f3&&(x=1-o/A),x=Lu(x,-1,1);const{minPitch:B,maxPitch:M}=this.getViewportProps(),U=i+180*v;let N=n;return x>0?N=n+x*(M-n):x<0&&(N=n-x*(B-n)),{pitch:N,bearing:U}}}class hq extends cq{constructor(){super(...arguments),W(this,"ControllerState",Aq),W(this,"transition",{transitionDuration:300,transitionInterpolator:new d3({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),W(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class Db extends eq{get ViewportType(){return Ph}get ControllerType(){return hq}}W(Db,"displayName","MapView");const dq=new Lb;function fq(r,e){var t,n;const i=(t=r.order)!==null&&t!==void 0?t:1/0,s=(n=e.order)!==null&&n!==void 0?n:1/0;return i-s}class pq{constructor(){W(this,"effects",void 0),W(this,"_resolvedEffects",[]),W(this,"_defaultEffects",[]),W(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const t=this._defaultEffects;if(!t.find(n=>n.id===e.id)){const n=t.findIndex(i=>fq(i,e)>0);n<0?t.push(e):t.splice(n,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Ql(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._resolvedEffects}_setEffects(e){const t={};for(const i of this.effects)t[i.id]=i;const n=[];for(const i of e){const s=t[i.id];s&&s!==i?s.setProps?(s.setProps(i.props),n.push(s)):(s.cleanup(),n.push(i)):n.push(i),delete t[i.id]}for(const i in t)t[i].cleanup();this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),e.some(i=>i instanceof Lb)||this._resolvedEffects.push(dq),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class gq extends wb{shouldDrawLayer(e){const{operation:t}=e.props;return t.includes("draw")||t.includes("terrain")}}const mq="deckRenderer.renderLayers";class yq{constructor(e){W(this,"gl",void 0),W(this,"layerFilter",void 0),W(this,"drawPickingColors",void 0),W(this,"drawLayersPass",void 0),W(this,"pickLayersPass",void 0),W(this,"renderCount",void 0),W(this,"_needsRedraw",void 0),W(this,"renderBuffers",void 0),W(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new gq(e),this.pickLayersPass=new u3(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||bs.getDefaultFramebuffer(this.gl)};n.effects&&this._preRender(n.effects,n);const i=this.lastPostProcessEffect?this.renderBuffers[0]:n.target,s=t.render({...n,target:i});n.effects&&this._postRender(n.effects,n),this.renderCount++,ao(mq,this,s,e)}needsRedraw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){this.lastPostProcessEffect=null,t.preRenderStats=t.preRenderStats||{};for(const n of e)t.preRenderStats[n.id]=n.preRender(this.gl,t),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new bs(this.gl),new bs(this.gl));for(const t of e)t.resize()}_postRender(e,t){const{renderBuffers:n}=this,i={...t,inputBuffer:n[0],swapBuffer:n[1],target:null};for(const s of e)if(s.postRender){if(s.id===this.lastPostProcessEffect){i.target=t.target,s.postRender(this.gl,i);break}const a=s.postRender(this.gl,i);i.inputBuffer=a,i.swapBuffer=a===n[0]?n[1]:n[0]}}}const _q={pickedColor:null,pickedObjectIndex:-1};function vq(r){let{pickedColors:e,decodePickingColor:t,deviceX:n,deviceY:i,deviceRadius:s,deviceRect:a}=r;const{x:o,y:A,width:f,height:m}=a;let v=s*s,x=-1,B=0;for(let M=0;M<m;M++){const U=M+A-i,N=U*U;if(N>v)B+=4*f;else for(let Q=0;Q<f;Q++){if(e[B+3]-1>=0){const Y=Q+o-n,te=Y*Y+N;te<=v&&(v=te,x=B)}B+=4}}if(x>=0){const M=e.slice(x,x+4),U=t(M);if(U){const N=Math.floor(x/4/f),Q=x/4-N*f;return{...U,pickedColor:M,pickedX:o+Q,pickedY:A+N}}Mn.error("Picked non-existent layer. Is picking buffer corrupt?")()}return _q}function bq(r){let{pickedColors:e,decodePickingColor:t}=r;const n=new Map;if(e){for(let i=0;i<e.length;i+=4)if(e[i+3]-1>=0){const a=e.slice(i,i+4),o=a.join(",");if(!n.has(o)){const A=t(a);A?n.set(o,{...A,color:a}):Mn.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function p3(r){let{pickInfo:e,viewports:t,pixelRatio:n,x:i,y:s,z:a}=r,o=t[0];t.length>1&&(o=xq((e==null?void 0:e.pickedViewports)||t,{x:i,y:s}));let A;if(o){const f=[i-o.x,s-o.y];a!==void 0&&(f[2]=a),A=o.unproject(f)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:i,y:s,pixel:[i,s],coordinate:A,devicePixel:e&&"pickedX"in e?[e.pickedX,e.pickedY]:void 0,pixelRatio:n}}function wq(r){const{pickInfo:e,lastPickedInfo:t,mode:n,layers:i}=r,{pickedColor:s,pickedLayer:a,pickedObjectIndex:o}=e,A=a?[a]:[];if(n==="hover"){const v=t.index,x=t.layerId,B=a?a.props.id:null;if(B!==x||o!==v){if(B!==x){const M=i.find(U=>U.props.id===x);M&&A.unshift(M)}t.layerId=B,t.index=o,t.info=null}}const f=p3(r),m=new Map;return m.set(null,f),A.forEach(v=>{let x={...f};v===a&&(x.color=s,x.index=o,x.picked=!0),x=g3({layer:v,info:x,mode:n});const B=x.layer;v===a&&n==="hover"&&(t.info=x),m.set(B.id,x),n==="hover"&&B.updateAutoHighlight(x)}),m}function g3(r){let{layer:e,info:t,mode:n}=r;for(;e&&t;){const i=t.layer||null;t.sourceLayer=i,t.layer=e,t=e.getPickingInfo({info:t,mode:n,sourceLayer:i}),e=e.parent}return t}function xq(r,e){for(let t=r.length-1;t>=0;t--){const n=r[t];if(n.containsPixel(e))return n}return r[0]}class Bq{constructor(e){W(this,"gl",void 0),W(this,"pickingFBO",void 0),W(this,"depthFBO",void 0),W(this,"pickLayersPass",void 0),W(this,"layerFilter",void 0),W(this,"lastPickedInfo",void 0),W(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new u3(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject(e){let{x:t,y:n,layers:i,viewports:s}=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.lastPickedInfo.info;const o=a&&a.layer&&a.layer.id,A=a&&a.viewport&&a.viewport.id,f=o?i.find(B=>B.id===o):null,m=A&&s.find(B=>B.id===A)||s[0],v=m&&m.unproject([t-m.x,n-m.y]);return{...a,...{x:t,y:n,viewport:m,coordinate:v,layer:f}}}_resizeBuffer(){var e,t;const{gl:n}=this;if(!this.pickingFBO&&(this.pickingFBO=new bs(n),bs.isSupported(n,{colorBufferFloat:!0}))){const i=new bs(n);i.attach({36064:new Ia(n,{format:gn(n)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:n.canvas.width,height:n.canvas.height}),(t=this.depthFBO)===null||t===void 0||t.resize({width:n.canvas.width,height:n.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const t=e.filter(n=>this.pickLayersPass.shouldDrawLayer(n)&&!n.isComposite);return t.length?t:null}_pickClosestObject(e){let{layers:t,views:n,viewports:i,x:s,y:a,radius:o=0,depth:A=1,mode:f="query",unproject3D:m,onViewportActive:v,effects:x}=e;const B=this._getPickable(t),M=Nd(this.gl);if(!B)return{result:[],emptyInfo:p3({viewports:i,x:s,y:a,pixelRatio:M})};this._resizeBuffer();const U=Pv(this.gl,[s,a],!0),N=[U.x+Math.floor(U.width/2),U.y+Math.floor(U.height/2)],Q=Math.round(o*M),{width:q,height:Y}=this.pickingFBO,te=this._getPickingRect({deviceX:N[0],deviceY:N[1],deviceRadius:Q,deviceWidth:q,deviceHeight:Y}),pe={x:s-o,y:a-o,width:o*2+1,height:o*2+1};let ge;const ye=[],fe=new Set;for(let Oe=0;Oe<A;Oe++){let Fe;if(te){const le=this._drawAndSample({layers:B,views:n,viewports:i,onViewportActive:v,deviceRect:te,cullRect:pe,effects:x,pass:"picking:".concat(f)});Fe=vq({...le,deviceX:N[0],deviceY:N[1],deviceRadius:Q,deviceRect:te})}else Fe={pickedColor:null,pickedObjectIndex:-1};let oe;if(Fe.pickedLayer&&m&&this.depthFBO){const{pickedColors:le}=this._drawAndSample({layers:[Fe.pickedLayer],views:n,viewports:i,onViewportActive:v,deviceRect:{x:Fe.pickedX,y:Fe.pickedY,width:1,height:1},cullRect:pe,effects:x,pass:"picking:".concat(f,":z")},!0);le[3]&&(oe=le[0])}Fe.pickedLayer&&Oe+1<A&&(fe.add(Fe.pickedLayer),Fe.pickedLayer.disablePickingIndex(Fe.pickedObjectIndex)),ge=wq({pickInfo:Fe,lastPickedInfo:this.lastPickedInfo,mode:f,layers:B,viewports:i,x:s,y:a,z:oe,pixelRatio:M});for(const le of ge.values())le.layer&&ye.push(le);if(!Fe.pickedColor)break}for(const Oe of fe)Oe.restorePickingColors();return{result:ye,emptyInfo:ge.get(null)}}_pickVisibleObjects(e){let{layers:t,views:n,viewports:i,x:s,y:a,width:o=1,height:A=1,mode:f="query",maxObjects:m=null,onViewportActive:v,effects:x}=e;const B=this._getPickable(t);if(!B)return[];this._resizeBuffer();const M=Nd(this.gl),U=Pv(this.gl,[s,a],!0),N=U.x,Q=U.y+U.height,q=Pv(this.gl,[s+o,a+A],!0),Y=q.x+q.width,te=q.y,pe={x:N,y:te,width:Y-N,height:Q-te},ge=this._drawAndSample({layers:B,views:n,viewports:i,onViewportActive:v,deviceRect:pe,cullRect:{x:s,y:a,width:o,height:A},effects:x,pass:"picking:".concat(f)}),ye=bq(ge),fe=new Map,Oe=Number.isFinite(m);for(let oe=0;oe<ye.length;oe++){var Fe;if(Oe&&m&&fe.size>=m)break;const le=ye[oe];let xe={color:le.pickedColor,layer:null,index:le.pickedObjectIndex,picked:!0,x:s,y:a,pixelRatio:M};xe=g3({layer:le.pickedLayer,info:xe,mode:f});const _e=(Fe=xe.object)!==null&&Fe!==void 0?Fe:"".concat(xe.layer.id,"[").concat(xe.index,"]");fe.has(_e)||fe.set(_e,xe)}return Array.from(fe.values())}_drawAndSample(e){let{layers:t,views:n,viewports:i,onViewportActive:s,deviceRect:a,cullRect:o,effects:A,pass:f}=e,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=m?this.depthFBO:this.pickingFBO,x={layers:t,layerFilter:this.layerFilter,views:n,viewports:i,onViewportActive:s,pickingFBO:v,deviceRect:a,cullRect:o,effects:A,pass:f,pickZ:m,preRenderStats:{}};for(const Y of A)Y.useInPicking&&(x.preRenderStats[Y.id]=Y.preRender(this.gl,x));const{decodePickingColor:B}=this.pickLayersPass.render(x),{x:M,y:U,width:N,height:Q}=a,q=new(m?Float32Array:Uint8Array)(N*Q*4);return a0(v,{sourceX:M,sourceY:U,sourceWidth:N,sourceHeight:Q,target:q}),{pickedColors:q,decodePickingColor:B}}_getPickingRect(e){let{deviceX:t,deviceY:n,deviceRadius:i,deviceWidth:s,deviceHeight:a}=e;const o=Math.max(0,t-i),A=Math.max(0,n-i),f=Math.min(s,t+i+1)-o,m=Math.min(a,n+i+1)-A;return f<=0||m<=0?null:{x:o,y:A,width:f,height:m}}}const Cq={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class Eq{constructor(e){W(this,"el",null),W(this,"isVisible",!1);const t=e.parentElement;t&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,Cq),t.appendChild(this.el))}setTooltip(e,t,n){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(t,"px, ").concat(n,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var m3={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(r){(function(e,t,n,i){var s=["","webkit","Moz","MS","ms","o"],a=t.createElement("div"),o="function",A=Math.round,f=Math.abs,m=Date.now;function v(he,Be,He){return setTimeout(Y(he,He),Be)}function x(he,Be,He){return Array.isArray(he)?(B(he,He[Be],He),!0):!1}function B(he,Be,He){var dt;if(he)if(he.forEach)he.forEach(Be,He);else if(he.length!==i)for(dt=0;dt<he.length;)Be.call(He,he[dt],dt,he),dt++;else for(dt in he)he.hasOwnProperty(dt)&&Be.call(He,he[dt],dt,he)}function M(he,Be,He){var dt="DEPRECATED METHOD: "+Be+`
`+He+` AT 
`;return function(){var Mt=new Error("get-stack-trace"),sr=Mt&&Mt.stack?Mt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",zr=e.console&&(e.console.warn||e.console.log);return zr&&zr.call(e.console,dt,sr),he.apply(this,arguments)}}var U;typeof Object.assign!="function"?U=function(Be){if(Be===i||Be===null)throw new TypeError("Cannot convert undefined or null to object");for(var He=Object(Be),dt=1;dt<arguments.length;dt++){var Mt=arguments[dt];if(Mt!==i&&Mt!==null)for(var sr in Mt)Mt.hasOwnProperty(sr)&&(He[sr]=Mt[sr])}return He}:U=Object.assign;var N=M(function(Be,He,dt){for(var Mt=Object.keys(He),sr=0;sr<Mt.length;)(!dt||dt&&Be[Mt[sr]]===i)&&(Be[Mt[sr]]=He[Mt[sr]]),sr++;return Be},"extend","Use `assign`."),Q=M(function(Be,He){return N(Be,He,!0)},"merge","Use `assign`.");function q(he,Be,He){var dt=Be.prototype,Mt;Mt=he.prototype=Object.create(dt),Mt.constructor=he,Mt._super=dt,He&&U(Mt,He)}function Y(he,Be){return function(){return he.apply(Be,arguments)}}function te(he,Be){return typeof he==o?he.apply(Be&&Be[0]||i,Be):he}function pe(he,Be){return he===i?Be:he}function ge(he,Be,He){B(Fe(Be),function(dt){he.addEventListener(dt,He,!1)})}function ye(he,Be,He){B(Fe(Be),function(dt){he.removeEventListener(dt,He,!1)})}function fe(he,Be){for(;he;){if(he==Be)return!0;he=he.parentNode}return!1}function Oe(he,Be){return he.indexOf(Be)>-1}function Fe(he){return he.trim().split(/\s+/g)}function oe(he,Be,He){if(he.indexOf&&!He)return he.indexOf(Be);for(var dt=0;dt<he.length;){if(He&&he[dt][He]==Be||!He&&he[dt]===Be)return dt;dt++}return-1}function le(he){return Array.prototype.slice.call(he,0)}function xe(he,Be,He){for(var dt=[],Mt=[],sr=0;sr<he.length;){var zr=Be?he[sr][Be]:he[sr];oe(Mt,zr)<0&&dt.push(he[sr]),Mt[sr]=zr,sr++}return He&&(Be?dt=dt.sort(function(Zn,ui){return Zn[Be]>ui[Be]}):dt=dt.sort()),dt}function _e(he,Be){for(var He,dt,Mt=Be[0].toUpperCase()+Be.slice(1),sr=0;sr<s.length;){if(He=s[sr],dt=He?He+Mt:Be,dt in he)return dt;sr++}return i}var tt=1;function et(){return tt++}function nt(he){var Be=he.ownerDocument||he;return Be.defaultView||Be.parentWindow||e}var Je=/mobile|tablet|ip(ad|hone|od)|android/i,it="ontouchstart"in e,ot=_e(e,"PointerEvent")!==i,xt=it&&Je.test(navigator.userAgent),se="touch",be="pen",Me="mouse",De="kinect",$e=25,qe=1,ct=2,st=4,Ct=8,It=1,Qt=2,Ht=4,zt=8,mt=16,Re=Qt|Ht,Ye=zt|mt,tr=Re|Ye,St=["x","y"],vt=["clientX","clientY"];function Bt(he,Be){var He=this;this.manager=he,this.callback=Be,this.element=he.element,this.target=he.options.inputTarget,this.domHandler=function(dt){te(he.options.enable,[he])&&He.handler(dt)},this.init()}Bt.prototype={handler:function(){},init:function(){this.evEl&&ge(this.element,this.evEl,this.domHandler),this.evTarget&&ge(this.target,this.evTarget,this.domHandler),this.evWin&&ge(nt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ye(this.element,this.evEl,this.domHandler),this.evTarget&&ye(this.target,this.evTarget,this.domHandler),this.evWin&&ye(nt(this.element),this.evWin,this.domHandler)}};function kt(he){var Be,He=he.options.inputClass;return He?Be=He:ot?Be=ee:xt?Be=Ze:it?Be=Vt:Be=Or,new Be(he,ir)}function ir(he,Be,He){var dt=He.pointers.length,Mt=He.changedPointers.length,sr=Be&qe&&dt-Mt===0,zr=Be&(st|Ct)&&dt-Mt===0;He.isFirst=!!sr,He.isFinal=!!zr,sr&&(he.session={}),He.eventType=Be,Ar(he,He),he.emit("hammer.input",He),he.recognize(He),he.session.prevInput=He}function Ar(he,Be){var He=he.session,dt=Be.pointers,Mt=dt.length;He.firstInput||(He.firstInput=kr(Be)),Mt>1&&!He.firstMultiple?He.firstMultiple=kr(Be):Mt===1&&(He.firstMultiple=!1);var sr=He.firstInput,zr=He.firstMultiple,Wn=zr?zr.center:sr.center,Zn=Be.center=Qr(dt);Be.timeStamp=m(),Be.deltaTime=Be.timeStamp-sr.timeStamp,Be.angle=xn(Wn,Zn),Be.distance=Dt(Wn,Zn),Lr(He,Be),Be.offsetDirection=Ir(Be.deltaX,Be.deltaY);var ui=pt(Be.deltaTime,Be.deltaX,Be.deltaY);Be.overallVelocityX=ui.x,Be.overallVelocityY=ui.y,Be.overallVelocity=f(ui.x)>f(ui.y)?ui.x:ui.y,Be.scale=zr?Tt(zr.pointers,dt):1,Be.rotation=zr?Mr(zr.pointers,dt):0,Be.maxPointers=He.prevInput?Be.pointers.length>He.prevInput.maxPointers?Be.pointers.length:He.prevInput.maxPointers:Be.pointers.length,Tr(He,Be);var Nn=he.element;fe(Be.srcEvent.target,Nn)&&(Nn=Be.srcEvent.target),Be.target=Nn}function Lr(he,Be){var He=Be.center,dt=he.offsetDelta||{},Mt=he.prevDelta||{},sr=he.prevInput||{};(Be.eventType===qe||sr.eventType===st)&&(Mt=he.prevDelta={x:sr.deltaX||0,y:sr.deltaY||0},dt=he.offsetDelta={x:He.x,y:He.y}),Be.deltaX=Mt.x+(He.x-dt.x),Be.deltaY=Mt.y+(He.y-dt.y)}function Tr(he,Be){var He=he.lastInterval||Be,dt=Be.timeStamp-He.timeStamp,Mt,sr,zr,Wn;if(Be.eventType!=Ct&&(dt>$e||He.velocity===i)){var Zn=Be.deltaX-He.deltaX,ui=Be.deltaY-He.deltaY,Nn=pt(dt,Zn,ui);sr=Nn.x,zr=Nn.y,Mt=f(Nn.x)>f(Nn.y)?Nn.x:Nn.y,Wn=Ir(Zn,ui),he.lastInterval=Be}else Mt=He.velocity,sr=He.velocityX,zr=He.velocityY,Wn=He.direction;Be.velocity=Mt,Be.velocityX=sr,Be.velocityY=zr,Be.direction=Wn}function kr(he){for(var Be=[],He=0;He<he.pointers.length;)Be[He]={clientX:A(he.pointers[He].clientX),clientY:A(he.pointers[He].clientY)},He++;return{timeStamp:m(),pointers:Be,center:Qr(Be),deltaX:he.deltaX,deltaY:he.deltaY}}function Qr(he){var Be=he.length;if(Be===1)return{x:A(he[0].clientX),y:A(he[0].clientY)};for(var He=0,dt=0,Mt=0;Mt<Be;)He+=he[Mt].clientX,dt+=he[Mt].clientY,Mt++;return{x:A(He/Be),y:A(dt/Be)}}function pt(he,Be,He){return{x:Be/he||0,y:He/he||0}}function Ir(he,Be){return he===Be?It:f(he)>=f(Be)?he<0?Qt:Ht:Be<0?zt:mt}function Dt(he,Be,He){He||(He=St);var dt=Be[He[0]]-he[He[0]],Mt=Be[He[1]]-he[He[1]];return Math.sqrt(dt*dt+Mt*Mt)}function xn(he,Be,He){He||(He=St);var dt=Be[He[0]]-he[He[0]],Mt=Be[He[1]]-he[He[1]];return Math.atan2(Mt,dt)*180/Math.PI}function Mr(he,Be){return xn(Be[1],Be[0],vt)+xn(he[1],he[0],vt)}function Tt(he,Be){return Dt(Be[0],Be[1],vt)/Dt(he[0],he[1],vt)}var Jt={mousedown:qe,mousemove:ct,mouseup:st},Kt="mousedown",Yr="mousemove mouseup";function Or(){this.evEl=Kt,this.evWin=Yr,this.pressed=!1,Bt.apply(this,arguments)}q(Or,Bt,{handler:function(Be){var He=Jt[Be.type];He&qe&&Be.button===0&&(this.pressed=!0),He&ct&&Be.which!==1&&(He=st),this.pressed&&(He&st&&(this.pressed=!1),this.callback(this.manager,He,{pointers:[Be],changedPointers:[Be],pointerType:Me,srcEvent:Be}))}});var gr={pointerdown:qe,pointermove:ct,pointerup:st,pointercancel:Ct,pointerout:Ct},an={2:se,3:be,4:Me,5:De},Wr="pointerdown",Ee="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Wr="MSPointerDown",Ee="MSPointerMove MSPointerUp MSPointerCancel");function ee(){this.evEl=Wr,this.evWin=Ee,Bt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}q(ee,Bt,{handler:function(Be){var He=this.store,dt=!1,Mt=Be.type.toLowerCase().replace("ms",""),sr=gr[Mt],zr=an[Be.pointerType]||Be.pointerType,Wn=zr==se,Zn=oe(He,Be.pointerId,"pointerId");sr&qe&&(Be.button===0||Wn)?Zn<0&&(He.push(Be),Zn=He.length-1):sr&(st|Ct)&&(dt=!0),!(Zn<0)&&(He[Zn]=Be,this.callback(this.manager,sr,{pointers:He,changedPointers:[Be],pointerType:zr,srcEvent:Be}),dt&&He.splice(Zn,1))}});var Z={touchstart:qe,touchmove:ct,touchend:st,touchcancel:Ct},ae="touchstart",Se="touchstart touchmove touchend touchcancel";function Qe(){this.evTarget=ae,this.evWin=Se,this.started=!1,Bt.apply(this,arguments)}q(Qe,Bt,{handler:function(Be){var He=Z[Be.type];if(He===qe&&(this.started=!0),!!this.started){var dt=Ge.call(this,Be,He);He&(st|Ct)&&dt[0].length-dt[1].length===0&&(this.started=!1),this.callback(this.manager,He,{pointers:dt[0],changedPointers:dt[1],pointerType:se,srcEvent:Be})}}});function Ge(he,Be){var He=le(he.touches),dt=le(he.changedTouches);return Be&(st|Ct)&&(He=xe(He.concat(dt),"identifier",!0)),[He,dt]}var Ke={touchstart:qe,touchmove:ct,touchend:st,touchcancel:Ct},Te="touchstart touchmove touchend touchcancel";function Ze(){this.evTarget=Te,this.targetIds={},Bt.apply(this,arguments)}q(Ze,Bt,{handler:function(Be){var He=Ke[Be.type],dt=yt.call(this,Be,He);dt&&this.callback(this.manager,He,{pointers:dt[0],changedPointers:dt[1],pointerType:se,srcEvent:Be})}});function yt(he,Be){var He=le(he.touches),dt=this.targetIds;if(Be&(qe|ct)&&He.length===1)return dt[He[0].identifier]=!0,[He,He];var Mt,sr,zr=le(he.changedTouches),Wn=[],Zn=this.target;if(sr=He.filter(function(ui){return fe(ui.target,Zn)}),Be===qe)for(Mt=0;Mt<sr.length;)dt[sr[Mt].identifier]=!0,Mt++;for(Mt=0;Mt<zr.length;)dt[zr[Mt].identifier]&&Wn.push(zr[Mt]),Be&(st|Ct)&&delete dt[zr[Mt].identifier],Mt++;if(Wn.length)return[xe(sr.concat(Wn),"identifier",!0),Wn]}var gt=2500,ft=25;function Vt(){Bt.apply(this,arguments);var he=Y(this.handler,this);this.touch=new Ze(this.manager,he),this.mouse=new Or(this.manager,he),this.primaryTouch=null,this.lastTouches=[]}q(Vt,Bt,{handler:function(Be,He,dt){var Mt=dt.pointerType==se,sr=dt.pointerType==Me;if(!(sr&&dt.sourceCapabilities&&dt.sourceCapabilities.firesTouchEvents)){if(Mt)Yt.call(this,He,dt);else if(sr&&lr.call(this,dt))return;this.callback(Be,He,dt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Yt(he,Be){he&qe?(this.primaryTouch=Be.changedPointers[0].identifier,Er.call(this,Be)):he&(st|Ct)&&Er.call(this,Be)}function Er(he){var Be=he.changedPointers[0];if(Be.identifier===this.primaryTouch){var He={x:Be.clientX,y:Be.clientY};this.lastTouches.push(He);var dt=this.lastTouches,Mt=function(){var sr=dt.indexOf(He);sr>-1&&dt.splice(sr,1)};setTimeout(Mt,gt)}}function lr(he){for(var Be=he.srcEvent.clientX,He=he.srcEvent.clientY,dt=0;dt<this.lastTouches.length;dt++){var Mt=this.lastTouches[dt],sr=Math.abs(Be-Mt.x),zr=Math.abs(He-Mt.y);if(sr<=ft&&zr<=ft)return!0}return!1}var Ur=_e(a.style,"touchAction"),Nr=Ur!==i,Hr="compute",mn="auto",mr="manipulation",$r="none",bn="pan-x",kn="pan-y",ke=nn();function Rt(he,Be){this.manager=he,this.set(Be)}Rt.prototype={set:function(he){he==Hr&&(he=this.compute()),Nr&&this.manager.element.style&&ke[he]&&(this.manager.element.style[Ur]=he),this.actions=he.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var he=[];return B(this.manager.recognizers,function(Be){te(Be.options.enable,[Be])&&(he=he.concat(Be.getTouchAction()))}),Lt(he.join(" "))},preventDefaults:function(he){var Be=he.srcEvent,He=he.offsetDirection;if(this.manager.session.prevented){Be.preventDefault();return}var dt=this.actions,Mt=Oe(dt,$r)&&!ke[$r],sr=Oe(dt,kn)&&!ke[kn],zr=Oe(dt,bn)&&!ke[bn];if(Mt){var Wn=he.pointers.length===1,Zn=he.distance<2,ui=he.deltaTime<250;if(Wn&&Zn&&ui)return}if(!(zr&&sr)&&(Mt||sr&&He&Re||zr&&He&Ye))return this.preventSrc(Be)},preventSrc:function(he){this.manager.session.prevented=!0,he.preventDefault()}};function Lt(he){if(Oe(he,$r))return $r;var Be=Oe(he,bn),He=Oe(he,kn);return Be&&He?$r:Be||He?Be?bn:kn:Oe(he,mr)?mr:mn}function nn(){if(!Nr)return!1;var he={},Be=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(He){he[He]=Be?e.CSS.supports("touch-action",He):!0}),he}var Pn=1,Br=2,yn=4,wi=8,_n=wi,sn=16,xi=32;function Jn(he){this.options=U({},this.defaults,he||{}),this.id=et(),this.manager=null,this.options.enable=pe(this.options.enable,!0),this.state=Pn,this.simultaneous={},this.requireFail=[]}Jn.prototype={defaults:{},set:function(he){return U(this.options,he),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(he){if(x(he,"recognizeWith",this))return this;var Be=this.simultaneous;return he=zo(he,this),Be[he.id]||(Be[he.id]=he,he.recognizeWith(this)),this},dropRecognizeWith:function(he){return x(he,"dropRecognizeWith",this)?this:(he=zo(he,this),delete this.simultaneous[he.id],this)},requireFailure:function(he){if(x(he,"requireFailure",this))return this;var Be=this.requireFail;return he=zo(he,this),oe(Be,he)===-1&&(Be.push(he),he.requireFailure(this)),this},dropRequireFailure:function(he){if(x(he,"dropRequireFailure",this))return this;he=zo(he,this);var Be=oe(this.requireFail,he);return Be>-1&&this.requireFail.splice(Be,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(he){return!!this.simultaneous[he.id]},emit:function(he){var Be=this,He=this.state;function dt(Mt){Be.manager.emit(Mt,he)}He<wi&&dt(Be.options.event+as(He)),dt(Be.options.event),he.additionalEvent&&dt(he.additionalEvent),He>=wi&&dt(Be.options.event+as(He))},tryEmit:function(he){if(this.canEmit())return this.emit(he);this.state=xi},canEmit:function(){for(var he=0;he<this.requireFail.length;){if(!(this.requireFail[he].state&(xi|Pn)))return!1;he++}return!0},recognize:function(he){var Be=U({},he);if(!te(this.options.enable,[this,Be])){this.reset(),this.state=xi;return}this.state&(_n|sn|xi)&&(this.state=Pn),this.state=this.process(Be),this.state&(Br|yn|wi|sn)&&this.tryEmit(Be)},process:function(he){},getTouchAction:function(){},reset:function(){}};function as(he){return he&sn?"cancel":he&wi?"end":he&yn?"move":he&Br?"start":""}function Os(he){return he==mt?"down":he==zt?"up":he==Qt?"left":he==Ht?"right":""}function zo(he,Be){var He=Be.manager;return He?He.get(he):he}function Dr(){Jn.apply(this,arguments)}q(Dr,Jn,{defaults:{pointers:1},attrTest:function(he){var Be=this.options.pointers;return Be===0||he.pointers.length===Be},process:function(he){var Be=this.state,He=he.eventType,dt=Be&(Br|yn),Mt=this.attrTest(he);return dt&&(He&Ct||!Mt)?Be|sn:dt||Mt?He&st?Be|wi:Be&Br?Be|yn:Br:xi}});function Js(){Dr.apply(this,arguments),this.pX=null,this.pY=null}q(Js,Dr,{defaults:{event:"pan",threshold:10,pointers:1,direction:tr},getTouchAction:function(){var he=this.options.direction,Be=[];return he&Re&&Be.push(kn),he&Ye&&Be.push(bn),Be},directionTest:function(he){var Be=this.options,He=!0,dt=he.distance,Mt=he.direction,sr=he.deltaX,zr=he.deltaY;return Mt&Be.direction||(Be.direction&Re?(Mt=sr===0?It:sr<0?Qt:Ht,He=sr!=this.pX,dt=Math.abs(he.deltaX)):(Mt=zr===0?It:zr<0?zt:mt,He=zr!=this.pY,dt=Math.abs(he.deltaY))),he.direction=Mt,He&&dt>Be.threshold&&Mt&Be.direction},attrTest:function(he){return Dr.prototype.attrTest.call(this,he)&&(this.state&Br||!(this.state&Br)&&this.directionTest(he))},emit:function(he){this.pX=he.deltaX,this.pY=he.deltaY;var Be=Os(he.direction);Be&&(he.additionalEvent=this.options.event+Be),this._super.emit.call(this,he)}});function Cs(){Dr.apply(this,arguments)}q(Cs,Dr,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[$r]},attrTest:function(he){return this._super.attrTest.call(this,he)&&(Math.abs(he.scale-1)>this.options.threshold||this.state&Br)},emit:function(he){if(he.scale!==1){var Be=he.scale<1?"in":"out";he.additionalEvent=this.options.event+Be}this._super.emit.call(this,he)}});function In(){Jn.apply(this,arguments),this._timer=null,this._input=null}q(In,Jn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[mn]},process:function(he){var Be=this.options,He=he.pointers.length===Be.pointers,dt=he.distance<Be.threshold,Mt=he.deltaTime>Be.time;if(this._input=he,!dt||!He||he.eventType&(st|Ct)&&!Mt)this.reset();else if(he.eventType&qe)this.reset(),this._timer=v(function(){this.state=_n,this.tryEmit()},Be.time,this);else if(he.eventType&st)return _n;return xi},reset:function(){clearTimeout(this._timer)},emit:function(he){this.state===_n&&(he&&he.eventType&st?this.manager.emit(this.options.event+"up",he):(this._input.timeStamp=m(),this.manager.emit(this.options.event,this._input)))}});function vo(){Dr.apply(this,arguments)}q(vo,Dr,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[$r]},attrTest:function(he){return this._super.attrTest.call(this,he)&&(Math.abs(he.rotation)>this.options.threshold||this.state&Br)}});function Pi(){Dr.apply(this,arguments)}q(Pi,Dr,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Re|Ye,pointers:1},getTouchAction:function(){return Js.prototype.getTouchAction.call(this)},attrTest:function(he){var Be=this.options.direction,He;return Be&(Re|Ye)?He=he.overallVelocity:Be&Re?He=he.overallVelocityX:Be&Ye&&(He=he.overallVelocityY),this._super.attrTest.call(this,he)&&Be&he.offsetDirection&&he.distance>this.options.threshold&&he.maxPointers==this.options.pointers&&f(He)>this.options.velocity&&he.eventType&st},emit:function(he){var Be=Os(he.offsetDirection);Be&&this.manager.emit(this.options.event+Be,he),this.manager.emit(this.options.event,he)}});function Ui(){Jn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}q(Ui,Jn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[mr]},process:function(he){var Be=this.options,He=he.pointers.length===Be.pointers,dt=he.distance<Be.threshold,Mt=he.deltaTime<Be.time;if(this.reset(),he.eventType&qe&&this.count===0)return this.failTimeout();if(dt&&Mt&&He){if(he.eventType!=st)return this.failTimeout();var sr=this.pTime?he.timeStamp-this.pTime<Be.interval:!0,zr=!this.pCenter||Dt(this.pCenter,he.center)<Be.posThreshold;this.pTime=he.timeStamp,this.pCenter=he.center,!zr||!sr?this.count=1:this.count+=1,this._input=he;var Wn=this.count%Be.taps;if(Wn===0)return this.hasRequireFailures()?(this._timer=v(function(){this.state=_n,this.tryEmit()},Be.interval,this),Br):_n}return xi},failTimeout:function(){return this._timer=v(function(){this.state=xi},this.options.interval,this),xi},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==_n&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Yn(he,Be){return Be=Be||{},Be.recognizers=pe(Be.recognizers,Yn.defaults.preset),new Go(he,Be)}Yn.VERSION="2.0.7",Yn.defaults={domEvents:!1,touchAction:Hr,enable:!0,inputTarget:null,inputClass:null,preset:[[vo,{enable:!1}],[Cs,{enable:!1},["rotate"]],[Pi,{direction:Re}],[Js,{direction:Re},["swipe"]],[Ui],[Ui,{event:"doubletap",taps:2},["tap"]],[In]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Li=1,cn=2;function Go(he,Be){this.options=U({},Yn.defaults,Be||{}),this.options.inputTarget=this.options.inputTarget||he,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=he,this.input=kt(this),this.touchAction=new Rt(this,this.options.touchAction),Vo(this,!0),B(this.options.recognizers,function(He){var dt=this.add(new He[0](He[1]));He[2]&&dt.recognizeWith(He[2]),He[3]&&dt.requireFailure(He[3])},this)}Go.prototype={set:function(he){return U(this.options,he),he.touchAction&&this.touchAction.update(),he.inputTarget&&(this.input.destroy(),this.input.target=he.inputTarget,this.input.init()),this},stop:function(he){this.session.stopped=he?cn:Li},recognize:function(he){var Be=this.session;if(!Be.stopped){this.touchAction.preventDefaults(he);var He,dt=this.recognizers,Mt=Be.curRecognizer;(!Mt||Mt&&Mt.state&_n)&&(Mt=Be.curRecognizer=null);for(var sr=0;sr<dt.length;)He=dt[sr],Be.stopped!==cn&&(!Mt||He==Mt||He.canRecognizeWith(Mt))?He.recognize(he):He.reset(),!Mt&&He.state&(Br|yn|wi)&&(Mt=Be.curRecognizer=He),sr++}},get:function(he){if(he instanceof Jn)return he;for(var Be=this.recognizers,He=0;He<Be.length;He++)if(Be[He].options.event==he)return Be[He];return null},add:function(he){if(x(he,"add",this))return this;var Be=this.get(he.options.event);return Be&&this.remove(Be),this.recognizers.push(he),he.manager=this,this.touchAction.update(),he},remove:function(he){if(x(he,"remove",this))return this;if(he=this.get(he),he){var Be=this.recognizers,He=oe(Be,he);He!==-1&&(Be.splice(He,1),this.touchAction.update())}return this},on:function(he,Be){if(he!==i&&Be!==i){var He=this.handlers;return B(Fe(he),function(dt){He[dt]=He[dt]||[],He[dt].push(Be)}),this}},off:function(he,Be){if(he!==i){var He=this.handlers;return B(Fe(he),function(dt){Be?He[dt]&&He[dt].splice(oe(He[dt],Be),1):delete He[dt]}),this}},emit:function(he,Be){this.options.domEvents&&Ys(he,Be);var He=this.handlers[he]&&this.handlers[he].slice();if(!(!He||!He.length)){Be.type=he,Be.preventDefault=function(){Be.srcEvent.preventDefault()};for(var dt=0;dt<He.length;)He[dt](Be),dt++}},destroy:function(){this.element&&Vo(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Vo(he,Be){var He=he.element;if(He.style){var dt;B(he.options.cssProps,function(Mt,sr){dt=_e(He.style,sr),Be?(he.oldCssProps[dt]=He.style[dt],He.style[dt]=Mt):He.style[dt]=he.oldCssProps[dt]||""}),Be||(he.oldCssProps={})}}function Ys(he,Be){var He=t.createEvent("Event");He.initEvent(he,!0,!0),He.gesture=Be,Be.target.dispatchEvent(He)}U(Yn,{INPUT_START:qe,INPUT_MOVE:ct,INPUT_END:st,INPUT_CANCEL:Ct,STATE_POSSIBLE:Pn,STATE_BEGAN:Br,STATE_CHANGED:yn,STATE_ENDED:wi,STATE_RECOGNIZED:_n,STATE_CANCELLED:sn,STATE_FAILED:xi,DIRECTION_NONE:It,DIRECTION_LEFT:Qt,DIRECTION_RIGHT:Ht,DIRECTION_UP:zt,DIRECTION_DOWN:mt,DIRECTION_HORIZONTAL:Re,DIRECTION_VERTICAL:Ye,DIRECTION_ALL:tr,Manager:Go,Input:Bt,TouchAction:Rt,TouchInput:Ze,MouseInput:Or,PointerEventInput:ee,TouchMouseInput:Vt,SingleTouchInput:Qe,Recognizer:Jn,AttrRecognizer:Dr,Tap:Ui,Pan:Js,Swipe:Pi,Pinch:Cs,Rotate:vo,Press:In,on:ge,off:ye,each:B,merge:Q,extend:N,assign:U,inherit:q,bindFn:Y,prefixed:_e});var fc=typeof e<"u"?e:typeof self<"u"?self:{};fc.Hammer=Yn,typeof i=="function"&&i.amd?i(function(){return Yn}):r.exports?r.exports=Yn:e[n]=Yn})(window,document,"Hammer")})(m3);var ug=m3.exports;const Hl=xp({__proto__:null,default:Bp(ug)},[ug]),y3=1,_3=2,kb=4,Sq={mousedown:y3,mousemove:_3,mouseup:kb};function Tq(r,e){for(let t=0;t<r.length;t++)if(e(r[t]))return!0;return!1}function Iq(r){const e=r.prototype.handler;r.prototype.handler=function(n){const i=this.store;n.button>0&&n.type==="pointerdown"&&(Tq(i,s=>s.pointerId===n.pointerId)||i.push(n)),e.call(this,n)}}function Lq(r){r.prototype.handler=function(t){let n=Sq[t.type];n&y3&&t.button>=0&&(this.pressed=!0),n&_3&&t.which===0&&(n=kb),this.pressed&&(n&kb&&(this.pressed=!1),this.callback(this.manager,n,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}Iq(ug.PointerEventInput),Lq(ug.MouseInput);const Fq=ug.Manager;class R0{constructor(e,t,n){this.element=e,this.callback=t,this.options={enable:!0,...n}}}const Mq=Hl?[[Hl.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Hl.Rotate,{enable:!1}],[Hl.Pinch,{enable:!1}],[Hl.Swipe,{enable:!1}],[Hl.Pan,{threshold:0,enable:!1}],[Hl.Press,{enable:!1}],[Hl.Tap,{event:"doubletap",taps:2,enable:!1}],[Hl.Tap,{event:"anytap",enable:!1}],[Hl.Tap,{enable:!1}]]:null,v3={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Pq={doubletap:["tap"]},Uq={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Nb={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Rq={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},b3={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Oq=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",tf=typeof window<"u"?window:global;let Qb=!1;try{const r={get passive(){return Qb=!0,!0}};tf.addEventListener("test",null,r),tf.removeEventListener("test",null)}catch{Qb=!1}const Dq=Oq.indexOf("firefox")!==-1,{WHEEL_EVENTS:kq}=Nb,w3="wheel",x3=4.000244140625,Nq=40,Qq=.25;class Hq extends R0{constructor(e,t,n){super(e,t,n),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;tf.WheelEvent&&(Dq&&i.deltaMode===tf.WheelEvent.DOM_DELTA_PIXEL&&(s/=tf.devicePixelRatio),i.deltaMode===tf.WheelEvent.DOM_DELTA_LINE&&(s*=Nq)),s!==0&&s%x3===0&&(s=Math.floor(s/x3)),i.shiftKey&&s&&(s=s*Qq),this.callback({type:w3,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(kq),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,Qb?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===w3&&(this.options.enable=t)}}const{MOUSE_EVENTS:zq}=Nb,B3="pointermove",C3="pointerover",E3="pointerout",S3="pointerenter",T3="pointerleave";class Gq extends R0{constructor(e,t,n){super(e,t,n),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(zq),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===B3&&(this.enableMoveEvent=t),e===C3&&(this.enableOverEvent=t),e===E3&&(this.enableOutEvent=t),e===S3&&(this.enableEnterEvent=t),e===T3&&(this.enableLeaveEvent=t)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(C3,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(E3,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(S3,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(T3,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(B3,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const{KEY_EVENTS:Vq}=Nb,I3="keydown",L3="keyup";class jq extends R0{constructor(e,t,n){super(e,t,n),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:I3,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:L3,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Vq),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===I3&&(this.enableDownEvent=t),e===L3&&(this.enableUpEvent=t)}}const F3="contextmenu";class qq extends R0{constructor(e,t,n){super(e,t,n),this.handleEvent=i=>{this.options.enable&&this.callback({type:F3,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===F3&&(this.options.enable=t)}}const Hb=1,O0=2,zb=4,Kq={pointerdown:Hb,pointermove:O0,pointerup:zb,mousedown:Hb,mousemove:O0,mouseup:zb},Wq=1,$q=2,Xq=3,Jq=0,Yq=1,Zq=2,eK=1,tK=2,rK=4;function nK(r){const e=Kq[r.srcEvent.type];if(!e)return null;const{buttons:t,button:n,which:i}=r.srcEvent;let s=!1,a=!1,o=!1;return e===zb||e===O0&&!Number.isFinite(t)?(s=i===Wq,a=i===$q,o=i===Xq):e===O0?(s=!!(t&eK),a=!!(t&rK),o=!!(t&tK)):e===Hb&&(s=n===Jq,a=n===Yq,o=n===Zq),{leftButton:s,middleButton:a,rightButton:o}}function iK(r,e){const t=r.center;if(!t)return null;const n=e.getBoundingClientRect(),i=n.width/e.offsetWidth||1,s=n.height/e.offsetHeight||1,a={x:(t.x-n.left-e.clientLeft)/i,y:(t.y-n.top-e.clientTop)/s};return{center:t,offsetCenter:a}}const Gb={srcElement:"root",priority:0};class sK{constructor(e){this.handleEvent=t=>{if(this.isEmpty())return;const n=this._normalizeEvent(t);let i=t.srcEvent.target;for(;i&&i!==n.rootElement;){if(this._emit(n,i),n.handled)return;i=i.parentNode}this._emit(n,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;const{handlers:a,handlersByElement:o}=this;let A=Gb;typeof n=="string"||n&&n.addEventListener?A={...Gb,srcElement:n}:n&&(A={...Gb,...n});let f=o.get(A.srcElement);f||(f=[],o.set(A.srcElement,f));const m={type:e,handler:t,srcElement:A.srcElement,priority:A.priority};i&&(m.once=!0),s&&(m.passive=!0),a.push(m),this._active=this._active||!m.passive;let v=f.length-1;for(;v>=0&&!(f[v].priority>=m.priority);)v--;f.splice(v+1,0,m)}remove(e,t){const{handlers:n,handlersByElement:i}=this;for(let s=n.length-1;s>=0;s--){const a=n[s];if(a.type===e&&a.handler===t){n.splice(s,1);const o=i.get(a.srcElement);o.splice(o.indexOf(a),1),o.length===0&&i.delete(a.srcElement)}}this._active=n.some(s=>!s.passive)}_emit(e,t){const n=this.handlersByElement.get(t);if(n){let i=!1;const s=()=>{e.handled=!0},a=()=>{e.handled=!0,i=!0},o=[];for(let A=0;A<n.length;A++){const{type:f,handler:m,once:v}=n[A];if(m({...e,type:f,stopPropagation:s,stopImmediatePropagation:a}),v&&o.push(n[A]),i)break}for(let A=0;A<o.length;A++){const{type:f,handler:m}=o[A];this.remove(f,m)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return{...e,...nK(e),...iK(e,t),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t}}}const oK={events:null,recognizers:null,recognizerOptions:{},Manager:Fq,touchAction:"none",tabIndex:0};class aK{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;this._onBasicInput=i=>{const{srcEvent:s}=i,a=Uq[s.type];a&&this.manager.emit(a,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...oK,...t},this.events=new Map,this.setElement(e);const{events:n}=this.options;n&&this.on(n)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this,n=t.Manager;this.manager=new n(e,{touchAction:t.touchAction,recognizers:t.recognizers||Mq}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(v3).forEach(i=>{const s=this.manager.get(i);s&&v3[i].forEach(a=>{s.recognizeWith(a)})});for(const i in t.recognizerOptions){const s=this.manager.get(i);if(s){const a=t.recognizerOptions[i];delete a.enable,s.set(a)}}this.wheelInput=new Hq(e,this._onOtherEvent,{enable:!1}),this.moveInput=new Gq(e,this._onOtherEvent,{enable:!1}),this.keyInput=new jq(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new qq(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,n){this._addEventHandler(e,t,n,!1)}once(e,t,n){this._addEventHandler(e,t,n,!0)}watch(e,t,n){this._addEventHandler(e,t,n,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:n}=this;if(!n)return;const i=n.get(e);if(i&&i.options.enable!==t){i.set({enable:t});const s=Pq[e];s&&!this.options.recognizers&&s.forEach(a=>{const o=n.get(a);t?(o.requireFailure(e),i.dropRequireFailure(a)):o.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,n,i,s){if(typeof e!="string"){n=t;for(const m in e)this._addEventHandler(m,e[m],n,i,s);return}const{manager:a,events:o}=this,A=b3[e]||e;let f=o.get(A);f||(f=new sK(this),o.set(A,f),f.recognizerName=Rq[A]||A,a&&a.on(A,f.handleEvent)),f.add(e,t,n,i,s),f.isEmpty()||this._toggleRecognizer(f.recognizerName,!0)}_removeEventHandler(e,t){if(typeof e!="string"){for(const a in e)this._removeEventHandler(a,e[a]);return}const{events:n}=this,i=b3[e]||e,s=n.get(i);if(s&&(s.remove(e,t),s.isEmpty())){const{recognizerName:a}=s;let o=!1;for(const A of n.values())if(A.recognizerName===a&&!A.isEmpty()){o=!0;break}o||this._toggleRecognizer(a,!1)}}}function Oh(){}const M3={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Oh,onResize:Oh,onViewStateChange:Oh,onInteractionStateChange:Oh,onBeforeRender:Oh,onAfterRender:Oh,onLoad:Oh,onError:r=>Mn.error(r.message,r.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:r=>{let{isDragging:e}=r;return e?"grabbing":"grab"},getTooltip:null,debug:!1,drawPickingColors:!1};class Vb{constructor(e){W(this,"props",void 0),W(this,"width",0),W(this,"height",0),W(this,"userData",{}),W(this,"canvas",null),W(this,"viewManager",null),W(this,"layerManager",null),W(this,"effectManager",null),W(this,"deckRenderer",null),W(this,"deckPicker",null),W(this,"eventManager",null),W(this,"tooltip",null),W(this,"metrics",void 0),W(this,"animationLoop",void 0),W(this,"stats",void 0),W(this,"viewState",void 0),W(this,"cursorState",void 0),W(this,"_needsRedraw",void 0),W(this,"_pickRequest",void 0),W(this,"_lastPointerDownInfo",null),W(this,"_metricsCounter",void 0),W(this,"_onPointerMove",t=>{const{_pickRequest:n}=this;if(t.type==="pointerleave")n.x=-1,n.y=-1,n.radius=0;else{if(t.leftButton||t.rightButton)return;{const i=t.offsetCenter;if(!i)return;n.x=i.x,n.y=i.y,n.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:n.x,y:n.y}),n.event=t}),W(this,"_onEvent",t=>{const n=XS[t.type],i=t.offsetCenter;if(!n||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),a=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=a,A=o&&(o[n.handler]||o.props[n.handler]),f=this.props[n.handler];let m=!1;A&&(m=A.call(o,a,t)),!m&&f&&f(a,t)}),W(this,"_onPointerDown",t=>{const n=t.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:n.x,y:n.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...M3,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&Mn.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),VS()==="IE"&&Mn.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new Ov({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&og.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,t,n,i,s,a,o,A;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(t=this.layerManager)===null||t===void 0||t.finalize(),this.layerManager=null,(n=this.viewManager)===null||n===void 0||n.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(a=this.deckPicker)===null||a===void 0||a.finalize(),this.deckPicker=null,(o=this.eventManager)===null||o===void 0||o.destroy(),this.eventManager=null,(A=this.tooltip)===null||A===void 0||A.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var f;(f=this.canvas.parentElement)===null||f===void 0||f.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Mn.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Mn.removed("onLayerClick","onClick")(),e.initialViewState&&!Ql(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),a=this.deckRenderer.needsRedraw(e);return t=t||n||i||s||a,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return this.viewManager!==null}getViews(){return Ks(this.viewManager),this.viewManager.views}getViewports(e){return Ks(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(const n in e)this.layerManager.resourceManager.add({resourceId:n,data:e[n],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,t,n){Ks(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(t).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;return typeof t=="string"&&(t=document.getElementById(t),Ks(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;const{width:t,height:n}=e;if(t||t===0){const s=Number.isFinite(t)?"".concat(t,"px"):t;this.canvas.style.width=s}if(n||n===0){var i;const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var e,t;const{canvas:n}=this;if(!n)return;const i=(e=n.clientWidth)!==null&&e!==void 0?e:n.width,s=(t=n.clientHeight)!==null&&t!==void 0?t:n.height;if(i!==this.width||s!==this.height){var a,o;this.width=i,this.height=s,(a=this.viewManager)===null||a===void 0||a.setProps({width:i,height:s}),(o=this.layerManager)===null||o===void 0||o.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:s})}}_createAnimationLoop(e){const{width:t,height:n,gl:i,glOptions:s,debug:a,onError:o,onBeforeRender:A,onAfterRender:f,useDevicePixels:m}=e;return new zz({width:t,height:n,useDevicePixels:m,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:v=>h5({...s,...v,canvas:this.canvas,debug:a,onContextLost:()=>this._onContextLost()}),onInitialize:v=>this._setGLContext(v.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:A,onAfterRender:f,onError:o})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new Db({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:n,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=n.length>0;let s=i,a=!1;for(const o of n){var t;s=o,a=((t=o.layer)===null||t===void 0?void 0:t.onHover(o,e.event))||a}if(!a&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const o=this.props.getTooltip(s);this.tooltip.setTooltip(o,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,Rv(e,{enable:!0,copyState:!0})),this.tooltip=new Eq(this.canvas),Cu(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const t=new HT;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new aK(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in XS)this.eventManager.on(i,this._onEvent);this.viewManager=new Yj({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new Jj(e,{deck:this,stats:this.stats,viewport:n,timeline:t}),this.effectManager=new pq,this.deckRenderer=new yq(e),this.deckPicker=new Bq(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:n}=this.layerManager.context;Cu(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...t}),this.props.onAfterRender({gl:n})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Mn.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:t},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const n=Ih.get("Memory Usage");e.bufferMemory=n.get("Buffer Memory").count,e.textureMemory=n.get("Texture Memory").count,e.renderbufferMemory=n.get("Renderbuffer Memory").count,e.gpuMemory=n.get("GPU Memory").count}}W(Vb,"defaultProps",M3),W(Vb,"VERSION",WQ);class jb{constructor(e,t){W(this,"opts",void 0),W(this,"source",void 0),this.opts=t,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:n}=this.source,{size:i}=t;let s=n;if(n&&n.length!==i){s=new Float32Array(i);const a=t.elementOffset||0;for(let o=0;o<i;++o)s[o]=n[a+o]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function cK(r){switch(r){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function D0(r){return r.stride||r.size*r.bytesPerElement}function P3(r,e){e.offset&&Mn.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=D0(r),n=e.vertexOffset!==void 0?e.vertexOffset:r.vertexOffset||0,i=e.elementOffset||0,s=n*t+i*r.bytesPerElement+(r.offset||0);return{...e,offset:s,stride:t}}function lK(r,e){const t=P3(r,e);return{high:t,low:{...t,offset:t.offset+r.size*4}}}class uK{constructor(e,t,n){W(this,"gl",void 0),W(this,"id",void 0),W(this,"size",void 0),W(this,"settings",void 0),W(this,"value",void 0),W(this,"doublePrecision",void 0),W(this,"_buffer",void 0),W(this,"state",void 0),this.gl=e,this.id=t.id||"",this.size=t.size||1;const i=t.logicalType||t.type,s=i===5130;let{defaultValue:a}=t;a=Number.isFinite(a)?[a]:a||new Array(this.size).fill(0);let o;s?o=5126:!i&&t.isIndexed?o=e&&Vv(e,gi.ELEMENT_INDEX_UINT32)?5125:5123:o=i||5126;let A=cK(i||o||5126);this.doublePrecision=s,s&&t.fp64===!1&&(A=Float32Array),this.value=null,this.settings={...t,defaultType:A,defaultValue:a,logicalType:i,type:o,size:this.size,bytesPerElement:A.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:t}=this.settings;this._buffer=new ri(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:t}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*D0(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),og.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const n={},i=this.value instanceof Float64Array,s=lK(this.getAccessor(),t||{});return n[e]=new jb(this,s.high),n["".concat(e,"64Low")]=i?new jb(this,s.low):new Float32Array(this.size),n}if(t){const n=P3(this.getAccessor(),t);return{[e]:new jb(this,n)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:n,size:i}=this,s=n*i;if(t&&s&&t.length>=s){const a=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let A=0;A<s;)for(let f=0;f<i;f++){const m=t[A++];m<a[f]&&(a[f]=m),m>o[f]&&(o[f]=m)}e=[a,o]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let n;ArrayBuffer.isView(e)?n={value:e}:e instanceof ri?n={buffer:e}:n=e;const i={...this.settings,...n};if(t.bufferAccessor=i,t.bounds=null,n.constant){let s=n.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!t.constant||!this._areValuesEqual(s,this.value)))return!1;t.externalBuffer=null,t.constant=!0,this.value=s}else if(n.buffer){const s=n.buffer;t.externalBuffer=s,t.constant=!1,this.value=n.value||null;const a=n.value instanceof Float64Array;i.type=n.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(a?2:1),i.stride=D0(i)}else if(n.value){this._checkExternalBuffer(n);let s=n.value;t.externalBuffer=null,t.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=D0(i);const{buffer:a,byteOffset:o}=this;this.doublePrecision&&s instanceof Float64Array&&(s=Fb(s,i));const A=s.byteLength+o+i.stride*2;a.byteLength<A&&a.reallocate(A),a.setAccessor(null),a.subData({data:s,offset:o}),i.type=n.type||a.accessor.type}return!0}updateSubBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.state.bounds=null;const t=this.value,{startOffset:n=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?Fb(t,{size:this.size,startIndex:n,endIndex:i}):t.subarray(n,i),offset:n*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{state:n}=this,i=n.allocatedValue,s=og.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=s;const{buffer:a,byteOffset:o}=this;return a.byteLength<s.byteLength+o&&(a.reallocate(s.byteLength+o),t&&i&&a.subData({data:i instanceof Float64Array?Fb(i,this):i,offset:o})),n.allocatedValue=s,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=t.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));!(t instanceof n)&&this.settings.normalized&&!("normalized"in e)&&Mn.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(t=>(t+128)/255*2-1);case 5122:return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case 5121:return new Float32Array(e).map(t=>t/255);case 5123:return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,n){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return t[n]=e,t;if(!e){let a=s;for(;--a>=0;)t[n+a]=i[a];return t}switch(s){case 4:t[n+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:t[n+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:t[n+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:t[n+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let a=s;for(;--a>=0;)t[n+a]=Number.isFinite(e[a])?e[a]:i[a]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(e[i]!==t[i])return!1;return!0}}const U3=[],R3=[];function O3(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1/0,n=U3;const i={index:-1,data:r,target:[]};return r?typeof r[Symbol.iterator]=="function"?n=r:r.length>0&&(R3.length=r.length,n=R3):n=U3,(e>0||Number.isFinite(t))&&(n=(Array.isArray(n)?n:Array.from(n)).slice(e,t),i.index=e-1),{iterable:n,objectInfo:i}}function D3(r){return r&&r[Symbol.asyncIterator]}function AK(r,e){const{size:t,stride:n,offset:i,startIndices:s,nested:a}=e,o=r.BYTES_PER_ELEMENT,A=n?n/o:t,f=i?i/o:0,m=Math.floor((r.length-f)/A);return(v,x)=>{let{index:B,target:M}=x;if(!s){const q=B*A+f;for(let Y=0;Y<t;Y++)M[Y]=r[q+Y];return M}const U=s[B],N=s[B+1]||m;let Q;if(a){Q=new Array(N-U);for(let q=U;q<N;q++){const Y=q*A+f;M=new Array(t);for(let te=0;te<t;te++)M[te]=r[Y+te];Q[q-U]=M}}else if(A===t)Q=r.subarray(U*t+f,N*t+f);else{Q=new r.constructor((N-U)*t);let q=0;for(let Y=U;Y<N;Y++){const te=Y*A+f;for(let pe=0;pe<t;pe++)Q[q++]=r[te+pe]}}return Q}}const hK=[],k0=[[0,1/0]];function dK(r,e){if(r===k0||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return r;const t=[],n=r.length;let i=0;for(let s=0;s<n;s++){const a=r[s];a[1]<e[0]?(t.push(a),i=s+1):a[0]>e[1]?t.push(a):e=[Math.min(a[0],e[0]),Math.max(a[1],e[1])]}return t.splice(i,0,e),t}function qb(r){const{source:e,target:t,start:n=0,size:i,getData:s}=r,a=r.end||t.length,o=e.length,A=a-n;if(o>A){t.set(e.subarray(0,A),n);return}if(t.set(e,n),!s)return;let f=o;for(;f<A;){const m=s(f,e);for(let v=0;v<i;v++)t[n+f]=m[v]||0,f++}}function fK(r){let{source:e,target:t,size:n,getData:i,sourceStartIndices:s,targetStartIndices:a}=r;if(!Array.isArray(a))return qb({source:e,target:t,size:n,getData:i}),t;let o=0,A=0;const f=i&&((v,x)=>i(v+A,x)),m=Math.min(s.length,a.length);for(let v=1;v<m;v++){const x=s[v]*n,B=a[v]*n;qb({source:e.subarray(o,x),target:t,start:A,end:B,size:n,getData:f}),o=x,A=B}return A<t.length&&qb({source:[],target:t,start:A,size:n,getData:f}),t}const pK={interpolation:{duration:0,easing:r=>r},spring:{stiffness:.05,damping:.5}};function k3(r,e){if(!r)return null;Number.isFinite(r)&&(r={type:"interpolation",duration:r});const t=r.type||"interpolation";return{...pK[t],...e,...r,type:t}}function N3(r,e){const t=e.getBuffer();return t?[t,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function Q3(r){switch(r){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(r,'"'))}}function H3(r){r.push(r.shift())}function Kb(r,e){const{doublePrecision:t,settings:n,value:i,size:s}=r,a=t&&i instanceof Float64Array?2:1;return(n.noAlloc?i.length:e*s)*a}function z3(r){let{buffer:e,numInstances:t,attribute:n,fromLength:i,fromStartIndices:s,getData:a=q=>q}=r;const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,A=n.size*o,f=n.byteOffset,m=n.startIndices,v=s&&m,x=Kb(n,t),B=n.isConstant;if(!v&&i>=x)return;const M=B?n.value:n.getBuffer().getData({srcByteOffset:f});if(n.settings.normalized&&!B){const q=a;a=(Y,te)=>n.normalizeConstant(q(Y,te))}const U=B?(q,Y)=>a(M,Y):(q,Y)=>a(M.subarray(q,q+A),Y),N=e.getData({length:i}),Q=new Float32Array(x);fK({source:N,target:Q,sourceStartIndices:s,targetStartIndices:m,size:A,getData:U}),e.byteLength<Q.byteLength+f&&e.reallocate(Q.byteLength+f),e.subData({data:Q,offset:f})}class Wb extends uK{constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:k0}),W(this,"constant",!1),this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw(){let{clearChangedFlags:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,n=this.settings.transition,i=Array.isArray(t)?e[t.find(s=>e[s])]:e[t];return k3(i,n)}setNeedsUpdate(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.id,t=arguments.length>1?arguments[1]:void 0;if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:n=0,endRow:i=1/0}=t;this.state.updateRanges=dK(this.state.updateRanges,[n,i])}else this.state.updateRanges=k0}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=hK}setNeedsRedraw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.id;this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:n}=this;return n.noAlloc?!1:n.update?(super.allocate(e,t.updateRanges!==k0),!0):!1}updateBuffer(e){let{numInstances:t,data:n,props:i,context:s}=e;if(!this.needsUpdate())return!1;const{state:{updateRanges:a},settings:{update:o,noAlloc:A}}=this;let f=!0;if(o){for(const[m,v]of a)o.call(s,this,{data:n,startRow:m,endRow:v,props:i,numInstances:t});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[m,v]of a){const x=Number.isFinite(m)?this.getVertexOffset(m):0,B=Number.isFinite(v)?this.getVertexOffset(v):A||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:x,endOffset:B})}this._checkAttributeArray()}else f=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),f}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const{state:n,settings:i}=this;if(!e)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===e)return this.clearNeedsUpdate(),!0;if(n.binaryValue=e,this.setNeedsRedraw(),i.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const a=e;Ks(ArrayBuffer.isView(a.value),"invalid ".concat(i.accessor));const o=!!a.size&&a.size!==this.size;return n.binaryAccessor=AK(a.value,{size:a.size||this.size,stride:a.stride,offset:a.offset,startIndices:t,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?e<t.length?t[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},t={};for(const n in e)Object.assign(t,super.getShaderAttributes(n,e[n]));return t}_autoUpdater(e,t){let{data:n,startRow:i,endRow:s,props:a,numInstances:o}=t;if(e.constant)return;const{settings:A,state:f,value:m,size:v,startIndices:x}=e,{accessor:B,transform:M}=A,U=f.binaryAccessor||(typeof B=="function"?B:a[B]);Ks(typeof U=="function",'accessor "'.concat(B,'" is not a function'));let N=e.getVertexOffset(i);const{iterable:Q,objectInfo:q}=O3(n,i,s);for(const Y of Q){q.index++;let te=U(Y,q);if(M&&(te=M.call(this,te)),x){const pe=(q.index<x.length-1?x[q.index+1]:o)-x[q.index];if(te&&Array.isArray(te[0])){let ge=N;for(const ye of te)e._normalizeValue(ye,m,ge),ge+=v}else te&&te.length>v?m.set(te,N):(e._normalizeValue(te,q.target,0),Gj({target:m,source:q.target,start:N,count:pe}));N+=pe*v}else e._normalizeValue(te,m,N),N+=v}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let n=!0;switch(t){case 4:n=n&&Number.isFinite(e[3]);case 3:n=n&&Number.isFinite(e[2]);case 2:n=n&&Number.isFinite(e[1]);case 1:n=n&&Number.isFinite(e[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class gK{constructor(e){let{gl:t,attribute:n,timeline:i}=e;W(this,"gl",void 0),W(this,"type","interpolation"),W(this,"attributeInTransition",void 0),W(this,"settings",void 0),W(this,"attribute",void 0),W(this,"transition",void 0),W(this,"currentStartIndices",void 0),W(this,"currentLength",void 0),W(this,"transform",void 0),W(this,"buffers",void 0),this.gl=t,this.transition=new lg(i),this.attribute=n,this.attributeInTransition=new Wb(t,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=yK(t,n);const s={byteLength:0,usage:35050};this.buffers=[new ri(t,s),new ri(t,s)]}get inProgress(){return this.transition.inProgress}start(e,t){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:n,buffers:i,attribute:s}=this;H3(i);const a={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const o of i)z3({buffer:o,...a});this.currentStartIndices=s.startIndices,this.currentLength=Kb(s,t),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:N3(n,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:t,easing:n}=this.settings,{time:i}=this.transition;let s=i/t;n&&(s=n(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const mK=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function yK(r,e){const t=Q3(e.size);return new bb(r,{vs:mK,defines:{ATTRIBUTE_TYPE:t},varyings:["vCurrent"]})}class _K{constructor(e){let{gl:t,attribute:n,timeline:i}=e;W(this,"gl",void 0),W(this,"type","spring"),W(this,"attributeInTransition",void 0),W(this,"settings",void 0),W(this,"attribute",void 0),W(this,"transition",void 0),W(this,"currentStartIndices",void 0),W(this,"currentLength",void 0),W(this,"texture",void 0),W(this,"framebuffer",void 0),W(this,"transform",void 0),W(this,"buffers",void 0),this.gl=t,this.type="spring",this.transition=new lg(i),this.attribute=n,this.attributeInTransition=new Wb(t,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=bK(t),this.framebuffer=wK(t,this.texture),this.transform=vK(t,n,this.framebuffer);const s={byteLength:0,usage:35050};this.buffers=[new ri(t,s),new ri(t,s),new ri(t,s)]}get inProgress(){return this.transition.inProgress}start(e,t){const{gl:n,buffers:i,attribute:s}=this,a={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const o of i)z3({buffer:o,...a});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=Kb(s,t),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:N3(n,s)}})}update(){const{buffers:e,transform:t,framebuffer:n,transition:i}=this;if(!i.update())return!1;const a=this.settings;return t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:a.stiffness,damping:a.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),H3(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),a0(n)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function vK(r,e,t){const n=Q3(e.size);return new bb(r,{framebuffer:t,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:n},varyings:["vNext"]})}function bK(r){return new Ia(r,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function wK(r,e){return new bs(r,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const xK={interpolation:gK,spring:_K};class BK{constructor(e,t){let{id:n,timeline:i}=t;W(this,"id",void 0),W(this,"isSupported",void 0),W(this,"gl",void 0),W(this,"timeline",void 0),W(this,"transitions",void 0),W(this,"needsRedraw",void 0),W(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=bb.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update(e){let{attributes:t,transitions:n,numInstances:i}=e;this.numInstances=i||1;for(const s in t){const a=t[s],o=a.getTransitionSetting(n);o&&this._updateAttribute(s,a,o)}for(const s in this.transitions){const a=t[s];(!a||!a.getTransitionSetting(n))&&this._removeTransition(s)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const n=this.transitions[t];n.inProgress&&(e[t]=n.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,t,n){const i=this.transitions[e];let s=!i||i.type!==n.type;if(s){if(!this.isSupported){Mn.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const a=xK[n.type];a?this.transitions[e]=new a({attribute:t,timeline:this.timeline,gl:this.gl}):(Mn.error("unsupported transition type '".concat(n.type,"'"))(),s=!1)}(s||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(n,this.numInstances))}}const G3="attributeManager.invalidate",CK="attributeManager.updateStart",EK="attributeManager.updateEnd",SK="attribute.updateStart",TK="attribute.allocate",IK="attribute.updateEnd";class LK{constructor(e){let{id:t="attribute-manager",stats:n,timeline:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};W(this,"id",void 0),W(this,"gl",void 0),W(this,"attributes",void 0),W(this,"updateTriggers",void 0),W(this,"needsRedraw",void 0),W(this,"userData",void 0),W(this,"stats",void 0),W(this,"attributeTransitionManager",void 0),W(this,"mergeBoundsMemoized",ig(Uj)),this.id=t,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new BK(e,{id:"".concat(t,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const t of e)this.attributes[t]!==void 0&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const n=this._invalidateTrigger(e,t);ao(G3,this,e,n)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);ao(G3,this,"all")}update(e){let{data:t,numInstances:n,startIndices:i=null,transitions:s,props:a={},buffers:o={},context:A={}}=e,f=!1;ao(CK,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const m in this.attributes){const v=this.attributes[m],x=v.settings.accessor;v.startIndices=i,v.numInstances=n,a[m]&&Mn.removed("props.".concat(m),"data.attributes.".concat(m))(),v.setExternalBuffer(o[m])||v.setBinaryValue(typeof x=="string"?o[x]:void 0,t.startIndices)||typeof x=="string"&&!o[x]&&v.setConstantValue(a[x])||v.needsUpdate()&&(f=!0,this._updateAttribute({attribute:v,numInstances:n,data:t,props:a,context:A})),this.needsRedraw=this.needsRedraw||v.needsRedraw()}f&&ao(EK,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:s})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return this.attributes}getBounds(e){const t=e.map(n=>{var i;return(i=this.attributes[n])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(t)}getChangedAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearChangedFlags:!1};const{attributes:t,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const s in t){const a=t[s];a.needsRedraw(e)&&!n.hasAttribute(s)&&(i[s]=a)}return i}getShaderAttributes(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e||(e=this.getAttributes());const n={};for(const i in e)t[i]||Object.assign(n,e[i].getShaderAttributes());return n}_add(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};for(const n in e){const i=e[n];this.attributes[n]=this._createAttribute(n,i,t)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,t,n){const i={...t,id:e,size:t.isIndexed&&1||t.size||1,divisor:n.instanced?1:t.divisor||0};return new Wb(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:n,updateTriggers:i}=this,s=i[e];return s&&s.forEach(a=>{const o=n[a];o&&o.setNeedsUpdate(o.id,t)}),s}_updateAttribute(e){const{attribute:t,numInstances:n}=e;if(ao(SK,t),t.constant){t.setConstantValue(t.value);return}t.allocate(n)&&ao(TK,t,n),t.updateBuffer(e)&&(this.needsRedraw=!0,ao(IK,t,n))}}class FK extends lg{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:n,duration:i,easing:s}}=this,a=s(e/i);this._value=m0(t,n,a)}}const V3=1e-5;function j3(r,e,t,n,i){const s=e-r,o=(t-e)*i,A=-s*n;return o+A+s+e}function MK(r,e,t,n,i){if(Array.isArray(t)){const s=[];for(let a=0;a<t.length;a++)s[a]=j3(r[a],e[a],t[a],n,i);return s}return j3(r,e,t,n,i)}function q3(r,e){if(Array.isArray(r)){let t=0;for(let n=0;n<r.length;n++){const i=r[n]-e[n];t+=i*i}return Math.sqrt(t)}return Math.abs(r-e)}class PK extends lg{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:n,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:a=e}=this;let o=MK(s,a,t,n,i);const A=q3(o,t),f=q3(o,a);A<V3&&f<V3&&(o=t,this.end()),this._prevValue=a,this._currValue=o}}const UK={interpolation:FK,spring:PK};class RK{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,n,i){const{transitions:s}=this;if(s.has(e)){const A=s.get(e),{value:f=A.settings.fromValue}=A;t=f,this.remove(e)}if(i=k3(i),!i)return;const a=UK[i.type];if(!a){Mn.error("unsupported transition type '".concat(i.type,"'"))();return}const o=new a(this.timeline);o.start({...i,fromValue:t,toValue:n}),s.set(e,o)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,n]of this.transitions)n.update(),e[t]=n.value,n.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function OK(r){const e=r[TA];for(const t in e){const n=e[t],{validate:i}=n;if(i&&!i(r[t],n))throw new Error("Invalid prop ".concat(t,": ").concat(r[t]))}}function DK(r,e){const t=K3({newProps:r,oldProps:e,propTypes:r[TA],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),n=NK(r,e);let i=!1;return n||(i=QK(r,e)),{dataChanged:n,propsChanged:t,updateTriggersChanged:i,extensionsChanged:HK(r,e),transitionsChanged:kK(r,e)}}function kK(r,e){if(!r.transitions)return!1;const t={},n=r[TA];let i=!1;for(const s in r.transitions){const a=n[s],o=a&&a.type;(o==="number"||o==="color"||o==="array")&&$b(r[s],e[s],a)&&(t[s]=!0,i=!0)}return i?t:!1}function K3(r){let{newProps:e,oldProps:t,ignoreProps:n={},propTypes:i={},triggerName:s="props"}=r;if(t===e)return!1;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return"".concat(s," changed shallowly");for(const a of Object.keys(e))if(!(a in n)){if(!(a in t))return"".concat(s,".").concat(a," added");const o=$b(e[a],t[a],i[a]);if(o)return"".concat(s,".").concat(a," ").concat(o)}for(const a of Object.keys(t))if(!(a in n)){if(!(a in e))return"".concat(s,".").concat(a," dropped");if(!Object.hasOwnProperty.call(e,a)){const o=$b(e[a],t[a],i[a]);if(o)return"".concat(s,".").concat(a," ").concat(o)}}return!1}function $b(r,e,t){let n=t&&t.equal;return n&&!n(r,e,t)||!n&&(n=r&&e&&r.equals,n&&!n.call(r,e))?"changed deeply":!n&&e!==r?"changed shallowly":null}function NK(r,e){if(e===null)return"oldProps is null, initial diff";let t=!1;const{dataComparator:n,_dataDiff:i}=r;return n?n(r.data,e.data)||(t="Data comparator detected a change"):r.data!==e.data&&(t="A new data container was supplied"),t&&i&&(t=i(r.data,e.data)||t),t}function QK(r,e){if(e===null)return{all:!0};if("all"in r.updateTriggers&&W3(r,e,"all"))return{all:!0};const t={};let n=!1;for(const i in r.updateTriggers)i!=="all"&&W3(r,e,i)&&(t[i]=!0,n=!0);return n?t:!1}function HK(r,e){if(e===null)return!0;const t=e.extensions,{extensions:n}=r;if(n===t)return!1;if(!t||!n||n.length!==t.length)return!0;for(let i=0;i<n.length;i++)if(!n[i].equals(t[i]))return!0;return!1}function W3(r,e,t){let n=r.updateTriggers[t];n=n??{};let i=e.updateTriggers[t];return i=i??{},K3({oldProps:i,newProps:n,triggerName:t})}const zK="count(): argument not an object",GK="count(): argument not a container";function VK(r){if(!qK(r))throw new Error(zK);if(typeof r.count=="function")return r.count();if(Number.isFinite(r.size))return r.size;if(Number.isFinite(r.length))return r.length;if(jK(r))return Object.keys(r).length;throw new Error(GK)}function jK(r){return r!==null&&typeof r=="object"&&r.constructor===Object}function qK(r){return r!==null&&typeof r=="object"}function KK(r,e){if(!e)return r;const t={...r,...e};if("defines"in e&&(t.defines={...r.defines,...e.defines}),"modules"in e&&(t.modules=(r.modules||[]).concat(e.modules),e.modules.some(n=>n.name==="project64"))){const n=t.modules.findIndex(i=>i.name==="project32");n>=0&&t.modules.splice(n,1)}if("inject"in e)if(!r.inject)t.inject=e.inject;else{const n={...r.inject};for(const i in e.inject)n[i]=(n[i]||"")+e.inject[i];t.inject=n}return t}const WK={10241:9987,10240:9729,10242:33071,10243:33071},Xb={};function $K(r,e,t,n){if(t instanceof Ia)return t;t.constructor&&t.constructor.name!=="Object"&&(t={data:t});let i=null;t.compressed&&(i={10241:t.data.length>1?9985:9729});const s=new Ia(e,{...t,parameters:{...WK,...i,...n}});return Xb[s.id]=r,s}function XK(r,e){!e||!(e instanceof Ia)||Xb[e.id]===r&&(e.delete(),delete Xb[e.id])}const JK={boolean:{validate(r,e){return!0},equal(r,e,t){return!!r==!!e}},number:{validate(r,e){return Number.isFinite(r)&&(!("max"in e)||r<=e.max)&&(!("min"in e)||r>=e.min)}},color:{validate(r,e){return e.optional&&!r||Jb(r)&&(r.length===3||r.length===4)},equal(r,e,t){return Ql(r,e,1)}},accessor:{validate(r,e){const t=N0(r);return t==="function"||t===N0(e.value)},equal(r,e,t){return typeof e=="function"?!0:Ql(r,e,1)}},array:{validate(r,e){return e.optional&&!r||Jb(r)},equal(r,e,t){const{compare:n}=t,i=Number.isInteger(n)?n:n?1:0;return n?Ql(r,e,i):r===e}},object:{equal(r,e,t){if(t.ignore)return!0;const{compare:n}=t,i=Number.isInteger(n)?n:n?1:0;return n?Ql(r,e,i):r===e}},function:{validate(r,e){return e.optional&&!r||typeof r=="function"},equal(r,e,t){return!t.compare&&t.ignore!==!1||r===e}},data:{transform:(r,e,t)=>{const{dataTransform:n}=t.props;return n&&r?n(r):r}},image:{transform:(r,e,t)=>{const n=t.context;return!n||!n.gl?null:$K(t.id,n.gl,r,{...e.parameters,...t.props.textureParameters})},release:(r,e,t)=>{XK(t.id,r)}}};function YK(r){const e={},t={},n={};for(const[i,s]of Object.entries(r)){const a=s==null?void 0:s.deprecatedFor;if(a)n[i]=Array.isArray(a)?a:[a];else{const o=ZK(i,s);e[i]=o,t[i]=o.value}}return{propTypes:e,defaultProps:t,deprecatedProps:n}}function ZK(r,e){switch(N0(e)){case"object":return Ag(r,e);case"array":return Ag(r,{type:"array",value:e,compare:!1});case"boolean":return Ag(r,{type:"boolean",value:e});case"number":return Ag(r,{type:"number",value:e});case"function":return Ag(r,{type:"function",value:e,compare:!0});default:return{name:r,type:"unknown",value:e}}}function Ag(r,e){return"type"in e?{name:r,...JK[e.type],...e}:"value"in e?{name:r,type:N0(e.value),...e}:{name:r,type:"object",value:e}}function Jb(r){return Array.isArray(r)||ArrayBuffer.isView(r)}function N0(r){return Jb(r)?"array":r===null?"null":typeof r}function eW(r,e){let t;for(let s=e.length-1;s>=0;s--){const a=e[s];"extensions"in a&&(t=a.extensions)}const n=Yb(r.constructor,t),i=Object.create(n);i[M0]=r,i[Uh]={},i[IA]={};for(let s=0;s<e.length;++s){const a=e[s];for(const o in a)i[o]=a[o]}return Object.freeze(i),i}const tW="_mergedDefaultProps";function Yb(r,e){let t=tW;if(e)for(const i of e){const s=i.constructor;s&&(t+=":".concat(s.extensionName||s.name))}const n=$3(r,t);return n||(r[t]=rW(r,e||[]))}function rW(r,e){if(!r.prototype)return null;const n=Object.getPrototypeOf(r),i=Yb(n),s=$3(r,"defaultProps")||{},a=YK(s),o=Object.assign(Object.create(null),i,a.defaultProps),A=Object.assign(Object.create(null),i==null?void 0:i[TA],a.propTypes),f=Object.assign(Object.create(null),i==null?void 0:i[Pb],a.deprecatedProps);for(const m of e){const v=Yb(m.constructor);v&&(Object.assign(o,v),Object.assign(A,v[TA]),Object.assign(f,v[Pb]))}return nW(o,r),sW(o,A),iW(o,f),o[TA]=A,o[Pb]=f,e.length===0&&!Zb(r,"_propTypes")&&(r._propTypes=A),o}function nW(r,e){const t=aW(e);Object.defineProperties(r,{id:{writable:!0,value:t}})}function iW(r,e){for(const t in e)Object.defineProperty(r,t,{enumerable:!1,set(n){const i="".concat(this.id,": ").concat(t);for(const s of e[t])Zb(this,s)||(this[s]=n);Mn.deprecated(i,e[t].join("/"))()}})}function sW(r,e){const t={},n={};for(const i in e){const s=e[i],{name:a,value:o}=s;s.async&&(t[a]=o,n[a]=oW(a))}r[Zd]=t,r[Uh]={},Object.defineProperties(r,n)}function oW(r){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||D3(e)?this[Uh][r]=e:this[IA][r]=e},get(){if(this[IA]){if(r in this[IA])return this[IA][r]||this[Zd][r];if(r in this[Uh]){const e=this[M0]&&this[M0].internalState;if(e&&e.hasAsyncProp(r))return e.getAsyncProp(r)||this[Zd][r]}}return this[Zd][r]}}}function Zb(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function $3(r,e){return Zb(r,e)&&r[e]}function aW(r){const e=r.componentName;return e||Mn.warn("".concat(r.name,".componentName not specified"))(),e||r.name}let cW=0;class ew{constructor(){W(this,"id",void 0),W(this,"props",void 0),W(this,"count",void 0);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.props=eW(this,t),this.id=this.props.id,this.count=cW++}clone(e){const{props:t}=this,n={};for(const i in t[Zd])i in t[IA]?n[i]=t[IA][i]:i in t[Uh]&&(n[i]=t[Uh][i]);return new this.constructor({...t,...n,...e})}}W(ew,"componentName","Component"),W(ew,"defaultProps",{});const lW=Object.freeze({});class uW{constructor(e){W(this,"component",void 0),W(this,"onAsyncPropUpdated",void 0),W(this,"asyncProps",void 0),W(this,"oldProps",void 0),W(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||lW}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return!!(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){this.component=e[M0]||this.component;const t=e[IA]||{},n=e[Uh]||e,i=e[Zd]||{};for(const s in t){const a=t[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,a),t[s]=this.getAsyncProp(s)}for(const s in n){const a=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,a)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if(typeof t=="string"&&(t=this._fetch(e,t)),t instanceof Promise){this._watchPromise(e,t);return}if(D3(t)){this._resolveAsyncIterable(e,t);return}this._setPropValue(e,t)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const n=this.asyncProps[e];return t===n.resolvedValue||t===n.lastValue?!1:(n.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const n=this.asyncProps[e];n&&(t=this._postProcessValue(n,t),n.resolvedValue=t,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(e,t,n){const i=this.asyncProps[e];i&&n>=i.resolvedLoadCount&&t!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=t,i.resolvedLoadCount=n,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const n=this.asyncProps[e];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;t.then(s=>{this.component&&(s=this._postProcessValue(n,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,t){if(e!=="data"){this._setPropValue(e,t);return}const n=this.asyncProps[e];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let s=[],a=0;for await(const o of t){if(!this.component)return;const{dataTransform:A}=this.component.props;A?s=A(o,s):s=s.concat(o),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:a,endRow:s.length}]}),a=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,t){const n=e.type;return n&&this.component&&(n.release&&n.release(e.resolvedValue,n,this.component),n.transform)?n.transform(t,n,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const i=this.component&&this.component.props[TA];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}class AW extends uW{constructor(e){let{attributeManager:t,layer:n}=e;super(n),W(this,"attributeManager",void 0),W(this,"needsRedraw",void 0),W(this,"needsUpdate",void 0),W(this,"subLayers",void 0),W(this,"usesPickingColorCache",void 0),W(this,"hasPickingBuffer",void 0),W(this,"changeFlags",void 0),W(this,"viewport",void 0),W(this,"uniformTransitions",void 0),W(this,"propsInTransition",void 0),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,t){const n=this.layer,i=n==null?void 0:n.props.fetch;return i?i(t,{propName:e,layer:n}):super._fetch(e,t)}_onResolve(e,t){const n=this.layer;if(n){const i=n.props.onDataLoad;e==="data"&&i&&i(t,{propName:e,layer:n})}}_onError(e,t){const n=this.layer;n&&n.raiseError(t,"loading ".concat(e," of ").concat(this.layer))}}const hW="layer.changeFlag",dW="layer.initialize",fW="layer.update",pW="layer.finalize",gW="layer.matched",X3=2**24-1,mW=Object.freeze([]),yW=ig(r=>{let{oldViewport:e,viewport:t}=r;return e.equals(t)});let zl=new Uint8ClampedArray(0);const _W={data:{type:"data",value:mW,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:r=>r&&r.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(r,e)=>{let{propName:t,layer:n,loaders:i,loadOptions:s,signal:a}=e;const{resourceManager:o}=n.context;if(s=s||n.getLoadOptions(),i=i||n.props.loaders,a){var A;s={...s,fetch:{...(A=s)===null||A===void 0?void 0:A.fetch,signal:a}}}let f=o.contains(r);return!f&&!s&&(o.add({resourceId:r,data:wA(r,i),persistent:!1}),f=!0),f?o.subscribe({resourceId:r,onChange:m=>{var v;return(v=n.internalState)===null||v===void 0?void 0:v.reloadAsyncProp(t,m)},consumerId:n.id,requestId:t}):wA(r,i,s)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Tn.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:r=>{let{layerIndex:e}=r;return[0,-e*100]}},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class rf extends ew{constructor(){super(...arguments),W(this,"internalState",null),W(this,"lifecycle",Yd.NO_STATE),W(this,"context",void 0),W(this,"state",void 0),W(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Ks(this.internalState);const t=this.internalState.viewport||this.context.viewport,n=c3(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,a]=e3(n,t.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,a]}unproject(e){return Ks(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){Ks(this.internalState);const n=this.internalState.viewport||this.context.viewport;return Qj(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...t})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const t of this.getModels())t.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Tn.DEFAULT||e===Tn.LNGLAT||e===Tn.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){Ks(e instanceof Uint8Array);const[t,n,i]=e;return t+n*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:VK(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const t of this.props.extensions)e=KK(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:n}=e.changeFlags;if(n&&t)if(Array.isArray(n))for(const i of n)t.invalidateAll(i);else t.invalidateAll();if(t){const{props:i}=e,s=this.internalState.hasPickingBuffer,a=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(o=>o.getNeedsPickingBuffer.call(this,o));if(s!==a){this.internalState.hasPickingBuffer=a;const{pickingColors:o,instancePickingColors:A}=t.attributes,f=o||A;f&&(a&&f.constant&&(f.constant=!1,t.invalidate(f.id)),!f.value&&!a&&(f.constant=!0,f.value=[0,0,0]))}}}finalizeState(e){for(const n of this.getModels())n.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e)}getPickingInfo(e){let{info:t,mode:n,sourceLayer:i}=e;const{index:s}=t;return s>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[s]),t}raiseError(e,t){var n,i;if(t&&(e=new Error("".concat(t,": ").concat(e.message),{cause:e})),!((n=(i=this.props).onError)!==null&&n!==void 0&&n.call(i,e))){var s,a;(s=this.context)===null||s===void 0||(a=s.onError)===null||a===void 0||a.call(s,e,this)}}getNeedsRedraw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,(!t||!yW({oldViewport:t,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"all";const t=this.getAttributeManager();t&&(e==="all"?t.invalidateAll():t.invalidate(e))}updateAttributes(e){for(const t of this.getModels())this._setModelAttributes(t,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,n=this.getNumInstances(),i=this.getStartIndices();e.update({data:t.data,numInstances:n,startIndices:i,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),n=Object.create(this.props);for(const i in t)Object.defineProperty(n,i,{value:t[i]});return n}return this.props}calculateInstancePickingColors(e,t){let{numInstances:n}=t;if(e.constant)return;const i=Math.floor(zl.length/3);if(this.internalState.usesPickingColorCache=!0,i<n){n>X3&&Mn.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),zl=og.allocate(zl,n,{size:3,copy:!0,maxCount:Math.max(n,X3)});const s=Math.floor(zl.length/3),a=[];for(let o=i;o<s;o++)this.encodePickingColor(o,a),zl[o*3+0]=a[0],zl[o*3+1]=a[1],zl[o*3+2]=a[2]}e.value=zl.subarray(0,n*3)}_setModelAttributes(e,t){const n=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=n.getShaderAttributes(t,i);e.setAttributes(s)}disablePickingIndex(e){const t=this.props.data;if(!("attributes"in t)){this._disablePickingIndex(e);return}const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,s=n||i,a=s&&t.attributes&&t.attributes[s.id];if(a&&a.value){const o=a.value,A=this.encodePickingColor(e);for(let f=0;f<t.length;f++){const m=s.getVertexOffset(f);o[m]===A[0]&&o[m+1]===A[1]&&o[m+2]===A[2]&&this._disablePickingIndex(f)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:n}=this.getAttributeManager().attributes,i=t||n;if(!i)return;const s=i.getVertexOffset(e),a=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(a-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,n=e||t;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==zl.buffer&&(n.value=zl.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){Ks(!this.internalState),Ks(Number.isFinite(this.props.coordinateSystem)),ao(dW,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new AW({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Mn.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new RK(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){ao(gW,this,this===e);const{state:t,internalState:n}=e;this!==e&&(this.internalState=n,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(ao(fW,this,e),!e)return;const t=this.props,n=this.context,i=this.internalState,s=n.viewport,a=this._updateUniformTransition();i.propsInTransition=a,n.viewport=i.viewport||s,this.props=a;try{const o=this._getUpdateParams(),A=this.getModels();if(n.gl)this.updateState(o);else try{this.updateState(o)}catch{}for(const m of this.props.extensions)m.updateState.call(this,o,m);const f=this.getModels()[0]!==A[0];this._postUpdate(o,f)}finally{n.viewport=s,this.props=t,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){ao(pW,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer(e){let{moduleParameters:t=null,uniforms:n={},parameters:i={}}=e;this._updateAttributeTransition();const s=this.props,a=this.context;this.props=this.internalState.propsInTransition||s;const o=this.props.opacity;n.opacity=Math.pow(o,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:A}=this.props,f=A&&A(n)||[0,0];Cu(a.gl,{polygonOffset:f}),Dc(a.gl,i,()=>{const m={moduleParameters:t,uniforms:n,parameters:i,context:a};for(const v of this.props.extensions)v.draw.call(this,m,v);this.draw(m)})}finally{this.props=s}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const a=e[i],o=t[i];a&&Array.isArray(o)&&(t.dataChanged=Array.isArray(a)?o.concat(a):a,s=!0);default:t[i]||(t[i]=e[i],s=!0)}s&&ao(hW,this,i,e)}const n=!!(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=n,t.somethingChanged=n||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){const n=DK(e,t);if(n.updateTriggersChanged)for(const s in n.updateTriggersChanged)n.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(n.transitionsChanged)for(const s in n.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,t[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(n)}validateProps(){OK(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={pickingSelectedColor:e.picked?e.color:null},{highlightColor:n}=this.props;e.picked&&typeof n=="function"&&(t.pickingHighlightColor=n(e)),this.setModuleParameters(t),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new LK(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:n,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s==null||s.setInstanceCount(this.getNumInstances());const{autoHighlight:a,highlightedObjectIndex:o,highlightColor:A}=n;if(t||i.autoHighlight!==a||i.highlightedObjectIndex!==o||i.highlightColor!==A){const f={};a||(f.pickingSelectedColor=null),Array.isArray(A)&&(f.pickingHighlightColor=A),(t||o!==i.highlightedObjectIndex)&&(f.pickingSelectedColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setModuleParameters(f)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),i=n?n.getNeedsRedraw(e):!1;if(t=t||i,t)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}W(rf,"defaultProps",_W),W(rf,"layerName","Layer");const vW="compositeLayer.renderLayers";class J3 extends rf{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo(e){let{info:t}=e;const{object:n}=t;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(t.object=n.__source.object,t.index=n.__source.index),t}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){const{_subLayerProps:n}=this.props;return n&&n[e]&&n[e].type||t}getSubLayerRow(e,t,n){return e.__source={parent:this,object:t,index:n},e}getSubLayerAccessor(e){if(typeof e=="function"){const t={index:-1,data:this.props.data,target:[]};return(n,i)=>n&&n.__source?(t.index=n.__source.index,e(n.__source.object,t)):e(n,i)}return e}getSubLayerProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var t;const{opacity:n,pickable:i,visible:s,parameters:a,getPolygonOffset:o,highlightedObjectIndex:A,autoHighlight:f,highlightColor:m,coordinateSystem:v,coordinateOrigin:x,wrapLongitude:B,positionFormat:M,modelMatrix:U,extensions:N,fetch:Q,operation:q,_subLayerProps:Y}=this.props,te={id:"",updateTriggers:{},opacity:n,pickable:i,visible:s,parameters:a,getPolygonOffset:o,highlightedObjectIndex:A,autoHighlight:f,highlightColor:m,coordinateSystem:v,coordinateOrigin:x,wrapLongitude:B,positionFormat:M,modelMatrix:U,extensions:N,fetch:Q,operation:q},pe=Y&&e.id&&Y[e.id],ge=pe&&pe.updateTriggers,ye=e.id||"sublayer";if(pe){const fe=this.props[TA],Oe=e.type?e.type._propTypes:{};for(const Fe in pe){const oe=Oe[Fe]||fe[Fe];oe&&oe.type==="accessor"&&(pe[Fe]=this.getSubLayerAccessor(pe[Fe]))}}Object.assign(te,e,pe),te.id="".concat(this.props.id,"-").concat(ye),te.updateTriggers={all:(t=this.props.updateTriggers)===null||t===void 0?void 0:t.all,...e.updateTriggers,...ge};for(const fe of N){const Oe=fe.getSubLayerProps.call(this,fe);Oe&&Object.assign(te,Oe,{updateTriggers:Object.assign(te.updateTriggers,Oe.updateTriggers)})}return te}_updateAutoHighlight(e){for(const t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,t){let n=this.internalState.subLayers;const i=!n||this.needsUpdate();if(i){const s=this.renderLayers();n=P0(s,Boolean),this.internalState.subLayers=n}ao(vW,this,i,n);for(const s of n)s.parent=this}}W(J3,"layerName","CompositeLayer");const tw=512,bW=Math.PI/180;function wW(r){let{map:e,gl:t,deck:n}=r;if(e.__deck)return e.__deck;const i=n==null?void 0:n.props._customRender,s=n==null?void 0:n.props.onLoad,a=BW({...n==null?void 0:n.props,_customRender:()=>{e.triggerRepaint(),i==null||i("")}});let o;return(!n||n.props.gl===t)&&(Object.assign(a,{gl:t,width:null,height:null,touchAction:"unset",viewState:rw(e)}),n!=null&&n.isInitialized?Y3(n,e):a.onLoad=()=>{s==null||s(),Y3(o,e)}),n?(o=n,n.setProps(a),n.userData.isExternal=!0):(o=new Vb(a),e.on("remove",()=>{xW(e)})),o.userData.mapboxLayers=new Set,e.__deck=o,e.on("render",()=>{o.isInitialized&&LW(o,e)}),o}function Y3(r,e){const t=()=>{r.isInitialized?FW(r,e):e.off("move",t)};e.on("move",t)}function xW(r){var e;(e=r.__deck)===null||e===void 0||e.finalize(),r.__deck=null}function BW(r){return{...r,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...r.parameters},views:r.views||[new Db({id:"mapbox"})]}}function CW(r,e){r.userData.mapboxLayers.add(e),nw(r)}function EW(r,e){r.userData.mapboxLayers.delete(e),nw(r)}function SW(r,e){nw(r)}function TW(r,e,t){let{currentViewport:n}=r.userData,i=!1;n||(n=Z3(r,e,!0),r.userData.currentViewport=n,i=!0),r.isInitialized&&r._drawLayers("mapbox-repaint",{viewports:[n],layerFilter:s=>{let{layer:a}=s;return t.id===a.id||a.props.operation.includes("terrain")},clearStack:i,clearCanvas:!1})}function rw(r){var e;const{lng:t,lat:n}=r.getCenter(),i={longitude:(t+540)%360-180,latitude:n,zoom:r.getZoom(),bearing:r.getBearing(),pitch:r.getPitch(),padding:r.getPadding(),repeat:r.getRenderWorldCopies()};return(e=r.getTerrain)!==null&&e!==void 0&&e.call(r)&&IW(r,i),i}function IW(r,e){if(r.getFreeCameraOptions){const{position:t}=r.getFreeCameraOptions();if(!t||t.z===void 0)return;const n=r.transform.height,{longitude:i,latitude:s,pitch:a}=e,o=t.x*tw,A=(1-t.y)*tw,f=t.z*tw,m=sg([i,s]),v=o-m[0],x=A-m[1],B=Math.sqrt(v*v+x*x),M=a*bW,U=1.5*n,N=M<.001?U*Math.cos(M)/f:U*Math.sin(M)/B;e.zoom=Math.log2(N);const Q=U*Math.cos(M)/N,q=f-Q;e.position=[0,0,q/L0(s)]}else typeof r.transform.elevation=="number"&&(e.position=[0,0,r.transform.elevation])}function Z3(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return new Ph({id:"mapbox",x:0,y:0,width:r.width,height:r.height,...rw(e),nearZMultiplier:t?.02:.1,nearZ:e.transform._nearZ/e.transform.height,farZ:e.transform._farZ/e.transform.height})}function LW(r,e){const{mapboxLayers:t,isExternal:n}=r.userData;if(n){const i=Array.from(t,m=>m.id),a=P0(r.props.layers,Boolean).some(m=>m&&!i.includes(m.id));let o=r.getViewports();const A=o.findIndex(m=>m.id==="mapbox"),f=o.length>1||A<0;(a||f)&&(A>=0&&(o=o.slice(),o[A]=Z3(r,e,!1)),r._drawLayers("mapbox-repaint",{viewports:o,layerFilter:m=>(!r.props.layerFilter||r.props.layerFilter(m))&&(m.viewport.id!=="mapbox"||!i.includes(m.layer.id)),clearCanvas:!1}))}r.userData.currentViewport=null}function FW(r,e){r.setProps({viewState:rw(e)}),r.needsRedraw({clearRedrawFlags:!0})}function nw(r){if(r.userData.isExternal)return;const e=[];r.userData.mapboxLayers.forEach(t=>{const n=t.props.type,i=new n(t.props);e.push(i)}),r.setProps({layers:e})}class MW{constructor(e){if(W(this,"id",void 0),W(this,"type",void 0),W(this,"renderingMode",void 0),W(this,"map",void 0),W(this,"deck",void 0),W(this,"props",void 0),!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.map=null,this.deck=null,this.props=e}onAdd(e,t){this.map=e,this.deck=wW({map:e,gl:t,deck:this.props.deck}),CW(this.deck,this)}onRemove(){this.deck&&EW(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&SW(this.deck)}render(){TW(this.deck,this.map,this)}}const PW=`#define SHADER_NAME point-cloud-layer-vertex-shader

attribute vec3 positions;
attribute vec3 instanceNormals;
attribute vec4 instanceColors;
attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusPixels;
uniform int sizeUnits;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.normal = project_normal(instanceNormals);
  unitPosition = positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;
  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);
  DECKGL_FILTER_SIZE(offset, geometry);

  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
  vColor = vec4(lightColor, instanceColors.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,UW=`#define SHADER_NAME point-cloud-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition);

  if (distToCenter > 1.0) {
    discard;
  }

  gl_FragColor = vColor;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,eI=[0,0,0,255],tI=[0,0,1],RW={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:r=>r.position},getNormal:{type:"accessor",value:tI},getColor:{type:"accessor",value:eI},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};function OW(r){const{header:e,attributes:t}=r;!e||!t||(r.length=e.vertexCount,t.POSITION&&(t.instancePositions=t.POSITION),t.NORMAL&&(t.instanceNormals=t.NORMAL),t.COLOR_0&&(t.instanceColors=t.COLOR_0))}class iw extends rf{getShaders(){return super.getShaders({vs:PW,fs:UW,modules:[Ub,lV,Rb]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:tI},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:eI}})}updateState(e){const{changeFlags:t,props:n}=e;if(super.updateState(e),t.extensionsChanged){var i;const{gl:s}=this.context;(i=this.state.model)===null||i===void 0||i.delete(),this.state.model=this._getModel(s),this.getAttributeManager().invalidateAll()}t.dataChanged&&OW(n.data)}draw(e){let{uniforms:t}=e;const{pointSize:n,sizeUnits:i}=this.props;this.state.model.setUniforms(t).setUniforms({sizeUnits:Lv[i],radiusPixels:n}).draw()}_getModel(e){const t=[];for(let n=0;n<3;n++){const i=n/3*Math.PI*2;t.push(Math.cos(i)*2,Math.sin(i)*2,0)}return new qd(e,{...this.getShaders(),id:this.props.id,geometry:new ng({drawMode:4,attributes:{positions:new Float32Array(t)}}),isInstanced:!0})}}W(iw,"layerName","PointCloudLayer"),W(iw,"defaultProps",RW);const Pa={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};new ut,new ut;const hg=new ut,rI=new ut;class dg{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;W(this,"center",void 0),W(this,"radius",void 0),this.radius=-0,this.center=new ut,this.fromCenterRadius(e,t)}fromCenterRadius(e,t){return this.center.from(e),this.radius=t,this}fromCornerPoints(e,t){return t=hg.from(t),this.center=new ut().from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new dg(this.center,this.radius)}union(e){const t=this.center,n=this.radius,i=e.center,s=e.radius,a=hg.copy(i).subtract(t),o=a.magnitude();if(n>=o+s)return this.clone();if(s>=o+n)return e.clone();const A=(n+o+s)*.5;return rI.copy(a).scale((-n+A)/o).add(t),this.center.copy(rI),this.radius=A,this}expand(e){const n=hg.from(e).subtract(this.center).magnitude();return n>this.radius&&(this.radius=n),this}transform(e){this.center.transform(e);const t=_G(hg,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}distanceSquaredTo(e){const t=this.distanceTo(e);return t*t}distanceTo(e){const n=hg.from(e).subtract(this.center);return Math.max(0,n.len()-this.radius)}intersectPlane(e){const t=this.center,n=this.radius,s=e.normal.dot(t)+e.distance;return s<-n?Pa.OUTSIDE:s<n?Pa.INTERSECTING:Pa.INSIDE}}const DW=new ut,kW=new ut,Q0=new ut,H0=new ut,z0=new ut,NW=new ut,QW=new ut,Mu={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class fg{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0,0,0,0,0,0,0];W(this,"center",void 0),W(this,"halfAxes",void 0),this.center=new ut().from(e),this.halfAxes=new zi(t)}get halfSize(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new ut(e).len(),new ut(t).len(),new ut(n).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),i=new ut(e).normalize(),s=new ut(t).normalize(),a=new ut(n).normalize();return new eg().fromMatrix3(new zi([...i,...s,...a]))}fromCenterHalfSizeQuaternion(e,t,n){const i=new eg(n),s=new zi().fromQuaternion(i);return s[0]=s[0]*t[0],s[1]=s[1]*t[0],s[2]=s[2]*t[0],s[3]=s[3]*t[1],s[4]=s[4]*t[1],s[5]=s[5]*t[1],s[6]=s[6]*t[2],s[7]=s[7]*t[2],s[8]=s[8]*t[2],this.center=new ut().from(e),this.halfAxes=s,this}clone(){return new fg(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new dg;const t=this.halfAxes,n=t.getColumn(0,Q0),i=t.getColumn(1,H0),s=t.getColumn(2,z0),a=DW.copy(n).add(i).add(s);return e.center.copy(this.center),e.radius=a.magnitude(),e}intersectPlane(e){const t=this.center,n=e.normal,i=this.halfAxes,s=n.x,a=n.y,o=n.z,A=Math.abs(s*i[Mu.COLUMN0ROW0]+a*i[Mu.COLUMN0ROW1]+o*i[Mu.COLUMN0ROW2])+Math.abs(s*i[Mu.COLUMN1ROW0]+a*i[Mu.COLUMN1ROW1]+o*i[Mu.COLUMN1ROW2])+Math.abs(s*i[Mu.COLUMN2ROW0]+a*i[Mu.COLUMN2ROW1]+o*i[Mu.COLUMN2ROW2]),f=n.dot(t)+e.distance;return f<=-A?Pa.OUTSIDE:f>=A?Pa.INSIDE:Pa.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=kW.from(e).subtract(this.center),n=this.halfAxes,i=n.getColumn(0,Q0),s=n.getColumn(1,H0),a=n.getColumn(2,z0),o=i.magnitude(),A=s.magnitude(),f=a.magnitude();i.normalize(),s.normalize(),a.normalize();let m=0,v;return v=Math.abs(t.dot(i))-o,v>0&&(m+=v*v),v=Math.abs(t.dot(s))-A,v>0&&(m+=v*v),v=Math.abs(t.dot(a))-f,v>0&&(m+=v*v),m}computePlaneDistances(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[-0,-0],i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const a=this.center,o=this.halfAxes,A=o.getColumn(0,Q0),f=o.getColumn(1,H0),m=o.getColumn(2,z0),v=NW.copy(A).add(f).add(m).add(a),x=QW.copy(v).subtract(e);let B=t.dot(x);return i=Math.min(B,i),s=Math.max(B,s),v.copy(a).add(A).add(f).subtract(m),x.copy(v).subtract(e),B=t.dot(x),i=Math.min(B,i),s=Math.max(B,s),v.copy(a).add(A).subtract(f).add(m),x.copy(v).subtract(e),B=t.dot(x),i=Math.min(B,i),s=Math.max(B,s),v.copy(a).add(A).subtract(f).subtract(m),x.copy(v).subtract(e),B=t.dot(x),i=Math.min(B,i),s=Math.max(B,s),a.copy(v).subtract(A).add(f).add(m),x.copy(v).subtract(e),B=t.dot(x),i=Math.min(B,i),s=Math.max(B,s),a.copy(v).subtract(A).add(f).subtract(m),x.copy(v).subtract(e),B=t.dot(x),i=Math.min(B,i),s=Math.max(B,s),a.copy(v).subtract(A).subtract(f).add(m),x.copy(v).subtract(e),B=t.dot(x),i=Math.min(B,i),s=Math.max(B,s),a.copy(v).subtract(A).subtract(f).subtract(m),x.copy(v).subtract(e),B=t.dot(x),i=Math.min(B,i),s=Math.max(B,s),n[0]=i,n[1]=s,n}transform(e){this.center.transformAsPoint(e);const t=this.halfAxes.getColumn(0,Q0);t.transformAsPoint(e);const n=this.halfAxes.getColumn(1,H0);n.transformAsPoint(e);const i=this.halfAxes.getColumn(2,z0);return i.transformAsPoint(e),this.halfAxes=new zi([...t,...n,...i]),this}getTransform(){throw new Error("not implemented")}}const nI=new ut,iI=new ut;class zc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,1],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;W(this,"normal",void 0),W(this,"distance",void 0),this.normal=new ut,this.distance=-0,this.fromNormalDistance(e,t)}fromNormalDistance(e,t){return kc(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}fromPointNormal(e,t){e=nI.from(e),this.normal.from(t).normalize();const n=-this.normal.dot(e);return this.distance=n,this}fromCoefficients(e,t,n,i){return this.normal.set(e,t,n),kc(Nc(this.normal.len(),1)),this.distance=i,this}clone(){return new zc(this.normal,this.distance)}equals(e){return Nc(this.distance,e.distance)&&Nc(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const t=iI.copy(this.normal).transformAsVector(e).normalize(),n=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(n,t)}projectPointOntoPlane(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];e=nI.from(e);const n=this.getPointDistance(e),i=iI.copy(this.normal).scale(n);return e.subtract(i).to(t)}}const sI=[new ut([1,0,0]),new ut([0,1,0]),new ut([0,0,1])],oI=new ut,HW=new ut;new zc(new ut(1,0,0),0);class nc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];W(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*sI.length;const t=e.center,n=e.radius;let i=0;for(const s of sI){let a=this.planes[i],o=this.planes[i+1];a||(a=this.planes[i]=new zc),o||(o=this.planes[i+1]=new zc);const A=oI.copy(s).scale(-n).add(t);-s.dot(A),a.fromPointNormal(A,s);const f=oI.copy(s).scale(n).add(t),m=HW.copy(s).negate();-m.dot(f),o.fromPointNormal(f,m),i+=2}return this}computeVisibility(e){let t=Pa.INSIDE;for(const n of this.planes)switch(e.intersectPlane(n)){case Pa.OUTSIDE:return Pa.OUTSIDE;case Pa.INTERSECTING:t=Pa.INTERSECTING;break}return t}computeVisibilityWithPlaneMask(e,t){if(kc(Number.isFinite(t),"parentPlaneMask is required."),t===nc.MASK_OUTSIDE||t===nc.MASK_INSIDE)return t;let n=nc.MASK_INSIDE;const i=this.planes;for(let s=0;s<this.planes.length;++s){const a=s<31?1<<s:0;if(s<31&&!(t&a))continue;const o=i[s],A=e.intersectPlane(o);if(A===Pa.OUTSIDE)return nc.MASK_OUTSIDE;A===Pa.INTERSECTING&&(n|=a)}return n}}W(nc,"MASK_OUTSIDE",4294967295),W(nc,"MASK_INSIDE",0),W(nc,"MASK_INDETERMINATE",2147483647),new ut,new ut,new ut,new ut,new ut,new ut,new ut,new ut,new ut,new ut,new ut,new ut,new ut,new ut,new ut,new ut,new ut;const Gl=new zi,zW=new zi,GW=new zi,G0=new zi,aI=new zi;function VW(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=tg.EPSILON20,n=10;let i=0,s=0;const a=zW,o=GW;a.identity(),o.copy(r);const A=t*jW(o);for(;s<n&&qW(o)>A;)KW(o,G0),aI.copy(G0).transpose(),o.multiplyRight(G0),o.multiplyLeft(aI),a.multiplyRight(G0),++i>2&&(++s,i=0);return e.unitary=a.toTarget(e.unitary),e.diagonal=o.toTarget(e.diagonal),e}function jW(r){let e=0;for(let t=0;t<9;++t){const n=r[t];e+=n*n}return Math.sqrt(e)}const sw=[1,0,0],ow=[2,2,1];function qW(r){let e=0;for(let t=0;t<3;++t){const n=r[Gl.getElementIndex(ow[t],sw[t])];e+=2*n*n}return Math.sqrt(e)}function KW(r,e){const t=tg.EPSILON15;let n=0,i=1;for(let f=0;f<3;++f){const m=Math.abs(r[Gl.getElementIndex(ow[f],sw[f])]);m>n&&(i=f,n=m)}const s=sw[i],a=ow[i];let o=1,A=0;if(Math.abs(r[Gl.getElementIndex(a,s)])>t){const f=r[Gl.getElementIndex(a,a)],m=r[Gl.getElementIndex(s,s)],v=r[Gl.getElementIndex(a,s)],x=(f-m)/2/v;let B;x<0?B=-1/(-x+Math.sqrt(1+x*x)):B=1/(x+Math.sqrt(1+x*x)),o=1/Math.sqrt(1+B*B),A=B*o}return zi.IDENTITY.to(e),e[Gl.getElementIndex(s,s)]=e[Gl.getElementIndex(a,a)]=o,e[Gl.getElementIndex(a,s)]=A,e[Gl.getElementIndex(s,a)]=-A,e}const PA=new ut,WW=new ut,$W=new ut,XW=new ut,JW=new ut,YW=new zi,ZW={diagonal:new zi,unitary:new zi};function e$(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new fg;if(!r||r.length===0)return e.halfAxes=new zi([0,0,0,0,0,0,0,0,0]),e.center=new ut,e;const t=r.length,n=new ut(0,0,0);for(const Oe of r)n.add(Oe);const i=1/t;n.multiplyByScalar(i);let s=0,a=0,o=0,A=0,f=0,m=0;for(const Oe of r){const Fe=PA.copy(Oe).subtract(n);s+=Fe.x*Fe.x,a+=Fe.x*Fe.y,o+=Fe.x*Fe.z,A+=Fe.y*Fe.y,f+=Fe.y*Fe.z,m+=Fe.z*Fe.z}s*=i,a*=i,o*=i,A*=i,f*=i,m*=i;const v=YW;v[0]=s,v[1]=a,v[2]=o,v[3]=a,v[4]=A,v[5]=f,v[6]=o,v[7]=f,v[8]=m;const{unitary:x}=VW(v,ZW),B=e.halfAxes.copy(x);let M=B.getColumn(0,$W),U=B.getColumn(1,XW),N=B.getColumn(2,JW),Q=-Number.MAX_VALUE,q=-Number.MAX_VALUE,Y=-Number.MAX_VALUE,te=Number.MAX_VALUE,pe=Number.MAX_VALUE,ge=Number.MAX_VALUE;for(const Oe of r)PA.copy(Oe),Q=Math.max(PA.dot(M),Q),q=Math.max(PA.dot(U),q),Y=Math.max(PA.dot(N),Y),te=Math.min(PA.dot(M),te),pe=Math.min(PA.dot(U),pe),ge=Math.min(PA.dot(N),ge);M=M.multiplyByScalar(.5*(te+Q)),U=U.multiplyByScalar(.5*(pe+q)),N=N.multiplyByScalar(.5*(ge+Y)),e.center.copy(M).add(U).add(N);const ye=WW.set(Q-te,q-pe,Y-ge).multiplyByScalar(.5),fe=new zi([ye[0],0,0,0,ye[1],0,0,0,ye[2]]);return e.halfAxes.multiplyRight(fe),e}const aw=Math.PI/180,V0=new Float32Array(16),cI=new Float32Array(12);function lI(r,e,t){const n=e[0]*aw,i=e[1]*aw,s=e[2]*aw,a=Math.sin(s),o=Math.sin(n),A=Math.sin(i),f=Math.cos(s),m=Math.cos(n),v=Math.cos(i),x=t[0],B=t[1],M=t[2];r[0]=x*v*m,r[1]=x*A*m,r[2]=x*-o,r[3]=B*(-A*f+v*o*a),r[4]=B*(v*f+A*o*a),r[5]=B*m*a,r[6]=M*(A*a+v*o*f),r[7]=M*(-v*a+A*o*f),r[8]=M*m*f}function uI(r){return r[0]=r[0],r[1]=r[1],r[2]=r[2],r[3]=r[4],r[4]=r[5],r[5]=r[6],r[6]=r[8],r[7]=r[9],r[8]=r[10],r[9]=r[12],r[10]=r[13],r[11]=r[14],r.subarray(0,12)}const AI={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(r,e){let{startRow:t,endRow:n}=e;const{data:i,getOrientation:s,getScale:a,getTranslation:o,getTransformMatrix:A}=this.props,f=Array.isArray(A),m=f&&A.length===16,v=Array.isArray(a),x=Array.isArray(s),B=Array.isArray(o),M=m||!f&&!!A(i[0]);M?r.constant=m:r.constant=x&&v&&B;const U=r.value;if(r.constant){let N;M?(V0.set(A),N=uI(V0)):(N=cI,lI(N,s,a),N.set(o,9)),r.value=new Float32Array(N)}else{let N=t*r.size;const{iterable:Q,objectInfo:q}=O3(i,t,n);for(const Y of Q){q.index++;let te;if(M)V0.set(m?A:A(Y,q)),te=uI(V0);else{te=cI;const pe=x?s:s(Y,q),ge=v?a:a(Y,q);lI(te,pe,ge),te.set(B?o:o(Y,q),9)}U[N++]=te[0],U[N++]=te[1],U[N++]=te[2],U[N++]=te[3],U[N++]=te[4],U[N++]=te[5],U[N++]=te[6],U[N++]=te[7],U[N++]=te[8],U[N++]=te[9],U[N++]=te[10],U[N++]=te[11]}}}};function hI(r,e){return e===Tn.CARTESIAN||e===Tn.METER_OFFSETS||e===Tn.DEFAULT&&!r.isGeospatial}const t$=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,r$=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function dI(r){let e=1/0,t=1/0,n=1/0,i=-1/0,s=-1/0,a=-1/0;const o=r.POSITION?r.POSITION.value:[],A=o&&o.length;for(let f=0;f<A;f+=3){const m=o[f],v=o[f+1],x=o[f+2];e=m<e?m:e,t=v<t?v:t,n=x<n?x:n,i=m>i?m:i,s=v>s?v:s,a=x>a?x:a}return[[e,t,n],[i,s,a]]}function n$(r,e){if(!r)throw new Error(e||"loader assertion failed.")}class nf{constructor(e,t){W(this,"fields",void 0),W(this,"metadata",void 0),n$(Array.isArray(e)),i$(e),this.fields=e,this.metadata=t||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let t=0;t<this.fields.length;++t)if(!this.fields[t].compareTo(e.fields[t]))return!1;return!0}select(){const e=Object.create(null);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const a of n)e[a]=!0;const s=this.fields.filter(a=>e[a.name]);return new nf(s,this.metadata)}selectAt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=t.map(s=>this.fields[s]).filter(Boolean);return new nf(i,this.metadata)}assign(e){let t,n=this.metadata;if(e instanceof nf){const a=e;t=a.fields,n=fI(fI(new Map,this.metadata),a.metadata)}else t=e;const i=Object.create(null);for(const a of this.fields)i[a.name]=a;for(const a of t)i[a.name]=a;const s=Object.values(i);return new nf(s,n)}}function i$(r){const e={};for(const t of r)e[t.name]&&console.warn("Schema: duplicated field name",t.name,t),e[t.name]=!0}function fI(r,e){return new Map([...r||new Map,...e||new Map])}class j0{constructor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;W(this,"name",void 0),W(this,"type",void 0),W(this,"nullable",void 0),W(this,"metadata",void 0),this.name=e,this.type=t,this.nullable=n,this.metadata=i}get typeId(){return this.type&&this.type.typeId}clone(){return new j0(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let Gi=function(r){return r[r.NONE=0]="NONE",r[r.Null=1]="Null",r[r.Int=2]="Int",r[r.Float=3]="Float",r[r.Binary=4]="Binary",r[r.Utf8=5]="Utf8",r[r.Bool=6]="Bool",r[r.Decimal=7]="Decimal",r[r.Date=8]="Date",r[r.Time=9]="Time",r[r.Timestamp=10]="Timestamp",r[r.Interval=11]="Interval",r[r.List=12]="List",r[r.Struct=13]="Struct",r[r.Union=14]="Union",r[r.FixedSizeBinary=15]="FixedSizeBinary",r[r.FixedSizeList=16]="FixedSizeList",r[r.Map=17]="Map",r[r.Dictionary=-1]="Dictionary",r[r.Int8=-2]="Int8",r[r.Int16=-3]="Int16",r[r.Int32=-4]="Int32",r[r.Int64=-5]="Int64",r[r.Uint8=-6]="Uint8",r[r.Uint16=-7]="Uint16",r[r.Uint32=-8]="Uint32",r[r.Uint64=-9]="Uint64",r[r.Float16=-10]="Float16",r[r.Float32=-11]="Float32",r[r.Float64=-12]="Float64",r[r.DateDay=-13]="DateDay",r[r.DateMillisecond=-14]="DateMillisecond",r[r.TimestampSecond=-15]="TimestampSecond",r[r.TimestampMillisecond=-16]="TimestampMillisecond",r[r.TimestampMicrosecond=-17]="TimestampMicrosecond",r[r.TimestampNanosecond=-18]="TimestampNanosecond",r[r.TimeSecond=-19]="TimeSecond",r[r.TimeMillisecond=-20]="TimeMillisecond",r[r.TimeMicrosecond=-21]="TimeMicrosecond",r[r.TimeNanosecond=-22]="TimeNanosecond",r[r.DenseUnion=-23]="DenseUnion",r[r.SparseUnion=-24]="SparseUnion",r[r.IntervalDayTime=-25]="IntervalDayTime",r[r.IntervalYearMonth=-26]="IntervalYearMonth",r}({}),pI,gI,mI;class cw{static isNull(e){return e&&e.typeId===Gi.Null}static isInt(e){return e&&e.typeId===Gi.Int}static isFloat(e){return e&&e.typeId===Gi.Float}static isBinary(e){return e&&e.typeId===Gi.Binary}static isUtf8(e){return e&&e.typeId===Gi.Utf8}static isBool(e){return e&&e.typeId===Gi.Bool}static isDecimal(e){return e&&e.typeId===Gi.Decimal}static isDate(e){return e&&e.typeId===Gi.Date}static isTime(e){return e&&e.typeId===Gi.Time}static isTimestamp(e){return e&&e.typeId===Gi.Timestamp}static isInterval(e){return e&&e.typeId===Gi.Interval}static isList(e){return e&&e.typeId===Gi.List}static isStruct(e){return e&&e.typeId===Gi.Struct}static isUnion(e){return e&&e.typeId===Gi.Union}static isFixedSizeBinary(e){return e&&e.typeId===Gi.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Gi.FixedSizeList}static isMap(e){return e&&e.typeId===Gi.Map}static isDictionary(e){return e&&e.typeId===Gi.Dictionary}get typeId(){return Gi.NONE}compareTo(e){return this===e}}pI=Symbol.toStringTag;class sf extends cw{constructor(e,t){super(),W(this,"isSigned",void 0),W(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=t}get typeId(){return Gi.Int}get[pI](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class s$ extends sf{constructor(){super(!0,8)}}class o$ extends sf{constructor(){super(!0,16)}}class a$ extends sf{constructor(){super(!0,32)}}class c$ extends sf{constructor(){super(!1,8)}}class l$ extends sf{constructor(){super(!1,16)}}class u$ extends sf{constructor(){super(!1,32)}}const yI={HALF:16,SINGLE:32,DOUBLE:64};gI=Symbol.toStringTag;class _I extends cw{constructor(e){super(),W(this,"precision",void 0),this.precision=e}get typeId(){return Gi.Float}get[gI](){return"Float"}toString(){return"Float".concat(this.precision)}}class A$ extends _I{constructor(){super(yI.SINGLE)}}class h$ extends _I{constructor(){super(yI.DOUBLE)}}mI=Symbol.toStringTag;class d$ extends cw{constructor(e,t){super(),W(this,"listSize",void 0),W(this,"children",void 0),this.listSize=e,this.children=[t]}get typeId(){return Gi.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[mI](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function f$(r){switch(r.constructor){case Int8Array:return new s$;case Uint8Array:return new c$;case Int16Array:return new o$;case Uint16Array:return new l$;case Int32Array:return new a$;case Uint32Array:return new u$;case Float32Array:return new A$;case Float64Array:return new h$;default:throw new Error("array type not supported")}}function p$(r,e,t){const n=f$(e.value),i=t||g$(e);return new j0(r,new d$(e.size,new j0("value",n)),!1,i)}function g$(r){const e=new Map;return"byteOffset"in r&&e.set("byteOffset",r.byteOffset.toString(10)),"byteStride"in r&&e.set("byteStride",r.byteStride.toString(10)),"normalized"in r&&e.set("normalized",r.normalized.toString()),e}function vI(r,e){(r.COLOR_0||r.colors)&&e||(r.colors={constant:!0,value:new Float32Array([1,1,1])}),Mn.assert(r.positions||r.POSITION,'no "postions" or "POSITION" attribute in mesh')}function bI(r,e){if(r.attributes)return vI(r.attributes,e),r instanceof ng?r:new ng(r);if(r.positions||r.POSITION)return vI(r,e),new ng({attributes:r});throw Error("Invalid mesh")}const m$={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:r=>r.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class lw extends rf{constructor(){super(...arguments),W(this,"state",void 0)}getShaders(){const e=!gn(this.context.gl),t={};return Vv(this.context.gl,gi.GLSL_DERIVATIVES)&&(t.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:t$,fs:r$,modules:[Ub,uV,Rb],transpileToGLSL100:e,defines:t})}getBounds(){var e;if(this.props._instanced)return super.getBounds();let t=this.state.positionBounds;if(t)return t;const{mesh:n}=this.props;if(!n)return null;if(t=(e=n.header)===null||e===void 0?void 0:e.boundingBox,!t){const{attributes:i}=bI(n,this.props._useMeshColors);i.POSITION=i.POSITION||i.positions,t=dI(i)}return this.state.positionBounds=t,t}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:AI}),this.setState({emptyTexture:new Ia(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:t,oldProps:n,changeFlags:i}=e;if(t.mesh!==n.mesh||i.extensionsChanged){var s;if(this.state.positionBounds=null,(s=this.state.model)===null||s===void 0||s.delete(),t.mesh){this.state.model=this.getModel(t.mesh);const a=t.mesh.attributes||t.mesh;this.setState({hasNormals:!!(a.NORMAL||a.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==n.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw(e){let{uniforms:t}=e;if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:i,coordinateSystem:s,_instanced:a}=this.props;this.state.model.setUniforms(t).setUniforms({sizeScale:i,composeModelMatrix:!a||hI(n,s),flatShading:!this.state.hasNormals}).draw()}get isLoaded(){var e;return((e=this.state)===null||e===void 0?void 0:e.model)&&super.isLoaded}getModel(e){const t=new qd(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:bI(e,this.props._useMeshColors),isInstanced:!0}),{texture:n}=this.props,{emptyTexture:i}=this.state;return t.setUniforms({sampler:n||i,hasTexture:!!n}),t}setTexture(e){const{emptyTexture:t,model:n}=this.state;n&&n.setUniforms({sampler:e||t,hasTexture:!!e})}}W(lw,"defaultProps",m$),W(lw,"layerName","SimpleMeshLayer");class of{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:t}=e;this.id=t||Eu(this.constructor.name),this.display=!0,this.position=new ut,this.rotation=new ut,this.scale=new ut(1,1,1),this.matrix=new Bn,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}getBounds(){return null}setPosition(e){return ar(e.length===3,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return ar(e.length===3,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return ar(e.length===3,"setScale requires vector argument"),this.scale=e,this}setMatrix(e){(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?this.matrix.copy(e):this.matrix=e}setMatrixComponents(e){let{position:t,rotation:n,scale:i,update:s=!0}=e;return t&&this.setPosition(t),n&&this.setRotation(n),i&&this.setScale(i),s&&this.updateMatrix(),this}updateMatrix(){const e=this.position,t=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(n),this}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{position:t,rotation:n,scale:i}=e;return t&&this.setPosition(t),n&&this.setRotation(n),i&&this.setScale(i),this.updateMatrix(),this}getCoordinateUniforms(e,t){ar(e),t=t||this.matrix;const n=new Bn(e).multiplyRight(t),i=n.invert(),s=i.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:n,worldInverseMatrix:i,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class pg extends of{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e=Array.isArray(e)?{children:e}:e;const{children:t=[]}=e;yr.assert(t.every(n=>n instanceof of),"every child must an instance of ScenegraphNode"),super(e),this.children=t}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const i of t)Array.isArray(i)?this.add(...i):this.children.push(i);return this}remove(e){const t=this.children,n=t.indexOf(e);return n>-1&&t.splice(n,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}getBounds(){const e=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse((t,n)=>{let{worldMatrix:i}=n;const s=t.getBounds();if(!s)return;const[a,o]=s,A=new ut(a).add(o).divide([2,2,2]);i.transformAsPoint(A,A);const f=new ut(o).subtract(a).divide([2,2,2]);i.transformAsVector(f,f);for(let m=0;m<8;m++){const v=new ut(m&1?-1:1,m&2?-1:1,m&4?-1:1).multiply(f).add(A);for(let x=0;x<3;x++)e[0][x]=Math.min(e[0][x],v[x]),e[1][x]=Math.max(e[1][x],v[x])}}),Number.isFinite(e[0][0])?e:null}traverse(e){let{worldMatrix:t=new Bn}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=new Bn(t).multiplyRight(this.matrix);for(const i of this.children)i instanceof pg?i.traverse(e,{worldMatrix:n}):e(i,{worldMatrix:n})}}const y$={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_$={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function wI(r){if(!r._animation){const e=_$[r.componentType],t=y$[r.type],n=t*r.count,{buffer:i,byteOffset:s}=r.bufferView.data,a=new e(i,s+(r.byteOffset||0),n);if(t===1)r._animation=Array.from(a);else{const o=[];for(let A=0;A<a.length;A+=t)o.push(Array.from(a.slice(A,A+t)));r._animation=o}}return r._animation}const v$=new Bn;function b$(r,e){if(e.matrix.identity(),r.translation&&e.matrix.translate(r.translation),r.rotation){const t=v$.fromQuaternion(r.rotation);e.matrix.multiplyRight(t)}r.scale&&e.matrix.scale(r.scale)}const uw=new eg;function w$(r,e,t,n,i){if(e==="rotation"){uw.slerp({start:t,target:n,ratio:i});for(let s=0;s<uw.length;s++)r[e][s]=uw[s]}else for(let s=0;s<t.length;s++)r[e][s]=i*n[s]+(1-i)*t[s]}function x$(r,e,t){let{p0:n,outTangent0:i,inTangent1:s,p1:a,tDiff:o,ratio:A}=t;for(let f=0;f<r[e].length;f++){const m=i[f]*o,v=s[f]*o;r[e][f]=(2*Math.pow(A,3)-3*Math.pow(A,2)+1)*n[f]+(Math.pow(A,3)-2*Math.pow(A,2)+A)*m+(-2*Math.pow(A,3)+3*Math.pow(A,2))*a[f]+(Math.pow(A,3)-Math.pow(A,2))*v}}function B$(r,e,t){for(let n=0;n<t.length;n++)r[e][n]=t[n]}function C$(r,e,t,n){let{input:i,interpolation:s,output:a}=e;const o=i[i.length-1],A=r%o,f=i.findIndex(B=>B>=A),m=Math.max(0,f-1);if(!Array.isArray(t[n]))switch(n){case"translation":t[n]=[0,0,0];break;case"rotation":t[n]=[0,0,0,1];break;case"scale":t[n]=[1,1,1];break;default:yr.warn("Bad animation path ".concat(n))()}ar(t[n].length===a[m].length);const v=i[m],x=i[f];switch(s){case"STEP":B$(t,n,a[m]);break;case"LINEAR":if(x>v){const B=(A-v)/(x-v);w$(t,n,a[m],a[f],B)}break;case"CUBICSPLINE":if(x>v){const B=(A-v)/(x-v),M=x-v,U=a[3*m+1],N=a[3*m+2],Q=a[3*f+0],q=a[3*f+1];x$(t,n,{p0:U,outTangent0:N,inTangent1:Q,p1:q,tDiff:M,ratio:B})}break;default:yr.warn("Interpolation ".concat(s," not supported"))();break}}class E${constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const n=(e/1e3-this.startTime)*this.speed;this.channels.forEach(i=>{let{sampler:s,target:a,path:o}=i;C$(n,s,a,o),b$(a,a._node)})}}class S${constructor(e){this.animations=e.animations.map((t,n)=>{const i=t.name||"Animation-".concat(n),s=t.samplers.map(o=>{let{input:A,interpolation:f="LINEAR",output:m}=o;return{input:wI(e.accessors[A]),interpolation:f,output:wI(e.accessors[m])}}),a=t.channels.map(o=>{let{sampler:A,target:f}=o;return{sampler:s[A],target:e.nodes[f.node],path:f.path}});return new E$({name:i,channels:a})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(t=>t.animate(e))}getAnimations(){return this.animations}}class T$ extends of{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t),this.onBeforeRender=null,this.AfterRender=null,e instanceof qd?(this.model=e,this._setModelNodeProps(t)):this.model=new qd(e,t),this.bounds=null,this.managedResources=t.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}getBounds(){return this.bounds}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(){return this.model.draw(...arguments)}setUniforms(){return this.model.setUniforms(...arguments),this}setAttributes(){return this.model.setAttributes(...arguments),this}updateModuleSettings(){return this.model.updateModuleSettings(...arguments),this}_setModelNodeProps(e){this.model.setProps(e)}}class xI{constructor(e,t){let{attributes:n,material:i,pbrDebug:s,imageBasedLightingEnvironment:a,lights:o,useTangents:A}=t;this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},Vv(e,gi.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],a&&(this.uniforms.u_DiffuseEnvSampler=a.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=a.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=a.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),s&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(n.NORMAL,"HAS_NORMALS"),this.defineIfPresent(n.TANGENT&&A,"HAS_TANGENTS"),this.defineIfPresent(n.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(a,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(s,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},s=e.texture.source.image;let a,o={};s.compressed?(a=s,o={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):a={data:s};const A=new Ia(this.gl,{id:e.name||e.id,parameters:{...i,...o},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...a});this.uniforms[t]=A,this.defineIfPresent(n,n),this.generatedTextures.push(A)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:n=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,n]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=!!e.unlit,e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),e.alphaMode==="MASK"){const{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else e.alphaMode==="BLEND"&&(yr.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}delete(){this.generatedTextures.forEach(e=>e.delete())}}const I$=`
#if (__VERSION__ < 300)
  #define _attr attribute
#else
  #define _attr in
#endif

  _attr vec4 POSITION;

  #ifdef HAS_NORMALS
    _attr vec4 NORMAL;
  #endif

  #ifdef HAS_TANGENTS
    _attr vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    _attr vec2 TEXCOORD_0;
  #endif

  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = NORMAL;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = TEXCOORD_0;
    #endif

    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = u_MVPMatrix * POSITION;
  }
`,L$=`
#if (__VERSION__ < 300)
  #define fragmentColor gl_FragColor
#else
  out vec4 fragmentColor;
#endif

  void main(void) {
    fragmentColor = pbr_filterColor(vec4(0));
  }
`;function BI(r,e){return gn(r)?`#version 300 es
`.concat(e):e}function F$(r,e){const{id:t,drawMode:n,vertexCount:i,attributes:s,modelOptions:a}=e,o=new xI(r,e);yr.info(4,"createGLTFModel defines: ",o.defines)();const A=[];A.push(...o.generatedTextures),A.push(...Object.values(s).map(m=>m.buffer));const f=new T$(r,{id:t,drawMode:n,vertexCount:i,modules:[vb],parameters:o.parameters,vs:BI(r,I$),fs:BI(r,L$),managedResources:A,...a,defines:{...o.defines,...a.defines}});return f.setProps({attributes:s}),f.setUniforms(o.uniforms),f}const M$={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},P$={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class U${constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.options=Object.assign({},P$,t)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(n=>this.createScene(n))}createAnimator(){return Array.isArray(this.gltf.animations)?new S$(this.gltf):null}createScene(e){const n=(e.nodes||[]).map(s=>this.createNode(s));return new pg({id:e.name||e.id,children:n})}createNode(e){if(!e._node){const n=(e.children||[]).map(s=>this.createNode(s));e.mesh&&n.push(this.createMesh(e.mesh));const i=new pg({id:e.name||e.id,children:n});if(e.matrix)i.setMatrix(e.matrix);else{if(i.matrix.identity(),e.translation&&i.matrix.translate(e.translation),e.rotation){const s=new Bn().fromQuaternion(e.rotation);i.matrix.multiplyRight(s)}e.scale&&i.matrix.scale(e.scale)}e._node=i}return e._node}createMesh(e){if(!e._mesh){const n=(e.primitives||[]).map((s,a)=>this.createPrimitive(s,a,e)),i=new pg({id:e.name||e.id,children:n});e._mesh=i}return e._mesh}getVertexCount(e){yr.warn("getVertexCount() not found")()}createPrimitive(e,t,n){const i=F$(this.gl,Object.assign({id:e.name||"".concat(n.name||n.id,"-primitive-").concat(t),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options));return i.bounds=[e.attributes.POSITION.min,e.attributes.POSITION.max],i}createAttributes(e,t){const n={};return Object.keys(e).forEach(i=>{n[i]=this.createAccessor(e[i],this.createBuffer(e[i],this.gl.ARRAY_BUFFER))}),t&&(n.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),yr.info(4,"glTF Attributes",{attributes:e,indices:t,generated:n})(),n}createBuffer(e,t){e.bufferView||(e.bufferView={});const{bufferView:n}=e;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[t]||(n.lumaBuffers[t]=new ri(this.gl,{id:"from-".concat(n.id),data:n.data||e.value,target:t})),n.lumaBuffers[t]}createAccessor(e,t){return new aa({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:M$[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function R$(r,e,t){const n=new U$(r,t),i=n.instantiate(e),s=n.createAnimator();return{scenes:i,animator:s}}const O$="3.4.14",D$="3.4.14",CI="3.4.14",k$="https://unpkg.com/@loaders.gl/textures@".concat(CI,"/dist/libs/basis_encoder.wasm"),N$="https://unpkg.com/@loaders.gl/textures@".concat(CI,"/dist/libs/basis_encoder.js");let Aw;async function EI(r){const e=r.modules||{};return e.basis?e.basis:(Aw=Aw||Q$(r),await Aw)}async function Q$(r){let e=null,t=null;return[e,t]=await Promise.all([await Ch("basis_transcoder.js","textures",r),await Ch("basis_transcoder.wasm","textures",r)]),e=e||globalThis.BASIS,await H$(e,t)}function H$(r,e){const t={};return e&&(t.wasmBinary=e),new Promise(n=>{r(t).then(i=>{const{BasisFile:s,initializeBasis:a}=i;a(),n({BasisFile:s})})})}let hw;async function SI(r){const e=r.modules||{};return e.basisEncoder?e.basisEncoder:(hw=hw||z$(r),await hw)}async function z$(r){let e=null,t=null;return[e,t]=await Promise.all([await Ch(N$,"textures",r),await Ch(k$,"textures",r)]),e=e||globalThis.BASIS,await G$(e,t)}function G$(r,e){const t={};return e&&(t.wasmBinary=e),new Promise(n=>{r(t).then(i=>{const{BasisFile:s,KTX2File:a,initializeBasis:o,BasisEncoder:A}=i;o(),n({BasisFile:s,KTX2File:a,BasisEncoder:A})})})}const af={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919},V$=["","WEBKIT_","MOZ_"],TI={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let q0=null;function j$(r){if(!q0){r=r||q$()||void 0,q0=new Set;for(const e of V$)for(const t in TI)if(r&&r.getExtension("".concat(e).concat(t))){const n=TI[t];q0.add(n)}}return q0}function q$(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}var II,LI,FI,MI,PI,UI,RI,OI;(function(r){r[r.NONE=0]="NONE",r[r.BASISLZ=1]="BASISLZ",r[r.ZSTD=2]="ZSTD",r[r.ZLIB=3]="ZLIB"})(II||(II={})),function(r){r[r.BASICFORMAT=0]="BASICFORMAT"}(LI||(LI={})),function(r){r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.ETC1S=163]="ETC1S",r[r.UASTC=166]="UASTC"}(FI||(FI={})),function(r){r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.SRGB=1]="SRGB"}(MI||(MI={})),function(r){r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.LINEAR=1]="LINEAR",r[r.SRGB=2]="SRGB",r[r.ITU=3]="ITU",r[r.NTSC=4]="NTSC",r[r.SLOG=5]="SLOG",r[r.SLOG2=6]="SLOG2"}(PI||(PI={})),function(r){r[r.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",r[r.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(UI||(UI={})),function(r){r[r.RGB=0]="RGB",r[r.RRR=3]="RRR",r[r.GGG=4]="GGG",r[r.AAA=15]="AAA"}(RI||(RI={})),function(r){r[r.RGB=0]="RGB",r[r.RGBA=3]="RGBA",r[r.RRR=4]="RRR",r[r.RRRG=5]="RRRG"}(OI||(OI={}));const Ua=[171,75,84,88,32,50,48,187,13,10,26,10];function K$(r){const e=new Uint8Array(r);return!(e.byteLength<Ua.length||e[0]!==Ua[0]||e[1]!==Ua[1]||e[2]!==Ua[2]||e[3]!==Ua[3]||e[4]!==Ua[4]||e[5]!==Ua[5]||e[6]!==Ua[6]||e[7]!==Ua[7]||e[8]!==Ua[8]||e[9]!==Ua[9]||e[10]!==Ua[10]||e[11]!==Ua[11])}const W$={etc1:{basisFormat:0,compressed:!0,format:af.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:af.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:af.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:af.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:af.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:af.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function $$(r,e){if(e.basis.containerFormat==="auto"){if(K$(r)){const n=await SI(e);return DI(n.KTX2File,r,e)}const{BasisFile:t}=await EI(e);return dw(t,r,e)}switch(e.basis.module){case"encoder":const t=await SI(e);switch(e.basis.containerFormat){case"ktx2":return DI(t.KTX2File,r,e);case"basis":default:return dw(t.BasisFile,r,e)}case"transcoder":default:const{BasisFile:n}=await EI(e);return dw(n,r,e)}}function dw(r,e,t){const n=new r(new Uint8Array(e));try{if(!n.startTranscoding())throw new Error("Failed to start basis transcoding");const i=n.getNumImages(),s=[];for(let a=0;a<i;a++){const o=n.getNumLevels(a),A=[];for(let f=0;f<o;f++)A.push(X$(n,a,f,t));s.push(A)}return s}finally{n.close(),n.delete()}}function X$(r,e,t,n){const i=r.getImageWidth(e,t),s=r.getImageHeight(e,t),a=r.getHasAlpha(),{compressed:o,format:A,basisFormat:f}=kI(n,a),m=r.getImageTranscodedSizeInBytes(e,t,f),v=new Uint8Array(m);if(!r.transcodeImage(v,e,t,f,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:s,data:v,compressed:o,format:A,hasAlpha:a}}function DI(r,e,t){const n=new r(new Uint8Array(e));try{if(!n.startTranscoding())throw new Error("failed to start KTX2 transcoding");const i=n.getLevels(),s=[];for(let a=0;a<i;a++){s.push(J$(n,a,t));break}return[s]}finally{n.close(),n.delete()}}function J$(r,e,t){const{alphaFlag:n,height:i,width:s}=r.getImageLevelInfo(e,0,0),{compressed:a,format:o,basisFormat:A}=kI(t,n),f=r.getImageTranscodedSizeInBytes(e,0,0,A),m=new Uint8Array(f);if(!r.transcodeImage(m,e,0,0,A,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:s,height:i,data:m,compressed:a,levelSize:f,hasAlpha:n,format:o}}function kI(r,e){let t=r&&r.basis&&r.basis.format;return t==="auto"&&(t=NI()),typeof t=="object"&&(t=e?t.alpha:t.noAlpha),t=t.toLowerCase(),W$[t]}function NI(){const r=j$();return r.has("astc")?"astc-4x4":r.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:r.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:r.has("etc1")?"etc1":r.has("etc2")?"etc2":"rgb565"}const Y$={...{name:"Basis",id:wu?"basis":"basis-nodejs",module:"textures",version:D$,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},parse:$$};function Ra(r,e){if(!r)throw new Error(e||"assert failed: gltf")}function QI(r,e){if(r.startsWith("data:")||r.startsWith("http:")||r.startsWith("https:"))return r;const n=e.baseUri||e.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url ".concat(r));return n.substr(0,n.lastIndexOf("/")+1)+r}function Z$(r,e,t){const n=r.bufferViews[t];Ra(n);const i=n.buffer,s=e[i];Ra(s);const a=(n.byteOffset||0)+s.byteOffset;return new Uint8Array(s.arrayBuffer,a,n.byteLength)}const HI=["SCALAR","VEC2","VEC3","VEC4"],eX=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],tX=new Map(eX),rX={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},nX={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},iX={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function zI(r){return HI[r-1]||HI[0]}function GI(r){const e=tX.get(r.constructor);if(!e)throw new Error("Illegal typed array");return e}function fw(r,e){const t=iX[r.componentType],n=rX[r.type],i=nX[r.componentType],s=r.count*n,a=r.count*n*i;return Ra(a>=0&&a<=e.byteLength),{ArrayType:t,length:s,byteLength:a}}function VI(r){let{images:e,bufferViews:t}=r;e=e||[],t=t||[];const n=e.map(a=>a.bufferView);t=t.filter(a=>!n.includes(a));const i=t.reduce((a,o)=>a+o.byteLength,0),s=e.reduce((a,o)=>{const{width:A,height:f}=o.image;return a+A*f},0);return i+Math.ceil(4*s*1.33)}const sX={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class ca{constructor(e){W(this,"gltf",void 0),W(this,"sourceBuffers",void 0),W(this,"byteLength",void 0),this.gltf=e||{json:{...sX},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){const t=this.getUsedExtensions().find(i=>i===e),n=this.json.extensions||{};return t?n[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(n=>n===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if(typeof t=="object")return t;const n=this.json[e]&&this.json[e][t];if(!n)throw new Error("glTF file error: Could not find ".concat(e,"[").concat(t,"]"));return n}getTypedArrayForBufferView(e){e=this.getBufferView(e);const t=e.buffer,n=this.gltf.buffers[t];Ra(n);const i=(e.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,i,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),i=this.getBuffer(t.buffer).data,{ArrayType:s,length:a}=fw(e,t),o=t.byteOffset+e.byteOffset;return new s(i,o,a)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),i=this.getBuffer(t.buffer).data,s=t.byteOffset||0;return new Uint8Array(i,s,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,n){return e.extensions=e.extensions||{},e.extensions[t]=n,this.registerUsedExtension(t),this}setObjectExtension(e,t,n){const i=e.extensions||{};i[t]=n}removeObjectExtension(e,t){const n=e.extensions||{},i=n[t];return delete n[t],i}addExtension(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ra(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ra(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(t=>t===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(t=>t===e)||this.json.extensionsRequired.push(e)}removeExtension(e){if(!this.getExtension(e))return;this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e],Array.isArray(this.json.extensionsRemoved)||(this.json.extensionsRemoved=[]);const t=this.json.extensionsRemoved;t.includes(e)||t.push(e)}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:n}=e;this.json.nodes=this.json.nodes||[];const i={mesh:t};return n&&(i.matrix=n),this.json.nodes.push(i),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:n,material:i,mode:s=4}=e,o={primitives:[{attributes:this._addAttributes(t),mode:s}]};if(n){const A=this._addIndices(n);o.primitives[0].indices=A}return Number.isFinite(i)&&(o.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(o),this.json.meshes.length-1}addPointCloud(e){const n={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(n),this.json.meshes.length-1}addImage(e,t){const n=wv(e),i=t||(n==null?void 0:n.mimeType),a={bufferView:this.addBufferView(e),mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(a),this.json.images.length-1}addBufferView(e){const t=e.byteLength;Ra(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const n={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=Mp(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1}addAccessor(e,t){const n={bufferView:e,type:zI(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}addBinaryBuffer(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{size:3};const n=this.addBufferView(e);let i={min:t.min,max:t.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(e,t.size));const s={size:t.size,componentType:GI(e),count:Math.round(e.length/t.size),min:i.min,max:i.max};return this.addAccessor(n,Object.assign(s,t))}addTexture(e){const{imageIndex:t}=e,n={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(n),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,t;this.gltf.buffers=[];const n=this.byteLength,i=new ArrayBuffer(n),s=new Uint8Array(i);let a=0;for(const o of this.sourceBuffers||[])a=LN(o,s,a);(e=this.json)!==null&&e!==void 0&&(t=e.buffers)!==null&&t!==void 0&&t[0]?this.json.buffers[0].byteLength=n:this.json.buffers=[{byteLength:n}],this.gltf.binary=i,this.sourceBuffers=[i]}_removeStringFromArray(e,t){let n=!0;for(;n;){const i=e.indexOf(t);i>-1?e.splice(i,1):n=!1}}_addAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t={};for(const n in e){const i=e[n],s=this._getGltfAttributeName(n),a=this.addBinaryBuffer(i.value,i);t[s]=a}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const n={min:null,max:null};if(e.length<t)return n;n.min=[],n.max=[];const i=e.subarray(0,t);for(const s of i)n.min.push(s),n.max.push(s);for(let s=t;s<e.length;s+=t)for(let a=0;a<t;a++)n.min[0+a]=Math.min(n.min[0+a],e[s+a]),n.max[0+a]=Math.max(n.max[0+a],e[s+a]);return n}}const oX="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",aX="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",cX=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),lX=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),uX={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},AX={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function hX(r,e,t,n,i){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"NONE";const a=await dX();gX(a,a.exports[AX[i]],r,e,t,n,a.exports[uX[s||"NONE"]])}let pw;async function dX(){return pw||(pw=fX()),pw}async function fX(){let r=oX;WebAssembly.validate(cX)&&(r=aX,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const e=await WebAssembly.instantiate(pX(r),{});return await e.instance.exports.__wasm_call_ctors(),e.instance}function pX(r){const e=new Uint8Array(r.length);for(let n=0;n<r.length;++n){const i=r.charCodeAt(n);e[n]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let t=0;for(let n=0;n<r.length;++n)e[t++]=e[n]<60?lX[e[n]]:(e[n]-60)*64+e[++n];return e.buffer.slice(0,t)}function gX(r,e,t,n,i,s,a){const o=r.exports.sbrk,A=n+3&-4,f=o(A*i),m=o(s.length),v=new Uint8Array(r.exports.memory.buffer);v.set(s,m);const x=e(f,n,i,m,s.length);if(x===0&&a&&a(f,A,i),t.set(v.subarray(f,f+n*i)),o(f-o(0)),x!==0)throw new Error("Malformed buffer data: ".concat(x))}const gw="EXT_meshopt_compression",mX=gw;async function yX(r,e){var t;const n=new ca(r);if(!(e!=null&&(t=e.gltf)!==null&&t!==void 0&&t.decompressMeshes))return;const i=[];for(const s of r.json.bufferViews||[])i.push(_X(n,s));await Promise.all(i),n.removeExtension(gw)}async function _X(r,e){const t=r.getObjectExtension(e,gw);if(t){const{byteOffset:n=0,byteLength:i=0,byteStride:s,count:a,mode:o,filter:A="NONE",buffer:f}=t,m=r.gltf.buffers[f],v=new Uint8Array(m.arrayBuffer,m.byteOffset+n,i),x=new Uint8Array(r.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);return await hX(x,a,s,v,o,A),x}return null}const vX=Object.freeze(Object.defineProperty({__proto__:null,decode:yX,name:mX},Symbol.toStringTag,{value:"Module"})),cf="EXT_texture_webp",bX=cf;function wX(r,e){const t=new ca(r);if(!EQ("image/webp")){if(t.getRequiredExtensions().includes(cf))throw new Error("gltf: Required extension ".concat(cf," not supported by browser"));return}const{json:n}=t;for(const i of n.textures||[]){const s=t.getObjectExtension(i,cf);s&&(i.source=s.source),t.removeObjectExtension(i,cf)}t.removeExtension(cf)}const xX=Object.freeze(Object.defineProperty({__proto__:null,name:bX,preprocess:wX},Symbol.toStringTag,{value:"Module"})),K0="KHR_texture_basisu",BX=K0;function CX(r,e){const t=new ca(r),{json:n}=t;for(const i of n.textures||[]){const s=t.getObjectExtension(i,K0);s&&(i.source=s.source),t.removeObjectExtension(i,K0)}t.removeExtension(K0)}const EX=Object.freeze(Object.defineProperty({__proto__:null,name:BX,preprocess:CX},Symbol.toStringTag,{value:"Module"})),SX={name:"Draco",id:wu?"draco":"draco-nodejs",module:"draco",shapes:["mesh"],version:"3.4.14",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};function TX(r,e,t){const n=qI(e.metadata),i=[],s=IX(e.attributes);for(const a in r){const o=r[a],A=jI(a,o,s[a]);i.push(A)}if(t){const a=jI("indices",t);i.push(a)}return new nf(i,n)}function IX(r){const e={};for(const t in r){const n=r[t];e[n.name||"undefined"]=n}return e}function jI(r,e,t){const n=t?qI(t.metadata):void 0;return p$(r,e,n)}function qI(r){const e=new Map;for(const t in r)e.set("".concat(t,".string"),JSON.stringify(r[t]));return e}const KI={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},LX={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},FX=4;class MX{constructor(e){W(this,"draco",void 0),W(this,"decoder",void 0),W(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=new this.draco.DecoderBuffer;n.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const i=this.decoder.GetEncodedGeometryType(n),s=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let a;switch(i){case this.draco.TRIANGULAR_MESH:a=this.decoder.DecodeBufferToMesh(n,s);break;case this.draco.POINT_CLOUD:a=this.decoder.DecodeBufferToPointCloud(n,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!a.ok()||!s.ptr){const x="DRACO decompression failed: ".concat(a.error_msg());throw new Error(x)}const o=this._getDracoLoaderData(s,i,t),A=this._getMeshData(s,o,t),f=dI(A.attributes),m=TX(A.attributes,o,A.indices);return{loader:"draco",loaderData:o,header:{vertexCount:s.num_points(),boundingBox:f},...A,schema:m}}finally{this.draco.destroy(n),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,t,n){const i=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,n);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:i,attributes:s}}_getDracoAttributes(e,t){const n={};for(let i=0;i<e.num_attributes();i++){const s=this.decoder.GetAttribute(e,i),a=this._getAttributeMetadata(e,i);n[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:i,metadata:a};const o=this._getQuantizationTransform(s,t);o&&(n[s.unique_id()].quantization_transform=o);const A=this._getOctahedronTransform(s,t);A&&(n[s.unique_id()].octahedron_transform=A)}return n}_getMeshData(e,t,n){const i=this._getMeshAttributes(t,e,n);if(!i.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(n.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:i}}_getMeshAttributes(e,t,n){const i={};for(const s of Object.values(e.attributes)){const a=this._deduceAttributeName(s,n);s.name=a;const{value:o,size:A}=this._getAttributeValues(t,s);i[a]={value:o,size:A,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return i}_getTriangleListIndices(e){const n=e.num_faces()*3,i=n*FX,s=this.draco._malloc(i);try{return this.decoder.GetTrianglesUInt32Array(e,i,s),new Uint32Array(this.draco.HEAPF32.buffer,s,n).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),RX(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const n=LX[t.data_type],i=t.num_components,a=e.num_points()*i,o=a*n.BYTES_PER_ELEMENT,A=PX(this.draco,n);let f;const m=this.draco._malloc(o);try{const v=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,v,A,o,m),f=new n(this.draco.HEAPF32.buffer,m,a).slice()}finally{this.draco._free(m)}return{value:f,size:i}}_deduceAttributeName(e,t){const n=e.unique_id;for(const[a,o]of Object.entries(t.extraAttributes||{}))if(o===n)return a;const i=e.attribute_type;for(const a in KI)if(this.draco[a]===i)return KI[a];const s=t.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:"CUSTOM_ATTRIBUTE_".concat(n)}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const n=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(n)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},n=this.metadataQuerier.NumEntries(e);for(let i=0;i<n;i++){const s=this.metadataQuerier.GetEntryName(e,i);t[s]=this._getDracoMetadataField(e,s)}return t}_getDracoMetadataField(e,t){const n=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,n);const i=UX(n);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:i}}finally{this.draco.destroy(n)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:n=[]}=e,i=[...t,...n];for(const s of i)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,t){const{quantizedAttributes:n=[]}=t,i=e.attribute_type();if(n.map(a=>this.decoder[a]).includes(i)){const a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(e))return{quantization_bits:a.quantization_bits(),range:a.range(),min_values:new Float32Array([1,2,3]).map(o=>a.min_value(o))}}finally{this.draco.destroy(a)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:n=[]}=t,i=e.attribute_type();if(n.map(a=>this.decoder[a]).includes(i)){const a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(e))return{quantization_bits:a.quantization_bits()}}finally{this.draco.destroy(a)}}return null}}function PX(r,e){switch(e){case Float32Array:return r.DT_FLOAT32;case Int8Array:return r.DT_INT8;case Int16Array:return r.DT_INT16;case Int32Array:return r.DT_INT32;case Uint8Array:return r.DT_UINT8;case Uint16Array:return r.DT_UINT16;case Uint32Array:return r.DT_UINT32;default:return r.DT_INVALID}}function UX(r){const e=r.size(),t=new Int32Array(e);for(let n=0;n<e;n++)t[n]=r.GetValue(n);return t}function RX(r){const e=r.size(),t=new Int32Array(e);for(let n=0;n<e;n++)t[n]=r.GetValue(n);return t}const mw="https://www.gstatic.com/draco/versioned/decoders/".concat("1.5.5"),OX="".concat(mw,"/draco_decoder.js"),DX="".concat(mw,"/draco_wasm_wrapper.js"),kX="".concat(mw,"/draco_decoder.wasm");let gg;async function NX(r){const e=r.modules||{};return e.draco3d?gg=gg||e.draco3d.createDecoderModule({}).then(t=>({draco:t})):gg=gg||QX(r),await gg}async function QX(r){let e,t;switch(r.draco&&r.draco.decoderType){case"js":e=await Ch(OX,"draco",r);break;case"wasm":default:[e,t]=await Promise.all([await Ch(DX,"draco",r),await Ch(kX,"draco",r)])}return e=e||globalThis.DracoDecoderModule,await HX(e,t)}function HX(r,e){const t={};return e&&(t.wasmBinary=e),new Promise(n=>{r({...t,onModuleLoaded:i=>n({draco:i})})})}const WI={...SX,parse:zX};async function zX(r,e){const{draco:t}=await NX(e),n=new MX(t);try{return n.parseSync(r,e==null?void 0:e.draco)}finally{n.destroy()}}function GX(r){const e={};for(const t in r){const n=r[t];if(t!=="indices"){const i=$I(n);e[t]=i}}return e}function $I(r){const{buffer:e,size:t,count:n}=VX(r);return{value:e,size:t,byteOffset:0,count:n,type:zI(t),componentType:GI(e)}}function VX(r){let e=r,t=1,n=0;return r&&r.value&&(e=r.value,t=r.size||1),e&&(ArrayBuffer.isView(e)||(e=jX(e,Float32Array)),n=e.length/t),{buffer:e,size:t,count:n}}function jX(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return r?Array.isArray(r)?new e(r):t&&!(r instanceof e)?new e(r):r:null}const Dh="KHR_draco_mesh_compression",qX=Dh;function KX(r,e,t){const n=new ca(r);for(const i of XI(n))n.getObjectExtension(i,Dh)}async function WX(r,e,t){var n;if(!(e!=null&&(n=e.gltf)!==null&&n!==void 0&&n.decompressMeshes))return;const i=new ca(r),s=[];for(const a of XI(i))i.getObjectExtension(a,Dh)&&s.push(XX(i,a,e,t));await Promise.all(s),i.removeExtension(Dh)}function $X(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=new ca(r);for(const n of t.json.meshes||[])JX(n,e),t.addRequiredExtension(Dh)}async function XX(r,e,t,n){const i=r.getObjectExtension(e,Dh);if(!i)return;const s=r.getTypedArrayForBufferView(i.bufferView),a=av(s.buffer,s.byteOffset),{parse:o}=n,A={...t};delete A["3d-tiles"];const f=await o(a,WI,A,n),m=GX(f.attributes);for(const[v,x]of Object.entries(m))if(v in e.attributes){const B=e.attributes[v],M=r.getAccessor(B);M!=null&&M.min&&M!==null&&M!==void 0&&M.max&&(x.min=M.min,x.max=M.max)}e.attributes=m,f.indices&&(e.indices=$I(f.indices)),YX(e)}function JX(r,e){var t;let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:4,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const a=i.DracoWriter.encodeSync({attributes:r}),o=s==null||(t=s.parseSync)===null||t===void 0?void 0:t.call(s,{attributes:r}),A=i._addFauxAttributes(o.attributes),f=i.addBufferView(a);return{primitives:[{attributes:A,mode:n,extensions:{[Dh]:{bufferView:f,attributes:A}}}]}}function YX(r){if(!r.attributes&&Object.keys(r.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*XI(r){for(const e of r.json.meshes||[])for(const t of e.primitives)yield t}const ZX=Object.freeze(Object.defineProperty({__proto__:null,decode:WX,encode:$X,name:qX,preprocess:KX},Symbol.toStringTag,{value:"Module"})),eJ={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},tJ={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},yw="KHR_texture_transform",rJ=yw,W0=new ut,nJ=new zi,iJ=new zi;async function sJ(r,e){if(!new ca(r).getExtension(yw))return;const i=r.json.materials||[];for(let s=0;s<i.length;s++)oJ(s,r)}function oJ(r,e){var t,n,i;const s=[],a=(t=e.json.materials)===null||t===void 0?void 0:t[r],o=a==null||(n=a.pbrMetallicRoughness)===null||n===void 0?void 0:n.baseColorTexture;o&&mg(e,r,o,s);const A=a==null?void 0:a.emissiveTexture;A&&mg(e,r,A,s);const f=a==null?void 0:a.normalTexture;f&&mg(e,r,f,s);const m=a==null?void 0:a.occlusionTexture;m&&mg(e,r,m,s);const v=a==null||(i=a.pbrMetallicRoughness)===null||i===void 0?void 0:i.metallicRoughnessTexture;v&&mg(e,r,v,s)}function mg(r,e,t,n){const i=aJ(t,n);if(!i)return;const s=r.json.meshes||[];for(const a of s)for(const o of a.primitives){const A=o.material;Number.isFinite(A)&&e===A&&cJ(r,o,i)}}function aJ(r,e){var t;const n=(t=r.extensions)===null||t===void 0?void 0:t[yw],{texCoord:i=0}=r,{texCoord:s=i}=n;if(!(e.findIndex(o=>{let[A,f]=o;return A===i&&f===s})!==-1)){const o=AJ(n);return i!==s&&(r.texCoord=s),e.push([i,s]),{originalTexCoord:i,texCoord:s,matrix:o}}return null}function cJ(r,e,t){const{originalTexCoord:n,texCoord:i,matrix:s}=t,a=e.attributes["TEXCOORD_".concat(n)];if(Number.isFinite(a)){var o;const f=(o=r.json.accessors)===null||o===void 0?void 0:o[a];if(f&&f.bufferView){var A;const m=(A=r.json.bufferViews)===null||A===void 0?void 0:A[f.bufferView];if(m){const{arrayBuffer:v,byteOffset:x}=r.buffers[m.buffer],B=(x||0)+(f.byteOffset||0)+(m.byteOffset||0),{ArrayType:M,length:U}=fw(f,m),N=tJ[f.componentType],Q=eJ[f.type],q=m.byteStride||N*Q,Y=new Float32Array(U);for(let te=0;te<f.count;te++){const pe=new M(v,B+te*q,2);W0.set(pe[0],pe[1],1),W0.transformByMatrix3(s),Y.set([W0[0],W0[1]],te*Q)}n===i?lJ(f,m,r.buffers,Y):uJ(i,f,e,r,Y)}}}}function lJ(r,e,t,n){r.componentType=5126,t.push({arrayBuffer:n.buffer,byteOffset:0,byteLength:n.buffer.byteLength}),e.buffer=t.length-1,e.byteLength=n.buffer.byteLength,e.byteOffset=0,delete e.byteStride}function uJ(r,e,t,n,i){n.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});const s=n.json.bufferViews;if(!s)return;s.push({buffer:n.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});const a=n.json.accessors;a&&(a.push({bufferView:(s==null?void 0:s.length)-1,byteOffset:0,componentType:5126,count:e.count,type:"VEC2"}),t.attributes["TEXCOORD_".concat(r)]=a.length-1)}function AJ(r){const{offset:e=[0,0],rotation:t=0,scale:n=[1,1]}=r,i=new zi().set(1,0,0,0,1,0,e[0],e[1],1),s=nJ.set(Math.cos(t),Math.sin(t),0,-Math.sin(t),Math.cos(t),0,0,0,1),a=iJ.set(n[0],0,0,0,n[1],0,0,0,1);return i.multiplyRight(s).multiplyRight(a)}const hJ=Object.freeze(Object.defineProperty({__proto__:null,decode:sJ,name:rJ},Symbol.toStringTag,{value:"Module"})),kh="KHR_lights_punctual",dJ=kh;async function fJ(r){const e=new ca(r),{json:t}=e,n=e.getExtension(kh);n&&(e.json.lights=n.lights,e.removeExtension(kh));for(const i of t.nodes||[]){const s=e.getObjectExtension(i,kh);s&&(i.light=s.light),e.removeObjectExtension(i,kh)}}async function pJ(r){const e=new ca(r),{json:t}=e;if(t.lights){const n=e.addExtension(kh);Ra(!n.lights),n.lights=t.lights,delete t.lights}if(e.json.lights){for(const n of e.json.lights){const i=n.node;e.addObjectExtension(i,kh,n)}delete e.json.lights}}const gJ=Object.freeze(Object.defineProperty({__proto__:null,decode:fJ,encode:pJ,name:dJ},Symbol.toStringTag,{value:"Module"})),yg="KHR_materials_unlit",mJ=yg;async function yJ(r){const e=new ca(r),{json:t}=e;for(const n of t.materials||[])n.extensions&&n.extensions.KHR_materials_unlit&&(n.unlit=!0),e.removeObjectExtension(n,yg);e.removeExtension(yg)}function _J(r){const e=new ca(r),{json:t}=e;if(e.materials)for(const n of t.materials||[])n.unlit&&(delete n.unlit,e.addObjectExtension(n,yg,{}),e.addExtension(yg))}const vJ=Object.freeze(Object.defineProperty({__proto__:null,decode:yJ,encode:_J,name:mJ},Symbol.toStringTag,{value:"Module"})),_g="KHR_techniques_webgl",bJ=_g;async function wJ(r){const e=new ca(r),{json:t}=e,n=e.getExtension(_g);if(n){const i=BJ(n,e);for(const s of t.materials||[]){const a=e.getObjectExtension(s,_g);a&&(s.technique=Object.assign({},a,i[a.technique]),s.technique.values=CJ(s.technique,e)),e.removeObjectExtension(s,_g)}e.removeExtension(_g)}}async function xJ(r,e){}function BJ(r,e){const{programs:t=[],shaders:n=[],techniques:i=[]}=r,s=new TextDecoder;return n.forEach(a=>{if(Number.isFinite(a.bufferView))a.code=s.decode(e.getTypedArrayForBufferView(a.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),t.forEach(a=>{a.fragmentShader=n[a.fragmentShader],a.vertexShader=n[a.vertexShader]}),i.forEach(a=>{a.program=t[a.program]}),i}function CJ(r,e){const t=Object.assign({},r.values);return Object.keys(r.uniforms||{}).forEach(n=>{r.uniforms[n].value&&!(n in t)&&(t[n]=r.uniforms[n].value)}),Object.keys(t).forEach(n=>{typeof t[n]=="object"&&t[n].index!==void 0&&(t[n].texture=e.getTexture(t[n].index))}),t}const EJ=Object.freeze(Object.defineProperty({__proto__:null,decode:wJ,encode:xJ,name:bJ},Symbol.toStringTag,{value:"Module"})),JI="EXT_feature_metadata",SJ=JI;async function TJ(r){const e=new ca(r);IJ(e)}function IJ(r){var e;const t=r.getExtension(JI),n=t==null||(e=t.schema)===null||e===void 0?void 0:e.classes,i=t==null?void 0:t.featureTables;if((t==null?void 0:t.featureTextures)&&console.warn('featureTextures is not yet supported in the "EXT_feature_metadata" extension.'),n&&i)for(const a in n){const o=n[a],A=MJ(i,a);A&&LJ(r,A,o)}}function LJ(r,e,t){for(const i in t.properties){var n;const s=t.properties[i],a=e==null||(n=e.properties)===null||n===void 0?void 0:n[i],o=e.count;if(a){const A=FJ(r,s,o,a);a.data=A}}}function FJ(r,e,t,n){const i=n.bufferView;let s=r.getTypedArrayForBufferView(i);switch(e.type){case"STRING":{const a=n.stringOffsetBufferView,o=r.getTypedArrayForBufferView(a);s=PJ(s,o,t);break}}return s}function MJ(r,e){for(const t in r){const n=r[t];if(n.class===e)return n}return null}function PJ(r,e,t){const n=[],i=new TextDecoder("utf8");let s=0;const a=4;for(let o=0;o<t;o++){const A=e[(o+1)*a]-e[o*a],f=r.subarray(s,A+s),m=i.decode(f);n.push(m),s+=A}return n}const YI=[vX,xX,EX,ZX,gJ,vJ,EJ,hJ,Object.freeze(Object.defineProperty({__proto__:null,decode:TJ,name:SJ},Symbol.toStringTag,{value:"Module"}))];function UJ(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0;const n=YI.filter(s=>ZI(s.name,e));for(const s of n){var i;(i=s.preprocess)===null||i===void 0||i.call(s,r,e,t)}}async function RJ(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0;const n=YI.filter(s=>ZI(s.name,e));for(const s of n){var i;await((i=s.decode)===null||i===void 0?void 0:i.call(s,r,e,t))}}function ZI(r,e){var t;const n=(e==null||(t=e.gltf)===null||t===void 0?void 0:t.excludeExtensions)||{};return!(r in n&&!n[r])}const _w="KHR_binary_glTF";function OJ(r){const e=new ca(r),{json:t}=e;for(const n of t.images||[]){const i=e.getObjectExtension(n,_w);i&&Object.assign(n,i),e.removeObjectExtension(n,_w)}t.buffers&&t.buffers[0]&&delete t.buffers[0].uri,e.removeExtension(_w)}const eL={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},DJ={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class kJ{constructor(){W(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),W(this,"json",void 0)}normalize(e,t){this.json=e.json;const n=e.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn("glTF: Unknown version ".concat(n.asset.version));return}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),OJ(e),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in eL)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const n=e[t];if(!(!n||Array.isArray(n))){e[t]=[];for(const i in n){const s=n[i];s.id=s.id||i;const a=e[t].length;e[t].push(s),this.idToIndexMap[t][i]=a}}}_convertObjectIdsToArrayIndices(e){for(const t in eL)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:n,indices:i,material:s}=t;for(const a in n)n[a]=this._convertIdToIndex(n[a],"accessor");i&&(t.indices=this._convertIdToIndex(i,"accessor")),s&&(t.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(t=>this._convertIdToIndex(t,"node"))),e.meshes&&(e.meshes=e.meshes.map(t=>this._convertIdToIndex(t,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(t=>this._convertIdToIndex(t,"node")))}_convertIdsToIndices(e,t){e[t]||(console.warn("gltf v1: json doesn't contain attribute ".concat(t)),e[t]=[]);for(const n of e[t])for(const i in n){const s=n[i],a=this._convertIdToIndex(s,i);n[i]=a}}_convertIdToIndex(e,t){const n=DJ[t];if(n in this.idToIndexMap){const i=this.idToIndexMap[n][e];if(!Number.isFinite(i))throw new Error("gltf v1: failed to resolve ".concat(t," with id ").concat(e));return i}return e}_updateObjects(e){for(const t of this.json.buffers)delete t.type}_updateMaterial(e){for(const s of e.materials){var t,n,i;s.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const a=((t=s.values)===null||t===void 0?void 0:t.tex)||((n=s.values)===null||n===void 0?void 0:n.texture2d_0)||((i=s.values)===null||i===void 0?void 0:i.diffuseTex),o=e.textures.findIndex(A=>A.id===a);o!==-1&&(s.pbrMetallicRoughness.baseColorTexture={index:o})}}}function NJ(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new kJ().normalize(r,e)}const QJ={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},HJ={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},ic={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},zJ={magFilter:ic.TEXTURE_MAG_FILTER,minFilter:ic.TEXTURE_MIN_FILTER,wrapS:ic.TEXTURE_WRAP_S,wrapT:ic.TEXTURE_WRAP_T},GJ={[ic.TEXTURE_MAG_FILTER]:ic.LINEAR,[ic.TEXTURE_MIN_FILTER]:ic.NEAREST_MIPMAP_LINEAR,[ic.TEXTURE_WRAP_S]:ic.REPEAT,[ic.TEXTURE_WRAP_T]:ic.REPEAT};function VJ(r){return HJ[r]}function jJ(r){return QJ[r]}class qJ{constructor(){W(this,"baseUri",""),W(this,"json",{}),W(this,"buffers",[]),W(this,"images",[])}postProcess(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{json:n,buffers:i=[],images:s=[],baseUri:a=""}=e;return Ra(n),this.baseUri=a,this.json=n,this.buffers=i,this.images=s,this._resolveTree(this.json,t),this.json}_resolveTree(e){e.bufferViews&&(e.bufferViews=e.bufferViews.map((t,n)=>this._resolveBufferView(t,n))),e.images&&(e.images=e.images.map((t,n)=>this._resolveImage(t,n))),e.samplers&&(e.samplers=e.samplers.map((t,n)=>this._resolveSampler(t,n))),e.textures&&(e.textures=e.textures.map((t,n)=>this._resolveTexture(t,n))),e.accessors&&(e.accessors=e.accessors.map((t,n)=>this._resolveAccessor(t,n))),e.materials&&(e.materials=e.materials.map((t,n)=>this._resolveMaterial(t,n))),e.meshes&&(e.meshes=e.meshes.map((t,n)=>this._resolveMesh(t,n))),e.nodes&&(e.nodes=e.nodes.map((t,n)=>this._resolveNode(t,n))),e.skins&&(e.skins=e.skins.map((t,n)=>this._resolveSkin(t,n))),e.scenes&&(e.scenes=e.scenes.map((t,n)=>this._resolveScene(t,n))),e.scene!==void 0&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,t){if(typeof t=="object")return t;const n=this.json[e]&&this.json[e][t];return n||console.warn("glTF file error: Could not find ".concat(e,"[").concat(t,"]")),n}_resolveScene(e,t){return e.id=e.id||"scene-".concat(t),e.nodes=(e.nodes||[]).map(n=>this.getNode(n)),e}_resolveNode(e,t){return e.id=e.id||"node-".concat(t),e.children&&(e.children=e.children.map(n=>this.getNode(n))),e.mesh!==void 0?e.mesh=this.getMesh(e.mesh):e.meshes!==void 0&&e.meshes.length&&(e.mesh=e.meshes.reduce((n,i)=>{const s=this.getMesh(i);return n.id=s.id,n.primitives=n.primitives.concat(s.primitives),n},{primitives:[]})),e.camera!==void 0&&(e.camera=this.getCamera(e.camera)),e.skin!==void 0&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,t){return e.id=e.id||"skin-".concat(t),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,t){return e.id=e.id||"mesh-".concat(t),e.primitives&&(e.primitives=e.primitives.map(n=>{n={...n};const i=n.attributes;n.attributes={};for(const s in i)n.attributes[s]=this.getAccessor(i[s]);return n.indices!==void 0&&(n.indices=this.getAccessor(n.indices)),n.material!==void 0&&(n.material=this.getMaterial(n.material)),n})),e}_resolveMaterial(e,t){if(e.id=e.id||"material-".concat(t),e.normalTexture&&(e.normalTexture={...e.normalTexture},e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture={...e.occlustionTexture},e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture={...e.emmisiveTexture},e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness={...e.pbrMetallicRoughness};const n=e.pbrMetallicRoughness;n.baseColorTexture&&(n.baseColorTexture={...n.baseColorTexture},n.baseColorTexture.texture=this.getTexture(n.baseColorTexture.index)),n.metallicRoughnessTexture&&(n.metallicRoughnessTexture={...n.metallicRoughnessTexture},n.metallicRoughnessTexture.texture=this.getTexture(n.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,t){if(e.id=e.id||"accessor-".concat(t),e.bufferView!==void 0&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=VJ(e.componentType),e.components=jJ(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const n=e.bufferView.buffer,{ArrayType:i,byteLength:s}=fw(e,e.bufferView),a=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+n.byteOffset;let o=n.arrayBuffer.slice(a,a+s);e.bufferView.byteStride&&(o=this._getValueFromInterleavedBuffer(n,a,e.bufferView.byteStride,e.bytesPerElement,e.count)),e.value=new i(o)}return e}_getValueFromInterleavedBuffer(e,t,n,i,s){const a=new Uint8Array(s*i);for(let o=0;o<s;o++){const A=t+o*n;a.set(new Uint8Array(e.arrayBuffer.slice(A,A+i)),o*i)}return a.buffer}_resolveTexture(e,t){return e.id=e.id||"texture-".concat(t),e.sampler="sampler"in e?this.getSampler(e.sampler):GJ,e.source=this.getImage(e.source),e}_resolveSampler(e,t){e.id=e.id||"sampler-".concat(t),e.parameters={};for(const n in e){const i=this._enumSamplerParameter(n);i!==void 0&&(e.parameters[i]=e[n])}return e}_enumSamplerParameter(e){return zJ[e]}_resolveImage(e,t){e.id=e.id||"image-".concat(t),e.bufferView!==void 0&&(e.bufferView=this.getBufferView(e.bufferView));const n=this.images[t];return n&&(e.image=n),e}_resolveBufferView(e,t){const n=e.buffer,i={id:"bufferView-".concat(t),...e,buffer:this.buffers[n]},s=this.buffers[n].arrayBuffer;let a=this.buffers[n].byteOffset||0;return"byteOffset"in e&&(a+=e.byteOffset),i.data=new Uint8Array(s,a,e.byteLength),i}_resolveCamera(e,t){return e.id=e.id||"camera-".concat(t),e.perspective,e.orthographic,e}}function KJ(r,e){return new qJ().postProcess(r,e)}const tL=1735152710,vw=12,$0=8,WJ=1313821514,$J=5130562,XJ=0,JJ=1,YJ=0,lf=!0;function ZJ(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return"".concat(String.fromCharCode(r.getUint8(e+0))).concat(String.fromCharCode(r.getUint8(e+1))).concat(String.fromCharCode(r.getUint8(e+2))).concat(String.fromCharCode(r.getUint8(e+3)))}function eY(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=new DataView(r),{magic:i=tL}=t,s=n.getUint32(e,!1);return s===i||s===tL}function tY(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const n=new DataView(e),i=ZJ(n,t+0),s=n.getUint32(t+4,lf),a=n.getUint32(t+8,lf);switch(Object.assign(r,{header:{byteOffset:t,byteLength:a,hasBinChunk:!1},type:i,version:s,json:{},binChunks:[]}),t+=vw,r.version){case 1:return rY(r,n,t);case 2:return nY(r,n,t,{});default:throw new Error("Invalid GLB version ".concat(r.version,". Only supports v1 and v2."))}}function rY(r,e,t){ci(r.header.byteLength>vw+$0);const n=e.getUint32(t+0,lf),i=e.getUint32(t+4,lf);return t+=$0,ci(i===YJ),bw(r,e,t,n),t+=n,t+=ww(r,e,t,r.header.byteLength),t}function nY(r,e,t,n){return ci(r.header.byteLength>vw+$0),iY(r,e,t,n),t+r.header.byteLength}function iY(r,e,t,n){for(;t+8<=r.header.byteLength;){const i=e.getUint32(t+0,lf),s=e.getUint32(t+4,lf);switch(t+=$0,s){case WJ:bw(r,e,t,i);break;case $J:ww(r,e,t,i);break;case XJ:n.strict||bw(r,e,t,i);break;case JJ:n.strict||ww(r,e,t,i);break}t+=Mp(i,4)}return t}function bw(r,e,t,n){const i=new Uint8Array(e.buffer,t,n),a=new TextDecoder("utf8").decode(i);return r.json=JSON.parse(a),Mp(n,4)}function ww(r,e,t,n){return r.header.hasBinChunk=!0,r.binChunks.push({byteOffset:t,byteLength:n,arrayBuffer:e.buffer}),Mp(n,4)}async function sY(r,e){var t,n,i,s;let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3?arguments[3]:void 0,A=arguments.length>4?arguments[4]:void 0;oY(r,e,a,o),NJ(r,{normalize:o==null||(t=o.gltf)===null||t===void 0?void 0:t.normalize}),UJ(r,o,A);const f=[];if(o!=null&&(n=o.gltf)!==null&&n!==void 0&&n.loadBuffers&&r.json.buffers&&await aY(r,o,A),o!=null&&(i=o.gltf)!==null&&i!==void 0&&i.loadImages){const v=cY(r,o,A);f.push(v)}const m=RJ(r,o,A);return f.push(m),await Promise.all(f),o!=null&&(s=o.gltf)!==null&&s!==void 0&&s.postProcess?KJ(r,o):r}function oY(r,e,t,n){if(n.uri&&(r.baseUri=n.uri),e instanceof ArrayBuffer&&!eY(e,t,n)&&(e=new TextDecoder().decode(e)),typeof e=="string")r.json=SN(e);else if(e instanceof ArrayBuffer){const a={};t=tY(a,e,t,n.glb),Ra(a.type==="glTF","Invalid GLB magic string ".concat(a.type)),r._glb=a,r.json=a.json}else Ra(!1,"GLTF: must be ArrayBuffer or string");const i=r.json.buffers||[];if(r.buffers=new Array(i.length).fill(null),r._glb&&r._glb.header.hasBinChunk){const{binChunks:a}=r._glb;r.buffers[0]={arrayBuffer:a[0].arrayBuffer,byteOffset:a[0].byteOffset,byteLength:a[0].byteLength}}const s=r.json.images||[];r.images=new Array(s.length).fill({})}async function aY(r,e,t){const n=r.json.buffers||[];for(let a=0;a<n.length;++a){const o=n[a];if(o.uri){var i,s;const{fetch:A}=t;Ra(A);const f=QI(o.uri,e),m=await(t==null||(i=t.fetch)===null||i===void 0?void 0:i.call(t,f)),v=await(m==null||(s=m.arrayBuffer)===null||s===void 0?void 0:s.call(m));r.buffers[a]={arrayBuffer:v,byteOffset:0,byteLength:v.byteLength},delete o.uri}else r.buffers[a]===null&&(r.buffers[a]={arrayBuffer:new ArrayBuffer(o.byteLength),byteOffset:0,byteLength:o.byteLength})}}async function cY(r,e,t){const n=lY(r),i=r.json.images||[],s=[];for(const a of n)s.push(uY(r,i[a],a,e,t));return await Promise.all(s)}function lY(r){const e=new Set,t=r.json.textures||[];for(const n of t)n.source!==void 0&&e.add(n.source);return Array.from(e).sort()}async function uY(r,e,t,n,i){const{fetch:s,parse:a}=i;let o;if(e.uri&&!e.hasOwnProperty("bufferView")){const f=QI(e.uri,n);o=await(await s(f)).arrayBuffer(),e.bufferView={data:o}}if(Number.isFinite(e.bufferView)){const f=Z$(r.json,r.buffers,e.bufferView);o=av(f.buffer,f.byteOffset,f.byteLength)}Ra(o,"glTF image has no data");let A=await a(o,[HS,Y$],{mimeType:e.mimeType,basis:n.basis||{format:NI()}},i);A&&A[0]&&(A={compressed:!0,mipmaps:!1,width:A[0].width,height:A[0].height,data:A[0]}),r.images=r.images||[],r.images[t]=A}const vg={name:"glTF",id:"gltf",module:"gltf",version:O$,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:AY,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};async function AY(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0;e={...vg.options,...e},e.gltf={...vg.options.gltf,...e.gltf};const{byteOffset:n=0}=e;return await sY({},r,n,e,t)}async function hY(r){const e=[];return r.scenes.forEach(t=>{t.traverse(n=>{Object.values(n.model.getUniforms()).forEach(i=>{i.loaded===!1&&e.push(i)})})}),await dY(()=>e.some(t=>!t.loaded))}async function dY(r){for(;r();)await new Promise(e=>requestAnimationFrame(e))}const fY=`#version 300 es
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform mat4 sceneModelMatrix;
uniform bool composeModelMatrix;
in vec4 POSITION;

#ifdef HAS_UV
  in vec2 TEXCOORD_0;
#endif

#ifdef MODULE_PBR
  #ifdef HAS_NORMALS
    in vec4 NORMAL;
  #endif
#endif
out vec4 vColor;
#ifndef MODULE_PBR
  #ifdef HAS_UV
    out vec2 vTEXCOORD_0;
  #endif
#endif
void main(void) {
  #if defined(HAS_UV) && !defined(MODULE_PBR)
    vTEXCOORD_0 = TEXCOORD_0;
    geometry.uv = vTEXCOORD_0;
  #endif

  geometry.worldPosition = instancePositions;
  geometry.pickingColor = instancePickingColors;

  vec3 normal = vec3(0.0, 0.0, 1.0);
  #ifdef MODULE_PBR
    #ifdef HAS_NORMALS
      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;
    #endif
  #endif

  float originalSize = project_size_to_pixel(sizeScale);
  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);

  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;
  if(composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    geometry.normal = project_normal(normal);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);
    geometry.normal = project_normal(normal);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = TEXCOORD_0;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,pY=`#version 300 es
uniform float opacity;
in vec4 vColor;

out vec4 fragmentColor;
#ifndef MODULE_PBR
  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
    in vec2 vTEXCOORD_0;
    uniform sampler2D u_BaseColorSampler;
  #endif
#endif

void main(void) {
  #ifdef MODULE_PBR
    fragmentColor = vColor * pbr_filterColor(vec4(0));
    geometry.uv = pbr_vUV;
  #else
    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);
      geometry.uv = vTEXCOORD_0;
    #else
      fragmentColor = vColor;
    #endif
  #endif

  fragmentColor.a *= opacity;
  DECKGL_FILTER_COLOR(fragmentColor, geometry);
}
`,rL=[255,255,255,255],gY={scenegraph:{type:"object",value:null,async:!0},getScene:r=>r&&r.scenes?typeof r.scene=="object"?r.scene:r.scenes[r.scene||0]:r,getAnimator:r=>r&&r.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:r=>r.position},getColor:{type:"accessor",value:rL},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[vg]};class xw extends rf{constructor(){super(...arguments),W(this,"state",void 0)}getShaders(){const e=[Ub,Rb];return this.props._lighting==="pbr"&&e.push(vb),super.getShaders({vs:fY,fs:pY,modules:e})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:rL,transition:!0},instanceModelMatrix:AI})}updateState(e){super.updateState(e);const{props:t,oldProps:n}=e;t.scenegraph!==n.scenegraph?this._updateScenegraph():t._animations!==n._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,t._animations)}finalizeState(e){super.finalizeState(e),this._deleteScenegraph()}get isLoaded(){var e;return((e=this.state)===null||e===void 0?void 0:e.scenegraph)&&super.isLoaded}_updateScenegraph(){const e=this.props,{gl:t}=this.context;let n=null;if(e.scenegraph instanceof of)n={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){const o=e.scenegraph,A=R$(t,o,this._getModelOptions());n={gltf:o,...A},hY(A).then(()=>this.setNeedsRedraw())}else e.scenegraph&&(Mn.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),n=e.scenegraph);const i={layer:this,gl:t},s=e.getScene(n,i),a=e.getAnimator(n,i);s instanceof of?(this._deleteScenegraph(),this._applyAllAttributes(s),this._applyAnimationsProp(s,a,e._animations),this.setState({scenegraph:s,animator:a})):s!==null&&Mn.warn("invalid scenegraph:",s)()}_applyAllAttributes(e){if(this.state.attributesAvailable){const t=this.getAttributeManager().getAttributes();e.traverse(n=>{this._setModelAttributes(n.model,t)})}}_applyAnimationsProp(e,t,n){if(!e||!t||!n)return;const i=t.getAnimations();Object.keys(n).sort().forEach(s=>{const a=n[s];if(s==="*")i.forEach(o=>{Object.assign(o,a)});else if(Number.isFinite(Number(s))){const o=Number(s);o>=0&&o<i.length?Object.assign(i[o],a):Mn.warn("animation ".concat(s," not found"))()}else{const o=i.find(A=>{let{name:f}=A;return f===s});o?Object.assign(o,a):Mn.warn("animation ".concat(s," not found"))()}})}_deleteScenegraph(){const{scenegraph:e}=this.state;e instanceof of&&e.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:e}=this.props;let t=null;return e&&(typeof e=="function"?t=e({gl:this.context.gl,layer:this}):t=e),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:t,modelOptions:{isInstanced:!0,transpileToGLSL100:!gn(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(e){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(t=>{this._setModelAttributes(t.model,e)})}draw(e){let{moduleParameters:t=null,parameters:n={},context:i}=e;if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(i.timeline.getTime()),this.setNeedsRedraw());const{viewport:s}=this.context,{sizeScale:a,sizeMinPixels:o,sizeMaxPixels:A,opacity:f,coordinateSystem:m}=this.props,v=this.getNumInstances();this.state.scenegraph.traverse((x,B)=>{let{worldMatrix:M}=B;x.model.setInstanceCount(v),x.updateModuleSettings(t),x.draw({parameters:n,uniforms:{sizeScale:a,opacity:f,sizeMinPixels:o,sizeMaxPixels:A,composeModelMatrix:hI(s,m),sceneModelMatrix:M,u_Camera:x.model.getUniforms().project_uCameraPosition}})})}}W(xw,"defaultProps",gY),W(xw,"layerName","ScenegraphLayer");const mY=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
uniform bool pickFeatureIds;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec4 uvRegions;
in vec3 featureIdsPickingColors;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

vec2 applyUVRegion(vec2 uv) {
  #ifdef HAS_UV_REGIONS
    return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;
  #else
    return uv;
  #endif
}

void main(void) {
  vec2 uv = applyUVRegion(texCoords);
  geometry.uv = uv;

  if (pickFeatureIds) {
    geometry.pickingColor = featureIdsPickingColors;
  } else {
    geometry.pickingColor = instancePickingColors;
  }

  vTexCoord = uv;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale;
  vec3 projectedPosition = project_position(positions);
  position_commonspace = vec4(projectedPosition, 1.0);
  gl_Position = project_common_position_to_clipspace(position_commonspace);

  geometry.position = position_commonspace;
  normals_commonspace = project_normal(instanceModelMatrix * normals);
  geometry.normal = normals_commonspace;

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = uv;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,yY=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  
#ifdef MODULE_PBR

  fragColor = vColor * pbr_filterColor(vec4(0));
  geometry.uv = pbr_vUV;
  fragColor.a *= opacity;

#else

  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);

#endif

  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function _Y(r){r.COLOR_0||r.colors||(r.colors={constant:!0,value:new Float32Array([1,1,1])})}const vY={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}};class Bw extends lw{getShaders(){const e=super.getShaders();return e.modules.push(vb),{...e,vs:mY,fs:yY}}initializeState(){const{featureIds:e}=this.props;super.initializeState();const t=this.getAttributeManager();e&&t.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState(e){super.updateState(e);const{props:t,oldProps:n}=e;t.pbrMaterial!==n.pbrMaterial&&this.updatePbrMaterialUniforms(t.pbrMaterial)}draw(e){const{featureIds:t}=this.props;this.state.model&&(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,pickFeatureIds:!!t}),super.draw(e))}getModel(e){const{id:t,pbrMaterial:n}=this.props,i=this.parseMaterial(n,e);this.setState({materialParser:i});const s=this.getShaders();return _Y(e.attributes),new qd(this.context.gl,{...this.getShaders(),id:t,geometry:e,defines:{...s.defines,...i==null?void 0:i.defines,HAS_UV_REGIONS:e.attributes.uvRegions},parameters:i==null?void 0:i.parameters,isInstanced:!0})}updatePbrMaterialUniforms(e){const{model:t}=this.state;if(t){const{mesh:n}=this.props,i=this.parseMaterial(e,n);this.setState({materialParser:i}),t.setUniforms(i.uniforms)}}parseMaterial(e,t){var n;const i=!!(e.pbrMetallicRoughness&&e.pbrMetallicRoughness.baseColorTexture);return(n=this.state.materialParser)===null||n===void 0||n.delete(),new xI(this.context.gl,{attributes:{NORMAL:t.attributes.normals,TEXCOORD_0:t.attributes.texCoords},material:{unlit:i,...e},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(e){const t=this.props.featureIds,n=new Uint8ClampedArray(t.length*e.size),i=[];for(let s=0;s<t.length;s++)this.encodePickingColor(t[s],i),n[s*3]=i[0],n[s*3+1]=i[1],n[s*3+2]=i[2];e.value=n}finalizeState(e){var t;super.finalizeState(e),(t=this.state.materialParser)===null||t===void 0||t.delete(),this.setState({materialParser:null})}}W(Bw,"layerName","MeshLayer"),W(Bw,"defaultProps",vY);const bY=6378137,wY=6378137,xY=6356752314245179e-9;function X0(r){return r}new ut;function BY(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:X0;return"longitude"in r?(e[0]=t(r.longitude),e[1]=t(r.latitude),e[2]=r.height):"x"in r?(e[0]=t(r.x),e[1]=t(r.y),e[2]=r.z):(e[0]=t(r[0]),e[1]=t(r[1]),e[2]=r[2]),e}function CY(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return BY(r,e,xs._cartographicRadians?X0:O9)}function EY(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:X0;return"longitude"in e?(e.longitude=t(r[0]),e.latitude=t(r[1]),e.height=r[2]):"x"in e?(e.x=t(r[0]),e.y=t(r[1]),e.z=r[2]):(e[0]=t(r[0]),e[1]=t(r[1]),e[2]=r[2]),e}function SY(r,e){return EY(r,e,xs._cartographicRadians?X0:D9)}const uf=new ut,TY=new ut,IY=new ut;function LY(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const{oneOverRadii:n,oneOverRadiiSquared:i,centerToleranceSquared:s}=e;uf.from(r);const a=uf.x,o=uf.y,A=uf.z,f=n.x,m=n.y,v=n.z,x=a*a*f*f,B=o*o*m*m,M=A*A*v*v,U=x+B+M,N=Math.sqrt(1/U);if(!Number.isFinite(N))return;const Q=TY;if(Q.copy(r).scale(N),U<s)return Q.to(t);const q=i.x,Y=i.y,te=i.z,pe=IY;pe.set(Q.x*q*2,Q.y*Y*2,Q.z*te*2);let ge=(1-N)*uf.len()/(.5*pe.len()),ye=0,fe,Oe,Fe,oe;do{ge-=ye,fe=1/(1+ge*q),Oe=1/(1+ge*Y),Fe=1/(1+ge*te);const le=fe*fe,xe=Oe*Oe,_e=Fe*Fe,tt=le*fe,et=xe*Oe,nt=_e*Fe;oe=x*le+B*xe+M*_e-1;const it=-2*(x*tt*q+B*et*Y+M*nt*te);ye=oe/it}while(Math.abs(oe)>tg.EPSILON12);return uf.scale([fe,Oe,Fe]).to(t)}const nL=1e-14,FY=new ut,iL={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Cw={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},bg={east:new ut,north:new ut,up:new ut,west:new ut,south:new ut,down:new ut},MY=new ut,PY=new ut,UY=new ut;function sL(r,e,t,n,i,s){const a=iL[e]&&iL[e][t];kc(a&&(!n||n===a));let o,A,f;const m=FY.copy(i);if(Nc(m.x,0,nL)&&Nc(m.y,0,nL)){const x=Math.sign(m.z);o=MY.fromArray(Cw[e]),e!=="east"&&e!=="west"&&o.scale(x),A=PY.fromArray(Cw[t]),t!=="east"&&t!=="west"&&A.scale(x),f=UY.fromArray(Cw[n]),n!=="east"&&n!=="west"&&f.scale(x)}else{const{up:x,east:B,north:M}=bg;B.set(-m.y,m.x,0).normalize(),r.geodeticSurfaceNormal(m,x),M.copy(x).cross(B);const{down:U,west:N,south:Q}=bg;U.copy(x).scale(-1),N.copy(B).scale(-1),Q.copy(M).scale(-1),o=bg[e],A=bg[t],f=bg[n]}return s[0]=o.x,s[1]=o.y,s[2]=o.z,s[3]=0,s[4]=A.x,s[5]=A.y,s[6]=A.z,s[7]=0,s[8]=f.x,s[9]=f.y,s[10]=f.z,s[11]=0,s[12]=m.x,s[13]=m.y,s[14]=m.z,s[15]=1,s}const J0=new ut,oL=new ut,RY=new ut,Gc=new ut,OY=new ut,Y0=new ut;class Mi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;W(this,"radii",void 0),W(this,"radiiSquared",void 0),W(this,"radiiToTheFourth",void 0),W(this,"oneOverRadii",void 0),W(this,"oneOverRadiiSquared",void 0),W(this,"minimumRadius",void 0),W(this,"maximumRadius",void 0),W(this,"centerToleranceSquared",tg.EPSILON1),W(this,"squaredXOverSquaredZ",void 0),kc(e>=0),kc(t>=0),kc(n>=0),this.radii=new ut(e,t,n),this.radiiSquared=new ut(e*e,t*t,n*n),this.radiiToTheFourth=new ut(e*e*e*e,t*t*t*t,n*n*n*n),this.oneOverRadii=new ut(e===0?0:1/e,t===0?0:1/t,n===0?0:1/n),this.oneOverRadiiSquared=new ut(e===0?0:1/(e*e),t===0?0:1/(t*t),n===0?0:1/(n*n)),this.minimumRadius=Math.min(e,t,n),this.maximumRadius=Math.max(e,t,n),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(e){return this===e||!!(e&&this.radii.equals(e.radii))}toString(){return this.radii.toString()}cartographicToCartesian(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const n=oL,i=RY,[,,s]=e;this.geodeticSurfaceNormalCartographic(e,n),i.copy(this.radiiSquared).scale(n);const a=Math.sqrt(n.dot(i));return i.scale(1/a),n.scale(s),i.add(n),i.to(t)}cartesianToCartographic(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];Y0.from(e);const n=this.scaleToGeodeticSurface(Y0,Gc);if(!n)return;const i=this.geodeticSurfaceNormal(n,oL),s=OY;s.copy(Y0).subtract(n);const a=Math.atan2(i.y,i.x),o=Math.asin(i.z),A=Math.sign(cb(s,Y0))*yT(s);return SY([a,o,A],t)}eastNorthUpToFixedFrame(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Bn;return sL(this,"east","north","up",e,t)}localFrameToFixedFrame(e,t,n,i){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:new Bn;return sL(this,e,t,n,i,s)}geocentricSurfaceNormal(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return J0.from(e).normalize().to(t)}geodeticSurfaceNormalCartographic(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const n=CY(e),i=n[0],s=n[1],a=Math.cos(s);return J0.set(a*Math.cos(i),a*Math.sin(i),Math.sin(s)).normalize(),J0.to(t)}geodeticSurfaceNormal(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return J0.from(e).scale(this.oneOverRadiiSquared).normalize().to(t)}scaleToGeodeticSurface(e,t){return LY(e,this,t)}scaleToGeocentricSurface(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];Gc.from(e);const n=Gc.x,i=Gc.y,s=Gc.z,a=this.oneOverRadiiSquared,o=1/Math.sqrt(n*n*a.x+i*i*a.y+s*s*a.z);return Gc.multiplyScalar(o).to(t)}transformPositionToScaledSpace(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return Gc.from(e).scale(this.oneOverRadii).to(t)}transformPositionFromScaledSpace(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return Gc.from(e).scale(this.radii).to(t)}getSurfaceNormalIntersectionWithZAxis(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[0,0,0];kc(Nc(this.radii.x,this.radii.y,tg.EPSILON15)),kc(this.radii.z>0),Gc.from(e);const i=Gc.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(i)>=this.radii.z-t))return Gc.set(0,0,i).to(n)}}W(Mi,"WGS84",new Mi(bY,wY,xY));function aL(){let r;if(typeof window<"u"&&window.performance)r=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();r=e[0]*1e3+e[1]/1e6}else r=Date.now();return r}class cL{constructor(e,t){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=aL(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(aL()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class DY{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const t of Object.values(this.stats))e(t)}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(t=>this._getOrCreate(t))}_getOrCreate(e){const{name:t,type:n}=e;let i=this.stats[t];return i||(e instanceof cL?i=e:i=new cL(t,n),this.stats[t]=i),i}}class kY{constructor(e,t,n){W(this,"item",void 0),W(this,"previous",void 0),W(this,"next",void 0),this.item=e,this.previous=t,this.next=n}}class NY{constructor(){W(this,"head",null),W(this,"tail",null),W(this,"_length",0)}get length(){return this._length}add(e){const t=new kY(e,this.tail,null);return this.tail?(this.tail.next=t,this.tail=t):(this.head=t,this.tail=t),++this._length,t}remove(e){e&&(e.previous&&e.next?(e.previous.next=e.next,e.next.previous=e.previous):e.previous?(e.previous.next=null,this.tail=e.previous):e.next?(e.next.previous=null,this.head=e.next):(this.head=null,this.tail=null),e.next=null,e.previous=null,--this._length)}splice(e,t){e!==t&&(this.remove(t),this._insert(e,t))}_insert(e,t){const n=e.next;e.next=t,this.tail===e?this.tail=t:n.previous=t,t.next=n,t.previous=e,++this._length}}class QY{constructor(){W(this,"_list",void 0),W(this,"_sentinel",void 0),W(this,"_trimTiles",void 0),this._list=new NY,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(e){const t=e._cacheNode;t&&this._list.splice(this._sentinel,t)}add(e,t,n){t._cacheNode||(t._cacheNode=this._list.add(t),n&&n(e,t))}unloadTile(e,t,n){const i=t._cacheNode;i&&(this._list.remove(i),t._cacheNode=null,n&&n(e,t))}unloadTiles(e,t){const n=this._trimTiles;this._trimTiles=!1;const i=this._list,s=e.maximumMemoryUsage*1024*1024,a=this._sentinel;let o=i.head;for(;o!==a&&(e.gpuMemoryUsageInBytes>s||n);){const A=o.item;o=o.next,this.unloadTile(e,A,t)}}trim(){this._trimTiles=!0}}function HY(r,e){ci(r),ci(e);const{rtcCenter:t,gltfUpAxis:n}=e,{computedTransform:i,boundingVolume:{center:s}}=r;let a=new Bn(i);switch(t&&a.translate(t),n){case"Z":break;case"Y":const v=new Bn().rotateX(Math.PI/2);a=a.multiplyRight(v);break;case"X":const x=new Bn().rotateY(-Math.PI/2);a=a.multiplyRight(x);break}e.isQuantized&&a.translate(e.quantizedVolumeOffset).scale(e.quantizedVolumeScale);const o=new ut(s);e.cartesianModelMatrix=a,e.cartesianOrigin=o;const A=Mi.WGS84.cartesianToCartographic(o,new ut),m=Mi.WGS84.eastNorthUpToFixedFrame(o).invert();e.cartographicModelMatrix=m.multiplyRight(a),e.cartographicOrigin=A,e.coordinateSystem||(e.modelMatrix=e.cartographicModelMatrix)}const lL=new ut,Ew=new ut,Sw=new nc([new zc,new zc,new zc,new zc,new zc,new zc]);function zY(r,e){const{cameraDirection:t,cameraUp:n,height:i}=r,{metersPerUnit:s}=r.distanceScales,a=Z0(r,r.center),o=Mi.WGS84.eastNorthUpToFixedFrame(a),A=r.unprojectPosition(r.cameraPosition),f=Mi.WGS84.cartographicToCartesian(A,new ut),m=new ut(o.transformAsVector(new ut(t).scale(s))).normalize(),v=new ut(o.transformAsVector(new ut(n).scale(s))).normalize();VY(r);const x=r.constructor,{longitude:B,latitude:M,width:U,bearing:N,zoom:Q}=r,q=new x({longitude:B,latitude:M,height:i,width:U,bearing:N,zoom:Q,pitch:0});return{camera:{position:f,direction:m,up:v},viewport:r,topDownViewport:q,height:i,cullingVolume:Sw,frameNumber:e,sseDenominator:1.15}}function GY(r,e,t){if(t===0||r.length<=t)return[r,[]];const n=[],{longitude:i,latitude:s}=e.viewport;for(const[f,m]of r.entries()){const[v,x]=m.header.mbs,B=Math.abs(i-v),M=Math.abs(s-x),U=Math.sqrt(M*M+B*B);n.push([f,U])}const a=n.sort((f,m)=>f[1]-m[1]),o=[];for(let f=0;f<t;f++)o.push(r[a[f][0]]);const A=[];for(let f=t;f<a.length;f++)A.push(r[a[f][0]]);return[o,A]}function VY(r){const e=r.getFrustumPlanes(),t=uL(e.near,r.cameraPosition),n=Z0(r,t),i=Z0(r,r.cameraPosition,Ew);let s=0;Sw.planes[s++].fromPointNormal(n,lL.copy(n).subtract(i));for(const a in e){if(a==="near")continue;const o=e[a],A=uL(o,t,Ew),f=Z0(r,A,Ew);Sw.planes[s++].fromPointNormal(f,lL.copy(n).subtract(f))}}function uL(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new ut;const n=r.normal.dot(e);return t.copy(r.normal).scale(r.distance-n).add(e),t}function Z0(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new ut;const n=r.unprojectPosition(e);return Mi.WGS84.cartographicToCartesian(n,t)}const jY=6378137,qY=6378137,Tw=6356752314245179e-9,AL=new ut;function KY(r,e){if(r instanceof fg){const{halfAxes:t}=r,n=$Y(t);return Math.log2(Tw/(n+e[2]))}else if(r instanceof dg){const{radius:t}=r;return Math.log2(Tw/(t+e[2]))}else if(r.width&&r.height){const{width:t,height:n}=r,i=Math.log2(jY/t),s=Math.log2(qY/n);return(i+s)/2}return 1}function hL(r,e,t){const n=Mi.WGS84.cartographicToCartesian([r.xmax,r.ymax,r.zmax],new ut),i=Math.sqrt(Math.pow(n[0]-t[0],2)+Math.pow(n[1]-t[1],2)+Math.pow(n[2]-t[2],2));return Math.log2(Tw/(i+e[2]))}function WY(r,e,t){const[n,i,s,a]=r;return hL({xmin:n,xmax:s,ymin:i,ymax:a,zmin:0,zmax:0},e,t)}function $Y(r){r.getColumn(0,AL);const e=r.getColumn(1),t=r.getColumn(2);return AL.add(e).add(t).len()}const Oa={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},Pu={ADD:1,REPLACE:2},Af={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},sc={I3S:"I3S",TILES3D:"TILES3D"},ey={GEOMETRIC_ERROR:"geometricError",MAX_SCREEN_THRESHOLD:"maxScreenThreshold"},XY={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};function dL(r){return r!=null}const lo=new ut,ty=new ut,JY=new ut,YY=new ut;function Iw(r,e,t){if(ci(r,"3D Tile: boundingVolume must be defined"),r.box)return eZ(r.box,e,t);if(r.region){const[n,i,s,a,o,A]=r.region,f=Mi.WGS84.cartographicToCartesian([Iu(n),Iu(a),o],JY),m=Mi.WGS84.cartographicToCartesian([Iu(s),Iu(i),A],YY),v=new ut().addVectors(f,m).multiplyScalar(.5),x=new ut().subVectors(f,m).len()/2;return fL([v[0],v[1],v[2],x],new Bn)}if(r.sphere)return fL(r.sphere,e,t);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function ZY(r,e){if(r.box)return tZ(e);if(r.region){const[t,n,i,s,a,o]=r.region;return[[Iu(t),Iu(n),a],[Iu(i),Iu(s),o]]}if(r.sphere)return rZ(e);throw new Error("Unkown boundingVolume type")}function eZ(r,e,t){const n=new ut(r[0],r[1],r[2]);e.transform(n,n);let i=[];if(r.length===10){const f=r.slice(3,6),m=new eg;m.fromArray(r,6);const v=new ut([1,0,0]),x=new ut([0,1,0]),B=new ut([0,0,1]);v.transformByQuaternion(m),v.scale(f[0]),x.transformByQuaternion(m),x.scale(f[1]),B.transformByQuaternion(m),B.scale(f[2]),i=[...v.toArray(),...x.toArray(),...B.toArray()]}else i=[...r.slice(3,6),...r.slice(6,9),...r.slice(9,12)];const s=e.transformAsVector(i.slice(0,3)),a=e.transformAsVector(i.slice(3,6)),o=e.transformAsVector(i.slice(6,9)),A=new zi([s[0],s[1],s[2],a[0],a[1],a[2],o[0],o[1],o[2]]);return dL(t)?(t.center=n,t.halfAxes=A,t):new fg(n,A)}function fL(r,e,t){const n=new ut(r[0],r[1],r[2]);e.transform(n,n);const i=e.getScale(ty),s=Math.max(Math.max(i[0],i[1]),i[2]),a=r[3]*s;return dL(t)?(t.center=n,t.radius=a,t):new dg(n,a)}function tZ(r){const e=pL(),{halfAxes:t}=r,n=new ut(t.getColumn(0)),i=new ut(t.getColumn(1)),s=new ut(t.getColumn(2));for(let a=0;a<2;a++){for(let o=0;o<2;o++){for(let A=0;A<2;A++)lo.copy(r.center),lo.add(n),lo.add(i),lo.add(s),gL(e,lo),s.negate();i.negate()}n.negate()}return e}function rZ(r){const e=pL(),{center:t,radius:n}=r,i=Mi.WGS84.scaleToGeodeticSurface(t,lo);let s;i?s=Mi.WGS84.geodeticSurfaceNormal(i):s=new ut(0,0,1);let a=new ut(s[2],-s[1],0);a.len()>0?a.normalize():a=new ut(0,1,0);const o=a.clone().cross(s);for(const A of[a,o,s]){ty.copy(A).scale(n);for(let f=0;f<2;f++)lo.copy(t),lo.add(ty),gL(e,lo),ty.negate()}return e}function pL(){return[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]]}function gL(r,e){Mi.WGS84.cartesianToCartographic(e,lo),r[0][0]=Math.min(r[0][0],lo[0]),r[0][1]=Math.min(r[0][1],lo[1]),r[0][2]=Math.min(r[0][2],lo[2]),r[1][0]=Math.max(r[1][0],lo[0]),r[1][1]=Math.max(r[1][1],lo[1]),r[1][2]=Math.max(r[1][2],lo[2])}new ut,new ut,new Bn,new ut,new ut,new ut;function nZ(r,e){const t=r*e;return 1-Math.exp(-(t*t))}function iZ(r,e){if(r.dynamicScreenSpaceError&&r.dynamicScreenSpaceErrorComputedDensity){const t=r.dynamicScreenSpaceErrorComputedDensity,n=r.dynamicScreenSpaceErrorFactor;return nZ(e,t)*n}return 0}function sZ(r,e,t){const n=r.tileset,i=r.parent&&r.parent.lodMetricValue||r.lodMetricValue,s=t?i:r.lodMetricValue;if(s===0)return 0;const a=Math.max(r._distanceToCamera,1e-7),{height:o,sseDenominator:A}=e,{viewDistanceScale:f}=n.options;let m=s*o*(f||1)/(a*A);return m-=iZ(n,a),m}const Lw=new ut,mL=new ut,UA=new ut,yL=new ut,oZ=new ut,Fw=new Bn,_L=new Bn;function aZ(r,e){if(r.lodMetricValue===0||isNaN(r.lodMetricValue))return"DIG";const t=2*vL(r,e);return t<2?"OUT":!r.header.children||t<=r.lodMetricValue?"DRAW":r.header.children?"DIG":"OUT"}function vL(r,e){const{topDownViewport:t}=e,n=r.header.mbs[1],i=r.header.mbs[0],s=r.header.mbs[2],a=r.header.mbs[3],o=[...r.boundingVolume.center],A=t.unprojectPosition(t.cameraPosition);Mi.WGS84.cartographicToCartesian(A,Lw),mL.copy(Lw).subtract(o).normalize(),Mi.WGS84.eastNorthUpToFixedFrame(o,Fw),_L.copy(Fw).invert(),UA.copy(Lw).transform(_L);const f=Math.sqrt(UA[0]*UA[0]+UA[1]*UA[1]),m=f*f/UA[2];yL.copy([UA[0],UA[1],m]);const x=yL.transform(Fw).subtract(o).normalize(),M=mL.cross(x).normalize().scale(a).add(o),U=Mi.WGS84.cartesianToCartographic(M),N=t.project([i,n,s]),Q=t.project(U);return oZ.copy(N).subtract(Q).magnitude()}function cZ(r){return{assetGltfUpAxis:r.asset&&r.asset.gltfUpAxis||"Y"}}class bL{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;W(this,"_map",new Map),W(this,"_array",void 0),W(this,"_length",void 0),this._array=new Array(e),this._length=e}get length(){return this._length}set length(e){this._length=e,e>this._array.length&&(this._array.length=e)}get values(){return this._array}get(e){return ci(e<this._array.length),this._array[e]}set(e,t){ci(e>=0),e>=this.length&&(this.length=e+1),this._map.has(this._array[e])&&this._map.delete(this._array[e]),this._array[e]=t,this._map.set(t,e)}delete(e){const t=this._map.get(e);t>=0&&(this._array.splice(t,1),this._map.delete(e),this.length--)}peek(){return this._array[this._length-1]}push(e){if(!this._map.has(e)){const t=this.length++;this._array[t]=e,this._map.set(e,t)}}pop(){const e=this._array[--this.length];return this._map.delete(e),e}reserve(e){ci(e>=0),e>this._array.length&&(this._array.length=e)}resize(e){ci(e>=0),this.length=e}trim(e){e==null&&(e=this.length),this._array.length=e}reset(){this._array=[],this._map=new Map,this._length=0}find(e){return this._map.has(e)}}const lZ={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class ry{traversalFinished(e){return!0}constructor(e){W(this,"options",void 0),W(this,"root",null),W(this,"selectedTiles",{}),W(this,"requestedTiles",{}),W(this,"emptyTiles",{}),W(this,"lastUpdate",new Date().getTime()),W(this,"updateDebounceTime",1e3),W(this,"_traversalStack",new bL),W(this,"_emptyTraversalStack",new bL),W(this,"_frameNumber",null),this.options={...lZ,...e}}traverse(e,t,n){this.root=e,this.options={...this.options,...n},this.reset(),this.updateTile(e,t),this._frameNumber=t.frameNumber,this.executeTraversal(e,t)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(e,t){const n=this._traversalStack;for(e._selectionDepth=1,n.push(e);n.length>0;){const s=n.pop();let a=!1;this.canTraverse(s,t)&&(this.updateChildTiles(s,t),a=this.updateAndPushChildren(s,t,n,s.hasRenderContent?s._selectionDepth+1:s._selectionDepth));const o=s.parent,A=!!(!o||o._shouldRefine),f=!a;s.hasRenderContent?s.refine===Pu.ADD?(this.loadTile(s,t),this.selectTile(s,t)):s.refine===Pu.REPLACE&&(this.loadTile(s,t),f&&this.selectTile(s,t)):(this.emptyTiles[s.id]=s,this.loadTile(s,t),f&&this.selectTile(s,t)),this.touchTile(s,t),s._shouldRefine=a&&A}const i=new Date().getTime();(this.traversalFinished(t)||i-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=i,this.options.onTraversalEnd(t))}updateChildTiles(e,t){const n=e.children;for(const i of n)this.updateTile(i,t)}updateAndPushChildren(e,t,n,i){const{loadSiblings:s,skipLevelOfDetail:a}=this.options,o=e.children;o.sort(this.compareDistanceToCamera.bind(this));const A=e.refine===Pu.REPLACE&&e.hasRenderContent&&!a;let f=!1,m=!0;for(const v of o)if(v._selectionDepth=i,v.isVisibleAndInRequestVolume?(n.find(v)&&n.delete(v),n.push(v),f=!0):(A||s)&&(this.loadTile(v,t),this.touchTile(v,t)),A){let x;if(v._inRequestVolume?v.hasRenderContent?x=v.contentAvailable:x=this.executeEmptyTraversal(v,t):x=!1,m=m&&x,!m)return!1}return f||(m=!1),m}updateTile(e,t){this.updateTileVisibility(e,t)}selectTile(e,t){this.shouldSelectTile(e)&&(e._selectedFrame=t.frameNumber,this.selectedTiles[e.id]=e)}loadTile(e,t){this.shouldLoadTile(e)&&(e._requestedFrame=t.frameNumber,e._priority=e._getPriority(),this.requestedTiles[e.id]=e)}touchTile(e,t){e.tileset._cache.touch(e),e._touchedFrame=t.frameNumber}canTraverse(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return e.hasChildren?e.hasTilesetContent?!e.contentExpired:!i&&!e.isVisibleAndInRequestVolume?!1:this.shouldRefine(e,t,n):!1}shouldLoadTile(e){return e.hasUnloadedContent||e.contentExpired}shouldSelectTile(e){return e.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=e._screenSpaceError;return n&&(i=e.getScreenSpaceError(t,!0)),i>this.options.maximumScreenSpaceError}updateTileVisibility(e,t){const n=[];if(this.options.viewportTraversersMap)for(const i in this.options.viewportTraversersMap)this.options.viewportTraversersMap[i]===t.viewport.id&&n.push(i);else n.push(t.viewport.id);e.updateVisibility(t,n)}compareDistanceToCamera(e,t){return e._distanceToCamera-t._distanceToCamera}anyChildrenVisible(e,t){let n=!1;for(const i of e.children)i.updateVisibility(t),n=n||i.isVisibleAndInRequestVolume;return n}executeEmptyTraversal(e,t){let n=!0;const i=this._emptyTraversalStack;for(i.push(e);i.length>0&&n;){const s=i.pop();if(this.updateTile(s,t),s.isVisibleAndInRequestVolume||this.loadTile(s,t),this.touchTile(s,t),!s.hasRenderContent&&this.canTraverse(s,t,!1,!0)){const o=s.children;for(const A of o)i.find(A)&&i.delete(A),i.push(A)}else!s.contentAvailable&&!s.hasEmptyContent&&(n=!1)}return n}}const wL=new ut;function uZ(r){return r!=null}class Mw{constructor(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"";W(this,"tileset",void 0),W(this,"header",void 0),W(this,"id",void 0),W(this,"url",void 0),W(this,"parent",void 0),W(this,"refine",void 0),W(this,"type",void 0),W(this,"contentUrl",void 0),W(this,"lodMetricType","geometricError"),W(this,"lodMetricValue",0),W(this,"boundingVolume",null),W(this,"content",null),W(this,"contentState",Oa.UNLOADED),W(this,"gpuMemoryUsageInBytes",0),W(this,"children",[]),W(this,"depth",0),W(this,"viewportIds",[]),W(this,"transform",new Bn),W(this,"extensions",null),W(this,"implicitTiling",null),W(this,"userData",{}),W(this,"computedTransform",void 0),W(this,"hasEmptyContent",!1),W(this,"hasTilesetContent",!1),W(this,"traverser",new ry({})),W(this,"_cacheNode",null),W(this,"_frameNumber",null),W(this,"_expireDate",null),W(this,"_expiredContent",null),W(this,"_boundingBox",void 0),W(this,"_distanceToCamera",0),W(this,"_screenSpaceError",0),W(this,"_visibilityPlaneMask",void 0),W(this,"_visible",void 0),W(this,"_contentBoundingVolume",void 0),W(this,"_viewerRequestVolume",void 0),W(this,"_initialTransform",new Bn),W(this,"_priority",0),W(this,"_selectedFrame",0),W(this,"_requestedFrame",0),W(this,"_selectionDepth",0),W(this,"_touchedFrame",0),W(this,"_centerZDepth",0),W(this,"_shouldRefine",!1),W(this,"_stackLength",0),W(this,"_visitedFrame",0),W(this,"_inRequestVolume",!1),W(this,"_lodJudge",null),this.header=t,this.tileset=e,this.id=i||t.id,this.url=t.url,this.parent=n,this.refine=this._getRefine(t.refine),this.type=t.type,this.contentUrl=t.contentUrl,this._initializeLodMetric(t),this._initializeTransforms(t),this._initializeBoundingVolumes(t),this._initializeContent(t),this._initializeRenderingState(t),Object.seal(this)}destroy(){this.header=null}isDestroyed(){return this.header===null}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return this.contentState===Oa.READY||this.hasEmptyContent}get contentAvailable(){return!!(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return this.contentState===Oa.UNLOADED}get contentExpired(){return this.contentState===Oa.EXPIRED}get contentFailed(){return this.contentState===Oa.FAILED}get distanceToCamera(){return this._distanceToCamera}get screenSpaceError(){return this._screenSpaceError}get boundingBox(){return this._boundingBox||(this._boundingBox=ZY(this.header.boundingVolume,this.boundingVolume)),this._boundingBox}getScreenSpaceError(e,t){switch(this.tileset.type){case sc.I3S:return vL(this,e);case sc.TILES3D:return sZ(this,e,t);default:throw new Error("Unsupported tileset type")}}unselect(){this._selectedFrame=0}_getGpuMemoryUsageInBytes(){return this.content.gpuMemoryUsageInBytes||this.content.byteLength||0}_getPriority(){const e=this.tileset._traverser,{skipLevelOfDetail:t}=e.options,n=this.refine===Pu.ADD||t;if(n&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===Oa.UNLOADED)return-1;const i=this.parent,a=i&&(!n||this._screenSpaceError===0||i.hasTilesetContent)?i._screenSpaceError:this._screenSpaceError,o=e.root?e.root._screenSpaceError:0;return Math.max(o-a,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=Oa.LOADING;const t=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!t)return this.contentState=Oa.UNLOADED,!1;try{const n=this.tileset.getTileUrl(this.contentUrl),i=this.tileset.loader,s={...this.tileset.loadOptions,[i.id]:{...this.tileset.loadOptions[i.id],isTileset:this.type==="json",...this._getLoaderSpecificOptions(i.id)}};return this.content=await wA(n,i,s),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=Oa.READY,this._onContentLoaded(),!0}catch(n){throw this.contentState=Oa.FAILED,n}finally{t.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=Oa.UNLOADED,!0}updateVisibility(e,t){if(this._frameNumber===e.frameNumber)return;const n=this.parent,i=n?n._visibilityPlaneMask:nc.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const s=n?n.computedTransform:this.tileset.modelMatrix;this._updateTransform(s)}this._distanceToCamera=this.distanceToTile(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._visibilityPlaneMask=this.visibility(e,i),this._visible=this._visibilityPlaneMask!==nc.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._frameNumber=e.frameNumber,this.viewportIds=t}visibility(e,t){const{cullingVolume:n}=e,{boundingVolume:i}=this;return n.computeVisibilityWithPlaneMask(i,t)}contentVisibility(){return!0}distanceToTile(e){const t=this.boundingVolume;return Math.sqrt(Math.max(t.distanceSquaredTo(e.camera.position),0))}cameraSpaceZDepth(e){let{camera:t}=e;const n=this.boundingVolume;return wL.subVectors(n.center,t.position),t.direction.dot(wL)}insideViewerRequestVolume(e){const t=this._viewerRequestVolume;return!t||t.distanceSquaredTo(e.camera.position)<=0}updateExpiration(){if(uZ(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){const e=Date.now();Date.lessThan(this._expireDate,e)&&(this.contentState=Oa.EXPIRED,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(e){"lodMetricType"in e?this.lodMetricType=e.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in e?this.lodMetricValue=e.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(e){this.transform=e.transform?new Bn(e.transform):new Bn;const t=this.parent,n=this.tileset,i=t&&t.computedTransform?t.computedTransform.clone():n.modelMatrix.clone();this.computedTransform=new Bn(i).multiplyRight(this.transform);const s=t&&t._initialTransform?t._initialTransform.clone():new Bn;this._initialTransform=new Bn(s).multiplyRight(this.transform)}_initializeBoundingVolumes(e){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(e)}_initializeContent(e){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=Oa.UNLOADED,this.hasTilesetContent=!1,e.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(e){this.depth=e.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=nc.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(e){return e||this.parent&&this.parent.refine||Pu.REPLACE}_isTileset(){return this.contentUrl.indexOf(".json")!==-1}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0;break}this._isTileset()?this.hasTilesetContent=!0:this.gpuMemoryUsageInBytes=this._getGpuMemoryUsageInBytes()}_updateBoundingVolume(e){this.boundingVolume=Iw(e.boundingVolume,this.computedTransform,this.boundingVolume);const t=e.content;t&&(t.boundingVolume&&(this._contentBoundingVolume=Iw(t.boundingVolume,this.computedTransform,this._contentBoundingVolume)),e.viewerRequestVolume&&(this._viewerRequestVolume=Iw(e.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Bn).clone().multiplyRight(this.transform);t.equals(this.computedTransform)||(this.computedTransform=t,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(e){switch(e){case"i3s":return{...this.tileset.options.i3s,_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1};case"3d-tiles":case"cesium-ion":default:return cZ(this.tileset.tileset)}}}class AZ extends ry{compareDistanceToCamera(e,t){return t._distanceToCamera===0&&e._distanceToCamera===0?t._centerZDepth-e._centerZDepth:t._distanceToCamera-e._distanceToCamera}updateTileVisibility(e,t){if(super.updateTileVisibility(e,t),!e.isVisibleAndInRequestVolume)return;const n=e.children.length>0;if(e.hasTilesetContent&&n){const a=e.children[0];this.updateTileVisibility(a,t),e._visible=a._visible;return}if(this.meetsScreenSpaceErrorEarly(e,t)){e._visible=!1;return}const i=e.refine===Pu.REPLACE,s=e._optimChildrenWithinParent===XY.USE_OPTIMIZATION;if(i&&s&&n&&!this.anyChildrenVisible(e,t)){e._visible=!1;return}}meetsScreenSpaceErrorEarly(e,t){const{parent:n}=e;return!n||n.hasTilesetContent||n.refine!==Pu.ADD?!1:!this.shouldRefine(e,t,!0)}}class hZ{constructor(){W(this,"frameNumberMap",new Map)}register(e,t){const n=this.frameNumberMap.get(e)||new Map,i=n.get(t)||0;n.set(t,i+1),this.frameNumberMap.set(e,n)}deregister(e,t){const n=this.frameNumberMap.get(e);if(!n)return;const i=n.get(t)||1;n.set(t,i-1)}isZero(e,t){var n;return(((n=this.frameNumberMap.get(e))===null||n===void 0?void 0:n.get(t))||0)===0}}const Pw={REQUESTED:"REQUESTED",COMPLETED:"COMPLETED",ERROR:"ERROR"};class dZ{constructor(){W(this,"_statusMap",void 0),W(this,"pendingTilesRegister",new hZ),this._statusMap={}}add(e,t,n,i){if(!this._statusMap[t]){const{frameNumber:s,viewport:{id:a}}=i;this._statusMap[t]={request:e,callback:n,key:t,frameState:i,status:Pw.REQUESTED},this.pendingTilesRegister.register(a,s),e().then(o=>{this._statusMap[t].status=Pw.COMPLETED;const{frameNumber:A,viewport:{id:f}}=this._statusMap[t].frameState;this.pendingTilesRegister.deregister(f,A),this._statusMap[t].callback(o,i)}).catch(o=>{this._statusMap[t].status=Pw.ERROR;const{frameNumber:A,viewport:{id:f}}=this._statusMap[t].frameState;this.pendingTilesRegister.deregister(f,A),n(o)})}}update(e,t){if(this._statusMap[e]){const{frameNumber:n,viewport:{id:i}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(i,n);const{frameNumber:s,viewport:{id:a}}=t;this.pendingTilesRegister.register(a,s),this._statusMap[e].frameState=t}}find(e){return this._statusMap[e]}hasPendingTiles(e,t){return!this.pendingTilesRegister.isZero(e,t)}}class fZ extends ry{constructor(e){super(e),W(this,"_tileManager",void 0),this._tileManager=new dZ}traversalFinished(e){return!this._tileManager.hasPendingTiles(e.viewport.id,this._frameNumber||0)}shouldRefine(e,t){return e._lodJudge=aZ(e,t),e._lodJudge==="DIG"}updateChildTiles(e,t){const n=e.header.children||[],i=e.children,s=e.tileset;for(const a of n){const o="".concat(a.id,"-").concat(t.viewport.id),A=i&&i.find(f=>f.id===o);if(A)A&&this.updateTile(A,t);else{let f=()=>this._loadTile(a.id,s);this._tileManager.find(o)?this._tileManager.update(o,t):(s.tileset.nodePages&&(f=()=>s.tileset.nodePagesTile.formTileFromNodePages(a.id)),this._tileManager.add(f,o,v=>this._onTileLoad(v,e,o),t))}}return!1}async _loadTile(e,t){const{loader:n}=t,i=t.getTileUrl("".concat(t.url,"/nodes/").concat(e)),s={...t.loadOptions,i3s:{...t.loadOptions.i3s,isTileHeader:!0}};return await wA(i,n,s)}_onTileLoad(e,t,n){const i=new Mw(t.tileset,e,t,n);t.children.push(i);const s=this._tileManager.find(i.id).frameState;this.updateTile(i,s),this._frameNumber===s.frameNumber&&(this.traversalFinished(s)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(i,s)}}const pZ={description:"",ellipsoid:Mi.WGS84,modelMatrix:new Bn,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:r=>r,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},ny="Tiles In Tileset(s)",Uw="Tiles In Memory",xL="Tiles In View",BL="Tiles To Render",CL="Tiles Loaded",Rw="Tiles Loading",EL="Tiles Unloaded",SL="Failed Tile Loads",TL="Points/Vertices",Ow="Tile Memory Use";class gZ{constructor(e,t){W(this,"options",void 0),W(this,"loadOptions",void 0),W(this,"type",void 0),W(this,"tileset",void 0),W(this,"loader",void 0),W(this,"url",void 0),W(this,"basePath",void 0),W(this,"modelMatrix",void 0),W(this,"ellipsoid",void 0),W(this,"lodMetricType",void 0),W(this,"lodMetricValue",void 0),W(this,"refine",void 0),W(this,"root",null),W(this,"roots",{}),W(this,"asset",{}),W(this,"description",""),W(this,"properties",void 0),W(this,"extras",null),W(this,"attributions",{}),W(this,"credits",{}),W(this,"stats",void 0),W(this,"contentFormats",{draco:!1,meshopt:!1,dds:!1,ktx2:!1}),W(this,"cartographicCenter",null),W(this,"cartesianCenter",null),W(this,"zoom",1),W(this,"boundingVolume",null),W(this,"dynamicScreenSpaceErrorComputedDensity",0),W(this,"maximumMemoryUsage",32),W(this,"gpuMemoryUsageInBytes",0),W(this,"_frameNumber",0),W(this,"_queryParams",{}),W(this,"_extensionsUsed",[]),W(this,"_tiles",{}),W(this,"_pendingCount",0),W(this,"selectedTiles",[]),W(this,"traverseCounter",0),W(this,"geometricError",0),W(this,"lastUpdatedVieports",null),W(this,"_requestedTiles",[]),W(this,"_emptyTiles",[]),W(this,"frameStateData",{}),W(this,"_traverser",void 0),W(this,"_cache",new QY),W(this,"_requestScheduler",void 0),W(this,"updatePromise",null),W(this,"tilesetInitializationPromise",void 0),this.options={...pZ,...t},this.tileset=e,this.loader=e.loader,this.type=e.type,this.url=e.url,this.basePath=e.basePath||cv(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=e.lodMetricType,this.lodMetricValue=e.lodMetricValue,this.refine=e.root.refine,this.loadOptions=this.options.loadOptions||{},this._traverser=this._initializeTraverser(),this._requestScheduler=new NN({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this.stats=new DY({id:this.url}),this._initializeStats(),this.tilesetInitializationPromise=this._initializeTileSet(e)}destroy(){this._destroy()}isLoaded(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return new URLSearchParams(this._queryParams).toString()}setProps(e){this.options={...this.options,...e}}setOptions(e){this.options={...this.options,...e}}getTileUrl(e){return e.startsWith("data:")?e:"".concat(e).concat(e.includes("?")?"&":"?").concat(this.queryParams)}hasExtension(e){return this._extensionsUsed.indexOf(e)>-1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.tilesetInitializationPromise.then(()=>{!e&&this.lastUpdatedVieports?e=this.lastUpdatedVieports:this.lastUpdatedVieports=e,e&&this.doUpdate(e)})}async selectTiles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return await this.tilesetInitializationPromise,e&&(this.lastUpdatedVieports=e),this.updatePromise||(this.updatePromise=new Promise(t=>{setTimeout(()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),t(this._frameNumber),this.updatePromise=null},this.options.debounceTime)})),this.updatePromise}doUpdate(e){if("loadTiles"in this.options&&!this.options.loadTiles||this.traverseCounter>0)return;const t=e instanceof Array?e:[e];this._cache.reset(),this._frameNumber++,this.traverseCounter=t.length;const n=[];for(const i of t){const s=i.id;this._needTraverse(s)?n.push(s):this.traverseCounter--}for(const i of t){const s=i.id;if(this.roots[s]||(this.roots[s]=this._initializeTileHeaders(this.tileset,null)),!n.includes(s))continue;const a=zY(i,this._frameNumber);this._traverser.traverse(this.roots[s],a,this.options)}}_needTraverse(e){let t=e;return this.options.viewportTraversersMap&&(t=this.options.viewportTraversersMap[e]),t===e}_onTraversalEnd(e){const t=e.viewport.id;this.frameStateData[t]||(this.frameStateData[t]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const n=this.frameStateData[t],i=Object.values(this._traverser.selectedTiles),[s,a]=GY(i,e,this.options.maximumTilesSelected);n.selectedTiles=s;for(const o of a)o.unselect();n._requestedTiles=Object.values(this._traverser.requestedTiles),n._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const e in this.frameStateData){const t=this.frameStateData[e];this.selectedTiles=this.selectedTiles.concat(t.selectedTiles),this._requestedTiles=this._requestedTiles.concat(t._requestedTiles),this._emptyTiles=this._emptyTiles.concat(t._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const e of this.selectedTiles)this._tiles[e.id]=e;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(e,t){if(e.length!==t.length)return!0;const n=new Set(e.map(a=>a.id)),i=new Set(t.map(a=>a.id));let s=e.filter(a=>!i.has(a.id)).length>0;return s=s||t.filter(a=>!n.has(a.id)).length>0,s}_loadTiles(){for(const e of this._requestedTiles)e.contentUnloaded&&this._loadTile(e)}_unloadTiles(){this._cache.unloadTiles(this,(e,t)=>e._unloadTile(t))}_updateStats(){let e=0,t=0;for(const n of this.selectedTiles)n.contentAvailable&&n.content&&(e++,n.content.pointCount?t+=n.content.pointCount:t+=n.content.vertexCount);this.stats.get(xL).count=this.selectedTiles.length,this.stats.get(BL).count=e,this.stats.get(TL).count=t}async _initializeTileSet(e){this.type===sc.I3S&&(this.calculateViewPropsI3S(),e.root=await e.root),this.root=this._initializeTileHeaders(e,null),this.type===sc.TILES3D&&(this._initializeTiles3DTileset(e),this.calculateViewPropsTiles3D()),this.type===sc.I3S&&this._initializeI3STileset()}calculateViewPropsI3S(){var e;const t=this.tileset.fullExtent;if(t){const{xmin:i,xmax:s,ymin:a,ymax:o,zmin:A,zmax:f}=t;this.cartographicCenter=new ut(i+(s-i)/2,a+(o-a)/2,A+(f-A)/2),this.cartesianCenter=Mi.WGS84.cartographicToCartesian(this.cartographicCenter,new ut),this.zoom=hL(t,this.cartographicCenter,this.cartesianCenter);return}const n=(e=this.tileset.store)===null||e===void 0?void 0:e.extent;if(n){const[i,s,a,o]=n;this.cartographicCenter=new ut(i+(a-i)/2,s+(o-s)/2,0),this.cartesianCenter=Mi.WGS84.cartographicToCartesian(this.cartographicCenter,new ut),this.zoom=WY(n,this.cartographicCenter,this.cartesianCenter);return}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new ut,this.zoom=1}calculateViewPropsTiles3D(){const e=this.root,{center:t}=e.boundingVolume;if(!t){console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new ut,this.zoom=1;return}t[0]!==0||t[1]!==0||t[2]!==0?this.cartographicCenter=Mi.WGS84.cartesianToCartographic(t,new ut):this.cartographicCenter=new ut(0,0,-Mi.WGS84.radii[0]),this.cartesianCenter=t,this.zoom=KY(e.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get(ny),this.stats.get(Rw),this.stats.get(Uw),this.stats.get(xL),this.stats.get(BL),this.stats.get(CL),this.stats.get(EL),this.stats.get(SL),this.stats.get(TL),this.stats.get(Ow,"memory")}_initializeTileHeaders(e,t){const n=new Mw(this,e.root,t);if(t&&(t.children.push(n),n.depth=t.depth+1),this.type===sc.TILES3D){const s=[];for(s.push(n);s.length>0;){const a=s.pop();this.stats.get(ny).incrementCount();const o=a.header.children||[];for(const A of o){var i;const f=new Mw(this,A,a);if((i=f.contentUrl)!==null&&i!==void 0&&i.includes("?session=")){const v=new URL(f.contentUrl).searchParams.get("session");v&&(this._queryParams.session=v)}a.children.push(f),f.depth=a.depth+1,s.push(f)}}}return n}_initializeTraverser(){let e;switch(this.type){case sc.TILES3D:e=AZ;break;case sc.I3S:e=fZ;break;default:e=ry}return new e({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(e){this._destroySubtree(e)}async _loadTile(e){let t;try{this._onStartTileLoading(),t=await e.loadContent()}catch(n){this._onTileLoadError(e,n instanceof Error?n:new Error("load failed"))}finally{this._onEndTileLoading(),this._onTileLoad(e,t)}}_onTileLoadError(e,t){this.stats.get(SL).incrementCount();const n=t.message||t.toString(),i=e.url;console.error("A 3D tile failed to load: ".concat(e.url," ").concat(n)),this.options.onTileError(e,n,i)}_onTileLoad(e,t){if(t){if(this.type===sc.I3S){var n,i;const s=((n=this.tileset)===null||n===void 0||(i=n.nodePagesTile)===null||i===void 0?void 0:i.nodesInNodePages)||0;this.stats.get(ny).reset(),this.stats.get(ny).addCount(s)}e&&e.content&&HY(e,e.content),this.updateContentTypes(e),this._addTileToCache(e),this.options.onTileLoad(e)}}updateContentTypes(e){if(this.type===sc.I3S)switch(e.header.isDracoGeometry&&(this.contentFormats.draco=!0),e.header.textureFormat){case"dds":this.contentFormats.dds=!0;break;case"ktx2":this.contentFormats.ktx2=!0;break}else if(this.type===sc.TILES3D){var t;const{extensionsRemoved:n=[]}=((t=e.content)===null||t===void 0?void 0:t.gltf)||{};n.includes("KHR_draco_mesh_compression")&&(this.contentFormats.draco=!0),n.includes("EXT_meshopt_compression")&&(this.contentFormats.meshopt=!0),n.includes("KHR_texture_basisu")&&(this.contentFormats.ktx2=!0)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(Rw).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(Rw).decrementCount()}_addTileToCache(e){this._cache.add(this,e,t=>t._updateCacheStats(e))}_updateCacheStats(e){this.stats.get(CL).incrementCount(),this.stats.get(Uw).incrementCount(),this.gpuMemoryUsageInBytes+=e.gpuMemoryUsageInBytes||0,this.stats.get(Ow).count=this.gpuMemoryUsageInBytes}_unloadTile(e){this.gpuMemoryUsageInBytes-=e.gpuMemoryUsageInBytes||0,this.stats.get(Uw).decrementCount(),this.stats.get(EL).incrementCount(),this.stats.get(Ow).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(e),e.unloadContent()}_destroy(){const e=[];for(this.root&&e.push(this.root);e.length>0;){const t=e.pop();for(const n of t.children)e.push(n);this._destroyTile(t)}this.root=null}_destroySubtree(e){const t=e,n=[];for(n.push(t);n.length>0;){e=n.pop();for(const i of e.children)n.push(i);e!==t&&this._destroyTile(e)}t.children=[]}_destroyTile(e){this._cache.unloadTile(this,e),this._unloadTile(e),e.destroy()}_initializeTiles3DTileset(e){if(e.queryString){const t=new URLSearchParams(e.queryString),n=Object.fromEntries(t.entries());this._queryParams={...this._queryParams,...n}}if(this.asset=e.asset,!this.asset)throw new Error("Tileset must have an asset property.");if(this.asset.version!=="0.0"&&this.asset.version!=="1.0")throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=e.properties,this.geometricError=e.geometricError,this._extensionsUsed=e.extensionsUsed||[],this.extras=e.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}const IL="3.4.14",wg={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"};function LL(r,e,t){ci(r instanceof ArrayBuffer);const n=new TextDecoder("utf8"),i=new Uint8Array(r,e,t);return n.decode(i)}function mZ(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const t=new DataView(r);return"".concat(String.fromCharCode(t.getUint8(e+0))).concat(String.fromCharCode(t.getUint8(e+1))).concat(String.fromCharCode(t.getUint8(e+2))).concat(String.fromCharCode(t.getUint8(e+3)))}const yZ={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},gs={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},Un={...yZ,...gs},Dw={[gs.DOUBLE]:Float64Array,[gs.FLOAT]:Float32Array,[gs.UNSIGNED_SHORT]:Uint16Array,[gs.UNSIGNED_INT]:Uint32Array,[gs.UNSIGNED_BYTE]:Uint8Array,[gs.BYTE]:Int8Array,[gs.SHORT]:Int16Array,[gs.INT]:Int32Array},_Z={DOUBLE:gs.DOUBLE,FLOAT:gs.FLOAT,UNSIGNED_SHORT:gs.UNSIGNED_SHORT,UNSIGNED_INT:gs.UNSIGNED_INT,UNSIGNED_BYTE:gs.UNSIGNED_BYTE,BYTE:gs.BYTE,SHORT:gs.SHORT,INT:gs.INT},kw="Failed to convert GL type";class Vl{static fromTypedArray(e){e=ArrayBuffer.isView(e)?e.constructor:e;for(const t in Dw)if(Dw[t]===e)return t;throw new Error(kw)}static fromName(e){const t=_Z[e];if(!t)throw new Error(kw);return t}static getArrayType(e){switch(e){case gs.UNSIGNED_SHORT_5_6_5:case gs.UNSIGNED_SHORT_4_4_4_4:case gs.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const t=Dw[e];if(!t)throw new Error(kw);return t}}static getByteSize(e){return Vl.getArrayType(e).BYTES_PER_ELEMENT}static validate(e){return!!Vl.getArrayType(e)}static createTypedArray(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;i===void 0&&(i=(t.byteLength-n)/Vl.getByteSize(e));const s=Vl.getArrayType(e);return new s(t,n,i)}}function vZ(r,e){if(!r)throw new Error("math.gl assertion failed. ".concat(e))}function bZ(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const t=r>>11&31,n=r>>5&63,i=r&31;return e[0]=t<<3,e[1]=n<<2,e[2]=i<<3,e}new ab,new ut,new ab,new ab;function FL(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:255;return Lu(r,0,e)/e*2-1}function ML(r){return r<0?-1:1}function wZ(r,e,t,n){if(vZ(n),r<0||r>t||e<0||e>t)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(t));if(n.x=FL(r,t),n.y=FL(e,t),n.z=1-(Math.abs(n.x)+Math.abs(n.y)),n.z<0){const i=n.x;n.x=(1-Math.abs(n.y))*ML(i),n.y=(1-Math.abs(i))*ML(n.y)}return n.normalize()}function xZ(r,e,t){return wZ(r,e,255,t)}class Nw{constructor(e,t){W(this,"json",void 0),W(this,"buffer",void 0),W(this,"featuresLength",0),W(this,"_cachedTypedArrays",{}),this.json=e,this.buffer=t}getExtension(e){return this.json.extensions&&this.json.extensions[e]}hasProperty(e){return!!this.json[e]}getGlobalProperty(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Un.UNSIGNED_INT,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=this.json[e];return i&&Number.isFinite(i.byteOffset)?this._getTypedArrayFromBinary(e,t,n,1,i.byteOffset):i}getPropertyArray(e,t,n){const i=this.json[e];return i&&Number.isFinite(i.byteOffset)?("componentType"in i&&(t=Vl.fromName(i.componentType)),this._getTypedArrayFromBinary(e,t,n,this.featuresLength,i.byteOffset)):this._getTypedArrayFromArray(e,t,i)}getProperty(e,t,n,i,s){const a=this.json[e];if(!a)return a;const o=this.getPropertyArray(e,t,n);if(n===1)return o[i];for(let A=0;A<n;++A)s[A]=o[n*i+A];return s}_getTypedArrayFromBinary(e,t,n,i,s){const a=this._cachedTypedArrays;let o=a[e];return o||(o=Vl.createTypedArray(t,this.buffer.buffer,this.buffer.byteOffset+s,i*n),a[e]=o),o}_getTypedArrayFromArray(e,t,n){const i=this._cachedTypedArrays;let s=i[e];return s||(s=Vl.createTypedArray(t,n),i[e]=s),s}}const BZ={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},CZ={SCALAR:(r,e)=>r[e],VEC2:(r,e)=>[r[2*e+0],r[2*e+1]],VEC3:(r,e)=>[r[3*e+0],r[3*e+1],r[3*e+2]],VEC4:(r,e)=>[r[4*e+0],r[4*e+1],r[4*e+2],r[4*e+3]],MAT2:(r,e)=>[r[4*e+0],r[4*e+1],r[4*e+2],r[4*e+3]],MAT3:(r,e)=>[r[9*e+0],r[9*e+1],r[9*e+2],r[9*e+3],r[9*e+4],r[9*e+5],r[9*e+6],r[9*e+7],r[9*e+8]],MAT4:(r,e)=>[r[16*e+0],r[16*e+1],r[16*e+2],r[16*e+3],r[16*e+4],r[16*e+5],r[16*e+6],r[16*e+7],r[16*e+8],r[16*e+9],r[16*e+10],r[16*e+11],r[16*e+12],r[16*e+13],r[16*e+14],r[16*e+15]]},EZ={SCALAR:(r,e,t)=>{e[t]=r},VEC2:(r,e,t)=>{e[2*t+0]=r[0],e[2*t+1]=r[1]},VEC3:(r,e,t)=>{e[3*t+0]=r[0],e[3*t+1]=r[1],e[3*t+2]=r[2]},VEC4:(r,e,t)=>{e[4*t+0]=r[0],e[4*t+1]=r[1],e[4*t+2]=r[2],e[4*t+3]=r[3]},MAT2:(r,e,t)=>{e[4*t+0]=r[0],e[4*t+1]=r[1],e[4*t+2]=r[2],e[4*t+3]=r[3]},MAT3:(r,e,t)=>{e[9*t+0]=r[0],e[9*t+1]=r[1],e[9*t+2]=r[2],e[9*t+3]=r[3],e[9*t+4]=r[4],e[9*t+5]=r[5],e[9*t+6]=r[6],e[9*t+7]=r[7],e[9*t+8]=r[8],e[9*t+9]=r[9]},MAT4:(r,e,t)=>{e[16*t+0]=r[0],e[16*t+1]=r[1],e[16*t+2]=r[2],e[16*t+3]=r[3],e[16*t+4]=r[4],e[16*t+5]=r[5],e[16*t+6]=r[6],e[16*t+7]=r[7],e[16*t+8]=r[8],e[16*t+9]=r[9],e[16*t+10]=r[10],e[16*t+11]=r[11],e[16*t+12]=r[12],e[16*t+13]=r[13],e[16*t+14]=r[14],e[16*t+15]=r[15]}};function SZ(r,e,t,n){const{componentType:i}=r;ci(r.componentType);const s=typeof i=="string"?Vl.fromName(i):i,a=BZ[r.type],o=CZ[r.type],A=EZ[r.type];return t+=r.byteOffset,{values:Vl.createTypedArray(s,e,t,a*n),type:s,size:a,unpacker:o,packer:A}}const jl=r=>r!==void 0;function TZ(r,e,t){if(!e)return null;let n=r.getExtension("3DTILES_batch_table_hierarchy");const i=e.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=i,n=i),n?IZ(n,t):null}function IZ(r,e){let t,n,i;const s=r.instancesLength,a=r.classes;let o=r.classIds,A=r.parentCounts,f=r.parentIds,m=s;jl(o.byteOffset)&&(o.componentType=defaultValue(o.componentType,GL.UNSIGNED_SHORT),o.type=AttributeType.SCALAR,i=getBinaryAccessor(o),o=i.createArrayBufferView(e.buffer,e.byteOffset+o.byteOffset,s));let v;if(jl(A))for(jl(A.byteOffset)&&(A.componentType=defaultValue(A.componentType,GL.UNSIGNED_SHORT),A.type=AttributeType.SCALAR,i=getBinaryAccessor(A),A=i.createArrayBufferView(e.buffer,e.byteOffset+A.byteOffset,s)),v=new Uint16Array(s),m=0,t=0;t<s;++t)v[t]=m,m+=A[t];jl(f)&&jl(f.byteOffset)&&(f.componentType=defaultValue(f.componentType,GL.UNSIGNED_SHORT),f.type=AttributeType.SCALAR,i=getBinaryAccessor(f),f=i.createArrayBufferView(e.buffer,e.byteOffset+f.byteOffset,m));const x=a.length;for(t=0;t<x;++t){const N=a[t].length,Q=a[t].instances,q=getBinaryProperties(N,Q,e);a[t].instances=combine(q,Q)}const B=new Array(x).fill(0),M=new Uint16Array(s);for(t=0;t<s;++t)n=o[t],M[t]=B[n],++B[n];const U={classes:a,classIds:o,classIndexes:M,parentCounts:A,parentIndexes:v,parentIds:f};return MZ(U),U}function xg(r,e,t){if(!r)return;const n=r.parentCounts;return r.parentIds?t(r,e):n>0?LZ(r,e,t):FZ(r,e,t)}function LZ(r,e,t){const n=r.classIds,i=r.parentCounts,s=r.parentIds,a=r.parentIndexes,o=n.length,A=scratchVisited;A.length=Math.max(A.length,o);const f=++marker,m=scratchStack;for(m.length=0,m.push(e);m.length>0;){if(e=m.pop(),A[e]===f)continue;A[e]=f;const v=t(r,e);if(jl(v))return v;const x=i[e],B=a[e];for(let M=0;M<x;++M){const U=s[B+M];U!==e&&m.push(U)}}return null}function FZ(r,e,t){let n=!0;for(;n;){const i=t(r,e);if(jl(i))return i;const s=r.parentIds[e];n=s!==e,e=s}throw new Error("traverseHierarchySingleParent")}function MZ(r){const t=r.classIds.length;for(let n=0;n<t;++n)PL(r,n,stack)}function PL(r,e,t){const n=r.parentCounts,i=r.parentIds,s=r.parentIndexes,o=r.classIds.length;if(!jl(i))return;assert(e<o,"Parent index ".concat(e," exceeds the total number of instances: ").concat(o)),assert(t.indexOf(e)===-1,"Circular dependency detected in the batch table hierarchy."),t.push(e);const A=jl(n)?n[e]:1,f=jl(n)?s[e]:e;for(let m=0;m<A;++m){const v=i[f+m];v!==e&&PL(r,v,t)}t.pop(e)}function la(r){return r!=null}const iy=(r,e)=>r,PZ={HIERARCHY:!0,extensions:!0,extras:!0};class UL{constructor(e,t,n){var i;let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};W(this,"json",void 0),W(this,"binary",void 0),W(this,"featureCount",void 0),W(this,"_extensions",void 0),W(this,"_properties",void 0),W(this,"_binaryProperties",void 0),W(this,"_hierarchy",void 0),ci(n>=0),this.json=e||{},this.binary=t,this.featureCount=n,this._extensions=((i=this.json)===null||i===void 0?void 0:i.extensions)||{},this._properties={};for(const a in this.json)PZ[a]||(this._properties[a]=this.json[a]);this._binaryProperties=this._initializeBinaryProperties(),s["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=TZ(this,this.json,this.binary))}getExtension(e){return this.json&&this.json.extensions&&this.json.extensions[e]}memorySizeInBytes(){return 0}isClass(e,t){if(this._checkBatchId(e),ci(typeof t=="string",t),this._hierarchy){const n=xg(this._hierarchy,e,(i,s)=>{const a=i.classIds[s];return i.classes[a].name===t});return la(n)}return!1}isExactClass(e,t){return ci(typeof t=="string",t),this.getExactClassName(e)===t}getExactClassName(e){if(this._checkBatchId(e),this._hierarchy){const t=this._hierarchy.classIds[e];return this._hierarchy.classes[t].name}}hasProperty(e,t){return this._checkBatchId(e),ci(typeof t=="string",t),la(this._properties[t])||this._hasPropertyInHierarchy(e,t)}getPropertyNames(e,t){this._checkBatchId(e),t=la(t)?t:[],t.length=0;const n=Object.keys(this._properties);return t.push(...n),this._hierarchy&&this._getPropertyNamesInHierarchy(e,t),t}getProperty(e,t){if(this._checkBatchId(e),ci(typeof t=="string",t),this._binaryProperties){const i=this._binaryProperties[t];if(la(i))return this._getBinaryProperty(i,e)}const n=this._properties[t];if(la(n))return iy(n[e]);if(this._hierarchy){const i=this._getHierarchyProperty(e,t);if(la(i))return i}}setProperty(e,t,n){const i=this.featureCount;if(this._checkBatchId(e),ci(typeof t=="string",t),this._binaryProperties){const a=this._binaryProperties[t];if(a){this._setBinaryProperty(a,e,n);return}}if(this._hierarchy&&this._setHierarchyProperty(this,e,t,n))return;let s=this._properties[t];la(s)||(this._properties[t]=new Array(i),s=this._properties[t]),s[e]=iy(n)}_checkBatchId(e){if(!(e>=0&&e<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(e,t){return e.unpack(e.typedArray,t)}_setBinaryProperty(e,t,n){e.pack(n,e.typedArray,t)}_initializeBinaryProperties(){let e=null;for(const t in this._properties){const n=this._properties[t],i=this._initializeBinaryProperty(t,n);i&&(e=e||{},e[t]=i)}return e}_initializeBinaryProperty(e,t){if("byteOffset"in t){const n=t;ci(this.binary,"Property ".concat(e," requires a batch table binary.")),ci(n.type,"Property ".concat(e," requires a type."));const i=SZ(n,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:i.values,componentCount:i.size,unpack:i.unpacker,pack:i.packer}}return null}_hasPropertyInHierarchy(e,t){if(!this._hierarchy)return!1;const n=xg(this._hierarchy,e,(i,s)=>{const a=i.classIds[s],o=i.classes[a].instances;return la(o[t])});return la(n)}_getPropertyNamesInHierarchy(e,t){xg(this._hierarchy,e,(n,i)=>{const s=n.classIds[i],a=n.classes[s].instances;for(const o in a)a.hasOwnProperty(o)&&t.indexOf(o)===-1&&t.push(o)})}_getHierarchyProperty(e,t){return xg(this._hierarchy,e,(n,i)=>{const s=n.classIds[i],a=n.classes[s],o=n.classIndexes[i],A=a.instances[t];return la(A)?la(A.typedArray)?this._getBinaryProperty(A,o):iy(A[o]):null})}_setHierarchyProperty(e,t,n,i){const s=xg(this._hierarchy,t,(a,o)=>{const A=a.classIds[o],f=a.classes[A],m=a.classIndexes[o],v=f.instances[n];return la(v)?(ci(o===t,'Inherited property "'.concat(n,'" is read-only.')),la(v.typedArray)?this._setBinaryProperty(v,m,i):v[m]=iy(i),!0):!1});return la(s)}}const Qw=4;function sy(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const n=new DataView(e);if(r.magic=n.getUint32(t,!0),t+=Qw,r.version=n.getUint32(t,!0),t+=Qw,r.byteLength=n.getUint32(t,!0),t+=Qw,r.version!==1)throw new Error("3D Tile Version ".concat(r.version," not supported"));return t}const hf=4,RL="b3dm tile in legacy format.";function Hw(r,e,t){const n=new DataView(e);let i;r.header=r.header||{};let s=n.getUint32(t,!0);t+=hf;let a=n.getUint32(t,!0);t+=hf;let o=n.getUint32(t,!0);t+=hf;let A=n.getUint32(t,!0);return t+=hf,o>=570425344?(t-=hf*2,i=s,o=a,A=0,s=0,a=0,console.warn(RL)):A>=570425344&&(t-=hf,i=o,o=s,A=a,s=0,a=0,console.warn(RL)),r.header.featureTableJsonByteLength=s,r.header.featureTableBinaryByteLength=a,r.header.batchTableJsonByteLength=o,r.header.batchTableBinaryByteLength=A,r.header.batchLength=i,t}function zw(r,e,t,n){return t=UZ(r,e,t),t=RZ(r,e,t),t}function UZ(r,e,t,n){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:s,batchLength:a}=r.header;if(r.featureTableJson={BATCH_LENGTH:a||0},i>0){const o=LL(e,t,i);r.featureTableJson=JSON.parse(o)}return t+=i,r.featureTableBinary=new Uint8Array(e,t,s),t+=s,t}function RZ(r,e,t,n){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:s}=r.header;if(i>0){const a=LL(e,t,i);r.batchTableJson=JSON.parse(a),t+=i,s>0&&(r.batchTableBinary=new Uint8Array(e,t,s),r.batchTableBinary=new Uint8Array(r.batchTableBinary),t+=s)}return t}function OL(r,e,t){if(!e&&(!r||!r.batchIds||!t))return null;const{batchIds:n,isRGB565:i,pointCount:s}=r;if(n&&t){const a=new Uint8ClampedArray(s*3);for(let o=0;o<s;o++){const A=n[o],m=t.getProperty(A,"dimensions").map(v=>v*255);a[o*3]=m[0],a[o*3+1]=m[1],a[o*3+2]=m[2]}return{type:Un.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}if(i){const a=new Uint8ClampedArray(s*3);for(let o=0;o<s;o++){const A=bZ(e[o]);a[o*3]=A[0],a[o*3+1]=A[1],a[o*3+2]=A[2]}return{type:Un.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}return e&&e.length===s*3?{type:Un.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:Un.UNSIGNED_BYTE,value:e,size:4,normalized:!0}}const DL=new ut;function OZ(r,e){if(!e)return null;if(r.isOctEncoded16P){const t=new Float32Array(r.pointsLength*3);for(let n=0;n<r.pointsLength;n++)xZ(e[n*2],e[n*2+1],DL),DL.toArray(t,n*3);return{type:Un.FLOAT,size:2,value:t}}return{type:Un.FLOAT,size:2,value:e}}function DZ(r,e,t){return r.isQuantized?t["3d-tiles"]&&t["3d-tiles"].decodeQuantizedPositions?(r.isQuantized=!1,kZ(r,e)):{type:Un.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}function kZ(r,e){const t=new ut,n=new Float32Array(r.pointCount*3);for(let i=0;i<r.pointCount;i++)t.set(e[i*3],e[i*3+1],e[i*3+2]).scale(1/r.quantizedRange).multiply(r.quantizedVolumeScale).add(r.quantizedVolumeOffset).toArray(n,i*3);return n}async function NZ(r,e,t,n,i){t=sy(r,e,t),t=Hw(r,e,t),t=zw(r,e,t),QZ(r);const{featureTable:s,batchTable:a}=HZ(r);return await qZ(r,s,a,n,i),zZ(r,s,n),GZ(r,s,a),VZ(r,s),t}function QZ(r){r.attributes={positions:null,colors:null,normals:null,batchIds:null},r.isQuantized=!1,r.isTranslucent=!1,r.isRGB565=!1,r.isOctEncoded16P=!1}function HZ(r){const e=new Nw(r.featureTableJson,r.featureTableBinary),t=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(t))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=t,r.featuresLength=t,r.pointsLength=t,r.pointCount=t,r.rtcCenter=e.getGlobalProperty("RTC_CENTER",Un.FLOAT,3);const n=jZ(r,e);return{featureTable:e,batchTable:n}}function zZ(r,e,t){if(!r.attributes.positions){if(e.hasProperty("POSITION"))r.attributes.positions=e.getPropertyArray("POSITION",Un.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){const n=e.getPropertyArray("POSITION_QUANTIZED",Un.UNSIGNED_SHORT,3);if(r.isQuantized=!0,r.quantizedRange=65535,r.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Un.FLOAT,3),!r.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(r.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Un.FLOAT,3),!r.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");r.attributes.positions=DZ(r,n,t)}}if(!r.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function GZ(r,e,t){if(!r.attributes.colors){let n=null;e.hasProperty("RGBA")?(n=e.getPropertyArray("RGBA",Un.UNSIGNED_BYTE,4),r.isTranslucent=!0):e.hasProperty("RGB")?n=e.getPropertyArray("RGB",Un.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(n=e.getPropertyArray("RGB565",Un.UNSIGNED_SHORT,1),r.isRGB565=!0),r.attributes.colors=OL(r,n,t)}e.hasProperty("CONSTANT_RGBA")&&(r.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",Un.UNSIGNED_BYTE,4))}function VZ(r,e){if(!r.attributes.normals){let t=null;e.hasProperty("NORMAL")?t=e.getPropertyArray("NORMAL",Un.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(t=e.getPropertyArray("NORMAL_OCT16P",Un.UNSIGNED_BYTE,2),r.isOctEncoded16P=!0),r.attributes.normals=OZ(r,t)}}function jZ(r,e){let t=null;if(!r.batchIds&&e.hasProperty("BATCH_ID")&&(r.batchIds=e.getPropertyArray("BATCH_ID",Un.UNSIGNED_SHORT,1),r.batchIds)){const n=e.getGlobalProperty("BATCH_LENGTH");if(!n)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:s}=r;t=new UL(i,s,n)}return t}async function qZ(r,e,t,n,i){let s,a,o;const A=r.batchTableJson&&r.batchTableJson.extensions&&r.batchTableJson.extensions["3DTILES_draco_point_compression"];A&&(o=A.properties);const f=e.getExtension("3DTILES_draco_point_compression");if(f){a=f.properties;const v=f.byteOffset,x=f.byteLength;if(!a||!Number.isFinite(v)||!x)throw new Error("Draco properties, byteOffset, and byteLength must be defined");s=r.featureTableBinary.slice(v,v+x),r.hasPositions=Number.isFinite(a.POSITION),r.hasColors=Number.isFinite(a.RGB)||Number.isFinite(a.RGBA),r.hasNormals=Number.isFinite(a.NORMAL),r.hasBatchIds=Number.isFinite(a.BATCH_ID),r.isTranslucent=Number.isFinite(a.RGBA)}if(!s)return!0;const m={buffer:s,properties:{...a,...o},featureTableProperties:a,batchTableProperties:o,dequantizeInShader:!1};return await KZ(r,m,n,i)}async function KZ(r,e,t,n){const{parse:i}=n,s={...t,draco:{...t.draco,extraAttributes:e.batchTableProperties||{}}};delete s["3d-tiles"];const a=await i(e.buffer,WI,s),o=a.attributes.POSITION&&a.attributes.POSITION.value,A=a.attributes.COLOR_0&&a.attributes.COLOR_0.value,f=a.attributes.NORMAL&&a.attributes.NORMAL.value,m=a.attributes.BATCH_ID&&a.attributes.BATCH_ID.value,v=o&&a.attributes.POSITION.value.quantization,x=f&&a.attributes.NORMAL.value.quantization;if(v){const M=a.POSITION.data.quantization,U=M.range;r.quantizedVolumeScale=new ut(U,U,U),r.quantizedVolumeOffset=new ut(M.minValues),r.quantizedRange=(1<<M.quantizationBits)-1,r.isQuantizedDraco=!0}x&&(r.octEncodedRange=(1<<a.NORMAL.data.quantization.quantizationBits)-1,r.isOctEncodedDraco=!0);const B={};if(e.batchTableProperties)for(const M of Object.keys(e.batchTableProperties))a.attributes[M]&&a.attributes[M].value&&(B[M.toLowerCase()]=a.attributes[M].value);r.attributes={positions:o,colors:OL(r,A,void 0),normals:f,batchIds:m,...B}}const Gw={URI:0,EMBEDDED:1};function kL(r,e,t,n){r.rotateYtoZ=!0;const i=r.byteOffset+r.byteLength-t;if(i===0)throw new Error("glTF byte length must be greater than 0.");return r.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y",r.gltfArrayBuffer=av(e,t,i),r.gltfByteOffset=0,r.gltfByteLength=i,t%4===0||console.warn("".concat(r.type,": embedded glb is not aligned to a 4-byte boundary.")),r.byteOffset+r.byteLength}async function NL(r,e,t,n){const i=t["3d-tiles"]||{};if(WZ(r,e),i.loadGLTF){const{parse:s,fetch:a}=n;r.gltfUrl&&(r.gltfArrayBuffer=await a(r.gltfUrl,t),r.gltfByteOffset=0),r.gltfArrayBuffer&&(r.gltf=await s(r.gltfArrayBuffer,vg,t,n),r.gpuMemoryUsageInBytes=VI(r.gltf),delete r.gltfArrayBuffer,delete r.gltfByteOffset,delete r.gltfByteLength)}}function WZ(r,e,t){switch(e){case Gw.URI:const n=new Uint8Array(r.gltfArrayBuffer,r.gltfByteOffset),s=new TextDecoder().decode(n);r.gltfUrl=s.replace(/[\s\0]+$/,""),delete r.gltfArrayBuffer,delete r.gltfByteOffset,delete r.gltfByteLength;break;case Gw.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function $Z(r,e,t,n,i){var s;t=XZ(r,e,t,n),await NL(r,Gw.EMBEDDED,n,i);const a=r==null||(s=r.gltf)===null||s===void 0?void 0:s.extensions;return a&&a.CESIUM_RTC&&(r.rtcCenter=a.CESIUM_RTC.center),t}function XZ(r,e,t,n,i){t=sy(r,e,t),t=Hw(r,e,t),t=zw(r,e,t),t=kL(r,e,t,n);const s=new Nw(r.featureTableJson,r.featureTableBinary);return r.rtcCenter=s.getGlobalProperty("RTC_CENTER",Un.FLOAT,3),t}async function JZ(r,e,t,n,i){return t=YZ(r,e,t,n),await NL(r,r.gltfFormat,n,i),t}function YZ(r,e,t,n,i){if(t=sy(r,e,t),r.version!==1)throw new Error("Instanced 3D Model version ".concat(r.version," is not supported"));t=Hw(r,e,t);const s=new DataView(e);if(r.gltfFormat=s.getUint32(t,!0),t+=4,t=zw(r,e,t),t=kL(r,e,t,n),r.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const a=new Nw(r.featureTableJson,r.featureTableBinary),o=a.getGlobalProperty("INSTANCES_LENGTH");if(a.featuresLength=o,!Number.isFinite(o))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");r.eastNorthUp=a.getGlobalProperty("EAST_NORTH_UP"),r.rtcCenter=a.getGlobalProperty("RTC_CENTER",Un.FLOAT,3);const A=new UL(r.batchTableJson,r.batchTableBinary,o);return ZZ(r,a,A,o),t}function ZZ(r,e,t,n){const s={instances:new Array(n),batchTable:r._batchTable,cull:!1,url:void 0,gltf:void 0,basePath:void 0,incrementallyLoadTextures:!1,forwardAxis:[1,0,0]}.instances,a=new ut;new ut,new ut,new ut;const o=new zi,A=new eg,f=new ut,m={},v=new Bn,x=[],B=[],M=new ut,U=new ut;for(let N=0;N<n;N++){let Q;if(e.hasProperty("POSITION"))Q=e.getProperty("POSITION",Un.FLOAT,3,N,a);else if(e.hasProperty("POSITION_QUANTIZED")){Q=e.getProperty("POSITION_QUANTIZED",Un.UNSIGNED_SHORT,3,N,a);const ye=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Un.FLOAT,3,M);if(!ye)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const fe=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Un.FLOAT,3,U);if(!fe)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const Oe=65535;for(let Fe=0;Fe<3;Fe++)Q[Fe]=Q[Fe]/Oe*fe[Fe]+ye[Fe]}if(!Q)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");if(a.copy(Q),m.translation=a,r.normalUp=e.getProperty("NORMAL_UP",Un.FLOAT,3,N,x),r.normalRight=e.getProperty("NORMAL_RIGHT",Un.FLOAT,3,N,B),r.normalUp){if(!r.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");r.hasCustomOrientation=!0}else{if(r.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",Un.UNSIGNED_SHORT,2,x),r.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",Un.UNSIGNED_SHORT,2,B),r.octNormalUp)throw r.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");r.eastNorthUp?(Mi.WGS84.eastNorthUpToFixedFrame(a,v),v.getRotationMatrix3(o)):o.identity()}A.fromMatrix3(o),m.rotation=A,f.set(1,1,1);const q=e.getProperty("SCALE",Un.FLOAT,1,N);Number.isFinite(q)&&f.multiplyByScalar(q);const Y=e.getProperty("SCALE_NON_UNIFORM",Un.FLOAT,3,N,x);Y&&f.scale(Y),m.scale=f;let te=e.getProperty("BATCH_ID",Un.UNSIGNED_SHORT,1,N);te===void 0&&(te=N);const pe=new Bn().fromQuaternion(m.rotation);v.identity(),v.translate(m.translation),v.multiplyRight(pe),v.scale(m.scale);const ge=v.clone();s[N]={modelMatrix:ge,batchId:te}}r.instances=s}async function eee(r,e,t,n,i,s){t=sy(r,e,t);const a=new DataView(e);for(r.tilesLength=a.getUint32(t,!0),t+=4,r.tiles=[];r.tiles.length<r.tilesLength&&r.byteLength-t>12;){const o={};r.tiles.push(o),t=await s(e,t,n,i,o)}return t}async function tee(r,e,t,n){r.rotateYtoZ=!0,r.gltfUpAxis=t["3d-tiles"]&&t["3d-tiles"].assetGltfUpAxis?t["3d-tiles"].assetGltfUpAxis:"Y";const{parse:i}=n;r.gltf=await i(e,vg,t,n),r.gpuMemoryUsageInBytes=VI(r.gltf)}async function QL(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};switch(i.byteOffset=e,i.type=mZ(r,e),i.type){case wg.COMPOSITE:return await eee(i,r,e,t,n,QL);case wg.BATCHED_3D_MODEL:return await $Z(i,r,e,t,n);case wg.GLTF:return await tee(i,r,t,n);case wg.INSTANCED_3D_MODEL:return await JZ(i,r,e,t,n);case wg.POINT_CLOUD:return await NZ(i,r,e,t,n);default:throw new Error("3DTileLoader: unknown type ".concat(i.type))}}const ree=1952609651,nee=1;async function iee(r,e,t){if(new Uint32Array(r.slice(0,4))[0]!==ree)throw new Error("Wrong subtree file magic number");if(new Uint32Array(r.slice(4,8))[0]!==nee)throw new Error("Wrong subtree file verson, must be 1");const s=HL(r.slice(8,16)),a=new Uint8Array(r,24,s),A=new TextDecoder("utf8").decode(a),f=JSON.parse(A),m=HL(r.slice(16,24));let v=new ArrayBuffer(0);return m&&(v=r.slice(24+s)),"bufferView"in f.tileAvailability&&(f.tileAvailability.explicitBitstream=await Vw(f,"tileAvailability",v,t)),"bufferView"in f.contentAvailability&&(f.contentAvailability.explicitBitstream=await Vw(f,"contentAvailability",v,t)),"bufferView"in f.childSubtreeAvailability&&(f.childSubtreeAvailability.explicitBitstream=await Vw(f,"childSubtreeAvailability",v,t)),f}function see(r,e){if(e.startsWith("http")){const s=new URL(r,e);return decodeURI(s.toString())}const n="http://".concat(e),i=new URL(r,n);return"/".concat(i.host).concat(i.pathname)}async function Vw(r,e,t,n){const i=r[e].bufferView,s=r.bufferViews[i],a=r.buffers[s.buffer];if(!(n!=null&&n.url)||!n.fetch)throw new Error("Url is not provided");if(!n.fetch)throw new Error("fetch is not provided");if(a.uri){const o=see(a.uri,n==null?void 0:n.url),f=await(await n.fetch(o)).arrayBuffer();return new Uint8Array(f,s.byteOffset,s.byteLength)}return new Uint8Array(t,s.byteOffset,s.byteLength)}function HL(r){const e=new DataView(r),t=e.getUint32(0,!0),n=e.getUint32(4,!0);return t+2**32*n}const zL={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:IL,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:iee,options:{}};/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var oc=null;try{oc=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Xn(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}Xn.prototype.__isLong__,Object.defineProperty(Xn.prototype,"__isLong__",{value:!0});function uo(r){return(r&&r.__isLong__)===!0}function VL(r){var e=Math.clz32(r&-r);return r?31-e:e}Xn.isLong=uo;var jL={},qL={};function Nh(r,e){var t,n,i;return e?(r>>>=0,(i=0<=r&&r<256)&&(n=qL[r],n)?n:(t=On(r,0,!0),i&&(qL[r]=t),t)):(r|=0,(i=-128<=r&&r<128)&&(n=jL[r],n)?n:(t=On(r,r<0?-1:0,!1),i&&(jL[r]=t),t))}Xn.fromInt=Nh;function ac(r,e){if(isNaN(r))return e?Uu:jc;if(e){if(r<0)return Uu;if(r>=WL)return ZL}else{if(r<=-$L)return ua;if(r+1>=$L)return YL}return r<0?ac(-r,e).neg():On(r%df|0,r/df|0,e)}Xn.fromNumber=ac;function On(r,e,t){return new Xn(r,e,t)}Xn.fromBits=On;var oy=Math.pow;function jw(r,e,t){if(r.length===0)throw Error("empty string");if(typeof e=="number"?(t=e,e=!1):e=!!e,r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return e?Uu:jc;if(t=t||10,t<2||36<t)throw RangeError("radix");var n;if((n=r.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return jw(r.substring(1),e,t).neg();for(var i=ac(oy(t,8)),s=jc,a=0;a<r.length;a+=8){var o=Math.min(8,r.length-a),A=parseInt(r.substring(a,a+o),t);if(o<8){var f=ac(oy(t,o));s=s.mul(f).add(ac(A))}else s=s.mul(i),s=s.add(ac(A))}return s.unsigned=e,s}Xn.fromString=jw;function Vc(r,e){return typeof r=="number"?ac(r,e):typeof r=="string"?jw(r,e):On(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}Xn.fromValue=Vc;var KL=65536,oee=1<<24,df=KL*KL,WL=df*df,$L=WL/2,XL=Nh(oee),jc=Nh(0);Xn.ZERO=jc;var Uu=Nh(0,!0);Xn.UZERO=Uu;var ff=Nh(1);Xn.ONE=ff;var JL=Nh(1,!0);Xn.UONE=JL;var qw=Nh(-1);Xn.NEG_ONE=qw;var YL=On(-1,2147483647,!1);Xn.MAX_VALUE=YL;var ZL=On(-1,-1,!0);Xn.MAX_UNSIGNED_VALUE=ZL;var ua=On(0,-2147483648,!1);Xn.MIN_VALUE=ua;var Gt=Xn.prototype;Gt.toInt=function(){return this.unsigned?this.low>>>0:this.low},Gt.toNumber=function(){return this.unsigned?(this.high>>>0)*df+(this.low>>>0):this.high*df+(this.low>>>0)},Gt.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ua)){var t=ac(e),n=this.div(t),i=n.mul(t).sub(this);return n.toString(e)+i.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=ac(oy(e,6),this.unsigned),a=this,o="";;){var A=a.div(s),f=a.sub(A.mul(s)).toInt()>>>0,m=f.toString(e);if(a=A,a.isZero())return m+o;for(;m.length<6;)m="0"+m;o=""+m+o}},Gt.getHighBits=function(){return this.high},Gt.getHighBitsUnsigned=function(){return this.high>>>0},Gt.getLowBits=function(){return this.low},Gt.getLowBitsUnsigned=function(){return this.low>>>0},Gt.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ua)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1},Gt.isZero=function(){return this.high===0&&this.low===0},Gt.eqz=Gt.isZero,Gt.isNegative=function(){return!this.unsigned&&this.high<0},Gt.isPositive=function(){return this.unsigned||this.high>=0},Gt.isOdd=function(){return(this.low&1)===1},Gt.isEven=function(){return(this.low&1)===0},Gt.equals=function(e){return uo(e)||(e=Vc(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low},Gt.eq=Gt.equals,Gt.notEquals=function(e){return!this.eq(e)},Gt.neq=Gt.notEquals,Gt.ne=Gt.notEquals,Gt.lessThan=function(e){return this.comp(e)<0},Gt.lt=Gt.lessThan,Gt.lessThanOrEqual=function(e){return this.comp(e)<=0},Gt.lte=Gt.lessThanOrEqual,Gt.le=Gt.lessThanOrEqual,Gt.greaterThan=function(e){return this.comp(e)>0},Gt.gt=Gt.greaterThan,Gt.greaterThanOrEqual=function(e){return this.comp(e)>=0},Gt.gte=Gt.greaterThanOrEqual,Gt.ge=Gt.greaterThanOrEqual,Gt.compare=function(e){if(uo(e)||(e=Vc(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},Gt.comp=Gt.compare,Gt.negate=function(){return!this.unsigned&&this.eq(ua)?ua:this.not().add(ff)},Gt.neg=Gt.negate,Gt.add=function(e){uo(e)||(e=Vc(e));var t=this.high>>>16,n=this.high&65535,i=this.low>>>16,s=this.low&65535,a=e.high>>>16,o=e.high&65535,A=e.low>>>16,f=e.low&65535,m=0,v=0,x=0,B=0;return B+=s+f,x+=B>>>16,B&=65535,x+=i+A,v+=x>>>16,x&=65535,v+=n+o,m+=v>>>16,v&=65535,m+=t+a,m&=65535,On(x<<16|B,m<<16|v,this.unsigned)},Gt.subtract=function(e){return uo(e)||(e=Vc(e)),this.add(e.neg())},Gt.sub=Gt.subtract,Gt.multiply=function(e){if(this.isZero())return this;if(uo(e)||(e=Vc(e)),oc){var t=oc.mul(this.low,this.high,e.low,e.high);return On(t,oc.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?Uu:jc;if(this.eq(ua))return e.isOdd()?ua:jc;if(e.eq(ua))return this.isOdd()?ua:jc;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(XL)&&e.lt(XL))return ac(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,i=this.high&65535,s=this.low>>>16,a=this.low&65535,o=e.high>>>16,A=e.high&65535,f=e.low>>>16,m=e.low&65535,v=0,x=0,B=0,M=0;return M+=a*m,B+=M>>>16,M&=65535,B+=s*m,x+=B>>>16,B&=65535,B+=a*f,x+=B>>>16,B&=65535,x+=i*m,v+=x>>>16,x&=65535,x+=s*f,v+=x>>>16,x&=65535,x+=a*A,v+=x>>>16,x&=65535,v+=n*m+i*f+s*A+a*o,v&=65535,On(B<<16|M,v<<16|x,this.unsigned)},Gt.mul=Gt.multiply,Gt.divide=function(e){if(uo(e)||(e=Vc(e)),e.isZero())throw Error("division by zero");if(oc){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?oc.div_u:oc.div_s)(this.low,this.high,e.low,e.high);return On(t,oc.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Uu:jc;var n,i,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Uu;if(e.gt(this.shru(1)))return JL;s=Uu}else{if(this.eq(ua)){if(e.eq(ff)||e.eq(qw))return ua;if(e.eq(ua))return ff;var a=this.shr(1);return n=a.div(e).shl(1),n.eq(jc)?e.isNegative()?ff:qw:(i=this.sub(e.mul(n)),s=n.add(i.div(e)),s)}else if(e.eq(ua))return this.unsigned?Uu:jc;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=jc}for(i=this;i.gte(e);){n=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),A=o<=48?1:oy(2,o-48),f=ac(n),m=f.mul(e);m.isNegative()||m.gt(i);)n-=A,f=ac(n,this.unsigned),m=f.mul(e);f.isZero()&&(f=ff),s=s.add(f),i=i.sub(m)}return s},Gt.div=Gt.divide,Gt.modulo=function(e){if(uo(e)||(e=Vc(e)),oc){var t=(this.unsigned?oc.rem_u:oc.rem_s)(this.low,this.high,e.low,e.high);return On(t,oc.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))},Gt.mod=Gt.modulo,Gt.rem=Gt.modulo,Gt.not=function(){return On(~this.low,~this.high,this.unsigned)},Gt.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},Gt.clz=Gt.countLeadingZeros,Gt.countTrailingZeros=function(){return this.low?VL(this.low):VL(this.high)+32},Gt.ctz=Gt.countTrailingZeros,Gt.and=function(e){return uo(e)||(e=Vc(e)),On(this.low&e.low,this.high&e.high,this.unsigned)},Gt.or=function(e){return uo(e)||(e=Vc(e)),On(this.low|e.low,this.high|e.high,this.unsigned)},Gt.xor=function(e){return uo(e)||(e=Vc(e)),On(this.low^e.low,this.high^e.high,this.unsigned)},Gt.shiftLeft=function(e){return uo(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?On(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):On(0,this.low<<e-32,this.unsigned)},Gt.shl=Gt.shiftLeft,Gt.shiftRight=function(e){return uo(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?On(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):On(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},Gt.shr=Gt.shiftRight,Gt.shiftRightUnsigned=function(e){return uo(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?On(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?On(this.high,0,this.unsigned):On(this.high>>>e-32,0,this.unsigned)},Gt.shru=Gt.shiftRightUnsigned,Gt.shr_u=Gt.shiftRightUnsigned,Gt.rotateLeft=function(e){var t;return uo(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?On(this.high,this.low,this.unsigned):e<32?(t=32-e,On(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,On(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},Gt.rotl=Gt.rotateLeft,Gt.rotateRight=function(e){var t;return uo(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?On(this.high,this.low,this.unsigned):e<32?(t=32-e,On(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,On(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},Gt.rotr=Gt.rotateRight,Gt.toSigned=function(){return this.unsigned?On(this.low,this.high,!1):this},Gt.toUnsigned=function(){return this.unsigned?this:On(this.low,this.high,!0)},Gt.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},Gt.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]},Gt.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]},Xn.fromBytes=function(e,t,n){return n?Xn.fromBytesLE(e,t):Xn.fromBytesBE(e,t)},Xn.fromBytesLE=function(e,t){return new Xn(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},Xn.fromBytesBE=function(e,t){return new Xn(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};const aee=16;function eF(r){r==="X"&&(r="");const e=r.padEnd(aee,"0");return Xn.fromString(e,!0,16)}function cee(r){if(r.isZero())return"X";let e=r.countTrailingZeros();const t=e%4;e=(e-t)/4;const n=e;e*=4;const s=r.shiftRightUnsigned(e).toString(16).replace(/0+$/,"");return Array(17-n-s.length).join("0")+s}function lee(r,e){const t=uee(r).shiftRightUnsigned(2);return r.add(Xn.fromNumber(2*e+1-4).multiply(t))}function uee(r){return r.and(r.not().add(1))}const Aee=3,hee=2*30+1,tF=180/Math.PI;function dee(r){if(r.length===0)throw new Error("Invalid Hilbert quad key ".concat(r));const e=r.split("/"),t=parseInt(e[0],10),n=e[1],i=n.length;let s=0;const a=[0,0];for(let o=i-1;o>=0;o--){s=i-o;const A=n[o];let f=0,m=0;A==="1"?m=1:A==="2"?(f=1,m=1):A==="3"&&(f=1);const v=Math.pow(2,s-1);pee(v,a,f,m),a[0]+=v*f,a[1]+=v*m}if(t%2===1){const o=a[0];a[0]=a[1],a[1]=o}return{face:t,ij:a,level:s}}function fee(r){if(r.isZero())return"";let e=r.toString(2);for(;e.length<Aee+hee;)e="0"+e;const t=e.lastIndexOf("1"),n=e.substring(0,3),i=e.substring(3,t),s=i.length/2,a=Xn.fromString(n,!0,2).toString(10);let o="";if(s!==0)for(o=Xn.fromString(i,!0,2).toString(4);o.length<s;)o="0"+o;return"".concat(a,"/").concat(o)}function rF(r,e,t){const n=1<<e;return[(r[0]+t[0])/n,(r[1]+t[1])/n]}function nF(r){return r>=.5?1/3*(4*r*r-1):1/3*(1-4*(1-r)*(1-r))}function iF(r){return[nF(r[0]),nF(r[1])]}function sF(r,e){let[t,n]=e;switch(r){case 0:return[1,t,n];case 1:return[-t,1,n];case 2:return[-t,-n,1];case 3:return[-1,-n,-t];case 4:return[n,-1,-t];case 5:return[n,t,-1];default:throw new Error("Invalid face")}}function oF(r){let[e,t,n]=r;const i=Math.atan2(n,Math.sqrt(e*e+t*t));return[Math.atan2(t,e)*tF,i*tF]}function pee(r,e,t,n){if(n===0){t===1&&(e[0]=r-1-e[0],e[1]=r-1-e[1]);const i=e[0];e[0]=e[1],e[1]=i}}function gee(r){const e=rF(r.ij,r.level,[.5,.5]),t=iF(e),n=sF(r.face,t);return oF(n)}const mee=100;function aF(r){const{face:e,ij:t,level:n}=r,i=[[0,0],[0,1],[1,1],[1,0],[0,0]],s=Math.max(1,Math.ceil(mee*Math.pow(2,-n))),a=new Float64Array(4*s*2+2);let o=0,A=0;for(let f=0;f<4;f++){const m=i[f].slice(0),v=i[f+1],x=(v[0]-m[0])/s,B=(v[1]-m[1])/s;for(let M=0;M<s;M++){m[0]+=x,m[1]+=B;const U=rF(t,n,m),N=iF(U),Q=sF(e,N),q=oF(Q);Math.abs(q[1])>89.999&&(q[0]=A);const Y=q[0]-A;q[0]+=Y>180?-360:Y<-180?360:0,a[o++]=q[0],a[o++]=q[1],A=q[0]}}return a[o++]=a[0],a[o++]=a[1],a}function Kw(r){const e=yee(r);return dee(e)}function yee(r){if(r.indexOf("/")>0)return r;const e=eF(r);return fee(e)}function _ee(r){const e=Kw(r);return gee(e)}function vee(r){let e;if(r.face===2||r.face===5){let t=null,n=0;for(let i=0;i<4;i++){const s="".concat(r.face,"/").concat(i),a=Kw(s),o=aF(a);(typeof t>"u"||t===null)&&(t=new Float64Array(4*o.length)),t.set(o,n),n+=o.length}e=cF(t)}else{const t=aF(r);e=cF(t)}return e}function cF(r){if(r.length%2!==0)throw new Error("Invalid corners");const e=[],t=[];for(let n=0;n<r.length;n+=2)e.push(r[n]),t.push(r[n+1]);return e.sort((n,i)=>n-i),t.sort((n,i)=>n-i),{west:e[0],east:e[e.length-1],north:t[t.length-1],south:t[0]}}function bee(r,e){const t=(e==null?void 0:e.minimumHeight)||0,n=(e==null?void 0:e.maximumHeight)||0,i=Kw(r),s=vee(i),a=s.west,o=s.south,A=s.east,f=s.north,m=[];return m.push(new ut(a,f,t)),m.push(new ut(A,f,t)),m.push(new ut(A,o,t)),m.push(new ut(a,o,t)),m.push(new ut(a,f,n)),m.push(new ut(A,f,n)),m.push(new ut(A,o,n)),m.push(new ut(a,o,n)),m}function lF(r){const e=r.token,t={minimumHeight:r.minimumHeight,maximumHeight:r.maximumHeight},n=bee(e,t),i=_ee(e),s=i[0],a=i[1],o=Mi.WGS84.cartographicToCartesian([s,a,t.maximumHeight]),A=new ut(o[0],o[1],o[2]);n.push(A);const f=e$(n);return[...f.center,...f.halfAxes]}const wee={QUADTREE:4,OCTREE:8};function xee(r,e,t){if(r!=null&&r.box){const n=eF(r.s2VolumeInfo.token),i=lee(n,e),s=cee(i),a={...r.s2VolumeInfo};switch(a.token=s,t){case"OCTREE":const f=r.s2VolumeInfo,m=f.maximumHeight-f.minimumHeight,v=m/2,x=f.minimumHeight+m/2;f.minimumHeight=x-v,f.maximumHeight=x+v;break}return{box:lF(a),s2VolumeInfo:a}}}async function uF(r){const{options:e,parentData:t={mortonIndex:0,x:0,y:0,z:0},childIndex:n=0,globalData:i={level:0,mortonIndex:0,x:0,y:0,z:0},s2VolumeBox:s}=r;let{subtree:a,level:o=0}=r;const{subdivisionScheme:A,subtreeLevels:f,maximumLevel:m,contentUrlTemplate:v,subtreesUriTemplate:x,basePath:B}=e,M={children:[],lodMetricValue:0,contentUrl:""},U=wee[A],N=n&1,Q=n>>1&1,q=n>>2&1,Y=(U**o-1)/(U-1);let te=Qh(t.mortonIndex,n),pe=Y+te,ge=Qh(t.x,N),ye=Qh(t.y,Q),fe=Qh(t.z,q),Oe=!1;o+1>f&&(Oe=Ww(a.childSubtreeAvailability,te));const Fe=Qh(i.x,ge),oe=Qh(i.y,ye),le=Qh(i.z,fe),xe=o+i.level;if(Oe){const Je="".concat(B,"/").concat(x),it=$w(Je,xe,Fe,oe,le);a=await wA(it,zL),i.mortonIndex=te,i.x=ge,i.y=ye,i.z=fe,i.level=o,te=0,pe=0,ge=0,ye=0,fe=0,o=0}if(!Ww(a.tileAvailability,pe)||o>m)return M;Ww(a.contentAvailability,pe)&&(M.contentUrl=$w(v,xe,Fe,oe,le));const et=o+1,nt={mortonIndex:te,x:ge,y:ye,z:fe};for(let Je=0;Je<U;Je++){const it=xee(s,Je,A),ot=await uF({subtree:a,options:e,parentData:nt,childIndex:Je,level:et,globalData:i,s2VolumeBox:it});if(ot.contentUrl||ot.children.length){const xt=xe+1,be=Bee(ot,xt,{childTileX:ge,childTileY:ye,childTileZ:fe},e,s);M.children.push(be)}}return M}function Ww(r,e){return"constant"in r?!!r.constant:r.explicitBitstream?See(e,r.explicitBitstream):!1}function Bee(r,e,t,n,i){const{basePath:s,refine:a,getRefine:o,lodMetricType:A,getTileType:f,rootLodMetricValue:m,rootBoundingVolume:v}=n,x=r.contentUrl&&r.contentUrl.replace("".concat(s,"/"),""),B=m/2**e,M=i!=null&&i.box?{box:i.box}:v,U=Cee(e,M,t);return{children:r.children,contentUrl:r.contentUrl,content:{uri:x},id:r.contentUrl,refine:o(a),type:f(r),lodMetricType:A,lodMetricValue:B,geometricError:B,transform:r.transform,boundingVolume:U}}function Cee(r,e,t){if(e.region){const{childTileX:n,childTileY:i,childTileZ:s}=t,[a,o,A,f,m,v]=e.region,x=2**r,B=(A-a)/x,M=(f-o)/x,U=(v-m)/x,[N,Q]=[a+B*n,a+B*(n+1)],[q,Y]=[o+M*i,o+M*(i+1)],[te,pe]=[m+U*s,m+U*(s+1)];return{region:[N,q,Q,Y,te,pe]}}if(e.box)return e;throw new Error("Unsupported bounding volume type ".concat(e))}function Qh(r,e){return parseInt(r.toString(2)+e.toString(2),2)}function $w(r,e,t,n,i){const s=Eee({level:e,x:t,y:n,z:i});return r.replace(/{level}|{x}|{y}|{z}/gi,a=>s[a])}function Eee(r){const e={};for(const t in r)e["{".concat(t,"}")]=r[t];return e}function See(r,e){const t=Math.floor(r/8),n=r%8;return(e[t]>>n&1)===1}function Xw(r){if(!r.contentUrl)return Af.EMPTY;const t=r.contentUrl.split("?")[0].split(".").pop();switch(t){case"pnts":return Af.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return Af.SCENEGRAPH;default:return t}}function Jw(r){switch(r){case"REPLACE":case"replace":return Pu.REPLACE;case"ADD":case"add":return Pu.ADD;default:return r}}function Yw(r,e){if(/^[a-z][0-9a-z+.-]*:/i.test(e)){const n=new URL(r,"".concat(e,"/"));return decodeURI(n.toString())}else if(r.startsWith("/"))return r;return"".concat(e,"/").concat(r)}function AF(r,e){if(!r)return null;if(r.content){const t=r.content.uri||r.content.url;r.contentUrl=Yw(t,e.basePath)}return r.id=r.contentUrl,r.lodMetricType=ey.GEOMETRIC_ERROR,r.lodMetricValue=r.geometricError,r.transformMatrix=r.transform,r.type=Xw(r),r.refine=Jw(r.refine),r}async function Tee(r,e){const t=r.basePath;let n;const i=dF(r==null?void 0:r.root);i&&r.root?n=await hF(r.root,r,i,e):n=AF(r.root,r);const s=[];for(s.push(n);s.length>0;){const o=(s.pop()||{}).children||[];for(let A of o){const f=dF(A);f?A=await hF(A,r,f,e):AF(A,{basePath:t}),s.push(A)}}return n}async function hF(r,e,t,n){var i,s;const a=e.basePath,{subdivisionScheme:o,maximumLevel:A,subtreeLevels:f,subtrees:{uri:m}}=t,v=$w(m,0,0,0,0),x=Yw(v,a),B=await wA(x,zL,n),M=Yw(r.content.uri,a),U=e==null||(i=e.root)===null||i===void 0?void 0:i.refine,N=r.geometricError,Q=(s=r.boundingVolume.extensions)===null||s===void 0?void 0:s["3DTILES_bounding_volume_S2"];if(Q){const pe={box:lF(Q),s2VolumeInfo:Q};r.boundingVolume=pe}const q=r.boundingVolume,Y={contentUrlTemplate:M,subtreesUriTemplate:m,subdivisionScheme:o,subtreeLevels:f,maximumLevel:A,refine:U,basePath:a,lodMetricType:ey.GEOMETRIC_ERROR,rootLodMetricValue:N,rootBoundingVolume:q,getTileType:Xw,getRefine:Jw};return await Iee(r,B,Y)}async function Iee(r,e,t){if(!r)return null;r.lodMetricType=ey.GEOMETRIC_ERROR,r.lodMetricValue=r.geometricError,r.transformMatrix=r.transform;const{children:n,contentUrl:i}=await uF({subtree:e,options:t,s2VolumeBox:r});return i&&(r.contentUrl=i,r.content={uri:i.replace("".concat(t.basePath,"/"),"")}),r.refine=Jw(r.refine),r.type=Xw(r),r.children=n,r.id=r.contentUrl,r}function dF(r){var e;return(r==null||(e=r.extensions)===null||e===void 0?void 0:e["3DTILES_implicit_tiling"])||(r==null?void 0:r.implicitTiling)}const Zw={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:IL,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:Pee,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};function Lee(r){return cv(r.url)}async function Fee(r,e,t){const n={content:{featureIds:null}};return await QL(r,0,e,t,n.content),n.content}async function Mee(r,e,t){var n;const i=JSON.parse(new TextDecoder().decode(r));return i.loader=e.loader||Zw,i.url=t.url,i.queryString=t.queryString,i.basePath=Lee(i),i.root=await Tee(i,e),i.type=sc.TILES3D,i.lodMetricType=ey.GEOMETRIC_ERROR,i.lodMetricValue=((n=i.root)===null||n===void 0?void 0:n.lodMetricValue)||0,i}async function Pee(r,e,t){const n=e["3d-tiles"]||{};let i;return n.isTileset==="auto"?i=t.url&&t.url.indexOf(".json")!==-1:i=n.isTileset,i?r=await Mee(r,e,t):r=await Fee(r,e,t),r}const fF=[0],Uee={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:"",loader:Zw,onTilesetLoad:{type:"function",value:r=>{}},onTileLoad:{type:"function",value:r=>{}},onTileUnload:{type:"function",value:r=>{}},onTileError:{type:"function",value:(r,e,t)=>{}},_getMeshColor:{type:"function",value:r=>[255,255,255]}};class e2 extends J3{constructor(){super(...arguments),W(this,"state",void 0)}initializeState(){"onTileLoadFail"in this.props&&Mn.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){var e,t;return!!(!((e=this.state)===null||e===void 0||(t=e.tileset3d)===null||t===void 0)&&t.isLoaded()&&super.isLoaded)}shouldUpdateState(e){let{changeFlags:t}=e;return t.somethingChanged}updateState(e){let{props:t,oldProps:n,changeFlags:i}=e;if(t.data&&t.data!==n.data&&this._loadTileset(t.data),i.viewportChanged){const{activeViewports:s}=this.state;Object.keys(s).length&&(this._updateTileset(s),this.state.lastUpdatedViewports=s,this.state.activeViewports={})}if(i.propsChanged){const{layerMap:s}=this.state;for(const a in s)s[a].needsUpdate=!0}}activateViewport(e){const{activeViewports:t,lastUpdatedViewports:n}=this.state;this.internalState.viewport=e,t[e.id]=e;const i=n==null?void 0:n[e.id];(!i||!e.equals(i))&&(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo(e){let{info:t,sourceLayer:n}=e;const i=n&&n.props.tile;return t.picked&&(t.object=i),t.sourceTile=i,t}filterSubLayer(e){let{layer:t,viewport:n}=e;const{tile:i}=t.props,{id:s}=n;return i.selected&&i.viewportIds.includes(s)}_updateAutoHighlight(e){const t=e.sourceTile,n=this.state.layerMap[t==null?void 0:t.id];n&&n.layer&&n.layer.updateAutoHighlight(e)}async _loadTileset(e){const{loadOptions:t={}}=this.props;let n=this.props.loader||this.props.loaders;Array.isArray(n)&&(n=n[0]);const i={loadOptions:{...t}};let s=e;if(n.preload){const A=await n.preload(e,t);A.url&&(s=A.url),A.headers&&(i.loadOptions.fetch={...i.loadOptions.fetch,headers:A.headers}),Object.assign(i,A)}const a=await wA(s,n,i.loadOptions),o=new gZ(a,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError,...i});this.setState({tileset3d:o,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(o)}_onTileLoad(e){const{lastUpdatedViewports:t}=this.state;this.props.onTileLoad(e),this._updateTileset(t),this.setNeedsUpdate()}_onTileUnload(e){delete this.state.layerMap[e.id],this.props.onTileUnload(e)}_updateTileset(e){if(!e)return;const{tileset3d:t}=this.state,{timeline:n}=this.context,i=Object.keys(e).length;!n||!i||!t||t.selectTiles(Object.values(e)).then(s=>{this.state.frameNumber!==s&&this.setState({frameNumber:s})})}_getSubLayer(e,t){if(!e.content)return null;switch(e.type){case Af.POINTCLOUD:return this._makePointCloudLayer(e,t);case Af.SCENEGRAPH:return this._make3DModelLayer(e);case Af.MESH:return this._makeSimpleMeshLayer(e,t);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(e.content.type))}}_makePointCloudLayer(e,t){const{attributes:n,pointCount:i,constantRGBA:s,cartographicOrigin:a,modelMatrix:o}=e.content,{positions:A,normals:f,colors:m}=n;if(!A)return null;const v=t&&t.props.data||{header:{vertexCount:i},attributes:{POSITION:A,NORMAL:f,COLOR_0:m}},{pointSize:x,getPointColor:B}=this.props,M=this.getSubLayerClass("pointcloud",iw);return new M({pointSize:x},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(e.id),tile:e,data:v,coordinateSystem:Tn.METER_OFFSETS,coordinateOrigin:a,modelMatrix:o,getColor:s||B,_offset:0})}_make3DModelLayer(e){const{gltf:t,instances:n,cartographicOrigin:i,modelMatrix:s}=e.content,a=this.getSubLayerClass("scenegraph",xw);return new a({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(e.id),tile:e,data:n||fF,scenegraph:t,coordinateSystem:Tn.METER_OFFSETS,coordinateOrigin:i,modelMatrix:s,getTransformMatrix:o=>o.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(e,t){const n=e.content,{attributes:i,indices:s,modelMatrix:a,cartographicOrigin:o,coordinateSystem:A=Tn.METER_OFFSETS,material:f,featureIds:m}=n,{_getMeshColor:v}=this.props,x=t&&t.props.mesh||new ng({drawMode:4,attributes:Ree(i),indices:s}),B=this.getSubLayerClass("mesh",Bw);return new B(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(e.id),tile:e,mesh:x,data:fF,getColor:v(e),pbrMaterial:f,modelMatrix:a,coordinateOrigin:o,coordinateSystem:A,featureIds:m,_offset:0})}renderLayers(){const{tileset3d:e,layerMap:t}=this.state;return e?e.tiles.map(n=>{const i=t[n.id]=t[n.id]||{tile:n};let{layer:s}=i;return n.selected&&(s?i.needsUpdate&&(s=this._getSubLayer(n,s),i.needsUpdate=!1):s=this._getSubLayer(n)),i.layer=s,s}).filter(Boolean):null}}W(e2,"defaultProps",Uee),W(e2,"layerName","Tile3DLayer");function Ree(r){const e={};return e.positions={...r.positions,value:new Float32Array(r.positions.value)},r.normals&&(e.normals=r.normals),r.texCoords&&(e.texCoords=r.texCoords),r.colors&&(e.colors=r.colors),r.uvRegions&&(e.uvRegions=r.uvRegions),e}var Oee=Object.defineProperty,Dee=(r,e,t)=>e in r?Oee(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,jn=(r,e,t)=>(Dee(r,typeof e!="symbol"?e+"":e,t),t);let kee=class{constructor(e){jn(this,"map"),jn(this,"width"),jn(this,"height"),jn(this,"svgCanvas"),jn(this,"xLine"),jn(this,"yLine"),jn(this,"color","#535353"),this.map=e,this.mapResize=this.mapResize.bind(this)}create(){this.updateValues(),this.map!==void 0?(this.map.on("resize",this.mapResize),this.createCanvas(this.map.getCanvasContainer())):console.error("map object is null")}updateValues(){var e,t;this.width=(e=this.map)==null?void 0:e.getCanvas().clientWidth,this.height=(t=this.map)==null?void 0:t.getCanvas().clientHeight}mapResize(){this.updateValues(),this.updateCanvas()}updateCanvas(){if(this.svgCanvas!==void 0&&this.yLine!==void 0&&this.xLine!==void 0&&this.width!==void 0&&this.height!==void 0){this.svgCanvas.setAttribute("width",`${this.width}px`),this.svgCanvas.setAttribute("height",`${this.height}px`);const e=this.width/2,t=this.height/2;this.yLine.setAttribute("x1",`${e}px`),this.yLine.setAttribute("y1","0px"),this.yLine.setAttribute("x2",`${e}px`),this.yLine.setAttribute("y2",`${this.height}px`),this.xLine.setAttribute("x1","0px"),this.xLine.setAttribute("y1",`${t}px`),this.xLine.setAttribute("x2",`${this.width}px`),this.xLine.setAttribute("y2",`${t}px`)}else console.error("element value is null")}createCanvas(e){if(this.width!==void 0&&this.height!==void 0){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.style.position="relative",t.setAttribute("width",`${this.width}px`),t.setAttribute("height",`${this.height}px`);const n=this.width/2,i=this.height/2;this.yLine=t.appendChild(this.createLine(n,0,n,this.height,this.color,"2px")),this.xLine=t.appendChild(this.createLine(0,i,this.width,i,this.color,"2px")),e==null||e.appendChild(t),this.svgCanvas=t}}createLine(e,t,n,i,s,a){const o=document.createElementNS("http://www.w3.org/2000/svg","line");return o.setAttribute("x1",e),o.setAttribute("y1",t),o.setAttribute("x2",n),o.setAttribute("y2",i),o.setAttribute("stroke-dasharray","5,5"),o.setAttribute("stroke",s),o.setAttribute("stroke-width",a),o}destroy(){this.xLine!==void 0&&(this.xLine.remove(),this.xLine=void 0),this.yLine!==void 0&&(this.yLine.remove(),this.yLine=void 0),this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map.off("resize",this.mapResize),this.map=void 0)}};const t2={72:72,96:96,200:200,300:300,400:400},Ru={JPEG:"jpg",PNG:"png",PDF:"pdf",SVG:"svg"},Bg={Landscape:"landscape",Portrait:"portrait"},Hh={LETTER:[279,216],A2:[594,420],A3:[420,297],A4:[297,210],A5:[210,148],A6:[148,105],B2:[707,500],B3:[500,353],B4:[353,250],B5:[250,176],B6:[176,125]},pf={in:"in",mm:"mm"};let Nee=class{constructor(e){jn(this,"map"),jn(this,"width"),jn(this,"height"),jn(this,"unit"),jn(this,"svgCanvas"),jn(this,"svgPath");var t,n,i;if(this.map=e,this.map===void 0)return;this.mapResize=this.mapResize.bind(this),this.map.on("resize",this.mapResize);const s=(t=this.map)==null?void 0:t.getCanvas().clientWidth,a=(n=this.map)==null?void 0:n.getCanvas().clientHeight,o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.style.position="absolute",o.style.top="0px",o.style.left="0px",o.setAttribute("width",`${s}px`),o.setAttribute("height",`${a}px`);const A=document.createElementNS("http://www.w3.org/2000/svg","path");A.setAttribute("style","fill:#888888;stroke-width:0"),A.setAttribute("fill-opacity","0.5"),o.append(A),(i=this.map)==null||i.getCanvasContainer().appendChild(o),this.svgCanvas=o,this.svgPath=A}mapResize(){this.generateCutOut()}updateArea(e,t){this.width=e,this.height=t,this.unit=pf.mm,this.generateCutOut()}generateCutOut(){var e,t;if(this.map===void 0||this.svgCanvas===void 0||this.svgPath===void 0)return;const n=this.toPixels(this.width),i=this.toPixels(this.height),s=(e=this.map)==null?void 0:e.getCanvas().clientWidth,a=(t=this.map)==null?void 0:t.getCanvas().clientHeight,o=s/2-n/2,A=o+n,f=a/2-i/2,m=f+i;this.svgCanvas.setAttribute("width",`${s}px`),this.svgCanvas.setAttribute("height",`${a}px`),this.svgPath.setAttribute("d",`M 0 0 L ${s} 0 L ${s} ${a} L 0 ${a} M ${o} ${f} L ${o} ${m} L ${A} ${m} L ${A} ${f}`)}destroy(){this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map=void 0)}toPixels(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:96;return this.unit===pf.mm&&(t/=25.4),t*e}};const pF={PageSize:"Page Size",PageOrientation:"Page Orientation",Format:"Format",DPI:"DPI",Generate:"Generate",LanguageName:"English"},Qee={PageSize:"Taille de page",PageOrientation:"Orientation de la page",Format:"Format",DPI:"DPI",Generate:"Gnrer",LanguageName:"French"},Hee={PageSize:"Sivukoko",PageOrientation:"Sivun suunta",Format:"Muoto",DPI:"DPI",Generate:"Generoi",LanguageName:"Finish"},zee={PageSize:"Papierformat",PageOrientation:"Papierausrichtung",Format:"Dateiformat",DPI:"Druckauflsung",Generate:"Erstellen",LanguageName:"German"},Gee={PageSize:"Sidstorlek",PageOrientation:"Sidorientering",Format:"Format",DPI:"DPI",Generate:"Generera",LanguageName:"Swedish"},Vee={PageSize:"Tamao de pgina",PageOrientation:"Orientacin de pgina",Format:"Formato",DPI:"DPI",Generate:"Generar",LanguageName:"Spanish"},jee={PageSize:"Kch thc trang",PageOrientation:"Loi trang",Format:"nh dng",DPI:"Mt  im nh (DPI)",Generate:"To",LanguageName:"Vietnam"},qee={PageSize:" ",PageOrientation:" ",Format:"",DPI:"DPI",Generate:"",LanguageName:"Ukranian"},Kee={PageSize:"",PageOrientation:"",Format:"",DPI:"",Generate:"",LanguageName:"Chinese simplified"},Wee={PageSize:"",PageOrientation:"",Format:"",DPI:"",Generate:"",LanguageName:"Chinese traditional"},$ee={PageSize:"",PageOrientation:"",Format:"",DPI:"DPI",Generate:"",LanguageName:"Japanese"},Xee=r=>{switch(r){case"de":return zee;case"en":return pF;case"fr":return Qee;case"fi":return Hee;case"sv":return Gee;case"es":return Vee;case"vi":return jee;case"uk":return qee;case"zhHans":return Kee;case"zhHant":return Wee;case"ja":return $ee;default:return pF}};(function(r){var e={};function t(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return r[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=r,t.c=e,t.d=function(n,i,s){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:s})},t.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,i){if(1&i&&(n=t(n)),8&i||4&i&&typeof n=="object"&&n&&n.__esModule)return n;var s=Object.create(null);if(t.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:n}),2&i&&typeof n!="string")for(var a in n)t.d(s,a,(function(o){return n[o]}).bind(null,a));return s},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)},t.p="",t(t.s=0)})([function(r,e,t){r.exports=t(1)},function(r,e){function t(i,s){for(var a=0;a<s.length;a++){var o=s[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(i,o.key,o)}}var n=function(){function i(){(function(o,A){if(!(o instanceof A))throw new TypeError("Cannot call a class as a function")})(this,i),this.options={overlayBackgroundColor:"#666666",overlayOpacity:.6,spinnerIcon:"ball-circus",spinnerColor:"#000",spinnerSize:"3x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetY:0,offsetX:0,lockScroll:!1,containerID:null,spinnerZIndex:99999,overlayZIndex:99998},this.stylesheetBaseURL="https://cdn.jsdelivr.net/npm/load-awesome@1.1.0/css/",this.spinner=null,this.spinnerStylesheetURL=null,this.numberOfEmptyDivForSpinner={"ball-8bits":16,"ball-atom":4,"ball-beat":3,"ball-circus":5,"ball-climbing-dot":1,"ball-clip-rotate":1,"ball-clip-rotate-multiple":2,"ball-clip-rotate-pulse":2,"ball-elastic-dots":5,"ball-fall":3,"ball-fussion":4,"ball-grid-beat":9,"ball-grid-pulse":9,"ball-newton-cradle":4,"ball-pulse":3,"ball-pulse-rise":5,"ball-pulse-sync":3,"ball-rotate":1,"ball-running-dots":5,"ball-scale":1,"ball-scale-multiple":3,"ball-scale-pulse":2,"ball-scale-ripple":1,"ball-scale-ripple-multiple":3,"ball-spin":8,"ball-spin-clockwise":8,"ball-spin-clockwise-fade":8,"ball-spin-clockwise-fade-rotating":8,"ball-spin-fade":8,"ball-spin-fade-rotating":8,"ball-spin-rotate":2,"ball-square-clockwise-spin":8,"ball-square-spin":8,"ball-triangle-path":3,"ball-zig-zag":2,"ball-zig-zag-deflect":2,cog:1,"cube-transition":2,fire:3,"line-scale":5,"line-scale-party":5,"line-scale-pulse-out":5,"line-scale-pulse-out-rapid":5,"line-spin-clockwise-fade":8,"line-spin-clockwise-fade-rotating":8,"line-spin-fade":8,"line-spin-fade-rotating":8,pacman:6,"square-jelly-box":2,"square-loader":1,"square-spin":1,timer:1,"triangle-skew-spin":1}}var s,a;return s=i,(a=[{key:"show",value:function(o){this.setOptions(o),this.addSpinnerStylesheet(),this.generateSpinnerElement(),this.options.lockScroll&&(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"),this.generateAndAddOverlayElement()}},{key:"hide",value:function(){this.options.lockScroll&&(document.body.style.overflow="",document.documentElement.style.overflow="");var o=document.getElementById("loading-overlay-stylesheet");o&&(o.disabled=!0,o.parentNode.removeChild(o),document.getElementById(this.options.overlayIDName).remove(),document.getElementById(this.options.spinnerIDName).remove())}},{key:"setOptions",value:function(o){if(o!==void 0)for(var A in o)this.options[A]=o[A]}},{key:"generateAndAddOverlayElement",value:function(){var o="50%";this.options.offsetX!==0&&(o="calc(50% + "+this.options.offsetX+")");var A="50%";if(this.options.offsetY!==0&&(A="calc(50% + "+this.options.offsetY+")"),this.options.containerID&&document.body.contains(document.getElementById(this.options.containerID))){var f='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: absolute; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,'; z-index: 50; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: absolute; top: ').concat(A,"; left: ").concat(o,'; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: 9999;">').concat(this.spinner,"</div>"),m=document.getElementById(this.options.containerID);return m.style.position="relative",void m.insertAdjacentHTML("beforeend",f)}var v='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: fixed; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,"; z-index: ").concat(this.options.overlayZIndex,'; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: fixed; top: ').concat(A,"; left: ").concat(o,"; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: ").concat(this.options.spinnerZIndex,';">').concat(this.spinner,"</div>");document.body.insertAdjacentHTML("beforeend",v)}},{key:"generateSpinnerElement",value:function(){var o=this,A=Object.keys(this.numberOfEmptyDivForSpinner).find(function(m){return m===o.options.spinnerIcon}),f=this.generateEmptyDivElement(this.numberOfEmptyDivForSpinner[A]);this.spinner='<div style="color: '.concat(this.options.spinnerColor,'" class="la-').concat(this.options.spinnerIcon," la-").concat(this.options.spinnerSize,'">').concat(f,"</div>")}},{key:"addSpinnerStylesheet",value:function(){this.setSpinnerStylesheetURL();var o=document.createElement("link");o.setAttribute("id","loading-overlay-stylesheet"),o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",this.spinnerStylesheetURL),document.getElementsByTagName("head")[0].appendChild(o)}},{key:"setSpinnerStylesheetURL",value:function(){this.spinnerStylesheetURL=this.stylesheetBaseURL+this.options.spinnerIcon+".min.css"}},{key:"generateEmptyDivElement",value:function(o){for(var A="",f=1;f<=o;f++)A+="<div></div>";return A}}])&&t(s.prototype,a),i}();window.JsLoadingOverlay=new n,r.exports=JsLoadingOverlay}]);function Dn(r){"@babel/helpers - typeof";return Dn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dn(r)}var Uo=Uint8Array,Ro=Uint16Array,Cg=Uint32Array,ay=new Uo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),cy=new Uo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),r2=new Uo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),gF=function(r,e){for(var t=new Ro(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];for(var i=new Cg(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)i[s]=s-t[n]<<5|n;return[t,i]},mF=gF(ay,2),yF=mF[0],n2=mF[1];yF[28]=258,n2[258]=28;for(var _F=gF(cy,0),Jee=_F[0],vF=_F[1],i2=new Ro(32768),bi=0;bi<32768;++bi){var RA=(bi&43690)>>>1|(bi&21845)<<1;RA=(RA&52428)>>>2|(RA&13107)<<2,RA=(RA&61680)>>>4|(RA&3855)<<4,i2[bi]=((RA&65280)>>>8|(RA&255)<<8)>>>1}for(var ql=function(r,e,t){for(var n=r.length,i=0,s=new Ro(e);i<n;++i)++s[r[i]-1];var a=new Ro(e);for(i=0;i<e;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(t){o=new Ro(1<<e);var A=15-e;for(i=0;i<n;++i)if(r[i])for(var f=i<<4|r[i],m=e-r[i],v=a[r[i]-1]++<<m,x=v|(1<<m)-1;v<=x;++v)o[i2[v]>>>A]=f}else for(o=new Ro(n),i=0;i<n;++i)o[i]=i2[a[r[i]-1]++]>>>15-r[i];return o},OA=new Uo(288),bi=0;bi<144;++bi)OA[bi]=8;for(var bi=144;bi<256;++bi)OA[bi]=9;for(var bi=256;bi<280;++bi)OA[bi]=7;for(var bi=280;bi<288;++bi)OA[bi]=8;for(var Eg=new Uo(32),bi=0;bi<32;++bi)Eg[bi]=5;var Yee=ql(OA,9,0),Zee=ql(OA,9,1),ete=ql(Eg,5,0),tte=ql(Eg,5,1),s2=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},qc=function(r,e,t){var n=e/8>>0;return(r[n]|r[n+1]<<8)>>>(e&7)&t},o2=function(r,e){var t=e/8>>0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>>(e&7)},a2=function(r){return(r/8>>0)+(r&7&&1)},bF=function(r,e,t){(e==null||e<0)&&(e=0),(t==null||t>r.length)&&(t=r.length);var n=new(r instanceof Ro?Ro:r instanceof Cg?Cg:Uo)(t-e);return n.set(r.subarray(e,t)),n},rte=function(r,e,t){var n=r.length,i=!e||t,s=!t||t.i;t||(t={}),e||(e=new Uo(n*3));var a=function($e){var qe=e.length;if($e>qe){var ct=new Uo(Math.max(qe*2,$e));ct.set(e),e=ct}},o=t.f||0,A=t.p||0,f=t.b||0,m=t.l,v=t.d,x=t.m,B=t.n,M=n*8;do{if(!m){t.f=o=qc(r,A,1);var U=qc(r,A+1,3);if(A+=3,U)if(U==1)m=Zee,v=tte,x=9,B=5;else if(U==2){var N=qc(r,A,31)+257,Q=qc(r,A+10,15)+4,q=N+qc(r,A+5,31)+1;A+=14;for(var Y=new Uo(q),te=new Uo(19),pe=0;pe<Q;++pe)te[r2[pe]]=qc(r,A+pe*3,7);A+=Q*3;var ge=s2(te),ye=(1<<ge)-1;if(!s&&A+q*(ge+7)>M)break;for(var fe=ql(te,ge,1),pe=0;pe<q;){var Oe=fe[qc(r,A,ye)];A+=Oe&15;var Fe=Oe>>>4;if(Fe<16)Y[pe++]=Fe;else{var oe=0,le=0;for(Fe==16?(le=3+qc(r,A,3),A+=2,oe=Y[pe-1]):Fe==17?(le=3+qc(r,A,7),A+=3):Fe==18&&(le=11+qc(r,A,127),A+=7);le--;)Y[pe++]=oe}}var xe=Y.subarray(0,N),_e=Y.subarray(N);x=s2(xe),B=s2(_e),m=ql(xe,x,1),v=ql(_e,B,1)}else throw"invalid block type";else{var Fe=a2(A)+4,tt=r[Fe-4]|r[Fe-3]<<8,et=Fe+tt;if(et>n){if(s)throw"unexpected EOF";break}i&&a(f+tt),e.set(r.subarray(Fe,et),f),t.b=f+=tt,t.p=A=et*8;continue}if(A>M)throw"unexpected EOF"}i&&a(f+131072);for(var nt=(1<<x)-1,Je=(1<<B)-1,it=x+B+18;s||A+it<M;){var oe=m[o2(r,A)&nt],ot=oe>>>4;if(A+=oe&15,A>M)throw"unexpected EOF";if(!oe)throw"invalid length/literal";if(ot<256)e[f++]=ot;else if(ot==256){m=null;break}else{var xt=ot-254;if(ot>264){var pe=ot-257,se=ay[pe];xt=qc(r,A,(1<<se)-1)+yF[pe],A+=se}var be=v[o2(r,A)&Je],Me=be>>>4;if(!be)throw"invalid distance";A+=be&15;var _e=Jee[Me];if(Me>3){var se=cy[Me];_e+=o2(r,A)&(1<<se)-1,A+=se}if(A>M)throw"unexpected EOF";i&&a(f+131072);for(var De=f+xt;f<De;f+=4)e[f]=e[f-_e],e[f+1]=e[f+1-_e],e[f+2]=e[f+2-_e],e[f+3]=e[f+3-_e];f=De}}t.l=m,t.p=A,t.b=f,m&&(o=1,t.m=x,t.d=v,t.n=B)}while(!o);return f==e.length?e:bF(e,0,f)},Ou=function(r,e,t){t<<=e&7;var n=e/8>>0;r[n]|=t,r[n+1]|=t>>>8},Sg=function(r,e,t){t<<=e&7;var n=e/8>>0;r[n]|=t,r[n+1]|=t>>>8,r[n+2]|=t>>>16},c2=function(r,e){for(var t=[],n=0;n<r.length;++n)r[n]&&t.push({s:n,f:r[n]});var i=t.length,s=t.slice();if(!i)return[new Uo(0),0];if(i==1){var a=new Uo(t[0].s+1);return a[t[0].s]=1,[a,1]}t.sort(function(pe,ge){return pe.f-ge.f}),t.push({s:-1,f:25001});var o=t[0],A=t[1],f=0,m=1,v=2;for(t[0]={s:-1,f:o.f+A.f,l:o,r:A};m!=i-1;)o=t[t[f].f<t[v].f?f++:v++],A=t[f!=m&&t[f].f<t[v].f?f++:v++],t[m++]={s:-1,f:o.f+A.f,l:o,r:A};for(var x=s[0].s,n=1;n<i;++n)s[n].s>x&&(x=s[n].s);var B=new Ro(x+1),M=l2(t[m-1],B,0);if(M>e){var n=0,U=0,N=M-e,Q=1<<N;for(s.sort(function(ge,ye){return B[ye.s]-B[ge.s]||ge.f-ye.f});n<i;++n){var q=s[n].s;if(B[q]>e)U+=Q-(1<<M-B[q]),B[q]=e;else break}for(U>>>=N;U>0;){var Y=s[n].s;B[Y]<e?U-=1<<e-B[Y]++-1:++n}for(;n>=0&&U;--n){var te=s[n].s;B[te]==e&&(--B[te],++U)}M=e}return[new Uo(B),M]},l2=function(r,e,t){return r.s==-1?Math.max(l2(r.l,e,t+1),l2(r.r,e,t+1)):e[r.s]=t},wF=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new Ro(++e),n=0,i=r[0],s=1,a=function(A){t[n++]=A},o=1;o<=e;++o)if(r[o]==i&&o!=e)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=r[o]}return[t.subarray(0,n),e]},Tg=function(r,e){for(var t=0,n=0;n<e.length;++n)t+=r[n]*e[n];return t},ly=function(r,e,t){var n=t.length,i=a2(e+2);r[i]=n&255,r[i+1]=n>>>8,r[i+2]=r[i]^255,r[i+3]=r[i+1]^255;for(var s=0;s<n;++s)r[i+s+4]=t[s];return(i+4+n)*8},xF=function(r,e,t,n,i,s,a,o,A,f,m){Ou(e,m++,t),++i[256];for(var v=c2(i,15),x=v[0],B=v[1],M=c2(s,15),U=M[0],N=M[1],Q=wF(x),q=Q[0],Y=Q[1],te=wF(U),pe=te[0],ge=te[1],ye=new Ro(19),fe=0;fe<q.length;++fe)ye[q[fe]&31]++;for(var fe=0;fe<pe.length;++fe)ye[pe[fe]&31]++;for(var Oe=c2(ye,7),Fe=Oe[0],oe=Oe[1],le=19;le>4&&!Fe[r2[le-1]];--le);var xe=f+5<<3,_e=Tg(i,OA)+Tg(s,Eg)+a,tt=Tg(i,x)+Tg(s,U)+a+14+3*le+Tg(ye,Fe)+(2*ye[16]+3*ye[17]+7*ye[18]);if(xe<=_e&&xe<=tt)return ly(e,m,r.subarray(A,A+f));var et,nt,Je,it;if(Ou(e,m,1+(tt<_e)),m+=2,tt<_e){et=ql(x,B,0),nt=x,Je=ql(U,N,0),it=U;var ot=ql(Fe,oe,0);Ou(e,m,Y-257),Ou(e,m+5,ge-1),Ou(e,m+10,le-4),m+=14;for(var fe=0;fe<le;++fe)Ou(e,m+3*fe,Fe[r2[fe]]);m+=3*le;for(var xt=[q,pe],se=0;se<2;++se)for(var be=xt[se],fe=0;fe<be.length;++fe){var Me=be[fe]&31;Ou(e,m,ot[Me]),m+=Fe[Me],Me>15&&(Ou(e,m,be[fe]>>>5&127),m+=be[fe]>>>12)}}else et=Yee,nt=OA,Je=ete,it=Eg;for(var fe=0;fe<o;++fe)if(n[fe]>255){var Me=n[fe]>>>18&31;Sg(e,m,et[Me+257]),m+=nt[Me+257],Me>7&&(Ou(e,m,n[fe]>>>23&31),m+=ay[Me]);var De=n[fe]&31;Sg(e,m,Je[De]),m+=it[De],De>3&&(Sg(e,m,n[fe]>>>5&8191),m+=cy[De])}else Sg(e,m,et[n[fe]]),m+=nt[n[fe]];return Sg(e,m,et[256]),m+nt[256]},nte=new Cg([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ite=new Uo(0),ste=function(r,e,t,n,i,s){var a=r.length,o=new Uo(n+a+5*(1+Math.floor(a/7e3))+i),A=o.subarray(n,o.length-i),f=0;if(!e||a<8)for(var m=0;m<=a;m+=65535){var v=m+65535;v<a?f=ly(A,f,r.subarray(m,v)):(A[m]=s,f=ly(A,f,r.subarray(m,a)))}else{for(var x=nte[e-1],B=x>>>13,M=x&8191,U=(1<<t)-1,N=new Ro(32768),Q=new Ro(U+1),q=Math.ceil(t/3),Y=2*q,te=function(zt){return(r[zt]^r[zt+1]<<q^r[zt+2]<<Y)&U},pe=new Cg(25e3),ge=new Ro(288),ye=new Ro(32),fe=0,Oe=0,m=0,Fe=0,oe=0,le=0;m<a;++m){var xe=te(m),_e=m&32767,tt=Q[xe];if(N[_e]=tt,Q[xe]=_e,oe<=m){var et=a-m;if((fe>7e3||Fe>24576)&&et>423){f=xF(r,A,0,pe,ge,ye,Oe,Fe,le,m-le,f),Fe=fe=Oe=0,le=m;for(var nt=0;nt<286;++nt)ge[nt]=0;for(var nt=0;nt<30;++nt)ye[nt]=0}var Je=2,it=0,ot=M,xt=_e-tt&32767;if(et>2&&xe==te(m-xt))for(var se=Math.min(B,et)-1,be=Math.min(32767,m),Me=Math.min(258,et);xt<=be&&--ot&&_e!=tt;){if(r[m+Je]==r[m+Je-xt]){for(var De=0;De<Me&&r[m+De]==r[m+De-xt];++De);if(De>Je){if(Je=De,it=xt,De>se)break;for(var $e=Math.min(xt,De-2),qe=0,nt=0;nt<$e;++nt){var ct=m-xt+nt+32768&32767,st=N[ct],Ct=ct-st+32768&32767;Ct>qe&&(qe=Ct,tt=ct)}}}_e=tt,tt=N[_e],xt+=_e-tt+32768&32767}if(it){pe[Fe++]=268435456|n2[Je]<<18|vF[it];var It=n2[Je]&31,Qt=vF[it]&31;Oe+=ay[It]+cy[Qt],++ge[257+It],++ye[Qt],oe=m+Je,++fe}else pe[Fe++]=r[m],++ge[r[m]]}}f=xF(r,A,s,pe,ge,ye,Oe,Fe,le,m-le,f),s||(f=ly(A,f,ite))}return bF(o,0,n+a2(f)+i)},ote=function(){var r=1,e=0;return{p:function(t){for(var n=r,i=e,s=t.length,a=0;a!=s;){for(var o=Math.min(a+5552,s);a<o;++a)n+=t[a],i+=n;n%=65521,i%=65521}r=n,e=i},d:function(){return(r>>>8<<16|(e&255)<<8|e>>>8)+((r&255)<<23)*2}}},ate=function(r,e,t,n,i){return ste(r,e.level==null?6:e.level,e.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):12+e.mem,t,n,!i)},cte=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8},lte=function(r,e){var t=e.level,n=t==0?0:t<6?1:t==9?3:2;r[0]=120,r[1]=n<<6|(n?32-2*n:1)},ute=function(r){if((r[0]&15)!=8||r[0]>>>4>7||(r[0]<<8|r[1])%31)throw"invalid zlib data";if(r[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function u2(r,e){e===void 0&&(e={});var t=ote();t.p(r);var n=ate(r,e,2,4);return lte(n,e),cte(n,n.length-4,t.d()),n}function Ate(r,e){return rte((ute(r),r.subarray(2,-4)),e)}/** @license
*
* jsPDF - PDF Document creation from JavaScript
* Version 2.5.1 Built on 2022-01-28T15:37:57.791Z
*                      CommitID 00000000
*
* Copyright (c) 2010-2021 James Hall <james@parall.ax>, https://github.com/MrRio/jsPDF
*               2015-2021 yWorks GmbH, http://www.yworks.com
*               2015-2021 Lukas Hollnder <lukas.hollaender@yworks.com>, https://github.com/HackbrettXXX
*               2016-2018 Aras Abbasi <aras.abbasi@gmail.com>
*               2010 Aaron Spike, https://github.com/acspike
*               2012 Willow Systems Corporation, https://github.com/willowsystems
*               2012 Pablo Hess, https://github.com/pablohess
*               2012 Florian Jenett, https://github.com/fjenett
*               2013 Warren Weckesser, https://github.com/warrenweckesser
*               2013 Youssef Beddad, https://github.com/lifof
*               2013 Lee Driscoll, https://github.com/lsdriscoll
*               2013 Stefan Slonevskiy, https://github.com/stefslon
*               2013 Jeremy Morel, https://github.com/jmorel
*               2013 Christoph Hartmann, https://github.com/chris-rock
*               2014 Juan Pablo Gaviria, https://github.com/juanpgaviria
*               2014 James Makes, https://github.com/dollaruw
*               2014 Diego Casorran, https://github.com/diegocr
*               2014 Steven Spungin, https://github.com/Flamenco
*               2014 Kenneth Glassey, https://github.com/Gavvers
*
* Permission is hereby granted, free of charge, to any person obtaining
* a copy of this software and associated documentation files (the
* "Software"), to deal in the Software without restriction, including
* without limitation the rights to use, copy, modify, merge, publish,
* distribute, sublicense, and/or sell copies of the Software, and to
* permit persons to whom the Software is furnished to do so, subject to
* the following conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
* LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
* OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
* WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*
* Contributor(s):
*    siefkenj, ahwolf, rickygu, Midnith, saintclair, eaparango,
*    kim3er, mfo, alnorth, Flamenco
*/var jr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function A2(){jr.console&&typeof jr.console.log=="function"&&jr.console.log.apply(jr.console,arguments)}var li={log:A2,warn:function(r){jr.console&&(typeof jr.console.warn=="function"?jr.console.warn.apply(jr.console,arguments):A2.call(null,arguments))},error:function(r){jr.console&&(typeof jr.console.error=="function"?jr.console.error.apply(jr.console,arguments):A2(r))}};function h2(r,e,t){var n=new XMLHttpRequest;n.open("GET",r),n.responseType="blob",n.onload=function(){zh(n.response,e,t)},n.onerror=function(){li.error("could not download file")},n.send()}function BF(r){var e=new XMLHttpRequest;e.open("HEAD",r,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function uy(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(e)}}var Ig,d2,zh=jr.saveAs||((typeof window>"u"?"undefined":Dn(window))!=="object"||window!==jr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,e,t){var n=jr.URL||jr.webkitURL,i=document.createElement("a");e=e||r.name||"download",i.download=e,i.rel="noopener",typeof r=="string"?(i.href=r,i.origin!==location.origin?BF(i.href)?h2(r,e,t):uy(i,i.target="_blank"):uy(i)):(i.href=n.createObjectURL(r),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){uy(i)},0))}:"msSaveOrOpenBlob"in navigator?function(r,e,t){if(e=e||r.name||"download",typeof r=="string")if(BF(r))h2(r,e,t);else{var n=document.createElement("a");n.href=r,n.target="_blank",setTimeout(function(){uy(n)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:Dn(s)!=="object"&&(li.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(r,t),e)}:function(r,e,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof r=="string")return h2(r,e,t);var i=r.type==="application/octet-stream",s=/constructor/i.test(jr.HTMLElement)||jr.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||i&&s)&&(typeof FileReader>"u"?"undefined":Dn(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var m=o.result;m=a?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=m:location=m,n=null},o.readAsDataURL(r)}else{var A=jr.URL||jr.webkitURL,f=A.createObjectURL(r);n?n.location=f:location.href=f,n=null,setTimeout(function(){A.revokeObjectURL(f)},4e4)}});/**
* A class to parse color values
* @author Stoyan Stefanov <sstoo@gmail.com>
* {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
* @license Use it if you like it
*/function CF(r){var e;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<t.length;n++){var i=t[n].re,s=t[n].process,a=i.exec(r);a&&(e=s(a),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),A=this.g.toString(16),f=this.b.toString(16);return o.length==1&&(o="0"+o),A.length==1&&(A="0"+A),f.length==1&&(f="0"+f),"#"+o+A+f}}/**
* @license
* Joseph Myers does not specify a particular license for his work.
*
* Author: Joseph Myers
* Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
*
* Modified by: Owen Leong
*/function f2(r,e){var t=r[0],n=r[1],i=r[2],s=r[3];t=Ao(t,n,i,s,e[0],7,-680876936),s=Ao(s,t,n,i,e[1],12,-389564586),i=Ao(i,s,t,n,e[2],17,606105819),n=Ao(n,i,s,t,e[3],22,-1044525330),t=Ao(t,n,i,s,e[4],7,-176418897),s=Ao(s,t,n,i,e[5],12,1200080426),i=Ao(i,s,t,n,e[6],17,-1473231341),n=Ao(n,i,s,t,e[7],22,-45705983),t=Ao(t,n,i,s,e[8],7,1770035416),s=Ao(s,t,n,i,e[9],12,-1958414417),i=Ao(i,s,t,n,e[10],17,-42063),n=Ao(n,i,s,t,e[11],22,-1990404162),t=Ao(t,n,i,s,e[12],7,1804603682),s=Ao(s,t,n,i,e[13],12,-40341101),i=Ao(i,s,t,n,e[14],17,-1502002290),t=ho(t,n=Ao(n,i,s,t,e[15],22,1236535329),i,s,e[1],5,-165796510),s=ho(s,t,n,i,e[6],9,-1069501632),i=ho(i,s,t,n,e[11],14,643717713),n=ho(n,i,s,t,e[0],20,-373897302),t=ho(t,n,i,s,e[5],5,-701558691),s=ho(s,t,n,i,e[10],9,38016083),i=ho(i,s,t,n,e[15],14,-660478335),n=ho(n,i,s,t,e[4],20,-405537848),t=ho(t,n,i,s,e[9],5,568446438),s=ho(s,t,n,i,e[14],9,-1019803690),i=ho(i,s,t,n,e[3],14,-187363961),n=ho(n,i,s,t,e[8],20,1163531501),t=ho(t,n,i,s,e[13],5,-1444681467),s=ho(s,t,n,i,e[2],9,-51403784),i=ho(i,s,t,n,e[7],14,1735328473),t=fo(t,n=ho(n,i,s,t,e[12],20,-1926607734),i,s,e[5],4,-378558),s=fo(s,t,n,i,e[8],11,-2022574463),i=fo(i,s,t,n,e[11],16,1839030562),n=fo(n,i,s,t,e[14],23,-35309556),t=fo(t,n,i,s,e[1],4,-1530992060),s=fo(s,t,n,i,e[4],11,1272893353),i=fo(i,s,t,n,e[7],16,-155497632),n=fo(n,i,s,t,e[10],23,-1094730640),t=fo(t,n,i,s,e[13],4,681279174),s=fo(s,t,n,i,e[0],11,-358537222),i=fo(i,s,t,n,e[3],16,-722521979),n=fo(n,i,s,t,e[6],23,76029189),t=fo(t,n,i,s,e[9],4,-640364487),s=fo(s,t,n,i,e[12],11,-421815835),i=fo(i,s,t,n,e[15],16,530742520),t=po(t,n=fo(n,i,s,t,e[2],23,-995338651),i,s,e[0],6,-198630844),s=po(s,t,n,i,e[7],10,1126891415),i=po(i,s,t,n,e[14],15,-1416354905),n=po(n,i,s,t,e[5],21,-57434055),t=po(t,n,i,s,e[12],6,1700485571),s=po(s,t,n,i,e[3],10,-1894986606),i=po(i,s,t,n,e[10],15,-1051523),n=po(n,i,s,t,e[1],21,-2054922799),t=po(t,n,i,s,e[8],6,1873313359),s=po(s,t,n,i,e[15],10,-30611744),i=po(i,s,t,n,e[6],15,-1560198380),n=po(n,i,s,t,e[13],21,1309151649),t=po(t,n,i,s,e[4],6,-145523070),s=po(s,t,n,i,e[11],10,-1120210379),i=po(i,s,t,n,e[2],15,718787259),n=po(n,i,s,t,e[9],21,-343485551),r[0]=DA(t,r[0]),r[1]=DA(n,r[1]),r[2]=DA(i,r[2]),r[3]=DA(s,r[3])}function Ay(r,e,t,n,i,s){return e=DA(DA(e,r),DA(n,s)),DA(e<<i|e>>>32-i,t)}function Ao(r,e,t,n,i,s,a){return Ay(e&t|~e&n,r,e,i,s,a)}function ho(r,e,t,n,i,s,a){return Ay(e&n|t&~n,r,e,i,s,a)}function fo(r,e,t,n,i,s,a){return Ay(e^t^n,r,e,i,s,a)}function po(r,e,t,n,i,s,a){return Ay(t^(e|~n),r,e,i,s,a)}function EF(r){var e,t=r.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=r.length;e+=64)f2(n,hte(r.substring(e-64,e)));r=r.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r.length;e++)i[e>>2]|=r.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(f2(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*t,f2(n,i),n}function hte(r){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=r.charCodeAt(e)+(r.charCodeAt(e+1)<<8)+(r.charCodeAt(e+2)<<16)+(r.charCodeAt(e+3)<<24);return t}Ig=jr.atob.bind(jr),d2=jr.btoa.bind(jr);var SF="0123456789abcdef".split("");function dte(r){for(var e="",t=0;t<4;t++)e+=SF[r>>8*t+4&15]+SF[r>>8*t&15];return e}function fte(r){return String.fromCharCode((255&r)>>0,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function p2(r){return EF(r).map(fte).join("")}var pte=function(r){for(var e=0;e<r.length;e++)r[e]=dte(r[e]);return r.join("")}(EF("hello"))!="5d41402abc4b2a76b9719d911017c592";function DA(r,e){if(pte){var t=(65535&r)+(65535&e);return(r>>16)+(e>>16)+(t>>16)<<16|65535&t}return r+e&4294967295}/**
* @license
* FPDF is released under a permissive license: there is no usage restriction.
* You may embed it freely in your application (commercial or not), with or
* without modifications.
*
* Reference: http://www.fpdf.org/en/script/script37.php
*/function g2(r,e){var t,n,i,s;if(r!==t){for(var a=(i=r,s=1+(256/r.length>>0),new Array(s+1).join(i)),o=[],A=0;A<256;A++)o[A]=A;var f=0;for(A=0;A<256;A++){var m=o[A];f=(f+m+a.charCodeAt(A))%256,o[A]=o[f],o[f]=m}t=r,n=o}else o=n;var v=e.length,x=0,B=0,M="";for(A=0;A<v;A++)B=(B+(m=o[x=(x+1)%256]))%256,o[x]=o[B],o[B]=m,a=o[(o[x]+o[B])%256],M+=String.fromCharCode(e.charCodeAt(A)^a);return M}/**
* @license
* Licensed under the MIT License.
* http://opensource.org/licenses/mit-license
* Author: Owen Leong (@owenl131)
* Date: 15 Oct 2020
* References:
* https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
* https://github.com/foliojs/pdfkit/blob/master/lib/security.js
* http://www.fpdf.org/en/script/script37.php
*/var TF={print:4,modify:8,copy:16,"annot-forms":32};function gf(r,e,t,n){this.v=1,this.r=2;var i=192;r.forEach(function(o){if(TF.perm!==void 0)throw new Error("Invalid permission: "+o);i+=TF[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),a=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,a),this.P=-(1+(255^i)),this.encryptionKey=p2(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=g2(this.encryptionKey,this.padding)}function mf(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var e="",t=r.length,n=0;n<t;n++){var i=r.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?e+="#"+("0"+i.toString(16)).slice(-2):e+=r[n]}return e}function IF(r){if(Dn(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,n,i){if(i=i||!1,typeof t!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var s=Math.random().toString(35);return e[t][s]=[n,!!i],s},this.unsubscribe=function(t){for(var n in e)if(e[n][t])return delete e[n][t],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var s in e[t]){var a=e[t][s];try{a[0].apply(r,n)}catch(o){jr.console&&li.error("jsPDF PubSub Error",o.message,o)}a[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function hy(r){if(!(this instanceof hy))return new hy(r);var e="opacity,stroke-opacity".split(",");for(var t in r)r.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=r[t]);this.id="",this.objectNumber=-1}function LF(r,e){this.gState=r,this.matrix=e,this.id="",this.objectNumber=-1}function Gh(r,e,t,n,i){if(!(this instanceof Gh))return new Gh(r,e,t,n,i);this.type=r==="axial"?2:3,this.coords=e,this.colors=t,LF.call(this,n,i)}function yf(r,e,t,n,i){if(!(this instanceof yf))return new yf(r,e,t,n,i);this.boundingBox=r,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,LF.call(this,n,i)}function qr(r){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],s=arguments[3],a=[],o=1,A=16,f="S",m=null;Dn(r=r||{})==="object"&&(t=r.orientation,n=r.unit||n,i=r.format||i,s=r.compress||r.compressPdf||s,(m=r.encryption||null)!==null&&(m.userPassword=m.userPassword||"",m.ownerPassword=m.ownerPassword||"",m.userPermissions=m.userPermissions||[]),o=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(e=r.precision),r.floatPrecision!==void 0&&(A=r.floatPrecision),f=r.defaultPathOperation||"S"),a=r.filters||(s===!0?["FlateEncode"]:a),n=n||"mm",t=(""+(t||"P")).toLowerCase();var v=r.putOnlyUsedFonts||!1,x={},B={internal:{},__private__:{}};B.__private__.PubSub=IF;var M="1.3",U=B.__private__.getPdfVersion=function(){return M};B.__private__.setPdfVersion=function(k){M=k};var N={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};B.__private__.getPageFormats=function(){return N};var Q=B.__private__.getPageFormat=function(k){return N[k]};i=i||"a4";var q={COMPAT:"compat",ADVANCED:"advanced"},Y=q.COMPAT;function te(){this.saveGraphicsState(),Re(new Te(Dt,0,0,-Dt,0,ya()*Dt).toString()+" cm"),this.setFontSize(this.getFontSize()/Dt),f="n",Y=q.ADVANCED}function pe(){this.restoreGraphicsState(),f="S",Y=q.COMPAT}var ge=B.__private__.combineFontStyleAndFontWeight=function(k,re){if(k=="bold"&&re=="normal"||k=="bold"&&re==400||k=="normal"&&re=="italic"||k=="bold"&&re=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return re&&(k=re==400||re==="normal"?k==="italic"?"italic":"normal":re!=700&&re!=="bold"||k!=="normal"?(re==700?"bold":re)+""+k:"bold"),k};B.advancedAPI=function(k){var re=Y===q.COMPAT;return re&&te.call(this),typeof k!="function"||(k(this),re&&pe.call(this)),this},B.compatAPI=function(k){var re=Y===q.ADVANCED;return re&&pe.call(this),typeof k!="function"||(k(this),re&&te.call(this)),this},B.isAdvancedAPI=function(){return Y===q.ADVANCED};var ye,fe=function(k){if(Y!==q.ADVANCED)throw new Error(k+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Oe=B.roundToPrecision=B.__private__.roundToPrecision=function(k,re){var Pe=e||re;if(isNaN(k)||isNaN(Pe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return k.toFixed(Pe).replace(/0+$/,"")};ye=B.hpf=B.__private__.hpf=typeof A=="number"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return Oe(k,A)}:A==="smart"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return Oe(k,k>-1&&k<1?16:5)}:function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return Oe(k,16)};var Fe=B.f2=B.__private__.f2=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f2");return Oe(k,2)},oe=B.__private__.f3=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f3");return Oe(k,3)},le=B.scale=B.__private__.scale=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.scale");return Y===q.COMPAT?k*Dt:Y===q.ADVANCED?k:void 0},xe=function(k){return Y===q.COMPAT?ya()-k:Y===q.ADVANCED?k:void 0},_e=function(k){return le(xe(k))};B.__private__.setPrecision=B.setPrecision=function(k){typeof parseInt(k,10)=="number"&&(e=parseInt(k,10))};var tt,et="00000000000000000000000000000000",nt=B.__private__.getFileId=function(){return et},Je=B.__private__.setFileId=function(k){return et=k!==void 0&&/^[a-fA-F0-9]{32}$/.test(k)?k.toUpperCase():et.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),m!==null&&(Nn=new gf(m.userPermissions,m.userPassword,m.ownerPassword,et)),et};B.setFileId=function(k){return Je(k),this},B.getFileId=function(){return nt()};var it=B.__private__.convertDateToPDFDate=function(k){var re=k.getTimezoneOffset(),Pe=re<0?"+":"-",je=Math.floor(Math.abs(re/60)),at=Math.abs(re%60),lt=[Pe,Me(je),"'",Me(at),"'"].join("");return["D:",k.getFullYear(),Me(k.getMonth()+1),Me(k.getDate()),Me(k.getHours()),Me(k.getMinutes()),Me(k.getSeconds()),lt].join("")},ot=B.__private__.convertPDFDateToDate=function(k){var re=parseInt(k.substr(2,4),10),Pe=parseInt(k.substr(6,2),10)-1,je=parseInt(k.substr(8,2),10),at=parseInt(k.substr(10,2),10),lt=parseInt(k.substr(12,2),10),Pt=parseInt(k.substr(14,2),10);return new Date(re,Pe,je,at,lt,Pt,0)},xt=B.__private__.setCreationDate=function(k){var re;if(k===void 0&&(k=new Date),k instanceof Date)re=it(k);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(k))throw new Error("Invalid argument passed to jsPDF.setCreationDate");re=k}return tt=re},se=B.__private__.getCreationDate=function(k){var re=tt;return k==="jsDate"&&(re=ot(tt)),re};B.setCreationDate=function(k){return xt(k),this},B.getCreationDate=function(k){return se(k)};var be,Me=B.__private__.padd2=function(k){return("0"+parseInt(k)).slice(-2)},De=B.__private__.padd2Hex=function(k){return("00"+(k=k.toString())).substr(k.length)},$e=0,qe=[],ct=[],st=0,Ct=[],It=[],Qt=!1,Ht=ct,zt=function(){$e=0,st=0,ct=[],qe=[],Ct=[],lr=Vt(),Ur=Vt()};B.__private__.setCustomOutputDestination=function(k){Qt=!0,Ht=k};var mt=function(k){Qt||(Ht=k)};B.__private__.resetCustomOutputDestination=function(){Qt=!1,Ht=ct};var Re=B.__private__.out=function(k){return k=k.toString(),st+=k.length+1,Ht.push(k),Ht},Ye=B.__private__.write=function(k){return Re(arguments.length===1?k.toString():Array.prototype.join.call(arguments," "))},tr=B.__private__.getArrayBuffer=function(k){for(var re=k.length,Pe=new ArrayBuffer(re),je=new Uint8Array(Pe);re--;)je[re]=k.charCodeAt(re);return Pe},St=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];B.__private__.getStandardFonts=function(){return St};var vt=r.fontSize||16;B.__private__.setFontSize=B.setFontSize=function(k){return vt=Y===q.ADVANCED?k/Dt:k,this};var Bt,kt=B.__private__.getFontSize=B.getFontSize=function(){return Y===q.COMPAT?vt:vt*Dt},ir=r.R2L||!1;B.__private__.setR2L=B.setR2L=function(k){return ir=k,this},B.__private__.getR2L=B.getR2L=function(){return ir};var Ar,Lr=B.__private__.setZoomMode=function(k){var re=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(k))Bt=k;else if(isNaN(k)){if(re.indexOf(k)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+k+'" is not recognized.');Bt=k}else Bt=parseInt(k,10)};B.__private__.getZoomMode=function(){return Bt};var Tr,kr=B.__private__.setPageMode=function(k){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(k)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+k+'" is not recognized.');Ar=k};B.__private__.getPageMode=function(){return Ar};var Qr=B.__private__.setLayoutMode=function(k){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(k)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+k+'" is not recognized.');Tr=k};B.__private__.getLayoutMode=function(){return Tr},B.__private__.setDisplayMode=B.setDisplayMode=function(k,re,Pe){return Lr(k),Qr(re),kr(Pe),this};var pt={title:"",subject:"",author:"",keywords:"",creator:""};B.__private__.getDocumentProperty=function(k){if(Object.keys(pt).indexOf(k)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return pt[k]},B.__private__.getDocumentProperties=function(){return pt},B.__private__.setDocumentProperties=B.setProperties=B.setDocumentProperties=function(k){for(var re in pt)pt.hasOwnProperty(re)&&k[re]&&(pt[re]=k[re]);return this},B.__private__.setDocumentProperty=function(k,re){if(Object.keys(pt).indexOf(k)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return pt[k]=re};var Ir,Dt,xn,Mr,Tt,Jt={},Kt={},Yr=[],Or={},gr={},an={},Wr={},Ee=null,ee=0,Z=[],ae=new IF(B),Se=r.hotfixes||[],Qe={},Ge={},Ke=[],Te=function k(re,Pe,je,at,lt,Pt){if(!(this instanceof k))return new k(re,Pe,je,at,lt,Pt);isNaN(re)&&(re=1),isNaN(Pe)&&(Pe=0),isNaN(je)&&(je=0),isNaN(at)&&(at=1),isNaN(lt)&&(lt=0),isNaN(Pt)&&(Pt=0),this._matrix=[re,Pe,je,at,lt,Pt]};Object.defineProperty(Te.prototype,"sx",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(Te.prototype,"shy",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(Te.prototype,"shx",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(Te.prototype,"sy",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(Te.prototype,"tx",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(Te.prototype,"ty",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(Te.prototype,"a",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(Te.prototype,"b",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(Te.prototype,"c",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(Te.prototype,"d",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(Te.prototype,"e",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(Te.prototype,"f",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(Te.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Te.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Te.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Te.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Te.prototype.join=function(k){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(ye).join(k)},Te.prototype.multiply=function(k){var re=k.sx*this.sx+k.shy*this.shx,Pe=k.sx*this.shy+k.shy*this.sy,je=k.shx*this.sx+k.sy*this.shx,at=k.shx*this.shy+k.sy*this.sy,lt=k.tx*this.sx+k.ty*this.shx+this.tx,Pt=k.tx*this.shy+k.ty*this.sy+this.ty;return new Te(re,Pe,je,at,lt,Pt)},Te.prototype.decompose=function(){var k=this.sx,re=this.shy,Pe=this.shx,je=this.sy,at=this.tx,lt=this.ty,Pt=Math.sqrt(k*k+re*re),cr=(k/=Pt)*Pe+(re/=Pt)*je;Pe-=k*cr,je-=re*cr;var Pr=Math.sqrt(Pe*Pe+je*je);return cr/=Pr,k*(je/=Pr)<re*(Pe/=Pr)&&(k=-k,re=-re,cr=-cr,Pt=-Pt),{scale:new Te(Pt,0,0,Pr,0,0),translate:new Te(1,0,0,1,at,lt),rotate:new Te(k,re,-re,k,0,0),skew:new Te(1,0,cr,1,0,0)}},Te.prototype.toString=function(k){return this.join(" ")},Te.prototype.inversed=function(){var k=this.sx,re=this.shy,Pe=this.shx,je=this.sy,at=this.tx,lt=this.ty,Pt=1/(k*je-re*Pe),cr=je*Pt,Pr=-re*Pt,Gr=-Pe*Pt,vr=k*Pt;return new Te(cr,Pr,Gr,vr,-cr*at-Gr*lt,-Pr*at-vr*lt)},Te.prototype.applyToPoint=function(k){var re=k.x*this.sx+k.y*this.shx+this.tx,Pe=k.x*this.shy+k.y*this.sy+this.ty;return new su(re,Pe)},Te.prototype.applyToRectangle=function(k){var re=this.applyToPoint(k),Pe=this.applyToPoint(new su(k.x+k.w,k.y+k.h));return new dl(re.x,re.y,Pe.x-re.x,Pe.y-re.y)},Te.prototype.clone=function(){var k=this.sx,re=this.shy,Pe=this.shx,je=this.sy,at=this.tx,lt=this.ty;return new Te(k,re,Pe,je,at,lt)},B.Matrix=Te;var Ze=B.matrixMult=function(k,re){return re.multiply(k)},yt=new Te(1,0,0,1,0,0);B.unitMatrix=B.identityMatrix=yt;var gt=function(k,re){if(!gr[k]){var Pe=(re instanceof Gh?"Sh":"P")+(Object.keys(Or).length+1).toString(10);re.id=Pe,gr[k]=Pe,Or[Pe]=re,ae.publish("addPattern",re)}};B.ShadingPattern=Gh,B.TilingPattern=yf,B.addShadingPattern=function(k,re){return fe("addShadingPattern()"),gt(k,re),this},B.beginTilingPattern=function(k){fe("beginTilingPattern()"),ou(k.boundingBox[0],k.boundingBox[1],k.boundingBox[2]-k.boundingBox[0],k.boundingBox[3]-k.boundingBox[1],k.matrix)},B.endTilingPattern=function(k,re){fe("endTilingPattern()"),re.stream=It[be].join(`
`),gt(k,re),ae.publish("endTilingPattern",re),Ke.pop().restore()};var ft=B.__private__.newObject=function(){var k=Vt();return Yt(k,!0),k},Vt=B.__private__.newObjectDeferred=function(){return $e++,qe[$e]=function(){return st},$e},Yt=function(k,re){return re=typeof re=="boolean"&&re,qe[k]=st,re&&Re(k+" 0 obj"),k},Er=B.__private__.newAdditionalObject=function(){var k={objId:Vt(),content:""};return Ct.push(k),k},lr=Vt(),Ur=Vt(),Nr=B.__private__.decodeColorString=function(k){var re=k.split(" ");if(re.length!==2||re[1]!=="g"&&re[1]!=="G")re.length===5&&(re[4]==="k"||re[4]==="K")&&(re=[(1-re[0])*(1-re[3]),(1-re[1])*(1-re[3]),(1-re[2])*(1-re[3]),"r"]);else{var Pe=parseFloat(re[0]);re=[Pe,Pe,Pe,"r"]}for(var je="#",at=0;at<3;at++)je+=("0"+Math.floor(255*parseFloat(re[at])).toString(16)).slice(-2);return je},Hr=B.__private__.encodeColorString=function(k){var re;typeof k=="string"&&(k={ch1:k});var Pe=k.ch1,je=k.ch2,at=k.ch3,lt=k.ch4,Pt=k.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Pe=="string"&&Pe.charAt(0)!=="#"){var cr=new CF(Pe);if(cr.ok)Pe=cr.toHex();else if(!/^\d*\.?\d*$/.test(Pe))throw new Error('Invalid color "'+Pe+'" passed to jsPDF.encodeColorString.')}if(typeof Pe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Pe)&&(Pe="#"+Pe[1]+Pe[1]+Pe[2]+Pe[2]+Pe[3]+Pe[3]),typeof Pe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Pe)){var Pr=parseInt(Pe.substr(1),16);Pe=Pr>>16&255,je=Pr>>8&255,at=255&Pr}if(je===void 0||lt===void 0&&Pe===je&&je===at)if(typeof Pe=="string")re=Pe+" "+Pt[0];else switch(k.precision){case 2:re=Fe(Pe/255)+" "+Pt[0];break;case 3:default:re=oe(Pe/255)+" "+Pt[0]}else if(lt===void 0||Dn(lt)==="object"){if(lt&&!isNaN(lt.a)&&lt.a===0)return re=["1.","1.","1.",Pt[1]].join(" ");if(typeof Pe=="string")re=[Pe,je,at,Pt[1]].join(" ");else switch(k.precision){case 2:re=[Fe(Pe/255),Fe(je/255),Fe(at/255),Pt[1]].join(" ");break;default:case 3:re=[oe(Pe/255),oe(je/255),oe(at/255),Pt[1]].join(" ")}}else if(typeof Pe=="string")re=[Pe,je,at,lt,Pt[2]].join(" ");else switch(k.precision){case 2:re=[Fe(Pe),Fe(je),Fe(at),Fe(lt),Pt[2]].join(" ");break;case 3:default:re=[oe(Pe),oe(je),oe(at),oe(lt),Pt[2]].join(" ")}return re},mn=B.__private__.getFilters=function(){return a},mr=B.__private__.putStream=function(k){var re=(k=k||{}).data||"",Pe=k.filters||mn(),je=k.alreadyAppliedFilters||[],at=k.addLength1||!1,lt=re.length,Pt=k.objectId,cr=function(Xr){return Xr};if(m!==null&&Pt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");m!==null&&(cr=Nn.encryptor(Pt,0));var Pr={};Pe===!0&&(Pe=["FlateEncode"]);var Gr=k.additionalKeyValues||[],vr=(Pr=qr.API.processDataByFilters!==void 0?qr.API.processDataByFilters(re,Pe):{data:re,reverseChain:[]}).reverseChain+(Array.isArray(je)?je.join(" "):je.toString());if(Pr.data.length!==0&&(Gr.push({key:"Length",value:Pr.data.length}),at===!0&&Gr.push({key:"Length1",value:lt})),vr.length!=0)if(vr.split("/").length-1==1)Gr.push({key:"Filter",value:vr});else{Gr.push({key:"Filter",value:"["+vr+"]"});for(var wn=0;wn<Gr.length;wn+=1)if(Gr[wn].key==="DecodeParms"){for(var br=[],Ai=0;Ai<Pr.reverseChain.split("/").length-1;Ai+=1)br.push("null");br.push(Gr[wn].value),Gr[wn].value="["+br.join(" ")+"]"}}Re("<<");for(var Kr=0;Kr<Gr.length;Kr++)Re("/"+Gr[Kr].key+" "+Gr[Kr].value);Re(">>"),Pr.data.length!==0&&(Re("stream"),Re(cr(Pr.data)),Re("endstream"))},$r=B.__private__.putPage=function(k){var re=k.number,Pe=k.data,je=k.objId,at=k.contentsObjId;Yt(je,!0),Re("<</Type /Page"),Re("/Parent "+k.rootDictionaryObjId+" 0 R"),Re("/Resources "+k.resourceDictionaryObjId+" 0 R"),Re("/MediaBox ["+parseFloat(ye(k.mediaBox.bottomLeftX))+" "+parseFloat(ye(k.mediaBox.bottomLeftY))+" "+ye(k.mediaBox.topRightX)+" "+ye(k.mediaBox.topRightY)+"]"),k.cropBox!==null&&Re("/CropBox ["+ye(k.cropBox.bottomLeftX)+" "+ye(k.cropBox.bottomLeftY)+" "+ye(k.cropBox.topRightX)+" "+ye(k.cropBox.topRightY)+"]"),k.bleedBox!==null&&Re("/BleedBox ["+ye(k.bleedBox.bottomLeftX)+" "+ye(k.bleedBox.bottomLeftY)+" "+ye(k.bleedBox.topRightX)+" "+ye(k.bleedBox.topRightY)+"]"),k.trimBox!==null&&Re("/TrimBox ["+ye(k.trimBox.bottomLeftX)+" "+ye(k.trimBox.bottomLeftY)+" "+ye(k.trimBox.topRightX)+" "+ye(k.trimBox.topRightY)+"]"),k.artBox!==null&&Re("/ArtBox ["+ye(k.artBox.bottomLeftX)+" "+ye(k.artBox.bottomLeftY)+" "+ye(k.artBox.topRightX)+" "+ye(k.artBox.topRightY)+"]"),typeof k.userUnit=="number"&&k.userUnit!==1&&Re("/UserUnit "+k.userUnit),ae.publish("putPage",{objId:je,pageContext:Z[re],pageNumber:re,page:Pe}),Re("/Contents "+at+" 0 R"),Re(">>"),Re("endobj");var lt=Pe.join(`
`);return Y===q.ADVANCED&&(lt+=`
Q`),Yt(at,!0),mr({data:lt,filters:mn(),objectId:at}),Re("endobj"),je},bn=B.__private__.putPages=function(){var k,re,Pe=[];for(k=1;k<=ee;k++)Z[k].objId=Vt(),Z[k].contentsObjId=Vt();for(k=1;k<=ee;k++)Pe.push($r({number:k,data:It[k],objId:Z[k].objId,contentsObjId:Z[k].contentsObjId,mediaBox:Z[k].mediaBox,cropBox:Z[k].cropBox,bleedBox:Z[k].bleedBox,trimBox:Z[k].trimBox,artBox:Z[k].artBox,userUnit:Z[k].userUnit,rootDictionaryObjId:lr,resourceDictionaryObjId:Ur}));Yt(lr,!0),Re("<</Type /Pages");var je="/Kids [";for(re=0;re<ee;re++)je+=Pe[re]+" 0 R ";Re(je+"]"),Re("/Count "+ee),Re(">>"),Re("endobj"),ae.publish("postPutPages")},kn=function(k){ae.publish("putFont",{font:k,out:Re,newObject:ft,putStream:mr}),k.isAlreadyPutted!==!0&&(k.objectNumber=ft(),Re("<<"),Re("/Type /Font"),Re("/BaseFont /"+mf(k.postScriptName)),Re("/Subtype /Type1"),typeof k.encoding=="string"&&Re("/Encoding /"+k.encoding),Re("/FirstChar 32"),Re("/LastChar 255"),Re(">>"),Re("endobj"))},ke=function(){for(var k in Jt)Jt.hasOwnProperty(k)&&(v===!1||v===!0&&x.hasOwnProperty(k))&&kn(Jt[k])},Rt=function(k){k.objectNumber=ft();var re=[];re.push({key:"Type",value:"/XObject"}),re.push({key:"Subtype",value:"/Form"}),re.push({key:"BBox",value:"["+[ye(k.x),ye(k.y),ye(k.x+k.width),ye(k.y+k.height)].join(" ")+"]"}),re.push({key:"Matrix",value:"["+k.matrix.toString()+"]"});var Pe=k.pages[1].join(`
`);mr({data:Pe,additionalKeyValues:re,objectId:k.objectNumber}),Re("endobj")},Lt=function(){for(var k in Qe)Qe.hasOwnProperty(k)&&Rt(Qe[k])},nn=function(k,re){var Pe,je=[],at=1/(re-1);for(Pe=0;Pe<1;Pe+=at)je.push(Pe);if(je.push(1),k[0].offset!=0){var lt={offset:0,color:k[0].color};k.unshift(lt)}if(k[k.length-1].offset!=1){var Pt={offset:1,color:k[k.length-1].color};k.push(Pt)}for(var cr="",Pr=0,Gr=0;Gr<je.length;Gr++){for(Pe=je[Gr];Pe>k[Pr+1].offset;)Pr++;var vr=k[Pr].offset,wn=(Pe-vr)/(k[Pr+1].offset-vr),br=k[Pr].color,Ai=k[Pr+1].color;cr+=De(Math.round((1-wn)*br[0]+wn*Ai[0]).toString(16))+De(Math.round((1-wn)*br[1]+wn*Ai[1]).toString(16))+De(Math.round((1-wn)*br[2]+wn*Ai[2]).toString(16))}return cr.trim()},Pn=function(k,re){re||(re=21);var Pe=ft(),je=nn(k.colors,re),at=[];at.push({key:"FunctionType",value:"0"}),at.push({key:"Domain",value:"[0.0 1.0]"}),at.push({key:"Size",value:"["+re+"]"}),at.push({key:"BitsPerSample",value:"8"}),at.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),at.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),mr({data:je,additionalKeyValues:at,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Pe}),Re("endobj"),k.objectNumber=ft(),Re("<< /ShadingType "+k.type),Re("/ColorSpace /DeviceRGB");var lt="/Coords ["+ye(parseFloat(k.coords[0]))+" "+ye(parseFloat(k.coords[1]))+" ";k.type===2?lt+=ye(parseFloat(k.coords[2]))+" "+ye(parseFloat(k.coords[3])):lt+=ye(parseFloat(k.coords[2]))+" "+ye(parseFloat(k.coords[3]))+" "+ye(parseFloat(k.coords[4]))+" "+ye(parseFloat(k.coords[5])),Re(lt+="]"),k.matrix&&Re("/Matrix ["+k.matrix.toString()+"]"),Re("/Function "+Pe+" 0 R"),Re("/Extend [true true]"),Re(">>"),Re("endobj")},Br=function(k,re){var Pe=Vt(),je=ft();re.push({resourcesOid:Pe,objectOid:je}),k.objectNumber=je;var at=[];at.push({key:"Type",value:"/Pattern"}),at.push({key:"PatternType",value:"1"}),at.push({key:"PaintType",value:"1"}),at.push({key:"TilingType",value:"1"}),at.push({key:"BBox",value:"["+k.boundingBox.map(ye).join(" ")+"]"}),at.push({key:"XStep",value:ye(k.xStep)}),at.push({key:"YStep",value:ye(k.yStep)}),at.push({key:"Resources",value:Pe+" 0 R"}),k.matrix&&at.push({key:"Matrix",value:"["+k.matrix.toString()+"]"}),mr({data:k.stream,additionalKeyValues:at,objectId:k.objectNumber}),Re("endobj")},yn=function(k){var re;for(re in Or)Or.hasOwnProperty(re)&&(Or[re]instanceof Gh?Pn(Or[re]):Or[re]instanceof yf&&Br(Or[re],k))},wi=function(k){for(var re in k.objectNumber=ft(),Re("<<"),k)switch(re){case"opacity":Re("/ca "+Fe(k[re]));break;case"stroke-opacity":Re("/CA "+Fe(k[re]))}Re(">>"),Re("endobj")},_n=function(){var k;for(k in an)an.hasOwnProperty(k)&&wi(an[k])},sn=function(){for(var k in Re("/XObject <<"),Qe)Qe.hasOwnProperty(k)&&Qe[k].objectNumber>=0&&Re("/"+k+" "+Qe[k].objectNumber+" 0 R");ae.publish("putXobjectDict"),Re(">>")},xi=function(){Nn.oid=ft(),Re("<<"),Re("/Filter /Standard"),Re("/V "+Nn.v),Re("/R "+Nn.r),Re("/U <"+Nn.toHexString(Nn.U)+">"),Re("/O <"+Nn.toHexString(Nn.O)+">"),Re("/P "+Nn.P),Re(">>"),Re("endobj")},Jn=function(){for(var k in Re("/Font <<"),Jt)Jt.hasOwnProperty(k)&&(v===!1||v===!0&&x.hasOwnProperty(k))&&Re("/"+k+" "+Jt[k].objectNumber+" 0 R");Re(">>")},as=function(){if(Object.keys(Or).length>0){for(var k in Re("/Shading <<"),Or)Or.hasOwnProperty(k)&&Or[k]instanceof Gh&&Or[k].objectNumber>=0&&Re("/"+k+" "+Or[k].objectNumber+" 0 R");ae.publish("putShadingPatternDict"),Re(">>")}},Os=function(k){if(Object.keys(Or).length>0){for(var re in Re("/Pattern <<"),Or)Or.hasOwnProperty(re)&&Or[re]instanceof B.TilingPattern&&Or[re].objectNumber>=0&&Or[re].objectNumber<k&&Re("/"+re+" "+Or[re].objectNumber+" 0 R");ae.publish("putTilingPatternDict"),Re(">>")}},zo=function(){if(Object.keys(an).length>0){var k;for(k in Re("/ExtGState <<"),an)an.hasOwnProperty(k)&&an[k].objectNumber>=0&&Re("/"+k+" "+an[k].objectNumber+" 0 R");ae.publish("putGStateDict"),Re(">>")}},Dr=function(k){Yt(k.resourcesOid,!0),Re("<<"),Re("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Jn(),as(),Os(k.objectOid),zo(),sn(),Re(">>"),Re("endobj")},Js=function(){var k=[];ke(),_n(),Lt(),yn(k),ae.publish("putResources"),k.forEach(Dr),Dr({resourcesOid:Ur,objectOid:Number.MAX_SAFE_INTEGER}),ae.publish("postPutResources")},Cs=function(){ae.publish("putAdditionalObjects");for(var k=0;k<Ct.length;k++){var re=Ct[k];Yt(re.objId,!0),Re(re.content),Re("endobj")}ae.publish("postPutAdditionalObjects")},In=function(k){Kt[k.fontName]=Kt[k.fontName]||{},Kt[k.fontName][k.fontStyle]=k.id},vo=function(k,re,Pe,je,at){var lt={id:"F"+(Object.keys(Jt).length+1).toString(10),postScriptName:k,fontName:re,fontStyle:Pe,encoding:je,isStandardFont:at||!1,metadata:{}};return ae.publish("addFont",{font:lt,instance:this}),Jt[lt.id]=lt,In(lt),lt.id},Pi=function(k){for(var re=0,Pe=St.length;re<Pe;re++){var je=vo.call(this,k[re][0],k[re][1],k[re][2],St[re][3],!0);v===!1&&(x[je]=!0);var at=k[re][0].split("-");In({id:je,fontName:at[0],fontStyle:at[1]||""})}ae.publish("addFonts",{fonts:Jt,dictionary:Kt})},Ui=function(k){return k.foo=function(){try{return k.apply(this,arguments)}catch(je){var re=je.stack||"";~re.indexOf(" at ")&&(re=re.split(" at ")[1]);var Pe="Error in function "+re.split(`
`)[0].split("<")[0]+": "+je.message;if(!jr.console)throw new Error(Pe);jr.console.error(Pe,je),jr.alert&&alert(Pe)}},k.foo.bar=k,k.foo},Yn=function(k,re){var Pe,je,at,lt,Pt,cr,Pr,Gr,vr;if(at=(re=re||{}).sourceEncoding||"Unicode",Pt=re.outputEncoding,(re.autoencode||Pt)&&Jt[Ir].metadata&&Jt[Ir].metadata[at]&&Jt[Ir].metadata[at].encoding&&(lt=Jt[Ir].metadata[at].encoding,!Pt&&Jt[Ir].encoding&&(Pt=Jt[Ir].encoding),!Pt&&lt.codePages&&(Pt=lt.codePages[0]),typeof Pt=="string"&&(Pt=lt[Pt]),Pt)){for(Pr=!1,cr=[],Pe=0,je=k.length;Pe<je;Pe++)(Gr=Pt[k.charCodeAt(Pe)])?cr.push(String.fromCharCode(Gr)):cr.push(k[Pe]),cr[Pe].charCodeAt(0)>>8&&(Pr=!0);k=cr.join("")}for(Pe=k.length;Pr===void 0&&Pe!==0;)k.charCodeAt(Pe-1)>>8&&(Pr=!0),Pe--;if(!Pr)return k;for(cr=re.noBOM?[]:[254,255],Pe=0,je=k.length;Pe<je;Pe++){if((vr=(Gr=k.charCodeAt(Pe))>>8)>>8)throw new Error("Character at position "+Pe+" of string '"+k+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");cr.push(vr),cr.push(Gr-(vr<<8))}return String.fromCharCode.apply(void 0,cr)},Li=B.__private__.pdfEscape=B.pdfEscape=function(k,re){return Yn(k,re).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},cn=B.__private__.beginPage=function(k){It[++ee]=[],Z[ee]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(k[0]),topRightY:Number(k[1])}},Ys(ee),mt(It[be])},Go=function(k,re){var Pe,je,at;switch(t=re||t,typeof k=="string"&&(Pe=Q(k.toLowerCase()),Array.isArray(Pe)&&(je=Pe[0],at=Pe[1])),Array.isArray(k)&&(je=k[0]*Dt,at=k[1]*Dt),isNaN(je)&&(je=i[0],at=i[1]),(je>14400||at>14400)&&(li.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),je=Math.min(14400,je),at=Math.min(14400,at)),i=[je,at],t.substr(0,1)){case"l":at>je&&(i=[at,je]);break;case"p":je>at&&(i=[at,je])}cn(i),ln(Ri),Re(Ds),Ju!==0&&Re(Ju+" J"),Yu!==0&&Re(Yu+" j"),ae.publish("addPage",{pageNumber:ee})},Vo=function(k){k>0&&k<=ee&&(It.splice(k,1),Z.splice(k,1),ee--,be>ee&&(be=ee),this.setPage(be))},Ys=function(k){k>0&&k<=ee&&(be=k)},fc=B.__private__.getNumberOfPages=B.getNumberOfPages=function(){return It.length-1},he=function(k,re,Pe){var je,at=void 0;return Pe=Pe||{},k=k!==void 0?k:Jt[Ir].fontName,re=re!==void 0?re:Jt[Ir].fontStyle,je=k.toLowerCase(),Kt[je]!==void 0&&Kt[je][re]!==void 0?at=Kt[je][re]:Kt[k]!==void 0&&Kt[k][re]!==void 0?at=Kt[k][re]:Pe.disableWarning===!1&&li.warn("Unable to look up font label for font '"+k+"', '"+re+"'. Refer to getFontList() for available fonts."),at||Pe.noFallback||(at=Kt.times[re])==null&&(at=Kt.times.normal),at},Be=B.__private__.putInfo=function(){var k=ft(),re=function(je){return je};for(var Pe in m!==null&&(re=Nn.encryptor(k,0)),Re("<<"),Re("/Producer ("+Li(re("jsPDF "+qr.version))+")"),pt)pt.hasOwnProperty(Pe)&&pt[Pe]&&Re("/"+Pe.substr(0,1).toUpperCase()+Pe.substr(1)+" ("+Li(re(pt[Pe]))+")");Re("/CreationDate ("+Li(re(tt))+")"),Re(">>"),Re("endobj")},He=B.__private__.putCatalog=function(k){var re=(k=k||{}).rootDictionaryObjId||lr;switch(ft(),Re("<<"),Re("/Type /Catalog"),Re("/Pages "+re+" 0 R"),Bt||(Bt="fullwidth"),Bt){case"fullwidth":Re("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Re("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Re("/OpenAction [3 0 R /Fit]");break;case"original":Re("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Pe=""+Bt;Pe.substr(Pe.length-1)==="%"&&(Bt=parseInt(Bt)/100),typeof Bt=="number"&&Re("/OpenAction [3 0 R /XYZ null null "+Fe(Bt)+"]")}switch(Tr||(Tr="continuous"),Tr){case"continuous":Re("/PageLayout /OneColumn");break;case"single":Re("/PageLayout /SinglePage");break;case"two":case"twoleft":Re("/PageLayout /TwoColumnLeft");break;case"tworight":Re("/PageLayout /TwoColumnRight")}Ar&&Re("/PageMode /"+Ar),ae.publish("putCatalog"),Re(">>"),Re("endobj")},dt=B.__private__.putTrailer=function(){Re("trailer"),Re("<<"),Re("/Size "+($e+1)),Re("/Root "+$e+" 0 R"),Re("/Info "+($e-1)+" 0 R"),m!==null&&Re("/Encrypt "+Nn.oid+" 0 R"),Re("/ID [ <"+et+"> <"+et+"> ]"),Re(">>")},Mt=B.__private__.putHeader=function(){Re("%PDF-"+M),Re("%")},sr=B.__private__.putXRef=function(){var k="0000000000";Re("xref"),Re("0 "+($e+1)),Re("0000000000 65535 f ");for(var re=1;re<=$e;re++)typeof qe[re]=="function"?Re((k+qe[re]()).slice(-10)+" 00000 n "):qe[re]!==void 0?Re((k+qe[re]).slice(-10)+" 00000 n "):Re("0000000000 00000 n ")},zr=B.__private__.buildDocument=function(){zt(),mt(ct),ae.publish("buildDocument"),Mt(),bn(),Cs(),Js(),m!==null&&xi(),Be(),He();var k=st;return sr(),dt(),Re("startxref"),Re(""+k),Re("%%EOF"),mt(It[be]),ct.join(`
`)},Wn=B.__private__.getBlob=function(k){return new Blob([tr(k)],{type:"application/pdf"})},Zn=B.output=B.__private__.output=Ui(function(k,re){switch(typeof(re=re||{})=="string"?re={filename:re}:re.filename=re.filename||"generated.pdf",k){case void 0:return zr();case"save":B.save(re.filename);break;case"arraybuffer":return tr(zr());case"blob":return Wn(zr());case"bloburi":case"bloburl":if(jr.URL!==void 0&&typeof jr.URL.createObjectURL=="function")return jr.URL&&jr.URL.createObjectURL(Wn(zr()))||void 0;li.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Pe="",je=zr();try{Pe=d2(je)}catch{Pe=d2(unescape(encodeURIComponent(je)))}return"data:application/pdf;filename="+re.filename+";base64,"+Pe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(jr)==="[object Window]"){var at="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",lt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';re.pdfObjectUrl&&(at=re.pdfObjectUrl,lt="");var Pt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+at+'"'+lt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(re)+");<\/script></body></html>",cr=jr.open();return cr!==null&&cr.document.write(Pt),cr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(jr)==="[object Window]"){var Pr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(re.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+re.filename+'" width="500px" height="400px" /></body></html>',Gr=jr.open();if(Gr!==null){Gr.document.write(Pr);var vr=this;Gr.document.documentElement.querySelector("#pdfViewer").onload=function(){Gr.document.title=re.filename,Gr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(vr.output("bloburl"))}}return Gr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(jr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var wn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",re)+'"></iframe></body></html>',br=jr.open();if(br!==null&&(br.document.write(wn),br.document.title=re.filename),br||typeof safari>"u")return br;break;case"datauri":case"dataurl":return jr.document.location.href=this.output("datauristring",re);default:return null}}),ui=function(k){return Array.isArray(Se)===!0&&Se.indexOf(k)>-1};switch(n){case"pt":Dt=1;break;case"mm":Dt=72/25.4;break;case"cm":Dt=72/2.54;break;case"in":Dt=72;break;case"px":Dt=ui("px_scaling")==1?.75:96/72;break;case"pc":case"em":Dt=12;break;case"ex":Dt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Dt=n}var Nn=null;xt(),Je();var eh=function(k){return m!==null?Nn.encryptor(k,0):function(re){return re}},al=B.__private__.getPageInfo=B.getPageInfo=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Z[k].objId,pageNumber:k,pageContext:Z[k]}},Vr=B.__private__.getPageInfoByObjId=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var re in Z)if(Z[re].objId===k)break;return al(re)},Qa=B.__private__.getCurrentPageInfo=B.getCurrentPageInfo=function(){return{objId:Z[be].objId,pageNumber:be,pageContext:Z[be]}};B.addPage=function(){return Go.apply(this,arguments),this},B.setPage=function(){return Ys.apply(this,arguments),mt.call(this,It[be]),this},B.insertPage=function(k){return this.addPage(),this.movePage(be,k),this},B.movePage=function(k,re){var Pe,je;if(k>re){Pe=It[k],je=Z[k];for(var at=k;at>re;at--)It[at]=It[at-1],Z[at]=Z[at-1];It[re]=Pe,Z[re]=je,this.setPage(re)}else if(k<re){Pe=It[k],je=Z[k];for(var lt=k;lt<re;lt++)It[lt]=It[lt+1],Z[lt]=Z[lt+1];It[re]=Pe,Z[re]=je,this.setPage(re)}return this},B.deletePage=function(){return Vo.apply(this,arguments),this},B.__private__.text=B.text=function(k,re,Pe,je,at){var lt,Pt,cr,Pr,Gr,vr,wn,br,Ai,Kr=(je=je||{}).scope||this;if(typeof k=="number"&&typeof re=="number"&&(typeof Pe=="string"||Array.isArray(Pe))){var Xr=Pe;Pe=re,re=k,k=Xr}if(arguments[3]instanceof Te?(fe("The transform parameter of text() with a Matrix value"),Ai=at):(cr=arguments[4],Pr=arguments[5],Dn(wn=arguments[3])==="object"&&wn!==null||(typeof cr=="string"&&(Pr=cr,cr=null),typeof wn=="string"&&(Pr=wn,wn=null),typeof wn=="number"&&(cr=wn,wn=null),je={flags:wn,angle:cr,align:Pr})),isNaN(re)||isNaN(Pe)||k==null)throw new Error("Invalid arguments passed to jsPDF.text");if(k.length===0)return Kr;var si="",ks=!1,Ns=typeof je.lineHeightFactor=="number"?je.lineHeightFactor:ga,_a=Kr.internal.scaleFactor;function fl(vn){return vn=vn.split("	").join(Array(je.TabLen||9).join(" ")),Li(vn,wn)}function wc(vn){for(var Ln,Fn=vn.concat(),ei=[],qa=Fn.length;qa--;)typeof(Ln=Fn.shift())=="string"?ei.push(Ln):Array.isArray(vn)&&(Ln.length===1||Ln[1]===void 0&&Ln[2]===void 0)?ei.push(Ln[0]):ei.push([Ln[0],Ln[1],Ln[2]]);return ei}function xc(vn,Ln){var Fn;if(typeof vn=="string")Fn=Ln(vn)[0];else if(Array.isArray(vn)){for(var ei,qa,xa=vn.concat(),Au=[],Ka=xa.length;Ka--;)typeof(ei=xa.shift())=="string"?Au.push(Ln(ei)[0]):Array.isArray(ei)&&typeof ei[0]=="string"&&(qa=Ln(ei[0],ei[1],ei[2]),Au.push([qa[0],qa[1],qa[2]]));Fn=Au}return Fn}var pl=!1,Bc=!0;if(typeof k=="string")pl=!0;else if(Array.isArray(k)){var cu=k.concat();Pt=[];for(var Ga,cs=cu.length;cs--;)(typeof(Ga=cu.shift())!="string"||Array.isArray(Ga)&&typeof Ga[0]!="string")&&(Bc=!1);pl=Bc}if(pl===!1)throw new Error('Type of text must be string or Array. "'+k+'" is not recognized.');typeof k=="string"&&(k=k.match(/[\r?\n]/)?k.split(/\r\n|\r|\n/g):[k]);var Cc=vt/Kr.internal.scaleFactor,gl=Cc*(Ns-1);switch(je.baseline){case"bottom":Pe-=gl;break;case"top":Pe+=Cc-gl;break;case"hanging":Pe+=Cc-2*gl;break;case"middle":Pe+=Cc/2-gl}if((vr=je.maxWidth||0)>0&&(typeof k=="string"?k=Kr.splitTextToSize(k,vr):Object.prototype.toString.call(k)==="[object Array]"&&(k=k.reduce(function(vn,Ln){return vn.concat(Kr.splitTextToSize(Ln,vr))},[]))),lt={text:k,x:re,y:Pe,options:je,mutex:{pdfEscape:Li,activeFontKey:Ir,fonts:Jt,activeFontSize:vt}},ae.publish("preProcessText",lt),k=lt.text,cr=(je=lt.options).angle,!(Ai instanceof Te)&&cr&&typeof cr=="number"){cr*=Math.PI/180,je.rotationDirection===0&&(cr=-cr),Y===q.ADVANCED&&(cr=-cr);var ml=Math.cos(cr),Ec=Math.sin(cr);Ai=new Te(ml,Ec,-Ec,ml,0,0)}else cr&&cr instanceof Te&&(Ai=cr);Y!==q.ADVANCED||Ai||(Ai=yt),(Gr=je.charSpace||iu)!==void 0&&(si+=ye(le(Gr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(br=je.horizontalScale)!==void 0&&(si+=ye(100*br)+` Tz
`),je.lang;var vs=-1,dd=je.renderingMode!==void 0?je.renderingMode:je.stroke,lu=Kr.internal.getCurrentPageInfo().pageContext;switch(dd){case 0:case!1:case"fill":vs=0;break;case 1:case!0:case"stroke":vs=1;break;case 2:case"fillThenStroke":vs=2;break;case 3:case"invisible":vs=3;break;case 4:case"fillAndAddForClipping":vs=4;break;case 5:case"strokeAndAddPathForClipping":vs=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":vs=6;break;case 7:case"addToPathForClipping":vs=7}var $n=lu.usedRenderingMode!==void 0?lu.usedRenderingMode:-1;vs!==-1?si+=vs+` Tr
`:$n!==-1&&(si+=`0 Tr
`),vs!==-1&&(lu.usedRenderingMode=vs),Pr=je.align||"left";var qi,Oi=vt*Ns,eA=Kr.internal.pageSize.getWidth(),uu=Jt[Ir];Gr=je.charSpace||iu,vr=je.maxWidth||0,wn=Object.assign({autoencode:!0,noBOM:!0},je.flags);var Va=[];if(Object.prototype.toString.call(k)==="[object Array]"){var Di;Pt=wc(k),Pr!=="left"&&(qi=Pt.map(function(vn){return Kr.getStringUnitWidth(vn,{font:uu,charSpace:Gr,fontSize:vt,doKerning:!1})*vt/_a}));var Ki,Zs=0;if(Pr==="right"){re-=qi[0],k=[],cs=Pt.length;for(var bo=0;bo<cs;bo++)bo===0?(Ki=jo(re),Di=qo(Pe)):(Ki=le(Zs-qi[bo]),Di=-Oi),k.push([Pt[bo],Ki,Di]),Zs=qi[bo]}else if(Pr==="center"){re-=qi[0]/2,k=[],cs=Pt.length;for(var wo=0;wo<cs;wo++)wo===0?(Ki=jo(re),Di=qo(Pe)):(Ki=le((Zs-qi[wo])/2),Di=-Oi),k.push([Pt[wo],Ki,Di]),Zs=qi[wo]}else if(Pr==="left"){k=[],cs=Pt.length;for(var Sc=0;Sc<cs;Sc++)k.push(Pt[Sc])}else{if(Pr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');k=[],cs=Pt.length,vr=vr!==0?vr:eA;for(var eo=0;eo<cs;eo++)Di=eo===0?qo(Pe):-Oi,Ki=eo===0?jo(re):0,eo<cs-1?Va.push(ye(le((vr-qi[eo])/(Pt[eo].split(" ").length-1)))):Va.push(0),k.push([Pt[eo],Ki,Di])}}var va=typeof je.R2L=="boolean"?je.R2L:ir;va===!0&&(k=xc(k,function(vn,Ln,Fn){return[vn.split("").reverse().join(""),Ln,Fn]})),lt={text:k,x:re,y:Pe,options:je,mutex:{pdfEscape:Li,activeFontKey:Ir,fonts:Jt,activeFontSize:vt}},ae.publish("postProcessText",lt),k=lt.text,ks=lt.mutex.isHex||!1;var $o=Jt[Ir].encoding;$o!=="WinAnsiEncoding"&&$o!=="StandardEncoding"||(k=xc(k,function(vn,Ln,Fn){return[fl(vn),Ln,Fn]})),Pt=wc(k),k=[];for(var ja,xo,ba,Tc=0,wa=1,Xo=Array.isArray(Pt[0])?wa:Tc,Ci="",Qs=function(vn,Ln,Fn){var ei="";return Fn instanceof Te?(Fn=typeof je.angle=="number"?Ze(Fn,new Te(1,0,0,1,vn,Ln)):Ze(new Te(1,0,0,1,vn,Ln),Fn),Y===q.ADVANCED&&(Fn=Ze(new Te(1,0,0,-1,0,0),Fn)),ei=Fn.join(" ")+` Tm
`):ei=ye(vn)+" "+ye(Ln)+` Td
`,ei},Hs=0;Hs<Pt.length;Hs++){switch(Ci="",Xo){case wa:ba=(ks?"<":"(")+Pt[Hs][0]+(ks?">":")"),ja=parseFloat(Pt[Hs][1]),xo=parseFloat(Pt[Hs][2]);break;case Tc:ba=(ks?"<":"(")+Pt[Hs]+(ks?">":")"),ja=jo(re),xo=qo(Pe)}Va!==void 0&&Va[Hs]!==void 0&&(Ci=Va[Hs]+` Tw
`),Hs===0?k.push(Ci+Qs(ja,xo,Ai)+ba):Xo===Tc?k.push(Ci+ba):Xo===wa&&k.push(Ci+Qs(ja,xo,Ai)+ba)}k=Xo===Tc?k.join(` Tj
T* `):k.join(` Tj
`),k+=` Tj
`;var ki=`BT
/`;return ki+=Ir+" "+vt+` Tf
`,ki+=ye(vt*Ns)+` TL
`,ki+=yc+`
`,ki+=si,ki+=k,Re(ki+="ET"),x[Ir]=!0,Kr};var tu=B.__private__.clip=B.clip=function(k){return Re(k==="evenodd"?"W*":"W"),this};B.clipEvenOdd=function(){return tu("evenodd")},B.__private__.discardPath=B.discardPath=function(){return Re("n"),this};var _i=B.__private__.isValidStyle=function(k){var re=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(k)!==-1&&(re=!0),re};B.__private__.setDefaultPathOperation=B.setDefaultPathOperation=function(k){return _i(k)&&(f=k),this};var pc=B.__private__.getStyle=B.getStyle=function(k){var re=f;switch(k){case"D":case"S":re="S";break;case"F":re="f";break;case"FD":case"DF":re="B";break;case"f":case"f*":case"B":case"B*":re=k}return re},cl=B.close=function(){return Re("h"),this};B.stroke=function(){return Re("S"),this},B.fill=function(k){return pa("f",k),this},B.fillEvenOdd=function(k){return pa("f*",k),this},B.fillStroke=function(k){return pa("B",k),this},B.fillStrokeEvenOdd=function(k){return pa("B*",k),this};var pa=function(k,re){Dn(re)==="object"?ul(re,k):Re(k)},Ha=function(k){k===null||Y===q.ADVANCED&&k===void 0||(k=pc(k),Re(k))};function ll(k,re,Pe,je,at){var lt=new yf(re||this.boundingBox,Pe||this.xStep,je||this.yStep,this.gState,at||this.matrix);lt.stream=this.stream;var Pt=k+"$$"+this.cloneIndex+++"$$";return gt(Pt,lt),lt}var ul=function(k,re){var Pe=gr[k.key],je=Or[Pe];if(je instanceof Gh)Re("q"),Re(Ad(re)),je.gState&&B.setGState(je.gState),Re(k.matrix.toString()+" cm"),Re("/"+Pe+" sh"),Re("Q");else if(je instanceof yf){var at=new Te(1,0,0,-1,0,ya());k.matrix&&(at=at.multiply(k.matrix||yt),Pe=ll.call(je,k.key,k.boundingBox,k.xStep,k.yStep,at).id),Re("q"),Re("/Pattern cs"),Re("/"+Pe+" scn"),je.gState&&B.setGState(je.gState),Re(re),Re("Q")}},Ad=function(k){switch(k){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},$u=B.moveTo=function(k,re){return Re(ye(le(k))+" "+ye(_e(re))+" m"),this},gc=B.lineTo=function(k,re){return Re(ye(le(k))+" "+ye(_e(re))+" l"),this},mc=B.curveTo=function(k,re,Pe,je,at,lt){return Re([ye(le(k)),ye(_e(re)),ye(le(Pe)),ye(_e(je)),ye(le(at)),ye(_e(lt)),"c"].join(" ")),this};B.__private__.line=B.line=function(k,re,Pe,je,at){if(isNaN(k)||isNaN(re)||isNaN(Pe)||isNaN(je)||!_i(at))throw new Error("Invalid arguments passed to jsPDF.line");return Y===q.COMPAT?this.lines([[Pe-k,je-re]],k,re,[1,1],at||"S"):this.lines([[Pe-k,je-re]],k,re,[1,1]).stroke()},B.__private__.lines=B.lines=function(k,re,Pe,je,at,lt){var Pt,cr,Pr,Gr,vr,wn,br,Ai,Kr,Xr,si,ks;if(typeof k=="number"&&(ks=Pe,Pe=re,re=k,k=ks),je=je||[1,1],lt=lt||!1,isNaN(re)||isNaN(Pe)||!Array.isArray(k)||!Array.isArray(je)||!_i(at)||typeof lt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for($u(re,Pe),Pt=je[0],cr=je[1],Gr=k.length,Xr=re,si=Pe,Pr=0;Pr<Gr;Pr++)(vr=k[Pr]).length===2?(Xr=vr[0]*Pt+Xr,si=vr[1]*cr+si,gc(Xr,si)):(wn=vr[0]*Pt+Xr,br=vr[1]*cr+si,Ai=vr[2]*Pt+Xr,Kr=vr[3]*cr+si,Xr=vr[4]*Pt+Xr,si=vr[5]*cr+si,mc(wn,br,Ai,Kr,Xr,si));return lt&&cl(),Ha(at),this},B.path=function(k){for(var re=0;re<k.length;re++){var Pe=k[re],je=Pe.c;switch(Pe.op){case"m":$u(je[0],je[1]);break;case"l":gc(je[0],je[1]);break;case"c":mc.apply(this,je);break;case"h":cl()}}return this},B.__private__.rect=B.rect=function(k,re,Pe,je,at){if(isNaN(k)||isNaN(re)||isNaN(Pe)||isNaN(je)||!_i(at))throw new Error("Invalid arguments passed to jsPDF.rect");return Y===q.COMPAT&&(je=-je),Re([ye(le(k)),ye(_e(re)),ye(le(Pe)),ye(le(je)),"re"].join(" ")),Ha(at),this},B.__private__.triangle=B.triangle=function(k,re,Pe,je,at,lt,Pt){if(isNaN(k)||isNaN(re)||isNaN(Pe)||isNaN(je)||isNaN(at)||isNaN(lt)||!_i(Pt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Pe-k,je-re],[at-Pe,lt-je],[k-at,re-lt]],k,re,[1,1],Pt,!0),this},B.__private__.roundedRect=B.roundedRect=function(k,re,Pe,je,at,lt,Pt){if(isNaN(k)||isNaN(re)||isNaN(Pe)||isNaN(je)||isNaN(at)||isNaN(lt)||!_i(Pt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var cr=4/3*(Math.SQRT2-1);return at=Math.min(at,.5*Pe),lt=Math.min(lt,.5*je),this.lines([[Pe-2*at,0],[at*cr,0,at,lt-lt*cr,at,lt],[0,je-2*lt],[0,lt*cr,-at*cr,lt,-at,lt],[2*at-Pe,0],[-at*cr,0,-at,-lt*cr,-at,-lt],[0,2*lt-je],[0,-lt*cr,at*cr,-lt,at,-lt]],k+at,re,[1,1],Pt,!0),this},B.__private__.ellipse=B.ellipse=function(k,re,Pe,je,at){if(isNaN(k)||isNaN(re)||isNaN(Pe)||isNaN(je)||!_i(at))throw new Error("Invalid arguments passed to jsPDF.ellipse");var lt=4/3*(Math.SQRT2-1)*Pe,Pt=4/3*(Math.SQRT2-1)*je;return $u(k+Pe,re),mc(k+Pe,re-Pt,k+lt,re-je,k,re-je),mc(k-lt,re-je,k-Pe,re-Pt,k-Pe,re),mc(k-Pe,re+Pt,k-lt,re+je,k,re+je),mc(k+lt,re+je,k+Pe,re+Pt,k+Pe,re),Ha(at),this},B.__private__.circle=B.circle=function(k,re,Pe,je){if(isNaN(k)||isNaN(re)||isNaN(Pe)||!_i(je))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(k,re,Pe,Pe,je)},B.setFont=function(k,re,Pe){return Pe&&(re=ge(re,Pe)),Ir=he(k,re,{disableWarning:!1}),this};var za=B.__private__.getFont=B.getFont=function(){return Jt[he.apply(B,arguments)]};B.__private__.getFontList=B.getFontList=function(){var k,re,Pe={};for(k in Kt)if(Kt.hasOwnProperty(k))for(re in Pe[k]=[],Kt[k])Kt[k].hasOwnProperty(re)&&Pe[k].push(re);return Pe},B.addFont=function(k,re,Pe,je,at){var lt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&lt.indexOf(arguments[3])!==-1?at=arguments[3]:arguments[3]&&lt.indexOf(arguments[3])==-1&&(Pe=ge(Pe,je)),at=at||"Identity-H",vo.call(this,k,re,Pe,at)};var ga,Ri=r.lineWidth||.200025,Bi=B.__private__.getLineWidth=B.getLineWidth=function(){return Ri},ln=B.__private__.setLineWidth=B.setLineWidth=function(k){return Ri=k,Re(ye(le(k))+" w"),this};B.__private__.setLineDash=qr.API.setLineDash=qr.API.setLineDashPattern=function(k,re){if(k=k||[],re=re||0,isNaN(re)||!Array.isArray(k))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return k=k.map(function(Pe){return ye(le(Pe))}).join(" "),re=ye(le(re)),Re("["+k+"] "+re+" d"),this};var Al=B.__private__.getLineHeight=B.getLineHeight=function(){return vt*ga};B.__private__.getLineHeight=B.getLineHeight=function(){return vt*ga};var hl=B.__private__.setLineHeightFactor=B.setLineHeightFactor=function(k){return typeof(k=k||1.15)=="number"&&(ga=k),this},ru=B.__private__.getLineHeightFactor=B.getLineHeightFactor=function(){return ga};hl(r.lineHeight);var jo=B.__private__.getHorizontalCoordinate=function(k){return le(k)},qo=B.__private__.getVerticalCoordinate=function(k){return Y===q.ADVANCED?k:Z[be].mediaBox.topRightY-Z[be].mediaBox.bottomLeftY-le(k)},Xu=B.__private__.getHorizontalCoordinateString=B.getHorizontalCoordinateString=function(k){return ye(jo(k))},ma=B.__private__.getVerticalCoordinateString=B.getVerticalCoordinateString=function(k){return ye(qo(k))},Ds=r.strokeColor||"0 G";B.__private__.getStrokeColor=B.getDrawColor=function(){return Nr(Ds)},B.__private__.setStrokeColor=B.setDrawColor=function(k,re,Pe,je){return Ds=Hr({ch1:k,ch2:re,ch3:Pe,ch4:je,pdfColorType:"draw",precision:2}),Re(Ds),this};var nu=r.fillColor||"0 g";B.__private__.getFillColor=B.getFillColor=function(){return Nr(nu)},B.__private__.setFillColor=B.setFillColor=function(k,re,Pe,je){return nu=Hr({ch1:k,ch2:re,ch3:Pe,ch4:je,pdfColorType:"fill",precision:2}),Re(nu),this};var yc=r.textColor||"0 g",_c=B.__private__.getTextColor=B.getTextColor=function(){return Nr(yc)};B.__private__.setTextColor=B.setTextColor=function(k,re,Pe,je){return yc=Hr({ch1:k,ch2:re,ch3:Pe,ch4:je,pdfColorType:"text",precision:3}),this};var iu=r.charSpace,hd=B.__private__.getCharSpace=B.getCharSpace=function(){return parseFloat(iu||0)};B.__private__.setCharSpace=B.setCharSpace=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return iu=k,this};var Ju=0;B.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},B.__private__.setLineCap=B.setLineCap=function(k){var re=B.CapJoinStyles[k];if(re===void 0)throw new Error("Line cap style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ju=re,Re(re+" J"),this};var Yu=0;B.__private__.setLineJoin=B.setLineJoin=function(k){var re=B.CapJoinStyles[k];if(re===void 0)throw new Error("Line join style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Yu=re,Re(re+" j"),this},B.__private__.setLineMiterLimit=B.__private__.setMiterLimit=B.setLineMiterLimit=B.setMiterLimit=function(k){if(k=k||0,isNaN(k))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Re(ye(le(k))+" M"),this},B.GState=hy,B.setGState=function(k){(k=typeof k=="string"?an[Wr[k]]:th(null,k)).equals(Ee)||(Re("/"+k.id+" gs"),Ee=k)};var th=function(k,re){if(!k||!Wr[k]){var Pe=!1;for(var je in an)if(an.hasOwnProperty(je)&&an[je].equals(re)){Pe=!0;break}if(Pe)re=an[je];else{var at="GS"+(Object.keys(an).length+1).toString(10);an[at]=re,re.id=at}return k&&(Wr[k]=re.id),ae.publish("addGState",re),re}};B.addGState=function(k,re){return th(k,re),this},B.saveGraphicsState=function(){return Re("q"),Yr.push({key:Ir,size:vt,color:yc}),this},B.restoreGraphicsState=function(){Re("Q");var k=Yr.pop();return Ir=k.key,vt=k.size,yc=k.color,Ee=null,this},B.setCurrentTransformationMatrix=function(k){return Re(k.toString()+" cm"),this},B.comment=function(k){return Re("#"+k),this};var su=function(k,re){var Pe=k||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Pe},set:function(lt){isNaN(lt)||(Pe=parseFloat(lt))}});var je=re||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return je},set:function(lt){isNaN(lt)||(je=parseFloat(lt))}});var at="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return at},set:function(lt){at=lt.toString()}}),this},dl=function(k,re,Pe,je){su.call(this,k,re),this.type="rect";var at=Pe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return at},set:function(Pt){isNaN(Pt)||(at=parseFloat(Pt))}});var lt=je||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return lt},set:function(Pt){isNaN(Pt)||(lt=parseFloat(Pt))}}),this},vc=function(){this.page=ee,this.currentPage=be,this.pages=It.slice(0),this.pagesContext=Z.slice(0),this.x=xn,this.y=Mr,this.matrix=Tt,this.width=bc(be),this.height=ya(be),this.outputDestination=Ht,this.id="",this.objectNumber=-1};vc.prototype.restore=function(){ee=this.page,be=this.currentPage,Z=this.pagesContext,It=this.pages,xn=this.x,Mr=this.y,Tt=this.matrix,au(be,this.width),Wo(be,this.height),Ht=this.outputDestination};var ou=function(k,re,Pe,je,at){Ke.push(new vc),ee=be=0,It=[],xn=k,Mr=re,Tt=at,cn([Pe,je])},Zu=function(k){if(Ge[k])Ke.pop().restore();else{var re=new vc,Pe="Xo"+(Object.keys(Qe).length+1).toString(10);re.id=Pe,Ge[k]=Pe,Qe[Pe]=re,ae.publish("addFormObject",re),Ke.pop().restore()}};for(var Ko in B.beginFormObject=function(k,re,Pe,je,at){return ou(k,re,Pe,je,at),this},B.endFormObject=function(k){return Zu(k),this},B.doFormObject=function(k,re){var Pe=Qe[Ge[k]];return Re("q"),Re(re.toString()+" cm"),Re("/"+Pe.id+" Do"),Re("Q"),this},B.getFormObject=function(k){var re=Qe[Ge[k]];return{x:re.x,y:re.y,width:re.width,height:re.height,matrix:re.matrix}},B.save=function(k,re){return k=k||"generated.pdf",(re=re||{}).returnPromise=re.returnPromise||!1,re.returnPromise===!1?(zh(Wn(zr()),k),typeof zh.unload=="function"&&jr.setTimeout&&setTimeout(zh.unload,911),this):new Promise(function(Pe,je){try{var at=zh(Wn(zr()),k);typeof zh.unload=="function"&&jr.setTimeout&&setTimeout(zh.unload,911),Pe(at)}catch(lt){je(lt.message)}})},qr.API)qr.API.hasOwnProperty(Ko)&&(Ko==="events"&&qr.API.events.length?function(k,re){var Pe,je,at;for(at=re.length-1;at!==-1;at--)Pe=re[at][0],je=re[at][1],k.subscribe.apply(k,[Pe].concat(typeof je=="function"?[je]:je))}(ae,qr.API.events):B[Ko]=qr.API[Ko]);var bc=B.getPageWidth=function(k){return(Z[k=k||be].mediaBox.topRightX-Z[k].mediaBox.bottomLeftX)/Dt},au=B.setPageWidth=function(k,re){Z[k].mediaBox.topRightX=re*Dt+Z[k].mediaBox.bottomLeftX},ya=B.getPageHeight=function(k){return(Z[k=k||be].mediaBox.topRightY-Z[k].mediaBox.bottomLeftY)/Dt},Wo=B.setPageHeight=function(k,re){Z[k].mediaBox.topRightY=re*Dt+Z[k].mediaBox.bottomLeftY};return B.internal={pdfEscape:Li,getStyle:pc,getFont:za,getFontSize:kt,getCharSpace:hd,getTextColor:_c,getLineHeight:Al,getLineHeightFactor:ru,getLineWidth:Bi,write:Ye,getHorizontalCoordinate:jo,getVerticalCoordinate:qo,getCoordinateString:Xu,getVerticalCoordinateString:ma,collections:{},newObject:ft,newAdditionalObject:Er,newObjectDeferred:Vt,newObjectDeferredBegin:Yt,getFilters:mn,putStream:mr,events:ae,scaleFactor:Dt,pageSize:{getWidth:function(){return bc(be)},setWidth:function(k){au(be,k)},getHeight:function(){return ya(be)},setHeight:function(k){Wo(be,k)}},encryptionOptions:m,encryption:Nn,getEncryptor:eh,output:Zn,getNumberOfPages:fc,pages:It,out:Re,f2:Fe,f3:oe,getPageInfo:al,getPageInfoByObjId:Vr,getCurrentPageInfo:Qa,getPDFVersion:U,Point:su,Rectangle:dl,Matrix:Te,hasHotfix:ui},Object.defineProperty(B.internal.pageSize,"width",{get:function(){return bc(be)},set:function(k){au(be,k)},enumerable:!0,configurable:!0}),Object.defineProperty(B.internal.pageSize,"height",{get:function(){return ya(be)},set:function(k){Wo(be,k)},enumerable:!0,configurable:!0}),Pi.call(B,St),Ir="F1",Go(i,t),ae.publish("initialized"),B}gf.prototype.lsbFirstWord=function(r){return String.fromCharCode(r>>0&255,r>>8&255,r>>16&255,r>>24&255)},gf.prototype.toHexString=function(r){return r.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},gf.prototype.hexToBytes=function(r){for(var e=[],t=0;t<r.length;t+=2)e.push(String.fromCharCode(parseInt(r.substr(t,2),16)));return e.join("")},gf.prototype.processOwnerPassword=function(r,e){return g2(p2(e).substr(0,5),r)},gf.prototype.encryptor=function(r,e){var t=p2(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return g2(t,n)}},hy.prototype.equals=function(r){var e,t="id,objectNumber,equals";if(!r||Dn(r)!==Dn(this))return!1;var n=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!r.hasOwnProperty(e)||this[e]!==r[e])return!1;n++}for(e in r)r.hasOwnProperty(e)&&t.indexOf(e)<0&&n--;return n===0},qr.API={events:[]},qr.version="2.5.1";var Vi=qr.API,m2=1,Vh=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},_f=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Zr=function(r){return r.toFixed(2)},kA=function(r){return r.toFixed(5)};Vi.__acroform__={};var Aa=function(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r},FF=function(r){return r*m2},Kl=function(r){var e=new PF,t=_r.internal.getHeight(r)||0,n=_r.internal.getWidth(r)||0;return e.BBox=[0,0,Number(Zr(n)),Number(Zr(t))],e},gte=Vi.__acroform__.setBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|=1<<e},mte=Vi.__acroform__.clearBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&=~(1<<e)},yte=Vi.__acroform__.getBit=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return r&1<<e?1:0},Yi=Vi.__acroform__.getBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return yte(r,e-1)},Zi=Vi.__acroform__.setBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return gte(r,e-1)},es=Vi.__acroform__.clearBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return mte(r,e-1)},_te=Vi.__acroform__.calculateCoordinates=function(r,e){var t=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=r[0],s=r[1],a=r[2],o=r[3],A={};return A.lowerLeft_X=t(i)||0,A.lowerLeft_Y=n(s+o)||0,A.upperRight_X=t(i+a)||0,A.upperRight_Y=n(s)||0,[Number(Zr(A.lowerLeft_X)),Number(Zr(A.lowerLeft_Y)),Number(Zr(A.upperRight_X)),Number(Zr(A.upperRight_Y))]},vte=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var e=[],t=r._V||r.DV,n=y2(r,t),i=r.scope.internal.getFont(r.fontName,r.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(r.scope.__private__.encodeColorString(r.color)),e.push("/"+i+" "+Zr(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Kl(r);return s.scope=r.scope,s.stream=e.join(`
`),s}},y2=function(r,e){var t=r.fontSize===0?r.maxFontSize:r.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=r.multiline?i.map(function(oe){return oe.split(`
`)}):i.map(function(oe){return[oe]});var s=t,a=_r.internal.getHeight(r)||0;a=a<0?-a:a;var o=_r.internal.getWidth(r)||0;o=o<0?-o:o;var A=function(oe,le,xe){if(oe+1<i.length){var _e=le+" "+i[oe+1][0];return dy(_e,r,xe).width<=o-4}return!1};s++;e:for(;s>0;){e="",s--;var f,m,v=dy("3",r,s).height,x=r.multiline?a-s:(a-v)/2,B=x+=2,M=0,U=0,N=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+dy(e,r,s=12).width+", FieldWidth:"+o+`
`;break}for(var Q="",q=0,Y=0;Y<i.length;Y++)if(i.hasOwnProperty(Y)){var te=!1;if(i[Y].length!==1&&N!==i[Y].length-1){if((v+2)*(q+2)+2>a)continue e;Q+=i[Y][N],te=!0,U=Y,Y--}else{Q=(Q+=i[Y][N]+" ").substr(Q.length-1)==" "?Q.substr(0,Q.length-1):Q;var pe=parseInt(Y),ge=A(pe,Q,s),ye=Y>=i.length-1;if(ge&&!ye){Q+=" ",N=0;continue}if(ge||ye){if(ye)U=pe;else if(r.multiline&&(v+2)*(q+2)+2>a)continue e}else{if(!r.multiline||(v+2)*(q+2)+2>a)continue e;U=pe}}for(var fe="",Oe=M;Oe<=U;Oe++){var Fe=i[Oe];if(r.multiline){if(Oe===U){fe+=Fe[N]+" ",N=(N+1)%Fe.length;continue}if(Oe===M){fe+=Fe[Fe.length-1]+" ";continue}}fe+=Fe[0]+" "}switch(fe=fe.substr(fe.length-1)==" "?fe.substr(0,fe.length-1):fe,m=dy(fe,r,s).width,r.textAlign){case"right":f=o-m-2;break;case"center":f=(o-m)/2;break;case"left":default:f=2}e+=Zr(f)+" "+Zr(B)+` Td
`,e+="("+Vh(fe)+`) Tj
`,e+=-Zr(f)+` 0 Td
`,B=-(s+2),m=0,M=te?U:U+1,q++,Q=""}break}return n.text=e,n.fontSize=s,n},dy=function(r,e,t){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(r,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:i}},bte={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},wte=function(r,e){var t={type:"reference",object:r};e.internal.getPageInfo(r.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&e.internal.getPageInfo(r.page).pageContext.annotations.push(t)},xte=function(r,e){for(var t in r)if(r.hasOwnProperty(t)){var n=t,i=r[t];e.internal.newObjectDeferredBegin(i.objId,!0),Dn(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete r[n]}},Bte=function(r,e){if(e.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(Kc.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(bte)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");m2=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new UF,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var s=n[i];s.objId=void 0,s.hasAnnotation&&wte(s,t)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(t){(function(n,i){var s=!n;for(var a in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(a)){var o=n[a],A=[],f=o.Rect;if(o.Rect&&(o.Rect=_te(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=_r.createDefaultAppearanceStream(o),Dn(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(A=o.getKeyValueListForStream()),o.Rect=f,o.hasAppearanceStream&&!o.appearanceStreamContent){var m=vte(o);A.push({key:"AP",value:"<</N "+m+">>"}),i.internal.acroformPlugin.xForms.push(m)}if(o.appearanceStreamContent){var v="";for(var x in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(x)){var B=o.appearanceStreamContent[x];if(v+="/"+x+" ",v+="<<",Object.keys(B).length>=1||Array.isArray(B)){for(var a in B)if(B.hasOwnProperty(a)){var M=B[a];typeof M=="function"&&(M=M.call(i,o)),v+="/"+a+" "+M+" ",i.internal.acroformPlugin.xForms.indexOf(M)>=0||i.internal.acroformPlugin.xForms.push(M)}}else typeof(M=B)=="function"&&(M=M.call(i,o)),v+="/"+a+" "+M,i.internal.acroformPlugin.xForms.indexOf(M)>=0||i.internal.acroformPlugin.xForms.push(M);v+=">>"}A.push({key:"AP",value:`<<
`+v+">>"})}i.internal.putStream({additionalKeyValues:A,objectId:o.objId}),i.internal.out("endobj")}s&&xte(i.internal.acroformPlugin.xForms,i)})(t,r)}),r.internal.acroformPlugin.isInitialized=!0}},MF=Vi.__acroform__.arrayToPdfArray=function(r,e,t){var n=function(a){return a};if(Array.isArray(r)){for(var i="[",s=0;s<r.length;s++)switch(s!==0&&(i+=" "),Dn(r[s])){case"boolean":case"number":case"object":i+=r[s].toString();break;case"string":r[s].substr(0,1)!=="/"?(e!==void 0&&t&&(n=t.internal.getEncryptor(e)),i+="("+Vh(n(r[s].toString()))+")"):i+=r[s].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},_2=function(r,e,t){var n=function(i){return i};return e!==void 0&&t&&(n=t.internal.getEncryptor(e)),(r=r||"").toString(),r="("+Vh(n(r))+")"},Wl=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Wl.prototype.toString=function(){return this.objId+" 0 R"},Wl.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},Wl.prototype.getKeyValueListForStream=function(){var r=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var n=e[t],i=this[n];i&&(Array.isArray(i)?r.push({key:n,value:MF(i,this.objId,this.scope)}):i instanceof Wl?(i.scope=this.scope,r.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&r.push({key:n,value:i}))}return r};var PF=function(){Wl.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){r=t.trim()},get:function(){return r||null}})};Aa(PF,Wl);var UF=function(){Wl.call(this);var r,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Vh(t(r))+")"}},set:function(t){r=t}})};Aa(UF,Wl);var Kc=function r(){Wl.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(Q){if(isNaN(Q))throw new Error('Invalid value "'+Q+'" for attribute F supplied.');e=Q}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Yi(e,3)},set:function(Q){Q?this.F=Zi(e,3):this.F=es(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(Q){if(isNaN(Q))throw new Error('Invalid value "'+Q+'" for attribute Ff supplied.');t=Q}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(Q){n=Q!==void 0?Q:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(Q){n[0]=Q}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(Q){n[1]=Q}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(Q){n[2]=Q}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(Q){n[3]=Q}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(Q){switch(Q){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=Q;break;default:throw new Error('Invalid value "'+Q+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof gy)return;s="FieldObject"+r.FieldNum++}var Q=function(q){return q};return this.scope&&(Q=this.scope.internal.getEncryptor(this.objId)),"("+Vh(Q(s))+")"},set:function(Q){s=Q.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(Q){s=Q}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(Q){a=Q}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(Q){o=Q}});var A=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return A},set:function(Q){A=Q}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/m2:f},set:function(Q){f=Q}});var m="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return m},set:function(Q){m=Q}});var v="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!v||this instanceof gy||this instanceof jh))return _2(v,this.objId,this.scope)},set:function(Q){Q=Q.toString(),v=Q}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof Ps?x:_2(x,this.objId,this.scope)},set:function(Q){Q=Q.toString(),x=this instanceof Ps?Q:Q.substr(0,1)==="("?_f(Q.substr(1,Q.length-2)):_f(Q)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ps?_f(x.substr(1,x.length-1)):x},set:function(Q){Q=Q.toString(),x=this instanceof Ps?"/"+Q:Q}});var B=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(B)return B},set:function(Q){this.V=Q}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(B)return this instanceof Ps?B:_2(B,this.objId,this.scope)},set:function(Q){Q=Q.toString(),B=this instanceof Ps?Q:Q.substr(0,1)==="("?_f(Q.substr(1,Q.length-2)):_f(Q)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ps?_f(B.substr(1,B.length-1)):B},set:function(Q){Q=Q.toString(),B=this instanceof Ps?"/"+Q:Q}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var M,U=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return U},set:function(Q){Q=!!Q,U=Q}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(M)return M},set:function(Q){M=Q}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,1)},set:function(Q){Q?this.Ff=Zi(this.Ff,1):this.Ff=es(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,2)},set:function(Q){Q?this.Ff=Zi(this.Ff,2):this.Ff=es(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,3)},set:function(Q){Q?this.Ff=Zi(this.Ff,3):this.Ff=es(this.Ff,3)}});var N=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(N!==null)return N},set:function(Q){if([0,1,2].indexOf(Q)===-1)throw new Error('Invalid value "'+Q+'" for attribute Q supplied.');N=Q}}),Object.defineProperty(this,"textAlign",{get:function(){var Q;switch(N){case 0:default:Q="left";break;case 1:Q="center";break;case 2:Q="right"}return Q},configurable:!0,enumerable:!0,set:function(Q){switch(Q){case"right":case 2:N=2;break;case"center":case 1:N=1;break;case"left":case 0:default:N=0}}})};Aa(Kc,Wl);var vf=function(){Kc.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){r=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return MF(e,this.objId,this.scope)},set:function(t){var n,i;i=[],typeof(n=t)=="string"&&(i=function(s,a,o){o||(o=1);for(var A,f=[];A=a.exec(s);)f.push(A[o]);return f}(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,18)},set:function(t){t?this.Ff=Zi(this.Ff,18):this.Ff=es(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Zi(this.Ff,19):this.Ff=es(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,20)},set:function(t){t?(this.Ff=Zi(this.Ff,20),e.sort()):this.Ff=es(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,22)},set:function(t){t?this.Ff=Zi(this.Ff,22):this.Ff=es(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,23)},set:function(t){t?this.Ff=Zi(this.Ff,23):this.Ff=es(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,27)},set:function(t){t?this.Ff=Zi(this.Ff,27):this.Ff=es(this.Ff,27)}}),this.hasAppearanceStream=!1};Aa(vf,Kc);var bf=function(){vf.call(this),this.fontName="helvetica",this.combo=!1};Aa(bf,vf);var wf=function(){bf.call(this),this.combo=!0};Aa(wf,bf);var fy=function(){wf.call(this),this.edit=!0};Aa(fy,wf);var Ps=function(){Kc.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,15)},set:function(t){t?this.Ff=Zi(this.Ff,15):this.Ff=es(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,16)},set:function(t){t?this.Ff=Zi(this.Ff,16):this.Ff=es(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,17)},set:function(t){t?this.Ff=Zi(this.Ff,17):this.Ff=es(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,26)},set:function(t){t?this.Ff=Zi(this.Ff,26):this.Ff=es(this.Ff,26)}});var r,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(s){return s};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+Vh(t(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(t){Dn(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(t){r="/"+t}})};Aa(Ps,Kc);var py=function(){Ps.call(this),this.pushButton=!0};Aa(py,Ps);var xf=function(){Ps.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e!==void 0?e:[]}})};Aa(xf,Ps);var gy=function(){var r,e;Kc.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,a=[];for(s in a.push("<<"),n)a.push("/"+s+" ("+Vh(i(n[s]))+")");return a.push(">>"),a.join(`
`)},set:function(i){Dn(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(i){t="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=_r.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Aa(gy,Kc),xf.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=r.createAppearanceStream(t.optionName),t.caption=r.getCA()}},xf.prototype.createOption=function(r){var e=new gy;return e.Parent=this,e.optionName=r,this.Kids.push(e),Cte.call(this.scope,e),e};var my=function(){Ps.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=_r.CheckBox.createAppearanceStream()};Aa(my,Ps);var jh=function(){Kc.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,13)},set:function(e){e?this.Ff=Zi(this.Ff,13):this.Ff=es(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,21)},set:function(e){e?this.Ff=Zi(this.Ff,21):this.Ff=es(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,23)},set:function(e){e?this.Ff=Zi(this.Ff,23):this.Ff=es(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,24)},set:function(e){e?this.Ff=Zi(this.Ff,24):this.Ff=es(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,25)},set:function(e){e?this.Ff=Zi(this.Ff,25):this.Ff=es(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,26)},set:function(e){e?this.Ff=Zi(this.Ff,26):this.Ff=es(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){Number.isInteger(e)&&(r=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Aa(jh,Kc);var yy=function(){jh.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Yi(this.Ff,14)},set:function(r){r?this.Ff=Zi(this.Ff,14):this.Ff=es(this.Ff,14)}}),this.password=!0};Aa(yy,jh);var _r={CheckBox:{createAppearanceStream:function(){return{N:{On:_r.CheckBox.YesNormal},D:{On:_r.CheckBox.YesPushDown,Off:_r.CheckBox.OffPushDown}}},YesPushDown:function(r){var e=Kl(r);e.scope=r.scope;var t=[],n=r.scope.internal.getFont(r.fontName,r.fontStyle).id,i=r.scope.__private__.encodeColorString(r.color),s=y2(r,r.caption);return t.push("0.749023 g"),t.push("0 0 "+Zr(_r.internal.getWidth(r))+" "+Zr(_r.internal.getHeight(r))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+Zr(s.fontSize)+" Tf "+i),t.push("BT"),t.push(s.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(r){var e=Kl(r);e.scope=r.scope;var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),i=[],s=_r.internal.getHeight(r),a=_r.internal.getWidth(r),o=y2(r,r.caption);return i.push("1 g"),i.push("0 0 "+Zr(a)+" "+Zr(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Zr(a-1)+" "+Zr(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+t+" "+Zr(o.fontSize)+" Tf "+n),i.push(o.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(r){var e=Kl(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Zr(_r.internal.getWidth(r))+" "+Zr(_r.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(r){var e={D:{Off:_r.RadioButton.Circle.OffPushDown},N:{}};return e.N[r]=_r.RadioButton.Circle.YesNormal,e.D[r]=_r.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(r){var e=Kl(r);e.scope=r.scope;var t=[],n=_r.internal.getWidth(r)<=_r.internal.getHeight(r)?_r.internal.getWidth(r)/4:_r.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var i=_r.internal.Bezier_C,s=Number((n*i).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+kA(_r.internal.getWidth(r)/2)+" "+kA(_r.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),t.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),t.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),t.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=Kl(r);e.scope=r.scope;var t=[],n=_r.internal.getWidth(r)<=_r.internal.getHeight(r)?_r.internal.getWidth(r)/4:_r.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*_r.internal.Bezier_C).toFixed(5)),a=Number((n*_r.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+kA(_r.internal.getWidth(r)/2)+" "+kA(_r.internal.getHeight(r)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),t.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),t.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),t.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+kA(_r.internal.getWidth(r)/2)+" "+kA(_r.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),t.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),t.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),t.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(r){var e=Kl(r);e.scope=r.scope;var t=[],n=_r.internal.getWidth(r)<=_r.internal.getHeight(r)?_r.internal.getWidth(r)/4:_r.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*_r.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+kA(_r.internal.getWidth(r)/2)+" "+kA(_r.internal.getHeight(r)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),t.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),t.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),t.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(r){var e={D:{Off:_r.RadioButton.Cross.OffPushDown},N:{}};return e.N[r]=_r.RadioButton.Cross.YesNormal,e.D[r]=_r.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(r){var e=Kl(r);e.scope=r.scope;var t=[],n=_r.internal.calculateCross(r);return t.push("q"),t.push("1 1 "+Zr(_r.internal.getWidth(r)-2)+" "+Zr(_r.internal.getHeight(r)-2)+" re"),t.push("W"),t.push("n"),t.push(Zr(n.x1.x)+" "+Zr(n.x1.y)+" m"),t.push(Zr(n.x2.x)+" "+Zr(n.x2.y)+" l"),t.push(Zr(n.x4.x)+" "+Zr(n.x4.y)+" m"),t.push(Zr(n.x3.x)+" "+Zr(n.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=Kl(r);e.scope=r.scope;var t=_r.internal.calculateCross(r),n=[];return n.push("0.749023 g"),n.push("0 0 "+Zr(_r.internal.getWidth(r))+" "+Zr(_r.internal.getHeight(r))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Zr(_r.internal.getWidth(r)-2)+" "+Zr(_r.internal.getHeight(r)-2)+" re"),n.push("W"),n.push("n"),n.push(Zr(t.x1.x)+" "+Zr(t.x1.y)+" m"),n.push(Zr(t.x2.x)+" "+Zr(t.x2.y)+" l"),n.push(Zr(t.x4.x)+" "+Zr(t.x4.y)+" m"),n.push(Zr(t.x3.x)+" "+Zr(t.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(r){var e=Kl(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Zr(_r.internal.getWidth(r))+" "+Zr(_r.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(r){var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,t=r.scope.__private__.encodeColorString(r.color);return"/"+e+" "+r.fontSize+" Tf "+t}};_r.internal={Bezier_C:.551915024494,calculateCross:function(r){var e=_r.internal.getWidth(r),t=_r.internal.getHeight(r),n=Math.min(e,t);return{x1:{x:(e-n)/2,y:(t-n)/2+n},x2:{x:(e-n)/2+n,y:(t-n)/2},x3:{x:(e-n)/2,y:(t-n)/2},x4:{x:(e-n)/2+n,y:(t-n)/2+n}}}},_r.internal.getWidth=function(r){var e=0;return Dn(r)==="object"&&(e=FF(r.Rect[2])),e},_r.internal.getHeight=function(r){var e=0;return Dn(r)==="object"&&(e=FF(r.Rect[3])),e};var Cte=Vi.addField=function(r){if(Bte(this,r),!(r instanceof Kc))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=r).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};Vi.AcroFormChoiceField=vf,Vi.AcroFormListBox=bf,Vi.AcroFormComboBox=wf,Vi.AcroFormEditBox=fy,Vi.AcroFormButton=Ps,Vi.AcroFormPushButton=py,Vi.AcroFormRadioButton=xf,Vi.AcroFormCheckBox=my,Vi.AcroFormTextField=jh,Vi.AcroFormPasswordField=yy,Vi.AcroFormAppearance=_r,Vi.AcroForm={ChoiceField:vf,ListBox:bf,ComboBox:wf,EditBox:fy,Button:Ps,PushButton:py,RadioButton:xf,CheckBox:my,TextField:jh,PasswordField:yy,Appearance:_r},qr.AcroForm={ChoiceField:vf,ListBox:bf,ComboBox:wf,EditBox:fy,Button:Ps,PushButton:py,RadioButton:xf,CheckBox:my,TextField:jh,PasswordField:yy,Appearance:_r};function RF(r){return r.reduce(function(e,t,n){return e[t]=n,e},{})}(function(r){r.__addimage__={};var e="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=r.__addimage__.getImageFileTypeByImageData=function(oe,le){var xe,_e,tt,et,nt,Je=e;if((le=le||e)==="RGBA"||oe.data!==void 0&&oe.data instanceof Uint8ClampedArray&&"height"in oe&&"width"in oe)return"RGBA";if(ge(oe))for(nt in t)for(tt=t[nt],xe=0;xe<tt.length;xe+=1){for(et=!0,_e=0;_e<tt[xe].length;_e+=1)if(tt[xe][_e]!==void 0&&tt[xe][_e]!==oe[_e]){et=!1;break}if(et===!0){Je=nt;break}}else for(nt in t)for(tt=t[nt],xe=0;xe<tt.length;xe+=1){for(et=!0,_e=0;_e<tt[xe].length;_e+=1)if(tt[xe][_e]!==void 0&&tt[xe][_e]!==oe.charCodeAt(_e)){et=!1;break}if(et===!0){Je=nt;break}}return Je===e&&le!==e&&(Je=le),Je},i=function oe(le){for(var xe=this.internal.write,_e=this.internal.putStream,tt=(0,this.internal.getFilters)();tt.indexOf("FlateEncode")!==-1;)tt.splice(tt.indexOf("FlateEncode"),1);le.objectId=this.internal.newObject();var et=[];if(et.push({key:"Type",value:"/XObject"}),et.push({key:"Subtype",value:"/Image"}),et.push({key:"Width",value:le.width}),et.push({key:"Height",value:le.height}),le.colorSpace===N.INDEXED?et.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(le.palette.length/3-1)+" "+("sMask"in le&&le.sMask!==void 0?le.objectId+2:le.objectId+1)+" 0 R]"}):(et.push({key:"ColorSpace",value:"/"+le.colorSpace}),le.colorSpace===N.DEVICE_CMYK&&et.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),et.push({key:"BitsPerComponent",value:le.bitsPerComponent}),"decodeParameters"in le&&le.decodeParameters!==void 0&&et.push({key:"DecodeParms",value:"<<"+le.decodeParameters+">>"}),"transparency"in le&&Array.isArray(le.transparency)){for(var nt="",Je=0,it=le.transparency.length;Je<it;Je++)nt+=le.transparency[Je]+" "+le.transparency[Je]+" ";et.push({key:"Mask",value:"["+nt+"]"})}le.sMask!==void 0&&et.push({key:"SMask",value:le.objectId+1+" 0 R"});var ot=le.filter!==void 0?["/"+le.filter]:void 0;if(_e({data:le.data,additionalKeyValues:et,alreadyAppliedFilters:ot,objectId:le.objectId}),xe("endobj"),"sMask"in le&&le.sMask!==void 0){var xt="/Predictor "+le.predictor+" /Colors 1 /BitsPerComponent "+le.bitsPerComponent+" /Columns "+le.width,se={width:le.width,height:le.height,colorSpace:"DeviceGray",bitsPerComponent:le.bitsPerComponent,decodeParameters:xt,data:le.sMask};"filter"in le&&(se.filter=le.filter),oe.call(this,se)}if(le.colorSpace===N.INDEXED){var be=this.internal.newObject();_e({data:fe(new Uint8Array(le.palette)),objectId:be}),xe("endobj")}},s=function(){var oe=this.internal.collections.addImage_images;for(var le in oe)i.call(this,oe[le])},a=function(){var oe,le=this.internal.collections.addImage_images,xe=this.internal.write;for(var _e in le)xe("/I"+(oe=le[_e]).index,oe.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",a))},A=function(){var oe=this.internal.collections.addImage_images;return o.call(this),oe},f=function(){return Object.keys(this.internal.collections.addImage_images).length},m=function(oe){return typeof r["process"+oe.toUpperCase()]=="function"},v=function(oe){return Dn(oe)==="object"&&oe.nodeType===1},x=function(oe,le){if(oe.nodeName==="IMG"&&oe.hasAttribute("src")){var xe=""+oe.getAttribute("src");if(xe.indexOf("data:image/")===0)return Ig(unescape(xe).split("base64,").pop());var _e=r.loadFile(xe,!0);if(_e!==void 0)return _e}if(oe.nodeName==="CANVAS"){if(oe.width===0||oe.height===0)throw new Error("Given canvas must have data. Canvas width: "+oe.width+", height: "+oe.height);var tt;switch(le){case"PNG":tt="image/png";break;case"WEBP":tt="image/webp";break;case"JPEG":case"JPG":default:tt="image/jpeg"}return Ig(oe.toDataURL(tt,1).split("base64,").pop())}},B=function(oe){var le=this.internal.collections.addImage_images;if(le){for(var xe in le)if(oe===le[xe].alias)return le[xe]}},M=function(oe,le,xe){return oe||le||(oe=-96,le=-96),oe<0&&(oe=-1*xe.width*72/oe/this.internal.scaleFactor),le<0&&(le=-1*xe.height*72/le/this.internal.scaleFactor),oe===0&&(oe=le*xe.width/xe.height),le===0&&(le=oe*xe.height/xe.width),[oe,le]},U=function(oe,le,xe,_e,tt,et){var nt=M.call(this,xe,_e,tt),Je=this.internal.getCoordinateString,it=this.internal.getVerticalCoordinateString,ot=A.call(this);if(xe=nt[0],_e=nt[1],ot[tt.index]=tt,et){et*=Math.PI/180;var xt=Math.cos(et),se=Math.sin(et),be=function(De){return De.toFixed(4)},Me=[be(xt),be(se),be(-1*se),be(xt),0,0,"cm"]}this.internal.write("q"),et?(this.internal.write([1,"0","0",1,Je(oe),it(le+_e),"cm"].join(" ")),this.internal.write(Me.join(" ")),this.internal.write([Je(xe),"0","0",Je(_e),"0","0","cm"].join(" "))):this.internal.write([Je(xe),"0","0",Je(_e),Je(oe),it(le+_e),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+tt.index+" Do"),this.internal.write("Q")},N=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var Q=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},q=r.__addimage__.sHashCode=function(oe){var le,xe,_e=0;if(typeof oe=="string")for(xe=oe.length,le=0;le<xe;le++)_e=(_e<<5)-_e+oe.charCodeAt(le),_e|=0;else if(ge(oe))for(xe=oe.byteLength/2,le=0;le<xe;le++)_e=(_e<<5)-_e+oe[le],_e|=0;return _e},Y=r.__addimage__.validateStringAsBase64=function(oe){(oe=oe||"").toString().trim();var le=!0;return oe.length===0&&(le=!1),oe.length%4!=0&&(le=!1),/^[A-Za-z0-9+/]+$/.test(oe.substr(0,oe.length-2))===!1&&(le=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(oe.substr(-2))===!1&&(le=!1),le},te=r.__addimage__.extractImageFromDataUrl=function(oe){var le=(oe=oe||"").split("base64,"),xe=null;if(le.length===2){var _e=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(le[0]);Array.isArray(_e)&&(xe={mimeType:_e[1],charset:_e[2],data:le[1]})}return xe},pe=r.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};r.__addimage__.isArrayBuffer=function(oe){return pe()&&oe instanceof ArrayBuffer};var ge=r.__addimage__.isArrayBufferView=function(oe){return pe()&&typeof Uint32Array<"u"&&(oe instanceof Int8Array||oe instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&oe instanceof Uint8ClampedArray||oe instanceof Int16Array||oe instanceof Uint16Array||oe instanceof Int32Array||oe instanceof Uint32Array||oe instanceof Float32Array||oe instanceof Float64Array)},ye=r.__addimage__.binaryStringToUint8Array=function(oe){for(var le=oe.length,xe=new Uint8Array(le),_e=0;_e<le;_e++)xe[_e]=oe.charCodeAt(_e);return xe},fe=r.__addimage__.arrayBufferToBinaryString=function(oe){for(var le="",xe=ge(oe)?oe:new Uint8Array(oe),_e=0;_e<xe.length;_e+=8192)le+=String.fromCharCode.apply(null,xe.subarray(_e,_e+8192));return le};r.addImage=function(){var oe,le,xe,_e,tt,et,nt,Je,it;if(typeof arguments[1]=="number"?(le=e,xe=arguments[1],_e=arguments[2],tt=arguments[3],et=arguments[4],nt=arguments[5],Je=arguments[6],it=arguments[7]):(le=arguments[1],xe=arguments[2],_e=arguments[3],tt=arguments[4],et=arguments[5],nt=arguments[6],Je=arguments[7],it=arguments[8]),Dn(oe=arguments[0])==="object"&&!v(oe)&&"imageData"in oe){var ot=oe;oe=ot.imageData,le=ot.format||le||e,xe=ot.x||xe||0,_e=ot.y||_e||0,tt=ot.w||ot.width||tt,et=ot.h||ot.height||et,nt=ot.alias||nt,Je=ot.compression||Je,it=ot.rotation||ot.angle||it}var xt=this.internal.getFilters();if(Je===void 0&&xt.indexOf("FlateEncode")!==-1&&(Je="SLOW"),isNaN(xe)||isNaN(_e))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var se=Oe.call(this,oe,le,nt,Je);return U.call(this,xe,_e,tt,et,se,it),this};var Oe=function(oe,le,xe,_e){var tt,et,nt;if(typeof oe=="string"&&n(oe)===e){oe=unescape(oe);var Je=Fe(oe,!1);(Je!==""||(Je=r.loadFile(oe,!0))!==void 0)&&(oe=Je)}if(v(oe)&&(oe=x(oe,le)),le=n(oe,le),!m(le))throw new Error("addImage does not support files of type '"+le+"', please ensure that a plugin for '"+le+"' support is added.");if(((nt=xe)==null||nt.length===0)&&(xe=function(it){return typeof it=="string"||ge(it)?q(it):ge(it.data)?q(it.data):null}(oe)),(tt=B.call(this,xe))||(pe()&&(oe instanceof Uint8Array||le==="RGBA"||(et=oe,oe=ye(oe))),tt=this["process"+le.toUpperCase()](oe,f.call(this),xe,function(it){return it&&typeof it=="string"&&(it=it.toUpperCase()),it in r.image_compression?it:Q.NONE}(_e),et)),!tt)throw new Error("An unknown error occurred whilst processing the image.");return tt},Fe=r.__addimage__.convertBase64ToBinaryString=function(oe,le){var xe;le=typeof le!="boolean"||le;var _e,tt="";if(typeof oe=="string"){_e=(xe=te(oe))!==null?xe.data:oe;try{tt=Ig(_e)}catch(et){if(le)throw Y(_e)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+et.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return tt};r.getImageProperties=function(oe){var le,xe,_e="";if(v(oe)&&(oe=x(oe)),typeof oe=="string"&&n(oe)===e&&((_e=Fe(oe,!1))===""&&(_e=r.loadFile(oe)||""),oe=_e),xe=n(oe),!m(xe))throw new Error("addImage does not support files of type '"+xe+"', please ensure that a plugin for '"+xe+"' support is added.");if(!pe()||oe instanceof Uint8Array||(oe=ye(oe)),!(le=this["process"+xe.toUpperCase()](oe)))throw new Error("An unknown error occurred whilst processing the image");return le.fileType=xe,le}})(qr.API),function(r){var e=function(t){if(t!==void 0&&t!="")return!0};qr.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(t){for(var n,i,s,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,A=this.internal.getPageInfoByObjId(t.objId),f=t.pageContext.annotations,m=!1,v=0;v<f.length&&!m;v++)switch((n=f[v]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(m=!0);break;case"reference":case"text":case"freetext":m=!0}if(m!=0){this.internal.write("/Annots [");for(var x=0;x<f.length;x++){n=f[x];var B=this.internal.pdfEscape,M=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var U=this.internal.newAdditionalObject(),N=this.internal.newAdditionalObject(),Q=this.internal.getEncryptor(U.objId),q=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+B(Q(n.contents))+")",s+=" /Popup "+N.objId+" 0 R",s+=" /P "+A.objId+" 0 R",s+=" /T ("+B(Q(q))+") >>",U.content=s;var Y=U.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+a(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+Y,n.open&&(s+=" /Open true"),s+=" >>",N.content=s,this.internal.write(U.objId,"0 R",N.objId,"0 R");break;case"freetext":i="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var te=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+B(M(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+te+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var pe=this.annotations._nameMap[n.options.name];n.options.pageNumber=pe.page,n.options.top=pe.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+B(M(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var ge=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+ge+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),r.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},r.link=function(t,n,i,s,a){var o=this.internal.getCurrentPageInfo(),A=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:A(t),y:f(n),w:A(t+i),h:f(n+s)},options:a,type:"link"})},r.textWithLink=function(t,n,i,s){var a,o,A=this.getTextWidth(t),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){o=s.maxWidth;var m=this.splitTextToSize(t,o).length;a=Math.ceil(f*m)}else o=A,a=f;return this.text(t,n,i,s),i+=.2*f,s.align==="center"&&(n-=A/2),s.align==="right"&&(n-=A),this.link(n,i-f,o,a,s),A},r.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}}(qr.API),function(r){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];r.__arabicParser__={};var s=r.__arabicParser__.isInArabicSubstitutionA=function(U){return e[U.charCodeAt(0)]!==void 0},a=r.__arabicParser__.isArabicLetter=function(U){return typeof U=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(U)},o=r.__arabicParser__.isArabicEndLetter=function(U){return a(U)&&s(U)&&e[U.charCodeAt(0)].length<=2},A=r.__arabicParser__.isArabicAlfLetter=function(U){return a(U)&&i.indexOf(U.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(U){return a(U)&&s(U)&&e[U.charCodeAt(0)].length>=1};var f=r.__arabicParser__.arabicLetterHasFinalForm=function(U){return a(U)&&s(U)&&e[U.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(U){return a(U)&&s(U)&&e[U.charCodeAt(0)].length>=3};var m=r.__arabicParser__.arabicLetterHasMedialForm=function(U){return a(U)&&s(U)&&e[U.charCodeAt(0)].length==4},v=r.__arabicParser__.resolveLigatures=function(U){var N=0,Q=t,q="",Y=0;for(N=0;N<U.length;N+=1)Q[U.charCodeAt(N)]!==void 0?(Y++,typeof(Q=Q[U.charCodeAt(N)])=="number"&&(q+=String.fromCharCode(Q),Q=t,Y=0),N===U.length-1&&(Q=t,q+=U.charAt(N-(Y-1)),N-=Y-1,Y=0)):(Q=t,q+=U.charAt(N-Y),N-=Y,Y=0);return q};r.__arabicParser__.isArabicDiacritic=function(U){return U!==void 0&&n[U.charCodeAt(0)]!==void 0};var x=r.__arabicParser__.getCorrectForm=function(U,N,Q){return a(U)?s(U)===!1?-1:!f(U)||!a(N)&&!a(Q)||!a(Q)&&o(N)||o(U)&&!a(N)||o(U)&&A(N)||o(U)&&o(N)?0:m(U)&&a(N)&&!o(N)&&a(Q)&&f(Q)?3:o(U)||!a(Q)?1:2:-1},B=function(U){var N=0,Q=0,q=0,Y="",te="",pe="",ge=(U=U||"").split("\\s+"),ye=[];for(N=0;N<ge.length;N+=1){for(ye.push(""),Q=0;Q<ge[N].length;Q+=1)Y=ge[N][Q],te=ge[N][Q-1],pe=ge[N][Q+1],a(Y)?(q=x(Y,te,pe),ye[N]+=q!==-1?String.fromCharCode(e[Y.charCodeAt(0)][q]):Y):ye[N]+=Y;ye[N]=v(ye[N])}return ye.join(" ")},M=r.__arabicParser__.processArabic=r.processArabic=function(){var U,N=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,Q=[];if(Array.isArray(N)){var q=0;for(Q=[],q=0;q<N.length;q+=1)Array.isArray(N[q])?Q.push([B(N[q][0]),N[q][1],N[q][2]]):Q.push([B(N[q])]);U=Q}else U=B(N);return typeof arguments[0]=="string"?U:(arguments[0].text=U,arguments[0])};r.events.push(["preProcessText",M])}(qr.API),qr.API.autoPrint=function(r){var e;switch((r=r||{}).variant=r.variant||"non-conform",r.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(r){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(o){t=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(o){s=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,n){var i;if((t=t||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(qr.API),function(r){var e={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var A=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return A},set:function(U){A=U}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function(U){f=U}});var m=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return m},set:function(U){m=U}});var v=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return v},set:function(U){v=U}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(U){x=U}});var B=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return B},set:function(U){B=U}});var M=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return M},set:function(U){M=U}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(A){return n.call(this),this.internal.__cell__.headerFunction=typeof A=="function"?A:void 0,this},r.getTextDimensions=function(A,f){n.call(this);var m=(f=f||{}).fontSize||this.getFontSize(),v=f.font||this.getFont(),x=f.scaleFactor||this.internal.scaleFactor,B=0,M=0,U=0,N=this;if(!Array.isArray(A)&&typeof A!="string"){if(typeof A!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");A=String(A)}var Q=f.maxWidth;Q>0?typeof A=="string"?A=this.splitTextToSize(A,Q):Object.prototype.toString.call(A)==="[object Array]"&&(A=A.reduce(function(Y,te){return Y.concat(N.splitTextToSize(te,Q))},[])):A=Array.isArray(A)?A:[A];for(var q=0;q<A.length;q++)B<(U=this.getStringUnitWidth(A[q],{font:v})*m)&&(B=U);return B!==0&&(M=A.length),{w:B/=x,h:Math.max((M*m*this.getLineHeightFactor()-m*(this.getLineHeightFactor()-1))/x,0)}},r.cellAddPage=function(){n.call(this),this.addPage();var A=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(A.left,A.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=r.cell=function(){var A;A=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var f=this.internal.__cell__.lastCell,m=this.internal.__cell__.padding,v=this.internal.__cell__.margins||e,x=this.internal.__cell__.tableHeaderRow,B=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===A.lineNumber?(A.x=(f.x||0)+(f.width||0),A.y=f.y||0):f.y+f.height+A.height+v.bottom>this.getPageHeight()?(this.cellAddPage(),A.y=v.top,B&&x&&(this.printHeaderRow(A.lineNumber,!0),A.y+=x[0].height)):A.y=f.y+f.height||A.y),A.text[0]!==void 0&&(this.rect(A.x,A.y,A.width,A.height,t===!0?"FD":void 0),A.align==="right"?this.text(A.text,A.x+A.width-m,A.y+m,{align:"right",baseline:"top"}):A.align==="center"?this.text(A.text,A.x+A.width/2,A.y+m,{align:"center",baseline:"top",maxWidth:A.width-m-m}):this.text(A.text,A.x+m,A.y+m,{align:"left",baseline:"top",maxWidth:A.width-m-m})),this.internal.__cell__.lastCell=A,this};r.table=function(A,f,m,v,x){if(n.call(this),!m)throw new Error("No data for PDF table.");var B,M,U,N,Q=[],q=[],Y=[],te={},pe={},ge=[],ye=[],fe=(x=x||{}).autoSize||!1,Oe=x.printHeaders!==!1,Fe=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,oe=x.margins||Object.assign({width:this.getPageWidth()},e),le=typeof x.padding=="number"?x.padding:3,xe=x.headerBackgroundColor||"#c8c8c8",_e=x.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=Oe,this.internal.__cell__.margins=oe,this.internal.__cell__.table_font_size=Fe,this.internal.__cell__.padding=le,this.internal.__cell__.headerBackgroundColor=xe,this.internal.__cell__.headerTextColor=_e,this.setFontSize(Fe),v==null)q=Q=Object.keys(m[0]),Y=Q.map(function(){return"left"});else if(Array.isArray(v)&&Dn(v[0])==="object")for(Q=v.map(function(ot){return ot.name}),q=v.map(function(ot){return ot.prompt||ot.name||""}),Y=v.map(function(ot){return ot.align||"left"}),B=0;B<v.length;B+=1)pe[v[B].name]=v[B].width*(19.049976/25.4);else Array.isArray(v)&&typeof v[0]=="string"&&(q=Q=v,Y=Q.map(function(){return"left"}));if(fe||Array.isArray(v)&&typeof v[0]=="string")for(B=0;B<Q.length;B+=1){for(te[N=Q[B]]=m.map(function(ot){return ot[N]}),this.setFont(void 0,"bold"),ge.push(this.getTextDimensions(q[B],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),M=te[N],this.setFont(void 0,"normal"),U=0;U<M.length;U+=1)ge.push(this.getTextDimensions(M[U],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);pe[N]=Math.max.apply(null,ge)+le+le,ge=[]}if(Oe){var tt={};for(B=0;B<Q.length;B+=1)tt[Q[B]]={},tt[Q[B]].text=q[B],tt[Q[B]].align=Y[B];var et=o.call(this,tt,pe);ye=Q.map(function(ot){return new s(A,f,pe[ot],et,tt[ot].text,void 0,tt[ot].align)}),this.setTableHeaderRow(ye),this.printHeaderRow(1,!1)}var nt=v.reduce(function(ot,xt){return ot[xt.name]=xt.align,ot},{});for(B=0;B<m.length;B+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:B,data:m[B]},this);var Je=o.call(this,m[B],pe);for(U=0;U<Q.length;U+=1){var it=m[B][Q[U]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:B,col:U,data:it},this),a.call(this,new s(A,f,pe[Q[U]],Je,it,B+2,nt[Q[U]]))}}return this.internal.__cell__.table_x=A,this.internal.__cell__.table_y=f,this};var o=function(A,f){var m=this.internal.__cell__.padding,v=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(A).map(function(B){var M=A[B];return this.splitTextToSize(M.hasOwnProperty("text")?M.text:M,f[B]-m-m)},this).map(function(B){return this.getLineHeightFactor()*B.length*v/x+m+m},this).reduce(function(B,M){return Math.max(B,M)},0)};r.setTableHeaderRow=function(A){n.call(this),this.internal.__cell__.tableHeaderRow=A},r.printHeaderRow=function(A,f){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var m;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var v=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(v[0],v[1],v[2],v[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],B=0;B<this.internal.__cell__.tableHeaderRow.length;B+=1){m=this.internal.__cell__.tableHeaderRow[B].clone(),f&&(m.y=this.internal.__cell__.margins.top||0,x.push(m)),m.lineNumber=A;var M=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,m),this.setTextColor(M)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),t=!1}}(qr.API);var OF={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},DF=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],v2=RF(DF),kF=[100,200,300,400,500,600,700,800,900],Ete=RF(kF);function b2(r){var e=r.family.replace(/"|'/g,"").toLowerCase(),t=function(s){return OF[s=s||"normal"]?s:"normal"}(r.style),n=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(r.weight),i=function(s){return typeof v2[s=s||"normal"]=="number"?s:"normal"}(r.stretch);return{family:e,style:t,weight:n,stretch:i,src:r.src||[],ref:r.ref||{name:e,style:[i,t,n].join(" ")}}}function NF(r,e,t,n){var i;for(i=t;i>=0&&i<e.length;i+=n)if(r[e[i]])return r[e[i]];for(i=t;i>=0&&i<e.length;i-=n)if(r[e[i]])return r[e[i]]}var Ste={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},QF={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function HF(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function Tte(r,e,t){for(var n=(t=t||{}).defaultFontFamily||"times",i=Object.assign({},Ste,t.genericFontFamilies||{}),s=null,a=null,o=0;o<e.length;++o)if(i[(s=b2(e[o])).family]&&(s.family=i[s.family]),r.hasOwnProperty(s.family)){a=r[s.family];break}if(!(a=a||r[n]))throw new Error("Could not find a font-family for the rule '"+HF(s)+"' and default family '"+n+"'.");if(a=function(A,f){if(f[A])return f[A];var m=v2[A],v=m<=v2.normal?-1:1,x=NF(f,DF,m,v);if(!x)throw new Error("Could not find a matching font-stretch value for "+A);return x}(s.stretch,a),a=function(A,f){if(f[A])return f[A];for(var m=OF[A],v=0;v<m.length;++v)if(f[m[v]])return f[m[v]];throw new Error("Could not find a matching font-style for "+A)}(s.style,a),!(a=function(A,f){if(f[A])return f[A];if(A===400&&f[500])return f[500];if(A===500&&f[400])return f[400];var m=Ete[A],v=NF(f,kF,m,A<400?-1:1);if(!v)throw new Error("Could not find a matching font-weight for value "+A);return v}(s.weight,a)))throw new Error("Failed to resolve a font for the rule '"+HF(s)+"'.");return a}function zF(r){return r.trimLeft()}function Ite(r,e){for(var t=0;t<r.length;){if(r.charAt(t)===e)return[r.substring(0,t),r.substring(t+1)];t+=1}return null}function Lte(r){var e=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],r.substring(e[0].length)]}var _y,GF,VF,jF=["times"];(function(r){var e,t,n,i,s,a,o,A,f,m=function(se){return se=se||{},this.isStrokeTransparent=se.isStrokeTransparent||!1,this.strokeOpacity=se.strokeOpacity||1,this.strokeStyle=se.strokeStyle||"#000000",this.fillStyle=se.fillStyle||"#000000",this.isFillTransparent=se.isFillTransparent||!1,this.fillOpacity=se.fillOpacity||1,this.font=se.font||"10px sans-serif",this.textBaseline=se.textBaseline||"alphabetic",this.textAlign=se.textAlign||"left",this.lineWidth=se.lineWidth||1,this.lineJoin=se.lineJoin||"miter",this.lineCap=se.lineCap||"butt",this.path=se.path||[],this.transform=se.transform!==void 0?se.transform.clone():new A,this.globalCompositeOperation=se.globalCompositeOperation||"normal",this.globalAlpha=se.globalAlpha||1,this.clip_path=se.clip_path||[],this.currentPoint=se.currentPoint||new a,this.miterLimit=se.miterLimit||10,this.lastPoint=se.lastPoint||new a,this.lineDashOffset=se.lineDashOffset||0,this.lineDash=se.lineDash||[],this.margin=se.margin||[0,0,0,0],this.prevPageLastElemOffset=se.prevPageLastElemOffset||0,this.ignoreClearRect=typeof se.ignoreClearRect!="boolean"||se.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new v(this),e=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,A=this.internal.Matrix,f=new m}]);var v=function(se){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var be=se;Object.defineProperty(this,"pdf",{get:function(){return be}});var Me=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Me},set:function(mt){Me=!!mt}});var De=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return De},set:function(mt){De=!!mt}});var $e=0;Object.defineProperty(this,"posX",{get:function(){return $e},set:function(mt){isNaN(mt)||($e=mt)}});var qe=0;Object.defineProperty(this,"posY",{get:function(){return qe},set:function(mt){isNaN(mt)||(qe=mt)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(mt){var Re;typeof mt=="number"?Re=[mt,mt,mt,mt]:((Re=new Array(4))[0]=mt[0],Re[1]=mt.length>=2?mt[1]:Re[0],Re[2]=mt.length>=3?mt[2]:Re[0],Re[3]=mt.length>=4?mt[3]:Re[1]),f.margin=Re}});var ct=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ct},set:function(mt){ct=mt}});var st=0;Object.defineProperty(this,"lastBreak",{get:function(){return st},set:function(mt){st=mt}});var Ct=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ct},set:function(mt){Ct=mt}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(mt){mt instanceof m&&(f=mt)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(mt){f.path=mt}});var It=[];Object.defineProperty(this,"ctxStack",{get:function(){return It},set:function(mt){It=mt}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(mt){var Re;Re=x(mt),this.ctx.fillStyle=Re.style,this.ctx.isFillTransparent=Re.a===0,this.ctx.fillOpacity=Re.a,this.pdf.setFillColor(Re.r,Re.g,Re.b,{a:Re.a}),this.pdf.setTextColor(Re.r,Re.g,Re.b,{a:Re.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(mt){var Re=x(mt);this.ctx.strokeStyle=Re.style,this.ctx.isStrokeTransparent=Re.a===0,this.ctx.strokeOpacity=Re.a,Re.a===0?this.pdf.setDrawColor(255,255,255):(Re.a,this.pdf.setDrawColor(Re.r,Re.g,Re.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(mt){["butt","round","square"].indexOf(mt)!==-1&&(this.ctx.lineCap=mt,this.pdf.setLineCap(mt))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(mt){isNaN(mt)||(this.ctx.lineWidth=mt,this.pdf.setLineWidth(mt))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(mt){["bevel","round","miter"].indexOf(mt)!==-1&&(this.ctx.lineJoin=mt,this.pdf.setLineJoin(mt))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(mt){isNaN(mt)||(this.ctx.miterLimit=mt,this.pdf.setMiterLimit(mt))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(mt){this.ctx.textBaseline=mt}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(mt){["right","end","center","left","start"].indexOf(mt)!==-1&&(this.ctx.textAlign=mt)}});var Qt=null;function Ht(mt,Re){if(Qt===null){var Ye=function(tr){var St=[];return Object.keys(tr).forEach(function(vt){tr[vt].forEach(function(Bt){var kt=null;switch(Bt){case"bold":kt={family:vt,weight:"bold"};break;case"italic":kt={family:vt,style:"italic"};break;case"bolditalic":kt={family:vt,weight:"bold",style:"italic"};break;case"":case"normal":kt={family:vt}}kt!==null&&(kt.ref={name:vt,style:Bt},St.push(kt))})}),St}(mt.getFontList());Qt=function(tr){for(var St={},vt=0;vt<tr.length;++vt){var Bt=b2(tr[vt]),kt=Bt.family,ir=Bt.stretch,Ar=Bt.style,Lr=Bt.weight;St[kt]=St[kt]||{},St[kt][ir]=St[kt][ir]||{},St[kt][ir][Ar]=St[kt][ir][Ar]||{},St[kt][ir][Ar][Lr]=Bt}return St}(Ye.concat(Re))}return Qt}var zt=null;Object.defineProperty(this,"fontFaces",{get:function(){return zt},set:function(mt){Qt=null,zt=mt}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(mt){var Re;if(this.ctx.font=mt,(Re=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(mt))!==null){var Ye=Re[1],tr=(Re[2],Re[3]),St=Re[4],vt=(Re[5],Re[6]),Bt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(St)[2];St=Math.floor(Bt==="px"?parseFloat(St)*this.pdf.internal.scaleFactor:Bt==="em"?parseFloat(St)*this.pdf.getFontSize():parseFloat(St)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(St);var kt=function(pt){var Ir,Dt,xn=[],Mr=pt.trim();if(Mr==="")return jF;if(Mr in QF)return[QF[Mr]];for(;Mr!=="";){switch(Dt=null,Ir=(Mr=zF(Mr)).charAt(0)){case'"':case"'":Dt=Ite(Mr.substring(1),Ir);break;default:Dt=Lte(Mr)}if(Dt===null||(xn.push(Dt[0]),(Mr=zF(Dt[1]))!==""&&Mr.charAt(0)!==","))return jF;Mr=Mr.replace(/^,/,"")}return xn}(vt);if(this.fontFaces){var ir=Tte(Ht(this.pdf,this.fontFaces),kt.map(function(pt){return{family:pt,stretch:"normal",weight:tr,style:Ye}}));this.pdf.setFont(ir.ref.name,ir.ref.style)}else{var Ar="";(tr==="bold"||parseInt(tr,10)>=700||Ye==="bold")&&(Ar="bold"),Ye==="italic"&&(Ar+="italic"),Ar.length===0&&(Ar="normal");for(var Lr="",Tr={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},kr=0;kr<kt.length;kr++){if(this.pdf.internal.getFont(kt[kr],Ar,{noFallback:!0,disableWarning:!0})!==void 0){Lr=kt[kr];break}if(Ar==="bolditalic"&&this.pdf.internal.getFont(kt[kr],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Lr=kt[kr],Ar="bold";else if(this.pdf.internal.getFont(kt[kr],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Lr=kt[kr],Ar="normal";break}}if(Lr===""){for(var Qr=0;Qr<kt.length;Qr++)if(Tr[kt[Qr]]){Lr=Tr[kt[Qr]];break}}Lr=Lr===""?"Times":Lr,this.pdf.setFont(Lr,Ar)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(mt){this.ctx.globalCompositeOperation=mt}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(mt){this.ctx.globalAlpha=mt}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(mt){this.ctx.lineDashOffset=mt,xt.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(mt){this.ctx.lineDash=mt,xt.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(mt){this.ctx.ignoreClearRect=!!mt}})};v.prototype.setLineDash=function(se){this.lineDash=se},v.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},v.prototype.fill=function(){te.call(this,"fill",!1)},v.prototype.stroke=function(){te.call(this,"stroke",!1)},v.prototype.beginPath=function(){this.path=[{type:"begin"}]},v.prototype.moveTo=function(se,be){if(isNaN(se)||isNaN(be))throw li.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Me=this.ctx.transform.applyToPoint(new a(se,be));this.path.push({type:"mt",x:Me.x,y:Me.y}),this.ctx.lastPoint=new a(se,be)},v.prototype.closePath=function(){var se=new a(0,0),be=0;for(be=this.path.length-1;be!==-1;be--)if(this.path[be].type==="begin"&&Dn(this.path[be+1])==="object"&&typeof this.path[be+1].x=="number"){se=new a(this.path[be+1].x,this.path[be+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(se.x,se.y)},v.prototype.lineTo=function(se,be){if(isNaN(se)||isNaN(be))throw li.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Me=this.ctx.transform.applyToPoint(new a(se,be));this.path.push({type:"lt",x:Me.x,y:Me.y}),this.ctx.lastPoint=new a(Me.x,Me.y)},v.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),te.call(this,null,!0)},v.prototype.quadraticCurveTo=function(se,be,Me,De){if(isNaN(Me)||isNaN(De)||isNaN(se)||isNaN(be))throw li.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var $e=this.ctx.transform.applyToPoint(new a(Me,De)),qe=this.ctx.transform.applyToPoint(new a(se,be));this.path.push({type:"qct",x1:qe.x,y1:qe.y,x:$e.x,y:$e.y}),this.ctx.lastPoint=new a($e.x,$e.y)},v.prototype.bezierCurveTo=function(se,be,Me,De,$e,qe){if(isNaN($e)||isNaN(qe)||isNaN(se)||isNaN(be)||isNaN(Me)||isNaN(De))throw li.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ct=this.ctx.transform.applyToPoint(new a($e,qe)),st=this.ctx.transform.applyToPoint(new a(se,be)),Ct=this.ctx.transform.applyToPoint(new a(Me,De));this.path.push({type:"bct",x1:st.x,y1:st.y,x2:Ct.x,y2:Ct.y,x:ct.x,y:ct.y}),this.ctx.lastPoint=new a(ct.x,ct.y)},v.prototype.arc=function(se,be,Me,De,$e,qe){if(isNaN(se)||isNaN(be)||isNaN(Me)||isNaN(De)||isNaN($e))throw li.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(qe=!!qe,!this.ctx.transform.isIdentity){var ct=this.ctx.transform.applyToPoint(new a(se,be));se=ct.x,be=ct.y;var st=this.ctx.transform.applyToPoint(new a(0,Me)),Ct=this.ctx.transform.applyToPoint(new a(0,0));Me=Math.sqrt(Math.pow(st.x-Ct.x,2)+Math.pow(st.y-Ct.y,2))}Math.abs($e-De)>=2*Math.PI&&(De=0,$e=2*Math.PI),this.path.push({type:"arc",x:se,y:be,radius:Me,startAngle:De,endAngle:$e,counterclockwise:qe})},v.prototype.arcTo=function(se,be,Me,De,$e){throw new Error("arcTo not implemented.")},v.prototype.rect=function(se,be,Me,De){if(isNaN(se)||isNaN(be)||isNaN(Me)||isNaN(De))throw li.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(se,be),this.lineTo(se+Me,be),this.lineTo(se+Me,be+De),this.lineTo(se,be+De),this.lineTo(se,be),this.lineTo(se+Me,be),this.lineTo(se,be)},v.prototype.fillRect=function(se,be,Me,De){if(isNaN(se)||isNaN(be)||isNaN(Me)||isNaN(De))throw li.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!B.call(this)){var $e={};this.lineCap!=="butt"&&($e.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&($e.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(se,be,Me,De),this.fill(),$e.hasOwnProperty("lineCap")&&(this.lineCap=$e.lineCap),$e.hasOwnProperty("lineJoin")&&(this.lineJoin=$e.lineJoin)}},v.prototype.strokeRect=function(se,be,Me,De){if(isNaN(se)||isNaN(be)||isNaN(Me)||isNaN(De))throw li.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");M.call(this)||(this.beginPath(),this.rect(se,be,Me,De),this.stroke())},v.prototype.clearRect=function(se,be,Me,De){if(isNaN(se)||isNaN(be)||isNaN(Me)||isNaN(De))throw li.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(se,be,Me,De))},v.prototype.save=function(se){se=typeof se!="boolean"||se;for(var be=this.pdf.internal.getCurrentPageInfo().pageNumber,Me=0;Me<this.pdf.internal.getNumberOfPages();Me++)this.pdf.setPage(Me+1),this.pdf.internal.out("q");if(this.pdf.setPage(be),se){this.ctx.fontSize=this.pdf.internal.getFontSize();var De=new m(this.ctx);this.ctxStack.push(this.ctx),this.ctx=De}},v.prototype.restore=function(se){se=typeof se!="boolean"||se;for(var be=this.pdf.internal.getCurrentPageInfo().pageNumber,Me=0;Me<this.pdf.internal.getNumberOfPages();Me++)this.pdf.setPage(Me+1),this.pdf.internal.out("Q");this.pdf.setPage(be),se&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},v.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(se){var be,Me,De,$e;if(se.isCanvasGradient===!0&&(se=se.getColor()),!se)return{r:0,g:0,b:0,a:0,style:se};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(se))be=0,Me=0,De=0,$e=0;else{var qe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(se);if(qe!==null)be=parseInt(qe[1]),Me=parseInt(qe[2]),De=parseInt(qe[3]),$e=1;else if((qe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(se))!==null)be=parseInt(qe[1]),Me=parseInt(qe[2]),De=parseInt(qe[3]),$e=parseFloat(qe[4]);else{if($e=1,typeof se=="string"&&se.charAt(0)!=="#"){var ct=new CF(se);se=ct.ok?ct.toHex():"#000000"}se.length===4?(be=se.substring(1,2),be+=be,Me=se.substring(2,3),Me+=Me,De=se.substring(3,4),De+=De):(be=se.substring(1,3),Me=se.substring(3,5),De=se.substring(5,7)),be=parseInt(be,16),Me=parseInt(Me,16),De=parseInt(De,16)}}return{r:be,g:Me,b:De,a:$e,style:se}},B=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},M=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};v.prototype.fillText=function(se,be,Me,De){if(isNaN(be)||isNaN(Me)||typeof se!="string")throw li.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(De=isNaN(De)?void 0:De,!B.call(this)){var $e=Je(this.ctx.transform.rotation),qe=this.ctx.transform.scaleX;le.call(this,{text:se,x:be,y:Me,scale:qe,angle:$e,align:this.textAlign,maxWidth:De})}},v.prototype.strokeText=function(se,be,Me,De){if(isNaN(be)||isNaN(Me)||typeof se!="string")throw li.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!M.call(this)){De=isNaN(De)?void 0:De;var $e=Je(this.ctx.transform.rotation),qe=this.ctx.transform.scaleX;le.call(this,{text:se,x:be,y:Me,scale:qe,renderingMode:"stroke",angle:$e,align:this.textAlign,maxWidth:De})}},v.prototype.measureText=function(se){if(typeof se!="string")throw li.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var be=this.pdf,Me=this.pdf.internal.scaleFactor,De=be.internal.getFontSize(),$e=be.getStringUnitWidth(se)*De/be.internal.scaleFactor,qe=function(ct){var st=(ct=ct||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return st}}),this};return new qe({width:$e*=Math.round(96*Me/72*1e4)/1e4})},v.prototype.scale=function(se,be){if(isNaN(se)||isNaN(be))throw li.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Me=new A(se,0,0,be,0,0);this.ctx.transform=this.ctx.transform.multiply(Me)},v.prototype.rotate=function(se){if(isNaN(se))throw li.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var be=new A(Math.cos(se),Math.sin(se),-Math.sin(se),Math.cos(se),0,0);this.ctx.transform=this.ctx.transform.multiply(be)},v.prototype.translate=function(se,be){if(isNaN(se)||isNaN(be))throw li.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Me=new A(1,0,0,1,se,be);this.ctx.transform=this.ctx.transform.multiply(Me)},v.prototype.transform=function(se,be,Me,De,$e,qe){if(isNaN(se)||isNaN(be)||isNaN(Me)||isNaN(De)||isNaN($e)||isNaN(qe))throw li.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ct=new A(se,be,Me,De,$e,qe);this.ctx.transform=this.ctx.transform.multiply(ct)},v.prototype.setTransform=function(se,be,Me,De,$e,qe){se=isNaN(se)?1:se,be=isNaN(be)?0:be,Me=isNaN(Me)?0:Me,De=isNaN(De)?1:De,$e=isNaN($e)?0:$e,qe=isNaN(qe)?0:qe,this.ctx.transform=new A(se,be,Me,De,$e,qe)};var U=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};v.prototype.drawImage=function(se,be,Me,De,$e,qe,ct,st,Ct){var It=this.pdf.getImageProperties(se),Qt=1,Ht=1,zt=1,mt=1;De!==void 0&&st!==void 0&&(zt=st/De,mt=Ct/$e,Qt=It.width/De*st/De,Ht=It.height/$e*Ct/$e),qe===void 0&&(qe=be,ct=Me,be=0,Me=0),De!==void 0&&st===void 0&&(st=De,Ct=$e),De===void 0&&st===void 0&&(st=It.width,Ct=It.height);for(var Re,Ye=this.ctx.transform.decompose(),tr=Je(Ye.rotate.shx),St=new A,vt=(St=(St=(St=St.multiply(Ye.translate)).multiply(Ye.skew)).multiply(Ye.scale)).applyToRectangle(new o(qe-be*zt,ct-Me*mt,De*Qt,$e*Ht)),Bt=N.call(this,vt),kt=[],ir=0;ir<Bt.length;ir+=1)kt.indexOf(Bt[ir])===-1&&kt.push(Bt[ir]);if(Y(kt),this.autoPaging)for(var Ar=kt[0],Lr=kt[kt.length-1],Tr=Ar;Tr<Lr+1;Tr++){this.pdf.setPage(Tr);var kr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Qr=Tr===1?this.posY+this.margin[0]:this.margin[0],pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ir=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Dt=Tr===1?0:pt+(Tr-2)*Ir;if(this.ctx.clip_path.length!==0){var xn=this.path;Re=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=q(Re,this.posX+this.margin[3],-Dt+Qr+this.ctx.prevPageLastElemOffset),pe.call(this,"fill",!0),this.path=xn}var Mr=JSON.parse(JSON.stringify(vt));Mr=q([Mr],this.posX+this.margin[3],-Dt+Qr+this.ctx.prevPageLastElemOffset)[0];var Tt=(Tr>Ar||Tr<Lr)&&U.call(this);Tt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],kr,Ir,null).clip().discardPath()),this.pdf.addImage(se,"JPEG",Mr.x,Mr.y,Mr.w,Mr.h,null,null,tr),Tt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(se,"JPEG",vt.x,vt.y,vt.w,vt.h,null,null,tr)};var N=function(se,be,Me){var De=[];be=be||this.pdf.internal.pageSize.width,Me=Me||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var $e=this.posY+this.ctx.prevPageLastElemOffset;switch(se.type){default:case"mt":case"lt":De.push(Math.floor((se.y+$e)/Me)+1);break;case"arc":De.push(Math.floor((se.y+$e-se.radius)/Me)+1),De.push(Math.floor((se.y+$e+se.radius)/Me)+1);break;case"qct":var qe=it(this.ctx.lastPoint.x,this.ctx.lastPoint.y,se.x1,se.y1,se.x,se.y);De.push(Math.floor((qe.y+$e)/Me)+1),De.push(Math.floor((qe.y+qe.h+$e)/Me)+1);break;case"bct":var ct=ot(this.ctx.lastPoint.x,this.ctx.lastPoint.y,se.x1,se.y1,se.x2,se.y2,se.x,se.y);De.push(Math.floor((ct.y+$e)/Me)+1),De.push(Math.floor((ct.y+ct.h+$e)/Me)+1);break;case"rect":De.push(Math.floor((se.y+$e)/Me)+1),De.push(Math.floor((se.y+se.h+$e)/Me)+1)}for(var st=0;st<De.length;st+=1)for(;this.pdf.internal.getNumberOfPages()<De[st];)Q.call(this);return De},Q=function(){var se=this.fillStyle,be=this.strokeStyle,Me=this.font,De=this.lineCap,$e=this.lineWidth,qe=this.lineJoin;this.pdf.addPage(),this.fillStyle=se,this.strokeStyle=be,this.font=Me,this.lineCap=De,this.lineWidth=$e,this.lineJoin=qe},q=function(se,be,Me){for(var De=0;De<se.length;De++)switch(se[De].type){case"bct":se[De].x2+=be,se[De].y2+=Me;case"qct":se[De].x1+=be,se[De].y1+=Me;case"mt":case"lt":case"arc":default:se[De].x+=be,se[De].y+=Me}return se},Y=function(se){return se.sort(function(be,Me){return be-Me})},te=function(se,be){for(var Me,De,$e=this.fillStyle,qe=this.strokeStyle,ct=this.lineCap,st=this.lineWidth,Ct=Math.abs(st*this.ctx.transform.scaleX),It=this.lineJoin,Qt=JSON.parse(JSON.stringify(this.path)),Ht=JSON.parse(JSON.stringify(this.path)),zt=[],mt=0;mt<Ht.length;mt++)if(Ht[mt].x!==void 0)for(var Re=N.call(this,Ht[mt]),Ye=0;Ye<Re.length;Ye+=1)zt.indexOf(Re[Ye])===-1&&zt.push(Re[Ye]);for(var tr=0;tr<zt.length;tr++)for(;this.pdf.internal.getNumberOfPages()<zt[tr];)Q.call(this);if(Y(zt),this.autoPaging)for(var St=zt[0],vt=zt[zt.length-1],Bt=St;Bt<vt+1;Bt++){this.pdf.setPage(Bt),this.fillStyle=$e,this.strokeStyle=qe,this.lineCap=ct,this.lineWidth=Ct,this.lineJoin=It;var kt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ir=Bt===1?this.posY+this.margin[0]:this.margin[0],Ar=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Lr=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Tr=Bt===1?0:Ar+(Bt-2)*Lr;if(this.ctx.clip_path.length!==0){var kr=this.path;Me=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=q(Me,this.posX+this.margin[3],-Tr+ir+this.ctx.prevPageLastElemOffset),pe.call(this,se,!0),this.path=kr}if(De=JSON.parse(JSON.stringify(Qt)),this.path=q(De,this.posX+this.margin[3],-Tr+ir+this.ctx.prevPageLastElemOffset),be===!1||Bt===0){var Qr=(Bt>St||Bt<vt)&&U.call(this);Qr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],kt,Lr,null).clip().discardPath()),pe.call(this,se,be),Qr&&this.pdf.restoreGraphicsState()}this.lineWidth=st}else this.lineWidth=Ct,pe.call(this,se,be),this.lineWidth=st;this.path=Qt},pe=function(se,be){if((se!=="stroke"||be||!M.call(this))&&(se==="stroke"||be||!B.call(this))){for(var Me,De,$e=[],qe=this.path,ct=0;ct<qe.length;ct++){var st=qe[ct];switch(st.type){case"begin":$e.push({begin:!0});break;case"close":$e.push({close:!0});break;case"mt":$e.push({start:st,deltas:[],abs:[]});break;case"lt":var Ct=$e.length;if(qe[ct-1]&&!isNaN(qe[ct-1].x)&&(Me=[st.x-qe[ct-1].x,st.y-qe[ct-1].y],Ct>0)){for(;Ct>=0;Ct--)if($e[Ct-1].close!==!0&&$e[Ct-1].begin!==!0){$e[Ct-1].deltas.push(Me),$e[Ct-1].abs.push(st);break}}break;case"bct":Me=[st.x1-qe[ct-1].x,st.y1-qe[ct-1].y,st.x2-qe[ct-1].x,st.y2-qe[ct-1].y,st.x-qe[ct-1].x,st.y-qe[ct-1].y],$e[$e.length-1].deltas.push(Me);break;case"qct":var It=qe[ct-1].x+2/3*(st.x1-qe[ct-1].x),Qt=qe[ct-1].y+2/3*(st.y1-qe[ct-1].y),Ht=st.x+2/3*(st.x1-st.x),zt=st.y+2/3*(st.y1-st.y),mt=st.x,Re=st.y;Me=[It-qe[ct-1].x,Qt-qe[ct-1].y,Ht-qe[ct-1].x,zt-qe[ct-1].y,mt-qe[ct-1].x,Re-qe[ct-1].y],$e[$e.length-1].deltas.push(Me);break;case"arc":$e.push({deltas:[],abs:[],arc:!0}),Array.isArray($e[$e.length-1].abs)&&$e[$e.length-1].abs.push(st)}}De=be?null:se==="stroke"?"stroke":"fill";for(var Ye=!1,tr=0;tr<$e.length;tr++)if($e[tr].arc)for(var St=$e[tr].abs,vt=0;vt<St.length;vt++){var Bt=St[vt];Bt.type==="arc"?fe.call(this,Bt.x,Bt.y,Bt.radius,Bt.startAngle,Bt.endAngle,Bt.counterclockwise,void 0,be,!Ye):xe.call(this,Bt.x,Bt.y),Ye=!0}else if($e[tr].close===!0)this.pdf.internal.out("h"),Ye=!1;else if($e[tr].begin!==!0){var kt=$e[tr].start.x,ir=$e[tr].start.y;_e.call(this,$e[tr].deltas,kt,ir),Ye=!0}De&&Oe.call(this,De),be&&Fe.call(this)}},ge=function(se){var be=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Me=be*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return se-Me;case"top":return se+be-Me;case"hanging":return se+be-2*Me;case"middle":return se+be/2-Me;case"ideographic":return se;case"alphabetic":default:return se}},ye=function(se){return se+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};v.prototype.createLinearGradient=function(){var se=function(){};return se.colorStops=[],se.addColorStop=function(be,Me){this.colorStops.push([be,Me])},se.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},se.isCanvasGradient=!0,se},v.prototype.createPattern=function(){return this.createLinearGradient()},v.prototype.createRadialGradient=function(){return this.createLinearGradient()};var fe=function(se,be,Me,De,$e,qe,ct,st,Ct){for(var It=et.call(this,Me,De,$e,qe),Qt=0;Qt<It.length;Qt++){var Ht=It[Qt];Qt===0&&(Ct?oe.call(this,Ht.x1+se,Ht.y1+be):xe.call(this,Ht.x1+se,Ht.y1+be)),tt.call(this,se,be,Ht.x2,Ht.y2,Ht.x3,Ht.y3,Ht.x4,Ht.y4)}st?Fe.call(this):Oe.call(this,ct)},Oe=function(se){switch(se){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Fe=function(){this.pdf.clip(),this.pdf.discardPath()},oe=function(se,be){this.pdf.internal.out(t(se)+" "+n(be)+" m")},le=function(se){var be;switch(se.align){case"right":case"end":be="right";break;case"center":be="center";break;case"left":case"start":default:be="left"}var Me=this.pdf.getTextDimensions(se.text),De=ge.call(this,se.y),$e=ye.call(this,De)-Me.h,qe=this.ctx.transform.applyToPoint(new a(se.x,De)),ct=this.ctx.transform.decompose(),st=new A;st=(st=(st=st.multiply(ct.translate)).multiply(ct.skew)).multiply(ct.scale);for(var Ct,It,Qt,Ht=this.ctx.transform.applyToRectangle(new o(se.x,De,Me.w,Me.h)),zt=st.applyToRectangle(new o(se.x,$e,Me.w,Me.h)),mt=N.call(this,zt),Re=[],Ye=0;Ye<mt.length;Ye+=1)Re.indexOf(mt[Ye])===-1&&Re.push(mt[Ye]);if(Y(Re),this.autoPaging)for(var tr=Re[0],St=Re[Re.length-1],vt=tr;vt<St+1;vt++){this.pdf.setPage(vt);var Bt=vt===1?this.posY+this.margin[0]:this.margin[0],kt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ir=this.pdf.internal.pageSize.height-this.margin[2],Ar=ir-this.margin[0],Lr=this.pdf.internal.pageSize.width-this.margin[1],Tr=Lr-this.margin[3],kr=vt===1?0:kt+(vt-2)*Ar;if(this.ctx.clip_path.length!==0){var Qr=this.path;Ct=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=q(Ct,this.posX+this.margin[3],-1*kr+Bt),pe.call(this,"fill",!0),this.path=Qr}var pt=q([JSON.parse(JSON.stringify(zt))],this.posX+this.margin[3],-kr+Bt+this.ctx.prevPageLastElemOffset)[0];se.scale>=.01&&(It=this.pdf.internal.getFontSize(),this.pdf.setFontSize(It*se.scale),Qt=this.lineWidth,this.lineWidth=Qt*se.scale);var Ir=this.autoPaging!=="text";if(Ir||pt.y+pt.h<=ir){if(Ir||pt.y>=Bt&&pt.x<=Lr){var Dt=Ir?se.text:this.pdf.splitTextToSize(se.text,se.maxWidth||Lr-pt.x)[0],xn=q([JSON.parse(JSON.stringify(Ht))],this.posX+this.margin[3],-kr+Bt+this.ctx.prevPageLastElemOffset)[0],Mr=Ir&&(vt>tr||vt<St)&&U.call(this);Mr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Tr,Ar,null).clip().discardPath()),this.pdf.text(Dt,xn.x,xn.y,{angle:se.angle,align:be,renderingMode:se.renderingMode}),Mr&&this.pdf.restoreGraphicsState()}}else pt.y<ir&&(this.ctx.prevPageLastElemOffset+=ir-pt.y);se.scale>=.01&&(this.pdf.setFontSize(It),this.lineWidth=Qt)}else se.scale>=.01&&(It=this.pdf.internal.getFontSize(),this.pdf.setFontSize(It*se.scale),Qt=this.lineWidth,this.lineWidth=Qt*se.scale),this.pdf.text(se.text,qe.x+this.posX,qe.y+this.posY,{angle:se.angle,align:be,renderingMode:se.renderingMode,maxWidth:se.maxWidth}),se.scale>=.01&&(this.pdf.setFontSize(It),this.lineWidth=Qt)},xe=function(se,be,Me,De){Me=Me||0,De=De||0,this.pdf.internal.out(t(se+Me)+" "+n(be+De)+" l")},_e=function(se,be,Me){return this.pdf.lines(se,be,Me,null,null)},tt=function(se,be,Me,De,$e,qe,ct,st){this.pdf.internal.out([e(i(Me+se)),e(s(De+be)),e(i($e+se)),e(s(qe+be)),e(i(ct+se)),e(s(st+be)),"c"].join(" "))},et=function(se,be,Me,De){for(var $e=2*Math.PI,qe=Math.PI/2;be>Me;)be-=$e;var ct=Math.abs(Me-be);ct<$e&&De&&(ct=$e-ct);for(var st=[],Ct=De?-1:1,It=be;ct>1e-5;){var Qt=It+Ct*Math.min(ct,qe);st.push(nt.call(this,se,It,Qt)),ct-=Math.abs(Qt-It),It=Qt}return st},nt=function(se,be,Me){var De=(Me-be)/2,$e=se*Math.cos(De),qe=se*Math.sin(De),ct=$e,st=-qe,Ct=ct*ct+st*st,It=Ct+ct*$e+st*qe,Qt=4/3*(Math.sqrt(2*Ct*It)-It)/(ct*qe-st*$e),Ht=ct-Qt*st,zt=st+Qt*ct,mt=Ht,Re=-zt,Ye=De+be,tr=Math.cos(Ye),St=Math.sin(Ye);return{x1:se*Math.cos(be),y1:se*Math.sin(be),x2:Ht*tr-zt*St,y2:Ht*St+zt*tr,x3:mt*tr-Re*St,y3:mt*St+Re*tr,x4:se*Math.cos(Me),y4:se*Math.sin(Me)}},Je=function(se){return 180*se/Math.PI},it=function(se,be,Me,De,$e,qe){var ct=se+.5*(Me-se),st=be+.5*(De-be),Ct=$e+.5*(Me-$e),It=qe+.5*(De-qe),Qt=Math.min(se,$e,ct,Ct),Ht=Math.max(se,$e,ct,Ct),zt=Math.min(be,qe,st,It),mt=Math.max(be,qe,st,It);return new o(Qt,zt,Ht-Qt,mt-zt)},ot=function(se,be,Me,De,$e,qe,ct,st){var Ct,It,Qt,Ht,zt,mt,Re,Ye,tr,St,vt,Bt,kt,ir,Ar=Me-se,Lr=De-be,Tr=$e-Me,kr=qe-De,Qr=ct-$e,pt=st-qe;for(It=0;It<41;It++)tr=(Re=(Qt=se+(Ct=It/40)*Ar)+Ct*((zt=Me+Ct*Tr)-Qt))+Ct*(zt+Ct*($e+Ct*Qr-zt)-Re),St=(Ye=(Ht=be+Ct*Lr)+Ct*((mt=De+Ct*kr)-Ht))+Ct*(mt+Ct*(qe+Ct*pt-mt)-Ye),It==0?(vt=tr,Bt=St,kt=tr,ir=St):(vt=Math.min(vt,tr),Bt=Math.min(Bt,St),kt=Math.max(kt,tr),ir=Math.max(ir,St));return new o(Math.round(vt),Math.round(Bt),Math.round(kt-vt),Math.round(ir-Bt))},xt=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var se,be,Me=(se=this.ctx.lineDash,be=this.ctx.lineDashOffset,JSON.stringify({lineDash:se,lineDashOffset:be}));this.prevLineDash!==Me&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Me)}}})(qr.API),function(r){var e=function(s){var a,o,A,f,m,v,x,B,M,U;for(o=[],A=0,f=(s+=a="\0\0\0\0".slice(s.length%4||4)).length;f>A;A+=4)(m=(s.charCodeAt(A)<<24)+(s.charCodeAt(A+1)<<16)+(s.charCodeAt(A+2)<<8)+s.charCodeAt(A+3))!==0?(v=(m=((m=((m=((m=(m-(U=m%85))/85)-(M=m%85))/85)-(B=m%85))/85)-(x=m%85))/85)%85,o.push(v+33,x+33,B+33,M+33,U+33)):o.push(122);return function(N,Q){for(var q=Q;q>0;q--)N.pop()}(o,a.length),String.fromCharCode.apply(String,o)+"~>"},t=function(s){var a,o,A,f,m,v=String,x="length",B=255,M="charCodeAt",U="slice",N="replace";for(s[U](-2),s=s[U](0,-2)[N](/\s/g,"")[N]("z","!!!!!"),A=[],f=0,m=(s+=a="uuuuu"[U](s[x]%5||5))[x];m>f;f+=5)o=52200625*(s[M](f)-33)+614125*(s[M](f+1)-33)+7225*(s[M](f+2)-33)+85*(s[M](f+3)-33)+(s[M](f+4)-33),A.push(B&o>>24,B&o>>16,B&o>>8,B&o);return function(Q,q){for(var Y=q;Y>0;Y--)Q.pop()}(A,a[x]),v.fromCharCode.apply(v,A)},n=function(s){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),a.test(s)===!1)return"";for(var o="",A=0;A<s.length;A+=2)o+=String.fromCharCode("0x"+(s[A]+s[A+1]));return o},i=function(s){for(var a=new Uint8Array(s.length),o=s.length;o--;)a[o]=s.charCodeAt(o);return s=(a=u2(a)).reduce(function(A,f){return A+String.fromCharCode(f)},"")};r.processDataByFilters=function(s,a){var o=0,A=s||"",f=[];for(typeof(a=a||[])=="string"&&(a=[a]),o=0;o<a.length;o+=1)switch(a[o]){case"ASCII85Decode":case"/ASCII85Decode":A=t(A),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":A=e(A),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":A=n(A),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":A=A.split("").map(function(m){return("0"+m.charCodeAt().toString(16)).slice(-2)}).join("")+">",f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":A=i(A),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[o]+'" is not implemented')}return{data:A,reverseChain:f.reverse().join(" ")}}}(qr.API),function(r){r.loadFile=function(e,t,n){return function(i,s,a){s=s!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=function(A,f,m){var v=new XMLHttpRequest,x=0,B=function(M){var U=M.length,N=[],Q=String.fromCharCode;for(x=0;x<U;x+=1)N.push(Q(255&M.charCodeAt(x)));return N.join("")};if(v.open("GET",A,!f),v.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(v.onload=function(){v.status===200?m(B(this.responseText)):m(void 0)}),v.send(null),f&&v.status===200)return B(v.responseText)}(i,s,a)}catch{}return o}(e,t,n)},r.loadImageFile=r.loadFile}(qr.API),function(r){function e(){return(jr.html2canvas?Promise.resolve(jr.html2canvas):Promise.resolve().then(()=>xce)).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function t(){return(jr.DOMPurify?Promise.resolve(jr.DOMPurify):Promise.resolve().then(()=>Zce)).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var n=function(a){var o=Dn(a);return o==="undefined"?"undefined":o==="string"||a instanceof String?"string":o==="number"||a instanceof Number?"number":o==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":o==="object"?"object":"unknown"},i=function(a,o){var A=document.createElement(a);for(var f in o.className&&(A.className=o.className),o.innerHTML&&o.dompurify&&(A.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)A.style[f]=o.style[f];return A},s=function a(o){var A=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),f=a.convert(Promise.resolve(),A);return f=(f=f.setProgress(1,a,1,[a])).set(o)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(a,o){return a.__proto__=o||s.prototype,a},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(a,o){return this.then(function(){switch(o=o||function(A){switch(n(A)){case"string":return"string";case"element":return A.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(a)){case"string":return this.then(t).then(function(A){return this.set({src:i("div",{innerHTML:a,dompurify:A})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},s.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function A(f,m){for(var v=f.nodeType===3?document.createTextNode(f.nodeValue):f.cloneNode(!1),x=f.firstChild;x;x=x.nextSibling)m!==!0&&x.nodeType===1&&x.nodeName==="SCRIPT"||v.appendChild(A(x,m));return f.nodeType===1&&(f.nodeName==="CANVAS"?(v.width=f.width,v.height=f.height,v.getContext("2d").drawImage(f,0,0)):f.nodeName!=="TEXTAREA"&&f.nodeName!=="SELECT"||(v.value=f.value),v.addEventListener("load",function(){v.scrollTop=f.scrollTop,v.scrollLeft=f.scrollLeft},!0)),v}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(o){var A=Object.assign({},this.opt.html2canvas);return delete A.onrendered,o(this.prop.container,A)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(o){var A=this.opt.jsPDF,f=this.opt.fontFaces,m=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,v=Object.assign({async:!0,allowTaint:!0,scale:m,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete v.onrendered,A.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,A.context2d.posX=this.opt.x,A.context2d.posY=this.opt.y,A.context2d.margin=this.opt.margin,A.context2d.fontFaces=f,f)for(var x=0;x<f.length;++x){var B=f[x],M=B.src.find(function(U){return U.format==="truetype"});M&&A.addFont(M.url,B.ref.name,B.ref.style)}return v.windowHeight=v.windowHeight||0,v.windowHeight=v.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):v.windowHeight,A.context2d.save(!0),o(this.prop.container,v)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(a,o,A){return(A=A||"pdf").toLowerCase()==="img"||A.toLowerCase()==="image"?this.outputImg(a,o):this.outputPdf(a,o)},s.prototype.outputPdf=function(a,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,o)})},s.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},s.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(a){if(n(a)!=="object")return this;var o=Object.keys(a||{}).map(function(A){if(A in s.template.prop)return function(){this.prop[A]=a[A]};switch(A){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[A]=a[A]}}},this);return this.then(function(){return this.thenList(o)})},s.prototype.get=function(a,o){return this.then(function(){var A=a in s.template.prop?this.prop[a]:this.opt[a];return o?o(A):A})},s.prototype.setMargin=function(a){return this.then(function(){switch(n(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},s.prototype.setPageSize=function(a){function o(A,f){return Math.floor(A*f/72*96)}return this.then(function(){(a=a||qr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:o(a.inner.width,a.k),height:o(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},s.prototype.setProgress=function(a,o,A,f){return a!=null&&(this.progress.val=a),o!=null&&(this.progress.state=o),A!=null&&(this.progress.n=A),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(a,o,A,f){return this.setProgress(a?this.progress.val+a:null,o||null,A?this.progress.n+A:null,f?this.progress.stack.concat(f):null)},s.prototype.then=function(a,o){var A=this;return this.thenCore(a,o,function(f,m){return A.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(v){return A.updateProgress(null,f),v}).then(f,m).then(function(v){return A.updateProgress(1),v})})},s.prototype.thenCore=function(a,o,A){A=A||Promise.prototype.then,a&&(a=a.bind(this)),o&&(o=o.bind(this));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),m=A.call(f,a,o);return s.convert(m,this.__proto__)},s.prototype.thenExternal=function(a,o){return Promise.prototype.then.call(this,a,o)},s.prototype.thenList=function(a){var o=this;return a.forEach(function(A){o=o.thenCore(A)}),o},s.prototype.catch=function(a){a&&(a=a.bind(this));var o=Promise.prototype.catch.call(this,a);return s.convert(o,this)},s.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},s.prototype.error=function(a){return this.then(function(){throw new Error(a)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,qr.getPageSize=function(a,o,A){if(Dn(a)==="object"){var f=a;a=f.orientation,o=f.unit||o,A=f.format||A}o=o||"mm",A=A||"a4",a=(""+(a||"P")).toLowerCase();var m,v=(""+A).toLowerCase(),x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":m=1;break;case"mm":m=72/25.4;break;case"cm":m=72/2.54;break;case"in":m=72;break;case"px":m=.75;break;case"pc":case"em":m=12;break;case"ex":m=6;break;default:throw"Invalid unit: "+o}var B,M=0,U=0;if(x.hasOwnProperty(v))M=x[v][1]/m,U=x[v][0]/m;else try{M=A[1],U=A[0]}catch{throw new Error("Invalid format: "+A)}if(a==="p"||a==="portrait")a="p",U>M&&(B=U,U=M,M=B);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",M>U&&(B=U,U=M,M=B)}return{width:U,height:M,unit:o,k:m,orientation:a}},r.html=function(a,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(b2):null;var A=new s(o);return o.worker?A:A.from(a).doCallback()}}(qr.API),qr.API.addJS=function(r){return VF=r,this.internal.events.subscribe("postPutResources",function(){_y=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(_y+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),GF=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+VF+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){_y!==void 0&&GF!==void 0&&this.internal.out("/Names <</JavaScript "+_y+" 0 R>>")}),this},function(r){var e;r.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=t.outline.render().split(/\r\n/),s=0;s<i.length;s++){var a=i[s],o=n.exec(a);if(o!=null){var A=o[1];t.internal.newObjectDeferredBegin(A,!1)}t.internal.write(a)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,m=[];for(s=0;s<f;s++){var v=t.internal.newObject();m.push(v);var x=t.internal.getPageInfo(s+1);t.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var B=t.internal.newObject();for(t.internal.write("<< /Names [ "),s=0;s<m.length;s++)t.internal.write("(page_"+(s+1)+")"+m[s]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+B+" 0 R"),t.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),r.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,i,s){var a={title:i,options:s,children:[]};return n==null&&(n=this.root),n.children.push(a),a},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var a=n.children[s];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var A=t.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+A.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var f=0;f<n.children.length;f++)this.renderItems(n.children[f])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,i){for(var s=0;s<i.children.length;s++)n.count++,this.count_r(n,i.children[s]);return n.count}}])}(qr.API),function(r){var e=[192,193,194,195,196,197,198,199];r.processJPEG=function(t,n,i,s,a,o){var A,f=this.decode.DCT_DECODE,m=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=a||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(A=function(v){for(var x,B=256*v.charCodeAt(4)+v.charCodeAt(5),M=v.length,U={width:0,height:0,numcomponents:1},N=4;N<M;N+=2){if(N+=B,e.indexOf(v.charCodeAt(N+1))!==-1){x=256*v.charCodeAt(N+5)+v.charCodeAt(N+6),U={width:256*v.charCodeAt(N+7)+v.charCodeAt(N+8),height:x,numcomponents:v.charCodeAt(N+9)};break}B=256*v.charCodeAt(N+2)+v.charCodeAt(N+3)}return U}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}m={data:t,width:A.width,height:A.height,colorSpace:o,bitsPerComponent:8,filter:f,index:n,alias:i}}return m}}(qr.API);var Bf,vy,qF,KF,WF,Fte=function(){var r,e,t;function n(s){var a,o,A,f,m,v,x,B,M,U,N,Q,q,Y;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},v=null;;){switch(a=this.readUInt32(),M=(function(){var te,pe;for(pe=[],te=0;te<4;++te)pe.push(String.fromCharCode(this.data[this.pos++]));return pe}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(a);break;case"fcTL":v&&this.animation.frames.push(v),this.pos+=4,v={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},m=this.readUInt16(),f=this.readUInt16()||100,v.delay=1e3*m/f,v.disposeOp=this.data[this.pos++],v.blendOp=this.data[this.pos++],v.data=[];break;case"IDAT":case"fdAT":for(M==="fdAT"&&(this.pos+=4,a-=4),s=(v!=null?v.data:void 0)||this.imgData,Q=0;0<=a?Q<a:Q>a;0<=a?++Q:--Q)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(A=this.palette.length/3,this.transparency.indexed=this.read(a),this.transparency.indexed.length>A)throw new Error("More transparent colors than palette size");if((U=A-this.transparency.indexed.length)>0)for(q=0;0<=U?q<U:q>U;0<=U?++q:--q)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(a)[0];break;case 2:this.transparency.rgb=this.read(a)}break;case"tEXt":x=(N=this.read(a)).indexOf(0),B=String.fromCharCode.apply(String,N.slice(0,x)),this.text[B]=String.fromCharCode.apply(String,N.slice(x+1));break;case"IEND":return v&&this.animation.frames.push(v),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(Y=this.colorType)===4||Y===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=a}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(s){var a,o;for(o=[],a=0;0<=s?a<s:a>s;0<=s?++a:--a)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(s){var a=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*a),A=0,f=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function m(v,x,B,M){var U,N,Q,q,Y,te,pe,ge,ye,fe,Oe,Fe,oe,le,xe,_e,tt,et,nt,Je,it,ot=Math.ceil((f.width-v)/B),xt=Math.ceil((f.height-x)/M),se=f.width==ot&&f.height==xt;for(le=a*ot,Fe=se?o:new Uint8Array(le*xt),te=s.length,oe=0,N=0;oe<xt&&A<te;){switch(s[A++]){case 0:for(q=tt=0;tt<le;q=tt+=1)Fe[N++]=s[A++];break;case 1:for(q=et=0;et<le;q=et+=1)U=s[A++],Y=q<a?0:Fe[N-a],Fe[N++]=(U+Y)%256;break;case 2:for(q=nt=0;nt<le;q=nt+=1)U=s[A++],Q=(q-q%a)/a,xe=oe&&Fe[(oe-1)*le+Q*a+q%a],Fe[N++]=(xe+U)%256;break;case 3:for(q=Je=0;Je<le;q=Je+=1)U=s[A++],Q=(q-q%a)/a,Y=q<a?0:Fe[N-a],xe=oe&&Fe[(oe-1)*le+Q*a+q%a],Fe[N++]=(U+Math.floor((Y+xe)/2))%256;break;case 4:for(q=it=0;it<le;q=it+=1)U=s[A++],Q=(q-q%a)/a,Y=q<a?0:Fe[N-a],oe===0?xe=_e=0:(xe=Fe[(oe-1)*le+Q*a+q%a],_e=Q&&Fe[(oe-1)*le+(Q-1)*a+q%a]),pe=Y+xe-_e,ge=Math.abs(pe-Y),fe=Math.abs(pe-xe),Oe=Math.abs(pe-_e),ye=ge<=fe&&ge<=Oe?Y:fe<=Oe?xe:_e,Fe[N++]=(U+ye)%256;break;default:throw new Error("Invalid filter algorithm: "+s[A-1])}if(!se){var be=((x+oe*M)*f.width+v)*a,Me=oe*le;for(q=0;q<ot;q+=1){for(var De=0;De<a;De+=1)o[be++]=Fe[Me++];be+=(B-1)*a}}oe++}}return s=Ate(s),f.interlaceMethod==1?(m(0,0,8,8),m(4,0,8,8),m(0,4,4,8),m(2,0,4,4),m(0,2,2,4),m(1,0,2,2),m(0,1,1,2)):m(0,0,1,1),o},n.prototype.decodePalette=function(){var s,a,o,A,f,m,v,x,B;for(o=this.palette,m=this.transparency.indexed||[],f=new Uint8Array((m.length||0)+o.length),A=0,s=0,a=v=0,x=o.length;v<x;a=v+=3)f[A++]=o[a],f[A++]=o[a+1],f[A++]=o[a+2],f[A++]=(B=m[s++])!=null?B:255;return f},n.prototype.copyToImageData=function(s,a){var o,A,f,m,v,x,B,M,U,N,Q;if(A=this.colors,U=null,o=this.hasAlphaChannel,this.palette.length&&(U=(Q=this._decodedPalette)!=null?Q:this._decodedPalette=this.decodePalette(),A=4,o=!0),M=(f=s.data||s).length,v=U||a,m=x=0,A===1)for(;m<M;)B=U?4*a[m/4]:x,N=v[B++],f[m++]=N,f[m++]=N,f[m++]=N,f[m++]=o?v[B++]:255,x=B;else for(;m<M;)B=U?4*a[m/4]:x,f[m++]=v[B++],f[m++]=v[B++],f[m++]=v[B++],f[m++]=o?v[B++]:255,x=B},n.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var i=function(){if(Object.prototype.toString.call(jr)==="[object Window]"){try{e=jr.document.createElement("canvas"),t=e.getContext("2d")}catch{return!1}return!0}return!1};return i(),r=function(s){var a;if(i()===!0)return t.width=s.width,t.height=s.height,t.clearRect(0,0,s.width,s.height),t.putImageData(s,0,0),(a=new Image).src=e.toDataURL(),a;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(s){var a,o,A,f,m,v,x,B;if(this.animation){for(B=[],o=m=0,v=(x=this.animation.frames).length;m<v;o=++m)a=x[o],A=s.createImageData(a.width,a.height),f=this.decodePixels(new Uint8Array(a.data)),this.copyToImageData(A,f),a.imageData=A,B.push(a.image=r(A));return B}},n.prototype.renderFrame=function(s,a){var o,A,f;return o=(A=this.animation.frames)[a],f=A[a-1],a===0&&s.clearRect(0,0,this.width,this.height),(f!=null?f.disposeOp:void 0)===1?s.clearRect(f.xOffset,f.yOffset,f.width,f.height):(f!=null?f.disposeOp:void 0)===2&&s.putImageData(f.imageData,f.xOffset,f.yOffset),o.blendOp===0&&s.clearRect(o.xOffset,o.yOffset,o.width,o.height),s.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(s){var a,o,A,f,m,v,x=this;return o=0,v=this.animation,f=v.numFrames,A=v.frames,m=v.numPlays,(a=function(){var B,M;if(B=o++%f,M=A[B],x.renderFrame(s,B),f>1&&o/f<m)return x.animation._timeout=setTimeout(a,M.delay)})()},n.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},n.prototype.render=function(s){var a,o;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,a=s.getContext("2d"),this.animation?(this.decodeFrames(a),this.animate(a)):(o=a.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),a.putImageData(o,0,0))},n}();/**
* @license
*
* Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
*
* Permission is hereby granted, free of charge, to any person obtaining
* a copy of this software and associated documentation files (the
* "Software"), to deal in the Software without restriction, including
* without limitation the rights to use, copy, modify, merge, publish,
* distribute, sublicense, and/or sell copies of the Software, and to
* permit persons to whom the Software is furnished to do so, subject to
* the following conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
* LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
* OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
* WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
* ====================================================================
*//**
* @license
* (c) Dean McNamee <dean@gmail.com>, 2013.
*
* https://github.com/deanm/omggif
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to
* deal in the Software without restriction, including without limitation the
* rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
* sell copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in
* all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
* IN THE SOFTWARE.
*
* omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
* including animation and compression.  It does not rely on any specific
* underlying system, so should run in the browser, Node, or Plask.
*/function Mte(r){var e=0;if(r[e++]!==71||r[e++]!==73||r[e++]!==70||r[e++]!==56||(r[e++]+1&253)!=56||r[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=r[e++]|r[e++]<<8,n=r[e++]|r[e++]<<8,i=r[e++],s=i>>7,a=1<<(7&i)+1;r[e++],r[e++];var o=null,A=null;s&&(o=e,A=a,e+=3*a);var f=!0,m=[],v=0,x=null,B=0,M=null;for(this.width=t,this.height=n;f&&e<r.length;)switch(r[e++]){case 33:switch(r[e++]){case 255:if(r[e]!==11||r[e+1]==78&&r[e+2]==69&&r[e+3]==84&&r[e+4]==83&&r[e+5]==67&&r[e+6]==65&&r[e+7]==80&&r[e+8]==69&&r[e+9]==50&&r[e+10]==46&&r[e+11]==48&&r[e+12]==3&&r[e+13]==1&&r[e+16]==0)e+=14,M=r[e++]|r[e++]<<8,e++;else for(e+=12;;){if(!((oe=r[e++])>=0))throw Error("Invalid block size");if(oe===0)break;e+=oe}break;case 249:if(r[e++]!==4||r[e+4]!==0)throw new Error("Invalid graphics extension block.");var U=r[e++];v=r[e++]|r[e++]<<8,x=r[e++],!(1&U)&&(x=null),B=U>>2&7,e++;break;case 254:for(;;){if(!((oe=r[e++])>=0))throw Error("Invalid block size");if(oe===0)break;e+=oe}break;default:throw new Error("Unknown graphic control label: 0x"+r[e-1].toString(16))}break;case 44:var N=r[e++]|r[e++]<<8,Q=r[e++]|r[e++]<<8,q=r[e++]|r[e++]<<8,Y=r[e++]|r[e++]<<8,te=r[e++],pe=te>>6&1,ge=1<<(7&te)+1,ye=o,fe=A,Oe=!1;te>>7&&(Oe=!0,ye=e,fe=ge,e+=3*ge);var Fe=e;for(e++;;){var oe;if(!((oe=r[e++])>=0))throw Error("Invalid block size");if(oe===0)break;e+=oe}m.push({x:N,y:Q,width:q,height:Y,has_local_palette:Oe,palette_offset:ye,palette_size:fe,data_offset:Fe,data_length:e-Fe,transparent_index:x,interlaced:!!pe,delay:v,disposal:B});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+r[e-1].toString(16))}this.numFrames=function(){return m.length},this.loopCount=function(){return M},this.frameInfo=function(le){if(le<0||le>=m.length)throw new Error("Frame index out of range.");return m[le]},this.decodeAndBlitFrameBGRA=function(le,xe){var _e=this.frameInfo(le),tt=_e.width*_e.height,et=new Uint8Array(tt);$F(r,_e.data_offset,et,tt);var nt=_e.palette_offset,Je=_e.transparent_index;Je===null&&(Je=256);var it=_e.width,ot=t-it,xt=it,se=4*(_e.y*t+_e.x),be=4*((_e.y+_e.height)*t+_e.x),Me=se,De=4*ot;_e.interlaced===!0&&(De+=4*t*7);for(var $e=8,qe=0,ct=et.length;qe<ct;++qe){var st=et[qe];if(xt===0&&(xt=it,(Me+=De)>=be&&(De=4*ot+4*t*($e-1),Me=se+(it+ot)*($e<<1),$e>>=1)),st===Je)Me+=4;else{var Ct=r[nt+3*st],It=r[nt+3*st+1],Qt=r[nt+3*st+2];xe[Me++]=Qt,xe[Me++]=It,xe[Me++]=Ct,xe[Me++]=255}--xt}},this.decodeAndBlitFrameRGBA=function(le,xe){var _e=this.frameInfo(le),tt=_e.width*_e.height,et=new Uint8Array(tt);$F(r,_e.data_offset,et,tt);var nt=_e.palette_offset,Je=_e.transparent_index;Je===null&&(Je=256);var it=_e.width,ot=t-it,xt=it,se=4*(_e.y*t+_e.x),be=4*((_e.y+_e.height)*t+_e.x),Me=se,De=4*ot;_e.interlaced===!0&&(De+=4*t*7);for(var $e=8,qe=0,ct=et.length;qe<ct;++qe){var st=et[qe];if(xt===0&&(xt=it,(Me+=De)>=be&&(De=4*ot+4*t*($e-1),Me=se+(it+ot)*($e<<1),$e>>=1)),st===Je)Me+=4;else{var Ct=r[nt+3*st],It=r[nt+3*st+1],Qt=r[nt+3*st+2];xe[Me++]=Ct,xe[Me++]=It,xe[Me++]=Qt,xe[Me++]=255}--xt}}}function $F(r,e,t,n){for(var i=r[e++],s=1<<i,a=s+1,o=a+1,A=i+1,f=(1<<A)-1,m=0,v=0,x=0,B=r[e++],M=new Int32Array(4096),U=null;;){for(;m<16&&B!==0;)v|=r[e++]<<m,m+=8,B===1?B=r[e++]:--B;if(m<A)break;var N=v&f;if(v>>=A,m-=A,N!==s){if(N===a)break;for(var Q=N<o?N:U,q=0,Y=Q;Y>s;)Y=M[Y]>>8,++q;var te=Y;if(x+q+(Q!==N?1:0)>n)return void li.log("Warning, gif stream longer than expected.");t[x++]=te;var pe=x+=q;for(Q!==N&&(t[x++]=te),Y=Q;q--;)Y=M[Y],t[--pe]=255&Y,Y>>=8;U!==null&&o<4096&&(M[o++]=U<<8|te,o>=f+1&&A<12&&(++A,f=f<<1|1)),U=N}else o=a+1,f=(1<<(A=i+1))-1,U=null}return x!==n&&li.log("Warning, gif stream shorter than expected."),t}/**
	 * @license
	  Copyright (c) 2008, Adobe Systems Incorporated
	  All rights reserved.

	  Redistribution and use in source and binary forms, with or without 
	  modification, are permitted provided that the following conditions are
	  met:

	  * Redistributions of source code must retain the above copyright notice, 
	    this list of conditions and the following disclaimer.
	  
	  * Redistributions in binary form must reproduce the above copyright
	    notice, this list of conditions and the following disclaimer in the 
	    documentation and/or other materials provided with the distribution.
	  
	  * Neither the name of Adobe Systems Incorporated nor the names of its 
	    contributors may be used to endorse or promote products derived from 
	    this software without specific prior written permission.

	  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
	  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
	  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
	  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
	  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
	  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
	  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
	  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
	  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
	  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
	  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	*/function w2(r){var e,t,n,i,s,a=Math.floor,o=new Array(64),A=new Array(64),f=new Array(64),m=new Array(64),v=new Array(65535),x=new Array(65535),B=new Array(64),M=new Array(64),U=[],N=0,Q=7,q=new Array(64),Y=new Array(64),te=new Array(64),pe=new Array(256),ge=new Array(2048),ye=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],fe=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Oe=[0,1,2,3,4,5,6,7,8,9,10,11],Fe=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],oe=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],le=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],xe=[0,1,2,3,4,5,6,7,8,9,10,11],_e=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],tt=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function et(se,be){for(var Me=0,De=0,$e=new Array,qe=1;qe<=16;qe++){for(var ct=1;ct<=se[qe];ct++)$e[be[De]]=[],$e[be[De]][0]=Me,$e[be[De]][1]=qe,De++,Me++;Me*=2}return $e}function nt(se){for(var be=se[0],Me=se[1]-1;Me>=0;)be&1<<Me&&(N|=1<<Q),Me--,--Q<0&&(N==255?(Je(255),Je(0)):Je(N),Q=7,N=0)}function Je(se){U.push(se)}function it(se){Je(se>>8&255),Je(255&se)}function ot(se,be,Me,De,$e){for(var qe,ct=$e[0],st=$e[240],Ct=function(St,vt){var Bt,kt,ir,Ar,Lr,Tr,kr,Qr,pt,Ir,Dt=0;for(pt=0;pt<8;++pt){Bt=St[Dt],kt=St[Dt+1],ir=St[Dt+2],Ar=St[Dt+3],Lr=St[Dt+4],Tr=St[Dt+5],kr=St[Dt+6];var xn=Bt+(Qr=St[Dt+7]),Mr=Bt-Qr,Tt=kt+kr,Jt=kt-kr,Kt=ir+Tr,Yr=ir-Tr,Or=Ar+Lr,gr=Ar-Lr,an=xn+Or,Wr=xn-Or,Ee=Tt+Kt,ee=Tt-Kt;St[Dt]=an+Ee,St[Dt+4]=an-Ee;var Z=.707106781*(ee+Wr);St[Dt+2]=Wr+Z,St[Dt+6]=Wr-Z;var ae=.382683433*((an=gr+Yr)-(ee=Jt+Mr)),Se=.5411961*an+ae,Qe=1.306562965*ee+ae,Ge=.707106781*(Ee=Yr+Jt),Ke=Mr+Ge,Te=Mr-Ge;St[Dt+5]=Te+Se,St[Dt+3]=Te-Se,St[Dt+1]=Ke+Qe,St[Dt+7]=Ke-Qe,Dt+=8}for(Dt=0,pt=0;pt<8;++pt){Bt=St[Dt],kt=St[Dt+8],ir=St[Dt+16],Ar=St[Dt+24],Lr=St[Dt+32],Tr=St[Dt+40],kr=St[Dt+48];var Ze=Bt+(Qr=St[Dt+56]),yt=Bt-Qr,gt=kt+kr,ft=kt-kr,Vt=ir+Tr,Yt=ir-Tr,Er=Ar+Lr,lr=Ar-Lr,Ur=Ze+Er,Nr=Ze-Er,Hr=gt+Vt,mn=gt-Vt;St[Dt]=Ur+Hr,St[Dt+32]=Ur-Hr;var mr=.707106781*(mn+Nr);St[Dt+16]=Nr+mr,St[Dt+48]=Nr-mr;var $r=.382683433*((Ur=lr+Yt)-(mn=ft+yt)),bn=.5411961*Ur+$r,kn=1.306562965*mn+$r,ke=.707106781*(Hr=Yt+ft),Rt=yt+ke,Lt=yt-ke;St[Dt+40]=Lt+bn,St[Dt+24]=Lt-bn,St[Dt+8]=Rt+kn,St[Dt+56]=Rt-kn,Dt++}for(pt=0;pt<64;++pt)Ir=St[pt]*vt[pt],B[pt]=Ir>0?Ir+.5|0:Ir-.5|0;return B}(se,be),It=0;It<64;++It)M[ye[It]]=Ct[It];var Qt=M[0]-Me;Me=M[0],Qt==0?nt(De[0]):(nt(De[x[qe=32767+Qt]]),nt(v[qe]));for(var Ht=63;Ht>0&&M[Ht]==0;)Ht--;if(Ht==0)return nt(ct),Me;for(var zt,mt=1;mt<=Ht;){for(var Re=mt;M[mt]==0&&mt<=Ht;)++mt;var Ye=mt-Re;if(Ye>=16){zt=Ye>>4;for(var tr=1;tr<=zt;++tr)nt(st);Ye&=15}qe=32767+M[mt],nt($e[(Ye<<4)+x[qe]]),nt(v[qe]),mt++}return Ht!=63&&nt(ct),Me}function xt(se){se=Math.min(Math.max(se,1),100),s!=se&&(function(be){for(var Me=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],De=0;De<64;De++){var $e=a((Me[De]*be+50)/100);$e=Math.min(Math.max($e,1),255),o[ye[De]]=$e}for(var qe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ct=0;ct<64;ct++){var st=a((qe[ct]*be+50)/100);st=Math.min(Math.max(st,1),255),A[ye[ct]]=st}for(var Ct=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],It=0,Qt=0;Qt<8;Qt++)for(var Ht=0;Ht<8;Ht++)f[It]=1/(o[ye[It]]*Ct[Qt]*Ct[Ht]*8),m[It]=1/(A[ye[It]]*Ct[Qt]*Ct[Ht]*8),It++}(se<50?Math.floor(5e3/se):Math.floor(200-2*se)),s=se)}this.encode=function(se,be){be&&xt(be),U=new Array,N=0,Q=7,it(65496),it(65504),it(16),Je(74),Je(70),Je(73),Je(70),Je(0),Je(1),Je(1),Je(0),it(1),it(1),Je(0),Je(0),function(){it(65499),it(132),Je(0);for(var kt=0;kt<64;kt++)Je(o[kt]);Je(1);for(var ir=0;ir<64;ir++)Je(A[ir])}(),function(kt,ir){it(65472),it(17),Je(8),it(ir),it(kt),Je(3),Je(1),Je(17),Je(0),Je(2),Je(17),Je(1),Je(3),Je(17),Je(1)}(se.width,se.height),function(){it(65476),it(418),Je(0);for(var kt=0;kt<16;kt++)Je(fe[kt+1]);for(var ir=0;ir<=11;ir++)Je(Oe[ir]);Je(16);for(var Ar=0;Ar<16;Ar++)Je(Fe[Ar+1]);for(var Lr=0;Lr<=161;Lr++)Je(oe[Lr]);Je(1);for(var Tr=0;Tr<16;Tr++)Je(le[Tr+1]);for(var kr=0;kr<=11;kr++)Je(xe[kr]);Je(17);for(var Qr=0;Qr<16;Qr++)Je(_e[Qr+1]);for(var pt=0;pt<=161;pt++)Je(tt[pt])}(),it(65498),it(12),Je(3),Je(1),Je(0),Je(2),Je(17),Je(3),Je(17),Je(0),Je(63),Je(0);var Me=0,De=0,$e=0;N=0,Q=7,this.encode.displayName="_encode_";for(var qe,ct,st,Ct,It,Qt,Ht,zt,mt,Re=se.data,Ye=se.width,tr=se.height,St=4*Ye,vt=0;vt<tr;){for(qe=0;qe<St;){for(It=St*vt+qe,Ht=-1,zt=0,mt=0;mt<64;mt++)Qt=It+(zt=mt>>3)*St+(Ht=4*(7&mt)),vt+zt>=tr&&(Qt-=St*(vt+1+zt-tr)),qe+Ht>=St&&(Qt-=qe+Ht-St+4),ct=Re[Qt++],st=Re[Qt++],Ct=Re[Qt++],q[mt]=(ge[ct]+ge[st+256>>0]+ge[Ct+512>>0]>>16)-128,Y[mt]=(ge[ct+768>>0]+ge[st+1024>>0]+ge[Ct+1280>>0]>>16)-128,te[mt]=(ge[ct+1280>>0]+ge[st+1536>>0]+ge[Ct+1792>>0]>>16)-128;Me=ot(q,f,Me,e,n),De=ot(Y,m,De,t,i),$e=ot(te,m,$e,t,i),qe+=32}vt+=8}if(Q>=0){var Bt=[];Bt[1]=Q+1,Bt[0]=(1<<Q+1)-1,nt(Bt)}return it(65497),new Uint8Array(U)},r=r||50,function(){for(var se=String.fromCharCode,be=0;be<256;be++)pe[be]=se(be)}(),e=et(fe,Oe),t=et(le,xe),n=et(Fe,oe),i=et(_e,tt),function(){for(var se=1,be=2,Me=1;Me<=15;Me++){for(var De=se;De<be;De++)x[32767+De]=Me,v[32767+De]=[],v[32767+De][1]=Me,v[32767+De][0]=De;for(var $e=-(be-1);$e<=-se;$e++)x[32767+$e]=Me,v[32767+$e]=[],v[32767+$e][1]=Me,v[32767+$e][0]=be-1+$e;se<<=1,be<<=1}}(),function(){for(var se=0;se<256;se++)ge[se]=19595*se,ge[se+256>>0]=38470*se,ge[se+512>>0]=7471*se+32768,ge[se+768>>0]=-11059*se,ge[se+1024>>0]=-21709*se,ge[se+1280>>0]=32768*se+8421375,ge[se+1536>>0]=-27439*se,ge[se+1792>>0]=-5329*se}(),xt(r)}/**
* @license
* Copyright (c) 2017 Aras Abbasi
*
* Licensed under the MIT License.
* http://opensource.org/licenses/mit-license
*/function Wc(r,e){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function XF(r){function e(fe){if(!fe)throw Error("assert :P")}function t(fe,Oe,Fe){for(var oe=0;4>oe;oe++)if(fe[Oe+oe]!=Fe.charCodeAt(oe))return!0;return!1}function n(fe,Oe,Fe,oe,le){for(var xe=0;xe<le;xe++)fe[Oe+xe]=Fe[oe+xe]}function i(fe,Oe,Fe,oe){for(var le=0;le<oe;le++)fe[Oe+le]=Fe}function s(fe){return new Int32Array(fe)}function a(fe,Oe){for(var Fe=[],oe=0;oe<fe;oe++)Fe.push(new Oe);return Fe}function o(fe,Oe){var Fe=[];return function oe(le,xe,_e){for(var tt=_e[xe],et=0;et<tt&&(le.push(_e.length>xe+1?[]:new Oe),!(_e.length<xe+1));et++)oe(le[et],xe+1,_e)}(Fe,0,fe),Fe}var A=function(){var fe=this;function Oe(g,w){for(var T=1<<w-1>>>0;g&T;)T>>>=1;return T?(g&T-1)+T:g}function Fe(g,w,T,L,D){e(!(L%T));do g[w+(L-=T)]=D;while(0<L)}function oe(g,w,T,L,D){if(e(2328>=D),512>=D)var H=s(512);else if((H=s(D))==null)return 0;return function(z,j,V,X,ue,ne){var de,me,Ue=j,Ie=1<<V,ve=s(16),we=s(16);for(e(ue!=0),e(X!=null),e(z!=null),e(0<V),me=0;me<ue;++me){if(15<X[me])return 0;++ve[X[me]]}if(ve[0]==ue)return 0;for(we[1]=0,de=1;15>de;++de){if(ve[de]>1<<de)return 0;we[de+1]=we[de]+ve[de]}for(me=0;me<ue;++me)de=X[me],0<X[me]&&(ne[we[de]++]=me);if(we[15]==1)return(X=new le).g=0,X.value=ne[0],Fe(z,Ue,1,Ie,X),Ie;var Ve,Xe=-1,At=Ie-1,ht=0,_t=1,Ot=1,Et=1<<V;for(me=0,de=1,ue=2;de<=V;++de,ue<<=1){if(_t+=Ot<<=1,0>(Ot-=ve[de]))return 0;for(;0<ve[de];--ve[de])(X=new le).g=de,X.value=ne[me++],Fe(z,Ue+ht,ue,Et,X),ht=Oe(ht,de)}for(de=V+1,ue=2;15>=de;++de,ue<<=1){if(_t+=Ot<<=1,0>(Ot-=ve[de]))return 0;for(;0<ve[de];--ve[de]){if(X=new le,(ht&At)!=Xe){for(Ue+=Et,Ve=1<<(Xe=de)-V;15>Xe&&!(0>=(Ve-=ve[Xe]));)++Xe,Ve<<=1;Ie+=Et=1<<(Ve=Xe-V),z[j+(Xe=ht&At)].g=Ve+V,z[j+Xe].value=Ue-j-Xe}X.g=de-V,X.value=ne[me++],Fe(z,Ue+(ht>>V),ue,Et,X),ht=Oe(ht,de)}}return _t!=2*we[15]-1?0:Ie}(g,w,T,L,D,H)}function le(){this.value=this.g=0}function xe(){this.value=this.g=0}function _e(){this.G=a(5,le),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(cs,xe)}function tt(g,w,T,L){e(g!=null),e(w!=null),e(2147483648>L),g.Ca=254,g.I=0,g.b=-8,g.Ka=0,g.oa=w,g.pa=T,g.Jd=w,g.Yc=T+L,g.Zc=4<=L?T+L-4+1:T,qe(g)}function et(g,w){for(var T=0;0<w--;)T|=st(g,128)<<w;return T}function nt(g,w){var T=et(g,w);return ct(g)?-T:T}function Je(g,w,T,L){var D,H=0;for(e(g!=null),e(w!=null),e(4294967288>L),g.Sb=L,g.Ra=0,g.u=0,g.h=0,4<L&&(L=4),D=0;D<L;++D)H+=w[T+D]<<8*D;g.Ra=H,g.bb=L,g.oa=w,g.pa=T}function it(g){for(;8<=g.u&&g.bb<g.Sb;)g.Ra>>>=8,g.Ra+=g.oa[g.pa+g.bb]<<ml-8>>>0,++g.bb,g.u-=8;Me(g)&&(g.h=1,g.u=0)}function ot(g,w){if(e(0<=w),!g.h&&w<=gl){var T=be(g)&Cc[w];return g.u+=w,it(g),T}return g.h=1,g.u=0}function xt(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function se(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function be(g){return g.Ra>>>(g.u&ml-1)>>>0}function Me(g){return e(g.bb<=g.Sb),g.h||g.bb==g.Sb&&g.u>ml}function De(g,w){g.u=w,g.h=Me(g)}function $e(g){g.u>=Ec&&(e(g.u>=Ec),it(g))}function qe(g){e(g!=null&&g.oa!=null),g.pa<g.Zc?(g.I=(g.oa[g.pa++]|g.I<<8)>>>0,g.b+=8):(e(g!=null&&g.oa!=null),g.pa<g.Yc?(g.b+=8,g.I=g.oa[g.pa++]|g.I<<8):g.Ka?g.b=0:(g.I<<=8,g.b+=8,g.Ka=1))}function ct(g){return et(g,1)}function st(g,w){var T=g.Ca;0>g.b&&qe(g);var L=g.b,D=T*w>>>8,H=(g.I>>>L>D)+0;for(H?(T-=D,g.I-=D+1<<L>>>0):T=D+1,L=T,D=0;256<=L;)D+=8,L>>=8;return L=7^D+vs[L],g.b-=L,g.Ca=(T<<L)-1,H}function Ct(g,w,T){g[w+0]=T>>24&255,g[w+1]=T>>16&255,g[w+2]=T>>8&255,g[w+3]=T>>0&255}function It(g,w){return g[w+0]<<0|g[w+1]<<8}function Qt(g,w){return It(g,w)|g[w+2]<<16}function Ht(g,w){return It(g,w)|It(g,w+2)<<16}function zt(g,w){var T=1<<w;return e(g!=null),e(0<w),g.X=s(T),g.X==null?0:(g.Mb=32-w,g.Xa=w,1)}function mt(g,w){e(g!=null),e(w!=null),e(g.Xa==w.Xa),n(w.X,0,g.X,0,1<<w.Xa)}function Re(){this.X=[],this.Xa=this.Mb=0}function Ye(g,w,T,L){e(T!=null),e(L!=null);var D=T[0],H=L[0];return D==0&&(D=(g*H+w/2)/w),H==0&&(H=(w*D+g/2)/g),0>=D||0>=H?0:(T[0]=D,L[0]=H,1)}function tr(g,w){return g+(1<<w)-1>>>w}function St(g,w){return((4278255360&g)+(4278255360&w)>>>0&4278255360)+((16711935&g)+(16711935&w)>>>0&16711935)>>>0}function vt(g,w){fe[w]=function(T,L,D,H,z,j,V){var X;for(X=0;X<z;++X){var ue=fe[g](j[V+X-1],D,H+X);j[V+X]=St(T[L+X],ue)}}}function Bt(){this.ud=this.hd=this.jd=0}function kt(g,w){return((4278124286&(g^w))>>>1)+(g&w)>>>0}function ir(g){return 0<=g&&256>g?g:0>g?0:255<g?255:void 0}function Ar(g,w){return ir(g+(g-w+.5>>1))}function Lr(g,w,T){return Math.abs(w-T)-Math.abs(g-T)}function Tr(g,w,T,L,D,H,z){for(L=H[z-1],T=0;T<D;++T)H[z+T]=L=St(g[w+T],L)}function kr(g,w,T,L,D){var H;for(H=0;H<T;++H){var z=g[w+H],j=z>>8&255,V=16711935&(V=(V=16711935&z)+((j<<16)+j));L[D+H]=(4278255360&z)+V>>>0}}function Qr(g,w){w.jd=g>>0&255,w.hd=g>>8&255,w.ud=g>>16&255}function pt(g,w,T,L,D,H){var z;for(z=0;z<L;++z){var j=w[T+z],V=j>>>8,X=j,ue=255&(ue=(ue=j>>>16)+((g.jd<<24>>24)*(V<<24>>24)>>>5));X=255&(X=(X=X+((g.hd<<24>>24)*(V<<24>>24)>>>5))+((g.ud<<24>>24)*(ue<<24>>24)>>>5)),D[H+z]=(4278255360&j)+(ue<<16)+X}}function Ir(g,w,T,L,D){fe[w]=function(H,z,j,V,X,ue,ne,de,me){for(V=ne;V<de;++V)for(ne=0;ne<me;++ne)X[ue++]=D(j[L(H[z++])])},fe[g]=function(H,z,j,V,X,ue,ne){var de=8>>H.b,me=H.Ea,Ue=H.K[0],Ie=H.w;if(8>de)for(H=(1<<H.b)-1,Ie=(1<<de)-1;z<j;++z){var ve,we=0;for(ve=0;ve<me;++ve)ve&H||(we=L(V[X++])),ue[ne++]=D(Ue[we&Ie]),we>>=de}else fe["VP8LMapColor"+T](V,X,Ue,Ie,ue,ne,z,j,me)}}function Dt(g,w,T,L,D){for(T=w+T;w<T;){var H=g[w++];L[D++]=H>>16&255,L[D++]=H>>8&255,L[D++]=H>>0&255}}function xn(g,w,T,L,D){for(T=w+T;w<T;){var H=g[w++];L[D++]=H>>16&255,L[D++]=H>>8&255,L[D++]=H>>0&255,L[D++]=H>>24&255}}function Mr(g,w,T,L,D){for(T=w+T;w<T;){var H=(z=g[w++])>>16&240|z>>12&15,z=z>>0&240|z>>28&15;L[D++]=H,L[D++]=z}}function Tt(g,w,T,L,D){for(T=w+T;w<T;){var H=(z=g[w++])>>16&248|z>>13&7,z=z>>5&224|z>>3&31;L[D++]=H,L[D++]=z}}function Jt(g,w,T,L,D){for(T=w+T;w<T;){var H=g[w++];L[D++]=H>>0&255,L[D++]=H>>8&255,L[D++]=H>>16&255}}function Kt(g,w,T,L,D,H){if(H==0)for(T=w+T;w<T;)Ct(L,((H=g[w++])[0]>>24|H[1]>>8&65280|H[2]<<8&16711680|H[3]<<24)>>>0),D+=32;else n(L,D,g,w,T)}function Yr(g,w){fe[w][0]=fe[g+"0"],fe[w][1]=fe[g+"1"],fe[w][2]=fe[g+"2"],fe[w][3]=fe[g+"3"],fe[w][4]=fe[g+"4"],fe[w][5]=fe[g+"5"],fe[w][6]=fe[g+"6"],fe[w][7]=fe[g+"7"],fe[w][8]=fe[g+"8"],fe[w][9]=fe[g+"9"],fe[w][10]=fe[g+"10"],fe[w][11]=fe[g+"11"],fe[w][12]=fe[g+"12"],fe[w][13]=fe[g+"13"],fe[w][14]=fe[g+"0"],fe[w][15]=fe[g+"0"]}function Or(g){return g==zn||g==wl||g==xl||g==iA}function gr(){this.eb=[],this.size=this.A=this.fb=0}function an(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Wr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new gr,this.f.kb=new an,this.sd=null}function Ee(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ee(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Z(g){return alert("todo:WebPSamplerProcessPlane"),g.T}function ae(g,w){var T=g.T,L=w.ba.f.RGBA,D=L.eb,H=L.fb+g.ka*L.A,z=Es[w.ba.S],j=g.y,V=g.O,X=g.f,ue=g.N,ne=g.ea,de=g.W,me=w.cc,Ue=w.dc,Ie=w.Mc,ve=w.Nc,we=g.ka,Ve=g.ka+g.T,Xe=g.U,At=Xe+1>>1;for(we==0?z(j,V,null,null,X,ue,ne,de,X,ue,ne,de,D,H,null,null,Xe):(z(w.ec,w.fc,j,V,me,Ue,Ie,ve,X,ue,ne,de,D,H-L.A,D,H,Xe),++T);we+2<Ve;we+=2)me=X,Ue=ue,Ie=ne,ve=de,ue+=g.Rc,de+=g.Rc,H+=2*L.A,z(j,(V+=2*g.fa)-g.fa,j,V,me,Ue,Ie,ve,X,ue,ne,de,D,H-L.A,D,H,Xe);return V+=g.fa,g.j+Ve<g.o?(n(w.ec,w.fc,j,V,Xe),n(w.cc,w.dc,X,ue,At),n(w.Mc,w.Nc,ne,de,At),T--):1&Ve||z(j,V,null,null,X,ue,ne,de,X,ue,ne,de,D,H+L.A,null,null,Xe),T}function Se(g,w,T){var L=g.F,D=[g.J];if(L!=null){var H=g.U,z=w.ba.S,j=z==nA||z==xl;w=w.ba.f.RGBA;var V=[0],X=g.ka;V[0]=g.T,g.Kb&&(X==0?--V[0]:(--X,D[0]-=g.width),g.j+g.ka+g.T==g.o&&(V[0]=g.o-g.j-X));var ue=w.eb;X=w.fb+X*w.A,g=Ka(L,D[0],g.width,H,V,ue,X+(j?0:3),w.A),e(T==V),g&&Or(z)&&xa(ue,X,j,H,V,w.A)}return 0}function Qe(g){var w=g.ma,T=w.ba.S,L=11>T,D=T==vl||T==bl||T==nA||T==fd||T==12||Or(T);if(w.memory=null,w.Ib=null,w.Jb=null,w.Nd=null,!Bc(w.Oa,g,D?11:12))return 0;if(D&&Or(T)&&Pt(),g.da)alert("todo:use_scaling");else{if(L){if(w.Ib=Z,g.Kb){if(T=g.U+1>>1,w.memory=s(g.U+2*T),w.memory==null)return 0;w.ec=w.memory,w.fc=0,w.cc=w.ec,w.dc=w.fc+g.U,w.Mc=w.cc,w.Nc=w.dc+T,w.Ib=ae,Pt()}}else alert("todo:EmitYUV");D&&(w.Jb=Se,L&&at())}if(L&&!oh){for(g=0;256>g;++g)bd[g]=89858*(g-128)+$a>>Cl,C[g]=-22014*(g-128)+$a,cp[g]=-45773*(g-128),ah[g]=113618*(g-128)+$a>>Cl;for(g=ta;g<fu;++g)w=76283*(g-16)+$a>>Cl,l[g-ta]=Ns(w,255),d[g-ta]=Ns(w+8>>4,15);oh=1}return 1}function Ge(g){var w=g.ma,T=g.U,L=g.T;return e(!(1&g.ka)),0>=T||0>=L?0:(T=w.Ib(g,w),w.Jb!=null&&w.Jb(g,w,T),w.Dc+=T,1)}function Ke(g){g.ma.memory=null}function Te(g,w,T,L){return ot(g,8)!=47?0:(w[0]=ot(g,14)+1,T[0]=ot(g,14)+1,L[0]=ot(g,1),ot(g,3)!=0?0:!g.h)}function Ze(g,w){if(4>g)return g+1;var T=g-2>>1;return(2+(1&g)<<T)+ot(w,T)+1}function yt(g,w){return 120<w?w-120:1<=(T=((T=dr[w-1])>>4)*g+(8-(15&T)))?T:1;var T}function gt(g,w,T){var L=be(T),D=g[w+=255&L].g-8;return 0<D&&(De(T,T.u+8),L=be(T),w+=g[w].value,w+=L&(1<<D)-1),De(T,T.u+g[w].g),g[w].value}function ft(g,w,T){return T.g+=g.g,T.value+=g.value<<w>>>0,e(8>=T.g),g.g}function Vt(g,w,T){var L=g.xc;return e((w=L==0?0:g.vc[g.md*(T>>L)+(w>>L)])<g.Wb),g.Ya[w]}function Yt(g,w,T,L){var D=g.ab,H=g.c*w,z=g.C;w=z+w;var j=T,V=L;for(L=g.Ta,T=g.Ua;0<D--;){var X=g.gc[D],ue=z,ne=w,de=j,me=V,Ue=(V=L,j=T,X.Ea);switch(e(ue<ne),e(ne<=X.nc),X.hc){case 2:$n(de,me,(ne-ue)*Ue,V,j);break;case 0:var Ie=ue,ve=ne,we=V,Ve=j,Xe=(Et=X).Ea;Ie==0&&(dd(de,me,null,null,1,we,Ve),Tr(de,me+1,0,0,Xe-1,we,Ve+1),me+=Xe,Ve+=Xe,++Ie);for(var At=1<<Et.b,ht=At-1,_t=tr(Xe,Et.b),Ot=Et.K,Et=Et.w+(Ie>>Et.b)*_t;Ie<ve;){var $t=Ot,nr=Et,rr=1;for(lu(de,me,we,Ve-Xe,1,we,Ve);rr<Xe;){var Sr=(rr&~ht)+At;Sr>Xe&&(Sr=Xe),(0,Va[$t[nr++]>>8&15])(de,me+ +rr,we,Ve+rr-Xe,Sr-rr,we,Ve+rr),rr=Sr}me+=Xe,Ve+=Xe,++Ie&ht||(Et+=_t)}ne!=X.nc&&n(V,j-Ue,V,j+(ne-ue-1)*Ue,Ue);break;case 1:for(Ue=de,ve=me,Xe=(de=X.Ea)-(Ve=de&~(we=(me=1<<X.b)-1)),Ie=tr(de,X.b),At=X.K,X=X.w+(ue>>X.b)*Ie;ue<ne;){for(ht=At,_t=X,Ot=new Bt,Et=ve+Ve,$t=ve+de;ve<Et;)Qr(ht[_t++],Ot),Di(Ot,Ue,ve,me,V,j),ve+=me,j+=me;ve<$t&&(Qr(ht[_t++],Ot),Di(Ot,Ue,ve,Xe,V,j),ve+=Xe,j+=Xe),++ue&we||(X+=Ie)}break;case 3:if(de==V&&me==j&&0<X.b){for(ve=V,de=Ue=j+(ne-ue)*Ue-(Ve=(ne-ue)*tr(X.Ea,X.b)),me=V,we=j,Ie=[],Ve=(Xe=Ve)-1;0<=Ve;--Ve)Ie[Ve]=me[we+Ve];for(Ve=Xe-1;0<=Ve;--Ve)ve[de+Ve]=Ie[Ve];qi(X,ue,ne,V,Ue,V,j)}else qi(X,ue,ne,de,me,V,j)}j=L,V=T}V!=T&&n(L,T,j,V,H)}function Er(g,w){var T=g.V,L=g.Ba+g.c*g.C,D=w-g.C;if(e(w<=g.l.o),e(16>=D),0<D){var H=g.l,z=g.Ta,j=g.Ua,V=H.width;if(Yt(g,D,T,L),D=j=[j],e((T=g.C)<(L=w)),e(H.v<H.va),L>H.o&&(L=H.o),T<H.j){var X=H.j-T;T=H.j,D[0]+=X*V}if(T>=L?T=0:(D[0]+=4*H.v,H.ka=T-H.j,H.U=H.va-H.v,H.T=L-T,T=1),T){if(j=j[0],11>(T=g.ca).S){var ue=T.f.RGBA,ne=(L=T.S,D=H.U,H=H.T,X=ue.eb,ue.A),de=H;for(ue=ue.fb+g.Ma*ue.A;0<de--;){var me=z,Ue=j,Ie=D,ve=X,we=ue;switch(L){case rA:Ki(me,Ue,Ie,ve,we);break;case vl:Zs(me,Ue,Ie,ve,we);break;case zn:Zs(me,Ue,Ie,ve,we),xa(ve,we,0,Ie,1,0);break;case nh:Sc(me,Ue,Ie,ve,we);break;case bl:Kt(me,Ue,Ie,ve,we,1);break;case wl:Kt(me,Ue,Ie,ve,we,1),xa(ve,we,0,Ie,1,0);break;case nA:Kt(me,Ue,Ie,ve,we,0);break;case xl:Kt(me,Ue,Ie,ve,we,0),xa(ve,we,1,Ie,1,0);break;case fd:bo(me,Ue,Ie,ve,we);break;case iA:bo(me,Ue,Ie,ve,we),Au(ve,we,Ie,1,0);break;case Wa:wo(me,Ue,Ie,ve,we);break;default:e(0)}j+=V,ue+=ne}g.Ma+=H}else alert("todo:EmitRescaledRowsYUVA");e(g.Ma<=T.height)}}g.C=w,e(g.C<=g.i)}function lr(g){var w;if(0<g.ua)return 0;for(w=0;w<g.Wb;++w){var T=g.Ya[w].G,L=g.Ya[w].H;if(0<T[1][L[1]+0].g||0<T[2][L[2]+0].g||0<T[3][L[3]+0].g)return 0}return 1}function Ur(g,w,T,L,D,H){if(g.Z!=0){var z=g.qd,j=g.rd;for(e(Co[g.Z]!=null);w<T;++w)Co[g.Z](z,j,L,D,L,D,H),z=L,j=D,D+=H;g.qd=z,g.rd=j}}function Nr(g,w){var T=g.l.ma,L=T.Z==0||T.Z==1?g.l.j:g.C;if(L=g.C<L?L:g.C,e(w<=g.l.o),w>L){var D=g.l.width,H=T.ca,z=T.tb+D*L,j=g.V,V=g.Ba+g.c*L,X=g.gc;e(g.ab==1),e(X[0].hc==3),eA(X[0],L,w,j,V,H,z),Ur(T,L,w,H,z,D)}g.C=g.Ma=w}function Hr(g,w,T,L,D,H,z){var j=g.$/L,V=g.$%L,X=g.m,ue=g.s,ne=T+g.$,de=ne;D=T+L*D;var me=T+L*H,Ue=280+ue.ua,Ie=g.Pb?j:16777216,ve=0<ue.ua?ue.Wa:null,we=ue.wc,Ve=ne<me?Vt(ue,V,j):null;e(g.C<H),e(me<=D);var Xe=!1;e:for(;;){for(;Xe||ne<me;){var At=0;if(j>=Ie){var ht=ne-T;e((Ie=g).Pb),Ie.wd=Ie.m,Ie.xd=ht,0<Ie.s.ua&&mt(Ie.s.Wa,Ie.s.vb),Ie=j+ih}if(V&we||(Ve=Vt(ue,V,j)),e(Ve!=null),Ve.Qb&&(w[ne]=Ve.qb,Xe=!0),!Xe)if($e(X),Ve.jc){At=X,ht=w;var _t=ne,Ot=Ve.pd[be(At)&cs-1];e(Ve.jc),256>Ot.g?(De(At,At.u+Ot.g),ht[_t]=Ot.value,At=0):(De(At,At.u+Ot.g-256),e(256<=Ot.value),At=Ot.value),At==0&&(Xe=!0)}else At=gt(Ve.G[0],Ve.H[0],X);if(X.h)break;if(Xe||256>At){if(!Xe)if(Ve.nd)w[ne]=(Ve.qb|At<<8)>>>0;else{if($e(X),Xe=gt(Ve.G[1],Ve.H[1],X),$e(X),ht=gt(Ve.G[2],Ve.H[2],X),_t=gt(Ve.G[3],Ve.H[3],X),X.h)break;w[ne]=(_t<<24|Xe<<16|At<<8|ht)>>>0}if(Xe=!1,++ne,++V>=L&&(V=0,++j,z!=null&&j<=H&&!(j%16)&&z(g,j),ve!=null))for(;de<ne;)At=w[de++],ve.X[(506832829*At&4294967295)>>>ve.Mb]=At}else if(280>At){if(At=Ze(At-256,X),ht=gt(Ve.G[4],Ve.H[4],X),$e(X),ht=yt(L,ht=Ze(ht,X)),X.h)break;if(ne-T<ht||D-ne<At)break e;for(_t=0;_t<At;++_t)w[ne+_t]=w[ne+_t-ht];for(ne+=At,V+=At;V>=L;)V-=L,++j,z!=null&&j<=H&&!(j%16)&&z(g,j);if(e(ne<=D),V&we&&(Ve=Vt(ue,V,j)),ve!=null)for(;de<ne;)At=w[de++],ve.X[(506832829*At&4294967295)>>>ve.Mb]=At}else{if(!(At<Ue))break e;for(Xe=At-280,e(ve!=null);de<ne;)At=w[de++],ve.X[(506832829*At&4294967295)>>>ve.Mb]=At;At=ne,e(!(Xe>>>(ht=ve).Xa)),w[At]=ht.X[Xe],Xe=!0}Xe||e(X.h==Me(X))}if(g.Pb&&X.h&&ne<D)e(g.m.h),g.a=5,g.m=g.wd,g.$=g.xd,0<g.s.ua&&mt(g.s.vb,g.s.Wa);else{if(X.h)break e;z!=null&&z(g,j>H?H:j),g.a=0,g.$=ne-T}return 1}return g.a=3,0}function mn(g){e(g!=null),g.vc=null,g.yc=null,g.Ya=null;var w=g.Wa;w!=null&&(w.X=null),g.vb=null,e(g!=null)}function mr(){var g=new Zu;return g==null?null:(g.a=0,g.xb=sh,Yr("Predictor","VP8LPredictors"),Yr("Predictor","VP8LPredictors_C"),Yr("PredictorAdd","VP8LPredictorsAdd"),Yr("PredictorAdd","VP8LPredictorsAdd_C"),$n=kr,Di=pt,Ki=Dt,Zs=xn,bo=Mr,wo=Tt,Sc=Jt,fe.VP8LMapColor32b=Oi,fe.VP8LMapColor8b=uu,g)}function $r(g,w,T,L,D){var H=1,z=[g],j=[w],V=L.m,X=L.s,ue=null,ne=0;e:for(;;){if(T)for(;H&&ot(V,1);){var de=z,me=j,Ue=L,Ie=1,ve=Ue.m,we=Ue.gc[Ue.ab],Ve=ot(ve,2);if(Ue.Oc&1<<Ve)H=0;else{switch(Ue.Oc|=1<<Ve,we.hc=Ve,we.Ea=de[0],we.nc=me[0],we.K=[null],++Ue.ab,e(4>=Ue.ab),Ve){case 0:case 1:we.b=ot(ve,3)+2,Ie=$r(tr(we.Ea,we.b),tr(we.nc,we.b),0,Ue,we.K),we.K=we.K[0];break;case 3:var Xe,At=ot(ve,8)+1,ht=16<At?0:4<At?1:2<At?2:3;if(de[0]=tr(we.Ea,ht),we.b=ht,Xe=Ie=$r(At,1,0,Ue,we.K)){var _t,Ot=At,Et=we,$t=1<<(8>>Et.b),nr=s($t);if(nr==null)Xe=0;else{var rr=Et.K[0],Sr=Et.w;for(nr[0]=Et.K[0][0],_t=1;_t<1*Ot;++_t)nr[_t]=St(rr[Sr+_t],nr[_t-1]);for(;_t<4*$t;++_t)nr[_t]=0;Et.K[0]=null,Et.K[0]=nr,Xe=1}}Ie=Xe;break;case 2:break;default:e(0)}H=Ie}}if(z=z[0],j=j[0],H&&ot(V,1)&&!(H=1<=(ne=ot(V,4))&&11>=ne)){L.a=3;break e}var Fr;if(Fr=H)t:{var en,xr,Jr,Cn=L,En=z,di=j,dn=ne,ls=T,Fi=Cn.m,Gn=Cn.s,fn=[null],on=1,pn=0,Si=wr[dn];r:for(;;){if(ls&&ot(Fi,1)){var un=ot(Fi,3)+2,Sn=tr(En,un),Xi=tr(di,un),ti=Sn*Xi;if(!$r(Sn,Xi,0,Cn,fn))break r;for(fn=fn[0],Gn.xc=un,en=0;en<ti;++en){var Rn=fn[en]>>8&65535;fn[en]=Rn,Rn>=on&&(on=Rn+1)}}if(Fi.h)break r;for(xr=0;5>xr;++xr){var oi=pd[xr];!xr&&0<dn&&(oi+=1<<dn),pn<oi&&(pn=oi)}var ch=a(on*Si,le),Ic=on,Lc=a(Ic,_e);if(Lc==null)var Sl=null;else e(65536>=Ic),Sl=Lc;var Eo=s(pn);if(Sl==null||Eo==null||ch==null){Cn.a=1;break r}var pu=ch;for(en=Jr=0;en<on;++en){var So=Sl[en],Fc=So.G,Mc=So.H,hA=0,gu=1,lp=0;for(xr=0;5>xr;++xr){oi=pd[xr],Fc[xr]=pu,Mc[xr]=Jr,!xr&&0<dn&&(oi+=1<<dn);i:{var wd,up=oi,Tl=Cn,xd=Eo,Bd=pu,Ap=Jr,lh=0,Il=Tl.m,m_=ot(Il,1);if(i(xd,0,0,up),m_){var rE=ot(Il,1)+1,zs=ot(Il,1),dA=ot(Il,zs==0?1:8);xd[dA]=1,rE==2&&(xd[dA=ot(Il,8)]=1);var uh=1}else{var bm=s(19),Ah=ot(Il,4)+4;if(19<Ah){Tl.a=3;var hp=0;break i}for(wd=0;wd<Ah;++wd)bm[sA[wd]]=ot(Il,3);var hh=void 0,Cd=void 0,wm=Tl,y_=bm,Ed=up,__=xd,Sd=0,Ll=wm.m,dp=8,dh=a(128,le);n:for(;oe(dh,0,7,y_,19);){if(ot(Ll,1)){var ra=2+2*ot(Ll,3);if((hh=2+ot(Ll,ra))>Ed)break n}else hh=Ed;for(Cd=0;Cd<Ed&&hh--;){$e(Ll);var xm=dh[0+(127&be(Ll))];De(Ll,Ll.u+xm.g);var fh=xm.value;if(16>fh)__[Cd++]=fh,fh!=0&&(dp=fh);else{var v_=fh==16,b_=fh-16,nE=op[b_],w_=ot(Ll,sp[b_])+nE;if(Cd+w_>Ed)break n;for(var iE=v_?dp:0;0<w_--;)__[Cd++]=iE}}Sd=1;break n}Sd||(wm.a=3),uh=Sd}(uh=uh&&!Il.h)&&(lh=oe(Bd,Ap,8,xd,up)),uh&&lh!=0?hp=lh:(Tl.a=3,hp=0)}if(hp==0)break r;if(gu&&Yo[xr]==1&&(gu=pu[Jr].g==0),hA+=pu[Jr].g,Jr+=hp,3>=xr){var fA,ph=Eo[0];for(fA=1;fA<oi;++fA)Eo[fA]>ph&&(ph=Eo[fA]);lp+=ph}}if(So.nd=gu,So.Qb=0,gu&&(So.qb=(Fc[3][Mc[3]+0].value<<24|Fc[1][Mc[1]+0].value<<16|Fc[2][Mc[2]+0].value)>>>0,hA==0&&256>Fc[0][Mc[0]+0].value&&(So.Qb=1,So.qb+=Fc[0][Mc[0]+0].value<<8)),So.jc=!So.Qb&&6>lp,So.jc){var Td,ro=So;for(Td=0;Td<cs;++Td){var Ca=Td,mu=ro.pd[Ca],fp=ro.G[0][ro.H[0]+Ca];256<=fp.value?(mu.g=fp.g+256,mu.value=fp.value):(mu.g=0,mu.value=0,Ca>>=ft(fp,8,mu),Ca>>=ft(ro.G[1][ro.H[1]+Ca],16,mu),Ca>>=ft(ro.G[2][ro.H[2]+Ca],0,mu),ft(ro.G[3][ro.H[3]+Ca],24,mu))}}}Gn.vc=fn,Gn.Wb=on,Gn.Ya=Sl,Gn.yc=ch,Fr=1;break t}Fr=0}if(!(H=Fr)){L.a=3;break e}if(0<ne){if(X.ua=1<<ne,!zt(X.Wa,ne)){L.a=1,H=0;break e}}else X.ua=0;var Bm=L,x_=z,sE=j,Cm=Bm.s,Em=Cm.xc;if(Bm.c=x_,Bm.i=sE,Cm.md=tr(x_,Em),Cm.wc=Em==0?-1:(1<<Em)-1,T){L.xb=yd;break e}if((ue=s(z*j))==null){L.a=1,H=0;break e}H=(H=Hr(L,ue,0,z,j,j,null))&&!V.h;break e}return H?(D!=null?D[0]=ue:(e(ue==null),e(T)),L.$=0,T||mn(X)):mn(X),H}function bn(g,w){var T=g.c*g.i,L=T+w+16*w;return e(g.c<=w),g.V=s(L),g.V==null?(g.Ta=null,g.Ua=0,g.a=1,0):(g.Ta=g.V,g.Ua=g.Ba+T+w,1)}function kn(g,w){var T=g.C,L=w-T,D=g.V,H=g.Ba+g.c*T;for(e(w<=g.l.o);0<L;){var z=16<L?16:L,j=g.l.ma,V=g.l.width,X=V*z,ue=j.ca,ne=j.tb+V*T,de=g.Ta,me=g.Ua;Yt(g,z,D,H),hu(de,me,ue,ne,X),Ur(j,T,T+z,ue,ne,V),L-=z,D+=z*g.c,T+=z}e(T==w),g.C=g.Ma=w}function ke(){this.ub=this.yd=this.td=this.Rb=0}function Rt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Lt(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function nn(){this.Yb=function(){var g=[];return function w(T,L,D){for(var H=D[L],z=0;z<H&&(T.push(D.length>L+1?[]:0),!(D.length<L+1));z++)w(T[z],L+1,D)}(g,0,[3,11]),g}()}function Pn(){this.jb=s(3),this.Wc=o([4,8],nn),this.Xc=o([4,17],nn)}function Br(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function yn(){this.ld=this.La=this.dd=this.tc=0}function wi(){this.Na=this.la=0}function _n(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function sn(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function xi(){this.uc=this.M=this.Nb=0,this.wa=Array(new yn),this.Y=0,this.ya=Array(new sn),this.aa=0,this.l=new Os}function Jn(){this.y=s(16),this.f=s(8),this.ea=s(8)}function as(){this.cb=this.a=0,this.sc="",this.m=new xt,this.Od=new ke,this.Kc=new Rt,this.ed=new Br,this.Qa=new Lt,this.Ic=this.$c=this.Aa=0,this.D=new xi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,xt),this.ia=0,this.pb=a(4,_n),this.Pa=new Pn,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Jn),this.Hd=0,this.rb=Array(new wi),this.sb=0,this.wa=Array(new yn),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new sn),this.L=this.aa=0,this.gd=o([4,2],yn),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Os(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function zo(){var g=new as;return g!=null&&(g.a=0,g.sc="OK",g.cb=0,g.Xb=0,$i||($i=In)),g}function Dr(g,w,T){return g.a==0&&(g.a=w,g.sc=T,g.cb=0),0}function Js(g,w,T){return 3<=T&&g[w+0]==157&&g[w+1]==1&&g[w+2]==42}function Cs(g,w){if(g==null)return 0;if(g.a=0,g.sc="OK",w==null)return Dr(g,2,"null VP8Io passed to VP8GetHeaders()");var T=w.data,L=w.w,D=w.ha;if(4>D)return Dr(g,7,"Truncated header.");var H=T[L+0]|T[L+1]<<8|T[L+2]<<16,z=g.Od;if(z.Rb=!(1&H),z.td=H>>1&7,z.yd=H>>4&1,z.ub=H>>5,3<z.td)return Dr(g,3,"Incorrect keyframe parameters.");if(!z.yd)return Dr(g,4,"Frame not displayable.");L+=3,D-=3;var j=g.Kc;if(z.Rb){if(7>D)return Dr(g,7,"cannot parse picture header");if(!Js(T,L,D))return Dr(g,3,"Bad code word");j.c=16383&(T[L+4]<<8|T[L+3]),j.Td=T[L+4]>>6,j.i=16383&(T[L+6]<<8|T[L+5]),j.Ud=T[L+6]>>6,L+=7,D-=7,g.za=j.c+15>>4,g.Ub=j.i+15>>4,w.width=j.c,w.height=j.i,w.Da=0,w.j=0,w.v=0,w.va=w.width,w.o=w.height,w.da=0,w.ib=w.width,w.hb=w.height,w.U=w.width,w.T=w.height,i((H=g.Pa).jb,0,255,H.jb.length),e((H=g.Qa)!=null),H.Cb=0,H.Bb=0,H.Fb=1,i(H.Zb,0,0,H.Zb.length),i(H.Lb,0,0,H.Lb)}if(z.ub>D)return Dr(g,7,"bad partition length");tt(H=g.m,T,L,z.ub),L+=z.ub,D-=z.ub,z.Rb&&(j.Ld=ct(H),j.Kd=ct(H)),j=g.Qa;var V,X=g.Pa;if(e(H!=null),e(j!=null),j.Cb=ct(H),j.Cb){if(j.Bb=ct(H),ct(H)){for(j.Fb=ct(H),V=0;4>V;++V)j.Zb[V]=ct(H)?nt(H,7):0;for(V=0;4>V;++V)j.Lb[V]=ct(H)?nt(H,6):0}if(j.Bb)for(V=0;3>V;++V)X.jb[V]=ct(H)?et(H,8):255}else j.Bb=0;if(H.Ka)return Dr(g,3,"cannot parse segment header");if((j=g.ed).zd=ct(H),j.Tb=et(H,6),j.wb=et(H,3),j.Pc=ct(H),j.Pc&&ct(H)){for(X=0;4>X;++X)ct(H)&&(j.vd[X]=nt(H,6));for(X=0;4>X;++X)ct(H)&&(j.od[X]=nt(H,6))}if(g.L=j.Tb==0?0:j.zd?1:2,H.Ka)return Dr(g,3,"cannot parse filter header");var ue=D;if(D=V=L,L=V+ue,j=ue,g.Xb=(1<<et(g.m,2))-1,ue<3*(X=g.Xb))T=7;else{for(V+=3*X,j-=3*X,ue=0;ue<X;++ue){var ne=T[D+0]|T[D+1]<<8|T[D+2]<<16;ne>j&&(ne=j),tt(g.Jc[+ue],T,V,ne),V+=ne,j-=ne,D+=3}tt(g.Jc[+X],T,V,j),T=V<L?0:5}if(T!=0)return Dr(g,T,"cannot parse partitions");for(T=et(V=g.m,7),D=ct(V)?nt(V,4):0,L=ct(V)?nt(V,4):0,j=ct(V)?nt(V,4):0,X=ct(V)?nt(V,4):0,V=ct(V)?nt(V,4):0,ue=g.Qa,ne=0;4>ne;++ne){if(ue.Cb){var de=ue.Zb[ne];ue.Fb||(de+=T)}else{if(0<ne){g.pb[ne]=g.pb[0];continue}de=T}var me=g.pb[ne];me.Sc[0]=Bl[Ns(de+D,127)],me.Sc[1]=oA[Ns(de+0,127)],me.Eb[0]=2*Bl[Ns(de+L,127)],me.Eb[1]=101581*oA[Ns(de+j,127)]>>16,8>me.Eb[1]&&(me.Eb[1]=8),me.Qc[0]=Bl[Ns(de+X,117)],me.Qc[1]=oA[Ns(de+V,127)],me.lc=de+V}if(!z.Rb)return Dr(g,4,"Not a key frame.");for(ct(H),z=g.Pa,T=0;4>T;++T){for(D=0;8>D;++D)for(L=0;3>L;++L)for(j=0;11>j;++j)X=st(H,Ei[T][D][L][j])?et(H,8):aA[T][D][L][j],z.Wc[T][D].Yb[L][j]=X;for(D=0;17>D;++D)z.Xc[T][D]=z.Wc[T][ap[D]]}return g.kc=ct(H),g.kc&&(g.Bd=et(H,8)),g.cb=1}function In(g,w,T,L,D,H,z){var j=w[D].Yb[T];for(T=0;16>D;++D){if(!st(g,j[T+0]))return D;for(;!st(g,j[T+1]);)if(j=w[++D].Yb[0],T=0,D==16)return 16;var V=w[D+1].Yb;if(st(g,j[T+2])){var X=g,ue=0;if(st(X,(de=j)[(ne=T)+3]))if(st(X,de[ne+6])){for(j=0,ne=2*(ue=st(X,de[ne+8]))+(de=st(X,de[ne+9+ue])),ue=0,de=gd[ne];de[j];++j)ue+=ue+st(X,de[j]);ue+=3+(8<<ne)}else st(X,de[ne+7])?(ue=7+2*st(X,165),ue+=st(X,145)):ue=5+st(X,159);else ue=st(X,de[ne+4])?3+st(X,de[ne+5]):2;j=V[2]}else ue=1,j=V[1];V=z+Zo[D],0>(X=g).b&&qe(X);var ne,de=X.b,me=(ne=X.Ca>>1)-(X.I>>de)>>31;--X.b,X.Ca+=me,X.Ca|=1,X.I-=(ne+1&me)<<de,H[V]=((ue^me)-me)*L[(0<D)+0]}return 16}function vo(g){var w=g.rb[g.sb-1];w.la=0,w.Na=0,i(g.zc,0,0,g.zc.length),g.ja=0}function Pi(g,w){if(g==null)return 0;if(w==null)return Dr(g,2,"NULL VP8Io parameter in VP8Decode().");if(!g.cb&&!Cs(g,w))return 0;if(e(g.cb),w.ac==null||w.ac(w)){w.ob&&(g.L=0);var T=_[g.L];if(g.L==2?(g.yb=0,g.zb=0):(g.yb=w.v-T>>4,g.zb=w.j-T>>4,0>g.yb&&(g.yb=0),0>g.zb&&(g.zb=0)),g.Va=w.o+15+T>>4,g.Hb=w.va+15+T>>4,g.Hb>g.za&&(g.Hb=g.za),g.Va>g.Ub&&(g.Va=g.Ub),0<g.L){var L=g.ed;for(T=0;4>T;++T){var D;if(g.Qa.Cb){var H=g.Qa.Lb[T];g.Qa.Fb||(H+=L.Tb)}else H=L.Tb;for(D=0;1>=D;++D){var z=g.gd[T][D],j=H;if(L.Pc&&(j+=L.vd[0],D&&(j+=L.od[0])),0<(j=0>j?0:63<j?63:j)){var V=j;0<L.wb&&(V=4<L.wb?V>>2:V>>1)>9-L.wb&&(V=9-L.wb),1>V&&(V=1),z.dd=V,z.tc=2*j+V,z.ld=40<=j?2:15<=j?1:0}else z.tc=0;z.La=D}}}T=0}else Dr(g,6,"Frame setup failed"),T=g.a;if(T=T==0){if(T){g.$c=0,0<g.Aa||(g.Ic=P);e:{T=g.Ic,L=4*(V=g.za);var X=32*V,ue=V+1,ne=0<g.L?V*(0<g.Aa?2:1):0,de=(g.Aa==2?2:1)*V;if((z=L+832+(D=3*(16*T+_[g.L])/2*X)+(H=g.Fa!=null&&0<g.Fa.length?g.Kc.c*g.Kc.i:0))!=z)T=0;else{if(z>g.Vb){if(g.Vb=0,g.Ec=s(z),g.Fc=0,g.Ec==null){T=Dr(g,1,"no memory during frame initialization.");break e}g.Vb=z}z=g.Ec,j=g.Fc,g.Ac=z,g.Bc=j,j+=L,g.Gd=a(X,Jn),g.Hd=0,g.rb=a(ue+1,wi),g.sb=1,g.wa=ne?a(ne,yn):null,g.Y=0,g.D.Nb=0,g.D.wa=g.wa,g.D.Y=g.Y,0<g.Aa&&(g.D.Y+=V),e(!0),g.oc=z,g.pc=j,j+=832,g.ya=a(de,sn),g.aa=0,g.D.ya=g.ya,g.D.aa=g.aa,g.Aa==2&&(g.D.aa+=V),g.R=16*V,g.B=8*V,V=(X=_[g.L])*g.R,X=X/2*g.B,g.sa=z,g.ta=j+V,g.qa=g.sa,g.ra=g.ta+16*T*g.R+X,g.Ha=g.qa,g.Ia=g.ra+8*T*g.B+X,g.$c=0,j+=D,g.mb=H?z:null,g.nb=H?j:null,e(j+H<=g.Fc+g.Vb),vo(g),i(g.Ac,g.Bc,0,L),T=1}}if(T){if(w.ka=0,w.y=g.sa,w.O=g.ta,w.f=g.qa,w.N=g.ra,w.ea=g.Ha,w.Vd=g.Ia,w.fa=g.R,w.Rc=g.B,w.F=null,w.J=0,!_l){for(T=-255;255>=T;++T)Jo[255+T]=0>T?-T:T;for(T=-1020;1020>=T;++T)er[1020+T]=-128>T?-128:127<T?127:T;for(T=-112;112>=T;++T)tA[112+T]=-16>T?-16:15<T?15:T;for(T=-255;510>=T;++T)yl[255+T]=0>T?0:255<T?255:T;_l=1}eo=Be,va=Vo,ja=Ys,xo=fc,ba=he,$o=Go,Tc=nu,wa=yc,Xo=hd,Ci=Ju,Qs=_c,Hs=iu,ki=Yu,vn=th,Ln=ru,Fn=jo,ei=qo,qa=Xu,Ni[0]=_i,Ni[1]=dt,Ni[2]=Qa,Ni[3]=tu,Ni[4]=pc,Ni[5]=pa,Ni[6]=cl,Ni[7]=Ha,Ni[8]=ul,Ni[9]=ll,Bo[0]=ui,Bo[1]=sr,Bo[2]=zr,Bo[3]=Wn,Bo[4]=Nn,Bo[5]=eh,Bo[6]=al,ea[0]=mc,ea[1]=Mt,ea[2]=Ad,ea[3]=$u,ea[4]=ga,ea[5]=za,ea[6]=Ri,T=1}else T=0}T&&(T=function(me,Ue){for(me.M=0;me.M<me.Va;++me.M){var Ie,ve=me.Jc[me.M&me.Xb],we=me.m,Ve=me;for(Ie=0;Ie<Ve.za;++Ie){var Xe=we,At=Ve,ht=At.Ac,_t=At.Bc+4*Ie,Ot=At.zc,Et=At.ya[At.aa+Ie];if(At.Qa.Bb?Et.$b=st(Xe,At.Pa.jb[0])?2+st(Xe,At.Pa.jb[2]):st(Xe,At.Pa.jb[1]):Et.$b=0,At.kc&&(Et.Ad=st(Xe,At.Bd)),Et.Za=!st(Xe,145)+0,Et.Za){var $t=Et.Ob,nr=0;for(At=0;4>At;++At){var rr,Sr=Ot[0+At];for(rr=0;4>rr;++rr){Sr=hi[ht[_t+rr]][Sr];for(var Fr=md[st(Xe,Sr[0])];0<Fr;)Fr=md[2*Fr+st(Xe,Sr[Fr])];Sr=-Fr,ht[_t+rr]=Sr}n($t,nr,ht,_t,4),nr+=4,Ot[0+At]=Sr}}else Sr=st(Xe,156)?st(Xe,128)?1:3:st(Xe,163)?2:0,Et.Ob[0]=Sr,i(ht,_t,Sr,4),i(Ot,0,Sr,4);Et.Dd=st(Xe,142)?st(Xe,114)?st(Xe,183)?1:3:2:0}if(Ve.m.Ka)return Dr(me,7,"Premature end-of-partition0 encountered.");for(;me.ja<me.za;++me.ja){if(Ve=ve,Xe=(we=me).rb[we.sb-1],ht=we.rb[we.sb+we.ja],Ie=we.ya[we.aa+we.ja],_t=we.kc?Ie.Ad:0)Xe.la=ht.la=0,Ie.Za||(Xe.Na=ht.Na=0),Ie.Hc=0,Ie.Gc=0,Ie.ia=0;else{var en,xr;if(Xe=ht,ht=Ve,_t=we.Pa.Xc,Ot=we.ya[we.aa+we.ja],Et=we.pb[Ot.$b],At=Ot.ad,$t=0,nr=we.rb[we.sb-1],Sr=rr=0,i(At,$t,0,384),Ot.Za)var Jr=0,Cn=_t[3];else{Fr=s(16);var En=Xe.Na+nr.Na;if(En=$i(ht,_t[1],En,Et.Eb,0,Fr,0),Xe.Na=nr.Na=(0<En)+0,1<En)eo(Fr,0,At,$t);else{var di=Fr[0]+3>>3;for(Fr=0;256>Fr;Fr+=16)At[$t+Fr]=di}Jr=1,Cn=_t[0]}var dn=15&Xe.la,ls=15&nr.la;for(Fr=0;4>Fr;++Fr){var Fi=1&ls;for(di=xr=0;4>di;++di)dn=dn>>1|(Fi=(En=$i(ht,Cn,En=Fi+(1&dn),Et.Sc,Jr,At,$t))>Jr)<<7,xr=xr<<2|(3<En?3:1<En?2:At[$t+0]!=0),$t+=16;dn>>=4,ls=ls>>1|Fi<<7,rr=(rr<<8|xr)>>>0}for(Cn=dn,Jr=ls>>4,en=0;4>en;en+=2){for(xr=0,dn=Xe.la>>4+en,ls=nr.la>>4+en,Fr=0;2>Fr;++Fr){for(Fi=1&ls,di=0;2>di;++di)En=Fi+(1&dn),dn=dn>>1|(Fi=0<(En=$i(ht,_t[2],En,Et.Qc,0,At,$t)))<<3,xr=xr<<2|(3<En?3:1<En?2:At[$t+0]!=0),$t+=16;dn>>=2,ls=ls>>1|Fi<<5}Sr|=xr<<4*en,Cn|=dn<<4<<en,Jr|=(240&ls)<<en}Xe.la=Cn,nr.la=Jr,Ot.Hc=rr,Ot.Gc=Sr,Ot.ia=43690&Sr?0:Et.ia,_t=!(rr|Sr)}if(0<we.L&&(we.wa[we.Y+we.ja]=we.gd[Ie.$b][Ie.Za],we.wa[we.Y+we.ja].La|=!_t),Ve.Ka)return Dr(me,7,"Premature end-of-file encountered.")}if(vo(me),we=Ue,Ve=1,Ie=(ve=me).D,Xe=0<ve.L&&ve.M>=ve.zb&&ve.M<=ve.Va,ve.Aa==0)e:{if(Ie.M=ve.M,Ie.uc=Xe,xc(ve,Ie),Ve=1,Ie=(xr=ve.D).Nb,Xe=(Sr=_[ve.L])*ve.R,ht=Sr/2*ve.B,Fr=16*Ie*ve.R,di=8*Ie*ve.B,_t=ve.sa,Ot=ve.ta-Xe+Fr,Et=ve.qa,At=ve.ra-ht+di,$t=ve.Ha,nr=ve.Ia-ht+di,ls=(dn=xr.M)==0,rr=dn>=ve.Va-1,ve.Aa==2&&xc(ve,xr),xr.uc)for(Fi=(En=ve).D.M,e(En.D.uc),xr=En.yb;xr<En.Hb;++xr){Jr=xr,Cn=Fi;var Gn=(fn=(oi=En).D).Nb;en=oi.R;var fn=fn.wa[fn.Y+Jr],on=oi.sa,pn=oi.ta+16*Gn*en+16*Jr,Si=fn.dd,un=fn.tc;if(un!=0)if(e(3<=un),oi.L==1)0<Jr&&Fn(on,pn,en,un+4),fn.La&&qa(on,pn,en,un),0<Cn&&Ln(on,pn,en,un+4),fn.La&&ei(on,pn,en,un);else{var Sn=oi.B,Xi=oi.qa,ti=oi.ra+8*Gn*Sn+8*Jr,Rn=oi.Ha,oi=oi.Ia+8*Gn*Sn+8*Jr;Gn=fn.ld,0<Jr&&(wa(on,pn,en,un+4,Si,Gn),Ci(Xi,ti,Rn,oi,Sn,un+4,Si,Gn)),fn.La&&(Hs(on,pn,en,un,Si,Gn),vn(Xi,ti,Rn,oi,Sn,un,Si,Gn)),0<Cn&&(Tc(on,pn,en,un+4,Si,Gn),Xo(Xi,ti,Rn,oi,Sn,un+4,Si,Gn)),fn.La&&(Qs(on,pn,en,un,Si,Gn),ki(Xi,ti,Rn,oi,Sn,un,Si,Gn))}}if(ve.ia&&alert("todo:DitherRow"),we.put!=null){if(xr=16*dn,dn=16*(dn+1),ls?(we.y=ve.sa,we.O=ve.ta+Fr,we.f=ve.qa,we.N=ve.ra+di,we.ea=ve.Ha,we.W=ve.Ia+di):(xr-=Sr,we.y=_t,we.O=Ot,we.f=Et,we.N=At,we.ea=$t,we.W=nr),rr||(dn-=Sr),dn>we.o&&(dn=we.o),we.F=null,we.J=null,ve.Fa!=null&&0<ve.Fa.length&&xr<dn&&(we.J=Wo(ve,we,xr,dn-xr),we.F=ve.mb,we.F==null&&we.F.length==0)){Ve=Dr(ve,3,"Could not decode alpha data.");break e}xr<we.j&&(Sr=we.j-xr,xr=we.j,e(!(1&Sr)),we.O+=ve.R*Sr,we.N+=ve.B*(Sr>>1),we.W+=ve.B*(Sr>>1),we.F!=null&&(we.J+=we.width*Sr)),xr<dn&&(we.O+=we.v,we.N+=we.v>>1,we.W+=we.v>>1,we.F!=null&&(we.J+=we.v),we.ka=xr-we.j,we.U=we.va-we.v,we.T=dn-xr,Ve=we.put(we))}Ie+1!=ve.Ic||rr||(n(ve.sa,ve.ta-Xe,_t,Ot+16*ve.R,Xe),n(ve.qa,ve.ra-ht,Et,At+8*ve.B,ht),n(ve.Ha,ve.Ia-ht,$t,nr+8*ve.B,ht))}if(!Ve)return Dr(me,6,"Output aborted.")}return 1}(g,w)),w.bc!=null&&w.bc(w),T&=1}return T?(g.cb=0,T):0}function Ui(g,w,T,L,D){D=g[w+T+32*L]+(D>>3),g[w+T+32*L]=-256&D?0>D?0:255:D}function Yn(g,w,T,L,D,H){Ui(g,w,0,T,L+D),Ui(g,w,1,T,L+H),Ui(g,w,2,T,L-H),Ui(g,w,3,T,L-D)}function Li(g){return(20091*g>>16)+g}function cn(g,w,T,L){var D,H=0,z=s(16);for(D=0;4>D;++D){var j=g[w+0]+g[w+8],V=g[w+0]-g[w+8],X=(35468*g[w+4]>>16)-Li(g[w+12]),ue=Li(g[w+4])+(35468*g[w+12]>>16);z[H+0]=j+ue,z[H+1]=V+X,z[H+2]=V-X,z[H+3]=j-ue,H+=4,w++}for(D=H=0;4>D;++D)j=(g=z[H+0]+4)+z[H+8],V=g-z[H+8],X=(35468*z[H+4]>>16)-Li(z[H+12]),Ui(T,L,0,0,j+(ue=Li(z[H+4])+(35468*z[H+12]>>16))),Ui(T,L,1,0,V+X),Ui(T,L,2,0,V-X),Ui(T,L,3,0,j-ue),H++,L+=32}function Go(g,w,T,L){var D=g[w+0]+4,H=35468*g[w+4]>>16,z=Li(g[w+4]),j=35468*g[w+1]>>16;Yn(T,L,0,D+z,g=Li(g[w+1]),j),Yn(T,L,1,D+H,g,j),Yn(T,L,2,D-H,g,j),Yn(T,L,3,D-z,g,j)}function Vo(g,w,T,L,D){cn(g,w,T,L),D&&cn(g,w+16,T,L+4)}function Ys(g,w,T,L){va(g,w+0,T,L,1),va(g,w+32,T,L+128,1)}function fc(g,w,T,L){var D;for(g=g[w+0]+4,D=0;4>D;++D)for(w=0;4>w;++w)Ui(T,L,w,D,g)}function he(g,w,T,L){g[w+0]&&xo(g,w+0,T,L),g[w+16]&&xo(g,w+16,T,L+4),g[w+32]&&xo(g,w+32,T,L+128),g[w+48]&&xo(g,w+48,T,L+128+4)}function Be(g,w,T,L){var D,H=s(16);for(D=0;4>D;++D){var z=g[w+0+D]+g[w+12+D],j=g[w+4+D]+g[w+8+D],V=g[w+4+D]-g[w+8+D],X=g[w+0+D]-g[w+12+D];H[0+D]=z+j,H[8+D]=z-j,H[4+D]=X+V,H[12+D]=X-V}for(D=0;4>D;++D)z=(g=H[0+4*D]+3)+H[3+4*D],j=H[1+4*D]+H[2+4*D],V=H[1+4*D]-H[2+4*D],X=g-H[3+4*D],T[L+0]=z+j>>3,T[L+16]=X+V>>3,T[L+32]=z-j>>3,T[L+48]=X-V>>3,L+=64}function He(g,w,T){var L,D=w-32,H=Wi,z=255-g[D-1];for(L=0;L<T;++L){var j,V=H,X=z+g[w-1];for(j=0;j<T;++j)g[w+j]=V[X+g[D+j]];w+=32}}function dt(g,w){He(g,w,4)}function Mt(g,w){He(g,w,8)}function sr(g,w){He(g,w,16)}function zr(g,w){var T;for(T=0;16>T;++T)n(g,w+32*T,g,w-32,16)}function Wn(g,w){var T;for(T=16;0<T;--T)i(g,w,g[w-1],16),w+=32}function Zn(g,w,T){var L;for(L=0;16>L;++L)i(w,T+32*L,g,16)}function ui(g,w){var T,L=16;for(T=0;16>T;++T)L+=g[w-1+32*T]+g[w+T-32];Zn(L>>5,g,w)}function Nn(g,w){var T,L=8;for(T=0;16>T;++T)L+=g[w-1+32*T];Zn(L>>4,g,w)}function eh(g,w){var T,L=8;for(T=0;16>T;++T)L+=g[w+T-32];Zn(L>>4,g,w)}function al(g,w){Zn(128,g,w)}function Vr(g,w,T){return g+2*w+T+2>>2}function Qa(g,w){var T,L=w-32;for(L=new Uint8Array([Vr(g[L-1],g[L+0],g[L+1]),Vr(g[L+0],g[L+1],g[L+2]),Vr(g[L+1],g[L+2],g[L+3]),Vr(g[L+2],g[L+3],g[L+4])]),T=0;4>T;++T)n(g,w+32*T,L,0,L.length)}function tu(g,w){var T=g[w-1],L=g[w-1+32],D=g[w-1+64],H=g[w-1+96];Ct(g,w+0,16843009*Vr(g[w-1-32],T,L)),Ct(g,w+32,16843009*Vr(T,L,D)),Ct(g,w+64,16843009*Vr(L,D,H)),Ct(g,w+96,16843009*Vr(D,H,H))}function _i(g,w){var T,L=4;for(T=0;4>T;++T)L+=g[w+T-32]+g[w-1+32*T];for(L>>=3,T=0;4>T;++T)i(g,w+32*T,L,4)}function pc(g,w){var T=g[w-1+0],L=g[w-1+32],D=g[w-1+64],H=g[w-1-32],z=g[w+0-32],j=g[w+1-32],V=g[w+2-32],X=g[w+3-32];g[w+0+96]=Vr(L,D,g[w-1+96]),g[w+1+96]=g[w+0+64]=Vr(T,L,D),g[w+2+96]=g[w+1+64]=g[w+0+32]=Vr(H,T,L),g[w+3+96]=g[w+2+64]=g[w+1+32]=g[w+0+0]=Vr(z,H,T),g[w+3+64]=g[w+2+32]=g[w+1+0]=Vr(j,z,H),g[w+3+32]=g[w+2+0]=Vr(V,j,z),g[w+3+0]=Vr(X,V,j)}function cl(g,w){var T=g[w+1-32],L=g[w+2-32],D=g[w+3-32],H=g[w+4-32],z=g[w+5-32],j=g[w+6-32],V=g[w+7-32];g[w+0+0]=Vr(g[w+0-32],T,L),g[w+1+0]=g[w+0+32]=Vr(T,L,D),g[w+2+0]=g[w+1+32]=g[w+0+64]=Vr(L,D,H),g[w+3+0]=g[w+2+32]=g[w+1+64]=g[w+0+96]=Vr(D,H,z),g[w+3+32]=g[w+2+64]=g[w+1+96]=Vr(H,z,j),g[w+3+64]=g[w+2+96]=Vr(z,j,V),g[w+3+96]=Vr(j,V,V)}function pa(g,w){var T=g[w-1+0],L=g[w-1+32],D=g[w-1+64],H=g[w-1-32],z=g[w+0-32],j=g[w+1-32],V=g[w+2-32],X=g[w+3-32];g[w+0+0]=g[w+1+64]=H+z+1>>1,g[w+1+0]=g[w+2+64]=z+j+1>>1,g[w+2+0]=g[w+3+64]=j+V+1>>1,g[w+3+0]=V+X+1>>1,g[w+0+96]=Vr(D,L,T),g[w+0+64]=Vr(L,T,H),g[w+0+32]=g[w+1+96]=Vr(T,H,z),g[w+1+32]=g[w+2+96]=Vr(H,z,j),g[w+2+32]=g[w+3+96]=Vr(z,j,V),g[w+3+32]=Vr(j,V,X)}function Ha(g,w){var T=g[w+0-32],L=g[w+1-32],D=g[w+2-32],H=g[w+3-32],z=g[w+4-32],j=g[w+5-32],V=g[w+6-32],X=g[w+7-32];g[w+0+0]=T+L+1>>1,g[w+1+0]=g[w+0+64]=L+D+1>>1,g[w+2+0]=g[w+1+64]=D+H+1>>1,g[w+3+0]=g[w+2+64]=H+z+1>>1,g[w+0+32]=Vr(T,L,D),g[w+1+32]=g[w+0+96]=Vr(L,D,H),g[w+2+32]=g[w+1+96]=Vr(D,H,z),g[w+3+32]=g[w+2+96]=Vr(H,z,j),g[w+3+64]=Vr(z,j,V),g[w+3+96]=Vr(j,V,X)}function ll(g,w){var T=g[w-1+0],L=g[w-1+32],D=g[w-1+64],H=g[w-1+96];g[w+0+0]=T+L+1>>1,g[w+2+0]=g[w+0+32]=L+D+1>>1,g[w+2+32]=g[w+0+64]=D+H+1>>1,g[w+1+0]=Vr(T,L,D),g[w+3+0]=g[w+1+32]=Vr(L,D,H),g[w+3+32]=g[w+1+64]=Vr(D,H,H),g[w+3+64]=g[w+2+64]=g[w+0+96]=g[w+1+96]=g[w+2+96]=g[w+3+96]=H}function ul(g,w){var T=g[w-1+0],L=g[w-1+32],D=g[w-1+64],H=g[w-1+96],z=g[w-1-32],j=g[w+0-32],V=g[w+1-32],X=g[w+2-32];g[w+0+0]=g[w+2+32]=T+z+1>>1,g[w+0+32]=g[w+2+64]=L+T+1>>1,g[w+0+64]=g[w+2+96]=D+L+1>>1,g[w+0+96]=H+D+1>>1,g[w+3+0]=Vr(j,V,X),g[w+2+0]=Vr(z,j,V),g[w+1+0]=g[w+3+32]=Vr(T,z,j),g[w+1+32]=g[w+3+64]=Vr(L,T,z),g[w+1+64]=g[w+3+96]=Vr(D,L,T),g[w+1+96]=Vr(H,D,L)}function Ad(g,w){var T;for(T=0;8>T;++T)n(g,w+32*T,g,w-32,8)}function $u(g,w){var T;for(T=0;8>T;++T)i(g,w,g[w-1],8),w+=32}function gc(g,w,T){var L;for(L=0;8>L;++L)i(w,T+32*L,g,8)}function mc(g,w){var T,L=8;for(T=0;8>T;++T)L+=g[w+T-32]+g[w-1+32*T];gc(L>>4,g,w)}function za(g,w){var T,L=4;for(T=0;8>T;++T)L+=g[w+T-32];gc(L>>3,g,w)}function ga(g,w){var T,L=4;for(T=0;8>T;++T)L+=g[w-1+32*T];gc(L>>3,g,w)}function Ri(g,w){gc(128,g,w)}function Bi(g,w,T){var L=g[w-T],D=g[w+0],H=3*(D-L)+rh[1020+g[w-2*T]-g[w+T]],z=qt[112+(H+4>>3)];g[w-T]=Wi[255+L+qt[112+(H+3>>3)]],g[w+0]=Wi[255+D-z]}function ln(g,w,T,L){var D=g[w+0],H=g[w+T];return to[255+g[w-2*T]-g[w-T]]>L||to[255+H-D]>L}function Al(g,w,T,L){return 4*to[255+g[w-T]-g[w+0]]+to[255+g[w-2*T]-g[w+T]]<=L}function hl(g,w,T,L,D){var H=g[w-3*T],z=g[w-2*T],j=g[w-T],V=g[w+0],X=g[w+T],ue=g[w+2*T],ne=g[w+3*T];return 4*to[255+j-V]+to[255+z-X]>L?0:to[255+g[w-4*T]-H]<=D&&to[255+H-z]<=D&&to[255+z-j]<=D&&to[255+ne-ue]<=D&&to[255+ue-X]<=D&&to[255+X-V]<=D}function ru(g,w,T,L){var D=2*L+1;for(L=0;16>L;++L)Al(g,w+L,T,D)&&Bi(g,w+L,T)}function jo(g,w,T,L){var D=2*L+1;for(L=0;16>L;++L)Al(g,w+L*T,1,D)&&Bi(g,w+L*T,1)}function qo(g,w,T,L){var D;for(D=3;0<D;--D)ru(g,w+=4*T,T,L)}function Xu(g,w,T,L){var D;for(D=3;0<D;--D)jo(g,w+=4,T,L)}function ma(g,w,T,L,D,H,z,j){for(H=2*H+1;0<D--;){if(hl(g,w,T,H,z))if(ln(g,w,T,j))Bi(g,w,T);else{var V=g,X=w,ue=T,ne=V[X-2*ue],de=V[X-ue],me=V[X+0],Ue=V[X+ue],Ie=V[X+2*ue],ve=27*(Ve=rh[1020+3*(me-de)+rh[1020+ne-Ue]])+63>>7,we=18*Ve+63>>7,Ve=9*Ve+63>>7;V[X-3*ue]=Wi[255+V[X-3*ue]+Ve],V[X-2*ue]=Wi[255+ne+we],V[X-ue]=Wi[255+de+ve],V[X+0]=Wi[255+me-ve],V[X+ue]=Wi[255+Ue-we],V[X+2*ue]=Wi[255+Ie-Ve]}w+=L}}function Ds(g,w,T,L,D,H,z,j){for(H=2*H+1;0<D--;){if(hl(g,w,T,H,z))if(ln(g,w,T,j))Bi(g,w,T);else{var V=g,X=w,ue=T,ne=V[X-ue],de=V[X+0],me=V[X+ue],Ue=qt[112+((Ie=3*(de-ne))+4>>3)],Ie=qt[112+(Ie+3>>3)],ve=Ue+1>>1;V[X-2*ue]=Wi[255+V[X-2*ue]+ve],V[X-ue]=Wi[255+ne+Ie],V[X+0]=Wi[255+de-Ue],V[X+ue]=Wi[255+me-ve]}w+=L}}function nu(g,w,T,L,D,H){ma(g,w,T,1,16,L,D,H)}function yc(g,w,T,L,D,H){ma(g,w,1,T,16,L,D,H)}function _c(g,w,T,L,D,H){var z;for(z=3;0<z;--z)Ds(g,w+=4*T,T,1,16,L,D,H)}function iu(g,w,T,L,D,H){var z;for(z=3;0<z;--z)Ds(g,w+=4,1,T,16,L,D,H)}function hd(g,w,T,L,D,H,z,j){ma(g,w,D,1,8,H,z,j),ma(T,L,D,1,8,H,z,j)}function Ju(g,w,T,L,D,H,z,j){ma(g,w,1,D,8,H,z,j),ma(T,L,1,D,8,H,z,j)}function Yu(g,w,T,L,D,H,z,j){Ds(g,w+4*D,D,1,8,H,z,j),Ds(T,L+4*D,D,1,8,H,z,j)}function th(g,w,T,L,D,H,z,j){Ds(g,w+4,1,D,8,H,z,j),Ds(T,L+4,1,D,8,H,z,j)}function su(){this.ba=new Wr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ee,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function dl(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function vc(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ou(){this.ua=0,this.Wa=new Re,this.vb=new Re,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new _e,this.yc=new le}function Zu(){this.xb=this.a=0,this.l=new Os,this.ca=new Wr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new se,this.Pb=0,this.wd=new se,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ou,this.ab=0,this.gc=a(4,vc),this.Oc=0}function Ko(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Os,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function bc(g,w,T,L,D,H,z){for(g=g==null?0:g[w+0],w=0;w<z;++w)D[H+w]=g+T[L+w]&255,g=D[H+w]}function au(g,w,T,L,D,H,z){var j;if(g==null)bc(null,null,T,L,D,H,z);else for(j=0;j<z;++j)D[H+j]=g[w+j]+T[L+j]&255}function ya(g,w,T,L,D,H,z){if(g==null)bc(null,null,T,L,D,H,z);else{var j,V=g[w+0],X=V,ue=V;for(j=0;j<z;++j)X=ue+(V=g[w+j])-X,ue=T[L+j]+(-256&X?0>X?0:255:X)&255,X=V,D[H+j]=ue}}function Wo(g,w,T,L){var D=w.width,H=w.o;if(e(g!=null&&w!=null),0>T||0>=L||T+L>H)return null;if(!g.Cc){if(g.ga==null){var z;if(g.ga=new Ko,(z=g.ga==null)||(z=w.width*w.o,e(g.Gb.length==0),g.Gb=s(z),g.Uc=0,g.Gb==null?z=0:(g.mb=g.Gb,g.nb=g.Uc,g.rc=null,z=1),z=!z),!z){z=g.ga;var j=g.Fa,V=g.P,X=g.qc,ue=g.mb,ne=g.nb,de=V+1,me=X-1,Ue=z.l;if(e(j!=null&&ue!=null&&w!=null),Co[0]=null,Co[1]=bc,Co[2]=au,Co[3]=ya,z.ca=ue,z.tb=ne,z.c=w.width,z.i=w.height,e(0<z.c&&0<z.i),1>=X)w=0;else if(z.$a=j[V+0]>>0&3,z.Z=j[V+0]>>2&3,z.Lc=j[V+0]>>4&3,V=j[V+0]>>6&3,0>z.$a||1<z.$a||4<=z.Z||1<z.Lc||V)w=0;else if(Ue.put=Ge,Ue.ac=Qe,Ue.bc=Ke,Ue.ma=z,Ue.width=w.width,Ue.height=w.height,Ue.Da=w.Da,Ue.v=w.v,Ue.va=w.va,Ue.j=w.j,Ue.o=w.o,z.$a)e:{e(z.$a==1),w=mr();t:for(;;){if(w==null){w=0;break e}if(e(z!=null),z.mc=w,w.c=z.c,w.i=z.i,w.l=z.l,w.l.ma=z,w.l.width=z.c,w.l.height=z.i,w.a=0,Je(w.m,j,de,me),!$r(z.c,z.i,1,w,null)||(w.ab==1&&w.gc[0].hc==3&&lr(w.s)?(z.ic=1,j=w.c*w.i,w.Ta=null,w.Ua=0,w.V=s(j),w.Ba=0,w.V==null?(w.a=1,w=0):w=1):(z.ic=0,w=bn(w,z.c)),!w))break t;w=1;break e}z.mc=null,w=0}else w=me>=z.c*z.i;z=!w}if(z)return null;g.ga.Lc!=1?g.Ga=0:L=H-T}e(g.ga!=null),e(T+L<=H);e:{if(w=(j=g.ga).c,H=j.l.o,j.$a==0){if(de=g.rc,me=g.Vc,Ue=g.Fa,V=g.P+1+T*w,X=g.mb,ue=g.nb+T*w,e(V<=g.P+g.qc),j.Z!=0)for(e(Co[j.Z]!=null),z=0;z<L;++z)Co[j.Z](de,me,Ue,V,X,ue,w),de=X,me=ue,ue+=w,V+=w;else for(z=0;z<L;++z)n(X,ue,Ue,V,w),de=X,me=ue,ue+=w,V+=w;g.rc=de,g.Vc=me}else{if(e(j.mc!=null),w=T+L,e((z=j.mc)!=null),e(w<=z.i),z.C>=w)w=1;else if(j.ic||at(),j.ic){j=z.V,de=z.Ba,me=z.c;var Ie=z.i,ve=(Ue=1,V=z.$/me,X=z.$%me,ue=z.m,ne=z.s,z.$),we=me*Ie,Ve=me*w,Xe=ne.wc,At=ve<Ve?Vt(ne,X,V):null;e(ve<=we),e(w<=Ie),e(lr(ne));t:for(;;){for(;!ue.h&&ve<Ve;){if(X&Xe||(At=Vt(ne,X,V)),e(At!=null),$e(ue),256>(Ie=gt(At.G[0],At.H[0],ue)))j[de+ve]=Ie,++ve,++X>=me&&(X=0,++V<=w&&!(V%16)&&Nr(z,V));else{if(!(280>Ie)){Ue=0;break t}Ie=Ze(Ie-256,ue);var ht,_t=gt(At.G[4],At.H[4],ue);if($e(ue),!(ve>=(_t=yt(me,_t=Ze(_t,ue)))&&we-ve>=Ie)){Ue=0;break t}for(ht=0;ht<Ie;++ht)j[de+ve+ht]=j[de+ve+ht-_t];for(ve+=Ie,X+=Ie;X>=me;)X-=me,++V<=w&&!(V%16)&&Nr(z,V);ve<Ve&&X&Xe&&(At=Vt(ne,X,V))}e(ue.h==Me(ue))}Nr(z,V>w?w:V);break t}!Ue||ue.h&&ve<we?(Ue=0,z.a=ue.h?5:3):z.$=ve,w=Ue}else w=Hr(z,z.V,z.Ba,z.c,z.i,w,kn);if(!w){L=0;break e}}T+L>=H&&(g.Cc=1),L=1}if(!L)return null;if(g.Cc&&((L=g.ga)!=null&&(L.mc=null),g.ga=null,0<g.Ga))return alert("todo:WebPDequantizeLevels"),null}return g.nb+T*D}function k(g,w,T,L,D,H){for(;0<D--;){var z,j=g,V=w+(T?1:0),X=g,ue=w+(T?0:3);for(z=0;z<L;++z){var ne=X[ue+4*z];ne!=255&&(ne*=32897,j[V+4*z+0]=j[V+4*z+0]*ne>>23,j[V+4*z+1]=j[V+4*z+1]*ne>>23,j[V+4*z+2]=j[V+4*z+2]*ne>>23)}w+=H}}function re(g,w,T,L,D){for(;0<L--;){var H;for(H=0;H<T;++H){var z=g[w+2*H+0],j=15&(X=g[w+2*H+1]),V=4369*j,X=(240&X|X>>4)*V>>16;g[w+2*H+0]=(240&z|z>>4)*V>>16&240|(15&z|z<<4)*V>>16>>4&15,g[w+2*H+1]=240&X|j}w+=D}}function Pe(g,w,T,L,D,H,z,j){var V,X,ue=255;for(X=0;X<D;++X){for(V=0;V<L;++V){var ne=g[w+V];H[z+4*V]=ne,ue&=ne}w+=T,z+=j}return ue!=255}function je(g,w,T,L,D){var H;for(H=0;H<D;++H)T[L+H]=g[w+H]>>8}function at(){xa=k,Au=re,Ka=Pe,hu=je}function lt(g,w,T){fe[g]=function(L,D,H,z,j,V,X,ue,ne,de,me,Ue,Ie,ve,we,Ve,Xe){var At,ht=Xe-1>>1,_t=j[V+0]|X[ue+0]<<16,Ot=ne[de+0]|me[Ue+0]<<16;e(L!=null);var Et=3*_t+Ot+131074>>2;for(w(L[D+0],255&Et,Et>>16,Ie,ve),H!=null&&(Et=3*Ot+_t+131074>>2,w(H[z+0],255&Et,Et>>16,we,Ve)),At=1;At<=ht;++At){var $t=j[V+At]|X[ue+At]<<16,nr=ne[de+At]|me[Ue+At]<<16,rr=_t+$t+Ot+nr+524296,Sr=rr+2*($t+Ot)>>3;Et=Sr+_t>>1,_t=(rr=rr+2*(_t+nr)>>3)+$t>>1,w(L[D+2*At-1],255&Et,Et>>16,Ie,ve+(2*At-1)*T),w(L[D+2*At-0],255&_t,_t>>16,Ie,ve+(2*At-0)*T),H!=null&&(Et=rr+Ot>>1,_t=Sr+nr>>1,w(H[z+2*At-1],255&Et,Et>>16,we,Ve+(2*At-1)*T),w(H[z+2*At+0],255&_t,_t>>16,we,Ve+(2*At+0)*T)),_t=$t,Ot=nr}1&Xe||(Et=3*_t+Ot+131074>>2,w(L[D+Xe-1],255&Et,Et>>16,Ie,ve+(Xe-1)*T),H!=null&&(Et=3*Ot+_t+131074>>2,w(H[z+Xe-1],255&Et,Et>>16,we,Ve+(Xe-1)*T)))}}function Pt(){Es[rA]=_d,Es[vl]=Ba,Es[nh]=vd,Es[bl]=cA,Es[nA]=du,Es[fd]=lA,Es[Wa]=uA,Es[zn]=Ba,Es[wl]=cA,Es[xl]=du,Es[iA]=lA}function cr(g){return g&~El?0>g?0:255:g>>AA}function Pr(g,w){return cr((19077*g>>8)+(26149*w>>8)-14234)}function Gr(g,w,T){return cr((19077*g>>8)-(6419*w>>8)-(13320*T>>8)+8708)}function vr(g,w){return cr((19077*g>>8)+(33050*w>>8)-17685)}function wn(g,w,T,L,D){L[D+0]=Pr(g,T),L[D+1]=Gr(g,w,T),L[D+2]=vr(g,w)}function br(g,w,T,L,D){L[D+0]=vr(g,w),L[D+1]=Gr(g,w,T),L[D+2]=Pr(g,T)}function Ai(g,w,T,L,D){var H=Gr(g,w,T);w=H<<3&224|vr(g,w)>>3,L[D+0]=248&Pr(g,T)|H>>5,L[D+1]=w}function Kr(g,w,T,L,D){var H=240&vr(g,w)|15;L[D+0]=240&Pr(g,T)|Gr(g,w,T)>>4,L[D+1]=H}function Xr(g,w,T,L,D){L[D+0]=255,wn(g,w,T,L,D+1)}function si(g,w,T,L,D){br(g,w,T,L,D),L[D+3]=255}function ks(g,w,T,L,D){wn(g,w,T,L,D),L[D+3]=255}function Ns(g,w){return 0>g?0:g>w?w:g}function _a(g,w,T){fe[g]=function(L,D,H,z,j,V,X,ue,ne){for(var de=ue+(-2&ne)*T;ue!=de;)w(L[D+0],H[z+0],j[V+0],X,ue),w(L[D+1],H[z+0],j[V+0],X,ue+T),D+=2,++z,++V,ue+=2*T;1&ne&&w(L[D+0],H[z+0],j[V+0],X,ue)}}function fl(g,w,T){return T==0?g==0?w==0?6:5:w==0?4:0:T}function wc(g,w,T,L,D){switch(g>>>30){case 3:va(w,T,L,D,0);break;case 2:$o(w,T,L,D);break;case 1:xo(w,T,L,D)}}function xc(g,w){var T,L,D=w.M,H=w.Nb,z=g.oc,j=g.pc+40,V=g.oc,X=g.pc+584,ue=g.oc,ne=g.pc+600;for(T=0;16>T;++T)z[j+32*T-1]=129;for(T=0;8>T;++T)V[X+32*T-1]=129,ue[ne+32*T-1]=129;for(0<D?z[j-1-32]=V[X-1-32]=ue[ne-1-32]=129:(i(z,j-32-1,127,21),i(V,X-32-1,127,9),i(ue,ne-32-1,127,9)),L=0;L<g.za;++L){var de=w.ya[w.aa+L];if(0<L){for(T=-1;16>T;++T)n(z,j+32*T-4,z,j+32*T+12,4);for(T=-1;8>T;++T)n(V,X+32*T-4,V,X+32*T+4,4),n(ue,ne+32*T-4,ue,ne+32*T+4,4)}var me=g.Gd,Ue=g.Hd+L,Ie=de.ad,ve=de.Hc;if(0<D&&(n(z,j-32,me[Ue].y,0,16),n(V,X-32,me[Ue].f,0,8),n(ue,ne-32,me[Ue].ea,0,8)),de.Za){var we=z,Ve=j-32+16;for(0<D&&(L>=g.za-1?i(we,Ve,me[Ue].y[15],4):n(we,Ve,me[Ue+1].y,0,4)),T=0;4>T;T++)we[Ve+128+T]=we[Ve+256+T]=we[Ve+384+T]=we[Ve+0+T];for(T=0;16>T;++T,ve<<=2)we=z,Ve=j+y[T],Ni[de.Ob[T]](we,Ve),wc(ve,Ie,16*+T,we,Ve)}else if(we=fl(L,D,de.Ob[0]),Bo[we](z,j),ve!=0)for(T=0;16>T;++T,ve<<=2)wc(ve,Ie,16*+T,z,j+y[T]);for(T=de.Gc,we=fl(L,D,de.Dd),ea[we](V,X),ea[we](ue,ne),ve=Ie,we=V,Ve=X,255&(de=T>>0)&&(170&de?ja(ve,256,we,Ve):ba(ve,256,we,Ve)),de=ue,ve=ne,255&(T>>=8)&&(170&T?ja(Ie,320,de,ve):ba(Ie,320,de,ve)),D<g.Ub-1&&(n(me[Ue].y,0,z,j+480,16),n(me[Ue].f,0,V,X+224,8),n(me[Ue].ea,0,ue,ne+224,8)),T=8*H*g.B,me=g.sa,Ue=g.ta+16*L+16*H*g.R,Ie=g.qa,de=g.ra+8*L+T,ve=g.Ha,we=g.Ia+8*L+T,T=0;16>T;++T)n(me,Ue+T*g.R,z,j+32*T,16);for(T=0;8>T;++T)n(Ie,de+T*g.B,V,X+32*T,8),n(ve,we+T*g.B,ue,ne+32*T,8)}}function pl(g,w,T,L,D,H,z,j,V){var X=[0],ue=[0],ne=0,de=V!=null?V.kd:0,me=V??new dl;if(g==null||12>T)return 7;me.data=g,me.w=w,me.ha=T,w=[w],T=[T],me.gb=[me.gb];e:{var Ue=w,Ie=T,ve=me.gb;if(e(g!=null),e(Ie!=null),e(ve!=null),ve[0]=0,12<=Ie[0]&&!t(g,Ue[0],"RIFF")){if(t(g,Ue[0]+8,"WEBP")){ve=3;break e}var we=Ht(g,Ue[0]+4);if(12>we||4294967286<we){ve=3;break e}if(de&&we>Ie[0]-8){ve=7;break e}ve[0]=we,Ue[0]+=12,Ie[0]-=12}ve=0}if(ve!=0)return ve;for(we=0<me.gb[0],T=T[0];;){e:{var Ve=g;Ie=w,ve=T;var Xe=X,At=ue,ht=Ue=[0];if((Et=ne=[ne])[0]=0,8>ve[0])ve=7;else{if(!t(Ve,Ie[0],"VP8X")){if(Ht(Ve,Ie[0]+4)!=10){ve=3;break e}if(18>ve[0]){ve=7;break e}var _t=Ht(Ve,Ie[0]+8),Ot=1+Qt(Ve,Ie[0]+12);if(2147483648<=Ot*(Ve=1+Qt(Ve,Ie[0]+15))){ve=3;break e}ht!=null&&(ht[0]=_t),Xe!=null&&(Xe[0]=Ot),At!=null&&(At[0]=Ve),Ie[0]+=18,ve[0]-=18,Et[0]=1}ve=0}}if(ne=ne[0],Ue=Ue[0],ve!=0)return ve;if(Ie=!!(2&Ue),!we&&ne)return 3;if(H!=null&&(H[0]=!!(16&Ue)),z!=null&&(z[0]=Ie),j!=null&&(j[0]=0),z=X[0],Ue=ue[0],ne&&Ie&&V==null){ve=0;break}if(4>T){ve=7;break}if(we&&ne||!we&&!ne&&!t(g,w[0],"ALPH")){T=[T],me.na=[me.na],me.P=[me.P],me.Sa=[me.Sa];e:{_t=g,ve=w,we=T;var Et=me.gb;Xe=me.na,At=me.P,ht=me.Sa,Ot=22,e(_t!=null),e(we!=null),Ve=ve[0];var $t=we[0];for(e(Xe!=null),e(ht!=null),Xe[0]=null,At[0]=null,ht[0]=0;;){if(ve[0]=Ve,we[0]=$t,8>$t){ve=7;break e}var nr=Ht(_t,Ve+4);if(4294967286<nr){ve=3;break e}var rr=8+nr+1&-2;if(Ot+=rr,0<Et&&Ot>Et){ve=3;break e}if(!t(_t,Ve,"VP8 ")||!t(_t,Ve,"VP8L")){ve=0;break e}if($t[0]<rr){ve=7;break e}t(_t,Ve,"ALPH")||(Xe[0]=_t,At[0]=Ve+8,ht[0]=nr),Ve+=rr,$t-=rr}}if(T=T[0],me.na=me.na[0],me.P=me.P[0],me.Sa=me.Sa[0],ve!=0)break}T=[T],me.Ja=[me.Ja],me.xa=[me.xa];e:if(Et=g,ve=w,we=T,Xe=me.gb[0],At=me.Ja,ht=me.xa,_t=ve[0],Ve=!t(Et,_t,"VP8 "),Ot=!t(Et,_t,"VP8L"),e(Et!=null),e(we!=null),e(At!=null),e(ht!=null),8>we[0])ve=7;else{if(Ve||Ot){if(Et=Ht(Et,_t+4),12<=Xe&&Et>Xe-12){ve=3;break e}if(de&&Et>we[0]-8){ve=7;break e}At[0]=Et,ve[0]+=8,we[0]-=8,ht[0]=Ot}else ht[0]=5<=we[0]&&Et[_t+0]==47&&!(Et[_t+4]>>5),At[0]=we[0];ve=0}if(T=T[0],me.Ja=me.Ja[0],me.xa=me.xa[0],w=w[0],ve!=0)break;if(4294967286<me.Ja)return 3;if(j==null||Ie||(j[0]=me.xa?2:1),z=[z],Ue=[Ue],me.xa){if(5>T){ve=7;break}j=z,de=Ue,Ie=H,g==null||5>T?g=0:5<=T&&g[w+0]==47&&!(g[w+4]>>5)?(we=[0],Et=[0],Xe=[0],Je(At=new se,g,w,T),Te(At,we,Et,Xe)?(j!=null&&(j[0]=we[0]),de!=null&&(de[0]=Et[0]),Ie!=null&&(Ie[0]=Xe[0]),g=1):g=0):g=0}else{if(10>T){ve=7;break}j=Ue,g==null||10>T||!Js(g,w+3,T-3)?g=0:(de=g[w+0]|g[w+1]<<8|g[w+2]<<16,Ie=16383&(g[w+7]<<8|g[w+6]),g=16383&(g[w+9]<<8|g[w+8]),1&de||3<(de>>1&7)||!(de>>4&1)||de>>5>=me.Ja||!Ie||!g?g=0:(z&&(z[0]=Ie),j&&(j[0]=g),g=1))}if(!g||(z=z[0],Ue=Ue[0],ne&&(X[0]!=z||ue[0]!=Ue)))return 3;V!=null&&(V[0]=me,V.offset=w-V.w,e(4294967286>w-V.w),e(V.offset==V.ha-T));break}return ve==0||ve==7&&ne&&V==null?(H!=null&&(H[0]|=me.na!=null&&0<me.na.length),L!=null&&(L[0]=z),D!=null&&(D[0]=Ue),0):ve}function Bc(g,w,T){var L=w.width,D=w.height,H=0,z=0,j=L,V=D;if(w.Da=g!=null&&0<g.Da,w.Da&&(j=g.cd,V=g.bd,H=g.v,z=g.j,11>T||(H&=-2,z&=-2),0>H||0>z||0>=j||0>=V||H+j>L||z+V>D))return 0;if(w.v=H,w.j=z,w.va=H+j,w.o=z+V,w.U=j,w.T=V,w.da=g!=null&&0<g.da,w.da){if(!Ye(j,V,T=[g.ib],H=[g.hb]))return 0;w.ib=T[0],w.hb=H[0]}return w.ob=g!=null&&g.ob,w.Kb=g==null||!g.Sd,w.da&&(w.ob=w.ib<3*L/4&&w.hb<3*D/4,w.Kb=0),1}function cu(g){if(g==null)return 2;if(11>g.S){var w=g.f.RGBA;w.fb+=(g.height-1)*w.A,w.A=-w.A}else w=g.f.kb,g=g.height,w.O+=(g-1)*w.fa,w.fa=-w.fa,w.N+=(g-1>>1)*w.Ab,w.Ab=-w.Ab,w.W+=(g-1>>1)*w.Db,w.Db=-w.Db,w.F!=null&&(w.J+=(g-1)*w.lb,w.lb=-w.lb);return 0}function Ga(g,w,T,L){if(L==null||0>=g||0>=w)return 2;if(T!=null){if(T.Da){var D=T.cd,H=T.bd,z=-2&T.v,j=-2&T.j;if(0>z||0>j||0>=D||0>=H||z+D>g||j+H>w)return 2;g=D,w=H}if(T.da){if(!Ye(g,w,D=[T.ib],H=[T.hb]))return 2;g=D[0],w=H[0]}}L.width=g,L.height=w;e:{var V=L.width,X=L.height;if(g=L.S,0>=V||0>=X||!(g>=rA&&13>g))g=2;else{if(0>=L.Rd&&L.sd==null){z=H=D=w=0;var ue=(j=V*R[g])*X;if(11>g||(H=(X+1)/2*(w=(V+1)/2),g==12&&(z=(D=V)*X)),(X=s(ue+2*H+z))==null){g=1;break e}L.sd=X,11>g?((V=L.f.RGBA).eb=X,V.fb=0,V.A=j,V.size=ue):((V=L.f.kb).y=X,V.O=0,V.fa=j,V.Fd=ue,V.f=X,V.N=0+ue,V.Ab=w,V.Cd=H,V.ea=X,V.W=0+ue+H,V.Db=w,V.Ed=H,g==12&&(V.F=X,V.J=0+ue+2*H),V.Tc=z,V.lb=D)}if(w=1,D=L.S,H=L.width,z=L.height,D>=rA&&13>D)if(11>D)g=L.f.RGBA,w&=(j=Math.abs(g.A))*(z-1)+H<=g.size,w&=j>=H*R[D],w&=g.eb!=null;else{g=L.f.kb,j=(H+1)/2,ue=(z+1)/2,V=Math.abs(g.fa),X=Math.abs(g.Ab);var ne=Math.abs(g.Db),de=Math.abs(g.lb),me=de*(z-1)+H;w&=V*(z-1)+H<=g.Fd,w&=X*(ue-1)+j<=g.Cd,w=(w&=ne*(ue-1)+j<=g.Ed)&V>=H&X>=j&ne>=j,w&=g.y!=null,w&=g.f!=null,w&=g.ea!=null,D==12&&(w&=de>=H,w&=me<=g.Tc,w&=g.F!=null)}else w=0;g=w?0:2}}return g!=0||T!=null&&T.fd&&(g=cu(L)),g}var cs=64,Cc=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],gl=24,ml=32,Ec=8,vs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];vt("Predictor0","PredictorAdd0"),fe.Predictor0=function(){return 4278190080},fe.Predictor1=function(g){return g},fe.Predictor2=function(g,w,T){return w[T+0]},fe.Predictor3=function(g,w,T){return w[T+1]},fe.Predictor4=function(g,w,T){return w[T-1]},fe.Predictor5=function(g,w,T){return kt(kt(g,w[T+1]),w[T+0])},fe.Predictor6=function(g,w,T){return kt(g,w[T-1])},fe.Predictor7=function(g,w,T){return kt(g,w[T+0])},fe.Predictor8=function(g,w,T){return kt(w[T-1],w[T+0])},fe.Predictor9=function(g,w,T){return kt(w[T+0],w[T+1])},fe.Predictor10=function(g,w,T){return kt(kt(g,w[T-1]),kt(w[T+0],w[T+1]))},fe.Predictor11=function(g,w,T){var L=w[T+0];return 0>=Lr(L>>24&255,g>>24&255,(w=w[T-1])>>24&255)+Lr(L>>16&255,g>>16&255,w>>16&255)+Lr(L>>8&255,g>>8&255,w>>8&255)+Lr(255&L,255&g,255&w)?L:g},fe.Predictor12=function(g,w,T){var L=w[T+0];return(ir((g>>24&255)+(L>>24&255)-((w=w[T-1])>>24&255))<<24|ir((g>>16&255)+(L>>16&255)-(w>>16&255))<<16|ir((g>>8&255)+(L>>8&255)-(w>>8&255))<<8|ir((255&g)+(255&L)-(255&w)))>>>0},fe.Predictor13=function(g,w,T){var L=w[T-1];return(Ar((g=kt(g,w[T+0]))>>24&255,L>>24&255)<<24|Ar(g>>16&255,L>>16&255)<<16|Ar(g>>8&255,L>>8&255)<<8|Ar(g>>0&255,L>>0&255))>>>0};var dd=fe.PredictorAdd0;fe.PredictorAdd1=Tr,vt("Predictor2","PredictorAdd2"),vt("Predictor3","PredictorAdd3"),vt("Predictor4","PredictorAdd4"),vt("Predictor5","PredictorAdd5"),vt("Predictor6","PredictorAdd6"),vt("Predictor7","PredictorAdd7"),vt("Predictor8","PredictorAdd8"),vt("Predictor9","PredictorAdd9"),vt("Predictor10","PredictorAdd10"),vt("Predictor11","PredictorAdd11"),vt("Predictor12","PredictorAdd12"),vt("Predictor13","PredictorAdd13");var lu=fe.PredictorAdd2;Ir("ColorIndexInverseTransform","MapARGB","32b",function(g){return g>>8&255},function(g){return g}),Ir("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(g){return g},function(g){return g>>8&255});var $n,qi=fe.ColorIndexInverseTransform,Oi=fe.MapARGB,eA=fe.VP8LColorIndexInverseTransformAlpha,uu=fe.MapAlpha,Va=fe.VP8LPredictorsAdd=[];Va.length=16,(fe.VP8LPredictors=[]).length=16,(fe.VP8LPredictorsAdd_C=[]).length=16,(fe.VP8LPredictors_C=[]).length=16;var Di,Ki,Zs,bo,wo,Sc,eo,va,$o,ja,xo,ba,Tc,wa,Xo,Ci,Qs,Hs,ki,vn,Ln,Fn,ei,qa,xa,Au,Ka,hu,Jo=s(511),er=s(2041),tA=s(225),yl=s(767),_l=0,rh=er,qt=tA,Wi=yl,to=Jo,rA=0,vl=1,nh=2,bl=3,nA=4,fd=5,Wa=6,zn=7,wl=8,xl=9,iA=10,sp=[2,3,7],op=[3,3,11],pd=[280,256,256,256,40],Yo=[0,1,1,1,0],sA=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],dr=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],wr=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],ih=8,Bl=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],oA=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],$i=null,gd=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Zo=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],md=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],aA=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],hi=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Ei=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ap=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Bo=[],Ni=[],ea=[],yd=1,sh=2,Co=[],Es=[];lt("UpsampleRgbLinePair",wn,3),lt("UpsampleBgrLinePair",br,3),lt("UpsampleRgbaLinePair",ks,4),lt("UpsampleBgraLinePair",si,4),lt("UpsampleArgbLinePair",Xr,4),lt("UpsampleRgba4444LinePair",Kr,2),lt("UpsampleRgb565LinePair",Ai,2);var _d=fe.UpsampleRgbLinePair,vd=fe.UpsampleBgrLinePair,Ba=fe.UpsampleRgbaLinePair,cA=fe.UpsampleBgraLinePair,du=fe.UpsampleArgbLinePair,lA=fe.UpsampleRgba4444LinePair,uA=fe.UpsampleRgb565LinePair,Cl=16,$a=1<<Cl-1,ta=-227,fu=482,AA=6,El=(256<<AA)-1,oh=0,bd=s(256),ah=s(256),cp=s(256),C=s(256),l=s(fu-ta),d=s(fu-ta);_a("YuvToRgbRow",wn,3),_a("YuvToBgrRow",br,3),_a("YuvToRgbaRow",ks,4),_a("YuvToBgraRow",si,4),_a("YuvToArgbRow",Xr,4),_a("YuvToRgba4444Row",Kr,2),_a("YuvToRgb565Row",Ai,2);var y=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],_=[0,2,8],E=[8,7,6,4,4,2,2,2,1,1,1,1],P=1;this.WebPDecodeRGBA=function(g,w,T,L,D){var H=vl,z=new su,j=new Wr;z.ba=j,j.S=H,j.width=[j.width],j.height=[j.height];var V=j.width,X=j.height,ue=new Ee;if(ue==null||g==null)var ne=2;else e(ue!=null),ne=pl(g,w,T,ue.width,ue.height,ue.Pd,ue.Qd,ue.format,null);if(ne!=0?V=0:(V!=null&&(V[0]=ue.width[0]),X!=null&&(X[0]=ue.height[0]),V=1),V){j.width=j.width[0],j.height=j.height[0],L!=null&&(L[0]=j.width),D!=null&&(D[0]=j.height);e:{if(L=new Os,(D=new dl).data=g,D.w=w,D.ha=T,D.kd=1,w=[0],e(D!=null),((g=pl(D.data,D.w,D.ha,null,null,null,w,null,D))==0||g==7)&&w[0]&&(g=4),(w=g)==0){if(e(z!=null),L.data=D.data,L.w=D.w+D.offset,L.ha=D.ha-D.offset,L.put=Ge,L.ac=Qe,L.bc=Ke,L.ma=z,D.xa){if((g=mr())==null){z=1;break e}if(function(de,me){var Ue=[0],Ie=[0],ve=[0];t:for(;;){if(de==null)return 0;if(me==null)return de.a=2,0;if(de.l=me,de.a=0,Je(de.m,me.data,me.w,me.ha),!Te(de.m,Ue,Ie,ve)){de.a=3;break t}if(de.xb=sh,me.width=Ue[0],me.height=Ie[0],!$r(Ue[0],Ie[0],1,de,null))break t;return 1}return e(de.a!=0),0}(g,L)){if(L=(w=Ga(L.width,L.height,z.Oa,z.ba))==0){t:{L=g;r:for(;;){if(L==null){L=0;break t}if(e(L.s.yc!=null),e(L.s.Ya!=null),e(0<L.s.Wb),e((T=L.l)!=null),e((D=T.ma)!=null),L.xb!=0){if(L.ca=D.ba,L.tb=D.tb,e(L.ca!=null),!Bc(D.Oa,T,bl)){L.a=2;break r}if(!bn(L,T.width)||T.da)break r;if((T.da||Or(L.ca.S))&&at(),11>L.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),L.ca.f.kb.F!=null&&at()),L.Pb&&0<L.s.ua&&L.s.vb.X==null&&!zt(L.s.vb,L.s.Wa.Xa)){L.a=1;break r}L.xb=0}if(!Hr(L,L.V,L.Ba,L.c,L.i,T.o,Er))break r;D.Dc=L.Ma,L=1;break t}e(L.a!=0),L=0}L=!L}L&&(w=g.a)}else w=g.a}else{if((g=new zo)==null){z=1;break e}if(g.Fa=D.na,g.P=D.P,g.qc=D.Sa,Cs(g,L)){if((w=Ga(L.width,L.height,z.Oa,z.ba))==0){if(g.Aa=0,T=z.Oa,e((D=g)!=null),T!=null){if(0<(V=0>(V=T.Md)?0:100<V?255:255*V/100)){for(X=ue=0;4>X;++X)12>(ne=D.pb[X]).lc&&(ne.ia=V*E[0>ne.lc?0:ne.lc]>>3),ue|=ne.ia;ue&&(alert("todo:VP8InitRandom"),D.ia=1)}D.Ga=T.Id,100<D.Ga?D.Ga=100:0>D.Ga&&(D.Ga=0)}Pi(g,L)||(w=g.a)}}else w=g.a}w==0&&z.Oa!=null&&z.Oa.fd&&(w=cu(z.ba))}z=w}H=z!=0?null:11>H?j.f.RGBA.eb:j.f.kb.y}else H=null;return H};var R=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(fe,Oe){for(var Fe="",oe=0;oe<4;oe++)Fe+=String.fromCharCode(fe[Oe++]);return Fe}function m(fe,Oe){return(fe[Oe+0]<<0|fe[Oe+1]<<8|fe[Oe+2]<<16)>>>0}function v(fe,Oe){return(fe[Oe+0]<<0|fe[Oe+1]<<8|fe[Oe+2]<<16|fe[Oe+3]<<24)>>>0}new A;var x=[0],B=[0],M=[],U=new A,N=r,Q=function(fe,Oe){var Fe={},oe=0,le=!1,xe=0,_e=0;if(Fe.frames=[],!function(be,Me,De,$e){for(var qe=0;qe<$e;qe++)if(be[Me+qe]!=De.charCodeAt(qe))return!0;return!1}(fe,Oe,"RIFF",4)){var tt,et;for(v(fe,Oe+=4),Oe+=8;Oe<fe.length;){var nt=f(fe,Oe),Je=v(fe,Oe+=4);Oe+=4;var it=Je+(1&Je);switch(nt){case"VP8 ":case"VP8L":Fe.frames[oe]===void 0&&(Fe.frames[oe]={}),(se=Fe.frames[oe]).src_off=le?_e:Oe-8,se.src_size=xe+Je+8,oe++,le&&(le=!1,xe=0,_e=0);break;case"VP8X":(se=Fe.header={}).feature_flags=fe[Oe];var ot=Oe+4;se.canvas_width=1+m(fe,ot),ot+=3,se.canvas_height=1+m(fe,ot),ot+=3;break;case"ALPH":le=!0,xe=it+8,_e=Oe-8;break;case"ANIM":(se=Fe.header).bgcolor=v(fe,Oe),ot=Oe+4,se.loop_count=(tt=fe)[(et=ot)+0]<<0|tt[et+1]<<8,ot+=2;break;case"ANMF":var xt,se;(se=Fe.frames[oe]={}).offset_x=2*m(fe,Oe),Oe+=3,se.offset_y=2*m(fe,Oe),Oe+=3,se.width=1+m(fe,Oe),Oe+=3,se.height=1+m(fe,Oe),Oe+=3,se.duration=m(fe,Oe),Oe+=3,xt=fe[Oe++],se.dispose=1&xt,se.blend=xt>>1&1}nt!="ANMF"&&(Oe+=it)}return Fe}}(N,0);Q.response=N,Q.rgbaoutput=!0,Q.dataurl=!1;var q=Q.header?Q.header:null,Y=Q.frames?Q.frames:null;if(q){q.loop_counter=q.loop_count,x=[q.canvas_height],B=[q.canvas_width];for(var te=0;te<Y.length&&Y[te].blend!=0;te++);}var pe=Y[0],ge=U.WebPDecodeRGBA(N,pe.src_off,pe.src_size,B,x);pe.rgba=ge,pe.imgwidth=B[0],pe.imgheight=x[0];for(var ye=0;ye<B[0]*x[0]*4;ye++)M[ye]=ge[ye];return this.width=B,this.height=x,this.data=M,this}(function(r){var e=function(){return typeof u2=="function"},t=function(x,B,M,U){var N=4,Q=a;switch(U){case r.image_compression.FAST:N=1,Q=s;break;case r.image_compression.MEDIUM:N=6,Q=o;break;case r.image_compression.SLOW:N=9,Q=A}x=n(x,B,M,Q);var q=u2(x,{level:N});return r.__addimage__.arrayBufferToBinaryString(q)},n=function(x,B,M,U){for(var N,Q,q,Y=x.length/B,te=new Uint8Array(x.length+Y),pe=m(),ge=0;ge<Y;ge+=1){if(q=ge*B,N=x.subarray(q,q+B),U)te.set(U(N,M,Q),q+ge);else{for(var ye,fe=pe.length,Oe=[];ye<fe;ye+=1)Oe[ye]=pe[ye](N,M,Q);var Fe=v(Oe.concat());te.set(Oe[Fe],q+ge)}Q=N}return te},i=function(x){var B=Array.apply([],x);return B.unshift(0),B},s=function(x,B){var M,U=[],N=x.length;U[0]=1;for(var Q=0;Q<N;Q+=1)M=x[Q-B]||0,U[Q+1]=x[Q]-M+256&255;return U},a=function(x,B,M){var U,N=[],Q=x.length;N[0]=2;for(var q=0;q<Q;q+=1)U=M&&M[q]||0,N[q+1]=x[q]-U+256&255;return N},o=function(x,B,M){var U,N,Q=[],q=x.length;Q[0]=3;for(var Y=0;Y<q;Y+=1)U=x[Y-B]||0,N=M&&M[Y]||0,Q[Y+1]=x[Y]+256-(U+N>>>1)&255;return Q},A=function(x,B,M){var U,N,Q,q,Y=[],te=x.length;Y[0]=4;for(var pe=0;pe<te;pe+=1)U=x[pe-B]||0,N=M&&M[pe]||0,Q=M&&M[pe-B]||0,q=f(U,N,Q),Y[pe+1]=x[pe]-q+256&255;return Y},f=function(x,B,M){if(x===B&&B===M)return x;var U=Math.abs(B-M),N=Math.abs(x-M),Q=Math.abs(x+B-M-M);return U<=N&&U<=Q?x:N<=Q?B:M},m=function(){return[i,s,a,o,A]},v=function(x){var B=x.map(function(M){return M.reduce(function(U,N){return U+Math.abs(N)},0)});return B.indexOf(Math.min.apply(null,B))};r.processPNG=function(x,B,M,U){var N,Q,q,Y,te,pe,ge,ye,fe,Oe,Fe,oe,le,xe,_e,tt=this.decode.FLATE_DECODE,et="";if(this.__addimage__.isArrayBuffer(x)&&(x=new Uint8Array(x)),this.__addimage__.isArrayBufferView(x)){if(x=(q=new Fte(x)).imgData,Q=q.bits,N=q.colorSpace,te=q.colors,[4,6].indexOf(q.colorType)!==-1){if(q.bits===8){fe=(ye=q.pixelBitlength==32?new Uint32Array(q.decodePixels().buffer):q.pixelBitlength==16?new Uint16Array(q.decodePixels().buffer):new Uint8Array(q.decodePixels().buffer)).length,Fe=new Uint8Array(fe*q.colors),Oe=new Uint8Array(fe);var nt,Je=q.pixelBitlength-q.bits;for(xe=0,_e=0;xe<fe;xe++){for(le=ye[xe],nt=0;nt<Je;)Fe[_e++]=le>>>nt&255,nt+=q.bits;Oe[xe]=le>>>nt&255}}if(q.bits===16){fe=(ye=new Uint32Array(q.decodePixels().buffer)).length,Fe=new Uint8Array(fe*(32/q.pixelBitlength)*q.colors),Oe=new Uint8Array(fe*(32/q.pixelBitlength)),oe=q.colors>1,xe=0,_e=0;for(var it=0;xe<fe;)le=ye[xe++],Fe[_e++]=le>>>0&255,oe&&(Fe[_e++]=le>>>16&255,le=ye[xe++],Fe[_e++]=le>>>0&255),Oe[it++]=le>>>16&255;Q=8}U!==r.image_compression.NONE&&e()?(x=t(Fe,q.width*q.colors,q.colors,U),ge=t(Oe,q.width,1,U)):(x=Fe,ge=Oe,tt=void 0)}if(q.colorType===3&&(N=this.color_spaces.INDEXED,pe=q.palette,q.transparency.indexed)){var ot=q.transparency.indexed,xt=0;for(xe=0,fe=ot.length;xe<fe;++xe)xt+=ot[xe];if((xt/=255)===fe-1&&ot.indexOf(0)!==-1)Y=[ot.indexOf(0)];else if(xt!==fe){for(ye=q.decodePixels(),Oe=new Uint8Array(ye.length),xe=0,fe=ye.length;xe<fe;xe++)Oe[xe]=ot[ye[xe]];ge=t(Oe,q.width,1)}}var se=function(be){var Me;switch(be){case r.image_compression.FAST:Me=11;break;case r.image_compression.MEDIUM:Me=13;break;case r.image_compression.SLOW:Me=14;break;default:Me=12}return Me}(U);return tt===this.decode.FLATE_DECODE&&(et="/Predictor "+se+" "),et+="/Colors "+te+" /BitsPerComponent "+Q+" /Columns "+q.width,(this.__addimage__.isArrayBuffer(x)||this.__addimage__.isArrayBufferView(x))&&(x=this.__addimage__.arrayBufferToBinaryString(x)),(ge&&this.__addimage__.isArrayBuffer(ge)||this.__addimage__.isArrayBufferView(ge))&&(ge=this.__addimage__.arrayBufferToBinaryString(ge)),{alias:M,data:x,index:B,filter:tt,decodeParameters:et,transparency:Y,palette:pe,sMask:ge,predictor:se,width:q.width,height:q.height,bitsPerComponent:Q,colorSpace:N}}}})(qr.API),function(r){r.processGIF89A=function(e,t,n,i){var s=new Mte(e),a=s.width,o=s.height,A=[];s.decodeAndBlitFrameRGBA(0,A);var f={data:A,width:a,height:o},m=new w2(100).encode(f,100);return r.processJPEG.call(this,m,t,n,i)},r.processGIF87A=r.processGIF89A}(qr.API),Wc.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var e=0;e<r;e++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:t,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Wc.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[r]()}catch(t){li.log("bit decode error:"+t)}},Wc.prototype.bit1=function(){var r,e=Math.ceil(this.width/8),t=e%4;for(r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<e;i++)for(var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var A=this.palette[s>>7-o&1];this.data[a+4*o]=A.blue,this.data[a+4*o+1]=A.green,this.data[a+4*o+2]=A.red,this.data[a+4*o+3]=255}t!==0&&(this.pos+=4-t)}},Wc.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),e=r%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<r;i++){var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+2*i*4,o=s>>4,A=15&s,f=this.palette[o];if(this.data[a]=f.blue,this.data[a+1]=f.green,this.data[a+2]=f.red,this.data[a+3]=255,2*i+1>=this.width)break;f=this.palette[A],this.data[a+4]=f.blue,this.data[a+4+1]=f.green,this.data[a+4+2]=f.red,this.data[a+4+3]=255}e!==0&&(this.pos+=4-e)}},Wc.prototype.bit8=function(){for(var r=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*n;if(i<this.palette.length){var a=this.palette[i];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}r!==0&&(this.pos+=4-r)}},Wc.prototype.bit15=function(){for(var r=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,o=(s>>5&e)/e*255|0,A=(s>>10&e)/e*255|0,f=s>>15?255:0,m=n*this.width*4+4*i;this.data[m]=A,this.data[m+1]=o,this.data[m+2]=a,this.data[m+3]=f}this.pos+=r}},Wc.prototype.bit16=function(){for(var r=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,A=(a>>5&t)/t*255|0,f=(a>>11)/e*255|0,m=i*this.width*4+4*s;this.data[m]=f,this.data[m+1]=A,this.data[m+2]=o,this.data[m+3]=255}this.pos+=r}},Wc.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=s,this.data[a+1]=i,this.data[a+2]=n,this.data[a+3]=255}this.pos+=this.width%4}},Wc.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=a}},Wc.prototype.getData=function(){return this.data},function(r){r.processBMP=function(e,t,n,i){var s=new Wc(e,!1),a=s.width,o=s.height,A={data:s.getData(),width:a,height:o},f=new w2(100).encode(A,100);return r.processJPEG.call(this,f,t,n,i)}}(qr.API),XF.prototype.getData=function(){return this.data},function(r){r.processWEBP=function(e,t,n,i){var s=new XF(e),a=s.width,o=s.height,A={data:s.getData(),width:a,height:o},f=new w2(100).encode(A,100);return r.processJPEG.call(this,f,t,n,i)}}(qr.API),qr.API.processRGBA=function(r,e,t){for(var n=r.data,i=n.length,s=new Uint8Array(i/4*3),a=new Uint8Array(i/4),o=0,A=0,f=0;f<i;f+=4){var m=n[f],v=n[f+1],x=n[f+2],B=n[f+3];s[o++]=m,s[o++]=v,s[o++]=x,a[A++]=B}var M=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:M,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},qr.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Bf=qr.API,vy=Bf.getCharWidthsArray=function(r,e){var t,n,i=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),a=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:i.metadata.Unicode.widths,A=o.fof?o.fof:1,f=e.kerning?e.kerning:i.metadata.Unicode.kerning,m=f.fof?f.fof:1,v=e.doKerning!==!1,x=0,B=r.length,M=0,U=o[0]||A,N=[];for(t=0;t<B;t++)n=r.charCodeAt(t),typeof i.metadata.widthOfString=="function"?N.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+a*(1e3/s)||0)/1e3):(x=v&&Dn(f[n])==="object"&&!isNaN(parseInt(f[n][M],10))?f[n][M]/m:0,N.push((o[n]||U)/A+x)),M=n;return N},qF=Bf.getStringUnitWidth=function(r,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return Bf.processArabic&&(r=Bf.processArabic(r)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(r,t,i)/t:vy.apply(this,arguments).reduce(function(s,a){return s+a},0)},KF=function(r,e,t,n){for(var i=[],s=0,a=r.length,o=0;s!==a&&o+e[s]<t;)o+=e[s],s++;i.push(r.slice(0,s));var A=s;for(o=0;s!==a;)o+e[s]>n&&(i.push(r.slice(A,s)),o=0,A=s),o+=e[s],s++;return A!==s&&i.push(r.slice(A,s)),i},WF=function(r,e,t){t||(t={});var n,i,s,a,o,A,f,m=[],v=[m],x=t.textIndent||0,B=0,M=0,U=r.split(" "),N=vy.apply(this,[" ",t])[0];if(A=t.lineIndent===-1?U[0].length+2:t.lineIndent||0){var Q=Array(A).join(" "),q=[];U.map(function(te){(te=te.split(/\s*\n/)).length>1?q=q.concat(te.map(function(pe,ge){return(ge&&pe.length?`
`:"")+pe})):q.push(te[0])}),U=q,A=qF.apply(this,[Q,t])}for(s=0,a=U.length;s<a;s++){var Y=0;if(n=U[s],A&&n[0]==`
`&&(n=n.substr(1),Y=1),x+B+(M=(i=vy.apply(this,[n,t])).reduce(function(te,pe){return te+pe},0))>e||Y){if(M>e){for(o=KF.apply(this,[n,i,e-(x+B),e]),m.push(o.shift()),m=[o.pop()];o.length;)v.push([o.shift()]);M=i.slice(n.length-(m[0]?m[0].length:0)).reduce(function(te,pe){return te+pe},0)}else m=[n];v.push(m),x=M+A,B=N}else m.push(n),x+=B+M,B=N}return f=A?function(te,pe){return(pe?Q:"")+te.join(" ")}:function(te){return te.join(" ")},v.map(f)},Bf.splitTextToSize=function(r,e,t){var n,i=(t=t||{}).fontSize||this.internal.getFontSize(),s=(function(m){if(m.widths&&m.kerning)return{widths:m.widths,kerning:m.kerning};var v=this.internal.getFont(m.fontName,m.fontStyle);return v.metadata.Unicode?{widths:v.metadata.Unicode.widths||{0:1},kerning:v.metadata.Unicode.kerning||{}}:{font:v.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);n=Array.isArray(r)?r:String(r).split(/\r?\n/);var a=1*this.internal.scaleFactor*e/i;s.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=t.lineIndent;var o,A,f=[];for(o=0,A=n.length;o<A;o++)f=f.concat(WF.apply(this,[n[o],a,s]));return f},function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",t={},n={},i=0;i<e.length;i++)t[e[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=e[i];var s=function(v){return"0x"+parseInt(v,10).toString(16)},a=r.__fontmetrics__.compress=function(v){var x,B,M,U,N=["{"];for(var Q in v){if(x=v[Q],isNaN(parseInt(Q,10))?B="'"+Q+"'":(Q=parseInt(Q,10),B=(B=s(Q).slice(2)).slice(0,-1)+n[B.slice(-1)]),typeof x=="number")x<0?(M=s(x).slice(3),U="-"):(M=s(x).slice(2),U=""),M=U+M.slice(0,-1)+n[M.slice(-1)];else{if(Dn(x)!=="object")throw new Error("Don't know what to do with value type "+Dn(x)+".");M=a(x)}N.push(B+M)}return N.push("}"),N.join("")},o=r.__fontmetrics__.uncompress=function(v){if(typeof v!="string")throw new Error("Invalid argument passed to uncompress.");for(var x,B,M,U,N={},Q=1,q=N,Y=[],te="",pe="",ge=v.length-1,ye=1;ye<ge;ye+=1)(U=v[ye])=="'"?x?(M=x.join(""),x=void 0):x=[]:x?x.push(U):U=="{"?(Y.push([q,M]),q={},M=void 0):U=="}"?((B=Y.pop())[0][B[1]]=q,M=void 0,q=B[0]):U=="-"?Q=-1:M===void 0?t.hasOwnProperty(U)?(te+=t[U],M=parseInt(te,16)*Q,Q=1,te=""):te+=U:t.hasOwnProperty(U)?(pe+=t[U],q[M]=parseInt(pe,16)*Q,Q=1,M=void 0,pe=""):pe+=U;return N},A={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:A,"Courier-Bold":A,"Courier-BoldOblique":A,"Courier-Oblique":A,Helvetica:A,"Helvetica-Bold":A,"Helvetica-BoldOblique":A,"Helvetica-Oblique":A,"Times-Roman":A,"Times-Bold":A,"Times-BoldItalic":A,"Times-Italic":A}},m={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(v){var x=v.font,B=m.Unicode[x.postScriptName];B&&(x.metadata.Unicode={},x.metadata.Unicode.widths=B.widths,x.metadata.Unicode.kerning=B.kerning);var M=f.Unicode[x.postScriptName];M&&(x.metadata.Unicode.encoding=M,x.encoding=M.codePages[0])}])}(qr.API),function(r){var e=function(t){for(var n=t.length,i=new Uint8Array(n),s=0;s<n;s++)i[s]=t.charCodeAt(s);return i};r.API.events.push(["addFont",function(t){var n=void 0,i=t.font,s=t.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(Ig(o)),a.metadata=r.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(i,n)}}])}(qr),function(r){function e(){return(jr.canvg?Promise.resolve(jr.canvg):Promise.resolve().then(()=>K1e)).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}qr.API.addSvgAsImage=function(t,n,i,s,a,o,A,f){if(isNaN(n)||isNaN(i))throw li.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(a))throw li.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var m=document.createElement("canvas");m.width=s,m.height=a;var v=m.getContext("2d");v.fillStyle="#fff",v.fillRect(0,0,m.width,m.height);var x={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},B=this;return e().then(function(M){return M.fromString(v,t,x)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(M){return M.render(x)}).then(function(){B.addImage(m.toDataURL("image/jpeg",1),n,i,s,a,A,f)})}}(),qr.API.putTotalPages=function(r){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(r,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,t);return this},qr.API.viewerPreferences=function(r,e){var t;r=r||{},e=e||!1;var n,i,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),A=[],f=0,m=0,v=0;function x(M,U){var N,Q=!1;for(N=0;N<M.length;N+=1)M[N]===U&&(Q=!0);return Q}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,r==="reset"||e===!0){var B=o.length;for(v=0;v<B;v+=1)t[o[v]].value=t[o[v]].defaultValue,t[o[v]].explicitSet=!1}if(Dn(r)==="object"){for(i in r)if(s=r[i],x(o,i)&&s!==void 0){if(t[i].type==="boolean"&&typeof s=="boolean")t[i].value=s;else if(t[i].type==="name"&&x(t[i].valueSet,s))t[i].value=s;else if(t[i].type==="integer"&&Number.isInteger(s))t[i].value=s;else if(t[i].type==="array"){for(f=0;f<s.length;f+=1)if(n=!0,s[f].length===1&&typeof s[f][0]=="number")A.push(String(s[f]-1));else if(s[f].length>1){for(m=0;m<s[f].length;m+=1)typeof s[f][m]!="number"&&(n=!1);n===!0&&A.push([s[f][0]-1,s[f][1]-1].join(" "))}t[i].value="["+A.join(" ")+"]"}else t[i].value=t[i].defaultValue;t[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var M,U=[];for(M in t)t[M].explicitSet===!0&&(t[M].type==="name"?U.push("/"+M+" /"+t[M].value):U.push("/"+M+" "+t[M].value));U.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+U.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(r){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),A=unescape(encodeURIComponent("</x:xmpmeta>")),f=s.length+a.length+o.length+i.length+A.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+f+" >>"),this.internal.write("stream"),this.internal.write(i+s+a+o+A),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}}(qr.API),function(r){var e=r.API,t=e.pdfEscape16=function(s,a){for(var o,A=a.metadata.Unicode.widths,f=["","0","00","000","0000"],m=[""],v=0,x=s.length;v<x;++v){if(o=a.metadata.characterToGlyph(s.charCodeAt(v)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=s.charCodeAt(v),A.indexOf(o)==-1&&(A.push(o),A.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return m.join("");o=o.toString(16),m.push(f[4-o.length],o)}return m.join("")},n=function(s){var a,o,A,f,m,v,x;for(m=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,A=[],v=0,x=(o=Object.keys(s).sort(function(B,M){return B-M})).length;v<x;v++)a=o[v],A.length>=100&&(m+=`
`+A.length+` beginbfchar
`+A.join(`
`)+`
endbfchar`,A=[]),s[a]!==void 0&&s[a]!==null&&typeof s[a].toString=="function"&&(f=("0000"+s[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),A.push("<"+a+"><"+f+">"));return A.length&&(m+=`
`+A.length+` beginbfchar
`+A.join(`
`)+`
endbfchar
`),m+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(a){var o=a.font,A=a.out,f=a.newObject,m=a.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="Identity-H"){for(var v=o.metadata.Unicode.widths,x=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),B="",M=0;M<x.length;M++)B+=String.fromCharCode(x[M]);var U=f();m({data:B,addLength1:!0,objectId:U}),A("endobj");var N=f();m({data:n(o.metadata.toUnicode),addLength1:!0,objectId:N}),A("endobj");var Q=f();A("<<"),A("/Type /FontDescriptor"),A("/FontName /"+mf(o.fontName)),A("/FontFile2 "+U+" 0 R"),A("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),A("/Flags "+o.metadata.flags),A("/StemV "+o.metadata.stemV),A("/ItalicAngle "+o.metadata.italicAngle),A("/Ascent "+o.metadata.ascender),A("/Descent "+o.metadata.decender),A("/CapHeight "+o.metadata.capHeight),A(">>"),A("endobj");var q=f();A("<<"),A("/Type /Font"),A("/BaseFont /"+mf(o.fontName)),A("/FontDescriptor "+Q+" 0 R"),A("/W "+r.API.PDFObject.convert(v)),A("/CIDToGIDMap /Identity"),A("/DW 1000"),A("/Subtype /CIDFontType2"),A("/CIDSystemInfo"),A("<<"),A("/Supplement 0"),A("/Registry (Adobe)"),A("/Ordering ("+o.encoding+")"),A(">>"),A(">>"),A("endobj"),o.objectNumber=f(),A("<<"),A("/Type /Font"),A("/Subtype /Type0"),A("/ToUnicode "+N+" 0 R"),A("/BaseFont /"+mf(o.fontName)),A("/Encoding /"+o.encoding),A("/DescendantFonts ["+q+" 0 R]"),A(">>"),A("endobj"),o.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(a){var o=a.font,A=a.out,f=a.newObject,m=a.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var v=o.metadata.rawData,x="",B=0;B<v.length;B++)x+=String.fromCharCode(v[B]);var M=f();m({data:x,addLength1:!0,objectId:M}),A("endobj");var U=f();m({data:n(o.metadata.toUnicode),addLength1:!0,objectId:U}),A("endobj");var N=f();A("<<"),A("/Descent "+o.metadata.decender),A("/CapHeight "+o.metadata.capHeight),A("/StemV "+o.metadata.stemV),A("/Type /FontDescriptor"),A("/FontFile2 "+M+" 0 R"),A("/Flags 96"),A("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),A("/FontName /"+mf(o.fontName)),A("/ItalicAngle "+o.metadata.italicAngle),A("/Ascent "+o.metadata.ascender),A(">>"),A("endobj"),o.objectNumber=f();for(var Q=0;Q<o.metadata.hmtx.widths.length;Q++)o.metadata.hmtx.widths[Q]=parseInt(o.metadata.hmtx.widths[Q]*(1e3/o.metadata.head.unitsPerEm));A("<</Subtype/TrueType/Type/Font/ToUnicode "+U+" 0 R/BaseFont/"+mf(o.fontName)+"/FontDescriptor "+N+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),A("endobj"),o.isAlreadyPutted=!0}})(s)}]);var i=function(s){var a,o=s.text||"",A=s.x,f=s.y,m=s.options||{},v=s.mutex||{},x=v.pdfEscape,B=v.activeFontKey,M=v.fonts,U=B,N="",Q=0,q="",Y=M[U].encoding;if(M[U].encoding!=="Identity-H")return{text:o,x:A,y:f,options:m,mutex:v};for(q=o,U=B,Array.isArray(o)&&(q=o[0]),Q=0;Q<q.length;Q+=1)M[U].metadata.hasOwnProperty("cmap")&&(a=M[U].metadata.cmap.unicode.codeMap[q[Q].charCodeAt(0)]),a||q[Q].charCodeAt(0)<256&&M[U].metadata.hasOwnProperty("Unicode")?N+=q[Q]:N+="";var te="";return parseInt(U.slice(1))<14||Y==="WinAnsiEncoding"?te=x(N,U).split("").map(function(pe){return pe.charCodeAt(0).toString(16)}).join(""):Y==="Identity-H"&&(te=t(N,M[U])),v.isHex=!0,{text:te,x:A,y:f,options:m,mutex:v}};e.events.push(["postProcessText",function(s){var a=s.text||"",o=[],A={text:a,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(a)){var f=0;for(f=0;f<a.length;f+=1)Array.isArray(a[f])&&a[f].length===3?o.push([i(Object.assign({},A,{text:a[f][0]})).text,a[f][1],a[f][2]]):o.push(i(Object.assign({},A,{text:a[f]})).text);s.text=o}else s.text=i(Object.assign({},A,{text:a})).text}])}(qr),function(r){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},r.addFileToVFS=function(t,n){return e.call(this),this.internal.vFS[t]=n,this},r.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(qr.API),function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(n){var i,s,a,o,A,f,m,v=e,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],B=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],M={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},U={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},N=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Q=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),q=!1,Y=0;this.__bidiEngine__={};var te=function(oe){var le=oe.charCodeAt(),xe=le>>8,_e=U[xe];return _e!==void 0?v[256*_e+(255&le)]:xe===252||xe===253?"AL":Q.test(xe)?"L":xe===8?"R":"N"},pe=function(oe){for(var le,xe=0;xe<oe.length;xe++){if((le=te(oe.charAt(xe)))==="L")return!1;if(le==="R")return!0}return!1},ge=function(oe,le,xe,_e){var tt,et,nt,Je,it=le[_e];switch(it){case"L":case"R":q=!1;break;case"N":case"AN":break;case"EN":q&&(it="AN");break;case"AL":q=!0,it="R";break;case"WS":it="N";break;case"CS":_e<1||_e+1>=le.length||(tt=xe[_e-1])!=="EN"&&tt!=="AN"||(et=le[_e+1])!=="EN"&&et!=="AN"?it="N":q&&(et="AN"),it=et===tt?et:"N";break;case"ES":it=(tt=_e>0?xe[_e-1]:"B")==="EN"&&_e+1<le.length&&le[_e+1]==="EN"?"EN":"N";break;case"ET":if(_e>0&&xe[_e-1]==="EN"){it="EN";break}if(q){it="N";break}for(nt=_e+1,Je=le.length;nt<Je&&le[nt]==="ET";)nt++;it=nt<Je&&le[nt]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(Je=le.length,nt=_e+1;nt<Je&&le[nt]==="NSM";)nt++;if(nt<Je){var ot=oe[_e],xt=ot>=1425&&ot<=2303||ot===64286;if(tt=le[nt],xt&&(tt==="R"||tt==="AL")){it="R";break}}}it=_e<1||(tt=le[_e-1])==="B"?"N":xe[_e-1];break;case"B":q=!1,i=!0,it=Y;break;case"S":s=!0,it="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":q=!1;break;case"BN":it="N"}return it},ye=function(oe,le,xe){var _e=oe.split("");return xe&&fe(_e,xe,{hiLevel:Y}),_e.reverse(),le&&le.reverse(),_e.join("")},fe=function(oe,le,xe){var _e,tt,et,nt,Je,it=-1,ot=oe.length,xt=0,se=[],be=Y?B:x,Me=[];for(q=!1,i=!1,s=!1,tt=0;tt<ot;tt++)Me[tt]=te(oe[tt]);for(et=0;et<ot;et++){if(Je=xt,se[et]=ge(oe,Me,se,et),_e=240&(xt=be[Je][M[se[et]]]),xt&=15,le[et]=nt=be[xt][5],_e>0)if(_e===16){for(tt=it;tt<et;tt++)le[tt]=1;it=-1}else it=-1;if(be[xt][6])it===-1&&(it=et);else if(it>-1){for(tt=it;tt<et;tt++)le[tt]=nt;it=-1}Me[et]==="B"&&(le[et]=0),xe.hiLevel|=nt}s&&function(De,$e,qe){for(var ct=0;ct<qe;ct++)if(De[ct]==="S"){$e[ct]=Y;for(var st=ct-1;st>=0&&De[st]==="WS";st--)$e[st]=Y}}(Me,le,ot)},Oe=function(oe,le,xe,_e,tt){if(!(tt.hiLevel<oe)){if(oe===1&&Y===1&&!i)return le.reverse(),void(xe&&xe.reverse());for(var et,nt,Je,it,ot=le.length,xt=0;xt<ot;){if(_e[xt]>=oe){for(Je=xt+1;Je<ot&&_e[Je]>=oe;)Je++;for(it=xt,nt=Je-1;it<nt;it++,nt--)et=le[it],le[it]=le[nt],le[nt]=et,xe&&(et=xe[it],xe[it]=xe[nt],xe[nt]=et);xt=Je}xt++}}},Fe=function(oe,le,xe){var _e=oe.split(""),tt={hiLevel:Y};return xe||(xe=[]),fe(_e,xe,tt),function(et,nt,Je){if(Je.hiLevel!==0&&m)for(var it,ot=0;ot<et.length;ot++)nt[ot]===1&&(it=N.indexOf(et[ot]))>=0&&(et[ot]=N[it+1])}(_e,xe,tt),Oe(2,_e,le,xe,tt),Oe(1,_e,le,xe,tt),_e.join("")};return this.__bidiEngine__.doBidiReorder=function(oe,le,xe){if(function(tt,et){if(et)for(var nt=0;nt<tt.length;nt++)et[nt]=nt;o===void 0&&(o=pe(tt)),f===void 0&&(f=pe(tt))}(oe,le),a||!A||f)if(a&&A&&o^f)Y=o?1:0,oe=ye(oe,le,xe);else if(!a&&A&&f)Y=o?1:0,oe=Fe(oe,le,xe),oe=ye(oe,le);else if(!a||o||A||f){if(a&&!A&&o^f)oe=ye(oe,le),o?(Y=0,oe=Fe(oe,le,xe)):(Y=1,oe=Fe(oe,le,xe),oe=ye(oe,le));else if(a&&o&&!A&&f)Y=1,oe=Fe(oe,le,xe),oe=ye(oe,le);else if(!a&&!A&&o^f){var _e=m;o?(Y=1,oe=Fe(oe,le,xe),Y=0,m=!1,oe=Fe(oe,le,xe),m=_e):(Y=0,oe=Fe(oe,le,xe),oe=ye(oe,le),Y=1,m=!1,oe=Fe(oe,le,xe),m=_e,oe=ye(oe,le))}}else Y=0,oe=Fe(oe,le,xe);else Y=o?1:0,oe=Fe(oe,le,xe);return oe},this.__bidiEngine__.setOptions=function(oe){oe&&(a=oe.isInputVisual,A=oe.isOutputVisual,o=oe.isInputRtl,f=oe.isOutputRtl,m=oe.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(n){var i=n.text,s=(n.x,n.y,n.options||{}),a=(n.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,t.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(a=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?a.push([t.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):a.push([t.doBidiReorder(i[o])]);n.text=a}else n.text=t.doBidiReorder(i);t.setOptions({isInputVisual:!0})}])}(qr),qr.API.TTFFont=function(){function r(e){var t;if(this.rawData=e,t=this.contents=new NA(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new Kte(this),this.registerTTF()}return r.open=function(e){return new r(e)},r.prototype.parse=function(){return this.directory=new Pte(this.contents),this.head=new Rte(this),this.name=new Qte(this),this.cmap=new YF(this),this.toUnicode={},this.hhea=new Ote(this),this.maxp=new Hte(this),this.hmtx=new zte(this),this.post=new kte(this),this.os2=new Dte(this),this.loca=new qte(this),this.glyf=new Gte(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var e,t,n,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,o,A,f;for(f=[],a=0,o=(A=this.bbox).length;a<o;a++)e=A[a],f.push(Math.round(e*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(t=i>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},r.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},r.prototype.widthOfString=function(e,t,n){var i,s,a,o;for(a=0,s=0,o=(e=""+e).length;0<=o?s<o:s>o;s=0<=o?++s:--s)i=e.charCodeAt(s),a+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/t)||0;return a*(t/1e3)},r.prototype.lineHeight=function(e,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},r}();var $c,NA=function(){function r(e){this.data=e??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(e){return this.data[this.pos++]=e},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},r.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},r.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},r.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},r.prototype.writeString=function(e){var t,n,i;for(i=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)i.push(this.writeByte(e.charCodeAt(t)));return i},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(e){return this.writeInt16(e)},r.prototype.readLongLong=function(){var e,t,n,i,s,a,o,A;return e=this.readByte(),t=this.readByte(),n=this.readByte(),i=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),A=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^s)+65536*(255^a)+256*(255^o)+(255^A)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*i+16777216*s+65536*a+256*o+A},r.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(e){return this.writeInt32(e)},r.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},r.prototype.write=function(e){var t,n,i,s;for(s=[],n=0,i=e.length;n<i;n++)t=e[n],s.push(this.writeByte(t));return s},r}(),Pte=function(){var r;function e(t){var n,i,s;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(t){var n,i,s,a,o,A,f,m,v,x,B,M,U;for(U in B=Object.keys(t).length,A=Math.log(2),v=16*Math.floor(Math.log(B)/A),a=Math.floor(v/A),m=16*B-v,(i=new NA).writeInt(this.scalarType),i.writeShort(B),i.writeShort(v),i.writeShort(a),i.writeShort(m),s=16*B,f=i.pos+s,o=null,M=[],t)for(x=t[U],i.writeString(U),i.writeInt(r(x)),i.writeInt(f),i.writeInt(x.length),M=M.concat(x),U==="head"&&(o=f),f+=x.length;f%4;)M.push(0),f++;return i.write(M),n=2981146554-r(i.data),i.pos=o+8,i.writeUInt32(n),i.data},r=function(t){var n,i,s,a;for(t=ZF.call(t);t.length%4;)t.push(0);for(s=new NA(t),i=0,n=0,a=t.length;n<a;n=n+=4)i+=s.readUInt32();return 4294967295&i},e}(),Ute={}.hasOwnProperty,$l=function(r,e){for(var t in e)Ute.call(e,t)&&(r[t]=e[t]);function n(){this.constructor=r}return n.prototype=e.prototype,r.prototype=new n,r.__super__=e.prototype,r};$c=function(){function r(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r}();var Rte=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return $l(e,$c),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var n;return(n=new NA).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(t),n.writeShort(this.glyphDataFormat),n.data},e}(),JF=function(){function r(e,t){var n,i,s,a,o,A,f,m,v,x,B,M,U,N,Q,q,Y;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),v=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(A=0;A<256;++A)this.codeMap[A]=e.readByte();break;case 4:for(B=e.readUInt16(),x=B/2,e.pos+=6,s=function(){var te,pe;for(pe=[],A=te=0;0<=x?te<x:te>x;A=0<=x?++te:--te)pe.push(e.readUInt16());return pe}(),e.pos+=2,U=function(){var te,pe;for(pe=[],A=te=0;0<=x?te<x:te>x;A=0<=x?++te:--te)pe.push(e.readUInt16());return pe}(),f=function(){var te,pe;for(pe=[],A=te=0;0<=x?te<x:te>x;A=0<=x?++te:--te)pe.push(e.readUInt16());return pe}(),m=function(){var te,pe;for(pe=[],A=te=0;0<=x?te<x:te>x;A=0<=x?++te:--te)pe.push(e.readUInt16());return pe}(),i=(this.length-e.pos+this.offset)/2,o=function(){var te,pe;for(pe=[],A=te=0;0<=i?te<i:te>i;A=0<=i?++te:--te)pe.push(e.readUInt16());return pe}(),A=Q=0,Y=s.length;Q<Y;A=++Q)for(N=s[A],n=q=M=U[A];M<=N?q<=N:q>=N;n=M<=N?++q:--q)m[A]===0?a=n+f[A]:(a=o[m[A]/2+(n-M)-(x-A)]||0)!==0&&(a+=f[A]),this.codeMap[n]=65535&a}e.pos=v}return r.encode=function(e,t){var n,i,s,a,o,A,f,m,v,x,B,M,U,N,Q,q,Y,te,pe,ge,ye,fe,Oe,Fe,oe,le,xe,_e,tt,et,nt,Je,it,ot,xt,se,be,Me,De,$e,qe,ct,st,Ct,It,Qt;switch(_e=new NA,a=Object.keys(e).sort(function(Ht,zt){return Ht-zt}),t){case"macroman":for(U=0,N=function(){var Ht=[];for(M=0;M<256;++M)Ht.push(0);return Ht}(),q={0:0},s={},tt=0,it=a.length;tt<it;tt++)q[st=e[i=a[tt]]]==null&&(q[st]=++U),s[i]={old:e[i],new:q[e[i]]},N[i]=q[e[i]];return _e.writeUInt16(1),_e.writeUInt16(0),_e.writeUInt32(12),_e.writeUInt16(0),_e.writeUInt16(262),_e.writeUInt16(0),_e.write(N),{charMap:s,subtable:_e.data,maxGlyphID:U+1};case"unicode":for(le=[],v=[],Y=0,q={},n={},Q=f=null,et=0,ot=a.length;et<ot;et++)q[pe=e[i=a[et]]]==null&&(q[pe]=++Y),n[i]={old:pe,new:q[pe]},o=q[pe]-i,Q!=null&&o===f||(Q&&v.push(Q),le.push(i),f=o),Q=i;for(Q&&v.push(Q),v.push(65535),le.push(65535),Fe=2*(Oe=le.length),fe=2*Math.pow(Math.log(Oe)/Math.LN2,2),x=Math.log(fe/2)/Math.LN2,ye=2*Oe-fe,A=[],ge=[],B=[],M=nt=0,xt=le.length;nt<xt;M=++nt){if(oe=le[M],m=v[M],oe===65535){A.push(0),ge.push(0);break}if(oe-(xe=n[oe].new)>=32768)for(A.push(0),ge.push(2*(B.length+Oe-M)),i=Je=oe;oe<=m?Je<=m:Je>=m;i=oe<=m?++Je:--Je)B.push(n[i].new);else A.push(xe-oe),ge.push(0)}for(_e.writeUInt16(3),_e.writeUInt16(1),_e.writeUInt32(12),_e.writeUInt16(4),_e.writeUInt16(16+8*Oe+2*B.length),_e.writeUInt16(0),_e.writeUInt16(Fe),_e.writeUInt16(fe),_e.writeUInt16(x),_e.writeUInt16(ye),qe=0,se=v.length;qe<se;qe++)i=v[qe],_e.writeUInt16(i);for(_e.writeUInt16(0),ct=0,be=le.length;ct<be;ct++)i=le[ct],_e.writeUInt16(i);for(Ct=0,Me=A.length;Ct<Me;Ct++)o=A[Ct],_e.writeUInt16(o);for(It=0,De=ge.length;It<De;It++)te=ge[It],_e.writeUInt16(te);for(Qt=0,$e=B.length;Qt<$e;Qt++)U=B[Qt],_e.writeUInt16(U);return{charMap:n,subtable:_e.data,maxGlyphID:Y+1}}},r}(),YF=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return $l(e,$c),e.prototype.tag="cmap",e.prototype.parse=function(t){var n,i,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=s?i<s:i>s;i=0<=s?++i:--i)n=new JF(t,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(t,n){var i,s;return n==null&&(n="macroman"),i=JF.encode(t,n),(s=new NA).writeUInt16(0),s.writeUInt16(1),i.table=s.data.concat(i.subtable),i},e}(),Ote=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return $l(e,$c),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),Dte=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return $l(e,$c),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(t.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(t.readInt());return i}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(t.readInt());return i}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),kte=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return $l(e,$c),e.prototype.tag="post",e.prototype.parse=function(t){var n,i,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var a;for(i=t.readUInt16(),this.glyphNameIndex=[],a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)n=t.readByte(),s.push(this.names.push(t.readString(n)));return s;case 151552:return i=t.readUInt16(),this.offsets=t.read(i);case 196608:break;case 262144:return this.map=(function(){var o,A,f;for(f=[],a=o=0,A=this.file.maxp.numGlyphs;0<=A?o<A:o>A;a=0<=A?++o:--o)f.push(t.readUInt32());return f}).call(this)}},e}(),Nte=function(r,e){this.raw=r,this.length=r.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},Qte=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return $l(e,$c),e.prototype.tag="name",e.prototype.parse=function(t){var n,i,s,a,o,A,f,m,v,x,B;for(t.pos=this.offset,t.readShort(),n=t.readShort(),A=t.readShort(),i=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)i.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+A+t.readShort()});for(f={},a=v=0,x=i.length;v<x;a=++v)s=i[a],t.pos=s.offset,m=t.readString(s.length),o=new Nte(m,s),f[B=s.nameID]==null&&(f[B]=[]),f[s.nameID].push(o);this.strings=f,this.copyright=f[0],this.fontFamily=f[1],this.fontSubfamily=f[2],this.uniqueSubfamily=f[3],this.fontName=f[4],this.version=f[5];try{this.postscriptName=f[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=f[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=f[7],this.manufacturer=f[8],this.designer=f[9],this.description=f[10],this.vendorUrl=f[11],this.designerUrl=f[12],this.license=f[13],this.licenseUrl=f[14],this.preferredFamily=f[15],this.preferredSubfamily=f[17],this.compatibleFull=f[18],this.sampleText=f[19]},e}(),Hte=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return $l(e,$c),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),zte=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return $l(e,$c),e.prototype.tag="hmtx",e.prototype.parse=function(t){var n,i,s,a,o,A,f;for(t.pos=this.offset,this.metrics=[],n=0,A=this.file.hhea.numberOfMetrics;0<=A?n<A:n>A;n=0<=A?++n:--n)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var m,v;for(v=[],n=m=0;0<=s?m<s:m>s;n=0<=s?++m:--m)v.push(t.readInt16());return v}(),this.widths=(function(){var m,v,x,B;for(B=[],m=0,v=(x=this.metrics).length;m<v;m++)a=x[m],B.push(a.advance);return B}).call(this),i=this.widths[this.widths.length-1],f=[],n=o=0;0<=s?o<s:o>s;n=0<=s?++o:--o)f.push(this.widths.push(i));return f},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),ZF=[].slice,Gte=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return $l(e,$c),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var n,i,s,a,o,A,f,m,v,x;return t in this.cache?this.cache[t]:(a=this.file.loca,n=this.file.contents,i=a.indexOf(t),(s=a.lengthOf(t))===0?this.cache[t]=null:(n.pos=this.offset+i,o=(A=new NA(n.read(s))).readShort(),m=A.readShort(),x=A.readShort(),f=A.readShort(),v=A.readShort(),this.cache[t]=o===-1?new jte(A,m,x,f,v):new Vte(A,o,m,x,f,v),this.cache[t]))},e.prototype.encode=function(t,n,i){var s,a,o,A,f;for(o=[],a=[],A=0,f=n.length;A<f;A++)s=t[n[A]],a.push(o.length),s&&(o=o.concat(s.encode(i)));return a.push(o.length),{table:o,offsets:a}},e}(),Vte=function(){function r(e,t,n,i,s,a){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=i,this.xMax=s,this.yMax=a,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r}(),jte=function(){function r(e,t,n,i,s){var a,o;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return r.prototype.encode=function(){var e,t,n;for(t=new NA(ZF.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},r}(),qte=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return $l(e,$c),e.prototype.tag="loca",e.prototype.parse=function(t){var n,i;return t.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var s,a;for(a=[],i=0,s=this.length;i<s;i+=2)a.push(2*t.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],i=0,s=this.length;i<s;i+=4)a.push(t.readUInt32());return a}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,n){for(var i=new Uint32Array(this.offsets.length),s=0,a=0,o=0;o<i.length;++o)if(i[o]=s,a<n.length&&n[a]==o){++a,i[o]=s;var A=this.offsets[o],f=this.offsets[o+1]-A;f>0&&(s+=f)}for(var m=new Array(4*i.length),v=0;v<i.length;++v)m[4*v+3]=255&i[v],m[4*v+2]=(65280&i[v])>>8,m[4*v+1]=(16711680&i[v])>>16,m[4*v]=(4278190080&i[v])>>24;return m},e}(),Kte=function(){function r(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var e,t,n,i,s;for(t in i=this.font.cmap.tables[0].codeMap,e={},s=this.subset)n=s[t],e[t]=i[n];return e},r.prototype.glyphsFor=function(e){var t,n,i,s,a,o,A;for(i={},a=0,o=e.length;a<o;a++)i[s=e[a]]=this.font.glyf.glyphFor(s);for(s in t=[],i)(n=i[s])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(s in A=this.glyphsFor(t))n=A[s],i[s]=n;return i},r.prototype.encode=function(e,t){var n,i,s,a,o,A,f,m,v,x,B,M,U,N,Q;for(i in n=YF.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(e),B={0:0},Q=n.charMap)B[(A=Q[i]).old]=A.new;for(M in x=n.maxGlyphID,a)M in B||(B[M]=x++);return m=function(q){var Y,te;for(Y in te={},q)te[q[Y]]=Y;return te}(B),v=Object.keys(m).sort(function(q,Y){return q-Y}),U=function(){var q,Y,te;for(te=[],q=0,Y=v.length;q<Y;q++)o=v[q],te.push(m[o]);return te}(),s=this.font.glyf.encode(a,U,B),f=this.font.loca.encode(s.offsets,U),N={cmap:this.font.cmap.raw(),glyf:s.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(N["OS/2"]=this.font.os2.raw()),this.font.directory.encode(N)},r}();qr.API.PDFObject=function(){var r;function e(){}return r=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},e.convert=function(t){var n,i,s,a;if(Array.isArray(t))return"["+function(){var o,A,f;for(f=[],o=0,A=t.length;o<A;o++)n=t[o],f.push(e.convert(n));return f}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+r(t.getUTCFullYear(),4)+r(t.getUTCMonth(),2)+r(t.getUTCDate(),2)+r(t.getUTCHours(),2)+r(t.getUTCMinutes(),2)+r(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(i in s=["<<"],t)a=t[i],s.push("/"+i+" "+e.convert(a));return s.push(">>"),s.join(`
`)}return""+t},e}();const x2={"circle-radius":8,"circle-color":"red","circle-stroke-width":1,"circle-stroke-color":"black"};let Wte=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Hh.A4,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:300,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ru.PNG,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:pf.mm,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"map",o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:"maplibregl-marker",A=arguments.length>7&&arguments[7]!==void 0?arguments[7]:x2;jn(this,"map"),jn(this,"width"),jn(this,"height"),jn(this,"dpi"),jn(this,"format"),jn(this,"unit"),jn(this,"fileName"),jn(this,"markerClassName"),jn(this,"markerCirclePaint"),this.map=e,this.width=t[0],this.height=t[1],this.dpi=n,this.format=i,this.unit=s,this.fileName=a,this.markerClassName=o,this.markerCirclePaint=A}renderMapPost(e){return e}getMarkers(){return this.map.getCanvasContainer().getElementsByClassName(this.markerClassName)}renderMarkers(e){const t=this.getMarkers();for(let n=0;n<t.length;n++){const i=t.item(n);if(!i)continue;const s=i.getAttribute("style");if(!s)continue;const a=/translate\(([^,]+)px,\s*([^,]+)px\)/,o=s.match(a);if(!o)continue;const A=parseInt(o[1]),f=parseInt(o[2]),m=this.map.unproject([A,f]),v=`point${n}`;e.addSource(v,{type:"geojson",data:{type:"Point",coordinates:[m.lng,m.lat]}}),e.addLayer({id:v,source:v,type:"circle",paint:this.markerCirclePaint})}return e}generate(){const e=this;JsLoadingOverlay.show({overlayBackgroundColor:"#5D5959",overlayOpacity:"0.6",spinnerIcon:"ball-spin",spinnerColor:"#2400FD",spinnerSize:"2x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetX:0,offsetY:0,containerID:null,lockScroll:!1,overlayZIndex:9998,spinnerZIndex:9999});const t=window.devicePixelRatio;Object.defineProperty(window,"devicePixelRatio",{get(){return e.dpi/96}});const n=document.createElement("div");n.className="hidden-map",document.body.appendChild(n);const i=document.createElement("div");i.style.width=this.toPixels(this.width),i.style.height=this.toPixels(this.height),n.appendChild(i);const s=this.map.getStyle();if(s&&s.sources){const o=s.sources;Object.keys(o).forEach(A=>{const f=o[A];Object.keys(f).forEach(m=>{f[m]||delete f[m]})})}let a=this.getRenderedMap(i,s);a.once("idle",()=>{a=this.renderMapPost(a),this.getMarkers().length===0?this.exportImage(a,n,t):(a=this.renderMarkers(a),a.once("idle",()=>{this.exportImage(a,n,t)}))})}exportImage(e,t,n){var i;const s=e.getCanvas(),a=`${this.fileName}.${this.format}`;switch(this.format){case Ru.PNG:this.toPNG(s,a);break;case Ru.JPEG:this.toJPEG(s,a);break;case Ru.PDF:this.toPDF(e,a);break;case Ru.SVG:this.toSVG(s,a);break;default:console.error(`Invalid file format: ${this.format}`);break}e.remove(),(i=t.parentNode)==null||i.removeChild(t),Object.defineProperty(window,"devicePixelRatio",{get(){return n}}),t.remove(),JsLoadingOverlay.hide()}toPNG(e,t){const n=document.createElement("a");n.href=e.toDataURL(),n.download=t,n.click(),n.remove()}toJPEG(e,t){const n=e.toDataURL("image/jpeg",.85),i=document.createElement("a");i.href=n,i.download=t,i.click(),i.remove()}toPDF(e,t){const n=e.getCanvas(),i=new qr({orientation:this.width>this.height?"l":"p",unit:this.unit,compress:!0,format:[this.width,this.height]});i.addImage(n.toDataURL("image/png"),"png",0,0,this.width,this.height,void 0,"FAST");const{lng:s,lat:a}=e.getCenter();i.setProperties({title:e.getStyle().name,subject:`center: [${s}, ${a}], zoom: ${e.getZoom()}`,creator:"Mapbox GL Export Plugin",author:"(c)Mapbox, (c)OpenStreetMap"}),i.save(t)}toSVG(e,t){const n=e.toDataURL("image/png"),i=Number(this.toPixels(this.width,this.dpi).replace("px","")),s=Number(this.toPixels(this.height,this.dpi).replace("px","")),a=`
    <svg xmlns="http://www.w3.org/2000/svg" 
      xmlns:xlink="http://www.w3.org/1999/xlink" 
      version="1.1" 
      width="${i}" 
      height="${s}" 
      viewBox="0 0 ${i} ${s}" 
      xml:space="preserve">
        <image style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(0,0,0); fill-rule: nonzero; opacity: 1;"  
      xlink:href="${n}" width="${i}" height="${s}"></image>
    </svg>`,o=document.createElement("a");o.href=`data:application/xml,${encodeURIComponent(a)}`,o.download=t,o.click(),o.remove()}toPixels(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:96;return this.unit===pf.mm&&(t/=25.4),`${t*e}px`}},$te=class extends Wte{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Hh.A4,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:300,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ru.PNG,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:pf.mm,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"map",o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:x2;super(e,t,n,i,s,a,"maplibregl-marker",o)}getRenderedMap(e,t){const n=new zE.Map({container:e,style:t,center:this.map.getCenter(),zoom:this.map.getZoom(),bearing:this.map.getBearing(),pitch:this.map.getPitch(),interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,attributionControl:!1,transformRequest:this.map._requestManager._transformRequestFn});this.map.getTerrain()&&(n.setMaxPitch(85),n.setPitch(this.map.getPitch()));const i=(this.map.style.imageManager||{}).images||[];return Object.keys(i).forEach(s=>{n.addImage(s,i[s].data)}),n}renderMapPost(e){const t=this.map.getTerrain();return t&&e.setTerrain({source:t.source,exaggeration:t.exaggeration}),e}},Xte=class{constructor(e){jn(this,"controlContainer"),jn(this,"exportContainer"),jn(this,"crosshair"),jn(this,"printableArea"),jn(this,"map"),jn(this,"exportButton"),jn(this,"options",{PageSize:Hh.A4,PageOrientation:Bg.Landscape,Format:Ru.PDF,DPI:t2[300],Crosshair:!1,PrintableArea:!1,Local:"en",AllowedSizes:Object.keys(Hh),Filename:"map",markerCirclePaint:x2}),jn(this,"MAPLIB_CSS_PREFIX","maplibregl"),e&&(this.options=Object.assign(this.options,e)),this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}getTranslation(){const e=this.options.Local??"en";return Xee(e)}onAdd(e){var t;this.map=e,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add(`${this.MAPLIB_CSS_PREFIX}-ctrl`),this.controlContainer.classList.add(`${this.MAPLIB_CSS_PREFIX}-ctrl-group`),this.exportContainer=document.createElement("div"),this.exportContainer.classList.add(`${this.MAPLIB_CSS_PREFIX}-export-list`),this.exportButton=document.createElement("button"),this.exportButton.classList.add(`${this.MAPLIB_CSS_PREFIX}-ctrl-icon`),this.exportButton.classList.add(`${this.MAPLIB_CSS_PREFIX}-export-control`),this.exportButton.type="button",this.exportButton.addEventListener("click",()=>{this.exportButton.style.display="none",this.exportContainer.style.display="block",this.toggleCrosshair(!0),this.togglePrintableArea(!0)}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.exportButton),this.controlContainer.appendChild(this.exportContainer);const n=document.createElement("TABLE");n.className="print-table";const i={};(t=this.options.AllowedSizes)==null||t.forEach(m=>{Hh[m]&&(i[m]=Hh[m])});const s=this.createSelection(i,this.getTranslation().PageSize,"page-size",this.options.PageSize,(m,v)=>JSON.stringify(m[v]));n.appendChild(s);const a=this.createSelection(Bg,this.getTranslation().PageOrientation,"page-orientation",this.options.PageOrientation,(m,v)=>m[v]);n.appendChild(a);const o=this.createSelection(Ru,this.getTranslation().Format,"format-type",this.options.Format,(m,v)=>m[v]);n.appendChild(o);const A=this.createSelection(t2,this.getTranslation().DPI,"dpi-type",this.options.DPI,(m,v)=>m[v]);n.appendChild(A),this.exportContainer.appendChild(n);const f=document.createElement("button");return f.type="button",f.textContent=this.getTranslation().Generate,f.classList.add("generate-button"),f.addEventListener("click",()=>{const m=document.getElementById("mapbox-gl-export-page-size"),v=document.getElementById("mapbox-gl-export-page-orientation"),x=document.getElementById("mapbox-gl-export-format-type"),B=document.getElementById("mapbox-gl-export-dpi-type"),M=v.value;let U=JSON.parse(m.value);M===Bg.Portrait&&(U=U.reverse()),this.generateMap(e,U,Number(B.value),x.value,pf.mm,this.options.Filename)}),this.exportContainer.appendChild(f),this.controlContainer}generateMap(e,t,n,i,s,a){new $te(e,t,n,i,s,a,this.options.markerCirclePaint).generate()}createSelection(e,t,n,i,s){const a=document.createElement("label");a.textContent=t;const o=document.createElement("select");o.setAttribute("id",`mapbox-gl-export-${n}`),o.style.width="100%",Object.keys(e).forEach(v=>{const x=document.createElement("option");x.setAttribute("value",s(e,v)),x.appendChild(document.createTextNode(v)),x.setAttribute("name",n),i===e[v]&&(x.selected=!0),o.appendChild(x)}),o.addEventListener("change",()=>{this.updatePrintableArea()});const A=document.createElement("TR"),f=document.createElement("TD"),m=document.createElement("TD");return f.appendChild(a),m.appendChild(o),A.appendChild(f),A.appendChild(m),A}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.exportButton||(this.exportButton.removeEventListener("click",this.onDocumentClick),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0),this.printableArea!==void 0&&(this.printableArea.destroy(),this.printableArea=void 0),this.map=void 0)}onDocumentClick(e){this.controlContainer&&!this.controlContainer.contains(e.target)&&this.exportContainer&&this.exportButton&&(this.exportContainer.style.display="none",this.exportButton.style.display="block",this.toggleCrosshair(!1),this.togglePrintableArea(!1))}toggleCrosshair(e){this.options.Crosshair===!0&&(e===!1?this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0):(this.crosshair=new kee(this.map),this.crosshair.create()))}togglePrintableArea(e){this.options.PrintableArea===!0&&(e===!1?this.printableArea!==void 0&&(this.printableArea.destroy(),this.printableArea=void 0):(this.printableArea=new Nee(this.map),this.updatePrintableArea()))}updatePrintableArea(){if(this.printableArea===void 0)return;const e=document.getElementById("mapbox-gl-export-page-size"),t=document.getElementById("mapbox-gl-export-page-orientation").value;let n=JSON.parse(e.value);t===Bg.Portrait&&(n=n.reverse()),this.printableArea.updateArea(n[0],n[1])}};var e4=Yte,Jte=Object.prototype.hasOwnProperty;function Yte(){for(var r={},e=0;e<arguments.length;e++){var t=arguments[e];for(var n in t)Jte.call(t,n)&&(r[n]=t[n])}return r}var t4={exports:{}};(function(r,e){(function(){var t={};r.exports=t,t.simpleFilter=function(n,i){return i.filter(function(s){return t.test(n,s)})},t.test=function(n,i){return t.match(n,i)!==null},t.match=function(n,i,s){s=s||{};var a=0,o=[],A=i.length,f=0,m=0,v=s.pre||"",x=s.post||"",B=s.caseSensitive&&i||i.toLowerCase(),M;n=s.caseSensitive&&n||n.toLowerCase();for(var U=0;U<A;U++)M=i[U],B[U]===n[a]?(M=v+M+x,a+=1,m+=1+m):m=0,f+=m,o[o.length]=M;return a===n.length?(f=B===n?1/0:f,{rendered:o.join(""),score:f}):null},t.filter=function(n,i,s){return!i||i.length===0?[]:typeof n!="string"?i:(s=s||{},i.reduce(function(a,o,A,f){var m=o;s.extract&&(m=s.extract(o));var v=t.match(n,m,s);return v!=null&&(a[a.length]={string:v.rendered,score:v.score,index:A,original:o}),a},[]).sort(function(a,o){var A=o.score-a.score;return A||a.index-o.index}))}})()})(t4);var Zte=t4.exports,ha=function(r){return this.component=r,this.items=[],this.active=r.options.noInitialSelection?-1:0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,r.el.parentNode.insertBefore(this.wrapper,r.el.nextSibling),this};ha.prototype.show=function(){this.element.style.display="block"},ha.prototype.hide=function(){this.element.style.display="none"},ha.prototype.add=function(r){this.items.push(r)},ha.prototype.clear=function(){this.items=[],this.active=this.component.options.noInitialSelection?-1:0},ha.prototype.isEmpty=function(){return!this.items.length},ha.prototype.isVisible=function(){return this.element.style.display==="block"},ha.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var r=0;r<this.items.length;r++)this.drawItem(this.items[r],this.active===r);this.show()},ha.prototype.drawItem=function(r,e){var t=document.createElement("li"),n=document.createElement("a");e&&(t.className+=" active"),n.innerHTML=r.string,t.appendChild(n),this.element.appendChild(t),t.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),t.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,r)}).bind(this))},ha.prototype.handleMouseUp=function(r){this.selectingListItem=!1,this.component.value(r.original),this.clear(),this.draw()},ha.prototype.move=function(r){this.active=r,this.draw()},ha.prototype.previous=function(){this.move(this.active<=0?this.items.length-1:this.active-1)},ha.prototype.next=function(){this.move(this.active>=this.items.length-1?0:this.active+1)},ha.prototype.drawError=function(r){var e=document.createElement("li");e.innerHTML=r,this.element.appendChild(e),this.show()};var ere=ha,tre=e4,rre=Zte,nre=ere,go=function(r,e,t){return t=t||{},this.options=tre({minLength:2,limit:5,filter:!0,hideOnBlur:!0,noInitialSelection:!0},t),this.el=r,this.data=e||[],this.list=new nre(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(n){this.handleKeyUp(n.keyCode,n)}).bind(this),!1),this.el.addEventListener("keydown",(function(n){this.handleKeyDown(n)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(n){this.handlePaste(n)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};go.prototype.handleKeyUp=function(r,e){if(!(r===40||r===38||r===27||r===9)){if(r===13){this.list.items[this.list.active]&&(this.list.handleMouseUp(this.list.items[this.list.active]),e.stopPropagation());return}this.handleInputChange(this.el.value)}},go.prototype.handleKeyDown=function(r){switch(r.keyCode){case 13:this.list.active>=0&&(this.list.selectingListItem=!0);break;case 9:this.list.isEmpty()||(this.list.isVisible()&&r.preventDefault(),this.value(this.list.active>=0?this.list.items[this.list.active].original:null),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}},go.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},go.prototype.handlePaste=function(r){if(r.clipboardData)this.handleInputChange(r.clipboardData.getData("Text"));else{var e=this;setTimeout(function(){e.handleInputChange(r.target.value)},100)}},go.prototype.handleInputChange=function(r){if(this.query=this.normalize(r),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(e){for(var t=0;t<e.length&&(this.list.add(e[t]),t!==this.options.limit-1);t++);this.list.draw()}).bind(this))},go.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},go.prototype.update=function(r){this.data=r,this.handleKeyUp()},go.prototype.clear=function(){this.data=[],this.list.clear()},go.prototype.normalize=function(r){return r=r.toLowerCase(),r},go.prototype.match=function(r,e){return r.indexOf(e)>-1},go.prototype.value=function(r){if(this.selected=r,this.el.value=this.getItemValue(r||{place_name:this.query}),document.createEvent){var e=document.createEvent("HTMLEvents");e.initEvent("change",!0,!1),this.el.dispatchEvent(e)}else this.el.fireEvent("onchange")},go.prototype.getCandidates=function(r){var e={pre:"<strong>",post:"</strong>",extract:(function(n){return this.getItemValue(n)}).bind(this)},t;this.options.filter?(t=rre.filter(this.query,this.data,e),t=t.map((function(n){return{original:n.original,string:this.render(n.original,n.string)}}).bind(this))):t=this.data.map((function(n){var i=this.render(n);return{original:n,string:i}}).bind(this)),r(t)},go.prototype.getItemValue=function(r){return r},go.prototype.render=function(r,e){if(e)return e;for(var t=r.original?this.getItemValue(r.original):this.getItemValue(r),n=this.normalize(t),i=n.lastIndexOf(this.query);i>-1;){var s=i+this.query.length;t=t.slice(0,i)+"<strong>"+t.slice(i,s)+"</strong>"+t.slice(s),i=n.slice(0,i).lastIndexOf(this.query)}return t},go.prototype.renderError=function(r){this.list.drawError(r)};var ire=go,r4=ire,sre=r4;typeof window<"u"&&(window.Suggestions=r4);var ore="Expected a function",n4=NaN,are="[object Symbol]",cre=/^\s+|\s+$/g,lre=/^[-+]0x[0-9a-f]+$/i,ure=/^0b[01]+$/i,Are=/^0o[0-7]+$/i,hre=parseInt,dre=typeof Fd=="object"&&Fd&&Fd.Object===Object&&Fd,fre=typeof self=="object"&&self&&self.Object===Object&&self,pre=dre||fre||Function("return this")(),gre=Object.prototype,mre=gre.toString,yre=Math.max,_re=Math.min,B2=function(){return pre.Date.now()};function vre(r,e,t){var n,i,s,a,o,A,f=0,m=!1,v=!1,x=!0;if(typeof r!="function")throw new TypeError(ore);e=i4(e)||0,C2(t)&&(m=!!t.leading,v="maxWait"in t,s=v?yre(i4(t.maxWait)||0,e):s,x="trailing"in t?!!t.trailing:x);function B(ge){var ye=n,fe=i;return n=i=void 0,f=ge,a=r.apply(fe,ye),a}function M(ge){return f=ge,o=setTimeout(Q,e),m?B(ge):a}function U(ge){var ye=ge-A,fe=ge-f,Oe=e-ye;return v?_re(Oe,s-fe):Oe}function N(ge){var ye=ge-A,fe=ge-f;return A===void 0||ye>=e||ye<0||v&&fe>=s}function Q(){var ge=B2();if(N(ge))return q(ge);o=setTimeout(Q,U(ge))}function q(ge){return o=void 0,x&&n?B(ge):(n=i=void 0,a)}function Y(){o!==void 0&&clearTimeout(o),f=0,n=A=i=o=void 0}function te(){return o===void 0?a:q(B2())}function pe(){var ge=B2(),ye=N(ge);if(n=arguments,i=this,A=ge,ye){if(o===void 0)return M(A);if(v)return o=setTimeout(Q,e),B(A)}return o===void 0&&(o=setTimeout(Q,e)),a}return pe.cancel=Y,pe.flush=te,pe}function C2(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function bre(r){return!!r&&typeof r=="object"}function wre(r){return typeof r=="symbol"||bre(r)&&mre.call(r)==are}function i4(r){if(typeof r=="number")return r;if(wre(r))return n4;if(C2(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=C2(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(cre,"");var t=ure.test(r);return t||Are.test(r)?hre(r.slice(2),t?2:8):lre.test(r)?n4:+r}var xre=vre,E2={exports:{}},Cf=typeof Reflect=="object"?Reflect:null,s4=Cf&&typeof Cf.apply=="function"?Cf.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},by;Cf&&typeof Cf.ownKeys=="function"?by=Cf.ownKeys:Object.getOwnPropertySymbols?by=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:by=function(e){return Object.getOwnPropertyNames(e)};function Bre(r){console&&console.warn&&console.warn(r)}var o4=Number.isNaN||function(e){return e!==e};function ni(){ni.init.call(this)}E2.exports=ni,E2.exports.once=Tre,ni.EventEmitter=ni,ni.prototype._events=void 0,ni.prototype._eventsCount=0,ni.prototype._maxListeners=void 0;var a4=10;function wy(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(ni,"defaultMaxListeners",{enumerable:!0,get:function(){return a4},set:function(r){if(typeof r!="number"||r<0||o4(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");a4=r}}),ni.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ni.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||o4(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function c4(r){return r._maxListeners===void 0?ni.defaultMaxListeners:r._maxListeners}ni.prototype.getMaxListeners=function(){return c4(this)},ni.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var A=s[e];if(A===void 0)return!1;if(typeof A=="function")s4(A,this,t);else for(var f=A.length,m=d4(A,f),n=0;n<f;++n)s4(m[n],this,t);return!0};function l4(r,e,t,n){var i,s,a;if(wy(t),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),s=r._events),a=s[e]),a===void 0)a=s[e]=t,++r._eventsCount;else if(typeof a=="function"?a=s[e]=n?[t,a]:[a,t]:n?a.unshift(t):a.push(t),i=c4(r),i>0&&a.length>i&&!a.warned){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=r,o.type=e,o.count=a.length,Bre(o)}return r}ni.prototype.addListener=function(e,t){return l4(this,e,t,!1)},ni.prototype.on=ni.prototype.addListener,ni.prototype.prependListener=function(e,t){return l4(this,e,t,!0)};function Cre(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u4(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=Cre.bind(n);return i.listener=t,n.wrapFn=i,i}ni.prototype.once=function(e,t){return wy(t),this.on(e,u4(this,e,t)),this},ni.prototype.prependOnceListener=function(e,t){return wy(t),this.prependListener(e,u4(this,e,t)),this},ni.prototype.removeListener=function(e,t){var n,i,s,a,o;if(wy(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(s=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,s=a;break}if(s<0)return this;s===0?n.shift():Ere(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,o||t)}return this},ni.prototype.off=ni.prototype.removeListener,ni.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),a;for(i=0;i<s.length;++i)a=s[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function A4(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?Sre(i):d4(i,i.length)}ni.prototype.listeners=function(e){return A4(this,e,!0)},ni.prototype.rawListeners=function(e){return A4(this,e,!1)},ni.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):h4.call(r,e)},ni.prototype.listenerCount=h4;function h4(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}ni.prototype.eventNames=function(){return this._eventsCount>0?by(this._events):[]};function d4(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function Ere(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Sre(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Tre(r,e){return new Promise(function(t,n){function i(a){r.removeListener(e,s),n(a)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}f4(r,e,s,{once:!0}),e!=="error"&&Ire(r,i,{once:!0})})}function Ire(r,e,t){typeof r.on=="function"&&f4(r,"error",e,t)}function f4(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(s){n.once&&r.removeEventListener(e,i),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var p4=E2.exports,Lre={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}},Fre={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"",ja:"",lv:"Meklt",pt:"Procurar",sr:"",zh:"",cs:"Vyhledvn",hu:"Keress",ka:"",nb:"Ske",sk:"Vyhadvanie",th:"",fi:"Hae",is:"Leita",ko:"",pl:"Szukaj",sl:"Iskanje",fa:"",ru:""},Mre={placeholder:Fre},g4={exports:{}};(function(r){(function(e,t,n){r.exports?r.exports=n():e[t]=n()})(Fd,"subtag",function(){var e="",t=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function n(A){return A.match(t)||[]}function i(A){return n(A).filter(function(f,m){return f&&m})}function s(A){return A=n(A),{language:A[1]||e,extlang:A[2]||e,script:A[3]||e,region:A[4]||e}}function a(A,f,m){Object.defineProperty(A,f,{value:m,enumerable:!0})}function o(A,f,m){function v(x){return n(x)[A]||e}a(v,"pattern",f),a(s,m,v)}return o(1,/^[a-zA-Z]{2,3}$/,"language"),o(2,/^[a-zA-Z]{3}$/,"extlang"),o(3,/^[a-zA-Z]{4}$/,"script"),o(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),a(s,"split",i),s})})(g4);var Pre=g4.exports,Ure=sre,Rre=xre,Da=e4,Ore=p4.EventEmitter,m4=Lre,Dre=Mre,kre=Pre;function y4(r,e){this._eventEmitter=new Ore,this.options=Da({},this.options,e),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geocoderApi=r}y4.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,showResultsWhileTyping:!1,minLength:2,reverseGeocode:!1,limit:5,enableEventLogging:!0,marker:!0,popup:!1,maplibregl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,getItemValue:function(r){return r.text!==void 0?r.text:r.place_name},render:function(r){if(r.geometry){var o=r.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--result maplibregl-ctrl-geocoder--result"><svg class="mapboxgl-ctrl-geocoder--result-icon maplibre-ctrl-geocoder--result-icon" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36571 0 0 5.38676 0 12.0471C0 21.0824 12 32 12 32C12 32 24 21.0824 24 12.0471C24 5.38676 18.6343 0 12 0ZM12 16.3496C9.63428 16.3496 7.71429 14.4221 7.71429 12.0471C7.71429 9.67207 9.63428 7.74454 12 7.74454C14.3657 7.74454 16.2857 9.67207 16.2857 12.0471C16.2857 14.4221 14.3657 16.3496 12 16.3496Z" fill="#687078"/></svg><div><div class="mapboxgl-ctrl-geocoder--result-title maplibregl-ctrl-geocoder--result-title">'+o[0]+'</div><div class="mapboxgl-ctrl-geocoder--result-address maplibregl-ctrl-geocoder--result-address">'+o.splice(1,o.length).join(",")+"</div></div></div>"}else{var e=r.text,t=e.toLowerCase().indexOf(this.query.toLowerCase()),n=this.query.length,i=e.substring(0,t),s=e.substring(t,t+n),a=e.substring(t+n);return'<div class="mapboxgl-ctrl-geocoder--suggestion maplibregl-ctrl-geocoder--suggestion"><svg class="mapboxgl-ctrl-geocoder--suggestion-icon maplibre-ctrl-geocoder--suggestion-icon" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22.8702 20.1258H21.4248L20.9125 19.6318C22.7055 17.546 23.785 14.8382 23.785 11.8925C23.785 5.32419 18.4608 0 11.8925 0C5.32419 0 0 5.32419 0 11.8925C0 18.4608 5.32419 23.785 11.8925 23.785C14.8382 23.785 17.546 22.7055 19.6318 20.9125L20.1258 21.4248V22.8702L29.2739 32L32 29.2739L22.8702 20.1258ZM11.8925 20.1258C7.33676 20.1258 3.65923 16.4483 3.65923 11.8925C3.65923 7.33676 7.33676 3.65923 11.8925 3.65923C16.4483 3.65923 20.1258 7.33676 20.1258 11.8925C20.1258 16.4483 16.4483 20.1258 11.8925 20.1258Z" fill="#687078"/></svg><div class="mapboxgl-ctrl-geocoder--suggestion-info maplibregl-ctrl-geocoder--suggestion-info"><div class="mapboxgl-ctrl-geocoder--suggestion-title maplibregl-ctrl-geocoder--suggestion-title">'+i+'<span class="mapboxgl-ctrl-geocoder--suggestion-match maplibregl-ctrl-geocoder--suggestion-match">'+s+"</span>"+a+"</div></div></div>"}},popupRender:function(r){var e=r.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion maplibre-ctrl-geocoder--suggestion popup-suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title maplibre-ctrl-geocoder--suggestion-title popup-suggestion-title">'+e[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address maplibre-ctrl-geocoder--suggestion-address popup-suggestion-address">'+e.splice(1,e.length).join(",")+"</div></div>"},showResultMarkers:!0,debounceSearch:200},addTo:function(r){function e(n,i){if(!document.body.contains(i))throw new Error("Element provided to #addTo() exists, but is not in the DOM");var s=n.onAdd();i.appendChild(s)}if(r._controlContainer)r.addControl(this);else if(r instanceof HTMLElement)e(this,r);else if(typeof r=="string"){var t=document.querySelectorAll(r);if(t.length===0)throw new Error("Element ",r,"not found.");if(t.length>1)throw new Error("Geocoder can only be added to a single html element");e(this,t[0])}else throw new Error("Error: addTo must be a maplibre-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(r){if(r&&typeof r!="string"&&(this._map=r),this.setLanguage(),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this);var e=this.container=document.createElement("div");e.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl";var t=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input maplibregl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",Rre(this._onKeyDown,this.options.debounceSearch)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton);var n=document.createElement("div");n.classList.add("mapboxgl-ctrl-geocoder--pin-right","maplibregl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button maplibregl-ctrl-geocoder--button";var i=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');return this._clearEl.appendChild(i),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),n.appendChild(this._clearEl),n.appendChild(this._loadingEl),e.appendChild(t),e.appendChild(this._inputEl),e.appendChild(n),this._typeahead=new Ure(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit,noInitialSelection:!0}),this.setRenderFunction(this.options.render),this._typeahead.getItemValue=this.options.getItemValue,this.mapMarker=null,this.resultMarkers=[],this._handleMarker=this._handleMarker.bind(this),this._handleResultMarkers=this._handleResultMarkers.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._maplibregl=this.options.maplibregl,!this._maplibregl&&this.options.marker&&(console.error("No maplibregl detected in options. Map markers are disabled. Please set options.maplibregl."),this.options.marker=!1)),e},createIcon:function(r,e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");if(t.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+r+" maplibregl-ctrl-geocoder--icon maplibregl-ctrl-geocoder--icon-"+r),t.setAttribute("viewBox","0 0 18 18"),t.setAttribute("xml:space","preserve"),t.setAttribute("width",18),t.setAttribute("height",18),"innerHTML"in t)t.innerHTML=e;else{var n=document.createElement("div");n.innerHTML="<svg>"+e.valueOf().toString()+"</svg>";var i=n.firstChild,s=i.firstChild;t.appendChild(s)}return t},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_onPaste:function(r){var e=(r.clipboardData||window.clipboardData).getData("text");e.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(e)},_onKeyDown:function(r){var e=27,t=9;if(r.keyCode===e&&this.options.clearAndBlurOnEsc)return this._clear(r),this._inputEl.blur();var n=r.target&&r.target.shadowRoot?r.target.shadowRoot.activeElement:r.target,i=n?n.value:"";if(!i)return this.fresh=!0,r.keyCode!==t&&this.clear(r),this._clearEl.style.display="none";if(!(r.metaKey||[t,e,37,39,38,40].indexOf(r.keyCode)!==-1)){if(r.keyCode===13)if(!this.options.showResultsWhileTyping)this._typeahead.selected||this._geocode(n.value);else{this._typeahead.selected==null&&this.geocoderApi.getSuggestions?this._geocode(n.value,!0):this._typeahead.selected==null&&this.options.showResultMarkers&&this._fitBoundsForMarkers();return}n.value.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(n.value)}},_showButton:function(){this._inputEl.value.length>0&&(this._clearEl.style.display="block")},_hideButton:function(){this._typeahead.selected&&(this._clearEl.style.display="none")},_onBlur:function(r){this.options.clearOnBlur&&this._clearOnBlur(r),this.options.collapsed&&this._collapse()},_onChange:function(){var r=this._typeahead.selected;if(r&&!r.geometry)r.placeId?this._geocode(r.placeId,!0,!0):this._geocode(r.text,!0);else if(r&&JSON.stringify(r)!==this.lastSelected){if(this._clearEl.style.display="none",this.options.flyTo){var e;if(this._removeResultMarkers(),r.properties&&m4[r.properties.short_code])e=Da({},this.options.flyTo),this._map&&this._map.fitBounds(m4[r.properties.short_code].bbox,e);else if(r.bbox){var t=r.bbox;e=Da({},this.options.flyTo),this._map&&this._map.fitBounds([[t[0],t[1]],[t[2],t[3]]],e)}else{var n={zoom:this.options.zoom};e=Da({},n,this.options.flyTo),r.center?e.center=r.center:r.geometry&&r.geometry.type&&r.geometry.type==="Point"&&r.geometry.coordinates&&(e.center=r.geometry.coordinates),this._map&&this._map.flyTo(e)}}this.options.marker&&this._maplibregl&&this._handleMarker(r),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(r),this._typeahead.selected=null,this._eventEmitter.emit("result",{result:r})}},_getConfigForRequest:function(){var r=["bbox","limit","proximity","countries","types","language","reverseMode"],e=this,t=r.reduce(function(n,i){return e.options[i]&&(["countries","types","language"].indexOf(i)>-1?n[i]=e.options[i].split(/[\s,]+/):n[i]=e.options[i],i==="proximity"&&e.options[i]&&typeof e.options[i].longitude=="number"&&typeof e.options[i].latitude=="number"&&(n[i]=[e.options[i].longitude,e.options[i].latitude])),n},{});return t},_geocode:function(r,e,t){this._loadingEl.style.display="block",this._eventEmitter.emit("loading",{query:r}),this.inputString=r;var n=null,i=this._getConfigForRequest(),s;if(this.options.localGeocoderOnly)s=Promise.resolve();else if(this.options.reverseGeocode&&/(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/.test(r)){var a=r.split(/[\s(,)?]+/).map(function(f){return parseFloat(f,10)}).reverse();i.types&&i.types[0],i=Da(i,{query:a,limit:1}),"proximity"in i&&delete i.proximity,s=this.geocoderApi.reverseGeocode(i)}else i=Da(i,{query:r}),this.geocoderApi.getSuggestions?e?this.geocoderApi.searchByPlaceId&&t?s=this.geocoderApi.searchByPlaceId(i):s=this.geocoderApi.forwardGeocode(i):s=this.geocoderApi.getSuggestions(i):s=this.geocoderApi.forwardGeocode(i);var o=[];this.options.localGeocoder&&(o=this.options.localGeocoder(r),o||(o=[]));var A=[];return s.catch((function(f){n=f}).bind(this)).then((function(f){this._loadingEl.style.display="none";var m={};return f?m=f:m={type:"FeatureCollection",features:[]},m.config=i,this.fresh&&(this.fresh=!1),m.features=m.features?o.concat(m.features):o,this.options.externalGeocoder?(A=this.options.externalGeocoder(r,m.features,i)||[],A.then(function(v){return m.features=m.features?v.concat(m.features):v,m},function(){return m})):m}).bind(this)).then((function(f){if(n)throw n;this.options.filter&&f.features.length&&(f.features=f.features.filter(this.options.filter));var m=[];f.suggestions?m=f.suggestions:f.place?m=[f.place]:m=f.features,m.length?(this._clearEl.style.display="block",this._typeahead.update(m),(!this.options.showResultsWhileTyping||e)&&this.options.showResultMarkers&&(f.features.length>0||f.place)&&this._fitBoundsForMarkers(),this._eventEmitter.emit("results",f)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",f))}).bind(this)).catch((function(f){this._loadingEl.style.display="none",o.length&&this.options.localGeocoder||A.length&&this.options.externalGeocoder?(this._clearEl.style.display="block",this._typeahead.update(o)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:o}),this._eventEmitter.emit("error",{error:f})}).bind(this)),s},_clear:function(r){r&&r.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._clearEl.style.display="none",this._removeMarker(),this._removeResultMarkers(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(r){this._clear(r),this._inputEl.focus()},_clearOnBlur:function(r){var e=this;r.relatedTarget&&e._clear(r)},_onQueryResult:function(r){var e=r;if(e.features.length){var t=e.features[0];this._typeahead.selected=t,this._inputEl.value=t.place_name,this._onChange()}},_updateProximity:function(){if(this._map)if(this._map.getZoom()>9){var r=this._map.getCenter().wrap();this.setProximity({longitude:r.lng,latitude:r.lat})}else this.setProximity(null)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed","maplibregl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed","maplibregl-ctrl-geocoder--collapsed")},query:function(r){return this._geocode(r).then(this._onQueryResult),this},_renderError:function(){var r="<div class='mapbox-gl-geocoder--error maplibre-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(r)},_renderNoResults:function(){var r="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results maplibre-gl-geocoder--error maplibre-gl-geocoder--no-results'>No results found</div>";this._renderMessage(r)},_renderMessage:function(r){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(r)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var r=this.options.language.split(",")[0],e=kre.language(r),t=Dre.placeholder[e];if(t)return t}return"Search"},_fitBoundsForMarkers:function(){if(!(this._typeahead.data.length<1)){var r=this._typeahead.data.filter(function(i){return typeof i!="string"}).slice(0,this.options.limit);if(this._clearEl.style.display="none",this.options.flyTo&&this._maplibregl&&this._map){var e={padding:100},t=Da({},e,this.options.flyTo),n=new this._maplibregl.LngLatBounds;r.forEach(function(i){n.extend(i.geometry.coordinates)}),this._map.fitBounds(n.toArray(),t)}return r.length>0&&this._maplibregl&&this._handleResultMarkers(r),this}},setInput:function(r){return this._inputEl.value=r,this._typeahead.selected=null,this._typeahead.clear(),r.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(r),this},setProximity:function(r){return this.options.proximity=r,this},getProximity:function(){return this.options.proximity},setRenderFunction:function(r){return r&&typeof r=="function"&&(this._typeahead.render=r),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(r){var e=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=r||this.options.language||e,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(r){return this.options.zoom=r,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(r){return this.options.flyTo=r,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(r){return this.placeholder=r||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(r){return this.options.bbox=r,this},getCountries:function(){return this.options.countries},setCountries:function(r){return this.options.countries=r,this},getTypes:function(){return this.options.types},setTypes:function(r){return this.options.types=r,this},getMinLength:function(){return this.options.minLength},setMinLength:function(r){return this.options.minLength=r,this._typeahead&&(this._typeahead.options.minLength=r),this},getLimit:function(){return this.options.limit},setLimit:function(r){return this.options.limit=r,this._typeahead&&(this._typeahead.options.limit=r),this},getFilter:function(){return this.options.filter},setFilter:function(r){return this.options.filter=r,this},setGeocoderApi:function(r){return this.geocoderApi=r,this},getGeocoderApi:function(){return this.geocoderApi},_handleMarker:function(r){if(this._map){this._removeMarker();var e={color:"#4668F2"},t=Da({},e,this.options.marker);this.mapMarker=new this._maplibregl.Marker(t);var n;if(this.options.popup){var i={},s=Da({},i,this.options.popup);n=new this._maplibregl.Popup(s).setHTML(this.options.popupRender(r))}return r.center?(this.mapMarker.setLngLat(r.center).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(n)):r.geometry&&r.geometry.type&&r.geometry.type==="Point"&&r.geometry.coordinates&&(this.mapMarker.setLngLat(r.geometry.coordinates).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(n)),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},_handleResultMarkers:function(r){if(this._map){this._removeResultMarkers();var e={color:"#4668F2"},t=Da({},e,this.options.showResultMarkers);return r.forEach((function(n){if(this.options.showResultMarkers&&this.options.showResultMarkers.element){var i=this.options.showResultMarkers.element.cloneNode(!0);t=Da(t,{element:i})}var s=new this._maplibregl.Marker(Da({},t,{element:i})),a;if(this.options.popup){var o={},A=Da({},o,this.options.popup);a=new this._maplibregl.Popup(A).setHTML(this.options.popupRender(n))}n.center?(s.setLngLat(n.center).addTo(this._map),this.options.popup&&s.setPopup(a)):n.geometry&&n.geometry.type&&n.geometry.type==="Point"&&n.geometry.coordinates&&(s.setLngLat(n.geometry.coordinates).addTo(this._map),this.options.popup&&s.setPopup(a)),this.resultMarkers.push(s)}).bind(this)),this}},_removeResultMarkers:function(){this.resultMarkers&&this.resultMarkers.length>0&&(this.resultMarkers.forEach(function(r){r.remove()}),this.resultMarkers=[])},on:function(r,e){return this._eventEmitter.on(r,e),this},off:function(r,e){return this._eventEmitter.removeListener(r,e),this}};var Nre=y4;const Qre=Bp(Nre);class Hre{constructor(e){this.options=e}onAdd(e){let t=this.options.defaultOptions;return this._map=e,this._img1=document.createElement("img"),this._img1.className="maplibregl-ctrl",this._img1.src=this.options.color?t.logoIcgcOptions.logoUrlColor:t.logoIcgcOptions.logoUrlWhite,this._img1.width=t.logoIcgcOptions.logoWidth,this._img1.title=t.logoIcgcOptions.logoTitle,this.link1=document.createElement("a"),this.link1.href=t.logoIcgcOptions.logoLink,this.link1.target="_blank",this.link1.appendChild(this._img1),this._container1=document.createElement("div"),this._container1.className="maplibregl-ctrl",this._container1.style.width=`${t.logoIcgcOptions.logoWidth}px`,this._container1.appendChild(this.link1),this._img2=document.createElement("img"),this._img2.className="maplibregl-ctrl",this._img2.src=this.options.color?t.logoGencatOptions.logoUrlColor:t.logoGencatOptions.logoUrlWhite,this._img2.width=t.logoGencatOptions.logoWidth,this._img2.title=t.logoGencatOptions.logoTitle,this.link2=document.createElement("a"),this.link2.href=t.logoGencatOptions.logoLink,this.link2.target="_blank",this.link2.appendChild(this._img2),this._container2=document.createElement("div"),this._container2.className="maplibregl-ctrl",this._container2.style.width=`${t.logoGencatOptions.logoWidth}px`,this._container2.appendChild(this.link2),this._mainContainer=document.createElement("div"),this._mainContainer.className="divLogos",this._mainContainer.style="display: flex",this._mainContainer.appendChild(this._container1),this._mainContainer.appendChild(this._container2),this._mainContainer}}var Ef=_4.prototype,S2="WGS 84";function _4(r){r!==void 0&&(S2=r),this.setEllipsoid(S2)}Ef.convertLatLngToUtm=function(r,e,t){var n;if(this.status)return"No ecclipsoid data associated with unknown datum: "+S2;if(!Number.isInteger(t))return"Precision is not integer number.";r=parseFloat(r),e=parseFloat(e);var i=e,s=this.toRadians(r),a=this.toRadians(i);i>=8&&i<=13&&r>54.5&&r<58||r>=56&&r<64&&i>=3&&i<12?n=32:(n=(i+180)/6+1,r>=72&&r<84&&(i>=0&&i<9?n=31:i>=9&&i<21?n=33:i>=21&&i<33?n=35:i>=33&&i<42&&(n=37))),n=parseInt(n);var o=(n-1)*6-180+3,A=this.toRadians(o),f=this.getUtmLetterDesignator(r),m=this.eccSquared/(1-this.eccSquared),v=this.a/Math.sqrt(1-this.eccSquared*Math.sin(s)*Math.sin(s)),x=Math.tan(s)*Math.tan(s),B=m*Math.cos(s)*Math.cos(s),M=Math.cos(s)*(a-A),U=this.a*((1-this.eccSquared/4-3*this.eccSquared*this.eccSquared/64-5*this.eccSquared*this.eccSquared*this.eccSquared/256)*s-(3*this.eccSquared/8+3*this.eccSquared*this.eccSquared/32+45*this.eccSquared*this.eccSquared*this.eccSquared/1024)*Math.sin(2*s)+(15*this.eccSquared*this.eccSquared/256+45*this.eccSquared*this.eccSquared*this.eccSquared/1024)*Math.sin(4*s)-35*this.eccSquared*this.eccSquared*this.eccSquared/3072*Math.sin(6*s)),N=parseFloat(.9996*v*(M+(1-x+B)*M*M*M/6+(5-18*x+x*x+72*B-58*m)*M*M*M*M*M/120)+5e5),Q=parseFloat(.9996*(U+v*Math.tan(s)*(M*M/2+(5-x+9*B+4*B*B)*M*M*M*M/24+(61-58*x+x*x+600*B-330*m)*M*M*M*M*M*M/720)));return r<0&&(Q+=1e7),Q=v4(Q,t),N=v4(N,t),{Easting:N,Northing:Q,ZoneNumber:parseInt(n),ZoneLetter:f}},Ef.convertUtmToLatLng=function(r,e,t,n){var i=(1-Math.sqrt(1-this.eccSquared))/(1+Math.sqrt(1-this.eccSquared)),s=r-5e5,a=e,o=t,A=n;if(r===void 0)return"Please pass the UTMEasting!";if(e===void 0)return"Please pass the UTMNorthing!";if(t===void 0)return"Please pass the UTMZoneNumber!";if(n===void 0)return"Please pass the UTMZoneLetter!";["N","P","Q","R","S","T","U","V","W","X","Y","Z"].indexOf(A)!==-1||(a-=1e7);var f=(o-1)*6-180+3,m=this.eccSquared/(1-this.eccSquared),v=a/.9996,x=v/(this.a*(1-this.eccSquared/4-3*this.eccSquared*this.eccSquared/64-5*this.eccSquared*this.eccSquared*this.eccSquared/256)),B=x+(3*i/2-27*i*i*i/32)*Math.sin(2*x)+(21*i*i/16-55*i*i*i*i/32)*Math.sin(4*x)+151*i*i*i/96*Math.sin(6*x);this.toDegrees(B);var M=this.a/Math.sqrt(1-this.eccSquared*Math.sin(B)*Math.sin(B)),U=Math.tan(B)*Math.tan(B),N=m*Math.cos(B)*Math.cos(B),Q=this.a*(1-this.eccSquared)/Math.pow(1-this.eccSquared*Math.sin(B)*Math.sin(B),1.5),q=s/(M*.9996),Y=B-M*Math.tan(B)/Q*(q*q/2-(5+3*U+10*N-4*N*N-9*m)*q*q*q*q/24+(61+90*U+298*N+45*U*U-252*m-3*N*N)*q*q*q*q*q*q/720);Y=this.toDegrees(Y);var te=(q-(1+2*U+N)*q*q*q/6+(5-2*N+28*U-3*N*N+8*m+24*U*U)*q*q*q*q*q/120)/Math.cos(B);return te=f+this.toDegrees(te),{lat:Y,lng:te}},Ef.getUtmLetterDesignator=function(r){return r=parseFloat(r),84>=r&&r>=72?"X":72>r&&r>=64?"W":64>r&&r>=56?"V":56>r&&r>=48?"U":48>r&&r>=40?"T":40>r&&r>=32?"S":32>r&&r>=24?"R":24>r&&r>=16?"Q":16>r&&r>=8?"P":8>r&&r>=0?"N":0>r&&r>=-8?"M":-8>r&&r>=-16?"L":-16>r&&r>=-24?"K":-24>r&&r>=-32?"J":-32>r&&r>=-40?"H":-40>r&&r>=-48?"G":-48>r&&r>=-56?"F":-56>r&&r>=-64?"E":-64>r&&r>=-72?"D":-72>r&&r>=-80?"C":"Z"},Ef.setEllipsoid=function(r){switch(r){case"Airy":this.a=6377563,this.eccSquared=.00667054;break;case"Australian National":this.a=6378160,this.eccSquared=.006694542;break;case"Bessel 1841":this.a=6377397,this.eccSquared=.006674372;break;case"Bessel 1841 Nambia":this.a=6377484,this.eccSquared=.006674372;break;case"Clarke 1866":this.a=6378206,this.eccSquared=.006768658;break;case"Clarke 1880":this.a=6378249,this.eccSquared=.006803511;break;case"Everest":this.a=6377276,this.eccSquared=.006637847;break;case"Fischer 1960 Mercury":this.a=6378166,this.eccSquared=.006693422;break;case"Fischer 1968":this.a=6378150,this.eccSquared=.006693422;break;case"GRS 1967":this.a=6378160,this.eccSquared=.006694605;break;case"GRS 1980":this.a=6378137,this.eccSquared=.00669438;break;case"Helmert 1906":this.a=6378200,this.eccSquared=.006693422;break;case"Hough":this.a=6378270,this.eccSquared=.00672267;break;case"International":this.a=6378388,this.eccSquared=.00672267;break;case"Krassovsky":this.a=6378245,this.eccSquared=.006693422;break;case"Modified Airy":this.a=6377340,this.eccSquared=.00667054;break;case"Modified Everest":this.a=6377304,this.eccSquared=.006637847;break;case"Modified Fischer 1960":this.a=6378155,this.eccSquared=.006693422;break;case"South American 1969":this.a=6378160,this.eccSquared=.006694542;break;case"WGS 60":this.a=6378165,this.eccSquared=.006693422;break;case"WGS 66":this.a=6378145,this.eccSquared=.006694542;break;case"WGS 72":this.a=6378135,this.eccSquared=.006694318;break;case"ED50":this.a=6378388,this.eccSquared=.00672267;break;case"WGS 84":case"EUREF89":case"ETRS89":this.a=6378137,this.eccSquared=.00669438;break;default:this.status=!0}},Ef.toDegrees=function(r){return r/Math.PI*180},Ef.toRadians=function(r){return r*Math.PI/180};function v4(r,e){var t=Math.pow(10,e);return Math.round(r*t)/t}var zre=_4;const Gre=Bp(zre);class Vre{constructor(e){this.options=e||{},this.options.utm=this.options.hasOwnProperty("utm")?this.options.utm:!0,this.options.lonlat=this.options.hasOwnProperty("lonlat")?this.options.lonlat:!0}onAdd(e){const t=new Gre;return this._map=e,this._container=document.createElement("div"),this._container.className="maplibregl-ctrl coordControl",this._container.style.width=`${this.options.width||"225px"}`,this._map.on("mousemove",n=>{const i=n.lngLat.lat,s=n.lngLat.lng;let a="",o="";const A=t.convertLatLngToUtm(i,s,2),f=i>0?"N":"S";this.options.utm&&(a=`ETRS89 UTM ${A.ZoneNumber}${f} X:<b> ${A.Easting}</b> Y:<b> ${A.Northing}</b> <br>`),this.options.lonlat&&(o=`WGS 84 Lon:<b> ${s.toFixed(5)}</b>  Lat:<b> ${i.toFixed(5)}</b>`);const m=`${a}${o}`;this._container.innerHTML=m}),this._container}_lookUTM31(e,t){var n=0,i=0,s=6,a=84;return e>=n&&e<=s&&t>=i&&t<=a}onRemove(){this._container.parentNode.removeChild(this._container),this._map=void 0}}const T2={defaultOptions:{limitsUrl:"https://tilemaps.icgc.cat/vt/limits-tilejsonV3.json",geocoder:{peliasUrl1:"https://eines.icgc.cat/geocodificador/autocompletar?text=",peliasUrl2:"&layers=topo1%2Ctopo2%2Caddress&size=5"},mapOptions:{container:"map",center:{0:1.537786,1:41.837539},zoom:7.5,bearing:0,pitch:0,hash:!1,style:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_gris.json",maxZoom:18,maxPitch:85},logoIcgcOptions:{logoUrlColor:"https://tilemaps.icgc.cat/cdn/logos/icgc_logo_color.png",logoUrlWhite:"https://tilemaps.icgc.cat/cdn/logos/icgc_logo_blanc.svg",logoLink:"https://www.icgc.cat",logoTitle:"Institut Cartogrfic i Geolgic de Catalunya",logoWidth:100},logoGencatOptions:{logoUrlColor:"https://tilemaps.icgc.cat/cdn/logos/gencat_logo_color.png",logoUrlWhite:"https://tilemaps.icgc.cat/cdn/logos/gencat_logo_blanc.png",logoLink:"https://web.gencat.cat/",logoTitle:"Generalitat de Catalunya",logoWidth:100},map3dOptions:{spaceErrorFactor:2,exaggeration:1,zfactor:48,minZoomRange:15.5,maxZoomRange:22,urlTilesetCities:"https://tilemaps.icgc.cat/vector/3dtiles/ciutats/v1/tilesetV1.0.json",layerIdOrder:"place-isolated",sourceLayerFilterId:"place",minZoomFilter:14,layerId3d:"edificisMapboxLayer",terrainSource:"ICGC5M",style3dName:"orto3d",imageIcon:"https://tilemaps.icgc.cat/cdn/images/stick.png"},baseStyles:[{key:"TOPO",url:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_estandard.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_estandard.png"},{key:"ORTO",url:"https://geoserveis.icgc.cat/contextmaps/icgc_orto_estandard.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_orto_hibrida.png"},{key:"ORTO3D",url:"https://tilemaps.icgc.cat/cdn/styles/icgc_orto_3d.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_orto_hibrida.png"},{key:"ADMIN",url:"https://geoserveis.icgc.cat/contextmaps/icgc_delimitacio_limits_administratius.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_delimitacio_limits_administratius.png"},{key:"DARK",url:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_fosc.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_base_fosc.png"},{key:"LIGHT",url:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_gris.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_base_gris.png"},{key:"GEOLOGY",url:"https://geoserveis.icgc.cat/contextmaps/icgc_geologic_informacio.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_geologic_informacio.png"}],urlTerrainICGC:[{name:"ICGC5M",url:"https://tilemaps.icgc.cat/tileserver/tileserver/terreny-5m-30m-rgb-extent/{z}/{x}/{y}.png"},{name:"WORLD30M",url:"https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png",encoding:"terrarium"}],ortoLayersICGC:[{name:"ortofotoColorProvisional",key:"ortofoto_color_provisional",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_provisional"},{name:"ortofotoColor2022",key:"ortofoto_color_2022",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2022"},{name:"ortofotoColor2021",key:"ortofoto_color_2021",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2021"},{name:"ortofotoColor2020",key:"ortofoto_color_2020",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2020"},{name:"ortofotoColor2019",key:"ortofoto_color_2019",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2019"},{name:"ortofotoColor2018",key:"ortofoto_color_2018",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2018"},{name:"ortofotoColor2017",key:"ortofoto_color_2017",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2017"},{name:"ortofotoColor2016",key:"ortofoto_color_2016",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2016"},{name:"ortofotoColor2015",key:"ortofoto_color_2015",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2015"},{name:"ortofotoColor2014",key:"ortofoto_color_2014",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2014"},{name:"ortofotoColor2013",key:"ortofoto_color_2013",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2013"},{name:"ortofotoColor2012",key:"ortofoto_color_2012",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2012"},{name:"ortofotoColor2011",key:"ortofoto_color_2011",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2011"},{name:"ortofotoColor2010",key:"ortofoto_color_2010",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2010"},{name:"ortofotoColor2009",key:"ortofoto_color_2009",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2009"},{name:"ortofotoColor2008",key:"ortofoto_color_2008",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2008"},{name:"ortofotoColor20062007",key:"ortofoto_color_2006-2007",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2006-2007"},{name:"ortofotoColor20042005",key:"ortofoto_color_2004-2005",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2004-2005"},{name:"ortofotoColor20002003",key:"ortofoto_color_2000-2003",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2000-2003"},{name:"ortofotoBlancINegre1998",key:"ortofoto_blanc_i_negre_1998",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1998"},{name:"ortofotoBlancINegre19941997",key:"ortofoto_blanc_i_negre_1994-1997",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1994-1997"},{name:"ortofotoColor1993",key:"ortofoto_color_1993",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_1993"},{name:"ortofotoBlancINegre19831992",key:"ortofoto_blanc_i_negre_1983-1992",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1983-1992"},{name:"ortofotoBlancINegre19701977",key:"ortofoto_blanc_i_negre_1970-1977",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1970-1977"},{name:"ortofotoBlancINegre1956",key:"ortofoto_blanc_i_negre_1956",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1956"},{name:"ortofotoBlancINegre1945",key:"ortofoto_blanc_i_negre_1945",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1945"},{name:"ortofotoColorSerieAnual",key:"ortofoto_color_serie_anual",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_serie_anual"},{name:"ortofotoInfraroigProvisional",key:"ortofoto_infraroig_provisional",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_provisional"},{name:"ortofotoInfraroig2022",key:"ortofoto_infraroig_2022",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2022"},{name:"ortofotoInfraroig2021",key:"ortofoto_infraroig_2021",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2021"},{name:"ortofotoInfraroig2020",key:"ortofoto_infraroig_2020",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2020"},{name:"ortofotoInfraroig2019",key:"ortofoto_infraroig_2019",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2019"},{name:"ortofotoInfraroig2018",key:"ortofoto_infraroig_2018",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2018"},{name:"ortofotoInfraroig2017",key:"ortofoto_infraroig_2017",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2017"},{name:"ortofotoInfraroig2016",key:"ortofoto_infraroig_2016",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2016"},{name:"ortofotoInfraroig2015",key:"ortofoto_infraroig_2015",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2015"},{name:"ortofotoInfraroig2014",key:"ortofoto_infraroig_2014",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2014"},{name:"ortofotoInfraroig2013",key:"ortofoto_infraroig_2013",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2013"},{name:"ortofotoInfraroig2012",key:"ortofoto_infraroig_2012",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2012"},{name:"ortofotoInfraroig2011",key:"ortofoto_infraroig_2011",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2011"},{name:"ortofotoInfraroig2010",key:"ortofoto_infraroig_2010",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2010"},{name:"ortofotoInfraroig2009",key:"ortofoto_infraroig_2009",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2009"},{name:"ortofotoInfraroig2008",key:"ortofoto_infraroig_2008",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2008"},{name:"ortofotoInfraroig20062007",key:"ortofoto_infraroig_2006-2007",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2006-2007"},{name:"ortofotoInfraroig19961997",key:"ortofoto_infraroig_1996-1997",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_1996-1997"},{name:"ortofotoInfraroigSerieAnual",key:"ortofoto_infraroig_serie_anual",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_serie_anual"}],vectorLayersICGC:[{name:"agrupacionsCensals2015",key:"agrupacions_censals_2015"},{name:"agrupacionsCensals2016",key:"agrupacions_censals_2016"},{name:"agrupacionsCensals2017",key:"agrupacions_censals_2017"},{name:"agrupacionsCensals2018",key:"agrupacions_censals_2018"},{name:"agrupacionsCensals2019",key:"agrupacions_censals_2019"},{name:"agrupacionsCensals2020",key:"agrupacions_censals_2020"},{name:"agrupacionsCensals2021",key:"agrupacions_censals_2021"},{name:"agrupacionsCensalsVigent",key:"agrupacions_censals_vigent"},{name:"agrupacionsCensalsVigentText",key:"agrupacions_censals_vigent_text"},{name:"areesBasiquesPolicials2019",key:"arees_basiques_policials_2019"},{name:"areesBasiquesPolicials2020",key:"arees_basiques_policials_2020"},{name:"areesBasiquesPolicials2022",key:"arees_basiques_policials_2022"},{name:"areesBasiquesPolicialsVigent",key:"arees_basiques_policials_vigent"},{name:"areesBasiquesPolicialsVigentText",key:"arees_basiques_policials_vigent_text"},{name:"areesBasiquesSalutVigent",key:"arees_basiques_salut_vigent"},{name:"areesBasiquesServeisSocialsVigent",key:"arees_basiques_serveis_socials_vigent"},{name:"areesBasiquesServeisSocialsVigentText",key:"arees_basiques_serveis_socials_vigent_text"},{name:"areesGestioAssistencialVigent",key:"arees_gestio_assistencial_vigent"},{name:"areesHidrogeologiquesAquifersVigent",key:"arees_hidrogeologiques_aquifers_vigent"},{name:"catalunyaVigent",key:"catalunya_vigent"},{name:"catalunyaVigentText",key:"catalunya_vigent_text"},{name:"comarques2022",key:"comarques_2022"},{name:"comarquesVigent",key:"comarques_vigent"},{name:"comarquesVigentText",key:"comarques_vigent_text"},{name:"districtesCensals2015",key:"districtes_censals_2015"},{name:"districtesCensals2016",key:"districtes_censals_2016"},{name:"districtesCensals2017",key:"districtes_censals_2017"},{name:"districtesCensals2018",key:"districtes_censals_2018"},{name:"districtesCensals2019",key:"districtes_censals_2019"},{name:"districtesCensals2020",key:"districtes_censals_2020"},{name:"districtesCensals2021",key:"districtes_censals_2021"},{name:"districtesCensals2022",key:"districtes_censals_2022"},{name:"districtesCensalsVigent",key:"districtes_censals_vigent"},{name:"districtesCensalsVigentText",key:"districtes_censals_vigent_text"},{name:"incendisForestalsVigent",key:"incendis_forestals_vigent"},{name:"incendisForestalsVigentText",key:"incendis_forestals_vigent_text"},{name:"municipis2022",key:"municipis_2022"},{name:"municipis2022Text",key:"municipis_2022_text"},{name:"municipisVigent",key:"municipis_vigent"},{name:"municipisVigentText",key:"municipis_vigent_text"},{name:"partitsJudicialsVigent",key:"partits_judicials_vigent"},{name:"partitsJudicialsVigentText",key:"partits_judicials_vigent_text"},{name:"plaTerritorial2015",key:"pla_territorial_2015"},{name:"plaTerritorialVigent",key:"pla_territorial_vigent"},{name:"plaTerritorialVigentText",key:"pla_territorial_vigent_text"},{name:"provinciesVigent",key:"provincies_vigent"},{name:"provinciesVigentText",key:"provincies_vigent_text"},{name:"regionsPolicialsVigent",key:"regions_policials_vigent"},{name:"regionsPolicialsVigentText",key:"regions_policials_vigent_text"},{name:"regionsSanitariesVigent",key:"regions_sanitaries_vigent"},{name:"regionsSanitariesVigentText",key:"regions_sanitaries_vigent_text"},{name:"seccionsCensals2015",key:"seccions_censals_2015"},{name:"seccionsCensals2016",key:"seccions_censals_2016"},{name:"seccionsCensals2017",key:"seccions_censals_2017"},{name:"seccionsCensals2018",key:"seccions_censals_2018"},{name:"seccionsCensals2019",key:"seccions_censals_2019"},{name:"seccionsCensals2020",key:"seccions_censals_2020"},{name:"seccionsCensals2021",key:"seccions_censals_2021"},{name:"seccionsCensals2022",key:"seccions_censals_2022"},{name:"seccionsCensalsVigent",key:"seccions_censals_vigent"},{name:"seccionsCensalsVigentText",key:"seccions_censals_vigent_text"},{name:"sectorsSanitarisVigent",key:"sectors_sanitaris_vigent"},{name:"vegueriesVigent",key:"vegueries_vigent"},{name:"vegueriesVigentText",key:"vegueries_vigent_text"}],vectorLayers:[{key:"cobertes2018",url:"https://tilemaps.icgc.cat/tileserver/cobertes_tilejson.json",legend:"https://tilemaps.icgc.cat/cdn/images/llegendaCobertesSol2018.jpg"}],wmsLayers:[{key:"espaisInteresGeologic",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/espais-interes-geologic/wms/service?&service=WMS&request=GetMap&layers=espais-interes-geologic&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},{key:"gravimetriaBouguer500000",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/gravimetria/wms/service?&service=WMS&request=GetMap&layers=anomalia_bouguer_500000&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},{key:"cobertesSol2018",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms/service?&service=WMS&request=GetMap&layers=cobertes_2018&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},{key:"administratiu",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/administratiu/MON3857NW/{z}/{x}/{y}.png"},{key:"simplificat",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/simplificat/MON3857NW/{z}/{x}/{y}.png"},{key:"cims",layer:"",url:"https://geoserveis.icgc.cat/icc_100cims/wms/service?REQUEST=GetMap&SERVICE=WMS&VERSION=1.1.1&LAYERS=0&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&SRS=EPSG:25831&BBOX=137118.923076923,4488408.75,650959.076923077,4749634.75&WIDTH=895&HEIGHT=455"},{key:"cobertesSol",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms?REQUEST=GetMap&SERVICE=WMS&VERSION=1.3.0&LAYERS=cobertes_2009&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&CRS=EPSG:25831&BBOX=374110.828167253,4639230.79853085,452621.120632226,4703578.45000215&WIDTH=1020&HEIGHT=836"}],fgbLayers:[{name:"agrupacionsCensalsVigent",key:"agrupacions_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent.fgb"},{name:"agrupacionsCensalsVigentText",key:"agrupacions_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent_text.fgb"},{name:"areesBasiquesPolicialsVigent",key:"arees_basiques_policials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent.fgb"},{name:"areesBasiquesPolicialsVigentText",key:"arees_basiques_policials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent_text.fgb"},{name:"areesBasiquesSalutVigent",key:"arees_basiques_salut_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_salut_vigent.fgb"},{name:"areesBasiquesServeisSocialsVigent",key:"arees_basiques_serveis_socials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent.fgb"},{name:"areesBasiquesServeisSocialsVigentText",key:"arees_basiques_serveis_socials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent_text.fgb"},{name:"areesGestioAssistencialVigent",key:"arees_gestio_assistencial_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_gestio_assistencial_vigent.fgb"},{name:"areesHidrogeologiquesAquifersVigent",key:"arees_hidrogeologiques_aquifers_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_hidrogeologiques_aquifers_vigent.fgb"},{name:"catalunyaVigent",key:"catalunya_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent.fgb"},{name:"catalunyaVigentText",key:"catalunya_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent_text.fgb"},{name:"comarquesVigent",key:"comarques_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent.fgb"},{name:"comarquesVigentText",key:"comarques_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent_text.fgb"},{name:"districtesCensalsVigent",key:"districtes_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent.fgb"},{name:"districtesCensalsVigentText",key:"districtes_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent_text.fgb"},{name:"incendisForestalsVigent",key:"incendis_forestals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent.fgb"},{name:"incendisForestalsVigentText",key:"incendis_forestals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent_text.fgb"},{name:"municipisVigent",key:"municipis_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent.fgb"},{name:"municipisVigentText",key:"municipis_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent_text.fgb"},{name:"partitsJudicialsVigent",key:"partits_judicials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent.fgb"},{name:"partitsJudicialsVigentText",key:"partits_judicials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent_text.fgb"},{name:"plaTerritorialVigent",key:"pla_territorial_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent.fgb"},{name:"plaTerritorialVigentText",key:"pla_territorial_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent_text.fgb"},{name:"provinciesVigent",key:"provincies_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent.fgb"},{name:"provinciesVigentText",key:"provincies_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent_text.fgb"},{name:"regionsPolicialsVigent",key:"regions_policials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent.fgb"},{name:"regionsPolicialsVigentText",key:"regions_policials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent_text.fgb"},{name:"regionsSanitariesVigent",key:"regions_sanitaries_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent.fgb"},{name:"regionsSanitariesVigentText",key:"regions_sanitaries_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent_text.fgb"},{name:"seccionsCensalsVigent",key:"seccions_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent.fgb"},{name:"seccionsCensalsVigentText",key:"seccions_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent_text.fgb"},{name:"sectorsSanitarisVigent",key:"sectors_sanitaris_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/sectors_sanitaris_vigent.fgb"},{name:"vegueriesVigent",key:"vegueries_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent.fgb"},{name:"vegueriesVigentText",key:"vegueries_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent_text.fgb"}]},Styles:{TOPO:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_estandard.json",ORTO:"https://geoserveis.icgc.cat/contextmaps/icgc_orto_estandard.json",ORTO3D:"https://tilemaps.icgc.cat/cdn/styles/icgc_orto_3d.json",ADMIN:"https://geoserveis.icgc.cat/contextmaps/icgc_delimitacio_limits_administratius.json",DARK:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_fosc.json",LIGHT:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_gris.json",GEOLOGY:"https://geoserveis.icgc.cat/contextmaps/icgc_geologic_informacio.json"},Terrains:{ICGC5M:"https://tilemaps.icgc.cat/tileserver/tileserver/terreny-5m-30m-rgb-extent/{z}/{x}/{y}.png",WORLD30M:"https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png"},Layers:{Orto:{ortofotoColorProvisional:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_provisional",ortofotoColor2022:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2022",ortofotoColor2021:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2021",ortofotoColor2020:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2020",ortofotoColor2019:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2019",ortofotoColor2018:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2018",ortofotoColor2017:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2017",ortofotoColor2016:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2016",ortofotoColor2015:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2015",ortofotoColor2014:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2014",ortofotoColor2013:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2013",ortofotoColor2012:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2012",ortofotoColor2011:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2011",ortofotoColor2010:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2010",ortofotoColor2009:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2009",ortofotoColor2008:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2008",ortofotoColor20062007:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2006-2007",ortofotoColor20042005:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2004-2005",ortofotoColor20002003:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2000-2003",ortofotoBlancINegre1998:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1998",ortofotoBlancINegre19941997:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1994-1997",ortofotoColor1993:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_1993",ortofotoBlancINegre19831992:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1983-1992",ortofotoBlancINegre19701977:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1970-1977",ortofotoBlancINegre1956:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1956",ortofotoBlancINegre1945:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1945",ortofotoColorSerieAnual:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_serie_anual",ortofotoInfraroigProvisional:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_provisional",ortofotoInfraroig2022:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2022",ortofotoInfraroig2021:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2021",ortofotoInfraroig2020:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2020",ortofotoInfraroig2019:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2019",ortofotoInfraroig2018:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2018",ortofotoInfraroig2017:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2017",ortofotoInfraroig2016:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2016",ortofotoInfraroig2015:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2015",ortofotoInfraroig2014:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2014",ortofotoInfraroig2013:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2013",ortofotoInfraroig2012:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2012",ortofotoInfraroig2011:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2011",ortofotoInfraroig2010:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2010",ortofotoInfraroig2009:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2009",ortofotoInfraroig2008:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2008",ortofotoInfraroig20062007:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2006-2007",ortofotoInfraroig19961997:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_1996-1997",ortofotoInfraroigSerieAnual:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_serie_anual"},VectorAdmin:{agrupacionsCensals2015:"agrupacions_censals_2015",agrupacionsCensals2016:"agrupacions_censals_2016",agrupacionsCensals2017:"agrupacions_censals_2017",agrupacionsCensals2018:"agrupacions_censals_2018",agrupacionsCensals2019:"agrupacions_censals_2019",agrupacionsCensals2020:"agrupacions_censals_2020",agrupacionsCensals2021:"agrupacions_censals_2021",agrupacionsCensalsVigent:"agrupacions_censals_vigent",agrupacionsCensalsVigentText:"agrupacions_censals_vigent_text",areesBasiquesPolicials2019:"arees_basiques_policials_2019",areesBasiquesPolicials2020:"arees_basiques_policials_2020",areesBasiquesPolicials2022:"arees_basiques_policials_2022",areesBasiquesPolicialsVigent:"arees_basiques_policials_vigent",areesBasiquesPolicialsVigentText:"arees_basiques_policials_vigent_text",areesBasiquesSalutVigent:"arees_basiques_salut_vigent",areesBasiquesServeisSocialsVigent:"arees_basiques_serveis_socials_vigent",areesBasiquesServeisSocialsVigentText:"arees_basiques_serveis_socials_vigent_text",areesGestioAssistencialVigent:"arees_gestio_assistencial_vigent",areesHidrogeologiquesAquifersVigent:"arees_hidrogeologiques_aquifers_vigent",catalunyaVigent:"catalunya_vigent",catalunyaVigentText:"catalunya_vigent_text",comarques2022:"comarques_2022",comarquesVigent:"comarques_vigent",comarquesVigentText:"comarques_vigent_text",districtesCensals2015:"districtes_censals_2015",districtesCensals2016:"districtes_censals_2016",districtesCensals2017:"districtes_censals_2017",districtesCensals2018:"districtes_censals_2018",districtesCensals2019:"districtes_censals_2019",districtesCensals2020:"districtes_censals_2020",districtesCensals2021:"districtes_censals_2021",districtesCensals2022:"districtes_censals_2022",districtesCensalsVigent:"districtes_censals_vigent",districtesCensalsVigentText:"districtes_censals_vigent_text",incendisForestalsVigent:"incendis_forestals_vigent",incendisForestalsVigentText:"incendis_forestals_vigent_text",municipis2022:"municipis_2022",municipis2022Text:"municipis_2022_text",municipisVigent:"municipis_vigent",municipisVigentText:"municipis_vigent_text",partitsJudicialsVigent:"partits_judicials_vigent",partitsJudicialsVigentText:"partits_judicials_vigent_text",plaTerritorial2015:"pla_territorial_2015",plaTerritorialVigent:"pla_territorial_vigent",plaTerritorialVigentText:"pla_territorial_vigent_text",provinciesVigent:"provincies_vigent",provinciesVigentText:"provincies_vigent_text",regionsPolicialsVigent:"regions_policials_vigent",regionsPolicialsVigentText:"regions_policials_vigent_text",regionsSanitariesVigent:"regions_sanitaries_vigent",regionsSanitariesVigentText:"regions_sanitaries_vigent_text",seccionsCensals2015:"seccions_censals_2015",seccionsCensals2016:"seccions_censals_2016",seccionsCensals2017:"seccions_censals_2017",seccionsCensals2018:"seccions_censals_2018",seccionsCensals2019:"seccions_censals_2019",seccionsCensals2020:"seccions_censals_2020",seccionsCensals2021:"seccions_censals_2021",seccionsCensals2022:"seccions_censals_2022",seccionsCensalsVigent:"seccions_censals_vigent",seccionsCensalsVigentText:"seccions_censals_vigent_text",sectorsSanitarisVigent:"sectors_sanitaris_vigent",vegueriesVigent:"vegueries_vigent",vegueriesVigentText:"vegueries_vigent_text"},FGBAdmin:{agrupacionsCensalsVigent:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent.fgb",agrupacionsCensalsVigentText:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent_text.fgb",areesBasiquesPolicialsVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent.fgb",areesBasiquesPolicialsVigentText:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent_text.fgb",areesBasiquesSalutVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_salut_vigent.fgb",areesBasiquesServeisSocialsVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent.fgb",areesBasiquesServeisSocialsVigentText:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent_text.fgb",areesGestioAssistencialVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_gestio_assistencial_vigent.fgb",areesHidrogeologiquesAquifersVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_hidrogeologiques_aquifers_vigent.fgb",catalunyaVigent:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent.fgb",catalunyaVigentText:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent_text.fgb",comarquesVigent:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent.fgb",comarquesVigentText:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent_text.fgb",districtesCensalsVigent:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent.fgb",districtesCensalsVigentText:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent_text.fgb",incendisForestalsVigent:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent.fgb",incendisForestalsVigentText:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent_text.fgb",municipisVigent:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent.fgb",municipisVigentText:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent_text.fgb",partitsJudicialsVigent:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent.fgb",partitsJudicialsVigentText:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent_text.fgb",plaTerritorialVigent:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent.fgb",plaTerritorialVigentText:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent_text.fgb",provinciesVigent:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent.fgb",provinciesVigentText:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent_text.fgb",regionsPolicialsVigent:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent.fgb",regionsPolicialsVigentText:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent_text.fgb",regionsSanitariesVigent:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent.fgb",regionsSanitariesVigentText:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent_text.fgb",seccionsCensalsVigent:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent.fgb",seccionsCensalsVigentText:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent_text.fgb",sectorsSanitarisVigent:"https://tilemaps.icgc.cat/vector/fgb/sectors_sanitaris_vigent.fgb",vegueriesVigent:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent.fgb",vegueriesVigentText:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent_text.fgb"},Vector:{cobertes2018:"https://tilemaps.icgc.cat/tileserver/cobertes_tilejson.json"},WMS:{espaisInteresGeologic:"https://geoserveis.icgc.cat/servei/catalunya/espais-interes-geologic/wms/service?&service=WMS&request=GetMap&layers=espais-interes-geologic&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}",gravimetriaBouguer500000:"https://geoserveis.icgc.cat/servei/catalunya/gravimetria/wms/service?&service=WMS&request=GetMap&layers=anomalia_bouguer_500000&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}",cobertesSol2018:"https://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms/service?&service=WMS&request=GetMap&layers=cobertes_2018&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}",administratiu:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/administratiu/MON3857NW/{z}/{x}/{y}.png",simplificat:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/simplificat/MON3857NW/{z}/{x}/{y}.png",cims:"https://geoserveis.icgc.cat/icc_100cims/wms/service?REQUEST=GetMap&SERVICE=WMS&VERSION=1.1.1&LAYERS=0&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&SRS=EPSG:25831&BBOX=137118.923076923,4488408.75,650959.076923077,4749634.75&WIDTH=895&HEIGHT=455",cobertesSol:"http://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms?REQUEST=GetMap&SERVICE=WMS&VERSION=1.3.0&LAYERS=cobertes_2009&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&CRS=EPSG:25831&BBOX=374110.828167253,4639230.79853085,452621.120632226,4703578.45000215&WIDTH=1020&HEIGHT=836"}}},xy=T2.Terrains,Sf=T2.Styles,Ti=T2.Layers,Hn={limitsUrl:"https://tilemaps.icgc.cat/vt/limits-tilejsonV3.json",geocoder:{peliasUrl1:"https://eines.icgc.cat/geocodificador/autocompletar?text=",peliasUrl2:"&layers=topo1%2Ctopo2%2Caddress&size=5"},mapOptions:{container:"map",center:{0:1.537786,1:41.837539},zoom:7.5,bearing:0,pitch:0,hash:!1,style:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_gris.json.json",maxZoom:18,maxPitch:85},logoIcgcOptions:{logoUrlColor:"https://tilemaps.icgc.cat/cdn/logos/icgc_logo_color.png",logoUrlWhite:"https://tilemaps.icgc.cat/cdn/logos/icgc_logo_blanc.svg",logoLink:"https://www.icgc.cat",logoTitle:"Institut Cartogrfic i Geolgic de Catalunya",logoWidth:100},logoGencatOptions:{logoUrlColor:"https://tilemaps.icgc.cat/cdn/logos/gencat_logo_color.png",logoUrlWhite:"https://tilemaps.icgc.cat/cdn/logos/gencat_logo_blanc.png",logoLink:"https://web.gencat.cat/",logoTitle:"Generalitat de Catalunya",logoWidth:100},map3dOptions:{spaceErrorFactor:2,exaggeration:1,zfactor:48,minZoomRange:15.5,maxZoomRange:22,urlTilesetCities:"https://tilemaps.icgc.cat/vector/3dtiles/ciutats/v1/tilesetV1.0.json",layerIdOrder:"place-isolated",sourceLayerFilterId:"place",minZoomFilter:14,layerId3d:"edificisMapboxLayer",terrainSource:"ICGC5M",style3dName:"orto3d",imageIcon:"https://tilemaps.icgc.cat/cdn/images/stick.png"},baseStyles:{0:{key:"TOPO",url:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_estandard_general.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_estandard.png"},1:{key:"ORTO",url:"https://geoserveis.icgc.cat/contextmaps/icgc_orto_estandard.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_orto_hibrida.png"},2:{key:"ORTO3D",url:"https://tilemaps.icgc.cat/cdn/styles/icgc_orto_3d.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_orto_hibrida.png"},3:{key:"ADMIN",url:"https://geoserveis.icgc.cat/contextmaps/icgc_delimitacio_limits_administratius.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_delimitacio_limits_administratius.png"},4:{key:"DARK",url:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_fosc.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_base_fosc.png"},5:{key:"LIGHT",url:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_gris.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_base_gris.png"},6:{key:"GEOLOGY",url:"https://geoserveis.icgc.cat/contextmaps/icgc_geologic_informacio.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_geologic_informacio.png"}},urlTerrainICGC:{0:{name:"ICGC5M",url:"https://tilemaps.icgc.cat/tileserver/tileserver/terreny-5m-30m-rgb-extent/{z}/{x}/{y}.png"},1:{name:"WORLD30M",url:"https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png",encoding:"terrarium"}},ortoLayersICGC:{0:{name:"ortofotoColorProvisional",key:"ortofoto_color_provisional",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_provisional"},1:{name:"ortofotoColor2022",key:"ortofoto_color_2022",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2022"},2:{name:"ortofotoColor2021",key:"ortofoto_color_2021",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2021"},3:{name:"ortofotoColor2020",key:"ortofoto_color_2020",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2020"},4:{name:"ortofotoColor2019",key:"ortofoto_color_2019",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2019"},5:{name:"ortofotoColor2018",key:"ortofoto_color_2018",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2018"},6:{name:"ortofotoColor2017",key:"ortofoto_color_2017",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2017"},7:{name:"ortofotoColor2016",key:"ortofoto_color_2016",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2016"},8:{name:"ortofotoColor2015",key:"ortofoto_color_2015",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2015"},9:{name:"ortofotoColor2014",key:"ortofoto_color_2014",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2014"},10:{name:"ortofotoColor2013",key:"ortofoto_color_2013",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2013"},11:{name:"ortofotoColor2012",key:"ortofoto_color_2012",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2012"},12:{name:"ortofotoColor2011",key:"ortofoto_color_2011",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2011"},13:{name:"ortofotoColor2010",key:"ortofoto_color_2010",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2010"},14:{name:"ortofotoColor2009",key:"ortofoto_color_2009",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2009"},15:{name:"ortofotoColor2008",key:"ortofoto_color_2008",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2008"},16:{name:"ortofotoColor20062007",key:"ortofoto_color_2006-2007",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2006-2007"},17:{name:"ortofotoColor20042005",key:"ortofoto_color_2004-2005",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2004-2005"},18:{name:"ortofotoColor20002003",key:"ortofoto_color_2000-2003",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2000-2003"},19:{name:"ortofotoBlancINegre1998",key:"ortofoto_blanc_i_negre_1998",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1998"},20:{name:"ortofotoBlancINegre19941997",key:"ortofoto_blanc_i_negre_1994-1997",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1994-1997"},21:{name:"ortofotoColor1993",key:"ortofoto_color_1993",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_1993"},22:{name:"ortofotoBlancINegre19831992",key:"ortofoto_blanc_i_negre_1983-1992",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1983-1992"},23:{name:"ortofotoBlancINegre19701977",key:"ortofoto_blanc_i_negre_1970-1977",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1970-1977"},24:{name:"ortofotoBlancINegre1956",key:"ortofoto_blanc_i_negre_1956",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1956"},25:{name:"ortofotoBlancINegre1945",key:"ortofoto_blanc_i_negre_1945",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1945"},26:{name:"ortofotoColorSerieAnual",key:"ortofoto_color_serie_anual",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_serie_anual"},27:{name:"ortofotoInfraroigProvisional",key:"ortofoto_infraroig_provisional",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_provisional"},28:{name:"ortofotoInfraroig2022",key:"ortofoto_infraroig_2022",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2022"},29:{name:"ortofotoInfraroig2021",key:"ortofoto_infraroig_2021",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2021"},30:{name:"ortofotoInfraroig2020",key:"ortofoto_infraroig_2020",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2020"},31:{name:"ortofotoInfraroig2019",key:"ortofoto_infraroig_2019",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2019"},32:{name:"ortofotoInfraroig2018",key:"ortofoto_infraroig_2018",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2018"},33:{name:"ortofotoInfraroig2017",key:"ortofoto_infraroig_2017",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2017"},34:{name:"ortofotoInfraroig2016",key:"ortofoto_infraroig_2016",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2016"},35:{name:"ortofotoInfraroig2015",key:"ortofoto_infraroig_2015",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2015"},36:{name:"ortofotoInfraroig2014",key:"ortofoto_infraroig_2014",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2014"},37:{name:"ortofotoInfraroig2013",key:"ortofoto_infraroig_2013",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2013"},38:{name:"ortofotoInfraroig2012",key:"ortofoto_infraroig_2012",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2012"},39:{name:"ortofotoInfraroig2011",key:"ortofoto_infraroig_2011",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2011"},40:{name:"ortofotoInfraroig2010",key:"ortofoto_infraroig_2010",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2010"},41:{name:"ortofotoInfraroig2009",key:"ortofoto_infraroig_2009",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2009"},42:{name:"ortofotoInfraroig2008",key:"ortofoto_infraroig_2008",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2008"},43:{name:"ortofotoInfraroig20062007",key:"ortofoto_infraroig_2006-2007",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2006-2007"},44:{name:"ortofotoInfraroig19961997",key:"ortofoto_infraroig_1996-1997",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_1996-1997"},45:{name:"ortofotoInfraroigSerieAnual",key:"ortofoto_infraroig_serie_anual",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_serie_anual"}},vectorLayersICGC:{0:{name:"agrupacionsCensals2015",key:"agrupacions_censals_2015"},1:{name:"agrupacionsCensals2016",key:"agrupacions_censals_2016"},2:{name:"agrupacionsCensals2017",key:"agrupacions_censals_2017"},3:{name:"agrupacionsCensals2018",key:"agrupacions_censals_2018"},4:{name:"agrupacionsCensals2019",key:"agrupacions_censals_2019"},5:{name:"agrupacionsCensals2020",key:"agrupacions_censals_2020"},6:{name:"agrupacionsCensals2021",key:"agrupacions_censals_2021"},7:{name:"agrupacionsCensalsVigent",key:"agrupacions_censals_vigent"},8:{name:"agrupacionsCensalsVigentText",key:"agrupacions_censals_vigent_text"},9:{name:"areesBasiquesPolicials2019",key:"arees_basiques_policials_2019"},10:{name:"areesBasiquesPolicials2020",key:"arees_basiques_policials_2020"},11:{name:"areesBasiquesPolicials2022",key:"arees_basiques_policials_2022"},12:{name:"areesBasiquesPolicialsVigent",key:"arees_basiques_policials_vigent"},13:{name:"areesBasiquesPolicialsVigentText",key:"arees_basiques_policials_vigent_text"},14:{name:"areesBasiquesSalutVigent",key:"arees_basiques_salut_vigent"},15:{name:"areesBasiquesServeisSocialsVigent",key:"arees_basiques_serveis_socials_vigent"},16:{name:"areesBasiquesServeisSocialsVigentText",key:"arees_basiques_serveis_socials_vigent_text"},17:{name:"areesGestioAssistencialVigent",key:"arees_gestio_assistencial_vigent"},18:{name:"areesHidrogeologiquesAquifersVigent",key:"arees_hidrogeologiques_aquifers_vigent"},19:{name:"catalunyaVigent",key:"catalunya_vigent"},20:{name:"catalunyaVigentText",key:"catalunya_vigent_text"},21:{name:"comarques2022",key:"comarques_2022"},22:{name:"comarquesVigent",key:"comarques_vigent"},23:{name:"comarquesVigentText",key:"comarques_vigent_text"},24:{name:"districtesCensals2015",key:"districtes_censals_2015"},25:{name:"districtesCensals2016",key:"districtes_censals_2016"},26:{name:"districtesCensals2017",key:"districtes_censals_2017"},27:{name:"districtesCensals2018",key:"districtes_censals_2018"},28:{name:"districtesCensals2019",key:"districtes_censals_2019"},29:{name:"districtesCensals2020",key:"districtes_censals_2020"},30:{name:"districtesCensals2021",key:"districtes_censals_2021"},31:{name:"districtesCensals2022",key:"districtes_censals_2022"},32:{name:"districtesCensalsVigent",key:"districtes_censals_vigent"},33:{name:"districtesCensalsVigentText",key:"districtes_censals_vigent_text"},34:{name:"incendisForestalsVigent",key:"incendis_forestals_vigent"},35:{name:"incendisForestalsVigentText",key:"incendis_forestals_vigent_text"},36:{name:"municipis2022",key:"municipis_2022"},37:{name:"municipis2022Text",key:"municipis_2022_text"},38:{name:"municipisVigent",key:"municipis_vigent"},39:{name:"municipisVigentText",key:"municipis_vigent_text"},40:{name:"partitsJudicialsVigent",key:"partits_judicials_vigent"},41:{name:"partitsJudicialsVigentText",key:"partits_judicials_vigent_text"},42:{name:"plaTerritorial2015",key:"pla_territorial_2015"},43:{name:"plaTerritorialVigent",key:"pla_territorial_vigent"},44:{name:"plaTerritorialVigentText",key:"pla_territorial_vigent_text"},45:{name:"provinciesVigent",key:"provincies_vigent"},46:{name:"provinciesVigentText",key:"provincies_vigent_text"},47:{name:"regionsPolicialsVigent",key:"regions_policials_vigent"},48:{name:"regionsPolicialsVigentText",key:"regions_policials_vigent_text"},49:{name:"regionsSanitariesVigent",key:"regions_sanitaries_vigent"},50:{name:"regionsSanitariesVigentText",key:"regions_sanitaries_vigent_text"},51:{name:"seccionsCensals2015",key:"seccions_censals_2015"},52:{name:"seccionsCensals2016",key:"seccions_censals_2016"},53:{name:"seccionsCensals2017",key:"seccions_censals_2017"},54:{name:"seccionsCensals2018",key:"seccions_censals_2018"},55:{name:"seccionsCensals2019",key:"seccions_censals_2019"},56:{name:"seccionsCensals2020",key:"seccions_censals_2020"},57:{name:"seccionsCensals2021",key:"seccions_censals_2021"},58:{name:"seccionsCensals2022",key:"seccions_censals_2022"},59:{name:"seccionsCensalsVigent",key:"seccions_censals_vigent"},60:{name:"seccionsCensalsVigentText",key:"seccions_censals_vigent_text"},61:{name:"sectorsSanitarisVigent",key:"sectors_sanitaris_vigent"},62:{name:"vegueriesVigent",key:"vegueries_vigent"},63:{name:"vegueriesVigentText",key:"vegueries_vigent_text"}},vectorLayers:{0:{key:"cobertes2018",url:"https://tilemaps.icgc.cat/tileserver/cobertes_tilejson.json",legend:"https://tilemaps.icgc.cat/cdn/images/llegendaCobertesSol2018.jpg"}},wmsLayers:{0:{key:"espaisInteresGeologic",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/espais-interes-geologic/wms/service?&service=WMS&request=GetMap&layers=espais-interes-geologic&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},1:{key:"gravimetriaBouguer500000",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/gravimetria/wms/service?&service=WMS&request=GetMap&layers=anomalia_bouguer_500000&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},2:{key:"cobertesSol2018",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms/service?&service=WMS&request=GetMap&layers=cobertes_2018&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},3:{key:"administratiu",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/administratiu/MON3857NW/{z}/{x}/{y}.png"},4:{key:"simplificat",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/simplificat/MON3857NW/{z}/{x}/{y}.png"},5:{key:"cims",layer:"",url:"https://geoserveis.icgc.cat/icc_100cims/wms/service?REQUEST=GetMap&SERVICE=WMS&VERSION=1.1.1&LAYERS=0&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&SRS=EPSG:25831&BBOX=137118.923076923,4488408.75,650959.076923077,4749634.75&WIDTH=895&HEIGHT=455"},6:{key:"cobertesSol",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms?REQUEST=GetMap&SERVICE=WMS&VERSION=1.3.0&LAYERS=cobertes_2009&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&CRS=EPSG:25831&BBOX=374110.828167253,4639230.79853085,452621.120632226,4703578.45000215&WIDTH=1020&HEIGHT=836"}},fgbLayers:{0:{name:"agrupacionsCensalsVigent",key:"agrupacions_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent.fgb"},1:{name:"agrupacionsCensalsVigentText",key:"agrupacions_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent_text.fgb"},2:{name:"areesBasiquesPolicialsVigent",key:"arees_basiques_policials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent.fgb"},3:{name:"areesBasiquesPolicialsVigentText",key:"arees_basiques_policials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent_text.fgb"},4:{name:"areesBasiquesSalutVigent",key:"arees_basiques_salut_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_salut_vigent.fgb"},5:{name:"areesBasiquesServeisSocialsVigent",key:"arees_basiques_serveis_socials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent.fgb"},6:{name:"areesBasiquesServeisSocialsVigentText",key:"arees_basiques_serveis_socials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent_text.fgb"},7:{name:"areesGestioAssistencialVigent",key:"arees_gestio_assistencial_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_gestio_assistencial_vigent.fgb"},8:{name:"areesHidrogeologiquesAquifersVigent",key:"arees_hidrogeologiques_aquifers_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_hidrogeologiques_aquifers_vigent.fgb"},9:{name:"catalunyaVigent",key:"catalunya_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent.fgb"},10:{name:"catalunyaVigentText",key:"catalunya_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent_text.fgb"},11:{name:"comarquesVigent",key:"comarques_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent.fgb"},12:{name:"comarquesVigentText",key:"comarques_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent_text.fgb"},13:{name:"districtesCensalsVigent",key:"districtes_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent.fgb"},14:{name:"districtesCensalsVigentText",key:"districtes_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent_text.fgb"},15:{name:"incendisForestalsVigent",key:"incendis_forestals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent.fgb"},16:{name:"incendisForestalsVigentText",key:"incendis_forestals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent_text.fgb"},17:{name:"municipisVigent",key:"municipis_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent.fgb"},18:{name:"municipisVigentText",key:"municipis_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent_text.fgb"},19:{name:"partitsJudicialsVigent",key:"partits_judicials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent.fgb"},20:{name:"partitsJudicialsVigentText",key:"partits_judicials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent_text.fgb"},21:{name:"plaTerritorialVigent",key:"pla_territorial_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent.fgb"},22:{name:"plaTerritorialVigentText",key:"pla_territorial_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent_text.fgb"},23:{name:"provinciesVigent",key:"provincies_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent.fgb"},24:{name:"provinciesVigentText",key:"provincies_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent_text.fgb"},25:{name:"regionsPolicialsVigent",key:"regions_policials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent.fgb"},26:{name:"regionsPolicialsVigentText",key:"regions_policials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent_text.fgb"},27:{name:"regionsSanitariesVigent",key:"regions_sanitaries_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent.fgb"},28:{name:"regionsSanitariesVigentText",key:"regions_sanitaries_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent_text.fgb"},29:{name:"seccionsCensalsVigent",key:"seccions_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent.fgb"},30:{name:"seccionsCensalsVigentText",key:"seccions_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent_text.fgb"},31:{name:"sectorsSanitarisVigent",key:"sectors_sanitaris_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/sectors_sanitaris_vigent.fgb"},32:{name:"vegueriesVigent",key:"vegueries_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent.fgb"},33:{name:"vegueriesVigentText",key:"vegueries_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent_text.fgb"}}};let jre=class{constructor(e){this.initTheMap(e)}initTheMap(e){if(!e)e=Hn.mapOptions;else for(const t in Hn.mapOptions){let n=[Hn.mapOptions.center[0],Hn.mapOptions.center[1]];Hn.mapOptions.center=n,e.hasOwnProperty(t)||(e[t]=Hn.mapOptions[t])}e.maxPitch=85,e.maplibreLogo=!1,e.attributionControl=!1,this.map=new Ts.Map(e),this.map.options=e,this.map.addControl(new Ts.AttributionControl({compact:!0})),this.map.on("load",async()=>{const t=this.map.getStyle().name,n=this.map.options.style;if(window.document.querySelector(".maplibregl-compact-show")){var i=window.document.querySelector(".maplibregl-compact-show");i.classList.remove("maplibregl-compact-show")}this.map.addControl(new Hre({color:n.indexOf("orto")===-1,defaultOptions:Hn}),"bottom-left"),this._dealOrto3dStyle(t)})}addGeocoderICGC(e){try{e===void 0&&(e="top-right");let t={collapsed:!0,marker:!0,popup:!0,showResultMarkers:!0,maplibregl:Ts,showResultsWhileTyping:!0,minLength:2};const n={forwardGeocode:async s=>{const a=[];try{const o=Hn.geocoder.peliasUrl1+encodeURIComponent(s.query)+Hn.geocoder.peliasUrl2,f=await(await fetch(o)).json();for(const m of f.features){const v=m.geometry.coordinates,x={type:"Feature",geometry:{type:"Point",coordinates:v},place_name:m.properties.label,properties:m.properties,text:m.properties.label,place_type:["place"],center:v};a.push(x)}}catch(o){console.error(`Failed to forwardGeocode with error: ${o}`)}return{features:a}}};this.map.addControl(new Qre(n,t),e);let i=document.getElementsByClassName("maplibregl-ctrl-geocoder--input");i[0].attributes[2].nodeValue="Cerca...",i[0].addEventListener("input",function(s){s.target.value.length>3})}catch(t){console.error(`Error adding ICGC geocoder: ${t.message}`)}}getStyle(){try{return this.map.getStyle()}catch(e){console.error(`Error getting style: ${e.message}`)}}async loadImage(e){try{return this.map.loadImage(e)}catch(t){console.error(`Error getting loadImage: ${t.message}`)}}addImage(e,t){try{return this.map.addImage(e,t)}catch(n){console.error(`Error getting addImage: ${n.message}`)}}getConfigStyles(){try{let e=[];for(const t of Sf)e.push(t.name);return e}catch(e){console.error(`Error retrieving base styles: ${e.message}`)}}getConfigWMSLayers(){try{let e=[];for(const t in Ti.WMS)Ti.WMS.hasOwnProperty(t)&&e.push(t);return e}catch(e){console.error(`Error retrieving WMS layers: ${e.message}`)}}getConfigOrtoLayers(){try{let e=[];for(const t in Ti.Orto)Ti.Orto.hasOwnProperty(t)&&e.push(t);return e}catch(e){console.error(`Error retrieving orto image layers: ${e.message}`)}}getConfigVectorLayers(){try{let e=[];for(const t in Ti.Vector)Ti.Vector.hasOwnProperty(t)&&e.push(t);return e}catch(e){console.error(`Error retrieving vector layers: ${e.message}`)}}getConfigVectorAdminLayers(){try{let e=[];for(const t in Ti.VectorAdmin)Ti.VectorAdmin.hasOwnProperty(t)&&e.push(t);return e}catch(e){console.error(`Error retrieving vectorAdmin layers: ${e.message}`)}}getConfigFGBAdminLayers(){try{let e=[];for(const t in Ti.FGBAdmin)Ti.FGBAdmin.hasOwnProperty(t)&&e.push(t);return e}catch(e){console.error(`Error retrieving FGBAdmin layers: ${e.message}`)}}async fetchData(e,t,n){try{let i=n.layerPosition;if(e.includes(".fgb"))this.addFGBLayerICGC(e,i,null,n);else{const a=await(await fetch(e)).json();let o=t,A="";i==="labels"&&(A=this._firstSymbolLayer()),i==="lines"&&(A=this._firstLineLayer());let f=a.features[0].geometry.type;f.includes("ine")&&(n!==void 0?map.addLayer({id:o,type:"line",source:{type:"geojson",data:a},layout:n.layout,paint:n.paint},A):map.addLayer({id:o,type:"line",source:{type:"geojson",data:a},layout:{visibility:"visible"},paint:{"line-color":"black","line-width":2,"line-opacity":1}},A)),f.includes("olygon")&&(n!==void 0?map.addLayer({id:o,type:"fill",source:{type:"geojson",data:a},layout:n.layout,paint:n.paint},A):map.addLayer({id:o,type:"fill",source:{type:"geojson",data:a},layout:{visibility:"visible"},paint:{"fill-color":"blue","fill-opacity":.6}},A)),f.includes("oint")&&(n!==void 0?map.addLayer({id:o,type:"circle",source:{type:"geojson",data:a},layout:n.layout,paint:n.paint},A):map.addLayer({id:o,type:"circle",source:{type:"geojson",data:a},layout:{visibility:"visible"},paint:{"circle-color":"red","circle-opacity":.85}},A))}}catch(i){console.error(`Error fetching data: ${i.message}`)}}async fetchDataAndMenu(e,t,n,i){try{let s;i!==null?s=i.layerPosition:s="labels";let a,o=document.getElementById("map");if(document.getElementById("menu-group")?a=document.getElementById("menu-group"):(a=document.createElement("nav"),a.id="menu-group",a.classList.add="filter-group",o.appendChild(a)),a!==null){let A="visible",f="";s==="labels"&&(f=this._firstSymbolLayer()),s==="lines"&&(f=this._firstLineLayer());let m;if(e.includes(".fgb")){let B=function(Q){for(const q in Ti.FGBAdmin)if(Ti.FGBAdmin.hasOwnProperty(q)&&Ti.FGBAdmin[q]===Q)return q;return null}(e);B===null&&(B="userFGB");const M=await fetch(e),U={type:"FeatureCollection",features:[]};for await(const Q of YE(M.body))U.features.push(Q);m=U;let N=B;if(this.map.addSource(N,{type:"geojson",data:U}),e.includes("text"))i!==void 0?this.map.addLayer({id:B,type:"symbol",source:N,layout:i.layout,paint:i.paint},f):this.map.addLayer({id:B,type:"symbol",source:N,layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[8,0],[12,14],[15,15]]},"text-font":["FiraSans-Regular"],"text-field":["get","NOM_AC"],"text-transform":"none","text-max-width":25,visibility:A,"text-justify":"right","text-anchor":"top","text-allow-overlap":!1,"symbol-spacing":2,"text-line-height":1},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},f);else{let Q=B+"Text";this.map.addLayer({id:Q,type:"symbol",source:N,layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[8,0],[12,14],[15,15]]},"text-font":["FiraSans-Regular"],"text-field":["get","NOM_AC"],"text-transform":"none","text-max-width":25,visibility:A,"text-justify":"right","text-anchor":"top","text-allow-overlap":!1,"symbol-spacing":2,"text-line-height":1},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},f)}}else m=await(await fetch(e)).json();if(n!=="all"){const x=document.createElement("div");x.id="titleDivMenu",x.textContent=t,a.appendChild(x);const B=document.createElement("div");B.id="titleDivMenuSub",B.textContent=` ${n}`,a.appendChild(B)}let v=m.features[0].geometry.type;if(n==="all")v.includes("ine")&&(i!==void 0?this.map.addLayer({id:t,type:"line",source:{type:"geojson",data:m},layout:i.layout,paint:i.paint},f):this.map.addLayer({id:t,type:"line",source:{type:"geojson",data:m},layout:{visibility:"visible"},paint:{"line-color":"black","line-width":2,"line-opacity":1}},f)),v.includes("olygon")&&(i!==void 0?this.map.addLayer({id:t,type:"fill",source:{type:"geojson",data:m},layout:i.layout,paint:i.paint},f):this.map.addLayer({id:t,type:"fill",source:{type:"geojson",data:m},layout:{visibility:"visible"},paint:{"fill-color":"#0000FF","fill-opacity":0}},f)),v.includes("oint")&&(i!==void 0?this.map.addLayer({id:t,type:"circle",source:{type:"geojson",data:m},layout:i.layout,paint:i.paint},f):this.map.addLayer({id:t,type:"circle",source:{type:"geojson",data:m},layout:{visibility:"visible"},paint:{"circle-color":"red","circle-opacity":.85}},f)),v.includes("ymbol")&&(i!==void 0?this.map.addLayer({id:t,type:"symbol",source:{type:"geojson",data:m},layout:i.layout,paint:i.paint},f):this.map.addLayer({id:t,type:"symbol",source:{type:"geojson",data:m},layout:{visibility:"visible"},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},f)),this.addMenuItem(t);else{let x=n;const B={};m.features.forEach(M=>{const U=M.properties[x],N=U+"-userFieldFilter-"+t;U!==null&&(B[N]||(v.includes("ine")&&(i!==void 0?this.map.addLayer({id:N,type:"line",source:{type:"geojson",data:m},layout:i.layout,paint:i.paint,filter:["==",`${x}`,U]},f):this.map.addLayer({id:N,type:"line",source:{type:"geojson",data:m},layout:{visibility:"visible"},filter:["==",`${x}`,U],paint:{"line-color":"black","line-width":2,"line-opacity":1}},f)),v.includes("olygon")&&(i!==void 0?this.map.addLayer({id:N,type:"fill",source:{type:"geojson",data:m},filter:["==",`${x}`,U],layout:i.layout,paint:i.paint},f):this.map.addLayer({id:N,type:"fill",source:{type:"geojson",data:m},layout:{visibility:"visible"},filter:["==",`${x}`,U],paint:{"fill-color":"blue","fill-opacity":.6}},f)),v.includes("oint")&&(i!==void 0?this.map.addLayer({id:N,type:"circle",source:{type:"geojson",data:m},filter:["==",`${x}`,U],layout:i.layout,paint:i.paint},f):this.map.addLayer({id:N,type:"circle",source:{type:"geojson",data:m},layout:{visibility:"visible"},filter:["==",`${x}`,U],paint:{"circle-color":"red","circle-opacity":.85}},f)),B[N]=!0,this.addMenuItem(N)))})}}}catch(s){console.error(`Error fetching data: ${s.message}`)}}on(e,t){setTimeout(()=>{try{this.map.on(e,t)}catch(n){console.error(`Error adding event ON listener: ${n.message}`)}},500)}getSource(e){try{return this.map.getSource(e)}catch(t){console.error(`Error getting source: ${t.message}`)}}addSource(e,t){try{this.map.addSource(e,t)}catch(n){console.error(`Error adding source: ${n.message}`)}}setStyle(e,t){try{t!==void 0?this.map.setStyle(e,t):this.map.setStyle(e),this.map.on("styledata",()=>{if(window.document.querySelector(".maplibregl-compact-show")){var n=window.document.querySelector(".maplibregl-compact-show");n.classList.remove("maplibregl-compact-show")}this._dealOrto3dStyle(this.map.getStyle().name)})}catch(n){console.error(`Error setting style: ${n.message}`)}}getLayer(e){try{return this.map.getLayer(e)}catch(t){console.error(`Error getting layer: ${t.message}`)}}setFilter(e,t,n){try{return this.map.setFilter(e,t,n)}catch(i){console.error(`Error setting filter: ${i.message}`)}}jumpTo(e){try{this.map.jumpTo(e)}catch(t){console.error(`Error jumping to ${e}: ${t.message}`)}}setLayoutProperty(e,t,n){try{this.map.setLayoutProperty(e,t,n)}catch(i){console.error(`Error setting layout property: ${i.message}`)}}setPaintProperty(e,t,n){try{this.map.setPaintProperty(e,t,n)}catch(i){console.error(`Error setting paint property: ${i.message}`)}}addControl(e,t){try{t===void 0&&(t="top-right"),this.map.addControl(e,t)}catch(n){console.error(`Error adding control: ${n.message}`)}}getZoom(){try{return this.map.getZoom()}catch(e){console.error(`Error getting zoom level: ${e.message}`)}}addMouseCoordControl(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"bottom-left";try{this.map.addControl(new Vre(e),t)}catch(n){console.error(`Error adding mouse coordinate control: ${n.message}`)}}addGeolocateControl(e,t){try{t===void 0&&(t="top-right"),e===void 0?this.map.addControl(new Ts.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),t):this.map.addControl(new Ts.GeolocateControl(e),t)}catch(n){console.error(`Error adding geolocate control: ${n.message}`)}}addFullscreenControl(e,t){try{t===void 0&&(t="top-right"),e===void 0?this.map.addControl(new Ts.FullscreenControl({container:HTMLElement}),t):this.map.addControl(new Ts.FullscreenControl(e),t)}catch(n){console.error(`Error adding fullscreen control: ${n.message}`)}}getBounds(){try{return this.map.getBounds()}catch(e){console.error(`Error getting bounds: ${e.message}`)}}getCenter(){try{return this.map.getCenter()}catch(e){console.error(`Error getting center: ${e.message}`)}}setTerrain(e){try{return this.map.setTerrain(e)}catch(t){console.error(`Error setting terrain: ${t.message}`)}}setLayerZoomRange(e,t,n){try{return this.map.setLayerZoomRange(e,t,n)}catch(i){console.error(`Error setting terrain: ${i.message}`)}}getCanvas(){try{return this.map.getCanvas()}catch(e){console.error(`Error getting canvas: ${e.message}`)}}setCenter(e){try{return this.map.setCenter(e)}catch(t){console.error(`Error setting center: ${t.message}`)}}addLayer(e,t){try{this.map.addLayer(e,t)}catch(n){console.error(`Error adding layer: ${n.message}`)}}addLayerGeoJSON(e,t){try{let n="";t==="labels"&&(n=this._firstSymbolLayer()),t==="lines"&&(n=this._firstLineLayer()),this.map.addSource(`${e.id}`,{type:"geojson",data:e.data}),this.map.addLayer({id:`${e.id}-layerIcgcMap`,type:e.layerType,source:`${e.id}`,layout:e.layout,paint:e.paint},n)}catch(n){console.error(`Error adding GeoJSON layer: ${n.message}`)}}addLayerWMS(e,t,n){try{console.log("position",t,n);let i="";t==="labels"&&(i=this._firstSymbolLayer(),console.log("label",i)),t==="lines"&&(i=this._firstLineLayer()),n?(this.map.addSource(`${e.id}`,{type:n.type,tiles:[e.tiles],tileSize:256},i),this.map.addLayer({id:e.id,type:n.type,source:e.id,layout:n.layout,paint:n.paint},i)):(this.map.addSource(`${e.id}`,{type:"raster",tiles:[e.tiles],tileSize:256},i),this.map.addLayer({id:e.id,type:"raster",source:e.id,paint:{}},i))}catch(i){console.error(`Error adding WMS layer: ${i.message}`)}}removeControl(e){try{this.map.removeControl(e)}catch(t){console.error(`Error removing control: ${t.message}`)}}removeLayer(e){try{this.map.removeLayer(e)}catch(t){console.error(`Error removing layer: ${t.message}`)}}removeSource(e){try{this.map.removeSource(e)}catch(t){console.error(`Error removing source: ${t.message}`)}}addLogo(e,t){try{const n=document.createElement("img");n.src=e.url,n.style.height=e.height;const i=document.getElementById("logos"),s=document.createElement("a");s.id=e.id,s.href=e.href,s.target="_blank",s.style.position="relative",s.style.bottom="1px",s.appendChild(n),i.appendChild(s)}catch(n){console.error(`Error adding logo: ${n.message}`)}}addBasemapsICGC(e){try{const t=i=>{map.setStyle(i)},n=document.getElementById("basemap-group");for(const i of e)for(const s of Object.keys(Hn.baseStyles)){const a=Hn.baseStyles[s];if(i===a.url){const o=document.createElement("div");o.className="basemap-item",o.title=a.key,o.style.backgroundImage=`url('${a.image}')`,n.appendChild(o),o.addEventListener("click",()=>t(a.url))}}}catch(t){console.error(`Error adding basemaps: ${t.message}`)}}addBasemaps(e){try{const t=i=>{map.setStyle(i.url)},n=document.getElementById("basemap-group");e.forEach(i=>{const s=document.createElement("div");s.className="basemap-item",s.title=i.label,s.style.backgroundImage=`url('${i.image}')`,n.appendChild(s),s.addEventListener("click",()=>t(i))})}catch(t){console.error(`Error adding basemaps: ${t.message}`)}}addFeatureQuery(e,t,n){try{let i;this.map.on("mouseenter",e,()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave",e,()=>{this.map.getCanvas().style.cursor=""}),this.map.on("click",s=>{let a=this.map.queryRenderedFeatures(s.point);if(a&&a[0].source.includes(e)){let o=[s.lngLat.lng,s.lngLat.lat];if(t!==void 0&&t.length>0&&t!=="all"){if(t!==null){let A="";t.forEach(f=>{let m=a[0].properties[f];A=A+`<h4>${m}</h4>`}),i=A,map.addPopup(o,i,n)}}else{let A="";for(const f in a[0].properties)A+="<b>"+f+"</b>:"+a[0].properties[f]+"<br>";i=A,map.addPopup(o,i,n)}}})}catch(i){console.error(`Error adding feature query: ${i.message}`)}}addScaleControl(e,t){try{var n=new Ts.ScaleControl(e);this.map.addControl(n,t)}catch(i){console.error(`Error adding scale: ${i.message}`)}}addExportControl(e,t){try{typeof e=="string"&&(t=e,e=void 0),e===void 0&&(e={PageSize:Hh.A4,PageOrientation:Bg.Landscape,Format:Ru.PNG,DPI:t2[300],Crosshair:!0,PrintableArea:!0},t="top-right"),this.map.addControl(new Xte(e),t)}catch(n){console.error(`Error adding export control: ${n.message}`)}}addPopup(e,t){try{new Ts.Popup().setLngLat(e).setHTML(t).addTo(this.map)}catch{}}addMarker(e){try{let t,n;return e.text===void 0?t=new Ts.Marker(e.options).setLngLat(e.coord).addTo(this.map):(n=new Ts.Popup({offset:e.textOffset}).setText(e.text),t=new Ts.Marker().setLngLat(e.coord).setPopup(n).addTo(this.map)),t}catch(t){return console.error(`Error adding marker: ${t.message}`),null}}addPopup(e,t,n){try{return n.image===void 0?new Ts.Popup().setLngLat(e).setHTML(`
        <div class="popupBody">
          <div class="popupTop">
          ${n.title}
          </div>
          <div class="popupBottom">
          <div class="popupBottomUp">
 ${t}
          </div>
          <div class="popupBottomDown">
          </div>
          </div>
        </div>
      `).addTo(this.map):new Ts.Popup().setLngLat(e).setHTML(`
        <div class="popupBody">
          <div class="popupTop">
          ${n.title}
          </div>
          <div class="popupBottom">
          <div class="popupBottomUp">
          ${t}
          </div>
          <div class="popupBottomDown">
             <img style="  padding: 8px;  width: 50%;" src=${n.image} />
          </div>
          </div>
        </div>
      `).addTo(this.map)}catch(i){return console.error(`Error adding popup: ${i.message}`),null}}addFullScreen(e){try{e===void 0&&(e="top-right"),this.map.addControl(new Ts.FullscreenControl,e)}catch(t){console.error(`Error adding fullscreen control: ${t.message}`)}}addMenuItem(e){try{let t;if(e.includes("-userFieldFilter-")?t=e.split("-userFieldFilter-")[0]:t=e,e.length>0){const n=document.getElementById("menu-group"),i=document.createElement("input");i.type="checkbox",i.id=e,i.checked=!0,n.appendChild(i);const s=document.createElement("label");s.setAttribute("for",e),s.textContent=t,n.appendChild(s),i.addEventListener("change",a=>{this.map.setLayoutProperty(e,"visibility",a.target.checked?"visible":"none")})}}catch(t){console.error(`Error adding menu item: ${t.message}`)}}addLayerTree(e){try{let t=e.features;const n=document.getElementById("filter-group");this.map.addSource(`${e.id}`,{type:e.type,data:t}),t.features.forEach(i=>{const s=i.properties.icon,a=`poi-${s}`;if(!this.map.getLayer(a)){this.map.addLayer({id:a,type:"circle",source:`${e.id}`,paint:{"circle-radius":6,"circle-color":"#B42222"},filter:["==","icon",s]},this._firstSymbolLayer());const o=document.createElement("input");o.type="checkbox",o.id=a,o.checked=!0,n.appendChild(o);const A=document.createElement("label");A.setAttribute("for",a),A.textContent=s,n.appendChild(A),o.addEventListener("change",f=>{this.map.setLayoutProperty(a,"visibility",f.target.checked?"visible":"none")})}})}catch(t){console.error(`Error adding layer tree: ${t.message}`)}}createNavigationControl(e,t){try{t===void 0&&(t="top-right"),this.map.addControl(new Ts.NavigationControl(e),t)}catch(n){return console.error(`Error creating navigation control: ${n.message}`),null}}addNavigationControl(e,t){try{t===void 0&&(t="top-right"),this.map.addControl(new Ts.NavigationControl(e),t)}catch(n){console.error(`Error adding navigation control: ${n.message}`)}}addAttributionControl(e,t){try{this.map.addControl(new Ts.AttributionControl(e),t)}catch(n){console.error(`Error adding attribution control: ${n.message}`)}}_dealStyleMaps(e){try{if(e&&e.indexOf("icgc.cat")!=-1){for(const t in Sf)if(Sf.hasOwnProperty(t)){const n=Sf[t];if(t===e)return n}return Sf[0]}else return e}catch(t){return console.error(`Error dealing with map styles: ${t.message}`),null}}addImageLayerICGC(e,t,n){try{let o=function(f,m,v,x,B){const M=[m,v,x,B];for(const U of M)for(const[N,Q]of Object.entries(U))if(Q===f)return N;return null},i=null,s,a;n?(a=n,s=n.position):a={type:"raster",layout:{visibility:"visible"},paint:{"raster-opacity":1},position:"labels"},i=o(t,Ti.Orto,Ti.VectorAdmin,Ti.WMS,Ti.Vector),i||console.log(" %c The layer: %c%s%c does not exist in the ICGC DB. Consult the documentation.","font-weight: bold; font-style: italic;","font-weight: normal; font-style: normal; color: red;",t,"font-weight: bold; font-style: italic;");let A={id:e,tiles:t};this.addLayerWMS(A,s,a)}catch(i){console.error(`Error adding ICGC image layer: ${i.message}`)}}async addVectorLayerICGC(e,t,n){try{let i,s,a,o;n?(o=n.type,i=n.position,s=n.layout,a=n.paint):(o="line",i="labels",s={visibility:"visible"},a={"line-color":"#fcfcfc","line-width":.2});let A="";i==="labels"&&(A=this._firstSymbolLayer()),i==="lines"&&(A=this._firstLineLayer());let f=t;if(f===null)console.log(" %c The layer: %c%s%c does not exist in the ICGC DB. Consult the documentation.","font-weight: bold; font-style: italic;","font-weight: normal; font-style: normal; color: red;",f,"font-weight: bold; font-style: italic;");else if(t.includes("https")){let m=function(M){for(const U in Ti.Vector)if(Ti.Vector.hasOwnProperty(U)&&Ti.Vector[U]===M)return U;return null},x=function(M){for(const U in Hn.vectorLayers){const N=Hn.vectorLayers[U];if(N.key===M)return N.legend}return null},v=m(t);this.map.addSource(v,{type:"vector",url:t}),v==="cobertes2018"&&map.addLayer({id:v,type:"fill",source:v,"source-layer":"cobertes",maxzoom:18,layout:s,paint:{"fill-opacity":["interpolate",["exponential",.5],["zoom"],13.5,1,18,.4],"fill-outline-color":"rgba(0,0, 0, 0)","fill-color":["interpolate",["cubic-bezier",.5,1,1,1],["get","nivell_2"],0,"#ffffff",111,"#ffff00",112,"#ccff33",113,"#af5b15",114,"#808000",115,"#cdcd00",116,"#ffffcc",221,"#33cc33",222,"#66ff33",223,"#689018",224,"#967d5f",225,"#19e61e",226,"#b4ff9b",227,"#aaa500",228,"#c3c3a0",229,"#00ff9b",230,"#ff9632",231,"#282828",232,"#79797a",233,"#f5df78",234,"#3296ff",341,"#ff007d",342,"#ff53cd",343,"#ffa4e2",344,"#ffc8e2",345,"#ffb4b4",346,"#0f3700",347,"#730055",348,"#6200c4",349,"#4a9595",350,"#ff00f0",351,"#adaaca",352,"#ffe6e6",353,"#67629a",354,"#4a466e",355,"#2f2d46",461,"#6f6fff",462,"#0000dc",463,"#000064",464,"#185f94",465,"#12466d",466,"#000080"]}},A);let B=x(v);s.visibility==="visible"&&(console.log("entro"),map.addLegend(v,B),console.log("entrqo"))}else{let m=e;this.map.addSource(m,{type:"vector",url:Hn.limitsUrl}),o==="polygon"&&(a?this.map.addLayer({id:e,type:"fill",source:m,"source-layer":f,layout:s,paint:a},A):this.map.addLayer({id:e,type:"fill",source:m,"source-layer":f,layout:s,paint:{"fill-color":"#0000FF","fill-opacity":0}},A)),o==="line"&&(a?this.map.addLayer({id:e,type:"line",source:m,"source-layer":f,layout:s,paint:a},A):this.map.addLayer({id:e,type:"line",source:m,layout:s,"source-layer":f,paint:{"line-color":"#4832a8","line-opacity":1,"line-width":1}},A))}}catch(i){console.error(`Error adding ICGC vector layer: ${i.message}`)}}async addFGBLayerICGC(e,t,n){try{let a=function(v){for(const x in Ti.FGBAdmin)if(Ti.FGBAdmin.hasOwnProperty(x)&&Ti.FGBAdmin[x]===v)return x;return null},i="visible",s="";t==="labels"&&(s=this._firstSymbolLayer()),t==="lines"&&(s=this._firstLineLayer());let o=a(e);o===null&&(o="userFGB");const A=await fetch(e),f={type:"FeatureCollection",features:[]};for await(const v of YE(A.body))f.features.push(v);let m=o;if(this.map.addSource(m,{type:"geojson",data:f}),e.includes("text"))this.map.addLayer({id:o,type:"symbol",source:m,layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[8,0],[12,14],[15,15]]},"text-font":["FiraSans-Regular"],"text-field":["get","NOM_AC"],"text-transform":"none","text-max-width":25,visibility:i,"text-justify":"right","text-anchor":"top","text-allow-overlap":!1,"symbol-spacing":2,"text-line-height":1},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},s);else{this.map.addLayer({id:o+"-fill",type:"fill",source:m,paint:{"fill-color":"#0000FF","fill-opacity":0}},s),this.map.addLayer({id:o+"-underline",type:"line",source:m,paint:{"line-color":"#ffffff","line-opacity":1,"line-width":3}},s),n?this.map.addLayer({id:o+"-line",type:"line",source:m,paint:n},s):this.map.addLayer({id:o+"-line",type:"line",source:m,paint:{"line-color":"#4832a8","line-opacity":1,"line-width":1}},s);let v=o+"Text";this.map.addLayer({id:v,type:"symbol",source:m,layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[8,0],[12,14],[15,15]]},"text-font":["FiraSans-Regular"],"text-field":["get","NOM_AC"],"text-transform":"none","text-max-width":25,visibility:i,"text-justify":"right","text-anchor":"top","text-allow-overlap":!1,"symbol-spacing":2,"text-line-height":1},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},s)}}catch(i){console.error(`Error adding ICGC FGB layer: ${i.message}`)}}addTerrainICGC(e,t){try{let n;for(const s in xy)if(xy.hasOwnProperty(s)){const a=xy[s];a===e&&(n=a)}let i=n;this.getSource("terrainICGC")!==void 0&&(this.getStyle().layers.forEach(a=>{a.source==="terrainICGC"&&this.removeLayer(a.id)}),this.removeSource("terrainICGC")),this.getSource("terrainICGC")===void 0&&(e.includes("terrarium")?this.map.addSource("terrainICGC",{type:"raster-dem",tiles:[i],tileSize:512,encoding:"terrarium",maxzoom:16}):this.map.addSource("terrainICGC",{type:"raster-dem",tiles:[i],tileSize:512,maxzoom:16})),this.map.setTerrain({source:"terrainICGC",exaggeration:1.5}),t===void 0&&(t="top-right"),this.map.addControl(new tN({pitch:90,bearing:null,minpitchzoom:null}),t)}catch(n){console.error(`Error adding 3D terrain: ${n.message}`)}}addLegend(e,t){try{let n=function(){var i=document.createElement("link");i.rel="stylesheet",i.href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css";var s=document.createElement("script");s.src="https://code.jquery.com/jquery-3.6.0.min.js";var a=document.createElement("script");a.src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js";var o=document.head||document.getElementsByTagName("head")[0];o.appendChild(i),s.onload=function(){o.appendChild(a),$(document).ready(function(){const A=document.createElement("div");A.id="legendContainer",A.innerHTML=`<img src=${t} alt="Legend" >`,A.style.display="none",document.body.appendChild(A),a.onload=function(){$(function(){$("#legendContainer").draggable(),$("#legendContainer").resizable()})},o.appendChild(s);const f=document.createElement("div");f.id="toggleLegend",f.innerHTML="<span>&#x2630;</span>",document.body.appendChild(f),f.addEventListener("click",function(){A.style.display==="none"?A.style.display="block":A.style.display="none"})})},o.appendChild(s)};console.log("namelegend",e,t),n()}catch(n){console.error(`Error adding legend: ${n.message}`)}}async _raiseText3DStyle(){try{const e=await this.map.loadImage(Hn.map3dOptions.imageIcon);this.map.addImage("stick",e.data),this.map.getStyle().layers.forEach(t=>{if(t["source-layer"]===Hn.map3dOptions.sourceLayerFilterId&&t.minzoom>=Hn.map3dOptions.minZoomFilter&&e){const n=t.id;this.map.setLayoutProperty(n,"icon-image","stick"),this.map.setLayoutProperty(n,"text-offset",[0,-9]),this.map.setLayoutProperty(n,"symbol-placement","point"),this.map.setLayoutProperty(n,"symbol-avoid-edges",!1),this.map.setLayoutProperty(n,"text-allow-overlap",!0),this.map.setLayoutProperty(n,"text-ignore-placement",!1),this.map.setLayoutProperty(n,"text-pitch-alignment","auto"),this.map.setLayoutProperty(n,"text-rotation-alignment","auto"),this.map.setLayoutProperty(n,"text-justify","center"),this.map.setLayoutProperty(n,"text-anchor","bottom"),this.map.setLayoutProperty(n,"icon-anchor","bottom"),this.map.setPaintProperty(n,"text-color","#ffffff"),this.map.setPaintProperty(n,"text-halo-color","#000000"),this.map.setPaintProperty(n,"text-halo-width",2)}})}catch(e){return console.error(`Error dealing orto 3D: ${e.message}`),null}}_dealOrto3dStyle(e){try{if(e=="orto3d"){this.map.setMaxZoom(18.8),this.map.easeTo({pitch:45});const t=new zT({intensity:4}),n=new Lb({ambientLight:t});this.map.setTerrain({source:Hn.map3dOptions.terrainSource,exaggeration:Hn.map3dOptions.exaggeration});const i=this._createCitiesMapboxLayer();this.map.getLayer(Hn.map3dOptions.layerId3d)||(this.map.addLayer(i,Hn.map3dOptions.layerIdOrder),this.map.setLayerZoomRange(Hn.map3dOptions.layerId3d,Hn.map3dOptions.minZoomRange,Hn.map3dOptions.maxZoomRange),i.deck.setProps({effects:[n]}),this._raiseText3DStyle())}else this.map.getLayer(Hn.map3dOptions.layerId3d)&&(this.map.removeLayer(Hn.map3dOptions.layerId3d),this.map.setTerrain(null))}catch(t){return console.error(`Error dealing orto 3D: ${t.message}`),null}}_firstSymbolLayer(){try{const e=this.map.getStyle().layers;let t;for(let n=0;n<e.length;n++)if(e[n].type==="symbol"){t=e[n].id;break}return t}catch(e){console.error(`Error getting first symbol layer: ${e.message}`)}}_firstLineLayer(){try{const e=this.map.getStyle().layers;let t;for(let n=0;n<e.length;n++)if(e[n].type==="line"){t=e[n].id;break}return t}catch(e){console.error(`Error getting first symbol layer: ${e.message}`)}}_createCitiesMapboxLayer(){try{return new MW({id:Hn.map3dOptions.layerId3d,type:e2,data:Hn.map3dOptions.urlTilesetCities,loader:Zw,loadOptions:{tileset:{viewDistanceScale:1,updateTransforms:!0,maximumScreenSpaceError:Hn.map3dOptions.spaceErrorFactor}},onTilesetLoad:t=>{t.options.maximumScreenSpaceError=Hn.map3dOptions.spaceErrorFactor},onTileLoad:t=>{t.content.cartographicOrigin.z-=Hn.map3dOptions.zfactor},operation:"terrain+draw"})}catch(e){return console.error(`Error adding MapboxLayer: ${e.message}`),null}}};var b4={exports:{}};function qre(r,e){var t=r.getCenter(),n=r.getZoom(),i=r.getBearing(),s=r.getPitch();e.forEach(function(a){a.jumpTo({center:t,zoom:n,bearing:i,pitch:s})})}function Kre(){var r,e=arguments.length;if(e===1)r=arguments[0];else{r=[];for(var t=0;t<e;t++)r.push(arguments[t])}var n=[];r.forEach(function(o,A){n[A]=a.bind(null,o,r.filter(function(f,m){return m!==A}))});function i(){r.forEach(function(o,A){o.on("move",n[A])})}function s(){r.forEach(function(o,A){o.off("move",n[A])})}function a(o,A){s(),qre(o,A),i()}return i(),function(){s(),n=[],r=[]}}var Wre=Kre;(function(r){var e=Wre,t=p4.EventEmitter;function n(i,s,a,o){if(this.options=o||{},this._mapA=i,this._mapB=s,this._horizontal=this.options.orientation==="horizontal",this._onDown=this._onDown.bind(this),this._onMove=this._onMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._ev=new t,this._swiper=document.createElement("div"),this._swiper.className=this._horizontal?"compare-swiper-horizontal":"compare-swiper-vertical",this._controlContainer=document.createElement("div"),this._controlContainer.className=this._horizontal?"maplibregl-compare maplibregl-compare-horizontal":"maplibregl-compare",this._controlContainer.className=this._controlContainer.className,this._controlContainer.appendChild(this._swiper),typeof a=="string"&&document.body.querySelectorAll){var A=document.body.querySelectorAll(a)[0];if(!A)throw new Error("Cannot find element with specified container selector.");A.appendChild(this._controlContainer)}else if(a instanceof Element&&a.appendChild)a.appendChild(this._controlContainer);else throw new Error("Invalid container specified. Must be CSS selector or HTML element.");this._bounds=s.getContainer().getBoundingClientRect();var f=(this._horizontal?this._bounds.height:this._bounds.width)/2;this._setPosition(f),this._clearSync=e(i,s),this._onResize=(function(){this._bounds=s.getContainer().getBoundingClientRect(),this.currentPosition&&this._setPosition(this.currentPosition)}).bind(this),s.on("resize",this._onResize),this.options&&this.options.mousemove&&(i.getContainer().addEventListener("mousemove",this._onMove),s.getContainer().addEventListener("mousemove",this._onMove)),this._swiper.addEventListener("mousedown",this._onDown),this._swiper.addEventListener("touchstart",this._onDown)}n.prototype={_setPointerEvents:function(i){this._controlContainer.style.pointerEvents=i,this._swiper.style.pointerEvents=i},_onDown:function(i){i.touches?(document.addEventListener("touchmove",this._onMove),document.addEventListener("touchend",this._onTouchEnd)):(document.addEventListener("mousemove",this._onMove),document.addEventListener("mouseup",this._onMouseUp))},_setPosition:function(i){i=Math.min(i,this._horizontal?this._bounds.height:this._bounds.width);var s=this._horizontal?"translate(0, "+i+"px)":"translate("+i+"px, 0)";this._controlContainer.style.transform=s,this._controlContainer.style.WebkitTransform=s;var a=this._horizontal?"rect(0, 999em, "+i+"px, 0)":"rect(0, "+i+"px, "+this._bounds.height+"px, 0)",o=this._horizontal?"rect("+i+"px, 999em, "+this._bounds.height+"px,0)":"rect(0, 999em, "+this._bounds.height+"px,"+i+"px)";this._mapA.getContainer().style.clip=a,this._mapB.getContainer().style.clip=o,this.currentPosition=i},_onMove:function(i){this.options&&this.options.mousemove&&this._setPointerEvents(i.touches?"auto":"none"),this._horizontal?this._setPosition(this._getY(i)):this._setPosition(this._getX(i))},_onMouseUp:function(){document.removeEventListener("mousemove",this._onMove),document.removeEventListener("mouseup",this._onMouseUp),this.fire("slideend",{currentPosition:this.currentPosition})},_onTouchEnd:function(){document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onTouchEnd),this.fire("slideend",{currentPosition:this.currentPosition})},_getX:function(i){i=i.touches?i.touches[0]:i;var s=i.clientX-this._bounds.left;return s<0&&(s=0),s>this._bounds.width&&(s=this._bounds.width),s},_getY:function(i){i=i.touches?i.touches[0]:i;var s=i.clientY-this._bounds.top;return s<0&&(s=0),s>this._bounds.height&&(s=this._bounds.height),s},setSlider:function(i){this._setPosition(i)},on:function(i,s){return this._ev.on(i,s),this},fire:function(i,s){return this._ev.emit(i,s),this},off:function(i,s){return this._ev.removeListener(i,s),this},remove:function(){this._clearSync(),this._mapB.off("resize",this._onResize);var i=this._mapA.getContainer();i&&(i.style.clip=null,i.removeEventListener("mousemove",this._onMove));var s=this._mapB.getContainer();s&&(s.style.clip=null,s.removeEventListener("mousemove",this._onMove)),this._swiper.removeEventListener("mousedown",this._onDown),this._swiper.removeEventListener("touchstart",this._onDown),this._controlContainer.remove()}},window.maplibregl?maplibregl.Compare=n:r.exports=n})(b4);var $re=b4.exports;const Xre=Bp($re);class Jre{constructor(e,t,n,i){this.mapCompare=new Xre(e.map,t.map,n,{})}}/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var I2=function(r,e){return I2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},I2(r,e)};function Xc(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");I2(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var L2=function(){return L2=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},L2.apply(this,arguments)};function Oo(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(m){try{f(n.next(m))}catch(v){a(v)}}function A(m){try{f(n.throw(m))}catch(v){a(v)}}function f(m){m.done?s(m.value):i(m.value).then(o,A)}f((n=n.apply(r,e||[])).next())})}function mo(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(f){return function(m){return A([f,m])}}function A(f){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return t.label++,{value:f[1],done:!1};case 5:t.label++,i=f[1],f=[0];continue;case 7:f=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){t=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){t.label=f[1];break}if(f[0]===6&&t.label<s[1]){t.label=s[1],s=f;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(f);break}s[2]&&t.ops.pop(),t.trys.pop();continue}f=e.call(r,t)}catch(m){f=[6,m],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function By(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return r.concat(s||e)}for(var Du=function(){function r(e,t,n,i){this.left=e,this.top=t,this.width=n,this.height=i}return r.prototype.add=function(e,t,n,i){return new r(this.left+e,this.top+t,this.width+n,this.height+i)},r.fromClientRect=function(e,t){return new r(t.left+e.windowBounds.left,t.top+e.windowBounds.top,t.width,t.height)},r.fromDOMRectList=function(e,t){var n=Array.from(t).find(function(i){return i.width!==0});return n?new r(n.left+e.windowBounds.left,n.top+e.windowBounds.top,n.width,n.height):r.EMPTY},r.EMPTY=new r(0,0,0,0),r}(),Cy=function(r,e){return Du.fromClientRect(r,e.getBoundingClientRect())},Yre=function(r){var e=r.body,t=r.documentElement;if(!e||!t)throw new Error("Unable to get document size");var n=Math.max(Math.max(e.scrollWidth,t.scrollWidth),Math.max(e.offsetWidth,t.offsetWidth),Math.max(e.clientWidth,t.clientWidth)),i=Math.max(Math.max(e.scrollHeight,t.scrollHeight),Math.max(e.offsetHeight,t.offsetHeight),Math.max(e.clientHeight,t.clientHeight));return new Du(0,0,n,i)},Ey=function(r){for(var e=[],t=0,n=r.length;t<n;){var i=r.charCodeAt(t++);if(i>=55296&&i<=56319&&t<n){var s=r.charCodeAt(t++);(s&64512)===56320?e.push(((i&1023)<<10)+(s&1023)+65536):(e.push(i),t--)}else e.push(i)}return e},ts=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,r);var t=r.length;if(!t)return"";for(var n=[],i=-1,s="";++i<t;){var a=r[i];a<=65535?n.push(a):(a-=65536,n.push((a>>10)+55296,a%1024+56320)),(i+1===t||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},w4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Zre=typeof Uint8Array>"u"?[]:new Uint8Array(256),Sy=0;Sy<w4.length;Sy++)Zre[w4.charCodeAt(Sy)]=Sy;for(var x4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Lg=typeof Uint8Array>"u"?[]:new Uint8Array(256),Ty=0;Ty<x4.length;Ty++)Lg[x4.charCodeAt(Ty)]=Ty;for(var ene=function(r){var e=r.length*.75,t=r.length,n,i=0,s,a,o,A;r[r.length-1]==="="&&(e--,r[r.length-2]==="="&&e--);var f=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),m=Array.isArray(f)?f:new Uint8Array(f);for(n=0;n<t;n+=4)s=Lg[r.charCodeAt(n)],a=Lg[r.charCodeAt(n+1)],o=Lg[r.charCodeAt(n+2)],A=Lg[r.charCodeAt(n+3)],m[i++]=s<<2|a>>4,m[i++]=(a&15)<<4|o>>2,m[i++]=(o&3)<<6|A&63;return f},tne=function(r){for(var e=r.length,t=[],n=0;n<e;n+=2)t.push(r[n+1]<<8|r[n]);return t},rne=function(r){for(var e=r.length,t=[],n=0;n<e;n+=4)t.push(r[n+3]<<24|r[n+2]<<16|r[n+1]<<8|r[n]);return t},qh=5,F2=11,M2=2,nne=F2-qh,B4=65536>>qh,ine=1<<qh,P2=ine-1,sne=1024>>qh,one=B4+sne,ane=one,cne=32,lne=ane+cne,une=65536>>F2,Ane=1<<nne,hne=Ane-1,C4=function(r,e,t){return r.slice?r.slice(e,t):new Uint16Array(Array.prototype.slice.call(r,e,t))},dne=function(r,e,t){return r.slice?r.slice(e,t):new Uint32Array(Array.prototype.slice.call(r,e,t))},fne=function(r,e){var t=ene(r),n=Array.isArray(t)?rne(t):new Uint32Array(t),i=Array.isArray(t)?tne(t):new Uint16Array(t),s=24,a=C4(i,s/2,n[4]/2),o=n[5]===2?C4(i,(s+n[4])/2):dne(n,Math.ceil((s+n[4])/4));return new pne(n[0],n[1],n[2],n[3],a,o)},pne=function(){function r(e,t,n,i,s,a){this.initialValue=e,this.errorValue=t,this.highStart=n,this.highValueIndex=i,this.index=s,this.data=a}return r.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=this.index[e>>qh],t=(t<<M2)+(e&P2),this.data[t];if(e<=65535)return t=this.index[B4+(e-55296>>qh)],t=(t<<M2)+(e&P2),this.data[t];if(e<this.highStart)return t=lne-une+(e>>F2),t=this.index[t],t+=e>>qh&hne,t=this.index[t],t=(t<<M2)+(e&P2),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},r}(),E4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",gne=typeof Uint8Array>"u"?[]:new Uint8Array(256),Iy=0;Iy<E4.length;Iy++)gne[E4.charCodeAt(Iy)]=Iy;var mne="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",S4=50,yne=1,T4=2,I4=3,_ne=4,vne=5,L4=7,F4=8,M4=9,QA=10,U2=11,P4=12,R2=13,bne=14,Fg=15,O2=16,Ly=17,Mg=18,wne=19,U4=20,D2=21,Pg=22,k2=23,Tf=24,ka=25,Ug=26,Rg=27,If=28,xne=29,Lf=30,Bne=31,Fy=32,My=33,N2=34,Q2=35,H2=36,Og=37,z2=38,Py=39,Uy=40,G2=41,R4=42,Cne=43,Ene=[9001,65288],O4="!",Do="",Ry="",V2=fne(mne),ku=[Lf,H2],j2=[yne,T4,I4,vne],D4=[QA,F4],k4=[Rg,Ug],Sne=j2.concat(D4),N4=[z2,Py,Uy,N2,Q2],Tne=[Fg,R2],Ine=function(r,e){e===void 0&&(e="strict");var t=[],n=[],i=[];return r.forEach(function(s,a){var o=V2.get(s);if(o>S4?(i.push(!0),o-=S4):i.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return n.push(a),t.push(O2);if(o===_ne||o===U2){if(a===0)return n.push(a),t.push(Lf);var A=t[a-1];return Sne.indexOf(A)===-1?(n.push(n[a-1]),t.push(A)):(n.push(a),t.push(Lf))}if(n.push(a),o===Bne)return t.push(e==="strict"?D2:Og);if(o===R4||o===xne)return t.push(Lf);if(o===Cne)return s>=131072&&s<=196605||s>=196608&&s<=262141?t.push(Og):t.push(Lf);t.push(o)}),[n,t,i]},q2=function(r,e,t,n){var i=n[t];if(Array.isArray(r)?r.indexOf(i)!==-1:r===i)for(var s=t;s<=n.length;){s++;var a=n[s];if(a===e)return!0;if(a!==QA)break}if(i===QA)for(var s=t;s>0;){s--;var o=n[s];if(Array.isArray(r)?r.indexOf(o)!==-1:r===o)for(var A=t;A<=n.length;){A++;var a=n[A];if(a===e)return!0;if(a!==QA)break}if(o!==QA)break}return!1},Q4=function(r,e){for(var t=r;t>=0;){var n=e[t];if(n===QA)t--;else return n}return 0},Lne=function(r,e,t,n,i){if(t[n]===0)return Do;var s=n-1;if(Array.isArray(i)&&i[s]===!0)return Do;var a=s-1,o=s+1,A=e[s],f=a>=0?e[a]:0,m=e[o];if(A===T4&&m===I4)return Do;if(j2.indexOf(A)!==-1)return O4;if(j2.indexOf(m)!==-1||D4.indexOf(m)!==-1)return Do;if(Q4(s,e)===F4)return Ry;if(V2.get(r[s])===U2||(A===Fy||A===My)&&V2.get(r[o])===U2||A===L4||m===L4||A===M4||[QA,R2,Fg].indexOf(A)===-1&&m===M4||[Ly,Mg,wne,Tf,If].indexOf(m)!==-1||Q4(s,e)===Pg||q2(k2,Pg,s,e)||q2([Ly,Mg],D2,s,e)||q2(P4,P4,s,e))return Do;if(A===QA)return Ry;if(A===k2||m===k2)return Do;if(m===O2||A===O2)return Ry;if([R2,Fg,D2].indexOf(m)!==-1||A===bne||f===H2&&Tne.indexOf(A)!==-1||A===If&&m===H2||m===U4||ku.indexOf(m)!==-1&&A===ka||ku.indexOf(A)!==-1&&m===ka||A===Rg&&[Og,Fy,My].indexOf(m)!==-1||[Og,Fy,My].indexOf(A)!==-1&&m===Ug||ku.indexOf(A)!==-1&&k4.indexOf(m)!==-1||k4.indexOf(A)!==-1&&ku.indexOf(m)!==-1||[Rg,Ug].indexOf(A)!==-1&&(m===ka||[Pg,Fg].indexOf(m)!==-1&&e[o+1]===ka)||[Pg,Fg].indexOf(A)!==-1&&m===ka||A===ka&&[ka,If,Tf].indexOf(m)!==-1)return Do;if([ka,If,Tf,Ly,Mg].indexOf(m)!==-1)for(var v=s;v>=0;){var x=e[v];if(x===ka)return Do;if([If,Tf].indexOf(x)!==-1)v--;else break}if([Rg,Ug].indexOf(m)!==-1)for(var v=[Ly,Mg].indexOf(A)!==-1?a:s;v>=0;){var x=e[v];if(x===ka)return Do;if([If,Tf].indexOf(x)!==-1)v--;else break}if(z2===A&&[z2,Py,N2,Q2].indexOf(m)!==-1||[Py,N2].indexOf(A)!==-1&&[Py,Uy].indexOf(m)!==-1||[Uy,Q2].indexOf(A)!==-1&&m===Uy||N4.indexOf(A)!==-1&&[U4,Ug].indexOf(m)!==-1||N4.indexOf(m)!==-1&&A===Rg||ku.indexOf(A)!==-1&&ku.indexOf(m)!==-1||A===Tf&&ku.indexOf(m)!==-1||ku.concat(ka).indexOf(A)!==-1&&m===Pg&&Ene.indexOf(r[o])===-1||ku.concat(ka).indexOf(m)!==-1&&A===Mg)return Do;if(A===G2&&m===G2){for(var B=t[s],M=1;B>0&&(B--,e[B]===G2);)M++;if(M%2!==0)return Do}return A===Fy&&m===My?Do:Ry},Fne=function(r,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var t=Ine(r,e.lineBreak),n=t[0],i=t[1],s=t[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(i=i.map(function(o){return[ka,Lf,R4].indexOf(o)!==-1?Og:o}));var a=e.wordBreak==="keep-all"?s.map(function(o,A){return o&&r[A]>=19968&&r[A]<=40959}):void 0;return[n,i,a]},Mne=function(){function r(e,t,n,i){this.codePoints=e,this.required=t===O4,this.start=n,this.end=i}return r.prototype.slice=function(){return ts.apply(void 0,this.codePoints.slice(this.start,this.end))},r}(),Pne=function(r,e){var t=Ey(r),n=Fne(t,e),i=n[0],s=n[1],a=n[2],o=t.length,A=0,f=0;return{next:function(){if(f>=o)return{done:!0,value:null};for(var m=Do;f<o&&(m=Lne(t,s,i,++f,a))===Do;);if(m!==Do||f===o){var v=new Mne(t,m,A,f);return A=f,{value:v,done:!1}}return{done:!0,value:null}}}},Une=1,Rne=2,Dg=4,H4=8,Oy=10,z4=47,kg=92,One=9,Dne=32,Dy=34,Ng=61,kne=35,Nne=36,Qne=37,ky=39,Ny=40,Qg=41,Hne=95,da=45,zne=33,Gne=60,Vne=62,jne=64,qne=91,Kne=93,Wne=61,$ne=123,Qy=63,Xne=125,G4=124,Jne=126,Yne=128,V4=65533,K2=42,Kh=43,Zne=44,eie=58,tie=59,Hg=46,rie=0,nie=8,iie=11,sie=14,oie=31,aie=127,Xl=-1,j4=48,q4=97,K4=101,cie=102,lie=117,uie=122,W4=65,$4=69,X4=70,Aie=85,hie=90,ko=function(r){return r>=j4&&r<=57},die=function(r){return r>=55296&&r<=57343},Ff=function(r){return ko(r)||r>=W4&&r<=X4||r>=q4&&r<=cie},fie=function(r){return r>=q4&&r<=uie},pie=function(r){return r>=W4&&r<=hie},gie=function(r){return fie(r)||pie(r)},mie=function(r){return r>=Yne},Hy=function(r){return r===Oy||r===One||r===Dne},zy=function(r){return gie(r)||mie(r)||r===Hne},J4=function(r){return zy(r)||ko(r)||r===da},yie=function(r){return r>=rie&&r<=nie||r===iie||r>=sie&&r<=oie||r===aie},HA=function(r,e){return r!==kg?!1:e!==Oy},Gy=function(r,e,t){return r===da?zy(e)||HA(e,t):zy(r)?!0:!!(r===kg&&HA(r,e))},W2=function(r,e,t){return r===Kh||r===da?ko(e)?!0:e===Hg&&ko(t):ko(r===Hg?e:r)},_ie=function(r){var e=0,t=1;(r[e]===Kh||r[e]===da)&&(r[e]===da&&(t=-1),e++);for(var n=[];ko(r[e]);)n.push(r[e++]);var i=n.length?parseInt(ts.apply(void 0,n),10):0;r[e]===Hg&&e++;for(var s=[];ko(r[e]);)s.push(r[e++]);var a=s.length,o=a?parseInt(ts.apply(void 0,s),10):0;(r[e]===$4||r[e]===K4)&&e++;var A=1;(r[e]===Kh||r[e]===da)&&(r[e]===da&&(A=-1),e++);for(var f=[];ko(r[e]);)f.push(r[e++]);var m=f.length?parseInt(ts.apply(void 0,f),10):0;return t*(i+o*Math.pow(10,-a))*Math.pow(10,A*m)},vie={type:2},bie={type:3},wie={type:4},xie={type:13},Bie={type:8},Cie={type:21},Eie={type:9},Sie={type:10},Tie={type:11},Iie={type:12},Lie={type:14},Vy={type:23},Fie={type:1},Mie={type:25},Pie={type:24},Uie={type:26},Rie={type:27},Oie={type:28},Die={type:29},kie={type:31},$2={type:32},Y4=function(){function r(){this._value=[]}return r.prototype.write=function(e){this._value=this._value.concat(Ey(e))},r.prototype.read=function(){for(var e=[],t=this.consumeToken();t!==$2;)e.push(t),t=this.consumeToken();return e},r.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case Dy:return this.consumeStringToken(Dy);case kne:var t=this.peekCodePoint(0),n=this.peekCodePoint(1),i=this.peekCodePoint(2);if(J4(t)||HA(n,i)){var s=Gy(t,n,i)?Rne:Une,a=this.consumeName();return{type:5,value:a,flags:s}}break;case Nne:if(this.peekCodePoint(0)===Ng)return this.consumeCodePoint(),xie;break;case ky:return this.consumeStringToken(ky);case Ny:return vie;case Qg:return bie;case K2:if(this.peekCodePoint(0)===Ng)return this.consumeCodePoint(),Lie;break;case Kh:if(W2(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case Zne:return wie;case da:var o=e,A=this.peekCodePoint(0),f=this.peekCodePoint(1);if(W2(o,A,f))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(Gy(o,A,f))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(A===da&&f===Vne)return this.consumeCodePoint(),this.consumeCodePoint(),Pie;break;case Hg:if(W2(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case z4:if(this.peekCodePoint(0)===K2)for(this.consumeCodePoint();;){var m=this.consumeCodePoint();if(m===K2&&(m=this.consumeCodePoint(),m===z4))return this.consumeToken();if(m===Xl)return this.consumeToken()}break;case eie:return Uie;case tie:return Rie;case Gne:if(this.peekCodePoint(0)===zne&&this.peekCodePoint(1)===da&&this.peekCodePoint(2)===da)return this.consumeCodePoint(),this.consumeCodePoint(),Mie;break;case jne:var v=this.peekCodePoint(0),x=this.peekCodePoint(1),B=this.peekCodePoint(2);if(Gy(v,x,B)){var a=this.consumeName();return{type:7,value:a}}break;case qne:return Oie;case kg:if(HA(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case Kne:return Die;case Wne:if(this.peekCodePoint(0)===Ng)return this.consumeCodePoint(),Bie;break;case $ne:return Tie;case Xne:return Iie;case lie:case Aie:var M=this.peekCodePoint(0),U=this.peekCodePoint(1);return M===Kh&&(Ff(U)||U===Qy)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case G4:if(this.peekCodePoint(0)===Ng)return this.consumeCodePoint(),Eie;if(this.peekCodePoint(0)===G4)return this.consumeCodePoint(),Cie;break;case Jne:if(this.peekCodePoint(0)===Ng)return this.consumeCodePoint(),Sie;break;case Xl:return $2}return Hy(e)?(this.consumeWhiteSpace(),kie):ko(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):zy(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:ts(e)}},r.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},r.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},r.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},r.prototype.consumeUnicodeRangeToken=function(){for(var e=[],t=this.consumeCodePoint();Ff(t)&&e.length<6;)e.push(t),t=this.consumeCodePoint();for(var n=!1;t===Qy&&e.length<6;)e.push(t),t=this.consumeCodePoint(),n=!0;if(n){var i=parseInt(ts.apply(void 0,e.map(function(A){return A===Qy?j4:A})),16),s=parseInt(ts.apply(void 0,e.map(function(A){return A===Qy?X4:A})),16);return{type:30,start:i,end:s}}var a=parseInt(ts.apply(void 0,e),16);if(this.peekCodePoint(0)===da&&Ff(this.peekCodePoint(1))){this.consumeCodePoint(),t=this.consumeCodePoint();for(var o=[];Ff(t)&&o.length<6;)o.push(t),t=this.consumeCodePoint();var s=parseInt(ts.apply(void 0,o),16);return{type:30,start:a,end:s}}else return{type:30,start:a,end:a}},r.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===Ny?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Ny?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},r.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Xl)return{type:22,value:""};var t=this.peekCodePoint(0);if(t===ky||t===Dy){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Xl||this.peekCodePoint(0)===Qg)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),Vy)}for(;;){var i=this.consumeCodePoint();if(i===Xl||i===Qg)return{type:22,value:ts.apply(void 0,e)};if(Hy(i))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Xl||this.peekCodePoint(0)===Qg?(this.consumeCodePoint(),{type:22,value:ts.apply(void 0,e)}):(this.consumeBadUrlRemnants(),Vy);if(i===Dy||i===ky||i===Ny||yie(i))return this.consumeBadUrlRemnants(),Vy;if(i===kg)if(HA(i,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Vy;else e.push(i)}},r.prototype.consumeWhiteSpace=function(){for(;Hy(this.peekCodePoint(0));)this.consumeCodePoint()},r.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===Qg||e===Xl)return;HA(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},r.prototype.consumeStringSlice=function(e){for(var t=5e4,n="";e>0;){var i=Math.min(t,e);n+=ts.apply(void 0,this._value.splice(0,i)),e-=i}return this._value.shift(),n},r.prototype.consumeStringToken=function(e){var t="",n=0;do{var i=this._value[n];if(i===Xl||i===void 0||i===e)return t+=this.consumeStringSlice(n),{type:0,value:t};if(i===Oy)return this._value.splice(0,n),Fie;if(i===kg){var s=this._value[n+1];s!==Xl&&s!==void 0&&(s===Oy?(t+=this.consumeStringSlice(n),n=-1,this._value.shift()):HA(i,s)&&(t+=this.consumeStringSlice(n),t+=ts(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},r.prototype.consumeNumber=function(){var e=[],t=Dg,n=this.peekCodePoint(0);for((n===Kh||n===da)&&e.push(this.consumeCodePoint());ko(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0);var i=this.peekCodePoint(1);if(n===Hg&&ko(i))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=H4;ko(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0),i=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((n===$4||n===K4)&&((i===Kh||i===da)&&ko(s)||ko(i)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=H4;ko(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[_ie(e),t]},r.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),t=e[0],n=e[1],i=this.peekCodePoint(0),s=this.peekCodePoint(1),a=this.peekCodePoint(2);if(Gy(i,s,a)){var o=this.consumeName();return{type:15,number:t,flags:n,unit:o}}return i===Qne?(this.consumeCodePoint(),{type:16,number:t,flags:n}):{type:17,number:t,flags:n}},r.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(Ff(e)){for(var t=ts(e);Ff(this.peekCodePoint(0))&&t.length<6;)t+=ts(this.consumeCodePoint());Hy(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(t,16);return n===0||die(n)||n>1114111?V4:n}return e===Xl?V4:e},r.prototype.consumeName=function(){for(var e="";;){var t=this.consumeCodePoint();if(J4(t))e+=ts(t);else if(HA(t,this.peekCodePoint(0)))e+=ts(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(t),e}},r}(),Z4=function(){function r(e){this._tokens=e}return r.create=function(e){var t=new Y4;return t.write(e),new r(t.read())},r.parseValue=function(e){return r.create(e).parseComponentValue()},r.parseValues=function(e){return r.create(e).parseComponentValues()},r.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var t=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return t;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},r.prototype.parseComponentValues=function(){for(var e=[];;){var t=this.consumeComponentValue();if(t.type===32)return e;e.push(t),e.push()}},r.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},r.prototype.consumeSimpleBlock=function(e){for(var t={type:e,values:[]},n=this.consumeToken();;){if(n.type===32||Qie(n,e))return t;this.reconsumeToken(n),t.values.push(this.consumeComponentValue()),n=this.consumeToken()}},r.prototype.consumeFunction=function(e){for(var t={name:e.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return t;this.reconsumeToken(n),t.values.push(this.consumeComponentValue())}},r.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?$2:e},r.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},r}(),zg=function(r){return r.type===15},Mf=function(r){return r.type===17},ii=function(r){return r.type===20},Nie=function(r){return r.type===0},X2=function(r,e){return ii(r)&&r.value===e},eM=function(r){return r.type!==31},Pf=function(r){return r.type!==31&&r.type!==4},Jl=function(r){var e=[],t=[];return r.forEach(function(n){if(n.type===4){if(t.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(t),t=[];return}n.type!==31&&t.push(n)}),t.length&&e.push(t),e},Qie=function(r,e){return e===11&&r.type===12||e===28&&r.type===29?!0:e===2&&r.type===3},zA=function(r){return r.type===17||r.type===15},ms=function(r){return r.type===16||zA(r)},tM=function(r){return r.length>1?[r[0],r[1]]:[r[0]]},Ws={type:17,number:0,flags:Dg},J2={type:16,number:50,flags:Dg},GA={type:16,number:100,flags:Dg},Gg=function(r,e,t){var n=r[0],i=r[1];return[mi(n,e),mi(typeof i<"u"?i:n,t)]},mi=function(r,e){if(r.type===16)return r.number/100*e;if(zg(r))switch(r.unit){case"rem":case"em":return 16*r.number;case"px":default:return r.number}return r.number},rM="deg",nM="grad",iM="rad",sM="turn",jy={name:"angle",parse:function(r,e){if(e.type===15)switch(e.unit){case rM:return Math.PI*e.number/180;case nM:return Math.PI/200*e.number;case iM:return e.number;case sM:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},oM=function(r){return r.type===15&&(r.unit===rM||r.unit===nM||r.unit===iM||r.unit===sM)},aM=function(r){var e=r.filter(ii).map(function(t){return t.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Ws,Ws];case"to top":case"bottom":return cc(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Ws,GA];case"to right":case"left":return cc(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[GA,GA];case"to bottom":case"top":return cc(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[GA,Ws];case"to left":case"right":return cc(270)}return 0},cc=function(r){return Math.PI*r/180},VA={name:"color",parse:function(r,e){if(e.type===18){var t=Hie[e.name];if(typeof t>"u")throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return t(r,e.values)}if(e.type===5){if(e.value.length===3){var n=e.value.substring(0,1),i=e.value.substring(1,2),s=e.value.substring(2,3);return qA(parseInt(n+n,16),parseInt(i+i,16),parseInt(s+s,16),1)}if(e.value.length===4){var n=e.value.substring(0,1),i=e.value.substring(1,2),s=e.value.substring(2,3),a=e.value.substring(3,4);return qA(parseInt(n+n,16),parseInt(i+i,16),parseInt(s+s,16),parseInt(a+a,16)/255)}if(e.value.length===6){var n=e.value.substring(0,2),i=e.value.substring(2,4),s=e.value.substring(4,6);return qA(parseInt(n,16),parseInt(i,16),parseInt(s,16),1)}if(e.value.length===8){var n=e.value.substring(0,2),i=e.value.substring(2,4),s=e.value.substring(4,6),a=e.value.substring(6,8);return qA(parseInt(n,16),parseInt(i,16),parseInt(s,16),parseInt(a,16)/255)}}if(e.type===20){var o=Nu[e.value.toUpperCase()];if(typeof o<"u")return o}return Nu.TRANSPARENT}},jA=function(r){return(255&r)===0},Us=function(r){var e=255&r,t=255&r>>8,n=255&r>>16,i=255&r>>24;return e<255?"rgba("+i+","+n+","+t+","+e/255+")":"rgb("+i+","+n+","+t+")"},qA=function(r,e,t,n){return(r<<24|e<<16|t<<8|Math.round(n*255)<<0)>>>0},cM=function(r,e){if(r.type===17)return r.number;if(r.type===16){var t=e===3?1:255;return e===3?r.number/100*t:Math.round(r.number/100*t)}return 0},lM=function(r,e){var t=e.filter(Pf);if(t.length===3){var n=t.map(cM),i=n[0],s=n[1],a=n[2];return qA(i,s,a,1)}if(t.length===4){var o=t.map(cM),i=o[0],s=o[1],a=o[2],A=o[3];return qA(i,s,a,A)}return 0};function Y2(r,e,t){return t<0&&(t+=1),t>=1&&(t-=1),t<1/6?(e-r)*t*6+r:t<1/2?e:t<2/3?(e-r)*6*(2/3-t)+r:r}var uM=function(r,e){var t=e.filter(Pf),n=t[0],i=t[1],s=t[2],a=t[3],o=(n.type===17?cc(n.number):jy.parse(r,n))/(Math.PI*2),A=ms(i)?i.number/100:0,f=ms(s)?s.number/100:0,m=typeof a<"u"&&ms(a)?mi(a,1):1;if(A===0)return qA(f*255,f*255,f*255,1);var v=f<=.5?f*(A+1):f+A-f*A,x=f*2-v,B=Y2(x,v,o+1/3),M=Y2(x,v,o),U=Y2(x,v,o-1/3);return qA(B*255,M*255,U*255,m)},Hie={hsl:uM,hsla:uM,rgb:lM,rgba:lM},Vg=function(r,e){return VA.parse(r,Z4.create(e).parseComponentValue())},Nu={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},zie={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(r,e){return e.map(function(t){if(ii(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Gie={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},qy=function(r,e){var t=VA.parse(r,e[0]),n=e[1];return n&&ms(n)?{color:t,stop:n}:{color:t,stop:null}},AM=function(r,e){var t=r[0],n=r[r.length-1];t.stop===null&&(t.stop=Ws),n.stop===null&&(n.stop=GA);for(var i=[],s=0,a=0;a<r.length;a++){var o=r[a].stop;if(o!==null){var A=mi(o,e);A>s?i.push(A):i.push(s),s=A}else i.push(null)}for(var f=null,a=0;a<i.length;a++){var m=i[a];if(m===null)f===null&&(f=a);else if(f!==null){for(var v=a-f,x=i[f-1],B=(m-x)/(v+1),M=1;M<=v;M++)i[f+M-1]=B*M;f=null}}return r.map(function(U,N){var Q=U.color;return{color:Q,stop:Math.max(Math.min(1,i[N]/e),0)}})},Vie=function(r,e,t){var n=e/2,i=t/2,s=mi(r[0],e)-n,a=i-mi(r[1],t);return(Math.atan2(a,s)+Math.PI*2)%(Math.PI*2)},jie=function(r,e,t){var n=typeof r=="number"?r:Vie(r,e,t),i=Math.abs(e*Math.sin(n))+Math.abs(t*Math.cos(n)),s=e/2,a=t/2,o=i/2,A=Math.sin(n-Math.PI/2)*o,f=Math.cos(n-Math.PI/2)*o;return[i,s-f,s+f,a-A,a+A]},Jc=function(r,e){return Math.sqrt(r*r+e*e)},hM=function(r,e,t,n,i){var s=[[0,0],[0,e],[r,0],[r,e]];return s.reduce(function(a,o){var A=o[0],f=o[1],m=Jc(t-A,n-f);return(i?m<a.optimumDistance:m>a.optimumDistance)?{optimumCorner:o,optimumDistance:m}:a},{optimumDistance:i?1/0:-1/0,optimumCorner:null}).optimumCorner},qie=function(r,e,t,n,i){var s=0,a=0;switch(r.size){case 0:r.shape===0?s=a=Math.min(Math.abs(e),Math.abs(e-n),Math.abs(t),Math.abs(t-i)):r.shape===1&&(s=Math.min(Math.abs(e),Math.abs(e-n)),a=Math.min(Math.abs(t),Math.abs(t-i)));break;case 2:if(r.shape===0)s=a=Math.min(Jc(e,t),Jc(e,t-i),Jc(e-n,t),Jc(e-n,t-i));else if(r.shape===1){var o=Math.min(Math.abs(t),Math.abs(t-i))/Math.min(Math.abs(e),Math.abs(e-n)),A=hM(n,i,e,t,!0),f=A[0],m=A[1];s=Jc(f-e,(m-t)/o),a=o*s}break;case 1:r.shape===0?s=a=Math.max(Math.abs(e),Math.abs(e-n),Math.abs(t),Math.abs(t-i)):r.shape===1&&(s=Math.max(Math.abs(e),Math.abs(e-n)),a=Math.max(Math.abs(t),Math.abs(t-i)));break;case 3:if(r.shape===0)s=a=Math.max(Jc(e,t),Jc(e,t-i),Jc(e-n,t),Jc(e-n,t-i));else if(r.shape===1){var o=Math.max(Math.abs(t),Math.abs(t-i))/Math.max(Math.abs(e),Math.abs(e-n)),v=hM(n,i,e,t,!1),f=v[0],m=v[1];s=Jc(f-e,(m-t)/o),a=o*s}break}return Array.isArray(r.size)&&(s=mi(r.size[0],n),a=r.size.length===2?mi(r.size[1],i):s),[s,a]},Kie=function(r,e){var t=cc(180),n=[];return Jl(e).forEach(function(i,s){if(s===0){var a=i[0];if(a.type===20&&a.value==="to"){t=aM(i);return}else if(oM(a)){t=jy.parse(r,a);return}}var o=qy(r,i);n.push(o)}),{angle:t,stops:n,type:1}},Ky=function(r,e){var t=cc(180),n=[];return Jl(e).forEach(function(i,s){if(s===0){var a=i[0];if(a.type===20&&["top","left","right","bottom"].indexOf(a.value)!==-1){t=aM(i);return}else if(oM(a)){t=(jy.parse(r,a)+cc(270))%cc(360);return}}var o=qy(r,i);n.push(o)}),{angle:t,stops:n,type:1}},Wie=function(r,e){var t=cc(180),n=[],i=1,s=0,a=3,o=[];return Jl(e).forEach(function(A,f){var m=A[0];if(f===0){if(ii(m)&&m.value==="linear"){i=1;return}else if(ii(m)&&m.value==="radial"){i=2;return}}if(m.type===18){if(m.name==="from"){var v=VA.parse(r,m.values[0]);n.push({stop:Ws,color:v})}else if(m.name==="to"){var v=VA.parse(r,m.values[0]);n.push({stop:GA,color:v})}else if(m.name==="color-stop"){var x=m.values.filter(Pf);if(x.length===2){var v=VA.parse(r,x[1]),B=x[0];Mf(B)&&n.push({stop:{type:16,number:B.number*100,flags:B.flags},color:v})}}}}),i===1?{angle:(t+cc(180))%cc(360),stops:n,type:i}:{size:a,shape:s,stops:n,position:o,type:i}},dM="closest-side",fM="farthest-side",pM="closest-corner",gM="farthest-corner",mM="circle",yM="ellipse",_M="cover",vM="contain",$ie=function(r,e){var t=0,n=3,i=[],s=[];return Jl(e).forEach(function(a,o){var A=!0;if(o===0){var f=!1;A=a.reduce(function(v,x){if(f)if(ii(x))switch(x.value){case"center":return s.push(J2),v;case"top":case"left":return s.push(Ws),v;case"right":case"bottom":return s.push(GA),v}else(ms(x)||zA(x))&&s.push(x);else if(ii(x))switch(x.value){case mM:return t=0,!1;case yM:return t=1,!1;case"at":return f=!0,!1;case dM:return n=0,!1;case _M:case fM:return n=1,!1;case vM:case pM:return n=2,!1;case gM:return n=3,!1}else if(zA(x)||ms(x))return Array.isArray(n)||(n=[]),n.push(x),!1;return v},A)}if(A){var m=qy(r,a);i.push(m)}}),{size:n,shape:t,stops:i,position:s,type:2}},Wy=function(r,e){var t=0,n=3,i=[],s=[];return Jl(e).forEach(function(a,o){var A=!0;if(o===0?A=a.reduce(function(m,v){if(ii(v))switch(v.value){case"center":return s.push(J2),!1;case"top":case"left":return s.push(Ws),!1;case"right":case"bottom":return s.push(GA),!1}else if(ms(v)||zA(v))return s.push(v),!1;return m},A):o===1&&(A=a.reduce(function(m,v){if(ii(v))switch(v.value){case mM:return t=0,!1;case yM:return t=1,!1;case vM:case dM:return n=0,!1;case fM:return n=1,!1;case pM:return n=2,!1;case _M:case gM:return n=3,!1}else if(zA(v)||ms(v))return Array.isArray(n)||(n=[]),n.push(v),!1;return m},A)),A){var f=qy(r,a);i.push(f)}}),{size:n,shape:t,stops:i,position:s,type:2}},Xie=function(r){return r.type===1},Jie=function(r){return r.type===2},Z2={name:"image",parse:function(r,e){if(e.type===22){var t={url:e.value,type:0};return r.cache.addImage(e.value),t}if(e.type===18){var n=bM[e.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return n(r,e.values)}throw new Error("Unsupported image type "+e.type)}};function Yie(r){return!(r.type===20&&r.value==="none")&&(r.type!==18||!!bM[r.name])}var bM={"linear-gradient":Kie,"-moz-linear-gradient":Ky,"-ms-linear-gradient":Ky,"-o-linear-gradient":Ky,"-webkit-linear-gradient":Ky,"radial-gradient":$ie,"-moz-radial-gradient":Wy,"-ms-radial-gradient":Wy,"-o-radial-gradient":Wy,"-webkit-radial-gradient":Wy,"-webkit-gradient":Wie},Zie={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(r,e){if(e.length===0)return[];var t=e[0];return t.type===20&&t.value==="none"?[]:e.filter(function(n){return Pf(n)&&Yie(n)}).map(function(n){return Z2.parse(r,n)})}},ese={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(r,e){return e.map(function(t){if(ii(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},tse={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(r,e){return Jl(e).map(function(t){return t.filter(ms)}).map(tM)}},rse={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(r,e){return Jl(e).map(function(t){return t.filter(ii).map(function(n){return n.value}).join(" ")}).map(nse)}},nse=function(r){switch(r){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},Uf;(function(r){r.AUTO="auto",r.CONTAIN="contain",r.COVER="cover"})(Uf||(Uf={}));var ise={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(r,e){return Jl(e).map(function(t){return t.filter(sse)})}},sse=function(r){return ii(r)||ms(r)},$y=function(r){return{name:"border-"+r+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},ose=$y("top"),ase=$y("right"),cse=$y("bottom"),lse=$y("left"),Xy=function(r){return{name:"border-radius-"+r,initialValue:"0 0",prefix:!1,type:1,parse:function(e,t){return tM(t.filter(ms))}}},use=Xy("top-left"),Ase=Xy("top-right"),hse=Xy("bottom-right"),dse=Xy("bottom-left"),Jy=function(r){return{name:"border-"+r+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,t){switch(t){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},fse=Jy("top"),pse=Jy("right"),gse=Jy("bottom"),mse=Jy("left"),Yy=function(r){return{name:"border-"+r+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return zg(t)?t.number:0}}},yse=Yy("top"),_se=Yy("right"),vse=Yy("bottom"),bse=Yy("left"),wse={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},xse={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(r,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},Bse={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(r,e){return e.filter(ii).reduce(function(t,n){return t|Cse(n.value)},0)}},Cse=function(r){switch(r){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Ese={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(r,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Sse={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(r,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},Zy;(function(r){r.NORMAL="normal",r.STRICT="strict"})(Zy||(Zy={}));var Tse={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(r,e){switch(e){case"strict":return Zy.STRICT;case"normal":default:return Zy.NORMAL}}},Ise={name:"line-height",initialValue:"normal",prefix:!1,type:4},wM=function(r,e){return ii(r)&&r.value==="normal"?1.2*e:r.type===17?e*r.number:ms(r)?mi(r,e):e},Lse={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(r,e){return e.type===20&&e.value==="none"?null:Z2.parse(r,e)}},Fse={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(r,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},ex={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(r,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},e1=function(r){return{name:"margin-"+r,initialValue:"0",prefix:!1,type:4}},Mse=e1("top"),Pse=e1("right"),Use=e1("bottom"),Rse=e1("left"),Ose={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(r,e){return e.filter(ii).map(function(t){switch(t.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},Dse={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(r,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},t1=function(r){return{name:"padding-"+r,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},kse=t1("top"),Nse=t1("right"),Qse=t1("bottom"),Hse=t1("left"),zse={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(r,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},Gse={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(r,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},Vse={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(r,e){return e.length===1&&X2(e[0],"none")?[]:Jl(e).map(function(t){for(var n={color:Nu.TRANSPARENT,offsetX:Ws,offsetY:Ws,blur:Ws},i=0,s=0;s<t.length;s++){var a=t[s];zA(a)?(i===0?n.offsetX=a:i===1?n.offsetY=a:n.blur=a,i++):n.color=VA.parse(r,a)}return n})}},jse={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(r,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},qse={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(r,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var t=$se[e.name];if(typeof t>"u")throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return t(e.values)}return null}},Kse=function(r){var e=r.filter(function(t){return t.type===17}).map(function(t){return t.number});return e.length===6?e:null},Wse=function(r){var e=r.filter(function(A){return A.type===17}).map(function(A){return A.number}),t=e[0],n=e[1];e[2],e[3];var i=e[4],s=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var a=e[12],o=e[13];return e[14],e[15],e.length===16?[t,n,i,s,a,o]:null},$se={matrix:Kse,matrix3d:Wse},xM={type:16,number:50,flags:Dg},Xse=[xM,xM],Jse={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(r,e){var t=e.filter(ms);return t.length!==2?Xse:[t[0],t[1]]}},Yse={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(r,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},jg;(function(r){r.NORMAL="normal",r.BREAK_ALL="break-all",r.KEEP_ALL="keep-all"})(jg||(jg={}));for(var Zse={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(r,e){switch(e){case"break-all":return jg.BREAK_ALL;case"keep-all":return jg.KEEP_ALL;case"normal":default:return jg.NORMAL}}},eoe={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(r,e){if(e.type===20)return{auto:!0,order:0};if(Mf(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},BM={name:"time",parse:function(r,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},toe={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(r,e){return Mf(e)?e.number:1}},roe={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},noe={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(r,e){return e.filter(ii).map(function(t){switch(t.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(t){return t!==0})}},ioe={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(r,e){var t=[],n=[];return e.forEach(function(i){switch(i.type){case 20:case 0:t.push(i.value);break;case 17:t.push(i.number.toString());break;case 4:n.push(t.join(" ")),t.length=0;break}}),t.length&&n.push(t.join(" ")),n.map(function(i){return i.indexOf(" ")===-1?i:"'"+i+"'"})}},soe={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},ooe={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(r,e){if(Mf(e))return e.number;if(ii(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},aoe={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(r,e){return e.filter(ii).map(function(t){return t.value})}},coe={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(r,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},Bs=function(r,e){return(r&e)!==0},loe={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(r,e){if(e.length===0)return[];var t=e[0];return t.type===20&&t.value==="none"?[]:e}},uoe={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(r,e){if(e.length===0)return null;var t=e[0];if(t.type===20&&t.value==="none")return null;for(var n=[],i=e.filter(eM),s=0;s<i.length;s++){var a=i[s],o=i[s+1];if(a.type===20){var A=o&&Mf(o)?o.number:1;n.push({counter:a.value,increment:A})}}return n}},Aoe={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(r,e){if(e.length===0)return[];for(var t=[],n=e.filter(eM),i=0;i<n.length;i++){var s=n[i],a=n[i+1];if(ii(s)&&s.value!=="none"){var o=a&&Mf(a)?a.number:0;t.push({counter:s.value,reset:o})}}return t}},hoe={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(r,e){return e.filter(zg).map(function(t){return BM.parse(r,t)})}},doe={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(r,e){if(e.length===0)return null;var t=e[0];if(t.type===20&&t.value==="none")return null;var n=[],i=e.filter(Nie);if(i.length%2!==0)return null;for(var s=0;s<i.length;s+=2){var a=i[s].value,o=i[s+1].value;n.push({open:a,close:o})}return n}},CM=function(r,e,t){if(!r)return"";var n=r[Math.min(e,r.length-1)];return n?t?n.open:n.close:""},foe={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(r,e){return e.length===1&&X2(e[0],"none")?[]:Jl(e).map(function(t){for(var n={color:255,offsetX:Ws,offsetY:Ws,blur:Ws,spread:Ws,inset:!1},i=0,s=0;s<t.length;s++){var a=t[s];X2(a,"inset")?n.inset=!0:zA(a)?(i===0?n.offsetX=a:i===1?n.offsetY=a:i===2?n.blur=a:n.spread=a,i++):n.color=VA.parse(r,a)}return n})}},poe={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(r,e){var t=[0,1,2],n=[];return e.filter(ii).forEach(function(i){switch(i.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),t.forEach(function(i){n.indexOf(i)===-1&&n.push(i)}),n}},goe={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},moe={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(r,e){return zg(e)?e.number:0}},yoe=function(){function r(e,t){var n,i;this.animationDuration=fr(e,hoe,t.animationDuration),this.backgroundClip=fr(e,zie,t.backgroundClip),this.backgroundColor=fr(e,Gie,t.backgroundColor),this.backgroundImage=fr(e,Zie,t.backgroundImage),this.backgroundOrigin=fr(e,ese,t.backgroundOrigin),this.backgroundPosition=fr(e,tse,t.backgroundPosition),this.backgroundRepeat=fr(e,rse,t.backgroundRepeat),this.backgroundSize=fr(e,ise,t.backgroundSize),this.borderTopColor=fr(e,ose,t.borderTopColor),this.borderRightColor=fr(e,ase,t.borderRightColor),this.borderBottomColor=fr(e,cse,t.borderBottomColor),this.borderLeftColor=fr(e,lse,t.borderLeftColor),this.borderTopLeftRadius=fr(e,use,t.borderTopLeftRadius),this.borderTopRightRadius=fr(e,Ase,t.borderTopRightRadius),this.borderBottomRightRadius=fr(e,hse,t.borderBottomRightRadius),this.borderBottomLeftRadius=fr(e,dse,t.borderBottomLeftRadius),this.borderTopStyle=fr(e,fse,t.borderTopStyle),this.borderRightStyle=fr(e,pse,t.borderRightStyle),this.borderBottomStyle=fr(e,gse,t.borderBottomStyle),this.borderLeftStyle=fr(e,mse,t.borderLeftStyle),this.borderTopWidth=fr(e,yse,t.borderTopWidth),this.borderRightWidth=fr(e,_se,t.borderRightWidth),this.borderBottomWidth=fr(e,vse,t.borderBottomWidth),this.borderLeftWidth=fr(e,bse,t.borderLeftWidth),this.boxShadow=fr(e,foe,t.boxShadow),this.color=fr(e,wse,t.color),this.direction=fr(e,xse,t.direction),this.display=fr(e,Bse,t.display),this.float=fr(e,Ese,t.cssFloat),this.fontFamily=fr(e,ioe,t.fontFamily),this.fontSize=fr(e,soe,t.fontSize),this.fontStyle=fr(e,coe,t.fontStyle),this.fontVariant=fr(e,aoe,t.fontVariant),this.fontWeight=fr(e,ooe,t.fontWeight),this.letterSpacing=fr(e,Sse,t.letterSpacing),this.lineBreak=fr(e,Tse,t.lineBreak),this.lineHeight=fr(e,Ise,t.lineHeight),this.listStyleImage=fr(e,Lse,t.listStyleImage),this.listStylePosition=fr(e,Fse,t.listStylePosition),this.listStyleType=fr(e,ex,t.listStyleType),this.marginTop=fr(e,Mse,t.marginTop),this.marginRight=fr(e,Pse,t.marginRight),this.marginBottom=fr(e,Use,t.marginBottom),this.marginLeft=fr(e,Rse,t.marginLeft),this.opacity=fr(e,toe,t.opacity);var s=fr(e,Ose,t.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=fr(e,Dse,t.overflowWrap),this.paddingTop=fr(e,kse,t.paddingTop),this.paddingRight=fr(e,Nse,t.paddingRight),this.paddingBottom=fr(e,Qse,t.paddingBottom),this.paddingLeft=fr(e,Hse,t.paddingLeft),this.paintOrder=fr(e,poe,t.paintOrder),this.position=fr(e,Gse,t.position),this.textAlign=fr(e,zse,t.textAlign),this.textDecorationColor=fr(e,roe,(n=t.textDecorationColor)!==null&&n!==void 0?n:t.color),this.textDecorationLine=fr(e,noe,(i=t.textDecorationLine)!==null&&i!==void 0?i:t.textDecoration),this.textShadow=fr(e,Vse,t.textShadow),this.textTransform=fr(e,jse,t.textTransform),this.transform=fr(e,qse,t.transform),this.transformOrigin=fr(e,Jse,t.transformOrigin),this.visibility=fr(e,Yse,t.visibility),this.webkitTextStrokeColor=fr(e,goe,t.webkitTextStrokeColor),this.webkitTextStrokeWidth=fr(e,moe,t.webkitTextStrokeWidth),this.wordBreak=fr(e,Zse,t.wordBreak),this.zIndex=fr(e,eoe,t.zIndex)}return r.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},r.prototype.isTransparent=function(){return jA(this.backgroundColor)},r.prototype.isTransformed=function(){return this.transform!==null},r.prototype.isPositioned=function(){return this.position!==0},r.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},r.prototype.isFloating=function(){return this.float!==0},r.prototype.isInlineLevel=function(){return Bs(this.display,4)||Bs(this.display,33554432)||Bs(this.display,268435456)||Bs(this.display,536870912)||Bs(this.display,67108864)||Bs(this.display,134217728)},r}(),_oe=function(){function r(e,t){this.content=fr(e,loe,t.content),this.quotes=fr(e,doe,t.quotes)}return r}(),EM=function(){function r(e,t){this.counterIncrement=fr(e,uoe,t.counterIncrement),this.counterReset=fr(e,Aoe,t.counterReset)}return r}(),fr=function(r,e,t){var n=new Y4,i=t!==null&&typeof t<"u"?t.toString():e.initialValue;n.write(i);var s=new Z4(n.read());switch(e.type){case 2:var a=s.parseComponentValue();return e.parse(r,ii(a)?a.value:e.initialValue);case 0:return e.parse(r,s.parseComponentValue());case 1:return e.parse(r,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(e.format){case"angle":return jy.parse(r,s.parseComponentValue());case"color":return VA.parse(r,s.parseComponentValue());case"image":return Z2.parse(r,s.parseComponentValue());case"length":var o=s.parseComponentValue();return zA(o)?o:Ws;case"length-percentage":var A=s.parseComponentValue();return ms(A)?A:Ws;case"time":return BM.parse(r,s.parseComponentValue())}break}},voe="data-html2canvas-debug",boe=function(r){var e=r.getAttribute(voe);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},tx=function(r,e){var t=boe(r);return t===1||e===t},Yl=function(){function r(e,t){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,tx(t,3))debugger;this.styles=new yoe(e,window.getComputedStyle(t,null)),fx(t)&&(this.styles.animationDuration.some(function(n){return n>0})&&(t.style.animationDuration="0s"),this.styles.transform!==null&&(t.style.transform="none")),this.bounds=Cy(this.context,t),tx(t,4)&&(this.flags|=16)}return r}(),woe="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",SM="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",qg=typeof Uint8Array>"u"?[]:new Uint8Array(256),r1=0;r1<SM.length;r1++)qg[SM.charCodeAt(r1)]=r1;for(var xoe=function(r){var e=r.length*.75,t=r.length,n,i=0,s,a,o,A;r[r.length-1]==="="&&(e--,r[r.length-2]==="="&&e--);var f=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),m=Array.isArray(f)?f:new Uint8Array(f);for(n=0;n<t;n+=4)s=qg[r.charCodeAt(n)],a=qg[r.charCodeAt(n+1)],o=qg[r.charCodeAt(n+2)],A=qg[r.charCodeAt(n+3)],m[i++]=s<<2|a>>4,m[i++]=(a&15)<<4|o>>2,m[i++]=(o&3)<<6|A&63;return f},Boe=function(r){for(var e=r.length,t=[],n=0;n<e;n+=2)t.push(r[n+1]<<8|r[n]);return t},Coe=function(r){for(var e=r.length,t=[],n=0;n<e;n+=4)t.push(r[n+3]<<24|r[n+2]<<16|r[n+1]<<8|r[n]);return t},Wh=5,rx=11,nx=2,Eoe=rx-Wh,TM=65536>>Wh,Soe=1<<Wh,ix=Soe-1,Toe=1024>>Wh,Ioe=TM+Toe,Loe=Ioe,Foe=32,Moe=Loe+Foe,Poe=65536>>rx,Uoe=1<<Eoe,Roe=Uoe-1,IM=function(r,e,t){return r.slice?r.slice(e,t):new Uint16Array(Array.prototype.slice.call(r,e,t))},Ooe=function(r,e,t){return r.slice?r.slice(e,t):new Uint32Array(Array.prototype.slice.call(r,e,t))},Doe=function(r,e){var t=xoe(r),n=Array.isArray(t)?Coe(t):new Uint32Array(t),i=Array.isArray(t)?Boe(t):new Uint16Array(t),s=24,a=IM(i,s/2,n[4]/2),o=n[5]===2?IM(i,(s+n[4])/2):Ooe(n,Math.ceil((s+n[4])/4));return new koe(n[0],n[1],n[2],n[3],a,o)},koe=function(){function r(e,t,n,i,s,a){this.initialValue=e,this.errorValue=t,this.highStart=n,this.highValueIndex=i,this.index=s,this.data=a}return r.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=this.index[e>>Wh],t=(t<<nx)+(e&ix),this.data[t];if(e<=65535)return t=this.index[TM+(e-55296>>Wh)],t=(t<<nx)+(e&ix),this.data[t];if(e<this.highStart)return t=Moe-Poe+(e>>rx),t=this.index[t],t+=e>>Wh&Roe,t=this.index[t],t=(t<<nx)+(e&ix),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},r}(),LM="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Noe=typeof Uint8Array>"u"?[]:new Uint8Array(256),n1=0;n1<LM.length;n1++)Noe[LM.charCodeAt(n1)]=n1;var Qoe=1,sx=2,ox=3,FM=4,MM=5,Hoe=7,PM=8,ax=9,cx=10,UM=11,RM=12,OM=13,DM=14,lx=15,zoe=function(r){for(var e=[],t=0,n=r.length;t<n;){var i=r.charCodeAt(t++);if(i>=55296&&i<=56319&&t<n){var s=r.charCodeAt(t++);(s&64512)===56320?e.push(((i&1023)<<10)+(s&1023)+65536):(e.push(i),t--)}else e.push(i)}return e},Goe=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,r);var t=r.length;if(!t)return"";for(var n=[],i=-1,s="";++i<t;){var a=r[i];a<=65535?n.push(a):(a-=65536,n.push((a>>10)+55296,a%1024+56320)),(i+1===t||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},Voe=Doe(woe),$h="",kM="",joe=function(r){return Voe.get(r)},qoe=function(r,e,t){var n=t-2,i=e[n],s=e[t-1],a=e[t];if(s===sx&&a===ox)return $h;if(s===sx||s===ox||s===FM||a===sx||a===ox||a===FM)return kM;if(s===PM&&[PM,ax,UM,RM].indexOf(a)!==-1||(s===UM||s===ax)&&(a===ax||a===cx)||(s===RM||s===cx)&&a===cx||a===OM||a===MM||a===Hoe||s===Qoe)return $h;if(s===OM&&a===DM){for(;i===MM;)i=e[--n];if(i===DM)return $h}if(s===lx&&a===lx){for(var o=0;i===lx;)o++,i=e[--n];if(o%2===0)return $h}return kM},Koe=function(r){var e=zoe(r),t=e.length,n=0,i=0,s=e.map(joe);return{next:function(){if(n>=t)return{done:!0,value:null};for(var a=$h;n<t&&(a=qoe(e,s,++n))===$h;);if(a!==$h||n===t){var o=Goe.apply(null,e.slice(i,n));return i=n,{value:o,done:!1}}return{done:!0,value:null}}}},Woe=function(r){for(var e=Koe(r),t=[],n;!(n=e.next()).done;)n.value&&t.push(n.value.slice());return t},$oe=function(r){var e=123;if(r.createRange){var t=r.createRange();if(t.getBoundingClientRect){var n=r.createElement("boundtest");n.style.height=e+"px",n.style.display="block",r.body.appendChild(n),t.selectNode(n);var i=t.getBoundingClientRect(),s=Math.round(i.height);if(r.body.removeChild(n),s===e)return!0}}return!1},Xoe=function(r){var e=r.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",r.body.appendChild(e);var t=r.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=e.firstChild,i=Ey(n.data).map(function(A){return ts(A)}),s=0,a={},o=i.every(function(A,f){t.setStart(n,s),t.setEnd(n,s+A.length);var m=t.getBoundingClientRect();s+=A.length;var v=m.x>a.x||m.y>a.y;return a=m,f===0?!0:v});return r.body.removeChild(e),o},Joe=function(){return typeof new Image().crossOrigin<"u"},Yoe=function(){return typeof new XMLHttpRequest().responseType=="string"},Zoe=function(r){var e=new Image,t=r.createElement("canvas"),n=t.getContext("2d");if(!n)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(e,0,0),t.toDataURL()}catch{return!1}return!0},NM=function(r){return r[0]===0&&r[1]===255&&r[2]===0&&r[3]===255},eae=function(r){var e=r.createElement("canvas"),t=100;e.width=t,e.height=t;var n=e.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,t,t);var i=new Image,s=e.toDataURL();i.src=s;var a=ux(t,t,0,0,i);return n.fillStyle="red",n.fillRect(0,0,t,t),QM(a).then(function(o){n.drawImage(o,0,0);var A=n.getImageData(0,0,t,t).data;n.fillStyle="red",n.fillRect(0,0,t,t);var f=r.createElement("div");return f.style.backgroundImage="url("+s+")",f.style.height=t+"px",NM(A)?QM(ux(t,t,0,0,f)):Promise.reject(!1)}).then(function(o){return n.drawImage(o,0,0),NM(n.getImageData(0,0,t,t).data)}).catch(function(){return!1})},ux=function(r,e,t,n,i){var s="http://www.w3.org/2000/svg",a=document.createElementNS(s,"svg"),o=document.createElementNS(s,"foreignObject");return a.setAttributeNS(null,"width",r.toString()),a.setAttributeNS(null,"height",e.toString()),o.setAttributeNS(null,"width","100%"),o.setAttributeNS(null,"height","100%"),o.setAttributeNS(null,"x",t.toString()),o.setAttributeNS(null,"y",n.toString()),o.setAttributeNS(null,"externalResourcesRequired","true"),a.appendChild(o),o.appendChild(i),a},QM=function(r){return new Promise(function(e,t){var n=new Image;n.onload=function(){return e(n)},n.onerror=t,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(r))})},$s={get SUPPORT_RANGE_BOUNDS(){var r=$oe(document);return Object.defineProperty($s,"SUPPORT_RANGE_BOUNDS",{value:r}),r},get SUPPORT_WORD_BREAKING(){var r=$s.SUPPORT_RANGE_BOUNDS&&Xoe(document);return Object.defineProperty($s,"SUPPORT_WORD_BREAKING",{value:r}),r},get SUPPORT_SVG_DRAWING(){var r=Zoe(document);return Object.defineProperty($s,"SUPPORT_SVG_DRAWING",{value:r}),r},get SUPPORT_FOREIGNOBJECT_DRAWING(){var r=typeof Array.from=="function"&&typeof window.fetch=="function"?eae(document):Promise.resolve(!1);return Object.defineProperty($s,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:r}),r},get SUPPORT_CORS_IMAGES(){var r=Joe();return Object.defineProperty($s,"SUPPORT_CORS_IMAGES",{value:r}),r},get SUPPORT_RESPONSE_TYPE(){var r=Yoe();return Object.defineProperty($s,"SUPPORT_RESPONSE_TYPE",{value:r}),r},get SUPPORT_CORS_XHR(){var r="withCredentials"in new XMLHttpRequest;return Object.defineProperty($s,"SUPPORT_CORS_XHR",{value:r}),r},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var r=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty($s,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:r}),r}},Kg=function(){function r(e,t){this.text=e,this.bounds=t}return r}(),tae=function(r,e,t,n){var i=iae(e,t),s=[],a=0;return i.forEach(function(o){if(t.textDecorationLine.length||o.trim().length>0)if($s.SUPPORT_RANGE_BOUNDS){var A=HM(n,a,o.length).getClientRects();if(A.length>1){var f=Ax(o),m=0;f.forEach(function(x){s.push(new Kg(x,Du.fromDOMRectList(r,HM(n,m+a,x.length).getClientRects()))),m+=x.length})}else s.push(new Kg(o,Du.fromDOMRectList(r,A)))}else{var v=n.splitText(o.length);s.push(new Kg(o,rae(r,n))),n=v}else $s.SUPPORT_RANGE_BOUNDS||(n=n.splitText(o.length));a+=o.length}),s},rae=function(r,e){var t=e.ownerDocument;if(t){var n=t.createElement("html2canvaswrapper");n.appendChild(e.cloneNode(!0));var i=e.parentNode;if(i){i.replaceChild(n,e);var s=Cy(r,n);return n.firstChild&&i.replaceChild(n.firstChild,n),s}}return Du.EMPTY},HM=function(r,e,t){var n=r.ownerDocument;if(!n)throw new Error("Node has no owner document");var i=n.createRange();return i.setStart(r,e),i.setEnd(r,e+t),i},Ax=function(r){if($s.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(r)).map(function(t){return t.segment})}return Woe(r)},nae=function(r,e){if($s.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(t.segment(r)).map(function(n){return n.segment})}return oae(r,e)},iae=function(r,e){return e.letterSpacing!==0?Ax(r):nae(r,e)},sae=[32,160,4961,65792,65793,4153,4241],oae=function(r,e){for(var t=Pne(r,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),n=[],i,s=function(){if(i.value){var a=i.value.slice(),o=Ey(a),A="";o.forEach(function(f){sae.indexOf(f)===-1?A+=ts(f):(A.length&&n.push(A),n.push(ts(f)),A="")}),A.length&&n.push(A)}};!(i=t.next()).done;)s();return n},aae=function(){function r(e,t,n){this.text=cae(t.data,n.textTransform),this.textBounds=tae(e,this.text,n,t)}return r}(),cae=function(r,e){switch(e){case 1:return r.toLowerCase();case 3:return r.replace(lae,uae);case 2:return r.toUpperCase();default:return r}},lae=/(^|\s|:|-|\(|\))([a-z])/g,uae=function(r,e,t){return r.length>0?e+t.toUpperCase():r},zM=function(r){Xc(e,r);function e(t,n){var i=r.call(this,t,n)||this;return i.src=n.currentSrc||n.src,i.intrinsicWidth=n.naturalWidth,i.intrinsicHeight=n.naturalHeight,i.context.cache.addImage(i.src),i}return e}(Yl),GM=function(r){Xc(e,r);function e(t,n){var i=r.call(this,t,n)||this;return i.canvas=n,i.intrinsicWidth=n.width,i.intrinsicHeight=n.height,i}return e}(Yl),VM=function(r){Xc(e,r);function e(t,n){var i=r.call(this,t,n)||this,s=new XMLSerializer,a=Cy(t,n);return n.setAttribute("width",a.width+"px"),n.setAttribute("height",a.height+"px"),i.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(n)),i.intrinsicWidth=n.width.baseVal.value,i.intrinsicHeight=n.height.baseVal.value,i.context.cache.addImage(i.svg),i}return e}(Yl),jM=function(r){Xc(e,r);function e(t,n){var i=r.call(this,t,n)||this;return i.value=n.value,i}return e}(Yl),hx=function(r){Xc(e,r);function e(t,n){var i=r.call(this,t,n)||this;return i.start=n.start,i.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,i}return e}(Yl),Aae=[{type:15,flags:0,unit:"px",number:3}],hae=[{type:16,flags:0,number:50}],dae=function(r){return r.width>r.height?new Du(r.left+(r.width-r.height)/2,r.top,r.height,r.height):r.width<r.height?new Du(r.left,r.top+(r.height-r.width)/2,r.width,r.width):r},fae=function(r){var e=r.type===pae?new Array(r.value.length+1).join(""):r.value;return e.length===0?r.placeholder||"":e},i1="checkbox",s1="radio",pae="password",qM=707406591,dx=function(r){Xc(e,r);function e(t,n){var i=r.call(this,t,n)||this;switch(i.type=n.type.toLowerCase(),i.checked=n.checked,i.value=fae(n),(i.type===i1||i.type===s1)&&(i.styles.backgroundColor=3739148031,i.styles.borderTopColor=i.styles.borderRightColor=i.styles.borderBottomColor=i.styles.borderLeftColor=2779096575,i.styles.borderTopWidth=i.styles.borderRightWidth=i.styles.borderBottomWidth=i.styles.borderLeftWidth=1,i.styles.borderTopStyle=i.styles.borderRightStyle=i.styles.borderBottomStyle=i.styles.borderLeftStyle=1,i.styles.backgroundClip=[0],i.styles.backgroundOrigin=[0],i.bounds=dae(i.bounds)),i.type){case i1:i.styles.borderTopRightRadius=i.styles.borderTopLeftRadius=i.styles.borderBottomRightRadius=i.styles.borderBottomLeftRadius=Aae;break;case s1:i.styles.borderTopRightRadius=i.styles.borderTopLeftRadius=i.styles.borderBottomRightRadius=i.styles.borderBottomLeftRadius=hae;break}return i}return e}(Yl),KM=function(r){Xc(e,r);function e(t,n){var i=r.call(this,t,n)||this,s=n.options[n.selectedIndex||0];return i.value=s&&s.text||"",i}return e}(Yl),WM=function(r){Xc(e,r);function e(t,n){var i=r.call(this,t,n)||this;return i.value=n.value,i}return e}(Yl),$M=function(r){Xc(e,r);function e(t,n){var i=r.call(this,t,n)||this;i.src=n.src,i.width=parseInt(n.width,10)||0,i.height=parseInt(n.height,10)||0,i.backgroundColor=i.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){i.tree=JM(t,n.contentWindow.document.documentElement);var s=n.contentWindow.document.documentElement?Vg(t,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):Nu.TRANSPARENT,a=n.contentWindow.document.body?Vg(t,getComputedStyle(n.contentWindow.document.body).backgroundColor):Nu.TRANSPARENT;i.backgroundColor=jA(s)?jA(a)?i.styles.backgroundColor:a:s}}catch{}return i}return e}(Yl),gae=["OL","UL","MENU"],o1=function(r,e,t,n){for(var i=e.firstChild,s=void 0;i;i=s)if(s=i.nextSibling,YM(i)&&i.data.trim().length>0)t.textNodes.push(new aae(r,i,t.styles));else if(Rf(i))if(iP(i)&&i.assignedNodes)i.assignedNodes().forEach(function(o){return o1(r,o,t,n)});else{var a=XM(r,i);a.styles.isVisible()&&(mae(i,a,n)?a.flags|=4:yae(a.styles)&&(a.flags|=2),gae.indexOf(i.tagName)!==-1&&(a.flags|=8),t.elements.push(a),i.slot,i.shadowRoot?o1(r,i.shadowRoot,a,n):!c1(i)&&!ZM(i)&&!l1(i)&&o1(r,i,a,n))}},XM=function(r,e){return gx(e)?new zM(r,e):eP(e)?new GM(r,e):ZM(e)?new VM(r,e):_ae(e)?new jM(r,e):vae(e)?new hx(r,e):bae(e)?new dx(r,e):l1(e)?new KM(r,e):c1(e)?new WM(r,e):rP(e)?new $M(r,e):new Yl(r,e)},JM=function(r,e){var t=XM(r,e);return t.flags|=4,o1(r,e,t,t),t},mae=function(r,e,t){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||px(r)&&t.styles.isTransparent()},yae=function(r){return r.isPositioned()||r.isFloating()},YM=function(r){return r.nodeType===Node.TEXT_NODE},Rf=function(r){return r.nodeType===Node.ELEMENT_NODE},fx=function(r){return Rf(r)&&typeof r.style<"u"&&!a1(r)},a1=function(r){return typeof r.className=="object"},_ae=function(r){return r.tagName==="LI"},vae=function(r){return r.tagName==="OL"},bae=function(r){return r.tagName==="INPUT"},wae=function(r){return r.tagName==="HTML"},ZM=function(r){return r.tagName==="svg"},px=function(r){return r.tagName==="BODY"},eP=function(r){return r.tagName==="CANVAS"},tP=function(r){return r.tagName==="VIDEO"},gx=function(r){return r.tagName==="IMG"},rP=function(r){return r.tagName==="IFRAME"},nP=function(r){return r.tagName==="STYLE"},xae=function(r){return r.tagName==="SCRIPT"},c1=function(r){return r.tagName==="TEXTAREA"},l1=function(r){return r.tagName==="SELECT"},iP=function(r){return r.tagName==="SLOT"},sP=function(r){return r.tagName.indexOf("-")>0},Bae=function(){function r(){this.counters={}}return r.prototype.getCounterValue=function(e){var t=this.counters[e];return t&&t.length?t[t.length-1]:1},r.prototype.getCounterValues=function(e){var t=this.counters[e];return t||[]},r.prototype.pop=function(e){var t=this;e.forEach(function(n){return t.counters[n].pop()})},r.prototype.parse=function(e){var t=this,n=e.counterIncrement,i=e.counterReset,s=!0;n!==null&&n.forEach(function(o){var A=t.counters[o.counter];A&&o.increment!==0&&(s=!1,A.length||A.push(1),A[Math.max(0,A.length-1)]+=o.increment)});var a=[];return s&&i.forEach(function(o){var A=t.counters[o.counter];a.push(o.counter),A||(A=t.counters[o.counter]=[]),A.push(o.reset)}),a},r}(),oP={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},aP={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Cae={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Eae={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Of=function(r,e,t,n,i,s){return r<e||r>t?$g(r,i,s.length>0):n.integers.reduce(function(a,o,A){for(;r>=o;)r-=o,a+=n.values[A];return a},"")+s},cP=function(r,e,t,n){var i="";do t||r--,i=n(r)+i,r/=e;while(r*e>=e);return i},rs=function(r,e,t,n,i){var s=t-e+1;return(r<0?"-":"")+(cP(Math.abs(r),s,n,function(a){return ts(Math.floor(a%s)+e)})+i)},Xh=function(r,e,t){t===void 0&&(t=". ");var n=e.length;return cP(Math.abs(r),n,!1,function(i){return e[Math.floor(i%n)]})+t},Df=1,KA=2,WA=4,Wg=8,Qu=function(r,e,t,n,i,s){if(r<-9999||r>9999)return $g(r,4,i.length>0);var a=Math.abs(r),o=i;if(a===0)return e[0]+o;for(var A=0;a>0&&A<=4;A++){var f=a%10;f===0&&Bs(s,Df)&&o!==""?o=e[f]+o:f>1||f===1&&A===0||f===1&&A===1&&Bs(s,KA)||f===1&&A===1&&Bs(s,WA)&&r>100||f===1&&A>1&&Bs(s,Wg)?o=e[f]+(A>0?t[A-1]:"")+o:f===1&&A>0&&(o=t[A-1]+o),a=Math.floor(a/10)}return(r<0?n:"")+o},lP="",uP="",AP="",mx="",$g=function(r,e,t){var n=t?". ":"",i=t?"":"",s=t?", ":"",a=t?" ":"";switch(e){case 0:return""+a;case 1:return""+a;case 2:return""+a;case 5:var o=rs(r,48,57,!0,n);return o.length<4?"0"+o:o;case 4:return Xh(r,"",i);case 6:return Of(r,1,3999,oP,3,n).toLowerCase();case 7:return Of(r,1,3999,oP,3,n);case 8:return rs(r,945,969,!1,n);case 9:return rs(r,97,122,!1,n);case 10:return rs(r,65,90,!1,n);case 11:return rs(r,1632,1641,!0,n);case 12:case 49:return Of(r,1,9999,aP,3,n);case 35:return Of(r,1,9999,aP,3,n).toLowerCase();case 13:return rs(r,2534,2543,!0,n);case 14:case 30:return rs(r,6112,6121,!0,n);case 15:return Xh(r,"",i);case 16:return Xh(r,"",i);case 17:case 48:return Qu(r,"",lP,"",i,KA|WA|Wg);case 47:return Qu(r,"",uP,"",i,Df|KA|WA|Wg);case 42:return Qu(r,"",lP,"",i,KA|WA|Wg);case 41:return Qu(r,"",uP,"",i,Df|KA|WA|Wg);case 26:return Qu(r,"","",AP,i,0);case 25:return Qu(r,"","",AP,i,Df|KA|WA);case 31:return Qu(r,"","",mx,s,Df|KA|WA);case 33:return Qu(r,"","",mx,s,0);case 32:return Qu(r,"","",mx,s,Df|KA|WA);case 18:return rs(r,2406,2415,!0,n);case 20:return Of(r,1,19999,Eae,3,n);case 21:return rs(r,2790,2799,!0,n);case 22:return rs(r,2662,2671,!0,n);case 22:return Of(r,1,10999,Cae,3,n);case 23:return Xh(r,"");case 24:return Xh(r,"");case 27:return rs(r,3302,3311,!0,n);case 28:return Xh(r,"",i);case 29:return Xh(r,"",i);case 34:return rs(r,3792,3801,!0,n);case 37:return rs(r,6160,6169,!0,n);case 38:return rs(r,4160,4169,!0,n);case 39:return rs(r,2918,2927,!0,n);case 40:return rs(r,1776,1785,!0,n);case 43:return rs(r,3046,3055,!0,n);case 44:return rs(r,3174,3183,!0,n);case 45:return rs(r,3664,3673,!0,n);case 46:return rs(r,3872,3881,!0,n);case 3:default:return rs(r,48,57,!0,n)}},hP="data-html2canvas-ignore",dP=function(){function r(e,t,n){if(this.context=e,this.options=n,this.scrolledElements=[],this.referenceElement=t,this.counters=new Bae,this.quoteDepth=0,!t.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(t.ownerDocument.documentElement,!1)}return r.prototype.toIFrame=function(e,t){var n=this,i=Sae(e,t);if(!i.contentWindow)return Promise.reject("Unable to find iframe window");var s=e.defaultView.pageXOffset,a=e.defaultView.pageYOffset,o=i.contentWindow,A=o.document,f=Lae(i).then(function(){return Oo(n,void 0,void 0,function(){var m,v;return mo(this,function(x){switch(x.label){case 0:return this.scrolledElements.forEach(Uae),o&&(o.scrollTo(t.left,t.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(o.scrollY!==t.top||o.scrollX!==t.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(o.scrollX-t.left,o.scrollY-t.top,0,0))),m=this.options.onclone,v=this.clonedReferenceElement,typeof v>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:A.fonts&&A.fonts.ready?[4,A.fonts.ready]:[3,2];case 1:x.sent(),x.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,Iae(A)]:[3,4];case 3:x.sent(),x.label=4;case 4:return typeof m=="function"?[2,Promise.resolve().then(function(){return m(A,v)}).then(function(){return i})]:[2,i]}})})});return A.open(),A.write(Mae(document.doctype)+"<html></html>"),Pae(this.referenceElement.ownerDocument,s,a),A.replaceChild(A.adoptNode(this.documentElement),A.documentElement),A.close(),f},r.prototype.createElementClone=function(e){if(tx(e,2))debugger;if(eP(e))return this.createCanvasClone(e);if(tP(e))return this.createVideoClone(e);if(nP(e))return this.createStyleClone(e);var t=e.cloneNode(!1);return gx(t)&&(gx(e)&&e.currentSrc&&e.currentSrc!==e.src&&(t.src=e.currentSrc,t.srcset=""),t.loading==="lazy"&&(t.loading="eager")),sP(t)?this.createCustomElementClone(t):t},r.prototype.createCustomElementClone=function(e){var t=document.createElement("html2canvascustomelement");return yx(e.style,t),t},r.prototype.createStyleClone=function(e){try{var t=e.sheet;if(t&&t.cssRules){var n=[].slice.call(t.cssRules,0).reduce(function(s,a){return a&&typeof a.cssText=="string"?s+a.cssText:s},""),i=e.cloneNode(!1);return i.textContent=n,i}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return e.cloneNode(!1)},r.prototype.createCanvasClone=function(e){var t;if(this.options.inlineImages&&e.ownerDocument){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var i=e.cloneNode(!1);try{i.width=e.width,i.height=e.height;var s=e.getContext("2d"),a=i.getContext("2d");if(a)if(!this.options.allowTaint&&s)a.putImageData(s.getImageData(0,0,e.width,e.height),0,0);else{var o=(t=e.getContext("webgl2"))!==null&&t!==void 0?t:e.getContext("webgl");if(o){var A=o.getContextAttributes();(A==null?void 0:A.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}a.drawImage(e,0,0)}return i}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return i},r.prototype.createVideoClone=function(e){var t=e.ownerDocument.createElement("canvas");t.width=e.offsetWidth,t.height=e.offsetHeight;var n=t.getContext("2d");try{return n&&(n.drawImage(e,0,0,t.width,t.height),this.options.allowTaint||n.getImageData(0,0,t.width,t.height)),t}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var i=e.ownerDocument.createElement("canvas");return i.width=e.offsetWidth,i.height=e.offsetHeight,i},r.prototype.appendChildNode=function(e,t,n){(!Rf(t)||!xae(t)&&!t.hasAttribute(hP)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(t)))&&(!this.options.copyStyles||!Rf(t)||!nP(t))&&e.appendChild(this.cloneNode(t,n))},r.prototype.cloneChildNodes=function(e,t,n){for(var i=this,s=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;s;s=s.nextSibling)if(Rf(s)&&iP(s)&&typeof s.assignedNodes=="function"){var a=s.assignedNodes();a.length&&a.forEach(function(o){return i.appendChildNode(t,o,n)})}else this.appendChildNode(t,s,n)},r.prototype.cloneNode=function(e,t){if(YM(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var n=e.ownerDocument.defaultView;if(n&&Rf(e)&&(fx(e)||a1(e))){var i=this.createElementClone(e);i.style.transitionProperty="none";var s=n.getComputedStyle(e),a=n.getComputedStyle(e,":before"),o=n.getComputedStyle(e,":after");this.referenceElement===e&&fx(i)&&(this.clonedReferenceElement=i),px(i)&&Dae(i);var A=this.counters.parse(new EM(this.context,s)),f=this.resolvePseudoContent(e,i,a,Xg.BEFORE);sP(e)&&(t=!0),tP(e)||this.cloneChildNodes(e,i,t),f&&i.insertBefore(f,i.firstChild);var m=this.resolvePseudoContent(e,i,o,Xg.AFTER);return m&&i.appendChild(m),this.counters.pop(A),(s&&(this.options.copyStyles||a1(e))&&!rP(e)||t)&&yx(s,i),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([i,e.scrollLeft,e.scrollTop]),(c1(e)||l1(e))&&(c1(i)||l1(i))&&(i.value=e.value),i}return e.cloneNode(!1)},r.prototype.resolvePseudoContent=function(e,t,n,i){var s=this;if(n){var a=n.content,o=t.ownerDocument;if(!(!o||!a||a==="none"||a==="-moz-alt-content"||n.display==="none")){this.counters.parse(new EM(this.context,n));var A=new _oe(this.context,n),f=o.createElement("html2canvaspseudoelement");yx(n,f),A.content.forEach(function(v){if(v.type===0)f.appendChild(o.createTextNode(v.value));else if(v.type===22){var x=o.createElement("img");x.src=v.value,x.style.opacity="1",f.appendChild(x)}else if(v.type===18){if(v.name==="attr"){var B=v.values.filter(ii);B.length&&f.appendChild(o.createTextNode(e.getAttribute(B[0].value)||""))}else if(v.name==="counter"){var M=v.values.filter(Pf),U=M[0],N=M[1];if(U&&ii(U)){var Q=s.counters.getCounterValue(U.value),q=N&&ii(N)?ex.parse(s.context,N.value):3;f.appendChild(o.createTextNode($g(Q,q,!1)))}}else if(v.name==="counters"){var Y=v.values.filter(Pf),U=Y[0],te=Y[1],N=Y[2];if(U&&ii(U)){var pe=s.counters.getCounterValues(U.value),ge=N&&ii(N)?ex.parse(s.context,N.value):3,ye=te&&te.type===0?te.value:"",fe=pe.map(function(oe){return $g(oe,ge,!1)}).join(ye);f.appendChild(o.createTextNode(fe))}}}else if(v.type===20)switch(v.value){case"open-quote":f.appendChild(o.createTextNode(CM(A.quotes,s.quoteDepth++,!0)));break;case"close-quote":f.appendChild(o.createTextNode(CM(A.quotes,--s.quoteDepth,!1)));break;default:f.appendChild(o.createTextNode(v.value))}}),f.className=_x+" "+vx;var m=i===Xg.BEFORE?" "+_x:" "+vx;return a1(t)?t.className.baseValue+=m:t.className+=m,f}}},r.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},r}(),Xg;(function(r){r[r.BEFORE=0]="BEFORE",r[r.AFTER=1]="AFTER"})(Xg||(Xg={}));var Sae=function(r,e){var t=r.createElement("iframe");return t.className="html2canvas-container",t.style.visibility="hidden",t.style.position="fixed",t.style.left="-10000px",t.style.top="0px",t.style.border="0",t.width=e.width.toString(),t.height=e.height.toString(),t.scrolling="no",t.setAttribute(hP,"true"),r.body.appendChild(t),t},Tae=function(r){return new Promise(function(e){if(r.complete){e();return}if(!r.src){e();return}r.onload=e,r.onerror=e})},Iae=function(r){return Promise.all([].slice.call(r.images,0).map(Tae))},Lae=function(r){return new Promise(function(e,t){var n=r.contentWindow;if(!n)return t("No window assigned for iframe");var i=n.document;n.onload=r.onload=function(){n.onload=r.onload=null;var s=setInterval(function(){i.body.childNodes.length>0&&i.readyState==="complete"&&(clearInterval(s),e(r))},50)}})},Fae=["all","d","content"],yx=function(r,e){for(var t=r.length-1;t>=0;t--){var n=r.item(t);Fae.indexOf(n)===-1&&e.style.setProperty(n,r.getPropertyValue(n))}return e},Mae=function(r){var e="";return r&&(e+="<!DOCTYPE ",r.name&&(e+=r.name),r.internalSubset&&(e+=r.internalSubset),r.publicId&&(e+='"'+r.publicId+'"'),r.systemId&&(e+='"'+r.systemId+'"'),e+=">"),e},Pae=function(r,e,t){r&&r.defaultView&&(e!==r.defaultView.pageXOffset||t!==r.defaultView.pageYOffset)&&r.defaultView.scrollTo(e,t)},Uae=function(r){var e=r[0],t=r[1],n=r[2];e.scrollLeft=t,e.scrollTop=n},Rae=":before",Oae=":after",_x="___html2canvas___pseudoelement_before",vx="___html2canvas___pseudoelement_after",fP=`{
    content: "" !important;
    display: none !important;
}`,Dae=function(r){kae(r,"."+_x+Rae+fP+`
         .`+vx+Oae+fP)},kae=function(r,e){var t=r.ownerDocument;if(t){var n=t.createElement("style");n.textContent=e,r.appendChild(n)}},pP=function(){function r(){}return r.getOrigin=function(e){var t=r._link;return t?(t.href=e,t.href=t.href,t.protocol+t.hostname+t.port):"about:blank"},r.isSameOrigin=function(e){return r.getOrigin(e)===r._origin},r.setContext=function(e){r._link=e.document.createElement("a"),r._origin=r.getOrigin(e.location.href)},r._origin="about:blank",r}(),Nae=function(){function r(e,t){this.context=e,this._options=t,this._cache={}}return r.prototype.addImage=function(e){var t=Promise.resolve();return this.has(e)||(wx(e)||Gae(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),t},r.prototype.match=function(e){return this._cache[e]},r.prototype.loadImage=function(e){return Oo(this,void 0,void 0,function(){var t,n,i,s,a=this;return mo(this,function(o){switch(o.label){case 0:return t=pP.isSameOrigin(e),n=!bx(e)&&this._options.useCORS===!0&&$s.SUPPORT_CORS_IMAGES&&!t,i=!bx(e)&&!t&&!wx(e)&&typeof this._options.proxy=="string"&&$s.SUPPORT_CORS_XHR&&!n,!t&&this._options.allowTaint===!1&&!bx(e)&&!wx(e)&&!i&&!n?[2]:(s=e,i?[4,this.proxy(s)]:[3,2]);case 1:s=o.sent(),o.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise(function(A,f){var m=new Image;m.onload=function(){return A(m)},m.onerror=f,(Vae(s)||n)&&(m.crossOrigin="anonymous"),m.src=s,m.complete===!0&&setTimeout(function(){return A(m)},500),a._options.imageTimeout>0&&setTimeout(function(){return f("Timed out ("+a._options.imageTimeout+"ms) loading image")},a._options.imageTimeout)})];case 3:return[2,o.sent()]}})})},r.prototype.has=function(e){return typeof this._cache[e]<"u"},r.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},r.prototype.proxy=function(e){var t=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var i=e.substring(0,256);return new Promise(function(s,a){var o=$s.SUPPORT_RESPONSE_TYPE?"blob":"text",A=new XMLHttpRequest;A.onload=function(){if(A.status===200)if(o==="text")s(A.response);else{var v=new FileReader;v.addEventListener("load",function(){return s(v.result)},!1),v.addEventListener("error",function(x){return a(x)},!1),v.readAsDataURL(A.response)}else a("Failed to proxy resource "+i+" with status code "+A.status)},A.onerror=a;var f=n.indexOf("?")>-1?"&":"?";if(A.open("GET",""+n+f+"url="+encodeURIComponent(e)+"&responseType="+o),o!=="text"&&A instanceof XMLHttpRequest&&(A.responseType=o),t._options.imageTimeout){var m=t._options.imageTimeout;A.timeout=m,A.ontimeout=function(){return a("Timed out ("+m+"ms) proxying "+i)}}A.send()})},r}(),Qae=/^data:image\/svg\+xml/i,Hae=/^data:image\/.*;base64,/i,zae=/^data:image\/.*/i,Gae=function(r){return $s.SUPPORT_SVG_DRAWING||!jae(r)},bx=function(r){return zae.test(r)},Vae=function(r){return Hae.test(r)},wx=function(r){return r.substr(0,4)==="blob"},jae=function(r){return r.substr(-3).toLowerCase()==="svg"||Qae.test(r)},ur=function(){function r(e,t){this.type=0,this.x=e,this.y=t}return r.prototype.add=function(e,t){return new r(this.x+e,this.y+t)},r}(),kf=function(r,e,t){return new ur(r.x+(e.x-r.x)*t,r.y+(e.y-r.y)*t)},u1=function(){function r(e,t,n,i){this.type=1,this.start=e,this.startControl=t,this.endControl=n,this.end=i}return r.prototype.subdivide=function(e,t){var n=kf(this.start,this.startControl,e),i=kf(this.startControl,this.endControl,e),s=kf(this.endControl,this.end,e),a=kf(n,i,e),o=kf(i,s,e),A=kf(a,o,e);return t?new r(this.start,n,a,A):new r(A,o,s,this.end)},r.prototype.add=function(e,t){return new r(this.start.add(e,t),this.startControl.add(e,t),this.endControl.add(e,t),this.end.add(e,t))},r.prototype.reverse=function(){return new r(this.end,this.endControl,this.startControl,this.start)},r}(),lc=function(r){return r.type===1},qae=function(){function r(e){var t=e.styles,n=e.bounds,i=Gg(t.borderTopLeftRadius,n.width,n.height),s=i[0],a=i[1],o=Gg(t.borderTopRightRadius,n.width,n.height),A=o[0],f=o[1],m=Gg(t.borderBottomRightRadius,n.width,n.height),v=m[0],x=m[1],B=Gg(t.borderBottomLeftRadius,n.width,n.height),M=B[0],U=B[1],N=[];N.push((s+A)/n.width),N.push((M+v)/n.width),N.push((a+U)/n.height),N.push((f+x)/n.height);var Q=Math.max.apply(Math,N);Q>1&&(s/=Q,a/=Q,A/=Q,f/=Q,v/=Q,x/=Q,M/=Q,U/=Q);var q=n.width-A,Y=n.height-x,te=n.width-v,pe=n.height-U,ge=t.borderTopWidth,ye=t.borderRightWidth,fe=t.borderBottomWidth,Oe=t.borderLeftWidth,Fe=mi(t.paddingTop,e.bounds.width),oe=mi(t.paddingRight,e.bounds.width),le=mi(t.paddingBottom,e.bounds.width),xe=mi(t.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||a>0?Ii(n.left+Oe/3,n.top+ge/3,s-Oe/3,a-ge/3,qn.TOP_LEFT):new ur(n.left+Oe/3,n.top+ge/3),this.topRightBorderDoubleOuterBox=s>0||a>0?Ii(n.left+q,n.top+ge/3,A-ye/3,f-ge/3,qn.TOP_RIGHT):new ur(n.left+n.width-ye/3,n.top+ge/3),this.bottomRightBorderDoubleOuterBox=v>0||x>0?Ii(n.left+te,n.top+Y,v-ye/3,x-fe/3,qn.BOTTOM_RIGHT):new ur(n.left+n.width-ye/3,n.top+n.height-fe/3),this.bottomLeftBorderDoubleOuterBox=M>0||U>0?Ii(n.left+Oe/3,n.top+pe,M-Oe/3,U-fe/3,qn.BOTTOM_LEFT):new ur(n.left+Oe/3,n.top+n.height-fe/3),this.topLeftBorderDoubleInnerBox=s>0||a>0?Ii(n.left+Oe*2/3,n.top+ge*2/3,s-Oe*2/3,a-ge*2/3,qn.TOP_LEFT):new ur(n.left+Oe*2/3,n.top+ge*2/3),this.topRightBorderDoubleInnerBox=s>0||a>0?Ii(n.left+q,n.top+ge*2/3,A-ye*2/3,f-ge*2/3,qn.TOP_RIGHT):new ur(n.left+n.width-ye*2/3,n.top+ge*2/3),this.bottomRightBorderDoubleInnerBox=v>0||x>0?Ii(n.left+te,n.top+Y,v-ye*2/3,x-fe*2/3,qn.BOTTOM_RIGHT):new ur(n.left+n.width-ye*2/3,n.top+n.height-fe*2/3),this.bottomLeftBorderDoubleInnerBox=M>0||U>0?Ii(n.left+Oe*2/3,n.top+pe,M-Oe*2/3,U-fe*2/3,qn.BOTTOM_LEFT):new ur(n.left+Oe*2/3,n.top+n.height-fe*2/3),this.topLeftBorderStroke=s>0||a>0?Ii(n.left+Oe/2,n.top+ge/2,s-Oe/2,a-ge/2,qn.TOP_LEFT):new ur(n.left+Oe/2,n.top+ge/2),this.topRightBorderStroke=s>0||a>0?Ii(n.left+q,n.top+ge/2,A-ye/2,f-ge/2,qn.TOP_RIGHT):new ur(n.left+n.width-ye/2,n.top+ge/2),this.bottomRightBorderStroke=v>0||x>0?Ii(n.left+te,n.top+Y,v-ye/2,x-fe/2,qn.BOTTOM_RIGHT):new ur(n.left+n.width-ye/2,n.top+n.height-fe/2),this.bottomLeftBorderStroke=M>0||U>0?Ii(n.left+Oe/2,n.top+pe,M-Oe/2,U-fe/2,qn.BOTTOM_LEFT):new ur(n.left+Oe/2,n.top+n.height-fe/2),this.topLeftBorderBox=s>0||a>0?Ii(n.left,n.top,s,a,qn.TOP_LEFT):new ur(n.left,n.top),this.topRightBorderBox=A>0||f>0?Ii(n.left+q,n.top,A,f,qn.TOP_RIGHT):new ur(n.left+n.width,n.top),this.bottomRightBorderBox=v>0||x>0?Ii(n.left+te,n.top+Y,v,x,qn.BOTTOM_RIGHT):new ur(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=M>0||U>0?Ii(n.left,n.top+pe,M,U,qn.BOTTOM_LEFT):new ur(n.left,n.top+n.height),this.topLeftPaddingBox=s>0||a>0?Ii(n.left+Oe,n.top+ge,Math.max(0,s-Oe),Math.max(0,a-ge),qn.TOP_LEFT):new ur(n.left+Oe,n.top+ge),this.topRightPaddingBox=A>0||f>0?Ii(n.left+Math.min(q,n.width-ye),n.top+ge,q>n.width+ye?0:Math.max(0,A-ye),Math.max(0,f-ge),qn.TOP_RIGHT):new ur(n.left+n.width-ye,n.top+ge),this.bottomRightPaddingBox=v>0||x>0?Ii(n.left+Math.min(te,n.width-Oe),n.top+Math.min(Y,n.height-fe),Math.max(0,v-ye),Math.max(0,x-fe),qn.BOTTOM_RIGHT):new ur(n.left+n.width-ye,n.top+n.height-fe),this.bottomLeftPaddingBox=M>0||U>0?Ii(n.left+Oe,n.top+Math.min(pe,n.height-fe),Math.max(0,M-Oe),Math.max(0,U-fe),qn.BOTTOM_LEFT):new ur(n.left+Oe,n.top+n.height-fe),this.topLeftContentBox=s>0||a>0?Ii(n.left+Oe+xe,n.top+ge+Fe,Math.max(0,s-(Oe+xe)),Math.max(0,a-(ge+Fe)),qn.TOP_LEFT):new ur(n.left+Oe+xe,n.top+ge+Fe),this.topRightContentBox=A>0||f>0?Ii(n.left+Math.min(q,n.width+Oe+xe),n.top+ge+Fe,q>n.width+Oe+xe?0:A-Oe+xe,f-(ge+Fe),qn.TOP_RIGHT):new ur(n.left+n.width-(ye+oe),n.top+ge+Fe),this.bottomRightContentBox=v>0||x>0?Ii(n.left+Math.min(te,n.width-(Oe+xe)),n.top+Math.min(Y,n.height+ge+Fe),Math.max(0,v-(ye+oe)),x-(fe+le),qn.BOTTOM_RIGHT):new ur(n.left+n.width-(ye+oe),n.top+n.height-(fe+le)),this.bottomLeftContentBox=M>0||U>0?Ii(n.left+Oe+xe,n.top+pe,Math.max(0,M-(Oe+xe)),U-(fe+le),qn.BOTTOM_LEFT):new ur(n.left+Oe+xe,n.top+n.height-(fe+le))}return r}(),qn;(function(r){r[r.TOP_LEFT=0]="TOP_LEFT",r[r.TOP_RIGHT=1]="TOP_RIGHT",r[r.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",r[r.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(qn||(qn={}));var Ii=function(r,e,t,n,i){var s=4*((Math.sqrt(2)-1)/3),a=t*s,o=n*s,A=r+t,f=e+n;switch(i){case qn.TOP_LEFT:return new u1(new ur(r,f),new ur(r,f-o),new ur(A-a,e),new ur(A,e));case qn.TOP_RIGHT:return new u1(new ur(r,e),new ur(r+a,e),new ur(A,f-o),new ur(A,f));case qn.BOTTOM_RIGHT:return new u1(new ur(A,e),new ur(A,e+o),new ur(r+a,f),new ur(r,f));case qn.BOTTOM_LEFT:default:return new u1(new ur(A,f),new ur(A-a,f),new ur(r,e+o),new ur(r,e))}},A1=function(r){return[r.topLeftBorderBox,r.topRightBorderBox,r.bottomRightBorderBox,r.bottomLeftBorderBox]},Kae=function(r){return[r.topLeftContentBox,r.topRightContentBox,r.bottomRightContentBox,r.bottomLeftContentBox]},h1=function(r){return[r.topLeftPaddingBox,r.topRightPaddingBox,r.bottomRightPaddingBox,r.bottomLeftPaddingBox]},Wae=function(){function r(e,t,n){this.offsetX=e,this.offsetY=t,this.matrix=n,this.type=0,this.target=6}return r}(),d1=function(){function r(e,t){this.path=e,this.target=t,this.type=1}return r}(),$ae=function(){function r(e){this.opacity=e,this.type=2,this.target=6}return r}(),Xae=function(r){return r.type===0},gP=function(r){return r.type===1},Jae=function(r){return r.type===2},mP=function(r,e){return r.length===e.length?r.some(function(t,n){return t===e[n]}):!1},Yae=function(r,e,t,n,i){return r.map(function(s,a){switch(a){case 0:return s.add(e,t);case 1:return s.add(e+n,t);case 2:return s.add(e+n,t+i);case 3:return s.add(e,t+i)}return s})},yP=function(){function r(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return r}(),_P=function(){function r(e,t){if(this.container=e,this.parent=t,this.effects=[],this.curves=new qae(this.container),this.container.styles.opacity<1&&this.effects.push(new $ae(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,i=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new Wae(n,i,s))}if(this.container.styles.overflowX!==0){var a=A1(this.curves),o=h1(this.curves);mP(a,o)?this.effects.push(new d1(a,6)):(this.effects.push(new d1(a,2)),this.effects.push(new d1(o,4)))}}return r.prototype.getEffects=function(e){for(var t=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,i=this.effects.slice(0);n;){var s=n.effects.filter(function(A){return!gP(A)});if(t||n.container.styles.position!==0||!n.parent){if(i.unshift.apply(i,s),t=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var a=A1(n.curves),o=h1(n.curves);mP(a,o)||i.unshift(new d1(o,6))}}else i.unshift.apply(i,s);n=n.parent}return i.filter(function(A){return Bs(A.target,e)})},r}(),xx=function(r,e,t,n){r.container.elements.forEach(function(i){var s=Bs(i.flags,4),a=Bs(i.flags,2),o=new _P(i,r);Bs(i.styles.display,2048)&&n.push(o);var A=Bs(i.flags,8)?[]:n;if(s||a){var f=s||i.styles.isPositioned()?t:e,m=new yP(o);if(i.styles.isPositioned()||i.styles.opacity<1||i.styles.isTransformed()){var v=i.styles.zIndex.order;if(v<0){var x=0;f.negativeZIndex.some(function(M,U){return v>M.element.container.styles.zIndex.order?(x=U,!1):x>0}),f.negativeZIndex.splice(x,0,m)}else if(v>0){var B=0;f.positiveZIndex.some(function(M,U){return v>=M.element.container.styles.zIndex.order?(B=U+1,!1):B>0}),f.positiveZIndex.splice(B,0,m)}else f.zeroOrAutoZIndexOrTransformedOrOpacity.push(m)}else i.styles.isFloating()?f.nonPositionedFloats.push(m):f.nonPositionedInlineLevel.push(m);xx(o,m,s?m:t,A)}else i.styles.isInlineLevel()?e.inlineLevel.push(o):e.nonInlineLevel.push(o),xx(o,e,t,A);Bs(i.flags,8)&&vP(i,A)})},vP=function(r,e){for(var t=r instanceof hx?r.start:1,n=r instanceof hx?r.reversed:!1,i=0;i<e.length;i++){var s=e[i];s.container instanceof jM&&typeof s.container.value=="number"&&s.container.value!==0&&(t=s.container.value),s.listValue=$g(t,s.container.styles.listStyleType,!0),t+=n?-1:1}},Zae=function(r){var e=new _P(r,null),t=new yP(e),n=[];return xx(e,t,t,n),vP(e.container,n),t},bP=function(r,e){switch(e){case 0:return uc(r.topLeftBorderBox,r.topLeftPaddingBox,r.topRightBorderBox,r.topRightPaddingBox);case 1:return uc(r.topRightBorderBox,r.topRightPaddingBox,r.bottomRightBorderBox,r.bottomRightPaddingBox);case 2:return uc(r.bottomRightBorderBox,r.bottomRightPaddingBox,r.bottomLeftBorderBox,r.bottomLeftPaddingBox);case 3:default:return uc(r.bottomLeftBorderBox,r.bottomLeftPaddingBox,r.topLeftBorderBox,r.topLeftPaddingBox)}},ece=function(r,e){switch(e){case 0:return uc(r.topLeftBorderBox,r.topLeftBorderDoubleOuterBox,r.topRightBorderBox,r.topRightBorderDoubleOuterBox);case 1:return uc(r.topRightBorderBox,r.topRightBorderDoubleOuterBox,r.bottomRightBorderBox,r.bottomRightBorderDoubleOuterBox);case 2:return uc(r.bottomRightBorderBox,r.bottomRightBorderDoubleOuterBox,r.bottomLeftBorderBox,r.bottomLeftBorderDoubleOuterBox);case 3:default:return uc(r.bottomLeftBorderBox,r.bottomLeftBorderDoubleOuterBox,r.topLeftBorderBox,r.topLeftBorderDoubleOuterBox)}},tce=function(r,e){switch(e){case 0:return uc(r.topLeftBorderDoubleInnerBox,r.topLeftPaddingBox,r.topRightBorderDoubleInnerBox,r.topRightPaddingBox);case 1:return uc(r.topRightBorderDoubleInnerBox,r.topRightPaddingBox,r.bottomRightBorderDoubleInnerBox,r.bottomRightPaddingBox);case 2:return uc(r.bottomRightBorderDoubleInnerBox,r.bottomRightPaddingBox,r.bottomLeftBorderDoubleInnerBox,r.bottomLeftPaddingBox);case 3:default:return uc(r.bottomLeftBorderDoubleInnerBox,r.bottomLeftPaddingBox,r.topLeftBorderDoubleInnerBox,r.topLeftPaddingBox)}},rce=function(r,e){switch(e){case 0:return f1(r.topLeftBorderStroke,r.topRightBorderStroke);case 1:return f1(r.topRightBorderStroke,r.bottomRightBorderStroke);case 2:return f1(r.bottomRightBorderStroke,r.bottomLeftBorderStroke);case 3:default:return f1(r.bottomLeftBorderStroke,r.topLeftBorderStroke)}},f1=function(r,e){var t=[];return lc(r)?t.push(r.subdivide(.5,!1)):t.push(r),lc(e)?t.push(e.subdivide(.5,!0)):t.push(e),t},uc=function(r,e,t,n){var i=[];return lc(r)?i.push(r.subdivide(.5,!1)):i.push(r),lc(t)?i.push(t.subdivide(.5,!0)):i.push(t),lc(n)?i.push(n.subdivide(.5,!0).reverse()):i.push(n),lc(e)?i.push(e.subdivide(.5,!1).reverse()):i.push(e),i},wP=function(r){var e=r.bounds,t=r.styles;return e.add(t.borderLeftWidth,t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth),-(t.borderTopWidth+t.borderBottomWidth))},p1=function(r){var e=r.styles,t=r.bounds,n=mi(e.paddingLeft,t.width),i=mi(e.paddingRight,t.width),s=mi(e.paddingTop,t.width),a=mi(e.paddingBottom,t.width);return t.add(n+e.borderLeftWidth,s+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+n+i),-(e.borderTopWidth+e.borderBottomWidth+s+a))},nce=function(r,e){return r===0?e.bounds:r===2?p1(e):wP(e)},ice=function(r,e){return r===0?e.bounds:r===2?p1(e):wP(e)},Bx=function(r,e,t){var n=nce(Qf(r.styles.backgroundOrigin,e),r),i=ice(Qf(r.styles.backgroundClip,e),r),s=sce(Qf(r.styles.backgroundSize,e),t,n),a=s[0],o=s[1],A=Gg(Qf(r.styles.backgroundPosition,e),n.width-a,n.height-o),f=oce(Qf(r.styles.backgroundRepeat,e),A,s,n,i),m=Math.round(n.left+A[0]),v=Math.round(n.top+A[1]);return[f,m,v,a,o]},Nf=function(r){return ii(r)&&r.value===Uf.AUTO},g1=function(r){return typeof r=="number"},sce=function(r,e,t){var n=e[0],i=e[1],s=e[2],a=r[0],o=r[1];if(!a)return[0,0];if(ms(a)&&o&&ms(o))return[mi(a,t.width),mi(o,t.height)];var A=g1(s);if(ii(a)&&(a.value===Uf.CONTAIN||a.value===Uf.COVER)){if(g1(s)){var f=t.width/t.height;return f<s!=(a.value===Uf.COVER)?[t.width,t.width/s]:[t.height*s,t.height]}return[t.width,t.height]}var m=g1(n),v=g1(i),x=m||v;if(Nf(a)&&(!o||Nf(o))){if(m&&v)return[n,i];if(!A&&!x)return[t.width,t.height];if(x&&A){var B=m?n:i*s,M=v?i:n/s;return[B,M]}var U=m?n:t.width,N=v?i:t.height;return[U,N]}if(A){var Q=0,q=0;return ms(a)?Q=mi(a,t.width):ms(o)&&(q=mi(o,t.height)),Nf(a)?Q=q*s:(!o||Nf(o))&&(q=Q/s),[Q,q]}var Y=null,te=null;if(ms(a)?Y=mi(a,t.width):o&&ms(o)&&(te=mi(o,t.height)),Y!==null&&(!o||Nf(o))&&(te=m&&v?Y/n*i:t.height),te!==null&&Nf(a)&&(Y=m&&v?te/i*n:t.width),Y!==null&&te!==null)return[Y,te];throw new Error("Unable to calculate background-size for element")},Qf=function(r,e){var t=r[e];return typeof t>"u"?r[0]:t},oce=function(r,e,t,n,i){var s=e[0],a=e[1],o=t[0],A=t[1];switch(r){case 2:return[new ur(Math.round(n.left),Math.round(n.top+a)),new ur(Math.round(n.left+n.width),Math.round(n.top+a)),new ur(Math.round(n.left+n.width),Math.round(A+n.top+a)),new ur(Math.round(n.left),Math.round(A+n.top+a))];case 3:return[new ur(Math.round(n.left+s),Math.round(n.top)),new ur(Math.round(n.left+s+o),Math.round(n.top)),new ur(Math.round(n.left+s+o),Math.round(n.height+n.top)),new ur(Math.round(n.left+s),Math.round(n.height+n.top))];case 1:return[new ur(Math.round(n.left+s),Math.round(n.top+a)),new ur(Math.round(n.left+s+o),Math.round(n.top+a)),new ur(Math.round(n.left+s+o),Math.round(n.top+a+A)),new ur(Math.round(n.left+s),Math.round(n.top+a+A))];default:return[new ur(Math.round(i.left),Math.round(i.top)),new ur(Math.round(i.left+i.width),Math.round(i.top)),new ur(Math.round(i.left+i.width),Math.round(i.height+i.top)),new ur(Math.round(i.left),Math.round(i.height+i.top))]}},ace="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",xP="Hidden Text",cce=function(){function r(e){this._data={},this._document=e}return r.prototype.parseMetrics=function(e,t){var n=this._document.createElement("div"),i=this._document.createElement("img"),s=this._document.createElement("span"),a=this._document.body;n.style.visibility="hidden",n.style.fontFamily=e,n.style.fontSize=t,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",a.appendChild(n),i.src=ace,i.width=1,i.height=1,i.style.margin="0",i.style.padding="0",i.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=t,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(xP)),n.appendChild(s),n.appendChild(i);var o=i.offsetTop-s.offsetTop+2;n.removeChild(s),n.appendChild(this._document.createTextNode(xP)),n.style.lineHeight="normal",i.style.verticalAlign="super";var A=i.offsetTop-n.offsetTop+2;return a.removeChild(n),{baseline:o,middle:A}},r.prototype.getMetrics=function(e,t){var n=e+" "+t;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(e,t)),this._data[n]},r}(),BP=function(){function r(e,t){this.context=e,this.options=t}return r}(),lce=1e4,uce=function(r){Xc(e,r);function e(t,n){var i=r.call(this,t,n)||this;return i._activeEffects=[],i.canvas=n.canvas?n.canvas:document.createElement("canvas"),i.ctx=i.canvas.getContext("2d"),n.canvas||(i.canvas.width=Math.floor(n.width*n.scale),i.canvas.height=Math.floor(n.height*n.scale),i.canvas.style.width=n.width+"px",i.canvas.style.height=n.height+"px"),i.fontMetrics=new cce(document),i.ctx.scale(i.options.scale,i.options.scale),i.ctx.translate(-n.x,-n.y),i.ctx.textBaseline="bottom",i._activeEffects=[],i.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),i}return e.prototype.applyEffects=function(t){for(var n=this;this._activeEffects.length;)this.popEffect();t.forEach(function(i){return n.applyEffect(i)})},e.prototype.applyEffect=function(t){this.ctx.save(),Jae(t)&&(this.ctx.globalAlpha=t.opacity),Xae(t)&&(this.ctx.translate(t.offsetX,t.offsetY),this.ctx.transform(t.matrix[0],t.matrix[1],t.matrix[2],t.matrix[3],t.matrix[4],t.matrix[5]),this.ctx.translate(-t.offsetX,-t.offsetY)),gP(t)&&(this.path(t.path),this.ctx.clip()),this._activeEffects.push(t)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(t){return Oo(this,void 0,void 0,function(){var n;return mo(this,function(i){switch(i.label){case 0:return n=t.element.container.styles,n.isVisible()?[4,this.renderStackContent(t)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(t){return Oo(this,void 0,void 0,function(){return mo(this,function(n){switch(n.label){case 0:if(Bs(t.container.flags,16))debugger;return t.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(t)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(t)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(t,n,i){var s=this;if(n===0)this.ctx.fillText(t.text,t.bounds.left,t.bounds.top+i);else{var a=Ax(t.text);a.reduce(function(o,A){return s.ctx.fillText(A,o,t.bounds.top+i),o+s.ctx.measureText(A).width},t.bounds.left)}},e.prototype.createFontStyle=function(t){var n=t.fontVariant.filter(function(a){return a==="normal"||a==="small-caps"}).join(""),i=pce(t.fontFamily).join(", "),s=zg(t.fontSize)?""+t.fontSize.number+t.fontSize.unit:t.fontSize.number+"px";return[[t.fontStyle,n,t.fontWeight,s,i].join(" "),i,s]},e.prototype.renderTextNode=function(t,n){return Oo(this,void 0,void 0,function(){var i,s,a,o,A,f,m,v,x=this;return mo(this,function(B){return i=this.createFontStyle(n),s=i[0],a=i[1],o=i[2],this.ctx.font=s,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",A=this.fontMetrics.getMetrics(a,o),f=A.baseline,m=A.middle,v=n.paintOrder,t.textBounds.forEach(function(M){v.forEach(function(U){switch(U){case 0:x.ctx.fillStyle=Us(n.color),x.renderTextWithLetterSpacing(M,n.letterSpacing,f);var N=n.textShadow;N.length&&M.text.trim().length&&(N.slice(0).reverse().forEach(function(Q){x.ctx.shadowColor=Us(Q.color),x.ctx.shadowOffsetX=Q.offsetX.number*x.options.scale,x.ctx.shadowOffsetY=Q.offsetY.number*x.options.scale,x.ctx.shadowBlur=Q.blur.number,x.renderTextWithLetterSpacing(M,n.letterSpacing,f)}),x.ctx.shadowColor="",x.ctx.shadowOffsetX=0,x.ctx.shadowOffsetY=0,x.ctx.shadowBlur=0),n.textDecorationLine.length&&(x.ctx.fillStyle=Us(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(Q){switch(Q){case 1:x.ctx.fillRect(M.bounds.left,Math.round(M.bounds.top+f),M.bounds.width,1);break;case 2:x.ctx.fillRect(M.bounds.left,Math.round(M.bounds.top),M.bounds.width,1);break;case 3:x.ctx.fillRect(M.bounds.left,Math.ceil(M.bounds.top+m),M.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&M.text.trim().length&&(x.ctx.strokeStyle=Us(n.webkitTextStrokeColor),x.ctx.lineWidth=n.webkitTextStrokeWidth,x.ctx.lineJoin=window.chrome?"miter":"round",x.ctx.strokeText(M.text,M.bounds.left,M.bounds.top+f)),x.ctx.strokeStyle="",x.ctx.lineWidth=0,x.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(t,n,i){if(i&&t.intrinsicWidth>0&&t.intrinsicHeight>0){var s=p1(t),a=h1(n);this.path(a),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(i,0,0,t.intrinsicWidth,t.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(t){return Oo(this,void 0,void 0,function(){var n,i,s,a,o,A,q,q,f,m,v,x,te,B,M,pe,U,N,Q,q,Y,te,pe;return mo(this,function(ge){switch(ge.label){case 0:this.applyEffects(t.getEffects(4)),n=t.container,i=t.curves,s=n.styles,a=0,o=n.textNodes,ge.label=1;case 1:return a<o.length?(A=o[a],[4,this.renderTextNode(A,s)]):[3,4];case 2:ge.sent(),ge.label=3;case 3:return a++,[3,1];case 4:if(!(n instanceof zM))return[3,8];ge.label=5;case 5:return ge.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return q=ge.sent(),this.renderReplacedElement(n,i,q),[3,8];case 7:return ge.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof GM&&this.renderReplacedElement(n,i,n.canvas),!(n instanceof VM))return[3,12];ge.label=9;case 9:return ge.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return q=ge.sent(),this.renderReplacedElement(n,i,q),[3,12];case 11:return ge.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof $M&&n.tree?(f=new e(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,f.render(n.tree)]):[3,14];case 13:m=ge.sent(),n.width&&n.height&&this.ctx.drawImage(m,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),ge.label=14;case 14:if(n instanceof dx&&(v=Math.min(n.bounds.width,n.bounds.height),n.type===i1?n.checked&&(this.ctx.save(),this.path([new ur(n.bounds.left+v*.39363,n.bounds.top+v*.79),new ur(n.bounds.left+v*.16,n.bounds.top+v*.5549),new ur(n.bounds.left+v*.27347,n.bounds.top+v*.44071),new ur(n.bounds.left+v*.39694,n.bounds.top+v*.5649),new ur(n.bounds.left+v*.72983,n.bounds.top+v*.23),new ur(n.bounds.left+v*.84,n.bounds.top+v*.34085),new ur(n.bounds.left+v*.39363,n.bounds.top+v*.79)]),this.ctx.fillStyle=Us(qM),this.ctx.fill(),this.ctx.restore()):n.type===s1&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+v/2,n.bounds.top+v/2,v/4,0,Math.PI*2,!0),this.ctx.fillStyle=Us(qM),this.ctx.fill(),this.ctx.restore())),Ace(n)&&n.value.length){switch(x=this.createFontStyle(s),te=x[0],B=x[1],M=this.fontMetrics.getMetrics(te,B).baseline,this.ctx.font=te,this.ctx.fillStyle=Us(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=dce(n.styles.textAlign),pe=p1(n),U=0,n.styles.textAlign){case 1:U+=pe.width/2;break;case 2:U+=pe.width;break}N=pe.add(U,0,0,-pe.height/2+1),this.ctx.save(),this.path([new ur(pe.left,pe.top),new ur(pe.left+pe.width,pe.top),new ur(pe.left+pe.width,pe.top+pe.height),new ur(pe.left,pe.top+pe.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Kg(n.value,N),s.letterSpacing,M),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Bs(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(Q=n.styles.listStyleImage,Q.type!==0)return[3,18];q=void 0,Y=Q.url,ge.label=15;case 15:return ge.trys.push([15,17,,18]),[4,this.context.cache.match(Y)];case 16:return q=ge.sent(),this.ctx.drawImage(q,n.bounds.left-(q.width+10),n.bounds.top),[3,18];case 17:return ge.sent(),this.context.logger.error("Error loading list-style-image "+Y),[3,18];case 18:return[3,20];case 19:t.listValue&&n.styles.listStyleType!==-1&&(te=this.createFontStyle(s)[0],this.ctx.font=te,this.ctx.fillStyle=Us(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",pe=new Du(n.bounds.left,n.bounds.top+mi(n.styles.paddingTop,n.bounds.width),n.bounds.width,wM(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Kg(t.listValue,pe),s.letterSpacing,wM(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),ge.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(t){return Oo(this,void 0,void 0,function(){var n,i,Q,s,a,Q,o,A,Q,f,m,Q,v,x,Q,B,M,Q,U,N,Q;return mo(this,function(q){switch(q.label){case 0:if(Bs(t.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(t.element)];case 1:q.sent(),n=0,i=t.negativeZIndex,q.label=2;case 2:return n<i.length?(Q=i[n],[4,this.renderStack(Q)]):[3,5];case 3:q.sent(),q.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(t.element)];case 6:q.sent(),s=0,a=t.nonInlineLevel,q.label=7;case 7:return s<a.length?(Q=a[s],[4,this.renderNode(Q)]):[3,10];case 8:q.sent(),q.label=9;case 9:return s++,[3,7];case 10:o=0,A=t.nonPositionedFloats,q.label=11;case 11:return o<A.length?(Q=A[o],[4,this.renderStack(Q)]):[3,14];case 12:q.sent(),q.label=13;case 13:return o++,[3,11];case 14:f=0,m=t.nonPositionedInlineLevel,q.label=15;case 15:return f<m.length?(Q=m[f],[4,this.renderStack(Q)]):[3,18];case 16:q.sent(),q.label=17;case 17:return f++,[3,15];case 18:v=0,x=t.inlineLevel,q.label=19;case 19:return v<x.length?(Q=x[v],[4,this.renderNode(Q)]):[3,22];case 20:q.sent(),q.label=21;case 21:return v++,[3,19];case 22:B=0,M=t.zeroOrAutoZIndexOrTransformedOrOpacity,q.label=23;case 23:return B<M.length?(Q=M[B],[4,this.renderStack(Q)]):[3,26];case 24:q.sent(),q.label=25;case 25:return B++,[3,23];case 26:U=0,N=t.positiveZIndex,q.label=27;case 27:return U<N.length?(Q=N[U],[4,this.renderStack(Q)]):[3,30];case 28:q.sent(),q.label=29;case 29:return U++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(t){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(t.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(t){this.ctx.beginPath(),this.formatPath(t),this.ctx.closePath()},e.prototype.formatPath=function(t){var n=this;t.forEach(function(i,s){var a=lc(i)?i.start:i;s===0?n.ctx.moveTo(a.x,a.y):n.ctx.lineTo(a.x,a.y),lc(i)&&n.ctx.bezierCurveTo(i.startControl.x,i.startControl.y,i.endControl.x,i.endControl.y,i.end.x,i.end.y)})},e.prototype.renderRepeat=function(t,n,i,s){this.path(t),this.ctx.fillStyle=n,this.ctx.translate(i,s),this.ctx.fill(),this.ctx.translate(-i,-s)},e.prototype.resizeImage=function(t,n,i){var s;if(t.width===n&&t.height===i)return t;var a=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,o=a.createElement("canvas");o.width=Math.max(1,n),o.height=Math.max(1,i);var A=o.getContext("2d");return A.drawImage(t,0,0,t.width,t.height,0,0,n,i),o},e.prototype.renderBackgroundImage=function(t){return Oo(this,void 0,void 0,function(){var n,i,s,a,o,A;return mo(this,function(f){switch(f.label){case 0:n=t.styles.backgroundImage.length-1,i=function(m){var v,x,B,Fe,et,nt,xe,_e,fe,M,Fe,et,nt,xe,_e,U,N,Q,q,Y,te,pe,ge,ye,fe,Oe,Fe,oe,le,xe,_e,tt,et,nt,Je,it,ot,xt,se,be,Me,De;return mo(this,function($e){switch($e.label){case 0:if(m.type!==0)return[3,5];v=void 0,x=m.url,$e.label=1;case 1:return $e.trys.push([1,3,,4]),[4,s.context.cache.match(x)];case 2:return v=$e.sent(),[3,4];case 3:return $e.sent(),s.context.logger.error("Error loading background-image "+x),[3,4];case 4:return v&&(B=Bx(t,n,[v.width,v.height,v.width/v.height]),Fe=B[0],et=B[1],nt=B[2],xe=B[3],_e=B[4],fe=s.ctx.createPattern(s.resizeImage(v,xe,_e),"repeat"),s.renderRepeat(Fe,fe,et,nt)),[3,6];case 5:Xie(m)?(M=Bx(t,n,[null,null,null]),Fe=M[0],et=M[1],nt=M[2],xe=M[3],_e=M[4],U=jie(m.angle,xe,_e),N=U[0],Q=U[1],q=U[2],Y=U[3],te=U[4],pe=document.createElement("canvas"),pe.width=xe,pe.height=_e,ge=pe.getContext("2d"),ye=ge.createLinearGradient(Q,Y,q,te),AM(m.stops,N).forEach(function(qe){return ye.addColorStop(qe.stop,Us(qe.color))}),ge.fillStyle=ye,ge.fillRect(0,0,xe,_e),xe>0&&_e>0&&(fe=s.ctx.createPattern(pe,"repeat"),s.renderRepeat(Fe,fe,et,nt))):Jie(m)&&(Oe=Bx(t,n,[null,null,null]),Fe=Oe[0],oe=Oe[1],le=Oe[2],xe=Oe[3],_e=Oe[4],tt=m.position.length===0?[J2]:m.position,et=mi(tt[0],xe),nt=mi(tt[tt.length-1],_e),Je=qie(m,et,nt,xe,_e),it=Je[0],ot=Je[1],it>0&&ot>0&&(xt=s.ctx.createRadialGradient(oe+et,le+nt,0,oe+et,le+nt,it),AM(m.stops,it*2).forEach(function(qe){return xt.addColorStop(qe.stop,Us(qe.color))}),s.path(Fe),s.ctx.fillStyle=xt,it!==ot?(se=t.bounds.left+.5*t.bounds.width,be=t.bounds.top+.5*t.bounds.height,Me=ot/it,De=1/Me,s.ctx.save(),s.ctx.translate(se,be),s.ctx.transform(1,0,0,Me,0,0),s.ctx.translate(-se,-be),s.ctx.fillRect(oe,De*(le-be)+be,xe,_e*De),s.ctx.restore()):s.ctx.fill())),$e.label=6;case 6:return n--,[2]}})},s=this,a=0,o=t.styles.backgroundImage.slice(0).reverse(),f.label=1;case 1:return a<o.length?(A=o[a],[5,i(A)]):[3,4];case 2:f.sent(),f.label=3;case 3:return a++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(t,n,i){return Oo(this,void 0,void 0,function(){return mo(this,function(s){return this.path(bP(i,n)),this.ctx.fillStyle=Us(t),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(t,n,i,s){return Oo(this,void 0,void 0,function(){var a,o;return mo(this,function(A){switch(A.label){case 0:return n<3?[4,this.renderSolidBorder(t,i,s)]:[3,2];case 1:return A.sent(),[2];case 2:return a=ece(s,i),this.path(a),this.ctx.fillStyle=Us(t),this.ctx.fill(),o=tce(s,i),this.path(o),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(t){return Oo(this,void 0,void 0,function(){var n,i,s,a,o,A,f,m,v=this;return mo(this,function(x){switch(x.label){case 0:return this.applyEffects(t.getEffects(2)),n=t.container.styles,i=!jA(n.backgroundColor)||n.backgroundImage.length,s=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],a=hce(Qf(n.backgroundClip,0),t.curves),i||n.boxShadow.length?(this.ctx.save(),this.path(a),this.ctx.clip(),jA(n.backgroundColor)||(this.ctx.fillStyle=Us(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(t.container)]):[3,2];case 1:x.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(B){v.ctx.save();var M=A1(t.curves),U=B.inset?0:lce,N=Yae(M,-U+(B.inset?1:-1)*B.spread.number,(B.inset?1:-1)*B.spread.number,B.spread.number*(B.inset?-2:2),B.spread.number*(B.inset?-2:2));B.inset?(v.path(M),v.ctx.clip(),v.mask(N)):(v.mask(M),v.ctx.clip(),v.path(N)),v.ctx.shadowOffsetX=B.offsetX.number+U,v.ctx.shadowOffsetY=B.offsetY.number,v.ctx.shadowColor=Us(B.color),v.ctx.shadowBlur=B.blur.number,v.ctx.fillStyle=B.inset?Us(B.color):"rgba(0,0,0,1)",v.ctx.fill(),v.ctx.restore()}),x.label=2;case 2:o=0,A=0,f=s,x.label=3;case 3:return A<f.length?(m=f[A],m.style!==0&&!jA(m.color)&&m.width>0?m.style!==2?[3,5]:[4,this.renderDashedDottedBorder(m.color,m.width,o,t.curves,2)]:[3,11]):[3,13];case 4:return x.sent(),[3,11];case 5:return m.style!==3?[3,7]:[4,this.renderDashedDottedBorder(m.color,m.width,o,t.curves,3)];case 6:return x.sent(),[3,11];case 7:return m.style!==4?[3,9]:[4,this.renderDoubleBorder(m.color,m.width,o,t.curves)];case 8:return x.sent(),[3,11];case 9:return[4,this.renderSolidBorder(m.color,o,t.curves)];case 10:x.sent(),x.label=11;case 11:o++,x.label=12;case 12:return A++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(t,n,i,s,a){return Oo(this,void 0,void 0,function(){var o,A,f,m,v,x,B,M,U,N,Q,q,Y,te,pe,ge,pe,ge;return mo(this,function(ye){return this.ctx.save(),o=rce(s,i),A=bP(s,i),a===2&&(this.path(A),this.ctx.clip()),lc(A[0])?(f=A[0].start.x,m=A[0].start.y):(f=A[0].x,m=A[0].y),lc(A[1])?(v=A[1].end.x,x=A[1].end.y):(v=A[1].x,x=A[1].y),i===0||i===2?B=Math.abs(f-v):B=Math.abs(m-x),this.ctx.beginPath(),a===3?this.formatPath(o):this.formatPath(A.slice(0,2)),M=n<3?n*3:n*2,U=n<3?n*2:n,a===3&&(M=n,U=n),N=!0,B<=M*2?N=!1:B<=M*2+U?(Q=B/(2*M+U),M*=Q,U*=Q):(q=Math.floor((B+U)/(M+U)),Y=(B-q*M)/(q-1),te=(B-(q+1)*M)/q,U=te<=0||Math.abs(U-Y)<Math.abs(U-te)?Y:te),N&&(a===3?this.ctx.setLineDash([0,M+U]):this.ctx.setLineDash([M,U])),a===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=Us(t),this.ctx.stroke(),this.ctx.setLineDash([]),a===2&&(lc(A[0])&&(pe=A[3],ge=A[0],this.ctx.beginPath(),this.formatPath([new ur(pe.end.x,pe.end.y),new ur(ge.start.x,ge.start.y)]),this.ctx.stroke()),lc(A[1])&&(pe=A[1],ge=A[2],this.ctx.beginPath(),this.formatPath([new ur(pe.end.x,pe.end.y),new ur(ge.start.x,ge.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(t){return Oo(this,void 0,void 0,function(){var n;return mo(this,function(i){switch(i.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Us(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=Zae(t),[4,this.renderStack(n)];case 1:return i.sent(),this.applyEffects([]),[2,this.canvas]}})})},e}(BP),Ace=function(r){return r instanceof WM||r instanceof KM?!0:r instanceof dx&&r.type!==s1&&r.type!==i1},hce=function(r,e){switch(r){case 0:return A1(e);case 2:return Kae(e);case 1:default:return h1(e)}},dce=function(r){switch(r){case 1:return"center";case 2:return"right";case 0:default:return"left"}},fce=["-apple-system","system-ui"],pce=function(r){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?r.filter(function(e){return fce.indexOf(e)===-1}):r},gce=function(r){Xc(e,r);function e(t,n){var i=r.call(this,t,n)||this;return i.canvas=n.canvas?n.canvas:document.createElement("canvas"),i.ctx=i.canvas.getContext("2d"),i.options=n,i.canvas.width=Math.floor(n.width*n.scale),i.canvas.height=Math.floor(n.height*n.scale),i.canvas.style.width=n.width+"px",i.canvas.style.height=n.height+"px",i.ctx.scale(i.options.scale,i.options.scale),i.ctx.translate(-n.x,-n.y),i.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),i}return e.prototype.render=function(t){return Oo(this,void 0,void 0,function(){var n,i;return mo(this,function(s){switch(s.label){case 0:return n=ux(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,t),[4,mce(n)];case 1:return i=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Us(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(i,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e}(BP),mce=function(r){return new Promise(function(e,t){var n=new Image;n.onload=function(){e(n)},n.onerror=t,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(r))})},yce=function(){function r(e){var t=e.id,n=e.enabled;this.id=t,this.enabled=n,this.start=Date.now()}return r.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,By([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},r.prototype.getTime=function(){return Date.now()-this.start},r.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,By([this.id,this.getTime()+"ms"],e))},r.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,By([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},r.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,By([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},r.instances={},r}(),_ce=function(){function r(e,t){var n;this.windowBounds=t,this.instanceName="#"+r.instanceCount++,this.logger=new yce({id:this.instanceName,enabled:e.logging}),this.cache=(n=e.cache)!==null&&n!==void 0?n:new Nae(this,e)}return r.instanceCount=1,r}(),vce=function(r,e){return e===void 0&&(e={}),bce(r,e)};typeof window<"u"&&pP.setContext(window);var bce=function(r,e){return Oo(void 0,void 0,void 0,function(){var t,n,i,s,a,o,A,f,m,v,x,B,M,U,N,Q,q,Y,te,pe,ye,ge,ye,fe,Oe,Fe,oe,le,xe,_e,tt,et,nt,Je,it,ot,xt,se,be,Me;return mo(this,function(De){switch(De.label){case 0:if(!r||typeof r!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(t=r.ownerDocument,!t)throw new Error("Element is not attached to a Document");if(n=t.defaultView,!n)throw new Error("Document is not attached to a Window");return i={allowTaint:(fe=e.allowTaint)!==null&&fe!==void 0?fe:!1,imageTimeout:(Oe=e.imageTimeout)!==null&&Oe!==void 0?Oe:15e3,proxy:e.proxy,useCORS:(Fe=e.useCORS)!==null&&Fe!==void 0?Fe:!1},s=L2({logging:(oe=e.logging)!==null&&oe!==void 0?oe:!0,cache:e.cache},i),a={windowWidth:(le=e.windowWidth)!==null&&le!==void 0?le:n.innerWidth,windowHeight:(xe=e.windowHeight)!==null&&xe!==void 0?xe:n.innerHeight,scrollX:(_e=e.scrollX)!==null&&_e!==void 0?_e:n.pageXOffset,scrollY:(tt=e.scrollY)!==null&&tt!==void 0?tt:n.pageYOffset},o=new Du(a.scrollX,a.scrollY,a.windowWidth,a.windowHeight),A=new _ce(s,o),f=(et=e.foreignObjectRendering)!==null&&et!==void 0?et:!1,m={allowTaint:(nt=e.allowTaint)!==null&&nt!==void 0?nt:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:f,copyStyles:f},A.logger.debug("Starting document clone with size "+o.width+"x"+o.height+" scrolled to "+-o.left+","+-o.top),v=new dP(A,r,m),x=v.clonedReferenceElement,x?[4,v.toIFrame(t,o)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return B=De.sent(),M=px(x)||wae(x)?Yre(x.ownerDocument):Cy(A,x),U=M.width,N=M.height,Q=M.left,q=M.top,Y=wce(A,x,e.backgroundColor),te={canvas:e.canvas,backgroundColor:Y,scale:(it=(Je=e.scale)!==null&&Je!==void 0?Je:n.devicePixelRatio)!==null&&it!==void 0?it:1,x:((ot=e.x)!==null&&ot!==void 0?ot:0)+Q,y:((xt=e.y)!==null&&xt!==void 0?xt:0)+q,width:(se=e.width)!==null&&se!==void 0?se:Math.ceil(U),height:(be=e.height)!==null&&be!==void 0?be:Math.ceil(N)},f?(A.logger.debug("Document cloned, using foreign object rendering"),ye=new gce(A,te),[4,ye.render(x)]):[3,3];case 2:return pe=De.sent(),[3,5];case 3:return A.logger.debug("Document cloned, element located at "+Q+","+q+" with size "+U+"x"+N+" using computed rendering"),A.logger.debug("Starting DOM parsing"),ge=JM(A,x),Y===ge.styles.backgroundColor&&(ge.styles.backgroundColor=Nu.TRANSPARENT),A.logger.debug("Starting renderer for element at "+te.x+","+te.y+" with size "+te.width+"x"+te.height),ye=new uce(A,te),[4,ye.render(ge)];case 4:pe=De.sent(),De.label=5;case 5:return(!((Me=e.removeContainer)!==null&&Me!==void 0)||Me)&&(dP.destroy(B)||A.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),A.logger.debug("Finished rendering"),[2,pe]}})})},wce=function(r,e,t){var n=e.ownerDocument,i=n.documentElement?Vg(r,getComputedStyle(n.documentElement).backgroundColor):Nu.TRANSPARENT,s=n.body?Vg(r,getComputedStyle(n.body).backgroundColor):Nu.TRANSPARENT,a=typeof t=="string"?Vg(r,t):t===null?Nu.TRANSPARENT:4294967295;return e===n.documentElement?jA(i)?jA(s)?a:s:i:a};const xce=Object.freeze(Object.defineProperty({__proto__:null,default:vce},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.5.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.0/LICENSE */function $A(r){"@babel/helpers - typeof";return $A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$A(r)}function Cx(r,e){return Cx=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},Cx(r,e)}function Bce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function m1(r,e,t){return Bce()?m1=Reflect.construct:m1=function(n,i,s){var a=[null];a.push.apply(a,i);var o=Function.bind.apply(n,a),A=new o;return s&&Cx(A,s.prototype),A},m1.apply(null,arguments)}function Yc(r){return Cce(r)||Ece(r)||Sce(r)||Tce()}function Cce(r){if(Array.isArray(r))return Ex(r)}function Ece(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Sce(r,e){if(r){if(typeof r=="string")return Ex(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ex(r,e)}}function Ex(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function Tce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ice=Object.hasOwnProperty,CP=Object.setPrototypeOf,Lce=Object.isFrozen,Fce=Object.getPrototypeOf,Mce=Object.getOwnPropertyDescriptor,No=Object.freeze,Ac=Object.seal,Pce=Object.create,EP=typeof Reflect<"u"&&Reflect,y1=EP.apply,Sx=EP.construct;y1||(y1=function(r,e,t){return r.apply(e,t)}),No||(No=function(r){return r}),Ac||(Ac=function(r){return r}),Sx||(Sx=function(r,e){return m1(r,Yc(e))});var Uce=hc(Array.prototype.forEach),SP=hc(Array.prototype.pop),Jg=hc(Array.prototype.push),_1=hc(String.prototype.toLowerCase),Tx=hc(String.prototype.toString),TP=hc(String.prototype.match),Zc=hc(String.prototype.replace),Rce=hc(String.prototype.indexOf),Oce=hc(String.prototype.trim),yo=hc(RegExp.prototype.test),Ix=Dce(TypeError);function hc(r){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return y1(r,e,n)}}function Dce(r){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Sx(r,t)}}function hn(r,e,t){var n;t=(n=t)!==null&&n!==void 0?n:_1,CP&&CP(r,null);for(var i=e.length;i--;){var s=e[i];if(typeof s=="string"){var a=t(s);a!==s&&(Lce(e)||(e[i]=a),s=a)}r[s]=!0}return r}function Jh(r){var e=Pce(null),t;for(t in r)y1(Ice,r,[t])===!0&&(e[t]=r[t]);return e}function v1(r,e){for(;r!==null;){var t=Mce(r,e);if(t){if(t.get)return hc(t.get);if(typeof t.value=="function")return hc(t.value)}r=Fce(r)}function n(i){return console.warn("fallback value for",i),null}return n}var IP=No(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Lx=No(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Fx=No(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),kce=No(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Mx=No(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Nce=No(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),LP=No(["#text"]),FP=No(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Px=No(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),MP=No(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),b1=No(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Qce=Ac(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Hce=Ac(/<%[\w\W]*|[\w\W]*%>/gm),zce=Ac(/\${[\w\W]*}/gm),Gce=Ac(/^data-[\-\w.\u00B7-\uFFFF]/),Vce=Ac(/^aria-[\-\w]+$/),jce=Ac(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),qce=Ac(/^(?:\w+script|data):/i),Kce=Ac(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Wce=Ac(/^html$/i),$ce=Ac(/^[a-z][.\w]*(-[.\w]+)+$/i),Xce=function(){return typeof window>"u"?null:window},Jce=function(r,e){if($A(r)!=="object"||typeof r.createPolicy!="function")return null;var t=null,n="data-tt-policy-suffix";e.currentScript&&e.currentScript.hasAttribute(n)&&(t=e.currentScript.getAttribute(n));var i="dompurify"+(t?"#"+t:"");try{return r.createPolicy(i,{createHTML:function(s){return s},createScriptURL:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function PP(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Xce(),e=function(ke){return PP(ke)};if(e.version="2.5.0",e.removed=[],!r||!r.document||r.document.nodeType!==9)return e.isSupported=!1,e;var t=r.document,n=r.document,i=r.DocumentFragment,s=r.HTMLTemplateElement,a=r.Node,o=r.Element,A=r.NodeFilter,f=r.NamedNodeMap,m=f===void 0?r.NamedNodeMap||r.MozNamedAttrMap:f,v=r.HTMLFormElement,x=r.DOMParser,B=r.trustedTypes,M=o.prototype,U=v1(M,"cloneNode"),N=v1(M,"nextSibling"),Q=v1(M,"childNodes"),q=v1(M,"parentNode");if(typeof s=="function"){var Y=n.createElement("template");Y.content&&Y.content.ownerDocument&&(n=Y.content.ownerDocument)}var te=Jce(B,t),pe=te?te.createHTML(""):"",ge=n,ye=ge.implementation,fe=ge.createNodeIterator,Oe=ge.createDocumentFragment,Fe=ge.getElementsByTagName,oe=t.importNode,le={};try{le=Jh(n).documentMode?n.documentMode:{}}catch{}var xe={};e.isSupported=typeof q=="function"&&ye&&ye.createHTMLDocument!==void 0&&le!==9;var _e=Qce,tt=Hce,et=zce,nt=Gce,Je=Vce,it=qce,ot=Kce,xt=$ce,se=jce,be=null,Me=hn({},[].concat(Yc(IP),Yc(Lx),Yc(Fx),Yc(Mx),Yc(LP))),De=null,$e=hn({},[].concat(Yc(FP),Yc(Px),Yc(MP),Yc(b1))),qe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ct=null,st=null,Ct=!0,It=!0,Qt=!1,Ht=!0,zt=!1,mt=!0,Re=!1,Ye=!1,tr=!1,St=!1,vt=!1,Bt=!1,kt=!0,ir=!1,Ar="user-content-",Lr=!0,Tr=!1,kr={},Qr=null,pt=hn({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ir=null,Dt=hn({},["audio","video","img","source","image","track"]),xn=null,Mr=hn({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Tt="http://www.w3.org/1998/Math/MathML",Jt="http://www.w3.org/2000/svg",Kt="http://www.w3.org/1999/xhtml",Yr=Kt,Or=!1,gr=null,an=hn({},[Tt,Jt,Kt],Tx),Wr,Ee=["application/xhtml+xml","text/html"],ee="text/html",Z,ae=null,Se=n.createElement("form"),Qe=function(ke){return ke instanceof RegExp||ke instanceof Function},Ge=function(ke){ae&&ae===ke||((!ke||$A(ke)!=="object")&&(ke={}),ke=Jh(ke),Wr=Ee.indexOf(ke.PARSER_MEDIA_TYPE)===-1?Wr=ee:Wr=ke.PARSER_MEDIA_TYPE,Z=Wr==="application/xhtml+xml"?Tx:_1,be="ALLOWED_TAGS"in ke?hn({},ke.ALLOWED_TAGS,Z):Me,De="ALLOWED_ATTR"in ke?hn({},ke.ALLOWED_ATTR,Z):$e,gr="ALLOWED_NAMESPACES"in ke?hn({},ke.ALLOWED_NAMESPACES,Tx):an,xn="ADD_URI_SAFE_ATTR"in ke?hn(Jh(Mr),ke.ADD_URI_SAFE_ATTR,Z):Mr,Ir="ADD_DATA_URI_TAGS"in ke?hn(Jh(Dt),ke.ADD_DATA_URI_TAGS,Z):Dt,Qr="FORBID_CONTENTS"in ke?hn({},ke.FORBID_CONTENTS,Z):pt,ct="FORBID_TAGS"in ke?hn({},ke.FORBID_TAGS,Z):{},st="FORBID_ATTR"in ke?hn({},ke.FORBID_ATTR,Z):{},kr="USE_PROFILES"in ke?ke.USE_PROFILES:!1,Ct=ke.ALLOW_ARIA_ATTR!==!1,It=ke.ALLOW_DATA_ATTR!==!1,Qt=ke.ALLOW_UNKNOWN_PROTOCOLS||!1,Ht=ke.ALLOW_SELF_CLOSE_IN_ATTR!==!1,zt=ke.SAFE_FOR_TEMPLATES||!1,mt=ke.SAFE_FOR_XML!==!1,Re=ke.WHOLE_DOCUMENT||!1,St=ke.RETURN_DOM||!1,vt=ke.RETURN_DOM_FRAGMENT||!1,Bt=ke.RETURN_TRUSTED_TYPE||!1,tr=ke.FORCE_BODY||!1,kt=ke.SANITIZE_DOM!==!1,ir=ke.SANITIZE_NAMED_PROPS||!1,Lr=ke.KEEP_CONTENT!==!1,Tr=ke.IN_PLACE||!1,se=ke.ALLOWED_URI_REGEXP||se,Yr=ke.NAMESPACE||Kt,qe=ke.CUSTOM_ELEMENT_HANDLING||{},ke.CUSTOM_ELEMENT_HANDLING&&Qe(ke.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(qe.tagNameCheck=ke.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ke.CUSTOM_ELEMENT_HANDLING&&Qe(ke.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(qe.attributeNameCheck=ke.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ke.CUSTOM_ELEMENT_HANDLING&&typeof ke.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(qe.allowCustomizedBuiltInElements=ke.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),zt&&(It=!1),vt&&(St=!0),kr&&(be=hn({},Yc(LP)),De=[],kr.html===!0&&(hn(be,IP),hn(De,FP)),kr.svg===!0&&(hn(be,Lx),hn(De,Px),hn(De,b1)),kr.svgFilters===!0&&(hn(be,Fx),hn(De,Px),hn(De,b1)),kr.mathMl===!0&&(hn(be,Mx),hn(De,MP),hn(De,b1))),ke.ADD_TAGS&&(be===Me&&(be=Jh(be)),hn(be,ke.ADD_TAGS,Z)),ke.ADD_ATTR&&(De===$e&&(De=Jh(De)),hn(De,ke.ADD_ATTR,Z)),ke.ADD_URI_SAFE_ATTR&&hn(xn,ke.ADD_URI_SAFE_ATTR,Z),ke.FORBID_CONTENTS&&(Qr===pt&&(Qr=Jh(Qr)),hn(Qr,ke.FORBID_CONTENTS,Z)),Lr&&(be["#text"]=!0),Re&&hn(be,["html","head","body"]),be.table&&(hn(be,["tbody"]),delete ct.tbody),No&&No(ke),ae=ke)},Ke=hn({},["mi","mo","mn","ms","mtext"]),Te=hn({},["foreignobject","desc","title","annotation-xml"]),Ze=hn({},["title","style","font","a","script"]),yt=hn({},Lx);hn(yt,Fx),hn(yt,kce);var gt=hn({},Mx);hn(gt,Nce);var ft=function(ke){var Rt=q(ke);(!Rt||!Rt.tagName)&&(Rt={namespaceURI:Yr,tagName:"template"});var Lt=_1(ke.tagName),nn=_1(Rt.tagName);return gr[ke.namespaceURI]?ke.namespaceURI===Jt?Rt.namespaceURI===Kt?Lt==="svg":Rt.namespaceURI===Tt?Lt==="svg"&&(nn==="annotation-xml"||Ke[nn]):!!yt[Lt]:ke.namespaceURI===Tt?Rt.namespaceURI===Kt?Lt==="math":Rt.namespaceURI===Jt?Lt==="math"&&Te[nn]:!!gt[Lt]:ke.namespaceURI===Kt?Rt.namespaceURI===Jt&&!Te[nn]||Rt.namespaceURI===Tt&&!Ke[nn]?!1:!gt[Lt]&&(Ze[Lt]||!yt[Lt]):!!(Wr==="application/xhtml+xml"&&gr[ke.namespaceURI]):!1},Vt=function(ke){Jg(e.removed,{element:ke});try{ke.parentNode.removeChild(ke)}catch{try{ke.outerHTML=pe}catch{ke.remove()}}},Yt=function(ke,Rt){try{Jg(e.removed,{attribute:Rt.getAttributeNode(ke),from:Rt})}catch{Jg(e.removed,{attribute:null,from:Rt})}if(Rt.removeAttribute(ke),ke==="is"&&!De[ke])if(St||vt)try{Vt(Rt)}catch{}else try{Rt.setAttribute(ke,"")}catch{}},Er=function(ke){var Rt,Lt;if(tr)ke="<remove></remove>"+ke;else{var nn=TP(ke,/^[\r\n\t ]+/);Lt=nn&&nn[0]}Wr==="application/xhtml+xml"&&Yr===Kt&&(ke='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ke+"</body></html>");var Pn=te?te.createHTML(ke):ke;if(Yr===Kt)try{Rt=new x().parseFromString(Pn,Wr)}catch{}if(!Rt||!Rt.documentElement){Rt=ye.createDocument(Yr,"template",null);try{Rt.documentElement.innerHTML=Or?pe:Pn}catch{}}var Br=Rt.body||Rt.documentElement;return ke&&Lt&&Br.insertBefore(n.createTextNode(Lt),Br.childNodes[0]||null),Yr===Kt?Fe.call(Rt,Re?"html":"body")[0]:Re?Rt.documentElement:Br},lr=function(ke){return fe.call(ke.ownerDocument||ke,ke,A.SHOW_ELEMENT|A.SHOW_COMMENT|A.SHOW_TEXT|A.SHOW_PROCESSING_INSTRUCTION|A.SHOW_CDATA_SECTION,null,!1)},Ur=function(ke){return ke instanceof v&&(typeof ke.nodeName!="string"||typeof ke.textContent!="string"||typeof ke.removeChild!="function"||!(ke.attributes instanceof m)||typeof ke.removeAttribute!="function"||typeof ke.setAttribute!="function"||typeof ke.namespaceURI!="string"||typeof ke.insertBefore!="function"||typeof ke.hasChildNodes!="function")},Nr=function(ke){return $A(a)==="object"?ke instanceof a:ke&&$A(ke)==="object"&&typeof ke.nodeType=="number"&&typeof ke.nodeName=="string"},Hr=function(ke,Rt,Lt){xe[ke]&&Uce(xe[ke],function(nn){nn.call(e,Rt,Lt,ae)})},mn=function(ke){var Rt;if(Hr("beforeSanitizeElements",ke,null),Ur(ke)||yo(/[\u0080-\uFFFF]/,ke.nodeName))return Vt(ke),!0;var Lt=Z(ke.nodeName);if(Hr("uponSanitizeElement",ke,{tagName:Lt,allowedTags:be}),ke.hasChildNodes()&&!Nr(ke.firstElementChild)&&(!Nr(ke.content)||!Nr(ke.content.firstElementChild))&&yo(/<[/\w]/g,ke.innerHTML)&&yo(/<[/\w]/g,ke.textContent)||Lt==="select"&&yo(/<template/i,ke.innerHTML)||ke.nodeType===7||mt&&ke.nodeType===8&&yo(/<[/\w]/g,ke.data))return Vt(ke),!0;if(!be[Lt]||ct[Lt]){if(!ct[Lt]&&$r(Lt)&&(qe.tagNameCheck instanceof RegExp&&yo(qe.tagNameCheck,Lt)||qe.tagNameCheck instanceof Function&&qe.tagNameCheck(Lt)))return!1;if(Lr&&!Qr[Lt]){var nn=q(ke)||ke.parentNode,Pn=Q(ke)||ke.childNodes;if(Pn&&nn)for(var Br=Pn.length,yn=Br-1;yn>=0;--yn)nn.insertBefore(U(Pn[yn],!0),N(ke))}return Vt(ke),!0}return ke instanceof o&&!ft(ke)||(Lt==="noscript"||Lt==="noembed"||Lt==="noframes")&&yo(/<\/no(script|embed|frames)/i,ke.innerHTML)?(Vt(ke),!0):(zt&&ke.nodeType===3&&(Rt=ke.textContent,Rt=Zc(Rt,_e," "),Rt=Zc(Rt,tt," "),Rt=Zc(Rt,et," "),ke.textContent!==Rt&&(Jg(e.removed,{element:ke.cloneNode()}),ke.textContent=Rt)),Hr("afterSanitizeElements",ke,null),!1)},mr=function(ke,Rt,Lt){if(kt&&(Rt==="id"||Rt==="name")&&(Lt in n||Lt in Se))return!1;if(!(It&&!st[Rt]&&yo(nt,Rt))&&!(Ct&&yo(Je,Rt))){if(!De[Rt]||st[Rt]){if(!($r(ke)&&(qe.tagNameCheck instanceof RegExp&&yo(qe.tagNameCheck,ke)||qe.tagNameCheck instanceof Function&&qe.tagNameCheck(ke))&&(qe.attributeNameCheck instanceof RegExp&&yo(qe.attributeNameCheck,Rt)||qe.attributeNameCheck instanceof Function&&qe.attributeNameCheck(Rt))||Rt==="is"&&qe.allowCustomizedBuiltInElements&&(qe.tagNameCheck instanceof RegExp&&yo(qe.tagNameCheck,Lt)||qe.tagNameCheck instanceof Function&&qe.tagNameCheck(Lt))))return!1}else if(!xn[Rt]&&!yo(se,Zc(Lt,ot,""))&&!((Rt==="src"||Rt==="xlink:href"||Rt==="href")&&ke!=="script"&&Rce(Lt,"data:")===0&&Ir[ke])&&!(Qt&&!yo(it,Zc(Lt,ot,"")))&&Lt)return!1}return!0},$r=function(ke){return ke!=="annotation-xml"&&TP(ke,xt)},bn=function(ke){var Rt,Lt,nn,Pn;Hr("beforeSanitizeAttributes",ke,null);var Br=ke.attributes;if(Br){var yn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:De};for(Pn=Br.length;Pn--;){Rt=Br[Pn];var wi=Rt,_n=wi.name,sn=wi.namespaceURI;if(Lt=_n==="value"?Rt.value:Oce(Rt.value),nn=Z(_n),yn.attrName=nn,yn.attrValue=Lt,yn.keepAttr=!0,yn.forceKeepAttr=void 0,Hr("uponSanitizeAttribute",ke,yn),Lt=yn.attrValue,!yn.forceKeepAttr&&(Yt(_n,ke),!!yn.keepAttr)){if(!Ht&&yo(/\/>/i,Lt)){Yt(_n,ke);continue}zt&&(Lt=Zc(Lt,_e," "),Lt=Zc(Lt,tt," "),Lt=Zc(Lt,et," "));var xi=Z(ke.nodeName);if(mr(xi,nn,Lt)){if(ir&&(nn==="id"||nn==="name")&&(Yt(_n,ke),Lt=Ar+Lt),te&&$A(B)==="object"&&typeof B.getAttributeType=="function"&&!sn)switch(B.getAttributeType(xi,nn)){case"TrustedHTML":{Lt=te.createHTML(Lt);break}case"TrustedScriptURL":{Lt=te.createScriptURL(Lt);break}}try{sn?ke.setAttributeNS(sn,_n,Lt):ke.setAttribute(_n,Lt),SP(e.removed)}catch{}}}}Hr("afterSanitizeAttributes",ke,null)}},kn=function ke(Rt){var Lt,nn=lr(Rt);for(Hr("beforeSanitizeShadowDOM",Rt,null);Lt=nn.nextNode();)Hr("uponSanitizeShadowNode",Lt,null),!mn(Lt)&&(Lt.content instanceof i&&ke(Lt.content),bn(Lt));Hr("afterSanitizeShadowDOM",Rt,null)};return e.sanitize=function(ke){var Rt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Lt,nn,Pn,Br,yn;if(Or=!ke,Or&&(ke="<!-->"),typeof ke!="string"&&!Nr(ke))if(typeof ke.toString=="function"){if(ke=ke.toString(),typeof ke!="string")throw Ix("dirty is not a string, aborting")}else throw Ix("toString is not a function");if(!e.isSupported){if($A(r.toStaticHTML)==="object"||typeof r.toStaticHTML=="function"){if(typeof ke=="string")return r.toStaticHTML(ke);if(Nr(ke))return r.toStaticHTML(ke.outerHTML)}return ke}if(Ye||Ge(Rt),e.removed=[],typeof ke=="string"&&(Tr=!1),Tr){if(ke.nodeName){var wi=Z(ke.nodeName);if(!be[wi]||ct[wi])throw Ix("root node is forbidden and cannot be sanitized in-place")}}else if(ke instanceof a)Lt=Er("<!---->"),nn=Lt.ownerDocument.importNode(ke,!0),nn.nodeType===1&&nn.nodeName==="BODY"||nn.nodeName==="HTML"?Lt=nn:Lt.appendChild(nn);else{if(!St&&!zt&&!Re&&ke.indexOf("<")===-1)return te&&Bt?te.createHTML(ke):ke;if(Lt=Er(ke),!Lt)return St?null:Bt?pe:""}Lt&&tr&&Vt(Lt.firstChild);for(var _n=lr(Tr?ke:Lt);Pn=_n.nextNode();)Pn.nodeType===3&&Pn===Br||mn(Pn)||(Pn.content instanceof i&&kn(Pn.content),bn(Pn),Br=Pn);if(Br=null,Tr)return ke;if(St){if(vt)for(yn=Oe.call(Lt.ownerDocument);Lt.firstChild;)yn.appendChild(Lt.firstChild);else yn=Lt;return(De.shadowroot||De.shadowrootmod)&&(yn=oe.call(t,yn,!0)),yn}var sn=Re?Lt.outerHTML:Lt.innerHTML;return Re&&be["!doctype"]&&Lt.ownerDocument&&Lt.ownerDocument.doctype&&Lt.ownerDocument.doctype.name&&yo(Wce,Lt.ownerDocument.doctype.name)&&(sn="<!DOCTYPE "+Lt.ownerDocument.doctype.name+`>
`+sn),zt&&(sn=Zc(sn,_e," "),sn=Zc(sn,tt," "),sn=Zc(sn,et," ")),te&&Bt?te.createHTML(sn):sn},e.setConfig=function(ke){Ge(ke),Ye=!0},e.clearConfig=function(){ae=null,Ye=!1},e.isValidAttribute=function(ke,Rt,Lt){ae||Ge({});var nn=Z(ke),Pn=Z(Rt);return mr(nn,Pn,Lt)},e.addHook=function(ke,Rt){typeof Rt=="function"&&(xe[ke]=xe[ke]||[],Jg(xe[ke],Rt))},e.removeHook=function(ke){if(xe[ke])return SP(xe[ke])},e.removeHooks=function(ke){xe[ke]&&(xe[ke]=[])},e.removeAllHooks=function(){xe={}},e}var Yce=PP();const Zce=Object.freeze(Object.defineProperty({__proto__:null,default:Yce},Symbol.toStringTag,{value:"Module"}));var Hf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function UP(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Yg=function(r){return r&&r.Math===Math&&r},ns=Yg(typeof globalThis=="object"&&globalThis)||Yg(typeof window=="object"&&window)||Yg(typeof self=="object"&&self)||Yg(typeof Hf=="object"&&Hf)||Yg(typeof Hf=="object"&&Hf)||function(){return this}()||Function("return this")(),Zg={},is=function(r){try{return!!r()}catch{return!0}},ele=is,el=!ele(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),tle=is,w1=!tle(function(){var r=(function(){}).bind();return typeof r!="function"||r.hasOwnProperty("prototype")}),rle=w1,x1=Function.prototype.call,Xs=rle?x1.bind(x1):function(){return x1.apply(x1,arguments)},RP={},OP={}.propertyIsEnumerable,DP=Object.getOwnPropertyDescriptor,nle=DP&&!OP.call({1:2},1);RP.f=nle?function(r){var e=DP(this,r);return!!e&&e.enumerable}:OP;var Ux=function(r,e){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:e}},kP=w1,NP=Function.prototype,Rx=NP.call,ile=kP&&NP.bind.bind(Rx,Rx),ss=kP?ile:function(r){return function(){return Rx.apply(r,arguments)}},QP=ss,sle=QP({}.toString),ole=QP("".slice),Yh=function(r){return ole(sle(r),8,-1)},ale=ss,cle=is,lle=Yh,Ox=Object,ule=ale("".split),HP=cle(function(){return!Ox("z").propertyIsEnumerable(0)})?function(r){return lle(r)==="String"?ule(r,""):Ox(r)}:Ox,Zh=function(r){return r==null},Ale=Zh,hle=TypeError,tl=function(r){if(Ale(r))throw new hle("Can't call method on "+r);return r},dle=HP,fle=tl,em=function(r){return dle(fle(r))},Dx=typeof document=="object"&&document.all,os=typeof Dx>"u"&&Dx!==void 0?function(r){return typeof r=="function"||r===Dx}:function(r){return typeof r=="function"},ple=os,rl=function(r){return typeof r=="object"?r!==null:ple(r)},kx=ns,gle=os,mle=function(r){return gle(r)?r:void 0},ed=function(r,e){return arguments.length<2?mle(kx[r]):kx[r]&&kx[r][e]},yle=ss,B1=yle({}.isPrototypeOf),C1=typeof navigator<"u"&&String(navigator.userAgent)||"",zP=ns,Nx=C1,GP=zP.process,VP=zP.Deno,jP=GP&&GP.versions||VP&&VP.version,qP=jP&&jP.v8,nl,E1;qP&&(nl=qP.split("."),E1=nl[0]>0&&nl[0]<4?1:+(nl[0]+nl[1])),!E1&&Nx&&(nl=Nx.match(/Edge\/(\d+)/),(!nl||nl[1]>=74)&&(nl=Nx.match(/Chrome\/(\d+)/),nl&&(E1=+nl[1])));var Qx=E1,KP=Qx,_le=is,vle=ns,ble=vle.String,WP=!!Object.getOwnPropertySymbols&&!_le(function(){var r=Symbol("symbol detection");return!ble(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&KP&&KP<41}),wle=WP,$P=wle&&!Symbol.sham&&typeof Symbol.iterator=="symbol",xle=ed,Ble=os,Cle=B1,Ele=$P,Sle=Object,XP=Ele?function(r){return typeof r=="symbol"}:function(r){var e=xle("Symbol");return Ble(e)&&Cle(e.prototype,Sle(r))},Tle=String,S1=function(r){try{return Tle(r)}catch{return"Object"}},Ile=os,Lle=S1,Fle=TypeError,Hu=function(r){if(Ile(r))return r;throw new Fle(Lle(r)+" is not a function")},Mle=Hu,Ple=Zh,zf=function(r,e){var t=r[e];return Ple(t)?void 0:Mle(t)},Hx=Xs,zx=os,Gx=rl,Ule=TypeError,Rle=function(r,e){var t,n;if(e==="string"&&zx(t=r.toString)&&!Gx(n=Hx(t,r))||zx(t=r.valueOf)&&!Gx(n=Hx(t,r))||e!=="string"&&zx(t=r.toString)&&!Gx(n=Hx(t,r)))return n;throw new Ule("Can't convert object to primitive value")},JP={exports:{}},YP=ns,Ole=Object.defineProperty,Vx=function(r,e){try{Ole(YP,r,{value:e,configurable:!0,writable:!0})}catch{YP[r]=e}return e},Dle=ns,kle=Vx,ZP="__core-js_shared__",eU=JP.exports=Dle[ZP]||kle(ZP,{});(eU.versions||(eU.versions=[])).push({version:"3.36.1",mode:"global",copyright:" 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.36.1/LICENSE",source:"https://github.com/zloirock/core-js"});var jx=JP.exports,tU=jx,qx=function(r,e){return tU[r]||(tU[r]=e||{})},Nle=tl,Qle=Object,T1=function(r){return Qle(Nle(r))},Hle=ss,zle=T1,Gle=Hle({}.hasOwnProperty),il=Object.hasOwn||function(r,e){return Gle(zle(r),e)},Vle=ss,jle=0,qle=Math.random(),Kle=Vle(1 .toString),rU=function(r){return"Symbol("+(r===void 0?"":r)+")_"+Kle(++jle+qle,36)},Wle=ns,$le=qx,nU=il,Xle=rU,Jle=WP,Yle=$P,Gf=Wle.Symbol,Kx=$le("wks"),Zle=Yle?Gf.for||Gf:Gf&&Gf.withoutSetter||Xle,Rs=function(r){return nU(Kx,r)||(Kx[r]=Jle&&nU(Gf,r)?Gf[r]:Zle("Symbol."+r)),Kx[r]},eue=Xs,iU=rl,sU=XP,tue=zf,rue=Rle,nue=Rs,iue=TypeError,sue=nue("toPrimitive"),oue=function(r,e){if(!iU(r)||sU(r))return r;var t=tue(r,sue),n;if(t){if(e===void 0&&(e="default"),n=eue(t,r,e),!iU(n)||sU(n))return n;throw new iue("Can't convert object to primitive value")}return e===void 0&&(e="number"),rue(r,e)},aue=oue,cue=XP,oU=function(r){var e=aue(r,"string");return cue(e)?e:e+""},lue=ns,aU=rl,Wx=lue.document,uue=aU(Wx)&&aU(Wx.createElement),I1=function(r){return uue?Wx.createElement(r):{}},Aue=el,hue=is,due=I1,cU=!Aue&&!hue(function(){return Object.defineProperty(due("div"),"a",{get:function(){return 7}}).a!==7}),fue=el,pue=Xs,gue=RP,mue=Ux,yue=em,_ue=oU,vue=il,bue=cU,lU=Object.getOwnPropertyDescriptor;Zg.f=fue?lU:function(r,e){if(r=yue(r),e=_ue(e),bue)try{return lU(r,e)}catch{}if(vue(r,e))return mue(!pue(gue.f,r,e),r[e])};var zu={},wue=el,xue=is,uU=wue&&xue(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Bue=rl,Cue=String,Eue=TypeError,Qo=function(r){if(Bue(r))return r;throw new Eue(Cue(r)+" is not an object")},Sue=el,Tue=cU,Iue=uU,L1=Qo,AU=oU,Lue=TypeError,$x=Object.defineProperty,Fue=Object.getOwnPropertyDescriptor,Xx="enumerable",Jx="configurable",Yx="writable";zu.f=Sue?Iue?function(r,e,t){if(L1(r),e=AU(e),L1(t),typeof r=="function"&&e==="prototype"&&"value"in t&&Yx in t&&!t[Yx]){var n=Fue(r,e);n&&n[Yx]&&(r[e]=t.value,t={configurable:Jx in t?t[Jx]:n[Jx],enumerable:Xx in t?t[Xx]:n[Xx],writable:!1})}return $x(r,e,t)}:$x:function(r,e,t){if(L1(r),e=AU(e),L1(t),Tue)try{return $x(r,e,t)}catch{}if("get"in t||"set"in t)throw new Lue("Accessors not supported");return"value"in t&&(r[e]=t.value),r};var Mue=el,Pue=zu,Uue=Ux,tm=Mue?function(r,e,t){return Pue.f(r,e,Uue(1,t))}:function(r,e,t){return r[e]=t,r},hU={exports:{}},Zx=el,Rue=il,dU=Function.prototype,Oue=Zx&&Object.getOwnPropertyDescriptor,eB=Rue(dU,"name"),Due=eB&&(function(){}).name==="something",kue=eB&&(!Zx||Zx&&Oue(dU,"name").configurable),F1={EXISTS:eB,PROPER:Due,CONFIGURABLE:kue},Nue=ss,Que=os,tB=jx,Hue=Nue(Function.toString);Que(tB.inspectSource)||(tB.inspectSource=function(r){return Hue(r)});var rB=tB.inspectSource,zue=ns,Gue=os,fU=zue.WeakMap,Vue=Gue(fU)&&/native code/.test(String(fU)),jue=qx,que=rU,pU=jue("keys"),nB=function(r){return pU[r]||(pU[r]=que(r))},iB={},Kue=Vue,gU=ns,Wue=rl,$ue=tm,sB=il,oB=jx,Xue=nB,Jue=iB,mU="Object already initialized",aB=gU.TypeError,Yue=gU.WeakMap,M1,rm,P1,Zue=function(r){return P1(r)?rm(r):M1(r,{})},eAe=function(r){return function(e){var t;if(!Wue(e)||(t=rm(e)).type!==r)throw new aB("Incompatible receiver, "+r+" required");return t}};if(Kue||oB.state){var Zl=oB.state||(oB.state=new Yue);Zl.get=Zl.get,Zl.has=Zl.has,Zl.set=Zl.set,M1=function(r,e){if(Zl.has(r))throw new aB(mU);return e.facade=r,Zl.set(r,e),e},rm=function(r){return Zl.get(r)||{}},P1=function(r){return Zl.has(r)}}else{var Vf=Xue("state");Jue[Vf]=!0,M1=function(r,e){if(sB(r,Vf))throw new aB(mU);return e.facade=r,$ue(r,Vf,e),e},rm=function(r){return sB(r,Vf)?r[Vf]:{}},P1=function(r){return sB(r,Vf)}}var U1={set:M1,get:rm,has:P1,enforce:Zue,getterFor:eAe},cB=ss,tAe=is,rAe=os,R1=il,lB=el,nAe=F1.CONFIGURABLE,iAe=rB,yU=U1,sAe=yU.enforce,oAe=yU.get,_U=String,O1=Object.defineProperty,aAe=cB("".slice),cAe=cB("".replace),lAe=cB([].join),uAe=lB&&!tAe(function(){return O1(function(){},"length",{value:8}).length!==8}),AAe=String(String).split("String"),hAe=hU.exports=function(r,e,t){aAe(_U(e),0,7)==="Symbol("&&(e="["+cAe(_U(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),t&&t.getter&&(e="get "+e),t&&t.setter&&(e="set "+e),(!R1(r,"name")||nAe&&r.name!==e)&&(lB?O1(r,"name",{value:e,configurable:!0}):r.name=e),uAe&&t&&R1(t,"arity")&&r.length!==t.arity&&O1(r,"length",{value:t.arity});try{t&&R1(t,"constructor")&&t.constructor?lB&&O1(r,"prototype",{writable:!1}):r.prototype&&(r.prototype=void 0)}catch{}var n=sAe(r);return R1(n,"source")||(n.source=lAe(AAe,typeof e=="string"?e:"")),r};Function.prototype.toString=hAe(function(){return rAe(this)&&oAe(this).source||iAe(this)},"toString");var vU=hU.exports,dAe=os,fAe=zu,pAe=vU,gAe=Vx,td=function(r,e,t,n){n||(n={});var i=n.enumerable,s=n.name!==void 0?n.name:e;if(dAe(t)&&pAe(t,s,n),n.global)i?r[e]=t:gAe(e,t);else{try{n.unsafe?r[e]&&(i=!0):delete r[e]}catch{}i?r[e]=t:fAe.f(r,e,{value:t,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return r},bU={},mAe=Math.ceil,yAe=Math.floor,_Ae=Math.trunc||function(r){var e=+r;return(e>0?yAe:mAe)(e)},vAe=_Ae,D1=function(r){var e=+r;return e!==e||e===0?0:vAe(e)},bAe=D1,wAe=Math.max,xAe=Math.min,BAe=function(r,e){var t=bAe(r);return t<0?wAe(t+e,0):xAe(t,e)},CAe=D1,EAe=Math.min,jf=function(r){var e=CAe(r);return e>0?EAe(e,9007199254740991):0},SAe=jf,uB=function(r){return SAe(r.length)},TAe=em,IAe=BAe,LAe=uB,wU=function(r){return function(e,t,n){var i=TAe(e),s=LAe(i);if(s===0)return!r&&-1;var a=IAe(n,s),o;if(r&&t!==t){for(;s>a;)if(o=i[a++],o!==o)return!0}else for(;s>a;a++)if((r||a in i)&&i[a]===t)return r||a||0;return!r&&-1}},xU={includes:wU(!0),indexOf:wU(!1)},FAe=ss,AB=il,MAe=em,PAe=xU.indexOf,UAe=iB,BU=FAe([].push),CU=function(r,e){var t=MAe(r),n=0,i=[],s;for(s in t)!AB(UAe,s)&&AB(t,s)&&BU(i,s);for(;e.length>n;)AB(t,s=e[n++])&&(~PAe(i,s)||BU(i,s));return i},hB=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],RAe=CU,OAe=hB,DAe=OAe.concat("length","prototype");bU.f=Object.getOwnPropertyNames||function(r){return RAe(r,DAe)};var EU={};EU.f=Object.getOwnPropertySymbols;var kAe=ed,NAe=ss,QAe=bU,HAe=EU,zAe=Qo,GAe=NAe([].concat),VAe=kAe("Reflect","ownKeys")||function(r){var e=QAe.f(zAe(r)),t=HAe.f;return t?GAe(e,t(r)):e},SU=il,jAe=VAe,qAe=Zg,KAe=zu,WAe=function(r,e,t){for(var n=jAe(e),i=KAe.f,s=qAe.f,a=0;a<n.length;a++){var o=n[a];!SU(r,o)&&!(t&&SU(t,o))&&i(r,o,s(e,o))}},$Ae=is,XAe=os,JAe=/#|\.prototype\./,nm=function(r,e){var t=ZAe[YAe(r)];return t===the?!0:t===ehe?!1:XAe(e)?$Ae(e):!!e},YAe=nm.normalize=function(r){return String(r).replace(JAe,".").toLowerCase()},ZAe=nm.data={},ehe=nm.NATIVE="N",the=nm.POLYFILL="P",TU=nm,k1=ns,rhe=Zg.f,nhe=tm,ihe=td,she=Vx,ohe=WAe,ahe=TU,Ho=function(r,e){var t=r.target,n=r.global,i=r.stat,s,a,o,A,f,m;if(n?a=k1:i?a=k1[t]||she(t,{}):a=k1[t]&&k1[t].prototype,a)for(o in e){if(f=e[o],r.dontCallGetSet?(m=rhe(a,o),A=m&&m.value):A=a[o],s=ahe(n?o:t+(i?".":"#")+o,r.forced),!s&&A!==void 0){if(typeof f==typeof A)continue;ohe(f,A)}(r.sham||A&&A.sham)&&nhe(f,"sham",!0),ihe(a,o,f,r)}},che=ns,lhe=Yh,im=lhe(che.process)==="process",uhe=ss,Ahe=Hu,hhe=function(r,e,t){try{return uhe(Ahe(Object.getOwnPropertyDescriptor(r,e)[t]))}catch{}},dhe=rl,fhe=function(r){return dhe(r)||r===null},phe=fhe,ghe=String,mhe=TypeError,yhe=function(r){if(phe(r))return r;throw new mhe("Can't set "+ghe(r)+" as a prototype")},_he=hhe,vhe=rl,bhe=tl,whe=yhe,IU=Object.setPrototypeOf||("__proto__"in{}?function(){var r=!1,e={},t;try{t=_he(Object.prototype,"__proto__","set"),t(e,[]),r=e instanceof Array}catch{}return function(n,i){return bhe(n),whe(i),vhe(n)&&(r?t(n,i):n.__proto__=i),n}}():void 0),xhe=zu.f,Bhe=il,Che=Rs,LU=Che("toStringTag"),N1=function(r,e,t){r&&!t&&(r=r.prototype),r&&!Bhe(r,LU)&&xhe(r,LU,{configurable:!0,value:e})},FU=vU,Ehe=zu,She=function(r,e,t){return t.get&&FU(t.get,e,{getter:!0}),t.set&&FU(t.set,e,{setter:!0}),Ehe.f(r,e,t)},The=ed,Ihe=She,Lhe=Rs,Fhe=el,MU=Lhe("species"),Mhe=function(r){var e=The(r);Fhe&&e&&!e[MU]&&Ihe(e,MU,{configurable:!0,get:function(){return this}})},Phe=B1,Uhe=TypeError,Rhe=function(r,e){if(Phe(e,r))return r;throw new Uhe("Incorrect invocation")},Ohe=Rs,Dhe=Ohe("toStringTag"),PU={};PU[Dhe]="z";var khe=String(PU)==="[object z]",Nhe=khe,Qhe=os,Q1=Yh,Hhe=Rs,zhe=Hhe("toStringTag"),Ghe=Object,Vhe=Q1(function(){return arguments}())==="Arguments",jhe=function(r,e){try{return r[e]}catch{}},dB=Nhe?Q1:function(r){var e,t,n;return r===void 0?"Undefined":r===null?"Null":typeof(t=jhe(e=Ghe(r),zhe))=="string"?t:Vhe?Q1(e):(n=Q1(e))==="Object"&&Qhe(e.callee)?"Arguments":n},qhe=ss,Khe=is,UU=os,Whe=dB,$he=ed,Xhe=rB,RU=function(){},OU=$he("Reflect","construct"),fB=/^\s*(?:class|function)\b/,Jhe=qhe(fB.exec),Yhe=!fB.test(RU),sm=function(r){if(!UU(r))return!1;try{return OU(RU,[],r),!0}catch{return!1}},DU=function(r){if(!UU(r))return!1;switch(Whe(r)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Yhe||!!Jhe(fB,Xhe(r))}catch{return!0}};DU.sham=!0;var Zhe=!OU||Khe(function(){var r;return sm(sm.call)||!sm(Object)||!sm(function(){r=!0})||r})?DU:sm,ede=Zhe,tde=S1,rde=TypeError,nde=function(r){if(ede(r))return r;throw new rde(tde(r)+" is not a constructor")},kU=Qo,ide=nde,sde=Zh,ode=Rs,ade=ode("species"),NU=function(r,e){var t=kU(r).constructor,n;return t===void 0||sde(n=kU(t)[ade])?e:ide(n)},cde=w1,QU=Function.prototype,HU=QU.apply,zU=QU.call,GU=typeof Reflect=="object"&&Reflect.apply||(cde?zU.bind(HU):function(){return zU.apply(HU,arguments)}),lde=Yh,ude=ss,H1=function(r){if(lde(r)==="Function")return ude(r)},VU=H1,Ade=Hu,hde=w1,dde=VU(VU.bind),pB=function(r,e){return Ade(r),e===void 0?r:hde?dde(r,e):function(){return r.apply(e,arguments)}},fde=ed,jU=fde("document","documentElement"),pde=ss,gde=pde([].slice),mde=TypeError,yde=function(r,e){if(r<e)throw new mde("Not enough arguments");return r},_de=C1,qU=/(?:ipad|iphone|ipod).*applewebkit/i.test(_de),Na=ns,vde=GU,bde=pB,KU=os,wde=il,WU=is,$U=jU,xde=gde,XU=I1,Bde=yde,Cde=qU,Ede=im,gB=Na.setImmediate,mB=Na.clearImmediate,Sde=Na.process,yB=Na.Dispatch,Tde=Na.Function,JU=Na.MessageChannel,Ide=Na.String,_B=0,om={},YU="onreadystatechange",am,rd,vB,bB;WU(function(){am=Na.location});var wB=function(r){if(wde(om,r)){var e=om[r];delete om[r],e()}},xB=function(r){return function(){wB(r)}},ZU=function(r){wB(r.data)},eR=function(r){Na.postMessage(Ide(r),am.protocol+"//"+am.host)};(!gB||!mB)&&(gB=function(r){Bde(arguments.length,1);var e=KU(r)?r:Tde(r),t=xde(arguments,1);return om[++_B]=function(){vde(e,void 0,t)},rd(_B),_B},mB=function(r){delete om[r]},Ede?rd=function(r){Sde.nextTick(xB(r))}:yB&&yB.now?rd=function(r){yB.now(xB(r))}:JU&&!Cde?(vB=new JU,bB=vB.port2,vB.port1.onmessage=ZU,rd=bde(bB.postMessage,bB)):Na.addEventListener&&KU(Na.postMessage)&&!Na.importScripts&&am&&am.protocol!=="file:"&&!WU(eR)?(rd=eR,Na.addEventListener("message",ZU,!1)):YU in XU("script")?rd=function(r){$U.appendChild(XU("script"))[YU]=function(){$U.removeChild(this),wB(r)}}:rd=function(r){setTimeout(xB(r),0)});var tR={set:gB,clear:mB},rR=ns,Lde=el,Fde=Object.getOwnPropertyDescriptor,Mde=function(r){if(!Lde)return rR[r];var e=Fde(rR,r);return e&&e.value},nR=function(){this.head=null,this.tail=null};nR.prototype={add:function(r){var e={item:r,next:null},t=this.tail;t?t.next=e:this.head=e,this.tail=e},get:function(){var r=this.head;if(r){var e=this.head=r.next;return e===null&&(this.tail=null),r.item}}};var iR=nR,Pde=C1,Ude=/ipad|iphone|ipod/i.test(Pde)&&typeof Pebble<"u",Rde=C1,Ode=/web0s(?!.*chrome)/i.test(Rde),qf=ns,Dde=Mde,sR=pB,BB=tR.set,kde=iR,Nde=qU,Qde=Ude,Hde=Ode,CB=im,oR=qf.MutationObserver||qf.WebKitMutationObserver,aR=qf.document,cR=qf.process,z1=qf.Promise,EB=Dde("queueMicrotask"),Kf,SB,TB,G1,lR;if(!EB){var V1=new kde,j1=function(){var r,e;for(CB&&(r=cR.domain)&&r.exit();e=V1.get();)try{e()}catch(t){throw V1.head&&Kf(),t}r&&r.enter()};!Nde&&!CB&&!Hde&&oR&&aR?(SB=!0,TB=aR.createTextNode(""),new oR(j1).observe(TB,{characterData:!0}),Kf=function(){TB.data=SB=!SB}):!Qde&&z1&&z1.resolve?(G1=z1.resolve(void 0),G1.constructor=z1,lR=sR(G1.then,G1),Kf=function(){lR(j1)}):CB?Kf=function(){cR.nextTick(j1)}:(BB=sR(BB,qf),Kf=function(){BB(j1)}),EB=function(r){V1.head||Kf(),V1.add(r)}}var zde=EB,Gde=function(r,e){try{arguments.length===1?console.error(r):console.error(r,e)}catch{}},IB=function(r){try{return{error:!1,value:r()}}catch(e){return{error:!0,value:e}}},Vde=ns,q1=Vde.Promise,uR=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",jde=uR,qde=im,Kde=!jde&&!qde&&typeof window=="object"&&typeof document=="object",Wde=ns,cm=q1,$de=os,Xde=TU,Jde=rB,Yde=Rs,Zde=Kde,efe=uR,LB=Qx;cm&&cm.prototype;var tfe=Yde("species"),FB=!1,AR=$de(Wde.PromiseRejectionEvent),rfe=Xde("Promise",function(){var r=Jde(cm),e=r!==String(cm);if(!e&&LB===66)return!0;if(!LB||LB<51||!/native code/.test(r)){var t=new cm(function(s){s(1)}),n=function(s){s(function(){},function(){})},i=t.constructor={};if(i[tfe]=n,FB=t.then(function(){})instanceof n,!FB)return!0}return!e&&(Zde||efe)&&!AR}),lm={CONSTRUCTOR:rfe,REJECTION_EVENT:AR,SUBCLASSING:FB},Wf={},hR=Hu,nfe=TypeError,ife=function(r){var e,t;this.promise=new r(function(n,i){if(e!==void 0||t!==void 0)throw new nfe("Bad Promise constructor");e=n,t=i}),this.resolve=hR(e),this.reject=hR(t)};Wf.f=function(r){return new ife(r)};var sfe=Ho,K1=im,XA=ns,$f=Xs,dR=td,fR=IU,ofe=N1,afe=Mhe,cfe=Hu,W1=os,lfe=rl,ufe=Rhe,Afe=NU,pR=tR.set,MB=zde,hfe=Gde,dfe=IB,ffe=iR,gR=U1,$1=q1,PB=lm,mR=Wf,X1="Promise",yR=PB.CONSTRUCTOR,pfe=PB.REJECTION_EVENT,gfe=PB.SUBCLASSING,UB=gR.getterFor(X1),mfe=gR.set,Xf=$1&&$1.prototype,nd=$1,J1=Xf,_R=XA.TypeError,RB=XA.document,OB=XA.process,DB=mR.f,yfe=DB,_fe=!!(RB&&RB.createEvent&&XA.dispatchEvent),vR="unhandledrejection",vfe="rejectionhandled",bR=0,wR=1,bfe=2,kB=1,xR=2,Y1,BR,wfe,CR,ER=function(r){var e;return lfe(r)&&W1(e=r.then)?e:!1},SR=function(r,e){var t=e.value,n=e.state===wR,i=n?r.ok:r.fail,s=r.resolve,a=r.reject,o=r.domain,A,f,m;try{i?(n||(e.rejection===xR&&Bfe(e),e.rejection=kB),i===!0?A=t:(o&&o.enter(),A=i(t),o&&(o.exit(),m=!0)),A===r.promise?a(new _R("Promise-chain cycle")):(f=ER(A))?$f(f,A,s,a):s(A)):a(t)}catch(v){o&&!m&&o.exit(),a(v)}},TR=function(r,e){r.notified||(r.notified=!0,MB(function(){for(var t=r.reactions,n;n=t.get();)SR(n,r);r.notified=!1,e&&!r.rejection&&xfe(r)}))},IR=function(r,e,t){var n,i;_fe?(n=RB.createEvent("Event"),n.promise=e,n.reason=t,n.initEvent(r,!1,!0),XA.dispatchEvent(n)):n={promise:e,reason:t},!pfe&&(i=XA["on"+r])?i(n):r===vR&&hfe("Unhandled promise rejection",t)},xfe=function(r){$f(pR,XA,function(){var e=r.facade,t=r.value,n=LR(r),i;if(n&&(i=dfe(function(){K1?OB.emit("unhandledRejection",t,e):IR(vR,e,t)}),r.rejection=K1||LR(r)?xR:kB,i.error))throw i.value})},LR=function(r){return r.rejection!==kB&&!r.parent},Bfe=function(r){$f(pR,XA,function(){var e=r.facade;K1?OB.emit("rejectionHandled",e):IR(vfe,e,r.value)})},Jf=function(r,e,t){return function(n){r(e,n,t)}},Yf=function(r,e,t){r.done||(r.done=!0,t&&(r=t),r.value=e,r.state=bfe,TR(r,!0))},NB=function(r,e,t){if(!r.done){r.done=!0,t&&(r=t);try{if(r.facade===e)throw new _R("Promise can't be resolved itself");var n=ER(e);n?MB(function(){var i={done:!1};try{$f(n,e,Jf(NB,i,r),Jf(Yf,i,r))}catch(s){Yf(i,s,r)}}):(r.value=e,r.state=wR,TR(r,!1))}catch(i){Yf({done:!1},i,r)}}};if(yR&&(nd=function(r){ufe(this,J1),cfe(r),$f(Y1,this);var e=UB(this);try{r(Jf(NB,e),Jf(Yf,e))}catch(t){Yf(e,t)}},J1=nd.prototype,Y1=function(r){mfe(this,{type:X1,done:!1,notified:!1,parent:!1,reactions:new ffe,rejection:!1,state:bR,value:void 0})},Y1.prototype=dR(J1,"then",function(r,e){var t=UB(this),n=DB(Afe(this,nd));return t.parent=!0,n.ok=W1(r)?r:!0,n.fail=W1(e)&&e,n.domain=K1?OB.domain:void 0,t.state===bR?t.reactions.add(n):MB(function(){SR(n,t)}),n.promise}),BR=function(){var r=new Y1,e=UB(r);this.promise=r,this.resolve=Jf(NB,e),this.reject=Jf(Yf,e)},mR.f=DB=function(r){return r===nd||r===wfe?new BR(r):yfe(r)},W1($1)&&Xf!==Object.prototype)){CR=Xf.then,gfe||dR(Xf,"then",function(r,e){var t=this;return new nd(function(n,i){$f(CR,t,n,i)}).then(r,e)},{unsafe:!0});try{delete Xf.constructor}catch{}fR&&fR(Xf,J1)}sfe({global:!0,constructor:!0,wrap:!0,forced:yR},{Promise:nd}),ofe(nd,X1,!1),afe(X1);var um={},Cfe=Rs,Efe=um,Sfe=Cfe("iterator"),Tfe=Array.prototype,Ife=function(r){return r!==void 0&&(Efe.Array===r||Tfe[Sfe]===r)},Lfe=dB,FR=zf,Ffe=Zh,Mfe=um,Pfe=Rs,Ufe=Pfe("iterator"),MR=function(r){if(!Ffe(r))return FR(r,Ufe)||FR(r,"@@iterator")||Mfe[Lfe(r)]},Rfe=Xs,Ofe=Hu,Dfe=Qo,kfe=S1,Nfe=MR,Qfe=TypeError,Hfe=function(r,e){var t=arguments.length<2?Nfe(r):e;if(Ofe(t))return Dfe(Rfe(t,r));throw new Qfe(kfe(r)+" is not iterable")},zfe=Xs,PR=Qo,Gfe=zf,Vfe=function(r,e,t){var n,i;PR(r);try{if(n=Gfe(r,"return"),!n){if(e==="throw")throw t;return t}n=zfe(n,r)}catch(s){i=!0,n=s}if(e==="throw")throw t;if(i)throw n;return PR(n),t},jfe=pB,qfe=Xs,Kfe=Qo,Wfe=S1,$fe=Ife,Xfe=uB,UR=B1,Jfe=Hfe,Yfe=MR,RR=Vfe,Zfe=TypeError,Z1=function(r,e){this.stopped=r,this.result=e},OR=Z1.prototype,DR=function(r,e,t){var n=t&&t.that,i=!!(t&&t.AS_ENTRIES),s=!!(t&&t.IS_RECORD),a=!!(t&&t.IS_ITERATOR),o=!!(t&&t.INTERRUPTED),A=jfe(e,n),f,m,v,x,B,M,U,N=function(q){return f&&RR(f,"normal",q),new Z1(!0,q)},Q=function(q){return i?(Kfe(q),o?A(q[0],q[1],N):A(q[0],q[1])):o?A(q,N):A(q)};if(s)f=r.iterator;else if(a)f=r;else{if(m=Yfe(r),!m)throw new Zfe(Wfe(r)+" is not iterable");if($fe(m)){for(v=0,x=Xfe(r);x>v;v++)if(B=Q(r[v]),B&&UR(OR,B))return B;return new Z1(!1)}f=Jfe(r,m)}for(M=s?r.next:f.next;!(U=qfe(M,f)).done;){try{B=Q(U.value)}catch(q){RR(f,"throw",q)}if(typeof B=="object"&&B&&UR(OR,B))return B}return new Z1(!1)},epe=Rs,kR=epe("iterator"),NR=!1;try{var tpe=0,QR={next:function(){return{done:!!tpe++}},return:function(){NR=!0}};QR[kR]=function(){return this},Array.from(QR,function(){throw 2})}catch{}var rpe=function(r,e){try{if(!e&&!NR)return!1}catch{return!1}var t=!1;try{var n={};n[kR]=function(){return{next:function(){return{done:t=!0}}}},r(n)}catch{}return t},npe=q1,ipe=rpe,spe=lm.CONSTRUCTOR,HR=spe||!ipe(function(r){npe.all(r).then(void 0,function(){})}),ope=Ho,ape=Xs,cpe=Hu,lpe=Wf,upe=IB,Ape=DR,hpe=HR;ope({target:"Promise",stat:!0,forced:hpe},{all:function(r){var e=this,t=lpe.f(e),n=t.resolve,i=t.reject,s=upe(function(){var a=cpe(e.resolve),o=[],A=0,f=1;Ape(r,function(m){var v=A++,x=!1;f++,ape(a,e,m).then(function(B){x||(x=!0,o[v]=B,--f||n(o))},i)}),--f||n(o)});return s.error&&i(s.value),t.promise}});var dpe=Ho,fpe=lm.CONSTRUCTOR,QB=q1,ppe=ed,gpe=os,mpe=td,zR=QB&&QB.prototype;if(dpe({target:"Promise",proto:!0,forced:fpe,real:!0},{catch:function(r){return this.then(void 0,r)}}),gpe(QB)){var GR=ppe("Promise").prototype.catch;zR.catch!==GR&&mpe(zR,"catch",GR,{unsafe:!0})}var ype=Ho,_pe=Xs,vpe=Hu,bpe=Wf,wpe=IB,xpe=DR,Bpe=HR;ype({target:"Promise",stat:!0,forced:Bpe},{race:function(r){var e=this,t=bpe.f(e),n=t.reject,i=wpe(function(){var s=vpe(e.resolve);xpe(r,function(a){_pe(s,e,a).then(t.resolve,n)})});return i.error&&n(i.value),t.promise}});var Cpe=Ho,Epe=Wf,Spe=lm.CONSTRUCTOR;Cpe({target:"Promise",stat:!0,forced:Spe},{reject:function(r){var e=Epe.f(this),t=e.reject;return t(r),e.promise}});var Tpe=Qo,Ipe=rl,Lpe=Wf,Fpe=function(r,e){if(Tpe(r),Ipe(e)&&e.constructor===r)return e;var t=Lpe.f(r),n=t.resolve;return n(e),t.promise},Mpe=Ho,Ppe=ed,Upe=lm.CONSTRUCTOR,Rpe=Fpe;Ppe("Promise"),Mpe({target:"Promise",stat:!0,forced:Upe},{resolve:function(r){return Rpe(this,r)}});function VR(r,e,t,n,i,s,a){try{var o=r[s](a),A=o.value}catch(f){t(f);return}o.done?e(A):Promise.resolve(A).then(n,i)}function Gu(r){return function(){var e=this,t=arguments;return new Promise(function(n,i){var s=r.apply(e,t);function a(A){VR(s,n,i,a,o,"next",A)}function o(A){VR(s,n,i,a,o,"throw",A)}a(void 0)})}}var Ope=dB,Dpe=String,eu=function(r){if(Ope(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return Dpe(r)},kpe=Qo,jR=function(){var r=kpe(this),e="";return r.hasIndices&&(e+="d"),r.global&&(e+="g"),r.ignoreCase&&(e+="i"),r.multiline&&(e+="m"),r.dotAll&&(e+="s"),r.unicode&&(e+="u"),r.unicodeSets&&(e+="v"),r.sticky&&(e+="y"),e},HB=is,Npe=ns,zB=Npe.RegExp,GB=HB(function(){var r=zB("a","y");return r.lastIndex=2,r.exec("abcd")!==null}),Qpe=GB||HB(function(){return!zB("a","y").sticky}),Hpe=GB||HB(function(){var r=zB("^r","gy");return r.lastIndex=2,r.exec("str")!==null}),qR={BROKEN_CARET:Hpe,MISSED_STICKY:Qpe,UNSUPPORTED_Y:GB},KR={},zpe=CU,Gpe=hB,Vpe=Object.keys||function(r){return zpe(r,Gpe)},jpe=el,qpe=uU,Kpe=zu,Wpe=Qo,$pe=em,Xpe=Vpe;KR.f=jpe&&!qpe?Object.defineProperties:function(r,e){Wpe(r);for(var t=$pe(e),n=Xpe(e),i=n.length,s=0,a;i>s;)Kpe.f(r,a=n[s++],t[a]);return r};var Jpe=Qo,Ype=KR,WR=hB,Zpe=iB,ege=jU,tge=I1,rge=nB,$R=">",XR="<",VB="prototype",jB="script",JR=rge("IE_PROTO"),qB=function(){},YR=function(r){return XR+jB+$R+r+XR+"/"+jB+$R},ZR=function(r){r.write(YR("")),r.close();var e=r.parentWindow.Object;return r=null,e},nge=function(){var r=tge("iframe"),e="java"+jB+":",t;return r.style.display="none",ege.appendChild(r),r.src=String(e),t=r.contentWindow.document,t.open(),t.write(YR("document.F=Object")),t.close(),t.F},e_,t_=function(){try{e_=new ActiveXObject("htmlfile")}catch{}t_=typeof document<"u"?document.domain&&e_?ZR(e_):nge():ZR(e_);for(var r=WR.length;r--;)delete t_[VB][WR[r]];return t_()};Zpe[JR]=!0;var KB=Object.create||function(r,e){var t;return r!==null?(qB[VB]=Jpe(r),t=new qB,qB[VB]=null,t[JR]=r):t=t_(),e===void 0?t:Ype.f(t,e)},ige=is,sge=ns,oge=sge.RegExp,age=ige(function(){var r=oge(".","s");return!(r.dotAll&&r.test(`
`)&&r.flags==="s")}),cge=is,lge=ns,uge=lge.RegExp,Age=cge(function(){var r=uge("(?<a>b)","g");return r.exec("b").groups.a!=="b"||"b".replace(r,"$<a>c")!=="bc"}),Zf=Xs,r_=ss,hge=eu,dge=jR,fge=qR,pge=qx,gge=KB,mge=U1.get,yge=age,_ge=Age,vge=pge("native-string-replace",String.prototype.replace),n_=RegExp.prototype.exec,WB=n_,bge=r_("".charAt),wge=r_("".indexOf),xge=r_("".replace),$B=r_("".slice),XB=function(){var r=/a/,e=/b*/g;return Zf(n_,r,"a"),Zf(n_,e,"a"),r.lastIndex!==0||e.lastIndex!==0}(),eO=fge.BROKEN_CARET,JB=/()??/.exec("")[1]!==void 0,Bge=XB||JB||eO||yge||_ge;Bge&&(WB=function(r){var e=this,t=mge(e),n=hge(r),i=t.raw,s,a,o,A,f,m,v;if(i)return i.lastIndex=e.lastIndex,s=Zf(WB,i,n),e.lastIndex=i.lastIndex,s;var x=t.groups,B=eO&&e.sticky,M=Zf(dge,e),U=e.source,N=0,Q=n;if(B&&(M=xge(M,"y",""),wge(M,"g")===-1&&(M+="g"),Q=$B(n,e.lastIndex),e.lastIndex>0&&(!e.multiline||e.multiline&&bge(n,e.lastIndex-1)!==`
`)&&(U="(?: "+U+")",Q=" "+Q,N++),a=new RegExp("^(?:"+U+")",M)),JB&&(a=new RegExp("^"+U+"$(?!\\s)",M)),XB&&(o=e.lastIndex),A=Zf(n_,B?a:e,Q),B?A?(A.input=$B(A.input,N),A[0]=$B(A[0],N),A.index=e.lastIndex,e.lastIndex+=A[0].length):e.lastIndex=0:XB&&A&&(e.lastIndex=e.global?A.index+A[0].length:o),JB&&A&&A.length>1&&Zf(vge,A[0],a,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(A[f]=void 0)}),A&&x)for(A.groups=m=gge(null),f=0;f<x.length;f++)v=x[f],m[v[0]]=A[v[1]];return A});var YB=WB,Cge=Ho,tO=YB;Cge({target:"RegExp",proto:!0,forced:/./.exec!==tO},{exec:tO});var rO=Xs,nO=td,Ege=YB,iO=is,sO=Rs,Sge=tm,Tge=sO("species"),ZB=RegExp.prototype,eC=function(r,e,t,n){var i=sO(r),s=!iO(function(){var f={};return f[i]=function(){return 7},""[r](f)!==7}),a=s&&!iO(function(){var f=!1,m=/a/;return r==="split"&&(m={},m.constructor={},m.constructor[Tge]=function(){return m},m.flags="",m[i]=/./[i]),m.exec=function(){return f=!0,null},m[i](""),!f});if(!s||!a||t){var o=/./[i],A=e(i,""[r],function(f,m,v,x,B){var M=m.exec;return M===Ege||M===ZB.exec?s&&!B?{done:!0,value:rO(o,m,v,x)}:{done:!0,value:rO(f,v,m,x)}:{done:!1}});nO(String.prototype,r,A[0]),nO(ZB,i,A[1])}n&&Sge(ZB[i],"sham",!0)},tC=ss,Ige=D1,Lge=eu,Fge=tl,Mge=tC("".charAt),oO=tC("".charCodeAt),Pge=tC("".slice),aO=function(r){return function(e,t){var n=Lge(Fge(e)),i=Ige(t),s=n.length,a,o;return i<0||i>=s?r?"":void 0:(a=oO(n,i),a<55296||a>56319||i+1===s||(o=oO(n,i+1))<56320||o>57343?r?Mge(n,i):a:r?Pge(n,i,i+2):(a-55296<<10)+(o-56320)+65536)}},Uge={codeAt:aO(!1),charAt:aO(!0)},Rge=Uge.charAt,rC=function(r,e,t){return e+(t?Rge(r,e).length:1)},cO=Xs,Oge=Qo,Dge=os,kge=Yh,Nge=YB,Qge=TypeError,nC=function(r,e){var t=r.exec;if(Dge(t)){var n=cO(t,r,e);return n!==null&&Oge(n),n}if(kge(r)==="RegExp")return cO(Nge,r,e);throw new Qge("RegExp#exec called on incompatible receiver")},Hge=Xs,zge=eC,Gge=Qo,Vge=Zh,jge=jf,iC=eu,qge=tl,Kge=zf,Wge=rC,lO=nC;zge("match",function(r,e,t){return[function(n){var i=qge(this),s=Vge(n)?void 0:Kge(n,r);return s?Hge(s,n,i):new RegExp(n)[r](iC(i))},function(n){var i=Gge(this),s=iC(n),a=t(e,i,s);if(a.done)return a.value;if(!i.global)return lO(i,s);var o=i.unicode;i.lastIndex=0;for(var A=[],f=0,m;(m=lO(i,s))!==null;){var v=iC(m[0]);A[f]=v,v===""&&(i.lastIndex=Wge(s,jge(i.lastIndex),o)),f++}return f===0?null:A}]});var sC=ss,$ge=T1,Xge=Math.floor,oC=sC("".charAt),Jge=sC("".replace),aC=sC("".slice),Yge=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Zge=/\$([$&'`]|\d{1,2})/g,eme=function(r,e,t,n,i,s){var a=t+r.length,o=n.length,A=Zge;return i!==void 0&&(i=$ge(i),A=Yge),Jge(s,A,function(f,m){var v;switch(oC(m,0)){case"$":return"$";case"&":return r;case"`":return aC(e,0,t);case"'":return aC(e,a);case"<":v=i[aC(m,1,-1)];break;default:var x=+m;if(x===0)return f;if(x>o){var B=Xge(x/10);return B===0?f:B<=o?n[B-1]===void 0?oC(m,1):n[B-1]+oC(m,1):f}v=n[x-1]}return v===void 0?"":v})},tme=GU,uO=Xs,i_=ss,rme=eC,nme=is,ime=Qo,sme=os,ome=Zh,ame=D1,cme=jf,ep=eu,lme=tl,ume=rC,Ame=zf,hme=eme,dme=nC,fme=Rs,cC=fme("replace"),pme=Math.max,gme=Math.min,mme=i_([].concat),lC=i_([].push),AO=i_("".indexOf),hO=i_("".slice),yme=function(r){return r===void 0?r:String(r)},_me=function(){return"a".replace(/./,"$0")==="$0"}(),dO=function(){return/./[cC]?/./[cC]("a","$0")==="":!1}(),vme=!nme(function(){var r=/./;return r.exec=function(){var e=[];return e.groups={a:"7"},e},"".replace(r,"$<a>")!=="7"});rme("replace",function(r,e,t){var n=dO?"$":"$0";return[function(i,s){var a=lme(this),o=ome(i)?void 0:Ame(i,cC);return o?uO(o,i,a,s):uO(e,ep(a),i,s)},function(i,s){var a=ime(this),o=ep(i);if(typeof s=="string"&&AO(s,n)===-1&&AO(s,"$<")===-1){var A=t(e,a,o,s);if(A.done)return A.value}var f=sme(s);f||(s=ep(s));var m=a.global,v;m&&(v=a.unicode,a.lastIndex=0);for(var x=[],B;B=dme(a,o),!(B===null||(lC(x,B),!m));){var M=ep(B[0]);M===""&&(a.lastIndex=ume(o,cme(a.lastIndex),v))}for(var U="",N=0,Q=0;Q<x.length;Q++){B=x[Q];for(var q=ep(B[0]),Y=pme(gme(ame(B.index),o.length),0),te=[],pe,ge=1;ge<B.length;ge++)lC(te,yme(B[ge]));var ye=B.groups;if(f){var fe=mme([q],te,Y,o);ye!==void 0&&lC(fe,ye),pe=ep(tme(s,void 0,fe))}else pe=hme(q,o,Y,te,ye,s);Y>=N&&(U+=hO(o,N,Y)+pe,N=Y+q.length)}return U+hO(o,N)}]},!vme||!_me||dO);var bme=rl,wme=Yh,xme=Rs,Bme=xme("match"),Cme=function(r){var e;return bme(r)&&((e=r[Bme])!==void 0?!!e:wme(r)==="RegExp")},Eme=Cme,Sme=TypeError,uC=function(r){if(Eme(r))throw new Sme("The method doesn't accept regular expressions");return r},Tme=Rs,Ime=Tme("match"),AC=function(r){var e=/./;try{"/./"[r](e)}catch{try{return e[Ime]=!1,"/./"[r](e)}catch{}}return!1},Lme=Ho,Fme=H1,Mme=Zg.f,Pme=jf,fO=eu,Ume=uC,Rme=tl,Ome=AC,Dme=Fme("".slice),kme=Math.min,pO=Ome("startsWith"),Nme=!pO&&!!function(){var r=Mme(String.prototype,"startsWith");return r&&!r.writable}();Lme({target:"String",proto:!0,forced:!Nme&&!pO},{startsWith:function(r){var e=fO(Rme(this));Ume(r);var t=Pme(kme(arguments.length>1?arguments[1]:void 0,e.length)),n=fO(r);return Dme(e,t,t+n.length)===n}});var Qme=Rs,Hme=KB,zme=zu.f,hC=Qme("unscopables"),dC=Array.prototype;dC[hC]===void 0&&zme(dC,hC,{configurable:!0,value:Hme(null)});var Gme=function(r){dC[hC][r]=!0},Vme=is,jme=!Vme(function(){function r(){}return r.prototype.constructor=null,Object.getPrototypeOf(new r)!==r.prototype}),qme=il,Kme=os,Wme=T1,$me=nB,Xme=jme,gO=$me("IE_PROTO"),fC=Object,Jme=fC.prototype,mO=Xme?fC.getPrototypeOf:function(r){var e=Wme(r);if(qme(e,gO))return e[gO];var t=e.constructor;return Kme(t)&&e instanceof t?t.prototype:e instanceof fC?Jme:null},Yme=is,Zme=os,e0e=rl,yO=mO,t0e=td,r0e=Rs,pC=r0e("iterator"),_O=!1,id,gC,mC;[].keys&&(mC=[].keys(),"next"in mC?(gC=yO(yO(mC)),gC!==Object.prototype&&(id=gC)):_O=!0);var n0e=!e0e(id)||Yme(function(){var r={};return id[pC].call(r)!==r});n0e&&(id={}),Zme(id[pC])||t0e(id,pC,function(){return this});var vO={IteratorPrototype:id,BUGGY_SAFARI_ITERATORS:_O},i0e=vO.IteratorPrototype,s0e=KB,o0e=Ux,a0e=N1,c0e=um,l0e=function(){return this},u0e=function(r,e,t,n){var i=e+" Iterator";return r.prototype=s0e(i0e,{next:o0e(+!n,t)}),a0e(r,i,!1),c0e[i]=l0e,r},A0e=Ho,h0e=Xs,bO=F1,d0e=os,f0e=u0e,wO=mO,xO=IU,p0e=N1,g0e=tm,yC=td,m0e=Rs,y0e=um,BO=vO,_0e=bO.PROPER,v0e=bO.CONFIGURABLE,CO=BO.IteratorPrototype,s_=BO.BUGGY_SAFARI_ITERATORS,Am=m0e("iterator"),EO="keys",hm="values",SO="entries",b0e=function(){return this},w0e=function(r,e,t,n,i,s,a){f0e(t,e,n);var o=function(Q){if(Q===i&&x)return x;if(!s_&&Q&&Q in m)return m[Q];switch(Q){case EO:return function(){return new t(this,Q)};case hm:return function(){return new t(this,Q)};case SO:return function(){return new t(this,Q)}}return function(){return new t(this)}},A=e+" Iterator",f=!1,m=r.prototype,v=m[Am]||m["@@iterator"]||i&&m[i],x=!s_&&v||o(i),B=e==="Array"&&m.entries||v,M,U,N;if(B&&(M=wO(B.call(new r)),M!==Object.prototype&&M.next&&(wO(M)!==CO&&(xO?xO(M,CO):d0e(M[Am])||yC(M,Am,b0e)),p0e(M,A,!0))),_0e&&i===hm&&v&&v.name!==hm&&(v0e?g0e(m,"name",hm):(f=!0,x=function(){return h0e(v,this)})),i)if(U={values:o(hm),keys:s?x:o(EO),entries:o(SO)},a)for(N in U)(s_||f||!(N in m))&&yC(m,N,U[N]);else A0e({target:e,proto:!0,forced:s_||f},U);return m[Am]!==x&&yC(m,Am,x,{name:i}),y0e[e]=x,U},x0e=function(r,e){return{value:r,done:e}},B0e=em,_C=Gme,TO=um,IO=U1,C0e=zu.f,E0e=w0e,o_=x0e,S0e=el,LO="Array Iterator",T0e=IO.set,I0e=IO.getterFor(LO),L0e=E0e(Array,"Array",function(r,e){T0e(this,{type:LO,target:B0e(r),index:0,kind:e})},function(){var r=I0e(this),e=r.target,t=r.index++;if(!e||t>=e.length)return r.target=void 0,o_(void 0,!0);switch(r.kind){case"keys":return o_(t,!1);case"values":return o_(e[t],!1)}return o_([t,e[t]],!1)},"values"),FO=TO.Arguments=TO.Array;if(_C("keys"),_C("values"),_C("entries"),S0e&&FO.name!=="values")try{C0e(FO,"name",{value:"values"})}catch{}var F0e={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},M0e=I1,vC=M0e("span").classList,MO=vC&&vC.constructor&&vC.constructor.prototype,P0e=MO===Object.prototype?void 0:MO,PO=ns,UO=F0e,U0e=P0e,dm=L0e,RO=tm,R0e=N1,O0e=Rs,bC=O0e("iterator"),wC=dm.values,OO=function(r,e){if(r){if(r[bC]!==wC)try{RO(r,bC,wC)}catch{r[bC]=wC}if(R0e(r,e,!0),UO[e]){for(var t in dm)if(r[t]!==dm[t])try{RO(r,t,dm[t])}catch{r[t]=dm[t]}}}};for(var xC in UO)OO(PO[xC]&&PO[xC].prototype,xC);OO(U0e,"DOMTokenList");function D0e(r,e){if(Dn(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(Dn(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function k0e(r){var e=D0e(r,"string");return Dn(e)=="symbol"?e:e+""}function BC(r,e,t){return e=k0e(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var N0e=Hu,Q0e=T1,H0e=HP,z0e=uB,DO=TypeError,kO="Reduce of empty array with no initial value",NO=function(r){return function(e,t,n,i){var s=Q0e(e),a=H0e(s),o=z0e(s);if(N0e(t),o===0&&n<2)throw new DO(kO);var A=r?o-1:0,f=r?-1:1;if(n<2)for(;;){if(A in a){i=a[A],A+=f;break}if(A+=f,r?A<0:o<=A)throw new DO(kO)}for(;r?A>=0:o>A;A+=f)A in a&&(i=t(i,a[A],A,s));return i}},G0e={left:NO(!1),right:NO(!0)},V0e=is,QO=function(r,e){var t=[][r];return!!t&&V0e(function(){t.call(null,e||function(){return 1},1)})},j0e=Ho,q0e=G0e.left,K0e=QO,HO=Qx,W0e=im,$0e=!W0e&&HO>79&&HO<83,X0e=$0e||!K0e("reduce");j0e({target:"Array",proto:!0,forced:X0e},{reduce:function(r){var e=arguments.length;return q0e(this,r,e,e>1?arguments[1]:void 0)}});var J0e=Ho,Y0e=H1,Z0e=Zg.f,eye=jf,zO=eu,tye=uC,rye=tl,nye=AC,iye=Y0e("".slice),sye=Math.min,GO=nye("endsWith"),oye=!GO&&!!function(){var r=Z0e(String.prototype,"endsWith");return r&&!r.writable}();J0e({target:"String",proto:!0,forced:!oye&&!GO},{endsWith:function(r){var e=zO(rye(this));tye(r);var t=arguments.length>1?arguments[1]:void 0,n=e.length,i=t===void 0?n:sye(eye(t),n),s=zO(r);return iye(e,i-s.length,i)===s}});var CC=Xs,VO=ss,aye=eC,cye=Qo,lye=Zh,uye=tl,Aye=NU,hye=rC,dye=jf,jO=eu,fye=zf,qO=nC,pye=qR,gye=is,tp=pye.UNSUPPORTED_Y,mye=4294967295,yye=Math.min,EC=VO([].push),SC=VO("".slice),_ye=!gye(function(){var r=/(?:)/,e=r.exec;r.exec=function(){return e.apply(this,arguments)};var t="ab".split(r);return t.length!==2||t[0]!=="a"||t[1]!=="b"}),KO="abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length;aye("split",function(r,e,t){var n="0".split(void 0,0).length?function(i,s){return i===void 0&&s===0?[]:CC(e,this,i,s)}:e;return[function(i,s){var a=uye(this),o=lye(i)?void 0:fye(i,r);return o?CC(o,i,a,s):CC(n,jO(a),i,s)},function(i,s){var a=cye(this),o=jO(i);if(!KO){var A=t(n,a,o,s,n!==e);if(A.done)return A.value}var f=Aye(a,RegExp),m=a.unicode,v=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(tp?"g":"y"),x=new f(tp?"^(?:"+a.source+")":a,v),B=s===void 0?mye:s>>>0;if(B===0)return[];if(o.length===0)return qO(x,o)===null?[o]:[];for(var M=0,U=0,N=[];U<o.length;){x.lastIndex=tp?0:U;var Q=qO(x,tp?SC(o,U):o),q;if(Q===null||(q=yye(dye(x.lastIndex+(tp?U:0)),o.length))===M)U=hye(o,U,m);else{if(EC(N,SC(o,M,U)),N.length===B)return N;for(var Y=1;Y<=Q.length-1;Y++)if(EC(N,Q[Y]),N.length===B)return N;U=M=q}}return EC(N,SC(o,M)),N}]},KO||!_ye,tp);var a_={exports:{}},fm={exports:{}};(function(){var r,e,t,n,i,s;typeof performance<"u"&&performance!==null&&performance.now?fm.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(fm.exports=function(){return(r()-i)/1e6},e=process.hrtime,r=function(){var a;return a=e(),a[0]*1e9+a[1]},n=r(),s=process.uptime()*1e9,i=n-s):Date.now?(fm.exports=function(){return Date.now()-t},t=Date.now()):(fm.exports=function(){return new Date().getTime()-t},t=new Date().getTime())}).call(Hf);for(var vye=fm.exports,bye=vye,Vu=typeof window>"u"?Hf:window,c_=["moz","webkit"],rp="AnimationFrame",np=Vu["request"+rp],pm=Vu["cancel"+rp]||Vu["cancelRequest"+rp],gm=0;!np&&gm<c_.length;gm++)np=Vu[c_[gm]+"Request"+rp],pm=Vu[c_[gm]+"Cancel"+rp]||Vu[c_[gm]+"CancelRequest"+rp];if(!np||!pm){var TC=0,WO=0,sd=[],wye=1e3/60;np=function(r){if(sd.length===0){var e=bye(),t=Math.max(0,wye-(e-TC));TC=t+e,setTimeout(function(){var n=sd.slice(0);sd.length=0;for(var i=0;i<n.length;i++)if(!n[i].cancelled)try{n[i].callback(TC)}catch(s){setTimeout(function(){throw s},0)}},Math.round(t))}return sd.push({handle:++WO,callback:r,cancelled:!1}),WO},pm=function(r){for(var e=0;e<sd.length;e++)sd[e].handle===r&&(sd[e].cancelled=!0)}}a_.exports=function(r){return np.call(Vu,r)},a_.exports.cancel=function(){pm.apply(Vu,arguments)},a_.exports.polyfill=function(r){r||(r=Vu),r.requestAnimationFrame=np,r.cancelAnimationFrame=pm};var xye=a_.exports;const IC=UP(xye);var $O=`	
\v\f\r \u2028\u2029\uFEFF`,Bye=ss,Cye=tl,Eye=eu,LC=$O,XO=Bye("".replace),Sye=RegExp("^["+LC+"]+"),Tye=RegExp("(^|[^"+LC+"])["+LC+"]+$"),FC=function(r){return function(e){var t=Eye(Cye(e));return r&1&&(t=XO(t,Sye,"")),r&2&&(t=XO(t,Tye,"$1")),t}},Iye={start:FC(1),end:FC(2),trim:FC(3)},Lye=F1.PROPER,Fye=is,JO=$O,YO="",Mye=function(r){return Fye(function(){return!!JO[r]()||YO[r]()!==YO||Lye&&JO[r].name!==r})},Pye=Ho,Uye=Iye.trim,Rye=Mye;Pye({target:"String",proto:!0,forced:Rye("trim")},{trim:function(){return Uye(this)}});var Oye=function(r){this.ok=!1,this.alpha=1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r=r.replace(/ /g,""),r=r.toLowerCase();var e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};r=e[r]||r;for(var t=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(A){return[parseInt(A[1]),parseInt(A[2]),parseInt(A[3]),parseFloat(A[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(A){return[parseInt(A[1]),parseInt(A[2]),parseInt(A[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(A){return[parseInt(A[1],16),parseInt(A[2],16),parseInt(A[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(A){return[parseInt(A[1]+A[1],16),parseInt(A[2]+A[2],16),parseInt(A[3]+A[3],16)]}}],n=0;n<t.length;n++){var i=t[n].re,s=t[n].process,a=i.exec(r);if(a){var o=s(a);this.r=o[0],this.g=o[1],this.b=o[2],o.length>3&&(this.alpha=o[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var A=this.r.toString(16),f=this.g.toString(16),m=this.b.toString(16);return A.length==1&&(A="0"+A),f.length==1&&(f="0"+f),m.length==1&&(m="0"+m),"#"+A+f+m},this.getHelpXML=function(){for(var A=new Array,f=0;f<t.length;f++)for(var m=t[f].example,v=0;v<m.length;v++)A[A.length]=m[v];for(var x in e)A[A.length]=x;var B=document.createElement("ul");B.setAttribute("id","rgbcolor-examples");for(var f=0;f<A.length;f++)try{var M=document.createElement("li"),U=new RGBColor(A[f]),N=document.createElement("div");N.style.cssText="margin: 3px; border: 1px solid black; background:"+U.toHex()+"; color:"+U.toHex(),N.appendChild(document.createTextNode("test"));var Q=document.createTextNode(" "+A[f]+" -> "+U.toRGB()+" -> "+U.toHex());M.appendChild(N),M.appendChild(Q),B.appendChild(M)}catch{}return B}};const MC=UP(Oye);var Dye=Ho,kye=H1,Nye=xU.indexOf,Qye=QO,PC=kye([].indexOf),ZO=!!PC&&1/PC([1],1,-0)<0,Hye=ZO||!Qye("indexOf");Dye({target:"Array",proto:!0,forced:Hye},{indexOf:function(r){var e=arguments.length>1?arguments[1]:void 0;return ZO?PC(this,r,e)||0:Nye(this,r,e)}});var zye=Ho,Gye=ss,Vye=uC,jye=tl,eD=eu,qye=AC,Kye=Gye("".indexOf);zye({target:"String",proto:!0,forced:!qye("includes")},{includes:function(r){return!!~Kye(eD(jye(this)),eD(Vye(r)),arguments.length>1?arguments[1]:void 0)}});var Wye=Yh,$ye=Array.isArray||function(r){return Wye(r)==="Array"},Xye=Ho,Jye=ss,Yye=$ye,Zye=Jye([].reverse),tD=[1,2];Xye({target:"Array",proto:!0,forced:String(tD)===String(tD.reverse())},{reverse:function(){return Yye(this)&&(this.length=this.length),Zye(this)}});/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var rD=function(r,e){return(rD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(r,e)};function nD(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=r}rD(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function e1e(r){var e="";Array.isArray(r)||(r=[r]);for(var t=0;t<r.length;t++){var n=r[t];if(n.type===Ut.CLOSE_PATH)e+="z";else if(n.type===Ut.HORIZ_LINE_TO)e+=(n.relative?"h":"H")+n.x;else if(n.type===Ut.VERT_LINE_TO)e+=(n.relative?"v":"V")+n.y;else if(n.type===Ut.MOVE_TO)e+=(n.relative?"m":"M")+n.x+" "+n.y;else if(n.type===Ut.LINE_TO)e+=(n.relative?"l":"L")+n.x+" "+n.y;else if(n.type===Ut.CURVE_TO)e+=(n.relative?"c":"C")+n.x1+" "+n.y1+" "+n.x2+" "+n.y2+" "+n.x+" "+n.y;else if(n.type===Ut.SMOOTH_CURVE_TO)e+=(n.relative?"s":"S")+n.x2+" "+n.y2+" "+n.x+" "+n.y;else if(n.type===Ut.QUAD_TO)e+=(n.relative?"q":"Q")+n.x1+" "+n.y1+" "+n.x+" "+n.y;else if(n.type===Ut.SMOOTH_QUAD_TO)e+=(n.relative?"t":"T")+n.x+" "+n.y;else{if(n.type!==Ut.ARC)throw new Error('Unexpected command type "'+n.type+'" at index '+t+".");e+=(n.relative?"a":"A")+n.rX+" "+n.rY+" "+n.xRot+" "+ +n.lArcFlag+" "+ +n.sweepFlag+" "+n.x+" "+n.y}}return e}function UC(r,e){var t=r[0],n=r[1];return[t*Math.cos(e)-n*Math.sin(e),t*Math.sin(e)+n*Math.cos(e)]}function sl(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];for(var t=0;t<r.length;t++)if(typeof r[t]!="number")throw new Error("assertNumbers arguments["+t+"] is not a number. "+typeof r[t]+" == typeof "+r[t]);return!0}var JA=Math.PI;function RC(r,e,t){r.lArcFlag=r.lArcFlag===0?0:1,r.sweepFlag=r.sweepFlag===0?0:1;var n=r.rX,i=r.rY,s=r.x,a=r.y;n=Math.abs(r.rX),i=Math.abs(r.rY);var o=UC([(e-s)/2,(t-a)/2],-r.xRot/180*JA),A=o[0],f=o[1],m=Math.pow(A,2)/Math.pow(n,2)+Math.pow(f,2)/Math.pow(i,2);1<m&&(n*=Math.sqrt(m),i*=Math.sqrt(m)),r.rX=n,r.rY=i;var v=Math.pow(n,2)*Math.pow(f,2)+Math.pow(i,2)*Math.pow(A,2),x=(r.lArcFlag!==r.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(n,2)*Math.pow(i,2)-v)/v)),B=n*f/i*x,M=-i*A/n*x,U=UC([B,M],r.xRot/180*JA);r.cX=U[0]+(e+s)/2,r.cY=U[1]+(t+a)/2,r.phi1=Math.atan2((f-M)/i,(A-B)/n),r.phi2=Math.atan2((-f-M)/i,(-A-B)/n),r.sweepFlag===0&&r.phi2>r.phi1&&(r.phi2-=2*JA),r.sweepFlag===1&&r.phi2<r.phi1&&(r.phi2+=2*JA),r.phi1*=180/JA,r.phi2*=180/JA}function iD(r,e,t){sl(r,e,t);var n=r*r+e*e-t*t;if(0>n)return[];if(n===0)return[[r*t/(r*r+e*e),e*t/(r*r+e*e)]];var i=Math.sqrt(n);return[[(r*t+e*i)/(r*r+e*e),(e*t-r*i)/(r*r+e*e)],[(r*t-e*i)/(r*r+e*e),(e*t+r*i)/(r*r+e*e)]]}var ys,ju=Math.PI/180;function sD(r,e,t){return(1-t)*r+t*e}function oD(r,e,t,n){return r+Math.cos(n/180*JA)*e+Math.sin(n/180*JA)*t}function aD(r,e,t,n){var i=1e-6,s=e-r,a=t-e,o=3*s+3*(n-t)-6*a,A=6*(a-s),f=3*s;return Math.abs(o)<i?[-f/A]:function(m,v,x){x===void 0&&(x=1e-6);var B=m*m/4-v;if(B<-x)return[];if(B<=x)return[-m/2];var M=Math.sqrt(B);return[-m/2-M,-m/2+M]}(A/o,f/o,i)}function cD(r,e,t,n,i){var s=1-i;return r*(s*s*s)+e*(3*s*s*i)+t*(3*s*i*i)+n*(i*i*i)}(function(r){function e(){return i(function(o,A,f){return o.relative&&(o.x1!==void 0&&(o.x1+=A),o.y1!==void 0&&(o.y1+=f),o.x2!==void 0&&(o.x2+=A),o.y2!==void 0&&(o.y2+=f),o.x!==void 0&&(o.x+=A),o.y!==void 0&&(o.y+=f),o.relative=!1),o})}function t(){var o=NaN,A=NaN,f=NaN,m=NaN;return i(function(v,x,B){return v.type&Ut.SMOOTH_CURVE_TO&&(v.type=Ut.CURVE_TO,o=isNaN(o)?x:o,A=isNaN(A)?B:A,v.x1=v.relative?x-o:2*x-o,v.y1=v.relative?B-A:2*B-A),v.type&Ut.CURVE_TO?(o=v.relative?x+v.x2:v.x2,A=v.relative?B+v.y2:v.y2):(o=NaN,A=NaN),v.type&Ut.SMOOTH_QUAD_TO&&(v.type=Ut.QUAD_TO,f=isNaN(f)?x:f,m=isNaN(m)?B:m,v.x1=v.relative?x-f:2*x-f,v.y1=v.relative?B-m:2*B-m),v.type&Ut.QUAD_TO?(f=v.relative?x+v.x1:v.x1,m=v.relative?B+v.y1:v.y1):(f=NaN,m=NaN),v})}function n(){var o=NaN,A=NaN;return i(function(f,m,v){if(f.type&Ut.SMOOTH_QUAD_TO&&(f.type=Ut.QUAD_TO,o=isNaN(o)?m:o,A=isNaN(A)?v:A,f.x1=f.relative?m-o:2*m-o,f.y1=f.relative?v-A:2*v-A),f.type&Ut.QUAD_TO){o=f.relative?m+f.x1:f.x1,A=f.relative?v+f.y1:f.y1;var x=f.x1,B=f.y1;f.type=Ut.CURVE_TO,f.x1=((f.relative?0:m)+2*x)/3,f.y1=((f.relative?0:v)+2*B)/3,f.x2=(f.x+2*x)/3,f.y2=(f.y+2*B)/3}else o=NaN,A=NaN;return f})}function i(o){var A=0,f=0,m=NaN,v=NaN;return function(x){if(isNaN(m)&&!(x.type&Ut.MOVE_TO))throw new Error("path must start with moveto");var B=o(x,A,f,m,v);return x.type&Ut.CLOSE_PATH&&(A=m,f=v),x.x!==void 0&&(A=x.relative?A+x.x:x.x),x.y!==void 0&&(f=x.relative?f+x.y:x.y),x.type&Ut.MOVE_TO&&(m=A,v=f),B}}function s(o,A,f,m,v,x){return sl(o,A,f,m,v,x),i(function(B,M,U,N){var Q=B.x1,q=B.x2,Y=B.relative&&!isNaN(N),te=B.x!==void 0?B.x:Y?0:M,pe=B.y!==void 0?B.y:Y?0:U;function ge(se){return se*se}B.type&Ut.HORIZ_LINE_TO&&A!==0&&(B.type=Ut.LINE_TO,B.y=B.relative?0:U),B.type&Ut.VERT_LINE_TO&&f!==0&&(B.type=Ut.LINE_TO,B.x=B.relative?0:M),B.x!==void 0&&(B.x=B.x*o+pe*f+(Y?0:v)),B.y!==void 0&&(B.y=te*A+B.y*m+(Y?0:x)),B.x1!==void 0&&(B.x1=B.x1*o+B.y1*f+(Y?0:v)),B.y1!==void 0&&(B.y1=Q*A+B.y1*m+(Y?0:x)),B.x2!==void 0&&(B.x2=B.x2*o+B.y2*f+(Y?0:v)),B.y2!==void 0&&(B.y2=q*A+B.y2*m+(Y?0:x));var ye=o*m-A*f;if(B.xRot!==void 0&&(o!==1||A!==0||f!==0||m!==1))if(ye===0)delete B.rX,delete B.rY,delete B.xRot,delete B.lArcFlag,delete B.sweepFlag,B.type=Ut.LINE_TO;else{var fe=B.xRot*Math.PI/180,Oe=Math.sin(fe),Fe=Math.cos(fe),oe=1/ge(B.rX),le=1/ge(B.rY),xe=ge(Fe)*oe+ge(Oe)*le,_e=2*Oe*Fe*(oe-le),tt=ge(Oe)*oe+ge(Fe)*le,et=xe*m*m-_e*A*m+tt*A*A,nt=_e*(o*m+A*f)-2*(xe*f*m+tt*o*A),Je=xe*f*f-_e*o*f+tt*o*o,it=(Math.atan2(nt,et-Je)+Math.PI)%Math.PI/2,ot=Math.sin(it),xt=Math.cos(it);B.rX=Math.abs(ye)/Math.sqrt(et*ge(xt)+nt*ot*xt+Je*ge(ot)),B.rY=Math.abs(ye)/Math.sqrt(et*ge(ot)-nt*ot*xt+Je*ge(xt)),B.xRot=180*it/Math.PI}return B.sweepFlag!==void 0&&0>ye&&(B.sweepFlag=+!B.sweepFlag),B})}function a(){return function(o){var A={};for(var f in o)A[f]=o[f];return A}}r.ROUND=function(o){function A(f){return Math.round(f*o)/o}return o===void 0&&(o=1e13),sl(o),function(f){return f.x1!==void 0&&(f.x1=A(f.x1)),f.y1!==void 0&&(f.y1=A(f.y1)),f.x2!==void 0&&(f.x2=A(f.x2)),f.y2!==void 0&&(f.y2=A(f.y2)),f.x!==void 0&&(f.x=A(f.x)),f.y!==void 0&&(f.y=A(f.y)),f.rX!==void 0&&(f.rX=A(f.rX)),f.rY!==void 0&&(f.rY=A(f.rY)),f}},r.TO_ABS=e,r.TO_REL=function(){return i(function(o,A,f){return o.relative||(o.x1!==void 0&&(o.x1-=A),o.y1!==void 0&&(o.y1-=f),o.x2!==void 0&&(o.x2-=A),o.y2!==void 0&&(o.y2-=f),o.x!==void 0&&(o.x-=A),o.y!==void 0&&(o.y-=f),o.relative=!0),o})},r.NORMALIZE_HVZ=function(o,A,f){return o===void 0&&(o=!0),A===void 0&&(A=!0),f===void 0&&(f=!0),i(function(m,v,x,B,M){if(isNaN(B)&&!(m.type&Ut.MOVE_TO))throw new Error("path must start with moveto");return A&&m.type&Ut.HORIZ_LINE_TO&&(m.type=Ut.LINE_TO,m.y=m.relative?0:x),f&&m.type&Ut.VERT_LINE_TO&&(m.type=Ut.LINE_TO,m.x=m.relative?0:v),o&&m.type&Ut.CLOSE_PATH&&(m.type=Ut.LINE_TO,m.x=m.relative?B-v:B,m.y=m.relative?M-x:M),m.type&Ut.ARC&&(m.rX===0||m.rY===0)&&(m.type=Ut.LINE_TO,delete m.rX,delete m.rY,delete m.xRot,delete m.lArcFlag,delete m.sweepFlag),m})},r.NORMALIZE_ST=t,r.QT_TO_C=n,r.INFO=i,r.SANITIZE=function(o){o===void 0&&(o=0),sl(o);var A=NaN,f=NaN,m=NaN,v=NaN;return i(function(x,B,M,U,N){var Q=Math.abs,q=!1,Y=0,te=0;if(x.type&Ut.SMOOTH_CURVE_TO&&(Y=isNaN(A)?0:B-A,te=isNaN(f)?0:M-f),x.type&(Ut.CURVE_TO|Ut.SMOOTH_CURVE_TO)?(A=x.relative?B+x.x2:x.x2,f=x.relative?M+x.y2:x.y2):(A=NaN,f=NaN),x.type&Ut.SMOOTH_QUAD_TO?(m=isNaN(m)?B:2*B-m,v=isNaN(v)?M:2*M-v):x.type&Ut.QUAD_TO?(m=x.relative?B+x.x1:x.x1,v=x.relative?M+x.y1:x.y2):(m=NaN,v=NaN),x.type&Ut.LINE_COMMANDS||x.type&Ut.ARC&&(x.rX===0||x.rY===0||!x.lArcFlag)||x.type&Ut.CURVE_TO||x.type&Ut.SMOOTH_CURVE_TO||x.type&Ut.QUAD_TO||x.type&Ut.SMOOTH_QUAD_TO){var pe=x.x===void 0?0:x.relative?x.x:x.x-B,ge=x.y===void 0?0:x.relative?x.y:x.y-M;Y=isNaN(m)?x.x1===void 0?Y:x.relative?x.x:x.x1-B:m-B,te=isNaN(v)?x.y1===void 0?te:x.relative?x.y:x.y1-M:v-M;var ye=x.x2===void 0?0:x.relative?x.x:x.x2-B,fe=x.y2===void 0?0:x.relative?x.y:x.y2-M;Q(pe)<=o&&Q(ge)<=o&&Q(Y)<=o&&Q(te)<=o&&Q(ye)<=o&&Q(fe)<=o&&(q=!0)}return x.type&Ut.CLOSE_PATH&&Q(B-U)<=o&&Q(M-N)<=o&&(q=!0),q?[]:x})},r.MATRIX=s,r.ROTATE=function(o,A,f){A===void 0&&(A=0),f===void 0&&(f=0),sl(o,A,f);var m=Math.sin(o),v=Math.cos(o);return s(v,m,-m,v,A-A*v+f*m,f-A*m-f*v)},r.TRANSLATE=function(o,A){return A===void 0&&(A=0),sl(o,A),s(1,0,0,1,o,A)},r.SCALE=function(o,A){return A===void 0&&(A=o),sl(o,A),s(o,0,0,A,0,0)},r.SKEW_X=function(o){return sl(o),s(1,0,Math.atan(o),1,0,0)},r.SKEW_Y=function(o){return sl(o),s(1,Math.atan(o),0,1,0,0)},r.X_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),sl(o),s(-1,0,0,1,o,0)},r.Y_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),sl(o),s(1,0,0,-1,0,o)},r.A_TO_C=function(){return i(function(o,A,f){return Ut.ARC===o.type?function(m,v,x){var B,M,U,N;m.cX||RC(m,v,x);for(var Q=Math.min(m.phi1,m.phi2),q=Math.max(m.phi1,m.phi2)-Q,Y=Math.ceil(q/90),te=new Array(Y),pe=v,ge=x,ye=0;ye<Y;ye++){var fe=sD(m.phi1,m.phi2,ye/Y),Oe=sD(m.phi1,m.phi2,(ye+1)/Y),Fe=Oe-fe,oe=4/3*Math.tan(Fe*ju/4),le=[Math.cos(fe*ju)-oe*Math.sin(fe*ju),Math.sin(fe*ju)+oe*Math.cos(fe*ju)],xe=le[0],_e=le[1],tt=[Math.cos(Oe*ju),Math.sin(Oe*ju)],et=tt[0],nt=tt[1],Je=[et+oe*Math.sin(Oe*ju),nt-oe*Math.cos(Oe*ju)],it=Je[0],ot=Je[1];te[ye]={relative:m.relative,type:Ut.CURVE_TO};var xt=function(se,be){var Me=UC([se*m.rX,be*m.rY],m.xRot),De=Me[0],$e=Me[1];return[m.cX+De,m.cY+$e]};B=xt(xe,_e),te[ye].x1=B[0],te[ye].y1=B[1],M=xt(it,ot),te[ye].x2=M[0],te[ye].y2=M[1],U=xt(et,nt),te[ye].x=U[0],te[ye].y=U[1],m.relative&&(te[ye].x1-=pe,te[ye].y1-=ge,te[ye].x2-=pe,te[ye].y2-=ge,te[ye].x-=pe,te[ye].y-=ge),pe=(N=[te[ye].x,te[ye].y])[0],ge=N[1]}return te}(o,o.relative?0:A,o.relative?0:f):o})},r.ANNOTATE_ARCS=function(){return i(function(o,A,f){return o.relative&&(A=0,f=0),Ut.ARC===o.type&&RC(o,A,f),o})},r.CLONE=a,r.CALCULATE_BOUNDS=function(){var o=function(x){var B={};for(var M in x)B[M]=x[M];return B},A=e(),f=n(),m=t(),v=i(function(x,B,M){var U=m(f(A(o(x))));function N(ot){ot>v.maxX&&(v.maxX=ot),ot<v.minX&&(v.minX=ot)}function Q(ot){ot>v.maxY&&(v.maxY=ot),ot<v.minY&&(v.minY=ot)}if(U.type&Ut.DRAWING_COMMANDS&&(N(B),Q(M)),U.type&Ut.HORIZ_LINE_TO&&N(U.x),U.type&Ut.VERT_LINE_TO&&Q(U.y),U.type&Ut.LINE_TO&&(N(U.x),Q(U.y)),U.type&Ut.CURVE_TO){N(U.x),Q(U.y);for(var q=0,Y=aD(B,U.x1,U.x2,U.x);q<Y.length;q++)0<(it=Y[q])&&1>it&&N(cD(B,U.x1,U.x2,U.x,it));for(var te=0,pe=aD(M,U.y1,U.y2,U.y);te<pe.length;te++)0<(it=pe[te])&&1>it&&Q(cD(M,U.y1,U.y2,U.y,it))}if(U.type&Ut.ARC){N(U.x),Q(U.y),RC(U,B,M);for(var ge=U.xRot/180*Math.PI,ye=Math.cos(ge)*U.rX,fe=Math.sin(ge)*U.rX,Oe=-Math.sin(ge)*U.rY,Fe=Math.cos(ge)*U.rY,oe=U.phi1<U.phi2?[U.phi1,U.phi2]:-180>U.phi2?[U.phi2+360,U.phi1+360]:[U.phi2,U.phi1],le=oe[0],xe=oe[1],_e=function(ot){var xt=ot[0],se=ot[1],be=180*Math.atan2(se,xt)/Math.PI;return be<le?be+360:be},tt=0,et=iD(Oe,-ye,0).map(_e);tt<et.length;tt++)(it=et[tt])>le&&it<xe&&N(oD(U.cX,ye,Oe,it));for(var nt=0,Je=iD(Fe,-fe,0).map(_e);nt<Je.length;nt++){var it;(it=Je[nt])>le&&it<xe&&Q(oD(U.cY,fe,Fe,it))}}return x});return v.minX=1/0,v.maxX=-1/0,v.minY=1/0,v.maxY=-1/0,v}})(ys||(ys={}));var ol,lD=function(){function r(){}return r.prototype.round=function(e){return this.transform(ys.ROUND(e))},r.prototype.toAbs=function(){return this.transform(ys.TO_ABS())},r.prototype.toRel=function(){return this.transform(ys.TO_REL())},r.prototype.normalizeHVZ=function(e,t,n){return this.transform(ys.NORMALIZE_HVZ(e,t,n))},r.prototype.normalizeST=function(){return this.transform(ys.NORMALIZE_ST())},r.prototype.qtToC=function(){return this.transform(ys.QT_TO_C())},r.prototype.aToC=function(){return this.transform(ys.A_TO_C())},r.prototype.sanitize=function(e){return this.transform(ys.SANITIZE(e))},r.prototype.translate=function(e,t){return this.transform(ys.TRANSLATE(e,t))},r.prototype.scale=function(e,t){return this.transform(ys.SCALE(e,t))},r.prototype.rotate=function(e,t,n){return this.transform(ys.ROTATE(e,t,n))},r.prototype.matrix=function(e,t,n,i,s,a){return this.transform(ys.MATRIX(e,t,n,i,s,a))},r.prototype.skewX=function(e){return this.transform(ys.SKEW_X(e))},r.prototype.skewY=function(e){return this.transform(ys.SKEW_Y(e))},r.prototype.xSymmetry=function(e){return this.transform(ys.X_AXIS_SYMMETRY(e))},r.prototype.ySymmetry=function(e){return this.transform(ys.Y_AXIS_SYMMETRY(e))},r.prototype.annotateArcs=function(){return this.transform(ys.ANNOTATE_ARCS())},r}(),t1e=function(r){return r===" "||r==="	"||r==="\r"||r===`
`},uD=function(r){return 48<=r.charCodeAt(0)&&r.charCodeAt(0)<=57},r1e=function(r){function e(){var t=r.call(this)||this;return t.curNumber="",t.curCommandType=-1,t.curCommandRelative=!1,t.canParseCommandOrComma=!0,t.curNumberHasExp=!1,t.curNumberHasExpDigits=!1,t.curNumberHasDecimal=!1,t.curArgs=[],t}return nD(e,r),e.prototype.finish=function(t){if(t===void 0&&(t=[]),this.parse(" ",t),this.curArgs.length!==0||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return t},e.prototype.parse=function(t,n){var i=this;n===void 0&&(n=[]);for(var s=function(v){n.push(v),i.curArgs.length=0,i.canParseCommandOrComma=!0},a=0;a<t.length;a++){var o=t[a],A=!(this.curCommandType!==Ut.ARC||this.curArgs.length!==3&&this.curArgs.length!==4||this.curNumber.length!==1||this.curNumber!=="0"&&this.curNumber!=="1"),f=uD(o)&&(this.curNumber==="0"&&o==="0"||A);if(!uD(o)||f)if(o!=="e"&&o!=="E")if(o!=="-"&&o!=="+"||!this.curNumberHasExp||this.curNumberHasExpDigits)if(o!=="."||this.curNumberHasExp||this.curNumberHasDecimal||A){if(this.curNumber&&this.curCommandType!==-1){var m=Number(this.curNumber);if(isNaN(m))throw new SyntaxError("Invalid number ending at "+a);if(this.curCommandType===Ut.ARC){if(this.curArgs.length===0||this.curArgs.length===1){if(0>m)throw new SyntaxError('Expected positive number, got "'+m+'" at index "'+a+'"')}else if((this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber!=="0"&&this.curNumber!=="1")throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+a+'"')}this.curArgs.push(m),this.curArgs.length===n1e[this.curCommandType]&&(Ut.HORIZ_LINE_TO===this.curCommandType?s({type:Ut.HORIZ_LINE_TO,relative:this.curCommandRelative,x:m}):Ut.VERT_LINE_TO===this.curCommandType?s({type:Ut.VERT_LINE_TO,relative:this.curCommandRelative,y:m}):this.curCommandType===Ut.MOVE_TO||this.curCommandType===Ut.LINE_TO||this.curCommandType===Ut.SMOOTH_QUAD_TO?(s({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),Ut.MOVE_TO===this.curCommandType&&(this.curCommandType=Ut.LINE_TO)):this.curCommandType===Ut.CURVE_TO?s({type:Ut.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===Ut.SMOOTH_CURVE_TO?s({type:Ut.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===Ut.QUAD_TO?s({type:Ut.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===Ut.ARC&&s({type:Ut.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!t1e(o))if(o===","&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if(o!=="+"&&o!=="-"&&o!==".")if(f)this.curNumber=o,this.curNumberHasDecimal=!1;else{if(this.curArgs.length!==0)throw new SyntaxError("Unterminated command at index "+a+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+o+'" at index '+a+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,o!=="z"&&o!=="Z")if(o==="h"||o==="H")this.curCommandType=Ut.HORIZ_LINE_TO,this.curCommandRelative=o==="h";else if(o==="v"||o==="V")this.curCommandType=Ut.VERT_LINE_TO,this.curCommandRelative=o==="v";else if(o==="m"||o==="M")this.curCommandType=Ut.MOVE_TO,this.curCommandRelative=o==="m";else if(o==="l"||o==="L")this.curCommandType=Ut.LINE_TO,this.curCommandRelative=o==="l";else if(o==="c"||o==="C")this.curCommandType=Ut.CURVE_TO,this.curCommandRelative=o==="c";else if(o==="s"||o==="S")this.curCommandType=Ut.SMOOTH_CURVE_TO,this.curCommandRelative=o==="s";else if(o==="q"||o==="Q")this.curCommandType=Ut.QUAD_TO,this.curCommandRelative=o==="q";else if(o==="t"||o==="T")this.curCommandType=Ut.SMOOTH_QUAD_TO,this.curCommandRelative=o==="t";else{if(o!=="a"&&o!=="A")throw new SyntaxError('Unexpected character "'+o+'" at index '+a+".");this.curCommandType=Ut.ARC,this.curCommandRelative=o==="a"}else n.push({type:Ut.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=o,this.curNumberHasDecimal=o==="."}else this.curNumber+=o,this.curNumberHasDecimal=!0;else this.curNumber+=o;else this.curNumber+=o,this.curNumberHasExp=!0;else this.curNumber+=o,this.curNumberHasExpDigits=this.curNumberHasExp}return n},e.prototype.transform=function(t){return Object.create(this,{parse:{value:function(n,i){i===void 0&&(i=[]);for(var s=0,a=Object.getPrototypeOf(this).parse.call(this,n);s<a.length;s++){var o=a[s],A=t(o);Array.isArray(A)?i.push.apply(i,A):i.push(A)}return i}}})},e}(lD),Ut=function(r){function e(t){var n=r.call(this)||this;return n.commands=typeof t=="string"?e.parse(t):t,n}return nD(e,r),e.prototype.encode=function(){return e.encode(this.commands)},e.prototype.getBounds=function(){var t=ys.CALCULATE_BOUNDS();return this.transform(t),t},e.prototype.transform=function(t){for(var n=[],i=0,s=this.commands;i<s.length;i++){var a=t(s[i]);Array.isArray(a)?n.push.apply(n,a):n.push(a)}return this.commands=n,this},e.encode=function(t){return e1e(t)},e.parse=function(t){var n=new r1e,i=[];return n.parse(t,i),n.finish(i),i},e.CLOSE_PATH=1,e.MOVE_TO=2,e.HORIZ_LINE_TO=4,e.VERT_LINE_TO=8,e.LINE_TO=16,e.CURVE_TO=32,e.SMOOTH_CURVE_TO=64,e.QUAD_TO=128,e.SMOOTH_QUAD_TO=256,e.ARC=512,e.LINE_COMMANDS=e.LINE_TO|e.HORIZ_LINE_TO|e.VERT_LINE_TO,e.DRAWING_COMMANDS=e.HORIZ_LINE_TO|e.VERT_LINE_TO|e.LINE_TO|e.CURVE_TO|e.SMOOTH_CURVE_TO|e.QUAD_TO|e.SMOOTH_QUAD_TO|e.ARC,e}(lD),n1e=((ol={})[Ut.MOVE_TO]=2,ol[Ut.LINE_TO]=2,ol[Ut.HORIZ_LINE_TO]=1,ol[Ut.VERT_LINE_TO]=1,ol[Ut.CLOSE_PATH]=0,ol[Ut.QUAD_TO]=4,ol[Ut.SMOOTH_QUAD_TO]=2,ol[Ut.CURVE_TO]=6,ol[Ut.SMOOTH_CURVE_TO]=4,ol[Ut.ARC]=7,ol),i1e=Xs,s1e=il,o1e=B1,a1e=jR,AD=RegExp.prototype,c1e=function(r){var e=r.flags;return e===void 0&&!("flags"in AD)&&!s1e(r,"flags")&&o1e(AD,r)?i1e(a1e,r):e},l1e=F1.PROPER,u1e=td,A1e=Qo,hD=eu,h1e=is,d1e=c1e,OC="toString",dD=RegExp.prototype,fD=dD[OC],f1e=h1e(function(){return fD.call({source:"a",flags:"b"})!=="/a/b"}),p1e=l1e&&fD.name!==OC;(f1e||p1e)&&u1e(dD,OC,function(){var r=A1e(this),e=hD(r.source),t=hD(d1e(r));return"/"+e+"/"+t},{unsafe:!0});function l_(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l_=function(e){return typeof e}:l_=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l_(r)}function g1e(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var m1e=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],y1e=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function _1e(r,e,t,n,i){if(typeof r=="string"&&(r=document.getElementById(r)),!r||l_(r)!=="object"||!("getContext"in r))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var s=r.getContext("2d");try{return s.getImageData(e,t,n,i)}catch(a){throw new Error("unable to access image data: "+a)}}function v1e(r,e,t,n,i,s){if(!(isNaN(s)||s<1)){s|=0;var a=_1e(r,e,t,n,i);a=b1e(a,e,t,n,i,s),r.getContext("2d").putImageData(a,e,t)}}function b1e(r,e,t,n,i,s){for(var a=r.data,o=2*s+1,A=n-1,f=i-1,m=s+1,v=m*(m+1)/2,x=new pD,B=x,M,U=1;U<o;U++)B=B.next=new pD,U===m&&(M=B);B.next=x;for(var N=null,Q=null,q=0,Y=0,te=m1e[s],pe=y1e[s],ge=0;ge<i;ge++){B=x;for(var ye=a[Y],fe=a[Y+1],Oe=a[Y+2],Fe=a[Y+3],oe=0;oe<m;oe++)B.r=ye,B.g=fe,B.b=Oe,B.a=Fe,B=B.next;for(var le=0,xe=0,_e=0,tt=0,et=m*ye,nt=m*fe,Je=m*Oe,it=m*Fe,ot=v*ye,xt=v*fe,se=v*Oe,be=v*Fe,Me=1;Me<m;Me++){var De=Y+((A<Me?A:Me)<<2),$e=a[De],qe=a[De+1],ct=a[De+2],st=a[De+3],Ct=m-Me;ot+=(B.r=$e)*Ct,xt+=(B.g=qe)*Ct,se+=(B.b=ct)*Ct,be+=(B.a=st)*Ct,le+=$e,xe+=qe,_e+=ct,tt+=st,B=B.next}N=x,Q=M;for(var It=0;It<n;It++){var Qt=be*te>>>pe;if(a[Y+3]=Qt,Qt!==0){var Ht=255/Qt;a[Y]=(ot*te>>>pe)*Ht,a[Y+1]=(xt*te>>>pe)*Ht,a[Y+2]=(se*te>>>pe)*Ht}else a[Y]=a[Y+1]=a[Y+2]=0;ot-=et,xt-=nt,se-=Je,be-=it,et-=N.r,nt-=N.g,Je-=N.b,it-=N.a;var zt=It+s+1;zt=q+(zt<A?zt:A)<<2,le+=N.r=a[zt],xe+=N.g=a[zt+1],_e+=N.b=a[zt+2],tt+=N.a=a[zt+3],ot+=le,xt+=xe,se+=_e,be+=tt,N=N.next;var mt=Q,Re=mt.r,Ye=mt.g,tr=mt.b,St=mt.a;et+=Re,nt+=Ye,Je+=tr,it+=St,le-=Re,xe-=Ye,_e-=tr,tt-=St,Q=Q.next,Y+=4}q+=n}for(var vt=0;vt<n;vt++){Y=vt<<2;var Bt=a[Y],kt=a[Y+1],ir=a[Y+2],Ar=a[Y+3],Lr=m*Bt,Tr=m*kt,kr=m*ir,Qr=m*Ar,pt=v*Bt,Ir=v*kt,Dt=v*ir,xn=v*Ar;B=x;for(var Mr=0;Mr<m;Mr++)B.r=Bt,B.g=kt,B.b=ir,B.a=Ar,B=B.next;for(var Tt=n,Jt=0,Kt=0,Yr=0,Or=0,gr=1;gr<=s;gr++){Y=Tt+vt<<2;var an=m-gr;pt+=(B.r=Bt=a[Y])*an,Ir+=(B.g=kt=a[Y+1])*an,Dt+=(B.b=ir=a[Y+2])*an,xn+=(B.a=Ar=a[Y+3])*an,Or+=Bt,Jt+=kt,Kt+=ir,Yr+=Ar,B=B.next,gr<f&&(Tt+=n)}Y=vt,N=x,Q=M;for(var Wr=0;Wr<i;Wr++){var Ee=Y<<2;a[Ee+3]=Ar=xn*te>>>pe,Ar>0?(Ar=255/Ar,a[Ee]=(pt*te>>>pe)*Ar,a[Ee+1]=(Ir*te>>>pe)*Ar,a[Ee+2]=(Dt*te>>>pe)*Ar):a[Ee]=a[Ee+1]=a[Ee+2]=0,pt-=Lr,Ir-=Tr,Dt-=kr,xn-=Qr,Lr-=N.r,Tr-=N.g,kr-=N.b,Qr-=N.a,Ee=vt+((Ee=Wr+m)<f?Ee:f)*n<<2,pt+=Or+=N.r=a[Ee],Ir+=Jt+=N.g=a[Ee+1],Dt+=Kt+=N.b=a[Ee+2],xn+=Yr+=N.a=a[Ee+3],N=N.next,Lr+=Bt=Q.r,Tr+=kt=Q.g,kr+=ir=Q.b,Qr+=Ar=Q.a,Or-=Bt,Jt-=kt,Kt-=ir,Yr-=Ar,Q=Q.next,Y+=n}}return r}var pD=function r(){g1e(this,r),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};function w1e(){var{DOMParser:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:r,createCanvas(t,n){return new OffscreenCanvas(t,n)},createImage(t){return Gu(function*(){var n=yield fetch(t),i=yield n.blob(),s=yield createImageBitmap(i);return s})()}};return(typeof DOMParser<"u"||typeof r>"u")&&Reflect.deleteProperty(e,"DOMParser"),e}function x1e(r){var{DOMParser:e,canvas:t,fetch:n}=r;return{window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:e,fetch:n,createCanvas:t.createCanvas,createImage:t.loadImage}}var B1e=Object.freeze({__proto__:null,offscreen:w1e,node:x1e});function od(r){return r.replace(/(?!\u3000)\s+/gm," ")}function gD(r){return r.replace(/^[\n \t]+/,"")}function mD(r){return r.replace(/[\n \t]+$/,"")}function fa(r){var e=(r||"").match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm)||[];return e.map(parseFloat)}var C1e=/^[A-Z-]+$/;function yD(r){return C1e.test(r)?r.toLowerCase():r}function DC(r){var e=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(r)||[];return e[2]||e[3]||e[4]}function _D(r){if(!r.startsWith("rgb"))return r;var e=3,t=r.replace(/\d+(\.\d+)?/g,(n,i)=>e--&&i?String(Math.round(parseFloat(n))):n);return t}var E1e=/(\[[^\]]+\])/g,S1e=/(#[^\s+>~.[:]+)/g,T1e=/(\.[^\s+>~.[:]+)/g,I1e=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,L1e=/(:[\w-]+\([^)]*\))/gi,F1e=/(:[^\s+>~.[:]+)/g,M1e=/([^\s+>~.[:]+)/g;function ad(r,e){var t=e.exec(r);return t?[r.replace(e," "),t.length]:[r,0]}function vD(r){var e=[0,0,0],t=r.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),n=0;return[t,n]=ad(t,E1e),e[1]+=n,[t,n]=ad(t,S1e),e[0]+=n,[t,n]=ad(t,T1e),e[1]+=n,[t,n]=ad(t,I1e),e[2]+=n,[t,n]=ad(t,L1e),e[1]+=n,[t,n]=ad(t,F1e),e[1]+=n,t=t.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),[t,n]=ad(t,M1e),e[2]+=n,e.join("")}var cd=1e-8;function kC(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2))}function u_(r,e){return(r[0]*e[0]+r[1]*e[1])/(kC(r)*kC(e))}function NC(r,e){return(r[0]*e[1]<r[1]*e[0]?-1:1)*Math.acos(u_(r,e))}function QC(r){return r*r*r}function HC(r){return 3*r*r*(1-r)}function zC(r){return 3*r*(1-r)*(1-r)}function GC(r){return(1-r)*(1-r)*(1-r)}function VC(r){return r*r}function jC(r){return 2*r*(1-r)}function qC(r){return(1-r)*(1-r)}class Rr{constructor(e,t,n){this.document=e,this.name=t,this.value=n,this.isNormalizedColor=!1}static empty(e){return new Rr(e,"EMPTY","")}split(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:" ",{document:t,name:n}=this;return od(this.getString()).trim().split(e).map(i=>new Rr(t,n,i))}hasValue(e){var{value:t}=this;return t!==null&&t!==""&&(e||t!==0)&&typeof t<"u"}isString(e){var{value:t}=this,n=typeof t=="string";return!n||!e?n:e.test(t)}isUrlDefinition(){return this.isString(/^url\(/)}isPixels(){if(!this.hasValue())return!1;var e=this.getString();switch(!0){case e.endsWith("px"):case/^[0-9]+$/.test(e):return!0;default:return!1}}setValue(e){return this.value=e,this}getValue(e){return typeof e>"u"||this.hasValue()?this.value:e}getNumber(e){if(!this.hasValue())return typeof e>"u"?0:parseFloat(e);var{value:t}=this,n=parseFloat(t);return this.isString(/%$/)&&(n/=100),n}getString(e){return typeof e>"u"||this.hasValue()?typeof this.value>"u"?"":String(this.value):String(e)}getColor(e){var t=this.getString(e);return this.isNormalizedColor||(this.isNormalizedColor=!0,t=_D(t),this.value=t),t}getDpi(){return 96}getRem(){return this.document.rootEmSize}getEm(){return this.document.emSize}getUnits(){return this.getString().replace(/[0-9.-]/g,"")}getPixels(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!this.hasValue())return 0;var[n,i]=typeof e=="boolean"?[void 0,e]:[e],{viewPort:s}=this.document.screen;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(s.computeSize("x"),s.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(s.computeSize("x"),s.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*s.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*s.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return this.getNumber()*15;case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case(this.isString(/%$/)&&i):return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*s.computeSize(n);default:{var a=this.getNumber();return t&&a<1?a*s.computeSize(n):a}}}getMilliseconds(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():this.getNumber()*1e3:0}getRadians(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}getDefinition(){var e=this.getString(),t=/#([^)'"]+)/.exec(e);return t&&(t=t[1]),t||(t=e),this.document.definitions[t]}getFillStyleDefinition(e,t){var n=this.getDefinition();if(!n)return null;if(typeof n.createGradient=="function")return n.createGradient(this.document.ctx,e,t);if(typeof n.createPattern=="function"){if(n.getHrefAttribute().hasValue()){var i=n.getAttribute("patternTransform");n=n.getHrefAttribute().getDefinition(),i.hasValue()&&n.getAttribute("patternTransform",!0).setValue(i.value)}return n.createPattern(this.document.ctx,e,t)}return null}getTextBaseline(){return this.hasValue()?Rr.textBaselineMapping[this.getString()]:null}addOpacity(e){for(var t=this.getColor(),n=t.length,i=0,s=0;s<n&&(t[s]===","&&i++,i!==3);s++);if(e.hasValue()&&this.isString()&&i!==3){var a=new MC(t);a.ok&&(a.alpha=e.getNumber(),t=a.toRGBA())}return new Rr(this.document,this.name,t)}}Rr.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};class bD{constructor(){this.viewPorts=[]}clear(){this.viewPorts=[]}setCurrent(e,t){this.viewPorts.push({width:e,height:t})}removeCurrent(){this.viewPorts.pop()}getCurrent(){var{viewPorts:e}=this;return e[e.length-1]}get width(){return this.getCurrent().width}get height(){return this.getCurrent().height}computeSize(e){return typeof e=="number"?e:e==="x"?this.width:e==="y"?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}}class ji{constructor(e,t){this.x=e,this.y=t}static parse(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,[n=t,i=t]=fa(e);return new ji(n,i)}static parseScale(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,[n=t,i=n]=fa(e);return new ji(n,i)}static parsePath(e){for(var t=fa(e),n=t.length,i=[],s=0;s<n;s+=2)i.push(new ji(t[s],t[s+1]));return i}angleTo(e){return Math.atan2(e.y-this.y,e.x-this.x)}applyTransform(e){var{x:t,y:n}=this,i=t*e[0]+n*e[2]+e[4],s=t*e[1]+n*e[3]+e[5];this.x=i,this.y=s}}class wD{constructor(e){this.screen=e,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}isWorking(){return this.working}start(){if(!this.working){var{screen:e,onClick:t,onMouseMove:n}=this,i=e.ctx.canvas;i.onclick=t,i.onmousemove=n,this.working=!0}}stop(){if(this.working){var e=this.screen.ctx.canvas;this.working=!1,e.onclick=null,e.onmousemove=null}}hasEvents(){return this.working&&this.events.length>0}runEvents(){if(this.working){var{screen:e,events:t,eventElements:n}=this,{style:i}=e.ctx.canvas;i&&(i.cursor=""),t.forEach((s,a)=>{for(var{run:o}=s,A=n[a];A;)o(A),A=A.parent}),this.events=[],this.eventElements=[]}}checkPath(e,t){if(!(!this.working||!t)){var{events:n,eventElements:i}=this;n.forEach((s,a)=>{var{x:o,y:A}=s;!i[a]&&t.isPointInPath&&t.isPointInPath(o,A)&&(i[a]=e)})}}checkBoundingBox(e,t){if(!(!this.working||!t)){var{events:n,eventElements:i}=this;n.forEach((s,a)=>{var{x:o,y:A}=s;!i[a]&&t.isPointInBox(o,A)&&(i[a]=e)})}}mapXY(e,t){for(var{window:n,ctx:i}=this.screen,s=new ji(e,t),a=i.canvas;a;)s.x-=a.offsetLeft,s.y-=a.offsetTop,a=a.offsetParent;return n.scrollX&&(s.x+=n.scrollX),n.scrollY&&(s.y+=n.scrollY),s}onClick(e){var{x:t,y:n}=this.mapXY(e.clientX,e.clientY);this.events.push({type:"onclick",x:t,y:n,run(i){i.onClick&&i.onClick()}})}onMouseMove(e){var{x:t,y:n}=this.mapXY(e.clientX,e.clientY);this.events.push({type:"onmousemove",x:t,y:n,run(i){i.onMouseMove&&i.onMouseMove()}})}}var xD=typeof window<"u"?window:null,BD=typeof fetch<"u"?fetch.bind(void 0):null;class mm{constructor(e){var{fetch:t=BD,window:n=xD}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.ctx=e,this.FRAMERATE=30,this.MAX_VIRTUAL_PIXELS=3e4,this.CLIENT_WIDTH=800,this.CLIENT_HEIGHT=600,this.viewPort=new bD,this.mouse=new wD(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=n,this.fetch=t}wait(e){this.waits.push(e)}ready(){return this.readyPromise?this.readyPromise:Promise.resolve()}isReady(){if(this.isReadyLock)return!0;var e=this.waits.every(t=>t());return e&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=e,e}setDefaults(e){e.strokeStyle="rgba(0,0,0,0)",e.lineCap="butt",e.lineJoin="miter",e.miterLimit=4}setViewBox(e){var{document:t,ctx:n,aspectRatio:i,width:s,desiredWidth:a,height:o,desiredHeight:A,minX:f=0,minY:m=0,refX:v,refY:x,clip:B=!1,clipX:M=0,clipY:U=0}=e,N=od(i).replace(/^defer\s/,""),[Q,q]=N.split(" "),Y=Q||"xMidYMid",te=q||"meet",pe=s/a,ge=o/A,ye=Math.min(pe,ge),fe=Math.max(pe,ge),Oe=a,Fe=A;te==="meet"&&(Oe*=ye,Fe*=ye),te==="slice"&&(Oe*=fe,Fe*=fe);var oe=new Rr(t,"refX",v),le=new Rr(t,"refY",x),xe=oe.hasValue()&&le.hasValue();if(xe&&n.translate(-ye*oe.getPixels("x"),-ye*le.getPixels("y")),B){var _e=ye*M,tt=ye*U;n.beginPath(),n.moveTo(_e,tt),n.lineTo(s,tt),n.lineTo(s,o),n.lineTo(_e,o),n.closePath(),n.clip()}if(!xe){var et=te==="meet"&&ye===ge,nt=te==="slice"&&fe===ge,Je=te==="meet"&&ye===pe,it=te==="slice"&&fe===pe;Y.startsWith("xMid")&&(et||nt)&&n.translate(s/2-Oe/2,0),Y.endsWith("YMid")&&(Je||it)&&n.translate(0,o/2-Fe/2),Y.startsWith("xMax")&&(et||nt)&&n.translate(s-Oe,0),Y.endsWith("YMax")&&(Je||it)&&n.translate(0,o-Fe)}switch(!0){case Y==="none":n.scale(pe,ge);break;case te==="meet":n.scale(ye,ye);break;case te==="slice":n.scale(fe,fe);break}n.translate(-f,-m)}start(e){var{enableRedraw:t=!1,ignoreMouse:n=!1,ignoreAnimation:i=!1,ignoreDimensions:s=!1,ignoreClear:a=!1,forceRedraw:o,scaleWidth:A,scaleHeight:f,offsetX:m,offsetY:v}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{FRAMERATE:x,mouse:B}=this,M=1e3/x;if(this.frameDuration=M,this.readyPromise=new Promise(Y=>{this.resolveReady=Y}),this.isReady()&&this.render(e,s,a,A,f,m,v),!!t){var U=Date.now(),N=U,Q=0,q=()=>{U=Date.now(),Q=U-N,Q>=M&&(N=U-Q%M,this.shouldUpdate(i,o)&&(this.render(e,s,a,A,f,m,v),B.runEvents())),this.intervalId=IC(q)};n||B.start(),this.intervalId=IC(q)}}stop(){this.intervalId&&(IC.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}shouldUpdate(e,t){if(!e){var{frameDuration:n}=this,i=this.animations.reduce((s,a)=>a.update(n)||s,!1);if(i)return!0}return!!(typeof t=="function"&&t()||!this.isReadyLock&&this.isReady()||this.mouse.hasEvents())}render(e,t,n,i,s,a,o){var{CLIENT_WIDTH:A,CLIENT_HEIGHT:f,viewPort:m,ctx:v,isFirstRender:x}=this,B=v.canvas;m.clear(),B.width&&B.height?m.setCurrent(B.width,B.height):m.setCurrent(A,f);var M=e.getStyle("width"),U=e.getStyle("height");!t&&(x||typeof i!="number"&&typeof s!="number")&&(M.hasValue()&&(B.width=M.getPixels("x"),B.style&&(B.style.width="".concat(B.width,"px"))),U.hasValue()&&(B.height=U.getPixels("y"),B.style&&(B.style.height="".concat(B.height,"px"))));var N=B.clientWidth||B.width,Q=B.clientHeight||B.height;if(t&&M.hasValue()&&U.hasValue()&&(N=M.getPixels("x"),Q=U.getPixels("y")),m.setCurrent(N,Q),typeof a=="number"&&e.getAttribute("x",!0).setValue(a),typeof o=="number"&&e.getAttribute("y",!0).setValue(o),typeof i=="number"||typeof s=="number"){var q=fa(e.getAttribute("viewBox").getString()),Y=0,te=0;if(typeof i=="number"){var pe=e.getStyle("width");pe.hasValue()?Y=pe.getPixels("x")/i:isNaN(q[2])||(Y=q[2]/i)}if(typeof s=="number"){var ge=e.getStyle("height");ge.hasValue()?te=ge.getPixels("y")/s:isNaN(q[3])||(te=q[3]/s)}Y||(Y=te),te||(te=Y),e.getAttribute("width",!0).setValue(i),e.getAttribute("height",!0).setValue(s);var ye=e.getStyle("transform",!0,!0);ye.setValue("".concat(ye.getString()," scale(").concat(1/Y,", ").concat(1/te,")"))}n||v.clearRect(0,0,N,Q),e.render(v),x&&(this.isFirstRender=!1)}}mm.defaultWindow=xD,mm.defaultFetch=BD;var{defaultFetch:P1e}=mm,U1e=typeof DOMParser<"u"?DOMParser:null;class A_{constructor(){var{fetch:e=P1e,DOMParser:t=U1e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fetch=e,this.DOMParser=t}parse(e){var t=this;return Gu(function*(){return e.startsWith("<")?t.parseFromString(e):t.load(e)})()}parseFromString(e){var t=new this.DOMParser;try{return this.checkDocument(t.parseFromString(e,"image/svg+xml"))}catch{return this.checkDocument(t.parseFromString(e,"text/xml"))}}checkDocument(e){var t=e.getElementsByTagName("parsererror")[0];if(t)throw new Error(t.textContent);return e}load(e){var t=this;return Gu(function*(){var n=yield t.fetch(e),i=yield n.text();return t.parseFromString(i)})()}}class CD{constructor(e,t){this.type="translate",this.point=null,this.point=ji.parse(t)}apply(e){var{x:t,y:n}=this.point;e.translate(t||0,n||0)}unapply(e){var{x:t,y:n}=this.point;e.translate(-1*t||0,-1*n||0)}applyToPoint(e){var{x:t,y:n}=this.point;e.applyTransform([1,0,0,1,t||0,n||0])}}class ED{constructor(e,t,n){this.type="rotate",this.angle=null,this.originX=null,this.originY=null,this.cx=0,this.cy=0;var i=fa(t);this.angle=new Rr(e,"angle",i[0]),this.originX=n[0],this.originY=n[1],this.cx=i[1]||0,this.cy=i[2]||0}apply(e){var{cx:t,cy:n,originX:i,originY:s,angle:a}=this,o=t+i.getPixels("x"),A=n+s.getPixels("y");e.translate(o,A),e.rotate(a.getRadians()),e.translate(-o,-A)}unapply(e){var{cx:t,cy:n,originX:i,originY:s,angle:a}=this,o=t+i.getPixels("x"),A=n+s.getPixels("y");e.translate(o,A),e.rotate(-1*a.getRadians()),e.translate(-o,-A)}applyToPoint(e){var{cx:t,cy:n,angle:i}=this,s=i.getRadians();e.applyTransform([1,0,0,1,t||0,n||0]),e.applyTransform([Math.cos(s),Math.sin(s),-Math.sin(s),Math.cos(s),0,0]),e.applyTransform([1,0,0,1,-t||0,-n||0])}}class SD{constructor(e,t,n){this.type="scale",this.scale=null,this.originX=null,this.originY=null;var i=ji.parseScale(t);(i.x===0||i.y===0)&&(i.x=cd,i.y=cd),this.scale=i,this.originX=n[0],this.originY=n[1]}apply(e){var{scale:{x:t,y:n},originX:i,originY:s}=this,a=i.getPixels("x"),o=s.getPixels("y");e.translate(a,o),e.scale(t,n||t),e.translate(-a,-o)}unapply(e){var{scale:{x:t,y:n},originX:i,originY:s}=this,a=i.getPixels("x"),o=s.getPixels("y");e.translate(a,o),e.scale(1/t,1/n||t),e.translate(-a,-o)}applyToPoint(e){var{x:t,y:n}=this.scale;e.applyTransform([t||0,0,0,n||0,0,0])}}class KC{constructor(e,t,n){this.type="matrix",this.matrix=[],this.originX=null,this.originY=null,this.matrix=fa(t),this.originX=n[0],this.originY=n[1]}apply(e){var{originX:t,originY:n,matrix:i}=this,s=t.getPixels("x"),a=n.getPixels("y");e.translate(s,a),e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),e.translate(-s,-a)}unapply(e){var{originX:t,originY:n,matrix:i}=this,s=i[0],a=i[2],o=i[4],A=i[1],f=i[3],m=i[5],v=0,x=0,B=1,M=1/(s*(f*B-m*x)-a*(A*B-m*v)+o*(A*x-f*v)),U=t.getPixels("x"),N=n.getPixels("y");e.translate(U,N),e.transform(M*(f*B-m*x),M*(m*v-A*B),M*(o*x-a*B),M*(s*B-o*v),M*(a*m-o*f),M*(o*A-s*m)),e.translate(-U,-N)}applyToPoint(e){e.applyTransform(this.matrix)}}class WC extends KC{constructor(e,t,n){super(e,t,n),this.type="skew",this.angle=null,this.angle=new Rr(e,"angle",t)}}class TD extends WC{constructor(e,t,n){super(e,t,n),this.type="skewX",this.matrix=[1,0,Math.tan(this.angle.getRadians()),1,0,0]}}class ID extends WC{constructor(e,t,n){super(e,t,n),this.type="skewY",this.matrix=[1,Math.tan(this.angle.getRadians()),0,1,0,0]}}function R1e(r){return od(r).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)}function O1e(r){var[e,t]=r.split("(");return[e.trim(),t.trim().replace(")","")]}class YA{constructor(e,t,n){this.document=e,this.transforms=[];var i=R1e(t);i.forEach(s=>{if(s!=="none"){var[a,o]=O1e(s),A=YA.transformTypes[a];typeof A<"u"&&this.transforms.push(new A(this.document,o,n))}})}static fromElement(e,t){var n=t.getStyle("transform",!1,!0),[i,s=i]=t.getStyle("transform-origin",!1,!0).split(),a=[i,s];return n.hasValue()?new YA(e,n.getString(),a):null}apply(e){for(var{transforms:t}=this,n=t.length,i=0;i<n;i++)t[i].apply(e)}unapply(e){for(var{transforms:t}=this,n=t.length,i=n-1;i>=0;i--)t[i].unapply(e)}applyToPoint(e){for(var{transforms:t}=this,n=t.length,i=0;i<n;i++)t[i].applyToPoint(e)}}YA.transformTypes={translate:CD,rotate:ED,scale:SD,matrix:KC,skewX:TD,skewY:ID};class yi{constructor(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.document=e,this.node=t,this.captureTextNodes=n,this.attributes={},this.styles={},this.stylesSpecificity={},this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],!(!t||t.nodeType!==1)){if(Array.from(t.attributes).forEach(o=>{var A=yD(o.nodeName);this.attributes[A]=new Rr(e,A,o.value)}),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()){var i=this.getAttribute("style").getString().split(";").map(o=>o.trim());i.forEach(o=>{if(o){var[A,f]=o.split(":").map(m=>m.trim());this.styles[A]=new Rr(e,A,f)}})}var{definitions:s}=e,a=this.getAttribute("id");a.hasValue()&&(s[a.getString()]||(s[a.getString()]=this)),Array.from(t.childNodes).forEach(o=>{if(o.nodeType===1)this.addChild(o);else if(n&&(o.nodeType===3||o.nodeType===4)){var A=e.createTextNode(o);A.getText().length>0&&this.addChild(A)}})}}getAttribute(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this.attributes[e];if(!n&&t){var i=new Rr(this.document,e,"");return this.attributes[e]=i,i}return n||Rr.empty(this.document)}getHrefAttribute(){for(var e in this.attributes)if(e==="href"||e.endsWith(":href"))return this.attributes[e];return Rr.empty(this.document)}getStyle(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.styles[e];if(i)return i;var s=this.getAttribute(e);if(s!=null&&s.hasValue())return this.styles[e]=s,s;if(!n){var{parent:a}=this;if(a){var o=a.getStyle(e);if(o!=null&&o.hasValue())return o}}if(t){var A=new Rr(this.document,e,"");return this.styles[e]=A,A}return i||Rr.empty(this.document)}render(e){if(!(this.getStyle("display").getString()==="none"||this.getStyle("visibility").getString()==="hidden")){if(e.save(),this.getStyle("mask").hasValue()){var t=this.getStyle("mask").getDefinition();t&&(this.applyEffects(e),t.apply(e,this))}else if(this.getStyle("filter").getValue("none")!=="none"){var n=this.getStyle("filter").getDefinition();n&&(this.applyEffects(e),n.apply(e,this))}else this.setContext(e),this.renderChildren(e),this.clearContext(e);e.restore()}}setContext(e){}applyEffects(e){var t=YA.fromElement(this.document,this);t&&t.apply(e);var n=this.getStyle("clip-path",!1,!0);if(n.hasValue()){var i=n.getDefinition();i&&i.apply(e)}}clearContext(e){}renderChildren(e){this.children.forEach(t=>{t.render(e)})}addChild(e){var t=e instanceof yi?e:this.document.createElement(e);t.parent=this,yi.ignoreChildTypes.includes(t.type)||this.children.push(t)}matchesSelector(e){var t,{node:n}=this;if(typeof n.matches=="function")return n.matches(e);var i=(t=n.getAttribute)===null||t===void 0?void 0:t.call(n,"class");return!i||i===""?!1:i.split(" ").some(s=>".".concat(s)===e)}addStylesFromStyleDefinition(){var{styles:e,stylesSpecificity:t}=this.document;for(var n in e)if(!n.startsWith("@")&&this.matchesSelector(n)){var i=e[n],s=t[n];if(i)for(var a in i){var o=this.stylesSpecificity[a];typeof o>"u"&&(o="000"),s>=o&&(this.styles[a]=i[a],this.stylesSpecificity[a]=s)}}}removeStyles(e,t){var n=t.reduce((i,s)=>{var a=e.getStyle(s);if(!a.hasValue())return i;var o=a.getString();return a.setValue(""),[...i,[s,o]]},[]);return n}restoreStyles(e,t){t.forEach(n=>{var[i,s]=n;e.getStyle(i,!0).setValue(s)})}isFirstChild(){var e;return((e=this.parent)===null||e===void 0?void 0:e.children.indexOf(this))===0}}yi.ignoreChildTypes=["title"];class LD extends yi{constructor(e,t,n){super(e,t,n)}}function D1e(r){var e=r.trim();return/^('|")/.test(e)?e:'"'.concat(e,'"')}function k1e(r){return typeof process>"u"?r:r.trim().split(",").map(D1e).join(",")}function N1e(r){if(!r)return"";var e=r.trim().toLowerCase();switch(e){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return e;default:return/^oblique\s+(-|)\d+deg$/.test(e)?e:""}}function Q1e(r){if(!r)return"";var e=r.trim().toLowerCase();switch(e){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return e;default:return/^[\d.]+$/.test(e)?e:""}}class _o{constructor(e,t,n,i,s,a){var o=a?typeof a=="string"?_o.parse(a):a:{};this.fontFamily=s||o.fontFamily,this.fontSize=i||o.fontSize,this.fontStyle=e||o.fontStyle,this.fontWeight=n||o.fontWeight,this.fontVariant=t||o.fontVariant}static parse(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n="",i="",s="",a="",o="",A=od(e).trim().split(" "),f={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return A.forEach(m=>{switch(!0){case(!f.fontStyle&&_o.styles.includes(m)):m!=="inherit"&&(n=m),f.fontStyle=!0;break;case(!f.fontVariant&&_o.variants.includes(m)):m!=="inherit"&&(i=m),f.fontStyle=!0,f.fontVariant=!0;break;case(!f.fontWeight&&_o.weights.includes(m)):m!=="inherit"&&(s=m),f.fontStyle=!0,f.fontVariant=!0,f.fontWeight=!0;break;case!f.fontSize:m!=="inherit"&&([a]=m.split("/")),f.fontStyle=!0,f.fontVariant=!0,f.fontWeight=!0,f.fontSize=!0;break;default:m!=="inherit"&&(o+=m)}}),new _o(n,i,s,a,o,t)}toString(){return[N1e(this.fontStyle),this.fontVariant,Q1e(this.fontWeight),this.fontSize,k1e(this.fontFamily)].join(" ").trim()}}_o.styles="normal|italic|oblique|inherit",_o.variants="normal|small-caps|inherit",_o.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";class dc{constructor(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.NaN,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.NaN,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Number.NaN,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Number.NaN;this.x1=e,this.y1=t,this.x2=n,this.y2=i,this.addPoint(e,t),this.addPoint(n,i)}get x(){return this.x1}get y(){return this.y1}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}addPoint(e,t){typeof e<"u"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),typeof t<"u"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))}addX(e){this.addPoint(e,null)}addY(e){this.addPoint(null,e)}addBoundingBox(e){if(e){var{x1:t,y1:n,x2:i,y2:s}=e;this.addPoint(t,n),this.addPoint(i,s)}}sumCubic(e,t,n,i,s){return Math.pow(1-e,3)*t+3*Math.pow(1-e,2)*e*n+3*(1-e)*Math.pow(e,2)*i+Math.pow(e,3)*s}bezierCurveAdd(e,t,n,i,s){var a=6*t-12*n+6*i,o=-3*t+9*n-9*i+3*s,A=3*n-3*t;if(o===0){if(a===0)return;var f=-A/a;0<f&&f<1&&(e?this.addX(this.sumCubic(f,t,n,i,s)):this.addY(this.sumCubic(f,t,n,i,s)));return}var m=Math.pow(a,2)-4*A*o;if(!(m<0)){var v=(-a+Math.sqrt(m))/(2*o);0<v&&v<1&&(e?this.addX(this.sumCubic(v,t,n,i,s)):this.addY(this.sumCubic(v,t,n,i,s)));var x=(-a-Math.sqrt(m))/(2*o);0<x&&x<1&&(e?this.addX(this.sumCubic(x,t,n,i,s)):this.addY(this.sumCubic(x,t,n,i,s)))}}addBezierCurve(e,t,n,i,s,a,o,A){this.addPoint(e,t),this.addPoint(o,A),this.bezierCurveAdd(!0,e,n,s,o),this.bezierCurveAdd(!1,t,i,a,A)}addQuadraticCurve(e,t,n,i,s,a){var o=e+.6666666666666666*(n-e),A=t+2/3*(i-t),f=o+1/3*(s-e),m=A+1/3*(a-t);this.addBezierCurve(e,t,o,f,A,m,s,a)}isPointInBox(e,t){var{x1:n,y1:i,x2:s,y2:a}=this;return n<=e&&e<=s&&i<=t&&t<=a}}class rn extends Ut{constructor(e){super(e.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,"")),this.control=null,this.start=null,this.current=null,this.command=null,this.commands=this.commands,this.i=-1,this.previousCommand=null,this.points=[],this.angles=[]}reset(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new ji(0,0),this.control=new ji(0,0),this.current=new ji(0,0),this.points=[],this.angles=[]}isEnd(){var{i:e,commands:t}=this;return e>=t.length-1}next(){var e=this.commands[++this.i];return this.previousCommand=this.command,this.command=e,e}getPoint(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"x",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"y",n=new ji(this.command[e],this.command[t]);return this.makeAbsolute(n)}getAsControlPoint(e,t){var n=this.getPoint(e,t);return this.control=n,n}getAsCurrentPoint(e,t){var n=this.getPoint(e,t);return this.current=n,n}getReflectedControlPoint(){var e=this.previousCommand.type;if(e!==Ut.CURVE_TO&&e!==Ut.SMOOTH_CURVE_TO&&e!==Ut.QUAD_TO&&e!==Ut.SMOOTH_QUAD_TO)return this.current;var{current:{x:t,y:n},control:{x:i,y:s}}=this,a=new ji(2*t-i,2*n-s);return a}makeAbsolute(e){if(this.command.relative){var{x:t,y:n}=this.current;e.x+=t,e.y+=n}return e}addMarker(e,t,n){var{points:i,angles:s}=this;n&&s.length>0&&!s[s.length-1]&&(s[s.length-1]=i[i.length-1].angleTo(n)),this.addMarkerAngle(e,t?t.angleTo(e):null)}addMarkerAngle(e,t){this.points.push(e),this.angles.push(t)}getMarkerPoints(){return this.points}getMarkerAngles(){for(var{angles:e}=this,t=e.length,n=0;n<t;n++)if(!e[n]){for(var i=n+1;i<t;i++)if(e[i]){e[n]=e[i];break}}return e}}class ZA extends yi{constructor(){super(...arguments),this.modifiedEmSizeStack=!1}calculateOpacity(){for(var e=1,t=this;t;){var n=t.getStyle("opacity",!1,!0);n.hasValue(!0)&&(e*=n.getNumber()),t=t.parent}return e}setContext(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!t){var n=this.getStyle("fill"),i=this.getStyle("fill-opacity"),s=this.getStyle("stroke"),a=this.getStyle("stroke-opacity");if(n.isUrlDefinition()){var o=n.getFillStyleDefinition(this,i);o&&(e.fillStyle=o)}else if(n.hasValue()){n.getString()==="currentColor"&&n.setValue(this.getStyle("color").getColor());var A=n.getColor();A!=="inherit"&&(e.fillStyle=A==="none"?"rgba(0,0,0,0)":A)}if(i.hasValue()){var f=new Rr(this.document,"fill",e.fillStyle).addOpacity(i).getColor();e.fillStyle=f}if(s.isUrlDefinition()){var m=s.getFillStyleDefinition(this,a);m&&(e.strokeStyle=m)}else if(s.hasValue()){s.getString()==="currentColor"&&s.setValue(this.getStyle("color").getColor());var v=s.getString();v!=="inherit"&&(e.strokeStyle=v==="none"?"rgba(0,0,0,0)":v)}if(a.hasValue()){var x=new Rr(this.document,"stroke",e.strokeStyle).addOpacity(a).getString();e.strokeStyle=x}var B=this.getStyle("stroke-width");if(B.hasValue()){var M=B.getPixels();e.lineWidth=M||cd}var U=this.getStyle("stroke-linecap"),N=this.getStyle("stroke-linejoin"),Q=this.getStyle("stroke-miterlimit"),q=this.getStyle("stroke-dasharray"),Y=this.getStyle("stroke-dashoffset");if(U.hasValue()&&(e.lineCap=U.getString()),N.hasValue()&&(e.lineJoin=N.getString()),Q.hasValue()&&(e.miterLimit=Q.getNumber()),q.hasValue()&&q.getString()!=="none"){var te=fa(q.getString());typeof e.setLineDash<"u"?e.setLineDash(te):typeof e.webkitLineDash<"u"?e.webkitLineDash=te:typeof e.mozDash<"u"&&!(te.length===1&&te[0]===0)&&(e.mozDash=te);var pe=Y.getPixels();typeof e.lineDashOffset<"u"?e.lineDashOffset=pe:typeof e.webkitLineDashOffset<"u"?e.webkitLineDashOffset=pe:typeof e.mozDashOffset<"u"&&(e.mozDashOffset=pe)}}if(this.modifiedEmSizeStack=!1,typeof e.font<"u"){var ge=this.getStyle("font"),ye=this.getStyle("font-style"),fe=this.getStyle("font-variant"),Oe=this.getStyle("font-weight"),Fe=this.getStyle("font-size"),oe=this.getStyle("font-family"),le=new _o(ye.getString(),fe.getString(),Oe.getString(),Fe.hasValue()?"".concat(Fe.getPixels(!0),"px"):"",oe.getString(),_o.parse(ge.getString(),e.font));ye.setValue(le.fontStyle),fe.setValue(le.fontVariant),Oe.setValue(le.fontWeight),Fe.setValue(le.fontSize),oe.setValue(le.fontFamily),e.font=le.toString(),Fe.isPixels()&&(this.document.emSize=Fe.getPixels(),this.modifiedEmSizeStack=!0)}t||(this.applyEffects(e),e.globalAlpha=this.calculateOpacity())}clearContext(e){super.clearContext(e),this.modifiedEmSizeStack&&this.document.popEmSize()}}class Kn extends ZA{constructor(e,t,n){super(e,t,n),this.type="path",this.pathParser=null,this.pathParser=new rn(this.getAttribute("d").getString())}path(e){var{pathParser:t}=this,n=new dc;for(t.reset(),e&&e.beginPath();!t.isEnd();)switch(t.next().type){case rn.MOVE_TO:this.pathM(e,n);break;case rn.LINE_TO:this.pathL(e,n);break;case rn.HORIZ_LINE_TO:this.pathH(e,n);break;case rn.VERT_LINE_TO:this.pathV(e,n);break;case rn.CURVE_TO:this.pathC(e,n);break;case rn.SMOOTH_CURVE_TO:this.pathS(e,n);break;case rn.QUAD_TO:this.pathQ(e,n);break;case rn.SMOOTH_QUAD_TO:this.pathT(e,n);break;case rn.ARC:this.pathA(e,n);break;case rn.CLOSE_PATH:this.pathZ(e,n);break}return n}getBoundingBox(e){return this.path()}getMarkers(){var{pathParser:e}=this,t=e.getMarkerPoints(),n=e.getMarkerAngles(),i=t.map((s,a)=>[s,n[a]]);return i}renderChildren(e){this.path(e),this.document.screen.mouse.checkPath(this,e);var t=this.getStyle("fill-rule");e.fillStyle!==""&&(t.getString("inherit")!=="inherit"?e.fill(t.getString()):e.fill()),e.strokeStyle!==""&&(this.getAttribute("vector-effect").getString()==="non-scaling-stroke"?(e.save(),e.setTransform(1,0,0,1,0,0),e.stroke(),e.restore()):e.stroke());var n=this.getMarkers();if(n){var i=n.length-1,s=this.getStyle("marker-start"),a=this.getStyle("marker-mid"),o=this.getStyle("marker-end");if(s.isUrlDefinition()){var A=s.getDefinition(),[f,m]=n[0];A.render(e,f,m)}if(a.isUrlDefinition())for(var v=a.getDefinition(),x=1;x<i;x++){var[B,M]=n[x];v.render(e,B,M)}if(o.isUrlDefinition()){var U=o.getDefinition(),[N,Q]=n[i];U.render(e,N,Q)}}}static pathM(e){var t=e.getAsCurrentPoint();return e.start=e.current,{point:t}}pathM(e,t){var{pathParser:n}=this,{point:i}=Kn.pathM(n),{x:s,y:a}=i;n.addMarker(i),t.addPoint(s,a),e&&e.moveTo(s,a)}static pathL(e){var{current:t}=e,n=e.getAsCurrentPoint();return{current:t,point:n}}pathL(e,t){var{pathParser:n}=this,{current:i,point:s}=Kn.pathL(n),{x:a,y:o}=s;n.addMarker(s,i),t.addPoint(a,o),e&&e.lineTo(a,o)}static pathH(e){var{current:t,command:n}=e,i=new ji((n.relative?t.x:0)+n.x,t.y);return e.current=i,{current:t,point:i}}pathH(e,t){var{pathParser:n}=this,{current:i,point:s}=Kn.pathH(n),{x:a,y:o}=s;n.addMarker(s,i),t.addPoint(a,o),e&&e.lineTo(a,o)}static pathV(e){var{current:t,command:n}=e,i=new ji(t.x,(n.relative?t.y:0)+n.y);return e.current=i,{current:t,point:i}}pathV(e,t){var{pathParser:n}=this,{current:i,point:s}=Kn.pathV(n),{x:a,y:o}=s;n.addMarker(s,i),t.addPoint(a,o),e&&e.lineTo(a,o)}static pathC(e){var{current:t}=e,n=e.getPoint("x1","y1"),i=e.getAsControlPoint("x2","y2"),s=e.getAsCurrentPoint();return{current:t,point:n,controlPoint:i,currentPoint:s}}pathC(e,t){var{pathParser:n}=this,{current:i,point:s,controlPoint:a,currentPoint:o}=Kn.pathC(n);n.addMarker(o,a,s),t.addBezierCurve(i.x,i.y,s.x,s.y,a.x,a.y,o.x,o.y),e&&e.bezierCurveTo(s.x,s.y,a.x,a.y,o.x,o.y)}static pathS(e){var{current:t}=e,n=e.getReflectedControlPoint(),i=e.getAsControlPoint("x2","y2"),s=e.getAsCurrentPoint();return{current:t,point:n,controlPoint:i,currentPoint:s}}pathS(e,t){var{pathParser:n}=this,{current:i,point:s,controlPoint:a,currentPoint:o}=Kn.pathS(n);n.addMarker(o,a,s),t.addBezierCurve(i.x,i.y,s.x,s.y,a.x,a.y,o.x,o.y),e&&e.bezierCurveTo(s.x,s.y,a.x,a.y,o.x,o.y)}static pathQ(e){var{current:t}=e,n=e.getAsControlPoint("x1","y1"),i=e.getAsCurrentPoint();return{current:t,controlPoint:n,currentPoint:i}}pathQ(e,t){var{pathParser:n}=this,{current:i,controlPoint:s,currentPoint:a}=Kn.pathQ(n);n.addMarker(a,s,s),t.addQuadraticCurve(i.x,i.y,s.x,s.y,a.x,a.y),e&&e.quadraticCurveTo(s.x,s.y,a.x,a.y)}static pathT(e){var{current:t}=e,n=e.getReflectedControlPoint();e.control=n;var i=e.getAsCurrentPoint();return{current:t,controlPoint:n,currentPoint:i}}pathT(e,t){var{pathParser:n}=this,{current:i,controlPoint:s,currentPoint:a}=Kn.pathT(n);n.addMarker(a,s,s),t.addQuadraticCurve(i.x,i.y,s.x,s.y,a.x,a.y),e&&e.quadraticCurveTo(s.x,s.y,a.x,a.y)}static pathA(e){var{current:t,command:n}=e,{rX:i,rY:s,xRot:a,lArcFlag:o,sweepFlag:A}=n,f=a*(Math.PI/180),m=e.getAsCurrentPoint(),v=new ji(Math.cos(f)*(t.x-m.x)/2+Math.sin(f)*(t.y-m.y)/2,-Math.sin(f)*(t.x-m.x)/2+Math.cos(f)*(t.y-m.y)/2),x=Math.pow(v.x,2)/Math.pow(i,2)+Math.pow(v.y,2)/Math.pow(s,2);x>1&&(i*=Math.sqrt(x),s*=Math.sqrt(x));var B=(o===A?-1:1)*Math.sqrt((Math.pow(i,2)*Math.pow(s,2)-Math.pow(i,2)*Math.pow(v.y,2)-Math.pow(s,2)*Math.pow(v.x,2))/(Math.pow(i,2)*Math.pow(v.y,2)+Math.pow(s,2)*Math.pow(v.x,2)));isNaN(B)&&(B=0);var M=new ji(B*i*v.y/s,B*-s*v.x/i),U=new ji((t.x+m.x)/2+Math.cos(f)*M.x-Math.sin(f)*M.y,(t.y+m.y)/2+Math.sin(f)*M.x+Math.cos(f)*M.y),N=NC([1,0],[(v.x-M.x)/i,(v.y-M.y)/s]),Q=[(v.x-M.x)/i,(v.y-M.y)/s],q=[(-v.x-M.x)/i,(-v.y-M.y)/s],Y=NC(Q,q);return u_(Q,q)<=-1&&(Y=Math.PI),u_(Q,q)>=1&&(Y=0),{currentPoint:m,rX:i,rY:s,sweepFlag:A,xAxisRotation:f,centp:U,a1:N,ad:Y}}pathA(e,t){var{pathParser:n}=this,{currentPoint:i,rX:s,rY:a,sweepFlag:o,xAxisRotation:A,centp:f,a1:m,ad:v}=Kn.pathA(n),x=1-o?1:-1,B=m+x*(v/2),M=new ji(f.x+s*Math.cos(B),f.y+a*Math.sin(B));if(n.addMarkerAngle(M,B-x*Math.PI/2),n.addMarkerAngle(i,B-x*Math.PI),t.addPoint(i.x,i.y),e&&!isNaN(m)&&!isNaN(v)){var U=s>a?s:a,N=s>a?1:s/a,Q=s>a?a/s:1;e.translate(f.x,f.y),e.rotate(A),e.scale(N,Q),e.arc(0,0,U,m,m+v,!!(1-o)),e.scale(1/N,1/Q),e.rotate(-A),e.translate(-f.x,-f.y)}}static pathZ(e){e.current=e.start}pathZ(e,t){Kn.pathZ(this.pathParser),e&&t.x1!==t.x2&&t.y1!==t.y2&&e.closePath()}}class $C extends Kn{constructor(e,t,n){super(e,t,n),this.type="glyph",this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber(),this.unicode=this.getAttribute("unicode").getString(),this.arabicForm=this.getAttribute("arabic-form").getString()}}class qu extends ZA{constructor(e,t,n){super(e,t,new.target===qu?!0:n),this.type="text",this.x=0,this.y=0,this.measureCache=-1}setContext(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.setContext(e,t);var n=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();n&&(e.textBaseline=n)}initializeCoordinates(){this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY}getBoundingBox(e){if(this.type!=="text")return this.getTElementBoundingBox(e);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(e);var t=null;return this.children.forEach((n,i)=>{var s=this.getChildBoundingBox(e,this,this,i);t?t.addBoundingBox(s):t=s}),t}getFontSize(){var{document:e,parent:t}=this,n=_o.parse(e.ctx.font).fontSize,i=t.getStyle("font-size").getNumber(n);return i}getTElementBoundingBox(e){var t=this.getFontSize();return new dc(this.x,this.y-t,this.x+this.measureText(e),this.y)}getGlyph(e,t,n){var i=t[n],s=null;if(e.isArabic){var a=t.length,o=t[n-1],A=t[n+1],f="isolated";if((n===0||o===" ")&&n<a-1&&A!==" "&&(f="terminal"),n>0&&o!==" "&&n<a-1&&A!==" "&&(f="medial"),n>0&&o!==" "&&(n===a-1||A===" ")&&(f="initial"),typeof e.glyphs[i]<"u"){var m=e.glyphs[i];s=m instanceof $C?m:m[f]}}else s=e.glyphs[i];return s||(s=e.missingGlyph),s}getText(){return""}getTextFromNode(e){var t=e||this.node,n=Array.from(t.parentNode.childNodes),i=n.indexOf(t),s=n.length-1,a=od(t.textContent||"");return i===0&&(a=gD(a)),i===s&&(a=mD(a)),a}renderChildren(e){if(this.type!=="text"){this.renderTElementChildren(e);return}this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(e),this.children.forEach((n,i)=>{this.renderChild(e,this,this,i)});var{mouse:t}=this.document.screen;t.isWorking()&&t.checkBoundingBox(this,this.getBoundingBox(e))}renderTElementChildren(e){var{document:t,parent:n}=this,i=this.getText(),s=n.getStyle("font-family").getDefinition();if(s){for(var{unitsPerEm:a}=s.fontFace,o=_o.parse(t.ctx.font),A=n.getStyle("font-size").getNumber(o.fontSize),f=n.getStyle("font-style").getString(o.fontStyle),m=A/a,v=s.isRTL?i.split("").reverse().join(""):i,x=fa(n.getAttribute("dx").getString()),B=v.length,M=0;M<B;M++){var U=this.getGlyph(s,v,M);e.translate(this.x,this.y),e.scale(m,-m);var N=e.lineWidth;e.lineWidth=e.lineWidth*a/A,f==="italic"&&e.transform(1,0,.4,1,0,0),U.render(e),f==="italic"&&e.transform(1,0,-.4,1,0,0),e.lineWidth=N,e.scale(1/m,-1/m),e.translate(-this.x,-this.y),this.x+=A*(U.horizAdvX||s.horizAdvX)/a,typeof x[M]<"u"&&!isNaN(x[M])&&(this.x+=x[M])}return}var{x:Q,y:q}=this;e.fillStyle&&e.fillText(i,Q,q),e.strokeStyle&&e.strokeText(i,Q,q)}applyAnchoring(){if(!(this.textChunkStart>=this.leafTexts.length)){var e=this.leafTexts[this.textChunkStart],t=e.getStyle("text-anchor").getString("start"),n=!1,i=0;t==="start"&&!n||t==="end"&&n?i=e.x-this.minX:t==="end"&&!n||t==="start"&&n?i=e.x-this.maxX:i=e.x-(this.minX+this.maxX)/2;for(var s=this.textChunkStart;s<this.leafTexts.length;s++)this.leafTexts[s].x+=i;this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.textChunkStart=this.leafTexts.length}}adjustChildCoordinatesRecursive(e){this.children.forEach((t,n)=>{this.adjustChildCoordinatesRecursiveCore(e,this,this,n)}),this.applyAnchoring()}adjustChildCoordinatesRecursiveCore(e,t,n,i){var s=n.children[i];s.children.length>0?s.children.forEach((a,o)=>{t.adjustChildCoordinatesRecursiveCore(e,t,s,o)}):this.adjustChildCoordinates(e,t,n,i)}adjustChildCoordinates(e,t,n,i){var s=n.children[i];if(typeof s.measureText!="function")return s;e.save(),s.setContext(e,!0);var a=s.getAttribute("x"),o=s.getAttribute("y"),A=s.getAttribute("dx"),f=s.getAttribute("dy"),m=s.getStyle("font-family").getDefinition(),v=!!m&&m.isRTL;i===0&&(a.hasValue()||a.setValue(s.getInheritedAttribute("x")),o.hasValue()||o.setValue(s.getInheritedAttribute("y")),A.hasValue()||A.setValue(s.getInheritedAttribute("dx")),f.hasValue()||f.setValue(s.getInheritedAttribute("dy")));var x=s.measureText(e);return v&&(t.x-=x),a.hasValue()?(t.applyAnchoring(),s.x=a.getPixels("x"),A.hasValue()&&(s.x+=A.getPixels("x"))):(A.hasValue()&&(t.x+=A.getPixels("x")),s.x=t.x),t.x=s.x,v||(t.x+=x),o.hasValue()?(s.y=o.getPixels("y"),f.hasValue()&&(s.y+=f.getPixels("y"))):(f.hasValue()&&(t.y+=f.getPixels("y")),s.y=t.y),t.y=s.y,t.leafTexts.push(s),t.minX=Math.min(t.minX,s.x,s.x+x),t.maxX=Math.max(t.maxX,s.x,s.x+x),s.clearContext(e),e.restore(),s}getChildBoundingBox(e,t,n,i){var s=n.children[i];if(typeof s.getBoundingBox!="function")return null;var a=s.getBoundingBox(e);return a?(s.children.forEach((o,A)=>{var f=t.getChildBoundingBox(e,t,s,A);a.addBoundingBox(f)}),a):null}renderChild(e,t,n,i){var s=n.children[i];s.render(e),s.children.forEach((a,o)=>{t.renderChild(e,t,s,o)})}measureText(e){var{measureCache:t}=this;if(~t)return t;var n=this.getText(),i=this.measureTargetText(e,n);return this.measureCache=i,i}measureTargetText(e,t){if(!t.length)return 0;var{parent:n}=this,i=n.getStyle("font-family").getDefinition();if(i){for(var s=this.getFontSize(),a=i.isRTL?t.split("").reverse().join(""):t,o=fa(n.getAttribute("dx").getString()),A=a.length,f=0,m=0;m<A;m++){var v=this.getGlyph(i,a,m);f+=(v.horizAdvX||i.horizAdvX)*s/i.fontFace.unitsPerEm,typeof o[m]<"u"&&!isNaN(o[m])&&(f+=o[m])}return f}if(!e.measureText)return t.length*10;e.save(),this.setContext(e,!0);var{width:x}=e.measureText(t);return this.clearContext(e),e.restore(),x}getInheritedAttribute(e){for(var t=this;t instanceof qu&&t.isFirstChild();){var n=t.parent.getAttribute(e);if(n.hasValue(!0))return n.getValue("0");t=t.parent}return null}}class ym extends qu{constructor(e,t,n){super(e,t,new.target===ym?!0:n),this.type="tspan",this.text=this.children.length>0?"":this.getTextFromNode()}getText(){return this.text}}class H1e extends ym{constructor(){super(...arguments),this.type="textNode"}}class ip extends ZA{constructor(){super(...arguments),this.type="svg",this.root=!1}setContext(e){var t,{document:n}=this,{screen:i,window:s}=n,a=e.canvas;if(i.setDefaults(e),a.style&&typeof e.font<"u"&&s&&typeof s.getComputedStyle<"u"){e.font=s.getComputedStyle(a).getPropertyValue("font");var o=new Rr(n,"fontSize",_o.parse(e.font).fontSize);o.hasValue()&&(n.rootEmSize=o.getPixels("y"),n.emSize=n.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);var{width:A,height:f}=i.viewPort;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");var m=this.getAttribute("refX"),v=this.getAttribute("refY"),x=this.getAttribute("viewBox"),B=x.hasValue()?fa(x.getString()):null,M=!this.root&&this.getStyle("overflow").getValue("hidden")!=="visible",U=0,N=0,Q=0,q=0;B&&(U=B[0],N=B[1]),this.root||(A=this.getStyle("width").getPixels("x"),f=this.getStyle("height").getPixels("y"),this.type==="marker"&&(Q=U,q=N,U=0,N=0)),i.viewPort.setCurrent(A,f),this.node&&(!this.parent||((t=this.node.parentNode)===null||t===void 0?void 0:t.nodeName)==="foreignObject")&&this.getStyle("transform",!1,!0).hasValue()&&!this.getStyle("transform-origin",!1,!0).hasValue()&&this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),super.setContext(e),e.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),B&&(A=B[2],f=B[3]),n.setViewBox({ctx:e,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:i.viewPort.width,desiredWidth:A,height:i.viewPort.height,desiredHeight:f,minX:U,minY:N,refX:m.getValue(),refY:v.getValue(),clip:M,clipX:Q,clipY:q}),B&&(i.viewPort.removeCurrent(),i.viewPort.setCurrent(A,f))}clearContext(e){super.clearContext(e),this.document.screen.viewPort.removeCurrent()}resize(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getAttribute("width",!0),s=this.getAttribute("height",!0),a=this.getAttribute("viewBox"),o=this.getAttribute("style"),A=i.getNumber(0),f=s.getNumber(0);if(n)if(typeof n=="string")this.getAttribute("preserveAspectRatio",!0).setValue(n);else{var m=this.getAttribute("preserveAspectRatio");m.hasValue()&&m.setValue(m.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(i.setValue(e),s.setValue(t),a.hasValue()||a.setValue("0 0 ".concat(A||e," ").concat(f||t)),o.hasValue()){var v=this.getStyle("width"),x=this.getStyle("height");v.hasValue()&&v.setValue("".concat(e,"px")),x.hasValue()&&x.setValue("".concat(t,"px"))}}}class XC extends Kn{constructor(){super(...arguments),this.type="rect"}path(e){var t=this.getAttribute("x").getPixels("x"),n=this.getAttribute("y").getPixels("y"),i=this.getStyle("width",!1,!0).getPixels("x"),s=this.getStyle("height",!1,!0).getPixels("y"),a=this.getAttribute("rx"),o=this.getAttribute("ry"),A=a.getPixels("x"),f=o.getPixels("y");if(a.hasValue()&&!o.hasValue()&&(f=A),o.hasValue()&&!a.hasValue()&&(A=f),A=Math.min(A,i/2),f=Math.min(f,s/2),e){var m=4*((Math.sqrt(2)-1)/3);e.beginPath(),s>0&&i>0&&(e.moveTo(t+A,n),e.lineTo(t+i-A,n),e.bezierCurveTo(t+i-A+m*A,n,t+i,n+f-m*f,t+i,n+f),e.lineTo(t+i,n+s-f),e.bezierCurveTo(t+i,n+s-f+m*f,t+i-A+m*A,n+s,t+i-A,n+s),e.lineTo(t+A,n+s),e.bezierCurveTo(t+A-m*A,n+s,t,n+s-f+m*f,t,n+s-f),e.lineTo(t,n+f),e.bezierCurveTo(t,n+f-m*f,t+A-m*A,n,t+A,n),e.closePath())}return new dc(t,n,t+i,n+s)}getMarkers(){return null}}class FD extends Kn{constructor(){super(...arguments),this.type="circle"}path(e){var t=this.getAttribute("cx").getPixels("x"),n=this.getAttribute("cy").getPixels("y"),i=this.getAttribute("r").getPixels();return e&&i>0&&(e.beginPath(),e.arc(t,n,i,0,Math.PI*2,!1),e.closePath()),new dc(t-i,n-i,t+i,n+i)}getMarkers(){return null}}class MD extends Kn{constructor(){super(...arguments),this.type="ellipse"}path(e){var t=4*((Math.sqrt(2)-1)/3),n=this.getAttribute("rx").getPixels("x"),i=this.getAttribute("ry").getPixels("y"),s=this.getAttribute("cx").getPixels("x"),a=this.getAttribute("cy").getPixels("y");return e&&n>0&&i>0&&(e.beginPath(),e.moveTo(s+n,a),e.bezierCurveTo(s+n,a+t*i,s+t*n,a+i,s,a+i),e.bezierCurveTo(s-t*n,a+i,s-n,a+t*i,s-n,a),e.bezierCurveTo(s-n,a-t*i,s-t*n,a-i,s,a-i),e.bezierCurveTo(s+t*n,a-i,s+n,a-t*i,s+n,a),e.closePath()),new dc(s-n,a-i,s+n,a+i)}getMarkers(){return null}}class PD extends Kn{constructor(){super(...arguments),this.type="line"}getPoints(){return[new ji(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new ji(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}path(e){var[{x:t,y:n},{x:i,y:s}]=this.getPoints();return e&&(e.beginPath(),e.moveTo(t,n),e.lineTo(i,s)),new dc(t,n,i,s)}getMarkers(){var[e,t]=this.getPoints(),n=e.angleTo(t);return[[e,n],[t,n]]}}class JC extends Kn{constructor(e,t,n){super(e,t,n),this.type="polyline",this.points=[],this.points=ji.parsePath(this.getAttribute("points").getString())}path(e){var{points:t}=this,[{x:n,y:i}]=t,s=new dc(n,i);return e&&(e.beginPath(),e.moveTo(n,i)),t.forEach(a=>{var{x:o,y:A}=a;s.addPoint(o,A),e&&e.lineTo(o,A)}),s}getMarkers(){var{points:e}=this,t=e.length-1,n=[];return e.forEach((i,s)=>{s!==t&&n.push([i,i.angleTo(e[s+1])])}),n.length>0&&n.push([e[e.length-1],n[n.length-1][1]]),n}}class UD extends JC{constructor(){super(...arguments),this.type="polygon"}path(e){var t=super.path(e),[{x:n,y:i}]=this.points;return e&&(e.lineTo(n,i),e.closePath()),t}}class RD extends yi{constructor(){super(...arguments),this.type="pattern"}createPattern(e,t,n){var i=this.getStyle("width").getPixels("x",!0),s=this.getStyle("height").getPixels("y",!0),a=new ip(this.document,null);a.attributes.viewBox=new Rr(this.document,"viewBox",this.getAttribute("viewBox").getValue()),a.attributes.width=new Rr(this.document,"width","".concat(i,"px")),a.attributes.height=new Rr(this.document,"height","".concat(s,"px")),a.attributes.transform=new Rr(this.document,"transform",this.getAttribute("patternTransform").getValue()),a.children=this.children;var o=this.document.createCanvas(i,s),A=o.getContext("2d"),f=this.getAttribute("x"),m=this.getAttribute("y");f.hasValue()&&m.hasValue()&&A.translate(f.getPixels("x",!0),m.getPixels("y",!0)),n.hasValue()?this.styles["fill-opacity"]=n:Reflect.deleteProperty(this.styles,"fill-opacity");for(var v=-1;v<=1;v++)for(var x=-1;x<=1;x++)A.save(),a.attributes.x=new Rr(this.document,"x",v*o.width),a.attributes.y=new Rr(this.document,"y",x*o.height),a.render(A),A.restore();var B=e.createPattern(o,"repeat");return B}}class OD extends yi{constructor(){super(...arguments),this.type="marker"}render(e,t,n){if(t){var{x:i,y:s}=t,a=this.getAttribute("orient").getString("auto"),o=this.getAttribute("markerUnits").getString("strokeWidth");e.translate(i,s),a==="auto"&&e.rotate(n),o==="strokeWidth"&&e.scale(e.lineWidth,e.lineWidth),e.save();var A=new ip(this.document,null);A.type=this.type,A.attributes.viewBox=new Rr(this.document,"viewBox",this.getAttribute("viewBox").getValue()),A.attributes.refX=new Rr(this.document,"refX",this.getAttribute("refX").getValue()),A.attributes.refY=new Rr(this.document,"refY",this.getAttribute("refY").getValue()),A.attributes.width=new Rr(this.document,"width",this.getAttribute("markerWidth").getValue()),A.attributes.height=new Rr(this.document,"height",this.getAttribute("markerHeight").getValue()),A.attributes.overflow=new Rr(this.document,"overflow",this.getAttribute("overflow").getValue()),A.attributes.fill=new Rr(this.document,"fill",this.getAttribute("fill").getColor("black")),A.attributes.stroke=new Rr(this.document,"stroke",this.getAttribute("stroke").getValue("none")),A.children=this.children,A.render(e),e.restore(),o==="strokeWidth"&&e.scale(1/e.lineWidth,1/e.lineWidth),a==="auto"&&e.rotate(-n),e.translate(-i,-s)}}}class DD extends yi{constructor(){super(...arguments),this.type="defs"}render(){}}class h_ extends ZA{constructor(){super(...arguments),this.type="g"}getBoundingBox(e){var t=new dc;return this.children.forEach(n=>{t.addBoundingBox(n.getBoundingBox(e))}),t}}class YC extends yi{constructor(e,t,n){super(e,t,n),this.attributesToInherit=["gradientUnits"],this.stops=[];var{stops:i,children:s}=this;s.forEach(a=>{a.type==="stop"&&i.push(a)})}getGradientUnits(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}createGradient(e,t,n){var i=this;this.getHrefAttribute().hasValue()&&(i=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(i));var{stops:s}=i,a=this.getGradient(e,t);if(!a)return this.addParentOpacity(n,s[s.length-1].color);if(s.forEach(N=>{a.addColorStop(N.offset,this.addParentOpacity(n,N.color))}),this.getAttribute("gradientTransform").hasValue()){var{document:o}=this,{MAX_VIRTUAL_PIXELS:A,viewPort:f}=o.screen,[m]=f.viewPorts,v=new XC(o,null);v.attributes.x=new Rr(o,"x",-A/3),v.attributes.y=new Rr(o,"y",-A/3),v.attributes.width=new Rr(o,"width",A),v.attributes.height=new Rr(o,"height",A);var x=new h_(o,null);x.attributes.transform=new Rr(o,"transform",this.getAttribute("gradientTransform").getValue()),x.children=[v];var B=new ip(o,null);B.attributes.x=new Rr(o,"x",0),B.attributes.y=new Rr(o,"y",0),B.attributes.width=new Rr(o,"width",m.width),B.attributes.height=new Rr(o,"height",m.height),B.children=[x];var M=o.createCanvas(m.width,m.height),U=M.getContext("2d");return U.fillStyle=a,B.render(U),U.createPattern(M,"no-repeat")}return a}inheritStopContainer(e){this.attributesToInherit.forEach(t=>{!this.getAttribute(t).hasValue()&&e.getAttribute(t).hasValue()&&this.getAttribute(t,!0).setValue(e.getAttribute(t).getValue())})}addParentOpacity(e,t){if(e.hasValue()){var n=new Rr(this.document,"color",t);return n.addOpacity(e).getColor()}return t}}class kD extends YC{constructor(e,t,n){super(e,t,n),this.type="linearGradient",this.attributesToInherit.push("x1","y1","x2","y2")}getGradient(e,t){var n=this.getGradientUnits()==="objectBoundingBox",i=n?t.getBoundingBox(e):null;if(n&&!i)return null;!this.getAttribute("x1").hasValue()&&!this.getAttribute("y1").hasValue()&&!this.getAttribute("x2").hasValue()&&!this.getAttribute("y2").hasValue()&&(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));var s=n?i.x+i.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),a=n?i.y+i.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),o=n?i.x+i.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),A=n?i.y+i.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return s===o&&a===A?null:e.createLinearGradient(s,a,o,A)}}class ND extends YC{constructor(e,t,n){super(e,t,n),this.type="radialGradient",this.attributesToInherit.push("cx","cy","r","fx","fy","fr")}getGradient(e,t){var n=this.getGradientUnits()==="objectBoundingBox",i=t.getBoundingBox(e);if(n&&!i)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");var s=n?i.x+i.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),a=n?i.y+i.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y"),o=s,A=a;this.getAttribute("fx").hasValue()&&(o=n?i.x+i.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(A=n?i.y+i.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));var f=n?(i.width+i.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),m=this.getAttribute("fr").getPixels();return e.createRadialGradient(o,A,m,s,a,f)}}class QD extends yi{constructor(e,t,n){super(e,t,n),this.type="stop";var i=Math.max(0,Math.min(1,this.getAttribute("offset").getNumber())),s=this.getStyle("stop-opacity"),a=this.getStyle("stop-color",!0);a.getString()===""&&a.setValue("#000"),s.hasValue()&&(a=a.addOpacity(s)),this.offset=i,this.color=a.getColor()}}class d_ extends yi{constructor(e,t,n){super(e,t,n),this.type="animate",this.duration=0,this.initialValue=null,this.initialUnits="",this.removed=!1,this.frozen=!1,e.screen.animations.push(this),this.begin=this.getAttribute("begin").getMilliseconds(),this.maxDuration=this.begin+this.getAttribute("dur").getMilliseconds(),this.from=this.getAttribute("from"),this.to=this.getAttribute("to"),this.values=new Rr(e,"values",null);var i=this.getAttribute("values");i.hasValue()&&this.values.setValue(i.getString().split(";"))}getProperty(){var e=this.getAttribute("attributeType").getString(),t=this.getAttribute("attributeName").getString();return e==="CSS"?this.parent.getStyle(t,!0):this.parent.getAttribute(t,!0)}calcValue(){var{initialUnits:e}=this,{progress:t,from:n,to:i}=this.getProgress(),s=n.getNumber()+(i.getNumber()-n.getNumber())*t;return e==="%"&&(s*=100),"".concat(s).concat(e)}update(e){var{parent:t}=this,n=this.getProperty();if(this.initialValue||(this.initialValue=n.getString(),this.initialUnits=n.getUnits()),this.duration>this.maxDuration){var i=this.getAttribute("fill").getString("remove");if(this.getAttribute("repeatCount").getString()==="indefinite"||this.getAttribute("repeatDur").getString()==="indefinite")this.duration=0;else if(i==="freeze"&&!this.frozen)this.frozen=!0,t.animationFrozen=!0,t.animationFrozenValue=n.getString();else if(i==="remove"&&!this.removed)return this.removed=!0,n.setValue(t.animationFrozen?t.animationFrozenValue:this.initialValue),!0;return!1}this.duration+=e;var s=!1;if(this.begin<this.duration){var a=this.calcValue(),o=this.getAttribute("type");if(o.hasValue()){var A=o.getString();a="".concat(A,"(").concat(a,")")}n.setValue(a),s=!0}return s}getProgress(){var{document:e,values:t}=this,n={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(t.hasValue()){var i=n.progress*(t.getValue().length-1),s=Math.floor(i),a=Math.ceil(i);n.from=new Rr(e,"from",parseFloat(t.getValue()[s])),n.to=new Rr(e,"to",parseFloat(t.getValue()[a])),n.progress=(i-s)/(a-s)}else n.from=this.from,n.to=this.to;return n}}class HD extends d_{constructor(){super(...arguments),this.type="animateColor"}calcValue(){var{progress:e,from:t,to:n}=this.getProgress(),i=new MC(t.getColor()),s=new MC(n.getColor());if(i.ok&&s.ok){var a=i.r+(s.r-i.r)*e,o=i.g+(s.g-i.g)*e,A=i.b+(s.b-i.b)*e;return"rgb(".concat(Math.floor(a),", ").concat(Math.floor(o),", ").concat(Math.floor(A),")")}return this.getAttribute("from").getColor()}}class zD extends d_{constructor(){super(...arguments),this.type="animateTransform"}calcValue(){var{progress:e,from:t,to:n}=this.getProgress(),i=fa(t.getString()),s=fa(n.getString()),a=i.map((o,A)=>{var f=s[A];return o+(f-o)*e}).join(" ");return a}}class GD extends yi{constructor(e,t,n){super(e,t,n),this.type="font",this.glyphs={},this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber();var{definitions:i}=e,{children:s}=this;for(var a of s)switch(a.type){case"font-face":{this.fontFace=a;var o=a.getStyle("font-family");o.hasValue()&&(i[o.getString()]=this);break}case"missing-glyph":this.missingGlyph=a;break;case"glyph":{var A=a;A.arabicForm?(this.isRTL=!0,this.isArabic=!0,typeof this.glyphs[A.unicode]>"u"&&(this.glyphs[A.unicode]={}),this.glyphs[A.unicode][A.arabicForm]=A):this.glyphs[A.unicode]=A;break}}}render(){}}class VD extends yi{constructor(e,t,n){super(e,t,n),this.type="font-face",this.ascent=this.getAttribute("ascent").getNumber(),this.descent=this.getAttribute("descent").getNumber(),this.unitsPerEm=this.getAttribute("units-per-em").getNumber()}}class jD extends Kn{constructor(){super(...arguments),this.type="missing-glyph",this.horizAdvX=0}}class qD extends qu{constructor(){super(...arguments),this.type="tref"}getText(){var e=this.getHrefAttribute().getDefinition();if(e){var t=e.children[0];if(t)return t.getText()}return""}}class KD extends qu{constructor(e,t,n){super(e,t,n),this.type="a";var{childNodes:i}=t,s=i[0],a=i.length>0&&Array.from(i).every(o=>o.nodeType===3);this.hasText=a,this.text=a?this.getTextFromNode(s):""}getText(){return this.text}renderChildren(e){if(this.hasText){super.renderChildren(e);var{document:t,x:n,y:i}=this,{mouse:s}=t.screen,a=new Rr(t,"fontSize",_o.parse(t.ctx.font).fontSize);s.isWorking()&&s.checkBoundingBox(this,new dc(n,i-a.getPixels("y"),n+this.measureText(e),i))}else if(this.children.length>0){var o=new h_(this.document,null);o.children=this.children,o.parent=this,o.render(e)}}onClick(){var{window:e}=this.document;e&&e.open(this.getHrefAttribute().getString())}onMouseMove(){var e=this.document.ctx;e.canvas.style.cursor="pointer"}}function WD(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function f_(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?WD(Object(t),!0).forEach(function(n){BC(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):WD(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}class $D extends qu{constructor(e,t,n){super(e,t,n),this.type="textPath",this.textWidth=0,this.textHeight=0,this.pathLength=-1,this.glyphInfo=null,this.letterSpacingCache=[],this.measuresCache=new Map([["",0]]);var i=this.getHrefAttribute().getDefinition();this.text=this.getTextFromNode(),this.dataArray=this.parsePathData(i)}getText(){return this.text}path(e){var{dataArray:t}=this;e&&e.beginPath(),t.forEach(n=>{var{type:i,points:s}=n;switch(i){case rn.LINE_TO:e&&e.lineTo(s[0],s[1]);break;case rn.MOVE_TO:e&&e.moveTo(s[0],s[1]);break;case rn.CURVE_TO:e&&e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case rn.QUAD_TO:e&&e.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case rn.ARC:{var[a,o,A,f,m,v,x,B]=s,M=A>f?A:f,U=A>f?1:A/f,N=A>f?f/A:1;e&&(e.translate(a,o),e.rotate(x),e.scale(U,N),e.arc(0,0,M,m,m+v,!!(1-B)),e.scale(1/U,1/N),e.rotate(-x),e.translate(-a,-o));break}case rn.CLOSE_PATH:e&&e.closePath();break}})}renderChildren(e){this.setTextData(e),e.save();var t=this.parent.getStyle("text-decoration").getString(),n=this.getFontSize(),{glyphInfo:i}=this,s=e.fillStyle;t==="underline"&&e.beginPath(),i.forEach((a,o)=>{var{p0:A,p1:f,rotation:m,text:v}=a;e.save(),e.translate(A.x,A.y),e.rotate(m),e.fillStyle&&e.fillText(v,0,0),e.strokeStyle&&e.strokeText(v,0,0),e.restore(),t==="underline"&&(o===0&&e.moveTo(A.x,A.y+n/8),e.lineTo(f.x,f.y+n/5))}),t==="underline"&&(e.lineWidth=n/20,e.strokeStyle=s,e.stroke(),e.closePath()),e.restore()}getLetterSpacingAt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.letterSpacingCache[e]||0}findSegmentToFitChar(e,t,n,i,s,a,o,A,f){var m=a,v=this.measureText(e,A);A===" "&&t==="justify"&&n<i&&(v+=(i-n)/s),f>-1&&(m+=this.getLetterSpacingAt(f));var x=this.textHeight/20,B=this.getEquidistantPointOnPath(m,x,0),M=this.getEquidistantPointOnPath(m+v,x,0),U={p0:B,p1:M},N=B&&M?Math.atan2(M.y-B.y,M.x-B.x):0;if(o){var Q=Math.cos(Math.PI/2+N)*o,q=Math.cos(-N)*o;U.p0=f_(f_({},B),{},{x:B.x+Q,y:B.y+q}),U.p1=f_(f_({},M),{},{x:M.x+Q,y:M.y+q})}return m+=v,{offset:m,segment:U,rotation:N}}measureText(e,t){var{measuresCache:n}=this,i=t||this.getText();if(n.has(i))return n.get(i);var s=this.measureTargetText(e,i);return n.set(i,s),s}setTextData(e){if(!this.glyphInfo){var t=this.getText(),n=t.split(""),i=t.split(" ").length-1,s=this.parent.getAttribute("dx").split().map(te=>te.getPixels("x")),a=this.parent.getAttribute("dy").getPixels("y"),o=this.parent.getStyle("text-anchor").getString("start"),A=this.getStyle("letter-spacing"),f=this.parent.getStyle("letter-spacing"),m=0;!A.hasValue()||A.getValue()==="inherit"?m=f.getPixels():A.hasValue()&&A.getValue()!=="initial"&&A.getValue()!=="unset"&&(m=A.getPixels());var v=[],x=t.length;this.letterSpacingCache=v;for(var B=0;B<x;B++)v.push(typeof s[B]<"u"?s[B]:m);var M=v.reduce((te,pe,ge)=>ge===0?0:te+pe||0,0),U=this.measureText(e),N=Math.max(U+M,0);this.textWidth=U,this.textHeight=this.getFontSize(),this.glyphInfo=[];var Q=this.getPathLength(),q=this.getStyle("startOffset").getNumber(0)*Q,Y=0;(o==="middle"||o==="center")&&(Y=-N/2),(o==="end"||o==="right")&&(Y=-N),Y+=q,n.forEach((te,pe)=>{var{offset:ge,segment:ye,rotation:fe}=this.findSegmentToFitChar(e,o,N,Q,i,Y,a,te,pe);Y=ge,!(!ye.p0||!ye.p1)&&this.glyphInfo.push({text:n[pe],p0:ye.p0,p1:ye.p1,rotation:fe})})}}parsePathData(e){if(this.pathLength=-1,!e)return[];var t=[],{pathParser:n}=e;for(n.reset();!n.isEnd();){var{current:i}=n,s=i?i.x:0,a=i?i.y:0,o=n.next(),A=o.type,f=[];switch(o.type){case rn.MOVE_TO:this.pathM(n,f);break;case rn.LINE_TO:A=this.pathL(n,f);break;case rn.HORIZ_LINE_TO:A=this.pathH(n,f);break;case rn.VERT_LINE_TO:A=this.pathV(n,f);break;case rn.CURVE_TO:this.pathC(n,f);break;case rn.SMOOTH_CURVE_TO:A=this.pathS(n,f);break;case rn.QUAD_TO:this.pathQ(n,f);break;case rn.SMOOTH_QUAD_TO:A=this.pathT(n,f);break;case rn.ARC:f=this.pathA(n);break;case rn.CLOSE_PATH:Kn.pathZ(n);break}o.type!==rn.CLOSE_PATH?t.push({type:A,points:f,start:{x:s,y:a},pathLength:this.calcLength(s,a,A,f)}):t.push({type:rn.CLOSE_PATH,points:[],pathLength:0})}return t}pathM(e,t){var{x:n,y:i}=Kn.pathM(e).point;t.push(n,i)}pathL(e,t){var{x:n,y:i}=Kn.pathL(e).point;return t.push(n,i),rn.LINE_TO}pathH(e,t){var{x:n,y:i}=Kn.pathH(e).point;return t.push(n,i),rn.LINE_TO}pathV(e,t){var{x:n,y:i}=Kn.pathV(e).point;return t.push(n,i),rn.LINE_TO}pathC(e,t){var{point:n,controlPoint:i,currentPoint:s}=Kn.pathC(e);t.push(n.x,n.y,i.x,i.y,s.x,s.y)}pathS(e,t){var{point:n,controlPoint:i,currentPoint:s}=Kn.pathS(e);return t.push(n.x,n.y,i.x,i.y,s.x,s.y),rn.CURVE_TO}pathQ(e,t){var{controlPoint:n,currentPoint:i}=Kn.pathQ(e);t.push(n.x,n.y,i.x,i.y)}pathT(e,t){var{controlPoint:n,currentPoint:i}=Kn.pathT(e);return t.push(n.x,n.y,i.x,i.y),rn.QUAD_TO}pathA(e){var{rX:t,rY:n,sweepFlag:i,xAxisRotation:s,centp:a,a1:o,ad:A}=Kn.pathA(e);return i===0&&A>0&&(A-=2*Math.PI),i===1&&A<0&&(A+=2*Math.PI),[a.x,a.y,t,n,o,A,s,i]}calcLength(e,t,n,i){var s=0,a=null,o=null,A=0;switch(n){case rn.LINE_TO:return this.getLineLength(e,t,i[0],i[1]);case rn.CURVE_TO:for(s=0,a=this.getPointOnCubicBezier(0,e,t,i[0],i[1],i[2],i[3],i[4],i[5]),A=.01;A<=1;A+=.01)o=this.getPointOnCubicBezier(A,e,t,i[0],i[1],i[2],i[3],i[4],i[5]),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return s;case rn.QUAD_TO:for(s=0,a=this.getPointOnQuadraticBezier(0,e,t,i[0],i[1],i[2],i[3]),A=.01;A<=1;A+=.01)o=this.getPointOnQuadraticBezier(A,e,t,i[0],i[1],i[2],i[3]),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return s;case rn.ARC:{s=0;var f=i[4],m=i[5],v=i[4]+m,x=Math.PI/180;if(Math.abs(f-v)<x&&(x=Math.abs(f-v)),a=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],f,0),m<0)for(A=f-x;A>v;A-=x)o=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],A,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;else for(A=f+x;A<v;A+=x)o=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],A,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return o=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],v,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),s}}return 0}getPointOnLine(e,t,n,i,s){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:t,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:n,A=(s-n)/(i-t+cd),f=Math.sqrt(e*e/(1+A*A));i<t&&(f*=-1);var m=A*f,v=null;if(i===t)v={x:a,y:o+m};else if((o-n)/(a-t+cd)===A)v={x:a+f,y:o+m};else{var x=0,B=0,M=this.getLineLength(t,n,i,s);if(M<cd)return null;var U=(a-t)*(i-t)+(o-n)*(s-n);U/=M*M,x=t+U*(i-t),B=n+U*(s-n);var N=this.getLineLength(a,o,x,B),Q=Math.sqrt(e*e-N*N);f=Math.sqrt(Q*Q/(1+A*A)),i<t&&(f*=-1),m=A*f,v={x:x+f,y:B+m}}return v}getPointOnPath(e){var t=this.getPathLength(),n=0,i=null;if(e<-5e-5||e-5e-5>t)return null;var{dataArray:s}=this;for(var a of s){if(a&&(a.pathLength<5e-5||n+a.pathLength+5e-5<e)){n+=a.pathLength;continue}var o=e-n,A=0;switch(a.type){case rn.LINE_TO:i=this.getPointOnLine(o,a.start.x,a.start.y,a.points[0],a.points[1],a.start.x,a.start.y);break;case rn.ARC:{var f=a.points[4],m=a.points[5],v=a.points[4]+m;if(A=f+o/a.pathLength*m,m<0&&A<v||m>=0&&A>v)break;i=this.getPointOnEllipticalArc(a.points[0],a.points[1],a.points[2],a.points[3],A,a.points[6]);break}case rn.CURVE_TO:A=o/a.pathLength,A>1&&(A=1),i=this.getPointOnCubicBezier(A,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3],a.points[4],a.points[5]);break;case rn.QUAD_TO:A=o/a.pathLength,A>1&&(A=1),i=this.getPointOnQuadraticBezier(A,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3]);break}if(i)return i;break}return null}getLineLength(e,t,n,i){return Math.sqrt((n-e)*(n-e)+(i-t)*(i-t))}getPathLength(){return this.pathLength===-1&&(this.pathLength=this.dataArray.reduce((e,t)=>t.pathLength>0?e+t.pathLength:e,0)),this.pathLength}getPointOnCubicBezier(e,t,n,i,s,a,o,A,f){var m=A*QC(e)+a*HC(e)+i*zC(e)+t*GC(e),v=f*QC(e)+o*HC(e)+s*zC(e)+n*GC(e);return{x:m,y:v}}getPointOnQuadraticBezier(e,t,n,i,s,a,o){var A=a*VC(e)+i*jC(e)+t*qC(e),f=o*VC(e)+s*jC(e)+n*qC(e);return{x:A,y:f}}getPointOnEllipticalArc(e,t,n,i,s,a){var o=Math.cos(a),A=Math.sin(a),f={x:n*Math.cos(s),y:i*Math.sin(s)};return{x:e+(f.x*o-f.y*A),y:t+(f.x*A+f.y*o)}}buildEquidistantCache(e,t){var n=this.getPathLength(),i=t||.25,s=e||n/100;if(!this.equidistantCache||this.equidistantCache.step!==s||this.equidistantCache.precision!==i){this.equidistantCache={step:s,precision:i,points:[]};for(var a=0,o=0;o<=n;o+=i){var A=this.getPointOnPath(o),f=this.getPointOnPath(o+i);!A||!f||(a+=this.getLineLength(A.x,A.y,f.x,f.y),a>=s&&(this.equidistantCache.points.push({x:A.x,y:A.y,distance:o}),a-=s))}}}getEquidistantPointOnPath(e,t,n){if(this.buildEquidistantCache(t,n),e<0||e-this.getPathLength()>5e-5)return null;var i=Math.round(e/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[i]||null}}var z1e=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i;class XD extends ZA{constructor(e,t,n){super(e,t,n),this.type="image",this.loaded=!1;var i=this.getHrefAttribute().getString();if(i){var s=i.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(i);e.images.push(this),s?this.loadSvg(i):this.loadImage(i),this.isSvg=s}}loadImage(e){var t=this;return Gu(function*(){try{var n=yield t.document.createImage(e);t.image=n}catch(i){console.error('Error while loading image "'.concat(e,'":'),i)}t.loaded=!0})()}loadSvg(e){var t=this;return Gu(function*(){var n=z1e.exec(e);if(n){var i=n[5];n[4]==="base64"?t.image=atob(i):t.image=decodeURIComponent(i)}else try{var s=yield t.document.fetch(e),a=yield s.text();t.image=a}catch(o){console.error('Error while loading image "'.concat(e,'":'),o)}t.loaded=!0})()}renderChildren(e){var{document:t,image:n,loaded:i}=this,s=this.getAttribute("x").getPixels("x"),a=this.getAttribute("y").getPixels("y"),o=this.getStyle("width").getPixels("x"),A=this.getStyle("height").getPixels("y");if(!(!i||!n||!o||!A)){if(e.save(),e.translate(s,a),this.isSvg){var f=t.canvg.forkString(e,this.image,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:o,scaleHeight:A});f.document.documentElement.parent=this,f.render()}else{var m=this.image;t.setViewBox({ctx:e,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:o,desiredWidth:m.width,height:A,desiredHeight:m.height}),this.loaded&&(typeof m.complete>"u"||m.complete)&&e.drawImage(m,0,0)}e.restore()}}getBoundingBox(){var e=this.getAttribute("x").getPixels("x"),t=this.getAttribute("y").getPixels("y"),n=this.getStyle("width").getPixels("x"),i=this.getStyle("height").getPixels("y");return new dc(e,t,e+n,t+i)}}class JD extends ZA{constructor(){super(...arguments),this.type="symbol"}render(e){}}class YD{constructor(e){this.document=e,this.loaded=!1,e.fonts.push(this)}load(e,t){var n=this;return Gu(function*(){try{var{document:i}=n,s=yield i.canvg.parser.load(t),a=s.getElementsByTagName("font");Array.from(a).forEach(o=>{var A=i.createElement(o);i.definitions[e]=A})}catch(o){console.error('Error while loading font "'.concat(t,'":'),o)}n.loaded=!0})()}}class ZC extends yi{constructor(e,t,n){super(e,t,n),this.type="style";var i=od(Array.from(t.childNodes).map(a=>a.textContent).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,"")),s=i.split("}");s.forEach(a=>{var o=a.trim();if(o){var A=o.split("{"),f=A[0].split(","),m=A[1].split(";");f.forEach(v=>{var x=v.trim();if(x){var B=e.styles[x]||{};if(m.forEach(N=>{var Q=N.indexOf(":"),q=N.substr(0,Q).trim(),Y=N.substr(Q+1,N.length-Q).trim();q&&Y&&(B[q]=new Rr(e,q,Y))}),e.styles[x]=B,e.stylesSpecificity[x]=vD(x),x==="@font-face"){var M=B["font-family"].getString().replace(/"|'/g,""),U=B.src.getString().split(",");U.forEach(N=>{if(N.indexOf('format("svg")')>0){var Q=DC(N);Q&&new YD(e).load(M,Q)}})}}})}})}}ZC.parseExternalUrl=DC;class ZD extends ZA{constructor(){super(...arguments),this.type="use"}setContext(e){super.setContext(e);var t=this.getAttribute("x"),n=this.getAttribute("y");t.hasValue()&&e.translate(t.getPixels("x"),0),n.hasValue()&&e.translate(0,n.getPixels("y"))}path(e){var{element:t}=this;t&&t.path(e)}renderChildren(e){var{document:t,element:n}=this;if(n){var i=n;if(n.type==="symbol"&&(i=new ip(t,null),i.attributes.viewBox=new Rr(t,"viewBox",n.getAttribute("viewBox").getString()),i.attributes.preserveAspectRatio=new Rr(t,"preserveAspectRatio",n.getAttribute("preserveAspectRatio").getString()),i.attributes.overflow=new Rr(t,"overflow",n.getAttribute("overflow").getString()),i.children=n.children,n.styles.opacity=new Rr(t,"opacity",this.calculateOpacity())),i.type==="svg"){var s=this.getStyle("width",!1,!0),a=this.getStyle("height",!1,!0);s.hasValue()&&(i.attributes.width=new Rr(t,"width",s.getString())),a.hasValue()&&(i.attributes.height=new Rr(t,"height",a.getString()))}var o=i.parent;i.parent=this,i.render(e),i.parent=o}}getBoundingBox(e){var{element:t}=this;return t?t.getBoundingBox(e):null}elementTransform(){var{document:e,element:t}=this;return YA.fromElement(e,t)}get element(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}}function p_(r,e,t,n,i,s){return r[t*n*4+e*4+s]}function g_(r,e,t,n,i,s,a){r[t*n*4+e*4+s]=a}function _s(r,e,t){var n=r[e];return n*t}function Ku(r,e,t,n){return e+Math.cos(r)*t+Math.sin(r)*n}class eE extends yi{constructor(e,t,n){super(e,t,n),this.type="feColorMatrix";var i=fa(this.getAttribute("values").getString());switch(this.getAttribute("type").getString("matrix")){case"saturate":{var s=i[0];i=[.213+.787*s,.715-.715*s,.072-.072*s,0,0,.213-.213*s,.715+.285*s,.072-.072*s,0,0,.213-.213*s,.715-.715*s,.072+.928*s,0,0,0,0,0,1,0,0,0,0,0,1];break}case"hueRotate":{var a=i[0]*Math.PI/180;i=[Ku(a,.213,.787,-.213),Ku(a,.715,-.715,-.715),Ku(a,.072,-.072,.928),0,0,Ku(a,.213,-.213,.143),Ku(a,.715,.285,.14),Ku(a,.072,-.072,-.283),0,0,Ku(a,.213,-.213,-.787),Ku(a,.715,-.715,.715),Ku(a,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break}case"luminanceToAlpha":i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1];break}this.matrix=i,this.includeOpacity=this.getAttribute("includeOpacity").hasValue()}apply(e,t,n,i,s){for(var{includeOpacity:a,matrix:o}=this,A=e.getImageData(0,0,i,s),f=0;f<s;f++)for(var m=0;m<i;m++){var v=p_(A.data,m,f,i,s,0),x=p_(A.data,m,f,i,s,1),B=p_(A.data,m,f,i,s,2),M=p_(A.data,m,f,i,s,3),U=_s(o,0,v)+_s(o,1,x)+_s(o,2,B)+_s(o,3,M)+_s(o,4,1),N=_s(o,5,v)+_s(o,6,x)+_s(o,7,B)+_s(o,8,M)+_s(o,9,1),Q=_s(o,10,v)+_s(o,11,x)+_s(o,12,B)+_s(o,13,M)+_s(o,14,1),q=_s(o,15,v)+_s(o,16,x)+_s(o,17,B)+_s(o,18,M)+_s(o,19,1);a&&(U=0,N=0,Q=0,q*=M/255),g_(A.data,m,f,i,s,0,U),g_(A.data,m,f,i,s,1,N),g_(A.data,m,f,i,s,2,Q),g_(A.data,m,f,i,s,3,q)}e.clearRect(0,0,i,s),e.putImageData(A,0,0)}}class _m extends yi{constructor(){super(...arguments),this.type="mask"}apply(e,t){var{document:n}=this,i=this.getAttribute("x").getPixels("x"),s=this.getAttribute("y").getPixels("y"),a=this.getStyle("width").getPixels("x"),o=this.getStyle("height").getPixels("y");if(!a&&!o){var A=new dc;this.children.forEach(M=>{A.addBoundingBox(M.getBoundingBox(e))}),i=Math.floor(A.x1),s=Math.floor(A.y1),a=Math.floor(A.width),o=Math.floor(A.height)}var f=this.removeStyles(t,_m.ignoreStyles),m=n.createCanvas(i+a,s+o),v=m.getContext("2d");n.screen.setDefaults(v),this.renderChildren(v),new eE(n,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(v,0,0,i+a,s+o);var x=n.createCanvas(i+a,s+o),B=x.getContext("2d");n.screen.setDefaults(B),t.render(B),B.globalCompositeOperation="destination-in",B.fillStyle=v.createPattern(m,"no-repeat"),B.fillRect(0,0,i+a,s+o),e.fillStyle=B.createPattern(x,"no-repeat"),e.fillRect(0,0,i+a,s+o),this.restoreStyles(t,f)}render(e){}}_m.ignoreStyles=["mask","transform","clip-path"];var e6=()=>{};class t6 extends yi{constructor(){super(...arguments),this.type="clipPath"}apply(e){var{document:t}=this,n=Reflect.getPrototypeOf(e),{beginPath:i,closePath:s}=e;n&&(n.beginPath=e6,n.closePath=e6),Reflect.apply(i,e,[]),this.children.forEach(a=>{if(!(typeof a.path>"u")){var o=typeof a.elementTransform<"u"?a.elementTransform():null;o||(o=YA.fromElement(t,a)),o&&o.apply(e),a.path(e),n&&(n.closePath=s),o&&o.unapply(e)}}),Reflect.apply(s,e,[]),e.clip(),n&&(n.beginPath=i,n.closePath=s)}render(e){}}class vm extends yi{constructor(){super(...arguments),this.type="filter"}apply(e,t){var{document:n,children:i}=this,s=t.getBoundingBox(e);if(s){var a=0,o=0;i.forEach(Q=>{var q=Q.extraFilterDistance||0;a=Math.max(a,q),o=Math.max(o,q)});var A=Math.floor(s.width),f=Math.floor(s.height),m=A+2*a,v=f+2*o;if(!(m<1||v<1)){var x=Math.floor(s.x),B=Math.floor(s.y),M=this.removeStyles(t,vm.ignoreStyles),U=n.createCanvas(m,v),N=U.getContext("2d");n.screen.setDefaults(N),N.translate(-x+a,-B+o),t.render(N),i.forEach(Q=>{typeof Q.apply=="function"&&Q.apply(N,0,0,m,v)}),e.drawImage(U,0,0,m,v,x-a,B-o,m,v),this.restoreStyles(t,M)}}}render(e){}}vm.ignoreStyles=["filter","transform","clip-path"];class r6 extends yi{constructor(e,t,n){super(e,t,n),this.type="feDropShadow",this.addStylesFromStyleDefinition()}apply(e,t,n,i,s){}}class n6 extends yi{constructor(){super(...arguments),this.type="feMorphology"}apply(e,t,n,i,s){}}class i6 extends yi{constructor(){super(...arguments),this.type="feComposite"}apply(e,t,n,i,s){}}class s6 extends yi{constructor(e,t,n){super(e,t,n),this.type="feGaussianBlur",this.blurRadius=Math.floor(this.getAttribute("stdDeviation").getNumber()),this.extraFilterDistance=this.blurRadius}apply(e,t,n,i,s){var{document:a,blurRadius:o}=this,A=a.window?a.window.document.body:null,f=e.canvas;f.id=a.getUniqueId(),A&&(f.style.display="none",A.appendChild(f)),v1e(f,t,n,i,s,o),A&&A.removeChild(f)}}class o6 extends yi{constructor(){super(...arguments),this.type="title"}}class a6 extends yi{constructor(){super(...arguments),this.type="desc"}}var G1e={svg:ip,rect:XC,circle:FD,ellipse:MD,line:PD,polyline:JC,polygon:UD,path:Kn,pattern:RD,marker:OD,defs:DD,linearGradient:kD,radialGradient:ND,stop:QD,animate:d_,animateColor:HD,animateTransform:zD,font:GD,"font-face":VD,"missing-glyph":jD,glyph:$C,text:qu,tspan:ym,tref:qD,a:KD,textPath:$D,image:XD,g:h_,symbol:JD,style:ZC,use:ZD,mask:_m,clipPath:t6,filter:vm,feDropShadow:r6,feMorphology:n6,feComposite:i6,feColorMatrix:eE,feGaussianBlur:s6,title:o6,desc:a6};function c6(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function V1e(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?c6(Object(t),!0).forEach(function(n){BC(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):c6(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function j1e(r,e){var t=document.createElement("canvas");return t.width=r,t.height=e,t}function q1e(r){return tE.apply(this,arguments)}function tE(){return tE=Gu(function*(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=document.createElement("img");return e&&(t.crossOrigin="Anonymous"),new Promise((n,i)=>{t.onload=()=>{n(t)},t.onerror=(s,a,o,A,f)=>{i(f)},t.src=r})}),tE.apply(this,arguments)}class Wu{constructor(e){var{rootEmSize:t=12,emSize:n=12,createCanvas:i=Wu.createCanvas,createImage:s=Wu.createImage,anonymousCrossOrigin:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.canvg=e,this.definitions={},this.styles={},this.stylesSpecificity={},this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=e.screen,this.rootEmSize=t,this.emSize=n,this.createCanvas=i,this.createImage=this.bindCreateImage(s,a),this.screen.wait(this.isImagesLoaded.bind(this)),this.screen.wait(this.isFontsLoaded.bind(this))}bindCreateImage(e,t){return typeof t=="boolean"?(n,i)=>e(n,typeof i=="boolean"?i:t):e}get window(){return this.screen.window}get fetch(){return this.screen.fetch}get ctx(){return this.screen.ctx}get emSize(){var{emSizeStack:e}=this;return e[e.length-1]}set emSize(e){var{emSizeStack:t}=this;t.push(e)}popEmSize(){var{emSizeStack:e}=this;e.pop()}getUniqueId(){return"canvg".concat(++this.uniqueId)}isImagesLoaded(){return this.images.every(e=>e.loaded)}isFontsLoaded(){return this.fonts.every(e=>e.loaded)}createDocumentElement(e){var t=this.createElement(e.documentElement);return t.root=!0,t.addStylesFromStyleDefinition(),this.documentElement=t,t}createElement(e){var t=e.nodeName.replace(/^[^:]+:/,""),n=Wu.elementTypes[t];return typeof n<"u"?new n(this,e):new LD(this,e)}createTextNode(e){return new H1e(this,e)}setViewBox(e){this.screen.setViewBox(V1e({document:this},e))}}Wu.createCanvas=j1e,Wu.createImage=q1e,Wu.elementTypes=G1e;function l6(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function ld(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?l6(Object(t),!0).forEach(function(n){BC(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):l6(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}class ud{constructor(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.parser=new A_(n),this.screen=new mm(e,n),this.options=n;var i=new Wu(this,n),s=i.createDocumentElement(t);this.document=i,this.documentElement=s}static from(e,t){var n=arguments;return Gu(function*(){var i=n.length>2&&n[2]!==void 0?n[2]:{},s=new A_(i),a=yield s.parse(t);return new ud(e,a,i)})()}static fromString(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=new A_(n),s=i.parseFromString(t);return new ud(e,s,n)}fork(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return ud.from(e,t,ld(ld({},this.options),n))}forkString(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return ud.fromString(e,t,ld(ld({},this.options),n))}ready(){return this.screen.ready()}isReady(){return this.screen.isReady()}render(){var e=arguments,t=this;return Gu(function*(){var n=e.length>0&&e[0]!==void 0?e[0]:{};t.start(ld({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0},n)),yield t.ready(),t.stop()})()}start(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{documentElement:t,screen:n,options:i}=this;n.start(t,ld(ld({enableRedraw:!0},i),e))}stop(){this.screen.stop()}resize(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.documentElement.resize(e,t,n)}}const K1e=Object.freeze(Object.defineProperty({__proto__:null,AElement:KD,AnimateColorElement:HD,AnimateElement:d_,AnimateTransformElement:zD,BoundingBox:dc,CB1:QC,CB2:HC,CB3:zC,CB4:GC,Canvg:ud,CircleElement:FD,ClipPathElement:t6,DefsElement:DD,DescElement:a6,Document:Wu,Element:yi,EllipseElement:MD,FeColorMatrixElement:eE,FeCompositeElement:i6,FeDropShadowElement:r6,FeGaussianBlurElement:s6,FeMorphologyElement:n6,FilterElement:vm,Font:_o,FontElement:GD,FontFaceElement:VD,GElement:h_,GlyphElement:$C,GradientElement:YC,ImageElement:XD,LineElement:PD,LinearGradientElement:kD,MarkerElement:OD,MaskElement:_m,Matrix:KC,MissingGlyphElement:jD,Mouse:wD,PSEUDO_ZERO:cd,Parser:A_,PathElement:Kn,PathParser:rn,PatternElement:RD,Point:ji,PolygonElement:UD,PolylineElement:JC,Property:Rr,QB1:VC,QB2:jC,QB3:qC,RadialGradientElement:ND,RectElement:XC,RenderedElement:ZA,Rotate:ED,SVGElement:ip,SVGFontLoader:YD,Scale:SD,Screen:mm,Skew:WC,SkewX:TD,SkewY:ID,StopElement:QD,StyleElement:ZC,SymbolElement:JD,TRefElement:qD,TSpanElement:ym,TextElement:qu,TextPathElement:$D,TitleElement:o6,Transform:YA,Translate:CD,UnknownElement:LD,UseElement:ZD,ViewPort:bD,compressSpaces:od,default:ud,getSelectorSpecificity:vD,normalizeAttributeName:yD,normalizeColor:_D,parseExternalUrl:DC,presets:B1e,toNumbers:fa,trimLeft:gD,trimRight:mD,vectorMagnitude:kC,vectorsAngle:NC,vectorsRatio:u_},Symbol.toStringTag,{value:"Module"}));Rl.CompareMaps=Jre,Rl.Layers=Ti,Rl.Map=jre,Rl.Styles=Sf,Rl.Terrains=xy,Object.defineProperty(Rl,Symbol.toStringTag,{value:"Module"})});
