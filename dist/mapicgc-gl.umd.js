(function(Ul,wp){typeof exports=="object"&&typeof module<"u"?wp(exports):typeof define=="function"&&define.amd?define(["exports"],wp):(Ul=typeof globalThis<"u"?globalThis:Ul||self,wp(Ul.mapicgcgl={}))})(this,function(Ul){"use strict";function wp(r,t){for(var e=0;e<t.length;e++){const n=t[e];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in r)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(r,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}var Ld=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xp(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var HE={exports:{}};(function(r,t){(function(e,n){r.exports=n()})(Ld,function(){var e={},n={};function i(a,o,A){if(n[a]=A,a==="index"){var f="var sharedModule = {}; ("+n.shared+")(sharedModule); ("+n.worker+")(sharedModule);",m={};return n.shared(m),n.index(e,m),typeof window<"u"&&e.setWorkerUrl(window.URL.createObjectURL(new Blob([f],{type:"text/javascript"}))),e}}i("shared",["exports"],function(a){function o(u,c,h,p){return new(h||(h=Promise))(function(v,S){function I(G){try{O(p.next(G))}catch(K){S(K)}}function F(G){try{O(p.throw(G))}catch(K){S(K)}}function O(G){var K;G.done?v(G.value):(K=G.value,K instanceof h?K:new h(function(X){X(K)})).then(I,F)}O((p=p.apply(u,c||[])).next())})}function A(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}typeof SuppressedError=="function"&&SuppressedError;var f=m;function m(u,c){this.x=u,this.y=c}m.prototype={clone:function(){return new m(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,c){return this.clone()._rotateAround(u,c)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var c=u.x-this.x,h=u.y-this.y;return c*c+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,c){return Math.atan2(this.x*c-this.y*u,this.x*u+this.y*c)},_matMult:function(u){var c=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=c,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var c=Math.cos(u),h=Math.sin(u),p=h*this.x+c*this.y;return this.x=c*this.x-h*this.y,this.y=p,this},_rotateAround:function(u,c){var h=Math.cos(u),p=Math.sin(u),v=c.y+p*(this.x-c.x)+h*(this.y-c.y);return this.x=c.x+h*(this.x-c.x)-p*(this.y-c.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},m.convert=function(u){return u instanceof m?u:Array.isArray(u)?new m(u[0],u[1]):u};var b=A(f),x=C;function C(u,c,h,p){this.cx=3*u,this.bx=3*(h-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(p-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=c,this.p2x=h,this.p2y=p}C.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,c){if(c===void 0&&(c=1e-6),u<0)return 0;if(u>1)return 1;for(var h=u,p=0;p<8;p++){var v=this.sampleCurveX(h)-u;if(Math.abs(v)<c)return h;var S=this.sampleCurveDerivativeX(h);if(Math.abs(S)<1e-6)break;h-=v/S}var I=0,F=1;for(h=u,p=0;p<20&&(v=this.sampleCurveX(h),!(Math.abs(v-u)<c));p++)u>v?I=h:F=h,h=.5*(F-I)+I;return h},solve:function(u,c){return this.sampleCurveY(this.solveCurveX(u,c))}};var M=A(x);let U,N;function Q(){return U==null&&(U=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),U}function q(){if(N==null&&(N=!1,Q())){const c=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(c){for(let p=0;p<5*5;p++){const v=4*p;c.fillStyle=`rgb(${v},${v+1},${v+2})`,c.fillRect(p%5,Math.floor(p/5),1,1)}const h=c.getImageData(0,0,5,5).data;for(let p=0;p<5*5*4;p++)if(p%4!=3&&h[p]!==p){N=!0;break}}}return N||!1}function Y(u,c,h,p){const v=new M(u,c,h,p);return function(S){return v.solve(S)}}const tt=Y(.25,.1,.25,1);function ft(u,c,h){return Math.min(h,Math.max(c,u))}function pt(u,c,h){const p=h-c,v=((u-c)%p+p)%p+c;return v===c?h:v}function mt(u){for(var c=arguments.length,h=new Array(c>1?c-1:0),p=1;p<c;p++)h[p-1]=arguments[p];for(const v of h)for(const S in v)u[S]=v[S];return u}let dt=1;function Rt(u,c,h){const p={};for(const v in u)p[v]=c.call(h||this,u[v],v,u);return p}function Lt(u,c,h){const p={};for(const v in u)c.call(h||this,u[v],v,u)&&(p[v]=u[v]);return p}function st(u){return Array.isArray(u)?u.map(st):typeof u=="object"&&u?Rt(u,st):u}const ct={};function wt(u){ct[u]||(typeof console<"u"&&console.warn(u),ct[u]=!0)}function yt(u,c,h){return(h.y-u.y)*(c.x-u.x)>(c.y-u.y)*(h.x-u.x)}function te(u){let c=0;for(let h,p,v=0,S=u.length,I=S-1;v<S;I=v++)h=u[v],p=u[I],c+=(p.x-h.x)*(h.y+p.y);return c}function Zt(u){return typeof WorkerGlobalScope<"u"&&u!==void 0&&u instanceof WorkerGlobalScope}let re=null;function Xt(u){return typeof ImageBitmap<"u"&&u instanceof ImageBitmap}const ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function se(u,c,h,p,v){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const S=new VideoFrame(u,{timestamp:0});try{const I=S==null?void 0:S.format;if(!I||!I.startsWith("BGR")&&!I.startsWith("RGB"))throw new Error(`Unrecognized format ${I}`);const F=I.startsWith("BGR"),O=new Uint8ClampedArray(p*v*4);if(yield S.copyTo(O,function(G,K,X,nt,at){const ut=4*Math.max(-K,0),Bt=(Math.max(0,X)-X)*nt*4+ut,It=4*nt,kt=Math.max(0,K),ee=Math.max(0,X);return{rect:{x:kt,y:ee,width:Math.min(G.width,K+nt)-kt,height:Math.min(G.height,X+at)-ee},layout:[{offset:Bt,stride:It}]}}(u,c,h,p,v)),F)for(let G=0;G<O.length;G+=4){const K=O[G];O[G]=O[G+2],O[G+2]=K}return O}finally{S.close()}})}let we,it;const vt="AbortError";function Ft(){return new Error(vt)}const Ot={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Wt(u){return Ot.REGISTERED_PROTOCOLS[u.substring(0,u.indexOf("://"))]}const jt="global-dispatcher";class ae extends Error{constructor(c,h,p,v){super(`AJAXError: ${h} (${c}): ${p}`),this.status=c,this.statusText=h,this.url=p,this.body=v}}const ie=()=>Zt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Be=function(u,c){if(/:\/\//.test(u.url)&&!/^https?:|^file:/.test(u.url)){const p=Wt(u.url);if(p)return p(u,c);if(Zt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:u,targetMapId:jt},c)}if(!(/^file:/.test(h=u.url)||/^file:/.test(ie())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(p,v){return o(this,void 0,void 0,function*(){const S=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,cache:p.cache,referrer:ie(),signal:v.signal});p.type==="json"&&S.headers.set("Accept","application/json");const I=yield fetch(S);if(!I.ok){const G=yield I.blob();throw new ae(I.status,I.statusText,p.url,G)}let F;F=p.type==="arrayBuffer"||p.type==="image"?I.arrayBuffer():p.type==="json"?I.json():I.text();const O=yield F;if(v.signal.aborted)throw Ft();return{data:O,cacheControl:I.headers.get("Cache-Control"),expires:I.headers.get("Expires")}})}(u,c);if(Zt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:u,mustQueue:!0,targetMapId:jt},c)}var h;return function(p,v){return new Promise((S,I)=>{const F=new XMLHttpRequest;F.open(p.method||"GET",p.url,!0),p.type!=="arrayBuffer"&&p.type!=="image"||(F.responseType="arraybuffer");for(const O in p.headers)F.setRequestHeader(O,p.headers[O]);p.type==="json"&&(F.responseType="text",F.setRequestHeader("Accept","application/json")),F.withCredentials=p.credentials==="include",F.onerror=()=>{I(new Error(F.statusText))},F.onload=()=>{if(!v.signal.aborted)if((F.status>=200&&F.status<300||F.status===0)&&F.response!==null){let O=F.response;if(p.type==="json")try{O=JSON.parse(F.response)}catch(G){return void I(G)}S({data:O,cacheControl:F.getResponseHeader("Cache-Control"),expires:F.getResponseHeader("Expires")})}else{const O=new Blob([F.response],{type:F.getResponseHeader("Content-Type")});I(new ae(F.status,F.statusText,p.url,O))}},v.signal.addEventListener("abort",()=>{F.abort(),I(Ft())}),F.send(p.body)})}(u,c)};function Te(u){if(!u||u.indexOf("://")<=0||u.indexOf("data:image/")===0||u.indexOf("blob:")===0)return!0;const c=new URL(u),h=window.location;return c.protocol===h.protocol&&c.host===h.host}function Ne(u,c,h){h[u]&&h[u].indexOf(c)!==-1||(h[u]=h[u]||[],h[u].push(c))}function Qe(u,c,h){if(h&&h[u]){const p=h[u].indexOf(c);p!==-1&&h[u].splice(p,1)}}class He{constructor(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};mt(this,h),this.type=c}}class ge extends He{constructor(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super("error",mt({error:c},h))}}class Ut{on(c,h){return this._listeners=this._listeners||{},Ne(c,h,this._listeners),this}off(c,h){return Qe(c,h,this._listeners),Qe(c,h,this._oneTimeListeners),this}once(c,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},Ne(c,h,this._oneTimeListeners),this):new Promise(p=>this.once(c,p))}fire(c,h){typeof c=="string"&&(c=new He(c,h||{}));const p=c.type;if(this.listens(p)){c.target=this;const v=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const F of v)F.call(this,c);const S=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const F of S)Qe(p,F,this._oneTimeListeners),F.call(this,c);const I=this._eventedParent;I&&(mt(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),I.fire(c))}else c instanceof ge&&console.error(c.error);return this}listens(c){return this._listeners&&this._listeners[c]&&this._listeners[c].length>0||this._oneTimeListeners&&this._oneTimeListeners[c]&&this._oneTimeListeners[c].length>0||this._eventedParent&&this._eventedParent.listens(c)}setEventedParent(c,h){return this._eventedParent=c,this._eventedParentData=h,this}}var Yt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const tr=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ee(u,c){const h={};for(const p in u)p!=="ref"&&(h[p]=u[p]);return tr.forEach(p=>{p in c&&(h[p]=c[p])}),h}function _e(u,c){if(Array.isArray(u)){if(!Array.isArray(c)||u.length!==c.length)return!1;for(let h=0;h<u.length;h++)if(!_e(u[h],c[h]))return!1;return!0}if(typeof u=="object"&&u!==null&&c!==null){if(typeof c!="object"||Object.keys(u).length!==Object.keys(c).length)return!1;for(const h in u)if(!_e(u[h],c[h]))return!1;return!0}return u===c}function xe(u,c){u.push(c)}function De(u,c,h){xe(h,{command:"addSource",args:[u,c[u]]})}function nr(u,c,h){xe(c,{command:"removeSource",args:[u]}),h[u]=!0}function ur(u,c,h,p){nr(u,h,p),De(u,c,h)}function Ir(u,c,h){let p;for(p in u[h])if(Object.prototype.hasOwnProperty.call(u[h],p)&&p!=="data"&&!_e(u[h][p],c[h][p]))return!1;for(p in c[h])if(Object.prototype.hasOwnProperty.call(c[h],p)&&p!=="data"&&!_e(u[h][p],c[h][p]))return!1;return!0}function Sr(u,c,h,p,v,S){u=u||{},c=c||{};for(const I in u)Object.prototype.hasOwnProperty.call(u,I)&&(_e(u[I],c[I])||h.push({command:S,args:[p,I,c[I],v]}));for(const I in c)Object.prototype.hasOwnProperty.call(c,I)&&!Object.prototype.hasOwnProperty.call(u,I)&&(_e(u[I],c[I])||h.push({command:S,args:[p,I,c[I],v]}))}function Dr(u){return u.id}function Nr(u,c){return u[c.id]=c,u}class fe{constructor(c,h,p,v){this.message=(c?`${c}: `:"")+p,v&&(this.identifier=v),h!=null&&h.__line__&&(this.line=h.__line__)}}function Tr(u){for(var c=arguments.length,h=new Array(c>1?c-1:0),p=1;p<c;p++)h[p-1]=arguments[p];for(const v of h)for(const S in v)u[S]=v[S];return u}class Oe extends Error{constructor(c,h){super(h),this.message=h,this.key=c}}class wn{constructor(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.parent=c,this.bindings={};for(const[p,v]of h)this.bindings[p]=v}concat(c){return new wn(this,c)}get(c){if(this.bindings[c])return this.bindings[c];if(this.parent)return this.parent.get(c);throw new Error(`${c} not found in scope.`)}has(c){return!!this.bindings[c]||!!this.parent&&this.parent.has(c)}}const Fr={kind:"null"},Se={kind:"number"},Xe={kind:"string"},qe={kind:"boolean"},Yr={kind:"color"},Rr={kind:"object"},pr={kind:"value"},on={kind:"collator"},Kr={kind:"formatted"},Ct={kind:"padding"},Z={kind:"resolvedImage"},J={kind:"variableAnchorOffsetCollection"};function ot(u,c){return{kind:"array",itemType:u,N:c}}function Et(u){if(u.kind==="array"){const c=Et(u.itemType);return typeof u.N=="number"?`array<${c}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${c}>`}return u.kind}const Nt=[Fr,Se,Xe,qe,Yr,Kr,Rr,ot(pr),Ct,Z,J];function zt(u,c){if(c.kind==="error")return null;if(u.kind==="array"){if(c.kind==="array"&&(c.N===0&&c.itemType.kind==="value"||!zt(u.itemType,c.itemType))&&(typeof u.N!="number"||u.N===c.N))return null}else{if(u.kind===c.kind)return null;if(u.kind==="value"){for(const h of Nt)if(!zt(h,c))return null}}return`Expected ${Et(u)} but found ${Et(c)} instead.`}function qt(u,c){return c.some(h=>h.kind===u.kind)}function St(u,c){return c.some(h=>h==="null"?u===null:h==="array"?Array.isArray(u):h==="object"?u&&!Array.isArray(u)&&typeof u=="object":h===typeof u)}function Jt(u,c){return u.kind==="array"&&c.kind==="array"?u.itemType.kind===c.itemType.kind&&typeof u.N=="number":u.kind===c.kind}const me=.96422,pe=.82521,de=4/29,Ge=6/29,Ye=3*Ge*Ge,Cr=Ge*Ge*Ge,cr=Math.PI/180,Pr=180/Math.PI;function kr(u){return(u%=360)<0&&(u+=360),u}function Qr(u){let[c,h,p,v]=u,S,I;const F=gr((.2225045*(c=gn(c))+.7168786*(h=gn(h))+.0606169*(p=gn(p)))/1);c===h&&h===p?S=I=F:(S=gr((.4360747*c+.3850649*h+.1430804*p)/me),I=gr((.0139322*c+.0971045*h+.7141733*p)/pe));const O=116*F-16;return[O<0?0:O,500*(S-F),200*(F-I),v]}function gn(u){return u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function gr(u){return u>Cr?Math.pow(u,1/3):u/Ye+de}function Wr(u){let[c,h,p,v]=u,S=(c+16)/116,I=isNaN(h)?S:S+h/500,F=isNaN(p)?S:S-p/200;return S=1*Dn(S),I=me*Dn(I),F=pe*Dn(F),[vn(3.1338561*I-1.6168667*S-.4906146*F),vn(-.9787684*I+1.9161415*S+.033454*F),vn(.0719453*I-.2289914*S+1.4052427*F),v]}function vn(u){return(u=u<=.00304?12.92*u:1.055*Math.pow(u,1/2.4)-.055)<0?0:u>1?1:u}function Dn(u){return u>Ge?u*u*u:Ye*(u-de)}function Dt(u){return parseInt(u.padEnd(2,u),16)/255}function Ue(u,c){return Ie(c?u/100:u,0,1)}function Ie(u,c,h){return Math.min(Math.max(c,u),h)}function rn(u){return!u.some(Number.isNaN)}const Mn={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class xr{constructor(c,h,p){let v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;this.r=c,this.g=h,this.b=p,this.a=v,S||(this.r*=v,this.g*=v,this.b*=v,v||this.overwriteGetter("rgb",[c,h,p,v]))}static parse(c){if(c instanceof xr)return c;if(typeof c!="string")return;const h=function(p){if((p=p.toLowerCase().trim())==="transparent")return[0,0,0,0];const v=Mn[p];if(v){const[I,F,O]=v;return[I/255,F/255,O/255,1]}if(p.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(p)){const I=p.length<6?1:2;let F=1;return[Dt(p.slice(F,F+=I)),Dt(p.slice(F,F+=I)),Dt(p.slice(F,F+=I)),Dt(p.slice(F,F+I)||"ff")]}if(p.startsWith("rgb")){const I=p.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(I){const[F,O,G,K,X,nt,at,ut,Bt,It,kt,ee]=I,Ht=[K||" ",at||" ",It].join("");if(Ht==="  "||Ht==="  /"||Ht===",,"||Ht===",,,"){const Kt=[G,nt,Bt].join(""),ve=Kt==="%%%"?100:Kt===""?255:0;if(ve){const be=[Ie(+O/ve,0,1),Ie(+X/ve,0,1),Ie(+ut/ve,0,1),kt?Ue(+kt,ee):1];if(rn(be))return be}}return}}const S=p.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(S){const[I,F,O,G,K,X,nt,at,ut]=S,Bt=[O||" ",K||" ",nt].join("");if(Bt==="  "||Bt==="  /"||Bt===",,"||Bt===",,,"){const It=[+F,Ie(+G,0,100),Ie(+X,0,100),at?Ue(+at,ut):1];if(rn(It))return function(kt){let[ee,Ht,Kt,ve]=kt;function be(Je){const Ar=(Je+ee/30)%12,$e=Ht*Math.min(Kt,1-Kt);return Kt-$e*Math.max(-1,Math.min(Ar-3,9-Ar,1))}return ee=kr(ee),Ht/=100,Kt/=100,[be(0),be(8),be(4),ve]}(It)}}}(c);return h?new xr(...h,!1):void 0}get rgb(){const{r:c,g:h,b:p,a:v}=this,S=v||1/0;return this.overwriteGetter("rgb",[c/S,h/S,p/S,v])}get hcl(){return this.overwriteGetter("hcl",function(c){const[h,p,v,S]=Qr(c),I=Math.sqrt(p*p+v*v);return[Math.round(1e4*I)?kr(Math.atan2(v,p)*Pr):NaN,I,h,S]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Qr(this.rgb))}overwriteGetter(c,h){return Object.defineProperty(this,c,{value:h}),h}toString(){const[c,h,p,v]=this.rgb;return`rgba(${[c,h,p].map(S=>Math.round(255*S)).join(",")},${v})`}}xr.black=new xr(0,0,0,1),xr.white=new xr(1,1,1,1),xr.transparent=new xr(0,0,0,0),xr.red=new xr(1,0,0,1);class mn{constructor(c,h,p){this.sensitivity=c?h?"variant":"case":h?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(c,h){return this.collator.compare(c,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class bi{constructor(c,h,p,v,S){this.text=c,this.image=h,this.scale=p,this.fontStack=v,this.textColor=S}}class yn{constructor(c){this.sections=c}static fromString(c){return new yn([new bi(c,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(c=>c.text.length!==0||c.image&&c.image.name.length!==0)}static factory(c){return c instanceof yn?c:yn.fromString(c)}toString(){return this.sections.length===0?"":this.sections.map(c=>c.text).join("")}}class nn{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof nn)return c;if(typeof c=="number")return new nn([c,c,c,c]);if(Array.isArray(c)&&!(c.length<1||c.length>4)){for(const h of c)if(typeof h!="number")return;switch(c.length){case 1:c=[c[0],c[0],c[0],c[0]];break;case 2:c=[c[0],c[1],c[0],c[1]];break;case 3:c=[c[0],c[1],c[2],c[1]]}return new nn(c)}}toString(){return JSON.stringify(this.values)}}const wi=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Xn{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof Xn)return c;if(Array.isArray(c)&&!(c.length<1)&&c.length%2==0){for(let h=0;h<c.length;h+=2){const p=c[h],v=c[h+1];if(typeof p!="string"||!wi.has(p)||!Array.isArray(v)||v.length!==2||typeof v[0]!="number"||typeof v[1]!="number")return}return new Xn(c)}}toString(){return JSON.stringify(this.values)}}class os{constructor(c){this.name=c.name,this.available=c.available}toString(){return this.name}static fromString(c){return c?new os({name:c,available:!1}):null}}function Rs(u,c,h,p){return typeof u=="number"&&u>=0&&u<=255&&typeof c=="number"&&c>=0&&c<=255&&typeof h=="number"&&h>=0&&h<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[u,c,h,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[u,c,h,p]:[u,c,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ho(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof xr||u instanceof mn||u instanceof yn||u instanceof nn||u instanceof Xn||u instanceof os)return!0;if(Array.isArray(u)){for(const c of u)if(!Ho(c))return!1;return!0}if(typeof u=="object"){for(const c in u)if(!Ho(u[c]))return!1;return!0}return!1}function Or(u){if(u===null)return Fr;if(typeof u=="string")return Xe;if(typeof u=="boolean")return qe;if(typeof u=="number")return Se;if(u instanceof xr)return Yr;if(u instanceof mn)return on;if(u instanceof yn)return Kr;if(u instanceof nn)return Ct;if(u instanceof Xn)return J;if(u instanceof os)return Z;if(Array.isArray(u)){const c=u.length;let h;for(const p of u){const v=Or(p);if(h){if(h===v)continue;h=pr;break}h=v}return ot(h||pr,c)}return Rr}function Xs(u){const c=typeof u;return u===null?"":c==="string"||c==="number"||c==="boolean"?String(u):u instanceof xr||u instanceof yn||u instanceof nn||u instanceof Xn||u instanceof os?u.toString():JSON.stringify(u)}class Bs{constructor(c,h){this.type=c,this.value=h}static parse(c,h){if(c.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${c.length-1} instead.`);if(!Ho(c[1]))return h.error("invalid value");const p=c[1];let v=Or(p);const S=h.expectedType;return v.kind!=="array"||v.N!==0||!S||S.kind!=="array"||typeof S.N=="number"&&S.N!==0||(v=S),new Bs(v,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Tn{constructor(c){this.name="ExpressionEvaluationError",this.message=c}toJSON(){return this.message}}const _o={string:Xe,number:Se,boolean:qe,object:Rr};class Fi{constructor(c,h){this.type=c,this.args=h}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");let p,v=1;const S=c[0];if(S==="array"){let F,O;if(c.length>2){const G=c[1];if(typeof G!="string"||!(G in _o)||G==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);F=_o[G],v++}else F=pr;if(c.length>3){if(c[2]!==null&&(typeof c[2]!="number"||c[2]<0||c[2]!==Math.floor(c[2])))return h.error('The length argument to "array" must be a positive integer literal',2);O=c[2],v++}p=ot(F,O)}else{if(!_o[S])throw new Error(`Types doesn't contain name = ${S}`);p=_o[S]}const I=[];for(;v<c.length;v++){const F=h.parse(c[v],v,pr);if(!F)return null;I.push(F)}return new Fi(p,I)}evaluate(c){for(let h=0;h<this.args.length;h++){const p=this.args[h].evaluate(c);if(!zt(this.type,Or(p)))return p;if(h===this.args.length-1)throw new Tn(`Expected value to be of type ${Et(this.type)}, but found ${Et(Or(p))} instead.`)}throw new Error}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}const Mi={"to-boolean":qe,"to-color":Yr,"to-number":Se,"to-string":Xe};class Yn{constructor(c,h){this.type=c,this.args=h}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");const p=c[0];if(!Mi[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p==="to-boolean"||p==="to-string")&&c.length!==2)return h.error("Expected one argument.");const v=Mi[p],S=[];for(let I=1;I<c.length;I++){const F=h.parse(c[I],I,pr);if(!F)return null;S.push(F)}return new Yn(v,S)}evaluate(c){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(c);case"color":{let h,p;for(const v of this.args){if(h=v.evaluate(c),p=null,h instanceof xr)return h;if(typeof h=="string"){const S=c.parseColor(h);if(S)return S}else if(Array.isArray(h)&&(p=h.length<3||h.length>4?`Invalid rbga value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:Rs(h[0],h[1],h[2],h[3]),!p))return new xr(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new Tn(p||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const p of this.args){h=p.evaluate(c);const v=nn.parse(h);if(v)return v}throw new Tn(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const p of this.args){h=p.evaluate(c);const v=Xn.parse(h);if(v)return v}throw new Tn(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const p of this.args){if(h=p.evaluate(c),h===null)return 0;const v=Number(h);if(!isNaN(v))return v}throw new Tn(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return yn.fromString(Xs(this.args[0].evaluate(c)));case"resolvedImage":return os.fromString(Xs(this.args[0].evaluate(c)));default:return Xs(this.args[0].evaluate(c))}}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}const Ti=["Unknown","Point","LineString","Polygon"];class an{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ti[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(c){let h=this._parseColorCache[c];return h||(h=this._parseColorCache[c]=xr.parse(c)),h}}class zo{constructor(c,h){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=arguments.length>3?arguments[3]:void 0,S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:new wn,I=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[];this.registry=c,this.path=p,this.key=p.map(F=>`[${F}]`).join(""),this.scope=S,this.errors=I,this.expectedType=v,this._isConstant=h}parse(c,h,p,v){let S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};return h?this.concat(h,p,v)._parse(c,S):this._parse(c,S)}_parse(c,h){function p(v,S,I){return I==="assert"?new Fi(S,[v]):I==="coerce"?new Yn(S,[v]):v}if(c!==null&&typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"||(c=["literal",c]),Array.isArray(c)){if(c.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const v=c[0];if(typeof v!="string")return this.error(`Expression name must be a string, but found ${typeof v} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const S=this.registry[v];if(S){let I=S.parse(c,this);if(!I)return null;if(this.expectedType){const F=this.expectedType,O=I.type;if(F.kind!=="string"&&F.kind!=="number"&&F.kind!=="boolean"&&F.kind!=="object"&&F.kind!=="array"||O.kind!=="value")if(F.kind!=="color"&&F.kind!=="formatted"&&F.kind!=="resolvedImage"||O.kind!=="value"&&O.kind!=="string")if(F.kind!=="padding"||O.kind!=="value"&&O.kind!=="number"&&O.kind!=="array")if(F.kind!=="variableAnchorOffsetCollection"||O.kind!=="value"&&O.kind!=="array"){if(this.checkSubtype(F,O))return null}else I=p(I,F,h.typeAnnotation||"coerce");else I=p(I,F,h.typeAnnotation||"coerce");else I=p(I,F,h.typeAnnotation||"coerce");else I=p(I,F,h.typeAnnotation||"assert")}if(!(I instanceof Bs)&&I.type.kind!=="resolvedImage"&&this._isConstant(I)){const F=new an;try{I=new Bs(I.type,I.evaluate(F))}catch(O){return this.error(O.message),null}}return I}return this.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(c===void 0?"'undefined' value invalid. Use null instead.":typeof c=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof c} instead.`)}concat(c,h,p){const v=typeof c=="number"?this.path.concat(c):this.path,S=p?this.scope.concat(p):this.scope;return new zo(this.registry,this._isConstant,v,h||null,S,this.errors)}error(c){for(var h=arguments.length,p=new Array(h>1?h-1:0),v=1;v<h;v++)p[v-1]=arguments[v];const S=`${this.key}${p.map(I=>`[${I}]`).join("")}`;this.errors.push(new Oe(S,c))}checkSubtype(c,h){const p=zt(c,h);return p&&this.error(p),p}}class Go{constructor(c,h,p){this.type=on,this.locale=p,this.caseSensitive=c,this.diacriticSensitive=h}static parse(c,h){if(c.length!==2)return h.error("Expected one argument.");const p=c[1];if(typeof p!="object"||Array.isArray(p))return h.error("Collator options argument must be an object.");const v=h.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,qe);if(!v)return null;const S=h.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,qe);if(!S)return null;let I=null;return p.locale&&(I=h.parse(p.locale,1,Xe),!I)?null:new Go(v,S,I)}evaluate(c){return new mn(this.caseSensitive.evaluate(c),this.diacriticSensitive.evaluate(c),this.locale?this.locale.evaluate(c):null)}eachChild(c){c(this.caseSensitive),c(this.diacriticSensitive),this.locale&&c(this.locale)}outputDefined(){return!1}}const Ys=8192;function dc(u,c){u[0]=Math.min(u[0],c[0]),u[1]=Math.min(u[1],c[1]),u[2]=Math.max(u[2],c[0]),u[3]=Math.max(u[3],c[1])}function At(u,c){return!(u[0]<=c[0]||u[2]>=c[2]||u[1]<=c[1]||u[3]>=c[3])}function xt(u,c){const h=(180+u[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,v=Math.pow(2,c.z);return[Math.round(h*v*Ys),Math.round(p*v*Ys)]}function Qt(u,c,h){const p=u[0]-c[0],v=u[1]-c[1],S=u[0]-h[0],I=u[1]-h[1];return p*I-S*v==0&&p*S<=0&&v*I<=0}function he(u,c){let h=!1;for(let I=0,F=c.length;I<F;I++){const O=c[I];for(let G=0,K=O.length;G<K-1;G++){if(Qt(u,O[G],O[G+1]))return!1;(v=O[G])[1]>(p=u)[1]!=(S=O[G+1])[1]>p[1]&&p[0]<(S[0]-v[0])*(p[1]-v[1])/(S[1]-v[1])+v[0]&&(h=!h)}}var p,v,S;return h}function Fe(u,c){for(let h=0;h<c.length;h++)if(he(u,c[h]))return!0;return!1}function ir(u,c,h,p){const v=p[0]-h[0],S=p[1]-h[1],I=(u[0]-h[0])*S-v*(u[1]-h[1]),F=(c[0]-h[0])*S-v*(c[1]-h[1]);return I>0&&F<0||I<0&&F>0}function Hr(u,c,h){for(const G of h)for(let K=0;K<G.length-1;++K)if((F=[(I=G[K+1])[0]-(S=G[K])[0],I[1]-S[1]])[0]*(O=[(v=c)[0]-(p=u)[0],v[1]-p[1]])[1]-F[1]*O[0]!=0&&ir(p,v,S,I)&&ir(S,I,p,v))return!0;var p,v,S,I,F,O;return!1}function Kn(u,c){for(let h=0;h<u.length;++h)if(!he(u[h],c))return!1;for(let h=0;h<u.length-1;++h)if(Hr(u[h],u[h+1],c))return!1;return!0}function Jn(u,c){for(let h=0;h<c.length;h++)if(Kn(u,c[h]))return!0;return!1}function li(u,c,h){const p=[];for(let v=0;v<u.length;v++){const S=[];for(let I=0;I<u[v].length;I++){const F=xt(u[v][I],h);dc(c,F),S.push(F)}p.push(S)}return p}function kn(u,c,h){const p=[];for(let v=0;v<u.length;v++){const S=li(u[v],c,h);p.push(S)}return p}function ZA(u,c,h,p){if(u[0]<h[0]||u[0]>h[2]){const v=.5*p;let S=u[0]-h[0]>v?-p:h[0]-u[0]>v?p:0;S===0&&(S=u[0]-h[2]>v?-p:h[2]-u[0]>v?p:0),u[0]+=S}dc(c,u)}function ol(u,c,h,p){const v=Math.pow(2,p.z)*Ys,S=[p.x*Ys,p.y*Ys],I=[];for(const F of u)for(const O of F){const G=[O.x+S[0],O.y+S[1]];ZA(G,c,h,v),I.push(G)}return I}function Gr(u,c,h,p){const v=Math.pow(2,p.z)*Ys,S=[p.x*Ys,p.y*Ys],I=[];for(const O of u){const G=[];for(const K of O){const X=[K.x+S[0],K.y+S[1]];dc(c,X),G.push(X)}I.push(G)}if(c[2]-c[0]<=v/2){(F=c)[0]=F[1]=1/0,F[2]=F[3]=-1/0;for(const O of I)for(const G of O)ZA(G,c,h,v)}var F;return I}class Na{constructor(c,h){this.type=qe,this.geojson=c,this.geometries=h}static parse(c,h){if(c.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${c.length-1} instead.`);if(Ho(c[1])){const p=c[1];if(p.type==="FeatureCollection"){const v=[];for(const S of p.features){const{type:I,coordinates:F}=S.geometry;I==="Polygon"&&v.push(F),I==="MultiPolygon"&&v.push(...F)}if(v.length)return new Na(p,{type:"MultiPolygon",coordinates:v})}else if(p.type==="Feature"){const v=p.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Na(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Na(p,p)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(h,p){const v=[1/0,1/0,-1/0,-1/0],S=[1/0,1/0,-1/0,-1/0],I=h.canonicalID();if(p.type==="Polygon"){const F=li(p.coordinates,S,I),O=ol(h.geometry(),v,S,I);if(!At(v,S))return!1;for(const G of O)if(!he(G,F))return!1}if(p.type==="MultiPolygon"){const F=kn(p.coordinates,S,I),O=ol(h.geometry(),v,S,I);if(!At(v,S))return!1;for(const G of O)if(!Fe(G,F))return!1}return!0}(c,this.geometries);if(c.geometryType()==="LineString")return function(h,p){const v=[1/0,1/0,-1/0,-1/0],S=[1/0,1/0,-1/0,-1/0],I=h.canonicalID();if(p.type==="Polygon"){const F=li(p.coordinates,S,I),O=Gr(h.geometry(),v,S,I);if(!At(v,S))return!1;for(const G of O)if(!Kn(G,F))return!1}if(p.type==="MultiPolygon"){const F=kn(p.coordinates,S,I),O=Gr(h.geometry(),v,S,I);if(!At(v,S))return!1;for(const G of O)if(!Jn(G,F))return!1}return!0}(c,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class tu{constructor(c,h){this.type=h.type,this.name=c,this.boundExpression=h}static parse(c,h){if(c.length!==2||typeof c[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const p=c[1];return h.scope.has(p)?new tu(p,h.scope.get(p)):h.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(c){return this.boundExpression.evaluate(c)}eachChild(){}outputDefined(){return!1}}class yi{constructor(c,h,p,v){this.name=c,this.type=h,this._evaluate=p,this.args=v}evaluate(c){return this._evaluate(c,this.args)}eachChild(c){this.args.forEach(c)}outputDefined(){return!1}static parse(c,h){const p=c[0],v=yi.definitions[p];if(!v)return h.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const S=Array.isArray(v)?v[0]:v.type,I=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,F=I.filter(G=>{let[K]=G;return!Array.isArray(K)||K.length===c.length-1});let O=null;for(const[G,K]of F){O=new zo(h.registry,fc,h.path,null,h.scope);const X=[];let nt=!1;for(let at=1;at<c.length;at++){const ut=c[at],Bt=Array.isArray(G)?G[at-1]:G.type,It=O.parse(ut,1+X.length,Bt);if(!It){nt=!0;break}X.push(It)}if(!nt)if(Array.isArray(G)&&G.length!==X.length)O.error(`Expected ${G.length} arguments, but found ${X.length} instead.`);else{for(let at=0;at<X.length;at++){const ut=Array.isArray(G)?G[at]:G.type,Bt=X[at];O.concat(at+1).checkSubtype(ut,Bt.type)}if(O.errors.length===0)return new yi(p,S,K,X)}}if(F.length===1)h.errors.push(...O.errors);else{const G=(F.length?F:I).map(X=>{let[nt]=X;return at=nt,Array.isArray(at)?`(${at.map(Et).join(", ")})`:`(${Et(at.type)}...)`;var at}).join(" | "),K=[];for(let X=1;X<c.length;X++){const nt=h.parse(c[X],1+K.length);if(!nt)return null;K.push(Et(nt.type))}h.error(`Expected arguments of type ${G}, but found (${K.join(", ")}) instead.`)}return null}static register(c,h){yi.definitions=h;for(const p in h)c[p]=yi}}function fc(u){if(u instanceof tu)return fc(u.boundExpression);if(u instanceof yi&&u.name==="error"||u instanceof Go||u instanceof Na)return!1;const c=u instanceof Yn||u instanceof Fi;let h=!0;return u.eachChild(p=>{h=c?h&&fc(p):h&&p instanceof Bs}),!!h&&al(u)&&Qa(u,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function al(u){if(u instanceof yi&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof Na)return!1;let c=!0;return u.eachChild(h=>{c&&!al(h)&&(c=!1)}),c}function fa(u){if(u instanceof yi&&u.name==="feature-state")return!1;let c=!0;return u.eachChild(h=>{c&&!fa(h)&&(c=!1)}),c}function Qa(u,c){if(u instanceof yi&&c.indexOf(u.name)>=0)return!1;let h=!0;return u.eachChild(p=>{h&&!Qa(p,c)&&(h=!1)}),h}function cl(u,c){const h=u.length-1;let p,v,S=0,I=h,F=0;for(;S<=I;)if(F=Math.floor((S+I)/2),p=u[F],v=u[F+1],p<=c){if(F===h||c<v)return F;S=F+1}else{if(!(p>c))throw new Tn("Input is not a number.");I=F-1}return 0}class ll{constructor(c,h,p){this.type=c,this.input=h,this.labels=[],this.outputs=[];for(const[v,S]of p)this.labels.push(v),this.outputs.push(S)}static parse(c,h){if(c.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return h.error("Expected an even number of arguments.");const p=h.parse(c[1],1,Se);if(!p)return null;const v=[];let S=null;h.expectedType&&h.expectedType.kind!=="value"&&(S=h.expectedType);for(let I=1;I<c.length;I+=2){const F=I===1?-1/0:c[I],O=c[I+1],G=I,K=I+1;if(typeof F!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(v.length&&v[v.length-1][0]>=F)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',G);const X=h.parse(O,K,S);if(!X)return null;S=S||X.type,v.push([F,X])}return new ll(S,p,v)}evaluate(c){const h=this.labels,p=this.outputs;if(h.length===1)return p[0].evaluate(c);const v=this.input.evaluate(c);if(v<=h[0])return p[0].evaluate(c);const S=h.length;return v>=h[S-1]?p[S-1].evaluate(c):p[cl(h,v)].evaluate(c)}eachChild(c){c(this.input);for(const h of this.outputs)c(h)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}}function ud(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var Wu=pc;function pc(u,c,h,p){this.cx=3*u,this.bx=3*(h-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(p-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=c,this.p2x=h,this.p2y=p}pc.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,c){if(c===void 0&&(c=1e-6),u<0)return 0;if(u>1)return 1;for(var h=u,p=0;p<8;p++){var v=this.sampleCurveX(h)-u;if(Math.abs(v)<c)return h;var S=this.sampleCurveDerivativeX(h);if(Math.abs(S)<1e-6)break;h-=v/S}var I=0,F=1;for(h=u,p=0;p<20&&(v=this.sampleCurveX(h),!(Math.abs(v-u)<c));p++)u>v?I=h:F=h,h=.5*(F-I)+I;return h},solve:function(u,c){return this.sampleCurveY(this.solveCurveX(u,c))}};var gc=ud(Wu);function Ha(u,c,h){return u+h*(c-u)}function pa(u,c,h){return u.map((p,v)=>Ha(p,c[v],h))}const Pi={number:Ha,color:function(u,c,h){switch(arguments.length>3&&arguments[3]!==void 0?arguments[3]:"rgb"){case"rgb":{const[v,S,I,F]=pa(u.rgb,c.rgb,h);return new xr(v,S,I,F,!1)}case"hcl":{const[v,S,I,F]=u.hcl,[O,G,K,X]=c.hcl;let nt,at;if(isNaN(v)||isNaN(O))isNaN(v)?isNaN(O)?nt=NaN:(nt=O,I!==1&&I!==0||(at=G)):(nt=v,K!==1&&K!==0||(at=S));else{let ee=O-v;O>v&&ee>180?ee-=360:O<v&&v-O>180&&(ee+=360),nt=v+h*ee}const[ut,Bt,It,kt]=function(ee){let[Ht,Kt,ve,be]=ee;return Ht=isNaN(Ht)?0:Ht*cr,Wr([ve,Math.cos(Ht)*Kt,Math.sin(Ht)*Kt,be])}([nt,at??Ha(S,G,h),Ha(I,K,h),Ha(F,X,h)]);return new xr(ut,Bt,It,kt,!1)}case"lab":{const[v,S,I,F]=Wr(pa(u.lab,c.lab,h));return new xr(v,S,I,F,!1)}}},array:pa,padding:function(u,c,h){return new nn(pa(u.values,c.values,h))},variableAnchorOffsetCollection:function(u,c,h){const p=u.values,v=c.values;if(p.length!==v.length)throw new Tn(`Cannot interpolate values of different length. from: ${u.toString()}, to: ${c.toString()}`);const S=[];for(let I=0;I<p.length;I+=2){if(p[I]!==v[I])throw new Tn(`Cannot interpolate values containing mismatched anchors. from[${I}]: ${p[I]}, to[${I}]: ${v[I]}`);S.push(p[I]);const[F,O]=p[I+1],[G,K]=v[I+1];S.push([Ha(F,G,h),Ha(O,K,h)])}return new Xn(S)}};class xi{constructor(c,h,p,v,S){this.type=c,this.operator=h,this.interpolation=p,this.input=v,this.labels=[],this.outputs=[];for(const[I,F]of S)this.labels.push(I),this.outputs.push(F)}static interpolationFactor(c,h,p,v){let S=0;if(c.name==="exponential")S=cn(h,c.base,p,v);else if(c.name==="linear")S=cn(h,1,p,v);else if(c.name==="cubic-bezier"){const I=c.controlPoints;S=new gc(I[0],I[1],I[2],I[3]).solve(cn(h,1,p,v))}return S}static parse(c,h){let[p,v,S,...I]=c;if(!Array.isArray(v)||v.length===0)return h.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){const G=v[1];if(typeof G!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:G}}else{if(v[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(v[0])}`,1,0);{const G=v.slice(1);if(G.length!==4||G.some(K=>typeof K!="number"||K<0||K>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:G}}}if(c.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(S=h.parse(S,2,Se),!S)return null;const F=[];let O=null;p==="interpolate-hcl"||p==="interpolate-lab"?O=Yr:h.expectedType&&h.expectedType.kind!=="value"&&(O=h.expectedType);for(let G=0;G<I.length;G+=2){const K=I[G],X=I[G+1],nt=G+3,at=G+4;if(typeof K!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',nt);if(F.length&&F[F.length-1][0]>=K)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',nt);const ut=h.parse(X,at,O);if(!ut)return null;O=O||ut.type,F.push([K,ut])}return Jt(O,Se)||Jt(O,Yr)||Jt(O,Ct)||Jt(O,J)||Jt(O,ot(Se))?new xi(O,p,v,S,F):h.error(`Type ${Et(O)} is not interpolatable.`)}evaluate(c){const h=this.labels,p=this.outputs;if(h.length===1)return p[0].evaluate(c);const v=this.input.evaluate(c);if(v<=h[0])return p[0].evaluate(c);const S=h.length;if(v>=h[S-1])return p[S-1].evaluate(c);const I=cl(h,v),F=xi.interpolationFactor(this.interpolation,v,h[I],h[I+1]),O=p[I].evaluate(c),G=p[I+1].evaluate(c);switch(this.operator){case"interpolate":return Pi[this.type.kind](O,G,F);case"interpolate-hcl":return Pi.color(O,G,F,"hcl");case"interpolate-lab":return Pi.color(O,G,F,"lab")}}eachChild(c){c(this.input);for(const h of this.outputs)c(h)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}}function cn(u,c,h,p){const v=p-h,S=u-h;return v===0?0:c===1?S/v:(Math.pow(c,S)-1)/(Math.pow(c,v)-1)}class ul{constructor(c,h){this.type=c,this.args=h}static parse(c,h){if(c.length<2)return h.error("Expectected at least one argument.");let p=null;const v=h.expectedType;v&&v.kind!=="value"&&(p=v);const S=[];for(const F of c.slice(1)){const O=h.parse(F,1+S.length,p,void 0,{typeAnnotation:"omit"});if(!O)return null;p=p||O.type,S.push(O)}if(!p)throw new Error("No output type");const I=v&&S.some(F=>zt(v,F.type));return new ul(I?pr:p,S)}evaluate(c){let h,p=null,v=0;for(const S of this.args)if(v++,p=S.evaluate(c),p&&p instanceof os&&!p.available&&(h||(h=p.name),p=null,v===this.args.length&&(p=h)),p!==null)break;return p}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}class Al{constructor(c,h){this.type=h.type,this.bindings=[].concat(c),this.result=h}evaluate(c){return this.result.evaluate(c)}eachChild(c){for(const h of this.bindings)c(h[1]);c(this.result)}static parse(c,h){if(c.length<4)return h.error(`Expected at least 3 arguments, but found ${c.length-1} instead.`);const p=[];for(let S=1;S<c.length-1;S+=2){const I=c[S];if(typeof I!="string")return h.error(`Expected string, but found ${typeof I} instead.`,S);if(/[^a-zA-Z0-9_]/.test(I))return h.error("Variable names must contain only alphanumeric characters or '_'.",S);const F=h.parse(c[S+1],S+1);if(!F)return null;p.push([I,F])}const v=h.parse(c[c.length-1],c.length-1,h.expectedType,p);return v?new Al(p,v):null}outputDefined(){return this.result.outputDefined()}}class eu{constructor(c,h,p){this.type=c,this.index=h,this.input=p}static parse(c,h){if(c.length!==3)return h.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const p=h.parse(c[1],1,Se),v=h.parse(c[2],2,ot(h.expectedType||pr));return p&&v?new eu(v.type.itemType,p,v):null}evaluate(c){const h=this.index.evaluate(c),p=this.input.evaluate(c);if(h<0)throw new Tn(`Array index out of bounds: ${h} < 0.`);if(h>=p.length)throw new Tn(`Array index out of bounds: ${h} > ${p.length-1}.`);if(h!==Math.floor(h))throw new Tn(`Array index must be an integer, but found ${h} instead.`);return p[h]}eachChild(c){c(this.index),c(this.input)}outputDefined(){return!1}}class Vo{constructor(c,h){this.type=qe,this.needle=c,this.haystack=h}static parse(c,h){if(c.length!==3)return h.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const p=h.parse(c[1],1,pr),v=h.parse(c[2],2,pr);return p&&v?qt(p.type,[qe,Xe,Se,Fr,pr])?new Vo(p,v):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Et(p.type)} instead`):null}evaluate(c){const h=this.needle.evaluate(c),p=this.haystack.evaluate(c);if(!p)return!1;if(!St(h,["boolean","string","number","null"]))throw new Tn(`Expected first argument to be of type boolean, string, number or null, but found ${Et(Or(h))} instead.`);if(!St(p,["string","array"]))throw new Tn(`Expected second argument to be of type array or string, but found ${Et(Or(p))} instead.`);return p.indexOf(h)>=0}eachChild(c){c(this.needle),c(this.haystack)}outputDefined(){return!0}}class jo{constructor(c,h,p){this.type=Se,this.needle=c,this.haystack=h,this.fromIndex=p}static parse(c,h){if(c.length<=2||c.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const p=h.parse(c[1],1,pr),v=h.parse(c[2],2,pr);if(!p||!v)return null;if(!qt(p.type,[qe,Xe,Se,Fr,pr]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Et(p.type)} instead`);if(c.length===4){const S=h.parse(c[3],3,Se);return S?new jo(p,v,S):null}return new jo(p,v)}evaluate(c){const h=this.needle.evaluate(c),p=this.haystack.evaluate(c);if(!St(h,["boolean","string","number","null"]))throw new Tn(`Expected first argument to be of type boolean, string, number or null, but found ${Et(Or(h))} instead.`);if(!St(p,["string","array"]))throw new Tn(`Expected second argument to be of type array or string, but found ${Et(Or(p))} instead.`);if(this.fromIndex){const v=this.fromIndex.evaluate(c);return p.indexOf(h,v)}return p.indexOf(h)}eachChild(c){c(this.needle),c(this.haystack),this.fromIndex&&c(this.fromIndex)}outputDefined(){return!1}}class $u{constructor(c,h,p,v,S,I){this.inputType=c,this.type=h,this.input=p,this.cases=v,this.outputs=S,this.otherwise=I}static parse(c,h){if(c.length<5)return h.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if(c.length%2!=1)return h.error("Expected an even number of arguments.");let p,v;h.expectedType&&h.expectedType.kind!=="value"&&(v=h.expectedType);const S={},I=[];for(let G=2;G<c.length-1;G+=2){let K=c[G];const X=c[G+1];Array.isArray(K)||(K=[K]);const nt=h.concat(G);if(K.length===0)return nt.error("Expected at least one branch label.");for(const ut of K){if(typeof ut!="number"&&typeof ut!="string")return nt.error("Branch labels must be numbers or strings.");if(typeof ut=="number"&&Math.abs(ut)>Number.MAX_SAFE_INTEGER)return nt.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ut=="number"&&Math.floor(ut)!==ut)return nt.error("Numeric branch labels must be integer values.");if(p){if(nt.checkSubtype(p,Or(ut)))return null}else p=Or(ut);if(S[String(ut)]!==void 0)return nt.error("Branch labels must be unique.");S[String(ut)]=I.length}const at=h.parse(X,G,v);if(!at)return null;v=v||at.type,I.push(at)}const F=h.parse(c[1],1,pr);if(!F)return null;const O=h.parse(c[c.length-1],c.length-1,v);return O?F.type.kind!=="value"&&h.concat(1).checkSubtype(p,F.type)?null:new $u(p,v,F,S,I,O):null}evaluate(c){const h=this.input.evaluate(c);return(Or(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(c)}eachChild(c){c(this.input),this.outputs.forEach(c),c(this.otherwise)}outputDefined(){return this.outputs.every(c=>c.outputDefined())&&this.otherwise.outputDefined()}}class ga{constructor(c,h,p){this.type=c,this.branches=h,this.otherwise=p}static parse(c,h){if(c.length<4)return h.error(`Expected at least 3 arguments, but found only ${c.length-1}.`);if(c.length%2!=0)return h.error("Expected an odd number of arguments.");let p;h.expectedType&&h.expectedType.kind!=="value"&&(p=h.expectedType);const v=[];for(let I=1;I<c.length-1;I+=2){const F=h.parse(c[I],I,qe);if(!F)return null;const O=h.parse(c[I+1],I+1,p);if(!O)return null;v.push([F,O]),p=p||O.type}const S=h.parse(c[c.length-1],c.length-1,p);if(!S)return null;if(!p)throw new Error("Can't infer output type");return new ga(p,v,S)}evaluate(c){for(const[h,p]of this.branches)if(h.evaluate(c))return p.evaluate(c);return this.otherwise.evaluate(c)}eachChild(c){for(const[h,p]of this.branches)c(h),c(p);c(this.otherwise)}outputDefined(){return this.branches.every(c=>{let[h,p]=c;return p.outputDefined()})&&this.otherwise.outputDefined()}}class Os{constructor(c,h,p,v){this.type=c,this.input=h,this.beginIndex=p,this.endIndex=v}static parse(c,h){if(c.length<=2||c.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const p=h.parse(c[1],1,pr),v=h.parse(c[2],2,Se);if(!p||!v)return null;if(!qt(p.type,[ot(pr),Xe,pr]))return h.error(`Expected first argument to be of type array or string, but found ${Et(p.type)} instead`);if(c.length===4){const S=h.parse(c[3],3,Se);return S?new Os(p.type,p,v,S):null}return new Os(p.type,p,v)}evaluate(c){const h=this.input.evaluate(c),p=this.beginIndex.evaluate(c);if(!St(h,["string","array"]))throw new Tn(`Expected first argument to be of type array or string, but found ${Et(Or(h))} instead.`);if(this.endIndex){const v=this.endIndex.evaluate(c);return h.slice(p,v)}return h.slice(p)}eachChild(c){c(this.input),c(this.beginIndex),this.endIndex&&c(this.endIndex)}outputDefined(){return!1}}function ru(u,c){return u==="=="||u==="!="?c.kind==="boolean"||c.kind==="string"||c.kind==="number"||c.kind==="null"||c.kind==="value":c.kind==="string"||c.kind==="number"||c.kind==="value"}function mc(u,c,h,p){return p.compare(c,h)===0}function yc(u,c,h){const p=u!=="=="&&u!=="!=";return class Sk{constructor(S,I,F){this.type=qe,this.lhs=S,this.rhs=I,this.collator=F,this.hasUntypedArgument=S.type.kind==="value"||I.type.kind==="value"}static parse(S,I){if(S.length!==3&&S.length!==4)return I.error("Expected two or three arguments.");const F=S[0];let O=I.parse(S[1],1,pr);if(!O)return null;if(!ru(F,O.type))return I.concat(1).error(`"${F}" comparisons are not supported for type '${Et(O.type)}'.`);let G=I.parse(S[2],2,pr);if(!G)return null;if(!ru(F,G.type))return I.concat(2).error(`"${F}" comparisons are not supported for type '${Et(G.type)}'.`);if(O.type.kind!==G.type.kind&&O.type.kind!=="value"&&G.type.kind!=="value")return I.error(`Cannot compare types '${Et(O.type)}' and '${Et(G.type)}'.`);p&&(O.type.kind==="value"&&G.type.kind!=="value"?O=new Fi(G.type,[O]):O.type.kind!=="value"&&G.type.kind==="value"&&(G=new Fi(O.type,[G])));let K=null;if(S.length===4){if(O.type.kind!=="string"&&G.type.kind!=="string"&&O.type.kind!=="value"&&G.type.kind!=="value")return I.error("Cannot use collator to compare non-string types.");if(K=I.parse(S[3],3,on),!K)return null}return new Sk(O,G,K)}evaluate(S){const I=this.lhs.evaluate(S),F=this.rhs.evaluate(S);if(p&&this.hasUntypedArgument){const O=Or(I),G=Or(F);if(O.kind!==G.kind||O.kind!=="string"&&O.kind!=="number")throw new Tn(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${O.kind}, ${G.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const O=Or(I),G=Or(F);if(O.kind!=="string"||G.kind!=="string")return c(S,I,F)}return this.collator?h(S,I,F,this.collator.evaluate(S)):c(S,I,F)}eachChild(S){S(this.lhs),S(this.rhs),this.collator&&S(this.collator)}outputDefined(){return!0}}}const nu=yc("==",function(u,c,h){return c===h},mc),Ad=yc("!=",function(u,c,h){return c!==h},function(u,c,h,p){return!mc(0,c,h,p)}),Xu=yc("<",function(u,c,h){return c<h},function(u,c,h,p){return p.compare(c,h)<0}),Yu=yc(">",function(u,c,h){return c>h},function(u,c,h,p){return p.compare(c,h)>0}),th=yc("<=",function(u,c,h){return c<=h},function(u,c,h,p){return p.compare(c,h)<=0}),iu=yc(">=",function(u,c,h){return c>=h},function(u,c,h,p){return p.compare(c,h)>=0});class hl{constructor(c,h,p,v,S){this.type=Xe,this.number=c,this.locale=h,this.currency=p,this.minFractionDigits=v,this.maxFractionDigits=S}static parse(c,h){if(c.length!==3)return h.error("Expected two arguments.");const p=h.parse(c[1],1,Se);if(!p)return null;const v=c[2];if(typeof v!="object"||Array.isArray(v))return h.error("NumberFormat options argument must be an object.");let S=null;if(v.locale&&(S=h.parse(v.locale,1,Xe),!S))return null;let I=null;if(v.currency&&(I=h.parse(v.currency,1,Xe),!I))return null;let F=null;if(v["min-fraction-digits"]&&(F=h.parse(v["min-fraction-digits"],1,Se),!F))return null;let O=null;return v["max-fraction-digits"]&&(O=h.parse(v["max-fraction-digits"],1,Se),!O)?null:new hl(p,S,I,F,O)}evaluate(c){return new Intl.NumberFormat(this.locale?this.locale.evaluate(c):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(c):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(c):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(c):void 0}).format(this.number.evaluate(c))}eachChild(c){c(this.number),this.locale&&c(this.locale),this.currency&&c(this.currency),this.minFractionDigits&&c(this.minFractionDigits),this.maxFractionDigits&&c(this.maxFractionDigits)}outputDefined(){return!1}}class _c{constructor(c){this.type=Kr,this.sections=c}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");const p=c[1];if(!Array.isArray(p)&&typeof p=="object")return h.error("First argument must be an image or text section.");const v=[];let S=!1;for(let I=1;I<=c.length-1;++I){const F=c[I];if(S&&typeof F=="object"&&!Array.isArray(F)){S=!1;let O=null;if(F["font-scale"]&&(O=h.parse(F["font-scale"],1,Se),!O))return null;let G=null;if(F["text-font"]&&(G=h.parse(F["text-font"],1,ot(Xe)),!G))return null;let K=null;if(F["text-color"]&&(K=h.parse(F["text-color"],1,Yr),!K))return null;const X=v[v.length-1];X.scale=O,X.font=G,X.textColor=K}else{const O=h.parse(c[I],1,pr);if(!O)return null;const G=O.type.kind;if(G!=="string"&&G!=="value"&&G!=="null"&&G!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");S=!0,v.push({content:O,scale:null,font:null,textColor:null})}}return new _c(v)}evaluate(c){return new yn(this.sections.map(h=>{const p=h.content.evaluate(c);return Or(p)===Z?new bi("",p,null,null,null):new bi(Xs(p),null,h.scale?h.scale.evaluate(c):null,h.font?h.font.evaluate(c).join(","):null,h.textColor?h.textColor.evaluate(c):null)}))}eachChild(c){for(const h of this.sections)c(h.content),h.scale&&c(h.scale),h.font&&c(h.font),h.textColor&&c(h.textColor)}outputDefined(){return!1}}class su{constructor(c){this.type=Z,this.input=c}static parse(c,h){if(c.length!==2)return h.error("Expected two arguments.");const p=h.parse(c[1],1,Xe);return p?new su(p):h.error("No image name provided.")}evaluate(c){const h=this.input.evaluate(c),p=os.fromString(h);return p&&c.availableImages&&(p.available=c.availableImages.indexOf(h)>-1),p}eachChild(c){c(this.input)}outputDefined(){return!1}}class Ju{constructor(c){this.type=Se,this.input=c}static parse(c,h){if(c.length!==2)return h.error(`Expected 1 argument, but found ${c.length-1} instead.`);const p=h.parse(c[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${Et(p.type)} instead.`):new Ju(p):null}evaluate(c){const h=this.input.evaluate(c);if(typeof h=="string"||Array.isArray(h))return h.length;throw new Tn(`Expected value to be of type string or array, but found ${Et(Or(h))} instead.`)}eachChild(c){c(this.input)}outputDefined(){return!1}}const qo={"==":nu,"!=":Ad,">":Yu,"<":Xu,">=":iu,"<=":th,array:Fi,at:eu,boolean:Fi,case:ga,coalesce:ul,collator:Go,format:_c,image:su,in:Vo,"index-of":jo,interpolate:xi,"interpolate-hcl":xi,"interpolate-lab":xi,length:Ju,let:Al,literal:Bs,match:$u,number:Fi,"number-format":hl,object:Fi,slice:Os,step:ll,string:Fi,"to-boolean":Yn,"to-color":Yn,"to-number":Yn,"to-string":Yn,var:tu,within:Na};function vc(u,c){let[h,p,v,S]=c;h=h.evaluate(u),p=p.evaluate(u),v=v.evaluate(u);const I=S?S.evaluate(u):1,F=Rs(h,p,v,I);if(F)throw new Tn(F);return new xr(h/255,p/255,v/255,I,!1)}function ou(u,c){return u in c}function ma(u,c){const h=c[u];return h===void 0?null:h}function Ko(u){return{type:u}}function k(u){return{result:"success",value:u}}function et(u){return{result:"error",value:u}}function Mt(u){return u["property-type"]==="data-driven"||u["property-type"]==="cross-faded-data-driven"}function Vt(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function oe(u){return!!u.expression&&u.expression.interpolated}function ce(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function Me(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function ar(u){return u}function Mr(u,c){const h=c.type==="color",p=u.stops&&typeof u.stops[0][0]=="object",v=p||!(p||u.property!==void 0),S=u.type||(oe(c)?"exponential":"interval");if(h||c.type==="padding"){const K=h?xr.parse:nn.parse;(u=Tr({},u)).stops&&(u.stops=u.stops.map(X=>[X[0],K(X[1])])),u.default=K(u.default?u.default:c.default)}if(u.colorSpace&&(I=u.colorSpace)!=="rgb"&&I!=="hcl"&&I!=="lab")throw new Error(`Unknown color space: "${u.colorSpace}"`);var I;let F,O,G;if(S==="exponential")F=vr;else if(S==="interval")F=bn;else if(S==="categorical"){F=_r,O=Object.create(null);for(const K of u.stops)O[K[0]]=K[1];G=typeof u.stops[0][0]}else{if(S!=="identity")throw new Error(`Unknown function type "${S}"`);F=ui}if(p){const K={},X=[];for(let ut=0;ut<u.stops.length;ut++){const Bt=u.stops[ut],It=Bt[0].zoom;K[It]===void 0&&(K[It]={zoom:It,type:u.type,property:u.property,default:u.default,stops:[]},X.push(It)),K[It].stops.push([Bt[0].value,Bt[1]])}const nt=[];for(const ut of X)nt.push([K[ut].zoom,Mr(K[ut],c)]);const at={name:"linear"};return{kind:"composite",interpolationType:at,interpolationFactor:xi.interpolationFactor.bind(void 0,at),zoomStops:nt.map(ut=>ut[0]),evaluate:(ut,Bt)=>{let{zoom:It}=ut;return vr({stops:nt,base:u.base},c,It).evaluate(It,Bt)}}}if(v){const K=S==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:K,interpolationFactor:xi.interpolationFactor.bind(void 0,K),zoomStops:u.stops.map(X=>X[0]),evaluate:X=>{let{zoom:nt}=X;return F(u,c,nt,O,G)}}}return{kind:"source",evaluate(K,X){const nt=X&&X.properties?X.properties[u.property]:void 0;return nt===void 0?zr(u.default,c.default):F(u,c,nt,O,G)}}}function zr(u,c,h){return u!==void 0?u:c!==void 0?c:h!==void 0?h:void 0}function _r(u,c,h,p,v){return zr(typeof h===v?p[h]:void 0,u.default,c.default)}function bn(u,c,h){if(ce(h)!=="number")return zr(u.default,c.default);const p=u.stops.length;if(p===1||h<=u.stops[0][0])return u.stops[0][1];if(h>=u.stops[p-1][0])return u.stops[p-1][1];const v=cl(u.stops.map(S=>S[0]),h);return u.stops[v][1]}function vr(u,c,h){const p=u.base!==void 0?u.base:1;if(ce(h)!=="number")return zr(u.default,c.default);const v=u.stops.length;if(v===1||h<=u.stops[0][0])return u.stops[0][1];if(h>=u.stops[v-1][0])return u.stops[v-1][1];const S=cl(u.stops.map(K=>K[0]),h),I=function(K,X,nt,at){const ut=at-nt,Bt=K-nt;return ut===0?0:X===1?Bt/ut:(Math.pow(X,Bt)-1)/(Math.pow(X,ut)-1)}(h,p,u.stops[S][0],u.stops[S+1][0]),F=u.stops[S][1],O=u.stops[S+1][1],G=Pi[c.type]||ar;return typeof F.evaluate=="function"?{evaluate(){for(var K=arguments.length,X=new Array(K),nt=0;nt<K;nt++)X[nt]=arguments[nt];const at=F.evaluate.apply(void 0,X),ut=O.evaluate.apply(void 0,X);if(at!==void 0&&ut!==void 0)return G(at,ut,I,u.colorSpace)}}:G(F,O,I,u.colorSpace)}function ui(u,c,h){switch(c.type){case"color":h=xr.parse(h);break;case"formatted":h=yn.fromString(h.toString());break;case"resolvedImage":h=os.fromString(h.toString());break;case"padding":h=nn.parse(h);break;default:ce(h)===c.type||c.type==="enum"&&c.values[h]||(h=void 0)}return zr(h,u.default,c.default)}yi.register(qo,{error:[{kind:"error"},[Xe],(u,c)=>{let[h]=c;throw new Tn(h.evaluate(u))}],typeof:[Xe,[pr],(u,c)=>{let[h]=c;return Et(Or(h.evaluate(u)))}],"to-rgba":[ot(Se,4),[Yr],(u,c)=>{let[h]=c;const[p,v,S,I]=h.evaluate(u).rgb;return[255*p,255*v,255*S,I]}],rgb:[Yr,[Se,Se,Se],vc],rgba:[Yr,[Se,Se,Se,Se],vc],has:{type:qe,overloads:[[[Xe],(u,c)=>{let[h]=c;return ou(h.evaluate(u),u.properties())}],[[Xe,Rr],(u,c)=>{let[h,p]=c;return ou(h.evaluate(u),p.evaluate(u))}]]},get:{type:pr,overloads:[[[Xe],(u,c)=>{let[h]=c;return ma(h.evaluate(u),u.properties())}],[[Xe,Rr],(u,c)=>{let[h,p]=c;return ma(h.evaluate(u),p.evaluate(u))}]]},"feature-state":[pr,[Xe],(u,c)=>{let[h]=c;return ma(h.evaluate(u),u.featureState||{})}],properties:[Rr,[],u=>u.properties()],"geometry-type":[Xe,[],u=>u.geometryType()],id:[pr,[],u=>u.id()],zoom:[Se,[],u=>u.globals.zoom],"heatmap-density":[Se,[],u=>u.globals.heatmapDensity||0],"line-progress":[Se,[],u=>u.globals.lineProgress||0],accumulated:[pr,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[Se,Ko(Se),(u,c)=>{let h=0;for(const p of c)h+=p.evaluate(u);return h}],"*":[Se,Ko(Se),(u,c)=>{let h=1;for(const p of c)h*=p.evaluate(u);return h}],"-":{type:Se,overloads:[[[Se,Se],(u,c)=>{let[h,p]=c;return h.evaluate(u)-p.evaluate(u)}],[[Se],(u,c)=>{let[h]=c;return-h.evaluate(u)}]]},"/":[Se,[Se,Se],(u,c)=>{let[h,p]=c;return h.evaluate(u)/p.evaluate(u)}],"%":[Se,[Se,Se],(u,c)=>{let[h,p]=c;return h.evaluate(u)%p.evaluate(u)}],ln2:[Se,[],()=>Math.LN2],pi:[Se,[],()=>Math.PI],e:[Se,[],()=>Math.E],"^":[Se,[Se,Se],(u,c)=>{let[h,p]=c;return Math.pow(h.evaluate(u),p.evaluate(u))}],sqrt:[Se,[Se],(u,c)=>{let[h]=c;return Math.sqrt(h.evaluate(u))}],log10:[Se,[Se],(u,c)=>{let[h]=c;return Math.log(h.evaluate(u))/Math.LN10}],ln:[Se,[Se],(u,c)=>{let[h]=c;return Math.log(h.evaluate(u))}],log2:[Se,[Se],(u,c)=>{let[h]=c;return Math.log(h.evaluate(u))/Math.LN2}],sin:[Se,[Se],(u,c)=>{let[h]=c;return Math.sin(h.evaluate(u))}],cos:[Se,[Se],(u,c)=>{let[h]=c;return Math.cos(h.evaluate(u))}],tan:[Se,[Se],(u,c)=>{let[h]=c;return Math.tan(h.evaluate(u))}],asin:[Se,[Se],(u,c)=>{let[h]=c;return Math.asin(h.evaluate(u))}],acos:[Se,[Se],(u,c)=>{let[h]=c;return Math.acos(h.evaluate(u))}],atan:[Se,[Se],(u,c)=>{let[h]=c;return Math.atan(h.evaluate(u))}],min:[Se,Ko(Se),(u,c)=>Math.min(...c.map(h=>h.evaluate(u)))],max:[Se,Ko(Se),(u,c)=>Math.max(...c.map(h=>h.evaluate(u)))],abs:[Se,[Se],(u,c)=>{let[h]=c;return Math.abs(h.evaluate(u))}],round:[Se,[Se],(u,c)=>{let[h]=c;const p=h.evaluate(u);return p<0?-Math.round(-p):Math.round(p)}],floor:[Se,[Se],(u,c)=>{let[h]=c;return Math.floor(h.evaluate(u))}],ceil:[Se,[Se],(u,c)=>{let[h]=c;return Math.ceil(h.evaluate(u))}],"filter-==":[qe,[Xe,pr],(u,c)=>{let[h,p]=c;return u.properties()[h.value]===p.value}],"filter-id-==":[qe,[pr],(u,c)=>{let[h]=c;return u.id()===h.value}],"filter-type-==":[qe,[Xe],(u,c)=>{let[h]=c;return u.geometryType()===h.value}],"filter-<":[qe,[Xe,pr],(u,c)=>{let[h,p]=c;const v=u.properties()[h.value],S=p.value;return typeof v==typeof S&&v<S}],"filter-id-<":[qe,[pr],(u,c)=>{let[h]=c;const p=u.id(),v=h.value;return typeof p==typeof v&&p<v}],"filter->":[qe,[Xe,pr],(u,c)=>{let[h,p]=c;const v=u.properties()[h.value],S=p.value;return typeof v==typeof S&&v>S}],"filter-id->":[qe,[pr],(u,c)=>{let[h]=c;const p=u.id(),v=h.value;return typeof p==typeof v&&p>v}],"filter-<=":[qe,[Xe,pr],(u,c)=>{let[h,p]=c;const v=u.properties()[h.value],S=p.value;return typeof v==typeof S&&v<=S}],"filter-id-<=":[qe,[pr],(u,c)=>{let[h]=c;const p=u.id(),v=h.value;return typeof p==typeof v&&p<=v}],"filter->=":[qe,[Xe,pr],(u,c)=>{let[h,p]=c;const v=u.properties()[h.value],S=p.value;return typeof v==typeof S&&v>=S}],"filter-id->=":[qe,[pr],(u,c)=>{let[h]=c;const p=u.id(),v=h.value;return typeof p==typeof v&&p>=v}],"filter-has":[qe,[pr],(u,c)=>{let[h]=c;return h.value in u.properties()}],"filter-has-id":[qe,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[qe,[ot(Xe)],(u,c)=>{let[h]=c;return h.value.indexOf(u.geometryType())>=0}],"filter-id-in":[qe,[ot(pr)],(u,c)=>{let[h]=c;return h.value.indexOf(u.id())>=0}],"filter-in-small":[qe,[Xe,ot(pr)],(u,c)=>{let[h,p]=c;return p.value.indexOf(u.properties()[h.value])>=0}],"filter-in-large":[qe,[Xe,ot(pr)],(u,c)=>{let[h,p]=c;return function(v,S,I,F){for(;I<=F;){const O=I+F>>1;if(S[O]===v)return!0;S[O]>v?F=O-1:I=O+1}return!1}(u.properties()[h.value],p.value,0,p.value.length-1)}],all:{type:qe,overloads:[[[qe,qe],(u,c)=>{let[h,p]=c;return h.evaluate(u)&&p.evaluate(u)}],[Ko(qe),(u,c)=>{for(const h of c)if(!h.evaluate(u))return!1;return!0}]]},any:{type:qe,overloads:[[[qe,qe],(u,c)=>{let[h,p]=c;return h.evaluate(u)||p.evaluate(u)}],[Ko(qe),(u,c)=>{for(const h of c)if(h.evaluate(u))return!0;return!1}]]},"!":[qe,[qe],(u,c)=>{let[h]=c;return!h.evaluate(u)}],"is-supported-script":[qe,[Xe],(u,c)=>{let[h]=c;const p=u.globals&&u.globals.isSupportedScript;return!p||p(h.evaluate(u))}],upcase:[Xe,[Xe],(u,c)=>{let[h]=c;return h.evaluate(u).toUpperCase()}],downcase:[Xe,[Xe],(u,c)=>{let[h]=c;return h.evaluate(u).toLowerCase()}],concat:[Xe,Ko(pr),(u,c)=>c.map(h=>Xs(h.evaluate(u))).join("")],"resolved-locale":[Xe,[on],(u,c)=>{let[h]=c;return h.evaluate(u).resolvedLocale()}]});class qr{constructor(c,h){var p;this.expression=c,this._warningHistory={},this._evaluator=new an,this._defaultValue=h?(p=h).type==="color"&&Me(p.default)?new xr(0,0,0,0):p.type==="color"?xr.parse(p.default)||null:p.type==="padding"?nn.parse(p.default)||null:p.type==="variableAnchorOffsetCollection"?Xn.parse(p.default)||null:p.default===void 0?null:p.default:null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(c,h,p,v,S,I){return this._evaluator.globals=c,this._evaluator.feature=h,this._evaluator.featureState=p,this._evaluator.canonical=v,this._evaluator.availableImages=S||null,this._evaluator.formattedSection=I,this.expression.evaluate(this._evaluator)}evaluate(c,h,p,v,S,I){this._evaluator.globals=c,this._evaluator.feature=h||null,this._evaluator.featureState=p||null,this._evaluator.canonical=v,this._evaluator.availableImages=S||null,this._evaluator.formattedSection=I||null;try{const F=this.expression.evaluate(this._evaluator);if(F==null||typeof F=="number"&&F!=F)return this._defaultValue;if(this._enumValues&&!(F in this._enumValues))throw new Tn(`Expected value to be one of ${Object.keys(this._enumValues).map(O=>JSON.stringify(O)).join(", ")}, but found ${JSON.stringify(F)} instead.`);return F}catch(F){return this._warningHistory[F.message]||(this._warningHistory[F.message]=!0,typeof console<"u"&&console.warn(F.message)),this._defaultValue}}}function $r(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in qo}function ii(u,c){const h=new zo(qo,fc,[],c?function(v){const S={color:Yr,string:Xe,number:Se,enum:Xe,boolean:qe,formatted:Kr,padding:Ct,resolvedImage:Z,variableAnchorOffsetCollection:J};return v.type==="array"?ot(S[v.value]||pr,v.length):S[v.type]}(c):void 0),p=h.parse(u,void 0,void 0,void 0,c&&c.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?k(new qr(p,c)):et(h.errors)}class Ds{constructor(c,h){this.kind=c,this._styleExpression=h,this.isStateDependent=c!=="constant"&&!fa(h.expression)}evaluateWithoutErrorHandling(c,h,p,v,S,I){return this._styleExpression.evaluateWithoutErrorHandling(c,h,p,v,S,I)}evaluate(c,h,p,v,S,I){return this._styleExpression.evaluate(c,h,p,v,S,I)}}class ks{constructor(c,h,p,v){this.kind=c,this.zoomStops=p,this._styleExpression=h,this.isStateDependent=c!=="camera"&&!fa(h.expression),this.interpolationType=v}evaluateWithoutErrorHandling(c,h,p,v,S,I){return this._styleExpression.evaluateWithoutErrorHandling(c,h,p,v,S,I)}evaluate(c,h,p,v,S,I){return this._styleExpression.evaluate(c,h,p,v,S,I)}interpolationFactor(c,h,p){return this.interpolationType?xi.interpolationFactor(this.interpolationType,c,h,p):0}}function ya(u,c){const h=ii(u,c);if(h.result==="error")return h;const p=h.value.expression,v=al(p);if(!v&&!Mt(c))return et([new Oe("","data expressions not supported")]);const S=Qa(p,["zoom"]);if(!S&&!Vt(c))return et([new Oe("","zoom expressions not supported")]);const I=bc(p);return I||S?I instanceof Oe?et([I]):I instanceof xi&&!oe(c)?et([new Oe("",'"interpolate" expressions cannot be used with this property')]):k(I?new ks(v?"camera":"composite",h.value,I.labels,I instanceof xi?I.interpolation:void 0):new Ds(v?"constant":"source",h.value)):et([new Oe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class dl{constructor(c,h){this._parameters=c,this._specification=h,Tr(this,Mr(this._parameters,this._specification))}static deserialize(c){return new dl(c._parameters,c._specification)}static serialize(c){return{_parameters:c._parameters,_specification:c._specification}}}function bc(u){let c=null;if(u instanceof Al)c=bc(u.result);else if(u instanceof ul){for(const h of u.args)if(c=bc(h),c)break}else(u instanceof ll||u instanceof xi)&&u.input instanceof yi&&u.input.name==="zoom"&&(c=u);return c instanceof Oe||u.eachChild(h=>{const p=bc(h);p instanceof Oe?c=p:!c&&p?c=new Oe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):c&&p&&c!==p&&(c=new Oe("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),c}function wc(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const c of u.slice(1))if(!wc(c)&&typeof c!="boolean")return!1;return!0;default:return!0}}const fl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function xc(u){if(u==null)return{filter:()=>!0,needGeometry:!1};wc(u)||(u=as(u));const c=ii(u,fl);if(c.result==="error")throw new Error(c.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,p,v)=>c.value.evaluate(h,p,{},v),needGeometry:za(u)}}function au(u,c){return u<c?-1:u>c?1:0}function za(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(let c=1;c<u.length;c++)if(za(u[c]))return!0;return!1}function as(u){if(!u)return!0;const c=u[0];return u.length<=1?c!=="any":c==="=="?Bc(u[1],u[2],"=="):c==="!="?Cc(Bc(u[1],u[2],"==")):c==="<"||c===">"||c==="<="||c===">="?Bc(u[1],u[2],c):c==="any"?(h=u.slice(1),["any"].concat(h.map(as))):c==="all"?["all"].concat(u.slice(1).map(as)):c==="none"?["all"].concat(u.slice(1).map(as).map(Cc)):c==="in"?pl(u[1],u.slice(2)):c==="!in"?Cc(pl(u[1],u.slice(2))):c==="has"?gl(u[1]):c==="!has"?Cc(gl(u[1])):c!=="within"||u;var h}function Bc(u,c,h){switch(u){case"$type":return[`filter-type-${h}`,c];case"$id":return[`filter-id-${h}`,c];default:return[`filter-${h}`,u,c]}}function pl(u,c){if(c.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",c]];case"$id":return["filter-id-in",["literal",c]];default:return c.length>200&&!c.some(h=>typeof h!=typeof c[0])?["filter-in-large",u,["literal",c.sort(au)]]:["filter-in-small",u,["literal",c]]}}function gl(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function Cc(u){return["!",u]}function _s(u){const c=typeof u;if(c==="number"||c==="boolean"||c==="string"||u==null)return JSON.stringify(u);if(Array.isArray(u)){let v="[";for(const S of u)v+=`${_s(S)},`;return`${v}]`}const h=Object.keys(u).sort();let p="{";for(let v=0;v<h.length;v++)p+=`${JSON.stringify(h[v])}:${_s(u[h[v]])},`;return`${p}}`}function hd(u){let c="";for(const h of tr)c+=`/${_s(u[h])}`;return c}function cu(u){const c=u.value;return c?[new fe(u.key,c,"constants have been deprecated as of v8")]:[]}function Wn(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function Vi(u){if(Array.isArray(u))return u.map(Vi);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const c={};for(const h in u)c[h]=Vi(u[h]);return c}return Wn(u)}function Ui(u){const c=u.key,h=u.value,p=u.valueSpec||{},v=u.objectElementValidators||{},S=u.style,I=u.styleSpec,F=u.validateSpec;let O=[];const G=ce(h);if(G!=="object")return[new fe(c,h,`object expected, ${G} found`)];for(const K in h){const X=K.split(".")[0],nt=p[X]||p["*"];let at;if(v[X])at=v[X];else if(p[X])at=F;else if(v["*"])at=v["*"];else{if(!p["*"]){O.push(new fe(c,h[K],`unknown property "${K}"`));continue}at=F}O=O.concat(at({key:(c&&`${c}.`)+K,value:h[K],valueSpec:nt,style:S,styleSpec:I,object:h,objectKey:K,validateSpec:F},h))}for(const K in p)v[K]||p[K].required&&p[K].default===void 0&&h[K]===void 0&&O.push(new fe(c,h,`missing required property "${K}"`));return O}function Zu(u){const c=u.value,h=u.valueSpec,p=u.style,v=u.styleSpec,S=u.key,I=u.arrayElementValidator||u.validateSpec;if(ce(c)!=="array")return[new fe(S,c,`array expected, ${ce(c)} found`)];if(h.length&&c.length!==h.length)return[new fe(S,c,`array length ${h.length} expected, length ${c.length} found`)];if(h["min-length"]&&c.length<h["min-length"])return[new fe(S,c,`array length at least ${h["min-length"]} expected, length ${c.length} found`)];let F={type:h.value,values:h.values};v.$version<7&&(F.function=h.function),ce(h.value)==="object"&&(F=h.value);let O=[];for(let G=0;G<c.length;G++)O=O.concat(I({array:c,arrayIndex:G,value:c[G],valueSpec:F,validateSpec:u.validateSpec,style:p,styleSpec:v,key:`${S}[${G}]`}));return O}function lu(u){const c=u.key,h=u.value,p=u.valueSpec;let v=ce(h);return v==="number"&&h!=h&&(v="NaN"),v!=="number"?[new fe(c,h,`number expected, ${v} found`)]:"minimum"in p&&h<p.minimum?[new fe(c,h,`${h} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&h>p.maximum?[new fe(c,h,`${h} is greater than the maximum value ${p.maximum}`)]:[]}function Ga(u){const c=u.valueSpec,h=Wn(u.value.type);let p,v,S,I={};const F=h!=="categorical"&&u.value.property===void 0,O=!F,G=ce(u.value.stops)==="array"&&ce(u.value.stops[0])==="array"&&ce(u.value.stops[0][0])==="object",K=Ui({key:u.key,value:u.value,valueSpec:u.styleSpec.function,validateSpec:u.validateSpec,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(at){if(h==="identity")return[new fe(at.key,at.value,'identity function may not have a "stops" property')];let ut=[];const Bt=at.value;return ut=ut.concat(Zu({key:at.key,value:Bt,valueSpec:at.valueSpec,validateSpec:at.validateSpec,style:at.style,styleSpec:at.styleSpec,arrayElementValidator:X})),ce(Bt)==="array"&&Bt.length===0&&ut.push(new fe(at.key,Bt,"array must have at least one stop")),ut},default:function(at){return at.validateSpec({key:at.key,value:at.value,valueSpec:c,validateSpec:at.validateSpec,style:at.style,styleSpec:at.styleSpec})}}});return h==="identity"&&F&&K.push(new fe(u.key,u.value,'missing required property "property"')),h==="identity"||u.value.stops||K.push(new fe(u.key,u.value,'missing required property "stops"')),h==="exponential"&&u.valueSpec.expression&&!oe(u.valueSpec)&&K.push(new fe(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(O&&!Mt(u.valueSpec)?K.push(new fe(u.key,u.value,"property functions not supported")):F&&!Vt(u.valueSpec)&&K.push(new fe(u.key,u.value,"zoom functions not supported"))),h!=="categorical"&&!G||u.value.property!==void 0||K.push(new fe(u.key,u.value,'"property" property is required')),K;function X(at){let ut=[];const Bt=at.value,It=at.key;if(ce(Bt)!=="array")return[new fe(It,Bt,`array expected, ${ce(Bt)} found`)];if(Bt.length!==2)return[new fe(It,Bt,`array length 2 expected, length ${Bt.length} found`)];if(G){if(ce(Bt[0])!=="object")return[new fe(It,Bt,`object expected, ${ce(Bt[0])} found`)];if(Bt[0].zoom===void 0)return[new fe(It,Bt,"object stop key must have zoom")];if(Bt[0].value===void 0)return[new fe(It,Bt,"object stop key must have value")];if(S&&S>Wn(Bt[0].zoom))return[new fe(It,Bt[0].zoom,"stop zoom values must appear in ascending order")];Wn(Bt[0].zoom)!==S&&(S=Wn(Bt[0].zoom),v=void 0,I={}),ut=ut.concat(Ui({key:`${It}[0]`,value:Bt[0],valueSpec:{zoom:{}},validateSpec:at.validateSpec,style:at.style,styleSpec:at.styleSpec,objectElementValidators:{zoom:lu,value:nt}}))}else ut=ut.concat(nt({key:`${It}[0]`,value:Bt[0],valueSpec:{},validateSpec:at.validateSpec,style:at.style,styleSpec:at.styleSpec},Bt));return $r(Vi(Bt[1]))?ut.concat([new fe(`${It}[1]`,Bt[1],"expressions are not allowed in function stops.")]):ut.concat(at.validateSpec({key:`${It}[1]`,value:Bt[1],valueSpec:c,validateSpec:at.validateSpec,style:at.style,styleSpec:at.styleSpec}))}function nt(at,ut){const Bt=ce(at.value),It=Wn(at.value),kt=at.value!==null?at.value:ut;if(p){if(Bt!==p)return[new fe(at.key,kt,`${Bt} stop domain type must match previous stop domain type ${p}`)]}else p=Bt;if(Bt!=="number"&&Bt!=="string"&&Bt!=="boolean")return[new fe(at.key,kt,"stop domain value must be a number, string, or boolean")];if(Bt!=="number"&&h!=="categorical"){let ee=`number expected, ${Bt} found`;return Mt(c)&&h===void 0&&(ee+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new fe(at.key,kt,ee)]}return h!=="categorical"||Bt!=="number"||isFinite(It)&&Math.floor(It)===It?h!=="categorical"&&Bt==="number"&&v!==void 0&&It<v?[new fe(at.key,kt,"stop domain values must appear in ascending order")]:(v=It,h==="categorical"&&It in I?[new fe(at.key,kt,"stop domain values must be unique")]:(I[It]=!0,[])):[new fe(at.key,kt,`integer expected, found ${It}`)]}}function Ri(u){const c=(u.expressionContext==="property"?ya:ii)(Vi(u.value),u.valueSpec);if(c.result==="error")return c.value.map(p=>new fe(`${u.key}${p.key}`,u.value,p.message));const h=c.value.expression||c.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!h.outputDefined())return[new fe(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!fa(h))return[new fe(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter"&&!fa(h))return[new fe(u.key,u.value,'"feature-state" data expressions are not supported with filters.')];if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!Qa(h,["zoom","feature-state"]))return[new fe(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!al(h))return[new fe(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ji(u){const c=u.key,h=u.value,p=u.valueSpec,v=[];return Array.isArray(p.values)?p.values.indexOf(Wn(h))===-1&&v.push(new fe(c,h,`expected one of [${p.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(p.values).indexOf(Wn(h))===-1&&v.push(new fe(c,h,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(h)} found`)),v}function Js(u){return wc(Vi(u.value))?Ri(Tr({},u,{expressionContext:"filter",valueSpec:{value:"boolean"}})):vo(u)}function vo(u){const c=u.value,h=u.key;if(ce(c)!=="array")return[new fe(h,c,`array expected, ${ce(c)} found`)];const p=u.styleSpec;let v,S=[];if(c.length<1)return[new fe(h,c,"filter array must have at least 1 element")];switch(S=S.concat(ji({key:`${h}[0]`,value:c[0],valueSpec:p.filter_operator,style:u.style,styleSpec:u.styleSpec})),Wn(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&Wn(c[1])==="$type"&&S.push(new fe(h,c,`"$type" cannot be use with operator "${c[0]}"`));case"==":case"!=":c.length!==3&&S.push(new fe(h,c,`filter array for operator "${c[0]}" must have 3 elements`));case"in":case"!in":c.length>=2&&(v=ce(c[1]),v!=="string"&&S.push(new fe(`${h}[1]`,c[1],`string expected, ${v} found`)));for(let I=2;I<c.length;I++)v=ce(c[I]),Wn(c[1])==="$type"?S=S.concat(ji({key:`${h}[${I}]`,value:c[I],valueSpec:p.geometry_type,style:u.style,styleSpec:u.styleSpec})):v!=="string"&&v!=="number"&&v!=="boolean"&&S.push(new fe(`${h}[${I}]`,c[I],`string, number, or boolean expected, ${v} found`));break;case"any":case"all":case"none":for(let I=1;I<c.length;I++)S=S.concat(vo({key:`${h}[${I}]`,value:c[I],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":v=ce(c[1]),c.length!==2?S.push(new fe(h,c,`filter array for "${c[0]}" operator must have 2 elements`)):v!=="string"&&S.push(new fe(`${h}[1]`,c[1],`string expected, ${v} found`));break;case"within":v=ce(c[1]),c.length!==2?S.push(new fe(h,c,`filter array for "${c[0]}" operator must have 2 elements`)):v!=="object"&&S.push(new fe(`${h}[1]`,c[1],`object expected, ${v} found`))}return S}function bo(u,c){const h=u.key,p=u.validateSpec,v=u.style,S=u.styleSpec,I=u.value,F=u.objectKey,O=S[`${c}_${u.layerType}`];if(!O)return[];const G=F.match(/^(.*)-transition$/);if(c==="paint"&&G&&O[G[1]]&&O[G[1]].transition)return p({key:h,value:I,valueSpec:S.transition,style:v,styleSpec:S});const K=u.valueSpec||O[F];if(!K)return[new fe(h,I,`unknown property "${F}"`)];let X;if(ce(I)==="string"&&Mt(K)&&!K.tokens&&(X=/^{([^}]+)}$/.exec(I)))return[new fe(h,I,`"${F}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(X[1])} }\`.`)];const nt=[];return u.layerType==="symbol"&&(F==="text-field"&&v&&!v.glyphs&&nt.push(new fe(h,I,'use of "text-field" requires a style "glyphs" property')),F==="text-font"&&Me(Vi(I))&&Wn(I.type)==="identity"&&nt.push(new fe(h,I,'"text-font" does not support identity functions'))),nt.concat(p({key:u.key,value:I,valueSpec:K,style:v,styleSpec:S,expressionContext:"property",propertyType:c,propertyKey:F}))}function Ec(u){return bo(u,"paint")}function Zs(u){return bo(u,"layout")}function _a(u){let c=[];const h=u.value,p=u.key,v=u.style,S=u.styleSpec;h.type||h.ref||c.push(new fe(p,h,'either "type" or "ref" is required'));let I=Wn(h.type);const F=Wn(h.ref);if(h.id){const O=Wn(h.id);for(let G=0;G<u.arrayIndex;G++){const K=v.layers[G];Wn(K.id)===O&&c.push(new fe(p,h.id,`duplicate layer id "${h.id}", previously used at line ${K.id.__line__}`))}}if("ref"in h){let O;["type","source","source-layer","filter","layout"].forEach(G=>{G in h&&c.push(new fe(p,h[G],`"${G}" is prohibited for ref layers`))}),v.layers.forEach(G=>{Wn(G.id)===F&&(O=G)}),O?O.ref?c.push(new fe(p,h.ref,"ref cannot reference another ref layer")):I=Wn(O.type):c.push(new fe(p,h.ref,`ref layer "${F}" not found`))}else if(I!=="background")if(h.source){const O=v.sources&&v.sources[h.source],G=O&&Wn(O.type);O?G==="vector"&&I==="raster"?c.push(new fe(p,h.source,`layer "${h.id}" requires a raster source`)):G!=="raster-dem"&&I==="hillshade"?c.push(new fe(p,h.source,`layer "${h.id}" requires a raster-dem source`)):G==="raster"&&I!=="raster"?c.push(new fe(p,h.source,`layer "${h.id}" requires a vector source`)):G!=="vector"||h["source-layer"]?G==="raster-dem"&&I!=="hillshade"?c.push(new fe(p,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):I!=="line"||!h.paint||!h.paint["line-gradient"]||G==="geojson"&&O.lineMetrics||c.push(new fe(p,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):c.push(new fe(p,h,`layer "${h.id}" must specify a "source-layer"`)):c.push(new fe(p,h.source,`source "${h.source}" not found`))}else c.push(new fe(p,h,'missing required property "source"'));return c=c.concat(Ui({key:p,value:h,valueSpec:S.layer,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*":()=>[],type:()=>u.validateSpec({key:`${p}.type`,value:h.type,valueSpec:S.layer.type,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,object:h,objectKey:"type"}),filter:Js,layout:O=>Ui({layer:h,key:O.key,value:O.value,style:O.style,styleSpec:O.styleSpec,validateSpec:O.validateSpec,objectElementValidators:{"*":G=>Zs(Tr({layerType:I},G))}}),paint:O=>Ui({layer:h,key:O.key,value:O.value,style:O.style,styleSpec:O.styleSpec,validateSpec:O.validateSpec,objectElementValidators:{"*":G=>Ec(Tr({layerType:I},G))}})}})),c}function Wo(u){const c=u.value,h=u.key,p=ce(c);return p!=="string"?[new fe(h,c,`string expected, ${p} found`)]:[]}const Va={promoteId:function(u){let{key:c,value:h}=u;if(ce(h)==="string")return Wo({key:c,value:h});{const p=[];for(const v in h)p.push(...Wo({key:`${c}.${v}`,value:h[v]}));return p}}};function wo(u){const c=u.value,h=u.key,p=u.styleSpec,v=u.style,S=u.validateSpec;if(!c.type)return[new fe(h,c,'"type" is required')];const I=Wn(c.type);let F;switch(I){case"vector":case"raster":return F=Ui({key:h,value:c,valueSpec:p[`source_${I.replace("-","_")}`],style:u.style,styleSpec:p,objectElementValidators:Va,validateSpec:S}),F;case"raster-dem":return F=function(O){var G;const K=(G=O.sourceName)!==null&&G!==void 0?G:"",X=O.value,nt=O.styleSpec,at=nt.source_raster_dem,ut=O.style;let Bt=[];const It=ce(X);if(X===void 0)return Bt;if(It!=="object")return Bt.push(new fe("source_raster_dem",X,`object expected, ${It} found`)),Bt;const kt=Wn(X.encoding)==="custom",ee=["redFactor","greenFactor","blueFactor","baseShift"],Ht=O.value.encoding?`"${O.value.encoding}"`:"Default";for(const Kt in X)!kt&&ee.includes(Kt)?Bt.push(new fe(Kt,X[Kt],`In "${K}": "${Kt}" is only valid when "encoding" is set to "custom". ${Ht} encoding found`)):at[Kt]?Bt=Bt.concat(O.validateSpec({key:Kt,value:X[Kt],valueSpec:at[Kt],validateSpec:O.validateSpec,style:ut,styleSpec:nt})):Bt.push(new fe(Kt,X[Kt],`unknown property "${Kt}"`));return Bt}({sourceName:h,value:c,style:u.style,styleSpec:p,validateSpec:S}),F;case"geojson":if(F=Ui({key:h,value:c,valueSpec:p.source_geojson,style:v,styleSpec:p,validateSpec:S,objectElementValidators:Va}),c.cluster)for(const O in c.clusterProperties){const[G,K]=c.clusterProperties[O],X=typeof G=="string"?[G,["accumulated"],["get",O]]:G;F.push(...Ri({key:`${h}.${O}.map`,value:K,validateSpec:S,expressionContext:"cluster-map"})),F.push(...Ri({key:`${h}.${O}.reduce`,value:X,validateSpec:S,expressionContext:"cluster-reduce"}))}return F;case"video":return Ui({key:h,value:c,valueSpec:p.source_video,style:v,validateSpec:S,styleSpec:p});case"image":return Ui({key:h,value:c,valueSpec:p.source_image,style:v,validateSpec:S,styleSpec:p});case"canvas":return[new fe(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ji({key:`${h}.type`,value:c.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:v,validateSpec:S,styleSpec:p})}}function va(u){const c=u.value,h=u.styleSpec,p=h.light,v=u.style;let S=[];const I=ce(c);if(c===void 0)return S;if(I!=="object")return S=S.concat([new fe("light",c,`object expected, ${I} found`)]),S;for(const F in c){const O=F.match(/^(.*)-transition$/);S=S.concat(O&&p[O[1]]&&p[O[1]].transition?u.validateSpec({key:F,value:c[F],valueSpec:h.transition,validateSpec:u.validateSpec,style:v,styleSpec:h}):p[F]?u.validateSpec({key:F,value:c[F],valueSpec:p[F],validateSpec:u.validateSpec,style:v,styleSpec:h}):[new fe(F,c[F],`unknown property "${F}"`)])}return S}function Sc(u){const c=u.value,h=u.styleSpec,p=h.sky,v=u.style,S=ce(c);if(c===void 0)return[];if(S!=="object")return[new fe("sky",c,`object expected, ${S} found`)];let I=[];for(const F in c)I=I.concat(p[F]?Ns({key:F,value:c[F],valueSpec:p[F],style:v,styleSpec:h}):[new fe(F,c[F],`unknown property "${F}"`)]);return I}function ba(u){const c=u.value,h=u.styleSpec,p=h.terrain,v=u.style;let S=[];const I=ce(c);if(c===void 0)return S;if(I!=="object")return S=S.concat([new fe("terrain",c,`object expected, ${I} found`)]),S;for(const F in c)S=S.concat(p[F]?u.validateSpec({key:F,value:c[F],valueSpec:p[F],validateSpec:u.validateSpec,style:v,styleSpec:h}):[new fe(F,c[F],`unknown property "${F}"`)]);return S}function $o(u){let c=[];const h=u.value,p=u.key;if(Array.isArray(h)){const v=[],S=[];for(const I in h)h[I].id&&v.includes(h[I].id)&&c.push(new fe(p,h,`all the sprites' ids must be unique, but ${h[I].id} is duplicated`)),v.push(h[I].id),h[I].url&&S.includes(h[I].url)&&c.push(new fe(p,h,`all the sprites' URLs must be unique, but ${h[I].url} is duplicated`)),S.push(h[I].url),c=c.concat(Ui({key:`${p}[${I}]`,value:h[I],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:u.validateSpec}));return c}return Wo({key:p,value:h})}const Bi={"*":()=>[],array:Zu,boolean:function(u){const c=u.value,h=u.key,p=ce(c);return p!=="boolean"?[new fe(h,c,`boolean expected, ${p} found`)]:[]},number:lu,color:function(u){const c=u.key,h=u.value,p=ce(h);return p!=="string"?[new fe(c,h,`color expected, ${p} found`)]:xr.parse(String(h))?[]:[new fe(c,h,`color expected, "${h}" found`)]},constants:cu,enum:ji,filter:Js,function:Ga,layer:_a,object:Ui,source:wo,light:va,sky:Sc,terrain:ba,string:Wo,formatted:function(u){return Wo(u).length===0?[]:Ri(u)},resolvedImage:function(u){return Wo(u).length===0?[]:Ri(u)},padding:function(u){const c=u.key,h=u.value;if(ce(h)==="array"){if(h.length<1||h.length>4)return[new fe(c,h,`padding requires 1 to 4 values; ${h.length} values found`)];const p={type:"number"};let v=[];for(let S=0;S<h.length;S++)v=v.concat(u.validateSpec({key:`${c}[${S}]`,value:h[S],validateSpec:u.validateSpec,valueSpec:p}));return v}return lu({key:c,value:h,valueSpec:{}})},variableAnchorOffsetCollection:function(u){const c=u.key,h=u.value,p=ce(h),v=u.styleSpec;if(p!=="array"||h.length<1||h.length%2!=0)return[new fe(c,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let S=[];for(let I=0;I<h.length;I+=2)S=S.concat(ji({key:`${c}[${I}]`,value:h[I],valueSpec:v.layout_symbol["text-anchor"]})),S=S.concat(Zu({key:`${c}[${I+1}]`,value:h[I+1],valueSpec:{length:2,value:"number"},validateSpec:u.validateSpec,style:u.style,styleSpec:v}));return S},sprite:$o};function Ns(u){const c=u.value,h=u.valueSpec,p=u.styleSpec;return u.validateSpec=Ns,h.expression&&Me(Wn(c))?Ga(u):h.expression&&$r(Vi(c))?Ri(u):h.type&&Bi[h.type]?Bi[h.type](u):Ui(Tr({},u,{valueSpec:h.type?p[h.type]:h}))}function Qs(u){const c=u.value,h=u.key,p=Wo(u);return p.length||(c.indexOf("{fontstack}")===-1&&p.push(new fe(h,c,'"glyphs" url must include a "{fontstack}" token')),c.indexOf("{range}")===-1&&p.push(new fe(h,c,'"glyphs" url must include a "{range}" token'))),p}function Oi(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yt,h=[];return h=h.concat(Ns({key:"",value:u,valueSpec:c.$root,styleSpec:c,style:u,validateSpec:Ns,objectElementValidators:{glyphs:Qs,"*":()=>[]}})),u.constants&&(h=h.concat(cu({key:"constants",value:u.constants,style:u,styleSpec:c,validateSpec:Ns}))),In(h)}function _n(u){return function(c){return u({...c,validateSpec:Ns})}}function In(u){return[].concat(u).sort((c,h)=>c.line-h.line)}function Ln(u){return function(){for(var c=arguments.length,h=new Array(c),p=0;p<c;p++)h[p]=arguments[p];return In(u.apply(this,h))}}Oi.source=Ln(_n(wo)),Oi.sprite=Ln(_n($o)),Oi.glyphs=Ln(_n(Qs)),Oi.light=Ln(_n(va)),Oi.sky=Ln(_n(Sc)),Oi.terrain=Ln(_n(ba)),Oi.layer=Ln(_n(_a)),Oi.filter=Ln(_n(Js)),Oi.paintProperty=Ln(_n(Ec)),Oi.layoutProperty=Ln(_n(Zs));const Zn=Oi,ja=Zn.light,wa=Zn.paintProperty,uu=Zn.layoutProperty;function qa(u,c){let h=!1;if(c&&c.length)for(const p of c)u.fire(new ge(new Error(p.message))),h=!0;return h}class Au{constructor(c,h,p){const v=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;const I=new Int32Array(this.arrayBuffer);c=I[0],this.d=(h=I[1])+2*(p=I[2]);for(let O=0;O<this.d*this.d;O++){const G=I[3+O],K=I[3+O+1];v.push(G===K?null:I.subarray(G,K))}const F=I[3+v.length+1];this.keys=I.subarray(I[3+v.length],F),this.bboxes=I.subarray(F),this.insert=this._insertReadonly}else{this.d=h+2*p;for(let I=0;I<this.d*this.d;I++)v.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=c,this.padding=p,this.scale=h/c,this.uid=0;const S=p/h*c;this.min=-S,this.max=c+S}insert(c,h,p,v,S){this._forEachCell(h,p,v,S,this._insertCell,this.uid++,void 0,void 0),this.keys.push(c),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(S)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(c,h,p,v,S,I){this.cells[S].push(I)}query(c,h,p,v,S){const I=this.min,F=this.max;if(c<=I&&h<=I&&F<=p&&F<=v&&!S)return Array.prototype.slice.call(this.keys);{const O=[];return this._forEachCell(c,h,p,v,this._queryCell,O,{},S),O}}_queryCell(c,h,p,v,S,I,F,O){const G=this.cells[S];if(G!==null){const K=this.keys,X=this.bboxes;for(let nt=0;nt<G.length;nt++){const at=G[nt];if(F[at]===void 0){const ut=4*at;(O?O(X[ut+0],X[ut+1],X[ut+2],X[ut+3]):c<=X[ut+2]&&h<=X[ut+3]&&p>=X[ut+0]&&v>=X[ut+1])?(F[at]=!0,I.push(K[at])):F[at]=!1}}}}_forEachCell(c,h,p,v,S,I,F,O){const G=this._convertToCellCoord(c),K=this._convertToCellCoord(h),X=this._convertToCellCoord(p),nt=this._convertToCellCoord(v);for(let at=G;at<=X;at++)for(let ut=K;ut<=nt;ut++){const Bt=this.d*ut+at;if((!O||O(this._convertFromCellCoord(at),this._convertFromCellCoord(ut),this._convertFromCellCoord(at+1),this._convertFromCellCoord(ut+1)))&&S.call(this,c,h,p,v,Bt,I,F,O))return}}_convertFromCellCoord(c){return(c-this.padding)/this.scale}_convertToCellCoord(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const c=this.cells,h=3+this.cells.length+1+1;let p=0;for(let I=0;I<this.cells.length;I++)p+=this.cells[I].length;const v=new Int32Array(h+p+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;let S=h;for(let I=0;I<c.length;I++){const F=c[I];v[3+I]=S,v.set(F,S),S+=F.length}return v[3+c.length]=S,v.set(this.keys,S),S+=this.keys.length,v[3+c.length+1]=S,v.set(this.bboxes,S),S+=this.bboxes.length,v.buffer}static serialize(c,h){const p=c.toArrayBuffer();return h&&h.push(p),{buffer:p}}static deserialize(c){return new Au(c.buffer)}}const Xo={};function Ze(u,c){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Xo[u])throw new Error(`${u} is already registered.`);Object.defineProperty(c,"_classRegistryKey",{value:u,writeable:!1}),Xo[u]={klass:c,omit:h.omit||[],shallow:h.shallow||[]}}Ze("Object",Object),Ze("TransferableGridIndex",Au),Ze("Color",xr),Ze("Error",Error),Ze("AJAXError",ae),Ze("ResolvedImage",os),Ze("StylePropertyFunction",dl),Ze("StyleExpression",qr,{omit:["_evaluator"]}),Ze("ZoomDependentExpression",ks),Ze("ZoomConstantExpression",Ds),Ze("CompoundExpression",yi,{omit:["_evaluate"]});for(const u in qo)qo[u]._classRegistryKey||Ze(`Expression_${u}`,qo[u]);function tA(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function ml(u,c){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob||u instanceof Error)return u;if(tA(u)||Xt(u))return c&&c.push(u),u;if(ArrayBuffer.isView(u)){const h=u;return c&&c.push(h.buffer),h}if(u instanceof ImageData)return c&&c.push(u.data.buffer),u;if(Array.isArray(u)){const h=[];for(const p of u)h.push(ml(p,c));return h}if(typeof u=="object"){const h=u.constructor,p=h._classRegistryKey;if(!p)throw new Error(`can't serialize object of unregistered class ${h.name}`);if(!Xo[p])throw new Error(`${p} is not registered.`);const v=h.serialize?h.serialize(u,c):{};if(h.serialize){if(c&&v===c[c.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const S in u){if(!u.hasOwnProperty(S)||Xo[p].omit.indexOf(S)>=0)continue;const I=u[S];v[S]=Xo[p].shallow.indexOf(S)>=0?I:ml(I,c)}u instanceof Error&&(v.message=u.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return p!=="Object"&&(v.$name=p),v}throw new Error("can't serialize object of type "+typeof u)}function yl(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob||u instanceof Error||tA(u)||Xt(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(yl);if(typeof u=="object"){const c=u.$name||"Object";if(!Xo[c])throw new Error(`can't deserialize unregistered class ${c}`);const{klass:h}=Xo[c];if(!h)throw new Error(`can't deserialize unregistered class ${c}`);if(h.deserialize)return h.deserialize(u);const p=Object.create(h.prototype);for(const v of Object.keys(u)){if(v==="$name")continue;const S=u[v];p[v]=Xo[c].shallow.indexOf(v)>=0?S:yl(S)}return p}throw new Error("can't deserialize object of type "+typeof u)}class eh{constructor(){this.first=!0}update(c,h){const p=Math.floor(c);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=c,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=h),c!==this.lastZoom&&(this.lastZoom=c,this.lastFloorZoom=p,!0))}}const je={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519};function qi(u){for(const c of u)if(_l(c.charCodeAt(0)))return!0;return!1}function to(u){for(const c of u)if(!eA(c.charCodeAt(0)))return!1;return!0}function eA(u){return!(je.Arabic(u)||je["Arabic Supplement"](u)||je["Arabic Extended-A"](u)||je["Arabic Presentation Forms-A"](u)||je["Arabic Presentation Forms-B"](u))}function _l(u){return!(u!==746&&u!==747&&(u<4352||!(je["Bopomofo Extended"](u)||je.Bopomofo(u)||je["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||je["CJK Compatibility Ideographs"](u)||je["CJK Compatibility"](u)||je["CJK Radicals Supplement"](u)||je["CJK Strokes"](u)||!(!je["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||je["CJK Unified Ideographs Extension A"](u)||je["CJK Unified Ideographs"](u)||je["Enclosed CJK Letters and Months"](u)||je["Hangul Compatibility Jamo"](u)||je["Hangul Jamo Extended-A"](u)||je["Hangul Jamo Extended-B"](u)||je["Hangul Jamo"](u)||je["Hangul Syllables"](u)||je.Hiragana(u)||je["Ideographic Description Characters"](u)||je.Kanbun(u)||je["Kangxi Radicals"](u)||je["Katakana Phonetic Extensions"](u)||je.Katakana(u)&&u!==12540||!(!je["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!je["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||je["Unified Canadian Aboriginal Syllabics"](u)||je["Unified Canadian Aboriginal Syllabics Extended"](u)||je["Vertical Forms"](u)||je["Yijing Hexagram Symbols"](u)||je["Yi Syllables"](u)||je["Yi Radicals"](u))))}function rh(u){return!(_l(u)||function(c){return!!(je["Latin-1 Supplement"](c)&&(c===167||c===169||c===174||c===177||c===188||c===189||c===190||c===215||c===247)||je["General Punctuation"](c)&&(c===8214||c===8224||c===8225||c===8240||c===8241||c===8251||c===8252||c===8258||c===8263||c===8264||c===8265||c===8273)||je["Letterlike Symbols"](c)||je["Number Forms"](c)||je["Miscellaneous Technical"](c)&&(c>=8960&&c<=8967||c>=8972&&c<=8991||c>=8996&&c<=9e3||c===9003||c>=9085&&c<=9114||c>=9150&&c<=9165||c===9167||c>=9169&&c<=9179||c>=9186&&c<=9215)||je["Control Pictures"](c)&&c!==9251||je["Optical Character Recognition"](c)||je["Enclosed Alphanumerics"](c)||je["Geometric Shapes"](c)||je["Miscellaneous Symbols"](c)&&!(c>=9754&&c<=9759)||je["Miscellaneous Symbols and Arrows"](c)&&(c>=11026&&c<=11055||c>=11088&&c<=11097||c>=11192&&c<=11243)||je["CJK Symbols and Punctuation"](c)||je.Katakana(c)||je["Private Use Area"](c)||je["CJK Compatibility Forms"](c)||je["Small Form Variants"](c)||je["Halfwidth and Fullwidth Forms"](c)||c===8734||c===8756||c===8757||c>=9984&&c<=10087||c>=10102&&c<=10131||c===65532||c===65533)}(u))}function vl(u){return u>=1424&&u<=2303||je["Arabic Presentation Forms-A"](u)||je["Arabic Presentation Forms-B"](u)}function rA(u,c){return!(!c&&vl(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||je.Khmer(u))}function dd(u){for(const c of u)if(vl(c.charCodeAt(0)))return!0;return!1}const Ka=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(u){this.pluginStatus=u.pluginStatus,this.pluginURL=u.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(u){this.applyArabicShaping=u.applyArabicShaping,this.processBidirectionalText=u.processBidirectionalText,this.processStyledBidirectionalText=u.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Hn{constructor(c,h){this.zoom=c,h?(this.now=h.now,this.fadeDuration=h.fadeDuration,this.zoomHistory=h.zoomHistory,this.transition=h.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new eh,this.transition={})}isSupportedScript(c){return function(h,p){for(const v of h)if(!rA(v.charCodeAt(0),p))return!1;return!0}(c,Ka.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const c=this.zoom,h=c-Math.floor(c),p=this.crossFadingFactor();return c>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*h}}}class bl{constructor(c,h){this.property=c,this.value=h,this.expression=function(p,v){if(Me(p))return new dl(p,v);if($r(p)){const S=ya(p,v);if(S.result==="error")throw new Error(S.value.map(I=>`${I.key}: ${I.message}`).join(", "));return S.value}{let S=p;return v.type==="color"&&typeof p=="string"?S=xr.parse(p):v.type!=="padding"||typeof p!="number"&&!Array.isArray(p)?v.type==="variableAnchorOffsetCollection"&&Array.isArray(p)&&(S=Xn.parse(p)):S=nn.parse(p),{kind:"constant",evaluate:()=>S}}}(h===void 0?c.specification.default:h,c.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(c,h,p){return this.property.possiblyEvaluate(this,c,h,p)}}class wl{constructor(c){this.property=c,this.value=new bl(c,void 0)}transitioned(c,h){return new ip(this.property,this.value,h,mt({},c.transition,this.transition),c.now)}untransitioned(){return new ip(this.property,this.value,null,{},0)}}class nA{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitionablePropertyValues)}getValue(c){return st(this._values[c].value.value)}setValue(c,h){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new wl(this._values[c].property)),this._values[c].value=new bl(this._values[c].property,h===null?void 0:st(h))}getTransition(c){return st(this._values[c].transition)}setTransition(c,h){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new wl(this._values[c].property)),this._values[c].transition=st(h)||void 0}serialize(){const c={};for(const h of Object.keys(this._values)){const p=this.getValue(h);p!==void 0&&(c[h]=p);const v=this.getTransition(h);v!==void 0&&(c[`${h}-transition`]=v)}return c}transitioned(c,h){const p=new sp(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].transitioned(c,h._values[v]);return p}untransitioned(){const c=new sp(this._properties);for(const h of Object.keys(this._values))c._values[h]=this._values[h].untransitioned();return c}}class ip{constructor(c,h,p,v,S){this.property=c,this.value=h,this.begin=S+v.delay||0,this.end=this.begin+v.duration||0,c.specification.transition&&(v.delay||v.duration)&&(this.prior=p)}possiblyEvaluate(c,h,p){const v=c.now||0,S=this.value.possiblyEvaluate(c,h,p),I=this.prior;if(I){if(v>this.end)return this.prior=null,S;if(this.value.isDataDriven())return this.prior=null,S;if(v<this.begin)return I.possiblyEvaluate(c,h,p);{const F=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(I.possiblyEvaluate(c,h,p),S,function(O){if(O<=0)return 0;if(O>=1)return 1;const G=O*O,K=G*O;return 4*(O<.5?K:3*(O-G)+K-.75)}(F))}}return S}}class sp{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitioningPropertyValues)}possiblyEvaluate(c,h,p){const v=new iA(this._properties);for(const S of Object.keys(this._values))v._values[S]=this._values[S].possiblyEvaluate(c,h,p);return v}hasTransition(){for(const c of Object.keys(this._values))if(this._values[c].prior)return!0;return!1}}class fd{constructor(c){this._properties=c,this._values=Object.create(c.defaultPropertyValues)}hasValue(c){return this._values[c].value!==void 0}getValue(c){return st(this._values[c].value)}setValue(c,h){this._values[c]=new bl(this._values[c].property,h===null?void 0:st(h))}serialize(){const c={};for(const h of Object.keys(this._values)){const p=this.getValue(h);p!==void 0&&(c[h]=p)}return c}possiblyEvaluate(c,h,p){const v=new iA(this._properties);for(const S of Object.keys(this._values))v._values[S]=this._values[S].possiblyEvaluate(c,h,p);return v}}class Yo{constructor(c,h,p){this.property=c,this.value=h,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(c){return this.value.kind==="constant"?this.value.value:c}evaluate(c,h,p,v){return this.property.evaluate(this.value,this.parameters,c,h,p,v)}}class iA{constructor(c){this._properties=c,this._values=Object.create(c.defaultPossiblyEvaluatedValues)}get(c){return this._values[c]}}class hr{constructor(c){this.specification=c}possiblyEvaluate(c,h){if(c.isDataDriven())throw new Error("Value should not be data driven");return c.expression.evaluate(h)}interpolate(c,h,p){const v=Pi[this.specification.type];return v?v(c,h,p):c}}class br{constructor(c,h){this.specification=c,this.overrides=h}possiblyEvaluate(c,h,p,v){return new Yo(this,c.expression.kind==="constant"||c.expression.kind==="camera"?{kind:"constant",value:c.expression.evaluate(h,null,{},p,v)}:c.expression,h)}interpolate(c,h,p){if(c.value.kind!=="constant"||h.value.kind!=="constant")return c;if(c.value.value===void 0||h.value.value===void 0)return new Yo(this,{kind:"constant",value:void 0},c.parameters);const v=Pi[this.specification.type];if(v){const S=v(c.value.value,h.value.value,p);return new Yo(this,{kind:"constant",value:S},c.parameters)}return c}evaluate(c,h,p,v,S,I){return c.kind==="constant"?c.value:c.evaluate(h,p,v,S,I)}}class nh extends br{possiblyEvaluate(c,h,p,v){if(c.value===void 0)return new Yo(this,{kind:"constant",value:void 0},h);if(c.expression.kind==="constant"){const S=c.expression.evaluate(h,null,{},p,v),I=c.property.specification.type==="resolvedImage"&&typeof S!="string"?S.name:S,F=this._calculate(I,I,I,h);return new Yo(this,{kind:"constant",value:F},h)}if(c.expression.kind==="camera"){const S=this._calculate(c.expression.evaluate({zoom:h.zoom-1}),c.expression.evaluate({zoom:h.zoom}),c.expression.evaluate({zoom:h.zoom+1}),h);return new Yo(this,{kind:"constant",value:S},h)}return new Yo(this,c.expression,h)}evaluate(c,h,p,v,S,I){if(c.kind==="source"){const F=c.evaluate(h,p,v,S,I);return this._calculate(F,F,F,h)}return c.kind==="composite"?this._calculate(c.evaluate({zoom:Math.floor(h.zoom)-1},p,v),c.evaluate({zoom:Math.floor(h.zoom)},p,v),c.evaluate({zoom:Math.floor(h.zoom)+1},p,v),h):c.value}_calculate(c,h,p,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:c,to:h}:{from:p,to:h}}interpolate(c){return c}}class xl{constructor(c){this.specification=c}possiblyEvaluate(c,h,p,v){if(c.value!==void 0){if(c.expression.kind==="constant"){const S=c.expression.evaluate(h,null,{},p,v);return this._calculate(S,S,S,h)}return this._calculate(c.expression.evaluate(new Hn(Math.floor(h.zoom-1),h)),c.expression.evaluate(new Hn(Math.floor(h.zoom),h)),c.expression.evaluate(new Hn(Math.floor(h.zoom+1),h)),h)}}_calculate(c,h,p,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:c,to:h}:{from:p,to:h}}interpolate(c){return c}}class sA{constructor(c){this.specification=c}possiblyEvaluate(c,h,p,v){return!!c.expression.evaluate(h,null,{},p,v)}interpolate(){return!1}}class Ki{constructor(c){this.properties=c,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in c){const p=c[h];p.specification.overridable&&this.overridableProperties.push(h);const v=this.defaultPropertyValues[h]=new bl(p,void 0),S=this.defaultTransitionablePropertyValues[h]=new wl(p);this.defaultTransitioningPropertyValues[h]=S.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=v.possiblyEvaluate({})}}}Ze("DataDrivenProperty",br),Ze("DataConstantProperty",hr),Ze("CrossFadedDataDrivenProperty",nh),Ze("CrossFadedProperty",xl),Ze("ColorRampProperty",sA);const pd="-transition";class Jo extends Ut{constructor(c,h){if(super(),this.id=c.id,this.type=c.type,this._featureFilter={filter:()=>!0,needGeometry:!1},c.type!=="custom"&&(this.metadata=c.metadata,this.minzoom=c.minzoom,this.maxzoom=c.maxzoom,c.type!=="background"&&(this.source=c.source,this.sourceLayer=c["source-layer"],this.filter=c.filter),h.layout&&(this._unevaluatedLayout=new fd(h.layout)),h.paint)){this._transitionablePaint=new nA(h.paint);for(const p in c.paint)this.setPaintProperty(p,c.paint[p],{validate:!1});for(const p in c.layout)this.setLayoutProperty(p,c.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new iA(h.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(c){return c==="visibility"?this.visibility:this._unevaluatedLayout.getValue(c)}setLayoutProperty(c,h){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};h!=null&&this._validate(uu,`layers.${this.id}.layout.${c}`,c,h,p)||(c!=="visibility"?this._unevaluatedLayout.setValue(c,h):this.visibility=h)}getPaintProperty(c){return c.endsWith(pd)?this._transitionablePaint.getTransition(c.slice(0,-11)):this._transitionablePaint.getValue(c)}setPaintProperty(c,h){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(h!=null&&this._validate(wa,`layers.${this.id}.paint.${c}`,c,h,p))return!1;if(c.endsWith(pd))return this._transitionablePaint.setTransition(c.slice(0,-11),h||void 0),!1;{const v=this._transitionablePaint._values[c],S=v.property.specification["property-type"]==="cross-faded-data-driven",I=v.value.isDataDriven(),F=v.value;this._transitionablePaint.setValue(c,h),this._handleSpecialPaintPropertyUpdate(c);const O=this._transitionablePaint._values[c].value;return O.isDataDriven()||I||S||this._handleOverridablePaintPropertyUpdate(c,F,O)}}_handleSpecialPaintPropertyUpdate(c){}_handleOverridablePaintPropertyUpdate(c,h,p){return!1}isHidden(c){return!!(this.minzoom&&c<this.minzoom)||!!(this.maxzoom&&c>=this.maxzoom)||this.visibility==="none"}updateTransitions(c){this._transitioningPaint=this._transitionablePaint.transitioned(c,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(c,h){c.getCrossfadeParameters&&(this._crossfadeParameters=c.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(c,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(c,void 0,h)}serialize(){const c={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(c.layout=c.layout||{},c.layout.visibility=this.visibility),Lt(c,(h,p)=>!(h===void 0||p==="layout"&&!Object.keys(h).length||p==="paint"&&!Object.keys(h).length))}_validate(c,h,p,v){let S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};return(!S||S.validate!==!1)&&qa(this,c.call(Zn,{key:h,layerType:this.type,objectKey:p,value:v,styleSpec:Yt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const c in this.paint._values){const h=this.paint.get(c);if(h instanceof Yo&&Mt(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}const gd={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class oA{constructor(c,h){this._structArray=c,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ai{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(c,h){return c._trim(),h&&(c.isTransferred=!0,h.push(c.arrayBuffer)),{length:c.length,arrayBuffer:c.arrayBuffer}}static deserialize(c){const h=Object.create(this.prototype);return h.arrayBuffer=c.arrayBuffer,h.length=c.length,h.capacity=c.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(c){this.reserve(c),this.length=c}reserve(c){if(c>this.capacity){this.capacity=Math.max(c,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ci(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,h=0,p=0;return{members:u.map(v=>{const S=gd[v.type].BYTES_PER_ELEMENT,I=h=op(h,Math.max(c,S)),F=v.components||1;return p=Math.max(p,S),h+=S*F,{name:v.name,type:v.type,components:F,offset:I}}),size:op(h,Math.max(p,c)),alignment:c}}function op(u,c){return Math.ceil(u/c)*c}class xo extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h){const p=this.length;return this.resize(p+1),this.emplace(p,c,h)}emplace(c,h,p){const v=2*c;return this.int16[v+0]=h,this.int16[v+1]=p,c}}xo.prototype.bytesPerElement=4,Ze("StructArrayLayout2i4",xo);class Di extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,c,h,p)}emplace(c,h,p,v){const S=3*c;return this.int16[S+0]=h,this.int16[S+1]=p,this.int16[S+2]=v,c}}Di.prototype.bytesPerElement=6,Ze("StructArrayLayout3i6",Di);class Zo extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,p,v){const S=this.length;return this.resize(S+1),this.emplace(S,c,h,p,v)}emplace(c,h,p,v,S){const I=4*c;return this.int16[I+0]=h,this.int16[I+1]=p,this.int16[I+2]=v,this.int16[I+3]=S,c}}Zo.prototype.bytesPerElement=8,Ze("StructArrayLayout4i8",Zo);class md extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,p,v,S,I){const F=this.length;return this.resize(F+1),this.emplace(F,c,h,p,v,S,I)}emplace(c,h,p,v,S,I,F){const O=6*c;return this.int16[O+0]=h,this.int16[O+1]=p,this.int16[O+2]=v,this.int16[O+3]=S,this.int16[O+4]=I,this.int16[O+5]=F,c}}md.prototype.bytesPerElement=12,Ze("StructArrayLayout2i4i12",md);class ih extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,p,v,S,I){const F=this.length;return this.resize(F+1),this.emplace(F,c,h,p,v,S,I)}emplace(c,h,p,v,S,I,F){const O=4*c,G=8*c;return this.int16[O+0]=h,this.int16[O+1]=p,this.uint8[G+4]=v,this.uint8[G+5]=S,this.uint8[G+6]=I,this.uint8[G+7]=F,c}}ih.prototype.bytesPerElement=8,Ze("StructArrayLayout2i4ub8",ih);class Bo extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h){const p=this.length;return this.resize(p+1),this.emplace(p,c,h)}emplace(c,h,p){const v=2*c;return this.float32[v+0]=h,this.float32[v+1]=p,c}}Bo.prototype.bytesPerElement=8,Ze("StructArrayLayout2f8",Bo);class Cs extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,p,v,S,I,F,O,G,K){const X=this.length;return this.resize(X+1),this.emplace(X,c,h,p,v,S,I,F,O,G,K)}emplace(c,h,p,v,S,I,F,O,G,K,X){const nt=10*c;return this.uint16[nt+0]=h,this.uint16[nt+1]=p,this.uint16[nt+2]=v,this.uint16[nt+3]=S,this.uint16[nt+4]=I,this.uint16[nt+5]=F,this.uint16[nt+6]=O,this.uint16[nt+7]=G,this.uint16[nt+8]=K,this.uint16[nt+9]=X,c}}Cs.prototype.bytesPerElement=20,Ze("StructArrayLayout10ui20",Cs);class yd extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,p,v,S,I,F,O,G,K,X,nt){const at=this.length;return this.resize(at+1),this.emplace(at,c,h,p,v,S,I,F,O,G,K,X,nt)}emplace(c,h,p,v,S,I,F,O,G,K,X,nt,at){const ut=12*c;return this.int16[ut+0]=h,this.int16[ut+1]=p,this.int16[ut+2]=v,this.int16[ut+3]=S,this.uint16[ut+4]=I,this.uint16[ut+5]=F,this.uint16[ut+6]=O,this.uint16[ut+7]=G,this.int16[ut+8]=K,this.int16[ut+9]=X,this.int16[ut+10]=nt,this.int16[ut+11]=at,c}}yd.prototype.bytesPerElement=24,Ze("StructArrayLayout4i4ui4i24",yd);class _d extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,c,h,p)}emplace(c,h,p,v){const S=3*c;return this.float32[S+0]=h,this.float32[S+1]=p,this.float32[S+2]=v,c}}_d.prototype.bytesPerElement=12,Ze("StructArrayLayout3f12",_d);class xa extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c){const h=this.length;return this.resize(h+1),this.emplace(h,c)}emplace(c,h){return this.uint32[1*c+0]=h,c}}xa.prototype.bytesPerElement=4,Ze("StructArrayLayout1ul4",xa);class aA extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,p,v,S,I,F,O,G){const K=this.length;return this.resize(K+1),this.emplace(K,c,h,p,v,S,I,F,O,G)}emplace(c,h,p,v,S,I,F,O,G,K){const X=10*c,nt=5*c;return this.int16[X+0]=h,this.int16[X+1]=p,this.int16[X+2]=v,this.int16[X+3]=S,this.int16[X+4]=I,this.int16[X+5]=F,this.uint32[nt+3]=O,this.uint16[X+8]=G,this.uint16[X+9]=K,c}}aA.prototype.bytesPerElement=20,Ze("StructArrayLayout6i1ul2ui20",aA);class hu extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,p,v,S,I){const F=this.length;return this.resize(F+1),this.emplace(F,c,h,p,v,S,I)}emplace(c,h,p,v,S,I,F){const O=6*c;return this.int16[O+0]=h,this.int16[O+1]=p,this.int16[O+2]=v,this.int16[O+3]=S,this.int16[O+4]=I,this.int16[O+5]=F,c}}hu.prototype.bytesPerElement=12,Ze("StructArrayLayout2i2i2i12",hu);class cA extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,p,v,S){const I=this.length;return this.resize(I+1),this.emplace(I,c,h,p,v,S)}emplace(c,h,p,v,S,I){const F=4*c,O=8*c;return this.float32[F+0]=h,this.float32[F+1]=p,this.float32[F+2]=v,this.int16[O+6]=S,this.int16[O+7]=I,c}}cA.prototype.bytesPerElement=16,Ze("StructArrayLayout2f1f2i16",cA);class lA extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,p,v){const S=this.length;return this.resize(S+1),this.emplace(S,c,h,p,v)}emplace(c,h,p,v,S){const I=12*c,F=3*c;return this.uint8[I+0]=h,this.uint8[I+1]=p,this.float32[F+1]=v,this.float32[F+2]=S,c}}lA.prototype.bytesPerElement=12,Ze("StructArrayLayout2ub2f12",lA);class Bl extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,c,h,p)}emplace(c,h,p,v){const S=3*c;return this.uint16[S+0]=h,this.uint16[S+1]=p,this.uint16[S+2]=v,c}}Bl.prototype.bytesPerElement=6,Ze("StructArrayLayout3ui6",Bl);class Wa extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,p,v,S,I,F,O,G,K,X,nt,at,ut,Bt,It,kt){const ee=this.length;return this.resize(ee+1),this.emplace(ee,c,h,p,v,S,I,F,O,G,K,X,nt,at,ut,Bt,It,kt)}emplace(c,h,p,v,S,I,F,O,G,K,X,nt,at,ut,Bt,It,kt,ee){const Ht=24*c,Kt=12*c,ve=48*c;return this.int16[Ht+0]=h,this.int16[Ht+1]=p,this.uint16[Ht+2]=v,this.uint16[Ht+3]=S,this.uint32[Kt+2]=I,this.uint32[Kt+3]=F,this.uint32[Kt+4]=O,this.uint16[Ht+10]=G,this.uint16[Ht+11]=K,this.uint16[Ht+12]=X,this.float32[Kt+7]=nt,this.float32[Kt+8]=at,this.uint8[ve+36]=ut,this.uint8[ve+37]=Bt,this.uint8[ve+38]=It,this.uint32[Kt+10]=kt,this.int16[Ht+22]=ee,c}}Wa.prototype.bytesPerElement=48,Ze("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Wa);class ta extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,p,v,S,I,F,O,G,K,X,nt,at,ut,Bt,It,kt,ee,Ht,Kt,ve,be,Je,Ar,$e,Ke,ke,sr){const Ve=this.length;return this.resize(Ve+1),this.emplace(Ve,c,h,p,v,S,I,F,O,G,K,X,nt,at,ut,Bt,It,kt,ee,Ht,Kt,ve,be,Je,Ar,$e,Ke,ke,sr)}emplace(c,h,p,v,S,I,F,O,G,K,X,nt,at,ut,Bt,It,kt,ee,Ht,Kt,ve,be,Je,Ar,$e,Ke,ke,sr,Ve){const Le=32*c,Br=16*c;return this.int16[Le+0]=h,this.int16[Le+1]=p,this.int16[Le+2]=v,this.int16[Le+3]=S,this.int16[Le+4]=I,this.int16[Le+5]=F,this.int16[Le+6]=O,this.int16[Le+7]=G,this.uint16[Le+8]=K,this.uint16[Le+9]=X,this.uint16[Le+10]=nt,this.uint16[Le+11]=at,this.uint16[Le+12]=ut,this.uint16[Le+13]=Bt,this.uint16[Le+14]=It,this.uint16[Le+15]=kt,this.uint16[Le+16]=ee,this.uint16[Le+17]=Ht,this.uint16[Le+18]=Kt,this.uint16[Le+19]=ve,this.uint16[Le+20]=be,this.uint16[Le+21]=Je,this.uint16[Le+22]=Ar,this.uint32[Br+12]=$e,this.float32[Br+13]=Ke,this.float32[Br+14]=ke,this.uint16[Le+30]=sr,this.uint16[Le+31]=Ve,c}}ta.prototype.bytesPerElement=64,Ze("StructArrayLayout8i15ui1ul2f2ui64",ta);class du extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c){const h=this.length;return this.resize(h+1),this.emplace(h,c)}emplace(c,h){return this.float32[1*c+0]=h,c}}du.prototype.bytesPerElement=4,Ze("StructArrayLayout1f4",du);class uA extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,c,h,p)}emplace(c,h,p,v){const S=3*c;return this.uint16[6*c+0]=h,this.float32[S+1]=p,this.float32[S+2]=v,c}}uA.prototype.bytesPerElement=12,Ze("StructArrayLayout1ui2f12",uA);class Cl extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,c,h,p)}emplace(c,h,p,v){const S=4*c;return this.uint32[2*c+0]=h,this.uint16[S+2]=p,this.uint16[S+3]=v,c}}Cl.prototype.bytesPerElement=8,Ze("StructArrayLayout1ul2ui8",Cl);class sh extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h){const p=this.length;return this.resize(p+1),this.emplace(p,c,h)}emplace(c,h,p){const v=2*c;return this.uint16[v+0]=h,this.uint16[v+1]=p,c}}sh.prototype.bytesPerElement=4,Ze("StructArrayLayout2ui4",sh);class vd extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c){const h=this.length;return this.resize(h+1),this.emplace(h,c)}emplace(c,h){return this.uint16[1*c+0]=h,c}}vd.prototype.bytesPerElement=2,Ze("StructArrayLayout1ui2",vd);class oh extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,p,v){const S=this.length;return this.resize(S+1),this.emplace(S,c,h,p,v)}emplace(c,h,p,v,S){const I=4*c;return this.float32[I+0]=h,this.float32[I+1]=p,this.float32[I+2]=v,this.float32[I+3]=S,c}}oh.prototype.bytesPerElement=16,Ze("StructArrayLayout4f16",oh);class ap extends oA{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new b(this.anchorPointX,this.anchorPointY)}}ap.prototype.size=20;class B extends aA{get(c){return new ap(this,c)}}Ze("CollisionBoxArray",B);class l extends oA{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(c){this._structArray.uint8[this._pos1+37]=c}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(c){this._structArray.uint8[this._pos1+38]=c}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(c){this._structArray.uint32[this._pos4+10]=c}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}l.prototype.size=48;class d extends Wa{get(c){return new l(this,c)}}Ze("PlacedSymbolArray",d);class y extends oA{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(c){this._structArray.uint32[this._pos4+12]=c}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}y.prototype.size=64;class _ extends ta{get(c){return new y(this,c)}}Ze("SymbolInstanceArray",_);class E extends du{getoffsetX(c){return this.float32[1*c+0]}}Ze("GlyphOffsetArray",E);class P extends Di{getx(c){return this.int16[3*c+0]}gety(c){return this.int16[3*c+1]}gettileUnitDistanceFromAnchor(c){return this.int16[3*c+2]}}Ze("SymbolLineVertexArray",P);class R extends oA{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}R.prototype.size=12;class g extends uA{get(c){return new R(this,c)}}Ze("TextAnchorOffsetArray",g);class w extends oA{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}w.prototype.size=8;class T extends Cl{get(c){return new w(this,c)}}Ze("FeatureIndexArray",T);class L extends xo{}class D extends xo{}class H extends xo{}class z extends md{}class j extends ih{}class V extends Bo{}class $ extends Cs{}class lt extends yd{}class rt extends _d{}class ht extends xa{}class gt extends hu{}class Pt extends lA{}class Tt extends Bl{}class _t extends sh{}const bt=Ci([{name:"a_pos",components:2,type:"Int16"}],4),{members:Gt}=bt;class $t{constructor(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.segments=c}prepareSegment(c,h,p,v){let S=this.segments[this.segments.length-1];return c>$t.MAX_VERTEX_ARRAY_LENGTH&&wt(`Max vertices per segment is ${$t.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${c}`),(!S||S.vertexLength+c>$t.MAX_VERTEX_ARRAY_LENGTH||S.sortKey!==v)&&(S={vertexOffset:h.length,primitiveOffset:p.length,vertexLength:0,primitiveLength:0},v!==void 0&&(S.sortKey=v),this.segments.push(S)),S}get(){return this.segments}destroy(){for(const c of this.segments)for(const h in c.vaos)c.vaos[h].destroy()}static simpleSegment(c,h,p,v){return new $t([{vertexOffset:c,primitiveOffset:h,vertexLength:p,primitiveLength:v,vaos:{},sortKey:0}])}}function ue(u,c){return 256*(u=ft(Math.floor(u),0,255))+ft(Math.floor(c),0,255)}$t.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ze("SegmentVector",$t);const Ae=Ci([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ye={exports:{}},Re={exports:{}};Re.exports=function(u,c){var h,p,v,S,I,F,O,G;for(p=u.length-(h=3&u.length),v=c,I=3432918353,F=461845907,G=0;G<p;)O=255&u.charCodeAt(G)|(255&u.charCodeAt(++G))<<8|(255&u.charCodeAt(++G))<<16|(255&u.charCodeAt(++G))<<24,++G,v=27492+(65535&(S=5*(65535&(v=(v^=O=(65535&(O=(O=(65535&O)*I+(((O>>>16)*I&65535)<<16)&4294967295)<<15|O>>>17))*F+(((O>>>16)*F&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(O=0,h){case 3:O^=(255&u.charCodeAt(G+2))<<16;case 2:O^=(255&u.charCodeAt(G+1))<<8;case 1:v^=O=(65535&(O=(O=(65535&(O^=255&u.charCodeAt(G)))*I+(((O>>>16)*I&65535)<<16)&4294967295)<<15|O>>>17))*F+(((O>>>16)*F&65535)<<16)&4294967295}return v^=u.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0};var Ce=Re.exports,We={exports:{}};We.exports=function(u,c){for(var h,p=u.length,v=c^p,S=0;p>=4;)h=1540483477*(65535&(h=255&u.charCodeAt(S)|(255&u.charCodeAt(++S))<<8|(255&u.charCodeAt(++S))<<16|(255&u.charCodeAt(++S))<<24))+((1540483477*(h>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),p-=4,++S;switch(p){case 3:v^=(255&u.charCodeAt(S+2))<<16;case 2:v^=(255&u.charCodeAt(S+1))<<8;case 1:v=1540483477*(65535&(v^=255&u.charCodeAt(S)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0};var rr=Ce,er=We.exports;ye.exports=rr,ye.exports.murmur3=rr,ye.exports.murmur2=er;var Er=A(ye.exports);class Lr{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(c,h,p,v){this.ids.push(Zr(c)),this.positions.push(h,p,v)}getPositions(c){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=Zr(c);let p=0,v=this.ids.length-1;for(;p<v;){const I=p+v>>1;this.ids[I]>=h?v=I:p=I+1}const S=[];for(;this.ids[p]===h;)S.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return S}static serialize(c,h){const p=new Float64Array(c.ids),v=new Uint32Array(c.positions);return wr(p,v,0,p.length-1),h&&h.push(p.buffer,v.buffer),{ids:p,positions:v}}static deserialize(c){const h=new Lr;return h.ids=c.ids,h.positions=c.positions,h.indexed=!0,h}}function Zr(u){const c=+u;return!isNaN(c)&&c<=Number.MAX_SAFE_INTEGER?c:Er(String(u))}function wr(u,c,h,p){for(;h<p;){const v=u[h+p>>1];let S=h-1,I=p+1;for(;;){do S++;while(u[S]<v);do I--;while(u[I]>v);if(S>=I)break;Xr(u,S,I),Xr(c,3*S,3*I),Xr(c,3*S+1,3*I+1),Xr(c,3*S+2,3*I+2)}I-h<p-I?(wr(u,c,h,I),h=I+1):(wr(u,c,I+1,p),p=I)}}function Xr(u,c,h){const p=u[c];u[c]=u[h],u[h]=p}Ze("FeaturePositionMap",Lr);class Bn{constructor(c,h){this.gl=c.gl,this.location=h}}class Cn extends Bn{constructor(c,h){super(c,h),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class hi extends Bn{constructor(c,h){super(c,h),this.current=[0,0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3]))}}class hn extends Bn{constructor(c,h){super(c,h),this.current=xr.transparent}set(c){c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a))}}const cs=new Float32Array(16);function Ii(u){return[ue(255*u.r,255*u.g),ue(255*u.b,255*u.a)]}class zn{constructor(c,h,p){this.value=c,this.uniformNames=h.map(v=>`u_${v}`),this.type=p}setUniform(c,h,p){c.set(p.constantOr(this.value))}getBinding(c,h,p){return this.type==="color"?new hn(c,h):new Cn(c,h)}}class dn{constructor(c,h){this.uniformNames=h.map(p=>`u_${p}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(c,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=c.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=c.tlbr}setUniform(c,h,p,v){const S=v==="u_pattern_to"?this.patternTo:v==="u_pattern_from"?this.patternFrom:v==="u_pixel_ratio_to"?this.pixelRatioTo:v==="u_pixel_ratio_from"?this.pixelRatioFrom:null;S&&c.set(S)}getBinding(c,h,p){return p.substr(0,9)==="u_pattern"?new hi(c,h):new Cn(c,h)}}class sn{constructor(c,h,p,v){this.expression=c,this.type=p,this.maxValue=0,this.paintVertexAttributes=h.map(S=>({name:`a_${S}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new v}populatePaintArray(c,h,p,v,S){const I=this.paintVertexArray.length,F=this.expression.evaluate(new Hn(0),h,{},v,[],S);this.paintVertexArray.resize(c),this._setPaintValue(I,c,F)}updatePaintArray(c,h,p,v){const S=this.expression.evaluate({zoom:0},p,v);this._setPaintValue(c,h,S)}_setPaintValue(c,h,p){if(this.type==="color"){const v=Ii(p);for(let S=c;S<h;S++)this.paintVertexArray.emplace(S,v[0],v[1])}else{for(let v=c;v<h;v++)this.paintVertexArray.emplace(v,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class fn{constructor(c,h,p,v,S,I){this.expression=c,this.uniformNames=h.map(F=>`u_${F}_t`),this.type=p,this.useIntegerZoom=v,this.zoom=S,this.maxValue=0,this.paintVertexAttributes=h.map(F=>({name:`a_${F}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new I}populatePaintArray(c,h,p,v,S){const I=this.expression.evaluate(new Hn(this.zoom),h,{},v,[],S),F=this.expression.evaluate(new Hn(this.zoom+1),h,{},v,[],S),O=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValue(O,c,I,F)}updatePaintArray(c,h,p,v){const S=this.expression.evaluate({zoom:this.zoom},p,v),I=this.expression.evaluate({zoom:this.zoom+1},p,v);this._setPaintValue(c,h,S,I)}_setPaintValue(c,h,p,v){if(this.type==="color"){const S=Ii(p),I=Ii(v);for(let F=c;F<h;F++)this.paintVertexArray.emplace(F,S[0],S[1],I[0],I[1])}else{for(let S=c;S<h;S++)this.paintVertexArray.emplace(S,p,v);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(v))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(c,h){const p=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,v=ft(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);c.set(v)}getBinding(c,h,p){return new Cn(c,h)}}class Ei{constructor(c,h,p,v,S,I){this.expression=c,this.type=h,this.useIntegerZoom=p,this.zoom=v,this.layerId=I,this.zoomInPaintVertexArray=new S,this.zoomOutPaintVertexArray=new S}populatePaintArray(c,h,p){const v=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(c),this.zoomOutPaintVertexArray.resize(c),this._setPaintValues(v,c,h.patterns&&h.patterns[this.layerId],p)}updatePaintArray(c,h,p,v,S){this._setPaintValues(c,h,p.patterns&&p.patterns[this.layerId],S)}_setPaintValues(c,h,p,v){if(!v||!p)return;const{min:S,mid:I,max:F}=p,O=v[S],G=v[I],K=v[F];if(O&&G&&K)for(let X=c;X<h;X++)this.zoomInPaintVertexArray.emplace(X,G.tl[0],G.tl[1],G.br[0],G.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],G.pixelRatio,O.pixelRatio),this.zoomOutPaintVertexArray.emplace(X,G.tl[0],G.tl[1],G.br[0],G.br[1],K.tl[0],K.tl[1],K.br[0],K.br[1],G.pixelRatio,K.pixelRatio)}upload(c){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=c.createVertexBuffer(this.zoomInPaintVertexArray,Ae.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=c.createVertexBuffer(this.zoomOutPaintVertexArray,Ae.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class ln{constructor(c,h,p){this.binders={},this._buffers=[];const v=[];for(const S in c.paint._values){if(!p(S))continue;const I=c.paint.get(S);if(!(I instanceof Yo&&Mt(I.property.specification)))continue;const F=Wi(S,c.type),O=I.value,G=I.property.specification.type,K=I.property.useIntegerZoom,X=I.property.specification["property-type"],nt=X==="cross-faded"||X==="cross-faded-data-driven";if(O.kind==="constant")this.binders[S]=nt?new dn(O.value,F):new zn(O.value,F,G),v.push(`/u_${S}`);else if(O.kind==="source"||nt){const at=ti(S,G,"source");this.binders[S]=nt?new Ei(O,G,K,h,at,c.id):new sn(O,F,G,at),v.push(`/a_${S}`)}else{const at=ti(S,G,"composite");this.binders[S]=new fn(O,F,G,K,h,at),v.push(`/z_${S}`)}}this.cacheKey=v.sort().join("")}getMaxValue(c){const h=this.binders[c];return h instanceof sn||h instanceof fn?h.maxValue:0}populatePaintArrays(c,h,p,v,S){for(const I in this.binders){const F=this.binders[I];(F instanceof sn||F instanceof fn||F instanceof Ei)&&F.populatePaintArray(c,h,p,v,S)}}setConstantPatternPositions(c,h){for(const p in this.binders){const v=this.binders[p];v instanceof dn&&v.setConstantPatternPositions(c,h)}}updatePaintArrays(c,h,p,v,S){let I=!1;for(const F in c){const O=h.getPositions(F);for(const G of O){const K=p.feature(G.index);for(const X in this.binders){const nt=this.binders[X];if((nt instanceof sn||nt instanceof fn||nt instanceof Ei)&&nt.expression.isStateDependent===!0){const at=v.paint.get(X);nt.expression=at.value,nt.updatePaintArray(G.start,G.end,K,c[F],S),I=!0}}}}return I}defines(){const c=[];for(const h in this.binders){const p=this.binders[h];(p instanceof zn||p instanceof dn)&&c.push(...p.uniformNames.map(v=>`#define HAS_UNIFORM_${v}`))}return c}getBinderAttributes(){const c=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof sn||p instanceof fn)for(let v=0;v<p.paintVertexAttributes.length;v++)c.push(p.paintVertexAttributes[v].name);else if(p instanceof Ei)for(let v=0;v<Ae.members.length;v++)c.push(Ae.members[v].name)}return c}getBinderUniforms(){const c=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof zn||p instanceof dn||p instanceof fn)for(const v of p.uniformNames)c.push(v)}return c}getPaintVertexBuffers(){return this._buffers}getUniforms(c,h){const p=[];for(const v in this.binders){const S=this.binders[v];if(S instanceof zn||S instanceof dn||S instanceof fn){for(const I of S.uniformNames)if(h[I]){const F=S.getBinding(c,h[I],I);p.push({name:I,property:v,binding:F})}}}return p}setUniforms(c,h,p,v){for(const{name:S,property:I,binding:F}of h)this.binders[I].setUniform(F,v,p.get(I),S)}updatePaintBuffers(c){this._buffers=[];for(const h in this.binders){const p=this.binders[h];if(c&&p instanceof Ei){const v=c.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;v&&this._buffers.push(v)}else(p instanceof sn||p instanceof fn)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(c){for(const h in this.binders){const p=this.binders[h];(p instanceof sn||p instanceof fn||p instanceof Ei)&&p.upload(c)}this.updatePaintBuffers()}destroy(){for(const c in this.binders){const h=this.binders[c];(h instanceof sn||h instanceof fn||h instanceof Ei)&&h.destroy()}}}class En{constructor(c,h){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>!0;this.programConfigurations={};for(const v of c)this.programConfigurations[v.id]=new ln(v,h,p);this.needsUpload=!1,this._featureMap=new Lr,this._bufferOffset=0}populatePaintArrays(c,h,p,v,S,I){for(const F in this.programConfigurations)this.programConfigurations[F].populatePaintArrays(c,h,v,S,I);h.id!==void 0&&this._featureMap.add(h.id,p,this._bufferOffset,c),this._bufferOffset=c,this.needsUpload=!0}updatePaintArrays(c,h,p,v){for(const S of p)this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(c,this._featureMap,h,S,v)||this.needsUpload}get(c){return this.programConfigurations[c]}upload(c){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(c);this.needsUpload=!1}}destroy(){for(const c in this.programConfigurations)this.programConfigurations[c].destroy()}}function Wi(u,c){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[u]||[u.replace(`${c}-`,"").replace(/-/g,"_")]}function ti(u,c,h){const p={color:{source:Bo,composite:oh},number:{source:du,composite:Bo}},v=function(S){return{"line-pattern":{source:$,composite:$},"fill-pattern":{source:$,composite:$},"fill-extrusion-pattern":{source:$,composite:$}}[S]}(u);return v&&v[h]||p[c][h]}Ze("ConstantBinder",zn),Ze("CrossFadedConstantBinder",dn),Ze("SourceExpressionBinder",sn),Ze("CrossFadedCompositeBinder",Ei),Ze("CompositeExpressionBinder",fn),Ze("ProgramConfiguration",ln,{omit:["_buffers"]}),Ze("ProgramConfigurationSet",En);const Un=8192,si=Math.pow(2,14)-1,ah=-si-1;function Tc(u){const c=Un/u.extent,h=u.loadGeometry();for(let p=0;p<h.length;p++){const v=h[p];for(let S=0;S<v.length;S++){const I=v[S],F=Math.round(I.x*c),O=Math.round(I.y*c);I.x=ft(F,ah,si),I.y=ft(O,ah,si),(F<I.x||F>I.x+1||O<I.y||O>I.y+1)&&wt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function Ic(u,c){return{type:u.type,id:u.id,properties:u.properties,geometry:c?Tc(u):[]}}function El(u,c,h,p,v){u.emplaceBack(2*c+(p+1)/2,2*h+(v+1)/2)}class Co{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(h=>h.id),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new D,this.indexArray=new Tt,this.segments=new $t,this.programConfigurations=new En(c.layers,c.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(c,h,p){const v=this.layers[0],S=[];let I=null,F=!1;v.type==="circle"&&(I=v.layout.get("circle-sort-key"),F=!I.isConstant());for(const{feature:O,id:G,index:K,sourceLayerIndex:X}of c){const nt=this.layers[0]._featureFilter.needGeometry,at=Ic(O,nt);if(!this.layers[0]._featureFilter.filter(new Hn(this.zoom),at,p))continue;const ut=F?I.evaluate(at,{},p):void 0,Bt={id:G,properties:O.properties,type:O.type,sourceLayerIndex:X,index:K,geometry:nt?at.geometry:Tc(O),patterns:{},sortKey:ut};S.push(Bt)}F&&S.sort((O,G)=>O.sortKey-G.sortKey);for(const O of S){const{geometry:G,index:K,sourceLayerIndex:X}=O,nt=c[K].feature;this.addFeature(O,G,K,p),h.featureIndex.insert(nt,G,K,X,this.index)}}update(c,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,Gt),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(c,h,p,v){for(const S of h)for(const I of S){const F=I.x,O=I.y;if(F<0||F>=Un||O<0||O>=Un)continue;const G=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,c.sortKey),K=G.vertexLength;El(this.layoutVertexArray,F,O,-1,-1),El(this.layoutVertexArray,F,O,1,-1),El(this.layoutVertexArray,F,O,1,1),El(this.layoutVertexArray,F,O,-1,1),this.indexArray.emplaceBack(K,K+1,K+2),this.indexArray.emplaceBack(K,K+3,K+2),G.vertexLength+=4,G.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,p,{},v)}}function fu(u,c){for(let h=0;h<u.length;h++)if(Sl(c,u[h]))return!0;for(let h=0;h<c.length;h++)if(Sl(u,c[h]))return!0;return!!AA(u,c)}function Eo(u,c,h){return!!Sl(u,c)||!!cp(c,u,h)}function Lc(u,c){if(u.length===1)return lp(c,u[0]);for(let h=0;h<c.length;h++){const p=c[h];for(let v=0;v<p.length;v++)if(Sl(u,p[v]))return!0}for(let h=0;h<u.length;h++)if(lp(c,u[h]))return!0;for(let h=0;h<c.length;h++)if(AA(u,c[h]))return!0;return!1}function Fc(u,c,h){if(u.length>1){if(AA(u,c))return!0;for(let p=0;p<c.length;p++)if(cp(c[p],u,h))return!0}for(let p=0;p<u.length;p++)if(cp(u[p],c,h))return!0;return!1}function AA(u,c){if(u.length===0||c.length===0)return!1;for(let h=0;h<u.length-1;h++){const p=u[h],v=u[h+1];for(let S=0;S<c.length-1;S++)if(pu(p,v,c[S],c[S+1]))return!0}return!1}function pu(u,c,h,p){return yt(u,h,p)!==yt(c,h,p)&&yt(u,c,h)!==yt(u,c,p)}function cp(u,c,h){const p=h*h;if(c.length===1)return u.distSqr(c[0])<p;for(let v=1;v<c.length;v++)if(bd(u,c[v-1],c[v])<p)return!0;return!1}function bd(u,c,h){const p=c.distSqr(h);if(p===0)return u.distSqr(c);const v=((u.x-c.x)*(h.x-c.x)+(u.y-c.y)*(h.y-c.y))/p;return u.distSqr(v<0?c:v>1?h:h.sub(c)._mult(v)._add(c))}function lp(u,c){let h,p,v,S=!1;for(let I=0;I<u.length;I++){h=u[I];for(let F=0,O=h.length-1;F<h.length;O=F++)p=h[F],v=h[O],p.y>c.y!=v.y>c.y&&c.x<(v.x-p.x)*(c.y-p.y)/(v.y-p.y)+p.x&&(S=!S)}return S}function Sl(u,c){let h=!1;for(let p=0,v=u.length-1;p<u.length;v=p++){const S=u[p],I=u[v];S.y>c.y!=I.y>c.y&&c.x<(I.x-S.x)*(c.y-S.y)/(I.y-S.y)+S.x&&(h=!h)}return h}function wd(u,c,h){const p=h[0],v=h[2];if(u.x<p.x&&c.x<p.x||u.x>v.x&&c.x>v.x||u.y<p.y&&c.y<p.y||u.y>v.y&&c.y>v.y)return!1;const S=yt(u,c,h[0]);return S!==yt(u,c,h[1])||S!==yt(u,c,h[2])||S!==yt(u,c,h[3])}function xd(u,c,h){const p=c.paint.get(u).value;return p.kind==="constant"?p.value:h.programConfigurations.get(c.id).getMaxValue(u)}function up(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function ch(u,c,h,p,v){if(!c[0]&&!c[1])return u;const S=b.convert(c)._mult(v);h==="viewport"&&S._rotate(-p);const I=[];for(let F=0;F<u.length;F++)I.push(u[F].sub(S));return I}let Tl,y_;Ze("CircleBucket",Co,{omit:["layers"]});var rE={get paint(){return y_=y_||new Ki({"circle-radius":new br(Yt.paint_circle["circle-radius"]),"circle-color":new br(Yt.paint_circle["circle-color"]),"circle-blur":new br(Yt.paint_circle["circle-blur"]),"circle-opacity":new br(Yt.paint_circle["circle-opacity"]),"circle-translate":new hr(Yt.paint_circle["circle-translate"]),"circle-translate-anchor":new hr(Yt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new hr(Yt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new hr(Yt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new br(Yt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new br(Yt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new br(Yt.paint_circle["circle-stroke-opacity"])})},get layout(){return Tl=Tl||new Ki({"circle-sort-key":new br(Yt.layout_circle["circle-sort-key"])})}},Hs=1e-6,hA=typeof Float32Array<"u"?Float32Array:Array;function lh(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function vm(u,c,h){var p=c[0],v=c[1],S=c[2],I=c[3],F=c[4],O=c[5],G=c[6],K=c[7],X=c[8],nt=c[9],at=c[10],ut=c[11],Bt=c[12],It=c[13],kt=c[14],ee=c[15],Ht=h[0],Kt=h[1],ve=h[2],be=h[3];return u[0]=Ht*p+Kt*F+ve*X+be*Bt,u[1]=Ht*v+Kt*O+ve*nt+be*It,u[2]=Ht*S+Kt*G+ve*at+be*kt,u[3]=Ht*I+Kt*K+ve*ut+be*ee,u[4]=(Ht=h[4])*p+(Kt=h[5])*F+(ve=h[6])*X+(be=h[7])*Bt,u[5]=Ht*v+Kt*O+ve*nt+be*It,u[6]=Ht*S+Kt*G+ve*at+be*kt,u[7]=Ht*I+Kt*K+ve*ut+be*ee,u[8]=(Ht=h[8])*p+(Kt=h[9])*F+(ve=h[10])*X+(be=h[11])*Bt,u[9]=Ht*v+Kt*O+ve*nt+be*It,u[10]=Ht*S+Kt*G+ve*at+be*kt,u[11]=Ht*I+Kt*K+ve*ut+be*ee,u[12]=(Ht=h[12])*p+(Kt=h[13])*F+(ve=h[14])*X+(be=h[15])*Bt,u[13]=Ht*v+Kt*O+ve*nt+be*It,u[14]=Ht*S+Kt*G+ve*at+be*kt,u[15]=Ht*I+Kt*K+ve*ut+be*ee,u}Math.hypot||(Math.hypot=function(){for(var u=0,c=arguments.length;c--;)u+=arguments[c]*arguments[c];return Math.sqrt(u)});var uh,Ap=vm;function Ah(u,c,h){var p=c[0],v=c[1],S=c[2],I=c[3];return u[0]=h[0]*p+h[4]*v+h[8]*S+h[12]*I,u[1]=h[1]*p+h[5]*v+h[9]*S+h[13]*I,u[2]=h[2]*p+h[6]*v+h[10]*S+h[14]*I,u[3]=h[3]*p+h[7]*v+h[11]*S+h[15]*I,u}uh=new hA(4),hA!=Float32Array&&(uh[0]=0,uh[1]=0,uh[2]=0,uh[3]=0);class Bd extends Jo{constructor(c){super(c,rE)}createBucket(c){return new Co(c)}queryRadius(c){const h=c;return xd("circle-radius",this,h)+xd("circle-stroke-width",this,h)+up(this.paint.get("circle-translate"))}queryIntersectsFeature(c,h,p,v,S,I,F,O){const G=ch(c,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),I.angle,F),K=this.paint.get("circle-radius").evaluate(h,p)+this.paint.get("circle-stroke-width").evaluate(h,p),X=this.paint.get("circle-pitch-alignment")==="map",nt=X?G:function(ut,Bt){return ut.map(It=>bm(It,Bt))}(G,O),at=X?K*F:K;for(const ut of v)for(const Bt of ut){const It=X?Bt:bm(Bt,O);let kt=at;const ee=Ah([],[Bt.x,Bt.y,0,1],O);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?kt*=ee[3]/I.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(kt*=I.cameraToCenterDistance/ee[3]),Eo(nt,It,kt))return!0}return!1}}function bm(u,c){const h=Ah([],[u.x,u.y,0,1],c);return new b(h[0]/h[3],h[1]/h[3])}class __ extends Co{}let Cd;Ze("HeatmapBucket",__,{omit:["layers"]});var v_={get paint(){return Cd=Cd||new Ki({"heatmap-radius":new br(Yt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new br(Yt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new hr(Yt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new sA(Yt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new hr(Yt.paint_heatmap["heatmap-opacity"])})}};function Ed(u,c,h,p){let{width:v,height:S}=c;if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==v*S*h)throw new RangeError(`mismatched image size. expected: ${p.length} but got: ${v*S*h}`)}else p=new Uint8Array(v*S*h);return u.width=v,u.height=S,u.data=p,u}function Il(u,c,h){let{width:p,height:v}=c;if(p===u.width&&v===u.height)return;const S=Ed({},{width:p,height:v},h);hp(u,S,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,p),height:Math.min(u.height,v)},h),u.width=p,u.height=v,u.data=S.data}function hp(u,c,h,p,v,S){if(v.width===0||v.height===0)return c;if(v.width>u.width||v.height>u.height||h.x>u.width-v.width||h.y>u.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>c.width||v.height>c.height||p.x>c.width-v.width||p.y>c.height-v.height)throw new RangeError("out of range destination coordinates for image copy");const I=u.data,F=c.data;if(I===F)throw new Error("srcData equals dstData, so image is already copied");for(let O=0;O<v.height;O++){const G=((h.y+O)*u.width+h.x)*S,K=((p.y+O)*c.width+p.x)*S;for(let X=0;X<v.width*S;X++)F[K+X]=I[G+X]}return c}class hh{constructor(c,h){Ed(this,c,1,h)}resize(c){Il(this,c,1)}clone(){return new hh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,h,p,v,S){hp(c,h,p,v,S,1)}}class ea{constructor(c,h){Ed(this,c,4,h)}resize(c){Il(this,c,4)}replace(c,h){h?this.data.set(c):this.data=c instanceof Uint8ClampedArray?new Uint8Array(c.buffer):c}clone(){return new ea({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,h,p,v,S){hp(c,h,p,v,S,4)}}function wm(u){const c={},h=u.resolution||256,p=u.clips?u.clips.length:1,v=u.image||new ea({width:h,height:p});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const S=(I,F,O)=>{c[u.evaluationKey]=O;const G=u.expression.evaluate(c);v.data[I+F+0]=Math.floor(255*G.r/G.a),v.data[I+F+1]=Math.floor(255*G.g/G.a),v.data[I+F+2]=Math.floor(255*G.b/G.a),v.data[I+F+3]=Math.floor(255*G.a)};if(u.clips)for(let I=0,F=0;I<p;++I,F+=4*h)for(let O=0,G=0;O<h;O++,G+=4){const K=O/(h-1),{start:X,end:nt}=u.clips[I];S(F,G,X*(1-K)+nt*K)}else for(let I=0,F=0;I<h;I++,F+=4)S(0,F,I/(h-1));return v}Ze("AlphaImage",hh),Ze("RGBAImage",ea);class dh extends Jo{createBucket(c){return new __(c)}constructor(c){super(c,v_),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=wm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let b_;var w_={get paint(){return b_=b_||new Ki({"hillshade-illumination-direction":new hr(Yt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new hr(Yt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new hr(Yt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new hr(Yt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new hr(Yt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new hr(Yt.paint_hillshade["hillshade-accent-color"])})}};class nE extends Jo{constructor(c){super(c,w_)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const x_=Ci([{name:"a_pos",components:2,type:"Int16"}],4),{members:iE}=x_;var dA={exports:{}};function fh(u,c,h){h=h||2;var p,v,S,I,F,O,G,K=c&&c.length,X=K?c[0]*h:u.length,nt=Sd(u,0,X,h,!0),at=[];if(!nt||nt.next===nt.prev)return at;if(K&&(nt=function(Bt,It,kt,ee){var Ht,Kt,ve,be=[];for(Ht=0,Kt=It.length;Ht<Kt;Ht++)(ve=Sd(Bt,It[Ht]*ee,Ht<Kt-1?It[Ht+1]*ee:Bt.length,ee,!1))===ve.next&&(ve.steiner=!0),be.push(Z1t(ve));for(be.sort(sE),Ht=0;Ht<be.length;Ht++)kt=Bm(be[Ht],kt);return kt}(u,c,nt,h)),u.length>80*h){p=S=u[0],v=I=u[1];for(var ut=h;ut<X;ut+=h)(F=u[ut])<p&&(p=F),(O=u[ut+1])<v&&(v=O),F>S&&(S=F),O>I&&(I=O);G=(G=Math.max(S-p,I-v))!==0?32767/G:0}return Ba(nt,at,h,p,v,G,0),at}function Sd(u,c,h,p,v){var S,I;if(v===cE(u,c,h,p)>0)for(S=c;S<h;S+=p)I=h6(S,u[S],u[S+1],I);else for(S=h-p;S>=c;S-=p)I=h6(S,u[S],u[S+1],I);return I&&C_(I,I.next)&&(Sm(I),I=I.next),I}function eo(u,c){if(!u)return u;c||(c=u);var h,p=u;do if(h=!1,p.steiner||!C_(p,p.next)&&ki(p.prev,p,p.next)!==0)p=p.next;else{if(Sm(p),(p=c=p.prev)===p.next)break;h=!0}while(h||p!==c);return c}function Ba(u,c,h,p,v,S,I){if(u){!I&&S&&function(K,X,nt,at){var ut=K;do ut.z===0&&(ut.z=oE(ut.x,ut.y,X,nt,at)),ut.prevZ=ut.prev,ut.nextZ=ut.next,ut=ut.next;while(ut!==K);ut.prevZ.nextZ=null,ut.prevZ=null,function(Bt){var It,kt,ee,Ht,Kt,ve,be,Je,Ar=1;do{for(kt=Bt,Bt=null,Kt=null,ve=0;kt;){for(ve++,ee=kt,be=0,It=0;It<Ar&&(be++,ee=ee.nextZ);It++);for(Je=Ar;be>0||Je>0&&ee;)be!==0&&(Je===0||!ee||kt.z<=ee.z)?(Ht=kt,kt=kt.nextZ,be--):(Ht=ee,ee=ee.nextZ,Je--),Kt?Kt.nextZ=Ht:Bt=Ht,Ht.prevZ=Kt,Kt=Ht;kt=ee}Kt.nextZ=null,Ar*=2}while(ve>1)}(ut)}(u,p,v,S);for(var F,O,G=u;u.prev!==u.next;)if(F=u.prev,O=u.next,S?dp(u,p,v,S):gu(u))c.push(F.i/h|0),c.push(u.i/h|0),c.push(O.i/h|0),Sm(u),u=O.next,G=O.next;else if((u=O)===G){I?I===1?Ba(u=xm(eo(u),c,h),c,h,p,v,S,2):I===2&&B_(u,c,h,p,v,S):Ba(eo(u),c,h,p,v,S,1);break}}}function gu(u){var c=u.prev,h=u,p=u.next;if(ki(c,h,p)>=0)return!1;for(var v=c.x,S=h.x,I=p.x,F=c.y,O=h.y,G=p.y,K=v<S?v<I?v:I:S<I?S:I,X=F<O?F<G?F:G:O<G?O:G,nt=v>S?v>I?v:I:S>I?S:I,at=F>O?F>G?F:G:O>G?O:G,ut=p.next;ut!==c;){if(ut.x>=K&&ut.x<=nt&&ut.y>=X&&ut.y<=at&&fp(v,F,S,O,I,G,ut.x,ut.y)&&ki(ut.prev,ut,ut.next)>=0)return!1;ut=ut.next}return!0}function dp(u,c,h,p){var v=u.prev,S=u,I=u.next;if(ki(v,S,I)>=0)return!1;for(var F=v.x,O=S.x,G=I.x,K=v.y,X=S.y,nt=I.y,at=F<O?F<G?F:G:O<G?O:G,ut=K<X?K<nt?K:nt:X<nt?X:nt,Bt=F>O?F>G?F:G:O>G?O:G,It=K>X?K>nt?K:nt:X>nt?X:nt,kt=oE(at,ut,c,h,p),ee=oE(Bt,It,c,h,p),Ht=u.prevZ,Kt=u.nextZ;Ht&&Ht.z>=kt&&Kt&&Kt.z<=ee;){if(Ht.x>=at&&Ht.x<=Bt&&Ht.y>=ut&&Ht.y<=It&&Ht!==v&&Ht!==I&&fp(F,K,O,X,G,nt,Ht.x,Ht.y)&&ki(Ht.prev,Ht,Ht.next)>=0||(Ht=Ht.prevZ,Kt.x>=at&&Kt.x<=Bt&&Kt.y>=ut&&Kt.y<=It&&Kt!==v&&Kt!==I&&fp(F,K,O,X,G,nt,Kt.x,Kt.y)&&ki(Kt.prev,Kt,Kt.next)>=0))return!1;Kt=Kt.nextZ}for(;Ht&&Ht.z>=kt;){if(Ht.x>=at&&Ht.x<=Bt&&Ht.y>=ut&&Ht.y<=It&&Ht!==v&&Ht!==I&&fp(F,K,O,X,G,nt,Ht.x,Ht.y)&&ki(Ht.prev,Ht,Ht.next)>=0)return!1;Ht=Ht.prevZ}for(;Kt&&Kt.z<=ee;){if(Kt.x>=at&&Kt.x<=Bt&&Kt.y>=ut&&Kt.y<=It&&Kt!==v&&Kt!==I&&fp(F,K,O,X,G,nt,Kt.x,Kt.y)&&ki(Kt.prev,Kt,Kt.next)>=0)return!1;Kt=Kt.nextZ}return!0}function xm(u,c,h){var p=u;do{var v=p.prev,S=p.next.next;!C_(v,S)&&u6(v,p,p.next,S)&&Em(v,S)&&Em(S,v)&&(c.push(v.i/h|0),c.push(p.i/h|0),c.push(S.i/h|0),Sm(p),Sm(p.next),p=u=S),p=p.next}while(p!==u);return eo(p)}function B_(u,c,h,p,v,S){var I=u;do{for(var F=I.next.next;F!==I.prev;){if(I.i!==F.i&&t_t(I,F)){var O=A6(I,F);return I=eo(I,I.next),O=eo(O,O.next),Ba(I,c,h,p,v,S,0),void Ba(O,c,h,p,v,S,0)}F=F.next}I=I.next}while(I!==u)}function sE(u,c){return u.x-c.x}function Bm(u,c){var h=function(v,S){var I,F=S,O=v.x,G=v.y,K=-1/0;do{if(G<=F.y&&G>=F.next.y&&F.next.y!==F.y){var X=F.x+(G-F.y)*(F.next.x-F.x)/(F.next.y-F.y);if(X<=O&&X>K&&(K=X,I=F.x<F.next.x?F:F.next,X===O))return I}F=F.next}while(F!==S);if(!I)return null;var nt,at=I,ut=I.x,Bt=I.y,It=1/0;F=I;do O>=F.x&&F.x>=ut&&O!==F.x&&fp(G<Bt?O:K,G,ut,Bt,G<Bt?K:O,G,F.x,F.y)&&(nt=Math.abs(G-F.y)/(O-F.x),Em(F,v)&&(nt<It||nt===It&&(F.x>I.x||F.x===I.x&&Cm(I,F)))&&(I=F,It=nt)),F=F.next;while(F!==at);return I}(u,c);if(!h)return c;var p=A6(h,u);return eo(p,p.next),eo(h,h.next)}function Cm(u,c){return ki(u.prev,u,c.prev)<0&&ki(c.next,u,u.next)<0}function oE(u,c,h,p,v){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-h)*v|0)|u<<8))|u<<4))|u<<2))|u<<1))|(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-p)*v|0)|c<<8))|c<<4))|c<<2))|c<<1))<<1}function Z1t(u){var c=u,h=u;do(c.x<h.x||c.x===h.x&&c.y<h.y)&&(h=c),c=c.next;while(c!==u);return h}function fp(u,c,h,p,v,S,I,F){return(v-I)*(c-F)>=(u-I)*(S-F)&&(u-I)*(p-F)>=(h-I)*(c-F)&&(h-I)*(S-F)>=(v-I)*(p-F)}function t_t(u,c){return u.next.i!==c.i&&u.prev.i!==c.i&&!function(h,p){var v=h;do{if(v.i!==h.i&&v.next.i!==h.i&&v.i!==p.i&&v.next.i!==p.i&&u6(v,v.next,h,p))return!0;v=v.next}while(v!==h);return!1}(u,c)&&(Em(u,c)&&Em(c,u)&&function(h,p){var v=h,S=!1,I=(h.x+p.x)/2,F=(h.y+p.y)/2;do v.y>F!=v.next.y>F&&v.next.y!==v.y&&I<(v.next.x-v.x)*(F-v.y)/(v.next.y-v.y)+v.x&&(S=!S),v=v.next;while(v!==h);return S}(u,c)&&(ki(u.prev,u,c.prev)||ki(u,c.prev,c))||C_(u,c)&&ki(u.prev,u,u.next)>0&&ki(c.prev,c,c.next)>0)}function ki(u,c,h){return(c.y-u.y)*(h.x-c.x)-(c.x-u.x)*(h.y-c.y)}function C_(u,c){return u.x===c.x&&u.y===c.y}function u6(u,c,h,p){var v=S_(ki(u,c,h)),S=S_(ki(u,c,p)),I=S_(ki(h,p,u)),F=S_(ki(h,p,c));return v!==S&&I!==F||!(v!==0||!E_(u,h,c))||!(S!==0||!E_(u,p,c))||!(I!==0||!E_(h,u,p))||!(F!==0||!E_(h,c,p))}function E_(u,c,h){return c.x<=Math.max(u.x,h.x)&&c.x>=Math.min(u.x,h.x)&&c.y<=Math.max(u.y,h.y)&&c.y>=Math.min(u.y,h.y)}function S_(u){return u>0?1:u<0?-1:0}function Em(u,c){return ki(u.prev,u,u.next)<0?ki(u,c,u.next)>=0&&ki(u,u.prev,c)>=0:ki(u,c,u.prev)<0||ki(u,u.next,c)<0}function A6(u,c){var h=new aE(u.i,u.x,u.y),p=new aE(c.i,c.x,c.y),v=u.next,S=c.prev;return u.next=c,c.prev=u,h.next=v,v.prev=h,p.next=h,h.prev=p,S.next=p,p.prev=S,p}function h6(u,c,h,p){var v=new aE(u,c,h);return p?(v.next=p.next,v.prev=p,p.next.prev=v,p.next=v):(v.prev=v,v.next=v),v}function Sm(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function aE(u,c,h){this.i=u,this.x=c,this.y=h,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function cE(u,c,h,p){for(var v=0,S=c,I=h-p;S<h;S+=p)v+=(u[I]-u[S])*(u[S+1]+u[I+1]),I=S;return v}dA.exports=fh,dA.exports.default=fh,fh.deviation=function(u,c,h,p){var v=c&&c.length,S=Math.abs(cE(u,0,v?c[0]*h:u.length,h));if(v)for(var I=0,F=c.length;I<F;I++)S-=Math.abs(cE(u,c[I]*h,I<F-1?c[I+1]*h:u.length,h));var O=0;for(I=0;I<p.length;I+=3){var G=p[I]*h,K=p[I+1]*h,X=p[I+2]*h;O+=Math.abs((u[G]-u[X])*(u[K+1]-u[G+1])-(u[G]-u[K])*(u[X+1]-u[G+1]))}return S===0&&O===0?0:Math.abs((O-S)/S)},fh.flatten=function(u){for(var c=u[0][0].length,h={vertices:[],holes:[],dimensions:c},p=0,v=0;v<u.length;v++){for(var S=0;S<u[v].length;S++)for(var I=0;I<c;I++)h.vertices.push(u[v][S][I]);v>0&&h.holes.push(p+=u[v-1].length)}return h};var d6=A(dA.exports);function e_t(u,c,h,p,v){f6(u,c,h||0,p||u.length-1,v||r_t)}function f6(u,c,h,p,v){for(;p>h;){if(p-h>600){var S=p-h+1,I=c-h+1,F=Math.log(S),O=.5*Math.exp(2*F/3),G=.5*Math.sqrt(F*O*(S-O)/S)*(I-S/2<0?-1:1);f6(u,c,Math.max(h,Math.floor(c-I*O/S+G)),Math.min(p,Math.floor(c+(S-I)*O/S+G)),v)}var K=u[c],X=h,nt=p;for(Tm(u,h,c),v(u[p],K)>0&&Tm(u,h,p);X<nt;){for(Tm(u,X,nt),X++,nt--;v(u[X],K)<0;)X++;for(;v(u[nt],K)>0;)nt--}v(u[h],K)===0?Tm(u,h,nt):Tm(u,++nt,p),nt<=c&&(h=nt+1),c<=nt&&(p=nt-1)}}function Tm(u,c,h){var p=u[c];u[c]=u[h],u[h]=p}function r_t(u,c){return u<c?-1:u>c?1:0}function lE(u,c){const h=u.length;if(h<=1)return[u];const p=[];let v,S;for(let I=0;I<h;I++){const F=te(u[I]);F!==0&&(u[I].area=Math.abs(F),S===void 0&&(S=F<0),S===F<0?(v&&p.push(v),v=[u[I]]):v.push(u[I]))}if(v&&p.push(v),c>1)for(let I=0;I<p.length;I++)p[I].length<=c||(e_t(p[I],c,1,p[I].length-1,n_t),p[I]=p[I].slice(0,c));return p}function n_t(u,c){return c.area-u.area}function uE(u,c,h){const p=h.patternDependencies;let v=!1;for(const S of c){const I=S.paint.get(`${u}-pattern`);I.isConstant()||(v=!0);const F=I.constantOr(null);F&&(v=!0,p[F.to]=!0,p[F.from]=!0)}return v}function AE(u,c,h,p,v){const S=v.patternDependencies;for(const I of c){const F=I.paint.get(`${u}-pattern`).value;if(F.kind!=="constant"){let O=F.evaluate({zoom:p-1},h,{},v.availableImages),G=F.evaluate({zoom:p},h,{},v.availableImages),K=F.evaluate({zoom:p+1},h,{},v.availableImages);O=O&&O.name?O.name:O,G=G&&G.name?G.name:G,K=K&&K.name?K.name:K,S[O]=!0,S[G]=!0,S[K]=!0,h.patterns[I.id]={min:O,mid:G,max:K}}}return h}class hE{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(h=>h.id),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new H,this.indexArray=new Tt,this.indexArray2=new _t,this.programConfigurations=new En(c.layers,c.zoom),this.segments=new $t,this.segments2=new $t,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(c,h,p){this.hasPattern=uE("fill",this.layers,h);const v=this.layers[0].layout.get("fill-sort-key"),S=!v.isConstant(),I=[];for(const{feature:F,id:O,index:G,sourceLayerIndex:K}of c){const X=this.layers[0]._featureFilter.needGeometry,nt=Ic(F,X);if(!this.layers[0]._featureFilter.filter(new Hn(this.zoom),nt,p))continue;const at=S?v.evaluate(nt,{},p,h.availableImages):void 0,ut={id:O,properties:F.properties,type:F.type,sourceLayerIndex:K,index:G,geometry:X?nt.geometry:Tc(F),patterns:{},sortKey:at};I.push(ut)}S&&I.sort((F,O)=>F.sortKey-O.sortKey);for(const F of I){const{geometry:O,index:G,sourceLayerIndex:K}=F;if(this.hasPattern){const X=AE("fill",this.layers,F,this.zoom,h);this.patternFeatures.push(X)}else this.addFeature(F,O,G,p,{});h.featureIndex.insert(c[G].feature,O,G,K,this.index)}}update(c,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,p)}addFeatures(c,h,p){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,h,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,iE),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.indexBuffer2=c.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(c,h,p,v,S){for(const I of lE(h,500)){let F=0;for(const at of I)F+=at.length;const O=this.segments.prepareSegment(F,this.layoutVertexArray,this.indexArray),G=O.vertexLength,K=[],X=[];for(const at of I){if(at.length===0)continue;at!==I[0]&&X.push(K.length/2);const ut=this.segments2.prepareSegment(at.length,this.layoutVertexArray,this.indexArray2),Bt=ut.vertexLength;this.layoutVertexArray.emplaceBack(at[0].x,at[0].y),this.indexArray2.emplaceBack(Bt+at.length-1,Bt),K.push(at[0].x),K.push(at[0].y);for(let It=1;It<at.length;It++)this.layoutVertexArray.emplaceBack(at[It].x,at[It].y),this.indexArray2.emplaceBack(Bt+It-1,Bt+It),K.push(at[It].x),K.push(at[It].y);ut.vertexLength+=at.length,ut.primitiveLength+=at.length}const nt=d6(K,X);for(let at=0;at<nt.length;at+=3)this.indexArray.emplaceBack(G+nt[at],G+nt[at+1],G+nt[at+2]);O.vertexLength+=F,O.primitiveLength+=nt.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,p,S,v)}}let p6,g6;Ze("FillBucket",hE,{omit:["layers","patternFeatures"]});var i_t={get paint(){return g6=g6||new Ki({"fill-antialias":new hr(Yt.paint_fill["fill-antialias"]),"fill-opacity":new br(Yt.paint_fill["fill-opacity"]),"fill-color":new br(Yt.paint_fill["fill-color"]),"fill-outline-color":new br(Yt.paint_fill["fill-outline-color"]),"fill-translate":new hr(Yt.paint_fill["fill-translate"]),"fill-translate-anchor":new hr(Yt.paint_fill["fill-translate-anchor"]),"fill-pattern":new nh(Yt.paint_fill["fill-pattern"])})},get layout(){return p6=p6||new Ki({"fill-sort-key":new br(Yt.layout_fill["fill-sort-key"])})}};class s_t extends Jo{constructor(c){super(c,i_t)}recalculate(c,h){super.recalculate(c,h);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new hE(c)}queryRadius(){return up(this.paint.get("fill-translate"))}queryIntersectsFeature(c,h,p,v,S,I,F){return Lc(ch(c,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),I.angle,F),v)}isTileClipped(){return!0}}const o_t=Ci([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),a_t=Ci([{name:"a_centroid",components:2,type:"Int16"}],4),{members:c_t}=o_t;var ph={},l_t=f,m6=pp;function pp(u,c,h,p,v){this.properties={},this.extent=h,this.type=0,this._pbf=u,this._geometry=-1,this._keys=p,this._values=v,u.readFields(u_t,this,c)}function u_t(u,c,h){u==1?c.id=h.readVarint():u==2?function(p,v){for(var S=p.readVarint()+p.pos;p.pos<S;){var I=v._keys[p.readVarint()],F=v._values[p.readVarint()];v.properties[I]=F}}(h,c):u==3?c.type=h.readVarint():u==4&&(c._geometry=h.pos)}function A_t(u){for(var c,h,p=0,v=0,S=u.length,I=S-1;v<S;I=v++)p+=((h=u[I]).x-(c=u[v]).x)*(c.y+h.y);return p}pp.types=["Unknown","Point","LineString","Polygon"],pp.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var c,h=u.readVarint()+u.pos,p=1,v=0,S=0,I=0,F=[];u.pos<h;){if(v<=0){var O=u.readVarint();p=7&O,v=O>>3}if(v--,p===1||p===2)S+=u.readSVarint(),I+=u.readSVarint(),p===1&&(c&&F.push(c),c=[]),c.push(new l_t(S,I));else{if(p!==7)throw new Error("unknown command "+p);c&&c.push(c[0].clone())}}return c&&F.push(c),F},pp.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var c=u.readVarint()+u.pos,h=1,p=0,v=0,S=0,I=1/0,F=-1/0,O=1/0,G=-1/0;u.pos<c;){if(p<=0){var K=u.readVarint();h=7&K,p=K>>3}if(p--,h===1||h===2)(v+=u.readSVarint())<I&&(I=v),v>F&&(F=v),(S+=u.readSVarint())<O&&(O=S),S>G&&(G=S);else if(h!==7)throw new Error("unknown command "+h)}return[I,O,F,G]},pp.prototype.toGeoJSON=function(u,c,h){var p,v,S=this.extent*Math.pow(2,h),I=this.extent*u,F=this.extent*c,O=this.loadGeometry(),G=pp.types[this.type];function K(at){for(var ut=0;ut<at.length;ut++){var Bt=at[ut];at[ut]=[360*(Bt.x+I)/S-180,360/Math.PI*Math.atan(Math.exp((180-360*(Bt.y+F)/S)*Math.PI/180))-90]}}switch(this.type){case 1:var X=[];for(p=0;p<O.length;p++)X[p]=O[p][0];K(O=X);break;case 2:for(p=0;p<O.length;p++)K(O[p]);break;case 3:for(O=function(at){var ut=at.length;if(ut<=1)return[at];for(var Bt,It,kt=[],ee=0;ee<ut;ee++){var Ht=A_t(at[ee]);Ht!==0&&(It===void 0&&(It=Ht<0),It===Ht<0?(Bt&&kt.push(Bt),Bt=[at[ee]]):Bt.push(at[ee]))}return Bt&&kt.push(Bt),kt}(O),p=0;p<O.length;p++)for(v=0;v<O[p].length;v++)K(O[p][v])}O.length===1?O=O[0]:G="Multi"+G;var nt={type:"Feature",geometry:{type:G,coordinates:O},properties:this.properties};return"id"in this&&(nt.id=this.id),nt};var h_t=m6,y6=_6;function _6(u,c){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(d_t,this,c),this.length=this._features.length}function d_t(u,c,h){u===15?c.version=h.readVarint():u===1?c.name=h.readString():u===5?c.extent=h.readVarint():u===2?c._features.push(h.pos):u===3?c._keys.push(h.readString()):u===4&&c._values.push(function(p){for(var v=null,S=p.readVarint()+p.pos;p.pos<S;){var I=p.readVarint()>>3;v=I===1?p.readString():I===2?p.readFloat():I===3?p.readDouble():I===4?p.readVarint64():I===5?p.readVarint():I===6?p.readSVarint():I===7?p.readBoolean():null}return v}(h))}_6.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var c=this._pbf.readVarint()+this._pbf.pos;return new h_t(this._pbf,c,this.extent,this._keys,this._values)};var f_t=y6;function p_t(u,c,h){if(u===3){var p=new f_t(h,h.readVarint()+h.pos);p.length&&(c[p.name]=p)}}ph.VectorTile=function(u,c){this.layers=u.readFields(p_t,{},c)},ph.VectorTileFeature=m6,ph.VectorTileLayer=y6;const g_t=ph.VectorTileFeature.types,dE=Math.pow(2,13);function Im(u,c,h,p,v,S,I,F){u.emplaceBack(c,h,2*Math.floor(p*dE)+I,v*dE*2,S*dE*2,Math.round(F))}class fE{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(h=>h.id),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new z,this.centroidVertexArray=new L,this.indexArray=new Tt,this.programConfigurations=new En(c.layers,c.zoom),this.segments=new $t,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(c,h,p){this.features=[],this.hasPattern=uE("fill-extrusion",this.layers,h);for(const{feature:v,id:S,index:I,sourceLayerIndex:F}of c){const O=this.layers[0]._featureFilter.needGeometry,G=Ic(v,O);if(!this.layers[0]._featureFilter.filter(new Hn(this.zoom),G,p))continue;const K={id:S,sourceLayerIndex:F,index:I,geometry:O?G.geometry:Tc(v),properties:v.properties,type:v.type,patterns:{}};this.hasPattern?this.features.push(AE("fill-extrusion",this.layers,K,this.zoom,h)):this.addFeature(K,K.geometry,I,p,{}),h.featureIndex.insert(v,K.geometry,I,F,this.index,!0)}}addFeatures(c,h,p){for(const v of this.features){const{geometry:S}=v;this.addFeature(v,S,v.index,h,p)}}update(c,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,c_t),this.centroidVertexBuffer=c.createVertexBuffer(this.centroidVertexArray,a_t.members,!0),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(c,h,p,v,S){const I={x:0,y:0,vertexCount:0};for(const F of lE(h,500)){let O=0;for(const ut of F)O+=ut.length;let G=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const ut of F){if(ut.length===0||y_t(ut))continue;let Bt=0;for(let It=0;It<ut.length;It++){const kt=ut[It];if(It>=1){const ee=ut[It-1];if(!m_t(kt,ee)){G.vertexLength+4>$t.MAX_VERTEX_ARRAY_LENGTH&&(G=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ht=kt.sub(ee)._perp()._unit(),Kt=ee.dist(kt);Bt+Kt>32768&&(Bt=0),Im(this.layoutVertexArray,kt.x,kt.y,Ht.x,Ht.y,0,0,Bt),Im(this.layoutVertexArray,kt.x,kt.y,Ht.x,Ht.y,0,1,Bt),I.x+=2*kt.x,I.y+=2*kt.y,I.vertexCount+=2,Bt+=Kt,Im(this.layoutVertexArray,ee.x,ee.y,Ht.x,Ht.y,0,0,Bt),Im(this.layoutVertexArray,ee.x,ee.y,Ht.x,Ht.y,0,1,Bt),I.x+=2*ee.x,I.y+=2*ee.y,I.vertexCount+=2;const ve=G.vertexLength;this.indexArray.emplaceBack(ve,ve+2,ve+1),this.indexArray.emplaceBack(ve+1,ve+2,ve+3),G.vertexLength+=4,G.primitiveLength+=2}}}}if(G.vertexLength+O>$t.MAX_VERTEX_ARRAY_LENGTH&&(G=this.segments.prepareSegment(O,this.layoutVertexArray,this.indexArray)),g_t[c.type]!=="Polygon")continue;const K=[],X=[],nt=G.vertexLength;for(const ut of F)if(ut.length!==0){ut!==F[0]&&X.push(K.length/2);for(let Bt=0;Bt<ut.length;Bt++){const It=ut[Bt];Im(this.layoutVertexArray,It.x,It.y,0,0,1,1,0),I.x+=It.x,I.y+=It.y,I.vertexCount+=1,K.push(It.x),K.push(It.y)}}const at=d6(K,X);for(let ut=0;ut<at.length;ut+=3)this.indexArray.emplaceBack(nt+at[ut],nt+at[ut+2],nt+at[ut+1]);G.primitiveLength+=at.length/3,G.vertexLength+=O}for(let F=0;F<I.vertexCount;F++)this.centroidVertexArray.emplaceBack(Math.floor(I.x/I.vertexCount),Math.floor(I.y/I.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,p,S,v)}}function m_t(u,c){return u.x===c.x&&(u.x<0||u.x>Un)||u.y===c.y&&(u.y<0||u.y>Un)}function y_t(u){return u.every(c=>c.x<0)||u.every(c=>c.x>Un)||u.every(c=>c.y<0)||u.every(c=>c.y>Un)}let v6;Ze("FillExtrusionBucket",fE,{omit:["layers","features"]});var __t={get paint(){return v6=v6||new Ki({"fill-extrusion-opacity":new hr(Yt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new br(Yt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new hr(Yt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new hr(Yt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new nh(Yt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new br(Yt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new br(Yt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new hr(Yt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class v_t extends Jo{constructor(c){super(c,__t)}createBucket(c){return new fE(c)}queryRadius(){return up(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(c,h,p,v,S,I,F,O){const G=ch(c,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),I.angle,F),K=this.paint.get("fill-extrusion-height").evaluate(h,p),X=this.paint.get("fill-extrusion-base").evaluate(h,p),nt=function(ut,Bt,It,kt){const ee=[];for(const Ht of ut){const Kt=[Ht.x,Ht.y,0,1];Ah(Kt,Kt,Bt),ee.push(new b(Kt[0]/Kt[3],Kt[1]/Kt[3]))}return ee}(G,O),at=function(ut,Bt,It,kt){const ee=[],Ht=[],Kt=kt[8]*Bt,ve=kt[9]*Bt,be=kt[10]*Bt,Je=kt[11]*Bt,Ar=kt[8]*It,$e=kt[9]*It,Ke=kt[10]*It,ke=kt[11]*It;for(const sr of ut){const Ve=[],Le=[];for(const Br of sr){const fr=Br.x,tn=Br.y,oi=kt[0]*fr+kt[4]*tn+kt[12],di=kt[1]*fr+kt[5]*tn+kt[13],us=kt[2]*fr+kt[6]*tn+kt[14],Ca=kt[3]*fr+kt[7]*tn+kt[15],So=us+be,$i=Ca+Je,Es=oi+Ar,Gs=di+$e,To=us+Ke,Io=Ca+ke,As=new b((oi+Kt)/$i,(di+ve)/$i);As.z=So/$i,Ve.push(As);const hs=new b(Es/Io,Gs/Io);hs.z=To/Io,Le.push(hs)}ee.push(Ve),Ht.push(Le)}return[ee,Ht]}(v,X,K,O);return function(ut,Bt,It){let kt=1/0;Lc(It,Bt)&&(kt=b6(It,Bt[0]));for(let ee=0;ee<Bt.length;ee++){const Ht=Bt[ee],Kt=ut[ee];for(let ve=0;ve<Ht.length-1;ve++){const be=Ht[ve],Je=[be,Ht[ve+1],Kt[ve+1],Kt[ve],be];fu(It,Je)&&(kt=Math.min(kt,b6(It,Je)))}}return kt!==1/0&&kt}(at[0],at[1],nt)}}function Lm(u,c){return u.x*c.x+u.y*c.y}function b6(u,c){if(u.length===1){let h=0;const p=c[h++];let v;for(;!v||p.equals(v);)if(v=c[h++],!v)return 1/0;for(;h<c.length;h++){const S=c[h],I=u[0],F=v.sub(p),O=S.sub(p),G=I.sub(p),K=Lm(F,F),X=Lm(F,O),nt=Lm(O,O),at=Lm(G,F),ut=Lm(G,O),Bt=K*nt-X*X,It=(nt*at-X*ut)/Bt,kt=(K*ut-X*at)/Bt,ee=p.z*(1-It-kt)+v.z*It+S.z*kt;if(isFinite(ee))return ee}return 1/0}{let h=1/0;for(const p of c)h=Math.min(h,p.z);return h}}const b_t=Ci([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:w_t}=b_t,x_t=Ci([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:B_t}=x_t,C_t=ph.VectorTileFeature.types,E_t=Math.cos(Math.PI/180*37.5),w6=Math.pow(2,14)/.5;class pE{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(h=>h.id),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new j,this.layoutVertexArray2=new V,this.indexArray=new Tt,this.programConfigurations=new En(c.layers,c.zoom),this.segments=new $t,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(c,h,p){this.hasPattern=uE("line",this.layers,h);const v=this.layers[0].layout.get("line-sort-key"),S=!v.isConstant(),I=[];for(const{feature:F,id:O,index:G,sourceLayerIndex:K}of c){const X=this.layers[0]._featureFilter.needGeometry,nt=Ic(F,X);if(!this.layers[0]._featureFilter.filter(new Hn(this.zoom),nt,p))continue;const at=S?v.evaluate(nt,{},p):void 0,ut={id:O,properties:F.properties,type:F.type,sourceLayerIndex:K,index:G,geometry:X?nt.geometry:Tc(F),patterns:{},sortKey:at};I.push(ut)}S&&I.sort((F,O)=>F.sortKey-O.sortKey);for(const F of I){const{geometry:O,index:G,sourceLayerIndex:K}=F;if(this.hasPattern){const X=AE("line",this.layers,F,this.zoom,h);this.patternFeatures.push(X)}else this.addFeature(F,O,G,p,{});h.featureIndex.insert(c[G].feature,O,G,K,this.index)}}update(c,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,p)}addFeatures(c,h,p){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,h,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=c.createVertexBuffer(this.layoutVertexArray2,B_t)),this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,w_t),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(c){if(c.properties&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_end"))return{start:+c.properties.mapbox_clip_start,end:+c.properties.mapbox_clip_end}}addFeature(c,h,p,v,S){const I=this.layers[0].layout,F=I.get("line-join").evaluate(c,{}),O=I.get("line-cap"),G=I.get("line-miter-limit"),K=I.get("line-round-limit");this.lineClips=this.lineFeatureClips(c);for(const X of h)this.addLine(X,c,F,O,G,K);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,p,S,v)}addLine(c,h,p,v,S,I){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let kt=0;kt<c.length-1;kt++)this.totalDistance+=c[kt].dist(c[kt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const F=C_t[h.type]==="Polygon";let O=c.length;for(;O>=2&&c[O-1].equals(c[O-2]);)O--;let G=0;for(;G<O-1&&c[G].equals(c[G+1]);)G++;if(O<(F?3:2))return;p==="bevel"&&(S=1.05);const K=this.overscaling<=16?15*Un/(512*this.overscaling):0,X=this.segments.prepareSegment(10*O,this.layoutVertexArray,this.indexArray);let nt,at,ut,Bt,It;this.e1=this.e2=-1,F&&(nt=c[O-2],It=c[G].sub(nt)._unit()._perp());for(let kt=G;kt<O;kt++){if(ut=kt===O-1?F?c[G+1]:void 0:c[kt+1],ut&&c[kt].equals(ut))continue;It&&(Bt=It),nt&&(at=nt),nt=c[kt],It=ut?ut.sub(nt)._unit()._perp():Bt,Bt=Bt||It;let ee=Bt.add(It);ee.x===0&&ee.y===0||ee._unit();const Ht=Bt.x*It.x+Bt.y*It.y,Kt=ee.x*It.x+ee.y*It.y,ve=Kt!==0?1/Kt:1/0,be=2*Math.sqrt(2-2*Kt),Je=Kt<E_t&&at&&ut,Ar=Bt.x*It.y-Bt.y*It.x>0;if(Je&&kt>G){const ke=nt.dist(at);if(ke>2*K){const sr=nt.sub(nt.sub(at)._mult(K/ke)._round());this.updateDistance(at,sr),this.addCurrentVertex(sr,Bt,0,0,X),at=sr}}const $e=at&&ut;let Ke=$e?p:F?"butt":v;if($e&&Ke==="round"&&(ve<I?Ke="miter":ve<=2&&(Ke="fakeround")),Ke==="miter"&&ve>S&&(Ke="bevel"),Ke==="bevel"&&(ve>2&&(Ke="flipbevel"),ve<S&&(Ke="miter")),at&&this.updateDistance(at,nt),Ke==="miter")ee._mult(ve),this.addCurrentVertex(nt,ee,0,0,X);else if(Ke==="flipbevel"){if(ve>100)ee=It.mult(-1);else{const ke=ve*Bt.add(It).mag()/Bt.sub(It).mag();ee._perp()._mult(ke*(Ar?-1:1))}this.addCurrentVertex(nt,ee,0,0,X),this.addCurrentVertex(nt,ee.mult(-1),0,0,X)}else if(Ke==="bevel"||Ke==="fakeround"){const ke=-Math.sqrt(ve*ve-1),sr=Ar?ke:0,Ve=Ar?0:ke;if(at&&this.addCurrentVertex(nt,Bt,sr,Ve,X),Ke==="fakeround"){const Le=Math.round(180*be/Math.PI/20);for(let Br=1;Br<Le;Br++){let fr=Br/Le;if(fr!==.5){const oi=fr-.5;fr+=fr*oi*(fr-1)*((1.0904+Ht*(Ht*(3.55645-1.43519*Ht)-3.2452))*oi*oi+(.848013+Ht*(.215638*Ht-1.06021)))}const tn=It.sub(Bt)._mult(fr)._add(Bt)._unit()._mult(Ar?-1:1);this.addHalfVertex(nt,tn.x,tn.y,!1,Ar,0,X)}}ut&&this.addCurrentVertex(nt,It,-sr,-Ve,X)}else if(Ke==="butt")this.addCurrentVertex(nt,ee,0,0,X);else if(Ke==="square"){const ke=at?1:-1;this.addCurrentVertex(nt,ee,ke,ke,X)}else Ke==="round"&&(at&&(this.addCurrentVertex(nt,Bt,0,0,X),this.addCurrentVertex(nt,Bt,1,1,X,!0)),ut&&(this.addCurrentVertex(nt,It,-1,-1,X,!0),this.addCurrentVertex(nt,It,0,0,X)));if(Je&&kt<O-1){const ke=nt.dist(ut);if(ke>2*K){const sr=nt.add(ut.sub(nt)._mult(K/ke)._round());this.updateDistance(nt,sr),this.addCurrentVertex(sr,It,0,0,X),nt=sr}}}}addCurrentVertex(c,h,p,v,S){let I=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;const F=h.y*v-h.x,O=-h.y-h.x*v;this.addHalfVertex(c,h.x+h.y*p,h.y-h.x*p,I,!1,p,S),this.addHalfVertex(c,F,O,I,!0,-v,S),this.distance>w6/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(c,h,p,v,S,I))}addHalfVertex(c,h,p,v,S,I,F){let{x:O,y:G}=c;const K=.5*(this.lineClips?this.scaledDistance*(w6-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((O<<1)+(v?1:0),(G<<1)+(S?1:0),Math.round(63*h)+128,Math.round(63*p)+128,1+(I===0?0:I<0?-1:1)|(63&K)<<2,K>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const X=F.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,X),F.primitiveLength++),S?this.e2=X:this.e1=X}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(c,h){this.distance+=c.dist(h),this.updateScaledDistance()}}let x6,B6;Ze("LineBucket",pE,{omit:["layers","patternFeatures"]});var C6={get paint(){return B6=B6||new Ki({"line-opacity":new br(Yt.paint_line["line-opacity"]),"line-color":new br(Yt.paint_line["line-color"]),"line-translate":new hr(Yt.paint_line["line-translate"]),"line-translate-anchor":new hr(Yt.paint_line["line-translate-anchor"]),"line-width":new br(Yt.paint_line["line-width"]),"line-gap-width":new br(Yt.paint_line["line-gap-width"]),"line-offset":new br(Yt.paint_line["line-offset"]),"line-blur":new br(Yt.paint_line["line-blur"]),"line-dasharray":new xl(Yt.paint_line["line-dasharray"]),"line-pattern":new nh(Yt.paint_line["line-pattern"]),"line-gradient":new sA(Yt.paint_line["line-gradient"])})},get layout(){return x6=x6||new Ki({"line-cap":new hr(Yt.layout_line["line-cap"]),"line-join":new br(Yt.layout_line["line-join"]),"line-miter-limit":new hr(Yt.layout_line["line-miter-limit"]),"line-round-limit":new hr(Yt.layout_line["line-round-limit"]),"line-sort-key":new br(Yt.layout_line["line-sort-key"])})}};class S_t extends br{possiblyEvaluate(c,h){return h=new Hn(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(c,h)}evaluate(c,h,p,v){return h=mt({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(c,h,p,v)}}let T_;class T_t extends Jo{constructor(c){super(c,C6),this.gradientVersion=0,T_||(T_=new S_t(C6.paint.properties["line-width"].specification),T_.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const h=this.gradientExpression();this.stepInterpolant=!!function(p){return p._styleExpression!==void 0}(h)&&h._styleExpression.expression instanceof ll,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(c,h){super.recalculate(c,h),this.paint._values["line-floorwidth"]=T_.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new pE(c)}queryRadius(c){const h=c,p=E6(xd("line-width",this,h),xd("line-gap-width",this,h)),v=xd("line-offset",this,h);return p/2+Math.abs(v)+up(this.paint.get("line-translate"))}queryIntersectsFeature(c,h,p,v,S,I,F){const O=ch(c,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),I.angle,F),G=F/2*E6(this.paint.get("line-width").evaluate(h,p),this.paint.get("line-gap-width").evaluate(h,p)),K=this.paint.get("line-offset").evaluate(h,p);return K&&(v=function(X,nt){const at=[];for(let ut=0;ut<X.length;ut++){const Bt=X[ut],It=[];for(let kt=0;kt<Bt.length;kt++){const ee=Bt[kt-1],Ht=Bt[kt],Kt=Bt[kt+1],ve=kt===0?new b(0,0):Ht.sub(ee)._unit()._perp(),be=kt===Bt.length-1?new b(0,0):Kt.sub(Ht)._unit()._perp(),Je=ve._add(be)._unit(),Ar=Je.x*be.x+Je.y*be.y;Ar!==0&&Je._mult(1/Ar),It.push(Je._mult(nt)._add(Ht))}at.push(It)}return at}(v,K*F)),function(X,nt,at){for(let ut=0;ut<nt.length;ut++){const Bt=nt[ut];if(X.length>=3){for(let It=0;It<Bt.length;It++)if(Sl(X,Bt[It]))return!0}if(Fc(X,Bt,at))return!0}return!1}(O,v,G)}isTileClipped(){return!0}}function E6(u,c){return c>0?c+2*u:u}const I_t=Ci([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),L_t=Ci([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ci([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const F_t=Ci([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Ci([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const S6=Ci([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),M_t=Ci([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function P_t(u,c,h){return u.sections.forEach(p=>{p.text=function(v,S,I){const F=S.layout.get("text-transform").evaluate(I,{});return F==="uppercase"?v=v.toLocaleUpperCase():F==="lowercase"&&(v=v.toLocaleLowerCase()),Ka.applyArabicShaping&&(v=Ka.applyArabicShaping(v)),v}(p.text,c,h)}),u}Ci([{name:"triangle",components:3,type:"Uint16"}]),Ci([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ci([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Ci([{type:"Float32",name:"offsetX"}]),Ci([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Ci([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Fm={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var ls=24,T6=Gn,I6=function(u,c,h,p,v){var S,I,F=8*v-p-1,O=(1<<F)-1,G=O>>1,K=-7,X=h?v-1:0,nt=h?-1:1,at=u[c+X];for(X+=nt,S=at&(1<<-K)-1,at>>=-K,K+=F;K>0;S=256*S+u[c+X],X+=nt,K-=8);for(I=S&(1<<-K)-1,S>>=-K,K+=p;K>0;I=256*I+u[c+X],X+=nt,K-=8);if(S===0)S=1-G;else{if(S===O)return I?NaN:1/0*(at?-1:1);I+=Math.pow(2,p),S-=G}return(at?-1:1)*I*Math.pow(2,S-p)},L6=function(u,c,h,p,v,S){var I,F,O,G=8*S-v-1,K=(1<<G)-1,X=K>>1,nt=v===23?Math.pow(2,-24)-Math.pow(2,-77):0,at=p?0:S-1,ut=p?1:-1,Bt=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(F=isNaN(c)?1:0,I=K):(I=Math.floor(Math.log(c)/Math.LN2),c*(O=Math.pow(2,-I))<1&&(I--,O*=2),(c+=I+X>=1?nt/O:nt*Math.pow(2,1-X))*O>=2&&(I++,O/=2),I+X>=K?(F=0,I=K):I+X>=1?(F=(c*O-1)*Math.pow(2,v),I+=X):(F=c*Math.pow(2,X-1)*Math.pow(2,v),I=0));v>=8;u[h+at]=255&F,at+=ut,F/=256,v-=8);for(I=I<<v|F,G+=v;G>0;u[h+at]=255&I,at+=ut,I/=256,G-=8);u[h+at-ut]|=128*Bt};function Gn(u){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(u)?u:new Uint8Array(u||0),this.pos=0,this.type=0,this.length=this.buf.length}Gn.Varint=0,Gn.Fixed64=1,Gn.Bytes=2,Gn.Fixed32=5;var gE=4294967296,F6=1/gE,M6=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function fA(u){return u.type===Gn.Bytes?u.readVarint()+u.pos:u.pos+1}function gp(u,c,h){return h?4294967296*c+(u>>>0):4294967296*(c>>>0)+(u>>>0)}function P6(u,c,h){var p=c<=16383?1:c<=2097151?2:c<=268435455?3:Math.floor(Math.log(c)/(7*Math.LN2));h.realloc(p);for(var v=h.pos-1;v>=u;v--)h.buf[v+p]=h.buf[v]}function U_t(u,c){for(var h=0;h<u.length;h++)c.writeVarint(u[h])}function R_t(u,c){for(var h=0;h<u.length;h++)c.writeSVarint(u[h])}function O_t(u,c){for(var h=0;h<u.length;h++)c.writeFloat(u[h])}function D_t(u,c){for(var h=0;h<u.length;h++)c.writeDouble(u[h])}function k_t(u,c){for(var h=0;h<u.length;h++)c.writeBoolean(u[h])}function N_t(u,c){for(var h=0;h<u.length;h++)c.writeFixed32(u[h])}function Q_t(u,c){for(var h=0;h<u.length;h++)c.writeSFixed32(u[h])}function H_t(u,c){for(var h=0;h<u.length;h++)c.writeFixed64(u[h])}function z_t(u,c){for(var h=0;h<u.length;h++)c.writeSFixed64(u[h])}function I_(u,c){return(u[c]|u[c+1]<<8|u[c+2]<<16)+16777216*u[c+3]}function mp(u,c,h){u[h]=c,u[h+1]=c>>>8,u[h+2]=c>>>16,u[h+3]=c>>>24}function U6(u,c){return(u[c]|u[c+1]<<8|u[c+2]<<16)+(u[c+3]<<24)}Gn.prototype={destroy:function(){this.buf=null},readFields:function(u,c,h){for(h=h||this.length;this.pos<h;){var p=this.readVarint(),v=p>>3,S=this.pos;this.type=7&p,u(v,c,this),this.pos===S&&this.skip(p)}return c},readMessage:function(u,c){return this.readFields(u,c,this.readVarint()+this.pos)},readFixed32:function(){var u=I_(this.buf,this.pos);return this.pos+=4,u},readSFixed32:function(){var u=U6(this.buf,this.pos);return this.pos+=4,u},readFixed64:function(){var u=I_(this.buf,this.pos)+I_(this.buf,this.pos+4)*gE;return this.pos+=8,u},readSFixed64:function(){var u=I_(this.buf,this.pos)+U6(this.buf,this.pos+4)*gE;return this.pos+=8,u},readFloat:function(){var u=I6(this.buf,this.pos,!0,23,4);return this.pos+=4,u},readDouble:function(){var u=I6(this.buf,this.pos,!0,52,8);return this.pos+=8,u},readVarint:function(u){var c,h,p=this.buf;return c=127&(h=p[this.pos++]),h<128?c:(c|=(127&(h=p[this.pos++]))<<7,h<128?c:(c|=(127&(h=p[this.pos++]))<<14,h<128?c:(c|=(127&(h=p[this.pos++]))<<21,h<128?c:function(v,S,I){var F,O,G=I.buf;if(F=(112&(O=G[I.pos++]))>>4,O<128||(F|=(127&(O=G[I.pos++]))<<3,O<128)||(F|=(127&(O=G[I.pos++]))<<10,O<128)||(F|=(127&(O=G[I.pos++]))<<17,O<128)||(F|=(127&(O=G[I.pos++]))<<24,O<128)||(F|=(1&(O=G[I.pos++]))<<31,O<128))return gp(v,F,S);throw new Error("Expected varint not more than 10 bytes")}(c|=(15&(h=p[this.pos]))<<28,u,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var u=this.readVarint();return u%2==1?(u+1)/-2:u/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var u=this.readVarint()+this.pos,c=this.pos;return this.pos=u,u-c>=12&&M6?function(h,p,v){return M6.decode(h.subarray(p,v))}(this.buf,c,u):function(h,p,v){for(var S="",I=p;I<v;){var F,O,G,K=h[I],X=null,nt=K>239?4:K>223?3:K>191?2:1;if(I+nt>v)break;nt===1?K<128&&(X=K):nt===2?(192&(F=h[I+1]))==128&&(X=(31&K)<<6|63&F)<=127&&(X=null):nt===3?(O=h[I+2],(192&(F=h[I+1]))==128&&(192&O)==128&&((X=(15&K)<<12|(63&F)<<6|63&O)<=2047||X>=55296&&X<=57343)&&(X=null)):nt===4&&(O=h[I+2],G=h[I+3],(192&(F=h[I+1]))==128&&(192&O)==128&&(192&G)==128&&((X=(15&K)<<18|(63&F)<<12|(63&O)<<6|63&G)<=65535||X>=1114112)&&(X=null)),X===null?(X=65533,nt=1):X>65535&&(X-=65536,S+=String.fromCharCode(X>>>10&1023|55296),X=56320|1023&X),S+=String.fromCharCode(X),I+=nt}return S}(this.buf,c,u)},readBytes:function(){var u=this.readVarint()+this.pos,c=this.buf.subarray(this.pos,u);return this.pos=u,c},readPackedVarint:function(u,c){if(this.type!==Gn.Bytes)return u.push(this.readVarint(c));var h=fA(this);for(u=u||[];this.pos<h;)u.push(this.readVarint(c));return u},readPackedSVarint:function(u){if(this.type!==Gn.Bytes)return u.push(this.readSVarint());var c=fA(this);for(u=u||[];this.pos<c;)u.push(this.readSVarint());return u},readPackedBoolean:function(u){if(this.type!==Gn.Bytes)return u.push(this.readBoolean());var c=fA(this);for(u=u||[];this.pos<c;)u.push(this.readBoolean());return u},readPackedFloat:function(u){if(this.type!==Gn.Bytes)return u.push(this.readFloat());var c=fA(this);for(u=u||[];this.pos<c;)u.push(this.readFloat());return u},readPackedDouble:function(u){if(this.type!==Gn.Bytes)return u.push(this.readDouble());var c=fA(this);for(u=u||[];this.pos<c;)u.push(this.readDouble());return u},readPackedFixed32:function(u){if(this.type!==Gn.Bytes)return u.push(this.readFixed32());var c=fA(this);for(u=u||[];this.pos<c;)u.push(this.readFixed32());return u},readPackedSFixed32:function(u){if(this.type!==Gn.Bytes)return u.push(this.readSFixed32());var c=fA(this);for(u=u||[];this.pos<c;)u.push(this.readSFixed32());return u},readPackedFixed64:function(u){if(this.type!==Gn.Bytes)return u.push(this.readFixed64());var c=fA(this);for(u=u||[];this.pos<c;)u.push(this.readFixed64());return u},readPackedSFixed64:function(u){if(this.type!==Gn.Bytes)return u.push(this.readSFixed64());var c=fA(this);for(u=u||[];this.pos<c;)u.push(this.readSFixed64());return u},skip:function(u){var c=7&u;if(c===Gn.Varint)for(;this.buf[this.pos++]>127;);else if(c===Gn.Bytes)this.pos=this.readVarint()+this.pos;else if(c===Gn.Fixed32)this.pos+=4;else{if(c!==Gn.Fixed64)throw new Error("Unimplemented type: "+c);this.pos+=8}},writeTag:function(u,c){this.writeVarint(u<<3|c)},realloc:function(u){for(var c=this.length||16;c<this.pos+u;)c*=2;if(c!==this.length){var h=new Uint8Array(c);h.set(this.buf),this.buf=h,this.length=c}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(u){this.realloc(4),mp(this.buf,u,this.pos),this.pos+=4},writeSFixed32:function(u){this.realloc(4),mp(this.buf,u,this.pos),this.pos+=4},writeFixed64:function(u){this.realloc(8),mp(this.buf,-1&u,this.pos),mp(this.buf,Math.floor(u*F6),this.pos+4),this.pos+=8},writeSFixed64:function(u){this.realloc(8),mp(this.buf,-1&u,this.pos),mp(this.buf,Math.floor(u*F6),this.pos+4),this.pos+=8},writeVarint:function(u){(u=+u||0)>268435455||u<0?function(c,h){var p,v;if(c>=0?(p=c%4294967296|0,v=c/4294967296|0):(v=~(-c/4294967296),4294967295^(p=~(-c%4294967296))?p=p+1|0:(p=0,v=v+1|0)),c>=18446744073709552e3||c<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),function(S,I,F){F.buf[F.pos++]=127&S|128,S>>>=7,F.buf[F.pos++]=127&S|128,S>>>=7,F.buf[F.pos++]=127&S|128,S>>>=7,F.buf[F.pos++]=127&S|128,F.buf[F.pos]=127&(S>>>=7)}(p,0,h),function(S,I){var F=(7&S)<<4;I.buf[I.pos++]|=F|((S>>>=3)?128:0),S&&(I.buf[I.pos++]=127&S|((S>>>=7)?128:0),S&&(I.buf[I.pos++]=127&S|((S>>>=7)?128:0),S&&(I.buf[I.pos++]=127&S|((S>>>=7)?128:0),S&&(I.buf[I.pos++]=127&S|((S>>>=7)?128:0),S&&(I.buf[I.pos++]=127&S)))))}(v,h)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(u){this.writeVarint(u<0?2*-u-1:2*u)},writeBoolean:function(u){this.writeVarint(!!u)},writeString:function(u){u=String(u),this.realloc(4*u.length),this.pos++;var c=this.pos;this.pos=function(p,v,S){for(var I,F,O=0;O<v.length;O++){if((I=v.charCodeAt(O))>55295&&I<57344){if(!F){I>56319||O+1===v.length?(p[S++]=239,p[S++]=191,p[S++]=189):F=I;continue}if(I<56320){p[S++]=239,p[S++]=191,p[S++]=189,F=I;continue}I=F-55296<<10|I-56320|65536,F=null}else F&&(p[S++]=239,p[S++]=191,p[S++]=189,F=null);I<128?p[S++]=I:(I<2048?p[S++]=I>>6|192:(I<65536?p[S++]=I>>12|224:(p[S++]=I>>18|240,p[S++]=I>>12&63|128),p[S++]=I>>6&63|128),p[S++]=63&I|128)}return S}(this.buf,u,this.pos);var h=this.pos-c;h>=128&&P6(c,h,this),this.pos=c-1,this.writeVarint(h),this.pos+=h},writeFloat:function(u){this.realloc(4),L6(this.buf,u,this.pos,!0,23,4),this.pos+=4},writeDouble:function(u){this.realloc(8),L6(this.buf,u,this.pos,!0,52,8),this.pos+=8},writeBytes:function(u){var c=u.length;this.writeVarint(c),this.realloc(c);for(var h=0;h<c;h++)this.buf[this.pos++]=u[h]},writeRawMessage:function(u,c){this.pos++;var h=this.pos;u(c,this);var p=this.pos-h;p>=128&&P6(h,p,this),this.pos=h-1,this.writeVarint(p),this.pos+=p},writeMessage:function(u,c,h){this.writeTag(u,Gn.Bytes),this.writeRawMessage(c,h)},writePackedVarint:function(u,c){c.length&&this.writeMessage(u,U_t,c)},writePackedSVarint:function(u,c){c.length&&this.writeMessage(u,R_t,c)},writePackedBoolean:function(u,c){c.length&&this.writeMessage(u,k_t,c)},writePackedFloat:function(u,c){c.length&&this.writeMessage(u,O_t,c)},writePackedDouble:function(u,c){c.length&&this.writeMessage(u,D_t,c)},writePackedFixed32:function(u,c){c.length&&this.writeMessage(u,N_t,c)},writePackedSFixed32:function(u,c){c.length&&this.writeMessage(u,Q_t,c)},writePackedFixed64:function(u,c){c.length&&this.writeMessage(u,H_t,c)},writePackedSFixed64:function(u,c){c.length&&this.writeMessage(u,z_t,c)},writeBytesField:function(u,c){this.writeTag(u,Gn.Bytes),this.writeBytes(c)},writeFixed32Field:function(u,c){this.writeTag(u,Gn.Fixed32),this.writeFixed32(c)},writeSFixed32Field:function(u,c){this.writeTag(u,Gn.Fixed32),this.writeSFixed32(c)},writeFixed64Field:function(u,c){this.writeTag(u,Gn.Fixed64),this.writeFixed64(c)},writeSFixed64Field:function(u,c){this.writeTag(u,Gn.Fixed64),this.writeSFixed64(c)},writeVarintField:function(u,c){this.writeTag(u,Gn.Varint),this.writeVarint(c)},writeSVarintField:function(u,c){this.writeTag(u,Gn.Varint),this.writeSVarint(c)},writeStringField:function(u,c){this.writeTag(u,Gn.Bytes),this.writeString(c)},writeFloatField:function(u,c){this.writeTag(u,Gn.Fixed32),this.writeFloat(c)},writeDoubleField:function(u,c){this.writeTag(u,Gn.Fixed64),this.writeDouble(c)},writeBooleanField:function(u,c){this.writeVarintField(u,!!c)}};var mE=A(T6);const yE=3;function G_t(u,c,h){u===1&&h.readMessage(V_t,c)}function V_t(u,c,h){if(u===3){const{id:p,bitmap:v,width:S,height:I,left:F,top:O,advance:G}=h.readMessage(j_t,{});c.push({id:p,bitmap:new hh({width:S+2*yE,height:I+2*yE},v),metrics:{width:S,height:I,left:F,top:O,advance:G}})}}function j_t(u,c,h){u===1?c.id=h.readVarint():u===2?c.bitmap=h.readBytes():u===3?c.width=h.readVarint():u===4?c.height=h.readVarint():u===5?c.left=h.readSVarint():u===6?c.top=h.readSVarint():u===7&&(c.advance=h.readVarint())}const R6=yE;function O6(u){let c=0,h=0;for(const I of u)c+=I.w*I.h,h=Math.max(h,I.w);u.sort((I,F)=>F.h-I.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(c/.95)),h),h:1/0}];let v=0,S=0;for(const I of u)for(let F=p.length-1;F>=0;F--){const O=p[F];if(!(I.w>O.w||I.h>O.h)){if(I.x=O.x,I.y=O.y,S=Math.max(S,I.y+I.h),v=Math.max(v,I.x+I.w),I.w===O.w&&I.h===O.h){const G=p.pop();F<p.length&&(p[F]=G)}else I.h===O.h?(O.x+=I.w,O.w-=I.w):I.w===O.w?(O.y+=I.h,O.h-=I.h):(p.push({x:O.x+I.w,y:O.y,w:O.w-I.w,h:I.h}),O.y+=I.h,O.h-=I.h);break}}return{w:v,h:S,fill:c/(v*S)||0}}const ra=1;class _E{constructor(c,h){let{pixelRatio:p,version:v,stretchX:S,stretchY:I,content:F}=h;this.paddedRect=c,this.pixelRatio=p,this.stretchX=S,this.stretchY=I,this.content=F,this.version=v}get tl(){return[this.paddedRect.x+ra,this.paddedRect.y+ra]}get br(){return[this.paddedRect.x+this.paddedRect.w-ra,this.paddedRect.y+this.paddedRect.h-ra]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*ra)/this.pixelRatio,(this.paddedRect.h-2*ra)/this.pixelRatio]}}class D6{constructor(c,h){const p={},v={};this.haveRenderCallbacks=[];const S=[];this.addImages(c,p,S),this.addImages(h,v,S);const{w:I,h:F}=O6(S),O=new ea({width:I||1,height:F||1});for(const G in c){const K=c[G],X=p[G].paddedRect;ea.copy(K.data,O,{x:0,y:0},{x:X.x+ra,y:X.y+ra},K.data)}for(const G in h){const K=h[G],X=v[G].paddedRect,nt=X.x+ra,at=X.y+ra,ut=K.data.width,Bt=K.data.height;ea.copy(K.data,O,{x:0,y:0},{x:nt,y:at},K.data),ea.copy(K.data,O,{x:0,y:Bt-1},{x:nt,y:at-1},{width:ut,height:1}),ea.copy(K.data,O,{x:0,y:0},{x:nt,y:at+Bt},{width:ut,height:1}),ea.copy(K.data,O,{x:ut-1,y:0},{x:nt-1,y:at},{width:1,height:Bt}),ea.copy(K.data,O,{x:0,y:0},{x:nt+ut,y:at},{width:1,height:Bt})}this.image=O,this.iconPositions=p,this.patternPositions=v}addImages(c,h,p){for(const v in c){const S=c[v],I={x:0,y:0,w:S.data.width+2*ra,h:S.data.height+2*ra};p.push(I),h[v]=new _E(I,S),S.hasRenderCallback&&this.haveRenderCallbacks.push(v)}}patchUpdatedImages(c,h){c.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in c.updatedImages)this.patchUpdatedImage(this.iconPositions[p],c.getImage(p),h),this.patchUpdatedImage(this.patternPositions[p],c.getImage(p),h)}patchUpdatedImage(c,h,p){if(!c||!h||c.version===h.version)return;c.version=h.version;const[v,S]=c.tl;p.update(h.data,void 0,{x:v,y:S})}}var gh;Ze("ImagePosition",_E),Ze("ImageAtlas",D6),a.ah=void 0,(gh=a.ah||(a.ah={}))[gh.none=0]="none",gh[gh.horizontal=1]="horizontal",gh[gh.vertical=2]="vertical",gh[gh.horizontalOnly=3]="horizontalOnly";const Mm=-17;class Pm{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(c,h){const p=new Pm;return p.scale=c||1,p.fontStack=h,p}static forImage(c){const h=new Pm;return h.imageName=c,h}}class yp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(c,h){const p=new yp;for(let v=0;v<c.sections.length;v++){const S=c.sections[v];S.image?p.addImageSection(S):p.addTextSection(S,h)}return p}length(){return this.text.length}getSection(c){return this.sections[this.sectionIndex[c]]}getSectionIndex(c){return this.sectionIndex[c]}getCharCode(c){return this.text.charCodeAt(c)}verticalizePunctuation(){this.text=function(c){let h="";for(let p=0;p<c.length;p++){const v=c.charCodeAt(p+1)||null,S=c.charCodeAt(p-1)||null;h+=v&&rh(v)&&!Fm[c[p+1]]||S&&rh(S)&&!Fm[c[p-1]]||!Fm[c[p]]?c[p]:Fm[c[p]]}return h}(this.text)}trim(){let c=0;for(let p=0;p<this.text.length&&F_[this.text.charCodeAt(p)];p++)c++;let h=this.text.length;for(let p=this.text.length-1;p>=0&&p>=c&&F_[this.text.charCodeAt(p)];p--)h--;this.text=this.text.substring(c,h),this.sectionIndex=this.sectionIndex.slice(c,h)}substring(c,h){const p=new yp;return p.text=this.text.substring(c,h),p.sectionIndex=this.sectionIndex.slice(c,h),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((c,h)=>Math.max(c,this.sections[h].scale),0)}addTextSection(c,h){this.text+=c.text,this.sections.push(Pm.forText(c.scale,c.fontStack||h));const p=this.sections.length-1;for(let v=0;v<c.text.length;++v)this.sectionIndex.push(p)}addImageSection(c){const h=c.image?c.image.name:"";if(h.length===0)return void wt("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(Pm.forImage(h)),this.sectionIndex.push(this.sections.length-1)):wt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function L_(u,c,h,p,v,S,I,F,O,G,K,X,nt,at,ut,Bt){const It=yp.fromFeature(u,v);let kt;X===a.ah.vertical&&It.verticalizePunctuation();const{processBidirectionalText:ee,processStyledBidirectionalText:Ht}=Ka;if(ee&&It.sections.length===1){kt=[];const be=ee(It.toString(),vE(It,G,S,c,p,at,ut));for(const Je of be){const Ar=new yp;Ar.text=Je,Ar.sections=It.sections;for(let $e=0;$e<Je.length;$e++)Ar.sectionIndex.push(0);kt.push(Ar)}}else if(Ht){kt=[];const be=Ht(It.text,It.sectionIndex,vE(It,G,S,c,p,at,ut));for(const Je of be){const Ar=new yp;Ar.text=Je[0],Ar.sectionIndex=Je[1],Ar.sections=It.sections,kt.push(Ar)}}else kt=function(be,Je){const Ar=[],$e=be.text;let Ke=0;for(const ke of Je)Ar.push(be.substring(Ke,ke)),Ke=ke;return Ke<$e.length&&Ar.push(be.substring(Ke,$e.length)),Ar}(It,vE(It,G,S,c,p,at,ut));const Kt=[],ve={positionedLines:Kt,text:It.toString(),top:K[1],bottom:K[1],left:K[0],right:K[0],writingMode:X,iconsInText:!1,verticalizable:!1};return function(be,Je,Ar,$e,Ke,ke,sr,Ve,Le,Br,fr,tn){let oi=0,di=Mm,us=0,Ca=0;const So=Ve==="right"?1:Ve==="left"?0:.5;let $i=0;for(const As of Ke){As.trim();const hs=As.getMaxScale(),ro=(hs-1)*ls,Lo={positionedGlyphs:[],lineOffset:0};be.positionedLines[$i]=Lo;const no=Lo.positionedGlyphs;let na=0;if(!As.length()){di+=ke,++$i;continue}for(let ds=0;ds<As.length();ds++){const un=As.getSection(ds),io=As.getSectionIndex(ds),Vs=As.getCharCode(ds);let fs=0,Mc=null,Ll=null,Fl=null,pA=ls;const Pc=!(Le===a.ah.horizontal||!fr&&!_l(Vs)||fr&&(F_[Vs]||(Es=Vs,je.Arabic(Es)||je["Arabic Supplement"](Es)||je["Arabic Extended-A"](Es)||je["Arabic Presentation Forms-A"](Es)||je["Arabic Presentation Forms-B"](Es))));if(un.imageName){const Xa=$e[un.imageName];if(!Xa)continue;Fl=un.imageName,be.iconsInText=be.iconsInText||!0,Ll=Xa.paddedRect;const sa=Xa.displaySize;un.scale=un.scale*ls/tn,Mc={width:sa[0],height:sa[1],left:ra,top:-R6,advance:Pc?sa[1]:sa[0]},fs=ro+(ls-sa[1]*un.scale),pA=Mc.advance;const gA=Pc?sa[0]*un.scale-ls*hs:sa[1]*un.scale-ls*hs;gA>0&&gA>na&&(na=gA)}else{const Xa=Ar[un.fontStack],sa=Xa&&Xa[Vs];if(sa&&sa.rect)Ll=sa.rect,Mc=sa.metrics;else{const gA=Je[un.fontStack],km=gA&&gA[Vs];if(!km)continue;Mc=km.metrics}fs=(hs-un.scale)*ls}Pc?(be.verticalizable=!0,no.push({glyph:Vs,imageName:Fl,x:oi,y:di+fs,vertical:Pc,scale:un.scale,fontStack:un.fontStack,sectionIndex:io,metrics:Mc,rect:Ll}),oi+=pA*un.scale+Br):(no.push({glyph:Vs,imageName:Fl,x:oi,y:di+fs,vertical:Pc,scale:un.scale,fontStack:un.fontStack,sectionIndex:io,metrics:Mc,rect:Ll}),oi+=Mc.advance*un.scale+Br)}no.length!==0&&(us=Math.max(oi-Br,us),W_t(no,0,no.length-1,So,na)),oi=0;const ia=ke*hs+na;Lo.lineOffset=Math.max(na,ro),di+=ia,Ca=Math.max(ia,Ca),++$i}var Es;const Gs=di-Mm,{horizontalAlign:To,verticalAlign:Io}=bE(sr);(function(As,hs,ro,Lo,no,na,ia,ds,un){const io=(hs-ro)*no;let Vs=0;Vs=na!==ia?-ds*Lo-Mm:(-Lo*un+.5)*ia;for(const fs of As)for(const Mc of fs.positionedGlyphs)Mc.x+=io,Mc.y+=Vs})(be.positionedLines,So,To,Io,us,Ca,ke,Gs,Ke.length),be.top+=-Io*Gs,be.bottom=be.top+Gs,be.left+=-To*us,be.right=be.left+us}(ve,c,h,p,kt,I,F,O,X,G,nt,Bt),!function(be){for(const Je of be)if(Je.positionedGlyphs.length!==0)return!1;return!0}(Kt)&&ve}const F_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},q_t={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function k6(u,c,h,p,v,S){if(c.imageName){const I=p[c.imageName];return I?I.displaySize[0]*c.scale*ls/S+v:0}{const I=h[c.fontStack],F=I&&I[u];return F?F.metrics.advance*c.scale+v:0}}function N6(u,c,h,p){const v=Math.pow(u-c,2);return p?u<c?v/2:2*v:v+Math.abs(h)*h}function K_t(u,c,h){let p=0;return u===10&&(p-=1e4),h&&(p+=150),u!==40&&u!==65288||(p+=50),c!==41&&c!==65289||(p+=50),p}function Q6(u,c,h,p,v,S){let I=null,F=N6(c,h,v,S);for(const O of p){const G=N6(c-O.x,h,v,S)+O.badness;G<=F&&(I=O,F=G)}return{index:u,x:c,priorBreak:I,badness:F}}function H6(u){return u?H6(u.priorBreak).concat(u.index):[]}function vE(u,c,h,p,v,S,I){if(S!=="point")return[];if(!u)return[];const F=[],O=function(nt,at,ut,Bt,It,kt){let ee=0;for(let Ht=0;Ht<nt.length();Ht++){const Kt=nt.getSection(Ht);ee+=k6(nt.getCharCode(Ht),Kt,Bt,It,at,kt)}return ee/Math.max(1,Math.ceil(ee/ut))}(u,c,h,p,v,I),G=u.text.indexOf("")>=0;let K=0;for(let nt=0;nt<u.length();nt++){const at=u.getSection(nt),ut=u.getCharCode(nt);if(F_[ut]||(K+=k6(ut,at,p,v,c,I)),nt<u.length()-1){const Bt=!((X=ut)<11904||!(je["Bopomofo Extended"](X)||je.Bopomofo(X)||je["CJK Compatibility Forms"](X)||je["CJK Compatibility Ideographs"](X)||je["CJK Compatibility"](X)||je["CJK Radicals Supplement"](X)||je["CJK Strokes"](X)||je["CJK Symbols and Punctuation"](X)||je["CJK Unified Ideographs Extension A"](X)||je["CJK Unified Ideographs"](X)||je["Enclosed CJK Letters and Months"](X)||je["Halfwidth and Fullwidth Forms"](X)||je.Hiragana(X)||je["Ideographic Description Characters"](X)||je["Kangxi Radicals"](X)||je["Katakana Phonetic Extensions"](X)||je.Katakana(X)||je["Vertical Forms"](X)||je["Yi Radicals"](X)||je["Yi Syllables"](X)));(q_t[ut]||Bt||at.imageName)&&F.push(Q6(nt+1,K,O,F,K_t(ut,u.getCharCode(nt+1),Bt&&G),!1))}}var X;return H6(Q6(u.length(),K,O,F,0,!0))}function bE(u){let c=.5,h=.5;switch(u){case"right":case"top-right":case"bottom-right":c=1;break;case"left":case"top-left":case"bottom-left":c=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:c,verticalAlign:h}}function W_t(u,c,h,p,v){if(!p&&!v)return;const S=u[h],I=(u[h].x+S.metrics.advance*S.scale)*p;for(let F=c;F<=h;F++)u[F].x-=I,u[F].y+=v}function $_t(u,c,h){const{horizontalAlign:p,verticalAlign:v}=bE(h),S=c[0]-u.displaySize[0]*p,I=c[1]-u.displaySize[1]*v;return{image:u,top:I,bottom:I+u.displaySize[1],left:S,right:S+u.displaySize[0]}}function z6(u,c,h,p,v,S){const I=u.image;let F;if(I.content){const It=I.content,kt=I.pixelRatio||1;F=[It[0]/kt,It[1]/kt,I.displaySize[0]-It[2]/kt,I.displaySize[1]-It[3]/kt]}const O=c.left*S,G=c.right*S;let K,X,nt,at;h==="width"||h==="both"?(at=v[0]+O-p[3],X=v[0]+G+p[1]):(at=v[0]+(O+G-I.displaySize[0])/2,X=at+I.displaySize[0]);const ut=c.top*S,Bt=c.bottom*S;return h==="height"||h==="both"?(K=v[1]+ut-p[0],nt=v[1]+Bt+p[2]):(K=v[1]+(ut+Bt-I.displaySize[1])/2,nt=K+I.displaySize[1]),{image:I,top:K,right:X,bottom:nt,left:at,collisionPadding:F}}const Um=255,mu=128,mh=Um*mu;function G6(u,c){const{expression:h}=c;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new Hn(u+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:v}=h;let S=0;for(;S<p.length&&p[S]<=u;)S++;S=Math.max(0,S-1);let I=S;for(;I<p.length&&p[I]<u+1;)I++;I=Math.min(p.length-1,I);const F=p[S],O=p[I];return h.kind==="composite"?{kind:"composite",minZoom:F,maxZoom:O,interpolationType:v}:{kind:"camera",minZoom:F,maxZoom:O,minSize:h.evaluate(new Hn(F)),maxSize:h.evaluate(new Hn(O)),interpolationType:v}}}function wE(u,c,h){let p="never";const v=u.get(c);return v?p=v:u.get(h)&&(p="always"),p}const X_t=ph.VectorTileFeature.types,Y_t=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function M_(u,c,h,p,v,S,I,F,O,G,K,X,nt){const at=F?Math.min(mh,Math.round(F[0])):0,ut=F?Math.min(mh,Math.round(F[1])):0;u.emplaceBack(c,h,Math.round(32*p),Math.round(32*v),S,I,(at<<1)+(O?1:0),ut,16*G,16*K,256*X,256*nt)}function xE(u,c,h){u.emplaceBack(c.x,c.y,h),u.emplaceBack(c.x,c.y,h),u.emplaceBack(c.x,c.y,h),u.emplaceBack(c.x,c.y,h)}function J_t(u){for(const c of u.sections)if(dd(c.text))return!0;return!1}class BE{constructor(c){this.layoutVertexArray=new lt,this.indexArray=new Tt,this.programConfigurations=c,this.segments=new $t,this.dynamicLayoutVertexArray=new rt,this.opacityVertexArray=new ht,this.hasVisibleVertices=!1,this.placedSymbolArray=new d}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(c,h,p,v){this.isEmpty()||(p&&(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,I_t.members),this.indexBuffer=c.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=c.createVertexBuffer(this.dynamicLayoutVertexArray,L_t.members,!0),this.opacityVertexBuffer=c.createVertexBuffer(this.opacityVertexArray,Y_t,!0),this.opacityVertexBuffer.itemSize=1),(p||v)&&this.programConfigurations.upload(c))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ze("SymbolBuffers",BE);class CE{constructor(c,h,p){this.layoutVertexArray=new c,this.layoutAttributes=h,this.indexArray=new p,this.segments=new $t,this.collisionVertexArray=new Pt}upload(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=c.createVertexBuffer(this.collisionVertexArray,F_t.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ze("CollisionBuffers",CE);class _p{constructor(c){this.collisionBoxArray=c.collisionBoxArray,this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(I=>I.id),this.index=c.index,this.pixelRatio=c.pixelRatio,this.sourceLayerIndex=c.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=lh([]),this.placementViewportMatrix=lh([]);const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=G6(this.zoom,h["text-size"]),this.iconSizeData=G6(this.zoom,h["icon-size"]);const p=this.layers[0].layout,v=p.get("symbol-sort-key"),S=p.get("symbol-z-order");this.canOverlap=wE(p,"text-overlap","text-allow-overlap")!=="never"||wE(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=S!=="viewport-y"&&!v.isConstant(),this.sortFeaturesByY=(S==="viewport-y"||S==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map(I=>a.ah[I])),this.stateDependentLayerIds=this.layers.filter(I=>I.isStateDependent()).map(I=>I.id),this.sourceID=c.sourceID}createArrays(){this.text=new BE(new En(this.layers,this.zoom,c=>/^text/.test(c))),this.icon=new BE(new En(this.layers,this.zoom,c=>/^icon/.test(c))),this.glyphOffsetArray=new E,this.lineVertexArray=new P,this.symbolInstances=new _,this.textAnchorOffsets=new g}calculateGlyphDependencies(c,h,p,v,S){for(let I=0;I<c.length;I++)if(h[c.charCodeAt(I)]=!0,(p||v)&&S){const F=Fm[c.charAt(I)];F&&(h[F.charCodeAt(0)]=!0)}}populate(c,h,p){const v=this.layers[0],S=v.layout,I=S.get("text-font"),F=S.get("text-field"),O=S.get("icon-image"),G=(F.value.kind!=="constant"||F.value.value instanceof yn&&!F.value.value.isEmpty()||F.value.value.toString().length>0)&&(I.value.kind!=="constant"||I.value.value.length>0),K=O.value.kind!=="constant"||!!O.value.value||Object.keys(O.parameters).length>0,X=S.get("symbol-sort-key");if(this.features=[],!G&&!K)return;const nt=h.iconDependencies,at=h.glyphDependencies,ut=h.availableImages,Bt=new Hn(this.zoom);for(const{feature:It,id:kt,index:ee,sourceLayerIndex:Ht}of c){const Kt=v._featureFilter.needGeometry,ve=Ic(It,Kt);if(!v._featureFilter.filter(Bt,ve,p))continue;let be,Je;if(Kt||(ve.geometry=Tc(It)),G){const $e=v.getValueAndResolveTokens("text-field",ve,p,ut),Ke=yn.factory($e),ke=this.hasRTLText=this.hasRTLText||J_t(Ke);(!ke||Ka.getRTLTextPluginStatus()==="unavailable"||ke&&Ka.isParsed())&&(be=P_t(Ke,v,ve))}if(K){const $e=v.getValueAndResolveTokens("icon-image",ve,p,ut);Je=$e instanceof os?$e:os.fromString($e)}if(!be&&!Je)continue;const Ar=this.sortFeaturesByKey?X.evaluate(ve,{},p):void 0;if(this.features.push({id:kt,text:be,icon:Je,index:ee,sourceLayerIndex:Ht,geometry:ve.geometry,properties:It.properties,type:X_t[It.type],sortKey:Ar}),Je&&(nt[Je.name]=!0),be){const $e=I.evaluate(ve,{},p).join(","),Ke=S.get("text-rotation-alignment")!=="viewport"&&S.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.ah.vertical)>=0;for(const ke of be.sections)if(ke.image)nt[ke.image.name]=!0;else{const sr=qi(be.toString()),Ve=ke.fontStack||$e,Le=at[Ve]=at[Ve]||{};this.calculateGlyphDependencies(ke.text,Le,Ke,this.allowVerticalPlacement,sr)}}}S.get("symbol-placement")==="line"&&(this.features=function(It){const kt={},ee={},Ht=[];let Kt=0;function ve($e){Ht.push(It[$e]),Kt++}function be($e,Ke,ke){const sr=ee[$e];return delete ee[$e],ee[Ke]=sr,Ht[sr].geometry[0].pop(),Ht[sr].geometry[0]=Ht[sr].geometry[0].concat(ke[0]),sr}function Je($e,Ke,ke){const sr=kt[Ke];return delete kt[Ke],kt[$e]=sr,Ht[sr].geometry[0].shift(),Ht[sr].geometry[0]=ke[0].concat(Ht[sr].geometry[0]),sr}function Ar($e,Ke,ke){const sr=ke?Ke[0][Ke[0].length-1]:Ke[0][0];return`${$e}:${sr.x}:${sr.y}`}for(let $e=0;$e<It.length;$e++){const Ke=It[$e],ke=Ke.geometry,sr=Ke.text?Ke.text.toString():null;if(!sr){ve($e);continue}const Ve=Ar(sr,ke),Le=Ar(sr,ke,!0);if(Ve in ee&&Le in kt&&ee[Ve]!==kt[Le]){const Br=Je(Ve,Le,ke),fr=be(Ve,Le,Ht[Br].geometry);delete kt[Ve],delete ee[Le],ee[Ar(sr,Ht[fr].geometry,!0)]=fr,Ht[Br].geometry=null}else Ve in ee?be(Ve,Le,ke):Le in kt?Je(Ve,Le,ke):(ve($e),kt[Ve]=Kt-1,ee[Le]=Kt-1)}return Ht.filter($e=>$e.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((It,kt)=>It.sortKey-kt.sortKey)}update(c,h,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(c,h,this.layers,p),this.icon.programConfigurations.updatePaintArrays(c,h,this.layers,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(c){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(c),this.iconCollisionBox.upload(c)),this.text.upload(c,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(c,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(c,h){const p=this.lineVertexArray.length;if(c.segment!==void 0){let v=c.dist(h[c.segment+1]),S=c.dist(h[c.segment]);const I={};for(let F=c.segment+1;F<h.length;F++)I[F]={x:h[F].x,y:h[F].y,tileUnitDistanceFromAnchor:v},F<h.length-1&&(v+=h[F+1].dist(h[F]));for(let F=c.segment||0;F>=0;F--)I[F]={x:h[F].x,y:h[F].y,tileUnitDistanceFromAnchor:S},F>0&&(S+=h[F-1].dist(h[F]));for(let F=0;F<h.length;F++){const O=I[F];this.lineVertexArray.emplaceBack(O.x,O.y,O.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(c,h,p,v,S,I,F,O,G,K,X,nt){const at=c.indexArray,ut=c.layoutVertexArray,Bt=c.segments.prepareSegment(4*h.length,ut,at,this.canOverlap?I.sortKey:void 0),It=this.glyphOffsetArray.length,kt=Bt.vertexLength,ee=this.allowVerticalPlacement&&F===a.ah.vertical?Math.PI/2:0,Ht=I.text&&I.text.sections;for(let Kt=0;Kt<h.length;Kt++){const{tl:ve,tr:be,bl:Je,br:Ar,tex:$e,pixelOffsetTL:Ke,pixelOffsetBR:ke,minFontScaleX:sr,minFontScaleY:Ve,glyphOffset:Le,isSDF:Br,sectionIndex:fr}=h[Kt],tn=Bt.vertexLength,oi=Le[1];M_(ut,O.x,O.y,ve.x,oi+ve.y,$e.x,$e.y,p,Br,Ke.x,Ke.y,sr,Ve),M_(ut,O.x,O.y,be.x,oi+be.y,$e.x+$e.w,$e.y,p,Br,ke.x,Ke.y,sr,Ve),M_(ut,O.x,O.y,Je.x,oi+Je.y,$e.x,$e.y+$e.h,p,Br,Ke.x,ke.y,sr,Ve),M_(ut,O.x,O.y,Ar.x,oi+Ar.y,$e.x+$e.w,$e.y+$e.h,p,Br,ke.x,ke.y,sr,Ve),xE(c.dynamicLayoutVertexArray,O,ee),at.emplaceBack(tn,tn+1,tn+2),at.emplaceBack(tn+1,tn+2,tn+3),Bt.vertexLength+=4,Bt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Le[0]),Kt!==h.length-1&&fr===h[Kt+1].sectionIndex||c.programConfigurations.populatePaintArrays(ut.length,I,I.index,{},nt,Ht&&Ht[fr])}c.placedSymbolArray.emplaceBack(O.x,O.y,It,this.glyphOffsetArray.length-It,kt,G,K,O.segment,p?p[0]:0,p?p[1]:0,v[0],v[1],F,0,!1,0,X)}_addCollisionDebugVertex(c,h,p,v,S,I){return h.emplaceBack(0,0),c.emplaceBack(p.x,p.y,v,S,Math.round(I.x),Math.round(I.y))}addCollisionDebugVertices(c,h,p,v,S,I,F){const O=S.segments.prepareSegment(4,S.layoutVertexArray,S.indexArray),G=O.vertexLength,K=S.layoutVertexArray,X=S.collisionVertexArray,nt=F.anchorX,at=F.anchorY;this._addCollisionDebugVertex(K,X,I,nt,at,new b(c,h)),this._addCollisionDebugVertex(K,X,I,nt,at,new b(p,h)),this._addCollisionDebugVertex(K,X,I,nt,at,new b(p,v)),this._addCollisionDebugVertex(K,X,I,nt,at,new b(c,v)),O.vertexLength+=4;const ut=S.indexArray;ut.emplaceBack(G,G+1),ut.emplaceBack(G+1,G+2),ut.emplaceBack(G+2,G+3),ut.emplaceBack(G+3,G),O.primitiveLength+=4}addDebugCollisionBoxes(c,h,p,v){for(let S=c;S<h;S++){const I=this.collisionBoxArray.get(S);this.addCollisionDebugVertices(I.x1,I.y1,I.x2,I.y2,v?this.textCollisionBox:this.iconCollisionBox,I.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new CE(gt,S6.members,_t),this.iconCollisionBox=new CE(gt,S6.members,_t);for(let c=0;c<this.symbolInstances.length;c++){const h=this.symbolInstances.get(c);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(c,h,p,v,S,I,F,O,G){const K={};for(let X=h;X<p;X++){const nt=c.get(X);K.textBox={x1:nt.x1,y1:nt.y1,x2:nt.x2,y2:nt.y2,anchorPointX:nt.anchorPointX,anchorPointY:nt.anchorPointY},K.textFeatureIndex=nt.featureIndex;break}for(let X=v;X<S;X++){const nt=c.get(X);K.verticalTextBox={x1:nt.x1,y1:nt.y1,x2:nt.x2,y2:nt.y2,anchorPointX:nt.anchorPointX,anchorPointY:nt.anchorPointY},K.verticalTextFeatureIndex=nt.featureIndex;break}for(let X=I;X<F;X++){const nt=c.get(X);K.iconBox={x1:nt.x1,y1:nt.y1,x2:nt.x2,y2:nt.y2,anchorPointX:nt.anchorPointX,anchorPointY:nt.anchorPointY},K.iconFeatureIndex=nt.featureIndex;break}for(let X=O;X<G;X++){const nt=c.get(X);K.verticalIconBox={x1:nt.x1,y1:nt.y1,x2:nt.x2,y2:nt.y2,anchorPointX:nt.anchorPointX,anchorPointY:nt.anchorPointY},K.verticalIconFeatureIndex=nt.featureIndex;break}return K}deserializeCollisionBoxes(c){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const p=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(c,h){const p=c.placedSymbolArray.get(h),v=p.vertexStartIndex+4*p.numGlyphs;for(let S=p.vertexStartIndex;S<v;S+=4)c.indexArray.emplaceBack(S,S+1,S+2),c.indexArray.emplaceBack(S+1,S+2,S+3)}getSortedSymbolIndexes(c){if(this.sortedAngle===c&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(c),p=Math.cos(c),v=[],S=[],I=[];for(let F=0;F<this.symbolInstances.length;++F){I.push(F);const O=this.symbolInstances.get(F);v.push(0|Math.round(h*O.anchorX+p*O.anchorY)),S.push(O.featureIndex)}return I.sort((F,O)=>v[F]-v[O]||S[O]-S[F]),I}addToSortKeyRanges(c,h){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===h?p.symbolInstanceEnd=c+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:c,symbolInstanceEnd:c+1})}sortFeatures(c){if(this.sortFeaturesByY&&this.sortedAngle!==c&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(c),this.sortedAngle=c,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const p=this.symbolInstances.get(h);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach((v,S,I)=>{v>=0&&I.indexOf(v)===S&&this.addIndicesForPlacedSymbol(this.text,v)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let V6,j6;Ze("SymbolBucket",_p,{omit:["layers","collisionBoxArray","features","compareText"]}),_p.MAX_GLYPHS=65535,_p.addDynamicAttributes=xE;var EE={get paint(){return j6=j6||new Ki({"icon-opacity":new br(Yt.paint_symbol["icon-opacity"]),"icon-color":new br(Yt.paint_symbol["icon-color"]),"icon-halo-color":new br(Yt.paint_symbol["icon-halo-color"]),"icon-halo-width":new br(Yt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new br(Yt.paint_symbol["icon-halo-blur"]),"icon-translate":new hr(Yt.paint_symbol["icon-translate"]),"icon-translate-anchor":new hr(Yt.paint_symbol["icon-translate-anchor"]),"text-opacity":new br(Yt.paint_symbol["text-opacity"]),"text-color":new br(Yt.paint_symbol["text-color"],{runtimeType:Yr,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new br(Yt.paint_symbol["text-halo-color"]),"text-halo-width":new br(Yt.paint_symbol["text-halo-width"]),"text-halo-blur":new br(Yt.paint_symbol["text-halo-blur"]),"text-translate":new hr(Yt.paint_symbol["text-translate"]),"text-translate-anchor":new hr(Yt.paint_symbol["text-translate-anchor"])})},get layout(){return V6=V6||new Ki({"symbol-placement":new hr(Yt.layout_symbol["symbol-placement"]),"symbol-spacing":new hr(Yt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new hr(Yt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new br(Yt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new hr(Yt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new hr(Yt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new hr(Yt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new hr(Yt.layout_symbol["icon-ignore-placement"]),"icon-optional":new hr(Yt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new hr(Yt.layout_symbol["icon-rotation-alignment"]),"icon-size":new br(Yt.layout_symbol["icon-size"]),"icon-text-fit":new hr(Yt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new hr(Yt.layout_symbol["icon-text-fit-padding"]),"icon-image":new br(Yt.layout_symbol["icon-image"]),"icon-rotate":new br(Yt.layout_symbol["icon-rotate"]),"icon-padding":new br(Yt.layout_symbol["icon-padding"]),"icon-keep-upright":new hr(Yt.layout_symbol["icon-keep-upright"]),"icon-offset":new br(Yt.layout_symbol["icon-offset"]),"icon-anchor":new br(Yt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new hr(Yt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new hr(Yt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new hr(Yt.layout_symbol["text-rotation-alignment"]),"text-field":new br(Yt.layout_symbol["text-field"]),"text-font":new br(Yt.layout_symbol["text-font"]),"text-size":new br(Yt.layout_symbol["text-size"]),"text-max-width":new br(Yt.layout_symbol["text-max-width"]),"text-line-height":new hr(Yt.layout_symbol["text-line-height"]),"text-letter-spacing":new br(Yt.layout_symbol["text-letter-spacing"]),"text-justify":new br(Yt.layout_symbol["text-justify"]),"text-radial-offset":new br(Yt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new hr(Yt.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new br(Yt.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new br(Yt.layout_symbol["text-anchor"]),"text-max-angle":new hr(Yt.layout_symbol["text-max-angle"]),"text-writing-mode":new hr(Yt.layout_symbol["text-writing-mode"]),"text-rotate":new br(Yt.layout_symbol["text-rotate"]),"text-padding":new hr(Yt.layout_symbol["text-padding"]),"text-keep-upright":new hr(Yt.layout_symbol["text-keep-upright"]),"text-transform":new br(Yt.layout_symbol["text-transform"]),"text-offset":new br(Yt.layout_symbol["text-offset"]),"text-allow-overlap":new hr(Yt.layout_symbol["text-allow-overlap"]),"text-overlap":new hr(Yt.layout_symbol["text-overlap"]),"text-ignore-placement":new hr(Yt.layout_symbol["text-ignore-placement"]),"text-optional":new hr(Yt.layout_symbol["text-optional"])})}};class q6{constructor(c){if(c.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=c.property.overrides?c.property.overrides.runtimeType:Fr,this.defaultValue=c}evaluate(c){if(c.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(c.formattedSection))return h.getOverride(c.formattedSection)}return c.feature&&c.featureState?this.defaultValue.evaluate(c.feature,c.featureState):this.defaultValue.property.specification.default}eachChild(c){this.defaultValue.isConstant()||c(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ze("FormatSectionOverride",q6,{omit:["defaultValue"]});class P_ extends Jo{constructor(c){super(c,EE)}recalculate(c,h){if(super.recalculate(c,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const v=[];for(const S of p)v.indexOf(S)<0&&v.push(S);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(c,h,p,v){const S=this.layout.get(c).evaluate(h,{},p,v),I=this._unevaluatedLayout._values[c];return I.isDataDriven()||$r(I.value)||!S?S:function(F,O){return O.replace(/{([^{}]+)}/g,(G,K)=>F&&K in F?String(F[K]):"")}(h.properties,S)}createBucket(c){return new _p(c)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const c of EE.paint.overridableProperties){if(!P_.hasPaintOverride(this.layout,c))continue;const h=this.paint.get(c),p=new q6(h),v=new qr(p,h.property.specification);let S=null;S=h.value.kind==="constant"||h.value.kind==="source"?new Ds("source",v):new ks("composite",v,h.value.zoomStops),this.paint._values[c]=new Yo(h.property,S,h.parameters)}}_handleOverridablePaintPropertyUpdate(c,h,p){return!(!this.layout||h.isDataDriven()||p.isDataDriven())&&P_.hasPaintOverride(this.layout,c)}static hasPaintOverride(c,h){const p=c.get("text-field"),v=EE.paint.properties[h];let S=!1;const I=F=>{for(const O of F)if(v.overrides&&v.overrides.hasOverride(O))return void(S=!0)};if(p.value.kind==="constant"&&p.value.value instanceof yn)I(p.value.value.sections);else if(p.value.kind==="source"){const F=G=>{S||(G instanceof Bs&&Or(G.value)===Kr?I(G.value.sections):G instanceof _c?I(G.sections):G.eachChild(F))},O=p.value;O._styleExpression&&F(O._styleExpression.expression)}return S}}let K6;var Z_t={get paint(){return K6=K6||new Ki({"background-color":new hr(Yt.paint_background["background-color"]),"background-pattern":new xl(Yt.paint_background["background-pattern"]),"background-opacity":new hr(Yt.paint_background["background-opacity"])})}};class tvt extends Jo{constructor(c){super(c,Z_t)}}let W6;var evt={get paint(){return W6=W6||new Ki({"raster-opacity":new hr(Yt.paint_raster["raster-opacity"]),"raster-hue-rotate":new hr(Yt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new hr(Yt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new hr(Yt.paint_raster["raster-brightness-max"]),"raster-saturation":new hr(Yt.paint_raster["raster-saturation"]),"raster-contrast":new hr(Yt.paint_raster["raster-contrast"]),"raster-resampling":new hr(Yt.paint_raster["raster-resampling"]),"raster-fade-duration":new hr(Yt.paint_raster["raster-fade-duration"])})}};class rvt extends Jo{constructor(c){super(c,evt)}}class nvt extends Jo{constructor(c){super(c,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=c}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class ivt{constructor(c){this._methodToThrottle=c,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const SE=63710088e-1;class yh{constructor(c,h){if(isNaN(c)||isNaN(h))throw new Error(`Invalid LngLat object: (${c}, ${h})`);if(this.lng=+c,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new yh(pt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(c){const h=Math.PI/180,p=this.lat*h,v=c.lat*h,S=Math.sin(p)*Math.sin(v)+Math.cos(p)*Math.cos(v)*Math.cos((c.lng-this.lng)*h);return SE*Math.acos(Math.min(S,1))}static convert(c){if(c instanceof yh)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new yh(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&typeof c=="object"&&c!==null)return new yh(Number("lng"in c?c.lng:c.lon),Number(c.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const $6=2*Math.PI*SE;function X6(u){return $6*Math.cos(u*Math.PI/180)}function Y6(u){return(180+u)/360}function J6(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function Z6(u,c){return u/X6(c)}function TE(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}class U_{constructor(c,h){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;this.x=+c,this.y=+h,this.z=+p}static fromLngLat(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const p=yh.convert(c);return new U_(Y6(p.lng),J6(p.lat),Z6(h,p.lat))}toLngLat(){return new yh(360*this.x-180,TE(this.y))}toAltitude(){return this.z*X6(TE(this.y))}meterInMercatorCoordinateUnits(){return 1/$6*(c=TE(this.y),1/Math.cos(c*Math.PI/180));var c}}function tk(u,c,h){var p=2*Math.PI*6378137/256/Math.pow(2,h);return[u*p-2*Math.PI*6378137/2,c*p-2*Math.PI*6378137/2]}class IE{constructor(c,h,p){if(c<0||c>25||p<0||p>=Math.pow(2,c)||h<0||h>=Math.pow(2,c))throw new Error(`x=${h}, y=${p}, z=${c} outside of bounds. 0<=x<${Math.pow(2,c)}, 0<=y<${Math.pow(2,c)} 0<=z<=25 `);this.z=c,this.x=h,this.y=p,this.key=Rm(0,c,c,h,p)}equals(c){return this.z===c.z&&this.x===c.x&&this.y===c.y}url(c,h,p){const v=(I=this.y,F=this.z,O=tk(256*(S=this.x),256*(I=Math.pow(2,F)-I-1),F),G=tk(256*(S+1),256*(I+1),F),O[0]+","+O[1]+","+G[0]+","+G[1]);var S,I,F,O,G;const K=function(X,nt,at){let ut,Bt="";for(let It=X;It>0;It--)ut=1<<It-1,Bt+=(nt&ut?1:0)+(at&ut?2:0);return Bt}(this.z,this.x,this.y);return c[(this.x+this.y)%c.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,K).replace(/{bbox-epsg-3857}/g,v)}isChildOf(c){const h=this.z-c.z;return h>0&&c.x===this.x>>h&&c.y===this.y>>h}getTilePoint(c){const h=Math.pow(2,this.z);return new b((c.x*h-this.x)*Un,(c.y*h-this.y)*Un)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ek{constructor(c,h){this.wrap=c,this.canonical=h,this.key=Rm(c,h.z,h.z,h.x,h.y)}}class $a{constructor(c,h,p,v,S){if(c<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${c}; z = ${p}`);this.overscaledZ=c,this.wrap=h,this.canonical=new IE(p,+v,+S),this.key=Rm(h,c,p,v,S)}clone(){return new $a(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(c){return this.overscaledZ===c.overscaledZ&&this.wrap===c.wrap&&this.canonical.equals(c.canonical)}scaledTo(c){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-c;return c>this.canonical.z?new $a(c,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new $a(c,this.wrap,c,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(c,h){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-c;return c>this.canonical.z?Rm(this.wrap*+h,c,this.canonical.z,this.canonical.x,this.canonical.y):Rm(this.wrap*+h,c,c,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(c){if(c.wrap!==this.wrap)return!1;const h=this.canonical.z-c.canonical.z;return c.overscaledZ===0||c.overscaledZ<this.overscaledZ&&c.canonical.x===this.canonical.x>>h&&c.canonical.y===this.canonical.y>>h}children(c){if(this.overscaledZ>=c)return[new $a(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,p=2*this.canonical.x,v=2*this.canonical.y;return[new $a(h,this.wrap,h,p,v),new $a(h,this.wrap,h,p+1,v),new $a(h,this.wrap,h,p,v+1),new $a(h,this.wrap,h,p+1,v+1)]}isLessThan(c){return this.wrap<c.wrap||!(this.wrap>c.wrap)&&(this.overscaledZ<c.overscaledZ||!(this.overscaledZ>c.overscaledZ)&&(this.canonical.x<c.canonical.x||!(this.canonical.x>c.canonical.x)&&this.canonical.y<c.canonical.y))}wrapped(){return new $a(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(c){return new $a(this.overscaledZ,c,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ek(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(c){return this.canonical.getTilePoint(new U_(c.x-this.wrap,c.y))}}function Rm(u,c,h,p,v){(u*=2)<0&&(u=-1*u-1);const S=1<<h;return(S*S*u+S*v+p).toString(36)+h.toString(36)+c.toString(36)}Ze("CanonicalTileID",IE),Ze("OverscaledTileID",$a,{omit:["posMatrix"]});class rk{constructor(c,h,p){let v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,I=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1,F=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0;if(this.uid=c,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(p&&!["mapbox","terrarium","custom"].includes(p))return void wt(`"${p}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;const O=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),p){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=v,this.greenFactor=S,this.blueFactor=I,this.baseShift=F;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let G=0;G<O;G++)this.data[this._idx(-1,G)]=this.data[this._idx(0,G)],this.data[this._idx(O,G)]=this.data[this._idx(O-1,G)],this.data[this._idx(G,-1)]=this.data[this._idx(G,0)],this.data[this._idx(G,O)]=this.data[this._idx(G,O-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(O,-1)]=this.data[this._idx(O-1,0)],this.data[this._idx(-1,O)]=this.data[this._idx(0,O-1)],this.data[this._idx(O,O)]=this.data[this._idx(O-1,O-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let G=0;G<O;G++)for(let K=0;K<O;K++){const X=this.get(G,K);X>this.max&&(this.max=X),X<this.min&&(this.min=X)}}get(c,h){const p=new Uint8Array(this.data.buffer),v=4*this._idx(c,h);return this.unpack(p[v],p[v+1],p[v+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(c,h){if(c<-1||c>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(c+1)}unpack(c,h,p){return c*this.redFactor+h*this.greenFactor+p*this.blueFactor-this.baseShift}getPixels(){return new ea({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(c,h,p){if(this.dim!==c.dim)throw new Error("dem dimension mismatch");let v=h*this.dim,S=h*this.dim+this.dim,I=p*this.dim,F=p*this.dim+this.dim;switch(h){case-1:v=S-1;break;case 1:S=v+1}switch(p){case-1:I=F-1;break;case 1:F=I+1}const O=-h*this.dim,G=-p*this.dim;for(let K=I;K<F;K++)for(let X=v;X<S;X++)this.data[this._idx(X,K)]=c.data[this._idx(X+O,K+G)]}}Ze("DEMData",rk);class nk{constructor(c){this._stringToNumber={},this._numberToString=[];for(let h=0;h<c.length;h++){const p=c[h];this._stringToNumber[p]=h,this._numberToString[h]=p}}encode(c){return this._stringToNumber[c]}decode(c){if(c>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${c} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[c]}}class ik{constructor(c,h,p,v,S){this.type="Feature",this._vectorTileFeature=c,c._z=h,c._x=p,c._y=v,this.properties=c.properties,this.id=S}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(c){this._geometry=c}toJSON(){const c={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(c[h]=this[h]);return c}}class sk{constructor(c,h){this.tileID=c,this.x=c.canonical.x,this.y=c.canonical.y,this.z=c.canonical.z,this.grid=new Au(Un,16,0),this.grid3D=new Au(Un,16,0),this.featureIndexArray=new T,this.promoteId=h}insert(c,h,p,v,S,I){const F=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,v,S);const O=I?this.grid3D:this.grid;for(let G=0;G<h.length;G++){const K=h[G],X=[1/0,1/0,-1/0,-1/0];for(let nt=0;nt<K.length;nt++){const at=K[nt];X[0]=Math.min(X[0],at.x),X[1]=Math.min(X[1],at.y),X[2]=Math.max(X[2],at.x),X[3]=Math.max(X[3],at.y)}X[0]<Un&&X[1]<Un&&X[2]>=0&&X[3]>=0&&O.insert(F,X[0],X[1],X[2],X[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new ph.VectorTile(new mE(this.rawTileData)).layers,this.sourceLayerCoder=new nk(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(c,h,p,v){this.loadVTLayers();const S=c.params||{},I=Un/c.tileSize/c.scale,F=xc(S.filter),O=c.queryGeometry,G=c.queryPadding*I,K=ak(O),X=this.grid.query(K.minX-G,K.minY-G,K.maxX+G,K.maxY+G),nt=ak(c.cameraQueryGeometry),at=this.grid3D.query(nt.minX-G,nt.minY-G,nt.maxX+G,nt.maxY+G,(It,kt,ee,Ht)=>function(Kt,ve,be,Je,Ar){for(const Ke of Kt)if(ve<=Ke.x&&be<=Ke.y&&Je>=Ke.x&&Ar>=Ke.y)return!0;const $e=[new b(ve,be),new b(ve,Ar),new b(Je,Ar),new b(Je,be)];if(Kt.length>2){for(const Ke of $e)if(Sl(Kt,Ke))return!0}for(let Ke=0;Ke<Kt.length-1;Ke++)if(wd(Kt[Ke],Kt[Ke+1],$e))return!0;return!1}(c.cameraQueryGeometry,It-G,kt-G,ee+G,Ht+G));for(const It of at)X.push(It);X.sort(svt);const ut={};let Bt;for(let It=0;It<X.length;It++){const kt=X[It];if(kt===Bt)continue;Bt=kt;const ee=this.featureIndexArray.get(kt);let Ht=null;this.loadMatchingFeature(ut,ee.bucketIndex,ee.sourceLayerIndex,ee.featureIndex,F,S.layers,S.availableImages,h,p,v,(Kt,ve,be)=>(Ht||(Ht=Tc(Kt)),ve.queryIntersectsFeature(O,Kt,be,Ht,this.z,c.transform,I,c.pixelPosMatrix)))}return ut}loadMatchingFeature(c,h,p,v,S,I,F,O,G,K,X){const nt=this.bucketLayerIDs[h];if(I&&!function(It,kt){for(let ee=0;ee<It.length;ee++)if(kt.indexOf(It[ee])>=0)return!0;return!1}(I,nt))return;const at=this.sourceLayerCoder.decode(p),ut=this.vtLayers[at].feature(v);if(S.needGeometry){const It=Ic(ut,!0);if(!S.filter(new Hn(this.tileID.overscaledZ),It,this.tileID.canonical))return}else if(!S.filter(new Hn(this.tileID.overscaledZ),ut))return;const Bt=this.getId(ut,at);for(let It=0;It<nt.length;It++){const kt=nt[It];if(I&&I.indexOf(kt)<0)continue;const ee=O[kt];if(!ee)continue;let Ht={};Bt&&K&&(Ht=K.getState(ee.sourceLayer||"_geojsonTileLayer",Bt));const Kt=mt({},G[kt]);Kt.paint=ok(Kt.paint,ee.paint,ut,Ht,F),Kt.layout=ok(Kt.layout,ee.layout,ut,Ht,F);const ve=!X||X(ut,ee,Ht);if(!ve)continue;const be=new ik(ut,this.z,this.x,this.y,Bt);be.layer=Kt;let Je=c[kt];Je===void 0&&(Je=c[kt]=[]),Je.push({featureIndex:v,feature:be,intersectionZ:ve})}}lookupSymbolFeatures(c,h,p,v,S,I,F,O){const G={};this.loadVTLayers();const K=xc(S);for(const X of c)this.loadMatchingFeature(G,p,v,X,K,I,F,O,h);return G}hasLayer(c){for(const h of this.bucketLayerIDs)for(const p of h)if(c===p)return!0;return!1}getId(c,h){let p=c.id;return this.promoteId&&(p=c.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof p=="boolean"&&(p=Number(p))),p}}function ok(u,c,h,p,v){return Rt(u,(S,I)=>{const F=c instanceof iA?c.get(I):null;return F&&F.evaluate?F.evaluate(h,p,v):F})}function ak(u){let c=1/0,h=1/0,p=-1/0,v=-1/0;for(const S of u)c=Math.min(c,S.x),h=Math.min(h,S.y),p=Math.max(p,S.x),v=Math.max(v,S.y);return{minX:c,minY:h,maxX:p,maxY:v}}function svt(u,c){return c-u}function ck(u,c,h,p,v){const S=[];for(let I=0;I<u.length;I++){const F=u[I];let O;for(let G=0;G<F.length-1;G++){let K=F[G],X=F[G+1];K.x<c&&X.x<c||(K.x<c?K=new b(c,K.y+(c-K.x)/(X.x-K.x)*(X.y-K.y))._round():X.x<c&&(X=new b(c,K.y+(c-K.x)/(X.x-K.x)*(X.y-K.y))._round()),K.y<h&&X.y<h||(K.y<h?K=new b(K.x+(h-K.y)/(X.y-K.y)*(X.x-K.x),h)._round():X.y<h&&(X=new b(K.x+(h-K.y)/(X.y-K.y)*(X.x-K.x),h)._round()),K.x>=p&&X.x>=p||(K.x>=p?K=new b(p,K.y+(p-K.x)/(X.x-K.x)*(X.y-K.y))._round():X.x>=p&&(X=new b(p,K.y+(p-K.x)/(X.x-K.x)*(X.y-K.y))._round()),K.y>=v&&X.y>=v||(K.y>=v?K=new b(K.x+(v-K.y)/(X.y-K.y)*(X.x-K.x),v)._round():X.y>=v&&(X=new b(K.x+(v-K.y)/(X.y-K.y)*(X.x-K.x),v)._round()),O&&K.equals(O[O.length-1])||(O=[K],S.push(O)),O.push(X)))))}}return S}Ze("FeatureIndex",sk,{omit:["rawTileData","sourceLayerCoder"]});class _h extends b{constructor(c,h,p,v){super(c,h),this.angle=p,v!==void 0&&(this.segment=v)}clone(){return new _h(this.x,this.y,this.angle,this.segment)}}function lk(u,c,h,p,v){if(c.segment===void 0||h===0)return!0;let S=c,I=c.segment+1,F=0;for(;F>-h/2;){if(I--,I<0)return!1;F-=u[I].dist(S),S=u[I]}F+=u[I].dist(u[I+1]),I++;const O=[];let G=0;for(;F<h/2;){const K=u[I],X=u[I+1];if(!X)return!1;let nt=u[I-1].angleTo(K)-K.angleTo(X);for(nt=Math.abs((nt+3*Math.PI)%(2*Math.PI)-Math.PI),O.push({distance:F,angleDelta:nt}),G+=nt;F-O[0].distance>p;)G-=O.shift().angleDelta;if(G>v)return!1;I++,F+=K.dist(X)}return!0}function uk(u){let c=0;for(let h=0;h<u.length-1;h++)c+=u[h].dist(u[h+1]);return c}function Ak(u,c,h){return u?.6*c*h:0}function hk(u,c){return Math.max(u?u.right-u.left:0,c?c.right-c.left:0)}function ovt(u,c,h,p,v,S){const I=Ak(h,v,S),F=hk(h,p)*S;let O=0;const G=uk(u)/2;for(let K=0;K<u.length-1;K++){const X=u[K],nt=u[K+1],at=X.dist(nt);if(O+at>G){const ut=(G-O)/at,Bt=Pi.number(X.x,nt.x,ut),It=Pi.number(X.y,nt.y,ut),kt=new _h(Bt,It,nt.angleTo(X),K);return kt._round(),!I||lk(u,kt,F,I,c)?kt:void 0}O+=at}}function avt(u,c,h,p,v,S,I,F,O){const G=Ak(p,S,I),K=hk(p,v),X=K*I,nt=u[0].x===0||u[0].x===O||u[0].y===0||u[0].y===O;return c-X<c/4&&(c=X+c/4),dk(u,nt?c/2*F%c:(K/2+2*S)*I*F%c,c,G,h,X,nt,!1,O)}function dk(u,c,h,p,v,S,I,F,O){const G=S/2,K=uk(u);let X=0,nt=c-h,at=[];for(let ut=0;ut<u.length-1;ut++){const Bt=u[ut],It=u[ut+1],kt=Bt.dist(It),ee=It.angleTo(Bt);for(;nt+h<X+kt;){nt+=h;const Ht=(nt-X)/kt,Kt=Pi.number(Bt.x,It.x,Ht),ve=Pi.number(Bt.y,It.y,Ht);if(Kt>=0&&Kt<O&&ve>=0&&ve<O&&nt-G>=0&&nt+G<=K){const be=new _h(Kt,ve,ee,ut);be._round(),p&&!lk(u,be,S,p,v)||at.push(be)}}X+=kt}return F||at.length||I||(at=dk(u,X/2,h,p,v,S,I,!0,O)),at}Ze("Anchor",_h);const vp=ra;function fk(u,c,h,p){const v=[],S=u.image,I=S.pixelRatio,F=S.paddedRect.w-2*vp,O=S.paddedRect.h-2*vp,G=u.right-u.left,K=u.bottom-u.top,X=S.stretchX||[[0,F]],nt=S.stretchY||[[0,O]],at=(ke,sr)=>ke+sr[1]-sr[0],ut=X.reduce(at,0),Bt=nt.reduce(at,0),It=F-ut,kt=O-Bt;let ee=0,Ht=ut,Kt=0,ve=Bt,be=0,Je=It,Ar=0,$e=kt;if(S.content&&p){const ke=S.content;ee=R_(X,0,ke[0]),Kt=R_(nt,0,ke[1]),Ht=R_(X,ke[0],ke[2]),ve=R_(nt,ke[1],ke[3]),be=ke[0]-ee,Ar=ke[1]-Kt,Je=ke[2]-ke[0]-Ht,$e=ke[3]-ke[1]-ve}const Ke=(ke,sr,Ve,Le)=>{const Br=O_(ke.stretch-ee,Ht,G,u.left),fr=D_(ke.fixed-be,Je,ke.stretch,ut),tn=O_(sr.stretch-Kt,ve,K,u.top),oi=D_(sr.fixed-Ar,$e,sr.stretch,Bt),di=O_(Ve.stretch-ee,Ht,G,u.left),us=D_(Ve.fixed-be,Je,Ve.stretch,ut),Ca=O_(Le.stretch-Kt,ve,K,u.top),So=D_(Le.fixed-Ar,$e,Le.stretch,Bt),$i=new b(Br,tn),Es=new b(di,tn),Gs=new b(di,Ca),To=new b(Br,Ca),Io=new b(fr/I,oi/I),As=new b(us/I,So/I),hs=c*Math.PI/180;if(hs){const no=Math.sin(hs),na=Math.cos(hs),ia=[na,-no,no,na];$i._matMult(ia),Es._matMult(ia),To._matMult(ia),Gs._matMult(ia)}const ro=ke.stretch+ke.fixed,Lo=sr.stretch+sr.fixed;return{tl:$i,tr:Es,bl:To,br:Gs,tex:{x:S.paddedRect.x+vp+ro,y:S.paddedRect.y+vp+Lo,w:Ve.stretch+Ve.fixed-ro,h:Le.stretch+Le.fixed-Lo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Io,pixelOffsetBR:As,minFontScaleX:Je/I/G,minFontScaleY:$e/I/K,isSDF:h}};if(p&&(S.stretchX||S.stretchY)){const ke=pk(X,It,ut),sr=pk(nt,kt,Bt);for(let Ve=0;Ve<ke.length-1;Ve++){const Le=ke[Ve],Br=ke[Ve+1];for(let fr=0;fr<sr.length-1;fr++)v.push(Ke(Le,sr[fr],Br,sr[fr+1]))}}else v.push(Ke({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:F+1},{fixed:0,stretch:O+1}));return v}function R_(u,c,h){let p=0;for(const v of u)p+=Math.max(c,Math.min(h,v[1]))-Math.max(c,Math.min(h,v[0]));return p}function pk(u,c,h){const p=[{fixed:-vp,stretch:0}];for(const[v,S]of u){const I=p[p.length-1];p.push({fixed:v-I.stretch,stretch:I.stretch}),p.push({fixed:v-I.stretch,stretch:I.stretch+(S-v)})}return p.push({fixed:c+vp,stretch:h}),p}function O_(u,c,h,p){return u/c*h+p}function D_(u,c,h,p){return u-c*h/p}class k_{constructor(c,h,p,v,S,I,F,O,G,K){if(this.boxStartIndex=c.length,G){let X=I.top,nt=I.bottom;const at=I.collisionPadding;at&&(X-=at[1],nt+=at[3]);let ut=nt-X;ut>0&&(ut=Math.max(10,ut),this.circleDiameter=ut)}else{let X=I.top*F-O[0],nt=I.bottom*F+O[2],at=I.left*F-O[3],ut=I.right*F+O[1];const Bt=I.collisionPadding;if(Bt&&(at-=Bt[0]*F,X-=Bt[1]*F,ut+=Bt[2]*F,nt+=Bt[3]*F),K){const It=new b(at,X),kt=new b(ut,X),ee=new b(at,nt),Ht=new b(ut,nt),Kt=K*Math.PI/180;It._rotate(Kt),kt._rotate(Kt),ee._rotate(Kt),Ht._rotate(Kt),at=Math.min(It.x,kt.x,ee.x,Ht.x),ut=Math.max(It.x,kt.x,ee.x,Ht.x),X=Math.min(It.y,kt.y,ee.y,Ht.y),nt=Math.max(It.y,kt.y,ee.y,Ht.y)}c.emplaceBack(h.x,h.y,at,X,ut,nt,p,v,S)}this.boxEndIndex=c.length}}class cvt{constructor(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lvt;if(this.data=c,this.length=this.data.length,this.compare=h,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(c){this.data.push(c),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const c=this.data[0],h=this.data.pop();return this.length--,this.length>0&&(this.data[0]=h,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:h,compare:p}=this,v=h[c];for(;c>0;){const S=c-1>>1,I=h[S];if(p(v,I)>=0)break;h[c]=I,c=S}h[c]=v}_down(c){const{data:h,compare:p}=this,v=this.length>>1,S=h[c];for(;c<v;){let I=1+(c<<1),F=h[I];const O=I+1;if(O<this.length&&p(h[O],F)<0&&(I=O,F=h[O]),p(F,S)>=0)break;h[c]=F,c=I}h[c]=S}}function lvt(u,c){return u<c?-1:u>c?1:0}function uvt(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,p=1/0,v=1/0,S=-1/0,I=-1/0;const F=u[0];for(let at=0;at<F.length;at++){const ut=F[at];(!at||ut.x<p)&&(p=ut.x),(!at||ut.y<v)&&(v=ut.y),(!at||ut.x>S)&&(S=ut.x),(!at||ut.y>I)&&(I=ut.y)}const O=Math.min(S-p,I-v);let G=O/2;const K=new cvt([],Avt);if(O===0)return new b(p,v);for(let at=p;at<S;at+=O)for(let ut=v;ut<I;ut+=O)K.push(new bp(at+G,ut+G,G,u));let X=function(at){let ut=0,Bt=0,It=0;const kt=at[0];for(let ee=0,Ht=kt.length,Kt=Ht-1;ee<Ht;Kt=ee++){const ve=kt[ee],be=kt[Kt],Je=ve.x*be.y-be.x*ve.y;Bt+=(ve.x+be.x)*Je,It+=(ve.y+be.y)*Je,ut+=3*Je}return new bp(Bt/ut,It/ut,0,at)}(u),nt=K.length;for(;K.length;){const at=K.pop();(at.d>X.d||!X.d)&&(X=at,h&&console.log("found best %d after %d probes",Math.round(1e4*at.d)/1e4,nt)),at.max-X.d<=c||(G=at.h/2,K.push(new bp(at.p.x-G,at.p.y-G,G,u)),K.push(new bp(at.p.x+G,at.p.y-G,G,u)),K.push(new bp(at.p.x-G,at.p.y+G,G,u)),K.push(new bp(at.p.x+G,at.p.y+G,G,u)),nt+=4)}return h&&(console.log(`num probes: ${nt}`),console.log(`best distance: ${X.d}`)),X.p}function Avt(u,c){return c.max-u.max}function bp(u,c,h,p){this.p=new b(u,c),this.h=h,this.d=function(v,S){let I=!1,F=1/0;for(let O=0;O<S.length;O++){const G=S[O];for(let K=0,X=G.length,nt=X-1;K<X;nt=K++){const at=G[K],ut=G[nt];at.y>v.y!=ut.y>v.y&&v.x<(ut.x-at.x)*(v.y-at.y)/(ut.y-at.y)+at.x&&(I=!I),F=Math.min(F,bd(v,at,ut))}}return(I?1:-1)*Math.sqrt(F)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}var zs;a.ap=void 0,(zs=a.ap||(a.ap={}))[zs.center=1]="center",zs[zs.left=2]="left",zs[zs.right=3]="right",zs[zs.top=4]="top",zs[zs.bottom=5]="bottom",zs[zs["top-left"]=6]="top-left",zs[zs["top-right"]=7]="top-right",zs[zs["bottom-left"]=8]="bottom-left",zs[zs["bottom-right"]=9]="bottom-right";const vh=7,LE=Number.POSITIVE_INFINITY;function gk(u,c){return c[1]!==LE?function(h,p,v){let S=0,I=0;switch(p=Math.abs(p),v=Math.abs(v),h){case"top-right":case"top-left":case"top":I=v-vh;break;case"bottom-right":case"bottom-left":case"bottom":I=-v+vh}switch(h){case"top-right":case"bottom-right":case"right":S=-p;break;case"top-left":case"bottom-left":case"left":S=p}return[S,I]}(u,c[0],c[1]):function(h,p){let v=0,S=0;p<0&&(p=0);const I=p/Math.SQRT2;switch(h){case"top-right":case"top-left":S=I-vh;break;case"bottom-right":case"bottom-left":S=-I+vh;break;case"bottom":S=-p+vh;break;case"top":S=p-vh}switch(h){case"top-right":case"bottom-right":v=-I;break;case"top-left":case"bottom-left":v=I;break;case"left":v=p;break;case"right":v=-p}return[v,S]}(u,c[0])}function mk(u,c,h){var p;const v=u.layout,S=(p=v.get("text-variable-anchor-offset"))===null||p===void 0?void 0:p.evaluate(c,{},h);if(S){const F=S.values,O=[];for(let G=0;G<F.length;G+=2){const K=O[G]=F[G],X=F[G+1].map(nt=>nt*ls);K.startsWith("top")?X[1]-=vh:K.startsWith("bottom")&&(X[1]+=vh),O[G+1]=X}return new Xn(O)}const I=v.get("text-variable-anchor");if(I){let F;F=u._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[v.get("text-radial-offset").evaluate(c,{},h)*ls,LE]:v.get("text-offset").evaluate(c,{},h).map(G=>G*ls);const O=[];for(const G of I)O.push(G,gk(G,F));return new Xn(O)}return null}function FE(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function hvt(u,c,h,p,v,S,I,F,O,G,K){let X=S.textMaxSize.evaluate(c,{});X===void 0&&(X=I);const nt=u.layers[0].layout,at=nt.get("icon-offset").evaluate(c,{},K),ut=_k(h.horizontal),Bt=I/24,It=u.tilePixelRatio*Bt,kt=u.tilePixelRatio*X/24,ee=u.tilePixelRatio*F,Ht=u.tilePixelRatio*nt.get("symbol-spacing"),Kt=nt.get("text-padding")*u.tilePixelRatio,ve=function(Le,Br,fr){let tn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const oi=Le.get("icon-padding").evaluate(Br,{},fr),di=oi&&oi.values;return[di[0]*tn,di[1]*tn,di[2]*tn,di[3]*tn]}(nt,c,K,u.tilePixelRatio),be=nt.get("text-max-angle")/180*Math.PI,Je=nt.get("text-rotation-alignment")!=="viewport"&&nt.get("symbol-placement")!=="point",Ar=nt.get("icon-rotation-alignment")==="map"&&nt.get("symbol-placement")!=="point",$e=nt.get("symbol-placement"),Ke=Ht/2,ke=nt.get("icon-text-fit");let sr;p&&ke!=="none"&&(u.allowVerticalPlacement&&h.vertical&&(sr=z6(p,h.vertical,ke,nt.get("icon-text-fit-padding"),at,Bt)),ut&&(p=z6(p,ut,ke,nt.get("icon-text-fit-padding"),at,Bt)));const Ve=(Le,Br)=>{Br.x<0||Br.x>=Un||Br.y<0||Br.y>=Un||function(fr,tn,oi,di,us,Ca,So,$i,Es,Gs,To,Io,As,hs,ro,Lo,no,na,ia,ds,un,io,Vs,fs,Mc){const Ll=fr.addToLineVertexArray(tn,oi);let Fl,pA,Pc,Xa,sa=0,gA=0,km=0,xk=0,NE=-1,QE=-1;const mA={};let Bk=Er("");if(fr.allowVerticalPlacement&&di.vertical){const so=$i.layout.get("text-rotate").evaluate(un,{},fs)+90;Pc=new k_(Es,tn,Gs,To,Io,di.vertical,As,hs,ro,so),So&&(Xa=new k_(Es,tn,Gs,To,Io,So,no,na,ro,so))}if(us){const so=$i.layout.get("icon-rotate").evaluate(un,{}),Ya=$i.layout.get("icon-text-fit")!=="none",Td=fk(us,so,Vs,Ya),Pl=So?fk(So,so,Vs,Ya):void 0;pA=new k_(Es,tn,Gs,To,Io,us,no,na,!1,so),sa=4*Td.length;const Id=fr.iconSizeData;let yu=null;Id.kind==="source"?(yu=[mu*$i.layout.get("icon-size").evaluate(un,{})],yu[0]>mh&&wt(`${fr.layerIds[0]}: Value for "icon-size" is >= ${Um}. Reduce your "icon-size".`)):Id.kind==="composite"&&(yu=[mu*io.compositeIconSizes[0].evaluate(un,{},fs),mu*io.compositeIconSizes[1].evaluate(un,{},fs)],(yu[0]>mh||yu[1]>mh)&&wt(`${fr.layerIds[0]}: Value for "icon-size" is >= ${Um}. Reduce your "icon-size".`)),fr.addSymbols(fr.icon,Td,yu,ds,ia,un,a.ah.none,tn,Ll.lineStartIndex,Ll.lineLength,-1,fs),NE=fr.icon.placedSymbolArray.length-1,Pl&&(gA=4*Pl.length,fr.addSymbols(fr.icon,Pl,yu,ds,ia,un,a.ah.vertical,tn,Ll.lineStartIndex,Ll.lineLength,-1,fs),QE=fr.icon.placedSymbolArray.length-1)}const Ck=Object.keys(di.horizontal);for(const so of Ck){const Ya=di.horizontal[so];if(!Fl){Bk=Er(Ya.text);const Pl=$i.layout.get("text-rotate").evaluate(un,{},fs);Fl=new k_(Es,tn,Gs,To,Io,Ya,As,hs,ro,Pl)}const Td=Ya.positionedLines.length===1;if(km+=yk(fr,tn,Ya,Ca,$i,ro,un,Lo,Ll,di.vertical?a.ah.horizontal:a.ah.horizontalOnly,Td?Ck:[so],mA,NE,io,fs),Td)break}di.vertical&&(xk+=yk(fr,tn,di.vertical,Ca,$i,ro,un,Lo,Ll,a.ah.vertical,["vertical"],mA,QE,io,fs));const pvt=Fl?Fl.boxStartIndex:fr.collisionBoxArray.length,gvt=Fl?Fl.boxEndIndex:fr.collisionBoxArray.length,mvt=Pc?Pc.boxStartIndex:fr.collisionBoxArray.length,yvt=Pc?Pc.boxEndIndex:fr.collisionBoxArray.length,_vt=pA?pA.boxStartIndex:fr.collisionBoxArray.length,vvt=pA?pA.boxEndIndex:fr.collisionBoxArray.length,bvt=Xa?Xa.boxStartIndex:fr.collisionBoxArray.length,wvt=Xa?Xa.boxEndIndex:fr.collisionBoxArray.length;let Ml=-1;const Q_=(so,Ya)=>so&&so.circleDiameter?Math.max(so.circleDiameter,Ya):Ya;Ml=Q_(Fl,Ml),Ml=Q_(Pc,Ml),Ml=Q_(pA,Ml),Ml=Q_(Xa,Ml);const Ek=Ml>-1?1:0;Ek&&(Ml*=Mc/ls),fr.glyphOffsetArray.length>=_p.MAX_GLYPHS&&wt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),un.sortKey!==void 0&&fr.addToSortKeyRanges(fr.symbolInstances.length,un.sortKey);const xvt=mk($i,un,fs),[Bvt,Cvt]=function(so,Ya){const Td=so.length,Pl=Ya==null?void 0:Ya.values;if((Pl==null?void 0:Pl.length)>0)for(let Id=0;Id<Pl.length;Id+=2){const yu=Pl[Id+1];so.emplaceBack(a.ap[Pl[Id]],yu[0],yu[1])}return[Td,so.length]}(fr.textAnchorOffsets,xvt);fr.symbolInstances.emplaceBack(tn.x,tn.y,mA.right>=0?mA.right:-1,mA.center>=0?mA.center:-1,mA.left>=0?mA.left:-1,mA.vertical||-1,NE,QE,Bk,pvt,gvt,mvt,yvt,_vt,vvt,bvt,wvt,Gs,km,xk,sa,gA,Ek,0,As,Ml,Bvt,Cvt)}(u,Br,Le,h,p,v,sr,u.layers[0],u.collisionBoxArray,c.index,c.sourceLayerIndex,u.index,It,[Kt,Kt,Kt,Kt],Je,O,ee,ve,Ar,at,c,S,G,K,I)};if($e==="line")for(const Le of ck(c.geometry,0,0,Un,Un)){const Br=avt(Le,Ht,be,h.vertical||ut,p,24,kt,u.overscaling,Un);for(const fr of Br)ut&&dvt(u,ut.text,Ke,fr)||Ve(Le,fr)}else if($e==="line-center"){for(const Le of c.geometry)if(Le.length>1){const Br=ovt(Le,be,h.vertical||ut,p,24,kt);Br&&Ve(Le,Br)}}else if(c.type==="Polygon")for(const Le of lE(c.geometry,0)){const Br=uvt(Le,16);Ve(Le[0],new _h(Br.x,Br.y,0))}else if(c.type==="LineString")for(const Le of c.geometry)Ve(Le,new _h(Le[0].x,Le[0].y,0));else if(c.type==="Point")for(const Le of c.geometry)for(const Br of Le)Ve([Br],new _h(Br.x,Br.y,0))}function yk(u,c,h,p,v,S,I,F,O,G,K,X,nt,at,ut){const Bt=function(ee,Ht,Kt,ve,be,Je,Ar,$e){const Ke=ve.layout.get("text-rotate").evaluate(Je,{})*Math.PI/180,ke=[];for(const sr of Ht.positionedLines)for(const Ve of sr.positionedGlyphs){if(!Ve.rect)continue;const Le=Ve.rect||{};let Br=R6+1,fr=!0,tn=1,oi=0;const di=(be||$e)&&Ve.vertical,us=Ve.metrics.advance*Ve.scale/2;if($e&&Ht.verticalizable&&(oi=sr.lineOffset/2-(Ve.imageName?-(ls-Ve.metrics.width*Ve.scale)/2:(Ve.scale-1)*ls)),Ve.imageName){const ds=Ar[Ve.imageName];fr=ds.sdf,tn=ds.pixelRatio,Br=ra/tn}const Ca=be?[Ve.x+us,Ve.y]:[0,0];let So=be?[0,0]:[Ve.x+us+Kt[0],Ve.y+Kt[1]-oi],$i=[0,0];di&&($i=So,So=[0,0]);const Es=Ve.metrics.isDoubleResolution?2:1,Gs=(Ve.metrics.left-Br)*Ve.scale-us+So[0],To=(-Ve.metrics.top-Br)*Ve.scale+So[1],Io=Gs+Le.w/Es*Ve.scale/tn,As=To+Le.h/Es*Ve.scale/tn,hs=new b(Gs,To),ro=new b(Io,To),Lo=new b(Gs,As),no=new b(Io,As);if(di){const ds=new b(-us,us-Mm),un=-Math.PI/2,io=ls/2-us,Vs=new b(5-Mm-io,-(Ve.imageName?io:0)),fs=new b(...$i);hs._rotateAround(un,ds)._add(Vs)._add(fs),ro._rotateAround(un,ds)._add(Vs)._add(fs),Lo._rotateAround(un,ds)._add(Vs)._add(fs),no._rotateAround(un,ds)._add(Vs)._add(fs)}if(Ke){const ds=Math.sin(Ke),un=Math.cos(Ke),io=[un,-ds,ds,un];hs._matMult(io),ro._matMult(io),Lo._matMult(io),no._matMult(io)}const na=new b(0,0),ia=new b(0,0);ke.push({tl:hs,tr:ro,bl:Lo,br:no,tex:Le,writingMode:Ht.writingMode,glyphOffset:Ca,sectionIndex:Ve.sectionIndex,isSDF:fr,pixelOffsetTL:na,pixelOffsetBR:ia,minFontScaleX:0,minFontScaleY:0})}return ke}(0,h,F,v,S,I,p,u.allowVerticalPlacement),It=u.textSizeData;let kt=null;It.kind==="source"?(kt=[mu*v.layout.get("text-size").evaluate(I,{})],kt[0]>mh&&wt(`${u.layerIds[0]}: Value for "text-size" is >= ${Um}. Reduce your "text-size".`)):It.kind==="composite"&&(kt=[mu*at.compositeTextSizes[0].evaluate(I,{},ut),mu*at.compositeTextSizes[1].evaluate(I,{},ut)],(kt[0]>mh||kt[1]>mh)&&wt(`${u.layerIds[0]}: Value for "text-size" is >= ${Um}. Reduce your "text-size".`)),u.addSymbols(u.text,Bt,kt,F,S,I,G,c,O.lineStartIndex,O.lineLength,nt,ut);for(const ee of K)X[ee]=u.text.placedSymbolArray.length-1;return 4*Bt.length}function _k(u){for(const c in u)return u[c];return null}function dvt(u,c,h,p){const v=u.compareText;if(c in v){const S=v[c];for(let I=S.length-1;I>=0;I--)if(p.dist(S[I])<h)return!0}else v[c]=[];return v[c].push(p),!1}const vk=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class ME{static from(c){if(!(c instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,p]=new Uint8Array(c,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const v=p>>4;if(v!==1)throw new Error(`Got v${v} data when expected v1.`);const S=vk[15&p];if(!S)throw new Error("Unrecognized array type.");const[I]=new Uint16Array(c,2,1),[F]=new Uint32Array(c,4,1);return new ME(F,I,S,c)}constructor(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,v=arguments.length>3?arguments[3]:void 0;if(isNaN(c)||c<0)throw new Error(`Unpexpected numItems value: ${c}.`);this.numItems=+c,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=p,this.IndexArrayType=c<65536?Uint16Array:Uint32Array;const S=vk.indexOf(this.ArrayType),I=2*c*this.ArrayType.BYTES_PER_ELEMENT,F=c*this.IndexArrayType.BYTES_PER_ELEMENT,O=(8-F%8)%8;if(S<0)throw new Error(`Unexpected typed array class: ${p}.`);v&&v instanceof ArrayBuffer?(this.data=v,this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+F+O,2*c),this._pos=2*c,this._finished=!0):(this.data=new ArrayBuffer(8+I+F+O),this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+F+O,2*c),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+S]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=c)}add(c,h){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=c,this.coords[this._pos++]=h,p}finish(){const c=this._pos>>1;if(c!==this.numItems)throw new Error(`Added ${c} items when expected ${this.numItems}.`);return PE(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(c,h,p,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:S,coords:I,nodeSize:F}=this,O=[0,S.length-1,0],G=[];for(;O.length;){const K=O.pop()||0,X=O.pop()||0,nt=O.pop()||0;if(X-nt<=F){for(let It=nt;It<=X;It++){const kt=I[2*It],ee=I[2*It+1];kt>=c&&kt<=p&&ee>=h&&ee<=v&&G.push(S[It])}continue}const at=nt+X>>1,ut=I[2*at],Bt=I[2*at+1];ut>=c&&ut<=p&&Bt>=h&&Bt<=v&&G.push(S[at]),(K===0?c<=ut:h<=Bt)&&(O.push(nt),O.push(at-1),O.push(1-K)),(K===0?p>=ut:v>=Bt)&&(O.push(at+1),O.push(X),O.push(1-K))}return G}within(c,h,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:S,nodeSize:I}=this,F=[0,v.length-1,0],O=[],G=p*p;for(;F.length;){const K=F.pop()||0,X=F.pop()||0,nt=F.pop()||0;if(X-nt<=I){for(let It=nt;It<=X;It++)wk(S[2*It],S[2*It+1],c,h)<=G&&O.push(v[It]);continue}const at=nt+X>>1,ut=S[2*at],Bt=S[2*at+1];wk(ut,Bt,c,h)<=G&&O.push(v[at]),(K===0?c-p<=ut:h-p<=Bt)&&(F.push(nt),F.push(at-1),F.push(1-K)),(K===0?c+p>=ut:h+p>=Bt)&&(F.push(at+1),F.push(X),F.push(1-K))}return O}}function PE(u,c,h,p,v,S){if(v-p<=h)return;const I=p+v>>1;bk(u,c,I,p,v,S),PE(u,c,h,p,I-1,1-S),PE(u,c,h,I+1,v,1-S)}function bk(u,c,h,p,v,S){for(;v>p;){if(v-p>600){const G=v-p+1,K=h-p+1,X=Math.log(G),nt=.5*Math.exp(2*X/3),at=.5*Math.sqrt(X*nt*(G-nt)/G)*(K-G/2<0?-1:1);bk(u,c,h,Math.max(p,Math.floor(h-K*nt/G+at)),Math.min(v,Math.floor(h+(G-K)*nt/G+at)),S)}const I=c[2*h+S];let F=p,O=v;for(Om(u,c,p,h),c[2*v+S]>I&&Om(u,c,p,v);F<O;){for(Om(u,c,F,O),F++,O--;c[2*F+S]<I;)F++;for(;c[2*O+S]>I;)O--}c[2*p+S]===I?Om(u,c,p,O):(O++,Om(u,c,O,v)),O<=h&&(p=O+1),h<=O&&(v=O-1)}}function Om(u,c,h,p){UE(u,h,p),UE(c,2*h,2*p),UE(c,2*h+1,2*p+1)}function UE(u,c,h){const p=u[c];u[c]=u[h],u[h]=p}function wk(u,c,h,p){const v=u-h,S=c-p;return v*v+S*S}var RE;a.bd=void 0,(RE=a.bd||(a.bd={})).create="create",RE.load="load",RE.fullLoad="fullLoad";let N_=null,Dm=[];const OE=1e3/60,DE="loadTime",kE="fullLoadTime",fvt={mark(u){performance.mark(u)},frame(u){const c=u;N_!=null&&Dm.push(c-N_),N_=c},clearMetrics(){N_=null,Dm=[],performance.clearMeasures(DE),performance.clearMeasures(kE);for(const u in a.bd)performance.clearMarks(a.bd[u])},getPerformanceMetrics(){performance.measure(DE,a.bd.create,a.bd.load),performance.measure(kE,a.bd.create,a.bd.fullLoad);const u=performance.getEntriesByName(DE)[0].duration,c=performance.getEntriesByName(kE)[0].duration,h=Dm.length,p=1/(Dm.reduce((S,I)=>S+I,0)/h/1e3),v=Dm.filter(S=>S>OE).reduce((S,I)=>S+(I-OE)/OE,0);return{loadTime:u,fullLoadTime:c,fps:p,percentDroppedFrames:v/(h+v)*100,totalFrames:h}}};a.$=$t,a.A=hA,a.B=function(u){if(re==null){const c=u.navigator?u.navigator.userAgent:null;re=!!u.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return re},a.C=class{constructor(u,c){this.target=u,this.mapId=c,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new ivt(()=>this.process()),this.subscription=function(h,p,v,S){return h.addEventListener(p,v,!1),{unsubscribe:()=>{h.removeEventListener(p,v,!1)}}}(this.target,"message",h=>this.receive(h)),this.globalScope=Zt(self)?u:window}registerMessageHandler(u,c){this.messageHandlers[u]=c}sendAsync(u,c){return new Promise((h,p)=>{const v=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[v]={resolve:h,reject:p},c&&c.signal.addEventListener("abort",()=>{delete this.resolveRejects[v];const F={id:v,type:"<cancel>",origin:location.origin,targetMapId:u.targetMapId,sourceMapId:this.mapId};this.target.postMessage(F)},{once:!0});const S=[],I=Object.assign(Object.assign({},u),{id:v,sourceMapId:this.mapId,origin:location.origin,data:ml(u.data,S)});this.target.postMessage(I,{transfer:S})})}receive(u){const c=u.data,h=c.id;if(!(c.origin!=="file://"&&location.origin!=="file://"&&c.origin!==location.origin||c.targetMapId&&this.mapId!==c.targetMapId)){if(c.type==="<cancel>"){delete this.tasks[h];const p=this.abortControllers[h];return delete this.abortControllers[h],void(p&&p.abort())}if(Zt(self)||c.mustQueue)return this.tasks[h]=c,this.taskQueue.push(h),void this.invoker.trigger();this.processTask(h,c)}}process(){if(this.taskQueue.length===0)return;const u=this.taskQueue.shift(),c=this.tasks[u];delete this.tasks[u],this.taskQueue.length>0&&this.invoker.trigger(),c&&this.processTask(u,c)}processTask(u,c){return o(this,void 0,void 0,function*(){if(c.type==="<response>"){const v=this.resolveRejects[u];return delete this.resolveRejects[u],v?void(c.error?v.reject(yl(c.error)):v.resolve(yl(c.data))):void 0}if(!this.messageHandlers[c.type])return void this.completeTask(u,new Error(`Could not find a registered handler for ${c.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const h=yl(c.data),p=new AbortController;this.abortControllers[u]=p;try{const v=yield this.messageHandlers[c.type](c.sourceMapId,h,p);this.completeTask(u,null,v)}catch(v){this.completeTask(u,v)}})}completeTask(u,c,h){const p=[];delete this.abortControllers[u];const v={id:u,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:c?ml(c):null,data:ml(h,p)};this.target.postMessage(v,{transfer:p})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},a.D=hr,a.E=Ut,a.F=function(){var u=new hA(16);return hA!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},a.G=jt,a.H=function(u,c,h){var p,v,S,I,F,O,G,K,X,nt,at,ut,Bt=h[0],It=h[1],kt=h[2];return c===u?(u[12]=c[0]*Bt+c[4]*It+c[8]*kt+c[12],u[13]=c[1]*Bt+c[5]*It+c[9]*kt+c[13],u[14]=c[2]*Bt+c[6]*It+c[10]*kt+c[14],u[15]=c[3]*Bt+c[7]*It+c[11]*kt+c[15]):(v=c[1],S=c[2],I=c[3],F=c[4],O=c[5],G=c[6],K=c[7],X=c[8],nt=c[9],at=c[10],ut=c[11],u[0]=p=c[0],u[1]=v,u[2]=S,u[3]=I,u[4]=F,u[5]=O,u[6]=G,u[7]=K,u[8]=X,u[9]=nt,u[10]=at,u[11]=ut,u[12]=p*Bt+F*It+X*kt+c[12],u[13]=v*Bt+O*It+nt*kt+c[13],u[14]=S*Bt+G*It+at*kt+c[14],u[15]=I*Bt+K*It+ut*kt+c[15]),u},a.I=_E,a.J=function(u,c,h){var p=h[0],v=h[1],S=h[2];return u[0]=c[0]*p,u[1]=c[1]*p,u[2]=c[2]*p,u[3]=c[3]*p,u[4]=c[4]*v,u[5]=c[5]*v,u[6]=c[6]*v,u[7]=c[7]*v,u[8]=c[8]*S,u[9]=c[9]*S,u[10]=c[10]*S,u[11]=c[11]*S,u[12]=c[12],u[13]=c[13],u[14]=c[14],u[15]=c[15],u},a.K=vm,a.L=function(u,c){const h={};for(let p=0;p<c.length;p++){const v=c[p];v in u&&(h[v]=u[v])}return h},a.M=yh,a.N=Y6,a.O=J6,a.P=b,a.Q=$a,a.R=ea,a.S=Q,a.T=nA,a.U=q,a.V=se,a.W=Un,a.X=Ci,a.Y=U_,a.Z=class extends Zo{},a._=o,a.a=Ot,a.a$=function(u,c,h){return u[0]=c[0]*h[0],u[1]=c[1]*h[1],u[2]=c[2]*h[2],u[3]=c[3]*h[3],u},a.a0=IE,a.a1=fe,a.a2=u=>{const c=window.document.createElement("video");return c.muted=!0,new Promise(h=>{c.onloadstart=()=>{h(c)};for(const p of u){const v=window.document.createElement("source");Te(p)||(c.crossOrigin="Anonymous"),v.src=p,c.appendChild(v)}})},a.a3=function(){return dt++},a.a4=B,a.a5=_p,a.a6=xc,a.a7=Ic,a.a8=Hn,a.a9=ik,a.aA=st,a.aB=function(u,c){if(!u)return[{command:"setStyle",args:[c]}];let h=[];try{if(!_e(u.version,c.version))return[{command:"setStyle",args:[c]}];_e(u.center,c.center)||h.push({command:"setCenter",args:[c.center]}),_e(u.zoom,c.zoom)||h.push({command:"setZoom",args:[c.zoom]}),_e(u.bearing,c.bearing)||h.push({command:"setBearing",args:[c.bearing]}),_e(u.pitch,c.pitch)||h.push({command:"setPitch",args:[c.pitch]}),_e(u.sprite,c.sprite)||h.push({command:"setSprite",args:[c.sprite]}),_e(u.glyphs,c.glyphs)||h.push({command:"setGlyphs",args:[c.glyphs]}),_e(u.transition,c.transition)||h.push({command:"setTransition",args:[c.transition]}),_e(u.light,c.light)||h.push({command:"setLight",args:[c.light]}),_e(u.terrain,c.terrain)||h.push({command:"setTerrain",args:[c.terrain]}),_e(u.sky,c.sky)||h.push({command:"setSky",args:[c.sky]});const p={},v=[];(function(I,F,O,G){let K;for(K in F=F||{},I=I||{})Object.prototype.hasOwnProperty.call(I,K)&&(Object.prototype.hasOwnProperty.call(F,K)||nr(K,O,G));for(K in F)Object.prototype.hasOwnProperty.call(F,K)&&(Object.prototype.hasOwnProperty.call(I,K)?_e(I[K],F[K])||(I[K].type==="geojson"&&F[K].type==="geojson"&&Ir(I,F,K)?xe(O,{command:"setGeoJSONSourceData",args:[K,F[K].data]}):ur(K,F,O,G)):De(K,F,O))})(u.sources,c.sources,v,p);const S=[];u.layers&&u.layers.forEach(I=>{"source"in I&&p[I.source]?h.push({command:"removeLayer",args:[I.id]}):S.push(I)}),h=h.concat(v),function(I,F,O){F=F||[];const G=(I=I||[]).map(Dr),K=F.map(Dr),X=I.reduce(Nr,{}),nt=F.reduce(Nr,{}),at=G.slice(),ut=Object.create(null);let Bt,It,kt,ee,Ht;for(let Kt=0,ve=0;Kt<G.length;Kt++)Bt=G[Kt],Object.prototype.hasOwnProperty.call(nt,Bt)?ve++:(xe(O,{command:"removeLayer",args:[Bt]}),at.splice(at.indexOf(Bt,ve),1));for(let Kt=0,ve=0;Kt<K.length;Kt++)Bt=K[K.length-1-Kt],at[at.length-1-Kt]!==Bt&&(Object.prototype.hasOwnProperty.call(X,Bt)?(xe(O,{command:"removeLayer",args:[Bt]}),at.splice(at.lastIndexOf(Bt,at.length-ve),1)):ve++,ee=at[at.length-Kt],xe(O,{command:"addLayer",args:[nt[Bt],ee]}),at.splice(at.length-Kt,0,Bt),ut[Bt]=!0);for(let Kt=0;Kt<K.length;Kt++)if(Bt=K[Kt],It=X[Bt],kt=nt[Bt],!ut[Bt]&&!_e(It,kt))if(_e(It.source,kt.source)&&_e(It["source-layer"],kt["source-layer"])&&_e(It.type,kt.type)){for(Ht in Sr(It.layout,kt.layout,O,Bt,null,"setLayoutProperty"),Sr(It.paint,kt.paint,O,Bt,null,"setPaintProperty"),_e(It.filter,kt.filter)||xe(O,{command:"setFilter",args:[Bt,kt.filter]}),_e(It.minzoom,kt.minzoom)&&_e(It.maxzoom,kt.maxzoom)||xe(O,{command:"setLayerZoomRange",args:[Bt,kt.minzoom,kt.maxzoom]}),It)Object.prototype.hasOwnProperty.call(It,Ht)&&Ht!=="layout"&&Ht!=="paint"&&Ht!=="filter"&&Ht!=="metadata"&&Ht!=="minzoom"&&Ht!=="maxzoom"&&(Ht.indexOf("paint.")===0?Sr(It[Ht],kt[Ht],O,Bt,Ht.slice(6),"setPaintProperty"):_e(It[Ht],kt[Ht])||xe(O,{command:"setLayerProperty",args:[Bt,Ht,kt[Ht]]}));for(Ht in kt)Object.prototype.hasOwnProperty.call(kt,Ht)&&!Object.prototype.hasOwnProperty.call(It,Ht)&&Ht!=="layout"&&Ht!=="paint"&&Ht!=="filter"&&Ht!=="metadata"&&Ht!=="minzoom"&&Ht!=="maxzoom"&&(Ht.indexOf("paint.")===0?Sr(It[Ht],kt[Ht],O,Bt,Ht.slice(6),"setPaintProperty"):_e(It[Ht],kt[Ht])||xe(O,{command:"setLayerProperty",args:[Bt,Ht,kt[Ht]]}))}else xe(O,{command:"removeLayer",args:[Bt]}),ee=at[at.lastIndexOf(Bt)+1],xe(O,{command:"addLayer",args:[kt,ee]})}(S,c.layers,h)}catch(p){console.warn("Unable to compute style diff:",p),h=[{command:"setStyle",args:[c]}]}return h},a.aC=function(u){const c=[],h=u.id;return h===void 0&&c.push({message:`layers.${h}: missing required property "id"`}),u.render===void 0&&c.push({message:`layers.${h}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&c.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),c},a.aD=function u(c,h){if(Array.isArray(c)){if(!Array.isArray(h)||c.length!==h.length)return!1;for(let p=0;p<c.length;p++)if(!u(c[p],h[p]))return!1;return!0}if(typeof c=="object"&&c!==null&&h!==null){if(typeof h!="object"||Object.keys(c).length!==Object.keys(h).length)return!1;for(const p in c)if(!u(c[p],h[p]))return!1;return!0}return c===h},a.aE=Rt,a.aF=Lt,a.aG=class extends Bn{constructor(u,c){super(u,c),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},a.aH=Cn,a.aI=class extends Bn{constructor(u,c){super(u,c),this.current=cs}set(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let c=1;c<16;c++)if(u[c]!==this.current[c]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}},a.aJ=hi,a.aK=class extends Bn{constructor(u,c){super(u,c),this.current=[0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))}},a.aL=class extends Bn{constructor(u,c){super(u,c),this.current=[0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))}},a.aM=hn,a.aN=function(u,c,h,p,v,S,I){var F=1/(c-h),O=1/(p-v),G=1/(S-I);return u[0]=-2*F,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*O,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*G,u[11]=0,u[12]=(c+h)*F,u[13]=(v+p)*O,u[14]=(I+S)*G,u[15]=1,u},a.aO=xr,a.aP=Ap,a.aQ=class extends cA{},a.aR=M_t,a.aS=class extends Bl{},a.aT=function(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))},a.aU=wm,a.aV=L,a.aW=class extends vd{},a.aX=Tt,a.aY=function(u,c){return u[0]===c[0]&&u[1]===c[1]&&u[2]===c[2]&&u[3]===c[3]&&u[4]===c[4]&&u[5]===c[5]&&u[6]===c[6]&&u[7]===c[7]&&u[8]===c[8]&&u[9]===c[9]&&u[10]===c[10]&&u[11]===c[11]&&u[12]===c[12]&&u[13]===c[13]&&u[14]===c[14]&&u[15]===c[15]},a.aZ=function(u,c){var h=u[0],p=u[1],v=u[2],S=u[3],I=u[4],F=u[5],O=u[6],G=u[7],K=u[8],X=u[9],nt=u[10],at=u[11],ut=u[12],Bt=u[13],It=u[14],kt=u[15],ee=c[0],Ht=c[1],Kt=c[2],ve=c[3],be=c[4],Je=c[5],Ar=c[6],$e=c[7],Ke=c[8],ke=c[9],sr=c[10],Ve=c[11],Le=c[12],Br=c[13],fr=c[14],tn=c[15];return Math.abs(h-ee)<=Hs*Math.max(1,Math.abs(h),Math.abs(ee))&&Math.abs(p-Ht)<=Hs*Math.max(1,Math.abs(p),Math.abs(Ht))&&Math.abs(v-Kt)<=Hs*Math.max(1,Math.abs(v),Math.abs(Kt))&&Math.abs(S-ve)<=Hs*Math.max(1,Math.abs(S),Math.abs(ve))&&Math.abs(I-be)<=Hs*Math.max(1,Math.abs(I),Math.abs(be))&&Math.abs(F-Je)<=Hs*Math.max(1,Math.abs(F),Math.abs(Je))&&Math.abs(O-Ar)<=Hs*Math.max(1,Math.abs(O),Math.abs(Ar))&&Math.abs(G-$e)<=Hs*Math.max(1,Math.abs(G),Math.abs($e))&&Math.abs(K-Ke)<=Hs*Math.max(1,Math.abs(K),Math.abs(Ke))&&Math.abs(X-ke)<=Hs*Math.max(1,Math.abs(X),Math.abs(ke))&&Math.abs(nt-sr)<=Hs*Math.max(1,Math.abs(nt),Math.abs(sr))&&Math.abs(at-Ve)<=Hs*Math.max(1,Math.abs(at),Math.abs(Ve))&&Math.abs(ut-Le)<=Hs*Math.max(1,Math.abs(ut),Math.abs(Le))&&Math.abs(Bt-Br)<=Hs*Math.max(1,Math.abs(Bt),Math.abs(Br))&&Math.abs(It-fr)<=Hs*Math.max(1,Math.abs(It),Math.abs(fr))&&Math.abs(kt-tn)<=Hs*Math.max(1,Math.abs(kt),Math.abs(tn))},a.a_=function(u,c){return u[0]=c[0],u[1]=c[1],u[2]=c[2],u[3]=c[3],u[4]=c[4],u[5]=c[5],u[6]=c[6],u[7]=c[7],u[8]=c[8],u[9]=c[9],u[10]=c[10],u[11]=c[11],u[12]=c[12],u[13]=c[13],u[14]=c[14],u[15]=c[15],u},a.aa=function(u){const c={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,p,v,S)=>{const I=v||S;return c[p]=!I||I.toLowerCase(),""}),c["max-age"]){const h=parseInt(c["max-age"],10);isNaN(h)?delete c["max-age"]:c["max-age"]=h}return c},a.ab=function(u,c){const h=[];for(const p in u)p in c||h.push(p);return h},a.ac=ft,a.ad=function(u,c,h){var p=Math.sin(h),v=Math.cos(h),S=c[0],I=c[1],F=c[2],O=c[3],G=c[4],K=c[5],X=c[6],nt=c[7];return c!==u&&(u[8]=c[8],u[9]=c[9],u[10]=c[10],u[11]=c[11],u[12]=c[12],u[13]=c[13],u[14]=c[14],u[15]=c[15]),u[0]=S*v+G*p,u[1]=I*v+K*p,u[2]=F*v+X*p,u[3]=O*v+nt*p,u[4]=G*v-S*p,u[5]=K*v-I*p,u[6]=X*v-F*p,u[7]=nt*v-O*p,u},a.ae=function(u){var c=new hA(16);return c[0]=u[0],c[1]=u[1],c[2]=u[2],c[3]=u[3],c[4]=u[4],c[5]=u[5],c[6]=u[6],c[7]=u[7],c[8]=u[8],c[9]=u[9],c[10]=u[10],c[11]=u[11],c[12]=u[12],c[13]=u[13],c[14]=u[14],c[15]=u[15],c},a.af=Ah,a.ag=function(u,c){let h=0,p=0;if(u.kind==="constant")p=u.layoutSize;else if(u.kind!=="source"){const{interpolationType:v,minZoom:S,maxZoom:I}=u,F=v?ft(xi.interpolationFactor(v,c,S,I),0,1):0;u.kind==="camera"?p=Pi.number(u.minSize,u.maxSize,F):h=F}return{uSizeT:h,uSize:p}},a.ai=function(u,c,h){let{uSize:p,uSizeT:v}=c,{lowerSize:S,upperSize:I}=h;return u.kind==="source"?S/mu:u.kind==="composite"?Pi.number(S/mu,I/mu,v):p},a.aj=xE,a.ak=function(u,c,h,p){const v=c.y-u.y,S=c.x-u.x,I=p.y-h.y,F=p.x-h.x,O=I*S-F*v;if(O===0)return null;const G=(F*(u.y-h.y)-I*(u.x-h.x))/O;return new b(u.x+G*S,u.y+G*v)},a.al=ck,a.am=fu,a.an=lh,a.ao=ls,a.aq=wE,a.ar=function(u,c){var h=c[0],p=c[1],v=c[2],S=c[3],I=c[4],F=c[5],O=c[6],G=c[7],K=c[8],X=c[9],nt=c[10],at=c[11],ut=c[12],Bt=c[13],It=c[14],kt=c[15],ee=h*F-p*I,Ht=h*O-v*I,Kt=h*G-S*I,ve=p*O-v*F,be=p*G-S*F,Je=v*G-S*O,Ar=K*Bt-X*ut,$e=K*It-nt*ut,Ke=K*kt-at*ut,ke=X*It-nt*Bt,sr=X*kt-at*Bt,Ve=nt*kt-at*It,Le=ee*Ve-Ht*sr+Kt*ke+ve*Ke-be*$e+Je*Ar;return Le?(u[0]=(F*Ve-O*sr+G*ke)*(Le=1/Le),u[1]=(v*sr-p*Ve-S*ke)*Le,u[2]=(Bt*Je-It*be+kt*ve)*Le,u[3]=(nt*be-X*Je-at*ve)*Le,u[4]=(O*Ke-I*Ve-G*$e)*Le,u[5]=(h*Ve-v*Ke+S*$e)*Le,u[6]=(It*Kt-ut*Je-kt*Ht)*Le,u[7]=(K*Je-nt*Kt+at*Ht)*Le,u[8]=(I*sr-F*Ke+G*Ar)*Le,u[9]=(p*Ke-h*sr-S*Ar)*Le,u[10]=(ut*be-Bt*Kt+kt*ee)*Le,u[11]=(X*Kt-K*be-at*ee)*Le,u[12]=(F*$e-I*ke-O*Ar)*Le,u[13]=(h*ke-p*$e+v*Ar)*Le,u[14]=(Bt*Ht-ut*ve-It*ee)*Le,u[15]=(K*ve-X*Ht+nt*ee)*Le,u):null},a.as=FE,a.at=bE,a.au=ME,a.av=function(){const u={},c=Yt.$version;for(const h in Yt.$root){const p=Yt.$root[h];if(p.required){let v=null;v=h==="version"?c:p.type==="array"?[]:{},v!=null&&(u[h]=v)}}return u},a.aw=eh,a.ax=ie,a.ay=function(u){u=u.slice();const c=Object.create(null);for(let h=0;h<u.length;h++)c[u[h].id]=u[h];for(let h=0;h<u.length;h++)"ref"in u[h]&&(u[h]=Ee(u[h],c[u[h].ref]));return u},a.az=function(u){if(u.type==="custom")return new nvt(u);switch(u.type){case"background":return new tvt(u);case"circle":return new Bd(u);case"fill":return new s_t(u);case"fill-extrusion":return new v_t(u);case"heatmap":return new dh(u);case"hillshade":return new nE(u);case"line":return new T_t(u);case"raster":return new rvt(u);case"symbol":return new P_(u)}},a.b=Xt,a.b0=function(u,c){return u[0]*c[0]+u[1]*c[1]+u[2]*c[2]+u[3]*c[3]},a.b1=pt,a.b2=ek,a.b3=Z6,a.b4=function(u,c,h,p,v){var S,I=1/Math.tan(c/2);return u[0]=I/h,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=I,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,v!=null&&v!==1/0?(u[10]=(v+p)*(S=1/(p-v)),u[14]=2*v*p*S):(u[10]=-1,u[14]=-2*p),u},a.b5=function(u,c,h){var p=Math.sin(h),v=Math.cos(h),S=c[4],I=c[5],F=c[6],O=c[7],G=c[8],K=c[9],X=c[10],nt=c[11];return c!==u&&(u[0]=c[0],u[1]=c[1],u[2]=c[2],u[3]=c[3],u[12]=c[12],u[13]=c[13],u[14]=c[14],u[15]=c[15]),u[4]=S*v+G*p,u[5]=I*v+K*p,u[6]=F*v+X*p,u[7]=O*v+nt*p,u[8]=G*v-S*p,u[9]=K*v-I*p,u[10]=X*v-F*p,u[11]=nt*v-O*p,u},a.b6=Y,a.b7=tt,a.b8=function(u){return u*Math.PI/180},a.b9=function(u,c){return u[0]=c[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=c[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=c[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},a.bA=Ka,a.ba=class extends Di{},a.bb=SE,a.bc=fvt,a.be=ae,a.bf=function(u,c){Ot.REGISTERED_PROTOCOLS[u]=c},a.bg=function(u){delete Ot.REGISTERED_PROTOCOLS[u]},a.bh=function(u,c){const h={};for(let v=0;v<u.length;v++){const S=c&&c[u[v].id]||hd(u[v]);c&&(c[u[v].id]=S);let I=h[S];I||(I=h[S]=[]),I.push(u[v])}const p=[];for(const v in h)p.push(h[v]);return p},a.bi=Ze,a.bj=nk,a.bk=sk,a.bl=D6,a.bm=function(u){u.bucket.createArrays(),u.bucket.tilePixelRatio=Un/(512*u.bucket.overscaling),u.bucket.compareText={},u.bucket.iconsNeedLinear=!1;const c=u.bucket.layers[0],h=c.layout,p=c._unevaluatedLayout._values,v={layoutIconSize:p["icon-size"].possiblyEvaluate(new Hn(u.bucket.zoom+1),u.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new Hn(u.bucket.zoom+1),u.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new Hn(18))};if(u.bucket.textSizeData.kind==="composite"){const{minZoom:G,maxZoom:K}=u.bucket.textSizeData;v.compositeTextSizes=[p["text-size"].possiblyEvaluate(new Hn(G),u.canonical),p["text-size"].possiblyEvaluate(new Hn(K),u.canonical)]}if(u.bucket.iconSizeData.kind==="composite"){const{minZoom:G,maxZoom:K}=u.bucket.iconSizeData;v.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new Hn(G),u.canonical),p["icon-size"].possiblyEvaluate(new Hn(K),u.canonical)]}const S=h.get("text-line-height")*ls,I=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",F=h.get("text-keep-upright"),O=h.get("text-size");for(const G of u.bucket.features){const K=h.get("text-font").evaluate(G,{},u.canonical).join(","),X=O.evaluate(G,{},u.canonical),nt=v.layoutTextSize.evaluate(G,{},u.canonical),at=v.layoutIconSize.evaluate(G,{},u.canonical),ut={horizontal:{},vertical:void 0},Bt=G.text;let It,kt=[0,0];if(Bt){const Kt=Bt.toString(),ve=h.get("text-letter-spacing").evaluate(G,{},u.canonical)*ls,be=to(Kt)?ve:0,Je=h.get("text-anchor").evaluate(G,{},u.canonical),Ar=mk(c,G,u.canonical);if(!Ar){const Ve=h.get("text-radial-offset").evaluate(G,{},u.canonical);kt=Ve?gk(Je,[Ve*ls,LE]):h.get("text-offset").evaluate(G,{},u.canonical).map(Le=>Le*ls)}let $e=I?"center":h.get("text-justify").evaluate(G,{},u.canonical);const Ke=h.get("symbol-placement"),ke=Ke==="point"?h.get("text-max-width").evaluate(G,{},u.canonical)*ls:0,sr=()=>{u.bucket.allowVerticalPlacement&&qi(Kt)&&(ut.vertical=L_(Bt,u.glyphMap,u.glyphPositions,u.imagePositions,K,ke,S,Je,"left",be,kt,a.ah.vertical,!0,Ke,nt,X))};if(!I&&Ar){const Ve=new Set;if($e==="auto")for(let Br=0;Br<Ar.values.length;Br+=2)Ve.add(FE(Ar.values[Br]));else Ve.add($e);let Le=!1;for(const Br of Ve)if(!ut.horizontal[Br])if(Le)ut.horizontal[Br]=ut.horizontal[0];else{const fr=L_(Bt,u.glyphMap,u.glyphPositions,u.imagePositions,K,ke,S,"center",Br,be,kt,a.ah.horizontal,!1,Ke,nt,X);fr&&(ut.horizontal[Br]=fr,Le=fr.positionedLines.length===1)}sr()}else{$e==="auto"&&($e=FE(Je));const Ve=L_(Bt,u.glyphMap,u.glyphPositions,u.imagePositions,K,ke,S,Je,$e,be,kt,a.ah.horizontal,!1,Ke,nt,X);Ve&&(ut.horizontal[$e]=Ve),sr(),qi(Kt)&&I&&F&&(ut.vertical=L_(Bt,u.glyphMap,u.glyphPositions,u.imagePositions,K,ke,S,Je,$e,be,kt,a.ah.vertical,!1,Ke,nt,X))}}let ee=!1;if(G.icon&&G.icon.name){const Kt=u.imageMap[G.icon.name];Kt&&(It=$_t(u.imagePositions[G.icon.name],h.get("icon-offset").evaluate(G,{},u.canonical),h.get("icon-anchor").evaluate(G,{},u.canonical)),ee=!!Kt.sdf,u.bucket.sdfIcons===void 0?u.bucket.sdfIcons=ee:u.bucket.sdfIcons!==ee&&wt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Kt.pixelRatio!==u.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(u.bucket.iconsNeedLinear=!0))}const Ht=_k(ut.horizontal)||ut.vertical;u.bucket.iconsInText=!!Ht&&Ht.iconsInText,(Ht||It)&&hvt(u.bucket,G,ut,It,u.imageMap,v,nt,at,kt,ee,u.canonical)}u.showCollisionBoxes&&u.bucket.generateCollisionDebugBuffers()},a.bn=pE,a.bo=hE,a.bp=fE,a.bq=ph,a.br=mE,a.bs=class{constructor(u){this._marks={start:[u.url,"start"].join("#"),end:[u.url,"end"].join("#"),measure:u.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let u=performance.getEntriesByName(this._marks.measure);return u.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),u=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),u}},a.bt=function(u,c,h,p,v){return o(this,void 0,void 0,function*(){if(q())try{return yield se(u,c,h,p,v)}catch{}return function(S,I,F,O,G){const K=S.width,X=S.height;we&&it||(we=new OffscreenCanvas(K,X),it=we.getContext("2d",{willReadFrequently:!0})),we.width=K,we.height=X,it.drawImage(S,0,0,K,X);const nt=it.getImageData(I,F,O,G);return it.clearRect(0,0,K,X),nt.data}(u,c,h,p,v)})},a.bu=rk,a.bv=A,a.bw=f,a.bx=T6,a.by=ii,a.bz=function(u){return u.message===vt},a.c=Ft,a.d=u=>o(void 0,void 0,void 0,function*(){if(u.byteLength===0)return createImageBitmap(new ImageData(1,1));const c=new Blob([new Uint8Array(u)],{type:"image/png"});try{return createImageBitmap(c)}catch(h){throw new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),a.e=mt,a.f=u=>new Promise((c,h)=>{const p=new Image;p.onload=()=>{c(p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame(()=>{p.src=ne})},p.onerror=()=>h(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const v=new Blob([new Uint8Array(u)],{type:"image/png"});p.src=u.byteLength?URL.createObjectURL(v):ne}),a.g=Wt,a.h=(u,c)=>Be(mt(u,{type:"json"}),c),a.i=Zt,a.j=ge,a.k=He,a.l=(u,c)=>Be(mt(u,{type:"arrayBuffer"}),c),a.m=Be,a.n=function(u){return new mE(u).readFields(G_t,[])},a.o=hh,a.p=O6,a.q=Ki,a.r=ja,a.s=Te,a.t=qa,a.u=je,a.v=Yt,a.w=wt,a.x=Zn,a.y=function(u){let[c,h,p]=u;return h+=90,h*=Math.PI/180,p*=Math.PI/180,{x:c*Math.cos(h)*Math.sin(p),y:c*Math.sin(h)*Math.sin(p),z:c*Math.cos(p)}},a.z=Pi}),i("worker",["./shared"],function(a){class o{constructor(Z){this.keyCache={},Z&&this.replace(Z)}replace(Z){this._layerConfigs={},this._layers={},this.update(Z,[])}update(Z,J){for(const Et of Z){this._layerConfigs[Et.id]=Et;const Nt=this._layers[Et.id]=a.az(Et);Nt._featureFilter=a.a6(Nt.filter),this.keyCache[Et.id]&&delete this.keyCache[Et.id]}for(const Et of J)delete this.keyCache[Et],delete this._layerConfigs[Et],delete this._layers[Et];this.familiesBySource={};const ot=a.bh(Object.values(this._layerConfigs),this.keyCache);for(const Et of ot){const Nt=Et.map(pe=>this._layers[pe.id]),zt=Nt[0];if(zt.visibility==="none")continue;const qt=zt.source||"";let St=this.familiesBySource[qt];St||(St=this.familiesBySource[qt]={});const Jt=zt.sourceLayer||"_geojsonTileLayer";let me=St[Jt];me||(me=St[Jt]=[]),me.push(Nt)}}}class A{constructor(Z){const J={},ot=[];for(const qt in Z){const St=Z[qt],Jt=J[qt]={};for(const me in St){const pe=St[+me];if(!pe||pe.bitmap.width===0||pe.bitmap.height===0)continue;const de={x:0,y:0,w:pe.bitmap.width+2,h:pe.bitmap.height+2};ot.push(de),Jt[me]={rect:de,metrics:pe.metrics}}}const{w:Et,h:Nt}=a.p(ot),zt=new a.o({width:Et||1,height:Nt||1});for(const qt in Z){const St=Z[qt];for(const Jt in St){const me=St[+Jt];if(!me||me.bitmap.width===0||me.bitmap.height===0)continue;const pe=J[qt][Jt].rect;a.o.copy(me.bitmap,zt,{x:0,y:0},{x:pe.x+1,y:pe.y+1},me.bitmap)}}this.image=zt,this.positions=J}}a.bi("GlyphAtlas",A);class f{constructor(Z){this.tileID=new a.Q(Z.tileID.overscaledZ,Z.tileID.wrap,Z.tileID.canonical.z,Z.tileID.canonical.x,Z.tileID.canonical.y),this.uid=Z.uid,this.zoom=Z.zoom,this.pixelRatio=Z.pixelRatio,this.tileSize=Z.tileSize,this.source=Z.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Z.showCollisionBoxes,this.collectResourceTiming=!!Z.collectResourceTiming,this.returnDependencies=!!Z.returnDependencies,this.promoteId=Z.promoteId,this.inFlightDependencies=[]}parse(Z,J,ot,Et){return a._(this,void 0,void 0,function*(){this.status="parsing",this.data=Z,this.collisionBoxArray=new a.a4;const Nt=new a.bj(Object.keys(Z.layers).sort()),zt=new a.bk(this.tileID,this.promoteId);zt.bucketLayerIDs=[];const qt={},St={featureIndex:zt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ot},Jt=J.familiesBySource[this.source];for(const gr in Jt){const Wr=Z.layers[gr];if(!Wr)continue;Wr.version===1&&a.w(`Vector tile source "${this.source}" layer "${gr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const vn=Nt.encode(gr),Dn=[];for(let Dt=0;Dt<Wr.length;Dt++){const Ue=Wr.feature(Dt),Ie=zt.getId(Ue,gr);Dn.push({feature:Ue,id:Ie,index:Dt,sourceLayerIndex:vn})}for(const Dt of Jt[gr]){const Ue=Dt[0];Ue.source!==this.source&&a.w(`layer.source = ${Ue.source} does not equal this.source = ${this.source}`),Ue.minzoom&&this.zoom<Math.floor(Ue.minzoom)||Ue.maxzoom&&this.zoom>=Ue.maxzoom||Ue.visibility!=="none"&&(m(Dt,this.zoom,ot),(qt[Ue.id]=Ue.createBucket({index:zt.bucketLayerIDs.length,layers:Dt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:vn,sourceID:this.source})).populate(Dn,St,this.tileID.canonical),zt.bucketLayerIDs.push(Dt.map(Ie=>Ie.id)))}}const me=a.aE(St.glyphDependencies,gr=>Object.keys(gr).map(Number));this.inFlightDependencies.forEach(gr=>gr==null?void 0:gr.abort()),this.inFlightDependencies=[];let pe=Promise.resolve({});if(Object.keys(me).length){const gr=new AbortController;this.inFlightDependencies.push(gr),pe=Et.sendAsync({type:"GG",data:{stacks:me,source:this.source,tileID:this.tileID,type:"glyphs"}},gr)}const de=Object.keys(St.iconDependencies);let Ge=Promise.resolve({});if(de.length){const gr=new AbortController;this.inFlightDependencies.push(gr),Ge=Et.sendAsync({type:"GI",data:{icons:de,source:this.source,tileID:this.tileID,type:"icons"}},gr)}const Ye=Object.keys(St.patternDependencies);let Cr=Promise.resolve({});if(Ye.length){const gr=new AbortController;this.inFlightDependencies.push(gr),Cr=Et.sendAsync({type:"GI",data:{icons:Ye,source:this.source,tileID:this.tileID,type:"patterns"}},gr)}const[cr,Pr,kr]=yield Promise.all([pe,Ge,Cr]),Qr=new A(cr),gn=new a.bl(Pr,kr);for(const gr in qt){const Wr=qt[gr];Wr instanceof a.a5?(m(Wr.layers,this.zoom,ot),a.bm({bucket:Wr,glyphMap:cr,glyphPositions:Qr.positions,imageMap:Pr,imagePositions:gn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Wr.hasPattern&&(Wr instanceof a.bn||Wr instanceof a.bo||Wr instanceof a.bp)&&(m(Wr.layers,this.zoom,ot),Wr.addFeatures(St,this.tileID.canonical,gn.patternPositions))}return this.status="done",{buckets:Object.values(qt).filter(gr=>!gr.isEmpty()),featureIndex:zt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Qr.image,imageAtlas:gn,glyphMap:this.returnDependencies?cr:null,iconMap:this.returnDependencies?Pr:null,glyphPositions:this.returnDependencies?Qr.positions:null}})}}function m(Ct,Z,J){const ot=new a.a8(Z);for(const Et of Ct)Et.recalculate(ot,J)}class b{constructor(Z,J,ot){this.actor=Z,this.layerIndex=J,this.availableImages=ot,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(Z,J){return a._(this,void 0,void 0,function*(){const ot=yield a.l(Z.request,J);try{return{vectorTile:new a.bq.VectorTile(new a.br(ot.data)),rawData:ot.data,cacheControl:ot.cacheControl,expires:ot.expires}}catch(Et){const Nt=new Uint8Array(ot.data);let zt=`Unable to parse the tile at ${Z.request.url}, `;throw zt+=Nt[0]===31&&Nt[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Et.messge}`,new Error(zt)}})}loadTile(Z){return a._(this,void 0,void 0,function*(){const J=Z.uid,ot=!!(Z&&Z.request&&Z.request.collectResourceTiming)&&new a.bs(Z.request),Et=new f(Z);this.loading[J]=Et;const Nt=new AbortController;Et.abort=Nt;try{const zt=yield this.loadVectorTile(Z,Nt);if(delete this.loading[J],!zt)return null;const qt=zt.rawData,St={};zt.expires&&(St.expires=zt.expires),zt.cacheControl&&(St.cacheControl=zt.cacheControl);const Jt={};if(ot){const pe=ot.finish();pe&&(Jt.resourceTiming=JSON.parse(JSON.stringify(pe)))}Et.vectorTile=zt.vectorTile;const me=Et.parse(zt.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[J]=Et,this.fetching[J]={rawTileData:qt,cacheControl:St,resourceTiming:Jt};try{const pe=yield me;return a.e({rawTileData:qt.slice(0)},pe,St,Jt)}finally{delete this.fetching[J]}}catch(zt){throw delete this.loading[J],Et.status="done",this.loaded[J]=Et,zt}})}reloadTile(Z){return a._(this,void 0,void 0,function*(){const J=Z.uid;if(!this.loaded||!this.loaded[J])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ot=this.loaded[J];if(ot.showCollisionBoxes=Z.showCollisionBoxes,ot.status==="parsing"){const Et=yield ot.parse(ot.vectorTile,this.layerIndex,this.availableImages,this.actor);let Nt;if(this.fetching[J]){const{rawTileData:zt,cacheControl:qt,resourceTiming:St}=this.fetching[J];delete this.fetching[J],Nt=a.e({rawTileData:zt.slice(0)},Et,qt,St)}else Nt=Et;return Nt}if(ot.status==="done"&&ot.vectorTile)return ot.parse(ot.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(Z){return a._(this,void 0,void 0,function*(){const J=this.loading,ot=Z.uid;J&&J[ot]&&J[ot].abort&&(J[ot].abort.abort(),delete J[ot])})}removeTile(Z){return a._(this,void 0,void 0,function*(){this.loaded&&this.loaded[Z.uid]&&delete this.loaded[Z.uid]})}}class x{constructor(){this.loaded={}}loadTile(Z){return a._(this,void 0,void 0,function*(){const{uid:J,encoding:ot,rawImageData:Et,redFactor:Nt,greenFactor:zt,blueFactor:qt,baseShift:St}=Z,Jt=Et.width+2,me=Et.height+2,pe=a.b(Et)?new a.R({width:Jt,height:me},yield a.bt(Et,-1,-1,Jt,me)):Et,de=new a.bu(J,pe,ot,Nt,zt,qt,St);return this.loaded=this.loaded||{},this.loaded[J]=de,de})}removeTile(Z){const J=this.loaded,ot=Z.uid;J&&J[ot]&&delete J[ot]}}function C(Ct,Z){if(Ct.length!==0){M(Ct[0],Z);for(var J=1;J<Ct.length;J++)M(Ct[J],!Z)}}function M(Ct,Z){for(var J=0,ot=0,Et=0,Nt=Ct.length,zt=Nt-1;Et<Nt;zt=Et++){var qt=(Ct[Et][0]-Ct[zt][0])*(Ct[zt][1]+Ct[Et][1]),St=J+qt;ot+=Math.abs(J)>=Math.abs(qt)?J-St+qt:qt-St+J,J=St}J+ot>=0!=!!Z&&Ct.reverse()}var U=a.bv(function Ct(Z,J){var ot,Et=Z&&Z.type;if(Et==="FeatureCollection")for(ot=0;ot<Z.features.length;ot++)Ct(Z.features[ot],J);else if(Et==="GeometryCollection")for(ot=0;ot<Z.geometries.length;ot++)Ct(Z.geometries[ot],J);else if(Et==="Feature")Ct(Z.geometry,J);else if(Et==="Polygon")C(Z.coordinates,J);else if(Et==="MultiPolygon")for(ot=0;ot<Z.coordinates.length;ot++)C(Z.coordinates[ot],J);return Z});const N=a.bq.VectorTileFeature.prototype.toGeoJSON;var Q={exports:{}},q=a.bw,Y=a.bq.VectorTileFeature,tt=ft;function ft(Ct,Z){this.options=Z||{},this.features=Ct,this.length=Ct.length}function pt(Ct,Z){this.id=typeof Ct.id=="number"?Ct.id:void 0,this.type=Ct.type,this.rawGeometry=Ct.type===1?[Ct.geometry]:Ct.geometry,this.properties=Ct.tags,this.extent=Z||4096}ft.prototype.feature=function(Ct){return new pt(this.features[Ct],this.options.extent)},pt.prototype.loadGeometry=function(){var Ct=this.rawGeometry;this.geometry=[];for(var Z=0;Z<Ct.length;Z++){for(var J=Ct[Z],ot=[],Et=0;Et<J.length;Et++)ot.push(new q(J[Et][0],J[Et][1]));this.geometry.push(ot)}return this.geometry},pt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ct=this.geometry,Z=1/0,J=-1/0,ot=1/0,Et=-1/0,Nt=0;Nt<Ct.length;Nt++)for(var zt=Ct[Nt],qt=0;qt<zt.length;qt++){var St=zt[qt];Z=Math.min(Z,St.x),J=Math.max(J,St.x),ot=Math.min(ot,St.y),Et=Math.max(Et,St.y)}return[Z,ot,J,Et]},pt.prototype.toGeoJSON=Y.prototype.toGeoJSON;var mt=a.bx,dt=tt;function Rt(Ct){var Z=new mt;return function(J,ot){for(var Et in J.layers)ot.writeMessage(3,Lt,J.layers[Et])}(Ct,Z),Z.finish()}function Lt(Ct,Z){var J;Z.writeVarintField(15,Ct.version||1),Z.writeStringField(1,Ct.name||""),Z.writeVarintField(5,Ct.extent||4096);var ot={keys:[],values:[],keycache:{},valuecache:{}};for(J=0;J<Ct.length;J++)ot.feature=Ct.feature(J),Z.writeMessage(2,st,ot);var Et=ot.keys;for(J=0;J<Et.length;J++)Z.writeStringField(3,Et[J]);var Nt=ot.values;for(J=0;J<Nt.length;J++)Z.writeMessage(4,Zt,Nt[J])}function st(Ct,Z){var J=Ct.feature;J.id!==void 0&&Z.writeVarintField(1,J.id),Z.writeMessage(2,ct,Ct),Z.writeVarintField(3,J.type),Z.writeMessage(4,te,J)}function ct(Ct,Z){var J=Ct.feature,ot=Ct.keys,Et=Ct.values,Nt=Ct.keycache,zt=Ct.valuecache;for(var qt in J.properties){var St=J.properties[qt],Jt=Nt[qt];if(St!==null){Jt===void 0&&(ot.push(qt),Nt[qt]=Jt=ot.length-1),Z.writeVarint(Jt);var me=typeof St;me!=="string"&&me!=="boolean"&&me!=="number"&&(St=JSON.stringify(St));var pe=me+":"+St,de=zt[pe];de===void 0&&(Et.push(St),zt[pe]=de=Et.length-1),Z.writeVarint(de)}}}function wt(Ct,Z){return(Z<<3)+(7&Ct)}function yt(Ct){return Ct<<1^Ct>>31}function te(Ct,Z){for(var J=Ct.loadGeometry(),ot=Ct.type,Et=0,Nt=0,zt=J.length,qt=0;qt<zt;qt++){var St=J[qt],Jt=1;ot===1&&(Jt=St.length),Z.writeVarint(wt(1,Jt));for(var me=ot===3?St.length-1:St.length,pe=0;pe<me;pe++){pe===1&&ot!==1&&Z.writeVarint(wt(2,me-1));var de=St[pe].x-Et,Ge=St[pe].y-Nt;Z.writeVarint(yt(de)),Z.writeVarint(yt(Ge)),Et+=de,Nt+=Ge}ot===3&&Z.writeVarint(wt(7,1))}}function Zt(Ct,Z){var J=typeof Ct;J==="string"?Z.writeStringField(1,Ct):J==="boolean"?Z.writeBooleanField(7,Ct):J==="number"&&(Ct%1!=0?Z.writeDoubleField(3,Ct):Ct<0?Z.writeSVarintField(6,Ct):Z.writeVarintField(5,Ct))}Q.exports=Rt,Q.exports.fromVectorTileJs=Rt,Q.exports.fromGeojsonVt=function(Ct,Z){Z=Z||{};var J={};for(var ot in Ct)J[ot]=new dt(Ct[ot].features,Z),J[ot].name=ot,J[ot].version=Z.version,J[ot].extent=Z.extent;return Rt({layers:J})},Q.exports.GeoJSONWrapper=dt;var re=a.bv(Q.exports);const Xt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ct=>Ct},ne=Math.fround||(se=new Float32Array(1),Ct=>(se[0]=+Ct,se[0]));var se;const we=3,it=5,vt=6;class Ft{constructor(Z){this.options=Object.assign(Object.create(Xt),Z),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Z){const{log:J,minZoom:ot,maxZoom:Et}=this.options;J&&console.time("total time");const Nt=`prepare ${Z.length} points`;J&&console.time(Nt),this.points=Z;const zt=[];for(let St=0;St<Z.length;St++){const Jt=Z[St];if(!Jt.geometry)continue;const[me,pe]=Jt.geometry.coordinates,de=ne(jt(me)),Ge=ne(ae(pe));zt.push(de,Ge,1/0,St,-1,1),this.options.reduce&&zt.push(0)}let qt=this.trees[Et+1]=this._createTree(zt);J&&console.timeEnd(Nt);for(let St=Et;St>=ot;St--){const Jt=+Date.now();qt=this.trees[St]=this._createTree(this._cluster(qt,St)),J&&console.log("z%d: %d clusters in %dms",St,qt.numItems,+Date.now()-Jt)}return J&&console.timeEnd("total time"),this}getClusters(Z,J){let ot=((Z[0]+180)%360+360)%360-180;const Et=Math.max(-90,Math.min(90,Z[1]));let Nt=Z[2]===180?180:((Z[2]+180)%360+360)%360-180;const zt=Math.max(-90,Math.min(90,Z[3]));if(Z[2]-Z[0]>=360)ot=-180,Nt=180;else if(ot>Nt){const pe=this.getClusters([ot,Et,180,zt],J),de=this.getClusters([-180,Et,Nt,zt],J);return pe.concat(de)}const qt=this.trees[this._limitZoom(J)],St=qt.range(jt(ot),ae(zt),jt(Nt),ae(Et)),Jt=qt.data,me=[];for(const pe of St){const de=this.stride*pe;me.push(Jt[de+it]>1?Ot(Jt,de,this.clusterProps):this.points[Jt[de+we]])}return me}getChildren(Z){const J=this._getOriginId(Z),ot=this._getOriginZoom(Z),Et="No cluster with the specified id.",Nt=this.trees[ot];if(!Nt)throw new Error(Et);const zt=Nt.data;if(J*this.stride>=zt.length)throw new Error(Et);const qt=this.options.radius/(this.options.extent*Math.pow(2,ot-1)),St=Nt.within(zt[J*this.stride],zt[J*this.stride+1],qt),Jt=[];for(const me of St){const pe=me*this.stride;zt[pe+4]===Z&&Jt.push(zt[pe+it]>1?Ot(zt,pe,this.clusterProps):this.points[zt[pe+we]])}if(Jt.length===0)throw new Error(Et);return Jt}getLeaves(Z,J,ot){const Et=[];return this._appendLeaves(Et,Z,J=J||10,ot=ot||0,0),Et}getTile(Z,J,ot){const Et=this.trees[this._limitZoom(Z)],Nt=Math.pow(2,Z),{extent:zt,radius:qt}=this.options,St=qt/zt,Jt=(ot-St)/Nt,me=(ot+1+St)/Nt,pe={features:[]};return this._addTileFeatures(Et.range((J-St)/Nt,Jt,(J+1+St)/Nt,me),Et.data,J,ot,Nt,pe),J===0&&this._addTileFeatures(Et.range(1-St/Nt,Jt,1,me),Et.data,Nt,ot,Nt,pe),J===Nt-1&&this._addTileFeatures(Et.range(0,Jt,St/Nt,me),Et.data,-1,ot,Nt,pe),pe.features.length?pe:null}getClusterExpansionZoom(Z){let J=this._getOriginZoom(Z)-1;for(;J<=this.options.maxZoom;){const ot=this.getChildren(Z);if(J++,ot.length!==1)break;Z=ot[0].properties.cluster_id}return J}_appendLeaves(Z,J,ot,Et,Nt){const zt=this.getChildren(J);for(const qt of zt){const St=qt.properties;if(St&&St.cluster?Nt+St.point_count<=Et?Nt+=St.point_count:Nt=this._appendLeaves(Z,St.cluster_id,ot,Et,Nt):Nt<Et?Nt++:Z.push(qt),Z.length===ot)break}return Nt}_createTree(Z){const J=new a.au(Z.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ot=0;ot<Z.length;ot+=this.stride)J.add(Z[ot],Z[ot+1]);return J.finish(),J.data=Z,J}_addTileFeatures(Z,J,ot,Et,Nt,zt){for(const qt of Z){const St=qt*this.stride,Jt=J[St+it]>1;let me,pe,de;if(Jt)me=Wt(J,St,this.clusterProps),pe=J[St],de=J[St+1];else{const Cr=this.points[J[St+we]];me=Cr.properties;const[cr,Pr]=Cr.geometry.coordinates;pe=jt(cr),de=ae(Pr)}const Ge={type:1,geometry:[[Math.round(this.options.extent*(pe*Nt-ot)),Math.round(this.options.extent*(de*Nt-Et))]],tags:me};let Ye;Ye=Jt||this.options.generateId?J[St+we]:this.points[J[St+we]].id,Ye!==void 0&&(Ge.id=Ye),zt.features.push(Ge)}}_limitZoom(Z){return Math.max(this.options.minZoom,Math.min(Math.floor(+Z),this.options.maxZoom+1))}_cluster(Z,J){const{radius:ot,extent:Et,reduce:Nt,minPoints:zt}=this.options,qt=ot/(Et*Math.pow(2,J)),St=Z.data,Jt=[],me=this.stride;for(let pe=0;pe<St.length;pe+=me){if(St[pe+2]<=J)continue;St[pe+2]=J;const de=St[pe],Ge=St[pe+1],Ye=Z.within(St[pe],St[pe+1],qt),Cr=St[pe+it];let cr=Cr;for(const Pr of Ye){const kr=Pr*me;St[kr+2]>J&&(cr+=St[kr+it])}if(cr>Cr&&cr>=zt){let Pr,kr=de*Cr,Qr=Ge*Cr,gn=-1;const gr=((pe/me|0)<<5)+(J+1)+this.points.length;for(const Wr of Ye){const vn=Wr*me;if(St[vn+2]<=J)continue;St[vn+2]=J;const Dn=St[vn+it];kr+=St[vn]*Dn,Qr+=St[vn+1]*Dn,St[vn+4]=gr,Nt&&(Pr||(Pr=this._map(St,pe,!0),gn=this.clusterProps.length,this.clusterProps.push(Pr)),Nt(Pr,this._map(St,vn)))}St[pe+4]=gr,Jt.push(kr/cr,Qr/cr,1/0,gr,-1,cr),Nt&&Jt.push(gn)}else{for(let Pr=0;Pr<me;Pr++)Jt.push(St[pe+Pr]);if(cr>1)for(const Pr of Ye){const kr=Pr*me;if(!(St[kr+2]<=J)){St[kr+2]=J;for(let Qr=0;Qr<me;Qr++)Jt.push(St[kr+Qr])}}}}return Jt}_getOriginId(Z){return Z-this.points.length>>5}_getOriginZoom(Z){return(Z-this.points.length)%32}_map(Z,J,ot){if(Z[J+it]>1){const zt=this.clusterProps[Z[J+vt]];return ot?Object.assign({},zt):zt}const Et=this.points[Z[J+we]].properties,Nt=this.options.map(Et);return ot&&Nt===Et?Object.assign({},Nt):Nt}}function Ot(Ct,Z,J){return{type:"Feature",id:Ct[Z+we],properties:Wt(Ct,Z,J),geometry:{type:"Point",coordinates:[(ot=Ct[Z],360*(ot-.5)),ie(Ct[Z+1])]}};var ot}function Wt(Ct,Z,J){const ot=Ct[Z+it],Et=ot>=1e4?`${Math.round(ot/1e3)}k`:ot>=1e3?Math.round(ot/100)/10+"k":ot,Nt=Ct[Z+vt],zt=Nt===-1?{}:Object.assign({},J[Nt]);return Object.assign(zt,{cluster:!0,cluster_id:Ct[Z+we],point_count:ot,point_count_abbreviated:Et})}function jt(Ct){return Ct/360+.5}function ae(Ct){const Z=Math.sin(Ct*Math.PI/180),J=.5-.25*Math.log((1+Z)/(1-Z))/Math.PI;return J<0?0:J>1?1:J}function ie(Ct){const Z=(180-360*Ct)*Math.PI/180;return 360*Math.atan(Math.exp(Z))/Math.PI-90}function Be(Ct,Z,J,ot){for(var Et,Nt=ot,zt=J-Z>>1,qt=J-Z,St=Ct[Z],Jt=Ct[Z+1],me=Ct[J],pe=Ct[J+1],de=Z+3;de<J;de+=3){var Ge=Te(Ct[de],Ct[de+1],St,Jt,me,pe);if(Ge>Nt)Et=de,Nt=Ge;else if(Ge===Nt){var Ye=Math.abs(de-zt);Ye<qt&&(Et=de,qt=Ye)}}Nt>ot&&(Et-Z>3&&Be(Ct,Z,Et,ot),Ct[Et+2]=Nt,J-Et>3&&Be(Ct,Et,J,ot))}function Te(Ct,Z,J,ot,Et,Nt){var zt=Et-J,qt=Nt-ot;if(zt!==0||qt!==0){var St=((Ct-J)*zt+(Z-ot)*qt)/(zt*zt+qt*qt);St>1?(J=Et,ot=Nt):St>0&&(J+=zt*St,ot+=qt*St)}return(zt=Ct-J)*zt+(qt=Z-ot)*qt}function Ne(Ct,Z,J,ot){var Et={id:Ct===void 0?null:Ct,type:Z,geometry:J,tags:ot,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Nt){var zt=Nt.geometry,qt=Nt.type;if(qt==="Point"||qt==="MultiPoint"||qt==="LineString")Qe(Nt,zt);else if(qt==="Polygon"||qt==="MultiLineString")for(var St=0;St<zt.length;St++)Qe(Nt,zt[St]);else if(qt==="MultiPolygon")for(St=0;St<zt.length;St++)for(var Jt=0;Jt<zt[St].length;Jt++)Qe(Nt,zt[St][Jt])}(Et),Et}function Qe(Ct,Z){for(var J=0;J<Z.length;J+=3)Ct.minX=Math.min(Ct.minX,Z[J]),Ct.minY=Math.min(Ct.minY,Z[J+1]),Ct.maxX=Math.max(Ct.maxX,Z[J]),Ct.maxY=Math.max(Ct.maxY,Z[J+1])}function He(Ct,Z,J,ot){if(Z.geometry){var Et=Z.geometry.coordinates,Nt=Z.geometry.type,zt=Math.pow(J.tolerance/((1<<J.maxZoom)*J.extent),2),qt=[],St=Z.id;if(J.promoteId?St=Z.properties[J.promoteId]:J.generateId&&(St=ot||0),Nt==="Point")ge(Et,qt);else if(Nt==="MultiPoint")for(var Jt=0;Jt<Et.length;Jt++)ge(Et[Jt],qt);else if(Nt==="LineString")Ut(Et,qt,zt,!1);else if(Nt==="MultiLineString"){if(J.lineMetrics){for(Jt=0;Jt<Et.length;Jt++)Ut(Et[Jt],qt=[],zt,!1),Ct.push(Ne(St,"LineString",qt,Z.properties));return}Yt(Et,qt,zt,!1)}else if(Nt==="Polygon")Yt(Et,qt,zt,!0);else{if(Nt!=="MultiPolygon"){if(Nt==="GeometryCollection"){for(Jt=0;Jt<Z.geometry.geometries.length;Jt++)He(Ct,{id:St,geometry:Z.geometry.geometries[Jt],properties:Z.properties},J,ot);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Jt=0;Jt<Et.length;Jt++){var me=[];Yt(Et[Jt],me,zt,!0),qt.push(me)}}Ct.push(Ne(St,Nt,qt,Z.properties))}}function ge(Ct,Z){Z.push(tr(Ct[0])),Z.push(Ee(Ct[1])),Z.push(0)}function Ut(Ct,Z,J,ot){for(var Et,Nt,zt=0,qt=0;qt<Ct.length;qt++){var St=tr(Ct[qt][0]),Jt=Ee(Ct[qt][1]);Z.push(St),Z.push(Jt),Z.push(0),qt>0&&(zt+=ot?(Et*Jt-St*Nt)/2:Math.sqrt(Math.pow(St-Et,2)+Math.pow(Jt-Nt,2))),Et=St,Nt=Jt}var me=Z.length-3;Z[2]=1,Be(Z,0,me,J),Z[me+2]=1,Z.size=Math.abs(zt),Z.start=0,Z.end=Z.size}function Yt(Ct,Z,J,ot){for(var Et=0;Et<Ct.length;Et++){var Nt=[];Ut(Ct[Et],Nt,J,ot),Z.push(Nt)}}function tr(Ct){return Ct/360+.5}function Ee(Ct){var Z=Math.sin(Ct*Math.PI/180),J=.5-.25*Math.log((1+Z)/(1-Z))/Math.PI;return J<0?0:J>1?1:J}function _e(Ct,Z,J,ot,Et,Nt,zt,qt){if(ot/=Z,Nt>=(J/=Z)&&zt<ot)return Ct;if(zt<J||Nt>=ot)return null;for(var St=[],Jt=0;Jt<Ct.length;Jt++){var me=Ct[Jt],pe=me.geometry,de=me.type,Ge=Et===0?me.minX:me.minY,Ye=Et===0?me.maxX:me.maxY;if(Ge>=J&&Ye<ot)St.push(me);else if(!(Ye<J||Ge>=ot)){var Cr=[];if(de==="Point"||de==="MultiPoint")xe(pe,Cr,J,ot,Et);else if(de==="LineString")De(pe,Cr,J,ot,Et,!1,qt.lineMetrics);else if(de==="MultiLineString")ur(pe,Cr,J,ot,Et,!1);else if(de==="Polygon")ur(pe,Cr,J,ot,Et,!0);else if(de==="MultiPolygon")for(var cr=0;cr<pe.length;cr++){var Pr=[];ur(pe[cr],Pr,J,ot,Et,!0),Pr.length&&Cr.push(Pr)}if(Cr.length){if(qt.lineMetrics&&de==="LineString"){for(cr=0;cr<Cr.length;cr++)St.push(Ne(me.id,de,Cr[cr],me.tags));continue}de!=="LineString"&&de!=="MultiLineString"||(Cr.length===1?(de="LineString",Cr=Cr[0]):de="MultiLineString"),de!=="Point"&&de!=="MultiPoint"||(de=Cr.length===3?"Point":"MultiPoint"),St.push(Ne(me.id,de,Cr,me.tags))}}}return St.length?St:null}function xe(Ct,Z,J,ot,Et){for(var Nt=0;Nt<Ct.length;Nt+=3){var zt=Ct[Nt+Et];zt>=J&&zt<=ot&&(Z.push(Ct[Nt]),Z.push(Ct[Nt+1]),Z.push(Ct[Nt+2]))}}function De(Ct,Z,J,ot,Et,Nt,zt){for(var qt,St,Jt=nr(Ct),me=Et===0?Sr:Dr,pe=Ct.start,de=0;de<Ct.length-3;de+=3){var Ge=Ct[de],Ye=Ct[de+1],Cr=Ct[de+2],cr=Ct[de+3],Pr=Ct[de+4],kr=Et===0?Ge:Ye,Qr=Et===0?cr:Pr,gn=!1;zt&&(qt=Math.sqrt(Math.pow(Ge-cr,2)+Math.pow(Ye-Pr,2))),kr<J?Qr>J&&(St=me(Jt,Ge,Ye,cr,Pr,J),zt&&(Jt.start=pe+qt*St)):kr>ot?Qr<ot&&(St=me(Jt,Ge,Ye,cr,Pr,ot),zt&&(Jt.start=pe+qt*St)):Ir(Jt,Ge,Ye,Cr),Qr<J&&kr>=J&&(St=me(Jt,Ge,Ye,cr,Pr,J),gn=!0),Qr>ot&&kr<=ot&&(St=me(Jt,Ge,Ye,cr,Pr,ot),gn=!0),!Nt&&gn&&(zt&&(Jt.end=pe+qt*St),Z.push(Jt),Jt=nr(Ct)),zt&&(pe+=qt)}var gr=Ct.length-3;Ge=Ct[gr],Ye=Ct[gr+1],Cr=Ct[gr+2],(kr=Et===0?Ge:Ye)>=J&&kr<=ot&&Ir(Jt,Ge,Ye,Cr),gr=Jt.length-3,Nt&&gr>=3&&(Jt[gr]!==Jt[0]||Jt[gr+1]!==Jt[1])&&Ir(Jt,Jt[0],Jt[1],Jt[2]),Jt.length&&Z.push(Jt)}function nr(Ct){var Z=[];return Z.size=Ct.size,Z.start=Ct.start,Z.end=Ct.end,Z}function ur(Ct,Z,J,ot,Et,Nt){for(var zt=0;zt<Ct.length;zt++)De(Ct[zt],Z,J,ot,Et,Nt,!1)}function Ir(Ct,Z,J,ot){Ct.push(Z),Ct.push(J),Ct.push(ot)}function Sr(Ct,Z,J,ot,Et,Nt){var zt=(Nt-Z)/(ot-Z);return Ct.push(Nt),Ct.push(J+(Et-J)*zt),Ct.push(1),zt}function Dr(Ct,Z,J,ot,Et,Nt){var zt=(Nt-J)/(Et-J);return Ct.push(Z+(ot-Z)*zt),Ct.push(Nt),Ct.push(1),zt}function Nr(Ct,Z){for(var J=[],ot=0;ot<Ct.length;ot++){var Et,Nt=Ct[ot],zt=Nt.type;if(zt==="Point"||zt==="MultiPoint"||zt==="LineString")Et=fe(Nt.geometry,Z);else if(zt==="MultiLineString"||zt==="Polygon"){Et=[];for(var qt=0;qt<Nt.geometry.length;qt++)Et.push(fe(Nt.geometry[qt],Z))}else if(zt==="MultiPolygon")for(Et=[],qt=0;qt<Nt.geometry.length;qt++){for(var St=[],Jt=0;Jt<Nt.geometry[qt].length;Jt++)St.push(fe(Nt.geometry[qt][Jt],Z));Et.push(St)}J.push(Ne(Nt.id,zt,Et,Nt.tags))}return J}function fe(Ct,Z){var J=[];J.size=Ct.size,Ct.start!==void 0&&(J.start=Ct.start,J.end=Ct.end);for(var ot=0;ot<Ct.length;ot+=3)J.push(Ct[ot]+Z,Ct[ot+1],Ct[ot+2]);return J}function Tr(Ct,Z){if(Ct.transformed)return Ct;var J,ot,Et,Nt=1<<Ct.z,zt=Ct.x,qt=Ct.y;for(J=0;J<Ct.features.length;J++){var St=Ct.features[J],Jt=St.geometry,me=St.type;if(St.geometry=[],me===1)for(ot=0;ot<Jt.length;ot+=2)St.geometry.push(Oe(Jt[ot],Jt[ot+1],Z,Nt,zt,qt));else for(ot=0;ot<Jt.length;ot++){var pe=[];for(Et=0;Et<Jt[ot].length;Et+=2)pe.push(Oe(Jt[ot][Et],Jt[ot][Et+1],Z,Nt,zt,qt));St.geometry.push(pe)}}return Ct.transformed=!0,Ct}function Oe(Ct,Z,J,ot,Et,Nt){return[Math.round(J*(Ct*ot-Et)),Math.round(J*(Z*ot-Nt))]}function wn(Ct,Z,J,ot,Et){for(var Nt=Z===Et.maxZoom?0:Et.tolerance/((1<<Z)*Et.extent),zt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:J,y:ot,z:Z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},qt=0;qt<Ct.length;qt++){zt.numFeatures++,Fr(zt,Ct[qt],Nt,Et);var St=Ct[qt].minX,Jt=Ct[qt].minY,me=Ct[qt].maxX,pe=Ct[qt].maxY;St<zt.minX&&(zt.minX=St),Jt<zt.minY&&(zt.minY=Jt),me>zt.maxX&&(zt.maxX=me),pe>zt.maxY&&(zt.maxY=pe)}return zt}function Fr(Ct,Z,J,ot){var Et=Z.geometry,Nt=Z.type,zt=[];if(Nt==="Point"||Nt==="MultiPoint")for(var qt=0;qt<Et.length;qt+=3)zt.push(Et[qt]),zt.push(Et[qt+1]),Ct.numPoints++,Ct.numSimplified++;else if(Nt==="LineString")Se(zt,Et,Ct,J,!1,!1);else if(Nt==="MultiLineString"||Nt==="Polygon")for(qt=0;qt<Et.length;qt++)Se(zt,Et[qt],Ct,J,Nt==="Polygon",qt===0);else if(Nt==="MultiPolygon")for(var St=0;St<Et.length;St++){var Jt=Et[St];for(qt=0;qt<Jt.length;qt++)Se(zt,Jt[qt],Ct,J,!0,qt===0)}if(zt.length){var me=Z.tags||null;if(Nt==="LineString"&&ot.lineMetrics){for(var pe in me={},Z.tags)me[pe]=Z.tags[pe];me.mapbox_clip_start=Et.start/Et.size,me.mapbox_clip_end=Et.end/Et.size}var de={geometry:zt,type:Nt==="Polygon"||Nt==="MultiPolygon"?3:Nt==="LineString"||Nt==="MultiLineString"?2:1,tags:me};Z.id!==null&&(de.id=Z.id),Ct.features.push(de)}}function Se(Ct,Z,J,ot,Et,Nt){var zt=ot*ot;if(ot>0&&Z.size<(Et?zt:ot))J.numPoints+=Z.length/3;else{for(var qt=[],St=0;St<Z.length;St+=3)(ot===0||Z[St+2]>zt)&&(J.numSimplified++,qt.push(Z[St]),qt.push(Z[St+1])),J.numPoints++;Et&&function(Jt,me){for(var pe=0,de=0,Ge=Jt.length,Ye=Ge-2;de<Ge;Ye=de,de+=2)pe+=(Jt[de]-Jt[Ye])*(Jt[de+1]+Jt[Ye+1]);if(pe>0===me)for(de=0,Ge=Jt.length;de<Ge/2;de+=2){var Cr=Jt[de],cr=Jt[de+1];Jt[de]=Jt[Ge-2-de],Jt[de+1]=Jt[Ge-1-de],Jt[Ge-2-de]=Cr,Jt[Ge-1-de]=cr}}(qt,Nt),Ct.push(qt)}}function Xe(Ct,Z){var J=(Z=this.options=function(Et,Nt){for(var zt in Nt)Et[zt]=Nt[zt];return Et}(Object.create(this.options),Z)).debug;if(J&&console.time("preprocess data"),Z.maxZoom<0||Z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Z.promoteId&&Z.generateId)throw new Error("promoteId and generateId cannot be used together.");var ot=function(Et,Nt){var zt=[];if(Et.type==="FeatureCollection")for(var qt=0;qt<Et.features.length;qt++)He(zt,Et.features[qt],Nt,qt);else He(zt,Et.type==="Feature"?Et:{geometry:Et},Nt);return zt}(Ct,Z);this.tiles={},this.tileCoords=[],J&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Z.indexMaxZoom,Z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ot=function(Et,Nt){var zt=Nt.buffer/Nt.extent,qt=Et,St=_e(Et,1,-1-zt,zt,0,-1,2,Nt),Jt=_e(Et,1,1-zt,2+zt,0,-1,2,Nt);return(St||Jt)&&(qt=_e(Et,1,-zt,1+zt,0,-1,2,Nt)||[],St&&(qt=Nr(St,1).concat(qt)),Jt&&(qt=qt.concat(Nr(Jt,-1)))),qt}(ot,Z),ot.length&&this.splitTile(ot,0,0,0),J&&(ot.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function qe(Ct,Z,J){return 32*((1<<Ct)*J+Z)+Ct}function Yr(Ct,Z){return Z?Ct.properties[Z]:Ct.id}function Rr(Ct,Z){if(Ct==null)return!0;if(Ct.type==="Feature")return Yr(Ct,Z)!=null;if(Ct.type==="FeatureCollection"){const J=new Set;for(const ot of Ct.features){const Et=Yr(ot,Z);if(Et==null||J.has(Et))return!1;J.add(Et)}return!0}return!1}function pr(Ct,Z){const J=new Map;if(Ct!=null)if(Ct.type==="Feature")J.set(Yr(Ct,Z),Ct);else for(const ot of Ct.features)J.set(Yr(ot,Z),ot);return J}Xe.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Xe.prototype.splitTile=function(Ct,Z,J,ot,Et,Nt,zt){for(var qt=[Ct,Z,J,ot],St=this.options,Jt=St.debug;qt.length;){ot=qt.pop(),J=qt.pop(),Z=qt.pop(),Ct=qt.pop();var me=1<<Z,pe=qe(Z,J,ot),de=this.tiles[pe];if(!de&&(Jt>1&&console.time("creation"),de=this.tiles[pe]=wn(Ct,Z,J,ot,St),this.tileCoords.push({z:Z,x:J,y:ot}),Jt)){Jt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Z,J,ot,de.numFeatures,de.numPoints,de.numSimplified),console.timeEnd("creation"));var Ge="z"+Z;this.stats[Ge]=(this.stats[Ge]||0)+1,this.total++}if(de.source=Ct,Et){if(Z===St.maxZoom||Z===Et)continue;var Ye=1<<Et-Z;if(J!==Math.floor(Nt/Ye)||ot!==Math.floor(zt/Ye))continue}else if(Z===St.indexMaxZoom||de.numPoints<=St.indexMaxPoints)continue;if(de.source=null,Ct.length!==0){Jt>1&&console.time("clipping");var Cr,cr,Pr,kr,Qr,gn,gr=.5*St.buffer/St.extent,Wr=.5-gr,vn=.5+gr,Dn=1+gr;Cr=cr=Pr=kr=null,Qr=_e(Ct,me,J-gr,J+vn,0,de.minX,de.maxX,St),gn=_e(Ct,me,J+Wr,J+Dn,0,de.minX,de.maxX,St),Ct=null,Qr&&(Cr=_e(Qr,me,ot-gr,ot+vn,1,de.minY,de.maxY,St),cr=_e(Qr,me,ot+Wr,ot+Dn,1,de.minY,de.maxY,St),Qr=null),gn&&(Pr=_e(gn,me,ot-gr,ot+vn,1,de.minY,de.maxY,St),kr=_e(gn,me,ot+Wr,ot+Dn,1,de.minY,de.maxY,St),gn=null),Jt>1&&console.timeEnd("clipping"),qt.push(Cr||[],Z+1,2*J,2*ot),qt.push(cr||[],Z+1,2*J,2*ot+1),qt.push(Pr||[],Z+1,2*J+1,2*ot),qt.push(kr||[],Z+1,2*J+1,2*ot+1)}}},Xe.prototype.getTile=function(Ct,Z,J){var ot=this.options,Et=ot.extent,Nt=ot.debug;if(Ct<0||Ct>24)return null;var zt=1<<Ct,qt=qe(Ct,Z=(Z%zt+zt)%zt,J);if(this.tiles[qt])return Tr(this.tiles[qt],Et);Nt>1&&console.log("drilling down to z%d-%d-%d",Ct,Z,J);for(var St,Jt=Ct,me=Z,pe=J;!St&&Jt>0;)Jt--,me=Math.floor(me/2),pe=Math.floor(pe/2),St=this.tiles[qe(Jt,me,pe)];return St&&St.source?(Nt>1&&console.log("found parent tile z%d-%d-%d",Jt,me,pe),Nt>1&&console.time("drilling down"),this.splitTile(St.source,Jt,me,pe,Ct,Z,J),Nt>1&&console.timeEnd("drilling down"),this.tiles[qt]?Tr(this.tiles[qt],Et):null):null};class on extends b{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(Z,J){return a._(this,void 0,void 0,function*(){const ot=Z.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Et=this._geoJSONIndex.getTile(ot.z,ot.x,ot.y);if(!Et)return null;const Nt=new class{constructor(qt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.W,this.length=qt.length,this._features=qt}feature(qt){return new class{constructor(St){this._feature=St,this.extent=a.W,this.type=St.type,this.properties=St.tags,"id"in St&&!isNaN(St.id)&&(this.id=parseInt(St.id,10))}loadGeometry(){if(this._feature.type===1){const St=[];for(const Jt of this._feature.geometry)St.push([new a.P(Jt[0],Jt[1])]);return St}{const St=[];for(const Jt of this._feature.geometry){const me=[];for(const pe of Jt)me.push(new a.P(pe[0],pe[1]));St.push(me)}return St}}toGeoJSON(St,Jt,me){return N.call(this,St,Jt,me)}}(this._features[qt])}}(Et.features);let zt=re(Nt);return zt.byteOffset===0&&zt.byteLength===zt.buffer.byteLength||(zt=new Uint8Array(zt)),{vectorTile:Nt,rawData:zt.buffer}})}loadData(Z){return a._(this,void 0,void 0,function*(){var J;(J=this._pendingRequest)===null||J===void 0||J.abort();const ot=!!(Z&&Z.request&&Z.request.collectResourceTiming)&&new a.bs(Z.request);this._pendingRequest=new AbortController;try{let Et=yield this.loadGeoJSON(Z,this._pendingRequest);if(delete this._pendingRequest,typeof Et!="object")throw new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`);if(U(Et,!0),Z.filter){const zt=a.by(Z.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(zt.result==="error")throw new Error(zt.value.map(St=>`${St.key}: ${St.message}`).join(", "));Et={type:"FeatureCollection",features:Et.features.filter(St=>zt.value.evaluate({zoom:0},St))}}this._geoJSONIndex=Z.cluster?new Ft(function(zt){let{superclusterOptions:qt,clusterProperties:St}=zt;if(!St||!qt)return qt;const Jt={},me={},pe={accumulated:null,zoom:0},de={properties:null},Ge=Object.keys(St);for(const Ye of Ge){const[Cr,cr]=St[Ye],Pr=a.by(cr),kr=a.by(typeof Cr=="string"?[Cr,["accumulated"],["get",Ye]]:Cr);Jt[Ye]=Pr.value,me[Ye]=kr.value}return qt.map=Ye=>{de.properties=Ye;const Cr={};for(const cr of Ge)Cr[cr]=Jt[cr].evaluate(pe,de);return Cr},qt.reduce=(Ye,Cr)=>{de.properties=Cr;for(const cr of Ge)pe.accumulated=Ye[cr],Ye[cr]=me[cr].evaluate(pe,de)},qt}(Z)).load(Et.features):function(zt,qt){return new Xe(zt,qt)}(Et,Z.geojsonVtOptions),this.loaded={};const Nt={};if(ot){const zt=ot.finish();zt&&(Nt.resourceTiming={},Nt.resourceTiming[Z.source]=JSON.parse(JSON.stringify(zt)))}return Nt}catch(Et){if(delete this._pendingRequest,a.bz(Et))return{abandoned:!0};throw Et}})}reloadTile(Z){const J=this.loaded;return J&&J[Z.uid]?super.reloadTile(Z):this.loadTile(Z)}loadGeoJSON(Z,J){return a._(this,void 0,void 0,function*(){const{promoteId:ot}=Z;if(Z.request){const Et=yield a.h(Z.request,J);return this._dataUpdateable=Rr(Et.data,ot)?pr(Et.data,ot):void 0,Et.data}if(typeof Z.data=="string")try{const Et=JSON.parse(Z.data);return this._dataUpdateable=Rr(Et,ot)?pr(Et,ot):void 0,Et}catch{throw new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`)}if(!Z.dataDiff)throw new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${Z.source}`);return function(Et,Nt,zt){var qt,St,Jt,me;if(Nt.removeAll&&Et.clear(),Nt.remove)for(const pe of Nt.remove)Et.delete(pe);if(Nt.add)for(const pe of Nt.add){const de=Yr(pe,zt);de!=null&&Et.set(de,pe)}if(Nt.update)for(const pe of Nt.update){let de=Et.get(pe.id);if(de==null)continue;const Ge=!pe.removeAllProperties&&(((qt=pe.removeProperties)===null||qt===void 0?void 0:qt.length)>0||((St=pe.addOrUpdateProperties)===null||St===void 0?void 0:St.length)>0);if((pe.newGeometry||pe.removeAllProperties||Ge)&&(de=Object.assign({},de),Et.set(pe.id,de),Ge&&(de.properties=Object.assign({},de.properties))),pe.newGeometry&&(de.geometry=pe.newGeometry),pe.removeAllProperties)de.properties={};else if(((Jt=pe.removeProperties)===null||Jt===void 0?void 0:Jt.length)>0)for(const Ye of pe.removeProperties)Object.prototype.hasOwnProperty.call(de.properties,Ye)&&delete de.properties[Ye];if(((me=pe.addOrUpdateProperties)===null||me===void 0?void 0:me.length)>0)for(const{key:Ye,value:Cr}of pe.addOrUpdateProperties)de.properties[Ye]=Cr}}(this._dataUpdateable,Z.dataDiff,ot),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(Z){return a._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(Z){return this._geoJSONIndex.getClusterExpansionZoom(Z.clusterId)}getClusterChildren(Z){return this._geoJSONIndex.getChildren(Z.clusterId)}getClusterLeaves(Z){return this._geoJSONIndex.getLeaves(Z.clusterId,Z.limit,Z.offset)}}class Kr{constructor(Z){this.self=Z,this.actor=new a.C(Z),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(J,ot)=>{if(this.externalWorkerSourceTypes[J])throw new Error(`Worker source with name "${J}" already registered.`);this.externalWorkerSourceTypes[J]=ot},this.self.addProtocol=a.bf,this.self.removeProtocol=a.bg,this.self.registerRTLTextPlugin=J=>{if(a.bA.isParsed())throw new Error("RTL text plugin already registered.");a.bA.setMethods(J)},this.actor.registerMessageHandler("LDT",(J,ot)=>this._getDEMWorkerSource(J,ot.source).loadTile(ot)),this.actor.registerMessageHandler("RDT",(J,ot)=>a._(this,void 0,void 0,function*(){this._getDEMWorkerSource(J,ot.source).removeTile(ot)})),this.actor.registerMessageHandler("GCEZ",(J,ot)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(J,ot.type,ot.source).getClusterExpansionZoom(ot)})),this.actor.registerMessageHandler("GCC",(J,ot)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(J,ot.type,ot.source).getClusterChildren(ot)})),this.actor.registerMessageHandler("GCL",(J,ot)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(J,ot.type,ot.source).getClusterLeaves(ot)})),this.actor.registerMessageHandler("LD",(J,ot)=>this._getWorkerSource(J,ot.type,ot.source).loadData(ot)),this.actor.registerMessageHandler("LT",(J,ot)=>this._getWorkerSource(J,ot.type,ot.source).loadTile(ot)),this.actor.registerMessageHandler("RT",(J,ot)=>this._getWorkerSource(J,ot.type,ot.source).reloadTile(ot)),this.actor.registerMessageHandler("AT",(J,ot)=>this._getWorkerSource(J,ot.type,ot.source).abortTile(ot)),this.actor.registerMessageHandler("RMT",(J,ot)=>this._getWorkerSource(J,ot.type,ot.source).removeTile(ot)),this.actor.registerMessageHandler("RS",(J,ot)=>a._(this,void 0,void 0,function*(){if(!this.workerSources[J]||!this.workerSources[J][ot.type]||!this.workerSources[J][ot.type][ot.source])return;const Et=this.workerSources[J][ot.type][ot.source];delete this.workerSources[J][ot.type][ot.source],Et.removeSource!==void 0&&Et.removeSource(ot)})),this.actor.registerMessageHandler("RM",J=>a._(this,void 0,void 0,function*(){delete this.layerIndexes[J],delete this.availableImages[J],delete this.workerSources[J],delete this.demWorkerSources[J]})),this.actor.registerMessageHandler("SR",(J,ot)=>a._(this,void 0,void 0,function*(){this.referrer=ot})),this.actor.registerMessageHandler("SRPS",(J,ot)=>this._syncRTLPluginState(J,ot)),this.actor.registerMessageHandler("IS",(J,ot)=>a._(this,void 0,void 0,function*(){this.self.importScripts(ot)})),this.actor.registerMessageHandler("SI",(J,ot)=>this._setImages(J,ot)),this.actor.registerMessageHandler("UL",(J,ot)=>a._(this,void 0,void 0,function*(){this._getLayerIndex(J).update(ot.layers,ot.removedIds)})),this.actor.registerMessageHandler("SL",(J,ot)=>a._(this,void 0,void 0,function*(){this._getLayerIndex(J).replace(ot)}))}_setImages(Z,J){return a._(this,void 0,void 0,function*(){this.availableImages[Z]=J;for(const ot in this.workerSources[Z]){const Et=this.workerSources[Z][ot];for(const Nt in Et)Et[Nt].availableImages=J}})}_syncRTLPluginState(Z,J){return a._(this,void 0,void 0,function*(){if(a.bA.isParsed())return a.bA.getState();if(J.pluginStatus!=="loading")return a.bA.setState(J),J;const ot=J.pluginURL;if(this.self.importScripts(ot),a.bA.isParsed()){const Et={pluginStatus:"loaded",pluginURL:ot};return a.bA.setState(Et),Et}throw a.bA.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${ot}`)})}_getAvailableImages(Z){let J=this.availableImages[Z];return J||(J=[]),J}_getLayerIndex(Z){let J=this.layerIndexes[Z];return J||(J=this.layerIndexes[Z]=new o),J}_getWorkerSource(Z,J,ot){if(this.workerSources[Z]||(this.workerSources[Z]={}),this.workerSources[Z][J]||(this.workerSources[Z][J]={}),!this.workerSources[Z][J][ot]){const Et={sendAsync:(Nt,zt)=>(Nt.targetMapId=Z,this.actor.sendAsync(Nt,zt))};switch(J){case"vector":this.workerSources[Z][J][ot]=new b(Et,this._getLayerIndex(Z),this._getAvailableImages(Z));break;case"geojson":this.workerSources[Z][J][ot]=new on(Et,this._getLayerIndex(Z),this._getAvailableImages(Z));break;default:this.workerSources[Z][J][ot]=new this.externalWorkerSourceTypes[J](Et,this._getLayerIndex(Z),this._getAvailableImages(Z))}}return this.workerSources[Z][J][ot]}_getDEMWorkerSource(Z,J){return this.demWorkerSources[Z]||(this.demWorkerSources[Z]={}),this.demWorkerSources[Z][J]||(this.demWorkerSources[Z][J]=new x),this.demWorkerSources[Z][J]}}return a.i(self)&&(self.worker=new Kr(self)),Kr}),i("index",["exports","./shared"],function(a,o){var A="4.1.3";let f,m;const b={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:B=>new Promise((l,d)=>{const y=requestAnimationFrame(l);B.signal.addEventListener("abort",()=>{cancelAnimationFrame(y),d(o.c())})}),getImageData(B){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return this.getImageCanvasContext(B).getImageData(-l,-l,B.width+2*l,B.height+2*l)},getImageCanvasContext(B){const l=window.document.createElement("canvas"),d=l.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("failed to create canvas 2d context");return l.width=B.width,l.height=B.height,d.drawImage(B,0,0,B.width,B.height),d},resolveURL:B=>(f||(f=document.createElement("a")),f.href=B,f.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(m==null&&(m=matchMedia("(prefers-reduced-motion: reduce)")),m.matches)}};class x{static testProp(l){if(!x.docStyle)return l[0];for(let d=0;d<l.length;d++)if(l[d]in x.docStyle)return l[d];return l[0]}static create(l,d,y){const _=window.document.createElement(l);return d!==void 0&&(_.className=d),y&&y.appendChild(_),_}static createNS(l,d){return window.document.createElementNS(l,d)}static disableDrag(){x.docStyle&&x.selectProp&&(x.userSelect=x.docStyle[x.selectProp],x.docStyle[x.selectProp]="none")}static enableDrag(){x.docStyle&&x.selectProp&&(x.docStyle[x.selectProp]=x.userSelect)}static setTransform(l,d){l.style[x.transformProp]=d}static addEventListener(l,d,y){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};l.addEventListener(d,y,"passive"in _?_:_.capture)}static removeEventListener(l,d,y){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};l.removeEventListener(d,y,"passive"in _?_:_.capture)}static suppressClickInternal(l){l.preventDefault(),l.stopPropagation(),window.removeEventListener("click",x.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",x.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",x.suppressClickInternal,!0)},0)}static getScale(l){const d=l.getBoundingClientRect();return{x:d.width/l.offsetWidth||1,y:d.height/l.offsetHeight||1,boundingClientRect:d}}static getPoint(l,d,y){const _=d.boundingClientRect;return new o.P((y.clientX-_.left)/d.x-l.clientLeft,(y.clientY-_.top)/d.y-l.clientTop)}static mousePos(l,d){const y=x.getScale(l);return x.getPoint(l,y,d)}static touchPos(l,d){const y=[],_=x.getScale(l);for(let E=0;E<d.length;E++)y.push(x.getPoint(l,_,d[E]));return y}static mouseButton(l){return l.button}static remove(l){l.parentNode&&l.parentNode.removeChild(l)}}x.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,x.selectProp=x.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),x.transformProp=x.testProp(["transform","WebkitTransform"]);const C={supported:!1,testSupport:function(B){!N&&U&&(Q?q(B):M=B)}};let M,U,N=!1,Q=!1;function q(B){const l=B.createTexture();B.bindTexture(B.TEXTURE_2D,l);try{if(B.texImage2D(B.TEXTURE_2D,0,B.RGBA,B.RGBA,B.UNSIGNED_BYTE,U),B.isContextLost())return;C.supported=!0}catch{}B.deleteTexture(l),N=!0}var Y;typeof document<"u"&&(U=document.createElement("img"),U.onload=function(){M&&q(M),M=null,Q=!0},U.onerror=function(){N=!0,M=null},U.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(B){let l,d,y,_;B.resetRequestQueue=()=>{l=[],d=0,y=0,_={}},B.addThrottleControl=g=>{const w=y++;return _[w]=g,w},B.removeThrottleControl=g=>{delete _[g],P()},B.getImage=function(g,w){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return new Promise((L,D)=>{C.supported&&(g.headers||(g.headers={}),g.headers.accept="image/webp,*/*"),o.e(g,{type:"image"}),l.push({abortController:w,requestParameters:g,supportImageRefresh:T,state:"queued",onError:H=>{D(H)},onSuccess:H=>{L(H)}}),P()})};const E=g=>o._(this,void 0,void 0,function*(){g.state="running";const{requestParameters:w,supportImageRefresh:T,onError:L,onSuccess:D,abortController:H}=g,z=T===!1&&!o.i(self)&&!o.g(w.url)&&(!w.headers||Object.keys(w.headers).reduce(($,lt)=>$&&lt==="accept",!0));d++;const j=z?R(w,H):o.m(w,H);try{const $=yield j;delete g.abortController,g.state="completed",$.data instanceof HTMLImageElement||o.b($.data)?D($):$.data&&D({data:yield(V=$.data,typeof createImageBitmap=="function"?o.d(V):o.f(V)),cacheControl:$.cacheControl,expires:$.expires})}catch($){delete g.abortController,L($)}finally{d--,P()}var V}),P=()=>{const g=(()=>{for(const w of Object.keys(_))if(_[w]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let w=d;w<g&&l.length>0;w++){const T=l.shift();T.abortController.signal.aborted?w--:E(T)}},R=(g,w)=>new Promise((T,L)=>{const D=new Image,H=g.url,z=g.credentials;z&&z==="include"?D.crossOrigin="use-credentials":(z&&z==="same-origin"||!o.s(H))&&(D.crossOrigin="anonymous"),w.signal.addEventListener("abort",()=>{D.src="",L(o.c())}),D.fetchPriority="high",D.onload=()=>{D.onerror=D.onload=null,T({data:D})},D.onerror=()=>{D.onerror=D.onload=null,w.signal.aborted||L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},D.src=H})}(Y||(Y={})),Y.resetRequestQueue();class tt{constructor(l){this._transformRequestFn=l}transformRequest(l,d){return this._transformRequestFn&&this._transformRequestFn(l,d)||{url:l}}normalizeSpriteURL(l,d,y){const _=function(E){const P=E.match(ft);if(!P)throw new Error(`Unable to parse URL "${E}"`);return{protocol:P[1],authority:P[2],path:P[3]||"/",params:P[4]?P[4].split("&"):[]}}(l);return _.path+=`${d}${y}`,function(E){const P=E.params.length?`?${E.params.join("&")}`:"";return`${E.protocol}://${E.authority}${E.path}${P}`}(_)}setTransformRequest(l){this._transformRequestFn=l}}const ft=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function pt(B){var l=new o.A(3);return l[0]=B[0],l[1]=B[1],l[2]=B[2],l}var mt,dt=function(B,l,d){return B[0]=l[0]-d[0],B[1]=l[1]-d[1],B[2]=l[2]-d[2],B};mt=new o.A(3),o.A!=Float32Array&&(mt[0]=0,mt[1]=0,mt[2]=0);var Rt=function(B){var l=B[0],d=B[1];return l*l+d*d};function Lt(B){const l=[];if(typeof B=="string")l.push({id:"default",url:B});else if(B&&B.length>0){const d=[];for(const{id:y,url:_}of B){const E=`${y}${_}`;d.indexOf(E)===-1&&(d.push(E),l.push({id:y,url:_}))}}return l}(function(){var B=new o.A(2);o.A!=Float32Array&&(B[0]=0,B[1]=0)})();class st{constructor(l,d,y,_){this.context=l,this.format=y,this.texture=l.gl.createTexture(),this.update(d,_)}update(l,d,y){const{width:_,height:E}=l,P=!(this.size&&this.size[0]===_&&this.size[1]===E||y),{context:R}=this,{gl:g}=R;if(this.useMipmap=!!(d&&d.useMipmap),g.bindTexture(g.TEXTURE_2D,this.texture),R.pixelStoreUnpackFlipY.set(!1),R.pixelStoreUnpack.set(1),R.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA&&(!d||d.premultiply!==!1)),P)this.size=[_,E],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||o.b(l)?g.texImage2D(g.TEXTURE_2D,0,this.format,this.format,g.UNSIGNED_BYTE,l):g.texImage2D(g.TEXTURE_2D,0,this.format,_,E,0,this.format,g.UNSIGNED_BYTE,l.data);else{const{x:w,y:T}=y||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||o.b(l)?g.texSubImage2D(g.TEXTURE_2D,0,w,T,g.RGBA,g.UNSIGNED_BYTE,l):g.texSubImage2D(g.TEXTURE_2D,0,w,T,_,E,g.RGBA,g.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&g.generateMipmap(g.TEXTURE_2D)}bind(l,d,y){const{context:_}=this,{gl:E}=_;E.bindTexture(E.TEXTURE_2D,this.texture),y!==E.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(y=E.LINEAR),l!==this.filter&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,l),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,y||l),this.filter=l),d!==this.wrap&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,d),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}function ct(B){const{userImage:l}=B;return!!(l&&l.render&&l.render())&&(B.data.replace(new Uint8Array(l.data.buffer)),!0)}class wt extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:d,promiseResolve:y}of this.requestors)y(this._getImagesForIds(d));this.requestors=[]}}getImage(l){const d=this.images[l];if(d&&!d.data&&d.spriteData){const y=d.spriteData;d.data=new o.R({width:y.width,height:y.height},y.context.getImageData(y.x,y.y,y.width,y.height).data),d.spriteData=null}return d}addImage(l,d){if(this.images[l])throw new Error(`Image id ${l} already exist, use updateImage instead`);this._validate(l,d)&&(this.images[l]=d)}_validate(l,d){let y=!0;const _=d.data||d.spriteData;return this._validateStretch(d.stretchX,_&&_.width)||(this.fire(new o.j(new Error(`Image "${l}" has invalid "stretchX" value`))),y=!1),this._validateStretch(d.stretchY,_&&_.height)||(this.fire(new o.j(new Error(`Image "${l}" has invalid "stretchY" value`))),y=!1),this._validateContent(d.content,d)||(this.fire(new o.j(new Error(`Image "${l}" has invalid "content" value`))),y=!1),y}_validateStretch(l,d){if(!l)return!0;let y=0;for(const _ of l){if(_[0]<y||_[1]<_[0]||d<_[1])return!1;y=_[1]}return!0}_validateContent(l,d){if(!l)return!0;if(l.length!==4)return!1;const y=d.spriteData,_=y&&y.width||d.data.width,E=y&&y.height||d.data.height;return!(l[0]<0||_<l[0]||l[1]<0||E<l[1]||l[2]<0||_<l[2]||l[3]<0||E<l[3]||l[2]<l[0]||l[3]<l[1])}updateImage(l,d){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const _=this.getImage(l);if(y&&(_.data.width!==d.data.width||_.data.height!==d.data.height))throw new Error(`size mismatch between old image (${_.data.width}x${_.data.height}) and new image (${d.data.width}x${d.data.height}).`);d.version=_.version+1,this.images[l]=d,this.updatedImages[l]=!0}removeImage(l){const d=this.images[l];delete this.images[l],delete this.patterns[l],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l){return new Promise((d,y)=>{let _=!0;if(!this.isLoaded())for(const E of l)this.images[E]||(_=!1);this.isLoaded()||_?d(this._getImagesForIds(l)):this.requestors.push({ids:l,promiseResolve:d})})}_getImagesForIds(l){const d={};for(const y of l){let _=this.getImage(y);_||(this.fire(new o.k("styleimagemissing",{id:y})),_=this.getImage(y)),_?d[y]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,hasRenderCallback:!!(_.userImage&&_.userImage.render)}:o.w(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return d}getPixelSize(){const{width:l,height:d}=this.atlasImage;return{width:l,height:d}}getPattern(l){const d=this.patterns[l],y=this.getImage(l);if(!y)return null;if(d&&d.position.version===y.version)return d.position;if(d)d.position.version=y.version;else{const _={w:y.data.width+2,h:y.data.height+2,x:0,y:0},E=new o.I(_,y);this.patterns[l]={bin:_,position:E}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const d=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new st(l,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const E in this.patterns)l.push(this.patterns[E].bin);const{w:d,h:y}=o.p(l),_=this.atlasImage;_.resize({width:d||1,height:y||1});for(const E in this.patterns){const{bin:P}=this.patterns[E],R=P.x+1,g=P.y+1,w=this.getImage(E).data,T=w.width,L=w.height;o.R.copy(w,_,{x:0,y:0},{x:R,y:g},{width:T,height:L}),o.R.copy(w,_,{x:0,y:L-1},{x:R,y:g-1},{width:T,height:1}),o.R.copy(w,_,{x:0,y:0},{x:R,y:g+L},{width:T,height:1}),o.R.copy(w,_,{x:T-1,y:0},{x:R-1,y:g},{width:1,height:L}),o.R.copy(w,_,{x:0,y:0},{x:R+T,y:g},{width:1,height:L})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const d of l){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const y=this.getImage(d);y||o.w(`Image with ID: "${d}" was not found`),ct(y)&&this.updateImage(d,y)}}}const yt=1e20;function te(B,l,d,y,_,E,P,R,g){for(let w=l;w<l+y;w++)Zt(B,d*E+w,E,_,P,R,g);for(let w=d;w<d+_;w++)Zt(B,w*E+l,1,y,P,R,g)}function Zt(B,l,d,y,_,E,P){E[0]=0,P[0]=-yt,P[1]=yt,_[0]=B[l];for(let R=1,g=0,w=0;R<y;R++){_[R]=B[l+R*d];const T=R*R;do{const L=E[g];w=(_[R]-_[L]+T-L*L)/(R-L)/2}while(w<=P[g]&&--g>-1);g++,E[g]=R,P[g]=w,P[g+1]=yt}for(let R=0,g=0;R<y;R++){for(;P[g+1]<R;)g++;const w=E[g],T=R-w;B[l+R*d]=_[w]+T*T}}class re{constructor(l,d){this.requestManager=l,this.localIdeographFontFamily=d,this.entries={}}setURL(l){this.url=l}getGlyphs(l){return o._(this,void 0,void 0,function*(){const d=[];for(const E in l)for(const P of l[E])d.push(this._getAndCacheGlyphsPromise(E,P));const y=yield Promise.all(d),_={};for(const{stack:E,id:P,glyph:R}of y)_[E]||(_[E]={}),_[E][P]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics};return _})}_getAndCacheGlyphsPromise(l,d){return o._(this,void 0,void 0,function*(){let y=this.entries[l];y||(y=this.entries[l]={glyphs:{},requests:{},ranges:{}});let _=y.glyphs[d];if(_!==void 0)return{stack:l,id:d,glyph:_};if(_=this._tinySDF(y,l,d),_)return y.glyphs[d]=_,{stack:l,id:d,glyph:_};const E=Math.floor(d/256);if(256*E>65535)throw new Error("glyphs > 65535 not supported");if(y.ranges[E])return{stack:l,id:d,glyph:_};if(!this.url)throw new Error("glyphsUrl is not set");if(!y.requests[E]){const R=re.loadGlyphRange(l,E,this.url,this.requestManager);y.requests[E]=R}const P=yield y.requests[E];for(const R in P)this._doesCharSupportLocalGlyph(+R)||(y.glyphs[+R]=P[+R]);return y.ranges[E]=!0,{stack:l,id:d,glyph:P[d]||null}})}_doesCharSupportLocalGlyph(l){return!!this.localIdeographFontFamily&&(o.u["CJK Unified Ideographs"](l)||o.u["Hangul Syllables"](l)||o.u.Hiragana(l)||o.u.Katakana(l))}_tinySDF(l,d,y){const _=this.localIdeographFontFamily;if(!_||!this._doesCharSupportLocalGlyph(y))return;let E=l.tinySDF;if(!E){let R="400";/bold/i.test(d)?R="900":/medium/i.test(d)?R="500":/light/i.test(d)&&(R="200"),E=l.tinySDF=new re.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:_,fontWeight:R})}const P=E.draw(String.fromCharCode(y));return{id:y,bitmap:new o.o({width:P.width||60,height:P.height||60},P.data),metrics:{width:P.glyphWidth/2||24,height:P.glyphHeight/2||24,left:P.glyphLeft/2+.5||0,top:P.glyphTop/2-27.5||-8,advance:P.glyphAdvance/2||24,isDoubleResolution:!0}}}}re.loadGlyphRange=function(B,l,d,y){return o._(this,void 0,void 0,function*(){const _=256*l,E=_+255,P=y.transformRequest(d.replace("{fontstack}",B).replace("{range}",`${_}-${E}`),"Glyphs"),R=yield o.l(P,new AbortController);if(!R||!R.data)throw new Error(`Could not load glyph range. range: ${l}, ${_}-${E}`);const g={};for(const w of o.n(R.data))g[w.id]=w;return g})},re.TinySDF=class{constructor(){let{fontSize:B=24,buffer:l=3,radius:d=8,cutoff:y=.25,fontFamily:_="sans-serif",fontWeight:E="normal",fontStyle:P="normal"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.buffer=l,this.cutoff=y,this.radius=d;const R=this.size=B+4*l,g=this._createCanvas(R),w=this.ctx=g.getContext("2d",{willReadFrequently:!0});w.font=`${P} ${E} ${B}px ${_}`,w.textBaseline="alphabetic",w.textAlign="left",w.fillStyle="black",this.gridOuter=new Float64Array(R*R),this.gridInner=new Float64Array(R*R),this.f=new Float64Array(R),this.z=new Float64Array(R+1),this.v=new Uint16Array(R)}_createCanvas(B){const l=document.createElement("canvas");return l.width=l.height=B,l}draw(B){const{width:l,actualBoundingBoxAscent:d,actualBoundingBoxDescent:y,actualBoundingBoxLeft:_,actualBoundingBoxRight:E}=this.ctx.measureText(B),P=Math.ceil(d),R=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(E-_))),g=Math.min(this.size-this.buffer,P+Math.ceil(y)),w=R+2*this.buffer,T=g+2*this.buffer,L=Math.max(w*T,0),D=new Uint8ClampedArray(L),H={data:D,width:w,height:T,glyphWidth:R,glyphHeight:g,glyphTop:P,glyphLeft:0,glyphAdvance:l};if(R===0||g===0)return H;const{ctx:z,buffer:j,gridInner:V,gridOuter:$}=this;z.clearRect(j,j,R,g),z.fillText(B,j,j+P);const lt=z.getImageData(j,j,R,g);$.fill(yt,0,L),V.fill(0,0,L);for(let rt=0;rt<g;rt++)for(let ht=0;ht<R;ht++){const gt=lt.data[4*(rt*R+ht)+3]/255;if(gt===0)continue;const Pt=(rt+j)*w+ht+j;if(gt===1)$[Pt]=0,V[Pt]=yt;else{const Tt=.5-gt;$[Pt]=Tt>0?Tt*Tt:0,V[Pt]=Tt<0?Tt*Tt:0}}te($,0,0,w,T,w,this.f,this.v,this.z),te(V,j,j,R,g,w,this.f,this.v,this.z);for(let rt=0;rt<L;rt++){const ht=Math.sqrt($[rt])-Math.sqrt(V[rt]);D[rt]=Math.round(255-255*(ht/this.radius+this.cutoff))}return H}};class Xt{constructor(){this.specification=o.v.light.position}possiblyEvaluate(l,d){return o.y(l.expression.evaluate(d))}interpolate(l,d,y){return{x:o.z.number(l.x,d.x,y),y:o.z.number(l.y,d.y,y),z:o.z.number(l.z,d.z,y)}}}let ne;class se extends o.E{constructor(l){super(),ne=ne||new o.q({anchor:new o.D(o.v.light.anchor),position:new Xt,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.T(ne),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this._validate(o.r,l,d))for(const y in l){const _=l[y];y.endsWith("-transition")?this._transitionable.setTransition(y.slice(0,-11),_):this._transitionable.setValue(y,_)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,d,y){return(!y||y.validate!==!1)&&o.t(this,l.call(o.x,{value:d,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}class we{constructor(l,d){this.width=l,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(l,d){const y=l.join(",")+String(d);return this.dashEntry[y]||(this.dashEntry[y]=this.addDash(l,d)),this.dashEntry[y]}getDashRanges(l,d,y){const _=[];let E=l.length%2==1?-l[l.length-1]*y:0,P=l[0]*y,R=!0;_.push({left:E,right:P,isDash:R,zeroLength:l[0]===0});let g=l[0];for(let w=1;w<l.length;w++){R=!R;const T=l[w];E=g*y,g+=T,P=g*y,_.push({left:E,right:P,isDash:R,zeroLength:T===0})}return _}addRoundDash(l,d,y){const _=d/2;for(let E=-y;E<=y;E++){const P=this.width*(this.nextRow+y+E);let R=0,g=l[R];for(let w=0;w<this.width;w++){w/g.right>1&&(g=l[++R]);const T=Math.abs(w-g.left),L=Math.abs(w-g.right),D=Math.min(T,L);let H;const z=E/y*(_+1);if(g.isDash){const j=_-Math.abs(z);H=Math.sqrt(D*D+j*j)}else H=_-Math.sqrt(D*D+z*z);this.data[P+w]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(l){for(let R=l.length-1;R>=0;--R){const g=l[R],w=l[R+1];g.zeroLength?l.splice(R,1):w&&w.isDash===g.isDash&&(w.left=g.left,l.splice(R,1))}const d=l[0],y=l[l.length-1];d.isDash===y.isDash&&(d.left=y.left-this.width,y.right=d.right+this.width);const _=this.width*this.nextRow;let E=0,P=l[E];for(let R=0;R<this.width;R++){R/P.right>1&&(P=l[++E]);const g=Math.abs(R-P.left),w=Math.abs(R-P.right),T=Math.min(g,w);this.data[_+R]=Math.max(0,Math.min(255,(P.isDash?T:-T)+128))}}addDash(l,d){const y=d?7:0,_=2*y+1;if(this.nextRow+_>this.height)return o.w("LineAtlas out of space"),null;let E=0;for(let R=0;R<l.length;R++)E+=l[R];if(E!==0){const R=this.width/E,g=this.getDashRanges(l,this.width,R);d?this.addRoundDash(g,R,y):this.addRegularDash(g)}const P={y:(this.nextRow+y+.5)/this.height,height:2*y/this.height,width:E};return this.nextRow+=_,this.dirty=!0,P}bind(l){const d=l.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}const it="maplibre_preloaded_worker_pool";class vt{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<vt.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[it]}numActive(){return Object.keys(this.active).length}}const Ft=Math.floor(b.hardwareConcurrency/2);let Ot,Wt;function jt(){return Ot||(Ot=new vt),Ot}vt.workerCount=o.B(globalThis)?Math.max(Math.min(Ft,3),1):1;class ae{constructor(l,d){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=d;const y=this.workerPool.acquire(d);for(let _=0;_<y.length;_++){const E=new o.C(y[_],d);E.name=`Worker ${_}`,this.actors.push(E)}if(!this.actors.length)throw new Error("No actors found")}broadcast(l,d){const y=[];for(const _ of this.actors)y.push(_.sendAsync({type:l,data:d}));return Promise.all(y)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.actors.forEach(d=>{d.remove()}),this.actors=[],l&&this.workerPool.release(this.id)}registerMessageHandler(l,d){for(const y of this.actors)y.registerMessageHandler(l,d)}}function ie(){return Wt||(Wt=new ae(jt(),o.G),Wt.registerMessageHandler("GR",(B,l,d)=>o.m(l,d))),Wt}function Be(B,l){const d=o.F();return o.H(d,d,[1,1,0]),o.J(d,d,[.5*B.width,.5*B.height,1]),o.K(d,d,B.calculatePosMatrix(l.toUnwrapped()))}function Te(B,l,d,y,_,E){const P=function(L,D,H){if(L)for(const z of L){const j=D[z];if(j&&j.source===H&&j.type==="fill-extrusion")return!0}else for(const z in D){const j=D[z];if(j.source===H&&j.type==="fill-extrusion")return!0}return!1}(_&&_.layers,l,B.id),R=E.maxPitchScaleFactor(),g=B.tilesIn(y,R,P);g.sort(Ne);const w=[];for(const L of g)w.push({wrappedTileID:L.tileID.wrapped().key,queryResults:L.tile.queryRenderedFeatures(l,d,B._state,L.queryGeometry,L.cameraQueryGeometry,L.scale,_,E,R,Be(B.transform,L.tileID))});const T=function(L){const D={},H={};for(const z of L){const j=z.queryResults,V=z.wrappedTileID,$=H[V]=H[V]||{};for(const lt in j){const rt=j[lt],ht=$[lt]=$[lt]||{},gt=D[lt]=D[lt]||[];for(const Pt of rt)ht[Pt.featureIndex]||(ht[Pt.featureIndex]=!0,gt.push(Pt))}}return D}(w);for(const L in T)T[L].forEach(D=>{const H=D.feature,z=B.getFeatureState(H.layer["source-layer"],H.id);H.source=H.layer.source,H.layer["source-layer"]&&(H.sourceLayer=H.layer["source-layer"]),H.state=z});return T}function Ne(B,l){const d=B.tileID,y=l.tileID;return d.overscaledZ-y.overscaledZ||d.canonical.y-y.canonical.y||d.wrap-y.wrap||d.canonical.x-y.canonical.x}function Qe(B,l,d){return o._(this,void 0,void 0,function*(){let y=B;if(B.url?y=(yield o.h(l.transformRequest(B.url,"Source"),d)).data:yield b.frameAsync(d),!y)return null;const _=o.L(o.e(y,B),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in y&&y.vector_layers&&(_.vectorLayerIds=y.vector_layers.map(E=>E.id)),_})}class He{constructor(l,d){l&&(d?this.setSouthWest(l).setNorthEast(d):Array.isArray(l)&&(l.length===4?this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]]):this.setSouthWest(l[0]).setNorthEast(l[1])))}setNorthEast(l){return this._ne=l instanceof o.M?new o.M(l.lng,l.lat):o.M.convert(l),this}setSouthWest(l){return this._sw=l instanceof o.M?new o.M(l.lng,l.lat):o.M.convert(l),this}extend(l){const d=this._sw,y=this._ne;let _,E;if(l instanceof o.M)_=l,E=l;else{if(!(l instanceof He))return Array.isArray(l)?l.length===4||l.every(Array.isArray)?this.extend(He.convert(l)):this.extend(o.M.convert(l)):l&&("lng"in l||"lon"in l)&&"lat"in l?this.extend(o.M.convert(l)):this;if(_=l._sw,E=l._ne,!_||!E)return this}return d||y?(d.lng=Math.min(_.lng,d.lng),d.lat=Math.min(_.lat,d.lat),y.lng=Math.max(E.lng,y.lng),y.lat=Math.max(E.lat,y.lat)):(this._sw=new o.M(_.lng,_.lat),this._ne=new o.M(E.lng,E.lat)),this}getCenter(){return new o.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.M(this.getWest(),this.getNorth())}getSouthEast(){return new o.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(l){const{lng:d,lat:y}=o.M.convert(l);let _=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=y&&y<=this._ne.lat&&_}static convert(l){return l instanceof He?l:l&&new He(l)}static fromLngLat(l){const y=360*(arguments.length>1&&arguments[1]!==void 0?arguments[1]:0)/40075017,_=y/Math.cos(Math.PI/180*l.lat);return new He(new o.M(l.lng-_,l.lat-y),new o.M(l.lng+_,l.lat+y))}}class ge{constructor(l,d,y){this.bounds=He.convert(this.validateBounds(l)),this.minzoom=d||0,this.maxzoom=y||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const d=Math.pow(2,l.z),y=Math.floor(o.N(this.bounds.getWest())*d),_=Math.floor(o.O(this.bounds.getNorth())*d),E=Math.ceil(o.N(this.bounds.getEast())*d),P=Math.ceil(o.O(this.bounds.getSouth())*d);return l.x>=y&&l.x<E&&l.y>=_&&l.y<P}}class Ut extends o.E{constructor(l,d,y,_){if(super(),this.id=l,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.L(d,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield Qe(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),l&&(o.e(this,l),l.bounds&&(this.tileBounds=new ge(l.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(l){this._tileJSONRequest=null,this.fire(new o.j(l))}})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.abort(),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(l){return o._(this,void 0,void 0,function*(){const d=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),y={request:this.map._requestManager.transformRequest(d,"Tile"),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};y.request.collectResourceTiming=this._collectResourceTiming;let _="RT";if(l.actor&&l.state!=="expired"){if(l.state==="loading")return new Promise((E,P)=>{l.reloadPromise={resolve:E,reject:P}})}else l.actor=this.dispatcher.getActor(),_="LT";l.abortController=new AbortController;try{const E=yield l.actor.sendAsync({type:_,data:y},l.abortController);if(delete l.abortController,l.aborted)return;this._afterTileLoadWorkerResponse(l,E)}catch(E){if(delete l.abortController,l.aborted)return;if(E&&E.status!==404)throw E;this._afterTileLoadWorkerResponse(l,null)}})}_afterTileLoadWorkerResponse(l,d){if(d&&d.resourceTiming&&(l.resourceTiming=d.resourceTiming),d&&this.map._refreshExpiredTiles&&l.setExpiryData(d),l.loadVectorData(d,this.map.painter),l.reloadPromise){const y=l.reloadPromise;l.reloadPromise=null,this.loadTile(l).then(y.resolve).catch(y.reject)}}abortTile(l){return o._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.actor&&(yield l.actor.sendAsync({type:"AT",data:{uid:l.uid,type:this.type,source:this.id}}))})}unloadTile(l){return o._(this,void 0,void 0,function*(){l.unloadVectorData(),l.actor&&(yield l.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Yt extends o.E{constructor(l,d,y,_){super(),this.id=l,this.dispatcher=y,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},d),o.e(this,o.L(d,["url","scheme","tileSize"]))}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield Qe(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,l&&(o.e(this,l),l.bounds&&(this.tileBounds=new ge(l.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(l){this._tileJSONRequest=null,this.fire(new o.j(l))}})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(l){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}serialize(){return o.e({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l){return o._(this,void 0,void 0,function*(){const d=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);l.abortController=new AbortController;try{const y=yield Y.getImage(this.map._requestManager.transformRequest(d,"Tile"),l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(y&&y.data){this.map._refreshExpiredTiles&&y.cacheControl&&y.expires&&l.setExpiryData({cacheControl:y.cacheControl,expires:y.expires});const _=this.map.painter.context,E=_.gl,P=y.data;l.texture=this.map.painter.getTileTexture(P.width),l.texture?l.texture.update(P,{useMipmap:!0}):(l.texture=new st(_,P,E.RGBA,{useMipmap:!0}),l.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),_.extTextureFilterAnisotropic&&E.texParameterf(E.TEXTURE_2D,_.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,_.extTextureFilterAnisotropicMax)),l.state="loaded"}}catch(y){if(delete l.abortController,l.aborted)l.state="unloaded";else if(y)throw l.state="errored",y}})}abortTile(l){return o._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController)})}unloadTile(l){return o._(this,void 0,void 0,function*(){l.texture&&this.map.painter.saveTileTexture(l.texture)})}hasTransition(){return!1}}class tr extends Yt{constructor(l,d,y,_){super(l,d,y,_),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox",this.redFactor=d.redFactor,this.greenFactor=d.greenFactor,this.blueFactor=d.blueFactor,this.baseShift=d.baseShift}loadTile(l){return o._(this,void 0,void 0,function*(){const d=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),y=this.map._requestManager.transformRequest(d,"Tile");l.neighboringTiles=this._getNeighboringTiles(l.tileID),l.abortController=new AbortController;try{const _=yield Y.getImage(y,l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(_&&_.data){const E=_.data;this.map._refreshExpiredTiles&&_.cacheControl&&_.expires&&l.setExpiryData({cacheControl:_.cacheControl,expires:_.expires});const P=o.b(E)&&o.S()?E:yield this.readImageNow(E),R={type:this.type,uid:l.uid,source:this.id,rawImageData:P,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!l.actor||l.state==="expired"){l.actor=this.dispatcher.getActor();const g=yield l.actor.sendAsync({type:"LDT",data:R});l.dem=g,l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0,l.state="loaded"}}}catch(_){if(delete l.abortController,l.aborted)l.state="unloaded";else if(_)throw l.state="errored",_}})}readImageNow(l){return o._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&o.U()){const d=l.width+2,y=l.height+2;try{return new o.R({width:d,height:y},yield o.V(l,-1,-1,d,y))}catch{}}return b.getImageData(l,1)})}_getNeighboringTiles(l){const d=l.canonical,y=Math.pow(2,d.z),_=(d.x-1+y)%y,E=d.x===0?l.wrap-1:l.wrap,P=(d.x+1+y)%y,R=d.x+1===y?l.wrap+1:l.wrap,g={};return g[new o.Q(l.overscaledZ,E,d.z,_,d.y).key]={backfilled:!1},g[new o.Q(l.overscaledZ,R,d.z,P,d.y).key]={backfilled:!1},d.y>0&&(g[new o.Q(l.overscaledZ,E,d.z,_,d.y-1).key]={backfilled:!1},g[new o.Q(l.overscaledZ,l.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},g[new o.Q(l.overscaledZ,R,d.z,P,d.y-1).key]={backfilled:!1}),d.y+1<y&&(g[new o.Q(l.overscaledZ,E,d.z,_,d.y+1).key]={backfilled:!1},g[new o.Q(l.overscaledZ,l.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},g[new o.Q(l.overscaledZ,R,d.z,P,d.y+1).key]={backfilled:!1}),g}unloadTile(l){return o._(this,void 0,void 0,function*(){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&(yield l.actor.sendAsync({type:"RDT",data:{type:this.type,uid:l.uid,source:this.id}}))})}}class Ee extends o.E{constructor(l,d,y,_){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=y.getActor(),this.setEventedParent(_),this._data=d.data,this._options=o.e({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const E=o.W/this.tileSize;this.workerOptions=o.e({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*E,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*E,extent:o.W,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:o.W,radius:(d.clusterRadius||50)*E,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return o._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(l){this.map=l,this.load()}setData(l){return this._data=l,this._updateWorkerData(),this}updateData(l){return this._updateWorkerData(l),this}setClusterOptions(l){return this.workerOptions.cluster=l.cluster,l&&(l.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=l.clusterRadius),l.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=l.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(l){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:l,source:this.id}})}getClusterChildren(l){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:l,source:this.id}})}getClusterLeaves(l,d,y){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:l,limit:d,offset:y}})}_updateWorkerData(l){return o._(this,void 0,void 0,function*(){const d=o.e({type:this.type},this.workerOptions);l?d.dataDiff=l:typeof this._data=="string"?(d.request=this.map._requestManager.transformRequest(b.resolveURL(this._data),"Source"),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new o.k("dataloading",{dataType:"source"}));try{const y=yield this.actor.sendAsync({type:"LD",data:d});if(this._pendingLoads--,this._removed||y.abandoned)return void this.fire(new o.k("dataabort",{dataType:"source"}));let _=null;y.resourceTiming&&y.resourceTiming[this.id]&&(_=y.resourceTiming[this.id].slice(0));const E={dataType:"source"};this._collectResourceTiming&&_&&_.length>0&&o.e(E,{resourceTiming:_}),this.fire(new o.k("data",Object.assign(Object.assign({},E),{sourceDataType:"metadata"}))),this.fire(new o.k("data",Object.assign(Object.assign({},E),{sourceDataType:"content"})))}catch(y){if(this._pendingLoads--,this._removed)return void this.fire(new o.k("dataabort",{dataType:"source"}));this.fire(new o.j(y))}})}loaded(){return this._pendingLoads===0}loadTile(l){return o._(this,void 0,void 0,function*(){const d=l.actor?"RT":"LT";l.actor=this.actor;const y={type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};l.abortController=new AbortController;const _=yield this.actor.sendAsync({type:d,data:y},l.abortController);delete l.abortController,l.unloadVectorData(),l.aborted||l.loadVectorData(_,this.map.painter,d==="RT")})}abortTile(l){return o._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.aborted=!0})}unloadTile(l){return o._(this,void 0,void 0,function*(){l.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var _e=o.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class xe extends o.E{constructor(l,d,y,_){super(),this.id=l,this.dispatcher=y,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=d}load(l){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const d=yield Y.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,d&&d.data&&(this.image=d.data,l&&(this.coordinates=l),this._finishLoading())}catch(d){this._request=null,this._loaded=!0,this.fire(new o.j(d))}})}loaded(){return this._loaded}updateImage(l){return l.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=l.url,this.load(l.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(l){this.coordinates=l;const d=l.map(o.Y.fromLngLat);this.tileID=function(_){let E=1/0,P=1/0,R=-1/0,g=-1/0;for(const D of _)E=Math.min(E,D.x),P=Math.min(P,D.y),R=Math.max(R,D.x),g=Math.max(g,D.y);const w=Math.max(R-E,g-P),T=Math.max(0,Math.floor(-Math.log(w)/Math.LN2)),L=Math.pow(2,T);return new o.a0(T,Math.floor((E+R)/2*L),Math.floor((P+g)/2*L))}(d),this.minzoom=this.maxzoom=this.tileID.z;const y=d.map(_=>this.tileID.getTilePoint(_)._round());return this._boundsArray=new o.Z,this._boundsArray.emplaceBack(y[0].x,y[0].y,0,0),this._boundsArray.emplaceBack(y[1].x,y[1].y,o.W,0),this._boundsArray.emplaceBack(y[3].x,y[3].y,0,o.W),this._boundsArray.emplaceBack(y[2].x,y[2].y,o.W,o.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const l=this.map.painter.context,d=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,_e.members)),this.boundsSegments||(this.boundsSegments=o.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new st(l,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let y=!1;for(const _ in this.tiles){const E=this.tiles[_];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,y=!0)}y&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(l){return o._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={}):l.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class De extends xe{constructor(l,d,y,_){super(l,d,y,_),this.roundZoom=!0,this.type="video",this.options=d}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1;const l=this.options;this.urls=[];for(const d of l.urls)this.urls.push(this.map._requestManager.transformRequest(d,"Source").url);try{const d=yield o.a2(this.urls);if(this._loaded=!0,!d)return;this.video=d,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(d){this.fire(new o.j(d))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const d=this.video.seekable;l<d.start(0)||l>d.end(0)?this.fire(new o.j(new o.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const l=this.map.painter.context,d=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,_e.members)),this.boundsSegments||(this.boundsSegments=o.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new st(l,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let y=!1;for(const _ in this.tiles){const E=this.tiles[_];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,y=!0)}y&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class nr extends xe{constructor(l,d,y,_){super(l,d,y,_),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(E=>!Array.isArray(E)||E.length!==2||E.some(P=>typeof P!="number"))||this.fire(new o.j(new o.a1(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.j(new o.a1(`sources.${l}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new o.j(new o.a1(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof HTMLCanvasElement||this.fire(new o.j(new o.a1(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.j(new o.a1(`sources.${l}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}load(){return o._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const d=this.map.painter.context,y=d.gl;this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,_e.members)),this.boundsSegments||(this.boundsSegments=o.$.simpleSegment(0,0,4,2)),this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new st(d,this.canvas,y.RGBA,{premultiply:!0});let _=!1;for(const E in this.tiles){const P=this.tiles[E];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture,_=!0)}_&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}}const ur={},Ir=B=>{switch(B){case"geojson":return Ee;case"image":return xe;case"raster":return Yt;case"raster-dem":return tr;case"vector":return Ut;case"video":return De;case"canvas":return nr}return ur[B]},Sr="RTLPluginLoaded";class Dr extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=ie()}_syncState(l){return this.status=l,this.dispatcher.broadcast("SRPS",{pluginStatus:l,pluginURL:this.url}).catch(d=>{throw this.status="error",d})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(l){return o._(this,arguments,void 0,function(d){var y=this;let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(y.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(y.url=b.resolveURL(d),!y.url)throw new Error(`requested url ${d} is invalid`);if(y.status==="unavailable"){if(!_)return y._requestImport();y.status="deferred",y._syncState(y.status)}else if(y.status==="requested")return y._requestImport()}()})}_requestImport(){return o._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.k(Sr))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Nr=null;function fe(){return Nr||(Nr=new Dr),Nr}class Tr{constructor(l,d){this.timeAdded=0,this.fadeEndTime=0,this.tileID=l,this.uid=o.a3(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(l){const d=l+this.timeAdded;d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(l){this.demTexture&&l.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(l,d,y){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(_,E){const P={};if(!E)return P;for(const R of _){const g=R.layerIds.map(w=>E.getLayer(w)).filter(Boolean);if(g.length!==0){R.layers=g,R.stateDependentLayerIds&&(R.stateDependentLayers=R.stateDependentLayerIds.map(w=>g.filter(T=>T.id===w)[0]));for(const w of g)P[w.id]=R}}return P}(l.buckets,d.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const E=this.buckets[_];if(E instanceof o.a5){if(this.hasSymbolBuckets=!0,!y)break;E.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const E=this.buckets[_];if(E instanceof o.a5&&E.hasRTLText){this.hasRTLText=!0,fe().lazyLoad();break}}this.queryPadding=0;for(const _ in this.buckets){const E=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(_).queryRadius(E))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage)}else this.collisionBoxArray=new o.a4}unloadVectorData(){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(l){return this.buckets[l.id]}upload(l){for(const y in this.buckets){const _=this.buckets[y];_.uploadPending()&&_.upload(l)}const d=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new st(l,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new st(l,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,d,y,_,E,P,R,g,w,T){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:E,scale:P,tileSize:this.tileSize,pixelPosMatrix:T,transform:g,params:R,queryPadding:this.queryPadding*w},l,d,y):{}}querySourceFeatures(l,d){const y=this.latestFeatureIndex;if(!y||!y.rawTileData)return;const _=y.loadVTLayers(),E=d&&d.sourceLayer?d.sourceLayer:"",P=_._geojsonTileLayer||_[E];if(!P)return;const R=o.a6(d&&d.filter),{z:g,x:w,y:T}=this.tileID.canonical,L={z:g,x:w,y:T};for(let D=0;D<P.length;D++){const H=P.feature(D);if(R.needGeometry){const V=o.a7(H,!0);if(!R.filter(new o.a8(this.tileID.overscaledZ),V,this.tileID.canonical))continue}else if(!R.filter(new o.a8(this.tileID.overscaledZ),H))continue;const z=y.getId(H,E),j=new o.a9(H,g,w,T,z);j.tile=L,l.push(j)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const d=this.expirationTime;if(l.cacheControl){const y=o.aa(l.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const y=Date.now();let _=!1;if(this.expirationTime>y)_=!1;else if(d)if(this.expirationTime<d)_=!0;else{const E=this.expirationTime-d;E?this.expirationTime=y+Math.max(E,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0)return;const y=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!d.style.hasLayer(_))continue;const E=this.buckets[_],P=E.layers[0].sourceLayer||"_geojsonTileLayer",R=y[P],g=l[P];if(!R||!g||Object.keys(g).length===0)continue;E.update(g,R,this.imageAtlas&&this.imageAtlas.patternPositions||{});const w=d&&d.style&&d.style.getLayer(_);w&&(this.queryPadding=Math.max(this.queryPadding,w.queryRadius(E)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<b.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=b.now()+l}setDependencies(l,d){const y={};for(const _ of d)y[_]=!0;this.dependencies[l]=y}hasDependency(l,d){for(const y of l){const _=this.dependencies[y];if(_){for(const E of d)if(_[E])return!0}}return!1}}class Oe{constructor(l,d){this.max=l,this.onRemove=d,this.reset()}reset(){for(const l in this.data)for(const d of this.data[l])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(l,d,y){const _=l.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const E={value:d,timeout:void 0};if(y!==void 0&&(E.timeout=setTimeout(()=>{this.remove(l,E)},y)),this.data[_].push(E),this.order.push(_),this.order.length>this.max){const P=this._getAndRemoveByKey(this.order[0]);P&&this.onRemove(P)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const d=this.data[l].shift();return d.timeout&&clearTimeout(d.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),d.value}getByKey(l){const d=this.data[l];return d?d[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,d){if(!this.has(l))return this;const y=l.wrapped().key,_=d===void 0?0:this.data[y].indexOf(d),E=this.data[y][_];return this.data[y].splice(_,1),E.timeout&&clearTimeout(E.timeout),this.data[y].length===0&&delete this.data[y],this.onRemove(E.value),this.order.splice(this.order.indexOf(y),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(l){const d=[];for(const y in this.data)for(const _ of this.data[y])l(_.value)||d.push(_);for(const y of d)this.remove(y.value.tileID,y)}}class wn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,d,y){const _=String(d);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][_]=this.stateChanges[l][_]||{},o.e(this.stateChanges[l][_],y),this.deletedStates[l]===null){this.deletedStates[l]={};for(const E in this.state[l])E!==_&&(this.deletedStates[l][E]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][_]===null){this.deletedStates[l][_]={};for(const E in this.state[l][_])y[E]||(this.deletedStates[l][_][E]=null)}else for(const E in y)this.deletedStates[l]&&this.deletedStates[l][_]&&this.deletedStates[l][_][E]===null&&delete this.deletedStates[l][_][E]}removeFeatureState(l,d,y){if(this.deletedStates[l]===null)return;const _=String(d);if(this.deletedStates[l]=this.deletedStates[l]||{},y&&d!==void 0)this.deletedStates[l][_]!==null&&(this.deletedStates[l][_]=this.deletedStates[l][_]||{},this.deletedStates[l][_][y]=null);else if(d!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][_])for(y in this.deletedStates[l][_]={},this.stateChanges[l][_])this.deletedStates[l][_][y]=null;else this.deletedStates[l][_]=null;else this.deletedStates[l]=null}getState(l,d){const y=String(d),_=o.e({},(this.state[l]||{})[y],(this.stateChanges[l]||{})[y]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){const E=this.deletedStates[l][d];if(E===null)return{};for(const P in E)delete _[P]}return _}initializeTileState(l,d){l.setFeatureState(this.state,d)}coalesceChanges(l,d){const y={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const E={};for(const P in this.stateChanges[_])this.state[_][P]||(this.state[_][P]={}),o.e(this.state[_][P],this.stateChanges[_][P]),E[P]=this.state[_][P];y[_]=E}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const E={};if(this.deletedStates[_]===null)for(const P in this.state[_])E[P]={},this.state[_][P]={};else for(const P in this.deletedStates[_]){if(this.deletedStates[_][P]===null)this.state[_][P]={};else for(const R of Object.keys(this.deletedStates[_][P]))delete this.state[_][P][R];E[P]=this.state[_][P]}y[_]=y[_]||{},o.e(y[_],E)}if(this.stateChanges={},this.deletedStates={},Object.keys(y).length!==0)for(const _ in l)l[_].setFeatureState(y,d)}}class Fr extends o.E{constructor(l,d,y){super(),this.id=l,this.dispatcher=y,this.on("data",_=>this._dataHandler(_)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((_,E,P,R)=>{const g=new(Ir(E.type))(_,E,P,R);if(g.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${g.id}`);return g})(l,d,y,this),this._tiles={},this._cache=new Oe(0,_=>this._unloadTile(_)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new wn,this._didEmitContent=!1,this._updated=!1}onAdd(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._maxTileCacheZoomLevels=l?l._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(l)}onRemove(l){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(l)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const l in this._tiles){const d=this._tiles[l];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(l,d,y){return o._(this,void 0,void 0,function*(){try{yield this._source.loadTile(l),this._tileLoaded(l,d,y)}catch(_){l.state="errored",_.status!==404?this._source.fire(new o.j(_,{tile:l})):this.update(this.transform,this.terrain)}})}_unloadTile(l){this._source.unloadTile&&this._source.unloadTile(l)}_abortTile(l){this._source.abortTile&&this._source.abortTile(l),this._source.fire(new o.k("dataabort",{tile:l,coord:l.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const y=this._tiles[d];y.upload(l),y.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(l=>l.tileID).sort(Se).map(l=>l.key)}getRenderableIds(l){const d=[];for(const y in this._tiles)this._isIdRenderable(y,l)&&d.push(this._tiles[y]);return l?d.sort((y,_)=>{const E=y.tileID,P=_.tileID,R=new o.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle),g=new o.P(P.canonical.x,P.canonical.y)._rotate(this.transform.angle);return E.overscaledZ-P.overscaledZ||g.y-R.y||g.x-R.x}).map(y=>y.tileID.key):d.map(y=>y.tileID).sort(Se).map(y=>y.key)}hasRenderableParent(l){const d=this.findLoadedParent(l,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(l,d){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(d||!this._tiles[l].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading")}}_reloadTile(l,d){return o._(this,void 0,void 0,function*(){const y=this._tiles[l];y&&(y.state!=="loading"&&(y.state=d),yield this._loadTile(y,l,d))})}_tileLoaded(l,d,y){l.timeAdded=b.now(),y==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(d,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),l.aborted||this._source.fire(new o.k("data",{dataType:"source",tile:l,coord:l.tileID}))}_backfillDEM(l){const d=this.getRenderableIds();for(let _=0;_<d.length;_++){const E=d[_];if(l.neighboringTiles&&l.neighboringTiles[E]){const P=this.getTileByID(E);y(l,P),y(P,l)}}function y(_,E){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let P=E.tileID.canonical.x-_.tileID.canonical.x;const R=E.tileID.canonical.y-_.tileID.canonical.y,g=Math.pow(2,_.tileID.canonical.z),w=E.tileID.key;P===0&&R===0||Math.abs(R)>1||(Math.abs(P)>1&&(Math.abs(P+g)===1?P+=g:Math.abs(P-g)===1&&(P-=g)),E.dem&&_.dem&&(_.dem.backfillBorder(E.dem,P,R),_.neighboringTiles&&_.neighboringTiles[w]&&(_.neighboringTiles[w].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,d,y,_){for(const E in this._tiles){let P=this._tiles[E];if(_[E]||!P.hasData()||P.tileID.overscaledZ<=d||P.tileID.overscaledZ>y)continue;let R=P.tileID;for(;P&&P.tileID.overscaledZ>d+1;){const w=P.tileID.scaledTo(P.tileID.overscaledZ-1);P=this._tiles[w.key],P&&P.hasData()&&(R=w)}let g=R;for(;g.overscaledZ>d;)if(g=g.scaledTo(g.overscaledZ-1),l[g.key]){_[R.key]=R;break}}}findLoadedParent(l,d){if(l.key in this._loadedParentTiles){const y=this._loadedParentTiles[l.key];return y&&y.tileID.overscaledZ>=d?y:null}for(let y=l.overscaledZ-1;y>=d;y--){const _=l.scaledTo(y),E=this._getLoadedTile(_);if(E)return E}}_getLoadedTile(l){const d=this._tiles[l.key];return d&&d.hasData()?d:this._cache.getByKey(l.wrapped().key)}updateCacheSize(l){const d=Math.ceil(l.width/this._source.tileSize)+1,y=Math.ceil(l.height/this._source.tileSize)+1,_=Math.floor(d*y*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),E=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(E)}handleWrapJump(l){const d=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,d){const y={};for(const _ in this._tiles){const E=this._tiles[_];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+d),y[E.tileID.key]=E}this._tiles=y;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(_,this._tiles[_])}}update(l,d){if(!this._sourceLoaded||this._paused)return;let y;this.transform=l,this.terrain=d,this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?y=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(T=>new o.Q(T.canonical.z,T.wrap,T.canonical.z,T.canonical.x,T.canonical.y)):(y=l.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:d}),this._source.hasTile&&(y=y.filter(T=>this._source.hasTile(T)))):y=[];const _=l.coveringZoomLevel(this._source),E=Math.max(_-Fr.maxOverzooming,this._source.minzoom),P=Math.max(_+Fr.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const T={};for(const L of y)if(L.canonical.z>this._source.minzoom){const D=L.scaledTo(L.canonical.z-1);T[D.key]=D;const H=L.scaledTo(Math.max(this._source.minzoom,Math.min(L.canonical.z,5)));T[H.key]=H}y=y.concat(Object.values(T))}const R=y.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,R&&this.fire(new o.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const g=this._updateRetainedTiles(y,_);if(Xe(this._source.type)){const T={},L={},D=Object.keys(g),H=b.now();for(const z of D){const j=g[z],V=this._tiles[z];if(!V||V.fadeEndTime!==0&&V.fadeEndTime<=H)continue;const $=this.findLoadedParent(j,E);$&&(this._addTile($.tileID),T[$.tileID.key]=$.tileID),L[z]=j}this._retainLoadedChildren(L,_,P,g);for(const z in T)g[z]||(this._coveredTiles[z]=!0,g[z]=T[z]);if(d){const z={},j={};for(const V of y)this._tiles[V.key].hasData()?z[V.key]=V:j[V.key]=V;for(const V in j){const $=j[V].children(this._source.maxzoom);this._tiles[$[0].key]&&this._tiles[$[1].key]&&this._tiles[$[2].key]&&this._tiles[$[3].key]&&(z[$[0].key]=g[$[0].key]=$[0],z[$[1].key]=g[$[1].key]=$[1],z[$[2].key]=g[$[2].key]=$[2],z[$[3].key]=g[$[3].key]=$[3],delete j[V])}for(const V in j){const $=this.findLoadedParent(j[V],this._source.minzoom);if($){z[$.tileID.key]=g[$.tileID.key]=$.tileID;for(const lt in z)z[lt].isChildOf($.tileID)&&delete z[lt]}}for(const V in this._tiles)z[V]||(this._coveredTiles[V]=!0)}}for(const T in g)this._tiles[T].clearFadeHold();const w=o.ab(this._tiles,g);for(const T of w){const L=this._tiles[T];L.hasSymbolBuckets&&!L.holdingForFade()?L.setHoldDuration(this.map._fadeDuration):L.hasSymbolBuckets&&!L.symbolFadeFinished()||this._removeTile(T)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)}_updateRetainedTiles(l,d){const y={},_={},E=Math.max(d-Fr.maxOverzooming,this._source.minzoom),P=Math.max(d+Fr.maxUnderzooming,this._source.minzoom),R={};for(const g of l){const w=this._addTile(g);y[g.key]=g,w.hasData()||d<this._source.maxzoom&&(R[g.key]=g)}this._retainLoadedChildren(R,d,P,y);for(const g of l){let w=this._tiles[g.key];if(w.hasData())continue;if(d+1>this._source.maxzoom){const L=g.children(this._source.maxzoom)[0],D=this.getTile(L);if(D&&D.hasData()){y[L.key]=L;continue}}else{const L=g.children(this._source.maxzoom);if(y[L[0].key]&&y[L[1].key]&&y[L[2].key]&&y[L[3].key])continue}let T=w.wasRequested();for(let L=g.overscaledZ-1;L>=E;--L){const D=g.scaledTo(L);if(_[D.key])break;if(_[D.key]=!0,w=this.getTile(D),!w&&T&&(w=this._addTile(D)),w){const H=w.hasData();if((T||H)&&(y[D.key]=D),T=w.wasRequested(),H)break}}}return y}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const l in this._tiles){const d=[];let y,_=this._tiles[l].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){y=this._loadedParentTiles[_.key];break}d.push(_.key);const E=_.scaledTo(_.overscaledZ-1);if(y=this._getLoadedTile(E),y)break;_=E}for(const E of d)this._loadedParentTiles[E]=y}}_addTile(l){let d=this._tiles[l.key];if(d)return d;d=this._cache.getAndRemove(l),d&&(this._setTileReloadTimer(l.key,d),d.tileID=l,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,d)));const y=d;return d||(d=new Tr(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(d,l.key,d.state)),d.uses++,this._tiles[l.key]=d,y||this._source.fire(new o.k("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(l,d){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);const y=d.getExpiryTimeout();y&&(this._timers[l]=setTimeout(()=>{this._reloadTile(l,"expired"),delete this._timers[l]},y))}_removeTile(l){const d=this._tiles[l];d&&(d.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}_dataHandler(l){const d=l.sourceDataType;l.dataType==="source"&&d==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&l.dataType==="source"&&d==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(l);this._cache.reset()}tilesIn(l,d,y){const _=[],E=this.transform;if(!E)return _;const P=y?E.getCameraQueryGeometry(l):l,R=l.map(z=>E.pointCoordinate(z,this.terrain)),g=P.map(z=>E.pointCoordinate(z,this.terrain)),w=this.getIds();let T=1/0,L=1/0,D=-1/0,H=-1/0;for(const z of g)T=Math.min(T,z.x),L=Math.min(L,z.y),D=Math.max(D,z.x),H=Math.max(H,z.y);for(let z=0;z<w.length;z++){const j=this._tiles[w[z]];if(j.holdingForFade())continue;const V=j.tileID,$=Math.pow(2,E.zoom-j.tileID.overscaledZ),lt=d*j.queryPadding*o.W/j.tileSize/$,rt=[V.getTilePoint(new o.Y(T,L)),V.getTilePoint(new o.Y(D,H))];if(rt[0].x-lt<o.W&&rt[0].y-lt<o.W&&rt[1].x+lt>=0&&rt[1].y+lt>=0){const ht=R.map(Pt=>V.getTilePoint(Pt)),gt=g.map(Pt=>V.getTilePoint(Pt));_.push({tile:j,tileID:V,queryGeometry:ht,cameraQueryGeometry:gt,scale:$})}}return _}getVisibleCoordinates(l){const d=this.getRenderableIds(l).map(y=>this._tiles[y].tileID);for(const y of d)y.posMatrix=this.transform.calculatePosMatrix(y.toUnwrapped());return d}hasTransition(){if(this._source.hasTransition())return!0;if(Xe(this._source.type)){const l=b.now();for(const d in this._tiles)if(this._tiles[d].fadeEndTime>=l)return!0}return!1}setFeatureState(l,d,y){this._state.updateState(l=l||"_geojsonTileLayer",d,y)}removeFeatureState(l,d,y){this._state.removeFeatureState(l=l||"_geojsonTileLayer",d,y)}getFeatureState(l,d){return this._state.getState(l=l||"_geojsonTileLayer",d)}setDependencies(l,d,y){const _=this._tiles[l];_&&_.setDependencies(d,y)}reloadTilesForDependencies(l,d){for(const y in this._tiles)this._tiles[y].hasDependency(l,d)&&this._reloadTile(y,"reloading");this._cache.filter(y=>!y.hasDependency(l,d))}}function Se(B,l){const d=Math.abs(2*B.wrap)-+(B.wrap<0),y=Math.abs(2*l.wrap)-+(l.wrap<0);return B.overscaledZ-l.overscaledZ||y-d||l.canonical.y-B.canonical.y||l.canonical.x-B.canonical.x}function Xe(B){return B==="raster"||B==="image"||B==="video"}Fr.maxOverzooming=10,Fr.maxUnderzooming=3;class qe{constructor(l,d){this.reset(l,d)}reset(l,d){this.points=l||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=o.ac(l,0,1);let d=1,y=this._distances[d];const _=l*this.paddedLength+this.padding;for(;y<_&&d<this._distances.length;)y=this._distances[++d];const E=d-1,P=this._distances[E],R=y-P,g=R>0?(_-P)/R:0;return this.points[E].mult(1-g).add(this.points[d].mult(g))}}function Yr(B,l){let d=!0;return B==="always"||B!=="never"&&l!=="never"||(d=!1),d}class Rr{constructor(l,d,y){const _=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(l/y),this.yCellCount=Math.ceil(d/y);for(let P=0;P<this.xCellCount*this.yCellCount;P++)_.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=d,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,d,y,_,E){this._forEachCell(d,y,_,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(d),this.bboxes.push(y),this.bboxes.push(_),this.bboxes.push(E)}insertCircle(l,d,y,_){this._forEachCell(d-_,y-_,d+_,y+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(d),this.circles.push(y),this.circles.push(_)}_insertBoxCell(l,d,y,_,E,P){this.boxCells[E].push(P)}_insertCircleCell(l,d,y,_,E,P){this.circleCells[E].push(P)}_query(l,d,y,_,E,P,R){if(y<0||l>this.width||_<0||d>this.height)return[];const g=[];if(l<=0&&d<=0&&this.width<=y&&this.height<=_){if(E)return[{key:null,x1:l,y1:d,x2:y,y2:_}];for(let w=0;w<this.boxKeys.length;w++)g.push({key:this.boxKeys[w],x1:this.bboxes[4*w],y1:this.bboxes[4*w+1],x2:this.bboxes[4*w+2],y2:this.bboxes[4*w+3]});for(let w=0;w<this.circleKeys.length;w++){const T=this.circles[3*w],L=this.circles[3*w+1],D=this.circles[3*w+2];g.push({key:this.circleKeys[w],x1:T-D,y1:L-D,x2:T+D,y2:L+D})}}else this._forEachCell(l,d,y,_,this._queryCell,g,{hitTest:E,overlapMode:P,seenUids:{box:{},circle:{}}},R);return g}query(l,d,y,_){return this._query(l,d,y,_,!1,null)}hitTest(l,d,y,_,E,P){return this._query(l,d,y,_,!0,E,P).length>0}hitTestCircle(l,d,y,_,E){const P=l-y,R=l+y,g=d-y,w=d+y;if(R<0||P>this.width||w<0||g>this.height)return!1;const T=[];return this._forEachCell(P,g,R,w,this._queryCellCircle,T,{hitTest:!0,overlapMode:_,circle:{x:l,y:d,radius:y},seenUids:{box:{},circle:{}}},E),T.length>0}_queryCell(l,d,y,_,E,P,R,g){const{seenUids:w,hitTest:T,overlapMode:L}=R,D=this.boxCells[E];if(D!==null){const z=this.bboxes;for(const j of D)if(!w.box[j]){w.box[j]=!0;const V=4*j,$=this.boxKeys[j];if(l<=z[V+2]&&d<=z[V+3]&&y>=z[V+0]&&_>=z[V+1]&&(!g||g($))&&(!T||!Yr(L,$.overlapMode))&&(P.push({key:$,x1:z[V],y1:z[V+1],x2:z[V+2],y2:z[V+3]}),T))return!0}}const H=this.circleCells[E];if(H!==null){const z=this.circles;for(const j of H)if(!w.circle[j]){w.circle[j]=!0;const V=3*j,$=this.circleKeys[j];if(this._circleAndRectCollide(z[V],z[V+1],z[V+2],l,d,y,_)&&(!g||g($))&&(!T||!Yr(L,$.overlapMode))){const lt=z[V],rt=z[V+1],ht=z[V+2];if(P.push({key:$,x1:lt-ht,y1:rt-ht,x2:lt+ht,y2:rt+ht}),T)return!0}}}return!1}_queryCellCircle(l,d,y,_,E,P,R,g){const{circle:w,seenUids:T,overlapMode:L}=R,D=this.boxCells[E];if(D!==null){const z=this.bboxes;for(const j of D)if(!T.box[j]){T.box[j]=!0;const V=4*j,$=this.boxKeys[j];if(this._circleAndRectCollide(w.x,w.y,w.radius,z[V+0],z[V+1],z[V+2],z[V+3])&&(!g||g($))&&!Yr(L,$.overlapMode))return P.push(!0),!0}}const H=this.circleCells[E];if(H!==null){const z=this.circles;for(const j of H)if(!T.circle[j]){T.circle[j]=!0;const V=3*j,$=this.circleKeys[j];if(this._circlesCollide(z[V],z[V+1],z[V+2],w.x,w.y,w.radius)&&(!g||g($))&&!Yr(L,$.overlapMode))return P.push(!0),!0}}}_forEachCell(l,d,y,_,E,P,R,g){const w=this._convertToXCellCoord(l),T=this._convertToYCellCoord(d),L=this._convertToXCellCoord(y),D=this._convertToYCellCoord(_);for(let H=w;H<=L;H++)for(let z=T;z<=D;z++)if(E.call(this,l,d,y,_,this.xCellCount*z+H,P,R,g))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,d,y,_,E,P){const R=_-l,g=E-d,w=y+P;return w*w>R*R+g*g}_circleAndRectCollide(l,d,y,_,E,P,R){const g=(P-_)/2,w=Math.abs(l-(_+g));if(w>g+y)return!1;const T=(R-E)/2,L=Math.abs(d-(E+T));if(L>T+y)return!1;if(w<=g||L<=T)return!0;const D=w-g,H=L-T;return D*D+H*H<=y*y}}function pr(B,l,d,y,_){const E=o.F();return l?(o.J(E,E,[1/_,1/_,1]),d||o.ad(E,E,y.angle)):o.K(E,y.labelPlaneMatrix,B),E}function on(B,l,d,y,_){if(l){const E=o.ae(B);return o.J(E,E,[_,_,1]),d||o.ad(E,E,-y.angle),E}return y.glCoordMatrix}function Kr(B,l,d){let y;d?(y=[B.x,B.y,d(B.x,B.y),1],o.af(y,y,l)):(y=[B.x,B.y,0,1],Ge(y,y,l));const _=y[3];return{point:new o.P(y[0]/_,y[1]/_),signedDistanceFromCamera:_}}function Ct(B,l){return .5+B/l*.5}function Z(B,l){const d=B[0]/B[3],y=B[1]/B[3];return d>=-l[0]&&d<=l[0]&&y>=-l[1]&&y<=l[1]}function J(B,l,d,y,_,E,P,R,g,w){const T=y?B.textSizeData:B.iconSizeData,L=o.ag(T,d.transform.zoom),D=[256/d.width*2+1,256/d.height*2+1],H=y?B.text.dynamicLayoutVertexArray:B.icon.dynamicLayoutVertexArray;H.clear();const z=B.lineVertexArray,j=y?B.text.placedSymbolArray:B.icon.placedSymbolArray,V=d.transform.width/d.transform.height;let $=!1;for(let lt=0;lt<j.length;lt++){const rt=j.get(lt);if(rt.hidden||rt.writingMode===o.ah.vertical&&!$){de(rt.numGlyphs,H);continue}let ht;if($=!1,w?(ht=[rt.anchorX,rt.anchorY,w(rt.anchorX,rt.anchorY),1],o.af(ht,ht,l)):(ht=[rt.anchorX,rt.anchorY,0,1],Ge(ht,ht,l)),!Z(ht,D)){de(rt.numGlyphs,H);continue}const gt=Ct(d.transform.cameraToCenterDistance,ht[3]),Pt=o.ai(T,L,rt),Tt=P?Pt/gt:Pt*gt,_t=new o.P(rt.anchorX,rt.anchorY),bt=Kr(_t,_,w).point,Gt={projections:{},offsets:{}},$t=Nt(rt,Tt,!1,R,l,_,E,B.glyphOffsetArray,z,H,bt,_t,Gt,V,g,w);$=$t.useVertical,($t.notEnoughRoom||$||$t.needsFlipping&&Nt(rt,Tt,!0,R,l,_,E,B.glyphOffsetArray,z,H,bt,_t,Gt,V,g,w).notEnoughRoom)&&de(rt.numGlyphs,H)}y?B.text.dynamicLayoutVertexBuffer.updateData(H):B.icon.dynamicLayoutVertexBuffer.updateData(H)}function ot(B,l,d,y,_,E,P,R,g,w,T,L,D){const H=R.glyphStartIndex+R.numGlyphs,z=R.lineStartIndex,j=R.lineStartIndex+R.lineLength,V=l.getoffsetX(R.glyphStartIndex),$=l.getoffsetX(H-1),lt=me(B*V,d,y,_,E,P,R.segment,z,j,g,w,T,L,D);if(!lt)return null;const rt=me(B*$,d,y,_,E,P,R.segment,z,j,g,w,T,L,D);return rt?{first:lt,last:rt}:null}function Et(B,l,d,y){return B===o.ah.horizontal&&Math.abs(d.y-l.y)>Math.abs(d.x-l.x)*y?{useVertical:!0}:(B===o.ah.vertical?l.y<d.y:l.x>d.x)?{needsFlipping:!0}:null}function Nt(B,l,d,y,_,E,P,R,g,w,T,L,D,H,z,j){const V=l/24,$=B.lineOffsetX*V,lt=B.lineOffsetY*V;let rt;if(B.numGlyphs>1){const ht=B.glyphStartIndex+B.numGlyphs,gt=B.lineStartIndex,Pt=B.lineStartIndex+B.lineLength,Tt=ot(V,R,$,lt,d,T,L,B,g,E,D,z,j);if(!Tt)return{notEnoughRoom:!0};const _t=Kr(Tt.first.point,P,j).point,bt=Kr(Tt.last.point,P,j).point;if(y&&!d){const Gt=Et(B.writingMode,_t,bt,H);if(Gt)return Gt}rt=[Tt.first];for(let Gt=B.glyphStartIndex+1;Gt<ht-1;Gt++)rt.push(me(V*R.getoffsetX(Gt),$,lt,d,T,L,B.segment,gt,Pt,g,E,D,z,j));rt.push(Tt.last)}else{if(y&&!d){const gt=Kr(L,_,j).point,Pt=B.lineStartIndex+B.segment+1,Tt=new o.P(g.getx(Pt),g.gety(Pt)),_t=Kr(Tt,_,j),bt=_t.signedDistanceFromCamera>0?_t.point:zt(L,Tt,gt,1,_,j),Gt=Et(B.writingMode,gt,bt,H);if(Gt)return Gt}const ht=me(V*R.getoffsetX(B.glyphStartIndex),$,lt,d,T,L,B.segment,B.lineStartIndex,B.lineStartIndex+B.lineLength,g,E,D,z,j);if(!ht)return{notEnoughRoom:!0};rt=[ht]}for(const ht of rt)o.aj(w,ht.point,ht.angle);return{}}function zt(B,l,d,y,_,E){const P=Kr(B.add(B.sub(l)._unit()),_,E).point,R=d.sub(P);return d.add(R._mult(y/R.mag()))}function qt(B,l){const{projectionCache:d,lineVertexArray:y,labelPlaneMatrix:_,tileAnchorPoint:E,distanceFromAnchor:P,getElevation:R,previousVertex:g,direction:w,absOffsetX:T}=l;if(d.projections[B])return d.projections[B];const L=new o.P(y.getx(B),y.gety(B)),D=Kr(L,_,R);if(D.signedDistanceFromCamera>0)return d.projections[B]=D.point,D.point;const H=B-w;return zt(P===0?E:new o.P(y.getx(H),y.gety(H)),L,g,T-P+1,_,R)}function St(B,l,d){return B._unit()._perp()._mult(l*d)}function Jt(B,l,d,y,_,E,P,R){const{projectionCache:g,direction:w}=R;if(g.offsets[B])return g.offsets[B];const T=d.add(l);if(B+w<y||B+w>=_)return g.offsets[B]=T,T;const L=qt(B+w,R),D=St(L.sub(d),P,w),H=d.add(D),z=L.add(D);return g.offsets[B]=o.ak(E,T,H,z)||T,g.offsets[B]}function me(B,l,d,y,_,E,P,R,g,w,T,L,D,H){const z=y?B-l:B+l;let j=z>0?1:-1,V=0;y&&(j*=-1,V=Math.PI),j<0&&(V+=Math.PI);let $,lt,rt=j>0?R+P:R+P+1,ht=_,gt=_,Pt=0,Tt=0;const _t=Math.abs(z),bt=[];let Gt;for(;Pt+Tt<=_t;){if(rt+=j,rt<R||rt>=g)return null;Pt+=Tt,gt=ht,lt=$;const Ae={projectionCache:L,lineVertexArray:w,labelPlaneMatrix:T,tileAnchorPoint:E,distanceFromAnchor:Pt,getElevation:H,previousVertex:gt,direction:j,absOffsetX:_t};if(ht=qt(rt,Ae),d===0)bt.push(gt),Gt=ht.sub(gt);else{let ye;const Re=ht.sub(gt);ye=Re.mag()===0?St(qt(rt+j,Ae).sub(ht),d,j):St(Re,d,j),lt||(lt=gt.add(ye)),$=Jt(rt,ye,ht,R,g,lt,d,Ae),bt.push(lt),Gt=$.sub(lt)}Tt=Gt.mag()}const $t=Gt._mult((_t-Pt)/Tt)._add(lt||gt),ue=V+Math.atan2(ht.y-gt.y,ht.x-gt.x);return bt.push($t),{point:$t,angle:D?ue:0,path:bt}}const pe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function de(B,l){for(let d=0;d<B;d++){const y=l.length;l.resize(y+4),l.float32.set(pe,3*y)}}function Ge(B,l,d){const y=l[0],_=l[1];return B[0]=d[0]*y+d[4]*_+d[12],B[1]=d[1]*y+d[5]*_+d[13],B[3]=d[3]*y+d[7]*_+d[15],B}const Ye=100;class Cr{constructor(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Rr(l.width+200,l.height+200,25),y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new Rr(l.width+200,l.height+200,25);this.transform=l,this.grid=d,this.ignoredGrid=y,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Ye,this.screenBottomBoundary=l.height+Ye,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(l,d,y,_,E,P){const R=this.projectAndGetPerspectiveRatio(_,l.anchorPointX,l.anchorPointY,P),g=y*R.perspectiveRatio,w=l.x1*g+R.point.x,T=l.y1*g+R.point.y,L=l.x2*g+R.point.x,D=l.y2*g+R.point.y;return!this.isInsideGrid(w,T,L,D)||d!=="always"&&this.grid.hitTest(w,T,L,D,d,E)||R.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[w,T,L,D],offscreen:this.isOffscreen(w,T,L,D)}}placeCollisionCircles(l,d,y,_,E,P,R,g,w,T,L,D,H,z){const j=[],V=new o.P(d.anchorX,d.anchorY),$=Kr(V,P,z),lt=Ct(this.transform.cameraToCenterDistance,$.signedDistanceFromCamera),rt=(T?E/lt:E*lt)/o.ao,ht=Kr(V,R,z).point,gt=ot(rt,_,d.lineOffsetX*rt,d.lineOffsetY*rt,!1,ht,V,d,y,R,{projections:{},offsets:{}},!1,z);let Pt=!1,Tt=!1,_t=!0;if(gt){const bt=.5*D*lt+H,Gt=new o.P(-100,-100),$t=new o.P(this.screenRightBoundary,this.screenBottomBoundary),ue=new qe,Ae=gt.first,ye=gt.last;let Re=[];for(let rr=Ae.path.length-1;rr>=1;rr--)Re.push(Ae.path[rr]);for(let rr=1;rr<ye.path.length;rr++)Re.push(ye.path[rr]);const Ce=2.5*bt;if(g){const rr=Re.map(er=>Kr(er,g,z));Re=rr.some(er=>er.signedDistanceFromCamera<=0)?[]:rr.map(er=>er.point)}let We=[];if(Re.length>0){const rr=Re[0].clone(),er=Re[0].clone();for(let Er=1;Er<Re.length;Er++)rr.x=Math.min(rr.x,Re[Er].x),rr.y=Math.min(rr.y,Re[Er].y),er.x=Math.max(er.x,Re[Er].x),er.y=Math.max(er.y,Re[Er].y);We=rr.x>=Gt.x&&er.x<=$t.x&&rr.y>=Gt.y&&er.y<=$t.y?[Re]:er.x<Gt.x||rr.x>$t.x||er.y<Gt.y||rr.y>$t.y?[]:o.al([Re],Gt.x,Gt.y,$t.x,$t.y)}for(const rr of We){ue.reset(rr,.25*bt);let er=0;er=ue.length<=.5*bt?1:Math.ceil(ue.paddedLength/Ce)+1;for(let Er=0;Er<er;Er++){const Lr=Er/Math.max(er-1,1),Zr=ue.lerp(Lr),wr=Zr.x+Ye,Xr=Zr.y+Ye;j.push(wr,Xr,bt,0);const Bn=wr-bt,Cn=Xr-bt,hi=wr+bt,hn=Xr+bt;if(_t=_t&&this.isOffscreen(Bn,Cn,hi,hn),Tt=Tt||this.isInsideGrid(Bn,Cn,hi,hn),l!=="always"&&this.grid.hitTestCircle(wr,Xr,bt,l,L)&&(Pt=!0,!w))return{circles:[],offscreen:!1,collisionDetected:Pt}}}}return{circles:!w&&Pt||!Tt||lt<this.perspectiveRatioCutoff?[]:j,offscreen:_t,collisionDetected:Pt}}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let y=1/0,_=1/0,E=-1/0,P=-1/0;for(const T of l){const L=new o.P(T.x+Ye,T.y+Ye);y=Math.min(y,L.x),_=Math.min(_,L.y),E=Math.max(E,L.x),P=Math.max(P,L.y),d.push(L)}const R=this.grid.query(y,_,E,P).concat(this.ignoredGrid.query(y,_,E,P)),g={},w={};for(const T of R){const L=T.key;if(g[L.bucketInstanceId]===void 0&&(g[L.bucketInstanceId]={}),g[L.bucketInstanceId][L.featureIndex])continue;const D=[new o.P(T.x1,T.y1),new o.P(T.x2,T.y1),new o.P(T.x2,T.y2),new o.P(T.x1,T.y2)];o.am(d,D)&&(g[L.bucketInstanceId][L.featureIndex]=!0,w[L.bucketInstanceId]===void 0&&(w[L.bucketInstanceId]=[]),w[L.bucketInstanceId].push(L.featureIndex))}return w}insertCollisionBox(l,d,y,_,E,P){(y?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:E,collisionGroupID:P,overlapMode:d},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,d,y,_,E,P){const R=y?this.ignoredGrid:this.grid,g={bucketInstanceId:_,featureIndex:E,collisionGroupID:P,overlapMode:d};for(let w=0;w<l.length;w+=4)R.insertCircle(g,l[w],l[w+1],l[w+2])}projectAndGetPerspectiveRatio(l,d,y,_){let E;return _?(E=[d,y,_(d,y),1],o.af(E,E,l)):(E=[d,y,0,1],Ge(E,E,l)),{point:new o.P((E[0]/E[3]+1)/2*this.transform.width+Ye,(-E[1]/E[3]+1)/2*this.transform.height+Ye),perspectiveRatio:.5+this.transform.cameraToCenterDistance/E[3]*.5}}isOffscreen(l,d,y,_){return y<Ye||l>=this.screenRightBoundary||_<Ye||d>this.screenBottomBoundary}isInsideGrid(l,d,y,_){return y>=0&&l<this.gridRightBoundary&&_>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const l=o.an([]);return o.H(l,l,[-100,-100,0]),l}}function cr(B,l,d){return l*(o.W/(B.tileSize*Math.pow(2,d-B.tileID.overscaledZ)))}class Pr{constructor(l,d,y,_){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?d:-d))):_&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class kr{constructor(l,d,y,_,E){this.text=new Pr(l?l.text:null,d,y,E),this.icon=new Pr(l?l.icon:null,d,_,E)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Qr{constructor(l,d,y){this.text=l,this.icon=d,this.skipFade=y}}class gn{constructor(){this.invProjMatrix=o.F(),this.viewportMatrix=o.F(),this.circles=[]}}class gr{constructor(l,d,y,_,E){this.bucketInstanceId=l,this.featureIndex=d,this.sourceLayerIndex=y,this.bucketIndex=_,this.tileID=E}}class Wr{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const d=++this.maxGroupID;this.collisionGroups[l]={ID:d,predicate:y=>y.collisionGroupID===d}}return this.collisionGroups[l]}}function vn(B,l,d,y,_){const{horizontalAlign:E,verticalAlign:P}=o.at(B);return new o.P(-(E-.5)*l+y[0]*_,-(P-.5)*d+y[1]*_)}function Dn(B,l,d,y,_,E){const{x1:P,x2:R,y1:g,y2:w,anchorPointX:T,anchorPointY:L}=B,D=new o.P(l,d);return y&&D._rotate(_?E:-E),{x1:P+D.x,y1:g+D.y,x2:R+D.x,y2:w+D.y,anchorPointX:T,anchorPointY:L}}class Dt{constructor(l,d,y,_,E){this.transform=l.clone(),this.terrain=d,this.collisionIndex=new Cr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=y,this.retainedQueryData={},this.collisionGroups=new Wr(_),this.collisionCircleArrays={},this.prevPlacement=E,E&&(E.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,d,y,_){const E=y.getBucket(d),P=y.latestFeatureIndex;if(!E||!P||d.id!==E.layerIds[0])return;const R=y.collisionBoxArray,g=E.layers[0].layout,w=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),T=y.tileSize/o.W,L=this.transform.calculatePosMatrix(y.tileID.toUnwrapped()),D=g.get("text-pitch-alignment")==="map",H=g.get("text-rotation-alignment")==="map",z=cr(y,1,this.transform.zoom),j=pr(L,D,H,this.transform,z);let V=null;if(D){const lt=on(L,D,H,this.transform,z);V=o.K([],this.transform.labelPlaneMatrix,lt)}this.retainedQueryData[E.bucketInstanceId]=new gr(E.bucketInstanceId,P,E.sourceLayerIndex,E.index,y.tileID);const $={bucket:E,layout:g,posMatrix:L,textLabelPlaneMatrix:j,labelToScreenMatrix:V,scale:w,textPixelRatio:T,holdingForFade:y.holdingForFade(),collisionBoxArray:R,partiallyEvaluatedTextSize:o.ag(E.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(_)for(const lt of E.sortKeyRanges){const{sortKey:rt,symbolInstanceStart:ht,symbolInstanceEnd:gt}=lt;l.push({sortKey:rt,symbolInstanceStart:ht,symbolInstanceEnd:gt,parameters:$})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:$})}attemptAnchorPlacement(l,d,y,_,E,P,R,g,w,T,L,D,H,z,j,V){const $=o.ap[l.textAnchor],lt=[l.textOffset0,l.textOffset1],rt=vn($,y,_,lt,E),ht=this.collisionIndex.placeCollisionBox(Dn(d,rt.x,rt.y,P,R,this.transform.angle),L,g,w,T.predicate,V);if((!j||this.collisionIndex.placeCollisionBox(Dn(j,rt.x,rt.y,P,R,this.transform.angle),L,g,w,T.predicate,V).box.length!==0)&&ht.box.length>0){let gt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[D.crossTileID]&&this.prevPlacement.placements[D.crossTileID]&&this.prevPlacement.placements[D.crossTileID].text&&(gt=this.prevPlacement.variableOffsets[D.crossTileID].anchor),D.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[D.crossTileID]={textOffset:lt,width:y,height:_,anchor:$,textBoxScale:E,prevAnchor:gt},this.markUsedJustification(H,$,D,z),H.allowVerticalPlacement&&(this.markUsedOrientation(H,z,D),this.placedOrientations[D.crossTileID]=z),{shift:rt,placedGlyphBoxes:ht}}}placeLayerBucketPart(l,d,y){const{bucket:_,layout:E,posMatrix:P,textLabelPlaneMatrix:R,labelToScreenMatrix:g,textPixelRatio:w,holdingForFade:T,collisionBoxArray:L,partiallyEvaluatedTextSize:D,collisionGroup:H}=l.parameters,z=E.get("text-optional"),j=E.get("icon-optional"),V=o.aq(E,"text-overlap","text-allow-overlap"),$=V==="always",lt=o.aq(E,"icon-overlap","icon-allow-overlap"),rt=lt==="always",ht=E.get("text-rotation-alignment")==="map",gt=E.get("text-pitch-alignment")==="map",Pt=E.get("icon-text-fit")!=="none",Tt=E.get("symbol-z-order")==="viewport-y",_t=$&&(rt||!_.hasIconData()||j),bt=rt&&($||!_.hasTextData()||z);!_.collisionArrays&&L&&_.deserializeCollisionBoxes(L);const Gt=this.retainedQueryData[_.bucketInstanceId].tileID,$t=this.terrain?(Ae,ye)=>this.terrain.getElevation(Gt,Ae,ye):null,ue=(Ae,ye)=>{var Re,Ce;if(d[Ae.crossTileID])return;if(T)return void(this.placements[Ae.crossTileID]=new Qr(!1,!1,!1));let We=!1,rr=!1,er=!0,Er=null,Lr={box:null,offscreen:null},Zr={box:null,offscreen:null},wr=null,Xr=null,Bn=null,Cn=0,hi=0,hn=0;ye.textFeatureIndex?Cn=ye.textFeatureIndex:Ae.useRuntimeCollisionCircles&&(Cn=Ae.featureIndex),ye.verticalTextFeatureIndex&&(hi=ye.verticalTextFeatureIndex);const cs=ye.textBox;if(cs){const dn=ln=>{let En=o.ah.horizontal;if(_.allowVerticalPlacement&&!ln&&this.prevPlacement){const Wi=this.prevPlacement.placedOrientations[Ae.crossTileID];Wi&&(this.placedOrientations[Ae.crossTileID]=Wi,En=Wi,this.markUsedOrientation(_,En,Ae))}return En},sn=(ln,En)=>{if(_.allowVerticalPlacement&&Ae.numVerticalGlyphVertices>0&&ye.verticalTextBox){for(const Wi of _.writingModes)if(Wi===o.ah.vertical?(Lr=En(),Zr=Lr):Lr=ln(),Lr&&Lr.box&&Lr.box.length)break}else Lr=ln()},fn=Ae.textAnchorOffsetStartIndex,Ei=Ae.textAnchorOffsetEndIndex;if(Ei===fn){const ln=(En,Wi)=>{const ti=this.collisionIndex.placeCollisionBox(En,V,w,P,H.predicate,$t);return ti&&ti.box&&ti.box.length&&(this.markUsedOrientation(_,Wi,Ae),this.placedOrientations[Ae.crossTileID]=Wi),ti};sn(()=>ln(cs,o.ah.horizontal),()=>{const En=ye.verticalTextBox;return _.allowVerticalPlacement&&Ae.numVerticalGlyphVertices>0&&En?ln(En,o.ah.vertical):{box:null,offscreen:null}}),dn(Lr&&Lr.box&&Lr.box.length)}else{let ln=o.ap[(Ce=(Re=this.prevPlacement)===null||Re===void 0?void 0:Re.variableOffsets[Ae.crossTileID])===null||Ce===void 0?void 0:Ce.anchor];const En=(ti,Un,si)=>{const ah=ti.x2-ti.x1,Tc=ti.y2-ti.y1,Ic=Ae.textBoxScale,El=Pt&&lt==="never"?Un:null;let Co={box:[],offscreen:!1},fu=V==="never"?1:2,Eo="never";ln&&fu++;for(let Lc=0;Lc<fu;Lc++){for(let Fc=fn;Fc<Ei;Fc++){const AA=_.textAnchorOffsets.get(Fc);if(ln&&AA.textAnchor!==ln)continue;const pu=this.attemptAnchorPlacement(AA,ti,ah,Tc,Ic,ht,gt,w,P,H,Eo,Ae,_,si,El,$t);if(pu&&(Co=pu.placedGlyphBoxes,Co&&Co.box&&Co.box.length))return We=!0,Er=pu.shift,Co}ln?ln=null:Eo=V}return Co};sn(()=>En(cs,ye.iconBox,o.ah.horizontal),()=>{const ti=ye.verticalTextBox;return _.allowVerticalPlacement&&!(Lr&&Lr.box&&Lr.box.length)&&Ae.numVerticalGlyphVertices>0&&ti?En(ti,ye.verticalIconBox,o.ah.vertical):{box:null,offscreen:null}}),Lr&&(We=Lr.box,er=Lr.offscreen);const Wi=dn(Lr&&Lr.box);if(!We&&this.prevPlacement){const ti=this.prevPlacement.variableOffsets[Ae.crossTileID];ti&&(this.variableOffsets[Ae.crossTileID]=ti,this.markUsedJustification(_,ti.anchor,Ae,Wi))}}}if(wr=Lr,We=wr&&wr.box&&wr.box.length>0,er=wr&&wr.offscreen,Ae.useRuntimeCollisionCircles){const dn=_.text.placedSymbolArray.get(Ae.centerJustifiedTextSymbolIndex),sn=o.ai(_.textSizeData,D,dn),fn=E.get("text-padding");Xr=this.collisionIndex.placeCollisionCircles(V,dn,_.lineVertexArray,_.glyphOffsetArray,sn,P,R,g,y,gt,H.predicate,Ae.collisionCircleDiameter,fn,$t),Xr.circles.length&&Xr.collisionDetected&&!y&&o.w("Collisions detected, but collision boxes are not shown"),We=$||Xr.circles.length>0&&!Xr.collisionDetected,er=er&&Xr.offscreen}if(ye.iconFeatureIndex&&(hn=ye.iconFeatureIndex),ye.iconBox){const dn=sn=>{const fn=Pt&&Er?Dn(sn,Er.x,Er.y,ht,gt,this.transform.angle):sn;return this.collisionIndex.placeCollisionBox(fn,lt,w,P,H.predicate,$t)};Zr&&Zr.box&&Zr.box.length&&ye.verticalIconBox?(Bn=dn(ye.verticalIconBox),rr=Bn.box.length>0):(Bn=dn(ye.iconBox),rr=Bn.box.length>0),er=er&&Bn.offscreen}const Ii=z||Ae.numHorizontalGlyphVertices===0&&Ae.numVerticalGlyphVertices===0,zn=j||Ae.numIconVertices===0;if(Ii||zn?zn?Ii||(rr=rr&&We):We=rr&&We:rr=We=rr&&We,We&&wr&&wr.box&&this.collisionIndex.insertCollisionBox(wr.box,V,E.get("text-ignore-placement"),_.bucketInstanceId,Zr&&Zr.box&&hi?hi:Cn,H.ID),rr&&Bn&&this.collisionIndex.insertCollisionBox(Bn.box,lt,E.get("icon-ignore-placement"),_.bucketInstanceId,hn,H.ID),Xr&&(We&&this.collisionIndex.insertCollisionCircles(Xr.circles,V,E.get("text-ignore-placement"),_.bucketInstanceId,Cn,H.ID),y)){const dn=_.bucketInstanceId;let sn=this.collisionCircleArrays[dn];sn===void 0&&(sn=this.collisionCircleArrays[dn]=new gn);for(let fn=0;fn<Xr.circles.length;fn+=4)sn.circles.push(Xr.circles[fn+0]),sn.circles.push(Xr.circles[fn+1]),sn.circles.push(Xr.circles[fn+2]),sn.circles.push(Xr.collisionDetected?1:0)}if(Ae.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(_.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ae.crossTileID]=new Qr(We||_t,rr||bt,er||_.justReloaded),d[Ae.crossTileID]=!0};if(Tt){if(l.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ae=_.getSortedSymbolIndexes(this.transform.angle);for(let ye=Ae.length-1;ye>=0;--ye){const Re=Ae[ye];ue(_.symbolInstances.get(Re),_.collisionArrays[Re])}}else for(let Ae=l.symbolInstanceStart;Ae<l.symbolInstanceEnd;Ae++)ue(_.symbolInstances.get(Ae),_.collisionArrays[Ae]);if(y&&_.bucketInstanceId in this.collisionCircleArrays){const Ae=this.collisionCircleArrays[_.bucketInstanceId];o.ar(Ae.invProjMatrix,P),Ae.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1}markUsedJustification(l,d,y,_){let E;E=_===o.ah.vertical?y.verticalPlacedTextSymbolIndex:{left:y.leftJustifiedTextSymbolIndex,center:y.centerJustifiedTextSymbolIndex,right:y.rightJustifiedTextSymbolIndex}[o.as(d)];const P=[y.leftJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.rightJustifiedTextSymbolIndex,y.verticalPlacedTextSymbolIndex];for(const R of P)R>=0&&(l.text.placedSymbolArray.get(R).crossTileID=E>=0&&R!==E?0:y.crossTileID)}markUsedOrientation(l,d,y){const _=d===o.ah.horizontal||d===o.ah.horizontalOnly?d:0,E=d===o.ah.vertical?d:0,P=[y.leftJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.rightJustifiedTextSymbolIndex];for(const R of P)l.text.placedSymbolArray.get(R).placedOrientation=_;y.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(y.verticalPlacedTextSymbolIndex).placedOrientation=E)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let y=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const _=d?d.symbolFadeChange(l):1,E=d?d.opacities:{},P=d?d.variableOffsets:{},R=d?d.placedOrientations:{};for(const g in this.placements){const w=this.placements[g],T=E[g];T?(this.opacities[g]=new kr(T,_,w.text,w.icon),y=y||w.text!==T.text.placed||w.icon!==T.icon.placed):(this.opacities[g]=new kr(null,_,w.text,w.icon,w.skipFade),y=y||w.text||w.icon)}for(const g in E){const w=E[g];if(!this.opacities[g]){const T=new kr(w,_,!1,!1);T.isHidden()||(this.opacities[g]=T,y=y||w.text.placed||w.icon.placed)}}for(const g in P)this.variableOffsets[g]||!this.opacities[g]||this.opacities[g].isHidden()||(this.variableOffsets[g]=P[g]);for(const g in R)this.placedOrientations[g]||!this.opacities[g]||this.opacities[g].isHidden()||(this.placedOrientations[g]=R[g]);if(d&&d.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");y?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:l)}updateLayerOpacities(l,d){const y={};for(const _ of d){const E=_.getBucket(l);E&&_.latestFeatureIndex&&l.id===E.layerIds[0]&&this.updateBucketOpacities(E,y,_.collisionBoxArray)}}updateBucketOpacities(l,d,y){l.hasTextData()&&(l.text.opacityVertexArray.clear(),l.text.hasVisibleVertices=!1),l.hasIconData()&&(l.icon.opacityVertexArray.clear(),l.icon.hasVisibleVertices=!1),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const _=l.layers[0],E=_.layout,P=new kr(null,0,!1,!1,!0),R=E.get("text-allow-overlap"),g=E.get("icon-allow-overlap"),w=_._unevaluatedLayout.hasValue("text-variable-anchor")||_._unevaluatedLayout.hasValue("text-variable-anchor-offset"),T=E.get("text-rotation-alignment")==="map",L=E.get("text-pitch-alignment")==="map",D=E.get("icon-text-fit")!=="none",H=new kr(null,0,R&&(g||!l.hasIconData()||E.get("icon-optional")),g&&(R||!l.hasTextData()||E.get("text-optional")),!0);!l.collisionArrays&&y&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(y);const z=(j,V,$)=>{for(let lt=0;lt<V/4;lt++)j.opacityVertexArray.emplaceBack($);j.hasVisibleVertices=j.hasVisibleVertices||$!==wi};for(let j=0;j<l.symbolInstances.length;j++){const V=l.symbolInstances.get(j),{numHorizontalGlyphVertices:$,numVerticalGlyphVertices:lt,crossTileID:rt}=V;let ht=this.opacities[rt];d[rt]?ht=P:ht||(ht=H,this.opacities[rt]=ht),d[rt]=!0;const gt=V.numIconVertices>0,Pt=this.placedOrientations[V.crossTileID],Tt=Pt===o.ah.vertical,_t=Pt===o.ah.horizontal||Pt===o.ah.horizontalOnly;if($>0||lt>0){const bt=nn(ht.text);z(l.text,$,Tt?wi:bt),z(l.text,lt,_t?wi:bt);const Gt=ht.text.isHidden();[V.rightJustifiedTextSymbolIndex,V.centerJustifiedTextSymbolIndex,V.leftJustifiedTextSymbolIndex].forEach(Ae=>{Ae>=0&&(l.text.placedSymbolArray.get(Ae).hidden=Gt||Tt?1:0)}),V.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(V.verticalPlacedTextSymbolIndex).hidden=Gt||_t?1:0);const $t=this.variableOffsets[V.crossTileID];$t&&this.markUsedJustification(l,$t.anchor,V,Pt);const ue=this.placedOrientations[V.crossTileID];ue&&(this.markUsedJustification(l,"left",V,ue),this.markUsedOrientation(l,ue,V))}if(gt){const bt=nn(ht.icon),Gt=!(D&&V.verticalPlacedIconSymbolIndex&&Tt);V.placedIconSymbolIndex>=0&&(z(l.icon,V.numIconVertices,Gt?bt:wi),l.icon.placedSymbolArray.get(V.placedIconSymbolIndex).hidden=ht.icon.isHidden()),V.verticalPlacedIconSymbolIndex>=0&&(z(l.icon,V.numVerticalIconVertices,Gt?wi:bt),l.icon.placedSymbolArray.get(V.verticalPlacedIconSymbolIndex).hidden=ht.icon.isHidden())}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const bt=l.collisionArrays[j];if(bt){let Gt=new o.P(0,0);if(bt.textBox||bt.verticalTextBox){let ue=!0;if(w){const Ae=this.variableOffsets[rt];Ae?(Gt=vn(Ae.anchor,Ae.width,Ae.height,Ae.textOffset,Ae.textBoxScale),T&&Gt._rotate(L?this.transform.angle:-this.transform.angle)):ue=!1}bt.textBox&&Ue(l.textCollisionBox.collisionVertexArray,ht.text.placed,!ue||Tt,Gt.x,Gt.y),bt.verticalTextBox&&Ue(l.textCollisionBox.collisionVertexArray,ht.text.placed,!ue||_t,Gt.x,Gt.y)}const $t=!!(!_t&&bt.verticalIconBox);bt.iconBox&&Ue(l.iconCollisionBox.collisionVertexArray,ht.icon.placed,$t,D?Gt.x:0,D?Gt.y:0),bt.verticalIconBox&&Ue(l.iconCollisionBox.collisionVertexArray,ht.icon.placed,!$t,D?Gt.x:0,D?Gt.y:0)}}}if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.text.opacityVertexArray.length!==l.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${l.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${l.text.layoutVertexArray.length}) / 4`);if(l.icon.opacityVertexArray.length!==l.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${l.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${l.icon.layoutVertexArray.length}) / 4`);if(l.bucketInstanceId in this.collisionCircleArrays){const j=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=j.invProjMatrix,l.placementViewportMatrix=j.viewportMatrix,l.collisionCircleArray=j.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,d){const y=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*y>l}setStale(){this.stale=!0}}function Ue(B,l,d,y,_){B.emplaceBack(l?1:0,d?1:0,y||0,_||0),B.emplaceBack(l?1:0,d?1:0,y||0,_||0),B.emplaceBack(l?1:0,d?1:0,y||0,_||0),B.emplaceBack(l?1:0,d?1:0,y||0,_||0)}const Ie=Math.pow(2,25),rn=Math.pow(2,24),Mn=Math.pow(2,17),xr=Math.pow(2,16),mn=Math.pow(2,9),bi=Math.pow(2,8),yn=Math.pow(2,1);function nn(B){if(B.opacity===0&&!B.placed)return 0;if(B.opacity===1&&B.placed)return 4294967295;const l=B.placed?1:0,d=Math.floor(127*B.opacity);return d*Ie+l*rn+d*Mn+l*xr+d*mn+l*bi+d*yn+l}const wi=0;class Xn{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,d,y,_,E){const P=this._bucketParts;for(;this._currentTileIndex<l.length;)if(d.getBucketParts(P,_,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((R,g)=>R.sortKey-g.sortKey));this._currentPartIndex<P.length;)if(d.placeLayerBucketPart(P[this._currentPartIndex],this._seenCrossTileIDs,y),this._currentPartIndex++,E())return!0;return!1}}class os{constructor(l,d,y,_,E,P,R,g){this.placement=new Dt(l,d,P,R,g),this._currentPlacementIndex=y.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=E,this._done=!1}isDone(){return this._done}continuePlacement(l,d,y){const _=b.now(),E=()=>!this._forceFullPlacement&&b.now()-_>2;for(;this._currentPlacementIndex>=0;){const P=d[l[this._currentPlacementIndex]],R=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=R)&&(!P.maxzoom||P.maxzoom>R)){if(this._inProgressLayer||(this._inProgressLayer=new Xn(P)),this._inProgressLayer.continuePlacement(y[P.source],this.placement,this._showCollisionBoxes,P,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const Rs=512/o.W/2;class Ho{constructor(l,d,y){this.tileID=l,this.bucketInstanceId=y,this._symbolsByKey={};const _=new Map;for(let E=0;E<d.length;E++){const P=d.get(E),R=P.key,g=_.get(R);g?g.push(P):_.set(R,[P])}for(const[E,P]of _){const R={positions:P.map(g=>({x:Math.floor(g.anchorX*Rs),y:Math.floor(g.anchorY*Rs)})),crossTileIDs:P.map(g=>g.crossTileID)};if(R.positions.length>128){const g=new o.au(R.positions.length,16,Uint16Array);for(const{x:w,y:T}of R.positions)g.add(w,T);g.finish(),delete R.positions,R.index=g}this._symbolsByKey[E]=R}}getScaledCoordinates(l,d){const{x:y,y:_,z:E}=this.tileID.canonical,{x:P,y:R,z:g}=d.canonical,w=Rs/Math.pow(2,g-E),T=(R*o.W+l.anchorY)*w,L=_*o.W*Rs;return{x:Math.floor((P*o.W+l.anchorX)*w-y*o.W*Rs),y:Math.floor(T-L)}}findMatches(l,d,y){const _=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let E=0;E<l.length;E++){const P=l.get(E);if(P.crossTileID)continue;const R=this._symbolsByKey[P.key];if(!R)continue;const g=this.getScaledCoordinates(P,d);if(R.index){const w=R.index.range(g.x-_,g.y-_,g.x+_,g.y+_).sort();for(const T of w){const L=R.crossTileIDs[T];if(!y[L]){y[L]=!0,P.crossTileID=L;break}}}else if(R.positions)for(let w=0;w<R.positions.length;w++){const T=R.positions[w],L=R.crossTileIDs[w];if(Math.abs(T.x-g.x)<=_&&Math.abs(T.y-g.y)<=_&&!y[L]){y[L]=!0,P.crossTileID=L;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(l=>{let{crossTileIDs:d}=l;return d})}}class Or{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Xs{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const d=Math.round((l-this.lng)/360);if(d!==0)for(const y in this.indexes){const _=this.indexes[y],E={};for(const P in _){const R=_[P];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+d),E[R.tileID.key]=R}this.indexes[y]=E}this.lng=l}addBucket(l,d,y){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let E=0;E<d.symbolInstances.length;E++)d.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});const _=this.usedCrossTileIDs[l.overscaledZ];for(const E in this.indexes){const P=this.indexes[E];if(Number(E)>l.overscaledZ)for(const R in P){const g=P[R];g.tileID.isChildOf(l)&&g.findMatches(d.symbolInstances,l,_)}else{const R=P[l.scaledTo(Number(E)).key];R&&R.findMatches(d.symbolInstances,l,_)}}for(let E=0;E<d.symbolInstances.length;E++){const P=d.symbolInstances.get(E);P.crossTileID||(P.crossTileID=y.generate(),_[P.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Ho(l,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(l,d){for(const y of d.getCrossTileIDsLists())for(const _ of y)delete this.usedCrossTileIDs[l][_]}removeStaleBuckets(l){let d=!1;for(const y in this.indexes){const _=this.indexes[y];for(const E in _)l[_[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,_[E]),delete _[E],d=!0)}return d}}class Bs{constructor(){this.layerIndexes={},this.crossTileIDs=new Or,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,d,y){let _=this.layerIndexes[l.id];_===void 0&&(_=this.layerIndexes[l.id]=new Xs);let E=!1;const P={};_.handleWrapJump(y);for(const R of d){const g=R.getBucket(l);g&&l.id===g.layerIds[0]&&(g.bucketInstanceId||(g.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(R.tileID,g,this.crossTileIDs)&&(E=!0),P[g.bucketInstanceId]=!0)}return _.removeStaleBuckets(P)&&(E=!0),E}pruneUnusedLayers(l){const d={};l.forEach(y=>{d[y]=!0});for(const y in this.layerIndexes)d[y]||delete this.layerIndexes[y]}}const Tn=(B,l)=>o.t(B,l&&l.filter(d=>d.identifier!=="source.canvas")),_o=o.av();class Fi extends o.E{constructor(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),this._rtlPluginLoaded=()=>{for(const y in this.sourceCaches){const _=this.sourceCaches[y].getSource().type;_!=="vector"&&_!=="geojson"||this.sourceCaches[y].reload()}},this.map=l,this.dispatcher=new ae(jt(),l._getMapId()),this.dispatcher.registerMessageHandler("GG",(y,_)=>this.getGlyphs(y,_)),this.dispatcher.registerMessageHandler("GI",(y,_)=>this.getImages(y,_)),this.imageManager=new wt,this.imageManager.setEventedParent(this),this.glyphManager=new re(l._requestManager,d.localIdeographFontFamily),this.lineAtlas=new we(256,512),this.crossTileSymbolIndex=new Bs,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.aw,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",o.ax()),fe().on(Sr,this._rtlPluginLoaded),this.on("data",y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;const _=this.sourceCaches[y.sourceId];if(!_)return;const E=_.getSource();if(E&&E.vectorLayerIds)for(const P in this._layers){const R=this._layers[P];R.source===E.id&&this._validateLayer(R)}})}loadURL(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=arguments.length>2?arguments[2]:void 0;this.fire(new o.k("dataloading",{dataType:"style"})),d.validate=typeof d.validate!="boolean"||d.validate;const _=this.map._requestManager.transformRequest(l,"Style");this._loadStyleRequest=new AbortController,o.h(_,this._loadStyleRequest).then(E=>{this._loadStyleRequest=null,this._load(E.data,d,y)}).catch(E=>{this._loadStyleRequest=null,E&&this.fire(new o.j(E))})}loadJSON(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=arguments.length>2?arguments[2]:void 0;this.fire(new o.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,b.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,d.validate=d.validate!==!1,this._load(l,d,y)}).catch(()=>{})}loadEmpty(){this.fire(new o.k("dataloading",{dataType:"style"})),this._load(_o,{validate:!1})}_load(l,d,y){var _;const E=d.transformStyle?d.transformStyle(y,l):l;if(!d.validate||!Tn(this,o.x(E))){this._loaded=!0,this.stylesheet=E;for(const P in E.sources)this.addSource(P,E.sources[P],{validate:!1});E.sprite?this._loadSprite(E.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(E.glyphs),this._createLayers(),this.light=new se(this.stylesheet.light),this.map.setTerrain((_=this.stylesheet.terrain)!==null&&_!==void 0?_:null),this.fire(new o.k("data",{dataType:"style"})),this.fire(new o.k("style.load"))}}_createLayers(){const l=o.ay(this.stylesheet.layers);this.dispatcher.broadcast("SL",l),this._order=l.map(d=>d.id),this._layers={},this._serializedLayers=null;for(const d of l){const y=o.az(d);y.setEventedParent(this,{layer:{id:d.id}}),this._layers[d.id]=y}}_loadSprite(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,_;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(E,P,R,g){return o._(this,void 0,void 0,function*(){const w=Lt(E),T=R>1?"@2x":"",L={},D={};for(const{id:H,url:z}of w){const j=P.transformRequest(P.normalizeSpriteURL(z,T,".json"),"SpriteJSON");L[H]=o.h(j,g);const V=P.transformRequest(P.normalizeSpriteURL(z,T,".png"),"SpriteImage");D[H]=Y.getImage(V,g)}return yield Promise.all([...Object.values(L),...Object.values(D)]),function(H,z){return o._(this,void 0,void 0,function*(){const j={};for(const V in H){j[V]={};const $=b.getImageCanvasContext((yield z[V]).data),lt=(yield H[V]).data;for(const rt in lt){const{width:ht,height:gt,x:Pt,y:Tt,sdf:_t,pixelRatio:bt,stretchX:Gt,stretchY:$t,content:ue}=lt[rt];j[V][rt]={data:null,pixelRatio:bt,sdf:_t,stretchX:Gt,stretchY:$t,content:ue,spriteData:{width:ht,height:gt,x:Pt,y:Tt,context:$}}}}return j})}(L,D)})}(l,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(E=>{if(this._spriteRequest=null,E)for(const P in E){this._spritesImagesIds[P]=[];const R=this._spritesImagesIds[P]?this._spritesImagesIds[P].filter(g=>!(g in E)):[];for(const g of R)this.imageManager.removeImage(g),this._changedImages[g]=!0;for(const g in E[P]){const w=P==="default"?g:`${P}:${g}`;this._spritesImagesIds[P].push(w),w in this.imageManager.images?this.imageManager.updateImage(w,E[P][g],!1):this.imageManager.addImage(w,E[P][g]),d&&(this._changedImages[w]=!0)}}}).catch(E=>{this._spriteRequest=null,_=E,this.fire(new o.j(_))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),d&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"})),y&&y(_)})}_unloadSprite(){for(const l of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(l),this._changedImages[l]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}_validateLayer(l){const d=this.sourceCaches[l.source];if(!d)return;const y=l.sourceLayer;if(!y)return;const _=d.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(y)===-1)&&this.fire(new o.j(new Error(`Source layer "${y}" does not exist on source "${_.id}" as specified by style layer "${l.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(l){const d=this._serializedAllLayers();if(!l||l.length===0)return Object.values(d);const y=[];for(const _ of l)d[_]&&y.push(d[_]);return y}_serializedAllLayers(){let l=this._serializedLayers;if(l)return l;l=this._serializedLayers={};const d=Object.keys(this._layers);for(const y of d){const _=this._layers[y];_.type!=="custom"&&(l[y]=_.serialize())}return l}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const l in this.sourceCaches)if(this.sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(l){if(!this._loaded)return;const d=this._changed;if(d){const _=Object.keys(this._updatedLayers),E=Object.keys(this._removedLayers);(_.length||E.length)&&this._updateWorkerLayers(_,E);for(const P in this._updatedSources){const R=this._updatedSources[P];if(R==="reload")this._reloadSource(P);else{if(R!=="clear")throw new Error(`Invalid action ${R}`);this._clearSource(P)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(l);this.light.updateTransitions(l),this._resetUpdates()}const y={};for(const _ in this.sourceCaches){const E=this.sourceCaches[_];y[_]=E.used,E.used=!1}for(const _ of this._order){const E=this._layers[_];E.recalculate(l,this._availableImages),!E.isHidden(l.zoom)&&E.source&&(this.sourceCaches[E.source].used=!0)}for(const _ in y){const E=this.sourceCaches[_];!!y[_]!=!!E.used&&E.fire(new o.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(l),this.z=l.zoom,d&&this.fire(new o.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(l,d){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(l),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var y;this._checkLoaded();const _=this.serialize();if(l=d.transformStyle?d.transformStyle(_,l):l,((y=d.validate)===null||y===void 0||y)&&Tn(this,o.x(l)))return!1;(l=o.aA(l)).layers=o.ay(l.layers);const E=o.aB(_,l),P=this._getOperationsToPerform(E);if(P.unimplemented.length>0)throw new Error(`Unimplemented: ${P.unimplemented.join(", ")}.`);if(P.operations.length===0)return!1;for(const R of P.operations)R();return this.stylesheet=l,this._serializedLayers=null,!0}_getOperationsToPerform(l){const d=[],y=[];for(const _ of l)switch(_.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":d.push(()=>this.addLayer.apply(this,_.args));break;case"removeLayer":d.push(()=>this.removeLayer.apply(this,_.args));break;case"setPaintProperty":d.push(()=>this.setPaintProperty.apply(this,_.args));break;case"setLayoutProperty":d.push(()=>this.setLayoutProperty.apply(this,_.args));break;case"setFilter":d.push(()=>this.setFilter.apply(this,_.args));break;case"addSource":d.push(()=>this.addSource.apply(this,_.args));break;case"removeSource":d.push(()=>this.removeSource.apply(this,_.args));break;case"setLayerZoomRange":d.push(()=>this.setLayerZoomRange.apply(this,_.args));break;case"setLight":d.push(()=>this.setLight.apply(this,_.args));break;case"setGeoJSONSourceData":d.push(()=>this.setGeoJSONSourceData.apply(this,_.args));break;case"setGlyphs":d.push(()=>this.setGlyphs.apply(this,_.args));break;case"setSprite":d.push(()=>this.setSprite.apply(this,_.args));break;case"setTerrain":d.push(()=>this.map.setTerrain.apply(this,_.args));break;case"setTransition":d.push(()=>{});break;default:y.push(_.command)}return{operations:d,unimplemented:y}}addImage(l,d){if(this.getImage(l))return this.fire(new o.j(new Error(`An image named "${l}" already exists.`)));this.imageManager.addImage(l,d),this._afterImageUpdated(l)}updateImage(l,d){this.imageManager.updateImage(l,d)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new o.j(new Error(`An image named "${l}" does not exist.`)));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(l,d){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error(`Source "${l}" already exists.`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(o.x.source,`sources.${l}`,d,null,y))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const _=this.sourceCaches[l]=new Fr(l,d,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:_.loaded(),source:_.serialize(),sourceId:l})),_.onAdd(this.map),this._changed=!0}removeSource(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===l)return this.fire(new o.j(new Error(`Source "${l}" cannot be removed while layer "${y}" is using it.`)));const d=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],d.fire(new o.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),d.setEventedParent(null),d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,d){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error(`There is no source with this ID=${l}`);const y=this.sourceCaches[l].getSource();if(y.type!=="geojson")throw new Error(`geojsonSource.type is ${y.type}, which is !== 'geojson`);y.setData(d),this._changed=!0}getSource(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()}addLayer(l,d){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this._checkLoaded();const _=l.id;if(this.getLayer(_))return void this.fire(new o.j(new Error(`Layer "${_}" already exists on this map.`)));let E;if(l.type==="custom"){if(Tn(this,o.aC(l)))return;E=o.az(l)}else{if("source"in l&&typeof l.source=="object"&&(this.addSource(_,l.source),l=o.aA(l),l=o.e(l,{source:_})),this._validate(o.x.layer,`layers.${_}`,l,{arrayIndex:-1},y))return;E=o.az(l),this._validateLayer(E),E.setEventedParent(this,{layer:{id:_}})}const P=d?this._order.indexOf(d):this._order.length;if(d&&P===-1)this.fire(new o.j(new Error(`Cannot add layer "${_}" before non-existing layer "${d}".`)));else{if(this._order.splice(P,0,_),this._layerOrderChanged=!0,this._layers[_]=E,this._removedLayers[_]&&E.source&&E.type!=="custom"){const R=this._removedLayers[_];delete this._removedLayers[_],R.type!==E.type?this._updatedSources[E.source]="clear":(this._updatedSources[E.source]="reload",this.sourceCaches[E.source].pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map)}}moveLayer(l,d){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new o.j(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===d)return;const y=this._order.indexOf(l);this._order.splice(y,1);const _=d?this._order.indexOf(d):this._order.length;d&&_===-1?this.fire(new o.j(new Error(`Cannot move layer "${l}" before non-existing layer "${d}".`))):(this._order.splice(_,0,l),this._layerOrderChanged=!0)}removeLayer(l){this._checkLoaded();const d=this._layers[l];if(!d)return void this.fire(new o.j(new Error(`Cannot remove non-existing layer "${l}".`)));d.setEventedParent(null);const y=this._order.indexOf(l);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=d,delete this._layers[l],this._serializedLayers&&delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],d.onRemove&&d.onRemove(this.map)}getLayer(l){return this._layers[l]}getLayersOrder(){return[...this._order]}hasLayer(l){return l in this._layers}setLayerZoomRange(l,d,y){this._checkLoaded();const _=this.getLayer(l);_?_.minzoom===d&&_.maxzoom===y||(d!=null&&(_.minzoom=d),y!=null&&(_.maxzoom=y),this._updateLayer(_)):this.fire(new o.j(new Error(`Cannot set the zoom range of non-existing layer "${l}".`)))}setFilter(l,d){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this._checkLoaded();const _=this.getLayer(l);if(_){if(!o.aD(_.filter,d))return d==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(o.x.filter,`layers.${_.id}.filter`,d,null,y)||(_.filter=o.aA(d),this._updateLayer(_)))}else this.fire(new o.j(new Error(`Cannot filter non-existing layer "${l}".`)))}getFilter(l){return o.aA(this.getLayer(l).filter)}setLayoutProperty(l,d,y){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this._checkLoaded();const E=this.getLayer(l);E?o.aD(E.getLayoutProperty(d),y)||(E.setLayoutProperty(d,y,_),this._updateLayer(E)):this.fire(new o.j(new Error(`Cannot style non-existing layer "${l}".`)))}getLayoutProperty(l,d){const y=this.getLayer(l);if(y)return y.getLayoutProperty(d);this.fire(new o.j(new Error(`Cannot get style of non-existing layer "${l}".`)))}setPaintProperty(l,d,y){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this._checkLoaded();const E=this.getLayer(l);E?o.aD(E.getPaintProperty(d),y)||(E.setPaintProperty(d,y,_)&&this._updateLayer(E),this._changed=!0,this._updatedPaintProps[l]=!0,this._serializedLayers=null):this.fire(new o.j(new Error(`Cannot style non-existing layer "${l}".`)))}getPaintProperty(l,d){return this.getLayer(l).getPaintProperty(d)}setFeatureState(l,d){this._checkLoaded();const y=l.source,_=l.sourceLayer,E=this.sourceCaches[y];if(E===void 0)return void this.fire(new o.j(new Error(`The source '${y}' does not exist in the map's style.`)));const P=E.getSource().type;P==="geojson"&&_?this.fire(new o.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):P!=="vector"||_?(l.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),E.setFeatureState(_,l.id,d)):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(l,d){this._checkLoaded();const y=l.source,_=this.sourceCaches[y];if(_===void 0)return void this.fire(new o.j(new Error(`The source '${y}' does not exist in the map's style.`)));const E=_.getSource().type,P=E==="vector"?l.sourceLayer:void 0;E!=="vector"||P?d&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new o.j(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(P,l.id,d):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(l){this._checkLoaded();const d=l.source,y=l.sourceLayer,_=this.sourceCaches[d];if(_!==void 0)return _.getSource().type!=="vector"||y?(l.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),_.getFeatureState(y,l.id)):void this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.j(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const l=o.aE(this.sourceCaches,E=>E.serialize()),d=this._serializeByIds(this._order),y=this.map.getTerrain()||void 0,_=this.stylesheet;return o.aF({version:_.version,name:_.name,metadata:_.metadata,light:_.light,center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch,sprite:_.sprite,glyphs:_.glyphs,transition:_.transition,sources:l,layers:d,terrain:y},E=>E!==void 0)}_updateLayer(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(l){const d=P=>this._layers[P].type==="fill-extrusion",y={},_=[];for(let P=this._order.length-1;P>=0;P--){const R=this._order[P];if(d(R)){y[R]=P;for(const g of l){const w=g[R];if(w)for(const T of w)_.push(T)}}}_.sort((P,R)=>R.intersectionZ-P.intersectionZ);const E=[];for(let P=this._order.length-1;P>=0;P--){const R=this._order[P];if(d(R))for(let g=_.length-1;g>=0;g--){const w=_[g].feature;if(y[w.layer.id]<P)break;E.push(w),_.pop()}else for(const g of l){const w=g[R];if(w)for(const T of w)E.push(T.feature)}}return E}queryRenderedFeatures(l,d,y){d&&d.filter&&this._validate(o.x.filter,"queryRenderedFeatures.filter",d.filter,null,d);const _={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new o.j(new Error("parameters.layers must be an Array."))),[];for(const R of d.layers){const g=this._layers[R];if(!g)return this.fire(new o.j(new Error(`The layer '${R}' does not exist in the map's style and cannot be queried for features.`))),[];_[g.source]=!0}}const E=[];d.availableImages=this._availableImages;const P=this._serializedAllLayers();for(const R in this.sourceCaches)d.layers&&!_[R]||E.push(Te(this.sourceCaches[R],this._layers,P,l,d,y));return this.placement&&E.push(function(R,g,w,T,L,D,H){const z={},j=D.queryRenderedSymbols(T),V=[];for(const $ of Object.keys(j).map(Number))V.push(H[$]);V.sort(Ne);for(const $ of V){const lt=$.featureIndex.lookupSymbolFeatures(j[$.bucketInstanceId],g,$.bucketIndex,$.sourceLayerIndex,L.filter,L.layers,L.availableImages,R);for(const rt in lt){const ht=z[rt]=z[rt]||[],gt=lt[rt];gt.sort((Pt,Tt)=>{const _t=$.featureSortOrder;if(_t){const bt=_t.indexOf(Pt.featureIndex);return _t.indexOf(Tt.featureIndex)-bt}return Tt.featureIndex-Pt.featureIndex});for(const Pt of gt)ht.push(Pt)}}for(const $ in z)z[$].forEach(lt=>{const rt=lt.feature,ht=w[R[$].source].getFeatureState(rt.layer["source-layer"],rt.id);rt.source=rt.layer.source,rt.layer["source-layer"]&&(rt.sourceLayer=rt.layer["source-layer"]),rt.state=ht});return z}(this._layers,P,this.sourceCaches,l,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(E)}querySourceFeatures(l,d){d&&d.filter&&this._validate(o.x.filter,"querySourceFeatures.filter",d.filter,null,d);const y=this.sourceCaches[l];return y?function(_,E){const P=_.getRenderableIds().map(w=>_.getTileByID(w)),R=[],g={};for(let w=0;w<P.length;w++){const T=P[w],L=T.tileID.canonical.key;g[L]||(g[L]=!0,T.querySourceFeatures(R,E))}return R}(y,d):[]}getLight(){return this.light.getLight()}setLight(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this._checkLoaded();const y=this.light.getLight();let _=!1;for(const P in l)if(!o.aD(l[P],y[P])){_=!0;break}if(!_)return;const E={now:b.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,d),this.light.updateTransitions(E)}_validate(l,d,y,_){let E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};return(!E||E.validate!==!1)&&Tn(this,l.call(o.x,o.e({key:d,style:this.serialize(),value:y,styleSpec:o.v},_)))}_remove(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),fe().off(Sr,this._rtlPluginLoaded);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this.sourceCaches){const y=this.sourceCaches[d];y.setEventedParent(null),y.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),l&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(l)}_clearSource(l){this.sourceCaches[l].clearTiles()}_reloadSource(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()}_updateSources(l){for(const d in this.sourceCaches)this.sourceCaches[d].update(l,this.map.terrain)}_generateCollisionBoxes(){for(const l in this.sourceCaches)this._reloadSource(l)}_updatePlacement(l,d,y,_){let E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,P=!1,R=!1;const g={};for(const w of this._order){const T=this._layers[w];if(T.type!=="symbol")continue;if(!g[T.source]){const D=this.sourceCaches[T.source];g[T.source]=D.getRenderableIds(!0).map(H=>D.getTileByID(H)).sort((H,z)=>z.tileID.overscaledZ-H.tileID.overscaledZ||(H.tileID.isLessThan(z.tileID)?-1:1))}const L=this.crossTileSymbolIndex.addLayer(T,g[T.source],l.center.lng);P=P||L}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((E=E||this._layerOrderChanged||y===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(b.now(),l.zoom))&&(this.pauseablePlacement=new os(l,this.map.terrain,this._order,E,d,y,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,g),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(b.now()),R=!0),P&&this.pauseablePlacement.placement.setStale()),R||P)for(const w of this._order){const T=this._layers[w];T.type==="symbol"&&this.placement.updateLayerOpacities(T,g[T.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(b.now())}_releaseSymbolFadeTiles(){for(const l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,d){return o._(this,void 0,void 0,function*(){const y=yield this.imageManager.getImages(d.icons);this._updateTilesForChangedImages();const _=this.sourceCaches[d.source];return _&&_.setDependencies(d.tileID.key,d.type,d.icons),y})}getGlyphs(l,d){return o._(this,void 0,void 0,function*(){const y=yield this.glyphManager.getGlyphs(d.stacks),_=this.sourceCaches[d.source];return _&&_.setDependencies(d.tileID.key,d.type,[""]),y})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this._checkLoaded(),l&&this._validate(o.x.glyphs,"glyphs",l,null,d)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=l,this.glyphManager.entries={},this.glyphManager.setURL(l))}addSprite(l,d){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},_=arguments.length>3?arguments[3]:void 0;this._checkLoaded();const E=[{id:l,url:d}],P=[...Lt(this.stylesheet.sprite),...E];this._validate(o.x.sprite,"sprite",P,null,y)||(this.stylesheet.sprite=P,this._loadSprite(E,!0,_))}removeSprite(l){this._checkLoaded();const d=Lt(this.stylesheet.sprite);if(d.find(y=>y.id===l)){if(this._spritesImagesIds[l])for(const y of this._spritesImagesIds[l])this.imageManager.removeImage(y),this._changedImages[y]=!0;d.splice(d.findIndex(y=>y.id===l),1),this.stylesheet.sprite=d.length>0?d:void 0,delete this._spritesImagesIds[l],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}else this.fire(new o.j(new Error(`Sprite "${l}" doesn't exists on this map.`)))}getSprite(){return Lt(this.stylesheet.sprite)}setSprite(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=arguments.length>2?arguments[2]:void 0;this._checkLoaded(),l&&this._validate(o.x.sprite,"sprite",l,null,d)||(this.stylesheet.sprite=l,l?this._loadSprite(l,!0,y):(this._unloadSprite(),y&&y(null)))}}var Mi=o.X([{name:"a_pos",type:"Int16",components:2}]),Yn="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Ti={prelude:an(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:an(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:an(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:an(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:an("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:an(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:an(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:an("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:an("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:an("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:an(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:an(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:an(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:an(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:an(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:an(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:an(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:an(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:an(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:an(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:an(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:an(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:an(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:an(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:an(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:an(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:an("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Yn),terrainDepth:an("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Yn),terrainCoords:an("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Yn)};function an(B,l){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,y=l.match(/attribute ([\w]+) ([\w]+)/g),_=B.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=E?E.concat(_):_,R={};return{fragmentSource:B=B.replace(d,(g,w,T,L,D)=>(R[D]=!0,w==="define"?`
#ifndef HAS_UNIFORM_u_${D}
varying ${T} ${L} ${D};
#else
uniform ${T} ${L} u_${D};
#endif
`:`
#ifdef HAS_UNIFORM_u_${D}
    ${T} ${L} ${D} = u_${D};
#endif
`)),vertexSource:l=l.replace(d,(g,w,T,L,D)=>{const H=L==="float"?"vec2":"vec4",z=D.match(/color/)?"color":H;return R[D]?w==="define"?`
#ifndef HAS_UNIFORM_u_${D}
uniform lowp float u_${D}_t;
attribute ${T} ${H} a_${D};
varying ${T} ${L} ${D};
#else
uniform ${T} ${L} u_${D};
#endif
`:z==="vec4"?`
#ifndef HAS_UNIFORM_u_${D}
    ${D} = a_${D};
#else
    ${T} ${L} ${D} = u_${D};
#endif
`:`
#ifndef HAS_UNIFORM_u_${D}
    ${D} = unpack_mix_${z}(a_${D}, u_${D}_t);
#else
    ${T} ${L} ${D} = u_${D};
#endif
`:w==="define"?`
#ifndef HAS_UNIFORM_u_${D}
uniform lowp float u_${D}_t;
attribute ${T} ${H} a_${D};
#else
uniform ${T} ${L} u_${D};
#endif
`:z==="vec4"?`
#ifndef HAS_UNIFORM_u_${D}
    ${T} ${L} ${D} = a_${D};
#else
    ${T} ${L} ${D} = u_${D};
#endif
`:`
#ifndef HAS_UNIFORM_u_${D}
    ${T} ${L} ${D} = unpack_mix_${z}(a_${D}, u_${D}_t);
#else
    ${T} ${L} ${D} = u_${D};
#endif
`}),staticAttributes:y,staticUniforms:P}}class zo{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,d,y,_,E,P,R,g,w){this.context=l;let T=this.boundPaintVertexBuffers.length!==_.length;for(let L=0;!T&&L<_.length;L++)this.boundPaintVertexBuffers[L]!==_[L]&&(T=!0);!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==y||T||this.boundIndexBuffer!==E||this.boundVertexOffset!==P||this.boundDynamicVertexBuffer!==R||this.boundDynamicVertexBuffer2!==g||this.boundDynamicVertexBuffer3!==w?this.freshBind(d,y,_,E,P,R,g,w):(l.bindVertexArray.set(this.vao),R&&R.bind(),E&&E.dynamicDraw&&E.bind(),g&&g.bind(),w&&w.bind())}freshBind(l,d,y,_,E,P,R,g){const w=l.numAttributes,T=this.context,L=T.gl;this.vao&&this.destroy(),this.vao=T.createVertexArray(),T.bindVertexArray.set(this.vao),this.boundProgram=l,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=_,this.boundVertexOffset=E,this.boundDynamicVertexBuffer=P,this.boundDynamicVertexBuffer2=R,this.boundDynamicVertexBuffer3=g,d.enableAttributes(L,l);for(const D of y)D.enableAttributes(L,l);P&&P.enableAttributes(L,l),R&&R.enableAttributes(L,l),g&&g.enableAttributes(L,l),d.bind(),d.setVertexAttribPointers(L,l,E);for(const D of y)D.bind(),D.setVertexAttribPointers(L,l,E);P&&(P.bind(),P.setVertexAttribPointers(L,l,E)),_&&_.bind(),R&&(R.bind(),R.setVertexAttribPointers(L,l,E)),g&&(g.bind(),g.setVertexAttribPointers(L,l,E)),T.currentNumAttributes=w}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Go(B){const l=[];for(let d=0;d<B.length;d++){if(B[d]===null)continue;const y=B[d].split(" ");l.push(y.pop())}return l}class Ys{constructor(l,d,y,_,E,P){const R=l.gl;this.program=R.createProgram();const g=Go(d.staticAttributes),w=y?y.getBinderAttributes():[],T=g.concat(w),L=Ti.prelude.staticUniforms?Go(Ti.prelude.staticUniforms):[],D=d.staticUniforms?Go(d.staticUniforms):[],H=y?y.getBinderUniforms():[],z=L.concat(D).concat(H),j=[];for(const Pt of z)j.indexOf(Pt)<0&&j.push(Pt);const V=y?y.defines():[];E&&V.push("#define OVERDRAW_INSPECTOR;"),P&&V.push("#define TERRAIN3D;");const $=V.concat(Ti.prelude.fragmentSource,d.fragmentSource).join(`
`),lt=V.concat(Ti.prelude.vertexSource,d.vertexSource).join(`
`),rt=R.createShader(R.FRAGMENT_SHADER);if(R.isContextLost())return void(this.failedToCreate=!0);if(R.shaderSource(rt,$),R.compileShader(rt),!R.getShaderParameter(rt,R.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${R.getShaderInfoLog(rt)}`);R.attachShader(this.program,rt);const ht=R.createShader(R.VERTEX_SHADER);if(R.isContextLost())return void(this.failedToCreate=!0);if(R.shaderSource(ht,lt),R.compileShader(ht),!R.getShaderParameter(ht,R.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${R.getShaderInfoLog(ht)}`);R.attachShader(this.program,ht),this.attributes={};const gt={};this.numAttributes=T.length;for(let Pt=0;Pt<this.numAttributes;Pt++)T[Pt]&&(R.bindAttribLocation(this.program,Pt,T[Pt]),this.attributes[T[Pt]]=Pt);if(R.linkProgram(this.program),!R.getProgramParameter(this.program,R.LINK_STATUS))throw new Error(`Program failed to link: ${R.getProgramInfoLog(this.program)}`);R.deleteShader(ht),R.deleteShader(rt);for(let Pt=0;Pt<j.length;Pt++){const Tt=j[Pt];if(Tt&&!gt[Tt]){const _t=R.getUniformLocation(this.program,Tt);_t&&(gt[Tt]=_t)}}this.fixedUniforms=_(l,gt),this.terrainUniforms=((Pt,Tt)=>({u_depth:new o.aG(Pt,Tt.u_depth),u_terrain:new o.aG(Pt,Tt.u_terrain),u_terrain_dim:new o.aH(Pt,Tt.u_terrain_dim),u_terrain_matrix:new o.aI(Pt,Tt.u_terrain_matrix),u_terrain_unpack:new o.aJ(Pt,Tt.u_terrain_unpack),u_terrain_exaggeration:new o.aH(Pt,Tt.u_terrain_exaggeration)}))(l,gt),this.binderUniforms=y?y.getUniforms(l,gt):[]}draw(l,d,y,_,E,P,R,g,w,T,L,D,H,z,j,V,$,lt){const rt=l.gl;if(this.failedToCreate)return;if(l.program.set(this.program),l.setDepthMode(y),l.setStencilMode(_),l.setColorMode(E),l.setCullFace(P),g){l.activeTexture.set(rt.TEXTURE2),rt.bindTexture(rt.TEXTURE_2D,g.depthTexture),l.activeTexture.set(rt.TEXTURE3),rt.bindTexture(rt.TEXTURE_2D,g.texture);for(const gt in this.terrainUniforms)this.terrainUniforms[gt].set(g[gt])}for(const gt in this.fixedUniforms)this.fixedUniforms[gt].set(R[gt]);j&&j.setUniforms(l,this.binderUniforms,H,{zoom:z});let ht=0;switch(d){case rt.LINES:ht=2;break;case rt.TRIANGLES:ht=3;break;case rt.LINE_STRIP:ht=1}for(const gt of D.get()){const Pt=gt.vaos||(gt.vaos={});(Pt[w]||(Pt[w]=new zo)).bind(l,this,T,j?j.getPaintVertexBuffers():[],L,gt.vertexOffset,V,$,lt),rt.drawElements(d,gt.primitiveLength*ht,rt.UNSIGNED_SHORT,gt.primitiveOffset*ht*2)}}}function dc(B,l,d){const y=1/cr(d,1,l.transform.tileZoom),_=Math.pow(2,d.tileID.overscaledZ),E=d.tileSize*Math.pow(2,l.transform.tileZoom)/_,P=E*(d.tileID.canonical.x+d.tileID.wrap*_),R=E*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[y,B.fromScale,B.toScale],u_fade:B.t,u_pixel_coord_upper:[P>>16,R>>16],u_pixel_coord_lower:[65535&P,65535&R]}}const At=(B,l,d,y)=>{const _=l.style.light,E=_.properties.get("position"),P=[E.x,E.y,E.z],R=function(){var w=new o.A(9);return o.A!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[5]=0,w[6]=0,w[7]=0),w[0]=1,w[4]=1,w[8]=1,w}();_.properties.get("anchor")==="viewport"&&function(w,T){var L=Math.sin(T),D=Math.cos(T);w[0]=D,w[1]=L,w[2]=0,w[3]=-L,w[4]=D,w[5]=0,w[6]=0,w[7]=0,w[8]=1}(R,-l.transform.angle),function(w,T,L){var D=T[0],H=T[1],z=T[2];w[0]=D*L[0]+H*L[3]+z*L[6],w[1]=D*L[1]+H*L[4]+z*L[7],w[2]=D*L[2]+H*L[5]+z*L[8]}(P,P,R);const g=_.properties.get("color");return{u_matrix:B,u_lightpos:P,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[g.r,g.g,g.b],u_vertical_gradient:+d,u_opacity:y}},xt=(B,l,d,y,_,E,P)=>o.e(At(B,l,d,y),dc(E,l,P),{u_height_factor:-Math.pow(2,_.overscaledZ)/P.tileSize/8}),Qt=B=>({u_matrix:B}),he=(B,l,d,y)=>o.e(Qt(B),dc(d,l,y)),Fe=(B,l)=>({u_matrix:B,u_world:l}),ir=(B,l,d,y,_)=>o.e(he(B,l,d,y),{u_world:_}),Hr=(B,l,d,y)=>{const _=B.transform;let E,P;if(y.paint.get("circle-pitch-alignment")==="map"){const R=cr(d,1,_.zoom);E=!0,P=[R,R]}else E=!1,P=_.pixelsToGLUnits;return{u_camera_to_center_distance:_.cameraToCenterDistance,u_scale_with_map:+(y.paint.get("circle-pitch-scale")==="map"),u_matrix:B.translatePosMatrix(l.posMatrix,d,y.paint.get("circle-translate"),y.paint.get("circle-translate-anchor")),u_pitch_with_map:+E,u_device_pixel_ratio:B.pixelRatio,u_extrude_scale:P}},Kn=(B,l,d)=>{const y=cr(d,1,l.zoom),_=Math.pow(2,l.zoom-d.tileID.overscaledZ),E=d.tileID.overscaleFactor();return{u_matrix:B,u_camera_to_center_distance:l.cameraToCenterDistance,u_pixels_to_tile_units:y,u_extrude_scale:[l.pixelsToGLUnits[0]/(y*_),l.pixelsToGLUnits[1]/(y*_)],u_overscale_factor:E}},Jn=function(B,l){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return{u_matrix:B,u_color:l,u_overlay:0,u_overlay_scale:d}},li=B=>({u_matrix:B}),kn=(B,l,d,y)=>({u_matrix:B,u_extrude_scale:cr(l,1,d),u_intensity:y});function ZA(B,l){const d=Math.pow(2,l.canonical.z),y=l.canonical.y;return[new o.Y(0,y/d).toLngLat().lat,new o.Y(0,(y+1)/d).toLngLat().lat]}const ol=(B,l,d,y)=>{const _=B.transform;return{u_matrix:fc(B,l,d,y),u_ratio:1/cr(l,1,_.zoom),u_device_pixel_ratio:B.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},Gr=(B,l,d,y,_)=>o.e(ol(B,l,d,_),{u_image:0,u_image_height:y}),Na=(B,l,d,y,_)=>{const E=B.transform,P=yi(l,E);return{u_matrix:fc(B,l,d,_),u_texsize:l.imageAtlasTexture.size,u_ratio:1/cr(l,1,E.zoom),u_device_pixel_ratio:B.pixelRatio,u_image:0,u_scale:[P,y.fromScale,y.toScale],u_fade:y.t,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]]}},tu=(B,l,d,y,_,E)=>{const P=B.lineAtlas,R=yi(l,B.transform),g=d.layout.get("line-cap")==="round",w=P.getDash(y.from,g),T=P.getDash(y.to,g),L=w.width*_.fromScale,D=T.width*_.toScale;return o.e(ol(B,l,d,E),{u_patternscale_a:[R/L,-w.height/2],u_patternscale_b:[R/D,-T.height/2],u_sdfgamma:P.width/(256*Math.min(L,D)*B.pixelRatio)/2,u_image:0,u_tex_y_a:w.y,u_tex_y_b:T.y,u_mix:_.t})};function yi(B,l){return 1/cr(B,1,l.tileZoom)}function fc(B,l,d,y){return B.translatePosMatrix(y?y.posMatrix:l.tileID.posMatrix,l,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const al=(B,l,d,y,_)=>{return{u_matrix:B,u_tl_parent:l,u_scale_parent:d,u_buffer_scale:1,u_fade_t:y.mix,u_opacity:y.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(P=_.paint.get("raster-saturation"),P>0?1-1/(1.001-P):-P),u_contrast_factor:(E=_.paint.get("raster-contrast"),E>0?1/(1-E):1+E),u_spin_weights:fa(_.paint.get("raster-hue-rotate"))};var E,P};function fa(B){B*=Math.PI/180;const l=Math.sin(B),d=Math.cos(B);return[(2*d+1)/3,(-Math.sqrt(3)*l-d+1)/3,(Math.sqrt(3)*l-d+1)/3]}const Qa=(B,l,d,y,_,E,P,R,g,w)=>{const T=_.transform;return{u_is_size_zoom_constant:+(B==="constant"||B==="source"),u_is_size_feature_constant:+(B==="constant"||B==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:T.cameraToCenterDistance,u_pitch:T.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:T.width/T.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:P,u_coord_matrix:R,u_is_text:+g,u_pitch_with_map:+y,u_texsize:w,u_texture:0}},cl=(B,l,d,y,_,E,P,R,g,w,T)=>{const L=_.transform;return o.e(Qa(B,l,d,y,_,E,P,R,g,w),{u_gamma_scale:y?Math.cos(L._pitch)*L.cameraToCenterDistance:1,u_device_pixel_ratio:_.pixelRatio,u_is_halo:+T})},ll=(B,l,d,y,_,E,P,R,g,w)=>o.e(cl(B,l,d,y,_,E,P,R,!0,g,!0),{u_texsize_icon:w,u_texture_icon:1}),ud=(B,l,d)=>({u_matrix:B,u_opacity:l,u_color:d}),Wu=(B,l,d,y,_,E)=>o.e(function(P,R,g,w){const T=g.imageManager.getPattern(P.from.toString()),L=g.imageManager.getPattern(P.to.toString()),{width:D,height:H}=g.imageManager.getPixelSize(),z=Math.pow(2,w.tileID.overscaledZ),j=w.tileSize*Math.pow(2,g.transform.tileZoom)/z,V=j*(w.tileID.canonical.x+w.tileID.wrap*z),$=j*w.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:T.tl,u_pattern_br_a:T.br,u_pattern_tl_b:L.tl,u_pattern_br_b:L.br,u_texsize:[D,H],u_mix:R.t,u_pattern_size_a:T.displaySize,u_pattern_size_b:L.displaySize,u_scale_a:R.fromScale,u_scale_b:R.toScale,u_tile_units_to_pixels:1/cr(w,1,g.transform.tileZoom),u_pixel_coord_upper:[V>>16,$>>16],u_pixel_coord_lower:[65535&V,65535&$]}}(y,E,d,_),{u_matrix:B,u_opacity:l}),pc={fillExtrusion:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_lightpos:new o.aK(B,l.u_lightpos),u_lightintensity:new o.aH(B,l.u_lightintensity),u_lightcolor:new o.aK(B,l.u_lightcolor),u_vertical_gradient:new o.aH(B,l.u_vertical_gradient),u_opacity:new o.aH(B,l.u_opacity)}),fillExtrusionPattern:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_lightpos:new o.aK(B,l.u_lightpos),u_lightintensity:new o.aH(B,l.u_lightintensity),u_lightcolor:new o.aK(B,l.u_lightcolor),u_vertical_gradient:new o.aH(B,l.u_vertical_gradient),u_height_factor:new o.aH(B,l.u_height_factor),u_image:new o.aG(B,l.u_image),u_texsize:new o.aL(B,l.u_texsize),u_pixel_coord_upper:new o.aL(B,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(B,l.u_pixel_coord_lower),u_scale:new o.aK(B,l.u_scale),u_fade:new o.aH(B,l.u_fade),u_opacity:new o.aH(B,l.u_opacity)}),fill:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix)}),fillPattern:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_image:new o.aG(B,l.u_image),u_texsize:new o.aL(B,l.u_texsize),u_pixel_coord_upper:new o.aL(B,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(B,l.u_pixel_coord_lower),u_scale:new o.aK(B,l.u_scale),u_fade:new o.aH(B,l.u_fade)}),fillOutline:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_world:new o.aL(B,l.u_world)}),fillOutlinePattern:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_world:new o.aL(B,l.u_world),u_image:new o.aG(B,l.u_image),u_texsize:new o.aL(B,l.u_texsize),u_pixel_coord_upper:new o.aL(B,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(B,l.u_pixel_coord_lower),u_scale:new o.aK(B,l.u_scale),u_fade:new o.aH(B,l.u_fade)}),circle:(B,l)=>({u_camera_to_center_distance:new o.aH(B,l.u_camera_to_center_distance),u_scale_with_map:new o.aG(B,l.u_scale_with_map),u_pitch_with_map:new o.aG(B,l.u_pitch_with_map),u_extrude_scale:new o.aL(B,l.u_extrude_scale),u_device_pixel_ratio:new o.aH(B,l.u_device_pixel_ratio),u_matrix:new o.aI(B,l.u_matrix)}),collisionBox:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_camera_to_center_distance:new o.aH(B,l.u_camera_to_center_distance),u_pixels_to_tile_units:new o.aH(B,l.u_pixels_to_tile_units),u_extrude_scale:new o.aL(B,l.u_extrude_scale),u_overscale_factor:new o.aH(B,l.u_overscale_factor)}),collisionCircle:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_inv_matrix:new o.aI(B,l.u_inv_matrix),u_camera_to_center_distance:new o.aH(B,l.u_camera_to_center_distance),u_viewport_size:new o.aL(B,l.u_viewport_size)}),debug:(B,l)=>({u_color:new o.aM(B,l.u_color),u_matrix:new o.aI(B,l.u_matrix),u_overlay:new o.aG(B,l.u_overlay),u_overlay_scale:new o.aH(B,l.u_overlay_scale)}),clippingMask:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix)}),heatmap:(B,l)=>({u_extrude_scale:new o.aH(B,l.u_extrude_scale),u_intensity:new o.aH(B,l.u_intensity),u_matrix:new o.aI(B,l.u_matrix)}),heatmapTexture:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_world:new o.aL(B,l.u_world),u_image:new o.aG(B,l.u_image),u_color_ramp:new o.aG(B,l.u_color_ramp),u_opacity:new o.aH(B,l.u_opacity)}),hillshade:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_image:new o.aG(B,l.u_image),u_latrange:new o.aL(B,l.u_latrange),u_light:new o.aL(B,l.u_light),u_shadow:new o.aM(B,l.u_shadow),u_highlight:new o.aM(B,l.u_highlight),u_accent:new o.aM(B,l.u_accent)}),hillshadePrepare:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_image:new o.aG(B,l.u_image),u_dimension:new o.aL(B,l.u_dimension),u_zoom:new o.aH(B,l.u_zoom),u_unpack:new o.aJ(B,l.u_unpack)}),line:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_ratio:new o.aH(B,l.u_ratio),u_device_pixel_ratio:new o.aH(B,l.u_device_pixel_ratio),u_units_to_pixels:new o.aL(B,l.u_units_to_pixels)}),lineGradient:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_ratio:new o.aH(B,l.u_ratio),u_device_pixel_ratio:new o.aH(B,l.u_device_pixel_ratio),u_units_to_pixels:new o.aL(B,l.u_units_to_pixels),u_image:new o.aG(B,l.u_image),u_image_height:new o.aH(B,l.u_image_height)}),linePattern:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_texsize:new o.aL(B,l.u_texsize),u_ratio:new o.aH(B,l.u_ratio),u_device_pixel_ratio:new o.aH(B,l.u_device_pixel_ratio),u_image:new o.aG(B,l.u_image),u_units_to_pixels:new o.aL(B,l.u_units_to_pixels),u_scale:new o.aK(B,l.u_scale),u_fade:new o.aH(B,l.u_fade)}),lineSDF:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_ratio:new o.aH(B,l.u_ratio),u_device_pixel_ratio:new o.aH(B,l.u_device_pixel_ratio),u_units_to_pixels:new o.aL(B,l.u_units_to_pixels),u_patternscale_a:new o.aL(B,l.u_patternscale_a),u_patternscale_b:new o.aL(B,l.u_patternscale_b),u_sdfgamma:new o.aH(B,l.u_sdfgamma),u_image:new o.aG(B,l.u_image),u_tex_y_a:new o.aH(B,l.u_tex_y_a),u_tex_y_b:new o.aH(B,l.u_tex_y_b),u_mix:new o.aH(B,l.u_mix)}),raster:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_tl_parent:new o.aL(B,l.u_tl_parent),u_scale_parent:new o.aH(B,l.u_scale_parent),u_buffer_scale:new o.aH(B,l.u_buffer_scale),u_fade_t:new o.aH(B,l.u_fade_t),u_opacity:new o.aH(B,l.u_opacity),u_image0:new o.aG(B,l.u_image0),u_image1:new o.aG(B,l.u_image1),u_brightness_low:new o.aH(B,l.u_brightness_low),u_brightness_high:new o.aH(B,l.u_brightness_high),u_saturation_factor:new o.aH(B,l.u_saturation_factor),u_contrast_factor:new o.aH(B,l.u_contrast_factor),u_spin_weights:new o.aK(B,l.u_spin_weights)}),symbolIcon:(B,l)=>({u_is_size_zoom_constant:new o.aG(B,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aG(B,l.u_is_size_feature_constant),u_size_t:new o.aH(B,l.u_size_t),u_size:new o.aH(B,l.u_size),u_camera_to_center_distance:new o.aH(B,l.u_camera_to_center_distance),u_pitch:new o.aH(B,l.u_pitch),u_rotate_symbol:new o.aG(B,l.u_rotate_symbol),u_aspect_ratio:new o.aH(B,l.u_aspect_ratio),u_fade_change:new o.aH(B,l.u_fade_change),u_matrix:new o.aI(B,l.u_matrix),u_label_plane_matrix:new o.aI(B,l.u_label_plane_matrix),u_coord_matrix:new o.aI(B,l.u_coord_matrix),u_is_text:new o.aG(B,l.u_is_text),u_pitch_with_map:new o.aG(B,l.u_pitch_with_map),u_texsize:new o.aL(B,l.u_texsize),u_texture:new o.aG(B,l.u_texture)}),symbolSDF:(B,l)=>({u_is_size_zoom_constant:new o.aG(B,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aG(B,l.u_is_size_feature_constant),u_size_t:new o.aH(B,l.u_size_t),u_size:new o.aH(B,l.u_size),u_camera_to_center_distance:new o.aH(B,l.u_camera_to_center_distance),u_pitch:new o.aH(B,l.u_pitch),u_rotate_symbol:new o.aG(B,l.u_rotate_symbol),u_aspect_ratio:new o.aH(B,l.u_aspect_ratio),u_fade_change:new o.aH(B,l.u_fade_change),u_matrix:new o.aI(B,l.u_matrix),u_label_plane_matrix:new o.aI(B,l.u_label_plane_matrix),u_coord_matrix:new o.aI(B,l.u_coord_matrix),u_is_text:new o.aG(B,l.u_is_text),u_pitch_with_map:new o.aG(B,l.u_pitch_with_map),u_texsize:new o.aL(B,l.u_texsize),u_texture:new o.aG(B,l.u_texture),u_gamma_scale:new o.aH(B,l.u_gamma_scale),u_device_pixel_ratio:new o.aH(B,l.u_device_pixel_ratio),u_is_halo:new o.aG(B,l.u_is_halo)}),symbolTextAndIcon:(B,l)=>({u_is_size_zoom_constant:new o.aG(B,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aG(B,l.u_is_size_feature_constant),u_size_t:new o.aH(B,l.u_size_t),u_size:new o.aH(B,l.u_size),u_camera_to_center_distance:new o.aH(B,l.u_camera_to_center_distance),u_pitch:new o.aH(B,l.u_pitch),u_rotate_symbol:new o.aG(B,l.u_rotate_symbol),u_aspect_ratio:new o.aH(B,l.u_aspect_ratio),u_fade_change:new o.aH(B,l.u_fade_change),u_matrix:new o.aI(B,l.u_matrix),u_label_plane_matrix:new o.aI(B,l.u_label_plane_matrix),u_coord_matrix:new o.aI(B,l.u_coord_matrix),u_is_text:new o.aG(B,l.u_is_text),u_pitch_with_map:new o.aG(B,l.u_pitch_with_map),u_texsize:new o.aL(B,l.u_texsize),u_texsize_icon:new o.aL(B,l.u_texsize_icon),u_texture:new o.aG(B,l.u_texture),u_texture_icon:new o.aG(B,l.u_texture_icon),u_gamma_scale:new o.aH(B,l.u_gamma_scale),u_device_pixel_ratio:new o.aH(B,l.u_device_pixel_ratio),u_is_halo:new o.aG(B,l.u_is_halo)}),background:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_opacity:new o.aH(B,l.u_opacity),u_color:new o.aM(B,l.u_color)}),backgroundPattern:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_opacity:new o.aH(B,l.u_opacity),u_image:new o.aG(B,l.u_image),u_pattern_tl_a:new o.aL(B,l.u_pattern_tl_a),u_pattern_br_a:new o.aL(B,l.u_pattern_br_a),u_pattern_tl_b:new o.aL(B,l.u_pattern_tl_b),u_pattern_br_b:new o.aL(B,l.u_pattern_br_b),u_texsize:new o.aL(B,l.u_texsize),u_mix:new o.aH(B,l.u_mix),u_pattern_size_a:new o.aL(B,l.u_pattern_size_a),u_pattern_size_b:new o.aL(B,l.u_pattern_size_b),u_scale_a:new o.aH(B,l.u_scale_a),u_scale_b:new o.aH(B,l.u_scale_b),u_pixel_coord_upper:new o.aL(B,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(B,l.u_pixel_coord_lower),u_tile_units_to_pixels:new o.aH(B,l.u_tile_units_to_pixels)}),terrain:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_texture:new o.aG(B,l.u_texture),u_ele_delta:new o.aH(B,l.u_ele_delta)}),terrainDepth:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_ele_delta:new o.aH(B,l.u_ele_delta)}),terrainCoords:(B,l)=>({u_matrix:new o.aI(B,l.u_matrix),u_texture:new o.aG(B,l.u_texture),u_terrain_coords_id:new o.aH(B,l.u_terrain_coords_id),u_ele_delta:new o.aH(B,l.u_ele_delta)})};class gc{constructor(l,d,y){this.context=l;const _=l.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const d=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ha={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class pa{constructor(l,d,y,_){this.length=d.length,this.attributes=y,this.itemSize=d.bytesPerElement,this.dynamicDraw=_,this.context=l;const E=l.gl;this.buffer=E.createBuffer(),l.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){if(l.length!==this.length)throw new Error(`Length of new data is ${l.length}, which doesn't match current length of ${this.length}`);const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,d){for(let y=0;y<this.attributes.length;y++){const _=d.attributes[this.attributes[y].name];_!==void 0&&l.enableVertexAttribArray(_)}}setVertexAttribPointers(l,d,y){for(let _=0;_<this.attributes.length;_++){const E=this.attributes[_],P=d.attributes[E.name];P!==void 0&&l.vertexAttribPointer(P,E.components,l[Ha[E.type]],!1,this.itemSize,E.offset+this.itemSize*(y||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Pi=new WeakMap;function xi(B){var l;if(Pi.has(B))return Pi.get(B);{const d=(l=B.getParameter(B.VERSION))===null||l===void 0?void 0:l.startsWith("WebGL 2.0");return Pi.set(B,d),d}}class cn{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ul extends cn{getDefault(){return o.aO.transparent}set(l){const d=this.current;(l.r!==d.r||l.g!==d.g||l.b!==d.b||l.a!==d.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Al extends cn{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class eu extends cn{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class Vo extends cn{getDefault(){return[!0,!0,!0,!0]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class jo extends cn{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class $u extends cn{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class ga extends cn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const d=this.current;(l.func!==d.func||l.ref!==d.ref||l.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class Os extends cn{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class ru extends cn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=l,this.dirty=!1}}class mc extends cn{getDefault(){return[0,1]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class yc extends cn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=l,this.dirty=!1}}class nu extends cn{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class Ad extends cn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.BLEND):d.disable(d.BLEND),this.current=l,this.dirty=!1}}class Xu extends cn{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class Yu extends cn{getDefault(){return o.aO.transparent}set(l){const d=this.current;(l.r!==d.r||l.g!==d.g||l.b!==d.b||l.a!==d.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class th extends cn{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class iu extends cn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=l,this.dirty=!1}}class hl extends cn{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class _c extends cn{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class su extends cn{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class Ju extends cn{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class qo extends cn{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class vc extends cn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class ou extends cn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class ma extends cn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class Ko extends cn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class k extends cn{getDefault(){return null}set(l){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class et extends cn{getDefault(){return null}set(l){var d;if(l===this.current&&!this.dirty)return;const y=this.gl;xi(y)?y.bindVertexArray(l):(d=y.getExtension("OES_vertex_array_object"))===null||d===void 0||d.bindVertexArrayOES(l),this.current=l,this.dirty=!1}}class Mt extends cn{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class Vt extends cn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class oe extends cn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class ce extends cn{constructor(l,d){super(l),this.context=l,this.parent=d}getDefault(){return null}}class Me extends ce{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class ar extends ce{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Mr extends ce{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class zr{constructor(l,d,y,_,E){this.context=l,this.width=d,this.height=y;const P=l.gl,R=this.framebuffer=P.createFramebuffer();if(this.colorAttachment=new Me(l,R),_)this.depthAttachment=E?new Mr(l,R):new ar(l,R);else if(E)throw new Error("Stencil cannot be set without depth");if(P.checkFramebufferStatus(P.FRAMEBUFFER)!==P.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const l=this.context.gl,d=this.colorAttachment.get();if(d&&l.deleteTexture(d),this.depthAttachment){const y=this.depthAttachment.get();y&&l.deleteRenderbuffer(y)}l.deleteFramebuffer(this.framebuffer)}}class _r{constructor(l,d,y){this.blendFunction=l,this.blendColor=d,this.mask=y}}_r.Replace=[1,0],_r.disabled=new _r(_r.Replace,o.aO.transparent,[!1,!1,!1,!1]),_r.unblended=new _r(_r.Replace,o.aO.transparent,[!0,!0,!0,!0]),_r.alphaBlended=new _r([1,771],o.aO.transparent,[!0,!0,!0,!0]);class bn{constructor(l){var d,y;if(this.gl=l,this.clearColor=new ul(this),this.clearDepth=new Al(this),this.clearStencil=new eu(this),this.colorMask=new Vo(this),this.depthMask=new jo(this),this.stencilMask=new $u(this),this.stencilFunc=new ga(this),this.stencilOp=new Os(this),this.stencilTest=new ru(this),this.depthRange=new mc(this),this.depthTest=new yc(this),this.depthFunc=new nu(this),this.blend=new Ad(this),this.blendFunc=new Xu(this),this.blendColor=new Yu(this),this.blendEquation=new th(this),this.cullFace=new iu(this),this.cullFaceSide=new hl(this),this.frontFace=new _c(this),this.program=new su(this),this.activeTexture=new Ju(this),this.viewport=new qo(this),this.bindFramebuffer=new vc(this),this.bindRenderbuffer=new ou(this),this.bindTexture=new ma(this),this.bindVertexBuffer=new Ko(this),this.bindElementBuffer=new k(this),this.bindVertexArray=new et(this),this.pixelStoreUnpack=new Mt(this),this.pixelStoreUnpackPremultiplyAlpha=new Vt(this),this.pixelStoreUnpackFlipY=new oe(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),xi(l)){this.HALF_FLOAT=l.HALF_FLOAT;const _=l.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(d=l.RGBA16F)!==null&&d!==void 0?d:_==null?void 0:_.RGBA16F_EXT,this.RGB16F=(y=l.RGB16F)!==null&&y!==void 0?y:_==null?void 0:_.RGB16F_EXT,l.getExtension("EXT_color_buffer_float")}else{l.getExtension("EXT_color_buffer_half_float"),l.getExtension("OES_texture_half_float_linear");const _=l.getExtension("OES_texture_half_float");this.HALF_FLOAT=_==null?void 0:_.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,d){return new gc(this,l,d)}createVertexBuffer(l,d,y){return new pa(this,l,d,y)}createRenderbuffer(l,d,y){const _=this.gl,E=_.createRenderbuffer();return this.bindRenderbuffer.set(E),_.renderbufferStorage(_.RENDERBUFFER,l,d,y),this.bindRenderbuffer.set(null),E}createFramebuffer(l,d,y,_){return new zr(this,l,d,y,_)}clear(l){let{color:d,depth:y,stencil:_}=l;const E=this.gl;let P=0;d&&(P|=E.COLOR_BUFFER_BIT,this.clearColor.set(d),this.colorMask.set([!0,!0,!0,!0])),y!==void 0&&(P|=E.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(y),this.depthMask.set(!0)),_!==void 0&&(P|=E.STENCIL_BUFFER_BIT,this.clearStencil.set(_),this.stencilMask.set(255)),E.clear(P)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){o.aD(l.blendFunction,_r.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}createVertexArray(){var l;return xi(this.gl)?this.gl.createVertexArray():(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.createVertexArrayOES()}deleteVertexArray(l){var d;return xi(this.gl)?this.gl.deleteVertexArray(l):(d=this.gl.getExtension("OES_vertex_array_object"))===null||d===void 0?void 0:d.deleteVertexArrayOES(l)}unbindVAO(){this.bindVertexArray.set(null)}}class vr{constructor(l,d,y){this.func=l,this.mask=d,this.range=y}}vr.ReadOnly=!1,vr.ReadWrite=!0,vr.disabled=new vr(519,vr.ReadOnly,[0,1]);const ui=7680;class qr{constructor(l,d,y,_,E,P){this.test=l,this.ref=d,this.mask=y,this.fail=_,this.depthFail=E,this.pass=P}}qr.disabled=new qr({func:519,mask:0},0,0,ui,ui,ui);class $r{constructor(l,d,y){this.enable=l,this.mode=d,this.frontFace=y}}let ii;function Ds(B,l,d,y,_,E,P){const R=B.context,g=R.gl,w=B.useProgram("collisionBox"),T=[];let L=0,D=0;for(let rt=0;rt<y.length;rt++){const ht=y[rt],gt=l.getTile(ht),Pt=gt.getBucket(d);if(!Pt)continue;let Tt=ht.posMatrix;_[0]===0&&_[1]===0||(Tt=B.translatePosMatrix(ht.posMatrix,gt,_,E));const _t=P?Pt.textCollisionBox:Pt.iconCollisionBox,bt=Pt.collisionCircleArray;if(bt.length>0){const Gt=o.F(),$t=Tt;o.aP(Gt,Pt.placementInvProjMatrix,B.transform.glCoordMatrix),o.aP(Gt,Gt,Pt.placementViewportMatrix),T.push({circleArray:bt,circleOffset:D,transform:$t,invTransform:Gt,coord:ht}),L+=bt.length/4,D=L}_t&&w.draw(R,g.LINES,vr.disabled,qr.disabled,B.colorModeForRenderPass(),$r.disabled,Kn(Tt,B.transform,gt),B.style.map.terrain&&B.style.map.terrain.getTerrainData(ht),d.id,_t.layoutVertexBuffer,_t.indexBuffer,_t.segments,null,B.transform.zoom,null,null,_t.collisionVertexBuffer)}if(!P||!T.length)return;const H=B.useProgram("collisionCircle"),z=new o.aQ;z.resize(4*L),z._trim();let j=0;for(const rt of T)for(let ht=0;ht<rt.circleArray.length/4;ht++){const gt=4*ht,Pt=rt.circleArray[gt+0],Tt=rt.circleArray[gt+1],_t=rt.circleArray[gt+2],bt=rt.circleArray[gt+3];z.emplace(j++,Pt,Tt,_t,bt,0),z.emplace(j++,Pt,Tt,_t,bt,1),z.emplace(j++,Pt,Tt,_t,bt,2),z.emplace(j++,Pt,Tt,_t,bt,3)}(!ii||ii.length<2*L)&&(ii=function(rt){const ht=2*rt,gt=new o.aS;gt.resize(ht),gt._trim();for(let Pt=0;Pt<ht;Pt++){const Tt=6*Pt;gt.uint16[Tt+0]=4*Pt+0,gt.uint16[Tt+1]=4*Pt+1,gt.uint16[Tt+2]=4*Pt+2,gt.uint16[Tt+3]=4*Pt+2,gt.uint16[Tt+4]=4*Pt+3,gt.uint16[Tt+5]=4*Pt+0}return gt}(L));const V=R.createIndexBuffer(ii,!0),$=R.createVertexBuffer(z,o.aR.members,!0);for(const rt of T){const ht={u_matrix:rt.transform,u_inv_matrix:rt.invTransform,u_camera_to_center_distance:(lt=B.transform).cameraToCenterDistance,u_viewport_size:[lt.width,lt.height]};H.draw(R,g.TRIANGLES,vr.disabled,qr.disabled,B.colorModeForRenderPass(),$r.disabled,ht,B.style.map.terrain&&B.style.map.terrain.getTerrainData(rt.coord),d.id,$,V,o.$.simpleSegment(0,2*rt.circleOffset,rt.circleArray.length,rt.circleArray.length/2),null,B.transform.zoom,null,null,null)}var lt;$.destroy(),V.destroy()}$r.disabled=new $r(!1,1029,2305),$r.backCCW=new $r(!0,1029,2305);const ks=o.an(new Float32Array(16));function ya(B,l,d,y,_,E){const{horizontalAlign:P,verticalAlign:R}=o.at(B);return new o.P((-(P-.5)*l/_+y[0])*E,(-(R-.5)*d/_+y[1])*E)}function dl(B,l,d,y,_,E,P,R,g,w,T){const L=B.text.placedSymbolArray,D=B.text.dynamicLayoutVertexArray,H=B.icon.dynamicLayoutVertexArray,z={};D.clear();for(let j=0;j<L.length;j++){const V=L.get(j),$=V.hidden||!V.crossTileID||B.allowVerticalPlacement&&!V.placedOrientation?null:y[V.crossTileID];if($){const lt=new o.P(V.anchorX,V.anchorY),rt=Kr(lt,d?P:E,T),ht=Ct(_.cameraToCenterDistance,rt.signedDistanceFromCamera);let gt=o.ai(B.textSizeData,g,V)*ht/o.ao;d&&(gt*=B.tilePixelRatio/R);const{width:Pt,height:Tt,anchor:_t,textOffset:bt,textBoxScale:Gt}=$,$t=ya(_t,Pt,Tt,bt,Gt,gt),ue=d?Kr(lt.add($t),E,T).point:rt.point.add(l?$t.rotate(-_.angle):$t),Ae=B.allowVerticalPlacement&&V.placedOrientation===o.ah.vertical?Math.PI/2:0;for(let ye=0;ye<V.numGlyphs;ye++)o.aj(D,ue,Ae);w&&V.associatedIconIndex>=0&&(z[V.associatedIconIndex]={shiftedAnchor:ue,angle:Ae})}else de(V.numGlyphs,D)}if(w){H.clear();const j=B.icon.placedSymbolArray;for(let V=0;V<j.length;V++){const $=j.get(V);if($.hidden)de($.numGlyphs,H);else{const lt=z[V];if(lt)for(let rt=0;rt<$.numGlyphs;rt++)o.aj(H,lt.shiftedAnchor,lt.angle);else de($.numGlyphs,H)}}B.icon.dynamicLayoutVertexBuffer.updateData(H)}B.text.dynamicLayoutVertexBuffer.updateData(D)}function bc(B,l,d){return d.iconsInText&&l?"symbolTextAndIcon":B?"symbolSDF":"symbolIcon"}function wc(B,l,d,y,_,E,P,R,g,w,T,L){const D=B.context,H=D.gl,z=B.transform,j=R==="map",V=g==="map",$=R!=="viewport"&&d.layout.get("symbol-placement")!=="point",lt=j&&!V&&!$,rt=!d.layout.get("symbol-sort-key").isConstant();let ht=!1;const gt=B.depthModeForSublayer(0,vr.ReadOnly),Pt=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Tt=[];for(const _t of y){const bt=l.getTile(_t),Gt=bt.getBucket(d);if(!Gt)continue;const $t=_?Gt.text:Gt.icon;if(!$t||!$t.segments.get().length||!$t.hasVisibleVertices)continue;const ue=$t.programConfigurations.get(d.id),Ae=_||Gt.sdfIcons,ye=_?Gt.textSizeData:Gt.iconSizeData,Re=V||z.pitch!==0,Ce=B.useProgram(bc(Ae,_,Gt),ue),We=o.ag(ye,z.zoom),rr=B.style.map.terrain&&B.style.map.terrain.getTerrainData(_t);let er,Er,Lr,Zr,wr=[0,0],Xr=null;if(_)Er=bt.glyphAtlasTexture,Lr=H.LINEAR,er=bt.glyphAtlasTexture.size,Gt.iconsInText&&(wr=bt.imageAtlasTexture.size,Xr=bt.imageAtlasTexture,Zr=Re||B.options.rotating||B.options.zooming||ye.kind==="composite"||ye.kind==="camera"?H.LINEAR:H.NEAREST);else{const ln=d.layout.get("icon-size").constantOr(0)!==1||Gt.iconsNeedLinear;Er=bt.imageAtlasTexture,Lr=Ae||B.options.rotating||B.options.zooming||ln||Re?H.LINEAR:H.NEAREST,er=bt.imageAtlasTexture.size}const Bn=cr(bt,1,B.transform.zoom),Cn=pr(_t.posMatrix,V,j,B.transform,Bn),hi=on(_t.posMatrix,V,j,B.transform,Bn),hn=Pt&&Gt.hasTextData(),cs=d.layout.get("icon-text-fit")!=="none"&&hn&&Gt.hasIconData();if($){const ln=B.style.map.terrain?(Wi,ti)=>B.style.map.terrain.getElevation(_t,Wi,ti):null,En=d.layout.get("text-rotation-alignment")==="map";J(Gt,_t.posMatrix,B,_,Cn,hi,V,w,En,ln)}const Ii=B.translatePosMatrix(_t.posMatrix,bt,E,P),zn=$||_&&Pt||cs?ks:Cn,dn=B.translatePosMatrix(hi,bt,E,P,!0),sn=Ae&&d.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let fn;fn=Ae?Gt.iconsInText?ll(ye.kind,We,lt,V,B,Ii,zn,dn,er,wr):cl(ye.kind,We,lt,V,B,Ii,zn,dn,_,er,!0):Qa(ye.kind,We,lt,V,B,Ii,zn,dn,_,er);const Ei={program:Ce,buffers:$t,uniformValues:fn,atlasTexture:Er,atlasTextureIcon:Xr,atlasInterpolation:Lr,atlasInterpolationIcon:Zr,isSDF:Ae,hasHalo:sn};if(rt&&Gt.canOverlap){ht=!0;const ln=$t.segments.get();for(const En of ln)Tt.push({segments:new o.$([En]),sortKey:En.sortKey,state:Ei,terrainData:rr})}else Tt.push({segments:$t.segments,sortKey:0,state:Ei,terrainData:rr})}ht&&Tt.sort((_t,bt)=>_t.sortKey-bt.sortKey);for(const _t of Tt){const bt=_t.state;if(D.activeTexture.set(H.TEXTURE0),bt.atlasTexture.bind(bt.atlasInterpolation,H.CLAMP_TO_EDGE),bt.atlasTextureIcon&&(D.activeTexture.set(H.TEXTURE1),bt.atlasTextureIcon&&bt.atlasTextureIcon.bind(bt.atlasInterpolationIcon,H.CLAMP_TO_EDGE)),bt.isSDF){const Gt=bt.uniformValues;bt.hasHalo&&(Gt.u_is_halo=1,fl(bt.buffers,_t.segments,d,B,bt.program,gt,T,L,Gt,_t.terrainData)),Gt.u_is_halo=0}fl(bt.buffers,_t.segments,d,B,bt.program,gt,T,L,bt.uniformValues,_t.terrainData)}}function fl(B,l,d,y,_,E,P,R,g,w){const T=y.context;_.draw(T,T.gl.TRIANGLES,E,P,R,$r.disabled,g,w,d.id,B.layoutVertexBuffer,B.indexBuffer,l,d.paint,y.transform.zoom,B.programConfigurations.get(d.id),B.dynamicLayoutVertexBuffer,B.opacityVertexBuffer)}function xc(B,l,d,y,_){if(!d||!y||!y.imageAtlas)return;const E=y.imageAtlas.patternPositions;let P=E[d.to.toString()],R=E[d.from.toString()];if(!P&&R&&(P=R),!R&&P&&(R=P),!P||!R){const g=_.getPaintProperty(l);P=E[g],R=E[g]}P&&R&&B.setConstantPatternPositions(P,R)}function au(B,l,d,y,_,E,P){const R=B.context.gl,g="fill-pattern",w=d.paint.get(g),T=w&&w.constantOr(1),L=d.getCrossfadeParameters();let D,H,z,j,V;P?(H=T&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",D=R.LINES):(H=T?"fillPattern":"fill",D=R.TRIANGLES);const $=w.constantOr(null);for(const lt of y){const rt=l.getTile(lt);if(T&&!rt.patternsLoaded())continue;const ht=rt.getBucket(d);if(!ht)continue;const gt=ht.programConfigurations.get(d.id),Pt=B.useProgram(H,gt),Tt=B.style.map.terrain&&B.style.map.terrain.getTerrainData(lt);T&&(B.context.activeTexture.set(R.TEXTURE0),rt.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),gt.updatePaintBuffers(L)),xc(gt,g,$,rt,d);const _t=Tt?lt:null,bt=B.translatePosMatrix(_t?_t.posMatrix:lt.posMatrix,rt,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(P){j=ht.indexBuffer2,V=ht.segments2;const Gt=[R.drawingBufferWidth,R.drawingBufferHeight];z=H==="fillOutlinePattern"&&T?ir(bt,B,L,rt,Gt):Fe(bt,Gt)}else j=ht.indexBuffer,V=ht.segments,z=T?he(bt,B,L,rt):Qt(bt);Pt.draw(B.context,D,_,B.stencilModeForClipping(lt),E,$r.disabled,z,Tt,d.id,ht.layoutVertexBuffer,j,V,d.paint,B.transform.zoom,gt)}}function za(B,l,d,y,_,E,P){const R=B.context,g=R.gl,w="fill-extrusion-pattern",T=d.paint.get(w),L=T.constantOr(1),D=d.getCrossfadeParameters(),H=d.paint.get("fill-extrusion-opacity"),z=T.constantOr(null);for(const j of y){const V=l.getTile(j),$=V.getBucket(d);if(!$)continue;const lt=B.style.map.terrain&&B.style.map.terrain.getTerrainData(j),rt=$.programConfigurations.get(d.id),ht=B.useProgram(L?"fillExtrusionPattern":"fillExtrusion",rt);L&&(B.context.activeTexture.set(g.TEXTURE0),V.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),rt.updatePaintBuffers(D)),xc(rt,w,z,V,d);const gt=B.translatePosMatrix(j.posMatrix,V,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Pt=d.paint.get("fill-extrusion-vertical-gradient"),Tt=L?xt(gt,B,Pt,H,j,D,V):At(gt,B,Pt,H);ht.draw(R,R.gl.TRIANGLES,_,E,P,$r.backCCW,Tt,lt,d.id,$.layoutVertexBuffer,$.indexBuffer,$.segments,d.paint,B.transform.zoom,rt,B.style.map.terrain&&$.centroidVertexBuffer)}}function as(B,l,d,y,_,E,P){const R=B.context,g=R.gl,w=d.fbo;if(!w)return;const T=B.useProgram("hillshade"),L=B.style.map.terrain&&B.style.map.terrain.getTerrainData(l);R.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,w.colorAttachment.get()),T.draw(R,g.TRIANGLES,_,E,P,$r.disabled,((D,H,z,j)=>{const V=z.paint.get("hillshade-shadow-color"),$=z.paint.get("hillshade-highlight-color"),lt=z.paint.get("hillshade-accent-color");let rt=z.paint.get("hillshade-illumination-direction")*(Math.PI/180);z.paint.get("hillshade-illumination-anchor")==="viewport"&&(rt-=D.transform.angle);const ht=!D.options.moving;return{u_matrix:j?j.posMatrix:D.transform.calculatePosMatrix(H.tileID.toUnwrapped(),ht),u_image:0,u_latrange:ZA(0,H.tileID),u_light:[z.paint.get("hillshade-exaggeration"),rt],u_shadow:V,u_highlight:$,u_accent:lt}})(B,d,y,L?l:null),L,y.id,B.rasterBoundsBuffer,B.quadTriangleIndexBuffer,B.rasterBoundsSegments)}function Bc(B,l,d,y,_,E){const P=B.context,R=P.gl,g=l.dem;if(g&&g.data){const w=g.dim,T=g.stride,L=g.getPixels();if(P.activeTexture.set(R.TEXTURE1),P.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||B.getTileTexture(T),l.demTexture){const H=l.demTexture;H.update(L,{premultiply:!1}),H.bind(R.NEAREST,R.CLAMP_TO_EDGE)}else l.demTexture=new st(P,L,R.RGBA,{premultiply:!1}),l.demTexture.bind(R.NEAREST,R.CLAMP_TO_EDGE);P.activeTexture.set(R.TEXTURE0);let D=l.fbo;if(!D){const H=new st(P,{width:w,height:w,data:null},R.RGBA);H.bind(R.LINEAR,R.CLAMP_TO_EDGE),D=l.fbo=P.createFramebuffer(w,w,!0,!1),D.colorAttachment.set(H.texture)}P.bindFramebuffer.set(D.framebuffer),P.viewport.set([0,0,w,w]),B.useProgram("hillshadePrepare").draw(P,R.TRIANGLES,y,_,E,$r.disabled,((H,z)=>{const j=z.stride,V=o.F();return o.aN(V,0,o.W,-o.W,0,0,1),o.H(V,V,[0,-o.W,0]),{u_matrix:V,u_image:1,u_dimension:[j,j],u_zoom:H.overscaledZ,u_unpack:z.getUnpackVector()}})(l.tileID,g),null,d.id,B.rasterBoundsBuffer,B.quadTriangleIndexBuffer,B.rasterBoundsSegments),l.needsHillshadePrepare=!1}}function pl(B,l,d,y,_,E){const P=y.paint.get("raster-fade-duration");if(!E&&P>0){const R=b.now(),g=(R-B.timeAdded)/P,w=l?(R-l.timeAdded)/P:-1,T=d.getSource(),L=_.coveringZoomLevel({tileSize:T.tileSize,roundZoom:T.roundZoom}),D=!l||Math.abs(l.tileID.overscaledZ-L)>Math.abs(B.tileID.overscaledZ-L),H=D&&B.refreshedUponExpiration?1:o.ac(D?g:1-w,0,1);return B.refreshedUponExpiration&&g>=1&&(B.refreshedUponExpiration=!1),l?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}const gl=new o.aO(1,0,0,1),Cc=new o.aO(0,1,0,1),_s=new o.aO(0,0,1,1),hd=new o.aO(1,0,1,1),cu=new o.aO(0,1,1,1);function Wn(B,l,d,y){Ui(B,0,l+d/2,B.transform.width,d,y)}function Vi(B,l,d,y){Ui(B,l-d/2,0,d,B.transform.height,y)}function Ui(B,l,d,y,_,E){const P=B.context,R=P.gl;R.enable(R.SCISSOR_TEST),R.scissor(l*B.pixelRatio,d*B.pixelRatio,y*B.pixelRatio,_*B.pixelRatio),P.clear({color:E}),R.disable(R.SCISSOR_TEST)}function Zu(B,l,d){const y=B.context,_=y.gl,E=d.posMatrix,P=B.useProgram("debug"),R=vr.disabled,g=qr.disabled,w=B.colorModeForRenderPass(),T="$debug",L=B.style.map.terrain&&B.style.map.terrain.getTerrainData(d);y.activeTexture.set(_.TEXTURE0);const D=l.getTileByID(d.key).latestRawTileData,H=Math.floor((D&&D.byteLength||0)/1024),z=l.getTile(d).tileSize,j=512/Math.min(z,512)*(d.overscaledZ/B.transform.zoom)*.5;let V=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(V+=` => ${d.overscaledZ}`),function($,lt){$.initDebugOverlayCanvas();const rt=$.debugOverlayCanvas,ht=$.context.gl,gt=$.debugOverlayCanvas.getContext("2d");gt.clearRect(0,0,rt.width,rt.height),gt.shadowColor="white",gt.shadowBlur=2,gt.lineWidth=1.5,gt.strokeStyle="white",gt.textBaseline="top",gt.font="bold 36px Open Sans, sans-serif",gt.fillText(lt,5,5),gt.strokeText(lt,5,5),$.debugOverlayTexture.update(rt),$.debugOverlayTexture.bind(ht.LINEAR,ht.CLAMP_TO_EDGE)}(B,`${V} ${H}kB`),P.draw(y,_.TRIANGLES,R,g,_r.alphaBlended,$r.disabled,Jn(E,o.aO.transparent,j),null,T,B.debugBuffer,B.quadTriangleIndexBuffer,B.debugSegments),P.draw(y,_.LINE_STRIP,R,g,w,$r.disabled,Jn(E,o.aO.red),L,T,B.debugBuffer,B.tileBorderIndexBuffer,B.debugSegments)}function lu(B,l,d){const y=B.context,_=y.gl,E=B.colorModeForRenderPass(),P=new vr(_.LEQUAL,vr.ReadWrite,B.depthRangeFor3D),R=B.useProgram("terrain"),g=l.getTerrainMesh();y.bindFramebuffer.set(null),y.viewport.set([0,0,B.width,B.height]);for(const w of d){const T=B.renderToTexture.getTexture(w),L=l.getTerrainData(w.tileID);y.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,T.texture);const D={u_matrix:B.transform.calculatePosMatrix(w.tileID.toUnwrapped()),u_texture:0,u_ele_delta:l.getMeshFrameDelta(B.transform.zoom)};R.draw(y,_.TRIANGLES,P,qr.disabled,E,$r.backCCW,D,L,"terrain",g.vertexBuffer,g.indexBuffer,g.segments)}}class Ga{constructor(l,d){this.context=new bn(l),this.transform=d,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Fr.maxUnderzooming+Fr.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Bs}resize(l,d,y){if(this.width=Math.floor(l*y),this.height=Math.floor(d*y),this.pixelRatio=y,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const l=this.context,d=new o.aV;d.emplaceBack(0,0),d.emplaceBack(o.W,0),d.emplaceBack(0,o.W),d.emplaceBack(o.W,o.W),this.tileExtentBuffer=l.createVertexBuffer(d,Mi.members),this.tileExtentSegments=o.$.simpleSegment(0,0,4,2);const y=new o.aV;y.emplaceBack(0,0),y.emplaceBack(o.W,0),y.emplaceBack(0,o.W),y.emplaceBack(o.W,o.W),this.debugBuffer=l.createVertexBuffer(y,Mi.members),this.debugSegments=o.$.simpleSegment(0,0,4,5);const _=new o.Z;_.emplaceBack(0,0,0,0),_.emplaceBack(o.W,0,o.W,0),_.emplaceBack(0,o.W,0,o.W),_.emplaceBack(o.W,o.W,o.W,o.W),this.rasterBoundsBuffer=l.createVertexBuffer(_,_e.members),this.rasterBoundsSegments=o.$.simpleSegment(0,0,4,2);const E=new o.aV;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(E,Mi.members),this.viewportSegments=o.$.simpleSegment(0,0,4,2);const P=new o.aW;P.emplaceBack(0),P.emplaceBack(1),P.emplaceBack(3),P.emplaceBack(2),P.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(P);const R=new o.aX;R.emplaceBack(0,1,2),R.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(R);const g=this.context.gl;this.stencilClearMode=new qr({func:g.ALWAYS,mask:0},0,255,g.ZERO,g.ZERO,g.ZERO)}clearStencil(){const l=this.context,d=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const y=o.F();o.aN(y,0,this.width,this.height,0,0,1),o.J(y,y,[d.drawingBufferWidth,d.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,d.TRIANGLES,vr.disabled,this.stencilClearMode,_r.disabled,$r.disabled,li(y),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,d){if(this.currentStencilSource===l.source||!l.isTileClipped()||!d||!d.length)return;this.currentStencilSource=l.source;const y=this.context,_=y.gl;this.nextStencilID+d.length>256&&this.clearStencil(),y.setColorMode(_r.disabled),y.setDepthMode(vr.disabled);const E=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const P of d){const R=this._tileClippingMaskIDs[P.key]=this.nextStencilID++,g=this.style.map.terrain&&this.style.map.terrain.getTerrainData(P);E.draw(y,_.TRIANGLES,vr.disabled,new qr({func:_.ALWAYS,mask:0},R,255,_.KEEP,_.KEEP,_.REPLACE),_r.disabled,$r.disabled,li(P.posMatrix),g,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,d=this.context.gl;return new qr({func:d.NOTEQUAL,mask:255},l,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(l){const d=this.context.gl;return new qr({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(l){const d=this.context.gl,y=l.sort((P,R)=>R.overscaledZ-P.overscaledZ),_=y[y.length-1].overscaledZ,E=y[0].overscaledZ-_+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const P={};for(let R=0;R<E;R++)P[R+_]=new qr({func:d.GEQUAL,mask:255},R+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=E,[P,y]}return[{[_]:qr.disabled},y]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new _r([l.CONSTANT_COLOR,l.ONE],new o.aO(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?_r.unblended:_r.alphaBlended}depthModeForSublayer(l,d,y){if(!this.opaquePassEnabledForLayer())return vr.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new vr(y||this.context.gl.LEQUAL,d,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,d){this.style=l,this.options=d,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(b.now()),this.imageManager.beginFrame();const y=this.style._order,_=this.style.sourceCaches,E={},P={},R={};for(const g in _){const w=_[g];w.used&&w.prepare(this.context),E[g]=w.getVisibleCoordinates(),P[g]=E[g].slice().reverse(),R[g]=w.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let g=0;g<y.length;g++)if(this.style._layers[y[g]].is3D()){this.opaquePassCutoff=g;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const g of y){const w=this.style._layers[g];if(!w.hasOffscreenPass()||w.isHidden(this.transform.zoom))continue;const T=P[w.source];(w.type==="custom"||T.length)&&this.renderLayer(this,_[w.source],w,T)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?o.aO.black:o.aO.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const g=this.style._layers[y[this.currentLayer]],w=_[g.source],T=E[g.source];this._renderTileClippingMasks(g,T),this.renderLayer(this,w,g,T)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const g=this.style._layers[y[this.currentLayer]],w=_[g.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(g))continue;const T=(g.type==="symbol"?R:P)[g.source];this._renderTileClippingMasks(g,E[g.source]),this.renderLayer(this,w,g,T)}if(this.options.showTileBoundaries){const g=function(w,T){let L=null;const D=Object.values(w._layers).flatMap(V=>V.source&&!V.isHidden(T)?[w.sourceCaches[V.source]]:[]),H=D.filter(V=>V.getSource().type==="vector"),z=D.filter(V=>V.getSource().type!=="vector"),j=V=>{(!L||L.getSource().maxzoom<V.getSource().maxzoom)&&(L=V)};return H.forEach(V=>j(V)),L||z.forEach(V=>j(V)),L}(this.style,this.transform.zoom);g&&function(w,T,L){for(let D=0;D<L.length;D++)Zu(w,T,L[D])}(this,g,g.getVisibleCoordinates())}this.options.showPadding&&function(g){const w=g.transform.padding;Wn(g,g.transform.height-(w.top||0),3,gl),Wn(g,w.bottom||0,3,Cc),Vi(g,w.left||0,3,_s),Vi(g,g.transform.width-(w.right||0),3,hd);const T=g.transform.centerPoint;(function(L,D,H,z){Ui(L,D-1,H-10,2,20,z),Ui(L,D-10,H-1,20,2,z)})(g,T.x,g.transform.height-T.y,cu)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(l){if(!this.style||!this.style.map||!this.style.map.terrain)return;const d=this.terrainFacilitator.matrix,y=this.transform.projMatrix;let _=this.terrainFacilitator.dirty;_||(_=l?!o.aY(d,y):!o.aZ(d,y)),_||(_=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),_&&(o.a_(d,y),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(E,P){const R=E.context,g=R.gl,w=_r.unblended,T=new vr(g.LEQUAL,vr.ReadWrite,[0,1]),L=P.getTerrainMesh(),D=P.sourceCache.getRenderableTiles(),H=E.useProgram("terrainDepth");R.bindFramebuffer.set(P.getFramebuffer("depth").framebuffer),R.viewport.set([0,0,E.width/devicePixelRatio,E.height/devicePixelRatio]),R.clear({color:o.aO.transparent,depth:1});for(const z of D){const j=P.getTerrainData(z.tileID),V={u_matrix:E.transform.calculatePosMatrix(z.tileID.toUnwrapped()),u_ele_delta:P.getMeshFrameDelta(E.transform.zoom)};H.draw(R,g.TRIANGLES,T,qr.disabled,w,$r.backCCW,V,j,"terrain",L.vertexBuffer,L.indexBuffer,L.segments)}R.bindFramebuffer.set(null),R.viewport.set([0,0,E.width,E.height])}(this,this.style.map.terrain),function(E,P){const R=E.context,g=R.gl,w=_r.unblended,T=new vr(g.LEQUAL,vr.ReadWrite,[0,1]),L=P.getTerrainMesh(),D=P.getCoordsTexture(),H=P.sourceCache.getRenderableTiles(),z=E.useProgram("terrainCoords");R.bindFramebuffer.set(P.getFramebuffer("coords").framebuffer),R.viewport.set([0,0,E.width/devicePixelRatio,E.height/devicePixelRatio]),R.clear({color:o.aO.transparent,depth:1}),P.coordsIndex=[];for(const j of H){const V=P.getTerrainData(j.tileID);R.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,D.texture);const $={u_matrix:E.transform.calculatePosMatrix(j.tileID.toUnwrapped()),u_terrain_coords_id:(255-P.coordsIndex.length)/255,u_texture:0,u_ele_delta:P.getMeshFrameDelta(E.transform.zoom)};z.draw(R,g.TRIANGLES,T,qr.disabled,w,$r.backCCW,$,V,"terrain",L.vertexBuffer,L.indexBuffer,L.segments),P.coordsIndex.push(j.tileID.key)}R.bindFramebuffer.set(null),R.viewport.set([0,0,E.width,E.height])}(this,this.style.map.terrain))}renderLayer(l,d,y,_){if(!y.isHidden(this.transform.zoom)&&(y.type==="background"||y.type==="custom"||(_||[]).length))switch(this.id=y.id,y.type){case"symbol":(function(E,P,R,g,w){if(E.renderPass!=="translucent")return;const T=qr.disabled,L=E.colorModeForRenderPass();(R._unevaluatedLayout.hasValue("text-variable-anchor")||R._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(D,H,z,j,V,$,lt){const rt=H.transform,ht=V==="map",gt=$==="map";for(const Pt of D){const Tt=j.getTile(Pt),_t=Tt.getBucket(z);if(!_t||!_t.text||!_t.text.segments.get().length)continue;const bt=o.ag(_t.textSizeData,rt.zoom),Gt=cr(Tt,1,H.transform.zoom),$t=pr(Pt.posMatrix,gt,ht,H.transform,Gt),ue=z.layout.get("icon-text-fit")!=="none"&&_t.hasIconData();if(bt){const Ae=Math.pow(2,rt.zoom-Tt.tileID.overscaledZ);dl(_t,ht,gt,lt,rt,$t,Pt.posMatrix,Ae,bt,ue,H.style.map.terrain?(ye,Re)=>H.style.map.terrain.getElevation(Pt,ye,Re):null)}}}(g,E,R,P,R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),w),R.paint.get("icon-opacity").constantOr(1)!==0&&wc(E,P,R,g,!1,R.paint.get("icon-translate"),R.paint.get("icon-translate-anchor"),R.layout.get("icon-rotation-alignment"),R.layout.get("icon-pitch-alignment"),R.layout.get("icon-keep-upright"),T,L),R.paint.get("text-opacity").constantOr(1)!==0&&wc(E,P,R,g,!0,R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),R.layout.get("text-keep-upright"),T,L),P.map.showCollisionBoxes&&(Ds(E,P,R,g,R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),!0),Ds(E,P,R,g,R.paint.get("icon-translate"),R.paint.get("icon-translate-anchor"),!1))})(l,d,y,_,this.style.placement.variableOffsets);break;case"circle":(function(E,P,R,g){if(E.renderPass!=="translucent")return;const w=R.paint.get("circle-opacity"),T=R.paint.get("circle-stroke-width"),L=R.paint.get("circle-stroke-opacity"),D=!R.layout.get("circle-sort-key").isConstant();if(w.constantOr(1)===0&&(T.constantOr(1)===0||L.constantOr(1)===0))return;const H=E.context,z=H.gl,j=E.depthModeForSublayer(0,vr.ReadOnly),V=qr.disabled,$=E.colorModeForRenderPass(),lt=[];for(let rt=0;rt<g.length;rt++){const ht=g[rt],gt=P.getTile(ht),Pt=gt.getBucket(R);if(!Pt)continue;const Tt=Pt.programConfigurations.get(R.id),_t=E.useProgram("circle",Tt),bt=Pt.layoutVertexBuffer,Gt=Pt.indexBuffer,$t=E.style.map.terrain&&E.style.map.terrain.getTerrainData(ht),ue={programConfiguration:Tt,program:_t,layoutVertexBuffer:bt,indexBuffer:Gt,uniformValues:Hr(E,ht,gt,R),terrainData:$t};if(D){const Ae=Pt.segments.get();for(const ye of Ae)lt.push({segments:new o.$([ye]),sortKey:ye.sortKey,state:ue})}else lt.push({segments:Pt.segments,sortKey:0,state:ue})}D&&lt.sort((rt,ht)=>rt.sortKey-ht.sortKey);for(const rt of lt){const{programConfiguration:ht,program:gt,layoutVertexBuffer:Pt,indexBuffer:Tt,uniformValues:_t,terrainData:bt}=rt.state;gt.draw(H,z.TRIANGLES,j,V,$,$r.disabled,_t,bt,R.id,Pt,Tt,rt.segments,R.paint,E.transform.zoom,ht)}})(l,d,y,_);break;case"heatmap":(function(E,P,R,g){if(R.paint.get("heatmap-opacity")!==0)if(E.renderPass==="offscreen"){const w=E.context,T=w.gl,L=qr.disabled,D=new _r([T.ONE,T.ONE],o.aO.transparent,[!0,!0,!0,!0]);(function(H,z,j){const V=H.gl;H.activeTexture.set(V.TEXTURE1),H.viewport.set([0,0,z.width/4,z.height/4]);let $=j.heatmapFbo;if($)V.bindTexture(V.TEXTURE_2D,$.colorAttachment.get()),H.bindFramebuffer.set($.framebuffer);else{const lt=V.createTexture();V.bindTexture(V.TEXTURE_2D,lt),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_T,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,V.LINEAR),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,V.LINEAR),$=j.heatmapFbo=H.createFramebuffer(z.width/4,z.height/4,!1,!1),function(rt,ht,gt,Pt){var Tt,_t;const bt=rt.gl,Gt=(Tt=rt.HALF_FLOAT)!==null&&Tt!==void 0?Tt:bt.UNSIGNED_BYTE,$t=(_t=rt.RGBA16F)!==null&&_t!==void 0?_t:bt.RGBA;bt.texImage2D(bt.TEXTURE_2D,0,$t,ht.width/4,ht.height/4,0,bt.RGBA,Gt,null),Pt.colorAttachment.set(gt)}(H,z,lt,$)}})(w,E,R),w.clear({color:o.aO.transparent});for(let H=0;H<g.length;H++){const z=g[H];if(P.hasRenderableParent(z))continue;const j=P.getTile(z),V=j.getBucket(R);if(!V)continue;const $=V.programConfigurations.get(R.id),lt=E.useProgram("heatmap",$),{zoom:rt}=E.transform;lt.draw(w,T.TRIANGLES,vr.disabled,L,D,$r.disabled,kn(z.posMatrix,j,rt,R.paint.get("heatmap-intensity")),null,R.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,R.paint,E.transform.zoom,$)}w.viewport.set([0,0,E.width,E.height])}else E.renderPass==="translucent"&&(E.context.setColorMode(E.colorModeForRenderPass()),function(w,T){const L=w.context,D=L.gl,H=T.heatmapFbo;if(!H)return;L.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,H.colorAttachment.get()),L.activeTexture.set(D.TEXTURE1);let z=T.colorRampTexture;z||(z=T.colorRampTexture=new st(L,T.colorRamp,D.RGBA)),z.bind(D.LINEAR,D.CLAMP_TO_EDGE),w.useProgram("heatmapTexture").draw(L,D.TRIANGLES,vr.disabled,qr.disabled,w.colorModeForRenderPass(),$r.disabled,((j,V,$,lt)=>{const rt=o.F();o.aN(rt,0,j.width,j.height,0,0,1);const ht=j.context.gl;return{u_matrix:rt,u_world:[ht.drawingBufferWidth,ht.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:V.paint.get("heatmap-opacity")}})(w,T),null,T.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,T.paint,w.transform.zoom)}(E,R))})(l,d,y,_);break;case"line":(function(E,P,R,g){if(E.renderPass!=="translucent")return;const w=R.paint.get("line-opacity"),T=R.paint.get("line-width");if(w.constantOr(1)===0||T.constantOr(1)===0)return;const L=E.depthModeForSublayer(0,vr.ReadOnly),D=E.colorModeForRenderPass(),H=R.paint.get("line-dasharray"),z=R.paint.get("line-pattern"),j=z.constantOr(1),V=R.paint.get("line-gradient"),$=R.getCrossfadeParameters(),lt=j?"linePattern":H?"lineSDF":V?"lineGradient":"line",rt=E.context,ht=rt.gl;let gt=!0;for(const Pt of g){const Tt=P.getTile(Pt);if(j&&!Tt.patternsLoaded())continue;const _t=Tt.getBucket(R);if(!_t)continue;const bt=_t.programConfigurations.get(R.id),Gt=E.context.program.get(),$t=E.useProgram(lt,bt),ue=gt||$t.program!==Gt,Ae=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Pt),ye=z.constantOr(null);if(ye&&Tt.imageAtlas){const We=Tt.imageAtlas,rr=We.patternPositions[ye.to.toString()],er=We.patternPositions[ye.from.toString()];rr&&er&&bt.setConstantPatternPositions(rr,er)}const Re=Ae?Pt:null,Ce=j?Na(E,Tt,R,$,Re):H?tu(E,Tt,R,H,$,Re):V?Gr(E,Tt,R,_t.lineClipsArray.length,Re):ol(E,Tt,R,Re);if(j)rt.activeTexture.set(ht.TEXTURE0),Tt.imageAtlasTexture.bind(ht.LINEAR,ht.CLAMP_TO_EDGE),bt.updatePaintBuffers($);else if(H&&(ue||E.lineAtlas.dirty))rt.activeTexture.set(ht.TEXTURE0),E.lineAtlas.bind(rt);else if(V){const We=_t.gradients[R.id];let rr=We.texture;if(R.gradientVersion!==We.version){let er=256;if(R.stepInterpolant){const Er=P.getSource().maxzoom,Lr=Pt.canonical.z===Er?Math.ceil(1<<E.transform.maxZoom-Pt.canonical.z):1;er=o.ac(o.aT(_t.maxLineLength/o.W*1024*Lr),256,rt.maxTextureSize)}We.gradient=o.aU({expression:R.gradientExpression(),evaluationKey:"lineProgress",resolution:er,image:We.gradient||void 0,clips:_t.lineClipsArray}),We.texture?We.texture.update(We.gradient):We.texture=new st(rt,We.gradient,ht.RGBA),We.version=R.gradientVersion,rr=We.texture}rt.activeTexture.set(ht.TEXTURE0),rr.bind(R.stepInterpolant?ht.NEAREST:ht.LINEAR,ht.CLAMP_TO_EDGE)}$t.draw(rt,ht.TRIANGLES,L,E.stencilModeForClipping(Pt),D,$r.disabled,Ce,Ae,R.id,_t.layoutVertexBuffer,_t.indexBuffer,_t.segments,R.paint,E.transform.zoom,bt,_t.layoutVertexBuffer2),gt=!1}})(l,d,y,_);break;case"fill":(function(E,P,R,g){const w=R.paint.get("fill-color"),T=R.paint.get("fill-opacity");if(T.constantOr(1)===0)return;const L=E.colorModeForRenderPass(),D=R.paint.get("fill-pattern"),H=E.opaquePassEnabledForLayer()&&!D.constantOr(1)&&w.constantOr(o.aO.transparent).a===1&&T.constantOr(0)===1?"opaque":"translucent";if(E.renderPass===H){const z=E.depthModeForSublayer(1,E.renderPass==="opaque"?vr.ReadWrite:vr.ReadOnly);au(E,P,R,g,z,L,!1)}if(E.renderPass==="translucent"&&R.paint.get("fill-antialias")){const z=E.depthModeForSublayer(R.getPaintProperty("fill-outline-color")?2:0,vr.ReadOnly);au(E,P,R,g,z,L,!0)}})(l,d,y,_);break;case"fill-extrusion":(function(E,P,R,g){const w=R.paint.get("fill-extrusion-opacity");if(w!==0&&E.renderPass==="translucent"){const T=new vr(E.context.gl.LEQUAL,vr.ReadWrite,E.depthRangeFor3D);if(w!==1||R.paint.get("fill-extrusion-pattern").constantOr(1))za(E,P,R,g,T,qr.disabled,_r.disabled),za(E,P,R,g,T,E.stencilModeFor3D(),E.colorModeForRenderPass());else{const L=E.colorModeForRenderPass();za(E,P,R,g,T,qr.disabled,L)}}})(l,d,y,_);break;case"hillshade":(function(E,P,R,g){if(E.renderPass!=="offscreen"&&E.renderPass!=="translucent")return;const w=E.context,T=E.depthModeForSublayer(0,vr.ReadOnly),L=E.colorModeForRenderPass(),[D,H]=E.renderPass==="translucent"?E.stencilConfigForOverlap(g):[{},g];for(const z of H){const j=P.getTile(z);j.needsHillshadePrepare!==void 0&&j.needsHillshadePrepare&&E.renderPass==="offscreen"?Bc(E,j,R,T,qr.disabled,L):E.renderPass==="translucent"&&as(E,z,j,R,T,D[z.overscaledZ],L)}w.viewport.set([0,0,E.width,E.height])})(l,d,y,_);break;case"raster":(function(E,P,R,g){if(E.renderPass!=="translucent"||R.paint.get("raster-opacity")===0||!g.length)return;const w=E.context,T=w.gl,L=P.getSource(),D=E.useProgram("raster"),H=E.colorModeForRenderPass(),[z,j]=L instanceof xe?[{},g]:E.stencilConfigForOverlap(g),V=j[j.length-1].overscaledZ,$=!E.options.moving;for(const lt of j){const rt=E.depthModeForSublayer(lt.overscaledZ-V,R.paint.get("raster-opacity")===1?vr.ReadWrite:vr.ReadOnly,T.LESS),ht=P.getTile(lt);ht.registerFadeDuration(R.paint.get("raster-fade-duration"));const gt=P.findLoadedParent(lt,0),Pt=pl(ht,gt,P,R,E.transform,E.style.map.terrain);let Tt,_t;const bt=R.paint.get("raster-resampling")==="nearest"?T.NEAREST:T.LINEAR;w.activeTexture.set(T.TEXTURE0),ht.texture.bind(bt,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST),w.activeTexture.set(T.TEXTURE1),gt?(gt.texture.bind(bt,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST),Tt=Math.pow(2,gt.tileID.overscaledZ-ht.tileID.overscaledZ),_t=[ht.tileID.canonical.x*Tt%1,ht.tileID.canonical.y*Tt%1]):ht.texture.bind(bt,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST);const Gt=E.style.map.terrain&&E.style.map.terrain.getTerrainData(lt),$t=Gt?lt:null,ue=$t?$t.posMatrix:E.transform.calculatePosMatrix(lt.toUnwrapped(),$),Ae=al(ue,_t||[0,0],Tt||1,Pt,R);L instanceof xe?D.draw(w,T.TRIANGLES,rt,qr.disabled,H,$r.disabled,Ae,Gt,R.id,L.boundsBuffer,E.quadTriangleIndexBuffer,L.boundsSegments):D.draw(w,T.TRIANGLES,rt,z[lt.overscaledZ],H,$r.disabled,Ae,Gt,R.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments)}})(l,d,y,_);break;case"background":(function(E,P,R,g){const w=R.paint.get("background-color"),T=R.paint.get("background-opacity");if(T===0)return;const L=E.context,D=L.gl,H=E.transform,z=H.tileSize,j=R.paint.get("background-pattern");if(E.isPatternMissing(j))return;const V=!j&&w.a===1&&T===1&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass!==V)return;const $=qr.disabled,lt=E.depthModeForSublayer(0,V==="opaque"?vr.ReadWrite:vr.ReadOnly),rt=E.colorModeForRenderPass(),ht=E.useProgram(j?"backgroundPattern":"background"),gt=g||H.coveringTiles({tileSize:z,terrain:E.style.map.terrain});j&&(L.activeTexture.set(D.TEXTURE0),E.imageManager.bind(E.context));const Pt=R.getCrossfadeParameters();for(const Tt of gt){const _t=g?Tt.posMatrix:E.transform.calculatePosMatrix(Tt.toUnwrapped()),bt=j?Wu(_t,T,E,j,{tileID:Tt,tileSize:z},Pt):ud(_t,T,w),Gt=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Tt);ht.draw(L,D.TRIANGLES,lt,$,rt,$r.disabled,bt,Gt,R.id,E.tileExtentBuffer,E.quadTriangleIndexBuffer,E.tileExtentSegments)}})(l,0,y,_);break;case"custom":(function(E,P,R){const g=E.context,w=R.implementation;if(E.renderPass==="offscreen"){const T=w.prerender;T&&(E.setCustomLayerDefaults(),g.setColorMode(E.colorModeForRenderPass()),T.call(w,g.gl,E.transform.customLayerMatrix()),g.setDirty(),E.setBaseState())}else if(E.renderPass==="translucent"){E.setCustomLayerDefaults(),g.setColorMode(E.colorModeForRenderPass()),g.setStencilMode(qr.disabled);const T=w.renderingMode==="3d"?new vr(E.context.gl.LEQUAL,vr.ReadWrite,E.depthRangeFor3D):E.depthModeForSublayer(0,vr.ReadOnly);g.setDepthMode(T),w.render(g.gl,E.transform.customLayerMatrix()),g.setDirty(),E.setBaseState(),g.bindFramebuffer.set(null)}})(l,0,y)}}translatePosMatrix(l,d,y,_,E){if(!y[0]&&!y[1])return l;const P=E?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(P){const w=Math.sin(P),T=Math.cos(P);y=[y[0]*T-y[1]*w,y[0]*w+y[1]*T]}const R=[E?y[0]:cr(d,y[0],this.transform.zoom),E?y[1]:cr(d,y[1],this.transform.zoom),0],g=new Float32Array(16);return o.H(g,l,R),g}saveTileTexture(l){const d=this._tileTextures[l.size[0]];d?d.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const d=this._tileTextures[l];return d&&d.length>0?d.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;const d=this.imageManager.getPattern(l.from.toString()),y=this.imageManager.getPattern(l.to.toString());return!d||!y}useProgram(l,d){this.cache=this.cache||{};const y=l+(d?d.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[y]||(this.cache[y]=new Ys(this.context,Ti[l],d,pc[l],this._showOverdrawInspector,this.style.map.terrain)),this.cache[y]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new st(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:l,drawingBufferHeight:d}=this.context.gl;return this.width!==l||this.height!==d}}class Ri{constructor(l,d){this.points=l,this.planes=d}static fromInvProjectionMatrix(l,d,y){const _=Math.pow(2,y),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(R=>{const g=1/(R=o.af([],R,l))[3]/d*_;return o.a$(R,R,[g,g,1/R[3],g])}),P=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(R=>{const g=function(D,H){var z=H[0],j=H[1],V=H[2],$=z*z+j*j+V*V;return $>0&&($=1/Math.sqrt($)),D[0]=H[0]*$,D[1]=H[1]*$,D[2]=H[2]*$,D}([],function(D,H,z){var j=H[0],V=H[1],$=H[2],lt=z[0],rt=z[1],ht=z[2];return D[0]=V*ht-$*rt,D[1]=$*lt-j*ht,D[2]=j*rt-V*lt,D}([],dt([],E[R[0]],E[R[1]]),dt([],E[R[2]],E[R[1]]))),w=-((T=g)[0]*(L=E[R[1]])[0]+T[1]*L[1]+T[2]*L[2]);var T,L;return g.concat(w)});return new Ri(E,P)}}class ji{constructor(l,d){this.min=l,this.max=d,this.center=function(y,_,E){return y[0]=.5*_[0],y[1]=.5*_[1],y[2]=.5*_[2],y}([],function(y,_,E){return y[0]=_[0]+E[0],y[1]=_[1]+E[1],y[2]=_[2]+E[2],y}([],this.min,this.max))}quadrant(l){const d=[l%2==0,l<2],y=pt(this.min),_=pt(this.max);for(let E=0;E<d.length;E++)y[E]=d[E]?this.min[E]:this.center[E],_[E]=d[E]?this.center[E]:this.max[E];return _[2]=this.max[2],new ji(y,_)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}intersects(l){const d=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let y=!0;for(let _=0;_<l.planes.length;_++){const E=l.planes[_];let P=0;for(let R=0;R<d.length;R++)o.b0(E,d[R])>=0&&P++;if(P===0)return 0;P!==d.length&&(y=!1)}if(y)return 2;for(let _=0;_<3;_++){let E=Number.MAX_VALUE,P=-Number.MAX_VALUE;for(let R=0;R<l.points.length;R++){const g=l.points[R][_]-this.min[_];E=Math.min(E,g),P=Math.max(P,g)}if(P<0||E>this.max[_]-this.min[_])return 0}return 1}}class Js{constructor(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,_=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(isNaN(l)||l<0||isNaN(d)||d<0||isNaN(y)||y<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=d,this.left=y,this.right=_}interpolate(l,d,y){return d.top!=null&&l.top!=null&&(this.top=o.z.number(l.top,d.top,y)),d.bottom!=null&&l.bottom!=null&&(this.bottom=o.z.number(l.bottom,d.bottom,y)),d.left!=null&&l.left!=null&&(this.left=o.z.number(l.left,d.left,y)),d.right!=null&&l.right!=null&&(this.right=o.z.number(l.right,d.right,y)),this}getCenter(l,d){const y=o.ac((this.left+l-this.right)/2,0,l),_=o.ac((this.top+d-this.bottom)/2,0,d);return new o.P(y,_)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new Js(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const vo=85.051129;class bo{constructor(l,d,y,_,E){this.tileSize=512,this._renderWorldCopies=E===void 0||!!E,this._minZoom=l||0,this._maxZoom=d||22,this._minPitch=y??0,this._maxPitch=_??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Js,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const l=new bo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.apply(this),l}apply(l){this.tileSize=l.tileSize,this.latRange=l.latRange,this.width=l.width,this.height=l.height,this._center=l._center,this._elevation=l._elevation,this.minElevationForCurrentTile=l.minElevationForCurrentTile,this.zoom=l.zoom,this.angle=l.angle,this._fov=l._fov,this._pitch=l._pitch,this._unmodified=l._unmodified,this._edgeInsets=l._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(l){const d=-o.b1(l,-180,180)*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=function(){var y=new o.A(4);return o.A!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y}(),function(y,_,E){var P=_[0],R=_[1],g=_[2],w=_[3],T=Math.sin(E),L=Math.cos(E);y[0]=P*L+g*T,y[1]=R*L+w*T,y[2]=P*-T+g*L,y[3]=R*-T+w*L}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const d=o.ac(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(l){const d=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.tileZoom=Math.max(0,Math.floor(d)),this.scale=this.zoomScale(d),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(l){l!==this._elevation&&(this._elevation=l,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,d,y){this._unmodified=!1,this._edgeInsets.interpolate(l,d,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const d=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(l){const d=[new o.b2(0,l)];if(this._renderWorldCopies){const y=this.pointCoordinate(new o.P(0,0)),_=this.pointCoordinate(new o.P(this.width,0)),E=this.pointCoordinate(new o.P(this.width,this.height)),P=this.pointCoordinate(new o.P(0,this.height)),R=Math.floor(Math.min(y.x,_.x,E.x,P.x)),g=Math.floor(Math.max(y.x,_.x,E.x,P.x)),w=1;for(let T=R-w;T<=g+w;T++)T!==0&&d.push(new o.b2(T,l))}return d}coveringTiles(l){var d,y;let _=this.coveringZoomLevel(l);const E=_;if(l.minzoom!==void 0&&_<l.minzoom)return[];l.maxzoom!==void 0&&_>l.maxzoom&&(_=l.maxzoom);const P=this.pointCoordinate(this.getCameraPoint()),R=o.Y.fromLngLat(this.center),g=Math.pow(2,_),w=[g*P.x,g*P.y,0],T=[g*R.x,g*R.y,0],L=Ri.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,_);let D=l.minzoom||0;!l.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(D=_);const H=l.terrain?2/Math.min(this.tileSize,l.tileSize)*this.tileSize:3,z=rt=>({aabb:new ji([rt*g,0,0],[(rt+1)*g,g,0]),zoom:0,x:0,y:0,wrap:rt,fullyVisible:!1}),j=[],V=[],$=_,lt=l.reparseOverscaled?E:_;if(this._renderWorldCopies)for(let rt=1;rt<=3;rt++)j.push(z(-rt)),j.push(z(rt));for(j.push(z(0));j.length>0;){const rt=j.pop(),ht=rt.x,gt=rt.y;let Pt=rt.fullyVisible;if(!Pt){const $t=rt.aabb.intersects(L);if($t===0)continue;Pt=$t===2}const Tt=l.terrain?w:T,_t=rt.aabb.distanceX(Tt),bt=rt.aabb.distanceY(Tt),Gt=Math.max(Math.abs(_t),Math.abs(bt));if(rt.zoom===$||Gt>H+(1<<$-rt.zoom)-2&&rt.zoom>=D){const $t=$-rt.zoom,ue=w[0]-.5-(ht<<$t),Ae=w[1]-.5-(gt<<$t);V.push({tileID:new o.Q(rt.zoom===$?lt:rt.zoom,rt.wrap,rt.zoom,ht,gt),distanceSq:Rt([T[0]-.5-ht,T[1]-.5-gt]),tileDistanceToCamera:Math.sqrt(ue*ue+Ae*Ae)})}else for(let $t=0;$t<4;$t++){const ue=(ht<<1)+$t%2,Ae=(gt<<1)+($t>>1),ye=rt.zoom+1;let Re=rt.aabb.quadrant($t);if(l.terrain){const Ce=new o.Q(ye,rt.wrap,ye,ue,Ae),We=l.terrain.getMinMaxElevation(Ce),rr=(d=We.minElevation)!==null&&d!==void 0?d:this.elevation,er=(y=We.maxElevation)!==null&&y!==void 0?y:this.elevation;Re=new ji([Re.min[0],Re.min[1],rr],[Re.max[0],Re.max[1],er])}j.push({aabb:Re,zoom:ye,x:ue,y:Ae,wrap:rt.wrap,fullyVisible:Pt})}}return V.sort((rt,ht)=>rt.distanceSq-ht.distanceSq).map(rt=>rt.tileID)}resize(l,d){this.width=l,this.height=d,this.pixelsToGLUnits=[2/l,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const d=o.ac(l.lat,-85.051129,vo);return new o.P(o.N(l.lng)*this.worldSize,o.O(d)*this.worldSize)}unproject(l){return new o.Y(l.x/this.worldSize,l.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(l){const d=this.elevation,y=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,_=this.pointLocation(this.centerPoint,l),E=l.getElevationForLngLatZoom(_,this.tileZoom);if(!(this.elevation-E))return;const P=y+d-E,R=Math.cos(this._pitch)*this.cameraToCenterDistance/P/o.b3(1,_.lat),g=this.scaleZoom(R/this.tileSize);this._elevation=E,this._center=_,this.zoom=g}setLocationAtPoint(l,d){const y=this.pointCoordinate(d),_=this.pointCoordinate(this.centerPoint),E=this.locationCoordinate(l),P=new o.Y(E.x-(y.x-_.x),E.y-(y.y-_.y));this.center=this.coordinateLocation(P),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(l,d){return d?this.coordinatePoint(this.locationCoordinate(l),d.getElevationForLngLatZoom(l,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(l))}pointLocation(l,d){return this.coordinateLocation(this.pointCoordinate(l,d))}locationCoordinate(l){return o.Y.fromLngLat(l)}coordinateLocation(l){return l&&l.toLngLat()}pointCoordinate(l,d){if(d){const D=d.pointCoordinate(l);if(D!=null)return D}const y=[l.x,l.y,0,1],_=[l.x,l.y,1,1];o.af(y,y,this.pixelMatrixInverse),o.af(_,_,this.pixelMatrixInverse);const E=y[3],P=_[3],R=y[1]/E,g=_[1]/P,w=y[2]/E,T=_[2]/P,L=w===T?0:(0-w)/(T-w);return new o.Y(o.z.number(y[0]/E,_[0]/P,L)/this.worldSize,o.z.number(R,g,L)/this.worldSize)}coordinatePoint(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.pixelMatrix;const _=[l.x*this.worldSize,l.y*this.worldSize,d,1];return o.af(_,_,y),new o.P(_[0]/_[3],_[1]/_[3])}getBounds(){const l=Math.max(0,this.height/2-this.getHorizon());return new He().extend(this.pointLocation(new o.P(0,l))).extend(this.pointLocation(new o.P(this.width,l))).extend(this.pointLocation(new o.P(this.width,this.height))).extend(this.pointLocation(new o.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new He([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,vo])}calculatePosMatrix(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=l.key,_=d?this._alignedPosMatrixCache:this._posMatrixCache;if(_[y])return _[y];const E=l.canonical,P=this.worldSize/this.zoomScale(E.z),R=E.x+Math.pow(2,E.z)*l.wrap,g=o.an(new Float64Array(16));return o.H(g,g,[R*P,E.y*P,0]),o.J(g,g,[P/o.W,P/o.W,1]),o.K(g,d?this.alignedProjMatrix:this.projMatrix,g),_[y]=new Float32Array(g),_[y]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(l,d){d=o.ac(+d,this.minZoom,this.maxZoom);const y={center:new o.M(l.lng,l.lat),zoom:d};let _=this.lngRange;if(!this._renderWorldCopies&&_===null){const rt=179.9999999999;_=[-rt,rt]}const E=this.tileSize*this.zoomScale(y.zoom);let P=0,R=E,g=0,w=E,T=0,L=0;const{x:D,y:H}=this.size;if(this.latRange){const rt=this.latRange;P=o.O(rt[1])*E,R=o.O(rt[0])*E,R-P<H&&(T=H/(R-P))}_&&(g=o.b1(o.N(_[0])*E,0,E),w=o.b1(o.N(_[1])*E,0,E),w<g&&(w+=E),w-g<D&&(L=D/(w-g)));const{x:z,y:j}=this.project.call({worldSize:E},l);let V,$;const lt=Math.max(L||0,T||0);if(lt){const rt=new o.P(L?(w+g)/2:z,T?(R+P)/2:j);return y.center=this.unproject.call({worldSize:E},rt).wrap(),y.zoom+=this.scaleZoom(lt),y}if(this.latRange){const rt=H/2;j-rt<P&&($=P+rt),j+rt>R&&($=R-rt)}if(_){const rt=(g+w)/2;let ht=z;this._renderWorldCopies&&(ht=o.b1(z,rt-E/2,rt+E/2));const gt=D/2;ht-gt<g&&(V=g+gt),ht+gt>w&&(V=w-gt)}if(V!==void 0||$!==void 0){const rt=new o.P(V??z,$??j);y.center=this.unproject.call({worldSize:E},rt).wrap()}return y}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const l=this._unmodified,{center:d,zoom:y}=this.getConstrained(this.center,this.zoom);this.center=d,this.zoom=y,this._unmodified=l,this._constraining=!1}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,d=this.point.x,y=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=o.b3(1,this.center.lat)*this.worldSize;let _=o.an(new Float64Array(16));o.J(_,_,[this.width/2,-this.height/2,1]),o.H(_,_,[1,-1,0]),this.labelPlaneMatrix=_,_=o.an(new Float64Array(16)),o.J(_,_,[1,-1,1]),o.H(_,_,[-1,-1,0]),o.J(_,_,[2/this.width,2/this.height,1]),this.glCoordMatrix=_;const E=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),P=Math.min(this.elevation,this.minElevationForCurrentTile),R=E-P*this._pixelPerMeter/Math.cos(this._pitch),g=P<0?R:E,w=Math.PI/2+this._pitch,T=this._fov*(.5+l.y/this.height),L=Math.sin(T)*g/Math.sin(o.ac(Math.PI-w-T,.01,Math.PI-.01)),D=this.getHorizon(),H=2*Math.atan(D/this.cameraToCenterDistance)*(.5+l.y/(2*D)),z=Math.sin(H)*g/Math.sin(o.ac(Math.PI-w-H,.01,Math.PI-.01)),j=Math.min(L,z),V=1.01*(Math.cos(Math.PI/2-this._pitch)*j+g),$=this.height/50;_=new Float64Array(16),o.b4(_,this._fov,this.width/this.height,$,V),_[8]=2*-l.x/this.width,_[9]=2*l.y/this.height,o.J(_,_,[1,-1,1]),o.H(_,_,[0,0,-this.cameraToCenterDistance]),o.b5(_,_,this._pitch),o.ad(_,_,this.angle),o.H(_,_,[-d,-y,0]),this.mercatorMatrix=o.J([],_,[this.worldSize,this.worldSize,this.worldSize]),o.J(_,_,[1,1,this._pixelPerMeter]),this.pixelMatrix=o.K(new Float64Array(16),this.labelPlaneMatrix,_),o.H(_,_,[0,0,-this.elevation]),this.projMatrix=_,this.invProjMatrix=o.ar([],_),this.pixelMatrix3D=o.K(new Float64Array(16),this.labelPlaneMatrix,_);const lt=this.width%2/2,rt=this.height%2/2,ht=Math.cos(this.angle),gt=Math.sin(this.angle),Pt=d-Math.round(d)+ht*lt+gt*rt,Tt=y-Math.round(y)+ht*rt+gt*lt,_t=new Float64Array(_);if(o.H(_t,_t,[Pt>.5?Pt-1:Pt,Tt>.5?Tt-1:Tt,0]),this.alignedProjMatrix=_t,_=o.ar(new Float64Array(16),this.pixelMatrix),!_)throw new Error("failed to invert matrix");this.pixelMatrixInverse=_,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const l=this.pointCoordinate(new o.P(0,0)),d=[l.x*this.worldSize,l.y*this.worldSize,0,1];return o.af(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,l))}getCameraQueryGeometry(l){const d=this.getCameraPoint();if(l.length===1)return[l[0],d];{let y=d.x,_=d.y,E=d.x,P=d.y;for(const R of l)y=Math.min(y,R.x),_=Math.min(_,R.y),E=Math.max(E,R.x),P=Math.max(P,R.y);return[new o.P(y,_),new o.P(E,_),new o.P(E,P),new o.P(y,P),new o.P(y,_)]}}lngLatToCameraDepth(l,d){const y=this.locationCoordinate(l),_=[y.x*this.worldSize,y.y*this.worldSize,d,1];return o.af(_,_,this.projMatrix),_[2]/_[3]}}function Ec(B,l){var d=this;let y,_=!1,E=null,P=null;const R=()=>{E=null,_&&(B.apply(P,y),E=setTimeout(R,l),_=!1)};return function(){for(var g=arguments.length,w=new Array(g),T=0;T<g;T++)w[T]=arguments[T];return _=!0,P=d,y=w,E||R(),E}}class Zs{constructor(l){this._getCurrentHash=()=>{const d=window.location.hash.replace("#","");if(this._hashName){let y;return d.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(y=_)}),(y&&y[1]||"").split("/")}return d.split("/")},this._onHashChange=()=>{const d=this._getCurrentHash();if(d.length>=3&&!d.some(y=>isNaN(y))){const y=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:y,pitch:+(d[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const d=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,d)}catch{}},this._updateHash=Ec(this._updateHashUnthrottled,300),this._hashName=l&&encodeURIComponent(l)}addTo(l){return this._map=l,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(l){const d=this._map.getCenter(),y=Math.round(100*this._map.getZoom())/100,_=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,_),P=Math.round(d.lng*E)/E,R=Math.round(d.lat*E)/E,g=this._map.getBearing(),w=this._map.getPitch();let T="";if(T+=l?`/${P}/${R}/${y}`:`${y}/${R}/${P}`,(g||w)&&(T+="/"+Math.round(10*g)/10),w&&(T+=`/${Math.round(w)}`),this._hashName){const L=this._hashName;let D=!1;const H=window.location.hash.slice(1).split("&").map(z=>{const j=z.split("=")[0];return j===L?(D=!0,`${j}=${T}`):z}).filter(z=>z);return D||H.push(`${L}=${T}`),`#${H.join("&")}`}return`#${T}`}}const _a={linearity:.3,easing:o.b6(0,0,.3,1)},Wo=o.e({deceleration:2500,maxSpeed:1400},_a),Va=o.e({deceleration:20,maxSpeed:1400},_a),wo=o.e({deceleration:1e3,maxSpeed:360},_a),va=o.e({deceleration:1e3,maxSpeed:90},_a);class Sc{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:b.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,d=b.now();for(;l.length>0&&d-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)d.zoom+=E.zoomDelta||0,d.bearing+=E.bearingDelta||0,d.pitch+=E.pitchDelta||0,E.panDelta&&d.pan._add(E.panDelta),E.around&&(d.around=E.around),E.pinchAround&&(d.pinchAround=E.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(d.pan.mag()){const E=$o(d.pan.mag(),y,o.e({},Wo,l||{}));_.offset=d.pan.mult(E.amount/d.pan.mag()),_.center=this._map.transform.center,ba(_,E)}if(d.zoom){const E=$o(d.zoom,y,Va);_.zoom=this._map.transform.zoom+E.amount,ba(_,E)}if(d.bearing){const E=$o(d.bearing,y,wo);_.bearing=this._map.transform.bearing+o.ac(E.amount,-179,179),ba(_,E)}if(d.pitch){const E=$o(d.pitch,y,va);_.pitch=this._map.transform.pitch+E.amount,ba(_,E)}if(_.zoom||_.bearing){const E=d.pinchAround===void 0?d.around:d.pinchAround;_.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),o.e(_,{noMoveStart:!0})}}function ba(B,l){(!B.duration||B.duration<l.duration)&&(B.duration=l.duration,B.easing=l.easing)}function $o(B,l,d){const{maxSpeed:y,linearity:_,deceleration:E}=d,P=o.ac(B*_/(l/1e3),-y,y),R=Math.abs(P)/(E*_);return{easing:d.easing,duration:1e3*R,amount:P*(R/2)}}class Bi extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,y){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const E=x.mousePos(d.getCanvas(),y),P=d.unproject(E);super(l,o.e({point:E,lngLat:P,originalEvent:y},_)),this._defaultPrevented=!1,this.target=d}}class Ns extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,y){const _=l==="touchend"?y.changedTouches:y.touches,E=x.touchPos(d.getCanvasContainer(),_),P=E.map(g=>d.unproject(g)),R=E.reduce((g,w,T,L)=>g.add(w.div(L.length)),new o.P(0,0));super(l,{points:E,point:R,lngLats:P,lngLat:d.unproject(R),originalEvent:y}),this._defaultPrevented=!1}}class Qs extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,y){super(l,{originalEvent:y}),this._defaultPrevented=!1}}class Oi{constructor(l,d){this._map=l,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new Qs(l.type,this._map,l))}mousedown(l,d){return this._mousedownPos=d,this._firePreventable(new Bi(l.type,this._map,l))}mouseup(l){this._map.fire(new Bi(l.type,this._map,l))}click(l,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new Bi(l.type,this._map,l))}dblclick(l){return this._firePreventable(new Bi(l.type,this._map,l))}mouseover(l){this._map.fire(new Bi(l.type,this._map,l))}mouseout(l){this._map.fire(new Bi(l.type,this._map,l))}touchstart(l){return this._firePreventable(new Ns(l.type,this._map,l))}touchmove(l){this._map.fire(new Ns(l.type,this._map,l))}touchend(l){this._map.fire(new Ns(l.type,this._map,l))}touchcancel(l){this._map.fire(new Ns(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class _n{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(l){this._map.fire(new Bi(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Bi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._ignoreContextMenu||this._map.fire(new Bi(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class In{constructor(l){this._map=l}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(l){return this.transform.pointLocation(o.P.convert(l),this._map.terrain)}}class Ln{constructor(l,d){this._map=l,this._tr=new In(l),this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,d){this.isEnabled()&&l.shiftKey&&l.button===0&&(x.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(l,d){if(!this._active)return;const y=d;if(this._lastPos.equals(y)||!this._box&&y.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=y,this._box||(this._box=x.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",l));const E=Math.min(_.x,y.x),P=Math.max(_.x,y.x),R=Math.min(_.y,y.y),g=Math.max(_.y,y.y);x.setTransform(this._box,`translate(${E}px,${R}px)`),this._box.style.width=P-E+"px",this._box.style.height=g-R+"px"}mouseupWindow(l,d){if(!this._active||l.button!==0)return;const y=this._startPos,_=d;if(this.reset(),x.suppressClick(),y.x!==_.x||y.y!==_.y)return this._map.fire(new o.k("boxzoomend",{originalEvent:l})),{cameraAnimation:E=>E.fitScreenCoordinates(y,_,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",l)}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(x.remove(this._box),this._box=null),x.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,d){return this._map.fire(new o.k(l,{originalEvent:d}))}}function Zn(B,l){if(B.length!==l.length)throw new Error(`The number of touches and points are not equal - touches ${B.length}, points ${l.length}`);const d={};for(let y=0;y<B.length;y++)d[B[y].identifier]=l[y];return d}class ja{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,d,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),y.length===this.numTouches&&(this.centroid=function(_){const E=new o.P(0,0);for(const P of _)E._add(P);return E.div(_.length)}(d),this.touches=Zn(y,d)))}touchmove(l,d,y){if(this.aborted||!this.centroid)return;const _=Zn(y,d);for(const E in this.touches){const P=_[E];(!P||P.dist(this.touches[E])>30)&&(this.aborted=!0)}}touchend(l,d,y){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class wa{constructor(l){this.singleTap=new ja(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,d,y){this.singleTap.touchstart(l,d,y)}touchmove(l,d,y){this.singleTap.touchmove(l,d,y)}touchend(l,d,y){const _=this.singleTap.touchend(l,d,y);if(_){const E=l.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(_)<30;if(E&&P||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class uu{constructor(l){this._tr=new In(l),this._zoomIn=new wa({numTouches:1,numTaps:2}),this._zoomOut=new wa({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,d,y){this._zoomIn.touchstart(l,d,y),this._zoomOut.touchstart(l,d,y)}touchmove(l,d,y){this._zoomIn.touchmove(l,d,y),this._zoomOut.touchmove(l,d,y)}touchend(l,d,y){const _=this._zoomIn.touchend(l,d,y),E=this._zoomOut.touchend(l,d,y),P=this._tr;return _?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:P.zoom+1,around:P.unproject(_)},{originalEvent:l})}):E?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:P.zoom-1,around:P.unproject(E)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qa{constructor(l){this._enabled=!!l.enable,this._moveStateManager=l.moveStateManager,this._clickTolerance=l.clickTolerance||1,this._moveFunction=l.move,this._activateOnStart=!!l.activateOnStart,l.assignEvents(this),this.reset()}reset(l){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(l)}_move(){const l=this._moveFunction(...arguments);if(l.bearingDelta||l.pitchDelta||l.around||l.panDelta)return this._active=!0,l}dragStart(l,d){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(l)&&(this._moveStateManager.startMove(l),this._lastPoint=d.length?d[0]:d,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(l,d){if(!this.isEnabled())return;const y=this._lastPoint;if(!y)return;if(l.preventDefault(),!this._moveStateManager.isValidMoveEvent(l))return void this.reset(l);const _=d.length?d[0]:d;return!this._moved&&_.dist(y)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=_,this._move(y,_))}dragEnd(l){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(l)&&(this._moved&&x.suppressClick(),this.reset(l))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Au={0:1,2:2};class Xo{constructor(l){this._correctEvent=l.checkCorrectEvent}startMove(l){const d=x.mouseButton(l);this._eventButton=d}endMove(l){delete this._eventButton}isValidStartEvent(l){return this._correctEvent(l)}isValidMoveEvent(l){return!function(d,y){const _=Au[y];return d.buttons===void 0||(d.buttons&_)!==_}(l,this._eventButton)}isValidEndEvent(l){return x.mouseButton(l)===this._eventButton}}class Ze{constructor(){this._firstTouch=void 0}_isOneFingerTouch(l){return l.targetTouches.length===1}_isSameTouchEvent(l){return l.targetTouches[0].identifier===this._firstTouch}startMove(l){this._firstTouch=l.targetTouches[0].identifier}endMove(l){delete this._firstTouch}isValidStartEvent(l){return this._isOneFingerTouch(l)}isValidMoveEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}isValidEndEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}}const tA=B=>{B.mousedown=B.dragStart,B.mousemoveWindow=B.dragMove,B.mouseup=B.dragEnd,B.contextmenu=function(l){l.preventDefault()}},ml=B=>{let{enable:l,clickTolerance:d,bearingDegreesPerPixelMoved:y=.8}=B;const _=new Xo({checkCorrectEvent:E=>x.mouseButton(E)===0&&E.ctrlKey||x.mouseButton(E)===2});return new qa({clickTolerance:d,move:(E,P)=>({bearingDelta:(P.x-E.x)*y}),moveStateManager:_,enable:l,assignEvents:tA})},yl=B=>{let{enable:l,clickTolerance:d,pitchDegreesPerPixelMoved:y=-.5}=B;const _=new Xo({checkCorrectEvent:E=>x.mouseButton(E)===0&&E.ctrlKey||x.mouseButton(E)===2});return new qa({clickTolerance:d,move:(E,P)=>({pitchDelta:(P.y-E.y)*y}),moveStateManager:_,enable:l,assignEvents:tA})};class eh{constructor(l,d){this._clickTolerance=l.clickTolerance||1,this._map=d,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(l,d,y){return this._calculateTransform(l,d,y)}touchmove(l,d,y){if(this._active&&!(y.length<this.minTouchs()))return l.preventDefault(),this._calculateTransform(l,d,y)}touchend(l,d,y){this._calculateTransform(l,d,y),this._active&&y.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,d,y){y.length>0&&(this._active=!0);const _=Zn(y,d),E=new o.P(0,0),P=new o.P(0,0);let R=0;for(const w in _){const T=_[w],L=this._touches[w];L&&(E._add(T),P._add(T.sub(L)),R++,_[w]=T)}if(this._touches=_,R<this.minTouchs()||!P.mag())return;const g=P.div(R);return this._sum._add(g),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(R),panDelta:g}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class je{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(l,d,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([d[0],d[1]]))}touchmove(l,d,y){if(!this._firstTwoTouches)return;l.preventDefault();const[_,E]=this._firstTwoTouches,P=qi(y,d,_),R=qi(y,d,E);if(!P||!R)return;const g=this._aroundCenter?null:P.add(R).div(2);return this._move([P,R],g,l)}touchend(l,d,y){if(!this._firstTwoTouches)return;const[_,E]=this._firstTwoTouches,P=qi(y,d,_),R=qi(y,d,E);P&&R||(this._active&&x.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function qi(B,l,d){for(let y=0;y<B.length;y++)if(B[y].identifier===d)return l[y]}function to(B,l){return Math.log(B/l)/Math.LN2}class eA extends je{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,d){const y=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(to(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:to(this._distance,y),pinchAround:d}}}function _l(B,l){return 180*B.angleWith(l)/Math.PI}class rh extends je{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,d,y){const _=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:_l(this._vector,_),pinchAround:d}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const d=25/(Math.PI*this._minDiameter)*360,y=_l(l,this._startVector);return Math.abs(y)<d}}function vl(B){return Math.abs(B.y)>Math.abs(B.x)}class rA extends je{constructor(l){super(),this._currentTouchCount=0,this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(l,d,y){super.touchstart(l,d,y),this._currentTouchCount=y.length}_start(l){this._lastPoints=l,vl(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,d,y){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const _=l[0].sub(this._lastPoints[0]),E=l[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,E,y.timeStamp),this._valid?(this._lastPoints=l,this._active=!0,{pitchDelta:(_.y+E.y)/2*-.5}):void 0}gestureBeginsVertically(l,d,y){if(this._valid!==void 0)return this._valid;const _=l.mag()>=2,E=d.mag()>=2;if(!_&&!E)return;if(!_||!E)return this._firstMove===void 0&&(this._firstMove=y),y-this._firstMove<100&&void 0;const P=l.y>0==d.y>0;return vl(l)&&vl(d)&&P}}const dd={panStep:100,bearingStep:15,pitchStep:10};class Ka{constructor(l){this._tr=new In(l);const d=dd;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let d=0,y=0,_=0,E=0,P=0;switch(l.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:l.shiftKey?y=-1:(l.preventDefault(),E=-1);break;case 39:l.shiftKey?y=1:(l.preventDefault(),E=1);break;case 38:l.shiftKey?_=1:(l.preventDefault(),P=-1);break;case 40:l.shiftKey?_=-1:(l.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(y=0,_=0),{cameraAnimation:R=>{const g=this._tr;R.easeTo({duration:300,easeId:"keyboardHandler",easing:Hn,zoom:d?Math.round(g.zoom)+d*(l.shiftKey?2:1):g.zoom,bearing:g.bearing+y*this._bearingStep,pitch:g.pitch+_*this._pitchStep,offset:[-E*this._panStep,-P*this._panStep],center:g.center},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Hn(B){return B*(2-B)}const bl=4.000244140625;class wl{constructor(l,d){this._onTimeout=y=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(y)},this._map=l,this._tr=new In(l),this._triggerRenderFrame=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(l){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!l[this._map.cooperativeGestures._bypassKey])return;let d=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const y=b.now(),_=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,d!==0&&d%bl==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(_*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),l.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=l,this._delta-=d,this._active||this._start(l)),l.preventDefault()}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=x.mousePos(this._map.getCanvas(),l),y=this._tr;this._around=d.y>y.transform.height/2-y.transform.getHorizon()?o.M.convert(this._aroundCenter?y.center:y.unproject(d)):o.M.convert(y.center),this._aroundPoint=y.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._tr.transform;if(this._delta!==0){const R=this._type==="wheel"&&Math.abs(this._delta)>bl?this._wheelZoomRate:this._defaultZoomRate;let g=2/(1+Math.exp(-Math.abs(this._delta*R)));this._delta<0&&g!==0&&(g=1/g);const w=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):l.scale;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(w*g))),this._type==="wheel"&&(this._startZoom=l.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const d=typeof this._targetZoom=="number"?this._targetZoom:l.zoom,y=this._startZoom,_=this._easing;let E,P=!1;if(this._type==="wheel"&&y&&_){const R=Math.min((b.now()-this._lastWheelEventTime)/200,1),g=_(R);E=o.z.number(y,d,g),R<1?this._frameId||(this._frameId=!0):P=!0}else E=d,P=!0;return this._active=!0,P&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!P,zoomDelta:E-l.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let d=o.b7;if(this._prevEase){const y=this._prevEase,_=(b.now()-y.start)/y.duration,E=y.easing(_+.01)-y.easing(_),P=.27/Math.sqrt(E*E+1e-4)*.01,R=Math.sqrt(.0729-P*P);d=o.b6(P,R,.25,1)}return this._prevEase={start:b.now(),duration:l,easing:d},d}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class nA{constructor(l,d){this._clickZoom=l,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ip{constructor(l){this._tr=new In(l),this.reset()}reset(){this._active=!1}dblclick(l,d){return l.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:this._tr.zoom+(l.shiftKey?-1:1),around:this._tr.unproject(d)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sp{constructor(){this._tap=new wa({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(l,d,y){if(!this._swipePoint)if(this._tapTime){const _=d[0],E=l.timeStamp-this._tapTime<500,P=this._tapPoint.dist(_)<30;E&&P?y.length>0&&(this._swipePoint=_,this._swipeTouch=y[0].identifier):this.reset()}else this._tap.touchstart(l,d,y)}touchmove(l,d,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const _=d[0],E=_.y-this._swipePoint.y;return this._swipePoint=_,l.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(l,d,y)}touchend(l,d,y){if(this._tapTime)this._swipePoint&&y.length===0&&this.reset();else{const _=this._tap.touchend(l,d,y);_&&(this._tapTime=l.timeStamp,this._tapPoint=_)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fd{constructor(l,d,y){this._el=l,this._mousePan=d,this._touchPan=y}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Yo{constructor(l,d,y){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=d,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class iA{constructor(l,d,y,_){this._el=l,this._touchZoom=d,this._touchRotate=y,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class hr{constructor(l,d){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=l,this._options=d,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const l=this._map.getCanvasContainer();l.classList.add("maplibregl-cooperative-gestures"),this._container=x.create("div","maplibregl-cooperative-gesture-screen",l);let d=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(d=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const y=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),_=document.createElement("div");_.className="maplibregl-desktop-message",_.textContent=d,this._container.appendChild(_);const E=document.createElement("div");E.className="maplibregl-mobile-message",E.textContent=y,this._container.appendChild(E),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(x.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(l){this._onCooperativeGesture(l.touches.length===1)}wheel(l){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!l[this._bypassKey])}_onCooperativeGesture(l){this._enabled&&l&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const br=B=>B.zoom||B.drag||B.pitch||B.rotate;class nh extends o.k{}function xl(B){return B.panDelta&&B.panDelta.mag()||B.zoomDelta||B.bearingDelta||B.pitchDelta}class sA{constructor(l,d){this.handleWindowEvent=_=>{this.handleEvent(_,`${_.type}Window`)},this.handleEvent=(_,E)=>{if(_.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const P=_.type==="renderFrame"?void 0:_,R={needsRenderFrame:!1},g={},w={},T=_.touches,L=T?this._getMapTouches(T):void 0,D=L?x.touchPos(this._map.getCanvas(),L):x.mousePos(this._map.getCanvas(),_);for(const{handlerName:j,handler:V,allowed:$}of this._handlers){if(!V.isEnabled())continue;let lt;this._blockedByActive(w,$,j)?V.reset():V[E||_.type]&&(lt=V[E||_.type](_,D,L),this.mergeHandlerResult(R,g,lt,j,P),lt&&lt.needsRenderFrame&&this._triggerRenderFrame()),(lt||V.isActive())&&(w[j]=V)}const H={};for(const j in this._previousActiveHandlers)w[j]||(H[j]=P);this._previousActiveHandlers=w,(Object.keys(H).length||xl(R))&&(this._changes.push([R,g,H]),this._triggerRenderFrame()),(Object.keys(w).length||xl(R))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:z}=R;z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],z(this._map))},this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Sc(l),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,E,P]of this._listeners)x.addEventListener(_,E,_===document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[l,d,y]of this._listeners)x.removeEventListener(l,d,l===document?this.handleWindowEvent:this.handleEvent,y)}_addDefaultHandlers(l){const d=this._map,y=d.getCanvasContainer();this._add("mapEvent",new Oi(d,l));const _=d.boxZoom=new Ln(d,l);this._add("boxZoom",_),l.interactive&&l.boxZoom&&_.enable();const E=d.cooperativeGestures=new hr(d,l.cooperativeGestures);this._add("cooperativeGestures",E),l.cooperativeGestures&&E.enable();const P=new uu(d),R=new ip(d);d.doubleClickZoom=new nA(R,P),this._add("tapZoom",P),this._add("clickZoom",R),l.interactive&&l.doubleClickZoom&&d.doubleClickZoom.enable();const g=new sp;this._add("tapDragZoom",g);const w=d.touchPitch=new rA(d);this._add("touchPitch",w),l.interactive&&l.touchPitch&&d.touchPitch.enable(l.touchPitch);const T=ml(l),L=yl(l);d.dragRotate=new Yo(l,T,L),this._add("mouseRotate",T,["mousePitch"]),this._add("mousePitch",L,["mouseRotate"]),l.interactive&&l.dragRotate&&d.dragRotate.enable();const D=(lt=>{let{enable:rt,clickTolerance:ht}=lt;const gt=new Xo({checkCorrectEvent:Pt=>x.mouseButton(Pt)===0&&!Pt.ctrlKey});return new qa({clickTolerance:ht,move:(Pt,Tt)=>({around:Tt,panDelta:Tt.sub(Pt)}),activateOnStart:!0,moveStateManager:gt,enable:rt,assignEvents:tA})})(l),H=new eh(l,d);d.dragPan=new fd(y,D,H),this._add("mousePan",D),this._add("touchPan",H,["touchZoom","touchRotate"]),l.interactive&&l.dragPan&&d.dragPan.enable(l.dragPan);const z=new rh,j=new eA;d.touchZoomRotate=new iA(y,j,z,g),this._add("touchRotate",z,["touchPan","touchZoom"]),this._add("touchZoom",j,["touchPan","touchRotate"]),l.interactive&&l.touchZoomRotate&&d.touchZoomRotate.enable(l.touchZoomRotate);const V=d.scrollZoom=new wl(d,()=>this._triggerRenderFrame());this._add("scrollZoom",V,["mousePan"]),l.interactive&&l.scrollZoom&&d.scrollZoom.enable(l.scrollZoom);const $=d.keyboard=new Ka(d);this._add("keyboard",$),l.interactive&&l.keyboard&&d.keyboard.enable(),this._add("blockableMapEvent",new _n(d))}_add(l,d,y){this._handlers.push({handlerName:l,handler:d,allowed:y}),this._handlersById[l]=d}stop(l){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!br(this._eventsInProgress)||this.isZooming()}_blockedByActive(l,d,y){for(const _ in l)if(_!==y&&(!d||d.indexOf(_)<0))return!0;return!1}_getMapTouches(l){const d=[];for(const y of l)this._el.contains(y.target)&&d.push(y);return d}mergeHandlerResult(l,d,y,_,E){if(!y)return;o.e(l,y);const P={handlerName:_,originalEvent:y.originalEvent||E};y.zoomDelta!==void 0&&(d.zoom=P),y.panDelta!==void 0&&(d.drag=P),y.pitchDelta!==void 0&&(d.pitch=P),y.bearingDelta!==void 0&&(d.rotate=P)}_applyChanges(){const l={},d={},y={};for(const[_,E,P]of this._changes)_.panDelta&&(l.panDelta=(l.panDelta||new o.P(0,0))._add(_.panDelta)),_.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(l.around=_.around),_.pinchAround!==void 0&&(l.pinchAround=_.pinchAround),_.noInertia&&(l.noInertia=_.noInertia),o.e(d,E),o.e(y,P);this._updateMapTransform(l,d,y),this._changes=[]}_updateMapTransform(l,d,y){const _=this._map,E=_._getTransformForUpdate(),P=_.terrain;if(!(xl(l)||P&&this._terrainMovement))return this._fireEvents(d,y,!0);let{panDelta:R,zoomDelta:g,bearingDelta:w,pitchDelta:T,around:L,pinchAround:D}=l;D!==void 0&&(L=D),_._stop(!0),L=L||_.transform.centerPoint;const H=E.pointLocation(R?L.sub(R):L);w&&(E.bearing+=w),T&&(E.pitch+=T),g&&(E.zoom+=g),P?this._terrainMovement||!d.drag&&!d.zoom?d.drag&&this._terrainMovement?E.center=E.pointLocation(E.centerPoint.sub(R)):E.setLocationAtPoint(H,L):(this._terrainMovement=!0,this._map._elevationFreeze=!0,E.setLocationAtPoint(H,L),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,E.recalculateZoom(_.terrain)})):E.setLocationAtPoint(H,L),_._applyUpdatedTransform(E),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(d,y,!0)}_fireEvents(l,d,y){const _=br(this._eventsInProgress),E=br(l),P={};for(const T in l){const{originalEvent:L}=l[T];this._eventsInProgress[T]||(P[`${T}start`]=L),this._eventsInProgress[T]=l[T]}!_&&E&&this._fireEvent("movestart",E.originalEvent);for(const T in P)this._fireEvent(T,P[T]);E&&this._fireEvent("move",E.originalEvent);for(const T in l){const{originalEvent:L}=l[T];this._fireEvent(T,L)}const R={};let g;for(const T in this._eventsInProgress){const{handlerName:L,originalEvent:D}=this._eventsInProgress[T];this._handlersById[L].isActive()||(delete this._eventsInProgress[T],g=d[L]||D,R[`${T}end`]=g)}for(const T in R)this._fireEvent(T,R[T]);const w=br(this._eventsInProgress);if(y&&(_||E)&&!w){this._updatingCamera=!0;const T=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),L=D=>D!==0&&-this._bearingSnap<D&&D<this._bearingSnap;!T||!T.essential&&b.prefersReducedMotion?(this._map.fire(new o.k("moveend",{originalEvent:g})),L(this._map.getBearing())&&this._map.resetNorth()):(L(T.bearing||this._map.getBearing())&&(T.bearing=0),T.freezeElevation=!0,this._map.easeTo(T,{originalEvent:g})),this._updatingCamera=!1}}_fireEvent(l,d){this._map.fire(new o.k(l,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{delete this._frameId,this.handleEvent(new nh("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Ki extends o.E{constructor(l,d){super(),this._renderFrameCallback=()=>{const y=Math.min((b.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(y)),y<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=d.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new o.M(this.transform.center.lng,this.transform.center.lat)}setCenter(l,d){return this.jumpTo({center:l},d)}panBy(l,d,y){return l=o.P.convert(l).mult(-1),this.panTo(this.transform.center,o.e({offset:l},d),y)}panTo(l,d,y){return this.easeTo(o.e({center:l},d),y)}getZoom(){return this.transform.zoom}setZoom(l,d){return this.jumpTo({zoom:l},d),this}zoomTo(l,d,y){return this.easeTo(o.e({zoom:l},d),y)}zoomIn(l,d){return this.zoomTo(this.getZoom()+1,l,d),this}zoomOut(l,d){return this.zoomTo(this.getZoom()-1,l,d),this}getBearing(){return this.transform.bearing}setBearing(l,d){return this.jumpTo({bearing:l},d),this}getPadding(){return this.transform.padding}setPadding(l,d){return this.jumpTo({padding:l},d),this}rotateTo(l,d,y){return this.easeTo(o.e({bearing:l},d),y)}resetNorth(l,d){return this.rotateTo(0,o.e({duration:1e3},l),d),this}resetNorthPitch(l,d){return this.easeTo(o.e({bearing:0,pitch:0,duration:1e3},l),d),this}snapToNorth(l,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,d):this}getPitch(){return this.transform.pitch}setPitch(l,d){return this.jumpTo({pitch:l},d),this}cameraForBounds(l,d){l=He.convert(l);const y=d&&d.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),y,d)}_cameraForBoxAndBearing(l,d,y,_){const E={top:0,bottom:0,right:0,left:0};if(typeof(_=o.e({padding:E,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){const $t=_.padding;_.padding={top:$t,bottom:$t,right:$t,left:$t}}_.padding=o.e(E,_.padding);const P=this.transform,R=P.padding,g=new He(l,d),w=P.project(g.getNorthWest()),T=P.project(g.getNorthEast()),L=P.project(g.getSouthEast()),D=P.project(g.getSouthWest()),H=o.b8(-y),z=w.rotate(H),j=T.rotate(H),V=L.rotate(H),$=D.rotate(H),lt=new o.P(Math.max(z.x,j.x,$.x,V.x),Math.max(z.y,j.y,$.y,V.y)),rt=new o.P(Math.min(z.x,j.x,$.x,V.x),Math.min(z.y,j.y,$.y,V.y)),ht=lt.sub(rt),gt=(P.width-(R.left+R.right+_.padding.left+_.padding.right))/ht.x,Pt=(P.height-(R.top+R.bottom+_.padding.top+_.padding.bottom))/ht.y;if(Pt<0||gt<0)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Tt=Math.min(P.scaleZoom(P.scale*Math.min(gt,Pt)),_.maxZoom),_t=o.P.convert(_.offset),bt=new o.P((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(o.b8(y)),Gt=_t.add(bt).mult(P.scale/P.zoomScale(Tt));return{center:P.unproject(w.add(L).div(2).sub(Gt)),zoom:Tt,bearing:y}}fitBounds(l,d,y){return this._fitInternal(this.cameraForBounds(l,d),d,y)}fitScreenCoordinates(l,d,y,_,E){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.P.convert(l)),this.transform.pointLocation(o.P.convert(d)),y,_),_,E)}_fitInternal(l,d,y){return l?(delete(d=o.e(l,d)).padding,d.linear?this.easeTo(d,y):this.flyTo(d,y)):this}jumpTo(l,d){this.stop();const y=this._getTransformForUpdate();let _=!1,E=!1,P=!1;return"zoom"in l&&y.zoom!==+l.zoom&&(_=!0,y.zoom=+l.zoom),l.center!==void 0&&(y.center=o.M.convert(l.center)),"bearing"in l&&y.bearing!==+l.bearing&&(E=!0,y.bearing=+l.bearing),"pitch"in l&&y.pitch!==+l.pitch&&(P=!0,y.pitch=+l.pitch),l.padding==null||y.isPaddingEqual(l.padding)||(y.padding=l.padding),this._applyUpdatedTransform(y),this.fire(new o.k("movestart",d)).fire(new o.k("move",d)),_&&this.fire(new o.k("zoomstart",d)).fire(new o.k("zoom",d)).fire(new o.k("zoomend",d)),E&&this.fire(new o.k("rotatestart",d)).fire(new o.k("rotate",d)).fire(new o.k("rotateend",d)),P&&this.fire(new o.k("pitchstart",d)).fire(new o.k("pitch",d)).fire(new o.k("pitchend",d)),this.fire(new o.k("moveend",d))}calculateCameraOptionsFromTo(l,d,y){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const E=o.Y.fromLngLat(l,d),P=o.Y.fromLngLat(y,_),R=P.x-E.x,g=P.y-E.y,w=P.z-E.z,T=Math.hypot(R,g,w);if(T===0)throw new Error("Can't calculate camera options with same From and To");const L=Math.hypot(R,g),D=this.transform.scaleZoom(this.transform.cameraToCenterDistance/T/this.transform.tileSize),H=180*Math.atan2(R,-g)/Math.PI;let z=180*Math.acos(L/T)/Math.PI;return z=w<0?90-z:90+z,{center:P.toLngLat(),zoom:D,pitch:z,bearing:H}}easeTo(l,d){var y;this._stop(!1,l.easeId),((l=o.e({offset:[0,0],duration:500,easing:o.b7},l)).animate===!1||!l.essential&&b.prefersReducedMotion)&&(l.duration=0);const _=this._getTransformForUpdate(),E=this.getZoom(),P=this.getBearing(),R=this.getPitch(),g=this.getPadding(),w="bearing"in l?this._normalizeBearing(l.bearing,P):P,T="pitch"in l?+l.pitch:R,L="padding"in l?l.padding:_.padding,D=o.P.convert(l.offset);let H=_.centerPoint.add(D);const z=_.pointLocation(H),{center:j,zoom:V}=_.getConstrained(o.M.convert(l.center||z),(y=l.zoom)!==null&&y!==void 0?y:E);this._normalizeCenter(j);const $=_.project(z),lt=_.project(j).sub($),rt=_.zoomScale(V-E);let ht,gt;l.around&&(ht=o.M.convert(l.around),gt=_.locationPoint(ht));const Pt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||V!==E,this._rotating=this._rotating||P!==w,this._pitching=this._pitching||T!==R,this._padding=!_.isPaddingEqual(L),this._easeId=l.easeId,this._prepareEase(d,l.noMoveStart,Pt),this.terrain&&this._prepareElevation(j),this._ease(Tt=>{if(this._zooming&&(_.zoom=o.z.number(E,V,Tt)),this._rotating&&(_.bearing=o.z.number(P,w,Tt)),this._pitching&&(_.pitch=o.z.number(R,T,Tt)),this._padding&&(_.interpolatePadding(g,L,Tt),H=_.centerPoint.add(D)),this.terrain&&!l.freezeElevation&&this._updateElevation(Tt),ht)_.setLocationAtPoint(ht,gt);else{const _t=_.zoomScale(_.zoom-E),bt=V>E?Math.min(2,rt):Math.max(.5,rt),Gt=Math.pow(bt,1-Tt),$t=_.unproject($.add(lt.mult(Tt*Gt)).mult(_t));_.setLocationAtPoint(_.renderWorldCopies?$t.wrap():$t,H)}this._applyUpdatedTransform(_),this._fireMoveEvents(d)},Tt=>{this.terrain&&this._finalizeElevation(),this._afterEase(d,Tt)},l),this}_prepareEase(l,d){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this._moving=!0,d||y.moving||this.fire(new o.k("movestart",l)),this._zooming&&!y.zooming&&this.fire(new o.k("zoomstart",l)),this._rotating&&!y.rotating&&this.fire(new o.k("rotatestart",l)),this._pitching&&!y.pitching&&this.fire(new o.k("pitchstart",l))}_prepareElevation(l){this._elevationCenter=l,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(l){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const d=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(l<1&&d!==this._elevationTarget){const y=this._elevationTarget-this._elevationStart;this._elevationStart+=l*(y-(d-(y*l+this._elevationStart))/(1-l)),this._elevationTarget=d}this.transform.elevation=o.z.number(this._elevationStart,this._elevationTarget,l)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(l){if(!this.transformCameraUpdate)return;const d=l.clone(),{center:y,zoom:_,pitch:E,bearing:P,elevation:R}=this.transformCameraUpdate(d);y&&(d.center=y),_!==void 0&&(d.zoom=_),E!==void 0&&(d.pitch=E),P!==void 0&&(d.bearing=P),R!==void 0&&(d.elevation=R),this.transform.apply(d)}_fireMoveEvents(l){this.fire(new o.k("move",l)),this._zooming&&this.fire(new o.k("zoom",l)),this._rotating&&this.fire(new o.k("rotate",l)),this._pitching&&this.fire(new o.k("pitch",l))}_afterEase(l,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId;const y=this._zooming,_=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new o.k("zoomend",l)),_&&this.fire(new o.k("rotateend",l)),E&&this.fire(new o.k("pitchend",l)),this.fire(new o.k("moveend",l))}flyTo(l,d){var y;if(!l.essential&&b.prefersReducedMotion){const Ce=o.L(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ce,d)}this.stop(),l=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.b7},l);const _=this._getTransformForUpdate(),E=this.getZoom(),P=this.getBearing(),R=this.getPitch(),g=this.getPadding(),w="bearing"in l?this._normalizeBearing(l.bearing,P):P,T="pitch"in l?+l.pitch:R,L="padding"in l?l.padding:_.padding,D=o.P.convert(l.offset);let H=_.centerPoint.add(D);const z=_.pointLocation(H),{center:j,zoom:V}=_.getConstrained(o.M.convert(l.center||z),(y=l.zoom)!==null&&y!==void 0?y:E);this._normalizeCenter(j);const $=_.zoomScale(V-E),lt=_.project(z),rt=_.project(j).sub(lt);let ht=l.curve;const gt=Math.max(_.width,_.height),Pt=gt/$,Tt=rt.mag();if("minZoom"in l){const Ce=o.ac(Math.min(l.minZoom,E,V),_.minZoom,_.maxZoom),We=gt/_.zoomScale(Ce-E);ht=Math.sqrt(We/Tt*2)}const _t=ht*ht;function bt(Ce){const We=(Pt*Pt-gt*gt+(Ce?-1:1)*_t*_t*Tt*Tt)/(2*(Ce?Pt:gt)*_t*Tt);return Math.log(Math.sqrt(We*We+1)-We)}function Gt(Ce){return(Math.exp(Ce)-Math.exp(-Ce))/2}function $t(Ce){return(Math.exp(Ce)+Math.exp(-Ce))/2}const ue=bt(!1);let Ae=function(Ce){return $t(ue)/$t(ue+ht*Ce)},ye=function(Ce){return gt*(($t(ue)*(Gt(We=ue+ht*Ce)/$t(We))-Gt(ue))/_t)/Tt;var We},Re=(bt(!0)-ue)/ht;if(Math.abs(Tt)<1e-6||!isFinite(Re)){if(Math.abs(gt-Pt)<1e-6)return this.easeTo(l,d);const Ce=Pt<gt?-1:1;Re=Math.abs(Math.log(Pt/gt))/ht,ye=function(){return 0},Ae=function(We){return Math.exp(Ce*ht*We)}}return l.duration="duration"in l?+l.duration:1e3*Re/("screenSpeed"in l?+l.screenSpeed/ht:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=P!==w,this._pitching=T!==R,this._padding=!_.isPaddingEqual(L),this._prepareEase(d,!1),this.terrain&&this._prepareElevation(j),this._ease(Ce=>{const We=Ce*Re,rr=1/Ae(We);_.zoom=Ce===1?V:E+_.scaleZoom(rr),this._rotating&&(_.bearing=o.z.number(P,w,Ce)),this._pitching&&(_.pitch=o.z.number(R,T,Ce)),this._padding&&(_.interpolatePadding(g,L,Ce),H=_.centerPoint.add(D)),this.terrain&&!l.freezeElevation&&this._updateElevation(Ce);const er=Ce===1?j:_.unproject(lt.add(rt.mult(ye(We))).mult(rr));_.setLocationAtPoint(_.renderWorldCopies?er.wrap():er,H),this._applyUpdatedTransform(_),this._fireMoveEvents(d)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(d)},l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,d)}if(!l){const y=this.handlers;y&&y.stop(!1)}return this}_ease(l,d,y){y.animate===!1||y.duration===0?(l(1),d()):(this._easeStart=b.now(),this._easeOptions=y,this._onEaseFrame=l,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(l,d){l=o.b1(l,-180,180);const y=Math.abs(l-d);return Math.abs(l-360-d)<y&&(l-=360),Math.abs(l+360-d)<y&&(l+=360),l}_normalizeCenter(l){const d=this.transform;if(!d.renderWorldCopies||d.lngRange)return;const y=l.lng-d.center.lng;l.lng+=y>180?-360:y<-180?360:0}queryTerrainElevation(l){return this.terrain?this.terrain.getElevationForLngLatZoom(o.M.convert(l),this.transform.tileZoom)-this.transform.elevation:null}}const pd={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Jo{constructor(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pd;this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=d=>{!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"&&d.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=l}getDefaultPosition(){return"bottom-right"}onAdd(l){return this._map=l,this._compact=this.options.compact,this._container=x.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=x.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=x.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){x.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(l,d){const y=this._map._getUIString(`AttributionControl.${d}`);l.title=y,l.setAttribute("aria-label",y)}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(_=>typeof _!="string"?"":_)):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const d=this._map.style.sourceCaches;for(const _ in d){const E=d[_];if(E.used||E.usedForTerrain){const P=E.getSource();P.attribution&&l.indexOf(P.attribution)<0&&l.push(P.attribution)}}l=l.filter(_=>String(_).trim()),l.sort((_,E)=>_.length-E.length),l=l.filter((_,E)=>{for(let P=E+1;P<l.length;P++)if(l[P].indexOf(_)>=0)return!1;return!0});const y=l.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,l.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class gd{constructor(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._updateCompact=()=>{const d=this._container.children;if(d.length){const y=d[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&y.classList.add("maplibregl-compact"):y.classList.remove("maplibregl-compact")}},this.options=l}getDefaultPosition(){return"bottom-left"}onAdd(l){this._map=l,this._compact=this.options&&this.options.compact,this._container=x.create("div","maplibregl-ctrl");const d=x.create("a","maplibregl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){x.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class oA{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const d=++this._id;return this._queue.push({callback:l,id:d,cancelled:!1}),d}remove(l){const d=this._currentlyRunning,y=d?this._queue.concat(d):this._queue;for(const _ of y)if(_.id===l)return void(_.cancelled=!0)}run(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const d=this._currentlyRunning=this._queue;this._queue=[];for(const y of d)if(!y.cancelled&&(y.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Ai=o.X([{name:"a_pos3d",type:"Int16",components:3}]);class Ci extends o.E{constructor(l){super(),this.sourceCache=l,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,l.usedForTerrain=!0,l.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(l,d){this.sourceCache.update(l,d),this._renderableTilesKeys=[];const y={};for(const _ of l.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:d}))y[_.key]=!0,this._renderableTilesKeys.push(_.key),this._tiles[_.key]||(_.posMatrix=new Float64Array(16),o.aN(_.posMatrix,0,o.W,0,o.W,0,1),this._tiles[_.key]=new Tr(_,this.tileSize));for(const _ in this._tiles)y[_]||delete this._tiles[_]}freeRtt(l){for(const d in this._tiles){const y=this._tiles[d];(!l||y.tileID.equals(l)||y.tileID.isChildOf(l)||l.isChildOf(y.tileID))&&(y.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(l=>this.getTileByID(l))}getTileByID(l){return this._tiles[l]}getTerrainCoords(l){const d={};for(const y of this._renderableTilesKeys){const _=this._tiles[y].tileID;if(_.canonical.equals(l.canonical)){const E=l.clone();E.posMatrix=new Float64Array(16),o.aN(E.posMatrix,0,o.W,0,o.W,0,1),d[y]=E}else if(_.canonical.isChildOf(l.canonical)){const E=l.clone();E.posMatrix=new Float64Array(16);const P=_.canonical.z-l.canonical.z,R=_.canonical.x-(_.canonical.x>>P<<P),g=_.canonical.y-(_.canonical.y>>P<<P),w=o.W>>P;o.aN(E.posMatrix,0,w,0,w,0,1),o.H(E.posMatrix,E.posMatrix,[-R*w,-g*w,0]),d[y]=E}else if(l.canonical.isChildOf(_.canonical)){const E=l.clone();E.posMatrix=new Float64Array(16);const P=l.canonical.z-_.canonical.z,R=l.canonical.x-(l.canonical.x>>P<<P),g=l.canonical.y-(l.canonical.y>>P<<P),w=o.W>>P;o.aN(E.posMatrix,0,o.W,0,o.W,0,1),o.H(E.posMatrix,E.posMatrix,[R*w,g*w,0]),o.J(E.posMatrix,E.posMatrix,[1/2**P,1/2**P,0]),d[y]=E}}return d}getSourceTile(l,d){const y=this.sourceCache._source;let _=l.overscaledZ-this.deltaZoom;if(_>y.maxzoom&&(_=y.maxzoom),_<y.minzoom)return null;this._sourceTileCache[l.key]||(this._sourceTileCache[l.key]=l.scaledTo(_).key);let E=this.sourceCache.getTileByID(this._sourceTileCache[l.key]);if((!E||!E.dem)&&d)for(;_>=y.minzoom&&(!E||!E.dem);)E=this.sourceCache.getTileByID(l.scaledTo(_--).key);return E}tilesAfterTime(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Date.now();return Object.values(this._tiles).filter(d=>d.timeAdded>=l)}}class op{constructor(l,d,y){this.painter=l,this.sourceCache=new Ci(d),this.options=y,this.exaggeration=typeof y.exaggeration=="number"?y.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(l,d,y){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:o.W;var E;if(!(d>=0&&d<_&&y>=0&&y<_))return 0;const P=this.getTerrainData(l),R=(E=P.tile)===null||E===void 0?void 0:E.dem;if(!R)return 0;const g=function(z,j,V){var $=j[0],lt=j[1];return z[0]=V[0]*$+V[4]*lt+V[12],z[1]=V[1]*$+V[5]*lt+V[13],z}([],[d/_*o.W,y/_*o.W],P.u_terrain_matrix),w=[g[0]*R.dim,g[1]*R.dim],T=Math.floor(w[0]),L=Math.floor(w[1]),D=w[0]-T,H=w[1]-L;return R.get(T,L)*(1-D)*(1-H)+R.get(T+1,L)*D*(1-H)+R.get(T,L+1)*(1-D)*H+R.get(T+1,L+1)*D*H}getElevationForLngLatZoom(l,d){const{tileID:y,mercatorX:_,mercatorY:E}=this._getOverscaledTileIDFromLngLatZoom(l,d);return this.getElevation(y,_%o.W,E%o.W,o.W)}getElevation(l,d,y){let _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:o.W;return this.getDEMElevation(l,d,y,_)*this.exaggeration}getTerrainData(l){if(!this._emptyDemTexture){const _=this.painter.context,E=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new st(_,E,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new st(_,new o.R({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.an([])}const d=this.sourceCache.getSourceTile(l,!0);if(d&&d.dem&&(!d.demTexture||d.needsTerrainPrepare)){const _=this.painter.context;d.demTexture=this.painter.getTileTexture(d.dem.stride),d.demTexture?d.demTexture.update(d.dem.getPixels(),{premultiply:!1}):d.demTexture=new st(_,d.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),d.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),d.needsTerrainPrepare=!1}const y=d&&d+d.tileID.key+l.key;if(y&&!this._demMatrixCache[y]){const _=this.sourceCache.sourceCache._source.maxzoom;let E=l.canonical.z-d.tileID.canonical.z;l.overscaledZ>l.canonical.z&&(l.canonical.z>=_?E=l.canonical.z-_:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const P=l.canonical.x-(l.canonical.x>>E<<E),R=l.canonical.y-(l.canonical.y>>E<<E),g=o.b9(new Float64Array(16),[1/(o.W<<E),1/(o.W<<E),0]);o.H(g,g,[P*o.W,R*o.W,0]),this._demMatrixCache[l.key]={matrix:g,coord:l}}return{u_depth:2,u_terrain:3,u_terrain_dim:d&&d.dem&&d.dem.dim||1,u_terrain_matrix:y?this._demMatrixCache[l.key].matrix:this._emptyDemMatrix,u_terrain_unpack:d&&d.dem&&d.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(d&&d.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:d}}getFramebuffer(l){const d=this.painter,y=d.width/devicePixelRatio,_=d.height/devicePixelRatio;return!this._fbo||this._fbo.width===y&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new st(d.context,{width:y,height:_,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new st(d.context,{width:y,height:_,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=d.context.createFramebuffer(y,_,!0,!1),this._fbo.depthAttachment.set(d.context.createRenderbuffer(d.context.gl.DEPTH_COMPONENT16,y,_))),this._fbo.colorAttachment.set(l==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const l=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const d=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let E=0,P=0;E<this._coordsTextureSize;E++)for(let R=0;R<this._coordsTextureSize;R++,P+=4)d[P+0]=255&R,d[P+1]=255&E,d[P+2]=R>>8<<4|E>>8,d[P+3]=0;const y=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(d.buffer)),_=new st(l,y,l.gl.RGBA,{premultiply:!1});return _.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(l){this.painter.maybeDrawDepthAndCoords(!0);const d=new Uint8Array(4),y=this.painter.context,_=y.gl,E=Math.round(l.x*this.painter.pixelRatio/devicePixelRatio),P=Math.round(l.y*this.painter.pixelRatio/devicePixelRatio),R=Math.round(this.painter.height/devicePixelRatio);y.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),_.readPixels(E,R-P-1,1,1,_.RGBA,_.UNSIGNED_BYTE,d),y.bindFramebuffer.set(null);const g=d[0]+(d[2]>>4<<8),w=d[1]+((15&d[2])<<8),T=this.coordsIndex[255-d[3]],L=T&&this.sourceCache.getTileByID(T);if(!L)return null;const D=this._coordsTextureSize,H=(1<<L.tileID.canonical.z)*D;return new o.Y((L.tileID.canonical.x*D+g)/H+L.tileID.wrap,(L.tileID.canonical.y*D+w)/H,this.getElevation(L.tileID,g,w,D))}depthAtPoint(l){const d=new Uint8Array(4),y=this.painter.context,_=y.gl;return y.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),_.readPixels(l.x,this.painter.height/devicePixelRatio-l.y-1,1,1,_.RGBA,_.UNSIGNED_BYTE,d),y.bindFramebuffer.set(null),(d[0]/16777216+d[1]/65536+d[2]/256+d[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const l=this.painter.context,d=new o.ba,y=new o.aX,_=this.meshSize,E=o.W/_,P=_*_;for(let L=0;L<=_;L++)for(let D=0;D<=_;D++)d.emplaceBack(D*E,L*E,0);for(let L=0;L<P;L+=_+1)for(let D=0;D<_;D++)y.emplaceBack(D+L,_+D+L+1,_+D+L+2),y.emplaceBack(D+L,_+D+L+2,D+L+1);const R=d.length,g=R+2*(_+1);for(const L of[0,1])for(let D=0;D<=_;D++)for(const H of[0,1])d.emplaceBack(D*E,L*o.W,H);for(let L=0;L<2*_;L+=2)y.emplaceBack(g+L,g+L+1,g+L+3),y.emplaceBack(g+L,g+L+3,g+L+2),y.emplaceBack(R+L,R+L+3,R+L+1),y.emplaceBack(R+L,R+L+2,R+L+3);const w=d.length,T=w+2*(_+1);for(const L of[0,1])for(let D=0;D<=_;D++)for(const H of[0,1])d.emplaceBack(L*o.W,D*E,H);for(let L=0;L<2*_;L+=2)y.emplaceBack(w+L,w+L+1,w+L+3),y.emplaceBack(w+L,w+L+3,w+L+2),y.emplaceBack(T+L,T+L+3,T+L+1),y.emplaceBack(T+L,T+L+2,T+L+3);return this._mesh={indexBuffer:l.createIndexBuffer(y),vertexBuffer:l.createVertexBuffer(d,Ai.members),segments:o.$.simpleSegment(0,0,d.length,y.length)},this._mesh}getMeshFrameDelta(l){return 2*Math.PI*o.bb/Math.pow(2,l)/5}getMinTileElevationForLngLatZoom(l,d){var y;const{tileID:_}=this._getOverscaledTileIDFromLngLatZoom(l,d);return(y=this.getMinMaxElevation(_).minElevation)!==null&&y!==void 0?y:0}getMinMaxElevation(l){const d=this.getTerrainData(l).tile,y={minElevation:null,maxElevation:null};return d&&d.dem&&(y.minElevation=d.dem.min*this.exaggeration,y.maxElevation=d.dem.max*this.exaggeration),y}_getOverscaledTileIDFromLngLatZoom(l,d){const y=o.Y.fromLngLat(l.wrap()),_=(1<<d)*o.W,E=y.x*_,P=y.y*_,R=Math.floor(E/o.W),g=Math.floor(P/o.W);return{tileID:new o.Q(d,0,d,R,g),mercatorX:E,mercatorY:P}}}class xo{constructor(l,d,y){this._context=l,this._size=d,this._tileSize=y,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const l of this._objects)l.texture.destroy(),l.fbo.destroy()}_createObject(l){const d=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),y=new st(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return y.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),d.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),d.colorAttachment.set(y.texture),{id:l,fbo:d,texture:y,stamp:-1,inUse:!1}}getObjectForId(l){return this._objects[l]}useObject(l){l.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(d=>l.id!==d),this._recentlyUsed.push(l.id)}stampObject(l){l.stamp=++this._stamp}getOrCreateFreeObject(){for(const d of this._recentlyUsed)if(!this._objects[d].inUse)return this._objects[d];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const l=this._createObject(this._objects.length);return this._objects.push(l),l}freeObject(l){l.inUse=!1}freeAllObjects(){for(const l of this._objects)this.freeObject(l)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(l=>!l.inUse)===!1}}const Di={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Zo{constructor(l,d){this.painter=l,this.terrain=d,this.pool=new xo(l.context,30,d.sourceCache.tileSize*d.qualityFactor)}destruct(){this.pool.destruct()}getTexture(l){return this.pool.getObjectForId(l.rtt[this._stacks.length-1].id).texture}prepareForRender(l,d){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=l._order.filter(y=>!l._layers[y].isHidden(d)),this._coordsDescendingInv={};for(const y in l.sourceCaches){this._coordsDescendingInv[y]={};const _=l.sourceCaches[y].getVisibleCoordinates();for(const E of _){const P=this.terrain.sourceCache.getTerrainCoords(E);for(const R in P)this._coordsDescendingInv[y][R]||(this._coordsDescendingInv[y][R]=[]),this._coordsDescendingInv[y][R].push(P[R])}}this._coordsDescendingInvStr={};for(const y of l._order){const _=l._layers[y],E=_.source;if(Di[_.type]&&!this._coordsDescendingInvStr[E]){this._coordsDescendingInvStr[E]={};for(const P in this._coordsDescendingInv[E])this._coordsDescendingInvStr[E][P]=this._coordsDescendingInv[E][P].map(R=>R.key).sort().join()}}for(const y of this._renderableTiles)for(const _ in this._coordsDescendingInvStr){const E=this._coordsDescendingInvStr[_][y.tileID.key];E&&E!==y.rttCoords[_]&&(y.rtt=[])}}renderLayer(l){if(l.isHidden(this.painter.transform.zoom))return!1;const d=l.type,y=this.painter,_=this._renderableLayerIds[this._renderableLayerIds.length-1]===l.id;if(Di[d]&&(this._prevType&&Di[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(l.id),!_))return!0;if(Di[this._prevType]||Di[d]&&_){this._prevType=d;const E=this._stacks.length-1,P=this._stacks[E]||[];for(const R of this._renderableTiles){if(this.pool.isFull()&&(lu(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(R),R.rtt[E]){const w=this.pool.getObjectForId(R.rtt[E].id);if(w.stamp===R.rtt[E].stamp){this.pool.useObject(w);continue}}const g=this.pool.getOrCreateFreeObject();this.pool.useObject(g),this.pool.stampObject(g),R.rtt[E]={id:g.id,stamp:g.stamp},y.context.bindFramebuffer.set(g.fbo.framebuffer),y.context.clear({color:o.aO.transparent,stencil:0}),y.currentStencilSource=void 0;for(let w=0;w<P.length;w++){const T=y.style._layers[P[w]],L=T.source?this._coordsDescendingInv[T.source][R.tileID.key]:[R.tileID];y.context.viewport.set([0,0,g.fbo.width,g.fbo.height]),y._renderTileClippingMasks(T,L),y.renderLayer(y,y.style.sourceCaches[T.source],T,L),T.source&&(R.rttCoords[T.source]=this._coordsDescendingInvStr[T.source][R.tileID.key])}}return lu(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Di[d]}return!1}}const md={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ih=A,Bo={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:pd,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Cs=B=>{B.touchstart=B.dragStart,B.touchmoveWindow=B.dragMove,B.touchend=B.dragEnd},yd={showCompass:!0,showZoom:!0,visualizePitch:!1};class _d{constructor(l,d){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.mousedown=P=>{this.startMouse(o.e({},P,{ctrlKey:!0,preventDefault:()=>P.preventDefault()}),x.mousePos(this.element,P)),x.addEventListener(window,"mousemove",this.mousemove),x.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=P=>{this.moveMouse(P,x.mousePos(this.element,P))},this.mouseup=P=>{this.mouseRotate.dragEnd(P),this.mousePitch&&this.mousePitch.dragEnd(P),this.offTemp()},this.touchstart=P=>{P.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=x.touchPos(this.element,P.targetTouches)[0],this.startTouch(P,this._startPos),x.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),x.addEventListener(window,"touchend",this.touchend))},this.touchmove=P=>{P.targetTouches.length!==1?this.reset():(this._lastPos=x.touchPos(this.element,P.targetTouches)[0],this.moveTouch(P,this._lastPos))},this.touchend=P=>{P.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const _=l.dragRotate._mouseRotate.getClickTolerance(),E=l.dragRotate._mousePitch.getClickTolerance();this.element=d,this.mouseRotate=ml({clickTolerance:_,enable:!0}),this.touchRotate=(P=>{let{enable:R,clickTolerance:g,bearingDegreesPerPixelMoved:w=.8}=P;const T=new Ze;return new qa({clickTolerance:g,move:(L,D)=>({bearingDelta:(D.x-L.x)*w}),moveStateManager:T,enable:R,assignEvents:Cs})})({clickTolerance:_,enable:!0}),this.map=l,y&&(this.mousePitch=yl({clickTolerance:E,enable:!0}),this.touchPitch=(P=>{let{enable:R,clickTolerance:g,pitchDegreesPerPixelMoved:w=-.5}=P;const T=new Ze;return new qa({clickTolerance:g,move:(L,D)=>({pitchDelta:(D.y-L.y)*w}),moveStateManager:T,enable:R,assignEvents:Cs})})({clickTolerance:E,enable:!0})),x.addEventListener(d,"mousedown",this.mousedown),x.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),x.addEventListener(d,"touchcancel",this.reset)}startMouse(l,d){this.mouseRotate.dragStart(l,d),this.mousePitch&&this.mousePitch.dragStart(l,d),x.disableDrag()}startTouch(l,d){this.touchRotate.dragStart(l,d),this.touchPitch&&this.touchPitch.dragStart(l,d),x.disableDrag()}moveMouse(l,d){const y=this.map,{bearingDelta:_}=this.mouseRotate.dragMove(l,d)||{};if(_&&y.setBearing(y.getBearing()+_),this.mousePitch){const{pitchDelta:E}=this.mousePitch.dragMove(l,d)||{};E&&y.setPitch(y.getPitch()+E)}}moveTouch(l,d){const y=this.map,{bearingDelta:_}=this.touchRotate.dragMove(l,d)||{};if(_&&y.setBearing(y.getBearing()+_),this.touchPitch){const{pitchDelta:E}=this.touchPitch.dragMove(l,d)||{};E&&y.setPitch(y.getPitch()+E)}}off(){const l=this.element;x.removeEventListener(l,"mousedown",this.mousedown),x.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),x.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),x.removeEventListener(window,"touchend",this.touchend),x.removeEventListener(l,"touchcancel",this.reset),this.offTemp()}offTemp(){x.enableDrag(),x.removeEventListener(window,"mousemove",this.mousemove),x.removeEventListener(window,"mouseup",this.mouseup),x.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),x.removeEventListener(window,"touchend",this.touchend)}}let xa;function aA(B,l,d){const y=new o.M(B.lng,B.lat);if(B=new o.M(B.lng,B.lat),l){const _=new o.M(B.lng-360,B.lat),E=new o.M(B.lng+360,B.lat),P=d.locationPoint(B).distSqr(l);d.locationPoint(_).distSqr(l)<P?B=_:d.locationPoint(E).distSqr(l)<P&&(B=E)}for(;Math.abs(B.lng-d.center.lng)>180;){const _=d.locationPoint(B);if(_.x>=0&&_.y>=0&&_.x<=d.width&&_.y<=d.height)break;B.lng>d.center.lng?B.lng-=360:B.lng+=360}return B.lng!==y.lng&&d.locationPoint(B).y>d.height/2-d.getHorizon()?B:y}const hu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function cA(B,l,d){const y=B.classList;for(const _ in hu)y.remove(`maplibregl-${d}-anchor-${_}`);y.add(`maplibregl-${d}-anchor-${l}`)}class lA extends o.E{constructor(l){if(super(),this._onKeyPress=d=>{const y=d.code,_=d.charCode||d.keyCode;y!=="Space"&&y!=="Enter"&&_!==32&&_!==13||this.togglePopup()},this._onMapClick=d=>{const y=d.originalEvent.target,_=this._element;this._popup&&(y===_||_.contains(y))&&this.togglePopup()},this._update=d=>{var y;if(!this._map)return;const _=this._map.loaded()&&!this._map.isMoving();((d==null?void 0:d.type)==="terrain"||(d==null?void 0:d.type)==="render"&&!_)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?aA(this._lngLat,this._flatPos,this._map.transform):(y=this._lngLat)===null||y===void 0?void 0:y.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let E="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?E=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(E=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let P="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?P="rotateX(0deg)":this._pitchAlignment==="map"&&(P=`rotateX(${this._map.getPitch()}deg)`),d&&d.type!=="moveend"||(this._pos=this._pos.round()),x.setTransform(this._element,`${hu[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${P} ${E}`),b.frameAsync(new AbortController).then(()=>{this._updateOpacity(d&&d.type==="moveend")}).catch(()=>{})},this._onMove=d=>{if(!this._isDragging){const y=this._clickTolerance||this._map._clickTolerance;this._isDragging=d.point.dist(this._pointerdownPos)>=y}this._isDragging&&(this._pos=d.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.k("dragstart"))),this.fire(new o.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.k("dragend")),this._state="inactive"},this._addDragHandler=d=>{this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(this._pos).add(this._offset),this._pointerdownPos=d.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(l==null?void 0:l.opacity,l==null?void 0:l.opacityWhenCovered),l&&l.element)this._element=l.element,this._offset=o.P.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=x.create("div"),this._element.setAttribute("aria-label","Map marker");const d=x.createNS("http://www.w3.org/2000/svg","svg"),y=41,_=27;d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height",`${y}px`),d.setAttributeNS(null,"width",`${_}px`),d.setAttributeNS(null,"viewBox",`0 0 ${_} ${y}`);const E=x.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"stroke","none"),E.setAttributeNS(null,"stroke-width","1"),E.setAttributeNS(null,"fill","none"),E.setAttributeNS(null,"fill-rule","evenodd");const P=x.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"fill-rule","nonzero");const R=x.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"transform","translate(3.0, 29.0)"),R.setAttributeNS(null,"fill","#000000");const g=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const $ of g){const lt=x.createNS("http://www.w3.org/2000/svg","ellipse");lt.setAttributeNS(null,"opacity","0.04"),lt.setAttributeNS(null,"cx","10.5"),lt.setAttributeNS(null,"cy","5.80029008"),lt.setAttributeNS(null,"rx",$.rx),lt.setAttributeNS(null,"ry",$.ry),R.appendChild(lt)}const w=x.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill",this._color);const T=x.createNS("http://www.w3.org/2000/svg","path");T.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),w.appendChild(T);const L=x.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"opacity","0.25"),L.setAttributeNS(null,"fill","#000000");const D=x.createNS("http://www.w3.org/2000/svg","path");D.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),L.appendChild(D);const H=x.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(6.0, 7.0)"),H.setAttributeNS(null,"fill","#FFFFFF");const z=x.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"transform","translate(8.0, 8.0)");const j=x.createNS("http://www.w3.org/2000/svg","circle");j.setAttributeNS(null,"fill","#000000"),j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"cx","5.5"),j.setAttributeNS(null,"cy","5.5"),j.setAttributeNS(null,"r","5.4999962");const V=x.createNS("http://www.w3.org/2000/svg","circle");V.setAttributeNS(null,"fill","#FFFFFF"),V.setAttributeNS(null,"cx","5.5"),V.setAttributeNS(null,"cy","5.5"),V.setAttributeNS(null,"r","5.4999962"),z.appendChild(j),z.appendChild(V),P.appendChild(R),P.appendChild(w),P.appendChild(L),P.appendChild(H),P.appendChild(z),d.appendChild(P),d.setAttributeNS(null,"height",y*this._scale+"px"),d.setAttributeNS(null,"width",_*this._scale+"px"),this._element.appendChild(d),this._offset=o.P.convert(l&&l.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",d=>{d.preventDefault()}),this._element.addEventListener("mousedown",d=>{d.preventDefault()}),cA(this._element,this._anchor,"marker"),l&&l.className)for(const d of l.className.split(" "))this._element.classList.add(d);this._popup=null}addTo(l){return this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),l.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),x.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=o.M.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const _=Math.abs(13.5)/Math.SQRT2;l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const l=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:l?(l.isOpen()?l.remove():(l.setLngLat(this._lngLat),l.addTo(this._map)),this):this}_updateOpacity(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;var d,y;if(!(!((d=this._map)===null||d===void 0)&&d.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(l)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const _=this._map,E=_.terrain.depthAtPoint(this._pos),P=_.terrain.getElevationForLngLatZoom(this._lngLat,_.transform.tileZoom);if(_.transform.lngLatToCameraDepth(this._lngLat,P)-E<.006)return void(this._element.style.opacity=this._opacity);const R=-this._offset.y/_.transform._pixelPerMeter,g=Math.sin(_.getPitch()*Math.PI/180)*R,w=_.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),T=_.transform.lngLatToCameraDepth(this._lngLat,P+g)-w>.006;!((y=this._popup)===null||y===void 0)&&y.isOpen()&&T&&this._popup.remove(),this._element.style.opacity=T?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(l){return this._offset=o.P.convert(l),this._update(),this}addClassName(l){this._element.classList.add(l)}removeClassName(l){this._element.classList.remove(l)}toggleClassName(l){return this._element.classList.toggle(l)}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(l,d){return l===void 0&&d===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),l!==void 0&&(this._opacity=l),d!==void 0&&(this._opacityWhenCovered=d),this._map&&this._updateOpacity(!0),this}}const Bl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Wa=0,ta=!1;const du={maxWidth:100,unit:"metric"};function uA(B,l,d){const y=d&&d.maxWidth||100,_=B._container.clientHeight/2,E=B.unproject([0,_]),P=B.unproject([y,_]),R=E.distanceTo(P);if(d&&d.unit==="imperial"){const g=3.2808*R;g>5280?Cl(l,y,g/5280,B._getUIString("ScaleControl.Miles")):Cl(l,y,g,B._getUIString("ScaleControl.Feet"))}else d&&d.unit==="nautical"?Cl(l,y,R/1852,B._getUIString("ScaleControl.NauticalMiles")):R>=1e3?Cl(l,y,R/1e3,B._getUIString("ScaleControl.Kilometers")):Cl(l,y,R,B._getUIString("ScaleControl.Meters"))}function Cl(B,l,d,y){const _=function(E){const P=Math.pow(10,`${Math.floor(E)}`.length-1);let R=E/P;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(g){const w=Math.pow(10,Math.ceil(-Math.log(g)/Math.LN10));return Math.round(g*w)/w}(R),P*R}(d);B.style.width=l*(_/d)+"px",B.innerHTML=`${_}&nbsp;${y}`}const sh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},vd=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function oh(B){if(B){if(typeof B=="number"){const l=Math.round(Math.abs(B)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,B),"top-left":new o.P(l,l),"top-right":new o.P(-l,l),bottom:new o.P(0,-B),"bottom-left":new o.P(l,-l),"bottom-right":new o.P(-l,-l),left:new o.P(B,0),right:new o.P(-B,0)}}if(B instanceof o.P||Array.isArray(B)){const l=o.P.convert(B);return{center:l,top:l,"top-left":l,"top-right":l,bottom:l,"bottom-left":l,"bottom-right":l,left:l,right:l}}return{center:o.P.convert(B.center||[0,0]),top:o.P.convert(B.top||[0,0]),"top-left":o.P.convert(B["top-left"]||[0,0]),"top-right":o.P.convert(B["top-right"]||[0,0]),bottom:o.P.convert(B.bottom||[0,0]),"bottom-left":o.P.convert(B["bottom-left"]||[0,0]),"bottom-right":o.P.convert(B["bottom-right"]||[0,0]),left:o.P.convert(B.left||[0,0]),right:o.P.convert(B.right||[0,0])}}return oh(new o.P(0,0))}const ap=A;a.AJAXError=o.be,a.Evented=o.E,a.LngLat=o.M,a.MercatorCoordinate=o.Y,a.Point=o.P,a.addProtocol=o.bf,a.config=o.a,a.removeProtocol=o.bg,a.AttributionControl=Jo,a.BoxZoomHandler=Ln,a.CanvasSource=nr,a.CooperativeGesturesHandler=hr,a.DoubleClickZoomHandler=nA,a.DragPanHandler=fd,a.DragRotateHandler=Yo,a.EdgeInsets=Js,a.FullscreenControl=class extends o.E{constructor(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this._onFullscreenChange=()=>{var l;let d=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((l=d==null?void 0:d.shadowRoot)===null||l===void 0)&&l.fullscreenElement;)d=d.shadowRoot.fullscreenElement;d===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,B&&B.container&&(B.container instanceof HTMLElement?this._container=B.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(B){return this._map=B,this._container||(this._container=this._map.getContainer()),this._controlContainer=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){x.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const B=this._fullscreenButton=x.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);x.create("span","maplibregl-ctrl-icon",B).setAttribute("aria-hidden","true"),B.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const B=this._getTitle();this._fullscreenButton.setAttribute("aria-label",B),this._fullscreenButton.title=B}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},a.GeoJSONSource=Ee,a.GeolocateControl=class extends o.E{constructor(B){super(),this._onSuccess=l=>{if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new o.k("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.k("geolocate",l)),this._finish()}},this._updateCamera=l=>{const d=new o.M(l.coords.longitude,l.coords.latitude),y=l.coords.accuracy,_=this._map.getBearing(),E=o.e({bearing:_},this.options.fitBoundsOptions),P=He.fromLngLat(d,y);this._map.fitBounds(P,E,{geolocateSource:!0})},this._updateMarker=l=>{if(l){const d=new o.M(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=l.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=l=>{if(this._map){if(this.options.trackUserLocation)if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&ta)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.k("error",l)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=l=>{if(this._map){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=x.create("button","maplibregl-ctrl-geolocate",this._container),x.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",l===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=x.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new lA({element:this._dotElement}),this._circleElement=x.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new lA({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d.originalEvent&&d.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.k("trackuserlocationend")))})}},this.options=o.e({},Bl,B)}onAdd(B){return this._map=B,this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(){return o._(this,arguments,void 0,function(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return function*(){if(xa!==void 0&&!l)return xa;if(window.navigator.permissions===void 0)return xa=!!window.navigator.geolocation,xa;try{xa=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{xa=!!window.navigator.geolocation}return xa}()})}().then(l=>this._setupUI(l)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),x.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Wa=0,ta=!1}_isOutOfMapMaxBounds(B){const l=this._map.getMaxBounds(),d=B.coords;return l&&(d.longitude<l.getWest()||d.longitude>l.getEast()||d.latitude<l.getSouth()||d.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const B=this._map.getBounds(),l=B.getSouthEast(),d=B.getNorthEast(),y=l.distanceTo(d),_=Math.ceil(this._accuracy/(y/this._map._container.clientHeight)*2);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Wa--,ta=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let B;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Wa++,Wa>1?(B={maximumAge:6e5,timeout:0},ta=!0):(B=this.options.positionOptions,ta=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,B)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},a.Hash=Zs,a.ImageSource=xe,a.KeyboardHandler=Ka,a.LngLatBounds=He,a.LogoControl=gd,a.Map=class extends Ki{constructor(B){if(o.bc.mark(o.bd.create),(B=o.e({},Bo,B)).minZoom!=null&&B.maxZoom!=null&&B.minZoom>B.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(B.minPitch!=null&&B.maxPitch!=null&&B.minPitch>B.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(B.minPitch!=null&&B.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(B.maxPitch!=null&&B.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new bo(B.minZoom,B.maxZoom,B.minPitch,B.maxPitch,B.renderWorldCopies),{bearingSnap:B.bearingSnap}),this._contextLost=l=>{l.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.k("webglcontextlost",{originalEvent:l}))},this._contextRestored=l=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.k("webglcontextrestored",{originalEvent:l}))},this._onMapScroll=l=>{if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=B.interactive,this._maxTileCacheSize=B.maxTileCacheSize,this._maxTileCacheZoomLevels=B.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=B.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=B.preserveDrawingBuffer,this._antialias=B.antialias,this._trackResize=B.trackResize,this._bearingSnap=B.bearingSnap,this._refreshExpiredTiles=B.refreshExpiredTiles,this._fadeDuration=B.fadeDuration,this._crossSourceCollisions=B.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=B.collectResourceTiming,this._renderTaskQueue=new oA,this._controls=[],this._mapId=o.a3(),this._locale=o.e({},md,B.locale),this._clickTolerance=B.clickTolerance,this._overridePixelRatio=B.pixelRatio,this._maxCanvasSize=B.maxCanvasSize,this.transformCameraUpdate=B.transformCameraUpdate,this._imageQueueHandle=Y.addThrottleControl(()=>this.isMoving()),this._requestManager=new tt(B.transformRequest),typeof B.container=="string"){if(this._container=document.getElementById(B.container),!this._container)throw new Error(`Container '${B.container}' not found.`)}else{if(!(B.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=B.container}if(B.maxBounds&&this.setMaxBounds(B.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let l=!1;const d=Ec(y=>{this._trackResize&&!this._removed&&this.resize(y)._update()},50);this._resizeObserver=new ResizeObserver(y=>{l?d(y):l=!0}),this._resizeObserver.observe(this._container)}this.handlers=new sA(this,B),this._hash=B.hash&&new Zs(typeof B.hash=="string"&&B.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:B.center,zoom:B.zoom,bearing:B.bearing,pitch:B.pitch}),B.bounds&&(this.resize(),this.fitBounds(B.bounds,o.e({},B.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=B.localIdeographFontFamily,this._validateStyle=B.validateStyle,B.style&&this.setStyle(B.style,{localIdeographFontFamily:B.localIdeographFontFamily}),B.attributionControl&&this.addControl(new Jo(typeof B.attributionControl=="boolean"?void 0:B.attributionControl)),B.maplibreLogo&&this.addControl(new gd,B.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new o.k(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new o.k(`${l.dataType}dataloading`,l))}),this.on("dataabort",l=>{this.fire(new o.k("sourcedataabort",l))})}_getMapId(){return this._mapId}addControl(B,l){if(l===void 0&&(l=B.getDefaultPosition?B.getDefaultPosition():"top-right"),!B||!B.onAdd)return this.fire(new o.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=B.onAdd(this);this._controls.push(B);const y=this._controlPositions[l];return l.indexOf("bottom")!==-1?y.insertBefore(d,y.firstChild):y.appendChild(d),this}removeControl(B){if(!B||!B.onRemove)return this.fire(new o.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(B);return l>-1&&this._controls.splice(l,1),B.onRemove(this),this}hasControl(B){return this._controls.indexOf(B)>-1}calculateCameraOptionsFromTo(B,l,d,y){return y==null&&this.terrain&&(y=this.terrain.getElevationForLngLatZoom(d,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(B,l,d,y)}resize(B){var l;const d=this._containerDimensions(),y=d[0],_=d[1],E=this._getClampedPixelRatio(y,_);if(this._resizeCanvas(y,_,E),this.painter.resize(y,_,E),this.painter.overLimit()){const R=this.painter.context.gl;this._maxCanvasSize=[R.drawingBufferWidth,R.drawingBufferHeight];const g=this._getClampedPixelRatio(y,_);this._resizeCanvas(y,_,g),this.painter.resize(y,_,g)}this.transform.resize(y,_),(l=this._requestedCameraState)===null||l===void 0||l.resize(y,_);const P=!this._moving;return P&&(this.stop(),this.fire(new o.k("movestart",B)).fire(new o.k("move",B))),this.fire(new o.k("resize",B)),P&&this.fire(new o.k("moveend",B)),this}_getClampedPixelRatio(B,l){const{0:d,1:y}=this._maxCanvasSize,_=this.getPixelRatio(),E=B*_,P=l*_;return Math.min(E>d?d/E:1,P>y?y/P:1)*_}getPixelRatio(){var B;return(B=this._overridePixelRatio)!==null&&B!==void 0?B:devicePixelRatio}setPixelRatio(B){this._overridePixelRatio=B,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(B){return this.transform.setMaxBounds(He.convert(B)),this._update()}setMinZoom(B){if((B=B??-2)>=-2&&B<=this.transform.maxZoom)return this.transform.minZoom=B,this._update(),this.getZoom()<B&&this.setZoom(B),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(B){if((B=B??22)>=this.transform.minZoom)return this.transform.maxZoom=B,this._update(),this.getZoom()>B&&this.setZoom(B),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(B){if((B=B??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(B>=0&&B<=this.transform.maxPitch)return this.transform.minPitch=B,this._update(),this.getPitch()<B&&this.setPitch(B),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(B){if((B=B??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(B>=this.transform.minPitch)return this.transform.maxPitch=B,this._update(),this.getPitch()>B&&this.setPitch(B),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(B){return this.transform.renderWorldCopies=B,this._update()}project(B){return this.transform.locationPoint(o.M.convert(B),this.style&&this.terrain)}unproject(B){return this.transform.pointLocation(o.P.convert(B),this.terrain)}isMoving(){var B;return this._moving||((B=this.handlers)===null||B===void 0?void 0:B.isMoving())}isZooming(){var B;return this._zooming||((B=this.handlers)===null||B===void 0?void 0:B.isZooming())}isRotating(){var B;return this._rotating||((B=this.handlers)===null||B===void 0?void 0:B.isRotating())}_createDelegatedListener(B,l,d){if(B==="mouseenter"||B==="mouseover"){let y=!1;return{layer:l,listener:d,delegates:{mousemove:E=>{const P=this.getLayer(l)?this.queryRenderedFeatures(E.point,{layers:[l]}):[];P.length?y||(y=!0,d.call(this,new Bi(B,this,E.originalEvent,{features:P}))):y=!1},mouseout:()=>{y=!1}}}}if(B==="mouseleave"||B==="mouseout"){let y=!1;return{layer:l,listener:d,delegates:{mousemove:P=>{(this.getLayer(l)?this.queryRenderedFeatures(P.point,{layers:[l]}):[]).length?y=!0:y&&(y=!1,d.call(this,new Bi(B,this,P.originalEvent)))},mouseout:P=>{y&&(y=!1,d.call(this,new Bi(B,this,P.originalEvent)))}}}}{const y=_=>{const E=this.getLayer(l)?this.queryRenderedFeatures(_.point,{layers:[l]}):[];E.length&&(_.features=E,d.call(this,_),delete _.features)};return{layer:l,listener:d,delegates:{[B]:y}}}}on(B,l,d){if(d===void 0)return super.on(B,l);const y=this._createDelegatedListener(B,l,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[B]=this._delegatedListeners[B]||[],this._delegatedListeners[B].push(y);for(const _ in y.delegates)this.on(_,y.delegates[_]);return this}once(B,l,d){if(d===void 0)return super.once(B,l);const y=this._createDelegatedListener(B,l,d);for(const _ in y.delegates)this.once(_,y.delegates[_]);return this}off(B,l,d){return d===void 0?super.off(B,l):(this._delegatedListeners&&this._delegatedListeners[B]&&(y=>{const _=this._delegatedListeners[B];for(let E=0;E<_.length;E++){const P=_[E];if(P.layer===l&&P.listener===d){for(const R in P.delegates)this.off(R,P.delegates[R]);return _.splice(E,1),this}}})(),this)}queryRenderedFeatures(B,l){if(!this.style)return[];let d;const y=B instanceof o.P||Array.isArray(B),_=y?B:[[0,0],[this.transform.width,this.transform.height]];if(l=l||(y?{}:B)||{},_ instanceof o.P||typeof _[0]=="number")d=[o.P.convert(_)];else{const E=o.P.convert(_[0]),P=o.P.convert(_[1]);d=[E,new o.P(P.x,E.y),P,new o.P(E.x,P.y),E]}return this.style.queryRenderedFeatures(d,l,this.transform)}querySourceFeatures(B,l){return this.style.querySourceFeatures(B,l)}setStyle(B,l){return(l=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&B?(this._diffStyle(B,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._updateStyle(B,l))}setTransformRequest(B){return this._requestManager.setTransformRequest(B),this}_getUIString(B){const l=this._locale[B];if(l==null)throw new Error(`Missing UI string '${B}'`);return l}_updateStyle(B,l){if(l.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(B,l));const d=this.style&&l.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!B)),B?(this.style=new Fi(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof B=="string"?this.style.loadURL(B,l,d):this.style.loadJSON(B,l,d),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Fi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(B,l){if(typeof B=="string"){const d=this._requestManager.transformRequest(B,"Style");o.h(d,new AbortController).then(y=>{this._updateDiff(y.data,l)}).catch(y=>{y&&this.fire(new o.j(y))})}else typeof B=="object"&&this._updateDiff(B,l)}_updateDiff(B,l){try{this.style.setState(B,l)&&this._update(!0)}catch(d){o.w(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(B,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(B,l){return this._lazyInitEmptyStyle(),this.style.addSource(B,l),this._update(!0)}isSourceLoaded(B){const l=this.style&&this.style.sourceCaches[B];if(l!==void 0)return l.loaded();this.fire(new o.j(new Error(`There is no source with ID '${B}'`)))}setTerrain(B){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),B){const l=this.style.sourceCaches[B.source];if(!l)throw new Error(`cannot load terrain, because there exists no source with ID: ${B.source}`);this.terrain===null&&l.reload();for(const d in this.style._layers){const y=this.style._layers[d];y.type==="hillshade"&&y.source===B.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new op(this.painter,l,B),this.painter.renderToTexture=new Zo(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=d=>{d.dataType==="style"?this.terrain.sourceCache.freeRtt():d.dataType==="source"&&d.tile&&(d.sourceId!==B.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(d.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new o.k("terrain",{terrain:B})),this}getTerrain(){var B,l;return(l=(B=this.terrain)===null||B===void 0?void 0:B.options)!==null&&l!==void 0?l:null}areTilesLoaded(){const B=this.style&&this.style.sourceCaches;for(const l in B){const d=B[l]._tiles;for(const y in d){const _=d[y];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}removeSource(B){return this.style.removeSource(B),this._update(!0)}getSource(B){return this.style.getSource(B)}addImage(B,l){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{pixelRatio:y=1,sdf:_=!1,stretchX:E,stretchY:P,content:R}=d;if(this._lazyInitEmptyStyle(),!(l instanceof HTMLImageElement||o.b(l))){if(l.width===void 0||l.height===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:g,height:w,data:T}=l,L=l;return this.style.addImage(B,{data:new o.R({width:g,height:w},new Uint8Array(T)),pixelRatio:y,stretchX:E,stretchY:P,content:R,sdf:_,version:0,userImage:L}),L.onAdd&&L.onAdd(this,B),this}}{const{width:g,height:w,data:T}=b.getImageData(l);this.style.addImage(B,{data:new o.R({width:g,height:w},T),pixelRatio:y,stretchX:E,stretchY:P,content:R,sdf:_,version:0})}}updateImage(B,l){const d=this.style.getImage(B);if(!d)return this.fire(new o.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=l instanceof HTMLImageElement||o.b(l)?b.getImageData(l):l,{width:_,height:E,data:P}=y;if(_===void 0||E===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==d.data.width||E!==d.data.height)return this.fire(new o.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const R=!(l instanceof HTMLImageElement||o.b(l));return d.data.replace(P,R),this.style.updateImage(B,d),this}getImage(B){return this.style.getImage(B)}hasImage(B){return B?!!this.style.getImage(B):(this.fire(new o.j(new Error("Missing required image id"))),!1)}removeImage(B){this.style.removeImage(B)}loadImage(B){return Y.getImage(this._requestManager.transformRequest(B,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(B,l){return this._lazyInitEmptyStyle(),this.style.addLayer(B,l),this._update(!0)}moveLayer(B,l){return this.style.moveLayer(B,l),this._update(!0)}removeLayer(B){return this.style.removeLayer(B),this._update(!0)}getLayer(B){return this.style.getLayer(B)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(B,l,d){return this.style.setLayerZoomRange(B,l,d),this._update(!0)}setFilter(B,l){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.style.setFilter(B,l,d),this._update(!0)}getFilter(B){return this.style.getFilter(B)}setPaintProperty(B,l,d){let y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.style.setPaintProperty(B,l,d,y),this._update(!0)}getPaintProperty(B,l){return this.style.getPaintProperty(B,l)}setLayoutProperty(B,l,d){let y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.style.setLayoutProperty(B,l,d,y),this._update(!0)}getLayoutProperty(B,l){return this.style.getLayoutProperty(B,l)}setGlyphs(B){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setGlyphs(B,l),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(B,l){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._lazyInitEmptyStyle(),this.style.addSprite(B,l,d,y=>{y||this._update(!0)}),this}removeSprite(B){return this._lazyInitEmptyStyle(),this.style.removeSprite(B),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(B){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setSprite(B,l,d=>{d||this._update(!0)}),this}setLight(B){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setLight(B,l),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(B,l){return this.style.setFeatureState(B,l),this._update()}removeFeatureState(B,l){return this.style.removeFeatureState(B,l),this._update()}getFeatureState(B){return this.style.getFeatureState(B)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let B=0,l=0;return this._container&&(B=this._container.clientWidth||400,l=this._container.clientHeight||300),[B,l]}_setupContainer(){const B=this._container;B.classList.add("maplibregl-map");const l=this._canvasContainer=x.create("div","maplibregl-canvas-container",B);this._interactive&&l.classList.add("maplibregl-interactive"),this._canvas=x.create("canvas","maplibregl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const d=this._containerDimensions(),y=this._getClampedPixelRatio(d[0],d[1]);this._resizeCanvas(d[0],d[1],y);const _=this._controlContainer=x.create("div","maplibregl-control-container",B),E=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(P=>{E[P]=x.create("div",`maplibregl-ctrl-${P} `,_)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(B,l,d){this._canvas.width=Math.floor(d*B),this._canvas.height=Math.floor(d*l),this._canvas.style.width=`${B}px`,this._canvas.style.height=`${l}px`}_setupPainter(){const B={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let l=null;this._canvas.addEventListener("webglcontextcreationerror",y=>{l={requestedAttributes:B},y&&(l.statusMessage=y.statusMessage,l.type=y.type)},{once:!0});const d=this._canvas.getContext("webgl2",B)||this._canvas.getContext("webgl",B);if(!d){const y="Failed to initialize WebGL";throw l?(l.message=y,new Error(JSON.stringify(l))):new Error(y)}this.painter=new Ga(d,this.transform),C.testSupport(d)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(B){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||B,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(B){return this._update(),this._renderTaskQueue.add(B)}_cancelRenderFrame(B){this._renderTaskQueue.remove(B)}_render(B){const l=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(B),this._removed)return;let d=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const _=this.transform.zoom,E=b.now();this.style.zoomHistory.update(_,E);const P=new o.a8(_,{now:E,fadeDuration:l,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),R=P.crossFadingFactor();R===1&&R===this._crossFadingFactor||(d=!0,this._crossFadingFactor=R),this.style.update(P)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,l,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:l,showPadding:this.showPadding}),this.fire(new o.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.bc.mark(o.bd.load),this.fire(new o.k("load"))),this.style&&(this.style.hasTransitions()||d)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const y=this._sourcesDirty||this._styleDirty||this._placementDirty;return y||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.k("idle")),!this._loaded||this._fullyLoaded||y||(this._fullyLoaded=!0,o.bc.mark(o.bd.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var B;this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Y.removeThrottleControl(this._imageQueueHandle),(B=this._resizeObserver)===null||B===void 0||B.disconnect();const l=this.painter.context.gl.getExtension("WEBGL_lose_context");l&&l.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),x.remove(this._canvasContainer),x.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),o.bc.clearMetrics(),this._removed=!0,this.fire(new o.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,b.frameAsync(this._frameRequest).then(B=>{o.bc.frame(B),this._frameRequest=null,this._render(B)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(B){this._showTileBoundaries!==B&&(this._showTileBoundaries=B,this._update())}get showPadding(){return!!this._showPadding}set showPadding(B){this._showPadding!==B&&(this._showPadding=B,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(B){this._showCollisionBoxes!==B&&(this._showCollisionBoxes=B,B?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(B){this._showOverdrawInspector!==B&&(this._showOverdrawInspector=B,this._update())}get repaint(){return!!this._repaint}set repaint(B){this._repaint!==B&&(this._repaint=B,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(B){this._vertices=B,this._update()}get version(){return ih}getCameraTargetElevation(){return this.transform.elevation}},a.MapMouseEvent=Bi,a.MapTouchEvent=Ns,a.MapWheelEvent=Qs,a.Marker=lA,a.NavigationControl=class{constructor(B){this._updateZoomButtons=()=>{const l=this._map.getZoom(),d=l===this._map.getMaxZoom(),y=l===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())},this._rotateCompassArrow=()=>{const l=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=l},this._setButtonTitle=(l,d)=>{const y=this._map._getUIString(`NavigationControl.${d}`);l.title=y,l.setAttribute("aria-label",y)},this.options=o.e({},yd,B),this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",l=>this._map.zoomIn({},{originalEvent:l})),x.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",l=>this._map.zoomOut({},{originalEvent:l})),x.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})}),this._compassIcon=x.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(B){return this._map=B,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new _d(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){x.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(B,l){const d=x.create("button",B,this._container);return d.type="button",d.addEventListener("click",l),d}},a.Popup=class extends o.E{constructor(B){super(),this.remove=()=>(this._content&&x.remove(this._content),this._container&&(x.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.k("close"))),this),this._onMouseUp=l=>{this._update(l.point)},this._onMouseMove=l=>{this._update(l.point)},this._onDrag=l=>{this._update(l.point)},this._update=l=>{var d;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=x.create("div","maplibregl-popup",this._map.getContainer()),this._tip=x.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const R of this.options.className.split(" "))this._container.classList.add(R);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?aA(this._lngLat,this._flatPos,this._map.transform):(d=this._lngLat)===null||d===void 0?void 0:d.wrap(),this._trackPointer&&!l)return;const y=this._flatPos=this._pos=this._trackPointer&&l?l:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&l?l:this._map.transform.locationPoint(this._lngLat));let _=this.options.anchor;const E=oh(this.options.offset);if(!_){const R=this._container.offsetWidth,g=this._container.offsetHeight;let w;w=y.y+E.bottom.y<g?["top"]:y.y>this._map.transform.height-g?["bottom"]:[],y.x<R/2?w.push("left"):y.x>this._map.transform.width-R/2&&w.push("right"),_=w.length===0?"bottom":w.join("-")}let P=y.add(E[_]);this.options.subpixelPositioning||(P=P.round()),x.setTransform(this._container,`${hu[_]} translate(${P.x}px,${P.y}px)`),cA(this._container,_,"popup")},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(sh),B)}addTo(B){return this._map&&this.remove(),this._map=B,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(B){return this._lngLat=o.M.convert(B),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(B){return this.setDOMContent(document.createTextNode(B))}setHTML(B){const l=document.createDocumentFragment(),d=document.createElement("body");let y;for(d.innerHTML=B;y=d.firstChild,y;)l.appendChild(y);return this.setDOMContent(l)}getMaxWidth(){var B;return(B=this._container)===null||B===void 0?void 0:B.style.maxWidth}setMaxWidth(B){return this.options.maxWidth=B,this._update(),this}setDOMContent(B){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=x.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(B),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(B){this._container&&this._container.classList.add(B)}removeClassName(B){this._container&&this._container.classList.remove(B)}setOffset(B){return this.options.offset=B,this._update(),this}toggleClassName(B){if(this._container)return this._container.classList.toggle(B)}setSubpixelPositioning(B){this.options.subpixelPositioning=B}_createCloseButton(){this.options.closeButton&&(this._closeButton=x.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const B=this._container.querySelector(vd);B&&B.focus()}},a.RasterDEMTileSource=tr,a.RasterTileSource=Yt,a.ScaleControl=class{constructor(B){this._onMove=()=>{uA(this._map,this._container,this.options)},this.setUnit=l=>{this.options.unit=l,uA(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},du),B)}getDefaultPosition(){return"bottom-left"}onAdd(B){return this._map=B,this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-scale",B.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){x.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},a.ScrollZoomHandler=wl,a.Style=Fi,a.TerrainControl=class{constructor(B){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=B}onAdd(B){return this._map=B,this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=x.create("button","maplibregl-ctrl-terrain",this._container),x.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){x.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},a.TwoFingersTouchPitchHandler=rA,a.TwoFingersTouchRotateHandler=rh,a.TwoFingersTouchZoomHandler=eA,a.TwoFingersTouchZoomRotateHandler=iA,a.VectorTileSource=Ut,a.VideoSource=De,a.addSourceType=(B,l)=>o._(void 0,void 0,void 0,function*(){if(Ir(B))throw new Error(`A source type called "${B}" already exists.`);((d,y)=>{ur[d]=y})(B,l)}),a.clearPrewarmedResources=function(){const B=Ot;B&&(B.isPreloaded()&&B.numActive()===1?(B.release(it),Ot=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},a.getRTLTextPluginStatus=function(){return fe().getRTLTextPluginStatus()},a.getVersion=function(){return ap},a.getWorkerCount=function(){return vt.workerCount},a.getWorkerUrl=function(){return o.a.WORKER_URL},a.importScriptInWorkers=function(B){return ie().broadcast("IS",B)},a.prewarm=function(){jt().acquire(it)},a.setMaxParallelImageRequests=function(B){o.a.MAX_PARALLEL_IMAGE_REQUESTS=B},a.setRTLTextPlugin=function(B,l){return fe().setRTLTextPlugin(B,l)},a.setWorkerCount=function(B){vt.workerCount=B},a.setWorkerUrl=function(B){o.a.WORKER_URL=B}});var s=e;return s})})(HE);var zE=HE.exports;const Ss=xp(zE);var Ts;(function(r){r[r.Unknown=0]="Unknown",r[r.Point=1]="Point",r[r.LineString=2]="LineString",r[r.Polygon=3]="Polygon",r[r.MultiPoint=4]="MultiPoint",r[r.MultiLineString=5]="MultiLineString",r[r.MultiPolygon=6]="MultiPolygon",r[r.GeometryCollection=7]="GeometryCollection",r[r.CircularString=8]="CircularString",r[r.CompoundCurve=9]="CompoundCurve",r[r.CurvePolygon=10]="CurvePolygon",r[r.MultiCurve=11]="MultiCurve",r[r.MultiSurface=12]="MultiSurface",r[r.Curve=13]="Curve",r[r.Surface=14]="Surface",r[r.PolyhedralSurface=15]="PolyhedralSurface",r[r.TIN=16]="TIN",r[r.Triangle=17]="Triangle"})(Ts||(Ts={}));const Bp=4,Cp=4,Ep=4,yA=new Int32Array(2),GE=new Float32Array(yA.buffer),VE=new Float64Array(yA.buffer),Nm=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var H_;(function(r){r[r.UTF8_BYTES=1]="UTF8_BYTES",r[r.UTF16_STRING=2]="UTF16_STRING"})(H_||(H_={}));class _u{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new _u(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return yA[0]=this.readInt32(t),GE[0]}readFloat64(t){return yA[Nm?0:1]=this.readInt32(t),yA[Nm?1:0]=this.readInt32(t+4),VE[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,Number(BigInt.asIntN(32,e))),this.writeInt32(t+4,Number(BigInt.asIntN(32,e>>BigInt(32))))}writeUint64(t,e){this.writeUint32(t,Number(BigInt.asUintN(32,e))),this.writeUint32(t+4,Number(BigInt.asUintN(32,e>>BigInt(32))))}writeFloat32(t,e){GE[0]=e,this.writeInt32(t,yA[0])}writeFloat64(t,e){VE[0]=e,this.writeInt32(t,yA[Nm?0:1]),this.writeInt32(t+4,yA[Nm?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+Bp+Cp)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<Cp;e++)t+=String.fromCharCode(this.readInt8(this.position_+Bp+e));return t}__offset(t,e){const n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const n=this.readInt32(t);t+=Bp;const i=this.bytes_.subarray(t,t+n);return e===H_.UTF8_BYTES?i:this.text_decoder_.decode(i)}__union_with_string(t,e){return typeof t=="string"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+Bp}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=Cp)throw new Error("FlatBuffers: file identifier must be length "+Cp);for(let e=0;e<Cp;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+Bp+e))return!1;return!0}createScalarList(t,e){const n=[];for(let i=0;i<e;++i){const s=t(i);s!==null&&n.push(s)}return n}createObjList(t,e){const n=[];for(let i=0;i<e;++i){const s=t(i);s!==null&&n.push(s.unpack())}return n}}let Tk=class Ea{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsGeometry(t,e){return(e||new Ea).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsGeometry(t,e){return t.setPosition(t.position()+Ep),(e||new Ea).__init(t.readInt32(t.position())+t.position(),t)}ends(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}endsLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}endsArray(){const t=this.bb.__offset(this.bb_pos,4);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}xy(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+t*8):0}xyLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}xyArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}z(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+t*8):0}zLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}zArray(){const t=this.bb.__offset(this.bb_pos,8);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}m(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+t*8):0}mLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}mArray(){const t=this.bb.__offset(this.bb_pos,10);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}t(t){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+t*8):0}tLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}tArray(){const t=this.bb.__offset(this.bb_pos,12);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}tm(t){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readUint64(this.bb.__vector(this.bb_pos+e)+t*8):BigInt(0)}tmLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}type(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readUint8(this.bb_pos+t):Ts.Unknown}parts(t,e){const n=this.bb.__offset(this.bb_pos,18);return n?(e||new Ea).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}partsLength(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}static startGeometry(t){t.startObject(8)}static addEnds(t,e){t.addFieldOffset(0,e,0)}static createEndsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addInt32(e[n]);return t.endVector()}static startEndsVector(t,e){t.startVector(4,e,4)}static addXy(t,e){t.addFieldOffset(1,e,0)}static createXyVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startXyVector(t,e){t.startVector(8,e,8)}static addZ(t,e){t.addFieldOffset(2,e,0)}static createZVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startZVector(t,e){t.startVector(8,e,8)}static addM(t,e){t.addFieldOffset(3,e,0)}static createMVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startMVector(t,e){t.startVector(8,e,8)}static addT(t,e){t.addFieldOffset(4,e,0)}static createTVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startTVector(t,e){t.startVector(8,e,8)}static addTm(t,e){t.addFieldOffset(5,e,0)}static createTmVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addInt64(e[n]);return t.endVector()}static startTmVector(t,e){t.startVector(8,e,8)}static addType(t,e){t.addFieldInt8(6,e,Ts.Unknown)}static addParts(t,e){t.addFieldOffset(7,e,0)}static createPartsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startPartsVector(t,e){t.startVector(4,e,4)}static endGeometry(t){return t.endObject()}static createGeometry(t,e,n,i,s,a,o,A,f){return Ea.startGeometry(t),Ea.addEnds(t,e),Ea.addXy(t,n),Ea.addZ(t,i),Ea.addM(t,s),Ea.addT(t,a),Ea.addTm(t,o),Ea.addType(t,A),Ea.addParts(t,f),Ea.endGeometry(t)}};function z_(r,t){const e=[];for(let n=0;n<r.length;n+=2){const i=[r[n],r[n+1]];t&&i.push(t[n>>1]),e.push(i)}return e}function jE(r,t,e){if(!e||e.length===0)return[z_(r,t)];let n=0;const i=Array.from(e).map(a=>r.slice(n,n=a<<1));let s;return t&&(n=0,s=Array.from(e).map(a=>t.slice(n,n=a))),i.map((a,o)=>z_(a,s?s[o]:void 0))}function Ik(r,t){const e=r.xyArray(),n=r.zArray();switch(t){case Ts.Point:{const i=Array.from(e);return n&&i.push(n[0]),i}case Ts.MultiPoint:case Ts.LineString:return z_(e,n);case Ts.MultiLineString:return jE(e,n,r.endsArray());case Ts.Polygon:return jE(e,n,r.endsArray())}}function G_(r,t){let e=t;if(e===Ts.Unknown&&(e=r.type()),e===Ts.GeometryCollection){const i=[];for(let s=0;s<r.partsLength();s++){const a=r.parts(s),o=a.type();i.push(G_(a,o))}return{type:Ts[e],geometries:i}}else if(e===Ts.MultiPolygon){const i=[];for(let s=0;s<r.partsLength();s++)i.push(G_(r.parts(s),Ts.Polygon));return{type:Ts[e],coordinates:i.map(s=>s.coordinates)}}const n=Ik(r,e);return{type:Ts[e],coordinates:n}}var Is;(function(r){r[r.Byte=0]="Byte",r[r.UByte=1]="UByte",r[r.Bool=2]="Bool",r[r.Short=3]="Short",r[r.UShort=4]="UShort",r[r.Int=5]="Int",r[r.UInt=6]="UInt",r[r.Long=7]="Long",r[r.ULong=8]="ULong",r[r.Float=9]="Float",r[r.Double=10]="Double",r[r.String=11]="String",r[r.Json=12]="Json",r[r.DateTime=13]="DateTime",r[r.Binary=14]="Binary"})(Is||(Is={}));class Ls{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsColumn(t,e){return(e||new Ls).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsColumn(t,e){return t.setPosition(t.position()+Ep),(e||new Ls).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}type(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):Is.Byte}title(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,t):null}width(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt32(this.bb_pos+t):-1}precision(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt32(this.bb_pos+t):-1}scale(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readInt32(this.bb_pos+t):-1}nullable(){const t=this.bb.__offset(this.bb_pos,18);return t?!!this.bb.readInt8(this.bb_pos+t):!0}unique(){const t=this.bb.__offset(this.bb_pos,20);return t?!!this.bb.readInt8(this.bb_pos+t):!1}primaryKey(){const t=this.bb.__offset(this.bb_pos,22);return t?!!this.bb.readInt8(this.bb_pos+t):!1}metadata(t){const e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__string(this.bb_pos+e,t):null}static startColumn(t){t.startObject(11)}static addName(t,e){t.addFieldOffset(0,e,0)}static addType(t,e){t.addFieldInt8(1,e,Is.Byte)}static addTitle(t,e){t.addFieldOffset(2,e,0)}static addDescription(t,e){t.addFieldOffset(3,e,0)}static addWidth(t,e){t.addFieldInt32(4,e,-1)}static addPrecision(t,e){t.addFieldInt32(5,e,-1)}static addScale(t,e){t.addFieldInt32(6,e,-1)}static addNullable(t,e){t.addFieldInt8(7,+e,1)}static addUnique(t,e){t.addFieldInt8(8,+e,0)}static addPrimaryKey(t,e){t.addFieldInt8(9,+e,0)}static addMetadata(t,e){t.addFieldOffset(10,e,0)}static endColumn(t){const e=t.endObject();return t.requiredField(e,4),e}static createColumn(t,e,n,i,s,a,o,A,f,m,b,x){return Ls.startColumn(t),Ls.addName(t,e),Ls.addType(t,n),Ls.addTitle(t,i),Ls.addDescription(t,s),Ls.addWidth(t,a),Ls.addPrecision(t,o),Ls.addScale(t,A),Ls.addNullable(t,f),Ls.addUnique(t,m),Ls.addPrimaryKey(t,b),Ls.addMetadata(t,x),Ls.endColumn(t)}}class Uc{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFeature(t,e){return(e||new Uc).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFeature(t,e){return t.setPosition(t.position()+Ep),(e||new Uc).__init(t.readInt32(t.position())+t.position(),t)}geometry(t){const e=this.bb.__offset(this.bb_pos,4);return e?(t||new Tk).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}properties(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}propertiesLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}propertiesArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}columns(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new Ls).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}columnsLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFeature(t){t.startObject(3)}static addGeometry(t,e){t.addFieldOffset(0,e,0)}static addProperties(t,e){t.addFieldOffset(1,e,0)}static createPropertiesVector(t,e){t.startVector(1,e.length,1);for(let n=e.length-1;n>=0;n--)t.addInt8(e[n]);return t.endVector()}static startPropertiesVector(t,e){t.startVector(1,e,1)}static addColumns(t,e){t.addFieldOffset(2,e,0)}static createColumnsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startColumnsVector(t,e){t.startVector(4,e,4)}static endFeature(t){return t.endObject()}static finishFeatureBuffer(t,e){t.finish(e)}static finishSizePrefixedFeatureBuffer(t,e){t.finish(e,void 0,!0)}static createFeature(t,e,n,i){return Uc.startFeature(t),Uc.addGeometry(t,e),Uc.addProperties(t,n),Uc.addColumns(t,i),Uc.endFeature(t)}}new TextEncoder;const qE=new TextDecoder;function Lk(r,t){const e={};if(!t||t.length===0)return e;const n=r.propertiesArray();if(!n)return e;const i=new DataView(n.buffer,n.byteOffset),s=r.propertiesLength();let a=0;for(;a<s;){const o=i.getUint16(a,!0);a+=2;const A=t[o],f=A.name;switch(A.type){case Is.Bool:{e[f]=!!i.getUint8(a),a+=1;break}case Is.Byte:{e[f]=i.getInt8(a),a+=1;break}case Is.UByte:{e[f]=i.getUint8(a),a+=1;break}case Is.Short:{e[f]=i.getInt16(a,!0),a+=2;break}case Is.UShort:{e[f]=i.getUint16(a,!0),a+=2;break}case Is.Int:{e[f]=i.getInt32(a,!0),a+=4;break}case Is.UInt:{e[f]=i.getUint32(a,!0),a+=4;break}case Is.Long:{e[f]=Number(i.getBigInt64(a,!0)),a+=8;break}case Is.ULong:{e[f]=Number(i.getBigUint64(a,!0)),a+=8;break}case Is.Float:{e[f]=i.getFloat32(a,!0),a+=4;break}case Is.Double:{e[f]=i.getFloat64(a,!0),a+=8;break}case Is.DateTime:case Is.String:{const m=i.getUint32(a,!0);a+=4,e[f]=qE.decode(n.subarray(a,a+m)),a+=m;break}case Is.Json:{const m=i.getUint32(a,!0);a+=4;const b=qE.decode(n.subarray(a,a+m));e[f]=JSON.parse(b),a+=m;break}default:throw new Error("Unknown type "+A.type)}}return e}function V_(r,t){const e=t.columns;return{type:"Feature",geometry:G_(r.geometry(),t.geometryType),properties:Lk(r,e)}}const j_=new Uint8Array(0);function Fk(){return this._source.cancel()}function Mk(r,t){if(!r.length)return t;if(!t.length)return r;var e=new Uint8Array(r.length+t.length);return e.set(r),e.set(t,r.length),e}function Pk(){var r=this,t=r._array.subarray(r._index);return r._source.read().then(function(e){return r._array=j_,r._index=0,e.done?t.length>0?{done:!1,value:t}:{done:!0,value:void 0}:{done:!1,value:Mk(t,e.value)}})}function Uk(r){if((r|=0)<0)throw new Error("invalid length");var t=this,e=this._array.length-this._index;if(this._index+r<=this._array.length)return Promise.resolve(this._array.subarray(this._index,this._index+=r));var n=new Uint8Array(r);return n.set(this._array.subarray(this._index)),function i(){return t._source.read().then(function(s){return s.done?(t._array=j_,t._index=0,e>0?n.subarray(0,e):null):e+s.value.length>=r?(t._array=s.value,t._index=r-e,n.set(s.value.subarray(0,r-e),e),n):(n.set(s.value,e),e+=s.value.length,i())})}()}function Rk(r){return typeof r.slice=="function"?r:new Qm(typeof r.read=="function"?r:r.getReader())}function Qm(r){this._source=r,this._array=j_,this._index=0}Qm.prototype.read=Pk,Qm.prototype.slice=Uk,Qm.prototype.cancel=Fk;class Ja{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsCrs(t,e){return(e||new Ja).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsCrs(t,e){return t.setPosition(t.position()+Ep),(e||new Ja).__init(t.readInt32(t.position())+t.position(),t)}org(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}code(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}name(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,t):null}wkt(t){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__string(this.bb_pos+e,t):null}codeString(t){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__string(this.bb_pos+e,t):null}static startCrs(t){t.startObject(6)}static addOrg(t,e){t.addFieldOffset(0,e,0)}static addCode(t,e){t.addFieldInt32(1,e,0)}static addName(t,e){t.addFieldOffset(2,e,0)}static addDescription(t,e){t.addFieldOffset(3,e,0)}static addWkt(t,e){t.addFieldOffset(4,e,0)}static addCodeString(t,e){t.addFieldOffset(5,e,0)}static endCrs(t){return t.endObject()}static createCrs(t,e,n,i,s,a,o){return Ja.startCrs(t),Ja.addOrg(t,e),Ja.addCode(t,n),Ja.addName(t,i),Ja.addDescription(t,s),Ja.addWkt(t,a),Ja.addCodeString(t,o),Ja.endCrs(t)}}class Hm{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsHeader(t,e){return(e||new Hm).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsHeader(t,e){return t.setPosition(t.position()+Ep),(e||new Hm).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}envelope(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+t*8):0}envelopeLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}envelopeArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}geometryType(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):Ts.Unknown}hasZ(){const t=this.bb.__offset(this.bb_pos,10);return t?!!this.bb.readInt8(this.bb_pos+t):!1}hasM(){const t=this.bb.__offset(this.bb_pos,12);return t?!!this.bb.readInt8(this.bb_pos+t):!1}hasT(){const t=this.bb.__offset(this.bb_pos,14);return t?!!this.bb.readInt8(this.bb_pos+t):!1}hasTm(){const t=this.bb.__offset(this.bb_pos,16);return t?!!this.bb.readInt8(this.bb_pos+t):!1}columns(t,e){const n=this.bb.__offset(this.bb_pos,18);return n?(e||new Ls).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}columnsLength(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}featuresCount(){const t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readUint64(this.bb_pos+t):BigInt("0")}indexNodeSize(){const t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readUint16(this.bb_pos+t):16}crs(t){const e=this.bb.__offset(this.bb_pos,24);return e?(t||new Ja).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}title(t){const e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){const e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__string(this.bb_pos+e,t):null}metadata(t){const e=this.bb.__offset(this.bb_pos,30);return e?this.bb.__string(this.bb_pos+e,t):null}static startHeader(t){t.startObject(14)}static addName(t,e){t.addFieldOffset(0,e,0)}static addEnvelope(t,e){t.addFieldOffset(1,e,0)}static createEnvelopeVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startEnvelopeVector(t,e){t.startVector(8,e,8)}static addGeometryType(t,e){t.addFieldInt8(2,e,Ts.Unknown)}static addHasZ(t,e){t.addFieldInt8(3,+e,0)}static addHasM(t,e){t.addFieldInt8(4,+e,0)}static addHasT(t,e){t.addFieldInt8(5,+e,0)}static addHasTm(t,e){t.addFieldInt8(6,+e,0)}static addColumns(t,e){t.addFieldOffset(7,e,0)}static createColumnsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startColumnsVector(t,e){t.startVector(4,e,4)}static addFeaturesCount(t,e){t.addFieldInt64(8,e,BigInt("0"))}static addIndexNodeSize(t,e){t.addFieldInt16(9,e,16)}static addCrs(t,e){t.addFieldOffset(10,e,0)}static addTitle(t,e){t.addFieldOffset(11,e,0)}static addDescription(t,e){t.addFieldOffset(12,e,0)}static addMetadata(t,e){t.addFieldOffset(13,e,0)}static endHeader(t){return t.endObject()}static finishHeaderBuffer(t,e){t.finish(e)}static finishSizePrefixedHeaderBuffer(t,e){t.finish(e,void 0,!0)}}function q_(r){const t=Hm.getRootAsHeader(r),e=t.featuresCount(),n=t.indexNodeSize(),i=[];for(let A=0;A<t.columnsLength();A++){const f=t.columns(A);if(!f)throw new Error("Column unexpectedly missing");if(!f.name())throw new Error("Column name unexpectedly missing");i.push({name:f.name(),type:f.type(),title:f.title(),description:f.description(),width:f.width(),precision:f.precision(),scale:f.scale(),nullable:f.nullable(),unique:f.unique(),primary_key:f.primaryKey()})}const s=t.crs(),a=s?{org:s.org(),code:s.code(),name:s.name(),description:s.description(),wkt:s.wkt(),code_string:s.codeString()}:null;return{geometryType:t.geometryType(),columns:i,envelope:null,featuresCount:Number(e),indexNodeSize:n,crs:a,title:t.title(),description:t.description(),metadata:t.metadata()}}/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var K_=function(r,t){return K_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])},K_(r,t)};function Ok(r,t){K_(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function Fd(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(m){try{f(n.next(m))}catch(b){a(b)}}function A(m){try{f(n.throw(m))}catch(b){a(b)}}function f(m){m.done?s(m.value):i(m.value).then(o,A)}f((n=n.apply(r,t||[])).next())})}function _A(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(f){return function(m){return A([f,m])}}function A(f){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return e.label++,{value:f[1],done:!1};case 5:e.label++,i=f[1],f=[0];continue;case 7:f=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){e=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){e.label=f[1];break}if(f[0]===6&&e.label<s[1]){e.label=s[1],s=f;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(f);break}s[2]&&e.ops.pop(),e.trys.pop();continue}f=t.call(r,e)}catch(m){f=[6,m],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Md(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Sp(r){return this instanceof Sp?(this.v=r,this):new Sp(r)}function Dk(r,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(r,t||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(x){n[x]&&(i[x]=function(C){return new Promise(function(M,U){s.push([x,C,M,U])>1||o(x,C)})})}function o(x,C){try{A(n[x](C))}catch(M){b(s[0][3],M)}}function A(x){x.value instanceof Sp?Promise.resolve(x.value.v).then(f,m):b(s[0][2],x)}function f(x){o("next",x)}function m(x){o("throw",x)}function b(x,C){x(C),s.shift(),s.length&&o(s[0][0],s[0][1])}}var KE=function(r){Ok(t,r);function t(e){var n=r.call(this,e)||this;return Object.defineProperty(n,"name",{value:"RepeaterOverflowError",enumerable:!1}),typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(n,n.constructor.prototype):n.__proto__=n.constructor.prototype,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(n,n.constructor),n}return t}(Error);(function(){function r(t){if(t<0)throw new RangeError("Capacity may not be less than 0");this._c=t,this._q=[]}return Object.defineProperty(r.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"full",{get:function(){return this._q.length>=this._c},enumerable:!1,configurable:!0}),r.prototype.add=function(t){if(this.full)throw new Error("Buffer full");this._q.push(t)},r.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},r})(),function(){function r(t){if(t<1)throw new RangeError("Capacity may not be less than 1");this._c=t,this._q=[]}return Object.defineProperty(r.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"full",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.add=function(t){for(;this._q.length>=this._c;)this._q.shift();this._q.push(t)},r.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},r}(),function(){function r(t){if(t<1)throw new RangeError("Capacity may not be less than 1");this._c=t,this._q=[]}return Object.defineProperty(r.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"full",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.add=function(t){this._q.length<this._c&&this._q.push(t)},r.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},r}();function W_(r){r!=null&&typeof r.then=="function"&&r.then(Vm,Vm)}var $_=0,WE=1,bh=2,zm=3,X_=4,Gm=1024,Vm=function(){};function Pd(r){var t=r.err,e=Promise.resolve(r.execution).then(function(n){if(t!=null)throw t;return n});return r.err=void 0,r.execution=e.then(function(){},function(){}),r.pending===void 0?e:r.pending.then(function(){return e})}function wh(r,t){var e=r.state>=zm;return Promise.resolve(t).then(function(n){return!e&&r.state>=X_?Pd(r).then(function(i){return{value:i,done:!0}}):{value:n,done:e}})}function Y_(r,t){var e,n;if(!(r.state>=bh))if(r.state=bh,r.onnext(),r.onstop(),r.err==null&&(r.err=t),r.pushes.length===0&&(typeof r.buffer>"u"||r.buffer.empty))Tp(r);else try{for(var i=Md(r.pushes),s=i.next();!s.done;s=i.next()){var a=s.value;a.resolve()}}catch(o){e={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}function Tp(r){var t,e;if(!(r.state>=zm)){r.state<bh&&Y_(r),r.state=zm,r.buffer=void 0;try{for(var n=Md(r.nexts),i=n.next();!i.done;i=n.next()){var s=i.value,a=r.pending===void 0?Pd(r):r.pending.then(function(){return Pd(r)});s.resolve(wh(r,a))}}catch(o){t={error:o}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}r.pushes=[],r.nexts=[]}}function $E(r){r.state>=X_||(r.state<zm&&Tp(r),r.state=X_)}function kk(r,t){if(W_(t),r.pushes.length>=Gm)throw new KE("No more than "+Gm+" pending calls to push are allowed on a single repeater.");if(r.state>=bh)return Promise.resolve(void 0);var e=r.pending===void 0?Promise.resolve(t):r.pending.then(function(){return t});e=e.catch(function(A){r.state<bh&&(r.err=A),$E(r)});var n;if(r.nexts.length){var i=r.nexts.shift();i.resolve(wh(r,e)),r.nexts.length?n=Promise.resolve(r.nexts[0].value):n=new Promise(function(A){return r.onnext=A})}else typeof r.buffer<"u"&&!r.buffer.full?(r.buffer.add(e),n=Promise.resolve(void 0)):n=new Promise(function(A){return r.pushes.push({resolve:A,value:e})});var s=!0,a={},o=n.catch(function(A){if(s)throw A});return a.then=function(A,f){return s=!1,Promise.prototype.then.call(n,A,f)},a.catch=function(A){return s=!1,Promise.prototype.catch.call(n,A)},a.finally=n.finally.bind(n),r.pending=e.then(function(){return o}).catch(function(A){r.err=A,$E(r)}),a}function Nk(r){var t=Y_.bind(null,r),e=new Promise(function(n){return r.onstop=n});return t.then=e.then.bind(e),t.catch=e.catch.bind(e),t.finally=e.finally.bind(e),t}function Qk(r){if(!(r.state>=WE)){r.state=WE;var t=kk.bind(null,r),e=Nk(r);r.execution=new Promise(function(n){return n(r.executor(t,e))}),r.execution.catch(function(){return Y_(r)})}}var jm=new WeakMap,Ip=function(){function r(t,e){jm.set(this,{executor:t,buffer:e,err:void 0,state:$_,pushes:[],nexts:[],pending:void 0,execution:void 0,onnext:Vm,onstop:Vm})}return r.prototype.next=function(t){W_(t);var e=jm.get(this);if(e===void 0)throw new Error("WeakMap error");if(e.nexts.length>=Gm)throw new KE("No more than "+Gm+" pending calls to next are allowed on a single repeater.");if(e.state<=$_&&Qk(e),e.onnext(t),typeof e.buffer<"u"&&!e.buffer.empty){var n=wh(e,e.buffer.remove());if(e.pushes.length){var i=e.pushes.shift();e.buffer.add(i.value),e.onnext=i.resolve}return n}else if(e.pushes.length){var s=e.pushes.shift();return e.onnext=s.resolve,wh(e,s.value)}else if(e.state>=bh)return Tp(e),wh(e,Pd(e));return new Promise(function(a){return e.nexts.push({resolve:a,value:t})})},r.prototype.return=function(t){W_(t);var e=jm.get(this);if(e===void 0)throw new Error("WeakMap error");return Tp(e),e.execution=Promise.resolve(e.execution).then(function(){return t}),wh(e,Pd(e))},r.prototype.throw=function(t){var e=jm.get(this);if(e===void 0)throw new Error("WeakMap error");return e.state<=$_||e.state>=bh||typeof e.buffer<"u"&&!e.buffer.empty?(Tp(e),e.err==null&&(e.err=t),wh(e,Pd(e))):this.next(Promise.reject(t))},r.prototype[Symbol.asyncIterator]=function(){return this},r.race=Hk,r.merge=zk,r.zip=Gk,r.latest=Vk,r}();function qm(r,t){var e,n,i=[],s=function(f){f!=null&&typeof f[Symbol.asyncIterator]=="function"?i.push(f[Symbol.asyncIterator]()):f!=null&&typeof f[Symbol.iterator]=="function"?i.push(f[Symbol.iterator]()):i.push(function(){return Dk(this,arguments,function(){return _A(this,function(x){switch(x.label){case 0:return t.yieldValues?[4,Sp(f)]:[3,3];case 1:return[4,x.sent()];case 2:x.sent(),x.label=3;case 3:return t.returnValues?[4,Sp(f)]:[3,5];case 4:return[2,x.sent()];case 5:return[2]}})})}())};try{for(var a=Md(r),o=a.next();!o.done;o=a.next()){var A=o.value;s(A)}}catch(f){e={error:f}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i}function Hk(r){var t=this,e=qm(r,{returnValues:!0});return new Ip(function(n,i){return Fd(t,void 0,void 0,function(){var s,a,o,A,f,m;return _A(this,function(b){switch(b.label){case 0:if(!e.length)return i(),[2];a=!1,i.then(function(){s(),a=!0}),b.label=1;case 1:b.trys.push([1,,5,7]),A=void 0,f=0,m=function(){var x,C,M,U,N,Q;return _A(this,function(q){switch(q.label){case 0:x=f;try{for(C=(N=void 0,Md(e)),M=C.next();!M.done;M=C.next())U=M.value,Promise.resolve(U.next()).then(function(Y){Y.done?(i(),o===void 0&&(o=Y)):f===x&&(f++,s(Y))},function(Y){return i(Y)})}catch(Y){N={error:Y}}finally{try{M&&!M.done&&(Q=C.return)&&Q.call(C)}finally{if(N)throw N.error}}return[4,new Promise(function(Y){return s=Y})];case 1:return A=q.sent(),A===void 0?[3,3]:[4,n(A.value)];case 2:q.sent(),q.label=3;case 3:return[2]}})},b.label=2;case 2:return a?[3,4]:[5,m()];case 3:return b.sent(),[3,2];case 4:return[2,o&&o.value];case 5:return i(),[4,Promise.race(e.map(function(x){return x.return&&x.return()}))];case 6:return b.sent(),[7];case 7:return[2]}})})})}function zk(r){var t=this,e=qm(r,{yieldValues:!0});return new Ip(function(n,i){return Fd(t,void 0,void 0,function(){var s,a,o,A=this;return _A(this,function(f){switch(f.label){case 0:if(!e.length)return i(),[2];s=[],a=!1,i.then(function(){var m,b;a=!0;try{for(var x=Md(s),C=x.next();!C.done;C=x.next()){var M=C.value;M()}}catch(U){m={error:U}}finally{try{C&&!C.done&&(b=x.return)&&b.call(x)}finally{if(m)throw m.error}}}),f.label=1;case 1:return f.trys.push([1,,3,4]),[4,Promise.all(e.map(function(m,b){return Fd(A,void 0,void 0,function(){var x,C;return _A(this,function(M){switch(M.label){case 0:M.trys.push([0,,6,9]),M.label=1;case 1:return a?[3,5]:(Promise.resolve(m.next()).then(function(U){return s[b](U)},function(U){return i(U)}),[4,new Promise(function(U){s[b]=U})]);case 2:return x=M.sent(),x===void 0?[3,4]:x.done?(o=x,[2]):[4,n(x.value)];case 3:M.sent(),M.label=4;case 4:return[3,1];case 5:return[3,9];case 6:return C=m.return,C?[4,m.return()]:[3,8];case 7:C=M.sent(),M.label=8;case 8:return[7];case 9:return[2]}})})}))];case 2:return f.sent(),[2,o&&o.value];case 3:return i(),[7];case 4:return[2]}})})})}function Gk(r){var t=this,e=qm(r,{returnValues:!0});return new Ip(function(n,i){return Fd(t,void 0,void 0,function(){var s,a,o,A;return _A(this,function(f){switch(f.label){case 0:if(!e.length)return i(),[2,[]];a=!1,i.then(function(){s(),a=!0}),f.label=1;case 1:f.trys.push([1,,6,8]),f.label=2;case 2:return a?[3,5]:(Promise.all(e.map(function(m){return m.next()})).then(function(m){return s(m)},function(m){return i(m)}),[4,new Promise(function(m){return s=m})]);case 3:return o=f.sent(),o===void 0?[2]:(A=o.map(function(m){return m.value}),o.some(function(m){return m.done})?[2,A]:[4,n(A)]);case 4:return f.sent(),[3,2];case 5:return[3,8];case 6:return i(),[4,Promise.all(e.map(function(m){return m.return&&m.return()}))];case 7:return f.sent(),[7];case 8:return[2]}})})})}function Vk(r){var t=this,e=qm(r,{yieldValues:!0,returnValues:!0});return new Ip(function(n,i){return Fd(t,void 0,void 0,function(){var s,a,o,A,f,m=this;return _A(this,function(b){switch(b.label){case 0:if(!e.length)return i(),[2,[]];a=[],o=!1,i.then(function(){var x,C;s();try{for(var M=Md(a),U=M.next();!U.done;U=M.next()){var N=U.value;N()}}catch(Q){x={error:Q}}finally{try{U&&!U.done&&(C=M.return)&&C.call(M)}finally{if(x)throw x.error}}o=!0}),b.label=1;case 1:return b.trys.push([1,,5,7]),Promise.all(e.map(function(x){return x.next()})).then(function(x){return s(x)},function(x){return i(x)}),[4,new Promise(function(x){return s=x})];case 2:return A=b.sent(),A===void 0?[2]:(f=A.map(function(x){return x.value}),A.every(function(x){return x.done})?[2,f]:[4,n(f.slice())]);case 3:return b.sent(),[4,Promise.all(e.map(function(x,C){return Fd(m,void 0,void 0,function(){var M;return _A(this,function(U){switch(U.label){case 0:if(A[C].done)return[2,A[C].value];U.label=1;case 1:return o?[3,4]:(Promise.resolve(x.next()).then(function(N){return a[C](N)},function(N){return i(N)}),[4,new Promise(function(N){return a[C]=N})]);case 2:return M=U.sent(),M===void 0?[2,A[C].value]:M.done?[2,M.value]:(f[C]=M.value,[4,n(f.slice())]);case 3:return U.sent(),[3,1];case 4:return[2]}})})}))];case 4:return[2,b.sent()];case 5:return i(),[4,Promise.all(e.map(function(x){return x.return&&x.return()}))];case 6:return b.sent(),[7];case 7:return[2]}})})})}class Km{constructor(){this._extraRequestThreshold=256*1024}extraRequestThreshold(){return this._extraRequestThreshold}setExtraRequestThreshold(t){if(t<0)throw new Error("extraRequestThreshold cannot be negative");this._extraRequestThreshold=t}}Km.global=new Km;var Rc;(function(r){r[r.Debug=0]="Debug",r[r.Info=1]="Info",r[r.Warn=2]="Warn",r[r.Error=3]="Error"})(Rc||(Rc={}));class Fs{static debug(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.log(Rc.Debug,...e)}static info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.log(Rc.Info,...e)}static warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.log(Rc.Warn,...e)}static error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.log(Rc.Error,...e)}static log(t){if(!(this.logLevel>t)){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];switch(t){case Rc.Debug:{console.debug(...n);break}case Rc.Info:{console.info(...n);break}case Rc.Warn:{console.warn(...n);break}case Rc.Error:{console.error(...n);break}}}}}Fs.logLevel=Rc.Warn;const xh=8*4+8,jk=16;function J_(r,t){t=Math.min(Math.max(+t,2),65535);let e=r,n=e;do e=Math.ceil(e/t),n+=e;while(e!==1);return n*xh}function qk(r,t){if(t<2)throw new Error("Node size must be at least 2");if(r===0)throw new Error("Number of items must be greater than 0");let e=r,n=e;const i=[e];do e=Math.ceil(e/t),n+=e,i.push(e);while(e!==1);const s=[];e=n;for(const o of i)s.push(e-o),e-=o;const a=[];for(let o=0;o<i.length;o++)a.push([s[o],s[o]+i[o]]);return a}async function*Kk(r,t,e,n){class i{constructor(M,U){this._level=U,this.nodes=M}level(){return this._level}startNodeIdx(){return this.nodes[0]}endNodeIdx(){return this.nodes[1]}extendEndNodeIdx(M){console.assert(M>this.nodes[1]),this.nodes[1]=M}toString(){return`[NodeRange level: ${this._level}, nodes: ${this.nodes[0]}-${this.nodes[1]}]`}}const{minX:s,minY:a,maxX:o,maxY:A}=e;Fs.info(`tree items: ${r}, nodeSize: ${t}`);const f=qk(r,t),m=f[0][0],x=[(()=>{const C=[0,1],M=f.length-1;return new i(C,M)})()];for(Fs.debug(`starting stream search with queue: ${x}, numItems: ${r}, nodeSize: ${t}, levelBounds: ${f}`);x.length!=0;){const C=x.shift();Fs.debug(`popped node: ${C}, queueLength: ${x.length}`);const M=C.startNodeIdx(),U=M>=m,N=(()=>{const[,tt]=f[C.level()],ft=Math.min(C.endNodeIdx()+t,tt);return U&&ft<tt?ft+1:ft})(),Q=N-M,q=await n(M*xh,Q*xh),Y=new DataView(q);for(let tt=M;tt<N;tt++){const ft=tt-M,pt=ft*xh;if(o<Y.getFloat64(pt+0,!0)||A<Y.getFloat64(pt+8,!0)||s>Y.getFloat64(pt+16,!0)||a>Y.getFloat64(pt+24,!0))continue;const mt=Y.getBigUint64(pt+32,!0);if(U){const ct=mt,wt=(()=>{if(tt<r-1){const te=(ft+1)*xh;return Y.getBigUint64(te+32,!0)-ct}else return null})(),yt=tt-m;yield[Number(ct),yt,Number(wt)];continue}const dt=mt,Rt=Km.global.extraRequestThreshold()/xh,Lt=x[x.length-1];if(Lt!==void 0&&Lt.level()==C.level()-1&&dt<Lt.endNodeIdx()+Rt){Fs.debug(`Merging "nodeRange" request into existing range: ${Lt}, newEndNodeIdx: ${Lt.endNodeIdx()} -> ${dt}`),Lt.extendEndNodeIdx(Number(dt));continue}const st=(()=>{const ct=C.level()-1,wt=[Number(dt),Number(dt)+1];return new i(wt,ct)})();Lt!==void 0&&Lt.level()==st.level()?Fs.info(`Same level, but too far away. Pushing new request for nodeIdx: ${dt} rather than merging with distant ${Lt}`):Fs.info(`Pushing new level for ${st} onto queue with nearestNodeRange: ${Lt} since there's not already a range for this level.`),x.push(st)}}}const vA=new Uint8Array([102,103,98,3,102,103,98,0]),vu=4;class Z_{constructor(t,e,n,i){this.headerClient=t,this.header=e,this.headerLength=n,this.indexLength=i}static async open(t){const n=new XE(t),i=(()=>{const b=jk,x=3;let C=0,M;for(M=0;M<x;M++){const U=b**M*xh;C+=U}return C})(),s=2024+i;Fs.debug(`fetching header. minReqLength: ${s} (assumedHeaderLength: 2024, assumedIndexLength: ${i})`);{const b=new Uint8Array(await n.getRange(0,8,s,"header"));if(!b.subarray(0,3).every((x,C)=>vA[C]===x))throw Fs.error(`bytes: ${b} != ${vA}`),new Error("Not a FlatGeobuf file");Fs.debug("magic bytes look good")}let a;{const b=await n.getRange(8,4,s,"header");a=new DataView(b).getUint32(0,!0);const x=1048576*10;if(a>x||a<8)throw new Error("Invalid header size");Fs.debug(`headerLength: ${a}`)}const o=await n.getRange(12,a,s,"header"),A=new _u(new Uint8Array(o)),f=q_(A),m=J_(f.featuresCount,f.indexNodeSize);return Fs.debug("completed: opening http reader"),new Z_(n,f,a,m)}async*selectBbox(t){const e=this.lengthBeforeTree(),n=this.headerClient,i=async function(A,f){return n.getRange(e+A,f,0,"index")},s=[];let a=[];for await(const A of Kk(this.header.featuresCount,this.header.indexNodeSize,t,i)){const[f,,]=A;let[,,m]=A;if(m||(Fs.info("final feature"),m=4),a.length==0){a.push([f,m]);continue}const b=a[a.length-1],x=f-(b[0]+b[1]);x>Km.global.extraRequestThreshold()&&(Fs.info(`Pushing new feature batch, since gap ${x} was too large`),s.push(a),a=[]),a.push([f,m])}this.headerClient.logUsage("header+index"),a.length>0&&s.push(a);const o=s.flatMap(A=>this.readFeatureBatch(A));yield*Ip.merge(o)}lengthBeforeTree(){return vA.length+vu+this.headerLength}lengthBeforeFeatures(){return this.lengthBeforeTree()+this.indexLength}buildFeatureClient(){return new XE(this.headerClient.httpClient)}async*readFeatureBatch(t){const[e]=t[0],[n,i]=t[t.length-1],s=e,o=n+i-s,A=this.buildFeatureClient();let f=o;for(const[m]of t)yield await this.readFeature(A,m,f),f=0;A.logUsage("feature")}async readFeature(t,e,n){const i=e+this.lengthBeforeFeatures();let s;{const m=await t.getRange(i,4,n,"feature length");s=new DataView(m).getUint32(0,!0)}const a=await t.getRange(i+4,s,n,"feature data"),o=new Uint8Array(a),A=new Uint8Array(s+vu);A.set(o,vu);const f=new _u(A);return f.setPosition(vu),Uc.getRootAsFeature(f)}}class XE{constructor(t){if(this.bytesEverUsed=0,this.bytesEverFetched=0,this.buffer=new ArrayBuffer(0),this.head=0,typeof t=="string")this.httpClient=new YE(t);else if(t instanceof YE)this.httpClient=t;else throw new Error("Unknown source ")}async getRange(t,e,n,i){this.bytesEverUsed+=e;const s=t-this.head,a=s+e;if(s>=0&&a<=this.buffer.byteLength)return this.buffer.slice(s,a);const o=Math.max(e,n);return this.bytesEverFetched+=o,Fs.debug(`requesting for new Range: ${t}-${t+o-1}`),this.buffer=await this.httpClient.getRange(t,o,i),this.head=t,this.buffer.slice(0,e)}logUsage(t){const e=t.split(" ")[0],n=this.bytesEverUsed,i=this.bytesEverFetched,s=(100*n/i).toFixed(2);Fs.info(`${e} bytes used/requested: ${n} / ${i} = ${s}%`)}}class YE{constructor(t){this.requestsEverMade=0,this.bytesEverRequested=0,this.url=t}async getRange(t,e,n){this.requestsEverMade+=1,this.bytesEverRequested+=e;const i=`bytes=${t}-${t+e-1}`;return Fs.info(`request: #${this.requestsEverMade}, purpose: ${n}), bytes: (this_request: ${e}, ever: ${this.bytesEverRequested}), Range: ${i}`),(await fetch(this.url,{headers:{Range:i}})).arrayBuffer()}}function Wk(r,t,e){if(!r.subarray(0,3).every((m,b)=>vA[b]===m))throw new Error("Not a FlatGeobuf file");const n=new _u(r),i=n.readUint32(vA.length);n.setPosition(vA.length+vu);const s=q_(n);e&&e(s);let a=vA.length+vu+i;const{indexNodeSize:o,featuresCount:A}=s;o>0&&(a+=J_(A,o));const f=[];for(;a<n.capacity();){const m=n.readUint32(a);n.setPosition(a+vu);const b=Uc.getRootAsFeature(n);f.push(t(b,s)),a+=vu+m}return f}async function*$k(r,t,e){const n=Rk(r),i=async x=>await n.slice(x);let s=new Uint8Array(await i(8));if(!s.subarray(0,3).every((x,C)=>vA[C]===x))throw new Error("Not a FlatGeobuf file");s=new Uint8Array(await i(4));let a=new _u(s);const o=a.readUint32(0);s=new Uint8Array(await i(o)),a=new _u(s);const A=q_(a);e&&e(A);const{indexNodeSize:f,featuresCount:m}=A;if(f>0){const x=J_(m,f);await i(x)}let b;for(;b=await Yk(i,A,t);)yield b}async function*Xk(r,t,e,n){const i=await Z_.open(r);Fs.debug("opened reader"),n&&n(i.header);for await(const s of i.selectBbox(t))yield e(s,i.header)}async function Yk(r,t,e){let n=new Uint8Array(await r(4,"feature length"));if(n.byteLength===0)return;let i=new _u(n);const s=i.readUint32(0);n=new Uint8Array(await r(s,"feature data"));const a=new Uint8Array(s+4);a.set(n,4),i=new _u(a),i.setPosition(vu);const o=Uc.getRootAsFeature(i);return e(o,t)}function Jk(r,t){return{type:"FeatureCollection",features:Wk(r,V_,t)}}function Zk(r,t){return $k(r,V_,t)}function tN(r,t,e){return Xk(r,t,V_,e)}function JE(r,t,e){return r instanceof Uint8Array?Jk(r,e):r instanceof ReadableStream?Zk(r,e):tN(r,t,e)}class eN{constructor(){this._bearing=0,this._pitch=60,this._minpitchzoom=null}onAdd(t){this._map=t;let e=this;return this._btn=document.createElement("button"),this._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-3d",this._btn.id="bt3D",this._btn.type="button",this._btn["aria-label"]="Vista 3D",this._btn.onclick=function(){if(e._btn.className.indexOf("3d")!=-1){let f={pitch:e._pitch,bearing:e._bearing};e._minpitchzoom&&t.getZoom()>e._minpitchzoom&&(f.zoom=e._minpitchzoom);var n=0,i=38.5,s=6,a=62.33,{longitude:o,latitude:A}=t.getCenter();t.getZoom()<10?t.setTerrain({source:"terrainMapZen",exaggeration:1.5}):o>=n&&o<=s&&A>=i&&A<=a?t.setTerrain({source:"terrainICGC",exaggeration:1.2}):t.setTerrain({source:"terrainMapZen",exaggeration:1.5}),t.easeTo(f),e._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-2d"}else t.setTerrain(null),t.easeTo({pitch:0,bearing:0}),e._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-3d"},this._container=document.createElement("div"),this._container.className="maplibregl-ctrl maplibregl-ctrl-group",this._container.title="Vista 3D",this._container.appendChild(this._btn),this._container}onRemove(){this._container.parentNode.removeChild(this._container),this._map=void 0}}function Lp(r){"@babel/helpers - typeof";return Lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lp(r)}function rN(r,t){if(Lp(r)!="object"||!r)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var n=e.call(r,t||"default");if(Lp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function nN(r){var t=rN(r,"string");return Lp(t)=="symbol"?t:String(t)}function W(r,t,e){return t=nN(t),t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function ai(r,t){if(!r)throw new Error(t||"loader assertion failed.")}const Wm=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),ZE=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);ZE&&parseFloat(ZE[1]);const iN="3.4.14";function Rl(r,t){if(!r)throw new Error(t||"loaders.gl assertion failed.")}const tv={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},sN=tv.global||tv.self||tv.window||{},bu=typeof process!="object"||String(process)!=="[object process]"||process.browser,ev=typeof importScripts=="function",oN=typeof window<"u"&&typeof window.orientation<"u",tS=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);tS&&parseFloat(tS[1]);class aN{constructor(t,e){W(this,"name",void 0),W(this,"workerThread",void 0),W(this,"isRunning",!0),W(this,"result",void 0),W(this,"_resolve",()=>{}),W(this,"_reject",()=>{}),this.name=t,this.workerThread=e,this.result=new Promise((n,i)=>{this._resolve=n,this._reject=i})}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){Rl(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){Rl(this.isRunning),this.isRunning=!1,this._reject(t)}}let rv=class{terminate(){}};const nv=new Map;function cN(r){Rl(r.source&&!r.url||!r.source&&r.url);let t=nv.get(r.source||r.url);return t||(r.url&&(t=lN(r.url),nv.set(r.url,t)),r.source&&(t=eS(r.source),nv.set(r.source,t))),Rl(t),t}function lN(r){if(!r.startsWith("http"))return r;const t=uN(r);return eS(t)}function eS(r){const t=new Blob([r],{type:"application/javascript"});return URL.createObjectURL(t)}function uN(r){return`try {
  importScripts('`.concat(r,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function rS(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,e=arguments.length>2?arguments[2]:void 0;const n=e||new Set;if(r){if(nS(r))n.add(r);else if(nS(r.buffer))n.add(r.buffer);else if(!ArrayBuffer.isView(r)){if(t&&typeof r=="object")for(const i in r)rS(r[i],t,n)}}return e===void 0?Array.from(n):[]}function nS(r){return r?r instanceof ArrayBuffer||typeof MessagePort<"u"&&r instanceof MessagePort||typeof ImageBitmap<"u"&&r instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas:!1}const iv=()=>{};class sv{static isSupported(){return typeof Worker<"u"&&bu||typeof rv<"u"&&!bu}constructor(t){W(this,"name",void 0),W(this,"source",void 0),W(this,"url",void 0),W(this,"terminated",!1),W(this,"worker",void 0),W(this,"onMessage",void 0),W(this,"onError",void 0),W(this,"_loadableURL","");const{name:e,source:n,url:i}=t;Rl(n||i),this.name=e,this.source=n,this.url=i,this.onMessage=iv,this.onError=s=>console.log(s),this.worker=bu?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=iv,this.onError=iv,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(t,e){e=e||rS(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+="worker ".concat(this.name," from ").concat(this.url,". "),t.message&&(e+="".concat(t.message," in ")),t.lineno&&(e+=":".concat(t.lineno,":").concat(t.colno)),new Error(e)}_createBrowserWorker(){this._loadableURL=cN({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},t.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},t.onmessageerror=e=>console.error(e),t}_createNodeWorker(){let t;if(this.url){const n=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);t=new rv(n,{eval:!1})}else if(this.source)t=new rv(this.source,{eval:!0});else throw new Error("no worker");return t.on("message",e=>{this.onMessage(e)}),t.on("error",e=>{this.onError(e)}),t.on("exit",e=>{}),t}}class AN{static isSupported(){return sv.isSupported()}constructor(t){W(this,"name","unnamed"),W(this,"source",void 0),W(this,"url",void 0),W(this,"maxConcurrency",1),W(this,"maxMobileConcurrency",1),W(this,"onDebug",()=>{}),W(this,"reuseWorkers",!0),W(this,"props",{}),W(this,"jobQueue",[]),W(this,"idleQueue",[]),W(this,"count",0),W(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach(t=>t.destroy()),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},t.name!==void 0&&(this.name=t.name),t.maxConcurrency!==void 0&&(this.maxConcurrency=t.maxConcurrency),t.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=t.maxMobileConcurrency),t.reuseWorkers!==void 0&&(this.reuseWorkers=t.reuseWorkers),t.onDebug!==void 0&&(this.onDebug=t.onDebug)}async startJob(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,a,o)=>s.done(o),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,a)=>s.error(a);const i=new Promise(s=>(this.jobQueue.push({name:t,onMessage:e,onError:n,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const n=new aN(e.name,t);t.onMessage=i=>e.onMessage(n,i.type,i.payload),t.onError=i=>e.onError(n,i),e.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new sv({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return oN?this.maxMobileConcurrency:this.maxConcurrency}}const hN={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class wu{static isSupported(){return sv.isSupported()}static getWorkerFarm(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return wu._workerFarm=wu._workerFarm||new wu({}),wu._workerFarm.setProps(t),wu._workerFarm}constructor(t){W(this,"props",void 0),W(this,"workerPools",new Map),this.props={...hN},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:i}=t;let s=this.workerPools.get(e);return s||(s=new AN({name:e,source:n,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}W(wu,"_workerFarm",void 0);const dN="latest";function fN(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e=t[r.id]||{},n="".concat(r.id,"-worker.js");let i=e.workerUrl;if(!i&&r.id==="compression"&&(i=t.workerUrl),t._workerType==="test"&&(i="modules/".concat(r.module,"/dist/").concat(n)),!i){let s=r.version;s==="latest"&&(s=dN);const a=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(r.module).concat(a,"/dist/").concat(n)}return Rl(i),i}function pN(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:iN;Rl(r,"no worker provided");const e=r.version;return!(!t||!e)}const gN=null,mN=null,ov=null,iS=null,yN=Object.freeze(Object.defineProperty({__proto__:null,readFileAsArrayBuffer:gN,readFileAsText:mN,requireFromFile:ov,requireFromString:iS},Symbol.toStringTag,{value:"Module"})),_N="3.4.14",av={};async function Bh(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t&&(r=vN(r,t,e)),av[r]=av[r]||bN(r),await av[r]}function vN(r,t,e){if(r.startsWith("http"))return r;const n=e.modules||{};return n[r]?n[r]:bu?e.CDN?(Rl(e.CDN.startsWith("http")),"".concat(e.CDN,"/").concat(t,"@").concat(_N,"/dist/libs/").concat(r)):ev?"../src/libs/".concat(r):"modules/".concat(t,"/src/libs/").concat(r):"modules/".concat(t,"/dist/libs/").concat(r)}async function bN(r){if(r.endsWith("wasm"))return await(await fetch(r)).arrayBuffer();if(!bu)try{return yN&&ov&&await ov(r)}catch{return null}if(ev)return importScripts(r);const e=await(await fetch(r)).text();return wN(e,r)}function wN(r,t){if(!bu)return iS;if(ev)return eval.call(sN,r),null;const e=document.createElement("script");e.id=t;try{e.appendChild(document.createTextNode(r))}catch{e.text=r}return document.body.appendChild(e),null}function xN(r,t){return!wu.isSupported()||!bu&&!(t!=null&&t._nodeWorkers)?!1:r.worker&&(t==null?void 0:t.worker)}async function BN(r,t,e,n,i){const s=r.id,a=fN(r,e),A=wu.getWorkerFarm(e).getWorkerPool({name:s,url:a});e=JSON.parse(JSON.stringify(e)),n=JSON.parse(JSON.stringify(n||{}));const f=await A.startJob("process-on-worker",CN.bind(null,i));return f.postMessage("process",{input:t,options:e,context:n}),await(await f.result).result}async function CN(r,t,e,n){switch(e){case"done":t.done(n);break;case"error":t.error(new Error(n.error));break;case"process":const{id:i,input:s,options:a}=n;try{const o=await r(s,a);t.postMessage("done",{id:i,result:o})}catch(o){const A=o instanceof Error?o.message:"unknown error";t.postMessage("error",{id:i,error:A})}break;default:console.warn("parse-with-worker unknown message ".concat(e))}}function EN(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof r=="string"?r.slice(0,t):ArrayBuffer.isView(r)?sS(r.buffer,r.byteOffset,t):r instanceof ArrayBuffer?sS(r,0,t):""}function sS(r,t,e){if(r.byteLength<=t+e)return"";const n=new DataView(r);let i="";for(let s=0;s<e;s++)i+=String.fromCharCode(n.getUint8(t+s));return i}function SN(r){try{return JSON.parse(r)}catch{throw new Error('Failed to parse JSON from data starting with "'.concat(EN(r),'"'))}}function TN(r,t,e){if(e=e||r.byteLength,r.byteLength<e||t.byteLength<e)return!1;const n=new Uint8Array(r),i=new Uint8Array(t);for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}function IN(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];const n=t.map(o=>o instanceof ArrayBuffer?new Uint8Array(o):o),i=n.reduce((o,A)=>o+A.byteLength,0),s=new Uint8Array(i);let a=0;for(const o of n)s.set(o,a),a+=o.byteLength;return s.buffer}function cv(r,t,e){const n=e!==void 0?new Uint8Array(r).subarray(t,t+e):new Uint8Array(r).subarray(t);return new Uint8Array(n).buffer}function Fp(r,t){return ai(r>=0),ai(t>0),r+(t-1)&~(t-1)}function LN(r,t,e){let n;if(r instanceof ArrayBuffer)n=new Uint8Array(r);else{const i=r.byteOffset,s=r.byteLength;n=new Uint8Array(r.buffer||r.arrayBuffer,i,s)}return t.set(n,e),e+Fp(n.byteLength,4)}async function FN(r){const t=[];for await(const e of r)t.push(e);return IN(...t)}function oS(){let r;if(typeof window<"u"&&window.performance)r=window.performance.now();else if(typeof process<"u"&&process.hrtime){const t=process.hrtime();r=t[0]*1e3+t[1]/1e6}else r=Date.now();return r}let aS=class{constructor(t,e){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=t,this.type=e,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=oS(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(oS()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},MN=class{constructor(t){this.id=void 0,this.stats={},this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t of Object.values(this.stats))t.reset();return this}forEach(t){for(const e of Object.values(this.stats))t(e)}getTable(){const t={};return this.forEach(e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}}),t}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(e=>this._getOrCreate(e))}_getOrCreate(t){const{name:e,type:n}=t;let i=this.stats[e];return i||(t instanceof aS?i=t:i=new aS(e,n),this.stats[e]=i),i}};const PN="Queued Requests",UN="Active Requests",RN="Cancelled Requests",ON="Queued Requests Ever",DN="Active Requests Ever",kN={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class NN{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W(this,"props",void 0),W(this,"stats",void 0),W(this,"activeRequestCount",0),W(this,"requestQueue",[]),W(this,"requestMap",new Map),W(this,"deferredUpdate",null),this.props={...kN,...t},this.stats=new MN({id:this.props.id}),this.stats.get(PN),this.stats.get(UN),this.stats.get(RN),this.stats.get(ON),this.stats.get(DN)}scheduleRequest(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(t))return this.requestMap.get(t);const n={handle:t,priority:0,getPriority:e},i=new Promise(s=>(n.resolve=s,n));return this.requestQueue.push(n),this.requestMap.set(t,i),this._issueNewRequests(),i}_issueRequest(t){const{handle:e,resolve:n}=t;let i=!1;const s=()=>{i||(i=!0,this.requestMap.delete(e),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(t!==0){this._updateAllRequests();for(let e=0;e<t;++e){const n=this.requestQueue.shift();n&&this._issueRequest(n)}}}_updateAllRequests(){const t=this.requestQueue;for(let e=0;e<t.length;++e){const n=t[e];this._updateRequest(n)||(t.splice(e,1),this.requestMap.delete(n.handle),e--)}t.sort((e,n)=>e.priority-n.priority)}_updateRequest(t){return t.priority=t.getPriority(t.handle),t.priority<0?(t.resolve(null),!1):!0}}let QN="";const cS={};function HN(r){for(const t in cS)if(r.startsWith(t)){const e=cS[t];r=r.replace(t,e)}return!r.startsWith("http://")&&!r.startsWith("https://")&&(r="".concat(QN).concat(r)),r}function Evt(r){return r}function zN(r){return r&&typeof r=="object"&&r.isBuffer}function lS(r){if(zN(r))return r;if(r instanceof ArrayBuffer)return r;if(ArrayBuffer.isView(r))return r.byteOffset===0&&r.byteLength===r.buffer.byteLength?r.buffer:r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength);if(typeof r=="string"){const t=r;return new TextEncoder().encode(t).buffer}if(r&&typeof r=="object"&&r._toArrayBuffer)return r._toArrayBuffer();throw new Error("toArrayBuffer")}function uS(r){const t=r?r.lastIndexOf("/"):-1;return t>=0?r.substr(t+1):""}function lv(r){const t=r?r.lastIndexOf("/"):-1;return t>=0?r.substr(0,t):""}const GN=r=>typeof r=="boolean",Mp=r=>typeof r=="function",Pp=r=>r!==null&&typeof r=="object",AS=r=>Pp(r)&&r.constructor==={}.constructor,VN=r=>r&&typeof r[Symbol.iterator]=="function",jN=r=>r&&typeof r[Symbol.asyncIterator]=="function",Ch=r=>typeof Response<"u"&&r instanceof Response||r&&r.arrayBuffer&&r.text&&r.json,Eh=r=>typeof Blob<"u"&&r instanceof Blob,qN=r=>r&&typeof r=="object"&&r.isBuffer,KN=r=>typeof ReadableStream<"u"&&r instanceof ReadableStream||Pp(r)&&Mp(r.tee)&&Mp(r.cancel)&&Mp(r.getReader),WN=r=>Pp(r)&&Mp(r.read)&&Mp(r.pipe)&&GN(r.readable),hS=r=>KN(r)||WN(r),$N=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,XN=/^([-\w.]+\/[-\w.+]+)/;function YN(r){const t=XN.exec(r);return t?t[1]:r}function dS(r){const t=$N.exec(r);return t?t[1]:""}const fS=/\?.*/;function JN(r){const t=r.match(fS);return t&&t[0]}function uv(r){return r.replace(fS,"")}function $m(r){return Ch(r)?r.url:Eh(r)?r.name||"":typeof r=="string"?r:""}function Av(r){if(Ch(r)){const t=r,e=t.headers.get("content-type")||"",n=uv(t.url);return YN(e)||dS(n)}return Eh(r)?r.type||"":typeof r=="string"?dS(r):""}function ZN(r){return Ch(r)?r.headers["content-length"]||-1:Eh(r)?r.size:typeof r=="string"?r.length:r instanceof ArrayBuffer||ArrayBuffer.isView(r)?r.byteLength:-1}async function pS(r){if(Ch(r))return r;const t={},e=ZN(r);e>=0&&(t["content-length"]=String(e));const n=$m(r),i=Av(r);i&&(t["content-type"]=i);const s=await r8(r);s&&(t["x-first-bytes"]=s),typeof r=="string"&&(r=new TextEncoder().encode(r));const a=new Response(r,{headers:t});return Object.defineProperty(a,"url",{value:n}),a}async function t8(r){if(!r.ok){const t=await e8(r);throw new Error(t)}}async function e8(r){let t="Failed to fetch resource ".concat(r.url," (").concat(r.status,"): ");try{const e=r.headers.get("Content-Type");let n=r.statusText;e.includes("application/json")&&(n+=" ".concat(await r.text())),t+=n,t=t.length>60?"".concat(t.slice(0,60),"..."):t}catch{}return t}async function r8(r){if(typeof r=="string")return"data:,".concat(r.slice(0,5));if(r instanceof Blob){const e=r.slice(0,5);return await new Promise(n=>{const i=new FileReader;i.onload=s=>{var a;return n(s==null||(a=s.target)===null||a===void 0?void 0:a.result)},i.readAsDataURL(e)})}if(r instanceof ArrayBuffer){const e=r.slice(0,5),n=n8(e);return"data:base64,".concat(n)}return null}function n8(r){let t="";const e=new Uint8Array(r);for(let n=0;n<e.byteLength;n++)t+=String.fromCharCode(e[n]);return btoa(t)}async function gS(r,t){if(typeof r=="string"){r=HN(r);let e=t;return t!=null&&t.fetch&&typeof(t==null?void 0:t.fetch)!="function"&&(e=t.fetch),await fetch(r,e)}return await pS(r)}function i8(r){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const t=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,e=r||t;return!!(e&&e.indexOf("Electron")>=0)}function Up(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||i8()}const Xm=globalThis.window||globalThis.self||globalThis.global,Rp=globalThis.process||{},mS=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Up();function s8(r){try{const t=window[r],e="__storage_test__";return t.setItem(e,e),t.removeItem(e),t}catch{return null}}let o8=class{constructor(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=s8(n),this.id=t,this.config=e,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}};function a8(r){let t;return r<10?t=`${r.toFixed(2)}ms`:r<100?t=`${r.toFixed(1)}ms`:r<1e3?t=`${r.toFixed(0)}ms`:t=`${(r/1e3).toFixed(2)}s`,t}function c8(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const e=Math.max(t-r.length,0);return`${" ".repeat(e)}${r}`}function hv(r,t,e){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=r.src.replace(/\(/g,"%28").replace(/\)/g,"%29");r.width>n&&(e=Math.min(e,n/r.width));const s=r.width*e,a=r.height*e,o=["font-size:1px;",`padding:${Math.floor(a/2)}px ${Math.floor(s/2)}px;`,`line-height:${a}px;`,`background:url(${i});`,`background-size:${s}px ${a}px;`,"color:transparent;"].join("");return[`${t} %c+`,o]}let Ym;(function(r){r[r.BLACK=30]="BLACK",r[r.RED=31]="RED",r[r.GREEN=32]="GREEN",r[r.YELLOW=33]="YELLOW",r[r.BLUE=34]="BLUE",r[r.MAGENTA=35]="MAGENTA",r[r.CYAN=36]="CYAN",r[r.WHITE=37]="WHITE",r[r.BRIGHT_BLACK=90]="BRIGHT_BLACK",r[r.BRIGHT_RED=91]="BRIGHT_RED",r[r.BRIGHT_GREEN=92]="BRIGHT_GREEN",r[r.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",r[r.BRIGHT_BLUE=94]="BRIGHT_BLUE",r[r.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",r[r.BRIGHT_CYAN=96]="BRIGHT_CYAN",r[r.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Ym||(Ym={}));const l8=10;function yS(r){return typeof r!="string"?r:(r=r.toUpperCase(),Ym[r]||Ym.WHITE)}function u8(r,t,e){return!Up&&typeof r=="string"&&(t&&(r=`\x1B[${yS(t)}m${r}\x1B[39m`),e&&(r=`\x1B[${yS(e)+l8}m${r}\x1B[49m`)),r}function A8(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const e=Object.getPrototypeOf(r),n=Object.getOwnPropertyNames(e),i=r;for(const s of n){const a=i[s];typeof a=="function"&&(t.find(o=>s===o)||(i[s]=a.bind(r)))}}function Jm(r,t){if(!r)throw new Error(t||"Assertion failed")}function Ud(){let r;if(Up()&&Xm.performance){var t,e;r=Xm==null||(t=Xm.performance)===null||t===void 0||(e=t.now)===null||e===void 0?void 0:e.call(t)}else if("hrtime"in Rp){var n;const i=Rp==null||(n=Rp.hrtime)===null||n===void 0?void 0:n.call(Rp);r=i[0]*1e3+i[1]/1e6}else r=Date.now();return r}const Rd={debug:Up()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},h8={enabled:!0,level:0};function Za(){}const _S={},vS={once:!0};let dv=class{constructor(){let{id:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=mS,this._startTs=Ud(),this._deltaTs=Ud(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=t,this.userData={},this._storage=new o8(`__probe-${this.id}__`,h8),this.timeStamp(`${this.id} started`),A8(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Ud()-this._startTs).toPrecision(10))}getDelta(){return Number((Ud()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:t}),this}setLevel(t){return this._storage.setConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,e){this._storage.setConfiguration({[t]:e})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,e){Jm(t,e)}warn(t){return this._getLogFunction(0,t,Rd.warn,arguments,vS)}error(t){return this._getLogFunction(0,t,Rd.error,arguments)}deprecated(t,e){return this.warn(`\`${t}\` is deprecated and will be removed in a later version. Use \`${e}\` instead`)}removed(t,e){return this.error(`\`${t}\` has been removed. Use \`${e}\` instead`)}probe(t,e){return this._getLogFunction(t,e,Rd.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,Rd.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){return this._getLogFunction(t,e,Rd.debug||Rd.info,arguments,vS)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||Za,n&&[n],{tag:g8(e)}):Za}image(t){let{logLevel:e,priority:n,image:i,message:s="",scale:a=1}=t;return this._shouldLog(e||n)?Up()?p8({image:i,message:s,scale:a}):f8():Za}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||Za)}group(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=wS({logLevel:t,message:e,opts:n}),{collapsed:s}=n;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||Za)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=bS(t)}_getLogFunction(t,e,n,i,s){if(this._shouldLog(t)){s=wS({logLevel:t,message:e,args:i,opts:s}),n=n||s.method,Jm(n),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Ud();const a=s.tag||s.message;if(s.once&&a)if(!_S[a])_S[a]=Ud();else return Za;return e=d8(this.id,s.message,s),n.bind(console,e,...s.args)}return Za}};dv.VERSION=mS;function bS(r){if(!r)return 0;let t;switch(typeof r){case"number":t=r;break;case"object":t=r.logLevel||r.priority||0;break;default:return 0}return Jm(Number.isFinite(t)&&t>=0),t}function wS(r){const{logLevel:t,message:e}=r;r.logLevel=bS(t);const n=r.args?Array.from(r.args):[];for(;n.length&&n.shift()!==e;);switch(typeof t){case"string":case"function":e!==void 0&&n.unshift(e),r.message=t;break;case"object":Object.assign(r,t);break}typeof r.message=="function"&&(r.message=r.message());const i=typeof r.message;return Jm(i==="string"||i==="object"),Object.assign(r,{args:n},r.opts)}function d8(r,t,e){if(typeof t=="string"){const n=e.time?c8(a8(e.total)):"";t=e.time?`${r}: ${n}  ${t}`:`${r}: ${t}`,t=u8(t,e.color,e.background)}return t}function f8(r){return console.warn("removed"),Za}function p8(r){let{image:t,message:e="",scale:n=1}=r;if(typeof t=="string"){const s=new Image;return s.onload=()=>{const a=hv(s,e,n);console.log(...a)},s.src=t,Za}const i=t.nodeName||"";if(i.toLowerCase()==="img")return console.log(...hv(t,e,n)),Za;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...hv(s,e,n)),s.src=t.toDataURL(),Za}return Za}function g8(r){for(const t in r)for(const e in r[t])return e||"untitled";return"empty"}const xS=new dv({id:"loaders.gl"});class m8{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class y8{constructor(){W(this,"console",void 0),this.console=console}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.log.bind(this.console,...e)}info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.info.bind(this.console,...e)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.warn.bind(this.console,...e)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.error.bind(this.console,...e)}}const BS={fetch:null,mimeType:void 0,nothrow:!1,log:new y8,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Wm,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},_8={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function CS(){globalThis.loaders=globalThis.loaders||{};const{loaders:r}=globalThis;return r._state=r._state||{},r._state}const ES=()=>{const r=CS();return r.globalOptions=r.globalOptions||{...BS},r.globalOptions};function v8(r,t,e,n){return e=e||[],e=Array.isArray(e)?e:[e],b8(r,e),x8(t,r,n)}function b8(r,t){SS(r,null,BS,_8,t);for(const e of t){const n=r&&r[e.id]||{},i=e.options&&e.options[e.id]||{},s=e.deprecatedOptions&&e.deprecatedOptions[e.id]||{};SS(n,e.id,i,s,t)}}function SS(r,t,e,n,i){const s=t||"Top level",a=t?"".concat(t,"."):"";for(const o in r){const A=!t&&Pp(r[o]),f=o==="baseUri"&&!t,m=o==="workerUrl"&&t;if(!(o in e)&&!f&&!m){if(o in n)xS.warn("".concat(s," loader option '").concat(a).concat(o,"' no longer supported, use '").concat(n[o],"'"))();else if(!A){const b=w8(o,i);xS.warn("".concat(s," loader option '").concat(a).concat(o,"' not recognized. ").concat(b))()}}}}function w8(r,t){const e=r.toLowerCase();let n="";for(const i of t)for(const s in i.options){if(r===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const a=s.toLowerCase();(e.startsWith(a)||a.startsWith(e))&&(n=n||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return n}function x8(r,t,e){const i={...r.options||{}};return B8(i,e),i.log===null&&(i.log=new m8),TS(i,ES()),TS(i,t),i}function TS(r,t){for(const e in t)if(e in t){const n=t[e];AS(n)&&AS(r[e])?r[e]={...r[e],...t[e]}:r[e]=t[e]}}function B8(r,t){t&&!("baseUri"in r)&&(r.baseUri=t)}function fv(r){var t;return r?(Array.isArray(r)&&(r=r[0]),Array.isArray((t=r)===null||t===void 0?void 0:t.extensions)):!1}function pv(r){var t,e;ai(r,"null loader"),ai(fv(r),"invalid loader");let n;return Array.isArray(r)&&(n=r[1],r=r[0],r={...r,options:{...r.options,...n}}),((t=r)!==null&&t!==void 0&&t.parseTextSync||(e=r)!==null&&e!==void 0&&e.parseText)&&(r.text=!0),r.text||(r.binary=!0),r}const IS=()=>{const r=CS();return r.loaderRegistry=r.loaderRegistry||[],r.loaderRegistry};function C8(r){const t=IS();r=Array.isArray(r)?r:[r];for(const e of r){const n=pv(e);t.find(i=>n===i)||t.unshift(n)}}function E8(){return IS()}const S8=new dv({id:"loaders.gl"}),T8=/\.([^.]+)$/;async function I8(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],e=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!FS(r))return null;let i=LS(r,t,{...e,nothrow:!0},n);if(i)return i;if(Eh(r)&&(r=await r.slice(0,10).arrayBuffer(),i=LS(r,t,e,n)),!i&&!(e!=null&&e.nothrow))throw new Error(MS(r));return i}function LS(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],e=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!FS(r))return null;if(t&&!Array.isArray(t))return pv(t);let i=[];t&&(i=i.concat(t)),e!=null&&e.ignoreRegisteredLoaders||i.push(...E8()),F8(i);const s=L8(r,i,e,n);if(!s&&!(e!=null&&e.nothrow))throw new Error(MS(r));return s}function L8(r,t,e,n){const i=$m(r),s=Av(r),a=uv(i)||(n==null?void 0:n.url);let o=null,A="";if(e!=null&&e.mimeType&&(o=gv(t,e==null?void 0:e.mimeType),A="match forced by supplied MIME type ".concat(e==null?void 0:e.mimeType)),o=o||M8(t,a),A=A||(o?"matched url ".concat(a):""),o=o||gv(t,s),A=A||(o?"matched MIME type ".concat(s):""),o=o||U8(t,r),A=A||(o?"matched initial data ".concat(US(r)):""),o=o||gv(t,e==null?void 0:e.fallbackMimeType),A=A||(o?"matched fallback MIME type ".concat(s):""),A){var f;S8.log(1,"selectLoader selected ".concat((f=o)===null||f===void 0?void 0:f.name,": ").concat(A,"."))}return o}function FS(r){return!(r instanceof Response&&r.status===204)}function MS(r){const t=$m(r),e=Av(r);let n="No valid loader found (";n+=t?"".concat(uS(t),", "):"no url provided, ",n+="MIME type: ".concat(e?'"'.concat(e,'"'):"not provided",", ");const i=r?US(r):"";return n+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",n+=")",n}function F8(r){for(const t of r)pv(t)}function M8(r,t){const e=t&&T8.exec(t),n=e&&e[1];return n?P8(r,n):null}function P8(r,t){t=t.toLowerCase();for(const e of r)for(const n of e.extensions)if(n.toLowerCase()===t)return e;return null}function gv(r,t){for(const e of r)if(e.mimeTypes&&e.mimeTypes.includes(t)||t==="application/x.".concat(e.id))return e;return null}function U8(r,t){if(!t)return null;for(const e of r)if(typeof t=="string"){if(R8(t,e))return e}else if(ArrayBuffer.isView(t)){if(PS(t.buffer,t.byteOffset,e))return e}else if(t instanceof ArrayBuffer&&PS(t,0,e))return e;return null}function R8(r,t){return t.testText?t.testText(r):(Array.isArray(t.tests)?t.tests:[t.tests]).some(n=>r.startsWith(n))}function PS(r,t,e){return(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>O8(r,t,e,i))}function O8(r,t,e,n){if(n instanceof ArrayBuffer)return TN(n,r,n.byteLength);switch(typeof n){case"function":return n(r,e);case"string":const i=mv(r,t,n.length);return n===i;default:return!1}}function US(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof r=="string"?r.slice(0,t):ArrayBuffer.isView(r)?mv(r.buffer,r.byteOffset,t):r instanceof ArrayBuffer?mv(r,0,t):""}function mv(r,t,e){if(r.byteLength<t+e)return"";const n=new DataView(r);let i="";for(let s=0;s<e;s++)i+=String.fromCharCode(n.getUint8(t+s));return i}const D8=256*1024;function*k8(r,t){const e=(t==null?void 0:t.chunkSize)||D8;let n=0;const i=new TextEncoder;for(;n<r.length;){const s=Math.min(r.length-n,e),a=r.slice(n,n+s);n+=s,yield i.encode(a)}}const N8=256*1024;function Q8(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:e=N8}=t;let n=0;for(;n<r.byteLength;){const i=Math.min(r.byteLength-n,e),s=new ArrayBuffer(i),a=new Uint8Array(r,n,i);new Uint8Array(s).set(a),n+=i,yield s}}()}const H8=1024*1024;async function*z8(r,t){const e=(t==null?void 0:t.chunkSize)||H8;let n=0;for(;n<r.size;){const i=n+e,s=await r.slice(n,i).arrayBuffer();n=i,yield s}}function RS(r,t){return Wm?G8(r,t):V8(r)}async function*G8(r,t){const e=r.getReader();let n;try{for(;;){const i=n||e.read();t!=null&&t._streamReadAhead&&(n=e.read());const{done:s,value:a}=await i;if(s)return;yield lS(a)}}catch{e.releaseLock()}}async function*V8(r,t){for await(const e of r)yield lS(e)}function j8(r,t){if(typeof r=="string")return k8(r,t);if(r instanceof ArrayBuffer)return Q8(r,t);if(Eh(r))return z8(r,t);if(hS(r))return RS(r,t);if(Ch(r))return RS(r.body,t);throw new Error("makeIterator")}const OS="Cannot convert supplied data type";function q8(r,t,e){if(t.text&&typeof r=="string")return r;if(qN(r)&&(r=r.buffer),r instanceof ArrayBuffer){const n=r;return t.text&&!t.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(r)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(r);let n=r.buffer;const i=r.byteLength||r.length;return(r.byteOffset!==0||i!==n.byteLength)&&(n=n.slice(r.byteOffset,r.byteOffset+i)),n}throw new Error(OS)}async function K8(r,t,e){const n=r instanceof ArrayBuffer||ArrayBuffer.isView(r);if(typeof r=="string"||n)return q8(r,t);if(Eh(r)&&(r=await pS(r)),Ch(r)){const i=r;return await t8(i),t.binary?await i.arrayBuffer():await i.text()}if(hS(r)&&(r=j8(r,e)),VN(r)||jN(r))return FN(r);throw new Error(OS)}function DS(r,t){const e=ES(),n=r||e;return typeof n.fetch=="function"?n.fetch:Pp(n.fetch)?i=>gS(i,n):t!=null&&t.fetch?t==null?void 0:t.fetch:gS}function W8(r,t,e){if(e)return e;const n={fetch:DS(t,r),...r};if(n.url){const i=uv(n.url);n.baseUrl=i,n.queryString=JN(n.url),n.filename=uS(i),n.baseUrl=lv(i)}return Array.isArray(n.loaders)||(n.loaders=null),n}function $8(r,t){if(!t&&r&&!Array.isArray(r))return r;let e;if(r&&(e=Array.isArray(r)?r:[r]),t&&t.loaders){const n=Array.isArray(t.loaders)?t.loaders:[t.loaders];e=e?[...e,...n]:n}return e&&e.length?e:null}async function yv(r,t,e,n){Rl(!n||typeof n=="object"),t&&!Array.isArray(t)&&!fv(t)&&(n=void 0,e=t,t=void 0),r=await r,e=e||{};const i=$m(r),a=$8(t,n),o=await I8(r,a,e);return o?(e=v8(e,o,a,i),n=W8({url:i,parse:yv,loaders:a},e,n||null),await X8(o,r,e,n)):null}async function X8(r,t,e,n){if(pN(r),Ch(t)){const i=t,{ok:s,redirected:a,status:o,statusText:A,type:f,url:m}=i,b=Object.fromEntries(i.headers.entries());n.response={headers:b,ok:s,redirected:a,status:o,statusText:A,type:f,url:m}}if(t=await K8(t,r,e),r.parseTextSync&&typeof t=="string")return e.dataType="text",r.parseTextSync(t,e,n,r);if(xN(r,e))return await BN(r,t,e,n,yv);if(r.parseText&&typeof t=="string")return await r.parseText(t,e,n,r);if(r.parse)return await r.parse(t,e,n,r);throw Rl(!r.parseSync),new Error("".concat(r.id," loader - no parser found and worker is disabled"))}async function bA(r,t,e,n){!Array.isArray(t)&&!fv(t)&&(e=t,t=void 0);const i=DS(e);let s=r;return typeof r=="string"&&(s=await i(r)),Eh(r)&&(s=await i(r)),await yv(s,t,e)}const Y8="3.4.14",{_parseImageNode:J8}=globalThis,_v=typeof Image<"u",vv=typeof ImageBitmap<"u",bv=Wm?!0:!!J8;function Z8(r){switch(r){case"auto":return vv||_v||bv;case"imagebitmap":return vv;case"image":return _v;case"data":return bv;default:throw new Error("@loaders.gl/images: image ".concat(r," not supported in this environment"))}}function tQ(){if(vv)return"imagebitmap";if(_v)return"image";if(bv)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function eQ(r){const t=nQ(r);if(!t)throw new Error("Not an image");return t}function rQ(r){switch(eQ(r)){case"data":return r;case"image":case"imagebitmap":const t=document.createElement("canvas"),e=t.getContext("2d");if(!e)throw new Error("getImageData");return t.width=r.width,t.height=r.height,e.drawImage(r,0,0),e.getImageData(0,0,r.width,r.height);default:throw new Error("getImageData")}}function nQ(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&r instanceof Image?"image":r&&typeof r=="object"&&r.data&&r.width&&r.height?"data":null}const iQ=/^data:image\/svg\+xml/,sQ=/\.svg((\?|#).*)?$/;function wv(r){return r&&(iQ.test(r)||sQ.test(r))}function oQ(r,t){if(wv(t)){let n=new TextDecoder().decode(r);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(n=unescape(encodeURIComponent(n)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(n))}return kS(r,t)}function kS(r,t){if(wv(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(r)])}async function NS(r,t,e){const n=oQ(r,e),i=self.URL||self.webkitURL,s=typeof n!="string"&&i.createObjectURL(n);try{return await aQ(s||n,t)}finally{s&&i.revokeObjectURL(s)}}async function aQ(r,t){const e=new Image;return e.src=r,t.image&&t.image.decode&&e.decode?(await e.decode(),e):await new Promise((n,i)=>{try{e.onload=()=>n(e),e.onerror=s=>i(new Error("Could not load image ".concat(r,": ").concat(s)))}catch(s){i(s)}})}const cQ={};let QS=!0;async function lQ(r,t,e){let n;wv(e)?n=await NS(r,t,e):n=kS(r,e);const i=t&&t.imagebitmap;return await uQ(n,i)}async function uQ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((AQ(t)||!QS)&&(t=null),t)try{return await createImageBitmap(r,t)}catch(e){console.warn(e),QS=!1}return await createImageBitmap(r)}function AQ(r){for(const t in r||cQ)return!1;return!0}function hQ(r){return!gQ(r,"ftyp",4)||!(r[8]&96)?null:dQ(r)}function dQ(r){switch(fQ(r,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function fQ(r,t,e){return String.fromCharCode(...r.slice(t,e))}function pQ(r){return[...r].map(t=>t.charCodeAt(0))}function gQ(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const n=pQ(t);for(let i=0;i<n.length;++i)if(n[i]!==r[i+e])return!1;return!0}const Ol=!1,Op=!0;function xv(r){const t=Dp(r);return yQ(t)||bQ(t)||_Q(t)||vQ(t)||mQ(t)}function mQ(r){const t=new Uint8Array(r instanceof DataView?r.buffer:r),e=hQ(t);return e?{mimeType:e.mimeType,width:0,height:0}:null}function yQ(r){const t=Dp(r);return t.byteLength>=24&&t.getUint32(0,Ol)===2303741511?{mimeType:"image/png",width:t.getUint32(16,Ol),height:t.getUint32(20,Ol)}:null}function _Q(r){const t=Dp(r);return t.byteLength>=10&&t.getUint32(0,Ol)===1195984440?{mimeType:"image/gif",width:t.getUint16(6,Op),height:t.getUint16(8,Op)}:null}function vQ(r){const t=Dp(r);return t.byteLength>=14&&t.getUint16(0,Ol)===16973&&t.getUint32(2,Op)===t.byteLength?{mimeType:"image/bmp",width:t.getUint32(18,Op),height:t.getUint32(22,Op)}:null}function bQ(r){const t=Dp(r);if(!(t.byteLength>=3&&t.getUint16(0,Ol)===65496&&t.getUint8(2)===255))return null;const{tableMarkers:n,sofMarkers:i}=wQ();let s=2;for(;s+9<t.byteLength;){const a=t.getUint16(s,Ol);if(i.has(a))return{mimeType:"image/jpeg",height:t.getUint16(s+5,Ol),width:t.getUint16(s+7,Ol)};if(!n.has(a))return null;s+=2,s+=t.getUint16(s,Ol)}return null}function wQ(){const r=new Set([65499,65476,65484,65501,65534]);for(let e=65504;e<65520;++e)r.add(e);return{tableMarkers:r,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Dp(r){if(r instanceof DataView)return r;if(ArrayBuffer.isView(r))return new DataView(r.buffer);if(r instanceof ArrayBuffer)return new DataView(r);throw new Error("toDataView")}async function xQ(r,t){const{mimeType:e}=xv(r)||{},n=globalThis._parseImageNode;return ai(n),await n(r,e)}async function BQ(r,t,e){t=t||{};const i=(t.image||{}).type||"auto",{url:s}=e||{},a=CQ(i);let o;switch(a){case"imagebitmap":o=await lQ(r,t,s);break;case"image":o=await NS(r,t,s);break;case"data":o=await xQ(r);break;default:ai(!1)}return i==="data"&&(o=rQ(o)),o}function CQ(r){switch(r){case"auto":case"data":return tQ();default:return Z8(r),r}}const HS={id:"image",module:"images",name:"Images",version:Y8,mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:BQ,tests:[r=>!!xv(new DataView(r))],options:{image:{type:"auto",decode:!0}}},Bv={};function EQ(r){if(Bv[r]===void 0){const t=Wm?TQ(r):SQ(r);Bv[r]=t}return Bv[r]}function SQ(r){const t=["image/png","image/jpeg","image/gif"],{_parseImageNode:e,_imageFormatsNode:n=t}=globalThis;return!!e&&n.includes(r)}function TQ(r){switch(r){case"image/avif":case"image/webp":return IQ(r);default:return!0}}function IQ(r){try{return document.createElement("canvas").toDataURL(r).indexOf("data:".concat(r))===0}catch{return!1}}function zS(r){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const t=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,e=r||t;return!!(e&&e.indexOf("Electron")>=0)}function xu(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||zS()}const Zm={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},t0=Zm.window||Zm.self||Zm.global,kp=Zm.process||{},GS=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";xu();const Cv=globalThis;function VS(r){if(!r&&!xu())return"Node";if(zS(r))return"Electron";const e=r||(typeof navigator<"u"?navigator:{}).userAgent||"";if(e.indexOf("Edge")>-1)return"Edge";const n=e.indexOf("MSIE ")!==-1,i=e.indexOf("Trident/")!==-1;return n||i?"IE":Cv.chrome?"Chrome":Cv.safari?"Safari":Cv.mozInnerScreenX?"Firefox":"Unknown"}function LQ(r){try{const t=window[r],e="__storage_test__";return t.setItem(e,e),t.removeItem(e),t}catch{return null}}class FQ{constructor(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";W(this,"storage",void 0),W(this,"id",void 0),W(this,"config",void 0),this.storage=LQ(n),this.id=t,this.config=e,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function MQ(r){let t;return r<10?t="".concat(r.toFixed(2),"ms"):r<100?t="".concat(r.toFixed(1),"ms"):r<1e3?t="".concat(r.toFixed(0),"ms"):t="".concat((r/1e3).toFixed(2),"s"),t}function PQ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const e=Math.max(t-r.length,0);return"".concat(" ".repeat(e)).concat(r)}function Ev(r,t,e){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=r.src.replace(/\(/g,"%28").replace(/\)/g,"%29");r.width>n&&(e=Math.min(e,n/r.width));const s=r.width*e,a=r.height*e,o=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(t," %c+"),o]}let e0;(function(r){r[r.BLACK=30]="BLACK",r[r.RED=31]="RED",r[r.GREEN=32]="GREEN",r[r.YELLOW=33]="YELLOW",r[r.BLUE=34]="BLUE",r[r.MAGENTA=35]="MAGENTA",r[r.CYAN=36]="CYAN",r[r.WHITE=37]="WHITE",r[r.BRIGHT_BLACK=90]="BRIGHT_BLACK",r[r.BRIGHT_RED=91]="BRIGHT_RED",r[r.BRIGHT_GREEN=92]="BRIGHT_GREEN",r[r.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",r[r.BRIGHT_BLUE=94]="BRIGHT_BLUE",r[r.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",r[r.BRIGHT_CYAN=96]="BRIGHT_CYAN",r[r.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(e0||(e0={}));function jS(r){return typeof r=="string"?e0[r.toUpperCase()]||e0.WHITE:r}function UQ(r,t,e){return!xu&&typeof r=="string"&&(t&&(t=jS(t),r="\x1B[".concat(t,"m").concat(r,"\x1B[39m")),e&&(t=jS(e),r="\x1B[".concat(e+10,"m").concat(r,"\x1B[49m"))),r}function RQ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const e=Object.getPrototypeOf(r),n=Object.getOwnPropertyNames(e);for(const i of n)typeof r[i]=="function"&&(t.find(s=>i===s)||(r[i]=r[i].bind(r)))}function r0(r,t){if(!r)throw new Error(t||"Assertion failed")}function Od(){let r;if(xu&&"performance"in t0){var t,e;r=t0==null||(t=t0.performance)===null||t===void 0||(e=t.now)===null||e===void 0?void 0:e.call(t)}else if("hrtime"in kp){var n;const i=kp==null||(n=kp.hrtime)===null||n===void 0?void 0:n.call(kp);r=i[0]*1e3+i[1]/1e6}else r=Date.now();return r}const Dd={debug:xu&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},OQ={enabled:!0,level:0};function tc(){}const qS={},KS={once:!0};class Sv{constructor(){let{id:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};W(this,"id",void 0),W(this,"VERSION",GS),W(this,"_startTs",Od()),W(this,"_deltaTs",Od()),W(this,"_storage",void 0),W(this,"userData",{}),W(this,"LOG_THROTTLE_TIMEOUT",0),this.id=t,this.userData={},this._storage=new FQ("__probe-".concat(this.id,"__"),OQ),this.timeStamp("".concat(this.id," started")),RQ(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Od()-this._startTs).toPrecision(10))}getDelta(){return Number((Od()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:t}),this}setLevel(t){return this._storage.setConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,e){this._storage.setConfiguration({[t]:e})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,e){r0(t,e)}warn(t){return this._getLogFunction(0,t,Dd.warn,arguments,KS)}error(t){return this._getLogFunction(0,t,Dd.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,Dd.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,Dd.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];return this._getLogFunction(t,e,Dd.debug||Dd.info,arguments,KS)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||tc,n&&[n],{tag:QQ(e)}):tc}image(t){let{logLevel:e,priority:n,image:i,message:s="",scale:a=1}=t;return this._shouldLog(e||n)?xu?NQ({image:i,message:s,scale:a}):kQ():tc}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||tc)}group(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=$S({logLevel:t,message:e,opts:n}),{collapsed:s}=n;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||tc)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=WS(t)}_getLogFunction(t,e,n,i,s){if(this._shouldLog(t)){s=$S({logLevel:t,message:e,args:i,opts:s}),n=n||s.method,r0(n),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Od();const a=s.tag||s.message;if(s.once)if(!qS[a])qS[a]=Od();else return tc;return e=DQ(this.id,s.message,s),n.bind(console,e,...s.args)}return tc}}W(Sv,"VERSION",GS);function WS(r){if(!r)return 0;let t;switch(typeof r){case"number":t=r;break;case"object":t=r.logLevel||r.priority||0;break;default:return 0}return r0(Number.isFinite(t)&&t>=0),t}function $S(r){const{logLevel:t,message:e}=r;r.logLevel=WS(t);const n=r.args?Array.from(r.args):[];for(;n.length&&n.shift()!==e;);switch(typeof t){case"string":case"function":e!==void 0&&n.unshift(e),r.message=t;break;case"object":Object.assign(r,t);break}typeof r.message=="function"&&(r.message=r.message());const i=typeof r.message;return r0(i==="string"||i==="object"),Object.assign(r,{args:n},r.opts)}function DQ(r,t,e){if(typeof t=="string"){const n=e.time?PQ(MQ(e.total)):"";t=e.time?"".concat(r,": ").concat(n,"  ").concat(t):"".concat(r,": ").concat(t),t=UQ(t,e.color,e.background)}return t}function kQ(r){return console.warn("removed"),tc}function NQ(r){let{image:t,message:e="",scale:n=1}=r;if(typeof t=="string"){const s=new Image;return s.onload=()=>{const a=Ev(s,e,n);console.log(...a)},s.src=t,tc}const i=t.nodeName||"";if(i.toLowerCase()==="img")return console.log(...Ev(t,e,n)),tc;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...Ev(s,e,n)),s.src=t.toDataURL(),tc}return tc}function QQ(r){for(const t in r)for(const e in r[t])return e||"untitled";return"empty"}const Fn=new Sv({id:"deck"}),wA={attributeUpdateStart:-1,attributeManagerUpdateStart:-1,attributeUpdateMessages:[]},Tv=1,Np=2,Iv=3,Lv=4,HQ=2,zQ=r=>({"layer.changeFlag":(t,e,n)=>{r.log(Iv,"".concat(t.id," ").concat(e,": "),n[e])()},"layer.initialize":t=>{r.log(Tv,"Initializing ".concat(t))()},"layer.update":(t,e)=>{if(e){const n=t.getChangeFlags();r.log(Np,"Updating ".concat(t," because: ").concat(Object.keys(n).filter(i=>n[i]).join(", ")))()}else r.log(Lv,"".concat(t," does not need update"))()},"layer.matched":(t,e)=>{e&&r.log(Lv,"Matched ".concat(t,", state transfered"))()},"layer.finalize":t=>{r.log(Tv,"Finalizing ".concat(t))()},"compositeLayer.renderLayers":(t,e,n)=>{e?r.log(Np,"Composite layer rendered new subLayers ".concat(t),n)():r.log(Lv,"Composite layer reused subLayers ".concat(t),n)()},"layerManager.setLayers":(t,e,n)=>{e&&r.log(Np,"Updating ".concat(n.length," deck layers"))()},"layerManager.activateViewport":(t,e)=>{r.log(Iv,"Viewport changed",e)()},"attributeManager.invalidate":(t,e,n)=>{r.log(Tv,n?"invalidated attributes ".concat(n," (").concat(e,") for ").concat(t.id):"invalidated all attributes for ".concat(t.id))()},"attributeManager.updateStart":t=>{wA.attributeUpdateMessages.length=0,wA.attributeManagerUpdateStart=Date.now()},"attributeManager.updateEnd":(t,e)=>{const n=Math.round(Date.now()-wA.attributeManagerUpdateStart);r.groupCollapsed(Np,"Updated attributes for ".concat(e," instances in ").concat(t.id," in ").concat(n,"ms"))();for(const i of wA.attributeUpdateMessages)r.log(Iv,i)();r.groupEnd(Np)()},"attribute.updateStart":t=>{wA.attributeUpdateStart=Date.now()},"attribute.allocate":(t,e)=>{const n="".concat(t.id," allocated ").concat(e);wA.attributeUpdateMessages.push(n)},"attribute.updateEnd":(t,e)=>{const n=Math.round(Date.now()-wA.attributeUpdateStart),i="".concat(t.id," updated ").concat(e," in ").concat(n,"ms");wA.attributeUpdateMessages.push(i)},"deckRenderer.renderLayers":(t,e,n)=>{const{pass:i,redrawReason:s,stats:a}=n;for(const o of e){const{totalCount:A,visibleCount:f,compositeCount:m,pickableCount:b}=o,C=A-m-f;r.log(HQ,"RENDER #".concat(t.renderCount,"   ").concat(f," (of ").concat(A," layers) to ").concat(i," because ").concat(s,"   (").concat(C," hidden, ").concat(m," composite ").concat(b," pickable)"))(),a&&a.get("Redraw Layers").add(f)}}});var GQ={};let n0={};GQ.NODE_ENV!=="production"&&(n0=zQ(Fn));function VQ(r){n0=r}function oo(r,t,e,n){Fn.level>0&&n0[r]&&n0[r].call(null,t,e,n)}function jQ(r){const t=r[0],e=r[r.length-1];return t==="{"&&e==="}"||t==="["&&e==="]"}const qQ={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:jQ,parseTextSync:JSON.parse};function KQ(){const r="8.9.35",t=globalThis.deck&&globalThis.deck.VERSION;if(t&&t!==r)throw new Error("deck.gl - multiple versions detected: ".concat(t," vs ").concat(r));return t||(Fn.log(1,"deck.gl ".concat(r))(),globalThis.deck={...globalThis.deck,VERSION:r,version:r,log:Fn,_registerLoggers:VQ},C8([qQ,[HS,{imagebitmap:{premultiplyAlpha:"none"}}]])),r}const WQ=KQ(),Sn={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Sn,"IDENTITY",{get:()=>(Fn.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Dl={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Fv={common:0,meters:1,pixels:2},XS={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},mr=new Sv({id:"luma.gl"});function Fo(r,t){if(!r)throw new Error(t||"luma.gl: assertion failed.")}const $Q="Invalid WebGLRenderingContext",XQ="Requires WebGL2";function i0(r){return typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?!0:!!(r&&Number.isFinite(r._version))}function pn(r){return typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?!0:!!(r&&r._version===2)}function YQ(r){return pn(r)?r:null}function s0(r){return Fo(i0(r),$Q),r}function Mo(r){return Fo(pn(r),XQ),r}const Qp={};function JQ(r){globalThis.console&&globalThis.console.error&&globalThis.console.error(r)}function ZQ(r){globalThis.console&&globalThis.console.log&&globalThis.console.log(r)}function t7(r,t){Qp[r]=!0,t!==void 0&&JQ(t)}function e7(r){const t=r.getError;r.getError=function(){let n;do n=t.apply(r),n!==0&&(Qp[n]=!0);while(n!==0);for(n in Qp)if(Qp[n])return delete Qp[n],parseInt(n,10);return 0}}const Hp=function r(t){const e=t.gl;this.ext=t,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(t.maxVertexAttribs);for(let n=0;n<this.attribs.length;n++){const i=new r.VertexAttrib(e);this.attribs[n]=i}this.maxAttrib=0};Hp.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()},Hp.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Sh=function(t){const e=this;this.gl=t,e7(t);const n=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(s){return s===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(s){const a=e.currentVertexArrayObject;a.maxAttrib=Math.max(a.maxAttrib,s);const o=a.attribs[s];return o.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(s){const a=e.currentVertexArrayObject;a.maxAttrib=Math.max(a.maxAttrib,s);const o=a.attribs[s];return o.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(s,a){switch(s){case 34962:e.currentArrayBuffer=a;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=a;break}return n.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(s,a){const A=e.currentVertexArrayObject.attribs[s];switch(a){case 34975:return A.buffer;case 34338:return A.enabled;case 34339:return A.size;case 34340:return A.stride;case 34341:return A.type;case 34922:return A.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(s,a,o,A,f,m){const b=e.currentVertexArrayObject;b.maxAttrib=Math.max(b.maxAttrib,s);const x=b.attribs[s];return x.buffer=e.currentArrayBuffer,x.size=a,x.type=o,x.normalized=A,x.stride=f,x.offset=m,x.recache(),n.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",()=>{ZQ("OESVertexArrayObject emulation library context restored"),e.reset_()},!0),this.reset_()};Sh.prototype.VERTEX_ARRAY_BINDING_OES=34229,Sh.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let n=0;n<this.vertexArrayObjects.length;++n)this.vertexArrayObjects.isAlive=!1;const e=this.gl;this.maxVertexAttribs=e.getParameter(34921),this.defaultVertexArrayObject=new Hp(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},Sh.prototype.createVertexArrayOES=function(){const t=new Hp(this);return this.vertexArrayObjects.push(t),t},Sh.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},Sh.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof Hp&&t.hasBeenBound&&t.ext===this)},Sh.prototype.bindVertexArrayOES=function(t){const e=this.gl;if(t&&!t.isAlive){t7(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const n=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&n.bindBuffer.call(e,34963,s.elementArrayBuffer);let a=this.currentArrayBuffer;const o=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let A=0;A<=o;A++){const f=s.attribs[A],m=i?i.attribs[A]:null;if((!i||f.enabled!==m.enabled)&&(f.enabled?n.enableVertexAttribArray.call(e,A):n.disableVertexAttribArray.call(e,A)),f.enabled){let b=!1;(!i||f.buffer!==m.buffer)&&(a!==f.buffer&&(n.bindBuffer.call(e,34962,f.buffer),a=f.buffer),b=!0),(b||f.cached!==m.cached)&&n.vertexAttribPointer.call(e,A,f.size,f.type,f.normalized,f.stride,f.offset)}}this.currentArrayBuffer!==a&&n.bindBuffer.call(e,34962,this.currentArrayBuffer)};function r7(r){if(typeof r.createVertexArray=="function")return;const t=r.getSupportedExtensions;r.getSupportedExtensions=function(){const i=t.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const e=r.getExtension;r.getExtension=function(i){const s=e.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(r.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Sh(this)),this.__OESVertexArrayObject))}}const YS="OES_element_index",JS="WEBGL_draw_buffers",n7="EXT_disjoint_timer_query",i7="EXT_disjoint_timer_query_webgl2",s7="EXT_texture_filter_anisotropic",ZS="WEBGL_debug_renderer_info",o7=35723,a7=4352,c7=36795,l7=34047,u7=37445,A7=37446,fi=r=>pn(r)?void 0:0,h7={3074:r=>pn(r)?void 0:36064,[o7]:r=>pn(r)?void 0:a7,35977:fi,32937:fi,[c7]:(r,t)=>{const e=pn(r)?r.getExtension(i7):r.getExtension(n7);return e&&e.GPU_DISJOINT_EXT?t(e.GPU_DISJOINT_EXT):0},[u7]:(r,t)=>{const e=r.getExtension(ZS);return t(e&&e.UNMASKED_VENDOR_WEBGL||7936)},[A7]:(r,t)=>{const e=r.getExtension(ZS);return t(e&&e.UNMASKED_RENDERER_WEBGL||7937)},[l7]:(r,t)=>{const e=r.luma.extensions[s7];return e?t(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:fi,35071:fi,37447:fi,36063:(r,t)=>{if(!pn(r)){const e=r.getExtension(JS);return e?t(e.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:fi,35374:fi,35377:fi,34852:r=>{if(!pn(r)){const t=r.getExtension(JS);return t?t.MAX_DRAW_BUFFERS_WEBGL:0}},36203:r=>r.getExtension(YS)?2147483647:65535,33001:r=>r.getExtension(YS)?16777216:65535,33e3:r=>16777216,37157:fi,35373:fi,35657:fi,36183:fi,37137:fi,34045:fi,35978:fi,35979:fi,35968:fi,35376:fi,35375:fi,35659:fi,37154:fi,35371:fi,35658:fi,35076:fi,35077:fi,35380:fi};function d7(r,t,e){const n=h7[e],i=typeof n=="function"?n(r,t,e):n;return i!==void 0?i:t(e)}const f7="OES_vertex_array_object",t5="ANGLE_instanced_arrays",p7="WEBGL_draw_buffers",g7="EXT_disjoint_timer_query",m7="EXT_texture_filter_anisotropic",y7="VertexArray requires WebGL2 or OES_vertex_array_object extension";function _7(r,t){return{webgl2:pn(r),ext:r.getExtension(t)}}const e5={[f7]:{meta:{suffix:"OES"},createVertexArray:()=>{Fo(!1,y7)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[t5]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(r,t){Fo(t===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[p7]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Fo(!1)}},[g7]:{meta:{suffix:"EXT"},createQuery:()=>{Fo(!1)},deleteQuery:()=>{Fo(!1)},beginQuery:()=>{Fo(!1)},endQuery:()=>{},getQuery(r,t){return this.getQueryObject(r,t)},getQueryParameter(r,t){return this.getQueryObject(r,t)},getQueryObject:()=>{}}},Mv={readBuffer:(r,t,e)=>{pn(r)&&t(e)},getVertexAttrib:(r,t,e,n)=>{const{webgl2:i,ext:s}=_7(r,t5);let a;switch(n){case 35069:a=i?void 0:!1;break;case 35070:a=!i&&!s?0:void 0;break}return a!==void 0?a:t(e,n)},getProgramParameter:(r,t,e,n)=>{if(!pn(r))switch(n){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return t(e,n)},getInternalformatParameter:(r,t,e,n,i)=>{if(!pn(r))switch(i){case 32937:return new Int32Array([0])}return r.getInternalformatParameter(e,n,i)},getTexParameter(r,t,e,n){switch(n){case 34046:const{extensions:i}=r.luma,s=i[m7];n=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return t(e,n)},getParameter:d7,hint(r,t,e,n){return t(e,n)}};function v7(r){r.luma=r.luma||{};const{luma:t}=r;return t.polyfilled||(r7(r),b7(r),x7(r,e5),w7(r,{target:t,target2:r}),t.polyfilled=!0),r}globalThis.polyfillContext=v7;function b7(r){r.luma.extensions={};const t=r.getSupportedExtensions()||[];for(const e of t)r.luma[e]=r.getExtension(e)}function w7(r,t){let{target:e,target2:n}=t;Object.keys(Mv).forEach(i=>{if(typeof Mv[i]=="function"){const s=r[i]?r[i].bind(r):()=>{},a=Mv[i].bind(null,r,s);e[i]=a,n[i]=a}})}function x7(r,t){for(const e of Object.getOwnPropertyNames(t))e!=="overrides"&&B7(r,{extension:e,target:r.luma,target2:r})}function B7(r,t){let{extension:e,target:n,target2:i}=t;const s=e5[e];Fo(s);const{meta:a={}}=s,{suffix:o=""}=a,A=r.getExtension(e);for(const f of Object.keys(s)){const m="".concat(f).concat(o);let b=null;f==="meta"||typeof r[f]=="function"||(A&&typeof A[m]=="function"?b=function(){return A[m](...arguments)}:typeof s[f]=="function"&&(b=s[f].bind(n))),b&&(n[f]=b,i[f]=b)}}const Pv={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},xA=(r,t,e)=>t?r.enable(e):r.disable(e),r5=(r,t,e)=>r.hint(e,t),Sa=(r,t,e)=>r.pixelStorei(e,t),C7=(r,t)=>{const e=pn(r)?36009:36160;return r.bindFramebuffer(e,t)},E7=(r,t)=>r.bindFramebuffer(36008,t);function zp(r){return Array.isArray(r)||ArrayBuffer.isView(r)}const S7={3042:xA,32773:(r,t)=>r.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(r,t)=>r.clearColor(...t),3107:(r,t)=>r.colorMask(...t),2884:xA,2885:(r,t)=>r.cullFace(t),2929:xA,2931:(r,t)=>r.clearDepth(t),2932:(r,t)=>r.depthFunc(t),2928:(r,t)=>r.depthRange(...t),2930:(r,t)=>r.depthMask(t),3024:xA,35723:r5,36006:C7,2886:(r,t)=>r.frontFace(t),33170:r5,2849:(r,t)=>r.lineWidth(t),32823:xA,32824:"polygonOffset",10752:"polygonOffset",35977:xA,32938:"sampleCoverage",32939:"sampleCoverage",3089:xA,3088:(r,t)=>r.scissor(...t),2960:xA,2961:(r,t)=>r.clearStencil(t),2968:(r,t)=>r.stencilMaskSeparate(1028,t),36005:(r,t)=>r.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(r,t)=>r.viewport(...t),3333:Sa,3317:Sa,37440:Sa,37441:Sa,37443:Sa,3330:Sa,3332:Sa,3331:Sa,36010:E7,3314:Sa,32878:Sa,3316:Sa,3315:Sa,32877:Sa,framebuffer:(r,t)=>{const e=t&&"handle"in t?t.handle:t;return r.bindFramebuffer(36160,e)},blend:(r,t)=>t?r.enable(3042):r.disable(3042),blendColor:(r,t)=>r.blendColor(...t),blendEquation:(r,t)=>{t=zp(t)?t:[t,t],r.blendEquationSeparate(...t)},blendFunc:(r,t)=>{t=zp(t)&&t.length===2?[...t,...t]:t,r.blendFuncSeparate(...t)},clearColor:(r,t)=>r.clearColor(...t),clearDepth:(r,t)=>r.clearDepth(t),clearStencil:(r,t)=>r.clearStencil(t),colorMask:(r,t)=>r.colorMask(...t),cull:(r,t)=>t?r.enable(2884):r.disable(2884),cullFace:(r,t)=>r.cullFace(t),depthTest:(r,t)=>t?r.enable(2929):r.disable(2929),depthFunc:(r,t)=>r.depthFunc(t),depthMask:(r,t)=>r.depthMask(t),depthRange:(r,t)=>r.depthRange(...t),dither:(r,t)=>t?r.enable(3024):r.disable(3024),derivativeHint:(r,t)=>{r.hint(35723,t)},frontFace:(r,t)=>r.frontFace(t),mipmapHint:(r,t)=>r.hint(33170,t),lineWidth:(r,t)=>r.lineWidth(t),polygonOffsetFill:(r,t)=>t?r.enable(32823):r.disable(32823),polygonOffset:(r,t)=>r.polygonOffset(...t),sampleCoverage:(r,t)=>r.sampleCoverage(...t),scissorTest:(r,t)=>t?r.enable(3089):r.disable(3089),scissor:(r,t)=>r.scissor(...t),stencilTest:(r,t)=>t?r.enable(2960):r.disable(2960),stencilMask:(r,t)=>{t=zp(t)?t:[t,t];const[e,n]=t;r.stencilMaskSeparate(1028,e),r.stencilMaskSeparate(1029,n)},stencilFunc:(r,t)=>{t=zp(t)&&t.length===3?[...t,...t]:t;const[e,n,i,s,a,o]=t;r.stencilFuncSeparate(1028,e,n,i),r.stencilFuncSeparate(1029,s,a,o)},stencilOp:(r,t)=>{t=zp(t)&&t.length===3?[...t,...t]:t;const[e,n,i,s,a,o]=t;r.stencilOpSeparate(1028,e,n,i),r.stencilOpSeparate(1029,s,a,o)},viewport:(r,t)=>r.viewport(...t)};function Ni(r,t,e){return t[r]!==void 0?t[r]:e[r]}const T7={blendEquation:(r,t,e)=>r.blendEquationSeparate(Ni(32777,t,e),Ni(34877,t,e)),blendFunc:(r,t,e)=>r.blendFuncSeparate(Ni(32969,t,e),Ni(32968,t,e),Ni(32971,t,e),Ni(32970,t,e)),polygonOffset:(r,t,e)=>r.polygonOffset(Ni(32824,t,e),Ni(10752,t,e)),sampleCoverage:(r,t,e)=>r.sampleCoverage(Ni(32938,t,e),Ni(32939,t,e)),stencilFuncFront:(r,t,e)=>r.stencilFuncSeparate(1028,Ni(2962,t,e),Ni(2967,t,e),Ni(2963,t,e)),stencilFuncBack:(r,t,e)=>r.stencilFuncSeparate(1029,Ni(34816,t,e),Ni(36003,t,e),Ni(36004,t,e)),stencilOpFront:(r,t,e)=>r.stencilOpSeparate(1028,Ni(2964,t,e),Ni(2965,t,e),Ni(2966,t,e)),stencilOpBack:(r,t,e)=>r.stencilOpSeparate(1029,Ni(34817,t,e),Ni(34818,t,e),Ni(34819,t,e))},n5={enable:(r,t)=>r({[t]:!0}),disable:(r,t)=>r({[t]:!1}),pixelStorei:(r,t,e)=>r({[t]:e}),hint:(r,t,e)=>r({[t]:e}),bindFramebuffer:(r,t,e)=>{switch(t){case 36160:return r({36006:e,36010:e});case 36009:return r({36006:e});case 36008:return r({36010:e});default:return null}},blendColor:(r,t,e,n,i)=>r({32773:new Float32Array([t,e,n,i])}),blendEquation:(r,t)=>r({32777:t,34877:t}),blendEquationSeparate:(r,t,e)=>r({32777:t,34877:e}),blendFunc:(r,t,e)=>r({32969:t,32968:e,32971:t,32970:e}),blendFuncSeparate:(r,t,e,n,i)=>r({32969:t,32968:e,32971:n,32970:i}),clearColor:(r,t,e,n,i)=>r({3106:new Float32Array([t,e,n,i])}),clearDepth:(r,t)=>r({2931:t}),clearStencil:(r,t)=>r({2961:t}),colorMask:(r,t,e,n,i)=>r({3107:[t,e,n,i]}),cullFace:(r,t)=>r({2885:t}),depthFunc:(r,t)=>r({2932:t}),depthRange:(r,t,e)=>r({2928:new Float32Array([t,e])}),depthMask:(r,t)=>r({2930:t}),frontFace:(r,t)=>r({2886:t}),lineWidth:(r,t)=>r({2849:t}),polygonOffset:(r,t,e)=>r({32824:t,10752:e}),sampleCoverage:(r,t,e)=>r({32938:t,32939:e}),scissor:(r,t,e,n,i)=>r({3088:new Int32Array([t,e,n,i])}),stencilMask:(r,t)=>r({2968:t,36005:t}),stencilMaskSeparate:(r,t,e)=>r({[t===1028?2968:36005]:e}),stencilFunc:(r,t,e,n)=>r({2962:t,2967:e,2963:n,34816:t,36003:e,36004:n}),stencilFuncSeparate:(r,t,e,n,i)=>r({[t===1028?2962:34816]:e,[t===1028?2967:36003]:n,[t===1028?2963:36004]:i}),stencilOp:(r,t,e,n)=>r({2964:t,2965:e,2966:n,34817:t,34818:e,34819:n}),stencilOpSeparate:(r,t,e,n,i)=>r({[t===1028?2964:34817]:e,[t===1028?2965:34818]:n,[t===1028?2966:34819]:i}),viewport:(r,t,e,n,i)=>r({2978:[t,e,n,i]})},kl=(r,t)=>r.isEnabled(t),i5={3042:kl,2884:kl,2929:kl,3024:kl,32823:kl,32926:kl,32928:kl,3089:kl,2960:kl,35977:kl};function s5(r){for(const t in r)return!1;return!0}function I7(r,t){if(r===t)return!0;const e=Array.isArray(r)||ArrayBuffer.isView(r),n=Array.isArray(t)||ArrayBuffer.isView(t);if(e&&n&&r.length===t.length){for(let i=0;i<r.length;++i)if(r[i]!==t[i])return!1;return!0}return!1}function o5(r,t){const e=r[t].bind(r);r[t]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in r.state.cache?r.state.enable?r.state.cache[i]:e(...arguments):e(...arguments)},Object.defineProperty(r[t],"name",{value:"".concat(t,"-from-cache"),configurable:!1})}function L7(r,t,e){const n=r[t].bind(r);r[t]=function(){for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];const{valueChanged:A,oldValue:f}=e(r.state._updateCache,...a);return A&&n(...a),f},Object.defineProperty(r[t],"name",{value:"".concat(t,"-to-cache"),configurable:!1})}function F7(r){const t=r.useProgram.bind(r);r.useProgram=function(n){r.state.program!==n&&(t(n),r.state.program=n)}}class M7{constructor(t){let{copyState:e=!1,log:n=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=t,this.program=null,this.stateStack=[],this.enable=!0,this.cache=e?U7(t):Object.assign({},Pv),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Fo(this.stateStack.length>0);const t=this.stateStack[this.stateStack.length-1];Bu(this.gl,t),this.stateStack.pop()}_updateCache(t){let e=!1,n;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in t){Fo(s!==void 0);const a=t[s],o=this.cache[s];I7(a,o)||(e=!0,n=o,i&&!(s in i)&&(i[s]=o),this.cache[s]=a)}return{valueChanged:e,oldValue:n}}}function a5(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:e=!0,copyState:n}=t;if(Fo(n!==void 0),!r.state){const{polyfillContext:i}=globalThis;i&&i(r),r.state=new M7(r,{copyState:n}),F7(r);for(const s in n5){const a=n5[s];L7(r,s,a)}o5(r,"getParameter"),o5(r,"isEnabled")}return r.state.enable=e,r}function P7(r){r.state||a5(r,{copyState:!1}),r.state.push()}function c5(r){Fo(r.state),r.state.pop()}function Bu(r,t){if(Fo(i0(r),"setParameters requires a WebGL context"),s5(t))return;const e={};for(const i in t){const s=Number(i),a=S7[i];a&&(typeof a=="string"?e[a]=!0:a(r,t[i],s))}const n=r.state&&r.state.cache;if(n)for(const i in e){const s=T7[i];s(r,t,n)}}function U7(r,t){if(t=t||Pv,typeof t=="number"){const i=t,s=i5[i];return s?s(r,i):r.getParameter(i)}const e=Array.isArray(t)?t:Object.keys(t),n={};for(const i of e){const s=i5[i];n[i]=s?s(r,Number(i)):r.getParameter(Number(i))}return n}function R7(r){Bu(r,Pv)}function Oc(r,t,e){if(s5(t))return e(r);const{nocatch:n=!0}=t;P7(r),Bu(r,t);let i;if(n)i=e(r),c5(r);else try{i=e(r)}finally{c5(r)}return i}function kd(r){const{luma:t}=r;if(r.canvas&&t){const e=t.canvasSizeInfo,n="clientWidth"in e?e.clientWidth:r.canvas.clientWidth;return n?r.drawingBufferWidth/n:1}return 1}function Uv(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=kd(r),i=r.drawingBufferWidth,s=r.drawingBufferHeight;return D7(t,n,i,s,e)}function O7(r){const t=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(r)?r<=0?1:r:r?t:1}function D7(r,t,e,n,i){const s=l5(r[0],t,e);let a=u5(r[1],t,n,i),o=l5(r[0]+1,t,e);const A=o===e-1?o:o-1;o=u5(r[1]+1,t,n,i);let f;return i?(o=o===0?o:o+1,f=a,a=o):f=o===n-1?o:o-1,{x:s,y:a,width:Math.max(A-s+1,1),height:Math.max(f-a+1,1)}}function l5(r,t,e){return Math.min(Math.round(r*t),e-1)}function u5(r,t,e,n){return n?Math.max(0,e-1-Math.round(r*t)):Math.min(Math.round(r*t),e-1)}const Rv=xu(),k7=Rv&&typeof document<"u",A5={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function h5(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Fo(Rv,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),r=Object.assign({},A5,r);const{width:t,height:e}=r;function n(o){if(r.throwOnError)throw new Error(o);return console.error(o),null}r.onError=n;let i;const{canvas:s}=r,a=z7({canvas:s,width:t,height:e,onError:n});return i=H7(a,r),i?(i=Ov(i,r),G7(i),i):null}function Ov(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!r||r._instrumented)return r;r._version=r._version||V7(r),r.luma=r.luma||{},r.luma.canvasSizeInfo=r.luma.canvasSizeInfo||{},t=Object.assign({},A5,t);const{manageState:e,debug:n}=t;return e&&a5(r,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return mr.log(1,...s)()}}),Rv&&n&&(globalThis.makeDebugContext?(r=globalThis.makeDebugContext(r,t),mr.level=Math.max(mr.level,1)):mr.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),r._instrumented=!0,r}function N7(r){const t=r.getParameter(7936),e=r.getParameter(7937),n=r.getExtension("WEBGL_debug_renderer_info"),i=n&&r.getParameter(n.UNMASKED_VENDOR_WEBGL||7936),s=n&&r.getParameter(n.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||t,renderer:s||e,vendorMasked:t,rendererMasked:e,version:r.getParameter(7938),shadingLanguageVersion:r.getParameter(35724)}}function Q7(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r.canvas){const n=O7(t.useDevicePixels);j7(r,n,t);return}const e=r.getExtension("STACKGL_resize_drawingbuffer");e&&"width"in t&&"height"in t&&e.resize(t.width,t.height)}function H7(r,t){const{onError:e}=t;let n=null;const i=A=>n=A.statusMessage||n;r.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:a=!0}=t;let o=null;return a&&(o=o||r.getContext("webgl2",t),o=o||r.getContext("experimental-webgl2",t)),s&&(o=o||r.getContext("webgl",t),o=o||r.getContext("experimental-webgl",t)),r.removeEventListener("webglcontextcreationerror",i,!1),o?(t.onContextLost&&r.addEventListener("webglcontextlost",t.onContextLost,!1),t.onContextRestored&&r.addEventListener("webglcontextrestored",t.onContextRestored,!1),o):e("Failed to create ".concat(a&&!s?"WebGL2":"WebGL"," context: ").concat(n||"Unknown error"))}function z7(r){let{canvas:t,width:e=800,height:n=600,onError:i}=r,s;return typeof t=="string"?(k7&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(t,"' before page was loaded")),s=document.getElementById(t)):t?s=t:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(e)?"".concat(e,"px"):"100%",s.style.height=Number.isFinite(n)?"".concat(n,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function G7(r){const t=pn(r)?"WebGL2":"WebGL1",e=N7(r),n=e?"(".concat(e.vendor,",").concat(e.renderer,")"):"",i=r.debug?" debug":"";mr.info(1,"".concat(t).concat(i," context ").concat(n))()}function V7(r){return typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?2:1}function j7(r,t,e){let n="width"in e?e.width:r.canvas.clientWidth,i="height"in e?e.height:r.canvas.clientHeight;(!n||!i)&&(mr.log(1,"Canvas clientWidth/clientHeight is 0")(),t=1,n=r.canvas.width||1,i=r.canvas.height||1),r.luma=r.luma||{},r.luma.canvasSizeInfo=r.luma.canvasSizeInfo||{};const s=r.luma.canvasSizeInfo;if(s.clientWidth!==n||s.clientHeight!==i||s.devicePixelRatio!==t){let a=t;const o=Math.floor(n*a),A=Math.floor(i*a);r.canvas.width=o,r.canvas.height=A,(r.drawingBufferWidth!==o||r.drawingBufferHeight!==A)&&(mr.warn("Device pixel ratio clamped")(),a=Math.min(r.drawingBufferWidth/n,r.drawingBufferHeight/i),r.canvas.width=Math.floor(n*a),r.canvas.height=Math.floor(i*a)),Object.assign(r.luma.canvasSizeInfo,{clientWidth:n,clientHeight:i,devicePixelRatio:t})}}function d5(){let r;if(typeof window<"u"&&window.performance)r=window.performance.now();else if(typeof process<"u"&&process.hrtime){const t=process.hrtime();r=t[0]*1e3+t[1]/1e6}else r=Date.now();return r}let f5=class{constructor(t,e){W(this,"name",void 0),W(this,"type",void 0),W(this,"sampleSize",1),W(this,"time",void 0),W(this,"count",void 0),W(this,"samples",void 0),W(this,"lastTiming",void 0),W(this,"lastSampleTime",void 0),W(this,"lastSampleCount",void 0),W(this,"_count",0),W(this,"_time",0),W(this,"_samples",0),W(this,"_startTime",0),W(this,"_timerPending",!1),this.name=t,this.type=e,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=d5(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(d5()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},Dv=class{constructor(t){W(this,"id",void 0),W(this,"stats",{}),this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach(e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}}),t}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(e=>this._getOrCreate(e))}_getOrCreate(t){if(!t||!t.name)return null;const{name:e,type:n}=t;return this.stats[e]||(t instanceof f5?this.stats[e]=t:this.stats[e]=new f5(e,n)),this.stats[e]}};const Gp="8.5.21",q7="set luma.log.level=1 (or higher) to trace rendering";class K7{constructor(){this.stats=new Map}get(t){return this.stats.has(t)||this.stats.set(t,new Dv({id:t})),this.stats.get(t)}}const Th=new K7;if(globalThis.luma&&globalThis.luma.VERSION!==Gp)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Gp));globalThis.luma||(xu()&&mr.log(1,"luma.gl ".concat(Gp," - ").concat(q7))(),globalThis.luma=globalThis.luma||{VERSION:Gp,version:Gp,log:mr,stats:Th,globals:{modules:{},nodeIO:{}}});function W7(r){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(r):setTimeout(r,1e3/60)}function $7(r){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(r):clearTimeout(r)}function or(r,t){if(!r)throw new Error(t||"luma.gl: assertion failed.")}function kv(r,t){if(typeof t!="string")return t;const e=Number(t);if(!isNaN(e))return e;t=t.replace(/^.*\./,"");const n=r[t];return or(n!==void 0,"Accessing undefined constant GL.".concat(t)),n}function BA(r,t){t=Number(t);for(const e in r)if(r[e]===t)return"GL.".concat(e);return String(t)}const Nv={};function Cu(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";Nv[r]=Nv[r]||1;const t=Nv[r]++;return"".concat(r,"-").concat(t)}function p5(r){return or(typeof r=="number","Input must be a number"),r&&(r&r-1)===0}function Nd(r){let t=!0;for(const e in r){t=!1;break}return t}function g5(r,t,e,n){const i="See luma.gl ".concat(e," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(r);n.forEach(a=>{s.methodName||(s[a]=()=>{throw mr.removed("Calling removed method ".concat(t,".").concat(a,": "),i)(),new Error(a)})})}const Qd="Resource subclass must define virtual methods";let Eu=class{get[Symbol.toStringTag](){return"Resource"}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s0(t);const{id:n,userData:i={}}=e;this.gl=t,this.gl2=t,this.id=n||Cu(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=e.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:t=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,e&&t&&e.filter(Boolean).forEach(n=>n.delete()),this}bind(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof t!="function")return this._bindHandle(t),this;let e;return this._bound?e=t():(this._bindHandle(this.handle),this._bound=!0,e=t(),this._bound=!1,this._bindHandle(null)),e}unbind(){this.bind(null)}getParameter(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t=kv(this.gl,t),or(t);const i=(this.constructor.PARAMETERS||{})[t];if(i){const s=pn(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const o=i.webgl1,A="webgl2"in i?i.webgl2:i.webgl1;return s?A:o}}return this._getParameter(t,e)}getParameters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:e,keys:n}=t,i=this.constructor.PARAMETERS||{},s=pn(this.gl),a={},o=e||Object.keys(i);for(const A of o){const f=i[A];if(f&&(!("webgl2"in f)||s)&&(!("extension"in f)||this.gl.getExtension(f.extension))){const b=n?BA(this.gl,A):A;a[b]=this.getParameter(A,t),n&&f.type==="GLenum"&&(a[b]=BA(this.gl,a[b]))}}return a}setParameter(t,e){t=kv(this.gl,t),or(t);const i=(this.constructor.PARAMETERS||{})[t];if(i){const s=pn(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(e=kv(e))}return this._setParameter(t,e),this}setParameters(t){for(const e in t)this.setParameter(e,t[e]);return this}stubRemovedMethods(t,e,n){return g5(this,t,e,n)}initialize(t){}_createHandle(){throw new Error(Qd)}_deleteHandle(){throw new Error(Qd)}_bindHandle(t){throw new Error(Qd)}_getOptsFromHandle(){throw new Error(Qd)}_getParameter(t,e){throw new Error(Qd)}_setParameter(t,e){throw new Error(Qd)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const t=this[Symbol.toStringTag],e=Th.get("Resource Counts");e.get("Resources Created").incrementCount(),e.get("".concat(t,"s Created")).incrementCount(),e.get("".concat(t,"s Active")).incrementCount()}_removeStats(){const t=this[Symbol.toStringTag];Th.get("Resource Counts").get("".concat(t,"s Active")).decrementCount()}_trackAllocatedMemory(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(t,e),this._trackAllocatedMemoryForContext(t,e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=t}_trackAllocatedMemoryForContext(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=Th.get("Memory Usage".concat(n));i.get("GPU Memory").addCount(t),i.get("".concat(e," Memory")).addCount(t)}_trackDeallocatedMemory(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(t),this._trackDeallocatedMemoryForContext(t,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=Th.get("Memory Usage".concat(e));n.get("GPU Memory").subtractCount(this.byteLength),n.get("".concat(t," Memory")).subtractCount(this.byteLength)}};const X7="Failed to deduce GL constant from typed array";function Qv(r){switch(ArrayBuffer.isView(r)?r.constructor:r){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(X7)}}function Vp(r){let{clamped:t=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(r){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return t?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Y7(r){let{data:t,width:e,height:n,bytesPerPixel:i=4,temp:s}=r;const a=e*i;s=s||new Uint8Array(a);for(let o=0;o<n/2;++o){const A=o*a,f=(n-o-1)*a;s.set(t.subarray(A,A+a)),t.copyWithin(A,f,f+a),t.set(s,f)}}function J7(r){let{data:t,width:e,height:n}=r;const i=Math.round(e/2),s=Math.round(n/2),a=new Uint8Array(i*s*4);for(let o=0;o<s;o++)for(let A=0;A<i;A++)for(let f=0;f<4;f++)a[(o*i+A)*4+f]=t[(o*2*e+A*2)*4+f];return{data:a,width:i,height:s}}function Hv(r,t,e){const{removedProps:n={},deprecatedProps:i={},replacedProps:s={}}=e;for(const o in n)if(o in t){const f=n[o]?"".concat(r,".").concat(n[o]):"N/A";mr.removed("".concat(r,".").concat(o),f)()}for(const o in i)if(o in t){const A=i[o];mr.deprecated("".concat(r,".").concat(o),"".concat(r,".").concat(A))()}let a=null;for(const o in s)if(o in t){const A=s[o];mr.deprecated("".concat(r,".").concat(o),"".concat(r,".").concat(A))(),a=a||Object.assign({},t),a[A]=t[o],delete a[o]}return a||t}const Z7={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},tH={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class oa{static getBytesPerElement(t){return Vp(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){return or(t.size),Vp(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new oa(Z7,...e)}constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return oa.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return oa.getBytesPerVertex(this)}_assign(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t=Hv("Accessor",t,tH),t.type!==void 0&&(this.type=t.type,(t.type===5124||t.type===5125)&&(this.integer=!0)),t.size!==void 0&&(this.size=t.size),t.offset!==void 0&&(this.offset=t.offset),t.stride!==void 0&&(this.stride=t.stride),t.normalized!==void 0&&(this.normalized=t.normalized),t.integer!==void 0&&(this.integer=t.integer),t.divisor!==void 0&&(this.divisor=t.divisor),t.buffer!==void 0&&(this.buffer=t.buffer),t.index!==void 0&&(typeof t.index=="boolean"?this.index=t.index?1:0:this.index=t.index),t.instanced!==void 0&&(this.divisor=t.instanced?1:0),t.isInstanced!==void 0&&(this.divisor=t.isInstanced?1:0),this}}const m5=10,y5={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},eH={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:y5},rH={removedProps:y5};class ei extends Eu{get[Symbol.toStringTag](){return"Buffer"}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t,e),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=e.target||(this.gl.webgl2?36662:34962),this.initialize(e),Object.seal(this)}getElementCount(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/oa.getBytesPerElement(t))}getVertexCount(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/oa.getBytesPerVertex(t))}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t=Hv("Buffer",t,eH),this.usage=t.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},t,t.accessor)),t.data?this._setData(t.data,t.offset,t.byteLength):this._setByteLength(t.byteLength||0),this}setProps(t){return t=Hv("Buffer",t,rH),"accessor"in t&&this.setAccessor(t.accessor),this}setAccessor(t){return t=Object.assign({},t),delete t.buffer,this.accessor=new oa(t),this}reallocate(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}setData(t){return this.initialize(t)}subData(t){ArrayBuffer.isView(t)&&(t={data:t});const{data:e,offset:n=0,srcOffset:i=0}=t,s=t.byteLength||t.length;or(e);const a=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(a,this.handle),i!==0||s!==void 0?(Mo(this.gl),this.gl.bufferSubData(this.target,n,e,i,s)):this.gl.bufferSubData(a,n,e),this.gl.bindBuffer(a,null),this.debugData=null,this._inferType(e),this}copyData(t){let{sourceBuffer:e,readOffset:n=0,writeOffset:i=0,size:s}=t;const{gl:a}=this;return Mo(a),a.bindBuffer(36662,e.handle),a.bindBuffer(36663,this.handle),a.copyBufferSubData(36662,36663,n,i,s),a.bindBuffer(36662,null),a.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:t=null,srcByteOffset:e=0,dstOffset:n=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Mo(this.gl);const s=Vp(this.accessor.type||5126,{clamped:!1}),a=this._getAvailableElementCount(e),o=n;let A,f;t?(f=t.length,A=f-o):(A=Math.min(a,i||a),f=o+A);const m=Math.min(a,A);return i=i||m,or(i<=m),t=t||new s(f),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,t,n,i),this.gl.bindBuffer(36662,null),t}bind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index,offset:n=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t===35345||t===35982?i!==void 0?this.gl.bindBufferRange(t,e,this.handle,n,i):(or(n===0),this.gl.bindBufferBase(t,e,this.handle)):this.gl.bindBuffer(t,this.handle),this}unbind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t===35345||t===35982?this.gl.bindBufferBase(t,e,null):this.gl.bindBuffer(t,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(m5,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.byteLength+e;or(ArrayBuffer.isView(t)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.usage),this.gl.bufferSubData(i,e,t),this.gl.bindBuffer(i,null),this.debugData=t.slice(0,m5),this.bytesUsed=n,this._trackAllocatedMemory(n);const s=Qv(t);return or(s),this.setAccessor(new oa(this.accessor,{type:s})),this}_setByteLength(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;or(t>=0),this._trackDeallocatedMemory();let n=t;t===0&&(n=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,e),this.gl.bindBuffer(i,null),this.usage=e,this.debugData=null,this.bytesUsed=t,this._trackAllocatedMemory(t),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(t){const e=Vp(this.accessor.type||5126,{clamped:!1}),n=t/e.BYTES_PER_ELEMENT;return this.getElementCount()-n}_inferType(t){this.accessor.type||this.setAccessor(new oa(this.accessor,{type:Qv(t)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(t){this.gl.bindBuffer(this.target,this.handle);const e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}get type(){return mr.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return mr.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(t){return mr.deprecated("setByteLength","reallocate")(),this.reallocate(t)}updateAccessor(t){return mr.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new oa(this.accessor,t),this}}const zv={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},_5={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},v5={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function nH(r,t){const e=zv[t];if(!e)return!1;if(e.gl1===void 0&&e.gl2===void 0)return!0;const n=pn(r)&&e.gl2||e.gl1;return typeof n=="string"?r.getExtension(n):n}function iH(r,t){const e=zv[t];switch(e&&e.types[0]){case 5126:return r.getExtension("OES_texture_float_linear");case 5131:return r.getExtension("OES_texture_half_float_linear");default:return!0}}const sH=[9729,9728],b5=globalThis.WebGLBuffer||function(){};class Hd extends Eu{get[Symbol.toStringTag](){return"Texture"}static isSupported(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:n,linearFiltering:i}=e;let s=!0;return n&&(s=s&&nH(t,n),s=s&&(!i||iH(t,n))),s}constructor(t,e){const{id:n=Cu("texture"),handle:i,target:s}=e;super(t,{id:n,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.data;if(e instanceof Promise)return e.then(q=>this.initialize(Object.assign({},t,{pixels:q,data:q}))),this;const n=typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement;if(n&&e.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,e.addEventListener("loadeddata",()=>this.initialize(t)),this;const{pixels:i=null,format:s=6408,border:a=0,recreate:o=!1,parameters:A={},pixelStore:f={},textureUnit:m=void 0}=t;e||(e=i);let{width:b,height:x,dataFormat:C,type:M,compressed:U=!1,mipmaps:N=!0}=t;const{depth:Q=0}=t;return{width:b,height:x,compressed:U,dataFormat:C,type:M}=this._deduceParameters({format:s,type:M,dataFormat:C,compressed:U,data:e,width:b,height:x}),this.width=b,this.height=x,this.depth=Q,this.format=s,this.type=M,this.dataFormat=C,this.border=a,this.textureUnit=m,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),N&&this._isNPOT()&&(mr.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),N=!1,this._updateForNPOT(A)),this.mipmaps=N,this.setImageData({data:e,width:b,height:x,depth:Q,format:s,type:M,dataFormat:C,border:a,mipmaps:N,parameters:f,compressed:U}),N&&this.generateMipmap(),this.setParameters(A),o&&(this.data=e),n&&(this._video={video:e,parameters:A,lastTime:e.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?e.currentTime:-1}),this}update(){if(this._video){const{video:t,parameters:e,lastTime:n}=this._video;if(n===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}resize(t){let{height:e,width:n,mipmaps:i=!1}=t;return n!==this.width||e!==this.height?this.initialize({width:n,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(mr.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Oc(this.gl,t,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(t){this._trackDeallocatedMemory("Texture");const{target:e=this.target,pixels:n=null,level:i=0,format:s=this.format,border:a=this.border,offset:o=0,parameters:A={}}=t;let{data:f=null,type:m=this.type,width:b=this.width,height:x=this.height,dataFormat:C=this.dataFormat,compressed:M=!1}=t;f||(f=n),{type:m,dataFormat:C,compressed:M,width:b,height:x}=this._deduceParameters({format:s,type:m,dataFormat:C,compressed:M,data:f,width:b,height:x});const{gl:U}=this;U.bindTexture(this.target,this.handle);let N=null;({data:f,dataType:N}=this._getDataType({data:f,compressed:M}));let Q,q=0;if(Oc(this.gl,A,()=>{switch(N){case"null":U.texImage2D(e,i,s,b,x,a,C,m,f);break;case"typed-array":U.texImage2D(e,i,s,b,x,a,C,m,f,o);break;case"buffer":Q=Mo(U),Q.bindBuffer(35052,f.handle||f),Q.texImage2D(e,i,s,b,x,a,C,m,o),Q.bindBuffer(35052,null);break;case"browser-object":pn(U)?U.texImage2D(e,i,s,b,x,a,C,m,f):U.texImage2D(e,i,s,C,m,f);break;case"compressed":for(const[Y,tt]of f.entries())U.compressedTexImage2D(e,Y,tt.format,tt.width,tt.height,a,tt.data),q+=tt.levelSize;break;default:or(!1,"Unknown image data type")}}),N==="compressed")this._trackAllocatedMemory(q,"Texture");else if(f&&f.byteLength)this._trackAllocatedMemory(f.byteLength,"Texture");else{const Y=_5[this.dataFormat]||4,tt=v5[this.type]||1;this._trackAllocatedMemory(this.width*this.height*Y*tt,"Texture")}return this.loaded=!0,this}setSubImageData(t){let{target:e=this.target,pixels:n=null,data:i=null,x:s=0,y:a=0,width:o=this.width,height:A=this.height,level:f=0,format:m=this.format,type:b=this.type,dataFormat:x=this.dataFormat,compressed:C=!1,offset:M=0,border:U=this.border,parameters:N={}}=t;if({type:b,dataFormat:x,compressed:C,width:o,height:A}=this._deduceParameters({format:m,type:b,dataFormat:x,compressed:C,data:i,width:o,height:A}),or(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=n),i&&i.data){const Q=i;i=Q.data,o=Q.shape[0],A=Q.shape[1]}i instanceof ei&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Oc(this.gl,N,()=>{if(C)this.gl.compressedTexSubImage2D(e,f,s,a,o,A,m,i);else if(i===null)this.gl.texSubImage2D(e,f,s,a,o,A,x,b,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(e,f,s,a,o,A,x,b,i,M);else if(i instanceof b5){const Q=Mo(this.gl);Q.bindBuffer(35052,i),Q.texSubImage2D(e,f,s,a,o,A,x,b,M),Q.bindBuffer(35052,null)}else pn(this.gl)?Mo(this.gl).texSubImage2D(e,f,s,a,o,A,x,b,i):this.gl.texSubImage2D(e,f,s,a,x,b,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return mr.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:e}=this;return t!==void 0&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:e}=this;return t!==void 0&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType(t){let{data:e,compressed:n=!1}=t;return n?{data:e,dataType:"compressed"}:e===null?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof ei?{data:e.handle,dataType:"buffer"}:e instanceof b5?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:n}=t;let{width:i,height:s,dataFormat:a,type:o,compressed:A}=t;const f=zv[e];return a=a||f&&f.dataFormat,o=o||f&&f.types[0],A=A||f&&f.compressed,{width:i,height:s}=this._deduceImageSize(n,i,s),{dataFormat:a,type:o,compressed:A,width:i,height:s,format:e,data:n}}_deduceImageSize(t,e,n){let i;return typeof ImageData<"u"&&t instanceof ImageData?i={width:t.width,height:t.height}:typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement?i={width:t.naturalWidth,height:t.naturalHeight}:typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement?i={width:t.width,height:t.height}:typeof ImageBitmap<"u"&&t instanceof ImageBitmap?i={width:t.width,height:t.height}:typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?i={width:t.videoWidth,height:t.videoHeight}:t?i={width:e,height:n}:i={width:e>=0?e:1,height:n>=0?n:1},or(i,"Could not deduced texture size"),or(e===void 0||i.width===e,"Deduced texture width does not match supplied width"),or(n===void 0||i.height===n,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}_setParameter(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:or(!1);break;default:this.gl.texParameteri(this.target,t,e);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return pn(this.gl)||!this.width||!this.height?!1:!p5(this.width)||!p5(this.height)}_updateForNPOT(t){t[this.gl.TEXTURE_MIN_FILTER]===void 0&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),t[this.gl.TEXTURE_WRAP_S]===void 0&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),t[this.gl.TEXTURE_WRAP_T]===void 0&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(t,e){if(this._isNPOT())switch(t){case 10241:sH.indexOf(e)===-1&&(e=9729);break;case 10242:case 10243:e!==33071&&(e=33071);break}return e}}let oH="";function aH(r,t){return or(typeof r=="string"),r=oH+r,new Promise((e,n)=>{try{const i=new Image;i.onload=()=>e(i),i.onerror=()=>n(new Error("Could not load image ".concat(r,"."))),i.crossOrigin=t&&t.crossOrigin||"anonymous",i.src=r}catch(i){n(i)}})}class Ta extends Hd{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(t,e){return Hd.isSupported(t,e)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s0(t),(e instanceof Promise||typeof e=="string")&&(e={data:e}),typeof e.data=="string"&&(e=Object.assign({},e,{data:aH(e.data)})),super(t,Object.assign({},e,{target:3553})),this.initialize(e),Object.seal(this)}}const Gv=[34069,34070,34071,34072,34073,34074];class w5 extends Hd{get[Symbol.toStringTag](){return"TextureCube"}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s0(t),super(t,Object.assign({},e,{target:34067})),this.initialize(e),Object.seal(this)}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:e=!0,parameters:n={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,e&&this.generateMipmap(t),this.setParameters(n)}),this}subImage(t){let{face:e,data:n,x:i=0,y:s=0,mipmapLevel:a=0}=t;return this._subImage({target:e,data:n,x:i,y:s,mipmapLevel:a})}async setCubeMapImageData(t){let{width:e,height:n,pixels:i,data:s,border:a=0,format:o=6408,type:A=5121}=t;const{gl:f}=this,m=i||s,b=await Promise.all(Gv.map(x=>{const C=m[x];return Promise.all(Array.isArray(C)?C:[C])}));this.bind(),Gv.forEach((x,C)=>{b[C].length>1&&this.opts.mipmaps!==!1&&mr.warn("".concat(this.id," has mipmap and multiple LODs."))(),b[C].forEach((M,U)=>{e&&n?f.texImage2D(x,U,o,e,n,a,o,A,M):f.texImage2D(x,U,o,o,A,M)})}),this.unbind()}setImageDataForFace(t){const{face:e,width:n,height:i,pixels:s,data:a,border:o=0,format:A=6408,type:f=5121}=t,{gl:m}=this,b=s||a;return this.bind(),b instanceof Promise?b.then(x=>this.setImageDataForFace(Object.assign({},t,{face:e,data:x,pixels:x}))):this.width||this.height?m.texImage2D(e,0,A,n,i,o,A,f,b):m.texImage2D(e,0,A,A,f,b),this}}w5.FACES=Gv;class cH extends Hd{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(t){return pn(t)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Mo(t),e=Object.assign({depth:1},e,{target:32879,unpackFlipY:!1}),super(t,e),this.initialize(e),Object.seal(this)}setImageData(t){let{level:e=0,dataFormat:n=6408,width:i,height:s,depth:a=1,border:o=0,format:A,type:f=5121,offset:m=0,data:b,parameters:x={}}=t;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Oc(this.gl,x,()=>{ArrayBuffer.isView(b)&&this.gl.texImage3D(this.target,e,n,i,s,a,o,A,f,b),b instanceof ei&&(this.gl.bindBuffer(35052,b.handle),this.gl.texImage3D(this.target,e,n,i,s,a,o,A,f,m))}),b&&b.byteLength)this._trackAllocatedMemory(b.byteLength,"Texture");else{const C=_5[this.dataFormat]||4,M=v5[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*C*M,"Texture")}return this.loaded=!0,this}}const Ih="EXT_color_buffer_float",x5={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Ih,bpp:2},33327:{gl2:Ih,bpp:4},34842:{gl2:Ih,bpp:8},33326:{gl2:Ih,bpp:4},33328:{gl2:Ih,bpp:8},34836:{gl2:Ih,bpp:16},35898:{gl2:Ih,bpp:4}};function lH(r,t,e){const n=e[t];if(!n)return!1;const i=pn(r)&&n.gl2||n.gl1;return typeof i=="string"?r.getExtension(i):i}class zd extends Eu{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(t){let{format:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!e||lH(t,e,x5)}static getSamplesForFormat(t,e){let{format:n}=e;return t.getInternalformatParameter(36161,n,32937)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t,e),this.initialize(e),Object.seal(this)}initialize(t){let{format:e,width:n=1,height:i=1,samples:s=0}=t;return or(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&pn(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,e,n,i):this.gl.renderbufferStorage(36161,e,n,i),this.format=e,this.width=n,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*x5[this.format].bpp),this}resize(t){let{width:e,height:n}=t;return e!==this.width||n!==this.height?this.initialize({width:e,height:n,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(t){this.gl.bindRenderbuffer(36161,t)}_syncHandle(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(t){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,t)}}const uH=256,AH=1024,hH=16384,B5=6144,C5=6145,E5=6146,S5=34041,T5="clear: bad arguments";function Vv(r){let{framebuffer:t=null,color:e=null,depth:n=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};t&&(s.framebuffer=t);let a=0;e&&(a|=hH,e!==!0&&(s.clearColor=e)),n&&(a|=uH,n!==!0&&(s.clearDepth=n)),i&&(a|=AH,n!==!0&&(s.clearStencil=n)),or(a!==0,T5),Oc(r,s,()=>{r.clear(a)})}function dH(r){let{framebuffer:t=null,buffer:e=B5,drawBuffer:n=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Mo(r),Oc(r,{framebuffer:t},()=>{switch(e){case B5:switch(i.constructor){case Int32Array:r.clearBufferiv(e,n,i);break;case Uint32Array:r.clearBufferuiv(e,n,i);break;case Float32Array:default:r.clearBufferfv(e,n,i)}break;case C5:r.clearBufferfv(C5,0,[i]);break;case E5:r.clearBufferiv(E5,0,[i]);break;case S5:const[s,a]=i;r.clearBufferfi(S5,0,s,a);break;default:or(!1,T5)}})}function fH(r){switch(r){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return or(!1),0}}function o0(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:e=0,sourceY:n=0,sourceFormat:i=6408}=t;let{sourceAttachment:s=36064,target:a=null,sourceWidth:o,sourceHeight:A,sourceType:f}=t;const{framebuffer:m,deleteFramebuffer:b}=pH(r);or(m);const{gl:x,handle:C,attachments:M}=m;o=o||m.width,A=A||m.height,s===36064&&C===null&&(s=1028),or(M[s]),f=f||M[s].type,a=gH(a,f,i,o,A),f=f||Qv(a);const U=x.bindFramebuffer(36160,C);return x.readPixels(e,n,o,A,i,f,a),x.bindFramebuffer(36160,U||null),b&&m.delete(),a}function I5(r){let{sourceAttachment:t=36064,targetMaxHeight:e=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=o0(r,{sourceAttachment:t}),{width:i,height:s}=r;for(;s>e;)({data:n,width:i,height:s}=J7({data:n,width:i,height:s}));Y7({data:n,width:i,height:s});const a=document.createElement("canvas");a.width=i,a.height=s;const o=a.getContext("2d"),A=o.createImageData(i,s);return A.data.set(n),o.putImageData(A,0,0),a.toDataURL()}function pH(r){return r instanceof vs?{framebuffer:r,deleteFramebuffer:!1}:{framebuffer:CH(r),deleteFramebuffer:!0}}function gH(r,t,e,n,i){if(r)return r;t=t||5121;const s=Vp(t,{clamped:!1}),a=fH(e);return new s(n*i*a)}const pi={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function mH(r){const t=new Ta(r,{format:6408,type:5126,dataFormat:6408}),e=new vs(r,{id:"test-framebuffer",check:!1,attachments:{36064:t}}),n=e.getStatus();return t.delete(),e.delete(),n===36053}const L5={[pi.WEBGL2]:[!1,!0],[pi.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[pi.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[pi.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[pi.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[pi.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[pi.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[pi.FLOAT_BLEND]:["EXT_float_blend"],[pi.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[pi.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[pi.TEXTURE_FLOAT]:["OES_texture_float",!0],[pi.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[pi.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[pi.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[pi.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[pi.COLOR_ATTACHMENT_RGBA32F]:[mH,"EXT_color_buffer_float"],[pi.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[pi.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[pi.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[pi.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[pi.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[pi.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},yH=2;function jv(r,t){return F5(r,t)}function F5(r,t){return t=Array.isArray(t)?t:[t],t.every(e=>M5(r,e))}function _H(r){r.luma=r.luma||{},r.luma.caps=r.luma.caps||{};for(const t in L5)r.luma.caps[t]===void 0&&(r.luma.caps[t]=M5(r,t));return r.luma.caps}function M5(r,t){return r.luma=r.luma||{},r.luma.caps=r.luma.caps||{},r.luma.caps[t]===void 0&&(r.luma.caps[t]=vH(r,t)),r.luma.caps[t]||mr.log(yH,"Feature: ".concat(t," not supported"))(),r.luma.caps[t]}function vH(r,t){const e=L5[t];or(e,t);let n;const i=pn(r)&&e[1]||e[0];if(typeof i=="function")n=i(r);else if(Array.isArray(i)){n=!0;for(const s of i)n=n&&!!r.getExtension(s)}else typeof i=="string"?n=!!r.getExtension(i):typeof i=="boolean"?n=i:or(!1);return n}const P5="Multiple render targets not supported";class vs extends Eu{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:n,colorBufferHalfFloat:i}=e;let s=!0;return n&&(s=!!(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")||t.getExtension("OES_texture_float"))),i&&(s=s&&!!(t.getExtension("EXT_color_buffer_float")||t.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new vs(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const t=Mo(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const t=Mo(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t,e),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(e),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(t){let{width:e=1,height:n=1,attachments:i=null,color:s=!0,depth:a=!0,stencil:o=!1,check:A=!0,readBuffer:f=void 0,drawBuffers:m=void 0}=t;if(or(e>=0&&n>=0,"Width and height need to be integers"),this.width=e,this.height=n,i)for(const b in i){const x=i[b];(Array.isArray(x)?x[0]:x).resize({width:e,height:n})}else i=this._createDefaultAttachments(s,a,o,e,n);this.update({clearAttachments:!0,attachments:i,readBuffer:f,drawBuffers:m}),i&&A&&this.checkStatus()}delete(){for(const t of this.ownResources)t.delete();return super.delete(),this}update(t){let{attachments:e={},readBuffer:n,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:a=!0}=t;this.attach(e,{clearAttachments:s,resizeAttachments:a});const{gl:o}=this,A=o.bindFramebuffer(36160,this.handle);return n&&this._setReadBuffer(n),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,A||null),this}resize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:e,height:n}=t;if(this.handle===null)return or(e===void 0&&n===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;e===void 0&&(e=this.gl.drawingBufferWidth),n===void 0&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&mr.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(e,"x").concat(n))();for(const i in this.attachments)this.attachments[i].resize({width:e,height:n});return this.width=e,this.height=n,this}attach(t){let{clearAttachments:e=!1,resizeAttachments:n=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};e&&Object.keys(this.attachments).forEach(a=>{i[a]=null}),Object.assign(i,t);const s=this.gl.bindFramebuffer(36160,this.handle);for(const a in i){or(a!==void 0,"Misspelled framebuffer binding point?");const o=Number(a),A=i[o];let f=A;if(!f)this._unattach(o);else if(f instanceof zd)this._attachRenderbuffer({attachment:o,renderbuffer:f});else if(Array.isArray(A)){const[m,b=0,x=0]=A;f=m,this._attachTexture({attachment:o,texture:m,layer:b,level:x})}else this._attachTexture({attachment:o,texture:f,layer:0,level:0});n&&f&&f.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter(a=>!this.attachments[a]).forEach(a=>{delete this.attachments[a]})}checkStatus(){const t=this.getStatus();if(t!==36053)throw new Error(wH(t));return this}getStatus(){const{gl:t}=this,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);return t.bindFramebuffer(36160,e||null),n}clear(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:e,depth:n,stencil:i,drawBuffers:s=[]}=t,a=this.gl.bindFramebuffer(36160,this.handle);return(e||n||i)&&Vv(this.gl,{color:e,depth:n,stencil:i}),s.forEach((o,A)=>{dH(this.gl,{drawBuffer:A,value:o})}),this.gl.bindFramebuffer(36160,a||null),this}readPixels(){return mr.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return mr.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return mr.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return mr.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return mr.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return mr.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(t){let{attachments:e=[],x:n=0,y:i=0,width:s,height:a}=t;const o=Mo(this.gl),A=o.bindFramebuffer(36008,this.handle);return n===0&&i===0&&s===void 0&&a===void 0?o.invalidateFramebuffer(36008,e):o.invalidateFramebuffer(36008,e,n,i,s,a),o.bindFramebuffer(36008,A),this}getAttachmentParameter(t,e,n){let i=this._getAttachmentParameterFallback(e);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&i>1e3&&(i=BA(this.gl,i)),i}getAttachmentParameters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of n){const a=e?BA(this.gl,s):s;i[a]=this.getAttachmentParameter(t,s,e)}return i}getParameters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const e=Object.keys(this.attachments),n={};for(const i of e){const s=Number(i),a=t?BA(this.gl,s):s;n[a]=this.getAttachmentParameters(s,t)}return n}show(){return typeof window<"u"&&window.open(I5(this),"luma-debug-texture"),this}log(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(t>mr.level||typeof window>"u")return this;e=e||"Framebuffer ".concat(this.id);const n=I5(this,{targetMaxHeight:100});return mr.image({logLevel:t,message:e,image:n},e)(),this}bind(){let{target:t=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(t,this.handle),this}unbind(){let{target:t=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(t,null),this}_createDefaultAttachments(t,e,n,i,s){let a=null;return t&&(a=a||{},a[36064]=new Ta(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(a[36064])),e&&n?(a=a||{},a[33306]=new zd(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(a[33306])):e?(a=a||{},a[36096]=new zd(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(a[36096])):n&&or(!1),a}_unattach(t){const e=this.attachments[t];e&&(e instanceof zd?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}_attachRenderbuffer(t){let{attachment:e=36064,renderbuffer:n}=t;const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,n.handle),this.attachments[e]=n}_attachTexture(t){let{attachment:e=36064,texture:n,layer:i,level:s}=t;const{gl:a}=this;switch(a.bindTexture(n.target,n.handle),n.target){case 35866:case 32879:Mo(a).framebufferTextureLayer(36160,e,n.target,s,i);break;case 34067:const A=bH(i);a.framebufferTexture2D(36160,e,A,n.handle,s);break;case 3553:a.framebufferTexture2D(36160,e,3553,n.handle,s);break;default:or(!1,"Illegal texture type")}a.bindTexture(n.target,null),this.attachments[e]=n}_setReadBuffer(t){const e=YQ(this.gl);e?e.readBuffer(t):or(t===36064||t===1029,P5),this.readBuffer=t}_setDrawBuffers(t){const{gl:e}=this,n=Mo(e);if(n)n.drawBuffers(t);else{const i=e.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(t):or(t.length===1&&(t[0]===36064||t[0]===1029),P5)}this.drawBuffers=t}_getAttachmentParameterFallback(t){const e=_H(this.gl);switch(t){case 36052:return e.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.WEBGL2?null:8;case 33297:return e.WEBGL2?null:5125;case 33296:return!e.WEBGL2&&!e.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(t){return this.gl.bindFramebuffer(36160,t)}}function bH(r){return r<34069?r+34069:r}function wH(r){return(vs.STATUS||{})[r]||"Framebuffer error ".concat(r)}const xH=[36049,36048,33296,33298,33299,33300,33301,33302,33303];vs.ATTACHMENT_PARAMETERS=xH;function BH(r,t){or(r instanceof Ta||r instanceof w5||r instanceof cH);const e=r.constructor,{gl:n,width:i,height:s,format:a,type:o,dataFormat:A,border:f,mipmaps:m}=r,b=Object.assign({width:i,height:s,format:a,type:o,dataFormat:A,border:f,mipmaps:m},t);return new e(n,b)}function CH(r,t){const{gl:e,width:n,height:i,id:s}=r;return new vs(e,Object.assign({},t,{id:"framebuffer-for-".concat(s),width:n,height:i,attachments:{36064:r}}))}function a0(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const e=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,n=r.match(e);return n?n[1]:t}const EH=35632,SH=35633;function TH(r){switch(r){case EH:return"fragment";case SH:return"vertex";default:return"unknown type"}}function IH(r,t,e,n){const i=r.split(/\r?\n/),s={},a={},o=n||a0(t)||"(unnamed)",A="".concat(TH(e)," shader ").concat(o);for(let m=0;m<i.length;m++){const b=i[m];if(b.length<=1)continue;const x=b.split(":"),C=x[0],M=parseInt(x[2],10);if(isNaN(M))throw new Error("GLSL compilation error in ".concat(A,": ").concat(r));C!=="WARNING"?s[M]=b:a[M]=b}const f=LH(t);return{shaderName:A,errors:U5(s,f),warnings:U5(a,f)}}function U5(r,t){let e="";for(let n=0;n<t.length;n++){const i=t[n];if(!(!r[n+3]&&!r[n+2]&&!r[n+1])&&(e+="".concat(i,`
`),r[n+1])){const s=r[n+1],a=s.split(":",3),o=a[0],A=parseInt(a[1],10)||0,f=s.substring(a.join(":").length+1).trim();e+=R5("^^^ ".concat(o,": ").concat(f,`

`),A)}}return e}function LH(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const n=r.split(/\r?\n/),i=String(n.length+t-1).length;return n.map((s,a)=>{const o=String(a+t),A=o.length;return R5(o,i-A)+e+s})}function R5(r,t){let e="";for(let n=0;n<t;++n)e+=" ";return"".concat(e).concat(r)}function O5(r){let t=100;const e=r.match(/[^\s]+/g);if(e.length>=2&&e[0]==="#version"){const n=parseInt(e[1],10);Number.isFinite(n)&&(t=n)}return t}const FH="Shader: GLSL source code must be a JavaScript string";class jp extends Eu{get[Symbol.toStringTag](){return"Shader"}static getTypeName(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return or(!1),"unknown"}}constructor(t,e){s0(t),or(typeof e.source=="string",FH);const n=a0(e.source,null)||e.id||Cu("unnamed ".concat(jp.getTypeName(e.shaderType)));super(t,{id:n}),this.shaderType=e.shaderType,this.source=e.source,this.initialize(e)}initialize(t){let{source:e}=t;const n=a0(e,null);n&&(this.id=Cu(n)),this._compile(e)}getParameter(t){return this.gl.getShaderParameter(this.handle,t)}toString(){return"".concat(jp.getTypeName(this.shaderType),":").concat(this.id)}getName(){return a0(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(t.startsWith("#version ")||(t=`#version 100
`.concat(t)),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const n=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:a}=IH(n,this.source,this.shaderType,this.id);throw mr.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),mr.warn("GLSL compilation warnings in ".concat(i,`
`).concat(a))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class qv extends jp{get[Symbol.toStringTag](){return"VertexShader"}constructor(t,e){typeof e=="string"&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class Kv extends jp{get[Symbol.toStringTag](){return"FragmentShader"}constructor(t,e){typeof e=="string"&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const MH={5126:_i.bind(null,"uniform1fv",Ia,1,ao),35664:_i.bind(null,"uniform2fv",Ia,2,ao),35665:_i.bind(null,"uniform3fv",Ia,3,ao),35666:_i.bind(null,"uniform4fv",Ia,4,ao),5124:_i.bind(null,"uniform1iv",CA,1,ao),35667:_i.bind(null,"uniform2iv",CA,2,ao),35668:_i.bind(null,"uniform3iv",CA,3,ao),35669:_i.bind(null,"uniform4iv",CA,4,ao),35670:_i.bind(null,"uniform1iv",CA,1,ao),35671:_i.bind(null,"uniform2iv",CA,2,ao),35672:_i.bind(null,"uniform3iv",CA,3,ao),35673:_i.bind(null,"uniform4iv",CA,4,ao),35674:_i.bind(null,"uniformMatrix2fv",Ia,4,Su),35675:_i.bind(null,"uniformMatrix3fv",Ia,9,Su),35676:_i.bind(null,"uniformMatrix4fv",Ia,16,Su),35678:js,35680:js,5125:_i.bind(null,"uniform1uiv",c0,1,ao),36294:_i.bind(null,"uniform2uiv",c0,2,ao),36295:_i.bind(null,"uniform3uiv",c0,3,ao),36296:_i.bind(null,"uniform4uiv",c0,4,ao),35685:_i.bind(null,"uniformMatrix2x3fv",Ia,6,Su),35686:_i.bind(null,"uniformMatrix2x4fv",Ia,8,Su),35687:_i.bind(null,"uniformMatrix3x2fv",Ia,6,Su),35688:_i.bind(null,"uniformMatrix3x4fv",Ia,12,Su),35689:_i.bind(null,"uniformMatrix4x2fv",Ia,8,Su),35690:_i.bind(null,"uniformMatrix4x3fv",Ia,12,Su),35678:js,35680:js,35679:js,35682:js,36289:js,36292:js,36293:js,36298:js,36299:js,36300:js,36303:js,36306:js,36307:js,36308:js,36311:js},PH={},UH={},RH={},D5=[0];function Wv(r,t,e,n){t===1&&typeof r=="boolean"&&(r=r?1:0),Number.isFinite(r)&&(D5[0]=r,r=D5);const i=r.length;if(i%t&&mr.warn("Uniform size should be multiples of ".concat(t),r)(),r instanceof e)return r;let s=n[i];s||(s=new e(i),n[i]=s);for(let a=0;a<i;a++)s[a]=r[a];return s}function Ia(r,t){return Wv(r,t,Float32Array,PH)}function CA(r,t){return Wv(r,t,Int32Array,UH)}function c0(r,t){return Wv(r,t,Uint32Array,RH)}function k5(r,t,e){const n=MH[e.type];if(!n)throw new Error("Unknown GLSL uniform type ".concat(e.type));return n().bind(null,r,t)}function OH(r){if(r[r.length-1]!=="]")return{name:r,length:1,isArray:!1};const t=/([^[]*)(\[[0-9]+\])?/,e=r.match(t);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(r));return{name:e[1],length:e[2]||1,isArray:!!e[2]}}function DH(r,t,e){for(const n in r){const i=r[n];if((!e||!!e[n])&&!kH(i))throw t=t?"".concat(t," "):"",console.error("".concat(t," Bad uniform ").concat(n),i),new Error("".concat(t," Bad uniform ").concat(n))}return!0}function kH(r){return Array.isArray(r)||ArrayBuffer.isView(r)?QH(r):isFinite(r)||r===!0||r===!1||r instanceof Hd||r instanceof zd?!0:r instanceof vs?!!r.texture:!1}function NH(r,t,e){if(Array.isArray(e)||ArrayBuffer.isView(e))if(r[t]){const n=r[t];for(let i=0,s=e.length;i<s;++i)n[i]=e[i]}else r[t]=e.slice();else r[t]=e}function QH(r){if(r.length===0)return!1;const t=Math.min(r.length,16);for(let e=0;e<t;++e)if(!Number.isFinite(r[e]))return!1;return!0}function js(){let r=null;return(t,e,n)=>{const i=r!==n;return i&&(t.uniform1i(e,n),r=n),i}}function _i(r,t,e,n){let i=null,s=null;return(a,o,A)=>{const f=t(A,e),m=f.length;let b=!1;if(i===null)i=new Float32Array(m),s=m,b=!0;else{or(s===m,"Uniform length cannot change.");for(let x=0;x<m;++x)if(f[x]!==i[x]){b=!0;break}}return b&&(n(a,r,o,f),i.set(f)),b}}function ao(r,t,e,n){r[t](e,n)}function Su(r,t,e,n){r[t](e,!1,n)}const HH=5120,zH=5121,GH=5122,VH=5123,N5=0,l0=1,jH=2,qH=3,u0=4,KH=5,WH=6,bs=5126,$H=35664,XH=35665,YH=35666,qp=5124,JH=35667,ZH=35668,tz=35669,Kp=5125,ez=36294,rz=36295,nz=36296,iz=35670,sz=35671,oz=35672,az=35673,cz=35674,lz=35675,uz=35676,Az=35685,hz=35686,dz=35687,fz=35688,pz=35689,gz=35690,$v={[bs]:[bs,1,"float"],[$H]:[bs,2,"vec2"],[XH]:[bs,3,"vec3"],[YH]:[bs,4,"vec4"],[qp]:[qp,1,"int"],[JH]:[qp,2,"ivec2"],[ZH]:[qp,3,"ivec3"],[tz]:[qp,4,"ivec4"],[Kp]:[Kp,1,"uint"],[ez]:[Kp,2,"uvec2"],[rz]:[Kp,3,"uvec3"],[nz]:[Kp,4,"uvec4"],[iz]:[bs,1,"bool"],[sz]:[bs,2,"bvec2"],[oz]:[bs,3,"bvec3"],[az]:[bs,4,"bvec4"],[cz]:[bs,8,"mat2"],[Az]:[bs,8,"mat2x3"],[hz]:[bs,8,"mat2x4"],[lz]:[bs,12,"mat3"],[dz]:[bs,12,"mat3x2"],[fz]:[bs,12,"mat3x4"],[uz]:[bs,16,"mat4"],[pz]:[bs,16,"mat4x2"],[gz]:[bs,16,"mat4x3"]};function mz(r){switch(r){case N5:return N5;case l0:return l0;case qH:return l0;case jH:return l0;case u0:return u0;case KH:return u0;case WH:return u0;default:return or(!1),0}}function Q5(r){const t=$v[r];if(!t)return null;const[e,n]=t;return{type:e,components:n}}function H5(r,t){switch(r){case HH:case zH:case GH:case VH:r=bs;break}for(const e in $v){const[n,i,s]=$v[e];if(n===r&&i===t)return{glType:e,name:s}}return null}class yz{constructor(t){this.id=t.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(t),this._readVaryingsFromProgram(t)}getAttributeInfo(t){const e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}getAttributeLocation(t){const e=this.getAttributeInfo(t);return e?e.location:-1}getAttributeAccessor(t){const e=this.getAttributeInfo(t);return e?e.accessor:null}getVaryingInfo(t){const e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}getVaryingIndex(t){const e=this.getVaryingInfo();return e?e.location:-1}getVaryingAccessor(t){const e=this.getVaryingInfo();return e?e.accessor:null}_readAttributesFromProgram(t){const{gl:e}=t,n=e.getProgramParameter(t.handle,35721);for(let i=0;i<n;i++){const{name:s,type:a,size:o}=e.getActiveAttrib(t.handle,i),A=e.getAttribLocation(t.handle,s);A>=0&&this._addAttribute(A,s,a,o)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(t){const{gl:e}=t;if(!pn(e))return;const n=e.getProgramParameter(t.handle,35971);for(let i=0;i<n;i++){const{name:s,type:a,size:o}=e.getTransformFeedbackVarying(t.handle,i);this._addVarying(i,s,a,o)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(t,e,n,i){const{type:s,components:a}=Q5(n),o={type:s,size:i*a};this._inferProperties(t,e,o);const A={location:t,name:e,accessor:new oa(o)};this.attributeInfos.push(A),this.attributeInfosByLocation[t]=A,this.attributeInfosByName[A.name]=A}_inferProperties(t,e,n){/instance/i.test(e)&&(n.divisor=1)}_addVarying(t,e,n,i){const{type:s,components:a}=Q5(n),o=new oa({type:s,size:i*a}),A={location:t,name:e,accessor:o};this.varyingInfos.push(A),this.varyingInfosByName[A.name]=A}}const z5=4,_z=35981,vz=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class G5 extends Eu{get[Symbol.toStringTag](){return"Program"}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t,e),this.stubRemovedMethods("Program","v6.0",vz),this._isCached=!1,this.initialize(e),Object.seal(this),this._setId(e.id)}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:e,vs:n,fs:i,varyings:s,bufferMode:a=_z}=t;return this.hash=e||"",this.vs=typeof n=="string"?new qv(this.gl,{id:"".concat(t.id,"-vs"),source:n}):n,this.fs=typeof i=="string"?new Kv(this.gl,{id:"".concat(t.id,"-fs"),source:i}):i,or(this.vs instanceof qv),or(this.fs instanceof Kv),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Mo(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,a)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new yz(this),this.setProps(t)}delete(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(t)}setProps(t){return"uniforms"in t&&this.setUniforms(t.uniforms),this}draw(t){let{logPriority:e,drawMode:n=4,vertexCount:i,offset:s=0,start:a,end:o,isIndexed:A=!1,indexType:f=5123,instanceCount:m=0,isInstanced:b=m>0,vertexArray:x=null,transformFeedback:C,framebuffer:M,parameters:U={},uniforms:N,samplers:Q}=t;if((N||Q)&&(mr.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(N||{})),mr.priority>=e){const q=M?M.id:"default",Y="mode=".concat(BA(this.gl,n)," verts=").concat(i," ")+"instances=".concat(m," indexType=").concat(BA(this.gl,f)," ")+"isInstanced=".concat(b," isIndexed=").concat(A," ")+"Framebuffer=".concat(q);mr.log(e,Y)()}return or(x),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||b&&m===0?!1:(x.bindForDraw(i,m,()=>{if(M!==void 0&&(U=Object.assign({},U,{framebuffer:M})),C){const q=mz(n);C.begin(q)}this._bindTextures(),Oc(this.gl,U,()=>{A&&b?this.gl2.drawElementsInstanced(n,i,f,s,m):A&&pn(this.gl)&&!isNaN(a)&&!isNaN(o)?this.gl2.drawRangeElements(n,a,o,i,f,s):A?this.gl.drawElements(n,i,f,s):b?this.gl2.drawArraysInstanced(n,s,i,m):this.gl.drawArrays(n,s,i)}),C&&C.end()}),!0)}setUniforms(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};mr.priority>=2&&DH(t,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const e in t){const n=t[e],i=this._uniformSetters[e];if(i){let s=n,a=!1;if(s instanceof vs&&(s=s.texture),s instanceof Hd)if(a=this.uniforms[e]!==n,a){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const o=s,{textureIndex:A}=i;o.bind(A),s=A,this._textureUniforms[e]=o}else s=i.textureIndex;else this._textureUniforms[e]&&delete this._textureUniforms[e];(i(s)||a)&&NH(this.uniforms,e,n)}}return this}_areTexturesRenderable(){let t=!0;for(const e in this._textureUniforms){const n=this._textureUniforms[e];n.update(),t=t&&n.loaded}return t}_bindTextures(){for(const t in this._textureUniforms){const e=this._uniformSetters[t].textureIndex;this._textureUniforms[t].bind(e)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(t){const e=this.gl.getAttachedShaders(t),n={};for(const i of e)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new qv({handle:i});break;case 35632:n.fs=new Kv({handle:i});break}return n}_getParameter(t){return this.gl.getProgramParameter(this.handle,t)}_setId(t){if(!t){const e=this._getName();this.id=Cu(e)}}_getName(){let t=this.vs.getName()||this.fs.getName();return t=t.replace(/shader/i,""),t=t?"".concat(t,"-program"):"program",t}_compileAndLink(){const{gl:t}=this;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),mr.time(z5,"linkProgram for ".concat(this._getName()))(),t.linkProgram(this.handle),mr.timeEnd(z5,"linkProgram for ".concat(this._getName()))(),t.debug||mr.level>0){if(!t.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(t.getProgramInfoLog(this.handle)));if(t.validateProgram(this.handle),!t.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(t.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:t}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let e=0;e<this._uniformCount;e++){const n=this.gl.getActiveUniform(this.handle,e),{name:i}=OH(n.name);let s=t.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=k5(t,s,n),n.size>1)for(let a=0;a<n.size;a++)s=t.getUniformLocation(this.handle,"".concat(i,"[").concat(a,"]")),this._uniformSetters["".concat(i,"[").concat(a,"]")]=k5(t,s,n)}this._textureIndexCounter=0}getActiveUniforms(t,e){return this.gl2.getActiveUniforms(this.handle,t,e)}getUniformBlockIndex(t){return this.gl2.getUniformBlockIndex(this.handle,t)}getActiveUniformBlockParameter(t,e){return this.gl2.getActiveUniformBlockParameter(this.handle,t,e)}uniformBlockBinding(t,e){this.gl2.uniformBlockBinding(this.handle,t,e)}}const bz=34918,wz=34919,xz=35007,Bz=36795,Cz=35976,Ez=35887,Sz=36202;class A0 extends Eu{get[Symbol.toStringTag](){return"Query"}static isSupported(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=pn(t),i=F5(t,pi.TIMER_QUERY);let s=n||i;for(const a of e)switch(a){case"queries":s=s&&n;break;case"timers":s=s&&i;break;default:or(!1)}return s}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t,e),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(xz)}beginOcclusionQuery(){let{conservative:t=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(t?Sz:Ez)}beginTransformFeedbackQuery(){return this.begin(Cz)}begin(t){return this._queryPending?this:(this.target=t,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const t=this.gl2.getQueryParameter(this.handle,wz);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.gl2.getParameter(Bz)}getResult(){return this.gl2.getQueryParameter(this.handle,bz)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let e=0;return this._pollingPromise=new Promise((n,i)=>{const s=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):e++>t?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return A0.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class V5 extends Eu{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(t){return pn(t)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Mo(t),super(t,e),this.initialize(e),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Nd(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(t),this}setProps(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}setBuffers(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const e in t)this.setBuffer(e,t[e])}),this}setBuffer(t,e){const n=this._getVaryingIndex(t),{buffer:i,byteSize:s,byteOffset:a}=this._getBufferParams(e);return n<0?(this.unused[t]=i,mr.warn("".concat(this.id," unused varying buffer ").concat(t))(),this):(this.buffers[n]=e,this.bindOnUse||this._bindBuffer(n,i,a,s),this)}begin(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(t){let e,n,i;return t instanceof ei?i=t:(i=t.buffer,n=t.byteSize,e=t.byteOffset),(e!==void 0||n!==void 0)&&(e=e||0,n=n||i.byteLength-e),{buffer:i,byteOffset:e,byteSize:n}}_getVaryingInfo(t){return this.configuration&&this.configuration.getVaryingInfo(t)}_getVaryingIndex(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;const e=Number(t);return Number.isFinite(e)?e:-1}_bindBuffers(){if(this.bindOnUse)for(const t in this.buffers){const{buffer:e,byteSize:n,byteOffset:i}=this._getBufferParams(this.buffers[t]);this._bindBuffer(t,e,i,n)}}_unbindBuffers(){if(this.bindOnUse)for(const t in this.buffers)this._bindBuffer(t,null)}_bindBuffer(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=e&&e.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,t,s):this.gl.bindBufferRange(35982,t,s,n,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(t){this.gl.bindTransformFeedback(36386,this.handle)}}let h0=null;function Tz(r){return(!h0||h0.byteLength<r)&&(h0=new ArrayBuffer(r)),h0}function Iz(r,t){const e=Tz(r.BYTES_PER_ELEMENT*t);return new r(e,0,t)}function Lz(r){let{target:t,source:e,start:n=0,count:i=1}=r;const s=e.length,a=i*s;let o=0;for(let A=n;o<s;o++)t[A++]=e[o];for(;o<a;)o<a-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+a-o),o=a);return t}const Fz="elements must be GL.ELEMENT_ARRAY_BUFFER";class La extends Eu{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(t){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?pn(t)||VS()==="Chrome":!0}static getDefaultArray(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new La(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}static getMaxAttributes(t){return La.MAX_ATTRIBUTES=La.MAX_ATTRIBUTES||t.getParameter(34921),La.MAX_ATTRIBUTES}static setConstant(t,e,n){switch(n.constructor){case Float32Array:La._setConstantFloatArray(t,e,n);break;case Int32Array:La._setConstantIntArray(t,e,n);break;case Uint32Array:La._setConstantUintArray(t,e,n);break;default:or(!1)}}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e.id||e.program&&e.program.id;super(t,Object.assign({},e,{id:n})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=e.isDefaultArray||!1,this.gl2=t,this.initialize(e),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return La.getMaxAttributes(this.gl)}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(t)}setProps(t){return this}setElementBuffer(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return or(!t||t.target===34963,Fz),this.bind(()=>{this.gl.bindBuffer(34963,t?t.handle:null)}),this}setBuffer(t,e,n){if(e.target===34963)return this.setElementBuffer(e,n);const{size:i,type:s,stride:a,offset:o,normalized:A,integer:f,divisor:m}=n,{gl:b,gl2:x}=this;return t=Number(t),this.bind(()=>{b.bindBuffer(34962,e.handle),f?(or(pn(b)),x.vertexAttribIPointer(t,i,s,a,o)):b.vertexAttribPointer(t,i,s,A,a,o),b.enableVertexAttribArray(t),x.vertexAttribDivisor(t,m||0)}),this}enable(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!e&&t===0&&!La.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind(()=>e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t))),this}getConstantBuffer(t,e){const n=this._normalizeConstantArrayValue(e),i=n.byteLength*t,s=n.length*t;let a=!this.buffer;if(this.buffer=this.buffer||new ei(this.gl,i),a=a||this.buffer.reallocate(i),a=a||!this._compareConstantArrayValues(n,this.bufferValue),a){const o=Iz(e.constructor,s);Lz({target:o,source:n,start:0,count:s}),this.buffer.subData(o),this.bufferValue=e}return this.buffer}_normalizeConstantArrayValue(t){return Array.isArray(t)?new Float32Array(t):t}_compareConstantArrayValues(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}static _setConstantFloatArray(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:or(!1)}}static _setConstantIntArray(t,e,n){switch(or(pn(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:or(!1)}}static _setConstantUintArray(t,e,n){switch(or(pn(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:or(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(t){return this.gl2.deleteVertexArray(t),[this.elements]}_bindHandle(t){this.gl2.bindVertexArray(t)}_getParameter(t,e){let{location:n}=e;return or(Number.isFinite(n)),this.bind(()=>{switch(t){case 34373:return this.gl.getVertexAttribOffset(n,t);default:return this.gl.getVertexAttrib(n,t)}})}}const Mz="VertexArray: attributes must be Buffers or constants (i.e. typed array)",Pz=/^(.+)__LOCATION_([0-9]+)$/,Uz=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Rz{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e.id||e.program&&e.program.id;this.id=n,this.gl=t,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new La(t),g5(this,"VertexArray","v6.0",Uz),this.initialize(e),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:t}=this.vertexArrayObject;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}setProps(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(t){return Object.assign(this.attributes,t),this.vertexArrayObject.bind(()=>{for(const e in t){const n=t[e];this._setAttribute(e,n)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}setBuffer(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e.target===34963)return this.setElementBuffer(e,n);const{location:i,accessor:s}=this._resolveLocationAndAccessor(t,e,e.accessor,n);return i>=0&&(this.values[i]=e,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,e,s)),this}setConstant(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},n));return i>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[i]=e,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ei(this.gl,{accessor:{size:4}});for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this.values[t]instanceof ei&&(this.gl.disableVertexAttribArray(t),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(t,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++){const e=this.values[t];e instanceof ei&&this.setBuffer(t,e)}}),this}bindForDraw(t,e,n){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(t,e),i=n()}),i}_resolveLocationAndAccessor(t,e,n,i){const s={location:-1,accessor:null},{location:a,name:o}=this._getAttributeIndex(t);if(!Number.isFinite(a)||a<0)return this.unused[t]=e,mr.once(3,()=>"unused value ".concat(t," in ").concat(this.id))(),s;const A=this._getAttributeInfo(o||a);if(!A)return s;const f=this.accessors[a]||{},m=oa.resolve(A.accessor,f,n,i),{size:b,type:x}=m;return or(Number.isFinite(b)&&Number.isFinite(x)),{location:a,accessor:m}}_getAttributeInfo(t){return this.configuration&&this.configuration.getAttributeInfo(t)}_getAttributeIndex(t){const e=Number(t);if(Number.isFinite(e))return{location:e};const n=Pz.exec(t),i=n?n[1]:t,s=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(t,e){if(e instanceof ei)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof ei){const n=e[0],i=e[1];this.setBuffer(t,n,i)}else if(ArrayBuffer.isView(e)||Array.isArray(e)){const n=e;this.setConstant(t,n)}else if(e.buffer instanceof ei){const n=e;this.setBuffer(t,n.buffer,n)}else throw new Error(Mz)}_setConstantAttributes(t,e){const n=Math.max(t|0,e|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,n);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(t,e){if(La.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,t);return}const n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(t,e){La.setConstant(this.gl,t,e)}_updateDrawParams(){const t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}_updateDrawParamsForLocation(t,e){const n=this.values[e],i=this.accessors[e];if(!n)return;const{divisor:s}=i,a=s>0;if(t.isInstanced=t.isInstanced||a,n instanceof ei){const o=n;if(a){const A=o.getVertexCount(i);t.instanceCount=Math.min(t.instanceCount,A)}else{const A=o.getVertexCount(i);t.vertexCount=Math.min(t.vertexCount,A)}}}setElements(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return mr.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(t,e)}}function Oz(r,t){const{maxElts:e=16,size:n=1}=t;let i="[";for(let a=0;a<r.length&&a<e;++a)a>0&&(i+=",".concat(a%n===0?" ":"")),i+=Wp(r[a],t);const s=r.length>e?"...":"]";return"".concat(i).concat(s)}function Wp(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e=1e-16,{isInteger:n=!1}=t;if(Array.isArray(r)||ArrayBuffer.isView(r))return Oz(r,t);if(!Number.isFinite(r))return String(r);if(Math.abs(r)<e)return n?"0":"0.";if(n||Math.abs(r)>100&&Math.abs(r)<1e4)return r.toFixed(0);const i=r.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function j5(r){let{header:t="Uniforms",program:e,uniforms:n,undefinedOnly:i=!1}=r;or(e);const s=".*_.*",a=".*Matrix",o=e._uniformSetters,A={},f=Object.keys(o).sort();let m=0;for(const C of f)!C.match(s)&&!C.match(a)&&Xv({table:A,header:t,uniforms:n,uniformName:C,undefinedOnly:i})&&m++;for(const C of f)C.match(a)&&Xv({table:A,header:t,uniforms:n,uniformName:C,undefinedOnly:i})&&m++;for(const C of f)A[C]||Xv({table:A,header:t,uniforms:n,uniformName:C,undefinedOnly:i})&&m++;let b=0;const x={};if(!i)for(const C in n){const M=n[C];A[C]||(b++,x[C]={Type:"NOT USED: ".concat(M),[t]:Wp(M)})}return{table:A,count:m,unusedTable:x,unusedCount:b}}function Xv(r){let{table:t,header:e,uniforms:n,uniformName:i,undefinedOnly:s}=r;const a=n[i],o=Dz(a);return!s||!o?(t[i]={[e]:o?Wp(a):"N/A","Uniform Type":o?a:"NOT PROVIDED"},!0):!1}function Dz(r){return r!=null}function kz(r){let{vertexArray:t,header:e="Attributes"}=r;if(!t.configuration)return{};const n={};t.elements&&(n.ELEMENT_ARRAY_BUFFER=q5(t,t.elements,null,e));const i=t.values;for(const s in i){const a=t._getAttributeInfo(s);if(a){let o="".concat(s,": ").concat(a.name);const A=t.accessors[a.location];A&&(o="".concat(s,": ").concat(Nz(a.name,A))),n[o]=q5(t,i[s],A,e)}}return n}function q5(r,t,e,n){const{gl:i}=r;if(!t)return{[n]:"null","Format ":"N/A"};let s="NOT PROVIDED",a=1,o=0,A=0,f,m,b;if(e&&(s=e.type,a=e.size,s=String(s).replace("Array",""),f=s.indexOf("nt")!==-1),t instanceof ei){const x=t,{data:C,changed:M}=x.getDebugData();m=M?"*":"",b=C,A=x.byteLength,o=A/C.BYTES_PER_ELEMENT/a;let U;if(e){const N=e.divisor>0;U="".concat(N?"I ":"P "," ").concat(o," (x").concat(a,"=").concat(A," bytes ").concat(BA(i,s),")")}else f=!0,U="".concat(A," bytes");return{[n]:"".concat(m).concat(Wp(b,{size:a,isInteger:f})),"Format ":U}}return b=t,a=t.length,s=String(t.constructor.name).replace("Array",""),f=s.indexOf("nt")!==-1,{[n]:"".concat(Wp(b,{size:a,isInteger:f})," (constant)"),"Format ":"".concat(a,"x").concat(s," (constant)")}}function Nz(r,t){const{type:e,size:n}=t,i=H5(e,n);return i?"".concat(r," (").concat(i.name,")"):r}function Qz(r){const t={},e="Accessors for ".concat(r.id);for(const n of r.attributeInfos)if(n){const i=K5(n);t["in ".concat(i)]={[e]:JSON.stringify(n.accessor)}}for(const n of r.varyingInfos)if(n){const i=K5(n);t["out ".concat(i)]={[e]:JSON.stringify(n.accessor)}}return t}function K5(r){const{type:t,size:e}=r.accessor,n=H5(t,e);return n?"".concat(n.name," ").concat(r.name):r.name}const W5=xu()&&typeof document<"u";let Hz=0;class zz{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:e=N=>h5(N),onAddHTML:n=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:a=()=>{},onError:o,gl:A=null,glOptions:f={},debug:m=!1,createFramebuffer:b=!1,autoResizeViewport:x=!0,autoResizeDrawingBuffer:C=!0,stats:M=Th.get("animation-loop-".concat(Hz++))}=t;let{useDevicePixels:U=!0}=t;"useDevicePixelRatio"in t&&(mr.deprecated("useDevicePixelRatio","useDevicePixels")(),U=t.useDevicePixelRatio),this.props={onCreateContext:e,onAddHTML:n,onInitialize:i,onRender:s,onFinalize:a,onError:o,gl:A,glOptions:f,debug:m,createFramebuffer:b},this.gl=A,this.needsRedraw=null,this.timeline=null,this.stats=M,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:x,autoResizeDrawingBuffer:C,useDevicePixels:U}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(t){return or(typeof t=="string"),this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}start(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const e=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(t),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=A0.isSupported(this.gl,["timers"])?new A0(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(n=>{this._running&&(this._addCallbackData(n||{}),n!==!1&&this._startLoop())});return this.props.onError&&e.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(t=>{this._resolveNextFrame=t})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const n=document.getElementById(t);return n?Number(n.value):e}setViewParameters(){return mr.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const t=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(t))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(t)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=W5?new Promise((t,e)=>{if(W5&&document.readyState==="complete"){t(document);return}window.addEventListener("load",()=>{t(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(t){this.display&&(this.display.delete(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_cancelAnimationFrame(t){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(t):$7(t)}_requestAnimationFrame(t){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(t):W7(t)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:t,height:e,aspect:n}=this._getSizeAndAspect();(t!==this.animationProps.width||e!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=e,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(t){typeof t=="object"&&t!==null&&(this.animationProps=Object.assign({},this.animationProps,t))}_createWebGLContext(t){if(this.offScreen=t.canvas&&typeof OffscreenCanvas<"u"&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,this.props.glOptions),this.gl=this.props.gl?Ov(this.props.gl,t):this.onCreateContext(t),!i0(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");R7(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);const n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}_getSizeAndAspect(){const t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight;let n=1;const{canvas:i}=this.gl;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&Q7(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new vs(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:t}=this.gl;t&&(t.addEventListener("mousemove",this._onMousemove),t.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}_onMouseleave(t){this.animationProps._mousePosition=null}}const $p="vs",Yv="fs";function Fa(r,t){if(!r)throw new Error(t||"shadertools: assertion failed.")}const Jv={number:{validate(r,t){return Number.isFinite(r)&&(!("max"in t)||r<=t.max)&&(!("min"in t)||r>=t.min)}},array:{validate(r,t){return Array.isArray(r)||ArrayBuffer.isView(r)}}};function Gz(r){const t={};for(const e in r){const n=r[e],i=Vz(n);t[e]=i}return t}function Vz(r){let t=$5(r);return t==="object"?r?"type"in r?Object.assign({},r,Jv[r.type]):"value"in r?(t=$5(r.value),Object.assign({type:t},r,Jv[t])):{type:"object",value:r}:{type:"object",value:null}:Object.assign({type:t,value:r},Jv[t])}function $5(r){return Array.isArray(r)||ArrayBuffer.isView(r)?"array":typeof r}const jz="vs",qz="fs";class X5{constructor(t){let{name:e,vs:n,fs:i,dependencies:s=[],uniforms:a,getUniforms:o,deprecations:A=[],defines:f={},inject:m={},vertexShader:b,fragmentShader:x}=t;Fa(typeof e=="string"),this.name=e,this.vs=n||b,this.fs=i||x,this.getModuleUniforms=o,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(A),this.defines=f,this.injections=Kz(m),a&&(this.uniforms=Gz(a))}getModuleSource(t){let e;switch(t){case jz:e=this.vs||"";break;case qz:e=this.fs||"";break;default:Fa(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(e,"// END MODULE_").concat(this.name,`

`)}getUniforms(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):this.uniforms?this._defaultGetUniforms(t):{}}getDefines(){return this.defines}checkDeprecations(t,e){this.deprecations.forEach(n=>{n.regex.test(t)&&(n.deprecated?e.deprecated(n.old,n.new)():e.removed(n.old,n.new)())})}_parseDeprecationDefinitions(t){return t.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp("\\b".concat(e.old,"\\("));break;default:e.regex=new RegExp("".concat(e.type," ").concat(e.old,";"))}}),t}_defaultGetUniforms(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e={},n=this.uniforms;for(const i in n){const s=n[i];i in t&&!s.private?(s.validate&&Fa(s.validate(t[i],s),"".concat(this.name,": invalid ").concat(i)),e[i]=t[i]):e[i]=s.value}return e}}function Kz(r){const t={vs:{},fs:{}};for(const e in r){let n=r[e];const i=e.slice(0,2);typeof n=="string"&&(n={order:0,injection:n}),t[i][e]=n}return t}function Wz(r){return $z(J5(r))}function $z(r){const t={},e={};return Y5({modules:r,level:0,moduleMap:t,moduleDepth:e}),Object.keys(e).sort((n,i)=>e[i]-e[n]).map(n=>t[n])}function Y5(r){let{modules:t,level:e,moduleMap:n,moduleDepth:i}=r;if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const s of t)n[s.name]=s,(i[s.name]===void 0||i[s.name]<e)&&(i[s.name]=e);for(const s of t)s.dependencies&&Y5({modules:s.dependencies,level:e+1,moduleMap:n,moduleDepth:i})}function J5(r,t){return r.map(e=>(e instanceof X5||(Fa(typeof e!="string","Shader module use by name is deprecated. Import shader module '".concat(e,"' and use it directly.")),Fa(e.name,"shader module has no name"),e=new X5(e),e.dependencies=J5(e.dependencies)),e))}function Xz(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=typeof window<"u"?window.navigator||{}:{},e=r.userAgent||t.userAgent||"",n=e.indexOf("MSIE ")!==-1,i=e.indexOf("Trident/")!==-1;return n||i}const Yz=7936,Jz=7937,Zz=7938,t9=35724,Zv={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Lh={};Object.keys(Zv).forEach(r=>{Lh[r]=r});function e9(r){return typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?!0:!!(r&&r._version===2)}function r9(r){const t=r.getExtension("WEBGL_debug_renderer_info"),e=r.getParameter(t&&t.UNMASKED_VENDOR_WEBGL||Yz),n=r.getParameter(t&&t.UNMASKED_RENDERER_WEBGL||Jz);return{gpuVendor:n9(e,n),vendor:e,renderer:n,version:r.getParameter(Zz),shadingLanguageVersion:r.getParameter(t9)}}function n9(r,t){return r.match(/NVIDIA/i)||t.match(/NVIDIA/i)?"NVIDIA":r.match(/INTEL/i)||t.match(/INTEL/i)?"INTEL":r.match(/AMD/i)||t.match(/AMD/i)||r.match(/ATI/i)||t.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const tb={};function Z5(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=Zv[t];if(Fa(n,t),!Xz(e))return!0;if(t in tb)return tb[t];const i=n[0],s=e.behavior||"enable",a="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),o=r.createShader(35633);r.shaderSource(o,a),r.compileShader(o);const A=r.getShaderParameter(o,35713);return r.deleteShader(o),tb[t]=A,A}function i9(r,t){const e=Zv[t];Fa(e,t);const n=e9(r)&&e[1]||e[0],i=typeof n=="string"?!!r.getExtension(n):n;return Fa(i===!1||i===!0),i}function d0(r,t){return t=Array.isArray(t)?t:[t],t.every(e=>i9(r,e))}function s9(r){switch(r9(r).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function o9(r,t,e){let n=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return d0(r,Lh.GLSL_FRAG_DEPTH)&&(n+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),d0(r,Lh.GLSL_DERIVATIVES)&&Z5(r,Lh.GLSL_DERIVATIVES)&&(n+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),d0(r,Lh.GLSL_FRAG_DATA)&&Z5(r,Lh.GLSL_FRAG_DATA,{behavior:"require"})&&(n+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),d0(r,Lh.GLSL_TEXTURE_LOD)&&(n+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),n}const a9=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,c9=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,l9={[$p]:a9,[Yv]:c9},f0="__LUMA_INJECT_DECLARATIONS__",tT=/void\s+main\s*\([^)]*\)\s*\{\n?/,eT=/}\n?[^{}]*$/,eb=[];function rT(r,t,e){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=t===$p;for(const s in e){const a=e[s];a.sort((A,f)=>A.order-f.order),eb.length=a.length;for(let A=0,f=a.length;A<f;++A)eb[A]=a[A].injection;const o="".concat(eb.join(`
`),`
`);switch(s){case"vs:#decl":i&&(r=r.replace(f0,o));break;case"vs:#main-start":i&&(r=r.replace(tT,A=>A+o));break;case"vs:#main-end":i&&(r=r.replace(eT,A=>o+A));break;case"fs:#decl":i||(r=r.replace(f0,o));break;case"fs:#main-start":i||(r=r.replace(tT,A=>A+o));break;case"fs:#main-end":i||(r=r.replace(eT,A=>o+A));break;default:r=r.replace(s,A=>A+o)}}return r=r.replace(f0,""),n&&(r=r.replace(/\}\s*$/,s=>s+l9[t])),r}function rb(r){const t={};return Fa(Array.isArray(r)&&r.length>1),r.forEach(e=>{for(const n in e)t[n]=t[n]?"".concat(t[n],`
`).concat(e[n]):e[n]}),t}function Gd(r){return new RegExp("\\b".concat(r,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const nT=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],u9=[...nT,[Gd("attribute"),"in $1"],[Gd("varying"),"out $1"]],A9=[...nT,[Gd("varying"),"in $1"]],iT=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],h9=[...iT,[Gd("in"),"attribute $1"],[Gd("out"),"varying $1"]],d9=[...iT,[Gd("in"),"varying $1"]],nb="gl_FragColor",ib=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,f9=/void\s+main\s*\([^)]*\)\s*\{\n?/;function p9(r,t,e){switch(t){case 300:return e?p0(r,u9):g9(r);case 100:return e?p0(r,h9):m9(r);default:throw new Error("unknown GLSL version ".concat(t))}}function p0(r,t){for(const[e,n]of t)r=r.replace(e,n);return r}function g9(r){r=p0(r,A9);const t=r.match(ib);if(t){const e=t[1];r=r.replace(new RegExp("\\b".concat(nb,"\\b"),"g"),e)}else{const e="fragmentColor";r=r.replace(f9,n=>"out vec4 ".concat(e,`;
`).concat(n)).replace(new RegExp("\\b".concat(nb,"\\b"),"g"),e)}return r}function m9(r){r=p0(r,d9);const t=r.match(ib);if(t){const e=t[1];r=r.replace(ib,"").replace(new RegExp("\\b".concat(e,"\\b"),"g"),nb)}return r}const y9=`

`.concat(f0,`

`),sT={[$p]:"vertex",[Yv]:"fragment"},_9=`precision highp float;

`;function v9(r,t){const{vs:e,fs:n}=t,i=Wz(t.modules||[]);return{gl:r,vs:oT(r,Object.assign({},t,{source:e,type:$p,modules:i})),fs:oT(r,Object.assign({},t,{source:n,type:Yv,modules:i})),getUniforms:b9(i)}}function oT(r,t){let{id:e,source:n,type:i,modules:s,defines:a={},hookFunctions:o=[],inject:A={},transpileToGLSL100:f=!1,prologue:m=!0,log:b}=t;Fa(typeof n=="string","shader source must be a string");const x=i===$p,C=n.split(`
`);let M=100,U="",N=n;C[0].indexOf("#version ")===0?(M=300,U=C[0],N=C.slice(1).join(`
`)):U="#version ".concat(M);const Q={};s.forEach(mt=>{Object.assign(Q,mt.getDefines())}),Object.assign(Q,a);let q=m?"".concat(U,`
`).concat(x9({id:e,source:n,type:i}),`
`).concat(w9({type:i}),`
`).concat(s9(r),`
`).concat(o9(r),`
`).concat(B9(Q),`
`).concat(x?"":_9,`
`):"".concat(U,`
`);const Y=E9(o),tt={},ft={},pt={};for(const mt in A){const dt=typeof A[mt]=="string"?{injection:A[mt],order:0}:A[mt],Rt=mt.match(/^(v|f)s:(#)?([\w-]+)$/);if(Rt){const Lt=Rt[2],st=Rt[3];Lt?st==="decl"?ft[mt]=[dt]:pt[mt]=[dt]:tt[mt]=[dt]}else pt[mt]=[dt]}for(const mt of s){b&&mt.checkDeprecations(N,b);const dt=mt.getModuleSource(i,M);q+=dt;const Rt=mt.injections[i];for(const Lt in Rt){const st=Lt.match(/^(v|f)s:#([\w-]+)$/);if(st){const wt=st[2]==="decl"?ft:pt;wt[Lt]=wt[Lt]||[],wt[Lt].push(Rt[Lt])}else tt[Lt]=tt[Lt]||[],tt[Lt].push(Rt[Lt])}}return q+=y9,q=rT(q,i,ft),q+=C9(Y[i],tt),q+=N,q=rT(q,i,pt),q=p9(q,f?100:M,x),q}function b9(r){return function(e){const n={};for(const i of r){const s=i.getUniforms(e,n);Object.assign(n,s)}return n}}function w9(r){let{type:t}=r;return`
#define SHADER_TYPE_`.concat(sT[t].toUpperCase(),`
`)}function x9(r){let{id:t,source:e,type:n}=r;return t&&typeof t=="string"&&e.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(t,"_").concat(sT[n],`

`):""}function B9(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=0,e="";for(const n in r){t===0&&(e+=`
// APPLICATION DEFINES
`),t++;const i=r[n];(i||Number.isFinite(i))&&(e+="#define ".concat(n.toUpperCase()," ").concat(r[n],`
`))}return t===0&&(e+=`
`),e}function C9(r,t){let e="";for(const n in r){const i=r[n];if(e+="void ".concat(i.signature,` {
`),i.header&&(e+="  ".concat(i.header)),t[n]){const s=t[n];s.sort((a,o)=>a.order-o.order);for(const a of s)e+="  ".concat(a.injection,`
`)}i.footer&&(e+="  ".concat(i.footer)),e+=`}
`}return e}function E9(r){const t={vs:{},fs:{}};return r.forEach(e=>{let n;typeof e!="string"?(n=e,e=n.hook):n={},e=e.trim();const[i,s]=e.split(":"),a=e.replace(/\(.+/,"");t[i][a]=Object.assign(n,{signature:s})}),t}const S9="void main() {gl_FragColor = vec4(0);}",aT=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,T9=`#version 300 es
`.concat(aT);function cT(r,t){t=Array.isArray(t)?t:[t];const e=r.replace(/^\s+/,"").split(/\s+/),[n,i,s]=e;if(!t.includes(n)||!i||!s)return null;const a=s.split(";")[0];return{qualifier:n,type:i,name:a}}function lT(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:t=100,input:e,inputType:n,output:i}=r;if(!e)return t===300?T9:t>300?"#version ".concat(t,`
`).concat(aT):S9;const s=F9(e,n);return t>=300?"#version ".concat(t," ").concat(t===300?"es":"",`
in `).concat(n," ").concat(e,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(n," ").concat(e,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function I9(r){switch(r){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Fa(!1),null}}function L9(r){switch(r){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Fa(!1),null}}function F9(r,t){switch(t){case"float":return"vec4(".concat(r,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(r,", 0.0, 1.0)");case"vec3":return"vec4(".concat(r,", 1.0)");case"vec4":return r;default:return Fa(!1),null}}const M9={name:"fp32",vs:`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,fs:null};function Dc(r,t){if(!r)throw new Error("math.gl assertion ".concat(t))}const P9=1/Math.PI*180,U9=1/180*Math.PI,ws={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function R9(r){let{precision:t=ws.precision}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return r=N9(r),"".concat(parseFloat(r.toPrecision(t)))}function EA(r){return Array.isArray(r)||ArrayBuffer.isView(r)&&!(r instanceof DataView)}function O9(r){return k9(r)}function D9(r){return Tu(r)}function k9(r,t){return sb(r,e=>e*U9,t)}function Tu(r,t){return sb(r,e=>e*P9,t)}function Iu(r,t,e){return sb(r,n=>Math.max(t,Math.min(e,n)))}function g0(r,t,e){return EA(r)?r.map((n,i)=>g0(n,t[i],e)):e*t+(1-e)*r}function kc(r,t,e){const n=ws.EPSILON;e&&(ws.EPSILON=e);try{if(r===t)return!0;if(EA(r)&&EA(t)){if(r.length!==t.length)return!1;for(let i=0;i<r.length;++i)if(!kc(r[i],t[i]))return!1;return!0}return r&&r.equals?r.equals(t):t&&t.equals?t.equals(r):typeof r=="number"&&typeof t=="number"?Math.abs(r-t)<=ws.EPSILON*Math.max(1,Math.abs(r),Math.abs(t)):!1}finally{ws.EPSILON=n}}function N9(r){return Math.round(r/ws.EPSILON)*ws.EPSILON}function Q9(r){return r.clone?r.clone():new Array(r.length)}function sb(r,t,e){if(EA(r)){const n=r;e=e||Q9(n);for(let i=0;i<e.length&&i<n.length;++i)e[i]=t(r[i],i,e);return e}return t(r)}function H9(r){function t(){var e=Reflect.construct(r,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return t.prototype=Object.create(r.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r,t}class ob extends H9(Array){clone(){return new this.constructor().copy(this)}fromArray(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}toArray(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:EA(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(ws)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+R9(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!kc(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){if(n===void 0)return this.lerp(this,t,e);for(let i=0;i<this.ELEMENTS;++i){const s=t[i];this[i]=s+n*(e[i]-s)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let s=0;s<this.ELEMENTS;++s)this[s]+=i[s];return this.check()}subtract(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let s=0;s<this.ELEMENTS;++s)this[s]-=i[s];return this.check()}scale(t){if(typeof t=="number")for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;else for(let e=0;e<this.ELEMENTS&&e<t.length;++e)this[e]*=t[e];return this.check()}multiplyByScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}check(){if(ws.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}get elements(){return this}}function z9(r,t){if(r.length!==t)return!1;for(let e=0;e<r.length;++e)if(!Number.isFinite(r[e]))return!1;return!0}function Nn(r){if(!Number.isFinite(r))throw new Error("Invalid number ".concat(r));return r}function Xp(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(ws.debug&&!z9(r,t))throw new Error("math.gl: ".concat(e," some fields set to invalid numbers'"));return r}class ab extends ob{get x(){return this[0]}set x(t){this[0]=Nn(t)}get y(){return this[1]}set y(t){this[1]=Nn(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-t[n];e+=i*i}return Nn(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Nn(e)}normalize(){const t=this.magnitude();if(t!==0)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let s=0;s<this.ELEMENTS;++s)this[s]*=i[s];return this.check()}divide(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let s=0;s<this.ELEMENTS;++s)this[s]/=i[s];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return Dc(t>=0&&t<this.ELEMENTS,"index is out of range"),Nn(this[t])}setComponent(t,e){return Dc(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}var Yp=1e-6,Nc=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});function G9(){var r=new Nc(2);return Nc!=Float32Array&&(r[0]=0,r[1]=0),r}function uT(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r}function V9(r,t){return r[0]=-t[0],r[1]=-t[1],r}function AT(r,t,e,n){var i=t[0],s=t[1];return r[0]=i+n*(e[0]-i),r[1]=s+n*(e[1]-s),r}function j9(r,t,e){var n=t[0],i=t[1];return r[0]=e[0]*n+e[2]*i,r[1]=e[1]*n+e[3]*i,r}function q9(r,t,e){var n=t[0],i=t[1];return r[0]=e[0]*n+e[2]*i+e[4],r[1]=e[1]*n+e[3]*i+e[5],r}function hT(r,t,e){var n=t[0],i=t[1];return r[0]=e[0]*n+e[3]*i+e[6],r[1]=e[1]*n+e[4]*i+e[7],r}function dT(r,t,e){var n=t[0],i=t[1];return r[0]=e[0]*n+e[4]*i+e[12],r[1]=e[1]*n+e[5]*i+e[13],r}(function(){var r=G9();return function(t,e,n,i,s,a){var o,A;for(e||(e=2),n||(n=0),i?A=Math.min(i*e+n,t.length):A=t.length,o=n;o<A;o+=e)r[0]=t[o],r[1]=t[o+1],s(r,r,a),t[o]=r[0],t[o+1]=r[1];return t}})();function fT(r,t,e){const n=t[0],i=t[1],s=e[3]*n+e[7]*i||1;return r[0]=(e[0]*n+e[4]*i)/s,r[1]=(e[1]*n+e[5]*i)/s,r}function pT(r,t,e){const n=t[0],i=t[1],s=t[2],a=e[3]*n+e[7]*i+e[11]*s||1;return r[0]=(e[0]*n+e[4]*i+e[8]*s)/a,r[1]=(e[1]*n+e[5]*i+e[9]*s)/a,r[2]=(e[2]*n+e[6]*i+e[10]*s)/a,r}function K9(r,t,e){const n=t[0],i=t[1];return r[0]=e[0]*n+e[2]*i,r[1]=e[1]*n+e[3]*i,r[2]=t[2],r}function W9(r,t,e){const n=t[0],i=t[1];return r[0]=e[0]*n+e[2]*i,r[1]=e[1]*n+e[3]*i,r[2]=t[2],r[3]=t[3],r}function gT(r,t,e){const n=t[0],i=t[1],s=t[2];return r[0]=e[0]*n+e[3]*i+e[6]*s,r[1]=e[1]*n+e[4]*i+e[7]*s,r[2]=e[2]*n+e[5]*i+e[8]*s,r[3]=t[3],r}class cb extends ab{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;super(2),EA(t)&&arguments.length===1?this.copy(t):(ws.debug&&(Nn(t),Nn(e)),this[0]=t,this[1]=e)}set(t,e){return this[0]=t,this[1]=e,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return ws.debug&&(Nn(t.x),Nn(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return dT(this,this,t),this.check()}transformAsVector(t){return fT(this,this,t),this.check()}transformByMatrix3(t){return hT(this,this,t),this.check()}transformByMatrix2x3(t){return q9(this,this,t),this.check()}transformByMatrix2(t){return j9(this,this,t),this.check()}}function mT(){var r=new Nc(3);return Nc!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function yT(r){var t=r[0],e=r[1],n=r[2];return Math.hypot(t,e,n)}function _T(r,t,e){var n=new Nc(3);return n[0]=r,n[1]=t,n[2]=e,n}function $9(r,t,e){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r}function X9(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r}function Y9(r,t){var e=t[0],n=t[1],i=t[2],s=e*e+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),r[0]=t[0]*s,r[1]=t[1]*s,r[2]=t[2]*s,r}function lb(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]}function m0(r,t,e){var n=t[0],i=t[1],s=t[2],a=e[0],o=e[1],A=e[2];return r[0]=i*A-s*o,r[1]=s*a-n*A,r[2]=n*o-i*a,r}function ub(r,t,e){var n=t[0],i=t[1],s=t[2],a=e[3]*n+e[7]*i+e[11]*s+e[15];return a=a||1,r[0]=(e[0]*n+e[4]*i+e[8]*s+e[12])/a,r[1]=(e[1]*n+e[5]*i+e[9]*s+e[13])/a,r[2]=(e[2]*n+e[6]*i+e[10]*s+e[14])/a,r}function vT(r,t,e){var n=t[0],i=t[1],s=t[2];return r[0]=n*e[0]+i*e[3]+s*e[6],r[1]=n*e[1]+i*e[4]+s*e[7],r[2]=n*e[2]+i*e[5]+s*e[8],r}function bT(r,t,e){var n=e[0],i=e[1],s=e[2],a=e[3],o=t[0],A=t[1],f=t[2],m=i*f-s*A,b=s*o-n*f,x=n*A-i*o,C=i*x-s*b,M=s*m-n*x,U=n*b-i*m,N=a*2;return m*=N,b*=N,x*=N,C*=2,M*=2,U*=2,r[0]=o+m+C,r[1]=A+b+M,r[2]=f+x+U,r}function J9(r,t,e,n){var i=[],s=[];return i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],s[0]=i[0],s[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),s[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),r[0]=s[0]+e[0],r[1]=s[1]+e[1],r[2]=s[2]+e[2],r}function Z9(r,t,e,n){var i=[],s=[];return i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],s[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),s[1]=i[1],s[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),r[0]=s[0]+e[0],r[1]=s[1]+e[1],r[2]=s[2]+e[2],r}function tG(r,t,e,n){var i=[],s=[];return i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],s[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),s[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),s[2]=i[2],r[0]=s[0]+e[0],r[1]=s[1]+e[1],r[2]=s[2]+e[2],r}function eG(r,t){var e=r[0],n=r[1],i=r[2],s=t[0],a=t[1],o=t[2],A=Math.sqrt(e*e+n*n+i*i),f=Math.sqrt(s*s+a*a+o*o),m=A*f,b=m&&lb(r,t)/m;return Math.acos(Math.min(Math.max(b,-1),1))}var rG=$9,nG=yT;(function(){var r=mT();return function(t,e,n,i,s,a){var o,A;for(e||(e=3),n||(n=0),i?A=Math.min(i*e+n,t.length):A=t.length,o=n;o<A;o+=e)r[0]=t[o],r[1]=t[o+1],r[2]=t[o+2],s(r,r,a),t[o]=r[0],t[o+1]=r[1],t[o+2]=r[2];return t}})();const Ab=[0,0,0];let y0;class le extends ab{static get ZERO(){return y0||(y0=new le(0,0,0),Object.freeze(y0)),y0}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;super(-0,-0,-0),arguments.length===1&&EA(t)?this.copy(t):(ws.debug&&(Nn(t),Nn(e),Nn(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return ws.debug&&(Nn(t.x),Nn(t.y),Nn(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=Nn(t)}angle(t){return eG(this,t)}cross(t){return m0(this,this,t),this.check()}rotateX(t){let{radians:e,origin:n=Ab}=t;return J9(this,this,n,e),this.check()}rotateY(t){let{radians:e,origin:n=Ab}=t;return Z9(this,this,n,e),this.check()}rotateZ(t){let{radians:e,origin:n=Ab}=t;return tG(this,this,n,e),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return ub(this,this,t),this.check()}transformAsVector(t){return pT(this,this,t),this.check()}transformByMatrix3(t){return vT(this,this,t),this.check()}transformByMatrix2(t){return K9(this,this,t),this.check()}transformByQuaternion(t){return bT(this,this,t),this.check()}}let _0;class hb extends ab{static get ZERO(){return _0||(_0=new hb(0,0,0,0),Object.freeze(_0)),_0}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;super(-0,-0,-0,-0),EA(t)&&arguments.length===1?this.copy(t):(ws.debug&&(Nn(t),Nn(e),Nn(n),Nn(i)),this[0]=t,this[1]=e,this[2]=n,this[3]=i)}set(t,e,n,i){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return ws.debug&&(Nn(t.x),Nn(t.y),Nn(t.z),Nn(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=Nn(t)}get w(){return this[3]}set w(t){this[3]=Nn(t)}transform(t){return ub(this,this,t),this.check()}transformByMatrix3(t){return gT(this,this,t),this.check()}transformByMatrix2(t){return W9(this,this,t),this.check()}transformByQuaternion(t){return bT(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}}class wT extends ob{toString(){let t="[";if(ws.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=Nn(n),this}getColumn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Array(this.RANK).fill(-0);const n=t*this.RANK;for(let i=0;i<this.RANK;++i)e[i]=this[n+i];return e}setColumn(t,e){const n=t*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=e[i];return this}}function iG(){var r=new Nc(9);return Nc!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function sG(r,t){if(r===t){var e=t[1],n=t[2],i=t[5];r[1]=t[3],r[2]=t[6],r[3]=e,r[5]=t[7],r[6]=n,r[7]=i}else r[0]=t[0],r[1]=t[3],r[2]=t[6],r[3]=t[1],r[4]=t[4],r[5]=t[7],r[6]=t[2],r[7]=t[5],r[8]=t[8];return r}function oG(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5],A=t[6],f=t[7],m=t[8],b=m*a-o*f,x=-m*s+o*A,C=f*s-a*A,M=e*b+n*x+i*C;return M?(M=1/M,r[0]=b*M,r[1]=(-m*n+i*f)*M,r[2]=(o*n-i*a)*M,r[3]=x*M,r[4]=(m*e-i*A)*M,r[5]=(-o*e+i*s)*M,r[6]=C*M,r[7]=(-f*e+n*A)*M,r[8]=(a*e-n*s)*M,r):null}function aG(r){var t=r[0],e=r[1],n=r[2],i=r[3],s=r[4],a=r[5],o=r[6],A=r[7],f=r[8];return t*(f*s-a*A)+e*(-f*i+a*o)+n*(A*i-s*o)}function xT(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],A=t[5],f=t[6],m=t[7],b=t[8],x=e[0],C=e[1],M=e[2],U=e[3],N=e[4],Q=e[5],q=e[6],Y=e[7],tt=e[8];return r[0]=x*n+C*a+M*f,r[1]=x*i+C*o+M*m,r[2]=x*s+C*A+M*b,r[3]=U*n+N*a+Q*f,r[4]=U*i+N*o+Q*m,r[5]=U*s+N*A+Q*b,r[6]=q*n+Y*a+tt*f,r[7]=q*i+Y*o+tt*m,r[8]=q*s+Y*A+tt*b,r}function cG(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],A=t[5],f=t[6],m=t[7],b=t[8],x=e[0],C=e[1];return r[0]=n,r[1]=i,r[2]=s,r[3]=a,r[4]=o,r[5]=A,r[6]=x*n+C*a+f,r[7]=x*i+C*o+m,r[8]=x*s+C*A+b,r}function lG(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],A=t[5],f=t[6],m=t[7],b=t[8],x=Math.sin(e),C=Math.cos(e);return r[0]=C*n+x*a,r[1]=C*i+x*o,r[2]=C*s+x*A,r[3]=C*a-x*n,r[4]=C*o-x*i,r[5]=C*A-x*s,r[6]=f,r[7]=m,r[8]=b,r}function BT(r,t,e){var n=e[0],i=e[1];return r[0]=n*t[0],r[1]=n*t[1],r[2]=n*t[2],r[3]=i*t[3],r[4]=i*t[4],r[5]=i*t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r}function uG(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=e+e,o=n+n,A=i+i,f=e*a,m=n*a,b=n*o,x=i*a,C=i*o,M=i*A,U=s*a,N=s*o,Q=s*A;return r[0]=1-b-M,r[3]=m-Q,r[6]=x+N,r[1]=m+Q,r[4]=1-f-M,r[7]=C-U,r[2]=x-N,r[5]=C+U,r[8]=1-f-b,r}var db;(function(r){r[r.COL0ROW0=0]="COL0ROW0",r[r.COL0ROW1=1]="COL0ROW1",r[r.COL0ROW2=2]="COL0ROW2",r[r.COL1ROW0=3]="COL1ROW0",r[r.COL1ROW1=4]="COL1ROW1",r[r.COL1ROW2=5]="COL1ROW2",r[r.COL2ROW0=6]="COL2ROW0",r[r.COL2ROW1=7]="COL2ROW1",r[r.COL2ROW2=8]="COL2ROW2"})(db||(db={}));const AG=Object.freeze([1,0,0,0,1,0,0,0,1]);class Qi extends wT{static get IDENTITY(){return dG()}static get ZERO(){return hG()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return db}constructor(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):n.length>0?this.copy([t,...n]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(AG)}fromObject(t){return this.check()}fromQuaternion(t){return uG(this,t),this.check()}set(t,e,n,i,s,a,o,A,f){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this[4]=s,this[5]=a,this[6]=o,this[7]=A,this[8]=f,this.check()}setRowMajor(t,e,n,i,s,a,o,A,f){return this[0]=t,this[1]=i,this[2]=o,this[3]=e,this[4]=s,this[5]=A,this[6]=n,this[7]=a,this[8]=f,this.check()}determinant(){return aG(this)}transpose(){return sG(this,this),this.check()}invert(){return oG(this,this),this.check()}multiplyLeft(t){return xT(this,t,this),this.check()}multiplyRight(t){return xT(this,this,t),this.check()}rotate(t){return lG(this,this,t),this.check()}scale(t){return Array.isArray(t)?BT(this,this,t):BT(this,this,[t,t]),this.check()}translate(t){return cG(this,this,t),this.check()}transform(t,e){let n;switch(t.length){case 2:n=hT(e||[-0,-0],t,this);break;case 3:n=vT(e||[-0,-0,-0],t,this);break;case 4:n=gT(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Xp(n,t.length),n}transformVector(t,e){return this.transform(t,e)}transformVector2(t,e){return this.transform(t,e)}transformVector3(t,e){return this.transform(t,e)}}let v0,b0;function hG(){return v0||(v0=new Qi([0,0,0,0,0,0,0,0,0]),Object.freeze(v0)),v0}function dG(){return b0||(b0=new Qi,Object.freeze(b0)),b0}function fG(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function pG(r,t){if(r===t){var e=t[1],n=t[2],i=t[3],s=t[6],a=t[7],o=t[11];r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=e,r[6]=t[9],r[7]=t[13],r[8]=n,r[9]=s,r[11]=t[14],r[12]=i,r[13]=a,r[14]=o}else r[0]=t[0],r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=t[1],r[5]=t[5],r[6]=t[9],r[7]=t[13],r[8]=t[2],r[9]=t[6],r[10]=t[10],r[11]=t[14],r[12]=t[3],r[13]=t[7],r[14]=t[11],r[15]=t[15];return r}function fb(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5],A=t[6],f=t[7],m=t[8],b=t[9],x=t[10],C=t[11],M=t[12],U=t[13],N=t[14],Q=t[15],q=e*o-n*a,Y=e*A-i*a,tt=e*f-s*a,ft=n*A-i*o,pt=n*f-s*o,mt=i*f-s*A,dt=m*U-b*M,Rt=m*N-x*M,Lt=m*Q-C*M,st=b*N-x*U,ct=b*Q-C*U,wt=x*Q-C*N,yt=q*wt-Y*ct+tt*st+ft*Lt-pt*Rt+mt*dt;return yt?(yt=1/yt,r[0]=(o*wt-A*ct+f*st)*yt,r[1]=(i*ct-n*wt-s*st)*yt,r[2]=(U*mt-N*pt+Q*ft)*yt,r[3]=(x*pt-b*mt-C*ft)*yt,r[4]=(A*Lt-a*wt-f*Rt)*yt,r[5]=(e*wt-i*Lt+s*Rt)*yt,r[6]=(N*tt-M*mt-Q*Y)*yt,r[7]=(m*mt-x*tt+C*Y)*yt,r[8]=(a*ct-o*Lt+f*dt)*yt,r[9]=(n*Lt-e*ct-s*dt)*yt,r[10]=(M*pt-U*tt+Q*q)*yt,r[11]=(b*tt-m*pt-C*q)*yt,r[12]=(o*Rt-a*st-A*dt)*yt,r[13]=(e*st-n*Rt+i*dt)*yt,r[14]=(U*Y-M*ft-N*q)*yt,r[15]=(m*ft-b*Y+x*q)*yt,r):null}function gG(r){var t=r[0],e=r[1],n=r[2],i=r[3],s=r[4],a=r[5],o=r[6],A=r[7],f=r[8],m=r[9],b=r[10],x=r[11],C=r[12],M=r[13],U=r[14],N=r[15],Q=t*a-e*s,q=t*o-n*s,Y=t*A-i*s,tt=e*o-n*a,ft=e*A-i*a,pt=n*A-i*o,mt=f*M-m*C,dt=f*U-b*C,Rt=f*N-x*C,Lt=m*U-b*M,st=m*N-x*M,ct=b*N-x*U;return Q*ct-q*st+Y*Lt+tt*Rt-ft*dt+pt*mt}function Fh(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],A=t[5],f=t[6],m=t[7],b=t[8],x=t[9],C=t[10],M=t[11],U=t[12],N=t[13],Q=t[14],q=t[15],Y=e[0],tt=e[1],ft=e[2],pt=e[3];return r[0]=Y*n+tt*o+ft*b+pt*U,r[1]=Y*i+tt*A+ft*x+pt*N,r[2]=Y*s+tt*f+ft*C+pt*Q,r[3]=Y*a+tt*m+ft*M+pt*q,Y=e[4],tt=e[5],ft=e[6],pt=e[7],r[4]=Y*n+tt*o+ft*b+pt*U,r[5]=Y*i+tt*A+ft*x+pt*N,r[6]=Y*s+tt*f+ft*C+pt*Q,r[7]=Y*a+tt*m+ft*M+pt*q,Y=e[8],tt=e[9],ft=e[10],pt=e[11],r[8]=Y*n+tt*o+ft*b+pt*U,r[9]=Y*i+tt*A+ft*x+pt*N,r[10]=Y*s+tt*f+ft*C+pt*Q,r[11]=Y*a+tt*m+ft*M+pt*q,Y=e[12],tt=e[13],ft=e[14],pt=e[15],r[12]=Y*n+tt*o+ft*b+pt*U,r[13]=Y*i+tt*A+ft*x+pt*N,r[14]=Y*s+tt*f+ft*C+pt*Q,r[15]=Y*a+tt*m+ft*M+pt*q,r}function w0(r,t,e){var n=e[0],i=e[1],s=e[2],a,o,A,f,m,b,x,C,M,U,N,Q;return t===r?(r[12]=t[0]*n+t[4]*i+t[8]*s+t[12],r[13]=t[1]*n+t[5]*i+t[9]*s+t[13],r[14]=t[2]*n+t[6]*i+t[10]*s+t[14],r[15]=t[3]*n+t[7]*i+t[11]*s+t[15]):(a=t[0],o=t[1],A=t[2],f=t[3],m=t[4],b=t[5],x=t[6],C=t[7],M=t[8],U=t[9],N=t[10],Q=t[11],r[0]=a,r[1]=o,r[2]=A,r[3]=f,r[4]=m,r[5]=b,r[6]=x,r[7]=C,r[8]=M,r[9]=U,r[10]=N,r[11]=Q,r[12]=a*n+m*i+M*s+t[12],r[13]=o*n+b*i+U*s+t[13],r[14]=A*n+x*i+N*s+t[14],r[15]=f*n+C*i+Q*s+t[15]),r}function pb(r,t,e){var n=e[0],i=e[1],s=e[2];return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r[3]=t[3]*n,r[4]=t[4]*i,r[5]=t[5]*i,r[6]=t[6]*i,r[7]=t[7]*i,r[8]=t[8]*s,r[9]=t[9]*s,r[10]=t[10]*s,r[11]=t[11]*s,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function mG(r,t,e,n){var i=n[0],s=n[1],a=n[2],o=Math.hypot(i,s,a),A,f,m,b,x,C,M,U,N,Q,q,Y,tt,ft,pt,mt,dt,Rt,Lt,st,ct,wt,yt,te;return o<Yp?null:(o=1/o,i*=o,s*=o,a*=o,A=Math.sin(e),f=Math.cos(e),m=1-f,b=t[0],x=t[1],C=t[2],M=t[3],U=t[4],N=t[5],Q=t[6],q=t[7],Y=t[8],tt=t[9],ft=t[10],pt=t[11],mt=i*i*m+f,dt=s*i*m+a*A,Rt=a*i*m-s*A,Lt=i*s*m-a*A,st=s*s*m+f,ct=a*s*m+i*A,wt=i*a*m+s*A,yt=s*a*m-i*A,te=a*a*m+f,r[0]=b*mt+U*dt+Y*Rt,r[1]=x*mt+N*dt+tt*Rt,r[2]=C*mt+Q*dt+ft*Rt,r[3]=M*mt+q*dt+pt*Rt,r[4]=b*Lt+U*st+Y*ct,r[5]=x*Lt+N*st+tt*ct,r[6]=C*Lt+Q*st+ft*ct,r[7]=M*Lt+q*st+pt*ct,r[8]=b*wt+U*yt+Y*te,r[9]=x*wt+N*yt+tt*te,r[10]=C*wt+Q*yt+ft*te,r[11]=M*wt+q*yt+pt*te,t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r)}function CT(r,t,e){var n=Math.sin(e),i=Math.cos(e),s=t[4],a=t[5],o=t[6],A=t[7],f=t[8],m=t[9],b=t[10],x=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=s*i+f*n,r[5]=a*i+m*n,r[6]=o*i+b*n,r[7]=A*i+x*n,r[8]=f*i-s*n,r[9]=m*i-a*n,r[10]=b*i-o*n,r[11]=x*i-A*n,r}function yG(r,t,e){var n=Math.sin(e),i=Math.cos(e),s=t[0],a=t[1],o=t[2],A=t[3],f=t[8],m=t[9],b=t[10],x=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=s*i-f*n,r[1]=a*i-m*n,r[2]=o*i-b*n,r[3]=A*i-x*n,r[8]=s*n+f*i,r[9]=a*n+m*i,r[10]=o*n+b*i,r[11]=A*n+x*i,r}function ET(r,t,e){var n=Math.sin(e),i=Math.cos(e),s=t[0],a=t[1],o=t[2],A=t[3],f=t[4],m=t[5],b=t[6],x=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=s*i+f*n,r[1]=a*i+m*n,r[2]=o*i+b*n,r[3]=A*i+x*n,r[4]=f*i-s*n,r[5]=m*i-a*n,r[6]=b*i-o*n,r[7]=x*i-A*n,r}function _G(r,t){var e=t[0],n=t[1],i=t[2],s=t[4],a=t[5],o=t[6],A=t[8],f=t[9],m=t[10];return r[0]=Math.hypot(e,n,i),r[1]=Math.hypot(s,a,o),r[2]=Math.hypot(A,f,m),r}function vG(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=e+e,o=n+n,A=i+i,f=e*a,m=n*a,b=n*o,x=i*a,C=i*o,M=i*A,U=s*a,N=s*o,Q=s*A;return r[0]=1-b-M,r[1]=m+Q,r[2]=x-N,r[3]=0,r[4]=m-Q,r[5]=1-f-M,r[6]=C+U,r[7]=0,r[8]=x+N,r[9]=C-U,r[10]=1-f-b,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function bG(r,t,e,n,i,s,a){var o=1/(e-t),A=1/(i-n),f=1/(s-a);return r[0]=s*2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s*2*A,r[6]=0,r[7]=0,r[8]=(e+t)*o,r[9]=(i+n)*A,r[10]=(a+s)*f,r[11]=-1,r[12]=0,r[13]=0,r[14]=a*s*2*f,r[15]=0,r}function wG(r,t,e,n,i){var s=1/Math.tan(t/2),a;return r[0]=s/e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0?(a=1/(n-i),r[10]=(i+n)*a,r[14]=2*i*n*a):(r[10]=-1,r[14]=-2*n),r}var xG=wG;function BG(r,t,e,n,i,s,a){var o=1/(t-e),A=1/(n-i),f=1/(s-a);return r[0]=-2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*A,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*f,r[11]=0,r[12]=(t+e)*o,r[13]=(i+n)*A,r[14]=(a+s)*f,r[15]=1,r}var CG=BG;function EG(r,t,e,n){var i,s,a,o,A,f,m,b,x,C,M=t[0],U=t[1],N=t[2],Q=n[0],q=n[1],Y=n[2],tt=e[0],ft=e[1],pt=e[2];return Math.abs(M-tt)<Yp&&Math.abs(U-ft)<Yp&&Math.abs(N-pt)<Yp?fG(r):(m=M-tt,b=U-ft,x=N-pt,C=1/Math.hypot(m,b,x),m*=C,b*=C,x*=C,i=q*x-Y*b,s=Y*m-Q*x,a=Q*b-q*m,C=Math.hypot(i,s,a),C?(C=1/C,i*=C,s*=C,a*=C):(i=0,s=0,a=0),o=b*a-x*s,A=x*i-m*a,f=m*s-b*i,C=Math.hypot(o,A,f),C?(C=1/C,o*=C,A*=C,f*=C):(o=0,A=0,f=0),r[0]=i,r[1]=o,r[2]=m,r[3]=0,r[4]=s,r[5]=A,r[6]=b,r[7]=0,r[8]=a,r[9]=f,r[10]=x,r[11]=0,r[12]=-(i*M+s*U+a*N),r[13]=-(o*M+A*U+f*N),r[14]=-(m*M+b*U+x*N),r[15]=1,r)}function SG(){var r=new Nc(4);return Nc!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function TG(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r[3]=t[3]+e[3],r}function ST(r,t,e){return r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r[3]=t[3]*e,r}function IG(r){var t=r[0],e=r[1],n=r[2],i=r[3];return Math.hypot(t,e,n,i)}function LG(r){var t=r[0],e=r[1],n=r[2],i=r[3];return t*t+e*e+n*n+i*i}function FG(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=e*e+n*n+i*i+s*s;return a>0&&(a=1/Math.sqrt(a)),r[0]=e*a,r[1]=n*a,r[2]=i*a,r[3]=s*a,r}function MG(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]*t[3]}function PG(r,t,e,n){var i=t[0],s=t[1],a=t[2],o=t[3];return r[0]=i+n*(e[0]-i),r[1]=s+n*(e[1]-s),r[2]=a+n*(e[2]-a),r[3]=o+n*(e[3]-o),r}function Jp(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3];return r[0]=e[0]*n+e[4]*i+e[8]*s+e[12]*a,r[1]=e[1]*n+e[5]*i+e[9]*s+e[13]*a,r[2]=e[2]*n+e[6]*i+e[10]*s+e[14]*a,r[3]=e[3]*n+e[7]*i+e[11]*s+e[15]*a,r}function UG(r,t,e){var n=t[0],i=t[1],s=t[2],a=e[0],o=e[1],A=e[2],f=e[3],m=f*n+o*s-A*i,b=f*i+A*n-a*s,x=f*s+a*i-o*n,C=-a*n-o*i-A*s;return r[0]=m*f+C*-a+b*-A-x*-o,r[1]=b*f+C*-o+x*-a-m*-A,r[2]=x*f+C*-A+m*-o-b*-a,r[3]=t[3],r}(function(){var r=SG();return function(t,e,n,i,s,a){var o,A;for(e||(e=4),n||(n=0),i?A=Math.min(i*e+n,t.length):A=t.length,o=n;o<A;o+=e)r[0]=t[o],r[1]=t[o+1],r[2]=t[o+2],r[3]=t[o+3],s(r,r,a),t[o]=r[0],t[o+1]=r[1],t[o+2]=r[2],t[o+3]=r[3];return t}})();var gb;(function(r){r[r.COL0ROW0=0]="COL0ROW0",r[r.COL0ROW1=1]="COL0ROW1",r[r.COL0ROW2=2]="COL0ROW2",r[r.COL0ROW3=3]="COL0ROW3",r[r.COL1ROW0=4]="COL1ROW0",r[r.COL1ROW1=5]="COL1ROW1",r[r.COL1ROW2=6]="COL1ROW2",r[r.COL1ROW3=7]="COL1ROW3",r[r.COL2ROW0=8]="COL2ROW0",r[r.COL2ROW1=9]="COL2ROW1",r[r.COL2ROW2=10]="COL2ROW2",r[r.COL2ROW3=11]="COL2ROW3",r[r.COL3ROW0=12]="COL3ROW0",r[r.COL3ROW1=13]="COL3ROW1",r[r.COL3ROW2=14]="COL3ROW2",r[r.COL3ROW3=15]="COL3ROW3"})(gb||(gb={}));const RG=45*Math.PI/180,OG=1,mb=.1,yb=500,DG=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class xn extends wT{static get IDENTITY(){return NG()}static get ZERO(){return kG()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return gb}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,i,s,a,o,A,f,m,b,x,C,M,U,N){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this[4]=s,this[5]=a,this[6]=o,this[7]=A,this[8]=f,this[9]=m,this[10]=b,this[11]=x,this[12]=C,this[13]=M,this[14]=U,this[15]=N,this.check()}setRowMajor(t,e,n,i,s,a,o,A,f,m,b,x,C,M,U,N){return this[0]=t,this[1]=s,this[2]=f,this[3]=C,this[4]=e,this[5]=a,this[6]=m,this[7]=M,this[8]=n,this[9]=o,this[10]=b,this[11]=U,this[12]=i,this[13]=A,this[14]=x,this[15]=N,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(DG)}fromObject(t){return this.check()}fromQuaternion(t){return vG(this,t),this.check()}frustum(t){const{left:e,right:n,bottom:i,top:s,near:a=mb,far:o=yb}=t;return o===1/0?QG(this,e,n,i,s,a):bG(this,e,n,i,s,a,o),this.check()}lookAt(t){const{eye:e,center:n=[0,0,0],up:i=[0,1,0]}=t;return EG(this,e,n,i),this.check()}ortho(t){const{left:e,right:n,bottom:i,top:s,near:a=mb,far:o=yb}=t;return CG(this,e,n,i,s,a,o),this.check()}orthographic(t){const{fovy:e=RG,aspect:n=OG,focalDistance:i=1,near:s=mb,far:a=yb}=t;TT(e);const o=e/2,A=i*Math.tan(o),f=A*n;return this.ortho({left:-f,right:f,bottom:-A,top:A,near:s,far:a})}perspective(t){const{fovy:e=45*Math.PI/180,aspect:n=1,near:i=.1,far:s=500}=t;return TT(e),xG(this,e,n,i,s),this.check()}determinant(){return gG(this)}getScale(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[-0,-0,-0];return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[-0,-0,-0];return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],s=1/n[1],a=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*s,t[2]=this[2]*a,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*s,t[6]=this[6]*a,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*s,t[10]=this[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],s=1/n[1],a=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*s,t[2]=this[2]*a,t[3]=this[4]*i,t[4]=this[5]*s,t[5]=this[6]*a,t[6]=this[8]*i,t[7]=this[9]*s,t[8]=this[10]*a,t}transpose(){return pG(this,this),this.check()}invert(){return fb(this,this),this.check()}multiplyLeft(t){return Fh(this,t,this),this.check()}multiplyRight(t){return Fh(this,this,t),this.check()}rotateX(t){return CT(this,this,t),this.check()}rotateY(t){return yG(this,this,t),this.check()}rotateZ(t){return ET(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,e){return mG(this,this,t,e),this.check()}scale(t){return pb(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return w0(this,this,t),this.check()}transform(t,e){return t.length===4?(e=Jp(e||[-0,-0,-0,-0],t,this),Xp(e,4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;let i;switch(n){case 2:i=dT(e||[-0,-0],t,this);break;case 3:i=ub(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Xp(i,t.length),i}transformAsVector(t,e){let n;switch(t.length){case 2:n=fT(e||[-0,-0],t,this);break;case 3:n=pT(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Xp(n,t.length),n}transformPoint(t,e){return this.transformAsPoint(t,e)}transformVector(t,e){return this.transformAsPoint(t,e)}transformDirection(t,e){return this.transformAsVector(t,e)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}}let x0,B0;function kG(){return x0||(x0=new xn([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(x0)),x0}function NG(){return B0||(B0=new xn,Object.freeze(B0)),B0}function TT(r){if(r>Math.PI*2)throw Error("expected radians")}function QG(r,t,e,n,i,s){const a=2*s/(e-t),o=2*s/(i-n),A=(e+t)/(e-t),f=(i+n)/(i-n),m=-1,b=-1,x=-2*s;return r[0]=a,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o,r[6]=0,r[7]=0,r[8]=A,r[9]=f,r[10]=m,r[11]=b,r[12]=0,r[13]=0,r[14]=x,r[15]=0,r}function IT(){var r=new Nc(4);return Nc!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function HG(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function LT(r,t,e){e=e*.5;var n=Math.sin(e);return r[0]=n*t[0],r[1]=n*t[1],r[2]=n*t[2],r[3]=Math.cos(e),r}function FT(r,t,e){var n=t[0],i=t[1],s=t[2],a=t[3],o=e[0],A=e[1],f=e[2],m=e[3];return r[0]=n*m+a*o+i*f-s*A,r[1]=i*m+a*A+s*o-n*f,r[2]=s*m+a*f+n*A-i*o,r[3]=a*m-n*o-i*A-s*f,r}function zG(r,t,e){e*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(e),A=Math.cos(e);return r[0]=n*A+a*o,r[1]=i*A+s*o,r[2]=s*A-i*o,r[3]=a*A-n*o,r}function GG(r,t,e){e*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(e),A=Math.cos(e);return r[0]=n*A-s*o,r[1]=i*A+a*o,r[2]=s*A+n*o,r[3]=a*A-i*o,r}function VG(r,t,e){e*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(e),A=Math.cos(e);return r[0]=n*A+i*o,r[1]=i*A-n*o,r[2]=s*A+a*o,r[3]=a*A-s*o,r}function jG(r,t){var e=t[0],n=t[1],i=t[2];return r[0]=e,r[1]=n,r[2]=i,r[3]=Math.sqrt(Math.abs(1-e*e-n*n-i*i)),r}function C0(r,t,e,n){var i=t[0],s=t[1],a=t[2],o=t[3],A=e[0],f=e[1],m=e[2],b=e[3],x,C,M,U,N;return C=i*A+s*f+a*m+o*b,C<0&&(C=-C,A=-A,f=-f,m=-m,b=-b),1-C>Yp?(x=Math.acos(C),M=Math.sin(x),U=Math.sin((1-n)*x)/M,N=Math.sin(n*x)/M):(U=1-n,N=n),r[0]=U*i+N*A,r[1]=U*s+N*f,r[2]=U*a+N*m,r[3]=U*o+N*b,r}function qG(r,t){var e=t[0],n=t[1],i=t[2],s=t[3],a=e*e+n*n+i*i+s*s,o=a?1/a:0;return r[0]=-e*o,r[1]=-n*o,r[2]=-i*o,r[3]=s*o,r}function KG(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=t[3],r}function MT(r,t){var e=t[0]+t[4]+t[8],n;if(e>0)n=Math.sqrt(e+1),r[3]=.5*n,n=.5/n,r[0]=(t[5]-t[7])*n,r[1]=(t[6]-t[2])*n,r[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var s=(i+1)%3,a=(i+2)%3;n=Math.sqrt(t[i*3+i]-t[s*3+s]-t[a*3+a]+1),r[i]=.5*n,n=.5/n,r[3]=(t[s*3+a]-t[a*3+s])*n,r[s]=(t[s*3+i]+t[i*3+s])*n,r[a]=(t[a*3+i]+t[i*3+a])*n}return r}var WG=TG,$G=ST,XG=MG,YG=PG,JG=IG,ZG=LG,PT=FG,tV=function(){var r=mT(),t=_T(1,0,0),e=_T(0,1,0);return function(n,i,s){var a=lb(i,s);return a<-.999999?(m0(r,t,i),nG(r)<1e-6&&m0(r,e,i),Y9(r,r),LT(n,r,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(m0(r,i,s),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=1+a,PT(n,n))}}();(function(){var r=IT(),t=IT();return function(e,n,i,s,a,o){return C0(r,n,a,o),C0(t,i,s,o),C0(e,r,t,2*o*(1-o)),e}})(),function(){var r=iG();return function(t,e,n,i){return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=-e[0],r[5]=-e[1],r[8]=-e[2],PT(t,MT(t,r))}}();const eV=[0,0,0,1];class Zp extends ob{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;super(-0,-0,-0,-0),Array.isArray(t)&&arguments.length===1?this.copy(t):this.set(t,e,n,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,n,i){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return MT(this,t),this.check()}fromAxisRotation(t,e){return LT(this,t,e),this.check()}identity(){return HG(this),this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=Nn(t)}get y(){return this[1]}set y(t){this[1]=Nn(t)}get z(){return this[2]}set z(t){this[2]=Nn(t)}get w(){return this[3]}set w(t){this[3]=Nn(t)}len(){return JG(this)}lengthSquared(){return ZG(this)}dot(t){return XG(this,t)}rotationTo(t,e){return tV(this,t,e),this.check()}add(t){return WG(this,this,t),this.check()}calculateW(){return jG(this,this),this.check()}conjugate(){return KG(this,this),this.check()}invert(){return qG(this,this),this.check()}lerp(t,e,n){return n===void 0?this.lerp(this,t,e):(YG(this,t,e,n),this.check())}multiplyRight(t){return FT(this,this,t),this.check()}multiplyLeft(t){return FT(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,t===0&&(this[3]=1),this.check()}rotateX(t){return zG(this,this,t),this.check()}rotateY(t){return GG(this,this,t),this.check()}rotateZ(t){return VG(this,this,t),this.check()}scale(t){return $G(this,this,t),this.check()}slerp(t,e,n){let i,s,a;switch(arguments.length){case 1:({start:i=eV,target:s,ratio:a}=t);break;case 2:i=this,s=t,a=e;break;default:i=t,s=e,a=n}return C0(this,i,s,a),this.check()}transformVector4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new hb;return UG(e,t,this),Xp(e,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}}const tg={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},UT=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,rV={lightSources:{}};function _b(){let{color:r=[0,0,0],intensity:t=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return r.map(e=>e*t/255)}function nV(r){let{ambientLight:t,pointLights:e=[],directionalLights:n=[]}=r;const i={};return t?i["lighting_uAmbientLight.color"]=_b(t):i["lighting_uAmbientLight.color"]=[0,0,0],e.forEach((s,a)=>{i["lighting_uPointLight[".concat(a,"].color")]=_b(s),i["lighting_uPointLight[".concat(a,"].position")]=s.position,i["lighting_uPointLight[".concat(a,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=e.length,n.forEach((s,a)=>{i["lighting_uDirectionalLight[".concat(a,"].color")]=_b(s),i["lighting_uDirectionalLight[".concat(a,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=n.length,i}function RT(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rV;if("lightSources"in r){const{ambientLight:t,pointLights:e,directionalLights:n}=r.lightSources||{};return t||e&&e.length>0||n&&n.length>0?Object.assign({},nV({ambientLight:t,pointLights:e,directionalLights:n}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in r){const t={pointLights:[],directionalLights:[]};for(const e of r.lights||[])switch(e.type){case"ambient":t.ambientLight=e;break;case"directional":t.directionalLights.push(e);break;case"point":t.pointLights.push(e);break}return RT({lightSources:t})}return{}}const vb={name:"lights",vs:UT,fs:UT,getUniforms:RT,defines:{MAX_LIGHTS:3}},iV={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1};function sV(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:iV;const t={};if(r.pickingSelectedColor!==void 0)if(!r.pickingSelectedColor)t.picking_uSelectedColorValid=0;else{const e=r.pickingSelectedColor.slice(0,3);t.picking_uSelectedColorValid=1,t.picking_uSelectedColor=e}if(r.pickingHighlightColor){const e=Array.from(r.pickingHighlightColor,n=>n/255);Number.isFinite(e[3])||(e[3]=1),t.picking_uHighlightColor=e}return r.pickingActive!==void 0&&(t.picking_uActive=!!r.pickingActive,t.picking_uAttribute=!!r.pickingAttribute),t}const oV={name:"picking",vs:`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,fs:`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,getUniforms:sV},OT=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,aV={};function cV(r){const{ambient:t=.35,diffuse:e=.6,shininess:n=32,specularColor:i=[30,30,30]}=r;return{lighting_uAmbient:t,lighting_uDiffuse:e,lighting_uShininess:n,lighting_uSpecularColor:i.map(s=>s/255)}}function DT(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:aV;if(!("material"in r))return{};const{material:t}=r;return t?cV(t):{lighting_uEnabled:!1}}const lV={name:"gouraud-lighting",dependencies:[vb],vs:OT,defines:{LIGHTING_VERTEX:1},getUniforms:DT},uV={name:"phong-lighting",dependencies:[vb],fs:OT,defines:{LIGHTING_FRAGMENT:1},getUniforms:DT},bb={name:"pbr",vs:`uniform mat4 u_MVPMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_NormalMatrix;

varying vec3 pbr_vPosition;
varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
# ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
# else
varying vec3 pbr_vNormal;
# endif
#endif

void pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)
{
  vec4 pos = u_ModelMatrix * position;
  pbr_vPosition = vec3(pos.xyz) / pos.w;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));
  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));
  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;
  pbr_vTBN = mat3(tangentW, bitangentW, normalW);
#else
  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));
#endif
#endif

#ifdef HAS_UV
  pbr_vUV = uv;
#else
  pbr_vUV = vec2(0.,0.);
#endif
}
`,fs:`#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)
# error PBR fragment shader: Texture LOD is not available
#endif

#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)
# error PBR fragment shader: Derivatives are not available
#endif


#if (__VERSION__ < 300)
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)
#else
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)
#endif

precision highp float;

uniform bool pbr_uUnlit;

#ifdef USE_IBL
uniform samplerCube u_DiffuseEnvSampler;
uniform samplerCube u_SpecularEnvSampler;
uniform sampler2D u_brdfLUT;
uniform vec2 u_ScaleIBLAmbient;
#endif

#ifdef HAS_BASECOLORMAP
uniform sampler2D u_BaseColorSampler;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D u_NormalSampler;
uniform float u_NormalScale;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D u_EmissiveSampler;
uniform vec3 u_EmissiveFactor;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D u_MetallicRoughnessSampler;
#endif
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D u_OcclusionSampler;
uniform float u_OcclusionStrength;
#endif

#ifdef ALPHA_CUTOFF
uniform float u_AlphaCutoff;
#endif

uniform vec2 u_MetallicRoughnessValues;
uniform vec4 u_BaseColorFactor;

uniform vec3 u_Camera;
#ifdef PBR_DEBUG
uniform vec4 u_ScaleDiffBaseMR;
uniform vec4 u_ScaleFGDSpec;
#endif

varying vec3 pbr_vPosition;

varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
#else
varying vec3 pbr_vNormal;
#endif
#endif


struct PBRInfo
{
  float NdotL;
  float NdotV;
  float NdotH;
  float LdotH;
  float VdotH;
  float perceptualRoughness;
  float metalness;
  vec3 reflectance0;
  vec3 reflectance90;
  float alphaRoughness;
  vec3 diffuseColor;
  vec3 specularColor;
  vec3 n;
  vec3 v;
};

const float M_PI = 3.141592653589793;
const float c_MinRoughness = 0.04;

vec4 SRGBtoLINEAR(vec4 srgbIn)
{
#ifdef MANUAL_SRGB
#ifdef SRGB_FAST_APPROXIMATION
  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));
#else
  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);
  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );
#endif
  return vec4(linOut,srgbIn.w);;
#else
  return srgbIn;
#endif
}

vec3 getNormal()
{
#ifndef HAS_TANGENTS
  vec3 pos_dx = dFdx(pbr_vPosition);
  vec3 pos_dy = dFdy(pbr_vPosition);
  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));
  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));
  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);

#ifdef HAS_NORMALS
  vec3 ng = normalize(pbr_vNormal);
#else
  vec3 ng = cross(pos_dx, pos_dy);
#endif

  t = normalize(t - ng * dot(ng, t));
  vec3 b = normalize(cross(ng, t));
  mat3 tbn = mat3(t, b, ng);
#else
  mat3 tbn = pbr_vTBN;
#endif

#ifdef HAS_NORMALMAP
  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;
  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));
#else
  vec3 n = normalize(tbn[2].xyz);
#endif

  return n;
}


#ifdef USE_IBL
vec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)
{
  float mipCount = 9.0;
  float lod = (pbrInputs.perceptualRoughness * mipCount);
  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,
    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;
  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;

#ifdef USE_TEX_LOD
  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;
#else
  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;
#endif

  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;
  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);
  diffuse *= u_ScaleIBLAmbient.x;
  specular *= u_ScaleIBLAmbient.y;

  return diffuse + specular;
}
#endif


vec3 diffuse(PBRInfo pbrInputs)
{
  return pbrInputs.diffuseColor / M_PI;
}

vec3 specularReflection(PBRInfo pbrInputs)
{
  return pbrInputs.reflectance0 +
    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *
    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);
}



float geometricOcclusion(PBRInfo pbrInputs)
{
  float NdotL = pbrInputs.NdotL;
  float NdotV = pbrInputs.NdotV;
  float r = pbrInputs.alphaRoughness;

  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));
  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));
  return attenuationL * attenuationV;
}





float microfacetDistribution(PBRInfo pbrInputs)
{
  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;
  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;
  return roughnessSq / (M_PI * f * f);
}

void PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {
  pbrInputs.NdotL = 1.0;
  pbrInputs.NdotH = 0.0;
  pbrInputs.LdotH = 0.0;
  pbrInputs.VdotH = 1.0;
}

void PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {
  vec3 n = pbrInputs.n;
  vec3 v = pbrInputs.v;
  vec3 l = normalize(lightDirection);
  vec3 h = normalize(l+v);

  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);
  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);
  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);
  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);
}

void PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {
  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);
  PBRInfo_setDirectionalLight(pbrInputs, light_direction);
}

vec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {
  vec3 F = specularReflection(pbrInputs);
  float G = geometricOcclusion(pbrInputs);
  float D = microfacetDistribution(pbrInputs);
  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);
  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);
  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);
}

vec4 pbr_filterColor(vec4 colorUnused)
{
#ifdef HAS_BASECOLORMAP
  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;
#else
  vec4 baseColor = u_BaseColorFactor;
#endif

#ifdef ALPHA_CUTOFF
  if (baseColor.a < u_AlphaCutoff) {
    discard;
  }
#endif

  vec3 color = vec3(0, 0, 0);

  if(pbr_uUnlit){
    color.rgb = baseColor.rgb;
  }
  else{


    float perceptualRoughness = u_MetallicRoughnessValues.y;
    float metallic = u_MetallicRoughnessValues.x;
#ifdef HAS_METALROUGHNESSMAP

    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);
    perceptualRoughness = mrSample.g * perceptualRoughness;
    metallic = mrSample.b * metallic;
#endif
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);
    metallic = clamp(metallic, 0.0, 1.0);

    float alphaRoughness = perceptualRoughness * perceptualRoughness;

    vec3 f0 = vec3(0.04);
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);
    diffuseColor *= 1.0 - metallic;
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);



    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);
    vec3 specularEnvironmentR0 = specularColor.rgb;
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;

    vec3 n = getNormal();
    vec3 v = normalize(u_Camera - pbr_vPosition);

    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);
    vec3 reflection = -normalize(reflect(v, n));

    PBRInfo pbrInputs = PBRInfo(
      0.0,
      NdotV,
      0.0,
      0.0,
      0.0,
      perceptualRoughness,
      metallic,
      specularEnvironmentR0,
      specularEnvironmentR90,
      alphaRoughness,
      diffuseColor,
      specularColor,
      n,
      v
    );

#ifdef USE_LIGHTS
    PBRInfo_setAmbientLight(pbrInputs);
    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {
      if (i < lighting_uDirectionalLightCount) {
        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);
        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);
      }
    }
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {
      if (i < lighting_uPointLightCount) {
        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);
        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));
        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);
      }
    }
#endif
#ifdef USE_IBL
    color += getIBLContribution(pbrInputs, n, reflection);
#endif
#ifdef HAS_OCCLUSIONMAP
    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;
    color = mix(color, color * ao, u_OcclusionStrength);
#endif

#ifdef HAS_EMISSIVEMAP
    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;
    color += emissive;
#endif

#ifdef PBR_DEBUG





    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);
    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);
    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);
#endif

  }

  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);
}
`,defines:{LIGHTING_FRAGMENT:1},dependencies:[vb]},AV={name:"transform",vs:`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,fs:null};class eg{static getDefaultProgramManager(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new eg(t),t.luma.defaultProgramManager}constructor(t){this.gl=t,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(t){this._defaultModules.find(e=>e.name===t.name)||this._defaultModules.push(t),this.stateHash++}removeDefaultModule(t){const e=typeof t=="string"?t:t.name;this._defaultModules=this._defaultModules.filter(n=>n.name!==e),this.stateHash++}addShaderHook(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t),this.stateHash++}get(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:e="",fs:n="",defines:i={},inject:s={},varyings:a=[],bufferMode:o=35981,transpileToGLSL100:A=!1}=t,f=this._getModuleList(t.modules),m=this._getHash(e),b=this._getHash(n),x=f.map(Y=>this._getHash(Y.name)).sort(),C=a.map(Y=>this._getHash(Y)),M=Object.keys(i).sort(),U=Object.keys(s).sort(),N=[],Q=[];for(const Y of M)N.push(this._getHash(Y)),N.push(this._getHash(i[Y]));for(const Y of U)Q.push(this._getHash(Y)),Q.push(this._getHash(s[Y]));const q="".concat(m,"/").concat(b,"D").concat(N.join("/"),"M").concat(x.join("/"),"I").concat(Q.join("/"),"V").concat(C.join("/"),"H").concat(this.stateHash,"B").concat(o).concat(A?"T":"");if(!this._programCache[q]){const Y=v9(this.gl,{vs:e,fs:n,modules:f,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:A});this._programCache[q]=new G5(this.gl,{hash:q,vs:Y.vs,fs:Y.fs,varyings:a,bufferMode:o}),this._getUniforms[q]=Y.getUniforms||(tt=>{}),this._useCounts[q]=0}return this._useCounts[q]++,this._programCache[q]}getUniforms(t){return this._getUniforms[t.hash]||null}release(t){const e=t.hash;this._useCounts[e]--,this._useCounts[e]===0&&(this._programCache[e].delete(),delete this._programCache[e],delete this._getUniforms[e],delete this._useCounts[e])}_getHash(t){return this._hashes[t]===void 0&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}_getModuleList(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=new Array(this._defaultModules.length+t.length),n={};let i=0;for(let s=0,a=this._defaultModules.length;s<a;++s){const o=this._defaultModules[s],A=o.name;e[i++]=o,n[A]=!0}for(let s=0,a=t.length;s<a;++s){const o=t[s],A=o.name;n[A]||(e[i++]=o,n[A]=!0)}return e.length=i,e}}const hV={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function dV(r,t,e){const n={};let i=t.indices;for(const s in t.attributes){const a=t.attributes[s],o=fV(s,e);if(s==="indices")i=a;else if(a.constant)n[o]=a.value;else{const A=a.value,f={...a};delete f.value,n[o]=[new ei(r,A),f],pV(s,f)}}if(i){const s=i.value||i;or(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const a={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};n.indices=[new ei(r,{data:s,target:34963}),a]}return n}function fV(r,t){const{attributeMap:e=hV}=t||{};return e&&e[r]||r}function pV(r,t){let e;switch(r){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":e="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":e="vectors";break}switch(e){case"vectors":t.size=t.size||3;break;case"uvs":t.size=t.size||2;break}or(Number.isFinite(t.size),"attribute ".concat(r," needs size"))}const Vd=2,gV=1e4,mV="Model needs drawMode and vertexCount",kT=()=>{},yV={};class jd{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:n=Cu("model")}=e;or(i0(t)),this.id=n,this.gl=t,this.id=e.id||Cu("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(e)}initialize(t){this.props={},this.programManager=t.programManager||eg.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:e=null,vs:n,fs:i,modules:s,defines:a,inject:o,varyings:A,bufferMode:f,transpileToGLSL100:m}=t;this.programProps={program:e,vs:n,fs:i,modules:s,defines:a,inject:o,varyings:A,bufferMode:f,transpileToGLSL100:m},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(t.moduleSettings))),this.drawMode=t.drawMode!==void 0?t.drawMode:4,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced||t.instanceCount>0,this._setModelProps(t),this.geometry={},or(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),mV)}setProps(t){this._setModelProps(t)}delete(){for(const t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(t){const{program:e,vs:n,fs:i,modules:s,defines:a,inject:o,varyings:A,bufferMode:f,transpileToGLSL100:m}=t;this.programProps={program:e,vs:n,fs:i,modules:s,defines:a,inject:o,varyings:A,bufferMode:f,transpileToGLSL100:m},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(t){return this.drawMode=t,this}setVertexCount(t){return or(Number.isFinite(t)),this.vertexCount=t,this}setInstanceCount(t){return or(Number.isFinite(t)),this.instanceCount=t,this}setGeometry(t){return this.drawMode=t.drawMode,this.vertexCount=t.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=dV(this.gl,t),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Nd(t))return this;const e={};for(const n in t){const i=t[n];e[n]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(e),this}setUniforms(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,t),this}getModuleUniforms(t){this._checkProgram();const e=this.programManager.getUniforms(this.program);return e?e(t):{}}updateModuleSettings(t){const e=this.getModuleUniforms(t||{});return this.setUniforms(e)}clear(t){return Vv(this.program.gl,t),this}draw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:e=null,framebuffer:n,uniforms:i={},attributes:s={},transformFeedback:a=this.transformFeedback,parameters:o={},vertexArray:A=this.vertexArray}=t;this.setAttributes(s),this.updateModuleSettings(e),this.setUniforms(i);let f;mr.priority>=Vd&&(f=this._logDrawCallStart(Vd));const m=this.vertexArray.getDrawParams(),{isIndexed:b=m.isIndexed,indexType:x=m.indexType,indexOffset:C=m.indexOffset,vertexArrayInstanced:M=m.isInstanced}=this.props;M&&!this.isInstanced&&mr.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:U,instanceCount:N}=this,{onBeforeRender:Q=kT,onAfterRender:q=kT}=this.props;Q(),this.program.setUniforms(this.uniforms);const Y=this.program.draw(Object.assign(yV,t,{logPriority:f,uniforms:null,framebuffer:n,parameters:o,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:A,transformFeedback:a,isIndexed:b,indexType:x,isInstanced:U,instanceCount:N,offset:b?C:0}));return q(),mr.priority>=Vd&&this._logDrawCallEnd(f,A,n),Y}transform(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:e=!0,feedbackBuffers:n,unbindModels:i=[]}=t;let{parameters:s}=t;n&&this._setFeedbackBuffers(n),e&&(s=Object.assign({},s,{35977:e})),i.forEach(a=>a.vertexArray.unbindBuffers());try{this.draw(Object.assign({},t,{parameters:s}))}finally{i.forEach(a=>a.vertexArray.bindBuffers())}return this}render(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return mr.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(t).draw()}_setModelProps(t){Object.assign(this.props,t),"uniforms"in t&&this.setUniforms(t.uniforms),"pickable"in t&&(this.pickable=t.pickable),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:e}=this.programProps;if(e)this._managedProgram=!1;else{const{vs:n,fs:i,modules:s,inject:a,defines:o,varyings:A,bufferMode:f,transpileToGLSL100:m}=this.programProps;e=this.programManager.get({vs:n,fs:i,modules:s,inject:a,defines:o,varyings:A,bufferMode:f,transpileToGLSL100:m}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}or(e instanceof G5,"Model needs a program"),this._programDirty=!1,e!==this.program&&(this.program=e,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Rz(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const t in this.geometryBuffers){const e=this.geometryBuffers[t][0]||this.geometryBuffers[t];e instanceof ei&&e.delete()}}_setAnimationProps(t){this.animated&&or(t,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Nd(t))return this;const{gl:e}=this.program;return this.transformFeedback=this.transformFeedback||new V5(e,{program:this.program}),this.transformFeedback.setBuffers(t),this}_logDrawCallStart(t){const e=t>3?0:gV;if(!(Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),mr.group(Vd,">>> DRAWING MODEL ".concat(this.id),{collapsed:mr.level<=2})(),t}_logDrawCallEnd(t,e,n,i){if(t===void 0)return;const s=kz({vertexArray:e,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:a,unusedTable:o,unusedCount:A}=j5({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:f,count:m}=j5({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});m>0&&mr.log("MISSING UNIFORMS",Object.keys(f))(),A>0&&mr.log("UNUSED UNIFORMS",Object.keys(o))();const b=Qz(this.vertexArray.configuration);mr.table(t,s)(),mr.table(t,a)(),mr.table(t+1,b)(),i&&i.log({logLevel:Vd,message:"Rendered to ".concat(i.id)}),mr.groupEnd(Vd)()}}class _V{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=t,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}setupResources(t){for(const e of this.bindings)this._setupTransformFeedback(e,t)}updateModelProps(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:e}=this;return e.length>0&&(t=Object.assign({},t,{varyings:e})),t}getDrawOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:i}=e;return{attributes:Object.assign({},n,t.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(t)}getBuffer(t){const{feedbackBuffers:e}=this.bindings[this.currentIndex],n=t?e[t]:null;return n?n instanceof ei?n:n.buffer:null}getData(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:e}=t,n=this.getBuffer(e);return n?n.getData():null}delete(){for(const t in this.resources)this.resources[t].delete()}_initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&or(pn(this.gl))}_getFeedbackBuffers(t){const{sourceBuffers:e={}}=t,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in e&&(n[s]=i)}Object.assign(n,t.feedbackBuffers);for(const i in n){const s=n[i];if(typeof s=="string"){const a=e[s],{byteLength:o,usage:A,accessor:f}=a;n[i]=this._createNewBuffer(i,{byteLength:o,usage:A,accessor:f})}}return n}_setupBuffers(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:e=null}=t;Object.assign(this.feedbackMap,t.feedbackMap);const n=this._getFeedbackBuffers(t);this._updateBindings({sourceBuffers:e,feedbackBuffers:n})}_setupTransformFeedback(t,e){let{model:n}=e;const{program:i}=n;t.transformFeedback=new V5(this.gl,{program:i,buffers:t.feedbackBuffers})}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this.feedbackMap){const{sourceBuffers:e,feedbackBuffers:n}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:e,feedbackBuffers:n})}}_updateBinding(t,e){return t?(Object.assign(t.sourceBuffers,e.sourceBuffers),Object.assign(t.feedbackBuffers,e.feedbackBuffers),t.transformFeedback&&t.transformFeedback.setBuffers(t.feedbackBuffers),t):{sourceBuffers:Object.assign({},e.sourceBuffers),feedbackBuffers:Object.assign({},e.feedbackBuffers)}}_swapBuffers(t){if(!this.feedbackMap)return null;const e=Object.assign({},t.sourceBuffers),n=Object.assign({},t.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];e[i]=t.feedbackBuffers[s],n[s]=t.sourceBuffers[i],or(n[s]instanceof ei)}return{sourceBuffers:e,feedbackBuffers:n}}_createNewBuffer(t,e){const n=new ei(this.gl,e);return this.resources[t]&&this.resources[t].delete(),this.resources[t]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}const vV="transform_uSampler_",E0="transform_uSize_",NT="transform_position";function bV(r){let{vs:t,sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}=r,a=Object.keys(e).length,o=null;const A={};let f=t,m={};if(a>0||n){const b=f.split(`
`),x=b.slice();if(b.forEach((C,M,U)=>{if(a>0){const N=EV(C,e);if(N){const{updatedLine:Q,inject:q}=N;x[M]=Q,m=rb([m,q]),Object.assign(A,N.samplerTextureMap),a--}}n&&!o&&(o=CV(C,n))}),n){or(i);const C="".concat(E0).concat(n),M="uniform vec2 ".concat(C,`;
`),U="     vec2 ".concat(NT," = transform_getPos(").concat(C,`);
     gl_Position = vec4(`).concat(NT,`, 0, 1.);
`);m=rb([m,{"vs:#decl":M,"vs:#main-start":U}])}f=x.join(`
`)}return{vs:f,targetTextureType:o,inject:m,samplerTextureMap:A}}function wV(r){let{sourceTextureMap:t,targetTextureVarying:e,targetTexture:n}=r;const i={};let s,a;e&&({width:s,height:a}=n,i["".concat(E0).concat(e)]=[s,a]);for(const o in t)({width:s,height:a}=t[o]),i["".concat(E0).concat(o)]=[s,a];return i}function xV(r){return cT(r,["attribute","in"])}function BV(r){const t="".concat(vV).concat(r),e="".concat(E0).concat(r),n="  uniform sampler2D ".concat(t,`;
  uniform vec2 `).concat(e,";");return{samplerName:t,sizeName:e,uniformDeclerations:n}}function CV(r,t){const e=cT(r,["varying","out"]);return e&&e.name===t?e.type:null}function EV(r,t){const e={},n=xV(r);if(!n)return null;const{type:i,name:s}=n;if(s&&t[s]){const a="// ".concat(r," => Replaced by Transform with a sampler"),{samplerName:o,sizeName:A,uniformDeclerations:f}=BV(s),m=I9(i),b="  ".concat(i," ").concat(s," = transform_getInput(").concat(o,", ").concat(A,").").concat(m,`;
`);return e[o]=s,{updatedLine:a,inject:{"vs:#decl":f,"vs:#main-start":b},samplerTextureMap:e}}return null}const SV={10241:9728,10240:9728,10242:33071,10243:33071},TV="transform_output";class IV{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=t,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}updateModelProps(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=this._processVertexShader(t);return Object.assign({},t,e)}getDrawOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:e,sourceTextures:n,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],a=Object.assign({},e,t.attributes),o=Object.assign({},t.uniforms),A=Object.assign({},t.parameters);let f=t.discard;if(this.hasSourceTextures||this.hasTargetTexture){a.transform_elementID=this.elementIDBuffer;for(const b in this.samplerTextureMap){const x=this.samplerTextureMap[b];o[b]=n[x]}this._setSourceTextureParameters();const m=wV({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(o,m)}return this.hasTargetTexture&&(f=!1,A.viewport=[0,0,i.width,i.height]),{attributes:a,framebuffer:i,uniforms:o,discard:f,parameters:A}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(t)}getTargetTexture(){const{targetTexture:t}=this.bindings[this.currentIndex];return t}getData(){let{packed:t=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:e}=this.bindings[this.currentIndex],n=o0(e);if(!t)return n;const i=n.constructor,s=L9(this.targetTextureType),a=new i(n.length*s/4);let o=0;for(let A=0;A<n.length;A+=4)for(let f=0;f<s;f++)a[o++]=n[A+f];return a}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:e,_swapTexture:n}=t;this._swapTexture=n,this.targetTextureVarying=e,this.hasTargetTexture=e,this._setupTextures(t)}_createTargetTexture(t){const{sourceTextures:e,textureOrReference:n}=t;if(n instanceof Ta)return n;const i=e[n];return i?(this._targetRefTexName=n,this._createNewTexture(i)):null}_setupTextures(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:e,_sourceTextures:n={},_targetTexture:i}=t,s=this._createTargetTexture({sourceTextures:n,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:e,sourceTextures:n,targetTexture:s}),"elementCount"in t&&this._updateElementIDBuffer(t.elementCount)}_updateElementIDBuffer(t){if(typeof t!="number"||this.elementCount>=t)return;const e=new Float32Array(t);e.forEach((n,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new ei(this.gl,{data:e,accessor:{size:1}}),this.elementCount=t}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this._swapTexture){const{sourceTextures:e,targetTexture:n}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:e,targetTexture:n})}}_updateBinding(t,e){const{sourceBuffers:n,sourceTextures:i,targetTexture:s}=e;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,i),Object.assign(t.sourceBuffers,n),s){t.targetTexture=s;const{width:a,height:o}=s,{framebuffer:A}=t;A?(A.update({attachments:{36064:s},resizeAttachments:!1}),A.resize({width:a,height:o})):t.framebuffer=new vs(this.gl,{id:"transform-framebuffer",width:a,height:o,attachments:{36064:s}})}return t}_setSourceTextureParameters(){const t=this.currentIndex,{sourceTextures:e}=this.bindings[t];for(const n in e)e[n].setParameters(SV)}_swapTextures(t){if(!this._swapTexture)return null;const e=Object.assign({},t.sourceTextures);e[this._swapTexture]=t.targetTexture;const n=t.sourceTextures[this._swapTexture];return{sourceTextures:e,targetTexture:n}}_createNewTexture(t){const e=BH(t,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=e,e}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:e,targetTexture:n}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:a,inject:o,samplerTextureMap:A}=bV({vs:t.vs,sourceTextureMap:e,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),f=rb([t.inject||{},o]);this.targetTextureType=a,this.samplerTextureMap=A;const m=t._fs||lT({version:O5(i),input:this.targetTextureVarying,inputType:a,output:TV}),b=this.hasSourceTextures||this.targetTextureVarying?[AV].concat(t.modules||[]):t.modules;return{vs:i,fs:m,modules:b,uniforms:s,inject:f}}}class wb{static isSupported(t){return pn(t)}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=t,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(e),Object.seal(this)}delete(){const{model:t,bufferTransform:e,textureTransform:n}=this;t&&t.delete(),e&&e.delete(),n&&n.delete()}run(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:e=!0}=t,n=this._updateDrawOptions(t);e&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let t=!1;const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)t=t||n.swap();or(t,"Nothing to swap")}getBuffer(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(t)}getData(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e){const i=n.getData(t);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in t&&this.model.setVertexCount(t.elementCount);const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)n.update(t)}_initialize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:e}=this;this._buildResourceTransforms(e,t),t=this._updateModelProps(t),this.model=new jd(e,Object.assign({},t,{fs:t.fs||lT({version:O5(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=i.updateModelProps(e);return e}_buildResourceTransforms(t,e){LV(e)&&(this.bufferTransform=new _V(t,e)),FV(e)&&(this.textureTransform=new IV(t,e)),or(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=Object.assign(e,i.getDrawOptions(e));return e}}function LV(r){return!!(!Nd(r.feedbackBuffers)||!Nd(r.feedbackMap)||r.varyings&&r.varyings.length>0)}function FV(r){return!!(!Nd(r._sourceTextures)||r._targetTexture||r._targetTextureVarying)}const QT={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class rg{static get DRAW_MODE(){return QT}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:e=Cu("geometry"),drawMode:n=QT.TRIANGLES,attributes:i={},indices:s=null,vertexCount:a=null}=t;this.id=e,this.drawMode=n|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=a||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return"Geometry ".concat(this.id," attribute ").concat(t)}_setAttributes(t,e){e&&(this.indices=ArrayBuffer.isView(e)?{value:e,size:1}:e);for(const n in t){let i=t[n];i=ArrayBuffer.isView(i)?{value:i}:i,or(ArrayBuffer.isView(i.value),"".concat(this._print(n),": must be typed array or object with value as typed array")),(n==="POSITION"||n==="positions")&&!i.size&&(i.size=3),n==="indices"?(or(!this.indices),this.indices=i):this.attributes[n]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(t,e){if(e)return e.value.length;let n=1/0;for(const i in t){const s=t[i],{value:a,size:o,constant:A}=s;!A&&a&&o>=1&&(n=Math.min(n,a.length/o))}return or(Number.isFinite(n)),n}}let MV=1,PV=1;class HT{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(t){const{delay:e=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=t,a=MV++,o={time:0,delay:e,duration:n,rate:i,repeat:s};return this._setChannelTime(o,this.time),this.channels.set(a,o),a}removeChannel(t){this.channels.delete(t);for(const[e,n]of this.animations)n.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return e===void 0?!1:this.time>=e.delay+e.duration*e.repeat}getTime(t){if(t===void 0)return this.time;const e=this.channels.get(t);return e===void 0?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const i of e)this._setChannelTime(i,this.time);const n=this.animations.values();for(const i of n){const{animation:s,channel:a}=i;s.setTime(this.getTime(a))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,e){const n=PV++;return this.animations.set(n,{animation:t,channel:e}),t.setTime(this.getTime(e)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const n=e-t.delay,i=t.duration*t.repeat;n>=i?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}}const UV=[255,255,255],RV=1;let OV=0;class zT{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W(this,"id",void 0),W(this,"color",void 0),W(this,"intensity",void 0),W(this,"type","ambient");const{color:e=UV}=t,{intensity:n=RV}=t;this.id=t.id||"ambient-".concat(OV++),this.color=e,this.intensity=n}}const DV=[255,255,255],kV=1,NV=[0,0,-1];let QV=0;class GT{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W(this,"id",void 0),W(this,"color",void 0),W(this,"intensity",void 0),W(this,"type","directional"),W(this,"direction",void 0),W(this,"shadow",void 0);const{color:e=DV}=t,{intensity:n=kV}=t,{direction:i=NV}=t,{_shadow:s=!1}=t;this.id=t.id||"directional-".concat(QV++),this.color=e,this.intensity=n,this.type="directional",this.direction=new le(i).normalize().toArray(),this.shadow=s}getProjectedLight(t){return this}}class HV{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{id:"pass"};W(this,"id",void 0),W(this,"gl",void 0),W(this,"props",void 0);const{id:n}=e;this.id=n,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(t){}cleanup(){}}class xb extends HV{constructor(){super(...arguments),W(this,"_lastRenderIndex",-1)}render(t){const e=this.gl;return Bu(e,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{target:e,moduleParameters:n,viewports:i,views:s,onViewportActive:a,clearStack:o=!0,clearCanvas:A=!0}=t;t.pass=t.pass||"unknown";const f=this.gl;A&&GV(f,e),o&&(this._lastRenderIndex=-1);const m=[];for(const b of i){const x=s&&s[b.id];a==null||a(b);const C=this._getDrawLayerParams(b,t),M=b.subViewports||[b];for(const U of M){const N=this._drawLayersInViewport(f,{target:e,moduleParameters:n,viewport:U,view:x,pass:t.pass,layers:t.layers},C);m.push(N)}}return m}_getDrawLayerParams(t,e){let{layers:n,pass:i,isPicking:s=!1,layerFilter:a,cullRect:o,effects:A,moduleParameters:f}=e,m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const b=[],x=VT(this._lastRenderIndex+1),C={layer:n[0],viewport:t,isPicking:s,renderPass:i,cullRect:o},M={};for(let U=0;U<n.length;U++){const N=n[U],Q=this._shouldDrawLayer(N,C,a,M),q={shouldDrawLayer:Q};Q&&!m&&(q.layerRenderIndex=x(N,Q),q.moduleParameters=this._getModuleParameters(N,A,i,f),q.layerParameters=this.getLayerParameters(N,U,t)),b[U]=q}return b}_drawLayersInViewport(t,e,n){let{layers:i,moduleParameters:s,pass:a,target:o,viewport:A,view:f}=e;const m=zV(t,{moduleParameters:s,target:o,viewport:A});if(f&&f.props.clear){const x=f.props.clear===!0?{color:!0,depth:!0}:f.props.clear;Oc(t,{scissorTest:!0,scissor:m},()=>Vv(t,x))}const b={totalCount:i.length,visibleCount:0,compositeCount:0,pickableCount:0};Bu(t,{viewport:m});for(let x=0;x<i.length;x++){const C=i[x],{shouldDrawLayer:M,layerRenderIndex:U,moduleParameters:N,layerParameters:Q}=n[x];if(M&&C.props.pickable&&b.pickableCount++,C.isComposite)b.compositeCount++;else if(M){b.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,U),N.viewport=A;try{C._drawLayer({moduleParameters:N,uniforms:{layerIndex:U},parameters:Q})}catch(q){C.raiseError(q,"drawing ".concat(C," to ").concat(a))}}}return b}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e,n){return t.props.parameters}_shouldDrawLayer(t,e,n,i){if(!(t.props.visible&&this.shouldDrawLayer(t)))return!1;e.layer=t;let a=t.parent;for(;a;){if(!a.props.visible||!a.filterSubLayer(e))return!1;e.layer=a,a=a.parent}if(n){const o=e.layer.id;if(o in i||(i[o]=n(e)),!i[o])return!1}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,i){var s;const a=Object.assign(Object.create(((s=t.internalState)===null||s===void 0?void 0:s.propsInTransition)||t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:kd(this.gl)});if(e)for(const A of e){var o;Object.assign(a,(o=A.getModuleParameters)===null||o===void 0?void 0:o.call(A,t))}return Object.assign(a,this.getModuleParameters(t,e),i)}}function VT(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e={},n=(i,s)=>{const a=i.props._offset,o=i.id,A=i.parent&&i.parent.id;let f;if(A&&!(A in t)&&n(i.parent,!1),A in e){const m=e[A]=e[A]||VT(t[A],t);f=m(i,s),e[o]=m}else Number.isFinite(a)?(f=a+(t[A]||0),e[o]=null):f=r;return s&&f>=r&&(r=f+1),t[o]=f,f};return n}function zV(r,t){let{moduleParameters:e,target:n,viewport:i}=t;const s=n&&n.id!=="default-framebuffer",a=e&&e.devicePixelRatio||kd(r),o=s?n.height:r.drawingBufferHeight,A=i;return[A.x*a,o-(A.y+A.height)*a,A.width*a,A.height*a]}function GV(r,t){const e=t?t.width:r.drawingBufferWidth,n=t?t.height:r.drawingBufferHeight;Bu(r,{viewport:[0,0,e,n]}),r.clear(16640)}class VV extends xb{constructor(t,e){super(t,e),W(this,"shadowMap",void 0),W(this,"depthBuffer",void 0),W(this,"fbo",void 0),this.shadowMap=new Ta(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new zd(t,{format:33189,width:1,height:1}),this.fbo=new vs(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(t){const e=this.fbo;Oc(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const n=t.viewports[0],i=kd(this.gl),s=n.width*i,a=n.height*i;(s!==e.width||a!==e.height)&&e.resize({width:s,height:a}),super.render({...t,target:e,pass:"shadow"})})}shouldDrawLayer(t){return t.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const jT="#define SMOOTH_EDGE_RADIUS 0.5",jV=`
`.concat(jT,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),qV=`
`.concat(jT,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),KV={name:"geometry",vs:jV,fs:qV},WV=Object.keys(Sn).map(r=>"const int COORDINATE_SYSTEM_".concat(r," = ").concat(Sn[r],";")).join(""),$V=Object.keys(Dl).map(r=>"const int PROJECTION_MODE_".concat(r," = ").concat(Dl[r],";")).join(""),XV=Object.keys(Fv).map(r=>"const int UNIT_".concat(r.toUpperCase()," = ").concat(Fv[r],";")).join(""),YV="".concat(WV,`
`).concat($V,`
`).concat(XV,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function JV(r,t){if(r===t)return!0;if(Array.isArray(r)){const e=r.length;if(!t||t.length!==e)return!1;for(let n=0;n<e;n++)if(r[n]!==t[n])return!1;return!0}return!1}function ng(r){let t={},e;return n=>{for(const i in n)if(!JV(n[i],t[i])){e=r(n),t=n;break}return e}}const qT=[0,0,0,0],ZV=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],KT=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],tj=[0,0,0],WT=[0,0,0],ej=ng(ij);function $T(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:WT;e.length<3&&(e=[e[0],e[1],0]);let n=e,i,s=!0;switch(t===Sn.LNGLAT_OFFSETS||t===Sn.METER_OFFSETS?i=e:i=r.isGeospatial?[Math.fround(r.longitude),Math.fround(r.latitude),0]:null,r.projectionMode){case Dl.WEB_MERCATOR:(t===Sn.LNGLAT||t===Sn.CARTESIAN)&&(i=[0,0,0],s=!1);break;case Dl.WEB_MERCATOR_AUTO_OFFSET:t===Sn.LNGLAT?n=i:t===Sn.CARTESIAN&&(n=[Math.fround(r.center[0]),Math.fround(r.center[1]),0],i=r.unprojectPosition(n),n[0]-=e[0],n[1]-=e[1],n[2]-=e[2]);break;case Dl.IDENTITY:n=r.position.map(Math.fround),n[2]=n[2]||0;break;case Dl.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:n,offsetMode:s}}function rj(r,t,e){const{viewMatrixUncentered:n,projectionMatrix:i}=r;let{viewMatrix:s,viewProjectionMatrix:a}=r,o=qT,A=qT,f=r.cameraPosition;const{geospatialOrigin:m,shaderCoordinateOrigin:b,offsetMode:x}=$T(r,t,e);return x&&(A=r.projectPosition(m||b),f=[f[0]-A[0],f[1]-A[1],f[2]-A[2]],A[3]=1,o=Jp([],A,a),s=n||s,a=Fh([],i,s),a=Fh([],a,ZV)),{viewMatrix:s,viewProjectionMatrix:a,projectionCenter:o,originCommon:A,cameraPosCommon:f,shaderCoordinateOrigin:b,geospatialOrigin:m}}function nj(r){let{viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=Sn.DEFAULT,coordinateOrigin:s=WT,autoWrapLongitude:a=!1}=r;i===Sn.DEFAULT&&(i=t.isGeospatial?Sn.LNGLAT:Sn.CARTESIAN);const o=ej({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:s});return o.project_uWrapLongitude=a,o.project_uModelMatrix=n||KT,o}function ij(r){let{viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i}=r;const{projectionCenter:s,viewProjectionMatrix:a,originCommon:o,cameraPosCommon:A,shaderCoordinateOrigin:f,geospatialOrigin:m}=rj(t,n,i),b=t.getDistanceScales(),x=[t.width*e,t.height*e],C=Jp([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,M={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:f,project_uCommonOrigin:o.slice(0,3),project_uCenter:s,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:x,project_uDevicePixelRatio:e,project_uFocalDistance:C,project_uCommonUnitsPerMeter:b.unitsPerMeter,project_uCommonUnitsPerWorldUnit:b.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:tj,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:a,project_uModelMatrix:KT,project_uCameraPosition:A};if(m){const U=t.getDistanceScales(m);switch(n){case Sn.METER_OFFSETS:M.project_uCommonUnitsPerWorldUnit=U.unitsPerMeter,M.project_uCommonUnitsPerWorldUnit2=U.unitsPerMeter2;break;case Sn.LNGLAT:case Sn.LNGLAT_OFFSETS:t._pseudoMeters||(M.project_uCommonUnitsPerMeter=U.unitsPerMeter),M.project_uCommonUnitsPerWorldUnit=U.unitsPerDegree,M.project_uCommonUnitsPerWorldUnit2=U.unitsPerDegree2;break;case Sn.CARTESIAN:M.project_uCommonUnitsPerWorldUnit=[1,1,U.unitsPerMeter[2]],M.project_uCommonUnitsPerWorldUnit2=[0,0,U.unitsPerMeter2[2]];break}}return M}const sj={};function oj(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sj;return"viewport"in r?nj(r):{}}const Bb={name:"project",dependencies:[M9,KV],vs:YV,getUniforms:oj};function aj(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function qd(r,t){const e=Jp([],t,r);return ST(e,e,1/e[3]),e}function XT(r,t){const e=r%t;return e<0?t+e:e}function Cb(r,t,e){return r<t?t:r>e?e:r}function cj(r){return Math.log(r)*Math.LOG2E}const Eb=Math.log2||cj;function Lu(r,t){if(!r)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const Qc=Math.PI,YT=Qc/4,ec=Qc/180,Sb=180/Qc,Kd=512,S0=4003e4,T0=85.051129,lj=1.5;function uj(r){return Eb(r)}function ig(r){const[t,e]=r;Lu(Number.isFinite(t)),Lu(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude");const n=t*ec,i=e*ec,s=Kd*(n+Qc)/(2*Qc),a=Kd*(Qc+Math.log(Math.tan(YT+i*.5)))/(2*Qc);return[s,a]}function Wd(r){const[t,e]=r,n=t/Kd*(2*Qc)-Qc,i=2*(Math.atan(Math.exp(e/Kd*(2*Qc)-Qc))-YT);return[n*Sb,i*Sb]}function Aj(r){const{latitude:t}=r;Lu(Number.isFinite(t));const e=Math.cos(t*ec);return uj(S0*e)-9}function I0(r){const t=Math.cos(r*ec);return Kd/S0/t}function Tb(r){const{latitude:t,longitude:e,highPrecision:n=!1}=r;Lu(Number.isFinite(t)&&Number.isFinite(e));const i=Kd,s=Math.cos(t*ec),a=i/360,o=a/s,A=i/S0/s,f={unitsPerMeter:[A,A,A],metersPerUnit:[1/A,1/A,1/A],unitsPerDegree:[a,o,A],degreesPerUnit:[1/a,1/o,1/A]};if(n){const m=ec*Math.tan(t*ec)/s,b=a*m/2,x=i/S0*m,C=x/o*A;f.unitsPerDegree2=[0,b,x],f.unitsPerMeter2=[C,0,C]}return f}function JT(r,t){const[e,n,i]=r,[s,a,o]=t,{unitsPerMeter:A,unitsPerMeter2:f}=Tb({longitude:e,latitude:n,highPrecision:!0}),m=ig(r);m[0]+=s*(A[0]+f[0]*a),m[1]+=a*(A[1]+f[1]*a);const b=Wd(m),x=(i||0)+(o||0);return Number.isFinite(i)||Number.isFinite(o)?[b[0],b[1],x]:b}function hj(r){const{height:t,pitch:e,bearing:n,altitude:i,scale:s,center:a}=r,o=aj();w0(o,o,[0,0,-i]),CT(o,o,-e*ec),ET(o,o,n*ec);const A=s/t;return pb(o,o,[A,A,A]),a&&w0(o,o,X9([],a)),o}function dj(r){const{width:t,height:e,altitude:n,pitch:i=0,offset:s,center:a,scale:o,nearZMultiplier:A=1,farZMultiplier:f=1}=r;let{fovy:m=L0(lj)}=r;n!==void 0&&(m=L0(n));const b=m*ec,x=i*ec,C=ZT(m);let M=C;a&&(M+=a[2]*o/Math.cos(x)/e);const U=b*(.5+(s?s[1]:0)/e),N=Math.sin(U)*M/Math.sin(Cb(Math.PI/2-x-U,.01,Math.PI-.01)),Q=Math.sin(x)*N+M,q=M*10,Y=Math.min(Q*f,q);return{fov:b,aspect:t/e,focalDistance:C,near:A,far:Y}}function L0(r){return 2*Math.atan(.5/r)*Sb}function ZT(r){return .5/Math.tan(.5*r*ec)}function t3(r,t){const[e,n,i=0]=r;return Lu(Number.isFinite(e)&&Number.isFinite(n)&&Number.isFinite(i)),qd(t,[e,n,i,1])}function Ib(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const[n,i,s]=r;if(Lu(Number.isFinite(n)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return qd(t,[n,i,s,1]);const a=qd(t,[n,i,0,1]),o=qd(t,[n,i,1,1]),A=a[2],f=o[2],m=A===f?0:((e||0)-A)/(f-A);return AT([],a,o,m)}function fj(r){const{width:t,height:e,bounds:n,minExtent:i=0,maxZoom:s=24,offset:a=[0,0]}=r,[[o,A],[f,m]]=n,b=pj(r.padding),x=ig([o,Cb(m,-T0,T0)]),C=ig([f,Cb(A,-T0,T0)]),M=[Math.max(Math.abs(C[0]-x[0]),i),Math.max(Math.abs(C[1]-x[1]),i)],U=[t-b.left-b.right-Math.abs(a[0])*2,e-b.top-b.bottom-Math.abs(a[1])*2];Lu(U[0]>0&&U[1]>0);const N=U[0]/M[0],Q=U[1]/M[1],q=(b.right-b.left)/2/N,Y=(b.top-b.bottom)/2/Q,tt=[(C[0]+x[0])/2+q,(C[1]+x[1])/2+Y],ft=Wd(tt),pt=Math.min(s,Eb(Math.abs(Math.min(N,Q))));return Lu(Number.isFinite(pt)),{longitude:ft[0],latitude:ft[1],zoom:pt}}function pj(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return typeof r=="number"?{top:r,bottom:r,left:r,right:r}:(Lu(Number.isFinite(r.top)&&Number.isFinite(r.bottom)&&Number.isFinite(r.left)&&Number.isFinite(r.right)),r)}const e3=Math.PI/180;function gj(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const{width:e,height:n,unproject:i}=r,s={targetZ:t},a=i([0,n],s),o=i([e,n],s);let A,f;const m=r.fovy?.5*r.fovy*e3:Math.atan(.5/r.altitude),b=(90-r.pitch)*e3;return m>b-.01?(A=r3(r,0,t),f=r3(r,e,t)):(A=i([0,0],s),f=i([e,0],s)),[a,o,f,A]}function r3(r,t,e){const{pixelUnprojectionMatrix:n}=r,i=qd(n,[t,0,1,1]),s=qd(n,[t,r.height,1,1]),o=(e*r.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),A=AT([],i,s,o),f=Wd(A);return f.push(e),f}const n3=512;function mj(r){const{width:t,height:e,pitch:n=0}=r;let{longitude:i,latitude:s,zoom:a,bearing:o=0}=r;(i<-180||i>180)&&(i=XT(i+180,360)-180),(o<-180||o>180)&&(o=XT(o+180,360)-180);const A=Eb(e/n3);if(a<=A)a=A,s=0;else{const f=e/2/Math.pow(2,a),m=Wd([0,f])[1];if(s<m)s=m;else{const b=Wd([0,n3-f])[1];s>b&&(s=b)}}return{width:t,height:e,longitude:i,latitude:s,zoom:a,pitch:n,bearing:o}}const yj=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,_j=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,vj=ng(Cj),bj=ng(Ej),wj=[0,0,0,1],xj=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function Bj(r,t){const[e,n,i]=r,s=Ib([e,n,i],t);return Number.isFinite(i)?s:[s[0],s[1],0]}function Cj(r){let{viewport:t,center:e}=r;return new xn(t.viewProjectionMatrix).invert().transform(e)}function Ej(r){let{viewport:t,shadowMatrices:e}=r;const n=[],i=t.pixelUnprojectionMatrix,s=t.isGeospatial?void 0:1,a=[[0,0,s],[t.width,0,s],[0,t.height,s],[t.width,t.height,s],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>Bj(o,i));for(const o of e){const A=o.clone().translate(new le(t.center).negate()),f=a.map(b=>A.transform(b)),m=new xn().ortho({left:Math.min(...f.map(b=>b[0])),right:Math.max(...f.map(b=>b[0])),bottom:Math.min(...f.map(b=>b[1])),top:Math.max(...f.map(b=>b[1])),near:Math.min(...f.map(b=>-b[2])),far:Math.max(...f.map(b=>-b[2]))});n.push(m.multiplyRight(o))}return n}function Sj(r,t){const{shadowEnabled:e=!0}=r;if(!e||!r.shadowMatrices||!r.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const n={shadow_uDrawShadowMap:!!r.drawToShadowMap,shadow_uUseShadowMap:r.shadowMaps?r.shadowMaps.length>0:!1,shadow_uColor:r.shadowColor||wj,shadow_uLightId:r.shadowLightId||0,shadow_uLightCount:r.shadowMatrices.length},i=vj({viewport:r.viewport,center:t.project_uCenter}),s=[],a=bj({shadowMatrices:r.shadowMatrices,viewport:r.viewport}).slice();for(let o=0;o<r.shadowMatrices.length;o++){const A=a[o],f=A.clone().translate(new le(r.viewport.center).negate());t.project_uCoordinateSystem===Sn.LNGLAT&&t.project_uProjectionMode===Dl.WEB_MERCATOR?(a[o]=f,s[o]=i):(a[o]=A.clone().multiplyRight(xj),s[o]=f.transform(i))}for(let o=0;o<a.length;o++)n["shadow_uViewProjectionMatrices[".concat(o,"]")]=a[o],n["shadow_uProjectCenters[".concat(o,"]")]=s[o],r.shadowMaps&&r.shadowMaps.length>0?n["shadow_uShadowMap".concat(o)]=r.shadowMaps[o]:n["shadow_uShadowMap".concat(o)]=r.dummyShadowMap;return n}const Lb={name:"shadow",dependencies:[Bb],vs:yj,fs:_j,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"viewport"in r&&(r.drawToShadowMap||r.shadowMaps&&r.shadowMaps.length>0)?Sj(r,t):{}}},Tj={color:[255,255,255],intensity:1},i3=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Ij=[0,0,0,200/255];class Fb{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W(this,"id","lighting-effect"),W(this,"props",void 0),W(this,"shadowColor",Ij),W(this,"shadow",void 0),W(this,"ambientLight",void 0),W(this,"directionalLights",void 0),W(this,"pointLights",void 0),W(this,"shadowPasses",[]),W(this,"shadowMaps",[]),W(this,"dummyShadowMap",null),W(this,"programManager",void 0),W(this,"shadowMatrices",void 0),this.setProps(t)}setProps(t){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(e=>e.shadow),this.props=t}preRender(t,e){let{layers:n,layerFilter:i,viewports:s,onViewportActive:a,views:o}=e;if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(t),this.programManager||(this.programManager=eg.getDefaultProgramManager(t),Lb&&this.programManager.addDefaultModule(Lb)),this.dummyShadowMap||(this.dummyShadowMap=new Ta(t,{width:1,height:1}));for(let A=0;A<this.shadowPasses.length;A++)this.shadowPasses[A].render({layers:n,layerFilter:i,viewports:s,onViewportActive:a,views:o,moduleParameters:{shadowLightId:A,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(n=>n.getProjectedLight({layer:t})),pointLights:this.pointLights.map(n=>n.getProjectedLight({layer:t}))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Lb),this.programManager=null)}_calculateMatrices(){const t=[];for(const e of this.directionalLights){const n=new xn().lookAt({eye:new le(e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new VV(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;!t&&e.length===0&&n.length===0&&(this.ambientLight=new zT(Tj),this.directionalLights.push(new GT(i3[0]),new GT(i3[1])))}}class Lj{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W(this,"_pool",[]),W(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(t)}setOptions(t){Object.assign(this.opts,t)}allocate(t,e,n){let{size:i=1,type:s,padding:a=0,copy:o=!1,initialize:A=!1,maxCount:f}=n;const m=s||t&&t.constructor||Float32Array,b=e*i+a;if(ArrayBuffer.isView(t)){if(b<=t.length)return t;if(b*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new m(t.buffer,0,b)}let x=1/0;f&&(x=f*i+a);const C=this._allocate(m,b,A,x);return t&&o?C.set(t):A||C.fill(0,0,4),this._release(t),C}release(t){this._release(t)}_allocate(t,e,n,i){let s=Math.max(Math.ceil(e*this.opts.overAlloc),1);s>i&&(s=i);const a=this._pool,o=t.BYTES_PER_ELEMENT*s,A=a.findIndex(f=>f.byteLength>=o);if(A>=0){const f=new t(a.splice(A,1)[0],0,s);return n&&f.fill(0),f}return new t(s)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:i}=n,s=e.findIndex(a=>a.byteLength>=i);s<0?e.push(n):(s>0||e.length<this.opts.poolSize)&&e.splice(s,0,n),e.length>this.opts.poolSize&&e.shift()}}const sg=new Lj;function og(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Fj(r){return[r[12],r[13],r[14]]}function Mj(r){return{left:$d(r[3]+r[0],r[7]+r[4],r[11]+r[8],r[15]+r[12]),right:$d(r[3]-r[0],r[7]-r[4],r[11]-r[8],r[15]-r[12]),bottom:$d(r[3]+r[1],r[7]+r[5],r[11]+r[9],r[15]+r[13]),top:$d(r[3]-r[1],r[7]-r[5],r[11]-r[9],r[15]-r[13]),near:$d(r[3]+r[2],r[7]+r[6],r[11]+r[10],r[15]+r[14]),far:$d(r[3]-r[2],r[7]-r[6],r[11]-r[10],r[15]-r[14])}}const s3=new le;function $d(r,t,e,n){s3.set(r,t,e);const i=s3.len();return{distance:n/i,normal:new le(-r/i,-t/i,-e/i)}}function Pj(r){return r-Math.fround(r)}let ag;function Mb(r,t){const{size:e=1,startIndex:n=0}=t,i=t.endIndex!==void 0?t.endIndex:r.length,s=(i-n)/e;ag=sg.allocate(ag,s,{type:Float32Array,size:e*2});let a=n,o=0;for(;a<i;){for(let A=0;A<e;A++){const f=r[a++];ag[o+A]=f,ag[o+A+e]=Pj(f)}o+=e*2}return ag.subarray(0,s*e*2)}function Uj(r){let t=null,e=!1;for(const n of r)n&&(t?(e||(t=[[t[0][0],t[0][1]],[t[1][0],t[1][1]]],e=!0),t[0][0]=Math.min(t[0][0],n[0][0]),t[0][1]=Math.min(t[0][1],n[0][1]),t[1][0]=Math.max(t[1][0],n[1][0]),t[1][1]=Math.max(t[1][1],n[1][1])):t=n);return t}const Rj=Math.PI/180,Oj=og(),o3=[0,0,0],Dj={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function kj(r){let{width:t,height:e,orthographic:n,fovyRadians:i,focalDistance:s,padding:a,near:o,far:A}=r;const f=t/e,m=n?new xn().orthographic({fovy:i,aspect:f,focalDistance:s,near:o,far:A}):new xn().perspective({fovy:i,aspect:f,near:o,far:A});if(a){const{left:b=0,right:x=0,top:C=0,bottom:M=0}=a,U=Iu((b+t-x)/2,0,t)-t/2,N=Iu((C+e-M)/2,0,e)-e/2;m[8]-=U*2/t,m[9]+=N*2/e}return m}class Xd{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W(this,"id",void 0),W(this,"x",void 0),W(this,"y",void 0),W(this,"width",void 0),W(this,"height",void 0),W(this,"padding",void 0),W(this,"isGeospatial",void 0),W(this,"zoom",void 0),W(this,"focalDistance",void 0),W(this,"position",void 0),W(this,"modelMatrix",void 0),W(this,"distanceScales",void 0),W(this,"scale",void 0),W(this,"center",void 0),W(this,"cameraPosition",void 0),W(this,"projectionMatrix",void 0),W(this,"viewMatrix",void 0),W(this,"viewMatrixUncentered",void 0),W(this,"viewMatrixInverse",void 0),W(this,"viewProjectionMatrix",void 0),W(this,"pixelProjectionMatrix",void 0),W(this,"pixelUnprojectionMatrix",void 0),W(this,"resolution",void 0),W(this,"_frustumPlanes",{}),this.id=t.id||this.constructor.displayName||"viewport",this.x=t.x||0,this.y=t.y||0,this.width=t.width||1,this.height=t.height||1,this.zoom=t.zoom||0,this.padding=t.padding,this.distanceScales=t.distanceScales||Dj,this.focalDistance=t.focalDistance||1,this.position=t.position||o3,this.modelMatrix=t.modelMatrix||null;const{longitude:e,latitude:n}=t;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(e),this._initProps(t),this._initMatrices(t),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Dl.WEB_MERCATOR:Dl.WEB_MERCATOR_AUTO_OFFSET:Dl.IDENTITY}equals(t){return t instanceof Xd?this===t?!0:t.width===this.width&&t.height===this.height&&t.scale===this.scale&&kc(t.projectionMatrix,this.projectionMatrix)&&kc(t.viewMatrix,this.viewMatrix):!1}project(t){let{topLeft:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=this.projectPosition(t),i=t3(n,this.pixelProjectionMatrix),[s,a]=i,o=e?a:this.height-a;return t.length===2?[s,o]:[s,o,i[2]]}unproject(t){let{topLeft:e=!0,targetZ:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const[i,s,a]=t,o=e?s:this.height-s,A=n&&n*this.distanceScales.unitsPerMeter[2],f=Ib([i,o,a],this.pixelUnprojectionMatrix,A),[m,b,x]=this.unprojectPosition(f);return Number.isFinite(a)?[m,b,x]:Number.isFinite(n)?[m,b,n]:[m,b]}projectPosition(t){const[e,n]=this.projectFlat(t),i=(t[2]||0)*this.distanceScales.unitsPerMeter[2];return[e,n,i]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t),i=(t[2]||0)*this.distanceScales.metersPerUnit[2];return[e,n,i]}projectFlat(t){if(this.isGeospatial){const e=ig(t);return e[1]=Iu(e[1],-318,830),e}return t}unprojectFlat(t){return this.isGeospatial?Wd(t):t}getBounds(){const e={targetZ:(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).z||0},n=this.unproject([0,0],e),i=this.unproject([this.width,0],e),s=this.unproject([0,this.height],e),a=this.unproject([this.width,this.height],e);return[Math.min(n[0],i[0],s[0],a[0]),Math.min(n[1],i[1],s[1],a[1]),Math.max(n[0],i[0],s[0],a[0]),Math.max(n[1],i[1],s[1],a[1])]}getDistanceScales(t){return t?Tb({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel(t){let{x:e,y:n,width:i=1,height:s=1}=t;return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+s}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,Mj(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(t,e){return null}_initProps(t){const e=t.longitude,n=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=Aj({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||Tb({latitude:n,longitude:e}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:a}=t;let o=o3;if(s&&(o=a?new xn(a).transformAsVector(s,[]):s),this.isGeospatial){const A=this.projectPosition([e,n,0]);this.center=new le(o).scale(this.distanceScales.unitsPerMeter).add(A)}else this.center=this.projectPosition(o)}_initMatrices(t){const{viewMatrix:e=Oj,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:s,fovy:a=75,near:o=.1,far:A=1e3,padding:f=null,focalDistance:m=1}=t;this.viewMatrixUncentered=e,this.viewMatrix=new xn().multiplyRight(e).translate(new le(this.center).negate()),this.projectionMatrix=n||kj({width:this.width,height:this.height,orthographic:i,fovyRadians:s||a*Rj,focalDistance:m,padding:f,near:o,far:A});const b=og();Fh(b,b,this.projectionMatrix),Fh(b,b,this.viewMatrix),this.viewProjectionMatrix=b,this.viewMatrixInverse=fb([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=Fj(this.viewMatrixInverse);const x=og(),C=og();pb(x,x,[this.width/2,-this.height/2,1]),w0(x,x,[1,-1,0]),Fh(C,x,this.viewProjectionMatrix),this.pixelProjectionMatrix=C,this.pixelUnprojectionMatrix=fb(og(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Fn.warn("Pixel project matrix not invertible")()}}W(Xd,"displayName","Viewport");class Mh extends Xd{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{latitude:e=0,longitude:n=0,zoom:i=0,pitch:s=0,bearing:a=0,nearZMultiplier:o=.1,farZMultiplier:A=1.01,nearZ:f,farZ:m,orthographic:b=!1,projectionMatrix:x,repeat:C=!1,worldOffset:M=0,position:U,padding:N,legacyMeterSizes:Q=!1}=t;let{width:q,height:Y,altitude:tt=1.5}=t;const ft=Math.pow(2,i);q=q||1,Y=Y||1;let pt,mt=null;if(x)tt=x[5]/2,pt=L0(tt);else{t.fovy?(pt=t.fovy,tt=ZT(pt)):pt=L0(tt);let Rt;if(N){const{top:Lt=0,bottom:st=0}=N;Rt=[0,Iu((Lt+Y-st)/2,0,Y)-Y/2]}mt=dj({width:q,height:Y,scale:ft,center:U&&[0,0,U[2]*I0(e)],offset:Rt,pitch:s,fovy:pt,nearZMultiplier:o,farZMultiplier:A}),Number.isFinite(f)&&(mt.near=f),Number.isFinite(m)&&(mt.far=m)}let dt=hj({height:Y,pitch:s,bearing:a,scale:ft,altitude:tt});M&&(dt=new xn().translate([512*M,0,0]).multiplyLeft(dt)),super({...t,width:q,height:Y,viewMatrix:dt,longitude:n,latitude:e,zoom:i,...mt,fovy:pt,focalDistance:tt}),W(this,"longitude",void 0),W(this,"latitude",void 0),W(this,"pitch",void 0),W(this,"bearing",void 0),W(this,"altitude",void 0),W(this,"fovy",void 0),W(this,"orthographic",void 0),W(this,"_subViewports",void 0),W(this,"_pseudoMeters",void 0),this.latitude=e,this.longitude=n,this.zoom=i,this.pitch=s,this.bearing=a,this.altitude=tt,this.fovy=pt,this.orthographic=b,this._subViewports=C?[]:null,this._pseudoMeters=Q,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let i=e;i<=n;i++){const s=i?new Mh({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,n]=this.projectFlat(t),i=(t[2]||0)*I0(t[1]);return[e,n,i]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,n]=this.unprojectFlat(t),i=(t[2]||0)/I0(n);return[e,n,i]}addMetersToLngLat(t,e){return JT(t,e)}panByPosition(t,e){const n=Ib(e,this.pixelUnprojectionMatrix),i=this.projectFlat(t),s=uT([],i,V9([],n)),a=uT([],this.center,s),[o,A]=this.unprojectFlat(a);return{longitude:o,latitude:A}}getBounds(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=gj(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{width:n,height:i}=this,{longitude:s,latitude:a,zoom:o}=fj({width:n,height:i,bounds:t,...e});return new Mh({width:n,height:i,longitude:s,latitude:a,zoom:o})}}W(Mh,"displayName","WebMercatorViewport");const a3=[0,0,0];function Pb(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const n=t.projectPosition(r);if(e&&t instanceof Mh){const[i,s,a=0]=r,o=t.getDistanceScales([i,s]);n[2]=a*o.unitsPerMeter[2]}return n}function Nj(r){const{viewport:t,modelMatrix:e,coordinateOrigin:n}=r;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:a}=r;return i===Sn.DEFAULT&&(i=t.isGeospatial?Sn.LNGLAT:Sn.CARTESIAN),s===void 0&&(s=i),a===void 0&&(a=n),{viewport:t,coordinateSystem:i,coordinateOrigin:n,modelMatrix:e,fromCoordinateSystem:s,fromCoordinateOrigin:a}}function c3(r,t){let{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:s,offsetMode:a}=t,[o,A,f=0]=r;switch(n&&([o,A,f]=Jp([],[o,A,f,1],n)),i){case Sn.LNGLAT:return Pb([o,A,f],e,a);case Sn.LNGLAT_OFFSETS:return Pb([o+s[0],A+s[1],f+(s[2]||0)],e,a);case Sn.METER_OFFSETS:return Pb(JT(s,[o,A,f]),e,a);case Sn.CARTESIAN:default:return e.isGeospatial?[o+s[0],A+s[1],f+s[2]]:e.projectPosition([o,A,f])}}function Qj(r,t){const{viewport:e,coordinateSystem:n,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:a,fromCoordinateOrigin:o}=Nj(t),{autoOffset:A=!0}=t,{geospatialOrigin:f=a3,shaderCoordinateOrigin:m=a3,offsetMode:b=!1}=A?$T(e,n,i):{},x=c3(r,{viewport:e,modelMatrix:s,coordinateSystem:a,coordinateOrigin:o,offsetMode:b});if(b){const C=e.projectPosition(f||m);rG(x,x,C)}return x}const l3={blendFunc:[1,0,32771,0],blendEquation:32774};class u3 extends xb{constructor(){super(...arguments),W(this,"pickZ",void 0),W(this,"_colorEncoderState",null)}render(t){return"pickingFBO"in t?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer(t){let{layers:e,layerFilter:n,views:i,viewports:s,onViewportActive:a,pickingFBO:o,deviceRect:{x:A,y:f,width:m,height:b},cullRect:x,effects:C,pass:M="picking",pickZ:U,moduleParameters:N}=t;const Q=this.gl;this.pickZ=U;const q=this._resetColorEncoder(U),Y=Oc(Q,{scissorTest:!0,scissor:[A,f,m,b],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...l3,blend:!U},()=>super.render({target:o,layers:e,layerFilter:n,views:i,viewports:s,onViewportActive:a,cullRect:x,effects:C==null?void 0:C.filter(ft=>ft.useInPicking),pass:M,isPicking:!0,moduleParameters:N}));return this._colorEncoderState=null,{decodePickingColor:q&&zj.bind(null,q),stats:Y}}shouldDrawLayer(t){const{pickable:e,operation:n}=t.props;return e&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e,n){const i={...t.props.parameters},{pickable:s,operation:a}=t.props;return this._colorEncoderState?s&&a.includes("draw")&&(Object.assign(i,l3),i.blend=!0,i.blendColor=Hj(this._colorEncoderState,t,n)):i.blend=!1,a.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(t){return this._colorEncoderState=t?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function Hj(r,t,e){const{byLayer:n,byAlpha:i}=r;let s,a=n.get(t);return a?(a.viewports.push(e),s=a.a):(s=n.size+1,s<=255?(a={a:s,layer:t,viewports:[e]},n.set(t,a),i[s]=a):(Fn.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function zj(r,t){const e=r.byAlpha[t[3]];return e&&{pickedLayer:e.layer,pickedViewports:e.viewports,pickedObjectIndex:e.layer.decodePickingColor(t)}}const Yd={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},F0=Symbol.for("component"),SA=Symbol.for("propTypes"),Ub=Symbol.for("deprecatedProps"),Jd=Symbol.for("asyncPropDefaults"),Ph=Symbol.for("asyncPropOriginal"),TA=Symbol.for("asyncPropResolved");function M0(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return Array.isArray(r)?A3(r,t,[]):t(r)?[r]:[]}function A3(r,t,e){let n=-1;for(;++n<r.length;){const i=r[n];Array.isArray(i)?A3(i,t,e):t(i)&&e.push(i)}return e}function Gj(r){let{target:t,source:e,start:n=0,count:i=1}=r;const s=e.length,a=i*s;let o=0;for(let A=n;o<s;o++)t[A++]=e[o];for(;o<a;)o<a-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+a-o),o=a);return t}class Vj{constructor(t,e,n){W(this,"id",void 0),W(this,"context",void 0),W(this,"isLoaded",void 0),W(this,"persistent",void 0),W(this,"_loadCount",0),W(this,"_subscribers",new Set),W(this,"_data",void 0),W(this,"_loader",void 0),W(this,"_error",void 0),W(this,"_content",void 0),this.id=t,this.context=n,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let i=t;typeof t=="string"&&(i=bA(t)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===n&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=t);for(const s of this._subscribers)s.onChange(this.getData())}}class jj{constructor(t){let{gl:e,protocol:n}=t;W(this,"protocol",void 0),W(this,"_context",void 0),W(this,"_resources",void 0),W(this,"_consumers",void 0),W(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return t.startsWith(this.protocol)?!0:t in this._resources}add(t){let{resourceId:e,data:n,forceUpdate:i=!1,persistent:s=!0}=t,a=this._resources[e];a?a.setData(n,i):(a=new Vj(e,n,this._context),this._resources[e]=a),a.persistent=s}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe(t){let{consumerId:e}=t;const n=this._consumers[e];if(n){for(const i in n){const s=n[i],a=this._resources[s.resourceId];a&&a.unsubscribe(s)}delete this._consumers[e],this.prune()}}subscribe(t){let{resourceId:e,onChange:n,consumerId:i,requestId:s="default"}=t;const{_resources:a,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),a[e]||this.add({resourceId:e,data:null,persistent:!1}));const A=a[e];if(this._track(i,s,A,n),A)return A.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,i){const s=this._consumers,a=s[t]=s[t]||{},o=a[e]||{},A=o.resourceId&&this._resources[o.resourceId];A&&(A.unsubscribe(o),this.prune()),n&&(a[e]=o,o.onChange=i,o.resourceId=n.id,n.subscribe(o))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];!e.persistent&&!e.inUse()&&(e.delete(),delete this._resources[t])}}}const Rb={name:"project32",dependencies:[Bb],vs:`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`},Ob={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...oV},qj=[Bb],Kj=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function Wj(r){const t=eg.getDefaultProgramManager(r);for(const e of qj)t.addDefaultModule(e);for(const e of Kj)t.addShaderHook(e);return t}const $j="layerManager.setLayers",Xj="layerManager.activateViewport";class Yj{constructor(t){let{deck:e,stats:n,viewport:i,timeline:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};W(this,"layers",void 0),W(this,"context",void 0),W(this,"resourceManager",void 0),W(this,"_lastRenderedLayers",[]),W(this,"_needsRedraw",!1),W(this,"_needsUpdate",!1),W(this,"_nextLayers",null),W(this,"_debug",!1),W(this,"activateViewport",a=>{oo(Xj,this,a),a&&(this.context.viewport=a)}),this.layers=[],this.resourceManager=new jj({gl:t,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:t,deck:e,programManager:t&&Wj(t),stats:n||new Dv({id:"deck.gl"}),viewport:i||new Xd({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new HT,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1},e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(t);e=e||i}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers(){let{layerIds:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t?this.layers.filter(e=>t.find(n=>e.id.indexOf(n)===0)):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){oo($j,this,e,t),this._lastRenderedLayers=t;const n=M0(t,Boolean);for(const i of n)i.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this._lastRenderedLayers,t)),this._nextLayers=null}_handleError(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}_updateLayers(t,e){const n={};for(const a of t)n[a.id]?Fn.warn("Multiple old layers with same id ".concat(a.id))():n[a.id]=a;const i=[];this._updateSublayersRecursively(e,n,i),this._finalizeOldLayers(n);let s=!1;for(const a of i)if(a.hasUniformTransition()){s="Uniform transition in ".concat(a);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(t,e,n){for(const i of t){i.context=this.context;const s=e[i.id];s===null&&Fn.warn("Multiple new layers with same id ".concat(i.id))(),e[i.id]=null;let a=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),a=i.isComposite?i.getSubLayers():null}catch(o){this._handleError("matching",o,i)}a&&this._updateSublayersRecursively(a,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=Yd.INITIALIZED}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle=Yd.MATCHED,e!==t&&(t.lifecycle=Yd.AWAITING_GC)}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle=Yd.AWAITING_FINALIZATION;try{t._finalize(),t.lifecycle=Yd.FINALIZED}catch(e){this._handleError("finalization",e,t)}}}function Nl(r,t,e){if(r===t)return!0;if(!e||!r||!t)return!1;if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(let n=0;n<r.length;n++)if(!Nl(r[n],t[n],e-1))return!1;return!0}if(Array.isArray(t))return!1;if(typeof r=="object"&&typeof t=="object"){const n=Object.keys(r),i=Object.keys(t);if(n.length!==i.length)return!1;for(const s of n)if(!t.hasOwnProperty(s)||!Nl(r[s],t[s],e-1))return!1;return!0}return!1}class Jj{constructor(t){W(this,"width",void 0),W(this,"height",void 0),W(this,"views",void 0),W(this,"viewState",void 0),W(this,"controllers",void 0),W(this,"timeline",void 0),W(this,"_viewports",void 0),W(this,"_viewportMap",void 0),W(this,"_isUpdating",void 0),W(this,"_needsRedraw",void 0),W(this,"_needsUpdate",void 0),W(this,"_eventManager",void 0),W(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers){const e=this.controllers[t];e&&e.finalize()}this.controllers={}}needsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter(e=>e.containsPixel(t)):this._viewports}getViews(){const t={};return this.views.forEach(e=>{t[e.id]=e}),t}getView(t){return this.views.find(e=>e.id===t)}getViewState(t){const e=typeof t=="string"?this.getView(t):t,n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),i={x:t[0],y:t[1]};for(let s=n.length-1;s>=0;--s){const a=n[s];if(a.containsPixel(i)){const o=t.slice();return o[0]-=a.x,o[1]-=a.y,a.unproject(o,e)}}return null}setProps(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){(t!==this.width||e!==this.height)&&(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=M0(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){t?(!Nl(t,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):Fn.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...e,viewId:t})}_createController(t,e){const n=e.type;return new n({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var a;return(a=this.getView(t.id))===null||a===void 0?void 0:a.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(t,e,n,i){const s=t.controller;if(s&&n){const a={...e,...s,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height};return(!i||i.constructor!==s.type)&&(i=this._createController(t,a)),i&&i.setProps(a),i}return null}_rebuildViewports(){const{views:t}=this,e=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=t.length;i--;){const s=t[i],a=this.getViewState(s),o=s.makeViewport({viewState:a,width:this.width,height:this.height});let A=e[s.id];const f=!!s.controller;f&&!A&&(n=!0),(n||!f)&&A&&(A.finalize(),A=null),this.controllers[s.id]=this._updateController(s,a,o,A),o&&this._viewports.unshift(o)}for(const i in e){const s=e[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)})}_diffViews(t,e){return t.length!==e.length?!0:t.some((n,i)=>!t[i].equals(e[i]))}}const Zj=/([0-9]+\.?[0-9]*)(%|px)/;function IA(r){switch(typeof r){case"number":return{position:r,relative:!1};case"string":const t=Zj.exec(r);if(t&&t.length>=3){const e=t[2]==="%",n=parseFloat(t[1]);return{position:e?n/100:n,relative:e}}default:throw new Error("Could not parse position string ".concat(r))}}function LA(r,t){return r.relative?Math.round(r.position*t):r.position}function qs(r,t){if(!r)throw new Error(t||"deck.gl: assertion failed.")}class tq{constructor(t){W(this,"id",void 0),W(this,"viewportInstance",void 0),W(this,"_x",void 0),W(this,"_y",void 0),W(this,"_width",void 0),W(this,"_height",void 0),W(this,"_padding",void 0),W(this,"props",void 0);const{id:e,x:n=0,y:i=0,width:s="100%",height:a="100%",padding:o=null,viewportInstance:A}=t||{};qs(!A||A instanceof Xd),this.viewportInstance=A,this.id=e||this.constructor.displayName||"view",this.props={...t,id:this.id},this._x=IA(n),this._y=IA(i),this._width=IA(s),this._height=IA(a),this._padding=o&&{left:IA(o.left||0),right:IA(o.right||0),top:IA(o.top||0),bottom:IA(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t?!0:this.viewportInstance?t.viewportInstance?this.viewportInstance.equals(t.viewportInstance):!1:this.ViewportType===t.ViewportType&&Nl(this.props,t.props,2)}makeViewport(t){let{width:e,height:n,viewState:i}=t;if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const s=this.getDimensions({width:e,height:n});return!s.height||!s.width?null:new this.ViewportType({...i,...this.props,...s})}getViewStateId(){const{viewState:t}=this.props;return typeof t=="string"?t:(t==null?void 0:t.id)||this.id}filterViewState(t){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const n in this.props.viewState)n!=="id"&&(e[n]=this.props.viewState[n]);return e}return t}getDimensions(t){let{width:e,height:n}=t;const i={x:LA(this._x,e),y:LA(this._y,n),width:LA(this._width,e),height:LA(this._height,n)};return this._padding&&(i.padding={left:LA(this._padding.left,e),top:LA(this._padding.top,n),right:LA(this._padding.right,e),bottom:LA(this._padding.bottom,n)}),i}get controller(){const t=this.props.controller;return t?t===!0?{type:this.ControllerType}:typeof t=="function"?{type:t}:{type:this.ControllerType,...t}:null}}class cg{constructor(t){W(this,"_inProgress",void 0),W(this,"_handle",void 0),W(this,"_timeline",void 0),W(this,"time",void 0),W(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=t,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(t){var e,n;this.cancel(),this.settings=t,this._inProgress=!0,(e=(n=this.settings).onStart)===null||e===void 0||e.call(n,this)}end(){if(this._inProgress){var t,e;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(t=(e=this.settings).onEnd)===null||t===void 0||t.call(e,this)}}cancel(){if(this._inProgress){var t,e;(t=(e=this.settings).onInterrupt)===null||t===void 0||t.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var t,e;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:n,settings:i}=this;this._handle=n.addChannel({delay:n.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(t=(e=this.settings).onUpdate)===null||t===void 0||t.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const h3=()=>{},Db={BREAK:1,SNAP_TO_END:2,IGNORE:3},eq=r=>r,rq=Db.BREAK;class nq{constructor(t){W(this,"getControllerState",void 0),W(this,"props",void 0),W(this,"propsInTransition",void 0),W(this,"transition",void 0),W(this,"onViewStateChange",void 0),W(this,"onStateChange",void 0),W(this,"_onTransitionUpdate",e=>{const{time:n,settings:{interpolator:i,startProps:s,endProps:a,duration:o,easing:A}}=e,f=A(n/o),m=i.interpolateProps(s,a,f);this.propsInTransition=this.getControllerState({...this.props,...m}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=t.getControllerState,this.propsInTransition=null,this.transition=new cg(t.timeline),this.onViewStateChange=t.onViewStateChange||h3,this.onStateChange=t.onStateChange||h3}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(this.props=t,!n||this._shouldIgnoreViewportChange(n,t))return!1;if(this._isTransitionEnabled(t)){let i=n;if(this.transition.inProgress){const{interruption:s,endProps:a}=this.transition.settings;i={...n,...s===Db.SNAP_TO_END?a:this.propsInTransition||n}}this._triggerTransition(i,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||e==="auto")&&!!n}_isUpdateDueToCurrentTransition(t){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition):!1}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?this.transition.settings.interruption===Db.IGNORE||this._isUpdateDueToCurrentTransition(e):this._isTransitionEnabled(e)?e.transitionInterpolator.arePropsEqual(t,e):!0}_triggerTransition(t,e){const n=this.getControllerState(t),i=this.getControllerState(e).shortestPathFrom(n),s=e.transitionInterpolator,a=s.getDuration?s.getDuration(t,e):e.transitionDuration;if(a===0)return;const o=s.initializeProps(t,i);this.propsInTransition={};const A={duration:a,easing:e.transitionEasing||eq,interpolator:s,interruption:e.transitionInterruption||rq,startProps:o.start,endProps:o.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)};this.transition.start(A),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),t==null||t(e)}}}class iq{constructor(t){W(this,"_propsToCompare",void 0),W(this,"_propsToExtract",void 0),W(this,"_requiredProps",void 0);const{compare:e,extract:n,required:i}=t;this._propsToCompare=e,this._propsToExtract=n||e,this._requiredProps=i}arePropsEqual(t,e){for(const n of this._propsToCompare)if(!(n in t)||!(n in e)||!kc(t[n],e[n]))return!1;return!0}initializeProps(t,e){const n={},i={};for(const s of this._propsToExtract)(s in t||s in e)&&(n[s]=t[s],i[s]=e[s]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach(e=>{const n=t[e];qs(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))})}}const sq=["longitude","latitude","zoom","bearing","pitch"],oq=["longitude","latitude","zoom"];class d3 extends iq{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=Array.isArray(t)?t:t.transitionProps,n=Array.isArray(t)?{}:t;n.transitionProps=Array.isArray(e)?{compare:e,required:e}:e||{compare:sq,required:oq},super(n.transitionProps),W(this,"opts",void 0),this.opts=n}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:i,around:s}=this.opts;if(i&&s){const a=i(t),o=i(e),A=a.unproject(s);n.start.around=s,Object.assign(n.end,{around:o.project(A),aroundPosition:A,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const i={};for(const s of this._propsToExtract)i[s]=g0(t[s]||0,e[s]||0,n);if(e.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...e,...i});Object.assign(i,s.panByPosition(e.aroundPosition,g0(t.around,e.around,n)))}return i}}const FA={transitionDuration:0},aq=300,P0=r=>1-(1-r)*(1-r),Zd={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Uh={};class cq{constructor(t){W(this,"props",void 0),W(this,"state",{}),W(this,"transitionManager",void 0),W(this,"eventManager",void 0),W(this,"onViewStateChange",void 0),W(this,"onStateChange",void 0),W(this,"makeViewport",void 0),W(this,"_controllerState",void 0),W(this,"_events",{}),W(this,"_interactionState",{isDragging:!1}),W(this,"_customEvents",[]),W(this,"_eventStartBlocked",null),W(this,"_panMove",!1),W(this,"invertPan",!1),W(this,"dragMode","rotate"),W(this,"inertia",0),W(this,"scrollZoom",!0),W(this,"dragPan",!0),W(this,"dragRotate",!0),W(this,"doubleClickZoom",!0),W(this,"touchZoom",!0),W(this,"touchRotate",!1),W(this,"keyboard",!0),this.transitionManager=new nq({...t,getControllerState:e=>new this.ControllerState(e),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=t.eventManager,this.onViewStateChange=t.onViewStateChange||(()=>{}),this.onStateChange=t.onStateChange||(()=>{}),this.makeViewport=t.makeViewport}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events)if(this._events[e]){var t;(t=this.eventManager)===null||t===void 0||t.off(e,this.handleEvent)}this.transitionManager.finalize()}handleEvent(t){this._controllerState=void 0;const e=this._eventStartBlocked;switch(t.type){case"panstart":return e?!1:this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return e?!1:this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return e?!1:this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(t){const{x:e,y:n}=this.props,{offsetCenter:i}=t;return[i.x-e,i.y-n]}isPointInBounds(t,e){const{width:n,height:i}=this.props;if(e&&e.handled)return!1;const s=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=i;return s&&e&&e.stopPropagation(),s}isFunctionKeyPressed(t){const{srcEvent:e}=t;return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(t){const e=setTimeout(()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)},t);this._eventStartBlocked=e}setProps(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);const{inertia:e}=t;this.inertia=Number.isFinite(e)?e:e===!0?aq:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:a=!0,touchZoom:o=!0,touchRotate:A=!1,keyboard:f=!0}=t,m=!!this.onViewStateChange;this.toggleEvents(Zd.WHEEL,m&&n),this.toggleEvents(Zd.PAN,m),this.toggleEvents(Zd.PINCH,m&&(o||A)),this.toggleEvents(Zd.TRIPLE_PAN,m&&A),this.toggleEvents(Zd.DOUBLE_TAP,m&&a),this.toggleEvents(Zd.KEYBOARD,m&&f),this.scrollZoom=n,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=a,this.touchZoom=o,this.touchRotate=A,this.keyboard=f}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach(n=>{this._events[n]!==e&&(this._events[n]=e,e?this.eventManager.on(n,this.handleEvent):this.eventManager.off(n,this.handleEvent))})}updateViewport(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i={...t.getViewportProps(),...e},s=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(n),s){const a=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:a})}}_onTransition(t){this.onViewStateChange({...t,interactionState:this._interactionState})}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(i,FA,{isDragging:!0}),!0}_onPan(t){return this.isDragging()?this._panMove?this._onPanMove(t):this._onPanRotate(t):!1}_onPanEnd(t){return this.isDragging()?this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t):!1}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,FA,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:P0},{isDragging:!1,isPanning:!0})}else{const n=this.controllerState.panEnd();this.updateViewport(n,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,FA,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:P0},{isDragging:!1,isRotating:!0})}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;t.srcEvent.preventDefault();const{speed:n=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=t;let a=2/(1+Math.exp(-Math.abs(s*n)));s<0&&a!==0&&(a=1/a);const o=this.controllerState.zoom({pos:e,scale:a});return this.updateViewport(o,{...this._getTransitionProps({around:e}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,FA,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate||!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,FA,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),i=[n[0],n[1]+=t.velocityY*e/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:P0},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return Uh._startPinchRotation=t.rotation,Uh._lastPinchEvent=t,this.updateViewport(n,FA,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,i=this.getCenter(t);e=e.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:Uh._startPinchRotation-n})}return this.updateViewport(e,FA,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Uh._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this,{_lastPinchEvent:n}=Uh;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const i=this.getCenter(t);let s=this.controllerState.rotateEnd();const a=Math.log2(t.scale),o=(a-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),A=Math.pow(2,a+o*e/2);s=s.zoom({pos:i,scale:A}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:e,transitionEasing:P0},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Uh._startPinchRotation=null,Uh._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),i=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:a}=this.keyboard===!0?{}:this.keyboard,{controllerState:o}=this;let A;const f={};switch(t.srcEvent.code){case"Minus":A=e?o.zoomOut(n).zoomOut(n):o.zoomOut(n),f.isZooming=!0;break;case"Equal":A=e?o.zoomIn(n).zoomIn(n):o.zoomIn(n),f.isZooming=!0;break;case"ArrowLeft":e?(A=o.rotateLeft(s),f.isRotating=!0):(A=o.moveLeft(i),f.isPanning=!0);break;case"ArrowRight":e?(A=o.rotateRight(s),f.isRotating=!0):(A=o.moveRight(i),f.isPanning=!0);break;case"ArrowUp":e?(A=o.rotateUp(a),f.isRotating=!0):(A=o.moveUp(i),f.isPanning=!0);break;case"ArrowDown":e?(A=o.rotateDown(a),f.isRotating=!0):(A=o.moveDown(i),f.isPanning=!0);break;default:return!1}return this.updateViewport(A,this._getTransitionProps(),f),!0}_getTransitionProps(t){const{transition:e}=this;return!e||!e.transitionInterpolator?FA:t?{...e,transitionInterpolator:new d3({...t,...e.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:e}}class lq{constructor(t,e){W(this,"_viewportProps",void 0),W(this,"_state",void 0),this._viewportProps=this.applyConstraints(t),this._state=e}getViewportProps(){return this._viewportProps}getState(){return this._state}}const f3=5,uq=1.2;class Aq extends lq{constructor(t){const{width:e,height:n,latitude:i,longitude:s,zoom:a,bearing:o=0,pitch:A=0,altitude:f=1.5,position:m=[0,0,0],maxZoom:b=20,minZoom:x=0,maxPitch:C=60,minPitch:M=0,startPanLngLat:U,startZoomLngLat:N,startRotatePos:Q,startBearing:q,startPitch:Y,startZoom:tt,normalize:ft=!0}=t;qs(Number.isFinite(s)),qs(Number.isFinite(i)),qs(Number.isFinite(a)),super({width:e,height:n,latitude:i,longitude:s,zoom:a,bearing:o,pitch:A,altitude:f,maxZoom:b,minZoom:x,maxPitch:C,minPitch:M,normalize:ft,position:m},{startPanLngLat:U,startZoomLngLat:N,startRotatePos:Q,startBearing:q,startPitch:Y,startZoom:tt}),W(this,"makeViewport",void 0),this.makeViewport=t.makeViewport}panStart(t){let{pos:e}=t;return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan(t){let{pos:e,startPos:n}=t;const i=this.getState().startPanLngLat||this._unproject(n);if(!i)return this;const a=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(a)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart(t){let{pos:e}=t;return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate(t){let{pos:e,deltaAngleX:n=0,deltaAngleY:i=0}=t;const{startRotatePos:s,startBearing:a,startPitch:o}=this.getState();if(!s||a===void 0||o===void 0)return this;let A;return e?A=this._getNewRotation(e,s,o,a):A={bearing:a+n,pitch:o+i},this._getUpdatedState(A)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart(t){let{pos:e}=t;return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom(t){let{pos:e,startPos:n,scale:i}=t,{startZoom:s,startZoomLngLat:a}=this.getState();if(a||(s=this.getViewportProps().zoom,a=this._unproject(n)||this._unproject(e)),!a)return this;const{maxZoom:o,minZoom:A}=this.getViewportProps();let f=s+Math.log2(i);f=Iu(f,A,o);const m=this.makeViewport({...this.getViewportProps(),zoom:f});return this._getUpdatedState({zoom:f,...m.panByPosition(a,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2;return this._zoomFromCenter(t)}zoomOut(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2;return this._zoomFromCenter(1/t)}moveLeft(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return this._panFromCenter([t,0])}moveRight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return this._panFromCenter([-t,0])}moveUp(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return this._panFromCenter([0,t])}moveDown(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return this._panFromCenter([0,-t])}rotateLeft(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:s}=n;return Math.abs(i-e.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(s-e.longitude)>180&&(n.longitude=s<0?s+360:s-360),n}applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i}=t;t.zoom=Iu(i,n,e);const{maxPitch:s,minPitch:a,pitch:o}=t;t.pitch=Iu(o,a,s);const{normalize:A=!0}=t;return A&&Object.assign(t,mj(t)),t}_zoomFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}_unproject(t){const e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}_getNewRotation(t,e,n,i){const s=t[0]-e[0],a=t[1]-e[1],o=t[1],A=e[1],{width:f,height:m}=this.getViewportProps(),b=s/f;let x=0;a>0?Math.abs(m-A)>f3&&(x=a/(A-m)*uq):a<0&&A>f3&&(x=1-o/A),x=Iu(x,-1,1);const{minPitch:C,maxPitch:M}=this.getViewportProps(),U=i+180*b;let N=n;return x>0?N=n+x*(M-n):x<0&&(N=n-x*(C-n)),{pitch:N,bearing:U}}}class hq extends cq{constructor(){super(...arguments),W(this,"ControllerState",Aq),W(this,"transition",{transitionDuration:300,transitionInterpolator:new d3({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),W(this,"dragMode","pan")}setProps(t){t.position=t.position||[0,0,0];const e=this.props;super.setProps(t),(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...t,...this.state}))}}class kb extends tq{get ViewportType(){return Mh}get ControllerType(){return hq}}W(kb,"displayName","MapView");const dq=new Fb;function fq(r,t){var e,n;const i=(e=r.order)!==null&&e!==void 0?e:1/0,s=(n=t.order)!==null&&n!==void 0?n:1/0;return i-s}class pq{constructor(){W(this,"effects",void 0),W(this,"_resolvedEffects",[]),W(this,"_defaultEffects",[]),W(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(t){const e=this._defaultEffects;if(!e.find(n=>n.id===t.id)){const n=e.findIndex(i=>fq(i,t)>0);n<0?e.push(t):e.splice(n,0,t),this._setEffects(this.effects)}}setProps(t){"effects"in t&&(Nl(t.effects,this.effects,1)||this._setEffects(t.effects))}needsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._resolvedEffects}_setEffects(t){const e={};for(const i of this.effects)e[i.id]=i;const n=[];for(const i of t){const s=e[i.id];s&&s!==i?s.setProps?(s.setProps(i.props),n.push(s)):(s.cleanup(),n.push(i)):n.push(i),delete e[i.id]}for(const i in e)e[i].cleanup();this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),t.some(i=>i instanceof Fb)||this._resolvedEffects.push(dq),this._needsRedraw="effects changed"}finalize(){for(const t of this._resolvedEffects)t.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class gq extends xb{shouldDrawLayer(t){const{operation:e}=t.props;return e.includes("draw")||e.includes("terrain")}}const mq="deckRenderer.renderLayers";class yq{constructor(t){W(this,"gl",void 0),W(this,"layerFilter",void 0),W(this,"drawPickingColors",void 0),W(this,"drawLayersPass",void 0),W(this,"pickLayersPass",void 0),W(this,"renderCount",void 0),W(this,"_needsRedraw",void 0),W(this,"renderBuffers",void 0),W(this,"lastPostProcessEffect",void 0),this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new gq(t),this.pickLayersPass=new u3(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){if(!t.viewports.length)return;const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...t,target:t.target||vs.getDefaultFramebuffer(this.gl)};n.effects&&this._preRender(n.effects,n);const i=this.lastPostProcessEffect?this.renderBuffers[0]:n.target,s=e.render({...n,target:i});n.effects&&this._postRender(n.effects,n),this.renderCount++,oo(mq,this,s,t)}needsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){this.lastPostProcessEffect=null,e.preRenderStats=e.preRenderStats||{};for(const n of t)e.preRenderStats[n.id]=n.preRender(this.gl,e),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:t}=this;t.length===0&&t.push(new vs(this.gl),new vs(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:n}=this,i={...e,inputBuffer:n[0],swapBuffer:n[1],target:null};for(const s of t)if(s.postRender){if(s.id===this.lastPostProcessEffect){i.target=e.target,s.postRender(this.gl,i);break}const a=s.postRender(this.gl,i);i.inputBuffer=a,i.swapBuffer=a===n[0]?n[1]:n[0]}}}const _q={pickedColor:null,pickedObjectIndex:-1};function vq(r){let{pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:i,deviceRadius:s,deviceRect:a}=r;const{x:o,y:A,width:f,height:m}=a;let b=s*s,x=-1,C=0;for(let M=0;M<m;M++){const U=M+A-i,N=U*U;if(N>b)C+=4*f;else for(let Q=0;Q<f;Q++){if(t[C+3]-1>=0){const Y=Q+o-n,tt=Y*Y+N;tt<=b&&(b=tt,x=C)}C+=4}}if(x>=0){const M=t.slice(x,x+4),U=e(M);if(U){const N=Math.floor(x/4/f),Q=x/4-N*f;return{...U,pickedColor:M,pickedX:o+Q,pickedY:A+N}}Fn.error("Picked non-existent layer. Is picking buffer corrupt?")()}return _q}function bq(r){let{pickedColors:t,decodePickingColor:e}=r;const n=new Map;if(t){for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const a=t.slice(i,i+4),o=a.join(",");if(!n.has(o)){const A=e(a);A?n.set(o,{...A,color:a}):Fn.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function p3(r){let{pickInfo:t,viewports:e,pixelRatio:n,x:i,y:s,z:a}=r,o=e[0];e.length>1&&(o=xq((t==null?void 0:t.pickedViewports)||e,{x:i,y:s}));let A;if(o){const f=[i-o.x,s-o.y];a!==void 0&&(f[2]=a),A=o.unproject(f)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:i,y:s,pixel:[i,s],coordinate:A,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function wq(r){const{pickInfo:t,lastPickedInfo:e,mode:n,layers:i}=r,{pickedColor:s,pickedLayer:a,pickedObjectIndex:o}=t,A=a?[a]:[];if(n==="hover"){const b=e.index,x=e.layerId,C=a?a.props.id:null;if(C!==x||o!==b){if(C!==x){const M=i.find(U=>U.props.id===x);M&&A.unshift(M)}e.layerId=C,e.index=o,e.info=null}}const f=p3(r),m=new Map;return m.set(null,f),A.forEach(b=>{let x={...f};b===a&&(x.color=s,x.index=o,x.picked=!0),x=g3({layer:b,info:x,mode:n});const C=x.layer;b===a&&n==="hover"&&(e.info=x),m.set(C.id,x),n==="hover"&&C.updateAutoHighlight(x)}),m}function g3(r){let{layer:t,info:e,mode:n}=r;for(;t&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:i}),t=t.parent}return e}function xq(r,t){for(let e=r.length-1;e>=0;e--){const n=r[e];if(n.containsPixel(t))return n}return r[0]}class Bq{constructor(t){W(this,"gl",void 0),W(this,"pickingFBO",void 0),W(this,"depthFBO",void 0),W(this,"pickLayersPass",void 0),W(this,"layerFilter",void 0),W(this,"lastPickedInfo",void 0),W(this,"_pickable",!0),this.gl=t,this.pickLayersPass=new u3(t),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject(t){let{x:e,y:n,layers:i,viewports:s}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.lastPickedInfo.info;const o=a&&a.layer&&a.layer.id,A=a&&a.viewport&&a.viewport.id,f=o?i.find(C=>C.id===o):null,m=A&&s.find(C=>C.id===A)||s[0],b=m&&m.unproject([e-m.x,n-m.y]);return{...a,...{x:e,y:n,viewport:m,coordinate:b,layer:f}}}_resizeBuffer(){var t,e;const{gl:n}=this;if(!this.pickingFBO&&(this.pickingFBO=new vs(n),vs.isSupported(n,{colorBufferFloat:!0}))){const i=new vs(n);i.attach({36064:new Ta(n,{format:pn(n)?34836:6408,type:5126})}),this.depthFBO=i}(t=this.pickingFBO)===null||t===void 0||t.resize({width:n.canvas.width,height:n.canvas.height}),(e=this.depthFBO)===null||e===void 0||e.resize({width:n.canvas.width,height:n.canvas.height})}_getPickable(t){if(this._pickable===!1)return null;const e=t.filter(n=>this.pickLayersPass.shouldDrawLayer(n)&&!n.isComposite);return e.length?e:null}_pickClosestObject(t){let{layers:e,views:n,viewports:i,x:s,y:a,radius:o=0,depth:A=1,mode:f="query",unproject3D:m,onViewportActive:b,effects:x}=t;const C=this._getPickable(e),M=kd(this.gl);if(!C)return{result:[],emptyInfo:p3({viewports:i,x:s,y:a,pixelRatio:M})};this._resizeBuffer();const U=Uv(this.gl,[s,a],!0),N=[U.x+Math.floor(U.width/2),U.y+Math.floor(U.height/2)],Q=Math.round(o*M),{width:q,height:Y}=this.pickingFBO,tt=this._getPickingRect({deviceX:N[0],deviceY:N[1],deviceRadius:Q,deviceWidth:q,deviceHeight:Y}),ft={x:s-o,y:a-o,width:o*2+1,height:o*2+1};let pt;const mt=[],dt=new Set;for(let Rt=0;Rt<A;Rt++){let Lt;if(tt){const ct=this._drawAndSample({layers:C,views:n,viewports:i,onViewportActive:b,deviceRect:tt,cullRect:ft,effects:x,pass:"picking:".concat(f)});Lt=vq({...ct,deviceX:N[0],deviceY:N[1],deviceRadius:Q,deviceRect:tt})}else Lt={pickedColor:null,pickedObjectIndex:-1};let st;if(Lt.pickedLayer&&m&&this.depthFBO){const{pickedColors:ct}=this._drawAndSample({layers:[Lt.pickedLayer],views:n,viewports:i,onViewportActive:b,deviceRect:{x:Lt.pickedX,y:Lt.pickedY,width:1,height:1},cullRect:ft,effects:x,pass:"picking:".concat(f,":z")},!0);ct[3]&&(st=ct[0])}Lt.pickedLayer&&Rt+1<A&&(dt.add(Lt.pickedLayer),Lt.pickedLayer.disablePickingIndex(Lt.pickedObjectIndex)),pt=wq({pickInfo:Lt,lastPickedInfo:this.lastPickedInfo,mode:f,layers:C,viewports:i,x:s,y:a,z:st,pixelRatio:M});for(const ct of pt.values())ct.layer&&mt.push(ct);if(!Lt.pickedColor)break}for(const Rt of dt)Rt.restorePickingColors();return{result:mt,emptyInfo:pt.get(null)}}_pickVisibleObjects(t){let{layers:e,views:n,viewports:i,x:s,y:a,width:o=1,height:A=1,mode:f="query",maxObjects:m=null,onViewportActive:b,effects:x}=t;const C=this._getPickable(e);if(!C)return[];this._resizeBuffer();const M=kd(this.gl),U=Uv(this.gl,[s,a],!0),N=U.x,Q=U.y+U.height,q=Uv(this.gl,[s+o,a+A],!0),Y=q.x+q.width,tt=q.y,ft={x:N,y:tt,width:Y-N,height:Q-tt},pt=this._drawAndSample({layers:C,views:n,viewports:i,onViewportActive:b,deviceRect:ft,cullRect:{x:s,y:a,width:o,height:A},effects:x,pass:"picking:".concat(f)}),mt=bq(pt),dt=new Map,Rt=Number.isFinite(m);for(let st=0;st<mt.length;st++){var Lt;if(Rt&&m&&dt.size>=m)break;const ct=mt[st];let wt={color:ct.pickedColor,layer:null,index:ct.pickedObjectIndex,picked:!0,x:s,y:a,pixelRatio:M};wt=g3({layer:ct.pickedLayer,info:wt,mode:f});const yt=(Lt=wt.object)!==null&&Lt!==void 0?Lt:"".concat(wt.layer.id,"[").concat(wt.index,"]");dt.has(yt)||dt.set(yt,wt)}return Array.from(dt.values())}_drawAndSample(t){let{layers:e,views:n,viewports:i,onViewportActive:s,deviceRect:a,cullRect:o,effects:A,pass:f}=t,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const b=m?this.depthFBO:this.pickingFBO,x={layers:e,layerFilter:this.layerFilter,views:n,viewports:i,onViewportActive:s,pickingFBO:b,deviceRect:a,cullRect:o,effects:A,pass:f,pickZ:m,preRenderStats:{}};for(const Y of A)Y.useInPicking&&(x.preRenderStats[Y.id]=Y.preRender(this.gl,x));const{decodePickingColor:C}=this.pickLayersPass.render(x),{x:M,y:U,width:N,height:Q}=a,q=new(m?Float32Array:Uint8Array)(N*Q*4);return o0(b,{sourceX:M,sourceY:U,sourceWidth:N,sourceHeight:Q,target:q}),{pickedColors:q,decodePickingColor:C}}_getPickingRect(t){let{deviceX:e,deviceY:n,deviceRadius:i,deviceWidth:s,deviceHeight:a}=t;const o=Math.max(0,e-i),A=Math.max(0,n-i),f=Math.min(s,e+i+1)-o,m=Math.min(a,n+i+1)-A;return f<=0||m<=0?null:{x:o,y:A,width:f,height:m}}}const Cq={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class Eq{constructor(t){W(this,"el",null),W(this,"isVisible",!1);const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,Cq),e.appendChild(this.el))}setTooltip(t,e,n){const i=this.el;if(i){if(typeof t=="string")i.innerText=t;else if(t)t.text&&(i.innerText=t.text),t.html&&(i.innerHTML=t.html),t.className&&(i.className=t.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(e,"px, ").concat(n,"px)"),t&&typeof t=="object"&&"style"in t&&Object.assign(i.style,t.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var m3={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(r){(function(t,e,n,i){var s=["","webkit","Moz","MS","ms","o"],a=e.createElement("div"),o="function",A=Math.round,f=Math.abs,m=Date.now;function b(At,xt,Qt){return setTimeout(Y(At,Qt),xt)}function x(At,xt,Qt){return Array.isArray(At)?(C(At,Qt[xt],Qt),!0):!1}function C(At,xt,Qt){var he;if(At)if(At.forEach)At.forEach(xt,Qt);else if(At.length!==i)for(he=0;he<At.length;)xt.call(Qt,At[he],he,At),he++;else for(he in At)At.hasOwnProperty(he)&&xt.call(Qt,At[he],he,At)}function M(At,xt,Qt){var he="DEPRECATED METHOD: "+xt+`
`+Qt+` AT 
`;return function(){var Fe=new Error("get-stack-trace"),ir=Fe&&Fe.stack?Fe.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Hr=t.console&&(t.console.warn||t.console.log);return Hr&&Hr.call(t.console,he,ir),At.apply(this,arguments)}}var U;typeof Object.assign!="function"?U=function(xt){if(xt===i||xt===null)throw new TypeError("Cannot convert undefined or null to object");for(var Qt=Object(xt),he=1;he<arguments.length;he++){var Fe=arguments[he];if(Fe!==i&&Fe!==null)for(var ir in Fe)Fe.hasOwnProperty(ir)&&(Qt[ir]=Fe[ir])}return Qt}:U=Object.assign;var N=M(function(xt,Qt,he){for(var Fe=Object.keys(Qt),ir=0;ir<Fe.length;)(!he||he&&xt[Fe[ir]]===i)&&(xt[Fe[ir]]=Qt[Fe[ir]]),ir++;return xt},"extend","Use `assign`."),Q=M(function(xt,Qt){return N(xt,Qt,!0)},"merge","Use `assign`.");function q(At,xt,Qt){var he=xt.prototype,Fe;Fe=At.prototype=Object.create(he),Fe.constructor=At,Fe._super=he,Qt&&U(Fe,Qt)}function Y(At,xt){return function(){return At.apply(xt,arguments)}}function tt(At,xt){return typeof At==o?At.apply(xt&&xt[0]||i,xt):At}function ft(At,xt){return At===i?xt:At}function pt(At,xt,Qt){C(Lt(xt),function(he){At.addEventListener(he,Qt,!1)})}function mt(At,xt,Qt){C(Lt(xt),function(he){At.removeEventListener(he,Qt,!1)})}function dt(At,xt){for(;At;){if(At==xt)return!0;At=At.parentNode}return!1}function Rt(At,xt){return At.indexOf(xt)>-1}function Lt(At){return At.trim().split(/\s+/g)}function st(At,xt,Qt){if(At.indexOf&&!Qt)return At.indexOf(xt);for(var he=0;he<At.length;){if(Qt&&At[he][Qt]==xt||!Qt&&At[he]===xt)return he;he++}return-1}function ct(At){return Array.prototype.slice.call(At,0)}function wt(At,xt,Qt){for(var he=[],Fe=[],ir=0;ir<At.length;){var Hr=xt?At[ir][xt]:At[ir];st(Fe,Hr)<0&&he.push(At[ir]),Fe[ir]=Hr,ir++}return Qt&&(xt?he=he.sort(function(Jn,li){return Jn[xt]>li[xt]}):he=he.sort()),he}function yt(At,xt){for(var Qt,he,Fe=xt[0].toUpperCase()+xt.slice(1),ir=0;ir<s.length;){if(Qt=s[ir],he=Qt?Qt+Fe:xt,he in At)return he;ir++}return i}var te=1;function Zt(){return te++}function re(At){var xt=At.ownerDocument||At;return xt.defaultView||xt.parentWindow||t}var Xt=/mobile|tablet|ip(ad|hone|od)|android/i,ne="ontouchstart"in t,se=yt(t,"PointerEvent")!==i,we=ne&&Xt.test(navigator.userAgent),it="touch",vt="pen",Ft="mouse",Ot="kinect",Wt=25,jt=1,ae=2,ie=4,Be=8,Te=1,Ne=2,Qe=4,He=8,ge=16,Ut=Ne|Qe,Yt=He|ge,tr=Ut|Yt,Ee=["x","y"],_e=["clientX","clientY"];function xe(At,xt){var Qt=this;this.manager=At,this.callback=xt,this.element=At.element,this.target=At.options.inputTarget,this.domHandler=function(he){tt(At.options.enable,[At])&&Qt.handler(he)},this.init()}xe.prototype={handler:function(){},init:function(){this.evEl&&pt(this.element,this.evEl,this.domHandler),this.evTarget&&pt(this.target,this.evTarget,this.domHandler),this.evWin&&pt(re(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&mt(this.element,this.evEl,this.domHandler),this.evTarget&&mt(this.target,this.evTarget,this.domHandler),this.evWin&&mt(re(this.element),this.evWin,this.domHandler)}};function De(At){var xt,Qt=At.options.inputClass;return Qt?xt=Qt:se?xt=Z:we?xt=Jt:ne?xt=Ge:xt=Rr,new xt(At,nr)}function nr(At,xt,Qt){var he=Qt.pointers.length,Fe=Qt.changedPointers.length,ir=xt&jt&&he-Fe===0,Hr=xt&(ie|Be)&&he-Fe===0;Qt.isFirst=!!ir,Qt.isFinal=!!Hr,ir&&(At.session={}),Qt.eventType=xt,ur(At,Qt),At.emit("hammer.input",Qt),At.recognize(Qt),At.session.prevInput=Qt}function ur(At,xt){var Qt=At.session,he=xt.pointers,Fe=he.length;Qt.firstInput||(Qt.firstInput=Dr(xt)),Fe>1&&!Qt.firstMultiple?Qt.firstMultiple=Dr(xt):Fe===1&&(Qt.firstMultiple=!1);var ir=Qt.firstInput,Hr=Qt.firstMultiple,Kn=Hr?Hr.center:ir.center,Jn=xt.center=Nr(he);xt.timeStamp=m(),xt.deltaTime=xt.timeStamp-ir.timeStamp,xt.angle=wn(Kn,Jn),xt.distance=Oe(Kn,Jn),Ir(Qt,xt),xt.offsetDirection=Tr(xt.deltaX,xt.deltaY);var li=fe(xt.deltaTime,xt.deltaX,xt.deltaY);xt.overallVelocityX=li.x,xt.overallVelocityY=li.y,xt.overallVelocity=f(li.x)>f(li.y)?li.x:li.y,xt.scale=Hr?Se(Hr.pointers,he):1,xt.rotation=Hr?Fr(Hr.pointers,he):0,xt.maxPointers=Qt.prevInput?xt.pointers.length>Qt.prevInput.maxPointers?xt.pointers.length:Qt.prevInput.maxPointers:xt.pointers.length,Sr(Qt,xt);var kn=At.element;dt(xt.srcEvent.target,kn)&&(kn=xt.srcEvent.target),xt.target=kn}function Ir(At,xt){var Qt=xt.center,he=At.offsetDelta||{},Fe=At.prevDelta||{},ir=At.prevInput||{};(xt.eventType===jt||ir.eventType===ie)&&(Fe=At.prevDelta={x:ir.deltaX||0,y:ir.deltaY||0},he=At.offsetDelta={x:Qt.x,y:Qt.y}),xt.deltaX=Fe.x+(Qt.x-he.x),xt.deltaY=Fe.y+(Qt.y-he.y)}function Sr(At,xt){var Qt=At.lastInterval||xt,he=xt.timeStamp-Qt.timeStamp,Fe,ir,Hr,Kn;if(xt.eventType!=Be&&(he>Wt||Qt.velocity===i)){var Jn=xt.deltaX-Qt.deltaX,li=xt.deltaY-Qt.deltaY,kn=fe(he,Jn,li);ir=kn.x,Hr=kn.y,Fe=f(kn.x)>f(kn.y)?kn.x:kn.y,Kn=Tr(Jn,li),At.lastInterval=xt}else Fe=Qt.velocity,ir=Qt.velocityX,Hr=Qt.velocityY,Kn=Qt.direction;xt.velocity=Fe,xt.velocityX=ir,xt.velocityY=Hr,xt.direction=Kn}function Dr(At){for(var xt=[],Qt=0;Qt<At.pointers.length;)xt[Qt]={clientX:A(At.pointers[Qt].clientX),clientY:A(At.pointers[Qt].clientY)},Qt++;return{timeStamp:m(),pointers:xt,center:Nr(xt),deltaX:At.deltaX,deltaY:At.deltaY}}function Nr(At){var xt=At.length;if(xt===1)return{x:A(At[0].clientX),y:A(At[0].clientY)};for(var Qt=0,he=0,Fe=0;Fe<xt;)Qt+=At[Fe].clientX,he+=At[Fe].clientY,Fe++;return{x:A(Qt/xt),y:A(he/xt)}}function fe(At,xt,Qt){return{x:xt/At||0,y:Qt/At||0}}function Tr(At,xt){return At===xt?Te:f(At)>=f(xt)?At<0?Ne:Qe:xt<0?He:ge}function Oe(At,xt,Qt){Qt||(Qt=Ee);var he=xt[Qt[0]]-At[Qt[0]],Fe=xt[Qt[1]]-At[Qt[1]];return Math.sqrt(he*he+Fe*Fe)}function wn(At,xt,Qt){Qt||(Qt=Ee);var he=xt[Qt[0]]-At[Qt[0]],Fe=xt[Qt[1]]-At[Qt[1]];return Math.atan2(Fe,he)*180/Math.PI}function Fr(At,xt){return wn(xt[1],xt[0],_e)+wn(At[1],At[0],_e)}function Se(At,xt){return Oe(xt[0],xt[1],_e)/Oe(At[0],At[1],_e)}var Xe={mousedown:jt,mousemove:ae,mouseup:ie},qe="mousedown",Yr="mousemove mouseup";function Rr(){this.evEl=qe,this.evWin=Yr,this.pressed=!1,xe.apply(this,arguments)}q(Rr,xe,{handler:function(xt){var Qt=Xe[xt.type];Qt&jt&&xt.button===0&&(this.pressed=!0),Qt&ae&&xt.which!==1&&(Qt=ie),this.pressed&&(Qt&ie&&(this.pressed=!1),this.callback(this.manager,Qt,{pointers:[xt],changedPointers:[xt],pointerType:Ft,srcEvent:xt}))}});var pr={pointerdown:jt,pointermove:ae,pointerup:ie,pointercancel:Be,pointerout:Be},on={2:it,3:vt,4:Ft,5:Ot},Kr="pointerdown",Ct="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(Kr="MSPointerDown",Ct="MSPointerMove MSPointerUp MSPointerCancel");function Z(){this.evEl=Kr,this.evWin=Ct,xe.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}q(Z,xe,{handler:function(xt){var Qt=this.store,he=!1,Fe=xt.type.toLowerCase().replace("ms",""),ir=pr[Fe],Hr=on[xt.pointerType]||xt.pointerType,Kn=Hr==it,Jn=st(Qt,xt.pointerId,"pointerId");ir&jt&&(xt.button===0||Kn)?Jn<0&&(Qt.push(xt),Jn=Qt.length-1):ir&(ie|Be)&&(he=!0),!(Jn<0)&&(Qt[Jn]=xt,this.callback(this.manager,ir,{pointers:Qt,changedPointers:[xt],pointerType:Hr,srcEvent:xt}),he&&Qt.splice(Jn,1))}});var J={touchstart:jt,touchmove:ae,touchend:ie,touchcancel:Be},ot="touchstart",Et="touchstart touchmove touchend touchcancel";function Nt(){this.evTarget=ot,this.evWin=Et,this.started=!1,xe.apply(this,arguments)}q(Nt,xe,{handler:function(xt){var Qt=J[xt.type];if(Qt===jt&&(this.started=!0),!!this.started){var he=zt.call(this,xt,Qt);Qt&(ie|Be)&&he[0].length-he[1].length===0&&(this.started=!1),this.callback(this.manager,Qt,{pointers:he[0],changedPointers:he[1],pointerType:it,srcEvent:xt})}}});function zt(At,xt){var Qt=ct(At.touches),he=ct(At.changedTouches);return xt&(ie|Be)&&(Qt=wt(Qt.concat(he),"identifier",!0)),[Qt,he]}var qt={touchstart:jt,touchmove:ae,touchend:ie,touchcancel:Be},St="touchstart touchmove touchend touchcancel";function Jt(){this.evTarget=St,this.targetIds={},xe.apply(this,arguments)}q(Jt,xe,{handler:function(xt){var Qt=qt[xt.type],he=me.call(this,xt,Qt);he&&this.callback(this.manager,Qt,{pointers:he[0],changedPointers:he[1],pointerType:it,srcEvent:xt})}});function me(At,xt){var Qt=ct(At.touches),he=this.targetIds;if(xt&(jt|ae)&&Qt.length===1)return he[Qt[0].identifier]=!0,[Qt,Qt];var Fe,ir,Hr=ct(At.changedTouches),Kn=[],Jn=this.target;if(ir=Qt.filter(function(li){return dt(li.target,Jn)}),xt===jt)for(Fe=0;Fe<ir.length;)he[ir[Fe].identifier]=!0,Fe++;for(Fe=0;Fe<Hr.length;)he[Hr[Fe].identifier]&&Kn.push(Hr[Fe]),xt&(ie|Be)&&delete he[Hr[Fe].identifier],Fe++;if(Kn.length)return[wt(ir.concat(Kn),"identifier",!0),Kn]}var pe=2500,de=25;function Ge(){xe.apply(this,arguments);var At=Y(this.handler,this);this.touch=new Jt(this.manager,At),this.mouse=new Rr(this.manager,At),this.primaryTouch=null,this.lastTouches=[]}q(Ge,xe,{handler:function(xt,Qt,he){var Fe=he.pointerType==it,ir=he.pointerType==Ft;if(!(ir&&he.sourceCapabilities&&he.sourceCapabilities.firesTouchEvents)){if(Fe)Ye.call(this,Qt,he);else if(ir&&cr.call(this,he))return;this.callback(xt,Qt,he)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Ye(At,xt){At&jt?(this.primaryTouch=xt.changedPointers[0].identifier,Cr.call(this,xt)):At&(ie|Be)&&Cr.call(this,xt)}function Cr(At){var xt=At.changedPointers[0];if(xt.identifier===this.primaryTouch){var Qt={x:xt.clientX,y:xt.clientY};this.lastTouches.push(Qt);var he=this.lastTouches,Fe=function(){var ir=he.indexOf(Qt);ir>-1&&he.splice(ir,1)};setTimeout(Fe,pe)}}function cr(At){for(var xt=At.srcEvent.clientX,Qt=At.srcEvent.clientY,he=0;he<this.lastTouches.length;he++){var Fe=this.lastTouches[he],ir=Math.abs(xt-Fe.x),Hr=Math.abs(Qt-Fe.y);if(ir<=de&&Hr<=de)return!0}return!1}var Pr=yt(a.style,"touchAction"),kr=Pr!==i,Qr="compute",gn="auto",gr="manipulation",Wr="none",vn="pan-x",Dn="pan-y",Dt=rn();function Ue(At,xt){this.manager=At,this.set(xt)}Ue.prototype={set:function(At){At==Qr&&(At=this.compute()),kr&&this.manager.element.style&&Dt[At]&&(this.manager.element.style[Pr]=At),this.actions=At.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var At=[];return C(this.manager.recognizers,function(xt){tt(xt.options.enable,[xt])&&(At=At.concat(xt.getTouchAction()))}),Ie(At.join(" "))},preventDefaults:function(At){var xt=At.srcEvent,Qt=At.offsetDirection;if(this.manager.session.prevented){xt.preventDefault();return}var he=this.actions,Fe=Rt(he,Wr)&&!Dt[Wr],ir=Rt(he,Dn)&&!Dt[Dn],Hr=Rt(he,vn)&&!Dt[vn];if(Fe){var Kn=At.pointers.length===1,Jn=At.distance<2,li=At.deltaTime<250;if(Kn&&Jn&&li)return}if(!(Hr&&ir)&&(Fe||ir&&Qt&Ut||Hr&&Qt&Yt))return this.preventSrc(xt)},preventSrc:function(At){this.manager.session.prevented=!0,At.preventDefault()}};function Ie(At){if(Rt(At,Wr))return Wr;var xt=Rt(At,vn),Qt=Rt(At,Dn);return xt&&Qt?Wr:xt||Qt?xt?vn:Dn:Rt(At,gr)?gr:gn}function rn(){if(!kr)return!1;var At={},xt=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Qt){At[Qt]=xt?t.CSS.supports("touch-action",Qt):!0}),At}var Mn=1,xr=2,mn=4,bi=8,yn=bi,nn=16,wi=32;function Xn(At){this.options=U({},this.defaults,At||{}),this.id=Zt(),this.manager=null,this.options.enable=ft(this.options.enable,!0),this.state=Mn,this.simultaneous={},this.requireFail=[]}Xn.prototype={defaults:{},set:function(At){return U(this.options,At),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(At){if(x(At,"recognizeWith",this))return this;var xt=this.simultaneous;return At=Ho(At,this),xt[At.id]||(xt[At.id]=At,At.recognizeWith(this)),this},dropRecognizeWith:function(At){return x(At,"dropRecognizeWith",this)?this:(At=Ho(At,this),delete this.simultaneous[At.id],this)},requireFailure:function(At){if(x(At,"requireFailure",this))return this;var xt=this.requireFail;return At=Ho(At,this),st(xt,At)===-1&&(xt.push(At),At.requireFailure(this)),this},dropRequireFailure:function(At){if(x(At,"dropRequireFailure",this))return this;At=Ho(At,this);var xt=st(this.requireFail,At);return xt>-1&&this.requireFail.splice(xt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(At){return!!this.simultaneous[At.id]},emit:function(At){var xt=this,Qt=this.state;function he(Fe){xt.manager.emit(Fe,At)}Qt<bi&&he(xt.options.event+os(Qt)),he(xt.options.event),At.additionalEvent&&he(At.additionalEvent),Qt>=bi&&he(xt.options.event+os(Qt))},tryEmit:function(At){if(this.canEmit())return this.emit(At);this.state=wi},canEmit:function(){for(var At=0;At<this.requireFail.length;){if(!(this.requireFail[At].state&(wi|Mn)))return!1;At++}return!0},recognize:function(At){var xt=U({},At);if(!tt(this.options.enable,[this,xt])){this.reset(),this.state=wi;return}this.state&(yn|nn|wi)&&(this.state=Mn),this.state=this.process(xt),this.state&(xr|mn|bi|nn)&&this.tryEmit(xt)},process:function(At){},getTouchAction:function(){},reset:function(){}};function os(At){return At&nn?"cancel":At&bi?"end":At&mn?"move":At&xr?"start":""}function Rs(At){return At==ge?"down":At==He?"up":At==Ne?"left":At==Qe?"right":""}function Ho(At,xt){var Qt=xt.manager;return Qt?Qt.get(At):At}function Or(){Xn.apply(this,arguments)}q(Or,Xn,{defaults:{pointers:1},attrTest:function(At){var xt=this.options.pointers;return xt===0||At.pointers.length===xt},process:function(At){var xt=this.state,Qt=At.eventType,he=xt&(xr|mn),Fe=this.attrTest(At);return he&&(Qt&Be||!Fe)?xt|nn:he||Fe?Qt&ie?xt|bi:xt&xr?xt|mn:xr:wi}});function Xs(){Or.apply(this,arguments),this.pX=null,this.pY=null}q(Xs,Or,{defaults:{event:"pan",threshold:10,pointers:1,direction:tr},getTouchAction:function(){var At=this.options.direction,xt=[];return At&Ut&&xt.push(Dn),At&Yt&&xt.push(vn),xt},directionTest:function(At){var xt=this.options,Qt=!0,he=At.distance,Fe=At.direction,ir=At.deltaX,Hr=At.deltaY;return Fe&xt.direction||(xt.direction&Ut?(Fe=ir===0?Te:ir<0?Ne:Qe,Qt=ir!=this.pX,he=Math.abs(At.deltaX)):(Fe=Hr===0?Te:Hr<0?He:ge,Qt=Hr!=this.pY,he=Math.abs(At.deltaY))),At.direction=Fe,Qt&&he>xt.threshold&&Fe&xt.direction},attrTest:function(At){return Or.prototype.attrTest.call(this,At)&&(this.state&xr||!(this.state&xr)&&this.directionTest(At))},emit:function(At){this.pX=At.deltaX,this.pY=At.deltaY;var xt=Rs(At.direction);xt&&(At.additionalEvent=this.options.event+xt),this._super.emit.call(this,At)}});function Bs(){Or.apply(this,arguments)}q(Bs,Or,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Wr]},attrTest:function(At){return this._super.attrTest.call(this,At)&&(Math.abs(At.scale-1)>this.options.threshold||this.state&xr)},emit:function(At){if(At.scale!==1){var xt=At.scale<1?"in":"out";At.additionalEvent=this.options.event+xt}this._super.emit.call(this,At)}});function Tn(){Xn.apply(this,arguments),this._timer=null,this._input=null}q(Tn,Xn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[gn]},process:function(At){var xt=this.options,Qt=At.pointers.length===xt.pointers,he=At.distance<xt.threshold,Fe=At.deltaTime>xt.time;if(this._input=At,!he||!Qt||At.eventType&(ie|Be)&&!Fe)this.reset();else if(At.eventType&jt)this.reset(),this._timer=b(function(){this.state=yn,this.tryEmit()},xt.time,this);else if(At.eventType&ie)return yn;return wi},reset:function(){clearTimeout(this._timer)},emit:function(At){this.state===yn&&(At&&At.eventType&ie?this.manager.emit(this.options.event+"up",At):(this._input.timeStamp=m(),this.manager.emit(this.options.event,this._input)))}});function _o(){Or.apply(this,arguments)}q(_o,Or,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Wr]},attrTest:function(At){return this._super.attrTest.call(this,At)&&(Math.abs(At.rotation)>this.options.threshold||this.state&xr)}});function Fi(){Or.apply(this,arguments)}q(Fi,Or,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ut|Yt,pointers:1},getTouchAction:function(){return Xs.prototype.getTouchAction.call(this)},attrTest:function(At){var xt=this.options.direction,Qt;return xt&(Ut|Yt)?Qt=At.overallVelocity:xt&Ut?Qt=At.overallVelocityX:xt&Yt&&(Qt=At.overallVelocityY),this._super.attrTest.call(this,At)&&xt&At.offsetDirection&&At.distance>this.options.threshold&&At.maxPointers==this.options.pointers&&f(Qt)>this.options.velocity&&At.eventType&ie},emit:function(At){var xt=Rs(At.offsetDirection);xt&&this.manager.emit(this.options.event+xt,At),this.manager.emit(this.options.event,At)}});function Mi(){Xn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}q(Mi,Xn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[gr]},process:function(At){var xt=this.options,Qt=At.pointers.length===xt.pointers,he=At.distance<xt.threshold,Fe=At.deltaTime<xt.time;if(this.reset(),At.eventType&jt&&this.count===0)return this.failTimeout();if(he&&Fe&&Qt){if(At.eventType!=ie)return this.failTimeout();var ir=this.pTime?At.timeStamp-this.pTime<xt.interval:!0,Hr=!this.pCenter||Oe(this.pCenter,At.center)<xt.posThreshold;this.pTime=At.timeStamp,this.pCenter=At.center,!Hr||!ir?this.count=1:this.count+=1,this._input=At;var Kn=this.count%xt.taps;if(Kn===0)return this.hasRequireFailures()?(this._timer=b(function(){this.state=yn,this.tryEmit()},xt.interval,this),xr):yn}return wi},failTimeout:function(){return this._timer=b(function(){this.state=wi},this.options.interval,this),wi},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==yn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Yn(At,xt){return xt=xt||{},xt.recognizers=ft(xt.recognizers,Yn.defaults.preset),new zo(At,xt)}Yn.VERSION="2.0.7",Yn.defaults={domEvents:!1,touchAction:Qr,enable:!0,inputTarget:null,inputClass:null,preset:[[_o,{enable:!1}],[Bs,{enable:!1},["rotate"]],[Fi,{direction:Ut}],[Xs,{direction:Ut},["swipe"]],[Mi],[Mi,{event:"doubletap",taps:2},["tap"]],[Tn]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Ti=1,an=2;function zo(At,xt){this.options=U({},Yn.defaults,xt||{}),this.options.inputTarget=this.options.inputTarget||At,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=At,this.input=De(this),this.touchAction=new Ue(this,this.options.touchAction),Go(this,!0),C(this.options.recognizers,function(Qt){var he=this.add(new Qt[0](Qt[1]));Qt[2]&&he.recognizeWith(Qt[2]),Qt[3]&&he.requireFailure(Qt[3])},this)}zo.prototype={set:function(At){return U(this.options,At),At.touchAction&&this.touchAction.update(),At.inputTarget&&(this.input.destroy(),this.input.target=At.inputTarget,this.input.init()),this},stop:function(At){this.session.stopped=At?an:Ti},recognize:function(At){var xt=this.session;if(!xt.stopped){this.touchAction.preventDefaults(At);var Qt,he=this.recognizers,Fe=xt.curRecognizer;(!Fe||Fe&&Fe.state&yn)&&(Fe=xt.curRecognizer=null);for(var ir=0;ir<he.length;)Qt=he[ir],xt.stopped!==an&&(!Fe||Qt==Fe||Qt.canRecognizeWith(Fe))?Qt.recognize(At):Qt.reset(),!Fe&&Qt.state&(xr|mn|bi)&&(Fe=xt.curRecognizer=Qt),ir++}},get:function(At){if(At instanceof Xn)return At;for(var xt=this.recognizers,Qt=0;Qt<xt.length;Qt++)if(xt[Qt].options.event==At)return xt[Qt];return null},add:function(At){if(x(At,"add",this))return this;var xt=this.get(At.options.event);return xt&&this.remove(xt),this.recognizers.push(At),At.manager=this,this.touchAction.update(),At},remove:function(At){if(x(At,"remove",this))return this;if(At=this.get(At),At){var xt=this.recognizers,Qt=st(xt,At);Qt!==-1&&(xt.splice(Qt,1),this.touchAction.update())}return this},on:function(At,xt){if(At!==i&&xt!==i){var Qt=this.handlers;return C(Lt(At),function(he){Qt[he]=Qt[he]||[],Qt[he].push(xt)}),this}},off:function(At,xt){if(At!==i){var Qt=this.handlers;return C(Lt(At),function(he){xt?Qt[he]&&Qt[he].splice(st(Qt[he],xt),1):delete Qt[he]}),this}},emit:function(At,xt){this.options.domEvents&&Ys(At,xt);var Qt=this.handlers[At]&&this.handlers[At].slice();if(!(!Qt||!Qt.length)){xt.type=At,xt.preventDefault=function(){xt.srcEvent.preventDefault()};for(var he=0;he<Qt.length;)Qt[he](xt),he++}},destroy:function(){this.element&&Go(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Go(At,xt){var Qt=At.element;if(Qt.style){var he;C(At.options.cssProps,function(Fe,ir){he=yt(Qt.style,ir),xt?(At.oldCssProps[he]=Qt.style[he],Qt.style[he]=Fe):Qt.style[he]=At.oldCssProps[he]||""}),xt||(At.oldCssProps={})}}function Ys(At,xt){var Qt=e.createEvent("Event");Qt.initEvent(At,!0,!0),Qt.gesture=xt,xt.target.dispatchEvent(Qt)}U(Yn,{INPUT_START:jt,INPUT_MOVE:ae,INPUT_END:ie,INPUT_CANCEL:Be,STATE_POSSIBLE:Mn,STATE_BEGAN:xr,STATE_CHANGED:mn,STATE_ENDED:bi,STATE_RECOGNIZED:yn,STATE_CANCELLED:nn,STATE_FAILED:wi,DIRECTION_NONE:Te,DIRECTION_LEFT:Ne,DIRECTION_RIGHT:Qe,DIRECTION_UP:He,DIRECTION_DOWN:ge,DIRECTION_HORIZONTAL:Ut,DIRECTION_VERTICAL:Yt,DIRECTION_ALL:tr,Manager:zo,Input:xe,TouchAction:Ue,TouchInput:Jt,MouseInput:Rr,PointerEventInput:Z,TouchMouseInput:Ge,SingleTouchInput:Nt,Recognizer:Xn,AttrRecognizer:Or,Tap:Mi,Pan:Xs,Swipe:Fi,Pinch:Bs,Rotate:_o,Press:Tn,on:pt,off:mt,each:C,merge:Q,extend:N,assign:U,inherit:q,bindFn:Y,prefixed:yt});var dc=typeof t<"u"?t:typeof self<"u"?self:{};dc.Hammer=Yn,typeof i=="function"&&i.amd?i(function(){return Yn}):r.exports?r.exports=Yn:t[n]=Yn})(window,document,"Hammer")})(m3);var lg=m3.exports;const Ql=wp({__proto__:null,default:xp(lg)},[lg]),y3=1,_3=2,Nb=4,Sq={mousedown:y3,mousemove:_3,mouseup:Nb};function Tq(r,t){for(let e=0;e<r.length;e++)if(t(r[e]))return!0;return!1}function Iq(r){const t=r.prototype.handler;r.prototype.handler=function(n){const i=this.store;n.button>0&&n.type==="pointerdown"&&(Tq(i,s=>s.pointerId===n.pointerId)||i.push(n)),t.call(this,n)}}function Lq(r){r.prototype.handler=function(e){let n=Sq[e.type];n&y3&&e.button>=0&&(this.pressed=!0),n&_3&&e.which===0&&(n=Nb),this.pressed&&(n&Nb&&(this.pressed=!1),this.callback(this.manager,n,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}}Iq(lg.PointerEventInput),Lq(lg.MouseInput);const Fq=lg.Manager;class U0{constructor(t,e,n){this.element=t,this.callback=e,this.options={enable:!0,...n}}}const Mq=Ql?[[Ql.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Ql.Rotate,{enable:!1}],[Ql.Pinch,{enable:!1}],[Ql.Swipe,{enable:!1}],[Ql.Pan,{threshold:0,enable:!1}],[Ql.Press,{enable:!1}],[Ql.Tap,{event:"doubletap",taps:2,enable:!1}],[Ql.Tap,{event:"anytap",enable:!1}],[Ql.Tap,{enable:!1}]]:null,v3={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Pq={doubletap:["tap"]},Uq={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Qb={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Rq={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},b3={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Oq=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",tf=typeof window<"u"?window:global;let Hb=!1;try{const r={get passive(){return Hb=!0,!0}};tf.addEventListener("test",null,r),tf.removeEventListener("test",null)}catch{Hb=!1}const Dq=Oq.indexOf("firefox")!==-1,{WHEEL_EVENTS:kq}=Qb,w3="wheel",x3=4.000244140625,Nq=40,Qq=.25;class Hq extends U0{constructor(t,e,n){super(t,e,n),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;tf.WheelEvent&&(Dq&&i.deltaMode===tf.WheelEvent.DOM_DELTA_PIXEL&&(s/=tf.devicePixelRatio),i.deltaMode===tf.WheelEvent.DOM_DELTA_LINE&&(s*=Nq)),s!==0&&s%x3===0&&(s=Math.floor(s/x3)),i.shiftKey&&s&&(s=s*Qq),this.callback({type:w3,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(kq),this.events.forEach(i=>t.addEventListener(i,this.handleEvent,Hb?{passive:!1}:!1))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===w3&&(this.options.enable=e)}}const{MOUSE_EVENTS:zq}=Qb,B3="pointermove",C3="pointerover",E3="pointerout",S3="pointerenter",T3="pointerleave";class Gq extends U0{constructor(t,e,n){super(t,e,n),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(zq),this.events.forEach(s=>t.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===B3&&(this.enableMoveEvent=e),t===C3&&(this.enableOverEvent=e),t===E3&&(this.enableOutEvent=e),t===S3&&(this.enableEnterEvent=e),t===T3&&(this.enableLeaveEvent=e)}handleOverEvent(t){this.enableOverEvent&&t.type==="mouseover"&&this._emit(C3,t)}handleOutEvent(t){this.enableOutEvent&&t.type==="mouseout"&&this._emit(E3,t)}handleEnterEvent(t){this.enableEnterEvent&&t.type==="mouseenter"&&this._emit(S3,t)}handleLeaveEvent(t){this.enableLeaveEvent&&t.type==="mouseleave"&&this._emit(T3,t)}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":t.which===0&&(this.pressed=!1),this.pressed||this._emit(B3,t);break;case"mouseup":this.pressed=!1;break}}_emit(t,e){this.callback({type:t,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const{KEY_EVENTS:Vq}=Qb,I3="keydown",L3="keyup";class jq extends U0{constructor(t,e,n){super(t,e,n),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:I3,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:L3,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Vq),t.tabIndex=this.options.tabIndex||0,t.style.outline="none",this.events.forEach(i=>t.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===I3&&(this.enableDownEvent=e),t===L3&&(this.enableUpEvent=e)}}const F3="contextmenu";class qq extends U0{constructor(t,e,n){super(t,e,n),this.handleEvent=i=>{this.options.enable&&this.callback({type:F3,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===F3&&(this.options.enable=e)}}const zb=1,R0=2,Gb=4,Kq={pointerdown:zb,pointermove:R0,pointerup:Gb,mousedown:zb,mousemove:R0,mouseup:Gb},Wq=1,$q=2,Xq=3,Yq=0,Jq=1,Zq=2,tK=1,eK=2,rK=4;function nK(r){const t=Kq[r.srcEvent.type];if(!t)return null;const{buttons:e,button:n,which:i}=r.srcEvent;let s=!1,a=!1,o=!1;return t===Gb||t===R0&&!Number.isFinite(e)?(s=i===Wq,a=i===$q,o=i===Xq):t===R0?(s=!!(e&tK),a=!!(e&rK),o=!!(e&eK)):t===zb&&(s=n===Yq,a=n===Jq,o=n===Zq),{leftButton:s,middleButton:a,rightButton:o}}function iK(r,t){const e=r.center;if(!e)return null;const n=t.getBoundingClientRect(),i=n.width/t.offsetWidth||1,s=n.height/t.offsetHeight||1,a={x:(e.x-n.left-t.clientLeft)/i,y:(e.y-n.top-t.clientTop)/s};return{center:e,offsetCenter:a}}const Vb={srcElement:"root",priority:0};class sK{constructor(t){this.handleEvent=e=>{if(this.isEmpty())return;const n=this._normalizeEvent(e);let i=e.srcEvent.target;for(;i&&i!==n.rootElement;){if(this._emit(n,i),n.handled)return;i=i.parentNode}this._emit(n,"root")},this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;const{handlers:a,handlersByElement:o}=this;let A=Vb;typeof n=="string"||n&&n.addEventListener?A={...Vb,srcElement:n}:n&&(A={...Vb,...n});let f=o.get(A.srcElement);f||(f=[],o.set(A.srcElement,f));const m={type:t,handler:e,srcElement:A.srcElement,priority:A.priority};i&&(m.once=!0),s&&(m.passive=!0),a.push(m),this._active=this._active||!m.passive;let b=f.length-1;for(;b>=0&&!(f[b].priority>=m.priority);)b--;f.splice(b+1,0,m)}remove(t,e){const{handlers:n,handlersByElement:i}=this;for(let s=n.length-1;s>=0;s--){const a=n[s];if(a.type===t&&a.handler===e){n.splice(s,1);const o=i.get(a.srcElement);o.splice(o.indexOf(a),1),o.length===0&&i.delete(a.srcElement)}}this._active=n.some(s=>!s.passive)}_emit(t,e){const n=this.handlersByElement.get(e);if(n){let i=!1;const s=()=>{t.handled=!0},a=()=>{t.handled=!0,i=!0},o=[];for(let A=0;A<n.length;A++){const{type:f,handler:m,once:b}=n[A];if(m({...t,type:f,stopPropagation:s,stopImmediatePropagation:a}),b&&o.push(n[A]),i)break}for(let A=0;A<o.length;A++){const{type:f,handler:m}=o[A];this.remove(f,m)}}}_normalizeEvent(t){const e=this.eventManager.getElement();return{...t,...nK(t),...iK(t,e),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:e}}}const oK={events:null,recognizers:null,recognizerOptions:{},Manager:Fq,touchAction:"none",tabIndex:0};class aK{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0;this._onBasicInput=i=>{const{srcEvent:s}=i,a=Uq[s.type];a&&this.manager.emit(a,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...oK,...e},this.events=new Map,this.setElement(t);const{events:n}=this.options;n&&this.on(n)}getElement(){return this.element}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this,n=e.Manager;this.manager=new n(t,{touchAction:e.touchAction,recognizers:e.recognizers||Mq}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys(v3).forEach(i=>{const s=this.manager.get(i);s&&v3[i].forEach(a=>{s.recognizeWith(a)})});for(const i in e.recognizerOptions){const s=this.manager.get(i);if(s){const a=e.recognizerOptions[i];delete a.enable,s.set(a)}}this.wheelInput=new Hq(t,this._onOtherEvent,{enable:!1}),this.moveInput=new Gq(t,this._onOtherEvent,{enable:!1}),this.keyInput=new jq(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new qq(t,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,n){this._addEventHandler(t,e,n,!1)}once(t,e,n){this._addEventHandler(t,e,n,!0)}watch(t,e,n){this._addEventHandler(t,e,n,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:n}=this;if(!n)return;const i=n.get(t);if(i&&i.options.enable!==e){i.set({enable:e});const s=Pq[t];s&&!this.options.recognizers&&s.forEach(a=>{const o=n.get(a);e?(o.requireFailure(t),i.dropRequireFailure(a)):o.dropRequireFailure(t)})}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,n,i,s){if(typeof t!="string"){n=e;for(const m in t)this._addEventHandler(m,t[m],n,i,s);return}const{manager:a,events:o}=this,A=b3[t]||t;let f=o.get(A);f||(f=new sK(this),o.set(A,f),f.recognizerName=Rq[A]||A,a&&a.on(A,f.handleEvent)),f.add(t,e,n,i,s),f.isEmpty()||this._toggleRecognizer(f.recognizerName,!0)}_removeEventHandler(t,e){if(typeof t!="string"){for(const a in t)this._removeEventHandler(a,t[a]);return}const{events:n}=this,i=b3[t]||t,s=n.get(i);if(s&&(s.remove(t,e),s.isEmpty())){const{recognizerName:a}=s;let o=!1;for(const A of n.values())if(A.recognizerName===a&&!A.isEmpty()){o=!0;break}o||this._toggleRecognizer(a,!1)}}}function Rh(){}const M3={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Rh,onResize:Rh,onViewStateChange:Rh,onInteractionStateChange:Rh,onBeforeRender:Rh,onAfterRender:Rh,onLoad:Rh,onError:r=>Fn.error(r.message,r.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:r=>{let{isDragging:t}=r;return t?"grabbing":"grab"},getTooltip:null,debug:!1,drawPickingColors:!1};class jb{constructor(t){W(this,"props",void 0),W(this,"width",0),W(this,"height",0),W(this,"userData",{}),W(this,"canvas",null),W(this,"viewManager",null),W(this,"layerManager",null),W(this,"effectManager",null),W(this,"deckRenderer",null),W(this,"deckPicker",null),W(this,"eventManager",null),W(this,"tooltip",null),W(this,"metrics",void 0),W(this,"animationLoop",void 0),W(this,"stats",void 0),W(this,"viewState",void 0),W(this,"cursorState",void 0),W(this,"_needsRedraw",void 0),W(this,"_pickRequest",void 0),W(this,"_lastPointerDownInfo",null),W(this,"_metricsCounter",void 0),W(this,"_onPointerMove",e=>{const{_pickRequest:n}=this;if(e.type==="pointerleave")n.x=-1,n.y=-1,n.radius=0;else{if(e.leftButton||e.rightButton)return;{const i=e.offsetCenter;if(!i)return;n.x=i.x,n.y=i.y,n.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:n.x,y:n.y}),n.event=e}),W(this,"_onEvent",e=>{const n=XS[e.type],i=e.offsetCenter;if(!n||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),a=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=a,A=o&&(o[n.handler]||o.props[n.handler]),f=this.props[n.handler];let m=!1;A&&(m=A.call(o,a,e)),!m&&f&&f(a,e)}),W(this,"_onPointerDown",e=>{const n=e.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:n.x,y:n.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...M3,...t},t=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},t.viewState&&t.initialViewState&&Fn.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),VS()==="IE"&&Fn.warn("IE 11 is not supported")(),this.viewState=t.initialViewState,t.gl||typeof document<"u"&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new Dv({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&sg.setOptions(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){var t,e,n,i,s,a,o,A;if((t=this.animationLoop)===null||t===void 0||t.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(e=this.layerManager)===null||e===void 0||e.finalize(),this.layerManager=null,(n=this.viewManager)===null||n===void 0||n.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(a=this.deckPicker)===null||a===void 0||a.finalize(),this.deckPicker=null,(o=this.eventManager)===null||o===void 0||o.destroy(),this.eventManager=null,(A=this.tooltip)===null||A===void 0||A.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var f;(f=this.canvas.parentElement)===null||f===void 0||f.removeChild(this.canvas),this.canvas=null}}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&Fn.removed("onLayerHover","onHover")(),"onLayerClick"in t&&Fn.removed("onLayerClick","onClick")(),t.initialViewState&&!Nl(this.props.initialViewState,t.initialViewState,3)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),i=this.layerManager.needsRedraw(t),s=this.effectManager.needsRedraw(t),a=this.deckRenderer.needsRedraw(t);return e=e||n||i||s||a,e}redraw(t){if(!this.layerManager)return;let e=this.needsRedraw({clearRedrawFlags:!0});e=t||e,e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}get isInitialized(){return this.viewManager!==null}getViews(){return qs(this.viewManager),this.viewManager.views}getViewports(t){return qs(this.viewManager),this.viewManager.getViewports(t)}getCanvas(){return this.canvas}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_addDefaultEffect(t){this.effectManager.addDefaultEffect(t)}_pick(t,e,n){qs(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(e).timeStart();const s=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(e).timeEnd(),s}_createCanvas(t){let e=t.canvas;return typeof e=="string"&&(e=document.getElementById(e),qs(e)),e||(e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay",(t.parent||document.body).appendChild(e)),Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;const{width:e,height:n}=t;if(e||e===0){const s=Number.isFinite(e)?"".concat(e,"px"):e;this.canvas.style.width=s}if(n||n===0){var i;const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.position=((i=t.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var t,e;const{canvas:n}=this;if(!n)return;const i=(t=n.clientWidth)!==null&&t!==void 0?t:n.width,s=(e=n.clientHeight)!==null&&e!==void 0?e:n.height;if(i!==this.width||s!==this.height){var a,o;this.width=i,this.height=s,(a=this.viewManager)===null||a===void 0||a.setProps({width:i,height:s}),(o=this.layerManager)===null||o===void 0||o.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:s})}}_createAnimationLoop(t){const{width:e,height:n,gl:i,glOptions:s,debug:a,onError:o,onBeforeRender:A,onAfterRender:f,useDevicePixels:m}=t;return new zz({width:e,height:n,useDevicePixels:m,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:b=>h5({...s,...b,canvas:this.canvas,debug:a,onContextLost:()=>this._onContextLost()}),onInitialize:b=>this._setGLContext(b.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:A,onAfterRender:f,onError:o})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new kb({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:n,emptyInfo:i}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=n.length>0;let s=i,a=!1;for(const o of n){var e;s=o,a=((e=o.layer)===null||e===void 0?void 0:e.onHover(o,t.event))||a}if(!a&&this.props.onHover&&this.props.onHover(s,t.event),this.props.getTooltip&&this.tooltip){const o=this.props.getTooltip(s);this.tooltip.setTooltip(o,s.x,s.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,Ov(t,{enable:!0,copyState:!0})),this.tooltip=new Eq(this.canvas),Bu(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new HT;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new aK(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in XS)this.eventManager.on(i,this._onEvent);this.viewManager=new Jj({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new Yj(t,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new pq,this.deckRenderer=new yq(t),this.deckPicker=new Bq(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:n}=this.layerManager.context;Bu(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:n})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Fn.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.cursorState.isDragging=t.isDragging||!1,this.props.onInteractionStateChange(t)}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=Th.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}W(jb,"defaultProps",M3),W(jb,"VERSION",WQ);class qb{constructor(t,e){W(this,"opts",void 0),W(this,"source",void 0),this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:n}=this.source,{size:i}=e;let s=n;if(n&&n.length!==i){s=new Float32Array(i);const a=e.elementOffset||0;for(let o=0;o<i;++o)s[o]=n[a+o]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function cK(r){switch(r){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function O0(r){return r.stride||r.size*r.bytesPerElement}function P3(r,t){t.offset&&Fn.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const e=O0(r),n=t.vertexOffset!==void 0?t.vertexOffset:r.vertexOffset||0,i=t.elementOffset||0,s=n*e+i*r.bytesPerElement+(r.offset||0);return{...t,offset:s,stride:e}}function lK(r,t){const e=P3(r,t);return{high:e,low:{...e,offset:e.offset+r.size*4}}}class uK{constructor(t,e,n){W(this,"gl",void 0),W(this,"id",void 0),W(this,"size",void 0),W(this,"settings",void 0),W(this,"value",void 0),W(this,"doublePrecision",void 0),W(this,"_buffer",void 0),W(this,"state",void 0),this.gl=t,this.id=e.id||"",this.size=e.size||1;const i=e.logicalType||e.type,s=i===5130;let{defaultValue:a}=e;a=Number.isFinite(a)?[a]:a||new Array(this.size).fill(0);let o;s?o=5126:!i&&e.isIndexed?o=t&&jv(t,pi.ELEMENT_INDEX_UINT32)?5125:5123:o=i||5126;let A=cK(i||o||5126);this.doublePrecision=s,s&&e.fp64===!1&&(A=Float32Array),this.value=null,this.settings={...e,defaultType:A,defaultValue:a,logicalType:i,type:o,size:this.size,bytesPerElement:A.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new ei(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*O0(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),sg.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const n={},i=this.value instanceof Float64Array,s=lK(this.getAccessor(),e||{});return n[t]=new qb(this,s.high),n["".concat(t,"64Low")]=i?new qb(this,s.low):new Float32Array(this.size),n}if(e){const n=P3(this.getAccessor(),e);return{[t]:new qb(this,n)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant&&this.value){const e=Array.from(this.value);t=[e,e]}else{const{value:e,numInstances:n,size:i}=this,s=n*i;if(e&&s&&e.length>=s){const a=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let A=0;A<s;)for(let f=0;f<i;f++){const m=e[A++];m<a[f]&&(a[f]=m),m>o[f]&&(o[f]=m)}t=[a,o]}}return this.state.bounds=t,t}setData(t){const{state:e}=this;let n;ArrayBuffer.isView(t)?n={value:t}:t instanceof ei?n={buffer:t}:n=t;const i={...this.settings,...n};if(e.bufferAccessor=i,e.bounds=null,n.constant){let s=n.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!e.constant||!this._areValuesEqual(s,this.value)))return!1;e.externalBuffer=null,e.constant=!0,this.value=s}else if(n.buffer){const s=n.buffer;e.externalBuffer=s,e.constant=!1,this.value=n.value||null;const a=n.value instanceof Float64Array;i.type=n.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(a?2:1),i.stride=O0(i)}else if(n.value){this._checkExternalBuffer(n);let s=n.value;e.externalBuffer=null,e.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=O0(i);const{buffer:a,byteOffset:o}=this;this.doublePrecision&&s instanceof Float64Array&&(s=Mb(s,i));const A=s.byteLength+o+i.stride*2;a.byteLength<A&&a.reallocate(A),a.setAccessor(null),a.subData({data:s,offset:o}),i.type=n.type||a.accessor.type}return!0}updateSubBuffer(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.state.bounds=null;const e=this.value,{startOffset:n=0,endOffset:i}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?Mb(e,{size:this.size,startIndex:n,endIndex:i}):e.subarray(n,i),offset:n*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{state:n}=this,i=n.allocatedValue,s=sg.allocate(i,t+1,{size:this.size,type:this.settings.defaultType,copy:e});this.value=s;const{buffer:a,byteOffset:o}=this;return a.byteLength<s.byteLength+o&&(a.reallocate(s.byteLength+o),e&&i&&a.subData({data:i instanceof Float64Array?Mb(i,this):i,offset:o})),n.allocatedValue=s,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!ArrayBuffer.isView(e))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=e.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));!(e instanceof n)&&this.settings.normalized&&!("normalized"in t)&&Fn.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map(e=>(e+128)/255*2-1);case 5122:return new Float32Array(t).map(e=>(e+32768)/65535*2-1);case 5121:return new Float32Array(t).map(e=>e/255);case 5123:return new Float32Array(t).map(e=>e/65535);default:return t}}_normalizeValue(t,e,n){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t){let a=s;for(;--a>=0;)e[n+a]=i[a];return e}switch(s){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:i[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:i[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:i[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:i[0];break;default:let a=s;for(;--a>=0;)e[n+a]=Number.isFinite(t[a])?t[a]:i[a]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}}const U3=[],R3=[];function O3(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1/0,n=U3;const i={index:-1,data:r,target:[]};return r?typeof r[Symbol.iterator]=="function"?n=r:r.length>0&&(R3.length=r.length,n=R3):n=U3,(t>0||Number.isFinite(e))&&(n=(Array.isArray(n)?n:Array.from(n)).slice(t,e),i.index=t-1),{iterable:n,objectInfo:i}}function D3(r){return r&&r[Symbol.asyncIterator]}function AK(r,t){const{size:e,stride:n,offset:i,startIndices:s,nested:a}=t,o=r.BYTES_PER_ELEMENT,A=n?n/o:e,f=i?i/o:0,m=Math.floor((r.length-f)/A);return(b,x)=>{let{index:C,target:M}=x;if(!s){const q=C*A+f;for(let Y=0;Y<e;Y++)M[Y]=r[q+Y];return M}const U=s[C],N=s[C+1]||m;let Q;if(a){Q=new Array(N-U);for(let q=U;q<N;q++){const Y=q*A+f;M=new Array(e);for(let tt=0;tt<e;tt++)M[tt]=r[Y+tt];Q[q-U]=M}}else if(A===e)Q=r.subarray(U*e+f,N*e+f);else{Q=new r.constructor((N-U)*e);let q=0;for(let Y=U;Y<N;Y++){const tt=Y*A+f;for(let ft=0;ft<e;ft++)Q[q++]=r[tt+ft]}}return Q}}const hK=[],D0=[[0,1/0]];function dK(r,t){if(r===D0||(t[0]<0&&(t[0]=0),t[0]>=t[1]))return r;const e=[],n=r.length;let i=0;for(let s=0;s<n;s++){const a=r[s];a[1]<t[0]?(e.push(a),i=s+1):a[0]>t[1]?e.push(a):t=[Math.min(a[0],t[0]),Math.max(a[1],t[1])]}return e.splice(i,0,t),e}function Kb(r){const{source:t,target:e,start:n=0,size:i,getData:s}=r,a=r.end||e.length,o=t.length,A=a-n;if(o>A){e.set(t.subarray(0,A),n);return}if(e.set(t,n),!s)return;let f=o;for(;f<A;){const m=s(f,t);for(let b=0;b<i;b++)e[n+f]=m[b]||0,f++}}function fK(r){let{source:t,target:e,size:n,getData:i,sourceStartIndices:s,targetStartIndices:a}=r;if(!Array.isArray(a))return Kb({source:t,target:e,size:n,getData:i}),e;let o=0,A=0;const f=i&&((b,x)=>i(b+A,x)),m=Math.min(s.length,a.length);for(let b=1;b<m;b++){const x=s[b]*n,C=a[b]*n;Kb({source:t.subarray(o,x),target:e,start:A,end:C,size:n,getData:f}),o=x,A=C}return A<e.length&&Kb({source:[],target:e,start:A,size:n,getData:f}),e}const pK={interpolation:{duration:0,easing:r=>r},spring:{stiffness:.05,damping:.5}};function k3(r,t){if(!r)return null;Number.isFinite(r)&&(r={type:"interpolation",duration:r});const e=r.type||"interpolation";return{...pK[e],...t,...r,type:e}}function N3(r,t){const e=t.getBuffer();return e?[e,{divisor:0,size:t.size,normalized:t.settings.normalized}]:t.value}function Q3(r){switch(r){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(r,'"'))}}function H3(r){r.push(r.shift())}function Wb(r,t){const{doublePrecision:e,settings:n,value:i,size:s}=r,a=e&&i instanceof Float64Array?2:1;return(n.noAlloc?i.length:t*s)*a}function z3(r){let{buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:s,getData:a=q=>q}=r;const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,A=n.size*o,f=n.byteOffset,m=n.startIndices,b=s&&m,x=Wb(n,e),C=n.isConstant;if(!b&&i>=x)return;const M=C?n.value:n.getBuffer().getData({srcByteOffset:f});if(n.settings.normalized&&!C){const q=a;a=(Y,tt)=>n.normalizeConstant(q(Y,tt))}const U=C?(q,Y)=>a(M,Y):(q,Y)=>a(M.subarray(q,q+A),Y),N=t.getData({length:i}),Q=new Float32Array(x);fK({source:N,target:Q,sourceStartIndices:s,targetStartIndices:m,size:A,getData:U}),t.byteLength<Q.byteLength+f&&t.reallocate(Q.byteLength+f),t.subData({data:Q,offset:f})}class $b extends uK{constructor(t,e){super(t,e,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:D0}),W(this,"constant",!1),this.settings.update=e.update||(e.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw(){let{clearChangedFlags:t=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat(typeof t!="function"&&t||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition,i=Array.isArray(e)?t[e.find(s=>t[s])]:t[e];return k3(i,n)}setNeedsUpdate(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.id,e=arguments.length>1?arguments[1]:void 0;if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:n=0,endRow:i=1/0}=e;this.state.updateRanges=dK(this.state.updateRanges,[n,i])}else this.state.updateRanges=D0}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=hK}setNeedsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.id;this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){const{state:e,settings:n}=this;return n.noAlloc?!1:n.update?(super.allocate(t,e.updateRanges!==D0),!0):!1}updateBuffer(t){let{numInstances:e,data:n,props:i,context:s}=t;if(!this.needsUpdate())return!1;const{state:{updateRanges:a},settings:{update:o,noAlloc:A}}=this;let f=!0;if(o){for(const[m,b]of a)o.call(s,this,{data:n,startRow:m,endRow:b,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[m,b]of a){const x=Number.isFinite(m)?this.getVertexOffset(m):0,C=Number.isFinite(b)?this.getVertexOffset(b):A||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:x,endOffset:C})}this._checkAttributeArray()}else f=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),f}setConstantValue(t){return t===void 0||typeof t=="function"?!1:(this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const{state:n,settings:i}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;if(n.binaryValue=t,this.setNeedsRedraw(),i.transform||e!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});const a=t;qs(ArrayBuffer.isView(a.value),"invalid ".concat(i.accessor));const o=!!a.size&&a.size!==this.size;return n.binaryAccessor=AK(a.value,{size:a.size||this.size,stride:a.stride,offset:a.offset,startIndices:e,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?t<e.length?e[t]:this.numInstances:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const n in t)Object.assign(e,super.getShaderAttributes(n,t[n]));return e}_autoUpdater(t,e){let{data:n,startRow:i,endRow:s,props:a,numInstances:o}=e;if(t.constant)return;const{settings:A,state:f,value:m,size:b,startIndices:x}=t,{accessor:C,transform:M}=A,U=f.binaryAccessor||(typeof C=="function"?C:a[C]);qs(typeof U=="function",'accessor "'.concat(C,'" is not a function'));let N=t.getVertexOffset(i);const{iterable:Q,objectInfo:q}=O3(n,i,s);for(const Y of Q){q.index++;let tt=U(Y,q);if(M&&(tt=M.call(this,tt)),x){const ft=(q.index<x.length-1?x[q.index+1]:o)-x[q.index];if(tt&&Array.isArray(tt[0])){let pt=N;for(const mt of tt)t._normalizeValue(mt,m,pt),pt+=b}else tt&&tt.length>b?m.set(tt,N):(t._normalizeValue(tt,q.target,0),Gj({target:m,source:q.target,start:N,count:ft}));N+=ft*b}else t._normalizeValue(tt,m,N),N+=b}}_validateAttributeUpdaters(){const{settings:t}=this;if(!(t.noAlloc||typeof t.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class gK{constructor(t){let{gl:e,attribute:n,timeline:i}=t;W(this,"gl",void 0),W(this,"type","interpolation"),W(this,"attributeInTransition",void 0),W(this,"settings",void 0),W(this,"attribute",void 0),W(this,"transition",void 0),W(this,"currentStartIndices",void 0),W(this,"currentLength",void 0),W(this,"transform",void 0),W(this,"buffers",void 0),this.gl=e,this.transition=new cg(i),this.attribute=n,this.attributeInTransition=new $b(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=yK(e,n);const s={byteLength:0,usage:35050};this.buffers=[new ei(e,s),new ei(e,s)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0){this.transition.cancel();return}this.settings=t;const{gl:n,buffers:i,attribute:s}=this;H3(i);const a={numInstances:e,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const o of i)z3({buffer:o,...a});this.currentStartIndices=s.startIndices,this.currentLength=Wb(s,e),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:N3(n,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const t=this.transition.update();if(t){const{duration:e,easing:n}=this.settings,{time:i}=this.transition;let s=i/e;n&&(s=n(s)),this.transform.run({uniforms:{time:s}})}return t}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0}}const mK=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function yK(r,t){const e=Q3(t.size);return new wb(r,{vs:mK,defines:{ATTRIBUTE_TYPE:e},varyings:["vCurrent"]})}class _K{constructor(t){let{gl:e,attribute:n,timeline:i}=t;W(this,"gl",void 0),W(this,"type","spring"),W(this,"attributeInTransition",void 0),W(this,"settings",void 0),W(this,"attribute",void 0),W(this,"transition",void 0),W(this,"currentStartIndices",void 0),W(this,"currentLength",void 0),W(this,"texture",void 0),W(this,"framebuffer",void 0),W(this,"transform",void 0),W(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new cg(i),this.attribute=n,this.attributeInTransition=new $b(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=bK(e),this.framebuffer=wK(e,this.texture),this.transform=vK(e,n,this.framebuffer);const s={byteLength:0,usage:35050};this.buffers=[new ei(e,s),new ei(e,s),new ei(e,s)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:n,buffers:i,attribute:s}=this,a={numInstances:e,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const o of i)z3({buffer:o,...a});this.settings=t,this.currentStartIndices=s.startIndices,this.currentLength=Wb(s,e),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...t,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:N3(n,s)}})}update(){const{buffers:t,transform:e,framebuffer:n,transition:i}=this;if(!i.update())return!1;const a=this.settings;return e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:a.stiffness,damping:a.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),H3(t),this.attributeInTransition.setData({buffer:t[1],value:this.attribute.value}),o0(n)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function vK(r,t,e){const n=Q3(t.size);return new wb(r,{framebuffer:e,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:n},varyings:["vNext"]})}function bK(r){return new Ta(r,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function wK(r,t){return new vs(r,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:t}})}const xK={interpolation:gK,spring:_K};class BK{constructor(t,e){let{id:n,timeline:i}=e;W(this,"id",void 0),W(this,"isSupported",void 0),W(this,"gl",void 0),W(this,"timeline",void 0),W(this,"transitions",void 0),W(this,"needsRedraw",void 0),W(this,"numInstances",void 0),this.id=n,this.gl=t,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=wb.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update(t){let{attributes:e,transitions:n,numInstances:i}=t;this.numInstances=i||1;for(const s in e){const a=e[s],o=a.getTransitionSetting(n);o&&this._updateAttribute(s,a,o)}for(const s in this.transitions){const a=e[s];(!a||!a.getTransitionSetting(n))&&this._removeTransition(s)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const e in this.transitions)this.transitions[e].update()&&(this.needsRedraw=!0);const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,n){const i=this.transitions[t];let s=!i||i.type!==n.type;if(s){if(!this.isSupported){Fn.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();return}i&&this._removeTransition(t);const a=xK[n.type];a?this.transitions[t]=new a({attribute:e,timeline:this.timeline,gl:this.gl}):(Fn.error("unsupported transition type '".concat(n.type,"'"))(),s=!1)}(s||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}const G3="attributeManager.invalidate",CK="attributeManager.updateStart",EK="attributeManager.updateEnd",SK="attribute.updateStart",TK="attribute.allocate",IK="attribute.updateEnd";class LK{constructor(t){let{id:e="attribute-manager",stats:n,timeline:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};W(this,"id",void 0),W(this,"gl",void 0),W(this,"attributes",void 0),W(this,"updateTriggers",void 0),W(this,"needsRedraw",void 0),W(this,"userData",void 0),W(this,"stats",void 0),W(this,"attributeTransitionManager",void 0),W(this,"mergeBoundsMemoized",ng(Uj)),this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new BK(t,{id:"".concat(e,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{instanced:1})}remove(t){for(const e of t)this.attributes[e]!==void 0&&(this.attributes[e].delete(),delete this.attributes[e])}invalidate(t,e){const n=this._invalidateTrigger(t,e);oo(G3,this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);oo(G3,this,"all")}update(t){let{data:e,numInstances:n,startIndices:i=null,transitions:s,props:a={},buffers:o={},context:A={}}=t,f=!1;oo(CK,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const m in this.attributes){const b=this.attributes[m],x=b.settings.accessor;b.startIndices=i,b.numInstances=n,a[m]&&Fn.removed("props.".concat(m),"data.attributes.".concat(m))(),b.setExternalBuffer(o[m])||b.setBinaryValue(typeof x=="string"?o[x]:void 0,e.startIndices)||typeof x=="string"&&!o[x]&&b.setConstantValue(a[x])||b.needsUpdate()&&(f=!0,this._updateAttribute({attribute:b,numInstances:n,data:e,props:a,context:A})),this.needsRedraw=this.needsRedraw||b.needsRedraw()}f&&oo(EK,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:s})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getBounds(t){const e=t.map(n=>{var i;return(i=this.attributes[n])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(e)}getChangedAttributes(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearChangedFlags:!1};const{attributes:e,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const s in e){const a=e[s];a.needsRedraw(t)&&!n.hasAttribute(s)&&(i[s]=a)}return i}getShaderAttributes(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t||(t=this.getAttributes());const n={};for(const i in t)e[i]||Object.assign(n,t[i].getShaderAttributes());return n}_add(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};for(const n in t){const i=t[n];this.attributes[n]=this._createAttribute(n,i,e)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const i={...e,id:t,size:e.isIndexed&&1||e.size||1,divisor:n.instanced?1:e.divisor||0};return new $b(this.gl,i)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes)this.attributes[e].getUpdateTriggers().forEach(i=>{t[i]||(t[i]=[]),t[i].push(e)});this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:i}=this,s=i[t];return s&&s.forEach(a=>{const o=n[a];o&&o.setNeedsUpdate(o.id,e)}),s}_updateAttribute(t){const{attribute:e,numInstances:n}=t;if(oo(SK,e),e.constant){e.setConstantValue(e.value);return}e.allocate(n)&&oo(TK,e,n),e.updateBuffer(t)&&(this.needsRedraw=!0,oo(IK,e,n))}}class FK extends cg{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:i,easing:s}}=this,a=s(t/i);this._value=g0(e,n,a)}}const V3=1e-5;function j3(r,t,e,n,i){const s=t-r,o=(e-t)*i,A=-s*n;return o+A+s+t}function MK(r,t,e,n,i){if(Array.isArray(e)){const s=[];for(let a=0;a<e.length;a++)s[a]=j3(r[a],t[a],e[a],n,i);return s}return j3(r,t,e,n,i)}function q3(r,t){if(Array.isArray(r)){let e=0;for(let n=0;n<r.length;n++){const i=r[n]-t[n];e+=i*i}return Math.sqrt(e)}return Math.abs(r-t)}class PK extends cg{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:i}=this.settings,{_prevValue:s=t,_currValue:a=t}=this;let o=MK(s,a,e,n,i);const A=q3(o,e),f=q3(o,a);A<V3&&f<V3&&(o=e,this.end()),this._prevValue=a,this._currValue=o}}const UK={interpolation:FK,spring:PK};class RK{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,i){const{transitions:s}=this;if(s.has(t)){const A=s.get(t),{value:f=A.settings.fromValue}=A;e=f,this.remove(t)}if(i=k3(i),!i)return;const a=UK[i.type];if(!a){Fn.error("unsupported transition type '".concat(i.type,"'"))();return}const o=new a(this.timeline);o.start({...i,fromValue:e,toValue:n}),s.set(t,o)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}function OK(r){const t=r[SA];for(const e in t){const n=t[e],{validate:i}=n;if(i&&!i(r[e],n))throw new Error("Invalid prop ".concat(e,": ").concat(r[e]))}}function DK(r,t){const e=K3({newProps:r,oldProps:t,propTypes:r[SA],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),n=NK(r,t);let i=!1;return n||(i=QK(r,t)),{dataChanged:n,propsChanged:e,updateTriggersChanged:i,extensionsChanged:HK(r,t),transitionsChanged:kK(r,t)}}function kK(r,t){if(!r.transitions)return!1;const e={},n=r[SA];let i=!1;for(const s in r.transitions){const a=n[s],o=a&&a.type;(o==="number"||o==="color"||o==="array")&&Xb(r[s],t[s],a)&&(e[s]=!0,i=!0)}return i?e:!1}function K3(r){let{newProps:t,oldProps:e,ignoreProps:n={},propTypes:i={},triggerName:s="props"}=r;if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(s," changed shallowly");for(const a of Object.keys(t))if(!(a in n)){if(!(a in e))return"".concat(s,".").concat(a," added");const o=Xb(t[a],e[a],i[a]);if(o)return"".concat(s,".").concat(a," ").concat(o)}for(const a of Object.keys(e))if(!(a in n)){if(!(a in t))return"".concat(s,".").concat(a," dropped");if(!Object.hasOwnProperty.call(t,a)){const o=Xb(t[a],e[a],i[a]);if(o)return"".concat(s,".").concat(a," ").concat(o)}}return!1}function Xb(r,t,e){let n=e&&e.equal;return n&&!n(r,t,e)||!n&&(n=r&&t&&r.equals,n&&!n.call(r,t))?"changed deeply":!n&&t!==r?"changed shallowly":null}function NK(r,t){if(t===null)return"oldProps is null, initial diff";let e=!1;const{dataComparator:n,_dataDiff:i}=r;return n?n(r.data,t.data)||(e="Data comparator detected a change"):r.data!==t.data&&(e="A new data container was supplied"),e&&i&&(e=i(r.data,t.data)||e),e}function QK(r,t){if(t===null)return{all:!0};if("all"in r.updateTriggers&&W3(r,t,"all"))return{all:!0};const e={};let n=!1;for(const i in r.updateTriggers)i!=="all"&&W3(r,t,i)&&(e[i]=!0,n=!0);return n?e:!1}function HK(r,t){if(t===null)return!0;const e=t.extensions,{extensions:n}=r;if(n===e)return!1;if(!e||!n||n.length!==e.length)return!0;for(let i=0;i<n.length;i++)if(!n[i].equals(e[i]))return!0;return!1}function W3(r,t,e){let n=r.updateTriggers[e];n=n??{};let i=t.updateTriggers[e];return i=i??{},K3({oldProps:i,newProps:n,triggerName:e})}const zK="count(): argument not an object",GK="count(): argument not a container";function VK(r){if(!qK(r))throw new Error(zK);if(typeof r.count=="function")return r.count();if(Number.isFinite(r.size))return r.size;if(Number.isFinite(r.length))return r.length;if(jK(r))return Object.keys(r).length;throw new Error(GK)}function jK(r){return r!==null&&typeof r=="object"&&r.constructor===Object}function qK(r){return r!==null&&typeof r=="object"}function KK(r,t){if(!t)return r;const e={...r,...t};if("defines"in t&&(e.defines={...r.defines,...t.defines}),"modules"in t&&(e.modules=(r.modules||[]).concat(t.modules),t.modules.some(n=>n.name==="project64"))){const n=e.modules.findIndex(i=>i.name==="project32");n>=0&&e.modules.splice(n,1)}if("inject"in t)if(!r.inject)e.inject=t.inject;else{const n={...r.inject};for(const i in t.inject)n[i]=(n[i]||"")+t.inject[i];e.inject=n}return e}const WK={10241:9987,10240:9729,10242:33071,10243:33071},Yb={};function $K(r,t,e,n){if(e instanceof Ta)return e;e.constructor&&e.constructor.name!=="Object"&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const s=new Ta(t,{...e,parameters:{...WK,...i,...n}});return Yb[s.id]=r,s}function XK(r,t){!t||!(t instanceof Ta)||Yb[t.id]===r&&(t.delete(),delete Yb[t.id])}const YK={boolean:{validate(r,t){return!0},equal(r,t,e){return!!r==!!t}},number:{validate(r,t){return Number.isFinite(r)&&(!("max"in t)||r<=t.max)&&(!("min"in t)||r>=t.min)}},color:{validate(r,t){return t.optional&&!r||Jb(r)&&(r.length===3||r.length===4)},equal(r,t,e){return Nl(r,t,1)}},accessor:{validate(r,t){const e=k0(r);return e==="function"||e===k0(t.value)},equal(r,t,e){return typeof t=="function"?!0:Nl(r,t,1)}},array:{validate(r,t){return t.optional&&!r||Jb(r)},equal(r,t,e){const{compare:n}=e,i=Number.isInteger(n)?n:n?1:0;return n?Nl(r,t,i):r===t}},object:{equal(r,t,e){if(e.ignore)return!0;const{compare:n}=e,i=Number.isInteger(n)?n:n?1:0;return n?Nl(r,t,i):r===t}},function:{validate(r,t){return t.optional&&!r||typeof r=="function"},equal(r,t,e){return!e.compare&&e.ignore!==!1||r===t}},data:{transform:(r,t,e)=>{const{dataTransform:n}=e.props;return n&&r?n(r):r}},image:{transform:(r,t,e)=>{const n=e.context;return!n||!n.gl?null:$K(e.id,n.gl,r,{...t.parameters,...e.props.textureParameters})},release:(r,t,e)=>{XK(e.id,r)}}};function JK(r){const t={},e={},n={};for(const[i,s]of Object.entries(r)){const a=s==null?void 0:s.deprecatedFor;if(a)n[i]=Array.isArray(a)?a:[a];else{const o=ZK(i,s);t[i]=o,e[i]=o.value}}return{propTypes:t,defaultProps:e,deprecatedProps:n}}function ZK(r,t){switch(k0(t)){case"object":return ug(r,t);case"array":return ug(r,{type:"array",value:t,compare:!1});case"boolean":return ug(r,{type:"boolean",value:t});case"number":return ug(r,{type:"number",value:t});case"function":return ug(r,{type:"function",value:t,compare:!0});default:return{name:r,type:"unknown",value:t}}}function ug(r,t){return"type"in t?{name:r,...YK[t.type],...t}:"value"in t?{name:r,type:k0(t.value),...t}:{name:r,type:"object",value:t}}function Jb(r){return Array.isArray(r)||ArrayBuffer.isView(r)}function k0(r){return Jb(r)?"array":r===null?"null":typeof r}function tW(r,t){let e;for(let s=t.length-1;s>=0;s--){const a=t[s];"extensions"in a&&(e=a.extensions)}const n=Zb(r.constructor,e),i=Object.create(n);i[F0]=r,i[Ph]={},i[TA]={};for(let s=0;s<t.length;++s){const a=t[s];for(const o in a)i[o]=a[o]}return Object.freeze(i),i}const eW="_mergedDefaultProps";function Zb(r,t){let e=eW;if(t)for(const i of t){const s=i.constructor;s&&(e+=":".concat(s.extensionName||s.name))}const n=$3(r,e);return n||(r[e]=rW(r,t||[]))}function rW(r,t){if(!r.prototype)return null;const n=Object.getPrototypeOf(r),i=Zb(n),s=$3(r,"defaultProps")||{},a=JK(s),o=Object.assign(Object.create(null),i,a.defaultProps),A=Object.assign(Object.create(null),i==null?void 0:i[SA],a.propTypes),f=Object.assign(Object.create(null),i==null?void 0:i[Ub],a.deprecatedProps);for(const m of t){const b=Zb(m.constructor);b&&(Object.assign(o,b),Object.assign(A,b[SA]),Object.assign(f,b[Ub]))}return nW(o,r),sW(o,A),iW(o,f),o[SA]=A,o[Ub]=f,t.length===0&&!tw(r,"_propTypes")&&(r._propTypes=A),o}function nW(r,t){const e=aW(t);Object.defineProperties(r,{id:{writable:!0,value:e}})}function iW(r,t){for(const e in t)Object.defineProperty(r,e,{enumerable:!1,set(n){const i="".concat(this.id,": ").concat(e);for(const s of t[e])tw(this,s)||(this[s]=n);Fn.deprecated(i,t[e].join("/"))()}})}function sW(r,t){const e={},n={};for(const i in t){const s=t[i],{name:a,value:o}=s;s.async&&(e[a]=o,n[a]=oW(a))}r[Jd]=e,r[Ph]={},Object.defineProperties(r,n)}function oW(r){return{enumerable:!0,set(t){typeof t=="string"||t instanceof Promise||D3(t)?this[Ph][r]=t:this[TA][r]=t},get(){if(this[TA]){if(r in this[TA])return this[TA][r]||this[Jd][r];if(r in this[Ph]){const t=this[F0]&&this[F0].internalState;if(t&&t.hasAsyncProp(r))return t.getAsyncProp(r)||this[Jd][r]}}return this[Jd][r]}}}function tw(r,t){return Object.prototype.hasOwnProperty.call(r,t)}function $3(r,t){return tw(r,t)&&r[t]}function aW(r){const t=r.componentName;return t||Fn.warn("".concat(r.name,".componentName not specified"))(),t||r.name}let cW=0;class ew{constructor(){W(this,"id",void 0),W(this,"props",void 0),W(this,"count",void 0);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.props=tW(this,e),this.id=this.props.id,this.count=cW++}clone(t){const{props:e}=this,n={};for(const i in e[Jd])i in e[TA]?n[i]=e[TA][i]:i in e[Ph]&&(n[i]=e[Ph][i]);return new this.constructor({...e,...n,...t})}}W(ew,"componentName","Component"),W(ew,"defaultProps",{});const lW=Object.freeze({});class uW{constructor(t){W(this,"component",void 0),W(this,"onAsyncPropUpdated",void 0),W(this,"asyncProps",void 0),W(this,"oldProps",void 0),W(this,"oldAsyncProps",void 0),this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e&&e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||lW}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return!!(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const e in this.asyncProps)if(this.isAsyncPropLoading(e))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){this.component=t[F0]||this.component;const e=t[TA]||{},n=t[Ph]||t,i=t[Jd]||{};for(const s in e){const a=e[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,a),e[s]=this.getAsyncProp(s)}for(const s in n){const a=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,a)}}_fetch(t,e){return null}_onResolve(t,e){}_onError(t,e){}_updateAsyncProp(t,e){if(this._didAsyncInputValueChange(t,e)){if(typeof e=="string"&&(e=this._fetch(t,e)),e instanceof Promise){this._watchPromise(t,e);return}if(D3(e)){this._resolveAsyncIterable(t,e);return}this._setPropValue(t,e)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e===n.resolvedValue||e===n.lastValue?!1:(n.lastValue=e,!0)}_setPropValue(t,e){this._freezeAsyncOldProps();const n=this.asyncProps[t];n&&(e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(t,e,n){const i=this.asyncProps[t];i&&n>=i.resolvedLoadCount&&e!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=e,i.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;e.then(s=>{this.component&&(s=this._postProcessValue(n,s),this._setAsyncPropValue(t,s,i),this._onResolve(t,s))}).catch(s=>{this._onError(t,s)})}}async _resolveAsyncIterable(t,e){if(t!=="data"){this._setPropValue(t,e);return}const n=this.asyncProps[t];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let s=[],a=0;for await(const o of e){if(!this.component)return;const{dataTransform:A}=this.component.props;A?s=A(o,s):s=s.concat(o),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:a,endRow:s.length}]}),a=s.length,this._setAsyncPropValue(t,s,i)}this._onResolve(t,s)}_postProcessValue(t,e){const n=t.type;return n&&this.component&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const i=this.component&&this.component.props[SA];this.asyncProps[t]={type:i&&i[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}class AW extends uW{constructor(t){let{attributeManager:e,layer:n}=t;super(n),W(this,"attributeManager",void 0),W(this,"needsRedraw",void 0),W(this,"needsUpdate",void 0),W(this,"subLayers",void 0),W(this,"usesPickingColorCache",void 0),W(this,"hasPickingBuffer",void 0),W(this,"changeFlags",void 0),W(this,"viewport",void 0),W(this,"uniformTransitions",void 0),W(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(t,e){const n=this.layer,i=n==null?void 0:n.props.fetch;return i?i(e,{propName:t,layer:n}):super._fetch(t,e)}_onResolve(t,e){const n=this.layer;if(n){const i=n.props.onDataLoad;t==="data"&&i&&i(e,{propName:t,layer:n})}}_onError(t,e){const n=this.layer;n&&n.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}}const hW="layer.changeFlag",dW="layer.initialize",fW="layer.update",pW="layer.finalize",gW="layer.matched",X3=2**24-1,mW=Object.freeze([]),yW=ng(r=>{let{oldViewport:t,viewport:e}=r;return t.equals(e)});let Hl=new Uint8ClampedArray(0);const _W={data:{type:"data",value:mW,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:r=>r&&r.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(r,t)=>{let{propName:e,layer:n,loaders:i,loadOptions:s,signal:a}=t;const{resourceManager:o}=n.context;if(s=s||n.getLoadOptions(),i=i||n.props.loaders,a){var A;s={...s,fetch:{...(A=s)===null||A===void 0?void 0:A.fetch,signal:a}}}let f=o.contains(r);return!f&&!s&&(o.add({resourceId:r,data:bA(r,i),persistent:!1}),f=!0),f?o.subscribe({resourceId:r,onChange:m=>{var b;return(b=n.internalState)===null||b===void 0?void 0:b.reloadAsyncProp(e,m)},consumerId:n.id,requestId:e}):bA(r,i,s)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Sn.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:r=>{let{layerIndex:t}=r;return[0,-t*100]}},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class ef extends ew{constructor(){super(...arguments),W(this,"internalState",null),W(this,"lifecycle",Yd.NO_STATE),W(this,"context",void 0),W(this,"state",void 0),W(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}project(t){qs(this.internalState);const e=this.internalState.viewport||this.context.viewport,n=c3(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,a]=t3(n,e.pixelProjectionMatrix);return t.length===2?[i,s]:[i,s,a]}unproject(t){return qs(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,e){qs(this.internalState);const n=this.internalState.viewport||this.context.viewport;return Qj(t,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...e})}get isComposite(){return!1}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===Sn.DEFAULT||t===Sn.LNGLAT||t===Sn.CARTESIAN}onHover(t,e){return this.props.onHover&&this.props.onHover(t,e)||!1}onClick(t,e){return this.props.onClick&&this.props.onClick(t,e)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){qs(t instanceof Uint8Array);const[e,n,i]=t;return e+n*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:VK(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var t;return(t=this.getAttributeManager())===null||t===void 0?void 0:t.getBounds(["positions","instancePositions"])}getShaders(t){for(const e of this.props.extensions)t=KK(t,e.getShaders.call(this,e));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){const e=this.getAttributeManager(),{dataChanged:n}=t.changeFlags;if(n&&e)if(Array.isArray(n))for(const i of n)e.invalidateAll(i);else e.invalidateAll();if(e){const{props:i}=t,s=this.internalState.hasPickingBuffer,a=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(o=>o.getNeedsPickingBuffer.call(this,o));if(s!==a){this.internalState.hasPickingBuffer=a;const{pickingColors:o,instancePickingColors:A}=e.attributes,f=o||A;f&&(a&&f.constant&&(f.constant=!1,e.invalidate(f.id)),!f.value&&!a&&(f.constant=!0,f.value=[0,0,0]))}}}finalizeState(t){for(const n of this.getModels())n.delete();const e=this.getAttributeManager();e&&e.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo(t){let{info:e,mode:n,sourceLayer:i}=t;const{index:s}=e;return s>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[s]),e}raiseError(t,e){var n,i;if(e&&(t=new Error("".concat(e,": ").concat(t.message),{cause:t})),!((n=(i=this.props).onError)!==null&&n!==void 0&&n.call(i,t))){var s,a;(s=this.context)===null||s===void 0||(a=s.onError)===null||a===void 0||a.call(s,t,this)}}getNeedsRedraw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{clearRedrawFlags:!1};return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var t;return((t=this.internalState)===null||t===void 0?void 0:t.uniformTransitions.active)||!1}activateViewport(t){if(!this.internalState)return;const e=this.internalState.viewport;this.internalState.viewport=t,(!e||!yW({oldViewport:e,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"all";const e=this.getAttributeManager();e&&(t==="all"?e.invalidateAll():e.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(){const t=this.getAttributeManager();if(!t)return;const e=this.props,n=this.getNumInstances(),i=this.getStartIndices();t.update({data:e.data,numInstances:n,startIndices:i,props:e,transitions:e.transitions,buffers:e.data.attributes,context:this});const s=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const i in e)Object.defineProperty(n,i,{value:e[i]});return n}return this.props}calculateInstancePickingColors(t,e){let{numInstances:n}=e;if(t.constant)return;const i=Math.floor(Hl.length/3);if(this.internalState.usesPickingColorCache=!0,i<n){n>X3&&Fn.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Hl=sg.allocate(Hl,n,{size:3,copy:!0,maxCount:Math.max(n,X3)});const s=Math.floor(Hl.length/3),a=[];for(let o=i;o<s;o++)this.encodePickingColor(o,a),Hl[o*3+0]=a[0],Hl[o*3+1]=a[1],Hl[o*3+2]=a[2]}t.value=Hl.subarray(0,n*3)}_setModelAttributes(t,e){const n=this.getAttributeManager(),i=t.userData.excludeAttributes||{},s=n.getShaderAttributes(e,i);t.setAttributes(s)}disablePickingIndex(t){const e=this.props.data;if(!("attributes"in e)){this._disablePickingIndex(t);return}const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,s=n||i,a=s&&e.attributes&&e.attributes[s.id];if(a&&a.value){const o=a.value,A=this.encodePickingColor(t);for(let f=0;f<e.length;f++){const m=s.getVertexOffset(f);o[m]===A[0]&&o[m+1]===A[1]&&o[m+2]===A[2]&&this._disablePickingIndex(f)}}else this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;if(!i)return;const s=i.getVertexOffset(t),a=i.getVertexOffset(t+1);i.buffer.subData({data:new Uint8Array(a-s),offset:s})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==Hl.buffer&&(n.value=Hl.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){qs(!this.internalState),qs(Number.isFinite(this.props.coordinateSystem)),oo(dW,this);const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new AW({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Fn.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.uniformTransitions=new RK(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const e of this.props.extensions)e.initializeState.call(this,this.context,e);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){oo(gW,this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.state=e,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const t=this.needsUpdate();if(oo(fW,this,t),!t)return;const e=this.props,n=this.context,i=this.internalState,s=n.viewport,a=this._updateUniformTransition();i.propsInTransition=a,n.viewport=i.viewport||s,this.props=a;try{const o=this._getUpdateParams(),A=this.getModels();if(n.gl)this.updateState(o);else try{this.updateState(o)}catch{}for(const m of this.props.extensions)m.updateState.call(this,o,m);const f=this.getModels()[0]!==A[0];this._postUpdate(o,f)}finally{n.viewport=s,this.props=e,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){oo(pW,this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,this.context,t)}_drawLayer(t){let{moduleParameters:e=null,uniforms:n={},parameters:i={}}=t;this._updateAttributeTransition();const s=this.props,a=this.context;this.props=this.internalState.propsInTransition||s;const o=this.props.opacity;n.opacity=Math.pow(o,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:A}=this.props,f=A&&A(n)||[0,0];Bu(a.gl,{polygonOffset:f}),Oc(a.gl,i,()=>{const m={moduleParameters:e,uniforms:n,parameters:i,context:a};for(const b of this.props.extensions)b.draw.call(this,m,b);this.draw(m)})}finally{this.props=s}}getChangeFlags(){var t;return(t=this.internalState)===null||t===void 0?void 0:t.changeFlags}setChangeFlags(t){if(!this.internalState)return;const{changeFlags:e}=this.internalState;for(const i in t)if(t[i]){let s=!1;switch(i){case"dataChanged":const a=t[i],o=e[i];a&&Array.isArray(o)&&(e.dataChanged=Array.isArray(a)?o.concat(a):a,s=!0);default:e[i]||(e[i]=t[i],s=!0)}s&&oo(hW,this,i,t)}const n=!!(e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged);e.propsOrDataChanged=n,e.somethingChanged=n||e.viewportChanged||e.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,e){const n=DK(t,e);if(n.updateTriggersChanged)for(const s in n.updateTriggersChanged)n.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(n.transitionsChanged)for(const s in n.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,e[s],t[s],(i=t.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(n)}validateProps(){OK(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&typeof n=="function"&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_getAttributeManager(){const t=this.context;return new LK(t.gl,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,e){const{props:n,oldProps:i}=t;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s==null||s.setInstanceCount(this.getNumInstances());const{autoHighlight:a,highlightedObjectIndex:o,highlightColor:A}=n;if(e||i.autoHighlight!==a||i.highlightedObjectIndex!==o||i.highlightColor!==A){const f={};a||(f.pickingSelectedColor=null),Array.isArray(A)&&(f.pickingHighlightColor=A),(e||o!==i.highlightedObjectIndex)&&(f.pickingSelectedColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setModuleParameters(f)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),i=n?n.getNeedsRedraw(t):!1;if(e=e||i,e)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags,e}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}W(ef,"defaultProps",_W),W(ef,"layerName","Layer");const vW="compositeLayer.renderLayers";class Y3 extends ef{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(t){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo(t){let{info:e}=t;const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){return e&&e.length}getSubLayerClass(t,e){const{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||e}getSubLayerRow(t,e,n){return t.__source={parent:this,object:e,index:n},t}getSubLayerAccessor(t){if(typeof t=="function"){const e={index:-1,data:this.props.data,target:[]};return(n,i)=>n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,i)}return t}getSubLayerProps(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var e;const{opacity:n,pickable:i,visible:s,parameters:a,getPolygonOffset:o,highlightedObjectIndex:A,autoHighlight:f,highlightColor:m,coordinateSystem:b,coordinateOrigin:x,wrapLongitude:C,positionFormat:M,modelMatrix:U,extensions:N,fetch:Q,operation:q,_subLayerProps:Y}=this.props,tt={id:"",updateTriggers:{},opacity:n,pickable:i,visible:s,parameters:a,getPolygonOffset:o,highlightedObjectIndex:A,autoHighlight:f,highlightColor:m,coordinateSystem:b,coordinateOrigin:x,wrapLongitude:C,positionFormat:M,modelMatrix:U,extensions:N,fetch:Q,operation:q},ft=Y&&t.id&&Y[t.id],pt=ft&&ft.updateTriggers,mt=t.id||"sublayer";if(ft){const dt=this.props[SA],Rt=t.type?t.type._propTypes:{};for(const Lt in ft){const st=Rt[Lt]||dt[Lt];st&&st.type==="accessor"&&(ft[Lt]=this.getSubLayerAccessor(ft[Lt]))}}Object.assign(tt,t,ft),tt.id="".concat(this.props.id,"-").concat(mt),tt.updateTriggers={all:(e=this.props.updateTriggers)===null||e===void 0?void 0:e.all,...t.updateTriggers,...pt};for(const dt of N){const Rt=dt.getSubLayerProps.call(this,dt);Rt&&Object.assign(tt,Rt,{updateTriggers:Object.assign(tt.updateTriggers,Rt.updateTriggers)})}return tt}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_postUpdate(t,e){let n=this.internalState.subLayers;const i=!n||this.needsUpdate();if(i){const s=this.renderLayers();n=M0(s,Boolean),this.internalState.subLayers=n}oo(vW,this,i,n);for(const s of n)s.parent=this}}W(Y3,"layerName","CompositeLayer");const rw=512,bW=Math.PI/180;function wW(r){let{map:t,gl:e,deck:n}=r;if(t.__deck)return t.__deck;const i=n==null?void 0:n.props._customRender,s=n==null?void 0:n.props.onLoad,a=BW({...n==null?void 0:n.props,_customRender:()=>{t.triggerRepaint(),i==null||i("")}});let o;return(!n||n.props.gl===e)&&(Object.assign(a,{gl:e,width:null,height:null,touchAction:"unset",viewState:nw(t)}),n!=null&&n.isInitialized?J3(n,t):a.onLoad=()=>{s==null||s(),J3(o,t)}),n?(o=n,n.setProps(a),n.userData.isExternal=!0):(o=new jb(a),t.on("remove",()=>{xW(t)})),o.userData.mapboxLayers=new Set,t.__deck=o,t.on("render",()=>{o.isInitialized&&LW(o,t)}),o}function J3(r,t){const e=()=>{r.isInitialized?FW(r,t):t.off("move",e)};t.on("move",e)}function xW(r){var t;(t=r.__deck)===null||t===void 0||t.finalize(),r.__deck=null}function BW(r){return{...r,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...r.parameters},views:r.views||[new kb({id:"mapbox"})]}}function CW(r,t){r.userData.mapboxLayers.add(t),iw(r)}function EW(r,t){r.userData.mapboxLayers.delete(t),iw(r)}function SW(r,t){iw(r)}function TW(r,t,e){let{currentViewport:n}=r.userData,i=!1;n||(n=Z3(r,t,!0),r.userData.currentViewport=n,i=!0),r.isInitialized&&r._drawLayers("mapbox-repaint",{viewports:[n],layerFilter:s=>{let{layer:a}=s;return e.id===a.id||a.props.operation.includes("terrain")},clearStack:i,clearCanvas:!1})}function nw(r){var t;const{lng:e,lat:n}=r.getCenter(),i={longitude:(e+540)%360-180,latitude:n,zoom:r.getZoom(),bearing:r.getBearing(),pitch:r.getPitch(),padding:r.getPadding(),repeat:r.getRenderWorldCopies()};return(t=r.getTerrain)!==null&&t!==void 0&&t.call(r)&&IW(r,i),i}function IW(r,t){if(r.getFreeCameraOptions){const{position:e}=r.getFreeCameraOptions();if(!e||e.z===void 0)return;const n=r.transform.height,{longitude:i,latitude:s,pitch:a}=t,o=e.x*rw,A=(1-e.y)*rw,f=e.z*rw,m=ig([i,s]),b=o-m[0],x=A-m[1],C=Math.sqrt(b*b+x*x),M=a*bW,U=1.5*n,N=M<.001?U*Math.cos(M)/f:U*Math.sin(M)/C;t.zoom=Math.log2(N);const Q=U*Math.cos(M)/N,q=f-Q;t.position=[0,0,q/I0(s)]}else typeof r.transform.elevation=="number"&&(t.position=[0,0,r.transform.elevation])}function Z3(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return new Mh({id:"mapbox",x:0,y:0,width:r.width,height:r.height,...nw(t),nearZMultiplier:e?.02:.1,nearZ:t.transform._nearZ/t.transform.height,farZ:t.transform._farZ/t.transform.height})}function LW(r,t){const{mapboxLayers:e,isExternal:n}=r.userData;if(n){const i=Array.from(e,m=>m.id),a=M0(r.props.layers,Boolean).some(m=>m&&!i.includes(m.id));let o=r.getViewports();const A=o.findIndex(m=>m.id==="mapbox"),f=o.length>1||A<0;(a||f)&&(A>=0&&(o=o.slice(),o[A]=Z3(r,t,!1)),r._drawLayers("mapbox-repaint",{viewports:o,layerFilter:m=>(!r.props.layerFilter||r.props.layerFilter(m))&&(m.viewport.id!=="mapbox"||!i.includes(m.layer.id)),clearCanvas:!1}))}r.userData.currentViewport=null}function FW(r,t){r.setProps({viewState:nw(t)}),r.needsRedraw({clearRedrawFlags:!0})}function iw(r){if(r.userData.isExternal)return;const t=[];r.userData.mapboxLayers.forEach(e=>{const n=e.props.type,i=new n(e.props);t.push(i)}),r.setProps({layers:t})}class MW{constructor(t){if(W(this,"id",void 0),W(this,"type",void 0),W(this,"renderingMode",void 0),W(this,"map",void 0),W(this,"deck",void 0),W(this,"props",void 0),!t.id)throw new Error("Layer must have an unique id");this.id=t.id,this.type="custom",this.renderingMode=t.renderingMode||"3d",this.map=null,this.deck=null,this.props=t}onAdd(t,e){this.map=t,this.deck=wW({map:t,gl:e,deck:this.props.deck}),CW(this.deck,this)}onRemove(){this.deck&&EW(this.deck,this)}setProps(t){Object.assign(this.props,t,{id:this.id}),this.deck&&SW(this.deck)}render(){TW(this.deck,this.map,this)}}const PW=`#define SHADER_NAME point-cloud-layer-vertex-shader

attribute vec3 positions;
attribute vec3 instanceNormals;
attribute vec4 instanceColors;
attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusPixels;
uniform int sizeUnits;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.normal = project_normal(instanceNormals);
  unitPosition = positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;
  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);
  DECKGL_FILTER_SIZE(offset, geometry);

  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
  vColor = vec4(lightColor, instanceColors.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,UW=`#define SHADER_NAME point-cloud-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition);

  if (distToCenter > 1.0) {
    discard;
  }

  gl_FragColor = vColor;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,tI=[0,0,0,255],eI=[0,0,1],RW={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:r=>r.position},getNormal:{type:"accessor",value:eI},getColor:{type:"accessor",value:tI},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};function OW(r){const{header:t,attributes:e}=r;!t||!e||(r.length=t.vertexCount,e.POSITION&&(e.instancePositions=e.POSITION),e.NORMAL&&(e.instanceNormals=e.NORMAL),e.COLOR_0&&(e.instanceColors=e.COLOR_0))}class sw extends ef{getShaders(){return super.getShaders({vs:PW,fs:UW,modules:[Rb,lV,Ob]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:eI},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:tI}})}updateState(t){const{changeFlags:e,props:n}=t;if(super.updateState(t),e.extensionsChanged){var i;const{gl:s}=this.context;(i=this.state.model)===null||i===void 0||i.delete(),this.state.model=this._getModel(s),this.getAttributeManager().invalidateAll()}e.dataChanged&&OW(n.data)}draw(t){let{uniforms:e}=t;const{pointSize:n,sizeUnits:i}=this.props;this.state.model.setUniforms(e).setUniforms({sizeUnits:Fv[i],radiusPixels:n}).draw()}_getModel(t){const e=[];for(let n=0;n<3;n++){const i=n/3*Math.PI*2;e.push(Math.cos(i)*2,Math.sin(i)*2,0)}return new jd(t,{...this.getShaders(),id:this.props.id,geometry:new rg({drawMode:4,attributes:{positions:new Float32Array(e)}}),isInstanced:!0})}}W(sw,"layerName","PointCloudLayer"),W(sw,"defaultProps",RW);const Ma={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};new le,new le;const Ag=new le,rI=new le;class hg{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;W(this,"center",void 0),W(this,"radius",void 0),this.radius=-0,this.center=new le,this.fromCenterRadius(t,e)}fromCenterRadius(t,e){return this.center.from(t),this.radius=e,this}fromCornerPoints(t,e){return e=Ag.from(e),this.center=new le().from(t).add(e).scale(.5),this.radius=this.center.distance(e),this}equals(t){return this===t||!!t&&this.center.equals(t.center)&&this.radius===t.radius}clone(){return new hg(this.center,this.radius)}union(t){const e=this.center,n=this.radius,i=t.center,s=t.radius,a=Ag.copy(i).subtract(e),o=a.magnitude();if(n>=o+s)return this.clone();if(s>=o+n)return t.clone();const A=(n+o+s)*.5;return rI.copy(a).scale((-n+A)/o).add(e),this.center.copy(rI),this.radius=A,this}expand(t){const n=Ag.from(t).subtract(this.center).magnitude();return n>this.radius&&(this.radius=n),this}transform(t){this.center.transform(t);const e=_G(Ag,t);return this.radius=Math.max(e[0],Math.max(e[1],e[2]))*this.radius,this}distanceSquaredTo(t){const e=this.distanceTo(t);return e*e}distanceTo(t){const n=Ag.from(t).subtract(this.center);return Math.max(0,n.len()-this.radius)}intersectPlane(t){const e=this.center,n=this.radius,s=t.normal.dot(e)+t.distance;return s<-n?Ma.OUTSIDE:s<n?Ma.INTERSECTING:Ma.INSIDE}}const DW=new le,kW=new le,N0=new le,Q0=new le,H0=new le,NW=new le,QW=new le,Fu={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class dg{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0,0,0,0,0,0,0];W(this,"center",void 0),W(this,"halfAxes",void 0),this.center=new le().from(t),this.halfAxes=new Qi(e)}get halfSize(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new le(t).len(),new le(e).len(),new le(n).len()]}get quaternion(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),i=new le(t).normalize(),s=new le(e).normalize(),a=new le(n).normalize();return new Zp().fromMatrix3(new Qi([...i,...s,...a]))}fromCenterHalfSizeQuaternion(t,e,n){const i=new Zp(n),s=new Qi().fromQuaternion(i);return s[0]=s[0]*e[0],s[1]=s[1]*e[0],s[2]=s[2]*e[0],s[3]=s[3]*e[1],s[4]=s[4]*e[1],s[5]=s[5]*e[1],s[6]=s[6]*e[2],s[7]=s[7]*e[2],s[8]=s[8]*e[2],this.center=new le().from(t),this.halfAxes=s,this}clone(){return new dg(this.center,this.halfAxes)}equals(t){return this===t||!!t&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}getBoundingSphere(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new hg;const e=this.halfAxes,n=e.getColumn(0,N0),i=e.getColumn(1,Q0),s=e.getColumn(2,H0),a=DW.copy(n).add(i).add(s);return t.center.copy(this.center),t.radius=a.magnitude(),t}intersectPlane(t){const e=this.center,n=t.normal,i=this.halfAxes,s=n.x,a=n.y,o=n.z,A=Math.abs(s*i[Fu.COLUMN0ROW0]+a*i[Fu.COLUMN0ROW1]+o*i[Fu.COLUMN0ROW2])+Math.abs(s*i[Fu.COLUMN1ROW0]+a*i[Fu.COLUMN1ROW1]+o*i[Fu.COLUMN1ROW2])+Math.abs(s*i[Fu.COLUMN2ROW0]+a*i[Fu.COLUMN2ROW1]+o*i[Fu.COLUMN2ROW2]),f=n.dot(e)+t.distance;return f<=-A?Ma.OUTSIDE:f>=A?Ma.INSIDE:Ma.INTERSECTING}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=kW.from(t).subtract(this.center),n=this.halfAxes,i=n.getColumn(0,N0),s=n.getColumn(1,Q0),a=n.getColumn(2,H0),o=i.magnitude(),A=s.magnitude(),f=a.magnitude();i.normalize(),s.normalize(),a.normalize();let m=0,b;return b=Math.abs(e.dot(i))-o,b>0&&(m+=b*b),b=Math.abs(e.dot(s))-A,b>0&&(m+=b*b),b=Math.abs(e.dot(a))-f,b>0&&(m+=b*b),m}computePlaneDistances(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[-0,-0],i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const a=this.center,o=this.halfAxes,A=o.getColumn(0,N0),f=o.getColumn(1,Q0),m=o.getColumn(2,H0),b=NW.copy(A).add(f).add(m).add(a),x=QW.copy(b).subtract(t);let C=e.dot(x);return i=Math.min(C,i),s=Math.max(C,s),b.copy(a).add(A).add(f).subtract(m),x.copy(b).subtract(t),C=e.dot(x),i=Math.min(C,i),s=Math.max(C,s),b.copy(a).add(A).subtract(f).add(m),x.copy(b).subtract(t),C=e.dot(x),i=Math.min(C,i),s=Math.max(C,s),b.copy(a).add(A).subtract(f).subtract(m),x.copy(b).subtract(t),C=e.dot(x),i=Math.min(C,i),s=Math.max(C,s),a.copy(b).subtract(A).add(f).add(m),x.copy(b).subtract(t),C=e.dot(x),i=Math.min(C,i),s=Math.max(C,s),a.copy(b).subtract(A).add(f).subtract(m),x.copy(b).subtract(t),C=e.dot(x),i=Math.min(C,i),s=Math.max(C,s),a.copy(b).subtract(A).subtract(f).add(m),x.copy(b).subtract(t),C=e.dot(x),i=Math.min(C,i),s=Math.max(C,s),a.copy(b).subtract(A).subtract(f).subtract(m),x.copy(b).subtract(t),C=e.dot(x),i=Math.min(C,i),s=Math.max(C,s),n[0]=i,n[1]=s,n}transform(t){this.center.transformAsPoint(t);const e=this.halfAxes.getColumn(0,N0);e.transformAsPoint(t);const n=this.halfAxes.getColumn(1,Q0);n.transformAsPoint(t);const i=this.halfAxes.getColumn(2,H0);return i.transformAsPoint(t),this.halfAxes=new Qi([...e,...n,...i]),this}getTransform(){throw new Error("not implemented")}}const nI=new le,iI=new le;class Hc{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,1],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;W(this,"normal",void 0),W(this,"distance",void 0),this.normal=new le,this.distance=-0,this.fromNormalDistance(t,e)}fromNormalDistance(t,e){return Dc(Number.isFinite(e)),this.normal.from(t).normalize(),this.distance=e,this}fromPointNormal(t,e){t=nI.from(t),this.normal.from(e).normalize();const n=-this.normal.dot(t);return this.distance=n,this}fromCoefficients(t,e,n,i){return this.normal.set(t,e,n),Dc(kc(this.normal.len(),1)),this.distance=i,this}clone(){return new Hc(this.normal,this.distance)}equals(t){return kc(this.distance,t.distance)&&kc(this.normal,t.normal)}getPointDistance(t){return this.normal.dot(t)+this.distance}transform(t){const e=iI.copy(this.normal).transformAsVector(t).normalize(),n=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(n,e)}projectPointOntoPlane(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];t=nI.from(t);const n=this.getPointDistance(t),i=iI.copy(this.normal).scale(n);return t.subtract(i).to(e)}}const sI=[new le([1,0,0]),new le([0,1,0]),new le([0,0,1])],oI=new le,HW=new le;new Hc(new le(1,0,0),0);class rc{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];W(this,"planes",void 0),this.planes=t}fromBoundingSphere(t){this.planes.length=2*sI.length;const e=t.center,n=t.radius;let i=0;for(const s of sI){let a=this.planes[i],o=this.planes[i+1];a||(a=this.planes[i]=new Hc),o||(o=this.planes[i+1]=new Hc);const A=oI.copy(s).scale(-n).add(e);-s.dot(A),a.fromPointNormal(A,s);const f=oI.copy(s).scale(n).add(e),m=HW.copy(s).negate();-m.dot(f),o.fromPointNormal(f,m),i+=2}return this}computeVisibility(t){let e=Ma.INSIDE;for(const n of this.planes)switch(t.intersectPlane(n)){case Ma.OUTSIDE:return Ma.OUTSIDE;case Ma.INTERSECTING:e=Ma.INTERSECTING;break}return e}computeVisibilityWithPlaneMask(t,e){if(Dc(Number.isFinite(e),"parentPlaneMask is required."),e===rc.MASK_OUTSIDE||e===rc.MASK_INSIDE)return e;let n=rc.MASK_INSIDE;const i=this.planes;for(let s=0;s<this.planes.length;++s){const a=s<31?1<<s:0;if(s<31&&!(e&a))continue;const o=i[s],A=t.intersectPlane(o);if(A===Ma.OUTSIDE)return rc.MASK_OUTSIDE;A===Ma.INTERSECTING&&(n|=a)}return n}}W(rc,"MASK_OUTSIDE",4294967295),W(rc,"MASK_INSIDE",0),W(rc,"MASK_INDETERMINATE",2147483647),new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le;const zl=new Qi,zW=new Qi,GW=new Qi,z0=new Qi,aI=new Qi;function VW(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e=tg.EPSILON20,n=10;let i=0,s=0;const a=zW,o=GW;a.identity(),o.copy(r);const A=e*jW(o);for(;s<n&&qW(o)>A;)KW(o,z0),aI.copy(z0).transpose(),o.multiplyRight(z0),o.multiplyLeft(aI),a.multiplyRight(z0),++i>2&&(++s,i=0);return t.unitary=a.toTarget(t.unitary),t.diagonal=o.toTarget(t.diagonal),t}function jW(r){let t=0;for(let e=0;e<9;++e){const n=r[e];t+=n*n}return Math.sqrt(t)}const ow=[1,0,0],aw=[2,2,1];function qW(r){let t=0;for(let e=0;e<3;++e){const n=r[zl.getElementIndex(aw[e],ow[e])];t+=2*n*n}return Math.sqrt(t)}function KW(r,t){const e=tg.EPSILON15;let n=0,i=1;for(let f=0;f<3;++f){const m=Math.abs(r[zl.getElementIndex(aw[f],ow[f])]);m>n&&(i=f,n=m)}const s=ow[i],a=aw[i];let o=1,A=0;if(Math.abs(r[zl.getElementIndex(a,s)])>e){const f=r[zl.getElementIndex(a,a)],m=r[zl.getElementIndex(s,s)],b=r[zl.getElementIndex(a,s)],x=(f-m)/2/b;let C;x<0?C=-1/(-x+Math.sqrt(1+x*x)):C=1/(x+Math.sqrt(1+x*x)),o=1/Math.sqrt(1+C*C),A=C*o}return Qi.IDENTITY.to(t),t[zl.getElementIndex(s,s)]=t[zl.getElementIndex(a,a)]=o,t[zl.getElementIndex(a,s)]=A,t[zl.getElementIndex(s,a)]=-A,t}const MA=new le,WW=new le,$W=new le,XW=new le,YW=new le,JW=new Qi,ZW={diagonal:new Qi,unitary:new Qi};function t$(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new dg;if(!r||r.length===0)return t.halfAxes=new Qi([0,0,0,0,0,0,0,0,0]),t.center=new le,t;const e=r.length,n=new le(0,0,0);for(const Rt of r)n.add(Rt);const i=1/e;n.multiplyByScalar(i);let s=0,a=0,o=0,A=0,f=0,m=0;for(const Rt of r){const Lt=MA.copy(Rt).subtract(n);s+=Lt.x*Lt.x,a+=Lt.x*Lt.y,o+=Lt.x*Lt.z,A+=Lt.y*Lt.y,f+=Lt.y*Lt.z,m+=Lt.z*Lt.z}s*=i,a*=i,o*=i,A*=i,f*=i,m*=i;const b=JW;b[0]=s,b[1]=a,b[2]=o,b[3]=a,b[4]=A,b[5]=f,b[6]=o,b[7]=f,b[8]=m;const{unitary:x}=VW(b,ZW),C=t.halfAxes.copy(x);let M=C.getColumn(0,$W),U=C.getColumn(1,XW),N=C.getColumn(2,YW),Q=-Number.MAX_VALUE,q=-Number.MAX_VALUE,Y=-Number.MAX_VALUE,tt=Number.MAX_VALUE,ft=Number.MAX_VALUE,pt=Number.MAX_VALUE;for(const Rt of r)MA.copy(Rt),Q=Math.max(MA.dot(M),Q),q=Math.max(MA.dot(U),q),Y=Math.max(MA.dot(N),Y),tt=Math.min(MA.dot(M),tt),ft=Math.min(MA.dot(U),ft),pt=Math.min(MA.dot(N),pt);M=M.multiplyByScalar(.5*(tt+Q)),U=U.multiplyByScalar(.5*(ft+q)),N=N.multiplyByScalar(.5*(pt+Y)),t.center.copy(M).add(U).add(N);const mt=WW.set(Q-tt,q-ft,Y-pt).multiplyByScalar(.5),dt=new Qi([mt[0],0,0,0,mt[1],0,0,0,mt[2]]);return t.halfAxes.multiplyRight(dt),t}const cw=Math.PI/180,G0=new Float32Array(16),cI=new Float32Array(12);function lI(r,t,e){const n=t[0]*cw,i=t[1]*cw,s=t[2]*cw,a=Math.sin(s),o=Math.sin(n),A=Math.sin(i),f=Math.cos(s),m=Math.cos(n),b=Math.cos(i),x=e[0],C=e[1],M=e[2];r[0]=x*b*m,r[1]=x*A*m,r[2]=x*-o,r[3]=C*(-A*f+b*o*a),r[4]=C*(b*f+A*o*a),r[5]=C*m*a,r[6]=M*(A*a+b*o*f),r[7]=M*(-b*a+A*o*f),r[8]=M*m*f}function uI(r){return r[0]=r[0],r[1]=r[1],r[2]=r[2],r[3]=r[4],r[4]=r[5],r[5]=r[6],r[6]=r[8],r[7]=r[9],r[8]=r[10],r[9]=r[12],r[10]=r[13],r[11]=r[14],r.subarray(0,12)}const AI={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(r,t){let{startRow:e,endRow:n}=t;const{data:i,getOrientation:s,getScale:a,getTranslation:o,getTransformMatrix:A}=this.props,f=Array.isArray(A),m=f&&A.length===16,b=Array.isArray(a),x=Array.isArray(s),C=Array.isArray(o),M=m||!f&&!!A(i[0]);M?r.constant=m:r.constant=x&&b&&C;const U=r.value;if(r.constant){let N;M?(G0.set(A),N=uI(G0)):(N=cI,lI(N,s,a),N.set(o,9)),r.value=new Float32Array(N)}else{let N=e*r.size;const{iterable:Q,objectInfo:q}=O3(i,e,n);for(const Y of Q){q.index++;let tt;if(M)G0.set(m?A:A(Y,q)),tt=uI(G0);else{tt=cI;const ft=x?s:s(Y,q),pt=b?a:a(Y,q);lI(tt,ft,pt),tt.set(C?o:o(Y,q),9)}U[N++]=tt[0],U[N++]=tt[1],U[N++]=tt[2],U[N++]=tt[3],U[N++]=tt[4],U[N++]=tt[5],U[N++]=tt[6],U[N++]=tt[7],U[N++]=tt[8],U[N++]=tt[9],U[N++]=tt[10],U[N++]=tt[11]}}}};function hI(r,t){return t===Sn.CARTESIAN||t===Sn.METER_OFFSETS||t===Sn.DEFAULT&&!r.isGeospatial}const e$=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,r$=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function dI(r){let t=1/0,e=1/0,n=1/0,i=-1/0,s=-1/0,a=-1/0;const o=r.POSITION?r.POSITION.value:[],A=o&&o.length;for(let f=0;f<A;f+=3){const m=o[f],b=o[f+1],x=o[f+2];t=m<t?m:t,e=b<e?b:e,n=x<n?x:n,i=m>i?m:i,s=b>s?b:s,a=x>a?x:a}return[[t,e,n],[i,s,a]]}function n$(r,t){if(!r)throw new Error(t||"loader assertion failed.")}class rf{constructor(t,e){W(this,"fields",void 0),W(this,"metadata",void 0),n$(Array.isArray(t)),i$(t),this.fields=t,this.metadata=e||new Map}compareTo(t){if(this.metadata!==t.metadata||this.fields.length!==t.fields.length)return!1;for(let e=0;e<this.fields.length;++e)if(!this.fields[e].compareTo(t.fields[e]))return!1;return!0}select(){const t=Object.create(null);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];for(const a of n)t[a]=!0;const s=this.fields.filter(a=>t[a.name]);return new rf(s,this.metadata)}selectAt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.map(s=>this.fields[s]).filter(Boolean);return new rf(i,this.metadata)}assign(t){let e,n=this.metadata;if(t instanceof rf){const a=t;e=a.fields,n=fI(fI(new Map,this.metadata),a.metadata)}else e=t;const i=Object.create(null);for(const a of this.fields)i[a.name]=a;for(const a of e)i[a.name]=a;const s=Object.values(i);return new rf(s,n)}}function i$(r){const t={};for(const e of r)t[e.name]&&console.warn("Schema: duplicated field name",e.name,e),t[e.name]=!0}function fI(r,t){return new Map([...r||new Map,...t||new Map])}class V0{constructor(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;W(this,"name",void 0),W(this,"type",void 0),W(this,"nullable",void 0),W(this,"metadata",void 0),this.name=t,this.type=e,this.nullable=n,this.metadata=i}get typeId(){return this.type&&this.type.typeId}clone(){return new V0(this.name,this.type,this.nullable,this.metadata)}compareTo(t){return this.name===t.name&&this.type===t.type&&this.nullable===t.nullable&&this.metadata===t.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let Hi=function(r){return r[r.NONE=0]="NONE",r[r.Null=1]="Null",r[r.Int=2]="Int",r[r.Float=3]="Float",r[r.Binary=4]="Binary",r[r.Utf8=5]="Utf8",r[r.Bool=6]="Bool",r[r.Decimal=7]="Decimal",r[r.Date=8]="Date",r[r.Time=9]="Time",r[r.Timestamp=10]="Timestamp",r[r.Interval=11]="Interval",r[r.List=12]="List",r[r.Struct=13]="Struct",r[r.Union=14]="Union",r[r.FixedSizeBinary=15]="FixedSizeBinary",r[r.FixedSizeList=16]="FixedSizeList",r[r.Map=17]="Map",r[r.Dictionary=-1]="Dictionary",r[r.Int8=-2]="Int8",r[r.Int16=-3]="Int16",r[r.Int32=-4]="Int32",r[r.Int64=-5]="Int64",r[r.Uint8=-6]="Uint8",r[r.Uint16=-7]="Uint16",r[r.Uint32=-8]="Uint32",r[r.Uint64=-9]="Uint64",r[r.Float16=-10]="Float16",r[r.Float32=-11]="Float32",r[r.Float64=-12]="Float64",r[r.DateDay=-13]="DateDay",r[r.DateMillisecond=-14]="DateMillisecond",r[r.TimestampSecond=-15]="TimestampSecond",r[r.TimestampMillisecond=-16]="TimestampMillisecond",r[r.TimestampMicrosecond=-17]="TimestampMicrosecond",r[r.TimestampNanosecond=-18]="TimestampNanosecond",r[r.TimeSecond=-19]="TimeSecond",r[r.TimeMillisecond=-20]="TimeMillisecond",r[r.TimeMicrosecond=-21]="TimeMicrosecond",r[r.TimeNanosecond=-22]="TimeNanosecond",r[r.DenseUnion=-23]="DenseUnion",r[r.SparseUnion=-24]="SparseUnion",r[r.IntervalDayTime=-25]="IntervalDayTime",r[r.IntervalYearMonth=-26]="IntervalYearMonth",r}({}),pI,gI,mI;class lw{static isNull(t){return t&&t.typeId===Hi.Null}static isInt(t){return t&&t.typeId===Hi.Int}static isFloat(t){return t&&t.typeId===Hi.Float}static isBinary(t){return t&&t.typeId===Hi.Binary}static isUtf8(t){return t&&t.typeId===Hi.Utf8}static isBool(t){return t&&t.typeId===Hi.Bool}static isDecimal(t){return t&&t.typeId===Hi.Decimal}static isDate(t){return t&&t.typeId===Hi.Date}static isTime(t){return t&&t.typeId===Hi.Time}static isTimestamp(t){return t&&t.typeId===Hi.Timestamp}static isInterval(t){return t&&t.typeId===Hi.Interval}static isList(t){return t&&t.typeId===Hi.List}static isStruct(t){return t&&t.typeId===Hi.Struct}static isUnion(t){return t&&t.typeId===Hi.Union}static isFixedSizeBinary(t){return t&&t.typeId===Hi.FixedSizeBinary}static isFixedSizeList(t){return t&&t.typeId===Hi.FixedSizeList}static isMap(t){return t&&t.typeId===Hi.Map}static isDictionary(t){return t&&t.typeId===Hi.Dictionary}get typeId(){return Hi.NONE}compareTo(t){return this===t}}pI=Symbol.toStringTag;class nf extends lw{constructor(t,e){super(),W(this,"isSigned",void 0),W(this,"bitWidth",void 0),this.isSigned=t,this.bitWidth=e}get typeId(){return Hi.Int}get[pI](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class s$ extends nf{constructor(){super(!0,8)}}class o$ extends nf{constructor(){super(!0,16)}}class a$ extends nf{constructor(){super(!0,32)}}class c$ extends nf{constructor(){super(!1,8)}}class l$ extends nf{constructor(){super(!1,16)}}class u$ extends nf{constructor(){super(!1,32)}}const yI={HALF:16,SINGLE:32,DOUBLE:64};gI=Symbol.toStringTag;class _I extends lw{constructor(t){super(),W(this,"precision",void 0),this.precision=t}get typeId(){return Hi.Float}get[gI](){return"Float"}toString(){return"Float".concat(this.precision)}}class A$ extends _I{constructor(){super(yI.SINGLE)}}class h$ extends _I{constructor(){super(yI.DOUBLE)}}mI=Symbol.toStringTag;class d$ extends lw{constructor(t,e){super(),W(this,"listSize",void 0),W(this,"children",void 0),this.listSize=t,this.children=[e]}get typeId(){return Hi.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[mI](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function f$(r){switch(r.constructor){case Int8Array:return new s$;case Uint8Array:return new c$;case Int16Array:return new o$;case Uint16Array:return new l$;case Int32Array:return new a$;case Uint32Array:return new u$;case Float32Array:return new A$;case Float64Array:return new h$;default:throw new Error("array type not supported")}}function p$(r,t,e){const n=f$(t.value),i=e||g$(t);return new V0(r,new d$(t.size,new V0("value",n)),!1,i)}function g$(r){const t=new Map;return"byteOffset"in r&&t.set("byteOffset",r.byteOffset.toString(10)),"byteStride"in r&&t.set("byteStride",r.byteStride.toString(10)),"normalized"in r&&t.set("normalized",r.normalized.toString()),t}function vI(r,t){(r.COLOR_0||r.colors)&&t||(r.colors={constant:!0,value:new Float32Array([1,1,1])}),Fn.assert(r.positions||r.POSITION,'no "postions" or "POSITION" attribute in mesh')}function bI(r,t){if(r.attributes)return vI(r.attributes,t),r instanceof rg?r:new rg(r);if(r.positions||r.POSITION)return vI(r,t),new rg({attributes:r});throw Error("Invalid mesh")}const m$={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:r=>r.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class uw extends ef{constructor(){super(...arguments),W(this,"state",void 0)}getShaders(){const t=!pn(this.context.gl),e={};return jv(this.context.gl,pi.GLSL_DERIVATIVES)&&(e.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:e$,fs:r$,modules:[Rb,uV,Ob],transpileToGLSL100:t,defines:e})}getBounds(){var t;if(this.props._instanced)return super.getBounds();let e=this.state.positionBounds;if(e)return e;const{mesh:n}=this.props;if(!n)return null;if(e=(t=n.header)===null||t===void 0?void 0:t.boundingBox,!e){const{attributes:i}=bI(n,this.props._useMeshColors);i.POSITION=i.POSITION||i.positions,e=dI(i)}return this.state.positionBounds=e,e}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:AI}),this.setState({emptyTexture:new Ta(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:i}=t;if(e.mesh!==n.mesh||i.extensionsChanged){var s;if(this.state.positionBounds=null,(s=this.state.model)===null||s===void 0||s.delete(),e.mesh){this.state.model=this.getModel(e.mesh);const a=e.mesh.attributes||e.mesh;this.setState({hasNormals:!!(a.NORMAL||a.normals)})}this.getAttributeManager().invalidateAll()}e.texture!==n.texture&&this.setTexture(e.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(t){super.finalizeState(t),this.state.emptyTexture.delete()}draw(t){let{uniforms:e}=t;if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:i,coordinateSystem:s,_instanced:a}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:i,composeModelMatrix:!a||hI(n,s),flatShading:!this.state.hasNormals}).draw()}get isLoaded(){var t;return((t=this.state)===null||t===void 0?void 0:t.model)&&super.isLoaded}getModel(t){const e=new jd(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:bI(t,this.props._useMeshColors),isInstanced:!0}),{texture:n}=this.props,{emptyTexture:i}=this.state;return e.setUniforms({sampler:n||i,hasTexture:!!n}),e}setTexture(t){const{emptyTexture:e,model:n}=this.state;n&&n.setUniforms({sampler:t||e,hasTexture:!!t})}}W(uw,"defaultProps",m$),W(uw,"layerName","SimpleMeshLayer");class sf{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:e}=t;this.id=e||Cu(this.constructor.name),this.display=!0,this.position=new le,this.rotation=new le,this.scale=new le(1,1,1),this.matrix=new xn,this.userData={},this.props={},this._setScenegraphNodeProps(t)}delete(){}setProps(t){return this._setScenegraphNodeProps(t),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}getBounds(){return null}setPosition(t){return or(t.length===3,"setPosition requires vector argument"),this.position=t,this}setRotation(t){return or(t.length===3,"setRotation requires vector argument"),this.rotation=t,this}setScale(t){return or(t.length===3,"setScale requires vector argument"),this.scale=t,this}setMatrix(t){(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?this.matrix.copy(t):this.matrix=t}setMatrixComponents(t){let{position:e,rotation:n,scale:i,update:s=!0}=t;return e&&this.setPosition(e),n&&this.setRotation(n),i&&this.setScale(i),s&&this.updateMatrix(),this}updateMatrix(){const t=this.position,e=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(t),this.matrix.rotateXYZ(e),this.matrix.scale(n),this}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{position:e,rotation:n,scale:i}=t;return e&&this.setPosition(e),n&&this.setRotation(n),i&&this.setScale(i),this.updateMatrix(),this}getCoordinateUniforms(t,e){or(t),e=e||this.matrix;const n=new xn(t).multiplyRight(e),i=n.invert(),s=i.transpose();return{viewMatrix:t,modelMatrix:e,objectMatrix:e,worldMatrix:n,worldInverseMatrix:i,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(t){"display"in t&&(this.display=t.display),"position"in t&&this.setPosition(t.position),"rotation"in t&&this.setRotation(t.rotation),"scale"in t&&this.setScale(t.scale),"matrix"in t&&this.setMatrix(t.matrix),Object.assign(this.props,t)}}class fg extends sf{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t=Array.isArray(t)?{children:t}:t;const{children:e=[]}=t;mr.assert(e.every(n=>n instanceof sf),"every child must an instance of ScenegraphNode"),super(t),this.children=e}add(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)Array.isArray(i)?this.add(...i):this.children.push(i);return this}remove(t){const e=this.children,n=e.indexOf(t);return n>-1&&e.splice(n,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(t=>t.delete()),this.removeAll(),super.delete()}getBounds(){const t=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse((e,n)=>{let{worldMatrix:i}=n;const s=e.getBounds();if(!s)return;const[a,o]=s,A=new le(a).add(o).divide([2,2,2]);i.transformAsPoint(A,A);const f=new le(o).subtract(a).divide([2,2,2]);i.transformAsVector(f,f);for(let m=0;m<8;m++){const b=new le(m&1?-1:1,m&2?-1:1,m&4?-1:1).multiply(f).add(A);for(let x=0;x<3;x++)t[0][x]=Math.min(t[0][x],b[x]),t[1][x]=Math.max(t[1][x],b[x])}}),Number.isFinite(t[0][0])?t:null}traverse(t){let{worldMatrix:e=new xn}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=new xn(e).multiplyRight(this.matrix);for(const i of this.children)i instanceof fg?i.traverse(t,{worldMatrix:n}):t(i,{worldMatrix:n})}}const y$={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_$={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function wI(r){if(!r._animation){const t=_$[r.componentType],e=y$[r.type],n=e*r.count,{buffer:i,byteOffset:s}=r.bufferView.data,a=new t(i,s+(r.byteOffset||0),n);if(e===1)r._animation=Array.from(a);else{const o=[];for(let A=0;A<a.length;A+=e)o.push(Array.from(a.slice(A,A+e)));r._animation=o}}return r._animation}const v$=new xn;function b$(r,t){if(t.matrix.identity(),r.translation&&t.matrix.translate(r.translation),r.rotation){const e=v$.fromQuaternion(r.rotation);t.matrix.multiplyRight(e)}r.scale&&t.matrix.scale(r.scale)}const Aw=new Zp;function w$(r,t,e,n,i){if(t==="rotation"){Aw.slerp({start:e,target:n,ratio:i});for(let s=0;s<Aw.length;s++)r[t][s]=Aw[s]}else for(let s=0;s<e.length;s++)r[t][s]=i*n[s]+(1-i)*e[s]}function x$(r,t,e){let{p0:n,outTangent0:i,inTangent1:s,p1:a,tDiff:o,ratio:A}=e;for(let f=0;f<r[t].length;f++){const m=i[f]*o,b=s[f]*o;r[t][f]=(2*Math.pow(A,3)-3*Math.pow(A,2)+1)*n[f]+(Math.pow(A,3)-2*Math.pow(A,2)+A)*m+(-2*Math.pow(A,3)+3*Math.pow(A,2))*a[f]+(Math.pow(A,3)-Math.pow(A,2))*b}}function B$(r,t,e){for(let n=0;n<e.length;n++)r[t][n]=e[n]}function C$(r,t,e,n){let{input:i,interpolation:s,output:a}=t;const o=i[i.length-1],A=r%o,f=i.findIndex(C=>C>=A),m=Math.max(0,f-1);if(!Array.isArray(e[n]))switch(n){case"translation":e[n]=[0,0,0];break;case"rotation":e[n]=[0,0,0,1];break;case"scale":e[n]=[1,1,1];break;default:mr.warn("Bad animation path ".concat(n))()}or(e[n].length===a[m].length);const b=i[m],x=i[f];switch(s){case"STEP":B$(e,n,a[m]);break;case"LINEAR":if(x>b){const C=(A-b)/(x-b);w$(e,n,a[m],a[f],C)}break;case"CUBICSPLINE":if(x>b){const C=(A-b)/(x-b),M=x-b,U=a[3*m+1],N=a[3*m+2],Q=a[3*f+0],q=a[3*f+1];x$(e,n,{p0:U,outTangent0:N,inTangent1:Q,p1:q,tDiff:M,ratio:C})}break;default:mr.warn("Interpolation ".concat(s," not supported"))();break}}class E${constructor(t){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,t)}animate(t){if(!this.playing)return;const n=(t/1e3-this.startTime)*this.speed;this.channels.forEach(i=>{let{sampler:s,target:a,path:o}=i;C$(n,s,a,o),b$(a,a._node)})}}class S${constructor(t){this.animations=t.animations.map((e,n)=>{const i=e.name||"Animation-".concat(n),s=e.samplers.map(o=>{let{input:A,interpolation:f="LINEAR",output:m}=o;return{input:wI(t.accessors[A]),interpolation:f,output:wI(t.accessors[m])}}),a=e.channels.map(o=>{let{sampler:A,target:f}=o;return{sampler:s[A],target:t.nodes[f.node],path:f.path}});return new E$({name:i,channels:a})})}animate(t){this.setTime(t)}setTime(t){this.animations.forEach(e=>e.animate(t))}getAnimations(){return this.animations}}class T$ extends sf{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),this.onBeforeRender=null,this.AfterRender=null,t instanceof jd?(this.model=t,this._setModelNodeProps(e)):this.model=new jd(t,e),this.bounds=null,this.managedResources=e.managedResources||[]}setProps(t){return super.setProps(t),this._setModelNodeProps(t),this}getBounds(){return this.bounds}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(t=>t.delete()),this.managedResources=[]}draw(){return this.model.draw(...arguments)}setUniforms(){return this.model.setUniforms(...arguments),this}setAttributes(){return this.model.setAttributes(...arguments),this}updateModuleSettings(){return this.model.updateModuleSettings(...arguments),this}_setModelNodeProps(t){this.model.setProps(t)}}class xI{constructor(t,e){let{attributes:n,material:i,pbrDebug:s,imageBasedLightingEnvironment:a,lights:o,useTangents:A}=e;this.gl=t,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},jv(t,pi.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],a&&(this.uniforms.u_DiffuseEnvSampler=a.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=a.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=a.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),s&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(n.NORMAL,"HAS_NORMALS"),this.defineIfPresent(n.TANGENT&&A,"HAS_TANGENTS"),this.defineIfPresent(n.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(a,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(s,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(t,e){t&&(this.defines[e]=1)}parseTexture(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=t.texture&&t.texture.sampler&&t.texture.sampler.parameters||{},s=t.texture.source.image;let a,o={};s.compressed?(a=s,o={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):a={data:s};const A=new Ta(this.gl,{id:t.name||t.id,parameters:{...i,...o},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...a});this.uniforms[e]=A,this.defineIfPresent(n,n),this.generatedTextures.push(A)}parsePbrMetallicRoughness(t){t.baseColorTexture&&this.parseTexture(t.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=t.baseColorFactor||[1,1,1,1],t.metallicRoughnessTexture&&this.parseTexture(t.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:e=1,roughnessFactor:n=1}=t;this.uniforms.u_MetallicRoughnessValues=[e,n]}parseMaterial(t){if(this.uniforms.pbr_uUnlit=!!t.unlit,t.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(t.pbrMetallicRoughness),t.normalTexture){this.parseTexture(t.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:e=1}=t.normalTexture;this.uniforms.u_NormalScale=e}if(t.occlusionTexture){this.parseTexture(t.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:e=1}=t.occlusionTexture;this.uniforms.u_OcclusionStrength=e}if(t.emissiveTexture&&(this.parseTexture(t.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=t.emissiveFactor||[0,0,0]),t.alphaMode==="MASK"){const{alphaCutoff:e=.5}=t;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=e}else t.alphaMode==="BLEND"&&(mr.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}delete(){this.generatedTextures.forEach(t=>t.delete())}}const I$=`
#if (__VERSION__ < 300)
  #define _attr attribute
#else
  #define _attr in
#endif

  _attr vec4 POSITION;

  #ifdef HAS_NORMALS
    _attr vec4 NORMAL;
  #endif

  #ifdef HAS_TANGENTS
    _attr vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    _attr vec2 TEXCOORD_0;
  #endif

  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = NORMAL;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = TEXCOORD_0;
    #endif

    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = u_MVPMatrix * POSITION;
  }
`,L$=`
#if (__VERSION__ < 300)
  #define fragmentColor gl_FragColor
#else
  out vec4 fragmentColor;
#endif

  void main(void) {
    fragmentColor = pbr_filterColor(vec4(0));
  }
`;function BI(r,t){return pn(r)?`#version 300 es
`.concat(t):t}function F$(r,t){const{id:e,drawMode:n,vertexCount:i,attributes:s,modelOptions:a}=t,o=new xI(r,t);mr.info(4,"createGLTFModel defines: ",o.defines)();const A=[];A.push(...o.generatedTextures),A.push(...Object.values(s).map(m=>m.buffer));const f=new T$(r,{id:e,drawMode:n,vertexCount:i,modules:[bb],parameters:o.parameters,vs:BI(r,I$),fs:BI(r,L$),managedResources:A,...a,defines:{...o.defines,...a.defines}});return f.setProps({attributes:s}),f.setUniforms(o.uniforms),f}const M$={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},P$={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class U${constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=t,this.options=Object.assign({},P$,e)}instantiate(t){return this.gltf=t,(t.scenes||[]).map(n=>this.createScene(n))}createAnimator(){return Array.isArray(this.gltf.animations)?new S$(this.gltf):null}createScene(t){const n=(t.nodes||[]).map(s=>this.createNode(s));return new fg({id:t.name||t.id,children:n})}createNode(t){if(!t._node){const n=(t.children||[]).map(s=>this.createNode(s));t.mesh&&n.push(this.createMesh(t.mesh));const i=new fg({id:t.name||t.id,children:n});if(t.matrix)i.setMatrix(t.matrix);else{if(i.matrix.identity(),t.translation&&i.matrix.translate(t.translation),t.rotation){const s=new xn().fromQuaternion(t.rotation);i.matrix.multiplyRight(s)}t.scale&&i.matrix.scale(t.scale)}t._node=i}return t._node}createMesh(t){if(!t._mesh){const n=(t.primitives||[]).map((s,a)=>this.createPrimitive(s,a,t)),i=new fg({id:t.name||t.id,children:n});t._mesh=i}return t._mesh}getVertexCount(t){mr.warn("getVertexCount() not found")()}createPrimitive(t,e,n){const i=F$(this.gl,Object.assign({id:t.name||"".concat(n.name||n.id,"-primitive-").concat(e),drawMode:t.mode||4,vertexCount:t.indices?t.indices.count:this.getVertexCount(t.attributes),attributes:this.createAttributes(t.attributes,t.indices),material:t.material},this.options));return i.bounds=[t.attributes.POSITION.min,t.attributes.POSITION.max],i}createAttributes(t,e){const n={};return Object.keys(t).forEach(i=>{n[i]=this.createAccessor(t[i],this.createBuffer(t[i],this.gl.ARRAY_BUFFER))}),e&&(n.indices=this.createAccessor(e,this.createBuffer(e,this.gl.ELEMENT_ARRAY_BUFFER))),mr.info(4,"glTF Attributes",{attributes:t,indices:e,generated:n})(),n}createBuffer(t,e){t.bufferView||(t.bufferView={});const{bufferView:n}=t;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[e]||(n.lumaBuffers[e]=new ei(this.gl,{id:"from-".concat(n.id),data:n.data||t.value,target:e})),n.lumaBuffers[e]}createAccessor(t,e){return new oa({buffer:e,offset:t.byteOffset||0,stride:t.bufferView.byteStride||0,type:t.componentType,size:M$[t.type]})}createSampler(t){return t}needsPOT(){return!1}}function R$(r,t,e){const n=new U$(r,e),i=n.instantiate(t),s=n.createAnimator();return{scenes:i,animator:s}}const O$="3.4.14",D$="3.4.14",CI="3.4.14",k$="https://unpkg.com/@loaders.gl/textures@".concat(CI,"/dist/libs/basis_encoder.wasm"),N$="https://unpkg.com/@loaders.gl/textures@".concat(CI,"/dist/libs/basis_encoder.js");let hw;async function EI(r){const t=r.modules||{};return t.basis?t.basis:(hw=hw||Q$(r),await hw)}async function Q$(r){let t=null,e=null;return[t,e]=await Promise.all([await Bh("basis_transcoder.js","textures",r),await Bh("basis_transcoder.wasm","textures",r)]),t=t||globalThis.BASIS,await H$(t,e)}function H$(r,t){const e={};return t&&(e.wasmBinary=t),new Promise(n=>{r(e).then(i=>{const{BasisFile:s,initializeBasis:a}=i;a(),n({BasisFile:s})})})}let dw;async function SI(r){const t=r.modules||{};return t.basisEncoder?t.basisEncoder:(dw=dw||z$(r),await dw)}async function z$(r){let t=null,e=null;return[t,e]=await Promise.all([await Bh(N$,"textures",r),await Bh(k$,"textures",r)]),t=t||globalThis.BASIS,await G$(t,e)}function G$(r,t){const e={};return t&&(e.wasmBinary=t),new Promise(n=>{r(e).then(i=>{const{BasisFile:s,KTX2File:a,initializeBasis:o,BasisEncoder:A}=i;o(),n({BasisFile:s,KTX2File:a,BasisEncoder:A})})})}const of={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919},V$=["","WEBKIT_","MOZ_"],TI={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let j0=null;function j$(r){if(!j0){r=r||q$()||void 0,j0=new Set;for(const t of V$)for(const e in TI)if(r&&r.getExtension("".concat(t).concat(e))){const n=TI[e];j0.add(n)}}return j0}function q$(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}var II,LI,FI,MI,PI,UI,RI,OI;(function(r){r[r.NONE=0]="NONE",r[r.BASISLZ=1]="BASISLZ",r[r.ZSTD=2]="ZSTD",r[r.ZLIB=3]="ZLIB"})(II||(II={})),function(r){r[r.BASICFORMAT=0]="BASICFORMAT"}(LI||(LI={})),function(r){r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.ETC1S=163]="ETC1S",r[r.UASTC=166]="UASTC"}(FI||(FI={})),function(r){r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.SRGB=1]="SRGB"}(MI||(MI={})),function(r){r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.LINEAR=1]="LINEAR",r[r.SRGB=2]="SRGB",r[r.ITU=3]="ITU",r[r.NTSC=4]="NTSC",r[r.SLOG=5]="SLOG",r[r.SLOG2=6]="SLOG2"}(PI||(PI={})),function(r){r[r.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",r[r.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(UI||(UI={})),function(r){r[r.RGB=0]="RGB",r[r.RRR=3]="RRR",r[r.GGG=4]="GGG",r[r.AAA=15]="AAA"}(RI||(RI={})),function(r){r[r.RGB=0]="RGB",r[r.RGBA=3]="RGBA",r[r.RRR=4]="RRR",r[r.RRRG=5]="RRRG"}(OI||(OI={}));const Pa=[171,75,84,88,32,50,48,187,13,10,26,10];function K$(r){const t=new Uint8Array(r);return!(t.byteLength<Pa.length||t[0]!==Pa[0]||t[1]!==Pa[1]||t[2]!==Pa[2]||t[3]!==Pa[3]||t[4]!==Pa[4]||t[5]!==Pa[5]||t[6]!==Pa[6]||t[7]!==Pa[7]||t[8]!==Pa[8]||t[9]!==Pa[9]||t[10]!==Pa[10]||t[11]!==Pa[11])}const W$={etc1:{basisFormat:0,compressed:!0,format:of.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:of.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:of.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:of.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:of.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:of.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function $$(r,t){if(t.basis.containerFormat==="auto"){if(K$(r)){const n=await SI(t);return DI(n.KTX2File,r,t)}const{BasisFile:e}=await EI(t);return fw(e,r,t)}switch(t.basis.module){case"encoder":const e=await SI(t);switch(t.basis.containerFormat){case"ktx2":return DI(e.KTX2File,r,t);case"basis":default:return fw(e.BasisFile,r,t)}case"transcoder":default:const{BasisFile:n}=await EI(t);return fw(n,r,t)}}function fw(r,t,e){const n=new r(new Uint8Array(t));try{if(!n.startTranscoding())throw new Error("Failed to start basis transcoding");const i=n.getNumImages(),s=[];for(let a=0;a<i;a++){const o=n.getNumLevels(a),A=[];for(let f=0;f<o;f++)A.push(X$(n,a,f,e));s.push(A)}return s}finally{n.close(),n.delete()}}function X$(r,t,e,n){const i=r.getImageWidth(t,e),s=r.getImageHeight(t,e),a=r.getHasAlpha(),{compressed:o,format:A,basisFormat:f}=kI(n,a),m=r.getImageTranscodedSizeInBytes(t,e,f),b=new Uint8Array(m);if(!r.transcodeImage(b,t,e,f,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:s,data:b,compressed:o,format:A,hasAlpha:a}}function DI(r,t,e){const n=new r(new Uint8Array(t));try{if(!n.startTranscoding())throw new Error("failed to start KTX2 transcoding");const i=n.getLevels(),s=[];for(let a=0;a<i;a++){s.push(Y$(n,a,e));break}return[s]}finally{n.close(),n.delete()}}function Y$(r,t,e){const{alphaFlag:n,height:i,width:s}=r.getImageLevelInfo(t,0,0),{compressed:a,format:o,basisFormat:A}=kI(e,n),f=r.getImageTranscodedSizeInBytes(t,0,0,A),m=new Uint8Array(f);if(!r.transcodeImage(m,t,0,0,A,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:s,height:i,data:m,compressed:a,levelSize:f,hasAlpha:n,format:o}}function kI(r,t){let e=r&&r.basis&&r.basis.format;return e==="auto"&&(e=NI()),typeof e=="object"&&(e=t?e.alpha:e.noAlpha),e=e.toLowerCase(),W$[e]}function NI(){const r=j$();return r.has("astc")?"astc-4x4":r.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:r.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:r.has("etc1")?"etc1":r.has("etc2")?"etc2":"rgb565"}const J$={...{name:"Basis",id:bu?"basis":"basis-nodejs",module:"textures",version:D$,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},parse:$$};function Ua(r,t){if(!r)throw new Error(t||"assert failed: gltf")}function QI(r,t){if(r.startsWith("data:")||r.startsWith("http:")||r.startsWith("https:"))return r;const n=t.baseUri||t.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url ".concat(r));return n.substr(0,n.lastIndexOf("/")+1)+r}function Z$(r,t,e){const n=r.bufferViews[e];Ua(n);const i=n.buffer,s=t[i];Ua(s);const a=(n.byteOffset||0)+s.byteOffset;return new Uint8Array(s.arrayBuffer,a,n.byteLength)}const HI=["SCALAR","VEC2","VEC3","VEC4"],tX=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],eX=new Map(tX),rX={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},nX={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},iX={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function zI(r){return HI[r-1]||HI[0]}function GI(r){const t=eX.get(r.constructor);if(!t)throw new Error("Illegal typed array");return t}function pw(r,t){const e=iX[r.componentType],n=rX[r.type],i=nX[r.componentType],s=r.count*n,a=r.count*n*i;return Ua(a>=0&&a<=t.byteLength),{ArrayType:e,length:s,byteLength:a}}function VI(r){let{images:t,bufferViews:e}=r;t=t||[],e=e||[];const n=t.map(a=>a.bufferView);e=e.filter(a=>!n.includes(a));const i=e.reduce((a,o)=>a+o.byteLength,0),s=t.reduce((a,o)=>{const{width:A,height:f}=o.image;return a+A*f},0);return i+Math.ceil(4*s*1.33)}const sX={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class aa{constructor(t){W(this,"gltf",void 0),W(this,"sourceBuffers",void 0),W(this,"byteLength",void 0),this.gltf=t||{json:{...sX},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(t){return this.json[t]}getExtraData(t){return(this.json.extras||{})[t]}getExtension(t){const e=this.getUsedExtensions().find(i=>i===t),n=this.json.extensions||{};return e?n[t]||!0:null}getRequiredExtension(t){return this.getRequiredExtensions().find(n=>n===t)?this.getExtension(t):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(t,e){return(t.extensions||{})[e]}getScene(t){return this.getObject("scenes",t)}getNode(t){return this.getObject("nodes",t)}getSkin(t){return this.getObject("skins",t)}getMesh(t){return this.getObject("meshes",t)}getMaterial(t){return this.getObject("materials",t)}getAccessor(t){return this.getObject("accessors",t)}getTexture(t){return this.getObject("textures",t)}getSampler(t){return this.getObject("samplers",t)}getImage(t){return this.getObject("images",t)}getBufferView(t){return this.getObject("bufferViews",t)}getBuffer(t){return this.getObject("buffers",t)}getObject(t,e){if(typeof e=="object")return e;const n=this.json[t]&&this.json[t][e];if(!n)throw new Error("glTF file error: Could not find ".concat(t,"[").concat(e,"]"));return n}getTypedArrayForBufferView(t){t=this.getBufferView(t);const e=t.buffer,n=this.gltf.buffers[e];Ua(n);const i=(t.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,i,t.byteLength)}getTypedArrayForAccessor(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),i=this.getBuffer(e.buffer).data,{ArrayType:s,length:a}=pw(t,e),o=e.byteOffset+t.byteOffset;return new s(i,o,a)}getTypedArrayForImageData(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),i=this.getBuffer(e.buffer).data,s=e.byteOffset||0;return new Uint8Array(i,s,e.byteLength)}addApplicationData(t,e){return this.json[t]=e,this}addExtraData(t,e){return this.json.extras=this.json.extras||{},this.json.extras[t]=e,this}addObjectExtension(t,e,n){return t.extensions=t.extensions||{},t.extensions[e]=n,this.registerUsedExtension(e),this}setObjectExtension(t,e,n){const i=t.extensions||{};i[e]=n}removeObjectExtension(t,e){const n=t.extensions||{},i=n[e];return delete n[e],i}addExtension(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ua(e),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=e,this.registerUsedExtension(t),e}addRequiredExtension(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ua(e),this.addExtension(t,e),this.registerRequiredExtension(t),e}registerUsedExtension(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(e=>e===t)||this.json.extensionsUsed.push(t)}registerRequiredExtension(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(e=>e===t)||this.json.extensionsRequired.push(t)}removeExtension(t){if(!this.getExtension(t))return;this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t),this.json.extensions&&delete this.json.extensions[t],Array.isArray(this.json.extensionsRemoved)||(this.json.extensionsRemoved=[]);const e=this.json.extensionsRemoved;e.includes(t)||e.push(t)}setDefaultScene(t){this.json.scene=t}addScene(t){const{nodeIndices:e}=t;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:e}),this.json.scenes.length-1}addNode(t){const{meshIndex:e,matrix:n}=t;this.json.nodes=this.json.nodes||[];const i={mesh:e};return n&&(i.matrix=n),this.json.nodes.push(i),this.json.nodes.length-1}addMesh(t){const{attributes:e,indices:n,material:i,mode:s=4}=t,o={primitives:[{attributes:this._addAttributes(e),mode:s}]};if(n){const A=this._addIndices(n);o.primitives[0].indices=A}return Number.isFinite(i)&&(o.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(o),this.json.meshes.length-1}addPointCloud(t){const n={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(n),this.json.meshes.length-1}addImage(t,e){const n=xv(t),i=e||(n==null?void 0:n.mimeType),a={bufferView:this.addBufferView(t),mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(a),this.json.images.length-1}addBufferView(t){const e=t.byteLength;Ua(Number.isFinite(e)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);const n={buffer:0,byteOffset:this.byteLength,byteLength:e};return this.byteLength+=Fp(e,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1}addAccessor(t,e){const n={bufferView:t,type:zI(e.size),componentType:e.componentType,count:e.count,max:e.max,min:e.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}addBinaryBuffer(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{size:3};const n=this.addBufferView(t);let i={min:e.min,max:e.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(t,e.size));const s={size:e.size,componentType:GI(t),count:Math.round(t.length/e.size),min:i.min,max:i.max};return this.addAccessor(n,Object.assign(s,e))}addTexture(t){const{imageIndex:e}=t,n={source:e};return this.json.textures=this.json.textures||[],this.json.textures.push(n),this.json.textures.length-1}addMaterial(t){return this.json.materials=this.json.materials||[],this.json.materials.push(t),this.json.materials.length-1}createBinaryChunk(){var t,e;this.gltf.buffers=[];const n=this.byteLength,i=new ArrayBuffer(n),s=new Uint8Array(i);let a=0;for(const o of this.sourceBuffers||[])a=LN(o,s,a);(t=this.json)!==null&&t!==void 0&&(e=t.buffers)!==null&&e!==void 0&&e[0]?this.json.buffers[0].byteLength=n:this.json.buffers=[{byteLength:n}],this.gltf.binary=i,this.sourceBuffers=[i]}_removeStringFromArray(t,e){let n=!0;for(;n;){const i=t.indexOf(e);i>-1?t.splice(i,1):n=!1}}_addAttributes(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e={};for(const n in t){const i=t[n],s=this._getGltfAttributeName(n),a=this.addBinaryBuffer(i.value,i);e[s]=a}return e}_addIndices(t){return this.addBinaryBuffer(t,{size:1})}_getGltfAttributeName(t){switch(t.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return t}}_getAccessorMinMax(t,e){const n={min:null,max:null};if(t.length<e)return n;n.min=[],n.max=[];const i=t.subarray(0,e);for(const s of i)n.min.push(s),n.max.push(s);for(let s=e;s<t.length;s+=e)for(let a=0;a<e;a++)n.min[0+a]=Math.min(n.min[0+a],t[s+a]),n.max[0+a]=Math.max(n.max[0+a],t[s+a]);return n}}const oX="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",aX="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",cX=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),lX=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),uX={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},AX={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function hX(r,t,e,n,i){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"NONE";const a=await dX();gX(a,a.exports[AX[i]],r,t,e,n,a.exports[uX[s||"NONE"]])}let gw;async function dX(){return gw||(gw=fX()),gw}async function fX(){let r=oX;WebAssembly.validate(cX)&&(r=aX,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const t=await WebAssembly.instantiate(pX(r),{});return await t.instance.exports.__wasm_call_ctors(),t.instance}function pX(r){const t=new Uint8Array(r.length);for(let n=0;n<r.length;++n){const i=r.charCodeAt(n);t[n]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let e=0;for(let n=0;n<r.length;++n)t[e++]=t[n]<60?lX[t[n]]:(t[n]-60)*64+t[++n];return t.buffer.slice(0,e)}function gX(r,t,e,n,i,s,a){const o=r.exports.sbrk,A=n+3&-4,f=o(A*i),m=o(s.length),b=new Uint8Array(r.exports.memory.buffer);b.set(s,m);const x=t(f,n,i,m,s.length);if(x===0&&a&&a(f,A,i),e.set(b.subarray(f,f+n*i)),o(f-o(0)),x!==0)throw new Error("Malformed buffer data: ".concat(x))}const mw="EXT_meshopt_compression",mX=mw;async function yX(r,t){var e;const n=new aa(r);if(!(t!=null&&(e=t.gltf)!==null&&e!==void 0&&e.decompressMeshes))return;const i=[];for(const s of r.json.bufferViews||[])i.push(_X(n,s));await Promise.all(i),n.removeExtension(mw)}async function _X(r,t){const e=r.getObjectExtension(t,mw);if(e){const{byteOffset:n=0,byteLength:i=0,byteStride:s,count:a,mode:o,filter:A="NONE",buffer:f}=e,m=r.gltf.buffers[f],b=new Uint8Array(m.arrayBuffer,m.byteOffset+n,i),x=new Uint8Array(r.gltf.buffers[t.buffer].arrayBuffer,t.byteOffset,t.byteLength);return await hX(x,a,s,b,o,A),x}return null}const vX=Object.freeze(Object.defineProperty({__proto__:null,decode:yX,name:mX},Symbol.toStringTag,{value:"Module"})),af="EXT_texture_webp",bX=af;function wX(r,t){const e=new aa(r);if(!EQ("image/webp")){if(e.getRequiredExtensions().includes(af))throw new Error("gltf: Required extension ".concat(af," not supported by browser"));return}const{json:n}=e;for(const i of n.textures||[]){const s=e.getObjectExtension(i,af);s&&(i.source=s.source),e.removeObjectExtension(i,af)}e.removeExtension(af)}const xX=Object.freeze(Object.defineProperty({__proto__:null,name:bX,preprocess:wX},Symbol.toStringTag,{value:"Module"})),q0="KHR_texture_basisu",BX=q0;function CX(r,t){const e=new aa(r),{json:n}=e;for(const i of n.textures||[]){const s=e.getObjectExtension(i,q0);s&&(i.source=s.source),e.removeObjectExtension(i,q0)}e.removeExtension(q0)}const EX=Object.freeze(Object.defineProperty({__proto__:null,name:BX,preprocess:CX},Symbol.toStringTag,{value:"Module"})),SX={name:"Draco",id:bu?"draco":"draco-nodejs",module:"draco",shapes:["mesh"],version:"3.4.14",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};function TX(r,t,e){const n=qI(t.metadata),i=[],s=IX(t.attributes);for(const a in r){const o=r[a],A=jI(a,o,s[a]);i.push(A)}if(e){const a=jI("indices",e);i.push(a)}return new rf(i,n)}function IX(r){const t={};for(const e in r){const n=r[e];t[n.name||"undefined"]=n}return t}function jI(r,t,e){const n=e?qI(e.metadata):void 0;return p$(r,t,n)}function qI(r){const t=new Map;for(const e in r)t.set("".concat(e,".string"),JSON.stringify(r[e]));return t}const KI={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},LX={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},FX=4;class MX{constructor(t){W(this,"draco",void 0),W(this,"decoder",void 0),W(this,"metadataQuerier",void 0),this.draco=t,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=new this.draco.DecoderBuffer;n.Init(new Int8Array(t),t.byteLength),this._disableAttributeTransforms(e);const i=this.decoder.GetEncodedGeometryType(n),s=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let a;switch(i){case this.draco.TRIANGULAR_MESH:a=this.decoder.DecodeBufferToMesh(n,s);break;case this.draco.POINT_CLOUD:a=this.decoder.DecodeBufferToPointCloud(n,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!a.ok()||!s.ptr){const x="DRACO decompression failed: ".concat(a.error_msg());throw new Error(x)}const o=this._getDracoLoaderData(s,i,e),A=this._getMeshData(s,o,e),f=dI(A.attributes),m=TX(A.attributes,o,A.indices);return{loader:"draco",loaderData:o,header:{vertexCount:s.num_points(),boundingBox:f},...A,schema:m}}finally{this.draco.destroy(n),s&&this.draco.destroy(s)}}_getDracoLoaderData(t,e,n){const i=this._getTopLevelMetadata(t),s=this._getDracoAttributes(t,n);return{geometry_type:e,num_attributes:t.num_attributes(),num_points:t.num_points(),num_faces:t instanceof this.draco.Mesh?t.num_faces():0,metadata:i,attributes:s}}_getDracoAttributes(t,e){const n={};for(let i=0;i<t.num_attributes();i++){const s=this.decoder.GetAttribute(t,i),a=this._getAttributeMetadata(t,i);n[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:i,metadata:a};const o=this._getQuantizationTransform(s,e);o&&(n[s.unique_id()].quantization_transform=o);const A=this._getOctahedronTransform(s,e);A&&(n[s.unique_id()].octahedron_transform=A)}return n}_getMeshData(t,e,n){const i=this._getMeshAttributes(e,t,n);if(!i.POSITION)throw new Error("DRACO: No position attribute found.");if(t instanceof this.draco.Mesh)switch(n.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(t),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(t),size:1}}}return{topology:"point-list",mode:0,attributes:i}}_getMeshAttributes(t,e,n){const i={};for(const s of Object.values(t.attributes)){const a=this._deduceAttributeName(s,n);s.name=a;const{value:o,size:A}=this._getAttributeValues(e,s);i[a]={value:o,size:A,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return i}_getTriangleListIndices(t){const n=t.num_faces()*3,i=n*FX,s=this.draco._malloc(i);try{return this.decoder.GetTrianglesUInt32Array(t,i,s),new Uint32Array(this.draco.HEAPF32.buffer,s,n).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(t){const e=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(t,e),RX(e)}finally{this.draco.destroy(e)}}_getAttributeValues(t,e){const n=LX[e.data_type],i=e.num_components,a=t.num_points()*i,o=a*n.BYTES_PER_ELEMENT,A=PX(this.draco,n);let f;const m=this.draco._malloc(o);try{const b=this.decoder.GetAttribute(t,e.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(t,b,A,o,m),f=new n(this.draco.HEAPF32.buffer,m,a).slice()}finally{this.draco._free(m)}return{value:f,size:i}}_deduceAttributeName(t,e){const n=t.unique_id;for(const[a,o]of Object.entries(e.extraAttributes||{}))if(o===n)return a;const i=t.attribute_type;for(const a in KI)if(this.draco[a]===i)return KI[a];const s=e.attributeNameEntry||"name";return t.metadata[s]?t.metadata[s].string:"CUSTOM_ATTRIBUTE_".concat(n)}_getTopLevelMetadata(t){const e=this.decoder.GetMetadata(t);return this._getDracoMetadata(e)}_getAttributeMetadata(t,e){const n=this.decoder.GetAttributeMetadata(t,e);return this._getDracoMetadata(n)}_getDracoMetadata(t){if(!t||!t.ptr)return{};const e={},n=this.metadataQuerier.NumEntries(t);for(let i=0;i<n;i++){const s=this.metadataQuerier.GetEntryName(t,i);e[s]=this._getDracoMetadataField(t,s)}return e}_getDracoMetadataField(t,e){const n=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(t,e,n);const i=UX(n);return{int:this.metadataQuerier.GetIntEntry(t,e),string:this.metadataQuerier.GetStringEntry(t,e),double:this.metadataQuerier.GetDoubleEntry(t,e),intArray:i}}finally{this.draco.destroy(n)}}_disableAttributeTransforms(t){const{quantizedAttributes:e=[],octahedronAttributes:n=[]}=t,i=[...e,...n];for(const s of i)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(t,e){const{quantizedAttributes:n=[]}=e,i=t.attribute_type();if(n.map(a=>this.decoder[a]).includes(i)){const a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(t))return{quantization_bits:a.quantization_bits(),range:a.range(),min_values:new Float32Array([1,2,3]).map(o=>a.min_value(o))}}finally{this.draco.destroy(a)}}return null}_getOctahedronTransform(t,e){const{octahedronAttributes:n=[]}=e,i=t.attribute_type();if(n.map(a=>this.decoder[a]).includes(i)){const a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(t))return{quantization_bits:a.quantization_bits()}}finally{this.draco.destroy(a)}}return null}}function PX(r,t){switch(t){case Float32Array:return r.DT_FLOAT32;case Int8Array:return r.DT_INT8;case Int16Array:return r.DT_INT16;case Int32Array:return r.DT_INT32;case Uint8Array:return r.DT_UINT8;case Uint16Array:return r.DT_UINT16;case Uint32Array:return r.DT_UINT32;default:return r.DT_INVALID}}function UX(r){const t=r.size(),e=new Int32Array(t);for(let n=0;n<t;n++)e[n]=r.GetValue(n);return e}function RX(r){const t=r.size(),e=new Int32Array(t);for(let n=0;n<t;n++)e[n]=r.GetValue(n);return e}const yw="https://www.gstatic.com/draco/versioned/decoders/".concat("1.5.5"),OX="".concat(yw,"/draco_decoder.js"),DX="".concat(yw,"/draco_wasm_wrapper.js"),kX="".concat(yw,"/draco_decoder.wasm");let pg;async function NX(r){const t=r.modules||{};return t.draco3d?pg=pg||t.draco3d.createDecoderModule({}).then(e=>({draco:e})):pg=pg||QX(r),await pg}async function QX(r){let t,e;switch(r.draco&&r.draco.decoderType){case"js":t=await Bh(OX,"draco",r);break;case"wasm":default:[t,e]=await Promise.all([await Bh(DX,"draco",r),await Bh(kX,"draco",r)])}return t=t||globalThis.DracoDecoderModule,await HX(t,e)}function HX(r,t){const e={};return t&&(e.wasmBinary=t),new Promise(n=>{r({...e,onModuleLoaded:i=>n({draco:i})})})}const WI={...SX,parse:zX};async function zX(r,t){const{draco:e}=await NX(t),n=new MX(e);try{return n.parseSync(r,t==null?void 0:t.draco)}finally{n.destroy()}}function GX(r){const t={};for(const e in r){const n=r[e];if(e!=="indices"){const i=$I(n);t[e]=i}}return t}function $I(r){const{buffer:t,size:e,count:n}=VX(r);return{value:t,size:e,byteOffset:0,count:n,type:zI(e),componentType:GI(t)}}function VX(r){let t=r,e=1,n=0;return r&&r.value&&(t=r.value,e=r.size||1),t&&(ArrayBuffer.isView(t)||(t=jX(t,Float32Array)),n=t.length/e),{buffer:t,size:e,count:n}}function jX(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return r?Array.isArray(r)?new t(r):e&&!(r instanceof t)?new t(r):r:null}const Oh="KHR_draco_mesh_compression",qX=Oh;function KX(r,t,e){const n=new aa(r);for(const i of XI(n))n.getObjectExtension(i,Oh)}async function WX(r,t,e){var n;if(!(t!=null&&(n=t.gltf)!==null&&n!==void 0&&n.decompressMeshes))return;const i=new aa(r),s=[];for(const a of XI(i))i.getObjectExtension(a,Oh)&&s.push(XX(i,a,t,e));await Promise.all(s),i.removeExtension(Oh)}function $X(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e=new aa(r);for(const n of e.json.meshes||[])YX(n,t),e.addRequiredExtension(Oh)}async function XX(r,t,e,n){const i=r.getObjectExtension(t,Oh);if(!i)return;const s=r.getTypedArrayForBufferView(i.bufferView),a=cv(s.buffer,s.byteOffset),{parse:o}=n,A={...e};delete A["3d-tiles"];const f=await o(a,WI,A,n),m=GX(f.attributes);for(const[b,x]of Object.entries(m))if(b in t.attributes){const C=t.attributes[b],M=r.getAccessor(C);M!=null&&M.min&&M!==null&&M!==void 0&&M.max&&(x.min=M.min,x.max=M.max)}t.attributes=m,f.indices&&(t.indices=$I(f.indices)),JX(t)}function YX(r,t){var e;let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:4,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const a=i.DracoWriter.encodeSync({attributes:r}),o=s==null||(e=s.parseSync)===null||e===void 0?void 0:e.call(s,{attributes:r}),A=i._addFauxAttributes(o.attributes),f=i.addBufferView(a);return{primitives:[{attributes:A,mode:n,extensions:{[Oh]:{bufferView:f,attributes:A}}}]}}function JX(r){if(!r.attributes&&Object.keys(r.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*XI(r){for(const t of r.json.meshes||[])for(const e of t.primitives)yield e}const ZX=Object.freeze(Object.defineProperty({__proto__:null,decode:WX,encode:$X,name:qX,preprocess:KX},Symbol.toStringTag,{value:"Module"})),tY={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},eY={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},_w="KHR_texture_transform",rY=_w,K0=new le,nY=new Qi,iY=new Qi;async function sY(r,t){if(!new aa(r).getExtension(_w))return;const i=r.json.materials||[];for(let s=0;s<i.length;s++)oY(s,r)}function oY(r,t){var e,n,i;const s=[],a=(e=t.json.materials)===null||e===void 0?void 0:e[r],o=a==null||(n=a.pbrMetallicRoughness)===null||n===void 0?void 0:n.baseColorTexture;o&&gg(t,r,o,s);const A=a==null?void 0:a.emissiveTexture;A&&gg(t,r,A,s);const f=a==null?void 0:a.normalTexture;f&&gg(t,r,f,s);const m=a==null?void 0:a.occlusionTexture;m&&gg(t,r,m,s);const b=a==null||(i=a.pbrMetallicRoughness)===null||i===void 0?void 0:i.metallicRoughnessTexture;b&&gg(t,r,b,s)}function gg(r,t,e,n){const i=aY(e,n);if(!i)return;const s=r.json.meshes||[];for(const a of s)for(const o of a.primitives){const A=o.material;Number.isFinite(A)&&t===A&&cY(r,o,i)}}function aY(r,t){var e;const n=(e=r.extensions)===null||e===void 0?void 0:e[_w],{texCoord:i=0}=r,{texCoord:s=i}=n;if(!(t.findIndex(o=>{let[A,f]=o;return A===i&&f===s})!==-1)){const o=AY(n);return i!==s&&(r.texCoord=s),t.push([i,s]),{originalTexCoord:i,texCoord:s,matrix:o}}return null}function cY(r,t,e){const{originalTexCoord:n,texCoord:i,matrix:s}=e,a=t.attributes["TEXCOORD_".concat(n)];if(Number.isFinite(a)){var o;const f=(o=r.json.accessors)===null||o===void 0?void 0:o[a];if(f&&f.bufferView){var A;const m=(A=r.json.bufferViews)===null||A===void 0?void 0:A[f.bufferView];if(m){const{arrayBuffer:b,byteOffset:x}=r.buffers[m.buffer],C=(x||0)+(f.byteOffset||0)+(m.byteOffset||0),{ArrayType:M,length:U}=pw(f,m),N=eY[f.componentType],Q=tY[f.type],q=m.byteStride||N*Q,Y=new Float32Array(U);for(let tt=0;tt<f.count;tt++){const ft=new M(b,C+tt*q,2);K0.set(ft[0],ft[1],1),K0.transformByMatrix3(s),Y.set([K0[0],K0[1]],tt*Q)}n===i?lY(f,m,r.buffers,Y):uY(i,f,t,r,Y)}}}}function lY(r,t,e,n){r.componentType=5126,e.push({arrayBuffer:n.buffer,byteOffset:0,byteLength:n.buffer.byteLength}),t.buffer=e.length-1,t.byteLength=n.buffer.byteLength,t.byteOffset=0,delete t.byteStride}function uY(r,t,e,n,i){n.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});const s=n.json.bufferViews;if(!s)return;s.push({buffer:n.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});const a=n.json.accessors;a&&(a.push({bufferView:(s==null?void 0:s.length)-1,byteOffset:0,componentType:5126,count:t.count,type:"VEC2"}),e.attributes["TEXCOORD_".concat(r)]=a.length-1)}function AY(r){const{offset:t=[0,0],rotation:e=0,scale:n=[1,1]}=r,i=new Qi().set(1,0,0,0,1,0,t[0],t[1],1),s=nY.set(Math.cos(e),Math.sin(e),0,-Math.sin(e),Math.cos(e),0,0,0,1),a=iY.set(n[0],0,0,0,n[1],0,0,0,1);return i.multiplyRight(s).multiplyRight(a)}const hY=Object.freeze(Object.defineProperty({__proto__:null,decode:sY,name:rY},Symbol.toStringTag,{value:"Module"})),Dh="KHR_lights_punctual",dY=Dh;async function fY(r){const t=new aa(r),{json:e}=t,n=t.getExtension(Dh);n&&(t.json.lights=n.lights,t.removeExtension(Dh));for(const i of e.nodes||[]){const s=t.getObjectExtension(i,Dh);s&&(i.light=s.light),t.removeObjectExtension(i,Dh)}}async function pY(r){const t=new aa(r),{json:e}=t;if(e.lights){const n=t.addExtension(Dh);Ua(!n.lights),n.lights=e.lights,delete e.lights}if(t.json.lights){for(const n of t.json.lights){const i=n.node;t.addObjectExtension(i,Dh,n)}delete t.json.lights}}const gY=Object.freeze(Object.defineProperty({__proto__:null,decode:fY,encode:pY,name:dY},Symbol.toStringTag,{value:"Module"})),mg="KHR_materials_unlit",mY=mg;async function yY(r){const t=new aa(r),{json:e}=t;for(const n of e.materials||[])n.extensions&&n.extensions.KHR_materials_unlit&&(n.unlit=!0),t.removeObjectExtension(n,mg);t.removeExtension(mg)}function _Y(r){const t=new aa(r),{json:e}=t;if(t.materials)for(const n of e.materials||[])n.unlit&&(delete n.unlit,t.addObjectExtension(n,mg,{}),t.addExtension(mg))}const vY=Object.freeze(Object.defineProperty({__proto__:null,decode:yY,encode:_Y,name:mY},Symbol.toStringTag,{value:"Module"})),yg="KHR_techniques_webgl",bY=yg;async function wY(r){const t=new aa(r),{json:e}=t,n=t.getExtension(yg);if(n){const i=BY(n,t);for(const s of e.materials||[]){const a=t.getObjectExtension(s,yg);a&&(s.technique=Object.assign({},a,i[a.technique]),s.technique.values=CY(s.technique,t)),t.removeObjectExtension(s,yg)}t.removeExtension(yg)}}async function xY(r,t){}function BY(r,t){const{programs:e=[],shaders:n=[],techniques:i=[]}=r,s=new TextDecoder;return n.forEach(a=>{if(Number.isFinite(a.bufferView))a.code=s.decode(t.getTypedArrayForBufferView(a.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),e.forEach(a=>{a.fragmentShader=n[a.fragmentShader],a.vertexShader=n[a.vertexShader]}),i.forEach(a=>{a.program=e[a.program]}),i}function CY(r,t){const e=Object.assign({},r.values);return Object.keys(r.uniforms||{}).forEach(n=>{r.uniforms[n].value&&!(n in e)&&(e[n]=r.uniforms[n].value)}),Object.keys(e).forEach(n=>{typeof e[n]=="object"&&e[n].index!==void 0&&(e[n].texture=t.getTexture(e[n].index))}),e}const EY=Object.freeze(Object.defineProperty({__proto__:null,decode:wY,encode:xY,name:bY},Symbol.toStringTag,{value:"Module"})),YI="EXT_feature_metadata",SY=YI;async function TY(r){const t=new aa(r);IY(t)}function IY(r){var t;const e=r.getExtension(YI),n=e==null||(t=e.schema)===null||t===void 0?void 0:t.classes,i=e==null?void 0:e.featureTables;if((e==null?void 0:e.featureTextures)&&console.warn('featureTextures is not yet supported in the "EXT_feature_metadata" extension.'),n&&i)for(const a in n){const o=n[a],A=MY(i,a);A&&LY(r,A,o)}}function LY(r,t,e){for(const i in e.properties){var n;const s=e.properties[i],a=t==null||(n=t.properties)===null||n===void 0?void 0:n[i],o=t.count;if(a){const A=FY(r,s,o,a);a.data=A}}}function FY(r,t,e,n){const i=n.bufferView;let s=r.getTypedArrayForBufferView(i);switch(t.type){case"STRING":{const a=n.stringOffsetBufferView,o=r.getTypedArrayForBufferView(a);s=PY(s,o,e);break}}return s}function MY(r,t){for(const e in r){const n=r[e];if(n.class===t)return n}return null}function PY(r,t,e){const n=[],i=new TextDecoder("utf8");let s=0;const a=4;for(let o=0;o<e;o++){const A=t[(o+1)*a]-t[o*a],f=r.subarray(s,A+s),m=i.decode(f);n.push(m),s+=A}return n}const JI=[vX,xX,EX,ZX,gY,vY,EY,hY,Object.freeze(Object.defineProperty({__proto__:null,decode:TY,name:SY},Symbol.toStringTag,{value:"Module"}))];function UY(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0;const n=JI.filter(s=>ZI(s.name,t));for(const s of n){var i;(i=s.preprocess)===null||i===void 0||i.call(s,r,t,e)}}async function RY(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0;const n=JI.filter(s=>ZI(s.name,t));for(const s of n){var i;await((i=s.decode)===null||i===void 0?void 0:i.call(s,r,t,e))}}function ZI(r,t){var e;const n=(t==null||(e=t.gltf)===null||e===void 0?void 0:e.excludeExtensions)||{};return!(r in n&&!n[r])}const vw="KHR_binary_glTF";function OY(r){const t=new aa(r),{json:e}=t;for(const n of e.images||[]){const i=t.getObjectExtension(n,vw);i&&Object.assign(n,i),t.removeObjectExtension(n,vw)}e.buffers&&e.buffers[0]&&delete e.buffers[0].uri,t.removeExtension(vw)}const tL={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},DY={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class kY{constructor(){W(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),W(this,"json",void 0)}normalize(t,e){this.json=t.json;const n=t.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn("glTF: Unknown version ".concat(n.asset.version));return}if(!e.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),OY(t),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)}_addAsset(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(t){for(const e in tL)this._convertTopLevelObjectToArray(t,e)}_convertTopLevelObjectToArray(t,e){const n=t[e];if(!(!n||Array.isArray(n))){t[e]=[];for(const i in n){const s=n[i];s.id=s.id||i;const a=t[e].length;t[e].push(s),this.idToIndexMap[e][i]=a}}}_convertObjectIdsToArrayIndices(t){for(const e in tL)this._convertIdsToIndices(t,e);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));for(const e of t.textures)this._convertTextureIds(e);for(const e of t.meshes)this._convertMeshIds(e);for(const e of t.nodes)this._convertNodeIds(e);for(const e of t.scenes)this._convertSceneIds(e)}_convertTextureIds(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}_convertMeshIds(t){for(const e of t.primitives){const{attributes:n,indices:i,material:s}=e;for(const a in n)n[a]=this._convertIdToIndex(n[a],"accessor");i&&(e.indices=this._convertIdToIndex(i,"accessor")),s&&(e.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(t){t.children&&(t.children=t.children.map(e=>this._convertIdToIndex(e,"node"))),t.meshes&&(t.meshes=t.meshes.map(e=>this._convertIdToIndex(e,"mesh")))}_convertSceneIds(t){t.nodes&&(t.nodes=t.nodes.map(e=>this._convertIdToIndex(e,"node")))}_convertIdsToIndices(t,e){t[e]||(console.warn("gltf v1: json doesn't contain attribute ".concat(e)),t[e]=[]);for(const n of t[e])for(const i in n){const s=n[i],a=this._convertIdToIndex(s,i);n[i]=a}}_convertIdToIndex(t,e){const n=DY[e];if(n in this.idToIndexMap){const i=this.idToIndexMap[n][t];if(!Number.isFinite(i))throw new Error("gltf v1: failed to resolve ".concat(e," with id ").concat(t));return i}return t}_updateObjects(t){for(const e of this.json.buffers)delete e.type}_updateMaterial(t){for(const s of t.materials){var e,n,i;s.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const a=((e=s.values)===null||e===void 0?void 0:e.tex)||((n=s.values)===null||n===void 0?void 0:n.texture2d_0)||((i=s.values)===null||i===void 0?void 0:i.diffuseTex),o=t.textures.findIndex(A=>A.id===a);o!==-1&&(s.pbrMetallicRoughness.baseColorTexture={index:o})}}}function NY(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new kY().normalize(r,t)}const QY={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},HY={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},nc={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},zY={magFilter:nc.TEXTURE_MAG_FILTER,minFilter:nc.TEXTURE_MIN_FILTER,wrapS:nc.TEXTURE_WRAP_S,wrapT:nc.TEXTURE_WRAP_T},GY={[nc.TEXTURE_MAG_FILTER]:nc.LINEAR,[nc.TEXTURE_MIN_FILTER]:nc.NEAREST_MIPMAP_LINEAR,[nc.TEXTURE_WRAP_S]:nc.REPEAT,[nc.TEXTURE_WRAP_T]:nc.REPEAT};function VY(r){return HY[r]}function jY(r){return QY[r]}class qY{constructor(){W(this,"baseUri",""),W(this,"json",{}),W(this,"buffers",[]),W(this,"images",[])}postProcess(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{json:n,buffers:i=[],images:s=[],baseUri:a=""}=t;return Ua(n),this.baseUri=a,this.json=n,this.buffers=i,this.images=s,this._resolveTree(this.json,e),this.json}_resolveTree(t){t.bufferViews&&(t.bufferViews=t.bufferViews.map((e,n)=>this._resolveBufferView(e,n))),t.images&&(t.images=t.images.map((e,n)=>this._resolveImage(e,n))),t.samplers&&(t.samplers=t.samplers.map((e,n)=>this._resolveSampler(e,n))),t.textures&&(t.textures=t.textures.map((e,n)=>this._resolveTexture(e,n))),t.accessors&&(t.accessors=t.accessors.map((e,n)=>this._resolveAccessor(e,n))),t.materials&&(t.materials=t.materials.map((e,n)=>this._resolveMaterial(e,n))),t.meshes&&(t.meshes=t.meshes.map((e,n)=>this._resolveMesh(e,n))),t.nodes&&(t.nodes=t.nodes.map((e,n)=>this._resolveNode(e,n))),t.skins&&(t.skins=t.skins.map((e,n)=>this._resolveSkin(e,n))),t.scenes&&(t.scenes=t.scenes.map((e,n)=>this._resolveScene(e,n))),t.scene!==void 0&&(t.scene=t.scenes[this.json.scene])}getScene(t){return this._get("scenes",t)}getNode(t){return this._get("nodes",t)}getSkin(t){return this._get("skins",t)}getMesh(t){return this._get("meshes",t)}getMaterial(t){return this._get("materials",t)}getAccessor(t){return this._get("accessors",t)}getCamera(t){return null}getTexture(t){return this._get("textures",t)}getSampler(t){return this._get("samplers",t)}getImage(t){return this._get("images",t)}getBufferView(t){return this._get("bufferViews",t)}getBuffer(t){return this._get("buffers",t)}_get(t,e){if(typeof e=="object")return e;const n=this.json[t]&&this.json[t][e];return n||console.warn("glTF file error: Could not find ".concat(t,"[").concat(e,"]")),n}_resolveScene(t,e){return t.id=t.id||"scene-".concat(e),t.nodes=(t.nodes||[]).map(n=>this.getNode(n)),t}_resolveNode(t,e){return t.id=t.id||"node-".concat(e),t.children&&(t.children=t.children.map(n=>this.getNode(n))),t.mesh!==void 0?t.mesh=this.getMesh(t.mesh):t.meshes!==void 0&&t.meshes.length&&(t.mesh=t.meshes.reduce((n,i)=>{const s=this.getMesh(i);return n.id=s.id,n.primitives=n.primitives.concat(s.primitives),n},{primitives:[]})),t.camera!==void 0&&(t.camera=this.getCamera(t.camera)),t.skin!==void 0&&(t.skin=this.getSkin(t.skin)),t}_resolveSkin(t,e){return t.id=t.id||"skin-".concat(e),t.inverseBindMatrices=this.getAccessor(t.inverseBindMatrices),t}_resolveMesh(t,e){return t.id=t.id||"mesh-".concat(e),t.primitives&&(t.primitives=t.primitives.map(n=>{n={...n};const i=n.attributes;n.attributes={};for(const s in i)n.attributes[s]=this.getAccessor(i[s]);return n.indices!==void 0&&(n.indices=this.getAccessor(n.indices)),n.material!==void 0&&(n.material=this.getMaterial(n.material)),n})),t}_resolveMaterial(t,e){if(t.id=t.id||"material-".concat(e),t.normalTexture&&(t.normalTexture={...t.normalTexture},t.normalTexture.texture=this.getTexture(t.normalTexture.index)),t.occlusionTexture&&(t.occlustionTexture={...t.occlustionTexture},t.occlusionTexture.texture=this.getTexture(t.occlusionTexture.index)),t.emissiveTexture&&(t.emmisiveTexture={...t.emmisiveTexture},t.emissiveTexture.texture=this.getTexture(t.emissiveTexture.index)),t.emissiveFactor||(t.emissiveFactor=t.emmisiveTexture?[1,1,1]:[0,0,0]),t.pbrMetallicRoughness){t.pbrMetallicRoughness={...t.pbrMetallicRoughness};const n=t.pbrMetallicRoughness;n.baseColorTexture&&(n.baseColorTexture={...n.baseColorTexture},n.baseColorTexture.texture=this.getTexture(n.baseColorTexture.index)),n.metallicRoughnessTexture&&(n.metallicRoughnessTexture={...n.metallicRoughnessTexture},n.metallicRoughnessTexture.texture=this.getTexture(n.metallicRoughnessTexture.index))}return t}_resolveAccessor(t,e){if(t.id=t.id||"accessor-".concat(e),t.bufferView!==void 0&&(t.bufferView=this.getBufferView(t.bufferView)),t.bytesPerComponent=VY(t.componentType),t.components=jY(t.type),t.bytesPerElement=t.bytesPerComponent*t.components,t.bufferView){const n=t.bufferView.buffer,{ArrayType:i,byteLength:s}=pw(t,t.bufferView),a=(t.bufferView.byteOffset||0)+(t.byteOffset||0)+n.byteOffset;let o=n.arrayBuffer.slice(a,a+s);t.bufferView.byteStride&&(o=this._getValueFromInterleavedBuffer(n,a,t.bufferView.byteStride,t.bytesPerElement,t.count)),t.value=new i(o)}return t}_getValueFromInterleavedBuffer(t,e,n,i,s){const a=new Uint8Array(s*i);for(let o=0;o<s;o++){const A=e+o*n;a.set(new Uint8Array(t.arrayBuffer.slice(A,A+i)),o*i)}return a.buffer}_resolveTexture(t,e){return t.id=t.id||"texture-".concat(e),t.sampler="sampler"in t?this.getSampler(t.sampler):GY,t.source=this.getImage(t.source),t}_resolveSampler(t,e){t.id=t.id||"sampler-".concat(e),t.parameters={};for(const n in t){const i=this._enumSamplerParameter(n);i!==void 0&&(t.parameters[i]=t[n])}return t}_enumSamplerParameter(t){return zY[t]}_resolveImage(t,e){t.id=t.id||"image-".concat(e),t.bufferView!==void 0&&(t.bufferView=this.getBufferView(t.bufferView));const n=this.images[e];return n&&(t.image=n),t}_resolveBufferView(t,e){const n=t.buffer,i={id:"bufferView-".concat(e),...t,buffer:this.buffers[n]},s=this.buffers[n].arrayBuffer;let a=this.buffers[n].byteOffset||0;return"byteOffset"in t&&(a+=t.byteOffset),i.data=new Uint8Array(s,a,t.byteLength),i}_resolveCamera(t,e){return t.id=t.id||"camera-".concat(e),t.perspective,t.orthographic,t}}function KY(r,t){return new qY().postProcess(r,t)}const eL=1735152710,bw=12,W0=8,WY=1313821514,$Y=5130562,XY=0,YY=1,JY=0,cf=!0;function ZY(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return"".concat(String.fromCharCode(r.getUint8(t+0))).concat(String.fromCharCode(r.getUint8(t+1))).concat(String.fromCharCode(r.getUint8(t+2))).concat(String.fromCharCode(r.getUint8(t+3)))}function tJ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=new DataView(r),{magic:i=eL}=e,s=n.getUint32(t,!1);return s===i||s===eL}function eJ(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const n=new DataView(t),i=ZY(n,e+0),s=n.getUint32(e+4,cf),a=n.getUint32(e+8,cf);switch(Object.assign(r,{header:{byteOffset:e,byteLength:a,hasBinChunk:!1},type:i,version:s,json:{},binChunks:[]}),e+=bw,r.version){case 1:return rJ(r,n,e);case 2:return nJ(r,n,e,{});default:throw new Error("Invalid GLB version ".concat(r.version,". Only supports v1 and v2."))}}function rJ(r,t,e){ai(r.header.byteLength>bw+W0);const n=t.getUint32(e+0,cf),i=t.getUint32(e+4,cf);return e+=W0,ai(i===JY),ww(r,t,e,n),e+=n,e+=xw(r,t,e,r.header.byteLength),e}function nJ(r,t,e,n){return ai(r.header.byteLength>bw+W0),iJ(r,t,e,n),e+r.header.byteLength}function iJ(r,t,e,n){for(;e+8<=r.header.byteLength;){const i=t.getUint32(e+0,cf),s=t.getUint32(e+4,cf);switch(e+=W0,s){case WY:ww(r,t,e,i);break;case $Y:xw(r,t,e,i);break;case XY:n.strict||ww(r,t,e,i);break;case YY:n.strict||xw(r,t,e,i);break}e+=Fp(i,4)}return e}function ww(r,t,e,n){const i=new Uint8Array(t.buffer,e,n),a=new TextDecoder("utf8").decode(i);return r.json=JSON.parse(a),Fp(n,4)}function xw(r,t,e,n){return r.header.hasBinChunk=!0,r.binChunks.push({byteOffset:e,byteLength:n,arrayBuffer:t.buffer}),Fp(n,4)}async function sJ(r,t){var e,n,i,s;let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3?arguments[3]:void 0,A=arguments.length>4?arguments[4]:void 0;oJ(r,t,a,o),NY(r,{normalize:o==null||(e=o.gltf)===null||e===void 0?void 0:e.normalize}),UY(r,o,A);const f=[];if(o!=null&&(n=o.gltf)!==null&&n!==void 0&&n.loadBuffers&&r.json.buffers&&await aJ(r,o,A),o!=null&&(i=o.gltf)!==null&&i!==void 0&&i.loadImages){const b=cJ(r,o,A);f.push(b)}const m=RY(r,o,A);return f.push(m),await Promise.all(f),o!=null&&(s=o.gltf)!==null&&s!==void 0&&s.postProcess?KY(r,o):r}function oJ(r,t,e,n){if(n.uri&&(r.baseUri=n.uri),t instanceof ArrayBuffer&&!tJ(t,e,n)&&(t=new TextDecoder().decode(t)),typeof t=="string")r.json=SN(t);else if(t instanceof ArrayBuffer){const a={};e=eJ(a,t,e,n.glb),Ua(a.type==="glTF","Invalid GLB magic string ".concat(a.type)),r._glb=a,r.json=a.json}else Ua(!1,"GLTF: must be ArrayBuffer or string");const i=r.json.buffers||[];if(r.buffers=new Array(i.length).fill(null),r._glb&&r._glb.header.hasBinChunk){const{binChunks:a}=r._glb;r.buffers[0]={arrayBuffer:a[0].arrayBuffer,byteOffset:a[0].byteOffset,byteLength:a[0].byteLength}}const s=r.json.images||[];r.images=new Array(s.length).fill({})}async function aJ(r,t,e){const n=r.json.buffers||[];for(let a=0;a<n.length;++a){const o=n[a];if(o.uri){var i,s;const{fetch:A}=e;Ua(A);const f=QI(o.uri,t),m=await(e==null||(i=e.fetch)===null||i===void 0?void 0:i.call(e,f)),b=await(m==null||(s=m.arrayBuffer)===null||s===void 0?void 0:s.call(m));r.buffers[a]={arrayBuffer:b,byteOffset:0,byteLength:b.byteLength},delete o.uri}else r.buffers[a]===null&&(r.buffers[a]={arrayBuffer:new ArrayBuffer(o.byteLength),byteOffset:0,byteLength:o.byteLength})}}async function cJ(r,t,e){const n=lJ(r),i=r.json.images||[],s=[];for(const a of n)s.push(uJ(r,i[a],a,t,e));return await Promise.all(s)}function lJ(r){const t=new Set,e=r.json.textures||[];for(const n of e)n.source!==void 0&&t.add(n.source);return Array.from(t).sort()}async function uJ(r,t,e,n,i){const{fetch:s,parse:a}=i;let o;if(t.uri&&!t.hasOwnProperty("bufferView")){const f=QI(t.uri,n);o=await(await s(f)).arrayBuffer(),t.bufferView={data:o}}if(Number.isFinite(t.bufferView)){const f=Z$(r.json,r.buffers,t.bufferView);o=cv(f.buffer,f.byteOffset,f.byteLength)}Ua(o,"glTF image has no data");let A=await a(o,[HS,J$],{mimeType:t.mimeType,basis:n.basis||{format:NI()}},i);A&&A[0]&&(A={compressed:!0,mipmaps:!1,width:A[0].width,height:A[0].height,data:A[0]}),r.images=r.images||[],r.images[e]=A}const _g={name:"glTF",id:"gltf",module:"gltf",version:O$,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:AJ,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};async function AJ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0;t={..._g.options,...t},t.gltf={..._g.options.gltf,...t.gltf};const{byteOffset:n=0}=t;return await sJ({},r,n,t,e)}async function hJ(r){const t=[];return r.scenes.forEach(e=>{e.traverse(n=>{Object.values(n.model.getUniforms()).forEach(i=>{i.loaded===!1&&t.push(i)})})}),await dJ(()=>t.some(e=>!e.loaded))}async function dJ(r){for(;r();)await new Promise(t=>requestAnimationFrame(t))}const fJ=`#version 300 es
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform mat4 sceneModelMatrix;
uniform bool composeModelMatrix;
in vec4 POSITION;

#ifdef HAS_UV
  in vec2 TEXCOORD_0;
#endif

#ifdef MODULE_PBR
  #ifdef HAS_NORMALS
    in vec4 NORMAL;
  #endif
#endif
out vec4 vColor;
#ifndef MODULE_PBR
  #ifdef HAS_UV
    out vec2 vTEXCOORD_0;
  #endif
#endif
void main(void) {
  #if defined(HAS_UV) && !defined(MODULE_PBR)
    vTEXCOORD_0 = TEXCOORD_0;
    geometry.uv = vTEXCOORD_0;
  #endif

  geometry.worldPosition = instancePositions;
  geometry.pickingColor = instancePickingColors;

  vec3 normal = vec3(0.0, 0.0, 1.0);
  #ifdef MODULE_PBR
    #ifdef HAS_NORMALS
      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;
    #endif
  #endif

  float originalSize = project_size_to_pixel(sizeScale);
  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);

  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;
  if(composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    geometry.normal = project_normal(normal);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);
    geometry.normal = project_normal(normal);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = TEXCOORD_0;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,pJ=`#version 300 es
uniform float opacity;
in vec4 vColor;

out vec4 fragmentColor;
#ifndef MODULE_PBR
  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
    in vec2 vTEXCOORD_0;
    uniform sampler2D u_BaseColorSampler;
  #endif
#endif

void main(void) {
  #ifdef MODULE_PBR
    fragmentColor = vColor * pbr_filterColor(vec4(0));
    geometry.uv = pbr_vUV;
  #else
    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);
      geometry.uv = vTEXCOORD_0;
    #else
      fragmentColor = vColor;
    #endif
  #endif

  fragmentColor.a *= opacity;
  DECKGL_FILTER_COLOR(fragmentColor, geometry);
}
`,rL=[255,255,255,255],gJ={scenegraph:{type:"object",value:null,async:!0},getScene:r=>r&&r.scenes?typeof r.scene=="object"?r.scene:r.scenes[r.scene||0]:r,getAnimator:r=>r&&r.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:r=>r.position},getColor:{type:"accessor",value:rL},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[_g]};class Bw extends ef{constructor(){super(...arguments),W(this,"state",void 0)}getShaders(){const t=[Rb,Ob];return this.props._lighting==="pbr"&&t.push(bb),super.getShaders({vs:fJ,fs:pJ,modules:t})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:rL,transition:!0},instanceModelMatrix:AI})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;e.scenegraph!==n.scenegraph?this._updateScenegraph():e._animations!==n._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,e._animations)}finalizeState(t){super.finalizeState(t),this._deleteScenegraph()}get isLoaded(){var t;return((t=this.state)===null||t===void 0?void 0:t.scenegraph)&&super.isLoaded}_updateScenegraph(){const t=this.props,{gl:e}=this.context;let n=null;if(t.scenegraph instanceof sf)n={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const o=t.scenegraph,A=R$(e,o,this._getModelOptions());n={gltf:o,...A},hJ(A).then(()=>this.setNeedsRedraw())}else t.scenegraph&&(Fn.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),n=t.scenegraph);const i={layer:this,gl:e},s=t.getScene(n,i),a=t.getAnimator(n,i);s instanceof sf?(this._deleteScenegraph(),this._applyAllAttributes(s),this._applyAnimationsProp(s,a,t._animations),this.setState({scenegraph:s,animator:a})):s!==null&&Fn.warn("invalid scenegraph:",s)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const e=this.getAttributeManager().getAttributes();t.traverse(n=>{this._setModelAttributes(n.model,e)})}}_applyAnimationsProp(t,e,n){if(!t||!e||!n)return;const i=e.getAnimations();Object.keys(n).sort().forEach(s=>{const a=n[s];if(s==="*")i.forEach(o=>{Object.assign(o,a)});else if(Number.isFinite(Number(s))){const o=Number(s);o>=0&&o<i.length?Object.assign(i[o],a):Fn.warn("animation ".concat(s," not found"))()}else{const o=i.find(A=>{let{name:f}=A;return f===s});o?Object.assign(o,a):Fn.warn("animation ".concat(s," not found"))()}})}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof sf&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let e=null;return t&&(typeof t=="function"?e=t({gl:this.context.gl,layer:this}):e=t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:e,modelOptions:{isInstanced:!0,transpileToGLSL100:!pn(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(e=>{this._setModelAttributes(e.model,t)})}draw(t){let{moduleParameters:e=null,parameters:n={},context:i}=t;if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(i.timeline.getTime()),this.setNeedsRedraw());const{viewport:s}=this.context,{sizeScale:a,sizeMinPixels:o,sizeMaxPixels:A,opacity:f,coordinateSystem:m}=this.props,b=this.getNumInstances();this.state.scenegraph.traverse((x,C)=>{let{worldMatrix:M}=C;x.model.setInstanceCount(b),x.updateModuleSettings(e),x.draw({parameters:n,uniforms:{sizeScale:a,opacity:f,sizeMinPixels:o,sizeMaxPixels:A,composeModelMatrix:hI(s,m),sceneModelMatrix:M,u_Camera:x.model.getUniforms().project_uCameraPosition}})})}}W(Bw,"defaultProps",gJ),W(Bw,"layerName","ScenegraphLayer");const mJ=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
uniform bool pickFeatureIds;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec4 uvRegions;
in vec3 featureIdsPickingColors;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

vec2 applyUVRegion(vec2 uv) {
  #ifdef HAS_UV_REGIONS
    return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;
  #else
    return uv;
  #endif
}

void main(void) {
  vec2 uv = applyUVRegion(texCoords);
  geometry.uv = uv;

  if (pickFeatureIds) {
    geometry.pickingColor = featureIdsPickingColors;
  } else {
    geometry.pickingColor = instancePickingColors;
  }

  vTexCoord = uv;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale;
  vec3 projectedPosition = project_position(positions);
  position_commonspace = vec4(projectedPosition, 1.0);
  gl_Position = project_common_position_to_clipspace(position_commonspace);

  geometry.position = position_commonspace;
  normals_commonspace = project_normal(instanceModelMatrix * normals);
  geometry.normal = normals_commonspace;

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = uv;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,yJ=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  
#ifdef MODULE_PBR

  fragColor = vColor * pbr_filterColor(vec4(0));
  geometry.uv = pbr_vUV;
  fragColor.a *= opacity;

#else

  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);

#endif

  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function _J(r){r.COLOR_0||r.colors||(r.colors={constant:!0,value:new Float32Array([1,1,1])})}const vJ={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}};class Cw extends uw{getShaders(){const t=super.getShaders();return t.modules.push(bb),{...t,vs:mJ,fs:yJ}}initializeState(){const{featureIds:t}=this.props;super.initializeState();const e=this.getAttributeManager();t&&e.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;e.pbrMaterial!==n.pbrMaterial&&this.updatePbrMaterialUniforms(e.pbrMaterial)}draw(t){const{featureIds:e}=this.props;this.state.model&&(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,pickFeatureIds:!!e}),super.draw(t))}getModel(t){const{id:e,pbrMaterial:n}=this.props,i=this.parseMaterial(n,t);this.setState({materialParser:i});const s=this.getShaders();return _J(t.attributes),new jd(this.context.gl,{...this.getShaders(),id:e,geometry:t,defines:{...s.defines,...i==null?void 0:i.defines,HAS_UV_REGIONS:t.attributes.uvRegions},parameters:i==null?void 0:i.parameters,isInstanced:!0})}updatePbrMaterialUniforms(t){const{model:e}=this.state;if(e){const{mesh:n}=this.props,i=this.parseMaterial(t,n);this.setState({materialParser:i}),e.setUniforms(i.uniforms)}}parseMaterial(t,e){var n;const i=!!(t.pbrMetallicRoughness&&t.pbrMetallicRoughness.baseColorTexture);return(n=this.state.materialParser)===null||n===void 0||n.delete(),new xI(this.context.gl,{attributes:{NORMAL:e.attributes.normals,TEXCOORD_0:e.attributes.texCoords},material:{unlit:i,...t},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(t){const e=this.props.featureIds,n=new Uint8ClampedArray(e.length*t.size),i=[];for(let s=0;s<e.length;s++)this.encodePickingColor(e[s],i),n[s*3]=i[0],n[s*3+1]=i[1],n[s*3+2]=i[2];t.value=n}finalizeState(t){var e;super.finalizeState(t),(e=this.state.materialParser)===null||e===void 0||e.delete(),this.setState({materialParser:null})}}W(Cw,"layerName","MeshLayer"),W(Cw,"defaultProps",vJ);const bJ=6378137,wJ=6378137,xJ=6356752314245179e-9;function $0(r){return r}new le;function BJ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$0;return"longitude"in r?(t[0]=e(r.longitude),t[1]=e(r.latitude),t[2]=r.height):"x"in r?(t[0]=e(r.x),t[1]=e(r.y),t[2]=r.z):(t[0]=e(r[0]),t[1]=e(r[1]),t[2]=r[2]),t}function CJ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return BJ(r,t,ws._cartographicRadians?$0:O9)}function EJ(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$0;return"longitude"in t?(t.longitude=e(r[0]),t.latitude=e(r[1]),t.height=r[2]):"x"in t?(t.x=e(r[0]),t.y=e(r[1]),t.z=r[2]):(t[0]=e(r[0]),t[1]=e(r[1]),t[2]=r[2]),t}function SJ(r,t){return EJ(r,t,ws._cartographicRadians?$0:D9)}const lf=new le,TJ=new le,IJ=new le;function LJ(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const{oneOverRadii:n,oneOverRadiiSquared:i,centerToleranceSquared:s}=t;lf.from(r);const a=lf.x,o=lf.y,A=lf.z,f=n.x,m=n.y,b=n.z,x=a*a*f*f,C=o*o*m*m,M=A*A*b*b,U=x+C+M,N=Math.sqrt(1/U);if(!Number.isFinite(N))return;const Q=TJ;if(Q.copy(r).scale(N),U<s)return Q.to(e);const q=i.x,Y=i.y,tt=i.z,ft=IJ;ft.set(Q.x*q*2,Q.y*Y*2,Q.z*tt*2);let pt=(1-N)*lf.len()/(.5*ft.len()),mt=0,dt,Rt,Lt,st;do{pt-=mt,dt=1/(1+pt*q),Rt=1/(1+pt*Y),Lt=1/(1+pt*tt);const ct=dt*dt,wt=Rt*Rt,yt=Lt*Lt,te=ct*dt,Zt=wt*Rt,re=yt*Lt;st=x*ct+C*wt+M*yt-1;const ne=-2*(x*te*q+C*Zt*Y+M*re*tt);mt=st/ne}while(Math.abs(st)>tg.EPSILON12);return lf.scale([dt,Rt,Lt]).to(e)}const nL=1e-14,FJ=new le,iL={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Ew={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},vg={east:new le,north:new le,up:new le,west:new le,south:new le,down:new le},MJ=new le,PJ=new le,UJ=new le;function sL(r,t,e,n,i,s){const a=iL[t]&&iL[t][e];Dc(a&&(!n||n===a));let o,A,f;const m=FJ.copy(i);if(kc(m.x,0,nL)&&kc(m.y,0,nL)){const x=Math.sign(m.z);o=MJ.fromArray(Ew[t]),t!=="east"&&t!=="west"&&o.scale(x),A=PJ.fromArray(Ew[e]),e!=="east"&&e!=="west"&&A.scale(x),f=UJ.fromArray(Ew[n]),n!=="east"&&n!=="west"&&f.scale(x)}else{const{up:x,east:C,north:M}=vg;C.set(-m.y,m.x,0).normalize(),r.geodeticSurfaceNormal(m,x),M.copy(x).cross(C);const{down:U,west:N,south:Q}=vg;U.copy(x).scale(-1),N.copy(C).scale(-1),Q.copy(M).scale(-1),o=vg[t],A=vg[e],f=vg[n]}return s[0]=o.x,s[1]=o.y,s[2]=o.z,s[3]=0,s[4]=A.x,s[5]=A.y,s[6]=A.z,s[7]=0,s[8]=f.x,s[9]=f.y,s[10]=f.z,s[11]=0,s[12]=m.x,s[13]=m.y,s[14]=m.z,s[15]=1,s}const X0=new le,oL=new le,RJ=new le,zc=new le,OJ=new le,Y0=new le;class Li{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;W(this,"radii",void 0),W(this,"radiiSquared",void 0),W(this,"radiiToTheFourth",void 0),W(this,"oneOverRadii",void 0),W(this,"oneOverRadiiSquared",void 0),W(this,"minimumRadius",void 0),W(this,"maximumRadius",void 0),W(this,"centerToleranceSquared",tg.EPSILON1),W(this,"squaredXOverSquaredZ",void 0),Dc(t>=0),Dc(e>=0),Dc(n>=0),this.radii=new le(t,e,n),this.radiiSquared=new le(t*t,e*e,n*n),this.radiiToTheFourth=new le(t*t*t*t,e*e*e*e,n*n*n*n),this.oneOverRadii=new le(t===0?0:1/t,e===0?0:1/e,n===0?0:1/n),this.oneOverRadiiSquared=new le(t===0?0:1/(t*t),e===0?0:1/(e*e),n===0?0:1/(n*n)),this.minimumRadius=Math.min(t,e,n),this.maximumRadius=Math.max(t,e,n),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(t){return this===t||!!(t&&this.radii.equals(t.radii))}toString(){return this.radii.toString()}cartographicToCartesian(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const n=oL,i=RJ,[,,s]=t;this.geodeticSurfaceNormalCartographic(t,n),i.copy(this.radiiSquared).scale(n);const a=Math.sqrt(n.dot(i));return i.scale(1/a),n.scale(s),i.add(n),i.to(e)}cartesianToCartographic(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];Y0.from(t);const n=this.scaleToGeodeticSurface(Y0,zc);if(!n)return;const i=this.geodeticSurfaceNormal(n,oL),s=OJ;s.copy(Y0).subtract(n);const a=Math.atan2(i.y,i.x),o=Math.asin(i.z),A=Math.sign(lb(s,Y0))*yT(s);return SJ([a,o,A],e)}eastNorthUpToFixedFrame(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new xn;return sL(this,"east","north","up",t,e)}localFrameToFixedFrame(t,e,n,i){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:new xn;return sL(this,t,e,n,i,s)}geocentricSurfaceNormal(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return X0.from(t).normalize().to(e)}geodeticSurfaceNormalCartographic(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const n=CJ(t),i=n[0],s=n[1],a=Math.cos(s);return X0.set(a*Math.cos(i),a*Math.sin(i),Math.sin(s)).normalize(),X0.to(e)}geodeticSurfaceNormal(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return X0.from(t).scale(this.oneOverRadiiSquared).normalize().to(e)}scaleToGeodeticSurface(t,e){return LJ(t,this,e)}scaleToGeocentricSurface(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];zc.from(t);const n=zc.x,i=zc.y,s=zc.z,a=this.oneOverRadiiSquared,o=1/Math.sqrt(n*n*a.x+i*i*a.y+s*s*a.z);return zc.multiplyScalar(o).to(e)}transformPositionToScaledSpace(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return zc.from(t).scale(this.oneOverRadii).to(e)}transformPositionFromScaledSpace(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return zc.from(t).scale(this.radii).to(e)}getSurfaceNormalIntersectionWithZAxis(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[0,0,0];Dc(kc(this.radii.x,this.radii.y,tg.EPSILON15)),Dc(this.radii.z>0),zc.from(t);const i=zc.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(i)>=this.radii.z-e))return zc.set(0,0,i).to(n)}}W(Li,"WGS84",new Li(bJ,wJ,xJ));function aL(){let r;if(typeof window<"u"&&window.performance)r=window.performance.now();else if(typeof process<"u"&&process.hrtime){const t=process.hrtime();r=t[0]*1e3+t[1]/1e6}else r=Date.now();return r}class cL{constructor(t,e){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=t,this.type=e,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=aL(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(aL()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class DJ{constructor(t){this.id=void 0,this.stats={},this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t of Object.values(this.stats))t.reset();return this}forEach(t){for(const e of Object.values(this.stats))t(e)}getTable(){const t={};return this.forEach(e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}}),t}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(e=>this._getOrCreate(e))}_getOrCreate(t){const{name:e,type:n}=t;let i=this.stats[e];return i||(t instanceof cL?i=t:i=new cL(e,n),this.stats[e]=i),i}}class kJ{constructor(t,e,n){W(this,"item",void 0),W(this,"previous",void 0),W(this,"next",void 0),this.item=t,this.previous=e,this.next=n}}class NJ{constructor(){W(this,"head",null),W(this,"tail",null),W(this,"_length",0)}get length(){return this._length}add(t){const e=new kJ(t,this.tail,null);return this.tail?(this.tail.next=e,this.tail=e):(this.head=e,this.tail=e),++this._length,e}remove(t){t&&(t.previous&&t.next?(t.previous.next=t.next,t.next.previous=t.previous):t.previous?(t.previous.next=null,this.tail=t.previous):t.next?(t.next.previous=null,this.head=t.next):(this.head=null,this.tail=null),t.next=null,t.previous=null,--this._length)}splice(t,e){t!==e&&(this.remove(e),this._insert(t,e))}_insert(t,e){const n=t.next;t.next=e,this.tail===t?this.tail=e:n.previous=e,e.next=n,e.previous=t,++this._length}}class QJ{constructor(){W(this,"_list",void 0),W(this,"_sentinel",void 0),W(this,"_trimTiles",void 0),this._list=new NJ,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(t){const e=t._cacheNode;e&&this._list.splice(this._sentinel,e)}add(t,e,n){e._cacheNode||(e._cacheNode=this._list.add(e),n&&n(t,e))}unloadTile(t,e,n){const i=e._cacheNode;i&&(this._list.remove(i),e._cacheNode=null,n&&n(t,e))}unloadTiles(t,e){const n=this._trimTiles;this._trimTiles=!1;const i=this._list,s=t.maximumMemoryUsage*1024*1024,a=this._sentinel;let o=i.head;for(;o!==a&&(t.gpuMemoryUsageInBytes>s||n);){const A=o.item;o=o.next,this.unloadTile(t,A,e)}}trim(){this._trimTiles=!0}}function HJ(r,t){ai(r),ai(t);const{rtcCenter:e,gltfUpAxis:n}=t,{computedTransform:i,boundingVolume:{center:s}}=r;let a=new xn(i);switch(e&&a.translate(e),n){case"Z":break;case"Y":const b=new xn().rotateX(Math.PI/2);a=a.multiplyRight(b);break;case"X":const x=new xn().rotateY(-Math.PI/2);a=a.multiplyRight(x);break}t.isQuantized&&a.translate(t.quantizedVolumeOffset).scale(t.quantizedVolumeScale);const o=new le(s);t.cartesianModelMatrix=a,t.cartesianOrigin=o;const A=Li.WGS84.cartesianToCartographic(o,new le),m=Li.WGS84.eastNorthUpToFixedFrame(o).invert();t.cartographicModelMatrix=m.multiplyRight(a),t.cartographicOrigin=A,t.coordinateSystem||(t.modelMatrix=t.cartographicModelMatrix)}const lL=new le,Sw=new le,Tw=new rc([new Hc,new Hc,new Hc,new Hc,new Hc,new Hc]);function zJ(r,t){const{cameraDirection:e,cameraUp:n,height:i}=r,{metersPerUnit:s}=r.distanceScales,a=J0(r,r.center),o=Li.WGS84.eastNorthUpToFixedFrame(a),A=r.unprojectPosition(r.cameraPosition),f=Li.WGS84.cartographicToCartesian(A,new le),m=new le(o.transformAsVector(new le(e).scale(s))).normalize(),b=new le(o.transformAsVector(new le(n).scale(s))).normalize();VJ(r);const x=r.constructor,{longitude:C,latitude:M,width:U,bearing:N,zoom:Q}=r,q=new x({longitude:C,latitude:M,height:i,width:U,bearing:N,zoom:Q,pitch:0});return{camera:{position:f,direction:m,up:b},viewport:r,topDownViewport:q,height:i,cullingVolume:Tw,frameNumber:t,sseDenominator:1.15}}function GJ(r,t,e){if(e===0||r.length<=e)return[r,[]];const n=[],{longitude:i,latitude:s}=t.viewport;for(const[f,m]of r.entries()){const[b,x]=m.header.mbs,C=Math.abs(i-b),M=Math.abs(s-x),U=Math.sqrt(M*M+C*C);n.push([f,U])}const a=n.sort((f,m)=>f[1]-m[1]),o=[];for(let f=0;f<e;f++)o.push(r[a[f][0]]);const A=[];for(let f=e;f<a.length;f++)A.push(r[a[f][0]]);return[o,A]}function VJ(r){const t=r.getFrustumPlanes(),e=uL(t.near,r.cameraPosition),n=J0(r,e),i=J0(r,r.cameraPosition,Sw);let s=0;Tw.planes[s++].fromPointNormal(n,lL.copy(n).subtract(i));for(const a in t){if(a==="near")continue;const o=t[a],A=uL(o,e,Sw),f=J0(r,A,Sw);Tw.planes[s++].fromPointNormal(f,lL.copy(n).subtract(f))}}function uL(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new le;const n=r.normal.dot(t);return e.copy(r.normal).scale(r.distance-n).add(t),e}function J0(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new le;const n=r.unprojectPosition(t);return Li.WGS84.cartographicToCartesian(n,e)}const jJ=6378137,qJ=6378137,Iw=6356752314245179e-9,AL=new le;function KJ(r,t){if(r instanceof dg){const{halfAxes:e}=r,n=$J(e);return Math.log2(Iw/(n+t[2]))}else if(r instanceof hg){const{radius:e}=r;return Math.log2(Iw/(e+t[2]))}else if(r.width&&r.height){const{width:e,height:n}=r,i=Math.log2(jJ/e),s=Math.log2(qJ/n);return(i+s)/2}return 1}function hL(r,t,e){const n=Li.WGS84.cartographicToCartesian([r.xmax,r.ymax,r.zmax],new le),i=Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)+Math.pow(n[2]-e[2],2));return Math.log2(Iw/(i+t[2]))}function WJ(r,t,e){const[n,i,s,a]=r;return hL({xmin:n,xmax:s,ymin:i,ymax:a,zmin:0,zmax:0},t,e)}function $J(r){r.getColumn(0,AL);const t=r.getColumn(1),e=r.getColumn(2);return AL.add(t).add(e).len()}const Ra={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},Mu={ADD:1,REPLACE:2},uf={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},ic={I3S:"I3S",TILES3D:"TILES3D"},Z0={GEOMETRIC_ERROR:"geometricError",MAX_SCREEN_THRESHOLD:"maxScreenThreshold"},XJ={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};function dL(r){return r!=null}const co=new le,ty=new le,YJ=new le,JJ=new le;function Lw(r,t,e){if(ai(r,"3D Tile: boundingVolume must be defined"),r.box)return tZ(r.box,t,e);if(r.region){const[n,i,s,a,o,A]=r.region,f=Li.WGS84.cartographicToCartesian([Tu(n),Tu(a),o],YJ),m=Li.WGS84.cartographicToCartesian([Tu(s),Tu(i),A],JJ),b=new le().addVectors(f,m).multiplyScalar(.5),x=new le().subVectors(f,m).len()/2;return fL([b[0],b[1],b[2],x],new xn)}if(r.sphere)return fL(r.sphere,t,e);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function ZJ(r,t){if(r.box)return eZ(t);if(r.region){const[e,n,i,s,a,o]=r.region;return[[Tu(e),Tu(n),a],[Tu(i),Tu(s),o]]}if(r.sphere)return rZ(t);throw new Error("Unkown boundingVolume type")}function tZ(r,t,e){const n=new le(r[0],r[1],r[2]);t.transform(n,n);let i=[];if(r.length===10){const f=r.slice(3,6),m=new Zp;m.fromArray(r,6);const b=new le([1,0,0]),x=new le([0,1,0]),C=new le([0,0,1]);b.transformByQuaternion(m),b.scale(f[0]),x.transformByQuaternion(m),x.scale(f[1]),C.transformByQuaternion(m),C.scale(f[2]),i=[...b.toArray(),...x.toArray(),...C.toArray()]}else i=[...r.slice(3,6),...r.slice(6,9),...r.slice(9,12)];const s=t.transformAsVector(i.slice(0,3)),a=t.transformAsVector(i.slice(3,6)),o=t.transformAsVector(i.slice(6,9)),A=new Qi([s[0],s[1],s[2],a[0],a[1],a[2],o[0],o[1],o[2]]);return dL(e)?(e.center=n,e.halfAxes=A,e):new dg(n,A)}function fL(r,t,e){const n=new le(r[0],r[1],r[2]);t.transform(n,n);const i=t.getScale(ty),s=Math.max(Math.max(i[0],i[1]),i[2]),a=r[3]*s;return dL(e)?(e.center=n,e.radius=a,e):new hg(n,a)}function eZ(r){const t=pL(),{halfAxes:e}=r,n=new le(e.getColumn(0)),i=new le(e.getColumn(1)),s=new le(e.getColumn(2));for(let a=0;a<2;a++){for(let o=0;o<2;o++){for(let A=0;A<2;A++)co.copy(r.center),co.add(n),co.add(i),co.add(s),gL(t,co),s.negate();i.negate()}n.negate()}return t}function rZ(r){const t=pL(),{center:e,radius:n}=r,i=Li.WGS84.scaleToGeodeticSurface(e,co);let s;i?s=Li.WGS84.geodeticSurfaceNormal(i):s=new le(0,0,1);let a=new le(s[2],-s[1],0);a.len()>0?a.normalize():a=new le(0,1,0);const o=a.clone().cross(s);for(const A of[a,o,s]){ty.copy(A).scale(n);for(let f=0;f<2;f++)co.copy(e),co.add(ty),gL(t,co),ty.negate()}return t}function pL(){return[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]]}function gL(r,t){Li.WGS84.cartesianToCartographic(t,co),r[0][0]=Math.min(r[0][0],co[0]),r[0][1]=Math.min(r[0][1],co[1]),r[0][2]=Math.min(r[0][2],co[2]),r[1][0]=Math.max(r[1][0],co[0]),r[1][1]=Math.max(r[1][1],co[1]),r[1][2]=Math.max(r[1][2],co[2])}new le,new le,new xn,new le,new le,new le;function nZ(r,t){const e=r*t;return 1-Math.exp(-(e*e))}function iZ(r,t){if(r.dynamicScreenSpaceError&&r.dynamicScreenSpaceErrorComputedDensity){const e=r.dynamicScreenSpaceErrorComputedDensity,n=r.dynamicScreenSpaceErrorFactor;return nZ(t,e)*n}return 0}function sZ(r,t,e){const n=r.tileset,i=r.parent&&r.parent.lodMetricValue||r.lodMetricValue,s=e?i:r.lodMetricValue;if(s===0)return 0;const a=Math.max(r._distanceToCamera,1e-7),{height:o,sseDenominator:A}=t,{viewDistanceScale:f}=n.options;let m=s*o*(f||1)/(a*A);return m-=iZ(n,a),m}const Fw=new le,mL=new le,PA=new le,yL=new le,oZ=new le,Mw=new xn,_L=new xn;function aZ(r,t){if(r.lodMetricValue===0||isNaN(r.lodMetricValue))return"DIG";const e=2*vL(r,t);return e<2?"OUT":!r.header.children||e<=r.lodMetricValue?"DRAW":r.header.children?"DIG":"OUT"}function vL(r,t){const{topDownViewport:e}=t,n=r.header.mbs[1],i=r.header.mbs[0],s=r.header.mbs[2],a=r.header.mbs[3],o=[...r.boundingVolume.center],A=e.unprojectPosition(e.cameraPosition);Li.WGS84.cartographicToCartesian(A,Fw),mL.copy(Fw).subtract(o).normalize(),Li.WGS84.eastNorthUpToFixedFrame(o,Mw),_L.copy(Mw).invert(),PA.copy(Fw).transform(_L);const f=Math.sqrt(PA[0]*PA[0]+PA[1]*PA[1]),m=f*f/PA[2];yL.copy([PA[0],PA[1],m]);const x=yL.transform(Mw).subtract(o).normalize(),M=mL.cross(x).normalize().scale(a).add(o),U=Li.WGS84.cartesianToCartographic(M),N=e.project([i,n,s]),Q=e.project(U);return oZ.copy(N).subtract(Q).magnitude()}function cZ(r){return{assetGltfUpAxis:r.asset&&r.asset.gltfUpAxis||"Y"}}class bL{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;W(this,"_map",new Map),W(this,"_array",void 0),W(this,"_length",void 0),this._array=new Array(t),this._length=t}get length(){return this._length}set length(t){this._length=t,t>this._array.length&&(this._array.length=t)}get values(){return this._array}get(t){return ai(t<this._array.length),this._array[t]}set(t,e){ai(t>=0),t>=this.length&&(this.length=t+1),this._map.has(this._array[t])&&this._map.delete(this._array[t]),this._array[t]=e,this._map.set(e,t)}delete(t){const e=this._map.get(t);e>=0&&(this._array.splice(e,1),this._map.delete(t),this.length--)}peek(){return this._array[this._length-1]}push(t){if(!this._map.has(t)){const e=this.length++;this._array[e]=t,this._map.set(t,e)}}pop(){const t=this._array[--this.length];return this._map.delete(t),t}reserve(t){ai(t>=0),t>this._array.length&&(this._array.length=t)}resize(t){ai(t>=0),this.length=t}trim(t){t==null&&(t=this.length),this._array.length=t}reset(){this._array=[],this._map=new Map,this._length=0}find(t){return this._map.has(t)}}const lZ={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class ey{traversalFinished(t){return!0}constructor(t){W(this,"options",void 0),W(this,"root",null),W(this,"selectedTiles",{}),W(this,"requestedTiles",{}),W(this,"emptyTiles",{}),W(this,"lastUpdate",new Date().getTime()),W(this,"updateDebounceTime",1e3),W(this,"_traversalStack",new bL),W(this,"_emptyTraversalStack",new bL),W(this,"_frameNumber",null),this.options={...lZ,...t}}traverse(t,e,n){this.root=t,this.options={...this.options,...n},this.reset(),this.updateTile(t,e),this._frameNumber=e.frameNumber,this.executeTraversal(t,e)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(t,e){const n=this._traversalStack;for(t._selectionDepth=1,n.push(t);n.length>0;){const s=n.pop();let a=!1;this.canTraverse(s,e)&&(this.updateChildTiles(s,e),a=this.updateAndPushChildren(s,e,n,s.hasRenderContent?s._selectionDepth+1:s._selectionDepth));const o=s.parent,A=!!(!o||o._shouldRefine),f=!a;s.hasRenderContent?s.refine===Mu.ADD?(this.loadTile(s,e),this.selectTile(s,e)):s.refine===Mu.REPLACE&&(this.loadTile(s,e),f&&this.selectTile(s,e)):(this.emptyTiles[s.id]=s,this.loadTile(s,e),f&&this.selectTile(s,e)),this.touchTile(s,e),s._shouldRefine=a&&A}const i=new Date().getTime();(this.traversalFinished(e)||i-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=i,this.options.onTraversalEnd(e))}updateChildTiles(t,e){const n=t.children;for(const i of n)this.updateTile(i,e)}updateAndPushChildren(t,e,n,i){const{loadSiblings:s,skipLevelOfDetail:a}=this.options,o=t.children;o.sort(this.compareDistanceToCamera.bind(this));const A=t.refine===Mu.REPLACE&&t.hasRenderContent&&!a;let f=!1,m=!0;for(const b of o)if(b._selectionDepth=i,b.isVisibleAndInRequestVolume?(n.find(b)&&n.delete(b),n.push(b),f=!0):(A||s)&&(this.loadTile(b,e),this.touchTile(b,e)),A){let x;if(b._inRequestVolume?b.hasRenderContent?x=b.contentAvailable:x=this.executeEmptyTraversal(b,e):x=!1,m=m&&x,!m)return!1}return f||(m=!1),m}updateTile(t,e){this.updateTileVisibility(t,e)}selectTile(t,e){this.shouldSelectTile(t)&&(t._selectedFrame=e.frameNumber,this.selectedTiles[t.id]=t)}loadTile(t,e){this.shouldLoadTile(t)&&(t._requestedFrame=e.frameNumber,t._priority=t._getPriority(),this.requestedTiles[t.id]=t)}touchTile(t,e){t.tileset._cache.touch(t),t._touchedFrame=e.frameNumber}canTraverse(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return t.hasChildren?t.hasTilesetContent?!t.contentExpired:!i&&!t.isVisibleAndInRequestVolume?!1:this.shouldRefine(t,e,n):!1}shouldLoadTile(t){return t.hasUnloadedContent||t.contentExpired}shouldSelectTile(t){return t.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=t._screenSpaceError;return n&&(i=t.getScreenSpaceError(e,!0)),i>this.options.maximumScreenSpaceError}updateTileVisibility(t,e){const n=[];if(this.options.viewportTraversersMap)for(const i in this.options.viewportTraversersMap)this.options.viewportTraversersMap[i]===e.viewport.id&&n.push(i);else n.push(e.viewport.id);t.updateVisibility(e,n)}compareDistanceToCamera(t,e){return t._distanceToCamera-e._distanceToCamera}anyChildrenVisible(t,e){let n=!1;for(const i of t.children)i.updateVisibility(e),n=n||i.isVisibleAndInRequestVolume;return n}executeEmptyTraversal(t,e){let n=!0;const i=this._emptyTraversalStack;for(i.push(t);i.length>0&&n;){const s=i.pop();if(this.updateTile(s,e),s.isVisibleAndInRequestVolume||this.loadTile(s,e),this.touchTile(s,e),!s.hasRenderContent&&this.canTraverse(s,e,!1,!0)){const o=s.children;for(const A of o)i.find(A)&&i.delete(A),i.push(A)}else!s.contentAvailable&&!s.hasEmptyContent&&(n=!1)}return n}}const wL=new le;function uZ(r){return r!=null}class Pw{constructor(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"";W(this,"tileset",void 0),W(this,"header",void 0),W(this,"id",void 0),W(this,"url",void 0),W(this,"parent",void 0),W(this,"refine",void 0),W(this,"type",void 0),W(this,"contentUrl",void 0),W(this,"lodMetricType","geometricError"),W(this,"lodMetricValue",0),W(this,"boundingVolume",null),W(this,"content",null),W(this,"contentState",Ra.UNLOADED),W(this,"gpuMemoryUsageInBytes",0),W(this,"children",[]),W(this,"depth",0),W(this,"viewportIds",[]),W(this,"transform",new xn),W(this,"extensions",null),W(this,"implicitTiling",null),W(this,"userData",{}),W(this,"computedTransform",void 0),W(this,"hasEmptyContent",!1),W(this,"hasTilesetContent",!1),W(this,"traverser",new ey({})),W(this,"_cacheNode",null),W(this,"_frameNumber",null),W(this,"_expireDate",null),W(this,"_expiredContent",null),W(this,"_boundingBox",void 0),W(this,"_distanceToCamera",0),W(this,"_screenSpaceError",0),W(this,"_visibilityPlaneMask",void 0),W(this,"_visible",void 0),W(this,"_contentBoundingVolume",void 0),W(this,"_viewerRequestVolume",void 0),W(this,"_initialTransform",new xn),W(this,"_priority",0),W(this,"_selectedFrame",0),W(this,"_requestedFrame",0),W(this,"_selectionDepth",0),W(this,"_touchedFrame",0),W(this,"_centerZDepth",0),W(this,"_shouldRefine",!1),W(this,"_stackLength",0),W(this,"_visitedFrame",0),W(this,"_inRequestVolume",!1),W(this,"_lodJudge",null),this.header=e,this.tileset=t,this.id=i||e.id,this.url=e.url,this.parent=n,this.refine=this._getRefine(e.refine),this.type=e.type,this.contentUrl=e.contentUrl,this._initializeLodMetric(e),this._initializeTransforms(e),this._initializeBoundingVolumes(e),this._initializeContent(e),this._initializeRenderingState(e),Object.seal(this)}destroy(){this.header=null}isDestroyed(){return this.header===null}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return this.contentState===Ra.READY||this.hasEmptyContent}get contentAvailable(){return!!(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return this.contentState===Ra.UNLOADED}get contentExpired(){return this.contentState===Ra.EXPIRED}get contentFailed(){return this.contentState===Ra.FAILED}get distanceToCamera(){return this._distanceToCamera}get screenSpaceError(){return this._screenSpaceError}get boundingBox(){return this._boundingBox||(this._boundingBox=ZJ(this.header.boundingVolume,this.boundingVolume)),this._boundingBox}getScreenSpaceError(t,e){switch(this.tileset.type){case ic.I3S:return vL(this,t);case ic.TILES3D:return sZ(this,t,e);default:throw new Error("Unsupported tileset type")}}unselect(){this._selectedFrame=0}_getGpuMemoryUsageInBytes(){return this.content.gpuMemoryUsageInBytes||this.content.byteLength||0}_getPriority(){const t=this.tileset._traverser,{skipLevelOfDetail:e}=t.options,n=this.refine===Mu.ADD||e;if(n&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===Ra.UNLOADED)return-1;const i=this.parent,a=i&&(!n||this._screenSpaceError===0||i.hasTilesetContent)?i._screenSpaceError:this._screenSpaceError,o=t.root?t.root._screenSpaceError:0;return Math.max(o-a,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=Ra.LOADING;const e=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!e)return this.contentState=Ra.UNLOADED,!1;try{const n=this.tileset.getTileUrl(this.contentUrl),i=this.tileset.loader,s={...this.tileset.loadOptions,[i.id]:{...this.tileset.loadOptions[i.id],isTileset:this.type==="json",...this._getLoaderSpecificOptions(i.id)}};return this.content=await bA(n,i,s),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=Ra.READY,this._onContentLoaded(),!0}catch(n){throw this.contentState=Ra.FAILED,n}finally{e.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=Ra.UNLOADED,!0}updateVisibility(t,e){if(this._frameNumber===t.frameNumber)return;const n=this.parent,i=n?n._visibilityPlaneMask:rc.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const s=n?n.computedTransform:this.tileset.modelMatrix;this._updateTransform(s)}this._distanceToCamera=this.distanceToTile(t),this._screenSpaceError=this.getScreenSpaceError(t,!1),this._visibilityPlaneMask=this.visibility(t,i),this._visible=this._visibilityPlaneMask!==rc.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(t),this._frameNumber=t.frameNumber,this.viewportIds=e}visibility(t,e){const{cullingVolume:n}=t,{boundingVolume:i}=this;return n.computeVisibilityWithPlaneMask(i,e)}contentVisibility(){return!0}distanceToTile(t){const e=this.boundingVolume;return Math.sqrt(Math.max(e.distanceSquaredTo(t.camera.position),0))}cameraSpaceZDepth(t){let{camera:e}=t;const n=this.boundingVolume;return wL.subVectors(n.center,e.position),e.direction.dot(wL)}insideViewerRequestVolume(t){const e=this._viewerRequestVolume;return!e||e.distanceSquaredTo(t.camera.position)<=0}updateExpiration(){if(uZ(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){const t=Date.now();Date.lessThan(this._expireDate,t)&&(this.contentState=Ra.EXPIRED,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(t){"lodMetricType"in t?this.lodMetricType=t.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in t?this.lodMetricValue=t.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(t){this.transform=t.transform?new xn(t.transform):new xn;const e=this.parent,n=this.tileset,i=e&&e.computedTransform?e.computedTransform.clone():n.modelMatrix.clone();this.computedTransform=new xn(i).multiplyRight(this.transform);const s=e&&e._initialTransform?e._initialTransform.clone():new xn;this._initialTransform=new xn(s).multiplyRight(this.transform)}_initializeBoundingVolumes(t){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(t)}_initializeContent(t){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=Ra.UNLOADED,this.hasTilesetContent=!1,t.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(t){this.depth=t.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=rc.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(t){return t||this.parent&&this.parent.refine||Mu.REPLACE}_isTileset(){return this.contentUrl.indexOf(".json")!==-1}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0;break}this._isTileset()?this.hasTilesetContent=!0:this.gpuMemoryUsageInBytes=this._getGpuMemoryUsageInBytes()}_updateBoundingVolume(t){this.boundingVolume=Lw(t.boundingVolume,this.computedTransform,this.boundingVolume);const e=t.content;e&&(e.boundingVolume&&(this._contentBoundingVolume=Lw(e.boundingVolume,this.computedTransform,this._contentBoundingVolume)),t.viewerRequestVolume&&(this._viewerRequestVolume=Lw(t.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:new xn).clone().multiplyRight(this.transform);e.equals(this.computedTransform)||(this.computedTransform=e,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(t){switch(t){case"i3s":return{...this.tileset.options.i3s,_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1};case"3d-tiles":case"cesium-ion":default:return cZ(this.tileset.tileset)}}}class AZ extends ey{compareDistanceToCamera(t,e){return e._distanceToCamera===0&&t._distanceToCamera===0?e._centerZDepth-t._centerZDepth:e._distanceToCamera-t._distanceToCamera}updateTileVisibility(t,e){if(super.updateTileVisibility(t,e),!t.isVisibleAndInRequestVolume)return;const n=t.children.length>0;if(t.hasTilesetContent&&n){const a=t.children[0];this.updateTileVisibility(a,e),t._visible=a._visible;return}if(this.meetsScreenSpaceErrorEarly(t,e)){t._visible=!1;return}const i=t.refine===Mu.REPLACE,s=t._optimChildrenWithinParent===XJ.USE_OPTIMIZATION;if(i&&s&&n&&!this.anyChildrenVisible(t,e)){t._visible=!1;return}}meetsScreenSpaceErrorEarly(t,e){const{parent:n}=t;return!n||n.hasTilesetContent||n.refine!==Mu.ADD?!1:!this.shouldRefine(t,e,!0)}}class hZ{constructor(){W(this,"frameNumberMap",new Map)}register(t,e){const n=this.frameNumberMap.get(t)||new Map,i=n.get(e)||0;n.set(e,i+1),this.frameNumberMap.set(t,n)}deregister(t,e){const n=this.frameNumberMap.get(t);if(!n)return;const i=n.get(e)||1;n.set(e,i-1)}isZero(t,e){var n;return(((n=this.frameNumberMap.get(t))===null||n===void 0?void 0:n.get(e))||0)===0}}const Uw={REQUESTED:"REQUESTED",COMPLETED:"COMPLETED",ERROR:"ERROR"};class dZ{constructor(){W(this,"_statusMap",void 0),W(this,"pendingTilesRegister",new hZ),this._statusMap={}}add(t,e,n,i){if(!this._statusMap[e]){const{frameNumber:s,viewport:{id:a}}=i;this._statusMap[e]={request:t,callback:n,key:e,frameState:i,status:Uw.REQUESTED},this.pendingTilesRegister.register(a,s),t().then(o=>{this._statusMap[e].status=Uw.COMPLETED;const{frameNumber:A,viewport:{id:f}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(f,A),this._statusMap[e].callback(o,i)}).catch(o=>{this._statusMap[e].status=Uw.ERROR;const{frameNumber:A,viewport:{id:f}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(f,A),n(o)})}}update(t,e){if(this._statusMap[t]){const{frameNumber:n,viewport:{id:i}}=this._statusMap[t].frameState;this.pendingTilesRegister.deregister(i,n);const{frameNumber:s,viewport:{id:a}}=e;this.pendingTilesRegister.register(a,s),this._statusMap[t].frameState=e}}find(t){return this._statusMap[t]}hasPendingTiles(t,e){return!this.pendingTilesRegister.isZero(t,e)}}class fZ extends ey{constructor(t){super(t),W(this,"_tileManager",void 0),this._tileManager=new dZ}traversalFinished(t){return!this._tileManager.hasPendingTiles(t.viewport.id,this._frameNumber||0)}shouldRefine(t,e){return t._lodJudge=aZ(t,e),t._lodJudge==="DIG"}updateChildTiles(t,e){const n=t.header.children||[],i=t.children,s=t.tileset;for(const a of n){const o="".concat(a.id,"-").concat(e.viewport.id),A=i&&i.find(f=>f.id===o);if(A)A&&this.updateTile(A,e);else{let f=()=>this._loadTile(a.id,s);this._tileManager.find(o)?this._tileManager.update(o,e):(s.tileset.nodePages&&(f=()=>s.tileset.nodePagesTile.formTileFromNodePages(a.id)),this._tileManager.add(f,o,b=>this._onTileLoad(b,t,o),e))}}return!1}async _loadTile(t,e){const{loader:n}=e,i=e.getTileUrl("".concat(e.url,"/nodes/").concat(t)),s={...e.loadOptions,i3s:{...e.loadOptions.i3s,isTileHeader:!0}};return await bA(i,n,s)}_onTileLoad(t,e,n){const i=new Pw(e.tileset,t,e,n);e.children.push(i);const s=this._tileManager.find(i.id).frameState;this.updateTile(i,s),this._frameNumber===s.frameNumber&&(this.traversalFinished(s)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(i,s)}}const pZ={description:"",ellipsoid:Li.WGS84,modelMatrix:new xn,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:r=>r,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},ry="Tiles In Tileset(s)",Rw="Tiles In Memory",xL="Tiles In View",BL="Tiles To Render",CL="Tiles Loaded",Ow="Tiles Loading",EL="Tiles Unloaded",SL="Failed Tile Loads",TL="Points/Vertices",Dw="Tile Memory Use";class gZ{constructor(t,e){W(this,"options",void 0),W(this,"loadOptions",void 0),W(this,"type",void 0),W(this,"tileset",void 0),W(this,"loader",void 0),W(this,"url",void 0),W(this,"basePath",void 0),W(this,"modelMatrix",void 0),W(this,"ellipsoid",void 0),W(this,"lodMetricType",void 0),W(this,"lodMetricValue",void 0),W(this,"refine",void 0),W(this,"root",null),W(this,"roots",{}),W(this,"asset",{}),W(this,"description",""),W(this,"properties",void 0),W(this,"extras",null),W(this,"attributions",{}),W(this,"credits",{}),W(this,"stats",void 0),W(this,"contentFormats",{draco:!1,meshopt:!1,dds:!1,ktx2:!1}),W(this,"cartographicCenter",null),W(this,"cartesianCenter",null),W(this,"zoom",1),W(this,"boundingVolume",null),W(this,"dynamicScreenSpaceErrorComputedDensity",0),W(this,"maximumMemoryUsage",32),W(this,"gpuMemoryUsageInBytes",0),W(this,"_frameNumber",0),W(this,"_queryParams",{}),W(this,"_extensionsUsed",[]),W(this,"_tiles",{}),W(this,"_pendingCount",0),W(this,"selectedTiles",[]),W(this,"traverseCounter",0),W(this,"geometricError",0),W(this,"lastUpdatedVieports",null),W(this,"_requestedTiles",[]),W(this,"_emptyTiles",[]),W(this,"frameStateData",{}),W(this,"_traverser",void 0),W(this,"_cache",new QJ),W(this,"_requestScheduler",void 0),W(this,"updatePromise",null),W(this,"tilesetInitializationPromise",void 0),this.options={...pZ,...e},this.tileset=t,this.loader=t.loader,this.type=t.type,this.url=t.url,this.basePath=t.basePath||lv(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=t.lodMetricType,this.lodMetricValue=t.lodMetricValue,this.refine=t.root.refine,this.loadOptions=this.options.loadOptions||{},this._traverser=this._initializeTraverser(),this._requestScheduler=new NN({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this.stats=new DJ({id:this.url}),this._initializeStats(),this.tilesetInitializationPromise=this._initializeTileSet(t)}destroy(){this._destroy()}isLoaded(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return new URLSearchParams(this._queryParams).toString()}setProps(t){this.options={...this.options,...t}}setOptions(t){this.options={...this.options,...t}}getTileUrl(t){return t.startsWith("data:")?t:"".concat(t).concat(t.includes("?")?"&":"?").concat(this.queryParams)}hasExtension(t){return this._extensionsUsed.indexOf(t)>-1}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.tilesetInitializationPromise.then(()=>{!t&&this.lastUpdatedVieports?t=this.lastUpdatedVieports:this.lastUpdatedVieports=t,t&&this.doUpdate(t)})}async selectTiles(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return await this.tilesetInitializationPromise,t&&(this.lastUpdatedVieports=t),this.updatePromise||(this.updatePromise=new Promise(e=>{setTimeout(()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),e(this._frameNumber),this.updatePromise=null},this.options.debounceTime)})),this.updatePromise}doUpdate(t){if("loadTiles"in this.options&&!this.options.loadTiles||this.traverseCounter>0)return;const e=t instanceof Array?t:[t];this._cache.reset(),this._frameNumber++,this.traverseCounter=e.length;const n=[];for(const i of e){const s=i.id;this._needTraverse(s)?n.push(s):this.traverseCounter--}for(const i of e){const s=i.id;if(this.roots[s]||(this.roots[s]=this._initializeTileHeaders(this.tileset,null)),!n.includes(s))continue;const a=zJ(i,this._frameNumber);this._traverser.traverse(this.roots[s],a,this.options)}}_needTraverse(t){let e=t;return this.options.viewportTraversersMap&&(e=this.options.viewportTraversersMap[t]),e===t}_onTraversalEnd(t){const e=t.viewport.id;this.frameStateData[e]||(this.frameStateData[e]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const n=this.frameStateData[e],i=Object.values(this._traverser.selectedTiles),[s,a]=GJ(i,t,this.options.maximumTilesSelected);n.selectedTiles=s;for(const o of a)o.unselect();n._requestedTiles=Object.values(this._traverser.requestedTiles),n._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const t in this.frameStateData){const e=this.frameStateData[t];this.selectedTiles=this.selectedTiles.concat(e.selectedTiles),this._requestedTiles=this._requestedTiles.concat(e._requestedTiles),this._emptyTiles=this._emptyTiles.concat(e._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const t of this.selectedTiles)this._tiles[t.id]=t;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(t,e){if(t.length!==e.length)return!0;const n=new Set(t.map(a=>a.id)),i=new Set(e.map(a=>a.id));let s=t.filter(a=>!i.has(a.id)).length>0;return s=s||e.filter(a=>!n.has(a.id)).length>0,s}_loadTiles(){for(const t of this._requestedTiles)t.contentUnloaded&&this._loadTile(t)}_unloadTiles(){this._cache.unloadTiles(this,(t,e)=>t._unloadTile(e))}_updateStats(){let t=0,e=0;for(const n of this.selectedTiles)n.contentAvailable&&n.content&&(t++,n.content.pointCount?e+=n.content.pointCount:e+=n.content.vertexCount);this.stats.get(xL).count=this.selectedTiles.length,this.stats.get(BL).count=t,this.stats.get(TL).count=e}async _initializeTileSet(t){this.type===ic.I3S&&(this.calculateViewPropsI3S(),t.root=await t.root),this.root=this._initializeTileHeaders(t,null),this.type===ic.TILES3D&&(this._initializeTiles3DTileset(t),this.calculateViewPropsTiles3D()),this.type===ic.I3S&&this._initializeI3STileset()}calculateViewPropsI3S(){var t;const e=this.tileset.fullExtent;if(e){const{xmin:i,xmax:s,ymin:a,ymax:o,zmin:A,zmax:f}=e;this.cartographicCenter=new le(i+(s-i)/2,a+(o-a)/2,A+(f-A)/2),this.cartesianCenter=Li.WGS84.cartographicToCartesian(this.cartographicCenter,new le),this.zoom=hL(e,this.cartographicCenter,this.cartesianCenter);return}const n=(t=this.tileset.store)===null||t===void 0?void 0:t.extent;if(n){const[i,s,a,o]=n;this.cartographicCenter=new le(i+(a-i)/2,s+(o-s)/2,0),this.cartesianCenter=Li.WGS84.cartographicToCartesian(this.cartographicCenter,new le),this.zoom=WJ(n,this.cartographicCenter,this.cartesianCenter);return}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new le,this.zoom=1}calculateViewPropsTiles3D(){const t=this.root,{center:e}=t.boundingVolume;if(!e){console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new le,this.zoom=1;return}e[0]!==0||e[1]!==0||e[2]!==0?this.cartographicCenter=Li.WGS84.cartesianToCartographic(e,new le):this.cartographicCenter=new le(0,0,-Li.WGS84.radii[0]),this.cartesianCenter=e,this.zoom=KJ(t.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get(ry),this.stats.get(Ow),this.stats.get(Rw),this.stats.get(xL),this.stats.get(BL),this.stats.get(CL),this.stats.get(EL),this.stats.get(SL),this.stats.get(TL),this.stats.get(Dw,"memory")}_initializeTileHeaders(t,e){const n=new Pw(this,t.root,e);if(e&&(e.children.push(n),n.depth=e.depth+1),this.type===ic.TILES3D){const s=[];for(s.push(n);s.length>0;){const a=s.pop();this.stats.get(ry).incrementCount();const o=a.header.children||[];for(const A of o){var i;const f=new Pw(this,A,a);if((i=f.contentUrl)!==null&&i!==void 0&&i.includes("?session=")){const b=new URL(f.contentUrl).searchParams.get("session");b&&(this._queryParams.session=b)}a.children.push(f),f.depth=a.depth+1,s.push(f)}}}return n}_initializeTraverser(){let t;switch(this.type){case ic.TILES3D:t=AZ;break;case ic.I3S:t=fZ;break;default:t=ey}return new t({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(t){this._destroySubtree(t)}async _loadTile(t){let e;try{this._onStartTileLoading(),e=await t.loadContent()}catch(n){this._onTileLoadError(t,n instanceof Error?n:new Error("load failed"))}finally{this._onEndTileLoading(),this._onTileLoad(t,e)}}_onTileLoadError(t,e){this.stats.get(SL).incrementCount();const n=e.message||e.toString(),i=t.url;console.error("A 3D tile failed to load: ".concat(t.url," ").concat(n)),this.options.onTileError(t,n,i)}_onTileLoad(t,e){if(e){if(this.type===ic.I3S){var n,i;const s=((n=this.tileset)===null||n===void 0||(i=n.nodePagesTile)===null||i===void 0?void 0:i.nodesInNodePages)||0;this.stats.get(ry).reset(),this.stats.get(ry).addCount(s)}t&&t.content&&HJ(t,t.content),this.updateContentTypes(t),this._addTileToCache(t),this.options.onTileLoad(t)}}updateContentTypes(t){if(this.type===ic.I3S)switch(t.header.isDracoGeometry&&(this.contentFormats.draco=!0),t.header.textureFormat){case"dds":this.contentFormats.dds=!0;break;case"ktx2":this.contentFormats.ktx2=!0;break}else if(this.type===ic.TILES3D){var e;const{extensionsRemoved:n=[]}=((e=t.content)===null||e===void 0?void 0:e.gltf)||{};n.includes("KHR_draco_mesh_compression")&&(this.contentFormats.draco=!0),n.includes("EXT_meshopt_compression")&&(this.contentFormats.meshopt=!0),n.includes("KHR_texture_basisu")&&(this.contentFormats.ktx2=!0)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(Ow).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(Ow).decrementCount()}_addTileToCache(t){this._cache.add(this,t,e=>e._updateCacheStats(t))}_updateCacheStats(t){this.stats.get(CL).incrementCount(),this.stats.get(Rw).incrementCount(),this.gpuMemoryUsageInBytes+=t.gpuMemoryUsageInBytes||0,this.stats.get(Dw).count=this.gpuMemoryUsageInBytes}_unloadTile(t){this.gpuMemoryUsageInBytes-=t.gpuMemoryUsageInBytes||0,this.stats.get(Rw).decrementCount(),this.stats.get(EL).incrementCount(),this.stats.get(Dw).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(t),t.unloadContent()}_destroy(){const t=[];for(this.root&&t.push(this.root);t.length>0;){const e=t.pop();for(const n of e.children)t.push(n);this._destroyTile(e)}this.root=null}_destroySubtree(t){const e=t,n=[];for(n.push(e);n.length>0;){t=n.pop();for(const i of t.children)n.push(i);t!==e&&this._destroyTile(t)}e.children=[]}_destroyTile(t){this._cache.unloadTile(this,t),this._unloadTile(t),t.destroy()}_initializeTiles3DTileset(t){if(t.queryString){const e=new URLSearchParams(t.queryString),n=Object.fromEntries(e.entries());this._queryParams={...this._queryParams,...n}}if(this.asset=t.asset,!this.asset)throw new Error("Tileset must have an asset property.");if(this.asset.version!=="0.0"&&this.asset.version!=="1.0")throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=t.properties,this.geometricError=t.geometricError,this._extensionsUsed=t.extensionsUsed||[],this.extras=t.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}const IL="3.4.14",bg={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"};function LL(r,t,e){ai(r instanceof ArrayBuffer);const n=new TextDecoder("utf8"),i=new Uint8Array(r,t,e);return n.decode(i)}function mZ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const e=new DataView(r);return"".concat(String.fromCharCode(e.getUint8(t+0))).concat(String.fromCharCode(e.getUint8(t+1))).concat(String.fromCharCode(e.getUint8(t+2))).concat(String.fromCharCode(e.getUint8(t+3)))}const yZ={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},ps={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},Pn={...yZ,...ps},kw={[ps.DOUBLE]:Float64Array,[ps.FLOAT]:Float32Array,[ps.UNSIGNED_SHORT]:Uint16Array,[ps.UNSIGNED_INT]:Uint32Array,[ps.UNSIGNED_BYTE]:Uint8Array,[ps.BYTE]:Int8Array,[ps.SHORT]:Int16Array,[ps.INT]:Int32Array},_Z={DOUBLE:ps.DOUBLE,FLOAT:ps.FLOAT,UNSIGNED_SHORT:ps.UNSIGNED_SHORT,UNSIGNED_INT:ps.UNSIGNED_INT,UNSIGNED_BYTE:ps.UNSIGNED_BYTE,BYTE:ps.BYTE,SHORT:ps.SHORT,INT:ps.INT},Nw="Failed to convert GL type";class Gl{static fromTypedArray(t){t=ArrayBuffer.isView(t)?t.constructor:t;for(const e in kw)if(kw[e]===t)return e;throw new Error(Nw)}static fromName(t){const e=_Z[t];if(!e)throw new Error(Nw);return e}static getArrayType(t){switch(t){case ps.UNSIGNED_SHORT_5_6_5:case ps.UNSIGNED_SHORT_4_4_4_4:case ps.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const e=kw[t];if(!e)throw new Error(Nw);return e}}static getByteSize(t){return Gl.getArrayType(t).BYTES_PER_ELEMENT}static validate(t){return!!Gl.getArrayType(t)}static createTypedArray(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;i===void 0&&(i=(e.byteLength-n)/Gl.getByteSize(t));const s=Gl.getArrayType(t);return new s(e,n,i)}}function vZ(r,t){if(!r)throw new Error("math.gl assertion failed. ".concat(t))}function bZ(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const e=r>>11&31,n=r>>5&63,i=r&31;return t[0]=e<<3,t[1]=n<<2,t[2]=i<<3,t}new cb,new le,new cb,new cb;function FL(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:255;return Iu(r,0,t)/t*2-1}function ML(r){return r<0?-1:1}function wZ(r,t,e,n){if(vZ(n),r<0||r>e||t<0||t>e)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(e));if(n.x=FL(r,e),n.y=FL(t,e),n.z=1-(Math.abs(n.x)+Math.abs(n.y)),n.z<0){const i=n.x;n.x=(1-Math.abs(n.y))*ML(i),n.y=(1-Math.abs(i))*ML(n.y)}return n.normalize()}function xZ(r,t,e){return wZ(r,t,255,e)}class Qw{constructor(t,e){W(this,"json",void 0),W(this,"buffer",void 0),W(this,"featuresLength",0),W(this,"_cachedTypedArrays",{}),this.json=t,this.buffer=e}getExtension(t){return this.json.extensions&&this.json.extensions[t]}hasProperty(t){return!!this.json[t]}getGlobalProperty(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pn.UNSIGNED_INT,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=this.json[t];return i&&Number.isFinite(i.byteOffset)?this._getTypedArrayFromBinary(t,e,n,1,i.byteOffset):i}getPropertyArray(t,e,n){const i=this.json[t];return i&&Number.isFinite(i.byteOffset)?("componentType"in i&&(e=Gl.fromName(i.componentType)),this._getTypedArrayFromBinary(t,e,n,this.featuresLength,i.byteOffset)):this._getTypedArrayFromArray(t,e,i)}getProperty(t,e,n,i,s){const a=this.json[t];if(!a)return a;const o=this.getPropertyArray(t,e,n);if(n===1)return o[i];for(let A=0;A<n;++A)s[A]=o[n*i+A];return s}_getTypedArrayFromBinary(t,e,n,i,s){const a=this._cachedTypedArrays;let o=a[t];return o||(o=Gl.createTypedArray(e,this.buffer.buffer,this.buffer.byteOffset+s,i*n),a[t]=o),o}_getTypedArrayFromArray(t,e,n){const i=this._cachedTypedArrays;let s=i[t];return s||(s=Gl.createTypedArray(e,n),i[t]=s),s}}const BZ={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},CZ={SCALAR:(r,t)=>r[t],VEC2:(r,t)=>[r[2*t+0],r[2*t+1]],VEC3:(r,t)=>[r[3*t+0],r[3*t+1],r[3*t+2]],VEC4:(r,t)=>[r[4*t+0],r[4*t+1],r[4*t+2],r[4*t+3]],MAT2:(r,t)=>[r[4*t+0],r[4*t+1],r[4*t+2],r[4*t+3]],MAT3:(r,t)=>[r[9*t+0],r[9*t+1],r[9*t+2],r[9*t+3],r[9*t+4],r[9*t+5],r[9*t+6],r[9*t+7],r[9*t+8]],MAT4:(r,t)=>[r[16*t+0],r[16*t+1],r[16*t+2],r[16*t+3],r[16*t+4],r[16*t+5],r[16*t+6],r[16*t+7],r[16*t+8],r[16*t+9],r[16*t+10],r[16*t+11],r[16*t+12],r[16*t+13],r[16*t+14],r[16*t+15]]},EZ={SCALAR:(r,t,e)=>{t[e]=r},VEC2:(r,t,e)=>{t[2*e+0]=r[0],t[2*e+1]=r[1]},VEC3:(r,t,e)=>{t[3*e+0]=r[0],t[3*e+1]=r[1],t[3*e+2]=r[2]},VEC4:(r,t,e)=>{t[4*e+0]=r[0],t[4*e+1]=r[1],t[4*e+2]=r[2],t[4*e+3]=r[3]},MAT2:(r,t,e)=>{t[4*e+0]=r[0],t[4*e+1]=r[1],t[4*e+2]=r[2],t[4*e+3]=r[3]},MAT3:(r,t,e)=>{t[9*e+0]=r[0],t[9*e+1]=r[1],t[9*e+2]=r[2],t[9*e+3]=r[3],t[9*e+4]=r[4],t[9*e+5]=r[5],t[9*e+6]=r[6],t[9*e+7]=r[7],t[9*e+8]=r[8],t[9*e+9]=r[9]},MAT4:(r,t,e)=>{t[16*e+0]=r[0],t[16*e+1]=r[1],t[16*e+2]=r[2],t[16*e+3]=r[3],t[16*e+4]=r[4],t[16*e+5]=r[5],t[16*e+6]=r[6],t[16*e+7]=r[7],t[16*e+8]=r[8],t[16*e+9]=r[9],t[16*e+10]=r[10],t[16*e+11]=r[11],t[16*e+12]=r[12],t[16*e+13]=r[13],t[16*e+14]=r[14],t[16*e+15]=r[15]}};function SZ(r,t,e,n){const{componentType:i}=r;ai(r.componentType);const s=typeof i=="string"?Gl.fromName(i):i,a=BZ[r.type],o=CZ[r.type],A=EZ[r.type];return e+=r.byteOffset,{values:Gl.createTypedArray(s,t,e,a*n),type:s,size:a,unpacker:o,packer:A}}const Vl=r=>r!==void 0;function TZ(r,t,e){if(!t)return null;let n=r.getExtension("3DTILES_batch_table_hierarchy");const i=t.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),t.extensions=t.extensions||{},t.extensions["3DTILES_batch_table_hierarchy"]=i,n=i),n?IZ(n,e):null}function IZ(r,t){let e,n,i;const s=r.instancesLength,a=r.classes;let o=r.classIds,A=r.parentCounts,f=r.parentIds,m=s;Vl(o.byteOffset)&&(o.componentType=defaultValue(o.componentType,GL.UNSIGNED_SHORT),o.type=AttributeType.SCALAR,i=getBinaryAccessor(o),o=i.createArrayBufferView(t.buffer,t.byteOffset+o.byteOffset,s));let b;if(Vl(A))for(Vl(A.byteOffset)&&(A.componentType=defaultValue(A.componentType,GL.UNSIGNED_SHORT),A.type=AttributeType.SCALAR,i=getBinaryAccessor(A),A=i.createArrayBufferView(t.buffer,t.byteOffset+A.byteOffset,s)),b=new Uint16Array(s),m=0,e=0;e<s;++e)b[e]=m,m+=A[e];Vl(f)&&Vl(f.byteOffset)&&(f.componentType=defaultValue(f.componentType,GL.UNSIGNED_SHORT),f.type=AttributeType.SCALAR,i=getBinaryAccessor(f),f=i.createArrayBufferView(t.buffer,t.byteOffset+f.byteOffset,m));const x=a.length;for(e=0;e<x;++e){const N=a[e].length,Q=a[e].instances,q=getBinaryProperties(N,Q,t);a[e].instances=combine(q,Q)}const C=new Array(x).fill(0),M=new Uint16Array(s);for(e=0;e<s;++e)n=o[e],M[e]=C[n],++C[n];const U={classes:a,classIds:o,classIndexes:M,parentCounts:A,parentIndexes:b,parentIds:f};return MZ(U),U}function wg(r,t,e){if(!r)return;const n=r.parentCounts;return r.parentIds?e(r,t):n>0?LZ(r,t,e):FZ(r,t,e)}function LZ(r,t,e){const n=r.classIds,i=r.parentCounts,s=r.parentIds,a=r.parentIndexes,o=n.length,A=scratchVisited;A.length=Math.max(A.length,o);const f=++marker,m=scratchStack;for(m.length=0,m.push(t);m.length>0;){if(t=m.pop(),A[t]===f)continue;A[t]=f;const b=e(r,t);if(Vl(b))return b;const x=i[t],C=a[t];for(let M=0;M<x;++M){const U=s[C+M];U!==t&&m.push(U)}}return null}function FZ(r,t,e){let n=!0;for(;n;){const i=e(r,t);if(Vl(i))return i;const s=r.parentIds[t];n=s!==t,t=s}throw new Error("traverseHierarchySingleParent")}function MZ(r){const e=r.classIds.length;for(let n=0;n<e;++n)PL(r,n,stack)}function PL(r,t,e){const n=r.parentCounts,i=r.parentIds,s=r.parentIndexes,o=r.classIds.length;if(!Vl(i))return;assert(t<o,"Parent index ".concat(t," exceeds the total number of instances: ").concat(o)),assert(e.indexOf(t)===-1,"Circular dependency detected in the batch table hierarchy."),e.push(t);const A=Vl(n)?n[t]:1,f=Vl(n)?s[t]:t;for(let m=0;m<A;++m){const b=i[f+m];b!==t&&PL(r,b,e)}e.pop(t)}function ca(r){return r!=null}const ny=(r,t)=>r,PZ={HIERARCHY:!0,extensions:!0,extras:!0};class UL{constructor(t,e,n){var i;let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};W(this,"json",void 0),W(this,"binary",void 0),W(this,"featureCount",void 0),W(this,"_extensions",void 0),W(this,"_properties",void 0),W(this,"_binaryProperties",void 0),W(this,"_hierarchy",void 0),ai(n>=0),this.json=t||{},this.binary=e,this.featureCount=n,this._extensions=((i=this.json)===null||i===void 0?void 0:i.extensions)||{},this._properties={};for(const a in this.json)PZ[a]||(this._properties[a]=this.json[a]);this._binaryProperties=this._initializeBinaryProperties(),s["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=TZ(this,this.json,this.binary))}getExtension(t){return this.json&&this.json.extensions&&this.json.extensions[t]}memorySizeInBytes(){return 0}isClass(t,e){if(this._checkBatchId(t),ai(typeof e=="string",e),this._hierarchy){const n=wg(this._hierarchy,t,(i,s)=>{const a=i.classIds[s];return i.classes[a].name===e});return ca(n)}return!1}isExactClass(t,e){return ai(typeof e=="string",e),this.getExactClassName(t)===e}getExactClassName(t){if(this._checkBatchId(t),this._hierarchy){const e=this._hierarchy.classIds[t];return this._hierarchy.classes[e].name}}hasProperty(t,e){return this._checkBatchId(t),ai(typeof e=="string",e),ca(this._properties[e])||this._hasPropertyInHierarchy(t,e)}getPropertyNames(t,e){this._checkBatchId(t),e=ca(e)?e:[],e.length=0;const n=Object.keys(this._properties);return e.push(...n),this._hierarchy&&this._getPropertyNamesInHierarchy(t,e),e}getProperty(t,e){if(this._checkBatchId(t),ai(typeof e=="string",e),this._binaryProperties){const i=this._binaryProperties[e];if(ca(i))return this._getBinaryProperty(i,t)}const n=this._properties[e];if(ca(n))return ny(n[t]);if(this._hierarchy){const i=this._getHierarchyProperty(t,e);if(ca(i))return i}}setProperty(t,e,n){const i=this.featureCount;if(this._checkBatchId(t),ai(typeof e=="string",e),this._binaryProperties){const a=this._binaryProperties[e];if(a){this._setBinaryProperty(a,t,n);return}}if(this._hierarchy&&this._setHierarchyProperty(this,t,e,n))return;let s=this._properties[e];ca(s)||(this._properties[e]=new Array(i),s=this._properties[e]),s[t]=ny(n)}_checkBatchId(t){if(!(t>=0&&t<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(t,e){return t.unpack(t.typedArray,e)}_setBinaryProperty(t,e,n){t.pack(n,t.typedArray,e)}_initializeBinaryProperties(){let t=null;for(const e in this._properties){const n=this._properties[e],i=this._initializeBinaryProperty(e,n);i&&(t=t||{},t[e]=i)}return t}_initializeBinaryProperty(t,e){if("byteOffset"in e){const n=e;ai(this.binary,"Property ".concat(t," requires a batch table binary.")),ai(n.type,"Property ".concat(t," requires a type."));const i=SZ(n,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:i.values,componentCount:i.size,unpack:i.unpacker,pack:i.packer}}return null}_hasPropertyInHierarchy(t,e){if(!this._hierarchy)return!1;const n=wg(this._hierarchy,t,(i,s)=>{const a=i.classIds[s],o=i.classes[a].instances;return ca(o[e])});return ca(n)}_getPropertyNamesInHierarchy(t,e){wg(this._hierarchy,t,(n,i)=>{const s=n.classIds[i],a=n.classes[s].instances;for(const o in a)a.hasOwnProperty(o)&&e.indexOf(o)===-1&&e.push(o)})}_getHierarchyProperty(t,e){return wg(this._hierarchy,t,(n,i)=>{const s=n.classIds[i],a=n.classes[s],o=n.classIndexes[i],A=a.instances[e];return ca(A)?ca(A.typedArray)?this._getBinaryProperty(A,o):ny(A[o]):null})}_setHierarchyProperty(t,e,n,i){const s=wg(this._hierarchy,e,(a,o)=>{const A=a.classIds[o],f=a.classes[A],m=a.classIndexes[o],b=f.instances[n];return ca(b)?(ai(o===e,'Inherited property "'.concat(n,'" is read-only.')),ca(b.typedArray)?this._setBinaryProperty(b,m,i):b[m]=ny(i),!0):!1});return ca(s)}}const Hw=4;function iy(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const n=new DataView(t);if(r.magic=n.getUint32(e,!0),e+=Hw,r.version=n.getUint32(e,!0),e+=Hw,r.byteLength=n.getUint32(e,!0),e+=Hw,r.version!==1)throw new Error("3D Tile Version ".concat(r.version," not supported"));return e}const Af=4,RL="b3dm tile in legacy format.";function zw(r,t,e){const n=new DataView(t);let i;r.header=r.header||{};let s=n.getUint32(e,!0);e+=Af;let a=n.getUint32(e,!0);e+=Af;let o=n.getUint32(e,!0);e+=Af;let A=n.getUint32(e,!0);return e+=Af,o>=570425344?(e-=Af*2,i=s,o=a,A=0,s=0,a=0,console.warn(RL)):A>=570425344&&(e-=Af,i=o,o=s,A=a,s=0,a=0,console.warn(RL)),r.header.featureTableJsonByteLength=s,r.header.featureTableBinaryByteLength=a,r.header.batchTableJsonByteLength=o,r.header.batchTableBinaryByteLength=A,r.header.batchLength=i,e}function Gw(r,t,e,n){return e=UZ(r,t,e),e=RZ(r,t,e),e}function UZ(r,t,e,n){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:s,batchLength:a}=r.header;if(r.featureTableJson={BATCH_LENGTH:a||0},i>0){const o=LL(t,e,i);r.featureTableJson=JSON.parse(o)}return e+=i,r.featureTableBinary=new Uint8Array(t,e,s),e+=s,e}function RZ(r,t,e,n){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:s}=r.header;if(i>0){const a=LL(t,e,i);r.batchTableJson=JSON.parse(a),e+=i,s>0&&(r.batchTableBinary=new Uint8Array(t,e,s),r.batchTableBinary=new Uint8Array(r.batchTableBinary),e+=s)}return e}function OL(r,t,e){if(!t&&(!r||!r.batchIds||!e))return null;const{batchIds:n,isRGB565:i,pointCount:s}=r;if(n&&e){const a=new Uint8ClampedArray(s*3);for(let o=0;o<s;o++){const A=n[o],m=e.getProperty(A,"dimensions").map(b=>b*255);a[o*3]=m[0],a[o*3+1]=m[1],a[o*3+2]=m[2]}return{type:Pn.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}if(i){const a=new Uint8ClampedArray(s*3);for(let o=0;o<s;o++){const A=bZ(t[o]);a[o*3]=A[0],a[o*3+1]=A[1],a[o*3+2]=A[2]}return{type:Pn.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}return t&&t.length===s*3?{type:Pn.UNSIGNED_BYTE,value:t,size:3,normalized:!0}:{type:Pn.UNSIGNED_BYTE,value:t,size:4,normalized:!0}}const DL=new le;function OZ(r,t){if(!t)return null;if(r.isOctEncoded16P){const e=new Float32Array(r.pointsLength*3);for(let n=0;n<r.pointsLength;n++)xZ(t[n*2],t[n*2+1],DL),DL.toArray(e,n*3);return{type:Pn.FLOAT,size:2,value:e}}return{type:Pn.FLOAT,size:2,value:t}}function DZ(r,t,e){return r.isQuantized?e["3d-tiles"]&&e["3d-tiles"].decodeQuantizedPositions?(r.isQuantized=!1,kZ(r,t)):{type:Pn.UNSIGNED_SHORT,value:t,size:3,normalized:!0}:t}function kZ(r,t){const e=new le,n=new Float32Array(r.pointCount*3);for(let i=0;i<r.pointCount;i++)e.set(t[i*3],t[i*3+1],t[i*3+2]).scale(1/r.quantizedRange).multiply(r.quantizedVolumeScale).add(r.quantizedVolumeOffset).toArray(n,i*3);return n}async function NZ(r,t,e,n,i){e=iy(r,t,e),e=zw(r,t,e),e=Gw(r,t,e),QZ(r);const{featureTable:s,batchTable:a}=HZ(r);return await qZ(r,s,a,n,i),zZ(r,s,n),GZ(r,s,a),VZ(r,s),e}function QZ(r){r.attributes={positions:null,colors:null,normals:null,batchIds:null},r.isQuantized=!1,r.isTranslucent=!1,r.isRGB565=!1,r.isOctEncoded16P=!1}function HZ(r){const t=new Qw(r.featureTableJson,r.featureTableBinary),e=t.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(e))throw new Error("POINTS_LENGTH must be defined");t.featuresLength=e,r.featuresLength=e,r.pointsLength=e,r.pointCount=e,r.rtcCenter=t.getGlobalProperty("RTC_CENTER",Pn.FLOAT,3);const n=jZ(r,t);return{featureTable:t,batchTable:n}}function zZ(r,t,e){if(!r.attributes.positions){if(t.hasProperty("POSITION"))r.attributes.positions=t.getPropertyArray("POSITION",Pn.FLOAT,3);else if(t.hasProperty("POSITION_QUANTIZED")){const n=t.getPropertyArray("POSITION_QUANTIZED",Pn.UNSIGNED_SHORT,3);if(r.isQuantized=!0,r.quantizedRange=65535,r.quantizedVolumeScale=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Pn.FLOAT,3),!r.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(r.quantizedVolumeOffset=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Pn.FLOAT,3),!r.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");r.attributes.positions=DZ(r,n,e)}}if(!r.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function GZ(r,t,e){if(!r.attributes.colors){let n=null;t.hasProperty("RGBA")?(n=t.getPropertyArray("RGBA",Pn.UNSIGNED_BYTE,4),r.isTranslucent=!0):t.hasProperty("RGB")?n=t.getPropertyArray("RGB",Pn.UNSIGNED_BYTE,3):t.hasProperty("RGB565")&&(n=t.getPropertyArray("RGB565",Pn.UNSIGNED_SHORT,1),r.isRGB565=!0),r.attributes.colors=OL(r,n,e)}t.hasProperty("CONSTANT_RGBA")&&(r.constantRGBA=t.getGlobalProperty("CONSTANT_RGBA",Pn.UNSIGNED_BYTE,4))}function VZ(r,t){if(!r.attributes.normals){let e=null;t.hasProperty("NORMAL")?e=t.getPropertyArray("NORMAL",Pn.FLOAT,3):t.hasProperty("NORMAL_OCT16P")&&(e=t.getPropertyArray("NORMAL_OCT16P",Pn.UNSIGNED_BYTE,2),r.isOctEncoded16P=!0),r.attributes.normals=OZ(r,e)}}function jZ(r,t){let e=null;if(!r.batchIds&&t.hasProperty("BATCH_ID")&&(r.batchIds=t.getPropertyArray("BATCH_ID",Pn.UNSIGNED_SHORT,1),r.batchIds)){const n=t.getGlobalProperty("BATCH_LENGTH");if(!n)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:s}=r;e=new UL(i,s,n)}return e}async function qZ(r,t,e,n,i){let s,a,o;const A=r.batchTableJson&&r.batchTableJson.extensions&&r.batchTableJson.extensions["3DTILES_draco_point_compression"];A&&(o=A.properties);const f=t.getExtension("3DTILES_draco_point_compression");if(f){a=f.properties;const b=f.byteOffset,x=f.byteLength;if(!a||!Number.isFinite(b)||!x)throw new Error("Draco properties, byteOffset, and byteLength must be defined");s=r.featureTableBinary.slice(b,b+x),r.hasPositions=Number.isFinite(a.POSITION),r.hasColors=Number.isFinite(a.RGB)||Number.isFinite(a.RGBA),r.hasNormals=Number.isFinite(a.NORMAL),r.hasBatchIds=Number.isFinite(a.BATCH_ID),r.isTranslucent=Number.isFinite(a.RGBA)}if(!s)return!0;const m={buffer:s,properties:{...a,...o},featureTableProperties:a,batchTableProperties:o,dequantizeInShader:!1};return await KZ(r,m,n,i)}async function KZ(r,t,e,n){const{parse:i}=n,s={...e,draco:{...e.draco,extraAttributes:t.batchTableProperties||{}}};delete s["3d-tiles"];const a=await i(t.buffer,WI,s),o=a.attributes.POSITION&&a.attributes.POSITION.value,A=a.attributes.COLOR_0&&a.attributes.COLOR_0.value,f=a.attributes.NORMAL&&a.attributes.NORMAL.value,m=a.attributes.BATCH_ID&&a.attributes.BATCH_ID.value,b=o&&a.attributes.POSITION.value.quantization,x=f&&a.attributes.NORMAL.value.quantization;if(b){const M=a.POSITION.data.quantization,U=M.range;r.quantizedVolumeScale=new le(U,U,U),r.quantizedVolumeOffset=new le(M.minValues),r.quantizedRange=(1<<M.quantizationBits)-1,r.isQuantizedDraco=!0}x&&(r.octEncodedRange=(1<<a.NORMAL.data.quantization.quantizationBits)-1,r.isOctEncodedDraco=!0);const C={};if(t.batchTableProperties)for(const M of Object.keys(t.batchTableProperties))a.attributes[M]&&a.attributes[M].value&&(C[M.toLowerCase()]=a.attributes[M].value);r.attributes={positions:o,colors:OL(r,A,void 0),normals:f,batchIds:m,...C}}const Vw={URI:0,EMBEDDED:1};function kL(r,t,e,n){r.rotateYtoZ=!0;const i=r.byteOffset+r.byteLength-e;if(i===0)throw new Error("glTF byte length must be greater than 0.");return r.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y",r.gltfArrayBuffer=cv(t,e,i),r.gltfByteOffset=0,r.gltfByteLength=i,e%4===0||console.warn("".concat(r.type,": embedded glb is not aligned to a 4-byte boundary.")),r.byteOffset+r.byteLength}async function NL(r,t,e,n){const i=e["3d-tiles"]||{};if(WZ(r,t),i.loadGLTF){const{parse:s,fetch:a}=n;r.gltfUrl&&(r.gltfArrayBuffer=await a(r.gltfUrl,e),r.gltfByteOffset=0),r.gltfArrayBuffer&&(r.gltf=await s(r.gltfArrayBuffer,_g,e,n),r.gpuMemoryUsageInBytes=VI(r.gltf),delete r.gltfArrayBuffer,delete r.gltfByteOffset,delete r.gltfByteLength)}}function WZ(r,t,e){switch(t){case Vw.URI:const n=new Uint8Array(r.gltfArrayBuffer,r.gltfByteOffset),s=new TextDecoder().decode(n);r.gltfUrl=s.replace(/[\s\0]+$/,""),delete r.gltfArrayBuffer,delete r.gltfByteOffset,delete r.gltfByteLength;break;case Vw.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function $Z(r,t,e,n,i){var s;e=XZ(r,t,e,n),await NL(r,Vw.EMBEDDED,n,i);const a=r==null||(s=r.gltf)===null||s===void 0?void 0:s.extensions;return a&&a.CESIUM_RTC&&(r.rtcCenter=a.CESIUM_RTC.center),e}function XZ(r,t,e,n,i){e=iy(r,t,e),e=zw(r,t,e),e=Gw(r,t,e),e=kL(r,t,e,n);const s=new Qw(r.featureTableJson,r.featureTableBinary);return r.rtcCenter=s.getGlobalProperty("RTC_CENTER",Pn.FLOAT,3),e}async function YZ(r,t,e,n,i){return e=JZ(r,t,e,n),await NL(r,r.gltfFormat,n,i),e}function JZ(r,t,e,n,i){if(e=iy(r,t,e),r.version!==1)throw new Error("Instanced 3D Model version ".concat(r.version," is not supported"));e=zw(r,t,e);const s=new DataView(t);if(r.gltfFormat=s.getUint32(e,!0),e+=4,e=Gw(r,t,e),e=kL(r,t,e,n),r.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const a=new Qw(r.featureTableJson,r.featureTableBinary),o=a.getGlobalProperty("INSTANCES_LENGTH");if(a.featuresLength=o,!Number.isFinite(o))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");r.eastNorthUp=a.getGlobalProperty("EAST_NORTH_UP"),r.rtcCenter=a.getGlobalProperty("RTC_CENTER",Pn.FLOAT,3);const A=new UL(r.batchTableJson,r.batchTableBinary,o);return ZZ(r,a,A,o),e}function ZZ(r,t,e,n){const s={instances:new Array(n),batchTable:r._batchTable,cull:!1,url:void 0,gltf:void 0,basePath:void 0,incrementallyLoadTextures:!1,forwardAxis:[1,0,0]}.instances,a=new le;new le,new le,new le;const o=new Qi,A=new Zp,f=new le,m={},b=new xn,x=[],C=[],M=new le,U=new le;for(let N=0;N<n;N++){let Q;if(t.hasProperty("POSITION"))Q=t.getProperty("POSITION",Pn.FLOAT,3,N,a);else if(t.hasProperty("POSITION_QUANTIZED")){Q=t.getProperty("POSITION_QUANTIZED",Pn.UNSIGNED_SHORT,3,N,a);const mt=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Pn.FLOAT,3,M);if(!mt)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const dt=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Pn.FLOAT,3,U);if(!dt)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const Rt=65535;for(let Lt=0;Lt<3;Lt++)Q[Lt]=Q[Lt]/Rt*dt[Lt]+mt[Lt]}if(!Q)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");if(a.copy(Q),m.translation=a,r.normalUp=t.getProperty("NORMAL_UP",Pn.FLOAT,3,N,x),r.normalRight=t.getProperty("NORMAL_RIGHT",Pn.FLOAT,3,N,C),r.normalUp){if(!r.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");r.hasCustomOrientation=!0}else{if(r.octNormalUp=t.getProperty("NORMAL_UP_OCT32P",Pn.UNSIGNED_SHORT,2,x),r.octNormalRight=t.getProperty("NORMAL_RIGHT_OCT32P",Pn.UNSIGNED_SHORT,2,C),r.octNormalUp)throw r.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");r.eastNorthUp?(Li.WGS84.eastNorthUpToFixedFrame(a,b),b.getRotationMatrix3(o)):o.identity()}A.fromMatrix3(o),m.rotation=A,f.set(1,1,1);const q=t.getProperty("SCALE",Pn.FLOAT,1,N);Number.isFinite(q)&&f.multiplyByScalar(q);const Y=t.getProperty("SCALE_NON_UNIFORM",Pn.FLOAT,3,N,x);Y&&f.scale(Y),m.scale=f;let tt=t.getProperty("BATCH_ID",Pn.UNSIGNED_SHORT,1,N);tt===void 0&&(tt=N);const ft=new xn().fromQuaternion(m.rotation);b.identity(),b.translate(m.translation),b.multiplyRight(ft),b.scale(m.scale);const pt=b.clone();s[N]={modelMatrix:pt,batchId:tt}}r.instances=s}async function ttt(r,t,e,n,i,s){e=iy(r,t,e);const a=new DataView(t);for(r.tilesLength=a.getUint32(e,!0),e+=4,r.tiles=[];r.tiles.length<r.tilesLength&&r.byteLength-e>12;){const o={};r.tiles.push(o),e=await s(t,e,n,i,o)}return e}async function ett(r,t,e,n){r.rotateYtoZ=!0,r.gltfUpAxis=e["3d-tiles"]&&e["3d-tiles"].assetGltfUpAxis?e["3d-tiles"].assetGltfUpAxis:"Y";const{parse:i}=n;r.gltf=await i(t,_g,e,n),r.gpuMemoryUsageInBytes=VI(r.gltf)}async function QL(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};switch(i.byteOffset=t,i.type=mZ(r,t),i.type){case bg.COMPOSITE:return await ttt(i,r,t,e,n,QL);case bg.BATCHED_3D_MODEL:return await $Z(i,r,t,e,n);case bg.GLTF:return await ett(i,r,e,n);case bg.INSTANCED_3D_MODEL:return await YZ(i,r,t,e,n);case bg.POINT_CLOUD:return await NZ(i,r,t,e,n);default:throw new Error("3DTileLoader: unknown type ".concat(i.type))}}const rtt=1952609651,ntt=1;async function itt(r,t,e){if(new Uint32Array(r.slice(0,4))[0]!==rtt)throw new Error("Wrong subtree file magic number");if(new Uint32Array(r.slice(4,8))[0]!==ntt)throw new Error("Wrong subtree file verson, must be 1");const s=HL(r.slice(8,16)),a=new Uint8Array(r,24,s),A=new TextDecoder("utf8").decode(a),f=JSON.parse(A),m=HL(r.slice(16,24));let b=new ArrayBuffer(0);return m&&(b=r.slice(24+s)),"bufferView"in f.tileAvailability&&(f.tileAvailability.explicitBitstream=await jw(f,"tileAvailability",b,e)),"bufferView"in f.contentAvailability&&(f.contentAvailability.explicitBitstream=await jw(f,"contentAvailability",b,e)),"bufferView"in f.childSubtreeAvailability&&(f.childSubtreeAvailability.explicitBitstream=await jw(f,"childSubtreeAvailability",b,e)),f}function stt(r,t){if(t.startsWith("http")){const s=new URL(r,t);return decodeURI(s.toString())}const n="http://".concat(t),i=new URL(r,n);return"/".concat(i.host).concat(i.pathname)}async function jw(r,t,e,n){const i=r[t].bufferView,s=r.bufferViews[i],a=r.buffers[s.buffer];if(!(n!=null&&n.url)||!n.fetch)throw new Error("Url is not provided");if(!n.fetch)throw new Error("fetch is not provided");if(a.uri){const o=stt(a.uri,n==null?void 0:n.url),f=await(await n.fetch(o)).arrayBuffer();return new Uint8Array(f,s.byteOffset,s.byteLength)}return new Uint8Array(e,s.byteOffset,s.byteLength)}function HL(r){const t=new DataView(r),e=t.getUint32(0,!0),n=t.getUint32(4,!0);return e+2**32*n}const zL={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:IL,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:itt,options:{}};/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var sc=null;try{sc=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function $n(r,t,e){this.low=r|0,this.high=t|0,this.unsigned=!!e}$n.prototype.__isLong__,Object.defineProperty($n.prototype,"__isLong__",{value:!0});function lo(r){return(r&&r.__isLong__)===!0}function VL(r){var t=Math.clz32(r&-r);return r?31-t:t}$n.isLong=lo;var jL={},qL={};function kh(r,t){var e,n,i;return t?(r>>>=0,(i=0<=r&&r<256)&&(n=qL[r],n)?n:(e=Rn(r,0,!0),i&&(qL[r]=e),e)):(r|=0,(i=-128<=r&&r<128)&&(n=jL[r],n)?n:(e=Rn(r,r<0?-1:0,!1),i&&(jL[r]=e),e))}$n.fromInt=kh;function oc(r,t){if(isNaN(r))return t?Pu:Vc;if(t){if(r<0)return Pu;if(r>=WL)return ZL}else{if(r<=-$L)return la;if(r+1>=$L)return JL}return r<0?oc(-r,t).neg():Rn(r%hf|0,r/hf|0,t)}$n.fromNumber=oc;function Rn(r,t,e){return new $n(r,t,e)}$n.fromBits=Rn;var sy=Math.pow;function qw(r,t,e){if(r.length===0)throw Error("empty string");if(typeof t=="number"?(e=t,t=!1):t=!!t,r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return t?Pu:Vc;if(e=e||10,e<2||36<e)throw RangeError("radix");var n;if((n=r.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return qw(r.substring(1),t,e).neg();for(var i=oc(sy(e,8)),s=Vc,a=0;a<r.length;a+=8){var o=Math.min(8,r.length-a),A=parseInt(r.substring(a,a+o),e);if(o<8){var f=oc(sy(e,o));s=s.mul(f).add(oc(A))}else s=s.mul(i),s=s.add(oc(A))}return s.unsigned=t,s}$n.fromString=qw;function Gc(r,t){return typeof r=="number"?oc(r,t):typeof r=="string"?qw(r,t):Rn(r.low,r.high,typeof t=="boolean"?t:r.unsigned)}$n.fromValue=Gc;var KL=65536,ott=1<<24,hf=KL*KL,WL=hf*hf,$L=WL/2,XL=kh(ott),Vc=kh(0);$n.ZERO=Vc;var Pu=kh(0,!0);$n.UZERO=Pu;var df=kh(1);$n.ONE=df;var YL=kh(1,!0);$n.UONE=YL;var Kw=kh(-1);$n.NEG_ONE=Kw;var JL=Rn(-1,2147483647,!1);$n.MAX_VALUE=JL;var ZL=Rn(-1,-1,!0);$n.MAX_UNSIGNED_VALUE=ZL;var la=Rn(0,-2147483648,!1);$n.MIN_VALUE=la;var ze=$n.prototype;ze.toInt=function(){return this.unsigned?this.low>>>0:this.low},ze.toNumber=function(){return this.unsigned?(this.high>>>0)*hf+(this.low>>>0):this.high*hf+(this.low>>>0)},ze.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(la)){var e=oc(t),n=this.div(e),i=n.mul(e).sub(this);return n.toString(t)+i.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var s=oc(sy(t,6),this.unsigned),a=this,o="";;){var A=a.div(s),f=a.sub(A.mul(s)).toInt()>>>0,m=f.toString(t);if(a=A,a.isZero())return m+o;for(;m.length<6;)m="0"+m;o=""+m+o}},ze.getHighBits=function(){return this.high},ze.getHighBitsUnsigned=function(){return this.high>>>0},ze.getLowBits=function(){return this.low},ze.getLowBitsUnsigned=function(){return this.low>>>0},ze.getNumBitsAbs=function(){if(this.isNegative())return this.eq(la)?64:this.neg().getNumBitsAbs();for(var t=this.high!=0?this.high:this.low,e=31;e>0&&!(t&1<<e);e--);return this.high!=0?e+33:e+1},ze.isZero=function(){return this.high===0&&this.low===0},ze.eqz=ze.isZero,ze.isNegative=function(){return!this.unsigned&&this.high<0},ze.isPositive=function(){return this.unsigned||this.high>=0},ze.isOdd=function(){return(this.low&1)===1},ze.isEven=function(){return(this.low&1)===0},ze.equals=function(t){return lo(t)||(t=Gc(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low},ze.eq=ze.equals,ze.notEquals=function(t){return!this.eq(t)},ze.neq=ze.notEquals,ze.ne=ze.notEquals,ze.lessThan=function(t){return this.comp(t)<0},ze.lt=ze.lessThan,ze.lessThanOrEqual=function(t){return this.comp(t)<=0},ze.lte=ze.lessThanOrEqual,ze.le=ze.lessThanOrEqual,ze.greaterThan=function(t){return this.comp(t)>0},ze.gt=ze.greaterThan,ze.greaterThanOrEqual=function(t){return this.comp(t)>=0},ze.gte=ze.greaterThanOrEqual,ze.ge=ze.greaterThanOrEqual,ze.compare=function(t){if(lo(t)||(t=Gc(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},ze.comp=ze.compare,ze.negate=function(){return!this.unsigned&&this.eq(la)?la:this.not().add(df)},ze.neg=ze.negate,ze.add=function(t){lo(t)||(t=Gc(t));var e=this.high>>>16,n=this.high&65535,i=this.low>>>16,s=this.low&65535,a=t.high>>>16,o=t.high&65535,A=t.low>>>16,f=t.low&65535,m=0,b=0,x=0,C=0;return C+=s+f,x+=C>>>16,C&=65535,x+=i+A,b+=x>>>16,x&=65535,b+=n+o,m+=b>>>16,b&=65535,m+=e+a,m&=65535,Rn(x<<16|C,m<<16|b,this.unsigned)},ze.subtract=function(t){return lo(t)||(t=Gc(t)),this.add(t.neg())},ze.sub=ze.subtract,ze.multiply=function(t){if(this.isZero())return this;if(lo(t)||(t=Gc(t)),sc){var e=sc.mul(this.low,this.high,t.low,t.high);return Rn(e,sc.get_high(),this.unsigned)}if(t.isZero())return this.unsigned?Pu:Vc;if(this.eq(la))return t.isOdd()?la:Vc;if(t.eq(la))return this.isOdd()?la:Vc;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(XL)&&t.lt(XL))return oc(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,i=this.high&65535,s=this.low>>>16,a=this.low&65535,o=t.high>>>16,A=t.high&65535,f=t.low>>>16,m=t.low&65535,b=0,x=0,C=0,M=0;return M+=a*m,C+=M>>>16,M&=65535,C+=s*m,x+=C>>>16,C&=65535,C+=a*f,x+=C>>>16,C&=65535,x+=i*m,b+=x>>>16,x&=65535,x+=s*f,b+=x>>>16,x&=65535,x+=a*A,b+=x>>>16,x&=65535,b+=n*m+i*f+s*A+a*o,b&=65535,Rn(C<<16|M,b<<16|x,this.unsigned)},ze.mul=ze.multiply,ze.divide=function(t){if(lo(t)||(t=Gc(t)),t.isZero())throw Error("division by zero");if(sc){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var e=(this.unsigned?sc.div_u:sc.div_s)(this.low,this.high,t.low,t.high);return Rn(e,sc.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Pu:Vc;var n,i,s;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return Pu;if(t.gt(this.shru(1)))return YL;s=Pu}else{if(this.eq(la)){if(t.eq(df)||t.eq(Kw))return la;if(t.eq(la))return df;var a=this.shr(1);return n=a.div(t).shl(1),n.eq(Vc)?t.isNegative()?df:Kw:(i=this.sub(t.mul(n)),s=n.add(i.div(t)),s)}else if(t.eq(la))return this.unsigned?Pu:Vc;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();s=Vc}for(i=this;i.gte(t);){n=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),A=o<=48?1:sy(2,o-48),f=oc(n),m=f.mul(t);m.isNegative()||m.gt(i);)n-=A,f=oc(n,this.unsigned),m=f.mul(t);f.isZero()&&(f=df),s=s.add(f),i=i.sub(m)}return s},ze.div=ze.divide,ze.modulo=function(t){if(lo(t)||(t=Gc(t)),sc){var e=(this.unsigned?sc.rem_u:sc.rem_s)(this.low,this.high,t.low,t.high);return Rn(e,sc.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))},ze.mod=ze.modulo,ze.rem=ze.modulo,ze.not=function(){return Rn(~this.low,~this.high,this.unsigned)},ze.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},ze.clz=ze.countLeadingZeros,ze.countTrailingZeros=function(){return this.low?VL(this.low):VL(this.high)+32},ze.ctz=ze.countTrailingZeros,ze.and=function(t){return lo(t)||(t=Gc(t)),Rn(this.low&t.low,this.high&t.high,this.unsigned)},ze.or=function(t){return lo(t)||(t=Gc(t)),Rn(this.low|t.low,this.high|t.high,this.unsigned)},ze.xor=function(t){return lo(t)||(t=Gc(t)),Rn(this.low^t.low,this.high^t.high,this.unsigned)},ze.shiftLeft=function(t){return lo(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?Rn(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):Rn(0,this.low<<t-32,this.unsigned)},ze.shl=ze.shiftLeft,ze.shiftRight=function(t){return lo(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?Rn(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):Rn(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},ze.shr=ze.shiftRight,ze.shiftRightUnsigned=function(t){return lo(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?Rn(this.low>>>t|this.high<<32-t,this.high>>>t,this.unsigned):t===32?Rn(this.high,0,this.unsigned):Rn(this.high>>>t-32,0,this.unsigned)},ze.shru=ze.shiftRightUnsigned,ze.shr_u=ze.shiftRightUnsigned,ze.rotateLeft=function(t){var e;return lo(t)&&(t=t.toInt()),(t&=63)===0?this:t===32?Rn(this.high,this.low,this.unsigned):t<32?(e=32-t,Rn(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned)):(t-=32,e=32-t,Rn(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned))},ze.rotl=ze.rotateLeft,ze.rotateRight=function(t){var e;return lo(t)&&(t=t.toInt()),(t&=63)===0?this:t===32?Rn(this.high,this.low,this.unsigned):t<32?(e=32-t,Rn(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned)):(t-=32,e=32-t,Rn(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned))},ze.rotr=ze.rotateRight,ze.toSigned=function(){return this.unsigned?Rn(this.low,this.high,!1):this},ze.toUnsigned=function(){return this.unsigned?this:Rn(this.low,this.high,!0)},ze.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},ze.toBytesLE=function(){var t=this.high,e=this.low;return[e&255,e>>>8&255,e>>>16&255,e>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]},ze.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,e>>>24,e>>>16&255,e>>>8&255,e&255]},$n.fromBytes=function(t,e,n){return n?$n.fromBytesLE(t,e):$n.fromBytesBE(t,e)},$n.fromBytesLE=function(t,e){return new $n(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},$n.fromBytesBE=function(t,e){return new $n(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)};const att=16;function tF(r){r==="X"&&(r="");const t=r.padEnd(att,"0");return $n.fromString(t,!0,16)}function ctt(r){if(r.isZero())return"X";let t=r.countTrailingZeros();const e=t%4;t=(t-e)/4;const n=t;t*=4;const s=r.shiftRightUnsigned(t).toString(16).replace(/0+$/,"");return Array(17-n-s.length).join("0")+s}function ltt(r,t){const e=utt(r).shiftRightUnsigned(2);return r.add($n.fromNumber(2*t+1-4).multiply(e))}function utt(r){return r.and(r.not().add(1))}const Att=3,htt=2*30+1,eF=180/Math.PI;function dtt(r){if(r.length===0)throw new Error("Invalid Hilbert quad key ".concat(r));const t=r.split("/"),e=parseInt(t[0],10),n=t[1],i=n.length;let s=0;const a=[0,0];for(let o=i-1;o>=0;o--){s=i-o;const A=n[o];let f=0,m=0;A==="1"?m=1:A==="2"?(f=1,m=1):A==="3"&&(f=1);const b=Math.pow(2,s-1);ptt(b,a,f,m),a[0]+=b*f,a[1]+=b*m}if(e%2===1){const o=a[0];a[0]=a[1],a[1]=o}return{face:e,ij:a,level:s}}function ftt(r){if(r.isZero())return"";let t=r.toString(2);for(;t.length<Att+htt;)t="0"+t;const e=t.lastIndexOf("1"),n=t.substring(0,3),i=t.substring(3,e),s=i.length/2,a=$n.fromString(n,!0,2).toString(10);let o="";if(s!==0)for(o=$n.fromString(i,!0,2).toString(4);o.length<s;)o="0"+o;return"".concat(a,"/").concat(o)}function rF(r,t,e){const n=1<<t;return[(r[0]+e[0])/n,(r[1]+e[1])/n]}function nF(r){return r>=.5?1/3*(4*r*r-1):1/3*(1-4*(1-r)*(1-r))}function iF(r){return[nF(r[0]),nF(r[1])]}function sF(r,t){let[e,n]=t;switch(r){case 0:return[1,e,n];case 1:return[-e,1,n];case 2:return[-e,-n,1];case 3:return[-1,-n,-e];case 4:return[n,-1,-e];case 5:return[n,e,-1];default:throw new Error("Invalid face")}}function oF(r){let[t,e,n]=r;const i=Math.atan2(n,Math.sqrt(t*t+e*e));return[Math.atan2(e,t)*eF,i*eF]}function ptt(r,t,e,n){if(n===0){e===1&&(t[0]=r-1-t[0],t[1]=r-1-t[1]);const i=t[0];t[0]=t[1],t[1]=i}}function gtt(r){const t=rF(r.ij,r.level,[.5,.5]),e=iF(t),n=sF(r.face,e);return oF(n)}const mtt=100;function aF(r){const{face:t,ij:e,level:n}=r,i=[[0,0],[0,1],[1,1],[1,0],[0,0]],s=Math.max(1,Math.ceil(mtt*Math.pow(2,-n))),a=new Float64Array(4*s*2+2);let o=0,A=0;for(let f=0;f<4;f++){const m=i[f].slice(0),b=i[f+1],x=(b[0]-m[0])/s,C=(b[1]-m[1])/s;for(let M=0;M<s;M++){m[0]+=x,m[1]+=C;const U=rF(e,n,m),N=iF(U),Q=sF(t,N),q=oF(Q);Math.abs(q[1])>89.999&&(q[0]=A);const Y=q[0]-A;q[0]+=Y>180?-360:Y<-180?360:0,a[o++]=q[0],a[o++]=q[1],A=q[0]}}return a[o++]=a[0],a[o++]=a[1],a}function Ww(r){const t=ytt(r);return dtt(t)}function ytt(r){if(r.indexOf("/")>0)return r;const t=tF(r);return ftt(t)}function _tt(r){const t=Ww(r);return gtt(t)}function vtt(r){let t;if(r.face===2||r.face===5){let e=null,n=0;for(let i=0;i<4;i++){const s="".concat(r.face,"/").concat(i),a=Ww(s),o=aF(a);(typeof e>"u"||e===null)&&(e=new Float64Array(4*o.length)),e.set(o,n),n+=o.length}t=cF(e)}else{const e=aF(r);t=cF(e)}return t}function cF(r){if(r.length%2!==0)throw new Error("Invalid corners");const t=[],e=[];for(let n=0;n<r.length;n+=2)t.push(r[n]),e.push(r[n+1]);return t.sort((n,i)=>n-i),e.sort((n,i)=>n-i),{west:t[0],east:t[t.length-1],north:e[e.length-1],south:e[0]}}function btt(r,t){const e=(t==null?void 0:t.minimumHeight)||0,n=(t==null?void 0:t.maximumHeight)||0,i=Ww(r),s=vtt(i),a=s.west,o=s.south,A=s.east,f=s.north,m=[];return m.push(new le(a,f,e)),m.push(new le(A,f,e)),m.push(new le(A,o,e)),m.push(new le(a,o,e)),m.push(new le(a,f,n)),m.push(new le(A,f,n)),m.push(new le(A,o,n)),m.push(new le(a,o,n)),m}function lF(r){const t=r.token,e={minimumHeight:r.minimumHeight,maximumHeight:r.maximumHeight},n=btt(t,e),i=_tt(t),s=i[0],a=i[1],o=Li.WGS84.cartographicToCartesian([s,a,e.maximumHeight]),A=new le(o[0],o[1],o[2]);n.push(A);const f=t$(n);return[...f.center,...f.halfAxes]}const wtt={QUADTREE:4,OCTREE:8};function xtt(r,t,e){if(r!=null&&r.box){const n=tF(r.s2VolumeInfo.token),i=ltt(n,t),s=ctt(i),a={...r.s2VolumeInfo};switch(a.token=s,e){case"OCTREE":const f=r.s2VolumeInfo,m=f.maximumHeight-f.minimumHeight,b=m/2,x=f.minimumHeight+m/2;f.minimumHeight=x-b,f.maximumHeight=x+b;break}return{box:lF(a),s2VolumeInfo:a}}}async function uF(r){const{options:t,parentData:e={mortonIndex:0,x:0,y:0,z:0},childIndex:n=0,globalData:i={level:0,mortonIndex:0,x:0,y:0,z:0},s2VolumeBox:s}=r;let{subtree:a,level:o=0}=r;const{subdivisionScheme:A,subtreeLevels:f,maximumLevel:m,contentUrlTemplate:b,subtreesUriTemplate:x,basePath:C}=t,M={children:[],lodMetricValue:0,contentUrl:""},U=wtt[A],N=n&1,Q=n>>1&1,q=n>>2&1,Y=(U**o-1)/(U-1);let tt=Nh(e.mortonIndex,n),ft=Y+tt,pt=Nh(e.x,N),mt=Nh(e.y,Q),dt=Nh(e.z,q),Rt=!1;o+1>f&&(Rt=$w(a.childSubtreeAvailability,tt));const Lt=Nh(i.x,pt),st=Nh(i.y,mt),ct=Nh(i.z,dt),wt=o+i.level;if(Rt){const Xt="".concat(C,"/").concat(x),ne=Xw(Xt,wt,Lt,st,ct);a=await bA(ne,zL),i.mortonIndex=tt,i.x=pt,i.y=mt,i.z=dt,i.level=o,tt=0,ft=0,pt=0,mt=0,dt=0,o=0}if(!$w(a.tileAvailability,ft)||o>m)return M;$w(a.contentAvailability,ft)&&(M.contentUrl=Xw(b,wt,Lt,st,ct));const Zt=o+1,re={mortonIndex:tt,x:pt,y:mt,z:dt};for(let Xt=0;Xt<U;Xt++){const ne=xtt(s,Xt,A),se=await uF({subtree:a,options:t,parentData:re,childIndex:Xt,level:Zt,globalData:i,s2VolumeBox:ne});if(se.contentUrl||se.children.length){const we=wt+1,vt=Btt(se,we,{childTileX:pt,childTileY:mt,childTileZ:dt},t,s);M.children.push(vt)}}return M}function $w(r,t){return"constant"in r?!!r.constant:r.explicitBitstream?Stt(t,r.explicitBitstream):!1}function Btt(r,t,e,n,i){const{basePath:s,refine:a,getRefine:o,lodMetricType:A,getTileType:f,rootLodMetricValue:m,rootBoundingVolume:b}=n,x=r.contentUrl&&r.contentUrl.replace("".concat(s,"/"),""),C=m/2**t,M=i!=null&&i.box?{box:i.box}:b,U=Ctt(t,M,e);return{children:r.children,contentUrl:r.contentUrl,content:{uri:x},id:r.contentUrl,refine:o(a),type:f(r),lodMetricType:A,lodMetricValue:C,geometricError:C,transform:r.transform,boundingVolume:U}}function Ctt(r,t,e){if(t.region){const{childTileX:n,childTileY:i,childTileZ:s}=e,[a,o,A,f,m,b]=t.region,x=2**r,C=(A-a)/x,M=(f-o)/x,U=(b-m)/x,[N,Q]=[a+C*n,a+C*(n+1)],[q,Y]=[o+M*i,o+M*(i+1)],[tt,ft]=[m+U*s,m+U*(s+1)];return{region:[N,q,Q,Y,tt,ft]}}if(t.box)return t;throw new Error("Unsupported bounding volume type ".concat(t))}function Nh(r,t){return parseInt(r.toString(2)+t.toString(2),2)}function Xw(r,t,e,n,i){const s=Ett({level:t,x:e,y:n,z:i});return r.replace(/{level}|{x}|{y}|{z}/gi,a=>s[a])}function Ett(r){const t={};for(const e in r)t["{".concat(e,"}")]=r[e];return t}function Stt(r,t){const e=Math.floor(r/8),n=r%8;return(t[e]>>n&1)===1}function Yw(r){if(!r.contentUrl)return uf.EMPTY;const e=r.contentUrl.split("?")[0].split(".").pop();switch(e){case"pnts":return uf.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return uf.SCENEGRAPH;default:return e}}function Jw(r){switch(r){case"REPLACE":case"replace":return Mu.REPLACE;case"ADD":case"add":return Mu.ADD;default:return r}}function Zw(r,t){if(/^[a-z][0-9a-z+.-]*:/i.test(t)){const n=new URL(r,"".concat(t,"/"));return decodeURI(n.toString())}else if(r.startsWith("/"))return r;return"".concat(t,"/").concat(r)}function AF(r,t){if(!r)return null;if(r.content){const e=r.content.uri||r.content.url;r.contentUrl=Zw(e,t.basePath)}return r.id=r.contentUrl,r.lodMetricType=Z0.GEOMETRIC_ERROR,r.lodMetricValue=r.geometricError,r.transformMatrix=r.transform,r.type=Yw(r),r.refine=Jw(r.refine),r}async function Ttt(r,t){const e=r.basePath;let n;const i=dF(r==null?void 0:r.root);i&&r.root?n=await hF(r.root,r,i,t):n=AF(r.root,r);const s=[];for(s.push(n);s.length>0;){const o=(s.pop()||{}).children||[];for(let A of o){const f=dF(A);f?A=await hF(A,r,f,t):AF(A,{basePath:e}),s.push(A)}}return n}async function hF(r,t,e,n){var i,s;const a=t.basePath,{subdivisionScheme:o,maximumLevel:A,subtreeLevels:f,subtrees:{uri:m}}=e,b=Xw(m,0,0,0,0),x=Zw(b,a),C=await bA(x,zL,n),M=Zw(r.content.uri,a),U=t==null||(i=t.root)===null||i===void 0?void 0:i.refine,N=r.geometricError,Q=(s=r.boundingVolume.extensions)===null||s===void 0?void 0:s["3DTILES_bounding_volume_S2"];if(Q){const ft={box:lF(Q),s2VolumeInfo:Q};r.boundingVolume=ft}const q=r.boundingVolume,Y={contentUrlTemplate:M,subtreesUriTemplate:m,subdivisionScheme:o,subtreeLevels:f,maximumLevel:A,refine:U,basePath:a,lodMetricType:Z0.GEOMETRIC_ERROR,rootLodMetricValue:N,rootBoundingVolume:q,getTileType:Yw,getRefine:Jw};return await Itt(r,C,Y)}async function Itt(r,t,e){if(!r)return null;r.lodMetricType=Z0.GEOMETRIC_ERROR,r.lodMetricValue=r.geometricError,r.transformMatrix=r.transform;const{children:n,contentUrl:i}=await uF({subtree:t,options:e,s2VolumeBox:r});return i&&(r.contentUrl=i,r.content={uri:i.replace("".concat(e.basePath,"/"),"")}),r.refine=Jw(r.refine),r.type=Yw(r),r.children=n,r.id=r.contentUrl,r}function dF(r){var t;return(r==null||(t=r.extensions)===null||t===void 0?void 0:t["3DTILES_implicit_tiling"])||(r==null?void 0:r.implicitTiling)}const t2={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:IL,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:Ptt,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};function Ltt(r){return lv(r.url)}async function Ftt(r,t,e){const n={content:{featureIds:null}};return await QL(r,0,t,e,n.content),n.content}async function Mtt(r,t,e){var n;const i=JSON.parse(new TextDecoder().decode(r));return i.loader=t.loader||t2,i.url=e.url,i.queryString=e.queryString,i.basePath=Ltt(i),i.root=await Ttt(i,t),i.type=ic.TILES3D,i.lodMetricType=Z0.GEOMETRIC_ERROR,i.lodMetricValue=((n=i.root)===null||n===void 0?void 0:n.lodMetricValue)||0,i}async function Ptt(r,t,e){const n=t["3d-tiles"]||{};let i;return n.isTileset==="auto"?i=e.url&&e.url.indexOf(".json")!==-1:i=n.isTileset,i?r=await Mtt(r,t,e):r=await Ftt(r,t,e),r}const fF=[0],Utt={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:"",loader:t2,onTilesetLoad:{type:"function",value:r=>{}},onTileLoad:{type:"function",value:r=>{}},onTileUnload:{type:"function",value:r=>{}},onTileError:{type:"function",value:(r,t,e)=>{}},_getMeshColor:{type:"function",value:r=>[255,255,255]}};class e2 extends Y3{constructor(){super(...arguments),W(this,"state",void 0)}initializeState(){"onTileLoadFail"in this.props&&Fn.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){var t,e;return!!(!((t=this.state)===null||t===void 0||(e=t.tileset3d)===null||e===void 0)&&e.isLoaded()&&super.isLoaded)}shouldUpdateState(t){let{changeFlags:e}=t;return e.somethingChanged}updateState(t){let{props:e,oldProps:n,changeFlags:i}=t;if(e.data&&e.data!==n.data&&this._loadTileset(e.data),i.viewportChanged){const{activeViewports:s}=this.state;Object.keys(s).length&&(this._updateTileset(s),this.state.lastUpdatedViewports=s,this.state.activeViewports={})}if(i.propsChanged){const{layerMap:s}=this.state;for(const a in s)s[a].needsUpdate=!0}}activateViewport(t){const{activeViewports:e,lastUpdatedViewports:n}=this.state;this.internalState.viewport=t,e[t.id]=t;const i=n==null?void 0:n[t.id];(!i||!t.equals(i))&&(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo(t){let{info:e,sourceLayer:n}=t;const i=n&&n.props.tile;return e.picked&&(e.object=i),e.sourceTile=i,e}filterSubLayer(t){let{layer:e,viewport:n}=t;const{tile:i}=e.props,{id:s}=n;return i.selected&&i.viewportIds.includes(s)}_updateAutoHighlight(t){const e=t.sourceTile,n=this.state.layerMap[e==null?void 0:e.id];n&&n.layer&&n.layer.updateAutoHighlight(t)}async _loadTileset(t){const{loadOptions:e={}}=this.props;let n=this.props.loader||this.props.loaders;Array.isArray(n)&&(n=n[0]);const i={loadOptions:{...e}};let s=t;if(n.preload){const A=await n.preload(t,e);A.url&&(s=A.url),A.headers&&(i.loadOptions.fetch={...i.loadOptions.fetch,headers:A.headers}),Object.assign(i,A)}const a=await bA(s,n,i.loadOptions),o=new gZ(a,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError,...i});this.setState({tileset3d:o,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(o)}_onTileLoad(t){const{lastUpdatedViewports:e}=this.state;this.props.onTileLoad(t),this._updateTileset(e),this.setNeedsUpdate()}_onTileUnload(t){delete this.state.layerMap[t.id],this.props.onTileUnload(t)}_updateTileset(t){if(!t)return;const{tileset3d:e}=this.state,{timeline:n}=this.context,i=Object.keys(t).length;!n||!i||!e||e.selectTiles(Object.values(t)).then(s=>{this.state.frameNumber!==s&&this.setState({frameNumber:s})})}_getSubLayer(t,e){if(!t.content)return null;switch(t.type){case uf.POINTCLOUD:return this._makePointCloudLayer(t,e);case uf.SCENEGRAPH:return this._make3DModelLayer(t);case uf.MESH:return this._makeSimpleMeshLayer(t,e);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(t.content.type))}}_makePointCloudLayer(t,e){const{attributes:n,pointCount:i,constantRGBA:s,cartographicOrigin:a,modelMatrix:o}=t.content,{positions:A,normals:f,colors:m}=n;if(!A)return null;const b=e&&e.props.data||{header:{vertexCount:i},attributes:{POSITION:A,NORMAL:f,COLOR_0:m}},{pointSize:x,getPointColor:C}=this.props,M=this.getSubLayerClass("pointcloud",sw);return new M({pointSize:x},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(t.id),tile:t,data:b,coordinateSystem:Sn.METER_OFFSETS,coordinateOrigin:a,modelMatrix:o,getColor:s||C,_offset:0})}_make3DModelLayer(t){const{gltf:e,instances:n,cartographicOrigin:i,modelMatrix:s}=t.content,a=this.getSubLayerClass("scenegraph",Bw);return new a({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(t.id),tile:t,data:n||fF,scenegraph:e,coordinateSystem:Sn.METER_OFFSETS,coordinateOrigin:i,modelMatrix:s,getTransformMatrix:o=>o.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(t,e){const n=t.content,{attributes:i,indices:s,modelMatrix:a,cartographicOrigin:o,coordinateSystem:A=Sn.METER_OFFSETS,material:f,featureIds:m}=n,{_getMeshColor:b}=this.props,x=e&&e.props.mesh||new rg({drawMode:4,attributes:Rtt(i),indices:s}),C=this.getSubLayerClass("mesh",Cw);return new C(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(t.id),tile:t,mesh:x,data:fF,getColor:b(t),pbrMaterial:f,modelMatrix:a,coordinateOrigin:o,coordinateSystem:A,featureIds:m,_offset:0})}renderLayers(){const{tileset3d:t,layerMap:e}=this.state;return t?t.tiles.map(n=>{const i=e[n.id]=e[n.id]||{tile:n};let{layer:s}=i;return n.selected&&(s?i.needsUpdate&&(s=this._getSubLayer(n,s),i.needsUpdate=!1):s=this._getSubLayer(n)),i.layer=s,s}).filter(Boolean):null}}W(e2,"defaultProps",Utt),W(e2,"layerName","Tile3DLayer");function Rtt(r){const t={};return t.positions={...r.positions,value:new Float32Array(r.positions.value)},r.normals&&(t.normals=r.normals),r.texCoords&&(t.texCoords=r.texCoords),r.colors&&(t.colors=r.colors),r.uvRegions&&(t.uvRegions=r.uvRegions),t}var Ott=Object.defineProperty,Dtt=(r,t,e)=>t in r?Ott(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Vn=(r,t,e)=>(Dtt(r,typeof t!="symbol"?t+"":t,e),e);let ktt=class{constructor(t){Vn(this,"map"),Vn(this,"width"),Vn(this,"height"),Vn(this,"svgCanvas"),Vn(this,"xLine"),Vn(this,"yLine"),Vn(this,"color","#535353"),this.map=t,this.mapResize=this.mapResize.bind(this)}create(){this.updateValues(),this.map!==void 0?(this.map.on("resize",this.mapResize),this.createCanvas(this.map.getCanvasContainer())):console.error("map object is null")}updateValues(){var t,e;this.width=(t=this.map)==null?void 0:t.getCanvas().clientWidth,this.height=(e=this.map)==null?void 0:e.getCanvas().clientHeight}mapResize(){this.updateValues(),this.updateCanvas()}updateCanvas(){if(this.svgCanvas!==void 0&&this.yLine!==void 0&&this.xLine!==void 0&&this.width!==void 0&&this.height!==void 0){this.svgCanvas.setAttribute("width",`${this.width}px`),this.svgCanvas.setAttribute("height",`${this.height}px`);const t=this.width/2,e=this.height/2;this.yLine.setAttribute("x1",`${t}px`),this.yLine.setAttribute("y1","0px"),this.yLine.setAttribute("x2",`${t}px`),this.yLine.setAttribute("y2",`${this.height}px`),this.xLine.setAttribute("x1","0px"),this.xLine.setAttribute("y1",`${e}px`),this.xLine.setAttribute("x2",`${this.width}px`),this.xLine.setAttribute("y2",`${e}px`)}else console.error("element value is null")}createCanvas(t){if(this.width!==void 0&&this.height!==void 0){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.style.position="relative",e.setAttribute("width",`${this.width}px`),e.setAttribute("height",`${this.height}px`);const n=this.width/2,i=this.height/2;this.yLine=e.appendChild(this.createLine(n,0,n,this.height,this.color,"2px")),this.xLine=e.appendChild(this.createLine(0,i,this.width,i,this.color,"2px")),t==null||t.appendChild(e),this.svgCanvas=e}}createLine(t,e,n,i,s,a){const o=document.createElementNS("http://www.w3.org/2000/svg","line");return o.setAttribute("x1",t),o.setAttribute("y1",e),o.setAttribute("x2",n),o.setAttribute("y2",i),o.setAttribute("stroke-dasharray","5,5"),o.setAttribute("stroke",s),o.setAttribute("stroke-width",a),o}destroy(){this.xLine!==void 0&&(this.xLine.remove(),this.xLine=void 0),this.yLine!==void 0&&(this.yLine.remove(),this.yLine=void 0),this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map.off("resize",this.mapResize),this.map=void 0)}};const r2={72:72,96:96,200:200,300:300,400:400},Uu={JPEG:"jpg",PNG:"png",PDF:"pdf",SVG:"svg"},xg={Landscape:"landscape",Portrait:"portrait"},Qh={LETTER:[279,216],A2:[594,420],A3:[420,297],A4:[297,210],A5:[210,148],A6:[148,105],B2:[707,500],B3:[500,353],B4:[353,250],B5:[250,176],B6:[176,125]},ff={in:"in",mm:"mm"};let Ntt=class{constructor(t){Vn(this,"map"),Vn(this,"width"),Vn(this,"height"),Vn(this,"unit"),Vn(this,"svgCanvas"),Vn(this,"svgPath");var e,n,i;if(this.map=t,this.map===void 0)return;this.mapResize=this.mapResize.bind(this),this.map.on("resize",this.mapResize);const s=(e=this.map)==null?void 0:e.getCanvas().clientWidth,a=(n=this.map)==null?void 0:n.getCanvas().clientHeight,o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.style.position="absolute",o.style.top="0px",o.style.left="0px",o.setAttribute("width",`${s}px`),o.setAttribute("height",`${a}px`);const A=document.createElementNS("http://www.w3.org/2000/svg","path");A.setAttribute("style","fill:#888888;stroke-width:0"),A.setAttribute("fill-opacity","0.5"),o.append(A),(i=this.map)==null||i.getCanvasContainer().appendChild(o),this.svgCanvas=o,this.svgPath=A}mapResize(){this.generateCutOut()}updateArea(t,e){this.width=t,this.height=e,this.unit=ff.mm,this.generateCutOut()}generateCutOut(){var t,e;if(this.map===void 0||this.svgCanvas===void 0||this.svgPath===void 0)return;const n=this.toPixels(this.width),i=this.toPixels(this.height),s=(t=this.map)==null?void 0:t.getCanvas().clientWidth,a=(e=this.map)==null?void 0:e.getCanvas().clientHeight,o=s/2-n/2,A=o+n,f=a/2-i/2,m=f+i;this.svgCanvas.setAttribute("width",`${s}px`),this.svgCanvas.setAttribute("height",`${a}px`),this.svgPath.setAttribute("d",`M 0 0 L ${s} 0 L ${s} ${a} L 0 ${a} M ${o} ${f} L ${o} ${m} L ${A} ${m} L ${A} ${f}`)}destroy(){this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map=void 0)}toPixels(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:96;return this.unit===ff.mm&&(e/=25.4),e*t}};const pF={PageSize:"Page Size",PageOrientation:"Page Orientation",Format:"Format",DPI:"DPI",Generate:"Generate",LanguageName:"English"},Qtt={PageSize:"Taille de page",PageOrientation:"Orientation de la page",Format:"Format",DPI:"DPI",Generate:"Gnrer",LanguageName:"French"},Htt={PageSize:"Sivukoko",PageOrientation:"Sivun suunta",Format:"Muoto",DPI:"DPI",Generate:"Generoi",LanguageName:"Finish"},ztt={PageSize:"Papierformat",PageOrientation:"Papierausrichtung",Format:"Dateiformat",DPI:"Druckauflsung",Generate:"Erstellen",LanguageName:"German"},Gtt={PageSize:"Sidstorlek",PageOrientation:"Sidorientering",Format:"Format",DPI:"DPI",Generate:"Generera",LanguageName:"Swedish"},Vtt={PageSize:"Tamao de pgina",PageOrientation:"Orientacin de pgina",Format:"Formato",DPI:"DPI",Generate:"Generar",LanguageName:"Spanish"},jtt={PageSize:"Kch thc trang",PageOrientation:"Loi trang",Format:"nh dng",DPI:"Mt  im nh (DPI)",Generate:"To",LanguageName:"Vietnam"},qtt={PageSize:" ",PageOrientation:" ",Format:"",DPI:"DPI",Generate:"",LanguageName:"Ukranian"},Ktt={PageSize:"",PageOrientation:"",Format:"",DPI:"",Generate:"",LanguageName:"Chinese simplified"},Wtt={PageSize:"",PageOrientation:"",Format:"",DPI:"",Generate:"",LanguageName:"Chinese traditional"},$tt={PageSize:"",PageOrientation:"",Format:"",DPI:"DPI",Generate:"",LanguageName:"Japanese"},Xtt=r=>{switch(r){case"de":return ztt;case"en":return pF;case"fr":return Qtt;case"fi":return Htt;case"sv":return Gtt;case"es":return Vtt;case"vi":return jtt;case"uk":return qtt;case"zhHans":return Ktt;case"zhHant":return Wtt;case"ja":return $tt;default:return pF}};(function(r){var t={};function e(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return r[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=r,e.c=t,e.d=function(n,i,s){e.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:s})},e.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,i){if(1&i&&(n=e(n)),8&i||4&i&&typeof n=="object"&&n&&n.__esModule)return n;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:n}),2&i&&typeof n!="string")for(var a in n)e.d(s,a,(function(o){return n[o]}).bind(null,a));return s},e.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(i,"a",i),i},e.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)},e.p="",e(e.s=0)})([function(r,t,e){r.exports=e(1)},function(r,t){function e(i,s){for(var a=0;a<s.length;a++){var o=s[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(i,o.key,o)}}var n=function(){function i(){(function(o,A){if(!(o instanceof A))throw new TypeError("Cannot call a class as a function")})(this,i),this.options={overlayBackgroundColor:"#666666",overlayOpacity:.6,spinnerIcon:"ball-circus",spinnerColor:"#000",spinnerSize:"3x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetY:0,offsetX:0,lockScroll:!1,containerID:null,spinnerZIndex:99999,overlayZIndex:99998},this.stylesheetBaseURL="https://cdn.jsdelivr.net/npm/load-awesome@1.1.0/css/",this.spinner=null,this.spinnerStylesheetURL=null,this.numberOfEmptyDivForSpinner={"ball-8bits":16,"ball-atom":4,"ball-beat":3,"ball-circus":5,"ball-climbing-dot":1,"ball-clip-rotate":1,"ball-clip-rotate-multiple":2,"ball-clip-rotate-pulse":2,"ball-elastic-dots":5,"ball-fall":3,"ball-fussion":4,"ball-grid-beat":9,"ball-grid-pulse":9,"ball-newton-cradle":4,"ball-pulse":3,"ball-pulse-rise":5,"ball-pulse-sync":3,"ball-rotate":1,"ball-running-dots":5,"ball-scale":1,"ball-scale-multiple":3,"ball-scale-pulse":2,"ball-scale-ripple":1,"ball-scale-ripple-multiple":3,"ball-spin":8,"ball-spin-clockwise":8,"ball-spin-clockwise-fade":8,"ball-spin-clockwise-fade-rotating":8,"ball-spin-fade":8,"ball-spin-fade-rotating":8,"ball-spin-rotate":2,"ball-square-clockwise-spin":8,"ball-square-spin":8,"ball-triangle-path":3,"ball-zig-zag":2,"ball-zig-zag-deflect":2,cog:1,"cube-transition":2,fire:3,"line-scale":5,"line-scale-party":5,"line-scale-pulse-out":5,"line-scale-pulse-out-rapid":5,"line-spin-clockwise-fade":8,"line-spin-clockwise-fade-rotating":8,"line-spin-fade":8,"line-spin-fade-rotating":8,pacman:6,"square-jelly-box":2,"square-loader":1,"square-spin":1,timer:1,"triangle-skew-spin":1}}var s,a;return s=i,(a=[{key:"show",value:function(o){this.setOptions(o),this.addSpinnerStylesheet(),this.generateSpinnerElement(),this.options.lockScroll&&(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"),this.generateAndAddOverlayElement()}},{key:"hide",value:function(){this.options.lockScroll&&(document.body.style.overflow="",document.documentElement.style.overflow="");var o=document.getElementById("loading-overlay-stylesheet");o&&(o.disabled=!0,o.parentNode.removeChild(o),document.getElementById(this.options.overlayIDName).remove(),document.getElementById(this.options.spinnerIDName).remove())}},{key:"setOptions",value:function(o){if(o!==void 0)for(var A in o)this.options[A]=o[A]}},{key:"generateAndAddOverlayElement",value:function(){var o="50%";this.options.offsetX!==0&&(o="calc(50% + "+this.options.offsetX+")");var A="50%";if(this.options.offsetY!==0&&(A="calc(50% + "+this.options.offsetY+")"),this.options.containerID&&document.body.contains(document.getElementById(this.options.containerID))){var f='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: absolute; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,'; z-index: 50; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: absolute; top: ').concat(A,"; left: ").concat(o,'; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: 9999;">').concat(this.spinner,"</div>"),m=document.getElementById(this.options.containerID);return m.style.position="relative",void m.insertAdjacentHTML("beforeend",f)}var b='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: fixed; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,"; z-index: ").concat(this.options.overlayZIndex,'; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: fixed; top: ').concat(A,"; left: ").concat(o,"; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: ").concat(this.options.spinnerZIndex,';">').concat(this.spinner,"</div>");document.body.insertAdjacentHTML("beforeend",b)}},{key:"generateSpinnerElement",value:function(){var o=this,A=Object.keys(this.numberOfEmptyDivForSpinner).find(function(m){return m===o.options.spinnerIcon}),f=this.generateEmptyDivElement(this.numberOfEmptyDivForSpinner[A]);this.spinner='<div style="color: '.concat(this.options.spinnerColor,'" class="la-').concat(this.options.spinnerIcon," la-").concat(this.options.spinnerSize,'">').concat(f,"</div>")}},{key:"addSpinnerStylesheet",value:function(){this.setSpinnerStylesheetURL();var o=document.createElement("link");o.setAttribute("id","loading-overlay-stylesheet"),o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",this.spinnerStylesheetURL),document.getElementsByTagName("head")[0].appendChild(o)}},{key:"setSpinnerStylesheetURL",value:function(){this.spinnerStylesheetURL=this.stylesheetBaseURL+this.options.spinnerIcon+".min.css"}},{key:"generateEmptyDivElement",value:function(o){for(var A="",f=1;f<=o;f++)A+="<div></div>";return A}}])&&e(s.prototype,a),i}();window.JsLoadingOverlay=new n,r.exports=JsLoadingOverlay}]);function On(r){"@babel/helpers - typeof";return On=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},On(r)}var Po=Uint8Array,Uo=Uint16Array,Bg=Uint32Array,oy=new Po([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ay=new Po([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),n2=new Po([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),gF=function(r,t){for(var e=new Uo(31),n=0;n<31;++n)e[n]=t+=1<<r[n-1];for(var i=new Bg(e[30]),n=1;n<30;++n)for(var s=e[n];s<e[n+1];++s)i[s]=s-e[n]<<5|n;return[e,i]},mF=gF(oy,2),yF=mF[0],i2=mF[1];yF[28]=258,i2[258]=28;for(var _F=gF(ay,0),Ytt=_F[0],vF=_F[1],s2=new Uo(32768),vi=0;vi<32768;++vi){var UA=(vi&43690)>>>1|(vi&21845)<<1;UA=(UA&52428)>>>2|(UA&13107)<<2,UA=(UA&61680)>>>4|(UA&3855)<<4,s2[vi]=((UA&65280)>>>8|(UA&255)<<8)>>>1}for(var jl=function(r,t,e){for(var n=r.length,i=0,s=new Uo(t);i<n;++i)++s[r[i]-1];var a=new Uo(t);for(i=0;i<t;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(e){o=new Uo(1<<t);var A=15-t;for(i=0;i<n;++i)if(r[i])for(var f=i<<4|r[i],m=t-r[i],b=a[r[i]-1]++<<m,x=b|(1<<m)-1;b<=x;++b)o[s2[b]>>>A]=f}else for(o=new Uo(n),i=0;i<n;++i)o[i]=s2[a[r[i]-1]++]>>>15-r[i];return o},RA=new Po(288),vi=0;vi<144;++vi)RA[vi]=8;for(var vi=144;vi<256;++vi)RA[vi]=9;for(var vi=256;vi<280;++vi)RA[vi]=7;for(var vi=280;vi<288;++vi)RA[vi]=8;for(var Cg=new Po(32),vi=0;vi<32;++vi)Cg[vi]=5;var Jtt=jl(RA,9,0),Ztt=jl(RA,9,1),tet=jl(Cg,5,0),eet=jl(Cg,5,1),o2=function(r){for(var t=r[0],e=1;e<r.length;++e)r[e]>t&&(t=r[e]);return t},jc=function(r,t,e){var n=t/8>>0;return(r[n]|r[n+1]<<8)>>>(t&7)&e},a2=function(r,t){var e=t/8>>0;return(r[e]|r[e+1]<<8|r[e+2]<<16)>>>(t&7)},c2=function(r){return(r/8>>0)+(r&7&&1)},bF=function(r,t,e){(t==null||t<0)&&(t=0),(e==null||e>r.length)&&(e=r.length);var n=new(r instanceof Uo?Uo:r instanceof Bg?Bg:Po)(e-t);return n.set(r.subarray(t,e)),n},ret=function(r,t,e){var n=r.length,i=!t||e,s=!e||e.i;e||(e={}),t||(t=new Po(n*3));var a=function(Wt){var jt=t.length;if(Wt>jt){var ae=new Po(Math.max(jt*2,Wt));ae.set(t),t=ae}},o=e.f||0,A=e.p||0,f=e.b||0,m=e.l,b=e.d,x=e.m,C=e.n,M=n*8;do{if(!m){e.f=o=jc(r,A,1);var U=jc(r,A+1,3);if(A+=3,U)if(U==1)m=Ztt,b=eet,x=9,C=5;else if(U==2){var N=jc(r,A,31)+257,Q=jc(r,A+10,15)+4,q=N+jc(r,A+5,31)+1;A+=14;for(var Y=new Po(q),tt=new Po(19),ft=0;ft<Q;++ft)tt[n2[ft]]=jc(r,A+ft*3,7);A+=Q*3;var pt=o2(tt),mt=(1<<pt)-1;if(!s&&A+q*(pt+7)>M)break;for(var dt=jl(tt,pt,1),ft=0;ft<q;){var Rt=dt[jc(r,A,mt)];A+=Rt&15;var Lt=Rt>>>4;if(Lt<16)Y[ft++]=Lt;else{var st=0,ct=0;for(Lt==16?(ct=3+jc(r,A,3),A+=2,st=Y[ft-1]):Lt==17?(ct=3+jc(r,A,7),A+=3):Lt==18&&(ct=11+jc(r,A,127),A+=7);ct--;)Y[ft++]=st}}var wt=Y.subarray(0,N),yt=Y.subarray(N);x=o2(wt),C=o2(yt),m=jl(wt,x,1),b=jl(yt,C,1)}else throw"invalid block type";else{var Lt=c2(A)+4,te=r[Lt-4]|r[Lt-3]<<8,Zt=Lt+te;if(Zt>n){if(s)throw"unexpected EOF";break}i&&a(f+te),t.set(r.subarray(Lt,Zt),f),e.b=f+=te,e.p=A=Zt*8;continue}if(A>M)throw"unexpected EOF"}i&&a(f+131072);for(var re=(1<<x)-1,Xt=(1<<C)-1,ne=x+C+18;s||A+ne<M;){var st=m[a2(r,A)&re],se=st>>>4;if(A+=st&15,A>M)throw"unexpected EOF";if(!st)throw"invalid length/literal";if(se<256)t[f++]=se;else if(se==256){m=null;break}else{var we=se-254;if(se>264){var ft=se-257,it=oy[ft];we=jc(r,A,(1<<it)-1)+yF[ft],A+=it}var vt=b[a2(r,A)&Xt],Ft=vt>>>4;if(!vt)throw"invalid distance";A+=vt&15;var yt=Ytt[Ft];if(Ft>3){var it=ay[Ft];yt+=a2(r,A)&(1<<it)-1,A+=it}if(A>M)throw"unexpected EOF";i&&a(f+131072);for(var Ot=f+we;f<Ot;f+=4)t[f]=t[f-yt],t[f+1]=t[f+1-yt],t[f+2]=t[f+2-yt],t[f+3]=t[f+3-yt];f=Ot}}e.l=m,e.p=A,e.b=f,m&&(o=1,e.m=x,e.d=b,e.n=C)}while(!o);return f==t.length?t:bF(t,0,f)},Ru=function(r,t,e){e<<=t&7;var n=t/8>>0;r[n]|=e,r[n+1]|=e>>>8},Eg=function(r,t,e){e<<=t&7;var n=t/8>>0;r[n]|=e,r[n+1]|=e>>>8,r[n+2]|=e>>>16},l2=function(r,t){for(var e=[],n=0;n<r.length;++n)r[n]&&e.push({s:n,f:r[n]});var i=e.length,s=e.slice();if(!i)return[new Po(0),0];if(i==1){var a=new Po(e[0].s+1);return a[e[0].s]=1,[a,1]}e.sort(function(ft,pt){return ft.f-pt.f}),e.push({s:-1,f:25001});var o=e[0],A=e[1],f=0,m=1,b=2;for(e[0]={s:-1,f:o.f+A.f,l:o,r:A};m!=i-1;)o=e[e[f].f<e[b].f?f++:b++],A=e[f!=m&&e[f].f<e[b].f?f++:b++],e[m++]={s:-1,f:o.f+A.f,l:o,r:A};for(var x=s[0].s,n=1;n<i;++n)s[n].s>x&&(x=s[n].s);var C=new Uo(x+1),M=u2(e[m-1],C,0);if(M>t){var n=0,U=0,N=M-t,Q=1<<N;for(s.sort(function(pt,mt){return C[mt.s]-C[pt.s]||pt.f-mt.f});n<i;++n){var q=s[n].s;if(C[q]>t)U+=Q-(1<<M-C[q]),C[q]=t;else break}for(U>>>=N;U>0;){var Y=s[n].s;C[Y]<t?U-=1<<t-C[Y]++-1:++n}for(;n>=0&&U;--n){var tt=s[n].s;C[tt]==t&&(--C[tt],++U)}M=t}return[new Po(C),M]},u2=function(r,t,e){return r.s==-1?Math.max(u2(r.l,t,e+1),u2(r.r,t,e+1)):t[r.s]=e},wF=function(r){for(var t=r.length;t&&!r[--t];);for(var e=new Uo(++t),n=0,i=r[0],s=1,a=function(A){e[n++]=A},o=1;o<=t;++o)if(r[o]==i&&o!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=r[o]}return[e.subarray(0,n),t]},Sg=function(r,t){for(var e=0,n=0;n<t.length;++n)e+=r[n]*t[n];return e},cy=function(r,t,e){var n=e.length,i=c2(t+2);r[i]=n&255,r[i+1]=n>>>8,r[i+2]=r[i]^255,r[i+3]=r[i+1]^255;for(var s=0;s<n;++s)r[i+s+4]=e[s];return(i+4+n)*8},xF=function(r,t,e,n,i,s,a,o,A,f,m){Ru(t,m++,e),++i[256];for(var b=l2(i,15),x=b[0],C=b[1],M=l2(s,15),U=M[0],N=M[1],Q=wF(x),q=Q[0],Y=Q[1],tt=wF(U),ft=tt[0],pt=tt[1],mt=new Uo(19),dt=0;dt<q.length;++dt)mt[q[dt]&31]++;for(var dt=0;dt<ft.length;++dt)mt[ft[dt]&31]++;for(var Rt=l2(mt,7),Lt=Rt[0],st=Rt[1],ct=19;ct>4&&!Lt[n2[ct-1]];--ct);var wt=f+5<<3,yt=Sg(i,RA)+Sg(s,Cg)+a,te=Sg(i,x)+Sg(s,U)+a+14+3*ct+Sg(mt,Lt)+(2*mt[16]+3*mt[17]+7*mt[18]);if(wt<=yt&&wt<=te)return cy(t,m,r.subarray(A,A+f));var Zt,re,Xt,ne;if(Ru(t,m,1+(te<yt)),m+=2,te<yt){Zt=jl(x,C,0),re=x,Xt=jl(U,N,0),ne=U;var se=jl(Lt,st,0);Ru(t,m,Y-257),Ru(t,m+5,pt-1),Ru(t,m+10,ct-4),m+=14;for(var dt=0;dt<ct;++dt)Ru(t,m+3*dt,Lt[n2[dt]]);m+=3*ct;for(var we=[q,ft],it=0;it<2;++it)for(var vt=we[it],dt=0;dt<vt.length;++dt){var Ft=vt[dt]&31;Ru(t,m,se[Ft]),m+=Lt[Ft],Ft>15&&(Ru(t,m,vt[dt]>>>5&127),m+=vt[dt]>>>12)}}else Zt=Jtt,re=RA,Xt=tet,ne=Cg;for(var dt=0;dt<o;++dt)if(n[dt]>255){var Ft=n[dt]>>>18&31;Eg(t,m,Zt[Ft+257]),m+=re[Ft+257],Ft>7&&(Ru(t,m,n[dt]>>>23&31),m+=oy[Ft]);var Ot=n[dt]&31;Eg(t,m,Xt[Ot]),m+=ne[Ot],Ot>3&&(Eg(t,m,n[dt]>>>5&8191),m+=ay[Ot])}else Eg(t,m,Zt[n[dt]]),m+=re[n[dt]];return Eg(t,m,Zt[256]),m+re[256]},net=new Bg([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),iet=new Po(0),set=function(r,t,e,n,i,s){var a=r.length,o=new Po(n+a+5*(1+Math.floor(a/7e3))+i),A=o.subarray(n,o.length-i),f=0;if(!t||a<8)for(var m=0;m<=a;m+=65535){var b=m+65535;b<a?f=cy(A,f,r.subarray(m,b)):(A[m]=s,f=cy(A,f,r.subarray(m,a)))}else{for(var x=net[t-1],C=x>>>13,M=x&8191,U=(1<<e)-1,N=new Uo(32768),Q=new Uo(U+1),q=Math.ceil(e/3),Y=2*q,tt=function(He){return(r[He]^r[He+1]<<q^r[He+2]<<Y)&U},ft=new Bg(25e3),pt=new Uo(288),mt=new Uo(32),dt=0,Rt=0,m=0,Lt=0,st=0,ct=0;m<a;++m){var wt=tt(m),yt=m&32767,te=Q[wt];if(N[yt]=te,Q[wt]=yt,st<=m){var Zt=a-m;if((dt>7e3||Lt>24576)&&Zt>423){f=xF(r,A,0,ft,pt,mt,Rt,Lt,ct,m-ct,f),Lt=dt=Rt=0,ct=m;for(var re=0;re<286;++re)pt[re]=0;for(var re=0;re<30;++re)mt[re]=0}var Xt=2,ne=0,se=M,we=yt-te&32767;if(Zt>2&&wt==tt(m-we))for(var it=Math.min(C,Zt)-1,vt=Math.min(32767,m),Ft=Math.min(258,Zt);we<=vt&&--se&&yt!=te;){if(r[m+Xt]==r[m+Xt-we]){for(var Ot=0;Ot<Ft&&r[m+Ot]==r[m+Ot-we];++Ot);if(Ot>Xt){if(Xt=Ot,ne=we,Ot>it)break;for(var Wt=Math.min(we,Ot-2),jt=0,re=0;re<Wt;++re){var ae=m-we+re+32768&32767,ie=N[ae],Be=ae-ie+32768&32767;Be>jt&&(jt=Be,te=ae)}}}yt=te,te=N[yt],we+=yt-te+32768&32767}if(ne){ft[Lt++]=268435456|i2[Xt]<<18|vF[ne];var Te=i2[Xt]&31,Ne=vF[ne]&31;Rt+=oy[Te]+ay[Ne],++pt[257+Te],++mt[Ne],st=m+Xt,++dt}else ft[Lt++]=r[m],++pt[r[m]]}}f=xF(r,A,s,ft,pt,mt,Rt,Lt,ct,m-ct,f),s||(f=cy(A,f,iet))}return bF(o,0,n+c2(f)+i)},oet=function(){var r=1,t=0;return{p:function(e){for(var n=r,i=t,s=e.length,a=0;a!=s;){for(var o=Math.min(a+5552,s);a<o;++a)n+=e[a],i+=n;n%=65521,i%=65521}r=n,t=i},d:function(){return(r>>>8<<16|(t&255)<<8|t>>>8)+((r&255)<<23)*2}}},aet=function(r,t,e,n,i){return set(r,t.level==null?6:t.level,t.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):12+t.mem,e,n,!i)},cet=function(r,t,e){for(;e;++t)r[t]=e,e>>>=8},uet=function(r,t){var e=t.level,n=e==0?0:e<6?1:e==9?3:2;r[0]=120,r[1]=n<<6|(n?32-2*n:1)},Aet=function(r){if((r[0]&15)!=8||r[0]>>>4>7||(r[0]<<8|r[1])%31)throw"invalid zlib data";if(r[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function A2(r,t){t===void 0&&(t={});var e=oet();e.p(r);var n=aet(r,t,2,4);return uet(n,t),cet(n,n.length-4,e.d()),n}function het(r,t){return ret((Aet(r),r.subarray(2,-4)),t)}/** @license
*
* jsPDF - PDF Document creation from JavaScript
* Version 2.5.1 Built on 2022-01-28T15:37:57.791Z
*                      CommitID 00000000
*
* Copyright (c) 2010-2021 James Hall <james@parall.ax>, https://github.com/MrRio/jsPDF
*               2015-2021 yWorks GmbH, http://www.yworks.com
*               2015-2021 Lukas Hollnder <lukas.hollaender@yworks.com>, https://github.com/HackbrettXXX
*               2016-2018 Aras Abbasi <aras.abbasi@gmail.com>
*               2010 Aaron Spike, https://github.com/acspike
*               2012 Willow Systems Corporation, https://github.com/willowsystems
*               2012 Pablo Hess, https://github.com/pablohess
*               2012 Florian Jenett, https://github.com/fjenett
*               2013 Warren Weckesser, https://github.com/warrenweckesser
*               2013 Youssef Beddad, https://github.com/lifof
*               2013 Lee Driscoll, https://github.com/lsdriscoll
*               2013 Stefan Slonevskiy, https://github.com/stefslon
*               2013 Jeremy Morel, https://github.com/jmorel
*               2013 Christoph Hartmann, https://github.com/chris-rock
*               2014 Juan Pablo Gaviria, https://github.com/juanpgaviria
*               2014 James Makes, https://github.com/dollaruw
*               2014 Diego Casorran, https://github.com/diegocr
*               2014 Steven Spungin, https://github.com/Flamenco
*               2014 Kenneth Glassey, https://github.com/Gavvers
*
* Permission is hereby granted, free of charge, to any person obtaining
* a copy of this software and associated documentation files (the
* "Software"), to deal in the Software without restriction, including
* without limitation the rights to use, copy, modify, merge, publish,
* distribute, sublicense, and/or sell copies of the Software, and to
* permit persons to whom the Software is furnished to do so, subject to
* the following conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
* LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
* OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
* WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*
* Contributor(s):
*    siefkenj, ahwolf, rickygu, Midnith, saintclair, eaparango,
*    kim3er, mfo, alnorth, Flamenco
*/var Vr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function h2(){Vr.console&&typeof Vr.console.log=="function"&&Vr.console.log.apply(Vr.console,arguments)}var ci={log:h2,warn:function(r){Vr.console&&(typeof Vr.console.warn=="function"?Vr.console.warn.apply(Vr.console,arguments):h2.call(null,arguments))},error:function(r){Vr.console&&(typeof Vr.console.error=="function"?Vr.console.error.apply(Vr.console,arguments):h2(r))}};function d2(r,t,e){var n=new XMLHttpRequest;n.open("GET",r),n.responseType="blob",n.onload=function(){Hh(n.response,t,e)},n.onerror=function(){ci.error("could not download file")},n.send()}function BF(r){var t=new XMLHttpRequest;t.open("HEAD",r,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function ly(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(t)}}var Tg,f2,Hh=Vr.saveAs||((typeof window>"u"?"undefined":On(window))!=="object"||window!==Vr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,t,e){var n=Vr.URL||Vr.webkitURL,i=document.createElement("a");t=t||r.name||"download",i.download=t,i.rel="noopener",typeof r=="string"?(i.href=r,i.origin!==location.origin?BF(i.href)?d2(r,t,e):ly(i,i.target="_blank"):ly(i)):(i.href=n.createObjectURL(r),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){ly(i)},0))}:"msSaveOrOpenBlob"in navigator?function(r,t,e){if(t=t||r.name||"download",typeof r=="string")if(BF(r))d2(r,t,e);else{var n=document.createElement("a");n.href=r,n.target="_blank",setTimeout(function(){ly(n)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:On(s)!=="object"&&(ci.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(r,e),t)}:function(r,t,e,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof r=="string")return d2(r,t,e);var i=r.type==="application/octet-stream",s=/constructor/i.test(Vr.HTMLElement)||Vr.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||i&&s)&&(typeof FileReader>"u"?"undefined":On(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var m=o.result;m=a?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=m:location=m,n=null},o.readAsDataURL(r)}else{var A=Vr.URL||Vr.webkitURL,f=A.createObjectURL(r);n?n.location=f:location.href=f,n=null,setTimeout(function(){A.revokeObjectURL(f)},4e4)}});/**
* A class to parse color values
* @author Stoyan Stefanov <sstoo@gmail.com>
* {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
* @license Use it if you like it
*/function CF(r){var t;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<e.length;n++){var i=e[n].re,s=e[n].process,a=i.exec(r);a&&(t=s(a),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),A=this.g.toString(16),f=this.b.toString(16);return o.length==1&&(o="0"+o),A.length==1&&(A="0"+A),f.length==1&&(f="0"+f),"#"+o+A+f}}/**
* @license
* Joseph Myers does not specify a particular license for his work.
*
* Author: Joseph Myers
* Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
*
* Modified by: Owen Leong
*/function p2(r,t){var e=r[0],n=r[1],i=r[2],s=r[3];e=uo(e,n,i,s,t[0],7,-680876936),s=uo(s,e,n,i,t[1],12,-389564586),i=uo(i,s,e,n,t[2],17,606105819),n=uo(n,i,s,e,t[3],22,-1044525330),e=uo(e,n,i,s,t[4],7,-176418897),s=uo(s,e,n,i,t[5],12,1200080426),i=uo(i,s,e,n,t[6],17,-1473231341),n=uo(n,i,s,e,t[7],22,-45705983),e=uo(e,n,i,s,t[8],7,1770035416),s=uo(s,e,n,i,t[9],12,-1958414417),i=uo(i,s,e,n,t[10],17,-42063),n=uo(n,i,s,e,t[11],22,-1990404162),e=uo(e,n,i,s,t[12],7,1804603682),s=uo(s,e,n,i,t[13],12,-40341101),i=uo(i,s,e,n,t[14],17,-1502002290),e=Ao(e,n=uo(n,i,s,e,t[15],22,1236535329),i,s,t[1],5,-165796510),s=Ao(s,e,n,i,t[6],9,-1069501632),i=Ao(i,s,e,n,t[11],14,643717713),n=Ao(n,i,s,e,t[0],20,-373897302),e=Ao(e,n,i,s,t[5],5,-701558691),s=Ao(s,e,n,i,t[10],9,38016083),i=Ao(i,s,e,n,t[15],14,-660478335),n=Ao(n,i,s,e,t[4],20,-405537848),e=Ao(e,n,i,s,t[9],5,568446438),s=Ao(s,e,n,i,t[14],9,-1019803690),i=Ao(i,s,e,n,t[3],14,-187363961),n=Ao(n,i,s,e,t[8],20,1163531501),e=Ao(e,n,i,s,t[13],5,-1444681467),s=Ao(s,e,n,i,t[2],9,-51403784),i=Ao(i,s,e,n,t[7],14,1735328473),e=ho(e,n=Ao(n,i,s,e,t[12],20,-1926607734),i,s,t[5],4,-378558),s=ho(s,e,n,i,t[8],11,-2022574463),i=ho(i,s,e,n,t[11],16,1839030562),n=ho(n,i,s,e,t[14],23,-35309556),e=ho(e,n,i,s,t[1],4,-1530992060),s=ho(s,e,n,i,t[4],11,1272893353),i=ho(i,s,e,n,t[7],16,-155497632),n=ho(n,i,s,e,t[10],23,-1094730640),e=ho(e,n,i,s,t[13],4,681279174),s=ho(s,e,n,i,t[0],11,-358537222),i=ho(i,s,e,n,t[3],16,-722521979),n=ho(n,i,s,e,t[6],23,76029189),e=ho(e,n,i,s,t[9],4,-640364487),s=ho(s,e,n,i,t[12],11,-421815835),i=ho(i,s,e,n,t[15],16,530742520),e=fo(e,n=ho(n,i,s,e,t[2],23,-995338651),i,s,t[0],6,-198630844),s=fo(s,e,n,i,t[7],10,1126891415),i=fo(i,s,e,n,t[14],15,-1416354905),n=fo(n,i,s,e,t[5],21,-57434055),e=fo(e,n,i,s,t[12],6,1700485571),s=fo(s,e,n,i,t[3],10,-1894986606),i=fo(i,s,e,n,t[10],15,-1051523),n=fo(n,i,s,e,t[1],21,-2054922799),e=fo(e,n,i,s,t[8],6,1873313359),s=fo(s,e,n,i,t[15],10,-30611744),i=fo(i,s,e,n,t[6],15,-1560198380),n=fo(n,i,s,e,t[13],21,1309151649),e=fo(e,n,i,s,t[4],6,-145523070),s=fo(s,e,n,i,t[11],10,-1120210379),i=fo(i,s,e,n,t[2],15,718787259),n=fo(n,i,s,e,t[9],21,-343485551),r[0]=OA(e,r[0]),r[1]=OA(n,r[1]),r[2]=OA(i,r[2]),r[3]=OA(s,r[3])}function uy(r,t,e,n,i,s){return t=OA(OA(t,r),OA(n,s)),OA(t<<i|t>>>32-i,e)}function uo(r,t,e,n,i,s,a){return uy(t&e|~t&n,r,t,i,s,a)}function Ao(r,t,e,n,i,s,a){return uy(t&n|e&~n,r,t,i,s,a)}function ho(r,t,e,n,i,s,a){return uy(t^e^n,r,t,i,s,a)}function fo(r,t,e,n,i,s,a){return uy(e^(t|~n),r,t,i,s,a)}function EF(r){var t,e=r.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=r.length;t+=64)p2(n,det(r.substring(t-64,t)));r=r.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<r.length;t++)i[t>>2]|=r.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(p2(n,i),t=0;t<16;t++)i[t]=0;return i[14]=8*e,p2(n,i),n}function det(r){var t,e=[];for(t=0;t<64;t+=4)e[t>>2]=r.charCodeAt(t)+(r.charCodeAt(t+1)<<8)+(r.charCodeAt(t+2)<<16)+(r.charCodeAt(t+3)<<24);return e}Tg=Vr.atob.bind(Vr),f2=Vr.btoa.bind(Vr);var SF="0123456789abcdef".split("");function fet(r){for(var t="",e=0;e<4;e++)t+=SF[r>>8*e+4&15]+SF[r>>8*e&15];return t}function pet(r){return String.fromCharCode((255&r)>>0,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function g2(r){return EF(r).map(pet).join("")}var get=function(r){for(var t=0;t<r.length;t++)r[t]=fet(r[t]);return r.join("")}(EF("hello"))!="5d41402abc4b2a76b9719d911017c592";function OA(r,t){if(get){var e=(65535&r)+(65535&t);return(r>>16)+(t>>16)+(e>>16)<<16|65535&e}return r+t&4294967295}/**
* @license
* FPDF is released under a permissive license: there is no usage restriction.
* You may embed it freely in your application (commercial or not), with or
* without modifications.
*
* Reference: http://www.fpdf.org/en/script/script37.php
*/function m2(r,t){var e,n,i,s;if(r!==e){for(var a=(i=r,s=1+(256/r.length>>0),new Array(s+1).join(i)),o=[],A=0;A<256;A++)o[A]=A;var f=0;for(A=0;A<256;A++){var m=o[A];f=(f+m+a.charCodeAt(A))%256,o[A]=o[f],o[f]=m}e=r,n=o}else o=n;var b=t.length,x=0,C=0,M="";for(A=0;A<b;A++)C=(C+(m=o[x=(x+1)%256]))%256,o[x]=o[C],o[C]=m,a=o[(o[x]+o[C])%256],M+=String.fromCharCode(t.charCodeAt(A)^a);return M}/**
* @license
* Licensed under the MIT License.
* http://opensource.org/licenses/mit-license
* Author: Owen Leong (@owenl131)
* Date: 15 Oct 2020
* References:
* https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
* https://github.com/foliojs/pdfkit/blob/master/lib/security.js
* http://www.fpdf.org/en/script/script37.php
*/var TF={print:4,modify:8,copy:16,"annot-forms":32};function pf(r,t,e,n){this.v=1,this.r=2;var i=192;r.forEach(function(o){if(TF.perm!==void 0)throw new Error("Invalid permission: "+o);i+=TF[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(t+this.padding).substr(0,32),a=(e+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,a),this.P=-(1+(255^i)),this.encryptionKey=g2(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=m2(this.encryptionKey,this.padding)}function gf(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var t="",e=r.length,n=0;n<e;n++){var i=r.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?t+="#"+("0"+i.toString(16)).slice(-2):t+=r[n]}return t}function IF(r){if(On(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,n,i){if(i=i||!1,typeof e!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var s=Math.random().toString(35);return t[e][s]=[n,!!i],s},this.unsubscribe=function(e){for(var n in t)if(t[n][e])return delete t[n][e],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(e){if(t.hasOwnProperty(e)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var s in t[e]){var a=t[e][s];try{a[0].apply(r,n)}catch(o){Vr.console&&ci.error("jsPDF PubSub Error",o.message,o)}a[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Ay(r){if(!(this instanceof Ay))return new Ay(r);var t="opacity,stroke-opacity".split(",");for(var e in r)r.hasOwnProperty(e)&&t.indexOf(e)>=0&&(this[e]=r[e]);this.id="",this.objectNumber=-1}function LF(r,t){this.gState=r,this.matrix=t,this.id="",this.objectNumber=-1}function zh(r,t,e,n,i){if(!(this instanceof zh))return new zh(r,t,e,n,i);this.type=r==="axial"?2:3,this.coords=t,this.colors=e,LF.call(this,n,i)}function mf(r,t,e,n,i){if(!(this instanceof mf))return new mf(r,t,e,n,i);this.boundingBox=r,this.xStep=t,this.yStep=e,this.stream="",this.cloneIndex=0,LF.call(this,n,i)}function jr(r){var t,e=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],s=arguments[3],a=[],o=1,A=16,f="S",m=null;On(r=r||{})==="object"&&(e=r.orientation,n=r.unit||n,i=r.format||i,s=r.compress||r.compressPdf||s,(m=r.encryption||null)!==null&&(m.userPassword=m.userPassword||"",m.ownerPassword=m.ownerPassword||"",m.userPermissions=m.userPermissions||[]),o=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(t=r.precision),r.floatPrecision!==void 0&&(A=r.floatPrecision),f=r.defaultPathOperation||"S"),a=r.filters||(s===!0?["FlateEncode"]:a),n=n||"mm",e=(""+(e||"P")).toLowerCase();var b=r.putOnlyUsedFonts||!1,x={},C={internal:{},__private__:{}};C.__private__.PubSub=IF;var M="1.3",U=C.__private__.getPdfVersion=function(){return M};C.__private__.setPdfVersion=function(k){M=k};var N={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};C.__private__.getPageFormats=function(){return N};var Q=C.__private__.getPageFormat=function(k){return N[k]};i=i||"a4";var q={COMPAT:"compat",ADVANCED:"advanced"},Y=q.COMPAT;function tt(){this.saveGraphicsState(),Ut(new St(Oe,0,0,-Oe,0,ma()*Oe).toString()+" cm"),this.setFontSize(this.getFontSize()/Oe),f="n",Y=q.ADVANCED}function ft(){this.restoreGraphicsState(),f="S",Y=q.COMPAT}var pt=C.__private__.combineFontStyleAndFontWeight=function(k,et){if(k=="bold"&&et=="normal"||k=="bold"&&et==400||k=="normal"&&et=="italic"||k=="bold"&&et=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return et&&(k=et==400||et==="normal"?k==="italic"?"italic":"normal":et!=700&&et!=="bold"||k!=="normal"?(et==700?"bold":et)+""+k:"bold"),k};C.advancedAPI=function(k){var et=Y===q.COMPAT;return et&&tt.call(this),typeof k!="function"||(k(this),et&&ft.call(this)),this},C.compatAPI=function(k){var et=Y===q.ADVANCED;return et&&ft.call(this),typeof k!="function"||(k(this),et&&tt.call(this)),this},C.isAdvancedAPI=function(){return Y===q.ADVANCED};var mt,dt=function(k){if(Y!==q.ADVANCED)throw new Error(k+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Rt=C.roundToPrecision=C.__private__.roundToPrecision=function(k,et){var Mt=t||et;if(isNaN(k)||isNaN(Mt))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return k.toFixed(Mt).replace(/0+$/,"")};mt=C.hpf=C.__private__.hpf=typeof A=="number"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return Rt(k,A)}:A==="smart"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return Rt(k,k>-1&&k<1?16:5)}:function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return Rt(k,16)};var Lt=C.f2=C.__private__.f2=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f2");return Rt(k,2)},st=C.__private__.f3=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f3");return Rt(k,3)},ct=C.scale=C.__private__.scale=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.scale");return Y===q.COMPAT?k*Oe:Y===q.ADVANCED?k:void 0},wt=function(k){return Y===q.COMPAT?ma()-k:Y===q.ADVANCED?k:void 0},yt=function(k){return ct(wt(k))};C.__private__.setPrecision=C.setPrecision=function(k){typeof parseInt(k,10)=="number"&&(t=parseInt(k,10))};var te,Zt="00000000000000000000000000000000",re=C.__private__.getFileId=function(){return Zt},Xt=C.__private__.setFileId=function(k){return Zt=k!==void 0&&/^[a-fA-F0-9]{32}$/.test(k)?k.toUpperCase():Zt.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),m!==null&&(kn=new pf(m.userPermissions,m.userPassword,m.ownerPassword,Zt)),Zt};C.setFileId=function(k){return Xt(k),this},C.getFileId=function(){return re()};var ne=C.__private__.convertDateToPDFDate=function(k){var et=k.getTimezoneOffset(),Mt=et<0?"+":"-",Vt=Math.floor(Math.abs(et/60)),oe=Math.abs(et%60),ce=[Mt,Ft(Vt),"'",Ft(oe),"'"].join("");return["D:",k.getFullYear(),Ft(k.getMonth()+1),Ft(k.getDate()),Ft(k.getHours()),Ft(k.getMinutes()),Ft(k.getSeconds()),ce].join("")},se=C.__private__.convertPDFDateToDate=function(k){var et=parseInt(k.substr(2,4),10),Mt=parseInt(k.substr(6,2),10)-1,Vt=parseInt(k.substr(8,2),10),oe=parseInt(k.substr(10,2),10),ce=parseInt(k.substr(12,2),10),Me=parseInt(k.substr(14,2),10);return new Date(et,Mt,Vt,oe,ce,Me,0)},we=C.__private__.setCreationDate=function(k){var et;if(k===void 0&&(k=new Date),k instanceof Date)et=ne(k);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(k))throw new Error("Invalid argument passed to jsPDF.setCreationDate");et=k}return te=et},it=C.__private__.getCreationDate=function(k){var et=te;return k==="jsDate"&&(et=se(te)),et};C.setCreationDate=function(k){return we(k),this},C.getCreationDate=function(k){return it(k)};var vt,Ft=C.__private__.padd2=function(k){return("0"+parseInt(k)).slice(-2)},Ot=C.__private__.padd2Hex=function(k){return("00"+(k=k.toString())).substr(k.length)},Wt=0,jt=[],ae=[],ie=0,Be=[],Te=[],Ne=!1,Qe=ae,He=function(){Wt=0,ie=0,ae=[],jt=[],Be=[],cr=Ge(),Pr=Ge()};C.__private__.setCustomOutputDestination=function(k){Ne=!0,Qe=k};var ge=function(k){Ne||(Qe=k)};C.__private__.resetCustomOutputDestination=function(){Ne=!1,Qe=ae};var Ut=C.__private__.out=function(k){return k=k.toString(),ie+=k.length+1,Qe.push(k),Qe},Yt=C.__private__.write=function(k){return Ut(arguments.length===1?k.toString():Array.prototype.join.call(arguments," "))},tr=C.__private__.getArrayBuffer=function(k){for(var et=k.length,Mt=new ArrayBuffer(et),Vt=new Uint8Array(Mt);et--;)Vt[et]=k.charCodeAt(et);return Mt},Ee=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];C.__private__.getStandardFonts=function(){return Ee};var _e=r.fontSize||16;C.__private__.setFontSize=C.setFontSize=function(k){return _e=Y===q.ADVANCED?k/Oe:k,this};var xe,De=C.__private__.getFontSize=C.getFontSize=function(){return Y===q.COMPAT?_e:_e*Oe},nr=r.R2L||!1;C.__private__.setR2L=C.setR2L=function(k){return nr=k,this},C.__private__.getR2L=C.getR2L=function(){return nr};var ur,Ir=C.__private__.setZoomMode=function(k){var et=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(k))xe=k;else if(isNaN(k)){if(et.indexOf(k)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+k+'" is not recognized.');xe=k}else xe=parseInt(k,10)};C.__private__.getZoomMode=function(){return xe};var Sr,Dr=C.__private__.setPageMode=function(k){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(k)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+k+'" is not recognized.');ur=k};C.__private__.getPageMode=function(){return ur};var Nr=C.__private__.setLayoutMode=function(k){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(k)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+k+'" is not recognized.');Sr=k};C.__private__.getLayoutMode=function(){return Sr},C.__private__.setDisplayMode=C.setDisplayMode=function(k,et,Mt){return Ir(k),Nr(et),Dr(Mt),this};var fe={title:"",subject:"",author:"",keywords:"",creator:""};C.__private__.getDocumentProperty=function(k){if(Object.keys(fe).indexOf(k)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return fe[k]},C.__private__.getDocumentProperties=function(){return fe},C.__private__.setDocumentProperties=C.setProperties=C.setDocumentProperties=function(k){for(var et in fe)fe.hasOwnProperty(et)&&k[et]&&(fe[et]=k[et]);return this},C.__private__.setDocumentProperty=function(k,et){if(Object.keys(fe).indexOf(k)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return fe[k]=et};var Tr,Oe,wn,Fr,Se,Xe={},qe={},Yr=[],Rr={},pr={},on={},Kr={},Ct=null,Z=0,J=[],ot=new IF(C),Et=r.hotfixes||[],Nt={},zt={},qt=[],St=function k(et,Mt,Vt,oe,ce,Me){if(!(this instanceof k))return new k(et,Mt,Vt,oe,ce,Me);isNaN(et)&&(et=1),isNaN(Mt)&&(Mt=0),isNaN(Vt)&&(Vt=0),isNaN(oe)&&(oe=1),isNaN(ce)&&(ce=0),isNaN(Me)&&(Me=0),this._matrix=[et,Mt,Vt,oe,ce,Me]};Object.defineProperty(St.prototype,"sx",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(St.prototype,"shy",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(St.prototype,"shx",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(St.prototype,"sy",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(St.prototype,"tx",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(St.prototype,"ty",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(St.prototype,"a",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(St.prototype,"b",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(St.prototype,"c",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(St.prototype,"d",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(St.prototype,"e",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(St.prototype,"f",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(St.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(St.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(St.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(St.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),St.prototype.join=function(k){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(mt).join(k)},St.prototype.multiply=function(k){var et=k.sx*this.sx+k.shy*this.shx,Mt=k.sx*this.shy+k.shy*this.sy,Vt=k.shx*this.sx+k.sy*this.shx,oe=k.shx*this.shy+k.sy*this.sy,ce=k.tx*this.sx+k.ty*this.shx+this.tx,Me=k.tx*this.shy+k.ty*this.sy+this.ty;return new St(et,Mt,Vt,oe,ce,Me)},St.prototype.decompose=function(){var k=this.sx,et=this.shy,Mt=this.shx,Vt=this.sy,oe=this.tx,ce=this.ty,Me=Math.sqrt(k*k+et*et),ar=(k/=Me)*Mt+(et/=Me)*Vt;Mt-=k*ar,Vt-=et*ar;var Mr=Math.sqrt(Mt*Mt+Vt*Vt);return ar/=Mr,k*(Vt/=Mr)<et*(Mt/=Mr)&&(k=-k,et=-et,ar=-ar,Me=-Me),{scale:new St(Me,0,0,Mr,0,0),translate:new St(1,0,0,1,oe,ce),rotate:new St(k,et,-et,k,0,0),skew:new St(1,0,ar,1,0,0)}},St.prototype.toString=function(k){return this.join(" ")},St.prototype.inversed=function(){var k=this.sx,et=this.shy,Mt=this.shx,Vt=this.sy,oe=this.tx,ce=this.ty,Me=1/(k*Vt-et*Mt),ar=Vt*Me,Mr=-et*Me,zr=-Mt*Me,_r=k*Me;return new St(ar,Mr,zr,_r,-ar*oe-zr*ce,-Mr*oe-_r*ce)},St.prototype.applyToPoint=function(k){var et=k.x*this.sx+k.y*this.shx+this.tx,Mt=k.x*this.shy+k.y*this.sy+this.ty;return new iu(et,Mt)},St.prototype.applyToRectangle=function(k){var et=this.applyToPoint(k),Mt=this.applyToPoint(new iu(k.x+k.w,k.y+k.h));return new hl(et.x,et.y,Mt.x-et.x,Mt.y-et.y)},St.prototype.clone=function(){var k=this.sx,et=this.shy,Mt=this.shx,Vt=this.sy,oe=this.tx,ce=this.ty;return new St(k,et,Mt,Vt,oe,ce)},C.Matrix=St;var Jt=C.matrixMult=function(k,et){return et.multiply(k)},me=new St(1,0,0,1,0,0);C.unitMatrix=C.identityMatrix=me;var pe=function(k,et){if(!pr[k]){var Mt=(et instanceof zh?"Sh":"P")+(Object.keys(Rr).length+1).toString(10);et.id=Mt,pr[k]=Mt,Rr[Mt]=et,ot.publish("addPattern",et)}};C.ShadingPattern=zh,C.TilingPattern=mf,C.addShadingPattern=function(k,et){return dt("addShadingPattern()"),pe(k,et),this},C.beginTilingPattern=function(k){dt("beginTilingPattern()"),su(k.boundingBox[0],k.boundingBox[1],k.boundingBox[2]-k.boundingBox[0],k.boundingBox[3]-k.boundingBox[1],k.matrix)},C.endTilingPattern=function(k,et){dt("endTilingPattern()"),et.stream=Te[vt].join(`
`),pe(k,et),ot.publish("endTilingPattern",et),qt.pop().restore()};var de=C.__private__.newObject=function(){var k=Ge();return Ye(k,!0),k},Ge=C.__private__.newObjectDeferred=function(){return Wt++,jt[Wt]=function(){return ie},Wt},Ye=function(k,et){return et=typeof et=="boolean"&&et,jt[k]=ie,et&&Ut(k+" 0 obj"),k},Cr=C.__private__.newAdditionalObject=function(){var k={objId:Ge(),content:""};return Be.push(k),k},cr=Ge(),Pr=Ge(),kr=C.__private__.decodeColorString=function(k){var et=k.split(" ");if(et.length!==2||et[1]!=="g"&&et[1]!=="G")et.length===5&&(et[4]==="k"||et[4]==="K")&&(et=[(1-et[0])*(1-et[3]),(1-et[1])*(1-et[3]),(1-et[2])*(1-et[3]),"r"]);else{var Mt=parseFloat(et[0]);et=[Mt,Mt,Mt,"r"]}for(var Vt="#",oe=0;oe<3;oe++)Vt+=("0"+Math.floor(255*parseFloat(et[oe])).toString(16)).slice(-2);return Vt},Qr=C.__private__.encodeColorString=function(k){var et;typeof k=="string"&&(k={ch1:k});var Mt=k.ch1,Vt=k.ch2,oe=k.ch3,ce=k.ch4,Me=k.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Mt=="string"&&Mt.charAt(0)!=="#"){var ar=new CF(Mt);if(ar.ok)Mt=ar.toHex();else if(!/^\d*\.?\d*$/.test(Mt))throw new Error('Invalid color "'+Mt+'" passed to jsPDF.encodeColorString.')}if(typeof Mt=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Mt)&&(Mt="#"+Mt[1]+Mt[1]+Mt[2]+Mt[2]+Mt[3]+Mt[3]),typeof Mt=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Mt)){var Mr=parseInt(Mt.substr(1),16);Mt=Mr>>16&255,Vt=Mr>>8&255,oe=255&Mr}if(Vt===void 0||ce===void 0&&Mt===Vt&&Vt===oe)if(typeof Mt=="string")et=Mt+" "+Me[0];else switch(k.precision){case 2:et=Lt(Mt/255)+" "+Me[0];break;case 3:default:et=st(Mt/255)+" "+Me[0]}else if(ce===void 0||On(ce)==="object"){if(ce&&!isNaN(ce.a)&&ce.a===0)return et=["1.","1.","1.",Me[1]].join(" ");if(typeof Mt=="string")et=[Mt,Vt,oe,Me[1]].join(" ");else switch(k.precision){case 2:et=[Lt(Mt/255),Lt(Vt/255),Lt(oe/255),Me[1]].join(" ");break;default:case 3:et=[st(Mt/255),st(Vt/255),st(oe/255),Me[1]].join(" ")}}else if(typeof Mt=="string")et=[Mt,Vt,oe,ce,Me[2]].join(" ");else switch(k.precision){case 2:et=[Lt(Mt),Lt(Vt),Lt(oe),Lt(ce),Me[2]].join(" ");break;case 3:default:et=[st(Mt),st(Vt),st(oe),st(ce),Me[2]].join(" ")}return et},gn=C.__private__.getFilters=function(){return a},gr=C.__private__.putStream=function(k){var et=(k=k||{}).data||"",Mt=k.filters||gn(),Vt=k.alreadyAppliedFilters||[],oe=k.addLength1||!1,ce=et.length,Me=k.objectId,ar=function($r){return $r};if(m!==null&&Me===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");m!==null&&(ar=kn.encryptor(Me,0));var Mr={};Mt===!0&&(Mt=["FlateEncode"]);var zr=k.additionalKeyValues||[],_r=(Mr=jr.API.processDataByFilters!==void 0?jr.API.processDataByFilters(et,Mt):{data:et,reverseChain:[]}).reverseChain+(Array.isArray(Vt)?Vt.join(" "):Vt.toString());if(Mr.data.length!==0&&(zr.push({key:"Length",value:Mr.data.length}),oe===!0&&zr.push({key:"Length1",value:ce})),_r.length!=0)if(_r.split("/").length-1==1)zr.push({key:"Filter",value:_r});else{zr.push({key:"Filter",value:"["+_r+"]"});for(var bn=0;bn<zr.length;bn+=1)if(zr[bn].key==="DecodeParms"){for(var vr=[],ui=0;ui<Mr.reverseChain.split("/").length-1;ui+=1)vr.push("null");vr.push(zr[bn].value),zr[bn].value="["+vr.join(" ")+"]"}}Ut("<<");for(var qr=0;qr<zr.length;qr++)Ut("/"+zr[qr].key+" "+zr[qr].value);Ut(">>"),Mr.data.length!==0&&(Ut("stream"),Ut(ar(Mr.data)),Ut("endstream"))},Wr=C.__private__.putPage=function(k){var et=k.number,Mt=k.data,Vt=k.objId,oe=k.contentsObjId;Ye(Vt,!0),Ut("<</Type /Page"),Ut("/Parent "+k.rootDictionaryObjId+" 0 R"),Ut("/Resources "+k.resourceDictionaryObjId+" 0 R"),Ut("/MediaBox ["+parseFloat(mt(k.mediaBox.bottomLeftX))+" "+parseFloat(mt(k.mediaBox.bottomLeftY))+" "+mt(k.mediaBox.topRightX)+" "+mt(k.mediaBox.topRightY)+"]"),k.cropBox!==null&&Ut("/CropBox ["+mt(k.cropBox.bottomLeftX)+" "+mt(k.cropBox.bottomLeftY)+" "+mt(k.cropBox.topRightX)+" "+mt(k.cropBox.topRightY)+"]"),k.bleedBox!==null&&Ut("/BleedBox ["+mt(k.bleedBox.bottomLeftX)+" "+mt(k.bleedBox.bottomLeftY)+" "+mt(k.bleedBox.topRightX)+" "+mt(k.bleedBox.topRightY)+"]"),k.trimBox!==null&&Ut("/TrimBox ["+mt(k.trimBox.bottomLeftX)+" "+mt(k.trimBox.bottomLeftY)+" "+mt(k.trimBox.topRightX)+" "+mt(k.trimBox.topRightY)+"]"),k.artBox!==null&&Ut("/ArtBox ["+mt(k.artBox.bottomLeftX)+" "+mt(k.artBox.bottomLeftY)+" "+mt(k.artBox.topRightX)+" "+mt(k.artBox.topRightY)+"]"),typeof k.userUnit=="number"&&k.userUnit!==1&&Ut("/UserUnit "+k.userUnit),ot.publish("putPage",{objId:Vt,pageContext:J[et],pageNumber:et,page:Mt}),Ut("/Contents "+oe+" 0 R"),Ut(">>"),Ut("endobj");var ce=Mt.join(`
`);return Y===q.ADVANCED&&(ce+=`
Q`),Ye(oe,!0),gr({data:ce,filters:gn(),objectId:oe}),Ut("endobj"),Vt},vn=C.__private__.putPages=function(){var k,et,Mt=[];for(k=1;k<=Z;k++)J[k].objId=Ge(),J[k].contentsObjId=Ge();for(k=1;k<=Z;k++)Mt.push(Wr({number:k,data:Te[k],objId:J[k].objId,contentsObjId:J[k].contentsObjId,mediaBox:J[k].mediaBox,cropBox:J[k].cropBox,bleedBox:J[k].bleedBox,trimBox:J[k].trimBox,artBox:J[k].artBox,userUnit:J[k].userUnit,rootDictionaryObjId:cr,resourceDictionaryObjId:Pr}));Ye(cr,!0),Ut("<</Type /Pages");var Vt="/Kids [";for(et=0;et<Z;et++)Vt+=Mt[et]+" 0 R ";Ut(Vt+"]"),Ut("/Count "+Z),Ut(">>"),Ut("endobj"),ot.publish("postPutPages")},Dn=function(k){ot.publish("putFont",{font:k,out:Ut,newObject:de,putStream:gr}),k.isAlreadyPutted!==!0&&(k.objectNumber=de(),Ut("<<"),Ut("/Type /Font"),Ut("/BaseFont /"+gf(k.postScriptName)),Ut("/Subtype /Type1"),typeof k.encoding=="string"&&Ut("/Encoding /"+k.encoding),Ut("/FirstChar 32"),Ut("/LastChar 255"),Ut(">>"),Ut("endobj"))},Dt=function(){for(var k in Xe)Xe.hasOwnProperty(k)&&(b===!1||b===!0&&x.hasOwnProperty(k))&&Dn(Xe[k])},Ue=function(k){k.objectNumber=de();var et=[];et.push({key:"Type",value:"/XObject"}),et.push({key:"Subtype",value:"/Form"}),et.push({key:"BBox",value:"["+[mt(k.x),mt(k.y),mt(k.x+k.width),mt(k.y+k.height)].join(" ")+"]"}),et.push({key:"Matrix",value:"["+k.matrix.toString()+"]"});var Mt=k.pages[1].join(`
`);gr({data:Mt,additionalKeyValues:et,objectId:k.objectNumber}),Ut("endobj")},Ie=function(){for(var k in Nt)Nt.hasOwnProperty(k)&&Ue(Nt[k])},rn=function(k,et){var Mt,Vt=[],oe=1/(et-1);for(Mt=0;Mt<1;Mt+=oe)Vt.push(Mt);if(Vt.push(1),k[0].offset!=0){var ce={offset:0,color:k[0].color};k.unshift(ce)}if(k[k.length-1].offset!=1){var Me={offset:1,color:k[k.length-1].color};k.push(Me)}for(var ar="",Mr=0,zr=0;zr<Vt.length;zr++){for(Mt=Vt[zr];Mt>k[Mr+1].offset;)Mr++;var _r=k[Mr].offset,bn=(Mt-_r)/(k[Mr+1].offset-_r),vr=k[Mr].color,ui=k[Mr+1].color;ar+=Ot(Math.round((1-bn)*vr[0]+bn*ui[0]).toString(16))+Ot(Math.round((1-bn)*vr[1]+bn*ui[1]).toString(16))+Ot(Math.round((1-bn)*vr[2]+bn*ui[2]).toString(16))}return ar.trim()},Mn=function(k,et){et||(et=21);var Mt=de(),Vt=rn(k.colors,et),oe=[];oe.push({key:"FunctionType",value:"0"}),oe.push({key:"Domain",value:"[0.0 1.0]"}),oe.push({key:"Size",value:"["+et+"]"}),oe.push({key:"BitsPerSample",value:"8"}),oe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),oe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),gr({data:Vt,additionalKeyValues:oe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Mt}),Ut("endobj"),k.objectNumber=de(),Ut("<< /ShadingType "+k.type),Ut("/ColorSpace /DeviceRGB");var ce="/Coords ["+mt(parseFloat(k.coords[0]))+" "+mt(parseFloat(k.coords[1]))+" ";k.type===2?ce+=mt(parseFloat(k.coords[2]))+" "+mt(parseFloat(k.coords[3])):ce+=mt(parseFloat(k.coords[2]))+" "+mt(parseFloat(k.coords[3]))+" "+mt(parseFloat(k.coords[4]))+" "+mt(parseFloat(k.coords[5])),Ut(ce+="]"),k.matrix&&Ut("/Matrix ["+k.matrix.toString()+"]"),Ut("/Function "+Mt+" 0 R"),Ut("/Extend [true true]"),Ut(">>"),Ut("endobj")},xr=function(k,et){var Mt=Ge(),Vt=de();et.push({resourcesOid:Mt,objectOid:Vt}),k.objectNumber=Vt;var oe=[];oe.push({key:"Type",value:"/Pattern"}),oe.push({key:"PatternType",value:"1"}),oe.push({key:"PaintType",value:"1"}),oe.push({key:"TilingType",value:"1"}),oe.push({key:"BBox",value:"["+k.boundingBox.map(mt).join(" ")+"]"}),oe.push({key:"XStep",value:mt(k.xStep)}),oe.push({key:"YStep",value:mt(k.yStep)}),oe.push({key:"Resources",value:Mt+" 0 R"}),k.matrix&&oe.push({key:"Matrix",value:"["+k.matrix.toString()+"]"}),gr({data:k.stream,additionalKeyValues:oe,objectId:k.objectNumber}),Ut("endobj")},mn=function(k){var et;for(et in Rr)Rr.hasOwnProperty(et)&&(Rr[et]instanceof zh?Mn(Rr[et]):Rr[et]instanceof mf&&xr(Rr[et],k))},bi=function(k){for(var et in k.objectNumber=de(),Ut("<<"),k)switch(et){case"opacity":Ut("/ca "+Lt(k[et]));break;case"stroke-opacity":Ut("/CA "+Lt(k[et]))}Ut(">>"),Ut("endobj")},yn=function(){var k;for(k in on)on.hasOwnProperty(k)&&bi(on[k])},nn=function(){for(var k in Ut("/XObject <<"),Nt)Nt.hasOwnProperty(k)&&Nt[k].objectNumber>=0&&Ut("/"+k+" "+Nt[k].objectNumber+" 0 R");ot.publish("putXobjectDict"),Ut(">>")},wi=function(){kn.oid=de(),Ut("<<"),Ut("/Filter /Standard"),Ut("/V "+kn.v),Ut("/R "+kn.r),Ut("/U <"+kn.toHexString(kn.U)+">"),Ut("/O <"+kn.toHexString(kn.O)+">"),Ut("/P "+kn.P),Ut(">>"),Ut("endobj")},Xn=function(){for(var k in Ut("/Font <<"),Xe)Xe.hasOwnProperty(k)&&(b===!1||b===!0&&x.hasOwnProperty(k))&&Ut("/"+k+" "+Xe[k].objectNumber+" 0 R");Ut(">>")},os=function(){if(Object.keys(Rr).length>0){for(var k in Ut("/Shading <<"),Rr)Rr.hasOwnProperty(k)&&Rr[k]instanceof zh&&Rr[k].objectNumber>=0&&Ut("/"+k+" "+Rr[k].objectNumber+" 0 R");ot.publish("putShadingPatternDict"),Ut(">>")}},Rs=function(k){if(Object.keys(Rr).length>0){for(var et in Ut("/Pattern <<"),Rr)Rr.hasOwnProperty(et)&&Rr[et]instanceof C.TilingPattern&&Rr[et].objectNumber>=0&&Rr[et].objectNumber<k&&Ut("/"+et+" "+Rr[et].objectNumber+" 0 R");ot.publish("putTilingPatternDict"),Ut(">>")}},Ho=function(){if(Object.keys(on).length>0){var k;for(k in Ut("/ExtGState <<"),on)on.hasOwnProperty(k)&&on[k].objectNumber>=0&&Ut("/"+k+" "+on[k].objectNumber+" 0 R");ot.publish("putGStateDict"),Ut(">>")}},Or=function(k){Ye(k.resourcesOid,!0),Ut("<<"),Ut("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Xn(),os(),Rs(k.objectOid),Ho(),nn(),Ut(">>"),Ut("endobj")},Xs=function(){var k=[];Dt(),yn(),Ie(),mn(k),ot.publish("putResources"),k.forEach(Or),Or({resourcesOid:Pr,objectOid:Number.MAX_SAFE_INTEGER}),ot.publish("postPutResources")},Bs=function(){ot.publish("putAdditionalObjects");for(var k=0;k<Be.length;k++){var et=Be[k];Ye(et.objId,!0),Ut(et.content),Ut("endobj")}ot.publish("postPutAdditionalObjects")},Tn=function(k){qe[k.fontName]=qe[k.fontName]||{},qe[k.fontName][k.fontStyle]=k.id},_o=function(k,et,Mt,Vt,oe){var ce={id:"F"+(Object.keys(Xe).length+1).toString(10),postScriptName:k,fontName:et,fontStyle:Mt,encoding:Vt,isStandardFont:oe||!1,metadata:{}};return ot.publish("addFont",{font:ce,instance:this}),Xe[ce.id]=ce,Tn(ce),ce.id},Fi=function(k){for(var et=0,Mt=Ee.length;et<Mt;et++){var Vt=_o.call(this,k[et][0],k[et][1],k[et][2],Ee[et][3],!0);b===!1&&(x[Vt]=!0);var oe=k[et][0].split("-");Tn({id:Vt,fontName:oe[0],fontStyle:oe[1]||""})}ot.publish("addFonts",{fonts:Xe,dictionary:qe})},Mi=function(k){return k.foo=function(){try{return k.apply(this,arguments)}catch(Vt){var et=Vt.stack||"";~et.indexOf(" at ")&&(et=et.split(" at ")[1]);var Mt="Error in function "+et.split(`
`)[0].split("<")[0]+": "+Vt.message;if(!Vr.console)throw new Error(Mt);Vr.console.error(Mt,Vt),Vr.alert&&alert(Mt)}},k.foo.bar=k,k.foo},Yn=function(k,et){var Mt,Vt,oe,ce,Me,ar,Mr,zr,_r;if(oe=(et=et||{}).sourceEncoding||"Unicode",Me=et.outputEncoding,(et.autoencode||Me)&&Xe[Tr].metadata&&Xe[Tr].metadata[oe]&&Xe[Tr].metadata[oe].encoding&&(ce=Xe[Tr].metadata[oe].encoding,!Me&&Xe[Tr].encoding&&(Me=Xe[Tr].encoding),!Me&&ce.codePages&&(Me=ce.codePages[0]),typeof Me=="string"&&(Me=ce[Me]),Me)){for(Mr=!1,ar=[],Mt=0,Vt=k.length;Mt<Vt;Mt++)(zr=Me[k.charCodeAt(Mt)])?ar.push(String.fromCharCode(zr)):ar.push(k[Mt]),ar[Mt].charCodeAt(0)>>8&&(Mr=!0);k=ar.join("")}for(Mt=k.length;Mr===void 0&&Mt!==0;)k.charCodeAt(Mt-1)>>8&&(Mr=!0),Mt--;if(!Mr)return k;for(ar=et.noBOM?[]:[254,255],Mt=0,Vt=k.length;Mt<Vt;Mt++){if((_r=(zr=k.charCodeAt(Mt))>>8)>>8)throw new Error("Character at position "+Mt+" of string '"+k+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ar.push(_r),ar.push(zr-(_r<<8))}return String.fromCharCode.apply(void 0,ar)},Ti=C.__private__.pdfEscape=C.pdfEscape=function(k,et){return Yn(k,et).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},an=C.__private__.beginPage=function(k){Te[++Z]=[],J[Z]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(k[0]),topRightY:Number(k[1])}},Ys(Z),ge(Te[vt])},zo=function(k,et){var Mt,Vt,oe;switch(e=et||e,typeof k=="string"&&(Mt=Q(k.toLowerCase()),Array.isArray(Mt)&&(Vt=Mt[0],oe=Mt[1])),Array.isArray(k)&&(Vt=k[0]*Oe,oe=k[1]*Oe),isNaN(Vt)&&(Vt=i[0],oe=i[1]),(Vt>14400||oe>14400)&&(ci.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Vt=Math.min(14400,Vt),oe=Math.min(14400,oe)),i=[Vt,oe],e.substr(0,1)){case"l":oe>Vt&&(i=[oe,Vt]);break;case"p":Vt>oe&&(i=[oe,Vt])}an(i),cn(Pi),Ut(Os),Xu!==0&&Ut(Xu+" J"),Yu!==0&&Ut(Yu+" j"),ot.publish("addPage",{pageNumber:Z})},Go=function(k){k>0&&k<=Z&&(Te.splice(k,1),J.splice(k,1),Z--,vt>Z&&(vt=Z),this.setPage(vt))},Ys=function(k){k>0&&k<=Z&&(vt=k)},dc=C.__private__.getNumberOfPages=C.getNumberOfPages=function(){return Te.length-1},At=function(k,et,Mt){var Vt,oe=void 0;return Mt=Mt||{},k=k!==void 0?k:Xe[Tr].fontName,et=et!==void 0?et:Xe[Tr].fontStyle,Vt=k.toLowerCase(),qe[Vt]!==void 0&&qe[Vt][et]!==void 0?oe=qe[Vt][et]:qe[k]!==void 0&&qe[k][et]!==void 0?oe=qe[k][et]:Mt.disableWarning===!1&&ci.warn("Unable to look up font label for font '"+k+"', '"+et+"'. Refer to getFontList() for available fonts."),oe||Mt.noFallback||(oe=qe.times[et])==null&&(oe=qe.times.normal),oe},xt=C.__private__.putInfo=function(){var k=de(),et=function(Vt){return Vt};for(var Mt in m!==null&&(et=kn.encryptor(k,0)),Ut("<<"),Ut("/Producer ("+Ti(et("jsPDF "+jr.version))+")"),fe)fe.hasOwnProperty(Mt)&&fe[Mt]&&Ut("/"+Mt.substr(0,1).toUpperCase()+Mt.substr(1)+" ("+Ti(et(fe[Mt]))+")");Ut("/CreationDate ("+Ti(et(te))+")"),Ut(">>"),Ut("endobj")},Qt=C.__private__.putCatalog=function(k){var et=(k=k||{}).rootDictionaryObjId||cr;switch(de(),Ut("<<"),Ut("/Type /Catalog"),Ut("/Pages "+et+" 0 R"),xe||(xe="fullwidth"),xe){case"fullwidth":Ut("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Ut("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Ut("/OpenAction [3 0 R /Fit]");break;case"original":Ut("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Mt=""+xe;Mt.substr(Mt.length-1)==="%"&&(xe=parseInt(xe)/100),typeof xe=="number"&&Ut("/OpenAction [3 0 R /XYZ null null "+Lt(xe)+"]")}switch(Sr||(Sr="continuous"),Sr){case"continuous":Ut("/PageLayout /OneColumn");break;case"single":Ut("/PageLayout /SinglePage");break;case"two":case"twoleft":Ut("/PageLayout /TwoColumnLeft");break;case"tworight":Ut("/PageLayout /TwoColumnRight")}ur&&Ut("/PageMode /"+ur),ot.publish("putCatalog"),Ut(">>"),Ut("endobj")},he=C.__private__.putTrailer=function(){Ut("trailer"),Ut("<<"),Ut("/Size "+(Wt+1)),Ut("/Root "+Wt+" 0 R"),Ut("/Info "+(Wt-1)+" 0 R"),m!==null&&Ut("/Encrypt "+kn.oid+" 0 R"),Ut("/ID [ <"+Zt+"> <"+Zt+"> ]"),Ut(">>")},Fe=C.__private__.putHeader=function(){Ut("%PDF-"+M),Ut("%")},ir=C.__private__.putXRef=function(){var k="0000000000";Ut("xref"),Ut("0 "+(Wt+1)),Ut("0000000000 65535 f ");for(var et=1;et<=Wt;et++)typeof jt[et]=="function"?Ut((k+jt[et]()).slice(-10)+" 00000 n "):jt[et]!==void 0?Ut((k+jt[et]).slice(-10)+" 00000 n "):Ut("0000000000 00000 n ")},Hr=C.__private__.buildDocument=function(){He(),ge(ae),ot.publish("buildDocument"),Fe(),vn(),Bs(),Xs(),m!==null&&wi(),xt(),Qt();var k=ie;return ir(),he(),Ut("startxref"),Ut(""+k),Ut("%%EOF"),ge(Te[vt]),ae.join(`
`)},Kn=C.__private__.getBlob=function(k){return new Blob([tr(k)],{type:"application/pdf"})},Jn=C.output=C.__private__.output=Mi(function(k,et){switch(typeof(et=et||{})=="string"?et={filename:et}:et.filename=et.filename||"generated.pdf",k){case void 0:return Hr();case"save":C.save(et.filename);break;case"arraybuffer":return tr(Hr());case"blob":return Kn(Hr());case"bloburi":case"bloburl":if(Vr.URL!==void 0&&typeof Vr.URL.createObjectURL=="function")return Vr.URL&&Vr.URL.createObjectURL(Kn(Hr()))||void 0;ci.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Mt="",Vt=Hr();try{Mt=f2(Vt)}catch{Mt=f2(unescape(encodeURIComponent(Vt)))}return"data:application/pdf;filename="+et.filename+";base64,"+Mt;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Vr)==="[object Window]"){var oe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ce=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';et.pdfObjectUrl&&(oe=et.pdfObjectUrl,ce="");var Me='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+oe+'"'+ce+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(et)+");<\/script></body></html>",ar=Vr.open();return ar!==null&&ar.document.write(Me),ar}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Vr)==="[object Window]"){var Mr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(et.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+et.filename+'" width="500px" height="400px" /></body></html>',zr=Vr.open();if(zr!==null){zr.document.write(Mr);var _r=this;zr.document.documentElement.querySelector("#pdfViewer").onload=function(){zr.document.title=et.filename,zr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(_r.output("bloburl"))}}return zr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Vr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var bn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",et)+'"></iframe></body></html>',vr=Vr.open();if(vr!==null&&(vr.document.write(bn),vr.document.title=et.filename),vr||typeof safari>"u")return vr;break;case"datauri":case"dataurl":return Vr.document.location.href=this.output("datauristring",et);default:return null}}),li=function(k){return Array.isArray(Et)===!0&&Et.indexOf(k)>-1};switch(n){case"pt":Oe=1;break;case"mm":Oe=72/25.4;break;case"cm":Oe=72/2.54;break;case"in":Oe=72;break;case"px":Oe=li("px_scaling")==1?.75:96/72;break;case"pc":case"em":Oe=12;break;case"ex":Oe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Oe=n}var kn=null;we(),Xt();var ZA=function(k){return m!==null?kn.encryptor(k,0):function(et){return et}},ol=C.__private__.getPageInfo=C.getPageInfo=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:J[k].objId,pageNumber:k,pageContext:J[k]}},Gr=C.__private__.getPageInfoByObjId=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var et in J)if(J[et].objId===k)break;return ol(et)},Na=C.__private__.getCurrentPageInfo=C.getCurrentPageInfo=function(){return{objId:J[vt].objId,pageNumber:vt,pageContext:J[vt]}};C.addPage=function(){return zo.apply(this,arguments),this},C.setPage=function(){return Ys.apply(this,arguments),ge.call(this,Te[vt]),this},C.insertPage=function(k){return this.addPage(),this.movePage(vt,k),this},C.movePage=function(k,et){var Mt,Vt;if(k>et){Mt=Te[k],Vt=J[k];for(var oe=k;oe>et;oe--)Te[oe]=Te[oe-1],J[oe]=J[oe-1];Te[et]=Mt,J[et]=Vt,this.setPage(et)}else if(k<et){Mt=Te[k],Vt=J[k];for(var ce=k;ce<et;ce++)Te[ce]=Te[ce+1],J[ce]=J[ce+1];Te[et]=Mt,J[et]=Vt,this.setPage(et)}return this},C.deletePage=function(){return Go.apply(this,arguments),this},C.__private__.text=C.text=function(k,et,Mt,Vt,oe){var ce,Me,ar,Mr,zr,_r,bn,vr,ui,qr=(Vt=Vt||{}).scope||this;if(typeof k=="number"&&typeof et=="number"&&(typeof Mt=="string"||Array.isArray(Mt))){var $r=Mt;Mt=et,et=k,k=$r}if(arguments[3]instanceof St?(dt("The transform parameter of text() with a Matrix value"),ui=oe):(ar=arguments[4],Mr=arguments[5],On(bn=arguments[3])==="object"&&bn!==null||(typeof ar=="string"&&(Mr=ar,ar=null),typeof bn=="string"&&(Mr=bn,bn=null),typeof bn=="number"&&(ar=bn,bn=null),Vt={flags:bn,angle:ar,align:Mr})),isNaN(et)||isNaN(Mt)||k==null)throw new Error("Invalid arguments passed to jsPDF.text");if(k.length===0)return qr;var ii="",Ds=!1,ks=typeof Vt.lineHeightFactor=="number"?Vt.lineHeightFactor:pa,ya=qr.internal.scaleFactor;function dl(_n){return _n=_n.split("	").join(Array(Vt.TabLen||9).join(" ")),Ti(_n,bn)}function bc(_n){for(var In,Ln=_n.concat(),Zn=[],ja=Ln.length;ja--;)typeof(In=Ln.shift())=="string"?Zn.push(In):Array.isArray(_n)&&(In.length===1||In[1]===void 0&&In[2]===void 0)?Zn.push(In[0]):Zn.push([In[0],In[1],In[2]]);return Zn}function wc(_n,In){var Ln;if(typeof _n=="string")Ln=In(_n)[0];else if(Array.isArray(_n)){for(var Zn,ja,wa=_n.concat(),uu=[],qa=wa.length;qa--;)typeof(Zn=wa.shift())=="string"?uu.push(In(Zn)[0]):Array.isArray(Zn)&&typeof Zn[0]=="string"&&(ja=In(Zn[0],Zn[1],Zn[2]),uu.push([ja[0],ja[1],ja[2]]));Ln=uu}return Ln}var fl=!1,xc=!0;if(typeof k=="string")fl=!0;else if(Array.isArray(k)){var au=k.concat();Me=[];for(var za,as=au.length;as--;)(typeof(za=au.shift())!="string"||Array.isArray(za)&&typeof za[0]!="string")&&(xc=!1);fl=xc}if(fl===!1)throw new Error('Type of text must be string or Array. "'+k+'" is not recognized.');typeof k=="string"&&(k=k.match(/[\r?\n]/)?k.split(/\r\n|\r|\n/g):[k]);var Bc=_e/qr.internal.scaleFactor,pl=Bc*(ks-1);switch(Vt.baseline){case"bottom":Mt-=pl;break;case"top":Mt+=Bc-pl;break;case"hanging":Mt+=Bc-2*pl;break;case"middle":Mt+=Bc/2-pl}if((_r=Vt.maxWidth||0)>0&&(typeof k=="string"?k=qr.splitTextToSize(k,_r):Object.prototype.toString.call(k)==="[object Array]"&&(k=k.reduce(function(_n,In){return _n.concat(qr.splitTextToSize(In,_r))},[]))),ce={text:k,x:et,y:Mt,options:Vt,mutex:{pdfEscape:Ti,activeFontKey:Tr,fonts:Xe,activeFontSize:_e}},ot.publish("preProcessText",ce),k=ce.text,ar=(Vt=ce.options).angle,!(ui instanceof St)&&ar&&typeof ar=="number"){ar*=Math.PI/180,Vt.rotationDirection===0&&(ar=-ar),Y===q.ADVANCED&&(ar=-ar);var gl=Math.cos(ar),Cc=Math.sin(ar);ui=new St(gl,Cc,-Cc,gl,0,0)}else ar&&ar instanceof St&&(ui=ar);Y!==q.ADVANCED||ui||(ui=me),(zr=Vt.charSpace||nu)!==void 0&&(ii+=mt(ct(zr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(vr=Vt.horizontalScale)!==void 0&&(ii+=mt(100*vr)+` Tz
`),Vt.lang;var _s=-1,hd=Vt.renderingMode!==void 0?Vt.renderingMode:Vt.stroke,cu=qr.internal.getCurrentPageInfo().pageContext;switch(hd){case 0:case!1:case"fill":_s=0;break;case 1:case!0:case"stroke":_s=1;break;case 2:case"fillThenStroke":_s=2;break;case 3:case"invisible":_s=3;break;case 4:case"fillAndAddForClipping":_s=4;break;case 5:case"strokeAndAddPathForClipping":_s=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":_s=6;break;case 7:case"addToPathForClipping":_s=7}var Wn=cu.usedRenderingMode!==void 0?cu.usedRenderingMode:-1;_s!==-1?ii+=_s+` Tr
`:Wn!==-1&&(ii+=`0 Tr
`),_s!==-1&&(cu.usedRenderingMode=_s),Mr=Vt.align||"left";var Vi,Ui=_e*ks,Zu=qr.internal.pageSize.getWidth(),lu=Xe[Tr];zr=Vt.charSpace||nu,_r=Vt.maxWidth||0,bn=Object.assign({autoencode:!0,noBOM:!0},Vt.flags);var Ga=[];if(Object.prototype.toString.call(k)==="[object Array]"){var Ri;Me=bc(k),Mr!=="left"&&(Vi=Me.map(function(_n){return qr.getStringUnitWidth(_n,{font:lu,charSpace:zr,fontSize:_e,doKerning:!1})*_e/ya}));var ji,Js=0;if(Mr==="right"){et-=Vi[0],k=[],as=Me.length;for(var vo=0;vo<as;vo++)vo===0?(ji=Vo(et),Ri=jo(Mt)):(ji=ct(Js-Vi[vo]),Ri=-Ui),k.push([Me[vo],ji,Ri]),Js=Vi[vo]}else if(Mr==="center"){et-=Vi[0]/2,k=[],as=Me.length;for(var bo=0;bo<as;bo++)bo===0?(ji=Vo(et),Ri=jo(Mt)):(ji=ct((Js-Vi[bo])/2),Ri=-Ui),k.push([Me[bo],ji,Ri]),Js=Vi[bo]}else if(Mr==="left"){k=[],as=Me.length;for(var Ec=0;Ec<as;Ec++)k.push(Me[Ec])}else{if(Mr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');k=[],as=Me.length,_r=_r!==0?_r:Zu;for(var Zs=0;Zs<as;Zs++)Ri=Zs===0?jo(Mt):-Ui,ji=Zs===0?Vo(et):0,Zs<as-1?Ga.push(mt(ct((_r-Vi[Zs])/(Me[Zs].split(" ").length-1)))):Ga.push(0),k.push([Me[Zs],ji,Ri])}}var _a=typeof Vt.R2L=="boolean"?Vt.R2L:nr;_a===!0&&(k=wc(k,function(_n,In,Ln){return[_n.split("").reverse().join(""),In,Ln]})),ce={text:k,x:et,y:Mt,options:Vt,mutex:{pdfEscape:Ti,activeFontKey:Tr,fonts:Xe,activeFontSize:_e}},ot.publish("postProcessText",ce),k=ce.text,Ds=ce.mutex.isHex||!1;var Wo=Xe[Tr].encoding;Wo!=="WinAnsiEncoding"&&Wo!=="StandardEncoding"||(k=wc(k,function(_n,In,Ln){return[dl(_n),In,Ln]})),Me=bc(k),k=[];for(var Va,wo,va,Sc=0,ba=1,$o=Array.isArray(Me[0])?ba:Sc,Bi="",Ns=function(_n,In,Ln){var Zn="";return Ln instanceof St?(Ln=typeof Vt.angle=="number"?Jt(Ln,new St(1,0,0,1,_n,In)):Jt(new St(1,0,0,1,_n,In),Ln),Y===q.ADVANCED&&(Ln=Jt(new St(1,0,0,-1,0,0),Ln)),Zn=Ln.join(" ")+` Tm
`):Zn=mt(_n)+" "+mt(In)+` Td
`,Zn},Qs=0;Qs<Me.length;Qs++){switch(Bi="",$o){case ba:va=(Ds?"<":"(")+Me[Qs][0]+(Ds?">":")"),Va=parseFloat(Me[Qs][1]),wo=parseFloat(Me[Qs][2]);break;case Sc:va=(Ds?"<":"(")+Me[Qs]+(Ds?">":")"),Va=Vo(et),wo=jo(Mt)}Ga!==void 0&&Ga[Qs]!==void 0&&(Bi=Ga[Qs]+` Tw
`),Qs===0?k.push(Bi+Ns(Va,wo,ui)+va):$o===Sc?k.push(Bi+va):$o===ba&&k.push(Bi+Ns(Va,wo,ui)+va)}k=$o===Sc?k.join(` Tj
T* `):k.join(` Tj
`),k+=` Tj
`;var Oi=`BT
/`;return Oi+=Tr+" "+_e+` Tf
`,Oi+=mt(_e*ks)+` TL
`,Oi+=mc+`
`,Oi+=ii,Oi+=k,Ut(Oi+="ET"),x[Tr]=!0,qr};var tu=C.__private__.clip=C.clip=function(k){return Ut(k==="evenodd"?"W*":"W"),this};C.clipEvenOdd=function(){return tu("evenodd")},C.__private__.discardPath=C.discardPath=function(){return Ut("n"),this};var yi=C.__private__.isValidStyle=function(k){var et=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(k)!==-1&&(et=!0),et};C.__private__.setDefaultPathOperation=C.setDefaultPathOperation=function(k){return yi(k)&&(f=k),this};var fc=C.__private__.getStyle=C.getStyle=function(k){var et=f;switch(k){case"D":case"S":et="S";break;case"F":et="f";break;case"FD":case"DF":et="B";break;case"f":case"f*":case"B":case"B*":et=k}return et},al=C.close=function(){return Ut("h"),this};C.stroke=function(){return Ut("S"),this},C.fill=function(k){return fa("f",k),this},C.fillEvenOdd=function(k){return fa("f*",k),this},C.fillStroke=function(k){return fa("B",k),this},C.fillStrokeEvenOdd=function(k){return fa("B*",k),this};var fa=function(k,et){On(et)==="object"?ll(et,k):Ut(k)},Qa=function(k){k===null||Y===q.ADVANCED&&k===void 0||(k=fc(k),Ut(k))};function cl(k,et,Mt,Vt,oe){var ce=new mf(et||this.boundingBox,Mt||this.xStep,Vt||this.yStep,this.gState,oe||this.matrix);ce.stream=this.stream;var Me=k+"$$"+this.cloneIndex+++"$$";return pe(Me,ce),ce}var ll=function(k,et){var Mt=pr[k.key],Vt=Rr[Mt];if(Vt instanceof zh)Ut("q"),Ut(ud(et)),Vt.gState&&C.setGState(Vt.gState),Ut(k.matrix.toString()+" cm"),Ut("/"+Mt+" sh"),Ut("Q");else if(Vt instanceof mf){var oe=new St(1,0,0,-1,0,ma());k.matrix&&(oe=oe.multiply(k.matrix||me),Mt=cl.call(Vt,k.key,k.boundingBox,k.xStep,k.yStep,oe).id),Ut("q"),Ut("/Pattern cs"),Ut("/"+Mt+" scn"),Vt.gState&&C.setGState(Vt.gState),Ut(et),Ut("Q")}},ud=function(k){switch(k){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Wu=C.moveTo=function(k,et){return Ut(mt(ct(k))+" "+mt(yt(et))+" m"),this},pc=C.lineTo=function(k,et){return Ut(mt(ct(k))+" "+mt(yt(et))+" l"),this},gc=C.curveTo=function(k,et,Mt,Vt,oe,ce){return Ut([mt(ct(k)),mt(yt(et)),mt(ct(Mt)),mt(yt(Vt)),mt(ct(oe)),mt(yt(ce)),"c"].join(" ")),this};C.__private__.line=C.line=function(k,et,Mt,Vt,oe){if(isNaN(k)||isNaN(et)||isNaN(Mt)||isNaN(Vt)||!yi(oe))throw new Error("Invalid arguments passed to jsPDF.line");return Y===q.COMPAT?this.lines([[Mt-k,Vt-et]],k,et,[1,1],oe||"S"):this.lines([[Mt-k,Vt-et]],k,et,[1,1]).stroke()},C.__private__.lines=C.lines=function(k,et,Mt,Vt,oe,ce){var Me,ar,Mr,zr,_r,bn,vr,ui,qr,$r,ii,Ds;if(typeof k=="number"&&(Ds=Mt,Mt=et,et=k,k=Ds),Vt=Vt||[1,1],ce=ce||!1,isNaN(et)||isNaN(Mt)||!Array.isArray(k)||!Array.isArray(Vt)||!yi(oe)||typeof ce!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Wu(et,Mt),Me=Vt[0],ar=Vt[1],zr=k.length,$r=et,ii=Mt,Mr=0;Mr<zr;Mr++)(_r=k[Mr]).length===2?($r=_r[0]*Me+$r,ii=_r[1]*ar+ii,pc($r,ii)):(bn=_r[0]*Me+$r,vr=_r[1]*ar+ii,ui=_r[2]*Me+$r,qr=_r[3]*ar+ii,$r=_r[4]*Me+$r,ii=_r[5]*ar+ii,gc(bn,vr,ui,qr,$r,ii));return ce&&al(),Qa(oe),this},C.path=function(k){for(var et=0;et<k.length;et++){var Mt=k[et],Vt=Mt.c;switch(Mt.op){case"m":Wu(Vt[0],Vt[1]);break;case"l":pc(Vt[0],Vt[1]);break;case"c":gc.apply(this,Vt);break;case"h":al()}}return this},C.__private__.rect=C.rect=function(k,et,Mt,Vt,oe){if(isNaN(k)||isNaN(et)||isNaN(Mt)||isNaN(Vt)||!yi(oe))throw new Error("Invalid arguments passed to jsPDF.rect");return Y===q.COMPAT&&(Vt=-Vt),Ut([mt(ct(k)),mt(yt(et)),mt(ct(Mt)),mt(ct(Vt)),"re"].join(" ")),Qa(oe),this},C.__private__.triangle=C.triangle=function(k,et,Mt,Vt,oe,ce,Me){if(isNaN(k)||isNaN(et)||isNaN(Mt)||isNaN(Vt)||isNaN(oe)||isNaN(ce)||!yi(Me))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Mt-k,Vt-et],[oe-Mt,ce-Vt],[k-oe,et-ce]],k,et,[1,1],Me,!0),this},C.__private__.roundedRect=C.roundedRect=function(k,et,Mt,Vt,oe,ce,Me){if(isNaN(k)||isNaN(et)||isNaN(Mt)||isNaN(Vt)||isNaN(oe)||isNaN(ce)||!yi(Me))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ar=4/3*(Math.SQRT2-1);return oe=Math.min(oe,.5*Mt),ce=Math.min(ce,.5*Vt),this.lines([[Mt-2*oe,0],[oe*ar,0,oe,ce-ce*ar,oe,ce],[0,Vt-2*ce],[0,ce*ar,-oe*ar,ce,-oe,ce],[2*oe-Mt,0],[-oe*ar,0,-oe,-ce*ar,-oe,-ce],[0,2*ce-Vt],[0,-ce*ar,oe*ar,-ce,oe,-ce]],k+oe,et,[1,1],Me,!0),this},C.__private__.ellipse=C.ellipse=function(k,et,Mt,Vt,oe){if(isNaN(k)||isNaN(et)||isNaN(Mt)||isNaN(Vt)||!yi(oe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ce=4/3*(Math.SQRT2-1)*Mt,Me=4/3*(Math.SQRT2-1)*Vt;return Wu(k+Mt,et),gc(k+Mt,et-Me,k+ce,et-Vt,k,et-Vt),gc(k-ce,et-Vt,k-Mt,et-Me,k-Mt,et),gc(k-Mt,et+Me,k-ce,et+Vt,k,et+Vt),gc(k+ce,et+Vt,k+Mt,et+Me,k+Mt,et),Qa(oe),this},C.__private__.circle=C.circle=function(k,et,Mt,Vt){if(isNaN(k)||isNaN(et)||isNaN(Mt)||!yi(Vt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(k,et,Mt,Mt,Vt)},C.setFont=function(k,et,Mt){return Mt&&(et=pt(et,Mt)),Tr=At(k,et,{disableWarning:!1}),this};var Ha=C.__private__.getFont=C.getFont=function(){return Xe[At.apply(C,arguments)]};C.__private__.getFontList=C.getFontList=function(){var k,et,Mt={};for(k in qe)if(qe.hasOwnProperty(k))for(et in Mt[k]=[],qe[k])qe[k].hasOwnProperty(et)&&Mt[k].push(et);return Mt},C.addFont=function(k,et,Mt,Vt,oe){var ce=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ce.indexOf(arguments[3])!==-1?oe=arguments[3]:arguments[3]&&ce.indexOf(arguments[3])==-1&&(Mt=pt(Mt,Vt)),oe=oe||"Identity-H",_o.call(this,k,et,Mt,oe)};var pa,Pi=r.lineWidth||.200025,xi=C.__private__.getLineWidth=C.getLineWidth=function(){return Pi},cn=C.__private__.setLineWidth=C.setLineWidth=function(k){return Pi=k,Ut(mt(ct(k))+" w"),this};C.__private__.setLineDash=jr.API.setLineDash=jr.API.setLineDashPattern=function(k,et){if(k=k||[],et=et||0,isNaN(et)||!Array.isArray(k))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return k=k.map(function(Mt){return mt(ct(Mt))}).join(" "),et=mt(ct(et)),Ut("["+k+"] "+et+" d"),this};var ul=C.__private__.getLineHeight=C.getLineHeight=function(){return _e*pa};C.__private__.getLineHeight=C.getLineHeight=function(){return _e*pa};var Al=C.__private__.setLineHeightFactor=C.setLineHeightFactor=function(k){return typeof(k=k||1.15)=="number"&&(pa=k),this},eu=C.__private__.getLineHeightFactor=C.getLineHeightFactor=function(){return pa};Al(r.lineHeight);var Vo=C.__private__.getHorizontalCoordinate=function(k){return ct(k)},jo=C.__private__.getVerticalCoordinate=function(k){return Y===q.ADVANCED?k:J[vt].mediaBox.topRightY-J[vt].mediaBox.bottomLeftY-ct(k)},$u=C.__private__.getHorizontalCoordinateString=C.getHorizontalCoordinateString=function(k){return mt(Vo(k))},ga=C.__private__.getVerticalCoordinateString=C.getVerticalCoordinateString=function(k){return mt(jo(k))},Os=r.strokeColor||"0 G";C.__private__.getStrokeColor=C.getDrawColor=function(){return kr(Os)},C.__private__.setStrokeColor=C.setDrawColor=function(k,et,Mt,Vt){return Os=Qr({ch1:k,ch2:et,ch3:Mt,ch4:Vt,pdfColorType:"draw",precision:2}),Ut(Os),this};var ru=r.fillColor||"0 g";C.__private__.getFillColor=C.getFillColor=function(){return kr(ru)},C.__private__.setFillColor=C.setFillColor=function(k,et,Mt,Vt){return ru=Qr({ch1:k,ch2:et,ch3:Mt,ch4:Vt,pdfColorType:"fill",precision:2}),Ut(ru),this};var mc=r.textColor||"0 g",yc=C.__private__.getTextColor=C.getTextColor=function(){return kr(mc)};C.__private__.setTextColor=C.setTextColor=function(k,et,Mt,Vt){return mc=Qr({ch1:k,ch2:et,ch3:Mt,ch4:Vt,pdfColorType:"text",precision:3}),this};var nu=r.charSpace,Ad=C.__private__.getCharSpace=C.getCharSpace=function(){return parseFloat(nu||0)};C.__private__.setCharSpace=C.setCharSpace=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return nu=k,this};var Xu=0;C.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},C.__private__.setLineCap=C.setLineCap=function(k){var et=C.CapJoinStyles[k];if(et===void 0)throw new Error("Line cap style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Xu=et,Ut(et+" J"),this};var Yu=0;C.__private__.setLineJoin=C.setLineJoin=function(k){var et=C.CapJoinStyles[k];if(et===void 0)throw new Error("Line join style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Yu=et,Ut(et+" j"),this},C.__private__.setLineMiterLimit=C.__private__.setMiterLimit=C.setLineMiterLimit=C.setMiterLimit=function(k){if(k=k||0,isNaN(k))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Ut(mt(ct(k))+" M"),this},C.GState=Ay,C.setGState=function(k){(k=typeof k=="string"?on[Kr[k]]:th(null,k)).equals(Ct)||(Ut("/"+k.id+" gs"),Ct=k)};var th=function(k,et){if(!k||!Kr[k]){var Mt=!1;for(var Vt in on)if(on.hasOwnProperty(Vt)&&on[Vt].equals(et)){Mt=!0;break}if(Mt)et=on[Vt];else{var oe="GS"+(Object.keys(on).length+1).toString(10);on[oe]=et,et.id=oe}return k&&(Kr[k]=et.id),ot.publish("addGState",et),et}};C.addGState=function(k,et){return th(k,et),this},C.saveGraphicsState=function(){return Ut("q"),Yr.push({key:Tr,size:_e,color:mc}),this},C.restoreGraphicsState=function(){Ut("Q");var k=Yr.pop();return Tr=k.key,_e=k.size,mc=k.color,Ct=null,this},C.setCurrentTransformationMatrix=function(k){return Ut(k.toString()+" cm"),this},C.comment=function(k){return Ut("#"+k),this};var iu=function(k,et){var Mt=k||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Mt},set:function(ce){isNaN(ce)||(Mt=parseFloat(ce))}});var Vt=et||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Vt},set:function(ce){isNaN(ce)||(Vt=parseFloat(ce))}});var oe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return oe},set:function(ce){oe=ce.toString()}}),this},hl=function(k,et,Mt,Vt){iu.call(this,k,et),this.type="rect";var oe=Mt||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return oe},set:function(Me){isNaN(Me)||(oe=parseFloat(Me))}});var ce=Vt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ce},set:function(Me){isNaN(Me)||(ce=parseFloat(Me))}}),this},_c=function(){this.page=Z,this.currentPage=vt,this.pages=Te.slice(0),this.pagesContext=J.slice(0),this.x=wn,this.y=Fr,this.matrix=Se,this.width=vc(vt),this.height=ma(vt),this.outputDestination=Qe,this.id="",this.objectNumber=-1};_c.prototype.restore=function(){Z=this.page,vt=this.currentPage,J=this.pagesContext,Te=this.pages,wn=this.x,Fr=this.y,Se=this.matrix,ou(vt,this.width),Ko(vt,this.height),Qe=this.outputDestination};var su=function(k,et,Mt,Vt,oe){qt.push(new _c),Z=vt=0,Te=[],wn=k,Fr=et,Se=oe,an([Mt,Vt])},Ju=function(k){if(zt[k])qt.pop().restore();else{var et=new _c,Mt="Xo"+(Object.keys(Nt).length+1).toString(10);et.id=Mt,zt[k]=Mt,Nt[Mt]=et,ot.publish("addFormObject",et),qt.pop().restore()}};for(var qo in C.beginFormObject=function(k,et,Mt,Vt,oe){return su(k,et,Mt,Vt,oe),this},C.endFormObject=function(k){return Ju(k),this},C.doFormObject=function(k,et){var Mt=Nt[zt[k]];return Ut("q"),Ut(et.toString()+" cm"),Ut("/"+Mt.id+" Do"),Ut("Q"),this},C.getFormObject=function(k){var et=Nt[zt[k]];return{x:et.x,y:et.y,width:et.width,height:et.height,matrix:et.matrix}},C.save=function(k,et){return k=k||"generated.pdf",(et=et||{}).returnPromise=et.returnPromise||!1,et.returnPromise===!1?(Hh(Kn(Hr()),k),typeof Hh.unload=="function"&&Vr.setTimeout&&setTimeout(Hh.unload,911),this):new Promise(function(Mt,Vt){try{var oe=Hh(Kn(Hr()),k);typeof Hh.unload=="function"&&Vr.setTimeout&&setTimeout(Hh.unload,911),Mt(oe)}catch(ce){Vt(ce.message)}})},jr.API)jr.API.hasOwnProperty(qo)&&(qo==="events"&&jr.API.events.length?function(k,et){var Mt,Vt,oe;for(oe=et.length-1;oe!==-1;oe--)Mt=et[oe][0],Vt=et[oe][1],k.subscribe.apply(k,[Mt].concat(typeof Vt=="function"?[Vt]:Vt))}(ot,jr.API.events):C[qo]=jr.API[qo]);var vc=C.getPageWidth=function(k){return(J[k=k||vt].mediaBox.topRightX-J[k].mediaBox.bottomLeftX)/Oe},ou=C.setPageWidth=function(k,et){J[k].mediaBox.topRightX=et*Oe+J[k].mediaBox.bottomLeftX},ma=C.getPageHeight=function(k){return(J[k=k||vt].mediaBox.topRightY-J[k].mediaBox.bottomLeftY)/Oe},Ko=C.setPageHeight=function(k,et){J[k].mediaBox.topRightY=et*Oe+J[k].mediaBox.bottomLeftY};return C.internal={pdfEscape:Ti,getStyle:fc,getFont:Ha,getFontSize:De,getCharSpace:Ad,getTextColor:yc,getLineHeight:ul,getLineHeightFactor:eu,getLineWidth:xi,write:Yt,getHorizontalCoordinate:Vo,getVerticalCoordinate:jo,getCoordinateString:$u,getVerticalCoordinateString:ga,collections:{},newObject:de,newAdditionalObject:Cr,newObjectDeferred:Ge,newObjectDeferredBegin:Ye,getFilters:gn,putStream:gr,events:ot,scaleFactor:Oe,pageSize:{getWidth:function(){return vc(vt)},setWidth:function(k){ou(vt,k)},getHeight:function(){return ma(vt)},setHeight:function(k){Ko(vt,k)}},encryptionOptions:m,encryption:kn,getEncryptor:ZA,output:Jn,getNumberOfPages:dc,pages:Te,out:Ut,f2:Lt,f3:st,getPageInfo:ol,getPageInfoByObjId:Gr,getCurrentPageInfo:Na,getPDFVersion:U,Point:iu,Rectangle:hl,Matrix:St,hasHotfix:li},Object.defineProperty(C.internal.pageSize,"width",{get:function(){return vc(vt)},set:function(k){ou(vt,k)},enumerable:!0,configurable:!0}),Object.defineProperty(C.internal.pageSize,"height",{get:function(){return ma(vt)},set:function(k){Ko(vt,k)},enumerable:!0,configurable:!0}),Fi.call(C,Ee),Tr="F1",zo(i,e),ot.publish("initialized"),C}pf.prototype.lsbFirstWord=function(r){return String.fromCharCode(r>>0&255,r>>8&255,r>>16&255,r>>24&255)},pf.prototype.toHexString=function(r){return r.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},pf.prototype.hexToBytes=function(r){for(var t=[],e=0;e<r.length;e+=2)t.push(String.fromCharCode(parseInt(r.substr(e,2),16)));return t.join("")},pf.prototype.processOwnerPassword=function(r,t){return m2(g2(t).substr(0,5),r)},pf.prototype.encryptor=function(r,t){var e=g2(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return m2(e,n)}},Ay.prototype.equals=function(r){var t,e="id,objectNumber,equals";if(!r||On(r)!==On(this))return!1;var n=0;for(t in this)if(!(e.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!r.hasOwnProperty(t)||this[t]!==r[t])return!1;n++}for(t in r)r.hasOwnProperty(t)&&e.indexOf(t)<0&&n--;return n===0},jr.API={events:[]},jr.version="2.5.1";var zi=jr.API,y2=1,Gh=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},yf=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Jr=function(r){return r.toFixed(2)},DA=function(r){return r.toFixed(5)};zi.__acroform__={};var ua=function(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r},FF=function(r){return r*y2},ql=function(r){var t=new PF,e=yr.internal.getHeight(r)||0,n=yr.internal.getWidth(r)||0;return t.BBox=[0,0,Number(Jr(n)),Number(Jr(e))],t},met=zi.__acroform__.setBit=function(r,t){if(r=r||0,t=t||0,isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|=1<<t},yet=zi.__acroform__.clearBit=function(r,t){if(r=r||0,t=t||0,isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&=~(1<<t)},_et=zi.__acroform__.getBit=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return r&1<<t?1:0},Xi=zi.__acroform__.getBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return _et(r,t-1)},Yi=zi.__acroform__.setBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return met(r,t-1)},Ji=zi.__acroform__.clearBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return yet(r,t-1)},vet=zi.__acroform__.calculateCoordinates=function(r,t){var e=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,i=r[0],s=r[1],a=r[2],o=r[3],A={};return A.lowerLeft_X=e(i)||0,A.lowerLeft_Y=n(s+o)||0,A.upperRight_X=e(i+a)||0,A.upperRight_Y=n(s)||0,[Number(Jr(A.lowerLeft_X)),Number(Jr(A.lowerLeft_Y)),Number(Jr(A.upperRight_X)),Number(Jr(A.upperRight_Y))]},bet=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var t=[],e=r._V||r.DV,n=_2(r,e),i=r.scope.internal.getFont(r.fontName,r.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(r.scope.__private__.encodeColorString(r.color)),t.push("/"+i+" "+Jr(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=ql(r);return s.scope=r.scope,s.stream=t.join(`
`),s}},_2=function(r,t){var e=r.fontSize===0?r.maxFontSize:r.fontSize,n={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=r.multiline?i.map(function(st){return st.split(`
`)}):i.map(function(st){return[st]});var s=e,a=yr.internal.getHeight(r)||0;a=a<0?-a:a;var o=yr.internal.getWidth(r)||0;o=o<0?-o:o;var A=function(st,ct,wt){if(st+1<i.length){var yt=ct+" "+i[st+1][0];return hy(yt,r,wt).width<=o-4}return!1};s++;t:for(;s>0;){t="",s--;var f,m,b=hy("3",r,s).height,x=r.multiline?a-s:(a-b)/2,C=x+=2,M=0,U=0,N=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+hy(t,r,s=12).width+", FieldWidth:"+o+`
`;break}for(var Q="",q=0,Y=0;Y<i.length;Y++)if(i.hasOwnProperty(Y)){var tt=!1;if(i[Y].length!==1&&N!==i[Y].length-1){if((b+2)*(q+2)+2>a)continue t;Q+=i[Y][N],tt=!0,U=Y,Y--}else{Q=(Q+=i[Y][N]+" ").substr(Q.length-1)==" "?Q.substr(0,Q.length-1):Q;var ft=parseInt(Y),pt=A(ft,Q,s),mt=Y>=i.length-1;if(pt&&!mt){Q+=" ",N=0;continue}if(pt||mt){if(mt)U=ft;else if(r.multiline&&(b+2)*(q+2)+2>a)continue t}else{if(!r.multiline||(b+2)*(q+2)+2>a)continue t;U=ft}}for(var dt="",Rt=M;Rt<=U;Rt++){var Lt=i[Rt];if(r.multiline){if(Rt===U){dt+=Lt[N]+" ",N=(N+1)%Lt.length;continue}if(Rt===M){dt+=Lt[Lt.length-1]+" ";continue}}dt+=Lt[0]+" "}switch(dt=dt.substr(dt.length-1)==" "?dt.substr(0,dt.length-1):dt,m=hy(dt,r,s).width,r.textAlign){case"right":f=o-m-2;break;case"center":f=(o-m)/2;break;case"left":default:f=2}t+=Jr(f)+" "+Jr(C)+` Td
`,t+="("+Gh(dt)+`) Tj
`,t+=-Jr(f)+` 0 Td
`,C=-(s+2),m=0,M=tt?U:U+1,q++,Q=""}break}return n.text=t,n.fontSize=s,n},hy=function(r,t,e){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(r,{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e)*1.5,width:i}},wet={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},xet=function(r,t){var e={type:"reference",object:r};t.internal.getPageInfo(r.page).pageContext.annotations.find(function(n){return n.type===e.type&&n.object===e.object})===void 0&&t.internal.getPageInfo(r.page).pageContext.annotations.push(e)},Bet=function(r,t){for(var e in r)if(r.hasOwnProperty(e)){var n=e,i=r[e];t.internal.newObjectDeferredBegin(i.objId,!0),On(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete r[n]}},Cet=function(r,t){if(t.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(qc.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(wet)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");y2=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new UF,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(e){e.internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var s=n[i];s.objId=void 0,s.hasAnnotation&&xet(s,e)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(e){if(e.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(e){(function(n,i){var s=!n;for(var a in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(a)){var o=n[a],A=[],f=o.Rect;if(o.Rect&&(o.Rect=vet(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=yr.createDefaultAppearanceStream(o),On(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(A=o.getKeyValueListForStream()),o.Rect=f,o.hasAppearanceStream&&!o.appearanceStreamContent){var m=bet(o);A.push({key:"AP",value:"<</N "+m+">>"}),i.internal.acroformPlugin.xForms.push(m)}if(o.appearanceStreamContent){var b="";for(var x in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(x)){var C=o.appearanceStreamContent[x];if(b+="/"+x+" ",b+="<<",Object.keys(C).length>=1||Array.isArray(C)){for(var a in C)if(C.hasOwnProperty(a)){var M=C[a];typeof M=="function"&&(M=M.call(i,o)),b+="/"+a+" "+M+" ",i.internal.acroformPlugin.xForms.indexOf(M)>=0||i.internal.acroformPlugin.xForms.push(M)}}else typeof(M=C)=="function"&&(M=M.call(i,o)),b+="/"+a+" "+M,i.internal.acroformPlugin.xForms.indexOf(M)>=0||i.internal.acroformPlugin.xForms.push(M);b+=">>"}A.push({key:"AP",value:`<<
`+b+">>"})}i.internal.putStream({additionalKeyValues:A,objectId:o.objId}),i.internal.out("endobj")}s&&Bet(i.internal.acroformPlugin.xForms,i)})(e,r)}),r.internal.acroformPlugin.isInitialized=!0}},MF=zi.__acroform__.arrayToPdfArray=function(r,t,e){var n=function(a){return a};if(Array.isArray(r)){for(var i="[",s=0;s<r.length;s++)switch(s!==0&&(i+=" "),On(r[s])){case"boolean":case"number":case"object":i+=r[s].toString();break;case"string":r[s].substr(0,1)!=="/"?(t!==void 0&&e&&(n=e.internal.getEncryptor(t)),i+="("+Gh(n(r[s].toString()))+")"):i+=r[s].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},v2=function(r,t,e){var n=function(i){return i};return t!==void 0&&e&&(n=e.internal.getEncryptor(t)),(r=r||"").toString(),r="("+Gh(n(r))+")"},Kl=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Kl.prototype.toString=function(){return this.objId+" 0 R"},Kl.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},Kl.prototype.getKeyValueListForStream=function(){var r=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var e in t)if(Object.getOwnPropertyDescriptor(this,t[e]).configurable===!1){var n=t[e],i=this[n];i&&(Array.isArray(i)?r.push({key:n,value:MF(i,this.objId,this.scope)}):i instanceof Kl?(i.scope=this.scope,r.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&r.push({key:n,value:i}))}return r};var PF=function(){Kl.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){r=e.trim()},get:function(){return r||null}})};ua(PF,Kl);var UF=function(){Kl.call(this);var r,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var e=function(n){return n};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+Gh(e(r))+")"}},set:function(e){r=e}})};ua(UF,Kl);var qc=function r(){Kl.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(Q){if(isNaN(Q))throw new Error('Invalid value "'+Q+'" for attribute F supplied.');t=Q}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Xi(t,3)},set:function(Q){Q?this.F=Yi(t,3):this.F=Ji(t,3)}});var e=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return e},set:function(Q){if(isNaN(Q))throw new Error('Invalid value "'+Q+'" for attribute Ff supplied.');e=Q}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(Q){n=Q!==void 0?Q:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(Q){n[0]=Q}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(Q){n[1]=Q}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(Q){n[2]=Q}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(Q){n[3]=Q}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(Q){switch(Q){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=Q;break;default:throw new Error('Invalid value "'+Q+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof py)return;s="FieldObject"+r.FieldNum++}var Q=function(q){return q};return this.scope&&(Q=this.scope.internal.getEncryptor(this.objId)),"("+Gh(Q(s))+")"},set:function(Q){s=Q.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(Q){s=Q}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(Q){a=Q}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(Q){o=Q}});var A=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return A},set:function(Q){A=Q}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/y2:f},set:function(Q){f=Q}});var m="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return m},set:function(Q){m=Q}});var b="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!b||this instanceof py||this instanceof Vh))return v2(b,this.objId,this.scope)},set:function(Q){Q=Q.toString(),b=Q}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof Ms?x:v2(x,this.objId,this.scope)},set:function(Q){Q=Q.toString(),x=this instanceof Ms?Q:Q.substr(0,1)==="("?yf(Q.substr(1,Q.length-2)):yf(Q)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ms?yf(x.substr(1,x.length-1)):x},set:function(Q){Q=Q.toString(),x=this instanceof Ms?"/"+Q:Q}});var C=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(C)return C},set:function(Q){this.V=Q}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(C)return this instanceof Ms?C:v2(C,this.objId,this.scope)},set:function(Q){Q=Q.toString(),C=this instanceof Ms?Q:Q.substr(0,1)==="("?yf(Q.substr(1,Q.length-2)):yf(Q)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ms?yf(C.substr(1,C.length-1)):C},set:function(Q){Q=Q.toString(),C=this instanceof Ms?"/"+Q:Q}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var M,U=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return U},set:function(Q){Q=!!Q,U=Q}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(M)return M},set:function(Q){M=Q}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,1)},set:function(Q){Q?this.Ff=Yi(this.Ff,1):this.Ff=Ji(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,2)},set:function(Q){Q?this.Ff=Yi(this.Ff,2):this.Ff=Ji(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,3)},set:function(Q){Q?this.Ff=Yi(this.Ff,3):this.Ff=Ji(this.Ff,3)}});var N=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(N!==null)return N},set:function(Q){if([0,1,2].indexOf(Q)===-1)throw new Error('Invalid value "'+Q+'" for attribute Q supplied.');N=Q}}),Object.defineProperty(this,"textAlign",{get:function(){var Q;switch(N){case 0:default:Q="left";break;case 1:Q="center";break;case 2:Q="right"}return Q},configurable:!0,enumerable:!0,set:function(Q){switch(Q){case"right":case 2:N=2;break;case"center":case 1:N=1;break;case"left":case 0:default:N=0}}})};ua(qc,Kl);var _f=function(){qc.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){r=e}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return MF(t,this.objId,this.scope)},set:function(e){var n,i;i=[],typeof(n=e)=="string"&&(i=function(s,a,o){o||(o=1);for(var A,f=[];A=a.exec(s);)f.push(A[o]);return f}(n,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,n){for(n=n||!1,e=(e=e||"").toString();t.indexOf(e)!==-1&&(t.splice(t.indexOf(e),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,18)},set:function(e){e?this.Ff=Yi(this.Ff,18):this.Ff=Ji(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,19)},set:function(e){this.combo===!0&&(e?this.Ff=Yi(this.Ff,19):this.Ff=Ji(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,20)},set:function(e){e?(this.Ff=Yi(this.Ff,20),t.sort()):this.Ff=Ji(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,22)},set:function(e){e?this.Ff=Yi(this.Ff,22):this.Ff=Ji(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,23)},set:function(e){e?this.Ff=Yi(this.Ff,23):this.Ff=Ji(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,27)},set:function(e){e?this.Ff=Yi(this.Ff,27):this.Ff=Ji(this.Ff,27)}}),this.hasAppearanceStream=!1};ua(_f,qc);var vf=function(){_f.call(this),this.fontName="helvetica",this.combo=!1};ua(vf,_f);var bf=function(){vf.call(this),this.combo=!0};ua(bf,vf);var dy=function(){bf.call(this),this.edit=!0};ua(dy,bf);var Ms=function(){qc.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,15)},set:function(e){e?this.Ff=Yi(this.Ff,15):this.Ff=Ji(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,16)},set:function(e){e?this.Ff=Yi(this.Ff,16):this.Ff=Ji(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,17)},set:function(e){e?this.Ff=Yi(this.Ff,17):this.Ff=Ji(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,26)},set:function(e){e?this.Ff=Yi(this.Ff,26):this.Ff=Ji(this.Ff,26)}});var r,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(s){return s};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,i=[];for(n in i.push("<<"),t)i.push("/"+n+" ("+Gh(e(t[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(e){On(e)==="object"&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){typeof e=="string"&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(e){r="/"+e}})};ua(Ms,qc);var fy=function(){Ms.call(this),this.pushButton=!0};ua(fy,Ms);var wf=function(){Ms.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t!==void 0?t:[]}})};ua(wf,Ms);var py=function(){var r,t;qc.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var e,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,a=[];for(s in a.push("<<"),n)a.push("/"+s+" ("+Gh(i(n[s]))+")");return a.push(">>"),a.join(`
`)},set:function(i){On(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(i){e="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=yr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ua(py,qc),wf.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var e=this.Kids[t];e.appearanceStreamContent=r.createAppearanceStream(e.optionName),e.caption=r.getCA()}},wf.prototype.createOption=function(r){var t=new py;return t.Parent=this,t.optionName=r,this.Kids.push(t),Eet.call(this.scope,t),t};var gy=function(){Ms.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=yr.CheckBox.createAppearanceStream()};ua(gy,Ms);var Vh=function(){qc.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,13)},set:function(t){t?this.Ff=Yi(this.Ff,13):this.Ff=Ji(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,21)},set:function(t){t?this.Ff=Yi(this.Ff,21):this.Ff=Ji(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,23)},set:function(t){t?this.Ff=Yi(this.Ff,23):this.Ff=Ji(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,24)},set:function(t){t?this.Ff=Yi(this.Ff,24):this.Ff=Ji(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,25)},set:function(t){t?this.Ff=Yi(this.Ff,25):this.Ff=Ji(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,26)},set:function(t){t?this.Ff=Yi(this.Ff,26):this.Ff=Ji(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){Number.isInteger(t)&&(r=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ua(Vh,qc);var my=function(){Vh.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,14)},set:function(r){r?this.Ff=Yi(this.Ff,14):this.Ff=Ji(this.Ff,14)}}),this.password=!0};ua(my,Vh);var yr={CheckBox:{createAppearanceStream:function(){return{N:{On:yr.CheckBox.YesNormal},D:{On:yr.CheckBox.YesPushDown,Off:yr.CheckBox.OffPushDown}}},YesPushDown:function(r){var t=ql(r);t.scope=r.scope;var e=[],n=r.scope.internal.getFont(r.fontName,r.fontStyle).id,i=r.scope.__private__.encodeColorString(r.color),s=_2(r,r.caption);return e.push("0.749023 g"),e.push("0 0 "+Jr(yr.internal.getWidth(r))+" "+Jr(yr.internal.getHeight(r))+" re"),e.push("f"),e.push("BMC"),e.push("q"),e.push("0 0 1 rg"),e.push("/"+n+" "+Jr(s.fontSize)+" Tf "+i),e.push("BT"),e.push(s.text),e.push("ET"),e.push("Q"),e.push("EMC"),t.stream=e.join(`
`),t},YesNormal:function(r){var t=ql(r);t.scope=r.scope;var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),i=[],s=yr.internal.getHeight(r),a=yr.internal.getWidth(r),o=_2(r,r.caption);return i.push("1 g"),i.push("0 0 "+Jr(a)+" "+Jr(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Jr(a-1)+" "+Jr(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+e+" "+Jr(o.fontSize)+" Tf "+n),i.push(o.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(r){var t=ql(r);t.scope=r.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+Jr(yr.internal.getWidth(r))+" "+Jr(yr.internal.getHeight(r))+" re"),e.push("f"),t.stream=e.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(r){var t={D:{Off:yr.RadioButton.Circle.OffPushDown},N:{}};return t.N[r]=yr.RadioButton.Circle.YesNormal,t.D[r]=yr.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(r){var t=ql(r);t.scope=r.scope;var e=[],n=yr.internal.getWidth(r)<=yr.internal.getHeight(r)?yr.internal.getWidth(r)/4:yr.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var i=yr.internal.Bezier_C,s=Number((n*i).toFixed(5));return e.push("q"),e.push("1 0 0 1 "+DA(yr.internal.getWidth(r)/2)+" "+DA(yr.internal.getHeight(r)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),e.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),e.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),e.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(r){var t=ql(r);t.scope=r.scope;var e=[],n=yr.internal.getWidth(r)<=yr.internal.getHeight(r)?yr.internal.getWidth(r)/4:yr.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*yr.internal.Bezier_C).toFixed(5)),a=Number((n*yr.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+DA(yr.internal.getWidth(r)/2)+" "+DA(yr.internal.getHeight(r)/2)+" cm"),e.push(i+" 0 m"),e.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),e.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),e.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),e.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),e.push("f"),e.push("Q"),e.push("0 g"),e.push("q"),e.push("1 0 0 1 "+DA(yr.internal.getWidth(r)/2)+" "+DA(yr.internal.getHeight(r)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),e.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),e.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),e.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},OffPushDown:function(r){var t=ql(r);t.scope=r.scope;var e=[],n=yr.internal.getWidth(r)<=yr.internal.getHeight(r)?yr.internal.getWidth(r)/4:yr.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*yr.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+DA(yr.internal.getWidth(r)/2)+" "+DA(yr.internal.getHeight(r)/2)+" cm"),e.push(i+" 0 m"),e.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),e.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),e.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),e.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t}},Cross:{createAppearanceStream:function(r){var t={D:{Off:yr.RadioButton.Cross.OffPushDown},N:{}};return t.N[r]=yr.RadioButton.Cross.YesNormal,t.D[r]=yr.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(r){var t=ql(r);t.scope=r.scope;var e=[],n=yr.internal.calculateCross(r);return e.push("q"),e.push("1 1 "+Jr(yr.internal.getWidth(r)-2)+" "+Jr(yr.internal.getHeight(r)-2)+" re"),e.push("W"),e.push("n"),e.push(Jr(n.x1.x)+" "+Jr(n.x1.y)+" m"),e.push(Jr(n.x2.x)+" "+Jr(n.x2.y)+" l"),e.push(Jr(n.x4.x)+" "+Jr(n.x4.y)+" m"),e.push(Jr(n.x3.x)+" "+Jr(n.x3.y)+" l"),e.push("s"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(r){var t=ql(r);t.scope=r.scope;var e=yr.internal.calculateCross(r),n=[];return n.push("0.749023 g"),n.push("0 0 "+Jr(yr.internal.getWidth(r))+" "+Jr(yr.internal.getHeight(r))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Jr(yr.internal.getWidth(r)-2)+" "+Jr(yr.internal.getHeight(r)-2)+" re"),n.push("W"),n.push("n"),n.push(Jr(e.x1.x)+" "+Jr(e.x1.y)+" m"),n.push(Jr(e.x2.x)+" "+Jr(e.x2.y)+" l"),n.push(Jr(e.x4.x)+" "+Jr(e.x4.y)+" m"),n.push(Jr(e.x3.x)+" "+Jr(e.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(r){var t=ql(r);t.scope=r.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+Jr(yr.internal.getWidth(r))+" "+Jr(yr.internal.getHeight(r))+" re"),e.push("f"),t.stream=e.join(`
`),t}}},createDefaultAppearanceStream:function(r){var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,e=r.scope.__private__.encodeColorString(r.color);return"/"+t+" "+r.fontSize+" Tf "+e}};yr.internal={Bezier_C:.551915024494,calculateCross:function(r){var t=yr.internal.getWidth(r),e=yr.internal.getHeight(r),n=Math.min(t,e);return{x1:{x:(t-n)/2,y:(e-n)/2+n},x2:{x:(t-n)/2+n,y:(e-n)/2},x3:{x:(t-n)/2,y:(e-n)/2},x4:{x:(t-n)/2+n,y:(e-n)/2+n}}}},yr.internal.getWidth=function(r){var t=0;return On(r)==="object"&&(t=FF(r.Rect[2])),t},yr.internal.getHeight=function(r){var t=0;return On(r)==="object"&&(t=FF(r.Rect[3])),t};var Eet=zi.addField=function(r){if(Cet(this,r),!(r instanceof qc))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=r).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};zi.AcroFormChoiceField=_f,zi.AcroFormListBox=vf,zi.AcroFormComboBox=bf,zi.AcroFormEditBox=dy,zi.AcroFormButton=Ms,zi.AcroFormPushButton=fy,zi.AcroFormRadioButton=wf,zi.AcroFormCheckBox=gy,zi.AcroFormTextField=Vh,zi.AcroFormPasswordField=my,zi.AcroFormAppearance=yr,zi.AcroForm={ChoiceField:_f,ListBox:vf,ComboBox:bf,EditBox:dy,Button:Ms,PushButton:fy,RadioButton:wf,CheckBox:gy,TextField:Vh,PasswordField:my,Appearance:yr},jr.AcroForm={ChoiceField:_f,ListBox:vf,ComboBox:bf,EditBox:dy,Button:Ms,PushButton:fy,RadioButton:wf,CheckBox:gy,TextField:Vh,PasswordField:my,Appearance:yr};function RF(r){return r.reduce(function(t,e,n){return t[e]=n,t},{})}(function(r){r.__addimage__={};var t="UNKNOWN",e={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=r.__addimage__.getImageFileTypeByImageData=function(st,ct){var wt,yt,te,Zt,re,Xt=t;if((ct=ct||t)==="RGBA"||st.data!==void 0&&st.data instanceof Uint8ClampedArray&&"height"in st&&"width"in st)return"RGBA";if(pt(st))for(re in e)for(te=e[re],wt=0;wt<te.length;wt+=1){for(Zt=!0,yt=0;yt<te[wt].length;yt+=1)if(te[wt][yt]!==void 0&&te[wt][yt]!==st[yt]){Zt=!1;break}if(Zt===!0){Xt=re;break}}else for(re in e)for(te=e[re],wt=0;wt<te.length;wt+=1){for(Zt=!0,yt=0;yt<te[wt].length;yt+=1)if(te[wt][yt]!==void 0&&te[wt][yt]!==st.charCodeAt(yt)){Zt=!1;break}if(Zt===!0){Xt=re;break}}return Xt===t&&ct!==t&&(Xt=ct),Xt},i=function st(ct){for(var wt=this.internal.write,yt=this.internal.putStream,te=(0,this.internal.getFilters)();te.indexOf("FlateEncode")!==-1;)te.splice(te.indexOf("FlateEncode"),1);ct.objectId=this.internal.newObject();var Zt=[];if(Zt.push({key:"Type",value:"/XObject"}),Zt.push({key:"Subtype",value:"/Image"}),Zt.push({key:"Width",value:ct.width}),Zt.push({key:"Height",value:ct.height}),ct.colorSpace===N.INDEXED?Zt.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(ct.palette.length/3-1)+" "+("sMask"in ct&&ct.sMask!==void 0?ct.objectId+2:ct.objectId+1)+" 0 R]"}):(Zt.push({key:"ColorSpace",value:"/"+ct.colorSpace}),ct.colorSpace===N.DEVICE_CMYK&&Zt.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Zt.push({key:"BitsPerComponent",value:ct.bitsPerComponent}),"decodeParameters"in ct&&ct.decodeParameters!==void 0&&Zt.push({key:"DecodeParms",value:"<<"+ct.decodeParameters+">>"}),"transparency"in ct&&Array.isArray(ct.transparency)){for(var re="",Xt=0,ne=ct.transparency.length;Xt<ne;Xt++)re+=ct.transparency[Xt]+" "+ct.transparency[Xt]+" ";Zt.push({key:"Mask",value:"["+re+"]"})}ct.sMask!==void 0&&Zt.push({key:"SMask",value:ct.objectId+1+" 0 R"});var se=ct.filter!==void 0?["/"+ct.filter]:void 0;if(yt({data:ct.data,additionalKeyValues:Zt,alreadyAppliedFilters:se,objectId:ct.objectId}),wt("endobj"),"sMask"in ct&&ct.sMask!==void 0){var we="/Predictor "+ct.predictor+" /Colors 1 /BitsPerComponent "+ct.bitsPerComponent+" /Columns "+ct.width,it={width:ct.width,height:ct.height,colorSpace:"DeviceGray",bitsPerComponent:ct.bitsPerComponent,decodeParameters:we,data:ct.sMask};"filter"in ct&&(it.filter=ct.filter),st.call(this,it)}if(ct.colorSpace===N.INDEXED){var vt=this.internal.newObject();yt({data:dt(new Uint8Array(ct.palette)),objectId:vt}),wt("endobj")}},s=function(){var st=this.internal.collections.addImage_images;for(var ct in st)i.call(this,st[ct])},a=function(){var st,ct=this.internal.collections.addImage_images,wt=this.internal.write;for(var yt in ct)wt("/I"+(st=ct[yt]).index,st.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",a))},A=function(){var st=this.internal.collections.addImage_images;return o.call(this),st},f=function(){return Object.keys(this.internal.collections.addImage_images).length},m=function(st){return typeof r["process"+st.toUpperCase()]=="function"},b=function(st){return On(st)==="object"&&st.nodeType===1},x=function(st,ct){if(st.nodeName==="IMG"&&st.hasAttribute("src")){var wt=""+st.getAttribute("src");if(wt.indexOf("data:image/")===0)return Tg(unescape(wt).split("base64,").pop());var yt=r.loadFile(wt,!0);if(yt!==void 0)return yt}if(st.nodeName==="CANVAS"){if(st.width===0||st.height===0)throw new Error("Given canvas must have data. Canvas width: "+st.width+", height: "+st.height);var te;switch(ct){case"PNG":te="image/png";break;case"WEBP":te="image/webp";break;case"JPEG":case"JPG":default:te="image/jpeg"}return Tg(st.toDataURL(te,1).split("base64,").pop())}},C=function(st){var ct=this.internal.collections.addImage_images;if(ct){for(var wt in ct)if(st===ct[wt].alias)return ct[wt]}},M=function(st,ct,wt){return st||ct||(st=-96,ct=-96),st<0&&(st=-1*wt.width*72/st/this.internal.scaleFactor),ct<0&&(ct=-1*wt.height*72/ct/this.internal.scaleFactor),st===0&&(st=ct*wt.width/wt.height),ct===0&&(ct=st*wt.height/wt.width),[st,ct]},U=function(st,ct,wt,yt,te,Zt){var re=M.call(this,wt,yt,te),Xt=this.internal.getCoordinateString,ne=this.internal.getVerticalCoordinateString,se=A.call(this);if(wt=re[0],yt=re[1],se[te.index]=te,Zt){Zt*=Math.PI/180;var we=Math.cos(Zt),it=Math.sin(Zt),vt=function(Ot){return Ot.toFixed(4)},Ft=[vt(we),vt(it),vt(-1*it),vt(we),0,0,"cm"]}this.internal.write("q"),Zt?(this.internal.write([1,"0","0",1,Xt(st),ne(ct+yt),"cm"].join(" ")),this.internal.write(Ft.join(" ")),this.internal.write([Xt(wt),"0","0",Xt(yt),"0","0","cm"].join(" "))):this.internal.write([Xt(wt),"0","0",Xt(yt),Xt(st),ne(ct+yt),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+te.index+" Do"),this.internal.write("Q")},N=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var Q=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},q=r.__addimage__.sHashCode=function(st){var ct,wt,yt=0;if(typeof st=="string")for(wt=st.length,ct=0;ct<wt;ct++)yt=(yt<<5)-yt+st.charCodeAt(ct),yt|=0;else if(pt(st))for(wt=st.byteLength/2,ct=0;ct<wt;ct++)yt=(yt<<5)-yt+st[ct],yt|=0;return yt},Y=r.__addimage__.validateStringAsBase64=function(st){(st=st||"").toString().trim();var ct=!0;return st.length===0&&(ct=!1),st.length%4!=0&&(ct=!1),/^[A-Za-z0-9+/]+$/.test(st.substr(0,st.length-2))===!1&&(ct=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(st.substr(-2))===!1&&(ct=!1),ct},tt=r.__addimage__.extractImageFromDataUrl=function(st){var ct=(st=st||"").split("base64,"),wt=null;if(ct.length===2){var yt=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(ct[0]);Array.isArray(yt)&&(wt={mimeType:yt[1],charset:yt[2],data:ct[1]})}return wt},ft=r.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};r.__addimage__.isArrayBuffer=function(st){return ft()&&st instanceof ArrayBuffer};var pt=r.__addimage__.isArrayBufferView=function(st){return ft()&&typeof Uint32Array<"u"&&(st instanceof Int8Array||st instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&st instanceof Uint8ClampedArray||st instanceof Int16Array||st instanceof Uint16Array||st instanceof Int32Array||st instanceof Uint32Array||st instanceof Float32Array||st instanceof Float64Array)},mt=r.__addimage__.binaryStringToUint8Array=function(st){for(var ct=st.length,wt=new Uint8Array(ct),yt=0;yt<ct;yt++)wt[yt]=st.charCodeAt(yt);return wt},dt=r.__addimage__.arrayBufferToBinaryString=function(st){for(var ct="",wt=pt(st)?st:new Uint8Array(st),yt=0;yt<wt.length;yt+=8192)ct+=String.fromCharCode.apply(null,wt.subarray(yt,yt+8192));return ct};r.addImage=function(){var st,ct,wt,yt,te,Zt,re,Xt,ne;if(typeof arguments[1]=="number"?(ct=t,wt=arguments[1],yt=arguments[2],te=arguments[3],Zt=arguments[4],re=arguments[5],Xt=arguments[6],ne=arguments[7]):(ct=arguments[1],wt=arguments[2],yt=arguments[3],te=arguments[4],Zt=arguments[5],re=arguments[6],Xt=arguments[7],ne=arguments[8]),On(st=arguments[0])==="object"&&!b(st)&&"imageData"in st){var se=st;st=se.imageData,ct=se.format||ct||t,wt=se.x||wt||0,yt=se.y||yt||0,te=se.w||se.width||te,Zt=se.h||se.height||Zt,re=se.alias||re,Xt=se.compression||Xt,ne=se.rotation||se.angle||ne}var we=this.internal.getFilters();if(Xt===void 0&&we.indexOf("FlateEncode")!==-1&&(Xt="SLOW"),isNaN(wt)||isNaN(yt))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var it=Rt.call(this,st,ct,re,Xt);return U.call(this,wt,yt,te,Zt,it,ne),this};var Rt=function(st,ct,wt,yt){var te,Zt,re;if(typeof st=="string"&&n(st)===t){st=unescape(st);var Xt=Lt(st,!1);(Xt!==""||(Xt=r.loadFile(st,!0))!==void 0)&&(st=Xt)}if(b(st)&&(st=x(st,ct)),ct=n(st,ct),!m(ct))throw new Error("addImage does not support files of type '"+ct+"', please ensure that a plugin for '"+ct+"' support is added.");if(((re=wt)==null||re.length===0)&&(wt=function(ne){return typeof ne=="string"||pt(ne)?q(ne):pt(ne.data)?q(ne.data):null}(st)),(te=C.call(this,wt))||(ft()&&(st instanceof Uint8Array||ct==="RGBA"||(Zt=st,st=mt(st))),te=this["process"+ct.toUpperCase()](st,f.call(this),wt,function(ne){return ne&&typeof ne=="string"&&(ne=ne.toUpperCase()),ne in r.image_compression?ne:Q.NONE}(yt),Zt)),!te)throw new Error("An unknown error occurred whilst processing the image.");return te},Lt=r.__addimage__.convertBase64ToBinaryString=function(st,ct){var wt;ct=typeof ct!="boolean"||ct;var yt,te="";if(typeof st=="string"){yt=(wt=tt(st))!==null?wt.data:st;try{te=Tg(yt)}catch(Zt){if(ct)throw Y(yt)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Zt.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return te};r.getImageProperties=function(st){var ct,wt,yt="";if(b(st)&&(st=x(st)),typeof st=="string"&&n(st)===t&&((yt=Lt(st,!1))===""&&(yt=r.loadFile(st)||""),st=yt),wt=n(st),!m(wt))throw new Error("addImage does not support files of type '"+wt+"', please ensure that a plugin for '"+wt+"' support is added.");if(!ft()||st instanceof Uint8Array||(st=mt(st)),!(ct=this["process"+wt.toUpperCase()](st)))throw new Error("An unknown error occurred whilst processing the image");return ct.fileType=wt,ct}})(jr.API),function(r){var t=function(e){if(e!==void 0&&e!="")return!0};jr.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(e){for(var n,i,s,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,A=this.internal.getPageInfoByObjId(e.objId),f=e.pageContext.annotations,m=!1,b=0;b<f.length&&!m;b++)switch((n=f[b]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(m=!0);break;case"reference":case"text":case"freetext":m=!0}if(m!=0){this.internal.write("/Annots [");for(var x=0;x<f.length;x++){n=f[x];var C=this.internal.pdfEscape,M=this.internal.getEncryptor(e.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var U=this.internal.newAdditionalObject(),N=this.internal.newAdditionalObject(),Q=this.internal.getEncryptor(U.objId),q=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+C(Q(n.contents))+")",s+=" /Popup "+N.objId+" 0 R",s+=" /P "+A.objId+" 0 R",s+=" /T ("+C(Q(q))+") >>",U.content=s;var Y=U.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+a(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+Y,n.open&&(s+=" /Open true"),s+=" >>",N.content=s,this.internal.write(U.objId,"0 R",N.objId,"0 R");break;case"freetext":i="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var tt=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+C(M(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+tt+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var ft=this.annotations._nameMap[n.options.name];n.options.pageNumber=ft.page,n.options.top=ft.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+C(M(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var pt=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+pt+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),r.createAnnotation=function(e){var n=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":n.pageContext.annotations.push(e)}},r.link=function(e,n,i,s,a){var o=this.internal.getCurrentPageInfo(),A=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:A(e),y:f(n),w:A(e+i),h:f(n+s)},options:a,type:"link"})},r.textWithLink=function(e,n,i,s){var a,o,A=this.getTextWidth(e),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){o=s.maxWidth;var m=this.splitTextToSize(e,o).length;a=Math.ceil(f*m)}else o=A,a=f;return this.text(e,n,i,s),i+=.2*f,s.align==="center"&&(n-=A/2),s.align==="right"&&(n-=A),this.link(n,i-f,o,a,s),A},r.getTextWidth=function(e){var n=this.internal.getFontSize();return this.getStringUnitWidth(e)*n/this.internal.scaleFactor}}(jr.API),function(r){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},e={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];r.__arabicParser__={};var s=r.__arabicParser__.isInArabicSubstitutionA=function(U){return t[U.charCodeAt(0)]!==void 0},a=r.__arabicParser__.isArabicLetter=function(U){return typeof U=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(U)},o=r.__arabicParser__.isArabicEndLetter=function(U){return a(U)&&s(U)&&t[U.charCodeAt(0)].length<=2},A=r.__arabicParser__.isArabicAlfLetter=function(U){return a(U)&&i.indexOf(U.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(U){return a(U)&&s(U)&&t[U.charCodeAt(0)].length>=1};var f=r.__arabicParser__.arabicLetterHasFinalForm=function(U){return a(U)&&s(U)&&t[U.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(U){return a(U)&&s(U)&&t[U.charCodeAt(0)].length>=3};var m=r.__arabicParser__.arabicLetterHasMedialForm=function(U){return a(U)&&s(U)&&t[U.charCodeAt(0)].length==4},b=r.__arabicParser__.resolveLigatures=function(U){var N=0,Q=e,q="",Y=0;for(N=0;N<U.length;N+=1)Q[U.charCodeAt(N)]!==void 0?(Y++,typeof(Q=Q[U.charCodeAt(N)])=="number"&&(q+=String.fromCharCode(Q),Q=e,Y=0),N===U.length-1&&(Q=e,q+=U.charAt(N-(Y-1)),N-=Y-1,Y=0)):(Q=e,q+=U.charAt(N-Y),N-=Y,Y=0);return q};r.__arabicParser__.isArabicDiacritic=function(U){return U!==void 0&&n[U.charCodeAt(0)]!==void 0};var x=r.__arabicParser__.getCorrectForm=function(U,N,Q){return a(U)?s(U)===!1?-1:!f(U)||!a(N)&&!a(Q)||!a(Q)&&o(N)||o(U)&&!a(N)||o(U)&&A(N)||o(U)&&o(N)?0:m(U)&&a(N)&&!o(N)&&a(Q)&&f(Q)?3:o(U)||!a(Q)?1:2:-1},C=function(U){var N=0,Q=0,q=0,Y="",tt="",ft="",pt=(U=U||"").split("\\s+"),mt=[];for(N=0;N<pt.length;N+=1){for(mt.push(""),Q=0;Q<pt[N].length;Q+=1)Y=pt[N][Q],tt=pt[N][Q-1],ft=pt[N][Q+1],a(Y)?(q=x(Y,tt,ft),mt[N]+=q!==-1?String.fromCharCode(t[Y.charCodeAt(0)][q]):Y):mt[N]+=Y;mt[N]=b(mt[N])}return mt.join(" ")},M=r.__arabicParser__.processArabic=r.processArabic=function(){var U,N=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,Q=[];if(Array.isArray(N)){var q=0;for(Q=[],q=0;q<N.length;q+=1)Array.isArray(N[q])?Q.push([C(N[q][0]),N[q][1],N[q][2]]):Q.push([C(N[q])]);U=Q}else U=C(N);return typeof arguments[0]=="string"?U:(arguments[0].text=U,arguments[0])};r.events.push(["preProcessText",M])}(jr.API),jr.API.autoPrint=function(r){var t;switch((r=r||{}).variant=r.variant||"non-conform",r.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(r){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(o){e=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(o){s=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,n){var i;if((e=e||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(jr.API),function(r){var t={left:0,top:0,bottom:0,right:0},e=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var A=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return A},set:function(U){A=U}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function(U){f=U}});var m=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return m},set:function(U){m=U}});var b=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return b},set:function(U){b=U}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(U){x=U}});var C=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return C},set:function(U){C=U}});var M=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return M},set:function(U){M=U}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(A){return n.call(this),this.internal.__cell__.headerFunction=typeof A=="function"?A:void 0,this},r.getTextDimensions=function(A,f){n.call(this);var m=(f=f||{}).fontSize||this.getFontSize(),b=f.font||this.getFont(),x=f.scaleFactor||this.internal.scaleFactor,C=0,M=0,U=0,N=this;if(!Array.isArray(A)&&typeof A!="string"){if(typeof A!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");A=String(A)}var Q=f.maxWidth;Q>0?typeof A=="string"?A=this.splitTextToSize(A,Q):Object.prototype.toString.call(A)==="[object Array]"&&(A=A.reduce(function(Y,tt){return Y.concat(N.splitTextToSize(tt,Q))},[])):A=Array.isArray(A)?A:[A];for(var q=0;q<A.length;q++)C<(U=this.getStringUnitWidth(A[q],{font:b})*m)&&(C=U);return C!==0&&(M=A.length),{w:C/=x,h:Math.max((M*m*this.getLineHeightFactor()-m*(this.getLineHeightFactor()-1))/x,0)}},r.cellAddPage=function(){n.call(this),this.addPage();var A=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(A.left,A.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=r.cell=function(){var A;A=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var f=this.internal.__cell__.lastCell,m=this.internal.__cell__.padding,b=this.internal.__cell__.margins||t,x=this.internal.__cell__.tableHeaderRow,C=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===A.lineNumber?(A.x=(f.x||0)+(f.width||0),A.y=f.y||0):f.y+f.height+A.height+b.bottom>this.getPageHeight()?(this.cellAddPage(),A.y=b.top,C&&x&&(this.printHeaderRow(A.lineNumber,!0),A.y+=x[0].height)):A.y=f.y+f.height||A.y),A.text[0]!==void 0&&(this.rect(A.x,A.y,A.width,A.height,e===!0?"FD":void 0),A.align==="right"?this.text(A.text,A.x+A.width-m,A.y+m,{align:"right",baseline:"top"}):A.align==="center"?this.text(A.text,A.x+A.width/2,A.y+m,{align:"center",baseline:"top",maxWidth:A.width-m-m}):this.text(A.text,A.x+m,A.y+m,{align:"left",baseline:"top",maxWidth:A.width-m-m})),this.internal.__cell__.lastCell=A,this};r.table=function(A,f,m,b,x){if(n.call(this),!m)throw new Error("No data for PDF table.");var C,M,U,N,Q=[],q=[],Y=[],tt={},ft={},pt=[],mt=[],dt=(x=x||{}).autoSize||!1,Rt=x.printHeaders!==!1,Lt=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,st=x.margins||Object.assign({width:this.getPageWidth()},t),ct=typeof x.padding=="number"?x.padding:3,wt=x.headerBackgroundColor||"#c8c8c8",yt=x.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=Rt,this.internal.__cell__.margins=st,this.internal.__cell__.table_font_size=Lt,this.internal.__cell__.padding=ct,this.internal.__cell__.headerBackgroundColor=wt,this.internal.__cell__.headerTextColor=yt,this.setFontSize(Lt),b==null)q=Q=Object.keys(m[0]),Y=Q.map(function(){return"left"});else if(Array.isArray(b)&&On(b[0])==="object")for(Q=b.map(function(se){return se.name}),q=b.map(function(se){return se.prompt||se.name||""}),Y=b.map(function(se){return se.align||"left"}),C=0;C<b.length;C+=1)ft[b[C].name]=b[C].width*(19.049976/25.4);else Array.isArray(b)&&typeof b[0]=="string"&&(q=Q=b,Y=Q.map(function(){return"left"}));if(dt||Array.isArray(b)&&typeof b[0]=="string")for(C=0;C<Q.length;C+=1){for(tt[N=Q[C]]=m.map(function(se){return se[N]}),this.setFont(void 0,"bold"),pt.push(this.getTextDimensions(q[C],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),M=tt[N],this.setFont(void 0,"normal"),U=0;U<M.length;U+=1)pt.push(this.getTextDimensions(M[U],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);ft[N]=Math.max.apply(null,pt)+ct+ct,pt=[]}if(Rt){var te={};for(C=0;C<Q.length;C+=1)te[Q[C]]={},te[Q[C]].text=q[C],te[Q[C]].align=Y[C];var Zt=o.call(this,te,ft);mt=Q.map(function(se){return new s(A,f,ft[se],Zt,te[se].text,void 0,te[se].align)}),this.setTableHeaderRow(mt),this.printHeaderRow(1,!1)}var re=b.reduce(function(se,we){return se[we.name]=we.align,se},{});for(C=0;C<m.length;C+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:C,data:m[C]},this);var Xt=o.call(this,m[C],ft);for(U=0;U<Q.length;U+=1){var ne=m[C][Q[U]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:C,col:U,data:ne},this),a.call(this,new s(A,f,ft[Q[U]],Xt,ne,C+2,re[Q[U]]))}}return this.internal.__cell__.table_x=A,this.internal.__cell__.table_y=f,this};var o=function(A,f){var m=this.internal.__cell__.padding,b=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(A).map(function(C){var M=A[C];return this.splitTextToSize(M.hasOwnProperty("text")?M.text:M,f[C]-m-m)},this).map(function(C){return this.getLineHeightFactor()*C.length*b/x+m+m},this).reduce(function(C,M){return Math.max(C,M)},0)};r.setTableHeaderRow=function(A){n.call(this),this.internal.__cell__.tableHeaderRow=A},r.printHeaderRow=function(A,f){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var m;if(e=!0,typeof this.internal.__cell__.headerFunction=="function"){var b=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(b[0],b[1],b[2],b[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],C=0;C<this.internal.__cell__.tableHeaderRow.length;C+=1){m=this.internal.__cell__.tableHeaderRow[C].clone(),f&&(m.y=this.internal.__cell__.margins.top||0,x.push(m)),m.lineNumber=A;var M=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,m),this.setTextColor(M)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),e=!1}}(jr.API);var OF={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},DF=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],b2=RF(DF),kF=[100,200,300,400,500,600,700,800,900],Tet=RF(kF);function w2(r){var t=r.family.replace(/"|'/g,"").toLowerCase(),e=function(s){return OF[s=s||"normal"]?s:"normal"}(r.style),n=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(r.weight),i=function(s){return typeof b2[s=s||"normal"]=="number"?s:"normal"}(r.stretch);return{family:t,style:e,weight:n,stretch:i,src:r.src||[],ref:r.ref||{name:t,style:[i,e,n].join(" ")}}}function NF(r,t,e,n){var i;for(i=e;i>=0&&i<t.length;i+=n)if(r[t[i]])return r[t[i]];for(i=e;i>=0&&i<t.length;i-=n)if(r[t[i]])return r[t[i]]}var Iet={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},QF={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function HF(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function Let(r,t,e){for(var n=(e=e||{}).defaultFontFamily||"times",i=Object.assign({},Iet,e.genericFontFamilies||{}),s=null,a=null,o=0;o<t.length;++o)if(i[(s=w2(t[o])).family]&&(s.family=i[s.family]),r.hasOwnProperty(s.family)){a=r[s.family];break}if(!(a=a||r[n]))throw new Error("Could not find a font-family for the rule '"+HF(s)+"' and default family '"+n+"'.");if(a=function(A,f){if(f[A])return f[A];var m=b2[A],b=m<=b2.normal?-1:1,x=NF(f,DF,m,b);if(!x)throw new Error("Could not find a matching font-stretch value for "+A);return x}(s.stretch,a),a=function(A,f){if(f[A])return f[A];for(var m=OF[A],b=0;b<m.length;++b)if(f[m[b]])return f[m[b]];throw new Error("Could not find a matching font-style for "+A)}(s.style,a),!(a=function(A,f){if(f[A])return f[A];if(A===400&&f[500])return f[500];if(A===500&&f[400])return f[400];var m=Tet[A],b=NF(f,kF,m,A<400?-1:1);if(!b)throw new Error("Could not find a matching font-weight for value "+A);return b}(s.weight,a)))throw new Error("Failed to resolve a font for the rule '"+HF(s)+"'.");return a}function zF(r){return r.trimLeft()}function Fet(r,t){for(var e=0;e<r.length;){if(r.charAt(e)===t)return[r.substring(0,e),r.substring(e+1)];e+=1}return null}function Met(r){var t=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],r.substring(t[0].length)]}var yy,GF,VF,jF=["times"];(function(r){var t,e,n,i,s,a,o,A,f,m=function(it){return it=it||{},this.isStrokeTransparent=it.isStrokeTransparent||!1,this.strokeOpacity=it.strokeOpacity||1,this.strokeStyle=it.strokeStyle||"#000000",this.fillStyle=it.fillStyle||"#000000",this.isFillTransparent=it.isFillTransparent||!1,this.fillOpacity=it.fillOpacity||1,this.font=it.font||"10px sans-serif",this.textBaseline=it.textBaseline||"alphabetic",this.textAlign=it.textAlign||"left",this.lineWidth=it.lineWidth||1,this.lineJoin=it.lineJoin||"miter",this.lineCap=it.lineCap||"butt",this.path=it.path||[],this.transform=it.transform!==void 0?it.transform.clone():new A,this.globalCompositeOperation=it.globalCompositeOperation||"normal",this.globalAlpha=it.globalAlpha||1,this.clip_path=it.clip_path||[],this.currentPoint=it.currentPoint||new a,this.miterLimit=it.miterLimit||10,this.lastPoint=it.lastPoint||new a,this.lineDashOffset=it.lineDashOffset||0,this.lineDash=it.lineDash||[],this.margin=it.margin||[0,0,0,0],this.prevPageLastElemOffset=it.prevPageLastElemOffset||0,this.ignoreClearRect=typeof it.ignoreClearRect!="boolean"||it.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new b(this),t=this.internal.f2,e=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,A=this.internal.Matrix,f=new m}]);var b=function(it){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var vt=it;Object.defineProperty(this,"pdf",{get:function(){return vt}});var Ft=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Ft},set:function(ge){Ft=!!ge}});var Ot=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Ot},set:function(ge){Ot=!!ge}});var Wt=0;Object.defineProperty(this,"posX",{get:function(){return Wt},set:function(ge){isNaN(ge)||(Wt=ge)}});var jt=0;Object.defineProperty(this,"posY",{get:function(){return jt},set:function(ge){isNaN(ge)||(jt=ge)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(ge){var Ut;typeof ge=="number"?Ut=[ge,ge,ge,ge]:((Ut=new Array(4))[0]=ge[0],Ut[1]=ge.length>=2?ge[1]:Ut[0],Ut[2]=ge.length>=3?ge[2]:Ut[0],Ut[3]=ge.length>=4?ge[3]:Ut[1]),f.margin=Ut}});var ae=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ae},set:function(ge){ae=ge}});var ie=0;Object.defineProperty(this,"lastBreak",{get:function(){return ie},set:function(ge){ie=ge}});var Be=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Be},set:function(ge){Be=ge}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(ge){ge instanceof m&&(f=ge)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(ge){f.path=ge}});var Te=[];Object.defineProperty(this,"ctxStack",{get:function(){return Te},set:function(ge){Te=ge}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ge){var Ut;Ut=x(ge),this.ctx.fillStyle=Ut.style,this.ctx.isFillTransparent=Ut.a===0,this.ctx.fillOpacity=Ut.a,this.pdf.setFillColor(Ut.r,Ut.g,Ut.b,{a:Ut.a}),this.pdf.setTextColor(Ut.r,Ut.g,Ut.b,{a:Ut.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ge){var Ut=x(ge);this.ctx.strokeStyle=Ut.style,this.ctx.isStrokeTransparent=Ut.a===0,this.ctx.strokeOpacity=Ut.a,Ut.a===0?this.pdf.setDrawColor(255,255,255):(Ut.a,this.pdf.setDrawColor(Ut.r,Ut.g,Ut.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ge){["butt","round","square"].indexOf(ge)!==-1&&(this.ctx.lineCap=ge,this.pdf.setLineCap(ge))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ge){isNaN(ge)||(this.ctx.lineWidth=ge,this.pdf.setLineWidth(ge))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ge){["bevel","round","miter"].indexOf(ge)!==-1&&(this.ctx.lineJoin=ge,this.pdf.setLineJoin(ge))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ge){isNaN(ge)||(this.ctx.miterLimit=ge,this.pdf.setMiterLimit(ge))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ge){this.ctx.textBaseline=ge}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ge){["right","end","center","left","start"].indexOf(ge)!==-1&&(this.ctx.textAlign=ge)}});var Ne=null;function Qe(ge,Ut){if(Ne===null){var Yt=function(tr){var Ee=[];return Object.keys(tr).forEach(function(_e){tr[_e].forEach(function(xe){var De=null;switch(xe){case"bold":De={family:_e,weight:"bold"};break;case"italic":De={family:_e,style:"italic"};break;case"bolditalic":De={family:_e,weight:"bold",style:"italic"};break;case"":case"normal":De={family:_e}}De!==null&&(De.ref={name:_e,style:xe},Ee.push(De))})}),Ee}(ge.getFontList());Ne=function(tr){for(var Ee={},_e=0;_e<tr.length;++_e){var xe=w2(tr[_e]),De=xe.family,nr=xe.stretch,ur=xe.style,Ir=xe.weight;Ee[De]=Ee[De]||{},Ee[De][nr]=Ee[De][nr]||{},Ee[De][nr][ur]=Ee[De][nr][ur]||{},Ee[De][nr][ur][Ir]=xe}return Ee}(Yt.concat(Ut))}return Ne}var He=null;Object.defineProperty(this,"fontFaces",{get:function(){return He},set:function(ge){Ne=null,He=ge}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ge){var Ut;if(this.ctx.font=ge,(Ut=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ge))!==null){var Yt=Ut[1],tr=(Ut[2],Ut[3]),Ee=Ut[4],_e=(Ut[5],Ut[6]),xe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ee)[2];Ee=Math.floor(xe==="px"?parseFloat(Ee)*this.pdf.internal.scaleFactor:xe==="em"?parseFloat(Ee)*this.pdf.getFontSize():parseFloat(Ee)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ee);var De=function(fe){var Tr,Oe,wn=[],Fr=fe.trim();if(Fr==="")return jF;if(Fr in QF)return[QF[Fr]];for(;Fr!=="";){switch(Oe=null,Tr=(Fr=zF(Fr)).charAt(0)){case'"':case"'":Oe=Fet(Fr.substring(1),Tr);break;default:Oe=Met(Fr)}if(Oe===null||(wn.push(Oe[0]),(Fr=zF(Oe[1]))!==""&&Fr.charAt(0)!==","))return jF;Fr=Fr.replace(/^,/,"")}return wn}(_e);if(this.fontFaces){var nr=Let(Qe(this.pdf,this.fontFaces),De.map(function(fe){return{family:fe,stretch:"normal",weight:tr,style:Yt}}));this.pdf.setFont(nr.ref.name,nr.ref.style)}else{var ur="";(tr==="bold"||parseInt(tr,10)>=700||Yt==="bold")&&(ur="bold"),Yt==="italic"&&(ur+="italic"),ur.length===0&&(ur="normal");for(var Ir="",Sr={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Dr=0;Dr<De.length;Dr++){if(this.pdf.internal.getFont(De[Dr],ur,{noFallback:!0,disableWarning:!0})!==void 0){Ir=De[Dr];break}if(ur==="bolditalic"&&this.pdf.internal.getFont(De[Dr],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ir=De[Dr],ur="bold";else if(this.pdf.internal.getFont(De[Dr],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ir=De[Dr],ur="normal";break}}if(Ir===""){for(var Nr=0;Nr<De.length;Nr++)if(Sr[De[Nr]]){Ir=Sr[De[Nr]];break}}Ir=Ir===""?"Times":Ir,this.pdf.setFont(Ir,ur)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ge){this.ctx.globalCompositeOperation=ge}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ge){this.ctx.globalAlpha=ge}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ge){this.ctx.lineDashOffset=ge,we.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ge){this.ctx.lineDash=ge,we.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ge){this.ctx.ignoreClearRect=!!ge}})};b.prototype.setLineDash=function(it){this.lineDash=it},b.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},b.prototype.fill=function(){tt.call(this,"fill",!1)},b.prototype.stroke=function(){tt.call(this,"stroke",!1)},b.prototype.beginPath=function(){this.path=[{type:"begin"}]},b.prototype.moveTo=function(it,vt){if(isNaN(it)||isNaN(vt))throw ci.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Ft=this.ctx.transform.applyToPoint(new a(it,vt));this.path.push({type:"mt",x:Ft.x,y:Ft.y}),this.ctx.lastPoint=new a(it,vt)},b.prototype.closePath=function(){var it=new a(0,0),vt=0;for(vt=this.path.length-1;vt!==-1;vt--)if(this.path[vt].type==="begin"&&On(this.path[vt+1])==="object"&&typeof this.path[vt+1].x=="number"){it=new a(this.path[vt+1].x,this.path[vt+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(it.x,it.y)},b.prototype.lineTo=function(it,vt){if(isNaN(it)||isNaN(vt))throw ci.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Ft=this.ctx.transform.applyToPoint(new a(it,vt));this.path.push({type:"lt",x:Ft.x,y:Ft.y}),this.ctx.lastPoint=new a(Ft.x,Ft.y)},b.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),tt.call(this,null,!0)},b.prototype.quadraticCurveTo=function(it,vt,Ft,Ot){if(isNaN(Ft)||isNaN(Ot)||isNaN(it)||isNaN(vt))throw ci.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Wt=this.ctx.transform.applyToPoint(new a(Ft,Ot)),jt=this.ctx.transform.applyToPoint(new a(it,vt));this.path.push({type:"qct",x1:jt.x,y1:jt.y,x:Wt.x,y:Wt.y}),this.ctx.lastPoint=new a(Wt.x,Wt.y)},b.prototype.bezierCurveTo=function(it,vt,Ft,Ot,Wt,jt){if(isNaN(Wt)||isNaN(jt)||isNaN(it)||isNaN(vt)||isNaN(Ft)||isNaN(Ot))throw ci.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ae=this.ctx.transform.applyToPoint(new a(Wt,jt)),ie=this.ctx.transform.applyToPoint(new a(it,vt)),Be=this.ctx.transform.applyToPoint(new a(Ft,Ot));this.path.push({type:"bct",x1:ie.x,y1:ie.y,x2:Be.x,y2:Be.y,x:ae.x,y:ae.y}),this.ctx.lastPoint=new a(ae.x,ae.y)},b.prototype.arc=function(it,vt,Ft,Ot,Wt,jt){if(isNaN(it)||isNaN(vt)||isNaN(Ft)||isNaN(Ot)||isNaN(Wt))throw ci.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(jt=!!jt,!this.ctx.transform.isIdentity){var ae=this.ctx.transform.applyToPoint(new a(it,vt));it=ae.x,vt=ae.y;var ie=this.ctx.transform.applyToPoint(new a(0,Ft)),Be=this.ctx.transform.applyToPoint(new a(0,0));Ft=Math.sqrt(Math.pow(ie.x-Be.x,2)+Math.pow(ie.y-Be.y,2))}Math.abs(Wt-Ot)>=2*Math.PI&&(Ot=0,Wt=2*Math.PI),this.path.push({type:"arc",x:it,y:vt,radius:Ft,startAngle:Ot,endAngle:Wt,counterclockwise:jt})},b.prototype.arcTo=function(it,vt,Ft,Ot,Wt){throw new Error("arcTo not implemented.")},b.prototype.rect=function(it,vt,Ft,Ot){if(isNaN(it)||isNaN(vt)||isNaN(Ft)||isNaN(Ot))throw ci.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(it,vt),this.lineTo(it+Ft,vt),this.lineTo(it+Ft,vt+Ot),this.lineTo(it,vt+Ot),this.lineTo(it,vt),this.lineTo(it+Ft,vt),this.lineTo(it,vt)},b.prototype.fillRect=function(it,vt,Ft,Ot){if(isNaN(it)||isNaN(vt)||isNaN(Ft)||isNaN(Ot))throw ci.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!C.call(this)){var Wt={};this.lineCap!=="butt"&&(Wt.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Wt.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(it,vt,Ft,Ot),this.fill(),Wt.hasOwnProperty("lineCap")&&(this.lineCap=Wt.lineCap),Wt.hasOwnProperty("lineJoin")&&(this.lineJoin=Wt.lineJoin)}},b.prototype.strokeRect=function(it,vt,Ft,Ot){if(isNaN(it)||isNaN(vt)||isNaN(Ft)||isNaN(Ot))throw ci.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");M.call(this)||(this.beginPath(),this.rect(it,vt,Ft,Ot),this.stroke())},b.prototype.clearRect=function(it,vt,Ft,Ot){if(isNaN(it)||isNaN(vt)||isNaN(Ft)||isNaN(Ot))throw ci.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(it,vt,Ft,Ot))},b.prototype.save=function(it){it=typeof it!="boolean"||it;for(var vt=this.pdf.internal.getCurrentPageInfo().pageNumber,Ft=0;Ft<this.pdf.internal.getNumberOfPages();Ft++)this.pdf.setPage(Ft+1),this.pdf.internal.out("q");if(this.pdf.setPage(vt),it){this.ctx.fontSize=this.pdf.internal.getFontSize();var Ot=new m(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Ot}},b.prototype.restore=function(it){it=typeof it!="boolean"||it;for(var vt=this.pdf.internal.getCurrentPageInfo().pageNumber,Ft=0;Ft<this.pdf.internal.getNumberOfPages();Ft++)this.pdf.setPage(Ft+1),this.pdf.internal.out("Q");this.pdf.setPage(vt),it&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},b.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(it){var vt,Ft,Ot,Wt;if(it.isCanvasGradient===!0&&(it=it.getColor()),!it)return{r:0,g:0,b:0,a:0,style:it};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(it))vt=0,Ft=0,Ot=0,Wt=0;else{var jt=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(it);if(jt!==null)vt=parseInt(jt[1]),Ft=parseInt(jt[2]),Ot=parseInt(jt[3]),Wt=1;else if((jt=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(it))!==null)vt=parseInt(jt[1]),Ft=parseInt(jt[2]),Ot=parseInt(jt[3]),Wt=parseFloat(jt[4]);else{if(Wt=1,typeof it=="string"&&it.charAt(0)!=="#"){var ae=new CF(it);it=ae.ok?ae.toHex():"#000000"}it.length===4?(vt=it.substring(1,2),vt+=vt,Ft=it.substring(2,3),Ft+=Ft,Ot=it.substring(3,4),Ot+=Ot):(vt=it.substring(1,3),Ft=it.substring(3,5),Ot=it.substring(5,7)),vt=parseInt(vt,16),Ft=parseInt(Ft,16),Ot=parseInt(Ot,16)}}return{r:vt,g:Ft,b:Ot,a:Wt,style:it}},C=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},M=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};b.prototype.fillText=function(it,vt,Ft,Ot){if(isNaN(vt)||isNaN(Ft)||typeof it!="string")throw ci.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Ot=isNaN(Ot)?void 0:Ot,!C.call(this)){var Wt=Xt(this.ctx.transform.rotation),jt=this.ctx.transform.scaleX;ct.call(this,{text:it,x:vt,y:Ft,scale:jt,angle:Wt,align:this.textAlign,maxWidth:Ot})}},b.prototype.strokeText=function(it,vt,Ft,Ot){if(isNaN(vt)||isNaN(Ft)||typeof it!="string")throw ci.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!M.call(this)){Ot=isNaN(Ot)?void 0:Ot;var Wt=Xt(this.ctx.transform.rotation),jt=this.ctx.transform.scaleX;ct.call(this,{text:it,x:vt,y:Ft,scale:jt,renderingMode:"stroke",angle:Wt,align:this.textAlign,maxWidth:Ot})}},b.prototype.measureText=function(it){if(typeof it!="string")throw ci.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var vt=this.pdf,Ft=this.pdf.internal.scaleFactor,Ot=vt.internal.getFontSize(),Wt=vt.getStringUnitWidth(it)*Ot/vt.internal.scaleFactor,jt=function(ae){var ie=(ae=ae||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ie}}),this};return new jt({width:Wt*=Math.round(96*Ft/72*1e4)/1e4})},b.prototype.scale=function(it,vt){if(isNaN(it)||isNaN(vt))throw ci.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Ft=new A(it,0,0,vt,0,0);this.ctx.transform=this.ctx.transform.multiply(Ft)},b.prototype.rotate=function(it){if(isNaN(it))throw ci.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var vt=new A(Math.cos(it),Math.sin(it),-Math.sin(it),Math.cos(it),0,0);this.ctx.transform=this.ctx.transform.multiply(vt)},b.prototype.translate=function(it,vt){if(isNaN(it)||isNaN(vt))throw ci.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Ft=new A(1,0,0,1,it,vt);this.ctx.transform=this.ctx.transform.multiply(Ft)},b.prototype.transform=function(it,vt,Ft,Ot,Wt,jt){if(isNaN(it)||isNaN(vt)||isNaN(Ft)||isNaN(Ot)||isNaN(Wt)||isNaN(jt))throw ci.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ae=new A(it,vt,Ft,Ot,Wt,jt);this.ctx.transform=this.ctx.transform.multiply(ae)},b.prototype.setTransform=function(it,vt,Ft,Ot,Wt,jt){it=isNaN(it)?1:it,vt=isNaN(vt)?0:vt,Ft=isNaN(Ft)?0:Ft,Ot=isNaN(Ot)?1:Ot,Wt=isNaN(Wt)?0:Wt,jt=isNaN(jt)?0:jt,this.ctx.transform=new A(it,vt,Ft,Ot,Wt,jt)};var U=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};b.prototype.drawImage=function(it,vt,Ft,Ot,Wt,jt,ae,ie,Be){var Te=this.pdf.getImageProperties(it),Ne=1,Qe=1,He=1,ge=1;Ot!==void 0&&ie!==void 0&&(He=ie/Ot,ge=Be/Wt,Ne=Te.width/Ot*ie/Ot,Qe=Te.height/Wt*Be/Wt),jt===void 0&&(jt=vt,ae=Ft,vt=0,Ft=0),Ot!==void 0&&ie===void 0&&(ie=Ot,Be=Wt),Ot===void 0&&ie===void 0&&(ie=Te.width,Be=Te.height);for(var Ut,Yt=this.ctx.transform.decompose(),tr=Xt(Yt.rotate.shx),Ee=new A,_e=(Ee=(Ee=(Ee=Ee.multiply(Yt.translate)).multiply(Yt.skew)).multiply(Yt.scale)).applyToRectangle(new o(jt-vt*He,ae-Ft*ge,Ot*Ne,Wt*Qe)),xe=N.call(this,_e),De=[],nr=0;nr<xe.length;nr+=1)De.indexOf(xe[nr])===-1&&De.push(xe[nr]);if(Y(De),this.autoPaging)for(var ur=De[0],Ir=De[De.length-1],Sr=ur;Sr<Ir+1;Sr++){this.pdf.setPage(Sr);var Dr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Nr=Sr===1?this.posY+this.margin[0]:this.margin[0],fe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Tr=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Oe=Sr===1?0:fe+(Sr-2)*Tr;if(this.ctx.clip_path.length!==0){var wn=this.path;Ut=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=q(Ut,this.posX+this.margin[3],-Oe+Nr+this.ctx.prevPageLastElemOffset),ft.call(this,"fill",!0),this.path=wn}var Fr=JSON.parse(JSON.stringify(_e));Fr=q([Fr],this.posX+this.margin[3],-Oe+Nr+this.ctx.prevPageLastElemOffset)[0];var Se=(Sr>ur||Sr<Ir)&&U.call(this);Se&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Dr,Tr,null).clip().discardPath()),this.pdf.addImage(it,"JPEG",Fr.x,Fr.y,Fr.w,Fr.h,null,null,tr),Se&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(it,"JPEG",_e.x,_e.y,_e.w,_e.h,null,null,tr)};var N=function(it,vt,Ft){var Ot=[];vt=vt||this.pdf.internal.pageSize.width,Ft=Ft||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Wt=this.posY+this.ctx.prevPageLastElemOffset;switch(it.type){default:case"mt":case"lt":Ot.push(Math.floor((it.y+Wt)/Ft)+1);break;case"arc":Ot.push(Math.floor((it.y+Wt-it.radius)/Ft)+1),Ot.push(Math.floor((it.y+Wt+it.radius)/Ft)+1);break;case"qct":var jt=ne(this.ctx.lastPoint.x,this.ctx.lastPoint.y,it.x1,it.y1,it.x,it.y);Ot.push(Math.floor((jt.y+Wt)/Ft)+1),Ot.push(Math.floor((jt.y+jt.h+Wt)/Ft)+1);break;case"bct":var ae=se(this.ctx.lastPoint.x,this.ctx.lastPoint.y,it.x1,it.y1,it.x2,it.y2,it.x,it.y);Ot.push(Math.floor((ae.y+Wt)/Ft)+1),Ot.push(Math.floor((ae.y+ae.h+Wt)/Ft)+1);break;case"rect":Ot.push(Math.floor((it.y+Wt)/Ft)+1),Ot.push(Math.floor((it.y+it.h+Wt)/Ft)+1)}for(var ie=0;ie<Ot.length;ie+=1)for(;this.pdf.internal.getNumberOfPages()<Ot[ie];)Q.call(this);return Ot},Q=function(){var it=this.fillStyle,vt=this.strokeStyle,Ft=this.font,Ot=this.lineCap,Wt=this.lineWidth,jt=this.lineJoin;this.pdf.addPage(),this.fillStyle=it,this.strokeStyle=vt,this.font=Ft,this.lineCap=Ot,this.lineWidth=Wt,this.lineJoin=jt},q=function(it,vt,Ft){for(var Ot=0;Ot<it.length;Ot++)switch(it[Ot].type){case"bct":it[Ot].x2+=vt,it[Ot].y2+=Ft;case"qct":it[Ot].x1+=vt,it[Ot].y1+=Ft;case"mt":case"lt":case"arc":default:it[Ot].x+=vt,it[Ot].y+=Ft}return it},Y=function(it){return it.sort(function(vt,Ft){return vt-Ft})},tt=function(it,vt){for(var Ft,Ot,Wt=this.fillStyle,jt=this.strokeStyle,ae=this.lineCap,ie=this.lineWidth,Be=Math.abs(ie*this.ctx.transform.scaleX),Te=this.lineJoin,Ne=JSON.parse(JSON.stringify(this.path)),Qe=JSON.parse(JSON.stringify(this.path)),He=[],ge=0;ge<Qe.length;ge++)if(Qe[ge].x!==void 0)for(var Ut=N.call(this,Qe[ge]),Yt=0;Yt<Ut.length;Yt+=1)He.indexOf(Ut[Yt])===-1&&He.push(Ut[Yt]);for(var tr=0;tr<He.length;tr++)for(;this.pdf.internal.getNumberOfPages()<He[tr];)Q.call(this);if(Y(He),this.autoPaging)for(var Ee=He[0],_e=He[He.length-1],xe=Ee;xe<_e+1;xe++){this.pdf.setPage(xe),this.fillStyle=Wt,this.strokeStyle=jt,this.lineCap=ae,this.lineWidth=Be,this.lineJoin=Te;var De=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],nr=xe===1?this.posY+this.margin[0]:this.margin[0],ur=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ir=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Sr=xe===1?0:ur+(xe-2)*Ir;if(this.ctx.clip_path.length!==0){var Dr=this.path;Ft=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=q(Ft,this.posX+this.margin[3],-Sr+nr+this.ctx.prevPageLastElemOffset),ft.call(this,it,!0),this.path=Dr}if(Ot=JSON.parse(JSON.stringify(Ne)),this.path=q(Ot,this.posX+this.margin[3],-Sr+nr+this.ctx.prevPageLastElemOffset),vt===!1||xe===0){var Nr=(xe>Ee||xe<_e)&&U.call(this);Nr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],De,Ir,null).clip().discardPath()),ft.call(this,it,vt),Nr&&this.pdf.restoreGraphicsState()}this.lineWidth=ie}else this.lineWidth=Be,ft.call(this,it,vt),this.lineWidth=ie;this.path=Ne},ft=function(it,vt){if((it!=="stroke"||vt||!M.call(this))&&(it==="stroke"||vt||!C.call(this))){for(var Ft,Ot,Wt=[],jt=this.path,ae=0;ae<jt.length;ae++){var ie=jt[ae];switch(ie.type){case"begin":Wt.push({begin:!0});break;case"close":Wt.push({close:!0});break;case"mt":Wt.push({start:ie,deltas:[],abs:[]});break;case"lt":var Be=Wt.length;if(jt[ae-1]&&!isNaN(jt[ae-1].x)&&(Ft=[ie.x-jt[ae-1].x,ie.y-jt[ae-1].y],Be>0)){for(;Be>=0;Be--)if(Wt[Be-1].close!==!0&&Wt[Be-1].begin!==!0){Wt[Be-1].deltas.push(Ft),Wt[Be-1].abs.push(ie);break}}break;case"bct":Ft=[ie.x1-jt[ae-1].x,ie.y1-jt[ae-1].y,ie.x2-jt[ae-1].x,ie.y2-jt[ae-1].y,ie.x-jt[ae-1].x,ie.y-jt[ae-1].y],Wt[Wt.length-1].deltas.push(Ft);break;case"qct":var Te=jt[ae-1].x+2/3*(ie.x1-jt[ae-1].x),Ne=jt[ae-1].y+2/3*(ie.y1-jt[ae-1].y),Qe=ie.x+2/3*(ie.x1-ie.x),He=ie.y+2/3*(ie.y1-ie.y),ge=ie.x,Ut=ie.y;Ft=[Te-jt[ae-1].x,Ne-jt[ae-1].y,Qe-jt[ae-1].x,He-jt[ae-1].y,ge-jt[ae-1].x,Ut-jt[ae-1].y],Wt[Wt.length-1].deltas.push(Ft);break;case"arc":Wt.push({deltas:[],abs:[],arc:!0}),Array.isArray(Wt[Wt.length-1].abs)&&Wt[Wt.length-1].abs.push(ie)}}Ot=vt?null:it==="stroke"?"stroke":"fill";for(var Yt=!1,tr=0;tr<Wt.length;tr++)if(Wt[tr].arc)for(var Ee=Wt[tr].abs,_e=0;_e<Ee.length;_e++){var xe=Ee[_e];xe.type==="arc"?dt.call(this,xe.x,xe.y,xe.radius,xe.startAngle,xe.endAngle,xe.counterclockwise,void 0,vt,!Yt):wt.call(this,xe.x,xe.y),Yt=!0}else if(Wt[tr].close===!0)this.pdf.internal.out("h"),Yt=!1;else if(Wt[tr].begin!==!0){var De=Wt[tr].start.x,nr=Wt[tr].start.y;yt.call(this,Wt[tr].deltas,De,nr),Yt=!0}Ot&&Rt.call(this,Ot),vt&&Lt.call(this)}},pt=function(it){var vt=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Ft=vt*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return it-Ft;case"top":return it+vt-Ft;case"hanging":return it+vt-2*Ft;case"middle":return it+vt/2-Ft;case"ideographic":return it;case"alphabetic":default:return it}},mt=function(it){return it+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};b.prototype.createLinearGradient=function(){var it=function(){};return it.colorStops=[],it.addColorStop=function(vt,Ft){this.colorStops.push([vt,Ft])},it.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},it.isCanvasGradient=!0,it},b.prototype.createPattern=function(){return this.createLinearGradient()},b.prototype.createRadialGradient=function(){return this.createLinearGradient()};var dt=function(it,vt,Ft,Ot,Wt,jt,ae,ie,Be){for(var Te=Zt.call(this,Ft,Ot,Wt,jt),Ne=0;Ne<Te.length;Ne++){var Qe=Te[Ne];Ne===0&&(Be?st.call(this,Qe.x1+it,Qe.y1+vt):wt.call(this,Qe.x1+it,Qe.y1+vt)),te.call(this,it,vt,Qe.x2,Qe.y2,Qe.x3,Qe.y3,Qe.x4,Qe.y4)}ie?Lt.call(this):Rt.call(this,ae)},Rt=function(it){switch(it){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Lt=function(){this.pdf.clip(),this.pdf.discardPath()},st=function(it,vt){this.pdf.internal.out(e(it)+" "+n(vt)+" m")},ct=function(it){var vt;switch(it.align){case"right":case"end":vt="right";break;case"center":vt="center";break;case"left":case"start":default:vt="left"}var Ft=this.pdf.getTextDimensions(it.text),Ot=pt.call(this,it.y),Wt=mt.call(this,Ot)-Ft.h,jt=this.ctx.transform.applyToPoint(new a(it.x,Ot)),ae=this.ctx.transform.decompose(),ie=new A;ie=(ie=(ie=ie.multiply(ae.translate)).multiply(ae.skew)).multiply(ae.scale);for(var Be,Te,Ne,Qe=this.ctx.transform.applyToRectangle(new o(it.x,Ot,Ft.w,Ft.h)),He=ie.applyToRectangle(new o(it.x,Wt,Ft.w,Ft.h)),ge=N.call(this,He),Ut=[],Yt=0;Yt<ge.length;Yt+=1)Ut.indexOf(ge[Yt])===-1&&Ut.push(ge[Yt]);if(Y(Ut),this.autoPaging)for(var tr=Ut[0],Ee=Ut[Ut.length-1],_e=tr;_e<Ee+1;_e++){this.pdf.setPage(_e);var xe=_e===1?this.posY+this.margin[0]:this.margin[0],De=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],nr=this.pdf.internal.pageSize.height-this.margin[2],ur=nr-this.margin[0],Ir=this.pdf.internal.pageSize.width-this.margin[1],Sr=Ir-this.margin[3],Dr=_e===1?0:De+(_e-2)*ur;if(this.ctx.clip_path.length!==0){var Nr=this.path;Be=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=q(Be,this.posX+this.margin[3],-1*Dr+xe),ft.call(this,"fill",!0),this.path=Nr}var fe=q([JSON.parse(JSON.stringify(He))],this.posX+this.margin[3],-Dr+xe+this.ctx.prevPageLastElemOffset)[0];it.scale>=.01&&(Te=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Te*it.scale),Ne=this.lineWidth,this.lineWidth=Ne*it.scale);var Tr=this.autoPaging!=="text";if(Tr||fe.y+fe.h<=nr){if(Tr||fe.y>=xe&&fe.x<=Ir){var Oe=Tr?it.text:this.pdf.splitTextToSize(it.text,it.maxWidth||Ir-fe.x)[0],wn=q([JSON.parse(JSON.stringify(Qe))],this.posX+this.margin[3],-Dr+xe+this.ctx.prevPageLastElemOffset)[0],Fr=Tr&&(_e>tr||_e<Ee)&&U.call(this);Fr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Sr,ur,null).clip().discardPath()),this.pdf.text(Oe,wn.x,wn.y,{angle:it.angle,align:vt,renderingMode:it.renderingMode}),Fr&&this.pdf.restoreGraphicsState()}}else fe.y<nr&&(this.ctx.prevPageLastElemOffset+=nr-fe.y);it.scale>=.01&&(this.pdf.setFontSize(Te),this.lineWidth=Ne)}else it.scale>=.01&&(Te=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Te*it.scale),Ne=this.lineWidth,this.lineWidth=Ne*it.scale),this.pdf.text(it.text,jt.x+this.posX,jt.y+this.posY,{angle:it.angle,align:vt,renderingMode:it.renderingMode,maxWidth:it.maxWidth}),it.scale>=.01&&(this.pdf.setFontSize(Te),this.lineWidth=Ne)},wt=function(it,vt,Ft,Ot){Ft=Ft||0,Ot=Ot||0,this.pdf.internal.out(e(it+Ft)+" "+n(vt+Ot)+" l")},yt=function(it,vt,Ft){return this.pdf.lines(it,vt,Ft,null,null)},te=function(it,vt,Ft,Ot,Wt,jt,ae,ie){this.pdf.internal.out([t(i(Ft+it)),t(s(Ot+vt)),t(i(Wt+it)),t(s(jt+vt)),t(i(ae+it)),t(s(ie+vt)),"c"].join(" "))},Zt=function(it,vt,Ft,Ot){for(var Wt=2*Math.PI,jt=Math.PI/2;vt>Ft;)vt-=Wt;var ae=Math.abs(Ft-vt);ae<Wt&&Ot&&(ae=Wt-ae);for(var ie=[],Be=Ot?-1:1,Te=vt;ae>1e-5;){var Ne=Te+Be*Math.min(ae,jt);ie.push(re.call(this,it,Te,Ne)),ae-=Math.abs(Ne-Te),Te=Ne}return ie},re=function(it,vt,Ft){var Ot=(Ft-vt)/2,Wt=it*Math.cos(Ot),jt=it*Math.sin(Ot),ae=Wt,ie=-jt,Be=ae*ae+ie*ie,Te=Be+ae*Wt+ie*jt,Ne=4/3*(Math.sqrt(2*Be*Te)-Te)/(ae*jt-ie*Wt),Qe=ae-Ne*ie,He=ie+Ne*ae,ge=Qe,Ut=-He,Yt=Ot+vt,tr=Math.cos(Yt),Ee=Math.sin(Yt);return{x1:it*Math.cos(vt),y1:it*Math.sin(vt),x2:Qe*tr-He*Ee,y2:Qe*Ee+He*tr,x3:ge*tr-Ut*Ee,y3:ge*Ee+Ut*tr,x4:it*Math.cos(Ft),y4:it*Math.sin(Ft)}},Xt=function(it){return 180*it/Math.PI},ne=function(it,vt,Ft,Ot,Wt,jt){var ae=it+.5*(Ft-it),ie=vt+.5*(Ot-vt),Be=Wt+.5*(Ft-Wt),Te=jt+.5*(Ot-jt),Ne=Math.min(it,Wt,ae,Be),Qe=Math.max(it,Wt,ae,Be),He=Math.min(vt,jt,ie,Te),ge=Math.max(vt,jt,ie,Te);return new o(Ne,He,Qe-Ne,ge-He)},se=function(it,vt,Ft,Ot,Wt,jt,ae,ie){var Be,Te,Ne,Qe,He,ge,Ut,Yt,tr,Ee,_e,xe,De,nr,ur=Ft-it,Ir=Ot-vt,Sr=Wt-Ft,Dr=jt-Ot,Nr=ae-Wt,fe=ie-jt;for(Te=0;Te<41;Te++)tr=(Ut=(Ne=it+(Be=Te/40)*ur)+Be*((He=Ft+Be*Sr)-Ne))+Be*(He+Be*(Wt+Be*Nr-He)-Ut),Ee=(Yt=(Qe=vt+Be*Ir)+Be*((ge=Ot+Be*Dr)-Qe))+Be*(ge+Be*(jt+Be*fe-ge)-Yt),Te==0?(_e=tr,xe=Ee,De=tr,nr=Ee):(_e=Math.min(_e,tr),xe=Math.min(xe,Ee),De=Math.max(De,tr),nr=Math.max(nr,Ee));return new o(Math.round(_e),Math.round(xe),Math.round(De-_e),Math.round(nr-xe))},we=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var it,vt,Ft=(it=this.ctx.lineDash,vt=this.ctx.lineDashOffset,JSON.stringify({lineDash:it,lineDashOffset:vt}));this.prevLineDash!==Ft&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Ft)}}})(jr.API),function(r){var t=function(s){var a,o,A,f,m,b,x,C,M,U;for(o=[],A=0,f=(s+=a="\0\0\0\0".slice(s.length%4||4)).length;f>A;A+=4)(m=(s.charCodeAt(A)<<24)+(s.charCodeAt(A+1)<<16)+(s.charCodeAt(A+2)<<8)+s.charCodeAt(A+3))!==0?(b=(m=((m=((m=((m=(m-(U=m%85))/85)-(M=m%85))/85)-(C=m%85))/85)-(x=m%85))/85)%85,o.push(b+33,x+33,C+33,M+33,U+33)):o.push(122);return function(N,Q){for(var q=Q;q>0;q--)N.pop()}(o,a.length),String.fromCharCode.apply(String,o)+"~>"},e=function(s){var a,o,A,f,m,b=String,x="length",C=255,M="charCodeAt",U="slice",N="replace";for(s[U](-2),s=s[U](0,-2)[N](/\s/g,"")[N]("z","!!!!!"),A=[],f=0,m=(s+=a="uuuuu"[U](s[x]%5||5))[x];m>f;f+=5)o=52200625*(s[M](f)-33)+614125*(s[M](f+1)-33)+7225*(s[M](f+2)-33)+85*(s[M](f+3)-33)+(s[M](f+4)-33),A.push(C&o>>24,C&o>>16,C&o>>8,C&o);return function(Q,q){for(var Y=q;Y>0;Y--)Q.pop()}(A,a[x]),b.fromCharCode.apply(b,A)},n=function(s){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),a.test(s)===!1)return"";for(var o="",A=0;A<s.length;A+=2)o+=String.fromCharCode("0x"+(s[A]+s[A+1]));return o},i=function(s){for(var a=new Uint8Array(s.length),o=s.length;o--;)a[o]=s.charCodeAt(o);return s=(a=A2(a)).reduce(function(A,f){return A+String.fromCharCode(f)},"")};r.processDataByFilters=function(s,a){var o=0,A=s||"",f=[];for(typeof(a=a||[])=="string"&&(a=[a]),o=0;o<a.length;o+=1)switch(a[o]){case"ASCII85Decode":case"/ASCII85Decode":A=e(A),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":A=t(A),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":A=n(A),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":A=A.split("").map(function(m){return("0"+m.charCodeAt().toString(16)).slice(-2)}).join("")+">",f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":A=i(A),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[o]+'" is not implemented')}return{data:A,reverseChain:f.reverse().join(" ")}}}(jr.API),function(r){r.loadFile=function(t,e,n){return function(i,s,a){s=s!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=function(A,f,m){var b=new XMLHttpRequest,x=0,C=function(M){var U=M.length,N=[],Q=String.fromCharCode;for(x=0;x<U;x+=1)N.push(Q(255&M.charCodeAt(x)));return N.join("")};if(b.open("GET",A,!f),b.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(b.onload=function(){b.status===200?m(C(this.responseText)):m(void 0)}),b.send(null),f&&b.status===200)return C(b.responseText)}(i,s,a)}catch{}return o}(t,e,n)},r.loadImageFile=r.loadFile}(jr.API),function(r){function t(){return(Vr.html2canvas?Promise.resolve(Vr.html2canvas):Promise.resolve().then(()=>Tct)).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function e(){return(Vr.DOMPurify?Promise.resolve(Vr.DOMPurify):Promise.resolve().then(()=>ilt)).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var n=function(a){var o=On(a);return o==="undefined"?"undefined":o==="string"||a instanceof String?"string":o==="number"||a instanceof Number?"number":o==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":o==="object"?"object":"unknown"},i=function(a,o){var A=document.createElement(a);for(var f in o.className&&(A.className=o.className),o.innerHTML&&o.dompurify&&(A.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)A.style[f]=o.style[f];return A},s=function a(o){var A=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),f=a.convert(Promise.resolve(),A);return f=(f=f.setProgress(1,a,1,[a])).set(o)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(a,o){return a.__proto__=o||s.prototype,a},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(a,o){return this.then(function(){switch(o=o||function(A){switch(n(A)){case"string":return"string";case"element":return A.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(a)){case"string":return this.then(e).then(function(A){return this.set({src:i("div",{innerHTML:a,dompurify:A})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},s.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function A(f,m){for(var b=f.nodeType===3?document.createTextNode(f.nodeValue):f.cloneNode(!1),x=f.firstChild;x;x=x.nextSibling)m!==!0&&x.nodeType===1&&x.nodeName==="SCRIPT"||b.appendChild(A(x,m));return f.nodeType===1&&(f.nodeName==="CANVAS"?(b.width=f.width,b.height=f.height,b.getContext("2d").drawImage(f,0,0)):f.nodeName!=="TEXTAREA"&&f.nodeName!=="SELECT"||(b.value=f.value),b.addEventListener("load",function(){b.scrollTop=f.scrollTop,b.scrollLeft=f.scrollLeft},!0)),b}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(o){var A=Object.assign({},this.opt.html2canvas);return delete A.onrendered,o(this.prop.container,A)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(o){var A=this.opt.jsPDF,f=this.opt.fontFaces,m=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,b=Object.assign({async:!0,allowTaint:!0,scale:m,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete b.onrendered,A.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,A.context2d.posX=this.opt.x,A.context2d.posY=this.opt.y,A.context2d.margin=this.opt.margin,A.context2d.fontFaces=f,f)for(var x=0;x<f.length;++x){var C=f[x],M=C.src.find(function(U){return U.format==="truetype"});M&&A.addFont(M.url,C.ref.name,C.ref.style)}return b.windowHeight=b.windowHeight||0,b.windowHeight=b.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):b.windowHeight,A.context2d.save(!0),o(this.prop.container,b)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(a,o,A){return(A=A||"pdf").toLowerCase()==="img"||A.toLowerCase()==="image"?this.outputImg(a,o):this.outputPdf(a,o)},s.prototype.outputPdf=function(a,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,o)})},s.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},s.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(a){if(n(a)!=="object")return this;var o=Object.keys(a||{}).map(function(A){if(A in s.template.prop)return function(){this.prop[A]=a[A]};switch(A){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[A]=a[A]}}},this);return this.then(function(){return this.thenList(o)})},s.prototype.get=function(a,o){return this.then(function(){var A=a in s.template.prop?this.prop[a]:this.opt[a];return o?o(A):A})},s.prototype.setMargin=function(a){return this.then(function(){switch(n(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},s.prototype.setPageSize=function(a){function o(A,f){return Math.floor(A*f/72*96)}return this.then(function(){(a=a||jr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:o(a.inner.width,a.k),height:o(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},s.prototype.setProgress=function(a,o,A,f){return a!=null&&(this.progress.val=a),o!=null&&(this.progress.state=o),A!=null&&(this.progress.n=A),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(a,o,A,f){return this.setProgress(a?this.progress.val+a:null,o||null,A?this.progress.n+A:null,f?this.progress.stack.concat(f):null)},s.prototype.then=function(a,o){var A=this;return this.thenCore(a,o,function(f,m){return A.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(b){return A.updateProgress(null,f),b}).then(f,m).then(function(b){return A.updateProgress(1),b})})},s.prototype.thenCore=function(a,o,A){A=A||Promise.prototype.then,a&&(a=a.bind(this)),o&&(o=o.bind(this));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),m=A.call(f,a,o);return s.convert(m,this.__proto__)},s.prototype.thenExternal=function(a,o){return Promise.prototype.then.call(this,a,o)},s.prototype.thenList=function(a){var o=this;return a.forEach(function(A){o=o.thenCore(A)}),o},s.prototype.catch=function(a){a&&(a=a.bind(this));var o=Promise.prototype.catch.call(this,a);return s.convert(o,this)},s.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},s.prototype.error=function(a){return this.then(function(){throw new Error(a)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,jr.getPageSize=function(a,o,A){if(On(a)==="object"){var f=a;a=f.orientation,o=f.unit||o,A=f.format||A}o=o||"mm",A=A||"a4",a=(""+(a||"P")).toLowerCase();var m,b=(""+A).toLowerCase(),x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":m=1;break;case"mm":m=72/25.4;break;case"cm":m=72/2.54;break;case"in":m=72;break;case"px":m=.75;break;case"pc":case"em":m=12;break;case"ex":m=6;break;default:throw"Invalid unit: "+o}var C,M=0,U=0;if(x.hasOwnProperty(b))M=x[b][1]/m,U=x[b][0]/m;else try{M=A[1],U=A[0]}catch{throw new Error("Invalid format: "+A)}if(a==="p"||a==="portrait")a="p",U>M&&(C=U,U=M,M=C);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",M>U&&(C=U,U=M,M=C)}return{width:U,height:M,unit:o,k:m,orientation:a}},r.html=function(a,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(w2):null;var A=new s(o);return o.worker?A:A.from(a).doCallback()}}(jr.API),jr.API.addJS=function(r){return VF=r,this.internal.events.subscribe("postPutResources",function(){yy=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(yy+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),GF=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+VF+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){yy!==void 0&&GF!==void 0&&this.internal.out("/Names <</JavaScript "+yy+" 0 R>>")}),this},function(r){var t;r.events.push(["postPutResources",function(){var e=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=e.outline.render().split(/\r\n/),s=0;s<i.length;s++){var a=i[s],o=n.exec(a);if(o!=null){var A=o[1];e.internal.newObjectDeferredBegin(A,!1)}e.internal.write(a)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,m=[];for(s=0;s<f;s++){var b=e.internal.newObject();m.push(b);var x=e.internal.getPageInfo(s+1);e.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var C=e.internal.newObject();for(e.internal.write("<< /Names [ "),s=0;s<m.length;s++)e.internal.write("(page_"+(s+1)+")"+m[s]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+C+" 0 R"),e.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),r.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(n,i,s){var a={title:i,options:s,children:[]};return n==null&&(n=this.root),n.children.push(a),a},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(n){n.id=e.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},e.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},e.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var a=n.children[s];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var A=e.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+A.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var f=0;f<n.children.length;f++)this.renderItems(n.children[f])},e.outline.line=function(n){this.ctx.val+=n+`\r
`},e.outline.makeRef=function(n){return n.id+" 0 R"},e.outline.makeString=function(n){return"("+e.internal.pdfEscape(n)+")"},e.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},e.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},e.outline.count_r=function(n,i){for(var s=0;s<i.children.length;s++)n.count++,this.count_r(n,i.children[s]);return n.count}}])}(jr.API),function(r){var t=[192,193,194,195,196,197,198,199];r.processJPEG=function(e,n,i,s,a,o){var A,f=this.decode.DCT_DECODE,m=null;if(typeof e=="string"||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=a||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,(A=function(b){for(var x,C=256*b.charCodeAt(4)+b.charCodeAt(5),M=b.length,U={width:0,height:0,numcomponents:1},N=4;N<M;N+=2){if(N+=C,t.indexOf(b.charCodeAt(N+1))!==-1){x=256*b.charCodeAt(N+5)+b.charCodeAt(N+6),U={width:256*b.charCodeAt(N+7)+b.charCodeAt(N+8),height:x,numcomponents:b.charCodeAt(N+9)};break}C=256*b.charCodeAt(N+2)+b.charCodeAt(N+3)}return U}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}m={data:e,width:A.width,height:A.height,colorSpace:o,bitsPerComponent:8,filter:f,index:n,alias:i}}return m}}(jr.API);var xf,_y,qF,KF,WF,Pet=function(){var r,t,e;function n(s){var a,o,A,f,m,b,x,C,M,U,N,Q,q,Y;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},b=null;;){switch(a=this.readUInt32(),M=(function(){var tt,ft;for(ft=[],tt=0;tt<4;++tt)ft.push(String.fromCharCode(this.data[this.pos++]));return ft}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(a);break;case"fcTL":b&&this.animation.frames.push(b),this.pos+=4,b={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},m=this.readUInt16(),f=this.readUInt16()||100,b.delay=1e3*m/f,b.disposeOp=this.data[this.pos++],b.blendOp=this.data[this.pos++],b.data=[];break;case"IDAT":case"fdAT":for(M==="fdAT"&&(this.pos+=4,a-=4),s=(b!=null?b.data:void 0)||this.imgData,Q=0;0<=a?Q<a:Q>a;0<=a?++Q:--Q)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(A=this.palette.length/3,this.transparency.indexed=this.read(a),this.transparency.indexed.length>A)throw new Error("More transparent colors than palette size");if((U=A-this.transparency.indexed.length)>0)for(q=0;0<=U?q<U:q>U;0<=U?++q:--q)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(a)[0];break;case 2:this.transparency.rgb=this.read(a)}break;case"tEXt":x=(N=this.read(a)).indexOf(0),C=String.fromCharCode.apply(String,N.slice(0,x)),this.text[C]=String.fromCharCode.apply(String,N.slice(x+1));break;case"IEND":return b&&this.animation.frames.push(b),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(Y=this.colorType)===4||Y===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=a}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(s){var a,o;for(o=[],a=0;0<=s?a<s:a>s;0<=s?++a:--a)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(s){var a=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*a),A=0,f=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function m(b,x,C,M){var U,N,Q,q,Y,tt,ft,pt,mt,dt,Rt,Lt,st,ct,wt,yt,te,Zt,re,Xt,ne,se=Math.ceil((f.width-b)/C),we=Math.ceil((f.height-x)/M),it=f.width==se&&f.height==we;for(ct=a*se,Lt=it?o:new Uint8Array(ct*we),tt=s.length,st=0,N=0;st<we&&A<tt;){switch(s[A++]){case 0:for(q=te=0;te<ct;q=te+=1)Lt[N++]=s[A++];break;case 1:for(q=Zt=0;Zt<ct;q=Zt+=1)U=s[A++],Y=q<a?0:Lt[N-a],Lt[N++]=(U+Y)%256;break;case 2:for(q=re=0;re<ct;q=re+=1)U=s[A++],Q=(q-q%a)/a,wt=st&&Lt[(st-1)*ct+Q*a+q%a],Lt[N++]=(wt+U)%256;break;case 3:for(q=Xt=0;Xt<ct;q=Xt+=1)U=s[A++],Q=(q-q%a)/a,Y=q<a?0:Lt[N-a],wt=st&&Lt[(st-1)*ct+Q*a+q%a],Lt[N++]=(U+Math.floor((Y+wt)/2))%256;break;case 4:for(q=ne=0;ne<ct;q=ne+=1)U=s[A++],Q=(q-q%a)/a,Y=q<a?0:Lt[N-a],st===0?wt=yt=0:(wt=Lt[(st-1)*ct+Q*a+q%a],yt=Q&&Lt[(st-1)*ct+(Q-1)*a+q%a]),ft=Y+wt-yt,pt=Math.abs(ft-Y),dt=Math.abs(ft-wt),Rt=Math.abs(ft-yt),mt=pt<=dt&&pt<=Rt?Y:dt<=Rt?wt:yt,Lt[N++]=(U+mt)%256;break;default:throw new Error("Invalid filter algorithm: "+s[A-1])}if(!it){var vt=((x+st*M)*f.width+b)*a,Ft=st*ct;for(q=0;q<se;q+=1){for(var Ot=0;Ot<a;Ot+=1)o[vt++]=Lt[Ft++];vt+=(C-1)*a}}st++}}return s=het(s),f.interlaceMethod==1?(m(0,0,8,8),m(4,0,8,8),m(0,4,4,8),m(2,0,4,4),m(0,2,2,4),m(1,0,2,2),m(0,1,1,2)):m(0,0,1,1),o},n.prototype.decodePalette=function(){var s,a,o,A,f,m,b,x,C;for(o=this.palette,m=this.transparency.indexed||[],f=new Uint8Array((m.length||0)+o.length),A=0,s=0,a=b=0,x=o.length;b<x;a=b+=3)f[A++]=o[a],f[A++]=o[a+1],f[A++]=o[a+2],f[A++]=(C=m[s++])!=null?C:255;return f},n.prototype.copyToImageData=function(s,a){var o,A,f,m,b,x,C,M,U,N,Q;if(A=this.colors,U=null,o=this.hasAlphaChannel,this.palette.length&&(U=(Q=this._decodedPalette)!=null?Q:this._decodedPalette=this.decodePalette(),A=4,o=!0),M=(f=s.data||s).length,b=U||a,m=x=0,A===1)for(;m<M;)C=U?4*a[m/4]:x,N=b[C++],f[m++]=N,f[m++]=N,f[m++]=N,f[m++]=o?b[C++]:255,x=C;else for(;m<M;)C=U?4*a[m/4]:x,f[m++]=b[C++],f[m++]=b[C++],f[m++]=b[C++],f[m++]=o?b[C++]:255,x=C},n.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var i=function(){if(Object.prototype.toString.call(Vr)==="[object Window]"){try{t=Vr.document.createElement("canvas"),e=t.getContext("2d")}catch{return!1}return!0}return!1};return i(),r=function(s){var a;if(i()===!0)return e.width=s.width,e.height=s.height,e.clearRect(0,0,s.width,s.height),e.putImageData(s,0,0),(a=new Image).src=t.toDataURL(),a;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(s){var a,o,A,f,m,b,x,C;if(this.animation){for(C=[],o=m=0,b=(x=this.animation.frames).length;m<b;o=++m)a=x[o],A=s.createImageData(a.width,a.height),f=this.decodePixels(new Uint8Array(a.data)),this.copyToImageData(A,f),a.imageData=A,C.push(a.image=r(A));return C}},n.prototype.renderFrame=function(s,a){var o,A,f;return o=(A=this.animation.frames)[a],f=A[a-1],a===0&&s.clearRect(0,0,this.width,this.height),(f!=null?f.disposeOp:void 0)===1?s.clearRect(f.xOffset,f.yOffset,f.width,f.height):(f!=null?f.disposeOp:void 0)===2&&s.putImageData(f.imageData,f.xOffset,f.yOffset),o.blendOp===0&&s.clearRect(o.xOffset,o.yOffset,o.width,o.height),s.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(s){var a,o,A,f,m,b,x=this;return o=0,b=this.animation,f=b.numFrames,A=b.frames,m=b.numPlays,(a=function(){var C,M;if(C=o++%f,M=A[C],x.renderFrame(s,C),f>1&&o/f<m)return x.animation._timeout=setTimeout(a,M.delay)})()},n.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},n.prototype.render=function(s){var a,o;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,a=s.getContext("2d"),this.animation?(this.decodeFrames(a),this.animate(a)):(o=a.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),a.putImageData(o,0,0))},n}();/**
* @license
*
* Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
*
* Permission is hereby granted, free of charge, to any person obtaining
* a copy of this software and associated documentation files (the
* "Software"), to deal in the Software without restriction, including
* without limitation the rights to use, copy, modify, merge, publish,
* distribute, sublicense, and/or sell copies of the Software, and to
* permit persons to whom the Software is furnished to do so, subject to
* the following conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
* LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
* OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
* WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
* ====================================================================
*//**
* @license
* (c) Dean McNamee <dean@gmail.com>, 2013.
*
* https://github.com/deanm/omggif
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to
* deal in the Software without restriction, including without limitation the
* rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
* sell copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in
* all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
* IN THE SOFTWARE.
*
* omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
* including animation and compression.  It does not rely on any specific
* underlying system, so should run in the browser, Node, or Plask.
*/function Uet(r){var t=0;if(r[t++]!==71||r[t++]!==73||r[t++]!==70||r[t++]!==56||(r[t++]+1&253)!=56||r[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var e=r[t++]|r[t++]<<8,n=r[t++]|r[t++]<<8,i=r[t++],s=i>>7,a=1<<(7&i)+1;r[t++],r[t++];var o=null,A=null;s&&(o=t,A=a,t+=3*a);var f=!0,m=[],b=0,x=null,C=0,M=null;for(this.width=e,this.height=n;f&&t<r.length;)switch(r[t++]){case 33:switch(r[t++]){case 255:if(r[t]!==11||r[t+1]==78&&r[t+2]==69&&r[t+3]==84&&r[t+4]==83&&r[t+5]==67&&r[t+6]==65&&r[t+7]==80&&r[t+8]==69&&r[t+9]==50&&r[t+10]==46&&r[t+11]==48&&r[t+12]==3&&r[t+13]==1&&r[t+16]==0)t+=14,M=r[t++]|r[t++]<<8,t++;else for(t+=12;;){if(!((st=r[t++])>=0))throw Error("Invalid block size");if(st===0)break;t+=st}break;case 249:if(r[t++]!==4||r[t+4]!==0)throw new Error("Invalid graphics extension block.");var U=r[t++];b=r[t++]|r[t++]<<8,x=r[t++],!(1&U)&&(x=null),C=U>>2&7,t++;break;case 254:for(;;){if(!((st=r[t++])>=0))throw Error("Invalid block size");if(st===0)break;t+=st}break;default:throw new Error("Unknown graphic control label: 0x"+r[t-1].toString(16))}break;case 44:var N=r[t++]|r[t++]<<8,Q=r[t++]|r[t++]<<8,q=r[t++]|r[t++]<<8,Y=r[t++]|r[t++]<<8,tt=r[t++],ft=tt>>6&1,pt=1<<(7&tt)+1,mt=o,dt=A,Rt=!1;tt>>7&&(Rt=!0,mt=t,dt=pt,t+=3*pt);var Lt=t;for(t++;;){var st;if(!((st=r[t++])>=0))throw Error("Invalid block size");if(st===0)break;t+=st}m.push({x:N,y:Q,width:q,height:Y,has_local_palette:Rt,palette_offset:mt,palette_size:dt,data_offset:Lt,data_length:t-Lt,transparent_index:x,interlaced:!!ft,delay:b,disposal:C});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+r[t-1].toString(16))}this.numFrames=function(){return m.length},this.loopCount=function(){return M},this.frameInfo=function(ct){if(ct<0||ct>=m.length)throw new Error("Frame index out of range.");return m[ct]},this.decodeAndBlitFrameBGRA=function(ct,wt){var yt=this.frameInfo(ct),te=yt.width*yt.height,Zt=new Uint8Array(te);$F(r,yt.data_offset,Zt,te);var re=yt.palette_offset,Xt=yt.transparent_index;Xt===null&&(Xt=256);var ne=yt.width,se=e-ne,we=ne,it=4*(yt.y*e+yt.x),vt=4*((yt.y+yt.height)*e+yt.x),Ft=it,Ot=4*se;yt.interlaced===!0&&(Ot+=4*e*7);for(var Wt=8,jt=0,ae=Zt.length;jt<ae;++jt){var ie=Zt[jt];if(we===0&&(we=ne,(Ft+=Ot)>=vt&&(Ot=4*se+4*e*(Wt-1),Ft=it+(ne+se)*(Wt<<1),Wt>>=1)),ie===Xt)Ft+=4;else{var Be=r[re+3*ie],Te=r[re+3*ie+1],Ne=r[re+3*ie+2];wt[Ft++]=Ne,wt[Ft++]=Te,wt[Ft++]=Be,wt[Ft++]=255}--we}},this.decodeAndBlitFrameRGBA=function(ct,wt){var yt=this.frameInfo(ct),te=yt.width*yt.height,Zt=new Uint8Array(te);$F(r,yt.data_offset,Zt,te);var re=yt.palette_offset,Xt=yt.transparent_index;Xt===null&&(Xt=256);var ne=yt.width,se=e-ne,we=ne,it=4*(yt.y*e+yt.x),vt=4*((yt.y+yt.height)*e+yt.x),Ft=it,Ot=4*se;yt.interlaced===!0&&(Ot+=4*e*7);for(var Wt=8,jt=0,ae=Zt.length;jt<ae;++jt){var ie=Zt[jt];if(we===0&&(we=ne,(Ft+=Ot)>=vt&&(Ot=4*se+4*e*(Wt-1),Ft=it+(ne+se)*(Wt<<1),Wt>>=1)),ie===Xt)Ft+=4;else{var Be=r[re+3*ie],Te=r[re+3*ie+1],Ne=r[re+3*ie+2];wt[Ft++]=Be,wt[Ft++]=Te,wt[Ft++]=Ne,wt[Ft++]=255}--we}}}function $F(r,t,e,n){for(var i=r[t++],s=1<<i,a=s+1,o=a+1,A=i+1,f=(1<<A)-1,m=0,b=0,x=0,C=r[t++],M=new Int32Array(4096),U=null;;){for(;m<16&&C!==0;)b|=r[t++]<<m,m+=8,C===1?C=r[t++]:--C;if(m<A)break;var N=b&f;if(b>>=A,m-=A,N!==s){if(N===a)break;for(var Q=N<o?N:U,q=0,Y=Q;Y>s;)Y=M[Y]>>8,++q;var tt=Y;if(x+q+(Q!==N?1:0)>n)return void ci.log("Warning, gif stream longer than expected.");e[x++]=tt;var ft=x+=q;for(Q!==N&&(e[x++]=tt),Y=Q;q--;)Y=M[Y],e[--ft]=255&Y,Y>>=8;U!==null&&o<4096&&(M[o++]=U<<8|tt,o>=f+1&&A<12&&(++A,f=f<<1|1)),U=N}else o=a+1,f=(1<<(A=i+1))-1,U=null}return x!==n&&ci.log("Warning, gif stream shorter than expected."),e}/**
	 * @license
	  Copyright (c) 2008, Adobe Systems Incorporated
	  All rights reserved.

	  Redistribution and use in source and binary forms, with or without 
	  modification, are permitted provided that the following conditions are
	  met:

	  * Redistributions of source code must retain the above copyright notice, 
	    this list of conditions and the following disclaimer.
	  
	  * Redistributions in binary form must reproduce the above copyright
	    notice, this list of conditions and the following disclaimer in the 
	    documentation and/or other materials provided with the distribution.
	  
	  * Neither the name of Adobe Systems Incorporated nor the names of its 
	    contributors may be used to endorse or promote products derived from 
	    this software without specific prior written permission.

	  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
	  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
	  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
	  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
	  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
	  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
	  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
	  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
	  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
	  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
	  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	*/function x2(r){var t,e,n,i,s,a=Math.floor,o=new Array(64),A=new Array(64),f=new Array(64),m=new Array(64),b=new Array(65535),x=new Array(65535),C=new Array(64),M=new Array(64),U=[],N=0,Q=7,q=new Array(64),Y=new Array(64),tt=new Array(64),ft=new Array(256),pt=new Array(2048),mt=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],dt=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Rt=[0,1,2,3,4,5,6,7,8,9,10,11],Lt=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],st=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],ct=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],wt=[0,1,2,3,4,5,6,7,8,9,10,11],yt=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],te=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Zt(it,vt){for(var Ft=0,Ot=0,Wt=new Array,jt=1;jt<=16;jt++){for(var ae=1;ae<=it[jt];ae++)Wt[vt[Ot]]=[],Wt[vt[Ot]][0]=Ft,Wt[vt[Ot]][1]=jt,Ot++,Ft++;Ft*=2}return Wt}function re(it){for(var vt=it[0],Ft=it[1]-1;Ft>=0;)vt&1<<Ft&&(N|=1<<Q),Ft--,--Q<0&&(N==255?(Xt(255),Xt(0)):Xt(N),Q=7,N=0)}function Xt(it){U.push(it)}function ne(it){Xt(it>>8&255),Xt(255&it)}function se(it,vt,Ft,Ot,Wt){for(var jt,ae=Wt[0],ie=Wt[240],Be=function(Ee,_e){var xe,De,nr,ur,Ir,Sr,Dr,Nr,fe,Tr,Oe=0;for(fe=0;fe<8;++fe){xe=Ee[Oe],De=Ee[Oe+1],nr=Ee[Oe+2],ur=Ee[Oe+3],Ir=Ee[Oe+4],Sr=Ee[Oe+5],Dr=Ee[Oe+6];var wn=xe+(Nr=Ee[Oe+7]),Fr=xe-Nr,Se=De+Dr,Xe=De-Dr,qe=nr+Sr,Yr=nr-Sr,Rr=ur+Ir,pr=ur-Ir,on=wn+Rr,Kr=wn-Rr,Ct=Se+qe,Z=Se-qe;Ee[Oe]=on+Ct,Ee[Oe+4]=on-Ct;var J=.707106781*(Z+Kr);Ee[Oe+2]=Kr+J,Ee[Oe+6]=Kr-J;var ot=.382683433*((on=pr+Yr)-(Z=Xe+Fr)),Et=.5411961*on+ot,Nt=1.306562965*Z+ot,zt=.707106781*(Ct=Yr+Xe),qt=Fr+zt,St=Fr-zt;Ee[Oe+5]=St+Et,Ee[Oe+3]=St-Et,Ee[Oe+1]=qt+Nt,Ee[Oe+7]=qt-Nt,Oe+=8}for(Oe=0,fe=0;fe<8;++fe){xe=Ee[Oe],De=Ee[Oe+8],nr=Ee[Oe+16],ur=Ee[Oe+24],Ir=Ee[Oe+32],Sr=Ee[Oe+40],Dr=Ee[Oe+48];var Jt=xe+(Nr=Ee[Oe+56]),me=xe-Nr,pe=De+Dr,de=De-Dr,Ge=nr+Sr,Ye=nr-Sr,Cr=ur+Ir,cr=ur-Ir,Pr=Jt+Cr,kr=Jt-Cr,Qr=pe+Ge,gn=pe-Ge;Ee[Oe]=Pr+Qr,Ee[Oe+32]=Pr-Qr;var gr=.707106781*(gn+kr);Ee[Oe+16]=kr+gr,Ee[Oe+48]=kr-gr;var Wr=.382683433*((Pr=cr+Ye)-(gn=de+me)),vn=.5411961*Pr+Wr,Dn=1.306562965*gn+Wr,Dt=.707106781*(Qr=Ye+de),Ue=me+Dt,Ie=me-Dt;Ee[Oe+40]=Ie+vn,Ee[Oe+24]=Ie-vn,Ee[Oe+8]=Ue+Dn,Ee[Oe+56]=Ue-Dn,Oe++}for(fe=0;fe<64;++fe)Tr=Ee[fe]*_e[fe],C[fe]=Tr>0?Tr+.5|0:Tr-.5|0;return C}(it,vt),Te=0;Te<64;++Te)M[mt[Te]]=Be[Te];var Ne=M[0]-Ft;Ft=M[0],Ne==0?re(Ot[0]):(re(Ot[x[jt=32767+Ne]]),re(b[jt]));for(var Qe=63;Qe>0&&M[Qe]==0;)Qe--;if(Qe==0)return re(ae),Ft;for(var He,ge=1;ge<=Qe;){for(var Ut=ge;M[ge]==0&&ge<=Qe;)++ge;var Yt=ge-Ut;if(Yt>=16){He=Yt>>4;for(var tr=1;tr<=He;++tr)re(ie);Yt&=15}jt=32767+M[ge],re(Wt[(Yt<<4)+x[jt]]),re(b[jt]),ge++}return Qe!=63&&re(ae),Ft}function we(it){it=Math.min(Math.max(it,1),100),s!=it&&(function(vt){for(var Ft=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Ot=0;Ot<64;Ot++){var Wt=a((Ft[Ot]*vt+50)/100);Wt=Math.min(Math.max(Wt,1),255),o[mt[Ot]]=Wt}for(var jt=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ae=0;ae<64;ae++){var ie=a((jt[ae]*vt+50)/100);ie=Math.min(Math.max(ie,1),255),A[mt[ae]]=ie}for(var Be=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Te=0,Ne=0;Ne<8;Ne++)for(var Qe=0;Qe<8;Qe++)f[Te]=1/(o[mt[Te]]*Be[Ne]*Be[Qe]*8),m[Te]=1/(A[mt[Te]]*Be[Ne]*Be[Qe]*8),Te++}(it<50?Math.floor(5e3/it):Math.floor(200-2*it)),s=it)}this.encode=function(it,vt){vt&&we(vt),U=new Array,N=0,Q=7,ne(65496),ne(65504),ne(16),Xt(74),Xt(70),Xt(73),Xt(70),Xt(0),Xt(1),Xt(1),Xt(0),ne(1),ne(1),Xt(0),Xt(0),function(){ne(65499),ne(132),Xt(0);for(var De=0;De<64;De++)Xt(o[De]);Xt(1);for(var nr=0;nr<64;nr++)Xt(A[nr])}(),function(De,nr){ne(65472),ne(17),Xt(8),ne(nr),ne(De),Xt(3),Xt(1),Xt(17),Xt(0),Xt(2),Xt(17),Xt(1),Xt(3),Xt(17),Xt(1)}(it.width,it.height),function(){ne(65476),ne(418),Xt(0);for(var De=0;De<16;De++)Xt(dt[De+1]);for(var nr=0;nr<=11;nr++)Xt(Rt[nr]);Xt(16);for(var ur=0;ur<16;ur++)Xt(Lt[ur+1]);for(var Ir=0;Ir<=161;Ir++)Xt(st[Ir]);Xt(1);for(var Sr=0;Sr<16;Sr++)Xt(ct[Sr+1]);for(var Dr=0;Dr<=11;Dr++)Xt(wt[Dr]);Xt(17);for(var Nr=0;Nr<16;Nr++)Xt(yt[Nr+1]);for(var fe=0;fe<=161;fe++)Xt(te[fe])}(),ne(65498),ne(12),Xt(3),Xt(1),Xt(0),Xt(2),Xt(17),Xt(3),Xt(17),Xt(0),Xt(63),Xt(0);var Ft=0,Ot=0,Wt=0;N=0,Q=7,this.encode.displayName="_encode_";for(var jt,ae,ie,Be,Te,Ne,Qe,He,ge,Ut=it.data,Yt=it.width,tr=it.height,Ee=4*Yt,_e=0;_e<tr;){for(jt=0;jt<Ee;){for(Te=Ee*_e+jt,Qe=-1,He=0,ge=0;ge<64;ge++)Ne=Te+(He=ge>>3)*Ee+(Qe=4*(7&ge)),_e+He>=tr&&(Ne-=Ee*(_e+1+He-tr)),jt+Qe>=Ee&&(Ne-=jt+Qe-Ee+4),ae=Ut[Ne++],ie=Ut[Ne++],Be=Ut[Ne++],q[ge]=(pt[ae]+pt[ie+256>>0]+pt[Be+512>>0]>>16)-128,Y[ge]=(pt[ae+768>>0]+pt[ie+1024>>0]+pt[Be+1280>>0]>>16)-128,tt[ge]=(pt[ae+1280>>0]+pt[ie+1536>>0]+pt[Be+1792>>0]>>16)-128;Ft=se(q,f,Ft,t,n),Ot=se(Y,m,Ot,e,i),Wt=se(tt,m,Wt,e,i),jt+=32}_e+=8}if(Q>=0){var xe=[];xe[1]=Q+1,xe[0]=(1<<Q+1)-1,re(xe)}return ne(65497),new Uint8Array(U)},r=r||50,function(){for(var it=String.fromCharCode,vt=0;vt<256;vt++)ft[vt]=it(vt)}(),t=Zt(dt,Rt),e=Zt(ct,wt),n=Zt(Lt,st),i=Zt(yt,te),function(){for(var it=1,vt=2,Ft=1;Ft<=15;Ft++){for(var Ot=it;Ot<vt;Ot++)x[32767+Ot]=Ft,b[32767+Ot]=[],b[32767+Ot][1]=Ft,b[32767+Ot][0]=Ot;for(var Wt=-(vt-1);Wt<=-it;Wt++)x[32767+Wt]=Ft,b[32767+Wt]=[],b[32767+Wt][1]=Ft,b[32767+Wt][0]=vt-1+Wt;it<<=1,vt<<=1}}(),function(){for(var it=0;it<256;it++)pt[it]=19595*it,pt[it+256>>0]=38470*it,pt[it+512>>0]=7471*it+32768,pt[it+768>>0]=-11059*it,pt[it+1024>>0]=-21709*it,pt[it+1280>>0]=32768*it+8421375,pt[it+1536>>0]=-27439*it,pt[it+1792>>0]=-5329*it}(),we(r)}/**
* @license
* Copyright (c) 2017 Aras Abbasi
*
* Licensed under the MIT License.
* http://opensource.org/licenses/mit-license
*/function Kc(r,t){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function XF(r){function t(dt){if(!dt)throw Error("assert :P")}function e(dt,Rt,Lt){for(var st=0;4>st;st++)if(dt[Rt+st]!=Lt.charCodeAt(st))return!0;return!1}function n(dt,Rt,Lt,st,ct){for(var wt=0;wt<ct;wt++)dt[Rt+wt]=Lt[st+wt]}function i(dt,Rt,Lt,st){for(var ct=0;ct<st;ct++)dt[Rt+ct]=Lt}function s(dt){return new Int32Array(dt)}function a(dt,Rt){for(var Lt=[],st=0;st<dt;st++)Lt.push(new Rt);return Lt}function o(dt,Rt){var Lt=[];return function st(ct,wt,yt){for(var te=yt[wt],Zt=0;Zt<te&&(ct.push(yt.length>wt+1?[]:new Rt),!(yt.length<wt+1));Zt++)st(ct[Zt],wt+1,yt)}(Lt,0,dt),Lt}var A=function(){var dt=this;function Rt(g,w){for(var T=1<<w-1>>>0;g&T;)T>>>=1;return T?(g&T-1)+T:g}function Lt(g,w,T,L,D){t(!(L%T));do g[w+(L-=T)]=D;while(0<L)}function st(g,w,T,L,D){if(t(2328>=D),512>=D)var H=s(512);else if((H=s(D))==null)return 0;return function(z,j,V,$,lt,rt){var ht,gt,Pt=j,Tt=1<<V,_t=s(16),bt=s(16);for(t(lt!=0),t($!=null),t(z!=null),t(0<V),gt=0;gt<lt;++gt){if(15<$[gt])return 0;++_t[$[gt]]}if(_t[0]==lt)return 0;for(bt[1]=0,ht=1;15>ht;++ht){if(_t[ht]>1<<ht)return 0;bt[ht+1]=bt[ht]+_t[ht]}for(gt=0;gt<lt;++gt)ht=$[gt],0<$[gt]&&(rt[bt[ht]++]=gt);if(bt[15]==1)return($=new ct).g=0,$.value=rt[0],Lt(z,Pt,1,Tt,$),Tt;var Gt,$t=-1,ue=Tt-1,Ae=0,ye=1,Re=1,Ce=1<<V;for(gt=0,ht=1,lt=2;ht<=V;++ht,lt<<=1){if(ye+=Re<<=1,0>(Re-=_t[ht]))return 0;for(;0<_t[ht];--_t[ht])($=new ct).g=ht,$.value=rt[gt++],Lt(z,Pt+Ae,lt,Ce,$),Ae=Rt(Ae,ht)}for(ht=V+1,lt=2;15>=ht;++ht,lt<<=1){if(ye+=Re<<=1,0>(Re-=_t[ht]))return 0;for(;0<_t[ht];--_t[ht]){if($=new ct,(Ae&ue)!=$t){for(Pt+=Ce,Gt=1<<($t=ht)-V;15>$t&&!(0>=(Gt-=_t[$t]));)++$t,Gt<<=1;Tt+=Ce=1<<(Gt=$t-V),z[j+($t=Ae&ue)].g=Gt+V,z[j+$t].value=Pt-j-$t}$.g=ht-V,$.value=rt[gt++],Lt(z,Pt+(Ae>>V),lt,Ce,$),Ae=Rt(Ae,ht)}}return ye!=2*bt[15]-1?0:Tt}(g,w,T,L,D,H)}function ct(){this.value=this.g=0}function wt(){this.value=this.g=0}function yt(){this.G=a(5,ct),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(as,wt)}function te(g,w,T,L){t(g!=null),t(w!=null),t(2147483648>L),g.Ca=254,g.I=0,g.b=-8,g.Ka=0,g.oa=w,g.pa=T,g.Jd=w,g.Yc=T+L,g.Zc=4<=L?T+L-4+1:T,jt(g)}function Zt(g,w){for(var T=0;0<w--;)T|=ie(g,128)<<w;return T}function re(g,w){var T=Zt(g,w);return ae(g)?-T:T}function Xt(g,w,T,L){var D,H=0;for(t(g!=null),t(w!=null),t(4294967288>L),g.Sb=L,g.Ra=0,g.u=0,g.h=0,4<L&&(L=4),D=0;D<L;++D)H+=w[T+D]<<8*D;g.Ra=H,g.bb=L,g.oa=w,g.pa=T}function ne(g){for(;8<=g.u&&g.bb<g.Sb;)g.Ra>>>=8,g.Ra+=g.oa[g.pa+g.bb]<<gl-8>>>0,++g.bb,g.u-=8;Ft(g)&&(g.h=1,g.u=0)}function se(g,w){if(t(0<=w),!g.h&&w<=pl){var T=vt(g)&Bc[w];return g.u+=w,ne(g),T}return g.h=1,g.u=0}function we(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function it(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function vt(g){return g.Ra>>>(g.u&gl-1)>>>0}function Ft(g){return t(g.bb<=g.Sb),g.h||g.bb==g.Sb&&g.u>gl}function Ot(g,w){g.u=w,g.h=Ft(g)}function Wt(g){g.u>=Cc&&(t(g.u>=Cc),ne(g))}function jt(g){t(g!=null&&g.oa!=null),g.pa<g.Zc?(g.I=(g.oa[g.pa++]|g.I<<8)>>>0,g.b+=8):(t(g!=null&&g.oa!=null),g.pa<g.Yc?(g.b+=8,g.I=g.oa[g.pa++]|g.I<<8):g.Ka?g.b=0:(g.I<<=8,g.b+=8,g.Ka=1))}function ae(g){return Zt(g,1)}function ie(g,w){var T=g.Ca;0>g.b&&jt(g);var L=g.b,D=T*w>>>8,H=(g.I>>>L>D)+0;for(H?(T-=D,g.I-=D+1<<L>>>0):T=D+1,L=T,D=0;256<=L;)D+=8,L>>=8;return L=7^D+_s[L],g.b-=L,g.Ca=(T<<L)-1,H}function Be(g,w,T){g[w+0]=T>>24&255,g[w+1]=T>>16&255,g[w+2]=T>>8&255,g[w+3]=T>>0&255}function Te(g,w){return g[w+0]<<0|g[w+1]<<8}function Ne(g,w){return Te(g,w)|g[w+2]<<16}function Qe(g,w){return Te(g,w)|Te(g,w+2)<<16}function He(g,w){var T=1<<w;return t(g!=null),t(0<w),g.X=s(T),g.X==null?0:(g.Mb=32-w,g.Xa=w,1)}function ge(g,w){t(g!=null),t(w!=null),t(g.Xa==w.Xa),n(w.X,0,g.X,0,1<<w.Xa)}function Ut(){this.X=[],this.Xa=this.Mb=0}function Yt(g,w,T,L){t(T!=null),t(L!=null);var D=T[0],H=L[0];return D==0&&(D=(g*H+w/2)/w),H==0&&(H=(w*D+g/2)/g),0>=D||0>=H?0:(T[0]=D,L[0]=H,1)}function tr(g,w){return g+(1<<w)-1>>>w}function Ee(g,w){return((4278255360&g)+(4278255360&w)>>>0&4278255360)+((16711935&g)+(16711935&w)>>>0&16711935)>>>0}function _e(g,w){dt[w]=function(T,L,D,H,z,j,V){var $;for($=0;$<z;++$){var lt=dt[g](j[V+$-1],D,H+$);j[V+$]=Ee(T[L+$],lt)}}}function xe(){this.ud=this.hd=this.jd=0}function De(g,w){return((4278124286&(g^w))>>>1)+(g&w)>>>0}function nr(g){return 0<=g&&256>g?g:0>g?0:255<g?255:void 0}function ur(g,w){return nr(g+(g-w+.5>>1))}function Ir(g,w,T){return Math.abs(w-T)-Math.abs(g-T)}function Sr(g,w,T,L,D,H,z){for(L=H[z-1],T=0;T<D;++T)H[z+T]=L=Ee(g[w+T],L)}function Dr(g,w,T,L,D){var H;for(H=0;H<T;++H){var z=g[w+H],j=z>>8&255,V=16711935&(V=(V=16711935&z)+((j<<16)+j));L[D+H]=(4278255360&z)+V>>>0}}function Nr(g,w){w.jd=g>>0&255,w.hd=g>>8&255,w.ud=g>>16&255}function fe(g,w,T,L,D,H){var z;for(z=0;z<L;++z){var j=w[T+z],V=j>>>8,$=j,lt=255&(lt=(lt=j>>>16)+((g.jd<<24>>24)*(V<<24>>24)>>>5));$=255&($=($=$+((g.hd<<24>>24)*(V<<24>>24)>>>5))+((g.ud<<24>>24)*(lt<<24>>24)>>>5)),D[H+z]=(4278255360&j)+(lt<<16)+$}}function Tr(g,w,T,L,D){dt[w]=function(H,z,j,V,$,lt,rt,ht,gt){for(V=rt;V<ht;++V)for(rt=0;rt<gt;++rt)$[lt++]=D(j[L(H[z++])])},dt[g]=function(H,z,j,V,$,lt,rt){var ht=8>>H.b,gt=H.Ea,Pt=H.K[0],Tt=H.w;if(8>ht)for(H=(1<<H.b)-1,Tt=(1<<ht)-1;z<j;++z){var _t,bt=0;for(_t=0;_t<gt;++_t)_t&H||(bt=L(V[$++])),lt[rt++]=D(Pt[bt&Tt]),bt>>=ht}else dt["VP8LMapColor"+T](V,$,Pt,Tt,lt,rt,z,j,gt)}}function Oe(g,w,T,L,D){for(T=w+T;w<T;){var H=g[w++];L[D++]=H>>16&255,L[D++]=H>>8&255,L[D++]=H>>0&255}}function wn(g,w,T,L,D){for(T=w+T;w<T;){var H=g[w++];L[D++]=H>>16&255,L[D++]=H>>8&255,L[D++]=H>>0&255,L[D++]=H>>24&255}}function Fr(g,w,T,L,D){for(T=w+T;w<T;){var H=(z=g[w++])>>16&240|z>>12&15,z=z>>0&240|z>>28&15;L[D++]=H,L[D++]=z}}function Se(g,w,T,L,D){for(T=w+T;w<T;){var H=(z=g[w++])>>16&248|z>>13&7,z=z>>5&224|z>>3&31;L[D++]=H,L[D++]=z}}function Xe(g,w,T,L,D){for(T=w+T;w<T;){var H=g[w++];L[D++]=H>>0&255,L[D++]=H>>8&255,L[D++]=H>>16&255}}function qe(g,w,T,L,D,H){if(H==0)for(T=w+T;w<T;)Be(L,((H=g[w++])[0]>>24|H[1]>>8&65280|H[2]<<8&16711680|H[3]<<24)>>>0),D+=32;else n(L,D,g,w,T)}function Yr(g,w){dt[w][0]=dt[g+"0"],dt[w][1]=dt[g+"1"],dt[w][2]=dt[g+"2"],dt[w][3]=dt[g+"3"],dt[w][4]=dt[g+"4"],dt[w][5]=dt[g+"5"],dt[w][6]=dt[g+"6"],dt[w][7]=dt[g+"7"],dt[w][8]=dt[g+"8"],dt[w][9]=dt[g+"9"],dt[w][10]=dt[g+"10"],dt[w][11]=dt[g+"11"],dt[w][12]=dt[g+"12"],dt[w][13]=dt[g+"13"],dt[w][14]=dt[g+"0"],dt[w][15]=dt[g+"0"]}function Rr(g){return g==Hn||g==bl||g==wl||g==nA}function pr(){this.eb=[],this.size=this.A=this.fb=0}function on(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Kr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new pr,this.f.kb=new on,this.sd=null}function Ct(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Z(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function J(g){return alert("todo:WebPSamplerProcessPlane"),g.T}function ot(g,w){var T=g.T,L=w.ba.f.RGBA,D=L.eb,H=L.fb+g.ka*L.A,z=Cs[w.ba.S],j=g.y,V=g.O,$=g.f,lt=g.N,rt=g.ea,ht=g.W,gt=w.cc,Pt=w.dc,Tt=w.Mc,_t=w.Nc,bt=g.ka,Gt=g.ka+g.T,$t=g.U,ue=$t+1>>1;for(bt==0?z(j,V,null,null,$,lt,rt,ht,$,lt,rt,ht,D,H,null,null,$t):(z(w.ec,w.fc,j,V,gt,Pt,Tt,_t,$,lt,rt,ht,D,H-L.A,D,H,$t),++T);bt+2<Gt;bt+=2)gt=$,Pt=lt,Tt=rt,_t=ht,lt+=g.Rc,ht+=g.Rc,H+=2*L.A,z(j,(V+=2*g.fa)-g.fa,j,V,gt,Pt,Tt,_t,$,lt,rt,ht,D,H-L.A,D,H,$t);return V+=g.fa,g.j+Gt<g.o?(n(w.ec,w.fc,j,V,$t),n(w.cc,w.dc,$,lt,ue),n(w.Mc,w.Nc,rt,ht,ue),T--):1&Gt||z(j,V,null,null,$,lt,rt,ht,$,lt,rt,ht,D,H+L.A,null,null,$t),T}function Et(g,w,T){var L=g.F,D=[g.J];if(L!=null){var H=g.U,z=w.ba.S,j=z==rA||z==wl;w=w.ba.f.RGBA;var V=[0],$=g.ka;V[0]=g.T,g.Kb&&($==0?--V[0]:(--$,D[0]-=g.width),g.j+g.ka+g.T==g.o&&(V[0]=g.o-g.j-$));var lt=w.eb;$=w.fb+$*w.A,g=qa(L,D[0],g.width,H,V,lt,$+(j?0:3),w.A),t(T==V),g&&Rr(z)&&wa(lt,$,j,H,V,w.A)}return 0}function Nt(g){var w=g.ma,T=w.ba.S,L=11>T,D=T==_l||T==vl||T==rA||T==dd||T==12||Rr(T);if(w.memory=null,w.Ib=null,w.Jb=null,w.Nd=null,!xc(w.Oa,g,D?11:12))return 0;if(D&&Rr(T)&&Me(),g.da)alert("todo:use_scaling");else{if(L){if(w.Ib=J,g.Kb){if(T=g.U+1>>1,w.memory=s(g.U+2*T),w.memory==null)return 0;w.ec=w.memory,w.fc=0,w.cc=w.ec,w.dc=w.fc+g.U,w.Mc=w.cc,w.Nc=w.dc+T,w.Ib=ot,Me()}}else alert("todo:EmitYUV");D&&(w.Jb=Et,L&&oe())}if(L&&!sh){for(g=0;256>g;++g)vd[g]=89858*(g-128)+Wa>>Bl,B[g]=-22014*(g-128)+Wa,ap[g]=-45773*(g-128),oh[g]=113618*(g-128)+Wa>>Bl;for(g=ta;g<du;++g)w=76283*(g-16)+Wa>>Bl,l[g-ta]=ks(w,255),d[g-ta]=ks(w+8>>4,15);sh=1}return 1}function zt(g){var w=g.ma,T=g.U,L=g.T;return t(!(1&g.ka)),0>=T||0>=L?0:(T=w.Ib(g,w),w.Jb!=null&&w.Jb(g,w,T),w.Dc+=T,1)}function qt(g){g.ma.memory=null}function St(g,w,T,L){return se(g,8)!=47?0:(w[0]=se(g,14)+1,T[0]=se(g,14)+1,L[0]=se(g,1),se(g,3)!=0?0:!g.h)}function Jt(g,w){if(4>g)return g+1;var T=g-2>>1;return(2+(1&g)<<T)+se(w,T)+1}function me(g,w){return 120<w?w-120:1<=(T=((T=hr[w-1])>>4)*g+(8-(15&T)))?T:1;var T}function pe(g,w,T){var L=vt(T),D=g[w+=255&L].g-8;return 0<D&&(Ot(T,T.u+8),L=vt(T),w+=g[w].value,w+=L&(1<<D)-1),Ot(T,T.u+g[w].g),g[w].value}function de(g,w,T){return T.g+=g.g,T.value+=g.value<<w>>>0,t(8>=T.g),g.g}function Ge(g,w,T){var L=g.xc;return t((w=L==0?0:g.vc[g.md*(T>>L)+(w>>L)])<g.Wb),g.Ya[w]}function Ye(g,w,T,L){var D=g.ab,H=g.c*w,z=g.C;w=z+w;var j=T,V=L;for(L=g.Ta,T=g.Ua;0<D--;){var $=g.gc[D],lt=z,rt=w,ht=j,gt=V,Pt=(V=L,j=T,$.Ea);switch(t(lt<rt),t(rt<=$.nc),$.hc){case 2:Wn(ht,gt,(rt-lt)*Pt,V,j);break;case 0:var Tt=lt,_t=rt,bt=V,Gt=j,$t=(Ce=$).Ea;Tt==0&&(hd(ht,gt,null,null,1,bt,Gt),Sr(ht,gt+1,0,0,$t-1,bt,Gt+1),gt+=$t,Gt+=$t,++Tt);for(var ue=1<<Ce.b,Ae=ue-1,ye=tr($t,Ce.b),Re=Ce.K,Ce=Ce.w+(Tt>>Ce.b)*ye;Tt<_t;){var We=Re,rr=Ce,er=1;for(cu(ht,gt,bt,Gt-$t,1,bt,Gt);er<$t;){var Er=(er&~Ae)+ue;Er>$t&&(Er=$t),(0,Ga[We[rr++]>>8&15])(ht,gt+ +er,bt,Gt+er-$t,Er-er,bt,Gt+er),er=Er}gt+=$t,Gt+=$t,++Tt&Ae||(Ce+=ye)}rt!=$.nc&&n(V,j-Pt,V,j+(rt-lt-1)*Pt,Pt);break;case 1:for(Pt=ht,_t=gt,$t=(ht=$.Ea)-(Gt=ht&~(bt=(gt=1<<$.b)-1)),Tt=tr(ht,$.b),ue=$.K,$=$.w+(lt>>$.b)*Tt;lt<rt;){for(Ae=ue,ye=$,Re=new xe,Ce=_t+Gt,We=_t+ht;_t<Ce;)Nr(Ae[ye++],Re),Ri(Re,Pt,_t,gt,V,j),_t+=gt,j+=gt;_t<We&&(Nr(Ae[ye++],Re),Ri(Re,Pt,_t,$t,V,j),_t+=$t,j+=$t),++lt&bt||($+=Tt)}break;case 3:if(ht==V&&gt==j&&0<$.b){for(_t=V,ht=Pt=j+(rt-lt)*Pt-(Gt=(rt-lt)*tr($.Ea,$.b)),gt=V,bt=j,Tt=[],Gt=($t=Gt)-1;0<=Gt;--Gt)Tt[Gt]=gt[bt+Gt];for(Gt=$t-1;0<=Gt;--Gt)_t[ht+Gt]=Tt[Gt];Vi($,lt,rt,V,Pt,V,j)}else Vi($,lt,rt,ht,gt,V,j)}j=L,V=T}V!=T&&n(L,T,j,V,H)}function Cr(g,w){var T=g.V,L=g.Ba+g.c*g.C,D=w-g.C;if(t(w<=g.l.o),t(16>=D),0<D){var H=g.l,z=g.Ta,j=g.Ua,V=H.width;if(Ye(g,D,T,L),D=j=[j],t((T=g.C)<(L=w)),t(H.v<H.va),L>H.o&&(L=H.o),T<H.j){var $=H.j-T;T=H.j,D[0]+=$*V}if(T>=L?T=0:(D[0]+=4*H.v,H.ka=T-H.j,H.U=H.va-H.v,H.T=L-T,T=1),T){if(j=j[0],11>(T=g.ca).S){var lt=T.f.RGBA,rt=(L=T.S,D=H.U,H=H.T,$=lt.eb,lt.A),ht=H;for(lt=lt.fb+g.Ma*lt.A;0<ht--;){var gt=z,Pt=j,Tt=D,_t=$,bt=lt;switch(L){case eA:ji(gt,Pt,Tt,_t,bt);break;case _l:Js(gt,Pt,Tt,_t,bt);break;case Hn:Js(gt,Pt,Tt,_t,bt),wa(_t,bt,0,Tt,1,0);break;case rh:Ec(gt,Pt,Tt,_t,bt);break;case vl:qe(gt,Pt,Tt,_t,bt,1);break;case bl:qe(gt,Pt,Tt,_t,bt,1),wa(_t,bt,0,Tt,1,0);break;case rA:qe(gt,Pt,Tt,_t,bt,0);break;case wl:qe(gt,Pt,Tt,_t,bt,0),wa(_t,bt,1,Tt,1,0);break;case dd:vo(gt,Pt,Tt,_t,bt);break;case nA:vo(gt,Pt,Tt,_t,bt),uu(_t,bt,Tt,1,0);break;case Ka:bo(gt,Pt,Tt,_t,bt);break;default:t(0)}j+=V,lt+=rt}g.Ma+=H}else alert("todo:EmitRescaledRowsYUVA");t(g.Ma<=T.height)}}g.C=w,t(g.C<=g.i)}function cr(g){var w;if(0<g.ua)return 0;for(w=0;w<g.Wb;++w){var T=g.Ya[w].G,L=g.Ya[w].H;if(0<T[1][L[1]+0].g||0<T[2][L[2]+0].g||0<T[3][L[3]+0].g)return 0}return 1}function Pr(g,w,T,L,D,H){if(g.Z!=0){var z=g.qd,j=g.rd;for(t(Bo[g.Z]!=null);w<T;++w)Bo[g.Z](z,j,L,D,L,D,H),z=L,j=D,D+=H;g.qd=z,g.rd=j}}function kr(g,w){var T=g.l.ma,L=T.Z==0||T.Z==1?g.l.j:g.C;if(L=g.C<L?L:g.C,t(w<=g.l.o),w>L){var D=g.l.width,H=T.ca,z=T.tb+D*L,j=g.V,V=g.Ba+g.c*L,$=g.gc;t(g.ab==1),t($[0].hc==3),Zu($[0],L,w,j,V,H,z),Pr(T,L,w,H,z,D)}g.C=g.Ma=w}function Qr(g,w,T,L,D,H,z){var j=g.$/L,V=g.$%L,$=g.m,lt=g.s,rt=T+g.$,ht=rt;D=T+L*D;var gt=T+L*H,Pt=280+lt.ua,Tt=g.Pb?j:16777216,_t=0<lt.ua?lt.Wa:null,bt=lt.wc,Gt=rt<gt?Ge(lt,V,j):null;t(g.C<H),t(gt<=D);var $t=!1;t:for(;;){for(;$t||rt<gt;){var ue=0;if(j>=Tt){var Ae=rt-T;t((Tt=g).Pb),Tt.wd=Tt.m,Tt.xd=Ae,0<Tt.s.ua&&ge(Tt.s.Wa,Tt.s.vb),Tt=j+nh}if(V&bt||(Gt=Ge(lt,V,j)),t(Gt!=null),Gt.Qb&&(w[rt]=Gt.qb,$t=!0),!$t)if(Wt($),Gt.jc){ue=$,Ae=w;var ye=rt,Re=Gt.pd[vt(ue)&as-1];t(Gt.jc),256>Re.g?(Ot(ue,ue.u+Re.g),Ae[ye]=Re.value,ue=0):(Ot(ue,ue.u+Re.g-256),t(256<=Re.value),ue=Re.value),ue==0&&($t=!0)}else ue=pe(Gt.G[0],Gt.H[0],$);if($.h)break;if($t||256>ue){if(!$t)if(Gt.nd)w[rt]=(Gt.qb|ue<<8)>>>0;else{if(Wt($),$t=pe(Gt.G[1],Gt.H[1],$),Wt($),Ae=pe(Gt.G[2],Gt.H[2],$),ye=pe(Gt.G[3],Gt.H[3],$),$.h)break;w[rt]=(ye<<24|$t<<16|ue<<8|Ae)>>>0}if($t=!1,++rt,++V>=L&&(V=0,++j,z!=null&&j<=H&&!(j%16)&&z(g,j),_t!=null))for(;ht<rt;)ue=w[ht++],_t.X[(506832829*ue&4294967295)>>>_t.Mb]=ue}else if(280>ue){if(ue=Jt(ue-256,$),Ae=pe(Gt.G[4],Gt.H[4],$),Wt($),Ae=me(L,Ae=Jt(Ae,$)),$.h)break;if(rt-T<Ae||D-rt<ue)break t;for(ye=0;ye<ue;++ye)w[rt+ye]=w[rt+ye-Ae];for(rt+=ue,V+=ue;V>=L;)V-=L,++j,z!=null&&j<=H&&!(j%16)&&z(g,j);if(t(rt<=D),V&bt&&(Gt=Ge(lt,V,j)),_t!=null)for(;ht<rt;)ue=w[ht++],_t.X[(506832829*ue&4294967295)>>>_t.Mb]=ue}else{if(!(ue<Pt))break t;for($t=ue-280,t(_t!=null);ht<rt;)ue=w[ht++],_t.X[(506832829*ue&4294967295)>>>_t.Mb]=ue;ue=rt,t(!($t>>>(Ae=_t).Xa)),w[ue]=Ae.X[$t],$t=!0}$t||t($.h==Ft($))}if(g.Pb&&$.h&&rt<D)t(g.m.h),g.a=5,g.m=g.wd,g.$=g.xd,0<g.s.ua&&ge(g.s.vb,g.s.Wa);else{if($.h)break t;z!=null&&z(g,j>H?H:j),g.a=0,g.$=rt-T}return 1}return g.a=3,0}function gn(g){t(g!=null),g.vc=null,g.yc=null,g.Ya=null;var w=g.Wa;w!=null&&(w.X=null),g.vb=null,t(g!=null)}function gr(){var g=new Ju;return g==null?null:(g.a=0,g.xb=ih,Yr("Predictor","VP8LPredictors"),Yr("Predictor","VP8LPredictors_C"),Yr("PredictorAdd","VP8LPredictorsAdd"),Yr("PredictorAdd","VP8LPredictorsAdd_C"),Wn=Dr,Ri=fe,ji=Oe,Js=wn,vo=Fr,bo=Se,Ec=Xe,dt.VP8LMapColor32b=Ui,dt.VP8LMapColor8b=lu,g)}function Wr(g,w,T,L,D){var H=1,z=[g],j=[w],V=L.m,$=L.s,lt=null,rt=0;t:for(;;){if(T)for(;H&&se(V,1);){var ht=z,gt=j,Pt=L,Tt=1,_t=Pt.m,bt=Pt.gc[Pt.ab],Gt=se(_t,2);if(Pt.Oc&1<<Gt)H=0;else{switch(Pt.Oc|=1<<Gt,bt.hc=Gt,bt.Ea=ht[0],bt.nc=gt[0],bt.K=[null],++Pt.ab,t(4>=Pt.ab),Gt){case 0:case 1:bt.b=se(_t,3)+2,Tt=Wr(tr(bt.Ea,bt.b),tr(bt.nc,bt.b),0,Pt,bt.K),bt.K=bt.K[0];break;case 3:var $t,ue=se(_t,8)+1,Ae=16<ue?0:4<ue?1:2<ue?2:3;if(ht[0]=tr(bt.Ea,Ae),bt.b=Ae,$t=Tt=Wr(ue,1,0,Pt,bt.K)){var ye,Re=ue,Ce=bt,We=1<<(8>>Ce.b),rr=s(We);if(rr==null)$t=0;else{var er=Ce.K[0],Er=Ce.w;for(rr[0]=Ce.K[0][0],ye=1;ye<1*Re;++ye)rr[ye]=Ee(er[Er+ye],rr[ye-1]);for(;ye<4*We;++ye)rr[ye]=0;Ce.K[0]=null,Ce.K[0]=rr,$t=1}}Tt=$t;break;case 2:break;default:t(0)}H=Tt}}if(z=z[0],j=j[0],H&&se(V,1)&&!(H=1<=(rt=se(V,4))&&11>=rt)){L.a=3;break t}var Lr;if(Lr=H)e:{var Zr,wr,Xr,Bn=L,Cn=z,hi=j,hn=rt,cs=T,Ii=Bn.m,zn=Bn.s,dn=[null],sn=1,fn=0,Ei=br[hn];r:for(;;){if(cs&&se(Ii,1)){var ln=se(Ii,3)+2,En=tr(Cn,ln),Wi=tr(hi,ln),ti=En*Wi;if(!Wr(En,Wi,0,Bn,dn))break r;for(dn=dn[0],zn.xc=ln,Zr=0;Zr<ti;++Zr){var Un=dn[Zr]>>8&65535;dn[Zr]=Un,Un>=sn&&(sn=Un+1)}}if(Ii.h)break r;for(wr=0;5>wr;++wr){var si=fd[wr];!wr&&0<hn&&(si+=1<<hn),fn<si&&(fn=si)}var ah=a(sn*Ei,ct),Tc=sn,Ic=a(Tc,yt);if(Ic==null)var El=null;else t(65536>=Tc),El=Ic;var Co=s(fn);if(El==null||Co==null||ah==null){Bn.a=1;break r}var fu=ah;for(Zr=Xr=0;Zr<sn;++Zr){var Eo=El[Zr],Lc=Eo.G,Fc=Eo.H,AA=0,pu=1,cp=0;for(wr=0;5>wr;++wr){si=fd[wr],Lc[wr]=fu,Fc[wr]=Xr,!wr&&0<hn&&(si+=1<<hn);i:{var bd,lp=si,Sl=Bn,wd=Co,xd=fu,up=Xr,ch=0,Tl=Sl.m,y_=se(Tl,1);if(i(wd,0,0,lp),y_){var rE=se(Tl,1)+1,Hs=se(Tl,1),hA=se(Tl,Hs==0?1:8);wd[hA]=1,rE==2&&(wd[hA=se(Tl,8)]=1);var lh=1}else{var vm=s(19),uh=se(Tl,4)+4;if(19<uh){Sl.a=3;var Ap=0;break i}for(bd=0;bd<uh;++bd)vm[iA[bd]]=se(Tl,3);var Ah=void 0,Bd=void 0,bm=Sl,__=vm,Cd=lp,v_=wd,Ed=0,Il=bm.m,hp=8,hh=a(128,ct);n:for(;st(hh,0,7,__,19);){if(se(Il,1)){var ea=2+2*se(Il,3);if((Ah=2+se(Il,ea))>Cd)break n}else Ah=Cd;for(Bd=0;Bd<Cd&&Ah--;){Wt(Il);var wm=hh[0+(127&vt(Il))];Ot(Il,Il.u+wm.g);var dh=wm.value;if(16>dh)v_[Bd++]=dh,dh!=0&&(hp=dh);else{var b_=dh==16,w_=dh-16,nE=sp[w_],x_=se(Il,ip[w_])+nE;if(Bd+x_>Cd)break n;for(var iE=b_?hp:0;0<x_--;)v_[Bd++]=iE}}Ed=1;break n}Ed||(bm.a=3),lh=Ed}(lh=lh&&!Tl.h)&&(ch=st(xd,up,8,wd,lp)),lh&&ch!=0?Ap=ch:(Sl.a=3,Ap=0)}if(Ap==0)break r;if(pu&&Yo[wr]==1&&(pu=fu[Xr].g==0),AA+=fu[Xr].g,Xr+=Ap,3>=wr){var dA,fh=Co[0];for(dA=1;dA<si;++dA)Co[dA]>fh&&(fh=Co[dA]);cp+=fh}}if(Eo.nd=pu,Eo.Qb=0,pu&&(Eo.qb=(Lc[3][Fc[3]+0].value<<24|Lc[1][Fc[1]+0].value<<16|Lc[2][Fc[2]+0].value)>>>0,AA==0&&256>Lc[0][Fc[0]+0].value&&(Eo.Qb=1,Eo.qb+=Lc[0][Fc[0]+0].value<<8)),Eo.jc=!Eo.Qb&&6>cp,Eo.jc){var Sd,eo=Eo;for(Sd=0;Sd<as;++Sd){var Ba=Sd,gu=eo.pd[Ba],dp=eo.G[0][eo.H[0]+Ba];256<=dp.value?(gu.g=dp.g+256,gu.value=dp.value):(gu.g=0,gu.value=0,Ba>>=de(dp,8,gu),Ba>>=de(eo.G[1][eo.H[1]+Ba],16,gu),Ba>>=de(eo.G[2][eo.H[2]+Ba],0,gu),de(eo.G[3][eo.H[3]+Ba],24,gu))}}}zn.vc=dn,zn.Wb=sn,zn.Ya=El,zn.yc=ah,Lr=1;break e}Lr=0}if(!(H=Lr)){L.a=3;break t}if(0<rt){if($.ua=1<<rt,!He($.Wa,rt)){L.a=1,H=0;break t}}else $.ua=0;var xm=L,B_=z,sE=j,Bm=xm.s,Cm=Bm.xc;if(xm.c=B_,xm.i=sE,Bm.md=tr(B_,Cm),Bm.wc=Cm==0?-1:(1<<Cm)-1,T){L.xb=md;break t}if((lt=s(z*j))==null){L.a=1,H=0;break t}H=(H=Qr(L,lt,0,z,j,j,null))&&!V.h;break t}return H?(D!=null?D[0]=lt:(t(lt==null),t(T)),L.$=0,T||gn($)):gn($),H}function vn(g,w){var T=g.c*g.i,L=T+w+16*w;return t(g.c<=w),g.V=s(L),g.V==null?(g.Ta=null,g.Ua=0,g.a=1,0):(g.Ta=g.V,g.Ua=g.Ba+T+w,1)}function Dn(g,w){var T=g.C,L=w-T,D=g.V,H=g.Ba+g.c*T;for(t(w<=g.l.o);0<L;){var z=16<L?16:L,j=g.l.ma,V=g.l.width,$=V*z,lt=j.ca,rt=j.tb+V*T,ht=g.Ta,gt=g.Ua;Ye(g,z,D,H),Au(ht,gt,lt,rt,$),Pr(j,T,T+z,lt,rt,V),L-=z,D+=z*g.c,T+=z}t(T==w),g.C=g.Ma=w}function Dt(){this.ub=this.yd=this.td=this.Rb=0}function Ue(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ie(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function rn(){this.Yb=function(){var g=[];return function w(T,L,D){for(var H=D[L],z=0;z<H&&(T.push(D.length>L+1?[]:0),!(D.length<L+1));z++)w(T[z],L+1,D)}(g,0,[3,11]),g}()}function Mn(){this.jb=s(3),this.Wc=o([4,8],rn),this.Xc=o([4,17],rn)}function xr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function mn(){this.ld=this.La=this.dd=this.tc=0}function bi(){this.Na=this.la=0}function yn(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function nn(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function wi(){this.uc=this.M=this.Nb=0,this.wa=Array(new mn),this.Y=0,this.ya=Array(new nn),this.aa=0,this.l=new Rs}function Xn(){this.y=s(16),this.f=s(8),this.ea=s(8)}function os(){this.cb=this.a=0,this.sc="",this.m=new we,this.Od=new Dt,this.Kc=new Ue,this.ed=new xr,this.Qa=new Ie,this.Ic=this.$c=this.Aa=0,this.D=new wi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,we),this.ia=0,this.pb=a(4,yn),this.Pa=new Mn,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Xn),this.Hd=0,this.rb=Array(new bi),this.sb=0,this.wa=Array(new mn),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new nn),this.L=this.aa=0,this.gd=o([4,2],mn),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Rs(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ho(){var g=new os;return g!=null&&(g.a=0,g.sc="OK",g.cb=0,g.Xb=0,Ki||(Ki=Tn)),g}function Or(g,w,T){return g.a==0&&(g.a=w,g.sc=T,g.cb=0),0}function Xs(g,w,T){return 3<=T&&g[w+0]==157&&g[w+1]==1&&g[w+2]==42}function Bs(g,w){if(g==null)return 0;if(g.a=0,g.sc="OK",w==null)return Or(g,2,"null VP8Io passed to VP8GetHeaders()");var T=w.data,L=w.w,D=w.ha;if(4>D)return Or(g,7,"Truncated header.");var H=T[L+0]|T[L+1]<<8|T[L+2]<<16,z=g.Od;if(z.Rb=!(1&H),z.td=H>>1&7,z.yd=H>>4&1,z.ub=H>>5,3<z.td)return Or(g,3,"Incorrect keyframe parameters.");if(!z.yd)return Or(g,4,"Frame not displayable.");L+=3,D-=3;var j=g.Kc;if(z.Rb){if(7>D)return Or(g,7,"cannot parse picture header");if(!Xs(T,L,D))return Or(g,3,"Bad code word");j.c=16383&(T[L+4]<<8|T[L+3]),j.Td=T[L+4]>>6,j.i=16383&(T[L+6]<<8|T[L+5]),j.Ud=T[L+6]>>6,L+=7,D-=7,g.za=j.c+15>>4,g.Ub=j.i+15>>4,w.width=j.c,w.height=j.i,w.Da=0,w.j=0,w.v=0,w.va=w.width,w.o=w.height,w.da=0,w.ib=w.width,w.hb=w.height,w.U=w.width,w.T=w.height,i((H=g.Pa).jb,0,255,H.jb.length),t((H=g.Qa)!=null),H.Cb=0,H.Bb=0,H.Fb=1,i(H.Zb,0,0,H.Zb.length),i(H.Lb,0,0,H.Lb)}if(z.ub>D)return Or(g,7,"bad partition length");te(H=g.m,T,L,z.ub),L+=z.ub,D-=z.ub,z.Rb&&(j.Ld=ae(H),j.Kd=ae(H)),j=g.Qa;var V,$=g.Pa;if(t(H!=null),t(j!=null),j.Cb=ae(H),j.Cb){if(j.Bb=ae(H),ae(H)){for(j.Fb=ae(H),V=0;4>V;++V)j.Zb[V]=ae(H)?re(H,7):0;for(V=0;4>V;++V)j.Lb[V]=ae(H)?re(H,6):0}if(j.Bb)for(V=0;3>V;++V)$.jb[V]=ae(H)?Zt(H,8):255}else j.Bb=0;if(H.Ka)return Or(g,3,"cannot parse segment header");if((j=g.ed).zd=ae(H),j.Tb=Zt(H,6),j.wb=Zt(H,3),j.Pc=ae(H),j.Pc&&ae(H)){for($=0;4>$;++$)ae(H)&&(j.vd[$]=re(H,6));for($=0;4>$;++$)ae(H)&&(j.od[$]=re(H,6))}if(g.L=j.Tb==0?0:j.zd?1:2,H.Ka)return Or(g,3,"cannot parse filter header");var lt=D;if(D=V=L,L=V+lt,j=lt,g.Xb=(1<<Zt(g.m,2))-1,lt<3*($=g.Xb))T=7;else{for(V+=3*$,j-=3*$,lt=0;lt<$;++lt){var rt=T[D+0]|T[D+1]<<8|T[D+2]<<16;rt>j&&(rt=j),te(g.Jc[+lt],T,V,rt),V+=rt,j-=rt,D+=3}te(g.Jc[+$],T,V,j),T=V<L?0:5}if(T!=0)return Or(g,T,"cannot parse partitions");for(T=Zt(V=g.m,7),D=ae(V)?re(V,4):0,L=ae(V)?re(V,4):0,j=ae(V)?re(V,4):0,$=ae(V)?re(V,4):0,V=ae(V)?re(V,4):0,lt=g.Qa,rt=0;4>rt;++rt){if(lt.Cb){var ht=lt.Zb[rt];lt.Fb||(ht+=T)}else{if(0<rt){g.pb[rt]=g.pb[0];continue}ht=T}var gt=g.pb[rt];gt.Sc[0]=xl[ks(ht+D,127)],gt.Sc[1]=sA[ks(ht+0,127)],gt.Eb[0]=2*xl[ks(ht+L,127)],gt.Eb[1]=101581*sA[ks(ht+j,127)]>>16,8>gt.Eb[1]&&(gt.Eb[1]=8),gt.Qc[0]=xl[ks(ht+$,117)],gt.Qc[1]=sA[ks(ht+V,127)],gt.lc=ht+V}if(!z.Rb)return Or(g,4,"Not a key frame.");for(ae(H),z=g.Pa,T=0;4>T;++T){for(D=0;8>D;++D)for(L=0;3>L;++L)for(j=0;11>j;++j)$=ie(H,Ci[T][D][L][j])?Zt(H,8):oA[T][D][L][j],z.Wc[T][D].Yb[L][j]=$;for(D=0;17>D;++D)z.Xc[T][D]=z.Wc[T][op[D]]}return g.kc=ae(H),g.kc&&(g.Bd=Zt(H,8)),g.cb=1}function Tn(g,w,T,L,D,H,z){var j=w[D].Yb[T];for(T=0;16>D;++D){if(!ie(g,j[T+0]))return D;for(;!ie(g,j[T+1]);)if(j=w[++D].Yb[0],T=0,D==16)return 16;var V=w[D+1].Yb;if(ie(g,j[T+2])){var $=g,lt=0;if(ie($,(ht=j)[(rt=T)+3]))if(ie($,ht[rt+6])){for(j=0,rt=2*(lt=ie($,ht[rt+8]))+(ht=ie($,ht[rt+9+lt])),lt=0,ht=pd[rt];ht[j];++j)lt+=lt+ie($,ht[j]);lt+=3+(8<<rt)}else ie($,ht[rt+7])?(lt=7+2*ie($,165),lt+=ie($,145)):lt=5+ie($,159);else lt=ie($,ht[rt+4])?3+ie($,ht[rt+5]):2;j=V[2]}else lt=1,j=V[1];V=z+Jo[D],0>($=g).b&&jt($);var rt,ht=$.b,gt=(rt=$.Ca>>1)-($.I>>ht)>>31;--$.b,$.Ca+=gt,$.Ca|=1,$.I-=(rt+1&gt)<<ht,H[V]=((lt^gt)-gt)*L[(0<D)+0]}return 16}function _o(g){var w=g.rb[g.sb-1];w.la=0,w.Na=0,i(g.zc,0,0,g.zc.length),g.ja=0}function Fi(g,w){if(g==null)return 0;if(w==null)return Or(g,2,"NULL VP8Io parameter in VP8Decode().");if(!g.cb&&!Bs(g,w))return 0;if(t(g.cb),w.ac==null||w.ac(w)){w.ob&&(g.L=0);var T=_[g.L];if(g.L==2?(g.yb=0,g.zb=0):(g.yb=w.v-T>>4,g.zb=w.j-T>>4,0>g.yb&&(g.yb=0),0>g.zb&&(g.zb=0)),g.Va=w.o+15+T>>4,g.Hb=w.va+15+T>>4,g.Hb>g.za&&(g.Hb=g.za),g.Va>g.Ub&&(g.Va=g.Ub),0<g.L){var L=g.ed;for(T=0;4>T;++T){var D;if(g.Qa.Cb){var H=g.Qa.Lb[T];g.Qa.Fb||(H+=L.Tb)}else H=L.Tb;for(D=0;1>=D;++D){var z=g.gd[T][D],j=H;if(L.Pc&&(j+=L.vd[0],D&&(j+=L.od[0])),0<(j=0>j?0:63<j?63:j)){var V=j;0<L.wb&&(V=4<L.wb?V>>2:V>>1)>9-L.wb&&(V=9-L.wb),1>V&&(V=1),z.dd=V,z.tc=2*j+V,z.ld=40<=j?2:15<=j?1:0}else z.tc=0;z.La=D}}}T=0}else Or(g,6,"Frame setup failed"),T=g.a;if(T=T==0){if(T){g.$c=0,0<g.Aa||(g.Ic=P);t:{T=g.Ic,L=4*(V=g.za);var $=32*V,lt=V+1,rt=0<g.L?V*(0<g.Aa?2:1):0,ht=(g.Aa==2?2:1)*V;if((z=L+832+(D=3*(16*T+_[g.L])/2*$)+(H=g.Fa!=null&&0<g.Fa.length?g.Kc.c*g.Kc.i:0))!=z)T=0;else{if(z>g.Vb){if(g.Vb=0,g.Ec=s(z),g.Fc=0,g.Ec==null){T=Or(g,1,"no memory during frame initialization.");break t}g.Vb=z}z=g.Ec,j=g.Fc,g.Ac=z,g.Bc=j,j+=L,g.Gd=a($,Xn),g.Hd=0,g.rb=a(lt+1,bi),g.sb=1,g.wa=rt?a(rt,mn):null,g.Y=0,g.D.Nb=0,g.D.wa=g.wa,g.D.Y=g.Y,0<g.Aa&&(g.D.Y+=V),t(!0),g.oc=z,g.pc=j,j+=832,g.ya=a(ht,nn),g.aa=0,g.D.ya=g.ya,g.D.aa=g.aa,g.Aa==2&&(g.D.aa+=V),g.R=16*V,g.B=8*V,V=($=_[g.L])*g.R,$=$/2*g.B,g.sa=z,g.ta=j+V,g.qa=g.sa,g.ra=g.ta+16*T*g.R+$,g.Ha=g.qa,g.Ia=g.ra+8*T*g.B+$,g.$c=0,j+=D,g.mb=H?z:null,g.nb=H?j:null,t(j+H<=g.Fc+g.Vb),_o(g),i(g.Ac,g.Bc,0,L),T=1}}if(T){if(w.ka=0,w.y=g.sa,w.O=g.ta,w.f=g.qa,w.N=g.ra,w.ea=g.Ha,w.Vd=g.Ia,w.fa=g.R,w.Rc=g.B,w.F=null,w.J=0,!yl){for(T=-255;255>=T;++T)Xo[255+T]=0>T?-T:T;for(T=-1020;1020>=T;++T)Ze[1020+T]=-128>T?-128:127<T?127:T;for(T=-112;112>=T;++T)tA[112+T]=-16>T?-16:15<T?15:T;for(T=-255;510>=T;++T)ml[255+T]=0>T?0:255<T?255:T;yl=1}Zs=xt,_a=Go,Va=Ys,wo=dc,va=At,Wo=zo,Sc=ru,ba=mc,$o=Ad,Bi=Xu,Ns=yc,Qs=nu,Oi=Yu,_n=th,In=eu,Ln=Vo,Zn=jo,ja=$u,Di[0]=yi,Di[1]=he,Di[2]=Na,Di[3]=tu,Di[4]=fc,Di[5]=fa,Di[6]=al,Di[7]=Qa,Di[8]=ll,Di[9]=cl,xo[0]=li,xo[1]=ir,xo[2]=Hr,xo[3]=Kn,xo[4]=kn,xo[5]=ZA,xo[6]=ol,Zo[0]=gc,Zo[1]=Fe,Zo[2]=ud,Zo[3]=Wu,Zo[4]=pa,Zo[5]=Ha,Zo[6]=Pi,T=1}else T=0}T&&(T=function(gt,Pt){for(gt.M=0;gt.M<gt.Va;++gt.M){var Tt,_t=gt.Jc[gt.M&gt.Xb],bt=gt.m,Gt=gt;for(Tt=0;Tt<Gt.za;++Tt){var $t=bt,ue=Gt,Ae=ue.Ac,ye=ue.Bc+4*Tt,Re=ue.zc,Ce=ue.ya[ue.aa+Tt];if(ue.Qa.Bb?Ce.$b=ie($t,ue.Pa.jb[0])?2+ie($t,ue.Pa.jb[2]):ie($t,ue.Pa.jb[1]):Ce.$b=0,ue.kc&&(Ce.Ad=ie($t,ue.Bd)),Ce.Za=!ie($t,145)+0,Ce.Za){var We=Ce.Ob,rr=0;for(ue=0;4>ue;++ue){var er,Er=Re[0+ue];for(er=0;4>er;++er){Er=Ai[Ae[ye+er]][Er];for(var Lr=gd[ie($t,Er[0])];0<Lr;)Lr=gd[2*Lr+ie($t,Er[Lr])];Er=-Lr,Ae[ye+er]=Er}n(We,rr,Ae,ye,4),rr+=4,Re[0+ue]=Er}}else Er=ie($t,156)?ie($t,128)?1:3:ie($t,163)?2:0,Ce.Ob[0]=Er,i(Ae,ye,Er,4),i(Re,0,Er,4);Ce.Dd=ie($t,142)?ie($t,114)?ie($t,183)?1:3:2:0}if(Gt.m.Ka)return Or(gt,7,"Premature end-of-partition0 encountered.");for(;gt.ja<gt.za;++gt.ja){if(Gt=_t,$t=(bt=gt).rb[bt.sb-1],Ae=bt.rb[bt.sb+bt.ja],Tt=bt.ya[bt.aa+bt.ja],ye=bt.kc?Tt.Ad:0)$t.la=Ae.la=0,Tt.Za||($t.Na=Ae.Na=0),Tt.Hc=0,Tt.Gc=0,Tt.ia=0;else{var Zr,wr;if($t=Ae,Ae=Gt,ye=bt.Pa.Xc,Re=bt.ya[bt.aa+bt.ja],Ce=bt.pb[Re.$b],ue=Re.ad,We=0,rr=bt.rb[bt.sb-1],Er=er=0,i(ue,We,0,384),Re.Za)var Xr=0,Bn=ye[3];else{Lr=s(16);var Cn=$t.Na+rr.Na;if(Cn=Ki(Ae,ye[1],Cn,Ce.Eb,0,Lr,0),$t.Na=rr.Na=(0<Cn)+0,1<Cn)Zs(Lr,0,ue,We);else{var hi=Lr[0]+3>>3;for(Lr=0;256>Lr;Lr+=16)ue[We+Lr]=hi}Xr=1,Bn=ye[0]}var hn=15&$t.la,cs=15&rr.la;for(Lr=0;4>Lr;++Lr){var Ii=1&cs;for(hi=wr=0;4>hi;++hi)hn=hn>>1|(Ii=(Cn=Ki(Ae,Bn,Cn=Ii+(1&hn),Ce.Sc,Xr,ue,We))>Xr)<<7,wr=wr<<2|(3<Cn?3:1<Cn?2:ue[We+0]!=0),We+=16;hn>>=4,cs=cs>>1|Ii<<7,er=(er<<8|wr)>>>0}for(Bn=hn,Xr=cs>>4,Zr=0;4>Zr;Zr+=2){for(wr=0,hn=$t.la>>4+Zr,cs=rr.la>>4+Zr,Lr=0;2>Lr;++Lr){for(Ii=1&cs,hi=0;2>hi;++hi)Cn=Ii+(1&hn),hn=hn>>1|(Ii=0<(Cn=Ki(Ae,ye[2],Cn,Ce.Qc,0,ue,We)))<<3,wr=wr<<2|(3<Cn?3:1<Cn?2:ue[We+0]!=0),We+=16;hn>>=2,cs=cs>>1|Ii<<5}Er|=wr<<4*Zr,Bn|=hn<<4<<Zr,Xr|=(240&cs)<<Zr}$t.la=Bn,rr.la=Xr,Re.Hc=er,Re.Gc=Er,Re.ia=43690&Er?0:Ce.ia,ye=!(er|Er)}if(0<bt.L&&(bt.wa[bt.Y+bt.ja]=bt.gd[Tt.$b][Tt.Za],bt.wa[bt.Y+bt.ja].La|=!ye),Gt.Ka)return Or(gt,7,"Premature end-of-file encountered.")}if(_o(gt),bt=Pt,Gt=1,Tt=(_t=gt).D,$t=0<_t.L&&_t.M>=_t.zb&&_t.M<=_t.Va,_t.Aa==0)t:{if(Tt.M=_t.M,Tt.uc=$t,wc(_t,Tt),Gt=1,Tt=(wr=_t.D).Nb,$t=(Er=_[_t.L])*_t.R,Ae=Er/2*_t.B,Lr=16*Tt*_t.R,hi=8*Tt*_t.B,ye=_t.sa,Re=_t.ta-$t+Lr,Ce=_t.qa,ue=_t.ra-Ae+hi,We=_t.Ha,rr=_t.Ia-Ae+hi,cs=(hn=wr.M)==0,er=hn>=_t.Va-1,_t.Aa==2&&wc(_t,wr),wr.uc)for(Ii=(Cn=_t).D.M,t(Cn.D.uc),wr=Cn.yb;wr<Cn.Hb;++wr){Xr=wr,Bn=Ii;var zn=(dn=(si=Cn).D).Nb;Zr=si.R;var dn=dn.wa[dn.Y+Xr],sn=si.sa,fn=si.ta+16*zn*Zr+16*Xr,Ei=dn.dd,ln=dn.tc;if(ln!=0)if(t(3<=ln),si.L==1)0<Xr&&Ln(sn,fn,Zr,ln+4),dn.La&&ja(sn,fn,Zr,ln),0<Bn&&In(sn,fn,Zr,ln+4),dn.La&&Zn(sn,fn,Zr,ln);else{var En=si.B,Wi=si.qa,ti=si.ra+8*zn*En+8*Xr,Un=si.Ha,si=si.Ia+8*zn*En+8*Xr;zn=dn.ld,0<Xr&&(ba(sn,fn,Zr,ln+4,Ei,zn),Bi(Wi,ti,Un,si,En,ln+4,Ei,zn)),dn.La&&(Qs(sn,fn,Zr,ln,Ei,zn),_n(Wi,ti,Un,si,En,ln,Ei,zn)),0<Bn&&(Sc(sn,fn,Zr,ln+4,Ei,zn),$o(Wi,ti,Un,si,En,ln+4,Ei,zn)),dn.La&&(Ns(sn,fn,Zr,ln,Ei,zn),Oi(Wi,ti,Un,si,En,ln,Ei,zn))}}if(_t.ia&&alert("todo:DitherRow"),bt.put!=null){if(wr=16*hn,hn=16*(hn+1),cs?(bt.y=_t.sa,bt.O=_t.ta+Lr,bt.f=_t.qa,bt.N=_t.ra+hi,bt.ea=_t.Ha,bt.W=_t.Ia+hi):(wr-=Er,bt.y=ye,bt.O=Re,bt.f=Ce,bt.N=ue,bt.ea=We,bt.W=rr),er||(hn-=Er),hn>bt.o&&(hn=bt.o),bt.F=null,bt.J=null,_t.Fa!=null&&0<_t.Fa.length&&wr<hn&&(bt.J=Ko(_t,bt,wr,hn-wr),bt.F=_t.mb,bt.F==null&&bt.F.length==0)){Gt=Or(_t,3,"Could not decode alpha data.");break t}wr<bt.j&&(Er=bt.j-wr,wr=bt.j,t(!(1&Er)),bt.O+=_t.R*Er,bt.N+=_t.B*(Er>>1),bt.W+=_t.B*(Er>>1),bt.F!=null&&(bt.J+=bt.width*Er)),wr<hn&&(bt.O+=bt.v,bt.N+=bt.v>>1,bt.W+=bt.v>>1,bt.F!=null&&(bt.J+=bt.v),bt.ka=wr-bt.j,bt.U=bt.va-bt.v,bt.T=hn-wr,Gt=bt.put(bt))}Tt+1!=_t.Ic||er||(n(_t.sa,_t.ta-$t,ye,Re+16*_t.R,$t),n(_t.qa,_t.ra-Ae,Ce,ue+8*_t.B,Ae),n(_t.Ha,_t.Ia-Ae,We,rr+8*_t.B,Ae))}if(!Gt)return Or(gt,6,"Output aborted.")}return 1}(g,w)),w.bc!=null&&w.bc(w),T&=1}return T?(g.cb=0,T):0}function Mi(g,w,T,L,D){D=g[w+T+32*L]+(D>>3),g[w+T+32*L]=-256&D?0>D?0:255:D}function Yn(g,w,T,L,D,H){Mi(g,w,0,T,L+D),Mi(g,w,1,T,L+H),Mi(g,w,2,T,L-H),Mi(g,w,3,T,L-D)}function Ti(g){return(20091*g>>16)+g}function an(g,w,T,L){var D,H=0,z=s(16);for(D=0;4>D;++D){var j=g[w+0]+g[w+8],V=g[w+0]-g[w+8],$=(35468*g[w+4]>>16)-Ti(g[w+12]),lt=Ti(g[w+4])+(35468*g[w+12]>>16);z[H+0]=j+lt,z[H+1]=V+$,z[H+2]=V-$,z[H+3]=j-lt,H+=4,w++}for(D=H=0;4>D;++D)j=(g=z[H+0]+4)+z[H+8],V=g-z[H+8],$=(35468*z[H+4]>>16)-Ti(z[H+12]),Mi(T,L,0,0,j+(lt=Ti(z[H+4])+(35468*z[H+12]>>16))),Mi(T,L,1,0,V+$),Mi(T,L,2,0,V-$),Mi(T,L,3,0,j-lt),H++,L+=32}function zo(g,w,T,L){var D=g[w+0]+4,H=35468*g[w+4]>>16,z=Ti(g[w+4]),j=35468*g[w+1]>>16;Yn(T,L,0,D+z,g=Ti(g[w+1]),j),Yn(T,L,1,D+H,g,j),Yn(T,L,2,D-H,g,j),Yn(T,L,3,D-z,g,j)}function Go(g,w,T,L,D){an(g,w,T,L),D&&an(g,w+16,T,L+4)}function Ys(g,w,T,L){_a(g,w+0,T,L,1),_a(g,w+32,T,L+128,1)}function dc(g,w,T,L){var D;for(g=g[w+0]+4,D=0;4>D;++D)for(w=0;4>w;++w)Mi(T,L,w,D,g)}function At(g,w,T,L){g[w+0]&&wo(g,w+0,T,L),g[w+16]&&wo(g,w+16,T,L+4),g[w+32]&&wo(g,w+32,T,L+128),g[w+48]&&wo(g,w+48,T,L+128+4)}function xt(g,w,T,L){var D,H=s(16);for(D=0;4>D;++D){var z=g[w+0+D]+g[w+12+D],j=g[w+4+D]+g[w+8+D],V=g[w+4+D]-g[w+8+D],$=g[w+0+D]-g[w+12+D];H[0+D]=z+j,H[8+D]=z-j,H[4+D]=$+V,H[12+D]=$-V}for(D=0;4>D;++D)z=(g=H[0+4*D]+3)+H[3+4*D],j=H[1+4*D]+H[2+4*D],V=H[1+4*D]-H[2+4*D],$=g-H[3+4*D],T[L+0]=z+j>>3,T[L+16]=$+V>>3,T[L+32]=z-j>>3,T[L+48]=$-V>>3,L+=64}function Qt(g,w,T){var L,D=w-32,H=qi,z=255-g[D-1];for(L=0;L<T;++L){var j,V=H,$=z+g[w-1];for(j=0;j<T;++j)g[w+j]=V[$+g[D+j]];w+=32}}function he(g,w){Qt(g,w,4)}function Fe(g,w){Qt(g,w,8)}function ir(g,w){Qt(g,w,16)}function Hr(g,w){var T;for(T=0;16>T;++T)n(g,w+32*T,g,w-32,16)}function Kn(g,w){var T;for(T=16;0<T;--T)i(g,w,g[w-1],16),w+=32}function Jn(g,w,T){var L;for(L=0;16>L;++L)i(w,T+32*L,g,16)}function li(g,w){var T,L=16;for(T=0;16>T;++T)L+=g[w-1+32*T]+g[w+T-32];Jn(L>>5,g,w)}function kn(g,w){var T,L=8;for(T=0;16>T;++T)L+=g[w-1+32*T];Jn(L>>4,g,w)}function ZA(g,w){var T,L=8;for(T=0;16>T;++T)L+=g[w+T-32];Jn(L>>4,g,w)}function ol(g,w){Jn(128,g,w)}function Gr(g,w,T){return g+2*w+T+2>>2}function Na(g,w){var T,L=w-32;for(L=new Uint8Array([Gr(g[L-1],g[L+0],g[L+1]),Gr(g[L+0],g[L+1],g[L+2]),Gr(g[L+1],g[L+2],g[L+3]),Gr(g[L+2],g[L+3],g[L+4])]),T=0;4>T;++T)n(g,w+32*T,L,0,L.length)}function tu(g,w){var T=g[w-1],L=g[w-1+32],D=g[w-1+64],H=g[w-1+96];Be(g,w+0,16843009*Gr(g[w-1-32],T,L)),Be(g,w+32,16843009*Gr(T,L,D)),Be(g,w+64,16843009*Gr(L,D,H)),Be(g,w+96,16843009*Gr(D,H,H))}function yi(g,w){var T,L=4;for(T=0;4>T;++T)L+=g[w+T-32]+g[w-1+32*T];for(L>>=3,T=0;4>T;++T)i(g,w+32*T,L,4)}function fc(g,w){var T=g[w-1+0],L=g[w-1+32],D=g[w-1+64],H=g[w-1-32],z=g[w+0-32],j=g[w+1-32],V=g[w+2-32],$=g[w+3-32];g[w+0+96]=Gr(L,D,g[w-1+96]),g[w+1+96]=g[w+0+64]=Gr(T,L,D),g[w+2+96]=g[w+1+64]=g[w+0+32]=Gr(H,T,L),g[w+3+96]=g[w+2+64]=g[w+1+32]=g[w+0+0]=Gr(z,H,T),g[w+3+64]=g[w+2+32]=g[w+1+0]=Gr(j,z,H),g[w+3+32]=g[w+2+0]=Gr(V,j,z),g[w+3+0]=Gr($,V,j)}function al(g,w){var T=g[w+1-32],L=g[w+2-32],D=g[w+3-32],H=g[w+4-32],z=g[w+5-32],j=g[w+6-32],V=g[w+7-32];g[w+0+0]=Gr(g[w+0-32],T,L),g[w+1+0]=g[w+0+32]=Gr(T,L,D),g[w+2+0]=g[w+1+32]=g[w+0+64]=Gr(L,D,H),g[w+3+0]=g[w+2+32]=g[w+1+64]=g[w+0+96]=Gr(D,H,z),g[w+3+32]=g[w+2+64]=g[w+1+96]=Gr(H,z,j),g[w+3+64]=g[w+2+96]=Gr(z,j,V),g[w+3+96]=Gr(j,V,V)}function fa(g,w){var T=g[w-1+0],L=g[w-1+32],D=g[w-1+64],H=g[w-1-32],z=g[w+0-32],j=g[w+1-32],V=g[w+2-32],$=g[w+3-32];g[w+0+0]=g[w+1+64]=H+z+1>>1,g[w+1+0]=g[w+2+64]=z+j+1>>1,g[w+2+0]=g[w+3+64]=j+V+1>>1,g[w+3+0]=V+$+1>>1,g[w+0+96]=Gr(D,L,T),g[w+0+64]=Gr(L,T,H),g[w+0+32]=g[w+1+96]=Gr(T,H,z),g[w+1+32]=g[w+2+96]=Gr(H,z,j),g[w+2+32]=g[w+3+96]=Gr(z,j,V),g[w+3+32]=Gr(j,V,$)}function Qa(g,w){var T=g[w+0-32],L=g[w+1-32],D=g[w+2-32],H=g[w+3-32],z=g[w+4-32],j=g[w+5-32],V=g[w+6-32],$=g[w+7-32];g[w+0+0]=T+L+1>>1,g[w+1+0]=g[w+0+64]=L+D+1>>1,g[w+2+0]=g[w+1+64]=D+H+1>>1,g[w+3+0]=g[w+2+64]=H+z+1>>1,g[w+0+32]=Gr(T,L,D),g[w+1+32]=g[w+0+96]=Gr(L,D,H),g[w+2+32]=g[w+1+96]=Gr(D,H,z),g[w+3+32]=g[w+2+96]=Gr(H,z,j),g[w+3+64]=Gr(z,j,V),g[w+3+96]=Gr(j,V,$)}function cl(g,w){var T=g[w-1+0],L=g[w-1+32],D=g[w-1+64],H=g[w-1+96];g[w+0+0]=T+L+1>>1,g[w+2+0]=g[w+0+32]=L+D+1>>1,g[w+2+32]=g[w+0+64]=D+H+1>>1,g[w+1+0]=Gr(T,L,D),g[w+3+0]=g[w+1+32]=Gr(L,D,H),g[w+3+32]=g[w+1+64]=Gr(D,H,H),g[w+3+64]=g[w+2+64]=g[w+0+96]=g[w+1+96]=g[w+2+96]=g[w+3+96]=H}function ll(g,w){var T=g[w-1+0],L=g[w-1+32],D=g[w-1+64],H=g[w-1+96],z=g[w-1-32],j=g[w+0-32],V=g[w+1-32],$=g[w+2-32];g[w+0+0]=g[w+2+32]=T+z+1>>1,g[w+0+32]=g[w+2+64]=L+T+1>>1,g[w+0+64]=g[w+2+96]=D+L+1>>1,g[w+0+96]=H+D+1>>1,g[w+3+0]=Gr(j,V,$),g[w+2+0]=Gr(z,j,V),g[w+1+0]=g[w+3+32]=Gr(T,z,j),g[w+1+32]=g[w+3+64]=Gr(L,T,z),g[w+1+64]=g[w+3+96]=Gr(D,L,T),g[w+1+96]=Gr(H,D,L)}function ud(g,w){var T;for(T=0;8>T;++T)n(g,w+32*T,g,w-32,8)}function Wu(g,w){var T;for(T=0;8>T;++T)i(g,w,g[w-1],8),w+=32}function pc(g,w,T){var L;for(L=0;8>L;++L)i(w,T+32*L,g,8)}function gc(g,w){var T,L=8;for(T=0;8>T;++T)L+=g[w+T-32]+g[w-1+32*T];pc(L>>4,g,w)}function Ha(g,w){var T,L=4;for(T=0;8>T;++T)L+=g[w+T-32];pc(L>>3,g,w)}function pa(g,w){var T,L=4;for(T=0;8>T;++T)L+=g[w-1+32*T];pc(L>>3,g,w)}function Pi(g,w){pc(128,g,w)}function xi(g,w,T){var L=g[w-T],D=g[w+0],H=3*(D-L)+eh[1020+g[w-2*T]-g[w+T]],z=je[112+(H+4>>3)];g[w-T]=qi[255+L+je[112+(H+3>>3)]],g[w+0]=qi[255+D-z]}function cn(g,w,T,L){var D=g[w+0],H=g[w+T];return to[255+g[w-2*T]-g[w-T]]>L||to[255+H-D]>L}function ul(g,w,T,L){return 4*to[255+g[w-T]-g[w+0]]+to[255+g[w-2*T]-g[w+T]]<=L}function Al(g,w,T,L,D){var H=g[w-3*T],z=g[w-2*T],j=g[w-T],V=g[w+0],$=g[w+T],lt=g[w+2*T],rt=g[w+3*T];return 4*to[255+j-V]+to[255+z-$]>L?0:to[255+g[w-4*T]-H]<=D&&to[255+H-z]<=D&&to[255+z-j]<=D&&to[255+rt-lt]<=D&&to[255+lt-$]<=D&&to[255+$-V]<=D}function eu(g,w,T,L){var D=2*L+1;for(L=0;16>L;++L)ul(g,w+L,T,D)&&xi(g,w+L,T)}function Vo(g,w,T,L){var D=2*L+1;for(L=0;16>L;++L)ul(g,w+L*T,1,D)&&xi(g,w+L*T,1)}function jo(g,w,T,L){var D;for(D=3;0<D;--D)eu(g,w+=4*T,T,L)}function $u(g,w,T,L){var D;for(D=3;0<D;--D)Vo(g,w+=4,T,L)}function ga(g,w,T,L,D,H,z,j){for(H=2*H+1;0<D--;){if(Al(g,w,T,H,z))if(cn(g,w,T,j))xi(g,w,T);else{var V=g,$=w,lt=T,rt=V[$-2*lt],ht=V[$-lt],gt=V[$+0],Pt=V[$+lt],Tt=V[$+2*lt],_t=27*(Gt=eh[1020+3*(gt-ht)+eh[1020+rt-Pt]])+63>>7,bt=18*Gt+63>>7,Gt=9*Gt+63>>7;V[$-3*lt]=qi[255+V[$-3*lt]+Gt],V[$-2*lt]=qi[255+rt+bt],V[$-lt]=qi[255+ht+_t],V[$+0]=qi[255+gt-_t],V[$+lt]=qi[255+Pt-bt],V[$+2*lt]=qi[255+Tt-Gt]}w+=L}}function Os(g,w,T,L,D,H,z,j){for(H=2*H+1;0<D--;){if(Al(g,w,T,H,z))if(cn(g,w,T,j))xi(g,w,T);else{var V=g,$=w,lt=T,rt=V[$-lt],ht=V[$+0],gt=V[$+lt],Pt=je[112+((Tt=3*(ht-rt))+4>>3)],Tt=je[112+(Tt+3>>3)],_t=Pt+1>>1;V[$-2*lt]=qi[255+V[$-2*lt]+_t],V[$-lt]=qi[255+rt+Tt],V[$+0]=qi[255+ht-Pt],V[$+lt]=qi[255+gt-_t]}w+=L}}function ru(g,w,T,L,D,H){ga(g,w,T,1,16,L,D,H)}function mc(g,w,T,L,D,H){ga(g,w,1,T,16,L,D,H)}function yc(g,w,T,L,D,H){var z;for(z=3;0<z;--z)Os(g,w+=4*T,T,1,16,L,D,H)}function nu(g,w,T,L,D,H){var z;for(z=3;0<z;--z)Os(g,w+=4,1,T,16,L,D,H)}function Ad(g,w,T,L,D,H,z,j){ga(g,w,D,1,8,H,z,j),ga(T,L,D,1,8,H,z,j)}function Xu(g,w,T,L,D,H,z,j){ga(g,w,1,D,8,H,z,j),ga(T,L,1,D,8,H,z,j)}function Yu(g,w,T,L,D,H,z,j){Os(g,w+4*D,D,1,8,H,z,j),Os(T,L+4*D,D,1,8,H,z,j)}function th(g,w,T,L,D,H,z,j){Os(g,w+4,1,D,8,H,z,j),Os(T,L+4,1,D,8,H,z,j)}function iu(){this.ba=new Kr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Z,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function hl(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function _c(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function su(){this.ua=0,this.Wa=new Ut,this.vb=new Ut,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new yt,this.yc=new ct}function Ju(){this.xb=this.a=0,this.l=new Rs,this.ca=new Kr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new it,this.Pb=0,this.wd=new it,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new su,this.ab=0,this.gc=a(4,_c),this.Oc=0}function qo(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Rs,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function vc(g,w,T,L,D,H,z){for(g=g==null?0:g[w+0],w=0;w<z;++w)D[H+w]=g+T[L+w]&255,g=D[H+w]}function ou(g,w,T,L,D,H,z){var j;if(g==null)vc(null,null,T,L,D,H,z);else for(j=0;j<z;++j)D[H+j]=g[w+j]+T[L+j]&255}function ma(g,w,T,L,D,H,z){if(g==null)vc(null,null,T,L,D,H,z);else{var j,V=g[w+0],$=V,lt=V;for(j=0;j<z;++j)$=lt+(V=g[w+j])-$,lt=T[L+j]+(-256&$?0>$?0:255:$)&255,$=V,D[H+j]=lt}}function Ko(g,w,T,L){var D=w.width,H=w.o;if(t(g!=null&&w!=null),0>T||0>=L||T+L>H)return null;if(!g.Cc){if(g.ga==null){var z;if(g.ga=new qo,(z=g.ga==null)||(z=w.width*w.o,t(g.Gb.length==0),g.Gb=s(z),g.Uc=0,g.Gb==null?z=0:(g.mb=g.Gb,g.nb=g.Uc,g.rc=null,z=1),z=!z),!z){z=g.ga;var j=g.Fa,V=g.P,$=g.qc,lt=g.mb,rt=g.nb,ht=V+1,gt=$-1,Pt=z.l;if(t(j!=null&&lt!=null&&w!=null),Bo[0]=null,Bo[1]=vc,Bo[2]=ou,Bo[3]=ma,z.ca=lt,z.tb=rt,z.c=w.width,z.i=w.height,t(0<z.c&&0<z.i),1>=$)w=0;else if(z.$a=j[V+0]>>0&3,z.Z=j[V+0]>>2&3,z.Lc=j[V+0]>>4&3,V=j[V+0]>>6&3,0>z.$a||1<z.$a||4<=z.Z||1<z.Lc||V)w=0;else if(Pt.put=zt,Pt.ac=Nt,Pt.bc=qt,Pt.ma=z,Pt.width=w.width,Pt.height=w.height,Pt.Da=w.Da,Pt.v=w.v,Pt.va=w.va,Pt.j=w.j,Pt.o=w.o,z.$a)t:{t(z.$a==1),w=gr();e:for(;;){if(w==null){w=0;break t}if(t(z!=null),z.mc=w,w.c=z.c,w.i=z.i,w.l=z.l,w.l.ma=z,w.l.width=z.c,w.l.height=z.i,w.a=0,Xt(w.m,j,ht,gt),!Wr(z.c,z.i,1,w,null)||(w.ab==1&&w.gc[0].hc==3&&cr(w.s)?(z.ic=1,j=w.c*w.i,w.Ta=null,w.Ua=0,w.V=s(j),w.Ba=0,w.V==null?(w.a=1,w=0):w=1):(z.ic=0,w=vn(w,z.c)),!w))break e;w=1;break t}z.mc=null,w=0}else w=gt>=z.c*z.i;z=!w}if(z)return null;g.ga.Lc!=1?g.Ga=0:L=H-T}t(g.ga!=null),t(T+L<=H);t:{if(w=(j=g.ga).c,H=j.l.o,j.$a==0){if(ht=g.rc,gt=g.Vc,Pt=g.Fa,V=g.P+1+T*w,$=g.mb,lt=g.nb+T*w,t(V<=g.P+g.qc),j.Z!=0)for(t(Bo[j.Z]!=null),z=0;z<L;++z)Bo[j.Z](ht,gt,Pt,V,$,lt,w),ht=$,gt=lt,lt+=w,V+=w;else for(z=0;z<L;++z)n($,lt,Pt,V,w),ht=$,gt=lt,lt+=w,V+=w;g.rc=ht,g.Vc=gt}else{if(t(j.mc!=null),w=T+L,t((z=j.mc)!=null),t(w<=z.i),z.C>=w)w=1;else if(j.ic||oe(),j.ic){j=z.V,ht=z.Ba,gt=z.c;var Tt=z.i,_t=(Pt=1,V=z.$/gt,$=z.$%gt,lt=z.m,rt=z.s,z.$),bt=gt*Tt,Gt=gt*w,$t=rt.wc,ue=_t<Gt?Ge(rt,$,V):null;t(_t<=bt),t(w<=Tt),t(cr(rt));e:for(;;){for(;!lt.h&&_t<Gt;){if($&$t||(ue=Ge(rt,$,V)),t(ue!=null),Wt(lt),256>(Tt=pe(ue.G[0],ue.H[0],lt)))j[ht+_t]=Tt,++_t,++$>=gt&&($=0,++V<=w&&!(V%16)&&kr(z,V));else{if(!(280>Tt)){Pt=0;break e}Tt=Jt(Tt-256,lt);var Ae,ye=pe(ue.G[4],ue.H[4],lt);if(Wt(lt),!(_t>=(ye=me(gt,ye=Jt(ye,lt)))&&bt-_t>=Tt)){Pt=0;break e}for(Ae=0;Ae<Tt;++Ae)j[ht+_t+Ae]=j[ht+_t+Ae-ye];for(_t+=Tt,$+=Tt;$>=gt;)$-=gt,++V<=w&&!(V%16)&&kr(z,V);_t<Gt&&$&$t&&(ue=Ge(rt,$,V))}t(lt.h==Ft(lt))}kr(z,V>w?w:V);break e}!Pt||lt.h&&_t<bt?(Pt=0,z.a=lt.h?5:3):z.$=_t,w=Pt}else w=Qr(z,z.V,z.Ba,z.c,z.i,w,Dn);if(!w){L=0;break t}}T+L>=H&&(g.Cc=1),L=1}if(!L)return null;if(g.Cc&&((L=g.ga)!=null&&(L.mc=null),g.ga=null,0<g.Ga))return alert("todo:WebPDequantizeLevels"),null}return g.nb+T*D}function k(g,w,T,L,D,H){for(;0<D--;){var z,j=g,V=w+(T?1:0),$=g,lt=w+(T?0:3);for(z=0;z<L;++z){var rt=$[lt+4*z];rt!=255&&(rt*=32897,j[V+4*z+0]=j[V+4*z+0]*rt>>23,j[V+4*z+1]=j[V+4*z+1]*rt>>23,j[V+4*z+2]=j[V+4*z+2]*rt>>23)}w+=H}}function et(g,w,T,L,D){for(;0<L--;){var H;for(H=0;H<T;++H){var z=g[w+2*H+0],j=15&($=g[w+2*H+1]),V=4369*j,$=(240&$|$>>4)*V>>16;g[w+2*H+0]=(240&z|z>>4)*V>>16&240|(15&z|z<<4)*V>>16>>4&15,g[w+2*H+1]=240&$|j}w+=D}}function Mt(g,w,T,L,D,H,z,j){var V,$,lt=255;for($=0;$<D;++$){for(V=0;V<L;++V){var rt=g[w+V];H[z+4*V]=rt,lt&=rt}w+=T,z+=j}return lt!=255}function Vt(g,w,T,L,D){var H;for(H=0;H<D;++H)T[L+H]=g[w+H]>>8}function oe(){wa=k,uu=et,qa=Mt,Au=Vt}function ce(g,w,T){dt[g]=function(L,D,H,z,j,V,$,lt,rt,ht,gt,Pt,Tt,_t,bt,Gt,$t){var ue,Ae=$t-1>>1,ye=j[V+0]|$[lt+0]<<16,Re=rt[ht+0]|gt[Pt+0]<<16;t(L!=null);var Ce=3*ye+Re+131074>>2;for(w(L[D+0],255&Ce,Ce>>16,Tt,_t),H!=null&&(Ce=3*Re+ye+131074>>2,w(H[z+0],255&Ce,Ce>>16,bt,Gt)),ue=1;ue<=Ae;++ue){var We=j[V+ue]|$[lt+ue]<<16,rr=rt[ht+ue]|gt[Pt+ue]<<16,er=ye+We+Re+rr+524296,Er=er+2*(We+Re)>>3;Ce=Er+ye>>1,ye=(er=er+2*(ye+rr)>>3)+We>>1,w(L[D+2*ue-1],255&Ce,Ce>>16,Tt,_t+(2*ue-1)*T),w(L[D+2*ue-0],255&ye,ye>>16,Tt,_t+(2*ue-0)*T),H!=null&&(Ce=er+Re>>1,ye=Er+rr>>1,w(H[z+2*ue-1],255&Ce,Ce>>16,bt,Gt+(2*ue-1)*T),w(H[z+2*ue+0],255&ye,ye>>16,bt,Gt+(2*ue+0)*T)),ye=We,Re=rr}1&$t||(Ce=3*ye+Re+131074>>2,w(L[D+$t-1],255&Ce,Ce>>16,Tt,_t+($t-1)*T),H!=null&&(Ce=3*Re+ye+131074>>2,w(H[z+$t-1],255&Ce,Ce>>16,bt,Gt+($t-1)*T)))}}function Me(){Cs[eA]=yd,Cs[_l]=xa,Cs[rh]=_d,Cs[vl]=aA,Cs[rA]=hu,Cs[dd]=cA,Cs[Ka]=lA,Cs[Hn]=xa,Cs[bl]=aA,Cs[wl]=hu,Cs[nA]=cA}function ar(g){return g&~Cl?0>g?0:255:g>>uA}function Mr(g,w){return ar((19077*g>>8)+(26149*w>>8)-14234)}function zr(g,w,T){return ar((19077*g>>8)-(6419*w>>8)-(13320*T>>8)+8708)}function _r(g,w){return ar((19077*g>>8)+(33050*w>>8)-17685)}function bn(g,w,T,L,D){L[D+0]=Mr(g,T),L[D+1]=zr(g,w,T),L[D+2]=_r(g,w)}function vr(g,w,T,L,D){L[D+0]=_r(g,w),L[D+1]=zr(g,w,T),L[D+2]=Mr(g,T)}function ui(g,w,T,L,D){var H=zr(g,w,T);w=H<<3&224|_r(g,w)>>3,L[D+0]=248&Mr(g,T)|H>>5,L[D+1]=w}function qr(g,w,T,L,D){var H=240&_r(g,w)|15;L[D+0]=240&Mr(g,T)|zr(g,w,T)>>4,L[D+1]=H}function $r(g,w,T,L,D){L[D+0]=255,bn(g,w,T,L,D+1)}function ii(g,w,T,L,D){vr(g,w,T,L,D),L[D+3]=255}function Ds(g,w,T,L,D){bn(g,w,T,L,D),L[D+3]=255}function ks(g,w){return 0>g?0:g>w?w:g}function ya(g,w,T){dt[g]=function(L,D,H,z,j,V,$,lt,rt){for(var ht=lt+(-2&rt)*T;lt!=ht;)w(L[D+0],H[z+0],j[V+0],$,lt),w(L[D+1],H[z+0],j[V+0],$,lt+T),D+=2,++z,++V,lt+=2*T;1&rt&&w(L[D+0],H[z+0],j[V+0],$,lt)}}function dl(g,w,T){return T==0?g==0?w==0?6:5:w==0?4:0:T}function bc(g,w,T,L,D){switch(g>>>30){case 3:_a(w,T,L,D,0);break;case 2:Wo(w,T,L,D);break;case 1:wo(w,T,L,D)}}function wc(g,w){var T,L,D=w.M,H=w.Nb,z=g.oc,j=g.pc+40,V=g.oc,$=g.pc+584,lt=g.oc,rt=g.pc+600;for(T=0;16>T;++T)z[j+32*T-1]=129;for(T=0;8>T;++T)V[$+32*T-1]=129,lt[rt+32*T-1]=129;for(0<D?z[j-1-32]=V[$-1-32]=lt[rt-1-32]=129:(i(z,j-32-1,127,21),i(V,$-32-1,127,9),i(lt,rt-32-1,127,9)),L=0;L<g.za;++L){var ht=w.ya[w.aa+L];if(0<L){for(T=-1;16>T;++T)n(z,j+32*T-4,z,j+32*T+12,4);for(T=-1;8>T;++T)n(V,$+32*T-4,V,$+32*T+4,4),n(lt,rt+32*T-4,lt,rt+32*T+4,4)}var gt=g.Gd,Pt=g.Hd+L,Tt=ht.ad,_t=ht.Hc;if(0<D&&(n(z,j-32,gt[Pt].y,0,16),n(V,$-32,gt[Pt].f,0,8),n(lt,rt-32,gt[Pt].ea,0,8)),ht.Za){var bt=z,Gt=j-32+16;for(0<D&&(L>=g.za-1?i(bt,Gt,gt[Pt].y[15],4):n(bt,Gt,gt[Pt+1].y,0,4)),T=0;4>T;T++)bt[Gt+128+T]=bt[Gt+256+T]=bt[Gt+384+T]=bt[Gt+0+T];for(T=0;16>T;++T,_t<<=2)bt=z,Gt=j+y[T],Di[ht.Ob[T]](bt,Gt),bc(_t,Tt,16*+T,bt,Gt)}else if(bt=dl(L,D,ht.Ob[0]),xo[bt](z,j),_t!=0)for(T=0;16>T;++T,_t<<=2)bc(_t,Tt,16*+T,z,j+y[T]);for(T=ht.Gc,bt=dl(L,D,ht.Dd),Zo[bt](V,$),Zo[bt](lt,rt),_t=Tt,bt=V,Gt=$,255&(ht=T>>0)&&(170&ht?Va(_t,256,bt,Gt):va(_t,256,bt,Gt)),ht=lt,_t=rt,255&(T>>=8)&&(170&T?Va(Tt,320,ht,_t):va(Tt,320,ht,_t)),D<g.Ub-1&&(n(gt[Pt].y,0,z,j+480,16),n(gt[Pt].f,0,V,$+224,8),n(gt[Pt].ea,0,lt,rt+224,8)),T=8*H*g.B,gt=g.sa,Pt=g.ta+16*L+16*H*g.R,Tt=g.qa,ht=g.ra+8*L+T,_t=g.Ha,bt=g.Ia+8*L+T,T=0;16>T;++T)n(gt,Pt+T*g.R,z,j+32*T,16);for(T=0;8>T;++T)n(Tt,ht+T*g.B,V,$+32*T,8),n(_t,bt+T*g.B,lt,rt+32*T,8)}}function fl(g,w,T,L,D,H,z,j,V){var $=[0],lt=[0],rt=0,ht=V!=null?V.kd:0,gt=V??new hl;if(g==null||12>T)return 7;gt.data=g,gt.w=w,gt.ha=T,w=[w],T=[T],gt.gb=[gt.gb];t:{var Pt=w,Tt=T,_t=gt.gb;if(t(g!=null),t(Tt!=null),t(_t!=null),_t[0]=0,12<=Tt[0]&&!e(g,Pt[0],"RIFF")){if(e(g,Pt[0]+8,"WEBP")){_t=3;break t}var bt=Qe(g,Pt[0]+4);if(12>bt||4294967286<bt){_t=3;break t}if(ht&&bt>Tt[0]-8){_t=7;break t}_t[0]=bt,Pt[0]+=12,Tt[0]-=12}_t=0}if(_t!=0)return _t;for(bt=0<gt.gb[0],T=T[0];;){t:{var Gt=g;Tt=w,_t=T;var $t=$,ue=lt,Ae=Pt=[0];if((Ce=rt=[rt])[0]=0,8>_t[0])_t=7;else{if(!e(Gt,Tt[0],"VP8X")){if(Qe(Gt,Tt[0]+4)!=10){_t=3;break t}if(18>_t[0]){_t=7;break t}var ye=Qe(Gt,Tt[0]+8),Re=1+Ne(Gt,Tt[0]+12);if(2147483648<=Re*(Gt=1+Ne(Gt,Tt[0]+15))){_t=3;break t}Ae!=null&&(Ae[0]=ye),$t!=null&&($t[0]=Re),ue!=null&&(ue[0]=Gt),Tt[0]+=18,_t[0]-=18,Ce[0]=1}_t=0}}if(rt=rt[0],Pt=Pt[0],_t!=0)return _t;if(Tt=!!(2&Pt),!bt&&rt)return 3;if(H!=null&&(H[0]=!!(16&Pt)),z!=null&&(z[0]=Tt),j!=null&&(j[0]=0),z=$[0],Pt=lt[0],rt&&Tt&&V==null){_t=0;break}if(4>T){_t=7;break}if(bt&&rt||!bt&&!rt&&!e(g,w[0],"ALPH")){T=[T],gt.na=[gt.na],gt.P=[gt.P],gt.Sa=[gt.Sa];t:{ye=g,_t=w,bt=T;var Ce=gt.gb;$t=gt.na,ue=gt.P,Ae=gt.Sa,Re=22,t(ye!=null),t(bt!=null),Gt=_t[0];var We=bt[0];for(t($t!=null),t(Ae!=null),$t[0]=null,ue[0]=null,Ae[0]=0;;){if(_t[0]=Gt,bt[0]=We,8>We){_t=7;break t}var rr=Qe(ye,Gt+4);if(4294967286<rr){_t=3;break t}var er=8+rr+1&-2;if(Re+=er,0<Ce&&Re>Ce){_t=3;break t}if(!e(ye,Gt,"VP8 ")||!e(ye,Gt,"VP8L")){_t=0;break t}if(We[0]<er){_t=7;break t}e(ye,Gt,"ALPH")||($t[0]=ye,ue[0]=Gt+8,Ae[0]=rr),Gt+=er,We-=er}}if(T=T[0],gt.na=gt.na[0],gt.P=gt.P[0],gt.Sa=gt.Sa[0],_t!=0)break}T=[T],gt.Ja=[gt.Ja],gt.xa=[gt.xa];t:if(Ce=g,_t=w,bt=T,$t=gt.gb[0],ue=gt.Ja,Ae=gt.xa,ye=_t[0],Gt=!e(Ce,ye,"VP8 "),Re=!e(Ce,ye,"VP8L"),t(Ce!=null),t(bt!=null),t(ue!=null),t(Ae!=null),8>bt[0])_t=7;else{if(Gt||Re){if(Ce=Qe(Ce,ye+4),12<=$t&&Ce>$t-12){_t=3;break t}if(ht&&Ce>bt[0]-8){_t=7;break t}ue[0]=Ce,_t[0]+=8,bt[0]-=8,Ae[0]=Re}else Ae[0]=5<=bt[0]&&Ce[ye+0]==47&&!(Ce[ye+4]>>5),ue[0]=bt[0];_t=0}if(T=T[0],gt.Ja=gt.Ja[0],gt.xa=gt.xa[0],w=w[0],_t!=0)break;if(4294967286<gt.Ja)return 3;if(j==null||Tt||(j[0]=gt.xa?2:1),z=[z],Pt=[Pt],gt.xa){if(5>T){_t=7;break}j=z,ht=Pt,Tt=H,g==null||5>T?g=0:5<=T&&g[w+0]==47&&!(g[w+4]>>5)?(bt=[0],Ce=[0],$t=[0],Xt(ue=new it,g,w,T),St(ue,bt,Ce,$t)?(j!=null&&(j[0]=bt[0]),ht!=null&&(ht[0]=Ce[0]),Tt!=null&&(Tt[0]=$t[0]),g=1):g=0):g=0}else{if(10>T){_t=7;break}j=Pt,g==null||10>T||!Xs(g,w+3,T-3)?g=0:(ht=g[w+0]|g[w+1]<<8|g[w+2]<<16,Tt=16383&(g[w+7]<<8|g[w+6]),g=16383&(g[w+9]<<8|g[w+8]),1&ht||3<(ht>>1&7)||!(ht>>4&1)||ht>>5>=gt.Ja||!Tt||!g?g=0:(z&&(z[0]=Tt),j&&(j[0]=g),g=1))}if(!g||(z=z[0],Pt=Pt[0],rt&&($[0]!=z||lt[0]!=Pt)))return 3;V!=null&&(V[0]=gt,V.offset=w-V.w,t(4294967286>w-V.w),t(V.offset==V.ha-T));break}return _t==0||_t==7&&rt&&V==null?(H!=null&&(H[0]|=gt.na!=null&&0<gt.na.length),L!=null&&(L[0]=z),D!=null&&(D[0]=Pt),0):_t}function xc(g,w,T){var L=w.width,D=w.height,H=0,z=0,j=L,V=D;if(w.Da=g!=null&&0<g.Da,w.Da&&(j=g.cd,V=g.bd,H=g.v,z=g.j,11>T||(H&=-2,z&=-2),0>H||0>z||0>=j||0>=V||H+j>L||z+V>D))return 0;if(w.v=H,w.j=z,w.va=H+j,w.o=z+V,w.U=j,w.T=V,w.da=g!=null&&0<g.da,w.da){if(!Yt(j,V,T=[g.ib],H=[g.hb]))return 0;w.ib=T[0],w.hb=H[0]}return w.ob=g!=null&&g.ob,w.Kb=g==null||!g.Sd,w.da&&(w.ob=w.ib<3*L/4&&w.hb<3*D/4,w.Kb=0),1}function au(g){if(g==null)return 2;if(11>g.S){var w=g.f.RGBA;w.fb+=(g.height-1)*w.A,w.A=-w.A}else w=g.f.kb,g=g.height,w.O+=(g-1)*w.fa,w.fa=-w.fa,w.N+=(g-1>>1)*w.Ab,w.Ab=-w.Ab,w.W+=(g-1>>1)*w.Db,w.Db=-w.Db,w.F!=null&&(w.J+=(g-1)*w.lb,w.lb=-w.lb);return 0}function za(g,w,T,L){if(L==null||0>=g||0>=w)return 2;if(T!=null){if(T.Da){var D=T.cd,H=T.bd,z=-2&T.v,j=-2&T.j;if(0>z||0>j||0>=D||0>=H||z+D>g||j+H>w)return 2;g=D,w=H}if(T.da){if(!Yt(g,w,D=[T.ib],H=[T.hb]))return 2;g=D[0],w=H[0]}}L.width=g,L.height=w;t:{var V=L.width,$=L.height;if(g=L.S,0>=V||0>=$||!(g>=eA&&13>g))g=2;else{if(0>=L.Rd&&L.sd==null){z=H=D=w=0;var lt=(j=V*R[g])*$;if(11>g||(H=($+1)/2*(w=(V+1)/2),g==12&&(z=(D=V)*$)),($=s(lt+2*H+z))==null){g=1;break t}L.sd=$,11>g?((V=L.f.RGBA).eb=$,V.fb=0,V.A=j,V.size=lt):((V=L.f.kb).y=$,V.O=0,V.fa=j,V.Fd=lt,V.f=$,V.N=0+lt,V.Ab=w,V.Cd=H,V.ea=$,V.W=0+lt+H,V.Db=w,V.Ed=H,g==12&&(V.F=$,V.J=0+lt+2*H),V.Tc=z,V.lb=D)}if(w=1,D=L.S,H=L.width,z=L.height,D>=eA&&13>D)if(11>D)g=L.f.RGBA,w&=(j=Math.abs(g.A))*(z-1)+H<=g.size,w&=j>=H*R[D],w&=g.eb!=null;else{g=L.f.kb,j=(H+1)/2,lt=(z+1)/2,V=Math.abs(g.fa),$=Math.abs(g.Ab);var rt=Math.abs(g.Db),ht=Math.abs(g.lb),gt=ht*(z-1)+H;w&=V*(z-1)+H<=g.Fd,w&=$*(lt-1)+j<=g.Cd,w=(w&=rt*(lt-1)+j<=g.Ed)&V>=H&$>=j&rt>=j,w&=g.y!=null,w&=g.f!=null,w&=g.ea!=null,D==12&&(w&=ht>=H,w&=gt<=g.Tc,w&=g.F!=null)}else w=0;g=w?0:2}}return g!=0||T!=null&&T.fd&&(g=au(L)),g}var as=64,Bc=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],pl=24,gl=32,Cc=8,_s=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];_e("Predictor0","PredictorAdd0"),dt.Predictor0=function(){return 4278190080},dt.Predictor1=function(g){return g},dt.Predictor2=function(g,w,T){return w[T+0]},dt.Predictor3=function(g,w,T){return w[T+1]},dt.Predictor4=function(g,w,T){return w[T-1]},dt.Predictor5=function(g,w,T){return De(De(g,w[T+1]),w[T+0])},dt.Predictor6=function(g,w,T){return De(g,w[T-1])},dt.Predictor7=function(g,w,T){return De(g,w[T+0])},dt.Predictor8=function(g,w,T){return De(w[T-1],w[T+0])},dt.Predictor9=function(g,w,T){return De(w[T+0],w[T+1])},dt.Predictor10=function(g,w,T){return De(De(g,w[T-1]),De(w[T+0],w[T+1]))},dt.Predictor11=function(g,w,T){var L=w[T+0];return 0>=Ir(L>>24&255,g>>24&255,(w=w[T-1])>>24&255)+Ir(L>>16&255,g>>16&255,w>>16&255)+Ir(L>>8&255,g>>8&255,w>>8&255)+Ir(255&L,255&g,255&w)?L:g},dt.Predictor12=function(g,w,T){var L=w[T+0];return(nr((g>>24&255)+(L>>24&255)-((w=w[T-1])>>24&255))<<24|nr((g>>16&255)+(L>>16&255)-(w>>16&255))<<16|nr((g>>8&255)+(L>>8&255)-(w>>8&255))<<8|nr((255&g)+(255&L)-(255&w)))>>>0},dt.Predictor13=function(g,w,T){var L=w[T-1];return(ur((g=De(g,w[T+0]))>>24&255,L>>24&255)<<24|ur(g>>16&255,L>>16&255)<<16|ur(g>>8&255,L>>8&255)<<8|ur(g>>0&255,L>>0&255))>>>0};var hd=dt.PredictorAdd0;dt.PredictorAdd1=Sr,_e("Predictor2","PredictorAdd2"),_e("Predictor3","PredictorAdd3"),_e("Predictor4","PredictorAdd4"),_e("Predictor5","PredictorAdd5"),_e("Predictor6","PredictorAdd6"),_e("Predictor7","PredictorAdd7"),_e("Predictor8","PredictorAdd8"),_e("Predictor9","PredictorAdd9"),_e("Predictor10","PredictorAdd10"),_e("Predictor11","PredictorAdd11"),_e("Predictor12","PredictorAdd12"),_e("Predictor13","PredictorAdd13");var cu=dt.PredictorAdd2;Tr("ColorIndexInverseTransform","MapARGB","32b",function(g){return g>>8&255},function(g){return g}),Tr("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(g){return g},function(g){return g>>8&255});var Wn,Vi=dt.ColorIndexInverseTransform,Ui=dt.MapARGB,Zu=dt.VP8LColorIndexInverseTransformAlpha,lu=dt.MapAlpha,Ga=dt.VP8LPredictorsAdd=[];Ga.length=16,(dt.VP8LPredictors=[]).length=16,(dt.VP8LPredictorsAdd_C=[]).length=16,(dt.VP8LPredictors_C=[]).length=16;var Ri,ji,Js,vo,bo,Ec,Zs,_a,Wo,Va,wo,va,Sc,ba,$o,Bi,Ns,Qs,Oi,_n,In,Ln,Zn,ja,wa,uu,qa,Au,Xo=s(511),Ze=s(2041),tA=s(225),ml=s(767),yl=0,eh=Ze,je=tA,qi=ml,to=Xo,eA=0,_l=1,rh=2,vl=3,rA=4,dd=5,Ka=6,Hn=7,bl=8,wl=9,nA=10,ip=[2,3,7],sp=[3,3,11],fd=[280,256,256,256,40],Yo=[0,1,1,1,0],iA=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],hr=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],br=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],nh=8,xl=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],sA=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ki=null,pd=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Jo=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],gd=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],oA=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Ai=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Ci=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],op=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],xo=[],Di=[],Zo=[],md=1,ih=2,Bo=[],Cs=[];ce("UpsampleRgbLinePair",bn,3),ce("UpsampleBgrLinePair",vr,3),ce("UpsampleRgbaLinePair",Ds,4),ce("UpsampleBgraLinePair",ii,4),ce("UpsampleArgbLinePair",$r,4),ce("UpsampleRgba4444LinePair",qr,2),ce("UpsampleRgb565LinePair",ui,2);var yd=dt.UpsampleRgbLinePair,_d=dt.UpsampleBgrLinePair,xa=dt.UpsampleRgbaLinePair,aA=dt.UpsampleBgraLinePair,hu=dt.UpsampleArgbLinePair,cA=dt.UpsampleRgba4444LinePair,lA=dt.UpsampleRgb565LinePair,Bl=16,Wa=1<<Bl-1,ta=-227,du=482,uA=6,Cl=(256<<uA)-1,sh=0,vd=s(256),oh=s(256),ap=s(256),B=s(256),l=s(du-ta),d=s(du-ta);ya("YuvToRgbRow",bn,3),ya("YuvToBgrRow",vr,3),ya("YuvToRgbaRow",Ds,4),ya("YuvToBgraRow",ii,4),ya("YuvToArgbRow",$r,4),ya("YuvToRgba4444Row",qr,2),ya("YuvToRgb565Row",ui,2);var y=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],_=[0,2,8],E=[8,7,6,4,4,2,2,2,1,1,1,1],P=1;this.WebPDecodeRGBA=function(g,w,T,L,D){var H=_l,z=new iu,j=new Kr;z.ba=j,j.S=H,j.width=[j.width],j.height=[j.height];var V=j.width,$=j.height,lt=new Ct;if(lt==null||g==null)var rt=2;else t(lt!=null),rt=fl(g,w,T,lt.width,lt.height,lt.Pd,lt.Qd,lt.format,null);if(rt!=0?V=0:(V!=null&&(V[0]=lt.width[0]),$!=null&&($[0]=lt.height[0]),V=1),V){j.width=j.width[0],j.height=j.height[0],L!=null&&(L[0]=j.width),D!=null&&(D[0]=j.height);t:{if(L=new Rs,(D=new hl).data=g,D.w=w,D.ha=T,D.kd=1,w=[0],t(D!=null),((g=fl(D.data,D.w,D.ha,null,null,null,w,null,D))==0||g==7)&&w[0]&&(g=4),(w=g)==0){if(t(z!=null),L.data=D.data,L.w=D.w+D.offset,L.ha=D.ha-D.offset,L.put=zt,L.ac=Nt,L.bc=qt,L.ma=z,D.xa){if((g=gr())==null){z=1;break t}if(function(ht,gt){var Pt=[0],Tt=[0],_t=[0];e:for(;;){if(ht==null)return 0;if(gt==null)return ht.a=2,0;if(ht.l=gt,ht.a=0,Xt(ht.m,gt.data,gt.w,gt.ha),!St(ht.m,Pt,Tt,_t)){ht.a=3;break e}if(ht.xb=ih,gt.width=Pt[0],gt.height=Tt[0],!Wr(Pt[0],Tt[0],1,ht,null))break e;return 1}return t(ht.a!=0),0}(g,L)){if(L=(w=za(L.width,L.height,z.Oa,z.ba))==0){e:{L=g;r:for(;;){if(L==null){L=0;break e}if(t(L.s.yc!=null),t(L.s.Ya!=null),t(0<L.s.Wb),t((T=L.l)!=null),t((D=T.ma)!=null),L.xb!=0){if(L.ca=D.ba,L.tb=D.tb,t(L.ca!=null),!xc(D.Oa,T,vl)){L.a=2;break r}if(!vn(L,T.width)||T.da)break r;if((T.da||Rr(L.ca.S))&&oe(),11>L.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),L.ca.f.kb.F!=null&&oe()),L.Pb&&0<L.s.ua&&L.s.vb.X==null&&!He(L.s.vb,L.s.Wa.Xa)){L.a=1;break r}L.xb=0}if(!Qr(L,L.V,L.Ba,L.c,L.i,T.o,Cr))break r;D.Dc=L.Ma,L=1;break e}t(L.a!=0),L=0}L=!L}L&&(w=g.a)}else w=g.a}else{if((g=new Ho)==null){z=1;break t}if(g.Fa=D.na,g.P=D.P,g.qc=D.Sa,Bs(g,L)){if((w=za(L.width,L.height,z.Oa,z.ba))==0){if(g.Aa=0,T=z.Oa,t((D=g)!=null),T!=null){if(0<(V=0>(V=T.Md)?0:100<V?255:255*V/100)){for($=lt=0;4>$;++$)12>(rt=D.pb[$]).lc&&(rt.ia=V*E[0>rt.lc?0:rt.lc]>>3),lt|=rt.ia;lt&&(alert("todo:VP8InitRandom"),D.ia=1)}D.Ga=T.Id,100<D.Ga?D.Ga=100:0>D.Ga&&(D.Ga=0)}Fi(g,L)||(w=g.a)}}else w=g.a}w==0&&z.Oa!=null&&z.Oa.fd&&(w=au(z.ba))}z=w}H=z!=0?null:11>H?j.f.RGBA.eb:j.f.kb.y}else H=null;return H};var R=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(dt,Rt){for(var Lt="",st=0;st<4;st++)Lt+=String.fromCharCode(dt[Rt++]);return Lt}function m(dt,Rt){return(dt[Rt+0]<<0|dt[Rt+1]<<8|dt[Rt+2]<<16)>>>0}function b(dt,Rt){return(dt[Rt+0]<<0|dt[Rt+1]<<8|dt[Rt+2]<<16|dt[Rt+3]<<24)>>>0}new A;var x=[0],C=[0],M=[],U=new A,N=r,Q=function(dt,Rt){var Lt={},st=0,ct=!1,wt=0,yt=0;if(Lt.frames=[],!function(vt,Ft,Ot,Wt){for(var jt=0;jt<Wt;jt++)if(vt[Ft+jt]!=Ot.charCodeAt(jt))return!0;return!1}(dt,Rt,"RIFF",4)){var te,Zt;for(b(dt,Rt+=4),Rt+=8;Rt<dt.length;){var re=f(dt,Rt),Xt=b(dt,Rt+=4);Rt+=4;var ne=Xt+(1&Xt);switch(re){case"VP8 ":case"VP8L":Lt.frames[st]===void 0&&(Lt.frames[st]={}),(it=Lt.frames[st]).src_off=ct?yt:Rt-8,it.src_size=wt+Xt+8,st++,ct&&(ct=!1,wt=0,yt=0);break;case"VP8X":(it=Lt.header={}).feature_flags=dt[Rt];var se=Rt+4;it.canvas_width=1+m(dt,se),se+=3,it.canvas_height=1+m(dt,se),se+=3;break;case"ALPH":ct=!0,wt=ne+8,yt=Rt-8;break;case"ANIM":(it=Lt.header).bgcolor=b(dt,Rt),se=Rt+4,it.loop_count=(te=dt)[(Zt=se)+0]<<0|te[Zt+1]<<8,se+=2;break;case"ANMF":var we,it;(it=Lt.frames[st]={}).offset_x=2*m(dt,Rt),Rt+=3,it.offset_y=2*m(dt,Rt),Rt+=3,it.width=1+m(dt,Rt),Rt+=3,it.height=1+m(dt,Rt),Rt+=3,it.duration=m(dt,Rt),Rt+=3,we=dt[Rt++],it.dispose=1&we,it.blend=we>>1&1}re!="ANMF"&&(Rt+=ne)}return Lt}}(N,0);Q.response=N,Q.rgbaoutput=!0,Q.dataurl=!1;var q=Q.header?Q.header:null,Y=Q.frames?Q.frames:null;if(q){q.loop_counter=q.loop_count,x=[q.canvas_height],C=[q.canvas_width];for(var tt=0;tt<Y.length&&Y[tt].blend!=0;tt++);}var ft=Y[0],pt=U.WebPDecodeRGBA(N,ft.src_off,ft.src_size,C,x);ft.rgba=pt,ft.imgwidth=C[0],ft.imgheight=x[0];for(var mt=0;mt<C[0]*x[0]*4;mt++)M[mt]=pt[mt];return this.width=C,this.height=x,this.data=M,this}(function(r){var t=function(){return typeof A2=="function"},e=function(x,C,M,U){var N=4,Q=a;switch(U){case r.image_compression.FAST:N=1,Q=s;break;case r.image_compression.MEDIUM:N=6,Q=o;break;case r.image_compression.SLOW:N=9,Q=A}x=n(x,C,M,Q);var q=A2(x,{level:N});return r.__addimage__.arrayBufferToBinaryString(q)},n=function(x,C,M,U){for(var N,Q,q,Y=x.length/C,tt=new Uint8Array(x.length+Y),ft=m(),pt=0;pt<Y;pt+=1){if(q=pt*C,N=x.subarray(q,q+C),U)tt.set(U(N,M,Q),q+pt);else{for(var mt,dt=ft.length,Rt=[];mt<dt;mt+=1)Rt[mt]=ft[mt](N,M,Q);var Lt=b(Rt.concat());tt.set(Rt[Lt],q+pt)}Q=N}return tt},i=function(x){var C=Array.apply([],x);return C.unshift(0),C},s=function(x,C){var M,U=[],N=x.length;U[0]=1;for(var Q=0;Q<N;Q+=1)M=x[Q-C]||0,U[Q+1]=x[Q]-M+256&255;return U},a=function(x,C,M){var U,N=[],Q=x.length;N[0]=2;for(var q=0;q<Q;q+=1)U=M&&M[q]||0,N[q+1]=x[q]-U+256&255;return N},o=function(x,C,M){var U,N,Q=[],q=x.length;Q[0]=3;for(var Y=0;Y<q;Y+=1)U=x[Y-C]||0,N=M&&M[Y]||0,Q[Y+1]=x[Y]+256-(U+N>>>1)&255;return Q},A=function(x,C,M){var U,N,Q,q,Y=[],tt=x.length;Y[0]=4;for(var ft=0;ft<tt;ft+=1)U=x[ft-C]||0,N=M&&M[ft]||0,Q=M&&M[ft-C]||0,q=f(U,N,Q),Y[ft+1]=x[ft]-q+256&255;return Y},f=function(x,C,M){if(x===C&&C===M)return x;var U=Math.abs(C-M),N=Math.abs(x-M),Q=Math.abs(x+C-M-M);return U<=N&&U<=Q?x:N<=Q?C:M},m=function(){return[i,s,a,o,A]},b=function(x){var C=x.map(function(M){return M.reduce(function(U,N){return U+Math.abs(N)},0)});return C.indexOf(Math.min.apply(null,C))};r.processPNG=function(x,C,M,U){var N,Q,q,Y,tt,ft,pt,mt,dt,Rt,Lt,st,ct,wt,yt,te=this.decode.FLATE_DECODE,Zt="";if(this.__addimage__.isArrayBuffer(x)&&(x=new Uint8Array(x)),this.__addimage__.isArrayBufferView(x)){if(x=(q=new Pet(x)).imgData,Q=q.bits,N=q.colorSpace,tt=q.colors,[4,6].indexOf(q.colorType)!==-1){if(q.bits===8){dt=(mt=q.pixelBitlength==32?new Uint32Array(q.decodePixels().buffer):q.pixelBitlength==16?new Uint16Array(q.decodePixels().buffer):new Uint8Array(q.decodePixels().buffer)).length,Lt=new Uint8Array(dt*q.colors),Rt=new Uint8Array(dt);var re,Xt=q.pixelBitlength-q.bits;for(wt=0,yt=0;wt<dt;wt++){for(ct=mt[wt],re=0;re<Xt;)Lt[yt++]=ct>>>re&255,re+=q.bits;Rt[wt]=ct>>>re&255}}if(q.bits===16){dt=(mt=new Uint32Array(q.decodePixels().buffer)).length,Lt=new Uint8Array(dt*(32/q.pixelBitlength)*q.colors),Rt=new Uint8Array(dt*(32/q.pixelBitlength)),st=q.colors>1,wt=0,yt=0;for(var ne=0;wt<dt;)ct=mt[wt++],Lt[yt++]=ct>>>0&255,st&&(Lt[yt++]=ct>>>16&255,ct=mt[wt++],Lt[yt++]=ct>>>0&255),Rt[ne++]=ct>>>16&255;Q=8}U!==r.image_compression.NONE&&t()?(x=e(Lt,q.width*q.colors,q.colors,U),pt=e(Rt,q.width,1,U)):(x=Lt,pt=Rt,te=void 0)}if(q.colorType===3&&(N=this.color_spaces.INDEXED,ft=q.palette,q.transparency.indexed)){var se=q.transparency.indexed,we=0;for(wt=0,dt=se.length;wt<dt;++wt)we+=se[wt];if((we/=255)===dt-1&&se.indexOf(0)!==-1)Y=[se.indexOf(0)];else if(we!==dt){for(mt=q.decodePixels(),Rt=new Uint8Array(mt.length),wt=0,dt=mt.length;wt<dt;wt++)Rt[wt]=se[mt[wt]];pt=e(Rt,q.width,1)}}var it=function(vt){var Ft;switch(vt){case r.image_compression.FAST:Ft=11;break;case r.image_compression.MEDIUM:Ft=13;break;case r.image_compression.SLOW:Ft=14;break;default:Ft=12}return Ft}(U);return te===this.decode.FLATE_DECODE&&(Zt="/Predictor "+it+" "),Zt+="/Colors "+tt+" /BitsPerComponent "+Q+" /Columns "+q.width,(this.__addimage__.isArrayBuffer(x)||this.__addimage__.isArrayBufferView(x))&&(x=this.__addimage__.arrayBufferToBinaryString(x)),(pt&&this.__addimage__.isArrayBuffer(pt)||this.__addimage__.isArrayBufferView(pt))&&(pt=this.__addimage__.arrayBufferToBinaryString(pt)),{alias:M,data:x,index:C,filter:te,decodeParameters:Zt,transparency:Y,palette:ft,sMask:pt,predictor:it,width:q.width,height:q.height,bitsPerComponent:Q,colorSpace:N}}}})(jr.API),function(r){r.processGIF89A=function(t,e,n,i){var s=new Uet(t),a=s.width,o=s.height,A=[];s.decodeAndBlitFrameRGBA(0,A);var f={data:A,width:a,height:o},m=new x2(100).encode(f,100);return r.processJPEG.call(this,m,e,n,i)},r.processGIF87A=r.processGIF89A}(jr.API),Kc.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var t=0;t<r;t++){var e=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:n,blue:e,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Kc.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[r]()}catch(e){ci.log("bit decode error:"+e)}},Kc.prototype.bit1=function(){var r,t=Math.ceil(this.width/8),e=t%4;for(r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++)for(var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var A=this.palette[s>>7-o&1];this.data[a+4*o]=A.blue,this.data[a+4*o+1]=A.green,this.data[a+4*o+2]=A.red,this.data[a+4*o+3]=255}e!==0&&(this.pos+=4-e)}},Kc.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),t=r%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<r;i++){var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+2*i*4,o=s>>4,A=15&s,f=this.palette[o];if(this.data[a]=f.blue,this.data[a+1]=f.green,this.data[a+2]=f.red,this.data[a+3]=255,2*i+1>=this.width)break;f=this.palette[A],this.data[a+4]=f.blue,this.data[a+4+1]=f.green,this.data[a+4+2]=f.red,this.data[a+4+3]=255}t!==0&&(this.pos+=4-t)}},Kc.prototype.bit8=function(){for(var r=this.width%4,t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*n;if(i<this.palette.length){var a=this.palette[i];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}r!==0&&(this.pos+=4-r)}},Kc.prototype.bit15=function(){for(var r=this.width%3,t=parseInt("11111",2),e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&t)/t*255|0,o=(s>>5&t)/t*255|0,A=(s>>10&t)/t*255|0,f=s>>15?255:0,m=n*this.width*4+4*i;this.data[m]=A,this.data[m+1]=o,this.data[m+2]=a,this.data[m+3]=f}this.pos+=r}},Kc.prototype.bit16=function(){for(var r=this.width%3,t=parseInt("11111",2),e=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&t)/t*255|0,A=(a>>5&e)/e*255|0,f=(a>>11)/t*255|0,m=i*this.width*4+4*s;this.data[m]=f,this.data[m+1]=A,this.data[m+2]=o,this.data[m+3]=255}this.pos+=r}},Kc.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var t=this.bottom_up?r:this.height-1-r,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*e;this.data[a]=s,this.data[a+1]=i,this.data[a+2]=n,this.data[a+3]=255}this.pos+=this.width%4}},Kc.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var t=this.bottom_up?r:this.height-1-r,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*e;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=a}},Kc.prototype.getData=function(){return this.data},function(r){r.processBMP=function(t,e,n,i){var s=new Kc(t,!1),a=s.width,o=s.height,A={data:s.getData(),width:a,height:o},f=new x2(100).encode(A,100);return r.processJPEG.call(this,f,e,n,i)}}(jr.API),XF.prototype.getData=function(){return this.data},function(r){r.processWEBP=function(t,e,n,i){var s=new XF(t),a=s.width,o=s.height,A={data:s.getData(),width:a,height:o},f=new x2(100).encode(A,100);return r.processJPEG.call(this,f,e,n,i)}}(jr.API),jr.API.processRGBA=function(r,t,e){for(var n=r.data,i=n.length,s=new Uint8Array(i/4*3),a=new Uint8Array(i/4),o=0,A=0,f=0;f<i;f+=4){var m=n[f],b=n[f+1],x=n[f+2],C=n[f+3];s[o++]=m,s[o++]=b,s[o++]=x,a[A++]=C}var M=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:M,index:t,alias:e,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},jr.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},xf=jr.API,_y=xf.getCharWidthsArray=function(r,t){var e,n,i=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),a=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:i.metadata.Unicode.widths,A=o.fof?o.fof:1,f=t.kerning?t.kerning:i.metadata.Unicode.kerning,m=f.fof?f.fof:1,b=t.doKerning!==!1,x=0,C=r.length,M=0,U=o[0]||A,N=[];for(e=0;e<C;e++)n=r.charCodeAt(e),typeof i.metadata.widthOfString=="function"?N.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+a*(1e3/s)||0)/1e3):(x=b&&On(f[n])==="object"&&!isNaN(parseInt(f[n][M],10))?f[n][M]/m:0,N.push((o[n]||U)/A+x)),M=n;return N},qF=xf.getStringUnitWidth=function(r,t){var e=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return xf.processArabic&&(r=xf.processArabic(r)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(r,e,i)/e:_y.apply(this,arguments).reduce(function(s,a){return s+a},0)},KF=function(r,t,e,n){for(var i=[],s=0,a=r.length,o=0;s!==a&&o+t[s]<e;)o+=t[s],s++;i.push(r.slice(0,s));var A=s;for(o=0;s!==a;)o+t[s]>n&&(i.push(r.slice(A,s)),o=0,A=s),o+=t[s],s++;return A!==s&&i.push(r.slice(A,s)),i},WF=function(r,t,e){e||(e={});var n,i,s,a,o,A,f,m=[],b=[m],x=e.textIndent||0,C=0,M=0,U=r.split(" "),N=_y.apply(this,[" ",e])[0];if(A=e.lineIndent===-1?U[0].length+2:e.lineIndent||0){var Q=Array(A).join(" "),q=[];U.map(function(tt){(tt=tt.split(/\s*\n/)).length>1?q=q.concat(tt.map(function(ft,pt){return(pt&&ft.length?`
`:"")+ft})):q.push(tt[0])}),U=q,A=qF.apply(this,[Q,e])}for(s=0,a=U.length;s<a;s++){var Y=0;if(n=U[s],A&&n[0]==`
`&&(n=n.substr(1),Y=1),x+C+(M=(i=_y.apply(this,[n,e])).reduce(function(tt,ft){return tt+ft},0))>t||Y){if(M>t){for(o=KF.apply(this,[n,i,t-(x+C),t]),m.push(o.shift()),m=[o.pop()];o.length;)b.push([o.shift()]);M=i.slice(n.length-(m[0]?m[0].length:0)).reduce(function(tt,ft){return tt+ft},0)}else m=[n];b.push(m),x=M+A,C=N}else m.push(n),x+=C+M,C=N}return f=A?function(tt,ft){return(ft?Q:"")+tt.join(" ")}:function(tt){return tt.join(" ")},b.map(f)},xf.splitTextToSize=function(r,t,e){var n,i=(e=e||{}).fontSize||this.internal.getFontSize(),s=(function(m){if(m.widths&&m.kerning)return{widths:m.widths,kerning:m.kerning};var b=this.internal.getFont(m.fontName,m.fontStyle);return b.metadata.Unicode?{widths:b.metadata.Unicode.widths||{0:1},kerning:b.metadata.Unicode.kerning||{}}:{font:b.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,e);n=Array.isArray(r)?r:String(r).split(/\r?\n/);var a=1*this.internal.scaleFactor*t/i;s.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=e.lineIndent;var o,A,f=[];for(o=0,A=n.length;o<A;o++)f=f.concat(WF.apply(this,[n[o],a,s]));return f},function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",e={},n={},i=0;i<t.length;i++)e[t[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=t[i];var s=function(b){return"0x"+parseInt(b,10).toString(16)},a=r.__fontmetrics__.compress=function(b){var x,C,M,U,N=["{"];for(var Q in b){if(x=b[Q],isNaN(parseInt(Q,10))?C="'"+Q+"'":(Q=parseInt(Q,10),C=(C=s(Q).slice(2)).slice(0,-1)+n[C.slice(-1)]),typeof x=="number")x<0?(M=s(x).slice(3),U="-"):(M=s(x).slice(2),U=""),M=U+M.slice(0,-1)+n[M.slice(-1)];else{if(On(x)!=="object")throw new Error("Don't know what to do with value type "+On(x)+".");M=a(x)}N.push(C+M)}return N.push("}"),N.join("")},o=r.__fontmetrics__.uncompress=function(b){if(typeof b!="string")throw new Error("Invalid argument passed to uncompress.");for(var x,C,M,U,N={},Q=1,q=N,Y=[],tt="",ft="",pt=b.length-1,mt=1;mt<pt;mt+=1)(U=b[mt])=="'"?x?(M=x.join(""),x=void 0):x=[]:x?x.push(U):U=="{"?(Y.push([q,M]),q={},M=void 0):U=="}"?((C=Y.pop())[0][C[1]]=q,M=void 0,q=C[0]):U=="-"?Q=-1:M===void 0?e.hasOwnProperty(U)?(tt+=e[U],M=parseInt(tt,16)*Q,Q=1,tt=""):tt+=U:e.hasOwnProperty(U)?(ft+=e[U],q[M]=parseInt(ft,16)*Q,Q=1,M=void 0,ft=""):ft+=U;return N},A={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:A,"Courier-Bold":A,"Courier-BoldOblique":A,"Courier-Oblique":A,Helvetica:A,"Helvetica-Bold":A,"Helvetica-BoldOblique":A,"Helvetica-Oblique":A,"Times-Roman":A,"Times-Bold":A,"Times-BoldItalic":A,"Times-Italic":A}},m={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(b){var x=b.font,C=m.Unicode[x.postScriptName];C&&(x.metadata.Unicode={},x.metadata.Unicode.widths=C.widths,x.metadata.Unicode.kerning=C.kerning);var M=f.Unicode[x.postScriptName];M&&(x.metadata.Unicode.encoding=M,x.encoding=M.codePages[0])}])}(jr.API),function(r){var t=function(e){for(var n=e.length,i=new Uint8Array(n),s=0;s<n;s++)i[s]=e.charCodeAt(s);return i};r.API.events.push(["addFont",function(e){var n=void 0,i=e.font,s=e.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Tg(o)),a.metadata=r.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(i,n)}}])}(jr),function(r){function t(){return(Vr.canvg?Promise.resolve(Vr.canvg):Promise.resolve().then(()=>J1t)).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e})}jr.API.addSvgAsImage=function(e,n,i,s,a,o,A,f){if(isNaN(n)||isNaN(i))throw ci.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(a))throw ci.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var m=document.createElement("canvas");m.width=s,m.height=a;var b=m.getContext("2d");b.fillStyle="#fff",b.fillRect(0,0,m.width,m.height);var x={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},C=this;return t().then(function(M){return M.fromString(b,e,x)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(M){return M.render(x)}).then(function(){C.addImage(m.toDataURL("image/jpeg",1),n,i,s,a,A,f)})}}(),jr.API.putTotalPages=function(r){var t,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(r,"g"),e=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(t,e);return this},jr.API.viewerPreferences=function(r,t){var e;r=r||{},t=t||!1;var n,i,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),A=[],f=0,m=0,b=0;function x(M,U){var N,Q=!1;for(N=0;N<M.length;N+=1)M[N]===U&&(Q=!0);return Q}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,r==="reset"||t===!0){var C=o.length;for(b=0;b<C;b+=1)e[o[b]].value=e[o[b]].defaultValue,e[o[b]].explicitSet=!1}if(On(r)==="object"){for(i in r)if(s=r[i],x(o,i)&&s!==void 0){if(e[i].type==="boolean"&&typeof s=="boolean")e[i].value=s;else if(e[i].type==="name"&&x(e[i].valueSet,s))e[i].value=s;else if(e[i].type==="integer"&&Number.isInteger(s))e[i].value=s;else if(e[i].type==="array"){for(f=0;f<s.length;f+=1)if(n=!0,s[f].length===1&&typeof s[f][0]=="number")A.push(String(s[f]-1));else if(s[f].length>1){for(m=0;m<s[f].length;m+=1)typeof s[f][m]!="number"&&(n=!1);n===!0&&A.push([s[f][0]-1,s[f][1]-1].join(" "))}e[i].value="["+A.join(" ")+"]"}else e[i].value=e[i].defaultValue;e[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var M,U=[];for(M in e)e[M].explicitSet===!0&&(e[M].type==="name"?U.push("/"+M+" /"+e[M].value):U.push("/"+M+" "+e[M].value));U.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+U.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=e,this},function(r){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),A=unescape(encodeURIComponent("</x:xmpmeta>")),f=s.length+a.length+o.length+i.length+A.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+f+" >>"),this.internal.write("stream"),this.internal.write(i+s+a+o+A),this.internal.write("endstream"),this.internal.write("endobj")},e=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",e),this.internal.events.subscribe("postPutResources",t)),this}}(jr.API),function(r){var t=r.API,e=t.pdfEscape16=function(s,a){for(var o,A=a.metadata.Unicode.widths,f=["","0","00","000","0000"],m=[""],b=0,x=s.length;b<x;++b){if(o=a.metadata.characterToGlyph(s.charCodeAt(b)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=s.charCodeAt(b),A.indexOf(o)==-1&&(A.push(o),A.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return m.join("");o=o.toString(16),m.push(f[4-o.length],o)}return m.join("")},n=function(s){var a,o,A,f,m,b,x;for(m=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,A=[],b=0,x=(o=Object.keys(s).sort(function(C,M){return C-M})).length;b<x;b++)a=o[b],A.length>=100&&(m+=`
`+A.length+` beginbfchar
`+A.join(`
`)+`
endbfchar`,A=[]),s[a]!==void 0&&s[a]!==null&&typeof s[a].toString=="function"&&(f=("0000"+s[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),A.push("<"+a+"><"+f+">"));return A.length&&(m+=`
`+A.length+` beginbfchar
`+A.join(`
`)+`
endbfchar
`),m+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(a){var o=a.font,A=a.out,f=a.newObject,m=a.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="Identity-H"){for(var b=o.metadata.Unicode.widths,x=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),C="",M=0;M<x.length;M++)C+=String.fromCharCode(x[M]);var U=f();m({data:C,addLength1:!0,objectId:U}),A("endobj");var N=f();m({data:n(o.metadata.toUnicode),addLength1:!0,objectId:N}),A("endobj");var Q=f();A("<<"),A("/Type /FontDescriptor"),A("/FontName /"+gf(o.fontName)),A("/FontFile2 "+U+" 0 R"),A("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),A("/Flags "+o.metadata.flags),A("/StemV "+o.metadata.stemV),A("/ItalicAngle "+o.metadata.italicAngle),A("/Ascent "+o.metadata.ascender),A("/Descent "+o.metadata.decender),A("/CapHeight "+o.metadata.capHeight),A(">>"),A("endobj");var q=f();A("<<"),A("/Type /Font"),A("/BaseFont /"+gf(o.fontName)),A("/FontDescriptor "+Q+" 0 R"),A("/W "+r.API.PDFObject.convert(b)),A("/CIDToGIDMap /Identity"),A("/DW 1000"),A("/Subtype /CIDFontType2"),A("/CIDSystemInfo"),A("<<"),A("/Supplement 0"),A("/Registry (Adobe)"),A("/Ordering ("+o.encoding+")"),A(">>"),A(">>"),A("endobj"),o.objectNumber=f(),A("<<"),A("/Type /Font"),A("/Subtype /Type0"),A("/ToUnicode "+N+" 0 R"),A("/BaseFont /"+gf(o.fontName)),A("/Encoding /"+o.encoding),A("/DescendantFonts ["+q+" 0 R]"),A(">>"),A("endobj"),o.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(a){var o=a.font,A=a.out,f=a.newObject,m=a.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var b=o.metadata.rawData,x="",C=0;C<b.length;C++)x+=String.fromCharCode(b[C]);var M=f();m({data:x,addLength1:!0,objectId:M}),A("endobj");var U=f();m({data:n(o.metadata.toUnicode),addLength1:!0,objectId:U}),A("endobj");var N=f();A("<<"),A("/Descent "+o.metadata.decender),A("/CapHeight "+o.metadata.capHeight),A("/StemV "+o.metadata.stemV),A("/Type /FontDescriptor"),A("/FontFile2 "+M+" 0 R"),A("/Flags 96"),A("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),A("/FontName /"+gf(o.fontName)),A("/ItalicAngle "+o.metadata.italicAngle),A("/Ascent "+o.metadata.ascender),A(">>"),A("endobj"),o.objectNumber=f();for(var Q=0;Q<o.metadata.hmtx.widths.length;Q++)o.metadata.hmtx.widths[Q]=parseInt(o.metadata.hmtx.widths[Q]*(1e3/o.metadata.head.unitsPerEm));A("<</Subtype/TrueType/Type/Font/ToUnicode "+U+" 0 R/BaseFont/"+gf(o.fontName)+"/FontDescriptor "+N+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),A("endobj"),o.isAlreadyPutted=!0}})(s)}]);var i=function(s){var a,o=s.text||"",A=s.x,f=s.y,m=s.options||{},b=s.mutex||{},x=b.pdfEscape,C=b.activeFontKey,M=b.fonts,U=C,N="",Q=0,q="",Y=M[U].encoding;if(M[U].encoding!=="Identity-H")return{text:o,x:A,y:f,options:m,mutex:b};for(q=o,U=C,Array.isArray(o)&&(q=o[0]),Q=0;Q<q.length;Q+=1)M[U].metadata.hasOwnProperty("cmap")&&(a=M[U].metadata.cmap.unicode.codeMap[q[Q].charCodeAt(0)]),a||q[Q].charCodeAt(0)<256&&M[U].metadata.hasOwnProperty("Unicode")?N+=q[Q]:N+="";var tt="";return parseInt(U.slice(1))<14||Y==="WinAnsiEncoding"?tt=x(N,U).split("").map(function(ft){return ft.charCodeAt(0).toString(16)}).join(""):Y==="Identity-H"&&(tt=e(N,M[U])),b.isHex=!0,{text:tt,x:A,y:f,options:m,mutex:b}};t.events.push(["postProcessText",function(s){var a=s.text||"",o=[],A={text:a,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(a)){var f=0;for(f=0;f<a.length;f+=1)Array.isArray(a[f])&&a[f].length===3?o.push([i(Object.assign({},A,{text:a[f][0]})).text,a[f][1],a[f][2]]):o.push(i(Object.assign({},A,{text:a[f]})).text);s.text=o}else s.text=i(Object.assign({},A,{text:a})).text}])}(jr),function(r){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0},r.addFileToVFS=function(e,n){return t.call(this),this.internal.vFS[e]=n,this},r.getFileFromVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0?this.internal.vFS[e]:null}}(jr.API),function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(n){var i,s,a,o,A,f,m,b=t,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],C=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],M={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},U={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},N=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Q=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),q=!1,Y=0;this.__bidiEngine__={};var tt=function(st){var ct=st.charCodeAt(),wt=ct>>8,yt=U[wt];return yt!==void 0?b[256*yt+(255&ct)]:wt===252||wt===253?"AL":Q.test(wt)?"L":wt===8?"R":"N"},ft=function(st){for(var ct,wt=0;wt<st.length;wt++){if((ct=tt(st.charAt(wt)))==="L")return!1;if(ct==="R")return!0}return!1},pt=function(st,ct,wt,yt){var te,Zt,re,Xt,ne=ct[yt];switch(ne){case"L":case"R":q=!1;break;case"N":case"AN":break;case"EN":q&&(ne="AN");break;case"AL":q=!0,ne="R";break;case"WS":ne="N";break;case"CS":yt<1||yt+1>=ct.length||(te=wt[yt-1])!=="EN"&&te!=="AN"||(Zt=ct[yt+1])!=="EN"&&Zt!=="AN"?ne="N":q&&(Zt="AN"),ne=Zt===te?Zt:"N";break;case"ES":ne=(te=yt>0?wt[yt-1]:"B")==="EN"&&yt+1<ct.length&&ct[yt+1]==="EN"?"EN":"N";break;case"ET":if(yt>0&&wt[yt-1]==="EN"){ne="EN";break}if(q){ne="N";break}for(re=yt+1,Xt=ct.length;re<Xt&&ct[re]==="ET";)re++;ne=re<Xt&&ct[re]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(Xt=ct.length,re=yt+1;re<Xt&&ct[re]==="NSM";)re++;if(re<Xt){var se=st[yt],we=se>=1425&&se<=2303||se===64286;if(te=ct[re],we&&(te==="R"||te==="AL")){ne="R";break}}}ne=yt<1||(te=ct[yt-1])==="B"?"N":wt[yt-1];break;case"B":q=!1,i=!0,ne=Y;break;case"S":s=!0,ne="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":q=!1;break;case"BN":ne="N"}return ne},mt=function(st,ct,wt){var yt=st.split("");return wt&&dt(yt,wt,{hiLevel:Y}),yt.reverse(),ct&&ct.reverse(),yt.join("")},dt=function(st,ct,wt){var yt,te,Zt,re,Xt,ne=-1,se=st.length,we=0,it=[],vt=Y?C:x,Ft=[];for(q=!1,i=!1,s=!1,te=0;te<se;te++)Ft[te]=tt(st[te]);for(Zt=0;Zt<se;Zt++){if(Xt=we,it[Zt]=pt(st,Ft,it,Zt),yt=240&(we=vt[Xt][M[it[Zt]]]),we&=15,ct[Zt]=re=vt[we][5],yt>0)if(yt===16){for(te=ne;te<Zt;te++)ct[te]=1;ne=-1}else ne=-1;if(vt[we][6])ne===-1&&(ne=Zt);else if(ne>-1){for(te=ne;te<Zt;te++)ct[te]=re;ne=-1}Ft[Zt]==="B"&&(ct[Zt]=0),wt.hiLevel|=re}s&&function(Ot,Wt,jt){for(var ae=0;ae<jt;ae++)if(Ot[ae]==="S"){Wt[ae]=Y;for(var ie=ae-1;ie>=0&&Ot[ie]==="WS";ie--)Wt[ie]=Y}}(Ft,ct,se)},Rt=function(st,ct,wt,yt,te){if(!(te.hiLevel<st)){if(st===1&&Y===1&&!i)return ct.reverse(),void(wt&&wt.reverse());for(var Zt,re,Xt,ne,se=ct.length,we=0;we<se;){if(yt[we]>=st){for(Xt=we+1;Xt<se&&yt[Xt]>=st;)Xt++;for(ne=we,re=Xt-1;ne<re;ne++,re--)Zt=ct[ne],ct[ne]=ct[re],ct[re]=Zt,wt&&(Zt=wt[ne],wt[ne]=wt[re],wt[re]=Zt);we=Xt}we++}}},Lt=function(st,ct,wt){var yt=st.split(""),te={hiLevel:Y};return wt||(wt=[]),dt(yt,wt,te),function(Zt,re,Xt){if(Xt.hiLevel!==0&&m)for(var ne,se=0;se<Zt.length;se++)re[se]===1&&(ne=N.indexOf(Zt[se]))>=0&&(Zt[se]=N[ne+1])}(yt,wt,te),Rt(2,yt,ct,wt,te),Rt(1,yt,ct,wt,te),yt.join("")};return this.__bidiEngine__.doBidiReorder=function(st,ct,wt){if(function(te,Zt){if(Zt)for(var re=0;re<te.length;re++)Zt[re]=re;o===void 0&&(o=ft(te)),f===void 0&&(f=ft(te))}(st,ct),a||!A||f)if(a&&A&&o^f)Y=o?1:0,st=mt(st,ct,wt);else if(!a&&A&&f)Y=o?1:0,st=Lt(st,ct,wt),st=mt(st,ct);else if(!a||o||A||f){if(a&&!A&&o^f)st=mt(st,ct),o?(Y=0,st=Lt(st,ct,wt)):(Y=1,st=Lt(st,ct,wt),st=mt(st,ct));else if(a&&o&&!A&&f)Y=1,st=Lt(st,ct,wt),st=mt(st,ct);else if(!a&&!A&&o^f){var yt=m;o?(Y=1,st=Lt(st,ct,wt),Y=0,m=!1,st=Lt(st,ct,wt),m=yt):(Y=0,st=Lt(st,ct,wt),st=mt(st,ct),Y=1,m=!1,st=Lt(st,ct,wt),m=yt,st=mt(st,ct))}}else Y=0,st=Lt(st,ct,wt);else Y=o?1:0,st=Lt(st,ct,wt);return st},this.__bidiEngine__.setOptions=function(st){st&&(a=st.isInputVisual,A=st.isOutputVisual,o=st.isInputRtl,f=st.isOutputRtl,m=st.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],e=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(n){var i=n.text,s=(n.x,n.y,n.options||{}),a=(n.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,e.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(a=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?a.push([e.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):a.push([e.doBidiReorder(i[o])]);n.text=a}else n.text=e.doBidiReorder(i);e.setOptions({isInputVisual:!0})}])}(jr),jr.API.TTFFont=function(){function r(t){var e;if(this.rawData=t,e=this.contents=new kA(t),this.contents.pos=4,e.readString(4)==="ttcf")throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new $et(this),this.registerTTF()}return r.open=function(t){return new r(t)},r.prototype.parse=function(){return this.directory=new Ret(this.contents),this.head=new Det(this),this.name=new zet(this),this.cmap=new JF(this),this.toUnicode={},this.hhea=new ket(this),this.maxp=new Get(this),this.hmtx=new Vet(this),this.post=new Qet(this),this.os2=new Net(this),this.loca=new Wet(this),this.glyf=new jet(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var t,e,n,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,o,A,f;for(f=[],a=0,o=(A=this.bbox).length;a<o;a++)t=A[a],f.push(Math.round(t*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(e=i>>16)&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(t){var e;return((e=this.cmap.unicode)!=null?e.codeMap[t]:void 0)||0},r.prototype.widthOfGlyph=function(t){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*e},r.prototype.widthOfString=function(t,e,n){var i,s,a,o;for(a=0,s=0,o=(t=""+t).length;0<=o?s<o:s>o;s=0<=o?++s:--s)i=t.charCodeAt(s),a+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/e)||0;return a*(e/1e3)},r.prototype.lineHeight=function(t,e){var n;return e==null&&(e=!1),n=e?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},r}();var Wc,kA=function(){function r(t){this.data=t??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(t){return this.data[this.pos++]=t},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},r.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},r.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},r.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},r.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},r.prototype.readString=function(t){var e,n;for(n=[],e=0;0<=t?e<t:e>t;e=0<=t?++e:--e)n[e]=String.fromCharCode(this.readByte());return n.join("")},r.prototype.writeString=function(t){var e,n,i;for(i=[],e=0,n=t.length;0<=n?e<n:e>n;e=0<=n?++e:--e)i.push(this.writeByte(t.charCodeAt(e)));return i},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(t){return this.writeInt16(t)},r.prototype.readLongLong=function(){var t,e,n,i,s,a,o,A;return t=this.readByte(),e=this.readByte(),n=this.readByte(),i=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),A=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^s)+65536*(255^a)+256*(255^o)+(255^A)+1):72057594037927940*t+281474976710656*e+1099511627776*n+4294967296*i+16777216*s+65536*a+256*o+A},r.prototype.writeLongLong=function(t){var e,n;return e=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(t){return this.writeInt32(t)},r.prototype.read=function(t){var e,n;for(e=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)e.push(this.readByte());return e},r.prototype.write=function(t){var e,n,i,s;for(s=[],n=0,i=t.length;n<i;n++)e=t[n],s.push(this.writeByte(e));return s},r}(),Ret=function(){var r;function t(e){var n,i,s;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)n={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(e){var n,i,s,a,o,A,f,m,b,x,C,M,U;for(U in C=Object.keys(e).length,A=Math.log(2),b=16*Math.floor(Math.log(C)/A),a=Math.floor(b/A),m=16*C-b,(i=new kA).writeInt(this.scalarType),i.writeShort(C),i.writeShort(b),i.writeShort(a),i.writeShort(m),s=16*C,f=i.pos+s,o=null,M=[],e)for(x=e[U],i.writeString(U),i.writeInt(r(x)),i.writeInt(f),i.writeInt(x.length),M=M.concat(x),U==="head"&&(o=f),f+=x.length;f%4;)M.push(0),f++;return i.write(M),n=2981146554-r(i.data),i.pos=o+8,i.writeUInt32(n),i.data},r=function(e){var n,i,s,a;for(e=ZF.call(e);e.length%4;)e.push(0);for(s=new kA(e),i=0,n=0,a=e.length;n<a;n=n+=4)i+=s.readUInt32();return 4294967295&i},t}(),Oet={}.hasOwnProperty,Wl=function(r,t){for(var e in t)Oet.call(t,e)&&(r[e]=t[e]);function n(){this.constructor=r}return n.prototype=t.prototype,r.prototype=new n,r.__super__=t.prototype,r};Wc=function(){function r(t){var e;this.file=t,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r}();var Det=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Wl(t,Wc),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new kA).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t}(),YF=function(){function r(t,e){var n,i,s,a,o,A,f,m,b,x,C,M,U,N,Q,q,Y;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=e+t.readInt(),b=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(A=0;A<256;++A)this.codeMap[A]=t.readByte();break;case 4:for(C=t.readUInt16(),x=C/2,t.pos+=6,s=function(){var tt,ft;for(ft=[],A=tt=0;0<=x?tt<x:tt>x;A=0<=x?++tt:--tt)ft.push(t.readUInt16());return ft}(),t.pos+=2,U=function(){var tt,ft;for(ft=[],A=tt=0;0<=x?tt<x:tt>x;A=0<=x?++tt:--tt)ft.push(t.readUInt16());return ft}(),f=function(){var tt,ft;for(ft=[],A=tt=0;0<=x?tt<x:tt>x;A=0<=x?++tt:--tt)ft.push(t.readUInt16());return ft}(),m=function(){var tt,ft;for(ft=[],A=tt=0;0<=x?tt<x:tt>x;A=0<=x?++tt:--tt)ft.push(t.readUInt16());return ft}(),i=(this.length-t.pos+this.offset)/2,o=function(){var tt,ft;for(ft=[],A=tt=0;0<=i?tt<i:tt>i;A=0<=i?++tt:--tt)ft.push(t.readUInt16());return ft}(),A=Q=0,Y=s.length;Q<Y;A=++Q)for(N=s[A],n=q=M=U[A];M<=N?q<=N:q>=N;n=M<=N?++q:--q)m[A]===0?a=n+f[A]:(a=o[m[A]/2+(n-M)-(x-A)]||0)!==0&&(a+=f[A]),this.codeMap[n]=65535&a}t.pos=b}return r.encode=function(t,e){var n,i,s,a,o,A,f,m,b,x,C,M,U,N,Q,q,Y,tt,ft,pt,mt,dt,Rt,Lt,st,ct,wt,yt,te,Zt,re,Xt,ne,se,we,it,vt,Ft,Ot,Wt,jt,ae,ie,Be,Te,Ne;switch(yt=new kA,a=Object.keys(t).sort(function(Qe,He){return Qe-He}),e){case"macroman":for(U=0,N=function(){var Qe=[];for(M=0;M<256;++M)Qe.push(0);return Qe}(),q={0:0},s={},te=0,ne=a.length;te<ne;te++)q[ie=t[i=a[te]]]==null&&(q[ie]=++U),s[i]={old:t[i],new:q[t[i]]},N[i]=q[t[i]];return yt.writeUInt16(1),yt.writeUInt16(0),yt.writeUInt32(12),yt.writeUInt16(0),yt.writeUInt16(262),yt.writeUInt16(0),yt.write(N),{charMap:s,subtable:yt.data,maxGlyphID:U+1};case"unicode":for(ct=[],b=[],Y=0,q={},n={},Q=f=null,Zt=0,se=a.length;Zt<se;Zt++)q[ft=t[i=a[Zt]]]==null&&(q[ft]=++Y),n[i]={old:ft,new:q[ft]},o=q[ft]-i,Q!=null&&o===f||(Q&&b.push(Q),ct.push(i),f=o),Q=i;for(Q&&b.push(Q),b.push(65535),ct.push(65535),Lt=2*(Rt=ct.length),dt=2*Math.pow(Math.log(Rt)/Math.LN2,2),x=Math.log(dt/2)/Math.LN2,mt=2*Rt-dt,A=[],pt=[],C=[],M=re=0,we=ct.length;re<we;M=++re){if(st=ct[M],m=b[M],st===65535){A.push(0),pt.push(0);break}if(st-(wt=n[st].new)>=32768)for(A.push(0),pt.push(2*(C.length+Rt-M)),i=Xt=st;st<=m?Xt<=m:Xt>=m;i=st<=m?++Xt:--Xt)C.push(n[i].new);else A.push(wt-st),pt.push(0)}for(yt.writeUInt16(3),yt.writeUInt16(1),yt.writeUInt32(12),yt.writeUInt16(4),yt.writeUInt16(16+8*Rt+2*C.length),yt.writeUInt16(0),yt.writeUInt16(Lt),yt.writeUInt16(dt),yt.writeUInt16(x),yt.writeUInt16(mt),jt=0,it=b.length;jt<it;jt++)i=b[jt],yt.writeUInt16(i);for(yt.writeUInt16(0),ae=0,vt=ct.length;ae<vt;ae++)i=ct[ae],yt.writeUInt16(i);for(Be=0,Ft=A.length;Be<Ft;Be++)o=A[Be],yt.writeUInt16(o);for(Te=0,Ot=pt.length;Te<Ot;Te++)tt=pt[Te],yt.writeUInt16(tt);for(Ne=0,Wt=C.length;Ne<Wt;Ne++)U=C[Ne],yt.writeUInt16(U);return{charMap:n,subtable:yt.data,maxGlyphID:Y+1}}},r}(),JF=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Wl(t,Wc),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,i,s;for(e.pos=this.offset,this.version=e.readUInt16(),s=e.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=s?i<s:i>s;i=0<=s?++i:--i)n=new YF(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var i,s;return n==null&&(n="macroman"),i=YF.encode(e,n),(s=new kA).writeUInt16(0),s.writeUInt16(1),i.table=s.data.concat(i.subtable),i},t}(),ket=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Wl(t,Wc),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),Net=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Wl(t,Wc),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(e.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(e.readInt());return i}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(e.readInt());return i}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),Qet=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Wl(t,Wc),t.prototype.tag="post",t.prototype.parse=function(e){var n,i,s;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:break;case 131072:var a;for(i=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],s=[];e.pos<this.offset+this.length;)n=e.readByte(),s.push(this.names.push(e.readString(n)));return s;case 151552:return i=e.readUInt16(),this.offsets=e.read(i);case 196608:break;case 262144:return this.map=(function(){var o,A,f;for(f=[],a=o=0,A=this.file.maxp.numGlyphs;0<=A?o<A:o>A;a=0<=A?++o:--o)f.push(e.readUInt32());return f}).call(this)}},t}(),Het=function(r,t){this.raw=r,this.length=r.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},zet=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Wl(t,Wc),t.prototype.tag="name",t.prototype.parse=function(e){var n,i,s,a,o,A,f,m,b,x,C;for(e.pos=this.offset,e.readShort(),n=e.readShort(),A=e.readShort(),i=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)i.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+A+e.readShort()});for(f={},a=b=0,x=i.length;b<x;a=++b)s=i[a],e.pos=s.offset,m=e.readString(s.length),o=new Het(m,s),f[C=s.nameID]==null&&(f[C]=[]),f[s.nameID].push(o);this.strings=f,this.copyright=f[0],this.fontFamily=f[1],this.fontSubfamily=f[2],this.uniqueSubfamily=f[3],this.fontName=f[4],this.version=f[5];try{this.postscriptName=f[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=f[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=f[7],this.manufacturer=f[8],this.designer=f[9],this.description=f[10],this.vendorUrl=f[11],this.designerUrl=f[12],this.license=f[13],this.licenseUrl=f[14],this.preferredFamily=f[15],this.preferredSubfamily=f[17],this.compatibleFull=f[18],this.sampleText=f[19]},t}(),Get=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Wl(t,Wc),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),Vet=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Wl(t,Wc),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,i,s,a,o,A,f;for(e.pos=this.offset,this.metrics=[],n=0,A=this.file.hhea.numberOfMetrics;0<=A?n<A:n>A;n=0<=A?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var m,b;for(b=[],n=m=0;0<=s?m<s:m>s;n=0<=s?++m:--m)b.push(e.readInt16());return b}(),this.widths=(function(){var m,b,x,C;for(C=[],m=0,b=(x=this.metrics).length;m<b;m++)a=x[m],C.push(a.advance);return C}).call(this),i=this.widths[this.widths.length-1],f=[],n=o=0;0<=s?o<s:o>s;n=0<=s?++o:--o)f.push(this.widths.push(i));return f},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),ZF=[].slice,jet=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Wl(t,Wc),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,i,s,a,o,A,f,m,b,x;return e in this.cache?this.cache[e]:(a=this.file.loca,n=this.file.contents,i=a.indexOf(e),(s=a.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+i,o=(A=new kA(n.read(s))).readShort(),m=A.readShort(),x=A.readShort(),f=A.readShort(),b=A.readShort(),this.cache[e]=o===-1?new Ket(A,m,x,f,b):new qet(A,o,m,x,f,b),this.cache[e]))},t.prototype.encode=function(e,n,i){var s,a,o,A,f;for(o=[],a=[],A=0,f=n.length;A<f;A++)s=e[n[A]],a.push(o.length),s&&(o=o.concat(s.encode(i)));return a.push(o.length),{table:o,offsets:a}},t}(),qet=function(){function r(t,e,n,i,s,a){this.raw=t,this.numberOfContours=e,this.xMin=n,this.yMin=i,this.xMax=s,this.yMax=a,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r}(),Ket=function(){function r(t,e,n,i,s){var a,o;for(this.raw=t,this.xMin=e,this.yMin=n,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return r.prototype.encode=function(){var t,e,n;for(e=new kA(ZF.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)e.pos=this.glyphOffsets[t];return e.data},r}(),Wet=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return Wl(t,Wc),t.prototype.tag="loca",t.prototype.parse=function(e){var n,i;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var s,a;for(a=[],i=0,s=this.length;i<s;i+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],i=0,s=this.length;i<s;i+=4)a.push(e.readUInt32());return a}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var i=new Uint32Array(this.offsets.length),s=0,a=0,o=0;o<i.length;++o)if(i[o]=s,a<n.length&&n[a]==o){++a,i[o]=s;var A=this.offsets[o],f=this.offsets[o+1]-A;f>0&&(s+=f)}for(var m=new Array(4*i.length),b=0;b<i.length;++b)m[4*b+3]=255&i[b],m[4*b+2]=(65280&i[b])>>8,m[4*b+1]=(16711680&i[b])>>16,m[4*b]=(4278190080&i[b])>>24;return m},t}(),$et=function(){function r(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var t,e,n,i,s;for(e in i=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[e],t[e]=i[n];return t},r.prototype.glyphsFor=function(t){var e,n,i,s,a,o,A;for(i={},a=0,o=t.length;a<o;a++)i[s=t[a]]=this.font.glyf.glyphFor(s);for(s in e=[],i)(n=i[s])!=null&&n.compound&&e.push.apply(e,n.glyphIDs);if(e.length>0)for(s in A=this.glyphsFor(e))n=A[s],i[s]=n;return i},r.prototype.encode=function(t,e){var n,i,s,a,o,A,f,m,b,x,C,M,U,N,Q;for(i in n=JF.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(t),C={0:0},Q=n.charMap)C[(A=Q[i]).old]=A.new;for(M in x=n.maxGlyphID,a)M in C||(C[M]=x++);return m=function(q){var Y,tt;for(Y in tt={},q)tt[q[Y]]=Y;return tt}(C),b=Object.keys(m).sort(function(q,Y){return q-Y}),U=function(){var q,Y,tt;for(tt=[],q=0,Y=b.length;q<Y;q++)o=b[q],tt.push(m[o]);return tt}(),s=this.font.glyf.encode(a,U,C),f=this.font.loca.encode(s.offsets,U),N={cmap:this.font.cmap.raw(),glyf:s.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(N["OS/2"]=this.font.os2.raw()),this.font.directory.encode(N)},r}();jr.API.PDFObject=function(){var r;function t(){}return r=function(e,n){return(Array(n+1).join("0")+e).slice(-n)},t.convert=function(e){var n,i,s,a;if(Array.isArray(e))return"["+function(){var o,A,f;for(f=[],o=0,A=e.length;o<A;o++)n=e[o],f.push(t.convert(n));return f}().join(" ")+"]";if(typeof e=="string")return"/"+e;if(e!=null&&e.isString)return"("+e+")";if(e instanceof Date)return"(D:"+r(e.getUTCFullYear(),4)+r(e.getUTCMonth(),2)+r(e.getUTCDate(),2)+r(e.getUTCHours(),2)+r(e.getUTCMinutes(),2)+r(e.getUTCSeconds(),2)+"Z)";if({}.toString.call(e)==="[object Object]"){for(i in s=["<<"],e)a=e[i],s.push("/"+i+" "+t.convert(a));return s.push(">>"),s.join(`
`)}return""+e},t}();const B2={"circle-radius":8,"circle-color":"red","circle-stroke-width":1,"circle-stroke-color":"black"};let Xet=class{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qh.A4,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:300,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Uu.PNG,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:ff.mm,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"map",o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:"maplibregl-marker",A=arguments.length>7&&arguments[7]!==void 0?arguments[7]:B2;Vn(this,"map"),Vn(this,"width"),Vn(this,"height"),Vn(this,"dpi"),Vn(this,"format"),Vn(this,"unit"),Vn(this,"fileName"),Vn(this,"markerClassName"),Vn(this,"markerCirclePaint"),this.map=t,this.width=e[0],this.height=e[1],this.dpi=n,this.format=i,this.unit=s,this.fileName=a,this.markerClassName=o,this.markerCirclePaint=A}renderMapPost(t){return t}getMarkers(){return this.map.getCanvasContainer().getElementsByClassName(this.markerClassName)}renderMarkers(t){const e=this.getMarkers();for(let n=0;n<e.length;n++){const i=e.item(n);if(!i)continue;const s=i.getAttribute("style");if(!s)continue;const a=/translate\(([^,]+)px,\s*([^,]+)px\)/,o=s.match(a);if(!o)continue;const A=parseInt(o[1]),f=parseInt(o[2]),m=this.map.unproject([A,f]),b=`point${n}`;t.addSource(b,{type:"geojson",data:{type:"Point",coordinates:[m.lng,m.lat]}}),t.addLayer({id:b,source:b,type:"circle",paint:this.markerCirclePaint})}return t}generate(){const t=this;JsLoadingOverlay.show({overlayBackgroundColor:"#5D5959",overlayOpacity:"0.6",spinnerIcon:"ball-spin",spinnerColor:"#2400FD",spinnerSize:"2x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetX:0,offsetY:0,containerID:null,lockScroll:!1,overlayZIndex:9998,spinnerZIndex:9999});const e=window.devicePixelRatio;Object.defineProperty(window,"devicePixelRatio",{get(){return t.dpi/96}});const n=document.createElement("div");n.className="hidden-map",document.body.appendChild(n);const i=document.createElement("div");i.style.width=this.toPixels(this.width),i.style.height=this.toPixels(this.height),n.appendChild(i);const s=this.map.getStyle();if(s&&s.sources){const o=s.sources;Object.keys(o).forEach(A=>{const f=o[A];Object.keys(f).forEach(m=>{f[m]||delete f[m]})})}let a=this.getRenderedMap(i,s);a.once("idle",()=>{a=this.renderMapPost(a),this.getMarkers().length===0?this.exportImage(a,n,e):(a=this.renderMarkers(a),a.once("idle",()=>{this.exportImage(a,n,e)}))})}exportImage(t,e,n){var i;const s=t.getCanvas(),a=`${this.fileName}.${this.format}`;switch(this.format){case Uu.PNG:this.toPNG(s,a);break;case Uu.JPEG:this.toJPEG(s,a);break;case Uu.PDF:this.toPDF(t,a);break;case Uu.SVG:this.toSVG(s,a);break;default:console.error(`Invalid file format: ${this.format}`);break}t.remove(),(i=e.parentNode)==null||i.removeChild(e),Object.defineProperty(window,"devicePixelRatio",{get(){return n}}),e.remove(),JsLoadingOverlay.hide()}toPNG(t,e){const n=document.createElement("a");n.href=t.toDataURL(),n.download=e,n.click(),n.remove()}toJPEG(t,e){const n=t.toDataURL("image/jpeg",.85),i=document.createElement("a");i.href=n,i.download=e,i.click(),i.remove()}toPDF(t,e){const n=t.getCanvas(),i=new jr({orientation:this.width>this.height?"l":"p",unit:this.unit,compress:!0,format:[this.width,this.height]});i.addImage(n.toDataURL("image/png"),"png",0,0,this.width,this.height,void 0,"FAST");const{lng:s,lat:a}=t.getCenter();i.setProperties({title:t.getStyle().name,subject:`center: [${s}, ${a}], zoom: ${t.getZoom()}`,creator:"Mapbox GL Export Plugin",author:"(c)Mapbox, (c)OpenStreetMap"}),i.save(e)}toSVG(t,e){const n=t.toDataURL("image/png"),i=Number(this.toPixels(this.width,this.dpi).replace("px","")),s=Number(this.toPixels(this.height,this.dpi).replace("px","")),a=`
    <svg xmlns="http://www.w3.org/2000/svg" 
      xmlns:xlink="http://www.w3.org/1999/xlink" 
      version="1.1" 
      width="${i}" 
      height="${s}" 
      viewBox="0 0 ${i} ${s}" 
      xml:space="preserve">
        <image style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(0,0,0); fill-rule: nonzero; opacity: 1;"  
      xlink:href="${n}" width="${i}" height="${s}"></image>
    </svg>`,o=document.createElement("a");o.href=`data:application/xml,${encodeURIComponent(a)}`,o.download=e,o.click(),o.remove()}toPixels(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:96;return this.unit===ff.mm&&(e/=25.4),`${e*t}px`}},Yet=class extends Xet{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qh.A4,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:300,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Uu.PNG,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:ff.mm,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"map",o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:B2;super(t,e,n,i,s,a,"maplibregl-marker",o)}getRenderedMap(t,e){const n=new zE.Map({container:t,style:e,center:this.map.getCenter(),zoom:this.map.getZoom(),bearing:this.map.getBearing(),pitch:this.map.getPitch(),interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,attributionControl:!1,transformRequest:this.map._requestManager._transformRequestFn});this.map.getTerrain()&&(n.setMaxPitch(85),n.setPitch(this.map.getPitch()));const i=(this.map.style.imageManager||{}).images||[];return Object.keys(i).forEach(s=>{n.addImage(s,i[s].data)}),n}renderMapPost(t){const e=this.map.getTerrain();return e&&t.setTerrain({source:e.source,exaggeration:e.exaggeration}),t}},Jet=class{constructor(t){Vn(this,"controlContainer"),Vn(this,"exportContainer"),Vn(this,"crosshair"),Vn(this,"printableArea"),Vn(this,"map"),Vn(this,"exportButton"),Vn(this,"options",{PageSize:Qh.A4,PageOrientation:xg.Landscape,Format:Uu.PDF,DPI:r2[300],Crosshair:!1,PrintableArea:!1,Local:"en",AllowedSizes:Object.keys(Qh),Filename:"map",markerCirclePaint:B2}),Vn(this,"MAPLIB_CSS_PREFIX","maplibregl"),t&&(this.options=Object.assign(this.options,t)),this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}getTranslation(){const t=this.options.Local??"en";return Xtt(t)}onAdd(t){var e;this.map=t,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add(`${this.MAPLIB_CSS_PREFIX}-ctrl`),this.controlContainer.classList.add(`${this.MAPLIB_CSS_PREFIX}-ctrl-group`),this.exportContainer=document.createElement("div"),this.exportContainer.classList.add(`${this.MAPLIB_CSS_PREFIX}-export-list`),this.exportButton=document.createElement("button"),this.exportButton.classList.add(`${this.MAPLIB_CSS_PREFIX}-ctrl-icon`),this.exportButton.classList.add(`${this.MAPLIB_CSS_PREFIX}-export-control`),this.exportButton.type="button",this.exportButton.addEventListener("click",()=>{this.exportButton.style.display="none",this.exportContainer.style.display="block",this.toggleCrosshair(!0),this.togglePrintableArea(!0)}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.exportButton),this.controlContainer.appendChild(this.exportContainer);const n=document.createElement("TABLE");n.className="print-table";const i={};(e=this.options.AllowedSizes)==null||e.forEach(m=>{Qh[m]&&(i[m]=Qh[m])});const s=this.createSelection(i,this.getTranslation().PageSize,"page-size",this.options.PageSize,(m,b)=>JSON.stringify(m[b]));n.appendChild(s);const a=this.createSelection(xg,this.getTranslation().PageOrientation,"page-orientation",this.options.PageOrientation,(m,b)=>m[b]);n.appendChild(a);const o=this.createSelection(Uu,this.getTranslation().Format,"format-type",this.options.Format,(m,b)=>m[b]);n.appendChild(o);const A=this.createSelection(r2,this.getTranslation().DPI,"dpi-type",this.options.DPI,(m,b)=>m[b]);n.appendChild(A),this.exportContainer.appendChild(n);const f=document.createElement("button");return f.type="button",f.textContent=this.getTranslation().Generate,f.classList.add("generate-button"),f.addEventListener("click",()=>{const m=document.getElementById("mapbox-gl-export-page-size"),b=document.getElementById("mapbox-gl-export-page-orientation"),x=document.getElementById("mapbox-gl-export-format-type"),C=document.getElementById("mapbox-gl-export-dpi-type"),M=b.value;let U=JSON.parse(m.value);M===xg.Portrait&&(U=U.reverse()),this.generateMap(t,U,Number(C.value),x.value,ff.mm,this.options.Filename)}),this.exportContainer.appendChild(f),this.controlContainer}generateMap(t,e,n,i,s,a){new Yet(t,e,n,i,s,a,this.options.markerCirclePaint).generate()}createSelection(t,e,n,i,s){const a=document.createElement("label");a.textContent=e;const o=document.createElement("select");o.setAttribute("id",`mapbox-gl-export-${n}`),o.style.width="100%",Object.keys(t).forEach(b=>{const x=document.createElement("option");x.setAttribute("value",s(t,b)),x.appendChild(document.createTextNode(b)),x.setAttribute("name",n),i===t[b]&&(x.selected=!0),o.appendChild(x)}),o.addEventListener("change",()=>{this.updatePrintableArea()});const A=document.createElement("TR"),f=document.createElement("TD"),m=document.createElement("TD");return f.appendChild(a),m.appendChild(o),A.appendChild(f),A.appendChild(m),A}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.exportButton||(this.exportButton.removeEventListener("click",this.onDocumentClick),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0),this.printableArea!==void 0&&(this.printableArea.destroy(),this.printableArea=void 0),this.map=void 0)}onDocumentClick(t){this.controlContainer&&!this.controlContainer.contains(t.target)&&this.exportContainer&&this.exportButton&&(this.exportContainer.style.display="none",this.exportButton.style.display="block",this.toggleCrosshair(!1),this.togglePrintableArea(!1))}toggleCrosshair(t){this.options.Crosshair===!0&&(t===!1?this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0):(this.crosshair=new ktt(this.map),this.crosshair.create()))}togglePrintableArea(t){this.options.PrintableArea===!0&&(t===!1?this.printableArea!==void 0&&(this.printableArea.destroy(),this.printableArea=void 0):(this.printableArea=new Ntt(this.map),this.updatePrintableArea()))}updatePrintableArea(){if(this.printableArea===void 0)return;const t=document.getElementById("mapbox-gl-export-page-size"),e=document.getElementById("mapbox-gl-export-page-orientation").value;let n=JSON.parse(t.value);e===xg.Portrait&&(n=n.reverse()),this.printableArea.updateArea(n[0],n[1])}};var t4=trt,Zet=Object.prototype.hasOwnProperty;function trt(){for(var r={},t=0;t<arguments.length;t++){var e=arguments[t];for(var n in e)Zet.call(e,n)&&(r[n]=e[n])}return r}var e4={exports:{}};(function(r,t){(function(){var e={};r.exports=e,e.simpleFilter=function(n,i){return i.filter(function(s){return e.test(n,s)})},e.test=function(n,i){return e.match(n,i)!==null},e.match=function(n,i,s){s=s||{};var a=0,o=[],A=i.length,f=0,m=0,b=s.pre||"",x=s.post||"",C=s.caseSensitive&&i||i.toLowerCase(),M;n=s.caseSensitive&&n||n.toLowerCase();for(var U=0;U<A;U++)M=i[U],C[U]===n[a]?(M=b+M+x,a+=1,m+=1+m):m=0,f+=m,o[o.length]=M;return a===n.length?(f=C===n?1/0:f,{rendered:o.join(""),score:f}):null},e.filter=function(n,i,s){return!i||i.length===0?[]:typeof n!="string"?i:(s=s||{},i.reduce(function(a,o,A,f){var m=o;s.extract&&(m=s.extract(o));var b=e.match(n,m,s);return b!=null&&(a[a.length]={string:b.rendered,score:b.score,index:A,original:o}),a},[]).sort(function(a,o){var A=o.score-a.score;return A||a.index-o.index}))}})()})(e4);var ert=e4.exports,Aa=function(r){return this.component=r,this.items=[],this.active=r.options.noInitialSelection?-1:0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,r.el.parentNode.insertBefore(this.wrapper,r.el.nextSibling),this};Aa.prototype.show=function(){this.element.style.display="block"},Aa.prototype.hide=function(){this.element.style.display="none"},Aa.prototype.add=function(r){this.items.push(r)},Aa.prototype.clear=function(){this.items=[],this.active=this.component.options.noInitialSelection?-1:0},Aa.prototype.isEmpty=function(){return!this.items.length},Aa.prototype.isVisible=function(){return this.element.style.display==="block"},Aa.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var r=0;r<this.items.length;r++)this.drawItem(this.items[r],this.active===r);this.show()},Aa.prototype.drawItem=function(r,t){var e=document.createElement("li"),n=document.createElement("a");t&&(e.className+=" active"),n.innerHTML=r.string,e.appendChild(n),this.element.appendChild(e),e.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),e.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,r)}).bind(this))},Aa.prototype.handleMouseUp=function(r){this.selectingListItem=!1,this.component.value(r.original),this.clear(),this.draw()},Aa.prototype.move=function(r){this.active=r,this.draw()},Aa.prototype.previous=function(){this.move(this.active<=0?this.items.length-1:this.active-1)},Aa.prototype.next=function(){this.move(this.active>=this.items.length-1?0:this.active+1)},Aa.prototype.drawError=function(r){var t=document.createElement("li");t.innerHTML=r,this.element.appendChild(t),this.show()};var rrt=Aa,nrt=t4,irt=ert,srt=rrt,po=function(r,t,e){return e=e||{},this.options=nrt({minLength:2,limit:5,filter:!0,hideOnBlur:!0,noInitialSelection:!0},e),this.el=r,this.data=t||[],this.list=new srt(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(n){this.handleKeyUp(n.keyCode,n)}).bind(this),!1),this.el.addEventListener("keydown",(function(n){this.handleKeyDown(n)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(n){this.handlePaste(n)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};po.prototype.handleKeyUp=function(r,t){if(!(r===40||r===38||r===27||r===9)){if(r===13){this.list.items[this.list.active]&&(this.list.handleMouseUp(this.list.items[this.list.active]),t.stopPropagation());return}this.handleInputChange(this.el.value)}},po.prototype.handleKeyDown=function(r){switch(r.keyCode){case 13:this.list.active>=0&&(this.list.selectingListItem=!0);break;case 9:this.list.isEmpty()||(this.list.isVisible()&&r.preventDefault(),this.value(this.list.active>=0?this.list.items[this.list.active].original:null),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}},po.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},po.prototype.handlePaste=function(r){if(r.clipboardData)this.handleInputChange(r.clipboardData.getData("Text"));else{var t=this;setTimeout(function(){t.handleInputChange(r.target.value)},100)}},po.prototype.handleInputChange=function(r){if(this.query=this.normalize(r),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(t){for(var e=0;e<t.length&&(this.list.add(t[e]),e!==this.options.limit-1);e++);this.list.draw()}).bind(this))},po.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},po.prototype.update=function(r){this.data=r,this.handleKeyUp()},po.prototype.clear=function(){this.data=[],this.list.clear()},po.prototype.normalize=function(r){return r=r.toLowerCase(),r},po.prototype.match=function(r,t){return r.indexOf(t)>-1},po.prototype.value=function(r){if(this.selected=r,this.el.value=this.getItemValue(r||{place_name:this.query}),document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this.el.dispatchEvent(t)}else this.el.fireEvent("onchange")},po.prototype.getCandidates=function(r){var t={pre:"<strong>",post:"</strong>",extract:(function(n){return this.getItemValue(n)}).bind(this)},e;this.options.filter?(e=irt.filter(this.query,this.data,t),e=e.map((function(n){return{original:n.original,string:this.render(n.original,n.string)}}).bind(this))):e=this.data.map((function(n){var i=this.render(n);return{original:n,string:i}}).bind(this)),r(e)},po.prototype.getItemValue=function(r){return r},po.prototype.render=function(r,t){if(t)return t;for(var e=r.original?this.getItemValue(r.original):this.getItemValue(r),n=this.normalize(e),i=n.lastIndexOf(this.query);i>-1;){var s=i+this.query.length;e=e.slice(0,i)+"<strong>"+e.slice(i,s)+"</strong>"+e.slice(s),i=n.slice(0,i).lastIndexOf(this.query)}return e},po.prototype.renderError=function(r){this.list.drawError(r)};var ort=po,r4=ort,art=r4;typeof window<"u"&&(window.Suggestions=r4);var crt="Expected a function",n4=NaN,lrt="[object Symbol]",urt=/^\s+|\s+$/g,Art=/^[-+]0x[0-9a-f]+$/i,hrt=/^0b[01]+$/i,drt=/^0o[0-7]+$/i,frt=parseInt,prt=typeof Ld=="object"&&Ld&&Ld.Object===Object&&Ld,grt=typeof self=="object"&&self&&self.Object===Object&&self,mrt=prt||grt||Function("return this")(),yrt=Object.prototype,_rt=yrt.toString,vrt=Math.max,brt=Math.min,C2=function(){return mrt.Date.now()};function wrt(r,t,e){var n,i,s,a,o,A,f=0,m=!1,b=!1,x=!0;if(typeof r!="function")throw new TypeError(crt);t=i4(t)||0,E2(e)&&(m=!!e.leading,b="maxWait"in e,s=b?vrt(i4(e.maxWait)||0,t):s,x="trailing"in e?!!e.trailing:x);function C(pt){var mt=n,dt=i;return n=i=void 0,f=pt,a=r.apply(dt,mt),a}function M(pt){return f=pt,o=setTimeout(Q,t),m?C(pt):a}function U(pt){var mt=pt-A,dt=pt-f,Rt=t-mt;return b?brt(Rt,s-dt):Rt}function N(pt){var mt=pt-A,dt=pt-f;return A===void 0||mt>=t||mt<0||b&&dt>=s}function Q(){var pt=C2();if(N(pt))return q(pt);o=setTimeout(Q,U(pt))}function q(pt){return o=void 0,x&&n?C(pt):(n=i=void 0,a)}function Y(){o!==void 0&&clearTimeout(o),f=0,n=A=i=o=void 0}function tt(){return o===void 0?a:q(C2())}function ft(){var pt=C2(),mt=N(pt);if(n=arguments,i=this,A=pt,mt){if(o===void 0)return M(A);if(b)return o=setTimeout(Q,t),C(A)}return o===void 0&&(o=setTimeout(Q,t)),a}return ft.cancel=Y,ft.flush=tt,ft}function E2(r){var t=typeof r;return!!r&&(t=="object"||t=="function")}function xrt(r){return!!r&&typeof r=="object"}function Brt(r){return typeof r=="symbol"||xrt(r)&&_rt.call(r)==lrt}function i4(r){if(typeof r=="number")return r;if(Brt(r))return n4;if(E2(r)){var t=typeof r.valueOf=="function"?r.valueOf():r;r=E2(t)?t+"":t}if(typeof r!="string")return r===0?r:+r;r=r.replace(urt,"");var e=hrt.test(r);return e||drt.test(r)?frt(r.slice(2),e?2:8):Art.test(r)?n4:+r}var Crt=wrt,S2={exports:{}},Bf=typeof Reflect=="object"?Reflect:null,s4=Bf&&typeof Bf.apply=="function"?Bf.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)},vy;Bf&&typeof Bf.ownKeys=="function"?vy=Bf.ownKeys:Object.getOwnPropertySymbols?vy=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:vy=function(t){return Object.getOwnPropertyNames(t)};function Ert(r){console&&console.warn&&console.warn(r)}var o4=Number.isNaN||function(t){return t!==t};function ri(){ri.init.call(this)}S2.exports=ri,S2.exports.once=Lrt,ri.EventEmitter=ri,ri.prototype._events=void 0,ri.prototype._eventsCount=0,ri.prototype._maxListeners=void 0;var a4=10;function by(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(ri,"defaultMaxListeners",{enumerable:!0,get:function(){return a4},set:function(r){if(typeof r!="number"||r<0||o4(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");a4=r}}),ri.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ri.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||o4(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function c4(r){return r._maxListeners===void 0?ri.defaultMaxListeners:r._maxListeners}ri.prototype.getMaxListeners=function(){return c4(this)},ri.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var A=s[t];if(A===void 0)return!1;if(typeof A=="function")s4(A,this,e);else for(var f=A.length,m=d4(A,f),n=0;n<f;++n)s4(m[n],this,e);return!0};function l4(r,t,e,n){var i,s,a;if(by(e),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",t,e.listener?e.listener:e),s=r._events),a=s[t]),a===void 0)a=s[t]=e,++r._eventsCount;else if(typeof a=="function"?a=s[t]=n?[e,a]:[a,e]:n?a.unshift(e):a.push(e),i=c4(r),i>0&&a.length>i&&!a.warned){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=r,o.type=t,o.count=a.length,Ert(o)}return r}ri.prototype.addListener=function(t,e){return l4(this,t,e,!1)},ri.prototype.on=ri.prototype.addListener,ri.prototype.prependListener=function(t,e){return l4(this,t,e,!0)};function Srt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u4(r,t,e){var n={fired:!1,wrapFn:void 0,target:r,type:t,listener:e},i=Srt.bind(n);return i.listener=e,n.wrapFn=i,i}ri.prototype.once=function(t,e){return by(e),this.on(t,u4(this,t,e)),this},ri.prototype.prependOnceListener=function(t,e){return by(e),this.prependListener(t,u4(this,t,e)),this},ri.prototype.removeListener=function(t,e){var n,i,s,a,o;if(by(e),i=this._events,i===void 0)return this;if(n=i[t],n===void 0)return this;if(n===e||n.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if(typeof n!="function"){for(s=-1,a=n.length-1;a>=0;a--)if(n[a]===e||n[a].listener===e){o=n[a].listener,s=a;break}if(s<0)return this;s===0?n.shift():Trt(n,s),n.length===1&&(i[t]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",t,o||e)}return this},ri.prototype.off=ri.prototype.removeListener,ri.prototype.removeAllListeners=function(t){var e,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var s=Object.keys(n),a;for(i=0;i<s.length;++i)a=s[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=n[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this};function A4(r,t,e){var n=r._events;if(n===void 0)return[];var i=n[t];return i===void 0?[]:typeof i=="function"?e?[i.listener||i]:[i]:e?Irt(i):d4(i,i.length)}ri.prototype.listeners=function(t){return A4(this,t,!0)},ri.prototype.rawListeners=function(t){return A4(this,t,!1)},ri.listenerCount=function(r,t){return typeof r.listenerCount=="function"?r.listenerCount(t):h4.call(r,t)},ri.prototype.listenerCount=h4;function h4(r){var t=this._events;if(t!==void 0){var e=t[r];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}ri.prototype.eventNames=function(){return this._eventsCount>0?vy(this._events):[]};function d4(r,t){for(var e=new Array(t),n=0;n<t;++n)e[n]=r[n];return e}function Trt(r,t){for(;t+1<r.length;t++)r[t]=r[t+1];r.pop()}function Irt(r){for(var t=new Array(r.length),e=0;e<t.length;++e)t[e]=r[e].listener||r[e];return t}function Lrt(r,t){return new Promise(function(e,n){function i(a){r.removeListener(t,s),n(a)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",i),e([].slice.call(arguments))}f4(r,t,s,{once:!0}),t!=="error"&&Frt(r,i,{once:!0})})}function Frt(r,t,e){typeof r.on=="function"&&f4(r,"error",t,e)}function f4(r,t,e,n){if(typeof r.on=="function")n.once?r.once(t,e):r.on(t,e);else if(typeof r.addEventListener=="function")r.addEventListener(t,function i(s){n.once&&r.removeEventListener(t,i),e(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var p4=S2.exports,Mrt={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}},Prt={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"",ja:"",lv:"Meklt",pt:"Procurar",sr:"",zh:"",cs:"Vyhledvn",hu:"Keress",ka:"",nb:"Ske",sk:"Vyhadvanie",th:"",fi:"Hae",is:"Leita",ko:"",pl:"Szukaj",sl:"Iskanje",fa:"",ru:""},Urt={placeholder:Prt},g4={exports:{}};(function(r){(function(t,e,n){r.exports?r.exports=n():t[e]=n()})(Ld,"subtag",function(){var t="",e=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function n(A){return A.match(e)||[]}function i(A){return n(A).filter(function(f,m){return f&&m})}function s(A){return A=n(A),{language:A[1]||t,extlang:A[2]||t,script:A[3]||t,region:A[4]||t}}function a(A,f,m){Object.defineProperty(A,f,{value:m,enumerable:!0})}function o(A,f,m){function b(x){return n(x)[A]||t}a(b,"pattern",f),a(s,m,b)}return o(1,/^[a-zA-Z]{2,3}$/,"language"),o(2,/^[a-zA-Z]{3}$/,"extlang"),o(3,/^[a-zA-Z]{4}$/,"script"),o(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),a(s,"split",i),s})})(g4);var Rrt=g4.exports,Ort=art,Drt=Crt,Oa=t4,krt=p4.EventEmitter,m4=Mrt,Nrt=Urt,Qrt=Rrt;function y4(r,t){this._eventEmitter=new krt,this.options=Oa({},this.options,t),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geocoderApi=r}y4.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,showResultsWhileTyping:!1,minLength:2,reverseGeocode:!1,limit:5,enableEventLogging:!0,marker:!0,popup:!1,maplibregl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,getItemValue:function(r){return r.text!==void 0?r.text:r.place_name},render:function(r){if(r.geometry){var o=r.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--result maplibregl-ctrl-geocoder--result"><svg class="mapboxgl-ctrl-geocoder--result-icon maplibre-ctrl-geocoder--result-icon" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36571 0 0 5.38676 0 12.0471C0 21.0824 12 32 12 32C12 32 24 21.0824 24 12.0471C24 5.38676 18.6343 0 12 0ZM12 16.3496C9.63428 16.3496 7.71429 14.4221 7.71429 12.0471C7.71429 9.67207 9.63428 7.74454 12 7.74454C14.3657 7.74454 16.2857 9.67207 16.2857 12.0471C16.2857 14.4221 14.3657 16.3496 12 16.3496Z" fill="#687078"/></svg><div><div class="mapboxgl-ctrl-geocoder--result-title maplibregl-ctrl-geocoder--result-title">'+o[0]+'</div><div class="mapboxgl-ctrl-geocoder--result-address maplibregl-ctrl-geocoder--result-address">'+o.splice(1,o.length).join(",")+"</div></div></div>"}else{var t=r.text,e=t.toLowerCase().indexOf(this.query.toLowerCase()),n=this.query.length,i=t.substring(0,e),s=t.substring(e,e+n),a=t.substring(e+n);return'<div class="mapboxgl-ctrl-geocoder--suggestion maplibregl-ctrl-geocoder--suggestion"><svg class="mapboxgl-ctrl-geocoder--suggestion-icon maplibre-ctrl-geocoder--suggestion-icon" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22.8702 20.1258H21.4248L20.9125 19.6318C22.7055 17.546 23.785 14.8382 23.785 11.8925C23.785 5.32419 18.4608 0 11.8925 0C5.32419 0 0 5.32419 0 11.8925C0 18.4608 5.32419 23.785 11.8925 23.785C14.8382 23.785 17.546 22.7055 19.6318 20.9125L20.1258 21.4248V22.8702L29.2739 32L32 29.2739L22.8702 20.1258ZM11.8925 20.1258C7.33676 20.1258 3.65923 16.4483 3.65923 11.8925C3.65923 7.33676 7.33676 3.65923 11.8925 3.65923C16.4483 3.65923 20.1258 7.33676 20.1258 11.8925C20.1258 16.4483 16.4483 20.1258 11.8925 20.1258Z" fill="#687078"/></svg><div class="mapboxgl-ctrl-geocoder--suggestion-info maplibregl-ctrl-geocoder--suggestion-info"><div class="mapboxgl-ctrl-geocoder--suggestion-title maplibregl-ctrl-geocoder--suggestion-title">'+i+'<span class="mapboxgl-ctrl-geocoder--suggestion-match maplibregl-ctrl-geocoder--suggestion-match">'+s+"</span>"+a+"</div></div></div>"}},popupRender:function(r){var t=r.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion maplibre-ctrl-geocoder--suggestion popup-suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title maplibre-ctrl-geocoder--suggestion-title popup-suggestion-title">'+t[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address maplibre-ctrl-geocoder--suggestion-address popup-suggestion-address">'+t.splice(1,t.length).join(",")+"</div></div>"},showResultMarkers:!0,debounceSearch:200},addTo:function(r){function t(n,i){if(!document.body.contains(i))throw new Error("Element provided to #addTo() exists, but is not in the DOM");var s=n.onAdd();i.appendChild(s)}if(r._controlContainer)r.addControl(this);else if(r instanceof HTMLElement)t(this,r);else if(typeof r=="string"){var e=document.querySelectorAll(r);if(e.length===0)throw new Error("Element ",r,"not found.");if(e.length>1)throw new Error("Geocoder can only be added to a single html element");t(this,e[0])}else throw new Error("Error: addTo must be a maplibre-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(r){if(r&&typeof r!="string"&&(this._map=r),this.setLanguage(),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this);var t=this.container=document.createElement("div");t.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl";var e=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input maplibregl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",Drt(this._onKeyDown,this.options.debounceSearch)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton);var n=document.createElement("div");n.classList.add("mapboxgl-ctrl-geocoder--pin-right","maplibregl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button maplibregl-ctrl-geocoder--button";var i=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');return this._clearEl.appendChild(i),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),n.appendChild(this._clearEl),n.appendChild(this._loadingEl),t.appendChild(e),t.appendChild(this._inputEl),t.appendChild(n),this._typeahead=new Ort(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit,noInitialSelection:!0}),this.setRenderFunction(this.options.render),this._typeahead.getItemValue=this.options.getItemValue,this.mapMarker=null,this.resultMarkers=[],this._handleMarker=this._handleMarker.bind(this),this._handleResultMarkers=this._handleResultMarkers.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._maplibregl=this.options.maplibregl,!this._maplibregl&&this.options.marker&&(console.error("No maplibregl detected in options. Map markers are disabled. Please set options.maplibregl."),this.options.marker=!1)),t},createIcon:function(r,t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+r+" maplibregl-ctrl-geocoder--icon maplibregl-ctrl-geocoder--icon-"+r),e.setAttribute("viewBox","0 0 18 18"),e.setAttribute("xml:space","preserve"),e.setAttribute("width",18),e.setAttribute("height",18),"innerHTML"in e)e.innerHTML=t;else{var n=document.createElement("div");n.innerHTML="<svg>"+t.valueOf().toString()+"</svg>";var i=n.firstChild,s=i.firstChild;e.appendChild(s)}return e},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_onPaste:function(r){var t=(r.clipboardData||window.clipboardData).getData("text");t.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(t)},_onKeyDown:function(r){var t=27,e=9;if(r.keyCode===t&&this.options.clearAndBlurOnEsc)return this._clear(r),this._inputEl.blur();var n=r.target&&r.target.shadowRoot?r.target.shadowRoot.activeElement:r.target,i=n?n.value:"";if(!i)return this.fresh=!0,r.keyCode!==e&&this.clear(r),this._clearEl.style.display="none";if(!(r.metaKey||[e,t,37,39,38,40].indexOf(r.keyCode)!==-1)){if(r.keyCode===13)if(!this.options.showResultsWhileTyping)this._typeahead.selected||this._geocode(n.value);else{this._typeahead.selected==null&&this.geocoderApi.getSuggestions?this._geocode(n.value,!0):this._typeahead.selected==null&&this.options.showResultMarkers&&this._fitBoundsForMarkers();return}n.value.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(n.value)}},_showButton:function(){this._inputEl.value.length>0&&(this._clearEl.style.display="block")},_hideButton:function(){this._typeahead.selected&&(this._clearEl.style.display="none")},_onBlur:function(r){this.options.clearOnBlur&&this._clearOnBlur(r),this.options.collapsed&&this._collapse()},_onChange:function(){var r=this._typeahead.selected;if(r&&!r.geometry)r.placeId?this._geocode(r.placeId,!0,!0):this._geocode(r.text,!0);else if(r&&JSON.stringify(r)!==this.lastSelected){if(this._clearEl.style.display="none",this.options.flyTo){var t;if(this._removeResultMarkers(),r.properties&&m4[r.properties.short_code])t=Oa({},this.options.flyTo),this._map&&this._map.fitBounds(m4[r.properties.short_code].bbox,t);else if(r.bbox){var e=r.bbox;t=Oa({},this.options.flyTo),this._map&&this._map.fitBounds([[e[0],e[1]],[e[2],e[3]]],t)}else{var n={zoom:this.options.zoom};t=Oa({},n,this.options.flyTo),r.center?t.center=r.center:r.geometry&&r.geometry.type&&r.geometry.type==="Point"&&r.geometry.coordinates&&(t.center=r.geometry.coordinates),this._map&&this._map.flyTo(t)}}this.options.marker&&this._maplibregl&&this._handleMarker(r),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(r),this._typeahead.selected=null,this._eventEmitter.emit("result",{result:r})}},_getConfigForRequest:function(){var r=["bbox","limit","proximity","countries","types","language","reverseMode"],t=this,e=r.reduce(function(n,i){return t.options[i]&&(["countries","types","language"].indexOf(i)>-1?n[i]=t.options[i].split(/[\s,]+/):n[i]=t.options[i],i==="proximity"&&t.options[i]&&typeof t.options[i].longitude=="number"&&typeof t.options[i].latitude=="number"&&(n[i]=[t.options[i].longitude,t.options[i].latitude])),n},{});return e},_geocode:function(r,t,e){this._loadingEl.style.display="block",this._eventEmitter.emit("loading",{query:r}),this.inputString=r;var n=null,i=this._getConfigForRequest(),s;if(this.options.localGeocoderOnly)s=Promise.resolve();else if(this.options.reverseGeocode&&/(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/.test(r)){var a=r.split(/[\s(,)?]+/).map(function(f){return parseFloat(f,10)}).reverse();i.types&&i.types[0],i=Oa(i,{query:a,limit:1}),"proximity"in i&&delete i.proximity,s=this.geocoderApi.reverseGeocode(i)}else i=Oa(i,{query:r}),this.geocoderApi.getSuggestions?t?this.geocoderApi.searchByPlaceId&&e?s=this.geocoderApi.searchByPlaceId(i):s=this.geocoderApi.forwardGeocode(i):s=this.geocoderApi.getSuggestions(i):s=this.geocoderApi.forwardGeocode(i);var o=[];this.options.localGeocoder&&(o=this.options.localGeocoder(r),o||(o=[]));var A=[];return s.catch((function(f){n=f}).bind(this)).then((function(f){this._loadingEl.style.display="none";var m={};return f?m=f:m={type:"FeatureCollection",features:[]},m.config=i,this.fresh&&(this.fresh=!1),m.features=m.features?o.concat(m.features):o,this.options.externalGeocoder?(A=this.options.externalGeocoder(r,m.features,i)||[],A.then(function(b){return m.features=m.features?b.concat(m.features):b,m},function(){return m})):m}).bind(this)).then((function(f){if(n)throw n;this.options.filter&&f.features.length&&(f.features=f.features.filter(this.options.filter));var m=[];f.suggestions?m=f.suggestions:f.place?m=[f.place]:m=f.features,m.length?(this._clearEl.style.display="block",this._typeahead.update(m),(!this.options.showResultsWhileTyping||t)&&this.options.showResultMarkers&&(f.features.length>0||f.place)&&this._fitBoundsForMarkers(),this._eventEmitter.emit("results",f)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",f))}).bind(this)).catch((function(f){this._loadingEl.style.display="none",o.length&&this.options.localGeocoder||A.length&&this.options.externalGeocoder?(this._clearEl.style.display="block",this._typeahead.update(o)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:o}),this._eventEmitter.emit("error",{error:f})}).bind(this)),s},_clear:function(r){r&&r.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._clearEl.style.display="none",this._removeMarker(),this._removeResultMarkers(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(r){this._clear(r),this._inputEl.focus()},_clearOnBlur:function(r){var t=this;r.relatedTarget&&t._clear(r)},_onQueryResult:function(r){var t=r;if(t.features.length){var e=t.features[0];this._typeahead.selected=e,this._inputEl.value=e.place_name,this._onChange()}},_updateProximity:function(){if(this._map)if(this._map.getZoom()>9){var r=this._map.getCenter().wrap();this.setProximity({longitude:r.lng,latitude:r.lat})}else this.setProximity(null)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed","maplibregl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed","maplibregl-ctrl-geocoder--collapsed")},query:function(r){return this._geocode(r).then(this._onQueryResult),this},_renderError:function(){var r="<div class='mapbox-gl-geocoder--error maplibre-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(r)},_renderNoResults:function(){var r="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results maplibre-gl-geocoder--error maplibre-gl-geocoder--no-results'>No results found</div>";this._renderMessage(r)},_renderMessage:function(r){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(r)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var r=this.options.language.split(",")[0],t=Qrt.language(r),e=Nrt.placeholder[t];if(e)return e}return"Search"},_fitBoundsForMarkers:function(){if(!(this._typeahead.data.length<1)){var r=this._typeahead.data.filter(function(i){return typeof i!="string"}).slice(0,this.options.limit);if(this._clearEl.style.display="none",this.options.flyTo&&this._maplibregl&&this._map){var t={padding:100},e=Oa({},t,this.options.flyTo),n=new this._maplibregl.LngLatBounds;r.forEach(function(i){n.extend(i.geometry.coordinates)}),this._map.fitBounds(n.toArray(),e)}return r.length>0&&this._maplibregl&&this._handleResultMarkers(r),this}},setInput:function(r){return this._inputEl.value=r,this._typeahead.selected=null,this._typeahead.clear(),r.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(r),this},setProximity:function(r){return this.options.proximity=r,this},getProximity:function(){return this.options.proximity},setRenderFunction:function(r){return r&&typeof r=="function"&&(this._typeahead.render=r),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(r){var t=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=r||this.options.language||t,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(r){return this.options.zoom=r,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(r){return this.options.flyTo=r,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(r){return this.placeholder=r||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(r){return this.options.bbox=r,this},getCountries:function(){return this.options.countries},setCountries:function(r){return this.options.countries=r,this},getTypes:function(){return this.options.types},setTypes:function(r){return this.options.types=r,this},getMinLength:function(){return this.options.minLength},setMinLength:function(r){return this.options.minLength=r,this._typeahead&&(this._typeahead.options.minLength=r),this},getLimit:function(){return this.options.limit},setLimit:function(r){return this.options.limit=r,this._typeahead&&(this._typeahead.options.limit=r),this},getFilter:function(){return this.options.filter},setFilter:function(r){return this.options.filter=r,this},setGeocoderApi:function(r){return this.geocoderApi=r,this},getGeocoderApi:function(){return this.geocoderApi},_handleMarker:function(r){if(this._map){this._removeMarker();var t={color:"#4668F2"},e=Oa({},t,this.options.marker);this.mapMarker=new this._maplibregl.Marker(e);var n;if(this.options.popup){var i={},s=Oa({},i,this.options.popup);n=new this._maplibregl.Popup(s).setHTML(this.options.popupRender(r))}return r.center?(this.mapMarker.setLngLat(r.center).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(n)):r.geometry&&r.geometry.type&&r.geometry.type==="Point"&&r.geometry.coordinates&&(this.mapMarker.setLngLat(r.geometry.coordinates).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(n)),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},_handleResultMarkers:function(r){if(this._map){this._removeResultMarkers();var t={color:"#4668F2"},e=Oa({},t,this.options.showResultMarkers);return r.forEach((function(n){if(this.options.showResultMarkers&&this.options.showResultMarkers.element){var i=this.options.showResultMarkers.element.cloneNode(!0);e=Oa(e,{element:i})}var s=new this._maplibregl.Marker(Oa({},e,{element:i})),a;if(this.options.popup){var o={},A=Oa({},o,this.options.popup);a=new this._maplibregl.Popup(A).setHTML(this.options.popupRender(n))}n.center?(s.setLngLat(n.center).addTo(this._map),this.options.popup&&s.setPopup(a)):n.geometry&&n.geometry.type&&n.geometry.type==="Point"&&n.geometry.coordinates&&(s.setLngLat(n.geometry.coordinates).addTo(this._map),this.options.popup&&s.setPopup(a)),this.resultMarkers.push(s)}).bind(this)),this}},_removeResultMarkers:function(){this.resultMarkers&&this.resultMarkers.length>0&&(this.resultMarkers.forEach(function(r){r.remove()}),this.resultMarkers=[])},on:function(r,t){return this._eventEmitter.on(r,t),this},off:function(r,t){return this._eventEmitter.removeListener(r,t),this}};var Hrt=y4;const zrt=xp(Hrt),wy={defaultOptions:{limitsUrl:"https://tilemaps.icgc.cat/vt/limits-tilejsonV3.json",geocoder:{peliasUrl1:"https://eines.icgc.cat/geocodificador/autocompletar?text=",peliasUrl2:"&layers=topo1%2Ctopo2%2Caddress&size=5"},mapOptions:{container:"map",center:{0:1.537786,1:41.837539},zoom:7.5,bearing:0,pitch:0,hash:!1,style:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_gris.json",maxZoom:18,maxPitch:85},logoIcgcOptions:{logoUrlColor:"https://tilemaps.icgc.cat/cdn/logos/icgc_logo_color.png",logoUrlWhite:"https://tilemaps.icgc.cat/cdn/logos/icgc_logo_blanc.svg",logoLink:"https://www.icgc.cat",logoTitle:"Institut Cartogrfic i Geolgic de Catalunya",logoWidth:100},logoGencatOptions:{logoUrlColor:"https://tilemaps.icgc.cat/cdn/logos/gencat_logo_color.png",logoUrlWhite:"https://tilemaps.icgc.cat/cdn/logos/gencat_logo_blanc.png",logoLink:"https://web.gencat.cat/",logoTitle:"Generalitat de Catalunya",logoWidth:100},map3dOptions:{spaceErrorFactor:2,exaggeration:1,zfactor:48,minZoomRange:15.5,maxZoomRange:22,urlTilesetCities:"https://tilemaps.icgc.cat/vector/3dtiles/ciutats/v1/tilesetV1.0.json",layerIdOrder:"place-isolated",sourceLayerFilterId:"place",minZoomFilter:14,layerId3d:"edificisMapboxLayer",terrainSource:"ICGC5M",style3dName:"orto3d",imageIcon:"https://tilemaps.icgc.cat/cdn/images/stick.png"},baseStyles:[{key:"TOPO",url:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_estandard.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_estandard.png"},{key:"ORTO",url:"https://geoserveis.icgc.cat/contextmaps/icgc_orto_estandard.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_orto_hibrida.png"},{key:"ORTO3D",url:"https://tilemaps.icgc.cat/cdn/styles/icgc_orto_3d.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_orto_hibrida.png"},{key:"ADMIN",url:"https://geoserveis.icgc.cat/contextmaps/icgc_delimitacio_limits_administratius.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_delimitacio_limits_administratius.png"},{key:"DARK",url:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_fosc.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_base_fosc.png"},{key:"LIGHT",url:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_gris.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_base_gris.png"},{key:"GEOLOGY",url:"https://geoserveis.icgc.cat/contextmaps/icgc_geologic_informacio.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_geologic_informacio.png"}],urlTerrainICGC:[{name:"ICGC5M",url:"https://tilemaps.icgc.cat/tileserver/tileserver/terreny-5m-30m-rgb-extent/{z}/{x}/{y}.png"},{name:"WORLD30M",url:"https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png",encoding:"terrarium"}],ortoLayersICGC:[{name:"ortofotoColorProvisional",key:"ortofoto_color_provisional",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_provisional"},{name:"ortofotoColor2022",key:"ortofoto_color_2022",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2022"},{name:"ortofotoColor2021",key:"ortofoto_color_2021",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2021"},{name:"ortofotoColor2020",key:"ortofoto_color_2020",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2020"},{name:"ortofotoColor2019",key:"ortofoto_color_2019",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2019"},{name:"ortofotoColor2018",key:"ortofoto_color_2018",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2018"},{name:"ortofotoColor2017",key:"ortofoto_color_2017",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2017"},{name:"ortofotoColor2016",key:"ortofoto_color_2016",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2016"},{name:"ortofotoColor2015",key:"ortofoto_color_2015",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2015"},{name:"ortofotoColor2014",key:"ortofoto_color_2014",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2014"},{name:"ortofotoColor2013",key:"ortofoto_color_2013",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2013"},{name:"ortofotoColor2012",key:"ortofoto_color_2012",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2012"},{name:"ortofotoColor2011",key:"ortofoto_color_2011",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2011"},{name:"ortofotoColor2010",key:"ortofoto_color_2010",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2010"},{name:"ortofotoColor2009",key:"ortofoto_color_2009",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2009"},{name:"ortofotoColor2008",key:"ortofoto_color_2008",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2008"},{name:"ortofotoColor20062007",key:"ortofoto_color_2006-2007",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2006-2007"},{name:"ortofotoColor20042005",key:"ortofoto_color_2004-2005",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2004-2005"},{name:"ortofotoColor20002003",key:"ortofoto_color_2000-2003",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2000-2003"},{name:"ortofotoBlancINegre1998",key:"ortofoto_blanc_i_negre_1998",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1998"},{name:"ortofotoBlancINegre19941997",key:"ortofoto_blanc_i_negre_1994-1997",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1994-1997"},{name:"ortofotoColor1993",key:"ortofoto_color_1993",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_1993"},{name:"ortofotoBlancINegre19831992",key:"ortofoto_blanc_i_negre_1983-1992",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1983-1992"},{name:"ortofotoBlancINegre19701977",key:"ortofoto_blanc_i_negre_1970-1977",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1970-1977"},{name:"ortofotoBlancINegre1956",key:"ortofoto_blanc_i_negre_1956",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1956"},{name:"ortofotoBlancINegre1945",key:"ortofoto_blanc_i_negre_1945",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1945"},{name:"ortofotoColorSerieAnual",key:"ortofoto_color_serie_anual",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_serie_anual"},{name:"ortofotoInfraroigProvisional",key:"ortofoto_infraroig_provisional",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_provisional"},{name:"ortofotoInfraroig2022",key:"ortofoto_infraroig_2022",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2022"},{name:"ortofotoInfraroig2021",key:"ortofoto_infraroig_2021",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2021"},{name:"ortofotoInfraroig2020",key:"ortofoto_infraroig_2020",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2020"},{name:"ortofotoInfraroig2019",key:"ortofoto_infraroig_2019",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2019"},{name:"ortofotoInfraroig2018",key:"ortofoto_infraroig_2018",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2018"},{name:"ortofotoInfraroig2017",key:"ortofoto_infraroig_2017",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2017"},{name:"ortofotoInfraroig2016",key:"ortofoto_infraroig_2016",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2016"},{name:"ortofotoInfraroig2015",key:"ortofoto_infraroig_2015",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2015"},{name:"ortofotoInfraroig2014",key:"ortofoto_infraroig_2014",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2014"},{name:"ortofotoInfraroig2013",key:"ortofoto_infraroig_2013",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2013"},{name:"ortofotoInfraroig2012",key:"ortofoto_infraroig_2012",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2012"},{name:"ortofotoInfraroig2011",key:"ortofoto_infraroig_2011",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2011"},{name:"ortofotoInfraroig2010",key:"ortofoto_infraroig_2010",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2010"},{name:"ortofotoInfraroig2009",key:"ortofoto_infraroig_2009",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2009"},{name:"ortofotoInfraroig2008",key:"ortofoto_infraroig_2008",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2008"},{name:"ortofotoInfraroig20062007",key:"ortofoto_infraroig_2006-2007",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2006-2007"},{name:"ortofotoInfraroig19961997",key:"ortofoto_infraroig_1996-1997",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_1996-1997"},{name:"ortofotoInfraroigSerieAnual",key:"ortofoto_infraroig_serie_anual",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_serie_anual"}],vectorLayersICGC:[{name:"agrupacionsCensals2015",key:"agrupacions_censals_2015"},{name:"agrupacionsCensals2016",key:"agrupacions_censals_2016"},{name:"agrupacionsCensals2017",key:"agrupacions_censals_2017"},{name:"agrupacionsCensals2018",key:"agrupacions_censals_2018"},{name:"agrupacionsCensals2019",key:"agrupacions_censals_2019"},{name:"agrupacionsCensals2020",key:"agrupacions_censals_2020"},{name:"agrupacionsCensals2021",key:"agrupacions_censals_2021"},{name:"agrupacionsCensalsVigent",key:"agrupacions_censals_vigent"},{name:"agrupacionsCensalsVigentText",key:"agrupacions_censals_vigent_text"},{name:"areesBasiquesPolicials2019",key:"arees_basiques_policials_2019"},{name:"areesBasiquesPolicials2020",key:"arees_basiques_policials_2020"},{name:"areesBasiquesPolicials2022",key:"arees_basiques_policials_2022"},{name:"areesBasiquesPolicialsVigent",key:"arees_basiques_policials_vigent"},{name:"areesBasiquesPolicialsVigentText",key:"arees_basiques_policials_vigent_text"},{name:"areesBasiquesSalutVigent",key:"arees_basiques_salut_vigent"},{name:"areesBasiquesServeisSocialsVigent",key:"arees_basiques_serveis_socials_vigent"},{name:"areesBasiquesServeisSocialsVigentText",key:"arees_basiques_serveis_socials_vigent_text"},{name:"areesGestioAssistencialVigent",key:"arees_gestio_assistencial_vigent"},{name:"areesHidrogeologiquesAquifersVigent",key:"arees_hidrogeologiques_aquifers_vigent"},{name:"catalunyaVigent",key:"catalunya_vigent"},{name:"catalunyaVigentText",key:"catalunya_vigent_text"},{name:"comarques2022",key:"comarques_2022"},{name:"comarquesVigent",key:"comarques_vigent"},{name:"comarquesVigentText",key:"comarques_vigent_text"},{name:"districtesCensals2015",key:"districtes_censals_2015"},{name:"districtesCensals2016",key:"districtes_censals_2016"},{name:"districtesCensals2017",key:"districtes_censals_2017"},{name:"districtesCensals2018",key:"districtes_censals_2018"},{name:"districtesCensals2019",key:"districtes_censals_2019"},{name:"districtesCensals2020",key:"districtes_censals_2020"},{name:"districtesCensals2021",key:"districtes_censals_2021"},{name:"districtesCensals2022",key:"districtes_censals_2022"},{name:"districtesCensalsVigent",key:"districtes_censals_vigent"},{name:"districtesCensalsVigentText",key:"districtes_censals_vigent_text"},{name:"incendisForestalsVigent",key:"incendis_forestals_vigent"},{name:"incendisForestalsVigentText",key:"incendis_forestals_vigent_text"},{name:"municipis2022",key:"municipis_2022"},{name:"municipis2022Text",key:"municipis_2022_text"},{name:"municipisVigent",key:"municipis_vigent"},{name:"municipisVigentText",key:"municipis_vigent_text"},{name:"partitsJudicialsVigent",key:"partits_judicials_vigent"},{name:"partitsJudicialsVigentText",key:"partits_judicials_vigent_text"},{name:"plaTerritorial2015",key:"pla_territorial_2015"},{name:"plaTerritorialVigent",key:"pla_territorial_vigent"},{name:"plaTerritorialVigentText",key:"pla_territorial_vigent_text"},{name:"provinciesVigent",key:"provincies_vigent"},{name:"provinciesVigentText",key:"provincies_vigent_text"},{name:"regionsPolicialsVigent",key:"regions_policials_vigent"},{name:"regionsPolicialsVigentText",key:"regions_policials_vigent_text"},{name:"regionsSanitariesVigent",key:"regions_sanitaries_vigent"},{name:"regionsSanitariesVigentText",key:"regions_sanitaries_vigent_text"},{name:"seccionsCensals2015",key:"seccions_censals_2015"},{name:"seccionsCensals2016",key:"seccions_censals_2016"},{name:"seccionsCensals2017",key:"seccions_censals_2017"},{name:"seccionsCensals2018",key:"seccions_censals_2018"},{name:"seccionsCensals2019",key:"seccions_censals_2019"},{name:"seccionsCensals2020",key:"seccions_censals_2020"},{name:"seccionsCensals2021",key:"seccions_censals_2021"},{name:"seccionsCensals2022",key:"seccions_censals_2022"},{name:"seccionsCensalsVigent",key:"seccions_censals_vigent"},{name:"seccionsCensalsVigentText",key:"seccions_censals_vigent_text"},{name:"sectorsSanitarisVigent",key:"sectors_sanitaris_vigent"},{name:"vegueriesVigent",key:"vegueries_vigent"},{name:"vegueriesVigentText",key:"vegueries_vigent_text"}],vectorLayers:[{key:"cobertes2018",url:"https://tilemaps.icgc.cat/tileserver/cobertes_tilejson.json",legend:"https://tilemaps.icgc.cat/cdn/images/llegendaCobertesSol2018.jpg"}],wmsLayers:[{key:"espaisInteresGeologic",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/espais-interes-geologic/wms/service?&service=WMS&request=GetMap&layers=espais-interes-geologic&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},{key:"gravimetriaBouguer500000",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/gravimetria/wms/service?&service=WMS&request=GetMap&layers=anomalia_bouguer_500000&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},{key:"cobertesSol2018",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms/service?&service=WMS&request=GetMap&layers=cobertes_2018&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},{key:"administratiu",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/administratiu/MON3857NW/{z}/{x}/{y}.png"},{key:"simplificat",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/simplificat/MON3857NW/{z}/{x}/{y}.png"},{key:"cims",layer:"",url:"https://geoserveis.icgc.cat/icc_100cims/wms/service?REQUEST=GetMap&SERVICE=WMS&VERSION=1.1.1&LAYERS=0&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&SRS=EPSG:25831&BBOX=137118.923076923,4488408.75,650959.076923077,4749634.75&WIDTH=895&HEIGHT=455"},{key:"cobertesSol",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms?REQUEST=GetMap&SERVICE=WMS&VERSION=1.3.0&LAYERS=cobertes_2009&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&CRS=EPSG:25831&BBOX=374110.828167253,4639230.79853085,452621.120632226,4703578.45000215&WIDTH=1020&HEIGHT=836"}],fgbLayers:[{name:"agrupacionsCensalsVigent",key:"agrupacions_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent.fgb"},{name:"agrupacionsCensalsVigentText",key:"agrupacions_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent_text.fgb"},{name:"areesBasiquesPolicialsVigent",key:"arees_basiques_policials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent.fgb"},{name:"areesBasiquesPolicialsVigentText",key:"arees_basiques_policials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent_text.fgb"},{name:"areesBasiquesSalutVigent",key:"arees_basiques_salut_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_salut_vigent.fgb"},{name:"areesBasiquesServeisSocialsVigent",key:"arees_basiques_serveis_socials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent.fgb"},{name:"areesBasiquesServeisSocialsVigentText",key:"arees_basiques_serveis_socials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent_text.fgb"},{name:"areesGestioAssistencialVigent",key:"arees_gestio_assistencial_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_gestio_assistencial_vigent.fgb"},{name:"areesHidrogeologiquesAquifersVigent",key:"arees_hidrogeologiques_aquifers_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_hidrogeologiques_aquifers_vigent.fgb"},{name:"catalunyaVigent",key:"catalunya_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent.fgb"},{name:"catalunyaVigentText",key:"catalunya_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent_text.fgb"},{name:"comarquesVigent",key:"comarques_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent.fgb"},{name:"comarquesVigentText",key:"comarques_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent_text.fgb"},{name:"districtesCensalsVigent",key:"districtes_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent.fgb"},{name:"districtesCensalsVigentText",key:"districtes_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent_text.fgb"},{name:"incendisForestalsVigent",key:"incendis_forestals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent.fgb"},{name:"incendisForestalsVigentText",key:"incendis_forestals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent_text.fgb"},{name:"municipisVigent",key:"municipis_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent.fgb"},{name:"municipisVigentText",key:"municipis_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent_text.fgb"},{name:"partitsJudicialsVigent",key:"partits_judicials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent.fgb"},{name:"partitsJudicialsVigentText",key:"partits_judicials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent_text.fgb"},{name:"plaTerritorialVigent",key:"pla_territorial_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent.fgb"},{name:"plaTerritorialVigentText",key:"pla_territorial_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent_text.fgb"},{name:"provinciesVigent",key:"provincies_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent.fgb"},{name:"provinciesVigentText",key:"provincies_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent_text.fgb"},{name:"regionsPolicialsVigent",key:"regions_policials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent.fgb"},{name:"regionsPolicialsVigentText",key:"regions_policials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent_text.fgb"},{name:"regionsSanitariesVigent",key:"regions_sanitaries_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent.fgb"},{name:"regionsSanitariesVigentText",key:"regions_sanitaries_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent_text.fgb"},{name:"seccionsCensalsVigent",key:"seccions_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent.fgb"},{name:"seccionsCensalsVigentText",key:"seccions_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent_text.fgb"},{name:"sectorsSanitarisVigent",key:"sectors_sanitaris_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/sectors_sanitaris_vigent.fgb"},{name:"vegueriesVigent",key:"vegueries_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent.fgb"},{name:"vegueriesVigentText",key:"vegueries_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent_text.fgb"}]},Styles:{TOPO:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_estandard.json",ORTO:"https://geoserveis.icgc.cat/contextmaps/icgc_orto_estandard.json",ORTO3D:"https://tilemaps.icgc.cat/cdn/styles/icgc_orto_3d.json",ADMIN:"https://geoserveis.icgc.cat/contextmaps/icgc_delimitacio_limits_administratius.json",DARK:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_fosc.json",LIGHT:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_gris.json",GEOLOGY:"https://geoserveis.icgc.cat/contextmaps/icgc_geologic_informacio.json"},Terrains:{ICGC5M:"https://tilemaps.icgc.cat/tileserver/tileserver/terreny-5m-30m-rgb-extent/{z}/{x}/{y}.png",WORLD30M:"https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png"},Layers:{Orto:{ortofotoColorProvisional:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_provisional",ortofotoColor2022:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2022",ortofotoColor2021:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2021",ortofotoColor2020:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2020",ortofotoColor2019:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2019",ortofotoColor2018:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2018",ortofotoColor2017:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2017",ortofotoColor2016:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2016",ortofotoColor2015:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2015",ortofotoColor2014:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2014",ortofotoColor2013:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2013",ortofotoColor2012:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2012",ortofotoColor2011:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2011",ortofotoColor2010:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2010",ortofotoColor2009:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2009",ortofotoColor2008:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2008",ortofotoColor20062007:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2006-2007",ortofotoColor20042005:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2004-2005",ortofotoColor20002003:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2000-2003",ortofotoBlancINegre1998:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1998",ortofotoBlancINegre19941997:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1994-1997",ortofotoColor1993:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_1993",ortofotoBlancINegre19831992:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1983-1992",ortofotoBlancINegre19701977:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1970-1977",ortofotoBlancINegre1956:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1956",ortofotoBlancINegre1945:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1945",ortofotoColorSerieAnual:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_serie_anual",ortofotoInfraroigProvisional:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_provisional",ortofotoInfraroig2022:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2022",ortofotoInfraroig2021:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2021",ortofotoInfraroig2020:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2020",ortofotoInfraroig2019:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2019",ortofotoInfraroig2018:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2018",ortofotoInfraroig2017:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2017",ortofotoInfraroig2016:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2016",ortofotoInfraroig2015:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2015",ortofotoInfraroig2014:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2014",ortofotoInfraroig2013:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2013",ortofotoInfraroig2012:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2012",ortofotoInfraroig2011:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2011",ortofotoInfraroig2010:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2010",ortofotoInfraroig2009:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2009",ortofotoInfraroig2008:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2008",ortofotoInfraroig20062007:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2006-2007",ortofotoInfraroig19961997:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_1996-1997",ortofotoInfraroigSerieAnual:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_serie_anual"},VectorAdmin:{agrupacionsCensals2015:"agrupacions_censals_2015",agrupacionsCensals2016:"agrupacions_censals_2016",agrupacionsCensals2017:"agrupacions_censals_2017",agrupacionsCensals2018:"agrupacions_censals_2018",agrupacionsCensals2019:"agrupacions_censals_2019",agrupacionsCensals2020:"agrupacions_censals_2020",agrupacionsCensals2021:"agrupacions_censals_2021",agrupacionsCensalsVigent:"agrupacions_censals_vigent",agrupacionsCensalsVigentText:"agrupacions_censals_vigent_text",areesBasiquesPolicials2019:"arees_basiques_policials_2019",areesBasiquesPolicials2020:"arees_basiques_policials_2020",areesBasiquesPolicials2022:"arees_basiques_policials_2022",areesBasiquesPolicialsVigent:"arees_basiques_policials_vigent",areesBasiquesPolicialsVigentText:"arees_basiques_policials_vigent_text",areesBasiquesSalutVigent:"arees_basiques_salut_vigent",areesBasiquesServeisSocialsVigent:"arees_basiques_serveis_socials_vigent",areesBasiquesServeisSocialsVigentText:"arees_basiques_serveis_socials_vigent_text",areesGestioAssistencialVigent:"arees_gestio_assistencial_vigent",areesHidrogeologiquesAquifersVigent:"arees_hidrogeologiques_aquifers_vigent",catalunyaVigent:"catalunya_vigent",catalunyaVigentText:"catalunya_vigent_text",comarques2022:"comarques_2022",comarquesVigent:"comarques_vigent",comarquesVigentText:"comarques_vigent_text",districtesCensals2015:"districtes_censals_2015",districtesCensals2016:"districtes_censals_2016",districtesCensals2017:"districtes_censals_2017",districtesCensals2018:"districtes_censals_2018",districtesCensals2019:"districtes_censals_2019",districtesCensals2020:"districtes_censals_2020",districtesCensals2021:"districtes_censals_2021",districtesCensals2022:"districtes_censals_2022",districtesCensalsVigent:"districtes_censals_vigent",districtesCensalsVigentText:"districtes_censals_vigent_text",incendisForestalsVigent:"incendis_forestals_vigent",incendisForestalsVigentText:"incendis_forestals_vigent_text",municipis2022:"municipis_2022",municipis2022Text:"municipis_2022_text",municipisVigent:"municipis_vigent",municipisVigentText:"municipis_vigent_text",partitsJudicialsVigent:"partits_judicials_vigent",partitsJudicialsVigentText:"partits_judicials_vigent_text",plaTerritorial2015:"pla_territorial_2015",plaTerritorialVigent:"pla_territorial_vigent",plaTerritorialVigentText:"pla_territorial_vigent_text",provinciesVigent:"provincies_vigent",provinciesVigentText:"provincies_vigent_text",regionsPolicialsVigent:"regions_policials_vigent",regionsPolicialsVigentText:"regions_policials_vigent_text",regionsSanitariesVigent:"regions_sanitaries_vigent",regionsSanitariesVigentText:"regions_sanitaries_vigent_text",seccionsCensals2015:"seccions_censals_2015",seccionsCensals2016:"seccions_censals_2016",seccionsCensals2017:"seccions_censals_2017",seccionsCensals2018:"seccions_censals_2018",seccionsCensals2019:"seccions_censals_2019",seccionsCensals2020:"seccions_censals_2020",seccionsCensals2021:"seccions_censals_2021",seccionsCensals2022:"seccions_censals_2022",seccionsCensalsVigent:"seccions_censals_vigent",seccionsCensalsVigentText:"seccions_censals_vigent_text",sectorsSanitarisVigent:"sectors_sanitaris_vigent",vegueriesVigent:"vegueries_vigent",vegueriesVigentText:"vegueries_vigent_text"},FGBAdmin:{agrupacionsCensalsVigent:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent.fgb",agrupacionsCensalsVigentText:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent_text.fgb",areesBasiquesPolicialsVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent.fgb",areesBasiquesPolicialsVigentText:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent_text.fgb",areesBasiquesSalutVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_salut_vigent.fgb",areesBasiquesServeisSocialsVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent.fgb",areesBasiquesServeisSocialsVigentText:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent_text.fgb",areesGestioAssistencialVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_gestio_assistencial_vigent.fgb",areesHidrogeologiquesAquifersVigent:"https://tilemaps.icgc.cat/vector/fgb/arees_hidrogeologiques_aquifers_vigent.fgb",catalunyaVigent:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent.fgb",catalunyaVigentText:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent_text.fgb",comarquesVigent:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent.fgb",comarquesVigentText:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent_text.fgb",districtesCensalsVigent:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent.fgb",districtesCensalsVigentText:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent_text.fgb",incendisForestalsVigent:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent.fgb",incendisForestalsVigentText:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent_text.fgb",municipisVigent:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent.fgb",municipisVigentText:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent_text.fgb",partitsJudicialsVigent:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent.fgb",partitsJudicialsVigentText:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent_text.fgb",plaTerritorialVigent:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent.fgb",plaTerritorialVigentText:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent_text.fgb",provinciesVigent:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent.fgb",provinciesVigentText:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent_text.fgb",regionsPolicialsVigent:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent.fgb",regionsPolicialsVigentText:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent_text.fgb",regionsSanitariesVigent:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent.fgb",regionsSanitariesVigentText:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent_text.fgb",seccionsCensalsVigent:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent.fgb",seccionsCensalsVigentText:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent_text.fgb",sectorsSanitarisVigent:"https://tilemaps.icgc.cat/vector/fgb/sectors_sanitaris_vigent.fgb",vegueriesVigent:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent.fgb",vegueriesVigentText:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent_text.fgb"},Vector:{cobertes2018:"https://tilemaps.icgc.cat/tileserver/cobertes_tilejson.json"},WMS:{espaisInteresGeologic:"https://geoserveis.icgc.cat/servei/catalunya/espais-interes-geologic/wms/service?&service=WMS&request=GetMap&layers=espais-interes-geologic&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}",gravimetriaBouguer500000:"https://geoserveis.icgc.cat/servei/catalunya/gravimetria/wms/service?&service=WMS&request=GetMap&layers=anomalia_bouguer_500000&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}",cobertesSol2018:"https://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms/service?&service=WMS&request=GetMap&layers=cobertes_2018&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}",administratiu:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/administratiu/MON3857NW/{z}/{x}/{y}.png",simplificat:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/simplificat/MON3857NW/{z}/{x}/{y}.png",cims:"https://geoserveis.icgc.cat/icc_100cims/wms/service?REQUEST=GetMap&SERVICE=WMS&VERSION=1.1.1&LAYERS=0&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&SRS=EPSG:25831&BBOX=137118.923076923,4488408.75,650959.076923077,4749634.75&WIDTH=895&HEIGHT=455",cobertesSol:"http://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms?REQUEST=GetMap&SERVICE=WMS&VERSION=1.3.0&LAYERS=cobertes_2009&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&CRS=EPSG:25831&BBOX=374110.828167253,4639230.79853085,452621.120632226,4703578.45000215&WIDTH=1020&HEIGHT=836"}}};class Grt{constructor(t){this.options=t||{}}onAdd(t){let e=wy.defaultOptions;return this._map=t,this._img1=document.createElement("img"),this._img1.className="maplibregl-ctrl",this._img1.src=this.options.color?e.logoIcgcOptions.logoUrlColor:e.logoIcgcOptions.logoUrlWhite,this._img1.width=e.logoIcgcOptions.logoWidth,this._img1.title=e.logoIcgcOptions.logoTitle,this.link1=document.createElement("a"),this.link1.href=e.logoIcgcOptions.logoLink,this.link1.target="_blank",this.link1.appendChild(this._img1),this._container1=document.createElement("div"),this._container1.className="maplibregl-ctrl",this._container1.style.width=`${e.logoIcgcOptions.logoWidth}px`,this._container1.appendChild(this.link1),this._img2=document.createElement("img"),this._img2.className="maplibregl-ctrl",this._img2.src=this.options.color?e.logoGencatOptions.logoUrlColor:e.logoGencatOptions.logoUrlWhite,this._img2.width=e.logoGencatOptions.logoWidth,this._img2.title=e.logoGencatOptions.logoTitle,this.link2=document.createElement("a"),this.link2.href=e.logoGencatOptions.logoLink,this.link2.target="_blank",this.link2.appendChild(this._img2),this._container2=document.createElement("div"),this._container2.className="maplibregl-ctrl",this._container2.style.width=`${e.logoGencatOptions.logoWidth}px`,this._container2.appendChild(this.link2),this._mainContainer=document.createElement("div"),this._mainContainer.className="divLogos",this._mainContainer.style="display: flex",this._mainContainer.appendChild(this._container1),this._mainContainer.appendChild(this._container2),this._mainContainer}}class Vrt{constructor(t){this.options=t||{},console.info(this.options)}onAdd(t){this._map=t,this._img1=document.createElement("img"),this._img1.src=this.options.legendUrl,this._img1.width=150,this._img1.title=300,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("maplibregl-ctrl"),this.controlContainer.classList.add("maplibregl-ctrl-group"),this.legendContainer=document.createElement("div"),this.legendContainer.classList.add("maplibregl-legend-list"),this.legendButton=document.createElement("button"),this.legendButton.classList.add("maplibregl-ctrl-icon"),this.legendButton.classList.add("maplibregl-legend-switcher"),this.legendButton.addEventListener("click",()=>{this.legendButton.style.display="none",this.legendContainer.style.display="block"}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.legendButton),this.controlContainer.appendChild(this.legendContainer),this.closeButton=document.createElement("button"),this.closeButton.textContent="x",this.closeButton.classList.add("maplibregl-legend-close-button"),this.closeButton.addEventListener("click",()=>{this.legendButton.style.display="block",this.legendContainer.style.display="none"}),this.legendContainer.appendChild(this.closeButton);const e=document.createElement("label");return e.classList.add("maplibregl-legend-title-label"),e.textContent=this.options.name||"Llegenda",this.legendContainer.appendChild(e),this.legendContainer.appendChild(document.createElement("br")),this.legendContainer.appendChild(this._img1),this.controlContainer}}var Cf=_4.prototype,T2="WGS 84";function _4(r){r!==void 0&&(T2=r),this.setEllipsoid(T2)}Cf.convertLatLngToUtm=function(r,t,e){var n;if(this.status)return"No ecclipsoid data associated with unknown datum: "+T2;if(!Number.isInteger(e))return"Precision is not integer number.";r=parseFloat(r),t=parseFloat(t);var i=t,s=this.toRadians(r),a=this.toRadians(i);i>=8&&i<=13&&r>54.5&&r<58||r>=56&&r<64&&i>=3&&i<12?n=32:(n=(i+180)/6+1,r>=72&&r<84&&(i>=0&&i<9?n=31:i>=9&&i<21?n=33:i>=21&&i<33?n=35:i>=33&&i<42&&(n=37))),n=parseInt(n);var o=(n-1)*6-180+3,A=this.toRadians(o),f=this.getUtmLetterDesignator(r),m=this.eccSquared/(1-this.eccSquared),b=this.a/Math.sqrt(1-this.eccSquared*Math.sin(s)*Math.sin(s)),x=Math.tan(s)*Math.tan(s),C=m*Math.cos(s)*Math.cos(s),M=Math.cos(s)*(a-A),U=this.a*((1-this.eccSquared/4-3*this.eccSquared*this.eccSquared/64-5*this.eccSquared*this.eccSquared*this.eccSquared/256)*s-(3*this.eccSquared/8+3*this.eccSquared*this.eccSquared/32+45*this.eccSquared*this.eccSquared*this.eccSquared/1024)*Math.sin(2*s)+(15*this.eccSquared*this.eccSquared/256+45*this.eccSquared*this.eccSquared*this.eccSquared/1024)*Math.sin(4*s)-35*this.eccSquared*this.eccSquared*this.eccSquared/3072*Math.sin(6*s)),N=parseFloat(.9996*b*(M+(1-x+C)*M*M*M/6+(5-18*x+x*x+72*C-58*m)*M*M*M*M*M/120)+5e5),Q=parseFloat(.9996*(U+b*Math.tan(s)*(M*M/2+(5-x+9*C+4*C*C)*M*M*M*M/24+(61-58*x+x*x+600*C-330*m)*M*M*M*M*M*M/720)));return r<0&&(Q+=1e7),Q=v4(Q,e),N=v4(N,e),{Easting:N,Northing:Q,ZoneNumber:parseInt(n),ZoneLetter:f}},Cf.convertUtmToLatLng=function(r,t,e,n){var i=(1-Math.sqrt(1-this.eccSquared))/(1+Math.sqrt(1-this.eccSquared)),s=r-5e5,a=t,o=e,A=n;if(r===void 0)return"Please pass the UTMEasting!";if(t===void 0)return"Please pass the UTMNorthing!";if(e===void 0)return"Please pass the UTMZoneNumber!";if(n===void 0)return"Please pass the UTMZoneLetter!";["N","P","Q","R","S","T","U","V","W","X","Y","Z"].indexOf(A)!==-1||(a-=1e7);var f=(o-1)*6-180+3,m=this.eccSquared/(1-this.eccSquared),b=a/.9996,x=b/(this.a*(1-this.eccSquared/4-3*this.eccSquared*this.eccSquared/64-5*this.eccSquared*this.eccSquared*this.eccSquared/256)),C=x+(3*i/2-27*i*i*i/32)*Math.sin(2*x)+(21*i*i/16-55*i*i*i*i/32)*Math.sin(4*x)+151*i*i*i/96*Math.sin(6*x);this.toDegrees(C);var M=this.a/Math.sqrt(1-this.eccSquared*Math.sin(C)*Math.sin(C)),U=Math.tan(C)*Math.tan(C),N=m*Math.cos(C)*Math.cos(C),Q=this.a*(1-this.eccSquared)/Math.pow(1-this.eccSquared*Math.sin(C)*Math.sin(C),1.5),q=s/(M*.9996),Y=C-M*Math.tan(C)/Q*(q*q/2-(5+3*U+10*N-4*N*N-9*m)*q*q*q*q/24+(61+90*U+298*N+45*U*U-252*m-3*N*N)*q*q*q*q*q*q/720);Y=this.toDegrees(Y);var tt=(q-(1+2*U+N)*q*q*q/6+(5-2*N+28*U-3*N*N+8*m+24*U*U)*q*q*q*q*q/120)/Math.cos(C);return tt=f+this.toDegrees(tt),{lat:Y,lng:tt}},Cf.getUtmLetterDesignator=function(r){return r=parseFloat(r),84>=r&&r>=72?"X":72>r&&r>=64?"W":64>r&&r>=56?"V":56>r&&r>=48?"U":48>r&&r>=40?"T":40>r&&r>=32?"S":32>r&&r>=24?"R":24>r&&r>=16?"Q":16>r&&r>=8?"P":8>r&&r>=0?"N":0>r&&r>=-8?"M":-8>r&&r>=-16?"L":-16>r&&r>=-24?"K":-24>r&&r>=-32?"J":-32>r&&r>=-40?"H":-40>r&&r>=-48?"G":-48>r&&r>=-56?"F":-56>r&&r>=-64?"E":-64>r&&r>=-72?"D":-72>r&&r>=-80?"C":"Z"},Cf.setEllipsoid=function(r){switch(r){case"Airy":this.a=6377563,this.eccSquared=.00667054;break;case"Australian National":this.a=6378160,this.eccSquared=.006694542;break;case"Bessel 1841":this.a=6377397,this.eccSquared=.006674372;break;case"Bessel 1841 Nambia":this.a=6377484,this.eccSquared=.006674372;break;case"Clarke 1866":this.a=6378206,this.eccSquared=.006768658;break;case"Clarke 1880":this.a=6378249,this.eccSquared=.006803511;break;case"Everest":this.a=6377276,this.eccSquared=.006637847;break;case"Fischer 1960 Mercury":this.a=6378166,this.eccSquared=.006693422;break;case"Fischer 1968":this.a=6378150,this.eccSquared=.006693422;break;case"GRS 1967":this.a=6378160,this.eccSquared=.006694605;break;case"GRS 1980":this.a=6378137,this.eccSquared=.00669438;break;case"Helmert 1906":this.a=6378200,this.eccSquared=.006693422;break;case"Hough":this.a=6378270,this.eccSquared=.00672267;break;case"International":this.a=6378388,this.eccSquared=.00672267;break;case"Krassovsky":this.a=6378245,this.eccSquared=.006693422;break;case"Modified Airy":this.a=6377340,this.eccSquared=.00667054;break;case"Modified Everest":this.a=6377304,this.eccSquared=.006637847;break;case"Modified Fischer 1960":this.a=6378155,this.eccSquared=.006693422;break;case"South American 1969":this.a=6378160,this.eccSquared=.006694542;break;case"WGS 60":this.a=6378165,this.eccSquared=.006693422;break;case"WGS 66":this.a=6378145,this.eccSquared=.006694542;break;case"WGS 72":this.a=6378135,this.eccSquared=.006694318;break;case"ED50":this.a=6378388,this.eccSquared=.00672267;break;case"WGS 84":case"EUREF89":case"ETRS89":this.a=6378137,this.eccSquared=.00669438;break;default:this.status=!0}},Cf.toDegrees=function(r){return r/Math.PI*180},Cf.toRadians=function(r){return r*Math.PI/180};function v4(r,t){var e=Math.pow(10,t);return Math.round(r*e)/e}var jrt=_4;const qrt=xp(jrt);class Krt{constructor(t){this.options=t||{},this.options.utm=this.options.hasOwnProperty("utm")?this.options.utm:!0,this.options.lonlat=this.options.hasOwnProperty("lonlat")?this.options.lonlat:!0}onAdd(t){const e=new qrt;return this._map=t,this._container=document.createElement("div"),this._container.className="maplibregl-ctrl coordControl",this._container.style.width=`${this.options.width||"225px"}`,this._map.on("mousemove",n=>{const i=n.lngLat.lat,s=n.lngLat.lng;let a="",o="";const A=e.convertLatLngToUtm(i,s,2),f=i>0?"N":"S";this.options.utm&&(a=`ETRS89 UTM ${A.ZoneNumber}${f} X:<b> ${A.Easting}</b> Y:<b> ${A.Northing}</b> <br>`),this.options.lonlat&&(o=`WGS 84 Lon:<b> ${s.toFixed(5)}</b>  Lat:<b> ${i.toFixed(5)}</b>`);const m=`${a}${o}`;this._container.innerHTML=m}),this._container}_lookUTM31(t,e){var n=0,i=0,s=6,a=84;return t>=n&&t<=s&&e>=i&&e<=a}onRemove(){this._container.parentNode.removeChild(this._container),this._map=void 0}}const xy=wy.Terrains,Ef=wy.Styles,Zi=wy.Layers,Wrt={cobertesSol:{"fill-opacity":["interpolate",["exponential",.5],["zoom"],13.5,1,18,.4],"fill-outline-color":"rgba(0,0, 0, 0)","fill-color":["interpolate",["cubic-bezier",.5,1,1,1],["get","nivell_2"],0,"#ffffff",111,"#ffff00",112,"#ccff33",113,"#af5b15",114,"#808000",115,"#cdcd00",116,"#ffffcc",221,"#33cc33",222,"#66ff33",223,"#689018",224,"#967d5f",225,"#19e61e",226,"#b4ff9b",227,"#aaa500",228,"#c3c3a0",229,"#00ff9b",230,"#ff9632",231,"#282828",232,"#79797a",233,"#f5df78",234,"#3296ff",341,"#ff007d",342,"#ff53cd",343,"#ffa4e2",344,"#ffc8e2",345,"#ffb4b4",346,"#0f3700",347,"#730055",348,"#6200c4",349,"#4a9595",350,"#ff00f0",351,"#adaaca",352,"#ffe6e6",353,"#67629a",354,"#4a466e",355,"#2f2d46",461,"#6f6fff",462,"#0000dc",463,"#000064",464,"#185f94",465,"#12466d",466,"#000080"]}},Qn={limitsUrl:"https://tilemaps.icgc.cat/vt/limits-tilejsonV3.json",geocoder:{peliasUrl1:"https://eines.icgc.cat/geocodificador/autocompletar?text=",peliasUrl2:"&layers=topo1%2Ctopo2%2Caddress&size=5"},mapOptions:{container:"map",center:{0:1.537786,1:41.837539},zoom:7.5,bearing:0,pitch:0,hash:!1,style:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_gris.json.json",maxZoom:18,maxPitch:85},logoIcgcOptions:{logoUrlColor:"https://tilemaps.icgc.cat/cdn/logos/icgc_logo_color.png",logoUrlWhite:"https://tilemaps.icgc.cat/cdn/logos/icgc_logo_blanc.svg",logoLink:"https://www.icgc.cat",logoTitle:"Institut Cartogrfic i Geolgic de Catalunya",logoWidth:100},logoGencatOptions:{logoUrlColor:"https://tilemaps.icgc.cat/cdn/logos/gencat_logo_color.png",logoUrlWhite:"https://tilemaps.icgc.cat/cdn/logos/gencat_logo_blanc.png",logoLink:"https://web.gencat.cat/",logoTitle:"Generalitat de Catalunya",logoWidth:100},map3dOptions:{spaceErrorFactor:2,exaggeration:1,zfactor:48,minZoomRange:15.5,maxZoomRange:22,urlTilesetCities:"https://tilemaps.icgc.cat/vector/3dtiles/ciutats/v1/tilesetV1.0.json",layerIdOrder:"place-isolated",sourceLayerFilterId:"place",minZoomFilter:14,layerId3d:"edificisMapboxLayer",terrainSource:"ICGC5M",style3dName:"orto3d",imageIcon:"https://tilemaps.icgc.cat/cdn/images/stick.png"},baseStyles:{0:{key:"TOPO",url:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_estandard_general.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_estandard.png"},1:{key:"ORTO",url:"https://geoserveis.icgc.cat/contextmaps/icgc_orto_estandard.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_orto_hibrida.png"},2:{key:"ORTO3D",url:"https://tilemaps.icgc.cat/cdn/styles/icgc_orto_3d.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_orto_hibrida.png"},3:{key:"ADMIN",url:"https://geoserveis.icgc.cat/contextmaps/icgc_delimitacio_limits_administratius.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_delimitacio_limits_administratius.png"},4:{key:"DARK",url:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_fosc.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_base_fosc.png"},5:{key:"LIGHT",url:"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_gris.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_mapa_base_gris.png"},6:{key:"GEOLOGY",url:"https://geoserveis.icgc.cat/contextmaps/icgc_geologic_informacio.json",image:"https://visors.icgc.cat/contextmaps/imatges_estil/icgc_geologic_informacio.png"}},urlTerrainICGC:{0:{name:"ICGC5M",url:"https://tilemaps.icgc.cat/tileserver/tileserver/terreny-5m-30m-rgb-extent/{z}/{x}/{y}.png"},1:{name:"WORLD30M",url:"https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png",encoding:"terrarium"}},ortoLayersICGC:{0:{name:"ortofotoColorProvisional",key:"ortofoto_color_provisional",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_provisional"},1:{name:"ortofotoColor2022",key:"ortofoto_color_2022",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2022"},2:{name:"ortofotoColor2021",key:"ortofoto_color_2021",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2021"},3:{name:"ortofotoColor2020",key:"ortofoto_color_2020",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2020"},4:{name:"ortofotoColor2019",key:"ortofoto_color_2019",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2019"},5:{name:"ortofotoColor2018",key:"ortofoto_color_2018",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2018"},6:{name:"ortofotoColor2017",key:"ortofoto_color_2017",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2017"},7:{name:"ortofotoColor2016",key:"ortofoto_color_2016",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2016"},8:{name:"ortofotoColor2015",key:"ortofoto_color_2015",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2015"},9:{name:"ortofotoColor2014",key:"ortofoto_color_2014",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2014"},10:{name:"ortofotoColor2013",key:"ortofoto_color_2013",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2013"},11:{name:"ortofotoColor2012",key:"ortofoto_color_2012",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2012"},12:{name:"ortofotoColor2011",key:"ortofoto_color_2011",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2011"},13:{name:"ortofotoColor2010",key:"ortofoto_color_2010",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2010"},14:{name:"ortofotoColor2009",key:"ortofoto_color_2009",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2009"},15:{name:"ortofotoColor2008",key:"ortofoto_color_2008",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2008"},16:{name:"ortofotoColor20062007",key:"ortofoto_color_2006-2007",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2006-2007"},17:{name:"ortofotoColor20042005",key:"ortofoto_color_2004-2005",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2004-2005"},18:{name:"ortofotoColor20002003",key:"ortofoto_color_2000-2003",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_2000-2003"},19:{name:"ortofotoBlancINegre1998",key:"ortofoto_blanc_i_negre_1998",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1998"},20:{name:"ortofotoBlancINegre19941997",key:"ortofoto_blanc_i_negre_1994-1997",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1994-1997"},21:{name:"ortofotoColor1993",key:"ortofoto_color_1993",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_1993"},22:{name:"ortofotoBlancINegre19831992",key:"ortofoto_blanc_i_negre_1983-1992",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1983-1992"},23:{name:"ortofotoBlancINegre19701977",key:"ortofoto_blanc_i_negre_1970-1977",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1970-1977"},24:{name:"ortofotoBlancINegre1956",key:"ortofoto_blanc_i_negre_1956",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1956"},25:{name:"ortofotoBlancINegre1945",key:"ortofoto_blanc_i_negre_1945",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_blanc_i_negre_1945"},26:{name:"ortofotoColorSerieAnual",key:"ortofoto_color_serie_anual",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_color_serie_anual"},27:{name:"ortofotoInfraroigProvisional",key:"ortofoto_infraroig_provisional",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_provisional"},28:{name:"ortofotoInfraroig2022",key:"ortofoto_infraroig_2022",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2022"},29:{name:"ortofotoInfraroig2021",key:"ortofoto_infraroig_2021",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2021"},30:{name:"ortofotoInfraroig2020",key:"ortofoto_infraroig_2020",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2020"},31:{name:"ortofotoInfraroig2019",key:"ortofoto_infraroig_2019",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2019"},32:{name:"ortofotoInfraroig2018",key:"ortofoto_infraroig_2018",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2018"},33:{name:"ortofotoInfraroig2017",key:"ortofoto_infraroig_2017",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2017"},34:{name:"ortofotoInfraroig2016",key:"ortofoto_infraroig_2016",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2016"},35:{name:"ortofotoInfraroig2015",key:"ortofoto_infraroig_2015",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2015"},36:{name:"ortofotoInfraroig2014",key:"ortofoto_infraroig_2014",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2014"},37:{name:"ortofotoInfraroig2013",key:"ortofoto_infraroig_2013",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2013"},38:{name:"ortofotoInfraroig2012",key:"ortofoto_infraroig_2012",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2012"},39:{name:"ortofotoInfraroig2011",key:"ortofoto_infraroig_2011",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2011"},40:{name:"ortofotoInfraroig2010",key:"ortofoto_infraroig_2010",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2010"},41:{name:"ortofotoInfraroig2009",key:"ortofoto_infraroig_2009",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2009"},42:{name:"ortofotoInfraroig2008",key:"ortofoto_infraroig_2008",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2008"},43:{name:"ortofotoInfraroig20062007",key:"ortofoto_infraroig_2006-2007",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_2006-2007"},44:{name:"ortofotoInfraroig19961997",key:"ortofoto_infraroig_1996-1997",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_1996-1997"},45:{name:"ortofotoInfraroigSerieAnual",key:"ortofoto_infraroig_serie_anual",url:"https://geoserveis.icgc.cat/servei/catalunya/orto-territorial/wms?&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&STYLES=&srs=EPSG:3857&transparent=true&width=256&height=256&layers=ortofoto_infraroig_serie_anual"}},vectorLayersICGC:{0:{name:"agrupacionsCensals2015",key:"agrupacions_censals_2015"},1:{name:"agrupacionsCensals2016",key:"agrupacions_censals_2016"},2:{name:"agrupacionsCensals2017",key:"agrupacions_censals_2017"},3:{name:"agrupacionsCensals2018",key:"agrupacions_censals_2018"},4:{name:"agrupacionsCensals2019",key:"agrupacions_censals_2019"},5:{name:"agrupacionsCensals2020",key:"agrupacions_censals_2020"},6:{name:"agrupacionsCensals2021",key:"agrupacions_censals_2021"},7:{name:"agrupacionsCensalsVigent",key:"agrupacions_censals_vigent"},8:{name:"agrupacionsCensalsVigentText",key:"agrupacions_censals_vigent_text"},9:{name:"areesBasiquesPolicials2019",key:"arees_basiques_policials_2019"},10:{name:"areesBasiquesPolicials2020",key:"arees_basiques_policials_2020"},11:{name:"areesBasiquesPolicials2022",key:"arees_basiques_policials_2022"},12:{name:"areesBasiquesPolicialsVigent",key:"arees_basiques_policials_vigent"},13:{name:"areesBasiquesPolicialsVigentText",key:"arees_basiques_policials_vigent_text"},14:{name:"areesBasiquesSalutVigent",key:"arees_basiques_salut_vigent"},15:{name:"areesBasiquesServeisSocialsVigent",key:"arees_basiques_serveis_socials_vigent"},16:{name:"areesBasiquesServeisSocialsVigentText",key:"arees_basiques_serveis_socials_vigent_text"},17:{name:"areesGestioAssistencialVigent",key:"arees_gestio_assistencial_vigent"},18:{name:"areesHidrogeologiquesAquifersVigent",key:"arees_hidrogeologiques_aquifers_vigent"},19:{name:"catalunyaVigent",key:"catalunya_vigent"},20:{name:"catalunyaVigentText",key:"catalunya_vigent_text"},21:{name:"comarques2022",key:"comarques_2022"},22:{name:"comarquesVigent",key:"comarques_vigent"},23:{name:"comarquesVigentText",key:"comarques_vigent_text"},24:{name:"districtesCensals2015",key:"districtes_censals_2015"},25:{name:"districtesCensals2016",key:"districtes_censals_2016"},26:{name:"districtesCensals2017",key:"districtes_censals_2017"},27:{name:"districtesCensals2018",key:"districtes_censals_2018"},28:{name:"districtesCensals2019",key:"districtes_censals_2019"},29:{name:"districtesCensals2020",key:"districtes_censals_2020"},30:{name:"districtesCensals2021",key:"districtes_censals_2021"},31:{name:"districtesCensals2022",key:"districtes_censals_2022"},32:{name:"districtesCensalsVigent",key:"districtes_censals_vigent"},33:{name:"districtesCensalsVigentText",key:"districtes_censals_vigent_text"},34:{name:"incendisForestalsVigent",key:"incendis_forestals_vigent"},35:{name:"incendisForestalsVigentText",key:"incendis_forestals_vigent_text"},36:{name:"municipis2022",key:"municipis_2022"},37:{name:"municipis2022Text",key:"municipis_2022_text"},38:{name:"municipisVigent",key:"municipis_vigent"},39:{name:"municipisVigentText",key:"municipis_vigent_text"},40:{name:"partitsJudicialsVigent",key:"partits_judicials_vigent"},41:{name:"partitsJudicialsVigentText",key:"partits_judicials_vigent_text"},42:{name:"plaTerritorial2015",key:"pla_territorial_2015"},43:{name:"plaTerritorialVigent",key:"pla_territorial_vigent"},44:{name:"plaTerritorialVigentText",key:"pla_territorial_vigent_text"},45:{name:"provinciesVigent",key:"provincies_vigent"},46:{name:"provinciesVigentText",key:"provincies_vigent_text"},47:{name:"regionsPolicialsVigent",key:"regions_policials_vigent"},48:{name:"regionsPolicialsVigentText",key:"regions_policials_vigent_text"},49:{name:"regionsSanitariesVigent",key:"regions_sanitaries_vigent"},50:{name:"regionsSanitariesVigentText",key:"regions_sanitaries_vigent_text"},51:{name:"seccionsCensals2015",key:"seccions_censals_2015"},52:{name:"seccionsCensals2016",key:"seccions_censals_2016"},53:{name:"seccionsCensals2017",key:"seccions_censals_2017"},54:{name:"seccionsCensals2018",key:"seccions_censals_2018"},55:{name:"seccionsCensals2019",key:"seccions_censals_2019"},56:{name:"seccionsCensals2020",key:"seccions_censals_2020"},57:{name:"seccionsCensals2021",key:"seccions_censals_2021"},58:{name:"seccionsCensals2022",key:"seccions_censals_2022"},59:{name:"seccionsCensalsVigent",key:"seccions_censals_vigent"},60:{name:"seccionsCensalsVigentText",key:"seccions_censals_vigent_text"},61:{name:"sectorsSanitarisVigent",key:"sectors_sanitaris_vigent"},62:{name:"vegueriesVigent",key:"vegueries_vigent"},63:{name:"vegueriesVigentText",key:"vegueries_vigent_text"}},vectorLayers:{0:{key:"cobertes2018",url:"https://tilemaps.icgc.cat/tileserver/cobertes_tilejson.json",legend:"https://tilemaps.icgc.cat/cdn/images/llegendaCobertesSol2018.jpg"}},wmsLayers:{0:{key:"espaisInteresGeologic",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/espais-interes-geologic/wms/service?&service=WMS&request=GetMap&layers=espais-interes-geologic&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},1:{key:"gravimetriaBouguer500000",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/gravimetria/wms/service?&service=WMS&request=GetMap&layers=anomalia_bouguer_500000&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},2:{key:"cobertesSol2018",layer:"",url:"https://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms/service?&service=WMS&request=GetMap&layers=cobertes_2018&styles=&format=image%2Fpng&transparent=true&version=1.1.1&tipus=wms&width=512&height=512&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"},3:{key:"administratiu",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/administratiu/MON3857NW/{z}/{x}/{y}.png"},4:{key:"simplificat",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/simplificat/MON3857NW/{z}/{x}/{y}.png"},5:{key:"cims",layer:"",url:"https://geoserveis.icgc.cat/icc_100cims/wms/service?REQUEST=GetMap&SERVICE=WMS&VERSION=1.1.1&LAYERS=0&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&SRS=EPSG:25831&BBOX=137118.923076923,4488408.75,650959.076923077,4749634.75&WIDTH=895&HEIGHT=455"},6:{key:"cobertesSol",layer:"",url:"http://geoserveis.icgc.cat/servei/catalunya/cobertes-sol/wms?REQUEST=GetMap&SERVICE=WMS&VERSION=1.3.0&LAYERS=cobertes_2009&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&CRS=EPSG:25831&BBOX=374110.828167253,4639230.79853085,452621.120632226,4703578.45000215&WIDTH=1020&HEIGHT=836"}},fgbLayers:{0:{name:"agrupacionsCensalsVigent",key:"agrupacions_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent.fgb"},1:{name:"agrupacionsCensalsVigentText",key:"agrupacions_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/agrupacions_censals_vigent_text.fgb"},2:{name:"areesBasiquesPolicialsVigent",key:"arees_basiques_policials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent.fgb"},3:{name:"areesBasiquesPolicialsVigentText",key:"arees_basiques_policials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_policials_vigent_text.fgb"},4:{name:"areesBasiquesSalutVigent",key:"arees_basiques_salut_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_salut_vigent.fgb"},5:{name:"areesBasiquesServeisSocialsVigent",key:"arees_basiques_serveis_socials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent.fgb"},6:{name:"areesBasiquesServeisSocialsVigentText",key:"arees_basiques_serveis_socials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/arees_basiques_serveis_socials_vigent_text.fgb"},7:{name:"areesGestioAssistencialVigent",key:"arees_gestio_assistencial_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_gestio_assistencial_vigent.fgb"},8:{name:"areesHidrogeologiquesAquifersVigent",key:"arees_hidrogeologiques_aquifers_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/arees_hidrogeologiques_aquifers_vigent.fgb"},9:{name:"catalunyaVigent",key:"catalunya_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent.fgb"},10:{name:"catalunyaVigentText",key:"catalunya_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/catalunya_vigent_text.fgb"},11:{name:"comarquesVigent",key:"comarques_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent.fgb"},12:{name:"comarquesVigentText",key:"comarques_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/comarques_vigent_text.fgb"},13:{name:"districtesCensalsVigent",key:"districtes_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent.fgb"},14:{name:"districtesCensalsVigentText",key:"districtes_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/districtes_censals_vigent_text.fgb"},15:{name:"incendisForestalsVigent",key:"incendis_forestals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent.fgb"},16:{name:"incendisForestalsVigentText",key:"incendis_forestals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/incendis_forestals_vigent_text.fgb"},17:{name:"municipisVigent",key:"municipis_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent.fgb"},18:{name:"municipisVigentText",key:"municipis_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/municipis_vigent_text.fgb"},19:{name:"partitsJudicialsVigent",key:"partits_judicials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent.fgb"},20:{name:"partitsJudicialsVigentText",key:"partits_judicials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/partits_judicials_vigent_text.fgb"},21:{name:"plaTerritorialVigent",key:"pla_territorial_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent.fgb"},22:{name:"plaTerritorialVigentText",key:"pla_territorial_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/pla_territorial_vigent_text.fgb"},23:{name:"provinciesVigent",key:"provincies_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent.fgb"},24:{name:"provinciesVigentText",key:"provincies_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/provincies_vigent_text.fgb"},25:{name:"regionsPolicialsVigent",key:"regions_policials_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent.fgb"},26:{name:"regionsPolicialsVigentText",key:"regions_policials_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/regions_policials_vigent_text.fgb"},27:{name:"regionsSanitariesVigent",key:"regions_sanitaries_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent.fgb"},28:{name:"regionsSanitariesVigentText",key:"regions_sanitaries_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/regions_sanitaries_vigent_text.fgb"},29:{name:"seccionsCensalsVigent",key:"seccions_censals_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent.fgb"},30:{name:"seccionsCensalsVigentText",key:"seccions_censals_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/seccions_censals_vigent_text.fgb"},31:{name:"sectorsSanitarisVigent",key:"sectors_sanitaris_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/sectors_sanitaris_vigent.fgb"},32:{name:"vegueriesVigent",key:"vegueries_vigent",url:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent.fgb"},33:{name:"vegueriesVigentText",key:"vegueries_vigent_text",url:"https://tilemaps.icgc.cat/vector/fgb/vegueries_vigent_text.fgb"}}},$rt="lines",By="labels";let Xrt=class{constructor(t){this.initTheMap(t)}initTheMap(t){if(!t)t=Qn.mapOptions;else for(const e in Qn.mapOptions){let n=[Qn.mapOptions.center[0],Qn.mapOptions.center[1]];Qn.mapOptions.center=n,t.hasOwnProperty(e)||(t[e]=Qn.mapOptions[e])}t.maxPitch=85,t.maplibreLogo=!1,t.attributionControl=!1,this.map=new Ss.Map(t),this.map.options=t,this.map.addControl(new Ss.AttributionControl({compact:!0})),this.map.on("load",async()=>{const e=this.map.getStyle().name,n=this.map.options.style;if(window.document.querySelector(".maplibregl-compact-show")){var i=window.document.querySelector(".maplibregl-compact-show");i.classList.remove("maplibregl-compact-show")}this.map.addControl(new Grt({color:n.indexOf("orto")===-1,defaultOptions:Qn}),"bottom-left"),this._dealOrto3dStyle(e)})}addGeocoderICGC(t){try{t===void 0&&(t="top-right");let e={collapsed:!0,marker:!0,popup:!0,showResultMarkers:!0,maplibregl:Ss,showResultsWhileTyping:!0,minLength:2};const n={forwardGeocode:async s=>{const a=[];try{const o=Qn.geocoder.peliasUrl1+encodeURIComponent(s.query)+Qn.geocoder.peliasUrl2,f=await(await fetch(o)).json();for(const m of f.features){const b=m.geometry.coordinates,x={type:"Feature",geometry:{type:"Point",coordinates:b},place_name:m.properties.label,properties:m.properties,text:m.properties.label,place_type:["place"],center:b};a.push(x)}}catch(o){console.error(`Failed to forwardGeocode with error: ${o}`)}return{features:a}}};this.map.addControl(new zrt(n,e),t);let i=document.getElementsByClassName("maplibregl-ctrl-geocoder--input");i[0].attributes[2].nodeValue="Cerca...",i[0].addEventListener("input",function(s){s.target.value.length>3})}catch(e){console.error(`Error adding ICGC geocoder: ${e.message}`)}}getStyle(){try{return this.map.getStyle()}catch(t){console.error(`Error getting style: ${t.message}`)}}async loadImage(t){try{return this.map.loadImage(t)}catch(e){console.error(`Error getting loadImage: ${e.message}`)}}addImage(t,e){try{return this.map.addImage(t,e)}catch(n){console.error(`Error getting addImage: ${n.message}`)}}getConfigStyles(){try{let t=[];for(const e of Ef)t.push(e.name);return t}catch(t){console.error(`Error retrieving base styles: ${t.message}`)}}getConfigWMSLayers(){try{let t=[];for(const e in Zi.WMS)Zi.WMS.hasOwnProperty(e)&&t.push(e);return t}catch(t){console.error(`Error retrieving WMS layers: ${t.message}`)}}getConfigOrtoLayers(){try{let t=[];for(const e in Zi.Orto)Zi.Orto.hasOwnProperty(e)&&t.push(e);return t}catch(t){console.error(`Error retrieving orto image layers: ${t.message}`)}}getConfigVectorLayers(){try{let t=[];for(const e in Zi.Vector)Zi.Vector.hasOwnProperty(e)&&t.push(e);return t}catch(t){console.error(`Error retrieving vector layers: ${t.message}`)}}getConfigVectorAdminLayers(){try{let t=[];for(const e in Zi.VectorAdmin)Zi.VectorAdmin.hasOwnProperty(e)&&t.push(e);return t}catch(t){console.error(`Error retrieving vectorAdmin layers: ${t.message}`)}}getConfigFGBAdminLayers(){try{let t=[];for(const e in Zi.FGBAdmin)Zi.FGBAdmin.hasOwnProperty(e)&&t.push(e);return t}catch(t){console.error(`Error retrieving FGBAdmin layers: ${t.message}`)}}async fetchData(t,e,n){try{let i=n.layerPosition;if(t.includes(".fgb"))this.addFGBLayerICGC(t,i,null,n);else{const a=await(await fetch(t)).json();let o=e,A=this._dealOrderLayer(i),f=a.features[0].geometry.type;f.includes("ine")&&(n!==void 0?map.addLayer({id:o,type:"line",source:{type:"geojson",data:a},layout:n.layout||{},paint:n.paint||{}},A):map.addLayer({id:o,type:"line",source:{type:"geojson",data:a},layout:{visibility:"visible"},paint:{"line-color":"black","line-width":2,"line-opacity":1}},A)),f.includes("olygon")&&(n!==void 0?map.addLayer({id:o,type:"fill",source:{type:"geojson",data:a},layout:n.layout,paint:n.paint},A):map.addLayer({id:o,type:"fill",source:{type:"geojson",data:a},layout:{visibility:"visible"},paint:{"fill-color":"blue","fill-opacity":.6}},A)),f.includes("oint")&&(n!==void 0?map.addLayer({id:o,type:"circle",source:{type:"geojson",data:a},layout:n.layout,paint:n.paint},A):map.addLayer({id:o,type:"circle",source:{type:"geojson",data:a},layout:{visibility:"visible"},paint:{"circle-color":"red","circle-opacity":.85}},A))}}catch(i){console.error(`Error fetching data: ${i.message}`)}}async fetchDataAndMenu(t,e,n,i){try{let s;i!==null?s=i.layerPosition:s=By;let a,o=document.getElementById("map");if(document.getElementById("menu-group")?a=document.getElementById("menu-group"):(a=document.createElement("nav"),a.id="menu-group",a.classList.add="filter-group",o.appendChild(a)),a!==null){let A="visible",f=this._dealOrderLayer(s),m;if(t.includes(".fgb")){let x=this._getKeyByUrlFGB(t);x===null&&(x="userFGB");const C=await fetch(t),M={type:"FeatureCollection",features:[]};for await(const N of JE(C.body))M.features.push(N);m=M;let U=x;if(this.map.addSource(U,{type:"geojson",data:M}),t.includes("text"))i!==void 0?this.map.addLayer({id:x,type:"symbol",source:U,layout:i.layout,paint:i.paint},f):this.map.addLayer({id:x,type:"symbol",source:U,layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[8,0],[12,14],[15,15]]},"text-font":["FiraSans-Regular"],"text-field":["get","NOM_AC"],"text-transform":"none","text-max-width":25,visibility:A,"text-justify":"right","text-anchor":"top","text-allow-overlap":!1,"symbol-spacing":2,"text-line-height":1},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},f);else{let N=x+"Text";this.map.addLayer({id:N,type:"symbol",source:U,layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[8,0],[12,14],[15,15]]},"text-font":["FiraSans-Regular"],"text-field":["get","NOM_AC"],"text-transform":"none","text-max-width":25,visibility:A,"text-justify":"right","text-anchor":"top","text-allow-overlap":!1,"symbol-spacing":2,"text-line-height":1},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},f)}}else m=await(await fetch(t)).json();if(n!=="all"){const x=document.createElement("div");x.id="titleDivMenu",x.textContent=e,a.appendChild(x);const C=document.createElement("div");C.id="titleDivMenuSub",C.textContent=` ${n}`,a.appendChild(C)}let b=m.features[0].geometry.type;if(n==="all")b.includes("ine")&&(i!==void 0?this.map.addLayer({id:e,type:"line",source:{type:"geojson",data:m},layout:i.layout,paint:i.paint},f):this.map.addLayer({id:e,type:"line",source:{type:"geojson",data:m},layout:{visibility:"visible"},paint:{"line-color":"black","line-width":2,"line-opacity":1}},f)),b.includes("olygon")&&(i!==void 0?this.map.addLayer({id:e,type:"fill",source:{type:"geojson",data:m},layout:i.layout,paint:i.paint},f):this.map.addLayer({id:e,type:"fill",source:{type:"geojson",data:m},layout:{visibility:"visible"},paint:{"fill-color":"#0000FF","fill-opacity":0}},f)),b.includes("oint")&&(i!==void 0?this.map.addLayer({id:e,type:"circle",source:{type:"geojson",data:m},layout:i.layout,paint:i.paint},f):this.map.addLayer({id:e,type:"circle",source:{type:"geojson",data:m},layout:{visibility:"visible"},paint:{"circle-color":"red","circle-opacity":.85}},f)),b.includes("ymbol")&&(i!==void 0?this.map.addLayer({id:e,type:"symbol",source:{type:"geojson",data:m},layout:i.layout,paint:i.paint},f):this.map.addLayer({id:e,type:"symbol",source:{type:"geojson",data:m},layout:{visibility:"visible"},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},f)),this.addMenuItem(e);else{let x=n;const C={};m.features.forEach(M=>{const U=M.properties[x],N=U+"-userFieldFilter-"+e;U!==null&&(C[N]||(b.includes("ine")&&(i!==void 0?this.map.addLayer({id:N,type:"line",source:{type:"geojson",data:m},layout:i.layout,paint:i.paint,filter:["==",`${x}`,U]},f):this.map.addLayer({id:N,type:"line",source:{type:"geojson",data:m},layout:{visibility:"visible"},filter:["==",`${x}`,U],paint:{"line-color":"black","line-width":2,"line-opacity":1}},f)),b.includes("olygon")&&(i!==void 0?this.map.addLayer({id:N,type:"fill",source:{type:"geojson",data:m},filter:["==",`${x}`,U],layout:i.layout,paint:i.paint},f):this.map.addLayer({id:N,type:"fill",source:{type:"geojson",data:m},layout:{visibility:"visible"},filter:["==",`${x}`,U],paint:{"fill-color":"blue","fill-opacity":.6}},f)),b.includes("oint")&&(i!==void 0?this.map.addLayer({id:N,type:"circle",source:{type:"geojson",data:m},filter:["==",`${x}`,U],layout:i.layout,paint:i.paint},f):this.map.addLayer({id:N,type:"circle",source:{type:"geojson",data:m},layout:{visibility:"visible"},filter:["==",`${x}`,U],paint:{"circle-color":"red","circle-opacity":.85}},f)),C[N]=!0,this.addMenuItem(N)))})}}}catch(s){console.error(`Error fetching data: ${s.message}`)}}on(t,e){setTimeout(()=>{try{this.map.on(t,e)}catch(n){console.error(`Error adding event ON listener: ${n.message}`)}},500)}getSource(t){try{return this.map.getSource(t)}catch(e){console.error(`Error getting source: ${e.message}`)}}addSource(t,e){try{this.map.addSource(t,e)}catch(n){console.error(`Error adding source: ${n.message}`)}}setStyle(t,e){try{e!==void 0?this.map.setStyle(t,e):this.map.setStyle(t),this.map.on("styledata",()=>{if(window.document.querySelector(".maplibregl-compact-show")){var n=window.document.querySelector(".maplibregl-compact-show");n.classList.remove("maplibregl-compact-show")}this._dealOrto3dStyle(this.map.getStyle().name)})}catch(n){console.error(`Error setting style: ${n.message}`)}}getLayer(t){try{return this.map.getLayer(t)}catch(e){console.error(`Error getting layer: ${e.message}`)}}setFilter(t,e,n){try{return this.map.setFilter(t,e,n)}catch(i){console.error(`Error setting filter: ${i.message}`)}}jumpTo(t){try{this.map.jumpTo(t)}catch(e){console.error(`Error jumping to ${t}: ${e.message}`)}}setLayoutProperty(t,e,n){try{this.map.setLayoutProperty(t,e,n)}catch(i){console.error(`Error setting layout property: ${i.message}`)}}setPaintProperty(t,e,n){try{this.map.setPaintProperty(t,e,n)}catch(i){console.error(`Error setting paint property: ${i.message}`)}}addControl(t,e){try{e===void 0&&(e="top-right"),this.map.addControl(t,e)}catch(n){console.error(`Error adding control: ${n.message}`)}}getZoom(){try{return this.map.getZoom()}catch(t){console.error(`Error getting zoom level: ${t.message}`)}}addMouseCoordControl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"bottom-left";try{this.map.addControl(new Krt(t),e)}catch(n){console.error(`Error adding mouse coordinate control: ${n.message}`)}}addGeolocateControl(t,e){try{e===void 0&&(e="top-right"),t===void 0?this.map.addControl(new Ss.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),e):this.map.addControl(new Ss.GeolocateControl(t),e)}catch(n){console.error(`Error adding geolocate control: ${n.message}`)}}addFullscreenControl(t,e){try{e===void 0&&(e="top-right"),t===void 0?this.map.addControl(new Ss.FullscreenControl({container:HTMLElement}),e):this.map.addControl(new Ss.FullscreenControl(t),e)}catch(n){console.error(`Error adding fullscreen control: ${n.message}`)}}getBounds(){try{return this.map.getBounds()}catch(t){console.error(`Error getting bounds: ${t.message}`)}}getCenter(){try{return this.map.getCenter()}catch(t){console.error(`Error getting center: ${t.message}`)}}setTerrain(t){try{return this.map.setTerrain(t)}catch(e){console.error(`Error setting terrain: ${e.message}`)}}setLayerZoomRange(t,e,n){try{return this.map.setLayerZoomRange(t,e,n)}catch(i){console.error(`Error setting terrain: ${i.message}`)}}getCanvas(){try{return this.map.getCanvas()}catch(t){console.error(`Error getting canvas: ${t.message}`)}}setCenter(t){try{return this.map.setCenter(t)}catch(e){console.error(`Error setting center: ${e.message}`)}}addLayer(t,e){try{this.map.addLayer(t,e)}catch(n){console.error(`Error adding layer: ${n.message}`)}}addLayerGeoJSON(t,e){try{let n=this._dealOrderLayer(e);this.map.addSource(`${t.id}`,{type:"geojson",data:t.data}),this.map.addLayer({id:`${t.id}-layerIcgcMap`,type:t.layerType,source:`${t.id}`,layout:t.layout,paint:t.paint},n)}catch(n){console.error(`Error adding GeoJSON layer: ${n.message}`)}}addLayerWMS(t,e,n){try{let i=this._dealOrderLayer(e);n?(this.map.addSource(`${t.id}`,{type:n.type||"raster",tiles:[t.tiles],tileSize:256},i),this.map.addLayer({id:t.id,type:n.type,source:t.id,layout:n.layout,paint:n.paint},i)):(this.map.addSource(`${t.id}`,{type:"raster",tiles:[t.tiles],tileSize:256},i),this.map.addLayer({id:t.id,type:"raster",source:t.id,paint:{}},i))}catch(i){console.error(`Error adding WMS layer: ${i.message}`)}}removeControl(t){try{this.map.removeControl(t)}catch(e){console.error(`Error removing control: ${e.message}`)}}removeLayer(t){try{this.map.removeLayer(t)}catch(e){console.error(`Error removing layer: ${e.message}`)}}removeSource(t){try{this.map.removeSource(t)}catch(e){console.error(`Error removing source: ${e.message}`)}}addLogo(t,e){try{const n=document.createElement("img");n.src=t.url,n.style.height=t.height;const i=document.getElementById("logos"),s=document.createElement("a");s.id=t.id,s.href=t.href,s.target="_blank",s.style.position="relative",s.style.bottom="1px",s.appendChild(n),i.appendChild(s)}catch(n){console.error(`Error adding logo: ${n.message}`)}}addBasemapsICGC(t){try{const e=i=>{map.setStyle(i)},n=document.getElementById("basemap-group");for(const i of t)for(const s of Object.keys(Qn.baseStyles)){const a=Qn.baseStyles[s];if(i===a.url){const o=document.createElement("div");o.className="basemap-item",o.title=a.key,o.style.backgroundImage=`url('${a.image}')`,n.appendChild(o),o.addEventListener("click",()=>e(a.url))}}}catch(e){console.error(`Error adding basemaps: ${e.message}`)}}addBasemaps(t){try{const e=i=>{map.setStyle(i.url)},n=document.getElementById("basemap-group");t.forEach(i=>{const s=document.createElement("div");s.className="basemap-item",s.title=i.label,s.style.backgroundImage=`url('${i.image}')`,n.appendChild(s),s.addEventListener("click",()=>e(i))})}catch(e){console.error(`Error adding basemaps: ${e.message}`)}}addFeatureQuery(t,e,n){try{let i;this.map.on("mouseenter",t,()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave",t,()=>{this.map.getCanvas().style.cursor=""}),this.map.on("click",s=>{let a=this.map.queryRenderedFeatures(s.point);if(a&&a[0].source.includes(t)){let o=[s.lngLat.lng,s.lngLat.lat];if(e!==void 0&&e.length>0&&e!=="all"){if(e!==null){let A="";e.forEach(f=>{let m=a[0].properties[f];A=A+`<h4>${m}</h4>`}),i=A,map.addPopup(o,i,n)}}else{let A="";for(const f in a[0].properties)A+="<b>"+f+"</b>:"+a[0].properties[f]+"<br>";i=A,map.addPopup(o,i,n)}}})}catch(i){console.error(`Error adding feature query: ${i.message}`)}}addScaleControl(t,e){try{var n=new Ss.ScaleControl(t);this.map.addControl(n,e)}catch(i){console.error(`Error adding scale: ${i.message}`)}}addExportControl(t,e){try{typeof t=="string"&&(e=t,t=void 0),t===void 0&&(t={PageSize:Qh.A4,PageOrientation:xg.Landscape,Format:Uu.PNG,DPI:r2[300],Crosshair:!0,PrintableArea:!0},e="top-right"),this.map.addControl(new Jet(t),e)}catch(n){console.error(`Error adding export control: ${n.message}`)}}addPopup(t,e){try{new Ss.Popup().setLngLat(t).setHTML(e).addTo(this.map)}catch{}}addMarker(t){try{let e,n;return t.text===void 0?e=new Ss.Marker(t.options).setLngLat(t.coord).addTo(this.map):(n=new Ss.Popup({offset:t.textOffset}).setText(t.text),e=new Ss.Marker().setLngLat(t.coord).setPopup(n).addTo(this.map)),e}catch(e){return console.error(`Error adding marker: ${e.message}`),null}}addPopup(t,e,n){try{return n.image===void 0?new Ss.Popup().setLngLat(t).setHTML(`
        <div class="popupBody">
          <div class="popupTop">
          ${n.title}
          </div>
          <div class="popupBottom">
          <div class="popupBottomUp">
 ${e}
          </div>
          <div class="popupBottomDown">
          </div>
          </div>
        </div>
      `).addTo(this.map):new Ss.Popup().setLngLat(t).setHTML(`
        <div class="popupBody">
          <div class="popupTop">
          ${n.title}
          </div>
          <div class="popupBottom">
          <div class="popupBottomUp">
          ${e}
          </div>
          <div class="popupBottomDown">
             <img style="  padding: 8px;  width: 50%;" src=${n.image} />
          </div>
          </div>
        </div>
      `).addTo(this.map)}catch(i){return console.error(`Error adding popup: ${i.message}`),null}}addFullScreen(t){try{t===void 0&&(t="top-right"),this.map.addControl(new Ss.FullscreenControl,t)}catch(e){console.error(`Error adding fullscreen control: ${e.message}`)}}addMenuItem(t){try{let e;if(t.includes("-userFieldFilter-")?e=t.split("-userFieldFilter-")[0]:e=t,t.length>0){const n=document.getElementById("menu-group"),i=document.createElement("input");i.type="checkbox",i.id=t,i.checked=!0,n.appendChild(i);const s=document.createElement("label");s.setAttribute("for",t),s.textContent=e,n.appendChild(s),i.addEventListener("change",a=>{this.map.setLayoutProperty(t,"visibility",a.target.checked?"visible":"none")})}}catch(e){console.error(`Error adding menu item: ${e.message}`)}}addLayerTree(t){try{let e=t.features;const n=document.getElementById("filter-group");this.map.addSource(`${t.id}`,{type:t.type,data:e}),e.features.forEach(i=>{const s=i.properties.icon,a=`poi-${s}`;if(!this.map.getLayer(a)){this.map.addLayer({id:a,type:"circle",source:`${t.id}`,paint:{"circle-radius":6,"circle-color":"#B42222"},filter:["==","icon",s]},this._firstSymbolLayer());const o=document.createElement("input");o.type="checkbox",o.id=a,o.checked=!0,n.appendChild(o);const A=document.createElement("label");A.setAttribute("for",a),A.textContent=s,n.appendChild(A),o.addEventListener("change",f=>{this.map.setLayoutProperty(a,"visibility",f.target.checked?"visible":"none")})}})}catch(e){console.error(`Error adding layer tree: ${e.message}`)}}createNavigationControl(t,e){try{e===void 0&&(e="top-right"),this.map.addControl(new Ss.NavigationControl(t),e)}catch(n){return console.error(`Error creating navigation control: ${n.message}`),null}}addNavigationControl(t,e){try{e===void 0&&(e="top-right"),this.map.addControl(new Ss.NavigationControl(t),e)}catch(n){console.error(`Error adding navigation control: ${n.message}`)}}addAttributionControl(t,e){try{this.map.addControl(new Ss.AttributionControl(t),e)}catch(n){console.error(`Error adding attribution control: ${n.message}`)}}_dealStyleMaps(t){try{if(t&&t.indexOf("icgc.cat")!=-1){for(const e in Ef)if(Ef.hasOwnProperty(e)){const n=Ef[e];if(e===t)return n}return Ef[0]}else return t}catch(e){return console.error(`Error dealing with map styles: ${e.message}`),null}}addImageLayerICGC(t,e,n){try{let i=null,s,a;n?(a=n,s=n.position):a={type:"raster",layout:{visibility:"visible"},paint:{"raster-opacity":1},position:By},i=this._findImageType(e,Zi.Orto,Zi.VectorAdmin,Zi.WMS,Zi.Vector),i||console.log(" %c The layer: %c%s%c does not exist in the ICGC DB. Consult the documentation.","font-weight: bold; font-style: italic;","font-weight: normal; font-style: normal; color: red;",e,"font-weight: bold; font-style: italic;");let o={id:t,tiles:e};this.addLayerWMS(o,s,a)}catch(i){console.error(`Error adding ICGC image layer: ${i.message}`)}}async addVectorLayerICGC(t,e,n){try{let{type:i="line",position:s=By,layoutOptions:a={visibility:"visible"},paintOption:o}=n||{},A=this._dealOrderLayer(s);if(!e){console.log(" %c The layer: %c%s%c does not exist in the ICGC DB. Consult the documentation.","font-weight: bold; font-style: italic;","font-weight: normal; font-style: normal; color: red;",e,"font-weight: bold; font-style: italic;");return}if(e.includes("https")){let f=this._getKeyByUrlVector(e);this.map.addSource(f,{type:"vector",url:e});let m={id:f,type:"fill",source:f,"source-layer":"cobertes",maxzoom:18,layout:a,paint:Wrt.cobertesSol};if(f==="cobertes2018"&&this.map.addLayer(m,A),a.visibility==="visible"){let b=this._getLegendByName(f);map.addLegend(f,b)}}else{let f=t;this.map.addSource(f,{type:"vector",url:Qn.limitsUrl});let m={id:t,type:i,source:f,"source-layer":e,layout:a,paint:o||{}};i==="fill"||i==="polygon"?m.paint=o||{"fill-color":"#0000FF","fill-opacity":0}:i==="line"&&(m.paint=o||{"line-color":"#4832a8","line-opacity":1,"line-width":1}),this.map.addLayer(m,A)}}catch(i){console.error(`Error adding ICGC vector layer: ${i.message}`)}}async addFGBLayerICGC(t,e,n){try{let i="visible",s=this._dealOrderLayer(e),a=this._getKeyByUrlFGB(t);a===null&&(a="userFGB");const o=await fetch(t),A={type:"FeatureCollection",features:[]};for await(const m of JE(o.body))A.features.push(m);let f=a;if(this.map.addSource(f,{type:"geojson",data:A}),t.includes("text"))this.map.addLayer({id:a,type:"symbol",source:f,layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[8,0],[12,14],[15,15]]},"text-font":["FiraSans-Regular"],"text-field":["get","NOM_AC"],"text-transform":"none","text-max-width":25,visibility:i,"text-justify":"right","text-anchor":"top","text-allow-overlap":!1,"symbol-spacing":2,"text-line-height":1},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},s);else{this.map.addLayer({id:a+"-fill",type:"fill",source:f,paint:{"fill-color":"#0000FF","fill-opacity":0}},s),this.map.addLayer({id:a+"-underline",type:"line",source:f,paint:{"line-color":"#ffffff","line-opacity":1,"line-width":3}},s),n?this.map.addLayer({id:a+"-line",type:"line",source:f,paint:n},s):this.map.addLayer({id:a+"-line",type:"line",source:f,paint:{"line-color":"#4832a8","line-opacity":1,"line-width":1}},s);let m=a+"Text";this.map.addLayer({id:m,type:"symbol",source:f,layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[8,0],[12,14],[15,15]]},"text-font":["FiraSans-Regular"],"text-field":["get","NOM_AC"],"text-transform":"none","text-max-width":25,visibility:i,"text-justify":"right","text-anchor":"top","text-allow-overlap":!1,"symbol-spacing":2,"text-line-height":1},paint:{"text-halo-blur":.5,"text-color":"rgba(90, 7, 7, 1)","text-halo-width":2,"text-halo-color":"rgba(255, 255, 255,0.8)"}},s)}}catch(i){console.error(`Error adding ICGC FGB layer: ${i.message}`)}}addTerrainICGC(t,e){try{let n;for(const s in xy)if(xy.hasOwnProperty(s)){const a=xy[s];a===t&&(n=a)}let i=n;this.getSource("terrainICGC")!==void 0&&(this.getStyle().layers.forEach(a=>{a.source==="terrainICGC"&&this.removeLayer(a.id)}),this.removeSource("terrainICGC")),this.getSource("terrainICGC")===void 0&&(t.includes("terrarium")?this.map.addSource("terrainICGC",{type:"raster-dem",tiles:[i],tileSize:512,encoding:"terrarium",maxzoom:16}):this.map.addSource("terrainICGC",{type:"raster-dem",tiles:[i],tileSize:512,maxzoom:16})),this.map.setTerrain({source:"terrainICGC",exaggeration:1.5}),e===void 0&&(e="top-right"),this.map.addControl(new eN({pitch:90,bearing:null,minpitchzoom:null}),e)}catch(n){console.error(`Error adding 3D terrain: ${n.message}`)}}addLegend(t,e){try{this.map.addControl(new Vrt({name:t,legendUrl:e}))}catch(n){console.error(`Error adding legend: ${n.message}`)}}_findImageType(t,e,n,i,s){const a=[e,n,i,s];for(const o of a)for(const[A,f]of Object.entries(o))if(f===t)return A;return null}_getKeyByUrlFGB(t){for(const e in Zi.FGBAdmin)if(Zi.FGBAdmin.hasOwnProperty(e)&&Zi.FGBAdmin[e]===t)return e;return null}_getLegendByName(t){for(const e in Qn.vectorLayers){const n=Qn.vectorLayers[e];if(n.key===t)return n.legend}return null}_getKeyByUrlVector(t){for(const e in Zi.Vector)if(Zi.Vector.hasOwnProperty(e)&&Zi.Vector[e]===t)return e;return null}async _raiseText3DStyle(){try{const t=await this.map.loadImage(Qn.map3dOptions.imageIcon);this.map.addImage("stick",t.data),this.map.getStyle().layers.forEach(e=>{if(e["source-layer"]===Qn.map3dOptions.sourceLayerFilterId&&e.minzoom>=Qn.map3dOptions.minZoomFilter&&t){const n=e.id;this.map.setLayoutProperty(n,"icon-image","stick"),this.map.setLayoutProperty(n,"text-offset",[0,-9]),this.map.setLayoutProperty(n,"symbol-placement","point"),this.map.setLayoutProperty(n,"symbol-avoid-edges",!1),this.map.setLayoutProperty(n,"text-allow-overlap",!0),this.map.setLayoutProperty(n,"text-ignore-placement",!1),this.map.setLayoutProperty(n,"text-pitch-alignment","auto"),this.map.setLayoutProperty(n,"text-rotation-alignment","auto"),this.map.setLayoutProperty(n,"text-justify","center"),this.map.setLayoutProperty(n,"text-anchor","bottom"),this.map.setLayoutProperty(n,"icon-anchor","bottom"),this.map.setPaintProperty(n,"text-color","#ffffff"),this.map.setPaintProperty(n,"text-halo-color","#000000"),this.map.setPaintProperty(n,"text-halo-width",2)}})}catch(t){return console.error(`Error dealing orto 3D: ${t.message}`),null}}_dealOrto3dStyle(t){try{if(t=="orto3d"){this.map.setMaxZoom(18.8),this.map.easeTo({pitch:45});const e=new zT({intensity:4}),n=new Fb({ambientLight:e});this.map.setTerrain({source:Qn.map3dOptions.terrainSource,exaggeration:Qn.map3dOptions.exaggeration});const i=this._createCitiesMapboxLayer();this.map.getLayer(Qn.map3dOptions.layerId3d)||(this.map.addLayer(i,Qn.map3dOptions.layerIdOrder),this.map.setLayerZoomRange(Qn.map3dOptions.layerId3d,Qn.map3dOptions.minZoomRange,Qn.map3dOptions.maxZoomRange),i.deck.setProps({effects:[n]}),this._raiseText3DStyle())}else this.map.getLayer(Qn.map3dOptions.layerId3d)&&(this.map.removeLayer(Qn.map3dOptions.layerId3d),this.map.setTerrain(null))}catch(e){return console.error(`Error dealing orto 3D: ${e.message}`),null}}_dealOrderLayer(t){return t===By?this._firstSymbolLayer():t===$rt?this._firstLineLayer():""}_firstSymbolLayer(){try{const t=this.map.getStyle().layers;let e;for(let n=0;n<t.length;n++)if(t[n].type==="symbol"){e=t[n].id;break}return e}catch(t){console.error(`Error getting first symbol layer: ${t.message}`)}}_firstLineLayer(){try{const t=this.map.getStyle().layers;let e;for(let n=0;n<t.length;n++)if(t[n].type==="line"){e=t[n].id;break}return e}catch(t){console.error(`Error getting first symbol layer: ${t.message}`)}}_createCitiesMapboxLayer(){try{return new MW({id:Qn.map3dOptions.layerId3d,type:e2,data:Qn.map3dOptions.urlTilesetCities,loader:t2,loadOptions:{tileset:{viewDistanceScale:1,updateTransforms:!0,maximumScreenSpaceError:Qn.map3dOptions.spaceErrorFactor}},onTilesetLoad:e=>{e.options.maximumScreenSpaceError=Qn.map3dOptions.spaceErrorFactor},onTileLoad:e=>{e.content.cartographicOrigin.z-=Qn.map3dOptions.zfactor},operation:"terrain+draw"})}catch(t){return console.error(`Error adding MapboxLayer: ${t.message}`),null}}};var b4={exports:{}};function Yrt(r,t){var e=r.getCenter(),n=r.getZoom(),i=r.getBearing(),s=r.getPitch();t.forEach(function(a){a.jumpTo({center:e,zoom:n,bearing:i,pitch:s})})}function Jrt(){var r,t=arguments.length;if(t===1)r=arguments[0];else{r=[];for(var e=0;e<t;e++)r.push(arguments[e])}var n=[];r.forEach(function(o,A){n[A]=a.bind(null,o,r.filter(function(f,m){return m!==A}))});function i(){r.forEach(function(o,A){o.on("move",n[A])})}function s(){r.forEach(function(o,A){o.off("move",n[A])})}function a(o,A){s(),Yrt(o,A),i()}return i(),function(){s(),n=[],r=[]}}var Zrt=Jrt;(function(r){var t=Zrt,e=p4.EventEmitter;function n(i,s,a,o){if(this.options=o||{},this._mapA=i,this._mapB=s,this._horizontal=this.options.orientation==="horizontal",this._onDown=this._onDown.bind(this),this._onMove=this._onMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._ev=new e,this._swiper=document.createElement("div"),this._swiper.className=this._horizontal?"compare-swiper-horizontal":"compare-swiper-vertical",this._controlContainer=document.createElement("div"),this._controlContainer.className=this._horizontal?"maplibregl-compare maplibregl-compare-horizontal":"maplibregl-compare",this._controlContainer.className=this._controlContainer.className,this._controlContainer.appendChild(this._swiper),typeof a=="string"&&document.body.querySelectorAll){var A=document.body.querySelectorAll(a)[0];if(!A)throw new Error("Cannot find element with specified container selector.");A.appendChild(this._controlContainer)}else if(a instanceof Element&&a.appendChild)a.appendChild(this._controlContainer);else throw new Error("Invalid container specified. Must be CSS selector or HTML element.");this._bounds=s.getContainer().getBoundingClientRect();var f=(this._horizontal?this._bounds.height:this._bounds.width)/2;this._setPosition(f),this._clearSync=t(i,s),this._onResize=(function(){this._bounds=s.getContainer().getBoundingClientRect(),this.currentPosition&&this._setPosition(this.currentPosition)}).bind(this),s.on("resize",this._onResize),this.options&&this.options.mousemove&&(i.getContainer().addEventListener("mousemove",this._onMove),s.getContainer().addEventListener("mousemove",this._onMove)),this._swiper.addEventListener("mousedown",this._onDown),this._swiper.addEventListener("touchstart",this._onDown)}n.prototype={_setPointerEvents:function(i){this._controlContainer.style.pointerEvents=i,this._swiper.style.pointerEvents=i},_onDown:function(i){i.touches?(document.addEventListener("touchmove",this._onMove),document.addEventListener("touchend",this._onTouchEnd)):(document.addEventListener("mousemove",this._onMove),document.addEventListener("mouseup",this._onMouseUp))},_setPosition:function(i){i=Math.min(i,this._horizontal?this._bounds.height:this._bounds.width);var s=this._horizontal?"translate(0, "+i+"px)":"translate("+i+"px, 0)";this._controlContainer.style.transform=s,this._controlContainer.style.WebkitTransform=s;var a=this._horizontal?"rect(0, 999em, "+i+"px, 0)":"rect(0, "+i+"px, "+this._bounds.height+"px, 0)",o=this._horizontal?"rect("+i+"px, 999em, "+this._bounds.height+"px,0)":"rect(0, 999em, "+this._bounds.height+"px,"+i+"px)";this._mapA.getContainer().style.clip=a,this._mapB.getContainer().style.clip=o,this.currentPosition=i},_onMove:function(i){this.options&&this.options.mousemove&&this._setPointerEvents(i.touches?"auto":"none"),this._horizontal?this._setPosition(this._getY(i)):this._setPosition(this._getX(i))},_onMouseUp:function(){document.removeEventListener("mousemove",this._onMove),document.removeEventListener("mouseup",this._onMouseUp),this.fire("slideend",{currentPosition:this.currentPosition})},_onTouchEnd:function(){document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onTouchEnd),this.fire("slideend",{currentPosition:this.currentPosition})},_getX:function(i){i=i.touches?i.touches[0]:i;var s=i.clientX-this._bounds.left;return s<0&&(s=0),s>this._bounds.width&&(s=this._bounds.width),s},_getY:function(i){i=i.touches?i.touches[0]:i;var s=i.clientY-this._bounds.top;return s<0&&(s=0),s>this._bounds.height&&(s=this._bounds.height),s},setSlider:function(i){this._setPosition(i)},on:function(i,s){return this._ev.on(i,s),this},fire:function(i,s){return this._ev.emit(i,s),this},off:function(i,s){return this._ev.removeListener(i,s),this},remove:function(){this._clearSync(),this._mapB.off("resize",this._onResize);var i=this._mapA.getContainer();i&&(i.style.clip=null,i.removeEventListener("mousemove",this._onMove));var s=this._mapB.getContainer();s&&(s.style.clip=null,s.removeEventListener("mousemove",this._onMove)),this._swiper.removeEventListener("mousedown",this._onDown),this._swiper.removeEventListener("touchstart",this._onDown),this._controlContainer.remove()}},window.maplibregl?maplibregl.Compare=n:r.exports=n})(b4);var tnt=b4.exports;const ent=xp(tnt);class rnt{constructor(t,e,n,i){this.mapCompare=new ent(t.map,e.map,n,{})}}/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var I2=function(r,t){return I2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])},I2(r,t)};function $c(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");I2(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var L2=function(){return L2=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},L2.apply(this,arguments)};function Ro(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(m){try{f(n.next(m))}catch(b){a(b)}}function A(m){try{f(n.throw(m))}catch(b){a(b)}}function f(m){m.done?s(m.value):i(m.value).then(o,A)}f((n=n.apply(r,t||[])).next())})}function go(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(f){return function(m){return A([f,m])}}function A(f){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return e.label++,{value:f[1],done:!1};case 5:e.label++,i=f[1],f=[0];continue;case 7:f=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){e=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){e.label=f[1];break}if(f[0]===6&&e.label<s[1]){e.label=s[1],s=f;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(f);break}s[2]&&e.ops.pop(),e.trys.pop();continue}f=t.call(r,e)}catch(m){f=[6,m],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Cy(r,t,e){if(e||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return r.concat(s||t)}for(var Ou=function(){function r(t,e,n,i){this.left=t,this.top=e,this.width=n,this.height=i}return r.prototype.add=function(t,e,n,i){return new r(this.left+t,this.top+e,this.width+n,this.height+i)},r.fromClientRect=function(t,e){return new r(e.left+t.windowBounds.left,e.top+t.windowBounds.top,e.width,e.height)},r.fromDOMRectList=function(t,e){var n=Array.from(e).find(function(i){return i.width!==0});return n?new r(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height):r.EMPTY},r.EMPTY=new r(0,0,0,0),r}(),Ey=function(r,t){return Ou.fromClientRect(r,t.getBoundingClientRect())},nnt=function(r){var t=r.body,e=r.documentElement;if(!t||!e)throw new Error("Unable to get document size");var n=Math.max(Math.max(t.scrollWidth,e.scrollWidth),Math.max(t.offsetWidth,e.offsetWidth),Math.max(t.clientWidth,e.clientWidth)),i=Math.max(Math.max(t.scrollHeight,e.scrollHeight),Math.max(t.offsetHeight,e.offsetHeight),Math.max(t.clientHeight,e.clientHeight));return new Ou(0,0,n,i)},Sy=function(r){for(var t=[],e=0,n=r.length;e<n;){var i=r.charCodeAt(e++);if(i>=55296&&i<=56319&&e<n){var s=r.charCodeAt(e++);(s&64512)===56320?t.push(((i&1023)<<10)+(s&1023)+65536):(t.push(i),e--)}else t.push(i)}return t},ts=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,r);var e=r.length;if(!e)return"";for(var n=[],i=-1,s="";++i<e;){var a=r[i];a<=65535?n.push(a):(a-=65536,n.push((a>>10)+55296,a%1024+56320)),(i+1===e||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},w4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",int=typeof Uint8Array>"u"?[]:new Uint8Array(256),Ty=0;Ty<w4.length;Ty++)int[w4.charCodeAt(Ty)]=Ty;for(var x4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ig=typeof Uint8Array>"u"?[]:new Uint8Array(256),Iy=0;Iy<x4.length;Iy++)Ig[x4.charCodeAt(Iy)]=Iy;for(var snt=function(r){var t=r.length*.75,e=r.length,n,i=0,s,a,o,A;r[r.length-1]==="="&&(t--,r[r.length-2]==="="&&t--);var f=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),m=Array.isArray(f)?f:new Uint8Array(f);for(n=0;n<e;n+=4)s=Ig[r.charCodeAt(n)],a=Ig[r.charCodeAt(n+1)],o=Ig[r.charCodeAt(n+2)],A=Ig[r.charCodeAt(n+3)],m[i++]=s<<2|a>>4,m[i++]=(a&15)<<4|o>>2,m[i++]=(o&3)<<6|A&63;return f},ont=function(r){for(var t=r.length,e=[],n=0;n<t;n+=2)e.push(r[n+1]<<8|r[n]);return e},ant=function(r){for(var t=r.length,e=[],n=0;n<t;n+=4)e.push(r[n+3]<<24|r[n+2]<<16|r[n+1]<<8|r[n]);return e},jh=5,F2=11,M2=2,cnt=F2-jh,B4=65536>>jh,lnt=1<<jh,P2=lnt-1,unt=1024>>jh,Ant=B4+unt,hnt=Ant,dnt=32,fnt=hnt+dnt,pnt=65536>>F2,gnt=1<<cnt,mnt=gnt-1,C4=function(r,t,e){return r.slice?r.slice(t,e):new Uint16Array(Array.prototype.slice.call(r,t,e))},ynt=function(r,t,e){return r.slice?r.slice(t,e):new Uint32Array(Array.prototype.slice.call(r,t,e))},_nt=function(r,t){var e=snt(r),n=Array.isArray(e)?ant(e):new Uint32Array(e),i=Array.isArray(e)?ont(e):new Uint16Array(e),s=24,a=C4(i,s/2,n[4]/2),o=n[5]===2?C4(i,(s+n[4])/2):ynt(n,Math.ceil((s+n[4])/4));return new vnt(n[0],n[1],n[2],n[3],a,o)},vnt=function(){function r(t,e,n,i,s,a){this.initialValue=t,this.errorValue=e,this.highStart=n,this.highValueIndex=i,this.index=s,this.data=a}return r.prototype.get=function(t){var e;if(t>=0){if(t<55296||t>56319&&t<=65535)return e=this.index[t>>jh],e=(e<<M2)+(t&P2),this.data[e];if(t<=65535)return e=this.index[B4+(t-55296>>jh)],e=(e<<M2)+(t&P2),this.data[e];if(t<this.highStart)return e=fnt-pnt+(t>>F2),e=this.index[e],e+=t>>jh&mnt,e=this.index[e],e=(e<<M2)+(t&P2),this.data[e];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},r}(),E4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bnt=typeof Uint8Array>"u"?[]:new Uint8Array(256),Ly=0;Ly<E4.length;Ly++)bnt[E4.charCodeAt(Ly)]=Ly;var wnt="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",S4=50,xnt=1,T4=2,I4=3,Bnt=4,Cnt=5,L4=7,F4=8,M4=9,NA=10,U2=11,P4=12,R2=13,Ent=14,Lg=15,O2=16,Fy=17,Fg=18,Snt=19,U4=20,D2=21,Mg=22,k2=23,Sf=24,Da=25,Pg=26,Ug=27,Tf=28,Tnt=29,If=30,Int=31,My=32,Py=33,N2=34,Q2=35,H2=36,Rg=37,z2=38,Uy=39,Ry=40,G2=41,R4=42,Lnt=43,Fnt=[9001,65288],O4="!",Oo="",Oy="",V2=_nt(wnt),Du=[If,H2],j2=[xnt,T4,I4,Cnt],D4=[NA,F4],k4=[Ug,Pg],Mnt=j2.concat(D4),N4=[z2,Uy,Ry,N2,Q2],Pnt=[Lg,R2],Unt=function(r,t){t===void 0&&(t="strict");var e=[],n=[],i=[];return r.forEach(function(s,a){var o=V2.get(s);if(o>S4?(i.push(!0),o-=S4):i.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return n.push(a),e.push(O2);if(o===Bnt||o===U2){if(a===0)return n.push(a),e.push(If);var A=e[a-1];return Mnt.indexOf(A)===-1?(n.push(n[a-1]),e.push(A)):(n.push(a),e.push(If))}if(n.push(a),o===Int)return e.push(t==="strict"?D2:Rg);if(o===R4||o===Tnt)return e.push(If);if(o===Lnt)return s>=131072&&s<=196605||s>=196608&&s<=262141?e.push(Rg):e.push(If);e.push(o)}),[n,e,i]},q2=function(r,t,e,n){var i=n[e];if(Array.isArray(r)?r.indexOf(i)!==-1:r===i)for(var s=e;s<=n.length;){s++;var a=n[s];if(a===t)return!0;if(a!==NA)break}if(i===NA)for(var s=e;s>0;){s--;var o=n[s];if(Array.isArray(r)?r.indexOf(o)!==-1:r===o)for(var A=e;A<=n.length;){A++;var a=n[A];if(a===t)return!0;if(a!==NA)break}if(o!==NA)break}return!1},Q4=function(r,t){for(var e=r;e>=0;){var n=t[e];if(n===NA)e--;else return n}return 0},Rnt=function(r,t,e,n,i){if(e[n]===0)return Oo;var s=n-1;if(Array.isArray(i)&&i[s]===!0)return Oo;var a=s-1,o=s+1,A=t[s],f=a>=0?t[a]:0,m=t[o];if(A===T4&&m===I4)return Oo;if(j2.indexOf(A)!==-1)return O4;if(j2.indexOf(m)!==-1||D4.indexOf(m)!==-1)return Oo;if(Q4(s,t)===F4)return Oy;if(V2.get(r[s])===U2||(A===My||A===Py)&&V2.get(r[o])===U2||A===L4||m===L4||A===M4||[NA,R2,Lg].indexOf(A)===-1&&m===M4||[Fy,Fg,Snt,Sf,Tf].indexOf(m)!==-1||Q4(s,t)===Mg||q2(k2,Mg,s,t)||q2([Fy,Fg],D2,s,t)||q2(P4,P4,s,t))return Oo;if(A===NA)return Oy;if(A===k2||m===k2)return Oo;if(m===O2||A===O2)return Oy;if([R2,Lg,D2].indexOf(m)!==-1||A===Ent||f===H2&&Pnt.indexOf(A)!==-1||A===Tf&&m===H2||m===U4||Du.indexOf(m)!==-1&&A===Da||Du.indexOf(A)!==-1&&m===Da||A===Ug&&[Rg,My,Py].indexOf(m)!==-1||[Rg,My,Py].indexOf(A)!==-1&&m===Pg||Du.indexOf(A)!==-1&&k4.indexOf(m)!==-1||k4.indexOf(A)!==-1&&Du.indexOf(m)!==-1||[Ug,Pg].indexOf(A)!==-1&&(m===Da||[Mg,Lg].indexOf(m)!==-1&&t[o+1]===Da)||[Mg,Lg].indexOf(A)!==-1&&m===Da||A===Da&&[Da,Tf,Sf].indexOf(m)!==-1)return Oo;if([Da,Tf,Sf,Fy,Fg].indexOf(m)!==-1)for(var b=s;b>=0;){var x=t[b];if(x===Da)return Oo;if([Tf,Sf].indexOf(x)!==-1)b--;else break}if([Ug,Pg].indexOf(m)!==-1)for(var b=[Fy,Fg].indexOf(A)!==-1?a:s;b>=0;){var x=t[b];if(x===Da)return Oo;if([Tf,Sf].indexOf(x)!==-1)b--;else break}if(z2===A&&[z2,Uy,N2,Q2].indexOf(m)!==-1||[Uy,N2].indexOf(A)!==-1&&[Uy,Ry].indexOf(m)!==-1||[Ry,Q2].indexOf(A)!==-1&&m===Ry||N4.indexOf(A)!==-1&&[U4,Pg].indexOf(m)!==-1||N4.indexOf(m)!==-1&&A===Ug||Du.indexOf(A)!==-1&&Du.indexOf(m)!==-1||A===Sf&&Du.indexOf(m)!==-1||Du.concat(Da).indexOf(A)!==-1&&m===Mg&&Fnt.indexOf(r[o])===-1||Du.concat(Da).indexOf(m)!==-1&&A===Fg)return Oo;if(A===G2&&m===G2){for(var C=e[s],M=1;C>0&&(C--,t[C]===G2);)M++;if(M%2!==0)return Oo}return A===My&&m===Py?Oo:Oy},Ont=function(r,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var e=Unt(r,t.lineBreak),n=e[0],i=e[1],s=e[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(i=i.map(function(o){return[Da,If,R4].indexOf(o)!==-1?Rg:o}));var a=t.wordBreak==="keep-all"?s.map(function(o,A){return o&&r[A]>=19968&&r[A]<=40959}):void 0;return[n,i,a]},Dnt=function(){function r(t,e,n,i){this.codePoints=t,this.required=e===O4,this.start=n,this.end=i}return r.prototype.slice=function(){return ts.apply(void 0,this.codePoints.slice(this.start,this.end))},r}(),knt=function(r,t){var e=Sy(r),n=Ont(e,t),i=n[0],s=n[1],a=n[2],o=e.length,A=0,f=0;return{next:function(){if(f>=o)return{done:!0,value:null};for(var m=Oo;f<o&&(m=Rnt(e,s,i,++f,a))===Oo;);if(m!==Oo||f===o){var b=new Dnt(e,m,A,f);return A=f,{value:b,done:!1}}return{done:!0,value:null}}}},Nnt=1,Qnt=2,Og=4,H4=8,Dy=10,z4=47,Dg=92,Hnt=9,znt=32,ky=34,kg=61,Gnt=35,Vnt=36,jnt=37,Ny=39,Qy=40,Ng=41,qnt=95,ha=45,Knt=33,Wnt=60,$nt=62,Xnt=64,Ynt=91,Jnt=93,Znt=61,tit=123,Hy=63,eit=125,G4=124,rit=126,nit=128,V4=65533,K2=42,qh=43,iit=44,sit=58,oit=59,Qg=46,ait=0,cit=8,lit=11,uit=14,Ait=31,hit=127,$l=-1,j4=48,q4=97,K4=101,dit=102,fit=117,pit=122,W4=65,$4=69,X4=70,git=85,mit=90,Do=function(r){return r>=j4&&r<=57},yit=function(r){return r>=55296&&r<=57343},Lf=function(r){return Do(r)||r>=W4&&r<=X4||r>=q4&&r<=dit},_it=function(r){return r>=q4&&r<=pit},vit=function(r){return r>=W4&&r<=mit},bit=function(r){return _it(r)||vit(r)},wit=function(r){return r>=nit},zy=function(r){return r===Dy||r===Hnt||r===znt},Gy=function(r){return bit(r)||wit(r)||r===qnt},Y4=function(r){return Gy(r)||Do(r)||r===ha},xit=function(r){return r>=ait&&r<=cit||r===lit||r>=uit&&r<=Ait||r===hit},QA=function(r,t){return r!==Dg?!1:t!==Dy},Vy=function(r,t,e){return r===ha?Gy(t)||QA(t,e):Gy(r)?!0:!!(r===Dg&&QA(r,t))},W2=function(r,t,e){return r===qh||r===ha?Do(t)?!0:t===Qg&&Do(e):Do(r===Qg?t:r)},Bit=function(r){var t=0,e=1;(r[t]===qh||r[t]===ha)&&(r[t]===ha&&(e=-1),t++);for(var n=[];Do(r[t]);)n.push(r[t++]);var i=n.length?parseInt(ts.apply(void 0,n),10):0;r[t]===Qg&&t++;for(var s=[];Do(r[t]);)s.push(r[t++]);var a=s.length,o=a?parseInt(ts.apply(void 0,s),10):0;(r[t]===$4||r[t]===K4)&&t++;var A=1;(r[t]===qh||r[t]===ha)&&(r[t]===ha&&(A=-1),t++);for(var f=[];Do(r[t]);)f.push(r[t++]);var m=f.length?parseInt(ts.apply(void 0,f),10):0;return e*(i+o*Math.pow(10,-a))*Math.pow(10,A*m)},Cit={type:2},Eit={type:3},Sit={type:4},Tit={type:13},Iit={type:8},Lit={type:21},Fit={type:9},Mit={type:10},Pit={type:11},Uit={type:12},Rit={type:14},jy={type:23},Oit={type:1},Dit={type:25},kit={type:24},Nit={type:26},Qit={type:27},Hit={type:28},zit={type:29},Git={type:31},$2={type:32},J4=function(){function r(){this._value=[]}return r.prototype.write=function(t){this._value=this._value.concat(Sy(t))},r.prototype.read=function(){for(var t=[],e=this.consumeToken();e!==$2;)t.push(e),e=this.consumeToken();return t},r.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case ky:return this.consumeStringToken(ky);case Gnt:var e=this.peekCodePoint(0),n=this.peekCodePoint(1),i=this.peekCodePoint(2);if(Y4(e)||QA(n,i)){var s=Vy(e,n,i)?Qnt:Nnt,a=this.consumeName();return{type:5,value:a,flags:s}}break;case Vnt:if(this.peekCodePoint(0)===kg)return this.consumeCodePoint(),Tit;break;case Ny:return this.consumeStringToken(Ny);case Qy:return Cit;case Ng:return Eit;case K2:if(this.peekCodePoint(0)===kg)return this.consumeCodePoint(),Rit;break;case qh:if(W2(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case iit:return Sit;case ha:var o=t,A=this.peekCodePoint(0),f=this.peekCodePoint(1);if(W2(o,A,f))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(Vy(o,A,f))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(A===ha&&f===$nt)return this.consumeCodePoint(),this.consumeCodePoint(),kit;break;case Qg:if(W2(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case z4:if(this.peekCodePoint(0)===K2)for(this.consumeCodePoint();;){var m=this.consumeCodePoint();if(m===K2&&(m=this.consumeCodePoint(),m===z4))return this.consumeToken();if(m===$l)return this.consumeToken()}break;case sit:return Nit;case oit:return Qit;case Wnt:if(this.peekCodePoint(0)===Knt&&this.peekCodePoint(1)===ha&&this.peekCodePoint(2)===ha)return this.consumeCodePoint(),this.consumeCodePoint(),Dit;break;case Xnt:var b=this.peekCodePoint(0),x=this.peekCodePoint(1),C=this.peekCodePoint(2);if(Vy(b,x,C)){var a=this.consumeName();return{type:7,value:a}}break;case Ynt:return Hit;case Dg:if(QA(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case Jnt:return zit;case Znt:if(this.peekCodePoint(0)===kg)return this.consumeCodePoint(),Iit;break;case tit:return Pit;case eit:return Uit;case fit:case git:var M=this.peekCodePoint(0),U=this.peekCodePoint(1);return M===qh&&(Lf(U)||U===Hy)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case G4:if(this.peekCodePoint(0)===kg)return this.consumeCodePoint(),Fit;if(this.peekCodePoint(0)===G4)return this.consumeCodePoint(),Lit;break;case rit:if(this.peekCodePoint(0)===kg)return this.consumeCodePoint(),Mit;break;case $l:return $2}return zy(t)?(this.consumeWhiteSpace(),Git):Do(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):Gy(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:ts(t)}},r.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},r.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},r.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},r.prototype.consumeUnicodeRangeToken=function(){for(var t=[],e=this.consumeCodePoint();Lf(e)&&t.length<6;)t.push(e),e=this.consumeCodePoint();for(var n=!1;e===Hy&&t.length<6;)t.push(e),e=this.consumeCodePoint(),n=!0;if(n){var i=parseInt(ts.apply(void 0,t.map(function(A){return A===Hy?j4:A})),16),s=parseInt(ts.apply(void 0,t.map(function(A){return A===Hy?X4:A})),16);return{type:30,start:i,end:s}}var a=parseInt(ts.apply(void 0,t),16);if(this.peekCodePoint(0)===ha&&Lf(this.peekCodePoint(1))){this.consumeCodePoint(),e=this.consumeCodePoint();for(var o=[];Lf(e)&&o.length<6;)o.push(e),e=this.consumeCodePoint();var s=parseInt(ts.apply(void 0,o),16);return{type:30,start:a,end:s}}else return{type:30,start:a,end:a}},r.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===Qy?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Qy?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},r.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===$l)return{type:22,value:""};var e=this.peekCodePoint(0);if(e===Ny||e===ky){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===$l||this.peekCodePoint(0)===Ng)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),jy)}for(;;){var i=this.consumeCodePoint();if(i===$l||i===Ng)return{type:22,value:ts.apply(void 0,t)};if(zy(i))return this.consumeWhiteSpace(),this.peekCodePoint(0)===$l||this.peekCodePoint(0)===Ng?(this.consumeCodePoint(),{type:22,value:ts.apply(void 0,t)}):(this.consumeBadUrlRemnants(),jy);if(i===ky||i===Ny||i===Qy||xit(i))return this.consumeBadUrlRemnants(),jy;if(i===Dg)if(QA(i,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),jy;else t.push(i)}},r.prototype.consumeWhiteSpace=function(){for(;zy(this.peekCodePoint(0));)this.consumeCodePoint()},r.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===Ng||t===$l)return;QA(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},r.prototype.consumeStringSlice=function(t){for(var e=5e4,n="";t>0;){var i=Math.min(e,t);n+=ts.apply(void 0,this._value.splice(0,i)),t-=i}return this._value.shift(),n},r.prototype.consumeStringToken=function(t){var e="",n=0;do{var i=this._value[n];if(i===$l||i===void 0||i===t)return e+=this.consumeStringSlice(n),{type:0,value:e};if(i===Dy)return this._value.splice(0,n),Oit;if(i===Dg){var s=this._value[n+1];s!==$l&&s!==void 0&&(s===Dy?(e+=this.consumeStringSlice(n),n=-1,this._value.shift()):QA(i,s)&&(e+=this.consumeStringSlice(n),e+=ts(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},r.prototype.consumeNumber=function(){var t=[],e=Og,n=this.peekCodePoint(0);for((n===qh||n===ha)&&t.push(this.consumeCodePoint());Do(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0);var i=this.peekCodePoint(1);if(n===Qg&&Do(i))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),e=H4;Do(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0),i=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((n===$4||n===K4)&&((i===qh||i===ha)&&Do(s)||Do(i)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),e=H4;Do(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[Bit(t),e]},r.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),e=t[0],n=t[1],i=this.peekCodePoint(0),s=this.peekCodePoint(1),a=this.peekCodePoint(2);if(Vy(i,s,a)){var o=this.consumeName();return{type:15,number:e,flags:n,unit:o}}return i===jnt?(this.consumeCodePoint(),{type:16,number:e,flags:n}):{type:17,number:e,flags:n}},r.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(Lf(t)){for(var e=ts(t);Lf(this.peekCodePoint(0))&&e.length<6;)e+=ts(this.consumeCodePoint());zy(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(e,16);return n===0||yit(n)||n>1114111?V4:n}return t===$l?V4:t},r.prototype.consumeName=function(){for(var t="";;){var e=this.consumeCodePoint();if(Y4(e))t+=ts(e);else if(QA(e,this.peekCodePoint(0)))t+=ts(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(e),t}},r}(),Z4=function(){function r(t){this._tokens=t}return r.create=function(t){var e=new J4;return e.write(t),new r(e.read())},r.parseValue=function(t){return r.create(t).parseComponentValue()},r.parseValues=function(t){return r.create(t).parseComponentValues()},r.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var e=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return e;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},r.prototype.parseComponentValues=function(){for(var t=[];;){var e=this.consumeComponentValue();if(e.type===32)return t;t.push(e),t.push()}},r.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},r.prototype.consumeSimpleBlock=function(t){for(var e={type:t,values:[]},n=this.consumeToken();;){if(n.type===32||jit(n,t))return e;this.reconsumeToken(n),e.values.push(this.consumeComponentValue()),n=this.consumeToken()}},r.prototype.consumeFunction=function(t){for(var e={name:t.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return e;this.reconsumeToken(n),e.values.push(this.consumeComponentValue())}},r.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?$2:t},r.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},r}(),Hg=function(r){return r.type===15},Ff=function(r){return r.type===17},ni=function(r){return r.type===20},Vit=function(r){return r.type===0},X2=function(r,t){return ni(r)&&r.value===t},tM=function(r){return r.type!==31},Mf=function(r){return r.type!==31&&r.type!==4},Xl=function(r){var t=[],e=[];return r.forEach(function(n){if(n.type===4){if(e.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(e),e=[];return}n.type!==31&&e.push(n)}),e.length&&t.push(e),t},jit=function(r,t){return t===11&&r.type===12||t===28&&r.type===29?!0:t===2&&r.type===3},HA=function(r){return r.type===17||r.type===15},gs=function(r){return r.type===16||HA(r)},eM=function(r){return r.length>1?[r[0],r[1]]:[r[0]]},Ks={type:17,number:0,flags:Og},Y2={type:16,number:50,flags:Og},zA={type:16,number:100,flags:Og},zg=function(r,t,e){var n=r[0],i=r[1];return[gi(n,t),gi(typeof i<"u"?i:n,e)]},gi=function(r,t){if(r.type===16)return r.number/100*t;if(Hg(r))switch(r.unit){case"rem":case"em":return 16*r.number;case"px":default:return r.number}return r.number},rM="deg",nM="grad",iM="rad",sM="turn",qy={name:"angle",parse:function(r,t){if(t.type===15)switch(t.unit){case rM:return Math.PI*t.number/180;case nM:return Math.PI/200*t.number;case iM:return t.number;case sM:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},oM=function(r){return r.type===15&&(r.unit===rM||r.unit===nM||r.unit===iM||r.unit===sM)},aM=function(r){var t=r.filter(ni).map(function(e){return e.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Ks,Ks];case"to top":case"bottom":return ac(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Ks,zA];case"to right":case"left":return ac(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[zA,zA];case"to bottom":case"top":return ac(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[zA,Ks];case"to left":case"right":return ac(270)}return 0},ac=function(r){return Math.PI*r/180},GA={name:"color",parse:function(r,t){if(t.type===18){var e=qit[t.name];if(typeof e>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return e(r,t.values)}if(t.type===5){if(t.value.length===3){var n=t.value.substring(0,1),i=t.value.substring(1,2),s=t.value.substring(2,3);return jA(parseInt(n+n,16),parseInt(i+i,16),parseInt(s+s,16),1)}if(t.value.length===4){var n=t.value.substring(0,1),i=t.value.substring(1,2),s=t.value.substring(2,3),a=t.value.substring(3,4);return jA(parseInt(n+n,16),parseInt(i+i,16),parseInt(s+s,16),parseInt(a+a,16)/255)}if(t.value.length===6){var n=t.value.substring(0,2),i=t.value.substring(2,4),s=t.value.substring(4,6);return jA(parseInt(n,16),parseInt(i,16),parseInt(s,16),1)}if(t.value.length===8){var n=t.value.substring(0,2),i=t.value.substring(2,4),s=t.value.substring(4,6),a=t.value.substring(6,8);return jA(parseInt(n,16),parseInt(i,16),parseInt(s,16),parseInt(a,16)/255)}}if(t.type===20){var o=ku[t.value.toUpperCase()];if(typeof o<"u")return o}return ku.TRANSPARENT}},VA=function(r){return(255&r)===0},Ps=function(r){var t=255&r,e=255&r>>8,n=255&r>>16,i=255&r>>24;return t<255?"rgba("+i+","+n+","+e+","+t/255+")":"rgb("+i+","+n+","+e+")"},jA=function(r,t,e,n){return(r<<24|t<<16|e<<8|Math.round(n*255)<<0)>>>0},cM=function(r,t){if(r.type===17)return r.number;if(r.type===16){var e=t===3?1:255;return t===3?r.number/100*e:Math.round(r.number/100*e)}return 0},lM=function(r,t){var e=t.filter(Mf);if(e.length===3){var n=e.map(cM),i=n[0],s=n[1],a=n[2];return jA(i,s,a,1)}if(e.length===4){var o=e.map(cM),i=o[0],s=o[1],a=o[2],A=o[3];return jA(i,s,a,A)}return 0};function J2(r,t,e){return e<0&&(e+=1),e>=1&&(e-=1),e<1/6?(t-r)*e*6+r:e<1/2?t:e<2/3?(t-r)*6*(2/3-e)+r:r}var uM=function(r,t){var e=t.filter(Mf),n=e[0],i=e[1],s=e[2],a=e[3],o=(n.type===17?ac(n.number):qy.parse(r,n))/(Math.PI*2),A=gs(i)?i.number/100:0,f=gs(s)?s.number/100:0,m=typeof a<"u"&&gs(a)?gi(a,1):1;if(A===0)return jA(f*255,f*255,f*255,1);var b=f<=.5?f*(A+1):f+A-f*A,x=f*2-b,C=J2(x,b,o+1/3),M=J2(x,b,o),U=J2(x,b,o-1/3);return jA(C*255,M*255,U*255,m)},qit={hsl:uM,hsla:uM,rgb:lM,rgba:lM},Gg=function(r,t){return GA.parse(r,Z4.create(t).parseComponentValue())},ku={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Kit={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(r,t){return t.map(function(e){if(ni(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Wit={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Ky=function(r,t){var e=GA.parse(r,t[0]),n=t[1];return n&&gs(n)?{color:e,stop:n}:{color:e,stop:null}},AM=function(r,t){var e=r[0],n=r[r.length-1];e.stop===null&&(e.stop=Ks),n.stop===null&&(n.stop=zA);for(var i=[],s=0,a=0;a<r.length;a++){var o=r[a].stop;if(o!==null){var A=gi(o,t);A>s?i.push(A):i.push(s),s=A}else i.push(null)}for(var f=null,a=0;a<i.length;a++){var m=i[a];if(m===null)f===null&&(f=a);else if(f!==null){for(var b=a-f,x=i[f-1],C=(m-x)/(b+1),M=1;M<=b;M++)i[f+M-1]=C*M;f=null}}return r.map(function(U,N){var Q=U.color;return{color:Q,stop:Math.max(Math.min(1,i[N]/t),0)}})},$it=function(r,t,e){var n=t/2,i=e/2,s=gi(r[0],t)-n,a=i-gi(r[1],e);return(Math.atan2(a,s)+Math.PI*2)%(Math.PI*2)},Xit=function(r,t,e){var n=typeof r=="number"?r:$it(r,t,e),i=Math.abs(t*Math.sin(n))+Math.abs(e*Math.cos(n)),s=t/2,a=e/2,o=i/2,A=Math.sin(n-Math.PI/2)*o,f=Math.cos(n-Math.PI/2)*o;return[i,s-f,s+f,a-A,a+A]},Xc=function(r,t){return Math.sqrt(r*r+t*t)},hM=function(r,t,e,n,i){var s=[[0,0],[0,t],[r,0],[r,t]];return s.reduce(function(a,o){var A=o[0],f=o[1],m=Xc(e-A,n-f);return(i?m<a.optimumDistance:m>a.optimumDistance)?{optimumCorner:o,optimumDistance:m}:a},{optimumDistance:i?1/0:-1/0,optimumCorner:null}).optimumCorner},Yit=function(r,t,e,n,i){var s=0,a=0;switch(r.size){case 0:r.shape===0?s=a=Math.min(Math.abs(t),Math.abs(t-n),Math.abs(e),Math.abs(e-i)):r.shape===1&&(s=Math.min(Math.abs(t),Math.abs(t-n)),a=Math.min(Math.abs(e),Math.abs(e-i)));break;case 2:if(r.shape===0)s=a=Math.min(Xc(t,e),Xc(t,e-i),Xc(t-n,e),Xc(t-n,e-i));else if(r.shape===1){var o=Math.min(Math.abs(e),Math.abs(e-i))/Math.min(Math.abs(t),Math.abs(t-n)),A=hM(n,i,t,e,!0),f=A[0],m=A[1];s=Xc(f-t,(m-e)/o),a=o*s}break;case 1:r.shape===0?s=a=Math.max(Math.abs(t),Math.abs(t-n),Math.abs(e),Math.abs(e-i)):r.shape===1&&(s=Math.max(Math.abs(t),Math.abs(t-n)),a=Math.max(Math.abs(e),Math.abs(e-i)));break;case 3:if(r.shape===0)s=a=Math.max(Xc(t,e),Xc(t,e-i),Xc(t-n,e),Xc(t-n,e-i));else if(r.shape===1){var o=Math.max(Math.abs(e),Math.abs(e-i))/Math.max(Math.abs(t),Math.abs(t-n)),b=hM(n,i,t,e,!1),f=b[0],m=b[1];s=Xc(f-t,(m-e)/o),a=o*s}break}return Array.isArray(r.size)&&(s=gi(r.size[0],n),a=r.size.length===2?gi(r.size[1],i):s),[s,a]},Jit=function(r,t){var e=ac(180),n=[];return Xl(t).forEach(function(i,s){if(s===0){var a=i[0];if(a.type===20&&a.value==="to"){e=aM(i);return}else if(oM(a)){e=qy.parse(r,a);return}}var o=Ky(r,i);n.push(o)}),{angle:e,stops:n,type:1}},Wy=function(r,t){var e=ac(180),n=[];return Xl(t).forEach(function(i,s){if(s===0){var a=i[0];if(a.type===20&&["top","left","right","bottom"].indexOf(a.value)!==-1){e=aM(i);return}else if(oM(a)){e=(qy.parse(r,a)+ac(270))%ac(360);return}}var o=Ky(r,i);n.push(o)}),{angle:e,stops:n,type:1}},Zit=function(r,t){var e=ac(180),n=[],i=1,s=0,a=3,o=[];return Xl(t).forEach(function(A,f){var m=A[0];if(f===0){if(ni(m)&&m.value==="linear"){i=1;return}else if(ni(m)&&m.value==="radial"){i=2;return}}if(m.type===18){if(m.name==="from"){var b=GA.parse(r,m.values[0]);n.push({stop:Ks,color:b})}else if(m.name==="to"){var b=GA.parse(r,m.values[0]);n.push({stop:zA,color:b})}else if(m.name==="color-stop"){var x=m.values.filter(Mf);if(x.length===2){var b=GA.parse(r,x[1]),C=x[0];Ff(C)&&n.push({stop:{type:16,number:C.number*100,flags:C.flags},color:b})}}}}),i===1?{angle:(e+ac(180))%ac(360),stops:n,type:i}:{size:a,shape:s,stops:n,position:o,type:i}},dM="closest-side",fM="farthest-side",pM="closest-corner",gM="farthest-corner",mM="circle",yM="ellipse",_M="cover",vM="contain",tst=function(r,t){var e=0,n=3,i=[],s=[];return Xl(t).forEach(function(a,o){var A=!0;if(o===0){var f=!1;A=a.reduce(function(b,x){if(f)if(ni(x))switch(x.value){case"center":return s.push(Y2),b;case"top":case"left":return s.push(Ks),b;case"right":case"bottom":return s.push(zA),b}else(gs(x)||HA(x))&&s.push(x);else if(ni(x))switch(x.value){case mM:return e=0,!1;case yM:return e=1,!1;case"at":return f=!0,!1;case dM:return n=0,!1;case _M:case fM:return n=1,!1;case vM:case pM:return n=2,!1;case gM:return n=3,!1}else if(HA(x)||gs(x))return Array.isArray(n)||(n=[]),n.push(x),!1;return b},A)}if(A){var m=Ky(r,a);i.push(m)}}),{size:n,shape:e,stops:i,position:s,type:2}},$y=function(r,t){var e=0,n=3,i=[],s=[];return Xl(t).forEach(function(a,o){var A=!0;if(o===0?A=a.reduce(function(m,b){if(ni(b))switch(b.value){case"center":return s.push(Y2),!1;case"top":case"left":return s.push(Ks),!1;case"right":case"bottom":return s.push(zA),!1}else if(gs(b)||HA(b))return s.push(b),!1;return m},A):o===1&&(A=a.reduce(function(m,b){if(ni(b))switch(b.value){case mM:return e=0,!1;case yM:return e=1,!1;case vM:case dM:return n=0,!1;case fM:return n=1,!1;case pM:return n=2,!1;case _M:case gM:return n=3,!1}else if(HA(b)||gs(b))return Array.isArray(n)||(n=[]),n.push(b),!1;return m},A)),A){var f=Ky(r,a);i.push(f)}}),{size:n,shape:e,stops:i,position:s,type:2}},est=function(r){return r.type===1},rst=function(r){return r.type===2},Z2={name:"image",parse:function(r,t){if(t.type===22){var e={url:t.value,type:0};return r.cache.addImage(t.value),e}if(t.type===18){var n=bM[t.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return n(r,t.values)}throw new Error("Unsupported image type "+t.type)}};function nst(r){return!(r.type===20&&r.value==="none")&&(r.type!==18||!!bM[r.name])}var bM={"linear-gradient":Jit,"-moz-linear-gradient":Wy,"-ms-linear-gradient":Wy,"-o-linear-gradient":Wy,"-webkit-linear-gradient":Wy,"radial-gradient":tst,"-moz-radial-gradient":$y,"-ms-radial-gradient":$y,"-o-radial-gradient":$y,"-webkit-radial-gradient":$y,"-webkit-gradient":Zit},ist={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(r,t){if(t.length===0)return[];var e=t[0];return e.type===20&&e.value==="none"?[]:t.filter(function(n){return Mf(n)&&nst(n)}).map(function(n){return Z2.parse(r,n)})}},sst={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(r,t){return t.map(function(e){if(ni(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},ost={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(r,t){return Xl(t).map(function(e){return e.filter(gs)}).map(eM)}},ast={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(r,t){return Xl(t).map(function(e){return e.filter(ni).map(function(n){return n.value}).join(" ")}).map(cst)}},cst=function(r){switch(r){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},Pf;(function(r){r.AUTO="auto",r.CONTAIN="contain",r.COVER="cover"})(Pf||(Pf={}));var lst={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(r,t){return Xl(t).map(function(e){return e.filter(ust)})}},ust=function(r){return ni(r)||gs(r)},Xy=function(r){return{name:"border-"+r+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},Ast=Xy("top"),hst=Xy("right"),dst=Xy("bottom"),fst=Xy("left"),Yy=function(r){return{name:"border-radius-"+r,initialValue:"0 0",prefix:!1,type:1,parse:function(t,e){return eM(e.filter(gs))}}},pst=Yy("top-left"),gst=Yy("top-right"),mst=Yy("bottom-right"),yst=Yy("bottom-left"),Jy=function(r){return{name:"border-"+r+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,e){switch(e){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},_st=Jy("top"),vst=Jy("right"),bst=Jy("bottom"),wst=Jy("left"),Zy=function(r){return{name:"border-"+r+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Hg(e)?e.number:0}}},xst=Zy("top"),Bst=Zy("right"),Cst=Zy("bottom"),Est=Zy("left"),Sst={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Tst={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(r,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},Ist={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(r,t){return t.filter(ni).reduce(function(e,n){return e|Lst(n.value)},0)}},Lst=function(r){switch(r){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Fst={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(r,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Mst={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(r,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},t1;(function(r){r.NORMAL="normal",r.STRICT="strict"})(t1||(t1={}));var Pst={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(r,t){switch(t){case"strict":return t1.STRICT;case"normal":default:return t1.NORMAL}}},Ust={name:"line-height",initialValue:"normal",prefix:!1,type:4},wM=function(r,t){return ni(r)&&r.value==="normal"?1.2*t:r.type===17?t*r.number:gs(r)?gi(r,t):t},Rst={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(r,t){return t.type===20&&t.value==="none"?null:Z2.parse(r,t)}},Ost={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(r,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},tx={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(r,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},e1=function(r){return{name:"margin-"+r,initialValue:"0",prefix:!1,type:4}},Dst=e1("top"),kst=e1("right"),Nst=e1("bottom"),Qst=e1("left"),Hst={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(r,t){return t.filter(ni).map(function(e){switch(e.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},zst={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(r,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},r1=function(r){return{name:"padding-"+r,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Gst=r1("top"),Vst=r1("right"),jst=r1("bottom"),qst=r1("left"),Kst={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(r,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},Wst={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(r,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},$st={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(r,t){return t.length===1&&X2(t[0],"none")?[]:Xl(t).map(function(e){for(var n={color:ku.TRANSPARENT,offsetX:Ks,offsetY:Ks,blur:Ks},i=0,s=0;s<e.length;s++){var a=e[s];HA(a)?(i===0?n.offsetX=a:i===1?n.offsetY=a:n.blur=a,i++):n.color=GA.parse(r,a)}return n})}},Xst={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(r,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},Yst={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(r,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var e=tot[t.name];if(typeof e>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return e(t.values)}return null}},Jst=function(r){var t=r.filter(function(e){return e.type===17}).map(function(e){return e.number});return t.length===6?t:null},Zst=function(r){var t=r.filter(function(A){return A.type===17}).map(function(A){return A.number}),e=t[0],n=t[1];t[2],t[3];var i=t[4],s=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var a=t[12],o=t[13];return t[14],t[15],t.length===16?[e,n,i,s,a,o]:null},tot={matrix:Jst,matrix3d:Zst},xM={type:16,number:50,flags:Og},eot=[xM,xM],rot={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(r,t){var e=t.filter(gs);return e.length!==2?eot:[e[0],e[1]]}},not={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(r,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Vg;(function(r){r.NORMAL="normal",r.BREAK_ALL="break-all",r.KEEP_ALL="keep-all"})(Vg||(Vg={}));for(var iot={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(r,t){switch(t){case"break-all":return Vg.BREAK_ALL;case"keep-all":return Vg.KEEP_ALL;case"normal":default:return Vg.NORMAL}}},sot={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(r,t){if(t.type===20)return{auto:!0,order:0};if(Ff(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},BM={name:"time",parse:function(r,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},oot={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(r,t){return Ff(t)?t.number:1}},aot={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},cot={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(r,t){return t.filter(ni).map(function(e){switch(e.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(e){return e!==0})}},lot={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(r,t){var e=[],n=[];return t.forEach(function(i){switch(i.type){case 20:case 0:e.push(i.value);break;case 17:e.push(i.number.toString());break;case 4:n.push(e.join(" ")),e.length=0;break}}),e.length&&n.push(e.join(" ")),n.map(function(i){return i.indexOf(" ")===-1?i:"'"+i+"'"})}},uot={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},Aot={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(r,t){if(Ff(t))return t.number;if(ni(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},hot={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(r,t){return t.filter(ni).map(function(e){return e.value})}},dot={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(r,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},xs=function(r,t){return(r&t)!==0},fot={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(r,t){if(t.length===0)return[];var e=t[0];return e.type===20&&e.value==="none"?[]:t}},pot={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(r,t){if(t.length===0)return null;var e=t[0];if(e.type===20&&e.value==="none")return null;for(var n=[],i=t.filter(tM),s=0;s<i.length;s++){var a=i[s],o=i[s+1];if(a.type===20){var A=o&&Ff(o)?o.number:1;n.push({counter:a.value,increment:A})}}return n}},got={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(r,t){if(t.length===0)return[];for(var e=[],n=t.filter(tM),i=0;i<n.length;i++){var s=n[i],a=n[i+1];if(ni(s)&&s.value!=="none"){var o=a&&Ff(a)?a.number:0;e.push({counter:s.value,reset:o})}}return e}},mot={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(r,t){return t.filter(Hg).map(function(e){return BM.parse(r,e)})}},yot={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(r,t){if(t.length===0)return null;var e=t[0];if(e.type===20&&e.value==="none")return null;var n=[],i=t.filter(Vit);if(i.length%2!==0)return null;for(var s=0;s<i.length;s+=2){var a=i[s].value,o=i[s+1].value;n.push({open:a,close:o})}return n}},CM=function(r,t,e){if(!r)return"";var n=r[Math.min(t,r.length-1)];return n?e?n.open:n.close:""},_ot={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(r,t){return t.length===1&&X2(t[0],"none")?[]:Xl(t).map(function(e){for(var n={color:255,offsetX:Ks,offsetY:Ks,blur:Ks,spread:Ks,inset:!1},i=0,s=0;s<e.length;s++){var a=e[s];X2(a,"inset")?n.inset=!0:HA(a)?(i===0?n.offsetX=a:i===1?n.offsetY=a:i===2?n.blur=a:n.spread=a,i++):n.color=GA.parse(r,a)}return n})}},vot={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(r,t){var e=[0,1,2],n=[];return t.filter(ni).forEach(function(i){switch(i.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),e.forEach(function(i){n.indexOf(i)===-1&&n.push(i)}),n}},bot={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},wot={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(r,t){return Hg(t)?t.number:0}},xot=function(){function r(t,e){var n,i;this.animationDuration=dr(t,mot,e.animationDuration),this.backgroundClip=dr(t,Kit,e.backgroundClip),this.backgroundColor=dr(t,Wit,e.backgroundColor),this.backgroundImage=dr(t,ist,e.backgroundImage),this.backgroundOrigin=dr(t,sst,e.backgroundOrigin),this.backgroundPosition=dr(t,ost,e.backgroundPosition),this.backgroundRepeat=dr(t,ast,e.backgroundRepeat),this.backgroundSize=dr(t,lst,e.backgroundSize),this.borderTopColor=dr(t,Ast,e.borderTopColor),this.borderRightColor=dr(t,hst,e.borderRightColor),this.borderBottomColor=dr(t,dst,e.borderBottomColor),this.borderLeftColor=dr(t,fst,e.borderLeftColor),this.borderTopLeftRadius=dr(t,pst,e.borderTopLeftRadius),this.borderTopRightRadius=dr(t,gst,e.borderTopRightRadius),this.borderBottomRightRadius=dr(t,mst,e.borderBottomRightRadius),this.borderBottomLeftRadius=dr(t,yst,e.borderBottomLeftRadius),this.borderTopStyle=dr(t,_st,e.borderTopStyle),this.borderRightStyle=dr(t,vst,e.borderRightStyle),this.borderBottomStyle=dr(t,bst,e.borderBottomStyle),this.borderLeftStyle=dr(t,wst,e.borderLeftStyle),this.borderTopWidth=dr(t,xst,e.borderTopWidth),this.borderRightWidth=dr(t,Bst,e.borderRightWidth),this.borderBottomWidth=dr(t,Cst,e.borderBottomWidth),this.borderLeftWidth=dr(t,Est,e.borderLeftWidth),this.boxShadow=dr(t,_ot,e.boxShadow),this.color=dr(t,Sst,e.color),this.direction=dr(t,Tst,e.direction),this.display=dr(t,Ist,e.display),this.float=dr(t,Fst,e.cssFloat),this.fontFamily=dr(t,lot,e.fontFamily),this.fontSize=dr(t,uot,e.fontSize),this.fontStyle=dr(t,dot,e.fontStyle),this.fontVariant=dr(t,hot,e.fontVariant),this.fontWeight=dr(t,Aot,e.fontWeight),this.letterSpacing=dr(t,Mst,e.letterSpacing),this.lineBreak=dr(t,Pst,e.lineBreak),this.lineHeight=dr(t,Ust,e.lineHeight),this.listStyleImage=dr(t,Rst,e.listStyleImage),this.listStylePosition=dr(t,Ost,e.listStylePosition),this.listStyleType=dr(t,tx,e.listStyleType),this.marginTop=dr(t,Dst,e.marginTop),this.marginRight=dr(t,kst,e.marginRight),this.marginBottom=dr(t,Nst,e.marginBottom),this.marginLeft=dr(t,Qst,e.marginLeft),this.opacity=dr(t,oot,e.opacity);var s=dr(t,Hst,e.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=dr(t,zst,e.overflowWrap),this.paddingTop=dr(t,Gst,e.paddingTop),this.paddingRight=dr(t,Vst,e.paddingRight),this.paddingBottom=dr(t,jst,e.paddingBottom),this.paddingLeft=dr(t,qst,e.paddingLeft),this.paintOrder=dr(t,vot,e.paintOrder),this.position=dr(t,Wst,e.position),this.textAlign=dr(t,Kst,e.textAlign),this.textDecorationColor=dr(t,aot,(n=e.textDecorationColor)!==null&&n!==void 0?n:e.color),this.textDecorationLine=dr(t,cot,(i=e.textDecorationLine)!==null&&i!==void 0?i:e.textDecoration),this.textShadow=dr(t,$st,e.textShadow),this.textTransform=dr(t,Xst,e.textTransform),this.transform=dr(t,Yst,e.transform),this.transformOrigin=dr(t,rot,e.transformOrigin),this.visibility=dr(t,not,e.visibility),this.webkitTextStrokeColor=dr(t,bot,e.webkitTextStrokeColor),this.webkitTextStrokeWidth=dr(t,wot,e.webkitTextStrokeWidth),this.wordBreak=dr(t,iot,e.wordBreak),this.zIndex=dr(t,sot,e.zIndex)}return r.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},r.prototype.isTransparent=function(){return VA(this.backgroundColor)},r.prototype.isTransformed=function(){return this.transform!==null},r.prototype.isPositioned=function(){return this.position!==0},r.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},r.prototype.isFloating=function(){return this.float!==0},r.prototype.isInlineLevel=function(){return xs(this.display,4)||xs(this.display,33554432)||xs(this.display,268435456)||xs(this.display,536870912)||xs(this.display,67108864)||xs(this.display,134217728)},r}(),Bot=function(){function r(t,e){this.content=dr(t,fot,e.content),this.quotes=dr(t,yot,e.quotes)}return r}(),EM=function(){function r(t,e){this.counterIncrement=dr(t,pot,e.counterIncrement),this.counterReset=dr(t,got,e.counterReset)}return r}(),dr=function(r,t,e){var n=new J4,i=e!==null&&typeof e<"u"?e.toString():t.initialValue;n.write(i);var s=new Z4(n.read());switch(t.type){case 2:var a=s.parseComponentValue();return t.parse(r,ni(a)?a.value:t.initialValue);case 0:return t.parse(r,s.parseComponentValue());case 1:return t.parse(r,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(t.format){case"angle":return qy.parse(r,s.parseComponentValue());case"color":return GA.parse(r,s.parseComponentValue());case"image":return Z2.parse(r,s.parseComponentValue());case"length":var o=s.parseComponentValue();return HA(o)?o:Ks;case"length-percentage":var A=s.parseComponentValue();return gs(A)?A:Ks;case"time":return BM.parse(r,s.parseComponentValue())}break}},Cot="data-html2canvas-debug",Eot=function(r){var t=r.getAttribute(Cot);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},ex=function(r,t){var e=Eot(r);return e===1||t===e},Yl=function(){function r(t,e){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,ex(e,3))debugger;this.styles=new xot(t,window.getComputedStyle(e,null)),fx(e)&&(this.styles.animationDuration.some(function(n){return n>0})&&(e.style.animationDuration="0s"),this.styles.transform!==null&&(e.style.transform="none")),this.bounds=Ey(this.context,e),ex(e,4)&&(this.flags|=16)}return r}(),Sot="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",SM="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",jg=typeof Uint8Array>"u"?[]:new Uint8Array(256),n1=0;n1<SM.length;n1++)jg[SM.charCodeAt(n1)]=n1;for(var Tot=function(r){var t=r.length*.75,e=r.length,n,i=0,s,a,o,A;r[r.length-1]==="="&&(t--,r[r.length-2]==="="&&t--);var f=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),m=Array.isArray(f)?f:new Uint8Array(f);for(n=0;n<e;n+=4)s=jg[r.charCodeAt(n)],a=jg[r.charCodeAt(n+1)],o=jg[r.charCodeAt(n+2)],A=jg[r.charCodeAt(n+3)],m[i++]=s<<2|a>>4,m[i++]=(a&15)<<4|o>>2,m[i++]=(o&3)<<6|A&63;return f},Iot=function(r){for(var t=r.length,e=[],n=0;n<t;n+=2)e.push(r[n+1]<<8|r[n]);return e},Lot=function(r){for(var t=r.length,e=[],n=0;n<t;n+=4)e.push(r[n+3]<<24|r[n+2]<<16|r[n+1]<<8|r[n]);return e},Kh=5,rx=11,nx=2,Fot=rx-Kh,TM=65536>>Kh,Mot=1<<Kh,ix=Mot-1,Pot=1024>>Kh,Uot=TM+Pot,Rot=Uot,Oot=32,Dot=Rot+Oot,kot=65536>>rx,Not=1<<Fot,Qot=Not-1,IM=function(r,t,e){return r.slice?r.slice(t,e):new Uint16Array(Array.prototype.slice.call(r,t,e))},Hot=function(r,t,e){return r.slice?r.slice(t,e):new Uint32Array(Array.prototype.slice.call(r,t,e))},zot=function(r,t){var e=Tot(r),n=Array.isArray(e)?Lot(e):new Uint32Array(e),i=Array.isArray(e)?Iot(e):new Uint16Array(e),s=24,a=IM(i,s/2,n[4]/2),o=n[5]===2?IM(i,(s+n[4])/2):Hot(n,Math.ceil((s+n[4])/4));return new Got(n[0],n[1],n[2],n[3],a,o)},Got=function(){function r(t,e,n,i,s,a){this.initialValue=t,this.errorValue=e,this.highStart=n,this.highValueIndex=i,this.index=s,this.data=a}return r.prototype.get=function(t){var e;if(t>=0){if(t<55296||t>56319&&t<=65535)return e=this.index[t>>Kh],e=(e<<nx)+(t&ix),this.data[e];if(t<=65535)return e=this.index[TM+(t-55296>>Kh)],e=(e<<nx)+(t&ix),this.data[e];if(t<this.highStart)return e=Dot-kot+(t>>rx),e=this.index[e],e+=t>>Kh&Qot,e=this.index[e],e=(e<<nx)+(t&ix),this.data[e];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},r}(),LM="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Vot=typeof Uint8Array>"u"?[]:new Uint8Array(256),i1=0;i1<LM.length;i1++)Vot[LM.charCodeAt(i1)]=i1;var jot=1,sx=2,ox=3,FM=4,MM=5,qot=7,PM=8,ax=9,cx=10,UM=11,RM=12,OM=13,DM=14,lx=15,Kot=function(r){for(var t=[],e=0,n=r.length;e<n;){var i=r.charCodeAt(e++);if(i>=55296&&i<=56319&&e<n){var s=r.charCodeAt(e++);(s&64512)===56320?t.push(((i&1023)<<10)+(s&1023)+65536):(t.push(i),e--)}else t.push(i)}return t},Wot=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,r);var e=r.length;if(!e)return"";for(var n=[],i=-1,s="";++i<e;){var a=r[i];a<=65535?n.push(a):(a-=65536,n.push((a>>10)+55296,a%1024+56320)),(i+1===e||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},$ot=zot(Sot),Wh="",kM="",Xot=function(r){return $ot.get(r)},Yot=function(r,t,e){var n=e-2,i=t[n],s=t[e-1],a=t[e];if(s===sx&&a===ox)return Wh;if(s===sx||s===ox||s===FM||a===sx||a===ox||a===FM)return kM;if(s===PM&&[PM,ax,UM,RM].indexOf(a)!==-1||(s===UM||s===ax)&&(a===ax||a===cx)||(s===RM||s===cx)&&a===cx||a===OM||a===MM||a===qot||s===jot)return Wh;if(s===OM&&a===DM){for(;i===MM;)i=t[--n];if(i===DM)return Wh}if(s===lx&&a===lx){for(var o=0;i===lx;)o++,i=t[--n];if(o%2===0)return Wh}return kM},Jot=function(r){var t=Kot(r),e=t.length,n=0,i=0,s=t.map(Xot);return{next:function(){if(n>=e)return{done:!0,value:null};for(var a=Wh;n<e&&(a=Yot(t,s,++n))===Wh;);if(a!==Wh||n===e){var o=Wot.apply(null,t.slice(i,n));return i=n,{value:o,done:!1}}return{done:!0,value:null}}}},Zot=function(r){for(var t=Jot(r),e=[],n;!(n=t.next()).done;)n.value&&e.push(n.value.slice());return e},tat=function(r){var t=123;if(r.createRange){var e=r.createRange();if(e.getBoundingClientRect){var n=r.createElement("boundtest");n.style.height=t+"px",n.style.display="block",r.body.appendChild(n),e.selectNode(n);var i=e.getBoundingClientRect(),s=Math.round(i.height);if(r.body.removeChild(n),s===t)return!0}}return!1},eat=function(r){var t=r.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",r.body.appendChild(t);var e=r.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=t.firstChild,i=Sy(n.data).map(function(A){return ts(A)}),s=0,a={},o=i.every(function(A,f){e.setStart(n,s),e.setEnd(n,s+A.length);var m=e.getBoundingClientRect();s+=A.length;var b=m.x>a.x||m.y>a.y;return a=m,f===0?!0:b});return r.body.removeChild(t),o},rat=function(){return typeof new Image().crossOrigin<"u"},nat=function(){return typeof new XMLHttpRequest().responseType=="string"},iat=function(r){var t=new Image,e=r.createElement("canvas"),n=e.getContext("2d");if(!n)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),e.toDataURL()}catch{return!1}return!0},NM=function(r){return r[0]===0&&r[1]===255&&r[2]===0&&r[3]===255},sat=function(r){var t=r.createElement("canvas"),e=100;t.width=e,t.height=e;var n=t.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,e,e);var i=new Image,s=t.toDataURL();i.src=s;var a=ux(e,e,0,0,i);return n.fillStyle="red",n.fillRect(0,0,e,e),QM(a).then(function(o){n.drawImage(o,0,0);var A=n.getImageData(0,0,e,e).data;n.fillStyle="red",n.fillRect(0,0,e,e);var f=r.createElement("div");return f.style.backgroundImage="url("+s+")",f.style.height=e+"px",NM(A)?QM(ux(e,e,0,0,f)):Promise.reject(!1)}).then(function(o){return n.drawImage(o,0,0),NM(n.getImageData(0,0,e,e).data)}).catch(function(){return!1})},ux=function(r,t,e,n,i){var s="http://www.w3.org/2000/svg",a=document.createElementNS(s,"svg"),o=document.createElementNS(s,"foreignObject");return a.setAttributeNS(null,"width",r.toString()),a.setAttributeNS(null,"height",t.toString()),o.setAttributeNS(null,"width","100%"),o.setAttributeNS(null,"height","100%"),o.setAttributeNS(null,"x",e.toString()),o.setAttributeNS(null,"y",n.toString()),o.setAttributeNS(null,"externalResourcesRequired","true"),a.appendChild(o),o.appendChild(i),a},QM=function(r){return new Promise(function(t,e){var n=new Image;n.onload=function(){return t(n)},n.onerror=e,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(r))})},Ws={get SUPPORT_RANGE_BOUNDS(){var r=tat(document);return Object.defineProperty(Ws,"SUPPORT_RANGE_BOUNDS",{value:r}),r},get SUPPORT_WORD_BREAKING(){var r=Ws.SUPPORT_RANGE_BOUNDS&&eat(document);return Object.defineProperty(Ws,"SUPPORT_WORD_BREAKING",{value:r}),r},get SUPPORT_SVG_DRAWING(){var r=iat(document);return Object.defineProperty(Ws,"SUPPORT_SVG_DRAWING",{value:r}),r},get SUPPORT_FOREIGNOBJECT_DRAWING(){var r=typeof Array.from=="function"&&typeof window.fetch=="function"?sat(document):Promise.resolve(!1);return Object.defineProperty(Ws,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:r}),r},get SUPPORT_CORS_IMAGES(){var r=rat();return Object.defineProperty(Ws,"SUPPORT_CORS_IMAGES",{value:r}),r},get SUPPORT_RESPONSE_TYPE(){var r=nat();return Object.defineProperty(Ws,"SUPPORT_RESPONSE_TYPE",{value:r}),r},get SUPPORT_CORS_XHR(){var r="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Ws,"SUPPORT_CORS_XHR",{value:r}),r},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var r=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Ws,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:r}),r}},qg=function(){function r(t,e){this.text=t,this.bounds=e}return r}(),oat=function(r,t,e,n){var i=lat(t,e),s=[],a=0;return i.forEach(function(o){if(e.textDecorationLine.length||o.trim().length>0)if(Ws.SUPPORT_RANGE_BOUNDS){var A=HM(n,a,o.length).getClientRects();if(A.length>1){var f=Ax(o),m=0;f.forEach(function(x){s.push(new qg(x,Ou.fromDOMRectList(r,HM(n,m+a,x.length).getClientRects()))),m+=x.length})}else s.push(new qg(o,Ou.fromDOMRectList(r,A)))}else{var b=n.splitText(o.length);s.push(new qg(o,aat(r,n))),n=b}else Ws.SUPPORT_RANGE_BOUNDS||(n=n.splitText(o.length));a+=o.length}),s},aat=function(r,t){var e=t.ownerDocument;if(e){var n=e.createElement("html2canvaswrapper");n.appendChild(t.cloneNode(!0));var i=t.parentNode;if(i){i.replaceChild(n,t);var s=Ey(r,n);return n.firstChild&&i.replaceChild(n.firstChild,n),s}}return Ou.EMPTY},HM=function(r,t,e){var n=r.ownerDocument;if(!n)throw new Error("Node has no owner document");var i=n.createRange();return i.setStart(r,t),i.setEnd(r,t+e),i},Ax=function(r){if(Ws.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(r)).map(function(e){return e.segment})}return Zot(r)},cat=function(r,t){if(Ws.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(e.segment(r)).map(function(n){return n.segment})}return Aat(r,t)},lat=function(r,t){return t.letterSpacing!==0?Ax(r):cat(r,t)},uat=[32,160,4961,65792,65793,4153,4241],Aat=function(r,t){for(var e=knt(r,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),n=[],i,s=function(){if(i.value){var a=i.value.slice(),o=Sy(a),A="";o.forEach(function(f){uat.indexOf(f)===-1?A+=ts(f):(A.length&&n.push(A),n.push(ts(f)),A="")}),A.length&&n.push(A)}};!(i=e.next()).done;)s();return n},hat=function(){function r(t,e,n){this.text=dat(e.data,n.textTransform),this.textBounds=oat(t,this.text,n,e)}return r}(),dat=function(r,t){switch(t){case 1:return r.toLowerCase();case 3:return r.replace(fat,pat);case 2:return r.toUpperCase();default:return r}},fat=/(^|\s|:|-|\(|\))([a-z])/g,pat=function(r,t,e){return r.length>0?t+e.toUpperCase():r},zM=function(r){$c(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.src=n.currentSrc||n.src,i.intrinsicWidth=n.naturalWidth,i.intrinsicHeight=n.naturalHeight,i.context.cache.addImage(i.src),i}return t}(Yl),GM=function(r){$c(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.canvas=n,i.intrinsicWidth=n.width,i.intrinsicHeight=n.height,i}return t}(Yl),VM=function(r){$c(t,r);function t(e,n){var i=r.call(this,e,n)||this,s=new XMLSerializer,a=Ey(e,n);return n.setAttribute("width",a.width+"px"),n.setAttribute("height",a.height+"px"),i.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(n)),i.intrinsicWidth=n.width.baseVal.value,i.intrinsicHeight=n.height.baseVal.value,i.context.cache.addImage(i.svg),i}return t}(Yl),jM=function(r){$c(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.value=n.value,i}return t}(Yl),hx=function(r){$c(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.start=n.start,i.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,i}return t}(Yl),gat=[{type:15,flags:0,unit:"px",number:3}],mat=[{type:16,flags:0,number:50}],yat=function(r){return r.width>r.height?new Ou(r.left+(r.width-r.height)/2,r.top,r.height,r.height):r.width<r.height?new Ou(r.left,r.top+(r.height-r.width)/2,r.width,r.width):r},_at=function(r){var t=r.type===vat?new Array(r.value.length+1).join(""):r.value;return t.length===0?r.placeholder||"":t},s1="checkbox",o1="radio",vat="password",qM=707406591,dx=function(r){$c(t,r);function t(e,n){var i=r.call(this,e,n)||this;switch(i.type=n.type.toLowerCase(),i.checked=n.checked,i.value=_at(n),(i.type===s1||i.type===o1)&&(i.styles.backgroundColor=3739148031,i.styles.borderTopColor=i.styles.borderRightColor=i.styles.borderBottomColor=i.styles.borderLeftColor=2779096575,i.styles.borderTopWidth=i.styles.borderRightWidth=i.styles.borderBottomWidth=i.styles.borderLeftWidth=1,i.styles.borderTopStyle=i.styles.borderRightStyle=i.styles.borderBottomStyle=i.styles.borderLeftStyle=1,i.styles.backgroundClip=[0],i.styles.backgroundOrigin=[0],i.bounds=yat(i.bounds)),i.type){case s1:i.styles.borderTopRightRadius=i.styles.borderTopLeftRadius=i.styles.borderBottomRightRadius=i.styles.borderBottomLeftRadius=gat;break;case o1:i.styles.borderTopRightRadius=i.styles.borderTopLeftRadius=i.styles.borderBottomRightRadius=i.styles.borderBottomLeftRadius=mat;break}return i}return t}(Yl),KM=function(r){$c(t,r);function t(e,n){var i=r.call(this,e,n)||this,s=n.options[n.selectedIndex||0];return i.value=s&&s.text||"",i}return t}(Yl),WM=function(r){$c(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.value=n.value,i}return t}(Yl),$M=function(r){$c(t,r);function t(e,n){var i=r.call(this,e,n)||this;i.src=n.src,i.width=parseInt(n.width,10)||0,i.height=parseInt(n.height,10)||0,i.backgroundColor=i.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){i.tree=YM(e,n.contentWindow.document.documentElement);var s=n.contentWindow.document.documentElement?Gg(e,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):ku.TRANSPARENT,a=n.contentWindow.document.body?Gg(e,getComputedStyle(n.contentWindow.document.body).backgroundColor):ku.TRANSPARENT;i.backgroundColor=VA(s)?VA(a)?i.styles.backgroundColor:a:s}}catch{}return i}return t}(Yl),bat=["OL","UL","MENU"],a1=function(r,t,e,n){for(var i=t.firstChild,s=void 0;i;i=s)if(s=i.nextSibling,JM(i)&&i.data.trim().length>0)e.textNodes.push(new hat(r,i,e.styles));else if(Uf(i))if(iP(i)&&i.assignedNodes)i.assignedNodes().forEach(function(o){return a1(r,o,e,n)});else{var a=XM(r,i);a.styles.isVisible()&&(wat(i,a,n)?a.flags|=4:xat(a.styles)&&(a.flags|=2),bat.indexOf(i.tagName)!==-1&&(a.flags|=8),e.elements.push(a),i.slot,i.shadowRoot?a1(r,i.shadowRoot,a,n):!l1(i)&&!ZM(i)&&!u1(i)&&a1(r,i,a,n))}},XM=function(r,t){return gx(t)?new zM(r,t):tP(t)?new GM(r,t):ZM(t)?new VM(r,t):Bat(t)?new jM(r,t):Cat(t)?new hx(r,t):Eat(t)?new dx(r,t):u1(t)?new KM(r,t):l1(t)?new WM(r,t):rP(t)?new $M(r,t):new Yl(r,t)},YM=function(r,t){var e=XM(r,t);return e.flags|=4,a1(r,t,e,e),e},wat=function(r,t,e){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||px(r)&&e.styles.isTransparent()},xat=function(r){return r.isPositioned()||r.isFloating()},JM=function(r){return r.nodeType===Node.TEXT_NODE},Uf=function(r){return r.nodeType===Node.ELEMENT_NODE},fx=function(r){return Uf(r)&&typeof r.style<"u"&&!c1(r)},c1=function(r){return typeof r.className=="object"},Bat=function(r){return r.tagName==="LI"},Cat=function(r){return r.tagName==="OL"},Eat=function(r){return r.tagName==="INPUT"},Sat=function(r){return r.tagName==="HTML"},ZM=function(r){return r.tagName==="svg"},px=function(r){return r.tagName==="BODY"},tP=function(r){return r.tagName==="CANVAS"},eP=function(r){return r.tagName==="VIDEO"},gx=function(r){return r.tagName==="IMG"},rP=function(r){return r.tagName==="IFRAME"},nP=function(r){return r.tagName==="STYLE"},Tat=function(r){return r.tagName==="SCRIPT"},l1=function(r){return r.tagName==="TEXTAREA"},u1=function(r){return r.tagName==="SELECT"},iP=function(r){return r.tagName==="SLOT"},sP=function(r){return r.tagName.indexOf("-")>0},Iat=function(){function r(){this.counters={}}return r.prototype.getCounterValue=function(t){var e=this.counters[t];return e&&e.length?e[e.length-1]:1},r.prototype.getCounterValues=function(t){var e=this.counters[t];return e||[]},r.prototype.pop=function(t){var e=this;t.forEach(function(n){return e.counters[n].pop()})},r.prototype.parse=function(t){var e=this,n=t.counterIncrement,i=t.counterReset,s=!0;n!==null&&n.forEach(function(o){var A=e.counters[o.counter];A&&o.increment!==0&&(s=!1,A.length||A.push(1),A[Math.max(0,A.length-1)]+=o.increment)});var a=[];return s&&i.forEach(function(o){var A=e.counters[o.counter];a.push(o.counter),A||(A=e.counters[o.counter]=[]),A.push(o.reset)}),a},r}(),oP={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},aP={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Lat={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Fat={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Rf=function(r,t,e,n,i,s){return r<t||r>e?Wg(r,i,s.length>0):n.integers.reduce(function(a,o,A){for(;r>=o;)r-=o,a+=n.values[A];return a},"")+s},cP=function(r,t,e,n){var i="";do e||r--,i=n(r)+i,r/=t;while(r*t>=t);return i},es=function(r,t,e,n,i){var s=e-t+1;return(r<0?"-":"")+(cP(Math.abs(r),s,n,function(a){return ts(Math.floor(a%s)+t)})+i)},$h=function(r,t,e){e===void 0&&(e=". ");var n=t.length;return cP(Math.abs(r),n,!1,function(i){return t[Math.floor(i%n)]})+e},Of=1,qA=2,KA=4,Kg=8,Nu=function(r,t,e,n,i,s){if(r<-9999||r>9999)return Wg(r,4,i.length>0);var a=Math.abs(r),o=i;if(a===0)return t[0]+o;for(var A=0;a>0&&A<=4;A++){var f=a%10;f===0&&xs(s,Of)&&o!==""?o=t[f]+o:f>1||f===1&&A===0||f===1&&A===1&&xs(s,qA)||f===1&&A===1&&xs(s,KA)&&r>100||f===1&&A>1&&xs(s,Kg)?o=t[f]+(A>0?e[A-1]:"")+o:f===1&&A>0&&(o=e[A-1]+o),a=Math.floor(a/10)}return(r<0?n:"")+o},lP="",uP="",AP="",mx="",Wg=function(r,t,e){var n=e?". ":"",i=e?"":"",s=e?", ":"",a=e?" ":"";switch(t){case 0:return""+a;case 1:return""+a;case 2:return""+a;case 5:var o=es(r,48,57,!0,n);return o.length<4?"0"+o:o;case 4:return $h(r,"",i);case 6:return Rf(r,1,3999,oP,3,n).toLowerCase();case 7:return Rf(r,1,3999,oP,3,n);case 8:return es(r,945,969,!1,n);case 9:return es(r,97,122,!1,n);case 10:return es(r,65,90,!1,n);case 11:return es(r,1632,1641,!0,n);case 12:case 49:return Rf(r,1,9999,aP,3,n);case 35:return Rf(r,1,9999,aP,3,n).toLowerCase();case 13:return es(r,2534,2543,!0,n);case 14:case 30:return es(r,6112,6121,!0,n);case 15:return $h(r,"",i);case 16:return $h(r,"",i);case 17:case 48:return Nu(r,"",lP,"",i,qA|KA|Kg);case 47:return Nu(r,"",uP,"",i,Of|qA|KA|Kg);case 42:return Nu(r,"",lP,"",i,qA|KA|Kg);case 41:return Nu(r,"",uP,"",i,Of|qA|KA|Kg);case 26:return Nu(r,"","",AP,i,0);case 25:return Nu(r,"","",AP,i,Of|qA|KA);case 31:return Nu(r,"","",mx,s,Of|qA|KA);case 33:return Nu(r,"","",mx,s,0);case 32:return Nu(r,"","",mx,s,Of|qA|KA);case 18:return es(r,2406,2415,!0,n);case 20:return Rf(r,1,19999,Fat,3,n);case 21:return es(r,2790,2799,!0,n);case 22:return es(r,2662,2671,!0,n);case 22:return Rf(r,1,10999,Lat,3,n);case 23:return $h(r,"");case 24:return $h(r,"");case 27:return es(r,3302,3311,!0,n);case 28:return $h(r,"",i);case 29:return $h(r,"",i);case 34:return es(r,3792,3801,!0,n);case 37:return es(r,6160,6169,!0,n);case 38:return es(r,4160,4169,!0,n);case 39:return es(r,2918,2927,!0,n);case 40:return es(r,1776,1785,!0,n);case 43:return es(r,3046,3055,!0,n);case 44:return es(r,3174,3183,!0,n);case 45:return es(r,3664,3673,!0,n);case 46:return es(r,3872,3881,!0,n);case 3:default:return es(r,48,57,!0,n)}},hP="data-html2canvas-ignore",dP=function(){function r(t,e,n){if(this.context=t,this.options=n,this.scrolledElements=[],this.referenceElement=e,this.counters=new Iat,this.quoteDepth=0,!e.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(e.ownerDocument.documentElement,!1)}return r.prototype.toIFrame=function(t,e){var n=this,i=Mat(t,e);if(!i.contentWindow)return Promise.reject("Unable to find iframe window");var s=t.defaultView.pageXOffset,a=t.defaultView.pageYOffset,o=i.contentWindow,A=o.document,f=Rat(i).then(function(){return Ro(n,void 0,void 0,function(){var m,b;return go(this,function(x){switch(x.label){case 0:return this.scrolledElements.forEach(Nat),o&&(o.scrollTo(e.left,e.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(o.scrollY!==e.top||o.scrollX!==e.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(o.scrollX-e.left,o.scrollY-e.top,0,0))),m=this.options.onclone,b=this.clonedReferenceElement,typeof b>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:A.fonts&&A.fonts.ready?[4,A.fonts.ready]:[3,2];case 1:x.sent(),x.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,Uat(A)]:[3,4];case 3:x.sent(),x.label=4;case 4:return typeof m=="function"?[2,Promise.resolve().then(function(){return m(A,b)}).then(function(){return i})]:[2,i]}})})});return A.open(),A.write(Dat(document.doctype)+"<html></html>"),kat(this.referenceElement.ownerDocument,s,a),A.replaceChild(A.adoptNode(this.documentElement),A.documentElement),A.close(),f},r.prototype.createElementClone=function(t){if(ex(t,2))debugger;if(tP(t))return this.createCanvasClone(t);if(eP(t))return this.createVideoClone(t);if(nP(t))return this.createStyleClone(t);var e=t.cloneNode(!1);return gx(e)&&(gx(t)&&t.currentSrc&&t.currentSrc!==t.src&&(e.src=t.currentSrc,e.srcset=""),e.loading==="lazy"&&(e.loading="eager")),sP(e)?this.createCustomElementClone(e):e},r.prototype.createCustomElementClone=function(t){var e=document.createElement("html2canvascustomelement");return yx(t.style,e),e},r.prototype.createStyleClone=function(t){try{var e=t.sheet;if(e&&e.cssRules){var n=[].slice.call(e.cssRules,0).reduce(function(s,a){return a&&typeof a.cssText=="string"?s+a.cssText:s},""),i=t.cloneNode(!1);return i.textContent=n,i}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return t.cloneNode(!1)},r.prototype.createCanvasClone=function(t){var e;if(this.options.inlineImages&&t.ownerDocument){var n=t.ownerDocument.createElement("img");try{return n.src=t.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var i=t.cloneNode(!1);try{i.width=t.width,i.height=t.height;var s=t.getContext("2d"),a=i.getContext("2d");if(a)if(!this.options.allowTaint&&s)a.putImageData(s.getImageData(0,0,t.width,t.height),0,0);else{var o=(e=t.getContext("webgl2"))!==null&&e!==void 0?e:t.getContext("webgl");if(o){var A=o.getContextAttributes();(A==null?void 0:A.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}a.drawImage(t,0,0)}return i}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return i},r.prototype.createVideoClone=function(t){var e=t.ownerDocument.createElement("canvas");e.width=t.offsetWidth,e.height=t.offsetHeight;var n=e.getContext("2d");try{return n&&(n.drawImage(t,0,0,e.width,e.height),this.options.allowTaint||n.getImageData(0,0,e.width,e.height)),e}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var i=t.ownerDocument.createElement("canvas");return i.width=t.offsetWidth,i.height=t.offsetHeight,i},r.prototype.appendChildNode=function(t,e,n){(!Uf(e)||!Tat(e)&&!e.hasAttribute(hP)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(e)))&&(!this.options.copyStyles||!Uf(e)||!nP(e))&&t.appendChild(this.cloneNode(e,n))},r.prototype.cloneChildNodes=function(t,e,n){for(var i=this,s=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;s;s=s.nextSibling)if(Uf(s)&&iP(s)&&typeof s.assignedNodes=="function"){var a=s.assignedNodes();a.length&&a.forEach(function(o){return i.appendChildNode(e,o,n)})}else this.appendChildNode(e,s,n)},r.prototype.cloneNode=function(t,e){if(JM(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var n=t.ownerDocument.defaultView;if(n&&Uf(t)&&(fx(t)||c1(t))){var i=this.createElementClone(t);i.style.transitionProperty="none";var s=n.getComputedStyle(t),a=n.getComputedStyle(t,":before"),o=n.getComputedStyle(t,":after");this.referenceElement===t&&fx(i)&&(this.clonedReferenceElement=i),px(i)&&zat(i);var A=this.counters.parse(new EM(this.context,s)),f=this.resolvePseudoContent(t,i,a,$g.BEFORE);sP(t)&&(e=!0),eP(t)||this.cloneChildNodes(t,i,e),f&&i.insertBefore(f,i.firstChild);var m=this.resolvePseudoContent(t,i,o,$g.AFTER);return m&&i.appendChild(m),this.counters.pop(A),(s&&(this.options.copyStyles||c1(t))&&!rP(t)||e)&&yx(s,i),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([i,t.scrollLeft,t.scrollTop]),(l1(t)||u1(t))&&(l1(i)||u1(i))&&(i.value=t.value),i}return t.cloneNode(!1)},r.prototype.resolvePseudoContent=function(t,e,n,i){var s=this;if(n){var a=n.content,o=e.ownerDocument;if(!(!o||!a||a==="none"||a==="-moz-alt-content"||n.display==="none")){this.counters.parse(new EM(this.context,n));var A=new Bot(this.context,n),f=o.createElement("html2canvaspseudoelement");yx(n,f),A.content.forEach(function(b){if(b.type===0)f.appendChild(o.createTextNode(b.value));else if(b.type===22){var x=o.createElement("img");x.src=b.value,x.style.opacity="1",f.appendChild(x)}else if(b.type===18){if(b.name==="attr"){var C=b.values.filter(ni);C.length&&f.appendChild(o.createTextNode(t.getAttribute(C[0].value)||""))}else if(b.name==="counter"){var M=b.values.filter(Mf),U=M[0],N=M[1];if(U&&ni(U)){var Q=s.counters.getCounterValue(U.value),q=N&&ni(N)?tx.parse(s.context,N.value):3;f.appendChild(o.createTextNode(Wg(Q,q,!1)))}}else if(b.name==="counters"){var Y=b.values.filter(Mf),U=Y[0],tt=Y[1],N=Y[2];if(U&&ni(U)){var ft=s.counters.getCounterValues(U.value),pt=N&&ni(N)?tx.parse(s.context,N.value):3,mt=tt&&tt.type===0?tt.value:"",dt=ft.map(function(st){return Wg(st,pt,!1)}).join(mt);f.appendChild(o.createTextNode(dt))}}}else if(b.type===20)switch(b.value){case"open-quote":f.appendChild(o.createTextNode(CM(A.quotes,s.quoteDepth++,!0)));break;case"close-quote":f.appendChild(o.createTextNode(CM(A.quotes,--s.quoteDepth,!1)));break;default:f.appendChild(o.createTextNode(b.value))}}),f.className=_x+" "+vx;var m=i===$g.BEFORE?" "+_x:" "+vx;return c1(e)?e.className.baseValue+=m:e.className+=m,f}}},r.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},r}(),$g;(function(r){r[r.BEFORE=0]="BEFORE",r[r.AFTER=1]="AFTER"})($g||($g={}));var Mat=function(r,t){var e=r.createElement("iframe");return e.className="html2canvas-container",e.style.visibility="hidden",e.style.position="fixed",e.style.left="-10000px",e.style.top="0px",e.style.border="0",e.width=t.width.toString(),e.height=t.height.toString(),e.scrolling="no",e.setAttribute(hP,"true"),r.body.appendChild(e),e},Pat=function(r){return new Promise(function(t){if(r.complete){t();return}if(!r.src){t();return}r.onload=t,r.onerror=t})},Uat=function(r){return Promise.all([].slice.call(r.images,0).map(Pat))},Rat=function(r){return new Promise(function(t,e){var n=r.contentWindow;if(!n)return e("No window assigned for iframe");var i=n.document;n.onload=r.onload=function(){n.onload=r.onload=null;var s=setInterval(function(){i.body.childNodes.length>0&&i.readyState==="complete"&&(clearInterval(s),t(r))},50)}})},Oat=["all","d","content"],yx=function(r,t){for(var e=r.length-1;e>=0;e--){var n=r.item(e);Oat.indexOf(n)===-1&&t.style.setProperty(n,r.getPropertyValue(n))}return t},Dat=function(r){var t="";return r&&(t+="<!DOCTYPE ",r.name&&(t+=r.name),r.internalSubset&&(t+=r.internalSubset),r.publicId&&(t+='"'+r.publicId+'"'),r.systemId&&(t+='"'+r.systemId+'"'),t+=">"),t},kat=function(r,t,e){r&&r.defaultView&&(t!==r.defaultView.pageXOffset||e!==r.defaultView.pageYOffset)&&r.defaultView.scrollTo(t,e)},Nat=function(r){var t=r[0],e=r[1],n=r[2];t.scrollLeft=e,t.scrollTop=n},Qat=":before",Hat=":after",_x="___html2canvas___pseudoelement_before",vx="___html2canvas___pseudoelement_after",fP=`{
    content: "" !important;
    display: none !important;
}`,zat=function(r){Gat(r,"."+_x+Qat+fP+`
         .`+vx+Hat+fP)},Gat=function(r,t){var e=r.ownerDocument;if(e){var n=e.createElement("style");n.textContent=t,r.appendChild(n)}},pP=function(){function r(){}return r.getOrigin=function(t){var e=r._link;return e?(e.href=t,e.href=e.href,e.protocol+e.hostname+e.port):"about:blank"},r.isSameOrigin=function(t){return r.getOrigin(t)===r._origin},r.setContext=function(t){r._link=t.document.createElement("a"),r._origin=r.getOrigin(t.location.href)},r._origin="about:blank",r}(),Vat=function(){function r(t,e){this.context=t,this._options=e,this._cache={}}return r.prototype.addImage=function(t){var e=Promise.resolve();return this.has(t)||(wx(t)||Wat(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),e},r.prototype.match=function(t){return this._cache[t]},r.prototype.loadImage=function(t){return Ro(this,void 0,void 0,function(){var e,n,i,s,a=this;return go(this,function(o){switch(o.label){case 0:return e=pP.isSameOrigin(t),n=!bx(t)&&this._options.useCORS===!0&&Ws.SUPPORT_CORS_IMAGES&&!e,i=!bx(t)&&!e&&!wx(t)&&typeof this._options.proxy=="string"&&Ws.SUPPORT_CORS_XHR&&!n,!e&&this._options.allowTaint===!1&&!bx(t)&&!wx(t)&&!i&&!n?[2]:(s=t,i?[4,this.proxy(s)]:[3,2]);case 1:s=o.sent(),o.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(A,f){var m=new Image;m.onload=function(){return A(m)},m.onerror=f,($at(s)||n)&&(m.crossOrigin="anonymous"),m.src=s,m.complete===!0&&setTimeout(function(){return A(m)},500),a._options.imageTimeout>0&&setTimeout(function(){return f("Timed out ("+a._options.imageTimeout+"ms) loading image")},a._options.imageTimeout)})];case 3:return[2,o.sent()]}})})},r.prototype.has=function(t){return typeof this._cache[t]<"u"},r.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},r.prototype.proxy=function(t){var e=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var i=t.substring(0,256);return new Promise(function(s,a){var o=Ws.SUPPORT_RESPONSE_TYPE?"blob":"text",A=new XMLHttpRequest;A.onload=function(){if(A.status===200)if(o==="text")s(A.response);else{var b=new FileReader;b.addEventListener("load",function(){return s(b.result)},!1),b.addEventListener("error",function(x){return a(x)},!1),b.readAsDataURL(A.response)}else a("Failed to proxy resource "+i+" with status code "+A.status)},A.onerror=a;var f=n.indexOf("?")>-1?"&":"?";if(A.open("GET",""+n+f+"url="+encodeURIComponent(t)+"&responseType="+o),o!=="text"&&A instanceof XMLHttpRequest&&(A.responseType=o),e._options.imageTimeout){var m=e._options.imageTimeout;A.timeout=m,A.ontimeout=function(){return a("Timed out ("+m+"ms) proxying "+i)}}A.send()})},r}(),jat=/^data:image\/svg\+xml/i,qat=/^data:image\/.*;base64,/i,Kat=/^data:image\/.*/i,Wat=function(r){return Ws.SUPPORT_SVG_DRAWING||!Xat(r)},bx=function(r){return Kat.test(r)},$at=function(r){return qat.test(r)},wx=function(r){return r.substr(0,4)==="blob"},Xat=function(r){return r.substr(-3).toLowerCase()==="svg"||jat.test(r)},lr=function(){function r(t,e){this.type=0,this.x=t,this.y=e}return r.prototype.add=function(t,e){return new r(this.x+t,this.y+e)},r}(),Df=function(r,t,e){return new lr(r.x+(t.x-r.x)*e,r.y+(t.y-r.y)*e)},A1=function(){function r(t,e,n,i){this.type=1,this.start=t,this.startControl=e,this.endControl=n,this.end=i}return r.prototype.subdivide=function(t,e){var n=Df(this.start,this.startControl,t),i=Df(this.startControl,this.endControl,t),s=Df(this.endControl,this.end,t),a=Df(n,i,t),o=Df(i,s,t),A=Df(a,o,t);return e?new r(this.start,n,a,A):new r(A,o,s,this.end)},r.prototype.add=function(t,e){return new r(this.start.add(t,e),this.startControl.add(t,e),this.endControl.add(t,e),this.end.add(t,e))},r.prototype.reverse=function(){return new r(this.end,this.endControl,this.startControl,this.start)},r}(),cc=function(r){return r.type===1},Yat=function(){function r(t){var e=t.styles,n=t.bounds,i=zg(e.borderTopLeftRadius,n.width,n.height),s=i[0],a=i[1],o=zg(e.borderTopRightRadius,n.width,n.height),A=o[0],f=o[1],m=zg(e.borderBottomRightRadius,n.width,n.height),b=m[0],x=m[1],C=zg(e.borderBottomLeftRadius,n.width,n.height),M=C[0],U=C[1],N=[];N.push((s+A)/n.width),N.push((M+b)/n.width),N.push((a+U)/n.height),N.push((f+x)/n.height);var Q=Math.max.apply(Math,N);Q>1&&(s/=Q,a/=Q,A/=Q,f/=Q,b/=Q,x/=Q,M/=Q,U/=Q);var q=n.width-A,Y=n.height-x,tt=n.width-b,ft=n.height-U,pt=e.borderTopWidth,mt=e.borderRightWidth,dt=e.borderBottomWidth,Rt=e.borderLeftWidth,Lt=gi(e.paddingTop,t.bounds.width),st=gi(e.paddingRight,t.bounds.width),ct=gi(e.paddingBottom,t.bounds.width),wt=gi(e.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||a>0?Si(n.left+Rt/3,n.top+pt/3,s-Rt/3,a-pt/3,jn.TOP_LEFT):new lr(n.left+Rt/3,n.top+pt/3),this.topRightBorderDoubleOuterBox=s>0||a>0?Si(n.left+q,n.top+pt/3,A-mt/3,f-pt/3,jn.TOP_RIGHT):new lr(n.left+n.width-mt/3,n.top+pt/3),this.bottomRightBorderDoubleOuterBox=b>0||x>0?Si(n.left+tt,n.top+Y,b-mt/3,x-dt/3,jn.BOTTOM_RIGHT):new lr(n.left+n.width-mt/3,n.top+n.height-dt/3),this.bottomLeftBorderDoubleOuterBox=M>0||U>0?Si(n.left+Rt/3,n.top+ft,M-Rt/3,U-dt/3,jn.BOTTOM_LEFT):new lr(n.left+Rt/3,n.top+n.height-dt/3),this.topLeftBorderDoubleInnerBox=s>0||a>0?Si(n.left+Rt*2/3,n.top+pt*2/3,s-Rt*2/3,a-pt*2/3,jn.TOP_LEFT):new lr(n.left+Rt*2/3,n.top+pt*2/3),this.topRightBorderDoubleInnerBox=s>0||a>0?Si(n.left+q,n.top+pt*2/3,A-mt*2/3,f-pt*2/3,jn.TOP_RIGHT):new lr(n.left+n.width-mt*2/3,n.top+pt*2/3),this.bottomRightBorderDoubleInnerBox=b>0||x>0?Si(n.left+tt,n.top+Y,b-mt*2/3,x-dt*2/3,jn.BOTTOM_RIGHT):new lr(n.left+n.width-mt*2/3,n.top+n.height-dt*2/3),this.bottomLeftBorderDoubleInnerBox=M>0||U>0?Si(n.left+Rt*2/3,n.top+ft,M-Rt*2/3,U-dt*2/3,jn.BOTTOM_LEFT):new lr(n.left+Rt*2/3,n.top+n.height-dt*2/3),this.topLeftBorderStroke=s>0||a>0?Si(n.left+Rt/2,n.top+pt/2,s-Rt/2,a-pt/2,jn.TOP_LEFT):new lr(n.left+Rt/2,n.top+pt/2),this.topRightBorderStroke=s>0||a>0?Si(n.left+q,n.top+pt/2,A-mt/2,f-pt/2,jn.TOP_RIGHT):new lr(n.left+n.width-mt/2,n.top+pt/2),this.bottomRightBorderStroke=b>0||x>0?Si(n.left+tt,n.top+Y,b-mt/2,x-dt/2,jn.BOTTOM_RIGHT):new lr(n.left+n.width-mt/2,n.top+n.height-dt/2),this.bottomLeftBorderStroke=M>0||U>0?Si(n.left+Rt/2,n.top+ft,M-Rt/2,U-dt/2,jn.BOTTOM_LEFT):new lr(n.left+Rt/2,n.top+n.height-dt/2),this.topLeftBorderBox=s>0||a>0?Si(n.left,n.top,s,a,jn.TOP_LEFT):new lr(n.left,n.top),this.topRightBorderBox=A>0||f>0?Si(n.left+q,n.top,A,f,jn.TOP_RIGHT):new lr(n.left+n.width,n.top),this.bottomRightBorderBox=b>0||x>0?Si(n.left+tt,n.top+Y,b,x,jn.BOTTOM_RIGHT):new lr(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=M>0||U>0?Si(n.left,n.top+ft,M,U,jn.BOTTOM_LEFT):new lr(n.left,n.top+n.height),this.topLeftPaddingBox=s>0||a>0?Si(n.left+Rt,n.top+pt,Math.max(0,s-Rt),Math.max(0,a-pt),jn.TOP_LEFT):new lr(n.left+Rt,n.top+pt),this.topRightPaddingBox=A>0||f>0?Si(n.left+Math.min(q,n.width-mt),n.top+pt,q>n.width+mt?0:Math.max(0,A-mt),Math.max(0,f-pt),jn.TOP_RIGHT):new lr(n.left+n.width-mt,n.top+pt),this.bottomRightPaddingBox=b>0||x>0?Si(n.left+Math.min(tt,n.width-Rt),n.top+Math.min(Y,n.height-dt),Math.max(0,b-mt),Math.max(0,x-dt),jn.BOTTOM_RIGHT):new lr(n.left+n.width-mt,n.top+n.height-dt),this.bottomLeftPaddingBox=M>0||U>0?Si(n.left+Rt,n.top+Math.min(ft,n.height-dt),Math.max(0,M-Rt),Math.max(0,U-dt),jn.BOTTOM_LEFT):new lr(n.left+Rt,n.top+n.height-dt),this.topLeftContentBox=s>0||a>0?Si(n.left+Rt+wt,n.top+pt+Lt,Math.max(0,s-(Rt+wt)),Math.max(0,a-(pt+Lt)),jn.TOP_LEFT):new lr(n.left+Rt+wt,n.top+pt+Lt),this.topRightContentBox=A>0||f>0?Si(n.left+Math.min(q,n.width+Rt+wt),n.top+pt+Lt,q>n.width+Rt+wt?0:A-Rt+wt,f-(pt+Lt),jn.TOP_RIGHT):new lr(n.left+n.width-(mt+st),n.top+pt+Lt),this.bottomRightContentBox=b>0||x>0?Si(n.left+Math.min(tt,n.width-(Rt+wt)),n.top+Math.min(Y,n.height+pt+Lt),Math.max(0,b-(mt+st)),x-(dt+ct),jn.BOTTOM_RIGHT):new lr(n.left+n.width-(mt+st),n.top+n.height-(dt+ct)),this.bottomLeftContentBox=M>0||U>0?Si(n.left+Rt+wt,n.top+ft,Math.max(0,M-(Rt+wt)),U-(dt+ct),jn.BOTTOM_LEFT):new lr(n.left+Rt+wt,n.top+n.height-(dt+ct))}return r}(),jn;(function(r){r[r.TOP_LEFT=0]="TOP_LEFT",r[r.TOP_RIGHT=1]="TOP_RIGHT",r[r.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",r[r.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(jn||(jn={}));var Si=function(r,t,e,n,i){var s=4*((Math.sqrt(2)-1)/3),a=e*s,o=n*s,A=r+e,f=t+n;switch(i){case jn.TOP_LEFT:return new A1(new lr(r,f),new lr(r,f-o),new lr(A-a,t),new lr(A,t));case jn.TOP_RIGHT:return new A1(new lr(r,t),new lr(r+a,t),new lr(A,f-o),new lr(A,f));case jn.BOTTOM_RIGHT:return new A1(new lr(A,t),new lr(A,t+o),new lr(r+a,f),new lr(r,f));case jn.BOTTOM_LEFT:default:return new A1(new lr(A,f),new lr(A-a,f),new lr(r,t+o),new lr(r,t))}},h1=function(r){return[r.topLeftBorderBox,r.topRightBorderBox,r.bottomRightBorderBox,r.bottomLeftBorderBox]},Jat=function(r){return[r.topLeftContentBox,r.topRightContentBox,r.bottomRightContentBox,r.bottomLeftContentBox]},d1=function(r){return[r.topLeftPaddingBox,r.topRightPaddingBox,r.bottomRightPaddingBox,r.bottomLeftPaddingBox]},Zat=function(){function r(t,e,n){this.offsetX=t,this.offsetY=e,this.matrix=n,this.type=0,this.target=6}return r}(),f1=function(){function r(t,e){this.path=t,this.target=e,this.type=1}return r}(),tct=function(){function r(t){this.opacity=t,this.type=2,this.target=6}return r}(),ect=function(r){return r.type===0},gP=function(r){return r.type===1},rct=function(r){return r.type===2},mP=function(r,t){return r.length===t.length?r.some(function(e,n){return e===t[n]}):!1},nct=function(r,t,e,n,i){return r.map(function(s,a){switch(a){case 0:return s.add(t,e);case 1:return s.add(t+n,e);case 2:return s.add(t+n,e+i);case 3:return s.add(t,e+i)}return s})},yP=function(){function r(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return r}(),_P=function(){function r(t,e){if(this.container=t,this.parent=e,this.effects=[],this.curves=new Yat(this.container),this.container.styles.opacity<1&&this.effects.push(new tct(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,i=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new Zat(n,i,s))}if(this.container.styles.overflowX!==0){var a=h1(this.curves),o=d1(this.curves);mP(a,o)?this.effects.push(new f1(a,6)):(this.effects.push(new f1(a,2)),this.effects.push(new f1(o,4)))}}return r.prototype.getEffects=function(t){for(var e=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,i=this.effects.slice(0);n;){var s=n.effects.filter(function(A){return!gP(A)});if(e||n.container.styles.position!==0||!n.parent){if(i.unshift.apply(i,s),e=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var a=h1(n.curves),o=d1(n.curves);mP(a,o)||i.unshift(new f1(o,6))}}else i.unshift.apply(i,s);n=n.parent}return i.filter(function(A){return xs(A.target,t)})},r}(),xx=function(r,t,e,n){r.container.elements.forEach(function(i){var s=xs(i.flags,4),a=xs(i.flags,2),o=new _P(i,r);xs(i.styles.display,2048)&&n.push(o);var A=xs(i.flags,8)?[]:n;if(s||a){var f=s||i.styles.isPositioned()?e:t,m=new yP(o);if(i.styles.isPositioned()||i.styles.opacity<1||i.styles.isTransformed()){var b=i.styles.zIndex.order;if(b<0){var x=0;f.negativeZIndex.some(function(M,U){return b>M.element.container.styles.zIndex.order?(x=U,!1):x>0}),f.negativeZIndex.splice(x,0,m)}else if(b>0){var C=0;f.positiveZIndex.some(function(M,U){return b>=M.element.container.styles.zIndex.order?(C=U+1,!1):C>0}),f.positiveZIndex.splice(C,0,m)}else f.zeroOrAutoZIndexOrTransformedOrOpacity.push(m)}else i.styles.isFloating()?f.nonPositionedFloats.push(m):f.nonPositionedInlineLevel.push(m);xx(o,m,s?m:e,A)}else i.styles.isInlineLevel()?t.inlineLevel.push(o):t.nonInlineLevel.push(o),xx(o,t,e,A);xs(i.flags,8)&&vP(i,A)})},vP=function(r,t){for(var e=r instanceof hx?r.start:1,n=r instanceof hx?r.reversed:!1,i=0;i<t.length;i++){var s=t[i];s.container instanceof jM&&typeof s.container.value=="number"&&s.container.value!==0&&(e=s.container.value),s.listValue=Wg(e,s.container.styles.listStyleType,!0),e+=n?-1:1}},ict=function(r){var t=new _P(r,null),e=new yP(t),n=[];return xx(t,e,e,n),vP(t.container,n),e},bP=function(r,t){switch(t){case 0:return lc(r.topLeftBorderBox,r.topLeftPaddingBox,r.topRightBorderBox,r.topRightPaddingBox);case 1:return lc(r.topRightBorderBox,r.topRightPaddingBox,r.bottomRightBorderBox,r.bottomRightPaddingBox);case 2:return lc(r.bottomRightBorderBox,r.bottomRightPaddingBox,r.bottomLeftBorderBox,r.bottomLeftPaddingBox);case 3:default:return lc(r.bottomLeftBorderBox,r.bottomLeftPaddingBox,r.topLeftBorderBox,r.topLeftPaddingBox)}},sct=function(r,t){switch(t){case 0:return lc(r.topLeftBorderBox,r.topLeftBorderDoubleOuterBox,r.topRightBorderBox,r.topRightBorderDoubleOuterBox);case 1:return lc(r.topRightBorderBox,r.topRightBorderDoubleOuterBox,r.bottomRightBorderBox,r.bottomRightBorderDoubleOuterBox);case 2:return lc(r.bottomRightBorderBox,r.bottomRightBorderDoubleOuterBox,r.bottomLeftBorderBox,r.bottomLeftBorderDoubleOuterBox);case 3:default:return lc(r.bottomLeftBorderBox,r.bottomLeftBorderDoubleOuterBox,r.topLeftBorderBox,r.topLeftBorderDoubleOuterBox)}},oct=function(r,t){switch(t){case 0:return lc(r.topLeftBorderDoubleInnerBox,r.topLeftPaddingBox,r.topRightBorderDoubleInnerBox,r.topRightPaddingBox);case 1:return lc(r.topRightBorderDoubleInnerBox,r.topRightPaddingBox,r.bottomRightBorderDoubleInnerBox,r.bottomRightPaddingBox);case 2:return lc(r.bottomRightBorderDoubleInnerBox,r.bottomRightPaddingBox,r.bottomLeftBorderDoubleInnerBox,r.bottomLeftPaddingBox);case 3:default:return lc(r.bottomLeftBorderDoubleInnerBox,r.bottomLeftPaddingBox,r.topLeftBorderDoubleInnerBox,r.topLeftPaddingBox)}},act=function(r,t){switch(t){case 0:return p1(r.topLeftBorderStroke,r.topRightBorderStroke);case 1:return p1(r.topRightBorderStroke,r.bottomRightBorderStroke);case 2:return p1(r.bottomRightBorderStroke,r.bottomLeftBorderStroke);case 3:default:return p1(r.bottomLeftBorderStroke,r.topLeftBorderStroke)}},p1=function(r,t){var e=[];return cc(r)?e.push(r.subdivide(.5,!1)):e.push(r),cc(t)?e.push(t.subdivide(.5,!0)):e.push(t),e},lc=function(r,t,e,n){var i=[];return cc(r)?i.push(r.subdivide(.5,!1)):i.push(r),cc(e)?i.push(e.subdivide(.5,!0)):i.push(e),cc(n)?i.push(n.subdivide(.5,!0).reverse()):i.push(n),cc(t)?i.push(t.subdivide(.5,!1).reverse()):i.push(t),i},wP=function(r){var t=r.bounds,e=r.styles;return t.add(e.borderLeftWidth,e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth),-(e.borderTopWidth+e.borderBottomWidth))},g1=function(r){var t=r.styles,e=r.bounds,n=gi(t.paddingLeft,e.width),i=gi(t.paddingRight,e.width),s=gi(t.paddingTop,e.width),a=gi(t.paddingBottom,e.width);return e.add(n+t.borderLeftWidth,s+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+n+i),-(t.borderTopWidth+t.borderBottomWidth+s+a))},cct=function(r,t){return r===0?t.bounds:r===2?g1(t):wP(t)},lct=function(r,t){return r===0?t.bounds:r===2?g1(t):wP(t)},Bx=function(r,t,e){var n=cct(Nf(r.styles.backgroundOrigin,t),r),i=lct(Nf(r.styles.backgroundClip,t),r),s=uct(Nf(r.styles.backgroundSize,t),e,n),a=s[0],o=s[1],A=zg(Nf(r.styles.backgroundPosition,t),n.width-a,n.height-o),f=Act(Nf(r.styles.backgroundRepeat,t),A,s,n,i),m=Math.round(n.left+A[0]),b=Math.round(n.top+A[1]);return[f,m,b,a,o]},kf=function(r){return ni(r)&&r.value===Pf.AUTO},m1=function(r){return typeof r=="number"},uct=function(r,t,e){var n=t[0],i=t[1],s=t[2],a=r[0],o=r[1];if(!a)return[0,0];if(gs(a)&&o&&gs(o))return[gi(a,e.width),gi(o,e.height)];var A=m1(s);if(ni(a)&&(a.value===Pf.CONTAIN||a.value===Pf.COVER)){if(m1(s)){var f=e.width/e.height;return f<s!=(a.value===Pf.COVER)?[e.width,e.width/s]:[e.height*s,e.height]}return[e.width,e.height]}var m=m1(n),b=m1(i),x=m||b;if(kf(a)&&(!o||kf(o))){if(m&&b)return[n,i];if(!A&&!x)return[e.width,e.height];if(x&&A){var C=m?n:i*s,M=b?i:n/s;return[C,M]}var U=m?n:e.width,N=b?i:e.height;return[U,N]}if(A){var Q=0,q=0;return gs(a)?Q=gi(a,e.width):gs(o)&&(q=gi(o,e.height)),kf(a)?Q=q*s:(!o||kf(o))&&(q=Q/s),[Q,q]}var Y=null,tt=null;if(gs(a)?Y=gi(a,e.width):o&&gs(o)&&(tt=gi(o,e.height)),Y!==null&&(!o||kf(o))&&(tt=m&&b?Y/n*i:e.height),tt!==null&&kf(a)&&(Y=m&&b?tt/i*n:e.width),Y!==null&&tt!==null)return[Y,tt];throw new Error("Unable to calculate background-size for element")},Nf=function(r,t){var e=r[t];return typeof e>"u"?r[0]:e},Act=function(r,t,e,n,i){var s=t[0],a=t[1],o=e[0],A=e[1];switch(r){case 2:return[new lr(Math.round(n.left),Math.round(n.top+a)),new lr(Math.round(n.left+n.width),Math.round(n.top+a)),new lr(Math.round(n.left+n.width),Math.round(A+n.top+a)),new lr(Math.round(n.left),Math.round(A+n.top+a))];case 3:return[new lr(Math.round(n.left+s),Math.round(n.top)),new lr(Math.round(n.left+s+o),Math.round(n.top)),new lr(Math.round(n.left+s+o),Math.round(n.height+n.top)),new lr(Math.round(n.left+s),Math.round(n.height+n.top))];case 1:return[new lr(Math.round(n.left+s),Math.round(n.top+a)),new lr(Math.round(n.left+s+o),Math.round(n.top+a)),new lr(Math.round(n.left+s+o),Math.round(n.top+a+A)),new lr(Math.round(n.left+s),Math.round(n.top+a+A))];default:return[new lr(Math.round(i.left),Math.round(i.top)),new lr(Math.round(i.left+i.width),Math.round(i.top)),new lr(Math.round(i.left+i.width),Math.round(i.height+i.top)),new lr(Math.round(i.left),Math.round(i.height+i.top))]}},hct="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",xP="Hidden Text",dct=function(){function r(t){this._data={},this._document=t}return r.prototype.parseMetrics=function(t,e){var n=this._document.createElement("div"),i=this._document.createElement("img"),s=this._document.createElement("span"),a=this._document.body;n.style.visibility="hidden",n.style.fontFamily=t,n.style.fontSize=e,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",a.appendChild(n),i.src=hct,i.width=1,i.height=1,i.style.margin="0",i.style.padding="0",i.style.verticalAlign="baseline",s.style.fontFamily=t,s.style.fontSize=e,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(xP)),n.appendChild(s),n.appendChild(i);var o=i.offsetTop-s.offsetTop+2;n.removeChild(s),n.appendChild(this._document.createTextNode(xP)),n.style.lineHeight="normal",i.style.verticalAlign="super";var A=i.offsetTop-n.offsetTop+2;return a.removeChild(n),{baseline:o,middle:A}},r.prototype.getMetrics=function(t,e){var n=t+" "+e;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(t,e)),this._data[n]},r}(),BP=function(){function r(t,e){this.context=t,this.options=e}return r}(),fct=1e4,pct=function(r){$c(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i._activeEffects=[],i.canvas=n.canvas?n.canvas:document.createElement("canvas"),i.ctx=i.canvas.getContext("2d"),n.canvas||(i.canvas.width=Math.floor(n.width*n.scale),i.canvas.height=Math.floor(n.height*n.scale),i.canvas.style.width=n.width+"px",i.canvas.style.height=n.height+"px"),i.fontMetrics=new dct(document),i.ctx.scale(i.options.scale,i.options.scale),i.ctx.translate(-n.x,-n.y),i.ctx.textBaseline="bottom",i._activeEffects=[],i.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),i}return t.prototype.applyEffects=function(e){for(var n=this;this._activeEffects.length;)this.popEffect();e.forEach(function(i){return n.applyEffect(i)})},t.prototype.applyEffect=function(e){this.ctx.save(),rct(e)&&(this.ctx.globalAlpha=e.opacity),ect(e)&&(this.ctx.translate(e.offsetX,e.offsetY),this.ctx.transform(e.matrix[0],e.matrix[1],e.matrix[2],e.matrix[3],e.matrix[4],e.matrix[5]),this.ctx.translate(-e.offsetX,-e.offsetY)),gP(e)&&(this.path(e.path),this.ctx.clip()),this._activeEffects.push(e)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(e){return Ro(this,void 0,void 0,function(){var n;return go(this,function(i){switch(i.label){case 0:return n=e.element.container.styles,n.isVisible()?[4,this.renderStackContent(e)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(e){return Ro(this,void 0,void 0,function(){return go(this,function(n){switch(n.label){case 0:if(xs(e.container.flags,16))debugger;return e.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(e)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(e)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(e,n,i){var s=this;if(n===0)this.ctx.fillText(e.text,e.bounds.left,e.bounds.top+i);else{var a=Ax(e.text);a.reduce(function(o,A){return s.ctx.fillText(A,o,e.bounds.top+i),o+s.ctx.measureText(A).width},e.bounds.left)}},t.prototype.createFontStyle=function(e){var n=e.fontVariant.filter(function(a){return a==="normal"||a==="small-caps"}).join(""),i=vct(e.fontFamily).join(", "),s=Hg(e.fontSize)?""+e.fontSize.number+e.fontSize.unit:e.fontSize.number+"px";return[[e.fontStyle,n,e.fontWeight,s,i].join(" "),i,s]},t.prototype.renderTextNode=function(e,n){return Ro(this,void 0,void 0,function(){var i,s,a,o,A,f,m,b,x=this;return go(this,function(C){return i=this.createFontStyle(n),s=i[0],a=i[1],o=i[2],this.ctx.font=s,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",A=this.fontMetrics.getMetrics(a,o),f=A.baseline,m=A.middle,b=n.paintOrder,e.textBounds.forEach(function(M){b.forEach(function(U){switch(U){case 0:x.ctx.fillStyle=Ps(n.color),x.renderTextWithLetterSpacing(M,n.letterSpacing,f);var N=n.textShadow;N.length&&M.text.trim().length&&(N.slice(0).reverse().forEach(function(Q){x.ctx.shadowColor=Ps(Q.color),x.ctx.shadowOffsetX=Q.offsetX.number*x.options.scale,x.ctx.shadowOffsetY=Q.offsetY.number*x.options.scale,x.ctx.shadowBlur=Q.blur.number,x.renderTextWithLetterSpacing(M,n.letterSpacing,f)}),x.ctx.shadowColor="",x.ctx.shadowOffsetX=0,x.ctx.shadowOffsetY=0,x.ctx.shadowBlur=0),n.textDecorationLine.length&&(x.ctx.fillStyle=Ps(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(Q){switch(Q){case 1:x.ctx.fillRect(M.bounds.left,Math.round(M.bounds.top+f),M.bounds.width,1);break;case 2:x.ctx.fillRect(M.bounds.left,Math.round(M.bounds.top),M.bounds.width,1);break;case 3:x.ctx.fillRect(M.bounds.left,Math.ceil(M.bounds.top+m),M.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&M.text.trim().length&&(x.ctx.strokeStyle=Ps(n.webkitTextStrokeColor),x.ctx.lineWidth=n.webkitTextStrokeWidth,x.ctx.lineJoin=window.chrome?"miter":"round",x.ctx.strokeText(M.text,M.bounds.left,M.bounds.top+f)),x.ctx.strokeStyle="",x.ctx.lineWidth=0,x.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(e,n,i){if(i&&e.intrinsicWidth>0&&e.intrinsicHeight>0){var s=g1(e),a=d1(n);this.path(a),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(i,0,0,e.intrinsicWidth,e.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(e){return Ro(this,void 0,void 0,function(){var n,i,s,a,o,A,q,q,f,m,b,x,tt,C,M,ft,U,N,Q,q,Y,tt,ft;return go(this,function(pt){switch(pt.label){case 0:this.applyEffects(e.getEffects(4)),n=e.container,i=e.curves,s=n.styles,a=0,o=n.textNodes,pt.label=1;case 1:return a<o.length?(A=o[a],[4,this.renderTextNode(A,s)]):[3,4];case 2:pt.sent(),pt.label=3;case 3:return a++,[3,1];case 4:if(!(n instanceof zM))return[3,8];pt.label=5;case 5:return pt.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return q=pt.sent(),this.renderReplacedElement(n,i,q),[3,8];case 7:return pt.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof GM&&this.renderReplacedElement(n,i,n.canvas),!(n instanceof VM))return[3,12];pt.label=9;case 9:return pt.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return q=pt.sent(),this.renderReplacedElement(n,i,q),[3,12];case 11:return pt.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof $M&&n.tree?(f=new t(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,f.render(n.tree)]):[3,14];case 13:m=pt.sent(),n.width&&n.height&&this.ctx.drawImage(m,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),pt.label=14;case 14:if(n instanceof dx&&(b=Math.min(n.bounds.width,n.bounds.height),n.type===s1?n.checked&&(this.ctx.save(),this.path([new lr(n.bounds.left+b*.39363,n.bounds.top+b*.79),new lr(n.bounds.left+b*.16,n.bounds.top+b*.5549),new lr(n.bounds.left+b*.27347,n.bounds.top+b*.44071),new lr(n.bounds.left+b*.39694,n.bounds.top+b*.5649),new lr(n.bounds.left+b*.72983,n.bounds.top+b*.23),new lr(n.bounds.left+b*.84,n.bounds.top+b*.34085),new lr(n.bounds.left+b*.39363,n.bounds.top+b*.79)]),this.ctx.fillStyle=Ps(qM),this.ctx.fill(),this.ctx.restore()):n.type===o1&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+b/2,n.bounds.top+b/2,b/4,0,Math.PI*2,!0),this.ctx.fillStyle=Ps(qM),this.ctx.fill(),this.ctx.restore())),gct(n)&&n.value.length){switch(x=this.createFontStyle(s),tt=x[0],C=x[1],M=this.fontMetrics.getMetrics(tt,C).baseline,this.ctx.font=tt,this.ctx.fillStyle=Ps(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=yct(n.styles.textAlign),ft=g1(n),U=0,n.styles.textAlign){case 1:U+=ft.width/2;break;case 2:U+=ft.width;break}N=ft.add(U,0,0,-ft.height/2+1),this.ctx.save(),this.path([new lr(ft.left,ft.top),new lr(ft.left+ft.width,ft.top),new lr(ft.left+ft.width,ft.top+ft.height),new lr(ft.left,ft.top+ft.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new qg(n.value,N),s.letterSpacing,M),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!xs(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(Q=n.styles.listStyleImage,Q.type!==0)return[3,18];q=void 0,Y=Q.url,pt.label=15;case 15:return pt.trys.push([15,17,,18]),[4,this.context.cache.match(Y)];case 16:return q=pt.sent(),this.ctx.drawImage(q,n.bounds.left-(q.width+10),n.bounds.top),[3,18];case 17:return pt.sent(),this.context.logger.error("Error loading list-style-image "+Y),[3,18];case 18:return[3,20];case 19:e.listValue&&n.styles.listStyleType!==-1&&(tt=this.createFontStyle(s)[0],this.ctx.font=tt,this.ctx.fillStyle=Ps(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",ft=new Ou(n.bounds.left,n.bounds.top+gi(n.styles.paddingTop,n.bounds.width),n.bounds.width,wM(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new qg(e.listValue,ft),s.letterSpacing,wM(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),pt.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(e){return Ro(this,void 0,void 0,function(){var n,i,Q,s,a,Q,o,A,Q,f,m,Q,b,x,Q,C,M,Q,U,N,Q;return go(this,function(q){switch(q.label){case 0:if(xs(e.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(e.element)];case 1:q.sent(),n=0,i=e.negativeZIndex,q.label=2;case 2:return n<i.length?(Q=i[n],[4,this.renderStack(Q)]):[3,5];case 3:q.sent(),q.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(e.element)];case 6:q.sent(),s=0,a=e.nonInlineLevel,q.label=7;case 7:return s<a.length?(Q=a[s],[4,this.renderNode(Q)]):[3,10];case 8:q.sent(),q.label=9;case 9:return s++,[3,7];case 10:o=0,A=e.nonPositionedFloats,q.label=11;case 11:return o<A.length?(Q=A[o],[4,this.renderStack(Q)]):[3,14];case 12:q.sent(),q.label=13;case 13:return o++,[3,11];case 14:f=0,m=e.nonPositionedInlineLevel,q.label=15;case 15:return f<m.length?(Q=m[f],[4,this.renderStack(Q)]):[3,18];case 16:q.sent(),q.label=17;case 17:return f++,[3,15];case 18:b=0,x=e.inlineLevel,q.label=19;case 19:return b<x.length?(Q=x[b],[4,this.renderNode(Q)]):[3,22];case 20:q.sent(),q.label=21;case 21:return b++,[3,19];case 22:C=0,M=e.zeroOrAutoZIndexOrTransformedOrOpacity,q.label=23;case 23:return C<M.length?(Q=M[C],[4,this.renderStack(Q)]):[3,26];case 24:q.sent(),q.label=25;case 25:return C++,[3,23];case 26:U=0,N=e.positiveZIndex,q.label=27;case 27:return U<N.length?(Q=N[U],[4,this.renderStack(Q)]):[3,30];case 28:q.sent(),q.label=29;case 29:return U++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(e){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(e.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(e){this.ctx.beginPath(),this.formatPath(e),this.ctx.closePath()},t.prototype.formatPath=function(e){var n=this;e.forEach(function(i,s){var a=cc(i)?i.start:i;s===0?n.ctx.moveTo(a.x,a.y):n.ctx.lineTo(a.x,a.y),cc(i)&&n.ctx.bezierCurveTo(i.startControl.x,i.startControl.y,i.endControl.x,i.endControl.y,i.end.x,i.end.y)})},t.prototype.renderRepeat=function(e,n,i,s){this.path(e),this.ctx.fillStyle=n,this.ctx.translate(i,s),this.ctx.fill(),this.ctx.translate(-i,-s)},t.prototype.resizeImage=function(e,n,i){var s;if(e.width===n&&e.height===i)return e;var a=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,o=a.createElement("canvas");o.width=Math.max(1,n),o.height=Math.max(1,i);var A=o.getContext("2d");return A.drawImage(e,0,0,e.width,e.height,0,0,n,i),o},t.prototype.renderBackgroundImage=function(e){return Ro(this,void 0,void 0,function(){var n,i,s,a,o,A;return go(this,function(f){switch(f.label){case 0:n=e.styles.backgroundImage.length-1,i=function(m){var b,x,C,Lt,Zt,re,wt,yt,dt,M,Lt,Zt,re,wt,yt,U,N,Q,q,Y,tt,ft,pt,mt,dt,Rt,Lt,st,ct,wt,yt,te,Zt,re,Xt,ne,se,we,it,vt,Ft,Ot;return go(this,function(Wt){switch(Wt.label){case 0:if(m.type!==0)return[3,5];b=void 0,x=m.url,Wt.label=1;case 1:return Wt.trys.push([1,3,,4]),[4,s.context.cache.match(x)];case 2:return b=Wt.sent(),[3,4];case 3:return Wt.sent(),s.context.logger.error("Error loading background-image "+x),[3,4];case 4:return b&&(C=Bx(e,n,[b.width,b.height,b.width/b.height]),Lt=C[0],Zt=C[1],re=C[2],wt=C[3],yt=C[4],dt=s.ctx.createPattern(s.resizeImage(b,wt,yt),"repeat"),s.renderRepeat(Lt,dt,Zt,re)),[3,6];case 5:est(m)?(M=Bx(e,n,[null,null,null]),Lt=M[0],Zt=M[1],re=M[2],wt=M[3],yt=M[4],U=Xit(m.angle,wt,yt),N=U[0],Q=U[1],q=U[2],Y=U[3],tt=U[4],ft=document.createElement("canvas"),ft.width=wt,ft.height=yt,pt=ft.getContext("2d"),mt=pt.createLinearGradient(Q,Y,q,tt),AM(m.stops,N).forEach(function(jt){return mt.addColorStop(jt.stop,Ps(jt.color))}),pt.fillStyle=mt,pt.fillRect(0,0,wt,yt),wt>0&&yt>0&&(dt=s.ctx.createPattern(ft,"repeat"),s.renderRepeat(Lt,dt,Zt,re))):rst(m)&&(Rt=Bx(e,n,[null,null,null]),Lt=Rt[0],st=Rt[1],ct=Rt[2],wt=Rt[3],yt=Rt[4],te=m.position.length===0?[Y2]:m.position,Zt=gi(te[0],wt),re=gi(te[te.length-1],yt),Xt=Yit(m,Zt,re,wt,yt),ne=Xt[0],se=Xt[1],ne>0&&se>0&&(we=s.ctx.createRadialGradient(st+Zt,ct+re,0,st+Zt,ct+re,ne),AM(m.stops,ne*2).forEach(function(jt){return we.addColorStop(jt.stop,Ps(jt.color))}),s.path(Lt),s.ctx.fillStyle=we,ne!==se?(it=e.bounds.left+.5*e.bounds.width,vt=e.bounds.top+.5*e.bounds.height,Ft=se/ne,Ot=1/Ft,s.ctx.save(),s.ctx.translate(it,vt),s.ctx.transform(1,0,0,Ft,0,0),s.ctx.translate(-it,-vt),s.ctx.fillRect(st,Ot*(ct-vt)+vt,wt,yt*Ot),s.ctx.restore()):s.ctx.fill())),Wt.label=6;case 6:return n--,[2]}})},s=this,a=0,o=e.styles.backgroundImage.slice(0).reverse(),f.label=1;case 1:return a<o.length?(A=o[a],[5,i(A)]):[3,4];case 2:f.sent(),f.label=3;case 3:return a++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(e,n,i){return Ro(this,void 0,void 0,function(){return go(this,function(s){return this.path(bP(i,n)),this.ctx.fillStyle=Ps(e),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(e,n,i,s){return Ro(this,void 0,void 0,function(){var a,o;return go(this,function(A){switch(A.label){case 0:return n<3?[4,this.renderSolidBorder(e,i,s)]:[3,2];case 1:return A.sent(),[2];case 2:return a=sct(s,i),this.path(a),this.ctx.fillStyle=Ps(e),this.ctx.fill(),o=oct(s,i),this.path(o),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(e){return Ro(this,void 0,void 0,function(){var n,i,s,a,o,A,f,m,b=this;return go(this,function(x){switch(x.label){case 0:return this.applyEffects(e.getEffects(2)),n=e.container.styles,i=!VA(n.backgroundColor)||n.backgroundImage.length,s=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],a=mct(Nf(n.backgroundClip,0),e.curves),i||n.boxShadow.length?(this.ctx.save(),this.path(a),this.ctx.clip(),VA(n.backgroundColor)||(this.ctx.fillStyle=Ps(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(e.container)]):[3,2];case 1:x.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(C){b.ctx.save();var M=h1(e.curves),U=C.inset?0:fct,N=nct(M,-U+(C.inset?1:-1)*C.spread.number,(C.inset?1:-1)*C.spread.number,C.spread.number*(C.inset?-2:2),C.spread.number*(C.inset?-2:2));C.inset?(b.path(M),b.ctx.clip(),b.mask(N)):(b.mask(M),b.ctx.clip(),b.path(N)),b.ctx.shadowOffsetX=C.offsetX.number+U,b.ctx.shadowOffsetY=C.offsetY.number,b.ctx.shadowColor=Ps(C.color),b.ctx.shadowBlur=C.blur.number,b.ctx.fillStyle=C.inset?Ps(C.color):"rgba(0,0,0,1)",b.ctx.fill(),b.ctx.restore()}),x.label=2;case 2:o=0,A=0,f=s,x.label=3;case 3:return A<f.length?(m=f[A],m.style!==0&&!VA(m.color)&&m.width>0?m.style!==2?[3,5]:[4,this.renderDashedDottedBorder(m.color,m.width,o,e.curves,2)]:[3,11]):[3,13];case 4:return x.sent(),[3,11];case 5:return m.style!==3?[3,7]:[4,this.renderDashedDottedBorder(m.color,m.width,o,e.curves,3)];case 6:return x.sent(),[3,11];case 7:return m.style!==4?[3,9]:[4,this.renderDoubleBorder(m.color,m.width,o,e.curves)];case 8:return x.sent(),[3,11];case 9:return[4,this.renderSolidBorder(m.color,o,e.curves)];case 10:x.sent(),x.label=11;case 11:o++,x.label=12;case 12:return A++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(e,n,i,s,a){return Ro(this,void 0,void 0,function(){var o,A,f,m,b,x,C,M,U,N,Q,q,Y,tt,ft,pt,ft,pt;return go(this,function(mt){return this.ctx.save(),o=act(s,i),A=bP(s,i),a===2&&(this.path(A),this.ctx.clip()),cc(A[0])?(f=A[0].start.x,m=A[0].start.y):(f=A[0].x,m=A[0].y),cc(A[1])?(b=A[1].end.x,x=A[1].end.y):(b=A[1].x,x=A[1].y),i===0||i===2?C=Math.abs(f-b):C=Math.abs(m-x),this.ctx.beginPath(),a===3?this.formatPath(o):this.formatPath(A.slice(0,2)),M=n<3?n*3:n*2,U=n<3?n*2:n,a===3&&(M=n,U=n),N=!0,C<=M*2?N=!1:C<=M*2+U?(Q=C/(2*M+U),M*=Q,U*=Q):(q=Math.floor((C+U)/(M+U)),Y=(C-q*M)/(q-1),tt=(C-(q+1)*M)/q,U=tt<=0||Math.abs(U-Y)<Math.abs(U-tt)?Y:tt),N&&(a===3?this.ctx.setLineDash([0,M+U]):this.ctx.setLineDash([M,U])),a===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=Ps(e),this.ctx.stroke(),this.ctx.setLineDash([]),a===2&&(cc(A[0])&&(ft=A[3],pt=A[0],this.ctx.beginPath(),this.formatPath([new lr(ft.end.x,ft.end.y),new lr(pt.start.x,pt.start.y)]),this.ctx.stroke()),cc(A[1])&&(ft=A[1],pt=A[2],this.ctx.beginPath(),this.formatPath([new lr(ft.end.x,ft.end.y),new lr(pt.start.x,pt.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(e){return Ro(this,void 0,void 0,function(){var n;return go(this,function(i){switch(i.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Ps(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=ict(e),[4,this.renderStack(n)];case 1:return i.sent(),this.applyEffects([]),[2,this.canvas]}})})},t}(BP),gct=function(r){return r instanceof WM||r instanceof KM?!0:r instanceof dx&&r.type!==o1&&r.type!==s1},mct=function(r,t){switch(r){case 0:return h1(t);case 2:return Jat(t);case 1:default:return d1(t)}},yct=function(r){switch(r){case 1:return"center";case 2:return"right";case 0:default:return"left"}},_ct=["-apple-system","system-ui"],vct=function(r){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?r.filter(function(t){return _ct.indexOf(t)===-1}):r},bct=function(r){$c(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.canvas=n.canvas?n.canvas:document.createElement("canvas"),i.ctx=i.canvas.getContext("2d"),i.options=n,i.canvas.width=Math.floor(n.width*n.scale),i.canvas.height=Math.floor(n.height*n.scale),i.canvas.style.width=n.width+"px",i.canvas.style.height=n.height+"px",i.ctx.scale(i.options.scale,i.options.scale),i.ctx.translate(-n.x,-n.y),i.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),i}return t.prototype.render=function(e){return Ro(this,void 0,void 0,function(){var n,i;return go(this,function(s){switch(s.label){case 0:return n=ux(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,e),[4,wct(n)];case 1:return i=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Ps(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(i,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t}(BP),wct=function(r){return new Promise(function(t,e){var n=new Image;n.onload=function(){t(n)},n.onerror=e,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(r))})},xct=function(){function r(t){var e=t.id,n=t.enabled;this.id=e,this.enabled=n,this.start=Date.now()}return r.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Cy([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},r.prototype.getTime=function(){return Date.now()-this.start},r.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Cy([this.id,this.getTime()+"ms"],t))},r.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Cy([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},r.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Cy([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},r.instances={},r}(),Bct=function(){function r(t,e){var n;this.windowBounds=e,this.instanceName="#"+r.instanceCount++,this.logger=new xct({id:this.instanceName,enabled:t.logging}),this.cache=(n=t.cache)!==null&&n!==void 0?n:new Vat(this,t)}return r.instanceCount=1,r}(),Cct=function(r,t){return t===void 0&&(t={}),Ect(r,t)};typeof window<"u"&&pP.setContext(window);var Ect=function(r,t){return Ro(void 0,void 0,void 0,function(){var e,n,i,s,a,o,A,f,m,b,x,C,M,U,N,Q,q,Y,tt,ft,mt,pt,mt,dt,Rt,Lt,st,ct,wt,yt,te,Zt,re,Xt,ne,se,we,it,vt,Ft;return go(this,function(Ot){switch(Ot.label){case 0:if(!r||typeof r!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(e=r.ownerDocument,!e)throw new Error("Element is not attached to a Document");if(n=e.defaultView,!n)throw new Error("Document is not attached to a Window");return i={allowTaint:(dt=t.allowTaint)!==null&&dt!==void 0?dt:!1,imageTimeout:(Rt=t.imageTimeout)!==null&&Rt!==void 0?Rt:15e3,proxy:t.proxy,useCORS:(Lt=t.useCORS)!==null&&Lt!==void 0?Lt:!1},s=L2({logging:(st=t.logging)!==null&&st!==void 0?st:!0,cache:t.cache},i),a={windowWidth:(ct=t.windowWidth)!==null&&ct!==void 0?ct:n.innerWidth,windowHeight:(wt=t.windowHeight)!==null&&wt!==void 0?wt:n.innerHeight,scrollX:(yt=t.scrollX)!==null&&yt!==void 0?yt:n.pageXOffset,scrollY:(te=t.scrollY)!==null&&te!==void 0?te:n.pageYOffset},o=new Ou(a.scrollX,a.scrollY,a.windowWidth,a.windowHeight),A=new Bct(s,o),f=(Zt=t.foreignObjectRendering)!==null&&Zt!==void 0?Zt:!1,m={allowTaint:(re=t.allowTaint)!==null&&re!==void 0?re:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:f,copyStyles:f},A.logger.debug("Starting document clone with size "+o.width+"x"+o.height+" scrolled to "+-o.left+","+-o.top),b=new dP(A,r,m),x=b.clonedReferenceElement,x?[4,b.toIFrame(e,o)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return C=Ot.sent(),M=px(x)||Sat(x)?nnt(x.ownerDocument):Ey(A,x),U=M.width,N=M.height,Q=M.left,q=M.top,Y=Sct(A,x,t.backgroundColor),tt={canvas:t.canvas,backgroundColor:Y,scale:(ne=(Xt=t.scale)!==null&&Xt!==void 0?Xt:n.devicePixelRatio)!==null&&ne!==void 0?ne:1,x:((se=t.x)!==null&&se!==void 0?se:0)+Q,y:((we=t.y)!==null&&we!==void 0?we:0)+q,width:(it=t.width)!==null&&it!==void 0?it:Math.ceil(U),height:(vt=t.height)!==null&&vt!==void 0?vt:Math.ceil(N)},f?(A.logger.debug("Document cloned, using foreign object rendering"),mt=new bct(A,tt),[4,mt.render(x)]):[3,3];case 2:return ft=Ot.sent(),[3,5];case 3:return A.logger.debug("Document cloned, element located at "+Q+","+q+" with size "+U+"x"+N+" using computed rendering"),A.logger.debug("Starting DOM parsing"),pt=YM(A,x),Y===pt.styles.backgroundColor&&(pt.styles.backgroundColor=ku.TRANSPARENT),A.logger.debug("Starting renderer for element at "+tt.x+","+tt.y+" with size "+tt.width+"x"+tt.height),mt=new pct(A,tt),[4,mt.render(pt)];case 4:ft=Ot.sent(),Ot.label=5;case 5:return(!((Ft=t.removeContainer)!==null&&Ft!==void 0)||Ft)&&(dP.destroy(C)||A.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),A.logger.debug("Finished rendering"),[2,ft]}})})},Sct=function(r,t,e){var n=t.ownerDocument,i=n.documentElement?Gg(r,getComputedStyle(n.documentElement).backgroundColor):ku.TRANSPARENT,s=n.body?Gg(r,getComputedStyle(n.body).backgroundColor):ku.TRANSPARENT,a=typeof e=="string"?Gg(r,e):e===null?ku.TRANSPARENT:4294967295;return t===n.documentElement?VA(i)?VA(s)?a:s:i:a};const Tct=Object.freeze(Object.defineProperty({__proto__:null,default:Cct},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.5.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.0/LICENSE */function WA(r){"@babel/helpers - typeof";return WA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},WA(r)}function Cx(r,t){return Cx=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},Cx(r,t)}function Ict(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function y1(r,t,e){return Ict()?y1=Reflect.construct:y1=function(n,i,s){var a=[null];a.push.apply(a,i);var o=Function.bind.apply(n,a),A=new o;return s&&Cx(A,s.prototype),A},y1.apply(null,arguments)}function Yc(r){return Lct(r)||Fct(r)||Mct(r)||Pct()}function Lct(r){if(Array.isArray(r))return Ex(r)}function Fct(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Mct(r,t){if(r){if(typeof r=="string")return Ex(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ex(r,t)}}function Ex(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function Pct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Uct=Object.hasOwnProperty,CP=Object.setPrototypeOf,Rct=Object.isFrozen,Oct=Object.getPrototypeOf,Dct=Object.getOwnPropertyDescriptor,ko=Object.freeze,uc=Object.seal,kct=Object.create,EP=typeof Reflect<"u"&&Reflect,_1=EP.apply,Sx=EP.construct;_1||(_1=function(r,t,e){return r.apply(t,e)}),ko||(ko=function(r){return r}),uc||(uc=function(r){return r}),Sx||(Sx=function(r,t){return y1(r,Yc(t))});var Nct=Ac(Array.prototype.forEach),SP=Ac(Array.prototype.pop),Xg=Ac(Array.prototype.push),v1=Ac(String.prototype.toLowerCase),Tx=Ac(String.prototype.toString),TP=Ac(String.prototype.match),Jc=Ac(String.prototype.replace),Qct=Ac(String.prototype.indexOf),Hct=Ac(String.prototype.trim),mo=Ac(RegExp.prototype.test),Ix=zct(TypeError);function Ac(r){return function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return _1(r,t,n)}}function zct(r){return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Sx(r,e)}}function An(r,t,e){var n;e=(n=e)!==null&&n!==void 0?n:v1,CP&&CP(r,null);for(var i=t.length;i--;){var s=t[i];if(typeof s=="string"){var a=e(s);a!==s&&(Rct(t)||(t[i]=a),s=a)}r[s]=!0}return r}function Xh(r){var t=kct(null),e;for(e in r)_1(Uct,r,[e])===!0&&(t[e]=r[e]);return t}function b1(r,t){for(;r!==null;){var e=Dct(r,t);if(e){if(e.get)return Ac(e.get);if(typeof e.value=="function")return Ac(e.value)}r=Oct(r)}function n(i){return console.warn("fallback value for",i),null}return n}var IP=ko(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Lx=ko(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Fx=ko(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Gct=ko(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Mx=ko(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Vct=ko(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),LP=ko(["#text"]),FP=ko(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Px=ko(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),MP=ko(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),w1=ko(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),jct=uc(/\{\{[\w\W]*|[\w\W]*\}\}/gm),qct=uc(/<%[\w\W]*|[\w\W]*%>/gm),Kct=uc(/\${[\w\W]*}/gm),Wct=uc(/^data-[\-\w.\u00B7-\uFFFF]/),$ct=uc(/^aria-[\-\w]+$/),Xct=uc(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Yct=uc(/^(?:\w+script|data):/i),Jct=uc(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Zct=uc(/^html$/i),tlt=uc(/^[a-z][.\w]*(-[.\w]+)+$/i),elt=function(){return typeof window>"u"?null:window},rlt=function(r,t){if(WA(r)!=="object"||typeof r.createPolicy!="function")return null;var e=null,n="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(n)&&(e=t.currentScript.getAttribute(n));var i="dompurify"+(e?"#"+e:"");try{return r.createPolicy(i,{createHTML:function(s){return s},createScriptURL:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function PP(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:elt(),t=function(Dt){return PP(Dt)};if(t.version="2.5.0",t.removed=[],!r||!r.document||r.document.nodeType!==9)return t.isSupported=!1,t;var e=r.document,n=r.document,i=r.DocumentFragment,s=r.HTMLTemplateElement,a=r.Node,o=r.Element,A=r.NodeFilter,f=r.NamedNodeMap,m=f===void 0?r.NamedNodeMap||r.MozNamedAttrMap:f,b=r.HTMLFormElement,x=r.DOMParser,C=r.trustedTypes,M=o.prototype,U=b1(M,"cloneNode"),N=b1(M,"nextSibling"),Q=b1(M,"childNodes"),q=b1(M,"parentNode");if(typeof s=="function"){var Y=n.createElement("template");Y.content&&Y.content.ownerDocument&&(n=Y.content.ownerDocument)}var tt=rlt(C,e),ft=tt?tt.createHTML(""):"",pt=n,mt=pt.implementation,dt=pt.createNodeIterator,Rt=pt.createDocumentFragment,Lt=pt.getElementsByTagName,st=e.importNode,ct={};try{ct=Xh(n).documentMode?n.documentMode:{}}catch{}var wt={};t.isSupported=typeof q=="function"&&mt&&mt.createHTMLDocument!==void 0&&ct!==9;var yt=jct,te=qct,Zt=Kct,re=Wct,Xt=$ct,ne=Yct,se=Jct,we=tlt,it=Xct,vt=null,Ft=An({},[].concat(Yc(IP),Yc(Lx),Yc(Fx),Yc(Mx),Yc(LP))),Ot=null,Wt=An({},[].concat(Yc(FP),Yc(Px),Yc(MP),Yc(w1))),jt=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ae=null,ie=null,Be=!0,Te=!0,Ne=!1,Qe=!0,He=!1,ge=!0,Ut=!1,Yt=!1,tr=!1,Ee=!1,_e=!1,xe=!1,De=!0,nr=!1,ur="user-content-",Ir=!0,Sr=!1,Dr={},Nr=null,fe=An({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Tr=null,Oe=An({},["audio","video","img","source","image","track"]),wn=null,Fr=An({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Se="http://www.w3.org/1998/Math/MathML",Xe="http://www.w3.org/2000/svg",qe="http://www.w3.org/1999/xhtml",Yr=qe,Rr=!1,pr=null,on=An({},[Se,Xe,qe],Tx),Kr,Ct=["application/xhtml+xml","text/html"],Z="text/html",J,ot=null,Et=n.createElement("form"),Nt=function(Dt){return Dt instanceof RegExp||Dt instanceof Function},zt=function(Dt){ot&&ot===Dt||((!Dt||WA(Dt)!=="object")&&(Dt={}),Dt=Xh(Dt),Kr=Ct.indexOf(Dt.PARSER_MEDIA_TYPE)===-1?Kr=Z:Kr=Dt.PARSER_MEDIA_TYPE,J=Kr==="application/xhtml+xml"?Tx:v1,vt="ALLOWED_TAGS"in Dt?An({},Dt.ALLOWED_TAGS,J):Ft,Ot="ALLOWED_ATTR"in Dt?An({},Dt.ALLOWED_ATTR,J):Wt,pr="ALLOWED_NAMESPACES"in Dt?An({},Dt.ALLOWED_NAMESPACES,Tx):on,wn="ADD_URI_SAFE_ATTR"in Dt?An(Xh(Fr),Dt.ADD_URI_SAFE_ATTR,J):Fr,Tr="ADD_DATA_URI_TAGS"in Dt?An(Xh(Oe),Dt.ADD_DATA_URI_TAGS,J):Oe,Nr="FORBID_CONTENTS"in Dt?An({},Dt.FORBID_CONTENTS,J):fe,ae="FORBID_TAGS"in Dt?An({},Dt.FORBID_TAGS,J):{},ie="FORBID_ATTR"in Dt?An({},Dt.FORBID_ATTR,J):{},Dr="USE_PROFILES"in Dt?Dt.USE_PROFILES:!1,Be=Dt.ALLOW_ARIA_ATTR!==!1,Te=Dt.ALLOW_DATA_ATTR!==!1,Ne=Dt.ALLOW_UNKNOWN_PROTOCOLS||!1,Qe=Dt.ALLOW_SELF_CLOSE_IN_ATTR!==!1,He=Dt.SAFE_FOR_TEMPLATES||!1,ge=Dt.SAFE_FOR_XML!==!1,Ut=Dt.WHOLE_DOCUMENT||!1,Ee=Dt.RETURN_DOM||!1,_e=Dt.RETURN_DOM_FRAGMENT||!1,xe=Dt.RETURN_TRUSTED_TYPE||!1,tr=Dt.FORCE_BODY||!1,De=Dt.SANITIZE_DOM!==!1,nr=Dt.SANITIZE_NAMED_PROPS||!1,Ir=Dt.KEEP_CONTENT!==!1,Sr=Dt.IN_PLACE||!1,it=Dt.ALLOWED_URI_REGEXP||it,Yr=Dt.NAMESPACE||qe,jt=Dt.CUSTOM_ELEMENT_HANDLING||{},Dt.CUSTOM_ELEMENT_HANDLING&&Nt(Dt.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(jt.tagNameCheck=Dt.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Dt.CUSTOM_ELEMENT_HANDLING&&Nt(Dt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(jt.attributeNameCheck=Dt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Dt.CUSTOM_ELEMENT_HANDLING&&typeof Dt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(jt.allowCustomizedBuiltInElements=Dt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),He&&(Te=!1),_e&&(Ee=!0),Dr&&(vt=An({},Yc(LP)),Ot=[],Dr.html===!0&&(An(vt,IP),An(Ot,FP)),Dr.svg===!0&&(An(vt,Lx),An(Ot,Px),An(Ot,w1)),Dr.svgFilters===!0&&(An(vt,Fx),An(Ot,Px),An(Ot,w1)),Dr.mathMl===!0&&(An(vt,Mx),An(Ot,MP),An(Ot,w1))),Dt.ADD_TAGS&&(vt===Ft&&(vt=Xh(vt)),An(vt,Dt.ADD_TAGS,J)),Dt.ADD_ATTR&&(Ot===Wt&&(Ot=Xh(Ot)),An(Ot,Dt.ADD_ATTR,J)),Dt.ADD_URI_SAFE_ATTR&&An(wn,Dt.ADD_URI_SAFE_ATTR,J),Dt.FORBID_CONTENTS&&(Nr===fe&&(Nr=Xh(Nr)),An(Nr,Dt.FORBID_CONTENTS,J)),Ir&&(vt["#text"]=!0),Ut&&An(vt,["html","head","body"]),vt.table&&(An(vt,["tbody"]),delete ae.tbody),ko&&ko(Dt),ot=Dt)},qt=An({},["mi","mo","mn","ms","mtext"]),St=An({},["foreignobject","desc","title","annotation-xml"]),Jt=An({},["title","style","font","a","script"]),me=An({},Lx);An(me,Fx),An(me,Gct);var pe=An({},Mx);An(pe,Vct);var de=function(Dt){var Ue=q(Dt);(!Ue||!Ue.tagName)&&(Ue={namespaceURI:Yr,tagName:"template"});var Ie=v1(Dt.tagName),rn=v1(Ue.tagName);return pr[Dt.namespaceURI]?Dt.namespaceURI===Xe?Ue.namespaceURI===qe?Ie==="svg":Ue.namespaceURI===Se?Ie==="svg"&&(rn==="annotation-xml"||qt[rn]):!!me[Ie]:Dt.namespaceURI===Se?Ue.namespaceURI===qe?Ie==="math":Ue.namespaceURI===Xe?Ie==="math"&&St[rn]:!!pe[Ie]:Dt.namespaceURI===qe?Ue.namespaceURI===Xe&&!St[rn]||Ue.namespaceURI===Se&&!qt[rn]?!1:!pe[Ie]&&(Jt[Ie]||!me[Ie]):!!(Kr==="application/xhtml+xml"&&pr[Dt.namespaceURI]):!1},Ge=function(Dt){Xg(t.removed,{element:Dt});try{Dt.parentNode.removeChild(Dt)}catch{try{Dt.outerHTML=ft}catch{Dt.remove()}}},Ye=function(Dt,Ue){try{Xg(t.removed,{attribute:Ue.getAttributeNode(Dt),from:Ue})}catch{Xg(t.removed,{attribute:null,from:Ue})}if(Ue.removeAttribute(Dt),Dt==="is"&&!Ot[Dt])if(Ee||_e)try{Ge(Ue)}catch{}else try{Ue.setAttribute(Dt,"")}catch{}},Cr=function(Dt){var Ue,Ie;if(tr)Dt="<remove></remove>"+Dt;else{var rn=TP(Dt,/^[\r\n\t ]+/);Ie=rn&&rn[0]}Kr==="application/xhtml+xml"&&Yr===qe&&(Dt='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Dt+"</body></html>");var Mn=tt?tt.createHTML(Dt):Dt;if(Yr===qe)try{Ue=new x().parseFromString(Mn,Kr)}catch{}if(!Ue||!Ue.documentElement){Ue=mt.createDocument(Yr,"template",null);try{Ue.documentElement.innerHTML=Rr?ft:Mn}catch{}}var xr=Ue.body||Ue.documentElement;return Dt&&Ie&&xr.insertBefore(n.createTextNode(Ie),xr.childNodes[0]||null),Yr===qe?Lt.call(Ue,Ut?"html":"body")[0]:Ut?Ue.documentElement:xr},cr=function(Dt){return dt.call(Dt.ownerDocument||Dt,Dt,A.SHOW_ELEMENT|A.SHOW_COMMENT|A.SHOW_TEXT|A.SHOW_PROCESSING_INSTRUCTION|A.SHOW_CDATA_SECTION,null,!1)},Pr=function(Dt){return Dt instanceof b&&(typeof Dt.nodeName!="string"||typeof Dt.textContent!="string"||typeof Dt.removeChild!="function"||!(Dt.attributes instanceof m)||typeof Dt.removeAttribute!="function"||typeof Dt.setAttribute!="function"||typeof Dt.namespaceURI!="string"||typeof Dt.insertBefore!="function"||typeof Dt.hasChildNodes!="function")},kr=function(Dt){return WA(a)==="object"?Dt instanceof a:Dt&&WA(Dt)==="object"&&typeof Dt.nodeType=="number"&&typeof Dt.nodeName=="string"},Qr=function(Dt,Ue,Ie){wt[Dt]&&Nct(wt[Dt],function(rn){rn.call(t,Ue,Ie,ot)})},gn=function(Dt){var Ue;if(Qr("beforeSanitizeElements",Dt,null),Pr(Dt)||mo(/[\u0080-\uFFFF]/,Dt.nodeName))return Ge(Dt),!0;var Ie=J(Dt.nodeName);if(Qr("uponSanitizeElement",Dt,{tagName:Ie,allowedTags:vt}),Dt.hasChildNodes()&&!kr(Dt.firstElementChild)&&(!kr(Dt.content)||!kr(Dt.content.firstElementChild))&&mo(/<[/\w]/g,Dt.innerHTML)&&mo(/<[/\w]/g,Dt.textContent)||Ie==="select"&&mo(/<template/i,Dt.innerHTML)||Dt.nodeType===7||ge&&Dt.nodeType===8&&mo(/<[/\w]/g,Dt.data))return Ge(Dt),!0;if(!vt[Ie]||ae[Ie]){if(!ae[Ie]&&Wr(Ie)&&(jt.tagNameCheck instanceof RegExp&&mo(jt.tagNameCheck,Ie)||jt.tagNameCheck instanceof Function&&jt.tagNameCheck(Ie)))return!1;if(Ir&&!Nr[Ie]){var rn=q(Dt)||Dt.parentNode,Mn=Q(Dt)||Dt.childNodes;if(Mn&&rn)for(var xr=Mn.length,mn=xr-1;mn>=0;--mn)rn.insertBefore(U(Mn[mn],!0),N(Dt))}return Ge(Dt),!0}return Dt instanceof o&&!de(Dt)||(Ie==="noscript"||Ie==="noembed"||Ie==="noframes")&&mo(/<\/no(script|embed|frames)/i,Dt.innerHTML)?(Ge(Dt),!0):(He&&Dt.nodeType===3&&(Ue=Dt.textContent,Ue=Jc(Ue,yt," "),Ue=Jc(Ue,te," "),Ue=Jc(Ue,Zt," "),Dt.textContent!==Ue&&(Xg(t.removed,{element:Dt.cloneNode()}),Dt.textContent=Ue)),Qr("afterSanitizeElements",Dt,null),!1)},gr=function(Dt,Ue,Ie){if(De&&(Ue==="id"||Ue==="name")&&(Ie in n||Ie in Et))return!1;if(!(Te&&!ie[Ue]&&mo(re,Ue))&&!(Be&&mo(Xt,Ue))){if(!Ot[Ue]||ie[Ue]){if(!(Wr(Dt)&&(jt.tagNameCheck instanceof RegExp&&mo(jt.tagNameCheck,Dt)||jt.tagNameCheck instanceof Function&&jt.tagNameCheck(Dt))&&(jt.attributeNameCheck instanceof RegExp&&mo(jt.attributeNameCheck,Ue)||jt.attributeNameCheck instanceof Function&&jt.attributeNameCheck(Ue))||Ue==="is"&&jt.allowCustomizedBuiltInElements&&(jt.tagNameCheck instanceof RegExp&&mo(jt.tagNameCheck,Ie)||jt.tagNameCheck instanceof Function&&jt.tagNameCheck(Ie))))return!1}else if(!wn[Ue]&&!mo(it,Jc(Ie,se,""))&&!((Ue==="src"||Ue==="xlink:href"||Ue==="href")&&Dt!=="script"&&Qct(Ie,"data:")===0&&Tr[Dt])&&!(Ne&&!mo(ne,Jc(Ie,se,"")))&&Ie)return!1}return!0},Wr=function(Dt){return Dt!=="annotation-xml"&&TP(Dt,we)},vn=function(Dt){var Ue,Ie,rn,Mn;Qr("beforeSanitizeAttributes",Dt,null);var xr=Dt.attributes;if(xr){var mn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ot};for(Mn=xr.length;Mn--;){Ue=xr[Mn];var bi=Ue,yn=bi.name,nn=bi.namespaceURI;if(Ie=yn==="value"?Ue.value:Hct(Ue.value),rn=J(yn),mn.attrName=rn,mn.attrValue=Ie,mn.keepAttr=!0,mn.forceKeepAttr=void 0,Qr("uponSanitizeAttribute",Dt,mn),Ie=mn.attrValue,!mn.forceKeepAttr&&(Ye(yn,Dt),!!mn.keepAttr)){if(!Qe&&mo(/\/>/i,Ie)){Ye(yn,Dt);continue}He&&(Ie=Jc(Ie,yt," "),Ie=Jc(Ie,te," "),Ie=Jc(Ie,Zt," "));var wi=J(Dt.nodeName);if(gr(wi,rn,Ie)){if(nr&&(rn==="id"||rn==="name")&&(Ye(yn,Dt),Ie=ur+Ie),tt&&WA(C)==="object"&&typeof C.getAttributeType=="function"&&!nn)switch(C.getAttributeType(wi,rn)){case"TrustedHTML":{Ie=tt.createHTML(Ie);break}case"TrustedScriptURL":{Ie=tt.createScriptURL(Ie);break}}try{nn?Dt.setAttributeNS(nn,yn,Ie):Dt.setAttribute(yn,Ie),SP(t.removed)}catch{}}}}Qr("afterSanitizeAttributes",Dt,null)}},Dn=function Dt(Ue){var Ie,rn=cr(Ue);for(Qr("beforeSanitizeShadowDOM",Ue,null);Ie=rn.nextNode();)Qr("uponSanitizeShadowNode",Ie,null),!gn(Ie)&&(Ie.content instanceof i&&Dt(Ie.content),vn(Ie));Qr("afterSanitizeShadowDOM",Ue,null)};return t.sanitize=function(Dt){var Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ie,rn,Mn,xr,mn;if(Rr=!Dt,Rr&&(Dt="<!-->"),typeof Dt!="string"&&!kr(Dt))if(typeof Dt.toString=="function"){if(Dt=Dt.toString(),typeof Dt!="string")throw Ix("dirty is not a string, aborting")}else throw Ix("toString is not a function");if(!t.isSupported){if(WA(r.toStaticHTML)==="object"||typeof r.toStaticHTML=="function"){if(typeof Dt=="string")return r.toStaticHTML(Dt);if(kr(Dt))return r.toStaticHTML(Dt.outerHTML)}return Dt}if(Yt||zt(Ue),t.removed=[],typeof Dt=="string"&&(Sr=!1),Sr){if(Dt.nodeName){var bi=J(Dt.nodeName);if(!vt[bi]||ae[bi])throw Ix("root node is forbidden and cannot be sanitized in-place")}}else if(Dt instanceof a)Ie=Cr("<!---->"),rn=Ie.ownerDocument.importNode(Dt,!0),rn.nodeType===1&&rn.nodeName==="BODY"||rn.nodeName==="HTML"?Ie=rn:Ie.appendChild(rn);else{if(!Ee&&!He&&!Ut&&Dt.indexOf("<")===-1)return tt&&xe?tt.createHTML(Dt):Dt;if(Ie=Cr(Dt),!Ie)return Ee?null:xe?ft:""}Ie&&tr&&Ge(Ie.firstChild);for(var yn=cr(Sr?Dt:Ie);Mn=yn.nextNode();)Mn.nodeType===3&&Mn===xr||gn(Mn)||(Mn.content instanceof i&&Dn(Mn.content),vn(Mn),xr=Mn);if(xr=null,Sr)return Dt;if(Ee){if(_e)for(mn=Rt.call(Ie.ownerDocument);Ie.firstChild;)mn.appendChild(Ie.firstChild);else mn=Ie;return(Ot.shadowroot||Ot.shadowrootmod)&&(mn=st.call(e,mn,!0)),mn}var nn=Ut?Ie.outerHTML:Ie.innerHTML;return Ut&&vt["!doctype"]&&Ie.ownerDocument&&Ie.ownerDocument.doctype&&Ie.ownerDocument.doctype.name&&mo(Zct,Ie.ownerDocument.doctype.name)&&(nn="<!DOCTYPE "+Ie.ownerDocument.doctype.name+`>
`+nn),He&&(nn=Jc(nn,yt," "),nn=Jc(nn,te," "),nn=Jc(nn,Zt," ")),tt&&xe?tt.createHTML(nn):nn},t.setConfig=function(Dt){zt(Dt),Yt=!0},t.clearConfig=function(){ot=null,Yt=!1},t.isValidAttribute=function(Dt,Ue,Ie){ot||zt({});var rn=J(Dt),Mn=J(Ue);return gr(rn,Mn,Ie)},t.addHook=function(Dt,Ue){typeof Ue=="function"&&(wt[Dt]=wt[Dt]||[],Xg(wt[Dt],Ue))},t.removeHook=function(Dt){if(wt[Dt])return SP(wt[Dt])},t.removeHooks=function(Dt){wt[Dt]&&(wt[Dt]=[])},t.removeAllHooks=function(){wt={}},t}var nlt=PP();const ilt=Object.freeze(Object.defineProperty({__proto__:null,default:nlt},Symbol.toStringTag,{value:"Module"}));var Qf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function UP(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Yg=function(r){return r&&r.Math===Math&&r},rs=Yg(typeof globalThis=="object"&&globalThis)||Yg(typeof window=="object"&&window)||Yg(typeof self=="object"&&self)||Yg(typeof Qf=="object"&&Qf)||Yg(typeof Qf=="object"&&Qf)||function(){return this}()||Function("return this")(),Jg={},ns=function(r){try{return!!r()}catch{return!0}},slt=ns,Zc=!slt(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),olt=ns,x1=!olt(function(){var r=(function(){}).bind();return typeof r!="function"||r.hasOwnProperty("prototype")}),alt=x1,B1=Function.prototype.call,$s=alt?B1.bind(B1):function(){return B1.apply(B1,arguments)},RP={},OP={}.propertyIsEnumerable,DP=Object.getOwnPropertyDescriptor,clt=DP&&!OP.call({1:2},1);RP.f=clt?function(r){var t=DP(this,r);return!!t&&t.enumerable}:OP;var Ux=function(r,t){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:t}},kP=x1,NP=Function.prototype,Rx=NP.call,llt=kP&&NP.bind.bind(Rx,Rx),is=kP?llt:function(r){return function(){return Rx.apply(r,arguments)}},QP=is,ult=QP({}.toString),Alt=QP("".slice),Yh=function(r){return Alt(ult(r),8,-1)},hlt=is,dlt=ns,flt=Yh,Ox=Object,plt=hlt("".split),HP=dlt(function(){return!Ox("z").propertyIsEnumerable(0)})?function(r){return flt(r)==="String"?plt(r,""):Ox(r)}:Ox,Jh=function(r){return r==null},glt=Jh,mlt=TypeError,tl=function(r){if(glt(r))throw new mlt("Can't call method on "+r);return r},ylt=HP,_lt=tl,Zg=function(r){return ylt(_lt(r))},Dx=typeof document=="object"&&document.all,ss=typeof Dx>"u"&&Dx!==void 0?function(r){return typeof r=="function"||r===Dx}:function(r){return typeof r=="function"},vlt=ss,el=function(r){return typeof r=="object"?r!==null:vlt(r)},kx=rs,blt=ss,wlt=function(r){return blt(r)?r:void 0},Zh=function(r,t){return arguments.length<2?wlt(kx[r]):kx[r]&&kx[r][t]},xlt=is,C1=xlt({}.isPrototypeOf),E1=typeof navigator<"u"&&String(navigator.userAgent)||"",zP=rs,Nx=E1,GP=zP.process,VP=zP.Deno,jP=GP&&GP.versions||VP&&VP.version,qP=jP&&jP.v8,rl,S1;qP&&(rl=qP.split("."),S1=rl[0]>0&&rl[0]<4?1:+(rl[0]+rl[1])),!S1&&Nx&&(rl=Nx.match(/Edge\/(\d+)/),(!rl||rl[1]>=74)&&(rl=Nx.match(/Chrome\/(\d+)/),rl&&(S1=+rl[1])));var Qx=S1,KP=Qx,Blt=ns,Clt=rs,Elt=Clt.String,WP=!!Object.getOwnPropertySymbols&&!Blt(function(){var r=Symbol("symbol detection");return!Elt(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&KP&&KP<41}),Slt=WP,$P=Slt&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Tlt=Zh,Ilt=ss,Llt=C1,Flt=$P,Mlt=Object,XP=Flt?function(r){return typeof r=="symbol"}:function(r){var t=Tlt("Symbol");return Ilt(t)&&Llt(t.prototype,Mlt(r))},Plt=String,T1=function(r){try{return Plt(r)}catch{return"Object"}},Ult=ss,Rlt=T1,Olt=TypeError,Qu=function(r){if(Ult(r))return r;throw new Olt(Rlt(r)+" is not a function")},Dlt=Qu,klt=Jh,Hf=function(r,t){var e=r[t];return klt(e)?void 0:Dlt(e)},Hx=$s,zx=ss,Gx=el,Nlt=TypeError,Qlt=function(r,t){var e,n;if(t==="string"&&zx(e=r.toString)&&!Gx(n=Hx(e,r))||zx(e=r.valueOf)&&!Gx(n=Hx(e,r))||t!=="string"&&zx(e=r.toString)&&!Gx(n=Hx(e,r)))return n;throw new Nlt("Can't convert object to primitive value")},YP={exports:{}},JP=rs,Hlt=Object.defineProperty,Vx=function(r,t){try{Hlt(JP,r,{value:t,configurable:!0,writable:!0})}catch{JP[r]=t}return t},zlt=rs,Glt=Vx,ZP="__core-js_shared__",tU=YP.exports=zlt[ZP]||Glt(ZP,{});(tU.versions||(tU.versions=[])).push({version:"3.36.1",mode:"global",copyright:" 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.36.1/LICENSE",source:"https://github.com/zloirock/core-js"});var jx=YP.exports,eU=jx,qx=function(r,t){return eU[r]||(eU[r]=t||{})},Vlt=tl,jlt=Object,I1=function(r){return jlt(Vlt(r))},qlt=is,Klt=I1,Wlt=qlt({}.hasOwnProperty),nl=Object.hasOwn||function(r,t){return Wlt(Klt(r),t)},$lt=is,Xlt=0,Ylt=Math.random(),Jlt=$lt(1 .toString),rU=function(r){return"Symbol("+(r===void 0?"":r)+")_"+Jlt(++Xlt+Ylt,36)},Zlt=rs,tut=qx,nU=nl,eut=rU,rut=WP,nut=$P,zf=Zlt.Symbol,Kx=tut("wks"),iut=nut?zf.for||zf:zf&&zf.withoutSetter||eut,Us=function(r){return nU(Kx,r)||(Kx[r]=rut&&nU(zf,r)?zf[r]:iut("Symbol."+r)),Kx[r]},sut=$s,iU=el,sU=XP,out=Hf,aut=Qlt,cut=Us,lut=TypeError,uut=cut("toPrimitive"),Aut=function(r,t){if(!iU(r)||sU(r))return r;var e=out(r,uut),n;if(e){if(t===void 0&&(t="default"),n=sut(e,r,t),!iU(n)||sU(n))return n;throw new lut("Can't convert object to primitive value")}return t===void 0&&(t="number"),aut(r,t)},hut=Aut,dut=XP,oU=function(r){var t=hut(r,"string");return dut(t)?t:t+""},fut=rs,aU=el,Wx=fut.document,put=aU(Wx)&&aU(Wx.createElement),L1=function(r){return put?Wx.createElement(r):{}},gut=Zc,mut=ns,yut=L1,cU=!gut&&!mut(function(){return Object.defineProperty(yut("div"),"a",{get:function(){return 7}}).a!==7}),_ut=Zc,vut=$s,but=RP,wut=Ux,xut=Zg,But=oU,Cut=nl,Eut=cU,lU=Object.getOwnPropertyDescriptor;Jg.f=_ut?lU:function(r,t){if(r=xut(r),t=But(t),Eut)try{return lU(r,t)}catch{}if(Cut(r,t))return wut(!vut(but.f,r,t),r[t])};var Hu={},Sut=Zc,Tut=ns,uU=Sut&&Tut(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Iut=el,Lut=String,Fut=TypeError,No=function(r){if(Iut(r))return r;throw new Fut(Lut(r)+" is not an object")},Mut=Zc,Put=cU,Uut=uU,F1=No,AU=oU,Rut=TypeError,$x=Object.defineProperty,Out=Object.getOwnPropertyDescriptor,Xx="enumerable",Yx="configurable",Jx="writable";Hu.f=Mut?Uut?function(r,t,e){if(F1(r),t=AU(t),F1(e),typeof r=="function"&&t==="prototype"&&"value"in e&&Jx in e&&!e[Jx]){var n=Out(r,t);n&&n[Jx]&&(r[t]=e.value,e={configurable:Yx in e?e[Yx]:n[Yx],enumerable:Xx in e?e[Xx]:n[Xx],writable:!1})}return $x(r,t,e)}:$x:function(r,t,e){if(F1(r),t=AU(t),F1(e),Put)try{return $x(r,t,e)}catch{}if("get"in e||"set"in e)throw new Rut("Accessors not supported");return"value"in e&&(r[t]=e.value),r};var Dut=Zc,kut=Hu,Nut=Ux,tm=Dut?function(r,t,e){return kut.f(r,t,Nut(1,e))}:function(r,t,e){return r[t]=e,r},hU={exports:{}},Zx=Zc,Qut=nl,dU=Function.prototype,Hut=Zx&&Object.getOwnPropertyDescriptor,tB=Qut(dU,"name"),zut=tB&&(function(){}).name==="something",Gut=tB&&(!Zx||Zx&&Hut(dU,"name").configurable),M1={EXISTS:tB,PROPER:zut,CONFIGURABLE:Gut},Vut=is,jut=ss,eB=jx,qut=Vut(Function.toString);jut(eB.inspectSource)||(eB.inspectSource=function(r){return qut(r)});var rB=eB.inspectSource,Kut=rs,Wut=ss,fU=Kut.WeakMap,$ut=Wut(fU)&&/native code/.test(String(fU)),Xut=qx,Yut=rU,pU=Xut("keys"),nB=function(r){return pU[r]||(pU[r]=Yut(r))},iB={},Jut=$ut,gU=rs,Zut=el,tAt=tm,sB=nl,oB=jx,eAt=nB,rAt=iB,mU="Object already initialized",aB=gU.TypeError,nAt=gU.WeakMap,P1,em,U1,iAt=function(r){return U1(r)?em(r):P1(r,{})},sAt=function(r){return function(t){var e;if(!Zut(t)||(e=em(t)).type!==r)throw new aB("Incompatible receiver, "+r+" required");return e}};if(Jut||oB.state){var Jl=oB.state||(oB.state=new nAt);Jl.get=Jl.get,Jl.has=Jl.has,Jl.set=Jl.set,P1=function(r,t){if(Jl.has(r))throw new aB(mU);return t.facade=r,Jl.set(r,t),t},em=function(r){return Jl.get(r)||{}},U1=function(r){return Jl.has(r)}}else{var Gf=eAt("state");rAt[Gf]=!0,P1=function(r,t){if(sB(r,Gf))throw new aB(mU);return t.facade=r,tAt(r,Gf,t),t},em=function(r){return sB(r,Gf)?r[Gf]:{}},U1=function(r){return sB(r,Gf)}}var R1={set:P1,get:em,has:U1,enforce:iAt,getterFor:sAt},cB=is,oAt=ns,aAt=ss,O1=nl,lB=Zc,cAt=M1.CONFIGURABLE,lAt=rB,yU=R1,uAt=yU.enforce,AAt=yU.get,_U=String,D1=Object.defineProperty,hAt=cB("".slice),dAt=cB("".replace),fAt=cB([].join),pAt=lB&&!oAt(function(){return D1(function(){},"length",{value:8}).length!==8}),gAt=String(String).split("String"),mAt=hU.exports=function(r,t,e){hAt(_U(t),0,7)==="Symbol("&&(t="["+dAt(_U(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),e&&e.getter&&(t="get "+t),e&&e.setter&&(t="set "+t),(!O1(r,"name")||cAt&&r.name!==t)&&(lB?D1(r,"name",{value:t,configurable:!0}):r.name=t),pAt&&e&&O1(e,"arity")&&r.length!==e.arity&&D1(r,"length",{value:e.arity});try{e&&O1(e,"constructor")&&e.constructor?lB&&D1(r,"prototype",{writable:!1}):r.prototype&&(r.prototype=void 0)}catch{}var n=uAt(r);return O1(n,"source")||(n.source=fAt(gAt,typeof t=="string"?t:"")),r};Function.prototype.toString=mAt(function(){return aAt(this)&&AAt(this).source||lAt(this)},"toString");var vU=hU.exports,yAt=ss,_At=Hu,vAt=vU,bAt=Vx,td=function(r,t,e,n){n||(n={});var i=n.enumerable,s=n.name!==void 0?n.name:t;if(yAt(e)&&vAt(e,s,n),n.global)i?r[t]=e:bAt(t,e);else{try{n.unsafe?r[t]&&(i=!0):delete r[t]}catch{}i?r[t]=e:_At.f(r,t,{value:e,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return r},bU={},wAt=Math.ceil,xAt=Math.floor,BAt=Math.trunc||function(r){var t=+r;return(t>0?xAt:wAt)(t)},CAt=BAt,k1=function(r){var t=+r;return t!==t||t===0?0:CAt(t)},EAt=k1,SAt=Math.max,TAt=Math.min,IAt=function(r,t){var e=EAt(r);return e<0?SAt(e+t,0):TAt(e,t)},LAt=k1,FAt=Math.min,Vf=function(r){var t=LAt(r);return t>0?FAt(t,9007199254740991):0},MAt=Vf,uB=function(r){return MAt(r.length)},PAt=Zg,UAt=IAt,RAt=uB,wU=function(r){return function(t,e,n){var i=PAt(t),s=RAt(i);if(s===0)return!r&&-1;var a=UAt(n,s),o;if(r&&e!==e){for(;s>a;)if(o=i[a++],o!==o)return!0}else for(;s>a;a++)if((r||a in i)&&i[a]===e)return r||a||0;return!r&&-1}},xU={includes:wU(!0),indexOf:wU(!1)},OAt=is,AB=nl,DAt=Zg,kAt=xU.indexOf,NAt=iB,BU=OAt([].push),CU=function(r,t){var e=DAt(r),n=0,i=[],s;for(s in e)!AB(NAt,s)&&AB(e,s)&&BU(i,s);for(;t.length>n;)AB(e,s=t[n++])&&(~kAt(i,s)||BU(i,s));return i},hB=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],QAt=CU,HAt=hB,zAt=HAt.concat("length","prototype");bU.f=Object.getOwnPropertyNames||function(r){return QAt(r,zAt)};var EU={};EU.f=Object.getOwnPropertySymbols;var GAt=Zh,VAt=is,jAt=bU,qAt=EU,KAt=No,WAt=VAt([].concat),$At=GAt("Reflect","ownKeys")||function(r){var t=jAt.f(KAt(r)),e=qAt.f;return e?WAt(t,e(r)):t},SU=nl,XAt=$At,YAt=Jg,JAt=Hu,ZAt=function(r,t,e){for(var n=XAt(t),i=JAt.f,s=YAt.f,a=0;a<n.length;a++){var o=n[a];!SU(r,o)&&!(e&&SU(e,o))&&i(r,o,s(t,o))}},tht=ns,eht=ss,rht=/#|\.prototype\./,rm=function(r,t){var e=iht[nht(r)];return e===oht?!0:e===sht?!1:eht(t)?tht(t):!!t},nht=rm.normalize=function(r){return String(r).replace(rht,".").toLowerCase()},iht=rm.data={},sht=rm.NATIVE="N",oht=rm.POLYFILL="P",TU=rm,N1=rs,aht=Jg.f,cht=tm,lht=td,uht=Vx,Aht=ZAt,hht=TU,Qo=function(r,t){var e=r.target,n=r.global,i=r.stat,s,a,o,A,f,m;if(n?a=N1:i?a=N1[e]||uht(e,{}):a=N1[e]&&N1[e].prototype,a)for(o in t){if(f=t[o],r.dontCallGetSet?(m=aht(a,o),A=m&&m.value):A=a[o],s=hht(n?o:e+(i?".":"#")+o,r.forced),!s&&A!==void 0){if(typeof f==typeof A)continue;Aht(f,A)}(r.sham||A&&A.sham)&&cht(f,"sham",!0),lht(a,o,f,r)}},dht=rs,fht=Yh,nm=fht(dht.process)==="process",pht=is,ght=Qu,mht=function(r,t,e){try{return pht(ght(Object.getOwnPropertyDescriptor(r,t)[e]))}catch{}},yht=el,_ht=function(r){return yht(r)||r===null},vht=_ht,bht=String,wht=TypeError,xht=function(r){if(vht(r))return r;throw new wht("Can't set "+bht(r)+" as a prototype")},Bht=mht,Cht=el,Eht=tl,Sht=xht,IU=Object.setPrototypeOf||("__proto__"in{}?function(){var r=!1,t={},e;try{e=Bht(Object.prototype,"__proto__","set"),e(t,[]),r=t instanceof Array}catch{}return function(n,i){return Eht(n),Sht(i),Cht(n)&&(r?e(n,i):n.__proto__=i),n}}():void 0),Tht=Hu.f,Iht=nl,Lht=Us,LU=Lht("toStringTag"),Q1=function(r,t,e){r&&!e&&(r=r.prototype),r&&!Iht(r,LU)&&Tht(r,LU,{configurable:!0,value:t})},FU=vU,Fht=Hu,Mht=function(r,t,e){return e.get&&FU(e.get,t,{getter:!0}),e.set&&FU(e.set,t,{setter:!0}),Fht.f(r,t,e)},Pht=Zh,Uht=Mht,Rht=Us,Oht=Zc,MU=Rht("species"),Dht=function(r){var t=Pht(r);Oht&&t&&!t[MU]&&Uht(t,MU,{configurable:!0,get:function(){return this}})},kht=C1,Nht=TypeError,Qht=function(r,t){if(kht(t,r))return r;throw new Nht("Incorrect invocation")},Hht=Us,zht=Hht("toStringTag"),PU={};PU[zht]="z";var Ght=String(PU)==="[object z]",Vht=Ght,jht=ss,H1=Yh,qht=Us,Kht=qht("toStringTag"),Wht=Object,$ht=H1(function(){return arguments}())==="Arguments",Xht=function(r,t){try{return r[t]}catch{}},dB=Vht?H1:function(r){var t,e,n;return r===void 0?"Undefined":r===null?"Null":typeof(e=Xht(t=Wht(r),Kht))=="string"?e:$ht?H1(t):(n=H1(t))==="Object"&&jht(t.callee)?"Arguments":n},Yht=is,Jht=ns,UU=ss,Zht=dB,tdt=Zh,edt=rB,RU=function(){},OU=tdt("Reflect","construct"),fB=/^\s*(?:class|function)\b/,rdt=Yht(fB.exec),ndt=!fB.test(RU),im=function(r){if(!UU(r))return!1;try{return OU(RU,[],r),!0}catch{return!1}},DU=function(r){if(!UU(r))return!1;switch(Zht(r)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return ndt||!!rdt(fB,edt(r))}catch{return!0}};DU.sham=!0;var idt=!OU||Jht(function(){var r;return im(im.call)||!im(Object)||!im(function(){r=!0})||r})?DU:im,sdt=idt,odt=T1,adt=TypeError,cdt=function(r){if(sdt(r))return r;throw new adt(odt(r)+" is not a constructor")},kU=No,ldt=cdt,udt=Jh,Adt=Us,hdt=Adt("species"),NU=function(r,t){var e=kU(r).constructor,n;return e===void 0||udt(n=kU(e)[hdt])?t:ldt(n)},ddt=x1,QU=Function.prototype,HU=QU.apply,zU=QU.call,GU=typeof Reflect=="object"&&Reflect.apply||(ddt?zU.bind(HU):function(){return zU.apply(HU,arguments)}),fdt=Yh,pdt=is,z1=function(r){if(fdt(r)==="Function")return pdt(r)},VU=z1,gdt=Qu,mdt=x1,ydt=VU(VU.bind),pB=function(r,t){return gdt(r),t===void 0?r:mdt?ydt(r,t):function(){return r.apply(t,arguments)}},_dt=Zh,jU=_dt("document","documentElement"),vdt=is,bdt=vdt([].slice),wdt=TypeError,xdt=function(r,t){if(r<t)throw new wdt("Not enough arguments");return r},Bdt=E1,qU=/(?:ipad|iphone|ipod).*applewebkit/i.test(Bdt),ka=rs,Cdt=GU,Edt=pB,KU=ss,Sdt=nl,WU=ns,$U=jU,Tdt=bdt,XU=L1,Idt=xdt,Ldt=qU,Fdt=nm,gB=ka.setImmediate,mB=ka.clearImmediate,Mdt=ka.process,yB=ka.Dispatch,Pdt=ka.Function,YU=ka.MessageChannel,Udt=ka.String,_B=0,sm={},JU="onreadystatechange",om,ed,vB,bB;WU(function(){om=ka.location});var wB=function(r){if(Sdt(sm,r)){var t=sm[r];delete sm[r],t()}},xB=function(r){return function(){wB(r)}},ZU=function(r){wB(r.data)},tR=function(r){ka.postMessage(Udt(r),om.protocol+"//"+om.host)};(!gB||!mB)&&(gB=function(r){Idt(arguments.length,1);var t=KU(r)?r:Pdt(r),e=Tdt(arguments,1);return sm[++_B]=function(){Cdt(t,void 0,e)},ed(_B),_B},mB=function(r){delete sm[r]},Fdt?ed=function(r){Mdt.nextTick(xB(r))}:yB&&yB.now?ed=function(r){yB.now(xB(r))}:YU&&!Ldt?(vB=new YU,bB=vB.port2,vB.port1.onmessage=ZU,ed=Edt(bB.postMessage,bB)):ka.addEventListener&&KU(ka.postMessage)&&!ka.importScripts&&om&&om.protocol!=="file:"&&!WU(tR)?(ed=tR,ka.addEventListener("message",ZU,!1)):JU in XU("script")?ed=function(r){$U.appendChild(XU("script"))[JU]=function(){$U.removeChild(this),wB(r)}}:ed=function(r){setTimeout(xB(r),0)});var eR={set:gB,clear:mB},rR=rs,Rdt=Zc,Odt=Object.getOwnPropertyDescriptor,Ddt=function(r){if(!Rdt)return rR[r];var t=Odt(rR,r);return t&&t.value},nR=function(){this.head=null,this.tail=null};nR.prototype={add:function(r){var t={item:r,next:null},e=this.tail;e?e.next=t:this.head=t,this.tail=t},get:function(){var r=this.head;if(r){var t=this.head=r.next;return t===null&&(this.tail=null),r.item}}};var iR=nR,kdt=E1,Ndt=/ipad|iphone|ipod/i.test(kdt)&&typeof Pebble<"u",Qdt=E1,Hdt=/web0s(?!.*chrome)/i.test(Qdt),jf=rs,zdt=Ddt,sR=pB,BB=eR.set,Gdt=iR,Vdt=qU,jdt=Ndt,qdt=Hdt,CB=nm,oR=jf.MutationObserver||jf.WebKitMutationObserver,aR=jf.document,cR=jf.process,G1=jf.Promise,EB=zdt("queueMicrotask"),qf,SB,TB,V1,lR;if(!EB){var j1=new Gdt,q1=function(){var r,t;for(CB&&(r=cR.domain)&&r.exit();t=j1.get();)try{t()}catch(e){throw j1.head&&qf(),e}r&&r.enter()};!Vdt&&!CB&&!qdt&&oR&&aR?(SB=!0,TB=aR.createTextNode(""),new oR(q1).observe(TB,{characterData:!0}),qf=function(){TB.data=SB=!SB}):!jdt&&G1&&G1.resolve?(V1=G1.resolve(void 0),V1.constructor=G1,lR=sR(V1.then,V1),qf=function(){lR(q1)}):CB?qf=function(){cR.nextTick(q1)}:(BB=sR(BB,jf),qf=function(){BB(q1)}),EB=function(r){j1.head||qf(),j1.add(r)}}var Kdt=EB,Wdt=function(r,t){try{arguments.length===1?console.error(r):console.error(r,t)}catch{}},IB=function(r){try{return{error:!1,value:r()}}catch(t){return{error:!0,value:t}}},$dt=rs,K1=$dt.Promise,uR=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",Xdt=uR,Ydt=nm,Jdt=!Xdt&&!Ydt&&typeof window=="object"&&typeof document=="object",Zdt=rs,am=K1,tft=ss,eft=TU,rft=rB,nft=Us,ift=Jdt,sft=uR,LB=Qx;am&&am.prototype;var oft=nft("species"),FB=!1,AR=tft(Zdt.PromiseRejectionEvent),aft=eft("Promise",function(){var r=rft(am),t=r!==String(am);if(!t&&LB===66)return!0;if(!LB||LB<51||!/native code/.test(r)){var e=new am(function(s){s(1)}),n=function(s){s(function(){},function(){})},i=e.constructor={};if(i[oft]=n,FB=e.then(function(){})instanceof n,!FB)return!0}return!t&&(ift||sft)&&!AR}),cm={CONSTRUCTOR:aft,REJECTION_EVENT:AR,SUBCLASSING:FB},Kf={},hR=Qu,cft=TypeError,lft=function(r){var t,e;this.promise=new r(function(n,i){if(t!==void 0||e!==void 0)throw new cft("Bad Promise constructor");t=n,e=i}),this.resolve=hR(t),this.reject=hR(e)};Kf.f=function(r){return new lft(r)};var uft=Qo,W1=nm,$A=rs,Wf=$s,dR=td,fR=IU,Aft=Q1,hft=Dht,dft=Qu,$1=ss,fft=el,pft=Qht,gft=NU,pR=eR.set,MB=Kdt,mft=Wdt,yft=IB,_ft=iR,gR=R1,X1=K1,PB=cm,mR=Kf,Y1="Promise",yR=PB.CONSTRUCTOR,vft=PB.REJECTION_EVENT,bft=PB.SUBCLASSING,UB=gR.getterFor(Y1),wft=gR.set,$f=X1&&X1.prototype,rd=X1,J1=$f,_R=$A.TypeError,RB=$A.document,OB=$A.process,DB=mR.f,xft=DB,Bft=!!(RB&&RB.createEvent&&$A.dispatchEvent),vR="unhandledrejection",Cft="rejectionhandled",bR=0,wR=1,Eft=2,kB=1,xR=2,Z1,BR,Sft,CR,ER=function(r){var t;return fft(r)&&$1(t=r.then)?t:!1},SR=function(r,t){var e=t.value,n=t.state===wR,i=n?r.ok:r.fail,s=r.resolve,a=r.reject,o=r.domain,A,f,m;try{i?(n||(t.rejection===xR&&Ift(t),t.rejection=kB),i===!0?A=e:(o&&o.enter(),A=i(e),o&&(o.exit(),m=!0)),A===r.promise?a(new _R("Promise-chain cycle")):(f=ER(A))?Wf(f,A,s,a):s(A)):a(e)}catch(b){o&&!m&&o.exit(),a(b)}},TR=function(r,t){r.notified||(r.notified=!0,MB(function(){for(var e=r.reactions,n;n=e.get();)SR(n,r);r.notified=!1,t&&!r.rejection&&Tft(r)}))},IR=function(r,t,e){var n,i;Bft?(n=RB.createEvent("Event"),n.promise=t,n.reason=e,n.initEvent(r,!1,!0),$A.dispatchEvent(n)):n={promise:t,reason:e},!vft&&(i=$A["on"+r])?i(n):r===vR&&mft("Unhandled promise rejection",e)},Tft=function(r){Wf(pR,$A,function(){var t=r.facade,e=r.value,n=LR(r),i;if(n&&(i=yft(function(){W1?OB.emit("unhandledRejection",e,t):IR(vR,t,e)}),r.rejection=W1||LR(r)?xR:kB,i.error))throw i.value})},LR=function(r){return r.rejection!==kB&&!r.parent},Ift=function(r){Wf(pR,$A,function(){var t=r.facade;W1?OB.emit("rejectionHandled",t):IR(Cft,t,r.value)})},Xf=function(r,t,e){return function(n){r(t,n,e)}},Yf=function(r,t,e){r.done||(r.done=!0,e&&(r=e),r.value=t,r.state=Eft,TR(r,!0))},NB=function(r,t,e){if(!r.done){r.done=!0,e&&(r=e);try{if(r.facade===t)throw new _R("Promise can't be resolved itself");var n=ER(t);n?MB(function(){var i={done:!1};try{Wf(n,t,Xf(NB,i,r),Xf(Yf,i,r))}catch(s){Yf(i,s,r)}}):(r.value=t,r.state=wR,TR(r,!1))}catch(i){Yf({done:!1},i,r)}}};if(yR&&(rd=function(r){pft(this,J1),dft(r),Wf(Z1,this);var t=UB(this);try{r(Xf(NB,t),Xf(Yf,t))}catch(e){Yf(t,e)}},J1=rd.prototype,Z1=function(r){wft(this,{type:Y1,done:!1,notified:!1,parent:!1,reactions:new _ft,rejection:!1,state:bR,value:void 0})},Z1.prototype=dR(J1,"then",function(r,t){var e=UB(this),n=DB(gft(this,rd));return e.parent=!0,n.ok=$1(r)?r:!0,n.fail=$1(t)&&t,n.domain=W1?OB.domain:void 0,e.state===bR?e.reactions.add(n):MB(function(){SR(n,e)}),n.promise}),BR=function(){var r=new Z1,t=UB(r);this.promise=r,this.resolve=Xf(NB,t),this.reject=Xf(Yf,t)},mR.f=DB=function(r){return r===rd||r===Sft?new BR(r):xft(r)},$1(X1)&&$f!==Object.prototype)){CR=$f.then,bft||dR($f,"then",function(r,t){var e=this;return new rd(function(n,i){Wf(CR,e,n,i)}).then(r,t)},{unsafe:!0});try{delete $f.constructor}catch{}fR&&fR($f,J1)}uft({global:!0,constructor:!0,wrap:!0,forced:yR},{Promise:rd}),Aft(rd,Y1,!1),hft(Y1);var lm={},Lft=Us,Fft=lm,Mft=Lft("iterator"),Pft=Array.prototype,Uft=function(r){return r!==void 0&&(Fft.Array===r||Pft[Mft]===r)},Rft=dB,FR=Hf,Oft=Jh,Dft=lm,kft=Us,Nft=kft("iterator"),MR=function(r){if(!Oft(r))return FR(r,Nft)||FR(r,"@@iterator")||Dft[Rft(r)]},Qft=$s,Hft=Qu,zft=No,Gft=T1,Vft=MR,jft=TypeError,qft=function(r,t){var e=arguments.length<2?Vft(r):t;if(Hft(e))return zft(Qft(e,r));throw new jft(Gft(r)+" is not iterable")},Kft=$s,PR=No,Wft=Hf,$ft=function(r,t,e){var n,i;PR(r);try{if(n=Wft(r,"return"),!n){if(t==="throw")throw e;return e}n=Kft(n,r)}catch(s){i=!0,n=s}if(t==="throw")throw e;if(i)throw n;return PR(n),e},Xft=pB,Yft=$s,Jft=No,Zft=T1,tpt=Uft,ept=uB,UR=C1,rpt=qft,npt=MR,RR=$ft,ipt=TypeError,t_=function(r,t){this.stopped=r,this.result=t},OR=t_.prototype,DR=function(r,t,e){var n=e&&e.that,i=!!(e&&e.AS_ENTRIES),s=!!(e&&e.IS_RECORD),a=!!(e&&e.IS_ITERATOR),o=!!(e&&e.INTERRUPTED),A=Xft(t,n),f,m,b,x,C,M,U,N=function(q){return f&&RR(f,"normal",q),new t_(!0,q)},Q=function(q){return i?(Jft(q),o?A(q[0],q[1],N):A(q[0],q[1])):o?A(q,N):A(q)};if(s)f=r.iterator;else if(a)f=r;else{if(m=npt(r),!m)throw new ipt(Zft(r)+" is not iterable");if(tpt(m)){for(b=0,x=ept(r);x>b;b++)if(C=Q(r[b]),C&&UR(OR,C))return C;return new t_(!1)}f=rpt(r,m)}for(M=s?r.next:f.next;!(U=Yft(M,f)).done;){try{C=Q(U.value)}catch(q){RR(f,"throw",q)}if(typeof C=="object"&&C&&UR(OR,C))return C}return new t_(!1)},spt=Us,kR=spt("iterator"),NR=!1;try{var opt=0,QR={next:function(){return{done:!!opt++}},return:function(){NR=!0}};QR[kR]=function(){return this},Array.from(QR,function(){throw 2})}catch{}var apt=function(r,t){try{if(!t&&!NR)return!1}catch{return!1}var e=!1;try{var n={};n[kR]=function(){return{next:function(){return{done:e=!0}}}},r(n)}catch{}return e},cpt=K1,lpt=apt,upt=cm.CONSTRUCTOR,HR=upt||!lpt(function(r){cpt.all(r).then(void 0,function(){})}),Apt=Qo,hpt=$s,dpt=Qu,fpt=Kf,ppt=IB,gpt=DR,mpt=HR;Apt({target:"Promise",stat:!0,forced:mpt},{all:function(r){var t=this,e=fpt.f(t),n=e.resolve,i=e.reject,s=ppt(function(){var a=dpt(t.resolve),o=[],A=0,f=1;gpt(r,function(m){var b=A++,x=!1;f++,hpt(a,t,m).then(function(C){x||(x=!0,o[b]=C,--f||n(o))},i)}),--f||n(o)});return s.error&&i(s.value),e.promise}});var ypt=Qo,_pt=cm.CONSTRUCTOR,QB=K1,vpt=Zh,bpt=ss,wpt=td,zR=QB&&QB.prototype;if(ypt({target:"Promise",proto:!0,forced:_pt,real:!0},{catch:function(r){return this.then(void 0,r)}}),bpt(QB)){var GR=vpt("Promise").prototype.catch;zR.catch!==GR&&wpt(zR,"catch",GR,{unsafe:!0})}var xpt=Qo,Bpt=$s,Cpt=Qu,Ept=Kf,Spt=IB,Tpt=DR,Ipt=HR;xpt({target:"Promise",stat:!0,forced:Ipt},{race:function(r){var t=this,e=Ept.f(t),n=e.reject,i=Spt(function(){var s=Cpt(t.resolve);Tpt(r,function(a){Bpt(s,t,a).then(e.resolve,n)})});return i.error&&n(i.value),e.promise}});var Lpt=Qo,Fpt=Kf,Mpt=cm.CONSTRUCTOR;Lpt({target:"Promise",stat:!0,forced:Mpt},{reject:function(r){var t=Fpt.f(this),e=t.reject;return e(r),t.promise}});var Ppt=No,Upt=el,Rpt=Kf,Opt=function(r,t){if(Ppt(r),Upt(t)&&t.constructor===r)return t;var e=Rpt.f(r),n=e.resolve;return n(t),e.promise},Dpt=Qo,kpt=Zh,Npt=cm.CONSTRUCTOR,Qpt=Opt;kpt("Promise"),Dpt({target:"Promise",stat:!0,forced:Npt},{resolve:function(r){return Qpt(this,r)}});function VR(r,t,e,n,i,s,a){try{var o=r[s](a),A=o.value}catch(f){e(f);return}o.done?t(A):Promise.resolve(A).then(n,i)}function zu(r){return function(){var t=this,e=arguments;return new Promise(function(n,i){var s=r.apply(t,e);function a(A){VR(s,n,i,a,o,"next",A)}function o(A){VR(s,n,i,a,o,"throw",A)}a(void 0)})}}var Hpt=dB,zpt=String,Zl=function(r){if(Hpt(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return zpt(r)},Gpt=No,jR=function(){var r=Gpt(this),t="";return r.hasIndices&&(t+="d"),r.global&&(t+="g"),r.ignoreCase&&(t+="i"),r.multiline&&(t+="m"),r.dotAll&&(t+="s"),r.unicode&&(t+="u"),r.unicodeSets&&(t+="v"),r.sticky&&(t+="y"),t},HB=ns,Vpt=rs,zB=Vpt.RegExp,GB=HB(function(){var r=zB("a","y");return r.lastIndex=2,r.exec("abcd")!==null}),jpt=GB||HB(function(){return!zB("a","y").sticky}),qpt=GB||HB(function(){var r=zB("^r","gy");return r.lastIndex=2,r.exec("str")!==null}),qR={BROKEN_CARET:qpt,MISSED_STICKY:jpt,UNSUPPORTED_Y:GB},KR={},Kpt=CU,Wpt=hB,$pt=Object.keys||function(r){return Kpt(r,Wpt)},Xpt=Zc,Ypt=uU,Jpt=Hu,Zpt=No,tgt=Zg,egt=$pt;KR.f=Xpt&&!Ypt?Object.defineProperties:function(r,t){Zpt(r);for(var e=tgt(t),n=egt(t),i=n.length,s=0,a;i>s;)Jpt.f(r,a=n[s++],e[a]);return r};var rgt=No,ngt=KR,WR=hB,igt=iB,sgt=jU,ogt=L1,agt=nB,$R=">",XR="<",VB="prototype",jB="script",YR=agt("IE_PROTO"),qB=function(){},JR=function(r){return XR+jB+$R+r+XR+"/"+jB+$R},ZR=function(r){r.write(JR("")),r.close();var t=r.parentWindow.Object;return r=null,t},cgt=function(){var r=ogt("iframe"),t="java"+jB+":",e;return r.style.display="none",sgt.appendChild(r),r.src=String(t),e=r.contentWindow.document,e.open(),e.write(JR("document.F=Object")),e.close(),e.F},e_,r_=function(){try{e_=new ActiveXObject("htmlfile")}catch{}r_=typeof document<"u"?document.domain&&e_?ZR(e_):cgt():ZR(e_);for(var r=WR.length;r--;)delete r_[VB][WR[r]];return r_()};igt[YR]=!0;var KB=Object.create||function(r,t){var e;return r!==null?(qB[VB]=rgt(r),e=new qB,qB[VB]=null,e[YR]=r):e=r_(),t===void 0?e:ngt.f(e,t)},lgt=ns,ugt=rs,Agt=ugt.RegExp,hgt=lgt(function(){var r=Agt(".","s");return!(r.dotAll&&r.test(`
`)&&r.flags==="s")}),dgt=ns,fgt=rs,pgt=fgt.RegExp,ggt=dgt(function(){var r=pgt("(?<a>b)","g");return r.exec("b").groups.a!=="b"||"b".replace(r,"$<a>c")!=="bc"}),Jf=$s,n_=is,mgt=Zl,ygt=jR,_gt=qR,vgt=qx,bgt=KB,wgt=R1.get,xgt=hgt,Bgt=ggt,Cgt=vgt("native-string-replace",String.prototype.replace),i_=RegExp.prototype.exec,WB=i_,Egt=n_("".charAt),Sgt=n_("".indexOf),Tgt=n_("".replace),$B=n_("".slice),XB=function(){var r=/a/,t=/b*/g;return Jf(i_,r,"a"),Jf(i_,t,"a"),r.lastIndex!==0||t.lastIndex!==0}(),tO=_gt.BROKEN_CARET,YB=/()??/.exec("")[1]!==void 0,Igt=XB||YB||tO||xgt||Bgt;Igt&&(WB=function(r){var t=this,e=wgt(t),n=mgt(r),i=e.raw,s,a,o,A,f,m,b;if(i)return i.lastIndex=t.lastIndex,s=Jf(WB,i,n),t.lastIndex=i.lastIndex,s;var x=e.groups,C=tO&&t.sticky,M=Jf(ygt,t),U=t.source,N=0,Q=n;if(C&&(M=Tgt(M,"y",""),Sgt(M,"g")===-1&&(M+="g"),Q=$B(n,t.lastIndex),t.lastIndex>0&&(!t.multiline||t.multiline&&Egt(n,t.lastIndex-1)!==`
`)&&(U="(?: "+U+")",Q=" "+Q,N++),a=new RegExp("^(?:"+U+")",M)),YB&&(a=new RegExp("^"+U+"$(?!\\s)",M)),XB&&(o=t.lastIndex),A=Jf(i_,C?a:t,Q),C?A?(A.input=$B(A.input,N),A[0]=$B(A[0],N),A.index=t.lastIndex,t.lastIndex+=A[0].length):t.lastIndex=0:XB&&A&&(t.lastIndex=t.global?A.index+A[0].length:o),YB&&A&&A.length>1&&Jf(Cgt,A[0],a,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(A[f]=void 0)}),A&&x)for(A.groups=m=bgt(null),f=0;f<x.length;f++)b=x[f],m[b[0]]=A[b[1]];return A});var JB=WB,Lgt=Qo,eO=JB;Lgt({target:"RegExp",proto:!0,forced:/./.exec!==eO},{exec:eO});var rO=$s,nO=td,Fgt=JB,iO=ns,sO=Us,Mgt=tm,Pgt=sO("species"),ZB=RegExp.prototype,tC=function(r,t,e,n){var i=sO(r),s=!iO(function(){var f={};return f[i]=function(){return 7},""[r](f)!==7}),a=s&&!iO(function(){var f=!1,m=/a/;return r==="split"&&(m={},m.constructor={},m.constructor[Pgt]=function(){return m},m.flags="",m[i]=/./[i]),m.exec=function(){return f=!0,null},m[i](""),!f});if(!s||!a||e){var o=/./[i],A=t(i,""[r],function(f,m,b,x,C){var M=m.exec;return M===Fgt||M===ZB.exec?s&&!C?{done:!0,value:rO(o,m,b,x)}:{done:!0,value:rO(f,b,m,x)}:{done:!1}});nO(String.prototype,r,A[0]),nO(ZB,i,A[1])}n&&Mgt(ZB[i],"sham",!0)},eC=is,Ugt=k1,Rgt=Zl,Ogt=tl,Dgt=eC("".charAt),oO=eC("".charCodeAt),kgt=eC("".slice),aO=function(r){return function(t,e){var n=Rgt(Ogt(t)),i=Ugt(e),s=n.length,a,o;return i<0||i>=s?r?"":void 0:(a=oO(n,i),a<55296||a>56319||i+1===s||(o=oO(n,i+1))<56320||o>57343?r?Dgt(n,i):a:r?kgt(n,i,i+2):(a-55296<<10)+(o-56320)+65536)}},Ngt={codeAt:aO(!1),charAt:aO(!0)},Qgt=Ngt.charAt,rC=function(r,t,e){return t+(e?Qgt(r,t).length:1)},cO=$s,Hgt=No,zgt=ss,Ggt=Yh,Vgt=JB,jgt=TypeError,nC=function(r,t){var e=r.exec;if(zgt(e)){var n=cO(e,r,t);return n!==null&&Hgt(n),n}if(Ggt(r)==="RegExp")return cO(Vgt,r,t);throw new jgt("RegExp#exec called on incompatible receiver")},qgt=$s,Kgt=tC,Wgt=No,$gt=Jh,Xgt=Vf,iC=Zl,Ygt=tl,Jgt=Hf,Zgt=rC,lO=nC;Kgt("match",function(r,t,e){return[function(n){var i=Ygt(this),s=$gt(n)?void 0:Jgt(n,r);return s?qgt(s,n,i):new RegExp(n)[r](iC(i))},function(n){var i=Wgt(this),s=iC(n),a=e(t,i,s);if(a.done)return a.value;if(!i.global)return lO(i,s);var o=i.unicode;i.lastIndex=0;for(var A=[],f=0,m;(m=lO(i,s))!==null;){var b=iC(m[0]);A[f]=b,b===""&&(i.lastIndex=Zgt(s,Xgt(i.lastIndex),o)),f++}return f===0?null:A}]});var sC=is,tmt=I1,emt=Math.floor,oC=sC("".charAt),rmt=sC("".replace),aC=sC("".slice),nmt=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,imt=/\$([$&'`]|\d{1,2})/g,smt=function(r,t,e,n,i,s){var a=e+r.length,o=n.length,A=imt;return i!==void 0&&(i=tmt(i),A=nmt),rmt(s,A,function(f,m){var b;switch(oC(m,0)){case"$":return"$";case"&":return r;case"`":return aC(t,0,e);case"'":return aC(t,a);case"<":b=i[aC(m,1,-1)];break;default:var x=+m;if(x===0)return f;if(x>o){var C=emt(x/10);return C===0?f:C<=o?n[C-1]===void 0?oC(m,1):n[C-1]+oC(m,1):f}b=n[x-1]}return b===void 0?"":b})},omt=GU,uO=$s,s_=is,amt=tC,cmt=ns,lmt=No,umt=ss,Amt=Jh,hmt=k1,dmt=Vf,Zf=Zl,fmt=tl,pmt=rC,gmt=Hf,mmt=smt,ymt=nC,_mt=Us,cC=_mt("replace"),vmt=Math.max,bmt=Math.min,wmt=s_([].concat),lC=s_([].push),AO=s_("".indexOf),hO=s_("".slice),xmt=function(r){return r===void 0?r:String(r)},Bmt=function(){return"a".replace(/./,"$0")==="$0"}(),dO=function(){return/./[cC]?/./[cC]("a","$0")==="":!1}(),Cmt=!cmt(function(){var r=/./;return r.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(r,"$<a>")!=="7"});amt("replace",function(r,t,e){var n=dO?"$":"$0";return[function(i,s){var a=fmt(this),o=Amt(i)?void 0:gmt(i,cC);return o?uO(o,i,a,s):uO(t,Zf(a),i,s)},function(i,s){var a=lmt(this),o=Zf(i);if(typeof s=="string"&&AO(s,n)===-1&&AO(s,"$<")===-1){var A=e(t,a,o,s);if(A.done)return A.value}var f=umt(s);f||(s=Zf(s));var m=a.global,b;m&&(b=a.unicode,a.lastIndex=0);for(var x=[],C;C=ymt(a,o),!(C===null||(lC(x,C),!m));){var M=Zf(C[0]);M===""&&(a.lastIndex=pmt(o,dmt(a.lastIndex),b))}for(var U="",N=0,Q=0;Q<x.length;Q++){C=x[Q];for(var q=Zf(C[0]),Y=vmt(bmt(hmt(C.index),o.length),0),tt=[],ft,pt=1;pt<C.length;pt++)lC(tt,xmt(C[pt]));var mt=C.groups;if(f){var dt=wmt([q],tt,Y,o);mt!==void 0&&lC(dt,mt),ft=Zf(omt(s,void 0,dt))}else ft=mmt(q,o,Y,tt,mt,s);Y>=N&&(U+=hO(o,N,Y)+ft,N=Y+q.length)}return U+hO(o,N)}]},!Cmt||!Bmt||dO);var Emt=el,Smt=Yh,Tmt=Us,Imt=Tmt("match"),Lmt=function(r){var t;return Emt(r)&&((t=r[Imt])!==void 0?!!t:Smt(r)==="RegExp")},Fmt=Lmt,Mmt=TypeError,uC=function(r){if(Fmt(r))throw new Mmt("The method doesn't accept regular expressions");return r},Pmt=Us,Umt=Pmt("match"),AC=function(r){var t=/./;try{"/./"[r](t)}catch{try{return t[Umt]=!1,"/./"[r](t)}catch{}}return!1},Rmt=Qo,Omt=z1,Dmt=Jg.f,kmt=Vf,fO=Zl,Nmt=uC,Qmt=tl,Hmt=AC,zmt=Omt("".slice),Gmt=Math.min,pO=Hmt("startsWith"),Vmt=!pO&&!!function(){var r=Dmt(String.prototype,"startsWith");return r&&!r.writable}();Rmt({target:"String",proto:!0,forced:!Vmt&&!pO},{startsWith:function(r){var t=fO(Qmt(this));Nmt(r);var e=kmt(Gmt(arguments.length>1?arguments[1]:void 0,t.length)),n=fO(r);return zmt(t,e,e+n.length)===n}});var jmt=Us,qmt=KB,Kmt=Hu.f,hC=jmt("unscopables"),dC=Array.prototype;dC[hC]===void 0&&Kmt(dC,hC,{configurable:!0,value:qmt(null)});var Wmt=function(r){dC[hC][r]=!0},$mt=ns,Xmt=!$mt(function(){function r(){}return r.prototype.constructor=null,Object.getPrototypeOf(new r)!==r.prototype}),Ymt=nl,Jmt=ss,Zmt=I1,t0t=nB,e0t=Xmt,gO=t0t("IE_PROTO"),fC=Object,r0t=fC.prototype,mO=e0t?fC.getPrototypeOf:function(r){var t=Zmt(r);if(Ymt(t,gO))return t[gO];var e=t.constructor;return Jmt(e)&&t instanceof e?e.prototype:t instanceof fC?r0t:null},n0t=ns,i0t=ss,s0t=el,yO=mO,o0t=td,a0t=Us,pC=a0t("iterator"),_O=!1,nd,gC,mC;[].keys&&(mC=[].keys(),"next"in mC?(gC=yO(yO(mC)),gC!==Object.prototype&&(nd=gC)):_O=!0);var c0t=!s0t(nd)||n0t(function(){var r={};return nd[pC].call(r)!==r});c0t&&(nd={}),i0t(nd[pC])||o0t(nd,pC,function(){return this});var vO={IteratorPrototype:nd,BUGGY_SAFARI_ITERATORS:_O},l0t=vO.IteratorPrototype,u0t=KB,A0t=Ux,h0t=Q1,d0t=lm,f0t=function(){return this},p0t=function(r,t,e,n){var i=t+" Iterator";return r.prototype=u0t(l0t,{next:A0t(+!n,e)}),h0t(r,i,!1),d0t[i]=f0t,r},g0t=Qo,m0t=$s,bO=M1,y0t=ss,_0t=p0t,wO=mO,xO=IU,v0t=Q1,b0t=tm,yC=td,w0t=Us,x0t=lm,BO=vO,B0t=bO.PROPER,C0t=bO.CONFIGURABLE,CO=BO.IteratorPrototype,o_=BO.BUGGY_SAFARI_ITERATORS,um=w0t("iterator"),EO="keys",Am="values",SO="entries",E0t=function(){return this},S0t=function(r,t,e,n,i,s,a){_0t(e,t,n);var o=function(Q){if(Q===i&&x)return x;if(!o_&&Q&&Q in m)return m[Q];switch(Q){case EO:return function(){return new e(this,Q)};case Am:return function(){return new e(this,Q)};case SO:return function(){return new e(this,Q)}}return function(){return new e(this)}},A=t+" Iterator",f=!1,m=r.prototype,b=m[um]||m["@@iterator"]||i&&m[i],x=!o_&&b||o(i),C=t==="Array"&&m.entries||b,M,U,N;if(C&&(M=wO(C.call(new r)),M!==Object.prototype&&M.next&&(wO(M)!==CO&&(xO?xO(M,CO):y0t(M[um])||yC(M,um,E0t)),v0t(M,A,!0))),B0t&&i===Am&&b&&b.name!==Am&&(C0t?b0t(m,"name",Am):(f=!0,x=function(){return m0t(b,this)})),i)if(U={values:o(Am),keys:s?x:o(EO),entries:o(SO)},a)for(N in U)(o_||f||!(N in m))&&yC(m,N,U[N]);else g0t({target:t,proto:!0,forced:o_||f},U);return m[um]!==x&&yC(m,um,x,{name:i}),x0t[t]=x,U},T0t=function(r,t){return{value:r,done:t}},I0t=Zg,_C=Wmt,TO=lm,IO=R1,L0t=Hu.f,F0t=S0t,a_=T0t,M0t=Zc,LO="Array Iterator",P0t=IO.set,U0t=IO.getterFor(LO),R0t=F0t(Array,"Array",function(r,t){P0t(this,{type:LO,target:I0t(r),index:0,kind:t})},function(){var r=U0t(this),t=r.target,e=r.index++;if(!t||e>=t.length)return r.target=void 0,a_(void 0,!0);switch(r.kind){case"keys":return a_(e,!1);case"values":return a_(t[e],!1)}return a_([e,t[e]],!1)},"values"),FO=TO.Arguments=TO.Array;if(_C("keys"),_C("values"),_C("entries"),M0t&&FO.name!=="values")try{L0t(FO,"name",{value:"values"})}catch{}var O0t={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},D0t=L1,vC=D0t("span").classList,MO=vC&&vC.constructor&&vC.constructor.prototype,k0t=MO===Object.prototype?void 0:MO,PO=rs,UO=O0t,N0t=k0t,hm=R0t,RO=tm,Q0t=Q1,H0t=Us,bC=H0t("iterator"),wC=hm.values,OO=function(r,t){if(r){if(r[bC]!==wC)try{RO(r,bC,wC)}catch{r[bC]=wC}if(Q0t(r,t,!0),UO[t]){for(var e in hm)if(r[e]!==hm[e])try{RO(r,e,hm[e])}catch{r[e]=hm[e]}}}};for(var xC in UO)OO(PO[xC]&&PO[xC].prototype,xC);OO(N0t,"DOMTokenList");function z0t(r,t){if(On(r)!="object"||!r)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var n=e.call(r,t||"default");if(On(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function G0t(r){var t=z0t(r,"string");return On(t)=="symbol"?t:t+""}function BC(r,t,e){return t=G0t(t),t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}var V0t=Qu,j0t=I1,q0t=HP,K0t=uB,DO=TypeError,kO="Reduce of empty array with no initial value",NO=function(r){return function(t,e,n,i){var s=j0t(t),a=q0t(s),o=K0t(s);if(V0t(e),o===0&&n<2)throw new DO(kO);var A=r?o-1:0,f=r?-1:1;if(n<2)for(;;){if(A in a){i=a[A],A+=f;break}if(A+=f,r?A<0:o<=A)throw new DO(kO)}for(;r?A>=0:o>A;A+=f)A in a&&(i=e(i,a[A],A,s));return i}},W0t={left:NO(!1),right:NO(!0)},$0t=ns,QO=function(r,t){var e=[][r];return!!e&&$0t(function(){e.call(null,t||function(){return 1},1)})},X0t=Qo,Y0t=W0t.left,J0t=QO,HO=Qx,Z0t=nm,tyt=!Z0t&&HO>79&&HO<83,eyt=tyt||!J0t("reduce");X0t({target:"Array",proto:!0,forced:eyt},{reduce:function(r){var t=arguments.length;return Y0t(this,r,t,t>1?arguments[1]:void 0)}});var ryt=Qo,nyt=z1,iyt=Jg.f,syt=Vf,zO=Zl,oyt=uC,ayt=tl,cyt=AC,lyt=nyt("".slice),uyt=Math.min,GO=cyt("endsWith"),Ayt=!GO&&!!function(){var r=iyt(String.prototype,"endsWith");return r&&!r.writable}();ryt({target:"String",proto:!0,forced:!Ayt&&!GO},{endsWith:function(r){var t=zO(ayt(this));oyt(r);var e=arguments.length>1?arguments[1]:void 0,n=t.length,i=e===void 0?n:uyt(syt(e),n),s=zO(r);return lyt(t,i-s.length,i)===s}});var CC=$s,VO=is,hyt=tC,dyt=No,fyt=Jh,pyt=tl,gyt=NU,myt=rC,yyt=Vf,jO=Zl,_yt=Hf,qO=nC,vyt=qR,byt=ns,tp=vyt.UNSUPPORTED_Y,wyt=4294967295,xyt=Math.min,EC=VO([].push),SC=VO("".slice),Byt=!byt(function(){var r=/(?:)/,t=r.exec;r.exec=function(){return t.apply(this,arguments)};var e="ab".split(r);return e.length!==2||e[0]!=="a"||e[1]!=="b"}),KO="abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length;hyt("split",function(r,t,e){var n="0".split(void 0,0).length?function(i,s){return i===void 0&&s===0?[]:CC(t,this,i,s)}:t;return[function(i,s){var a=pyt(this),o=fyt(i)?void 0:_yt(i,r);return o?CC(o,i,a,s):CC(n,jO(a),i,s)},function(i,s){var a=dyt(this),o=jO(i);if(!KO){var A=e(n,a,o,s,n!==t);if(A.done)return A.value}var f=gyt(a,RegExp),m=a.unicode,b=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(tp?"g":"y"),x=new f(tp?"^(?:"+a.source+")":a,b),C=s===void 0?wyt:s>>>0;if(C===0)return[];if(o.length===0)return qO(x,o)===null?[o]:[];for(var M=0,U=0,N=[];U<o.length;){x.lastIndex=tp?0:U;var Q=qO(x,tp?SC(o,U):o),q;if(Q===null||(q=xyt(yyt(x.lastIndex+(tp?U:0)),o.length))===M)U=myt(o,U,m);else{if(EC(N,SC(o,M,U)),N.length===C)return N;for(var Y=1;Y<=Q.length-1;Y++)if(EC(N,Q[Y]),N.length===C)return N;U=M=q}}return EC(N,SC(o,M)),N}]},KO||!Byt,tp);var c_={exports:{}},dm={exports:{}};(function(){var r,t,e,n,i,s;typeof performance<"u"&&performance!==null&&performance.now?dm.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(dm.exports=function(){return(r()-i)/1e6},t=process.hrtime,r=function(){var a;return a=t(),a[0]*1e9+a[1]},n=r(),s=process.uptime()*1e9,i=n-s):Date.now?(dm.exports=function(){return Date.now()-e},e=Date.now()):(dm.exports=function(){return new Date().getTime()-e},e=new Date().getTime())}).call(Qf);for(var Cyt=dm.exports,Eyt=Cyt,Gu=typeof window>"u"?Qf:window,l_=["moz","webkit"],ep="AnimationFrame",rp=Gu["request"+ep],fm=Gu["cancel"+ep]||Gu["cancelRequest"+ep],pm=0;!rp&&pm<l_.length;pm++)rp=Gu[l_[pm]+"Request"+ep],fm=Gu[l_[pm]+"Cancel"+ep]||Gu[l_[pm]+"CancelRequest"+ep];if(!rp||!fm){var TC=0,WO=0,id=[],Syt=1e3/60;rp=function(r){if(id.length===0){var t=Eyt(),e=Math.max(0,Syt-(t-TC));TC=e+t,setTimeout(function(){var n=id.slice(0);id.length=0;for(var i=0;i<n.length;i++)if(!n[i].cancelled)try{n[i].callback(TC)}catch(s){setTimeout(function(){throw s},0)}},Math.round(e))}return id.push({handle:++WO,callback:r,cancelled:!1}),WO},fm=function(r){for(var t=0;t<id.length;t++)id[t].handle===r&&(id[t].cancelled=!0)}}c_.exports=function(r){return rp.call(Gu,r)},c_.exports.cancel=function(){fm.apply(Gu,arguments)},c_.exports.polyfill=function(r){r||(r=Gu),r.requestAnimationFrame=rp,r.cancelAnimationFrame=fm};var Tyt=c_.exports;const IC=UP(Tyt);var $O=`	
\v\f\r \u2028\u2029\uFEFF`,Iyt=is,Lyt=tl,Fyt=Zl,LC=$O,XO=Iyt("".replace),Myt=RegExp("^["+LC+"]+"),Pyt=RegExp("(^|[^"+LC+"])["+LC+"]+$"),FC=function(r){return function(t){var e=Fyt(Lyt(t));return r&1&&(e=XO(e,Myt,"")),r&2&&(e=XO(e,Pyt,"$1")),e}},Uyt={start:FC(1),end:FC(2),trim:FC(3)},Ryt=M1.PROPER,Oyt=ns,YO=$O,JO="",Dyt=function(r){return Oyt(function(){return!!YO[r]()||JO[r]()!==JO||Ryt&&YO[r].name!==r})},kyt=Qo,Nyt=Uyt.trim,Qyt=Dyt;kyt({target:"String",proto:!0,forced:Qyt("trim")},{trim:function(){return Nyt(this)}});var Hyt=function(r){this.ok=!1,this.alpha=1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r=r.replace(/ /g,""),r=r.toLowerCase();var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};r=t[r]||r;for(var e=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(A){return[parseInt(A[1]),parseInt(A[2]),parseInt(A[3]),parseFloat(A[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(A){return[parseInt(A[1]),parseInt(A[2]),parseInt(A[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(A){return[parseInt(A[1],16),parseInt(A[2],16),parseInt(A[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(A){return[parseInt(A[1]+A[1],16),parseInt(A[2]+A[2],16),parseInt(A[3]+A[3],16)]}}],n=0;n<e.length;n++){var i=e[n].re,s=e[n].process,a=i.exec(r);if(a){var o=s(a);this.r=o[0],this.g=o[1],this.b=o[2],o.length>3&&(this.alpha=o[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var A=this.r.toString(16),f=this.g.toString(16),m=this.b.toString(16);return A.length==1&&(A="0"+A),f.length==1&&(f="0"+f),m.length==1&&(m="0"+m),"#"+A+f+m},this.getHelpXML=function(){for(var A=new Array,f=0;f<e.length;f++)for(var m=e[f].example,b=0;b<m.length;b++)A[A.length]=m[b];for(var x in t)A[A.length]=x;var C=document.createElement("ul");C.setAttribute("id","rgbcolor-examples");for(var f=0;f<A.length;f++)try{var M=document.createElement("li"),U=new RGBColor(A[f]),N=document.createElement("div");N.style.cssText="margin: 3px; border: 1px solid black; background:"+U.toHex()+"; color:"+U.toHex(),N.appendChild(document.createTextNode("test"));var Q=document.createTextNode(" "+A[f]+" -> "+U.toRGB()+" -> "+U.toHex());M.appendChild(N),M.appendChild(Q),C.appendChild(M)}catch{}return C}};const MC=UP(Hyt);var zyt=Qo,Gyt=z1,Vyt=xU.indexOf,jyt=QO,PC=Gyt([].indexOf),ZO=!!PC&&1/PC([1],1,-0)<0,qyt=ZO||!jyt("indexOf");zyt({target:"Array",proto:!0,forced:qyt},{indexOf:function(r){var t=arguments.length>1?arguments[1]:void 0;return ZO?PC(this,r,t)||0:Vyt(this,r,t)}});var Kyt=Qo,Wyt=is,$yt=uC,Xyt=tl,tD=Zl,Yyt=AC,Jyt=Wyt("".indexOf);Kyt({target:"String",proto:!0,forced:!Yyt("includes")},{includes:function(r){return!!~Jyt(tD(Xyt(this)),tD($yt(r)),arguments.length>1?arguments[1]:void 0)}});var Zyt=Yh,t1t=Array.isArray||function(r){return Zyt(r)==="Array"},e1t=Qo,r1t=is,n1t=t1t,i1t=r1t([].reverse),eD=[1,2];e1t({target:"Array",proto:!0,forced:String(eD)===String(eD.reverse())},{reverse:function(){return n1t(this)&&(this.length=this.length),i1t(this)}});/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var rD=function(r,t){return(rD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])})(r,t)};function nD(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=r}rD(r,t),r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function s1t(r){var t="";Array.isArray(r)||(r=[r]);for(var e=0;e<r.length;e++){var n=r[e];if(n.type===Pe.CLOSE_PATH)t+="z";else if(n.type===Pe.HORIZ_LINE_TO)t+=(n.relative?"h":"H")+n.x;else if(n.type===Pe.VERT_LINE_TO)t+=(n.relative?"v":"V")+n.y;else if(n.type===Pe.MOVE_TO)t+=(n.relative?"m":"M")+n.x+" "+n.y;else if(n.type===Pe.LINE_TO)t+=(n.relative?"l":"L")+n.x+" "+n.y;else if(n.type===Pe.CURVE_TO)t+=(n.relative?"c":"C")+n.x1+" "+n.y1+" "+n.x2+" "+n.y2+" "+n.x+" "+n.y;else if(n.type===Pe.SMOOTH_CURVE_TO)t+=(n.relative?"s":"S")+n.x2+" "+n.y2+" "+n.x+" "+n.y;else if(n.type===Pe.QUAD_TO)t+=(n.relative?"q":"Q")+n.x1+" "+n.y1+" "+n.x+" "+n.y;else if(n.type===Pe.SMOOTH_QUAD_TO)t+=(n.relative?"t":"T")+n.x+" "+n.y;else{if(n.type!==Pe.ARC)throw new Error('Unexpected command type "'+n.type+'" at index '+e+".");t+=(n.relative?"a":"A")+n.rX+" "+n.rY+" "+n.xRot+" "+ +n.lArcFlag+" "+ +n.sweepFlag+" "+n.x+" "+n.y}}return t}function UC(r,t){var e=r[0],n=r[1];return[e*Math.cos(t)-n*Math.sin(t),e*Math.sin(t)+n*Math.cos(t)]}function il(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];for(var e=0;e<r.length;e++)if(typeof r[e]!="number")throw new Error("assertNumbers arguments["+e+"] is not a number. "+typeof r[e]+" == typeof "+r[e]);return!0}var XA=Math.PI;function RC(r,t,e){r.lArcFlag=r.lArcFlag===0?0:1,r.sweepFlag=r.sweepFlag===0?0:1;var n=r.rX,i=r.rY,s=r.x,a=r.y;n=Math.abs(r.rX),i=Math.abs(r.rY);var o=UC([(t-s)/2,(e-a)/2],-r.xRot/180*XA),A=o[0],f=o[1],m=Math.pow(A,2)/Math.pow(n,2)+Math.pow(f,2)/Math.pow(i,2);1<m&&(n*=Math.sqrt(m),i*=Math.sqrt(m)),r.rX=n,r.rY=i;var b=Math.pow(n,2)*Math.pow(f,2)+Math.pow(i,2)*Math.pow(A,2),x=(r.lArcFlag!==r.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(n,2)*Math.pow(i,2)-b)/b)),C=n*f/i*x,M=-i*A/n*x,U=UC([C,M],r.xRot/180*XA);r.cX=U[0]+(t+s)/2,r.cY=U[1]+(e+a)/2,r.phi1=Math.atan2((f-M)/i,(A-C)/n),r.phi2=Math.atan2((-f-M)/i,(-A-C)/n),r.sweepFlag===0&&r.phi2>r.phi1&&(r.phi2-=2*XA),r.sweepFlag===1&&r.phi2<r.phi1&&(r.phi2+=2*XA),r.phi1*=180/XA,r.phi2*=180/XA}function iD(r,t,e){il(r,t,e);var n=r*r+t*t-e*e;if(0>n)return[];if(n===0)return[[r*e/(r*r+t*t),t*e/(r*r+t*t)]];var i=Math.sqrt(n);return[[(r*e+t*i)/(r*r+t*t),(t*e-r*i)/(r*r+t*t)],[(r*e-t*i)/(r*r+t*t),(t*e+r*i)/(r*r+t*t)]]}var ms,Vu=Math.PI/180;function sD(r,t,e){return(1-e)*r+e*t}function oD(r,t,e,n){return r+Math.cos(n/180*XA)*t+Math.sin(n/180*XA)*e}function aD(r,t,e,n){var i=1e-6,s=t-r,a=e-t,o=3*s+3*(n-e)-6*a,A=6*(a-s),f=3*s;return Math.abs(o)<i?[-f/A]:function(m,b,x){x===void 0&&(x=1e-6);var C=m*m/4-b;if(C<-x)return[];if(C<=x)return[-m/2];var M=Math.sqrt(C);return[-m/2-M,-m/2+M]}(A/o,f/o,i)}function cD(r,t,e,n,i){var s=1-i;return r*(s*s*s)+t*(3*s*s*i)+e*(3*s*i*i)+n*(i*i*i)}(function(r){function t(){return i(function(o,A,f){return o.relative&&(o.x1!==void 0&&(o.x1+=A),o.y1!==void 0&&(o.y1+=f),o.x2!==void 0&&(o.x2+=A),o.y2!==void 0&&(o.y2+=f),o.x!==void 0&&(o.x+=A),o.y!==void 0&&(o.y+=f),o.relative=!1),o})}function e(){var o=NaN,A=NaN,f=NaN,m=NaN;return i(function(b,x,C){return b.type&Pe.SMOOTH_CURVE_TO&&(b.type=Pe.CURVE_TO,o=isNaN(o)?x:o,A=isNaN(A)?C:A,b.x1=b.relative?x-o:2*x-o,b.y1=b.relative?C-A:2*C-A),b.type&Pe.CURVE_TO?(o=b.relative?x+b.x2:b.x2,A=b.relative?C+b.y2:b.y2):(o=NaN,A=NaN),b.type&Pe.SMOOTH_QUAD_TO&&(b.type=Pe.QUAD_TO,f=isNaN(f)?x:f,m=isNaN(m)?C:m,b.x1=b.relative?x-f:2*x-f,b.y1=b.relative?C-m:2*C-m),b.type&Pe.QUAD_TO?(f=b.relative?x+b.x1:b.x1,m=b.relative?C+b.y1:b.y1):(f=NaN,m=NaN),b})}function n(){var o=NaN,A=NaN;return i(function(f,m,b){if(f.type&Pe.SMOOTH_QUAD_TO&&(f.type=Pe.QUAD_TO,o=isNaN(o)?m:o,A=isNaN(A)?b:A,f.x1=f.relative?m-o:2*m-o,f.y1=f.relative?b-A:2*b-A),f.type&Pe.QUAD_TO){o=f.relative?m+f.x1:f.x1,A=f.relative?b+f.y1:f.y1;var x=f.x1,C=f.y1;f.type=Pe.CURVE_TO,f.x1=((f.relative?0:m)+2*x)/3,f.y1=((f.relative?0:b)+2*C)/3,f.x2=(f.x+2*x)/3,f.y2=(f.y+2*C)/3}else o=NaN,A=NaN;return f})}function i(o){var A=0,f=0,m=NaN,b=NaN;return function(x){if(isNaN(m)&&!(x.type&Pe.MOVE_TO))throw new Error("path must start with moveto");var C=o(x,A,f,m,b);return x.type&Pe.CLOSE_PATH&&(A=m,f=b),x.x!==void 0&&(A=x.relative?A+x.x:x.x),x.y!==void 0&&(f=x.relative?f+x.y:x.y),x.type&Pe.MOVE_TO&&(m=A,b=f),C}}function s(o,A,f,m,b,x){return il(o,A,f,m,b,x),i(function(C,M,U,N){var Q=C.x1,q=C.x2,Y=C.relative&&!isNaN(N),tt=C.x!==void 0?C.x:Y?0:M,ft=C.y!==void 0?C.y:Y?0:U;function pt(it){return it*it}C.type&Pe.HORIZ_LINE_TO&&A!==0&&(C.type=Pe.LINE_TO,C.y=C.relative?0:U),C.type&Pe.VERT_LINE_TO&&f!==0&&(C.type=Pe.LINE_TO,C.x=C.relative?0:M),C.x!==void 0&&(C.x=C.x*o+ft*f+(Y?0:b)),C.y!==void 0&&(C.y=tt*A+C.y*m+(Y?0:x)),C.x1!==void 0&&(C.x1=C.x1*o+C.y1*f+(Y?0:b)),C.y1!==void 0&&(C.y1=Q*A+C.y1*m+(Y?0:x)),C.x2!==void 0&&(C.x2=C.x2*o+C.y2*f+(Y?0:b)),C.y2!==void 0&&(C.y2=q*A+C.y2*m+(Y?0:x));var mt=o*m-A*f;if(C.xRot!==void 0&&(o!==1||A!==0||f!==0||m!==1))if(mt===0)delete C.rX,delete C.rY,delete C.xRot,delete C.lArcFlag,delete C.sweepFlag,C.type=Pe.LINE_TO;else{var dt=C.xRot*Math.PI/180,Rt=Math.sin(dt),Lt=Math.cos(dt),st=1/pt(C.rX),ct=1/pt(C.rY),wt=pt(Lt)*st+pt(Rt)*ct,yt=2*Rt*Lt*(st-ct),te=pt(Rt)*st+pt(Lt)*ct,Zt=wt*m*m-yt*A*m+te*A*A,re=yt*(o*m+A*f)-2*(wt*f*m+te*o*A),Xt=wt*f*f-yt*o*f+te*o*o,ne=(Math.atan2(re,Zt-Xt)+Math.PI)%Math.PI/2,se=Math.sin(ne),we=Math.cos(ne);C.rX=Math.abs(mt)/Math.sqrt(Zt*pt(we)+re*se*we+Xt*pt(se)),C.rY=Math.abs(mt)/Math.sqrt(Zt*pt(se)-re*se*we+Xt*pt(we)),C.xRot=180*ne/Math.PI}return C.sweepFlag!==void 0&&0>mt&&(C.sweepFlag=+!C.sweepFlag),C})}function a(){return function(o){var A={};for(var f in o)A[f]=o[f];return A}}r.ROUND=function(o){function A(f){return Math.round(f*o)/o}return o===void 0&&(o=1e13),il(o),function(f){return f.x1!==void 0&&(f.x1=A(f.x1)),f.y1!==void 0&&(f.y1=A(f.y1)),f.x2!==void 0&&(f.x2=A(f.x2)),f.y2!==void 0&&(f.y2=A(f.y2)),f.x!==void 0&&(f.x=A(f.x)),f.y!==void 0&&(f.y=A(f.y)),f.rX!==void 0&&(f.rX=A(f.rX)),f.rY!==void 0&&(f.rY=A(f.rY)),f}},r.TO_ABS=t,r.TO_REL=function(){return i(function(o,A,f){return o.relative||(o.x1!==void 0&&(o.x1-=A),o.y1!==void 0&&(o.y1-=f),o.x2!==void 0&&(o.x2-=A),o.y2!==void 0&&(o.y2-=f),o.x!==void 0&&(o.x-=A),o.y!==void 0&&(o.y-=f),o.relative=!0),o})},r.NORMALIZE_HVZ=function(o,A,f){return o===void 0&&(o=!0),A===void 0&&(A=!0),f===void 0&&(f=!0),i(function(m,b,x,C,M){if(isNaN(C)&&!(m.type&Pe.MOVE_TO))throw new Error("path must start with moveto");return A&&m.type&Pe.HORIZ_LINE_TO&&(m.type=Pe.LINE_TO,m.y=m.relative?0:x),f&&m.type&Pe.VERT_LINE_TO&&(m.type=Pe.LINE_TO,m.x=m.relative?0:b),o&&m.type&Pe.CLOSE_PATH&&(m.type=Pe.LINE_TO,m.x=m.relative?C-b:C,m.y=m.relative?M-x:M),m.type&Pe.ARC&&(m.rX===0||m.rY===0)&&(m.type=Pe.LINE_TO,delete m.rX,delete m.rY,delete m.xRot,delete m.lArcFlag,delete m.sweepFlag),m})},r.NORMALIZE_ST=e,r.QT_TO_C=n,r.INFO=i,r.SANITIZE=function(o){o===void 0&&(o=0),il(o);var A=NaN,f=NaN,m=NaN,b=NaN;return i(function(x,C,M,U,N){var Q=Math.abs,q=!1,Y=0,tt=0;if(x.type&Pe.SMOOTH_CURVE_TO&&(Y=isNaN(A)?0:C-A,tt=isNaN(f)?0:M-f),x.type&(Pe.CURVE_TO|Pe.SMOOTH_CURVE_TO)?(A=x.relative?C+x.x2:x.x2,f=x.relative?M+x.y2:x.y2):(A=NaN,f=NaN),x.type&Pe.SMOOTH_QUAD_TO?(m=isNaN(m)?C:2*C-m,b=isNaN(b)?M:2*M-b):x.type&Pe.QUAD_TO?(m=x.relative?C+x.x1:x.x1,b=x.relative?M+x.y1:x.y2):(m=NaN,b=NaN),x.type&Pe.LINE_COMMANDS||x.type&Pe.ARC&&(x.rX===0||x.rY===0||!x.lArcFlag)||x.type&Pe.CURVE_TO||x.type&Pe.SMOOTH_CURVE_TO||x.type&Pe.QUAD_TO||x.type&Pe.SMOOTH_QUAD_TO){var ft=x.x===void 0?0:x.relative?x.x:x.x-C,pt=x.y===void 0?0:x.relative?x.y:x.y-M;Y=isNaN(m)?x.x1===void 0?Y:x.relative?x.x:x.x1-C:m-C,tt=isNaN(b)?x.y1===void 0?tt:x.relative?x.y:x.y1-M:b-M;var mt=x.x2===void 0?0:x.relative?x.x:x.x2-C,dt=x.y2===void 0?0:x.relative?x.y:x.y2-M;Q(ft)<=o&&Q(pt)<=o&&Q(Y)<=o&&Q(tt)<=o&&Q(mt)<=o&&Q(dt)<=o&&(q=!0)}return x.type&Pe.CLOSE_PATH&&Q(C-U)<=o&&Q(M-N)<=o&&(q=!0),q?[]:x})},r.MATRIX=s,r.ROTATE=function(o,A,f){A===void 0&&(A=0),f===void 0&&(f=0),il(o,A,f);var m=Math.sin(o),b=Math.cos(o);return s(b,m,-m,b,A-A*b+f*m,f-A*m-f*b)},r.TRANSLATE=function(o,A){return A===void 0&&(A=0),il(o,A),s(1,0,0,1,o,A)},r.SCALE=function(o,A){return A===void 0&&(A=o),il(o,A),s(o,0,0,A,0,0)},r.SKEW_X=function(o){return il(o),s(1,0,Math.atan(o),1,0,0)},r.SKEW_Y=function(o){return il(o),s(1,Math.atan(o),0,1,0,0)},r.X_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),il(o),s(-1,0,0,1,o,0)},r.Y_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),il(o),s(1,0,0,-1,0,o)},r.A_TO_C=function(){return i(function(o,A,f){return Pe.ARC===o.type?function(m,b,x){var C,M,U,N;m.cX||RC(m,b,x);for(var Q=Math.min(m.phi1,m.phi2),q=Math.max(m.phi1,m.phi2)-Q,Y=Math.ceil(q/90),tt=new Array(Y),ft=b,pt=x,mt=0;mt<Y;mt++){var dt=sD(m.phi1,m.phi2,mt/Y),Rt=sD(m.phi1,m.phi2,(mt+1)/Y),Lt=Rt-dt,st=4/3*Math.tan(Lt*Vu/4),ct=[Math.cos(dt*Vu)-st*Math.sin(dt*Vu),Math.sin(dt*Vu)+st*Math.cos(dt*Vu)],wt=ct[0],yt=ct[1],te=[Math.cos(Rt*Vu),Math.sin(Rt*Vu)],Zt=te[0],re=te[1],Xt=[Zt+st*Math.sin(Rt*Vu),re-st*Math.cos(Rt*Vu)],ne=Xt[0],se=Xt[1];tt[mt]={relative:m.relative,type:Pe.CURVE_TO};var we=function(it,vt){var Ft=UC([it*m.rX,vt*m.rY],m.xRot),Ot=Ft[0],Wt=Ft[1];return[m.cX+Ot,m.cY+Wt]};C=we(wt,yt),tt[mt].x1=C[0],tt[mt].y1=C[1],M=we(ne,se),tt[mt].x2=M[0],tt[mt].y2=M[1],U=we(Zt,re),tt[mt].x=U[0],tt[mt].y=U[1],m.relative&&(tt[mt].x1-=ft,tt[mt].y1-=pt,tt[mt].x2-=ft,tt[mt].y2-=pt,tt[mt].x-=ft,tt[mt].y-=pt),ft=(N=[tt[mt].x,tt[mt].y])[0],pt=N[1]}return tt}(o,o.relative?0:A,o.relative?0:f):o})},r.ANNOTATE_ARCS=function(){return i(function(o,A,f){return o.relative&&(A=0,f=0),Pe.ARC===o.type&&RC(o,A,f),o})},r.CLONE=a,r.CALCULATE_BOUNDS=function(){var o=function(x){var C={};for(var M in x)C[M]=x[M];return C},A=t(),f=n(),m=e(),b=i(function(x,C,M){var U=m(f(A(o(x))));function N(se){se>b.maxX&&(b.maxX=se),se<b.minX&&(b.minX=se)}function Q(se){se>b.maxY&&(b.maxY=se),se<b.minY&&(b.minY=se)}if(U.type&Pe.DRAWING_COMMANDS&&(N(C),Q(M)),U.type&Pe.HORIZ_LINE_TO&&N(U.x),U.type&Pe.VERT_LINE_TO&&Q(U.y),U.type&Pe.LINE_TO&&(N(U.x),Q(U.y)),U.type&Pe.CURVE_TO){N(U.x),Q(U.y);for(var q=0,Y=aD(C,U.x1,U.x2,U.x);q<Y.length;q++)0<(ne=Y[q])&&1>ne&&N(cD(C,U.x1,U.x2,U.x,ne));for(var tt=0,ft=aD(M,U.y1,U.y2,U.y);tt<ft.length;tt++)0<(ne=ft[tt])&&1>ne&&Q(cD(M,U.y1,U.y2,U.y,ne))}if(U.type&Pe.ARC){N(U.x),Q(U.y),RC(U,C,M);for(var pt=U.xRot/180*Math.PI,mt=Math.cos(pt)*U.rX,dt=Math.sin(pt)*U.rX,Rt=-Math.sin(pt)*U.rY,Lt=Math.cos(pt)*U.rY,st=U.phi1<U.phi2?[U.phi1,U.phi2]:-180>U.phi2?[U.phi2+360,U.phi1+360]:[U.phi2,U.phi1],ct=st[0],wt=st[1],yt=function(se){var we=se[0],it=se[1],vt=180*Math.atan2(it,we)/Math.PI;return vt<ct?vt+360:vt},te=0,Zt=iD(Rt,-mt,0).map(yt);te<Zt.length;te++)(ne=Zt[te])>ct&&ne<wt&&N(oD(U.cX,mt,Rt,ne));for(var re=0,Xt=iD(Lt,-dt,0).map(yt);re<Xt.length;re++){var ne;(ne=Xt[re])>ct&&ne<wt&&Q(oD(U.cY,dt,Lt,ne))}}return x});return b.minX=1/0,b.maxX=-1/0,b.minY=1/0,b.maxY=-1/0,b}})(ms||(ms={}));var sl,lD=function(){function r(){}return r.prototype.round=function(t){return this.transform(ms.ROUND(t))},r.prototype.toAbs=function(){return this.transform(ms.TO_ABS())},r.prototype.toRel=function(){return this.transform(ms.TO_REL())},r.prototype.normalizeHVZ=function(t,e,n){return this.transform(ms.NORMALIZE_HVZ(t,e,n))},r.prototype.normalizeST=function(){return this.transform(ms.NORMALIZE_ST())},r.prototype.qtToC=function(){return this.transform(ms.QT_TO_C())},r.prototype.aToC=function(){return this.transform(ms.A_TO_C())},r.prototype.sanitize=function(t){return this.transform(ms.SANITIZE(t))},r.prototype.translate=function(t,e){return this.transform(ms.TRANSLATE(t,e))},r.prototype.scale=function(t,e){return this.transform(ms.SCALE(t,e))},r.prototype.rotate=function(t,e,n){return this.transform(ms.ROTATE(t,e,n))},r.prototype.matrix=function(t,e,n,i,s,a){return this.transform(ms.MATRIX(t,e,n,i,s,a))},r.prototype.skewX=function(t){return this.transform(ms.SKEW_X(t))},r.prototype.skewY=function(t){return this.transform(ms.SKEW_Y(t))},r.prototype.xSymmetry=function(t){return this.transform(ms.X_AXIS_SYMMETRY(t))},r.prototype.ySymmetry=function(t){return this.transform(ms.Y_AXIS_SYMMETRY(t))},r.prototype.annotateArcs=function(){return this.transform(ms.ANNOTATE_ARCS())},r}(),o1t=function(r){return r===" "||r==="	"||r==="\r"||r===`
`},uD=function(r){return 48<=r.charCodeAt(0)&&r.charCodeAt(0)<=57},a1t=function(r){function t(){var e=r.call(this)||this;return e.curNumber="",e.curCommandType=-1,e.curCommandRelative=!1,e.canParseCommandOrComma=!0,e.curNumberHasExp=!1,e.curNumberHasExpDigits=!1,e.curNumberHasDecimal=!1,e.curArgs=[],e}return nD(t,r),t.prototype.finish=function(e){if(e===void 0&&(e=[]),this.parse(" ",e),this.curArgs.length!==0||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return e},t.prototype.parse=function(e,n){var i=this;n===void 0&&(n=[]);for(var s=function(b){n.push(b),i.curArgs.length=0,i.canParseCommandOrComma=!0},a=0;a<e.length;a++){var o=e[a],A=!(this.curCommandType!==Pe.ARC||this.curArgs.length!==3&&this.curArgs.length!==4||this.curNumber.length!==1||this.curNumber!=="0"&&this.curNumber!=="1"),f=uD(o)&&(this.curNumber==="0"&&o==="0"||A);if(!uD(o)||f)if(o!=="e"&&o!=="E")if(o!=="-"&&o!=="+"||!this.curNumberHasExp||this.curNumberHasExpDigits)if(o!=="."||this.curNumberHasExp||this.curNumberHasDecimal||A){if(this.curNumber&&this.curCommandType!==-1){var m=Number(this.curNumber);if(isNaN(m))throw new SyntaxError("Invalid number ending at "+a);if(this.curCommandType===Pe.ARC){if(this.curArgs.length===0||this.curArgs.length===1){if(0>m)throw new SyntaxError('Expected positive number, got "'+m+'" at index "'+a+'"')}else if((this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber!=="0"&&this.curNumber!=="1")throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+a+'"')}this.curArgs.push(m),this.curArgs.length===c1t[this.curCommandType]&&(Pe.HORIZ_LINE_TO===this.curCommandType?s({type:Pe.HORIZ_LINE_TO,relative:this.curCommandRelative,x:m}):Pe.VERT_LINE_TO===this.curCommandType?s({type:Pe.VERT_LINE_TO,relative:this.curCommandRelative,y:m}):this.curCommandType===Pe.MOVE_TO||this.curCommandType===Pe.LINE_TO||this.curCommandType===Pe.SMOOTH_QUAD_TO?(s({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),Pe.MOVE_TO===this.curCommandType&&(this.curCommandType=Pe.LINE_TO)):this.curCommandType===Pe.CURVE_TO?s({type:Pe.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===Pe.SMOOTH_CURVE_TO?s({type:Pe.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===Pe.QUAD_TO?s({type:Pe.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===Pe.ARC&&s({type:Pe.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!o1t(o))if(o===","&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if(o!=="+"&&o!=="-"&&o!==".")if(f)this.curNumber=o,this.curNumberHasDecimal=!1;else{if(this.curArgs.length!==0)throw new SyntaxError("Unterminated command at index "+a+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+o+'" at index '+a+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,o!=="z"&&o!=="Z")if(o==="h"||o==="H")this.curCommandType=Pe.HORIZ_LINE_TO,this.curCommandRelative=o==="h";else if(o==="v"||o==="V")this.curCommandType=Pe.VERT_LINE_TO,this.curCommandRelative=o==="v";else if(o==="m"||o==="M")this.curCommandType=Pe.MOVE_TO,this.curCommandRelative=o==="m";else if(o==="l"||o==="L")this.curCommandType=Pe.LINE_TO,this.curCommandRelative=o==="l";else if(o==="c"||o==="C")this.curCommandType=Pe.CURVE_TO,this.curCommandRelative=o==="c";else if(o==="s"||o==="S")this.curCommandType=Pe.SMOOTH_CURVE_TO,this.curCommandRelative=o==="s";else if(o==="q"||o==="Q")this.curCommandType=Pe.QUAD_TO,this.curCommandRelative=o==="q";else if(o==="t"||o==="T")this.curCommandType=Pe.SMOOTH_QUAD_TO,this.curCommandRelative=o==="t";else{if(o!=="a"&&o!=="A")throw new SyntaxError('Unexpected character "'+o+'" at index '+a+".");this.curCommandType=Pe.ARC,this.curCommandRelative=o==="a"}else n.push({type:Pe.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=o,this.curNumberHasDecimal=o==="."}else this.curNumber+=o,this.curNumberHasDecimal=!0;else this.curNumber+=o;else this.curNumber+=o,this.curNumberHasExp=!0;else this.curNumber+=o,this.curNumberHasExpDigits=this.curNumberHasExp}return n},t.prototype.transform=function(e){return Object.create(this,{parse:{value:function(n,i){i===void 0&&(i=[]);for(var s=0,a=Object.getPrototypeOf(this).parse.call(this,n);s<a.length;s++){var o=a[s],A=e(o);Array.isArray(A)?i.push.apply(i,A):i.push(A)}return i}}})},t}(lD),Pe=function(r){function t(e){var n=r.call(this)||this;return n.commands=typeof e=="string"?t.parse(e):e,n}return nD(t,r),t.prototype.encode=function(){return t.encode(this.commands)},t.prototype.getBounds=function(){var e=ms.CALCULATE_BOUNDS();return this.transform(e),e},t.prototype.transform=function(e){for(var n=[],i=0,s=this.commands;i<s.length;i++){var a=e(s[i]);Array.isArray(a)?n.push.apply(n,a):n.push(a)}return this.commands=n,this},t.encode=function(e){return s1t(e)},t.parse=function(e){var n=new a1t,i=[];return n.parse(e,i),n.finish(i),i},t.CLOSE_PATH=1,t.MOVE_TO=2,t.HORIZ_LINE_TO=4,t.VERT_LINE_TO=8,t.LINE_TO=16,t.CURVE_TO=32,t.SMOOTH_CURVE_TO=64,t.QUAD_TO=128,t.SMOOTH_QUAD_TO=256,t.ARC=512,t.LINE_COMMANDS=t.LINE_TO|t.HORIZ_LINE_TO|t.VERT_LINE_TO,t.DRAWING_COMMANDS=t.HORIZ_LINE_TO|t.VERT_LINE_TO|t.LINE_TO|t.CURVE_TO|t.SMOOTH_CURVE_TO|t.QUAD_TO|t.SMOOTH_QUAD_TO|t.ARC,t}(lD),c1t=((sl={})[Pe.MOVE_TO]=2,sl[Pe.LINE_TO]=2,sl[Pe.HORIZ_LINE_TO]=1,sl[Pe.VERT_LINE_TO]=1,sl[Pe.CLOSE_PATH]=0,sl[Pe.QUAD_TO]=4,sl[Pe.SMOOTH_QUAD_TO]=2,sl[Pe.CURVE_TO]=6,sl[Pe.SMOOTH_CURVE_TO]=4,sl[Pe.ARC]=7,sl),l1t=$s,u1t=nl,A1t=C1,h1t=jR,AD=RegExp.prototype,d1t=function(r){var t=r.flags;return t===void 0&&!("flags"in AD)&&!u1t(r,"flags")&&A1t(AD,r)?l1t(h1t,r):t},f1t=M1.PROPER,p1t=td,g1t=No,hD=Zl,m1t=ns,y1t=d1t,OC="toString",dD=RegExp.prototype,fD=dD[OC],_1t=m1t(function(){return fD.call({source:"a",flags:"b"})!=="/a/b"}),v1t=f1t&&fD.name!==OC;(_1t||v1t)&&p1t(dD,OC,function(){var r=g1t(this),t=hD(r.source),e=hD(y1t(r));return"/"+t+"/"+e},{unsafe:!0});function u_(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?u_=function(t){return typeof t}:u_=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u_(r)}function b1t(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var w1t=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],x1t=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function B1t(r,t,e,n,i){if(typeof r=="string"&&(r=document.getElementById(r)),!r||u_(r)!=="object"||!("getContext"in r))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var s=r.getContext("2d");try{return s.getImageData(t,e,n,i)}catch(a){throw new Error("unable to access image data: "+a)}}function C1t(r,t,e,n,i,s){if(!(isNaN(s)||s<1)){s|=0;var a=B1t(r,t,e,n,i);a=E1t(a,t,e,n,i,s),r.getContext("2d").putImageData(a,t,e)}}function E1t(r,t,e,n,i,s){for(var a=r.data,o=2*s+1,A=n-1,f=i-1,m=s+1,b=m*(m+1)/2,x=new pD,C=x,M,U=1;U<o;U++)C=C.next=new pD,U===m&&(M=C);C.next=x;for(var N=null,Q=null,q=0,Y=0,tt=w1t[s],ft=x1t[s],pt=0;pt<i;pt++){C=x;for(var mt=a[Y],dt=a[Y+1],Rt=a[Y+2],Lt=a[Y+3],st=0;st<m;st++)C.r=mt,C.g=dt,C.b=Rt,C.a=Lt,C=C.next;for(var ct=0,wt=0,yt=0,te=0,Zt=m*mt,re=m*dt,Xt=m*Rt,ne=m*Lt,se=b*mt,we=b*dt,it=b*Rt,vt=b*Lt,Ft=1;Ft<m;Ft++){var Ot=Y+((A<Ft?A:Ft)<<2),Wt=a[Ot],jt=a[Ot+1],ae=a[Ot+2],ie=a[Ot+3],Be=m-Ft;se+=(C.r=Wt)*Be,we+=(C.g=jt)*Be,it+=(C.b=ae)*Be,vt+=(C.a=ie)*Be,ct+=Wt,wt+=jt,yt+=ae,te+=ie,C=C.next}N=x,Q=M;for(var Te=0;Te<n;Te++){var Ne=vt*tt>>>ft;if(a[Y+3]=Ne,Ne!==0){var Qe=255/Ne;a[Y]=(se*tt>>>ft)*Qe,a[Y+1]=(we*tt>>>ft)*Qe,a[Y+2]=(it*tt>>>ft)*Qe}else a[Y]=a[Y+1]=a[Y+2]=0;se-=Zt,we-=re,it-=Xt,vt-=ne,Zt-=N.r,re-=N.g,Xt-=N.b,ne-=N.a;var He=Te+s+1;He=q+(He<A?He:A)<<2,ct+=N.r=a[He],wt+=N.g=a[He+1],yt+=N.b=a[He+2],te+=N.a=a[He+3],se+=ct,we+=wt,it+=yt,vt+=te,N=N.next;var ge=Q,Ut=ge.r,Yt=ge.g,tr=ge.b,Ee=ge.a;Zt+=Ut,re+=Yt,Xt+=tr,ne+=Ee,ct-=Ut,wt-=Yt,yt-=tr,te-=Ee,Q=Q.next,Y+=4}q+=n}for(var _e=0;_e<n;_e++){Y=_e<<2;var xe=a[Y],De=a[Y+1],nr=a[Y+2],ur=a[Y+3],Ir=m*xe,Sr=m*De,Dr=m*nr,Nr=m*ur,fe=b*xe,Tr=b*De,Oe=b*nr,wn=b*ur;C=x;for(var Fr=0;Fr<m;Fr++)C.r=xe,C.g=De,C.b=nr,C.a=ur,C=C.next;for(var Se=n,Xe=0,qe=0,Yr=0,Rr=0,pr=1;pr<=s;pr++){Y=Se+_e<<2;var on=m-pr;fe+=(C.r=xe=a[Y])*on,Tr+=(C.g=De=a[Y+1])*on,Oe+=(C.b=nr=a[Y+2])*on,wn+=(C.a=ur=a[Y+3])*on,Rr+=xe,Xe+=De,qe+=nr,Yr+=ur,C=C.next,pr<f&&(Se+=n)}Y=_e,N=x,Q=M;for(var Kr=0;Kr<i;Kr++){var Ct=Y<<2;a[Ct+3]=ur=wn*tt>>>ft,ur>0?(ur=255/ur,a[Ct]=(fe*tt>>>ft)*ur,a[Ct+1]=(Tr*tt>>>ft)*ur,a[Ct+2]=(Oe*tt>>>ft)*ur):a[Ct]=a[Ct+1]=a[Ct+2]=0,fe-=Ir,Tr-=Sr,Oe-=Dr,wn-=Nr,Ir-=N.r,Sr-=N.g,Dr-=N.b,Nr-=N.a,Ct=_e+((Ct=Kr+m)<f?Ct:f)*n<<2,fe+=Rr+=N.r=a[Ct],Tr+=Xe+=N.g=a[Ct+1],Oe+=qe+=N.b=a[Ct+2],wn+=Yr+=N.a=a[Ct+3],N=N.next,Ir+=xe=Q.r,Sr+=De=Q.g,Dr+=nr=Q.b,Nr+=ur=Q.a,Rr-=xe,Xe-=De,qe-=nr,Yr-=ur,Q=Q.next,Y+=n}}return r}var pD=function r(){b1t(this,r),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};function S1t(){var{DOMParser:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:r,createCanvas(e,n){return new OffscreenCanvas(e,n)},createImage(e){return zu(function*(){var n=yield fetch(e),i=yield n.blob(),s=yield createImageBitmap(i);return s})()}};return(typeof DOMParser<"u"||typeof r>"u")&&Reflect.deleteProperty(t,"DOMParser"),t}function T1t(r){var{DOMParser:t,canvas:e,fetch:n}=r;return{window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:t,fetch:n,createCanvas:e.createCanvas,createImage:e.loadImage}}var I1t=Object.freeze({__proto__:null,offscreen:S1t,node:T1t});function sd(r){return r.replace(/(?!\u3000)\s+/gm," ")}function gD(r){return r.replace(/^[\n \t]+/,"")}function mD(r){return r.replace(/[\n \t]+$/,"")}function da(r){var t=(r||"").match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm)||[];return t.map(parseFloat)}var L1t=/^[A-Z-]+$/;function yD(r){return L1t.test(r)?r.toLowerCase():r}function DC(r){var t=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(r)||[];return t[2]||t[3]||t[4]}function _D(r){if(!r.startsWith("rgb"))return r;var t=3,e=r.replace(/\d+(\.\d+)?/g,(n,i)=>t--&&i?String(Math.round(parseFloat(n))):n);return e}var F1t=/(\[[^\]]+\])/g,M1t=/(#[^\s+>~.[:]+)/g,P1t=/(\.[^\s+>~.[:]+)/g,U1t=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,R1t=/(:[\w-]+\([^)]*\))/gi,O1t=/(:[^\s+>~.[:]+)/g,D1t=/([^\s+>~.[:]+)/g;function od(r,t){var e=t.exec(r);return e?[r.replace(t," "),e.length]:[r,0]}function vD(r){var t=[0,0,0],e=r.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),n=0;return[e,n]=od(e,F1t),t[1]+=n,[e,n]=od(e,M1t),t[0]+=n,[e,n]=od(e,P1t),t[1]+=n,[e,n]=od(e,U1t),t[2]+=n,[e,n]=od(e,R1t),t[1]+=n,[e,n]=od(e,O1t),t[1]+=n,e=e.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),[e,n]=od(e,D1t),t[2]+=n,t.join("")}var ad=1e-8;function kC(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2))}function A_(r,t){return(r[0]*t[0]+r[1]*t[1])/(kC(r)*kC(t))}function NC(r,t){return(r[0]*t[1]<r[1]*t[0]?-1:1)*Math.acos(A_(r,t))}function QC(r){return r*r*r}function HC(r){return 3*r*r*(1-r)}function zC(r){return 3*r*(1-r)*(1-r)}function GC(r){return(1-r)*(1-r)*(1-r)}function VC(r){return r*r}function jC(r){return 2*r*(1-r)}function qC(r){return(1-r)*(1-r)}class Ur{constructor(t,e,n){this.document=t,this.name=e,this.value=n,this.isNormalizedColor=!1}static empty(t){return new Ur(t,"EMPTY","")}split(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:" ",{document:e,name:n}=this;return sd(this.getString()).trim().split(t).map(i=>new Ur(e,n,i))}hasValue(t){var{value:e}=this;return e!==null&&e!==""&&(t||e!==0)&&typeof e<"u"}isString(t){var{value:e}=this,n=typeof e=="string";return!n||!t?n:t.test(e)}isUrlDefinition(){return this.isString(/^url\(/)}isPixels(){if(!this.hasValue())return!1;var t=this.getString();switch(!0){case t.endsWith("px"):case/^[0-9]+$/.test(t):return!0;default:return!1}}setValue(t){return this.value=t,this}getValue(t){return typeof t>"u"||this.hasValue()?this.value:t}getNumber(t){if(!this.hasValue())return typeof t>"u"?0:parseFloat(t);var{value:e}=this,n=parseFloat(e);return this.isString(/%$/)&&(n/=100),n}getString(t){return typeof t>"u"||this.hasValue()?typeof this.value>"u"?"":String(this.value):String(t)}getColor(t){var e=this.getString(t);return this.isNormalizedColor||(this.isNormalizedColor=!0,e=_D(e),this.value=e),e}getDpi(){return 96}getRem(){return this.document.rootEmSize}getEm(){return this.document.emSize}getUnits(){return this.getString().replace(/[0-9.-]/g,"")}getPixels(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!this.hasValue())return 0;var[n,i]=typeof t=="boolean"?[void 0,t]:[t],{viewPort:s}=this.document.screen;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(s.computeSize("x"),s.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(s.computeSize("x"),s.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*s.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*s.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return this.getNumber()*15;case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case(this.isString(/%$/)&&i):return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*s.computeSize(n);default:{var a=this.getNumber();return e&&a<1?a*s.computeSize(n):a}}}getMilliseconds(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():this.getNumber()*1e3:0}getRadians(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}getDefinition(){var t=this.getString(),e=/#([^)'"]+)/.exec(t);return e&&(e=e[1]),e||(e=t),this.document.definitions[e]}getFillStyleDefinition(t,e){var n=this.getDefinition();if(!n)return null;if(typeof n.createGradient=="function")return n.createGradient(this.document.ctx,t,e);if(typeof n.createPattern=="function"){if(n.getHrefAttribute().hasValue()){var i=n.getAttribute("patternTransform");n=n.getHrefAttribute().getDefinition(),i.hasValue()&&n.getAttribute("patternTransform",!0).setValue(i.value)}return n.createPattern(this.document.ctx,t,e)}return null}getTextBaseline(){return this.hasValue()?Ur.textBaselineMapping[this.getString()]:null}addOpacity(t){for(var e=this.getColor(),n=e.length,i=0,s=0;s<n&&(e[s]===","&&i++,i!==3);s++);if(t.hasValue()&&this.isString()&&i!==3){var a=new MC(e);a.ok&&(a.alpha=t.getNumber(),e=a.toRGBA())}return new Ur(this.document,this.name,e)}}Ur.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};class bD{constructor(){this.viewPorts=[]}clear(){this.viewPorts=[]}setCurrent(t,e){this.viewPorts.push({width:t,height:e})}removeCurrent(){this.viewPorts.pop()}getCurrent(){var{viewPorts:t}=this;return t[t.length-1]}get width(){return this.getCurrent().width}get height(){return this.getCurrent().height}computeSize(t){return typeof t=="number"?t:t==="x"?this.width:t==="y"?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}}class Gi{constructor(t,e){this.x=t,this.y=e}static parse(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,[n=e,i=e]=da(t);return new Gi(n,i)}static parseScale(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,[n=e,i=n]=da(t);return new Gi(n,i)}static parsePath(t){for(var e=da(t),n=e.length,i=[],s=0;s<n;s+=2)i.push(new Gi(e[s],e[s+1]));return i}angleTo(t){return Math.atan2(t.y-this.y,t.x-this.x)}applyTransform(t){var{x:e,y:n}=this,i=e*t[0]+n*t[2]+t[4],s=e*t[1]+n*t[3]+t[5];this.x=i,this.y=s}}class wD{constructor(t){this.screen=t,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}isWorking(){return this.working}start(){if(!this.working){var{screen:t,onClick:e,onMouseMove:n}=this,i=t.ctx.canvas;i.onclick=e,i.onmousemove=n,this.working=!0}}stop(){if(this.working){var t=this.screen.ctx.canvas;this.working=!1,t.onclick=null,t.onmousemove=null}}hasEvents(){return this.working&&this.events.length>0}runEvents(){if(this.working){var{screen:t,events:e,eventElements:n}=this,{style:i}=t.ctx.canvas;i&&(i.cursor=""),e.forEach((s,a)=>{for(var{run:o}=s,A=n[a];A;)o(A),A=A.parent}),this.events=[],this.eventElements=[]}}checkPath(t,e){if(!(!this.working||!e)){var{events:n,eventElements:i}=this;n.forEach((s,a)=>{var{x:o,y:A}=s;!i[a]&&e.isPointInPath&&e.isPointInPath(o,A)&&(i[a]=t)})}}checkBoundingBox(t,e){if(!(!this.working||!e)){var{events:n,eventElements:i}=this;n.forEach((s,a)=>{var{x:o,y:A}=s;!i[a]&&e.isPointInBox(o,A)&&(i[a]=t)})}}mapXY(t,e){for(var{window:n,ctx:i}=this.screen,s=new Gi(t,e),a=i.canvas;a;)s.x-=a.offsetLeft,s.y-=a.offsetTop,a=a.offsetParent;return n.scrollX&&(s.x+=n.scrollX),n.scrollY&&(s.y+=n.scrollY),s}onClick(t){var{x:e,y:n}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onclick",x:e,y:n,run(i){i.onClick&&i.onClick()}})}onMouseMove(t){var{x:e,y:n}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onmousemove",x:e,y:n,run(i){i.onMouseMove&&i.onMouseMove()}})}}var xD=typeof window<"u"?window:null,BD=typeof fetch<"u"?fetch.bind(void 0):null;class gm{constructor(t){var{fetch:e=BD,window:n=xD}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.ctx=t,this.FRAMERATE=30,this.MAX_VIRTUAL_PIXELS=3e4,this.CLIENT_WIDTH=800,this.CLIENT_HEIGHT=600,this.viewPort=new bD,this.mouse=new wD(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=n,this.fetch=e}wait(t){this.waits.push(t)}ready(){return this.readyPromise?this.readyPromise:Promise.resolve()}isReady(){if(this.isReadyLock)return!0;var t=this.waits.every(e=>e());return t&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=t,t}setDefaults(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4}setViewBox(t){var{document:e,ctx:n,aspectRatio:i,width:s,desiredWidth:a,height:o,desiredHeight:A,minX:f=0,minY:m=0,refX:b,refY:x,clip:C=!1,clipX:M=0,clipY:U=0}=t,N=sd(i).replace(/^defer\s/,""),[Q,q]=N.split(" "),Y=Q||"xMidYMid",tt=q||"meet",ft=s/a,pt=o/A,mt=Math.min(ft,pt),dt=Math.max(ft,pt),Rt=a,Lt=A;tt==="meet"&&(Rt*=mt,Lt*=mt),tt==="slice"&&(Rt*=dt,Lt*=dt);var st=new Ur(e,"refX",b),ct=new Ur(e,"refY",x),wt=st.hasValue()&&ct.hasValue();if(wt&&n.translate(-mt*st.getPixels("x"),-mt*ct.getPixels("y")),C){var yt=mt*M,te=mt*U;n.beginPath(),n.moveTo(yt,te),n.lineTo(s,te),n.lineTo(s,o),n.lineTo(yt,o),n.closePath(),n.clip()}if(!wt){var Zt=tt==="meet"&&mt===pt,re=tt==="slice"&&dt===pt,Xt=tt==="meet"&&mt===ft,ne=tt==="slice"&&dt===ft;Y.startsWith("xMid")&&(Zt||re)&&n.translate(s/2-Rt/2,0),Y.endsWith("YMid")&&(Xt||ne)&&n.translate(0,o/2-Lt/2),Y.startsWith("xMax")&&(Zt||re)&&n.translate(s-Rt,0),Y.endsWith("YMax")&&(Xt||ne)&&n.translate(0,o-Lt)}switch(!0){case Y==="none":n.scale(ft,pt);break;case tt==="meet":n.scale(mt,mt);break;case tt==="slice":n.scale(dt,dt);break}n.translate(-f,-m)}start(t){var{enableRedraw:e=!1,ignoreMouse:n=!1,ignoreAnimation:i=!1,ignoreDimensions:s=!1,ignoreClear:a=!1,forceRedraw:o,scaleWidth:A,scaleHeight:f,offsetX:m,offsetY:b}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{FRAMERATE:x,mouse:C}=this,M=1e3/x;if(this.frameDuration=M,this.readyPromise=new Promise(Y=>{this.resolveReady=Y}),this.isReady()&&this.render(t,s,a,A,f,m,b),!!e){var U=Date.now(),N=U,Q=0,q=()=>{U=Date.now(),Q=U-N,Q>=M&&(N=U-Q%M,this.shouldUpdate(i,o)&&(this.render(t,s,a,A,f,m,b),C.runEvents())),this.intervalId=IC(q)};n||C.start(),this.intervalId=IC(q)}}stop(){this.intervalId&&(IC.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}shouldUpdate(t,e){if(!t){var{frameDuration:n}=this,i=this.animations.reduce((s,a)=>a.update(n)||s,!1);if(i)return!0}return!!(typeof e=="function"&&e()||!this.isReadyLock&&this.isReady()||this.mouse.hasEvents())}render(t,e,n,i,s,a,o){var{CLIENT_WIDTH:A,CLIENT_HEIGHT:f,viewPort:m,ctx:b,isFirstRender:x}=this,C=b.canvas;m.clear(),C.width&&C.height?m.setCurrent(C.width,C.height):m.setCurrent(A,f);var M=t.getStyle("width"),U=t.getStyle("height");!e&&(x||typeof i!="number"&&typeof s!="number")&&(M.hasValue()&&(C.width=M.getPixels("x"),C.style&&(C.style.width="".concat(C.width,"px"))),U.hasValue()&&(C.height=U.getPixels("y"),C.style&&(C.style.height="".concat(C.height,"px"))));var N=C.clientWidth||C.width,Q=C.clientHeight||C.height;if(e&&M.hasValue()&&U.hasValue()&&(N=M.getPixels("x"),Q=U.getPixels("y")),m.setCurrent(N,Q),typeof a=="number"&&t.getAttribute("x",!0).setValue(a),typeof o=="number"&&t.getAttribute("y",!0).setValue(o),typeof i=="number"||typeof s=="number"){var q=da(t.getAttribute("viewBox").getString()),Y=0,tt=0;if(typeof i=="number"){var ft=t.getStyle("width");ft.hasValue()?Y=ft.getPixels("x")/i:isNaN(q[2])||(Y=q[2]/i)}if(typeof s=="number"){var pt=t.getStyle("height");pt.hasValue()?tt=pt.getPixels("y")/s:isNaN(q[3])||(tt=q[3]/s)}Y||(Y=tt),tt||(tt=Y),t.getAttribute("width",!0).setValue(i),t.getAttribute("height",!0).setValue(s);var mt=t.getStyle("transform",!0,!0);mt.setValue("".concat(mt.getString()," scale(").concat(1/Y,", ").concat(1/tt,")"))}n||b.clearRect(0,0,N,Q),t.render(b),x&&(this.isFirstRender=!1)}}gm.defaultWindow=xD,gm.defaultFetch=BD;var{defaultFetch:k1t}=gm,N1t=typeof DOMParser<"u"?DOMParser:null;class h_{constructor(){var{fetch:t=k1t,DOMParser:e=N1t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fetch=t,this.DOMParser=e}parse(t){var e=this;return zu(function*(){return t.startsWith("<")?e.parseFromString(t):e.load(t)})()}parseFromString(t){var e=new this.DOMParser;try{return this.checkDocument(e.parseFromString(t,"image/svg+xml"))}catch{return this.checkDocument(e.parseFromString(t,"text/xml"))}}checkDocument(t){var e=t.getElementsByTagName("parsererror")[0];if(e)throw new Error(e.textContent);return t}load(t){var e=this;return zu(function*(){var n=yield e.fetch(t),i=yield n.text();return e.parseFromString(i)})()}}class CD{constructor(t,e){this.type="translate",this.point=null,this.point=Gi.parse(e)}apply(t){var{x:e,y:n}=this.point;t.translate(e||0,n||0)}unapply(t){var{x:e,y:n}=this.point;t.translate(-1*e||0,-1*n||0)}applyToPoint(t){var{x:e,y:n}=this.point;t.applyTransform([1,0,0,1,e||0,n||0])}}class ED{constructor(t,e,n){this.type="rotate",this.angle=null,this.originX=null,this.originY=null,this.cx=0,this.cy=0;var i=da(e);this.angle=new Ur(t,"angle",i[0]),this.originX=n[0],this.originY=n[1],this.cx=i[1]||0,this.cy=i[2]||0}apply(t){var{cx:e,cy:n,originX:i,originY:s,angle:a}=this,o=e+i.getPixels("x"),A=n+s.getPixels("y");t.translate(o,A),t.rotate(a.getRadians()),t.translate(-o,-A)}unapply(t){var{cx:e,cy:n,originX:i,originY:s,angle:a}=this,o=e+i.getPixels("x"),A=n+s.getPixels("y");t.translate(o,A),t.rotate(-1*a.getRadians()),t.translate(-o,-A)}applyToPoint(t){var{cx:e,cy:n,angle:i}=this,s=i.getRadians();t.applyTransform([1,0,0,1,e||0,n||0]),t.applyTransform([Math.cos(s),Math.sin(s),-Math.sin(s),Math.cos(s),0,0]),t.applyTransform([1,0,0,1,-e||0,-n||0])}}class SD{constructor(t,e,n){this.type="scale",this.scale=null,this.originX=null,this.originY=null;var i=Gi.parseScale(e);(i.x===0||i.y===0)&&(i.x=ad,i.y=ad),this.scale=i,this.originX=n[0],this.originY=n[1]}apply(t){var{scale:{x:e,y:n},originX:i,originY:s}=this,a=i.getPixels("x"),o=s.getPixels("y");t.translate(a,o),t.scale(e,n||e),t.translate(-a,-o)}unapply(t){var{scale:{x:e,y:n},originX:i,originY:s}=this,a=i.getPixels("x"),o=s.getPixels("y");t.translate(a,o),t.scale(1/e,1/n||e),t.translate(-a,-o)}applyToPoint(t){var{x:e,y:n}=this.scale;t.applyTransform([e||0,0,0,n||0,0,0])}}class KC{constructor(t,e,n){this.type="matrix",this.matrix=[],this.originX=null,this.originY=null,this.matrix=da(e),this.originX=n[0],this.originY=n[1]}apply(t){var{originX:e,originY:n,matrix:i}=this,s=e.getPixels("x"),a=n.getPixels("y");t.translate(s,a),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),t.translate(-s,-a)}unapply(t){var{originX:e,originY:n,matrix:i}=this,s=i[0],a=i[2],o=i[4],A=i[1],f=i[3],m=i[5],b=0,x=0,C=1,M=1/(s*(f*C-m*x)-a*(A*C-m*b)+o*(A*x-f*b)),U=e.getPixels("x"),N=n.getPixels("y");t.translate(U,N),t.transform(M*(f*C-m*x),M*(m*b-A*C),M*(o*x-a*C),M*(s*C-o*b),M*(a*m-o*f),M*(o*A-s*m)),t.translate(-U,-N)}applyToPoint(t){t.applyTransform(this.matrix)}}class WC extends KC{constructor(t,e,n){super(t,e,n),this.type="skew",this.angle=null,this.angle=new Ur(t,"angle",e)}}class TD extends WC{constructor(t,e,n){super(t,e,n),this.type="skewX",this.matrix=[1,0,Math.tan(this.angle.getRadians()),1,0,0]}}class ID extends WC{constructor(t,e,n){super(t,e,n),this.type="skewY",this.matrix=[1,Math.tan(this.angle.getRadians()),0,1,0,0]}}function Q1t(r){return sd(r).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)}function H1t(r){var[t,e]=r.split("(");return[t.trim(),e.trim().replace(")","")]}class YA{constructor(t,e,n){this.document=t,this.transforms=[];var i=Q1t(e);i.forEach(s=>{if(s!=="none"){var[a,o]=H1t(s),A=YA.transformTypes[a];typeof A<"u"&&this.transforms.push(new A(this.document,o,n))}})}static fromElement(t,e){var n=e.getStyle("transform",!1,!0),[i,s=i]=e.getStyle("transform-origin",!1,!0).split(),a=[i,s];return n.hasValue()?new YA(t,n.getString(),a):null}apply(t){for(var{transforms:e}=this,n=e.length,i=0;i<n;i++)e[i].apply(t)}unapply(t){for(var{transforms:e}=this,n=e.length,i=n-1;i>=0;i--)e[i].unapply(t)}applyToPoint(t){for(var{transforms:e}=this,n=e.length,i=0;i<n;i++)e[i].applyToPoint(t)}}YA.transformTypes={translate:CD,rotate:ED,scale:SD,matrix:KC,skewX:TD,skewY:ID};class mi{constructor(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.document=t,this.node=e,this.captureTextNodes=n,this.attributes={},this.styles={},this.stylesSpecificity={},this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],!(!e||e.nodeType!==1)){if(Array.from(e.attributes).forEach(o=>{var A=yD(o.nodeName);this.attributes[A]=new Ur(t,A,o.value)}),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()){var i=this.getAttribute("style").getString().split(";").map(o=>o.trim());i.forEach(o=>{if(o){var[A,f]=o.split(":").map(m=>m.trim());this.styles[A]=new Ur(t,A,f)}})}var{definitions:s}=t,a=this.getAttribute("id");a.hasValue()&&(s[a.getString()]||(s[a.getString()]=this)),Array.from(e.childNodes).forEach(o=>{if(o.nodeType===1)this.addChild(o);else if(n&&(o.nodeType===3||o.nodeType===4)){var A=t.createTextNode(o);A.getText().length>0&&this.addChild(A)}})}}getAttribute(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this.attributes[t];if(!n&&e){var i=new Ur(this.document,t,"");return this.attributes[t]=i,i}return n||Ur.empty(this.document)}getHrefAttribute(){for(var t in this.attributes)if(t==="href"||t.endsWith(":href"))return this.attributes[t];return Ur.empty(this.document)}getStyle(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.styles[t];if(i)return i;var s=this.getAttribute(t);if(s!=null&&s.hasValue())return this.styles[t]=s,s;if(!n){var{parent:a}=this;if(a){var o=a.getStyle(t);if(o!=null&&o.hasValue())return o}}if(e){var A=new Ur(this.document,t,"");return this.styles[t]=A,A}return i||Ur.empty(this.document)}render(t){if(!(this.getStyle("display").getString()==="none"||this.getStyle("visibility").getString()==="hidden")){if(t.save(),this.getStyle("mask").hasValue()){var e=this.getStyle("mask").getDefinition();e&&(this.applyEffects(t),e.apply(t,this))}else if(this.getStyle("filter").getValue("none")!=="none"){var n=this.getStyle("filter").getDefinition();n&&(this.applyEffects(t),n.apply(t,this))}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}}setContext(t){}applyEffects(t){var e=YA.fromElement(this.document,this);e&&e.apply(t);var n=this.getStyle("clip-path",!1,!0);if(n.hasValue()){var i=n.getDefinition();i&&i.apply(t)}}clearContext(t){}renderChildren(t){this.children.forEach(e=>{e.render(t)})}addChild(t){var e=t instanceof mi?t:this.document.createElement(t);e.parent=this,mi.ignoreChildTypes.includes(e.type)||this.children.push(e)}matchesSelector(t){var e,{node:n}=this;if(typeof n.matches=="function")return n.matches(t);var i=(e=n.getAttribute)===null||e===void 0?void 0:e.call(n,"class");return!i||i===""?!1:i.split(" ").some(s=>".".concat(s)===t)}addStylesFromStyleDefinition(){var{styles:t,stylesSpecificity:e}=this.document;for(var n in t)if(!n.startsWith("@")&&this.matchesSelector(n)){var i=t[n],s=e[n];if(i)for(var a in i){var o=this.stylesSpecificity[a];typeof o>"u"&&(o="000"),s>=o&&(this.styles[a]=i[a],this.stylesSpecificity[a]=s)}}}removeStyles(t,e){var n=e.reduce((i,s)=>{var a=t.getStyle(s);if(!a.hasValue())return i;var o=a.getString();return a.setValue(""),[...i,[s,o]]},[]);return n}restoreStyles(t,e){e.forEach(n=>{var[i,s]=n;t.getStyle(i,!0).setValue(s)})}isFirstChild(){var t;return((t=this.parent)===null||t===void 0?void 0:t.children.indexOf(this))===0}}mi.ignoreChildTypes=["title"];class LD extends mi{constructor(t,e,n){super(t,e,n)}}function z1t(r){var t=r.trim();return/^('|")/.test(t)?t:'"'.concat(t,'"')}function G1t(r){return typeof process>"u"?r:r.trim().split(",").map(z1t).join(",")}function V1t(r){if(!r)return"";var t=r.trim().toLowerCase();switch(t){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return t;default:return/^oblique\s+(-|)\d+deg$/.test(t)?t:""}}function j1t(r){if(!r)return"";var t=r.trim().toLowerCase();switch(t){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return t;default:return/^[\d.]+$/.test(t)?t:""}}class yo{constructor(t,e,n,i,s,a){var o=a?typeof a=="string"?yo.parse(a):a:{};this.fontFamily=s||o.fontFamily,this.fontSize=i||o.fontSize,this.fontStyle=t||o.fontStyle,this.fontWeight=n||o.fontWeight,this.fontVariant=e||o.fontVariant}static parse(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n="",i="",s="",a="",o="",A=sd(t).trim().split(" "),f={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return A.forEach(m=>{switch(!0){case(!f.fontStyle&&yo.styles.includes(m)):m!=="inherit"&&(n=m),f.fontStyle=!0;break;case(!f.fontVariant&&yo.variants.includes(m)):m!=="inherit"&&(i=m),f.fontStyle=!0,f.fontVariant=!0;break;case(!f.fontWeight&&yo.weights.includes(m)):m!=="inherit"&&(s=m),f.fontStyle=!0,f.fontVariant=!0,f.fontWeight=!0;break;case!f.fontSize:m!=="inherit"&&([a]=m.split("/")),f.fontStyle=!0,f.fontVariant=!0,f.fontWeight=!0,f.fontSize=!0;break;default:m!=="inherit"&&(o+=m)}}),new yo(n,i,s,a,o,e)}toString(){return[V1t(this.fontStyle),this.fontVariant,j1t(this.fontWeight),this.fontSize,G1t(this.fontFamily)].join(" ").trim()}}yo.styles="normal|italic|oblique|inherit",yo.variants="normal|small-caps|inherit",yo.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";class hc{constructor(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.NaN,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.NaN,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Number.NaN,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Number.NaN;this.x1=t,this.y1=e,this.x2=n,this.y2=i,this.addPoint(t,e),this.addPoint(n,i)}get x(){return this.x1}get y(){return this.y1}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}addPoint(t,e){typeof t<"u"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),typeof e<"u"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))}addX(t){this.addPoint(t,null)}addY(t){this.addPoint(null,t)}addBoundingBox(t){if(t){var{x1:e,y1:n,x2:i,y2:s}=t;this.addPoint(e,n),this.addPoint(i,s)}}sumCubic(t,e,n,i,s){return Math.pow(1-t,3)*e+3*Math.pow(1-t,2)*t*n+3*(1-t)*Math.pow(t,2)*i+Math.pow(t,3)*s}bezierCurveAdd(t,e,n,i,s){var a=6*e-12*n+6*i,o=-3*e+9*n-9*i+3*s,A=3*n-3*e;if(o===0){if(a===0)return;var f=-A/a;0<f&&f<1&&(t?this.addX(this.sumCubic(f,e,n,i,s)):this.addY(this.sumCubic(f,e,n,i,s)));return}var m=Math.pow(a,2)-4*A*o;if(!(m<0)){var b=(-a+Math.sqrt(m))/(2*o);0<b&&b<1&&(t?this.addX(this.sumCubic(b,e,n,i,s)):this.addY(this.sumCubic(b,e,n,i,s)));var x=(-a-Math.sqrt(m))/(2*o);0<x&&x<1&&(t?this.addX(this.sumCubic(x,e,n,i,s)):this.addY(this.sumCubic(x,e,n,i,s)))}}addBezierCurve(t,e,n,i,s,a,o,A){this.addPoint(t,e),this.addPoint(o,A),this.bezierCurveAdd(!0,t,n,s,o),this.bezierCurveAdd(!1,e,i,a,A)}addQuadraticCurve(t,e,n,i,s,a){var o=t+.6666666666666666*(n-t),A=e+2/3*(i-e),f=o+1/3*(s-t),m=A+1/3*(a-e);this.addBezierCurve(t,e,o,f,A,m,s,a)}isPointInBox(t,e){var{x1:n,y1:i,x2:s,y2:a}=this;return n<=t&&t<=s&&i<=e&&e<=a}}class en extends Pe{constructor(t){super(t.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,"")),this.control=null,this.start=null,this.current=null,this.command=null,this.commands=this.commands,this.i=-1,this.previousCommand=null,this.points=[],this.angles=[]}reset(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new Gi(0,0),this.control=new Gi(0,0),this.current=new Gi(0,0),this.points=[],this.angles=[]}isEnd(){var{i:t,commands:e}=this;return t>=e.length-1}next(){var t=this.commands[++this.i];return this.previousCommand=this.command,this.command=t,t}getPoint(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"x",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"y",n=new Gi(this.command[t],this.command[e]);return this.makeAbsolute(n)}getAsControlPoint(t,e){var n=this.getPoint(t,e);return this.control=n,n}getAsCurrentPoint(t,e){var n=this.getPoint(t,e);return this.current=n,n}getReflectedControlPoint(){var t=this.previousCommand.type;if(t!==Pe.CURVE_TO&&t!==Pe.SMOOTH_CURVE_TO&&t!==Pe.QUAD_TO&&t!==Pe.SMOOTH_QUAD_TO)return this.current;var{current:{x:e,y:n},control:{x:i,y:s}}=this,a=new Gi(2*e-i,2*n-s);return a}makeAbsolute(t){if(this.command.relative){var{x:e,y:n}=this.current;t.x+=e,t.y+=n}return t}addMarker(t,e,n){var{points:i,angles:s}=this;n&&s.length>0&&!s[s.length-1]&&(s[s.length-1]=i[i.length-1].angleTo(n)),this.addMarkerAngle(t,e?e.angleTo(t):null)}addMarkerAngle(t,e){this.points.push(t),this.angles.push(e)}getMarkerPoints(){return this.points}getMarkerAngles(){for(var{angles:t}=this,e=t.length,n=0;n<e;n++)if(!t[n]){for(var i=n+1;i<e;i++)if(t[i]){t[n]=t[i];break}}return t}}class JA extends mi{constructor(){super(...arguments),this.modifiedEmSizeStack=!1}calculateOpacity(){for(var t=1,e=this;e;){var n=e.getStyle("opacity",!1,!0);n.hasValue(!0)&&(t*=n.getNumber()),e=e.parent}return t}setContext(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!e){var n=this.getStyle("fill"),i=this.getStyle("fill-opacity"),s=this.getStyle("stroke"),a=this.getStyle("stroke-opacity");if(n.isUrlDefinition()){var o=n.getFillStyleDefinition(this,i);o&&(t.fillStyle=o)}else if(n.hasValue()){n.getString()==="currentColor"&&n.setValue(this.getStyle("color").getColor());var A=n.getColor();A!=="inherit"&&(t.fillStyle=A==="none"?"rgba(0,0,0,0)":A)}if(i.hasValue()){var f=new Ur(this.document,"fill",t.fillStyle).addOpacity(i).getColor();t.fillStyle=f}if(s.isUrlDefinition()){var m=s.getFillStyleDefinition(this,a);m&&(t.strokeStyle=m)}else if(s.hasValue()){s.getString()==="currentColor"&&s.setValue(this.getStyle("color").getColor());var b=s.getString();b!=="inherit"&&(t.strokeStyle=b==="none"?"rgba(0,0,0,0)":b)}if(a.hasValue()){var x=new Ur(this.document,"stroke",t.strokeStyle).addOpacity(a).getString();t.strokeStyle=x}var C=this.getStyle("stroke-width");if(C.hasValue()){var M=C.getPixels();t.lineWidth=M||ad}var U=this.getStyle("stroke-linecap"),N=this.getStyle("stroke-linejoin"),Q=this.getStyle("stroke-miterlimit"),q=this.getStyle("stroke-dasharray"),Y=this.getStyle("stroke-dashoffset");if(U.hasValue()&&(t.lineCap=U.getString()),N.hasValue()&&(t.lineJoin=N.getString()),Q.hasValue()&&(t.miterLimit=Q.getNumber()),q.hasValue()&&q.getString()!=="none"){var tt=da(q.getString());typeof t.setLineDash<"u"?t.setLineDash(tt):typeof t.webkitLineDash<"u"?t.webkitLineDash=tt:typeof t.mozDash<"u"&&!(tt.length===1&&tt[0]===0)&&(t.mozDash=tt);var ft=Y.getPixels();typeof t.lineDashOffset<"u"?t.lineDashOffset=ft:typeof t.webkitLineDashOffset<"u"?t.webkitLineDashOffset=ft:typeof t.mozDashOffset<"u"&&(t.mozDashOffset=ft)}}if(this.modifiedEmSizeStack=!1,typeof t.font<"u"){var pt=this.getStyle("font"),mt=this.getStyle("font-style"),dt=this.getStyle("font-variant"),Rt=this.getStyle("font-weight"),Lt=this.getStyle("font-size"),st=this.getStyle("font-family"),ct=new yo(mt.getString(),dt.getString(),Rt.getString(),Lt.hasValue()?"".concat(Lt.getPixels(!0),"px"):"",st.getString(),yo.parse(pt.getString(),t.font));mt.setValue(ct.fontStyle),dt.setValue(ct.fontVariant),Rt.setValue(ct.fontWeight),Lt.setValue(ct.fontSize),st.setValue(ct.fontFamily),t.font=ct.toString(),Lt.isPixels()&&(this.document.emSize=Lt.getPixels(),this.modifiedEmSizeStack=!0)}e||(this.applyEffects(t),t.globalAlpha=this.calculateOpacity())}clearContext(t){super.clearContext(t),this.modifiedEmSizeStack&&this.document.popEmSize()}}class qn extends JA{constructor(t,e,n){super(t,e,n),this.type="path",this.pathParser=null,this.pathParser=new en(this.getAttribute("d").getString())}path(t){var{pathParser:e}=this,n=new hc;for(e.reset(),t&&t.beginPath();!e.isEnd();)switch(e.next().type){case en.MOVE_TO:this.pathM(t,n);break;case en.LINE_TO:this.pathL(t,n);break;case en.HORIZ_LINE_TO:this.pathH(t,n);break;case en.VERT_LINE_TO:this.pathV(t,n);break;case en.CURVE_TO:this.pathC(t,n);break;case en.SMOOTH_CURVE_TO:this.pathS(t,n);break;case en.QUAD_TO:this.pathQ(t,n);break;case en.SMOOTH_QUAD_TO:this.pathT(t,n);break;case en.ARC:this.pathA(t,n);break;case en.CLOSE_PATH:this.pathZ(t,n);break}return n}getBoundingBox(t){return this.path()}getMarkers(){var{pathParser:t}=this,e=t.getMarkerPoints(),n=t.getMarkerAngles(),i=e.map((s,a)=>[s,n[a]]);return i}renderChildren(t){this.path(t),this.document.screen.mouse.checkPath(this,t);var e=this.getStyle("fill-rule");t.fillStyle!==""&&(e.getString("inherit")!=="inherit"?t.fill(e.getString()):t.fill()),t.strokeStyle!==""&&(this.getAttribute("vector-effect").getString()==="non-scaling-stroke"?(t.save(),t.setTransform(1,0,0,1,0,0),t.stroke(),t.restore()):t.stroke());var n=this.getMarkers();if(n){var i=n.length-1,s=this.getStyle("marker-start"),a=this.getStyle("marker-mid"),o=this.getStyle("marker-end");if(s.isUrlDefinition()){var A=s.getDefinition(),[f,m]=n[0];A.render(t,f,m)}if(a.isUrlDefinition())for(var b=a.getDefinition(),x=1;x<i;x++){var[C,M]=n[x];b.render(t,C,M)}if(o.isUrlDefinition()){var U=o.getDefinition(),[N,Q]=n[i];U.render(t,N,Q)}}}static pathM(t){var e=t.getAsCurrentPoint();return t.start=t.current,{point:e}}pathM(t,e){var{pathParser:n}=this,{point:i}=qn.pathM(n),{x:s,y:a}=i;n.addMarker(i),e.addPoint(s,a),t&&t.moveTo(s,a)}static pathL(t){var{current:e}=t,n=t.getAsCurrentPoint();return{current:e,point:n}}pathL(t,e){var{pathParser:n}=this,{current:i,point:s}=qn.pathL(n),{x:a,y:o}=s;n.addMarker(s,i),e.addPoint(a,o),t&&t.lineTo(a,o)}static pathH(t){var{current:e,command:n}=t,i=new Gi((n.relative?e.x:0)+n.x,e.y);return t.current=i,{current:e,point:i}}pathH(t,e){var{pathParser:n}=this,{current:i,point:s}=qn.pathH(n),{x:a,y:o}=s;n.addMarker(s,i),e.addPoint(a,o),t&&t.lineTo(a,o)}static pathV(t){var{current:e,command:n}=t,i=new Gi(e.x,(n.relative?e.y:0)+n.y);return t.current=i,{current:e,point:i}}pathV(t,e){var{pathParser:n}=this,{current:i,point:s}=qn.pathV(n),{x:a,y:o}=s;n.addMarker(s,i),e.addPoint(a,o),t&&t.lineTo(a,o)}static pathC(t){var{current:e}=t,n=t.getPoint("x1","y1"),i=t.getAsControlPoint("x2","y2"),s=t.getAsCurrentPoint();return{current:e,point:n,controlPoint:i,currentPoint:s}}pathC(t,e){var{pathParser:n}=this,{current:i,point:s,controlPoint:a,currentPoint:o}=qn.pathC(n);n.addMarker(o,a,s),e.addBezierCurve(i.x,i.y,s.x,s.y,a.x,a.y,o.x,o.y),t&&t.bezierCurveTo(s.x,s.y,a.x,a.y,o.x,o.y)}static pathS(t){var{current:e}=t,n=t.getReflectedControlPoint(),i=t.getAsControlPoint("x2","y2"),s=t.getAsCurrentPoint();return{current:e,point:n,controlPoint:i,currentPoint:s}}pathS(t,e){var{pathParser:n}=this,{current:i,point:s,controlPoint:a,currentPoint:o}=qn.pathS(n);n.addMarker(o,a,s),e.addBezierCurve(i.x,i.y,s.x,s.y,a.x,a.y,o.x,o.y),t&&t.bezierCurveTo(s.x,s.y,a.x,a.y,o.x,o.y)}static pathQ(t){var{current:e}=t,n=t.getAsControlPoint("x1","y1"),i=t.getAsCurrentPoint();return{current:e,controlPoint:n,currentPoint:i}}pathQ(t,e){var{pathParser:n}=this,{current:i,controlPoint:s,currentPoint:a}=qn.pathQ(n);n.addMarker(a,s,s),e.addQuadraticCurve(i.x,i.y,s.x,s.y,a.x,a.y),t&&t.quadraticCurveTo(s.x,s.y,a.x,a.y)}static pathT(t){var{current:e}=t,n=t.getReflectedControlPoint();t.control=n;var i=t.getAsCurrentPoint();return{current:e,controlPoint:n,currentPoint:i}}pathT(t,e){var{pathParser:n}=this,{current:i,controlPoint:s,currentPoint:a}=qn.pathT(n);n.addMarker(a,s,s),e.addQuadraticCurve(i.x,i.y,s.x,s.y,a.x,a.y),t&&t.quadraticCurveTo(s.x,s.y,a.x,a.y)}static pathA(t){var{current:e,command:n}=t,{rX:i,rY:s,xRot:a,lArcFlag:o,sweepFlag:A}=n,f=a*(Math.PI/180),m=t.getAsCurrentPoint(),b=new Gi(Math.cos(f)*(e.x-m.x)/2+Math.sin(f)*(e.y-m.y)/2,-Math.sin(f)*(e.x-m.x)/2+Math.cos(f)*(e.y-m.y)/2),x=Math.pow(b.x,2)/Math.pow(i,2)+Math.pow(b.y,2)/Math.pow(s,2);x>1&&(i*=Math.sqrt(x),s*=Math.sqrt(x));var C=(o===A?-1:1)*Math.sqrt((Math.pow(i,2)*Math.pow(s,2)-Math.pow(i,2)*Math.pow(b.y,2)-Math.pow(s,2)*Math.pow(b.x,2))/(Math.pow(i,2)*Math.pow(b.y,2)+Math.pow(s,2)*Math.pow(b.x,2)));isNaN(C)&&(C=0);var M=new Gi(C*i*b.y/s,C*-s*b.x/i),U=new Gi((e.x+m.x)/2+Math.cos(f)*M.x-Math.sin(f)*M.y,(e.y+m.y)/2+Math.sin(f)*M.x+Math.cos(f)*M.y),N=NC([1,0],[(b.x-M.x)/i,(b.y-M.y)/s]),Q=[(b.x-M.x)/i,(b.y-M.y)/s],q=[(-b.x-M.x)/i,(-b.y-M.y)/s],Y=NC(Q,q);return A_(Q,q)<=-1&&(Y=Math.PI),A_(Q,q)>=1&&(Y=0),{currentPoint:m,rX:i,rY:s,sweepFlag:A,xAxisRotation:f,centp:U,a1:N,ad:Y}}pathA(t,e){var{pathParser:n}=this,{currentPoint:i,rX:s,rY:a,sweepFlag:o,xAxisRotation:A,centp:f,a1:m,ad:b}=qn.pathA(n),x=1-o?1:-1,C=m+x*(b/2),M=new Gi(f.x+s*Math.cos(C),f.y+a*Math.sin(C));if(n.addMarkerAngle(M,C-x*Math.PI/2),n.addMarkerAngle(i,C-x*Math.PI),e.addPoint(i.x,i.y),t&&!isNaN(m)&&!isNaN(b)){var U=s>a?s:a,N=s>a?1:s/a,Q=s>a?a/s:1;t.translate(f.x,f.y),t.rotate(A),t.scale(N,Q),t.arc(0,0,U,m,m+b,!!(1-o)),t.scale(1/N,1/Q),t.rotate(-A),t.translate(-f.x,-f.y)}}static pathZ(t){t.current=t.start}pathZ(t,e){qn.pathZ(this.pathParser),t&&e.x1!==e.x2&&e.y1!==e.y2&&t.closePath()}}class $C extends qn{constructor(t,e,n){super(t,e,n),this.type="glyph",this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber(),this.unicode=this.getAttribute("unicode").getString(),this.arabicForm=this.getAttribute("arabic-form").getString()}}class ju extends JA{constructor(t,e,n){super(t,e,new.target===ju?!0:n),this.type="text",this.x=0,this.y=0,this.measureCache=-1}setContext(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.setContext(t,e);var n=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();n&&(t.textBaseline=n)}initializeCoordinates(){this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY}getBoundingBox(t){if(this.type!=="text")return this.getTElementBoundingBox(t);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t);var e=null;return this.children.forEach((n,i)=>{var s=this.getChildBoundingBox(t,this,this,i);e?e.addBoundingBox(s):e=s}),e}getFontSize(){var{document:t,parent:e}=this,n=yo.parse(t.ctx.font).fontSize,i=e.getStyle("font-size").getNumber(n);return i}getTElementBoundingBox(t){var e=this.getFontSize();return new hc(this.x,this.y-e,this.x+this.measureText(t),this.y)}getGlyph(t,e,n){var i=e[n],s=null;if(t.isArabic){var a=e.length,o=e[n-1],A=e[n+1],f="isolated";if((n===0||o===" ")&&n<a-1&&A!==" "&&(f="terminal"),n>0&&o!==" "&&n<a-1&&A!==" "&&(f="medial"),n>0&&o!==" "&&(n===a-1||A===" ")&&(f="initial"),typeof t.glyphs[i]<"u"){var m=t.glyphs[i];s=m instanceof $C?m:m[f]}}else s=t.glyphs[i];return s||(s=t.missingGlyph),s}getText(){return""}getTextFromNode(t){var e=t||this.node,n=Array.from(e.parentNode.childNodes),i=n.indexOf(e),s=n.length-1,a=sd(e.textContent||"");return i===0&&(a=gD(a)),i===s&&(a=mD(a)),a}renderChildren(t){if(this.type!=="text"){this.renderTElementChildren(t);return}this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t),this.children.forEach((n,i)=>{this.renderChild(t,this,this,i)});var{mouse:e}=this.document.screen;e.isWorking()&&e.checkBoundingBox(this,this.getBoundingBox(t))}renderTElementChildren(t){var{document:e,parent:n}=this,i=this.getText(),s=n.getStyle("font-family").getDefinition();if(s){for(var{unitsPerEm:a}=s.fontFace,o=yo.parse(e.ctx.font),A=n.getStyle("font-size").getNumber(o.fontSize),f=n.getStyle("font-style").getString(o.fontStyle),m=A/a,b=s.isRTL?i.split("").reverse().join(""):i,x=da(n.getAttribute("dx").getString()),C=b.length,M=0;M<C;M++){var U=this.getGlyph(s,b,M);t.translate(this.x,this.y),t.scale(m,-m);var N=t.lineWidth;t.lineWidth=t.lineWidth*a/A,f==="italic"&&t.transform(1,0,.4,1,0,0),U.render(t),f==="italic"&&t.transform(1,0,-.4,1,0,0),t.lineWidth=N,t.scale(1/m,-1/m),t.translate(-this.x,-this.y),this.x+=A*(U.horizAdvX||s.horizAdvX)/a,typeof x[M]<"u"&&!isNaN(x[M])&&(this.x+=x[M])}return}var{x:Q,y:q}=this;t.fillStyle&&t.fillText(i,Q,q),t.strokeStyle&&t.strokeText(i,Q,q)}applyAnchoring(){if(!(this.textChunkStart>=this.leafTexts.length)){var t=this.leafTexts[this.textChunkStart],e=t.getStyle("text-anchor").getString("start"),n=!1,i=0;e==="start"&&!n||e==="end"&&n?i=t.x-this.minX:e==="end"&&!n||e==="start"&&n?i=t.x-this.maxX:i=t.x-(this.minX+this.maxX)/2;for(var s=this.textChunkStart;s<this.leafTexts.length;s++)this.leafTexts[s].x+=i;this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.textChunkStart=this.leafTexts.length}}adjustChildCoordinatesRecursive(t){this.children.forEach((e,n)=>{this.adjustChildCoordinatesRecursiveCore(t,this,this,n)}),this.applyAnchoring()}adjustChildCoordinatesRecursiveCore(t,e,n,i){var s=n.children[i];s.children.length>0?s.children.forEach((a,o)=>{e.adjustChildCoordinatesRecursiveCore(t,e,s,o)}):this.adjustChildCoordinates(t,e,n,i)}adjustChildCoordinates(t,e,n,i){var s=n.children[i];if(typeof s.measureText!="function")return s;t.save(),s.setContext(t,!0);var a=s.getAttribute("x"),o=s.getAttribute("y"),A=s.getAttribute("dx"),f=s.getAttribute("dy"),m=s.getStyle("font-family").getDefinition(),b=!!m&&m.isRTL;i===0&&(a.hasValue()||a.setValue(s.getInheritedAttribute("x")),o.hasValue()||o.setValue(s.getInheritedAttribute("y")),A.hasValue()||A.setValue(s.getInheritedAttribute("dx")),f.hasValue()||f.setValue(s.getInheritedAttribute("dy")));var x=s.measureText(t);return b&&(e.x-=x),a.hasValue()?(e.applyAnchoring(),s.x=a.getPixels("x"),A.hasValue()&&(s.x+=A.getPixels("x"))):(A.hasValue()&&(e.x+=A.getPixels("x")),s.x=e.x),e.x=s.x,b||(e.x+=x),o.hasValue()?(s.y=o.getPixels("y"),f.hasValue()&&(s.y+=f.getPixels("y"))):(f.hasValue()&&(e.y+=f.getPixels("y")),s.y=e.y),e.y=s.y,e.leafTexts.push(s),e.minX=Math.min(e.minX,s.x,s.x+x),e.maxX=Math.max(e.maxX,s.x,s.x+x),s.clearContext(t),t.restore(),s}getChildBoundingBox(t,e,n,i){var s=n.children[i];if(typeof s.getBoundingBox!="function")return null;var a=s.getBoundingBox(t);return a?(s.children.forEach((o,A)=>{var f=e.getChildBoundingBox(t,e,s,A);a.addBoundingBox(f)}),a):null}renderChild(t,e,n,i){var s=n.children[i];s.render(t),s.children.forEach((a,o)=>{e.renderChild(t,e,s,o)})}measureText(t){var{measureCache:e}=this;if(~e)return e;var n=this.getText(),i=this.measureTargetText(t,n);return this.measureCache=i,i}measureTargetText(t,e){if(!e.length)return 0;var{parent:n}=this,i=n.getStyle("font-family").getDefinition();if(i){for(var s=this.getFontSize(),a=i.isRTL?e.split("").reverse().join(""):e,o=da(n.getAttribute("dx").getString()),A=a.length,f=0,m=0;m<A;m++){var b=this.getGlyph(i,a,m);f+=(b.horizAdvX||i.horizAdvX)*s/i.fontFace.unitsPerEm,typeof o[m]<"u"&&!isNaN(o[m])&&(f+=o[m])}return f}if(!t.measureText)return e.length*10;t.save(),this.setContext(t,!0);var{width:x}=t.measureText(e);return this.clearContext(t),t.restore(),x}getInheritedAttribute(t){for(var e=this;e instanceof ju&&e.isFirstChild();){var n=e.parent.getAttribute(t);if(n.hasValue(!0))return n.getValue("0");e=e.parent}return null}}class mm extends ju{constructor(t,e,n){super(t,e,new.target===mm?!0:n),this.type="tspan",this.text=this.children.length>0?"":this.getTextFromNode()}getText(){return this.text}}class q1t extends mm{constructor(){super(...arguments),this.type="textNode"}}class np extends JA{constructor(){super(...arguments),this.type="svg",this.root=!1}setContext(t){var e,{document:n}=this,{screen:i,window:s}=n,a=t.canvas;if(i.setDefaults(t),a.style&&typeof t.font<"u"&&s&&typeof s.getComputedStyle<"u"){t.font=s.getComputedStyle(a).getPropertyValue("font");var o=new Ur(n,"fontSize",yo.parse(t.font).fontSize);o.hasValue()&&(n.rootEmSize=o.getPixels("y"),n.emSize=n.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);var{width:A,height:f}=i.viewPort;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");var m=this.getAttribute("refX"),b=this.getAttribute("refY"),x=this.getAttribute("viewBox"),C=x.hasValue()?da(x.getString()):null,M=!this.root&&this.getStyle("overflow").getValue("hidden")!=="visible",U=0,N=0,Q=0,q=0;C&&(U=C[0],N=C[1]),this.root||(A=this.getStyle("width").getPixels("x"),f=this.getStyle("height").getPixels("y"),this.type==="marker"&&(Q=U,q=N,U=0,N=0)),i.viewPort.setCurrent(A,f),this.node&&(!this.parent||((e=this.node.parentNode)===null||e===void 0?void 0:e.nodeName)==="foreignObject")&&this.getStyle("transform",!1,!0).hasValue()&&!this.getStyle("transform-origin",!1,!0).hasValue()&&this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),super.setContext(t),t.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),C&&(A=C[2],f=C[3]),n.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:i.viewPort.width,desiredWidth:A,height:i.viewPort.height,desiredHeight:f,minX:U,minY:N,refX:m.getValue(),refY:b.getValue(),clip:M,clipX:Q,clipY:q}),C&&(i.viewPort.removeCurrent(),i.viewPort.setCurrent(A,f))}clearContext(t){super.clearContext(t),this.document.screen.viewPort.removeCurrent()}resize(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getAttribute("width",!0),s=this.getAttribute("height",!0),a=this.getAttribute("viewBox"),o=this.getAttribute("style"),A=i.getNumber(0),f=s.getNumber(0);if(n)if(typeof n=="string")this.getAttribute("preserveAspectRatio",!0).setValue(n);else{var m=this.getAttribute("preserveAspectRatio");m.hasValue()&&m.setValue(m.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(i.setValue(t),s.setValue(e),a.hasValue()||a.setValue("0 0 ".concat(A||t," ").concat(f||e)),o.hasValue()){var b=this.getStyle("width"),x=this.getStyle("height");b.hasValue()&&b.setValue("".concat(t,"px")),x.hasValue()&&x.setValue("".concat(e,"px"))}}}class XC extends qn{constructor(){super(...arguments),this.type="rect"}path(t){var e=this.getAttribute("x").getPixels("x"),n=this.getAttribute("y").getPixels("y"),i=this.getStyle("width",!1,!0).getPixels("x"),s=this.getStyle("height",!1,!0).getPixels("y"),a=this.getAttribute("rx"),o=this.getAttribute("ry"),A=a.getPixels("x"),f=o.getPixels("y");if(a.hasValue()&&!o.hasValue()&&(f=A),o.hasValue()&&!a.hasValue()&&(A=f),A=Math.min(A,i/2),f=Math.min(f,s/2),t){var m=4*((Math.sqrt(2)-1)/3);t.beginPath(),s>0&&i>0&&(t.moveTo(e+A,n),t.lineTo(e+i-A,n),t.bezierCurveTo(e+i-A+m*A,n,e+i,n+f-m*f,e+i,n+f),t.lineTo(e+i,n+s-f),t.bezierCurveTo(e+i,n+s-f+m*f,e+i-A+m*A,n+s,e+i-A,n+s),t.lineTo(e+A,n+s),t.bezierCurveTo(e+A-m*A,n+s,e,n+s-f+m*f,e,n+s-f),t.lineTo(e,n+f),t.bezierCurveTo(e,n+f-m*f,e+A-m*A,n,e+A,n),t.closePath())}return new hc(e,n,e+i,n+s)}getMarkers(){return null}}class FD extends qn{constructor(){super(...arguments),this.type="circle"}path(t){var e=this.getAttribute("cx").getPixels("x"),n=this.getAttribute("cy").getPixels("y"),i=this.getAttribute("r").getPixels();return t&&i>0&&(t.beginPath(),t.arc(e,n,i,0,Math.PI*2,!1),t.closePath()),new hc(e-i,n-i,e+i,n+i)}getMarkers(){return null}}class MD extends qn{constructor(){super(...arguments),this.type="ellipse"}path(t){var e=4*((Math.sqrt(2)-1)/3),n=this.getAttribute("rx").getPixels("x"),i=this.getAttribute("ry").getPixels("y"),s=this.getAttribute("cx").getPixels("x"),a=this.getAttribute("cy").getPixels("y");return t&&n>0&&i>0&&(t.beginPath(),t.moveTo(s+n,a),t.bezierCurveTo(s+n,a+e*i,s+e*n,a+i,s,a+i),t.bezierCurveTo(s-e*n,a+i,s-n,a+e*i,s-n,a),t.bezierCurveTo(s-n,a-e*i,s-e*n,a-i,s,a-i),t.bezierCurveTo(s+e*n,a-i,s+n,a-e*i,s+n,a),t.closePath()),new hc(s-n,a-i,s+n,a+i)}getMarkers(){return null}}class PD extends qn{constructor(){super(...arguments),this.type="line"}getPoints(){return[new Gi(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new Gi(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}path(t){var[{x:e,y:n},{x:i,y:s}]=this.getPoints();return t&&(t.beginPath(),t.moveTo(e,n),t.lineTo(i,s)),new hc(e,n,i,s)}getMarkers(){var[t,e]=this.getPoints(),n=t.angleTo(e);return[[t,n],[e,n]]}}class YC extends qn{constructor(t,e,n){super(t,e,n),this.type="polyline",this.points=[],this.points=Gi.parsePath(this.getAttribute("points").getString())}path(t){var{points:e}=this,[{x:n,y:i}]=e,s=new hc(n,i);return t&&(t.beginPath(),t.moveTo(n,i)),e.forEach(a=>{var{x:o,y:A}=a;s.addPoint(o,A),t&&t.lineTo(o,A)}),s}getMarkers(){var{points:t}=this,e=t.length-1,n=[];return t.forEach((i,s)=>{s!==e&&n.push([i,i.angleTo(t[s+1])])}),n.length>0&&n.push([t[t.length-1],n[n.length-1][1]]),n}}class UD extends YC{constructor(){super(...arguments),this.type="polygon"}path(t){var e=super.path(t),[{x:n,y:i}]=this.points;return t&&(t.lineTo(n,i),t.closePath()),e}}class RD extends mi{constructor(){super(...arguments),this.type="pattern"}createPattern(t,e,n){var i=this.getStyle("width").getPixels("x",!0),s=this.getStyle("height").getPixels("y",!0),a=new np(this.document,null);a.attributes.viewBox=new Ur(this.document,"viewBox",this.getAttribute("viewBox").getValue()),a.attributes.width=new Ur(this.document,"width","".concat(i,"px")),a.attributes.height=new Ur(this.document,"height","".concat(s,"px")),a.attributes.transform=new Ur(this.document,"transform",this.getAttribute("patternTransform").getValue()),a.children=this.children;var o=this.document.createCanvas(i,s),A=o.getContext("2d"),f=this.getAttribute("x"),m=this.getAttribute("y");f.hasValue()&&m.hasValue()&&A.translate(f.getPixels("x",!0),m.getPixels("y",!0)),n.hasValue()?this.styles["fill-opacity"]=n:Reflect.deleteProperty(this.styles,"fill-opacity");for(var b=-1;b<=1;b++)for(var x=-1;x<=1;x++)A.save(),a.attributes.x=new Ur(this.document,"x",b*o.width),a.attributes.y=new Ur(this.document,"y",x*o.height),a.render(A),A.restore();var C=t.createPattern(o,"repeat");return C}}class OD extends mi{constructor(){super(...arguments),this.type="marker"}render(t,e,n){if(e){var{x:i,y:s}=e,a=this.getAttribute("orient").getString("auto"),o=this.getAttribute("markerUnits").getString("strokeWidth");t.translate(i,s),a==="auto"&&t.rotate(n),o==="strokeWidth"&&t.scale(t.lineWidth,t.lineWidth),t.save();var A=new np(this.document,null);A.type=this.type,A.attributes.viewBox=new Ur(this.document,"viewBox",this.getAttribute("viewBox").getValue()),A.attributes.refX=new Ur(this.document,"refX",this.getAttribute("refX").getValue()),A.attributes.refY=new Ur(this.document,"refY",this.getAttribute("refY").getValue()),A.attributes.width=new Ur(this.document,"width",this.getAttribute("markerWidth").getValue()),A.attributes.height=new Ur(this.document,"height",this.getAttribute("markerHeight").getValue()),A.attributes.overflow=new Ur(this.document,"overflow",this.getAttribute("overflow").getValue()),A.attributes.fill=new Ur(this.document,"fill",this.getAttribute("fill").getColor("black")),A.attributes.stroke=new Ur(this.document,"stroke",this.getAttribute("stroke").getValue("none")),A.children=this.children,A.render(t),t.restore(),o==="strokeWidth"&&t.scale(1/t.lineWidth,1/t.lineWidth),a==="auto"&&t.rotate(-n),t.translate(-i,-s)}}}class DD extends mi{constructor(){super(...arguments),this.type="defs"}render(){}}class d_ extends JA{constructor(){super(...arguments),this.type="g"}getBoundingBox(t){var e=new hc;return this.children.forEach(n=>{e.addBoundingBox(n.getBoundingBox(t))}),e}}class JC extends mi{constructor(t,e,n){super(t,e,n),this.attributesToInherit=["gradientUnits"],this.stops=[];var{stops:i,children:s}=this;s.forEach(a=>{a.type==="stop"&&i.push(a)})}getGradientUnits(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}createGradient(t,e,n){var i=this;this.getHrefAttribute().hasValue()&&(i=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(i));var{stops:s}=i,a=this.getGradient(t,e);if(!a)return this.addParentOpacity(n,s[s.length-1].color);if(s.forEach(N=>{a.addColorStop(N.offset,this.addParentOpacity(n,N.color))}),this.getAttribute("gradientTransform").hasValue()){var{document:o}=this,{MAX_VIRTUAL_PIXELS:A,viewPort:f}=o.screen,[m]=f.viewPorts,b=new XC(o,null);b.attributes.x=new Ur(o,"x",-A/3),b.attributes.y=new Ur(o,"y",-A/3),b.attributes.width=new Ur(o,"width",A),b.attributes.height=new Ur(o,"height",A);var x=new d_(o,null);x.attributes.transform=new Ur(o,"transform",this.getAttribute("gradientTransform").getValue()),x.children=[b];var C=new np(o,null);C.attributes.x=new Ur(o,"x",0),C.attributes.y=new Ur(o,"y",0),C.attributes.width=new Ur(o,"width",m.width),C.attributes.height=new Ur(o,"height",m.height),C.children=[x];var M=o.createCanvas(m.width,m.height),U=M.getContext("2d");return U.fillStyle=a,C.render(U),U.createPattern(M,"no-repeat")}return a}inheritStopContainer(t){this.attributesToInherit.forEach(e=>{!this.getAttribute(e).hasValue()&&t.getAttribute(e).hasValue()&&this.getAttribute(e,!0).setValue(t.getAttribute(e).getValue())})}addParentOpacity(t,e){if(t.hasValue()){var n=new Ur(this.document,"color",e);return n.addOpacity(t).getColor()}return e}}class kD extends JC{constructor(t,e,n){super(t,e,n),this.type="linearGradient",this.attributesToInherit.push("x1","y1","x2","y2")}getGradient(t,e){var n=this.getGradientUnits()==="objectBoundingBox",i=n?e.getBoundingBox(t):null;if(n&&!i)return null;!this.getAttribute("x1").hasValue()&&!this.getAttribute("y1").hasValue()&&!this.getAttribute("x2").hasValue()&&!this.getAttribute("y2").hasValue()&&(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));var s=n?i.x+i.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),a=n?i.y+i.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),o=n?i.x+i.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),A=n?i.y+i.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return s===o&&a===A?null:t.createLinearGradient(s,a,o,A)}}class ND extends JC{constructor(t,e,n){super(t,e,n),this.type="radialGradient",this.attributesToInherit.push("cx","cy","r","fx","fy","fr")}getGradient(t,e){var n=this.getGradientUnits()==="objectBoundingBox",i=e.getBoundingBox(t);if(n&&!i)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");var s=n?i.x+i.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),a=n?i.y+i.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y"),o=s,A=a;this.getAttribute("fx").hasValue()&&(o=n?i.x+i.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(A=n?i.y+i.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));var f=n?(i.width+i.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),m=this.getAttribute("fr").getPixels();return t.createRadialGradient(o,A,m,s,a,f)}}class QD extends mi{constructor(t,e,n){super(t,e,n),this.type="stop";var i=Math.max(0,Math.min(1,this.getAttribute("offset").getNumber())),s=this.getStyle("stop-opacity"),a=this.getStyle("stop-color",!0);a.getString()===""&&a.setValue("#000"),s.hasValue()&&(a=a.addOpacity(s)),this.offset=i,this.color=a.getColor()}}class f_ extends mi{constructor(t,e,n){super(t,e,n),this.type="animate",this.duration=0,this.initialValue=null,this.initialUnits="",this.removed=!1,this.frozen=!1,t.screen.animations.push(this),this.begin=this.getAttribute("begin").getMilliseconds(),this.maxDuration=this.begin+this.getAttribute("dur").getMilliseconds(),this.from=this.getAttribute("from"),this.to=this.getAttribute("to"),this.values=new Ur(t,"values",null);var i=this.getAttribute("values");i.hasValue()&&this.values.setValue(i.getString().split(";"))}getProperty(){var t=this.getAttribute("attributeType").getString(),e=this.getAttribute("attributeName").getString();return t==="CSS"?this.parent.getStyle(e,!0):this.parent.getAttribute(e,!0)}calcValue(){var{initialUnits:t}=this,{progress:e,from:n,to:i}=this.getProgress(),s=n.getNumber()+(i.getNumber()-n.getNumber())*e;return t==="%"&&(s*=100),"".concat(s).concat(t)}update(t){var{parent:e}=this,n=this.getProperty();if(this.initialValue||(this.initialValue=n.getString(),this.initialUnits=n.getUnits()),this.duration>this.maxDuration){var i=this.getAttribute("fill").getString("remove");if(this.getAttribute("repeatCount").getString()==="indefinite"||this.getAttribute("repeatDur").getString()==="indefinite")this.duration=0;else if(i==="freeze"&&!this.frozen)this.frozen=!0,e.animationFrozen=!0,e.animationFrozenValue=n.getString();else if(i==="remove"&&!this.removed)return this.removed=!0,n.setValue(e.animationFrozen?e.animationFrozenValue:this.initialValue),!0;return!1}this.duration+=t;var s=!1;if(this.begin<this.duration){var a=this.calcValue(),o=this.getAttribute("type");if(o.hasValue()){var A=o.getString();a="".concat(A,"(").concat(a,")")}n.setValue(a),s=!0}return s}getProgress(){var{document:t,values:e}=this,n={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(e.hasValue()){var i=n.progress*(e.getValue().length-1),s=Math.floor(i),a=Math.ceil(i);n.from=new Ur(t,"from",parseFloat(e.getValue()[s])),n.to=new Ur(t,"to",parseFloat(e.getValue()[a])),n.progress=(i-s)/(a-s)}else n.from=this.from,n.to=this.to;return n}}class HD extends f_{constructor(){super(...arguments),this.type="animateColor"}calcValue(){var{progress:t,from:e,to:n}=this.getProgress(),i=new MC(e.getColor()),s=new MC(n.getColor());if(i.ok&&s.ok){var a=i.r+(s.r-i.r)*t,o=i.g+(s.g-i.g)*t,A=i.b+(s.b-i.b)*t;return"rgb(".concat(Math.floor(a),", ").concat(Math.floor(o),", ").concat(Math.floor(A),")")}return this.getAttribute("from").getColor()}}class zD extends f_{constructor(){super(...arguments),this.type="animateTransform"}calcValue(){var{progress:t,from:e,to:n}=this.getProgress(),i=da(e.getString()),s=da(n.getString()),a=i.map((o,A)=>{var f=s[A];return o+(f-o)*t}).join(" ");return a}}class GD extends mi{constructor(t,e,n){super(t,e,n),this.type="font",this.glyphs={},this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber();var{definitions:i}=t,{children:s}=this;for(var a of s)switch(a.type){case"font-face":{this.fontFace=a;var o=a.getStyle("font-family");o.hasValue()&&(i[o.getString()]=this);break}case"missing-glyph":this.missingGlyph=a;break;case"glyph":{var A=a;A.arabicForm?(this.isRTL=!0,this.isArabic=!0,typeof this.glyphs[A.unicode]>"u"&&(this.glyphs[A.unicode]={}),this.glyphs[A.unicode][A.arabicForm]=A):this.glyphs[A.unicode]=A;break}}}render(){}}class VD extends mi{constructor(t,e,n){super(t,e,n),this.type="font-face",this.ascent=this.getAttribute("ascent").getNumber(),this.descent=this.getAttribute("descent").getNumber(),this.unitsPerEm=this.getAttribute("units-per-em").getNumber()}}class jD extends qn{constructor(){super(...arguments),this.type="missing-glyph",this.horizAdvX=0}}class qD extends ju{constructor(){super(...arguments),this.type="tref"}getText(){var t=this.getHrefAttribute().getDefinition();if(t){var e=t.children[0];if(e)return e.getText()}return""}}class KD extends ju{constructor(t,e,n){super(t,e,n),this.type="a";var{childNodes:i}=e,s=i[0],a=i.length>0&&Array.from(i).every(o=>o.nodeType===3);this.hasText=a,this.text=a?this.getTextFromNode(s):""}getText(){return this.text}renderChildren(t){if(this.hasText){super.renderChildren(t);var{document:e,x:n,y:i}=this,{mouse:s}=e.screen,a=new Ur(e,"fontSize",yo.parse(e.ctx.font).fontSize);s.isWorking()&&s.checkBoundingBox(this,new hc(n,i-a.getPixels("y"),n+this.measureText(t),i))}else if(this.children.length>0){var o=new d_(this.document,null);o.children=this.children,o.parent=this,o.render(t)}}onClick(){var{window:t}=this.document;t&&t.open(this.getHrefAttribute().getString())}onMouseMove(){var t=this.document.ctx;t.canvas.style.cursor="pointer"}}function WD(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),e.push.apply(e,n)}return e}function p_(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?WD(Object(e),!0).forEach(function(n){BC(r,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):WD(Object(e)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))})}return r}class $D extends ju{constructor(t,e,n){super(t,e,n),this.type="textPath",this.textWidth=0,this.textHeight=0,this.pathLength=-1,this.glyphInfo=null,this.letterSpacingCache=[],this.measuresCache=new Map([["",0]]);var i=this.getHrefAttribute().getDefinition();this.text=this.getTextFromNode(),this.dataArray=this.parsePathData(i)}getText(){return this.text}path(t){var{dataArray:e}=this;t&&t.beginPath(),e.forEach(n=>{var{type:i,points:s}=n;switch(i){case en.LINE_TO:t&&t.lineTo(s[0],s[1]);break;case en.MOVE_TO:t&&t.moveTo(s[0],s[1]);break;case en.CURVE_TO:t&&t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case en.QUAD_TO:t&&t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case en.ARC:{var[a,o,A,f,m,b,x,C]=s,M=A>f?A:f,U=A>f?1:A/f,N=A>f?f/A:1;t&&(t.translate(a,o),t.rotate(x),t.scale(U,N),t.arc(0,0,M,m,m+b,!!(1-C)),t.scale(1/U,1/N),t.rotate(-x),t.translate(-a,-o));break}case en.CLOSE_PATH:t&&t.closePath();break}})}renderChildren(t){this.setTextData(t),t.save();var e=this.parent.getStyle("text-decoration").getString(),n=this.getFontSize(),{glyphInfo:i}=this,s=t.fillStyle;e==="underline"&&t.beginPath(),i.forEach((a,o)=>{var{p0:A,p1:f,rotation:m,text:b}=a;t.save(),t.translate(A.x,A.y),t.rotate(m),t.fillStyle&&t.fillText(b,0,0),t.strokeStyle&&t.strokeText(b,0,0),t.restore(),e==="underline"&&(o===0&&t.moveTo(A.x,A.y+n/8),t.lineTo(f.x,f.y+n/5))}),e==="underline"&&(t.lineWidth=n/20,t.strokeStyle=s,t.stroke(),t.closePath()),t.restore()}getLetterSpacingAt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.letterSpacingCache[t]||0}findSegmentToFitChar(t,e,n,i,s,a,o,A,f){var m=a,b=this.measureText(t,A);A===" "&&e==="justify"&&n<i&&(b+=(i-n)/s),f>-1&&(m+=this.getLetterSpacingAt(f));var x=this.textHeight/20,C=this.getEquidistantPointOnPath(m,x,0),M=this.getEquidistantPointOnPath(m+b,x,0),U={p0:C,p1:M},N=C&&M?Math.atan2(M.y-C.y,M.x-C.x):0;if(o){var Q=Math.cos(Math.PI/2+N)*o,q=Math.cos(-N)*o;U.p0=p_(p_({},C),{},{x:C.x+Q,y:C.y+q}),U.p1=p_(p_({},M),{},{x:M.x+Q,y:M.y+q})}return m+=b,{offset:m,segment:U,rotation:N}}measureText(t,e){var{measuresCache:n}=this,i=e||this.getText();if(n.has(i))return n.get(i);var s=this.measureTargetText(t,i);return n.set(i,s),s}setTextData(t){if(!this.glyphInfo){var e=this.getText(),n=e.split(""),i=e.split(" ").length-1,s=this.parent.getAttribute("dx").split().map(tt=>tt.getPixels("x")),a=this.parent.getAttribute("dy").getPixels("y"),o=this.parent.getStyle("text-anchor").getString("start"),A=this.getStyle("letter-spacing"),f=this.parent.getStyle("letter-spacing"),m=0;!A.hasValue()||A.getValue()==="inherit"?m=f.getPixels():A.hasValue()&&A.getValue()!=="initial"&&A.getValue()!=="unset"&&(m=A.getPixels());var b=[],x=e.length;this.letterSpacingCache=b;for(var C=0;C<x;C++)b.push(typeof s[C]<"u"?s[C]:m);var M=b.reduce((tt,ft,pt)=>pt===0?0:tt+ft||0,0),U=this.measureText(t),N=Math.max(U+M,0);this.textWidth=U,this.textHeight=this.getFontSize(),this.glyphInfo=[];var Q=this.getPathLength(),q=this.getStyle("startOffset").getNumber(0)*Q,Y=0;(o==="middle"||o==="center")&&(Y=-N/2),(o==="end"||o==="right")&&(Y=-N),Y+=q,n.forEach((tt,ft)=>{var{offset:pt,segment:mt,rotation:dt}=this.findSegmentToFitChar(t,o,N,Q,i,Y,a,tt,ft);Y=pt,!(!mt.p0||!mt.p1)&&this.glyphInfo.push({text:n[ft],p0:mt.p0,p1:mt.p1,rotation:dt})})}}parsePathData(t){if(this.pathLength=-1,!t)return[];var e=[],{pathParser:n}=t;for(n.reset();!n.isEnd();){var{current:i}=n,s=i?i.x:0,a=i?i.y:0,o=n.next(),A=o.type,f=[];switch(o.type){case en.MOVE_TO:this.pathM(n,f);break;case en.LINE_TO:A=this.pathL(n,f);break;case en.HORIZ_LINE_TO:A=this.pathH(n,f);break;case en.VERT_LINE_TO:A=this.pathV(n,f);break;case en.CURVE_TO:this.pathC(n,f);break;case en.SMOOTH_CURVE_TO:A=this.pathS(n,f);break;case en.QUAD_TO:this.pathQ(n,f);break;case en.SMOOTH_QUAD_TO:A=this.pathT(n,f);break;case en.ARC:f=this.pathA(n);break;case en.CLOSE_PATH:qn.pathZ(n);break}o.type!==en.CLOSE_PATH?e.push({type:A,points:f,start:{x:s,y:a},pathLength:this.calcLength(s,a,A,f)}):e.push({type:en.CLOSE_PATH,points:[],pathLength:0})}return e}pathM(t,e){var{x:n,y:i}=qn.pathM(t).point;e.push(n,i)}pathL(t,e){var{x:n,y:i}=qn.pathL(t).point;return e.push(n,i),en.LINE_TO}pathH(t,e){var{x:n,y:i}=qn.pathH(t).point;return e.push(n,i),en.LINE_TO}pathV(t,e){var{x:n,y:i}=qn.pathV(t).point;return e.push(n,i),en.LINE_TO}pathC(t,e){var{point:n,controlPoint:i,currentPoint:s}=qn.pathC(t);e.push(n.x,n.y,i.x,i.y,s.x,s.y)}pathS(t,e){var{point:n,controlPoint:i,currentPoint:s}=qn.pathS(t);return e.push(n.x,n.y,i.x,i.y,s.x,s.y),en.CURVE_TO}pathQ(t,e){var{controlPoint:n,currentPoint:i}=qn.pathQ(t);e.push(n.x,n.y,i.x,i.y)}pathT(t,e){var{controlPoint:n,currentPoint:i}=qn.pathT(t);return e.push(n.x,n.y,i.x,i.y),en.QUAD_TO}pathA(t){var{rX:e,rY:n,sweepFlag:i,xAxisRotation:s,centp:a,a1:o,ad:A}=qn.pathA(t);return i===0&&A>0&&(A-=2*Math.PI),i===1&&A<0&&(A+=2*Math.PI),[a.x,a.y,e,n,o,A,s,i]}calcLength(t,e,n,i){var s=0,a=null,o=null,A=0;switch(n){case en.LINE_TO:return this.getLineLength(t,e,i[0],i[1]);case en.CURVE_TO:for(s=0,a=this.getPointOnCubicBezier(0,t,e,i[0],i[1],i[2],i[3],i[4],i[5]),A=.01;A<=1;A+=.01)o=this.getPointOnCubicBezier(A,t,e,i[0],i[1],i[2],i[3],i[4],i[5]),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return s;case en.QUAD_TO:for(s=0,a=this.getPointOnQuadraticBezier(0,t,e,i[0],i[1],i[2],i[3]),A=.01;A<=1;A+=.01)o=this.getPointOnQuadraticBezier(A,t,e,i[0],i[1],i[2],i[3]),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return s;case en.ARC:{s=0;var f=i[4],m=i[5],b=i[4]+m,x=Math.PI/180;if(Math.abs(f-b)<x&&(x=Math.abs(f-b)),a=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],f,0),m<0)for(A=f-x;A>b;A-=x)o=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],A,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;else for(A=f+x;A<b;A+=x)o=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],A,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return o=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],b,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),s}}return 0}getPointOnLine(t,e,n,i,s){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:e,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:n,A=(s-n)/(i-e+ad),f=Math.sqrt(t*t/(1+A*A));i<e&&(f*=-1);var m=A*f,b=null;if(i===e)b={x:a,y:o+m};else if((o-n)/(a-e+ad)===A)b={x:a+f,y:o+m};else{var x=0,C=0,M=this.getLineLength(e,n,i,s);if(M<ad)return null;var U=(a-e)*(i-e)+(o-n)*(s-n);U/=M*M,x=e+U*(i-e),C=n+U*(s-n);var N=this.getLineLength(a,o,x,C),Q=Math.sqrt(t*t-N*N);f=Math.sqrt(Q*Q/(1+A*A)),i<e&&(f*=-1),m=A*f,b={x:x+f,y:C+m}}return b}getPointOnPath(t){var e=this.getPathLength(),n=0,i=null;if(t<-5e-5||t-5e-5>e)return null;var{dataArray:s}=this;for(var a of s){if(a&&(a.pathLength<5e-5||n+a.pathLength+5e-5<t)){n+=a.pathLength;continue}var o=t-n,A=0;switch(a.type){case en.LINE_TO:i=this.getPointOnLine(o,a.start.x,a.start.y,a.points[0],a.points[1],a.start.x,a.start.y);break;case en.ARC:{var f=a.points[4],m=a.points[5],b=a.points[4]+m;if(A=f+o/a.pathLength*m,m<0&&A<b||m>=0&&A>b)break;i=this.getPointOnEllipticalArc(a.points[0],a.points[1],a.points[2],a.points[3],A,a.points[6]);break}case en.CURVE_TO:A=o/a.pathLength,A>1&&(A=1),i=this.getPointOnCubicBezier(A,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3],a.points[4],a.points[5]);break;case en.QUAD_TO:A=o/a.pathLength,A>1&&(A=1),i=this.getPointOnQuadraticBezier(A,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3]);break}if(i)return i;break}return null}getLineLength(t,e,n,i){return Math.sqrt((n-t)*(n-t)+(i-e)*(i-e))}getPathLength(){return this.pathLength===-1&&(this.pathLength=this.dataArray.reduce((t,e)=>e.pathLength>0?t+e.pathLength:t,0)),this.pathLength}getPointOnCubicBezier(t,e,n,i,s,a,o,A,f){var m=A*QC(t)+a*HC(t)+i*zC(t)+e*GC(t),b=f*QC(t)+o*HC(t)+s*zC(t)+n*GC(t);return{x:m,y:b}}getPointOnQuadraticBezier(t,e,n,i,s,a,o){var A=a*VC(t)+i*jC(t)+e*qC(t),f=o*VC(t)+s*jC(t)+n*qC(t);return{x:A,y:f}}getPointOnEllipticalArc(t,e,n,i,s,a){var o=Math.cos(a),A=Math.sin(a),f={x:n*Math.cos(s),y:i*Math.sin(s)};return{x:t+(f.x*o-f.y*A),y:e+(f.x*A+f.y*o)}}buildEquidistantCache(t,e){var n=this.getPathLength(),i=e||.25,s=t||n/100;if(!this.equidistantCache||this.equidistantCache.step!==s||this.equidistantCache.precision!==i){this.equidistantCache={step:s,precision:i,points:[]};for(var a=0,o=0;o<=n;o+=i){var A=this.getPointOnPath(o),f=this.getPointOnPath(o+i);!A||!f||(a+=this.getLineLength(A.x,A.y,f.x,f.y),a>=s&&(this.equidistantCache.points.push({x:A.x,y:A.y,distance:o}),a-=s))}}}getEquidistantPointOnPath(t,e,n){if(this.buildEquidistantCache(e,n),t<0||t-this.getPathLength()>5e-5)return null;var i=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[i]||null}}var K1t=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i;class XD extends JA{constructor(t,e,n){super(t,e,n),this.type="image",this.loaded=!1;var i=this.getHrefAttribute().getString();if(i){var s=i.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(i);t.images.push(this),s?this.loadSvg(i):this.loadImage(i),this.isSvg=s}}loadImage(t){var e=this;return zu(function*(){try{var n=yield e.document.createImage(t);e.image=n}catch(i){console.error('Error while loading image "'.concat(t,'":'),i)}e.loaded=!0})()}loadSvg(t){var e=this;return zu(function*(){var n=K1t.exec(t);if(n){var i=n[5];n[4]==="base64"?e.image=atob(i):e.image=decodeURIComponent(i)}else try{var s=yield e.document.fetch(t),a=yield s.text();e.image=a}catch(o){console.error('Error while loading image "'.concat(t,'":'),o)}e.loaded=!0})()}renderChildren(t){var{document:e,image:n,loaded:i}=this,s=this.getAttribute("x").getPixels("x"),a=this.getAttribute("y").getPixels("y"),o=this.getStyle("width").getPixels("x"),A=this.getStyle("height").getPixels("y");if(!(!i||!n||!o||!A)){if(t.save(),t.translate(s,a),this.isSvg){var f=e.canvg.forkString(t,this.image,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:o,scaleHeight:A});f.document.documentElement.parent=this,f.render()}else{var m=this.image;e.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:o,desiredWidth:m.width,height:A,desiredHeight:m.height}),this.loaded&&(typeof m.complete>"u"||m.complete)&&t.drawImage(m,0,0)}t.restore()}}getBoundingBox(){var t=this.getAttribute("x").getPixels("x"),e=this.getAttribute("y").getPixels("y"),n=this.getStyle("width").getPixels("x"),i=this.getStyle("height").getPixels("y");return new hc(t,e,t+n,e+i)}}class YD extends JA{constructor(){super(...arguments),this.type="symbol"}render(t){}}class JD{constructor(t){this.document=t,this.loaded=!1,t.fonts.push(this)}load(t,e){var n=this;return zu(function*(){try{var{document:i}=n,s=yield i.canvg.parser.load(e),a=s.getElementsByTagName("font");Array.from(a).forEach(o=>{var A=i.createElement(o);i.definitions[t]=A})}catch(o){console.error('Error while loading font "'.concat(e,'":'),o)}n.loaded=!0})()}}class ZC extends mi{constructor(t,e,n){super(t,e,n),this.type="style";var i=sd(Array.from(e.childNodes).map(a=>a.textContent).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,"")),s=i.split("}");s.forEach(a=>{var o=a.trim();if(o){var A=o.split("{"),f=A[0].split(","),m=A[1].split(";");f.forEach(b=>{var x=b.trim();if(x){var C=t.styles[x]||{};if(m.forEach(N=>{var Q=N.indexOf(":"),q=N.substr(0,Q).trim(),Y=N.substr(Q+1,N.length-Q).trim();q&&Y&&(C[q]=new Ur(t,q,Y))}),t.styles[x]=C,t.stylesSpecificity[x]=vD(x),x==="@font-face"){var M=C["font-family"].getString().replace(/"|'/g,""),U=C.src.getString().split(",");U.forEach(N=>{if(N.indexOf('format("svg")')>0){var Q=DC(N);Q&&new JD(t).load(M,Q)}})}}})}})}}ZC.parseExternalUrl=DC;class ZD extends JA{constructor(){super(...arguments),this.type="use"}setContext(t){super.setContext(t);var e=this.getAttribute("x"),n=this.getAttribute("y");e.hasValue()&&t.translate(e.getPixels("x"),0),n.hasValue()&&t.translate(0,n.getPixels("y"))}path(t){var{element:e}=this;e&&e.path(t)}renderChildren(t){var{document:e,element:n}=this;if(n){var i=n;if(n.type==="symbol"&&(i=new np(e,null),i.attributes.viewBox=new Ur(e,"viewBox",n.getAttribute("viewBox").getString()),i.attributes.preserveAspectRatio=new Ur(e,"preserveAspectRatio",n.getAttribute("preserveAspectRatio").getString()),i.attributes.overflow=new Ur(e,"overflow",n.getAttribute("overflow").getString()),i.children=n.children,n.styles.opacity=new Ur(e,"opacity",this.calculateOpacity())),i.type==="svg"){var s=this.getStyle("width",!1,!0),a=this.getStyle("height",!1,!0);s.hasValue()&&(i.attributes.width=new Ur(e,"width",s.getString())),a.hasValue()&&(i.attributes.height=new Ur(e,"height",a.getString()))}var o=i.parent;i.parent=this,i.render(t),i.parent=o}}getBoundingBox(t){var{element:e}=this;return e?e.getBoundingBox(t):null}elementTransform(){var{document:t,element:e}=this;return YA.fromElement(t,e)}get element(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}}function g_(r,t,e,n,i,s){return r[e*n*4+t*4+s]}function m_(r,t,e,n,i,s,a){r[e*n*4+t*4+s]=a}function ys(r,t,e){var n=r[t];return n*e}function qu(r,t,e,n){return t+Math.cos(r)*e+Math.sin(r)*n}class tE extends mi{constructor(t,e,n){super(t,e,n),this.type="feColorMatrix";var i=da(this.getAttribute("values").getString());switch(this.getAttribute("type").getString("matrix")){case"saturate":{var s=i[0];i=[.213+.787*s,.715-.715*s,.072-.072*s,0,0,.213-.213*s,.715+.285*s,.072-.072*s,0,0,.213-.213*s,.715-.715*s,.072+.928*s,0,0,0,0,0,1,0,0,0,0,0,1];break}case"hueRotate":{var a=i[0]*Math.PI/180;i=[qu(a,.213,.787,-.213),qu(a,.715,-.715,-.715),qu(a,.072,-.072,.928),0,0,qu(a,.213,-.213,.143),qu(a,.715,.285,.14),qu(a,.072,-.072,-.283),0,0,qu(a,.213,-.213,-.787),qu(a,.715,-.715,.715),qu(a,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break}case"luminanceToAlpha":i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1];break}this.matrix=i,this.includeOpacity=this.getAttribute("includeOpacity").hasValue()}apply(t,e,n,i,s){for(var{includeOpacity:a,matrix:o}=this,A=t.getImageData(0,0,i,s),f=0;f<s;f++)for(var m=0;m<i;m++){var b=g_(A.data,m,f,i,s,0),x=g_(A.data,m,f,i,s,1),C=g_(A.data,m,f,i,s,2),M=g_(A.data,m,f,i,s,3),U=ys(o,0,b)+ys(o,1,x)+ys(o,2,C)+ys(o,3,M)+ys(o,4,1),N=ys(o,5,b)+ys(o,6,x)+ys(o,7,C)+ys(o,8,M)+ys(o,9,1),Q=ys(o,10,b)+ys(o,11,x)+ys(o,12,C)+ys(o,13,M)+ys(o,14,1),q=ys(o,15,b)+ys(o,16,x)+ys(o,17,C)+ys(o,18,M)+ys(o,19,1);a&&(U=0,N=0,Q=0,q*=M/255),m_(A.data,m,f,i,s,0,U),m_(A.data,m,f,i,s,1,N),m_(A.data,m,f,i,s,2,Q),m_(A.data,m,f,i,s,3,q)}t.clearRect(0,0,i,s),t.putImageData(A,0,0)}}class ym extends mi{constructor(){super(...arguments),this.type="mask"}apply(t,e){var{document:n}=this,i=this.getAttribute("x").getPixels("x"),s=this.getAttribute("y").getPixels("y"),a=this.getStyle("width").getPixels("x"),o=this.getStyle("height").getPixels("y");if(!a&&!o){var A=new hc;this.children.forEach(M=>{A.addBoundingBox(M.getBoundingBox(t))}),i=Math.floor(A.x1),s=Math.floor(A.y1),a=Math.floor(A.width),o=Math.floor(A.height)}var f=this.removeStyles(e,ym.ignoreStyles),m=n.createCanvas(i+a,s+o),b=m.getContext("2d");n.screen.setDefaults(b),this.renderChildren(b),new tE(n,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(b,0,0,i+a,s+o);var x=n.createCanvas(i+a,s+o),C=x.getContext("2d");n.screen.setDefaults(C),e.render(C),C.globalCompositeOperation="destination-in",C.fillStyle=b.createPattern(m,"no-repeat"),C.fillRect(0,0,i+a,s+o),t.fillStyle=C.createPattern(x,"no-repeat"),t.fillRect(0,0,i+a,s+o),this.restoreStyles(e,f)}render(t){}}ym.ignoreStyles=["mask","transform","clip-path"];var t6=()=>{};class e6 extends mi{constructor(){super(...arguments),this.type="clipPath"}apply(t){var{document:e}=this,n=Reflect.getPrototypeOf(t),{beginPath:i,closePath:s}=t;n&&(n.beginPath=t6,n.closePath=t6),Reflect.apply(i,t,[]),this.children.forEach(a=>{if(!(typeof a.path>"u")){var o=typeof a.elementTransform<"u"?a.elementTransform():null;o||(o=YA.fromElement(e,a)),o&&o.apply(t),a.path(t),n&&(n.closePath=s),o&&o.unapply(t)}}),Reflect.apply(s,t,[]),t.clip(),n&&(n.beginPath=i,n.closePath=s)}render(t){}}class _m extends mi{constructor(){super(...arguments),this.type="filter"}apply(t,e){var{document:n,children:i}=this,s=e.getBoundingBox(t);if(s){var a=0,o=0;i.forEach(Q=>{var q=Q.extraFilterDistance||0;a=Math.max(a,q),o=Math.max(o,q)});var A=Math.floor(s.width),f=Math.floor(s.height),m=A+2*a,b=f+2*o;if(!(m<1||b<1)){var x=Math.floor(s.x),C=Math.floor(s.y),M=this.removeStyles(e,_m.ignoreStyles),U=n.createCanvas(m,b),N=U.getContext("2d");n.screen.setDefaults(N),N.translate(-x+a,-C+o),e.render(N),i.forEach(Q=>{typeof Q.apply=="function"&&Q.apply(N,0,0,m,b)}),t.drawImage(U,0,0,m,b,x-a,C-o,m,b),this.restoreStyles(e,M)}}}render(t){}}_m.ignoreStyles=["filter","transform","clip-path"];class r6 extends mi{constructor(t,e,n){super(t,e,n),this.type="feDropShadow",this.addStylesFromStyleDefinition()}apply(t,e,n,i,s){}}class n6 extends mi{constructor(){super(...arguments),this.type="feMorphology"}apply(t,e,n,i,s){}}class i6 extends mi{constructor(){super(...arguments),this.type="feComposite"}apply(t,e,n,i,s){}}class s6 extends mi{constructor(t,e,n){super(t,e,n),this.type="feGaussianBlur",this.blurRadius=Math.floor(this.getAttribute("stdDeviation").getNumber()),this.extraFilterDistance=this.blurRadius}apply(t,e,n,i,s){var{document:a,blurRadius:o}=this,A=a.window?a.window.document.body:null,f=t.canvas;f.id=a.getUniqueId(),A&&(f.style.display="none",A.appendChild(f)),C1t(f,e,n,i,s,o),A&&A.removeChild(f)}}class o6 extends mi{constructor(){super(...arguments),this.type="title"}}class a6 extends mi{constructor(){super(...arguments),this.type="desc"}}var W1t={svg:np,rect:XC,circle:FD,ellipse:MD,line:PD,polyline:YC,polygon:UD,path:qn,pattern:RD,marker:OD,defs:DD,linearGradient:kD,radialGradient:ND,stop:QD,animate:f_,animateColor:HD,animateTransform:zD,font:GD,"font-face":VD,"missing-glyph":jD,glyph:$C,text:ju,tspan:mm,tref:qD,a:KD,textPath:$D,image:XD,g:d_,symbol:YD,style:ZC,use:ZD,mask:ym,clipPath:e6,filter:_m,feDropShadow:r6,feMorphology:n6,feComposite:i6,feColorMatrix:tE,feGaussianBlur:s6,title:o6,desc:a6};function c6(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),e.push.apply(e,n)}return e}function $1t(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?c6(Object(e),!0).forEach(function(n){BC(r,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):c6(Object(e)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))})}return r}function X1t(r,t){var e=document.createElement("canvas");return e.width=r,e.height=t,e}function Y1t(r){return eE.apply(this,arguments)}function eE(){return eE=zu(function*(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,e=document.createElement("img");return t&&(e.crossOrigin="Anonymous"),new Promise((n,i)=>{e.onload=()=>{n(e)},e.onerror=(s,a,o,A,f)=>{i(f)},e.src=r})}),eE.apply(this,arguments)}class Ku{constructor(t){var{rootEmSize:e=12,emSize:n=12,createCanvas:i=Ku.createCanvas,createImage:s=Ku.createImage,anonymousCrossOrigin:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.canvg=t,this.definitions={},this.styles={},this.stylesSpecificity={},this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=t.screen,this.rootEmSize=e,this.emSize=n,this.createCanvas=i,this.createImage=this.bindCreateImage(s,a),this.screen.wait(this.isImagesLoaded.bind(this)),this.screen.wait(this.isFontsLoaded.bind(this))}bindCreateImage(t,e){return typeof e=="boolean"?(n,i)=>t(n,typeof i=="boolean"?i:e):t}get window(){return this.screen.window}get fetch(){return this.screen.fetch}get ctx(){return this.screen.ctx}get emSize(){var{emSizeStack:t}=this;return t[t.length-1]}set emSize(t){var{emSizeStack:e}=this;e.push(t)}popEmSize(){var{emSizeStack:t}=this;t.pop()}getUniqueId(){return"canvg".concat(++this.uniqueId)}isImagesLoaded(){return this.images.every(t=>t.loaded)}isFontsLoaded(){return this.fonts.every(t=>t.loaded)}createDocumentElement(t){var e=this.createElement(t.documentElement);return e.root=!0,e.addStylesFromStyleDefinition(),this.documentElement=e,e}createElement(t){var e=t.nodeName.replace(/^[^:]+:/,""),n=Ku.elementTypes[e];return typeof n<"u"?new n(this,t):new LD(this,t)}createTextNode(t){return new q1t(this,t)}setViewBox(t){this.screen.setViewBox($1t({document:this},t))}}Ku.createCanvas=X1t,Ku.createImage=Y1t,Ku.elementTypes=W1t;function l6(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),e.push.apply(e,n)}return e}function cd(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?l6(Object(e),!0).forEach(function(n){BC(r,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):l6(Object(e)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))})}return r}class ld{constructor(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.parser=new h_(n),this.screen=new gm(t,n),this.options=n;var i=new Ku(this,n),s=i.createDocumentElement(e);this.document=i,this.documentElement=s}static from(t,e){var n=arguments;return zu(function*(){var i=n.length>2&&n[2]!==void 0?n[2]:{},s=new h_(i),a=yield s.parse(e);return new ld(t,a,i)})()}static fromString(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=new h_(n),s=i.parseFromString(e);return new ld(t,s,n)}fork(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return ld.from(t,e,cd(cd({},this.options),n))}forkString(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return ld.fromString(t,e,cd(cd({},this.options),n))}ready(){return this.screen.ready()}isReady(){return this.screen.isReady()}render(){var t=arguments,e=this;return zu(function*(){var n=t.length>0&&t[0]!==void 0?t[0]:{};e.start(cd({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0},n)),yield e.ready(),e.stop()})()}start(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{documentElement:e,screen:n,options:i}=this;n.start(e,cd(cd({enableRedraw:!0},i),t))}stop(){this.screen.stop()}resize(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.documentElement.resize(t,e,n)}}const J1t=Object.freeze(Object.defineProperty({__proto__:null,AElement:KD,AnimateColorElement:HD,AnimateElement:f_,AnimateTransformElement:zD,BoundingBox:hc,CB1:QC,CB2:HC,CB3:zC,CB4:GC,Canvg:ld,CircleElement:FD,ClipPathElement:e6,DefsElement:DD,DescElement:a6,Document:Ku,Element:mi,EllipseElement:MD,FeColorMatrixElement:tE,FeCompositeElement:i6,FeDropShadowElement:r6,FeGaussianBlurElement:s6,FeMorphologyElement:n6,FilterElement:_m,Font:yo,FontElement:GD,FontFaceElement:VD,GElement:d_,GlyphElement:$C,GradientElement:JC,ImageElement:XD,LineElement:PD,LinearGradientElement:kD,MarkerElement:OD,MaskElement:ym,Matrix:KC,MissingGlyphElement:jD,Mouse:wD,PSEUDO_ZERO:ad,Parser:h_,PathElement:qn,PathParser:en,PatternElement:RD,Point:Gi,PolygonElement:UD,PolylineElement:YC,Property:Ur,QB1:VC,QB2:jC,QB3:qC,RadialGradientElement:ND,RectElement:XC,RenderedElement:JA,Rotate:ED,SVGElement:np,SVGFontLoader:JD,Scale:SD,Screen:gm,Skew:WC,SkewX:TD,SkewY:ID,StopElement:QD,StyleElement:ZC,SymbolElement:YD,TRefElement:qD,TSpanElement:mm,TextElement:ju,TextPathElement:$D,TitleElement:o6,Transform:YA,Translate:CD,UnknownElement:LD,UseElement:ZD,ViewPort:bD,compressSpaces:sd,default:ld,getSelectorSpecificity:vD,normalizeAttributeName:yD,normalizeColor:_D,parseExternalUrl:DC,presets:I1t,toNumbers:da,trimLeft:gD,trimRight:mD,vectorMagnitude:kC,vectorsAngle:NC,vectorsRatio:A_},Symbol.toStringTag,{value:"Module"}));Ul.CompareMaps=rnt,Ul.Layers=Zi,Ul.Map=Xrt,Ul.Styles=Ef,Ul.Terrains=xy,Object.defineProperty(Ul,Symbol.toStringTag,{value:"Module"})});
